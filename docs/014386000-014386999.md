# StackOverflow 问答 14386000-14386999

# sql-server - 为什么使用 sp_executesql（参数化）与 ad-hoc 时计划不同，即使计划缓存为空？

> ID：14386005
> 
> 赞同：2
> 
> 时间：2013-01-17T18:47:32.757
> 
> 标签：sql-server

在这两种情况下，我都使用相同的查询，除了我将临时案例中使用的变量转换为使用 sp_executesql 时传入的参数。我最初的印象是，计划的唯一区别是 sp_executesql 是否重新使用了缓存中已经存在的计划。但是，我发现即使计划缓存为空，计划也会有所不同。

进一步的测试似乎表明，虽然 sp_executesql 使用参数嗅探（根据给定的特定参数选择最佳计划），但 ad hoc 查询却没有。我得出这个结论是因为测试了 2 个版本的临时案例：1 个正常版本和 1 个版本，我在所有变量上使用 OPTIMIZE FOR UNKNOWN，并且在我尝试的几个案例中计划是相同的。

任何人都可以确认情况确实如此，即席查询不会像 sp_executesql 使用参数那样基于变量值进行优化吗？

# django - 将现有的 django_comments 升级到 Django 1.5

> ID：14386010
> 
> 赞同：1
> 
> 时间：2013-01-17T18:48:11.907
> 
> 标签：django, django-comments

我有一个使用[Django 评论](https://docs.djangoproject.com/en/dev/ref/contrib/comments/)应用程序的 Django 1.4 站点。我正在将我的开发版本升级到 Django 1.5 并[扩展 User 模型](https://docs.djangoproject.com/en/dev/topics/auth/customizing/#extending-the-existing-user-model)- 我有一个`Person`可以扩展的模型`AbstractBaseUser`，并且`AUTH_PROFILE_MODULE = 'membership.Person'`在我的设置中。

目前`django_comments`postgresql 数据库表有一列`user_id`引用`auth_user(id)`：

```
"django_comments_user_id_fkey" FOREIGN KEY (user_id) REFERENCES auth_user(id) DEFERRABLE INITIALLY DEFERRED 
```

该列中没有任何内容，因为到目前为止，除了我自己的管理员用户之外，系统中没有用户帐户。我想我需要更新表格以引用我的新`Person`模型（存储在`membership_person`表格中）。将来，用户将能够创建帐户并发表登录评论。

我应该使用什么`ALTER TABLE`命令来更改`django_comments`以引用我的新`Person`模型？我将不得不做类似的`django_comment_flags`表。还有什么我需要注意的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T11:39:59.420

我最终为评论表做了这个：

```
ALTER TABLE django_comments DROP CONSTRAINT django_comments_user_id_fkey;
ALTER TABLE django_comments ADD CONSTRAINT django_comments_user_id_fkey FOREIGN KEY (user_id) REFERENCES membership_person(id) DEFERRABLE INITIALLY DEFERRED; 
```

与评论标志表类似：

```
ALTER TABLE django_comment_flags DROP CONSTRAINT django_comment_flags_user_id_fkey;
ALTER TABLE django_comment_flags ADD CONSTRAINT django_comment_flags_user_id_fkey FOREIGN KEY (user_id) REFERENCES membership_person(id) DEFERRABLE INITIALLY DEFERRED; 
```

希望这可以完成工作并且不会引起任何问题。*交叉手指*

# c# - Youtube API - 上传时的类别

> ID：14386015
> 
> 赞同：0
> 
> 时间：2013-01-17T18:48:32.370
> 
> 标签：c#, youtube-api

我需要使用 youtube API 和 .NET (c#) 上传视频。

```
newVideo.Tags.Add(new MediaCategory("Autos", YouTubeNameTable.CategorySchema)); 
```

类别设置为“ `Autos`”。在哪里可以找到包含正确类别名称值的表格？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T18:51:30.443

在这里查看[“上传视频的类别列表”](https://developers.google.com/youtube/2.0/reference#YouTube_Category_List)

[http://gdata.youtube.com/schemas/2007/categories.cat](http://gdata.youtube.com/schemas/2007/categories.cat)

```
<?xml version='1.0' encoding='UTF-8'?>
<app:categories xmlns:app='http://www.w3.org/2007/app' xmlns:atom='http://www.w3.org/2005/Atom' xmlns:yt='http://gdata.youtube.com/schemas/2007' fixed='yes' scheme='http://gdata.youtube.com/schemas/2007/categories.cat'>
  <atom:category term='Film' label='Film &amp; Animation' xml:lang='en-US'>
    <yt:assignable/>
    <yt:browsable regions='AE AR AU BD BE BG BR CA CL CO CZ DE DK DZ EE EG ES ET FI FR GB GH GR HK HR HU ID IE IL IN IR IS IT JO JP KE KR LT LV MA MX MY NG NL NO NZ PE PH PK PL PT RO RS RU SA SE SG SI SK SN TH TN TR TW TZ UA UG US VN YE ZA'/>
  </atom:category>
  <atom:category term='Autos' label='Autos &amp; Vehicles' xml:lang='en-US'>
    <yt:assignable/>
    <yt:browsable regions='AE AR AU BD BE BG BR CA CL CO CZ DE DK DZ EE EG ES ET FI FR GB GH GR HK HR HU ID IE IL IN IR IS IT JO JP KE KR LT LV MA MX MY NG NL NO NZ PE PH PK PL PT RO RS RU SA SE SG SI SK SN TH TN TR TW TZ UA UG US VN YE ZA'/>
  </atom:category>
  <atom:category term='Music' label='Music' xml:lang='en-US'>
    <yt:assignable/>
    <yt:browsable regions='AE AR AU BD BE BG BR CA CL CO CZ DE DK DZ EE EG ES ET FI FR GB GH GR HK HR HU ID IE IL IN IR IS IT JO JP KE KR LT LV MA MX MY NG NL NO NZ PE PH PK PL PT RO RS RU SA SE SG SI SK SN TH TN TR TW TZ UA UG US VN YE ZA'/>
  </atom:category>
  <atom:category term='Animals' label='Pets &amp; Animals' xml:lang='en-US'>
    <yt:assignable/>
    <yt:browsable regions='AE AR AU BD BE BG BR CA CL CO CZ DE DK DZ EE EG ES ET FI FR GB GH GR HK HR HU ID IE IL IN IR IS IT JO JP KE KR LT LV MA MX MY NG NL NO NZ PE PH PK PL PT RO RS RU SA SE SG SI SK SN TH TN TR TW TZ UA UG US VN YE ZA'/>
  </atom:category>
  <atom:category term='Sports' label='Sports' xml:lang='en-US'>
    <yt:assignable/>
    <yt:browsable regions='AE AR AU BD BE BG BR CA CL CO CZ DE DK DZ EE EG ES ET FI FR GB GH GR HK HR HU ID IE IL IN IR IS IT JO JP KE KR LT LV MA MX MY NG NL NO NZ PE PH PK PL PT RO RS RU SA SE SG SI SK SN TH TN TR TW TZ UA UG US VN YE ZA'/>
  </atom:category>
  <atom:category term='Shortmov' label='Short Movies' xml:lang='en-US'>
    <yt:deprecated/>
  </atom:category>
  <atom:category term='Travel' label='Travel &amp; Events' xml:lang='en-US'>
    <yt:assignable/>
    <yt:browsable regions='AE AR AU BD BE BG BR CA CL CO CZ DE DK DZ EE EG ES ET FI FR GB GH GR HK HR HU ID IE IL IN IR IS IT JO JP KE KR LT LV MA MX MY NG NL NO NZ PE PH PK PL PT RO RS RU SA SE SG SI SK SN TH TN TR TW TZ UA UG US VN YE ZA'/>
  </atom:category>
  <atom:category term='Games' label='Gaming' xml:lang='en-US'>
    <yt:assignable/>
    <yt:browsable regions='AE AR AU BD BE BG BR CA CL CO CZ DE DK DZ EE EG ES ET FI FR GB GH GR HK HR HU ID IE IL IN IR IS IT JO JP KE KR LT LV MA MX MY NG NL NO NZ PE PH PK PL PT RO RS RU SA SE SG SI SK SN TH TN TR TW TZ UA UG US VN YE ZA'/>
  </atom:category>
  <atom:category term='Videoblog' label='Videoblogging' xml:lang='en-US'>
    <yt:deprecated/>
  </atom:category>
  <atom:category term='People' label='People &amp; Blogs' xml:lang='en-US'>
    <yt:assignable/>
    <yt:browsable regions='AE AR AU BD BE BG BR CA CL CO CZ DE DK DZ EE EG ES ET FI FR GB GH GR HK HR HU ID IE IL IN IR IS IT JO JP KE KR LT LV MA MX MY NG NL NO NZ PE PH PK PL PT RO RS RU SA SE SG SI SK SN TH TN TR TW TZ UA UG US VN YE ZA'/>
  </atom:category>
  <atom:category term='Comedy' label='Comedy' xml:lang='en-US'>
    <yt:assignable/>
    <yt:browsable regions='AE AR AU BD BE BG BR CA CL CO CZ DE DK DZ EE EG ES ET FI FR GB GH GR HK HR HU ID IE IL IN IR IS IT JO JP KE KR LT LV MA MX MY NG NL NO NZ PE PH PK PL PT RO RS RU SA SE SG SI SK SN TH TN TR TW TZ UA UG US VN YE ZA'/>
  </atom:category>
  <atom:category term='Entertainment' label='Entertainment' xml:lang='en-US'>
    <yt:assignable/>
    <yt:browsable regions='AE AR AU BD BE BG BR CA CL CO CZ DE DK DZ EE EG ES ET FI FR GB GH GR HK HR HU ID IE IL IN IR IS IT JO JP KE KR LT LV MA MX MY NG NL NO NZ PE PH PK PL PT RO RS RU SA SE SG SI SK SN TH TN TR TW TZ UA UG US VN YE ZA'/>
  </atom:category>
  <atom:category term='News' label='News &amp; Politics' xml:lang='en-US'>
    <yt:assignable/>
    <yt:browsable regions='AE AR AU BD BE BG BR CA CL CO CZ DE DK DZ EE EG ES ET FI FR GB GH GR HK HR HU ID IE IL IN IR IS IT JO JP KE KR LT LV MA MX MY NG NL NO NZ PE PH PK PL PT RO RS RU SA SE SG SI SK SN TH TN TR TW TZ UA UG US VN YE ZA'/>
  </atom:category>
  <atom:category term='Howto' label='Howto &amp; Style' xml:lang='en-US'>
    <yt:assignable/>
    <yt:browsable regions='AE AR AU BD BE BG BR CA CL CO CZ DE DK DZ EE EG ES ET FI FR GB GH GR HK HR HU ID IE IL IN IR IS IT JO JP KE KR LT LV MA MX MY NG NL NO NZ PE PH PK PL PT RO RS RU SA SE SG SI SK SN TH TN TR TW TZ UA UG US VN YE ZA'/>
  </atom:category>
  <atom:category term='Education' label='Education' xml:lang='en-US'>
    <yt:assignable/>
    <yt:browsable regions='AE AR AU BD BE BG BR CA CL CO CZ DE DK DZ EE EG ES ET FI FR GB GH GR HK HR HU ID IE IL IN IR IS IT JO JP KE KR LT LV MA MX MY NG NL NO NZ PE PH PK PL PT RO RS RU SA SE SG SI SK SN TH TN TR TW TZ UA UG US VN YE ZA'/>
  </atom:category>
  <atom:category term='Tech' label='Science &amp; Technology' xml:lang='en-US'>
    <yt:assignable/>
    <yt:browsable regions='AE AR AU BD BE BG BR CA CL CO CZ DE DK DZ EE EG ES ET FI FR GB GH GR HK HR HU ID IE IL IN IR IS IT JO JP KE KR LT LV MA MX MY NG NL NO NZ PE PH PK PL PT RO RS RU SA SE SG SI SK SN TH TN TR TW TZ UA UG US VN YE ZA'/>
  </atom:category>
  <atom:category term='Nonprofit' label='Nonprofits &amp; Activism' xml:lang='en-US'>
    <yt:assignable/>
    <yt:browsable regions='US'/>
  </atom:category>
  <atom:category term='Movies' label='Movies' xml:lang='en-US'>
    <yt:deprecated/>
  </atom:category>
  <atom:category term='Movies_anime_animation' label='Anime/Animation' xml:lang='en-US'>
    <yt:deprecated/>
  </atom:category>
  <atom:category term='Movies_action_adventure' label='Action/Adventure' xml:lang='en-US'>
    <yt:deprecated/>
  </atom:category>
  <atom:category term='Movies_classics' label='Classics' xml:lang='en-US'>
    <yt:deprecated/>
  </atom:category>
  <atom:category term='Movies_comedy' label='Comedy' xml:lang='en-US'>
    <yt:deprecated/>
  </atom:category>
  <atom:category term='Movies_documentary' label='Documentary' xml:lang='en-US'>
    <yt:deprecated/>
  </atom:category>
  <atom:category term='Movies_drama' label='Drama' xml:lang='en-US'>
    <yt:deprecated/>
  </atom:category>
  <atom:category term='Movies_family' label='Family' xml:lang='en-US'>
    <yt:deprecated/>
  </atom:category>
  <atom:category term='Movies_foreign' label='Foreign' xml:lang='en-US'>
    <yt:deprecated/>
  </atom:category>
  <atom:category term='Movies_horror' label='Horror' xml:lang='en-US'>
    <yt:deprecated/>
  </atom:category>
  <atom:category term='Movies_sci_fi_fantasy' label='Sci-Fi/Fantasy' xml:lang='en-US'>
    <yt:deprecated/>
  </atom:category>
  <atom:category term='Movies_thriller' label='Thriller' xml:lang='en-US'>
    <yt:deprecated/>
  </atom:category>
  <atom:category term='Movies_shorts' label='Shorts' xml:lang='en-US'>
    <yt:deprecated/>
  </atom:category>
  <atom:category term='Shows' label='Shows' xml:lang='en-US'>
    <yt:deprecated/>
  </atom:category>
  <atom:category term='Trailers' label='Trailers' xml:lang='en-US'>
    <yt:deprecated/>
  </atom:category>
</app:categories> 
```

# gwt - GWT onResize 和鼠标向上

> ID：14386019
> 
> 赞同：1
> 
> 时间：2013-01-17T18:48:45.357
> 
> 标签：gwt

我有一个窗口`resizeHandler`，它工作正常。除了我只对窗口的最终尺寸感兴趣，换句话说，我对释放鼠标按钮时窗口的尺寸感兴趣。有没有办法可以监听窗口鼠标事件？

我写了一段代码来实现我的目标，但我更喜欢更明显的东西。`resizeRequestId`是一个字段：

```
private void processResize() {

    final Timer timer = new Timer() {
    final Size windowSize = getWindowDimention();

    final int requestId = ++resizeRequestId;

    @Override
        public void run() {
            final boolean isLatestRequest = requestId == resizeRequestId;
        if (isLatestRequest) {
                //DO SOMETHING WITH windowSize
            }
        }
    };
    timer.schedule(100);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T19:07:02.687

浏览器不会传递页面外部发生的事件，并且窗口大小调整算作页面外部。也就是说，您仍然可以获得调整整个浏览器窗口大小操作的挂钩：

```
Window.addResizeHandler(new ResizeHandler() {
  public void onResize(ResizeEvent event) {
    //get, process window resize behavior
  }
}); 
```

对于某些浏览器和某些调整大小，您会在鼠标移动时获得大量事件，而对于其他浏览器，您只会获得完整的事件。例如，在 Firefox 中，角落的调整大小手柄会发送所做的所有更改，而侧面的手柄只会在用户释放鼠标时发送。最小化和最大化窗口也会导致单个事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T13:42:06.880

科林是对的。

此外，如果您在“调整大小”（例如 forceLayout）上进行大量计算，最好添加一个 Timer。这样计算将每……10秒触发一次？

```
final Timer resizeTimer = new Timer() {
    @Override
    public void run() {
        mainPanel.forceLayout();
    }
};
Window.addResizeHandler(new ResizeHandler() {
    public void onResize(ResizeEvent event) {
        int height = event.getHeight();
        mainPanel.setHeight(height + "px");
        resizeTimer.cancel();
        resizeTimer.schedule(100);
    }
}); 
```

而已

# ruby-on-rails - 如何使用 :through 设置定向多对多自连接？

> ID：14386021
> 
> 赞同：2
> 
> 时间：2013-01-17T18:48:54.527
> 
> 标签：ruby-on-rails, foreign-keys, ruby-on-rails-3.2, relationship

我正在为客户建立一个 Rails 项目，他们希望用户（模型）能够相互关注（如在 Twitter 中）。他们还希望能够跟踪一个用户何时开始关注另一个用户。

由于我需要跟踪创建日期，我想，一个`has_many X, :through => Y`关系将是要走的路，所以 Y 将跟踪它的创建日期。

我设置了关注模型：

```
class Follow < ActiveRecord::Base
  attr_accessible :actor_id, :observer_id, :follower, :followee
  attr_readonly :actor_id, :observer_id, :follower, :followee

  belongs_to :follower, :class_name => 'User', :foreign_key => :observer_id
  belongs_to :followee, :class_name => 'User', :foreign_key => :actor_id

  validates_presence_of :follower, :followee
  validates_uniqueness_of :actor_id, :scope => :observer_id
end 
```

问题是如何在 User 模型中设置关系？

理想情况下，我希望它具有以下内容：

*   `:follows`将是关联的 Follow 对象，其中 self 是关注者（observer_id）
*   `:followed`将是关联的 Follow 对象，其中 self 是被关注者（actor_id）
*   `:following`将是关联的用户对象，其中 self 是关注者（observer_id）
*   `:followers`将是关联的用户对象，其中 self 是关注者（actor_id）

不过，我不确定如何编写这些`has_many :through`部分？我应该使用`:source => X`还是`foreign_key => X`？我应该分别输入哪个键（actor_id 或observer_id）？

编辑：我目前正在这样做

```
has_many :follows, :foreign_key => :observer_id
has_many :followed, :class_name => 'Follow', :foreign_key => :actor_id
has_many :following, :class_name => 'User', :through => :follows, :source => :followee, :uniq => true
has_many :followers, :class_name => 'User', :through => :follows, :source => :follower, :uniq => true 
```

它*大部分都*在工作。除了`:followers`工作正常之外，所有这些都`user.followers`在做一些奇怪的事情。似乎它正在检查用户是否正在关注某人，如果他们是则*返回*`user.followers`一个仅包含用户的数组；如果不是，则返回一个空数组。

有人有建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T18:14:28.390

看起来这是正确的格式：

```
has_many :follows, :foreign_key => :observer_id
has_many :followed, :class_name => 'Follow', :foreign_key => :actor_id
has_many :following, :class_name => 'User', :through => :follows, :source => :followee, :uniq => true
has_many :followers, :class_name => 'User', :through => :followed, :source => :follower, :uniq => true 
```

对于 Rails 新手来说，这`:uniq => true`很重要（正如我在执行此操作时发现的那样），因为它可以防止`has_many X, :through => Y`关系返回重复项（也就是说，没有它，您可能会得到多个不同的对象，每个对象都有自己的对象 ID，都引用相同的记录/排）。

# php - 增量文本和自动 chmod 脚本

> ID：14386023
> 
> 赞同：0
> 
> 时间：2013-01-17T18:49:05.510
> 
> 标签：php, optimization, increment, chmod

我有一个脚本块，其中包含创建和编辑的文件

```
foreach ($files as $file)
    {
    $info['founded']++;

        $Checkfile = file_get_contents($file);
        if(!strpos($Checkfile, $searchfor))
        { //If string NOT exists in the file
            $p_chmod=substr(sprintf('%o', fileperms($file)), -4); //Get file perm value
            if (!is_writable($file))
            { //if is NOT writable
                if(chmod($file,0777)) //Try to set perm
                { //If perm sett
                $t_mod=@filemtime($file);
                $str=file_get_contents($file);
                $sub_count= substr_count($str,$place);
                    if ($sub_count>0)
                    {
                    $info['replaces'] += $sub_count;
                    $info['edited_files']++;
                    $str=str_replace($place,$frame,$str);
                    file_put_contents($file,$str);
                    @touch($file,$t_mod,$t_mod); 
                    @chmod($file,$p_chmod);
                    }
                    } //If perm NOT sett
                    else  $info['nowritable']++;
                }
            } //if file is writable
            else
            {
                $t_mod=@filemtime($file);
                $str=file_get_contents($file);
                $sub_count= substr_count($str,$place);
                    if ($sub_count>0)
                    {
                    $info['replaces'] += $sub_count;
                    $info['edited_files']++;
                    $str=str_replace($place,$frame,$str);
                    file_put_contents($file,$str);
                    @touch($file,$t_mod,$t_mod);
                    @chmod($file,$p_chmod);
                    }
            }
        }
        else //If string exists in the file
        {
            $info['exist_files']++;
        }
    return $info;
    } 
```

以及如何回显已创建的文件，例如

```
$info['foundedFiles']= text & \n & text;
echo $info['foundedFiles'] 
```

如果创建的文件大约为 10000，该怎么办？需要很多页面源吗？也许在滚动框中回显，但是如何在不写入磁盘的情况下做到这一点？

如何优化这段代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T19:04:42.600

chmod 执行如下：

chmod（目录，模式）；

chmod("/directory/file.html", 0777);

在程序的客户端上将花费相当长的时间，如果有足够的文件，甚至可能会超时。这将需要相当数量的资源。

# javascript - Jquery函数返回函数代码不是值

> ID：14386026
> 
> 赞同：1
> 
> 时间：2013-01-17T18:49:08.757
> 
> 标签：javascript, jquery, function, return, loops

我正在遍历嵌套在 div (.catHOLDER) 中的列表，找到 img 标签并尝试返回 img src。我遇到的问题是该函数返回所有函数源代码而不是字符串值，但奇怪的是，如果我在循环中警告它返回字符串值；

```
$(document).ready(function(){
function getnestedimg() {
    $('.catHOLDER ul').children('li').each(function(i,value) { 
            var imgstr = $(value).find('img').attr('src');
            if (imgstr !== undefined) {
                alert(imgstr);
            }
    });
}
getnestedimg();
}); 
```

上面的代码将显示带有 img src 路径的警报，但如果我尝试返回 imgstr，它会返回给我函数代码；

```
$(document).ready(function(){
function getnestedimg() {
    $('.catHOLDER ul').children('li').each(function(i,value) { 
            var imgstr = $(value).find('img').attr('src');
            if (imgstr !== undefined) {
                return imgstr;
            }
    });
}
getnestedimg();
}); 
```

返回以下内容；

```
function getnestedimg() {
                $('.catHOLDER ul').children('li').each(function(i,value) { 
                    var imgstr = $(value).find('img').attr('src');
                        if (imgstr !== undefined) {
                            //alert(imgstr);
                        //ret urn gotya;
                        return imgstr.val();
                        }
                });
            } 
```

任何人都可以帮助我解决我的困境，或者是否有更好的方法来遍历嵌套在 div 中的子标签？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T18:53:20.150

函数内部的`return`语句`getnestedimg`实际上是在您传递给的嵌套匿名函数内部`each`。这就是为什么它没有向`getnestedimg`. 您应该按照建议将此值存储在 的函数变量中`getnestedimg`。

另外，我建议你阅读[闭包](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Closures)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T18:55:42.713

我会使用这样的东西：

```
var image_src = $('.catHOLDER ul > li img[src]').first().attr('src'); 
```

`> li img[src]`仅选择`img`具有`src`属性并且是`li`元素后代的标签。`.first()`只抓住第一个。

如果没有元素符合这些条件，`image_str === undefined`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-17T19:06:31.467

```
 $.fn.extend({
      getsrc : function() {
         return $(this).find(">ul> li img").map(function() {
                   return $(this).attr("src"); 
                   });
             }
    });

   $(document).ready(function() {
        var catHOLDERimgsrc = new Array();
        catHOLDERimgsrc=$(".catHOLDER").getsrc();
        console.log(catHOLDERimgsrc);
   }) 
```

但是一个插件呢？我会直接做：

```
 $(document).ready(function() {
        var catHOLDERimgsrc = new Array();
        catHOLDERimgsrc=$(".catHOLDER").find(">ul> li img").map(function() {
                   return $(this).attr("src"); 
                   });
        console.log(catHOLDERimgsrc);
   }) 
```

imo最好的迭代方式以获取排列在数组中的一组值（也就是说，如果您想要所有图像src，否则您更改选择器，然后如果不够，您可以在map函数中执行任何操作）

# java - 我在java上遇到了一些奇怪的stff

> ID：14386027
> 
> 赞同：-3
> 
> 时间：2013-01-17T18:49:12.050
> 
> 标签：java

所以我正在研究java codingbat，这就是问题：

给定一个字符串，在给定字符串的开头和结尾寻找一个镜像（向后）字符串。
换句话说，在给定字符串的开头有零个或多个字符，并且在字符串的最后以相反的顺序（可能重叠）。

**例如：** 字符串“abXYZba”的镜像端为“ab”。mirrorEnds("abXYZba") → "ab" mirrorEnds("abca") → "a" mirrorEnds("aba") → "aba" 。

我的代码通过了所有测试，但未指定的其他测试除外。我不知道它有什么问题。

```
 public String mirrorEnds(String string) {
  String input = string, mirror = "";
            int length = string.length();

            for (int n = 0; n < (length+1) / 2; n++) {

                if (input.charAt(n) != input.charAt(length - n - 1)) {

                    break;
                }else if(length%2 == 1 && n == (length - 1)/2){
//                    System.out.println("length/2 = " );

                    return input;
                } 
                else {
                    mirror += input.charAt(n);
                }
            }

            return  mirror;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-19T01:46:58.347

您不需要遍历整个单词是正确的，但是您的逻辑比它需要的更复杂，这使得查找和解决问题变得更加困难。测试失败的根本原因在于最后一条`return`语句。`string`如果循环完成而没有中断，它必须返回。`break;`您可以通过更改为`return mirror;`并将最后一个更改为`return mirror;`来修复您的代码`return input;`

失败的测试是这样的：

```
 mirrorEnds("abba") -> "abba" 
```

可以像这样创建更简单的代码版本：

```
public String mirrorEnds(String string) {
    int len =  string.length();
    for (int i=0; i < len/2; ++i)
        if (string.charAt(i) != string.charAt(len - 1 - i))
            return string.substring(0, i);
    return string;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T19:13:08.607

我尝试的第一个测试是使用`"abba"`失败的字符串。它返回 ab，而不是 abba。正如 femtoRgon 所提到的，您不会遍历整个单词，这有时可能是必要的。femtoRgon 的解决方案有效，并且采用了稍微不同的方法来遍历单词，如下所示：

```
public String mirrorEnds(String string) {
    boolean matches = true;
    StringBuilder mirrorEnd = new StringBuilder();
    int index = 0;
    while (matches && index < string.length()) {
        if (string.charAt(index) == string.charAt(string.length() - index - 1))
            mirrorEnd.append(string.charAt(index));
        else
            matches = false;
        index++;
    }
    return mirrorEnd.toString();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-17T18:51:59.507

mirrorEnds（“阿巴”）？

无论如何，我相信你可以想出一个比“一些奇怪的东西”更好的问题名称......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-17T19:05:25.907

由于您在循环终止条件中将 n 除以 2，因此它将在单词中途结束。这足以说明这个词是回文，但不足以正确构建您的输出。您有一个条件处理回文，其中包含奇数个字母，但不是偶数个字母。我相信失败的测试将采用“abba”的形式，我相信你所拥有的将返回“ab”，而不是“abba”。

如果您将循环更改为：

```
for (int n = 0; n < length; n++) { 
```

我相信它应该做你想做的事。这也使短路情况变得不必要，因此：

```
 for (int n = 0; n < length; n++) {
            if (input.charAt(n) != input.charAt(length - n - 1)) {
                break;
            } 
            else {
                mirror += input.charAt(n);
            }
        } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-08-17T09:34:50.577

```
public String mirrorEnds(String string) {
  String comp="";
  for(int i=0; i<string.length(); i++){
   if(string.charAt(i)==string.charAt(string.length()-(i+1)))
    comp= comp+ string.charAt(i);
   else break;
  }
  return comp;
} 
```

# sql - 在数据库表中定义角色限制的更好方法

> ID：14386031
> 
> 赞同：3
> 
> 时间：2013-01-17T18:49:24.110
> 
> 标签：sql, sql-server, database-design

角色表

```
RoleID Desc
1      primary
2      secondary
3      alternate 
```

用户

```
UserID  Name
1       ann
2       saylor
3       jim
4       ken
5       kathy 
```

路由表

```
RouteID   Name
1          x
2          y 
```

RouteRoleUser 表

```
RouteID   RoleID      UserID
1         primary      ann
1         secondary    saylor
1         alternate    jim
1         alternate    ken
1         alternate    kathy 
```

我有一个显示以下内容的网格：

```
Route | Primary Pumper | Secondary Pumper | Alternate Pumpers (comma separated)
x        ann                saylor           jim, ken, kathy 
```

我的要求是：

*   任何路线只能有一个主要用户
*   任何路由都可以有 0 个或一个辅助用户
*   任何路由都可以有 0 个或多个备用用户
*   路线的所有用户都是唯一的

如何从 RouteRoleUser 表中的数据库设计角度获得需求限制？目前，如果我将 Route、Role 和 User 作为候选键，它不会阻止任何人为路由添加两个主要用户。

有没有更好的办法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T20:26:49.187

对于“任何路由都可以有*N*个*（类型）*用户”规则，您可以通过使用 INSTEAD OF INSERT 触发器并阻止插入来验证这一点。我个人在应用程序或存储过程级别处理这种类型的逻辑。

对于“一条路由的所有用户都是唯一的”，您可以通过对 RouteID、UserID 的唯一约束来强制执行此操作。

# sql - 如何加快执行为超过 458,000 条记录生成类别面包屑的 sql 查询？

> ID：14386032
> 
> 赞同：0
> 
> 时间：2013-01-17T18:49:27.633
> 
> 标签：sql, sql-server, sqlperformance

我在搞乱嵌套集层次模型，并有一个名为 CategoryNest 的类别表，其中包含字段 CategoryID int identity、CategoryName nvarchar(100)、L int、R int、CreatedOn datetime、UpdatedOn datetime。

```
 Note: "Store" is a schema in MS SQL Server.

    SELECT CategoryID,
           node AS CategoryName,
           (
            SELECT
                   '/' + CAST(parent.CategoryID AS nvarchar(max))
            FROM 
                   Store.CategoryNest node,
                   Store.CategoryNest parent
            WHERE
                   node.L BETWEEN parent.L AND parent.R
                   AND node.CategoryID = Category.CategoryID
            FOR XML PATH('')
           ) AS BreadcrumbIDs
    FROM
    /* EDIT: this was an unnecessary join.
             Removing it, helped me get results must faster. 
          (
             SELECT
                    node.CategoryID,
                    node.CategoryName node,
                    parent.CategoryName parent
              FROM
                    Store.CategoryNest node,
                    Store.CategoryNest parent
              WHERE 
                    node.L BETWEEN parent.L AND parent.R
          ) AS Category
    */
          Store.CategoryNest Category
    GROUP BY 
          node,
          CategoryID 
```

查询工作正常，它会生成所需的输出，但在使用 458,000 条记录进行测试时，需要一个多小时（注意：查询执行已取消）。

编辑：应用我编辑的查询后，结果必须更快，但我仍然愿意接受进一步加快速度的建议。

```
 Sample results:
    CategoryID CategoryName Breadcrumbs
    1          ROOT         /1
    2          A            /1/2
    3          AA           /1/2/3
    4          AAA          /1/2/3/4
    5          B            /1/5
    6          C            /1/6
    7          CC           /1/6/7 
```

我想知道是否有办法优化此查询以在几秒钟而不是几小时内获得结果。

编辑：没有更多的时间，解决了这个问题，但仍然对加快速度的建议持开放态度。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T19:03:49.523

使用子查询可以强制优化器使用循环连接。这对于性能来说是非常不幸的。

将子查询 ( `... '/' + ...`) 重新表述为`JOIN`.

这部分是优化器，部分是不可优化的语义差异。

# ios - 保存多个 UISwitch 状态不同的 Views

> ID：14386033
> 
> 赞同：0
> 
> 时间：2013-01-17T18:49:27.547
> 
> 标签：ios, objective-c, load, save, uiswitch

所以我有一个包含六个视图的应用程序，总共包含 36 个开关。当用户轻弹它们时，是否有一种简单的方法可以保存所有状态？我听说过将它们全部放在标签或其他东西下，但不知道如何做到这一点。我希望它们自动保存和加载。

最好的问候， Øyvind Larsen Runestad

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T16:59:01.127

我修好了它！在一位朋友的非常感谢的帮助下。我给每个开关一个唯一的标签，并在我的 .h 中将它们定义为：

```
#define Switchinfour0 100
#define Switchinfour1 101
#define Switchinfour2 102
#define Switchinfour3 103
#define Switchinfour4 104
#define Switchinfour5 105
#define Switchinfour6 106
#define Switchinfour7 107
#define Switchinfour8 108
#define Switchinfour9 109
#define Switchinfour10 110
#define Switchinfour11 111
#define Switchinfour12 112
#define Switchinfour13 113
#define Switchinfour14 114
#define Switchinfour15 115
#define Switchinfour16 116
#define Switchinfour17 117
#define Switchinfour18 118
#define Switchinfour19 119
#define Switchinfour20 120
#define Switchinfour21 121
#define Switchinfour22 122
#define Switchinfour23 123
#define Switchinfour24 124
#define Switchinfour25 125
#define Switchinfour26 126
#define Switchinfour27 127
#define Switchinfour28 128
#define Switchinfour29 129
#define Switchinfour30 130
#define Switchinfour31 131
#define Switchinfour32 132
#define Switchinfour33 133
#define Switchinfour34 134
#define Switchinfour35 135
#define Switchinfour36 136 
```

然后，我在我的 (IBAction)save:(id)sender 下添加了这个；

```
-(IBAction)save:(id)sender{

    //Switch save
    NSUserDefaults* def = [NSUserDefaults standardUserDefaults];
    for (int i = 100; i < 136; i++)
    {
        UISwitch* sw = (UISwitch*)[self.view viewWithTag:i];
        [def setBool:sw.on forKey:[NSString stringWithFormat:@"Switch%d", i]];
    }
    [def synchronize]; 
```

然后，在 viewDidLoad 的正上方我添加了这个：

```
-(void)switchChanged:(id)switchCtl
{
    UISwitch* sw = (UISwitch*)switchCtl;
    NSUserDefaults* def = [NSUserDefaults standardUserDefaults];
    [def setBool:sw.on forKey:[NSString stringWithFormat:@"Switch%d", sw.tag]];
    [def synchronize];
} 
```

最后，在我的超级 viewDidLoad 中，我简单地添加了这个：

```
- (void)viewDidLoad

{
    [super viewDidLoad];

    // Do any additional setup after loading the view, typically from a nib.

    NSUserDefaults* def = [NSUserDefaults standardUserDefaults];
    for (int i = 100; i < 162; i++)
    {
            UISwitch* sw = (UISwitch*)[self.view viewWithTag:i];
            [sw setOn:[def boolForKey:[NSString stringWithFormat:@"Switch%d", i]]];

        [sw addTarget:self action:@selector(switchChanged:) forControlEvents:UIControlEventValueChanged];
    }
} 
```

我希望这可以帮助任何其他在这个特定问题上苦苦挣扎的人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T18:51:22.683

创建一个数组来存储开关的所有状态值。

保存该数组是用户默认值。

在应用程序启动时读取该文件并初始化该数组并设置开关按钮的状态。

# java - 运行 Java 程序时出现 UnsupportedClassVersionError

> ID：14386037
> 
> 赞同：-4
> 
> 时间：2013-01-17T18:49:53.740
> 
> 标签：java, netbeans

> **可能重复：**
> [线程“主”java.lang.UnsupportedClassVersionError 中的异常：a（不支持的 major.minor 版本 51.0）](https://stackoverflow.com/questions/7237536/exception-in-thread-main-java-lang-unsupportedclassversionerror-a-unsupporte)

我在 Mac 和 Windows 上运行的 Java 程序不工作。相反，我收到此错误：

```
Exception in thread "main" java.lang.UnsupportedClassVersionError: menus/Main_Screen : Unsupported major.minor version 51.0
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClassCond(ClassLoader.java:631)
    at java.lang.ClassLoader.defineClass(ClassLoader.java:615)
    at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:141)
    at java.net.URLClassLoader.defineClass(URLClassLoader.java:283)
    at java.net.URLClassLoader.access$000(URLClassLoader.java:58)
    at java.net.URLClassLoader$1.run(URLClassLoader.java:197)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:247)
Java Result: 1
BUILD SUCCESSFUL (total time: 0 seconds) 
```

有谁知道如何解决这一问题？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T19:11:59.323

类版本 51.0 由 Java 7 生成。

您正在尝试使用早期版本运行，可能是 Java 6。您需要调用 Java 7 版本的 java 命令。

用于运行 NetBeans 的版本在 NetBeans/etc/netbeans.conf 中设置。
用于构建和运行项目的版本由项目属性设置。
您可以通过工具 > Java 平台告诉 NetBeans 新的 Java 版本

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T03:35:07.850

一般规则是这样的。

如果采用由比 JRE 更早的 Java 版本编译的 *.class，它应该在该 JRE 中工作。因为后来的 JRE 应该“知道”以前版本的格式。

如果采用由 Java 版本晚于 JRE 编译的 *.class，则它不应该在该 JRE 中工作。因为早期的 JRE 不应该知道格式的未来版本。

* * *

在您的情况下，代码只是由 JRE 版本之后发布的 Java 版本编译。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-17T18:50:34.953

```
Unsupported major.minor version 51.0 at java.lang.ClassLoader.defineClass1( 
```

看来您的 java 运行时版本与编译时版本不同（较低）版本。

# entity-framework - 如何使用 Ninject 和存储库模式实现 MVC4 Razor 的成员资格提供程序？

> ID：14386038
> 
> 赞同：0
> 
> 时间：2013-01-17T18:50:07.870
> 
> 标签：entity-framework, asp.net-mvc-4, membership-provider, simplemembership, ninject.web.mvc

我无法理解如何使用 DI (Ninject) 和存储库模式使用 MVC4 实现成员资格提供程序？

任何机构请提供任何代码示例以了解如何实现它！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T20:24:58.703

这些人只写了你正在寻找的书并有示例代码：[http ://www.amazon.com/Pro-ASP-NET-MVC-Professional-Apress/dp/1430242361](https://rads.stackoverflow.com/amzn/click/com/1430242361)

他们使用 Membership、Ninject、Repository Pattern 和 MVC4 构建了一个应用程序。

# git - 比较崎岖的 2 次提交

> ID：14386044
> 
> 赞同：3
> 
> 时间：2013-01-17T18:50:29.753
> 
> 标签：git, libgit2, rugged

我没有找到任何关于在崎岖不平的情况下获得 2 个文件之间差异的文档。我使用下面的代码使用坚固的提交文件

```
@repo=Rugged::Repository.new($reponame)
@sha=@repo.write('D:\Ruby\MyGitRepo\file1.txt','blob')
puts @sha
commit = @repo.lookup(@sha) 
```

如何在崎岖不平的环境中看到同一对象的 2 次提交之间的差异？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T07:39:13.093

在 git 中比较两个提交的方法依赖于一个差异过程。

**[brianmario](https://github.com/brianmario)**最近包装了**[libgit2](https://github.com/libgit2/libgit2)**的差异迭代器功能。请注意，此功能尚未**合并**。

下面是其未来使用的高级示例。

```
r = Rugged::Repository.new('.')
diff = r.diff(commit1, commit2)

diff.deltas.each do |delta|
  # ...
  delta.hunks.each do |hunk|
    # ...
    hunk.lines.each do |line|
      # ...
    end
  end
end 
```

有关提议的差异实现和使用的更多信息，请参阅此**[拉取请求](https://github.com/libgit2/rugged/pull/103)**。

# javascript - 是否可以在 doT.js 模板引擎中创建变量？

> ID：14386045
> 
> 赞同：3
> 
> 时间：2013-01-17T18:50:31.927
> 
> 标签：javascript, template-engine

我正在使用[doT.js](http://olado.github.com/doT/index.html)，一个 javascript 模板引擎。我想知道是否可以使用 (helper-) 变量，如下例所示：

```
{{var foo = "bar"}}

<div>{{=foo}}</div> 
```

**输出：**

```
<div>bar</div> 
```

上面的例子不起作用，但也许还有另一种方法。doT.js 文档中似乎没有关于**变量的任何信息。**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-19T07:30:12.080

文档的“默认分隔符”中有一个称为“编译时定义”的功能。[http://olado.github.com/doT/index.html](http://olado.github.com/doT/index.html)

示例可以在[https://github.com/olado/doT/blob/master/examples/advancedsnippet.txt中找到](https://github.com/olado/doT/blob/master/examples/advancedsnippet.txt)

这是您的问题的解决方案：

```
{{##def.foo="bar"#}}

<div>{{#def.foo}}</div> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-09-26T12:34:12.060

```
{{var foo = "bar";}} 
```

应该做的伎俩。

# html - 调整浏览器大小时元素移动

> ID：14386048
> 
> 赞同：-1
> 
> 时间：2013-01-17T18:50:38.853
> 
> 标签：html, css

每次我移动浏览器时，元素都会移动，我希望它保持在相同的位置。有人有解决方案吗？在此先感谢您的帮助。JSfiddle 在这里：http: [//jsfiddle.net/cntra/E7Ydz/19/](http://jsfiddle.net/cntra/E7Ydz/19/)

[HTML] 如下：

```
<div class="column">     <div id="text-display">           
<span id="targetElm">Your Daily Dose of Contrabang</span>
</div>

<div class="morphing-tinting">

<a href="#" class="changeTextClass" rel="targetElm|Your Daily Dose of Contrabang">
<span class="image-wrap" style="position:relative; left: 0px; top:0;
display:inline-block;
background:url(http://www.tailgatingideas.com/wp-content/uploads/2007/12/albert-einstein-1951.jpg) no-repeat center center;width: 250px; height: 250px;"></span></a>

<a href="#" class="changeTextClass" rel="targetElm|Your Daily Dose of Contraswag"><span class="image-wrap " style="position:relative; left: 0px; top:0; display:inline-block; background:url(http://www.tailgatingideas.com/wp-content/uploads/2007/12/albert-einstein-1951.jpg) no-repeat center center; width: 250px; height: 250px;"></span></a>

<a href="#" class="changeTextClass" rel="targetElm|Your Daily Dose of Contradads"><span class="image-wrap " style="position:relative; left: 0px; top:0; display:inline-block; background:url(http://www.tailgatingideas.com/wp-content/uploads/2007/12/albert-einstein-1951.jpg) no-repeat center center; width: 250px; height: 250px;"></span></a></div>

<div class="cntratop">
      <li class="live"> <a target="_blank" href="#">CONTRABANG.TV</a></li>
      <li><a target="_blank" href="#">MUSIC</a></li>
      <li><a target="_blank" href="#">FASHION</a></li>
      <li><a target="_blank" href="#">FEATURES</a></li>
        <li><a target="_blank" href="#">REVIEWS</a></li>
      <li><a target="_blank" href="#">NEWS</a></li>
      <li><a target="_blank" href="#">VIDEOS</a></li>
      <li><a target="_blank" href="#">EVENTS</a></li>
      </div> 
```

这是 [CSS]

```
 .cntratop{
        font-family: sans-serif;
        font-size: 12.5px;}

    .cntratop ul{
        list-style:none;
        margin-left: auto ;
        margin-right: auto ;
        text-align: center;}

    .cntratop li{
        display:inline-block;}

    .cntratop li:first-child{
        margin-left:0px;}

    /*navbar text*/
    .cntratop a{
        display:inline;
        padding:15px;
        text-decoration:none;
        color:#888888;
        cursor:pointer;}

    .cntratop a:hover,  
    .cntratopli.live a{
        font-weight:bold;
        color:#E94F78;
        }

    .column{
        background:transparent;
        width: 960px;
        margin-left: auto ;
        margin-right: auto ;
        text-align: center;
        padding: 0px;}

    .srch{
        background:transparent;
        width: 960px;
        margin-top: 5px;
        margin-left: auto ;
        margin-right: auto ;
        text-align: center;
        padding: 0px;}

    #search-box{
        list-style-type: none;
        display: inline;
        margin-left: 0px;
        margin-right:0px;
    }

    #search-form {
        background-color: transparent;
        position: relative;
     }

    #search-box input[type="text"] {
        width: 400px;
        font-family:Georgia;
        font-style: italic;
        font-size: 90.0%;
        padding: 0px 2 2px 10px ;
        color: #999;
        outline: none;}

    #search-text {
        font-size: 13px;
        font-family:Georgia;
        font-style: italic;
        border-width: 0;
        background: transparent;
    }

    #portfolio{
        display:inline;
           margin: auto; 
            text-align: center; 

    }
    #text-display
            {top:; position: relative;
            display:inline-block;
            padding:5px 10px; 
            font-family:sans-serif; 
            font-weight:bold; 
            font-size:50px; 
            color: white; 
            text-align: center; 
            line-height: 1.2em;margin:0px;
            background-color:#E94F78;
    }

    .morphing-tinting .image-wrap {
        position: absolute;

        -webkit-transition: 1s;
        -moz-transition: 1s;
        transition: 1s;

        -webkit-border-radius: 30em;
        -moz-border-radius: 30em;
        border-radius: 30em;
    }

    .morphing-tinting .image-wrap:hover {
        -webkit-border-radius: 30em;
        -moz-border-radius: 30em;
        border-radius: 30em;
    }

    #socialNetworks{
        float:right;
        margin-top: 110px;
        margin-bottom:60px;
    }

    .twitterBtn{
        float:left;
        background-image:url(images/twitter.png);
        background-position: top left;
        border:none;
        display:block;
        margin-left:15px;
        width:24px;
        height:22px;    
    }
    .twitterBtn:hover {
        background-position: bottom left;
    }

    .facebookBtn{
        float:left;
        background-image:url(images/fb.png);
        background-position: top left;
        border:none;
        display:block;
        margin-left:15px;
        width:24px;
        height:22px;    
    }
    .facebookBtn:hover {
        background-position: bottom left;
    }
      #project{
       margin-left: auto;
        margin-right: auto;
        padding: 0px 0px 0px 0px;
        height:200px;
        width:310px;
        display: inline;
        overflow:hidden;//trick to ensure all elements fit in portfolio
    }

    .workEntry{ 
        width:310px;
        overflow:hidden;
        float: left;
    }

    #thumbAttachment{
        float:left;
        width: 310px;
        height:200px;
        overflow: hidden;
    }

    #inThumb{
        margin-left: auto;
        margin-right: auto;
    }

    #blackCross{
        float:left;
        width: 310px;
        height:200px;
        margin-top:-200px;
        khtml-opacity:0;
        -moz-opacity:0;
        -ms-filter:"alpha(opacity=0)";
        filter:alpha(opacity=0);
        opacity:0;

    }

    #blackCross:visited{

        khtml-opacity:0;
        -moz-opacity:0;
        -ms-filter:"alpha(opacity=0)";
        filter:alpha(opacity=0);
        opacity:0;
    }

    #blackCross:hover{
        khtml-opacity:1;
        -moz-opacity:1;
        -ms-filter:"alpha(opacity=100)";
        filter:alpha(opacity=100);
        opacity:100;
    }

    #backToTop{
        width:61px;
        height:30px;
        float:left;
        margin-left:515px;
        margin-top:-27px;   
    }

    #allsharer{
        float: right;
        margin: 17px 158px 0 0;
    }

    .twitter-share-button {
        width: 92px !important;
    }

    .fb-button {
        position: relative;
        top: 2px;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T19:07:04.510

给你的包装 a `min-width`，并声明一个`max-width`/ `width`。您将获得一个水平滚动条，但您的“元素”将保持原位。您的“元素”自然会随着视口大小流动，因此如果您缩小浏览器，“元素”应该会随着流动而移动。如果您声明视口为特定大小，则流程将在新大小内移动。

希望这可以帮助。

PS - IE7/8 不喜欢 min-width 或 max-width，因此您必须使用 Modernizr 或 Google 来进行 CSS hack。

# html - 使用引导程序时如何解决与 CSS 的对齐问题？

> ID：14386051
> 
> 赞同：0
> 
> 时间：2013-01-17T18:50:40.953
> 
> 标签：html, css, twitter-bootstrap

我正在使用引导程序

不知何故，它似​​乎一团糟。似乎 twitter-bootstrap 正在阻止。
我怎样才能解决这个问题？请查看我的演示。

**演示** [http://jsfiddle.net/5r6UM/4/](http://jsfiddle.net/5r6UM/4/)

![在此处输入图像描述](../Images/3c20d0f075df45817a37a057a817d5f4.png)

**HTML**

```
<span id="chat">

    <span id="comment_652">
        <div class="bubble_row">
            <div class="me_icon">
                <p class="responsive-img">  
        <a href="/user/2"><img alt="Dsc_0023" class="img-polaroid" src="http://t1.gstatic.com/images?q=tbn:ANd9GcTHwJFqUSlCJvXdCKEQ9dPxPhx_FYOcbQqD_Hco7vTSwEK_eVpnD-qTWcBCmg" style="width: 50px; height: 50px" /></a>
</p>
            </div>
            <div class="bubble me">

            <span class='text-error'>02:15:02</span>：&lt;a href="/user/2">Person B</a><br />
            What
            </div>
        </div>
    </span>

    <span id="comment_651">
        <div class="bubble_row">
            <div class="me_icon">
                <p class="responsive-img">  
        <a href="/user/2"><img alt="Dsc_0023" class="img-polaroid" src="http://t1.gstatic.com/images?q=tbn:ANd9GcTHwJFqUSlCJvXdCKEQ9dPxPhx_FYOcbQqD_Hco7vTSwEK_eVpnD-qTWcBCmg" style="width: 50px; height: 50px" /></a>
</p>
            </div>
            <div class="bubble me">

            <span class='text-error'>02:14:51</span>：&lt;a href="/user/2">Person B</a><br />
            Hi there
            </div>
        </div>
    </span>

    <span id="comment_650">
        <div class="bubble_row">
            <div class="bubble you"><span class='text-error'>02:12:53</span>：&lt;a href="/user/1">Person A</a><br />
            Hi

            </div>
            <div class="you_icon">
                <p class="responsive-img">  
        <a href="/user/1"><img alt="X50" class="img-polaroid" src="http://www.miraiha.net/wpblog/wp-content/uploads/2010/10/designreviver-free-twitter-social-icon.jpg" style="width: 50px; height: 50px" /></a>
</p>
            </div>
        </div>
    </span>

    <span id="comment_649">
        <div class="bubble_row">
            <div class="me_icon">
                <p class="responsive-img">  
        <a href="/user/2"><img alt="Dsc_0023" class="img-polaroid" src="http://t1.gstatic.com/images?q=tbn:ANd9GcTHwJFqUSlCJvXdCKEQ9dPxPhx_FYOcbQqD_Hco7vTSwEK_eVpnD-qTWcBCmg" style="width: 50px; height: 50px" /></a>
</p>
            </div>
            <div class="bubble me">

            <span class='text-error'>02:11:46</span>：&lt;a href="/user/2">Person B</a><br />
            Wow
            </div>
        </div>
    </span>

    <span id="comment_645">
        <div class="bubble_row">
            <div class="bubble you">18:03:02：&lt;a href="/user/1">Person A</a><br />
            Hello

            </div>
            <div class="you_icon">
                <p class="responsive-img">  
        <a href="/user/1"><img alt="X50" class="img-polaroid" src="http://www.miraiha.net/wpblog/wp-content/uploads/2010/10/designreviver-free-twitter-social-icon.jpg" style="width: 50px; height: 50px" /></a>
</p>
            </div>
        </div>
    </span>

    <span id="comment_644">
        <div class="bubble_row">
            <div class="bubble you">17:54:43：&lt;a href="/user/1">Person A</a><br />
            Howdy

            </div>
            <div class="you_icon">
                <p class="responsive-img">  
        <a href="/user/1"><img alt="X50" class="img-polaroid" src="http://www.miraiha.net/wpblog/wp-content/uploads/2010/10/designreviver-free-twitter-social-icon.jpg" style="width: 50px; height: 50px" /></a>
</p>
            </div>
        </div>
    </span>

    <span id="comment_643">
        <div class="bubble_row">
            <div class="bubble you">17:54:00：&lt;a href="/user/1">Person A</a><br />
            Yahoo

            </div>
            <div class="you_icon">
                <p class="responsive-img">  
        <a href="/user/1"><img alt="X50" class="img-polaroid" src="http://www.miraiha.net/wpblog/wp-content/uploads/2010/10/designreviver-free-twitter-social-icon.jpg" style="width: 50px; height: 50px" /></a>
</p>
            </div>
        </div>
    </span>

    <span id="comment_642">
        <div class="bubble_row">
            <div class="bubble you">21:15:25：&lt;a href="/user/1">Person A</a><br />
            OK

            </div>
            <div class="you_icon">
                <p class="responsive-img">  
        <a href="/user/1"><img alt="X50" class="img-polaroid" src="http://www.miraiha.net/wpblog/wp-content/uploads/2010/10/designreviver-free-twitter-social-icon.jpg" style="width: 50px; height: 50px" /></a>
</p>
            </div>
        </div>
    </span>

    <span id="comment_641">
        <div class="bubble_row">
            <div class="bubble you">20:47:34：&lt;a href="/user/1">Person A</a><br />
            Hi

            </div>
            <div class="you_icon">
                <p class="responsive-img">  
        <a href="/user/1"><img alt="X50" class="img-polaroid" src="http://www.miraiha.net/wpblog/wp-content/uploads/2010/10/designreviver-free-twitter-social-icon.jpg" style="width: 50px; height: 50px" /></a>
</p>
            </div>
        </div>
    </span>

</span> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T18:53:37.387

取出`.me_icon`边距`.you_icon`

```
.me_icon {
    float: left;
    /*margin: 5px 10px 5px 5px;*/
    text-align: left;
} 
```

特别是顶部和底部边距。

“你的图标”显示在它们所属的消息下方。这是因为当您正确浮动某些内容并希望其他元素位于同一行时，浮动元素必须位于标记中的其他元素之前。只需交换他们的订单：

```
<div class="bubble_row">
  <div class="you_icon">
    <p class="responsive-img">  
      <a href="/user/1"><img alt="X50" class="img-polaroid" src="http://www.miraiha.net/wpblog/wp-content/uploads/2010/10/designreviver-free-twitter-social-icon.jpg" style="width: 50px; height: 50px" /></a>
    </p>
  </div>
  <div class="bubble you"><span class='text-error'>02:12:53</span>：&lt;a href="/user/1">Person A</a><br />
    Hi
  </div>
</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T19:03:23.850

您正在尝试将元素浮动到全宽元素 (.bubble) 旁边。这是应该工作的一种方法：http: [//jsfiddle.net/5r6UM/9/](http://jsfiddle.net/5r6UM/9/)

主要区别：

```
.bubble_row {
  position: relative;
}

.me_icon {
    position: absolute;
    left: 0;
    top: 0;
    margin: 5px 10px 5px 5px;
    text-align: left;    
}

.you_icon {
    position: absolute;
    right: 0;
    top: 0;
    margin: 5px 10px 5px 5px;
    text-align: right;          
} 
```

# unit-testing - 闭包中的Groovy映射强制访问类级别变量

> ID：14386052
> 
> 赞同：0
> 
> 时间：2013-01-17T18:50:49.577
> 
> 标签：unit-testing, groovy, metaprogramming

我正在尝试覆盖构建器中的复杂方法以进行某些单元测试。这是一个 Web 服务请求构建器，因此构建器类有一个名为 的请求类型的实例变量`request`。

所以我正在尝试这样做：

```
def mockBuilder = [complexMethod:{request.setAnAttribute(it)}] as MyBuilder 
```

当我运行单元测试时，我得到一个方法丢失异常

```
No such property: request for class:com.xx.etc.MyBuilderTest 
```

我已经尝试`this.request`并将其设置`resolveStrategy`为第`delegate`一个（我认为这将是课程`MyBuilder`，但没有奏效）。

我知道当它`mockBuilder`被实例化时，它正在调用`MyBuilder`（初始化类的`request`变量）的默认构造函数，所以我想在某个地方该`request`变量是可用的，但我很难找到它。

# elasticsearch - 弹性搜索查询不适用于 curl

> ID：14386053
> 
> 赞同：1
> 
> 时间：2013-01-17T18:51:12.627
> 
> 标签：elasticsearch

运行命令：

```
curl -XGET http://127.0.0.1:9200/30556/_search -d '{
    "query": {
        "constant_score" : {
            "filter" : {
                "term" : { "portal_type" : "Folder"}
            }
        }
    }
}' 
```

产生 0 个结果。输出是：

```
{"took":1,"timed_out":false,"_shards":{"total":5,"successful":5,"failed":0},"hits":{"total":0,"max_score":null,"hits":[]}} 
```

如果事实上，我无法得到任何查询来产生结果。

但是，当我使用 head 插件运行相同的查询时，它工作正常。

我在 Mac OS X 上使用 elasticsearch 0.20.2。我正在使用以下命令启动弹性搜索：

```
bin/elasticsearch -f 
```

我有什么明显的遗漏吗？好像我有正确的语法，我没有得到任何错误。

映射：

```
{
  "30556": {
    "portal_catalog": {
      "properties": {
        "CreationDate": {
          "type": "date",
          "format": "dateOptionalTime"
        },
        "Creator": {
          "type": "string"
        },
        "Date": {
          "type": "date",
          "format": "dateOptionalTime"
        },
        "Description": {
          "type": "string"
        },
        "ModificationDate": {
          "type": "date",
          "format": "dateOptionalTime"
        },
        "SearchableText": {
          "type": "string"
        },
        "Title": {
          "type": "string"
        },
        "Type": {
          "type": "string"
        },
        "UID": {
          "type": "string"
        },
        "allowedRolesAndUsers": {
          "type": "string"
        },
        "created": {
          "type": "date",
          "format": "dateOptionalTime"
        },
        "effective": {
          "type": "date",
          "format": "dateOptionalTime"
        },
        "effectiveRange": {
          "dynamic": "true",
          "properties": {
            "effectiveRange1": {
              "type": "date",
              "format": "dateOptionalTime"
            },
            "effectiveRange2": {
              "type": "date",
              "format": "dateOptionalTime"
            }
          }
        },
        "exclude_from_nav": {
          "type": "boolean"
        },
        "expires": {
          "type": "date",
          "format": "dateOptionalTime"
        },
        "getId": {
          "type": "string"
        },
        "getObjPositionInParent": {
          "type": "long"
        },
        "getObjSize": {
          "type": "string"
        },
        "id": {
          "type": "string"
        },
        "is_default_page": {
          "type": "boolean"
        },
        "is_folderish": {
          "type": "boolean"
        },
        "listCreators": {
          "type": "string"
        },
        "meta_type": {
          "type": "string"
        },
        "modified": {
          "type": "date",
          "format": "dateOptionalTime"
        },
        "object_provides": {
          "type": "string"
        },
        "path": {
          "dynamic": "true",
          "properties": {
            "depth": {
              "type": "long"
            },
            "path": {
              "type": "string"
            }
          }
        },
        "portal_type": {
          "type": "string"
        },
        "review_state": {
          "type": "string"
        },
        "sortable_title": {
          "type": "string"
        },
        "total_comments": {
          "type": "long"
        }
      }
    }
  }
} 
```

示例索引文档：

```
{
        "_index": "30556",
        "_type": "portal_catalog",
        "_id": "30613",
        "_score": 1,
        "_source": {
          "sortable_title": "news",
          "exclude_from_nav": false,
          "meta_type": "ATFolder",
          "Date": "2013-01-14T09:24:56-06:00",
          "CreationDate": "2013-01-14T09:24:56-06:00",
          "path": {
            "depth": 2,
            "path": "/el/news"
          },
          "allowedRolesAndUsers": [
            "Anonymous"
          ],
          "portal_type": "Folder",
          "id": "news",
          "UID": "3116b6c7ec384a9393f238fdde778612",
          "expires": "2499-12-31T00:00:00-06:00",
          "Subject": [],
          "is_folderish": true,
          "is_default_page": false,
          "effectiveRange": {
            "effectiveRange1": "1000-01-01T00:00:00-06:00",
            "effectiveRange2": "2499-12-31T00:00:00-06:00"
          },
          "commentators": [],
          "created": "2013-01-14T09:24:56-06:00",
          "getRawRelatedItems": [],
          "cmf_uid": [],
          "Creator": "admin",
          "end": [],
          "modified": "2013-01-14T09:24:56-06:00",
          "Description": "Site News",
          "ModificationDate": "2013-01-14T09:24:56-06:00",
          "total_comments": 0,
          "in_reply_to": [],
          "getIcon": "",
          "effective": "1000-01-01T00:00:00-06:00",
          "SearchableText": "news  News  Site News ",
          "getObjPositionInParent": 61,
          "object_provides": [
            "collective.syndication.interfaces.ISyndicatable",
            "Products.ATContentTypes.interfaces.folder.IATFolder",
            "Products.CMFCore.interfaces._content.IContentish",
            "z3c.relationfield.interfaces.IHasIncomingRelations",
            "webdav.interfaces.IWriteLock"
          ],
          "last_comment_date": null,
          "review_state": "published",
          "start": [],
          "Type": "Folder",
          "listCreators": [
            "admin"
          ],
          "getId": "news",
          "getObjSize": "1 kB",
          "Title": "News"
        } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-17T20:15:10.177

尝试使用小写的索引名称。

它有效吗？

如果没有，您能否提供您的索引文档和映射（如果有）？

更新：您使用默认分析器，因此您的字段被分解为小写的标记。没有分析 TermFilter 所以它不匹配。

您可以小写您的 TermFilter 或使用已分析的 MatchQuery 或更改您的映射并将字段设置为 not_analyzed。

# list - SML：如何将一个函数传递给一个列表并返回删除所有负实数的列表？

> ID：14386055
> 
> 赞同：2
> 
> 时间：2013-01-17T18:51:20.073
> 
> 标签：list, recursion, sml, ml

这是我到目前为止所得到的......

```
fun positive l1 = positive(l1,[],[])
|   positive (l1, p, n) = 
       if hd(l1) < 0
         then positive(tl(l1), p, n @ [hd(l1])
       else if hd(l1) >= 0
         then positive(tl(l1), p @ [hd(l1)], n)
       else if null (h1(l1))
         then p 
```

是的，这是出于我的教育目的。我在大学上 ML 课，我们必须编写一个程序来返回列表中的最大整数，我想超越它，看看我是否也可以从中删除积极因素。

另外，如果可能的话，谁能指点我一本像样的机器学习书籍或入门书？我们的课文根本没有很好地解释事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T00:51:51.400

你没有提到你的代码没有输入。

您的第一个函数子句只有变量`l1`，用于递归。然而在这里它被用作三元组的第一个元素，作为参数给出。这与 SML 使用的 Hindley-Milner 类型系统并不真正齐头并进。以下非正式想法可能会更好地说明这一点：

让我们首先假设`l1`具有类型`'a`，因此该函数必须接受该类型的参数并返回未知的东西`'a -> ...`。但是，在右侧，您创建一个`(l1, [], [])`必须具有 type的参数`'a * 'b list * 'c list`。但是由于它是作为参数传递给函数的，这也必须意味着`'a`等于`'a * 'b list * 'c list`，显然不是这样。

显然这不是你的初衷。似乎您的意图是拥有一个以列表作为参数的函数，然后同时拥有一个递归辅助函数，该函数需要两个额外的累积参数，即原始列表中的正数和负数列表。

为此，您至少需要为您的辅助函数指定另一个名称，这样它的定义就不会重新绑定原始函数的定义。然后你有一些选项，关于这个辅助函数应该在哪个范围内。一般来说，如果除了从“主”函数调用这个辅助函数没有任何意义，那么它不应该放在“主要”功能之外的范围。这可以使用这样的 let 绑定来完成：

```
fun positive xs = 
    let
      fun positive' ys p n = ...
    in
      positive' xs [] [] 
    end 
```

这样辅助函数`positives'`就不能在`positive`函数之外调用。

有了这个照顾，您的原始代码就会出现更多问题。

*   由于您只返回正整数列表，因此无需跟踪负整数。

*   您应该使用模式匹配来分解列表元素。这样您就无需使用列表的头部和尾部，也无需验证列表中是否确实存在头部和尾部。

    ```
    fun foo []      = ... (* input list is empty *)
      | foo (x::xs) = ... (* x is now the head, and xs is the tail *) 
    ```

*   不应该使用附加运算符 ( `@`)，只要您可以避免它（您总是可以）。问题是当您在左侧有一个巨大的列表而在右侧有一个小列表时，它的运行时间很糟糕（这通常是右侧的情况，因为它主要用于附加一个单个元素）。因此，通常应该认为使用它是不好的做法。

    然而，有一个非常简单的解决方案，即始终连接列表前面的元素（以相反的顺序构建列表），然后在将列表作为最后一件事返回时将其反转（使其按预期顺序排列） ):

    ```
    fun foo [] acc = rev acc
      | foo (x::xs) acc = foo xs (x::acc) 
    ```

鉴于这些小注释，我们最终得到了一个看起来像这样的函数

```
fun positive xs =
    let
      fun positive' [] p = rev p
        | positive' (y::ys) p =
          if y < 0 then
            positive' ys p
          else
            positive' ys (y :: p)
    in
      positive' xs []
    end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T22:04:04.217

你了解过`List.filter`吗？这里可能是合适的——它接受一个类型的函数（它是一个谓词）`'a -> bool`和一个类型的列表`'a list`，并返回一个列表，该列表仅由谓词计算为的元素组成`true`。例如：

```
List.filter (fn x => Real.>= (x, 0.0)) [1.0, 4.5, ~3.4, 42.0, ~9.0] 
```

您现有的代码将不起作用，因为您正在`int`使用`<`. 该代码`hd(l1) < 0`将适用于 列表`int`，而不是`real`. 标准 ML 不会自动强制数字文字。必须明确编写`0.0`, 并`Real.< (hd(l1), 0.0)`用于您的测试。

如果您不想`filter`从标准库中使用，您可以考虑如何实现`filter`自己。这是一种方法：

```
fun filter f [] = []
  | filter f (h::t) =
      if f h 
      then h :: filter f t 
      else filter f t 
```

# c++ - 使用强制转换运算符和单参数构造函数重载类的运算符

> ID：14386067
> 
> 赞同：2
> 
> 时间：2013-01-17T18:52:06.037
> 
> 标签：c++, operator-overloading, typecast-operator

我有这样的代码

```
class Number
{
    int m_value;

public :
    Number(const int value) : 
        m_value(value)
    {
    }

    operator const int() const
    {
        return m_value;
    }

    int GetValue() const
    {
        return m_value;
    }
};

bool operator==(const Number& left, const Number& right)
{
    return left.GetValue() == right.GetValue();
}

class Integer
{
    int m_value;

public :
    Integer(const int value) : 
        m_value(value)
    {
    }

    operator const int() const
    {
        return m_value;
    }

    bool operator==(const Integer& right) const
    {
        return m_value == right.m_value;
    }

    bool operator==(const int right) const
    {
        return m_value == right;
    }

    int GetValue() const
    {
        return m_value;
    }
};

bool operator==(const int left, const Integer& right)
{
    return left == right.GetValue();
}

int main()
{
    Number n1 = 1;
    Number n2 = 1;
    int x3 = 1;

    n1 == n2;
    n1 == x3; // error C2666: 'operator ==' : 3 overloads have similar conversions
    x3 == n1; // error C2666: 'operator ==' : 2 overloads have similar conversions

    Integer i4 = 1;
    Integer i5 = 1;

    i4 == i5;
    i4 == x3;
    x3 == i4;

    return 0;
} 
```

对于类`Number`，我有两个错误，如上面的代码所示。上课`Integer`一切正常。问题是，我想保留生成的类单参数构造函数、强制转换运算符和相等操作（`MyClass == int`, `int == MyClass`, `MyClass == MyClass`），但我只想`operator==`在 class 中实现 as 的一个版本`Number`。我看不出有什么方法可以做到这一点。这是否可能，或者我必须在课堂上拥有所有三个实现`Integer`？我知道为什么会出现这些错误，我只是不喜欢我拥有的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T19:00:10.380

在类`Number`中，您定义一个转换运算符 to`int`并且您的构造函数允许将 a 转换`int`为 a `Number`。因此，当比较 a`Number n`和 an`int x`是否相等时，会产生歧义：编译器应该调用内置的`operator ==`for `int`s 并转换`n`为 an `int`，还是应该选择您的运算符并转换`x`为 a `Number`？两种转换都一样好，它不能选择一个。

所以是的，你必须定义三个版本，或者添加一个模板运算符，它可以完美匹配所有参数的类型并显式地转发给你的运算符，比如这个（但你很可能想用一些`enable_if`来保护它，以限制它的适用性适当的`T`和`U`）：

```
template<typename T, typename U> // beware: this will match anything. to be constrained
bool operator == (T n, U const& u)
{
    return (Number(n) == Number(u));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T19:09:24.257

您只能定义一个`operator==`作为成员函数：

```
bool operator==(const int& right) const
{
    std::cout << "custom\n";
    return this->GetValue() == right;
} 
```

然后，

*   `n1==n2`:`n2`将转换为`int`并使用自定义运算符。
*   `n1 == n3`：将使用自定义运算符
*   `n3==n1`: 将使用内置运算符

请注意，您希望您`operator==`能够`const`比较常量`Number`s

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-17T19:14:53.623

在 C++11 中，您可以`operator int`明确表示。

另一种方法是使用 SFINAE 来创建一个`==`适用于一个或多个`Number`参数的模板，但这是使用火箭筒杀死一只蚂蚁。

# wpf - 如何使 ICommand CanExecute 以 false 开头？

> ID：14386073
> 
> 赞同：0
> 
> 时间：2013-01-17T18:52:46.197
> 
> 标签：wpf, command, canexecute

我的 viewModel 中有错误验证，因此当它的`UserName`长度不是至少 2 个字符时，它会出现验证错误。

当我的应用程序启动时，该字段没有经过验证，被认为没有错误。只有当 setter 被调用时，它才会检查输入是否有效。在我的表格中，这会导致加载时`TextBox`. 但是，一旦用户输入一个字符，`UserName`setter 就会被调用，它会看到长度小于 2 个字符，因此会出现验证错误。

这就是它默认的工作方式，这就是我想要的。我不想从打开表单开始并在`TextBox`.

现在，在这个表单上，我有一个绑定到 ICommand 的按钮。当论坛加载时，由于该`UserName`字段在技术上不被认为有任何错误，因此启用了该按钮。但是，当用户输入一个字符时，它会变为禁用，如果他删除所有内容，它将保持禁用状态。

我希望我的表单加载没有任何错误，但要禁用该按钮。

现在，我的`CanExecute()`方法是检查我在 ViewModel 中拥有的字段，该字段基本上检查`errors`列表计数是否大于 0。如果是，则它有错误并因此返回 true。如果不是，则返回 false。

我有办法解决上述困境，但我不喜欢它。我有一张这样的支票。

```
return UserName.Length < 2 || errors.Count > 0 
```

现在这看起来很好，但是如果我有更多的字段要检查，例如`Address`and `Port`，我也必须添加这些。所有这一切真正的作用是为 提供这个初始的 false `CanExeute()`，它在所有其他时间都是无用的，因为它将是多余的。如果`UserName.Length < 2`，当然`errors.`数组中会有一些错误。

很好，如果创建 my `ICommand`（在本例中是`DelegateCommand`from `Prism`），我可以将其初始化为 false 并因此禁用。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-17T19:06:46.773

听起来您应该做的就是在命令开始时强制执行命令的“CanExecute”，以确保它正在查看最新的“标准”。

由于接口需要通过声明事件处理程序

```
public event EventHandler CanExecuteChanged; 
```

我确定您的 ICommand 处理程序类中有一些东西，例如

```
public void RaiseCanExecuteChanged()
{
    if (CanExecuteChanged != null)
        CanExecuteChanged(this, new EventArgs());
} 
```

也就是说，在您的视图模型启动时，您实例化了您的 ICommand 对象引用，我只想

```
yourICommandButton.RaiseCanExecuteChanged(); 
```

这将强制检查事件并在字段中的第一次击键之前将自身刷新为启用或不启用。

澄清......虽然我提到了“按钮”，但我知道视图模型中没有实际的“按钮”，而是一个通过 Execute/CanExecute 绑定处理按钮操作的 ICommand 对象。

至于刷新“红色”边框，当您只是要求 ICommand 处理程序“RaiseCanExecuteChanged”时，不应该发生这种情况。如果“CanExecute”函数返回 FALSE，它将为用户禁用...

```
public bool CanUserClickMe()
{
   return UserName.Length > 1 && errors.Count == 0;
} 
```

这实际上并不是针对任何显式字段调用验证测试，只是查看人员已经可以使用的属性。如果用户名不是至少两个字符，它将返回 FALSE 并因此禁用按钮 ASSOCIATED 到 ICommand 对象。

# c# - 字符串文字仍然以双斜杠结尾？

> ID：14386076
> 
> 赞同：0
> 
> 时间：2013-01-17T18:53:13.170
> 
> 标签：c#, string, string-literals

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-17T18:54:02.367

The double slashes are only there for the debugger, not your actual application. Your code is fine.

# excel - AutoHotKey Excel 热字符串公式使用箭头键查找方程的单元格

> ID：14386077
> 
> 赞同：0
> 
> 时间：2013-01-17T18:53:15.300
> 
> 标签：excel, scripting, excel-2007, autohotkey, vba

我正在尝试使用箭头键创建几个热字串来为创建的公式选择单元格。

```
:*:=concacane::
send =CONCATENATE({right},{right 2},{right 3})
return 
```

以上是我希望调用“CONCATENATE”函数并选择我正在输入的单元格右侧的三个单元格的代码。不幸的是，Excel 似乎逃脱了我正在工作的单元格，我最终逗号和括号分布在右侧的几个单元格中，而不是我正在寻找的工作公式。

我尝试使用 'sendraw' 并在第二个 'send' 行上的 '=CONCATENATE(' 之后添加所有内容，希望 '=' 是某种让我感到困惑的修饰符，但这似乎没有帮助。我也尝试使用组合键而不是热字符串，但我无法让该脚本执行任何操作，而且组合键无论如何都不太理想......

有人知道我怎样才能让它工作吗？提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T21:16:12.877

我认为一旦您在 {right} 命令周围添加空格，这将起作用。

```
:*:cc\:: ; cc\ is shorter for me than =concacane
Send, =CONCATENATE( {right 1} , {right 2} , {right 3} ) {Enter}
Return 
```

在 Excel 中对此进行了测试，并且可以正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-25T06:26:34.913

这可以在 COM 中完成

```
:*:cc\::
send, {Escape}
XlApp := ComObjActive("Excel.Application")
a := XlApp.ActiveCell.Offset(0,1).Address
b := XlApp.ActiveCell.Offset(0,2).Address
c := XlApp.ActiveCell.Offset(0,3).Address
XlApp.ActiveCell.Offset(0,0).value := "=CONCATENATE(" a "," b "," c ")"
Return 
```

# java - Opengl 对象翻译

> ID：14386087
> 
> 赞同：0
> 
> 时间：2013-01-17T18:53:38.207
> 
> 标签：java, opengl, position, translation

我正在使用 opengl 进行我的学校项目，我应该使用一些提供的模型和我自己的想法来创建一个“基本场景”。我将创建一个简单的农场：已经用顶点制作了一座房子，并在它前面放了一个猫模型……但这是我的担忧：

当我开始编码时，我意识到每个模型都链接到以前的模型矩阵？例如一段代码：

```
public void display(GLAutoDrawable drawable) {
    final GL3 gl = drawable.getGL().getGL3();
    loader.setUniformMatrix("projection", projection);

    gl.glClear(GL3.GL_COLOR_BUFFER_BIT | GL3.GL_DEPTH_BUFFER_BIT);

    myTexture.bind(gl, modeling, "my_texture");

    myTexture.bind(gl, program, "my_texture");

    Mat4 mv = MatrixMath.lookAt(this.eyeX,this.eyeY,this.eyeZ,this.at,this.up);

    program.setUniformMatrix("model_view", mv);
    program.use(gl);
    vbo.bind(gl);
    gl.glDrawArrays(GL3.GL_TRIANGLES, 0, numVertices);
    // 2nd part
    mouseMv = mv;
    modeling.setUniformMatrix("model_view", mouseMv);
    Mat4 translate = MatrixMath.translate(1.0f, 0.35f, 0);
    Mat4 rotate = MatrixMath.rotationX(-270.0f);
    mouseMv = mouseMv.mul(translate);
    mouseMv = mouseMv.mul(rotate);

    angle += 2.0f;
    if (angle > 360.0f)
    angle -= 360.0f;

    rotate = MatrixMath.rotationZ(angle);
    mouseMv = mouseMv.mul(rotate);
    modeling.setUniformMatrix("model_view", mouseMv);
    modeling.use(gl);
        for (Map.Entry<String, VertexBufferObject> entry : vboHashMap.entrySet()) {
            String key = entry.getKey();
            entry.getValue().bind(gl);
            gl.glDrawArrays(GL3.GL_TRIANGLES, 0, SGFLoader.getNumVertices(key));
        }
} 
```

（对于我们需要使用的“简单框架”非常抱歉……它不允许我使用网络中提供的教程）

```
Mat4 mv = MatrixMath.lookAt(this.eyeX,this.eyeY,this.eyeZ,this.at,this.up);

program.setUniformMatrix("model_view", mv); 
```

我创建了一个“查看矩阵”，它允许我将眼睛放在相机上查看给定点。现在是 (0.0, 0.0, 0.0);

之后，当我从顶点绘制我的房子时，它被放置在给定的点（以 (0.0, 0.0, 0.0) 为中心的矩形）；

当我想放置鼠标模型时，我使用前一个对象的最后一个转换矩阵来引用它（在这种情况下，我使用 mv 矩阵 [我从类示例中获取它]）；我可以把它放在任何其他地方而不需要参考以前的对象吗？在教程中，我发现他们使用矩阵推送和矩阵弹出来获取不同的对象。我想控制鼠标移动，并通过按键盘按钮在场景中移动它，但没有成功。我试图将 mouseMv 乘以一个平移矩阵，但它没有改变它的位置。有什么建议可以让鼠标在场景中“可控”和可移动吗？

当我为 mouseMv 创建一个新矩阵时，该对象不可见。

这是我的担忧。当我将在我的场景中创建大量对象时，他们将不得不参考之前创建的对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T19:45:26.867

尝试将变换矩阵理解为浓缩为单个实体的一系列变换。您可以使用矩阵链接转换。你从一个我们称之为的lookAt矩阵开始`view`。

然后对于每个模型，您都有自己的模型矩阵，例如`model_transform_mouse`，`model_transform_cat`等等。模型视图复合矩阵是视图与模型变换相乘的结果

```
modelview = view · model_transform_ 
```

因此，创建一个通用的lookAt 矩阵，然后为每个模型创建一个新的模型视图矩阵，方法是首先复制该视图矩阵并将模型变换乘以它。

```
Mat4 view = MatrixMath.lookAt(this.eyeX,this.eyeY,this.eyeZ,this.at,this.up);

Mat4 model_transform_cat = ...
Mat4 modelview_cat = view.mul(model_transform_cat); //assuming Mat4::mul does not modify the calling instance 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T19:54:23.920

OpenGL 有一个堆栈机制，允许您在某些点保存变换矩阵。您应该考虑明智地使用场景中的每个元素，`glPushMatrix()`并`glPopMatrix()`按照您想要的方式准确定位。

# php - 使用 PHP-GA 服务器端分析跟踪跟踪唯一访问者

> ID：14386088
> 
> 赞同：1
> 
> 时间：2013-01-17T18:53:43.160
> 
> 标签：php, google-analytics, analytics

我正在尝试将[这个 PHP-GA 跟踪库](http://code.google.com/p/php-ga/)用于 PHP，但跟踪唯一访问者似乎存在问题。其他人也遇到过这个问题，但建议的解决方案似乎不起作用。

这是我尝试过的：

```
$tracker = new GoogleAnalytics\Tracker('UA-XXXXXXX-XX', 'testdomain.com');

if (!isset($_SESSION['SSGA_UniqueID3'])) {
    $visitor = new GoogleAnalytics\Visitor();
    $_SESSION['SSGA_UniqueID3'] = rand(1000000,2000000);
} else {
    $visitor = unserialize($_SESSION['SSGA_visitor']);
}

$visitor->setUniqueId($_SESSION['SSGA_UniqueID3']);
$visitor->setIpAddress($_SERVER['REMOTE_ADDR']);
$visitor->setUserAgent($_SERVER['HTTP_USER_AGENT']);
$visitor->setScreenResolution('1024x768');

$session = new GoogleAnalytics\Session();
$visitor->addSession($session);
$_SESSION['SSGA_visitor'] = serialize($visitor); 
```

**任何人都知道如何使用此库跟踪唯一访问者？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T00:45:51.793

在搜索了一段时间如何解决这个问题之后，似乎需要的只是开始会话。通常这是给定的，但在外部系统上使用时可能会忘记。

```
session_start(); 
```

# .net - .NET 向系统类添加类方法

> ID：14386095
> 
> 赞同：0
> 
> 时间：2013-01-17T18:54:06.703
> 
> 标签：.net, class, datetime, extension-methods

> **可能重复：**
> [为什么不支持 C# 静态类扩展方法？](https://stackoverflow.com/questions/4909156/why-arent-c-sharp-static-class-extension-methods-supported)

**一般问题：**

在 Objective-C 中，我可以向任何（我认为？）类添加一个类别。在该类别中，我可以定义类或实例方法。

我知道如何在 .NET 中创建一个扩展方法，它允许我实现与 Objective-C 类别实例方法相同的东西。

有没有办法制作一个类方法的扩展方法？

**具体问题：**

我创建了一个方法，该方法接受一个`System.DateTime`值并返回另一个`System.DateTime`值，该值表示所提供值之前的月份的第一天。我把它变成了一个扩展方法，我叫它如下：

```
Dim dt As DateTime = Now.FirstOfPriorMonth() 
```

`Now`但是，我只在`Now`. 因此，我想调用以下内容：

```
Dim dt As DateTime = System.DateTime.FirstOfLastMonth() 
```

这可能吗？我意识到我当前工作的解决方案很好，所以我真的更想知道什么是可能的，而不是试图“解决”我当前的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T20:04:09.667

我不会全力以赴尝试扩展 Microsoft 的静态类：只需启动您自己的通用日期/时间实用程序类并使用它：

```
Dim dt As DateTime = YourCommonCode.DateTimeUtils.FirstOfLastMonth() 
```

# c# - C# Enum VS Nullable 属性名称冲突

> ID：14386097
> 
> 赞同：4
> 
> 时间：2013-01-17T18:54:17.920
> 
> 标签：c#, .net, enums, nullable, naming

关于 Enum VS 属性名称冲突的问题有[this](https://stackoverflow.com/questions/211567/enum-and-property-naming-conflicts)、[this](https://stackoverflow.com/questions/2258033/nested-enum-and-property-naming-conflicts)和[this 。](https://stackoverflow.com/questions/495051/c-sharp-naming-convention-for-enum-and-matching-property)

我的问题不是关于命名约定，而是我想知道如何解决下面代码中演示的名称冲突：

```
namespace Test
{
    public class Person
    {
        // 1)
        // Gender? Gender { get; set; }

        // 2)
        Gender Gender { get; set; }

        public Person ()
        {
            // 1 - Error CS1061: Type `Test.Gender?' does not contain a definition for `Male' and no extension method `Male' of type `Test.Gender?' could be found (are you missing a using directive or an assembly reference?) (CS1061) (Test)
            // 2 - OK
            Gender = Gender.Male;
        }
    }

    public enum Gender
    {
        Male = 1,
        Female
    }
} 
```

如果我在 2) 中声明属性，`Gender Gender { get; set; }`则代码编译成功，但是，如果我在 1) 中声明`Gender? Gender { get; set; }`（在上面的代码中注释）我得到错误

```
Error CS1061: Type `Test.Gender?' does not contain a definition for `Male' and no extension method `Male' of type `Test.Gender?' could be found (are you missing a using directive or an assembly reference?) (CS1061) (Test) 
```

为什么会这样？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-17T18:58:14.737

`Gender?`意思是`Nullable<Gender>`，这意味着当您编写`Gender.Male`编译器时，编译器认为您正试图`Male`在`Nullable<Gender>`实例上调用的属性上调用 getter，即被`Gender`解释为对`this.Gender`属性的读取以及对结果`Male`调用的属性的读取。`Male`

编译器不会将 case (2) 识别为错误，因为枚举不能有方法，因此唯一有意义的解决方案是符号本身是枚举本身。

您可以通过增加名称限定来解决此问题：

```
namespace Acme.Fruits.Banana
{
    ...
    public Person()
    {
        Gender = Banana.Gender.Male
    }
    ...
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-05-16T18:46:06.873

属性或局部变量优先于类型/枚举，这意味着如果声明与类型/枚举同名的变量或属性，编译器会将标识符的任何使用解析为变量/属性。

```
public class Test
{
     public static void SomeMethod(){}
}

public static void Main()
{
     Test.SomeMethod();//ERROR... cannot use variable before declaring it.
     object Test = new object();
     Test.SomeMethod();//ERROR... object does not have a method SomeMethod
} 
```

此规则的唯一例外是如果属性/变量与其自己的类型具有相同的名称，在这种情况下编译器允许它访问静态成员。

```
public class Test
{
     public static void SomeMethod(){}
}

public static void Main()
{         
     Test Test = new Test();
     Test.SomeMethod();//Works
} 
```

然而，可为空的类型与它所包含的类型不同，而是名称的形式为`Nullable<T>`，并且两者之间只有隐式转换，因此在可为空的情况下，编译器将不再允许访问枚举成员或静态属性。

```
public struct Test
{
     public static void SomeMethod(){}
}

public static void Main()
{         
     Test? Test = new Test();
     Test.SomeMethod();//ERROR... Test does not have method SomeMethod
} 
```

以类似的方式，它必须是变量的类型化声明，因为编译器需要关于它，例如以下内容将不起作用：

```
public class Test
{
     public static void SomeMethod(){}
}

public static void Main()
{         
     object Test = new Test();
     Test.SomeMethod();////ERROR... object does not have a instance method SomeMethod
} 
```

# silverlight - XAML 列表框参考元素

> ID：14386106
> 
> 赞同：0
> 
> 时间：2013-01-17T18:54:57.543
> 
> 标签：silverlight, xaml

在一个按钮上单击我试图在代码隐藏中迭代这个列表并访问`checkboxApproved`元素

```
<ListBox x:Name="listGroups" ItemsSource="{Binding Data, ElementName=ReviewsDataSourceT32c}">
    <ListBox.ItemTemplate>
        <DataTemplate>
            <Grid>
                <Grid.RowDefinitions />
                 <Grid.ColumnDefinitions>
                    ...
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Column="0" Text="{Binding Path=Platform}"/>                    
                <CheckBox Name="checkboxApproved"  Grid.Column="3" /> 
```

代码隐藏

```
foreach (var item in listGroups.ItemsSource)
{
    if (item.checkboxApproved == checked) { ... }
} 
```

这不起作用，因为我正在从数据源引用绑定的对象。

目前`checkboxApproved`没有绑定。一种方法是使用 PresentationModel 并将其传递，然后通过 ItemsSource 进行访问，如上所述。如果可能的话，我想保持简单，并按原样引用它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T11:34:06.717

已经采用了presentationModel方法

# sql - SQL - 选择同一列，两次

> ID：14386107
> 
> 赞同：3
> 
> 时间：2013-01-17T18:55:05.313
> 
> 标签：sql, database-design, select

我不知道它是否正确，但请查看以下架构：

![在此处输入图像描述](../Images/dee8362d8536f856085d541cc548292e.png)

实体可以是承运人或客户。每个客户都必须与一个承运人关联，这个承运人可以是自己的客户。

我被卡住了，尝试执行一个返回客户**姓名**和他的承运人**姓名的单一查询但没有成功。**有没有办法进行这样的操作？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T18:59:45.383

我将 id_carrier 解释为运营商的实体 ID：

```
select ec.name as CustomerName, eca.name as CarrierName
from customer c join
     entity ec
     on c.id_entity = e.id_entity join
     entity eca
     on c.id_carrier = eca.id_entity 
```

这消除了加入运营商表的需要，除非您需要从那里获取更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-17T18:59:56.777

您需要对`entity`表连接两次，每种类型一次。使用它们的别名（`ca, cu`如下）来引用`SELECT`列表中的每一个。

```
SELECT
  /* Carrier info */
  ca.id_entity AS carrier_id_entity,
  ca.name AS carrier_name,
  ca.date AS carrier_date,
  carrier.carrier_stuff,
  /* Customer info */
  cu.id_entity_as AS customer_id_entity,
  cu.name AS customer_name,
  cu.date AS customer_date,
  customer.discount,
  customer.payment
FROM
  carrier 
  JOIN customer ON customer.carrier_id =  carrier.id_entity
  /* JOIN first against entity for carrier */
  JOIN entity ca ON carrier.id_entity = ca.id_entity
  /* and again between customer and entity */
  JOIN entity cu ON customer.id_entity = cu.id_entity 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-17T19:06:58.207

加入`entity`两次并给`name`列别名。`carrier`如果不需要其他字段，请删除最后一个连接。

```
select customer_entity.name as customer_name, customer.credit, -- additional customer fields...
        carrier_entity.name as carrier_name, carrier.carrier_stuff -- additional carrier fields...
        from entity as customer_entity
        inner join customer on (customer.id_entity = customer_entity.id_entity)
        inner join entity as carrier_entity on (customer.id_carrier = carrier_entity.id_entity)
        inner join carrier on (carrier.id_entity = carrier_entity.id_entity) 
```

# asp.net-mvc - 从同一项目中的普通 web mvc 调用 web api

> ID：14386109
> 
> 赞同：3
> 
> 时间：2013-01-17T18:55:22.240
> 
> 标签：asp.net-mvc, asp.net-web-api

我有一个包含普通 MVC 控制器和 web api 控制器的 web MVC 应用程序。

什么是从同一项目中的正常 MVC 控制器操作调用 Web api 控制器的正确方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T19:10:48.433

ASP.Net Web API 旨在通过 HTTP 调用，而不是从您的服务器端逻辑调用。也许您呈现的演示文稿可以通过客户端请求（例如 ajax）调用您的 Web API。

如果您发现自己的 MVC 控制器的操作需要执行仅在 Web API 操作中可用的代码，那么您应该考虑将该代码与您的 Web API 分离，并将其移动到代码中更与平台无关的区域（服务层？）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T08:11:59.360

如果您只需要一种将 JSON（或类似的）发送回客户端的方法，您可以简单地选择从 MVC 控制器返回除视图之外的其他内容。然后这一切都在您的 MVC Web 应用程序中处理，您不需要使用 Web API。

```
public JsonResult DetailsJson(int id)
{
    Car car = carRepository.Find(id);
    return Json(car, JsonRequestBehavior.AllowGet);
} 
```

然后将使用调用此示例

```
/Cars/DetailsJson/3 
```

请注意，出于测试原因，示例中允许 GET（通过添加 JsonRequestBehavior.AllowGet），如果您只想支持 POST 请求，可能会将其删除。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T19:13:31.580

请参阅[从 MVC 控制器调用 WEBAPI 服务是一种反模式吗？](https://stackoverflow.com/questions/11502901/is-it-an-antipattern-to-call-webapi-services-from-mvc-controllers)

简而言之，使用 httpclient 来访问您的 api。

# javascript - 根据区域设置格式化日期字符串而不创建日期对象 (JavaScript)

> ID：14386112
> 
> 赞同：1
> 
> 时间：2013-01-17T18:55:46.830
> 
> 标签：javascript, string, date, format, locale

我有一个日期字符串，如下所示： 2013-04-06T14:15:00 我正在寻找类似于 toLocaleDateString() [(documentation)](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date/toLocaleDateString)的函数。但是，这些函数不采用 String 参数；您需要先创建一个 Date 对象。我试图完全避免时区，所以有人知道一个函数（标准或来自插件），它可以使用特定语言环境的规则（1/17/2013 与 17/1/2013 等）格式化日期字符串，仅使用我的日期字符串？

我目前正在使用 jQuery，以及这个用于格式化日期的插件：[jQuery.dateFormat](https://github.com/phstc/jquery-dateFormat)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T19:07:56.777

将您的日期字符串传递给 Date 构造函数。它解析大多数合法格式。

```
new Date("1/17/2013")
new Date("2013-04-06T14:15:00") 
```

# python - python ttk.Entry 如何使输入居中

> ID：14386113
> 
> 赞同：17
> 
> 时间：2013-01-17T18:55:52.253
> 
> 标签：python, tkinter, ttk

![我的应用程序的屏幕截图](../Images/cac402afb6ed4010e288973cdbb3a35d.png)

这是我正在使用 Python Tkinter 编写的程序的屏幕截图。我使用`ttk.Entry`小部件来获取用户输入。

我想知道如何将输入**居中**`Entry`（如您所见，输入现在卡在小部件的**左侧）**

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2013-01-17T19:05:38.113

条目小部件采用选项`justify`，对于居中的文本应该是`'center'`。创建小部件时，请执行以下操作

```
e = ttk.Entry(master, ..., justify='center') 
```

# python - 如何从 Pandas 数据框函数调用中回顾前几行？

> ID：14386117
> 
> 赞同：4
> 
> 时间：2013-01-17T18:56:14.623
> 
> 标签：python, dataframe, pandas, algorithmic-trading, quantitative-finance

我正在研究/回测交易系统。

我有一个包含 OHLC 数据的 Pandas 数据框，并添加了几个[计算列](https://stackoverflow.com/questions/12376863/adding-calculated-columns-to-a-dataframe-in-pandas)，这些列标识了我将用作启动头寸的信号的价格模式。

我现在想添加一个进一步的列来跟踪当前的净头寸。我曾尝试使用 df.apply()，但将数据框本身作为参数而不是行对象传递，与后者一样，我似乎无法回顾前几行以确定它们是否导致任何价格模式：

```
open_campaigns = []
Campaign = namedtuple('Campaign', 'open position stop')

def calc_position(df):
  # sum of current positions + any new positions

  if entered_long(df):
    open_campaigns.add(
        Campaign(
            calc_long_open(df.High.shift(1)), 
            calc_position_size(df), 
            calc_long_isl(df)
        )
    )

  return sum(campaign.position for campaign in open_campaigns)

def entered_long(df):
  return buy_pattern(df) & (df.High > df.High.shift(1))

df["Position"] = df.apply(lambda row: calc_position(df), axis=1) 
```

但是，这会返回以下错误：

```
ValueError: ('The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()', u'occurred at index 1997-07-16 08:00:00') 
```

滚动窗口函数似乎很自然，但据我了解，它们仅作用于单个时间序列或列，因此也不起作用，因为我需要在多个时间点访问多个列的值。

实际上我应该怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-17T19:08:00.270

这个问题的根源在于 NumPy。

```
def entered_long(df):
  return buy_pattern(df) & (df.High > df.High.shift(1)) 
```

`entered_long`正在返回一个类似数组的对象。NumPy 拒绝猜测一个数组是 True 还是 False：

```
In [48]: x = np.array([ True,  True,  True], dtype=bool)

In [49]: bool(x)

ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all() 
```

要解决此问题，请使用`any`or`all`指定数组为 True 的含义：

```
def calc_position(df):
  # sum of current positions + any new positions

  if entered_long(df).any():  # or .all() 
```

如果其中的任何项目为 True，则该`any()`方法将返回`entered_long(df)`True。如果其中的所有项目都为 True，则该`all()`方法将返回`entered_long(df)`True。

# ruby - 使用 net/http 在 ruby 中执行请求

> ID：14386119
> 
> 赞同：3
> 
> 时间：2013-01-17T18:56:34.380
> 
> 标签：ruby

我正在尝试使用 net/http 来获取基于我挖出的旧库的 API 调用响应[https://github.com/jurisgalang/facebook/blob/master/lib/facebook/graph-object.rb#L22](https://github.com/jurisgalang/facebook/blob/master/lib/facebook/graph-object.rb#L22)

```
require 'net/http'

API_HOST       = "graph.facebook.com"
API_BASE_URL   = "https://#{API_HOST}"
path           = "/boo"

uri            = URI.parse "#{API_BASE_URL}#{path}"
http           = Net::HTTP.new(uri.host, uri.port)
res            = http.get(uri.request_uri, nil) 
```

最终`uri`成为`<URI::HTTPS:0x0000010091fc48 URL:https://graph.facebook.com/boo>`

这导致

> NoMethodError：nil 的未定义方法“键”：NilClass

我认为这是因为`dest`参数已过时：[http ://ruby-doc.org/stdlib-1.9.3/libdoc/net/http/rdoc/Net/HTTP.html#method-i-get](http://ruby-doc.org/stdlib-1.9.3/libdoc/net/http/rdoc/Net/HTTP.html#method-i-get)

所以我没有

```
res            = http.get(uri.request_uri) 
```

这导致

> NoMethodError：未定义的方法“空？” 为了

```
#<URI::HTTPS:0x0000010091fc48 URL:https://graph.facebook.com/boo> 
```

如何使用 net/http 和 http.get 请求响应？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-17T19:00:48.257

快速浏览一下[文档](http://ruby-doc.org/stdlib-1.9.3/libdoc/net/http/rdoc/Net/HTTP.html#method-i-get)，第二个参数`get`是一个哈希值，而你传递的是 nil，请参阅：

```
http.get(uri.request_uri, nil) 
```

您的第二次尝试应该没问题，尽管我确实发现在我的设置（ruby 1.9.3 和 MacPorts 的 openssl 库）中 Net::HTTP 拒绝 Facebook 的 ssl 证书（我得到“对等方重置连接”。以下代码片段对我有用：

```
require 'net/http'

API_HOST       = "graph.facebook.com"
API_BASE_URL   = "https://#{API_HOST}"
path           = "/boo"

uri            = URI.parse "#{API_BASE_URL}#{path}"
http           = Net::HTTP.new(uri.host, uri.port)
http.use_ssl   = true
http.verify_mode = OpenSSL::SSL::VERIFY_NONE
res            = http.get(uri.request_uri)
puts res.body 
```

请注意，我没有验证 SSL 证书，这是一个潜在的安全问题。然而，作为概念证明，这个片段对我有用——所以希望这会给你一个很好的调试工作数据点。

# javascript - json获取字段名

> ID：14386121
> 
> 赞同：2
> 
> 时间：2013-01-17T18:56:44.590
> 
> 标签：javascript, jquery

我想将字段名称推送到选项值中，并将结果推送到选择的文本中。它应该如下所示：

```
<select id="ddl_fields">
    <option value="RoleId">e407d28a</option>
    <option value="RoleName">Sales</option>
</select> 
```

这是从数据库返回的 json 对象：

```
"[{"RoleId":"e407d28a","RoleName":"Sales"}]" 
```

这是代码，它会返回一个有效的结果：

```
function getFields(){
        var the_id = $(".hid_ID").val();
        var jsonText = JSON.stringify({ id: the_id });
        $.ajax({
            type: "POST",
            url: "bc_Admin.aspx/getFields",
            data: jsonText,
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                if (data.d != "0") {
                    var obj = $.parseJSON(data.d);
                     //what needs to change???
                    $.each(obj, function (index, value) {
                        $('#ddl_fields')
                        .append($("<option value=" + value.id_Role + ">" + value.RoleName + "</option>"));
                    });
                }
            } //end success
        });
    } 
```

与此问题类似，但需要 JQuery 解决方案。 [如何使用 ExtJS 获取/列出 JSON 数据的所有字段名称？](https://stackoverflow.com/questions/7370828/how-to-get-list-all-field-names-of-a-json-data-with-extjs)

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T18:59:56.657

您必须遍历对象的键，并使用`hasOwnProperty`它来确保它是对象的键而不是其原型的键。

```
var key, keys = [];

for (key in obj) {
  if (obj.hasOwnProperty(key))
    keys.push(key)
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-17T19:00:07.983

您需要遍历对象并使用 hasOwnProperty()。

```
for (var i in inputData) {
  if (inputData.hasOwnProperty(i)) {
  console.log(i + " , " + inputData[i]);
}} 
```

此示例将仅记录到控制台键：值。

[https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/hasOwnProperty](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/hasOwnProperty)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-17T19:05:07.493

假设`data.d`您发布的格式`obj`是一个数组，并且您想要迭代数组中的对象而不是数组本身。

```
$.each(obj[0], function (index, value) {
    $('#ddl_fields')
    .append($("<option value=" + index + ">" + value + "</option>"));
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-17T19:04:08.817

只是改变

```
$.each(obj, function (index, value) { 
```

至

```
$.each(obj[0], function (index, value) { 
```

* * *

问题是您在 json 中返回一个数组

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-17T19:07:25.820

不知道我是否理解，但这是我要得到你想要的东西（我也让你的代码更简单）：

```
function getFields(the_id){
    $.ajax({
        type: "POST",
        url: "bc_Admin.aspx/getFields",
        data: { id : the_id },
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: function (data) {
            for(var i = 0; i < data.length; i++){
                console.log(i + ": " + data[i]);
            }
        },
        error : function(s , i , error){
            console.log(error);
        }
    });
} 
```

# jstl - JSTL - 如何在字符串中使用所有格撇号？

> ID：14386123
> 
> 赞同：0
> 
> 时间：2013-01-17T18:56:49.723
> 
> 标签：jstl, apostrophe

```
 <c:choose> 
    <c:when test="${place=='Bob's Car'}">
    <c:set var="place" value="Truck"/>
    </c:when>
 </c:choose> 
```

由于“ Bob's ”中的撇号，代码无法正常工作。有什么解决办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T19:10:51.483

尝试使用 \ this 使 java 理解您的表达语言中的简单撇号。

为我奔跑！

# android - Android菜单（ActionBar？）点击更改片段

> ID：14386125
> 
> 赞同：0
> 
> 时间：2013-01-17T18:57:04.660
> 
> 标签：android

我正在尝试做一个简单的任务，即为我的活动设置片段，以便在选择菜单项时在它们之间进行更改。

1.  这是一个合适的android设计模式吗？在 iOS 中，我将为每个“选项卡”设置单独的视图控制器，但在 Android 中，您似乎应该有 1 个带有许多片段的活动。

2.  是否有用于创建带有片段的简单菜单的示例代码，这就是我想要做的。

（我发现 android 文档与 iOS 不符）

main_menu.xml

```
<item
    android:id="@+id/need_to_know_menu_item"
    android:showAsAction="ifRoom|withText"
    android:title="@string/need_to_know"
    />
<item
    android:id="@+id/schedule_menu_item"
    android:showAsAction="ifRoom|withText"
    android:title="@string/schedule"
    />
    <item
    android:id="@+id/news_menu_item"
    android:showAsAction="ifRoom|withText"
    android:title="@string/news"
    />
    <item
    android:id="@+id/map_menu_item"
    android:showAsAction="ifRoom|withText"
    android:title="@string/map"
    />
        <item
    android:id="@+id/tweets_menu_item"
    android:showAsAction="ifRoom|withText"
    android:title="@string/tweets"
    />
        <item
    android:id="@+id/players_menu_item"
    android:showAsAction="ifRoom|withText"
    android:title="@string/players"
    /> 
```

MainActivity.java

```
package com.example.app;

import android.os.Bundle;
import android.app.ActionBar;
import android.app.Activity;
import android.content.Intent;
import android.view.Menu;
import android.view.MenuItem;

public class MainActivity extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.main_menu, menu);
        getActionBar().setHomeButtonEnabled(true);
        return true;
    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item)
    {
        switch(item.getItemId())
        {
            case android.R.id.home:
            case R.id.need_to_know_menu_item:
                Intent intent = new Intent(this, MainActivity.class);
                intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
                startActivity(intent);
                return true;

            case R.id.schedule_menu_item:
                return true;

            case R.id.news_menu_item:
                return true;

            case R.id.map_menu_item:
                return true;

            case R.id.tweets_menu_item:
                return true;

            case R.id.players_menu_item:
                return true;

            default:
                return super.onOptionsItemSelected(item);

        }
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T19:15:42.837

> 这是一个合适的android设计模式吗？

这有点奇怪，因为它无缘无故地导致了相当重量级的活动。

片段通常用于您希望根据屏幕尺寸拥有不同内容组合的地方（例如，在平板电脑上同时在屏幕上显示列表和详细信息，但在手机上一次显示一个）。片段有时也用于特殊 UI 中，用于批量替换内容，例如选项卡或`ViewPager`.

对于要更改全屏内容的地方，更传统的方法是使用单独的活动。

> 在 iOS 中，我将为每个“选项卡”设置单独的视图控制器

iOS 对“选项卡”的定义可能与 Android 对“选项卡”的定义不同，因为您没有在此处实现选项卡。

> 但似乎在 Android 中，您应该有 1 个包含许多片段的活动

如果您正在实施选项卡，那将是一种合适的方法。您没有实现选项卡。

> 是否有用于创建带有片段的简单菜单的示例代码，这就是我想要做的。

可能不会，因为这不是您通常会做的事情。话虽如此，如果您愿意，欢迎您访问您`commit()`的`replace()` `FragmentTransction`各个`case`区块`onOptionsItemSelected()`。就像是：

```
getSupportFragmentManager().beginTransaction()
                             .replace(android.R.id.content,
                                  new OtherFragment()).commit(); 
```

这假定此活动的原始 UI 也是使用片段和 a 创建的`FragmentTransaction`，您的代码没有显示。

> 我发现 android 文档不符合 iOS

你当然欢迎你的意见，不相关和有害的，因为表达它对你在这里获得帮助是不利的。

# c# - 高精度时间戳获取器，返回毫秒为 Int64

> ID：14386128
> 
> 赞同：-4
> 
> 时间：2013-01-17T18:57:25.717
> 
> 标签：c#, .net

需要高精度时间戳 .NET 函数

我用过 winapi `TimeGetTime`。但它使用`Int32`，每49.8天循环一次，返回即可`signed`。

`Int64`什么是返回类型为or的本机 .NET 高精度函数`UInt64`，返回毫秒数？

它是否从系统启动或过去的任何其他时间返回毫秒并不重要。

其实我不需要`StopWatch`

**编辑：**
我的应用程序是多线程的。`StopWatch`应该为每个线程创建实例。`StopWatch`有一个非常高精度的定时器。我只需要 1-5 毫秒。我需要的是类似 timeGetTime / Environment.TickCount as Int64 或 DateTime.Ticks 更新分辨率为 1-5ms

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-12-02T21:03:58.233

如果您使用的是 Windows 8 或 Server 2012 或更高版本，请`GetSystemTimePreciseAsFileTime`按以下方式使用：

```
[DllImport("Kernel32.dll", CallingConvention = CallingConvention.Winapi)]
static extern void GetSystemTimePreciseAsFileTime(out long filetime);

public DateTimeOffset GetNow()
{
    long fileTime;
    GetSystemTimePreciseAsFileTime(out fileTime);
    return DateTimeOffset.FromFileTime(fileTime);
} 
```

这比 . 准确度要好得多`DateTime.UtcNow.Ticks`。

有关详细信息，请参阅 MSDN：http: [//msdn.microsoft.com/en-us/library/windows/desktop/hh706895 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/hh706895(v=vs.85).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T19:24:47.670

您可以使用 DateTime.UtcNow.Ticks。这实际上比毫秒更精确。

# matlab - 在 Matlab 中比较两个信号的最佳方法

> ID：14386130
> 
> 赞同：8
> 
> 时间：2013-01-17T18:57:40.893
> 
> 标签：matlab, compare, signal-processing, similarity

我有一个在 matlab 中制作的信号，我想将其与另一个信号进行比较（称它们为 y 和 z）。我正在寻找的是一种分配两个信号相似程度的值或百分比的方法。

`corrcoef(y,z) = -0.1141`我试图使用corrcoef ，但**我**得到的值很差（看一下两个信号幅度的 FFT 的 corrcoef 看起来更有希望：`corrcoef(abs(fft(y)),abs(fft(z))) = 0.9955`，但我不确定这是否是最好的方法，因为这两个信号的纯形式似乎不是相关。

有没有人推荐如何在 Matlab 中比较两个信号？

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-17T19:02:51.023

如果没有更清楚地定义“相似”的含义，这个问题就无法回答。

如果“相似”是指“相关频率响应”，那么，你就领先一步了！

一般来说，定义适当的度量是高度特定于应用程序的；您需要回答*为什么*要知道这两个信号有多相似才能知道如何衡量它们的相似程度。它们会被输入到同一个系统吗？它们是否需要通过相同的算法来检测？

同时，您使用频率域相关性的想法还不错。但你也可以考虑

[http://en.wikipedia.org/wiki/Dynamic_time_warping](http://en.wikipedia.org/wiki/Dynamic_time_warping)

或者各种统计模型下时间序列的可能性：

[http://en.wikipedia.org/wiki/Hidden_](http://en.wikipedia.org/wiki/Hidden_Markov_model) ​​Markov_model http://en.wikipedia.org/wiki/Autoregressive_model [http://en.wikipedia.org/wiki/Autoregressive%E2%80%93moving-average_model](http://en.wikipedia.org/wiki/Autoregressive%E2%80%93moving-average_model)

或任何数量的其他型号...

我应该补充：一般来说，两个时间序列之间的相关系数是时间序列相似性的一个非常差的度量，除非在非常特殊的情况下（例如，没有相位变化）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-20T19:39:23.907

皮特是对的，您需要在进一步发展之前定义相似性的概念。您可能会发现归一化的最大互相关幅度对于您的情况是有用的相似性概念，但是：

```
norm_max_xcorr_mag = @(x,y)(max(abs(xcorr(x,y)))/(norm(x,2)*norm(y,2)));
x = randn(1, 200); y = randn(1, 200); % two random signals 
norm_max_xcorr_mag(x,y)

ans = 0.1636

y = [zeros(1, 30), 3.*x]; % y is delayed, multiplied version of x
norm_max_xcorr_mag(x,y)

ans = 1 
```

这种相似性的概念类似于两个序列的死记硬背，但对时间延迟是不变的。

# javascript - 是否有任何 javascript 代码（polyfill）可以启用 Flexbox（2012，css3），例如modernizr？

> ID：14386133
> 
> 赞同：6
> 
> 时间：2013-01-17T18:57:51.257
> 
> 标签：javascript, html, css, flexbox, polyfills

我正在寻找任何像modernizr（**实际上没有**）为“旧浏览器”（polyfill）启用flexbox的**javascript**库。

是的，我知道这是一个非常新的功能（事实上“没有”是一个有效的答案），但我希望有这样的东西，我总是很难水平+垂直居中，这真的会有所帮助并缩短工作。

我的意思是这个 flexbox：[http](http://weblog.bocoup.com/dive-into-flexbox/) ://weblog.bocoup.com/dive-into-flexbox/ （最新的）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T00:00:37.963

这可能[为时过早](http://caniuse.com/flexbox)。WebKit 最近才实现它，根本没有任何移动 WebKit 支持的迹象，Opera*刚刚*发布了对它的支持，而 Gecko 的实现仍处于 alpha 阶段。IE？哈。

但据我所知，不，新的 flexbox 没有 polyfill。 [Flexie](http://flexiejs.com/)支持旧的 flexbox，并且有一张[票](https://github.com/doctyper/flexie/issues/34)可以支持新的语法……也许你可以帮他们一把？

我想你总是可以使用旧的 flexbox，但是你已经过时了。糟糕的情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T23:16:02.470

你将不得不创建自己的。 [http://www.sitepoint.com/detect-css3-property-browser-support/](http://www.sitepoint.com/detect-css3-property-browser-support/)有一个标题为“滚动你自己的检测代码”的部分

基本上你需要这样的东西：

```
// detect CSS display:flex support in JavaScript
var detector = document.createElement("detect");
detector.style.display = "flex";
if (detector.style.display === "flex") {
    console.log("Flex is supported");
}
else
{
    console.log("Flex is not supported");
} 
```

要对此进行扩展并创建一个函数：

```
function DetectDisplayValue(val)
{
  // detect CSS display:val support in JavaScript
  // 
  var detector = document.createElement("detect");
  detector.style.display = val;
  if (detector.style.display === val) {
    console.log("Display value: " + val + " is supported");
  }
  else
  {
      console.log("Display value: " + val + " is not supported");
  }
} 
```

# entity-framework - EF 代码首先访问 HasMaxLength 值

> ID：14386141
> 
> 赞同：2
> 
> 时间：2013-01-17T18:58:32.317
> 
> 标签：entity-framework, ef-code-first

我想先获取我使用 EF 代码定义的列的最大长度。我需要确保插入的值不超过最大长度：

```
this.Property(t => t.COMPANY_ID)
             .HasMaxLength(30); 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T13:13:55.400

我理解您的问题的方式，您的真正需要似乎是您要确保实体的属性（在本例中为 COMPANY_ID）不超过某个最大长度（在本例中为 30）。

您可以考虑使用数据注释（System.ComponentModel.DataAnnotations 和 System.ComponentModel.DataAnnotations.Schema），而不是执行这样的手动检查，尤其是因为无论如何您都首先使用代码。像这样的东西：

```
public class MyEntity
{
    [MaxLength(30)]
    public string MyProperty {get; set;}
    [Column(TypeName="Date")]
    public DateTime MyDate {get; set;}
} 
```

您可以设置的不仅仅是最大长度。正如您在上面看到的，您可以指定应在数据库中反映的数据类型。您还可以指定是否需要属性等等。EF 将自动为您管理这一点，如果您的实体不符合数据注释设置的标准，它将为您引发异常。如果您使用 MVC 脚手架，它还可以自动生成与您为实体指定的注释一致的验证。

# c# - 如何为我的代码提供线程安全？

> ID：14386151
> 
> 赞同：0
> 
> 时间：2013-01-17T18:59:22.363
> 
> 标签：c#, multithreading

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace Program
{
    class Program
    {
        static long total = 0;
        static long count(int row)
        {
            /* do_something .. every operation is thread safe here */
            return somevalue;
        }
        static void Main(string[] args)
        {
            Parallel.For(0, 10000000, i => //some big limit to test threading is working
            {
                total += count(i);
                // however, collecting 'somevalue' from 'count()' operation isn't thread safe.
            });

            Console.WriteLine(total);
        }
    }
} 
```

我想并行化上面的代码。`count()`我必须执行从 0 到 10^9 - 1 的十亿次操作。`count()`函数本身不与其他线程共享数据。但是，将结果相加`count()`并不是`total`线程安全的 - 每次运行程序时结果都会有所不同。`total`必须存储一些不能存储在 int 中的整数值。我的问题有什么解决办法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T19:09:52.550

这是一个[`Sum(ParallelQuery<Int64>)`](http://msdn.microsoft.com/en-us/library/dd413244.aspx)用于结合投影和求和的单线。

```
long total = ParallelEnumerable.Range(0, 10000000).Sum(row => count(row)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-17T19:08:51.857

并行 LINQ 使这变得简单：

```
ParallelEnumerable.Range(0, 10000000).Select(i=>count(i)).Sum() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-17T19:05:02.050

试试这个：

[http://msdn.microsoft.com/en-us/library/system.threading.interlocked.increment(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/system.threading.interlocked.increment(v=vs.100).aspx)

你也可以使用标准的 lock() 。

# c# - webrole 上 Azure WCF 服务上基于 x509 证书的身份验证

> ID：14386152
> 
> 赞同：1
> 
> 时间：2013-01-17T18:59:22.957
> 
> 标签：c#, wcf, azure, x509certificate, access-control

`WebRole`我在 Azure 中托管了一个 WCF 服务。我想设置基于`x509`证书的联合 ACS 身份验证。我正在关注此[链接](http://msdn.microsoft.com/en-us/library/windowsazure/hh289316.aspx)以获取指导。在引用的示例中，他们尝试在控制台应用程序中实例化 ServiceHost 对象，然后动态应用配置。但是，在我的场景中，我通过 webrole 托管 WCF，那么如何改进 web.config 中的相同配置，而不是以编程方式配置它？这是因为当 WCF 服务托管在基于 IIS 的 webrole 上时，我将无法在运行时访问 ServiceHost 对象。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T20:10:32.077

[这个](https://stackoverflow.com/questions/335719/how-can-i-configure-wcf-to-use-x509-certificates-over-the-internet)解决方案不适合你吗？关于 Web 中的托管服务 - 只需创建 .svc 文件并将下一个代码放入其中：

```
<%@ ServiceHost Language="C#" Service="YourServiceName" Factory="YourHostFactoryName" %> 
```

您可能遇到的另一个问题是如何在 Web 角色中正确安装证书。

# php - 自定义包生成器的最佳选择？

> ID：14386153
> 
> 赞同：0
> 
> 时间：2013-01-17T18:59:26.943
> 
> 标签：php, javascript, jquery, html

在我的网站上，我喜欢制作一个包构建器，以允许客户构建最适合他们要求的包。当客户点击构建按钮时，它会计算他们定制包的价格。

实现这一目标的最佳方法是什么？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T23:00:57.060

您应该研究 Javascript 函数。您不能仅通过使用 HTML 来实现这一点，您可以使用 PHP 来实现大部分功能，但我建议使用 Javascript 在您的页面上实际进行数学运算，而无需让用户刷新。此外，通过使用 Javascript，您可以使用在页面上添加某些 HTMl 元素的功能。下面是我使用的一段很好的 javascript 代码，我一直使用它在页面上添加元素。

```
 container.append('<input type="text" name="elementname">'); 
```

# php - 将 CSV 的内容添加到 MYSQL 数据库

> ID：14386158
> 
> 赞同：0
> 
> 时间：2013-01-17T18:59:54.140
> 
> 标签：php, mysql, csv

> **可能重复：**
> [如何将数据从 CSV 导入 MySQL？](https://stackoverflow.com/questions/9555370/how-i-can-import-data-from-csv-to-mysql)

我有一个相当大的数据库，需要每年更新。我希望能够只填写一个电子表格并将其上传到我的数据库。

在我的前半部分，我收到了通知：注意：未定义索引：第 7 行的 E:\New folder\xampp\htdocs\Importing\quickimport.php 中的 csv。此外，当我实际尝试上传我选择的 CSV 文件时，我得到 404 not found 错误。有谁知道为什么这不起作用？

这是我当前的代码：经过几次编辑，我现在有了

```
<?php  

$connect = mysql_connect("localhost","root"); 
mysql_select_db("contacts",$connect);

if(isset($_FILES['csv'])){
if ($_FILES['csv']['size'] > 0) { 

    $file = $_FILES[csv][tmp_name]; 
    $handle = fopen($file,"r"); 

    do { 
        if ($data[0]) { 
            mysql_query("INSERT INTO contacts (contact_first, contact_last, contact_email) VALUES 
                ( 
                    '".addslashes($data[0])."', 
                    '".addslashes($data[1])."', 
                    '".addslashes($data[2])."' 
                ) 
            "); 
        } 
    } while ($data = fgetcsv($handle,1000,",","'")); 

    header('Location: quickimport.php?success=1'); die; 

} 
}
?> 

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml"> 
<head> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
<title>Import a CSV File with PHP & MySQL</title> 
</head> 

<body> 

<?php if (!empty($_GET['success'])) { echo "<b>Your file has been imported.</b><br><br>"; }     //generic success notice ?> 

<form method="post" enctype="multipart/form-data" name="form1" id="form1"> 
  Choose your file: <br /> 
  <input name="csv" type="file" id="csv" /> 
  <input type="submit" name="Submit" value="Submit" /> 
</form> 

</body> 
</html> 
```

# android - 暂停后片段 getView 给出 null

> ID：14386159
> 
> 赞同：0
> 
> 时间：2013-01-17T18:59:54.370
> 
> 标签：android, android-fragments

为了专注于这个问题，我以下面的测试应用程序结束，它包含一个活动和两个连接到 FragmentStatePagerAdapter / ViewPager 的片段。我也有 Runnable 和 Handler 每秒打印 getView() （在生产版本中，它用于在片段的 TextView 中显示时间）。

当我启动应用程序时，getView() 可能显示几个空值（我想是由于片段生命周期），然后我得到一些非空值，这没关系...

但是，如果我暂停并唤醒我的设备 LogCat 一直显示空值。

```
public class MainActivity extends SherlockFragmentActivity {

    private SectionsPagerAdapter sectionsPagerAdapter = new SectionsPagerAdapter(getSupportFragmentManager());
    private Fragment myFragment1 = new MyFragment1();
    private Fragment myFragment2 = new MyFragment2();

    private Handler handler = new Handler();
    private Runnable timer;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        ViewPager viewPager = (ViewPager) findViewById(R.id.pager);
        viewPager.setAdapter(sectionsPagerAdapter);
    }

    @Override
    protected void onResume() {
        super.onResume();

        timer = new Runnable() {
            public void run() {
                System.out.println(myFragment1.getView()); // HERE getView gives null
                handler.postDelayed(this, 1000); // refreshing every 1 sec
            }
        };

        handler.removeCallbacks(timer);
        handler.postDelayed(timer, 0);
    }

    @Override
    protected void onPause() {
        super.onPause();

        handler.removeCallbacks(timer);
    }

    public class SectionsPagerAdapter extends FragmentStatePagerAdapter {

        public SectionsPagerAdapter(FragmentManager fm) {
            super(fm);
        }

        @Override
        public Fragment getItem(int position) {
            Fragment fragment;

            if (position == 0) {
                fragment = myFragment1;
            } else {
                fragment = myFragment2;
            }

            return fragment;
        }

        @Override
        public int getCount() {
            return 2;
        }

        @Override
        public CharSequence getPageTitle(int position) {
            switch (position) {
            case 0:
                return "Fragment 1";
            case 1:
                return "Fragment 2";
            }
            return null;
        }

    }
} 
```

我的片段

```
public class MyFragment1 extends SherlockFragment {

    private TextView textView2;

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        return inflater.inflate(R.layout.fragment_layout, container, false);
    }

    @Override
    public void onActivityCreated(Bundle savedInstanceState) {
        super.onActivityCreated(savedInstanceState);

        ((TextView) getView().findViewById(R.id.textView1)).setText("Fragment 1");

        textView2 = (TextView) this.getView().findViewById(R.id.textView2);
    }

    public void updateTextView2(String text) {
        textView2.setText(text);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T18:14:53.623

好的，我只需添加以下内容即可解决我的问题：

```
if (myFragment1.getView() == null) {
    viewPager.setAdapter(sectionsPagerAdapter);
} 
```

我对这个解决方案不满意，但它有效......

# visual-studio - 如何将 TFS 工作项链接到 TFS 变更集

> ID：14386163
> 
> 赞同：3
> 
> 时间：2013-01-17T19:00:08.003
> 
> 标签：visual-studio, version-control, tfs

在 TFS 中，如何将变更集与工作项链接？在其他问题跟踪器中，您可以通过评论来做到这一点（例如 JIRA）：

> “修复 bug-1234。必须准备好添加文档。”

然后，问题跟踪器将此变更集添加到工作项 bug-1234 的历史记录中，并且可以在问题跟踪器 UI 中查看变更集历史记录。

TFS 支持这样的东西吗？我还没有找到任何明确的链接。请注意，我希望将 TFS 工作项链接到变更集，而不是将源链接到工作项。我知道一个 Product SourceLinks 已经开始使用它并且已经开始使用它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-17T19:06:12.747

当您签入代码时，签入对话框允许您选择一个工作项（任务、错误等）。该工作项将与该签入/变更集相关联。[每次签入都会创建一个变更集]

![在此处输入图像描述](../Images/0505f22a0c2633818f6572d69cf25bd6.png)

然后，当您查看 Bug 详细信息时，您可以看到所有链接/关联：

![在此处输入图像描述](../Images/247b233e948a14116f96864dfce3956f.png)

# ios - glDrawElements 与 GL_LINES 强制 gleRunVertexSubmitARM？（或者：为什么在 iOS 上绘制线框很慢？）

> ID：14386166
> 
> 赞同：5
> 
> 时间：2013-01-17T19:00:13.397
> 
> 标签：ios, performance, opengl-es-2.0, wireframe

在为我正在处理的 iPhone/iPad 的一个小项目做一些测试时，我观察到在使用带有 GL_LINES 的 glDrawElements 绘制线框时会出现很大的 CPU 性能损失。

这是场景：

*   一个有 640 个顶点的模型（4 个浮点数表示位置，3 个浮点数表示法线，没有对齐问题……全部在 4 个字节边界上）
*   3840 个索引（无符号短）
*   顶点和索引都使用 VBO（无 VAO）
*   上面使用带有 GL_TRIANGLES 的 glDrawElements 绘制的模型工作正常

然后：

*   相同的模型有 640 个顶点
*   2560 个索引
*   VBO 没有 VAO
*   使用带有 GL_LINES 的 glDrawElements 绘制会触发对 gleRunVertexSubmitARM 的连续调用，CPU 使用率飙升...

在这两种情况下，模型看起来都符合预期，并且没有 glErrors...

似乎问题与设备有关。我在 iPhone 3GS 和 iPhone 4 上体验它，而不是在 iPad 2 或模拟器上体验。在 iPad 2 帧时间 CPU = 1 毫秒并且没有调用 gleRunVertexSubmitARM，在 iPhone 4 帧时间 CPU = 12 毫秒并且连续调用 gleRunVertexSubmitARM。

谁能解释这种行为或指出我可能犯的错误？

任何见解都受到高度赞赏。提前致谢，

弗朗切斯科

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-08T07:13:11.497

我会说一个不容易的问题，这不是一个简单的答案。

无论如何，同一个“家族”的两个设备以不同方式表现的原因可能取决于许多因素。

首先，它们安装了不同的 GPU（我很确定你已经知道了，很抱歉说的很明显），这带来了以下差异：

*   Iphone 4 和 Iphone 3GS 安装同一个 GPU，PowerVR SGX535
*   IPAD 2 使用 PowerVR SGX543MP2

首先，后者是前者的演进，具有不同的吞吐量和更新的架构。

仅此一点并不能解释一切，您注意到更多对 gleRunVertexSubmitARM 的调用的原因可以解释为 PowerVR 在其 GPU 上执行的 OpenGL 驱动程序实现，很可能 SGX535 GPU 驱动程序通过该函数的挂钩执行您需要的操作.

最后但同样重要的是，在性能方面，使用 GL_LINES 绘图在大多数情况下效率很低，原因如下：

*   不执行任何隐藏几何检测
*   不执行任何面部剔除
*   阅读（以及我自己 2-3 年前的经验），使用 GL_LINE_WIDTH 或 GL_LINE_SMOOTH 会导致驱动程序执行“软件”渲染而不使用任何硬件加速。这取决于 GPU 及其 OpenGL 驱动程序的实现
*   渲染填充多边形时，驱动程序可以使用“分层深度缓冲区”优化操作，而使用 GL_LINES 则不能（同样，这在很大程度上取决于驱动程序，但这是一个非常常见的方面）
*   一些驱动程序在渲染时将您的 GL_LINES 网格转换为三角形。这是我无法证明的事情，但这是过去游戏引擎开发者朋友非常普遍的话题。

我希望能以某种方式帮助你。

乔·毛里齐奥

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-11-28T16:18:21.007

我在PC上，但我觉得这是相关的。我注意到线框模式下的帧速率：glPolygonMode(GL_FRONT_AND_BACK, GL_LINE)...

如果 glEnable(GL_LINE_SMOOTH); 则慢 10 倍；

您可以使用以下命令禁用它：glDisable(GL_LINE_SMOOTH);

# macos - OS X：访问最前面的应用程序的主菜单

> ID：14386167
> 
> 赞同：1
> 
> 时间：2013-01-17T19:00:13.483
> 
> 标签：macos, applescript, scripting-bridge

- -编辑 - -

有一个称为`Keycue`执行此功能的应用程序。

- -/编辑 - -

---编辑编辑---

这是重复的。 [从另一个应用程序获取所有快捷方式的列表](https://stackoverflow.com/questions/5841956/get-a-list-of-all-shortcuts-from-another-application)

---/编辑编辑---

我正在努力编写一个应用程序，它采用最前面的应用程序的菜单栏（即如果 Safari 是打开的，Safari 菜单，如果 XCode 是打开的，Xcode 菜单），并从中解析快捷方式。

到目前为止我尝试过的事情，但失败了：

1：花了一周时间学习applescript。玩弄“系统事件”以获取菜单栏，但是我无法收集到任何信息可以给我快捷方式代码。

2：考虑尝试使用 NSWorkspace 的 KVO。试图获取 NSRunningApplication，但只有一个 ownsMenuBar 属性，它是一个 BOOL，而不是一个 NSMenu。

3：试图从 NSWorkspace、NSBundle 和 NSRunningApplication 获取 NSApplication。一切都无济于事。

4：试图从applescript获取NSMenu（没有成功。）

我想我想尝试的下一件事是搜索 NSRunningApplication 并为 ownsMenuBar 选择 YES，然后尝试从某个地方获取相应的 NSApplication。不知道在哪里。

所以有什么建议吗？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T20:16:00.630

尝试：

```
tell application "System Events"
    set frontProcess to name of first process whose frontmost = true
    tell process frontProcess
        get every menu item of menu 1 of menu bar item 2 of menu bar 1
    end tell
end tell 
```

编辑
一旦你有了这个列表，你就可以解析每个菜单项的属性：

```
tell application "System Events"
    set frontProcess to name of first process whose frontmost = true
    tell process frontProcess
        set myMenuItems to get every menu item of menu 1 of menu bar item 2 of menu bar 1
        set myList to {}
        repeat with aMenuItem in myMenuItems
            set end of myList to aMenuItem's name
            set end of myList to value of aMenuItem's attribute "AXMenuItemCmdChar"
            set end of myList to value of aMenuItem's attribute "AXMenuItemCmdModifiers"
        end repeat
    end tell
end tell 
```

# postgresql - PostgreSQL Select combine 2 WITH 查询

> ID：14386168
> 
> 赞同：0
> 
> 时间：2013-01-17T19:00:14.060
> 
> 标签：postgresql

我使用 WITH 查询进行了选择，如下所示：

```
WITH test AS (select id, sum(value) as value from test group by id)
SELECT name, t.value from names JOIN test t ON (t.id = names.id) 
```

但我需要使用 2 个 WITH 查询，有什么办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T19:09:21.900

```
WITH
    name1 AS (SELECT ...),
    name2 AS (SELECT ...)
SELECT ... 
```

# git - 如何知道工作区中是否已经存在现有提交？

> ID：14386171
> 
> 赞同：0
> 
> 时间：2013-01-17T19:00:18.957
> 
> 标签：git, github, gerrit, repository

我有一个 git 工作区，我想知道其中是否已经存在更改..我认为通过提交进行检查是了解工作区中是否已经存在现有提交的最佳方法？您必须了解的任何其他想法检查工作区中是否已经存在更改也很棒...

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T19:29:48.853

提交是否有更改 ID？如果是这样，我认为最简单的答案是使用`git log | grep $CHANGE_ID`. 这将很快让您知道该更改 ID 是否在您的提交历史记录中。

Gerrit Web UI 可以轻松地从服务器挑选更改到您的工作区，因此我想不出使用原始提交的 SHA1 的更好方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T19:33:35.160

我不知道 Gerrit 是否或如何真正适合这个，但你可以检查一个提交

```
git show COMMIT 
```

如果它告诉您它找不到提交，则它不存在。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-24T03:39:57.477

`git log`正如布拉德的回答中提到的那样，为 Change-Id做 a和 grepping 是一种方法。这样做的缺点是您将在提交消息中获取对该 Change-Id 的任何引用，它们可能不是您正在寻找的实际更改。

相反，您可以像这样搜索提交的 sha1：

`git log --format="%H" | grep 11111111222222223333333344444444`

替换`11111111222222223333333344444444`为您提交的 sha1。

# gcc - 数组下标高于数组边界 [-Warray-bounds]

> ID：14386172
> 
> 赞同：2
> 
> 时间：2013-01-17T19:00:19.193
> 
> 标签：gcc

我环顾四周，没有找到任何可以帮助我的东西......我正在构建一个内核并且得到了一些，数组下标高于数组边界，警告构建失败。我正在使用 Linaro 工具链并设置为 -O3，因此任何警告都会使构建失败...感谢所有帮助

```
 drivers/media/video/msm/rawchip/Yushan_API.c: In function 'Yushan_Check_Pad_For_IntrID':
drivers/media/video/msm/rawchip/Yushan_API.c:1751:85: warning: array subscript is above array bounds [-Warray-bounds]
error, forbidden warning: Yushan_API.c:1751 
```

这里失败的方法......

```
bool_t  Yushan_Check_Pad_For_IntrID(uint8_t bInterruptId)
{

    uint8_t     bFirstIndexForSet[] = {1, 5, 11, 17, 23, 27, 58, 62, 69, 77, 79, 82, 83};
    uint8_t     bIntrSetID = 0;
    uint16_t    uwIntrSetsDivertedToPad1 = 0;

    VERBOSELOG("[CAM] %s: Start\n", __func__);
    /* Read the list of the interrupt sets diverted to Pad1 */
    SPI_Read(YUSHAN_IOR_NVM_SEND_ITR_PAD1 , 2, (uint8_t *)&uwIntrSetsDivertedToPad1);

    /* Trace through InterruptSets */
    while(bIntrSetID < TOTAL_INTERRUPT_SETS)
    {

        if( (bInterruptId>=bFirstIndexForSet[bIntrSetID])&&(bInterruptId<bFirstIndexForSet[bIntrSetID+1]) )
        {
            if((uwIntrSetsDivertedToPad1>>bIntrSetID)&0x01) {
                VERBOSELOG("[CAM] %s: End\n", __func__);
                return INTERRUPT_PAD_1;
            } else {
                VERBOSELOG("[CAM] %s: End\n", __func__);
                return INTERRUPT_PAD_0;
            }
        } else
            bIntrSetID++;

    }

    /* Just to remove warning */
    VERBOSELOG("[CAM] %s: End\n", __func__);
    return INTERRUPT_PAD_0;

} 
```

它在线错误：

```
if( (bInterruptId>=bFirstIndexForSet[bIntrSetID])&&(bInterruptId < bFirstIndexForSet[bIntrSetID+1]) ) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T19:03:21.887

在此调用中，索引超出了数组的大小：

```
bFirstIndexForSet[bIntrSetID+1] 
```

`bFirstIndexForSet`有 13 个元素，需要从 0 到 12 的索引。

您正在为每个低于 的索引进行循环`TOTAL_INTERRUPT_SETS`，这应该超过 12。（因为 11+1 将是您的数组可以使用的最大索引。）

答案：验证小于`TOTAL_INTERRUPT_SETS`或等于 12。

# php - PHP / FTP - 简单的 ftp_get 无法在本地服务器上运行，但在生产环境中运行 - 故障排除

> ID：14386173
> 
> 赞同：0
> 
> 时间：2013-01-17T19:00:24.967
> 
> 标签：php, ftp, centos

我在使用 ftp_get 时遇到了一点问题。当在 Centos 6 上运行的本地开发服务器上运行时，该脚本将不起作用。

我对 Stack Overflow 进行了一些研究，并尝试了大多数解决方案，但没有让它发挥作用。

我已经在运行 Centos 5.x + cPanel 的生产服务器上测试了相同的脚本并且它正在工作。

我想知道什么可能导致本地服务器上出现这种情况？

文件传输是否有任何特定设置才能正常工作？

这是我迄今为止尝试过的事情的清单：

*   错误，`error_reporting(E_ALL)`看看有没有错误。他们没有。

*   被动连接，`ftp_pasv($connection, true)`但它不会改变任何东西。

*   传输模式，试过 FTP_BINARY 和 FTP_ASCII。没有什么变化。

*   尝试使用文件处理程序保存在本地服务器上，也没有工作。

原始脚本批量运行（下载具有指定文件名的文件夹中的所有文件）。运行该脚本时，我可以说 3/4 的文件已成功传输到“开发”服务器。

说他们中只有 1/4 得到“失败”。因此，使用以下脚本对批量传输过程中失败的一些文件进行故障排除/测试下载。

他们也未能使用此脚本进行传输。

我已经检查了远程服务器上的所有权限（chmod）。一切都设置为666。

这是我正在使用的代码。它与 php.net 上的示例非常相似

```
// Connection to ftp
$connection = ftp_connect($hostname);

// Login to the FTP
$login = ftp_login($connection, $username, $password);

// Passive might help?
ftp_pasv($connection, true);

// Test login
if ((!$connection) || (!$login)) {
    echo "FTP Connection failed<br /><br />";
    exit;
} else {
    echo "Connection success<br /><br />";
}

$local_file = 'file.zip';
$server_file = 'file.zip';

// Download and save file
if (ftp_get($connection, $local_file, $server_file, FTP_ASCII)){
    echo "Download win <br />";
} else {
    echo "Download failed <br />";
} 
```

谢谢你的时间，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T19:05:54.120

首先尝试从本地 centos 机器的命令行/shell 检查相同的内容。使用“ftp”命令，看看它是否在那里工作。大多数情况下，这对我来说似乎是一个防火墙问题。

# cookies - Nginx 反向代理允许基于 cookie 存在的流量

> ID：14386174
> 
> 赞同：1
> 
> 时间：2013-01-17T19:00:28.440
> 
> 标签：cookies, nginx, reverse-proxy

我有一个小型 Linux 服务器充当运行 Nginx 的反向代理。Nginx 背后的主服务器在 asp.net 中运行一个带有表单身份验证登录和一个 ArcServer 实例的网站，在端口 6080 上运行一些 REST 服务。

是否可以只允许 Nginx 上的端口 6080 的流量到具有来自 asp.net 登录的会话 cookie 的人？基本上，我只希望登录用户能够访问那些 REST 服务，而不是整个万维网。

如果有人能指出我正确的方向，我的想法就不足了。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T08:48:05.227

以下工作得很好。但自然只是有点混淆，并不能取代应用程序中更深层次的任何安全检查

```
location /url/to/secret/ {
   if ($cookie_secretCookieName) {
     proxy_pass  http://serverhere;
   }    
} 
```

这不会阻止任何知道 cookie 名称的人获得访问权限，例如曾经是用户但不再是用户的人；但这可能是减少服务器负载的一个很好的额外步骤

# javascript - 集合没有被填充-backbone.js

> ID：14386176
> 
> 赞同：0
> 
> 时间：2013-01-17T19:00:37.400
> 
> 标签：javascript, backbone.js

我的集合类中有一个 fetch 方法，它可以从我指定的 url 在控制台中正确记录响应。来自 url 的响应在控制台中如下所示，

```
[
Object
Desc: "Desc of Qn0"
Qno: 0
__proto__: Object
, 
Object
Desc: "Desc of Qn1"
Qno: 1
__proto__: Object
, 
Object
Desc: "Desc of Qn2"
Qno: 2
__proto__: Object
, 
Object
Desc: "Desc of Qn3"
Qno: 3
__proto__: Object
, 
Object
Desc: "Desc of Qn4"
Qno: 4
__proto__: Object
] 
```

fetch方法如下，

```
app.collections.CollectionItems.fetch({

                success: function (collection,response) {
                    console.log(response);
                    //console.log(response[0].Desc);
                    //app.collections.CollectionItems.add(response);
                    console.log(app.collections.CollectionItems.length);
                    app.views.app = new app.views.masterView({collection: app.collections.CollectionItems});
                }
            }); 
```

现在，当我尝试记录集合的长度时，它显示为零。为了证实我的怀疑，我尝试遍历集合中的模型（在视图的渲染方法内），这表明集合没有模型。除了 fetch() 我还应该做些什么来填充集合？

# java - 使用 Hibernate for Java 在 HQL 中获取异常行为绑定参数列表时

> ID：14386177
> 
> 赞同：2
> 
> 时间：2013-01-17T19:00:43.450
> 
> 标签：java, sql, hibernate, hql, where-in

**更新** 我发现了问题。有点尴尬。客户端代码正在发送一个`Set`1 元素，它是报告 ID 的串联字符串。啊啊！

* * *

我在我的 Java 项目中使用休眠 v3.6.4。尝试在我的 HQL 查询中为命名参数使用参数列表时遇到问题。

基本上我想获取与子句`id`中提到的“”之一匹配的所有记录。`IN`

我尝试同时使用 HQL 和 Criteria 我得到了相同的结果。

我的 HQL 查询，

```
Set<String> reportIds = new HashSet<String>();
reportIds.add("1");
reportIds.add("2");

String whereClause = "from Report where id IN (:reportIds) ";
Query query = session.createQuery(whereClause);
query.setParameterList("reportIds", reportIds); 
```

输出 = 空列表。虽然我通过在终端中触发手动 sql 查询来检查确实有这样的记录。

我打开了日志记录，这就是我所看到的，

```
Hibernate: 
    /* 
from
    Report 
where
    id IN (
        :ids
    ) */ select
        mediavalue0_.id as id31_,
        ...

    from
        report mediavalue0_ 
    where
        mediavalue0_.id in (
            ?
        )
HibernateLog --> 13:22:36 TRACE org.hibernate.type.descriptor.sql.BasicBinder - binding parameter [1] as [VARCHAR] - 1,2 
```

这是非常不正常的，因为如果您注意到最后的绑定语句，它会考虑 Set 的 toString！即“1,2”而不是“1”，然后是“2”！

我一直在搞乱它，所以一时兴起，我决定直接在`setParameterList`方法调用本身内创建集合的实例。像这样，

```
query.setParameterList("reportIds", Sets.newHashSet("1","2")); 
```

它奏效了！BTW Sets.newHashSet 是一个构造提供的谷歌的番石榴库。我使用相同的库来生成原始的 reportIds 集。所以那里没有矛盾。

此查询转换为以下 TRACE，

```
from
    Report 
where
    id IN (
        :ids
    ) */ select
        mediavalue0_.id as id31_,
        ...
    from
        report mediavalue0_ 
    where
        mediavalue0_.id in (
            ? , ?
        )
HibernateLog --> 13:28:57 TRACE org.hibernate.type.descriptor.sql.BasicBinder - binding parameter [1] as [VARCHAR] - 1
HibernateLog --> 13:28:57 TRACE org.hibernate.type.descriptor.sql.BasicBinder - binding parameter [2] as [VARCHAR] - 2 
```

请注意 VARCHAR 的单独绑定。

我完全被这种奇怪的行为弄糊涂了。也许你们中的一些人可以指出我做错了什么。

仅供参考，我使用的标准构造（＆导致相同的输出）是这样的，

```
Criteria criteria = session.createCriteria(Report.class);
criteria.add(Restrictions.in("id", reportIds)); 
```

PS我还使用了具有相同结果的命名sql查询

```
<sql-query name="reportByIds">
    <return class="report.Report"/>
    SELECT mvr.* from report mvr
    WHERE mvr.id IN :ids
</sql-query> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T19:36:59.133

假设 id 属性是类型`Long`

```
Set<Long> reportIds = new HashSet<Long>();
reportIds.add(1l);
reportIds.add(2l); 
```

那么查询应该可以工作，条件也可以工作

# java - 无法让 onSharedPreferenceChanged() 工作

> ID：14386181
> 
> 赞同：3
> 
> 时间：2013-01-17T19:00:58.417
> 
> 标签：java, android, sharedpreferences, android-preferences, preferenceactivity

当用户从我的preferenceActivity 中的ListPreference 中选择特定项目时，我想显示一个对话框。但是，我无法让 onSharedPreferenceChanged() 工作。我在方法的开头放了一个Toast，它没有显示，所以方法甚至没有运行，这是为什么？

这是我的代码：（谢谢）

```
public void onSharedPreferenceChanged(SharedPreferences sharedPreferences,
        String key) {

    Toast.makeText(Preferences.this, "prefs Changed", Toast.LENGTH_SHORT)
            .show();

    if (key.equals("boolean_ad_type")) {

        sharedPreferences = PreferenceManager.getDefaultSharedPreferences(this);
        String value = sharedPreferences.getString("boolean_ad_type", "");
        if (value != null && value.equals("Pop-up Ads")) {

            Toast.makeText(Preferences.this, "Pop-up Ads Selected",
                    Toast.LENGTH_SHORT).show();
        }

    }
} 
```

我需要在这样的活动中实现它吗？（我试过有无，没有区别）

```
 public class Preferences extends PreferenceActivity 
                  implements OnSharedPreferenceChangeListener { 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-17T19:08:10.513

[如果在单独的活动中发生更改，则不会触发 onSharedPreferenceChanged？](https://stackoverflow.com/questions/3799038/onsharedpreferencechanged-not-fired-if-change-occurs-in-separate-activity)

```
public class MyActivity extends PreferenceActivity implements
    OnSharedPreferenceChangeListener {

@Override
protected void onResume() {
    super.onResume();
    // Set up a listener whenever a key changes
    getPreferenceScreen().getSharedPreferences()
            .registerOnSharedPreferenceChangeListener(this);
}

@Override
protected void onPause() {
    super.onPause();
    // Unregister the listener whenever a key changes
    getPreferenceScreen().getSharedPreferences()
            .unregisterOnSharedPreferenceChangeListener(this);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T19:08:36.697

你必须为你想要在你的对话框中显示的特定首选项设置一个点击监听器`onCreate`

```
PreferenceScreen ps2 = (PreferenceScreen) findPreference("ic_vol");
    ps2.setOnPreferenceClickListener(this); 
```

# tridion - 是否可以在 Tridion 2011 中修改/自定义组件“信息”详细信息

> ID：14386182
> 
> 赞同：1
> 
> 时间：2013-01-17T19:00:59.607
> 
> 标签：tridion, tridion-2011, tridion2009

是否可以根据用户修改/自定义组件“信息”选项卡的详细信息。请查看以下详细信息：

![组件信息选项卡](../Images/c4ecbbee99fad909bd4eddb2cb6d9fa8.png)

现在在上面的图像中，我想显示图像的完整路径，例如 (d:\images\Chrysanthemum.jpg) "Original File:"，因为它即将在 Tridion 2009 到来。

是否可以？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T21:10:47.360

不幸的是，这些是系统设置的只读字段。

如果项目是使用 SDL Tridion UI 上传的，这应该包含原始图像的完整路径（我很惊讶只看​​到没有路径的文件名），但是它不会告诉您路径是从哪个编辑器的机器上，所以用处不大。

你想达到什么目标，为什么？也许有人可以提出不同的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-22T09:20:33.897

显示额外的图像信息，例如大小和尺寸，是一个好主意，也是一个很好的 gui 扩展候选者。

您的解决方案有 4 个部分：

1.  后端，使用 Core Service 与 Tridion API 对话以获取 MM 图像并执行大小和尺寸计算。（也许尺寸可以用javascript计算？）。在核心服务中编写一些 C# 代码以从 Tridion 获取图像并计算图像大小。

2.  通过 Web 服务公开后端调用。我喜欢使用 ServiceStack.Net，并在 C# 代码之上创建一个非常简单、精简的 Web 服务。如果您创建一个 asp.net Web 应用程序并在那里托管 ServiceStack Web 服务，请确保将其部署到 Tridion 2011 IIS 站点下的“Web 应用程序”或虚拟目录。这将有助于任何 Post 操作，因为它将使用相同的端口号并且不被视为跨域。Pluralsight 在 Servicestack 上有一个很棒的培训视频。此外，您可以在 Chrome 浏览器中使用 Rest Console 来测试 Web 服务。

3.  使用 jQuery 从 HTML 页面调用 Web 服务。创建一个小型 Web 表单，使用 jQuery 对其进行序列化，然后调用 ServiceStack Web 服务。jQuery 响应将是一个带有图像信息的 JSON 对象。

4.  创建一个 ASCX 控件，将 Tridion 配置为将其用作 Tab 扩展。将您的工作 HTML / jQuery 复制/粘贴到选项卡中。

全部做完！

# ios - UIButton 的像素大小要求

> ID：14386187
> 
> 赞同：4
> 
> 时间：2013-01-17T19:01:13.180
> 
> 标签：ios

我正在为视网膜和非视网膜显示创建宽度为 30 的像素大小按钮图像。这看起来不错的样子。我在 stackoverflow 中读到视网膜的像素要求至少为 40x40，这看起来太大了。像素大小为 30 会导致应用被拒绝吗？

```
UIButton *btnBack = [UIButton buttonWithType:UIButtonTypeCustom];
[btnBack setImage:backImage forState:UIControlStateNormal];
btnBack.frame = CGRectMake(0, 0, backImage.size.width, backImage.size.height);
[btnBack addTarget:self action:@selector(Click_On_Btn_Back) forControlEvents:UIControlEventTouchUpInside];
UIBarButtonItem *backBarItem = [[UIBarButtonItem alloc] initWithCustomView:btnBack];
self.navigationItem.leftBarButtonItem = backBarItem;

[btnFollow setImage:followImage forState:UIControlStateNormal];
btnFollow.frame=CGRectMake(followBtnXOffset,currentHeight+followBtnYOffset,followImage.size.width,followImage.size.height); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T19:05:30.503

您的应用不会因为使用小于 44x44 像素的按钮而被拒绝。但是，您的用户不会欣赏它。在某些情况下，您可能需要一个小于 44x44 的按钮，因此最好将其子类化并将触摸区域增加到 44x44 或更大，而实际图像更小并位于该触摸区域的中心。

请记住，iPhone 使用 163 ppi，iPad 使用 133，而 iPad Mini 是 163。因此，在 iPad 上看起来有点大的按钮在 iPhone 和 iPad Mini 上会更小。

期望来自 iOS 人机界面指南：http: [//developer.apple.com/library/ios/#documentation/userexperience/conceptual/mobilehig/UIElementGuidelines/UIElementGuidelines.html%23//apple_ref/doc/uid/TP40006556- CH13-SW41](http://developer.apple.com/library/ios/#documentation/userexperience/conceptual/mobilehig/UIElementGuidelines/UIElementGuidelines.html%23//apple_ref/doc/uid/TP40006556-CH13-SW41)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-17T19:08:16.213

不，它不会被拒绝，40x40 只是 Apple 的推荐，所以你可以随意设置任何你想要的框架，只要它方便用户。

事实上，苹果自己在 ios AppStore 应用程序中并没有遵循这个建议（安装/购买/免费按钮的高度约为 25 像素）。

# python - 如何插入颜色或三角曲面

> ID：14386195
> 
> 赞同：2
> 
> 时间：2013-01-17T19:01:55.257
> 
> 标签：python, matlab, interpolation, triangulation, mayavi

我对这个问题已经束手无策了。当我试图解释我的问题时，请耐心等待。我有一个带有三角形表面的 3D 模型。然后我需要在 3D 模型的表面添加一些数据（以颜色的形式）。它应该类似于图中所示的内容：http: [//user.cscs.ch/fileadmin/user_upload/customers/users_entry_point/pictures/Visualization/Gallery/Cardiac_Therapy.png](http://user.cscs.ch/fileadmin/user_upload/customers/users_entry_point/pictures/Visualization/Gallery/Cardiac_Therapy.png)。

我的问题是我真的不知道如何在三角曲面上插入数据。我想知道是否有人可能有一个想法或可能指出我正确的方向。我应该提到我正在使用 python 和 mayavi，但我也愿意使用 MATLAB。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T19:09:29.677

[Matlab`trisurf`](http://www.mathworks.com/help/matlab/ref/trisurf.html)可能对你有用。你给它（x，y，z）坐标和每个顶点的颜色。

# google-app-engine - AppEngine TaskQueue 触发，但不存在

> ID：14386198
> 
> 赞同：0
> 
> 时间：2013-01-17T19:02:12.887
> 
> 标签：google-app-engine

我正在用 Python 尝试 AppEngine TaskQueues。我运行了一些代码，它在默认队列上创建了一个任务，我又运行了几次代码，它按预期创建了更多任务。

我进入任务队列管理部分并手动删除了其中一项任务。所有其他任务都完成了。

然后我从我的 AppEngine 代码中删除了创建任务的代码。

但是现在我删除的任务每隔 20 分钟左右就会被调用一次，我能做些什么来阻止这个任务吗？它不会出现在任何任务队列中。

我尝试禁用/重新启用应用程序，上传干净的 queue.yaml 文件。

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T01:51:29.790

如果您确定发生这种情况，请使用标签 Component-TaskQueue 提交 [错误](https://code.google.com/p/googleappengine/issues/list)并包含您的应用 ID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T11:43:15.613

您是否使用了延迟模块？如果是这样，请从您的 app.yaml 中删除 builtins: deferred。然后，您应该使任务调用的 url 再次可用并返回 http-200 状态代码。（对于延迟模块，这是 /_ah/queue/deferred）。这应该会阻止 GAE 重试。

# vba - 将连接的数组输出到 Outlook 电子邮件？

> ID：14386209
> 
> 赞同：0
> 
> 时间：2013-01-17T19:02:53.527
> 
> 标签：vba, ms-access, outlook

我有两个要连接的一维数组...一个是时间戳，另一个是相应的注释

例如：

2012 年 11 月 9 日上午 11:17:30 - Bob 跟进 Jim Smith

2012 年 11 月 13 日上午 11:17:38 - 根据请求跟进 LOB 的状态。等待回应。

2012 年 11 月 28 日上午 11:18:15 - Mtg 与 Bob，同意需要将所有权转让给 Mary Jones

2012 年 11 月 29 日上午 11:18:27 - Mtng w/MJ，伸手寻找文件。截止日期为 2012 年 12 月 7 日

2012 年 12 月 10 日上午 11:18:43 - Joe 向 MJ 发送电子邮件以获取状态更新。

这是我的代码：

```
Private Sub Test_Arrays_Click()
Dim dbs As Database, rst As Recordset, Count As Integer
Dim TimeArray()
Dim CommentArray()
Dim strsql As String
Dim i As Long
Dim TimeCommentArray As Variant

Set dbs = CurrentDb

strsql = "SELECT Timestamp, Comment from Conversation_Log where Item_ID = '" & Me.ID & "'"
Set rst = dbs.OpenRecordset(strsql)
Count = 0
     ReDim Preserve TimeArray(0)
     rst.MoveFirst
     Do Until rst.EOF
        TimeArray(Count) = rst![Timestamp]

        ReDim Preserve TimeArray(UBound(TimeArray) + 1)
        Count = Count + 1
        rst.MoveNext
     Loop

     ReDim Preserve TimeArray(UBound(TimeArray) - 1)
     rst.Close
     For i = LBound(TimeArray) To UBound(TimeArray)
     Next i

Set rst = dbs.OpenRecordset(strsql)
Count = 0
     ReDim Preserve CommentArray(0)
     rst.MoveFirst
     Do Until rst.EOF
        CommentArray(Count) = rst![Comment]

        ReDim Preserve CommentArray(UBound(CommentArray) + 1)
        Count = Count + 1
        rst.MoveNext
     Loop

     ReDim Preserve CommentArray(UBound(CommentArray) - 1)
     rst.Close
     For i = LBound(CommentArray) To UBound(CommentArray)
     TimeCommentArray = TimeArray(i) & " - " & CommentArray(i)

     Debug.Print TimeCommentArray
     Next i

     End Sub 
```

当我运行我的

```
Debug.Print TimeCommentArray 
```

它在即时窗口中正是我所需要的，但我不知道如何将其拉入 Outlook 电子邮件的 .Body 中。它只捕获并发送连接数组的最后一行（即最后一条注释）。

我的电子邮件创建代码在同一个子目录中……在我用来创建数组的上述代码之后。

任何帮助/建议将不胜感激

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T19:12:22.323

```
TimeCommentArray = TimeCommentArray & vbcrlf & TimeArray(i) & _
                                    " - " & CommentArray(i) 
```

# php - MiaCMS 安装

> ID：14386210
> 
> 赞同：1
> 
> 时间：2013-01-17T19:02:58.190
> 
> 标签：php, content-management-system, installation

我正在尝试安装 MiaCMS，所有安装步骤都成功，但最后当我单击查看站点或管理按钮时，它会将我重定向到特定的 url，但它不显示管理员界面或站点。请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T22:51:36.897

在 PHP 中开启调试，详情见：

*   [如何让 PHP 显示错误而不是给我 500 Internal Server Error](https://stackoverflow.com/questions/2687730/how-can-i-make-php-display-the-error-instead-of-giving-me-500-internal-server-er)
*   [如何配置 PHP 以显示详细错误而不是错误 500 页面？](https://stackoverflow.com/questions/3271790/how-to-configure-php-to-display-detailed-errors-instead-of-error-500-page)

# php - 本地 LAMP 堆栈，防止 PHP 缓存动态加载的页面

> ID：14386218
> 
> 赞同：1
> 
> 时间：2013-01-17T19:03:43.267
> 
> 标签：php, apache, http-headers

我有一个在 Linux 上运行的本地 LAMP 堆栈。我有通常的 Apache/PHP/mySQL 东西，从 localhost 一切正常。

我在服务器上有一个显示树视图的小应用程序。这列出了在本地（在服务器上）找到的一系列文档。这些文件可以通过在树中单击它们来查看，此时它们将加载到页面上的 DIV 中。这些文件可以使用我在应用程序中编写的简单编辑器进行编辑。到目前为止，这工作正常。

问题是 PHP（我假设）在加载这些文档时正在缓存它们，这意味着当用户编辑它们时，虽然它们被保存，但当它们在树中重新选择时，显示的是缓存的版本，而不是新的编辑版。

该应用程序的初始页面是一个标准的 HTML 页面，但我已将其重命名为 PHP，并将以下代码添加到此页面的顶部：

```
<?php
header("Last-Modified: " . gmdate("D, d M Y H:i:s") . " GMT");
header("Cache-Control: no-store, no-cache, must-revalidate");
header("Cache-Control: post-check=0, pre-check=0", false);
header("Pragma: no-cache");
?> 
```

不幸的是，虽然这似乎阻止了主页被缓存，但它并没有阻止那些在应用程序的一般使用期间动态加载的文件。

有什么方法可以阻止 PHP（仍然假设它是 PHP）缓存这些动态加载的本地文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T19:11:12.433

您正在混淆操作码缓存和浏览器缓存。您设置的标头与 PHP 无关，它们是影响浏览器缓存的 http 标头。PHP 将（如果使用 APC 或类似设备正确设置）缓存操作码，这与您的问题无关。

当您将文件下载到客户端进行编辑时，您必须在文件上设置缓存头，以防止客户端（浏览器）缓存它们。

每个下载（css 文件、js 文件、任何文件）都是一个单独的 http 请求，因此有自己的标头集。因此，如果您设置自定义的每个请求标头，则必须为每个此类请求设置它们。在您的情况下，更简单的解决方案是在 Apache 配置级别添加这些标头。

[Apache`Header`指令](http://httpd.apache.org/docs/2.0/mod/mod_headers.html)易于使用，您几乎可以在 Apache 配置链中的任何位置使用它。这意味着 .htacess、vhost 配置或通用 apache 配置。如何解决这个问题取决于您和您的服务器环境。

如何将标头添加到 .htaccess 的示例如下：

```
Header set Cache-control "max-age=0, no-store" 
```

或者，如果您希望仅为某些文件类型设置某些标题：

```
<FilesMatch "\.(gif)$" >
    Header set Cache-control "max-age=0, no-store"
</FilesMatch> 
```

# notepad++ - 无法输入“？” 在记事本++

> ID：14386219
> 
> 赞同：2
> 
> 时间：2013-01-17T19:03:46.800
> 
> 标签：notepad++

我无法让 Notepad++ 让我输入问号 (?)。我可以 shift + 任何其他键来获取大写字符。我可以转到任何其他程序——记事本、Word、此文本框等，并且它可以工作。我也可以在我的管理员帐户下运行 Npp 并使用 Shift + '/ ?' 获得？的关键。

我还可以从“编辑”菜单打开字符面板并从中插入问号。

我正在运行 5.9.3 但我升级到 6.2.3 以查看是否是版本问题，但这并没有解决问题。我也尝试卸载/重新安装。

我是否以某种方式设置了不允许我输入“？”的内容？用键盘？我已经查看了所有设置，但似乎找不到可以这样做的地方。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-02-28T19:32:26.033

我有一个类似的问题，就我而言，文件的适当性是问题所在。该文件具有“只读”属性，这就是我无法编辑她的原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T20:36:24.067

检查您是否没有映射到任何宏`?`

您可以通过转到“宏”菜单并选择“修改快捷方式/删除宏”来执行此操作

# java - 什么会使这个目录在 HDFS 上不可组写？

> ID：14386222
> 
> 赞同：1
> 
> 时间：2013-01-17T19:03:59.860
> 
> 标签：java, hadoop, filesystems, hdfs

使用此代码：

```
fileSystem.mkdirs(new Path(path), new FsPermission((short)0774)); 
```

或此代码：

```
fileSystem.mkdirs(new Path(path), new FsPermission(FsAction.ALL, FsAction.ALL, FsAction.READ_EXECUTE)); 
```

为什么创建的目录不是组可写的？文件也存在同样的问题。所有者权限设置为 rwx，但组设置为 r--。

此代码在 cdh3u3 下运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T20:43:05.877

您需要更新 hdfs-site.xml 并设置以下属性：

```
dfs.permissions = true 
```

如果设置为`false`，则从一个参数值切换到另一个参数值不会更改模式、所有者或文件或目录组。更多关于权限的信息在[这里](http://hadoop.apache.org/docs/r0.20.2/hdfs_permissions_guide.html)。

完成此操作后，不要忘记重新启动集群，因为这是数据节点配置更改。

# android - 重新启动应用程序后尝试连接服务时的错误工作方法 bindServer()

> ID：14386226
> 
> 赞同：0
> 
> 时间：2013-01-17T19:04:07.627
> 
> 标签：android, android-service

今天，使用 Android 服务，在我看来，工作方法遇到了一些“不合逻辑”或“不正确” `bindService`。我在您内部的应用程序服务中创建的混淆的本质是`ExecutorService`发出请求。当我进入应用程序时，服务仍然存在 - 查询在不同的线程中执行，具有一定的周期性（日志证实了这一点）。在 onStart() 方法中，我编写了代码，根据所有手册和教程，我应该可以使用此应用程序访问我之前运行过的服务。但我们所有的建议似乎都很明显。我期待着打电话`bindService()`-> 我连接到正在运行的服务。但是不，相反，在第一次尝试时连接没有发生 - 我不明白为什么。我添加了可以运行服务本身的代码，如果之前没有完成的话。所以这部分代码被激活，我再次尝试连接到正在运行的服务。是的，连接是成功的，但是 - 连接滋养了我期望从第一次连接尝试中获得的服务。从我尝试重新创建服务的日志来看，并不会导致它的创建。所有这些都来自日志。在这方面，我想知道 - 为什么第一次尝试连接它没有发生？还是我做错了？

**Activity中的片段代码**

```
...
private ServiceConnection serviceConnection = new ServiceConnection(){
        public void onServiceConnected(ComponentName name, IBinder service) {
            flagServiceConnection = true;
            Log.d("StartActivity/serviceConnection", "serviceConnection/onServiceConnected() -> connected");
            exService = ((ExService.ExBinder) service).getService();
            exService.setFlagBroadcast(true);
            exService.getAll();
        }

        public void onServiceDisconnected(ComponentName name) {
            flagServiceConnection = false;
            Log.d("StartActivity/serviceConnection", "serviceConnection/onServiceDisconnected() -> disconnected");
        }       
    };
...
public void onStart(){
        super.onStart();        
        bindService(new Intent(this.getApplicationContext(), ExService.class), serviceConnection, 0);       
        if(!flagServiceConnection){
            Log.d("StartActivity", "onStart() -> start service");
            this.startService(new Intent(this.getApplicationContext(), ExService.class));
            bindService(new Intent(this.getApplicationContext(), ExService.class), serviceConnection, 0);           
        }       
    } 
```

**日志**

```
D/StartActivity(5922): onCreate()
D/StartActivity(5922): onStart() -> start service
D/StartActivity/serviceConnection(5922): erviceConnection/onServiceConnected() -> connected
D/-(5922): pront.android.exservice.ExService$Monitor@4056b4c8
D/-(5922): pront.android.exservice.ExService$Monitor@405480e0
D/-(5922): pront.android.exservice.ExService$Monitor@4054ee18
D/ExService(5922): onRebind()
D/ExService(5922): onStartCommand() -> service start 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T19:19:10.090

您的第一次连接尝试有效，但您的`flagServiceConnection`检查无效，因此您**总是**尝试再连接一次，这就是原因。

当你调用`bindService()`方法时，你并没有立即连接到服务，所以`flagServiceConnection`当你尝试检查它时你还没有设置。

我假设您检查的目的是在绑定之前启动服务（如果尚未启动）。为此，您需要`bindService()`使用`BIND_AUTO_CREATE`标志调用：

```
@Override
public void onStart(){
    super.onStart();        
    bindService(new Intent(this.getApplicationContext(), ExService.class), serviceConnection, BIND_AUTO_CREATE);       
    //that's it, if service is not started, it will be started automatically 
    //no need for additional checks         
    }       
} 
```

# revit - 在 Revit API 中从文件插入视图

> ID：14386229
> 
> 赞同：1
> 
> 时间：2013-01-17T19:04:15.347
> 
> 标签：revit, revit-api

有没有办法使用 Revit API 从文件中插入视图？我正在使用 Revit 2013 API。它需要与下面的功能相同。这是Autodesk Revit API 论坛上的一个[类似问题。](http://forums.autodesk.com/t5/Autodesk-Revit-API/Importing-specific-views-from-a-RVT-file/m-p/3252498/highlight/true#M2436)

![从文件插入视图](../Images/06edf1310a3ed83c7c3362d307cbcabc.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T15:57:08.210

**Revit 2014 API 更新**

这现在可以通过 Revit 2014 API 实现。如果您下载*Revit 2014 SDK*，则有一个示例项目*DuplicateViews*，它有一个名为`DuplicateViewUtils`包含 2 个函数的类，`DuplicateSchedules`它`DuplicateDraftingViews`允许您将这两种类型的视图从一个文档复制到另一个文档。关键组件是`ElementTransformUtils.CopyElements`允许您为您的副本选择一个*来自**和*一个文档的功能。

 ** * *

**Revit 2013 API 的响应**

我收到了一位[Revit](http://forums.autodesk.com/t5/Autodesk-Revit-API/Importing-specific-views-from-a-RVT-file/m-p/3756589#M3524) API 专家 Arnošt Löbel 的回复，他说 Revit 2013 API 目前无法做到这一点，但它在未来的版本中具有很高的优先级。只有时间会证明是否包含此功能...*

# c++ - 我如何调用这个函数？

> ID：14386232
> 
> 赞同：0
> 
> 时间：2013-01-17T19:04:26.840
> 
> 标签：c++, typedef

我正在阅读很多关于“typedef 函数”的内容，但是当我尝试调用这个函数时遇到了转换错误。调用此函数的正确语法是什么？

```
typedef ::com::Type* Func(const char* c, int i); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-17T19:07:41.813

该语句构成`Func`了一种类型。然后你不得不说`Func *f = anotherFunc`给定另一个 func 定义为：`::com::Type* anotherFunc(const char *c, int i){ /*body*/ }`

然后你可以打电话`f("hello", 0)`，它应该工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-17T19:15:24.240

您的代码中没有任何功能。只有一个类型名称`Func`代表函数类型。那里没有什么可以打电话的。

您的问题中定义的 name`Func`可以以多种不同方式使用。

例如，您可以使用它来声明一个函数

```
Func foo; 
```

以上等价于声明

```
::com::Type* foo(const char*, int); 
```

这也适用于成员函数声明。（但是，您不能使用它来*定义*函数）。

再举一个例子，你可以在声明一个指向函数的指针时使用它，通过添加一个显式的`*`

```
Func *ptr = &some_other_function; 
```

以上等价于声明

```
::com::Type* (*ptr)(const char*, int) = &some_other_function; 
```

再举一个例子，您可以将它用作另一个函数中的参数类型

```
void bar(Func foo) 
```

在这种情况下，函数类型将自动衰减为函数*指针*类型，这意味着上面的声明`bar`等价于

```
void bar(Func *foo) 
```

相当于

```
void bar(::com::Type* (*foo)(const char*, int)); 
```

等等。

换句话说，向我们展示你想用它做什么。因为你的问题太宽泛，无法具体回答。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-17T19:12:31.120

**`typedef`函数语法：**

```
#include <iostream>
using namespace std;

int add(int a, int b) {return a+b;}

typedef int(*F)(int a, int b);

int main() {
    F f = add;
    cout  << f(1,2) << endl;
    return 0;
} 
```

**的崩溃`typedef int(*F)(int a, int b);`**

*   括号里的`type`名字是F
*   返回类型是`int`开头的。
*   参数是 (int, int)

**用法`F f = &add;`：**

*   F是我们的类型。
*   f 是变量名。
*   add 是具有正确签名的函数。

在您的情况下，一个有效的语法是：`typedef ::com::Type (*Func)(const char* c, int i);`

# jquery - 同一页面上多个触发器上的 jQuery Keyup 事件优先级

> ID：14386234
> 
> 赞同：2
> 
> 时间：2013-01-17T19:04:41.430
> 
> 标签：jquery, events, event-bubbling, keyup

对不起，糟糕的标题。

我有一个可以在每个页面上弹出的联系表。用户可以按 Esc 关闭表单。工作正常。

```
<form id="contactForm" method="post" class="open" style="display: block;">
<input id="send" type="hidden" name="send">
<input type="hidden" value="/downloads/" name="_wp_http_referer">
<div id="main">
<input type="hidden" value="mailAction" name="action">
<a class="close" href="#">x</a>
</form>

    jQuery('a.close').click( function(e) {
      e.preventDefault();   
        jQuery('#overlay').fadeOut( 'slow');
        jQuery('#contactForm').removeClass('open').slideUp();
                                                                        });
    // When the "Escape" key is pressed, close the form
    jQuery('#contactForm').keydown( function( event ) {
        if ( event.which == 27 ) {
            jQuery('#contactForm a.close').trigger('click');
        }
    } ); 
```

好的。现在在其他几个页面上，我有另一个下拉 div，它不是表单。同样，用户可以按 Esc 关闭表单。为此，我不得不将 keyup 绑定到文档：

```
jQuery(document).keyup( function( event ) {
    if ( event.which == 27 ) {
        if( jQuery('#modalpopup').is(':visible') )
          jQuery('#modalpopup .close').trigger('click');
        else if ( jQuery('#myplayer').is(':visible')  )
          jQuery('#myplayer .close').trigger('click');
        }
    } ); 
```

这些页面上发生的情况是，keyup 永远不会“冒泡”到#contactForm。我错过了什么？有没有办法让第二个处理程序“传递”keyup 事件，以便它冒泡到#contactForm？

或者我是否需要将这些其他 div 包装在一个虚拟形式中，以便它们可以拥有独立的 keyup 事件处理程序？

TIA,

---JC

# php - Laravel 用相同的值更新 mysql 字段

> ID：14386236
> 
> 赞同：0
> 
> 时间：2013-01-17T19:04:45.497
> 
> 标签：php, mysql, orm, laravel

如何将 Laravel 中的记录更新为与以前相同的值。

尝试了以下方法，但没有成功，我不想再做一次查询来获取值并设置它。

```
$user = User::update($edit['id'], array(
        'name'      => $edit['username'],
        'email'   => $edit['email'],
        'password' => (is_null($edit['password']) ? '`password`' : Hash::make($edit['password'])),
)); 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T19:05:40.473

这就是`DB::raw()`：

```
$user = User::where_id($edit['id'])::update([
        'name'     => $edit['username'],
        'email'    => $edit['email'],
        'password' => empty($edit['password']) ? DB::raw('`password`') : Hash::make($edit['password'])
]); 
```

更好的是不将其设置在数组中：

```
$update_info = [
    'name'  => $edit['username'],
    'email' => $edit['email']
];

if (! empty($edit['password'])) {
    $update_info['password'] = Hash::make($edit['password']);
}

$user = User::where_id($edit['id'])::update($update_info); 
```

* * *

如果`User`是`Eloquent`模型，试试这个：

```
$user = User::find($edit['id']);

$user->username = $edit['username'];
$user->email = $edit['email'];

if (! empty($edit['password'])) {
    $user->password = Hash::make($edit['password']);
}

$user->save(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-17T20:17:23.080

我想为我正在从事的项目做同样的事情。我知道我得到了它的工作，我认为这是如何：

```
User::where('id','=',$edit['id'])->update( array(
    'name'      => $edit['username'],
    'email'     => $edit['email'],
    'password'  => is_null($edit['password']) ? DB::raw('`password`') : Hash::make($edit['password'])
)); 
```

# android - android自定义切换按钮边框

> ID：14386238
> 
> 赞同：1
> 
> 时间：2013-01-17T19:04:46.540
> 
> 标签：android, border, togglebutton

我有一个 8x8 形式的 64 个切换按钮的网格。当应用程序运行时，它将每个切换按钮的背景/可绘制设置为一种颜色。这是在程序中完成的，而不是在 xml 中。我的问题是，虽然应用程序图形布局上的按钮之间似乎有空间，但当应用程序运行并将按钮更改为颜色时，空间消失了。这使得按钮看起来像一个单独的板，按钮之间没有定义。

我想要的是在按钮上加一个边框，以明确每个按钮的位置。

按钮的功能是用来指示正在按下的音符。按下按钮时，按钮的颜色会从灰色变为浅蓝色，并将音符添加到序列中。

因此，我需要能够在具有自定义设计的切换按钮上放置一个边框，该边框在激活/停用时会发生变化，从而使边框保持两种状态。我还尝试设置最大宽度和最大高度，并设置按钮上的填充以尝试将它们分开。

代码示例如下：

```
public class MainActivity extends Activity implements OnClickListener
{
    ToggleButton tg1;
    ....
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        ....
        tg1 = (ToggleButton) findViewById(R.id.toggleButton1);
        tg1.setOnClickListener(this);
        ....
        tg1.setBackgroundColor(0xffcccccc); //set button grey
    }
    public void onClick(View v)
    {
        if((tg1.isChecked()))
        {

            tg1.setBackgroundColor(0xff00ffff);   //set button blue
        }
        else
        {

            tg1.setBackgroundColor(0xffcccccc); //set button grey
        }
    }
} 
```

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T11:35:37.950

正确方法：不要手动调用 isChecked 来更改背景。使用选择器。您可以绘制带边框的 9-patch 或创建[形状](http://developer.android.com/guide/topics/resources/drawable-resource.html#Shape)（使用描边设置边框颜色，使用实心设置填充颜色）。

或者创建一个自定义切换按钮来支持所需的功能。

# jquery - jQuery .append() 表单提交上的像素

> ID：14386242
> 
> 赞同：2
> 
> 时间：2013-01-17T19:05:03.763
> 
> 标签：jquery, forms, submit, append, pixel

我有`form`一个`onsubmit`函数调用，它尝试使用`.append()`.

`submit`在像素有机会触发之前，表单正在触发并将用户重定向到页面之外（在 chrome 网络调试器中显示为已取消的请求）。

我已经尝试了一些其他的东西`setTimeout()`，但我似乎无法得到任何工作。

我知道我可以将`onclick`事件与输入键检查结合使用，然后在`setTimeout`调用时提交表单。但是，这似乎有些骇人听闻。

另外，我无权访问表单提交到的页面。无法将像素添加到此页面。

有没有更好的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T19:27:52.997

我认为跟踪转换的最佳选择是在提交表单后从显示的页面请求这些像素。但是，如果您无法控制该页面，请执行以下操作：

```
$('form').submit( function(e){
    e.preventDefault(); // do not submit the form just yet
    var $t = $(this), 
        trackingUrl = 'http://placekitten.com/20/10'; 
        $('<img />')
            .on('load', function(){ // when the image loads...
                $t.unbind('submit')  // ...unbind the event listener preventing an endless loop
               .submit() // and submit the form
        }).attr('src', trackingUrl );
}); 
```

编辑：您还应该添加一些预防措施（例如 onerror 事件）以防跟踪图像无法加载，否则根本不会提交表单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-25T10:11:22.263

我遇到了类似的问题，因为我试图在用户看到表单（但尚未填写/提交）后触发跟踪（img）像素。用户单击按钮后会显示我的表单，从该站点上的许多帖子中收集的解决方案是在我的代码中添加以下脚本。

```
<script>
function firepixel()
{
trackingUrl = 'http://mydomain/adopt.php?type=popup';
$('<img />').on('load').attr('src',trackingUrl);

}
</script> 
```

然后，当用户单击触发弹出表单的按钮时，我调用了该函数。

```
<a class="button" onclick="firepixel()" href="#" data-reveal-id="myModal">Click Here to     Download eBook</a> 
```

# django - Django (JSONField) 和 sweetpie

> ID：14386243
> 
> 赞同：7
> 
> 时间：2013-01-17T19:05:04.840
> 
> 标签：django, json, tastypie

我使用 JSONField 在 mysql 中有一个类型为 TextField (django) 的表。这就是我的模型的外观

```
from django.db import models
from json_field import JSONField

class Model(models.Model):
   obj     = JSONField() 
```

我通过美味派发送的价值是

```
json_string = '{"data":"value"}' 
```

进入数据库我可以看到

```
{"data":"value"} 
```

但是当用 curl 检索数据时，我会得到这样的结果

```
"{u'data': u'value'}" 
```

我能做些什么不让 python u'field' 表示到美味派的输出中？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-05T21:50:08.313

我像这样解决了这个问题：

```
def dehydrate_user_inputs(self, bundle):
    requirement = Requirement.objects.get(pk = bundle.obj.pk)
    user_inputs = json.dumps(requirement.user_inputs)
    return user_inputs 
```

我的 JSONField 被命名为 user_inputs。需求是它所属的模型。

当 Tastypie 已经为我这样做时，我觉得在这里进行查询很奇怪，但是，这很有效。如果有更好的解决方案，我会很高兴。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-05-14T21:57:19.017

您看到的错误是由 Tastypie 将 JSONField 视为 TextArea 并在将 JSONField 返回的对象返回给调用者之前调用 str() 引起的。

另一种方法是对 JSONField 使用 fields.ApiFields。这是有效的，因为 fields.ApiFields 不会在进入 (hydrate()) 或离开 (convert()) 的方式上执行任何转换。这正是我们想要的——底层的 JSONField 会将 JSON 对象转换为字符串，以便在输入时保持持久性，并在输出时从字符串重新创建对象。因此，tastepie 不需要做任何事情。我的代码看起来有点像这样（基于 OP 示例的类/变量名称） -

```
class JSONField(fields.apiField):
    """ Wrapper over fields.apiField to make what we're doing here clear """
    pass

class MyModelResource(ModelResource):
    obj = JSONField('obj') 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-08-06T06:32:25.253

使用`DictField`：

```
obj = fields.DictField(attribute='obj') 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-10-03T10:34:19.243

我遇到了类似的问题，我的 unicode 字符串将在 API 中以奇怪的格式返回（我认为返回的是原始编码字符串，而不是实际的 utf-8 字符）。

无论如何，不​​要使用脱水方法并重新执行查询，最好在资源中使用自定义序列化程序。

这是我使用的：

```
class JSONSerializer(Serializer):
    '''using the standard json library for better unicode support,
       also note django.utils.simplejson, used in the standard Tastypie serializer, 
       is set for depreciation'''

    def to_json(self, data, options=None):
        options = options or {}
        data = self.to_simple(data, options)
        return json.dumps(data) 
```

然后在您的资源中：

```
class PlaceResource(ModelResource):
    class Meta:
        queryset = Place.objects.all()
        resource_name = 'place'
        serializer = JSONSerializer() 
```

# android - 如何在安卓手机中调用联系人应用程序

> ID：14386244
> 
> 赞同：0
> 
> 时间：2013-01-17T19:05:04.957
> 
> 标签：android, android-intent, android-contacts

我需要显示联系人列表，不想通过程序制作联系人列表。我想调用所有 android 手机中可用的联系人应用程序。我已经知道包名是 com.android.contacts。但是我不知道这个包的类名。

任何人都可以帮助我，请。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T19:26:23.790

使用此代码：

```
void showContacts()
{
    Intent i = new Intent();
    i.setComponent(new ComponentName("com.android.contacts", "com.android.contacts.DialtactsContactsEntryActivity"));
    i.setAction("android.intent.action.MAIN");
    i.addCategory("android.intent.category.LAUNCHER");
    i.addCategory("android.intent.category.DEFAULT");
    startActivity(i);
} 
```

来源：[Android 启动联系人应用程序](https://stackoverflow.com/questions/5787088/android-launching-contacts-application)

或者使用此代码获取所有联系人而不启动新意图：

```
Intent intent = new Intent(Intent.ACTION_PICK, ContactsContract.Contacts.CONTENT_URI);
startActivityForResult(intent, PICK_CONTACT);

@Override
public void onActivityResult(int reqCode, int resultCode, Intent data) {
  super.onActivityResult(reqCode, resultCode, data);

  switch (reqCode) {
    case (PICK_CONTACT) :
      if (resultCode == Activity.RESULT_OK) {
        Uri contactData = data.getData();
        Cursor c =  managedQuery(contactData, null, null, null, null);
        if (c.moveToFirst()) {
          String name = c.getString(c.getColumnIndex(ContactsContract.Contacts.DISPLAY_NAME));
          // TODO Whatever you want to do with the selected contact name.
        }
      }
      break;
  }
} 
```

也不要忘记设置此权限：

```
<uses-permission android:name="android.permission.READ_CONTACTS"/> 
```

来源：[如何调用Android联系人列表？](https://stackoverflow.com/questions/866769/how-to-call-android-contacts-list)

# c++ - 为什么多态性在这种情况下不起作用？

> ID：14386247
> 
> 赞同：5
> 
> 时间：2013-01-17T19:05:12.917
> 
> 标签：c++, stream, polymorphism, operator-overloading

简单类.h

```
class SimpleClass
{
    int i;

    public:
    SimpleClass() : i(0) {}
    SimpleClass(int j) : i(j) {}
    friend std::ostream& operator<<(std::ostream&, const SimpleClass&);
}; 
```

简单类.cpp

```
#include <ostream>
#include "SimpleClass.h"

std::ostream& operator<<(std::ostream& out, const SimpleClass& obj)
{
    out << "SimpleClass : " << obj.i << '\n';
    return out;
} 
```

基类和派生类.h

```
class BaseClass
{
    protected:
    int i;

    public:
    BaseClass() : i(0) {}
    BaseClass(int j) : i(j) {}
    virtual void print(std::ostream& out) const { out << "BaseClass : " << i << '\n'; }
};

class DerivedClass : public BaseClass
{
    int j;

    public:
    DerivedClass() : BaseClass(), j(0) {}
    DerivedClass(int m, int n) : BaseClass(m), j(n) {}
    void print(std::ostream& out) { out << "DerivedClass : " << i << ' ' << j << '\n'; }
};

std::ostream& operator<<(std::ostream&, const BaseClass&); 
```

基类和派生类.cpp

```
#include <ostream>
#include "Base and Derived Classes.h"

std::ostream& operator<<(std::ostream& out, const BaseClass& obj)
{
    obj.print(out);
    return out;
} 
```

主文件

```
#include <iostream>
#include "SimpleClass.h"
#include "Base and Derived Classes.h"

int main()
{
    SimpleClass simple(10);
    std::cout << simple;
    BaseClass base(100);
    std::cout << base;
    DerivedClass derived(100, 200);
    std::cout << derived;                   //  Doesn't call derived.print(), but base.print() instead. Why ?
} 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-17T19:09:17.600

```
virtual void print(std::ostream& out) const 
```

未被覆盖

```
void print(std::ostream& out) 
```

（因为`const`）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-17T19:09:18.333

您忘记了派生类中`const`的定义。`print`

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-01-17T19:09:23.713

在你`DerivedClass`的`print()`方法必须是**`const`**，就像它在`BaseClass`：

```
void print(std::ostream& out) const 
```

# php - 我今天可以在我的代码中做什么，以防止 2038 年的 unix 时间戳用完？

> ID：14386260
> 
> 赞同：6
> 
> 时间：2013-01-17T19:06:10.767
> 
> 标签：php, algorithm, unix, time

例如，我主要使用 PHP 进行编程。我今天能做些什么来防止我的程序在 2038 年由于 unix 时间戳耗尽而爆炸？我很想看到一些特定的算法、函数或逻辑可以用来防止这个问题。谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-17T19:11:11.760

将时间戳存储为 64 位或更高的整数。我敢肯定，到那时 MySQL 会更新，所以它`TIMESTAMP`不是 32 位的。关于 PHP，如果您使用的是 64 位服务器，我看不到任何问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-17T19:31:42.573

除非您计划在未来 25 年内使用 32 位服务器或 PHP 二进制文件，否则我认为这不会成为问题。

PHP 是一种解释型语言，因此当您编写`$stamp = 1358425440;`它时，它只是 PHP 读取的一串文本，*然后*根据*PHP*的编译方式分配 X 字节的内存来存储它。因此，如果您将 PHP 二进制文件更新为支持 64 位整数的二进制文件，则无需更改代码。[至少在理论上。我们都知道 PHP 喜欢改变和弃用常用函数。]

我能看到的唯一考虑是在 PHP 之外存储整数值，即。在 mySQL 中。在这种情况下，您只需确保将时间戳存储为*UNSIGNED* INT、BIGINT 或 DATETIME。

SIGNED INT 将于 2038 年 1 月 19 日星期二 03:14:07 GMT 结束，但*UNSIGNED* INT 将持续到 2106 年 2 月 7 日星期日 06:28:15 GMT。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-17T19:12:20.343

改变

```
 // 32 bit
    int timestampSec 
```

到

```
 // 64bit
    long timestampSec 
```

用于内部存储。

# oracle - 为什么 CASE 评估 ELSE 子句？

> ID：14386266
> 
> 赞同：0
> 
> 时间：2013-01-17T19:06:22.013
> 
> 标签：oracle, null, oracle11g, case

Oracle 11g：考虑以下两个 CASE 语句

**搜索案例**

```
with null_table as (select null as null_set from dual )
select 
     case 
     when (null_set is null) then 'NULL INDEED'
     else 'NOTNULL?'
     end as AM_I_NULL_OR_NOT   
from null_table 
```

**简单案例**

```
with null_table as (select null as null_set from dual )
select 
     case null_set
     when  (null) then 'NULL INDEED'
     else 'NOTNULL?'
     end as AM_I_NULL_OR_NOT   
from null_table 
```

Searched CASE 按预期评估**null_set**，但是 Simple CASE 似乎没有这样做。

问题：如何对**null_set**执行简单的 CASE 评估？

为什么 Simple CASE 会这样评估？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T19:09:07.913

在 Oracle 中，null 不能与使用`=`运算符进行比较。

例如：

```
select * from dual where null = null; -- No result
select * from dual where 1 = 1; -- gives a result 
```

所以你可以做的是用`NVL`另一个值替换 null ：

```
with null_table as (select null as null_set from dual )
select 
     case nvl(null_set,'X')
     when  'X' then 'NULL INDEED'
     else 'NOTNULL?'
     end as AM_I_NULL_OR_NOT   
from null_table 
```

（确保您的字段永远不能等于示例中的值 X。）

# php - CakePHP 中的 PhpStorm 代码自动完成

> ID：14386269
> 
> 赞同：0
> 
> 时间：2013-01-17T19:06:41.013
> 
> 标签：php, cakephp, cakephp-2.0, phpstorm

我在 CakePHP 2.2 应用程序中有一个控制器。
我使用 PhpStorm 4.0.1 作为 IDE。

在 MyController.php 文件中，我声明了这一点：

```
/**
 * @property MyUtilComponent $MyUtil
 */ 
```

1.  在我的控制器中，当我编写时，`$this->`我可以从下拉列表中选择“MyUtilComponent”。![在此处输入图像描述](../Images/428962eaa63b2072aba0e3836b9282f2.png)

2.  但是当我写的时候`$this->MyUtilComponent->`没有函数名选项来选择。![在此处输入图像描述](../Images/270e12e70fd421408b4b719378d43310.png)

3.  当我写`$this->MyUtil->addThis();`然后单击`addThis`单词并“转到声明”时，PhpStorm 成功进入方法的声明。

我应该怎么做才能让函数名自动完成？

注意：核心组件的行为相同。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T21:34:21.693

更新您的 PHPStorm。5.0.4 版目前已发布，可以按照您想要的方式工作。

# php - Facebook 支付平台 32 位服务器上的 64 位 order_id

> ID：14386271
> 
> 赞同：1
> 
> 时间：2013-01-17T19:06:52.207
> 
> 标签：php, facebook, callback, 32bit-64bit, payment

由于我似乎无法解决的问题，我目前正在撞到一堵巨大的墙。

问题是，当您通过 Facebook 支付平台 (facebook javascript sdk) 发出付款时，它会将数据发送到您的回调页面，该页面应该在后台处理付款。

这一切都很好，但有一个问题：facebook 使用的订单 ID 是 64 位 ID，而我的服务器是 32 位服务器，因此当它保存到回调页面中的变量时，它会失去 ID 的精度。这最终导致最终无法获得正确的 order_ID，因为它无法保存 ID。

该问题已在此论坛的多个页面上进行了描述，例如：

[facebook 信用回调，order_id 移动到新服务器后更改格式更改](https://stackoverflow.com/questions/8222942/facebook-credit-callback-order-id-changes-format-changes-after-moving-to-a-new)

和

[PHP：将 64 位整数转换为字符串](https://stackoverflow.com/questions/856549/php-converting-a-64bit-integer-to-string)

然而，在这两个页面上都没有解决问题的方法，而且我自己似乎无法解决这个问题。我试图将 facebook 发送到我的回调页面的 json 数据转换为字符串数据，而不是带有整数的数组（这发生在 facebook 提供的基本代码中），但我无法让它工作。

看到其他人已经克服了这个问题（无需将所有内容迁移到 64 位服务器），我想知道如何。

有没有人能够阐明这个主题？

编辑：我尝试转换为字符串，即被调用以解码 json 数据的标准 facebook 代码（由 facebook 提供的代码）：

```
$request = parse_signed_request($_POST['signed_request'], $app_secret); 
```

这调用函数 parse_signed_request，它执行以下操作：

```
function parse_signed_request($signed_request, $secret) {
list($encoded_sig, $payload) = explode('.', $signed_request, 2);

$sig = base64_url_decode($encoded_sig);

$data = json_decode(base64_url_decode($payload), true);

  if (strtoupper($data['algorithm']) !== 'HMAC-SHA256') {
    error_log('Unknown algorithm. Expected HMAC-SHA256');
    return null;
  }

  // check sig
  $expected_sig = hash_hmac('sha256', $payload, $secret, $raw = true);
  if ($sig !== $expected_sig) {
    error_log('Bad Signed JSON signature!');
    return null;
  }
  return $data;
} 
```

此函数解码来自 facebook 的加密 json 数据（使用应用程序密钥），并将 json 数据解码为 PHP 数组。

该函数使用以下函数（确切地说：

```
function base64_url_decode($input) {
  return base64_decode(strtr($input, '-_', '+/'));
} 
```

现在，上面的代码导致订单ID没有被正确保存，它失去了它的精度，导致一个id像：4.8567130814993E+14

我尝试使用以下函数以某种方式将 json 数据解码为字符串（因此 64 位整数 ID 不会丢失其精度），但无济于事：

```
 function largeint($rawjson) {
    $rawjson = substr($rawjson, 1, -1);
    $rawjson = explode(',' , $rawjson);
    array_walk($rawjson, 'strfun');
    $rawjson = implode(',', $rawjson);
    $rawjson = '{' . $rawjson . '}';
    $json = json_decode($rawjson);
    return $json;
  }

function strfun(&$entry, $key) {
    $data = explode(':', $entry);
    if (FALSE === strpos($data[1], '"')) {
    $data[1] = '"' . $data[1] . '"';
    $entry = implode(':', $data);
    }
} 
```

编辑（尤金斯回答）：

如果我在使用 json_decode 使其成为 php 变量之前尝试修改 JSON 数据，我应该使用 preg_replace 函数吗？下面是发送到回调页面以启动支付流程的初始 JSON 数据的示例。这里已经可以看出问题出在哪里了（这是在使用json_decode之后，id等数据失去了精度）。ID 被修改为不反映任何真实数据。如果您比较顶部的买家 ID 和底部的用户 ID，您会发现精度有所下降。

```
Array
(
[algorithm] => HMAC-SHA256
[credits] => Array
    (
        [buyer] => 1.0055555551318E+14
        [receiver] => 1.0055555551318E+14
        [order_id] => 5.2555555501665E+14
        [order_info] => {"item_id":"77"}
        [test_mode] => 1
    )

[expires] => 1358456400
[issued_at] => 1358452270
[oauth_token] => AAAH4s2ZCCEMkBAPiGSNsmj98HNdTandalotmoredata
[user] => Array
    (
        [country] => nl
        [locale] => nl_NL
        [age] => Array
            (
                [min] => 21
            )

    )

[user_id] => 100555555513181
) 
```

编辑＃3：

我尝试了以下方法将 JSON 数据中的所有整数都视为字符串，但这会导致 facebook 平台出错。然而，它确实将整数更改为字符串，所以我不会失去精度（太糟糕了，现在 xD 没有其他工作了）

```
preg_replace('/([^\\\])":([0-9]{10,})(,|})/', '$1":"$2"$3', $a) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T19:12:07.133

您正在运行哪个版本的 PHP？

如果您正在运行支持 JSON“JSON_BIGINT_AS_STRING”选项的 PHP 版本，那可能就是您的答案。您可能必须在使用 json_decode 添加该选项的地方修改他们的库。见[http://php.net/manual/en/function.json-decode.php](http://php.net/manual/en/function.json-decode.php)

如果您的 PHP 版本不支持 JSON_BIGINT_AS_STRING，那么您的选项仅限于：

hacky 选项：对从 FB API 返回的 JSON 字符串执行某种正则表达式操作，并将大整数用双引号括起来，以便它们解码为字符串而不是大整数。

理想的选择：硬着头皮迁移到 64 位环境。从长远来看，它将使您免于很多麻烦。

# visual-studio-2012 - Visual Studio 2012 文本编辑器中的这个“下拉”图标是做什么用的？

> ID：14386275
> 
> 赞同：-2
> 
> 时间：2013-01-17T19:07:01.177
> 
> 标签：visual-studio-2012

下面的图标显示在 Visual Studio 2012 的文本编辑器中垂直滚动条的顶部。当我向下拖动它时，另一个页面显示在当前可见页面的后面。它看起来像它的副本。（我使用的是深色主题）

这有什么用途？我不知道该功能被称为什么，因此我无法搜索它。我不确定它是 VS 2012 原生的，还是来自我正在使用的 VS 附加组件之一。

有时图标会消失。为什么？

![在此处输入图像描述](../Images/3bf7e71037a47339e2d1a917765f217e.png)

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-17T19:23:15.813

它用于文件的拆分查看。因此，您可以查看文件的一部分并编辑另一部分。这是高级文本编辑器中的常见功能。

# java - XML 布局问题

> ID：14386278
> 
> 赞同：0
> 
> 时间：2013-01-17T19:07:04.687
> 
> 标签：java, android, xml

我想扩展我的 XML 布局，因为我需要在一个屏幕上放置许多按钮。我在文本视图和图像视图下添加了一个滚动视图，但似乎无法扩展布局？我的滚动视图上也出现了 XML 错误布局：

```
error: Error parsing XML: mismatched tag 
```

这是我的布局，显示了扩展问题。谁能让我知道我做错了什么？：

![图片](../Images/d72c6b99be6eaab3a546a3ac82323f31.png)

这是我的 XML - 我知道我有重复的信息。这是一个测试。：

```
<?xml version="1.0" encoding="utf-8"?>

<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:orientation="vertical" >

<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="84dp"
    android:orientation="horizontal" >

    <ImageView
        android:id="@+id/imgLink"
        android:layout_width="60dp"
        android:layout_height="match_parent"
        android:layout_gravity="center_vertical"
        android:layout_weight="0.91"
        android:src="@drawable/menulist" />

    <TextView
        android:id="@+id/textView1"
        android:layout_width="165dp"
        android:layout_height="match_parent"
        android:layout_weight="0.14"
        android:gravity="center"
        android:text="Menu"
        android:textAppearance="?android:attr/textAppearanceLarge"
        android:textSize="40sp" />

</LinearLayout>

<ScrollView
android:layout_width="match_parent"
android:layout_height="match_parent" >

<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical" >

    <Button
        android:id="@+id/btnAdd"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_margin="20dp"
        android:drawableLeft="@drawable/addconmenu"
        android:src="@drawable/addconmenu"
        android:text="Contacts List" />

    <Button
        android:id="@+id/btnView"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_margin="20dp"
        android:drawableLeft="@drawable/todo"
        android:src="@drawable/todo"
        android:text="&apos;To Do&apos; List" />

    <Button
        android:id="@+id/btnEdit"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_margin="20dp"
        android:drawableLeft="@drawable/musicmenu"
        android:src="@drawable/musicmenu"
        android:text="Music List" />

       <Button
           android:id="@+id/btnEdit"
           android:layout_width="match_parent"
           android:layout_height="wrap_content"
           android:layout_margin="20dp"
           android:drawableLeft="@drawable/shoppingmenu"
           android:src="@drawable/shoppingmenu"
           android:text="Shopping List" />

           <Button
               android:id="@+id/btnEdit"
               android:layout_width="match_parent"
               android:layout_height="wrap_content"
               android:layout_margin="20dp"
               android:drawableLeft="@drawable/gymmenu"
               android:src="@drawable/gymmenu"
               android:text="Gym List" />

           <Button
               android:id="@+id/btnEdit"
               android:layout_width="match_parent"
               android:layout_height="wrap_content"
               android:layout_margin="20dp"
               android:drawableLeft="@drawable/appointmentmenu"
               android:src="@drawable/appointmentmenu"
               android:text="Appointment List" />

</LinearLayout>

</LinearLayout>
</ScrollView> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T19:11:00.077

看起来您应该颠倒布局最后两行的顺序。您`ScrollView`在关闭顶级标签后关闭`LinearLayout`标签。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-09-22T11:29:00.023

ScrollView 内部的 Linear Layout 高度是 wrapcontent，如果你让它匹配 parent 或 fillparent 它将解决你的问题。

# c# - 是否可以在纯托管代码中生成/产生 c0000005 访问冲突异常？

> ID：14386280
> 
> 赞同：4
> 
> 时间：2013-01-17T19:07:10.033
> 
> 标签：c#, .net, managed

我相信不可能在 .Net 中的“纯”托管代码中产生/生成访问冲突异常。如果有人认为 .Net 完美无缺，并且不使用任何外部库（非托管），例如互操作。

我生活在幻想中吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-17T19:19:06.827

```
throw new AccessViolationException(); 
```

这是纯托管代码，它会产生 AccessViolationException ：P

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-17T20:04:07.047

您还可以使用以下代码（尽管由于输入格式错误，它只会引发 AccessViolationException）：

```
IntPtr ptr = new IntPtr(123);
Marshal.StructureToPtr(123, ptr, true); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-17T19:28:29.317

You can e.g. use WPF which does call into your graphics card driver. You can easily get AcessViolationExceptions pre .NET 4.5 those with a buggy graphics card drivers which are not at all uncommon.

In a strange sense you are right. With .NET 4.5 and above you will never get AccessViolationExceptions in managed code anymore because the .NET runtime does not convert an AccessViolation coming from unmanaged code to an AccessViolationException anymore but it does terminate your process immediately. I guess MS support was tired to search for .NET Framework bugs only to find that it was a buggy graphics card driver.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-17T19:29:21.303

您几乎永远不会看到 CPU 实际上异步抛出一个（在某事的中间），因为如果 'this' 在方法调用中为空，.NET 即时编译器通常会引发异常。在它可能使用 0 作为地址之前，它`cmp [rcx],rcx`会在调用站点引发异常。可以有足够大的字段偏移来读取带有空指针的可读内存，因此可以防止这种情况发生。

请参阅[http://blogs.msdn.com/b/oldnewthing/archive/2007/08/16/4407029.aspx](http://blogs.msdn.com/b/oldnewthing/archive/2007/08/16/4407029.aspx)

没有魔法，C# 就像任何其他编译语言一样变成指令。没有理由对 AV 永远不会发生感到舒适。

# java - 如何在 Mac OSX 上将 Access 数据库与 Netbeans 连接？

> ID：14386281
> 
> 赞同：3
> 
> 时间：2013-01-17T19:07:17.960
> 
> 标签：java, macos, ms-access, netbeans

我有一个访问数据库，我正在用 Java 编程。我可以用什么将我的 netbeans 与本地主机上的数据库连接起来？

仅在 Windows 中找到此代码（它使用本地 db 文件）：

```
try {
    Class.forName("sun.jdbc.odbc.JdbcOdbcDriver");
    String url = "jdbc:odbc:Driver={Microsoft Access Driver " +
        "(*.mdb, *.accdb)};DBQ=C:\\Database\\Northwind 2007.accdb";
    Connection con = DriverManager.getConnection(url);
    System.out.println("Connected!");
    con.close();
} catch (SQLException e) {
    System.out.println("SQL Exception: "+ e.toString());
} catch (ClassNotFoundException cE) {
    System.out.println("Class Not Found Exception: "+cE.toString());
} 
```

也许有人知道如何为mac环境修改它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-03-22T13:40:51.647

看看使用可下载的[UCanAccess](http://ucanaccess.sourceforge.net/site.html) JDBC 驱动程序。在项目的库中包含所有 jar 文件，您应该能够在不安装 Access 的情况下连接到您的 access 数据库。UCanAccess 最适用于 NetBeans。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T19:46:37.537

在[Access Database Manipulation via JDBC](http://www.planet-source-code.com/vb/scripts/ShowCode.asp?txtCodeId=2691&lngWId=2)中逐步解释。

# android - 如何禁用键盘中的字母（只留下数字）？

> ID：14386282
> 
> 赞同：1
> 
> 时间：2013-01-17T19:07:21.733
> 
> 标签：android

我正在开发 Android 应用程序，我需要禁用用户键盘的字母以允许用户在 EditText 中仅输入数字。请告诉我，这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T19:09:09.940

添加`android:inputType="number"`到布局 xml 中的 EditText。

有关 inputType 的更多信息，请访问[http://developer.android.com/reference/android/widget/TextView.html#attr_android:inputType](http://developer.android.com/reference/android/widget/TextView.html#attr_android:inputType)

您还可以更进一步并执行以下操作：

```
<EditText
    android:inputType="number"
    android:digits="0123456789"
/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T19:21:58.630

EditText 输入 = 新的 EditText(this); input.setInputType(InputType.TYPE_CLASS_NUMBER);

或者

使用 XML

安卓：inputType="数字"

# c# - 任务的界面帮助 方法

> ID：14386283
> 
> 赞同：0
> 
> 时间：2013-01-17T19:07:22.797
> 
> 标签：c#, .net, generics, asynchronous, interface

我正在尝试使用 MVVMLight 中的 SimpleIOC 解耦一些具体的类和链接。这是我的课，我想制作一个接口，然后可以向 simpleioc 注册

```
public class SerialisationService : ISerialisationService
{

    private static async Task<T> LoadLocalXMLAsync<T>(string filename)
    {
        try
        {
            StorageFile file = await ApplicationData.Current.LocalFolder.GetFileAsync(filename);
            T o = default(T);
            using (IInputStream inStream = await file.OpenSequentialReadAsync())
            {
                var serializer = new DataContractSerializer(typeof(T));
                o = (T)serializer.ReadObject(inStream.AsStreamForRead());
            }
            return o;
        }
        catch (Exception ex)
        {
            return default(T);
            // ERROR HANDLING AND LOGGING
        }
    }

    private async static Task SaveLocalXMLAsync(string filename, object o)
    {
        try
        {
            var serializer = new DataContractSerializer(o.GetType());
            StorageFile file = await ApplicationData.Current.LocalFolder.CreateFileAsync(filename, CreationCollisionOption.ReplaceExisting);
            using (Stream fileStream = await file.OpenStreamForWriteAsync())
            {
                serializer.WriteObject(fileStream, o);
                await fileStream.FlushAsync();
            }
        }
        catch (Exception ex)
        {
            // ERROR HANDLING AND LOGGING
        }
    }

} 
```

我已经尝试了一些事情，但无法弄清楚在这种情况下如何定义用于返回 Task 的通用接口。

我需要使用注册

```
SimpleIoc.Default.Register<ISerialisationService, SerialisationService>(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T19:28:50.593

The Interface:

```
public interface ISerialisationService
{
    Task<T> LoadLocalXMLAsync<T>(string filename);
    Task SaveLocalXMLAsync(string filename, object o);
} 
```

The Implementation:

```
public class SerialisationService : ISerialisationService
{

    public async Task<T> LoadLocalXMLAsync<T>(string filename)
    {
        try
        {
            StorageFile file = await ApplicationData.Current.LocalFolder.GetFileAsync(filename);
            T o = default(T);
            using (IInputStream inStream = await file.OpenSequentialReadAsync())
            {
                var serializer = new DataContractSerializer(typeof(T));
                o = (T)serializer.ReadObject(inStream.AsStreamForRead());
            }
            return o;
        }
        catch (Exception ex)
        {
            return default(T);
            // ERROR HANDLING AND LOGGING
        }
    }

    public async Task SaveLocalXMLAsync(string filename, object o)
    {
        try
        {
            var serializer = new DataContractSerializer(o.GetType());
            StorageFile file = await ApplicationData.Current.LocalFolder.CreateFileAsync(filename, CreationCollisionOption.ReplaceExisting);
            using (Stream fileStream = await file.OpenStreamForWriteAsync())
            {
                serializer.WriteObject(fileStream, o);
                await fileStream.FlushAsync();
            }
        }
        catch (Exception ex)
        {
            // ERROR HANDLING AND LOGGING
        }
    }

} 
```

# c# - 为什么 UserPrincipal.FindByIdentity 返回关于 GUID 为 32 位的错误？

> ID：14386297
> 
> 赞同：6
> 
> 时间：2013-01-17T19:08:05.617
> 
> 标签：c#

我的应用程序使用`UserPrincipal`该类来确定用户属于哪些组，然后使用该信息来确定用户是否经过身份验证才能使用我的应用程序。事情在一段时间内工作得很好，但最近我开始遇到异常

> Guid 应包含 32 位数字和 4 个破折号 (xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx)

打电话时`UserPrincipal.FindByIdentity`。看起来调用成功并且异常处理得当，但让我担心将来身份验证会突然中断。我没有在任何地方明确创建 GUID，所以我不知道异常来自哪里。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-17T19:25:37.187

很可能是在试图从无效的 GUID 值初始化某种安全描述符的框架代码深处引发异常。如果框架正在捕获它并在内部处理它，我就不会担心它。

跟踪框架代码，这里可能是它发生的一个地方：

```
protected static bool IdentityClaimToFilter(string identity, string identityFormat, ref string filter, bool throwOnFail)
{
  if (identity == null)
    identity = "";
  StringBuilder filter1 = new StringBuilder();
  switch (identityFormat)
  {
    case "ms-guid":
      Guid guid;
      try
      {
        guid = new Guid(identity);
      }
      catch (FormatException ex)
      {
        if (throwOnFail)
          throw new ArgumentException(ex.Message, (Exception) ex);
        else
          return false;
      }
... 
```

请注意，它*尝试*创建一个新`Guid`的 ，如果失败，则会引发异常，但代码会吞下它并返回 false

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-10-14T15:41:09.423

如果您提供 IdentityType，它不会尝试将您的值视为 Guid，因此不会抛出异常

```
FindByIdentityWithType(context, typeof(UserPrincipalEx), **IdentityType.SamAccountName**, identityValue); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-05-18T14:52:39.127

我的调试系统突然开始这样做了，我不知道为什么。原来，当我删除一个 .user 文件时，我似乎禁用了`Just My Code`调试，并且这个异常开始被破坏。因此，请检查您在该区域周围的 VS 选项，您（可能）希望勾选此选项：

[![在此处输入图像描述](../Images/f672913e7410ed09ad483a263ed72bb2.png)](https://i.stack.imgur.com/D3ZDI.jpg)

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2020-09-28T10:30:46.810

只有以下方式对我有用。

```
var user = _userManager.FindByNameAsync(HttpContext.User.Identity.Name); 
```

# django - django form is_valid 总是失败（扩展 django-registration form）

> ID：14386298
> 
> 赞同：2
> 
> 时间：2013-01-17T19:08:09.080
> 
> 标签：django, forms, signals, registration

我正在尝试扩展 Django 注册以包含我自己的注册表单。原则上这是相当简单的。我只需要编写自己的表单 ( `CustomRegistrationForm`)，它是原始表单 ( ) 的子表单`RegistrationForm`。然后我可以使用 django 注册的 user_registered 信号来处理我的特定输入。

所以这就是我所做的：

**网址.py：**

```
from django.conf.urls import patterns, include, url
from registration.views import register
from forms import CustomRegistrationForm
from django.contrib import admin
import regbackend
admin.autodiscover()

urlpatterns = patterns('',
    url(r'^register/$', register, {'backend': 'registration.backends.default.DefaultBackend', 'form_class': CustomRegistrationForm, 'template_name': 'custom_profile/registration_form.html'}, 
                        name='registration_register'),
) 
```

**regbackend.py：**

```
from django import forms
from models import UserProfile
from forms import CustomRegistrationForm

def user_created(sender, user, request, **kwargs):
    form = CustomRegistrationForm(data=request.POST, files=request.FILES)
    if form.is_valid(): # HERE: always fails
        user_profile = UserProfile()
        user_profile.user = user
        user_profile.matriculation_number = form.cleaned_data['matriculation_number']
        user_profile.save()

from registration.signals import user_registered
user_registered.connect(user_created) 
```

**表格.py：**

```
from models import UserProfile
from django import forms
from registration.forms import RegistrationForm
from django.utils.translation import ugettext_lazy as _

attrs_dict = {'class': 'required'}

class CustomRegistrationForm(RegistrationForm):
    matriculation_number = forms.CharField(widget=forms.TextInput(attrs=attrs_dict),
                                           label=_("Matriculation number"),
                                           max_length=12,
                                           error_messages={'invalid': _("This value has to be unique and may contain only numbers.")},
                                           initial=108)

    def clean_matriculation_number(self):
        print "Validating matriculation number."
        data = self.cleaned_data['matriculation_number']
        if len(data) != 12:
            raise forms.ValidationError(_("Matriculation number consists of exactly 12 digits."))
        return data 
```

所以问题出在`is_valid()`函数上，因为它总是返回`False`. 即使没有错误！那么有什么问题呢？我花了几个小时在这个上，我不知道了:(

任何帮助深表感谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-21T21:56:35.210

失败的原因`form.is_valid()`可能是因为表单的“clean_username”函数检查传递给它的用户名是否已经存在。由于该信号是在创建 User 对象并添加到数据库之后发送的，因此表单每次都无法通过此测试。我的猜测是，如果您`form.cleaned_data`在`is_valid()`返回后登录`False`，您将获得除用户名之外的所有字段的列表。

`form.data`如果表单 clean_ 函数进行任何更改，则可能不包含字段的更改值（我在 form.data 上找不到太多文档）。

为了避免这可能导致的潜在问题，我为我的自定义注册表单制作了两个类：

```
# I use this one for validating in my create_user_profile function
class MyRegistrationFormInternal(forms.Form):
    # Just an example with only one field that holds a name
    name = forms.CharField(initial="Your name", max_length=100)    
    def clean_name(self):
        # (Optional) Change the name in some way, but do not check to see if it already exists
        return self.cleaned_data['name'] + ' foo '
# This one is actually displayed
class MyRegistrationForm (MyRegistrationFormInternal):
    # Here is where we check if the user already exists
    def clean_name(self):
        modified_name = super(MyRegistrationForm, self).clean_name()
        # Check if a user with this name already exists
        duplicate = (User.objects.filter(name=modified_name)
        if duplicate.exists():
            raise forms.ValidationError("A user with that name already exists.")  
        else:
            return modified_name 
```

然后，您可以通过运行 POST 数据，而不是使用 form.data（在某些方面可能仍然是“不干净的”）`MyRegistrationFormInternal`，并且`is_valid()`不应该总是返回 false。

我意识到这不是最干净的解决方案，但它避免了使用（可能是原始的）form.data。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T12:52:47.077

好的，我想我解决了（或多或少）。

我仍然不确定，为什么表单没有验证。但正如我所说，我正在扩展 django-registration 和已经调用表单的 is_valid() 的“注册”视图，所以我可以假设当我进一步处理发布的数据时表单是有效的。然后视图调用后端

```
backend.register(request, **form.cleaned_data) 
```

带有请求和清理后的数据（只是用户名、电子邮件和密码）。所以我不能用它来注册，因为我的附加信息丢失了。然后后端触发我正在使用的信号，我所做的是，我使用提供的请求再次创建了表单。但是，此表单不会验证（我尝试了一切！！）我查了一下，我正在做与 django-registration 完全相同的事情，但它在我的代码中不起作用。

所以我并没有真正解决问题，因为表单仍然没有验证。但是当我意识到表单已经被“注册”视图验证时，我对此感到平静。所以我现在使用 form.data[..] 而不是 form.cleaned_data[..] 这应该不是问题......

# c# - 不是我的代码中的访问冲突

> ID：14386301
> 
> 赞同：23
> 
> 时间：2013-01-17T19:08:13.170
> 
> 标签：c#, .net, access-violation

我不确定如何进行调试。我有一个完全由托管代码组成的 C# 程序，在 .NET 4.5 中运行。运行一段时间后，在某个看似随机的时间，我收到一条错误消息“mscorlib.dll 中发生'System.AccessViolationException'类型的未处理异常”。因为我是从 Visual Studio (2012) 运行它，所以我单击“break”并看到以下调用堆栈：

```
mscorlib.dll!System.Threading._IOCompletionCallback.PerformIOCompletionCallback(uint errorCode, uint numBytes, System.Threading.NativeOverlapped* pOVERLAP) + 0x47 bytes    
[Native to Managed Transition]  
ntdll.dll!_NtRequestWaitReplyPort@12()  + 0xc bytes 
kernel32.dll!_ConsoleClientCallServer@16()  + 0x4f bytes    
kernel32.dll!_GetConsoleLangId@4()  + 0x2b bytes    
kernel32.dll!_SetTEBLangID@0()  + 0xf bytes 
KernelBase.dll!_GetModuleHandleForUnicodeString@4()  + 0x22 bytes   
mdnsNSP.dll!7177aa48()  
[Frames below may be incorrect and/or missing, no symbols loaded for mdnsNSP.dll]   
mdnsNSP.dll!71775b06()  
mdnsNSP.dll!71774ded()  
mdnsNSP.dll!71774e8c()  
bcryptprimitives.dll!746d1159()     
bcryptprimitives.dll!746d1137()     
ntdll.dll!_LdrpCallInitRoutine@16()  + 0x14 bytes   
ntdll.dll!_NtTestAlert@0()  + 0xc bytes 
ntdll.dll!_NtContinue@8()  + 0xc bytes  
ntdll.dll!_LdrInitializeThunk@8()  + 0x1a bytes 
```

我注意到的一件有趣的事情是调用堆栈中的任何内容都不是我的代码。

你会建议我使用什么策略来找到问题的路径？或者您是否遇到过类似的问题并有什么提示？

由于异常似乎不包括我的代码，我不知道要包括哪些信息有助于回答问题，但问我是否还有其他需要包括的信息。

由于错误可能与 IO 相关（因为 PerformIOCompletionCallback 位于堆栈顶部），这是此应用程序执行的典型 IO 任务的列表：

*   TcpListener.AcceptTcpClientAsync
*   NetworkStream.Write/BeginRead/EndRead
*   SqlCommand.BeginExecuteReader/EndExecuteReader
*   StreamWriter.WriteLine

其他注意事项：

*   它似乎是大致可重复的 - 我在同一个地方（PerformIOCompletionCallback）得到同样的错误，但必须等待不同的时间才能得到它（以分钟为单位）。
*   我不认为我可以制作一个可靠地突出问题的小程序。我的程序在遇到此错误之前处理了数千个类似的 IO 操作。

**编辑：**

根据@Kevin 的建议，即 Mdnsnsp.dll 来自 Bonjour，我卸载了 Bonjour 并再次尝试。异常仍然存在，但调用堆栈更清晰：

```
mscorlib.dll!System.Threading._IOCompletionCallback.PerformIOCompletionCallback(uint errorCode, uint numBytes, System.Threading.NativeOverlapped* pOVERLAP) + 0x47 bytes    
[Native to Managed Transition]  
kernel32.dll!@BaseThreadInitThunk@12()  + 0x12 bytes    
ntdll.dll!___RtlUserThreadStart@8()  + 0x27 bytes   
ntdll.dll!__RtlUserThreadStart@8()  + 0x1b bytes 
```

我假设 Bonjour 安装程序为网络流量安装了一些良性钩子 DLL，但卸载它并没有解决问题。

**编辑：**

我已经使用较慢的“安全”等效项临时重新编码了我的所有`unsafe`功能，以消除它作为嫌疑人。现在应用程序中的所有程序集都没有使用不安全开关进行编译。问题仍然存在。重申一下，我现在在此应用程序中没有不安全代码、本机代码和 P/Invoke 调用（在用户代码中），但我仍然遇到`AccessViolationException`上述情况。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T16:03:46.357

由于它的 PerformIOCompletionCallback 导致错误，我会查看您的异步 IO 调用。

*   TcpListener.AcceptTcpClientAsync
*   NetworkStream.Write/BeginRead/EndRead
*   SqlCommand.BeginExecuteReader/EndExecuteReader

该错误似乎正在发生，因为注册的句柄不再有效。由于它发生在托管代码中，因此原因将来自托管对象，而不是来自第 3 方本机 DLL。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-27T13:45:33.203

don't know if it can help you but looks like we faced a similar problem several years ago. As I remember our investigation pointed on dll in other program - we found that memory access violations can be caused by antiviruses (NOD32 in our case), firewalls or network sniffers/traffic controllers.

Try to check applications log (Control Panel -> System and Security -> Administrative Tools -> Event Viewer) for errors caused by above applications. If problem is with other program try to disable/uninstall it and check again if crash still appears in your programm.

**UPD** Have you tried to reproduce this issue on the clean test environment?

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-25T14:17:36.820

您可以使用 debugdiag 查看是什么导致您的计算机上出现 AccessViolationException。为您的进程配置崩溃规则并检查转储和日志文件。我希望你能通过这种方式获得更多关于这个主题的信息。还要确保让您的机器运行最新的 Windows 更新，因为我遇到了类似的问题，该问题已在 CLR 版本的安全更新中得到解决。

# python - Flask：如何删除 cookie？

> ID：14386304
> 
> 赞同：42
> 
> 时间：2013-01-17T19:08:21.673
> 
> 标签：python, cookies, flask

我使用文档中建议的代码设置 cookie：

```
from flask import make_response

@app.route('/')
def index():
    resp = make_response(render_template(...))
    resp.set_cookie('username', 'the username')
    return resp 
```

但是我该如何删除它们？没有 remove_cookie 方法。我试过：

```
if request.cookies.get('sessionID');
    request.cookies.pop('sessionID', None) 
```

但事实证明 request.cookies 对象是不可变的。我该怎么办？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2013-01-17T19:15:09.933

没有用于删除 cookie 的 HTTP 标头。传统上，您只需将 cookie 设置为具有过去过期日期的虚拟值，因此它会立即过期。

```
resp.set_cookie('sessionID', '', expires=0) 
```

这会将会话 id cookie 设置为在 unixtime 到期的空字符串`0`，这几乎可以肯定是过去了。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2018-04-19T06:06:26.703

我们可以让我们从 flask.Response 中获得 delete_cookie()。

```
resp.delete_cookie('username') 
```

这将在响应时删除 cookie。这是[delete_cookie 文档](https://tedboy.github.io/flask/generated/generated/flask.Response.delete_cookie.html)。

此外，您可能希望添加**路径**（默认设置为“/”）和**域**（默认设置为无）。

```
resp.delete_cookie('username', path='/', domain='yourdomain.com') 
```

这是解释器屏幕截图，它显示了 flask.Response 中的 delete_cookie 对象。

[![Python 解释器截图](../Images/1baf06abc8121e9894fb704aed36abfd.png)](https://i.stack.imgur.com/TmTze.png)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-01-17T19:14:01.647

您需要将 cookie 设置为过去的过期时间。

```
resp = make_response(render_template(...))
resp.set_cookie('username', expires=0)
return resp 
```

顺便说一句，我希望您实际上并不期望用户名 cookie 是安全的。因为不是。用户可以将任何他想要的东西放在那里。解决方案通常是使用 Flask 会话，该会话使用用户无法修改的签名 cookie。

# events - 无法分配给“ResizeEnd”，因为它是“方法组”

> ID：14386307
> 
> 赞同：0
> 
> 时间：2013-01-17T19:08:45.633
> 
> 标签：events, compiler-errors, method-group

我正在使用 Visual Studio 2010。在我的表单设计器中，我向 ResizeEnd 事件添加了一个事件处理程序。生成的代码如下所示：

this.ResizeEnd += new System.EventHandler(this.ResizeEndEventHandler);

此代码由 Visual Studio 添加到我的源代码中，生成错误说明：无法分配给“ResizeEnd”，因为它是“方法组”

如果您错误地尝试为方法分配值，我之前已经看到过此错误......但在添加事件处理程序时从未见过。

任何关于导致此问题或如何解决此问题的想法将不胜感激。

# c++ - 如何复制窗口的可视内容并将其放在 win32 c++ 中的新窗口上？

> ID：14386312
> 
> 赞同：0
> 
> 时间：2013-01-17T19:09:07.567
> 
> 标签：c++, windows, winapi, win32gui

我读过一些关于 GetDIBits 或 BitBlt 的文章，但我不理解它们。

那可能是因为我不了解 Windows 实际如何处理 Windows 上的图形。如果有人可以将我推荐给我可以了解这些事情的页面，那将是完美的！:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T20:43:24.407

我在 windows WM_PAINT 中使用此代码解决了这个问题。它现在显示与目标窗口完全相同的内容。

```
PAINTSTRUCT ps;
HDC hdc = BeginPaint(MainWindow, &ps);

HDC TargetDC = GetDC(TargetWindow);

RECT rect;
GetWindowRect(TargetWindow, &rect);

BitBlt(hdc,0,0,rect.right-rect.left,rect.bottom-rect.top,TargetDC,0,0,SRCCOPY);

EndPaint(MainWindow, &ps); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T06:28:11.683

你想要的是：

1.  获取您想要像素的窗口的 HWND。
2.  创建一个正确大小的内存 DC（检查[一下](http://www.codeproject.com/Articles/224754/Guide-to-Win32-Memory-DC)）。
3.  在提供内存 DC 的同时将 WM_PRINTCLIENT 或 WM_PAINT 发送到窗口（尽管并非所有控件/窗口都实现了这一点）
4.  将内存 DC 的内容复制到屏幕

或者，对于第 3 步，您可以使用 DWM 或使用剪贴板获取 hacky：

```
void CopyWndToClipboard(CWnd *pWnd)
{
    CBitmap     bitmap;
    CClientDC   dc(pWnd);
    CDC         memDC;
    CRect       rect;

    memDC.CreateCompatibleDC(&dc);

    pWnd->GetWindowRect(rect);

    bitmap.CreateCompatibleBitmap(&dc, rect.Width(),rect.Height());

    CBitmap* pOldBitmap = memDC.SelectObject(&bitmap);
    memDC.BitBlt(0, 0, rect.Width(),rect.Height(), &dc, 0, 0, SRCCOPY);

    pWnd->OpenClipboard() ;
    EmptyClipboard() ;
    SetClipboardData(CF_BITMAP, bitmap.GetSafeHandle()) ;
    CloseClipboard() ;

    memDC.SelectObject(pOldBitmap);
    bitmap.Detach();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-17T20:00:43.560

向窗口发送[WM_PRINTCLIENT](http://msdn.microsoft.com/en-gb/library/windows/desktop/dd145217%28v=vs.85%29.aspx)消息可能会带来一些运气。这可能不适用于使用 DirectX 或 OpenGL 的窗口。

在启用 Aero 的系统上使用 WM_PRINTCLIENT 可能会遇到一些问题（即当 DWM 处于活动状态时）。如果系统确实激活了 DWM，那么它可能会提供获取窗口后备存储的方法，但我之前没有深入研究过这样做。

# sql - 将计算列转换为特定数据类型

> ID：14386314
> 
> 赞同：1
> 
> 时间：2013-01-17T19:09:09.877
> 
> 标签：sql, sql-server-2008

我目前正在尝试从我的 Java GUI 中执行 SQLSERVER 2008 R2 中的一些 SQL 查询。我正在研究货币管理系统。我必须存储 Long 数据类型值，因为货币数字可能超过 10 位，但计算列在表的设计视图中未显示任何数据类型选项。我真的需要帮助，因为我的值超过 10 位，我需要从我的数据库中选择总值。我试图执行代码，但它显示某种溢出错误请帮助

以下是我的数据库名称 CNV 表的脚本文件

```
USE [CNV]

CREATE TABLE [dbo].[soil_det](
    [ID] [int] IDENTITY(1,1) NOT NULL,
    [rm_id] [bigint] NULL,
    [box_no] [int] NULL,
    [weight] [decimal](18, 2) NULL,
    [note_state] [varchar](10) NULL,
    [dm_state] [varchar](10) NULL,
    [1] [int] NULL,
    [2] [int] NULL,
    [5] [int] NULL,
    [10] [int] NULL,
    [20] [int] NULL,
    [50] [int] NULL,
    [100] [int] NULL,
    [500] [int] NULL,
    [1000] [int] NULL,
    [tp]  AS (((((((([1]+[2])+[5])+[10])+[20])+[50])+[100])+[500])+[1000]),
    [tv]  AS (((((((([1]*(1)+[2]*(2))+[5]*(5))+[10]*(10))+[20]*(20))+[50]*(50))+[100]*(100))+[500]*(500))+[1000]*(1000)) PERSISTED,
    [tp_ex1]  AS ((((((([2]+[5])+[10])+[20])+[50])+[100])+[500])+[1000]),
    [tv_ex1]  AS ((((((([2]*(2)+[5]*(5))+[10]*(10))+[20]*(20))+[50]*(50))+[100]*(100))+[500]*(500))+[1000]*(1000)),
    [val_1]  AS ([1]*(1)),
 CONSTRAINT [PK_mut_det] PRIMARY KEY CLUSTERED 
(
    [ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T19:14:15.490

这是解决方案，您可以按照图片中给出的方式进行操作

在这里查看完整的文章：[SQL SERVER – Puzzle – Solution – Computed Columns Datatype Explanation](http://blog.sqlauthority.com/2008/09/29/sql-server-puzzle-solution-computed-columns-datatype-explanation/)

![在此处输入图像描述](../Images/d640251e466c3348949ad3259584f7ae.png)

# c# - 使用protobuf-net，序列化实现接口的派生类型的正确方法是什么？

> ID：14386323
> 
> 赞同：1
> 
> 时间：2013-01-17T19:09:26.587
> 
> 标签：c#, protobuf-net, enyim

我意识到这里有类似的问题，但没有一个问题像我需要的那样直截了当，可能是因为我缺乏 protobuf 经验。我正在为 enyim 的缓存客户端进行代码转换，并且无法弄清楚如何创建一个既派生又实现接口反序列化的类。

对于这样的样本

```
public class BaseClass
{
}

public interface ISomeRules
{
}

public class DerivedClass : BaseClass, ISomeRules
{
}

public class ThirdClass
{
    ISomeRules ruleUser;
} 
```

我想做这样的事情，因为我通常在任何地方都使用属性

```
[ProtoContract
,ProtoInclude(101,typeof(DerivedClass))
]
public class BaseClass
{
}

[ProtoContract
,ProtoInclude(102,typeof(DerivedClass))
]
public interface ISomeRules
{
}

[ProtoContract]
public class DerivedClass : BaseClass, ISomeRules
{
}

[ProtoContract]
public class ThirdClass
{
    [ProtoMember(1)]
    ISomeRules ruleUser;
} 
```

但它无法静默缓存。如果像某些人建议的那样，我`ProtoContract`从 中删除该属性`ISomeRules`，则反序列化将失败。

使用 protobuf-net 是否可行？这样做的正确方法是什么？我应该使用 TypeModel （我不掌握，但哪些简单的测试表明有同样的问题）来代替？还是 TypeModel 和属性的组合？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-17T20:18:23.037

protobuf-net 中的接口支持适用于有限的场景，您基本上是在使用基于接口的模型，特别是对于嵌套成员。例如：

```
[ProtoContract]
public class Foo {
    [ProtoMember(1)]
    public IBar Bar {get;set;}
} 
```

在上面，我们希望能够序列化`Bar`，但我们可能对此了解不多。事实上，如果`Foo`保证从 中返回一个非空值`Bar`，protobuf-net 甚至不需要知道任何关于具体类型等的信息——它可以继续并填充给定的对象。

在您的示例中，根对象无疑是`BaseClass`. 我建议这是辅助性的，*根本*`ISomeRules`不需要在模型中提及。但是，如果您*想*填充**仅**通过 公开的成员，那么您可以尝试（未经测试）：****`ISomeRules`****

 ****```
[ProtoMember(n)]
private ISomeRules Rules { get { return this; } } 
```

然后，这会公开`ISomeRules`信息，但会将其欺骗为子对象。至少值得一试；p****

# ios - 具有嵌入式控件和自动中断文本的自动流动布局

> ID：14386326
> 
> 赞同：1
> 
> 时间：2013-01-17T19:09:31.040
> 
> 标签：ios

我正在尝试为我的 iPhone 和 iPad 应用程序创建一个布局，该布局会根据动态数据自动重排。更具体一点，这意味着我有几个对象。每个对象都有特定的类型和相关的数据。*数据*是应该显示的，类型*决定*了它应该如何显示。类型可以是*text*，这意味着它应该显示为简单的文本，没有交互的可能性。另一种类型可能是*date*，这意味着它应该显示为允许用户在点击时选择日期的控件。

现在，问题是我要显示的对象的数量和相关数据是动态的，所以我不能将控件放置在静态位置。

[这个 jsfiddle](http://jsfiddle.net/DHilgarth/wNEsU/1/)显示了我的意思是哪种布局。根据 的宽度`div`，内容会自动重新排列，并且日期输入控件会出现在文本中间。

我找不到任何支持这种情况的控件 - 那么我将如何实现这一目标？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T23:53:16.140

[这](http://robnapier.net/blog/wrapping-text-around-shape-with-coretext-540)是一个使用 CoreText 解决部分相似问题的示例。也许这会为你指明那个方向。

```
- (CFArrayRef)copyRectangularPathsForPath:(CGPathRef)path 
                                   height:(CGFloat)height {
    CFMutableArrayRef paths = CFArrayCreateMutable(NULL, 0, 
                                                   &kCFTypeArrayCallBacks);

    // First, check if we're a rectangle. If so, we can skip the hard parts.
    CGRect rect;
    if (CGPathIsRect(path, &rect)) {
        CFArrayAppendValue(paths, path);
    }
    else {
        // Build up the boxes one line at a time. If two boxes have the 
        // same width and offset, then merge them.
        CGRect boundingBox = CGPathGetPathBoundingBox(path);
        CGRect frameRect = CGRectZero;
        for (CGFloat y = CGRectGetMaxY(boundingBox) - height; 
                     y > height; y -= height) {
            CGRect lineRect =
                   CGRectMake(CGRectGetMinX(boundingBox), y, 
                              CGRectGetWidth(boundingBox), height);
            CGContextAddRect(UIGraphicsGetCurrentContext(), lineRect);

            // Do the math with full precision so we don't drift, 
            // but do final render on pixel boundaries.
            lineRect = CGRectIntegral(clipRectToPath(lineRect, path));
            CGContextAddRect(UIGraphicsGetCurrentContext(), lineRect);

            if (! CGRectIsEmpty(lineRect)) {
                if (CGRectIsEmpty(frameRect)) {
                    frameRect = lineRect;
                }
                else if (frameRect.origin.x == lineRect.origin.x && 
                         frameRect.size.width == lineRect.size.width) {
                    frameRect = CGRectMake(lineRect.origin.x,                                                                                                                                      lineRect.origin.y,                                                                                                                                      lineRect.size.width, 
                                CGRectGetMaxY(frameRect) - CGRectGetMinY(lineRect));
                }
                else {
                    CGMutablePathRef framePath =
                                         CGPathCreateMutable();
                    CGPathAddRect(framePath, NULL, frameRect);
                    CFArrayAppendValue(paths, framePath);

                    CFRelease(framePath);
                    frameRect = lineRect;
                }
            }
        }

        if (! CGRectIsEmpty(frameRect)) {
            CGMutablePathRef framePath = CGPathCreateMutable();
            CGPathAddRect(framePath, NULL, frameRect);
            CFArrayAppendValue(paths, framePath);
            CFRelease(framePath);
        }           
    }

    return paths;
} 
```

# javascript - jquery显示/隐藏被忽略

> ID：14386332
> 
> 赞同：0
> 
> 时间：2013-01-17T19:09:52.383
> 
> 标签：javascript, jquery

我有一个页面，用户可以在其中“喜欢”一篇文章。

当页面首次加载时，我想显示他们是否已经喜欢过一篇文章。

我用来将 html 添加到 DOM 的代码是：

```
html += '<div class="gl_like">';
html += '<a href="#" class="like" id="'+image.article_id+'"><div class="bLike" title="Like this article"></div></a>';
html += '<a href="#" class="unlike" id="'+image.article_id+'"><div class="bUnlike" title="Unlike this article"></div></a>';
html += '</div>'; 
```

现在我正在检查 API 所返回的内容，以了解用户是否已经喜欢过一篇文章

```
if(image.numLikes<1){
$('.like').show();
$('.unlike').hide();
html += 'wooo'; // to test the code works, it does
} else {
$('.like').hide();
$('.unlike').show();
} 
```

“wooo”被添加到 html，但显示/隐藏功能被忽略。“.like”类显示在每篇文章中。

我想要发生的是“.like”类显示如果用户不喜欢一篇文章，“.unlike”类显示如果他们有。

我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T19:31:48.453

您是否将 html 添加到 DOM 的任何地方？

如果没有，试试这个：

```
$(html).find('.like').show();
$(html).find('.unlike').hide(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T19:11:00.390

您正在创建具有重复 id 属性的元素： id="'+image.article_id+'" 您需要更改它，以便它们是唯一的，这是必需的。前任：

```
html += '<div class="gl_like">';
html += '<a href="#" class="like" id="like_'+image.article_id+'"><div class="bLike" title="Like this article"></div></a>';
html += '<a href="#" class="unlike" id="unlike_'+image.article_id+'"><div class="bUnlike" title="Unlike this article"></div></a>';
html += '</div>'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-17T19:36:47.163

明白了，谢谢各位：

```
if(image.numLikes<1){
    html += '<a href="#" class="like" id="'+image.article_id+'"><div class="bLike" title="Like this article"></div></a>';
    html += '<a href="#" class="unlike" id="'+image.article_id+'" style="display:none;"><div class="bUnlike" title="Unlike this article"></div></a>';
    } else {
    html += '<a href="#" class="like" id="'+image.article_id+'" style="display:none;"><div class="bLike" title="Like this article"></div></a>';
    html += '<a href="#" class="unlike" id="'+image.article_id+'"><div class="bUnlike" title="Unlike this article"></div></a>';
    } 
```

而不是使用显示/隐藏它更容易从字面上显示或隐藏。

不确定我是否也很好地解释了这个问题，对此表示歉意，但感谢大家的回答。

# machine-learning - 确定满意度的调查：如何找到重要的问题？

> ID：14386335
> 
> 赞同：2
> 
> 时间：2013-01-17T19:10:09.260
> 
> 标签：machine-learning, data-mining

如果进行一项调查以确定总体客户满意度，并且有 20 个一般性问题和一个最终摘要问题：“1-10 您的总体满意度是多少”，如何确定哪些问题与摘要问题的答案最相关？

简而言之，哪些问题真正重要，哪些只是在调查中浪费空间……

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T20:13:27.923

有关某些特征的相关性的信息由与这些特征相关的线性分类和回归权重给出。

对于您的特定应用，您可以尝试训练 L1 或 L0 正则化回归器（[http://en.wikipedia.org/wiki/Least-angle_regression、http://en.wikipedia.org/wiki/Matching_pursuit](http://en.wikipedia.org/wiki/Matching_pursuit)）。这些正则化器将许多回归权重强制为零，这意味着可以有效地忽略与这些权重相关的特征。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T19:43:31.550

有许多不同的方法可以回答这个问题，而且复杂程度也各不相同。我将从计算所有成对答案组合的相关矩阵开始，从而指示哪些单个问题与总体满意度得分最相关（或最负相关）。[这在带有分析工具库](http://technet.microsoft.com/en-us/magazine/ff969363.aspx)的 Excel 中非常简单。

接下来，我将研究集群技术，从简单开始，然后仅在必要时逐步提高。对调查数据所应用的领域一无所知，很难说哪种算法最有效，但对于初学者来说，如果你的集群可能都具有相似的大小，我会看看 k-means 和变体。但是，如果绝大多数响应非常相似，我会研究基于期望最大化的算法。用于探索数据和测试各种算法功效的优秀开源工具包称为[Weka](http://www.cs.waikato.ac.nz/ml/weka/)。

# php - 使用 Codeigniter 的邮件库检测电子邮件传递错误

> ID：14386337
> 
> 赞同：0
> 
> 时间：2013-01-17T19:10:12.400
> 
> 标签：php, codeigniter

`$this->email->send()`有条件地使用和是否可以捕获交付错误`$this->email->print_debugger()`？像这样...

```
if (!$this->email->send()){
  // Error
  $this->email->print_debugger()
}else{
  // Success
} 
```

在我的情况下，如果收件人是一个虚假的电子邮件地址，该`send()`函数总是返回 true。邮件协议设置为标准php邮件功能，我需要将配置协议设置为smtp吗？

还是我在问一些必须通过单独的过程完成的事情（例如管道反弹消息到服务器目录并稍后解析）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T19:36:15.407

CI 电子邮件库不知道收件人是否合法。任何其他图书馆也不会。

您只能有限确定地知道邮件何时尝试发送。

您的系统邮件日志可以告诉一些人，退回可能会告诉其他一些人，但即使邮件已发送并且没有被退回，您也永远无法确定。您可能会发送到垃圾邮件陷阱、包罗万象或第三者。

如果您进行定期发送，您应该强制收件人验证他们的邮件地址。

# ios - 在 IB 中创建按钮后 UIButton setImage 不起作用

> ID：14386338
> 
> 赞同：1
> 
> 时间：2013-01-17T19:10:13.287
> 
> 标签：ios, uibutton

我有一个 IBOutlet UIButton 添加到 IB 的滚动视图中。我将其类型设置为自定义，然后在 viewDidLoad 我有：

```
[self.featuredButton setImage:[UIImage imageNamed:@"featuredNormal.png"] forState:UIControlStateNormal];
[self.featuredButton setImage:[UIImage imageNamed:@"featuredSelected.png"] forState:UIControlStateSelected]; 
```

图像没有出现...为什么不呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T19:44:20.727

利用

```
[self.featuredButton setBackgroundImage:[UIImage imageNamed:@"featuredNormal.png"] forState:UIControlStateNormal];

[self.featuredButton setBackgroundImage:[UIImage imageNamed:@"featuredSelected.png"] forState:UIControlStateSelected]; 
```

# ios - 在后续尝试中无法按属性从 nsset 中获取实体

> ID：14386340
> 
> 赞同：0
> 
> 时间：2013-01-17T19:10:20.437
> 
> 标签：ios, objective-c, core-data, entity, fetch

2 个实体： **用户**和**建筑物**。

**用户**有一个名为**building的****NSSet类型的属性**

 **我想通过属性**guid从****NSSet检索****Buildings**实体。

 ****在应用程序第一次运行时，添加数据成功。可以正确检索和显示数据。应用程序关闭后，随后通过 guid 获取现有建筑物实体的尝试失败。第一次`getBuildingsByGuid`返回`nil`，因为没有实体；当我调用函数**getBuildingsByGuid**并且建筑物集中有实体时，应用程序崩溃。使用谓词作品获取；实体之间的关系是：一个用户对许多建筑物。

无法通过调试捕获指令。

在**User**对象中，以下自定义方法应获取**Buildings**：

```
- (Buildings *)getBuildingsByGuid:(NSString *)guid
{
    for (Buildings *buildings in self.buildings)
    {
        if ([buildings.guid isEqualToString:guid])
            return buildings;
    }
    return nil;
} 
```

编辑：我的实体用户标头包含：

```
#import <Foundation/Foundation.h>
#import <CoreData/CoreData.h>

@class Buildings, TableBuildings;

@interface User : NSManagedObject

@property (nonatomic, retain) NSString * email;
@property (nonatomic, retain) NSString * first_name;
@property (nonatomic, retain) NSString * guid_contact;
@property (nonatomic, retain) NSString * guid_user;
@property (nonatomic, retain) NSString * guid_userRole;
@property (nonatomic, retain) NSString * last_name;
@property (nonatomic, retain) NSString * password;
@property (nonatomic, retain) NSString * role_code;
@property (nonatomic, retain) NSString * role_name;
@property (nonatomic, retain) NSString * token;
@property (nonatomic, retain) NSString * type_code;
@property (nonatomic, retain) NSString * type_name;
@property (nonatomic, retain) NSSet *buildings;
@property (nonatomic, retain) NSSet *tableBuildings;

@end

@interface User (CoreDataGeneratedAccessors)

// Buildings
- (void)addBuildingsObject:(Buildings *)value;
- (void)removeBuildingsObject:(Buildings *)value;
- (void)addBuildings:(NSSet *)values;
- (void)removeBuildings:(NSSet *)values;
- (BOOL)containsBuildingsObject:(Buildings*)value;
- (Buildings *)getBuildingsByGuid:(NSString *)guid;

// TableBuildings
- (void)addTableBuildingsObject:(TableBuildings *)value;
- (void)removeTableBuildingsObject:(TableBuildings *)value;
- (void)addTableBuildings:(NSSet *)values;
- (void)removeTableBuildings:(NSSet *)values;
- (BOOL)containsTableBuildingsObject:(TableBuildings*)value;
- (TableBuildings *)getTableBuildingsByGuid:(NSString *)guid;

@end 
```

实现文件：

```
#import "User.h"
#import "Buildings.h"
#import "TableBuildings.h"

@implementation User

@dynamic email;
@dynamic first_name;
@dynamic guid_contact;
@dynamic guid_user;
@dynamic guid_userRole;
@dynamic last_name;
@dynamic password;
@dynamic role_code;
@dynamic role_name;
@dynamic token;
@dynamic type_code;
@dynamic type_name;
@dynamic buildings;
@dynamic tableBuildings;

@end

@implementation User (CoreDataGeneratedAccessors)

#pragma mark - Buildings management methods

- (void)addBuildingsObject:(Buildings *)value
{
    NSSet *changedObjects = [[NSSet alloc] initWithObjects:&value count:1];
    [self willChangeValueForKey:@"buildings" withSetMutation:NSKeyValueUnionSetMutation usingObjects:changedObjects];
    [[self primitiveValueForKey:@"buildings"] addObject:value];
    [self didChangeValueForKey:@"buildings" withSetMutation:NSKeyValueUnionSetMutation usingObjects:changedObjects];
    [changedObjects release];
}

- (void)removeBuildingsObject:(Buildings *)value
{
    NSSet *changedObjects = [[NSSet alloc] initWithObjects:&value count:1];
    [self willChangeValueForKey:@"buildings" withSetMutation:NSKeyValueMinusSetMutation usingObjects:changedObjects];
    [[self primitiveValueForKey:@"buildings"] removeObject:value];
    [self didChangeValueForKey:@"buildings" withSetMutation:NSKeyValueMinusSetMutation usingObjects:changedObjects];
    [changedObjects release];
}

- (void)addBuildings:(NSSet *)values
{
    [self willChangeValueForKey:@"buildings" withSetMutation:NSKeyValueUnionSetMutation usingObjects:values];
    [[self primitiveValueForKey:@"buildings"] unionSet:values];
    [self didChangeValueForKey:@"buildings" withSetMutation:NSKeyValueUnionSetMutation usingObjects:values];
}

- (void)removeBuildings:(NSSet *)values
{
    [self willChangeValueForKey:@"buildings" withSetMutation:NSKeyValueUnionSetMutation usingObjects:values];
    [[self primitiveValueForKey:@"buildings"] unionSet:values];
    [self didChangeValueForKey:@"buildings" withSetMutation:NSKeyValueUnionSetMutation usingObjects:values];
}

- (BOOL) containsBuildingsObject:(Buildings*)value
{
    for (Buildings *buildings in self.buildings)
    {
        if( [buildings.guid isEqualToString:value.guid])
            return YES;
    }
    return NO;
}

- (Buildings *)getBuildingsByGuid:(NSString *)guid
{
    for (Buildings *buildings in self.buildings)
    {
        if ([buildings.guid isEqualToString:guid])
            return buildings;
    }
    return nil;
}

#pragma mark - TableBuildings management methods

- (void)addTableBuildingsObject:(TableBuildings *)value
{
    NSSet *changedObjects = [[NSSet alloc] initWithObjects:&value count:1];
    [self willChangeValueForKey:@"tableBuildings" withSetMutation:NSKeyValueUnionSetMutation usingObjects:changedObjects];
    [[self primitiveValueForKey:@"tableBuildings"] addObject:value];
    [self didChangeValueForKey:@"tableBuildings" withSetMutation:NSKeyValueUnionSetMutation usingObjects:changedObjects];
    [changedObjects release];
}

- (void)removeTableBuildingsObject:(TableBuildings *)value
{
    NSSet *changedObjects = [[NSSet alloc] initWithObjects:&value count:1];
    [self willChangeValueForKey:@"tableBuildings" withSetMutation:NSKeyValueMinusSetMutation usingObjects:changedObjects];
    [[self primitiveValueForKey:@"tableBuildings"] removeObject:value];
    [self didChangeValueForKey:@"tableBuildings" withSetMutation:NSKeyValueMinusSetMutation usingObjects:changedObjects];
    [changedObjects release];
}

- (void)addTableBuildings:(NSSet *)values
{
    [self willChangeValueForKey:@"tableBuildings" withSetMutation:NSKeyValueUnionSetMutation usingObjects:values];
    [[self primitiveValueForKey:@"tableBuildings"] unionSet:values];
    [self didChangeValueForKey:@"tableBuildings" withSetMutation:NSKeyValueUnionSetMutation usingObjects:values];
}

- (void)removeTableBuildings:(NSSet *)values
{
    [self willChangeValueForKey:@"tableBuildings" withSetMutation:NSKeyValueUnionSetMutation usingObjects:values];
    [[self primitiveValueForKey:@"tableBuildings"] unionSet:values];
    [self didChangeValueForKey:@"tableBuildings" withSetMutation:NSKeyValueUnionSetMutation usingObjects:values];
}

-(BOOL) containsTableBuildingsObject:(TableBuildings*)value
{
    for (TableBuildings *tableBuildings in self.tableBuildings)
    {
        if( [tableBuildings.guid_building isEqualToString:value.guid_building])
            return YES;
    }
    return NO;
}

- (TableBuildings *)getTableBuildingsByGuid:(NSString *)guid
{
    for (TableBuildings *tableBuildings in self.tableBuildings)
    {
        if ([tableBuildings.guid_building isEqualToString:guid])
            return tableBuildings;
    }
    return nil;
} 
```

@结尾

当应用程序启动时，将通过电子邮件和密码获取用户：

```
user = [[DataController instance] fetchEntityOfType:object_User withPredicate:@"email = %@ AND password = %@", username, passwordMD5]; 
```

稍后，当我想显示我的建筑物列表时，我调用 getBuildingsByGuid 方法，如下所示：

```
// buildings is parsed from json and have NSDictionary type
for (NSDictionary *building in buildings)
    {
        NSString *guid_building = [building safeObjectForKey:@"guid"];

        // get building and check if is associated to the current user
        BuildingPerUser *buildingPerUser = [[DataController instance] fetchEntityOfType:object_BuildingPerUser withPredicate:@"guid_user = %@ AND guid_building = %@", guid_user, guid_building];

        //create new association if not exists
        if (!buildingPerUser)
        {
            buildingPerUser = [[[DataController instance] newEnityOfType:object_BuildingPerUser] autorelease];
            buildingPerUser.guid_user = guid_user;
            buildingPerUser.guid_building = guid_building;
        }

        Buildings *buildingRow = [user getBuildingsByGuid:guid_building];

        // create new building if not exists
        if (!buildingRow)
        {
            buildingRow = [[[DataController instance] newEnityOfType:object_Buildings] autorelease];
            buildingRow.guid = guid_building;
            [user addBuildingsObject:buildingRow];
        }

        // update building
        buildingRow.name = [building safeObjectForKey:@"name"];
        buildingRow.isNew = [NSNumber numberWithBool:NO];

        [delComplementBuildings addObject:guid_building];
    } 
```

如果我使用：

```
Buildings *buildingRow = [[DataController instance] fetchEntityOfType:object_Buildings withPredicate:@"guid = %@", guid_building]; 
```

...我的应用程序工作。和：

```
Buildings *buildingRow = [user getBuildingsByGuid:guid_building]; 
```

..应用程序崩溃。

我更喜欢使用对象而不是谓词获取......

另一个编辑：我发现了异常：关于建筑物的 nsset 实体的*关系错误* 下面是**建筑物的列表：**

```
#import <Foundation/Foundation.h>
#import <CoreData/CoreData.h>

@class TableBuildings, User;

@interface Buildings : NSManagedObject

@property (nonatomic, retain) NSString * guid;
@property (nonatomic, retain) NSNumber * isNew;
@property (nonatomic, retain) NSString * name;
@property (nonatomic, retain) NSSet *tableBuildings;
@property (nonatomic, retain) User *user;
@end

@interface Buildings (CoreDataGeneratedAccessors)

- (void)addTableBuildingsObject:(TableBuildings *)value;
- (void)removeTableBuildingsObject:(TableBuildings *)value;
- (void)addTableBuildings:(NSSet *)values;
- (void)removeTableBuildings:(NSSet *)values;
@end

#import "Buildings.h"
#import "TableBuildings.h"
#import "User.h"

@implementation Buildings

@dynamic guid;
@dynamic isNew;
@dynamic name;
@dynamic tableBuildings;
@dynamic user;

@end 
```

建筑物访问器尚未实施。

**问题已解决。初始化用户时出错。解决方案：为用户使用属性。********

# php - 使用高级自定义字段和联系表单 7 显示表单

> ID：14386341
> 
> 赞同：4
> 
> 时间：2013-01-17T19:10:21.150
> 
> 标签：php, wordpress, contact-form

我希望我的用户能够将[Contact Form 7](http://contactform7.com/)短代码放入 Wordpress 编辑器的自定义字段中。我已经使用[ACF](http://www.advancedcustomfields.com/)创建了自定义字段，并且可以将值拉到页面上，但是当我尝试将其包含在简码中时，它会返回 404。

这段代码：

```
<?php echo do_shortcode(get_field('contact_form_shortcode')); ?> 
```

回报：

```
[contact-form-7 404 "Not Found"] 
```

如果我用这样的值创建一个变量：

```
<?php
 $formCode = get_field('contact_form_shortcode');
 echo $formCode;
?> 
```

回声返回：

```
[contact-form-7 id="473" title="Learn More Form"] 
```

但是在将该值放入 echo do_shortcode 函数列表后，我得到了相同的 404：

```
<?php echo do_shortcode($formCode); ?> 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2018-04-15T07:51:22.740

> 使用 ACF pro 插件而不需要其他额外的插件来做到这一点。

1.  创建关系字段（示例`contact_form`：）
2.  将以下代码添加到您的页面循环中：

    ```
    <?php $posts = get_field('contact_form');
       if( $posts ): 
         foreach( $posts as $p ): // variable must NOT be called $post (IMPORTANT) 
           $cf7_id= $p->ID;
           echo do_shortcode( '[contact-form-7 id="'.$cf7_id.'" ]' ); 
         endforeach;
       endif; ?> 
    ```

[![创建 ACF 关系字段](../Images/c76eda132b0a8db760a21afa1b3014d1.png)](https://i.stack.imgur.com/skq0h.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-17T20:10:35.207

通过使用我在上面的评论中讨论的技术，我能够解决这个问题。通过使用设置为“运行过滤器“the_content”的 WYSWIG 字段，我能够以我想要的方式提取字段值。唯一的缺点是用户可以在其中输入除表单短代码之外的其他内容。

这是我的最终代码：

```
<?php
    if (get_field('contact_form_shortcode')):
        echo get_field('contact_form_shortcode');
    else:
        echo do_shortcode('[contact-form-7 id="473" title="Learn More Form"]');
    endif; 
 ?> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-07-21T15:14:06.040

除了使用 WYSIWYG 字段，您只需在字段的格式设置下将文本字段设置为“将 HTML 转换为标签”。这将停止来自 CF7 的 404 错误并正确处理表单。WYSIWYG 字段往往难以控制不良用户输入。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-05-13T01:47:21.680

这是我的解决方案：

创建一个“帖子对象”类型的字段，该字段将返回帖子 ID。此字段的按帖子类型过滤器应设置为“联系表格”，按分类过滤器留空。

然后在页面模板中：（php）

```
<?php $contact_form = get_field('contact_form'); ?> 
```

HTML：

```
<div class="col-12 col-md-8 offset-md-2">
  <?php echo do_shortcode('[contact-form-7 id="'. $contact_form .'"]'); ?>
</div> 
```

[acf 字段截图](https://i.stack.imgur.com/uRIwq.png)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-26T04:48:20.010

另一个解决方案：

1) 安装[https://github.com/taylormsj/acf-cf7](https://github.com/taylormsj/acf-cf7)

## 安装

```
> 1 Copy the acf-cf7 folder into your wp-content/plugins folder
> 2 Activate the Contact Form 7 plugin via the plugins admin page
> 3 Create a new field via ACF and select the Contact Form 7 type
> 4 Please refer to the description for more info regarding the field type settings 
```

2）将以下代码插入模板：

```
 <?php if( get_field('field_acf') ):
                 the_field('field_acf');
            endif; ?> 
```

这适用于在模态或弹出窗口中创建联系表单 7，同一页面上的多个表单。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-09-27T07:03:36.070

要按照您的要求将 CF7 简码（或任何其他生成的简码）粘贴到 ACF 字段中，只需使用 @armadadrive 解决方案，这正是问题所在并且有效。

1.  创建具有某个名称的 ACF`text`字段，例如`hero_form`
2.  把你粘贴`shortcode`进去
3.  像这样显示内容`<?php echo do_shortcode(get_field('hero_form')); ?>`

谢谢@armadadrive

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-07-15T14:43:07.190

在这里您可以尝试请检查以下短代码的代码：

```
<?php echo do_shortcode(get_field('YourACFfieldNameHere')); ?> 
```

我在我的网站上尝试过，它可以工作。

# drupal - 如何显示当前任期的节点数？

> ID：14386344
> 
> 赞同：0
> 
> 时间：2013-01-17T19:10:36.037
> 
> 标签：drupal, drupal-7, drupal-views

我尝试从我的词汇表中通过视图来显示我的分类术语

现在是这样的

*   术语 1 名称
*   术语 1 图像

我需要使用该术语添加所有节点的计数，它看起来像 ->

*   术语 1 名称
*   术语 1 图像
*   ***具有 * term1* *的所有节点的计数**

到目前为止，我的想法是在使用预处理功能后在附加字段中显示**术语 ID**，并运行 SQL 查询以计算具有该术语的所有节点，

但我认为必须有一个简单的方法，寻找想法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T12:58:22.933

1.  创建分类视图。
2.  将关系添加到节点（如果您想计算节点数）。
3.  启用分组（分组依据）（或 D7 中的“使用聚合”切换，然后为每个字段设置“聚合设置”）
4.  在样式设置/格式中，将分组字段设置为“术语 ID”或“节点 ID”（取决于您的查询）
5.  添加新字段“节点：NID”并将组类型设置为：计数

那应该给你计数

参考：[http ://drupal.org/node/603868#comment-4421144](http://drupal.org/node/603868#comment-4421144)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-03-29T10:27:57.253

这是一个可用于相同的简单方法：

```
$tid = 'Enter tid number say 5';
$nids = taxonomy_select_nodes($tid, FALSE);
// count node here
$count = count($nids);
// you can load node content here
$nodes = node_load_multiple($nids); 
```

# android - 安卓手机号码验证

> ID：14386346
> 
> 赞同：6
> 
> 时间：2013-01-17T19:10:47.533
> 
> 标签：android, sms, whatsapp, phone-number, verification

我需要一种方法来验证我的 Android 应用程序中设置的手机号码是否正确，如“所有权” - 而不是手机号码的数据验证。

例如，WhatsApp 的做法......

我知道这可以通过使用代码和其他东西的短信验证来完成。问题是它是一个免费的 Android 应用程序，当应用程序免费时，我不热衷于为每条发送的短信付费。糟糕的商业模式...

有没有办法安全免费地做到这一点？

使用 API 代码似乎不太安全，所以我担心这不是一个选择：

```
TelephonyManager tMgr  (TelephonyManager)mAppContext.getSystemService(Context.TELEPHONY_SERVICE);
mPhoneNumber = tMgr.getLine1Number(); 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-17T19:38:41.117

WhatsApp不会向您发送任何短信，它会使用您自己的手机向您自己的号码发送短信。如果您收到短信一切正常，如果您没有收到短信，则说明您不拥有该号码。这是检查用户是否使用真实号码注册的唯一便宜且简单的方法。

# python - 如何使用 Appengine SDK 将 Django 内置过滤器与 Jinja2 结合使用？

> ID：14386349
> 
> 赞同：1
> 
> 时间：2013-01-17T19:11:00.040
> 
> 标签：python, django, google-app-engine, jinja2

前段时间我尝试了几种不同的方法，每种方法都给出了不同的异常，所以我放弃了，决定在需要时手动编写过滤器。但我缺少原生的 escapejs 和其他有用但简单的过滤器。

有几个相关的问题和答案，但据我所知，它们都没有提供无缝的方式来实现这一点。我想主要的问题是 django 过滤器例程与 django 环境绑定太多。

请仅在您设法在 Appengine SDK 环境中使用内置 django 过滤器时回答，根据我的经验，与普通环境相比，它更难，因为 Appengine 环境是有限的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T21:15:11.070

我在评论中提到了这一点，但我会在这里更具体，因为我有更多空间。Django 是一个端到端的 Web 应用程序框架，它恰好包含自己的模板语言，由于没有更好的术语，它被称为“Django 模板语言”。文档中的所有模板标签和过滤器都特定于该语言。

如果您选择使用 Jinja2，则选择使用*该*模板语言的结构来排除 Django 的结构。（显然模型和视图是一个单独的层，但原则上，它们也可以交换——它们都是松散耦合的。）所以在这种情况下，用于模板的 Django 文档对你没有好处。`format`根据[Jinja docs](http://jinja.pocoo.org/docs/templates/#filters)，如果您想在 Jinja2 中格式化浮点数，看起来您需要使用过滤器。

如果没有更多信息，我真的不能说是什么导致了您的 ImportError，但`floatformat`不会在 Jinja2 模板中工作，所以也许这与它有关。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-22T23:17:00.490

Django 模板引擎中的模板标签是接受值和参数的简单函数。它们都可以在源代码中直接访问。

这是 IPython 的输出：

```
In [173]: from django.template.defaultfilters import  date 

In [174]: date??
Type:       function
String Form:<function date at 0xa2935f0>
File:       /usr/local/python/thor/lib/python2.7/site-packages/django/template/defaultfilters.py
Definition: date(value, arg=None)
Source:
@register.filter(expects_localtime=True, is_safe=False)
def date(value, arg=None):
    """Formats a date according to the given format."""
    if not value:
        return u''
    if arg is None:
        arg = settings.DATE_FORMAT
    try:
        return formats.date_format(value, arg)
    except AttributeError:
        try:
            return format(value, arg)
        except AttributeError:
            return '' 
```

大多数特定于 Django 的魔法都存在于装饰器 ( ) 中，并且存在于您在模板中`register.filter`键入时语言解析调用的方式中。`{% load <template library> %}`查找`<module>.templatetags`模块中的定义。内置插件位于`django.template.defaulttags`和中`django.template.defaultfilters`。

如果 Jinja2 有办法定义新的模板过滤器（它可能会这样做），那么您可以简单地将手工模板过滤器包装到实际的 Django 函数中。

所以基本上，只需创建指向实际 Django 函数定义的 Jinja2 过滤器。

编辑：如果您无法访问实际的 Django 函数，只需复制粘贴源代码并删除或调整特定于 Django 的内容。

`escapejs`过滤器实际上是对这个函数的调用`django.utils.html`：

```
_base_js_escapes = (
    ('\\', r'\u005C'),
    ('\'', r'\u0027'),
    ('"', r'\u0022'),
    ('>', r'\u003E'),
    ('<', r'\u003C'),
    ('&', r'\u0026'),
    ('=', r'\u003D'),
    ('-', r'\u002D'),
    (';', r'\u003B'),
    (u'\u2028', r'\u2028'),
    (u'\u2029', r'\u2029')
)

# Escape every ASCII character with a value less than 32.
_js_escapes = (_base_js_escapes +
               tuple([('%c' % z, '\\u%04X' % z) for z in range(32)]))

def escapejs(value):
    """Hex encodes characters for use in JavaScript strings."""
    for bad, good in _js_escapes:
        value = mark_safe(force_unicode(value).replace(bad, good))
    return value 
```

# java - GWT 应用程序中的 XMPP 聊天

> ID：14386362
> 
> 赞同：2
> 
> 时间：2013-01-17T19:11:35.797
> 
> 标签：java, gwt, xmpp, atmosphere

我正在寻找这种东西。我的应用程序使用 Google OAuth 登录。现在，我想在我的应用程序中集成 XMPP 聊天。当我通过此聊天登录到我的应用程序时，我将能够通过我的应用程序中的聊天与 GTalk 等人聊天。也就是说，我将能够与应用程序中的用户聊天，而且我可以使用 XMPP 聊天（如 GTalk）邀请应用程序外的用户。

一次使用群聊，我应该能够与我的应用程序中的用户以及外部用户聊天。

任何关于“使用什么”和“如何”可以完成的建议/想法，将不胜感激

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T18:42:50.867

你应该看看这个项目：[https ://github.com/EmiteGWT/emite](https://github.com/EmiteGWT/emite)

困难的部分（协议 - XMPP）已经存在。您所需要的只是在您的项目中为它构建一个 UI 并处理授权内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-24T11:27:19.307

经过一些搜索和尝试 - 谷歌似乎没有自己的 bosh 端点来代理对谷歌 xmpp 服务器的请求。所以，不知何故 ProxyServlet 不适合我连接到谷歌服务器。

但现在我可以使用 JabberHTTPBind 连接到谷歌服务器。我使用了 emite-0.4.7-proxies.jar，它捆绑了 JabberHTTPBind servlet。在 web.xml 中，添加了以下 servlet 映射

```
<servlet>
    <servlet-name>Jabber HTTP Binding Servlet</servlet-name>
    <servlet-class>org.jabber.JabberHTTPBind.JHBServlet</servlet-class>
</servlet>
<servlet-mapping>
    <servlet-name>Jabber HTTP Binding Servlet</servlet-name>
    <url-pattern>/http-bind/*</url-pattern>
</servlet-mapping> 
```

这对我有用。现在我可以使用 Emite 连接到谷歌服务器了。

# xtk - XTK 中的光源变化

> ID：14386365
> 
> 赞同：1
> 
> 时间：2013-01-17T19:11:48.793
> 
> 标签：xtk

我可以更改场景光源（位置或亮度）吗？我的 XTK 场景太暗：
[https](https://dl.dropbox.com/u/84856120/xtkskull.png)
: //dl.dropbox.com/u/84856120/xtkskull.png 我想要 Paraview 的
[https://dl.dropbox.com/u/84856120/paraviewskull.png](https://dl.dropbox.com/u/84856120/paraviewskull.png)
**我使用 . stl 文件和“ffffff”颜色**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T10:06:37.383

我有一个类似的问题，并没有真正解决它，但找到了解决方法。我有这种渲染： [https ://dl.dropbox.com/u/13268696/Ugly.png](https://dl.dropbox.com/u/13268696/Ugly.png)

你可以看到一些 STL 文件是好的，但一个是丑陋的。看起来没有阴影，只有一大块。这个 STL 是使用搅拌机生成的，法线在搅拌机中似乎没问题，面向外部。这种现象不是恒定的，我的意思是有时来自搅拌机的 STL 是可以的。例如，蓝色是由搅拌机专门生成的。因此，我使用 paraview 打开它，并“另存为”并生成了一个新的 STL 文件。现在，结果如下：

[https://dl.dropbox.com/u/13268696/OK.png](https://dl.dropbox.com/u/13268696/OK.png)

我真的不知道在blender导出和paraview导出期间发生了什么，但它与STL生成有关，而不是xtk显示。也许来自 xtk 的 STL 导入模块？解释不正确？

希望这可以帮助。

劳伦特。

# java - 从 Java 调用 Mono 程序集

> ID：14386369
> 
> 赞同：3
> 
> 时间：2013-01-17T19:12:00.567
> 
> 标签：java, linux, mono, interop

我有一个用 C# 编写的大型文本校对框架，我想编写一个使用这组库的 OpenOffice 扩展。我这样做的首选语言是 Java。**因此，我需要一种从 Java（在 Windows 和Linux**中）访问 .NET 程序集的方法。有没有办法从 Java 调用 Mono 程序集？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T19:18:08.093

IKVM 应该允许你做你想做的，但我必须承认我没有做过这个 myslef。

这是他们项目的链接：[http ://www.ikvm.net/](http://www.ikvm.net/)

以及一个调用 .NET API 的简单 Java 程序

```
import cli.System.IO.*;

public class ShowDir{

   public static void main(String[] args){
       String[] files = Directory.GetFiles("."); //.NET System.IO
       for(String file : files){
           System.out.println(file);
       }
   }
} 
```

[更多有用的信息](http://sourceforge.net/apps/mediawiki/ikvm/index.php?title=Tutorial)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-21T07:44:29.947

这看起来像一个副本：[howto call c# (mono, .net) methods, delegates from native c](https://stackoverflow.com/questions/4256139/howto-call-c-sharp-mono-net-methods-delegates-from-native-c)

您可以使用 JNI 执行一些本机 c 代码以通过该 API 进入。

# cocos2d-iphone - Cocos2d-x：从字符串启动 TMXTiledMap 时崩溃

> ID：14386370
> 
> 赞同：0
> 
> 时间：2013-01-17T19:12:04.703
> 
> 标签：cocos2d-iphone, cocos2d-x, tiled, tmx

我在从字符串输入创建 tmx 映射时遇到问题。

```
bool LevelManager::initLevel(int currentLevel)
{
    const char* 映射；
    尝试 {

        地图 = LevelManager::getLevel(currentLevel);
    } 捕捉（整数）{
        投掷1；
    }
    如果（地图！= NULL）{
        CCLog("%s", 地图);
        tileMap = CCTMXTiledMap::create(map);
        tileMap->setAnchorPoint(ccp(0,0));
        tileMap->setPosition(ccp(15,20));
        this->addChild(tileMap, 5);
        backgoundLayer = tileMap->layerNamed("Background");
    } 别的 {
        投掷1；
    }
    返回真；
}

```

那是我的代码。它非常不稳定。大多数时候它会崩溃，有时它不会。我正在从字符串地图加载我的地​​图。Wich 是一个 const *char。我的地图被命名为 Level1.tmx，当我像这样加载地图时： tileMap = CCTMXTiledMap::create("Level1.tmx"); 它总是有效，从不崩溃。而且我知道 map 的值是 Level1.tmx 因为我在加载之前将它记录在行中。

当它崩溃时，日志输出如下： (lldb) 和 tileMap->setAnchorPoint(ccp(0,0)); 它说“线程1：EXC_BAD_ACCESS（代码= 2，地址= 0x0）

有谁知道为什么会发生这种情况以及如何解决它？

非常感谢。

ps：我用的是xcode，最新的cocos2d-x版本和iPhone模拟器

**编辑：**

使用断点，我检查了加载 tilemap 时出现问题的地方。

就行 tileMap = CCTMXTiledMap::create(map); 我的变量映射仍然很好

但在线 tileMap->setAnchorPoint(ccp(0,0)); 它突然损坏（大部分时间）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T19:28:35.407

It sounds like you're returning a char* string created on the stack, which means the memory may or may not be corrupted, depending on circumstances, moon phases, and what not.

So the question is: How is getLevel defined and what does it do (post the code)?

If you do something like this:

```
const char* LevelManager::getLevel(int level)
{
    char* levelName = "default.tmx";
    return levelName;
} 
```

…then that's going to be the culprit. The levelName variable is created on the stack, no memory (on the heap) is allocated for it. The levelName variable and the memory it points to become invalid as soon as the method returns.

Hence when the method leaves this area of memory where levelName points to can be allocated by other parts of the program or other method's stack memory. Whatever is in that area of memory may still be the string, or it may be (partially) overridden by other bits and bytes.

PS: Your exception handling code is …. well it shows a lack of understanding what exception handling does, how to use it and especially when. I hope these are just remnants of trying to get to the bottom of the issue, otherwise get rid of it. I recommend reading a tutorial and introductions on C++ exception handling if you want to continue to use exceptions. Especially something like (map != NULL) should be an assertion, not an exception.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T20:54:22.467

我修好了它。

const char* 是罪魁祸首。

将我的地图作为 char * 返回时，它完美无缺。

```
    const char *levelFileName = level.attribute("file").value();
    char *levelChar = new char[strlen(levelFileName) + 1];
    std:: strcpy (levelChar, levelFileName);

`return levelChar;` 

这就是我现在返回地图的方式。

```

# java - Windows 上 JLabel 中的 UTF-8 编码

> ID：14386381
> 
> 赞同：0
> 
> 时间：2013-01-17T19:12:45.100
> 
> 标签：java, swing, encoding, jlabel

我在 Windows 上的 JLabel 中编码有问题（在 *nix 操作系统上一切正常）。这是一张图片： http: [//i.imgur.com/DEkj3.png](http://i.imgur.com/DEkj3.png)（有问题的字符是顶部带有 ` 的 L，它应该是 ł），这里的代码：

```
public void run()
    {
            URL url;
            HttpURLConnection conn;
            BufferedReader rd;
            String line;
            String result = "";
            try {
                url = new URL(URL);
                conn = (HttpURLConnection) url.openConnection();
                conn.setRequestMethod("GET");
                rd = new BufferedReader(new InputStreamReader(conn.getInputStream()));
                while ((line = rd.readLine()) != null) {
                    result += line;
                }
                rd.close();
            } catch (Exception e) {
                try
                {
                    throw e;
                }
                catch (Exception e1)
                {
                    Window.news.setText("");
                }
            }
                Window.news.setText(result);
        } 
```

我试过`Window.news.setText(new String(result.getBytes(), "UTF-8"));`了，但没有帮助。也许我需要使用指定的 JVM 标志运行我的应用程序？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T19:29:58.263

`new InputStreamReader`当您在没有显式字符集的情况下使用时，您会在数据到达窗口之前破坏数据。这将使用平台默认字符集，在 Windows 上可能是 cp1252，因此您的字符损坏。

如果您知道正在读取的数据的字符集，则应明确指定它，例如：

```
new InputStreamReader(conn.getInputStream(), "UTF-8") 
```

但是，在从任意 url 下载数据的情况下，您可能应该更喜欢“Content-Type”标头中的字符集（如果存在）。

# spring - 在 Spring MVC 中以编程方式设置资源路径

> ID：14386383
> 
> 赞同：2
> 
> 时间：2013-01-17T19:12:46.833
> 
> 标签：spring, resources

我的 MVC 应用程序需要访问 servlet 上下文之外的缩略图和视频文件。因此，我将 servlet-context.xml 设置为具有以下内容：

```
<resources mapping="/resources/**" location="/resources/,file:/home/john/temp_jpgs/" /> 
```

因此 /home/john/temp_jpgs/ 中的图像可供 /resources 下的任何 jsp 使用。

但是，这仅用于测试，我希望能够以编程方式设置此位置。我怎么做？

谢谢，约翰。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T03:37:50.460

如果`<resources ...`标签不能满足您的需求，您可以继承[ResourceHttpRequestHandler](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/web/servlet/resource/ResourceHttpRequestHandler.html)以包含您需要的任何功能。

**示例：自定义位置的子类 ResourceHttpRequestHandler**

```
package com.test;

public class MyCustomResourceHttpRequestHandler extends ResourceHttpRequestHandler {

    private String yourCustomPath;

    @Override
    protected Resource getResource(HttpServletRequest request) {
    String path = (String)  request.getAttribute(HandlerMapping.PATH_WITHIN_HANDLER_MAPPING_ATTRIBUTE);
...

       //put whatever logic you need in here
       return new FileSystemResource(yourCustomPath + path);

    }

    public void setYourCustomPath(String path){
        this.yourCustomPath = path;
    }
} 
```

现在，您可以删除`<resources ...`标签并在上下文中注册您的处理程序，如下所示。然后，进来的请求`/resources/**`将被路由到您的自定义类。您基本上可以通过设置器`location`更改`yourCustomPath`变量来控制 。

```
<bean name="resourceHandler" class="com.test.MyCustomResourceHttpRequestHandler">
    <property name="locations">
        <list>
            <!-- you'll be overriding this programmatically -->
            <value>/resources/</value>
        </list>
    </property>
</bean>

<bean class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
    <property name="urlMap">
        <map>
            <entry key="/resources/**" value-ref="resourceHandler"/>
        </map>
    </property>
</bean> 
```

您现在可以将`resourceHandler`bean 注入任何其他类，调用 setter 以`yourCustomPath`编程方式设置和更改它。

# html - CSS 样式复选框

> ID：14386384
> 
> 赞同：0
> 
> 时间：2013-01-17T19:12:49.507
> 
> 标签：html, css, radio-button, checkbox

实际上我用这个技巧来设计单选按钮：

HTML：

```
<div class="radioButt" >
  <h1>Radio:</h1>
  <p>Val1 : <span></span><input type="radio" id="1" checked="checked" name="radio" ><span></span></p>
  <p>Val2 : <span></span><input type="radio" id="2" name="radio" ><span></span></p>
  <p>Val3 : <span></span><input type="radio" id="3" name="radio" ><span></span></p>
</div> 
```

CSS：

```
.radioButt p {
    padding: 10px;
}

.radioButt span{
    position: relative;
    right: 0;
    width: 25px;
    height: 25px;
    line-height: 25px;
    padding: 3px;
    color: #FFF;
    text-align: center;
    background: #c06f59;
}

.radioButt  span:after{
    content: "no"; /*if CSS are disbled span elements are not displayed*/
}

.radioButt input{
    position: relative;
    right: 0;
    margin: -26px;
    width: 31px;
    height: 31px;
    /*hide the radio button*/
    filter:alpha(opacity=0);
    -moz-opacity:0;
    -khtml-opacity: 0;
    opacity: 0;
        cursor: pointer;
}

.radioButt  input[type="radio"] + span{ /*the span element that immediately follow the radio button */
    visibility: hidden; /*temporarily hide the "YES" label*/
    background: #6EB558;
}

.radioButt input[type="radio"] + span:after{
        width: 30px;
        display: inline-block;
    content: "yes"; /*if CSS are disbled span elements are not displayed*/
}

.radioButt input[type="radio"]:checked + span{
    visibility: visible; /*show the "YES" label only if the radio button is checked*/
} 
```

可以在以下位置找到一个工作示例：http: [//jsfiddle.net/rzt3c/2/](http://jsfiddle.net/rzt3c/2/)

我也想为复选框输入创建相同的效果。我试图在css中添加类型“复选框”，但它似乎不起作用......事实上，当复选框被选中时，id不会返回未选中状态。（这里有代码：http: [//jsfiddle.net/rkCMa/1/](http://jsfiddle.net/rkCMa/1/)）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T19:32:29.340

## 更新的答案

下面的原因仍然是正确的，但是仍然有一种更简单的方法可以通过使用`pointer-events`样式来使用 CSS（仍然存在可用性限制......）。将此添加到您的样式中：

```
.radioButt span{
  pointer-events: none;
} 
```

这将允许单击跨度，因此后跨度将不再阻止输入。这应该可以回答您的问题，但请记住原始问题的评论中提到的一些可用性问题。

* * *

它不起作用的原因是当它显示跨度超过输入的“是”时，因此实际单击的是跨度而不是输入。我会更改格式，以便两个跨度都**在**输入之前，并在它们上使用类名来区分和设置它们的样式，而不是 css 选择器。就像是：

```
<div class="radioButt" >
  <h1>Checkbox:</h1>
  <p>Ck1 : <span class="no"></span><span class="yes"></span><input type="checkbox" id="ck1" checked="checked" ></p>
  <p>Ck2 : <span class="no"></span><span class="yes"></span><input type="checkbox" id="ck2" ></p>
  <p>Ck3 : <span class="no"></span><span class="yes"></span><input type="checkbox" id="ck3" ></p>
</div> 
```

# ios - 是否可以从 iOS 中的 .CAF 文件中获取诸如 Tempo 之类的信息

> ID：14386385
> 
> 赞同：2
> 
> 时间：2013-01-17T19:12:50.900
> 
> 标签：ios, iphone, objective-c, avfoundation, avaudioplayer

我正在开发一个音频应用程序。

我有一组 Apple logic Pro 的 .caf 文件。我想提取诸如速度之类的信息，如果可能的话，还有其他音频数据。

我在音频应用方面的经验非常少，但对音频有所了解。

任何示例代码都将不胜感激。

有人请救救我！！

谢谢

# android - 前级和后级活动

> ID：14386386
> 
> 赞同：0
> 
> 时间：2013-01-17T19:12:57.337
> 
> 标签：android, android-activity

我正在寻找一种干净的方法来为中心活动实施前级和后级活动，基本上是介于两者之间的游戏级别活动的级别前和级别后活动。前级和后级活动相似，但有足够的差异，我想使用具有不同布局的两个不同活动。

这是我想象的活动顺序的简短概述（返回将按下返回按钮，动作将与活动交互以向前移动）：

*   主菜单活动
    *   返回 -> 退出
    *   行动 -> 前级活动
*   前级活动
    *   返回 -> 主菜单活动
    *   动作 -> 游戏活动
*   游戏活动
    *   返回 -> 暂停的活动
    *   行动 -> 后期活动
*   暂停的活动
    *   返回 -> 返回游戏活动
    *   行动 -> 后期活动
*   后期活动
    *   返回 -> 主菜单活动
    *   行动 -> 下一级别的预级别活动

关于如何最好地实施这种活动循环的任何建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T19:14:58.853

阅读此文档：[任务和返回堆栈](http://developer.android.com/guide/components/tasks-and-back-stack.html)

如果您想做其他操作，那么活动操作，例如暂停游戏。您可以处理 onBackPressed() 函数来做其他事情，然后完成活动

# rabbitmq - 如何检测基于警报的阻塞 RabbitMQ 生产者？

> ID：14386392
> 
> 赞同：1
> 
> 时间：2013-01-17T19:13:26.973
> 
> 标签：rabbitmq, blocking, alarm, producer-consumer

我有一个生产者向 RabbitMQ 交换发送持久消息。如果 RabbitMQ 内存或磁盘超过 watermark 阈值，RabbitMQ 将阻塞我的生产者。文档说它停止从套接字读取，并暂停心跳。

我想要的是一种在我的生产者代码中知道我被阻止的方法。目前，即使启用了心跳，一切都会永远暂停。我想收到某种异常，以便我知道我已被阻止，我可以警告用户和/或采取其他措施，但我找不到任何方法来做到这一点。我同时使用 Java 和 C# 客户端，并且两者都需要此功能。有什么建议吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T13:15:29.060

很抱歉告诉你，但是使用 RabbitMQ（至少使用 2.8.6）这是不可能的 :-(

有一个类似的问题，其中心是在连接被阻止时尝试建立一个通道。结果和你所经历的一样。

我对 RabbitMQ C# .Net 库的实际核心进行了一些调查，发现问题的根本原因是它进入了无限阻塞状态。

您可以在此处查看有关 RabbitMQ 邮件列表的更多详细信息：

[http://rabbitmq.1065348.n5.nabble.com/Net-Client-locks-trying-to-create-a-channel-on-a-blocked-connection-td21588.html](http://rabbitmq.1065348.n5.nabble.com/Net-Client-locks-trying-to-create-a-channel-on-a-blocked-connection-td21588.html)

一个建议（我们没有实施）是在线程内部完成工作，并让其他一些组件管理超时并在超过时终止线程。我们只是接受了风险:-(

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-14T08:16:05.380

Rabbitmq 使用阻塞 rpc 调用，无限期地监听回复。

如果您查看 Java 客户端 api，它的作用是：

```
 AMQChannel.BlockingRpcContinuation k = new AMQChannel.SimpleBlockingRpcContinuation();
    k.getReply(-1); 
```

现在 -1 在参数块中传递，直到收到回复。

好消息是您可以通过超时以使其返回。坏事是您将不得不更新客户端 jars。

如果您可以这样做，则可以在进行上述阻塞调用的任何地方传递超时。代码看起来像：

```
try {
                    return k.getReply(200);
                } catch (TimeoutException e) {
                    throw new MyCustomRuntimeorTimeoutException("RabbitTimeout ex",e);
                } 
```

在您的代码中，您可以处理此异常并在此事件中执行您的逻辑。

可能需要此修复的一些相关类是：

```
com.rabbitmq.client.impl.AMQChannel
com.rabbitmq.client.impl.ChannelN
com.rabbitmq.client.impl.AMQConnection 
```

仅供参考：我已经尝试过了，它有效。

# pdf - PDF 规范合规性测试示例文件

> ID：14386393
> 
> 赞同：17
> 
> 时间：2013-01-17T19:13:30.643
> 
> 标签：pdf

我有一个转换图像的应用程序，并想根据一些不同的 PDF 规范对其进行测试。有谁知道一些示例 PDF 文档的位置，这些文档实现了我可以用来测试的不同规格级别？我想转换为不同的格式（例如 tiff）并测试可查看 PDF 的准确表示。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-01-22T19:33:34.800

我找到了这些资源：

1.  [Stillhq.com PDF 数据库/Mikail 的 PDF 数据库](http://www.stillhq.com/pdfdb/db.html)大量真实世界的 PDF，其中一些已损坏。自由。
2.  [QualityLogic 的 PDF 1.7 应用程序测试套件 (ATS)](http://www.qualitylogic.com/Contents/Printer-MFP/Technology/PDF.aspx)。商业的。
3.  [Adobe PDF 测试套件](https://web.archive.org/web/20150228065245/http://acroeng.adobe.com/wp/?page_id=10)（网络存档链接，没有可用的 PDF）。
4.  [根特工作组测试套件](http://www.gwg.org/download/test-suites/ghent-output-suite/)一些易于判断的补丁，显示支持（或不支持）基本 PDF 功能。面向图形艺术并支持作为 PDF/X-1a 和 PDF/X-4 一部分的 PDF 功能。免费用于工作流/RIP/硬件验证。
5.  [恐怖的PDF柜](http://www.opf-labs.org/format-corpus/pdfCabinetOfHorrors/)。坏 pdf 文件的免费存档

还有兴趣：

1.  [Altona Test Suite](http://www.altonatestsuite.com/en/index.php)针对印刷厂的商业测试套件
2.  [Isartor 测试](//www.pdfa.org/isartor-test-suite/)套件 用于 PDF/A-1 合规性的免费测试套件
3.  [Bavaria Test suitde](http://www.pdflib.com/knowledge-base/pdfa/validation-report/)免费的 PDF/A-1 合规性测试套件

# wpf - 将 ListView 绑定到位图的 ObservableCollection

> ID：14386394
> 
> 赞同：0
> 
> 时间：2013-01-17T19:13:32.877
> 
> 标签：wpf, binding, observablecollection

我有一些绑定我`ListView`的问题`ObservableCollection<Bitmap>`...

这是我的`XAML`：

```
<ListView ScrollViewer.HorizontalScrollBarVisibility="Visible" ScrollViewer.VerticalScrollBarVisibility="Disabled"
      ItemsSource="{Binding Path=FrameImages}">
<ListView.ItemsPanel>
    <ItemsPanelTemplate>
        <WrapPanel
            Width="Auto"
            ItemWidth="{Binding (ListView.View).ItemWidth, RelativeSource={RelativeSource AncestorType=ListView}}"
            ItemHeight="{Binding (ListView.View).ItemHeight, RelativeSource={RelativeSource AncestorType=ListView}}" />
    </ItemsPanelTemplate>
</ListView.ItemsPanel>

<ListView.ItemTemplate>
    <DataTemplate>
        <Border Width="100" Height="75" BorderThickness="1" BorderBrush="DarkGray" VerticalAlignment="Center" Margin="7,5,7,5">
            <Image Margin="5,5,5,5" Width="100" Height="75" Source="{Binding}" Stretch="Fill"></Image>
        </Border>
    </DataTemplate>
</ListView.ItemTemplate>
</ListView> 
```

后面的代码：

```
public ObservableCollection<Bitmap> FrameImages { get; set; }
public MainWindow()
{
    InitializeComponent();

    this.DataContext = this;

    FrameImages = new ObservableCollection<Bitmap>();
    Bitmap img = new Bitmap(@"E:\test\3047817.bmp");
    FrameImages.Add(img);
} 
```

当我添加元素时，它似乎出现在 中`ListView`，但它是透明的（只是一个空框架）：/ 我试图将位图保存回文件并且没有问题（与原始的相同）。我不知道为什么它不起作用:(

**[编辑]**
顺便说一句。如果我`ObservableCollection<Bitmap>`用`ObservableCollection<BitmapSource>`. 但这是影响程序性能的额外转换......这就是我需要`Bitmap`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T19:56:19.823

您不能在 WPF 应用程序中以这种方式使用[System.Drawing.Bitmap 。](http://msdn.microsoft.com/en-us/library/system.drawing.bitmap.aspx)该类不属于 WPF。它封装了 GDI+ 位图，而[WPF 基于 DirectX](http://en.wikipedia.org/wiki/Windows_Presentation_Foundation)。因此，您需要使用 BitmapSource。

但是，您可以简单地将 ListView 的[ItemsSource](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol.itemssource%28v=vs.110%29.aspx)属性绑定到图像路径字符串的集合。WPF 会自动执行从字符串到 ImageSource 的必要转换。

如果您确实需要手动创建位图，您应该将您的集合定义为`ObservableCollection<ImageSource>`并通过以下方式创建集合元素：

```
var img = new BitmapImage(new Uri(@"E:\test\3047817.bmp"));
FrameImages.Add(img); 
```

* * *

您可能想看看[成像概述](http://msdn.microsoft.com/en-us/library/ms748873.aspx)。您应该熟悉 WPF 中的[BitmapSource](http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.bitmapsource.aspx)类层次结构。

# asp.net-mvc - 隐藏当前元素并显示下一个

> ID：14386395
> 
> 赞同：1
> 
> 时间：2013-01-17T19:13:36.737
> 
> 标签：asp.net-mvc, jquery, asp.net-mvc-4

我正在创建一个向您展示测验的 ASP.NET 应用程序。这个测验应该逐个问题地显示给用户。

我的意思是，出现第一个问题，当他按下下一个按钮时，隐藏当前问题元素并显示下一个问题，直到它没有要显示的元素。

到目前为止，我刚刚完成了在 MVC4 中显示所有这些。我真的没有太多使用 JQuery 的经验。

```
<div id="questions-container">
    <div class="question">
     ...
    </div>
    <div class="question">
     ...
    </div>
    <div class="question">
     ...
    </div>
    <div class="question">
     ...
    </div>  
</div> 
```

你能确定我该如何实现这个功能吗？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T19:16:33.887

默认所有问题为`display: none;`，在页面加载时显示第一个问题（或另一个`.question.first`具有 的类，`display: block;`然后下一个按钮可以显示下一个问题：

```
$("#questions-container").find(":visible").hide().next().show(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T21:15:30.230

I know you have already got an answer to this. I do something very close to this in one of my sites. This counts your divs and shows the next button until you reach the last div and then it removes the button. I rewrote it to include your code above.

```
 <!DOCTYPE html>
<html lang="en">
  <head>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js" type="text/javascript"></script>
<script type="text/javascript">
$(function()
    { 
    var Called = 1;
    var TotalDiv = $(".question").length;
    $(".question").filter(":first").css("display","block"); 
    $(".reveal").click(function()
        {
        Called++;
        $("#questions-container").find(":visible").hide().next().show();
        if(Called == TotalDiv)
            {
            $(this).hide();
            }
        });
    });
</script>
<style type="text/css">
.question{display:none;}
</style> 
  </head>
  <body>
<div id="questions-container">
    <div class="question">
     division one
    </div>
    <div class="question">
     division two
    </div>
    <div class="question">
     division three
    </div>
    <div class="question">
     division foor
    </div>  
</div>
<input type="button" class="reveal" value="NEXT" />
  </body>
</html> 
```

# java - 在单个空格处拆分字符串

> ID：14386397
> 
> 赞同：4
> 
> 时间：2013-01-17T19:13:48.933
> 
> 标签：java, regex, string, split, character

我希望在每个空格处将一个字符串拆分为一个字符串数组。

例如：

`This_sentence_gets__split.`（下划线在这里代表空格）

变成

`"This"`

`"sentence"`

`"gets"`

`" "`（注意双倍空格留一个空格）

`"split."`

我想我可以做到这一点，`String.split(String regex)`但我对正则表达式不是很好，我不知道我将如何做到这一点。

编辑：

第一个之后的任何空格也应拆分为子字符串。例如： `Split___this.`变成`"Split` `" "` `" "` `"this."`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-17T19:39:45.520

我认为这可能是您正在寻找的（您可以使用`\\s`所有空格（如制表符、新行等）的类来改进它）

```
String data = "This_sentence__gets___split".replace('_', ' ');
// System.out.println(data);
String arr[] = data.split("(?<! ) |(?<= {2})");
for (String s : arr)
    System.out.println("\"" + s + "\""); 
```

输出：

```
"This"
"sentence"
" "
"gets"
" "
" "
"split." 
```

解释：

*   `"(?<! ) "`只会在之前没有空格的空格上拆分
*   `"(?<= {2})"`将在其前有两个空格的地方拆分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T19:43:08.713

试试`StringTokenizer`。

```
 StringTokenizer st = new StringTokenizer("this is a test", " ", true);
 while (st.hasMoreTokens()) {
     System.out.println(st.nextToken());
 } 
```

**更新：**

第三个参数 ( **true** ) 将分隔符视为单独的标记，因此它们将单独返回。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-17T19:47:25.560

我对正则表达式也不是很了解，这就是我选择使用[Google Guava 的 Splitter 类的](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/base/Splitter.html)原因。

例子：

```
private static final Splitter splitter = 
      Splitter.on(',').trimResults().omitEmptyStrings();

//results in {"some", "string"}
splitter.split("some string"); 
```

您可以使用 trimResults()、omitEmptyStrings() 和其他选项来调整它。

:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-17T19:16:37.597

没那么难：

```
str.split(" "); 
```

# visual-studio-2010 - 单元测试仅在调试模式下通过，在运行模式下失败

> ID：14386419
> 
> 赞同：2
> 
> 时间：2013-01-17T19:15:44.023
> 
> 标签：visual-studio-2010, unit-testing, debugging, c#-4.0

我有以下单元测试：

```
[TestMethod]
public void NewGamesHaveDifferentSecretCodesTothePreviousGame()
{
    var theGame = new BullsAndCows();

    List<int> firstCode = new List<int>(theGame.SecretCode);
    theGame.NewGame();
    List<int> secondCode = new List<int>(theGame.SecretCode);
    theGame.NewGame();
    List<int> thirdCode = new List<int>(theGame.SecretCode);

    CollectionAssert.AreNotEqual(firstCode, secondCode);
    CollectionAssert.AreNotEqual(secondCode, thirdCode);
} 
```

当我在调试模式下运行它时，我的代码通过了测试，但是当我正常运行测试（运行模式）时它没有通过。抛出的异常是：

```
CollectionAssert.AreNotEqual failed. (Both collection contain same elements). 
```

这是我的代码：

```
// constructor
public BullsAndCows()
{
    Gueses = new List<Guess>();
    SecretCode = generateRequiredSecretCode();
    previousCodes = new Dictionary<int, List<int>>();
}

public void NewGame()
{
    var theCode = generateRequiredSecretCode();

    if (previousCodes.Count != 0)
    {
        if(!isPreviouslySeen(theCode))
        {
            SecretCode = theCode;
            previousCodes.Add(previousCodes.Last().Key + 1, SecretCode);  
        }
    }
    else
    {
        SecretCode = theCode;
        previousCodes.Add(0, theCode);
    }
 } 
```

*previousCodes*是类的一个属性，它的数据类型是*Dictionary 键整数，值 List of integers*。*SecretCode*也是类上的一个属性，它的数据类型是一个*整数列表*

如果我猜测一下，我会说原因是再次调用了 NewGame() 方法，而第一次调用还没有真正完成它需要做的事情。如您所见，在 NewGame() 方法中调用了其他方法（例如 generateRequiredSecretCode()）。

在调试模式下运行时，我按 F10 的缓慢速度为进程提供了足够的时间结束。

但我不确定如何解决这个问题，假设我对原因的识别是正确的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T19:21:25.687

`generateRequiredSecretCode`生成副本时，SecretCode 会发生什么？似乎没有处理。

一种可能性是您得到了一个副本，因此`SecretCode`保持与之前的值相同。发电机是如何工作的？

另外，你没有展示`BullsAndCows`构造函数是如何初始化的`SecretCode`？是叫NewGame吗？

我怀疑按键的速度与它有什么关系，因为您的测试方法会依次调用函数而无需等待输入。除非`generateReq...`产生一个线程，否则它将在返回之前完成它正在做的任何事情。

--更新后--

我看到 2 个错误。
1)`SecretCode`构造函数中生成的第一个不会添加到`previousCodes`. 因此，如果第二个游戏具有相同的代码，则不会进行重复检查。
2)`previousCodes`填充后，您不处理生成副本的情况。以前看到过重复项，因此您不会将其添加到`previousCodes`列表中，但您也不会更新`SecretCode`，因此它会保留旧值。

我不完全确定为什么这仅在发布模式下出现 - 但调试模式处理随机数生成器的方式可能有所不同。请参阅[如何在 WPF 中随机化](https://stackoverflow.com/q/8275649/10396)。发布模式更快，因此它使用与种子相同的时间戳，因此它实际上生成完全相同的数字序列。

If that's the case, you can fix it by making `random` a class property instead of creating a new one for each call to generator.

# python - 为什么 py2app .app 的启动时间比同一个 python 程序要长？

> ID：14386421
> 
> 赞同：4
> 
> 时间：2013-01-17T19:15:47.837
> 
> 标签：python, c, macos, setuptools, py2app

我不确定我的问题/标题措辞是否正确。我正在开发 OSX 10.6 和 python 2.7.1。我使用 setuptools 和 py2app 创建了一个 .app，我可以从 finder 或终端使用 open 运行它。

我对该计划的目标之一是快速启动。

当我进入 build 文件夹并直接使用 python 运行 python 程序时，我的窗口立即弹出。在不到 1 秒的时间内。这是相当一致的。但是当我进入 dist 文件夹并运行 .app（从 finder 或打开）时，在窗口出现之前会有几秒钟的暂停。大约 4 到 5 秒，相当一致。

我想这可能与打开试图查找文档或其他东西有关，所以我尝试了这个：

```
open -a testrun.app "" 
```

..果然，窗口立即弹出！

我需要在 setup.py 或某个地方做些什么来告诉它这不是面向文档的程序吗？

再详细一点——

我正在使用 Python 2.7.1（作为系统 python）在 OSX 10.6.8 上工作。我已经尝试了一些小的变化（2.6 with python_select，2.7.3 in a virtualenv..），但到目前为止，它没有任何区别。

我创建了一个简单的 .dylib（在 Objective-c 中），它导出了一个使用可可打开窗口的函数。我创建了一个非常简单的 python 扩展模块（在 c 中），其中有一个调用 .dylib 函数的函数。

（我的计划是为 gui 调用和相关的平台特定调用创建一个平台特定的共享/动态库，以及一个使用它的跨平台 c 库，然后创建高级语言扩展模块，使 c这些语言可用的库。）

我写了一个非常简单的调用 c 函数的 python 程序。我编写了一个 setup.py 来构建所有内容并使用 py2app 创建一个 .app。

这是 .dylib 的构建脚本：

```
gcc -framework Cocoa -dynamiclib -x objective-c testlib.objc -current_version 1.0 -compatibility_version 1.0 -o libTestlib.1.dylib -arch i386 -arch x86_64 
```

这是 setup.py：

```
from setuptools import setup, Extension

APP = ['testrun.py']
DATA_FILES = []
OPTIONS = {
    'argv_emulation': True,
    'frameworks': ['/Users/shavais/scratch/objc/libTestlib.1.dylib']
}

module1 = Extension(
    'demo',
    sources = ['demo.c'],
    libraries = ['Testlib.1'],
    library_file_directories = ['/Users/shavais/scratch/objc']
)

setup(
    name = 'testrun',
    description = 'This is a testrun package',
    app = APP,
    data_files = DATA_FILES,
    options = {'py2app': OPTIONS},
    setup_requires = ['py2app'],
    version = '1.0',
    py_modules = ['testrun'],
    ext_modules = [module1]
) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T18:35:13.530

我不知道 Mac 上的 py2app（从未使用过），但如果它的工作方式类似于[http://www.pyinstaller.org/](http://www.pyinstaller.org/)，那么二进制文件必须将 python 运行时、您的程序和所有模块解压缩到内存中。这需要时间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-20T09:07:13.910

将“argv_emulation”设置为 False，除非您确实需要该功能（也就是说，除非您希望能够将文件拖放到应用程序包中，然后将这些文件名作为 sys.argv 中的参数）。

“Argv_emulation”是一种将请求打开文件的 AppleEvents 转换为 sys.argv 中的额外参数的 hack。为此，仿真代码会启动一个事件循环并等待那些打开的事件或超时。您可能会遇到该超时。

# git - Git：撤消新用户意外删除所有文件的推送提交

> ID：14386422
> 
> 赞同：0
> 
> 时间：2013-01-17T19:15:49.707
> 
> 标签：git

我们添加了一个新用户，他做了一个 put pull 并错误地认为它成功了。

然后他们做了一个 git push，但是由于他们没有文件，所以他们删除了整个项目中的所有文件。

现在，我们需要撤消发生的事情并将项目回滚到所有内容被删除之前的提交。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-17T19:18:31.897

*   将最新版本拉入本地存储库
*   做一个`git revert HEAD`
*   推送新的提交

`git revert`创建一个新的提交，恢复指定提交引入的所有更改。

有关更多信息和背景，请参阅[此博客文章](http://christoph.ruegg.name/blog/2010/5/5/git-howto-revert-a-commit-already-pushed-to-a-remote-reposit.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T19:30:45.283

您应该首先检查主存储库发生了什么。是整个分支被删除（需要强制推送）还是新用户只是引入了一个新的提交来擦除所有文件。

如果分支被删除，则将其从另一个开发人员存储库推回。

如果新用户刚刚通过一次提交删除了所有内容，请转到主存储库并执行

```
git reset --hard HEAD^ 
```

摆脱有问题的提交。`git revert`除非很多人已经将错误拉入他们的存储库，否则我会建议不要这样做。如果您恢复，您将在历史记录中记录此错误。如果您重置，则没有任何迹象表明会发生这种情况。但只有在错误的提交尚未扩散时才重置！

# javascript - 将字符串作为参数传递给 jQuery 函数

> ID：14386423
> 
> 赞同：0
> 
> 时间：2013-01-17T19:15:59.377
> 
> 标签：javascript, jquery, jquery-selectors, parameters

我有一个奇怪的 jQuery 问题。我正在编写一个接受字符串作为参数的函数，然后将该字符串输入到 jQuery 选择器中。

这是功能：

```
function myFunction(specialfields) {
   if(!$(specialfields).is(':focus')) {
       alert('thats not in focus');
   }
 } 
```

但是，我不断收到此错误：

```
 Uncaught Syntax error, unrecognized expression: focus 
```

但奇怪的是 '.is(':focus') '在其他领域工作，当不接受参数时，如果我通过这个：

```
 $(specialfields) 
```

它确实读作有效对象。我正在尝试传递这样的字符串：

```
#id1, #id2 
```

此外，这有效：

```
$(specialfields).val() 
```

有人知道这里发生了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T19:39:11.140

好的，我认为问题在于我将两个参数传递给“特殊字段”，这破坏了“：焦点”选择器，因为显然您不能同时拥有两个焦点字段。

可以通过在函数中仅传递一个选择器来修复它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T19:52:52.173

# 结论

你的方法一直有效，而且比我浪费时间的方法更快。

* * *

# 细节

我对函数的定义略有不同，我`alert()`通过将响应传递给`<p id="response">`.

HTML：

```
<input type="text" name="id1" id="id1" />
<br />
<input type="text" name="id2" id="id2" />
<br />
<p id="response">response</p> 
```

JavaScript：

```
var myFunction = function (specialfields) {
  if ($(specialfields + ':focus').length === 0) {
    $('#response').text(specialfields + ' is not in focus');
  } else {
    $('#response').text(specialfields + ' is in focus');
  }
}; 
```

有关工作示例，请参见[http://jsfiddle.net/jhfrench/UufWD/ 。](http://jsfiddle.net/jhfrench/UufWD/)

您会注意到我评估了传入的参数`:focus`with `if ($(specialfields + ':focus').length === 0)`。

## 我认为这会更快，但[事实并非如此](http://jsperf.com/focus-length-vs-is-focus)。

从好的方面来说，此方法确实可以处理多个选择器参数（例如，`#id1, #id2')`参见[http://jsfiddle.net/jhfrench/UufWD/19/](http://jsfiddle.net/jhfrench/UufWD/19/)）。但是你原来的评价`if(!$(specialfields).is(':focus'))`更好。

* * *

现在请参阅[http://jsfiddle.net/jhfrench/UufWD/14/](http://jsfiddle.net/jhfrench/UufWD/14/)以获得您的方法的工作示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-17T19:26:13.637

```
I think .focus() should be enough, as :focus is not a selector. 
```

没有本机解决方案，但是有一种更优雅的方式可以做到：

```
jQuery.extend(jQuery.expr[':'], {
  focus: "a == document.activeElement"
}); 
```

您正在定义一个新的选择器。请参阅插件/创作。然后你可以这样做：

```
if ($("...").is(":focus")) {
  ...
} 
```

来源——JavaScript [（或 jQuery）中是否有“焦点”？](https://stackoverflow.com/questions/2683742/is-there-a-has-focus-in-javascript-or-jquery/2683838#2683838)

# javascript - jsPlumb - 是否可以使用类名将端点分配给元素组？

> ID：14386424
> 
> 赞同：2
> 
> 时间：2013-01-17T19:15:59.270
> 
> 标签：javascript, jquery, jsplumb

我想将相同的端点分配给各种容器。但我必须手动将它们分配给每个容器，例如：

```
jsPlumb.addEndpoint('window', { anchor:[0.5, 1, 0, 1] }, exampleEndpoint2);
jsPlumb.addEndpoint('window2', { anchor:"RightMiddle" }, exampleEndpoint2);
jsPlumb.addEndpoint("window3", { anchor:[0.75, 0, 0, -1] }, exampleEndpoint2);
jsPlumb.addEndpoint("window4", { anchor:[0.25, 0, 0, -1] }, exampleEndpoint2); 
```

有没有办法可以将其分配给类选择器，例如：

```
jsPlumb.addEndpoint(".window", { anchor:[0.25, 0, 0, -1] }, exampleEndpoint2); 
```

或者可能是一种解决方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T16:04:57.150

您可以像这样使用 jQuery 选择器：

```
jsPlumb.addEndpoint($(".window"), { anchor:[0.25, 0, 0, -1] }, exampleEndpoint2); 
```

# html - 背景顶部重复

> ID：14386426
> 
> 赞同：-1
> 
> 时间：2013-01-17T19:16:09.157
> 
> 标签：html, css

我正在[将此设计](http://i.imgur.com/NEIPb.jpg)转换为 HTML 和 CSS 格式。

当谈到重复背景顶部时，我被卡住了，因为左侧和右侧没有使用相同的图像文件。

我试过使用[这个技巧](http://css-tricks.com/multiple-backgrounds-left-half-and-right-half/)，但它对我不起作用。

我希望重复这些文件并将标题放在中间（header.jpg）：

*   左上角：http: [//i.imgur.com/tcr1F.jpg](http://i.imgur.com/tcr1F.jpg)
*   右上角：http: [//i.imgur.com/PchTG.jpg](http://i.imgur.com/PchTG.jpg)

我也尝试了背景位置，但对我不起作用。

我该怎么办我的朋友？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T19:21:20.443

也许最好重复背景并成为 w 的背景，`<div class=wrapper>`它包含所有网站内容，或者类似的东西......并切割更大的作物......不仅仅是 1 像素高度，而是大约 50-60

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T20:04:06.453

我不确定我是否理解你的问题，但我认为这就是你所追求的：http:
[//jsfiddle.net/ub66M/1/](http://jsfiddle.net/ub66M/1/)

html 看起来像这样：

```
<div id="page">
  <div id="header-wrapper">
    <div id="header-left"><!-- empty, just for background --></div>
    <div id="header-right"><!-- empty, just for background --></div>
    <div id="header-center">
        the actual content of the header comes here
    </div>
  </div>
</div> 
```

CSS看起来像这样：

```
#header-wrapper {
    width: 100%;
    position: relative;
}
#header-left, #header-right {
    width: 50%;
    position: absolute;
    top: 0;
    background-repeat: repeat-x;
    height: 284px;
    z-index: -1;
}
#header-left {
  left: 0;
  background-image: url(http://i.imgur.com/tcr1F.jpg);
}
#header-right {
  left: 50%; 
  background-image: url(http://i.imgur.com/PchTG.jpg);
}
#header-center {
    width: 500px; /* adapt to actual width of center slice */
    height: 284px;
    margin: 0 auto;
    background: url(http://placehold.it/500x284) no-repeat; /* put your center slice here */
} 
```

诀窍在于添加两个额外的 div，并将它们绝对定位在标题的实际内容后面。当然，中心 div 必须包含正确的、非重复的图像切片和标题的实际内容。

希望这可以帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-17T19:26:47.543

您无法用这 2 张图像准确地表达该标题，因为它不是水平*或*垂直渐变。它在对角线上。但是，您可以使用 CSS 渐变轻松地做到这一点。

[http://jsfiddle.net/ZteRf/](http://jsfiddle.net/ZteRf/)

```
background: -moz-linear-gradient(-45deg, #ff3232 0%, #fff989 100%); /* FF3.6+ */
background: -webkit-gradient(linear, left top, right bottom, color-stop(0%,#ff3232), color-stop(100%,#fff989)); /* Chrome,Safari4+ */
background: -webkit-linear-gradient(-45deg, #ff3232 0%,#fff989 100%); /* Chrome10+,Safari5.1+ */
background: -o-linear-gradient(-45deg, #ff3232 0%,#fff989 100%); /* Opera 11.10+ */
background: -ms-linear-gradient(-45deg, #ff3232 0%,#fff989 100%); /* IE10+ */
background: linear-gradient(135deg, #ff3232 0%,#fff989 100%); /* W3C */
filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#ff3232', endColorstr='#fff989',GradientType=1 ); /* IE6-9 fallback on horizontal gradient */ 
```

[http://www.colorzilla.com/gradient-editor/](http://www.colorzilla.com/gradient-editor/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-17T19:27:17.567

在您的 CSS 中使用此代码

```
 body
   {
   background-image:url("http://s8.postimage.org/r3vb8vx2t/NEIPb.jpg");
   background-repeat:repeat-y;
   } 
```

[在http://jsfiddle.net/v4zTT/](http://jsfiddle.net/v4zTT/)演示（在 javascript 和结果之间拖动，您可以看到完整图像）

祝你好运..：）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-17T19:19:43.833

如果我正在构建这个设计，我只需将粉红色到橙色背景的水平切片（15-20 像素左右）设置`repeat-y`为`<body>`. 主要内容周围的粉红色顶部和底部边框看起来就是这样 - 顶部和底部的粉红色边框。

# javascript - 在VB中试图使单选按钮依赖于另一个答案

> ID：14386427
> 
> 赞同：0
> 
> 时间：2013-01-17T19:16:11.060
> 
> 标签：javascript, vb.net

我正在尝试根据另一个单选按钮选择的答案禁用或启用单选按钮列表，这是我放在一起但未能成功使其工作的代码：

```
<script type="text/javascript">
        // enable May we contact your present employer if Employed Now is yes

        function EmployedNowYes(answer) {

            if (answer == "Yes") {
                document.getElementById("<%=ContactEmployer.ClientID %>").enabled = true;
            }

            if (answer == "No") {
                document.getElementById("<%=ContactEmployer.ClientID %>").enabled = false;
            }

        }

    </script>
Are you employed now?
                <asp:RadioButtonList ID="EmployedNow" runat="server" RepeatDirection="Horizontal" >
                    <asp:ListItem Value="Yes" onclick ="EmployedNowYes(this.value)">Yes</asp:ListItem>
                    <asp:ListItem Value="No" onclick ="EmployedNowYes(this.value)">No</asp:ListItem>
                </asp:RadioButtonList>
                <asp:RequiredFieldValidator ID="RequiredFieldValidator13" runat="server" ControlToValidate="EmployedNow"
                    ErrorMessage="* Required field." ForeColor="Red"> </asp:RequiredFieldValidator>
            </td><td class="style42" valign="top">
                May we contact your present employer:
                <asp:RadioButtonList ID="ContactEmployer" runat="server" RepeatDirection="Horizontal">
                    <asp:ListItem >Yes</asp:ListItem>
                    <asp:ListItem >No</asp:ListItem>
                </asp:RadioButtonList>
                            </td> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T08:40:42.667

我发现在Javascript中你需要写......

```
document.getElementById("<%=ContactEmployer.ClientID %>").disabled = false;
document.getElementById("<%=ContactEmployer.ClientID %>").disabled = true; 
```

您可能还会发现已禁用控件的值不会在回发中返回给代码隐藏。

# python - 使用 Python tkinter 扩展 Vim GUI

> ID：14386430
> 
> 赞同：3
> 
> 时间：2013-01-17T19:16:27.300
> 
> 标签：python, vim, plugins, tkinter, extend

我知道有几种方法可以使用 gtk.Socket 和 DBUS 在 GTK 中集成 gVIM：

*   [必达](https://code.google.com/p/pida/)
*   [gtkvim](http://www.vim.org/scripts/script.php?script_id=160)
*   [anjuta-gvim](https://github.com/arunchaganty/vimjuta/)
*   [VEE](http://wiki.kldp.org/wiki.php/VEE/english_page)
*   [VimMate](http://vimmate.rubyforge.org/)
*   [维济尼奥](http://code.google.com/p/vizinho/)

但我想知道是否可以说有一个使用 tkinter 将额外的 GUI 组件添加到 gVIM GUI 的 python 插件？

问题是如何在这里解释两个主循环：

[Python：有没有办法可以在后台运行 mainloop()](https://stackoverflow.com/questions/5420885/python-is-there-a-way-i-can-run-mainloop-in-the-background)

我的第一次尝试是（tkinter.vim）：

```
python << endpython

from Tkinter import *

root = Tk()

w = Label(root, text="Hello, world!")
w.pack()

root.mainloop()

endpython 
```

甚至这个（tkinter-thread.vim）：

```
python << endpython

import Tkinter
import threading
class MyTkApp(threading.Thread):
    def __init__(self):
        threading.Thread.__init__(self)
        self.start()
    def callback(self):
       self.root.quit()
    def run(self):
        self.root=Tkinter.Tk()
        self.root.protocol("WM_DELETE_WINDOW", self.callback)
        self.s = Tkinter.StringVar()
        self.s.set('Foo')
        l = Tkinter.Label(self.root,textvariable=self.s)
        l.pack()
        self.root.mainloop()
app = MyTkApp()
print 'now can continue running code while mainloop runs'

endpython 
```

一旦您尝试输入内容，它们都会挂起 gVIM GUI。

有没有其他方法可以使用其他 GUI 组件（窗口/工具栏，...）来扩展 gVIM GUI？

# c# - 需要一些关于 HashSet 如何工作的解释

> ID：14386432
> 
> 赞同：3
> 
> 时间：2013-01-17T19:16:34.013
> 
> 标签：c#, collections

这就是我所拥有的：

```
class A
{
  // The uniqueness of instance must be detected by this property
  public string Key { get; set; }

  // There are other properties
}

var set = HashSet<A>() 
```

我的一般目的是：

*   通过属性值提供`set`集合中实例的身份`Key`

*   使此收集尽可能快地用于包含操作

回答以下问题可能有助于我实现这一目的：

1.  什么用于运行方法，例如`Contains`，`Add`必须确定实例的唯一性：GetHashCode() 还是 IEquatable？很可能 GetHashCode() as HashSet 声明搜索速度非常快。
2.  默认`String.GetHashCode()`实现不保证 2 个不同字符串的哈希唯一性，那么如何在考虑性能的情况下提供唯一性？
3.  HashSet 是否完全使用了 IEquatable？

请注意，他的集合仅在运行时创建和销毁，不会保存到数据库中

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-17T19:22:05.827

集合通常使用`Object.GetHashCode()`and`Object.Equals()`来获取哈希码并检查是否相等。除了最简单的对象外，没有办法`Object.GetHashCode()`为所有对象返回唯一的哈希码 - 哈希码只有 32 位宽，每个具有超过 32 位内部状态的对象都不能映射到唯一的哈希码。因此`Object.Equals()`用于在哈希码冲突的情况下检查是否完全相等。

因此，您必须使用合适的实现来覆盖这两种方法。

```
public override Int32 GetHashCode()
{
    // If this.Key may be null you have to handle this case.
    return this.Key.HashCode();
}

public override Boolean Equals(Object obj)
{
    var other = obj as A;

    return (other != null) && (this.Key == other.Key);
} 
```

或者，您可以使用`HashSet<T>`构造函数接受`IEqualityComparer<T>`和外部化这两种方法，例如，如果您无法控制要添加到集合中的类型的源代码。只需使用合适的方法创建一个实现接口的类，并将该类的实例传递给`HashSet<T>`构造函数。

# visual-studio-2010 - 运行 MS 单元测试框架时，如何将空文件夹复制到输出目录？

> ID：14386437
> 
> 赞同：1
> 
> 时间：2013-01-17T19:17:06.723
> 
> 标签：visual-studio-2010, unit-testing

我正在尝试测试一种在遇到空目录时引发异常的方法。问题是当我构建项目并运行测试时，除非目录中有文件，否则不会复制空目录。我在目录中放置了一个“虚拟文件”，果然，目录是可见的。在 VS 中，当您将文件夹添加到项目时，没有与之关联的“属性”，因此我无法指定我希望将其复制到输出目录。

那么，在运行 MS 单元测试框架时，如何将空文件夹复制到输出目录？

任何建议表示赞赏！

# c# - XNA中的战术角色扮演游戏

> ID：14386438
> 
> 赞同：2
> 
> 时间：2013-01-17T19:17:11.650
> 
> 标签：c#, xna

我觉得这些年来我已经学会了足够多的 C# 来尝试我的第一个游戏。我已经知道 C# 的局限性（仅适用于 Widows/Xbox），但我仍然想使用它，因为它是我唯一知道的。

最近我在网上搜索并发现了 XNA 框架，它是某种游戏库集合。我的问题是，它是否允许我执行以下操作：

*   创建一个角色在方块上移动的回合制 RPG 游戏，就像 Xcom 一样
*   [以这种风格](http://www.mobygames.com/images/shots/l/526564-the-binding-of-isaac-windows-screenshot-isaac-uses-the-magnet.png)渲染卡通 2D 图形
*   保存/加载到磁盘
*   通过 Steam 分发

感谢您提供任何可能的答案:)。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-17T19:19:29.163

做前三个非常简单。

XNA 旨在通过[XNA Creators Club](http://xbox.create.msdn.com/en-US/)分发，并通过 XBOX Live Indie Games 分发。

通过 Steam 分发可能是可能的，但也可能有点棘手，因为它不是内置的分发机制。话虽如此，[Steam 确实接受使用 XNA 构建的游戏](http://www.steampowered.com/steamworks/FAQ.php)，所以这应该是可能的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T19:23:30.210

其实我之前在XNA做过这样的项目

*   当我在 XNA 中制作我的项目时，我画了一个瓦片网格，并有一个状态机，并且有 7 个左右涉及游戏流程的主要状态。开始状态，第一个动作选择-移动动画-第二个动作选择-攻击动画-伤害解析等。

*   您的图形可以随心所欲，我相信 XNA 的内置图形引擎支持多种图像格式，例如 .png。您还可以使用 spritesheet 为您的图像设置动画。（你可能想谷歌如何使用精灵表）。但你可能需要找一个艺术家来做。

*   是的，您可以使用 c# 或几乎任何语言来做到这一点。只要你想保存就写入文件，你可以在你的`LoadContent`处理程序中从它加载

# c# - 何时使用自动属性？

> ID：14386445
> 
> 赞同：1
> 
> 时间：2013-01-17T19:17:30.390
> 
> 标签：c#, .net, security

因此，我的代码中有一个加密密钥，例如：

```
private const string _keyc = "blahblahblah";

private static string _key
{
     get { return "blahblahblah"; }
} 
```

编译后`ILDasm`，我确实注意到我可以直接看到常量的值，但不能在第二种情况下。但是，我仍然可以看到`ldstr`下面的键`hidebysig...get_key()`

然而，ILSpy 完全按照我编写的方式获取了源代码。

所以在这里，我想知道，在这里使用汽车属性真的有意义吗？使用自动属性还有其他优点吗？特别是在这种简单的情况下，是否建议使用 auto 属性？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T19:21:56.030

只有在以下情况下才能使用自动属性：

*   该属性是可读写的；也就是说，它定义了`get`和`set`访问器。如果您只定义一个访问器，则不能使用自动属性。（请注意，如果您希望属性在类外部的代码中是只读的，但在类内部是读写的，则可以在自动属性上*定义*访问器。）`private set`
*   您不需要在 setter 中进行任何验证——也就是说，属性类型的所有值都是有效的。
*   您不需要直接初始化支持字段，而是从构造函数设置属性（或仅在字段中保留默认值）。
*   您永远不需要直接引用支持字段，例如作为`ref`或`out`参数。特别是，这将阻止您`System.Threading.Interlocked`在现场使用这些方法。
*   字段的名称并不重要。（序列化是一种可能被认为很重要的情况。）

根据您的示例，您正在实现一个只读属性（没有设置器的属性）。在这种情况下，您不能使用自动属性，除非您使用如下模式：

```
class Example
{
    public static string SomeProperty { get; private set; }

    static Example()
    {
        SomeProperty = "some value";
    }
} 
```

但是，仅从 getter 返回常量值要简单得多，并且应该是首选：

```
class Example
{
    public static string SomeProperty
    {
        get { return "some value"; }
    }
} 
```

这段代码清晰明了。自动属性应该使您的代码更具可读性。在这种情况下，他们实际上会混淆意图，所以我不会在这里使用一个。

* * *

请注意，示例代码中的属性根本*不是*自动属性；它只是一个标准属性。自动属性声明 getter 和 setter，但不提供实现。

# java - 如何在Android应用程序中将激活链接发送到电子邮件

> ID：14386447
> 
> 赞同：-2
> 
> 时间：2013-01-17T19:17:43.813
> 
> 标签：java, android, mysql

我必须将在注册表单中输入的用户详细信息存储在 mysql 数据库中。注册完成后，我必须发送指向注册电子邮件的链接以激活帐户。在 Android 中开发的注册表单。如何将激活链接发送到邮件。请帮助我任何人。我正在使用 mysql 作为数据库和 android 应用程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T19:24:36.847

我没有意识到你可以在 Android 上安装 MySQL。

您可以使用 JavaMail API 从 Android 设备发送电子邮件。

您可以在此处找到文档和示例： [http ://www.javapractices.com/topic/TopicAction.do?Id=144](http://www.javapractices.com/topic/TopicAction.do?Id=144)

你可能需要稍微调整一下

环顾一圈后，我发现这个问题已经在这里得到解答：[使用 JavaMail API 在 Android 中发送电子邮件，而不使用默认/内置应用程序](https://stackoverflow.com/questions/2020088/sending-email-in-android-using-javamail-api-without-using-the-default-built-in-a/2033124#2033124)

# php - 为什么只能在默认语言下找到外部文档？

> ID：14386448
> 
> 赞同：0
> 
> 时间：2013-01-17T19:17:46.987
> 
> 标签：php, typo3

我们在我们的一个网站上使用 indexed_search 作为搜索解决方案。最近，我在`.pdf`维护的网站上遇到了索引搜索和文档的问题。

索引搜索将对文档进行索引，但只会将它们“链接”到默认语言。因此，如果您选择不同的语言浏览网站，这些文档将永远不会出现在任何搜索结果中。

有可能解决这个问题吗？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T19:17:46.987

当使用索引搜索来索引您网站上的文档（如`.pdf`文件）时，只有在用户选择了默认语言时才能找到它们。要使索引搜索在找到文件的页面的语言下正确索引这些文件，您必须调整`class.indexer.php`.

在方法`submitFilePage()`中，找到数组`$fields`并将其添加`sys_language_id`到其中，如下所示：

```
$fields = array(
    'phash' => $hash['phash'],
    'phash_grouping' => $hash['phash_grouping'],
    'cHashParams' => serialize($subinfo),
    'contentHash' => $content_md5h,
    'data_filename' => $file,
    'item_type' => $storeItemType,
    'item_title' => trim($contentParts['title']) ? $contentParts['title'] : basename($file),
    'item_description' => $this->bodyDescription($contentParts),
    'item_mtime' => $mtime,
    'item_size' => $size,
    'item_crdate' => $ctime,
    'tstamp' => $GLOBALS['EXEC_TIME'],
    'crdate' => $GLOBALS['EXEC_TIME'],
    'gr_list' => $this->conf['gr_list'],
    'externalUrl' => $fileParts['scheme'] ? 1 : 0,
    'recordUid' => intval($this->conf['recordUid']),
    'freeIndexUid' => intval($this->conf['freeIndexUid']),
    'freeIndexSetId' => intval($this->conf['freeIndexSetId']),
    'sys_language_uid' => $this->conf['sys_language_uid']
); 
```

在方法`setExtHashes()`中，找到数组`$hArray`并将其添加`sys_lang`到其中，如下所示：

```
$hArray = array(
    'file' => $file,
    'sys_lang' => (integer)$this->conf['sys_language_uid']
); 
```

## 警告

此方法仅在您不使用爬虫调用外部文件索引时才有效。这由`useCrawlerForExternalFiles`索引搜索的设置控制。

**禁用此设置！**您还应该启用`disableFrontendIndexing`，否则这可能会导致页面加载时间过长（因为页面上的链接文档可能会在用户请求页面时被索引）。

# java - Thread 的 Junit4 测试用例

> ID：14386453
> 
> 赞同：0
> 
> 时间：2013-01-17T19:18:08.850
> 
> 标签：java, junit4, testcase, thread-sleep

嗨，我正在尝试为此编写 Junit 测试用例，因为我无法在此处返回任何内容以在我的测试用例中捕获和测试 assertrue(....)。SendMailTLS 是一个单独的类（没有主类），它将邮件发送到从 mysql 获取的电子邮件 ID。Updates 是一个单独的类，它从网站获取一些值并将它们存储到 mysql 中。如果我通过调用 run 方法而不使用任何 asserttrue/ 来编写正常/ assertequals 即使我发表评论，程序也会继续运行`Thread.sleep(1000 * 60 * 1);`。在这种情况下，我将如何测试？任何建议将不胜感激。

```
public class Scheduler implements Runnable {

    public void run() {
        while(true)
        {
            SendMailTLS mail= new SendMailTLS();
            Updates Employee= new Updates();

            try {
                mail.Mail();
                Employee.update();              
                Thread.sleep(1000 * 60 * 1);
            } 
            catch{
            //catch code here

            }

            System.out.println("Scheduler Task Complete");
        }
    }

    public static void main(String args[]) {
            (new Thread(new Scheduler())).start();
        }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T19:46:53.413

您可以测试的一件事是，在方法运行后，Updates 类保存的 DB 内容是否正确。我认为很难测试电子邮件是否已发送。我最近遇到了类似的情况，但是电子邮件发送类将电子邮件的内容保存在数据库中，所以我所做的是检查邮件数据是否正确保存在数据库中。您的 SendMailTLS 是否留下有关其工作的任何信息？如果是这样，您可以尝试对其进行测试。您的方法无限期运行的事实不必成为问题。在测试中准备一些数据（我假设在 DB 中），在测试中等待一段时间，然后检查系统状态（例如 DB 中的数据）是否正确。在 JUnit 线程完成后，应该分离线程（我认为如果 JUnit 线程不再运行，其他线程会被杀死）。

# ruby - 如何仅将时间存储在数据库中？

> ID：14386454
> 
> 赞同：3
> 
> 时间：2013-01-17T19:18:24.430
> 
> 标签：ruby, ruby-on-rails-3, postgresql-9.1

我正在使用 rails 3，我想存储 start_time 和 end_time。由于 rails 不支持日期范围。

我应该使用哪种数据类型来存储没有日期的时间以便以后进行比较？

这是我的数据库架构，其中包含表 Schedules 中的 tsrange 数据类型（我应该使用哪种数据类型来替换它？）。

```
CREATE TABLE Doctors
(
id INTEGER UNIQUE,
name VARCHAR(size)
);

CREATE TABLE Schedules
(
id INTEGER,
doctor_id INTEGER,
start_time tsrange,
end_time tsrange,
day VARCHAR(size)
);

CREATE TABLE Appointments
(
id INTEGER,
doctor_id INTEGER,
aday DATE
); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-17T20:16:07.333

:time 数据类型可能是您正在寻找的。

此外，当我尝试了解 rails 中日期/时间数据类型之间的差异时，这个问题确实对我有所帮助：

[在 Ruby on Rails 中，DateTime、Timestamp、Time 和 Date 有什么区别？](https://stackoverflow.com/questions/3928275/in-ruby-on-rails-whats-the-difference-between-datetime-timestamp-time-and-da)

您还应该考虑使用 datetime 数据类型，并简单地使用 strftime 转换它，例如

```
 t = Time.now
 t.strftime("%I:%M%p") 
```

这将需要一个日期/时间，并简单地格式化为 Hour/Minute/AM|PM，省略日期。

# entity-framework - 如何将 EF5 和 Database First 生成的上下文类与 Repository 和 UoW 一起使用

> ID：14386455
> 
> 赞同：2
> 
> 时间：2013-01-17T19:18:27.313
> 
> 标签：entity-framework, repository-pattern

我使用*数据库优先*方法在 VS.NET 2012 中使用实体框架 5。我还尝试实现一个标准的通用存储库接口以及一个工作单元，以确保所有更新都发生在一个上下文中。创建存储库 UoW，使用 DI 注入它*实际上*是我知道如何完成的部分。

我遇到的问题是了解它与`MyModel.Context.cs`以下从 Entity Framework 5 T4 POCO 模板自动生成的类的关系：

```
public partial class AdventureWorks2008R2Entities : DbContext
{
    public AdventureWorks2008R2Entities() : base("name=AdventureWorks2008R2Entities")
    {
    }

    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        throw new UnintentionalCodeFirstException();
    }

    public DbSet<Person> People { get; set; }
    public DbSet<PersonPhone> PersonPhones { get; set; }
    public DbSet<PhoneNumberType> PhoneNumberTypes { get; set; }
} 
```

我*认为*会发生的是，这个类的一个实例将被发送到我的 UoW 类的构造函数，如下所示：

```
public UnitOfWork(IContext context)
{
    _context = context;
} 
```

所以我的主要问题是，自动生成的上下文类和我创建的存储库（使用 UoW）应该如何协同工作。我发现了一些在 EF4 中首先使用代码的示例，但对于使用具有 POCO 生成和存储库模式的 Database First 方法的 EF5 却没有。如果有人知道这方面的一个很好的例子，请分享。

感谢您对清除此问题的任何帮助，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T14:53:48.693

好的，我想出了一种方法来解决这个问题。首先，此方法实际上可以用于 Database 1st 或 Code 1st 方法，因为没有修改 Context 并且只使用了它的一个实例。

一些示例将 IUnitOfWork 接口直接应用于自动生成的`AdventureWorks2008R2Entities`类。但是，您不希望这样做，因为修改可能被覆盖的自动生成代码并不是一个好主意。

这个想法是让通用存储库（或者如果不使用通用存储库，每个单独的存储库）接受 EF 上下文的实例，如下所示：

```
public GenericRepository(DbContext context)
{
    this.context = context;
    this.dbSet = context.Set<TEntity>();
} 
```

现在 IUnitOfWork 接口应该声明 EF 的方法和每个存储库类型的实例，如下所示：

```
public interface IUnitOfWork : IDisposable
{
    GenericRepository<Person> PersonRepository { get; }
    GenericRepository<PersonPhone> PersonPhoneRepository { get; }
    void Save();
} 
```

如果尚未实例化，则该实现将新建一个存储库实例，如下所示：

公共类 UnitOfWork : IUnitOfWork { private DbContext _context; 私有 GenericRepository _personRepository；私有 GenericRepository _personPhoneRepository；

```
public UnitOfWork(DbContext context)
{
    _context = context;
}

public GenericRepository<Person> PersonRepository
{
    get
    {

        if (this._personRepository == null)
        {
            this._personRepository = new GenericRepository<Person>(_context);
        }
        return _personRepository;
    }
}

public GenericRepository<PersonPhone> PersonPhoneRepository
{
    get
    {

        if (this._personPhoneRepository == null)
        {
            this._personPhoneRepository = new GenericRepository<PersonPhone>(_context);
        }
        return _personPhoneRepository;
    }
}

public void Save()
{
    try
    {
        _context.SaveChanges();
    }
    catch (DbEntityValidationException dbEx)
    {
        foreach (var validationErrors in dbEx.EntityValidationErrors)
        {
            foreach (var validationError in validationErrors.ValidationErrors)
            {
                Trace.TraceInformation("Property: {0} Error: {1}", validationError.PropertyName, validationError.ErrorMessage);
            }
        }
    }

}

#region Implementation of IDisposable

/// <summary>
/// Performs application-defined tasks associated with freeing, releasing, or resetting unmanaged resources.
/// </summary>
public void Dispose()
{
    Dispose(true);
    GC.SuppressFinalize(this);
}

/// <summary>
/// Disposes off the managed and unmanaged resources used.
/// </summary>
/// <param name="disposing"></param>
private void Dispose(bool disposing)
{
    if (!disposing)
        return;

    if (_disposed)
        return;

    _disposed = true;
}

private bool _disposed;
#endregion 
```

}

最后，要将*工作*单元实例用于您的存储库，您可以通过它到达适当的存储库实例，UoW 将确保所有保存的更改都发生在*相同*的上下文中：

```
_unitOfWork.PersonRepository.Insert(person);
_unitOfWork.Save(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T13:08:45.270

你应该检查这些内容：

[http://www.johnpapa.net/spapost3/](http://www.johnpapa.net/spapost3/)

[http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/implementing-the-repository-and-unit-of-work-patterns-in-an-asp-net- mvc-应用程序](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/implementing-the-repository-and-unit-of-work-patterns-in-an-asp-net-mvc-application)

[https://codereview.stackexchange.com/questions/14226/generic-repository-and-unit-of-work-code](https://codereview.stackexchange.com/questions/14226/generic-repository-and-unit-of-work-code)

# c# - 为什么 TreeView.OnBeforeSelect 循环？

> ID：14386457
> 
> 赞同：0
> 
> 时间：2013-01-17T19:18:30.850
> 
> 标签：c#, .net, treeview

所以我有一个树视图，我希望能够通过单击它来取消选择一个节点。

我正在扩展树视图类（还需要一些其他功能），但我遇到了一个小问题。

这是我正在使用的代码：

```
 protected override void OnNodeMouseClick(TreeNodeMouseClickEventArgs e)
    {

        base.OnNodeMouseClick(e);
        if (this.SelectedNode == e.Node)
        {
            this.SelectedNode = null;
            selectedSame = true;
        }
    }

    protected override void OnBeforeSelect(TreeViewCancelEventArgs e)
    {
        if (selectedSame)
        {
            selectedSame = false;
            base.OnBeforeSelect(e);
            e.Cancel = true;
        }
    } 
```

在调用 e.cancel 之后会发生什么，它通过 OnBeforeSelect 循环返回，现在它是错误的，所以它然后选择它（撤消我刚刚所做的！）。

我把 selectedSame = false; 从 OnBeforeSelect 中取出并将其置于其他位置，但随后这部分将无限运行并且永不中断！

```
 if (selectedSame)
        {
            selectedSame = false;
            base.OnBeforeSelect(e);
            e.Cancel = true;
        } 
```

还测试了：

```
 protected override void OnBeforeSelect(TreeViewCancelEventArgs e)
    {

            base.OnBeforeSelect(e);
            e.Cancel = true;
    } 
```

而且它也只是循环了无数次（如果我把它关闭它实际上完成了，但是如果我把它放回去并点击它会进入它的循环数百次）。

我想我真的不明白 e.Cancel 应该如何工作，因为它似乎一旦点击取消它就会立即跳回来，甚至没有完成那个调用。

任何建议将不胜感激:)

-赖特

编辑： - 更多信息

做了一个全新的项目，以确保我所参与的任何事件都不会导致这个问题。结果相同，但它确实让我发现至少它正在采取的步骤。当我设置“this.SelectedNode = null”时，它会触发 OnBeforeSelect，这会导致整个事情一开始就搞砸了。但是，如果我有一个按钮，当单击该按钮时，将树的 selectednode 设置为 null，则 OnBeforeSelect 永远不会发生。那么有什么区别呢？

最后：

扩展类中除此之外没有代码：

```
 class StatedTreeView : System.Windows.Forms.TreeView
    {
    protected override void OnBeforeSelect(TreeViewCancelEventArgs e)
            {
            e.Cancel = true;            
            }
    } 
```

如果你在取消上放一个中断......它只是循环和循环和循环。如果您取消中断，程序会变得有点可用（选择然后立即取消，这很好）。但是，如果您在它运行时添加中断，它会立即再次中断！您甚至不必选择节点！呃……我不明白

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T22:47:58.463

这是调试器引起的工件。调试器试图尽可能地避开程序。但是让它在断点处中断有一些不可避免的副作用。这往往会使调试 UI 事件变得困难。例如，Paint 事件处理程序往往很棘手。

这里的问题是焦点发生了变化，从您的程序到 Visual Studio。并且您将 TreeView.HideSelection 属性设置为 True。所以焦点变化实际上取消了当前树节点的选择。当您恢复执行时，焦点会回到 TreeView 并再次选择节点。这会再次触发 OnBeforeSelect() 方法。这会再次触发断点，等等，等等。

在极端情况下，您可能需要使用远程调试器来克服这些副作用。但是您不必走那么远，因为您的代码很好。将 HideSelection 设置为 false 可以修复它，以防您需要继续调试它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T19:26:08.937

因为你一次又一次地调用`OnBeforeSelect`事件？您在没有任何停止条件的情况下递归调用事件（因为`e.Cancel = true;`在调用事件之后）**。**

你确定需要打电话`base.OnBeforeSelect`吗？如果是这样，你可能想`e.Cancel = true;`先打电话。

# twitter-bootstrap - 推特引导警报不起作用

> ID：14386466
> 
> 赞同：0
> 
> 时间：2013-01-17T19:19:01.227
> 
> 标签：twitter-bootstrap

我是新手。我希望在加载时显示一个警报框。它没有。这是jsfiddle。怎么了？谢谢！

[http://jsfiddle.net/4XZMb/1207/](http://jsfiddle.net/4XZMb/1207/)

```
<div class="container">
    <div class="hero-unit">
        <h1>Bootstrap jsFiddle Skeleton</h1>
        <p>Fork this fiddle to test your Bootstrap stuff.</p>
        <p>
            <a class="btn btn-primary btn-large" href="http://twitter.github.com/bootstrap/index.html" target="_blank">
                Learn more about Bootstrap
            </a>
        </p>
    </div>
<div id="CanUseIPhoneAppPrompt" title="Please use the iPhone App." class="alert fade">    
      please try our iphone app                                      
</div> 
```

和代码：

```
$(function() {
    $("#CanUseIPhoneAppPrompt").alert();
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T19:30:36.120

`fade`在这里工作，只是删除类`div#CanUseIPhoneAppPrompt`

# java - Selenium WebDriver 设置 ImplicitlyWait 什么都不做

> ID：14386470
> 
> 赞同：2
> 
> 时间：2013-01-17T19:19:14.470
> 
> 标签：java, firefox, selenium, selenium-webdriver

这是我在 Java 中的全部测试类，减去导入。

```
public class GoogleTest {

private WebDriver driver;

@Before
public void setUp() {
    driver = new FirefoxDriver();
    driver.manage().timeouts().implicitlyWait(5, TimeUnit.SECONDS);
}

@Test
public void testGoogleTest() throws Exception {
    driver.get("http://www.google.com");
    driver.findElement(By.id("I don't exist"));
}

@After
public void tearDown() throws Exception {
    driver.quit();
    }
} 
```

据我了解，implicitlyWait 命令应该在 5 秒后使用“ElementNotFound”使测试错误消失。这不会发生。它确实打开了一个 FF 窗口，进入谷歌，然后永远坐在那里。如果我关闭浏览器窗口，它将引发 UnreachableBrowser 异常（正如我所料）。我尝试过使用不同的时间单位，但没有任何区别。我正在使用硒 2.25。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T20:58:10.993

这似乎是 Selenium`2.25`和 Selenium的错误`2.26`，因此请尝试更新为`2.27`

# regex - 在开头的每第二行添加一个字符而不替换第一个字符（这是随机的）

> ID：14386472
> 
> 赞同：0
> 
> 时间：2013-01-17T19:19:17.547
> 
> 标签：regex, notepad

我有一个看起来像这样的大文件：

```
100]
Armor=769       
101]
Armor=769       
102]
Armor=769       
103]
Armor=772       
104]
Armor=772       
108]
Armor=770       
109]
Armor=773       
110]
Armor=773       
114]
Armor=771       
115]
Armor=774       
116]
Armor=774       
242]
Armor=778       
243]
Armor=779 
```

我已经在玩记事本++了，这就是我得到这个结果的方式，但现在我被困住了。我想要的是：每第二行添加一个 [ , so `100]`，`101]`现在`102]`用括号括起来。我不能只搜索“1”并替换为 [1 ，数字是随机的，并且会变得更大。我想我必须在这里使用正则表达式，这是一个问题，因为我不知道怎么做！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T19:22:02.783

> 我不能只搜索“1”并替换为 [1，数字是随机的

然后在一行的开头搜索，`\d`在第1组中捕获，并将其替换为 - `[$1`，其中`$1`是捕获组。

替换 -`^(\d)`与`[$1`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T19:30:44.443

匹配 123] 行的正则表达式将是

```
^[[:space:]]*[0-9]+[[:space:]]*\][[:space:]]*$ 
```

意思是：

^ 匹配必须从行首开始。
[[:space:]]* 外部 [] 表示括号内的任何单个字符 [:space:] 是 posix 表达式，表示所有空格字符制表符等 * 表示前一个字符的 0 个或多个 [0-9] + 表示 0 到 9 之间的 1 个或多个数字 [[:space:]]* 同上 ] 文字 ] [[:space:]]* 同上 $ 必须匹配行尾

希望这可以帮助

# ios - 触摸状态栏时 UIScrollView 滚动到底部

> ID：14386476
> 
> 赞同：0
> 
> 时间：2013-01-17T19:19:29.743
> 
> 标签：ios, objective-c, user-interface, uiscrollview

我试图弄清楚当状态栏被触摸时如何滚动到 UIScrollView 的底部。我熟悉 UIScrollView 中的 @property(nonatomic) BOOL scrollsToTop 方法，但这不是我要找的。

我这里也有这个方法，当视图加载时会自动滚动到底部。有什么想法吗？

```
-(void)scrollToBottom{
CGPoint bottomOffset = CGPointMake(0, scroller.contentSize.height - scroller.bounds.size.height);
[scroller setContentOffset:bottomOffset animated:YES];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T19:40:23.147

类似于[如何检测状态栏中的触摸](https://stackoverflow.com/questions/3753097/how-to-detect-touches-in-status-bar)。这里建议在状态栏上使用透明的 UIView 并检测触摸。

# javascript - 使用 javascript 填充文本区域

> ID：14386483
> 
> 赞同：-1
> 
> 时间：2013-01-17T19:20:07.217
> 
> 标签：javascript, jquery

基本上我正在使用 SCEditor 并想要一个名为“引用”的论坛帖子或文章评论上的按钮，它从消息中获取文本并将其粘贴到 textarea 中，我有这个代码：

```
<script type="text/javascript">
jQuery.noConflict(); //disable global $ for jQuery
jQuery(document).ready(function($){
    $(function(){
    $('#quote').click(function() {
        $('textarea').sceditor('instance').insert("[quote=admin]Some text[/quote]");
    });
    });
});
</script> 
```

现在可以了，它会将“[quote=admin]Some text[/quote]”放入文本区域。问题是我需要它以某种方式是动态的，所以如果有意义的话，我不必在每条评论上方复制该代码？所以代替这个：

```
insert("[quote=admin]Some text[/quote]"); 
```

该部分会从它下面的框中获取所有文本吗？而不是我手动将引用的位替换为帖子中的文本。

所以基本上用点击引用链接的不同div的内容替换上面引用的位？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T19:53:31.343

您可以使用像这个简单示例中的正则表达式

```
<textarea id="ta" rows="5" cols="20">
  [quote=admin]Some text[/quote]
</textarea>
<br />
<input type="button" value="Click Me" onclick="rep()" />
<br />
<div id="dv" style="width:100px; height:100px; border:black 1px solid;">
  Some div content
</div>

<script type="text/javascript">
  function rep() {
    var tatxt = $("#ta").val();
    var dvtxt = $("#dv").html();
    var newtxt = tatxt.replace(/\[quote\=admin\].*?\[\/quote\]/ig, dvtxt);
    $("#ta").val( newtxt );
  }
</script> 
```

[你可以看到它在这里工作](http://jsfiddle.net/h9rgf/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T20:03:05.510

这取决于您的条目的结构。假设“quote”按钮和 div id="entry" 位于同一级别，嵌套在父容器或另一个容器内。

```
<div id="wholeThing">
    <div id="entry"> ....... </div>
    <!-- other stuff goes here -->
    <input type="button" name="quote" ......>
</div> 
```

然后你可以这样做：

```
$(this).parent().find("#entry").text(); 
```

如果您确切知道内容所在的位置，则可以遍历层次结构中的先前元素。

```
$(this).prev().prev().text(); // if content container is 2 elements in front 
```

对于按钮单击处理程序，您可以设置一个类或使用其名称属性：

```
$('div input[name="quote"]').click(function() {  // for name attribute
    $('textarea').sceditor('instance').insert("[quote=admin]Some text[/quote]");
}); 
```

类等于所有“引用”按钮：

```
$('.className').click(function(){ ... 
```

如果它是每个条目中唯一的输入元素：

```
$('div input').click(function() { ... 
```

# java - 将域逻辑与 GUI 技术分离的架构？

> ID：14386484
> 
> 赞同：0
> 
> 时间：2013-01-17T19:20:17.607
> 
> 标签：java, user-interface, architecture

我们想用 Java 实现一个 GUI，这将是技术独立的。

因此，构建 WebFrontEnd 将导致实现一些额外的渲染器，而无需重新实现 GUI。

我们应该使用哪些架构模式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T19:26:21.653

您应该从[查看模型-视图-控制器设计模式](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller)开始。

# php - 仅将 .csv 文件从外部 FTP 服务器下载到我的 ftp 服务器

> ID：14386485
> 
> 赞同：0
> 
> 时间：2013-01-17T19:20:21.410
> 
> 标签：php, ftp

我有一个连接到外部 ftp 服务器并下载文件夹内容的脚本。

目前它将下载文件夹中的所有文件。如何修改以下脚本以仅下载和处理 .csv 文件并忽略任何其他文件？

我的脚本是（100% 有效）：

```
$timenow=time();
$ftp_server = "ftp.domain.com";  
$conn_id = ftp_connect($ftp_server);  
$ftp_user_name = "username";  
$ftp_user_pass = "password";  
$login_result = ftp_login($conn_id, $ftp_user_name, $ftp_user_pass);  
$contents = ftp_nlist($conn_id, 'LoadsOverWB'); 
$targetnameprocesses ="LoadsOverWB-$timenow.csv";

$filename = $contents[0]; 

echo "<br><font color=blue><b>Import into LOC MySQL.....</b></font><br>";
// import file
if ((empty($filename))) { echo "$filename not existing to import.";} else {
$source = "LoadsOverWB/$filename";
 $target = fopen("$filename", "w");

$conn = ftp_connect("ftp.hulamin.co.za") or die("Could not connect");
 ftp_login($conn,"TransportLogistics","Qaz1234");

ftp_fget($conn,$target,$source,FTP_ASCII);

echo "file downloaded. <br>"; 
```

一如既往地感谢您的帮助，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T19:32:14.587

试试这个：

```
if ('.csv' == strtolower(substr($filename, -4))) { //Get the file } 
```

# javascript - 使用 $.get 引导进度条

> ID：14386487
> 
> 赞同：2
> 
> 时间：2013-01-17T19:20:40.167
> 
> 标签：javascript, jquery, jsp, twitter-bootstrap

我意识到 SO 上已经存在大量与进度条相关的问题。我浏览了其中许多，但无法正常工作。

简而言之，我正在 JSP 中开发一个页面，并且我想在引导程序中使用动画进度条来显示在对数据进行调用时。

HTML：

```
<div class="row-fluid">
   <div class="span12 progress progress-striped active">
      <div id="searchAnimation" class="bar" hidden="true"></div>
   </div>
</div> 
```

Servlet（不确定这部分是否相关，但比抱歉更安全）：

```
@Override
protected void doGet(HttpServletRequest request, HttpServletResponse response)
    throws ServletException, IOException
{
    //String that gets returned as HTML
    StringBuilder returnAsHTML = new StringBuilder();

    //See if the class is closed, has a lab, or is just a regular class
    for(ClassInfo classes : springClassListings)
    {
        //Class is full, style accordingly
        if(classes.getSectionMeetingInfo().contentEquals("LEC") && classes.getSectionEnrolled().contentEquals("0"))
        {
            returnAsHTML.append(closedClass(classes));
        }
        else if(classes.getSectionMeetingInfo().contentEquals("LAB")) //These are labs, style accordingly
        {
            returnAsHTML.append(labClass(classes));
        }
        else //These are normal classes without lab components
        {
            returnAsHTML.append(openClass(classes));
        }

    }

    response.setContentType("text/html");
    response.setCharacterEncoding("UTF-8");
    response.getWriter().write(returnAsHTML.toString());
} 
```

还有我的脚本：

```
//Serves up the data
$('#btnData').click(function() {

    //THIS IS THE PROGRESS BAR
    $("#searchAnimation").show();

    $.get('daoServlet', function(responseText) {
        $('#dataDisp').html(responseText);
    });

}); 
```

我明白了，就获取数据而言，进度条的宽度百分比是 $.get 调用所在的位置。我只是不明白该怎么做。

PS - 我知道我在 doGet 中的 for/if 是一个讨厌的反模式，我只是还没有想出解决它的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T19:49:33.617

我认为 ajaxStart 在事件中包含百分比信息。但即使它不可能以 100% 隐藏/显示动画进度条以指示其正在加载某些内容。

ajaxStart 文档 [http://api.jquery.com/ajaxStart/](http://api.jquery.com/ajaxStart/)

进度文档 [http://twitter.github.com/bootstrap/components.html#progress](http://twitter.github.com/bootstrap/components.html#progress)

如果你加载的东西不使用 ajax，你也可以抛出 ajaxStart 事件来触发你的组件隐藏和显示。

# intellij-idea - 使用 IntelliJ 区分两个任意文件

> ID：14386488
> 
> 赞同：74
> 
> 时间：2013-01-17T19:20:40.387
> 
> 标签：intellij-idea, diff

我真的很喜欢 IntelliJ diff 工具。我想知道是否可以使用此工具来区分两个任意文件。即不在 IntelliJ 项目中的文件。只需在文件系统中选择两个文件并进行比较？如果我想区分两个字符串怎么办？在我的文本编辑器中，我只需创建两个新文档，将文本粘贴到其中并进行比较，然后在完成后不保存文件。这可能吗？

谢谢

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2013-01-19T08:32:59.427

找到这个命令行：

**在 MacOSX 上：（IDEA EAP 11）**

```
/Applications/IntelliJ\ IDEA\ 11.app/Contents/MacOS/idea diff /Users/ben75/file1.txt /Users/ben75/file2.txt 
```

在 MacOSX 上，IDEA (11) 打开时无法运行。

**在 Windows 上：（IDEA EAP 12）**

```
"C:\Program Files (x86)\JetBrains\IntelliJ IDEA 12.0\bin\idea.exe" diff C:\Users\ben75\file1.txt C:\Users\ben75\file2.txt 
```

即使 IDEA 已经打开，它也会运行。

尝试比较没有扩展名（或不匹配的扩展名）的文件时遇到问题

**直接来自 IDEA (EAP 12)**

不是那么容易，但它确实有效......

*   文件 > 打开... > 选择“file1.txt”
*   文件 > 打开... > 选择“file2.txt”
*   创建一个“收藏夹列表”并将这两个文件添加到此收藏夹列表中。（要做到这一点：ctrl+右键单击编辑器中的文件名选项卡 > 添加到收藏夹 > 选择刚刚创建的收藏夹列表 - 见截图）
*   最后，打开“收藏夹”视图（Alt+2 或单击左侧或您的 IDEA 窗口）。
*   选择两个文件
*   右键单击：“比较两个文件”（或 ctrl+D）

![添加到收藏夹](../Images/e49c40a561854afd8760d706bf58bf59.png)

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2014-01-21T23:42:30.737

IntelliJ Idea 13 具有标记为**与剪贴板比较**的功能。此功能将当前打开的文件与您复制到剪贴板的版本进行比较。这是一种轻松比较和合并两个文件的好方法。它也可以用来比较两个任意的代码块。无法弄清楚为什么一个块有效而另一个块不起作用？使用此功能。

此选项位于**View > Compare with Clipboard**下。我分配了一个易于记忆的键盘快捷键，让我可以快速访问此功能。

![查看 > 与剪贴板比较](../Images/578f4a721cd9dd1aa15e1850ed758974.png)

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2013-10-24T20:12:18.237

*在项目*面板中选择 2 个文件，**然后按`CTRL`+`D`**。

[![在此处输入图像描述](../Images/5aa2b7881cd6924942961cf6ba87567c.png)](https://i.stack.imgur.com/gsBwH.gif)

* * *

## 回答 #4

> 赞同：33
> 
> 时间：2018-11-20T16:04:17.720

**从 2018.2 开始，IntelliJ 正式支持它**：

**对于 Windows：** Ctrl + Shift + A，然后键入“打开空白差异窗口”

[![在此处输入图像描述](../Images/d37b1479423efff0b763f10cb36da3c5.png)](https://i.stack.imgur.com/wOKcM.png)

[![在此处输入图像描述](../Images/b7b496521ec502e0d0ebbc79c755d427.png)](https://i.stack.imgur.com/ScnNB.png)

**对于 Mac：** Cmd + Shift + A 然后键入“打开空白差异窗口”

[![在此处输入图像描述](../Images/472f0ff106c7bc6f11ef4b0ddbd93b31.png)](https://i.stack.imgur.com/v8LXs.png)

[![在此处输入图像描述](../Images/d5c9c32a71b6ceba4a7898754b8e195c.png)](https://i.stack.imgur.com/ygUOb.png)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2018-07-27T13:09:00.557

在 IntelliJ IDEA 2018.2 中，您可以打开一个空白的差异查看器，并将您想要比较的任何文本粘贴到其左右面板中。可以在 Find Action 对话框中找到新的 Open Blank Diff Viewer 操作。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2018-11-09T23:26:08.723

从终端，您可以像这样直接使用想法启动器：

```
# Windows
idea.exe diff path1 path2

# MacOS/Linux
idea diff path1 path2 
```

至少对于 MacOS（我不确定 Windows），如果您通过“工具 -> 创建命令行启动器...”创建了命令行启动器，它就像以下一样简单：

```
# Create some files to diff
echo "This is line 1" > file1.txt
echo "This is line 2" > file2.txt

# Diff with IntelliJ
idea diff file1.txt file2.txt 
```

请注意，这也适用于其他 JetBrains 应用程序；例如，使用 WebStorm 或 PyCharm：

```
# Diff with WebStorm
webstorm diff file1.txt file2.txt
# Diff with PyCharm
charm diff file1.txt file2.txt 
```

[参考](https://www.jetbrains.com/help/idea/command-line-differences-viewer.html)

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2020-04-07T19:34:22.710

如果您需要将打开的文件与文件系统上的任意文件进行比较，我发现了更好的方法：

*   在第一个文件的编辑器中，比如说 A.java。
*   Ctrl+Shift+A，你会看到： [![动作搜索列表](../Images/b84c5e5951dc4a4637dded39a2bf32d7.png)](https://i.stack.imgur.com/TipSA.png)
*   选择第二个“比较...”选项，您将获得“选择路径”对话框： [![选择路径对话框](../Images/0e6c447579a73e14e1d78305bb938db4.png)](https://i.stack.imgur.com/MXKTm.png)
*   选择硬盘上的任何文件并确认，您将获得差异窗口： [![将带有任意文件的窗口与最初选择的窗口进行比较](../Images/3e80f5553faa0ad96030725290fe18af.png)](https://i.stack.imgur.com/AtaqD.png)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2013-01-17T19:53:27.800

是的，您可以（当然，如果我们谈论的是`text`文件）。但可能您需要创建一些项目（仅用于打开那里的文件）。

那么你的步骤将是：

1) 添加到创建的项目文件#1 和文件#2。

2) 在编辑器中打开文件#1

3) 在文件#2 的左侧菜单（项目文件浏览器）中右键单击鼠标并找到 menu-item `Compare File with Editor`。

![在此处输入图像描述](../Images/18929225f00217f778bbbf3ed0c42b91.png)

就这样。在 p.3) 之后，将打开一个比较窗口。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2017-11-06T17:12:24.243

为了比较两个都不在项目中的文件，以下适用于我在 Windows 上的 IntelliJ IDEA Ultimate 14.1.7 中：

1.  在 IDE 中打开第一个文件（通过从 Windows 资源管理器拖动到窗口中，或通过文件/打开）。
2.  在视图菜单中，选择“比较...”
3.  在出现的“选择路径”对话框中，选择第二个文件（直接选择，或从 Windows 资源管理器中拖动到对话框中）。

然后它会在传统的文件比较窗格中打开。如果您尝试编辑其中一个文件，它会显示通常的“您确定要编辑不在您的项目中的文件”对话框，如果您正在尝试这样做，则可以接受该对话框。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-03-08T17:27:37.547

只需选择项目结构中的两个文件并点击：

**窗口：** ctrl+D

**Mac：** 命令+D

# c# - 将xml转换为字典错误

> ID：14386492
> 
> 赞同：0
> 
> 时间：2013-01-17T19:21:09.090
> 
> 标签：c#, xml, linq-to-xml

以前也有人问过类似的问题，但我找不到我遇到的问题的答案。

我想使用 linq xml 函数将我的 config.xml 设置转换为字典，但总是得到`Possible System.NullReferenceException`. 所以，我需要检查属性及其值是否存在。

这样做的语法是什么？

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <Services>
    <add key ="key1"   value ="value1"></add>
    <add key ="key2"   value ="value2"></add>
    <add key ="key3"   value ="value3"></add>
 </Services>
</configuration> 
```

我的 lambda 代码：

```
XDocument doc = XDocument.Load(configFilePath);
var d = (from name in doc.Descendants("Services") select name)
         .ToDictionary(n =>  n.Attribute("key")
         .Value, n.Attribute("value")
         .Value); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T19:31:46.253

使用`Descendants("add")`代替`Descendants("Services")`

```
var dict = XDocument.Load(configFilePath)
        .Descendants("add")
        .ToDictionary(n => n.Attribute("key").Value, n=> n.Attribute("value").Value); 
```

* * *

```
var dict = XDocument.Load(configFilePath)
       .Descendants("Services").First()
       .Descendants("add")
       .ToDictionary(n => n.Attribute("key").Value, n=> n.Attribute("value").Value); 
```

# jquery - 使用 $.each 遍历数组值不起作用

> ID：14386493
> 
> 赞同：0
> 
> 时间：2013-01-17T19:21:19.570
> 
> 标签：jquery, arrays, each

我一直在试图弄清楚如何通过以下代码进行迭代。

> 变量 arr = []
> 
> $.ajax({
> 
> ```
>  type: 'POST',
>    dataType: 'html', 
>    url:   '/test/public/index/getid', 
>    success: function(response) {
>         response = $.parseJSON(response)
>         $.each(response, function(index, value) {
>              arr.push(value)
> 
>         });
>    } 
> ```
> 
> });
> 
> 控制台日志（arr）
> 
> $.each(arr, function(index0, value0) {
> 
> console.log('INDEX0: ' + value0);
> 
> });

这会给我一个关于萤火虫的 [ ] ，我可以扩展它。然后它有 0 和 1 并显示 id

[ ]

0 1234343

1 2343223

2 414234

3 232342

但后来在程序中，我尝试用 $.each 循环它，它不会读取它。

通过 console.log 打印时，我试图让 arr 看起来像这样。

[“1234343”、“2343223”、“414234”、“232342”]

里面的值是在第一个循环上推送的 id。

关于如何做到这一点的任何想法？试图获得 arr.length 并将其用作测试条件。

原始 JSON 响应：[“1234343”、“2343223”、“414234”、“232342”]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T19:31:40.623

Ajax 是异步的，不要尝试在成功回调之外访问 ajax 请求中的数据。

```
$.ajax({
   type: 'POST',
   dataType: 'json', 
   url: '/test/public/index/getid', 
   success: function(arr) {
       console.log(arr);
   }
}); 
```

你也可以这样做：

```
var request = $.ajax({
    type: 'POST',
    dataType: 'json', 
    url: '/test/public/index/getid'
});
request.done(function(arr){
    console.log(arr);
}); 
```

第二种方法可以让您在`request`任何需要的地方传递和使用它，只需执行以下操作：

```
request.done(function(arr){
    // do something with arr
    console.log(arr)
}); 
```

更新评论，

如果请求 2 依赖于请求 1，请使用以下结构：

```
var request1 = $.ajax({...});

request1.done(function(){
    var request2  = $.ajax({...});
    request2.done(function(){
        // both are done, do stuff
    });
}); 
```

或者，如果您想发送请求 1 和 2，然后在两者都完成后执行某些操作，您可以这样做：

```
var request1 = $.ajax({...});
var request2 = $.ajax({...});
$.when(request1,request2).done(function(req1,req2) {
    // do stuff
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T19:29:30.277

```
var arr = []

var callback = function(arr){
       console.log(arr);
};

$.ajax({

 type: 'POST',
   dataType: 'html', 
   url:   '/test/public/index/getid', 
   success: function(response) {
        response = $.parseJSON(response)
        $.each(response, function(index, value) {
             arr.push(value)

        });
        callback(arr);
   }
}); 
```

为什么不做这样的事情？

你主程序执行。

*   你定义了一个数组
*   然后你打一个ajax调用
*   然后你记录 arr。

第二步是异步过程，主程序执行不会因为ajax调用而停止，不管ajax调用是否完成都会继续执行。因此，在`console.log(arr)`执行时，您的 ajax 调用可能/可能不会返回，留下一个空`arr`变量记录到控制台。这可能是您看不到任何内容的原因，因为记录了一个空数组。

使用回调函数，您可以确保`arr`仅在 ajax 调用返回并且您已填充`arr`.

# java - Struts 通配符与 Tiles 通配符 NoSuchDefinitionException

> ID：14386499
> 
> 赞同：2
> 
> 时间：2013-01-17T19:21:52.287
> 
> 标签：java, struts2, wildcard, tiles

我在我的 Struts2 项目中使用图块来动态生成我的布局。问题是，我的tiles.xml 文件中有很多冗余。所以我决定在瓷砖中使用通配符来解决这个问题。

[我阅读了本教程](http://struts2.myxwiki.org/xwiki/bin/view/Struts2/Tiles+2.2.2+Integration)并按照所有说明进行操作。我使用 maven 创建了我的 webapp。请看我的配置文件。

当我调用此链接时：

```
localhost/test -> it works
localhost/** -> it works
localhost/test2 -> it does not work anymore, so wildcard was not called 
```

请帮我。我不知道如何解决这个问题。谢谢！

1.  pom.xml

    ```
     <project xmlns="http://maven.apache.org/POM/4.0.0" 
                 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                 xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 
                                     http://maven.apache.org/maven-v4_0_0.xsd">
      <modelVersion>4.0.0</modelVersion>
      <groupId>projectName</groupId>
      <artifactId>tilesWildcard</artifactId>
      <packaging>war</packaging>
      <version>0.0.1-SNAPSHOT</version>
      <name>tilesWildcard Maven Webapp</name>
      <url>http://maven.apache.org</url>
      <dependencies>
        <dependency>
          <groupId>junit</groupId>
          <artifactId>junit</artifactId>
          <version>3.8.1</version>
          <scope>test</scope>
        </dependency>
        <dependency>
            <groupId>org.apache.struts</groupId>
            <artifactId>struts2-core</artifactId>
            <version>2.3.8</version>
        </dependency>
        <dependency>
            <groupId>org.apache.struts</groupId>
            <artifactId>struts2-tiles-plugin</artifactId>
            <version>2.3.8</version>
        </dependency>
      </dependencies>
      <build>
        <finalName>tilesWildcard</finalName>
      </build>
    </project> 
    ```

2.  src/main/resources/struts.xml

    ```
    <?xml version="1.0" encoding="UTF-8"?>
    <!DOCTYPE struts PUBLIC
        "-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"
        "http://struts.apache.org/dtds/struts-2.0.dtd">

    <struts>
        <constant name="struts.devMode" value="true" />
        <constant name="struts.ui.theme" value="simple" />
        <constant name="struts.enable.SlashesInActionNames" value="true" />
        <constant name="struts.mapper.alwaysSelectFullNamespace" value="false"/>
        <package  name="basicstruts2"  namespace="" extends="tiles-default">
            <result-types>
                <result-type name="tiles" default="true" 
                             class="org.apache.struts2.views.tiles.TilesResult"/>
            </result-types>

            <action name="/**" >
                <result>{1}</result>
            </action>
        </package>
    </struts> 
    ```

3.  /WEB-INF/tiles.xml

    ```
    <?xml version="1.0" encoding="UTF-8"?>
    <!DOCTYPE tiles-definitions PUBLIC
           "-//Apache Software Foundation//DTD Tiles Configuration 2.1//EN"
           "http://tiles.apache.org/dtds/tiles-config_2_1.dtd">
    <tiles-definitions>
        <definition name="baseLayout" template="/WEB-INF/tiles/template.jsp">
            <put-attribute name="title" value="Default Title"/>
            <put-attribute name="header" value="/WEB-INF/tiles/header.jsp"/>
            <put-attribute name="body" value="/WEB-INF/tiles/body.jsp"/>
            <put-attribute name="footer" value="/WEB-INF/tiles/footer.jsp"/>
        </definition>
        <definition name="test" extends="baseLayout">
            <put-attribute name="Test Title" value="Default Title"/>
        </definition>
        <definition name="package/*" extends="baseLayout">
            <put-attribute name="title" value="{1}" type="string"/>
        </definition>
        <definition name="" extends="baseLayout">
        </definition>
    </tiles-definitions> 
    ```

4.  文件结构

    ```
    /WEB-INF
      /tiles/body.jsp
      /tiles/footer.jsp
      /tiles/header.jsp
      /tiles/template.jsp 
    ```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T07:12:39.180

很抱歉回复很晚，但您正在调用：localhost/test2，但磁贴定义是“package/*”，因此您需要调用 localhost/package/test2

# css - Chrome 疯狂的边框间距

> ID：14386501
> 
> 赞同：1
> 
> 时间：2013-01-17T19:21:54.893
> 
> 标签：css, google-chrome

我已经对此进行了测试和测试。在 FF 和 IE9 中这工作正常，但在 Chrome 中不遵守以下 CSS。

```
 border-collapse: separate !important;
 border-spacing: 5px 15px !important; 
```

这是 2 秒后的样子……这就是它的样子**！**

![在此处输入图像描述](../Images/4e3c742094cac1c65564c0c17b95bef1.png)

***之后就变成这样了？！？！*** ![在此处输入图像描述](../Images/fe559a8baa7c63f2095617f33360517e.png)

您可以在 www.polarpumpen.se/luftvarmepumpsguide 试用该网站

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T19:34:19.430

问题似乎是你正在制作你的`#searchtable` `display:inline`(stylesheet.css:30)，它似乎没有任何目的，所以你可以删除它，问题就会消失。

# ios - 将选定的单元格标题添加到 NSMutableArray

> ID：14386503
> 
> 赞同：1
> 
> 时间：2013-01-17T19:21:57.870
> 
> 标签：ios, uitableview

我编写了下面的代码来为我的表格视图中的每个单元格添加 UILabel 的所有标题，但是我不确定如何继续。由于索引部分，我得到了错误。

先感谢您

```
- (IBAction)addAllCellLabelNamesToList:(UIButton *)sender {
    NSMutableArray*selected=[[NSMutableArray alloc]init];
    for (int i =0;i<[_mainTable numberOfRowsInSection:0];i++) {
        ListCell*cell=[_mainTable cellForRowAtIndexPath:i];//not usre what to put here
        if (!cell.isSelected) {//if selected add to array
            [selected addObject:cell.ingredientLabel.text];
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T19:28:49.623

`UITableViewDataSource#tableView:cellForRowAtIndexPath:`接受一个`NSIndexPath`参数，而不是简单的`int`.

试试下面的代码：

```
[_mainTable cellForRowAtIndexPath:[NSIndexPath indexPathWithIndex:i]] 
```

# iphone - 常规/组 UITableViewCell 中的字符数

> ID：14386507
> 
> 赞同：0
> 
> 时间：2013-01-17T19:22:02.973
> 
> 标签：iphone, ios, cocoa-touch, uitableview

是否有任何标准方法可以知道 UITableViewCell 在常规和组表视图中可以在一行（不换行）中占据的字符数？基本上是一些带有文本字体大小和字符数的图表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T19:38:15.523

UITableViewCell 中没有字符之类的东西。您大概关心 UITableViewCell 中某些界面对象中的字符 - 例如，它可能是 UILabel。牢房——至少，你提出问题的方式——是无关紧要的。

如果是这种情况，您可以使用标签的功能来了解给定的文本是否会换行。如果您使用的是普通的 NSString，请查看 NSString UIKit Additions Reference 中的字符串绘制方法。如果您使用的是 NSAttributedString，请查看 NSAttributedString UIKit Additions Reference 中的绘图方法。提供的方法告诉您在给定的字体中，使用给定的换行选项，当限制为给定的宽度时，给定的字符串将占用多少空间 - 您可以从标签中获取所有这些信息。您保证标签使用相同的字符串绘制方法，因此您得到的结果将是正确的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T19:29:25.120

除非字体是固定宽度的，否则不能只使用字符数和文本大小。

您需要使用以下方式显示字符串并询问其大小：

```
NSString *stringToCheck = @"...";
CGSize size = [stringToCheck sizeWithFont:[UIFont systemFontOfSize:[UIFont systemFontSize]]];

// Check the table view cell size available
CGSize cellSize = cell.contentView.bounds.size; 
```

# android - ViewPager 数据保留

> ID：14386509
> 
> 赞同：0
> 
> 时间：2013-01-17T19:22:06.467
> 
> 标签：android, android-fragments, android-viewpager

我是使用Android 的`ViewPagers`新手。`Fragments`我的应用程序的初始活动有一个`ListView`，然后转到另一个活动，该活动基本上是`ListView`基于从 inital 传递的 id过滤的`ListView`。我希望用户能够在不同的 filter 之间滑动`ListViews`。这可能是我普遍缺乏理解，但我的`ViewPager`功能工作正常，但是当我点击过滤中的一个项目时，`ListView`我收到一个错误，因为我有一个值集合，我作为成员变量存储在整个类中引用，并且在使用`ViewPager`.

这是我到目前为止的代码：

清单片段.class：

```
public class ListingFragment extends SherlockFragmentActivity
{
    private ViewPager mViewPager;  
    private MyFragmentPagerAdapter mMyFragmentPagerAdapter; 
    private static List<Fragment> fragments;

    @Override
    public void onCreate(final Bundle icicle)
    {    
        super.onCreate(icicle);

        setContentView(R.layout.main);

        mViewPager = (ViewPager)findViewById(R.id.viewpager);  
        mMyFragmentPagerAdapter = new MyFragmentPagerAdapter(getSupportFragmentManager());  
        mViewPager.setAdapter(mMyFragmentPagerAdapter);

        DetailsFragment df1 = DetailsFragment.newInstance(1);
        fragments.add(df1);

        DetailsFragment df2 = DetailsFragment.newInstance(2);
        fragments.add(df2);
    }

    private static class MyFragmentPagerAdapter extends FragmentPagerAdapter {  

        public MyFragmentPagerAdapter(FragmentManager fm) {  
             super(fm);  
        }  

        @Override  
        public Fragment getItem(int index) {  

            return fragments.get(index);
        }  

        @Override  
        public int getCount() {  
             return 2;  
        }  
   }
} 
```

DetailsFragment.class

```
public class DetailsFragment extends SherlockFragmentActivity
{
    private int detailId;
    private static List<Integer> items;

    @Override
    public void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);         
    }

    @Override
    public void onActivityCreated(final Bundle icicle)
    {    
        super.onActivityCreated(icicle);
    }

    public static DetailsFragment newInstance(int id) {

        DetailsFragment lf = new DetailsFragment();
        Bundle bundle = new Bundle();
        bundle.putInt("id", id);
        lf.setArguments(bundle);
        return lf;
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {

        View view = inflater.inflate(R.layout.listing, container, false);

        detailId = getArguments().getInt("id");         

        items = GetItems();

        return view;
    }

    @Override
    public void onListItemClick(ListView l, View v, int position, long id)
    {
        super.onListItemClick(l, v, position, id);

        final Integer item = items.get(pos); //this is always empty
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T19:30:37.230

您将**int position**传递给 onListItemClick() 方法，但在 get() 方法中使用**pos**。尝试更换

```
final Integer item = items.get(pos); 
```

和

```
final Integer item = items.get(position); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T19:55:22.783

您的代码有问题，但它应该可以工作：

检查你的名字，你有`ListingFragment`哪些扩展名`SherlockFragmentActivity`似乎是一个`Activity`（如果是一个，`Activity`那么你选择了一个糟糕的名字），你也有`DetailsFragment`哪些扩展名`SherlockFragmentActivity`似乎是一个`Fragment`

不要为`ViewPager`' 的适配器使用片段列表，这最初会起作用，但如果你旋转手机，你会遇到麻烦。您可以使用该列表，但您需要对适配器进行某些修改。

不要这样做`items` `static` ，因为当您`DetaildFragment`对适配器的两个页面使用相同的类时，`items`列表将始终指向由`GetItems()`.

最后，关于这个`items`问题，你能分享一个异常的堆栈跟踪吗？您是否测试过`GetItems`它是否返回包含所有数据的有效列表？

# html - Chrome CSS 图像过渡会影响其他元素

> ID：14386512
> 
> 赞同：1
> 
> 时间：2013-01-17T19:22:17.023
> 
> 标签：html, css, google-chrome, css-transitions

我有一个菜单，其中包含图像作为悬停动画按钮的背景。
问题是，当我将鼠标悬停在图像上并且它被动画（放大和旋转）时，页面上的其他元素会在没有明显原因的情况下增加几个像素。

我创建了一个 JSfiddle，希望我可以重现我网站上存在的错误（页面上的其他图像被移动）并且仍然给你一个不太长的代码。

结果：嗯... JSfiddle`result`文本无缘无故地移动，而不是图像获得高音，而 CSS 的滚动条闪烁。

[http://jsfiddle.net/AaXyV/1/](http://jsfiddle.net/AaXyV/1/)

**YouTube** : 0:10 秒的[演示视频](http://youtu.be/2sZIRkUpNqw?t=9s)

漏洞？修复？

试用：Chrome 24.0.1312.52 m，在其他浏览器（包括 Safari）中似乎可以正常工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T20:45:31.743

我无法重新创建抖动结果跨度，但我确实看到了闪烁的滚动条。看起来它可能是一个已知的错误：

[问题 139928：显示“inline-block”的元素宽度上的 CSS 过渡会导致抖动](http://code.google.com/p/chromium/issues/detail?id=139928)

# php - 使用“毒药”模式的 mysql 标记查询

> ID：14386514
> 
> 赞同：0
> 
> 时间：2013-01-17T19:22:26.513
> 
> 标签：php, mysql, tags

我正在构建一个基于[toxi schema](http://tagging.pui.ch/post/37027745720/tags-database-schemas)标记的站点。但是我在生成一个根据标签获取链接/书签的查询时遇到了困难。使用“Toxi”，链接/书签表不包含任何标签 ID 信息，而是将该信息存储在 tag_map 中。我需要形成一个查询，我可以在其中显示与特定 tag_id 匹配的链接（通过 tag_map）。谁能指出我正确的方向？

```
 `links`

  `link_id` 
  `link_title`
  `link_owner_id`
  `link_url`
  `link_description` 
  `link_datecreated`

`tags`

  `tag_id` 
  `tag_title` 
  `tag_description` 
  `tag_owner_id`

 `tag_map`

  `map_id` 
  `map_link_id`
  `map_tag_id` 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T19:25:33.537

```
SELECT  l.*
FROM    tag_map tm
JOIN    links l
ON      l.link_id = tm.map_link_id
WHERE   tm.map_tag_id = @my_tag_id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T21:02:37.473

如果您使用 InnoDB 引擎，那么不使用关系（链接到标签的关系）不是一个好的决定。

关系始终包含您的数据一致性

但是如果你也想选择无关系，你可以使用 Transaction 或 trigger 插入数据

然后尝试以下查询以检索数据

```
 SELECT tag_map.map_id,tags.tag_title,links.link_title FROM tag_map
LEFT JOIN tags
ON tag_map.map_tag_id=tags.tag_id
LEFT JOIN links
ON tag_map.map_link_id=links.link_id    
```

# .net - 适用于 .Net Framework 4 的 SAP Crystal Reports 运行时引擎

> ID：14386516
> 
> 赞同：0
> 
> 时间：2013-01-17T19:22:36.540
> 
> 标签：.net, windows, crystal-reports

我有一个用 C# 开发的系统，并有一些由水晶报表制作的报表。我将系统安装在装有 Windows 7 64 位的计算机上，一切正常，但是当我尝试为 .Net Framework 4 安装 SAP Crystal Reports 运行时引擎时，我收到此消息“此软件包只能安装在已安装的系统上.Net Framework 2.0 或更高版本”。

计算机已安装 Microsoft .Net Framework 4 Client Profile 和 Microsoft .Net Framework 4 Extended。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-04-08T18:42:10.177

使用 Windows 更新设置更新您的操作系统或从[dotnet-framework-runtime安装当前的 .net 框架](https://www.microsoft.com/net/download/dotnet-framework-runtime)

# pdf - fpdf pdf 文件大小

> ID：14386520
> 
> 赞同：2
> 
> 时间：2013-01-17T19:22:59.087
> 
> 标签：pdf, fpdf, filesize

我正在使用 FPDF 生成一页 PDF，文件大小很大（接近 1.05 M）。我只有一张图像，当我删除它时，它只取出大约 22k，所以虽然它很大，但对文件大小的影响并不大。我正在使用一些手动添加的字体（通过 FPDF 说明）。我必须在整个过程中关闭和打开这些字体（用于设置 pdf 的样式）。关于为什么这么大的任何想法？自定义字体是否嵌入并增加*了*文件大小？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-09-09T12:41:19.190

巨大的尺寸纯粹是由于图像文件。我尝试使用图像的优化版本（减少网络使用的文件大小），PDF 文件大小大大减少。

使用所需尺寸的图像也会更有帮助。最初，我的项目使用尺寸为 4000x3000 的图像在 PDF 文件的 50x50 空间中显示。我将图像的大小调整为非常小的尺寸和宾果游戏！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-11-05T15:35:28.243

它的字体，它们使文件膨胀很大。我遇到了类似的问题，当仅使用内置字体（Helvetica）时，大小从 800k 下降到 60k。

# html - 可排序列表到复选框列表 JQuery，代码更改最少

> ID：14386522
> 
> 赞同：0
> 
> 时间：2013-01-17T19:23:13.363
> 
> 标签：html, css, jquery-ui

目前我有一个带有文本的可排序元素列表：

![当前的外观和感觉](../Images/49643d39faa5690ea2de96cf719569a2.png)

如何将其更改为带有标签且代码更改最少的复选框列表？

![理想的外观和感觉](../Images/c6b94dff5da0e3b9aa3f75f48260caf4.png)

**当前代码：**

```
<div class='left'>
<ul id="sortable">
    <li class="ui-state-highlight"></li>
    <li class="ui-state-highlight"></li>
    <li class="ui-state-highlight"></li>
</ul>
</div> 
```

脚本

```
<script>
     $(function() {
         $( "#sortable" ).sortable({
           items: "li:not(.ui-state-highlight)",
           placeholder: "ui-state-highlight"
         });
         $( "#sortable" ).disableSelection();
     });
   </script> 
```

Javascript

```
 var nodes = document.getElementById('sortable').getElementsByClassName('ui-state-highlight');  
      if (nodes.length > 0)
      {
        nodes[0].innerHTML = getSymbol();
        nodes[0].setAttribute("class", "ui-state-default");
      } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T15:23:17.890

脚本

```
<script type="text/javascript">
    $(document).ready(function() {
        $('#btnSave').click(function() {
            addCheckbox($('#txtName').val());
        });
    });

function addCheckbox(name) {
       var container = $('#cblist');
       var inputs = container.find('input');
       var id = inputs.length+1;

       var html = '<input type="checkbox" class="keepSymbol" id="cb'+id+'" value="'+name+'" onclick="checkboxClick(this)" checked="true" /> <label for="cb'+id+'">'+name+'</label>';
       container.append($(html));
    }
    </script> 
```

Javascript

```
 var nodes = document.getElementById('cblist').getElementsByClassName('keepSymbol');
      if (nodes.length > 0)
      {
        addCheckbox(getSymbol());
      }
      else
      {
        return; // no more space
      } 
```

这可能是一个很好的例子，你必须使用它来获得你需要的东西。

# ios - ios 5.1 和 6.0 的 iCloud 实现

> ID：14386524
> 
> 赞同：1
> 
> 时间：2013-01-17T19:23:18.843
> 
> 标签：ios, core-data, icloud

我最新的应用程序使用 coredata，我希望我的用户能够在他们的手机或 ipad 上工作，所以过去几天我一直在尝试实现 iCloud。哇，令人沮丧。有时数据会传输，有时不会（还没有？）。有时应用程序会立即崩溃，有时则不会....

我的应用程序只需要在首次安装时导入一小组数据并在加载时进行同步。

我的实现基于这个模型：https://github.com/alekseyn/iCloudStoreManager 并根据我的需要进行了修改（例如删除为示例添加的 UI 元素）。

我想知道是否有人愿意分享一个简单的 5.1 和 6.0 iCloud 实现？我相信会有很多感恩的人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T19:36:28.853

您可以查看这两个资源。

[http://www.raywenderlich.com/12779/icloud-and-uidocument-beyond-the-basics-part-1](http://www.raywenderlich.com/12779/icloud-and-uidocument-beyond-the-basics-part-1)

和

[https://developer.apple.com/icloud/documentation/](https://developer.apple.com/icloud/documentation/)

他们可能会有所帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T21:58:39.177

哪有这回事。使用 Core Data 的 iCloud 一直很困难。您描述的问题是典型的，不是来自您的应用程序中的问题，而是来自 Core Data 的 iCloud 集成问题。无论如何，参考示例代码、博客等，也许你会改进你的应用程序。但是你仍然会使用 iCloud，而且你无法解决这个问题。

# c - 打印链表数据时出现分段错误

> ID：14386525
> 
> 赞同：2
> 
> 时间：2013-01-17T19:23:20.460
> 
> 标签：c

我正在编写一个打印链接列表的小程序。该列表包含一个字符串和一个指向下一个节点的指针。

我将链表传递给添加新节点并填充数据字段的函数。

当我回到主函数并尝试打印列表内容时，我得到分段错误错误，尽管从函数 add_node 我可以打印节点的内容。

我希望能够将列表和字符串传递给函数，并且函数必须使用我传递的字符串将新节点添加到列表中。

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

struct node
{
    char filename[25];
    struct node *next;
};

typedef struct node LISTNODE;
typedef LISTNODE *LISTNODEPTR;

void add_node(LISTNODEPTR *nFile, char *chaData);

int main (int argc, char *argv[])
{
    LISTNODEPTR nFile = NULL;

    printf("Printing list\n");

    add_node(&nFile, "file.txt");

    printf("%s\n", nFile->filename);

    free(nFile);

    return 0;
}

void add_node(LISTNODEPTR *nFile, char *chaData)
{
    LISTNODEPTR head = *nFile;
    LISTNODEPTR newNode;

    newNode = (LISTNODEPTR) malloc(sizeof (struct node));

    strcpy(newNode->filename, chaData);

    printf("%s\n", newNode->filename);

    newNode->next = head; //link next. newNode next points to head (beginning of the list). At this time (head & newNode)->2nd->3rd->NULL

    head = newNode;
} 
```

输出：打印列表文件.txt 分段错误

操作系统：Linux sisdvb02 2.6.35-28-server #49-Ubuntu SMP Tue Mar 1 14:55:37 UTC 2011 x86_64 GNU/Linux

编译器：gcc -Wall -o list list.c

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T19:27:15.380

`nFile`在你的`add_node()`功能没有改变。它仍然指向`NULL`并且由于您尝试取消引用 a`NULL`您会收到分段违规错误。顺便说一句，使用 Valgrind 来帮助您解决此类问题。

将您的功能更改为以下内容：

```
void add_node(LISTNODEPTR *nFile, char *chaData)
{
    LISTNODEPTR head = nFile;
    LISTNODEPTR newNode;

    newNode = (LISTNODEPTR) malloc(sizeof (struct node));

    strcpy(newNode->filename, chaData);

    printf("%s\n", newNode->filename);

    newNode->next = head; //link next. newNode next points to head (beginning of the list). At this time (head & newNode)->2nd->3rd->NULL

    head = newNode;
    nFile = head;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T19:29:50.513

您有一个指向 null 的指针。然后将其分配给另一个变量，以便该变量现在指向 null。然后你分配内存并指向那个内存。这不会改变原始指针仍然指向空值。

将函数中的最后一行更改为

```
*nFile = head; 
```

另外，如果您不想将缓冲区溢出错误更改为此：

```
strncpy(newNode->filename, chaData, 25);
newNod->filename[24] = 0; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-17T19:31:04.317

在里面`add_node()`，你修改`head`变量，它只是局部变量。这不会影响`nFile`变量 in `main()`- 它仍然是`NULL`当控制返回时`main()`，这就是你得到分段错误的原因。

最后一行`add_node()`应该是：

```
 *nFile = newNode; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-17T19:31:25.897

恕我直言，最重要的是学习如何调试这样的故障。使用它可以很方便地`gdb`了解程序在哪里崩溃以及程序状态是什么。

```
$ gcc -Wall -g test.c -o test
$ gdb ./test
...
(gdb) run
...
Program received signal SIGSEGV, Segmentation fault.
...
(gdb) bt
#0  __strlen_sse2 () at ../sysdeps/x86_64/multiarch/../strlen.S:32
#1  0x00007ffff7aa783c in _IO_puts (str=0x0) at ioputs.c:37
#2  0x0000000000400612 in main (argc=1, argv=0x7fffffffe6a8) at test.c:24
(gdb) frame 2
#2  0x0000000000400612 in main (argc=1, argv=0x7fffffffe6a8) at test.c:24
24      printf("%s\n", nFile->filename);
(gdb) print nFile
$1 = (LISTNODEPTR) 0x0 
```

`bt`给我回溯，告诉我程序崩溃时的确切位置。我知道`print nFile`那`nFile`仍然是NULL。为什么？好吧，您可以看到您正在设置`head = newNode`为`add_node`（分配给即将被丢弃的临时变量）的最后一行，我假设您打算设置`*nfile = newNode`（通过指针分配给调用者的变量）。

# git - 合并了两个 Git 分支，推送到服务器，现在如何取消合并

> ID：14386532
> 
> 赞同：2
> 
> 时间：2013-01-17T19:23:54.710
> 
> 标签：git, merge, push, production-environment

我的代码在 master 分支中，然后还有另一个名为 dev 的分支，dev 比我的 master 分支领先一些提交，在合并之前我什至做了一个 master 分支备份“master-backup”。

然后我将 dev 合并到 master，并将合并的 master 分支推送到服务器（git push origin master）。

所以现在我的 git log 看起来像

提交 5（已经在 master 中）

提交 4（来自 dev 分支）

提交 3（来自开发分支）

提交 2（已经在 master 中）

提交 1（来自开发）

其余的提交已经在两个分支中

以上是场景，现在我被卡住的问题是我想从 master 中删除 dev 分支提交，我想要我的旧 master 分支，即 master-backup 中的任何内容，我想要 master 中的提交

我该怎么做？由于 dev 混合提交已经合并到 master 并推送，我怎样才能删除 dev 分支并让我的 master 恢复原样？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-17T19:30:22.163

听起来，为了立即修复，您可以在服务器上替换`master`为`master-backup`：

```
git push --force origin master-backup:master 
```

对于稍长的答案，您有两种选择。最简单的是使用`git-reset`，但只有在**没有其他人看到这个分支****时才**应该这样做，否则你会毁了她的一天。

 **前一次提交的版本`master`称为`master^`. 因此，首先使用`git log master^`绝对*确定*它是您要保留的版本，然后`master`签出：

```
git reset --hard master^ 
```

然后在您的服务器上更新：

```
git push --force origin master 
```

您的第二个选择是仅使用`git revert HEAD`新的提交来撤消合并中的所有更改，然后将其推送。但是，如果您将来尝试再次合并，则会产生[意想不到的后果。](http://www.kernel.org/pub/software/scm/git/docs/howto/revert-a-faulty-merge.txt)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T19:30:04.400

您只是想将 master-backup 推回 master 吗？`git checkout master-backup`然后`git push -f origin master`。**

# c# - DataContractSerializer 反序列化已知类型

> ID：14386534
> 
> 赞同：1
> 
> 时间：2013-01-17T19:24:00.303
> 
> 标签：c#, deserialization, datacontractserializer

我有一个对象结构如下：

```
[DataContract]
public abstract class Condition<T>
{
    [DataMember] public string Id { get; set; }
}

[DataContract(Name = "AttributeEqualTo", Namespace = "")]
public class AttributeEqualTo<T> : Condition<T>
{
    [DataMember] public string AttributeName { get; set; }
    [DataMember] public string ExpectedValue { get; set; }
}

[DataContract(Name = "AttributeNotEqualTo", Namespace = "")]
public class AttributeNotEqualTo<T> : AttributeEqualTo<T>
{
}

[CollectionDataContract(Name = "Conditions", Namespace = "")]
[KnownType("KnownTypes")]
public class ConditionSet<T> : Collection<Condition<T>>
{
    public static IEnumerable<Type> KnownTypes()
    {
        var knownTypes = new Collection<Type>
                             {
                                 typeof(AttributeEqualTo<T>),
                                 typeof(AttributeNotEqualTo<T>),
                             };
        return knownTypes;
    }
} 
```

给定以下 XML：

```
 <Conditions>
    <AttributeEqualTo>
      <Id>C1</Id>
      <AttributeName>Foo</AttributeName>
      <ExpectedValue>Bar</ExpectedValue>
    </AttributeEqualTo>
    <AttributeNotEqualTo>
      <Id>C2</Id>
      <AttributeName>Blah</AttributeName>
      <ExpectedValue>Value</ExpectedValue>
    </AttributeNotEqualTo>
  </Conditions> 
```

当我反序列化它时，我希望得到一个条件集合，其中包括 XML 中定义的两个条件中的每一个。我遇到的问题是我得到了集合，但它是空的。

我已经测试了单独反序列化条件的能力，它似乎工作正常。

我使用以下内容作为如何定义合同的参考，[数据合同已知类型](http://msdn.microsoft.com/en-us/library/ms730167.aspx)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-16T05:34:32.063

尝试删除泛型 - 这通常会破坏序列化。

# python - Python & MongoDB - 如何按 BinData 类型查找

> ID：14386535
> 
> 赞同：3
> 
> 时间：2013-01-17T19:24:04.457
> 
> 标签：python, mongodb, pymongo, bson

我是 MongoDB 的新手。无论如何，我正在尝试保存一些经过加密和 base64 编码的数据。

```
data = b64encode(self.iv + AES.new(self.key, self.mode, self.iv).encrypt(self.pad2(self.data)))
self.db.users.insert({'data':data})
self.db.users.find({'data':data}) 
```

插入工作正常，但查找数据返回 0 个结果。MongoDB shell 输出如下：

```
db.users.find()
{ "_id" : ObjectId("50f848dc34257b0d5e3d9b29"), "data" : BinData(0,"R1VhaHl3MGpLSStkY0lWU255ZjhneGp2RWk3cEk3MnFRTCsxOTcyOC82WT0=")} 
```

我现在如何通过 BinData 文件类型找到我的文档？我试过 bson.binary.Binary 没有运气。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T19:06:35.640

不确定您是否仍然需要这个（或者为什么要从二进制转换为 base64 到二进制），但我希望这会有所帮助：

```
import base64
import pymongo
from pymongo import binary
# if pymongo version >= 1.9, use the following instead
# from bson import binary

con = pymongo.Connection()
b64 = base64.b64encode("ajskldfjaklsdjfklasdjf")
bi = binary.Binary(b64)
con.test.test.insert({'foo': bi})
con.test.test.find_one({'foo': bi}) 
```

输出：

```
{
    u'_id': ObjectId('50f99b4a9f956a1924000000'),
    u'foo': Binary('YWpza2xkZmpha2xzZGpma2xhc2RqZg==', 0)
} 
```

# django - 实例化 Django 模型引发 TypeError: isinstance() arg 2 must be a class, type, or tuple of classes and types

> ID：14386536
> 
> 赞同：11
> 
> 时间：2013-01-17T19:24:23.230
> 
> 标签：django, django-models

我有一个现有的功能性 Django 应用程序，过去几个月一直在调试模式下运行。当我将站点更改为在生产模式下运行时，当我点击尝试创建新引荐模型对象的特定视图时，我开始收到以下异常电子邮件。

```
Traceback (most recent call last):

 File "/usr/local/lib/python2.7/dist-packages/Django-1.4.2-py2.7.egg/django/core/handlers/base.py", line 111, in get_response
   response = callback(request, *callback_args, **callback_kwargs)

 File "/usr/local/lib/python2.7/dist-packages/Django-1.4.2-py2.7.egg/django/contrib/auth/decorators.py", line 20, in _wrapped_view
   return view_func(request, *args, **kwargs)

 File "/var/django/acclaimd2/program/api.py", line 807, in put_interview_request
   referral = Referral()

 File "/usr/local/lib/python2.7/dist-packages/Django-1.4.2-py2.7.egg/django/db/models/base.py", line 349, in __init__
   val = field.get_default()

 File "/usr/local/lib/python2.7/dist-packages/Django-1.4.2-py2.7.egg/django/db/models/fields/related.py", line 955, in get_default
   if isinstance(field_default, self.rel.to):

TypeError: isinstance() arg 2 must be a class, type, or tuple of classes and types 
```

如您所见，仅尝试实例化引用模型对象就会触发此异常。这是有问题的模型：

```
class Referral (models.Model):
    opening = models.ForeignKey(Opening,related_name='referrals',null=False,blank=False)
    origin_request = models.ForeignKey('common.request',related_name='referrals',null=True,default=None)
    candidate = models.ForeignKey(User,related_name='referrals',null=False,blank=False)
    intro = models.TextField(max_length=1000,null=False,blank=False)
    experience = models.TextField(max_length=5000,null=False,blank=False)
    email = models.CharField(max_length=255,null=False,blank=False)
    phone = models.CharField(max_length=255,null=False,blank=True,default='')

    def __unicode__(self):
        return u"%s" % self.id 
```

这是 Django 中的一个错误，还是我在不知不觉中做了一些我不应该做的事情？有人对修复或解决方法有任何建议吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-18T00:06:03.670

**更新**（下面有解决方案）

我一直在研究 Django 模型代码，似乎有一个错误会在为 ForeignKey 中的相关字段使用基于“app.model”的标识符时创建竞争条件。当应用程序以生产模式而不是 DEBUG 运行时，上述异常中引用的 ForeignKey.get_default 方法会尝试检查提供的默认值是否是相关字段 (self.rel.to) 的实例：

```
def get_default(self):
    "Here we check if the default value is an object and return the to_field if so."
    field_default = super(ForeignKey, self).get_default()
    if isinstance(field_default, self.rel.to):
        return getattr(field_default, self.rel.get_related_field().attname)
    return field_default 
```

最初，当使用基于字符串的相关字段实例化 ForeignKey 时，self.rel.to 被设置为基于字符串的标识符。在related.py 中有一个名为 add_lazy_relation 的单独函数，在正常情况下，它会尝试将此基于字符串的标识符转换为模型类引用。因为模型是以惰性方式加载的，所以这种转换可能会延迟到 AppCache 完全加载为止。

因此，如果在完全填充 AppCache 之前对基于字符串的 ForeignKey 关系调用 get_default，则可能会引发 TypeError 异常。显然，将我的应用程序置于生产模式足以改变模型缓存的时间，这个错误开始发生在我身上。

**解决方案**

看起来这确实是 Django 中的一个错误，但如果您遇到此问题，这里是如何解决它。在实例化一个麻烦的模型之前立即添加以下代码片段：

```
from django.db.models.loading import cache as model_cache
if not model_cache.loaded:
    model_cache._populate() 
```

这将检查 AppCache 上的加载标志以确定缓存是否已完全填充。如果不是，我们将强制缓存现在完全填充。问题将得到解决。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2020-01-23T08:28:05.477

就我而言，我有一个模型“实体”和一个继承“AbstractBaseUser”的“用户”。“用户”模型有一个实体字段，其外键到实体的配置方式如下：

```
entity = m.ForeignKey('core.Entity', on_delete=m.SET_NULL, null=True) 
```

最后的解决方法是将其更改为

```
from core.models import Entity
entity = m.ForeignKey(Entity, on_delete=m.SET_NULL, null=True) 
```

我不知道问题的原因，但它就是这样工作的

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-04T20:19:14.697

另一个原因：

确保所有外键都在同一应用程序中的相同参考模型中（应用标签）。我在这个上用头撞墙了一会儿。

```
class Meta:
    db_table = 'reservation'
    app_label = 'admin' 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-04-09T21:22:03.620

正如其他答案中已经强调的那样，最常见的原因似乎是指使用`'app.Model'`语法的模型。

但是，要弄清楚究竟是哪个模型导致了问题，这可能仍然是一个相当大的挑战。

我发现该问题的快速解决方案是直接转到引发异常的地方（`django.db.models.fields.related.ForeignKey.get_default`）并添加以下打印语句

```
 def get_default(self):
        """Return the to_field if the default value is an object."""
        field_default = super().get_default()
        # Add this line:
        print(f'Here is our small little bug: {field_default}, {self.remote_field.model}')
        if isinstance(field_default, self.remote_field.model):
            return getattr(field_default, self.target_field.attname)
        return field_default 
```

现在打印出有问题的模型的名称，在代码中找到相关位置不再是一个大问题。

在 Django 2.2 上测试。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-02-10T11:36:03.067

就我而言，我在类调用中犯了一个错误，用引号将类名括起来。删除它们为我解决了错误。请参阅下面的错误代码：

```
from django.db import models
from django.contrib.auth.models import AbstractUser
from account.models import Profile

class User(AbstractUser):
    first_name = None;
    last_name = None;
    profile = models.ForeignKey(
        'Profile',
        on_delete=models.CASCADE,
    ); 
```

# c# - 模拟内部对象的事件不会触发？

> ID：14386540
> 
> 赞同：3
> 
> 时间：2013-01-17T19:24:45.333
> 
> 标签：c#, events, recursion, moq

使用带两个接口的**Moq**`Outer`和`Inner`，我无法`Outer.Inner.SomeEvent`启动。

```
public interface Outer
{
    Inner Inner { get; }
}

public interface Inner
{
    int Prop { get; set; }
    event EventHandler PropChanged;
}

public void Test()
{
    Mock<Outer> omock = new Mock<Outer>();
    Mock<Inner> imock = new Mock<Inner>();

    Console.WriteLine("Inner");
    imock.Object.PropChanged += InnerPropChanged;
    imock.Raise(m => m.PropChanged += null, EventArgs.Empty);
    imock.Object.PropChanged -= InnerPropChanged;

    // This has no effect.
    //omock.Setup(m => m.Inner).Returns(imock.Object);

    Console.WriteLine("Outer");
    // Both the auto recursive and the explicit above produce the same behavior.
    omock.SetupProperty(m => m.Inner.Prop, -1);
    omock.Object.Inner.PropChanged += InnerPropChanged;
    omock.Raise(m => m.Inner.PropChanged += null, EventArgs.Empty);
}

public void InnerPropChanged(object sender, EventArgs e)
{
    Console.WriteLine("  InnerPropChanged");
} 
```

调用时输出`Test()`：

```
Inner
  InnerPropChanged
Outer 
```

如何提醒订阅者注意任何`Inner`'s 事件？似乎没有什么可以解雇他们。

编辑-澄清一下，我希望能够`Inner`从上下文中引发事件`Outer`，因此最终输出应包括：

```
Outer
  InnerPropChanged 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T20:22:31.880

也许是表达式的错误或缺少的功能

```
omock.Raise(m => m.Inner.PropChanged += null, EventArgs.Empty); 
```

不起作用...但是您可以使用生成的`Inner`模拟，`Mock.Get`然后您可以在其上引发事件：

```
public void Test()
{
    Mock<Outer> omock = new Mock<Outer>();
    Console.WriteLine("Outer");
    omock.SetupProperty(m => m.Inner.Prop, -1);
    omock.Object.Inner.PropChanged += InnerPropChanged;
    Mock.Get(omock.Object.Inner)
        .Raise(m => m.PropChanged += null, EventArgs.Empty);
} 
```

这会产生您想要的输出：

```
Outer
  InnerPropChanged 
```

# backbone.js - Backbone.js 路由器实现

> ID：14386542
> 
> 赞同：0
> 
> 时间：2013-01-17T19:24:55.393
> 
> 标签：backbone.js, backbone-routing

我是 Backbone.js 的新手，并不完全了解某些类型的路由器实现之间的区别。

**1.类型：**

```
var Workspace = Backbone.Router.extend({
        routes:{
            '*filter': 'setFilter'
        },

        setFilter: function( param ) {
            // Set the current filter to be used
            Common.TodoFilter = param.trim() || '';

            // Trigger a collection filter event, causing hiding/unhiding
            // of the Todo view items
            Todos.trigger('filter');
        }
    }); 
```

**2\. 类型：**

```
var AppRouter = Backbone.Router.extend({

        routes: {
            // default
            '*actions': 'defaultAction'
        }

    });

    var initialize = function() {

        var router = new AppRouter();

        router.on('route:defaultAction', function(actions) {

            var homeView = new HomeView();
            homeView.render();

        });

        Backbone.history.start();

    };

    return {
        initialize: initialize
    }; 
```

那么，类型 1 中的普通回调 (setFilter) 和函数 router.on('route:defaultAction', function(actions) 有什么区别？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T20:49:47.683

从事件的主干[目录](http://backbonejs.org/#Events-catalog)：

> **"route:[name]" (params)** — 当特定路由匹配时由路由器触发。

所以`router.on('route:defaultAction'...`方法是绑定到路由每次匹配时由路由器触发的事件。路由器本身不需要回调，但必须在 routes-hash 或使用 route -function 调用中定义路由。

[第一种方法是使用`routes`-object](http://backbonejs.org/#Router-routes)将路由与函数匹配的最基本方法。

> 路由哈希将带有参数的 URL 映射到路由器上的函数

希望这可以帮助！

# ruby-on-rails - 在 ActiveAdmin 中翻译表格

> ID：14386545
> 
> 赞同：2
> 
> 时间：2013-01-17T19:25:13.817
> 
> 标签：ruby-on-rails, internationalization, activeadmin

用户有许多角色（名称：字符串）。对于 ActiveAdmin 中的用户表单，我有以下 DSL 代码（在 app/admin/users.rb 中）：

```
form do |f|
  f.inputs "Details" do
    f.input :email
    f.input :roles, as: :radio
  end
  f.buttons
end 
```

在 db 中有两个名为“basic”和“extended”的角色，它使用带有标签“basic”和“extended”的单选按钮呈现表单，这些标签是从 Role.name 属性中提取的。

我需要使用 I18n 方法翻译此属性的值。

可以使用 ActiveAdmin 来完成，还是我应该为此编写自己的部分内容？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-17T21:55:33.023

考虑这样的事情：

```
form do |f|
  f.inputs "Details" do
    f.input :email
    f.input :roles, :as => :radio, :collection => User.roles.map { |role| [I18n.t("active_admin.user.role.#{role.name}"), role.id] }
  end
  f.buttons
end 
```

# javascript - 0 个细分的体积计算不正确

> ID：14386554
> 
> 赞同：2
> 
> 时间：2013-01-17T19:25:44.927
> 
> 标签：javascript, three.js, volume, mesh

我最近提交了一个关于体积计算的问题，在[这个线程](https://stackoverflow.com/questions/1410525/volume-of-a-3d-closed-mesh-car-object)上得到了一些很大的帮助，并且开发了一个函数来计算三个 JS 中闭合网格的体积。对于 Face3 网格，变量 face4 是一个真/假，它将面分成两个三角形。我的几何图形主要是自定义 Face4 构造。

```
 function volumeCalc(object, face4){

        if (face4 == false) {

        for (var i=0; i<object.geometry.faces.length; i++) {

    var pA = (object.geometry.faces[i].a);
    var qA = (object.geometry.faces[i].b);
    var rA = (object.geometry.faces[i].c);

    var Px = object.geometry.vertices[pA].x;
    var Py = object.geometry.vertices[pA].y;
    var Pz = object.geometry.vertices[pA].z;

    Pxlist.push(Px);
    Pylist.push(Py);
    Pzlist.push(Pz);

    var Qx = object.geometry.vertices[qA].x;
    var Qy = object.geometry.vertices[qA].y;
    var Qz = object.geometry.vertices[qA].z;

    Qxlist.push(Qx);
    Qylist.push(Qy);
    Qzlist.push(Qz);

    var Rx = object.geometry.vertices[rA].x;
    var Ry = object.geometry.vertices[rA].y;
    var Rz = object.geometry.vertices[rA].z;

    Rxlist.push(Rx);
    Rxlist.push(Ry);
    Rzlist.push(Rz);
}
    }   else  {
        for (var i=0; i<object.geometry.faces.length; i++) {

    var pA = (object.geometry.faces[i].b);
    var qA = (object.geometry.faces[i].c);
    var rA = (object.geometry.faces[i].d);

    var Px = object.geometry.vertices[pA].x;
    var Py = object.geometry.vertices[pA].y;
    var Pz = object.geometry.vertices[pA].z;

    Pxlist.push(Px);
    Pylist.push(Py);
    Pzlist.push(Pz);

    var Qx = object.geometry.vertices[qA].x;
    var Qy = object.geometry.vertices[qA].y;
    var Qz = object.geometry.vertices[qA].z;

    Qxlist.push(Qx);
    Qylist.push(Qy);
    Qzlist.push(Qz);

    var Rx = object.geometry.vertices[rA].x;
    var Ry = object.geometry.vertices[rA].y;
    var Rz = object.geometry.vertices[rA].z;

    Rxlist.push(Rx);
    Rxlist.push(Ry);
    Rzlist.push(Rz);
     }
}
    for (i=0;i < Pxlist.length; i++){

    pv = Pxlist[i]*Qylist[i]*Rzlist[i]; + Pylist[i]*Qzlist[i]*Rxlist[i]; + Pzlist[i]*Qxlist[i]*Rylist[i]; - Pxlist[i]*Qzlist[i]*Rylist[i]; - Pylist[i]*Qxlist[i]*Rzlist[i]; -Pzlist[i]*Qylist[i]*Rxlist[i];
    pvlist.push(pv);

}

// calculate the total of these, I'm using _.js to add all values in the list.

addUp = (_.reduce(pvlist, function(memo, num){ return memo + num; }, 0))/6; 
```

这是基于公式

```
pv =  Px*Qy*Rz + Py*Qz*Rx + Pz*Qx*Ry - Px*Qz*Ry - Py*Qx*Rz - Pz*Qy*Rx; 
```

在创建网格之前，我在 THREE.Geometry 上执行以下操作：

```
geom.mergeVertices();
geom.computeCentroids();
geom.computeFaceNormals();
geom.computeVertexNormals();

var modifier = new THREE.SubdivisionModifier( x );

modifier.modify( geom ); 
```

在 x > 0 的所有细分情况下，体积计算都是正确的。当 x = 0 或没有细分时，它是不正确的，按数量级计算。

有任何想法吗？也将感谢有关如何清理功能以供他人使用的建议，这是我第一次尝试开源贡献。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T19:04:46.157

“x”是用户定义的变量吗？如果为 0，则不通过细分修改器传递几何体。

# java - 以编程方式设置 Android 按钮样式

> ID：14386556
> 
> 赞同：5
> 
> 时间：2013-01-17T19:25:49.640
> 
> 标签：java, android, android-layout, button

您如何以编程方式向 android 按钮添加/删除样式？是否可以在运行时应用样式？

我有两个看起来像这样的按钮

```
     ---------- ----------
    | 按钮 A | | 按钮 B |
     ---------- ----------
```

我想要做的是当一个按钮被点击时（比如说按钮 B），它运行一些代码，然后将按钮 B 的样式更改为其他东西（即突出显示的边框），并且将是这样的：

```
     ---------- ==========
    | 按钮 A | || 按钮 B ||
     ---------- ==========
```

我知道如何在 XML 中进行样式设置（即创建样式），我只想知道如何在运行时/使用 java 代码中应用样式。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-17T19:54:17.800

让我们为您编写一些代码... :) 要动态地将样式应用于您的视图（在这种情况下为按钮），您必须在布局文件夹（res/layout）中执行以下操作。

我将其命名为**buttonstyle.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">

    <item android:state_pressed="true">
        <shape>
            <solid android:color="#449def"/>
            <stroke android:width="1dp" android:color="#2f6699"/>
            <corners android:radius="3dp"/>
            <padding android:left="10dp" android:top="10dp" android:right="10dp"
                     android:bottom="10dp"/>
        </shape>
    </item>

    <item>
        <shape>
            <gradient android:startColor="#449def" android:endColor="#2f6699" android:angle="270"/>
            <stroke android:width="1dp" android:color="#2f6699"/>
            <corners android:radius="4dp"/>
            <padding android:left="10dp" android:top="10dp" android:right="10dp"
                     android:bottom="10dp"/>
        </shape>
    </item>

</selector> 
```

现在将样式应用于您的按钮，将以下代码添加到您的活动的 onCreate() 方法中。

```
Button transferBtn = new Button(this);
transferBtn.setText("Test Example");
transferBtn.setId(R.string.transferBtn);
transferBtn.setBackgroundResource(R.layout.buttonstyle); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-17T19:45:32.577

您不能在运行时应用 xml 定义的样式（来自代码）。如果您想在单击（按下）按钮时更改背景和字体样式，您应该创建[选择器](https://stackoverflow.com/questions/4692642/android-customized-button-changing-text-color)来定义用于普通按钮或单击状态的背景。

如果选择器不是您想要的，您应该通过 Button 类的按钮 setXXX 方法手动将每个按钮属性设置为所需的值。

PS您可以将旧按钮换成另一个从不同样式的xml膨胀的新按钮。但我想这不是一个好方法......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-16T10:00:50.683

正如我在另一个线程中回答的那样，您可以按照某些人的建议以编程方式设置背景，或者如果您使用支持库，您可以以编程方式设置样式（如我[**在此处建议的那样）。**](https://stackoverflow.com/a/39528558/689723)

# jquery - JQGrid 表单编辑：动态修改列的 elmprefix

> ID：14386557
> 
> 赞同：1
> 
> 时间：2013-01-17T19:25:56.520
> 
> 标签：jquery, jqgrid

我为初始条件添加了一些代码，以防有人感兴趣；我将此代码放在 Country datainit 中：

```
 setTimeout(function ()
                            {
                                var required = $(elem).val() === 'US';
                                grid.jqGrid('setColProp', 'PostalCode', { editrules: { required: required} });
                                $('#PostalCode').siblings('.mystar').html(required ? '*' : '&nbsp;');
                            }, 100); 
```

（我知道 JQGrid 的新版本不再需要 setTimeout，但我在升级时遇到了问题。）

* * *

我需要动态设置formedit列的elmprefix。这个想法是，对于美国来说，邮政编码是必需的。所需元素正在运行，但 elmprefix 未显示。

```
dataEvents: [
    {
        type: "change",
        fn: function (e) {
            changeStateSelect($(e.target).val(), e.target);
            var isUS = $(e.target).val() == 'US';
            grid.jqGrid('setColProp', 'PostalCode', { editrules: { required: isUS },
                formoptions: { elmprefix: (isUS ? "<font color='red'>*</font>" : " ")}
            });
        } 
    },
    {
        type: "keyup",
        fn: function (e) { $(e.target).trigger('change'); }
    }
] 
```

有什么办法可以做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T20:06:23.863

的选项`formoptions.elmprefix`和其他属性`formoptions`将在创建编辑表单*之前使用。*您可以在创建表单之前使用回调`beforeInitData`或事件来修改数据。`jqGridAddEditBeforeInitData`

如果您确实需要动态显示/隐藏星号，您可以手动隐藏相应的元素。例如，您可以定义`elmprefix`为

```
elmprefix: "<span class='mystar' style='color:red'>*</span>" 
```

以便能够轻松找到和修改它。然后你可以使用

```
$("#PostalCode").siblings(".mystar").html($(e.target).val() === 'US' ? "*" : "&nbsp;"); 
```

在`change`处理程序内部而不是`grid.jqGrid('setColProp', 'PostalCode', ...);`

# javascript - 向 Angular 方法添加动态变量似乎不起作用

> ID：14386558
> 
> 赞同：0
> 
> 时间：2013-01-17T19:26:03.230
> 
> 标签：javascript, jquery, angularjs

我敢打赌，这与变量实例化后的事件绑定有关。

但假设我有这样的事情：

```
%li{'ng-click' => "navigate({{month.date.format('MMM')}})"} 
```

这将产生相同的结果：

```
%li{'ng-click' => "navigate(02)"} 
```

然而，第一个例子永远不会奏效。如何添加动态变量并让 Angular 的点击处理程序响应它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T19:27:22.060

只是丢掉花括号：

```
%li{'ng-click' => "navigate(month.date.format('MMM'))"} 
```

# kendo-ui - 网格如何将多列合二为一

> ID：14386560
> 
> 赞同：7
> 
> 时间：2013-01-17T19:26:09.387
> 
> 标签：kendo-ui

我正在尝试将两列绑定到一个剑道网格列中。下面似乎不起作用。

```
var grid = $("#grid").kendoGrid({
                dataSource: { data: SomeData },
                columns: [{
                    field: "Column1" + "Column2"
                }]

            }).data("kendoGrid"); 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-17T22:11:52.517

如果您不需要编辑单元格，您可以执行所谓的*组合单元格或合成*，它是使用 KendoUI 实现的[`template`](http://docs.kendoui.com/api/web/grid#columnstemplate-string)。（尝试在谷歌上搜索“带有组合单元的 kendoui 网格”）。

例子

```
var leitmotifs = [
    { 
        company: "OnaBai", 
        leitmotif: "Working on a cloud of documents!" 
    },
    { 
        company: "Nike", 
        leitmotif: "Just do it!" 
    }
];

var grid = $("#table").kendoGrid({
    dataSource: {
        data: leitmotifs
    },
    columns   : [
        { 
            title: "Company", 
            template: "#= company + ' : ' + leitmotif #"
        }
    ]
}); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-17T22:10:34.573

您是否查看过 DataSource 上的[schema.parse](http://docs.kendoui.com/api/framework/datasource#schemaparse-function)方法？您可以在那里将列添加为没有问题的新字段。然后，当您到达网格时，该字段将可用。

```
dataSource: {
  transport: {
    read: "things"
  },
  schema: {
    parse: function (data) {
      // return a new collection which has a new field
      // that adds fields 2 and 3 together
      return $.map(data, function(item) {
       item.field4 = item.field2 + item.field3;
          return item;
      });
    }
  }
} 
```

这是一个例子......

[http://jsbin.com/azizaz/1/edit](http://jsbin.com/azizaz/1/edit)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-01-08T19:44:50.403

这是一个不同的解决方案，它还提供了在任一字段上独立排序的能力，同时仍保留单列数据。

```
columns: [
   {  // cell data 
      headerAttributes: { style: "display:none;" },
      attributes: { colspan: 2 },
      template: "#= field1 # #= field2 #"
   },
   {  // field 1 data
      field: "field1",
      title: "Field 1",
      attributes: { style: "display: none;" },
      template: ""
   },
   {  // field 2 data
      field: "field2",
      title: "Field 2",
      attributes: { style: "display: none;" },
      template: ""
   }
] 
```

# android - 如何阻止警报对话框自动消失

> ID：14386561
> 
> 赞同：3
> 
> 时间：2013-01-17T19:26:11.227
> 
> 标签：android, android-dialog

下面是我在 GPS 关闭时提醒用户的代码。在这里，我的用户必须单击其中一个选项并进一步移动。但是，如果用户在屏幕上单击此警报以外的其他位置，则此警报会消失。如何阻止此警报对话框自动消失。请帮忙

```
Builder bd = new AlertDialog.Builder(myTest.this);
    bd.setTitle("Alert");       
    bd.setMessage("GPS is disabled. Do you want to");
    bd.setNegativeButton("Enable GPS", new DialogInterface.OnClickListener() {              
                public void onClick(DialogInterface dialog, int which) {
                    startActivity(new Intent(android.provider.Settings.ACTION_LOCATION_SOURCE_SETTINGS));
                }});            
            bd.setPositiveButton("Close App", new DialogInterface.OnClickListener() {               
                public void onClick(DialogInterface dialog, int which) {
                    finish();
                }
                });
    bd.show(); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-17T19:27:37.713

使用 bd.setCancelable(false)。这将使它只能通过按下按钮消失。

# arrays - bash脚本将变量分配给关联数组

> ID：14386562
> 
> 赞同：1
> 
> 时间：2013-01-17T19:26:11.587
> 
> 标签：arrays, bash, associative

我一直在为一个新概念而苦苦挣扎——bash 脚本中的关联数组。

这是我的代码的简化版本：

```
#!/bin/bash
declare -A MYID
MYID[hello]=world
tac /home/user/filename | while read -r line; do
  MYID[hello]=me
done
echo "${MYID[hello]}"
exit 
```

这就是我认为它会做的事情：1）声明一个名为 MYID 的关联数组 2）在 MYID 中将值 world 分配给键 hello 3）逐行读取文件 /home/user/filename 4）每次读取一行将我分配给 MYID 数组中的键 hello 5) 打印出“me”并退出

它所做的是打印出“世界”而不是“我”。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T19:30:39.580

管道创建一个子外壳，因此您在 while 循环中所做的任何更改`MYID`都只存在于该子外壳中。试试这个：

```
while read -r line; do
    MYID[hello]=me
done < <(tac /home/user/filename) 
```

# processing - 处理翻转条件

> ID：14386567
> 
> 赞同：0
> 
> 时间：2013-01-17T19:26:37.450
> 
> 标签：processing, rollover

我正在处理一个简单的翻转。目前，当我将鼠标悬停在椭圆上时，翻转有效，但当我将鼠标移动到另一个位置时它不会消失。

```
float x = random(0, 255);
float y = random(0, 255);
float d;
float radius;
boolean rollover = false;

void setup() {
  PFont font = loadFont("DialogInput-12.vlw");
  size (800, 600);
  noStroke();
  smooth();
}

void draw() {
  drawData(x, y);

  if (rollover) {
  fill(y);
  textAlign(CENTER);
  text("hahaha", width/2, height/2);
  }

}

void drawData(float x, float y) {

  float value = x;
  float d = dist(x, y, mouseX, mouseY);
  float radius = map(value, 0, y, 10, 10);
  fill(x);  
  ellipse(x, y, radius, radius);

  if(d < radius) {
  rollover = true;
  } else {
    rollover = false;
  }

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-19T00:56:19.523

只需在绘制循环的开头添加一个“背景（颜色值）”行：

```
float x = random(0, 255);
float y = random(0, 255);
float d;
float radius;
boolean rollover = false;

void setup() {
  PFont font = loadFont("DialogInput-12.vlw");
  size (800, 600);
  noStroke();
  smooth();
}

void draw() {
  background(255);  // add this

  drawData(x, y);

  if (rollover) {
  fill(y);
  textAlign(CENTER);
  text("hahaha", width/2, height/2);
  }

}

void drawData(float x, float y) {

  float value = x;
  float d = dist(x, y, mouseX, mouseY);
  float radius = map(value, 0, y, 10, 10);
  fill(x);  
  ellipse(x, y, radius, radius);

  if(d < radius) {
  rollover = true;
  } else {
    rollover = false;
  }

} 
```

# perl - Catalyst::Plugin::StatusMessage 跨多个“应用”服务器

> ID：14386569
> 
> 赞同：5
> 
> 时间：2013-01-17T19:26:52.473
> 
> 标签：perl, catalyst, status-message

所以我在我的 Catalyst 应用程序中使用[Catalyst::Plugin::StatusMessage](https://metacpan.org/module/Catalyst::Plugin::StatusMessage)。唯一的问题是，现在我有一个负载均衡器，后面有两个应用程序服务器，都在运行催化剂。因此，如果在一个应用服务器上设置状态消息，然后将用户重定向，然后负载均衡器将它们发送到第二个应用服务器，用户将看不到状态消息，因为状态消息是本地的应用服务器。无论如何我可以在应用服务器之间共享这些状态消息，这样我就不必担心负载均衡器将它们发送到哪个服务器？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-17T23:46:00.603

如果您的状态消息是应用服务器本地的，这是否意味着`$c->session`使用 FastMmap 或 File 作为其 Session::Store？同样的问题必须适用于会话中的任何事情，大概？

鉴于 C::P::StatusMessage 使用会话来管理其消息，您可能必须更改 Session::Store 以使用数据库支持的存储机制。有[很多这样的选项](https://metacpan.org/search?q=catalyst%3a%3aplugin%3a%3asession%3a%3astore)，最有可能的候选者是[Catalyst::Plugin::Session::Store::DBIC](https://metacpan.org/module/Catalyst%3a%3aPlugin%3a%3aSession%3a%3aStore%3a%3aDBIC)

# angularjs - 使用 ng-change 选择 ng-object

> ID：14386570
> 
> 赞同：319
> 
> 时间：2013-01-17T19:26:53.337
> 
> 标签：angularjs

给定以下选择元素

```
<select ng-options="size.code as size.name for size in sizes " 
        ng-model="item.size.code" 
        ng-change="update(MAGIC_THING)">
</select> 
```

有没有办法让 MAGIC_THING 等于当前选择的大小，所以我可以访问`size.name`和`size.code`在我的控制器中？

size.code 会影响应用程序的许多其他部分（图像 url 等），但是当`item.size.code`更新 ng-model 时，也`item.size.name`需要针对面向用户的内容进行更新。我认为执行此操作的正确方法是捕获更改事件并在我的控制器内部设置值，但我不确定我可以将什么传递给 update 以获得正确的值。

如果这完全是错误的方法，我很想知道正确的方法。

* * *

## 回答 #1

> 赞同：498
> 
> 时间：2013-01-17T19:50:50.337

与其将 ng-model 设置为 item.size.code，不如将其设置为 size：

```
<select ng-options="size as size.name for size in sizes" 
   ng-model="item" ng-change="update()"></select> 
```

然后在您的`update()`方法中，`$scope.item`将设置为当前选择的项目。

无论需要什么代码`item.size.code`，都可以通过`$scope.item.code`.

[小提琴](http://jsfiddle.net/mrajcok/G8S32/)。

**根据评论中的更多信息进行**更新：****

 **然后为您选择的 ng-model 使用其他一些 $scope 属性：

```
<select ng-options="size as size.name for size in sizes" 
   ng-model="selectedItem" ng-change="update()"></select> 
```

控制器：

```
$scope.update = function() {
   $scope.item.size.code = $scope.selectedItem.code
   // use $scope.selectedItem.code and $scope.selectedItem.name here
   // for other stuff ...
} 
```

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2013-06-26T09:08:57.783

您也可以使用以下代码直接获取选定的值

```
 <select ng-options='t.name for t in templates'
                  ng-change='selectedTemplate(t.url)'></select> 
```

脚本.js

```
 $scope.selectedTemplate = function(pTemplate) {
    //Your logic
    alert('Template Url is : '+pTemplate);
} 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2015-03-19T12:39:48.073

你也可以试试这个：

```
<select  ng-model="selectedItem" ng-change="update()">
   <option ng-repeat="item in items" 
         ng-selected="selectedItem == item.Id" value="{{item.Id}}">
      {{item.Name}}
   </option>
</select> 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2014-07-24T15:08:27.207

如果 Divyesh Rupawala 的回答不起作用（将当前项作为参数传递），那么请查看`onChanged()`此 Plunker 中的函数。它正在使用`this`：

[http://plnkr.co/edit/B5TDQJ](http://plnkr.co/edit/B5TDQJ)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-05-07T05:05:00.217

```
<select ng-model="item.size.code">
<option ng-repeat="size in sizes" ng-attr-value="size.code">{{size.name}}          </option>
</select> 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-04-14T15:56:25.433

```
//Javascript
$scope.update = function () {
    $scope.myItem;
    alert('Hello');
}
```

```
<!--HTML-->
<div class="form-group">
     <select name="name"
             id="id" 
             ng-model="myItem" 
             ng-options="size as size.name for size in sizes"
             class="form-control" 
             ng-change="update()"
             multiple
             required>
     </select>
</div>
```

如果要写，name，id，class，multiple，required，可以这样写。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-07-24T17:57:21.230

这可能会给你一些想法

.NET C# 视图模型

```
public class DepartmentViewModel
{
    public int Id { get; set; }
    public string Name { get; set; }
} 
```

.NET C# Web API 控制器

```
public class DepartmentController : BaseApiController
{
    [HttpGet]
    public HttpResponseMessage Get()
    {
        var sms = Ctx.Departments;

        var vms = new List<DepartmentViewModel>();

        foreach (var sm in sms)
        {
            var vm = new DepartmentViewModel()
            {
                Id = sm.Id,
                Name = sm.DepartmentName
            };
            vms.Add(vm);
        }

        return Request.CreateResponse(HttpStatusCode.OK, vms);
    }

} 
```

角度控制器：

```
$http.get('/api/department').then(
    function (response) {
        $scope.departments = response.data;
    },
    function (response) {
        toaster.pop('error', "Error", "An unexpected error occurred.");
    }
);

$http.get('/api/getTravelerInformation', { params: { id: $routeParams.userKey } }).then(
   function (response) {
       $scope.request = response.data;
       $scope.travelerDepartment = underscoreService.findWhere($scope.departments, { Id: $scope.request.TravelerDepartmentId });
   },
    function (response) {
        toaster.pop('error', "Error", "An unexpected error occurred.");
    }
); 
```

角模板：

```
<div class="form-group">
    <label>Department</label>
    <div class="left-inner-addon">
        <i class="glyphicon glyphicon-hand-up"></i>
        <select ng-model="travelerDepartment"
                ng-options="department.Name for department in departments track by department.Id"
                ng-init="request.TravelerDepartmentId = travelerDepartment.Id"
                ng-change="request.TravelerDepartmentId = travelerDepartment.Id"
                class="form-control">
            <option value=""></option>
        </select>
    </div>
</div> 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-02-02T06:01:02.807

这是从角度选择选项列表（Id 或 Text 除外）中获取值的最简洁方法。假设您的页面上有这样的产品选择：

```
<select ng-model="data.ProductId"
        ng-options="product.Id as product.Name for product in productsList"
        ng-change="onSelectChange()">
</select> 
```

然后在您的控制器中设置回调函数，如下所示：

```
 $scope.onSelectChange = function () {
        var filteredData = $scope.productsList.filter(function (response) {
            return response.Id === $scope.data.ProductId;
        })
        console.log(filteredData[0].ProductColor);
    } 
```

**简单解释：**由于 ng-change 事件无法识别 select 中的选项项，因此我们使用 ngModel 从控制器中加载的选项列表中过滤掉选定的 Item。

此外，由于事件在 ngModel 真正更新之前被触发，您可能会得到不希望的结果，因此更好的方法是添加 timeout ：

```
 $scope.onSelectChange = function () {
            $timeout(function () {
            var filteredData = $scope.productsList.filter(function (response) {
                return response.Id === $scope.data.ProductId;
            })
            console.log(filteredData[0].ProductColor);
            }, 100);
        }; 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-05-17T03:47:39.747

您需要使用“track by”，以便正确比较对象。否则 Angular 将使用原生 js 方式来比较对象。

因此，您的示例代码将更改为 -

```
 <select ng-options="size.code as size.name
 for size in sizes track by size.code" 
ng-model="item.size.code"></select> 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-06-25T10:01:13.390

**AngularJS 的过滤器**为我解决了。

假设`code/id`是*唯一的*，我们可以用 AngularJS 过滤掉那个特定的对象，`filter`并使用选定的对象属性。考虑上面的例子：

```
<select ng-options="size.code as size.name for size in sizes" 
        ng-model="item.size.code" 
        ng-change="update(MAGIC_THING); search.code = item.size.code">
</select>

<!-- OUTSIDE THE SELECT BOX -->

<h1 ng-repeat="size in sizes | filter:search:true"
    ng-init="search.code = item.size.code">
  {{size.name}}
</h1> 
```

现在，这有**3 个重要方面**：

1.  `ng-init="search.code = item.size.code"`- 在框外初始化`h1`元素`select`时，将过滤器查询设置为*所选选项*。

2.  `ng-change="update(MAGIC_THING); search.code = item.size.code"`- 当您更改选择输入时，我们将再运行一行，将“搜索”查询设置为当前选择的`item.size.code`.

3.  `filter:search:true`- 传递`true`给过滤器以启用*严格匹配*。

而已。如果`size.code`是*uniqueID*，我们将只有一个`h1`文本为 的元素`size.name`。

我已经在我的项目中对此进行了测试，并且可以正常工作。

祝你好运**

# c# - 如何使用 asp.net 从另一个用户控件调用用户控件的方法？

> ID：14386572
> 
> 赞同：5
> 
> 时间：2013-01-17T19:27:16.313
> 
> 标签：c#, asp.net, user-controls

我有两个用户控件：`UserControl1`并且`UserControl2`，这些控件是在 Page.aspx 中添加的。

`UserControl1`：此用户控件包含在此用户控件中隐藏文本框的方法。这种方法称为“ `HideTextbox`”

`UserControl2`: 我想`HideTextBox`从`UserControl2`.

我怎样才能调用方法`HideTextBox`？`UserControl2`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-17T19:57:06.933

仅当两者都是用户控件或服务器控件，或者您正在从用户控件中寻找服务器控件时才能使用。（不是来自服务器控件，因为您无法获得对 asp.usercontrol_xx 程序集的引用）

首先获取对父页面的引用（通常可以使用`this.Parent`.`UserControl2`

```
//this for extension method
public static UserControl2 FindUserControl2Recursive(this Control root)
{
    var uc2 = root as ASP.UserControls_UserControl2_ascx;
    if (uc2 != null)
    {
        return uc2;
    }
    foreach (var control in root.Controls)
    {
        uc2 = control.FindUserControl2Recursive();
        if (uc2 != null)
        {
            return uc2;
        }
    }
    return null;
} 
```

一旦你有你的 Usercontrol2 引用，你就可以轻松地调用你的公共方法。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-17T20:29:02.303

这个问题可以通过在 UC2 中创建一个自定义事件并在主页上使用该事件来调用 UC1 上的 hide 方法来解决。

您在用户控件中声明一个委托

```
public delegate void HideTextBoxEventHandler(object sender, EventArgs e); 
```

然后为您创建的委托定义事件

```
public event HideTextBoxEventHandler HideTextBox; 
```

在代码中要隐藏文本框的地方，您需要调用该事件：

```
if (this.HideTextBox != null) // if there is no event handler then it will be null and invoking it will throw an error.
{
   EventArgs e = new EventArgs();
   this.HideTextBox(this, e);
} 
```

然后从主页面创建一个事件处理方法

```
protected void UserControl2_HideTextBox(Object sender, EventArgs e)
{
   UC1.InvokeHideTextBox();  // this is the code in UC1 that does the hiding
} 
```

您将需要添加到页面加载或加载 UC2 的位置

```
UC2.HideTextBox += new UserControl2.HideTextBoxEventHandler(this.UserControl2_HideTextBox); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-17T21:04:00.880

我会在知道如何隐藏文本框的控件上声明接口，如下所示：

```
public interface ITextBoxHider
{
  void HideTextBoxes();
} 
```

之后在 UserControl1 上实现此接口，当您想隐藏文本框时，枚举窗体上的所有控件并找到实现 ITextBoxHider 的控件，然后只需调用该方法：

将枚举所有控件的辅助方法：

```
public static IEnumerable<Control> GetAllChildren(Control parent)
{
  foreach (Control control in parent.Controls)
  {
    foreach (Control grandChild in GetAllChildren(control))
        yield return grandChild;

    yield return control;
  }
} 
```

使用该方法并从 UserControl2 调用 HideTextBoxes ：

```
var hider = GetAllChildren(this.Page).FirstOrDefault(ct => ct is ITextBoxHider);
if (hider != null)
  (hider as ITextBoxHider).HideTextBoxes(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-08T23:37:18.280

在用户控制 2

```
UC1Class UserControl = Parent.FindControl("UC1_Name") as UC1Class;
UserControl.HideTextbox(); 
```

或缩短

```
(Parent.FindControl("UC1_Name") as UC1Class).HideTextbox(); 
```

在用户控件 1

```
public void HideTextbox()
{
    ....Do Something
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-01-17T19:29:45.000

首先，您需要创建`HideTextBox()`一个`public`方法，而不是私有的。

然后调用`UserControl1.HideTextBox()`。

更新：我不清楚获取对 UserControl1 的引用。当我在我的项目中这样做时，我创建了一个接口来声明我要调用的方法，所以我的代码是这样的：

```
IUserControl1 uc1 = (IUserControl1)this.Parent.FindControl("ucOne");
uc1.HideTextBox(); 
```

确保您的 UserControl1 从接口派生： public partial class UserControl1 : System.Web.UI.UserControl, IUserControl1

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-01-17T19:35:17.920

如果你想使用 Usercontrol 的对象访问方法，你必须像这样注册它..

```
UserControl1 uc = new UserControl1();
uc.HideTextBox(); 
```

您必须将 HideTextBox() 声明为 public。

此外，您需要在网络表单上添加一个指令，告诉网络表单您将动态加载用户控件。所以在网络表单中，添加以下指令。

```
<%@ Reference Control = "WebUserControl1.ascx" %> 
```

希望这可以帮助

# r - 从 R 中的线性方程模拟数据

> ID：14386577
> 
> 赞同：1
> 
> 时间：2013-01-17T19:27:35.967
> 
> 标签：r

我有以下形式的线性回归：

```
Y= B0 + B1*X1 + B2*X2 + Be*Xe 
```

如果我假设 Beta 的值`(0.38,0.27,0.10)`并且还假设它`Xi`与`N(0,1)`.

如何生成将是这些变量的线性组合的数据集？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-17T19:46:31.373

这应该有效：

```
beta =c(0.38,0.27,0.10)
beta0 <- 1
N <- 10           
x <- matrix(rnorm(n=N*3) ,ncol=3) ## generate (x1,x2,xe)
y <- beta0 + x %*% beta 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-17T19:51:38.773

如果我正确理解了这个问题，您可以用一个简单的表达式生成它：

```
Y <- .38 + .27 * rnorm(1000) + .10 * rnorm(1000) 
```

这会给你一个向量，`Y`，根据上面的公式分布。

# sqlite - 删除级联上的 SQLite 不起作用

> ID：14386583
> 
> 赞同：0
> 
> 时间：2013-01-17T19:27:53.157
> 
> 标签：sqlite

我创建了一些表：

```
"CREATE TABLE IF NOT EXISTS WORKOUTPLANS (ID INTEGER PRIMARY KEY  AUTOINCREMENT  NOT NULL  UNIQUE , NAME TEXT NOT NULL  UNIQUE, DESCRIPTION TEXT NOT NULL  UNIQUE)";
"CREATE TABLE IF NOT EXISTS ENTITY (ID INTEGER PRIMARY KEY  AUTOINCREMENT  NOT NULL  UNIQUE , NAME TEXT NOT NULL  UNIQUE , DESCRIPTION TEXT NOT NULL  UNIQUE)";
"CREATE TABLE IF NOT EXISTS EXERCISE (ID INTEGER PRIMARY KEY  AUTOINCREMENT  NOT NULL  UNIQUE , NAME TEXT NOT NULL  UNIQUE , DESCRIPTION TEXT NOT NULL  UNIQUE , REPS TEXT NOT NULL , WEIGHT TEXT NOT NULL)";
"CREATE TABLE IF NOT EXISTS WPEN (PLANID, ENID, FOREIGN KEY(PLANID) REFERENCES WORKOUTPLANS(ID) ON DELETE CASCADE, FOREIGN KEY(ENID) REFERENCES ENTITY(ID) ON DELETE CASCADE)";
"CREATE TABLE IF NOT EXISTS ENEX (ENTITYID, EXERCISEID, FOREIGN KEY(ENTITYID) REFERENCES ENTITY(ID) ON DELETE CASCADE, FOREIGN KEY(EXERCISEID) REFERENCES EXERCISE(ID) ON DELETE CASCADE)"; 
```

如您所见，我必须有 m:n 关系，并且在这个连接表中，我对删除级联有约束。我知道每次连接到数据库时我都必须在 sqlite 中激活外键，我也是如此。

但是，当我删除 WORKOUTPLANS 中的一行时，它只是删除了 WORKOUTPLANS 和 WPEN 中的行，而不是 ENTITY、EXERCISE 和 ENEX 中的行

为什么 on delete 级联不起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T19:56:46.487

它只是从 中删除`WORKOUTPLANS`，`WPEN`因为其他人没有`on delete cascade`对`WORKOUTPLANS`.

这是您的架构的摘要，`on delete cascade`其中左侧是具有外键约束`on delete cascade`的表，右侧表具有：

```
WPEN -> WORKOUTPLANS
WPEN -> ENTITY
ENEX -> ENTITY
ENEX -> EXERCISE 
```

因此，如果您删除 中的一行`WORKOUTPLANS`，它也会从 中删除`WPEN`。如果您从中删除，`ENTITY`它也会从`WPEN`和中删除`ENEX`。如果您从 中删除`EXERCISE`，它也会从 中删除`ENEX`。

这是操作的一个很好的[参考链接](http://www.sqlite.org/foreignkeys.html#fk_actions)`on delete`。

这是一个很好的[stackoverflow答案](https://stackoverflow.com/questions/1379333/how-to-cascade-delete-over-many-to-many-table)，听起来像你想要的。

# android - 带有包装文本的 TextView 的 getMeasuredHeight()

> ID：14386584
> 
> 赞同：18
> 
> 时间：2013-01-17T19:27:56.807
> 
> 标签：android, android-layout

我试图在绘制`TextView` **之前确定 a 的高度。**我正在使用以下代码来做到这一点：

```
TextView textView = (TextView) findViewById(R.id.textview);
textView.setText("TEST");
int widthSpec = MeasureSpec.makeMeasureSpec(LayoutParams.MATCH_PARENT, MeasureSpec.EXACTLY);
int heightSpec = MeasureSpec.makeMeasureSpec(0, MeasureSpec.UNSPECIFIED);
textView.measure(widthSpec, heightSpec);
System.out.println("MeasuredHeight: " + textView.getMeasuredHeight()); 
```

输出是`MeasuredHeight: 28`。没有错。

但是，当我给出`TextView`一个长文本字符串时，会发生换行，它仍然给出一行而不是两行的高度：

```
(...)
textView.setText("TESTTESTTESTTESTTESTTESTTESTTESTTESTTESTTESTTESTTESTTESTTESTTESTTEST");
(...) 
```

输出是`MeasuredHeight: 28`我所期望`MeasuredHeight: 56`的。

为什么它没有给我正确的价值，我怎样才能获得正确的价值？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-17T20:40:35.277

这是一个 onCreate 方法。您的整个视图层次结构尚未测量和布局。所以 textView 的父级不知道它的宽度。这就是为什么 textView 的尺寸不受其父尺寸的限制的原因。

尝试将您的线路更改为：

```
int widthSpec = MeasureSpec.makeMeasureSpec(200, MeasureSpec.EXACTLY); 
```

所以它使你的 textview 宽度等于 200 像素。

如果您解释为什么需要 textview 的高度，也许我们可以为您提供帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-17T20:31:37.240

是的，我最近自己碰到了这个。最好的方法是创建一个[ViewTreeObserver](http://developer.android.com/reference/android/view/ViewTreeObserver.html)对象并注册一个 ViewTreeObserver.OnGlobalLayoutListener。这将在布局阶段之后和绘制阶段之前调用。此时您将能够获得 TextView 的大小。

严格来说，这不是文本本身，而是整个 TextView。如果涉及内部填充，实际文本将小于 TextView。

如果您确实需要实际文本的尺寸，请使用`textView.getLayout()`获取文本的[Layout](http://developer.android.com/reference/android/text/Layout.html)对象，然后使用 layout.getHeight()。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-24T11:39:44.017

您必须创建自定义 Textview 并在您的布局中使用它并使用 getActual height 函数在运行时设置高度

```
 public class TextViewHeightPlus extends TextView {
    private static final String TAG = "TextViewHeightPlus";
    private int actualHeight=0;

    public int getActualHeight() {
        return actualHeight;
    }

    public TextViewHeightPlus(Context context) {
        super(context);
    }

    public TextViewHeightPlus(Context context, AttributeSet attrs) {
        super(context, attrs);
        setCustomFont(context, attrs);
    }

    public TextViewHeightPlus(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);

    }

   @Override
    protected void onSizeChanged(int w, int h, int oldw, int oldh) {
        super.onSizeChanged(w, h, oldw, oldh);
        actualHeight=0;

        actualHeight=(int) ((getLineCount()-1)*getTextSize());

    }

} 
```

# c++ - 使用 Boost Thread 在具有不同输入的多个线程上运行函数

> ID：14386597
> 
> 赞同：-1
> 
> 时间：2013-01-17T19:28:50.667
> 
> 标签：c++, boost, boost-thread

假设我有一个返回地图的函数，如：

```
std::map<std::string,std::string>  functionname(string abc123) 
```

如何使用 boost 线程将不同的字符串传递给不同线程中的同一个函数？（返回的值存储在不同的变量中）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T19:42:31.163

```
int main()
{
    string param1 = ...;
    string param2 = ...;

    typedef std::map<std::string,std::string> RetT;
    boost::future<RetT> f1 = boost::async(boost::launch::async,
        boost::bind(functionname, param1));
    boost::future<RetT> f2 = boost::async(boost::launch::async,
        boost::bind(functionname, param2));

    // here they run....

    RetT r1 = f1.get(); // waits for f1
    RetT r2 = f2.get(); // waits for f2

    // Here we have the results in r1 and r2
} 
```

# java - SWT Droptarget 重叠问题

> ID：14386598
> 
> 赞同：1
> 
> 时间：2013-01-17T19:29:03.157
> 
> 标签：java, drag-and-drop, swt, droptarget

我有一个特定转移的一般放置目标区域。放置目标所在的控件是复合控件。在复合材料中，我有很多东西。我最近将放置目标添加到复合材料中的这些对象之一。我现在遇到了 swt 拖放的问题，当我输入第一个整​​体放置目标时，它的行为就像人们期望的那样。但是，当我进入嵌套在原始目标中的第二个放置目标时，它会触发第一个目标的离开和第二个目标的进入。这导致了各种各样的问题。关于如何避免这种情况的任何想法？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T20:15:02.003

我相信一次只能有一个“活动”放置目标，所以我相当肯定你不能让它不离开你的合成物。

但我认为你正在尝试做的事情可能是可能的。总而言之，如果您拖动类型为 A 的对象，您希望能够将其拖放到合成中的任何位置。如果你有一个 B 类型的对象，它应该只能放入子组件中。

如果是这样，如何：让子组件处理 A 和 B 类型的对象。但是如果它得到 A 类型的 drop，它会将事件转发给它的父级。

# c++ - 用 C++ 做简单的测试

> ID：14386602
> 
> 赞同：1
> 
> 时间：2013-01-17T19:29:23.613
> 
> 标签：c++, compilation, main

我需要用 C++ 做一些简单的测试（以前从未做过）。我在 Visual Studio 2010 工作，遇到了内置的测试选项卡。但我真的不喜欢它，而且对我来说似乎过于复杂了。

我只需要一个自定义的 main() 方法，这样我就可以启动快速控制台应用程序并查看类是否按应有的方式执行。

我决定通过创建一个包装启动器文件来使用预处理器定义来克服这个问题，这将是程序的主要起点。

所以，我的 main.cpp 文件包含：

```
#define DESIRED_TEST "some_test.cpp"

#ifndef DESIRED_TEST
#include "main_program.cpp"
#else
#include DESIRED_TEST
#endif 
```

main_program.cpp 是运行整个程序的文件（其中包含 main 方法）。如您所见，如果我定义 DESIRED_TEST 并分配一个包含文件，则不包含 main_program.cpp，并且应该只构建测试文件（其中也包含 main 方法）。但是，在编译时，我得到以下输出：

```
1>main.obj : error LNK2005: _main already defined in some_test.obj
1>main_program.obj : error LNK2005: _main already defined in some_test.obj
1>C:\....... : fatal error LNK1169: one or more multiply defined symbols found 
```

我应该如何告诉编译器程序的主要起点是 main.cpp 并且它应该只根据该文件编译和链接，而忽略所有其他目标文件中的多个定义？

* * *

这是我克服这个问题的方法（main.cpp 文件）：

```
#define DESIRED_TEST "some_test.h"    

#ifndef DESIRED_TEST    

int main(int argc, char *argv[])    
{    
    // main program code here
}    

#else    

#include DESIRED_TEST    

int main() {    
    FUNCTION_CALL();    
}    

#endif 
```

some_test.h 文件：

```
void some_test();
#define FUNCTION_CALL some_test 
```

现在我只需要为每个测试创建新的 some_test.h 和 some_test.cpp 文件并定义函数调用。

我不想在 Visual Studio 中学习测试标准的原因是因为我级别的项目的测试非常简单。我将来可能需要学习它，但是当事情变得非常深入和复杂时，我会学习它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T19:42:51.567

VC 将`.cpp` 文件视为源，应该单独编译，不管它们是否包含在某个地方。这是通常的行为，你最好不要试图改变它。

相反，您可以

*   将`.cpp`文件重命名为`.h`或`.inc`包含头文件
*   将代码包裹`.cpp`在防护中，例如

    ```
    //some_test.cpp
    #ifdef DESIRED_TEST 

    //code

    #endif

    //main_program.cpp
    #ifndef DESIRED_TEST 

    //code 

    #endif 
    ```

    那么你不应该`.cpp`在任何地方包含 s 。 `DESIRED_TEST`可以在通用标题或项目设置中定义。

*   *但最好的办法是学习 Visual Studio 提供的测试框架并使用它。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T19:42:56.730

但是“main_program.cpp”还在你的项目中吗？（并单独编译？）

您在 main.cpp 中：（main.cpp 在项目中）

```
#define DESIRED_TEST "some_test.cpp"

#ifndef DESIRED_TEST
#include "main_program.cpp"
#else
#include DESIRED_TEST
#endif 
```

现在，从项目中（在解决方案资源管理器中）简单地排除 some_test.cpp 和 main_program.cpp，但不要删除文件！IntelliSence、对象浏览器或右键单击包含“指令”以快速打开文件之类的东西仍然有效

# oop - 违反 SOLID 原则

> ID：14386604
> 
> 赞同：0
> 
> 时间：2013-01-17T19:29:27.920
> 
> 标签：oop, class, solid-principles, ooad

假设我们有一个班级结构，其中代码分为两部分，让我们说计算机科学和商业，现在这也进一步在国家/地区划分，例如印度（cs 或 MBA）和美国（cs 或 MBA）。现在让我们考虑一个我创建类的场景

1）教育班（家长班）

2) MBA课程延伸教育课程

3) BS (cs) 类扩展教育类

现在就国家而言，我也上课了

4) INDIA_BS 类扩展了 BS (cs) 类

5)INDIA_MBA类扩展MBA类

6) US_BS 类扩展 BS (cs) 类

7) US_MBA 类扩展 MBA 类

现在让我们说我编写代码，其中国家在层次结构中最低的类方法中设置（即国家类 INDIA_BS、INDIA_MBA、US_BS、US_MBA），
但逻辑是相似的。我通过国家名称并设置它。

所以我的问题是
1）将公共逻辑放在父类中是否明智（如果我这样做）并从层次结构最低的子类中调用该方法）。

2）如果这是错误的，那么它违反的OOPS原则是什么

3）如果是的话，它是否也违反了 SOLID 原则，那么如何？

4）如果我将公共代码放在父类中，是否会降低子类的一致性。

请尽可能详细。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T13:42:27.440

Your class diagram:

![Your class diagram](../Images/cbc5e0a2c6c4c0d70f5b4ab1dca0cd0f.png)

i see x violations:

1.  Favor Composition Over Inheritance
2.  Program To An Interface, Not An Implementation
3.  Software Entities Should Be Open For Extension, Yet Closed For Modification
4.  etc

So, i would suggest you use Abstract Factory pattern. Code:

```
 class Test
    {
        static void Main(string[] args)
        {
            IEducationFactory india = new IndianEducation();
            IEducationFactory newYork = new USEducation();

            IDiplom d1 = india.Create_BSC();
            IDiplom d2 = newYork.Create_MBA();
        }
    }

    public interface IDiplom
    {
    }

    public interface IEducationFactory
    {
        IDiplom Create_MBA();
        IDiplom Create_BSC();
    }

    public class IndianEducation : IEducationFactory
    {
        public IDiplom Create_MBA()
        {
            throw new NotImplementedException();
        }

        public IDiplom Create_BSC()
        {
            throw new NotImplementedException();
        }
    }

    public class USEducation : IEducationFactory
    {
        public IDiplom Create_MBA()
        {
            throw new NotImplementedException();
        }

        public IDiplom Create_BSC()
        {
            throw new NotImplementedException();
        }
    } 
```

And, your class diagram looks like:

![enter image description here](../Images/ece207ac5d990d6b92fcf4ba348a11c9.png)

# java - JAVA NIO Watcher：如何检测持久（复制）操作的结束？

> ID：14386608
> 
> 赞同：2
> 
> 时间：2013-01-17T19:29:41.260
> 
> 标签：java, nio, watchservice

我需要对目录中新引入的文件进行一些 ZIP 操作。我在那里订阅了 CREATE 事件，该事件被触发了。复制到该目录的操作需要一些时间。

所以我在访问文件时得到 ACCESS_DENIED，“被另一个进程锁定”。

NIO 是否提供诸如“LOCK Released”之类的东西，还是我需要以某种方式轮询文件以释放锁？就像这里描述的：http://stackoverflow.com/questions/750471/how-to-know-whether-a-file-copying-is-in-progress-complete-in-java-1-6

谢谢你的帮助。

格尔德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T20:10:20.340

将文件复制到不同的目录中；完成后，将其移动到监视目录。

```
java.nio.file.Files.move(srcFile, targetFile, StandardCopyOption.ATOMIC_MOVE); 
```

观察者将看到一个 CREATE 事件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T19:52:34.713

修改复制操作，以便在写入第一个较大的文件之后，将一个附加的小文件写入同一目录。文件名可以是原始文件的名称，加上扩展名。

您的观察者将查找具有此扩展名的文件，将其删除以获取原始文件名，然后启动 Zip 操作。

另一种选择可能是您的复制操作会写入一个扩展名与您查找的文件不同的文件。完成后，它会重命名文件以赋予其正确的扩展名。

# asp.net - 如何阻止匿名用户的 REST 服务 (ESRI)

> ID：14386610
> 
> 赞同：0
> 
> 时间：2013-01-17T19:29:42.420
> 
> 标签：asp.net, rest, gis, esri

有没有一种有效的方法来阻止匿名用户的 REST 服务？

我正在运行一个网站`ASP.NET 4.0`，人们在其中登录并根据他们的凭据访问不同的地图。我想避免让他们再次登录。

`ESRI WebAdaptor`只是在运行，我`ASP.NET 2.0`很难让它与网站的其他部分一起工作。我根本不是网络大师，只是幸运地继承了这个项目。

感谢您的任何建议或想法！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T13:58:59.000

亚历克斯，

我们也必须在我们的组织内处理这个问题。我们使用 Apache 负载均衡器作为反向代理解决方案，以便仅重定向经过身份验证的用户对 REST 服务的请求。这是我们案例中最合理的解决方案，但您可能会查看 ArcGIS Server 令牌服务：

[保护与服务的 Internet 连接](http://help.arcgis.com/en/arcgisserver/10.0/help/arcgis_server_dotnet_help/index.html#/Securing_Internet_connections_to_services/0093000000q4000000/)

您使用的是哪个版本的 AGS？

# web-services - 对 SAP PI 服务进行匿名身份验证的未经授权的 HTTP 请求

> ID：14386613
> 
> 赞同：5
> 
> 时间：2013-01-17T19:29:48.837
> 
> 标签：web-services, wsdl, sap, sap-xi, sap-pi

我有一个来自我们客户公司的 .WSDL 文件，我需要使用它来调用 Web 服务。他们的系统是 SAP (SAP PI)。我的应用程序是在 VS 2008 中开发的 C# .NET 3.5 客户端。我使用他们提供的 .WSDL 文件在 Visual Studio 中添加了服务参考。这为我创建了一个引用类来调用他们的服务，并为我在 app.config 文件中设置了几个绑定。

我没有更改 app.config 文件中的任何内容，但确实创建了代码来调用他们的 Web 服务。但是，当我调用他们的网络服务时，我收到以下异常：

**HTTP 请求未经客户端身份验证方案“匿名”授权。从服务器收到的身份验证标头是“Basic realm="SAP NetWeaver Application Server ..."”。**

（我稍微修改了“基本领域”部分中使用的字符串，以免泄露。）

app.config 没有从 WSDL 正确构建吗？我应该以某种方式修改 app.config 文件吗？

我尝试过的事情：

*   将 app.config 中的 authenticationScheme 从 Anonymous 更改为 Basic
    （以及所有其他身份验证类型）
*   更改 app.config 中的领域字符串以匹配异常消息中的领域
*   在我的代码中的 ClientCredentials.Username 对象中设置用户名/密码字段

任何指示或帮助将不胜感激。

编辑：经过更多调查，我发现 Visual Studio 有几个关于扩展元素 Policy 和 Policy 断言的警告：

*   自定义工具警告：未处理命名空间“http://schemas.xmlsoap.org/ws/2004/09/policy”中的可选 WSDL 扩展元素“策略”。
*   自定义工具警告：未导入以下策略断言：
    XPath://wsdl:definitions[@targetNamespace='urn:sap-com:document:sap:rfc:functions']/wsdl:binding[@name='Binding_FieldValidation' ] 断言：...

我无法确定这是否与我当前的身份验证方案问题有关。它似乎确实是相关的，但我也找不到任何解决方案来解决这些政策警告。似乎 WCF 不能很好地处理 wsdl 中的语句。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-25T23:42:13.767

大多数 SAP 服务不支持匿名。因此，通过调用传递某种形式的身份验证数据。用户名和密码/X.509 Ticket...

如果您通过调用发送身份验证数据，请尝试此

让 SAP 人员重新生成没有 SAP 断言、没有策略、SOAP 1.1 的 WSDL。您还可以尝试手动编辑 WSDL 以删除多余的废话...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-02T12:05:34.370

作为起点，我将验证您是否可以使用提供的用户名和密码成功调用该服务。使用[SoapUI](http://www.soapui.org)之类的东西来测试一切是否正常 - 只需创建一个新项目，导入 SAP PI 提供的 WSDL，设置用户名和密码并执行调用。您可能会遇到某种形式的异常，其有效负载为空，但至少可以验证用户名和密码是否正确。

一旦您确认它工作正常，请检查您的应用程序是否正确调用该服务以及是否正在发送 http 基本身份验证标头。您可以通过使用网络监控工具并检查是否正确生成了 http 请求来确认这一点。像 Windows 的 netcat 这样的东西可以做到 - 只需让它监听本地机器上的端口，然后指定 localhost 和端口作为 SOAP 端点。

一旦你验证了这两个都是正确的，你的调用应该会成功。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-18T08:44:05.667

必须缺少基本身份验证标头或凭据有问题。

如果服务通过其 SOAP 适配器发布，则 SAP PI 始终默认为基本身份验证。我会调查 WCF 是否确实发送了该标头（例如，将您的客户端端点指向 TCP 网关并让 TCP 网关从 WSDL 指向 SAP PI 端点）。

关于警告：AFAIK SAP PI 生成的 WSDL 将始终包含这些策略标签，您不能真正忽略它。你能做的就是把它们扔掉，因为它们没有得到真正的验证

# java - 故意抛出异常是不好的形式吗？

> ID：14386616
> 
> 赞同：0
> 
> 时间：2013-01-17T19:29:56.543
> 
> 标签：java, android, json, exception

做一些你知道会引发异常的事情是不好的形式（假设你处理得当）？例如：

```
 JSONArray stuff = new JSONArray();
 JSONArray otherStuff = new JSONArray();
 try{
     for(i = 0; i < stuff.length(); i++){
         JSONObject a = stuff.getJSONObject(i);
         otherStuff.add(a);          
      }
 } catch (JSONException e){
     Log.e("FAIL", e.toString());
 }

//more code adding things to array later on 
```

在这种情况下，当您第一次运行序列时，数组将为空，getJSONObject 会抛出异常，因为索引 i 处没有任何内容。但是，稍后，如果将事物添加到数组中，则不会引发异常。

当然，这段代码只是一个假设（我相信有更好的例子——有人可能有），但就形式/风格而言，是否可以故意抛出异常？还是应该避免将它们全部放在一起？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-17T19:32:17.003

根据我的经验，使用异常作为流控制通常被认为是不好的做法。它们应保留用于特殊情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T19:33:29.730

在我看来，如果仅在例外情况下抛出异常而不是作为退出循环的常规方式，那是可以的。

但请注意：创建、抛出和捕获异常并不快。

=> 如果可能（并且不太复杂，我强烈建议不要使用异常。

# ios - 如何在 Xcode 管理器中访问设备日志（不是崩溃报告）

> ID：14386623
> 
> 赞同：3
> 
> 时间：2013-01-17T19:30:12.397
> 
> 标签：ios, logging, xcode4.2, printf, device

Xcode (4.2) 在控制台视图中显示日志。设备日志视图仅显示崩溃日志。控制台视图包含 NSLog 输出（作为警告？）。我从未见过超过一小时左右的日志事件。所有旧日志在哪里？如何访问一周前生成的 NSLog 输出？

[在设备上运行时 NSLog 信息会发生什么](https://stackoverflow.com/questions/5318342/what-happens-to-nslog-info-when-running-on-a-device)问题的答案？声明我应该在设备日志中看到 NSLog 输出。是这样还是不是这样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T20:49:58.150

您的 NSLog 不会保存到磁盘，您只会在控制台中看到最近的日志。如果你想存储你的日志，你需要自己做。此评论有一些不错的选择：

[https://stackoverflow.com/a/13761487/589224](https://stackoverflow.com/a/13761487/589224)

# asp.net-mvc - 两个端点想要共享同一个 ListenUri 但我只有一个

> ID：14386627
> 
> 赞同：1
> 
> 时间：2013-01-17T19:30:24.850
> 
> 标签：asp.net-mvc, wcf

对此已经有很多问题，但在其他情况下，似乎人们正试图拥有多个端点。就我而言，我只有一个并且只想要一个端点。仅当我启用证书传输安全性并且仅在我的开发计算机上才会出现我的错误。

我有一个通过 MVC 中的 ServiceRoute 实现的 WCF 服务：

`RouteTable.Routes.Add(new ServiceRoute("MyServices", new WebServiceHostFactory(), typeof(MyServices)));`

整个 serviceModel 仅包含以下内容：

```
<system.serviceModel>
<serviceHostingEnvironment aspNetCompatibilityEnabled="true" />
<standardEndpoints>
  <webHttpEndpoint>
    <standardEndpoint name="" helpEnabled="true" automaticFormatSelectionEnabled="true">
      <!--<security mode="Transport">
        <transport clientCredentialType="Certificate" />
      </security>-->          
    </standardEndpoint>
  </webHttpEndpoint>
</standardEndpoints>
</system.serviceModel> 
```

当运输安全被注释掉时，它工作正常。取消注释传输安全会导致：

```
A binding instance has already been associated to listen URI 'https://my.dev.machine.local/MyServices'. If two endpoints want to share the same ListenUri, they must also share the same binding object instance. The two conflicting endpoints were either specified in AddServiceEndpoint() calls, in a config file, or a combination of AddServiceEndpoint() and config. 
```

我可以获取代码并将其放在不同的环境中，它可以按预期工作。怎么回事？！？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T17:04:42.530

这是 Visual Studio 2012 RC 中的一个错误。即使我使用的是安装了 VS 2012 RC 的 VS 2010，也会导致此问题。一旦我卸载它，这个问题就解决了。只要确保您遵循 2012 年的特定卸载说明，因为如果您使用“控制面板”中的“卸载程序”选项卸载它，它将破坏 VS 2010 ......我学到了很难的方法。

# ruby - Ruby：在类中的其他人之前调用初始化方法

> ID：14386628
> 
> 赞同：-5
> 
> 时间：2013-01-17T19:30:28.103
> 
> 标签：ruby, class, methods

我有一个包含以下代码的文件，
我希望先运行初始化方法，然后调用

```
class Lol < Redstone

    def initialize
        super 2013
    end

    call "/" do |headers|
        "headers"
    end

end 
```

但是当我执行这个时，首先调用方法调用。如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T19:36:10.400

`initialize`是这个类中的一个实例方法，所以`def initialize`只是为这个类设置了构造函数。`call..`在解析类定义时调用*类的* `call`方法。这段代码相当于

```
class Lol < Redstone
  def initialize
    super 2013
  end
end

Lol.call "/" do |headers|
  "headers"
end 
```

（假设 call 是一个公共类方法）

`call`除了实际类定义中的代码（如方法）之外，Ruby 并没有真正的类构造函数的概念。如果你需要做某事，你可以这样做：

```
class Lol < Redstone
  def self.init
    #do class setup
  end
  init
  def initialize
    super 2013
  end

  call "/" do |headers|
    "headers"
  end
end 
```

但是，根据您希望它的工作方式，这可能无法满足您的需求。

# android - 谷歌地图 - 运行时异常 - 错误膨胀类片段

> ID：14386631
> 
> 赞同：2
> 
> 时间：2013-01-17T19:30:36.823
> 
> 标签：android, google-maps, google-maps-android-api-2

我只是尝试在显示屏上查看地图，但它不起作用。我得到一个运行时异常：

```
01-17 19:16:47.066: E/AndroidRuntime(6605): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.maptest/com.example.maptest.MainActivity}: android.view.InflateException: Binary XML file line #7: Error inflating class fragment 
```

爪哇：

```
import com.google.android.gms.common.GooglePlayServicesUtil;
import com.google.android.gms.maps.GoogleMap;
import com.google.android.gms.maps.SupportMapFragment;
import com.google.android.gms.maps.MapFragment;
import com.google.android.maps.MapActivity;
import com.google.android.maps.MapView;
import android.os.Bundle;
import android.app.Activity;
import android.support.v4.app.FragmentActivity;
import android.support.v4.app.Fragment;

public class MainActivity extends FragmentActivity {
 getSupportFragmentManager().findFragmentById(R.id.map))

@Override
protected void onCreate(Bundle savedInstanceState) {
    GooglePlayServicesUtil.isGooglePlayServicesAvailable(getApplicationContext());

    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    SupportMapFragment fragment = new SupportMapFragment();
    getSupportFragmentManager().beginTransaction()
            .add(android.R.id.content, fragment).commit();

    setContentView(R.layout.activity_main);

    GooglePlayServicesUtil.isGooglePlayServicesAvailable(getApplicationContext());

    GoogleMap map = ((SupportMapFragment) 
 getSupportFragmentManager().findFragmentById(R.id.map)).getMap();
}

} 
```

显现

```
<?xml version="1.0" encoding="utf-8"?>
 <manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.maptest"
    android:versionCode="1"
    android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="8"
            android:targetSdkVersion="16"/>
  <permission
      android:name="com.example.maptest.permission.MAPS_RECEIVE"
      android:protectionLevel="signature"/>
    <uses-permission android:name="android.permission.INTERNET"/>
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
    <uses-permission android:name="com.google.android.providers.gsf.permission.READ_GSERVICES"/>
    <uses-permission android:name="com.example.mapdemo.permission.MAPS_RECEIVE"/>

    <uses-feature
        android:glEsVersion="0x00020000"
        android:required="true"/>
<application
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <meta-data
        android:name="com.google.android.maps.v2.API_KEY"
        android:value="removed"/>

    <activity
        android:name="com.example.maptest.MainActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <category android:name="android.intent.category.EMBED"/>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>

    </activity>
           <uses-library android:name="com.google.android.maps"/>
</application>

</manifest> 
```

布局xml：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MainActivity" >

  <fragment xmlns:android="http://schemas.android.com/apk/res/android"
     android:id="@+id/map"
     android:name="com.google.android.gms.maps.SupportMapFragment"
     android:layout_width="match_parent"
     android:layout_height="match_parent"
     class="com.google.android.gms.maps.MapFragment"/>
</RelativeLayout> 
```

关键是 v2，我严格遵循我找到的谷歌教程。我还导入了安卓播放服务。

有人可以帮我吗？:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T19:51:29.977

我在尝试 Map API v2 时遇到了类似的错误。不过，不知道对你有没有帮助。

我的问题是 google-play-services_lib 必须作为库包含在内。在 Eclipse 中，您可以执行以下操作：

1.  使用 Android SDK Manager 下载库。
2.  创建一个新的“来自现有代码的 Android 项目”，指向用于安装 SDK 的文件夹中的 google-play-services_lib。
3.  在“Project -> Properties -> Android”下，将此项目标记为“Is library”。
4.  在您的项目中，还打开“项目 -> 属性 -> Android”，然后单击库部分中的“添加”。选择 google-play-services_lib。

至少这对我有用。

# winforms - MVP：是 View 还是 Presenter 应该知道 Model？

> ID：14386633
> 
> 赞同：7
> 
> 时间：2013-01-17T19:30:40.063
> 
> 标签：winforms, design-patterns, mvp

相对较新的模式，让我直接在 WinForms 的上下文中展示一个示例。

我有一个基本的 MVP Passive View 结构，我应该继续使用它：

```
public partial class UserView : Form, IUserView
{
    public event EventHandler Save;

    public UserView()
    {
        InitializeComponent();

        new UserPresenter(new UserModel(), this);
    }
}

public class UserPresenter
{
    public UserPresenter(IUser model, IUserView view)
    {
        view.Save += (sender, e) => model.Save();
    }
} 
```

或者

```
public partial class UserView : Form, IUserView
{
    public event EventHandler Save;

    public UserView()
    {
        InitializeComponent();

        new UserPresenter(this);
    }
}

public class UserPresenter
{
    public UserPresenter(IUserView view)
    {
        var model = new UserModel();
        //assuming I have the logic to bind property values from View to Model
        view.Save += (sender, e) => model.Save();
    }
} 
```

我的问题是：

`User`1) 谁应该知道 model 、 View 或 Presenter的具体实例？

2）在这种情况下会有什么好处？

3）假设我的模型从不依赖于视图。在那种情况下，如果 View 知道 Model 有什么问题？毕竟`UserView`是为了呈现`UserModel`不是吗？

4）如果Presenter应该只与Model和View的接口交互，那么要调用eventhandler，我`model.Save`从`Save`哪里得到具体的实例`Model`？

[这里](https://stackoverflow.com/questions/13352704/model-view-presenter-passive-view-who-loads-the-model)和[这里](https://stackoverflow.com/questions/13015999/mvp-view-knows-model)有两个重复的问题，但我猜它们并没有完全处理我的场景。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-18T19:12:22.113

严格来说，你应该有以下规则：

1.  模型不知道视图或演示者。
2.  View 不知道 Model 或 Presenter。
3.  Presenter 知道模型和视图，但只能通过它们的接口。

Presenter 协调模型和视图之间的所有通信，通常通过处理视图引发的事件。所以回答你的问题：

**1) 谁应该知道模型 User、View 或 Presenter 的具体实例？**

理想情况下，两者都不是。Presenter 应该通过 IUserModel 接口与 UserModel 通信。具体实例被注入到 Presenter 中（例如通过它的构造函数）。

**2）在这种情况下会有什么好处？**

主要好处是自动化单元测试。您可以注入模拟模型或视图来单独测试单元。

**3）假设我的模型从不依赖于视图。在那种情况下，如果 View 知道 Model 有什么问题？毕竟 UserView 是为了呈现 UserModel 不是吗？**

它本质上没有任何问题。MVP 的变体支持从视图到模型的直接通信，通常是为了利用数据绑定。您失去了一些可测试性以换取不必从头开始编写绑定代码。

**4）如果Presenter应该只与Model和View的接口交互，那么在Save事件处理程序中调用model.Save，我从哪里得到Model的具体实例？**

依赖注入，如下图所示的简化示例。

```
public class SamplePresenter
{
     public SamplePresenter(ISampleModel model, ISampleView view)
     {
          view.Saved += (sender, e) => model.Save();
     }
}

public interface ISampleModel
{
     void Save();
}

public interface ISampleView
{
     void Show();
     event EventHandler Saved;
}

public class Program
{
     [STAThread]
     static void Main()
     {
          ISampleModel model = new SampleModel();
          ISampleView view = new SampleView();
          SamplePresenter presenter = new SamplePresenter(model, view);
          view.Show();
     }
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-17T19:58:04.747

> 如果视图知道模型有什么问题？毕竟 UserView 是专门为 UserModel 制作的，不是吗？

没有。`Supervising Controller`在 MVP 模式的变体中，这是公认的做法。视图直接与模型交互以进行简单操作，而更复杂的操作则通过演示者进行编组。在 中`Passive View`，一切都通过演示者。

此外，请参阅 Jeremy Miller 的***构建您自己的 CAB 系列***，以更好地了解这两种方法之间的差异：[监督控制器](http://codebetter.com/jeremymiller/2007/05/25/build-you-own-cab-part-3-the-supervising-controller-pattern/)和[被动视图](http://codebetter.com/jeremymiller/2007/05/31/build-your-own-cab-part-4-the-passive-view/)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-17T19:38:20.063

演示者应该知道模型，视图不应该。在许多用户界面应用程序中，表示层是一个好主意。表示层只是一个适配器。它提供了一个易于用户界面层使用的界面（即，它提供了许多事件、可绑定属性等），同时隐藏了底层数据层。这使得数据层更容易重用。

**编辑**

那么为什么视图不能直接与模型对话呢？它当然可以。问题是模型和视图之间通常存在阻抗不匹配。换句话说，视图自然使用的编程接口与模型自然公开的接口不匹配。如果您调整模型以适应视图的需求，那么您最终会在模型和您正在使用的特定类型的界面之间创建强耦合。

例如，您的应用程序今天可能是一个 GUI 应用程序，但如果明天您被要求为云生成一个版本怎么办？当您尝试切换到 WCF Rest 时，对 Winforms 有帮助的事件和可绑定属性只会妨碍您。如果您使用表示层，那么使您的代码适应新环境会容易*得多*。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-17T19:44:30.320

如果您对演示模式的介绍还不算多，我建议您看一下 MVP 的 Presenter-first 变体。

在这个变体中，并为您的问题提供答案，演示者知道模型和视图，但只能通过接口。视图和模型都不知道彼此。演示者通过事件和方法来协调每一个。

[http://atomicobject.com/pages/presenter+first](http://atomicobject.com/pages/presenter+first)

[http://spin.atomicobject.com/2008/01/30/presenter-first-get-your-triads-talking/](http://spin.atomicobject.com/2008/01/30/presenter-first-get-your-triads-talking/)

例子：

```
Class Presenter {
    private IModel model;
    private IView view;

    void Presenter(IModel model, IView view) {
        _model = model;
        _view = view;
    }

    void Initialise() {
        // Attach handler to event view will raise on save
        _view.OnSave += HandleViewSave();
    }

    void HandleViewSave(){
        _model.Save(_view.GetStuffToSave());
    }
} 
```

非常基本的例子，但说明了这一点。演示者只是视图和模型之间通信的管道。

可以使用 Poor Man 的 DI 或适当的容器来创建演示者：

```
Presenter p = new Presenter(new CustomerModel(), new CustomerForm()); 
```

请注意，AtomicObject 建议不要引用 Presenter，因此它实际上看起来像这样：

```
new Presenter(existingCustomerModel, existingCustomerForm);

existingCustomerModel.Initialise(); 
```

模型和视图具有范围这一事实意味着演示者也通过其引用保持在范围内......聪明。

# c# - 优化缓冲样本以进行并行执行

> ID：14386638
> 
> 赞同：1
> 
> 时间：2013-01-17T19:30:51.533
> 
> 标签：c#, multithreading

我有这个缓冲算法

```
while (aufnahme || ArrayAnsammlung.Count > 1)
{
    if (ArrayAnsammlung != null)
    {
        int l = ArrayAnsammlung.Count - 1;
        //db(l.ToString());

        for (int DurchLaeufer = 0; DurchLaeufer < l; DurchLaeufer++)
        {
            if (ArrayAnsammlung[DurchLaeufer] != null)
            {
                Nummerierung = Convert.ToString(Nummerierungszaehler);
                Enkodierung = new JpegBitmapEncoder();
                Enkodierung.FlipHorizontal = true;
                //Enkodierung.FlipVertical = false;
                var dateiStrom = new FileStream("E:\\Temp\\" + datum + " " + Nummerierung.PadLeft(12, '0') + ".jpg", FileMode.Create);
                Enkodierung.Frames.Add(BitmapFrame.Create(BitmapSource.Create(bildbreite, bildhoehe * 2,
                96, 96, PixelFormats.Bgr32, null, ArrayAnsammlung[DurchLaeufer], stride)));
                Enkodierung.Save(dateiStrom);
                dateiStrom = null;
                Enkodierung = null;
                Nummerierungszaehler++;
            }
        }
        if (l > 0)
        {
            ArrayAnsammlung.RemoveRange(0, l);
        }
    }
    Thread.Sleep(60);
} 
```

*   DurchLaeufer 只是一个索引。
*   ArrayAnsammlung 是一个数组，每个字段都包含图像数据。因此*for*部分遍历字节数组内容。
*   这一切都发生在一个运行的线程中，而另一个线程中的图像正在写入 ArrayAnsammlung。缓冲区是必要的，因为传送的图像多于处理的图像（转换为 jpeg）。
*   aufnahme 是一个布尔值，当图像数据被写入 ArrayAnsammlung 时为真。
*   Nummerierung 是一个帮助分离图像的计数器

它可以工作，但根据分析器，它的负载很高

```
while (aufnahme || ArrayAnsammlung.Count - 1 > 0) 
```

它使应用程序延迟运行。

我怎样才能优化这个，或者特别是使用 Parallel.For 而不弄乱顺序。因此，在并行执行时，顺序必须与 for 循环中的相同。

PS：我加了

```
Thread.Sleep(60); 
```

这对减轻工作量有帮助吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T19:35:35.420

> 它周围的负载很高`while (aufnahme || ArrayAnsammlung.Count - 1 > 0)`

这意味着它在 Array 为空时循环很多。您可以使用 WaitHandle 解决此问题，没有理由将 CPU 浪费在空集合上。

但更好和更简单的解决方案是使用`ConcurrenQueue<T>`or a `BlockingCollection`here。然后，您可以使用`myQueue.Take()`.

* * *

好的，请求的代码示例：

```
//untested

// the new definition
private BlockingCollection<byte[]> ArrayAnsammlung = new BlockingCollection<byte[]>();

while (aufnahme)
{
   byte[] data = ArrayAnsammlung.Take();

   if (data != null)
   {
     int localNum = Interlocked.Increment(ref Nummerierung);  // initialize it 1 lower

      ... // process data
   }
} 
```

这是粗略的想法。您可能想检查`CompleteAdding()`结果如何停止。

* * *

附带问题：

```
while (aufnahme || ArrayAnsammlung.Count - 1 > 0)
{
    if (ArrayAnsammlung != null)
    { 
```

测试`!= null`来不及了，你已经`.Count`在周围循环使用了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T19:35:56.540

你为什么不尝试：

```
Thread.Sleep(0); 
```

来自[MSDN](http://msdn.microsoft.com/en-us/library/d00bd51t.aspx)：“指定零 (0) 以指示该线程应暂停以允许其他等待线程执行。”

# actionscript-3 - as3 嵌入声音无法转换为 Class 类型？

> ID：14386640
> 
> 赞同：0
> 
> 时间：2013-01-17T19:31:17.923
> 
> 标签：actionscript-3, load, embed

将声音嵌入到我的 .swf 中。

```
[Embed(source='/audio/files/sp_worm.mp3')]
private var sf_warp_finish:Class; 
```

在这里阅读：

```
var sndClass:Class;
if (soundId == "sf_warp_finish") sndClass = new sf_warp_finish(); 
```

并收到此错误：

```
Type Coercion failed: cannot convert GameSoundManager_sf_warp_finish@a94eb31 to Class. 
```

不知道为什么这不起作用 - 有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T19:47:10.937

sf_warp_finish 实际上是嵌入数据的类；当你调用 new() 时，你实例化它，现在你有一个对象（不是 Class 对象）。

有关示例，请参见[http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/mx/core/SoundAsset.html 。](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/mx/core/SoundAsset.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T21:15:41.993

它应该工作：

```
var snd:Sound;
if (soundId == "sf_warp_finish") snd = new sf_warp_finish() as Sound;
if (snd)
    snd.play(); 
```

# svg - 如果两个部分不透明的形状重叠，我可以在它们重叠的地方只显示一个形状吗？

> ID：14386642
> 
> 赞同：5
> 
> 时间：2013-01-17T19:31:24.990
> 
> 标签：svg, opacity

例如，如果您有一个由圆形和矩形组成的简单“间谍玻璃”形状，并且两者的轮廓都是部分透明的，您能否有效地阻止两个形状重叠的不透明度降低？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-17T20:50:04.817

您可以使用过滤器来调整不透明度值。比如说，两个形状的不透明度值都是 0.5，那么你想让两个形状重叠的区域也有 0.5 的不透明度值。

```
<svg xmlns="http://www.w3.org/2000/svg" width="300px" height="300px">
  <filter id="constantOpacity">
    <feComponentTransfer>
      <!-- This transfer function leaves all alpha values of the unfiltered
           graphics that are lower than .5 at their original values.
           All higher alpha above will be changed to .5.
           These calculations are derived from the values in
           the tableValues attribute using linear interpolation. -->
      <feFuncA type="table" tableValues="0 .5 .5" />
    </feComponentTransfer>
  </filter>

  <line x2="300" y2="300" stroke="black" stroke-width="10"/>
  <path d="M0 150h300" stroke="blue" stroke-width="10"/>
  <g filter="url(#constantOpacity)">
    <rect x="50" y="50" width="150" height="150" opacity=".5" fill="green" id="rect1"/>
    <rect width="150" height="150" opacity=".5" fill="red" id="rect2"
          x="100" y="100"/>
  </g>
</svg>
```

您可以看到添加滤镜可以让背景以恒定的强度发光。但是，形状的颜色会变得更苍白、更灰暗（除非两种颜色相同）。也许您可以妥协，使用类似的`tableValues`属性`0 .5 .75`而不是`0 .5 .5`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-12-28T10:38:47.707

如果将形状构造为单个 SVG`path`元素，则重叠*不会*产生更暗的结果。

如果形状是由多个 SVG 元素构成的，那么重叠部分*确实会*产生更暗的结果。

```
<svg xmlns="http://www.w3.org/2000/svg" width="300px" height="300px">
<!-- No summing here -->
<g>
    <path d="M10,10 L100,100 M10,100 L100,10" style="stroke: #000000; stroke-width: 10px; opacity: 0.5" />
</g>
<!-- Summing here -->
<g>
    <path d="M200,200 L290,290" style="stroke: #000000; stroke-width: 10px; opacity: 0.5" />
    <path d="M200,290 L290,200" style="stroke: #000000; stroke-width: 10px; opacity: 0.5" />
</g>
</svg> 
```

# spotify - 在 PySpotify 中，试图在不知道曲目在播放列表中的位置的情况下从播放列表中删除曲目

> ID：14386644
> 
> 赞同：0
> 
> 时间：2013-01-17T19:31:36.097
> 
> 标签：spotify, libspotify

我正在尝试从播放列表中删除曲目，而我所知道的有关曲目的信息是 spotify URI、曲目名称和艺术家。但是，我不知道曲目在播放列表中的位置。
删除曲目的函数如下： spotify.Playlists.remove_tracks(tracks) 参数：tracks (list of int) - 要从播放列表中删除的曲目位置列表

除了将曲目添加到播放列表时，我还没有找到任何可以提供此信息的回调或类方法，这可能发生在另一个会话中。
有没有人成功地做到这一点，如果是这样，你能指出我是如何做到的吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T21:09:40.057

我自己没有使用过 PySpotify，但是查看文档，它说播放列表是可迭代的曲目序列。我认为您应该能够遍历曲目并使用 str(spotify.Link.from_track(track)) 获取每个曲目的链接。然后，您可以轻松地查找与您的轨道 URI 匹配的索引。

# android - 从集合中取消 AsyncTasks

> ID：14386647
> 
> 赞同：2
> 
> 时间：2013-01-17T19:31:43.413
> 
> 标签：android, android-asynctask

假设我有具有静态列表任务的 TasksManager（不确定列表是否是好的解决方案）并且有静态方法`addTaskToList(MyTask task){tasks.add(task);}, removeTaskFromList(MyTask task){tasks.remove(task);}` doInBackground() 中的每个任务都调用第一个方法，而在 onPostExecute() 中还有第二个带有“this”的方法调用。MyTask 具有字符串字段“方法”。

我想取消此列表的任务，其中 task.getMethod().contains("url").. 不确定此代码是否足以稳定工作.. 看起来任务的 onCancelled() 并不总是被调用，多线程可能很危险对于我认为的这种方法。

```
 for (MyTask task : tasks) {
        if (task.getMethod().contains("url")) {
            task.cancel(true);
            break;
        }
    } 
```

以这种方式存储任务是正常做法还是您可以建议我更优雅？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T20:11:23.883

取消 an`AsyncTask`并不总是立即/显而易见的事情。如果您正在使用`cancel`，您还需要确保`doInBackground`知道[`isCancelled`](http://developer.android.com/reference/android/os/AsyncTask.html)并且您必须停止您自己正在做的事情（请参阅 文​​档`isCancelled`）。

我不建议存储`AsyncTask`对象列表并迭代它们以进行顺序后台工作。听起来它可能很快就会变得非常混乱。每个都会`AsyncTask`创建一个新`Thread`的 ，这听起来不像您想要的。相反，您可能只想要一个可以在其上执行操作的后台线程？

对于一个后台线程，您可以使用[HandlerThread](http://developer.android.com/reference/android/os/Handler.html#q=HandlerThread)和您自己的 Looper，如下所示：

```
HandlerThread backThread = new HandlerThread("BackLooper", Thread.NORM_PRIORITY);
backThread.start();
Looper backLooper = backThread.getLooper();

private synchronized void runOnBackThread(Runnable r) {
   new Handler(backLooper).post(r);
} 
```

然后，您希望按顺序运行的每个项目都可以通过提交一个`Runnable`. 而且，您也可以使用其他[Handler](http://developer.android.com/reference/android/os/Handler.html) post 变体，postDelayed、postAt 等。

而且，根据您正在做的事情，您可能会发现[IntentService](http://developer.android.com/reference/android/app/IntentService.html) *非常*有帮助。`IntentService`专门为“工作队列”类型模式提供。它有一个后台线程，当你调用它时，它会做任何你告诉它做的事情，当你不需要它时它会自行消失。

最后，如果您正在为 Android 寻找一个非常好的通用“任务”类型库，请查看 Square 的[Tape](http://square.github.com/tape/)。这与您的问题没有直接关系，但我发现 Tape 对于更强大的“排队”任务类型情况非常方便。

# javascript - 创建新的多维数组时出现问题

> ID：14386649
> 
> 赞同：2
> 
> 时间：2013-01-17T19:31:46.283
> 
> 标签：javascript, arrays, multidimensional-array, undefined

我尝试从另一个多维数组创建一个新的多维数组。第一个数组如下所示：

```
array[0][0] = foo
array[0][1] = foo2
...and so on
array[1][0] = 123
array[1][1] = 234
...and so on
array[2][0] = blue
array[2][1] = red
...and so on
array[3][0] = fish
array[3][1] = bird
...and so on 
```

...然后我有一个名为“结果”的数组，其中包含数字（例如 1、20、23）。我想做的是创建一个新的多维数组，就像第一个数组一样，但只有第一个数组中的元素作为数组“结果”中的数字找到。

以下是我到目前为止的尝试，但不起作用。当我运行代码时，我收到以下错误消息：

```
Uncaught TypeError: Cannot set property '0' of undefined) <- line 5 
```

我究竟做错了什么？

```
1: var newArray = [];
2:
3: for (var i = 0; i < results.length; i++) {
4:    var index = results[i]
5:    newArray[0][i] = array[0][index];
6:    newArray[1][i] = array[1][index];
7:    newArray[2][i] = array[2][index];
8:    newArray[3][i] = array[3][index];
9: } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-17T19:33:25.563

你总是需要初始化数组：

```
newArray[0] = []; 
```

* * *

就像在这个例子中：

```
var newArray = [];
// newArray[12345] is undefined
newArray[12345][2] = 3; // error! 
```

`newArray[12345]`是`undefined`，并且您想将未定义的元素视为数组。所以在你可以这样做之前，你需要初始化子数组：

```
var newArray = [];
newArray[12345] = []; // now "newArray[12345]" is new subarray
newArray[12345][2] = 3; 
```

* * *

**编辑：**

```
var newArray = [];

for (var i = 0; i <= 3; i++) {
    newArray[i] = []; 
    //newArray[i] = new Array(); - same thing
}

for (var i = 0; i < results.length; i++) {
    var index = results[i]
    newArray[0][i] = array[0][index];
    newArray[1][i] = array[1][index];
    newArray[2][i] = array[2][index];
    newArray[3][i] = array[3][index];
} 
```

# sql-server - 将 XML 显式查询设置为变量

> ID：14386650
> 
> 赞同：4
> 
> 时间：2013-01-17T19:31:47.020
> 
> 标签：sql-server, sql-server-2008, tsql

我需要在 SQL 中生成以下 XML 字符串并将其分配给一个变量。

```
<List>
   <V Value="TESt">
       <Target a="10" b="11"/>
   </V>
   <T Value="TESt1">
       <Target a="100" b="101"/>
   </V>
</List> 
```

因此，我编写了以下 SQL 代码：

```
;WITH XML_CTE AS
(
SELECT 
    1 AS TAG,
    NULL AS Parent,
    UT.title AS [v!1!Value],
    null AS [Target!2!a],
    null AS [Target!2!b]
FROM 
(
    select  
        10 AS A,
        11 AS B,
        'TESt' as title
    union
        select  
        100 AS a,
        101 AS b,
        'TESt1' as title
)UT
UNION ALL
SELECT
    2,
    1,
    UT.title AS Value,
    ut.a,
    ut.b
FROM
(
    select  
        10 AS a,
        11 AS b,
        'TESt' as title
    union
        select  
        100 AS a,
        101 AS b,
        'TESt1' as title
)ut
)
SELECT * FROM XML_CTE 
ORDER BY 
    [V!1!Value], 
[Target!2!a]
FOR XML EXPLICIT, ROOT('List') 
```

但是如何将它分配给 xml（或 nvarchar）变量？由于“UNION ALL”，我不得不将它包装在 CTE 中，但是将它放在 CTE 中，我无法将它分配给变量。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T20:47:20.343

您可以将`SELECT * FROM XML_CTE...`语句更改为以下内容

```
SELECT @MyVariable = 
    (SELECT * FROM XML_CTE 
    ORDER BY 
        [V!1!Value], 
    [Target!2!a]
    FOR XML EXPLICIT, ROOT('List')
    ) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-17T20:47:23.637

假设您有一组初始数据，例如：

```
Col1     A     B
------------------
TESt     10    11
TESt1   100   101 
```

那么我建议使用`FOR XML PATH,ROOT`而不是旧的遗留`EXPLICIT`模式（这真的很复杂和令人费解）

```
DECLARE @result NVARCHAR(MAX)

;WITH XML_CTE(Col1, A, B) AS
(
  SELECT 
     'TESt', 10, 11
  UNION
  SELECT    
    'TESt1', 100, 101
)
SELECT @Result =
   (SELECT
       Col1 AS '@Value',
       A AS 'Target/@a',
       B AS 'Target/@b'
    FROM XML_CTE 
    FOR XML PATH('V'), ROOT('List')
   ) 
```

给我一个输出：

```
<List>
  <V Value="TESt">
    <Target a="10" b="11" />
  </V>
  <V Value="TESt1">
    <Target a="100" b="101" />
  </V>
</List> 
```

正如你所要求的。

# angularjs - Angularjs - 社交媒体按钮不显示在部分中

> ID：14386652
> 
> 赞同：4
> 
> 时间：2013-01-17T19:31:50.763
> 
> 标签：angularjs, facebook, twitter, google-plus, single-page-application

我在我的 Angularjs 应用程序（facebook、twitter、google+）中使用了一些社交按钮。如果我在我的 index.html 主页面中包含这些按钮，它们就会显示得很好。但是，如果我将它们包含在部分中，然后导航到该部分，它们根本不会出现。为什么是这样？我使用 ng-view 将部分内部 index.html 包括在内。

以下是我应该包含在结束正文标签正上方的 fb、twitter 和 g+ 按钮的脚本。这住在 index.html

```
<!-- Facebook -->
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=269163553107202";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

<!-- Google Plus - Place this tag after the last +1 button tag. -->
<script type="text/javascript">
  (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  })();
</script>     
<!-- Pinterest -->
<script type="text/javascript" src="//assets.pinterest.com/js/pinit.js"></script> 
```

按钮本身位于我的 share.html 部分中。

```
<li class="facebook">
    <img src="/img/icon-facebook.png" alt="facebook"/>
    <div style="margin: 0 auto; display: block" class="fb-like" data-href="{{url}}" data-send="false" data-layout="button_count" data-width="450" data-show-faces="false"></div>
</li>
<li class="twitter">
  <img src="/img/icon-twitter.png" alt="twitter">
  <a style="width: 77px;" href="https://twitter.com/share" class="twitter-share-button" data-url="{{url}}" data-via="slowfoodnation" data-hashtags="">Tweet</a>
  <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</li>
<li class="google-plus">
  <img src="/img/icon-google-plus.png" alt="google plus"/>
  <!-- Place this tag where you want the +1 button to render. -->
  <div class="g-plusone" data-size="medium" data-annotation="none" data-href="{{url}}"         </div>
</li> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-17T23:43:22.197

正如评论中所讨论的（但在这里重复，所以这个问题不会出现在“未回答”列表中）：确保 jQuery 已加载，并且在 Angular 之前加载。

“ [jqLit​​e](http://docs.angularjs.org/api/angular.element) ”（Angular 对 jQuery 功能子集的实现）无法处理`<script>`ng-include 部分中的标签。如果加载了 jQuery（在 Angular 之前），那么 Angular 将使用 jQuery 而不是 jqLit​​e。jQuery 可以处理`<script>`ng-include'd 部分中的标签。

# c - 在函数中释放内存

> ID：14386655
> 
> 赞同：1
> 
> 时间：2013-01-17T19:32:10.733
> 
> 标签：c, memory-management, memory-leaks, valgrind

我正在用 C 编写一个简单的程序，它根据在哈希表中查找单词来查找单词的字谜。我所拥有的是一个哈希表数组，其中单词按其长度索引，并通过其字母的总和在其中进行哈希处理，例如 a = 1、b = 2 等。

我仍然熟悉 C 中的动态内存管理，所以这个问题可能很简单，但我有一个函数可以为每个哈希表（及其内部数据）分配和取消分配内存。

我最初使用单个哈希表编写此程序，通过 valgrind 运行程序后，我发现内存已正确释放并且没有泄漏。然而，当扩展程序以使用哈希表数组时，valgrind 开始发现可能的泄漏（尽管它报告它们仍然可以访问）。我对为什么在哈希表数组中没有正确释放内存感到困惑，尽管数组中的每个哈希表都是通过最初使用的 deallocate 函数运行的。

完整代码的要点[完整代码](https://gist.github.com/4559692)

```
typedef struct Bucket Bucket;
typedef struct HashTable HashTable;

struct Bucket {
  char* data;
  Bucket *next;
};

struct HashTable {
  int size;
  Bucket **buckets;
};

int main(int argc, char const *argv[])
{

  // Allocate memory for array of hash tables
  HashTable** hash_array = (HashTable**) malloc(sizeof(HashTable*) * WORD_SIZE);
  for(i = 0; i < WORD_SIZE; i++) {
    hash_alloc(&hash_array[i], BUCKET_COUNT);
  }

  // Main logic here...

  // Free memory
  for(i = 0; i < WORD_SIZE; i++) {
    hash_dealloc(hash_array[i]);
  }
  free(hash_array);
  return 0;
} 
```

哈希表分配函数

```
void hash_alloc(HashTable** a, unsigned int size) {
  *a = (HashTable*) malloc(sizeof(HashTable));
  (*a)->buckets = (Bucket**) malloc(sizeof(Bucket*) * size);
  (*a)->size = size;
} 
```

哈希表释放函数

```
void hash_dealloc(HashTable* a) {
  int i;
  Bucket* current, *temp;
  for(i = 0; i < a->size; i++) {
    current = a->buckets[i];
    while(current != NULL) {
      temp = current;
      free(temp->data);
      current = current->next;
      free(temp);
    }
    free(current);
  }
  free(a->buckets);
  free(a);
} 
```

添加到哈希表函数

```
void add_to_hash_array(HashTable** a, char* data) {
    // Removed some other logic for readability...

    replace_str(data, "\n", "\0");
    newNode->data = strdup(data);
    newNode->next = currentTable->buckets[index];
    currentTable->buckets[index] = newNode;
  } else {
    return;
  }
} 
```

Valgrind 输出

```
==39817== 261,120 bytes in 128 blocks are still reachable in loss record 5 of 7
==39817==    at 0x4C2B6CD: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==39817==    by 0x400A38: hash_alloc (main.c:73)
==39817==    by 0x4008B0: main (main.c:39)
==39817== 
==39817== 286,936 bytes in 31,553 blocks are still reachable in loss record 6 of 7
==39817==    at 0x4C2B6CD: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==39817==    by 0x4EBAD71: strdup (strdup.c:43)
==39817==    by 0x400D4D: add_to_hash_array (main.c:141)
==39817==    by 0x400914: main (main.c:51)
==39817== 
==39817== 504,848 bytes in 31,553 blocks are still reachable in loss record 7 of 7
==39817==    at 0x4C2B6CD: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==39817==    by 0x400D16: add_to_hash_array (main.c:136)
==39817==    by 0x400914: main (main.c:51) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T00:48:40.207

Ther's no memory leak, but the code has some problems (the `replace_str` function need to be replaced by a correct version). The output of valgrind on my linux box:

```
$ valgrind --leak-check=full --show-reachable=yes ./MEMORY_LEAK absurde
==13476== Memcheck, a memory error detector
==13476== Copyright (C) 2002-2010, and GNU GPL'd, by Julian Seward et al.
==13476== Using Valgrind-3.6.1-Debian and LibVEX; rerun with -h for copyright info
==13476== Command: ./MEMORY_LEAK absurde
==13476== 
==13476== Conditional jump or move depends on uninitialised value(s)
==13476==    at 0x8048A9A: hash_lookup (MEMORY_LEAK.c:132)
==13476==    by 0x80489BD: add_to_hash_array (MEMORY_LEAK.c:113)
==13476==    by 0x804871C: main (MEMORY_LEAK.c:50)
==13476== 
absurde: 70 size: 7
==13476== Conditional jump or move depends on uninitialised value(s)
==13476==    at 0x8048D1C: generate_anagrams (MEMORY_LEAK.c:169)
==13476==    by 0x8048795: main (MEMORY_LEAK.c:56)
==13476== 
==13476== Conditional jump or move depends on uninitialised value(s)
==13476==    at 0x8048890: hash_dealloc (MEMORY_LEAK.c:81)
==13476==    by 0x80487D8: main (MEMORY_LEAK.c:64)
==13476== 
==13476== Conditional jump or move depends on uninitialised value(s)
==13476==    at 0x4027BC2: free (vg_replace_malloc.c:366)
==13476==    by 0x804889C: hash_dealloc (MEMORY_LEAK.c:87)
==13476==    by 0x80487D8: main (MEMORY_LEAK.c:64)
==13476== 
==13476== 
==13476== HEAP SUMMARY:
==13476==     in use at exit: 0 bytes in 0 blocks
==13476==   total heap usage: 360 allocs, 360 frees, 133,424 bytes allocated
==13476== 
==13476== All heap blocks were freed -- no leaks are possible
==13476== 
==13476== For counts of detected and suppressed errors, rerun with: -v
==13476== Use --track-origins=yes to see where uninitialised values come from
==13476== ERROR SUMMARY: 65330 errors from 4 contexts (suppressed: 11 from 6) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T23:13:16.227

将我的评论移至答案，因为这几乎可行。

不需要在 malloc 之前初始化为 NULL，但是您以后释放的任何变量指针都应该设置为 NULL，并且只有在不是 NULL 时才释放。还将结构中的指针值初始化为 NULL（更容易使用 calloc 并自动获取它），以便您的警卫正常工作。我对您的代码进行了更多查看，您的散列让我担心 - 您需要确保您的散列函数仅返回 0 到 BUCKET_COUNT-1 范围内的值。我做了一些这样的快速更改，并修复了你的 replace_str 方法，它不再抱怨 valgrind。

现在，当我运行代码时，我看到它找到了要比较的正确单词，但排序函数没有返回排序后的字符串，因此它没有识别字谜。应该很容易解决。

编辑：我刚刚在第一个字符串排序例程中粘贴了一个为我找到的谷歌搜索并运行以获得以下输出：

```
./a.out trips
trips: 82 size: 5
strip

stirp

sprit

spirt 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-17T23:15:39.107

在`generate_anagrams`

```
void generate_anagrams(HashTable* a, char* word) {
    int index = hash(word);
    char* word_dup = strdup(word);
    char* current_word;
    string_sort(word_dup);
    printf("%s: %i size: %zi\n", word, index, strlen(word));
    Bucket* current = a->buckets[index];
    while(current != NULL) {
        if(current->data) {
            current_word = strdup(current->data);
            string_sort(current_word);
            if(strcmp(word_dup, current_word) == 0) {
                printf("%s\n", current->data);
            }
        }
        current = current->next;
    }
    free(current_word);
    free(word_dup);
} 
```

您正在泄漏`strdup`ed `current_word`。将`free(current_word);`移入`if (current->data)`.

在`add_to_hash_array`

```
void add_to_hash_array(HashTable** a, char* data) {
    int index = hash(data);
    HashTable* currentTable = a[strlen(data)];
    Bucket* existingNode = hash_lookup(currentTable, data);
    if(existingNode == NULL) {
        Bucket *newNode = (Bucket*) malloc(sizeof(Bucket));
        if(newNode == NULL) {
            exit(1);
        }
        replace_str(data, "\n", "\0");
        newNode->data = strdup(data);
        newNode->next = currentTable->buckets[index];
        currentTable->buckets[index] = newNode;
    } else {
        return;
    }
} 
```

您仅`data`在查找`data`后删除换行符，但在删除换行符后插入，因此您不会检测到重复项。

中`main`，你不应该

```
 generate_anagrams(hash_array[strlen(arg_dup) + 1], arg_dup); 
```

但`hash_array[strlen(arg_dup)]`如果您在 . 开头删除换行符，请使用`add_to_hash_array`。

当然，您应该确保不会`hash`生成超出范围的索引。

并且`strncpy(str, str, p-str);`是未定义的行为。

# ruby-on-rails - Rails rake db:schema:dump 针对具有多个模式的 SQL Server 数据库

> ID：14386664
> 
> 赞同：2
> 
> 时间：2013-01-17T19:32:41.540
> 
> 标签：ruby-on-rails, ruby, sql-server, rake

我的情况是我们在 SQL Server 上有多个架构，我们需要能够执行架构：转储和迁移。一种模式用于我们的新 Rails 应用程序，另一种模式用于我们依赖的遗留系统。

运行 rake db:schema:dump 时，我们的新模式表在 schema.rb 文件中正确创建。遗留模式表不会在 schema.rb 中结束。我想知道其他人是如何处理这个问题的。

我对此给出的另一个考虑是因为我们的旧模式表是相当静态的，因此将它们添加到一个单独的文件一次，然后为 rake db:schema:load 创建一个 before 挂钩，它将在 schema.rb 之前运行该文件. rake db:schema:load; 是否有一个 before 钩子？如果是这样，那是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T14:34:25.247

这是我最终解决此问题的方法。

我在 hooks.rake 中添加了一个 before 钩子到模式加载和模式转储中，如下所述。

```
namespace :project do
  namespace :db do
    task :before_schema_load => :environment do
      add_tables
    end

    task :before_schema_dump => :environment do
      add_ignored_tables
    end
  end
end

Rake::Task['db:schema:dump'].enhance(['project:db:before_schema_dump'])
Rake::Task['db:schema:load'].enhance(['project:db:before_schema_load']) 
```

在 add_tables 功能中，我手动创建了与我的旧表等效的静态 schema.rb，因为这些表不会经常更改（可能永远不会）。

在 add_ignored_tables 中，我已将表添加到 ActiveRecord::SchemaDumper.ignore_tables 数组中，以指示我不想转储到 schema.rb 的架构之外的表。就我而言，这是不在我当前应用程序架构下的所有内容。在我的情况下，我想要的应用程序架构之外的所有内容都在 add_tables 中指定，因此这些表也不应该在 schema.rb 中结束。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T19:41:41.193

有一些关于使用 Postgres 的多租户数据库的资料，我之前参考过的是[http://blog.jerodsanto.net/2011/07/building-multi-tenant-rails-apps-with-postgresql-schemas/](http://blog.jerodsanto.net/2011/07/building-multi-tenant-rails-apps-with-postgresql-schemas/) . 还有一个gem（https://github.com/influitive/apartment），它也可能是灵感，甚至是你的解决方案。

# jquery - 如何从 $.getJSON (coffeescript) 返回 json

> ID：14386669
> 
> 赞同：0
> 
> 时间：2013-01-17T19:32:55.813
> 
> 标签：jquery, coffeescript

> **可能重复：**
> [无法从 jQuery Ajax 调用中获取正确的返回值](https://stackoverflow.com/questions/3537434/cant-get-correct-return-value-from-an-jquery-ajax-call)
> [如何从函数的 AJAX 调用中返回响应？](https://stackoverflow.com/questions/14220321/how-to-return-the-response-from-an-ajax-call-from-a-function)

我有这个：

```
 get_json = (url) ->
    $.getJSON "#{url}.json", {}, (json, response) ->
      return json 
```

但这编译为：

```
getJson = function(url) {
  return $.getJSON("" + url + ".json", {}, function(json, response) {
    return json;
  });
}; 
```

..并返回响应对象。我怎样才能只返回 json？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-17T19:38:59.143

正在返回一个延迟对象，使用它来获取您的数据。使用您当前的`get_json`方法实现，此 JavaScript 应该可以工作：

```
get_json("http://example.com").done(function(obj){
    console.log(obj);
}); 
```

您的代码可以简化为：

```
get_json = (url) ->
    $.getJSON "#{url}.json" 
```

转换没有错，错的是您对 ajax 请求如何工作的假设。

您不能有一个具有 url 参数的函数，该参数发送一个 ajax 请求并从函数返回数据而不使 ajax 请求同步（由于各种原因，这是一个坏主意）。

# c# - 如何在while循环中使用语句continue？

> ID：14386679
> 
> 赞同：1
> 
> 时间：2013-01-17T19:33:35.160
> 
> 标签：c#, java, while-loop, continue

让我们看下面的代码片段：

```
int i = 0;
while ( i <= 10 )
{
    System.out.println(i);
    if ( i == 8 )
    {
        continue;
    }
    i++;
} 
```

我必须在代码中进行哪些更改以避免无限循环？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-17T19:35:26.903

在开头而不是结尾做增量：

```
int i = -1;
while ( i <= 10 )
{
    i++;
    System.out.println(i);
    if ( i == 8 )
    {
        continue;
    }

    // Presumably there would be some code here, or this doesn't really make much sense
} 
```

或者，根据语言，您可以在语句中正确执行（无论您选择还是`while`记住运算符的优先级）`i++``++i`

```
int i = 0
while ( i++ <= 10 )
{
    System.out.println(i);
    if ( i == 8 )
    {
        continue;
    }

    // Presumably there would be some code here, or this doesn't really make much sense
} 
```

不过，我会质疑`while`对这种结构使用循环。如果您想在循环中使用计数器，`for`循环通常更合适。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-17T19:38:49.037

而不是一个快速修复解决方案，让我们看看你的代码一分钟，然后逐行浏览它：

```
int i = 0;
while ( i <= 10 )
{
    System.out.println(i);
    if ( i == 8 )
    {
        continue;
    }
    i++;
} 
```

`i`起初是 0，它小于 10，因此它进入循环，打印 0 并递增到 1。然后`i`变为 2、3、4、.. 8

当它等于 8 时，它不是递增，而是弹回到循环的开头，再次打印 8.. 检查`i`（即 8）的值并再次继续，打印 8.. 它将继续这样做直到永恒。

因此，在测试之前增加数字，它将按预期工作。

将您的代码更改为这样的内容

```
int i = 0;
while ( i <= 10 )
{
    if ( i != 8 )
    {
        System.out.println(i);
    }
    i++;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-17T20:01:23.013

我喜欢 Eric Petroelje 的回答。我建议做这样的事情：

```
if (++i >= 8) continue; 
```

此外，如今的编译器已经足以警告您这是一个可能的无限循环。还有一些代码分析工具也可以为您检测到这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-17T20:05:59.537

虽然这**不是我**在大多数情况下推荐使用的代码，但它确实起到了作用：

```
int i = 0;
while ( i <= 10 )
{
  Console.WriteLine(i.ToString());
  if ( i == 8 )
  {
    // Do some work here, then bail on this iteration.
    goto Continue;
  }

Continue:  // Yes, C# does support labels, using sparingly!
  i++;
} 
```

# javascript - 一个简单的 ajax GET 请求的问题

> ID：14386681
> 
> 赞同：-1
> 
> 时间：2013-01-17T19:33:58.953
> 
> 标签：javascript, jquery, ajax

我是 Jquery 和 Javascript 的初学者，我对 HTTP 协议的了解也是初学者。

我正在尝试对本地计算机上运行的数据库执行简单的 GET 请求以检索 word 文档。

```
$.ajax('http:localhost:databaseURLgoeshere') 
```

我认为这很简单，但什么也没发生（浏览器不下载word文档文件）。我知道我错过了一些巨大而基本的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T19:36:46.363

编辑：评论提出了一个更好的观点，那就是这可能是一个无效的用例。

也许您打算使用 $.get() 而不是 $.ajax()。此外，您还需要为成功指明方向。ex $.get("url", function() { // 成功时执行此操作 });

[http://api.jquery.com/jQuery.get/](http://api.jquery.com/jQuery.get/)

Get 只是 $.ajax() 的简写

[http://api.jquery.com/category/ajax/?rdfrom=http%3A%2F%2Fdocs.jquery.com%2Fmw%2Findex.php%3Ftitle%3DAjax%26redirect%3Dno](http://api.jquery.com/category/ajax/?rdfrom=http%3A%2F%2Fdocs.jquery.com%2Fmw%2Findex.php%3Ftitle%3DAjax%26redirect%3Dno)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T19:45:25.497

> 我正在尝试对本地计算机上运行的数据库执行简单的 GET 请求以检索 word 文档。

仅当数据库支持对文件的 HTTP 协议访问，并且您具有文件的正确 URL 时，这才有效，您是否能够做到这一点。大多数数据库没有这种方式的简单文件访问，但有些可能。作为测试，看看您是否可以在浏览器的 URL 栏中输入“ [http://localhost/databaseURLgoeshere ”并成功下载文件。](http://localhost/databaseURLgoeshere)

如果这不起作用，那么他们可能还有一个更复杂的 Web 服务，因为您发送参数来查询该服务。如果不知道您要查询的数据库 Web 服务，我们将无法为您提供帮助。

> $.ajax('http:localhost:databaseURLgoeshere')

在 http: 之后应该有一个 //，您也将 http:localhost:databaseURLgoeshere 放在端口号所在的位置。相反，它可能更像是“ [http://localhost/databaseURLgoeshere](http://localhost/databaseURLgoeshere) ”或“ [http://localhost:1234/databaseURLgoeshere](http://localhost:1234/databaseURLgoeshere) ”，其中 1234 是服务器正在侦听的任何端口。

最后，您不能使用 .ajax 下载文件，请参阅此处了解解释和解决方法： [通过 jQuery.Ajax 下载文件](https://stackoverflow.com/questions/4545311/how-to-download-a-file-by-jquery-ajax)

ajax 调用的结果会将数据返回到回调结果中，不会立即下载。通常，ajax 调用的结果是一些 json、xml 或 html。例如，如果它是 HTML，那么您将重新设置 javascript 以将该结果插入页面中您想要的任何位置。我的意思是，ajax 调用只是检索文件/xml/html/data 等，它实际上并没有让它出现在用户面前。您必须编写额外的 javascript 才能将其放置在页面上。

# java - 选择后如何从JTree中获取选定的节点？

> ID：14386682
> 
> 赞同：4
> 
> 时间：2013-01-17T19:34:05.127
> 
> 标签：java, swing, jtree

> **可能重复：**
> [JTree：如何获取所选项目的文本？](https://stackoverflow.com/questions/4240074/jtree-how-to-get-the-text-of-selected-item)

1在 C# 中有[TreeView_afterSelect 事件](http://msdn.microsoft.com/en-us/library/system.windows.forms.treeview.afterselect(v=vs.71).aspx)，我问在 java 中是否有类似的东西？我用过：`hierarchyPropertyChange`但它运行了两次......

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-17T19:39:39.297

您可以使用`TreeSelectionListener`：

```
tree.addTreeSelectionListener(new TreeSelectionListener() {

@Override
public void valueChanged(TreeSelectionEvent e) {
   DefaultMutableTreeNode selectedNode = 
       (DefaultMutableTreeNode)tree.getLastSelectedPathComponent(); 
   ...          
  }
}); 
```

# regex - 用于验证 1024 - 25600 范围的正则表达式

> ID：14386683
> 
> 赞同：0
> 
> 时间：2013-01-17T19:34:05.843
> 
> 标签：regex

我遇到了所有简单的范围验证，如 1-99 或 3-1000，但我无法为上述要求（1024 - 25600）创建一个 reg，任何帮助将不胜感激....谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-17T19:37:58.603

正则表达式并不意味着评估数字范围。仅仅因为您需要检查位数，您就能够摆脱 1-99 这样的范围，但它们无法验证任意数字范围。

# r - 在 automap 中使用 autofitVariogram 绘制问题

> ID：14386690
> 
> 赞同：1
> 
> 时间：2013-01-17T19:34:47.323
> 
> 标签：r, spatial-interpolation, automap

我是 R 的新手。我正在使用**autofitVariogram**来处理 50 个站点的每日降雨数据。示例数据如下所示。一些站点的缺失值由“NaN”值表示。

我的问题是关于 variogramfit。变异函数仅覆盖 60,000m 的距离。为什么没有绘制超过 60Km 的 bin 中的点。我从空间相关图中看到，与经纬度信息的最大距离> 200Km。

**下面提供了纬度和经度**信息的摘要。摘要（lonlat） lon lat
Min。:74.78 分钟 :15.77
1st Qu.:75.14 1st Qu.:16.04
Median :75.56 Median :16.33
Mean :75.54 Mean :16.37
第三Qu.:75.94 第三Qu.:16.66
Max. :76.31 最大。:17.23

```
$ Sample data  given below:
dput(rain[140:145,])

structure(list(Col0 = c(0, 0, 1, 9, 6.5, 0), Col1 = c(1.5, 36, 
21, 44, 4, 0), Col2 = c(0, 0, 24.5, 21.5, 7.5, 1), Col3 = c(0, 
1, 45, 3, 0, 0), Col4 = c(2, 0, 5, 54.5, 13.5, 0), Col5 = c(0.5, 
2, 0, 3.5, 13.5, 0), Col6 = c(0.5, 0, 0, 59, 15.5, 0), Col7 = c(0, 
0, 2.5, 1, 0, 0), Col8 = c(0, 6, 24, 2, 5.5, 0), Col9 = c(0, 
3, 6, 1, 0, 7), Col10 = c(0.5, 1, 64, 20, 1, 0.5), Col11 = c(NaN, 
NaN, NaN, NaN, NaN, NaN), Col12 = c(0, 11, 75, 19, 15.5, 0), 
    Col13 = c(0, 4, 57.5, 50.5, 8.5, 0), Col14 = c(1.5, 0.5, 
    127, 33.5, 34.5, 0), Col15 = c(0, 7, 0.5, 13, 1, 0), Col16 = c(0, 
    0.5, 81.5, 15, 49, 0), Col17 = c(0, 0, 4.5, 17, 5.5, 1), 
    Col18 = c(0, 3, 2.5, 0.5, 0, 0), Col19 = c(NaN, NaN, NaN, 
    NaN, NaN, NaN), Col20 = c(0, 0, 0, 0, 7, 0), Col21 = c(0, 
    1, 0, 5, 3.5, 0), Col22 = c(0, 0, 11.5, 28, 3.5, 0), Col23 = c(0, 
    0, 48.5, 0, 24.5, 0), Col24 = c(0, 0, 0, 10, 0.5, 14), Col25 = c(NaN, 
    NaN, NaN, NaN, NaN, NaN), Col26 = c(0, 7.5, 16, 28.5, 20.5, 
    0), Col27 = c(1.5, 0.5, 38, 28.5, 50, 0), Col28 = c(NaN, 
    NaN, NaN, NaN, NaN, NaN), Col29 = c(NaN, NaN, NaN, NaN, NaN, 
    NaN), Col30 = c(2.5, 0, 0, 80.5, 28, 13.5), Col31 = c(1, 
    0, 17, 85.5, 3.5, 0), Col32 = c(0, 0.5, 8, 101, 20, 4), Col33 = c(NaN, 
    NaN, NaN, NaN, NaN, NaN), Col34 = c(4, 3, 17, 122, 2, 2), 
    Col35 = c(0, 15.5, 14.5, 20, 3.5, 0), Col36 = c(0, 6.5, 8.5, 
    21, 7, 0), Col37 = c(0, 0, 1.5, 14.5, 0, 1.5), Col38 = c(0, 
    28, 30, 4, 0, 73), Col39 = c(28.5, 0, 4.5, 9.5, 1, 0), Col40 = c(1.5, 
    11.5, 32.5, 55, 0, 1), Col41 = c(0, 14.5, 0, 19, 12.5, 47.5
    ), Col42 = c(0, 28, 29, 17, 0.5, 20.5), Col43 = c(NaN, NaN, 
    NaN, NaN, NaN, NaN), Col44 = c(0, 19, 3.5, 42, 0, 0), Col45 = c(0, 
    0, 85, 15.5, 1, 0), Col46 = c(0, 0.5, 8, 24, 0.5, 0), Col47 = c(0, 
    1.5, 7, 12, 8.5, 0), Col48 = c(0, 0, 0, 43.5, 0, 1.5), Col49 = c(0, 
    13.5, 1, 16, 1, 1)), .Names = c("Col0", "Col1", "Col2", "Col3", 
"Col4", "Col5", "Col6", "Col7", "Col8", "Col9", "Col10", "Col11", 
"Col12", "Col13", "Col14", "Col15", "Col16", "Col17", "Col18", 
"Col19", "Col20", "Col21", "Col22", "Col23", "Col24", "Col25", 
"Col26", "Col27", "Col28", "Col29", "Col30", "Col31", "Col32", 
"Col33", "Col34", "Col35", "Col36", "Col37", "Col38", "Col39", 
"Col40", "Col41", "Col42", "Col43", "Col44", "Col45", "Col46", 
"Col47", "Col48", "Col49"), row.names = 143:148, class = "data.frame")

# Import the required libraries
library(rgdal)
library(maptools)
library(gstat)
library(sp)
library(automap)
library(XLConnect) 

# Read the station data from xls file
stnrain = readWorksheetFromFile(path_fileName,"Sheet1", region = "D1:BA187", header = FALSE)
N = nrow(stnrain)
rain = stnrain[4:N,]
lat = as.numeric(t(stnrain[2,]))
lon = as.numeric(t(stnrain[3,]))
lonlat = cbind(lon,lat)

#Transform from GCS to UTM protection
sp = SpatialPoints(lonlat,proj4string = CRS("+proj=longlat")) 
sp_utm = spTransform(sp, CRS("+proj=utm +zone=43N +datum=WGS84"))

krige_value = list() #prepare a list for storing the autokrige output
krige_stderr    = list()

nRows = nrow(rain)
for (i in 1:nRows) 
    {   
      irain = rain[i,]
      miss_indx = (irain == "NaN")
      irain = irain[!miss_indx]
      irain = as.numeric(irain)
      isallZeros = (max(irain) == 0) # To take care of the cases of dry day(irain =0) 
      irain = as.data.frame(irain)
      M = nrow(irain)

      if ((M > 5) & (!isallZeros)) # To avoid cases of NaN across many stations
       { 
         print(i)
         foo_utm = sp_utm[!indx]# Removing the locations with NaN values
         data = data.frame(foo_utm,irain)
         names(data) = c("Easting","Northing","rain")
         coordinates(data) = c("Easting","Northing") 

         variogram = autofitVariogram(rain~1,data,model = "Sph",fix.values=c(0,NA,NA)) 
         p = plot(variogram, main="Semi-variogram (Spherical Model)",xlab="Distance(m)",ylab="Semi-Variance(mm2)", sub=paste("Range: ",variogram$var_model$range[2], "Day",i))
         print(p)
         png(p)
         dev.off()
        }
       else
        {
            krige_value[[i]] = list(rep(0, L))
            krige_stderr[[i]]   = list(rep(0, L))
         }
     }
  } 
```

Q2）如何将变异函数拟合 png 文件保存在一个循环中。我知道每次保存图形后都应该使用 dev.off()，但我无法保存图形。任何帮助，将不胜感激。

谢谢，

![在此处输入图像描述](../Images/8ec2ca6a4e189c6c28ec04e7583f5996.png) 任何建议，将不胜感激？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T19:45:37.947

关于您的第一个问题，样本变异函数是使用最大距离约为感兴趣区域对角线 1/3 的点构建的。这里的假设是距离较远的点是不相关的，因为它们不在样本变异函数或变异函数模型中，所以它们被绘制出来。这只是一个选择，可能不是正确的选择，但是当我编写它时`autofitVariogram`，它似乎对我的数据很有效。您显示的变异函数模型证实了这一点，范围小于 60 公里。

为了保存你的 png，我有两个建议。首先，在对中调用 plot 命令`png()` `dev.off`，所以不要：

```
 print(p)
 png()
 dev.off() 
```

但：

```
 png()
 print(p)
 dev.off() 
```

此外，我会为 png 文件创建有意义的名称。

要创建一组变异函数图，我会使用`ggplot2`. 这使用`geom_line`和`facet_wrap`。`ggplot2`无法直接处理 gstat/automap 变异函数模型，幸运的是您可以使用`variogramLine`gstat 中的函数创建距离半方差数据。例如，参见图 3.1，以及[我编写的本报告](http://www.numbertheory.nl/files/report_evap.pdf)附录 A 中的图表。我之前写的这个答案还包括一个使用`ggplot2`空间数据的例子，这次是绘制一个网格图。

# c# - 如何在 ASP.Net CreateUserWizard 中获取新注册用户的用户 ID？

> ID：14386691
> 
> 赞同：4
> 
> 时间：2013-01-17T19:34:48.233
> 
> 标签：c#, asp.net

如何在 ASP.Net CreateUserWizard 中获取新注册用户的用户 ID？

我有一个页面，允许新用户注册创建用户向导。创建用户后，我想使用新用户的用户 ID 和电子邮件在客户详细信息表中插入一行。

我尝试在 CreateUserWizard1_CreatedUser 中放入一些代码来获取用户 ID。但是，据我所知，用户是在此时创建的；但是，此时用户尚未登录。我收到一个错误提示...

“NullReferenceException”由用户代码处理。对象未设置为对象的实例。”

如果我在调试期间设置断点，我可以看到 customerId 的值为 null。

根据我在 MSDN 网站上阅读的内容，CreatedUser 事件...“在成员资格提供商创建新的网站用户帐户后发生。”

我想在创建用户向导更改为显示“继续”按钮之前将该行添加到客户详细信息表中。此时，用户可以转到其他页面或关闭应用程序。

CreatedUser 之后是否还有其他事件可以在其中放置一些代码？我看到有一个 Unload 事件。 [http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.createuserwizard_events%28v=vs.110%29.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.createuserwizard_events%28v=vs.110%29.aspx)

我可以在 CreatedUser 事件中以某种方式登录用户来获取用户 ID 吗？

* * *

这是我在注册页面上的代码不起作用。错误发生在代码行：“string customerId =”

```
 protected void CreateUserWizard1_CreatedUser(object sender, EventArgs e)
{
    // Add the Role of Customers to the new user.
    Roles.AddUserToRole((sender as CreateUserWizard).UserName, "Customers");

    // Get the current user's ID and email
    string customerId = Membership.GetUser(HttpContext.Current.User.Identity.Name).ProviderUserKey.ToString();
    string email = Membership.GetUser(HttpContext.Current.User.Identity.Name).Email.ToString();
    bool success = CustomerDetailsAccess.CreateCustomerDetails(customerId, email); 
```

...

```
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-17T19:39:21.850

当用户正在经历注册过程时，`HttpContext.Current.User.Identity`除非注册的用户已经登录，否则不会设置（匿名访问）。

要解决此问题，您需要从向导而不是上下文中获取用户名。

要解决此问题，请更改以下行：

```
string customerId = Membership.GetUser(HttpContext.Current.User.Identity.Name).ProviderUserKey.ToString(); 
```

对此：

```
string customerId = Membership.GetUser((sender as CreateUserWizard).UserName).ProviderUserKey.ToString(); 
```

# css - CSS 高级形状（背景切出的心形）

> ID：14386692
> 
> 赞同：7
> 
> 时间：2013-01-17T19:34:50.027
> 
> 标签：css, shapes, css-shapes

基本上我只想在 CSS 中创建一个与心形相反的形状（所以没有图像）。我不知道如何正确解释，所以这是一张图片：

![在此处输入图像描述](../Images/d0b2658710f11eaf4729f321c1b77506.png)

如您所见，蓝色是背景，但我要创建的形状不是心形，而是黑色矩形的形状。

如果我有以下形状（灰色而不是黑色）

![在此处输入图像描述](../Images/f0bbfa244ecee32ff4fb55f3cb0e2b06.png)

我可以复制它然后旋转它，这会给我我正在寻找的形状。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-12-02T15:54:13.810

# 使用 box-shadow 切割出心形

## 让我们创建这个——蓝色是`<body>`

![截屏](../Images/d5e977c1a57a299e8d7e3abe4292243d.png)

## 碎片

随意直接跳到这个答案底部的完整演示:)

### 1 - 圆角

圆形的左上角和右上角是在`box-shadow`两个伪元素上创建的`border-radius: 50%`-`.heart:before`和`.heart:after`- 它们形成两个新月形，如下所示：

![新月形](../Images/11319e8d91f6c57861627df1badfdbc4.png)

### 2 - 角度

有角度的形状是由`box-shadow`on创建的`.heart`。结合这两个圆圈，它看起来像这样：

![有角度的形状](../Images/8b121363d8bd3e397c043f294eb65416.png)

### 3 - 填充物

我们现在需要填补空白。这是由`.box-shape`容器的伪元素完成的 -`.shape-box:before`和`.shape-box:after`. `overflow: hidden`多余的部分被整齐地切断`.shape-box`。结合我们上面的部分，它们看起来像这样：

![填料](../Images/1983900f393fb69a4eacb337bc5089f1.png)

## 完整的例子

把它们结合在一起，我们就得到了这个漂亮的心形。它都包含在`.shape-box`.

```
body {
  background: #00A2F6;
}
.shape-box {
  height: 504px;
  width: 504px;
  position: relative;
  margin: 100px;
  overflow: hidden;
}
.shape-box:before,
.shape-box:after {
  content: '';
  display: block;
  height: 100px;
  width: 120px;
  background: #2B2B2B;
  transform: rotate(45deg);
  left: 190px;
  position: absolute;
  top: 40px;
}
.shape-box:after {
  width: 760px;
  height: 750px;
  box-shadow: inset 0 0 0 220px #2B2B2B;
  top: -150px;
  left: -130px;
  background: none;
}
.heart {
  transform: rotate(45deg);
  height: 357px;
  width: 356px;
  box-shadow: inset 0 0 0 50px #2B2B2B;
  position: absolute;
  left: 74px;
  top: 34px;
}
.heart:before,
.heart:after {
  content: '';
  display: block;
  width: 151px;
  height: 151px;
  border-radius: 50%;
  box-shadow: -40px -15px 0 20px #2B2B2B;
  position: absolute;
  left: 50px;
  top: 157px;
}
.heart:after {
  box-shadow: -15px -40px 0 21px #2B2B2B;
  left: 156px;
  top: 51px;
}
```

```
<div class="shape-box">
  <div class="heart"></div>
</div>
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-17T21:49:34.820

这可以通过 svg 渐变、多个背景和一些创意平铺/放置的组合来完成。来自我[工作的 jsfiddle](http://jsfiddle.net/BueHh/1/)的示例 CSS （没有供应商前缀，即`-webkit`和`-moz`）：

```
height: 400px;
width: 400px;
background-image:
  radial-gradient(75% 85.5%, circle, transparent 25%, black 26%),
  radial-gradient(25% 85.5%, circle, transparent 25%, black 26%),
  linear-gradient(225deg, transparent 25%, black 25%),
  linear-gradient(135deg, transparent 25%, black 25%);
background-size: 200px 200px;
background-position: top left, top right, bottom left, bottom right;
background-repeat: no-repeat; 
```

`400px`这会在方形元素的中间形成一个心形切口。可以对其进行修改以适合您想要的任何尺寸元素。

更新：[这是一个更复杂的小提琴](http://jsfiddle.net/684vK/1/)，它使用六个渐变而不是四个，但看起来更好一些。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-29T22:39:45.693

[基于 Mark Hubbart 所做的工作，我能够在这个小提琴](http://jsfiddle.net/vePjf/39/)中将其推向更高级的形式

这还不是 100% 完成，因为它需要一些媒体查询才能在更多浏览器上工作，但它确实显示了为同一目标而更灵活地工作的开始。

```
#backgrounder {
z-index: 2;
background-image: 
   radial-gradient(68% 100%, circle, transparent 48%, white 30%), 
   radial-gradient(32% 100%, circle, transparent 48%, white 30%), 
   radial-gradient(110% 1%, circle, transparent 65%, white 30%), 
   radial-gradient(-8.5% 1%, circle, transparent 65%, white 30%), 
   linear-gradient(220deg, transparent 41%, white 30%), 
   linear-gradient(139deg, transparent 41%, white 30%);

 background-image: 
    -webkit-radial-gradient(68% 100%, circle, transparent 48%, white 30%), 
    -webkit-radial-gradient(32% 100%, circle, transparent 48%, white 30%), 
    -webkit-radial-gradient(110% 1%, circle, transparent 65%, white 30%), 
    -webkit-radial-gradient(-8.5% 1%, circle, transparent 65%, white 30%), 
    linear-gradient(220deg, transparent 41%, white 30%), 
    linear-gradient(139deg, transparent 41%, white 30%);

 background-size: 51% 31%, 50% 31%, 51% 50%, 50% 50%, 51% 51%, 50% 51%;
 background-position: top left, top right, 0% 30%, 100% 30%, bottom left, bottom right;
 background-repeat: no-repeat;
 position: absolute;
 top: 0; right: 0; bottom: 0; left: 0;
} 
```

# c# - Linq 从不同的数据表返回总和值

> ID：14386694
> 
> 赞同：0
> 
> 时间：2013-01-17T19:34:53.550
> 
> 标签：c#, linq, datatable

我有以下代码：-

```
 var distinctValues = DtSet.Tables["tblData"].AsEnumerable()
                    .Select(row => new
                    {
                        name_1 = "1",
                        name_2 = "I",
                        name_3 = row.Field<string>("EorD"),
                        name_4 = row.Field<string>("InvNo")
                    })
                    .Distinct(); 
```

如果我有另一个包含 2 列“InvNo”和“Amount”的数据表 (DtSet.Tables["tblCost"])，如何在我的第一段代码中添加第五列以恢复每个列的金额总和tblCost 上的 InvNo？像 ：-

```
 var distinctValues = DtSet.Tables["tblData"].AsEnumerable()
                    .Select(row => new
                    {
                        name_1 = "1",
                        name_2 = "I",
                        name_3 = row.Field<string>("EorD"),
                        name_4 = row.Field<string>("InvNo")
                        name_5 = **Summed total of Amount column on tblCost per InvNo**
                    })
                    .Distinct(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T19:49:26.547

在 SQL 中执行一个查询，将两个表连接起来，并对金额求和

```
SELECT
    D.EorD,
    D.InvNo,
    SUM(C.Amount) As TotalAmount
FROM
    tblData D
    LEFT JOIN tblCost C
        ON D.InvNo = C.InvNo
GROUP BY
    D.EorD, D.InvNo; 
```

如果 tblCost 中没有相应的记录，我使用了左连接。

注意：我不确定该列`EorD`。我认为这`InvNo`是独一无二的`tblData`。否则，如果有相应的列，则应将其包含在联接中，`tblCost`或者将其从中删除`GROUP BY`并对其应用聚合函数，例如`MAX(D.EorD) AS EorD`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T20:37:21.097

您可以进行“组加入”并在一个查询中进行：

```
var distinctValues = 
    (from data in DtSet.Tables["tblData"].AsEnumerable()
     join cost in DtSet.Tables["tblCost"].AsEnumerable().Where(r=>!r.IsNull("Amount"))
        on data.Field<string>("InvNo") equals cost.Field<string>("InvNo") 
            into dc
    select new
    {
        name_1 = "1",
        name_2 = "I",
        name_3 = data.Field<string>("EorD"),
        name_4 = data.Field<string>("InvNo"),
        name_5 = dc.Sum(d=>d.Field<int>("Amount"))
    })
    .Distinct(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-17T20:05:15.750

您应该加入您的收藏，将其分组并汇总：

```
 var tblDataValues = DtSet.Tables["tblData"].AsEnumerable()
                                .Select(row => new
                                {
                                    name_1 = "1",
                                    name_2 = "I",
                                    name_3 = row.Field<string>("EorD"),
                                    name_4 = row.Field<string>("InvNo")
                                })
                                .Distinct();;
        var tblCostValues = DtSet.Tables["tblCost"].AsEnumerable()
                                .Select(row => new
                                {
                                    InvNo = row.Field<string>("InvNo"),
                                    Amount = row.Field<int>("Amount"),
                                }
            );

        var joinedValue = tblDataValues.Join(tblCostValues, v => v.name_4, c => c.InvNo, (v, c) => new { c, v })
                .GroupBy(k => k.v, c => c.c)
                .Select(g => new
                {
                    g.Key.name_1,
                    g.Key.name_2,
                    g.Key.name_3,
                    g.Key.name_4,
                    name_5 = g.Aggregate(0, (s, c) => s + c.Amount)
                }); 
```

# c# - 如何使用 C# 从 Adob e Illustrator (.ai) TextFrame 获取 FontSize？

> ID：14386700
> 
> 赞同：1
> 
> 时间：2013-01-17T19:35:19.557
> 
> 标签：c#, font-size, adobe-illustrator

我正在使用 C# 中的 Adob​​e Illustrator 库成功读取 Adob​​e Illustrator 文件，但我无法获取 TextFrame 的 FontSize。任何人都可以帮忙吗？下面是我使用的代码：

```
Illustrator.Application aiApp = new Illustrator.Application();
Illustrator.Document doc =  aiApp.Open(@"K:\test\test.ai",Illustrator.AiDocumentColorSpace.aiDocumentRGBColor, null);

        List<Label> _labela = new List<Label>();
        int cntr = 0; 
        foreach (TextFrame tf in doc.TextFrames)
        {
            _labela.Add(new Label());
           // caktojme vetite per secilen label
            _labela[cntr].Name = "lblTextFrame" + cntr;
            _labela[cntr].AutoSize = true;
            _labela[cntr].Text = tf.Contents; 
            _labela[cntr].ForeColor = Color.FromArgb((int)tf.Layer.Color.Red, (int)tf.Layer.Color.Green, (int)tf.Layer.Color.Blue);
            _labela[cntr].Top = Math.Abs((int)tf.Top);
            _labela[cntr].Left = Math.Abs((int)tf.Left);
            cntr++;
        }

        foreach (Label lbl in _labela)
        {
            //lbl.BackColor = Color.Black; 
            this.Controls.Add(lbl);
            this.SuspendLayout(); 
            this.Refresh(); 
        }

    } 
```

我没有看到 TextFrame.FontSize 的任何属性？？？：（ 。 有什么建议么！？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T23:07:48.203

您像这样阅读字体名称和大小

```
for (int i = 1; i <= doc.TextFrames.Count; i++)
{
    Illustrator.TextFrame tF = doc.TextFrames[i];
    Illustrator.TextFont objFont = tF.TextRange.CharacterAttributes.TextFont;
    double size = tF.TextRange.CharacterAttributes.Size;
    Console.WriteLine("Size: {0}, FontName: {1})", size, objFont.Name);
} 
```

# qgis - 指向派生类对象的指针

> ID：14386709
> 
> 赞同：0
> 
> 时间：2013-01-17T10:09:34.530
> 
> 标签：qgis, c++

以下问题：我想构建一个函数，它返回一个指向来自抽象类的派生对象的指针。我认为，当函数离开时，内存被释放，因为我得到一个分配错误。但是我不能把对象还给我，因为这个类是抽象的。在我决定的函数中，对象将具有哪个派生类。我该如何解决这个问题？任何的想法？

```
QgsSymbolV2* QGISFunc::ReadClassSymbolsXML(QString FeatureType, QXmlStreamReader &reader)
    {
        QgsMarkerSymbolV2* p_mlmSymbol=0;
        try
        {
            QgsLineSymbolV2 mllSymbol;
            QgsFillSymbolV2 mlfSymbol;
            QgsMarkerSymbolV2 mlmSymbol;
...
return &mlmSymbol; // alloc error 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T19:40:25.427

您正在返回具有自动存储功能的变量的地址。当函数返回时，该对象被销毁。解决方案是在堆上分配对象。我建议为此目的使用智能指针（`unique_ptr`或`shared_ptr`与 结合使用）并返回智能指针。`make_shared<>()`

```
std::shared_ptr<QgsSymbolV2> QGISFunc::ReadClassSymbolsXML(
    QString FeatureType, 
    QXmlStreamReader &reader
    )
{
    try
    {
        ...
        std::shared_ptr<QgsSymbolV2> spObj = make_shared<QgsMarkerSymbolV2>();
        ...
        return spObj;
    }
    ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T19:44:35.730

您的问题与抽象类无关。您在堆栈上创建一个对象，然后返回其地址。但是，该地址在函数返回后将不再有效。如果你真的想返回一个指针并将所有权委托给调用者，为什么不在堆上创建它`new`呢？稍后当您完成该对象时不要忘记`delete`它，或者像@AndyProwl 建议的那样考虑智能指针。

# asp.net - 控制使用 Asp Net Mvc Ajax.BeginForm 发布的表单

> ID：14386716
> 
> 赞同：0
> 
> 时间：2013-01-17T19:36:07.937
> 
> 标签：asp.net, .net, asp.net-mvc, asp.net-mvc-4

我正在使用 Ajax.BeginForm 发布表单，在发送表单之前触发的最后一个事件是 onBegin 事件。

onBegin 事件在表单被序列化后触发。我需要控制此表单，但我无法创建自己的提交事件

前任。：

```
$('#myForm').submit() 
```

**问题：**

有没有办法在发送序列化表单之前对其进行操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T19:58:54.453

您可以修改序列化表单的 jquery.unobtrusive-ajax.js 部分：

```
$("form[data-ajax=true]").live("submit", function (evt) {
    var clickInfo = $(this).data(data_click) || [];
    evt.preventDefault();
    if (!validate(this)) {
        return;
    }
    asyncRequest(this, {
        url: this.action,
        type: this.method || "GET",
        data: clickInfo.concat($(this).serializeArray())
    });
}); 
```

# jquery - jQuery克隆限制

> ID：14386724
> 
> 赞同：-2
> 
> 时间：2013-01-17T19:36:30.037
> 
> 标签：jquery, clone

我有这个代码：

```
$("#addbt").click(function () {
 $('#choice').clone()
     .attr('id', 'choice' + $('.ddl').length)
     .attr('name', 'choice' + $('.ddl').length)
     .insertAfter(".ddl:last"); }); 
```

我是 Jquery 的新手。如何将克隆数停止为特定数字？（比如说 10 个）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T19:45:39.820

在保持与您当前拥有的代码结构大致相同的同时，最简单的方法是使用如下计数器：

```
 counter = 0;
 $("#addbt").click(function () {
         counter++;
         if (counter <= 10){
            $('#choice').clone()
              .attr('id', 'choice' + $('.ddl').length)
              .attr('name', 'choice' + $('.ddl').length)
              .insertAfter(".ddl:last"); });
          }
  } 
```

# xml - 我如何将有限多映射到具有优先级的 1

> ID：14386726
> 
> 赞同：0
> 
> 时间：2013-01-17T19:36:38.013
> 
> 标签：xml, xslt-2.0, xpath-2.0

我的输入文档具有有限数量的可能值。这些值需要作为聚合读取，并且现有的最高优先级报告为单个值。例如：

如果我可能的输入标签是：（但并非所有标签都始终存在并且订单不被保证）

```
<SomeInput>A</SomeInput>
<SomeInput>B</SomeInput>
<SomeInput>C</SomeInput>
<SomeInput>D</SomeInput> 
```

我的优先级是 A，然后是 B，然后是 C，然后是 D。在这种情况下，我希望我的输出是：

```
<SomeOutput>A</SomeOutput> 
```

如果是：

```
<SomeInput>D</SomeInput>
<SomeInput>B</SomeInput> 
```

应该产生：

```
<SomeOutput>B</SomeOutput> 
```

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T23:46:04.527

**使用**：

```
/*/*[. eq min(/*/*/string())][1] 
```

**这是一个完整的转换**：

```
<xsl:stylesheet version="2.0"   xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output omit-xml-declaration="yes" indent="yes"/>
    <xsl:strip-space elements="*"/>

 <xsl:template match="/*/*[. eq min(/*/*/string())][1]" priority="2">
     <someOutput><xsl:apply-templates/></someOutput>
 </xsl:template>
 <xsl:template match="/*/*"/>
</xsl:stylesheet> 
```

**当此转换应用于以下 XML 文档**（提供的片段，包装到单个顶部元素中以使其成为格式良好的 XML 文档）时：

```
<t>
    <SomeInput>A</SomeInput>
    <SomeInput>B</SomeInput>
    <SomeInput>C</SomeInput>
    <SomeInput>D</SomeInput>
</t> 
```

**产生了想要的正确结果：**

```
<SomeOutput>A</SomeOutput> 
```

**在此 XML 文档上应用相同的转换时：**

```
<t>
    <SomeInput>D</SomeInput>
    <SomeInput>B</SomeInput>
</t> 
```

**再次产生所需的正确结果：**

```
<SomeOutput>B</SomeOutput> 
```

# asp.net-mvc-3 - 如何使 ASP.NET MVC 3 呈现 Html.CheckBoxFor 和具有反转值的相应隐藏元素？

> ID：14386727
> 
> 赞同：1
> 
> 时间：2013-01-17T19:36:39.303
> 
> 标签：asp.net-mvc-3, html-helper

我将 ASP.NET MVC3 与 Razor 一起使用。

我的模型中有一个布尔值，我想在视图中将其呈现为复选框。但是，我希望复选框指示布尔状态的反转。换句话说，选中复选框应该在提交表单时将绑定模型对象设置为 false，而不是 true。反之亦然。

我可以这样做来在渲染的复选框输入元素上设置 value 属性：

```
@Html.CheckBoxFor(model => model.MyBoolean, new { value = "false" }) 
```

但是自动创建的隐藏输入元素的值仍然为 false。因此，它们的值都为 false，这意味着绑定的模型对象始终设置为 false。

那么如何强制 HTML 助手将隐藏元素设置为 true 并将复选框元素设置为 false 呢？

我知道（a）我可以更改模型和数据库，（b）我可以在提交之前使用 javascript 更改值，以及（c）我可以在提交后交换控制器中收到的任何值。我可能会做其中之一，但我不是在寻求可能的解决方案；我在问是否可以让 HTML 助手按照我的意愿去做。我进行了广泛的搜索，但在官方或非官方来源的任何地方都没有看到这个问题。似乎他们应该有一个“交换”选项或其他东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T19:39:13.597

```
 class ViewModel {
        public bool MyBoolean {get;set;}
        public bool DisplayValue {
            get {
                return ! MyBoolean ;
            }

            set {
                MyBoolean = !value;
            }
        }
    } 
```

并绑定到，因为它的设置器无论如何`DisplayValue`都会更新您的属性。`MyBoolean`

**编辑：**

再次阅读您的问题*后*:.

您可以使用 HtmlHelper 来做到这一点 - 但不是使用 CheckBox，您可以使用下拉菜单。下拉列表将定义“相反”的值和文本。

```
 myModelInstance.PossibleValues = new[] { new SelectListItem { Value = "false", Text = "Not false" }, new SelectListItem { Value = "true", Text = "Not true" } }; 
```

请注意描述与您希望模型的含义相反。所以例如。如果为 true，您可能会将文本设置为“隐藏”，而 false 您可能会将文本设置为“可见”，为“已禁用”为“真”，“已启用”为“假”等。

然后在您的视图中：

```
 @Html.DropDownList(Model.MyBoolean.ToString(), Model.PossibleValues) 
```

模型将使用正确的值更新，而无需在查看或更新之前进行布尔切换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T19:01:05.523

对于未来的读者，我个人认为，HtmlHelpers 旨在呈现 Html（顾名思义）。我更喜欢创建不同的方式来呈现项目是创建 EditFor 和 DisplayFor 模板。为了确保这是高度可重用的，我还创建了专门为这些模板设计的模型。使用您的设计，我的模型和模板可能如下所示：

**/Models/Controller/ControllerActionViewModel.cs**

```
public class ControllerActionViewModel
{
  public ControllerActionViewModel()
  {
    this.CheckboxBoolTemplate = new CheckboxBoolTemplate(false, true);
  }

  [Display(Name = "My Boolean")]
  public SelectBoolTemplate MyBoolean { get; set; }
} 
```

**/TemplateModels/ControllerActionViewModel.cs**

```
public sealed class SelectBoolTemplate
{
  private bool _valuesSwapped = false;
  private bool? _value;
  private bool _defaultValue = false;

  public SelectBoolTemplate()
  {
  }

  public SelectBoolTemplate(bool valuesSwapped)
  {
    this._valuesSwapped = valuesSwapped)
  }

  public SelectBoolTemplate(bool defaultValue, bool valuesSwapped)
  {
    this._defaultValue = defaultValue;
    this._valuesSwapped = valuesSwapped)
  }

  public bool Value
  {
    get
    {
      if (this._value.HasValue)
      {
        return this._value.Value
      }
      return this._defaultValue;
    }
    set
    {
      this._value = value;
    }
  }
} 
```

**/Views/Shared/EditorTemplates/SelectBoolTemplate.cshtml**

```
@model SelectBoolTemplate

@{
string propertyName = ViewContext.ViewData.ModelMetadata.PropertyName;
string fullPropertyName = ViewContext.ViewData.TemplateInfo.HtmlFieldPrefix;
string labelText = ViewContext.ViewData.ModelMetadata.DisplayName 
                   ?? ViewContext.ViewData.ModelMetadata.PropertyName;
}

@Html.LabelForModel()
@Html.Checkbox(fullPropertyName, Model.Value) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-14T09:28:41.957

我知道这对于原始查询来说为时已晚，但是对于将来阅读的任何人来说，有另一种方法可以处理复选框，其中选中/未选中的反向 false/true 不需要更改模型 - 创建一个 false 复选框和一个隐藏字段真的

```
<input id="@Html.IdFor(model => model.BoolProperty)" name="@Html.NameFor(model => model.BoolProperty)" type="checkbox" value="false" @(Model.BoolProperty? "" : "checked=\"checked\"" ) />
<input name="@Html.NameFor(model => model.BoolProperty)" type="hidden" value="true" /> 
```

# javascript - srcElement 在 IE9 中不起作用

> ID：14386732
> 
> 赞同：1
> 
> 时间：2013-01-17T19:36:54.843
> 
> 标签：javascript, events

我一直在为跨浏览器事件处理组合一个轻量级事件实用程序，但遇到了一个我无法完全跳过的相当高的障碍。这与 IE9 中的 srcElement 属性有关，这对我不起作用！

目前，我的实用程序看起来像这样（srcElement 是第三个代码块）：

```
var bonsallNS = new Object();

bonsallNS.events = {
addEvent: function (node, type, func) {
    if (typeof attachEvent != "undefined") {
        node.attachEvent("on" + type, func);
    } else {

        node.addEventListener(type, func, false);
    }
},
removeEvent: function (node, type, func) {
    if (typeof detachEvent != "undefined") {
        node.detachEvent("on" + type, func);
    } else {

        node.removeEventListener(type, func, false);
    }
},
target: function (e) {
    if (typeof srcElement != "undefined") {
        return window.event.srcElement;
    } else {
        return e.target;
    }
},
preventD: function (e) {
    if (typeof srcElement != "undefined") {
        window.event.returnValue = false;
    } else {
        e.preventDefault();
    }
}
} 
```

现在，在 Chrome 和 Firefox 中使用下面的测试脚本可以正常工作，但是当我尝试提醒它时，在 IE 中返回未定义的 evtTarget。我不知道为什么，所以任何帮助将不胜感激！见下面的代码：

```
var gClick = document.getElementById("clickme");
var gCount = 0;

function mssg(e){

var evtTarget = bonsallNS.events.target(e);
alert("it worked, target: " + evtTarget);
gCount++
if (gCount > 2){
    bonsallNS.events.removeEvent(gClick, "click", mssg);
}
}

function setUp(){
bonsallNS.events.addEvent(gClick, "click", mssg);
}

bonsallNS.events.addEvent(window, "load", setUp); 
```

就像我说的，除了 IE 中的事件源之外，其他一切都有效！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T20:39:30.157

除非在更高的范围内定义，否则该变量`srcElement`将始终存在。`undefined`但它永远不会提及`event.srcElement`.

您可以通过两种方式解决此问题：检查是否已定义，`e`或`e.srcElement`是否已定义。`window.event``window.event.srcElement`

```
if (typeof e === "undefined" || typeof e.srcElement === "undefined") {
// or
if (typeof window.event !== "undefined" && 
    typeof window.event.srcElement !== "undefined") { 
```

您还可以将整个函数缩短为：

```
target: function (e) {
    e = e || window.event;
    return e.target || e.srcElement;
} 
```

# excel - 跨列复制公式

> ID：14386733
> 
> 赞同：1
> 
> 时间：2013-01-17T19:36:56.883
> 
> 标签：excel, copy

我有一个包含 4 列的电子表格：A、B、C、D。

我想计算 AB 和 CD 之间的差异。所以在单元格 E2 中，我输入公式 =A2-B2 ，得到我想要的结果，这就是 AB 之间的差异。

现在我将 E2 中的公式拖到单元格 F2 中，期望 Excel 会“认为”现在我想要 CD 之间的差异。但是，当我将公式从 E 列拖到 FI 列时，得到 =B2-C2（你看，Excel 假设我想再次使用 B2）。

我的问题是：如何让 Excel“理解”我想在 =A2-B2 之后使用 =C2-D2 而不是 =B2-C2？

这是一个简短的例子。原始数据集有数百列。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T20:39:38.940

1.  在 E2 中输入公式
2.  将公式向上拖动到 G2。现在 G2 将拥有您想要的公式。
3.  删除 Col F。现在 Col G 将移动到 Col F，其中将包含您所需的公式

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T23:01:42.913

在 UI 中，您无法让 Excel “思考”那么多 - 如果您将其拖过，它只会将引用移动一列。如果不能删除中间的列，则需要重写公式，例如：

```
=OFFSET(A1,0,COLUMN(L1)-COLUMN($L1))-OFFSET(B1,0,COLUMN(L1)-COLUMN($L1))

```

在此示例中，假设您开始显示 L 列中的差异 - 当然您需要根据工作表进行调整 - 但是一旦完成，您可以将公式向右拖动到您需要的位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-20T03:06:38.720

由于您的原始数据集有数百列，您可能希望使用非易失性公式，例如：

`=INDEX(A1:K1,1+COLUMN(L1)-COLUMN($L1))-INDEX(A1:K1,2+COLUMN(L1)-COLUMN($L1))`

这将加快工作簿中的计算速度。根据数据集的大小以及工作簿中有多少其他公式，速度上的差异可能很大。

与彼得的例子相同的条件适用。

# php - insert into db - 像这样插入撇号'

> ID：14386734
> 
> 赞同：0
> 
> 时间：2013-01-17T19:36:58.277
> 
> 标签：php, character-encoding, escaping

我正在尝试用 php 抓取一些数据。将数据插入 mysql 表（xampp）时，appostrohe 看起来像这样 - '

我如何摆脱这个角色。

我使用了 addlashes 和 mysql_real_escape_string 并且我无法摆脱它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T19:39:54.330

> 我正在尝试用 php 抓取一些数据。将数据插入表格时，appostrohe 看起来像这样 - '

`&#x27;` **是**撇号的正确 HTML。如果您从某人的网站上抓取，您将获得他们的 HTML，在这种情况下显然已正确转义。

`htmlspecialchars_decode()`如果要将 HTML 实体转换为纯文本，可以运行文本。

# sql - SQL 注入攻击后更新所有 SQL Server 列

> ID：14386736
> 
> 赞同：2
> 
> 时间：2013-01-17T19:37:00.617
> 
> 标签：sql, sql-server, sql-injection

我被告知我们的一个公司网站出现了问题，很快我就可以看到它受到了 SQL 注入攻击。我不管理网站，也无法访问文件（并且知道将来如何防止这种情况发生），但我当前的任务是清理数据库。`varchar`Microsoft SQL Server 数据库中的几乎所有列似乎都附加了 HTML 。

有什么方法可以运行一个简单的查询或函数来检查所有列是否有问题的 HTML 并更新所有表中的列？

例如一列是：

```
---------------------------
|Title
---------------------------
|product1 
```

就是现在

```
---------------------------
|Title
---------------------------
|product1</title><style>.atpd{position:absolute;clip:rect(400px,auto,auto,400px);}</style><div class=atpd>Apply here <a href=http://abbypaydayloansonline.com >online payday loans</a></div> 
```

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T19:45:39.520

这是一种选择，假设有问题的文本总是以开头`</title>`并且`</title>`不会自然地出现在数据中。

```
UPDATE dbo.table_name
  SET Title = LEFT(Title, CHARINDEX('</title>', Title)-1)
  WHERE Title LIKE '%</title>%'
  AND Title LIKE '%abbypaydayloansonline.com%'; 
```

如果您需要对跨多​​个表的多个列执行此操作（再次假设它`</title>`首先出现并且`</title>`在事件发生之前永远不会自然出现在数据中），则不需要显式游标：

```
DECLARE @sql NVARCHAR(MAX);

SET @sql = N'';

SELECT @sql = @sql + N'UPDATE ' + QUOTENAME(OBJECT_SCHEMA_NAME([object_id]))
  + '.' + QUOTENAME(OBJECT_NAME([object_id]))
  + ' SET ' + QUOTENAME(name) + ' = LEFT(' + QUOTENAME(name) 
  + ', CHARINDEX(''</title>'', ' + QUOTENAME(name) + ')-1)
  WHERE ' + QUOTENAME(name) + ' LIKE ''%</title>%''
  AND ' + QUOTENAME(name) + ' LIKE ''%abbypaydayloansonline.com%'''
  + ';' + CHAR(13) + CHAR(10)
FROM sys.columns
WHERE OBJECTPROPERTY([object_id], 'IsMsShipped') = 0
AND system_type_id IN (35,99,167,175,231,239,231);

SELECT @sql;
-- EXEC sp_executesql @sql; 
```

在运行之前绝对检查输出。请注意，Management Studio 只会向您显示将要执行的实际命令的一小部分，因此您可能还希望运行此查询以查看将要检查的所有表和列：

```
SELECT [table] = QUOTENAME(OBJECT_SCHEMA_NAME([object_id]))
         + '.' + QUOTENAME(OBJECT_NAME([object_id])),
      [column] = name
FROM sys.columns
WHERE OBJECTPROPERTY([object_id], 'IsMsShipped') = 0
AND system_type_id IN (35,99,167,175,231,239,231)
ORDER BY [table], [column]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T19:49:19.433

假设您不想手动输入所有查询，我建议您创建一个`CURSOR`（尽管我讨厌游标）并遍历系统表，如下所示：

```
SELECT t.name AS table_name,
SCHEMA_NAME(schema_id) AS schema_name,
   c.name AS column_name
FROM sys.tables AS t
INNER JOIN sys.columns c ON t.OBJECT_ID = c.OBJECT_ID 
```

然后您可以运行动态 SQL 来执行 @AaronBertrand 建议的操作。

声明你的游标并将你的变量提取到@table_name 和@column_name 中。然后运行类似（未经测试）的东西：

```
DECLARE @updateSQL NVARCHAR(MAX)
SET @updateSQL = 'UPDATE ' + @table_name + ' SET ' + @column_name + ' = LEFT(' + @column_name + ', CHARINDEX(''</title>'', ' + @column_name + ')-1)'
EXECUTE (@updateSQL) 
```

祝你好运。

# java - 在 xhtml 页面中打印 Facelets 参数

> ID：14386738
> 
> 赞同：1
> 
> 时间：2013-01-17T19:37:09.660
> 
> 标签：java, jsf-2, facelets

无论如何要在 xhtml 页面中打印 facelets 参数的值，例如“facelets.DEVELOPMENT”（在 web.xml 中配置）？

PS.：我想打印这些值，即使它们不在 web.xml 中。在这些情况下，它将打印设置的默认值。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T19:47:31.173

您**不能**直接在 EL 中引用所有特定于 Facelets 的参数，即使不是默认值，但您可以在 EL 中引用所有上下文参数。它们可通过基本上引用的[隐式 EL 对象](http://balusc.blogspot.com/2011/09/communication-in-jsf-20.html#ImplicitELObjects) 获得。`#{initParam}`[`ExternalContext#getInitParameterMap()`](http://docs.oracle.com/javaee/6/api/javax/faces/context/ExternalContext.html#getInitParameterMap%28%29)

因此，如果您事先知道参数名称，则应该这样做：

```
<p>
    Value of facelets.DEVELOPMENT context param: 
    #{initParam['facelets.DEVELOPMENT']}
</p> 
```

或者，如果您只想显示所有上下文参数：

```
<dl>
    <c:forEach items="#{initParam}" var="p">
        <dt>#{p.key}</dt>
        <dd>#{p.value}</dd>
    </c:forEach>
</dl> 
```

请注意，[`<c:forEach>`](http://docs.oracle.com/javaee/6/javaserverfaces/2.1/docs/vdldocs/facelets/c/forEach.html)使用它是因为[`<ui:repeat>`](http://docs.oracle.com/javaee/6/javaserverfaces/2.1/docs/vdldocs/facelets/ui/repeat.html)不支持地图。但是，如果您确实需要视图渲染时间组件而不是视图构建时间标记，那么您也可以使用`<ui:repeat>`，前提是您的环境支持 EL 2.2：

```
<dl>
    <ui:repeat value="#{initParam.entrySet().toArray()}" var="p">
        <dt>#{p.key}</dt>
        <dd>#{p.value}</dd>
    </ui:repeat>
</dl> 
```

无论哪种方式，为了专门过滤 Facelets 参数，请检查是否`#{p.key}`不以`"facelets."`using[`#{fn:startsWith()}`](http://docs.oracle.com/javaee/6/javaserverfaces/2.1/docs/vdldocs/facelets/fn/startsWith.fn.html)等开头。

```
<ui:fragment rendered="#{fn:startsWith(p.key, 'facelets.')}">
    <dt>#{p.key}</dt>
    <dd>#{p.value}</dd>
</ui:fragment> 
```

* * *

**根据评论进行更新**，您似乎对 JSF 项目阶段更感兴趣（`javax.faces.PROJECT_STAGE`顺便说一下，在 JSF2 中通常由上下文参数设置，`facelets.DEVELOPMENT`特定于旧的 Facelets 1.x）。这仅可通过[`Application#getProjectStage()`](http://docs.oracle.com/javaee/6/api/javax/faces/application/Application.html#getProjectStage%28%29)以下方式获得：

```
#{facesContext.application.projectStage} 
```

要专门检查 JSF 是否处于开发阶段，只需执行

```
<ui:fragment rendered="#{facesContext.application.projectStage == 'Development'}">
    <div class="warning">JSF is running in development stage!</div>
</ui:fragment> 
```

同样，有关所有隐式 EL 对象的概述，请查看第 1 段中的链接。

# android - 自定义列表适配器中的空指针异常

> ID：14386739
> 
> 赞同：0
> 
> 时间：2013-01-17T19:37:09.727
> 
> 标签：android, android-listview, android-arrayadapter

尝试使用自定义阵列适配器显示联系人列表。但是，每次我运行我的应用程序时，都会出现以下错误：

**com.example.contactsapp.ContactsListAdapter.getView 处的 java.lang.NullPointerException（ContactsListAdapter.java:37）**

这是我的自定义列表适配器类：

```
public class ContactsListAdapter extends ArrayAdapter<Contact> {

List <Contact> people;
//Contact c;
TextView name;
TextView email;

public ContactsListAdapter(Context context, List<Contact> people) {
    super(context, R.layout.list_row, people);
    this.people = people;

}

@Override
public View getView(int position, View convertView, ViewGroup parent) {

    View v = convertView;

    if(v == null){
        LayoutInflater inflater = (LayoutInflater)getContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        inflater.inflate(R.layout.list_row, null);
    }

    Contact c = this.people.get(position);

    name = (TextView)v.findViewById(R.id.namebox);
    name.setText(c.getName());

    email = (TextView)v.findViewById(R.id.emailbox);
    email.setText(c.getEmail());

    return v;
} 
```

}

这是我的 ListView 活动：

```
public class ViewContacts extends ListActivity{

List <Contact> people;
ContactsListAdapter adapter;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    this.setContentView(R.layout.activity_view);
    createTestData();

    adapter = new ContactsListAdapter(this, people);
    this.setListAdapter(adapter);
}

 public void createTestData(){
        people = new ArrayList<Contact>();
        people.add(new Contact("Jack", "jc@hotmail.com"));
        people.add(new Contact("Jack", "jc@hotmail.com"));
        people.add(new Contact("Jack", "jc@hotmail.com"));
        people.add(new Contact("Jack", "jc@hotmail.com"));
        people.add(new Contact("Jack", "jc@hotmail.com"));
 }

@Override
protected void onListItemClick(ListView l, View v, int position, long id) {
    Contact c = (Contact)people.get(position);
    Toast.makeText(v.getContext(), c.getName().toString() + " Clicked!", Toast.LENGTH_SHORT).show();
} 
```

}

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T19:40:11.173

（我的基本假设没有看到你的 logcat 错误）

因为你忘记了

```
v = inflater.inflate(R.layout.list_row, null); 
```

就像是，

```
View v = convertView;

    if(v == null){
        LayoutInflater inflater = (LayoutInflater)getContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        v = inflater.inflate(R.layout.list_row, null);
    } 
```

您正在膨胀视图但未将其分配给`View v`. 这就是为什么你要`NullPointerException`使用`name`TextViews `email`。

# jquery - 像旧表一样制作网格/流体布局，但使用 divs/css/jquery

> ID：14386742
> 
> 赞同：0
> 
> 时间：2013-01-17T19:37:27.210
> 
> 标签：jquery, html, css

我的一位客户（拥有自己的图形代理 -> 意味着我必须做他们想做的事）给出了一个布局来实现查看示例图像：

可以在此处找到示例图像：[https ://dl.dropbox.com/u/1857982/grid.gif](https://dl.dropbox.com/u/1857982/grid.gif)

我让它与一张老式桌子一起工作，虽然我非常讨厌自己，以至于我试图找到另一种方式......特别是因为我想添加一些流体响应行为......

我想避免设置 display:table-cell 等，因为缺乏支持：是的，他们不介意使用 IE7.5，我不能说“嘿更新你的 cr*** 浏览器”

浮动 div 不起作用，因为它们不允许我做那种类型的网格......

所以我要问你：有什么好的 jquery 可以帮助我吗？

我看到了其中一些，但我不确定（我正在测试）我是否可以像我附加的图像一样完美地粘在我的容器中......

目前正在测试： http: [//www.inwebson.com/jquery/blocksit-js-dynamic-grid-layout-jquery-plugin/](http://www.inwebson.com/jquery/blocksit-js-dynamic-grid-layout-jquery-plugin/) http://www.wookmark.com/jquery-plugin

如果有人有建议或个人经验，我真的很感激反馈，谢谢你们！

卢克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T20:36:29.463

不同的方法，基本上只是使用带有百分比的 div 和 css。html 比我想要的有点丑，但它比表格好，而且我们知道在这种情况下有些东西会很丑

[http://jsfiddle.net/sw29M/1/](http://jsfiddle.net/sw29M/1/)

```
<div class="wrapper">
<div class="row">
  <div class="column">
    <div class="one item">a</div>
    <div class="two item">b</div>
  </div>
  <div class="column item three">c</div>
  <div class="column">
    <div class="two item">d</div>
    <div class="one item">e</div>
  </div>
</div>
<div class="row">
  <div class="column item double four">a</div>
  <div class="column">
    <div class="two item">b</div>
    <div class="one item">c</div>
  </div>
</div>
<div class="row">
  <div class="column">
    <div class="one item">a</div>
    <div class="five item">b</div>
  </div>
  <div class="column item three">c</div>
  <div class="column">
    <div class="two item">d</div>
    <div class="one item">e</div>
  </div>
</div>
<div class="row">
  <div class="column">
    <div class="two item">a</div>
    <div class="one item">b</div>
  </div>
  <div class="column">
    <div class="one item">a</div>
    <div class="two item">b</div>
  </div>
  <div class="column three item"></div>
</div>
</div>

.one{
 background: #fff;
}
.two{
 background: #222;
}
.three{
 background: #999;
}
.four{
 background: #ccc;
}
.five{
 background: #ddd;
}
.wrapper{
 height: 100px; /*this will define the height of the box*/
}
.row{
 height: 100%;
 width: 100%;
}
.row:after{ /* clearfix */
  content: "";
  display: table;
  clear: both;
}
.row .column{
 width: 33%;
 float: left;
 height: 100%;
}
.row .column.double{
 width: 66%;
}
.row .column .item{
 height: 50%;
 width: 100%;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T19:52:21.087

我想你想要使用的是[Masonry](http://masonry.desandro.com/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-17T19:48:20.347

老实说，我认为您不会通过使用 jQuery/css 来解决这个特定问题。如果你真的不想使用表格，你可能可以让它与很多浮动 div 一起工作（这是可能的，但不是那么方便）。

IMO 并考虑到他们将使用旧浏览器这一事实，table 可能是正确的使用方式

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-17T19:54:28.640

你总是可以使用绝对定位，但那将是一个非常死板的设计。可能是这样的？

```
.one, .two, .three, .four{
 position: absolute;
 top: 0;
 left: 0;
}

.one, .two{
 width: 200px;
 height: 100px;
}
.two{
 background: #222;
}
.three{
 width: 200px;
 height: 200px;
 background: #666;
}
.four{
 width: 400px;
 height: 200px;
 background: #ccc;
}
.two.location{
 top: 100px;
}
.three.items{
 left: 200px;
}
.one.more{
 top: 100px;
 left: 300px;
}

<div class="one main"></div>
<div class="two location"></div>
<div class="three items"></div>
<div class="one more"></div> 
```

# grep - egrep：不匹配（或\（

> ID：14386743
> 
> 赞同：4
> 
> 时间：2013-01-17T19:37:34.563
> 
> 标签：grep

我正在尝试运行此命令来进行一些清理。

```
egrep -v -f ref_file.css my_file.css 
```

但是，它给了我一个错误。

egrep：不匹配（或\（

我怎么能绕过呢？我在mac终端上。

谢谢，
三通

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-03T03:05:20.747

我知道我有点晚了，但也许这可以帮助其他寻找相同的用户......

如果您只想检查两个文件之间的差异，那么您可以使用`diff`，如评论中所述。但是，如果文件有些相似，并且您正在寻找一种*视觉*检查差异的方法，那么您可以使用`sdiff file1 file2`-ish`diff`输出但并排显示文件。

在输出中，`|`两个文件之间的意思是这行在两个文件之间有些共享，但在文本或格式上有所不同。

`<`并且`>`意味着左边或右边的行存在于左边或右边的文件中，而不是在另一个文件中，如您所料。

`sdiff`然后，您可以对 for `' | '`、`' < '`和的输出进行 grep 分析`' > '`，以防您需要对文件进行进一步处理...

# git - 如何从我的提交中删除一些文件

> ID：14386744
> 
> 赞同：2
> 
> 时间：2013-01-17T19:37:39.633
> 
> 标签：git, github, gerrit

我已经上传了一个 gerrit，现在我想从我的提交中删除一些文件，我该怎么做？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2017-05-29T09:43:20.340

假设您已将三个文件 a.java、b.java、c.java 提交给 gerrit，并且您想从提交中删除 b.java。请按照以下步骤操作。

1.  如果您在不同的分支中，请选择特定的提交。
2.  使用以下命令从提交中删除文件。（对要删除的文件执行此操作。）

    ```
    git reset HEAD^ path/to/file/b.java 
    ```

3.  使用以下命令修改提交。

    ```
    git  commit --amend 
    ```

参考： [https ://superuser.com/questions/229290/how-to-amend-the-last-commit-to-un-add-a-file/229296#229296?newreg=011d1b3234a8444295fbdd12b6d513b4](https://superuser.com/questions/229290/how-to-amend-the-last-commit-to-un-add-a-file/229296#229296?newreg=011d1b3234a8444295fbdd12b6d513b4)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-18T07:25:36.477

所以你需要生成一个新的补丁集来替换旧的补丁集。假设自您尝试编辑的提交以来您没有提交任何其他内容，请执行

```
git rm <files>
git commit --amend 
```

你已经安装了 gerrit 提交钩子，不是吗？如果你有，你很好，准备好推动。你没有它，你需要将 Change-id 行从 gerrit web 界面复制到提交消息的末尾，否则 gerrit 将无法用新的补丁集替换以前的补丁集。

当您提交文件时（并且您在那里有与补丁集 1 中相同的 Change-id 行），将修复推送到 gerrit

```
git push origin HEAD:refs/for/master 
```

或您要推送到的任何存储库和分支。

将来，您应该在从 gerrit 克隆存储库后立即安装提交挂钩。如果你用例如克隆

```
git clone ssh://firstname.lastname@gerrit/project 
```

你可以得到提交钩子

```
cd project
scp firstname.lastname@gerrit:hooks/commit-msg .git/hooks 
```

替换适用于您的案例的路径和机器名称。

# python - 基于类 __init__ args 的 Python 方法默认值

> ID：14386747
> 
> 赞同：0
> 
> 时间：2013-01-17T19:37:46.933
> 
> 标签：python

我希望将类中的方法默认值设置为通过`__init__`方法传入的内容。像这样的东西：

```
class Foo(object):

    def __init__(self, loc=None):
        self.loc = loc

    def test(self, loc=self.loc):
        print loc

test = Foo()
test.test()
>>> None

test = Foo('foobar')
test.test()
>>> foobar 
```

这是可能的还是实现这一目标的另一种方式？

编辑：我知道这个当前的代码是不可能的，但我正在寻找这样的功能。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-17T19:49:24.813

*默认参数值在定义*范围内的函数定义点进行评估，但`self`它是仅在函数调用期间可用的参数。

看一个例子：

```
i = 5
def f(arg = i): print arg
i = 6
f() 
```

将打印 5\. python-tutor 上的[可视化。](http://goo.gl/obHGV)

在代码中默认参数`None`并为其添加测试是一种常见模式：

```
def test(self, loc = None):
    if loc is None:
       loc = self.loc
    print loc 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-17T19:39:45.407

做这样的事情：

```
def test(self, loc = None):
    if loc is None:
       loc = self.loc 
```

# android - 带有大位图的 Viewpager

> ID：14386750
> 
> 赞同：0
> 
> 时间：2013-01-17T19:38:09.503
> 
> 标签：android, android-viewpager, android-imageview

嗨，我正在尝试构建类似水平画廊的东西，我可以在其中使用画廊/相机中的图像添加或删除页面。

我正在尝试使其与大型位图一起使用，因此我使用一种算法来缩放位图并将其设置为每个页面的图像视图。该算法需要 ImageView 的宽度/高度（按比例缩小）。

我遇到的问题是，当我的自定义 PagerAdapter 方法被执行时，ImageView 的宽度/高度是未知的（getWidth/getHeight 返回 0），所以它不起作用：

```
public Object instantiateItem(ViewGroup collection, int position) {
        LayoutInflater inflater = (LayoutInflater) collection.getContext()
                .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        View view = inflater.inflate(R.layout.document_page, null);
        ((ViewPager) collection).addView(view, 0);

        ImageView imageView = (ImageView) view.findViewById(R.id.imageView);

        // Obtain the image file URI
        // Call algorithm to get scaled bitmap using ImageView width and height --> PROBLEM: imageView.getWidth()/Height() return 0!!
        // Set ImageView with scaled bitmap to avoid OutOfMemory Exception

        return view;
} 
```

你有什么建议？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T20:05:35.017

## 缩放图像客户端：

如果图像已经在您的设备上，您不需要自己的算法来缩放图像。An`ImageView`有一个[ScaleType](http://developer.android.com/reference/android/widget/ImageView.ScaleType.html)，您可以这样设置：

```
imageView.setScaleType(ImageView.ScaleType.CENTER_CROP) 
```

`android:scaleType`（或在带有属性的 XML 中）。

剩下的问题是如何从您的 URL 中获取图像以显示在`ImageView`. 使用诸如[SmartImageView](http://loopj.com/android-smart-image-view/)或[Android-Query](http://code.google.com/p/android-query/#Image_Loading)（更强大）之类的库以异步方式实现（即不阻塞您的 UI 线程）。

例如，使用 SmartImageView，您可以使用如下内容：

```
myImageView.setImageUrl("http://www.awesomeimages.com/myawesomeimage.jpg"); 
```

只需阅读该页面上的示例，还有更多选择。

## 扩展服务器端

如果您有某种由某些 URL 参数触发的调整大小算法，请使用[此解决方案](https://stackoverflow.com/a/9935072/1140682)并根据需要传递宽度和高度（可能使用上述库之一）。

正如您所说的那样`getWidth()`，`getHeight()`请`0`查看您已为您设置的`layout_width`和。如果是，则应该没有问题，但如果*必须*是，请考虑使用与最终图像具有相同纵横比的本地透明虚拟图像（直到设置了“真实图像”）。`layout_height``ImageView``fill_parent`*`wrap_content`*

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T23:09:08.650

使用带有 justInbounds 选项的位图工厂。所以它只会返回位图的尺寸而不将位图加载到内存中。

```
 options.inJustDecodeBounds = true; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-17T23:27:24.337

尝试将位图采样到屏幕的大小（使用[inJustDecodeBounds](http://developer.android.com/reference/android/graphics/BitmapFactory.Options.html#inJustDecodeBounds)来获取位图的分辨率，使用[displayMatrics](http://developer.android.com/reference/android/util/DisplayMetrics.html)来获取屏幕的分辨率）。

如果没有透明度，您可能还希望使用[RGB 565 格式](http://developer.android.com/reference/android/graphics/Bitmap.Config.html)的位图解码而不是 8888。这将节省大约 1/4 的正在使用的内存。

无论如何，我建议阅读处理位图的[本教程。](http://developer.android.com/training/displaying-bitmaps/index.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-04-06T10:50:41.540

我遇到了同样的问题，但我想出了一个解决方案：创建一个函数并从“public Object instantiateItem(ViewGroup collection, int position)”中调用它。

诀窍是：创建的函数将设置为在几毫秒后执行（为此，您将使用 Handler 对象）

这样做，“instantiateItem”已经完成，并且视图元素将设置宽度和高度值。

下面是一些关于如何进行的示例代码：

```
@Override
public Object instantiateItem(ViewGroup container, int position)
{
    View view =  inflater.inflate(R.layout.pager_list_item,container,false);

    TextView textView= (TextView) view.findViewById(R.id.pagerTextView);
    ImageView imageView = (ImageView)view.findViewById(R.id.pagerImageView);

    ... //stuff that don't need the width and height

    Handler handle = new Handler();
    handle.postDelayed(new Runnable()
    {
        //here the widths and heights values should be already set
       //now you can test the view.getWidth() and view.getHeight()

       if(view.getWidth()!=0 && view.getHeight()!=0)
       {
          //now you sare safe to call the android algorithm for scaling large bitmaps
       }

    }, 100); //it will wait 100 miliseconds to execute

  return view;
} 
```

100 毫秒是一个任意数字，可能太多了！！

我建议您使用循环或递归函数来保证“if”语句中的块将被执行，这样您可以使用更小的毫秒。

在我的项目中，我使用了一个递归函数，它在执行“if”块之前调用自身，我设置为 5 毫秒。

它应该可以在没有循环或递归方法的情况下工作，只需设置一个像 100 这样的任意数字并稍后进行测试，但你不能保证应用程序在所有设备上的行为都相同，因为一个可能很快，而另一个可能需要一个等待视图准备好一点时间，你永远不会知道。*

# razor - 在 Visual Studio 2012 的 Razor 文件中设置断点

> ID：14386751
> 
> 赞同：2
> 
> 时间：2013-01-17T19:38:13.150
> 
> 标签：razor, visual-studio-2012

在 Visual Studio 2012 中，我试图在我的 razor (.cshtml) 文件中设置断点，但每次我尝试时，它都说断点不能是 ser，否则我会收到以下错误消息：

无法设置以下断点： ... 公共语言运行时无法设置断点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-17T19:38:13.150

我发现在我的 web.config 中，我有以下行：

```
<compilation 
    debug="true" targetFramework="4.0"
    assemblyPostProcessorType="Microsoft.VisualStudio.Enterprise.Common.AspPerformanceInstrumenter, Microsoft.VisualStudio.Enterprise.AspNetHelper, Version=11.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" /> 
```

assemblyPostProcessorType 属性导致了问题。我假设它对破坏调试的动态生成的剃刀程序集做了一些事情。

所以我只是删除了该属性以获得：

```
<compilation debug="true" targetFramework="4.0" /> 
```

# css - 带有 CSS 的悬停工具提示的 z-index

> ID：14386759
> 
> 赞同：2
> 
> 时间：2013-01-17T19:38:25.517
> 
> 标签：css, tooltip, z-index

我只使用 CSS 悬停缩略图：

```
<style type='text/css'>
#like_table td a{z-index:2;}
#like_table .tooltip
{
    position: relative;
    z-index:1;
}
#like_table .tooltip a
{
  z-index:2;
}
#like_table .tooltip span
{
  z-index:9999;
  display:none;
}
#like_table .tooltip:hover span
{
          position:absolute;
          display:block;
          top:1.5em;
          left:2em;
          border:1px solid black;
          background-color:white;
          padding:0.2em;
}
#like_table td .tooltip .tooltip_thumb{
            z-index:99999;
}
</style>

<table id='like_table' class='smallfont' border='0' cellpadding='0' cellspacing='0'><tr><td>
                    <div class='like_row'>
                        <a href='#user1' class='nul'>User 1</a> liked <a href='#link' class='tooltip'>forum post<span><img src='image.jpg' class='tooltip_thumb' alt='' /></span></a>
                        <span class='by_user'>by <a href='#user2' class='nul'>User 2</a></span>
                    </div>
                    </td>
</tr> 
```

不幸的是，跨度和悬停图像上的 z-index 似乎不起作用。图像显示在用户名“下方”（类 by_user），但在普通文本上方。

如何使覆盖/工具提示显示在顶部？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-17T19:52:21.767

您的 z-index 将不起作用，因为所有这些项目不在同一级别。它们都相互嵌套。Z-index 仅适用于 DOM 中同一级别的元素，如下所示：

```
<div class="level1">
   <span class="level2"> 1 </span>
   <span class="level2"> 2 </span>
   <span class="level2"> 3 </span>
</div> 
```

如果您在跨度上设置 z-index ，这将起作用，但如果您戴上它，它将没有任何效果，因为它是“上部”元素。

编辑：并且在你的css中你已经写了`.tooltip a`但是你没有`<a>`in `.tooltip`，所以你`a.tooltip`认为我想。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-17T19:39:35.007

删除所有当前`z-index`并保持`z-index: 9999`打开状态`.tooltip`

# design-patterns - Motif/UIL 是模型-视图-视图模型吗？

> ID：14386760
> 
> 赞同：2
> 
> 时间：2013-01-17T19:38:27.550
> 
> 标签：design-patterns, mvvm, motif

我试图了解这种模式的含义（不仅仅是“我正在使用最近的 Microsoft GUI 工具”）。[MVVM wiki](https://stackoverflow.com/questions/ask)页面似乎将其解释为表示模型的系统部分和表示模型的图形视图的部分的分离，中间有一点在两者之间进行转换。这也意味着微软为 WPF 发明了这个概念。

但是，我看不出这与自 1980 年代以来[UIL](http://www.cs.nmsu.edu/~rth/cs/cs177/s98/IntroUIL2.html)为[Motif所做的事情之间有什么区别。](http://en.wikipedia.org/wiki/Motif_%28widget_toolkit%29)

那么 MVVM 是否只是*Motif*的用户代码/UIL/MRM 设置等方案的模式，还是有更多内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-09T18:15:19.440

正如您所创造的，MVVM 是一个概念或“模式”，它是一种将用户界面与产生您想要可视化的数据的算法分离的方法。

不过，我不会说 UIL 就是一个很好的例子。根据[Wikipedia](http://en.wikipedia.org/wiki/MVVM)，MVVM 不需要单独的用户界面语言，但它可以提供帮助。Motif 从未设计为将 UI 与业务逻辑完全分离。UIL 所做的只是指定 UI 小部件层次结构的模板，这些模板可以多次获取、随时随地重用，并预先设置各种内容。您仍然需要为回调提供代码以使事情发生，包括更改颜色和执行超出 UIL 允许的其他操作。

# linux - 每当读取、写入文件时记录

> ID：14386761
> 
> 赞同：0
> 
> 时间：2013-01-17T19:38:28.253
> 
> 标签：linux, security, unix

由于安全要求，每当读取或写入系统上的任何文件时，我都需要保留一个日志文件。日志文件如下所示：

```
file - time - user 
```

这将如何完成？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-17T19:43:33.313

看看是否`auditd`适合你 - [http://linux.die.net/man/8/auditd](http://linux.die.net/man/8/auditd)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T19:45:03.790

您也可以考虑使用[inotify](http://en.wikipedia.org/wiki/Inotify)

# mysql - mysql分组和排序而不使用最外面的order by

> ID：14386763
> 
> 赞同：0
> 
> 时间：2013-01-17T19:38:30.680
> 
> 标签：mysql, group-by

我正在尝试返回用户列表及其上次登录日期。我需要得到一些不会影响我的外部顺序的东西，因为它是由用户选择对列表进行排序的参数动态填充的。另一件事是存储登录时间的表需要 2 个字段来链接到用户表 user_id 和 user_type。

```
table_admin
field: id, name

table_logs
field: id, user_id, user_type, login_date 
```

*table_admin.id = table_logs.user_id

table_logs.user_type 需要是“admin”*

我需要从 table_admin 中提取所有管理员用户的最后登录日期（如果日志表中没有记录，它也需要工作），日志表中的 user_type 将是“admin”。

感谢您的时间。

```
SELECT SQL_CALC_FOUND_ROWS admins.*,ld2.ip,ld2.login_date as last_login 
FROM admins 
LEFT JOIN ( 
    SELECT * FROM log_logins WHERE user_type = "admin" ORDER BY login_date DESC 
) as ld2 ON (ld2.user_id = admins.id) 
WHERE 1 
GROUP BY user_id 
ORDER BY admins.id DESC LIMIT 0,40 
```

这是我到目前为止所拥有的，但如果它们在日志表中没有条目，它就不会获取结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T19:48:37.390

这是一个带有聚合的连接：

```
select a.name, 'admin' as userType, max(l.login_date) as lastLoginDate
from admin a left outer join
     logs l
     on a.id = l.id and
        l.user_type = 'admin'
group by a.name 
```

# python - 子进程调用

> ID：14386775
> 
> 赞同：2
> 
> 时间：2013-01-17T19:39:10.970
> 
> 标签：python, subprocess

我是 subprocess.call 函数的新手，我尝试了同一个调用的不同组合，但它不起作用。

我正在尝试执行以下命令：

```
cmd = 'sort -k1,1 -k4,4n -k5,5n '+outpath+fnametempout+' > '+outpath+fnameout
print cmd 
```

如果我尝试拨打电话，我会收到错误消息：

```
cmd = cmd.split(" ")
print cmd
subprocess.call(cmd) 
```

我得到的错误是：

```
sort: stat failed: >: No such file or directory 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-17T19:41:29.437

这样做，您需要`shell=True`允许 shell 重定向工作。

```
subprocess.call('sort -k1,1 -k4,4n -k5,5n '+outpath+fnametempout,shell=True) 
```

更好的方法是：

```
with open(outpath+fnameout,'w') as fout: #context manager is OK since `call` blocks :)
    subprocess.call(cmd,stdout=fout) 
```

这避免了一起生成 shell 并且可以安全地免受 shell 注入类型的攻击。在这里，`cmd`是您原来的列表，例如

```
cmd = 'sort -k1,1 -k4,4n -k5,5n '+outpath+fnametempout
cmd = cmd.split() 
```

还应该指出，python 具有非常好的排序工具，所以我怀疑是否真的有必要`sort`通过子进程将工作传递给。

* * *

最后，与其使用`str.split`从字符串中拆分参数，不如使用它可能会更好`shlex.split`地处理带引号的字符串。

```
>>> import shlex
>>> cmd = "foo -b -c 'arg in quotes'"
>>> print cmd.split()
['foo', '-b', '-c', "'arg", 'in', "quotes'"]
>>> print shlex.split(cmd)
['foo', '-b', '-c', 'arg in quotes'] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-10-03T15:06:23.187

不要在 python 中执行上述命令：

```
import subprocess
import sys
proc = subprocess.Popen(['sort','-k1','1', '-k4','4n', '-k5','5n',    '+outpath+fnametempout+', '>', '+outpath+fnameout'],stdin=subprocess.PIPE)
proc.communicate() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-25T04:15:12.240

例子：

```
subprocess.call(['ps','aux'])
lines=subprocess.check_output(['ls','-al'])
line_list = lines.split('\n')

or

handle = subprocess.Popen('ls',stdin=subprocess.PIPE,stdout=subprocess.PIPE,stderr=subprocess.PIPE,close_fds=True)
handle.stdout.read() 
```

# python - 在 windows 上的 eclipse 中从 python 导出可运行程序

> ID：14386799
> 
> 赞同：0
> 
> 时间：2013-01-17T19:40:17.173
> 
> 标签：python, windows, export

我做了一些研究。（对不起，这个真的很新）我需要为 python 2.7 创建一个 exe。我在windows 8上通过eclipse运行python。我试过py2exe和pyinstaller。我已经下载了它们，但我不知道从那里做什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T19:44:03.513

对于独立且可移植的可执行文件，您可以查看[pyinstaller](http://www.pyinstaller.org/)

# php - 如何将数据从我的表单发送到 uplodify.php

> ID：14386800
> 
> 赞同：0
> 
> 时间：2013-01-17T19:40:17.137
> 
> 标签：php, mysql, ajax, uploadify

我正在尝试将我的数据库行 ID 从此表单发送到uploadify.php，以便它可以使用文件名更新该行但是当我运行相同的脚本时没有发生这种情况所需数据行下方的行。我该怎么办请帮忙。

**这是我的 form.php**

```
 <!DOCTYPE HTML>
    <html>
    <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>UploadiFive Test</title>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
    <script type="text/javascript" src="Upl/jquery.uploadify.min.js"></script>
    <link rel="stylesheet" type="text/css" href="Upl/uploadify.css" />
    <style type="text/css">
    body {
        font: 13px Arial, Helvetica, Sans-serif;
    }
    </style>
    <?php
    include ('lId.php')
    ?>
        <script type="text/javascript">
        $(function() {
        $('#imgUpload').uploadify({
            'auto'     : false,
            'swf'      : 'Upl/uploadify.swf',
            'uploader' : 'Upl/uploadify.php',
            'height'   : 20,
            'width'    : 200,
            'fileTypeDesc' : 'Image Files',
            'fileTypeExts' : '*.gif; *.jpg; *.png',
            'method' : 'POST',
            'scriptData' : {'iD' : "<?php echo $tId; ?>" },        
            // Put your options here
        });
    });
        </script>

    </head>

    <body>
        <h1>Uploadify Demo</h1>
        <p>
        <label for="poiid">ID :</label>
        <input type="text" name="poiid" id="poiid" readonly="readonly" style="width:70px;" value="<?php echo $tId; ?>" />
      </p>
        <form enctype="multipart/form-data" method="POST">
            <div id="queue"></div>
            <input id="imgUpload" name="imgUpload" type="file" multiple="true" />
            <a href="javascript:$('#imgUpload').uploadify('upload','*')">Upload Files</a>
        </form>

    </body>
    </html> 
```

**我的 upldify.php**

```
<?php
/*
Uploadify
Copyright (c) 2012 Reactive Apps, Ronnie Garcia
Released under the MIT License <http://www.opensource.org/licenses/mit-license.php> 
*/

include ('../../POIWeb/connect.php');

// Define a destination
$sId = $_REQUEST['iD'];
$path = 'POIWeb/img/';
$targetPath = $_SERVER['DOCUMENT_ROOT'] . $path ; // Relative to the root

/*$verifyToken = md5('unique_salt' . $_POST['timestamp']);

if (!empty($_FILES) && $_POST['token'] == $verifyToken) {
    $tempFile = $_FILES['Filedata']['tmp_name'];
    $targetPath = $_SERVER['DOCUMENT_ROOT'] . $targetFolder;
    $targetFile = rtrim($targetPath,'/') . '/' . $_FILES['Filedata']['name'];

    // Validate the file type
    $fileTypes = array('jpg','jpeg','gif','png'); // File extensions
    $fileParts = pathinfo($_FILES['Filedata']['name']);

    if (in_array($fileParts['extension'],$fileTypes)) {
        move_uploaded_file($tempFile,$targetFile);

        echo $fName;
        echo '1';
    } else {
        echo 'Invalid file type.';
    }
}*/

if (!empty($_FILES)) {
    $tempFile = $_FILES['Filedata']['tmp_name'];
    $targetFile = $targetPath . $_FILES['Filedata']['name'];

    // Validate the file type
    $fileTypes = array('jpg','jpeg','gif','png'); // File extensions
    $fileParts = pathinfo($_FILES['Filedata']['name']);

    if (in_array($fileParts['extension'],$fileTypes)) {
        move_uploaded_file($tempFile,$targetFile);

        $fName = $_FILES['Filedata']['name'];
        //$imgPath = "INSERT INTO poiinfo(`Img`) VALUES ('$fName')";
        $imgPath = "UPDATE poiinfo SET Img = '$fName' WHERE ID = '$sId'";
        mysql_query($imgPath);
        echo '1';       

    } else {
        echo 'Invalid file type.';
    }
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T08:20:16.940

使用“formData”而不是“scriptData”。并获取 $_POST 数组中的数据。

`<a href="javascript:$('#imgUpload').uploadify('upload','*')">Upload Files</a>`不需要此代码

但是 uploadify 直接上传文件 - 这意味着您需要添加文件的下一个名称，不要重写。

# objective-c - NSApplication windows 属性 - windows 没有被删除？

> ID：14386802
> 
> 赞同：3
> 
> 时间：2013-01-17T19:40:25.093
> 
> 标签：objective-c, macos, cocoa, appkit

我有一个显示模态的 NSWindow/Controller。它有一个“关闭”按钮连接到这样的操作：

```
- (IBAction)close:(id)sender
{
    [self.window orderOut:sender];
    [self.window close];

    [[NSApplication sharedApplication] stopModal];
} 
```

在我的主窗口中，我显示了模式：

```
- (IBAction)modal:(id)sender
{
    NSLog(@"Before: %lu", [[[NSApplication sharedApplication] windows] count]);

    ModalWindowController *modal = [[ModalWindowController alloc] initWithWindowNibName:@"ModalWindowController"];
    [[NSApplication sharedApplication] runModalForWindow:modal.window];

    NSLog(@"After: %lu", [[[NSApplication sharedApplication] windows] count]);
} 
```

我打开和关闭模态几次，输出是这样的：

```
2013-01-17 14:36:08.071 Modals[3666:303] Before: 1
2013-01-17 14:36:08.962 Modals[3666:303] After: 2
2013-01-17 14:36:09.578 Modals[3666:303] Before: 2
2013-01-17 14:36:11.009 Modals[3666:303] After: 3
2013-01-17 14:36:12.108 Modals[3666:303] Before: 3
2013-01-17 14:36:12.910 Modals[3666:303] After: 4 
```

因此，*[[[NSApplication sharedApplication] windows] count]*只会*增加*。

我希望它随着我打开和关闭模式窗口而增加和减少。我的应用程序使用 ARC。谁可以给我解释一下这个？

先感谢您

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T19:54:35.163

您正在关闭窗口，但这并没有取消分配它，因为您的窗口控制器`ModalWindowController`仍在保留它。我在您的示例中没有看到任何表明正在释放窗口控制器的内容。

给您的最简单的答案是让您在调用`-runModalForWindow:`.

您可能期望窗口控制器在您的窗口关闭时关闭。这是你必须自己做的事情。来自 Apple 文档中的“Window Closing Behavior”：

> 如果您希望关闭一个窗口以使窗口和窗口控制器在它不是文档的一部分时都消失，您的 NSWindowController 子类可以观察 NSWindowWillCloseNotification 或者作为窗口委托，实现 windowWillClose: 方法并包括以下内容实现中的代码行：“[self autorelease];”

在您的场景中，这可能不是最好的方法，因为在您有机会调用`-stopModal`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-17T19:56:44.463

看看这个*NSWindow*方法：

```
- (void)setReleasedWhenClosed:(BOOL)releasedWhenClosed; 
```

如果您将其设置为*YES* ，您的窗口将在关闭时被释放。但请注意，当计数为零时，它将被释放。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-06-11T15:44:43.067

对于 Swift 5 人来说，这对我有用。在这种情况下，我想正确关闭每个窗口，除非它是最后一个窗口，在这种情况下，我希望它隐藏

```
 func windowShouldClose(_ sender: NSWindow) -> Bool {
    sender.isReleasedWhenClosed = true
    if NSApp.windows.count > 1 {
        return true
    }
    NSApp.hide(nil)
    return false
} 
```

# java - 尝试读取 har 文件时出现空指针异常

> ID：14386805
> 
> 赞同：0
> 
> 时间：2013-01-17T19:40:29.140
> 
> 标签：java, file, har

我正在尝试读取 har 文件并且`readHarFile`正在引发空指针异常。这是我尝试使用的示例代码：

```
public class readhar{
  public static void main(String [] args) throws exception{
    File f = new File ("file path");
    HarFileReader r = new HarFileReader();
    HarLog log = r.readHarFile(f);
    System.out.println(log);
  }
} 
```

例外是：

```
Exception in thread "main" java.lang.NullPointerException at 
edu.umass.cs.benchlab.har.HarLog.<init>(HarLog.java:134) at 
edu.umass.cs.benchlab.har.tools.HarFileReader.readHarFile(HarFileReader.java:116‌​) at 
edu.umass.cs.benchlab.har.tools.HarFileReader.readHarFile(HarFileReader.java:89) at 
readHar.main(readHar.java:18) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native  Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57) at 
sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.jav‌​a:43) 
```

# c# - MultiLanguage - 逻辑错误初学者

> ID：14386806
> 
> 赞同：0
> 
> 时间：2013-01-17T19:40:34.833
> 
> 标签：c#, asp.net, visual-studio-2012

我正在使用`WIndows 8`, 和`Visual Studio 2012 Metro`. 我需要添加一个`DropDownList`并让用户选择语言。当用户选择一种特定语言时，我需要将标签中的所有文本值更改为该特定语言。

[我跟着这个教程](http://www.youtube.com/watch?v=-BXpZyoxHzY)

```
I  R-CLick project added `APPGlobal_Resource` folder
I R-Clicked and added `APPGlobal_Resource` and created a Resource file called rss.resx 
Then i duplicated this file and named it rss.fr.resx
I gave 2 values `String1` and `Hello` and `Bonjour` as values (in both files)
R-Click `dropdownlist` and `edit item`, and `ADD` and then gave `en-US` as `Name` and `value`as  `en-US` (same way i gave `en-fr`)
Then i set the Label property, `Data (Expression)` `Bindable property` to `Text` and `Expression Type` to `Resources`.

I gave the `Class Key` to `Res` and `Resource Key` to `String1`. 
```

我写了下面的代码`Default.aspx.cs`

```
 protected override void InitializeCulture()
        {
            base.InitializeCulture();
            String cult = Request["DropDownList1"];

            if (cult != null)
            {
                Culture = cult;
                UICulture = cult;
            }
        } 
```

下拉菜单显示`en-US and en-fr`但当我选择它时没有任何变化。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T19:44:19.800

不确定，但它可以帮助：

```
System.Threading.Thread.CurrentThread.CurrentCulture = 
    new System.Globalization.CultureInfo( cult ); 
```

# javascript - 分配对象javascript的参数值

> ID：14386807
> 
> 赞同：2
> 
> 时间：2013-01-17T19:40:48.747
> 
> 标签：javascript, function, object, parameters

我一直在看这段代码很长时间试图弄清楚这一点，但我没有运气。这个问题是我想给参数boxId赋值。当我点击网页中的一个框时，会出现一个显示该 ID 的警报。我尝试了很多东西，但似乎没有任何效果。我是初学者，所以我觉得在这一点上一定有一些我不知道该怎么做的事情。

构造函数：

```
 function Box (boxId, name, color, number, coordinates) {  
   this.boxId = boxId;
   this.name = name;
   this.color = color;
   this.number = number;
   this.coordinates = coordinates;
  } 
```

全局变量：

```
 var boxes = []; 
  var counter = 0; 
  var boxId = 0; 
```

初始化函数：

```
 window.onload = init;

  function init() {     
   var generateButton = document.getElementById("generateButton");
   generateButton.onclick = getBoxValues;   
   var clearButton = document.getElementById("clearButton");
   clearButton.onclick = clear;   
  } 
```

获取值并创建新框的函数：

```
 function getBoxValues() {
   var nameInput = document.getElementById("name");  
   var name = nameInput.value; 

   var numbersArray = dataForm.elements.amount;
   for (var i = 0; i < numbersArray.length; i++) {
   if (numbersArray[i].checked) {
     number = numbersArray[i].value;
   }
   }  

   var colorSelect = document.getElementById("color");  
   var colorOption = colorSelect.options[colorSelect.selectedIndex];  
   var color = colorOption.value;                       

   if (name == null || name == "") {                    
     alert("Please enter a name for your box");
     return;
   }
   else {
    var newbox = new Box(boxId, name, color, number, "coordinates");  
    boxes.push(newbox);
    counter++;
    var boxId = counter;
    }

    addBox(newbox);

   var data = document.getElementById("dataForm");               
    data.reset();
   } 
```

将框添加到页面的函数：

```
 function addBox(newbox) {  
   for (var i = 0; i < newbox.number; i++) {                            
   var scene = document.getElementById("scene");              
   var div = document.createElement("div");                   
   div.className += " " + "box"; 
   div.innerHTML += newbox.name; 
   div.style.backgroundColor = newbox.color; 
   var x = Math.floor(Math.random() * (scene.offsetWidth-101));
   var y = Math.floor(Math.random() * (scene.offsetHeight-101));
   div.style.left = x + "px";
   div.style.top = y + "px"; 
   scene.appendChild(div); 
   div.onclick = display;                         
    }                  
  } 
```

单击框时显示警报的功能：

```
 function display(e) {
  var a = e.target;
  alert(a.counter);
  } 
```

清除框的功能：

```
function clear() {
  var elems = document.getElementsByClassName("box");
  for ( k = elems.length - 1; k >= 0; k--) {
   var parent = elems[k].parentNode;
   parent.removeChild(elems[k]);
  }
  } 
```

所有其他功能都可以正常工作。当我单击它时，我一直遇到显示为“未定义”的 id，或者控制台日志中显示为“0”的计数器，对于我尝试过的所有操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T20:35:01.440

你可以这样做。

首先，在 addBox() 中嵌入 boxId 作为标签的属性，如下所示：

```
div.setAttribute('data-boxId', newbox.boxId); 
```

然后在 display() 中，您可以将其取回：

```
alert(e.target.getAttribute('data-boxId')); 
```

请告诉您是否不喜欢这种方法，我将发布替代方法（关闭的东西）。

**编辑：**添加 jsfiddle 示例[http://jsfiddle.net/runtarm/8FJpU/](http://jsfiddle.net/runtarm/8FJpU/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T20:00:37.227

再试一次。也许如果你改变：

```
var boxId = counter; 
```

至

```
boxId = counter; 
```

然后它将使用外部范围的 boxId 而不是函数中定义的那个`getBoxValues()`

# asp.net - 任何想法如何将数组转换为 FOR 循环？

> ID：14386808
> 
> 赞同：-1
> 
> 时间：2013-01-17T19:40:48.950
> 
> 标签：asp.net, vb.net

下面的代码效果很好：

```
dashboard1.Text = charArray(0)
dashboard2.Text = charArray(1)
dashboard3.Text = charArray(2)
dashboard4.Text = charArray(3)
dashboard5.Text = charArray(4)
dashboard6.Text = charArray(5)
dashboard7.Text = ""
dashboard8.Text = ""
dashboard9.Text = ""
dashboard10.Text = ""
If dashboardl >= 7 Then
    dashboard7.Text = charArray(6)
End If
If dashboardl >= 8 Then
    dashboard8.Text = charArray(7)
End If

If dashboardl >= 9 Then
    dashboard9.Text = charArray(8)
End If
If dashboardl >= 10 Then
    dashboard10.Text = charArray(9)
End If 
```

但是，我想将它们转换为 FOR 循环，如下例所示，但出现错误。

```
For i = 1 To (dashboardl)
        ("dashboard" & CStr(i)) = charArray(i - 1)
Next i 
```

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T19:47:49.543

你可以试试这个...

```
 For i = 1 To dashboardl
        Dim txtBox As TextBox = FindControl("dashboard" & i)
        txtBox.Text = charArray(i - 1)
    Next i 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T19:55:00.383

哈，我没抓住重点。仍然不是在真正的计算机上，但试试这个......

```
For i = 1 To dashboardl
    Me.Controls("dashboard" & CStr(i)).Text = charArray(i - 1)
Next i 
```

# paypal - Paypal IPN payment_status

> ID：14386809
> 
> 赞同：1
> 
> 时间：2013-01-17T19:40:51.723
> 
> 标签：paypal, payment, paypal-ipn

我正在尝试在我的网站上使用 paypal ipn。我正在使用沙箱对其进行调试...我注意到有时我会在 payment_status 上获得值，例如挂起...我的问题是，当这笔付款完成时，我是否会再次从 paypal ipn 收到回复？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T22:35:52.687

是的你是。这就是为什么您应该在代码中实现逻辑以处理与同一事务相关的多条消息的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T04:24:16.553

来自贝宝网站：[https ://cms.paypal.com/es/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_testing_SBOverview](https://cms.paypal.com/es/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_testing_SBOverview)

“PayPal Sandbox 是一个独立的环境，您可以在其中对 PayPal 功能和 API 进行原型设计和测试。PayPal Sandbox 与实时 PayPal 网站几乎完全相同”

上面链接中的比较表确实提到了沙盒中未启用欺诈检测等某些场景。

除此之外，假设 live 的功能在沙盒中是相同的应该更安全（比如在状态从等待变为完成后接收 IPN 等）。

# c# - Coldfusion 8 互操作的最大 .NET 版本？

> ID：14386811
> 
> 赞同：7
> 
> 时间：2013-01-17T19:40:57.237
> 
> 标签：c#, .net, coldfusion, interop, coldfusion-8

我正在修改一些使用 cfobject 标记与 .NET 进行互操作的 CF8 代码。目前，它的目标是 .NET 2.0 程序集。如果不升级 CF，有没有办法让它与更高版本的 .NET（例如 v4.0）互操作？如果有的话，我需要做什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-25T00:05:38.880

（来自评论......）

[JNBridge](http://www.jnbridge.com/)与 CF 捆绑在一起，用于 .NET 互操作。AFAIK，直到 CF 9.0.1 才添加对 v4.0 的支持。我能找到的最权威的参考是 JNBridge 文档，即`cf_root\jnbridge`：

*   ColdFusion 8 使用 JNBridgePro v3.1，它“.. 支持所有 .NET 2.0/3.0 功能.. 并且还可以与 .NET Framework 3.0 一起使用”。

*   ColdFusion 9 使用 JNBridgePro v5.1，它[“..supports multi-targeting to .NET 2.0, 3.0, 3.5 and 4.0”](http://www.jnbridge.com/jn/blog/2010/04/26/jnbridgepro-5-1-released/)。

# python - python将列设置为值

> ID：14386813
> 
> 赞同：0
> 
> 时间：2013-01-17T19:41:20.797
> 
> 标签：python, python-2.4

我有一个大约 1000 行的 txt 文件，我想将第 1 列设置为源目标，将第 2 列设置为传输到目标并使用`shutil.copyfile(src, dst)`复制这些文件。

我现在将它设置为简单的打印（src，dst），所以我可以看到发生了什么。我没有做正确的事情`for src in vld`来添加 linux 价值。

我是否可以通过当前设置使 src 的值与 dst 的相应值对齐？我正在使用 Python 2.4

```
import csv
import operator
import sys
import os
import shutil

inf = csv.reader(open('data.txt','r'))
sortedlist = sorted(inf, key=operator.itemgetter(2), reverse=True)
def dothis(x):
        for row in sortedlist:
                print row[x]

vld = dothis(0)
linux = dothis(1)

for src in vld:
        dst = linux
        print (src, dst) 
```

当前错误信息：

```
 Traceback (most recent call last): File "test.py", line 16, in ? for src in vld:
TypeError: iteration over non-sequence 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T19:45:04.243

你几乎拥有它，但在那里的某个地方偏离了轨道。:) `dothis`不返回任何东西，所以`vld`和`linux`都是空的。

`csv.reader`已经为您“排列”了价值观；它一次产生行。实际上，当不需要时，您会再次将它们分开。

```
inf = csv.reader(open('data.txt','r'))
sortedlist = sorted(inf, key=operator.itemgetter(2), reverse=True)

for row in sortedlist:
    src = row[0]
    dst = row[1]
    print src, dst 
```

# java - Java socks 4代理问题

> ID：14386816
> 
> 赞同：0
> 
> 时间：2013-01-17T19:41:34.813
> 
> 标签：java, sockets, io, java-io

我已经通过使用反射调用 java.net.SocksSocketImpl#setV4 来设置 java 以使用 SOCK4。我的连接在 Socks5 上运行良好，但在 Socks 4 上我得到了一些套接字异常。例如：

```
java.net.SocketException: Malformed reply from SOCKS server
    at java.net.SocksSocketImpl.readSocksReply(Unknown Source)
    at java.net.SocksSocketImpl.connectV4(Unknown Source)
    at java.net.SocksSocketImpl.connect(Unknown Source)
    at java.net.Socket.connect(Unknown Source)
    at java.net.Socket.connect(Unknown Source) 
```

有任何想法吗？

# c# - 单元测试表单c#

> ID：14386819
> 
> 赞同：0
> 
> 时间：2013-01-17T19:42:00.433
> 
> 标签：c#, winforms, unit-testing

我设计了一个表单应用程序，它可以通过使用业务逻辑等更好地设计用于单元测试，但在这个阶段我不想改变我的代码。它是一个执行隐写术的应用程序，其中使用`LSB algorithm`. 我目前正在尝试为`button2 click event`. `button2`按下时；它将从另外两个获取文本`textboxes`和从 a 获取图像`picturebox`并运行`LSB algorithm`. 下面是测试功能。我为相关人员创建测试值`textboxes`。当我运行测试时，我得到：`System.NullReferenceException: Object reference not set to an instance of an object`. 这是指`object sender = null;` `EventArgs e = null;`. 或者我正在做什么甚至可能？我必须求助`NUnitForms`吗？我`button2_clic`在测试功能之后添加了 k ：

```
 public void button2_ClickTest()
    {
        StegApp_Accessor target = new StegApp_Accessor();
        // TODO: Initialize to an appropriate value
        object sender = null; // TODO: Initialize to an appropriate value
        EventArgs e = null; // TODO: Initialize to an appropriate value
        target.textBox4.Text = "123456";
        target.textBox5.Text = "test message";
        target.button2_Click(sender, e);

        //Assert.Inconclusive("A method that does not return a value cannot
        //  be    verified.");
        //target.textBox4.Text = "123456";
        //target.textBox5.Text = "test message";
        /*
        if (target.textBox4.Text.Length > 6 || target.textBox4.Text.Length < 0)
        {
            Assert.Fail("Key is out of range");
        }*/
        //Assert.IsInstanceOfType(target.b1,typeof(byte[]));
        if(target.b1.Length != target.temp4.Length)
        {
            Assert.Fail("B1 array does not have the correct lenght");
        }
        Assert.IsInstanceOfType(target.image1,typeof(Bitmap));
        Assert.IsInstanceOfType(target.sb,typeof(StringBuilder));
        if(target.sb.Length != target.tmp3.Length)
        {
            Assert.Fail("Issue with Stringbuilder sb. Lenght not equal to 'tmp3'!");
        }
        Assert.Equals(target.z,target.StringLenght);
        Assert.Equals(target.c, target.textBox5.Text.Length);

    }
    `private void button2_Click(object sender, EventArgs e)
    {
        //int x1, y1, z = 0;
        try
        {
            // Convert String Into Byte Array
            //byte[] sourceData = System.Text.ASCIIEncoding.ASCII.GetBytes(a);
            // Convert Each Byte Into A Binary String
            //foreach (byte thisByte in sourceData)
            // binaryString.Append(Convert.ToString(thisByte, 2));
            while (!key)
            {
                if (textBox4.Text == "")
                {
                    //b1 = ASCIIEncoding.ASCII.GetBytes(textBox5.Text);
                    key = false;
                    MessageBox.Show("Error, enter your six digit key!");
                    return;
                }
                else if (textBox4.Text.Length > 6)
                {
                    MessageBox.Show("Error, Key too long, try again!");
                    return;
                }
                else
                {
                    //temp4 = textBox4.Text[0] + textBox4.Text[1] + textBox4.Text[2] + textBox4.Text[3] + textBox4.Text[4] + textBox4.Text[5] + textBox5.Text;
                    c = textBox5.Text.Length;
                    temp5 = c.ToString();
                    if (c <= 9)
                    {
                        temp5 = "000" + temp5;
                    }
                    else if (c <= 99)
                    {
                        temp5 = "00" + temp5;
                    }
                    else if (c <= 999)
                    {
                        temp5 = "0" + temp5;
                    }
                    else if (c <= 9999)
                    {

                    }
                    else
                    {
                        MessageBox.Show("Message too long for this tool,try again");
                        return;
                    }
                    temp4 = textBox4.Text + temp5 + textBox5.Text;
                    b1 = ASCIIEncoding.ASCII.GetBytes(temp4);
                    key = true;
                }

            }
            //byte[] b1 = ASCIIEncoding.ASCII.GetBytes(textBox5.Text);
            //b1 = Encoding.Unicode.GetBytes(a);
            //Create the array to be returned.
            tmp2 = new string[b1.Length];

            //Interate through each byte
            for (int i = 0; i < b1.Length; i++)
            {
                int x = b1[i];
                tmp = "";
                while (true)
                {
                    if ((x % 2) == 1)
                    {
                        tmp = "1" + tmp;
                    }
                    else
                    {
                        tmp = "0" + tmp;
                    }
                    x /= 2;
                    if (x < 1) break;
                }

                //Make sure the value is 8 chars long.
                tmp2[i] = tmp.PadLeft(8, '0');

            }
            //string a="";
            for (int i = 0; i < b1.Length; i++)
            {
                //a = tmp2[i];
                tmp3 = tmp3 + tmp2[i];
            }
            if (key)
            {
                tmp3 = "00" + tmp3;
            }
            else
            {
                tmp3 = "10" + tmp3;
            }

            sb.Append(tmp3);
            //temp5 = c.ToString();
            //z= c+1;
            StringLenght = sb.Length;
            byte Mask0 = 254;
            byte Mask1 = 1;
            byte NewRed = 0, NewGreen = 0, NewBlue = 0;
            // Loop through the images pixels to reset color.
            for (x1 = 0, y1 = 0; x1 < image1.Width && z < StringLenght; x1++)
            {
                for (y1 = 0; y1 < image1.Height && z < StringLenght; y1++)
                {
                    Color pixelColor = image1.GetPixel(x1, y1);
                    //byte NewRed, NewGreen, NewBlue;
                    if (sb[z] == '0')
                    {
                        NewRed = Convert.ToByte(pixelColor.R & Mask0);
                        Color newColor = Color.FromArgb(NewRed, pixelColor.G, pixelColor.B);
                        image1.SetPixel(x1, y1, newColor);
                        pixelColor = image1.GetPixel(x1, y1);

                        z++;
                        if (z == StringLenght)
                        {
                            break;
                        }

                    }
                    else
                    {
                        NewRed = Convert.ToByte(pixelColor.R | Mask1);
                        Color newColor = Color.FromArgb(NewRed, pixelColor.G, pixelColor.B);
                        image1.SetPixel(x1, y1, newColor);
                        pixelColor = image1.GetPixel(x1, y1);

                        z++;
                        if (z == StringLenght)
                        {
                            break;
                        }

                    }
                    if (sb[z] == '0')
                    {
                        NewGreen = Convert.ToByte(pixelColor.G & Mask0);
                        Color newColor = Color.FromArgb(pixelColor.R, NewGreen, pixelColor.B);
                        image1.SetPixel(x1, y1, newColor);
                        pixelColor = image1.GetPixel(x1, y1);

                        z++;
                        if (z == StringLenght)
                        {
                            break;
                        }
                    }
                    else
                    {
                        NewGreen = Convert.ToByte(pixelColor.G | Mask1);
                        Color newColor = Color.FromArgb(pixelColor.R, NewGreen, pixelColor.B);
                        image1.SetPixel(x1, y1, newColor);
                        pixelColor = image1.GetPixel(x1, y1);

                        z++;
                        if (z == StringLenght)
                        {
                            break;
                        }
                    }
                    if (sb[z] == '0')
                    {
                        NewBlue = Convert.ToByte(pixelColor.B & Mask0);
                        Color newColor = Color.FromArgb(pixelColor.R, pixelColor.G, NewBlue);
                        image1.SetPixel(x1, y1, newColor);
                        pixelColor = image1.GetPixel(x1, y1);

                        z++;
                        if (z == StringLenght)
                        {
                            break;
                        }

                    }
                    else
                    {
                        NewBlue = Convert.ToByte(pixelColor.B | Mask1);
                        Color newColor = Color.FromArgb(pixelColor.R, pixelColor.G, NewBlue);
                        image1.SetPixel(x1, y1, newColor);
                        pixelColor = image1.GetPixel(x1, y1);

                        z++;
                        if (z == StringLenght)
                        {
                            break;
                        }
                    }
                    //string binary1 = Convert.ToString(pixelColor.R, 2);
                    //char last1 = binary1[binary1.Length - 1];
                }
            }
            MessageBox.Show("Message embedded");
            //Color newColor = Color.FromArgb(NewRed, NewGreen, NewBlue);
            //image1.SetPixel(x, y, newColor);
            // Set the PictureBox to display the image.
            //pictureBox1.Image = image1;

            // Display the pixel format in Label1.
            //label1.Text = "Pixel format: " + image1.PixelFormat.ToString();

        }
        catch (ArgumentException)
        {
            MessageBox.Show("There was an error." +
                "Check the path to the image file.");
        }

        //pictureBox2.Image = image1;

        //Byte[] buf = Encoding.Unicode.GetBytes(RetreivedMessage.ToString());
        //Byte[] buf = Encoding.Unicode.GetBytes(RetreivedMessage.ToString());
        //string result = System.Text.Encoding.Unicode.GetString(buf);
        //String result = Encoding.Unicode.GetString(buf);
        //StringBuilder r2 = new StringBuilder();
        //foreach (Byte b in Encoding.Unicode.GetBytes(FinalRetreivedMessage))
        //{
        //    r2.Append(Convert.ToString(b));
        // }
        //int v = 0;
        //for (int i = 0; i < FinalRetreivedMessage.Length; i++)
        //    {
        //     v = v * 2 + (FinalRetreivedMessage[i] == '0' ? 0 : 1);
        //    }
        //string result = v.ToString();

            // copy the string as UTF-8 bytes.
        //    byte[] utf8Bytes = new byte[FinalRetreivedMessage.Length];
        //   for (int i = 0; i < FinalRetreivedMessage.Length; ++i)
        //   {
                //Debug.Assert( 0 <= utf8String[i] && utf8String[i] <= 255, "the char must be in byte's range");
        //        utf8Bytes[i] = (byte)FinalRetreivedMessage[i];
        //  }
            //Encoding.UTF8.GetString(utf8Bytes, 0, utf8Bytes.Length);
            // utf8Bytes = new byte[]{1,1,1,0,1,0,0,0};
        //    string result1 = Encoding.UTF8.GetString(utf8Bytes, 0, utf8Bytes.Length);
            //string result1 = Encoding.UTF8.GetString(utf8Bytes);
        //    UTF8Encoding enc = new UTF8Encoding();
        //    string str = enc.GetString(utf8Bytes);
        //    Byte[] encodedBytes = enc.GetBytes(FinalRetreivedMessage);

        //    string message = encodedBytes.ToString();
        //   int count = FinalRetreivedMessage.Length / 8;
        //    var bollox = new byte[count];
        //    for (int i = 0; i < count; i++)
        //        bollox[i] = Convert.ToByte(FinalRetreivedMessage.Substring(i * 8, 8), 2);

        //    var bollox1 = new byte[count];
            //for (int i = 0; i < count; i++)
                //bollox1[i] = Encoding.Unicode.GetBytes(FinalRetreivedMessage.Substring(i * 8, 8));

        //    string result2 = bollox.ToString();
        //   string result3 = enc.GetString(bollox);
        //    string result4 = System.Convert.ToString(bollox);
        //    string StringIWant = BitConverter.ToString(bollox);
        //    string result5 = BitConverter.ToString(encodedBytes);
        //    string result6 = BitConverter.ToString(utf8Bytes);
        //    string result7 = BitConverter.ToString(Encoding.Unicode.GetBytes(FinalRetreivedMessage));
        //    string result8 = System.Convert.ToString(Encoding.Unicode.GetBytes(FinalRetreivedMessage));
        //    string result9 = Encoding.Unicode.GetString(Encoding.Unicode.GetBytes(FinalRetreivedMessage));
        //    string result10 = Encoding.Default.GetString(Encoding.Unicode.GetBytes(FinalRetreivedMessage));

    }` 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T01:00:14.090

```
private void button2_Click(object sender, EventArgs e)
    {
        Embed();
    }
public void Embed(string Embedkey, string EmbedMessage,Bitmap image3)
    {
     // embed message in image
    }

public void EmbedTest()
    {
        StegApp target = new StegApp(); // TODO: Initialize to an appropriate value
        string Embedkey = "123456"; // TODO: Initialize to an appropriate value
        string EmbedMessage = "test2"; // TODO: Initialize to an appropriate value
        Bitmap image3 = null; // TODO: Initialize to an appropriate value
        image3 = new Bitmap(@"C:\Users\Admin\Documents\dt265\Project\Sky\sky-and-cloud.bmp",true);
        string a="123456",b="test2";
        target.Embed(Embedkey, EmbedMessage, image3);
        //Assert.Inconclusive("A method that does not return a value cannot be verified.");
        if (Embedkey.Length > 6 || Embedkey.Length < 0)
        {
            Assert.Fail("Key is out of range");
        }
        //Assert.IsInstanceOfType(target.b1,typeof(byte[]));
        if(target.b1.Length != target.temp4.Length)
        {
            Assert.Fail("B1 array does not have the correct lenght");
        }
        Assert.IsInstanceOfType(target.image1,typeof(Bitmap));
        Assert.IsInstanceOfType(target.sb,typeof(StringBuilder));
        if(target.sb.Length != target.tmp3.Length)
        {
            Assert.Fail("Issue with Stringbuilder sb. Lenght not equal to 'tmp3'!");
        }
        if(target.z != target.StringLenght)
        {
            Assert.Fail("z != StringLenght");
        }
        if (target.c != EmbedMessage.Length)
        {
            Assert.Fail("c is not the lenght of the Message!");
        }

    } 
```

# python - 快速的 numpy 花式索引

> ID：14386822
> 
> 赞同：12
> 
> 时间：2013-01-17T19:42:11.090
> 
> 标签：python, numpy, indexing, slice

我用于切片 numpy 数组的代码（通过精美的索引）非常慢。它目前是程序中的一个瓶颈。

```
a.shape
(3218, 6)

ts = time.time(); a[rows][:, cols]; te = time.time(); print('%.8f' % (te-ts));
0.00200009 
```

什么是正确的numpy调用来获取由矩阵a的行'rows'和列'col'的子集组成的数组？（其实我需要这个结果的转置）

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-18T11:20:41.180

让我尝试总结 Jaime 和 TheodrosZelleke 的出色答案，并加入一些评论。

1.  [高级（花式）索引](http://docs.scipy.org/doc/numpy/reference/arrays.indexing.html#advanced-indexing)总是返回一个副本，而不是一个视图。
2.  `a[rows][:,cols]`意味着*两个*花哨的索引操作，所以一个中间副本`a[rows]`被创建和丢弃。方便且可读，但效率不高。此外请注意，`[:,cols]`通常会从 C-cont 生成 Fortran 连续副本。来源。
3.  `a[rows.reshape(-1,1),cols]`是一个单一的高级索引表达式，它基于`rows.reshape(-1,1)`和`cols`被[广播](http://docs.scipy.org/doc/numpy/reference/ufuncs.html#broadcasting)到预期结果的形状。
4.  一个常见的经验是，扁平化数组中的索引可能比花式索引更有效，因此另一种方法是

    ```
    indx = rows.reshape(-1,1)*a.shape[1] + cols
    a.take(indx) 
    ```

    或者

    ```
    a.take(indx.flat).reshape(rows.size,cols.size) 
    ```

5.  效率将取决于内存访问模式以及起始数组是 C-countinous 还是 Fortran 连续的，因此需要进行实验。

6.  仅在真正需要时才使用花哨的索引：[基本切片](http://docs.scipy.org/doc/numpy/reference/arrays.indexing.html#basic-slicing) `a[rstart:rstop:rstep, cstart:cstop:cstep]`返回一个视图（尽管不是连续的）并且应该更快！

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-01-17T20:56:27.413

令我惊讶的是，这种计算第一个线性一维索引的长表达式比问题中提出的连续数组索引快**50%以上：**

```
(a.ravel()[(
   cols + (rows * a.shape[1]).reshape((-1,1))
   ).ravel()]).reshape(rows.size, cols.size) 
```

**更新：** OP 更新了初始数组形状的描述。使用更新后的大小，加速比现在超过**99%**：

```
In [93]: a = np.random.randn(3218, 1415)

In [94]: rows = np.random.randint(a.shape[0], size=2000)

In [95]: cols = np.random.randint(a.shape[1], size=6)

In [96]: timeit a[rows][:, cols]
10 loops, best of 3: 186 ms per loop

In [97]: timeit (a.ravel()[(cols + (rows * a.shape[1]).reshape((-1,1))).ravel()]).reshape(rows.size, cols.size)
1000 loops, best of 3: 1.56 ms per loop 
```

**初步答案：** 以下是成绩单：

```
In [79]: a = np.random.randn(3218, 6)
In [80]: a.shape
Out[80]: (3218, 6)

In [81]: rows = np.random.randint(a.shape[0], size=2000)
In [82]: cols = np.array([1,3,4,5]) 
```

时间方法一：

```
In [83]: timeit a[rows][:, cols]
1000 loops, best of 3: 1.26 ms per loop 
```

时间方法二：

```
In [84]: timeit (a.ravel()[(cols + (rows * a.shape[1]).reshape((-1,1))).ravel()]).reshape(rows.size, cols.size)
1000 loops, best of 3: 568 us per loop 
```

检查结果是否实际上相同：

```
In [85]: result1 = a[rows][:, cols]
In [86]: result2 = (a.ravel()[(cols + (rows * a.shape[1]).reshape((-1,1))).ravel()]).reshape(rows.size, cols.size)

In [87]: np.sum(result1 - result2)
Out[87]: 0.0 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-01-17T20:15:30.223

如果您使用精美的索引和广播进行切片，则可以加快速度：

```
from __future__ import division
import numpy as np

def slice_1(a, rs, cs) :
    return a[rs][:, cs]

def slice_2(a, rs, cs) :
    return a[rs[:, None], cs]

>>> rows, cols = 3218, 6
>>> rs = np.unique(np.random.randint(0, rows, size=(rows//2,)))
>>> cs = np.unique(np.random.randint(0, cols, size=(cols//2,)))
>>> a = np.random.rand(rows, cols)
>>> import timeit
>>> print timeit.timeit('slice_1(a, rs, cs)',
                        'from __main__ import slice_1, a, rs, cs',
                        number=1000)
0.24083110865
>>> print timeit.timeit('slice_2(a, rs, cs)',
                        'from __main__ import slice_2, a, rs, cs',
                        number=1000)
0.206566124519 
```

如果你从百分比的角度来考虑，做某事快 15% 总是好的，但在我的系统中，对于你的数组的大小，这需要 40 us 来进行切片，而且很难相信一个操作需要240我们将是你的瓶颈。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-03-29T18:51:10.430

使用`np.ix_`您可以与 ravel/reshape 相似的速度，但使用更清晰的代码：

```
a = np.random.randn(3218, 1415)
rows = np.random.randint(a.shape[0], size=2000)
cols = np.random.randint(a.shape[1], size=6)
a = np.random.randn(3218, 1415)
rows = np.random.randint(a.shape[0], size=2000)
cols = np.random.randint(a.shape[1], size=6)

%timeit (a.ravel()[(cols + (rows * a.shape[1]).reshape((-1,1))).ravel()]).reshape(rows.size, cols.size)
#101 µs ± 2.36 µs per loop (mean ± std. dev. of 7 runs, 10000 loops each)

%timeit ix_ = np.ix_(rows, cols); a[ix_]
#135 µs ± 7.47 µs per loop (mean ± std. dev. of 7 runs, 10000 loops each)

ix_ = np.ix_(rows, cols)
result1 = a[ix_]
result2 = (a.ravel()[(cols + (rows * a.shape[1]).reshape((-1,1))).ravel()]).reshape(rows.size, cols.size)
​
np.sum(result1 - result2)
0.0 
```

# javascript - 任何具有双击列边界时自动调整列大小的 Excel 功能的 Slickgrid 版本？

> ID：14386827
> 
> 赞同：2
> 
> 时间：2013-01-17T19:42:32.860
> 
> 标签：javascript, slickgrid, autosize, tablecolumn

我知道 slickgrid 无法像标准 HTML 表格那样自动调整列的大小，因为它在绘制表格之前不知道列中的所有可能值（由于它是高性能的按需加载实现）。

但是，一旦所有行都加载并显示在屏幕上，是否有任何实现允许用户双击列边界并调整其大小以适应已加载的数据？当然，在加载额外的行后，这种调整大小可能并不完美，但我的数据（我想还有许多其他数据）是这样的，一开始就加载 50 行是一个足够好的样本大小来确定合适的宽度。即使不是，用户也可以再次双击。

* 以下是 Microsoft 提供的关于如何在 Excel 中执行此操作的说明：http: [//office.microsoft.com/en-us/excel-help/change-column-width-and-row-height-HP005198813.aspx# BM鼠标](http://office.microsoft.com/en-us/excel-help/change-column-width-and-row-height-HP005198813.aspx#BMmouse)。阅读讨论双击的第三个项目符号。

# ruby - 使用 rspec2 和 Nokogiri 进行单元测试

> ID：14386835
> 
> 赞同：0
> 
> 时间：2013-01-17T19:42:57.660
> 
> 标签：ruby, ruby-on-rails-3, nokogiri, rspec2

我有阅读第三方公共网站的要求。目前我可以通过 Nokogiri 做到这一点，但我在使用 rspec 编写一些单元测试时遇到了麻烦。

我有这个 HTML `<div>`：

```
<div class="user">
  <div class="name">User Name</div>
</div> 
```

在我的阅读器模型中，我有方法`name`，它从 HTML 中读取名称：

```
class SampleReader
    def name(html_div)
      html_div.css('name')
    end
end 
```

在我的 RSpec 测试用例中，我将上述 HTML`<div>`作为字符串传递给该`name`方法，但出现以下错误：

```
undefined method `css' for #<String:0x007fd8a0b39c98> 
```

我相信这是因为 Nokogiri 无法将字符串识别为 HTML，所以如果有人可以帮助我编写测试用例，我将不胜感激。而且，如果可能的话，我的首选选项是只将`<div>`字符串而不是整个 HTML 页面源传递给该方法。

*   我正在使用 Rails 3.2.9
*   规格2
*   野小切

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T20:22:21.210

您需要将 HTML 字符串包装为 Nokogiri 文档：

```
require 'nokogiri'

str = <<-HTML
<div class="user">
  <div class="name">User Name</div>
</div>
HTML

class SampleReader
  def name(html_div)
    doc = Nokogiri::HTML(html_div)
    doc.css('.name').text
  end
end

reader = SampleReader.new
puts reader.name(str) #=> "User Name" 
```

另外，不要忘记[将您的应用程序升级到 rails 3.2.11](http://weblog.rubyonrails.org/2013/1/8/Rails-3-2-11-3-1-10-3-0-19-and-2-3-15-have-been-released/)。

# c# - 并行编程 C# - TPL - 更新共享变量和建议

> ID：14386839
> 
> 赞同：0
> 
> 时间：2013-01-17T19:43:17.930
> 
> 标签：c#, multithreading, c#-4.0, thread-safety, task-parallel-library

我是并行编程的新手，事实上这是我第一次尝试它。我目前正在.NET 4 中做一个项目，并且更喜欢有 4 或 5 个并行执行。

我看到了一些选择。有`Task.Factory.StartNew` `Parallel.For` `Parallel.ForEach`等。

我要做的是发布到一个网站并获取大约 200 个 URL 的响应。

当我使用时，`Parallel.ForEach`我没有找到控制线程数的方法，应用程序使用了 130 多个线程并且网站没有响应:)

我有兴趣在`Task.Factory.StartNew`for 循环中使用并将 URL 分为 4 或 5 个任务。

```
List<Task> tasks = new List<Task>();
for (int i = 0; i < 5; i++)
{
    List<string> UrlForTask = GetUrlsForTask(i,5); //Lets say will return some thing like 1 of 5 of the list of URLs
    int j = i;
    var t = Task.Factory.StartNew(() =>
    {
        List<PageSummary> t = GetSummary(UrlForTask);
        Summary.AddRange(t); //Summary is a public variable
    }
    tasks.Add(t);
} 
```

我相信这些任务可以归结为线程。所以如果我做`Summary`一个`List<PageSummary>`线程安全的（我知道多个线程访问共享变量存在问题）？

这是我们应该使用的地方`ConcurrentQueue<T>`吗？

您是否知道有助于了解如何通过多个任务等访问和更新共享变量的好资源？

您可能认为我可以用于此类任务的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T20:14:50.010

`Parallel.ForEach`具有带`ParallelOptions`实例的重载。该类的`MaxDegreeOfParallelism`属性是您需要使用的。

```
List<MyRequest> requests = ...;
BlockingCollection<MyResponse> responses = ...;
Task.Factory.StartNew(() =>
{
    Parallel.ForEach(
        requests,
        new ParallelOptions { MaxDegreeOfParallelism = 4 },
        request => responses.Add(MyDownload(request)));
    responses.CompleteAdding();
});

foreach (var response in responses.GetConsumingEnumerable())
{
    Console.WriteLine(response.MyMessage);
} 
```

# c++ - 从构造函数抛出后调用析构函数

> ID：14386840
> 
> 赞同：73
> 
> 时间：2013-01-17T19:43:18.373
> 
> 标签：c++, exception, c++11

我曾经认为在 C++ 中，如果构造函数抛出异常，则不会调用这个“部分构造”类的析构函数。

但在 C++11 中似乎不再适用：我用 g++ 编译了以下代码，并将“ `X destructor`”打印到控制台。为什么是这样？

```
#include <exception>
#include <iostream>
#include <stdexcept>
using namespace std;

class X
{
public:
    X() : X(10)
    {
        throw runtime_error("Exception thrown in X::X()");    
    }
    X(int a)
    {
        cout << "X::X(" << a << ")" << endl;
    }
    ~X()
    {
        cout << "X destructor" << endl;
    }
};

int main()
{
    try
    {
        X x;
    }
    catch(const exception& e)
    {
        cerr << "*** ERROR: " << e.what() << endl;
    }
} 
```

输出

```
Standard out:
X::X(10) 
X destructor
Standard error: 
*** ERROR: Exception thrown in X::X() 
```

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2013-01-17T19:45:11.193

委托构造函数确实是一个新特性，它引入了新的销毁逻辑。

让我们重温一个对象的*生命*周期：一个对象的生命周期从*某个*构造函数完成时开始。（参见 15.2/2。标准将此称为“主要构造函数”。）在您的情况下，这是构造函数`X(int)`。第二个，委托构造`X()`函数现在只是一个普通的成员函数。在范围展开时，所有完全构造的对象的析构函数都会被调用，这包括`x`.

这实际上是非常深刻的：您现在可以将“复杂”的工作负载放入构造函数中，并充分利用通常的异常传播，只要您将构造函数委托给另一个构造函数。这样的设计可以消除对各种“init”函数的需求，这些函数在不希望在常规构造函数中投入太多工作时曾经很流行。

定义您所看到的行为的特定语言是：

> `[C++11: 15.2/2]:` *[..]*同样，如果对象的非委托构造函数已完成执行，并且该对象的委托构造函数因异常退出，则将调用对象的析构函数。*[..]*

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2013-01-18T00:06:06.080

> 我曾经认为在 C++ 中，如果构造函数抛出异常，则不会调用这个“部分构造”类的析构函数。
> 
> 但在 C++11 中似乎不再适用

这仍然是真的。自 C++03 以来没有任何改变（对于一些什么都没有的价值 ;-)）

你认为的仍然是正确的，但是抛出异常时*没有部分构造的对象。*

C++03 TC1 标准说（强调我的）：

> 部分构造或部分销毁的对象将为其所有完全构造的子对象执行析构函数，**即构造函数已完成执行且析构函数尚未开始执行的子对象。**

即任何已经完成其构造函数的对象都将通过执行析构函数而被销毁。这是一个很好的简单规则。

基本上相同的规则适用于 C++11：一旦`X(int)`返回，对象的“构造函数已完成执行”，因此它被完全构造，因此它的析构函数将在适当的时间运行（当它超出范围或在其构造的某个后期阶段抛出异常。）本质上它仍然是相同的规则。

委托构造函数的主体在另一个构造函数之后运行并且可以做额外的工作，但这并不能改变对象的构造已经完成的事实，所以它是完全构造的。委托构造函数类似于派生类的构造函数，它在基类的构造函数完成后执行更多代码。在某种意义上，您可以认为您的示例是这样的：

```
class X
{
public:
    X(int a)
    {
        cout << "X::X(" << a << ")" << endl;
    }
    ~X()
    {
        cout << "X destructor" << endl;
    }
};

class X_delegating : X
{
public:
    X_delegating() : X(10)
    {
        throw runtime_error("Exception thrown in X::X()");    
    }
}; 
```

它不是*真的*这样，只有一种类型，但它与`X(int)`构造函数运行类似，然后委托构造函数中的附加代码运行，如果这会抛出`X`“基类”（这不是真正的基类）被摧毁。

# flash-builder - 使用 ANT 脚本构建后无法删除 Flash Builder 中的 swc 文件

> ID：14386843
> 
> 赞同：3
> 
> 时间：2013-01-17T19:43:35.143
> 
> 标签：flash-builder

我正在尝试合并要在 FlashBuilder IDE 中使用的 ant 构建脚本，但是在尝试删除运行“干净”目标时创建的 swc 文件时遇到了问题。

我收到“发生问题”的错误

```
'Deleting files...' has encountered a problem.  Problems encountered while deleting resources.

Problems encountered while deleting resources.
Could not delete 'C:\project_src\trunk\flash\labs\bin\commonUtilities.swc'.
Problems encountered while deleting files.
Could not delete: C:\project_src\trunk\flash\labs\bin\commonUtilities.swc. 
```

即使我尝试通过右键单击 Flash Builder 中的包资源管理器进行删除，也会出现此错误。当我尝试从 Windows 资源管理器中删除它时，我收到一条错误消息，指出 FlashBuilder.exe 正在使用该文件。这让我怀疑 Flash Builder 以某种方式锁定了这个文件。为了使清理工作，我需要关闭 FlashBuilder，然后重新打开它。

一个有趣的注意事项是，一旦我重新打开 Flash Builder，并且如果我重复地进行清理/构建，它只会运行 swc 项目，它不会失败，但是一旦我尝试使用主项目进行完整构建，链接就会“锁定”发生。

如果我在项目属性下的 Builders 中使用默认的“Flex”，则不会出现此问题。它仅在我导入和使用自己的构建文件时发生。

我对 ant 和使用 flex 编译器非常陌生。我正在使用 编译我的 swc 文件。一些如何导致 FlashBuilder 保留生成的 swc 文件？

构建文件：C:\project_src\trunk\flash\master-build.xml

```
clean-labs:
      [delete] Deleting C:\project_src\trunk\flash\labs\bin\commonUtilities.swc

BUILD FAILED
C:\project_src\trunk\flash\master-build.xml:37: Unable to delete file C:\project_src\trunk\flash\labs\bin\commonUtilities.swc

Total time: 614 milliseconds 
```

我正在使用以下内容：

```
[echo] ANT_HOME: C:/apache-ant-1.8.4
[echo] flexTasks jar location: C:/apache-ant-1.8.4/lib/flexTasks.jar
[echo] FLEX_HOME: C:/Program Files (x86)/Adobe/Adobe Flash Builder 4.5/sdks/4.5.0
[echo] BRANCH_BASE: C:/justice_src/trunk/
[echo] DEBUG: false 
```

这是清洁实验室的目标：

```
<target name="clean-labs">
  <delete verbose="true" failOnError="true">
          <fileset dir="${BRANCH_BASE}/flash/labs/bin/" includes="labs.swc" />
  </delete>
</target> 
```

compc 部分的 swc 的构建目标如下：

```
<compc output="${BRANCH_BASE}/flash/labs/bin/commonUtilities.swc" 
    debug="${DEBUG}"
    locale="en_US" 
    incremental="true" > 
```

主项目的构建目标正在使用并包括

```
<compiler.library-path dir="${BRANCH_BASE}/flash/labs/bin/" append="true">
    <include name="commonUtilities.swc" />
</compiler.library-path> 
```

有谁知道发生了什么？非常感谢您对解决方案和解决方法的任何想法。

# facebook-graph-api - 从 Facebook 实时更新获取照片

> ID：14386845
> 
> 赞同：0
> 
> 时间：2013-01-17T19:43:55.157
> 
> 标签：facebook-graph-api, notifications, real-time, photo

我想知道当用户（授予我的应用程序所需的权限）在相册、群组中发布照片或在他/她的状态更新上分享照片时，是否有办法接收实时更新。

查看 facebook 文档，我的印象是，如果用户更改他/她的个人资料照片，我只能获得更新。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T16:26:35.963

检查[https://developers.facebook.com/docs/reference/api/realtime/](https://developers.facebook.com/docs/reference/api/realtime/)上的文档。它没有准确显示您可以通过实时更新监控哪些属性，但 Facebook 开发人员界面中有一个自动完成功能，可以向您显示以下内容：

```
name, category, location, phone, checkins, picture, website, hours, company_overview, description, email, feed, founded, features, general_info, general_manager, hometown, products, parking, public_transit, payment_options, price_range, restaurant_services, restaurant_specialties, culinary_team, press_contact, personal_info, personal_interests, productlists, awards, booking_agent, affiliation, bio, birthday, built, genre 
```

这不包括新照片..但您可以使用“提要”监控那些照片。

# bash - 我的 dob 排序脚本有问题

> ID：14386846
> 
> 赞同：1
> 
> 时间：2013-01-17T19:44:01.753
> 
> 标签：bash, shell, unix

我收到错误：第 34 行：#10#1001：语法错误：预期操作数（错误标记为“#10#1001”）

我刚刚改变

```
[! -f INPUT ] & 
```

到

```
[ ! -f INPUT ] && 
```

现在我得到了错误

```
line 34: #10#1001: syntax error: operand expected (error token is "#10#1001") 
```

当我运行脚本时。

该脚本输入用户姓名、电话号码和出生日期，然后对信息进行排序并计算他们的年龄。

什么可能导致此错误，因为我无法弄清楚它需要什么操作数

```
#!/bin/bash

a=0
while [ $a -lt 2 ];
do
    echo Please enter a first name
    read firstName
    echo Please enter last name
    read lastName
    echo Please enter phone number
    read phoneNumber
    echo Please enter date of birth - format dd/mm/yyyy
    read dob
    echo "$firstName,$lastName,$phoneNumber,$dob" >> userBirthdays.csv
    echo If you would like to add another person press 1 or enter 2 to proceed
    read a
done

    INPUT=./userBirthdays.csv
    OLDIFS=$IFS
    IFS=","
    [ ! -f INPUT ] && while read  while read Name Surname Telephone DOB
    do
                    birthMonth=${DOB:0:2}
                    birthDay=#10${DOB:3:2}
                    birthYear=${DOB:6:4}

                    currentDate=`date +%d/%m/%Y`

                    currentMonth=${currenDate:0:2}
                    currentDay=#10${currentDate:3:2}
                    currentYear=${currentDate:6:4}

                    if [[ "$currentMonth" -lt "$birthMonth" ]] || [[ "$currentMonth" -eq "$birthMonth" && "$((#10$currentDay))" -lt "$((#10$birthDay))" ]]
                    then
                            let Age=currentYear-birthYear-1
                    else
                            let Age=currentYear-birthYear
                    fi

            echo "Name : $Name"
            echo "Surname : $Surname"
            echo "Telephone : $Telephone"
            echo "DOB : $DOB"
            echo "Age : $Age"
            echo "##########################################"
done < $INPUT
IFS=$OLDIFS
    echo $DATE

exit 0; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T20:00:34.063

你在这条线上有两个错误：

```
[ ! -f INPUT ] && while read  while read Name Surname Telephone DOB 
```

它应该是：

```
[ -f ${INPUT} ] && while read Name Surname Telephone DOB 
```

我建议使用以下[方法调试](http://tldp.org/LDP/Bash-Beginners-Guide/html/sect_02_03.html)您的脚本：

```
bash -x /path/to/birthdays.bash 
```

这将在执行每个命令之前打印命令跟踪。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T19:56:01.357

`-lt`比较（和朋友）适用于整数，而不是字符串。然后你通过在它`currendDay`前面加上一个非整数字符串`#10`（顺便说一下，你做了两次）。

你在这里的意图不是很清楚。你想比较字符串吗？然后使用`<`而不是`-lt`. 你想`currentDay`成为一个数字吗？然后不要预先`#10`考虑它的价值（在这两个地方你现在都这样做）。

# dll - 如何安装 DotNetZip？

> ID：14386847
> 
> 赞同：5
> 
> 时间：2013-01-17T19:44:02.517
> 
> 标签：dll, visual-studio-2012, installation, dotnetzip

由于我对 Visual Studio 很陌生，这个问题可能听起来有点愚蠢：如何安装 DotNetZip 库？我正在使用适用于 Windows 桌面的 Visual Studio Express 2012。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-17T19:51:24.107

DotNetZip 没有设置。
只需[从其站点](http://dotnetzip.codeplex.com/releases/view/68268)下载包，将库解压缩到磁盘中的某个位置，然后将项目中的引用设置为适合您项目类型的发布文件夹。请记住将 DLL 与您的应用程序一起分发。

另一种简单的方法是使用`nuget`扩展来安装库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-02-18T08:47:44.510

有很多方法可以在您的项目中添加 DotNetZip 文件。我在下面只提到了两种方法：

**方式 1**：1\. 在 Visual Studio 中转到 - 工具-> NuGet 包管理器 -> 包管理器控制台 2\. 从包管理器控制台的默认项目下拉列表中选择您的项目。3\. 键入 Install-Package DotNetZip 并按 Enter。该包将自动包含在您的项目中。注意：有时它不会按预期工作。

**方式 2：** 1\. 在解决方案资源管理器中转到您的项目，然后是参考文件夹。2\. 右键单击​​ References 文件夹 -> 管理 NuGet 包。3\. 在弹出窗口中，从左侧菜单中选择在线。4\. 在搜索文本框中键入 DotNetZip。5\. 从加载列表中单击安装按钮。 [管理 NugGet 包弹出窗口](http://i.stack.imgur.com/atrkM.png)

# ios - OpenGL ES 2.0 中 100 x 100 方格的 2D 网格

> ID：14386850
> 
> 赞同：0
> 
> 时间：2013-01-17T19:44:12.520
> 
> 标签：ios, 2d, opengl-es-2.0

我想显示一个 100 x 100 正方形的 2D 网格。每个正方形的大小为 10 像素宽并用颜色填充。任何方块的颜色都可能随时更新。

我是 OpenGL 的新手，想知道是否需要为网格中的每个正方形定义顶点，还是有其他方法？我想直接使用 OpenGL 而不是像 Cocos2D 这样的框架来完成这个简单的任务。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T10:54:20.730

您可能只需将正方形的位置渲染为大小为 10 的点即可。GL_POINT 始终是一组像素宽和高，因此您的正方形始终保持 10 像素。如果将正方形渲染为四边形，则必须确保它们与相机的正确距离为 10 像素宽和高（纵横比也可能会影响它）。

# c - C - 检查当前可用的空闲 RAM？

> ID：14386856
> 
> 赞同：10
> 
> 时间：2013-01-17T19:44:23.513
> 
> 标签：c, memory-management, memory-leaks, malloc, c99

我知道如何使用`malloc()`和`free()`分配内存，但是还有一个标准的 C 函数来检查剩余多少内存，所以我可以定期调用它来确保我的代码没有内存泄漏？

我唯一能想到的就是`malloc(1)`在无限循环中调用，直到它返回错误，但不应该有更有效的方法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-17T19:47:43.867

不，没有标准的 C 函数可以做到这一点。您可以使用一些特定于平台的函数来执行某些类型的查询（如工作集大小），但这些可能不会有帮助，因为有时已正确`free()`d 的内存仍被认为是由操作系统分配的，因为该`malloc`实现可能会将释放的内存保留在池中。

如果您想检查内存泄漏，我强烈建议您使用[Valgrind](http://valgrind.org/)之类的工具，它可以在各种虚拟机中运行您的程序，并且可以跟踪内存泄漏以及其他功能。

如果您在 Windows 上运行，则可以使用[`_CrtDbgReport`](http://msdn.microsoft.com/en-us/library/8hyw4sy7%28v=vs.80%29.aspx)和/或[`_CrtSetDbgFlag`](http://msdn.microsoft.com/en-us/library/5at7yxcs%28v=vs.80%29.aspx)检查内存泄漏。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-18T09:23:14.593

如果在您的系统中`malloc()`总是分配物理内存，您可以`malloc()`重复调用大小不是 1 而是连续 2 的幂。这样会更有效率。下面是一个如何做到这一点的例子。

另一方面，如果`malloc()`只分配虚拟地址空间而不将物理内存映射到其中，那么这不会给你想要的东西。

示例代码：

```
#include <stdio.h>
#include <stdlib.h>

void* AllocateLargestFreeBlock(size_t* Size)
{
  size_t s0, s1;
  void* p;

  s0 = ~(size_t)0 ^ (~(size_t)0 >> 1);

  while (s0 && (p = malloc(s0)) == NULL)
    s0 >>= 1;

  if (p)
    free(p);

  s1 = s0 >> 1;

  while (s1)
  {
    if ((p = malloc(s0 + s1)) != NULL)
    {
      s0 += s1;
      free(p);
    }
    s1 >>= 1;
  }

  while (s0 && (p = malloc(s0)) == NULL)
    s0 ^= s0 & -s0;

  *Size = s0;
  return p;
}

size_t GetFreeSize(void)
{
  size_t total = 0;
  void* pFirst = NULL;
  void* pLast = NULL;

  for (;;)
  {
    size_t largest;
    void* p = AllocateLargestFreeBlock(&largest);

    if (largest < sizeof(void*))
    {
      if (p != NULL)
        free(p);
      break;
    }

    *(void**)p = NULL;

    total += largest;

    if (pFirst == NULL)
      pFirst = p;

    if (pLast != NULL)
      *(void**)pLast = p;

    pLast = p;
  }

  while (pFirst != NULL)
  {
    void* p = *(void**)pFirst;
    free(pFirst);
    pFirst = p;
  }

  return total;
}

int main(void)
{
  printf("Total free: %zu\n", GetFreeSize());
  printf("Total free: %zu\n", GetFreeSize());
  printf("Total free: %zu\n", GetFreeSize());
  printf("Total free: %zu\n", GetFreeSize());
  printf("Total free: %zu\n", GetFreeSize());
  return 0;
} 
```

输出（[ideone](http://ideone.com/V6HUfF)）：

```
Total free: 266677120
Total free: 266673024
Total free: 266673024
Total free: 266673024
Total free: 266673024 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-08-26T13:48:33.243

**Linux glibc`sysconf(_SC_AVPHYS_PAGES)`和`get_avphys_pages()`**

这两个 glibc 扩展应该为您提供可用的页数。然后我们可以将它乘以页面大小`sysconf(_SC_PAGESIZE)`来找到总可用内存。

主程序

```
#define _GNU_SOURCE
#include <stdio.h>
#include <sys/sysinfo.h>
#include <unistd.h>

int main(void) {
    /* PAGESIZE is POSIX: http://pubs.opengroup.org/onlinepubs/9699919799/
     * but PHYS_PAGES and AVPHYS_PAGES are glibc extensions. I bet those are
     * parsed from /proc/meminfo. */
    printf(
        "sysconf(_SC_PHYS_PAGES) * sysconf(_SC_PAGESIZE) = 0x%lX\n",
        sysconf(_SC_PHYS_PAGES) * sysconf(_SC_PAGESIZE)
    );
    printf(
        "sysconf(_SC_AVPHYS_PAGES) * sysconf(_SC_PAGESIZE) = 0x%lX\n",
        sysconf(_SC_AVPHYS_PAGES) * sysconf(_SC_PAGESIZE)
    );

    /* glibc extensions. man says they are parsed from /proc/meminfo. */
    printf(
        "get_phys_pages() * sysconf(_SC_PAGESIZE) = 0x%lX\n",
        get_phys_pages() * sysconf(_SC_PAGESIZE)
    );
    printf(
        "get_avphys_pages() * sysconf(_SC_PAGESIZE) = 0x%lX\n",
        get_avphys_pages() * sysconf(_SC_PAGESIZE)
    );
} 
```

[GitHub 上游](https://github.com/cirosantilli/linux-kernel-module-cheat/blob/efc4205416efa88912620959311cbfb92f40b4e8/userland/linux/total_memory.c).

编译并运行：

```
gcc -ggdb3 -O0 -std=c99 -Wall -Wextra -pedantic -o main.out main.c
./main.out 
```

我的 32GiB RAM 系统上的示例输出：

```
sysconf(_SC_PHYS_PAGES) * sysconf(_SC_PAGESIZE) = 0x7CCFFC000
sysconf(_SC_AVPHYS_PAGES) * sysconf(_SC_PAGESIZE) = 0x6383FD000
get_phys_pages() * sysconf(_SC_PAGESIZE) = 0x7CCFFC000
get_avphys_pages() * sysconf(_SC_PAGESIZE) = 0x6383FD000 
```

0x7CCFFC000 比 32GiB 小一点，是总 RAM。0x6383FD000 是可用的。

`man get_avphys_pages`说它从`/proc/meminfo`.

在 Ubuntu 19.04 中测试。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-17T20:34:14.270

如果您负担得起#ifdef'ing 调试版本（可能在模拟器中！），您可以构建一个 malloc/free 的调试版本来跟踪当前使用的字节数，并定期“打印”它（再次- 仅在调试版本中，可能在模拟器下）在您用于调试的任何输出设备（LED？）上，看看它是否不断增加。

标准技巧是分配 sizeof(size_t) 比请求更多，从而将大小与新分配的内存一起存储 - 但如果你正在编写固件，我想你已经知道了:)

所以……你有模拟器吗？

编辑：我已经习惯了在 GHz 上运行的计算机，一开始我并没有想到，但当然你可以做的另一件事是只计算分配的数量，而不是它们的大小——我无法想象这怎么可能需要太多的内存才能运行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-12-23T20:56:37.423

我搜索并找到了这个问题，以帮助我制作一个应用程序来动画跨多个复杂值数组的分形函数的多次迭代。

谢谢你，Alexey Frunze，你的 ideone.c 代码。这当然很有帮助。

基于我所学到的，希望对您有所帮助，我写了以下内容：

```
/* File: count-free-blocks.c
 *
 * Revision: 2018-24-12
 * 
 * Copyright (C) Randall Sawyer
 * <https://stackoverflow.com/users/341214/randall-sawyer>
 */

#include <stdarg.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>

size_t  available_blocks (size_t      block_sz);
size_t  largest_n_blocks (size_t      block_sz);
size_t  try_alloc        (size_t      n_blocks,
                          size_t      block_sz);
void    report           (int         indent,
                          const char *format,
                          ...);

int main (int argc, const char **argv)
{
  size_t  n_blocks,
          block_sz = 0;

  if (argc > 1 && sscanf (argv[1], "%zu", &block_sz) != 1)
    report (0, "Argument `%s' is not a valid block size.", argv[1]);

  if (block_sz == 0)
  {
    report (0, "Using 1 byte block size...");
    block_sz = 1;
  }

  n_blocks = available_blocks (block_sz);

  report (0, "Available memory: %zu blocks of %zu bytes == %zu bytes",
          n_blocks, block_sz, n_blocks * block_sz);

  return 0;
}

size_t
available_blocks (size_t block_sz)
{
  size_t  n_blocks[2];

  report (0, "calculating free memory...");

  /* Calculate maximum number of blocks of given size which can be
   * repeatedly allocated.
   */
  do {

    for ( n_blocks[0] = largest_n_blocks (block_sz);
         (n_blocks[1] = largest_n_blocks (block_sz)) < n_blocks[0];
          n_blocks[0] = n_blocks[1] );

    report (1, "check once more...");

  } while (try_alloc (n_blocks[0], block_sz) != n_blocks[0]);

  return n_blocks[0];
}

size_t
largest_n_blocks (size_t block_sz)
{
  static
  const char *f  = "phase %d";
  size_t      n_blocks, max, bit;

  report (1, "calculating largest number of free blocks...");

  /* Phase 1:
   * 
   * Find greatest allocatable number-of-blocks such that
   * it has only one bit set at '1' and '0' for the rest.
   */
  report (2, f, 1);

  n_blocks = ~(UINTPTR_MAX >> 1);     // only MSB is set
  max      = UINTPTR_MAX / block_sz;  // maximimum number of blocks

  while (n_blocks && !(n_blocks & max))
    n_blocks >>= 1;

  while (try_alloc (n_blocks, block_sz) != n_blocks)
    n_blocks >>= 1;

  /* Phase 2:
   * 
   * Starting with first allocatable number-of-blocks, add decreasingly
   * significant bits to this value for each successful allocation.
   */
  report (2, f, 2);

  for ( bit = n_blocks >> 1; bit; bit >>= 1)
  {
    size_t  n = n_blocks | bit;

    if (try_alloc (n, block_sz) == n)
      n_blocks = n;
  }

  /* Phase 3:
   * For as long as allocation cannot be repeated,
   * decrease number of blocks.
   */
  report (2, f, 3);

  while (try_alloc (n_blocks, block_sz) != n_blocks)
    --n_blocks;

  report (1, "free blocks: %zu", n_blocks);

  return n_blocks;
}

size_t
try_alloc  (size_t  n_blocks,
            size_t  block_sz)
{
  if (n_blocks != 0)
  {
    /* Try to allocate all of the requested blocks.
     * If successful, return number of requested blocks;
     * otherwise, return 0.
     */
    void *p = calloc (n_blocks, block_sz);

    report (3, "try %zu blocks of %zu bytes: %s",
            n_blocks, block_sz, p ? "success" : "failure");

    if (p)
    {
      free (p);
      return n_blocks;
    }
  }

  return 0;
}

#define MAX_INDENT    8
#define INDENT_SPACES "        "

void
report (int         indent,
        const char *format,
        ...)
{
  const char  padding[MAX_INDENT+1] = INDENT_SPACES;
  va_list     args;

  if (indent > MAX_INDENT)
    indent = MAX_INDENT;

  if (indent > 0)
    printf ("%s", &padding[8-indent]);

  va_start (args, format);
  vprintf (format, args);
  va_end (args);

  printf ("\n");
} 
```

用法：

> 无计数块 [ *BLOCK_SIZE* ]

输入：

```
> ./count-free-blocks 33554432 
```

输出：

```
calculating free memory...
 calculating largest number of free blocks...
  phase 1
   try 64 blocks of 33554432 bytes: success
  phase 2
   try 96 blocks of 33554432 bytes: failure
   try 80 blocks of 33554432 bytes: success
   try 88 blocks of 33554432 bytes: success
   try 92 blocks of 33554432 bytes: failure
   try 90 blocks of 33554432 bytes: success
   try 91 blocks of 33554432 bytes: success
  phase 3
   try 91 blocks of 33554432 bytes: success
 free blocks: 91
 calculating largest number of free blocks...
  phase 1
   try 64 blocks of 33554432 bytes: success
  phase 2
   try 96 blocks of 33554432 bytes: failure
   try 80 blocks of 33554432 bytes: success
   try 88 blocks of 33554432 bytes: success
   try 92 blocks of 33554432 bytes: failure
   try 90 blocks of 33554432 bytes: success
   try 91 blocks of 33554432 bytes: success
  phase 3
   try 91 blocks of 33554432 bytes: success
 free blocks: 91
 check once more...
   try 91 blocks of 33554432 bytes: success
Available memory: 91 blocks of 33554432 bytes == 3053453312 bytes 
```

我打算将这些功能重新用于我自己的应用程序。

# node.js - Node js 中缺少 node_events.{h,cc} 导致旧包的构建问题

> ID：14386857
> 
> 赞同：1
> 
> 时间：2013-01-17T19:44:25.267
> 
> 标签：node.js

我正在试验 r-node，一个依赖 Node js 的包。软件包本身有点过时，依赖于 node_events，这是 2010 年代中期的一个旧文件。在构建阶段，它抱怨以下内容：

```
src/binding.cc:24:10: fatal error: 'node_events.h' file not found
#include <node_events.h>
         ^
1 error generated.
make[1]: *** [src/binding.o] Error 1
make: *** [server] Error 2 
```

node_events 大约在 2 年前从 Node js 中删除：[https ://github.com/joyent/node/commit/4ef8f06fe62edb74fded0e817266cb6398e69f36#src/node_events.h](https://github.com/joyent/node/commit/4ef8f06fe62edb74fded0e817266cb6398e69f36#src/node_events.h)

我想知道背景是什么——为什么节点 js 的人删除了这个特定的文件，以及包编写者如何更新他们的结尾以跟上这个。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T20:57:46.967

据我所知，node.js 源代码存在时 node_events.{h,cc} 该平台使用了一个用 C 编写的发射器：

```
var EventEmitter = exports.EventEmitter = process.EventEmitter 
```

但他们意识到直接从 javascript 代码创建事件发射器会更好：

```
var EventEmitter = NativeModule.require('events').EventEmitter; 
```

库/events.js：

```
function EventEmitter() {
      this.domain = null;
      if (exports.usingDomains) {
        // if there is an active domain, then attach to it.
        domain = domain || require('domain');
        if (domain.active && !(this instanceof domain.Domain)) {
          this.domain = domain.active;
        }
      }
      this._events = this._events || null;
      this._maxListeners = this._maxListeners || defaultMaxListeners;
    }
    exports.EventEmitter = EventEmitter; 
```

因此，如果您使用的包使用旧的事件发射器，只需从您想要更新并重新编译的源中*删除*包含（以及所有 deps）。`#include <node_events.h>`

# javascript - 在 JavaScript 中使用 RegEx 进行拆分

> ID：14386860
> 
> 赞同：5
> 
> 时间：2013-01-17T19:44:46.807
> 
> 标签：javascript, regex, string, split

假设我有一个通用字符串

```
"...&<constant_word>+<random_words_with_random_length>&...&...&..." 
```

我想使用分割字符串

```
"<constant_word>+<random_words_with_random_length>&" 
```

为此，我尝试了 RegEx 拆分，例如

```
<string>.split(/<constant_word>.*&/) 
```

不幸的是，这个正则表达式拆分到最后一个“&”，即

```
"<constant_word>+<random_words_with_random_length>&...&...&" 
```

如果我希望它在获得第一个“&”时拆分，那么 RegEx 代码会是什么？

字符串拆分示例

```
"example&ABC56748393&this&is&a&sample&string".split(/ABC.*&/) 
```

给我

```
["example&","string"] 
```

而我想要的是..

```
["example&","this&is&a&sample&string"] 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-17T19:45:38.163

你可以用问号改变*贪心*`?`：

```
"example&ABC56748393&this&is&a&sample&string".split(/&ABC.*?&/);
// ["example", "this&is&a&sample&string"] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-17T19:46:57.020

只需使用非贪婪匹配，在or`?`之后放置一个：`*``+`

```
<string>.split(/<constant_word>.*?&/) 
```

# javascript - 如何将 Javascript/HTML 表单数据输入订单确认电子邮件

> ID：14386861
> 
> 赞同：0
> 
> 时间：2013-01-17T19:44:51.287
> 
> 标签：javascript, html, cgi

我使用 JavaScript 和 HTML 创建了一个表单。目前，我单击提交，表单上的数据被拉出并显示在页面底部文本区域的文本字符串中。提交按钮会在新窗口中打开一封电子邮件。我需要将两者结合起来，然后将 textarea 中的数据拉到电子邮件中，在新窗口中的内容区域中，这样一旦提交，电子邮件就会显示表单数据。任何人都可以帮忙吗？

```
<html>
<head>

<title>Reservation form</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script type="text/javascript">

function open_win() 
{
window.open("email response.html");
}
<!--

// This is the check script

function checkit()
{
    // In textstring I gather the data that are finally written to the textarea.

    var textstring = '';

    // First of all, have all the text boxes been filled in?
    // This part is treated in the normal page.
    // I put all boxes and their values in textstring

    for (i=0;i<4;i++) {
        var box = document.forms['example'].elements[i];
        if (!box.value) {
            alert('You haven\'t filled in ' + box.name + '!');
            box.focus()
            return;
        }
        textstring += box.name + ': ' + box.value + '\n';
    }

    // Get value of the 'Car' select box.

    user_input = document.example.refer1.options[document.example.refer1.selectedIndex].value;
    textstring += '1st Car: ' + user_input + '\n';

        user_input = document.example.refer2.options[document.example.refer2.selectedIndex].value;
    textstring += '2nd Car: ' + user_input + '\n';

            user_input = document.example.refer3.options[document.example.refer3.selectedIndex].value;
    textstring += '3rd Car: ' + user_input + '\n';
        // Get value of the 'When' radio buttons.

    user_input = '';
    for (i=0;i<document.forms['example'].when.length;i++) {
        if (document.forms['example'].when[i].checked) {
            user_input = document.forms['example'].when[i].value;
        }
    }
    textstring += 'When: ' + user_input + '\n';

            // Get value of the 'Fee' radio buttons.

    user_input = '';
    for (i=0;i<document.forms['example'].fee.length;i++) {
        if (document.forms['example'].fee[i].checked) {
            user_input = document.forms['example'].fee[i].value;
        }
    }
    textstring += 'Fee: £' + (user_input*5) + '\n';

    // Write textstring to the textarea.

    document.forms['example'].output.value = ("\n*** Thank You for your reservation***"+"\n")+ textstring + ("\n*** End of Form***"+"\n");

}
// -->
</script>
</head>
<body>

<h2>Reservation form</h2>

<div id="header"></div>
<p class="intro">&nbsp;</p>

<form name="example" action="#" onSubmit="checkit(); return false">
  <div align="center">
    <table class="form">
      <tr>
        <td colspan="3"><div align="left">
          <p><u><strong> Personal Details</strong></u>        </p>
        </div></td>
      </tr>
      <tr>
        <td width="125" height="25">&nbsp;</td>
        <td width="315"><div align="left">Name</div></td>
        <td width="187"><p>
          <input name="Name" />
        </p></td>
      </tr>

      <tr>
        <td>&nbsp;</td>
        <td><div align="left">Telephone</div></td>
        <td><p>
          <input name="Telephone" />
        </p></td>
      </tr>

      <tr>
        <td>&nbsp;</td>
        <td><div align="left">Mobile</div></td>
        <td><p>
          <input name="Mobile" />
        </p></td>
      </tr>

      <tr>
        <td>&nbsp;</td>
        <td><div align="left">E-mail</div></td>
        <td><p>
          <input name="E-mail" />
        </p></td>
      </tr>

      <tr>
        <td>&nbsp;</td>
        <td>How did you want to learn About us?</td>
        <td><p>&nbsp;
            </p>
          <p>
            <input type="checkbox" name="Television" />
            Television<br />
          <input type="checkbox" name="Radio" />Radio<br />
          <input type="checkbox" name="Word of mouth" />Word of mouth<br />
        <input type="checkbox" name="Other" />Other</p></td>
      </tr>

      <tr>
        <td colspan="5"><div align="left">
          <p><u><strong>Reservation Details</strong></u>        </p>
        </div></td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>Option 1</td>
        <td>Option 2</td>
        <td>Option 3</td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td height="56"><p>Please Choose a Car you want to Reserve?</p>
        <h5>(You can only Reserve Max 3 Cars per visit)</h5></td>
        <td><select name="refer1">
          <option value='' selected="selected">--- Select ---</option>
          <option value="Ford Fiesta 1.6">Ford Fiesta 1.6</option>
          <option value="Ford Fiesta 1.4">Ford Fiesta 1.4</option>
          <option value="Ford KA 1.3">Ford KA 1.3</option>
          <option value="Nissan Micra 1.1">Nissan Micra 1.1</option>
          <option value="Nissan Micra 1.2">Nissan Micra 1.2</option>
          <option value="Nissan Micra 1.0">Nissan Micra 1.0</option>
          <option value="Peugeot 206 1.1">Peugeot 206 1.1</option>
          <option value="Peugeot 206 1.4">Peugeot 206 1.4</option>
          <option value="Peugeot 106 1.1">Peugeot 106 1.1</option>
          <option value="Renault Clio 1.1">Renault Clio 1.1</option>
          <option value="Renault Clio 1.4">Renault Clio 1.4</option>
          <option value="Renault Clio 1.2">Renault Clio 1.2</option>
          <option value="Toyota Aygo 1.0">Toyota Aygo 1.0</option>
          <option value="Toyota IQ 1.0">Toyota IQ 1.0</option>
          <option value="Toyota Yaris 1.3">Toyota Yaris 1.3</option>
          <option value="Vauxhall Corsa 1.2">Vauxhall Corsa 1.2</option>
          <option value="Vauxhall Corsa 1.4">Vauxhall Corsa 1.4</option>
          <option value="Vauxhall Corsa 1.0">Vauxhall Corsa 1.0</option>
          </select>
        </td>
        <td width="176"><select name="refer2">
          <option value='' selected="selected">--- Select ---</option>
          <option value="Ford Fiesta 1.6">Ford Fiesta 1.6</option>
          <option value="Ford Fiesta 1.4">Ford Fiesta 1.4</option>
          <option value="Ford KA 1.3">Ford KA 1.3</option>
          <option value="Nissan Micra 1.1">Nissan Micra 1.1</option>
          <option value="Nissan Micra 1.2">Nissan Micra 1.2</option>
          <option value="Nissan Micra 1.0">Nissan Micra 1.0</option>
          <option value="Peugeot 206 1.1">Peugeot 206 1.1</option>
          <option value="Peugeot 206 1.4">Peugeot 206 1.4</option>
          <option value="Peugeot 106 1.1">Peugeot 106 1.1</option>
          <option value="Renault Clio 1.1">Renault Clio 1.1</option>
          <option value="Renault Clio 1.4">Renault Clio 1.4</option>
          <option value="Renault Clio 1.2">Renault Clio 1.2</option>
          <option value="Toyota Aygo 1.0">Toyota Aygo 1.0</option>
          <option value="Toyota IQ 1.0">Toyota IQ 1.0</option>
          <option value="Toyota Yaris 1.3">Toyota Yaris 1.3</option>
          <option value="Vauxhall Corsa 1.2">Vauxhall Corsa 1.2</option>
          <option value="Vauxhall Corsa 1.4">Vauxhall Corsa 1.4</option>
          <option value="Vauxhall Corsa 1.0">Vauxhall Corsa 1.0</option>
          </select>
        </td>
        <td width="195"><select name="refer3">
          <option value='' selected="selected">--- Select ---</option>
          <option value="Ford Fiesta 1.6">Ford Fiesta 1.6</option>
          <option value="Ford Fiesta 1.4">Ford Fiesta 1.4</option>
          <option value="Ford KA 1.3">Ford KA 1.3</option>
          <option value="Nissan Micra 1.1">Nissan Micra 1.1</option>
          <option value="Nissan Micra 1.2">Nissan Micra 1.2</option>
          <option value="Nissan Micra 1.0">Nissan Micra 1.0</option>
          <option value="Peugeot 206 1.1">Peugeot 206 1.1</option>
          <option value="Peugeot 206 1.4">Peugeot 206 1.4</option>
          <option value="Peugeot 106 1.1">Peugeot 106 1.1</option>
          <option value="Renault Clio 1.1">Renault Clio 1.1</option>
          <option value="Renault Clio 1.4">Renault Clio 1.4</option>
          <option value="Renault Clio 1.2">Renault Clio 1.2</option>
          <option value="Toyota Aygo 1.0">Toyota Aygo 1.0</option>
          <option value="Toyota IQ 1.0">Toyota IQ 1.0</option>
          <option value="Toyota Yaris 1.3">Toyota Yaris 1.3</option>
          <option value="Vauxhall Corsa 1.2">Vauxhall Corsa 1.2</option>
          <option value="Vauxhall Corsa 1.4">Vauxhall Corsa 1.4</option>
          <option value="Vauxhall Corsa 1.0">Vauxhall Corsa 1.0</option>
          </select>
      </td></tr>
            <tr>
        <td>&nbsp;</td>
        <td><p>Please confirm the number of cars you have reserved:</p><p><h5>(Please note there is a &#163;5 reservation fee per car. This charge needs to be paid on arrival of visit. This will be deducted from the price of the car if purchased.)</h5></p>
        </td>
        <td><br />

          <p>
          <input type="radio" name="fee" value="1" />1<br />
          <input type="radio" name="fee" value="2" />2<br />
        <input type="radio" name="fee" value="3" />3</p></td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td><p>What day would you like to come and visit the car?</p>
        <h5>(You can visit the car any time of your cosen day please contact us for more infomation.)</h5></td>
        <td><p>
          <input type="radio" name="when" value="MONDAY" />
          MONDAY<br />
          <input type="radio" name="when" value="TUESDAY" />
          TUESDAY
          <br />
          <input type="radio" name="when" value="WEDNESDAY" />
          WEDNESDAY
          <br />
          <input type="radio" name="when" value="THURSDAY" /> 
          THURSDAY
          <br />
          <input type="radio" name="when" value="FRIDAY" />
          FRIDAY<br />
          <input type="radio" name="when" value="SATURDAY-SUNDAY" />
      SATURDAY-SUNDAY</p></td></tr>
      <tr><td colspan="3"><div align="center">
           <input type="submit" value="Submit form" onclick="open_win()"/>
        <br />
        <input type="reset" />
      </div></td></tr>
      <tr><td colspan="3"><div align="right">
        <textarea cols="45" rows="8" name="output">When you hit 'Submit' the user input will be written to this textarea</textarea>
      </div></td></tr>
    </table>
  </div>
</form>
</body
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T20:27:27.240

要使用 jQuery 访问新窗口中的内容，请将**jquery.js**添加到您的**电子邮件 response.html**中。

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script> 
```

然后，您可以从“第一”页直接访问它：

```
// create new window from html file
var emailWnd = window.open("email response.html");

// in general to copy html to the new window
emailWnd.document.$('body').html(" ... some programmaticaly created elements ... ");

// or for example to copy text from an input element to an element in the new window
emailWnd.document.$('#somewhere').text($('input[name="Mobile"]').text()); 
```

参考类似问题： [Using JQuery to Access a New Window's DOM](https://stackoverflow.com/questions/7788480/using-jquery-to-access-a-new-windows-dom)

# c# - 带有列表框的 foreach 上的奇怪问题

> ID：14386865
> 
> 赞同：1
> 
> 时间：2013-01-17T19:45:04.123
> 
> 标签：c#, winforms, combobox, listbox

我正在尝试从列表框元素填充组合框。

这是代码：

```
foreach(string elements in (Application.OpenForms[1] as Impostazioni).listBox1)
        {
            cbxValuta.Items.Add(elements);
        } 
```

但我从 Visual Studio 2012 收到此错误：

> 错误 1 ​​foreach 语句无法对“System.Windows.Forms.ListBox”类型的变量进行操作，因为“System.Windows.Forms.ListBox”不包含“GetEnumerator”的公共定义

我不知道如何解决这个错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-17T19:47:55.630

如果要遍历 ListBox 元素，则必须使用[Items](http://msdn.microsoft.com/en-us/library/system.windows.forms.listbox.items.aspx)属性。

试试这个：

```
foreach(string elements in (Application.OpenForms[1] as Impostazioni).listBox1.Items)
{
    cbxValuta.Items.Add(elements);
} 
```

错误：

> 但现在我得到这个错误：索引超出范围。必须是非负数且小于集合的大小。参数名称：索引

首先，您必须检查 Application.OpenForms 是否不为空且不为空。

因此，在 foreach 之前，您必须添加以下代码行：

如果 Application.OpenForms 是列表：

```
if(Application.OpenForms != null && Application.OpenForms.Count != 0) 
```

如果 Application.OpenForms 是数组：

```
if(Application.OpenForms != null && Application.OpenForms.Length != 0) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T19:48:31.527

检查是否`listBox1`有`.Items`可以枚举的属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-17T19:48:25.287

如果你想[`foreach`](http://msdn.microsoft.com/en-us/library/vstudio/ttw7t8t6.aspx)在你的代码中使用，你的类应该实现[`IEnumerable`](http://msdn.microsoft.com/en-us/library/system.collections.ienumerable.aspx)或[`IEnumerable<T>`](http://msdn.microsoft.com/en-us/library/9eekhta0.aspx)接口。

`.Items`用属性试试。像;

```
(Application.OpenForms[1] as Impostazioni).listBox1.Items 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-17T19:53:04.227

您需要从 listbox1 获取“Items”集合，而不是使用整个列表框。

```
foreach(string elements in (Application.OpenForms[1] as Impostazioni).listBox1.Items)
    {
        cbxValuta.Items.Add(elements);
    } 
```

# android - GridView 图像下载

> ID：14386870
> 
> 赞同：0
> 
> 时间：2013-01-17T19:45:09.990
> 
> 标签：gridview, android, gridview

我正在创建一个[gridview](/questions/tagged/gridview "显示标记为“gridview”的问题")活动，它像 android 开发人员中的示例一样异步下载图像。当某些图像没有正确下载时，由于互联网连接速度慢，我有一个刷新按钮，它只下载这些图像，而不是从一开始就下载所有图像。问题是如何将这些图像绑定到它们在网格视图中的独特图像视图？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T20:04:52.650

覆盖`getItem(int)`适配器的方法，并使用它来获取 ImageView。

```
public Object getItem(int position) {
     return myCollection[position];
}

public void update(Drawable draw, int position) {
     ImageView view = (ImageView) mAdapter.getItem(position);
     view.setImageDrawable(draw);
     mAdapter.notifyDataSetChanged();
} 
```

# asp.net - asp.net 登录重定向到错误的页面

> ID：14386877
> 
> 赞同：0
> 
> 时间：2013-01-17T19:45:14.720
> 
> 标签：asp.net, asp.net-membership, login-control

我们有一个带有会员区的 asp.net 站点。所有者想用新的外观更新网站的公共部分，所以我创建了一个新的登录页面，使用新的外观，但代码相同。将该页面与原始 login.aspx 放在同一目录中，但将其命名为 new_login.aspx。测试了新页面，它可以在我的开发计算机上运行，​​但是在其他计算机上测试时会将用户重定向到一个不存在的页面。

两页上的代码如下。

```
 Protected Sub LoginButton_Click(ByVal sender As Object, ByVal e As System.EventArgs)
        Dim sUser As String = Me.New_Login.UserName
        If Roles.IsUserInRole(sUser, "Administrator") Then
            Response.Redirect("~/Manager/AMSEmployees.aspx")
        ElseIf Roles.IsUserInRole(sUser, "Manager") Then
            Response.Redirect("~/Manager/AMSEmployees.aspx")
        ElseIf Roles.IsUserInRole(sUser, "Employee") Then
            Response.Redirect("~/AMSEmployee/AMSContacts.aspx")
        ElseIf Roles.IsUserInRole(sUser, "Contact") Then
            Response.Redirect("~/Customer/OrderEntry.aspx")
        End If
    End Sub 
```

在原始页面上，它正确地将联系人重定向到[http://www.xxxxx.com/Customer/OrderEntry.aspx](http://www.xxxxx.com/Customer/OrderEntry.aspx)。在新页面上，重定向转到[http://www.xxxxx/login.aspx?ReturnUrl=%2fCustomer%2fOrderEntry.aspx](http://www.xxxxx/login.aspx?ReturnUrl=%2fCustomer%2fOrderEntry.aspx)。我把客户的域名换成了xxxxxx。

我无法弄清楚为什么这两个页面的行为不同。站点的根级别没有登录页面。任何帮助，将不胜感激。

**一个新的问题。**我在 web.coconfig 身份验证节点中显式添加了登录页面。这有所帮助，但并没有完全解决问题。现在，当我们进入登录页面并输入一组有效凭据时，我会收到一条找不到页面的消息。如果我随后使用相同的凭据再次登录，则登录成功并继续工作，直到浏览器关闭，即使我注销然后重新登录也是如此。我可以在几台不同计算机的浏览器和不同的浏览器中复制这种行为。我不能在我的开发服务器上复制它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T19:52:10.940

它与 Web 应用程序在 IIS 中托管的位置有什么关系吗？将其托管为网站与将其托管为网站内的 web 应用程序可能会给您不同的运行时结果。

具体来说：尝试查看具有相对 url 的 Response.Redirect（以“~/”开头的 aspx 路径。我觉得这两件事是相关的（两件事是它的托管方式和这个 aspx 路径）。

# c# - 从运行时确定的数字生成 ListView 项目，而不是从 DataSource

> ID：14386879
> 
> 赞同：0
> 
> 时间：2013-01-17T19:45:19.337
> 
> 标签：c#, asp.net, listview, web-applications, webforms

我试图让`ListView`控件显示用户喜欢的尽可能多的表单，具体取决于用户单击“ `Add`”按钮的次数。基本上，我*不想*将 绑定`ListView`到 a `DataSource`，而是以`ItemTemplate`编程方式添加 1、5、13 或我喜欢的多次。出于测试目的，假设我想将 13 个表单添加到`ListView`. 有没有办法做到这一点？顺便说一句，我正在使用`System.Web.UI.WebControls.ListView`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T20:47:41.520

列表显示：

```
<asp:ListView ID="ListView1" runat="server" >
    <ItemTemplate><br /><%# Eval("Value") %></ItemTemplate>
</asp:ListView> 
```

后面的代码：

```
 var dt = new DataTable();
    dt.Columns.Add("Value", typeof(string));
    var row = dt.NewRow();
    row["Value"] = "first record";
    dt.Rows.Add(row);
    row = dt.NewRow();
    row["Value"] = "second record";
    dt.Rows.Add(row);
    //other records if needed
    ListView1.DataSource = dt;
    ListView1.DataBind(); 
```

您还可以使用对象列表而不是 DataTable。

# sql - 在 Oracle 中使用 IF ELSE

> ID：14386881
> 
> 赞同：10
> 
> 时间：2013-01-17T19:45:19.897
> 
> 标签：sql, oracle, toad

作为一名网络开发人员，我知道如何在多种语言中使用 IF ELSE。但是，我正在学习如何使用 TOAD for Oracle 编写报告。

我的问题是，如何正确添加 IF ELSE 语句？

这就是我正在尝试做的事情。错误是：命令未正确结束。

（VIKKIE to ICKY 已经被我的主管交给我帮助我学习了）

```
SELECT DISTINCT a.item, b.salesman, NVL(a.manufacturer,'Not Set')Manufacturer

FROM inv_items a, arv_sales b
WHERE   a.co = '100'
      AND a.co = b.co
      AND A.ITEM_KEY = b.item_key   
--AND item IN ('BX4C', 'BX8C', 'BX866') --AND salesman ='15'
AND a.item LIKE 'BX%'
AND b.salesman in ('01','15')
AND trans_date BETWEEN to_date('010113','mmddrr')
                         and to_date('011713','mmddrr')

GROUP BY a.item, b.salesman, a.manufacturer
ORDER BY a.item

IF  b.salesman = 'VIKKIE' THEN
a.salesman := 'ICKY';
END IF; 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-01-17T19:53:17.683

`IF`是一个 PL/SQL 结构。如果您正在执行查询，则您使用的是 SQL 而不是 PL/SQL。

在 SQL 中，您可以`CASE`在查询本身中使用语句

```
SELECT DISTINCT a.item, 
                (CASE WHEN b.salesman = 'VIKKIE'
                      THEN 'ICKY'
                      ELSE b.salesman
                  END), 
                NVL(a.manufacturer,'Not Set') Manufacturer
  FROM inv_items a, 
       arv_sales b
 WHERE  a.co = '100'
   AND a.co = b.co
   AND A.ITEM_KEY = b.item_key   
   AND a.item LIKE 'BX%'
   AND b.salesman in ('01','15')
   AND trans_date BETWEEN to_date('010113','mmddrr')
                      and to_date('011713','mmddrr')
ORDER BY a.item 
```

由于您没有进行任何聚合，因此您不希望`GROUP BY`在查询中使用 a 。你真的确定你需要`DISTINCT`吗？人们经常在缺少连接条件时随意添加或添加它，而不是考虑是否真的有必要做额外的工作来识别和删除重复项。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-17T20:14:31.660

您也可以使用`Decode`：

```
SELECT DISTINCT a.item, decode(b.salesman,'VIKKIE','ICKY',Else),NVL(a.manufacturer,'Not Set')Manufacturer
FROM inv_items a, arv_sales b
WHERE a.co = b.co
      AND A.ITEM_KEY = b.item_key
      AND a.co = '100'
AND a.item LIKE 'BX%'
AND b.salesman in ('01','15')
AND trans_date BETWEEN to_date('010113','mmddrr')
                         and to_date('011713','mmddrr')
GROUP BY a.item, b.salesman, a.manufacturer
ORDER BY a.item 
```

# jquery - 在 JQuery 中使用 foreach 解析 JSON

> ID：14386882
> 
> 赞同：0
> 
> 时间：2013-01-17T19:45:23.700
> 
> 标签：jquery

这是我现在用来通过 JQuery 执行 AJAX 的代码：

```
 $.ajax({
            type: "POST",
            url: linktopage,
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                $.each(data, function (index, item) {
                    alert(item.productId);
                });
            },
            error: function (xhr, status, error) {

            }
        }); 
```

其中**index = d**和**item = "[{"productId":5284598},{"productId":5790923}]"**但**alert(item.productId)**未定义，我如何访问每个 productId？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T19:48:40.953

在您的示例中，有一个项目数组。您必须对其进行迭代才能获得 productId。

```
for( var i = 0; i < item.length; i++ ){
 console.log(item[i].productId);
} 
```

*编辑*

您的数据可能仍然是一个字符串，在这种情况下，您可能希望使用

```
data = JSON.parse(data); 
```

在迭代之前。（更多关于解析：[https](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/JSON/parse) ://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/JSON/parse ）

像这样（你也可以先测试它是否是一个字符串）：

```
$.ajax({
        type: "POST",
        url: linktopage,
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: function (data) {
            if( typeof data == "string" )data = JSON.parse(data);
            $.each(data, function (index, item) {
                alert(item.productId);
            });
        },
        error: function (xhr, status, error) {

        }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T19:49:17.613

在您的情况下，数据是一个字符串条目。因此，您必须先将其解析为 JSON。将您的代码更新为此

```
$.ajax({
            type: "POST",
            url: linktopage,
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                var dta = $.parseJSON(data);
                $.each(dta , function (index, item) {
                    alert(item.productId);
                });
            },
            error: function (xhr, status, error) {

            }
        }); 
```

# backbone.js - Backbone Marionette 和 ICanHaz (Mustache) 模板配置

> ID：14386893
> 
> 赞同：1
> 
> 时间：2013-01-17T19:45:40.647
> 
> 标签：backbone.js, requirejs, marionette, mustache, icanhaz.js

我正在将 Backbone 基本应用程序迁移到 Marionette，并且我想使用[ICanHaz.js](http://icanhazjs.com/)作为模板系统（基于 Mustache）。
我正在使用 AMD 和 Require.js，而使 ICanHaz.js 与它和 Backbone 一起工作的唯一方法是使用 jvashishtha 的[版本](https://github.com/jvashishtha/ICanHaz.js)。

我首先以纯 Backbone 风格实现了该应用程序。
特别是，我曾经使用[Require.js 的文本插件](https://github.com/requirejs/text)将每个模板作为原始字符串加载，然后将模板添加到 ich 对象中。这将在 ich 对象中创建一个与加载的模板具有相同名称的方法：

```
define([ 
'jquery',
'underscore',
'backbone',
'iCanHaz',
'models/Job',
'text!templates/Job.html'

], function( $, _, Backbone, ich, Job, jobTemplate) {     
    var JobView = Backbone.View.extend({
        render: function () {
             /* since the render function will be called iterativetly  
                at the second cycle the method ich.jobRowTpl has been already defined
                so ich will throw an error because I'm trying to overwrite it.
                That is the meaning of the following if (SEE: https://github.com/HenrikJoreteg/ICanHaz.js/issues/44#issuecomment-4036580)
             */
            if (_.isUndefined(ich.jobRowTpl)){ 
                ich.addTemplate('jobRowTpl', jobTemplate);
            };

            this.el = ich.jobRowTpl(this.model.toJSON());
            return this;
        }
    });
    return JobView;

}); 
```

到现在为止还挺好。问题来自木偶。
之前的代码在 Backbone 版本中运行良好，但不需要在 Marionette 的视图中定义渲染函数。
Marionette 默认使用 UnderscoreJS 模板。其他人已经问[过如何将 Mustache 与 Marionette 一起使用](https://stackoverflow.com/questions/11084021/how-to-use-backbone-marionette-itemview-with-mustache)。
从那个答案我试图实施我的解决方案。在 app.js 中：

```
app.addInitializer(function(){

  //For using Marionette with ICH
  var templateName=''; //not sure if this would help, anyway it makes no difference
  Backbone.Marionette.Renderer.render = function(template, data){
    if (_.isUndefined(ich.template)){ 
          //this defines a new template in ich called templateName
          ich.addTemplate(templateName, template);
    };
    return ich.templateName(data);
  } 
```

但是控制台抛出了我：

```
Uncaught TypeError: Object #<Object> has no method 'templateName' 
```

所以模板还没有定义。无论如何，如果我的方向正确，有什么提示吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T08:19:56.453

我认为这只是渲染器函数中的 JS 的问题。

这一行：

返回 ich.templateName(data);

将寻找一个字面上称为“templateName”的模板

你想要什么，因为 templateName 是一个变量，类似于：

```
return ich[templateName](data); 
```

然后它将解释 templateName 变量的值。

# perl - 如何在 Perl 中插入具有特定数据类型的 mongoDB？

> ID：14386895
> 
> 赞同：1
> 
> 时间：2013-01-17T19:45:48.847
> 
> 标签：perl, mongodb

例如，在 MySQL 中，您有 varchar、int 等数据类型。我在 Google 上搜索并找到了[http://docs.mongodb.org/manual/core/document/#bson-types](http://docs.mongodb.org/manual/core/document/#bson-types)页面。似乎对于字符串，您只需使用 '' 或 ""。整数似乎可以在不指定类型的情况下自动识别。在 Perl 中将这样的东西插入到 mongoDB 集合中会是什么样子？

```
Example:
{
 "Name" : "John"
 "Age" :   20
 "Weight" : 180.5
 "Dateofbirth" : 01/01/1990
} 
```

我想要在数据库中指定数据类型的原因是我可以使用运算符来比较数字。如果是文本，我不能这样做。到目前为止，我在 Perl 中思考：

```
$my_collection->insert({
                        'Name' : "$Name",
                        'Age'  : $age,
                         'Weight':$weight,
                         'Dateofbirth': $datevar, 
                       } ); 
```

在上面的代码中，我不确定如何指定数据类型。例如告诉 Weight 是 Double 而不是整数或字符串。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T19:49:13.193

对于数字类型，Perl MongoDB 驱动程序将使用 Perl 认为的数字。Perl 有一个内部标志，用于跟踪某个东西是浮点数还是整数。MongoDB 驱动程序将使用 32 位或 64 位整数，具体取决于您的平台。如果它看起来像 Perl 的字符串，它将作为字符串存储在 MongoDB 中。

对于日期类型，您需要将日期包装在[DateTime](http://metacpan.org/module/DateTime)对象中，如果使用属性，则需要[DateTime::Tiny 。](http://metacpan.org/module/DateTime%3a%3aTiny)`dt_type`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-23T18:15:45.810

在 Perl MongoDB 驱动程序中使用 Looks_like_number 参数

使用 MongoDB::BSON $MongoDB::BSON::looks_like_number = 1;

[https://metacpan.org/pod/MongoDB::BSON#looks_like_number](https://metacpan.org/pod/MongoDB::BSON#looks_like_number)

# bash - 我需要知道这到底会做什么：（grep & xargs）

> ID：14386896
> 
> 赞同：-3
> 
> 时间：2013-01-17T19:45:58.230
> 
> 标签：bash, grep, xargs

这是行：

```
find /localdir/ | grep '[0-9']$ | xargs -i% cp % /tftpboot 
```

我特别想知道 grep 究竟在这里寻找什么。
谁能帮我翻译一下？

我也对 xargs cmd 的外观感兴趣...

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-17T19:49:26.413

`[0-9]``0`表示从到的任何字符`9`。 `$`表示一行的结束。因此，您`grep`将找到以数字结尾的任何行（即文件名），`xargs`并将它们分别复制到`/tftpboot`.

当然，如果这些文件名中的任何一个包含空格，您会感到惊讶。您可以完全在 zsh 的 shell 中执行此操作（我*认为*在最新版本的 bash 中）：

```
cp /localdir/**/*[0-9] /tftpboot 
```

* * *

附录：如果你问的是有趣的引用，那*会*起作用，尽管它不是很人性化。

关键是你可以在 shell 中将带引号的字符串和不带引号的字符串紧挨着放置，它们会变成一个字符串；`echo "fo"ob'ar'`会产生`foobar`.

引用第一部分是因为`[`对 bash 来说是特殊的。 `]`也很特别，但由于 bash 从未见过 special (unquoted) `[`，所以它只剩下一个了`]`。 `$`通常会替换一个变量，但它之后什么都没有，所以 bash 也不管它。

实际传递给 grep 的字符串仍然是`[0-9]$`.

# pandas - Pandas groupby 大小“计数”间歇性计数不足

> ID：14386897
> 
> 赞同：4
> 
> 时间：2013-01-17T19:46:05.060
> 
> 标签：pandas

为什么我得到不一致的组大小“计数”？
我正在使用 Pandas 10.0，将 600 万行数据集减少到 400k groupby：

```
In [16]: df.groupby('Z ID').size()[470009:470010]
Out[16]:
Z ID
994555          6

In [14]: df[df['Z ID'] == 994555].groupby('Z ID').size() 
Out[14]:
Z ID
994555          9 
```

*当我查看原始数据时，有 9 个项目。*

**编辑：原始数据** 完整的数据集是 600 万条记录。Pandas size() 对小家伙很有效。

```
 FilterDate           Z ID   AR Code AA Code
48349    12/1/2007..2/28/2009    994555  377     202
151060   2/1/2008..4/30/2009     994555  377     202
204179   3/1/2008..5/31/2009     994555  377     202
244504   4/1/2008..6/30/2009     994555  377     202
302728   5/1/2008..7/31/2009     994555  377     202
365780   6/1/2008..8/31/2009     994555  377     202
431555   7/1/2008..9/30/2009     994555  377     202
499234   8/1/2008..10/31/2009    994555  377     202
786937   12/1/2008..2/28/2010    994555  377     202 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T15:12:02.243

根据您对 dtypes 是“对象”的评论，我想知道您的 Z_ID 是否作为字符串列加载，从而导致因子列。如果某些字符串具有前导空格，则它们将被解释为不同的因子级别。

更一般地，该列包含的任何“对象”类型都可能具有一个无法按照您认为的方式工作的比较函数。这有点牵强。

对您来说更好的事情可能是弄清楚为什么您的数据框列 dtype 不是 int64。我发现在 pandas 中工作时，在数据框中获取正确的 dtypes 非常重要。如果您可以发布一些代码，我相信这里的社区可以提出正确加载类型的建议。

# javascript - 确保 ExtJS 复选框字段更新其模型

> ID：14386900
> 
> 赞同：1
> 
> 时间：2013-01-17T19:46:23.633
> 
> 标签：javascript, extjs4

我继承了一个 ExtJs4 项目，我有一个相当基本的问题。

我有一个视图，其中有一个新添加的复选框字段作为项目之一，如下所示：

```
{
    boxLabel: 'Test Message?',
    xtype: 'checkboxfield',
    id: 'cbTextMessage',
    checked: false,
    name: 'testMessage',
    inputValue: true,
    uncheckedValue: false
} 
```

当记录处于活动状态时，此值将更改为适当的选中或未选中状态。创建新记录时，该值设置为复选框的值。但是，在编辑现有记录时，模型永远不会更新为原始值以外的任何值。

该模型：

```
Ext.define('PushAdmin.model.Message', {
    extend: 'Ext.data.Model',
    idProperty: 'id',

    requires: ['Proxy.ParameterProxy'],
    fields: [
        { name: 'id', type: 'int' },
        { name: 'games', type: 'auto',
            convert: function(data, model) {
                data = ( data && !Ext.isArray(data) ) ? [data] : data;
                return data;
            }
        },
        { name: 'msgEnglish', type: 'string' },
        { name: 'msgFrench', type: 'string' },
        { name: 'msgSpanish', type: 'string' },
        { name: 'testMessage', type: 'bool' },
        { name: 'sendAt', type: 'date' },
        { name: 'note', type: 'string'},
        { name: 'status', type: 'string' },

    ],

    proxy: {
        type: 'rest',
        url: '/apnsadmin/rest/Message',

        pageParam: undefined,
        startParam: undefined,
        limitParam: undefined,

        reader: {
            type: 'json',
            root: 'data',
            successProperty: 'success'
        }
    }
}); 
```

最后，这是单击保存按钮时调用的函数。

```
click: function () {
    var grid = this.getQueuedMessagesGrid();
    var sm = grid.getSelectionModel();

    var selectedRecord = sm.getCount() > 0 ? sm.getSelection()[0] : undefined;

    this.getMessageForm().getForm().updateRecord();

    var newRecord = this.getMessageForm().getForm().getRecord();

    if (selectedRecord!=undefined) {
        console.log(selectedRecord);
        console.log(newRecord);
        selectedRecord.save();
    } else {
        // New record!

        console.log("Saving new record");

            grid.getStore().add(newRecord);
            newRecord.save();
        }

        this.getMessageForm().setDisabled(true);
        this.getMessageForm().getForm().reset();
    }
}, 
```

我知道事情可能不是正确的 ExtJS 做事的方式，但由于这主要是有效的，我试图不必重写它的大部分。我只想知道在将这个复选框/布尔字段添加到表单时我做错了什么。

# php - 根据类别使用不同的 WordPress 主题

> ID：14386901
> 
> 赞同：2
> 
> 时间：2013-01-17T19:46:29.050
> 
> 标签：php, wordpress

是否可以根据您所在的类别显示不同的主题？

例如：

```
blog.example.com/category/foo -> style1.
blog.example.com/category/bar -> style2. 
```

谷歌搜索带来了[这个页面](http://mattmedia.net/2007/10/09/how-to-set-up-custom-wordpress-category-templates-in-four-easy-steps/)，他建议在 single.php 中这样做：

```
$post = $wp_query->post;
if ( in_category(5) ) {
    include(TEMPLATEPATH . '/style1.php');
} else {
    include(TEMPLATEPATH . '/style2.php');
} 
```

这是要走的路吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T19:50:08.553

你不应该真的使用`include`这个。Wordpress 具有惊人的[`get_template_part`](http://kovshenin.com/2013/get_template_part/)功能，仅适用于这些情况。它具有内置的回退机制，并与您的主题很好地集成：

```
$categories = get_the_category();

get_template_part('for-category', $categories[0]->slug); 
```

然后，只需使用类别 slug 命名您的文件：

> blog.example.com/category/foo -> for-category-foo.php
> blog.example.com/category/bar -> for-category-bar.php

请记住还有一个默认`for-category.php`文件，以便在您没有当前类别的自定义文件时可以回退到该文件。

# mysql - 从没有自动 ID 的表中选择最后 250 行

> ID：14386904
> 
> 赞同：4
> 
> 时间：2013-01-17T19:46:35.273
> 
> 标签：mysql, select, sql-order-by, limit

我知道那里已经有一些帖子，但有些帖子相互矛盾。

我承担了一个项目，在该项目中我继承了一个包含 1000 个条目的表。

问题是，表上没有自动增量 ID 字段，我被要求提取最后输入的 300 行。

是否可以从表中提取最后 300 个条目？是否有“系统行 ID”？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T19:54:34.227

严格的答案是“否”，除非您有日期或其他指示顺序的东西。表本质上是无序的。

在实践中，您通常按照放入的顺序取回数据。“我将数据加载一次，没有后续插入，到只有一个处理器和一个磁盘的系统中”这句话越真实，就越有可能数据实际上是有序的。

拥有系统行 ID 对您没有帮助，因为您可能有删除和后续插入。在这种情况下，后面的记录将放在前面的页面中。

你有一张小桌子。做 a `select *`，将数据复制到电子表格中，然后从那里开始工作。

或者，您可以选择行号增加的表，插入另一个表，然后从那里进行选择。像这样的伪代码：

```
insert into NewTable (seqnum, cols)
    select :rownum=:rownum+1, cols
    from YourTable 
```

你有机会得到你想要的。

最后一点。 *如果*您进行了插入并拥有自插入以来的日志文件，您可能能够从那里获取信息。有一点工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-17T20:01:00.110

试试这个：

```
SELECT col1, col2, ... 
FROM (SELECT col1,col2, ..., (@auto:=@auto+1) indx 
      FROM tablename, (SELECT @auto:=1) AS a
     ) AS b 
ORDER BY indx DESC 
LIMIT 30 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-17T19:54:53.303

如果你在表中至少有一个记录插入时间，那么你可以使用这个..否则没有。

```
SELECT * FROM 
yourtable 
ORDER BY inserted_time desc limit 300; 
```

# google-maps - 如何将墨卡托地图坐标转换为相对屏幕坐标？

> ID：14386912
> 
> 赞同：0
> 
> 时间：2013-01-17T19:47:00.600
> 
> 标签：google-maps, bing-maps, mercator

我有一个包含各种地图位置（纬度、经度）的数据库。我一直在使用地图 api（例如谷歌地图）来绘制这些位置。

我现在正在试验，看看我是否可以完全删除地图 api 的依赖关系，并简单地将地图控件替换为图像（.png 图像）。

**问题：** 如何将地图位置转换为正确显示到此地图图像上？

**更多细节：** 基本上，地图将是一个矩形区域（即Div元素），矩形的左上角显然是（0, 0）。所以基本上地图位置将相对于这个左上角显示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-17T14:43:29.757

# asp.net - 如果页面启用了母版页，则禁用页面中的视图状态是否会做任何事情？

> ID：14386914
> 
> 赞同：-1
> 
> 时间：2013-01-17T19:47:13.897
> 
> 标签：asp.net, viewstate

我有一个使用母版页的页面。

我在页面（不是母版页）上禁用了视图状态，但我没有注意到视图状态减少了。

好奇母版页设置是否会覆盖它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T22:02:36.447

在我的测试中，设置`EnabledViewState = "False"`不会减少页面的视图状态，而设置`ViewStateMode="Disabled"`会减小视图状态的大小

母版页

```
<%@ Master Language="C#" AutoEventWireup="true" CodeBehind="ViewStateTest.master.cs" Inherits="Sample.ViewStateTest" %>

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
    <head runat="server">
    <title></title>
    <asp:ContentPlaceHolder ID="head" runat="server">
    </asp:ContentPlaceHolder>
</head>
<body>
<form id="form1" runat="server">
<div>
    <asp:ContentPlaceHolder ID="ContentPlaceHolder1" runat="server">

    </asp:ContentPlaceHolder>
</div>
</form> 
```

子页面

```
<%@ Page Title="" Language="C#" MasterPageFile="~/ViewStateTest.master"         AutoEventWireup="true" CodeBehind="ViewstateTestPage.aspx.cs"         Inherits="Sample.ViewstateTestPage" ViewStateMode="Disabled" %>
<asp:Content ID="Content1" ContentPlaceHolderID="head" runat="server">
</asp:Content>
<asp:Content ID="Content2" ContentPlaceHolderID="ContentPlaceHolder1" runat="server">
    <asp:TextBox runat="server"></asp:TextBox>
</asp:Content> 
```

# meteor - 在流星中使用http请求获取静态引用文件

> ID：14386920
> 
> 赞同：1
> 
> 时间：2013-01-17T19:47:31.057
> 
> 标签：meteor

这可能是一个愚蠢的问题，但我遇到了一些问题。我正在尝试用流星实现 jwplayer。Jwplayer 将尝试根据您建议的 url 获取文件。所以我尝试在 localhost:3000/test.mp3 中放置一个文件。当我尝试点击该网址时，我得到的只是默认站点。如果我使用tomcat，这将起作用。我可以做些什么来获取相对于流星目录的文件吗？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T20:11:36.867

在`/public`目录中，[根据文档](http://docs.meteor.com/#structuringyourapp)：

> 最后，Meteor 服务器将提供公共目录下的任何文件，就像在 Rails 或 Django 项目中一样。这是图片、favicon.ico、robots.txt 和其他任何东西的地方。

Meteor 还没有实现服务器端路由，所有目录最终都被扁平化了。所以目前，您可以在 访问您的文件`http://localhost:3000/test.mp3`，但将来可能会改变。

# c++ - localtime vs localtime_s 和适当的输入参数

> ID：14386923
> 
> 赞同：55
> 
> 时间：2013-01-17T19:47:36.597
> 
> 标签：c++, localtime

```
time_t rawtime;
struct tm * timeinfo;
time ( &rawtime );
timeinfo = localtime ( &rawtime ); 
```

这将返回：警告 C4996：'localtime'：此函数或变量可能不安全。考虑改用 localtime_s。

```
time_t rawtime;
struct tm * timeinfo;
time ( &rawtime );
timeinfo = localtime_s ( &rawtime ); 
```

当我将 localtime 更改为 localtime_s 时，我得到：错误 C2660：'localtime_s'：函数不接受 1 个参数

这是我认为在第一个代码块中发生的事情：

*   创建一个空的 time_t 变量。
*   创建指向在 ctime 中定义的 timeinfo 的指针
*   将 rawtime 写入 rawtime 引用
*   将原始时间转换为对行人有意义的东西

    1.  我对吗？
    2.  localtime_s 需要什么第二个输入参数？
    3.  如果我忽略整个本地时间安全问题，可能发生的最坏情况是什么。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2013-01-17T19:54:41.907

`localtime`返回指向静态分配的指针`struct tm`。

使用 localtime_s，您传入一个指向 struct tm 的指针，并将`localtime_s`其结果数据写入其中，因此您的代码将从：

```
struct tm *timeinfo;
timeinfo = localtime(&rawtime); 
```

类似于：

```
struct tm timeinfo;
localtime_s(&timeinfo, &rawtime); 
```

这样，它会写入*您的*缓冲区，而不是拥有自己的缓冲区。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-17T19:52:40.797

localtime_s 只是本地时间函数的微软实现，您可以安全地继续使用，`locatime`因为它符合 C++ ISO 标准并且只有微软将其标记为“已弃用”。localtime 函数本身在 C++ 世界中根本不被弃用。

`localtime_s` [参考资料](http://msdn.microsoft.com/en-us/library/a442x3ye%28v=vs.80%29.aspx)说这些参数应该传递给它：

```
_tm 
Pointer to the time structure to be filled in.
 time 
Pointer to the stored time. 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-07-18T04:29:55.227

正如[Orbit 中的 Lightness Races](https://stackoverflow.com/users/560648/lightness-races-in-orbit)所指出的，`localtime`它不是线程安全的以及其他几个时间函数。我想了解更多有关该主题的信息，并找到[了一篇相关的博客文章](http://kjellkod.wordpress.com/2013/01/22/exploring-c11-part-2-localtime-and-time-again/)，其中对此进行了详尽的解释。

下面的引用解释了为什么`localtime`不是线程安全的：

> [...] localtime 返回一个指向静态缓冲区 (std::tm*) 的指针。另一个线程可以调用该函数，并且可以在第一个线程完成读取 struct std::tm* 的内容之前覆盖静态缓冲区。

# css - 'form-horizo ntal' 表单内的隐藏提交按钮

> ID：14386930
> 
> 赞同：0
> 
> 时间：2013-01-17T19:47:59.050
> 
> 标签：css, twitter-bootstrap

假设我有下一个表格：

```
<form action="/orders/add" class="form-horizontal" id="OrderAddForm" method="post">
   <div style="display:none;"><input type="hidden" name="_method" value="POST"></div>         

   <div class="control-group">
      <button type="button" class="btn" id="new-order-line">New order line</button>
   </div>

   <div class="control-group">
      <input class="btn my-hidden" type="submit" value="Save Orderr">       
   </div>
</form> 
```

我的CSS：

```
.my-hidden {
   display: none;
} 
```

还有我的js：

```
$(function() {
   $('#new-order-line').click(function() {
     $('.my-hidden').show('slow');
   });
}); 
```

因此，每当我单击“新订单行”按钮时，我都想显示“保存订单”按钮，但似乎 Twitter Bootstrap 覆盖了我的“我的隐藏”类，因为它位于“表单”元素和我的“保存订单”中' 按钮始终显示。我读到有些人有[同样的问题](https://github.com/twitter/bootstrap/issues/4079)

一些解决方法来隐藏我的按钮？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T20:06:29.353

我不认为这本身就是一个问题。使用 Twitter Bootstrap CSS 规则可能无法（轻松）完成，但如果问题是 Twitter Bootstrap 覆盖了您想要做的事情，您始终可以创建自己的具有更高[特异性](https://www.google.se/search?q=css+specificity&aq=0&oq=css+specif&aqs=chrome.0.0j57j0l2j62l2.2255&sourceid=chrome&ie=UTF-8)的规则。

一种简单的方法是添加到属性中，`style="display: none;"`因为内联样式会自动享受顶级特异性。

为您的课程提供更高特异性的一种方法是稍微详细说明选择器。例如，这比您的示例具有更高的特异性，但我不知道这是否足够：

```
.form-horizontal .control-group .my-hidden { display: none; } 
```

（我希望我正确理解了你的问题......如果不是，请责备我；）

# java - 如何在 Android 中解析嵌套的 JSON 对象？

> ID：14386931
> 
> 赞同：1
> 
> 时间：2013-01-17T19:47:59.987
> 
> 标签：java, android, json

我必须以这样的结构解析 webService 返回的 JSON 字符串：

```
{
"catList" : {
"1" :{
    "name" : "NAME",
    "qty" : "QTY",
    "groupList" : {
        "40" : {
        "name" : "NAME",
        "qty" : "QTY",
        "subjectList" : {
            "1" : {
            "name" : "NAME",
            "qty" : "QTY",
            },
            "5" : {
            "name" : "NAME",
            "qty" : "QTY",
            },
            ...
        },
        "45" : {
        "name" : "NAME",
        "qty" : "QTY",
        "subjectList" : {
            "23" : {
            "name" : "NAME",
            "qty" : "QTY",
            },
            "45" : {
            "name" : "NAME",
            "qty" : "QTY",
            },
            ...
        },
        ...
"2" :{
    "name" : "NAME",
    "qty" : "QTY",
    "groupList" : {
        "142" : {
        "name" : "NAME",
        "qty" : "QTY",
        "subjectList" : {
            "86" : {
            "name" : "NAME",
            "qty" : "QTY",
            },
        "23" : {
        "name" : "NAME",
        "qty" : "QTY",
            },
            ...
        },
        "7" : {
        "name" : "NAME",
        "qty" : "QTY",
        "subjectList" : {
            "98" : {
            "name" : "NAME"
            "qty" : "QTY"
            },
            "08" : {
            "name" : "NAME"
            "qty" : "QTY"
            }
        },
        ...
    },
    ...
"3" :{SAME OTHERS},
"4" :{SAME OTHERS},
"5" :{SAME OTHERS},
"6" :{SAME OTHERS},
"7" :{SAME OTHERS},
"8" :{SAME OTHERS},
"9" :{SAME OTHERS},
} 
```

我不知道怎么办？！我有一些像这样的课程：

```
public class CatList {

    private String name;
    private String qty;
    private JSONObject groupList;
}

public class GroupList {

    private String name;
    private String qty;
    private JSONObject subjectList;
}

public class SubjectList {

    private String name;
    private String qty;
} 
```

但是因为 groupLists 和 subjectList 有随机标题，我不知道如何识别它们。这可能吗？我能怎么做？请帮忙

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T19:52:34.213

我建议您更改服务器返回的 JSON 结构，因为这是糟糕的设计：）

无论如何，这是我使用 Jackson 库的工作示例。示例 json 位于此处：[https](https://dl.dropbox.com/u/6129677/json_test.json) ://dl.dropbox.com/u/6129677/json_test.json 请 注意，我已删除“catList”，并仅留下类别列表（请参阅 json）。

类别.java：

```
public class Category {

    private String name;
    private String qty;
    private Map<String, Group> groupList;

    @JsonProperty("groupList")
    public Map<String, Group> getGroupList() {
        return groupList;
    }

    @JsonProperty("groupList")
    public void setGroupList(Map<String, Group> groupList) {
        this.groupList = groupList;
    }

    @JsonProperty("name")
    public String getName() {
        return name;
    }

    @JsonProperty("name")
    public void setName(String name) {
        this.name = name;
    }

    @JsonProperty("qty")
    public String getQty() {
        return qty;
    }

    @JsonProperty("qty")
    public void setQty(String qty) {
        this.qty = qty;
    }
} 
```

组.java

```
public class Group {

    private String name;
    private String qty;

    private Map<String, Subject> subjectList;

    @JsonProperty("name")
    public String getName() {
        return name;
    }

    @JsonProperty("name")
    public void setName(String name) {
        this.name = name;
    }

    @JsonProperty("qty")
    public String getQty() {
        return qty;
    }

    @JsonProperty("qty")
    public void setQty(String qty) {
        this.qty = qty;
    }

    @JsonProperty("subjectList")
    public Map<String, Subject> getSubjectList() {
        return subjectList;
    }

    @JsonProperty("subjectList")
    public void setSubjectList(Map<String, Subject> subjectList) {
        this.subjectList = subjectList;
    }
} 
```

主题.java

```
public class Subject {
    private String name;
    private String qty;

    @JsonProperty("name")
    public String getName() {
        return name;
    }

    @JsonProperty("name")
    public void setName(String name) {
        this.name = name;
    }

    @JsonProperty("qty")
    public String getQty() {
        return qty;
    }

    @JsonProperty("qty")
    public void setQty(String qty) {
        this.qty = qty;
    }
} 
```

将 JSON 编组到我们的对象：

```
try {
    ObjectMapper om = new ObjectMapper();
    Map<String, Category> catMap = om.readValue(getAssets().open("json_test.json"), new TypeReference<Map<String, Category>>() {
    });
} catch (IOException e) {
    e.printStackTrace();
} 
```

结果，您将获得 Map 对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T20:07:15.307

如果您遍历 JSON 对象数组并使用 getName() 方法获取名称？或者，使用图书馆[http://jackson.codehaus.org/](http://jackson.codehaus.org/)？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-17T20:03:44.927

我建议您在项目中使用**Jackson**并为您尝试反序列化的 JSON 创建一个类类型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-17T20:21:39.780

使用[jackson](http://jackson.codehaus.org/)是因为[性能](http://martinadamek.com/2011/02/04/json-parsers-performance-on-android-with-warmup-and-multiple-iterations/)和[简单性](http://www.mkyong.com/java/how-to-convert-java-object-to-from-json-jackson/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-17T19:50:39.590

你知道[http://json.org/java/](http://json.org/java/)项目。

我在网络应用程序中使用这个库，它可能适用于你的情况。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-01-17T20:12:03.683

我将在此处发布此答案，以便清楚且不会隐藏在评论部分中。

```
JSONObject jsonObject = search.getJSONObject("object_key");
Iterator jsonObjectKeys = jsonObject.keys();

while(jsonObjectKeys.hasNext()) {
    String currentDynamicKey = (String)keys.next();
    JSONObject currentDynamicValue = jsonObject.getJSONObject(currentDynamicKey);

    //do what you need to do with the data here
} 
```

# java - 如何读取旧单词 doc 文件元数据

> ID：14386933
> 
> 赞同：1
> 
> 时间：2013-01-17T19:48:18.543
> 
> 标签：java, jsp, ms-word, apache-poi, metadata

假设我想将一个带有`doc`扩展名的 word 文件连同元数据一起导入到我的 HTML 文档中，并相应地显示它`div`。所以`doc`文件中所有现有的东西，比如不同格式的文本（粗体、斜体、不同大小、字母间距、行高、上划线、下划线..）、图像（它们的位置和大小）、图形、图表（JSP将生成必要的图形以提供外观相似的图形或图表。它只需要数据）、列表等。

那么有没有办法做到这一点？是否有任何标准化的 Word API 可以为我们提供这些数据？或者任何可以做到这一点的 JSP 库？如果没有，那么我需要知道什么并做些什么才能得到这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T20:00:41.097

查看 Apache POI 项目：**http** ://poi.apache.org/text-extraction.html以及 Apache Tika：**http ://tika.apache.org/**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-04-16T08:53:31.750

5年后，答案是：

**注意**：此代码仅适用于旧词“doc”文件（不是 docx），Apache POI 也可以处理 docx，但您必须使用另一个 API。

使用[Apache POI](https://poi.apache.org/)，maven 依赖项：

```
<!-- https://mvnrepository.com/artifact/org.apache.poi/poi -->
<dependency>
  <groupId>org.apache.poi</groupId>
  <artifactId>poi</artifactId>
  <version>3.17</version>
</dependency> 
```

这是代码：

```
 ...
  import org.apache.poi.poifs.filesystem.DirectoryEntry;
  import org.apache.poi.poifs.filesystem.DocumentEntry;
  import org.apache.poi.poifs.filesystem.DocumentInputStream;
  import org.apache.poi.poifs.filesystem.POIFSFileSystem;

  public static void main(final String[] args) throws FileNotFoundException, IOException, NoPropertySetStreamException,
                  MarkUnsupportedException, UnexpectedPropertySetTypeException {
      try (final FileInputStream fs = new FileInputStream("src/test/word_template.doc");
        final POIFSFileSystem poifs = new POIFSFileSystem(fs)) {
        final DirectoryEntry dir = poifs.getRoot();
        final DocumentEntry siEntry = (DocumentEntry) dir.getEntry(SummaryInformation.DEFAULT_STREAM_NAME);
        try (final DocumentInputStream dis = new DocumentInputStream(siEntry)) {
          final PropertySet ps = new PropertySet(dis);
          final SummaryInformation si = new SummaryInformation(ps);
          // Read word doc (not docx) metadata.
          System.out.println(si.getLastAuthor());
          System.out.println(si.getAuthor());
          System.out.println(si.getKeywords());
          System.out.println(si.getSubject());
          // ...
        }
      }
    } 
```

要阅读文本内容，您将需要额外的依赖项：

```
<dependency>
  <!-- Required for HWPFDocument -->
  <groupId>org.apache.poi</groupId>
  <artifactId>poi-scratchpad</artifactId>
  <version>3.17</version>
</dependency> 
```

代码：

```
try (final HWPFDocument doc = new HWPFDocument(fs)) {
  return doc.getText().toString();
} 
```

# eclipse - TestNG 中的 DataProvider 从 excel 传递数据

> ID：14386937
> 
> 赞同：-2
> 
> 时间：2013-01-17T19:48:31.173
> 
> 标签：eclipse, excel, selenium-webdriver, testng, testng-dataprovider

我开始使用 Eclipse 和 TestNG 学习 Selenium2 (WebDriver)。我有一个关于 DataProvider 的问题。例如，我有一个登录页面，其中包含用户、密码和登录按钮。我已经在 TestNG 中编写了一个测试。我已将 pageobject 用于 UI 对象（具有单独的类）并在另一个类中进行实际测试。

这里 glogin 是一个类，而 login 是完成查找元素和发送密钥的函数，这在另一个具有 TestNG 注释的类 gtest（这是主测试）中调用。

我在将取值的主脚本中访问该类。

```
@test(Dataprovide = "test")
public void glogin(String user, String pass)
{
  glogin log1 = new login;
  log1.login(user,pass);
} 
```

我有以下excel表

```
user      pass    
John      Smith      
Carson    Black    
Carla     ck23
test      test4 
```

当我使用 dataprovider 并从 excel 表中获取数据作为数组并在测试中使用它时，会显示以下错误：

```
org.testng.TestNGException: 

The data provider is trying to pass 4 parameters but the method plus.gmail#glogin takes 2
    at org.testng.internal.Invoker.injectParameters(Invoker.java:1337)
    at org.testng.internal.Invoker.invokeTestMethods(Invoker.java:1225)
    at org.testng.internal.TestMethodWorker.invokeTestMethods(TestMethodWorker.java:128)
    at org.testng.internal.TestMethodWorker.run(TestMethodWorker.java:111)
    at org.testng.TestRunner.privateRun(TestRunner.java:767)
    at org.testng.TestRunner.run(TestRunner.java:617)
    at org.testng.SuiteRunner.runTest(SuiteRunner.java:334)
    at org.testng.SuiteRunner.runSequentially(SuiteRunner.java:329)
    at org.testng.SuiteRunner.privateRun(SuiteRunner.java:291)
    at org.testng.SuiteRunner.run(SuiteRunner.java:240)
    at org.testng.SuiteRunnerWorker.runSuite(SuiteRunnerWorker.java:52)
    at org.testng.SuiteRunnerWorker.run(SuiteRunnerWorker.java:86)
    at org.testng.TestNG.runSuitesSequentially(TestNG.java:1203)
    at org.testng.TestNG.runSuitesLocally(TestNG.java:1128)
    at org.testng.TestNG.run(TestNG.java:1036)
    at org.testng.remote.RemoteTestNG.run(RemoteTestNG.java:111)
    at org.testng.remote.RemoteTestNG.initAndRun(RemoteTestNG.java:204)
    at org.testng.remote.RemoteTestNG.main(RemoteTestNG.java:175) 
```

非常感谢任何帮助。

这是使用 Dataprovider 注释的方法的代码和

```
 @DataProvider(name="test")
        public Object[][] createdata1()throws Exception
        {
            Object[][] retobj = getexcel();
            return retobj;              
        }

        private String[][] getexcel() throws Exception
        {
            // TODO Auto-generated method stub

            String[][] tabarray = null;
            try {
                Workbook wb1 = Workbook.getWorkbook(new 

File("F:/testdata.xls"));

                Sheet sheet = wb1.getSheet("userlogin");

                Cell tablestart = sheet.findCell("login");

                int startrow = tablestart.getRow();
                int startcol = tablestart.getColumn();

                Cell tableend = sheet.findCell("login",startcol+1,startrow+1, 

100, 64000, false);

                int endrow = tableend.getRow();
                int endcol = tableend.getColumn();

                System.out.println("startRow="+startrow+", endRow="+endrow+", 

" + "startCol="+startcol+", endCol="+endcol);

                 tabarray = new String[endrow - startrow + 1][endcol - 

startcol + 1];

                int ci = 0;
                for(int i = startrow +1 ;i<endrow;i++,ci++)
                {

                    int cj = 0;
                    for(int j = startcol + 1;j<endcol;j++,cj++)
                    {
                        tabarray[ci][cj] = sheet.getCell(j, 

i).getContents();
                        System.out.println(tabarray[ci][cj]);

                    }   
                }

            } catch (BiffException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

            return tabarray;
        }

test(Dataprovider = "test")
public void glogins(String user, String pass)
{
  glogin log1 = new glogin(driver);
  log1.login(user,pass);
} 
```

当我执行测试时，我收到了来自 excel 的数据

```
john
smith
carson
Black
carla
ck23
test
test4 
```

作为输出

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T05:08:35.693

错误消息不是不言自明吗？

```
The data provider is trying to pass 4 parameters but the method plus.gmail#glogin takes 2 
```

使用调试器并找出您的数据提供程序返回 4 个参数而不是仅返回 2 个的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-17T08:31:36.470

利用

```
tabarray = new String[endrow - 1][endcol - 1]; instead of //tabarray = new String[endrow - startrow + 1][endcol - startcol + 1]; 
```

因为您打算只返回 2*2 数组

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-26T14:04:56.723

换行

```
tabarray = new String[endrow - startrow + 1][endcol - startcol + 1]; 
```

和

```
tabarray = new String[endrow - startrow - 1][endcol - startcol - 1]; 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-11-20T17:50:47.377

我同意 Kalyan 的回复；原因是数据提供者 excel 表的第一列和最后一列也被函数计为参数/参数；因此请使用`tabArray=new String[endRow-startRow-1][endCol-startCol-1];`希望这有助于和快乐的测试......

# ruby - 捆绑安装不适用于 RVM

> ID：14386944
> 
> 赞同：1
> 
> 时间：2013-01-17T19:48:56.853
> 
> 标签：ruby, macos, git, bundle-install

我在安装捆绑包时遇到问题。

这些是我的最后一步：

*   `git clone http:...`
*   `git checkout -b daniel`
*   `bundle install`

我得到的错误是：

```
Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native
extension.

        /Users/daniel/.rvm/rubies/ruby-1.9.3-p286/bin/ruby extconf.rb  checking for main() in -lpthread... yes checking for main() in
-lobjc... yes
*** extconf.rb failed *** Could not create Makefile due to some reason, probably lack of necessary libraries and/or headers.  Check
the mkmf.log file for more details.  You may need configuration
options.

Provided configuration options:     --with-opt-dir  --without-opt-dir
    --with-opt-include  --without-opt-include=${opt-dir}/include
    --with-opt-lib  --without-opt-lib=${opt-dir}/lib    --with-make-prog
    --without-make-prog     --srcdir=.  --curdir
    --ruby=/Users/daniel/.rvm/rubies/ruby-1.9.3-p286/bin/ruby
    --with-pthreadlib   --without-pthreadlib    --with-objclib
    --without-objclib   --enable-debug  --disable-debug
/Users/daniel/.rvm/gems/ruby-1.9.3-p286/gems/therubyracer-0.11.0/ext/v8/build.rb:50:in
`build_with_rubygem_libv8': undefined local variable or method
`libv8_include_flags' for main:Object (NameError)   from
extconf.rb:20:in `<main>'

Gem files will remain installed in
/Users/daniel/.rvm/gems/ruby-1.9.3-p286/gems/therubyracer-0.11.0 for
inspection. Results logged to
/Users/daniel/.rvm/gems/ruby-1.9.3-p286/gems/therubyracer-0.11.0/ext/v8/gem_make.out
An error occurred while installing therubyracer (0.11.0), and Bundler
cannot continue. Make sure that `gem install therubyracer -v '0.11.0'`
succeeds before bundling. 
```

当我尝试跑步时，`gem install therubyracer -v '0.11.0'`我得到了：

```
Building native extensions.  This could take a while... ERROR:  Error
installing therubyracer:    ERROR: Failed to build gem native extension.

        /Users/daniel/.rvm/rubies/ruby-1.9.3-p286/bin/ruby extconf.rb checking for main() in -lpthread... yes checking for main() in
-lobjc... yes
*** extconf.rb failed *** Could not create Makefile due to some reason, probably lack of necessary libraries and/or headers.  Check
the mkmf.log file for more details.  You may need configuration
options.

Provided configuration options:     --with-opt-dir  --without-opt-dir
    --with-opt-include  --without-opt-include=${opt-dir}/include
    --with-opt-lib  --without-opt-lib=${opt-dir}/lib    --with-make-prog
    --without-make-prog     --srcdir=.  --curdir
    --ruby=/Users/daniel/.rvm/rubies/ruby-1.9.3-p286/bin/ruby
    --with-pthreadlib   --without-pthreadlib    --with-objclib
    --without-objclib   --enable-debug  --disable-debug
/Users/daniel/.rvm/gems/ruby-1.9.3-p286/gems/therubyracer-0.11.0/ext/v8/build.rb:50:in
`build_with_rubygem_libv8': undefined local variable or method
`libv8_include_flags' for main:Object (NameError)   from
extconf.rb:20:in `<main>'

Gem files will remain installed in
/Users/daniel/.rvm/gems/ruby-1.9.3-p286/gems/therubyracer-0.11.0 for
inspection. Results logged to
/Users/daniel/.rvm/gems/ruby-1.9.3-p286/gems/therubyracer-0.11.0/ext/v8/gem_make.out 
```

我正在使用 Mac OS 10.7.5。Xcode 及其命令行工具和 Rails 是最新的。还安装了 SQLite 3。

谁能帮我？

* * *

编辑：

我还尝试删除存储库并再次克隆它，但出现相同的错误。

* * *

编辑：

Rails 和 Sqlite3 的安装路径是否正确？

```
daniel:~ 
daniel$ sudo gem update --system Latest version currently
installed. Aborting. 
daniel:~ 
daniel$ sudo gem install rails 
Fetching:
rails-3.2.11.gem (100%) Successfully installed 
rails-3.2.11 1 gem installed 
Installing ri documentation for rails-3.2.11... 
Installing RDoc documentation for rails-3.2.11... 
daniel:~ 
daniel$ sudo gem install sqlite3
Fetching: sqlite3-1.3.7.gem (100%) 
Building native extensions.  This could take a while... 
Successfully installed sqlite3-1.3.7 1 gem installed 
Installing ri documentation for sqlite3-1.3.7... 
Installing RDoc documentation for sqlite3-1.3.7...
daniel:~ 
daniel$ which ruby irb gem rake
/Users/daniel/.rvm/rubies/ruby-1.9.3-p286/bin/ruby
/Users/daniel/.rvm/rubies/ruby-1.9.3-p286/bin/irb
/Users/daniel/.rvm/rubies/ruby-1.9.3-p286/bin/gem
/Users/daniel/.rvm/gems/ruby-1.9.3-p286/bin/rake 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T15:39:28.683

至少有一个问题是您正在运行 RVM，但用于`sudo`在您的系统上安装 gems。

阅读“ [RVM and RubyGems](https://rvm.io/rubies/rubygems/) ”，尤其是上面写着的部分：

# “不要使用 sudo ...”

RVM 在您自己的计算机用户空间中为您（用户）创建一个沙箱，让您无需成为系统管理员即可管理它。换句话说，这意味着您不必使用`sudo`任何 RVM 或 gems 管理。

如果您确实使用`sudo`，您将暂时不再是您（用户），并成为管理员，拥有管理员权限和管理员环境，其中不*包括*您的`/Users/daniel/.rvm/rubies/ruby-1.9.3-p286`路径中的 RVM 沙箱。沙箱的知识由您环境中的 PATH 携带，您机器上的 root 不使用它。安装在该子 shell 中的 Gem`sudo`会安装到管理员帐户知道​​的位置，即 System Ruby 安装中，这就是您的 RVM 沙盒 Ruby 看不到它们的原因：系统的 Ruby 和您的 Ruby 之间没有交叉RVM 控制的 RUby。这就是沙盒的全部理念：分离元素和资源以避免污染。

您可以通过查看以下输出来弄清楚这一切：

```
which ruby irb gem rake 
```

所有这些路径都指向您的沙箱：

```
/Users/daniel/.rvm/rubies 
```

在 Mac OS 系统上，该命令应该报告：

```
/usr/bin/ruby
/usr/bin/irb
/usr/bin/gem
/usr/bin/rake 
```

使用以下命令重新安装 Rails 和 SQLite gem：

```
gem install rails sqlite3 
```

并查看您的捆绑包的行为方式。

而且，顺便说一句，不要`sudo`故意尝试管理/删除系统安装的 Ruby。这是 Apple 出于自己的目的安装的，以启用他们安装的软件。利用它的存在是可以的，但它是供他们使用的。将 RVM 管理的 Ruby 用于您自己的目的。

# css - css scale 转换如何影响文档流？

> ID：14386948
> 
> 赞同：8
> 
> 时间：2013-01-17T19:49:10.153
> 
> 标签：css, transform

我真的很困惑使用 css 转换缩放元素如何影响文档流。

[考虑一下这个 jsbin](http://jsbin.com/ukaxef/2/edit)或[这个 codepen，因为 jsbin 似乎已经下降](http://codepen.io/anon/full/twGzE)到我拥有的地方

```
p{slipsum text}
#scaled
  #scaled-content{some text}
p{slipsum text} 
```

与样式表

```
#scaled-contents {
  height: 400px;
  width: 400px;
  background-color: blue;
  color: red;
  font-size: 3em;
}

#scaled {
  transform: scale(0.25, 0.25); //browser prefixes...
  width: 100px;
  height: 100px
} 
```

我希望这与单个 100x100 蓝色方块的显示类似。但它被转移了，在 chrome 上甚至与下面的 p 元素略有重叠。此外，在 devtools 中检查#scaled 的尺寸显示为下蹲和长，似乎超出了它的 100x100 框。

最后，添加`overflow: hidden;`到#scaled 完全是一件疯狂的事情。

到底是怎么回事？内容流应该如何受到影响？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-17T19:56:31.243

CSS 变换不影响文档流。DOM 元素将占据它在页面流中的原始位置和尺寸。

因此，如果您有 3 个相同大小的正方形 div，连续显示并应用 -webkit-transform: scale(2) 到中心正方形，这个正方形将放大 200%，从其原始中心缩放位置，并与其他两个正方形重叠。

参考示例：

[http://jsfiddle.net/ypnEk/](http://jsfiddle.net/ypnEk/)

HTML：

```
<div class="square one"></div>
<div class="square two"></div>
<div class="square three"></div> 
```

CSS：

```
.square{
  margin-top:50px;
  width:50px;
  height:50px;
  display:inline-block;
}

.one{
  background:#222;
}

.two{
  background:#888;
  -webkit-transform: scale(2);
}

.three{
  background:#ccc;
} 
```

# opengl - OpenGL VBO、VAO、立方体和颜色

> ID：14386950
> 
> 赞同：0
> 
> 时间：2013-01-17T19:49:15.623
> 
> 标签：opengl, colors, cube, vbo

我目前正在尝试了解 VBO，但遇到了一些问题。

我正在使用具有位置、颜色和法线的交错数组。但是，当我去画画时，显示只是白色的。

这是我的数组的结构：

```
GLfloat position[3];
GLfloat normal[3];
GLfloat color[4]; 
```

这是代码：

**初始化：**

```
glGenBuffers(1, &arrays[0]);
glBindBuffer(GL_ARRAY_BUFFER, arrays[0]);

glBufferData(GL_ARRAY_BUFFER, 125*10*36*sizeof(GLfloat), vertices, GL_STATIC_DRAW);

glBindBuffer(GL_ARRAY_BUFFER, 0);

glGenVertexArrays(1, &vaoID[1]);
glBindVertexArray(vaoID[1]);

glBindBuffer(GL_ARRAY_BUFFER, vaoID[1]);
glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 40, ((void*)0));
glVertexAttribPointer(1, 3, GL_FLOAT, GL_FALSE, 40, ((void*)12));
glVertexAttribPointer(2, 4, GL_UNSIGNED_BYTE, GL_TRUE, 40, ((void*)24));
glEnableVertexAttribArray(0);
glEnableVertexAttribArray(1);
glEnableVertexAttribArray(2);

glBindVertexArray(0);
glDisableVertexAttribArray(0);
glDisableVertexAttribArray(1);
glDisableVertexAttribArray(2);
glBindBuffer(GL_ARRAY_BUFFER, 0);
glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, 0); 
```

**画：**

```
glPushMatrix();
glBindVertexArray(vaoID[1]);
glDrawArrays(GL_TRIANGLE_STRIP, 0, 125*36);
glPopMatrix(); 
```

我正在制作一个 5x5 的立方体，其光谱颜色从黑色到白色。但是，在抽签时，这就是我得到的全部：

![白立方。](../Images/a1ae1c44e66de762d99b58c631b044f5.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T06:45:26.997

我发现您在上面发布的内容有问题。您已将颜色定义为结构中的浮点数，但您说`glVertexAttribPointer()`颜色是无符号字节。它可能应该是这样的：

```
glVertexAttribPointer(2, 4, GL_FLOAT, GL_TRUE, 40, ((void*)24)); 
```

这假设您实际上是将浮点数放入这些内存位置。你如何设置它们？

# php - 链接数据库链接以通过 B、F、G 从 X 到 Y

> ID：14386959
> 
> 赞同：0
> 
> 时间：2013-01-17T19:49:37.157
> 
> 标签：php, mysql

很抱歉在这里问一个非常笼统的问题，可能是错误的地方，但这里的答案很好，所以我试一试。

我有一个 MYSQL 数据库，1 个地理特征表。1 表操作员在两点之间飞行的位置

```
 |Flyings company|Point A|Point B|

  |Company ID    |A ID   | B ID  | 
```

搜索如何混合和匹配从 X 点到 Y 点的方式的最简单方法是什么？如果您必须从 X 到 B、B 到 F、F 到 G、G 到 Y。欢迎接受任何建议，了解此问题是否已关闭。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T20:10:46.470

从理论上讲，您确实需要图形算法。实际上，如果您通过腿数进行迭代并愿意将其限制在某个合理的数量，您可以尝试使用自连接查询：

单腿路线：

```
 select leg1.company, leg1.a_id, leg1.b_id 
   from flights leg1 
   where leg1.a_id=1 and leg1.b_id=2 
```

两条腿路线：

```
 select leg1.company, leg1.a_id, leg1.b_id, leg2.company, leg2.b_id 
   from flights leg1 join flights leg2 on leg1.b_id=leg2.a_id 
   where leg1.a_id=1 and leg2.b_id=2 
```

三段线路：

```
 select leg1.company, leg1.a_id, leg1.b_id, leg2.company, leg2.b_id, leg3.company, leg3.b_id 
   from flights leg1 join flights leg2 on leg1.b_id=leg2.a_id join flights leg3 on leg2.b_id join leg3.a_id 
   where leg1.a_id=1 and leg3.b_id=2 
```

依此类推，直到你的极限。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T19:52:12.037

您想要的是使用您的数据构建有向图。节点将匹配地理点，边将匹配两点之间的操作

然后您继续查找所需的两个任意节点之间的所有路径。

这不是您可以仅通过数据库查询来解决的问题：您必须（可能不是一次，但最终）加载所有数据，以便构建完整的图表并提供完整的答案列表。

# eclipse - Eclipse 没有连接到任何更新站点，但内部浏览器可以工作

> ID：14386961
> 
> 赞同：1
> 
> 时间：2013-01-17T19:50:11.567
> 
> 标签：eclipse, connection

我尝试配置网络连接，但没有成功。

Eclipse 的内部浏览器正常打开所有更新站点。在 IE 和 Firefox 中，没有代理配置，但有时它们会在浏览页面之前要求我的 Windows 用户名和密码。也许有一个透明代理，我不知道。

错误：

```
Unable to connect to repository http://download.eclipse.org/releases/indigo/content.xml
Unable to connect to repository http://download.eclipse.org/releases/indigo/content.xml
Connection timed out: connect 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-17T19:52:04.493

那些链接 404 表示另一端有问题

编辑 - 我错了，显然这是一个持续存在的[问题](http://www.eclipse.org/forums/index.php/t/270718/)

一种可能的解决方法是设置

```
-vmargs -Djava.net.preferIPv4Stack=true 
```

在你的 Eclipse 启动中。

# javascript - .load 方法耗时太长

> ID：14386963
> 
> 赞同：0
> 
> 时间：2013-01-17T19:50:31.987
> 
> 标签：javascript, jquery, html

我正在做的是将不同的内容加载到每个按钮的 div 中。我用来这样做的代码：

```
$(function(){
    $('#galleries').hide().load("letters/index.php", function(){
        $(this).slideDown(1);
        $(this).slideUp(1);  
        $(this).hide();
        $(this).slideDown(1500);/* or fadeIn() or any other effect*/
        document.getElementById("data").style.display = 'none';
    });
}); 
```

这是一个代码的示例。我得到了另外 8 个这样的，但我每次都将不同的 php 页面加载到#galleries 中。

我的问题是，加载第二页需要很长时间。例如，在我第一次单击任何按钮时，加载所有内容都需要一秒钟，无论它有什么内容。但是每当我按下另一个按钮加载另一个页面时，我必须等待大约 3-5 秒，当我等待时，它什么也没有显示，没有 div 被显示，只是背景。

有可能解决这个问题吗？或者，是否可以插入一个正在加载的图像或文本来让用户知道它正在加载？因此，在加载页面时，用户会看到：“LOADING..”或一些加载图标。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T19:55:09.840

这应该让你朝着正确的方向前进。

另外，我不知道您对它们的所有不同影响`$(this)`是什么。

```
$(function(){ 
    $(".loading-image").show();

     $('#galleries').hide().load("letters/index.php", function(){
          $(this).slideDown(1);
          $(this).slideUp(1);    
          $(this).hide();
          $(this).slideDown(1500);/* or fadeIn() or any other effect*/

          $("#data").hide(); //replacing your getElementById

          $(".loading-image").hide();

      });

}); 
```

# php - 如何在不循环的情况下从另一个 php 关联数组中查找值？

> ID：14386965
> 
> 赞同：-1
> 
> 时间：2013-01-17T19:50:34.667
> 
> 标签：php, associative-array, lookup

我有两个 PHP 关联数组，分别存储用户信息和事务。它们在一个“列”中具有共同的值（用户电子邮件地址，我们不要讨论这是否是有效的唯一标识符）。

我正在遍历第一个数组以构建一个 HTML 表，并且我想在第二个数组中显示它们共同的键匹配时的值，即要显示当前电子邮件地址的交易信息.

我宁愿避免编写复杂的 JOIN MYSQL 语句来从我的源数据构建一个更大的数组（编辑：如果有更简单的方法可以在 PHP 中实现相同的目标）。

我已经搜索了高低（SO 和其他论坛，PHP 文档），但到目前为止我所看到的一切都涉及（嵌套）循环，这让我觉得效率低下，因为你有更多的记录。是否有一些类似于我缺少的 PHP 原生的 Excel 的 VLOOKUP 的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T20:06:36.843

1.  你的问题无处不在。显示尺寸数据的循环没有丝毫问题。可以保持原样。
2.  你的“我宁愿避免一个适当的解决方案，所以给我找另一个”对我来说听起来有点傲慢。
3.  无论如何，您正在寻找一个简单的“解决方案” - 在形成第二个数组时，您可以使用电子邮件作为第二个数组的键。

# asp.net-mvc-4 - MVC4 中与 Active Directory 相关的 AppDomainUnloadedException

> ID：14386966
> 
> 赞同：1
> 
> 时间：2013-01-17T19:50:35.613
> 
> 标签：asp.net-mvc-4, active-directory, userprincipal

我有一个 ASP.NET MVC 应用程序。它在域上运行，我们通过调用来确定用户`UserPrincipal.Current`。这在大多数情况下都很有效。每隔一段时间（可能 5 次中就有 1 次），并且只有在我将应用程序发布到 IIS 之后，它才会抛出 AppDomainUnloadedException。

导致异常的代码的特定行是：

```
if (UserPrincipal.Current.SamAccountName != null && 
    _currentUserId != UserPrincipal.Current.SamAccountName) ... 
```

调用堆栈的其余部分是：

```
mscorlib.dll!System.StubHelpers.StubHelpers.GetCOMHRExceptionObject(int hr, System.IntPtr pCPCMD, object pThis) + 0xe bytes 
System.DirectoryServices.AccountManagement.dll!System.DirectoryServices.AccountManagement.ADStoreCtx.LoadDomainInfo() + 0x358 bytes 
System.DirectoryServices.AccountManagement.dll!System.DirectoryServices.AccountManagement.ADStoreCtx.DnsDomainName.get() + 0x5e bytes   
System.DirectoryServices.AccountManagement.dll!System.DirectoryServices.AccountManagement.ADStoreCtx.GetAsPrincipal(object storeObject, object discriminant = {Name = "UserPrincipal" FullName = "System.DirectoryServices.AccountManagement.UserPrincipal"}) + 0x17a bytes 
System.DirectoryServices.AccountManagement.dll!System.DirectoryServices.AccountManagement.ADStoreCtx.FindPrincipalByIdentRefHelper(System.Type principalType, string urnScheme, string urnValue, System.DateTime referenceDate, bool useSidHistory) + 0x576 bytes   
System.DirectoryServices.AccountManagement.dll!System.DirectoryServices.AccountManagement.ADStoreCtx.FindPrincipalByIdentRef(System.Type principalType, string urnScheme, string urnValue, System.DateTime referenceDate) + 0x35 bytes  
System.DirectoryServices.AccountManagement.dll!System.DirectoryServices.AccountManagement.Principal.FindByIdentityWithTypeHelper(System.DirectoryServices.AccountManagement.PrincipalContext context, System.Type principalType, System.DirectoryServices.AccountManagement.IdentityType? identityType, string identityValue, System.DateTime refDate) + 0x9e bytes 
System.DirectoryServices.AccountManagement.dll!System.DirectoryServices.AccountManagement.Principal.FindByIdentityWithType(System.DirectoryServices.AccountManagement.PrincipalContext context, System.Type principalType, System.DirectoryServices.AccountManagement.IdentityType identityType, string identityValue) + 0x5b bytes 
System.DirectoryServices.AccountManagement.dll!System.DirectoryServices.AccountManagement.UserPrincipal.FindByIdentity(System.DirectoryServices.AccountManagement.PrincipalContext context, System.DirectoryServices.AccountManagement.IdentityType identityType, string identityValue) + 0x1e bytes    
System.DirectoryServices.AccountManagement.dll!System.DirectoryServices.AccountManagement.UserPrincipal.Current.get() + 0xc1 bytes 
```

经过大量挖掘，由于异常的随机性，我得出结论，问题可能与此有关：

[http://support.microsoft.com/kb/2683913](http://support.microsoft.com/kb/2683913)

所以我安装了修补程序，正如预期的那样，问题消失了。那是星期二。今天早上，异常又开始了。我验证了 hotifx 确实已安装。我打开了模块加载消息并得到：

```
'w3wp.exe': Loaded 'C:\Windows\SysWOW64\activeds.dll', Cannot find or open the PDB file. 
```

所以我验证了那个 .dll 实际上是来自修补程序的那个，它是（大小和版本#s 匹配）。

在我得到这个异常的同时，我在事件日志中得到这个事件：

```
A process serving application pool 'WebSitePool' suffered a fatal communication error with the Windows Process Activation Service. The process id was '7404'. The data field contains the error number. 
```

错误中的唯一数据是：0x8007006D，我相信这只是意味着存在致命的通信错误，错误已经说过......

幽默的是，当异常对话框弹出时，它说：“如果有这个异常的处理程序，程序可以安全地继续。” 如果您的应用程序不需要 UserPrincipal.Current，这是正确的，但是在此异常之后再次调用它会导致异常重新抛出，所以我会质疑他们在那里的“安全继续”断言。

现在，如果我重新运行该应用程序，我不会遇到问题。除了发布后，我还没有任何时候发生过这种情况。由于我们的设置和与其他项目的关系，这个应用程序必须在 IIS 下调试，这意味着我每次进行代码更改时都必须发布它，这意味着我通常一整天都看到这个（周二下午和昨天除外） .

我似乎很好奇，从四处挖掘，这个错误似乎经常与 ASP.NET MVC 相关联，但我不相信我已经看到它与 WinForms 或 ASP.NET 相关联......我看不到这有什么关系，但也许那里有关系。

我怀疑这是一个 MS 错误。我无法想象在任何合法条件下 UserPrincipal.Current 会导致 AppDomainUnloadedException，但我想我会在 Stackoverflow 上试一试……

# windows-8 - Windows 应用认证工具包 2.2 找不到任何要验证的应用

> ID：14386967
> 
> 赞同：1
> 
> 时间：2013-01-17T19:50:35.770
> 
> 标签：windows-8, windows-runtime, windows-store-apps, app-certification-kit, wack

我正在为 Windows 8 运行 Windows 8 和 Visual Studio Express。

我已经创建了一个应用程序并已成功提交到应用程序商店。

我现在正在开发第二个应用程序并准备提交它。但是，我刚刚更新到最新的 win8 SDK 和 Windows 应用程序认证工具包 2.2。自从我更新以来，我一直无法运行证书套件。

每当我将证书工具包作为“创建应用程序包”的一部分运行时，都会出现以下错误。我发现我的第一个应用程序具有相同的行为很有趣。

由于找不到指定的 Windows 应用商店应用程序，{0} 无法继续测试。请验证 packagefullname 是否正确。

因此，我尝试在独立模式下运行 Windows 应用认证工具包 2.2。当我选择验证 Windows 商店应用程序时，它会考虑一下，然后返回一个空的应用程序列表。

我发现以下链接 wack 没有看到我的应用程序并按照步骤操作，但仍然没有乐趣。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T23:32:20.957

您能否确认您使用的是 Windows 8 的 RTM 版本？这是在 RTM 之前的版本中发现的错误，应该已针对 RTM 进行修复。

# c# - TFS 构建机器测试方法在构建机器上出错

> ID：14386970
> 
> 赞同：0
> 
> 时间：2013-01-17T19:50:47.667
> 
> 标签：c#, unit-testing, tfs, build-process

这是我的单元测试代码：

```
[TestMethod]
public void GetMyAttachmentTest()
{
    var files = Directory.GetFiles(
        Directory.GetCurrentDirectory() + "/Common/MyFiles/", "*.*");

     .... do some thing with the files...
} 
```

在 TFS 构建机器上，当我运行单元测试时，我收到以下错误：

```
System.IO.DirectoryNotFoundException：找不到路径的一部分
'C:\Builds\4\30 我的文件夹 v1.0\myfolder1\TestResults\SCMTFSService_MyBuildServer 2013-01-16 18_06_52_Any CPU_Release\Out\Common\MySpecialFiles\'。

```

当我查看 TFS 中的放置文件夹时，我看到我的文件已部署到以下文件夹中：

```
\\MyBuildServer\Builds\MyFolder\MySolution_20130116.5\Common\MySpecialFiles

```

在我的单元测试代码中，我的文件如下：

```
var files = Directory.GetFiles(
    Directory.GetCurrentDirectory() + "/Common/MySpecialFiles/", "*.*"); 
```

当我的单元测试在 TFS 构建机器上运行时，有没有办法可以查看已部署的文件`Common\MySpecialFiles`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T20:08:26.930

问题有点模糊。过去，我在临时位置执行单元测试时遇到过问题。这对于动态路径（例如`GetCurrentDirectory()`. 当临时目录更改/清除时，文件可能会“丢失”。

不要使用动态路径，而是设置具有适当权限的网络共享。我建议将此网络共享的路径存储为配置文件或数据库，以便无需代码推送即可对其进行更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T20:06:35.233

为什么不将文件的位置放在 app.config/web.config 文件的 appSettings 项中？这将使更改它以匹配您的环境变得容易，无论它是本地的、构建服务器还是部署的环境。

否则，您必须 在运行测试之前将当前目录设置为**\MyBuildServer\Builds\MyFolder\MySolution_20130116.5 ，这可能会以其他方式影响您的测试。**

# c# - 计算给定堆栈中奇数和的函数

> ID：14386973
> 
> 赞同：-7
> 
> 时间：2013-01-17T19:50:56.297
> 
> 标签：c#, data-structures, stack, sum

我现在这个问题已经很多次了，但是我需要一个函数来计算给定堆栈 S 中奇数的总和

我已经尝试过这样的事情，但我现在认为它是不正确的。

```
private static int Sum(int n, x)
{            

    if (n % 2 == 0) && (x % 2 == 0)
       return n + x;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T20:11:46.803

只是一个示例，您可以将堆栈变量作为参数传递给`GetSum()`函数。

```
private static int GetSum()
        {
              Stack<int> stack = new Stack<int>();

            stack.Push(2);
            stack.Push(5);
            stack.Push(7);
            stack.Push(4);
            stack.Push(1);

            int sum = 0;

            foreach (int number in stack)
            {
                if (number % 2 != 0)
                {
                    sum += number;
                }
            }

        return sum;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T19:57:54.307

伪代码：

1.  声明 int sum = 0
2.  对于 S 中的每个元素，检查它是否是奇数
3.  如果奇数，加到总和

# twitter-bootstrap - Twitter 引导网格指南

> ID：14386975
> 
> 赞同：0
> 
> 时间：2013-01-17T19:51:00.863
> 
> 标签：twitter-bootstrap, responsive-design

我希望有人可以帮助我解决这个问题我对此感到有些困惑，我一直使用 960 网格系统。使用 Twitter Bootstrap 进行响应式设计，看看我遇到的问题是 twitter 网站上的桌面视图状态

标签 布局宽度 列宽 装订线宽度 大显示屏 1200px 及以上 70px 30px 默认 980px 及以上 60px 20px 纵向平板电脑 768px 及以上 42px 20px 手机到平板电脑 767px 及以下 可变列，无固定宽度 手机 480px 及以下 可变列，无固定宽度

当然它应该是默认 960px 及以上？60*12 + 20* = 960px？

是否有我遗漏的东西，或者只是需要使用定制器？

基本上我的 PSD 的大小应该仍然是 940 像素（正常情况下？）还是应该是 960 像素？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T01:50:42.723

> 当然它应该是默认 960px 及以上？60*12 + 20* = 960px？

如果您在第一列之前允许 20px 填充，每列之间 20px 和最后一列之后 20px，则总数为 12*(60+20) + 20 = 980px

> 我的 PSD 的大小应该仍然是 940 像素（正常情况下？）还是应该是 960 像素？

是的，设计为 940 像素宽。只要设备窗口为 980 像素或更大，它将显示全宽。

如果您来自 960.gs，则设计宽度是相同的。不同之处在于 bootstap 在每一行的开头和结尾都有额外的 10px 边距，因此它需要一个 980px 宽的窗口来显示全宽。

如果您正在寻找不同宽度的引导布局模板，这里是一个很好的来源[https://benstewart.net/2012/06/bootstrap-responsive-photoshop-templates/](https://benstewart.net/2012/06/bootstrap-responsive-photoshop-templates/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T19:55:02.540

从引导程序来看，这是正确的......

*   大显示屏 1200 像素及以上
*   默认 980px 及以上
*   肖像平板电脑 768px 及以上
*   手机到平板电脑 767px 及以下
*   手机 480px 及以下

# compiler-errors - 新贵编译问题

> ID：14386978
> 
> 赞同：2
> 
> 时间：2013-01-17T19:51:27.967
> 
> 标签：compiler-errors, makefile, configure, upstart

我正在尝试为我的服务器编译新贵，我能够

```
./configure 
```

但就在那之后，

```
make 
```

回击这个错误

```
make: *** No targets specified and no makefile found.  Stop. 
```

我环顾四周，有些人暗示那里实际上不是“Makefile”，即没有扩展名。我找到的唯一文件是“Makefile.am”和“Makefile.in”，我可以收集到的文件中应该还有一个额外的“Makefile”。我将“Makefile.in”的名称更改为“Makefile”，但这并不适用。恐怕也不对。任何帮助是极大的赞赏。谢谢！

# visual-studio-2012 - 哪个更适合创意 Web 开发？

> ID：14386979
> 
> 赞同：0
> 
> 时间：2013-01-17T19:51:29.150
> 
> 标签：visual-studio-2012, dreamweaver

所以我的问题是，Dreamweaver cs6 或 Microsoft Visual Studio 2012 哪个更适合 Web 开发？我很想知道其中一个是否有主要优势？或者，如果有一些小事情最终会让人头疼，因为您必须在整个开发周期中不断处理它们？不要退缩！我要真相！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T19:53:41.813

您可以使用 Aptana 或 Netbeans 等开源 IDE。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T20:00:01.633

如果必须在上述两者之间进行选择，我会选择 Microsoft Visual Studio 2012。我认为 Microsoft Visual Studio 2012 功能更强大，让您可以灵活地与其他重要的 Web 开发组件集成。

换句话说，Microsoft Visual Studio 2012 可以做 Dream Weaver 所能提供的一切（我认为），但反之则不行。

# php - 使用 PHP 将图像发布到 Cheezburger，json_decode 不会处理响应

> ID：14386981
> 
> 赞同：0
> 
> 时间：2013-01-17T19:51:31.210
> 
> 标签：php, curl, json

我正在尝试使用 PHP 脚本将图像发布到 Cheezburger.com，并将 URL 返回给用户。帖子部分工作正常，我得到了 JSON 格式的链接、ID 等，但是当我运行`json_decode($var, true)`它时，它只给了我原始的 JSON。这是输入脚本的字符串：

```
{
    "items": [
        {
            "id": 6980805120,
            "link": "https://api.cheezburger.com/v1/assets/6980805120",
            "created_time": 1358451002,
            "updated_time": 1358451002,
            "media": [
                {
                    "name": "maxW580",
                    "url": "https://i.chzbgr.com/maxW580/6980805120/h89D91707/",
                    "height": 500,
                    "width": 500,
                    "is_animated": false
                },
                {
                    "name": "maxW320",
                    "url": "https://i.chzbgr.com/maxW320/6980805120/h89D91707/",
                    "height": 320,
                    "width": 320,
                    "is_animated": false
                },
                {
                    "name": "square50",
                    "url": "https://i.chzbgr.com/square50/6980805120/h89D91707/",
                    "height": 50,
                    "width": 50,
                    "is_animated": false
                }
            ],
            "title": "JSA, UR WEBSIET IZ AWSUM. URE HIRD!",
            "description": "JSA, UR WEBSIET IZ AWSUM. URE HIRD! -- This image was created by jsa005 from JSiVi using the JSiVi Meme Generator. Try it out at http://jsivi.uni.me!",
            "asset_type_id": 0,
            "share_url": "http://chzb.gr/10Cg1PS"
        }
    ]
} 
```

当我运行`json_decode($jsonstring, true)`它时，`$jsonstring`作为包含上述字符串的 cURL 返回的变量，我只取回我输入的字符串。我很困惑。

```
$fields = array(
'access_token' => $this->getToken(),
'title' => $title,
'description' => $description,
'content' => $base64data,
'anonymous' => 'true');
$url = 'https://api.cheezburger.com/v1/assets';
$fields_string = http_build_query($fields);
//open connection
$ch = curl_init();

//set the url, number of POST vars, POST data
curl_setopt($ch,CURLOPT_URL, $url);
curl_setopt($ch,CURLOPT_POST, count($fields));
curl_setopt($ch,CURLOPT_POSTFIELDS, $fields_string);

//execute post
$result = curl_exec($ch);

//close connection
curl_close($ch);

$jsonstring = json_decode($result, TRUE); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T20:05:36.617

放

```
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true); 
```

在没有它运行之前`curl_exec($ch);`，响应会直接打印到您的浏览器中，因此您会看到“原始” JSON 并且`$response`是布尔值（`TRUE`或`FALSE`）。[有关详细信息，请参阅手册页](http://php.net/manual/en/function.curl-exec.php)

# visual-studio-2010 - 在 Visual Studio 中调试 cuda 文件

> ID：14386982
> 
> 赞同：2
> 
> 时间：2013-01-17T19:51:33.280
> 
> 标签：visual-studio-2010, debugging, matlab, cuda, nsight

我有一个 cpp 函数（function.cpp”），我“mex”-ed。然后我在 Visual Studio 中打开 function.cpp 文件并将 Visual Studio 附加到正在运行的 matlab 进程。

当我在 matlab 中调用该函数时，我可以在 function.cpp 文件中设置断点并逐步观察变量。

当我将函数更改为 cuda 文件 (function.cu) 时，调试过程会中断。按照上述过程，我仍然可以在 function.cu 内停止，但我看不到任何变量。当我尝试“观察”一个变量时，它显示“错误符号..未找到”

我在visual studio中安装了nsight。问题：我如何在调试模式下观察文件 function.cu 中的变量，就像我对 function.cpp 文件所做的那样。这可能吗 ？

请注意，function.cu 不在项目中。它只是一个带有函数 cpp 代码的独立文件（比如 somefunction(){}）。出于调试目的，我在 Visual Studio 中打开它。我正在使用“nvmex -g wrapper.cu”在 matlab 中编译 function.cu 文件 wrapper.cu 是一个 matlab mexfunction 包装器，它调用写在 function.cu 中的 somefunction()

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T11:42:24.437

您使用的是主机调试器 VS 调试器，因此它不知道如何调试设备程序。要在 Windows 中调试设备代码，您应该查看[Parallel Nsight Visual Studio Edition](https://developer.nvidia.com/nvidia-nsight-visual-studio-edition)。

您可以在文档中搜索附加到正在运行的进程的指南，对于当前版本 (2.2)，特定页面在[此处](http://http.developer.nvidia.com/NsightVisualStudio/2.2/Documentation/UserGuide/HTML/Content/Attach_CUDA_to_Process.htm)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T01:20:23.950

您附加了 VS，但在函数“main”中停止。看起来您仍在访问 CPU 代码。当您按照 Tom 的建议附加调试器时，您是否在 Transport 下拉列表中选择了“NVIDIA GPU Debugger”？

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-01-17T21:11:58.150

要调试任何 cuda 代码，您需要一个没有运行桌面环境/服务器的 gpu。对于 Windows，这意味着您需要第二个 gpu。我不能 100% 确定它是否也必须是 nvida gpu。比你可以bedubg你的代码。在 linux 下，您只能使用一个 gpu 进行调试，因为您可以关闭 x-server 并在每个命令行中使用 cuda-gdb 进行调试。更多信息将为您提供[cuda-gdb 手册](http://docs.nvidia.com/cuda/cuda-gdb/index.html#using-debugger)

# objective-c - 在 NSWindowController 上按下 NSButton 时的 EXC_BAD_ACCESS

> ID：14386983
> 
> 赞同：1
> 
> 时间：2013-01-17T19:51:34.190
> 
> 标签：objective-c, macos, cocoa, nsbutton, nswindowcontroller

我正在构建一个 Mac 应用程序。我正在添加一个`childWindowController`到`mainWindow`. 在我`childWindowController`的 IB 中，我有几个按钮，它们的动作连接在 IB 中。但是当我按下 时`NSButton`，应用程序崩溃并且我`EXC_BAD_ACCESS`在终端中收到消息。我也尝试执行 setTarget:self，但这根本没有帮助。

**这是我的代码：applicationDidFinishLaunching**

```
HomeWindowController *home_WindowController = [[[HomeWindowController alloc] initWithWindowNibName:@"HomeWindowController"] autorelease];<br/><br/> 
[[self window] addChildWindow:home_WindowController.window
                         ordered:NSWindowAbove]; 
```

***在 HomeWindowController 中：***

```
- (id)initWithWindowNibName:(NSString *)windowNibName
{
     self = [super initWithWindowNibName:windowNibName];
    if (self) {
        // Initialization code here.

    }
    return self;
}

- (void)windowDidLoad
{
    [super windowDidLoad];
}

-(IBAction)action:(id)sender 
{
    NSLog(@"------------------ ");
} 
```

这里有什么问题？我将 NSButton 绑定到 FileOwner 及其操作。通常与 IB 的 iOS 相同。当我不绑定时`IBAction`，我不会得到`EXC_BAD_ACCESS`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T17:49:40.090

> 终于解决了，我是在appDelegate方法上把childWindowController添加到主窗口后释放的。但是我不明白为什么不能释放它......</p>

因为你拥有窗口控制器，而窗口控制器拥有它的窗口。窗口没有保持其控制器处于活动状态；*你是*。当你不在的时候，它会在任何可能想要与之交谈的东西下消失，比如一个将它作为目标的按钮。

更一般地说，试图将你的所有权责任推给其他对象——例如，期望一个窗口为你拥有它的 WC——是在寻找内存管理错误。

（我唯一的例外是通过集合间接拥有对象：如果我拥有一个充满事物的数组，我不会在进出的过程中单独保留和释放每个事物。其他任何事情，我都希望比我聪明.)

> 因为它是 AppDelegate 上 childWindowController 的本地实例（仅用于在上面添加）？

我不明白你的意思。

# google-chrome-devtools - Chrome >=24 - 如何将 devtools 停靠在右侧？

> ID：14386994
> 
> 赞同：112
> 
> 时间：2013-01-17T19:52:14.607
> 
> 标签：google-chrome-devtools

我喜欢将 devtools 停靠在右侧。我记得当我意识到我不再需要手动分屏和定位窗口时，当我第一次看到这个选项时我是多么高兴。

最近版本的 chrome 似乎缺少该选项。即使在我已经在右侧安装了 devtools 的安装中，该选项也会被删除。

它去哪儿了？

* * *

## 回答 #1

> 赞同：262
> 
> 时间：2013-01-17T19:54:40.450

如果单击并按住关闭图标旁边右上角的图标（取消停靠到单独的窗口按钮），您可以选择将其停靠在右侧。看截图：

![靠右停靠](../Images/e2b892a20ed8997fdadb09ddf7e0c1b4.png)

从 Chrome 41 开始，您可以使用`Ctrl`++ (Windows/Linux) 或++ `Shift`( Mac OS X )在这些视图之间切换。`D``Command (⌘)``Shift``D`

从 Chrome 46 开始，他们终于更改了停靠位置的用户界面。现在有一个垂直省略号，其中每个停靠位置都有明确的按钮。看截图：

![新对接](../Images/719efd78023e8bd5c815c3693cedf696.png)

# events - URLLoader Event.Complete 未触发

> ID：14386995
> 
> 赞同：2
> 
> 时间：2013-01-17T19:52:16.170
> 
> 标签：events, actionscript, urlloader

```
private var csv:URLLoader = new URLLoader();
private var array:Array = new Array();
private var urlr:URLRequest = new URLRequest();
public function loadRecipe(path:String):void
{
    try
    {
        csv.dataFormat = URLLoaderDataFormat.TEXT;
        urlr = new URLRequest(path);
        csv.addEventListener(Event.COMPLETE, finishRecipe);     
        csv.load(urlr);
    }
    catch (e:SecurityErrorEvent)
    {
        trace("1");
    }
    catch (e:IOErrorEvent)
    {
        trace("2");
    }
}

public function finishRecipe(e:Event):void
{
    var csvString:String = csv.data as String;
    array = csvString.split(",");
} 
```

我正在使用的代码在上面。我无法触发完成事件，也就是说，我的数组永远不会被填充。谁能告诉我为什么？

编辑：我改变以摆脱所有弱引用并检查错误。我没有收到任何错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-04-24T03:27:59.297

这些年来，我经常遇到这个错误。当某些浏览器（FireFox、Chrome）从缓存而不是网络中检索文件时，加载程序将调度一个 PROGRESS 事件但从不完成。

尝试清除浏览器缓存，看看下次文件是否正确加载。如果是这样，您可以执行以下两种方法之一作为解决方法：

1.  通过在请求 URL 的末尾添加一个随机字符串来破坏缓存。

    ```
    urlr = new URLRequest(path + "?cachebust=" + Math.floor(100000+900000*Math.random())); 
    ```

    这很容易编码，但有明显的缺点，迫使不必要的重新加载。

2.  监听 COMPLETE 和 PROGRESS 事件。在 PROGRESS 处理程序中，检查 bytesLoaded 是否与 bytesTotal 匹配。如果是，则删除所有处理程序并继续，就好像它是一个 COMPLETE 事件一样。

    ```
    ... somewhere in your code ...
        loader.addEventListener(Event.COMPLETE, handleComplete);
        loader.addEventListener(ProgressEvent.PROGRESS, handleProgress);

    ... somewhere else
    private function handleProgress(evt:ProgressEvent):void
    {
        checkLoadComplete();
    }
    private function handleComplete(evt:Event):void
    {
        checkLoadComplete();
    }
    private function checkLoadComplete():void
    {
        if(loader.bytesTotal > 0 && loader.bytesLoaded == loader.bytesTotal) {
            loader.removeEventListener(Event.COMPLETE, handleComplete);
            loader.removeEventListener(ProgressEvent.PROGRESS, handleProgress);

            ... your code here
        }
    } 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T19:45:08.393

嗯，只是查看您提供的代码，您似乎实际上是在尝试使用 try/catch 来捕获错误。为了找到错误，您必须开始在实际加载程序上收听它们。像这样：

```
public function Foobar() {
    var loader:URLLoader;
    loader.addEventListener(IOErrorEvent.IO_ERROR, onIOError);
    loader.addEventListener(SecurityErrorEvent.SECURITY_ERROR, onSecurityError);
    loader.addEventListener(ProgressEvent.PROGRESS, onProgress);
    loader.addEventListener(Event.COMPLETE, onComplete);
}

private function onComplete(e:Event):void {}
private function onProgress(e:ProgressEvent):void {}
private function onSecurityError(e:SecurityErrorEvent):void {}
private function onIOError(e:IOErrorEvent):void {} 
```