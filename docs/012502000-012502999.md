# StackOverflow 问答 12502000-12502999

# javascript - 页面上有多个并发 iframe

> ID：12502002
> 
> 赞同：3
> 
> 时间：2012-09-19T20:01:11.423
> 
> 标签：javascript, jquery, iframe

我在需要处理独立代码的页面上有四个 iframe。每一个大约需要。处理需要 5 到 15 秒，但我无法让它们同时运行。它们总是按顺序启动/停止。我知道新浏览器最多应该有 6 个连接，但我无法超过 2 个。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T20:11:57.713

您可能没有达到客户端限制，而是服务器限制。

请参阅此答案：[PHP 脚本的同时请求](https://stackoverflow.com/questions/1430883/simultaneous-requests-to-php-script)

请注意其中有关 PHP 会话的部分。该会话将请求文件锁，这将阻止使用该会话的所有其他请求，直到脚本结束并释放文件锁。因此，顺序处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T20:07:53.463

如果您在页面加载时启动脚本，它们将永远不会同步。您需要他们每个人都告诉一些“主脚本”，也许在包装页面中，他们已加载，当它们都加载时，在每个中运行 main 函数。

```
parent.startScripts() // in iframe page 
```

然后，在包装页面中，类似：

```
int sCount=0
function startScripts() {
    sCount++;
    if(sCount==4) {
       //..call start function is each iframe ..
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-12T22:13:46.967

您可以使用[iFrame 上](http://www.emresakarya.de/local-connection/)的本地连接在正确的时间调用脚本。

连接所有 iframe 后，您甚至可以只使用其中一个从所有其他 iframe 调用脚本。

# java - 为什么我的 JAX-WS 处理程序在每个元素上重新声明相同的命名空间？

> ID：12502003
> 
> 赞同：4
> 
> 时间：2012-09-19T20:01:12.283
> 
> 标签：java, xml, soap, jax-ws

我编写了一个 JAX-WS 处理程序来将 WS-Security 标头添加到我的 SOAP 客户端的出站消息中：

```
package com.soap.client;

import javax.xml.namespace.QName;
import javax.xml.soap.Name;
import javax.xml.soap.SOAPElement;
import javax.xml.soap.SOAPException;
import javax.xml.soap.SOAPFactory;
import javax.xml.ws.handler.MessageContext;
import javax.xml.ws.handler.soap.SOAPHandler;
import javax.xml.ws.handler.soap.SOAPMessageContext;

public class ClientHeaderHandler implements SOAPHandler<SOAPMessageContext> {

    private static final String WSSECURITY_PREFIX = "wsse";
    private static final String WSSECURITY_NAMESPACE = "http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd";
    private static final String PASSWORD_TEXT_TYPE = "http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText";

    /**
     * {@inheritDoc}
     * @see javax.xml.ws.handler.Handler#handleMessage(javax.xml.ws.handler.MessageContext)
     */
    @Override
    public boolean handleMessage(final SOAPMessageContext context) {
        boolean outbound = false;
        outbound = (Boolean) context.get (MessageContext.MESSAGE_OUTBOUND_PROPERTY);

        if (outbound) {
            try {
                addSecurityHeader(context);             
            } catch (SOAPException e) {
                // do nothing
            }
        }

        return true;
    }

    private void addSecurityHeader(final SOAPMessageContext context) throws SOAPException {
        SOAPFactory sf = SOAPFactory.newInstance();
        SOAPElement securityElem = sf.createElement("Security", WSSECURITY_PREFIX, WSSECURITY_NAMESPACE);
        SOAPElement tokenElem = sf.createElement("UsernameToken", WSSECURITY_PREFIX, WSSECURITY_NAMESPACE);
        SOAPElement usernameElem = sf.createElement("Username", WSSECURITY_PREFIX, WSSECURITY_NAMESPACE);
        usernameElem.addTextNode("myusername");
        tokenElem.addChildElement(usernameElem);

        Name passwordTypeName = sf.createName("Type", WSSECURITY_PREFIX, WSSECURITY_NAMESPACE);
        SOAPElement passwordElem = sf.createElement("Password", WSSECURITY_PREFIX, WSSECURITY_NAMESPACE);
        passwordElem.addAttribute(passwordTypeName, PASSWORD_TEXT_TYPE);
        passwordElem.addTextNode("mypassword");

        tokenElem.addChildElement(passwordElem);
        securityElem.addChildElement(tokenElem);
        context.getMessage().getSOAPPart().getEnvelope().addHeader().addChildElement(securityElem);
    }
} 
```

这主要是有效的；但是，WS-Security 命名空间和前缀在它们使用的每个元素上重新声明（**xmlns:wsse=http://...**）：

```
<?xml version='1.0' encoding='UTF-8'?>
<S:Envelope xmlns:S="http://schemas.xmlsoap.org/soap/envelope/">
    <S:Header>
        <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd">
            <wsse:UsernameToken xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd">
                <wsse:Username xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd">myusername</wsse:Username>
                <wsse:Password wsse:Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText" xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd">mypassword</wsse:Password>
            </wsse:UsernameToken>
        </wsse:Security>
    </S:Header>
    <S:Body>
        <MyBody/>
    </S:Body>
</S:Envelope> 
```

我尝试了 QNames、Names 等的各种组合，但我似乎无法完成这项工作。 **我需要更改什么以便仅在最顶层的 Security 元素中声明 WS-Security 命名空间？**

* * *

**更新：**下面 gpeche 的建议对我有用。从使用 SOAPFactory 创建元素然后通过 addChildElement 附加它到直接通过 addChildElement 创建它：

```
private void addSecurityHeader(final SOAPMessageContext context) throws SOAPException {
    SOAPFactory sf = SOAPFactory.newInstance();
    SOAPElement securityElem = context.getMessage().getSOAPPart().getEnvelope().addHeader().addChildElement("Security", WSSECURITY_PREFIX, WSSECURITY_NAMESPACE);
    SOAPElement tokenElem = securityElem.addChildElement("UsernameToken", WSSECURITY_PREFIX, WSSECURITY_NAMESPACE);
    SOAPElement usernameElem = tokenElem.addChildElement("Username", WSSECURITY_PREFIX, WSSECURITY_NAMESPACE);
    usernameElem.addTextNode("myusername");

    Name passwordTypeName = sf.createName("Type", WSSECURITY_PREFIX, WSSECURITY_NAMESPACE);
    SOAPElement passwordElem = tokenElem.addChildElement("Password", WSSECURITY_PREFIX, WSSECURITY_NAMESPACE);
    passwordElem.addAttribute(passwordTypeName, PASSWORD_TEXT_TYPE);
    passwordElem.addTextNode("mypassword");
} 
```

生成更清晰的 XML：

```
<?xml version='1.0' encoding='UTF-8'?>
<S:Envelope xmlns:S="http://schemas.xmlsoap.org/soap/envelope/">
    <S:Header>
        <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd">
            <wsse:UsernameToken>
                <wsse:Username>myusername</wsse:Username>
                <wsse:Password wsse:Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">mypassword</wsse:Password>
            </wsse:UsernameToken>
        </wsse:Security>
    </S:Header>
    <S:Body>
        <MyBody/>
    </S:Body>
</S:Envelope> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T20:11:37.327

我遇到了同样的问题，我发现可靠地做到这一点的唯一方法是逐个节点重新生成 XML 树节点：

1.  获取对要在其中设置命名空间的节点的引用
2.  将一个孩子附加到他的父母身上，并带有所需的前缀、名称、属性和命名空间。
3.  递归地将后代复制到新的孩子中，调整前缀和命名空间
4.  完成后，分离原始节点

但是我一直认为必须有一个更简单的方法......

**更新：**

好的，我想我明白你的问题是什么了：你是`SOAPElement`直接从`SOAPFactory`. 在创建时`SOAPElement`s 没有父集，因此它们不能从任何人那里继承您指定的命名空间，并决定自己编写命名空间声明。一旦他们被创建，他们就不会费心在`append()`/`setParent()`时间检查他们是否可以放弃任何声明。

你可以尝试只创建最外层的元素`SOAPFactory`，然后通过创建其余的元素`SOAPElement.addChildElement()`吗？

# c# - 实体框架代码优先问题（SimpleMembership UserProfile 表）

> ID：12502004
> 
> 赞同：28
> 
> 时间：2012-09-19T20:01:15.030
> 
> 标签：c#, entity-framework, asp.net-mvc-4

如果您使用过 ASP.NET MVC 4，您会注意到 Internet 应用程序的默认设置是使用 SimpleMembership 提供程序，这一切都很好，并且工作正常。

问题来自默认数据库生成，它们有一个 POCO 用于`UserProfile`定义如下：

```
[Table("UserProfile")]
public class UserProfile
{
    [Key]
    [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
    public int UserId { get; set; }
    public string UserName { get; set; }
} 
```

..然后像这样生成：

```
using (var context = new UsersContext())
{
    if (!context.Database.Exists())
    {
         // Create the SimpleMembership database without Entity Framework migration schema
         ((IObjectContextAdapter)context).ObjectContext.CreateDatabase();
    }
} 
```

这工作正常，数据库生成得很好并且没有问题。但是，如果我要像这样更改 POCO 并删除数据库：

```
[Table("UserProfile")]
public class UserProfile
{
    [Key]
    [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
    public int UserId { get; set; }
    public string EmailAddress { get; set; }

    public string FirstName { get; set; }
    public string Surname { get; set; }

    public string Country { get; set; }

    public string CompanyName { get; set; }
} 
```

仅生成前 2 列，`UserId`并且`EmailAddress`. 它在代码方面工作得很好（谈论登录/注册），但显然我的其他用户数据都没有被存储。

我在这里错过了什么吗？当然，它应该基于整个`UserProfile`对象生成数据库。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-09-28T17:31:32.477

1 - 您需要启用迁移，最好使用 EntityFramework 5.`Enable-Migrations`在 NuGet 包管理器中使用。

2 - 移动你的

```
WebSecurity.InitializeDatabaseConnection("DefaultConnection", "UserProfile", "UserId", "EmailAddress", autoCreateTables: true); 
```

到 YourMvcApp/Migrations/Configuration.cs 类中的 Seed 方法

```
 protected override void Seed(UsersContext context)
    {
        WebSecurity.InitializeDatabaseConnection(
            "DefaultConnection",
            "UserProfile",
            "UserId",
            "UserName", autoCreateTables: true);

        if (!Roles.RoleExists("Administrator"))
            Roles.CreateRole("Administrator");

        if (!WebSecurity.UserExists("lelong37"))
            WebSecurity.CreateUserAndAccount(
                "lelong37",
                "password",
                new {Mobile = "+19725000000", IsSmsVerified = false});

        if (!Roles.GetRolesForUser("lelong37").Contains("Administrator"))
            Roles.AddUsersToRoles(new[] {"lelong37"}, new[] {"Administrator"});
    } 
```

现在 EF5 将负责创建您的 UserProfile 表，之后您将调用 WebSecurity.InitializeDatabaseConnection 以仅将 SimpleMembershipProvider 注册到已创建的 UserProfile 表中，同时告诉 SimpleMembershipProvider 哪一列是 UserId 和 UserName。我还展示了一个示例，说明如何在 Seed 方法中添加用户、角色并将两者与自定义 UserProfile 属性/字段（例如用户的手机（号码））相关联。

3 - 现在，当您从包管理器控制台运行 update-database 时，EF5 将为您的表提供所有自定义属性

有关其他参考资料，请参阅本文的源代码： **[http ://blog.longle.net/2012/09/25/seeding-users-and-roles-with-mvc4-simplemembershipprovider-simpleroleprovider-ef5-codefirst-and-custom -用户属性/](http://blog.longle.net/2012/09/25/seeding-users-and-roles-with-mvc4-simplemembershipprovider-simpleroleprovider-ef5-codefirst-and-custom-user-properties/)**

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-23T22:47:51.087

看来我可能终于明白了，这可能只是一个巨大的误解。

事实证明，我期待`((IObjectContextAdapter)context).ObjectContext.CreateDatabase();`做它根本不做的事情，即创建数据库中不存在的所有表，或者如果它们存在并且它们不同，则简单地更新它们。

实际发生的是它确实运行了一个`CREATE DATABASE`语句，对我来说这是最没用的东西。除非您在一个非常奇怪的环境中工作，否则您将始终关闭数据库，因此它将始终存在（并且随后将永远不会发生表创建！），我宁愿不给真实世界的用户访问权限无论如何都要创建一个数据库。

无论如何，我`UserProfile`通过使用初始化程序解决了我想要（和相关表）创建数据库的具体问题`DropCreateDatabaseIfModelChanges`，并强制进行如下初始化：

```
public SimpleMembershipInitializer()
{
#if DEBUG
    Database.SetInitializer<DataContext>(new DropCreateDatabaseIfModelChanges<DataContext>());
#else
    Database.SetInitializer<DataContext>(null);
#endif

    try
    {
        using (var context = new DataContext())
        {
            if (!context.Database.Exists())
            {
                ((IObjectContextAdapter)context).ObjectContext.CreateDatabase();
            }
            context.Database.Initialize(true);
        }

        WebSecurity.InitializeDatabaseConnection("DefaultConnection", "UserProfile", "UserId", "EmailAddress", autoCreateTables: true);
    }
    catch (Exception ex)
    {
        throw new InvalidOperationException("The ASP.NET Simple Membership database could not be initialized. For more information, please see http://go.microsoft.com/fwlink/?LinkId=256588", ex);
    }
} 
```

.. 这很有效，非常适合开发，但在实践中却毫无用处，因为如果模型发生变化，它实际上会删除数据库并从头开始重新创建它。对我来说，这使得整个代码优先实践在它的默认形式下几乎毫无用处，我可能最终会恢复到从数据库生成的 edmx 生成。

`UserProfile`仍在创建的表背后的“谜团”是，`WebSecurity.InitializeDatabaseConnection`如果它不存在，它将根据您传递给它的字段来初始化表，这就是为什么`EmailAddress`创建了而不是创建了`UserName`，因为我在此更改了它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-21T23:39:29.637

我遇到了同样的问题。我为在 SimpleMembershipInitializer 中的“CreateDatabase”之前发生的迁移添加了代码。

这解决了我的问题，除了我相信现在我的迁移将在 Azure 中应用，无论发布配置文件中的设置如何。

```
 private class SimpleMembershipInitializer
    {
        public SimpleMembershipInitializer()
        {
            Database.SetInitializer<WomContext>(null);

            // forcing the application of the migrations so the users table is modified before
            // the code below tries to create it. 
            var migrations = new MigrateDatabaseToLatestVersion<WomContext, Wom.Migrations.Configuration>();
            var context = new WomContext(); 
            migrations.InitializeDatabase(context); 

            try
            {.... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-04T06:49:41.327

如果您没有计划在系统上线后进行更改，并且这仅发生在开发中并且不热衷于启用迁移。尝试截断表 __MigrationHistory。

```
truncate table __MigrationHistory 
```

# c++ - 有没有办法直接在 C++ 中访问 RTTI 以改善虚拟调用中的分支预测？

> ID：12502005
> 
> 赞同：5
> 
> 时间：2012-09-19T20:01:20.360
> 
> 标签：c++, rtti, virtual-functions, branch-prediction

所以我正在创建一个包含类 someBase {}; 的库。它将由下游用户在多个类中派生。

```
class someBase {
  public:
    virtual void foo()=0;
}; 
```

我还有一个指向 someBase 的指针向量，我正在这样做：-

```
vector <someBase*> children;

// downstream user code populates children with some objects over here

for (i=0; i<children.size(); i++)
  children[i]->foo(); 
```

现在分析表明，对虚拟调用的分支错误预测是我的代码中的一个（几个）瓶颈。我想做的是以某种方式访问​​对象的 RTTI，并使用它根据类类型对子向量进行排序，以改善指令缓存局部性和分支预测。

关于如何做到这一点的任何建议/解决方案？

要记住的主要挑战是：-

1.) 我真的不知道哪些类或多少类将从 someBase 派生。假设，我可以在某个公共文件的某个地方有一个全局枚举，下游用户可以编辑它以添加他们自己的类类型，然后对其进行排序（基本上实现我自己的 RTTI）。但这是一个丑陋的解决方案。

2.) PiotrNycz 在下面的回答中建议使用 type_info。但是，只有 != 和 == 是为此定义的。关于如何在 type_info 上得出严格的弱排序的任何想法？

3.) 我真的很想改进分支预测和指令缓存局部性，所以如果有替代解决方案，那也将受到欢迎。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-19T20:12:43.403

有`typeid`运营商。

您可以使用它来定义比较器以对向量中的对象进行排序。

像这样：

```
inline bool compareTypes(BaseClass* obj1, BaseClass* obj2)
{
   int compareRes = strcmp(typeid(*obj1).name(), typeid(*obj2).name());
   if (compareRes < 0) return true;
   if (compareRes > 0) return false;
   std::less<BaseClass*> ptrComp;
   return ptrComp(obj1, obj2); 
} 
```

和：

```
 sort(v.begin(), v.end(), compareTypes); 
```

[更新]

感谢您指出我有一个为此目标设计的功能。所以`std::type_info::before(const type_info&) const`比较器将像这样简单：

```
inline bool compareTypes(A* obj1, A* obj2)
{
   return typeid(*obj1).before(typeid(*obj2));
} 
```

我的早期版本还不错；）它可用于需要对给定类的对象进行排序的情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T20:18:09.087

您可以在初始化中按类型对指针进行一次分类，例如：

```
std::vector<derivedA*> derivedA_list;
std::vector<derivedB*> derivedB_list;
//...

for (i=0; i<children.size(); i++)
    if (derivedA *d = dynamic_cast<derivedA*>(children[i]))
        derivedA_list.push_back(d);
    else if (derivedB *d = dynamic_cast<derivedB*>(children[i]))
        derivedB_list.push_back(d);
    //... 
```

然后调用该函数，您可以进行非虚拟调用：

```
for (i=0; i<derivedA.size(); ++i)
    derivedA_list[i]->derivedA::foo();
for (i=0; i<derivedB.size(); ++i)
    derivedB_list[i]->derivedB::foo(); 
```

另请注意，使用迭代器的循环可能会得到更好的优化。

# php - 使用php从目录加载随机图像

> ID：12502007
> 
> 赞同：0
> 
> 时间：2012-09-19T20:01:21.800
> 
> 标签：php, arrays, .htaccess

我需要从目录中选择一个随机图像。我见过一些使用 glob(); 的方法。但我希望使用 scandir(); 功能。

```
function random_img(){
$imageDir =  wptouch_get_bloginfo('template_directory').'/images/default-tiles/';
$images = scandir($imageDir);
$randomImage = $images[array_rand($images)];

return $randomImage;
} 
```

上面的函数应该拉一个图像，但我得到了这个错误：

*scandir("/myfile/directory/") 无法打开目录：未在 "/myfile/directory/" 中实现*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T20:18:38.517

问题是您使用的目录实际上不是本地系统上的目录，而是一个 URL。您不能在 URL 上列出文件。怎么会知道应该包括什么？没有一些普遍实现的魔法，HTTP 上的资源甚至根本不必与文件相对应。

您需要做的是找出这些文件在本地系统上的位置，然后使用该路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T20:06:40.430

试试这个，我认为你使用的路径不正确：

```
$imageDir = $_SERVER['DOCUMENT_ROOT'] . 
            get_template_directory_uri() .
            '/images/default-tiles/'; 
```

# vbscript - VBScript - 今天未创建文件时发送电子邮件

> ID：12502011
> 
> 赞同：3
> 
> 时间：2012-09-19T20:01:31.873
> 
> 标签：vbscript

目标：运行一个每天检查文件夹的 VBScript，并报告当天是否没有文件保存到该文件夹​​。忽略前几天存在的文件。

我需要检查当天是否没有创建文件并发送电子邮件。如果那天创建了一个文件，那么我希望脚本什么都不做 - 没有通知。我找到了这段代码，但它相反，如果文件存在则发送电子邮件，如果文件丢失则不执行任何操作：

```
option explicit
dim myMail
dim fileSystem, folder, file  
dim path
path = "C:\Temp"   
Set fileSystem = CreateObject("Scripting.FileSystemObject")  
Dim myDate
myDate =  dateadd("d", -1, FormatDateTime(Now, 2))
Set folder = fileSystem.GetFolder(path)   
for each file in folder.Files
    if file.DateCreated > myDate then  
    'WScript.Echo file.Name & " last modified at " & file.DateCreated   
        SendEmail 
    'WScript.Echo "this should have sent an email."   
    end if  
next

Function SendEmail()   
    'this works
End Function 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T20:32:51.437

基于您完成的想法，如果找到今天的文件，但必须检查**所有**文件以确保今天的文件丢失，逻辑将是：

```
found = False
For all files in folder
    If today's file found
       found = True
       Exit For
    End If
Next
If Not found Then
   Send Email
End If 
```

# jquery - 似乎无法在 Codeigniter 中返回 JSON

> ID：12502016
> 
> 赞同：0
> 
> 时间：2012-09-19T20:01:55.480
> 
> 标签：jquery, ajax, codeigniter

在库中单个项目上的悬停事件中，我想用 AJAX 调用的结果填充信息窗口。我是 CI 新手，我似乎无法弄清楚为什么我不能完成这项工作。我检查了其他帖子..没有爱。

有人可以向我指出我的错误吗？

这是我的 javascript 函数在悬停时触发

```
function showDataWindow(){
    $.post('index.php/home/getMoreInfo', { ID: thisID},
        function(data) {
             var moreInfo = $.parseJSON(data);
             alert(data); // just checking
             .. build my HTML with results and fade in ..
});}; 
```

这是我的控制器中的相关方法

```
public function getMoreInfo()
{
    $answer = "unsigned";
    $ID = $_POST['ID'];
    $this->load->model('Artist_model');
    $assocReturned = $this->Artist_model->get_more_info($ID);
    echo json_encode($assocReturned);
} 
```

这是我的 Artist_model

```
public function get_more_info($ID)
{
    $query = $this->db->query("SELECT * FROM NOIRusers WHERE UID=$ID");
    $assoc = array();

    foreach($query->results() as $r) // there should be only one result .. do this different?
    {   
        $assoc['memberID'] =$r['UID'];
        $assoc['firstName'] =$r['UFname'];
        $assoc['lastName'] =$r['ULname'];
        .... a lot more like this ...
    }
    return $assoc;
} 
```

我不断收到 500（内部服务器错误）。顺便说一句，我已经加载了我的数据库库。

我认为问题在于我如何处理我的数据库响应。据我了解.. $this->db->query() 给了我一个数据库对象，然后我通过 foreach 将其迭代到一个关联数组中。我将该数组返回给我的控制器，然后控制器对其进行 json_encode 编码并将其回显到 javascript。

我做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-19T20:59:10.343

我要感谢 Zathrus 指出 GZIP 压缩是原因。

在 CodeIgniter 中，您不能直接从启用了 GZIP 压缩的控制器输出。原因是输出类被中断。要避免此问题，请执行以下操作：

在您的控制器中：

```
$data['json'] = json_encode($assocReturned);
$this->load->view('json', $data); 
```

在`views/json.php`（或您提出的任何观点）：

```
<?php echo $json; 
```

我知道您已经解决了您的问题并且它与 GZIP 压缩无关，但是如果您最终优化您的站点并在 CI 中启用它，如果您保持代码原样，您将遇到这个问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-19T20:31:14.710

您是否在 CI 中打开了错误报告？那应该告诉你什么是错的。

它也可能是一个错误的 .htaccess 文件。

或者 - 如果您使用 GZIP 压缩，如果您尝试自己回显内容，则会导致问题。CodeIgniter 使用与其 gzip 输出兼容的[视图- echo 会破坏页面并获取 500 错误。](http://codeigniter.com/user_guide/general/views.html)

# email - PHP邮件脚本，未发送电子邮件

> ID：12502017
> 
> 赞同：4
> 
> 时间：2012-09-19T20:01:57.650
> 
> 标签：email, php

我正在尝试通过一个简单的 PHP 邮件脚本发送邮件。我已经检查了很多次代码，页面就像应该发送邮件一样转到“Thankyou_page”，但我还没有收到电子邮件。任何想法为什么这不起作用？

```
<?php
/*
This first bit sets the email address that you want the form to be submitted to.
You will need to change this value to a valid email address that you can access.
*/
$webmaster_email = "email@mail.com";
$subject = "Contact Us";

/*
This bit sets the URLs of the supporting pages.
If you change the names of any of the pages, you will need to change the values here.
*/
$feedback_page = "feedback_form.html";
$error_page = "error_message.html";
$thankyou_page = "thank_you.html";

/*
This next bit loads the form field data into variables.
If you add a form field, you will need to add it here.
*/
$email_address = $_REQUEST['email_address'] ;
$comments = $_REQUEST['comments'] ;

/*
The following function checks for email injection.
Specifically, it checks for carriage returns - typically used by spammers to inject a CC list.
*/
function isInjected($str) {
    $injections = array('(\n+)',
    '(\r+)',
    '(\t+)',
    '(%0A+)',
    '(%0D+)',
    '(%08+)',
    '(%09+)'
    );
    $inject = join('|', $injections);
    $inject = "/$inject/i";
    if(preg_match($inject,$str)) {
        return true;
    }
    else {
        return false;
    }
}

// If the user tries to access this script directly, redirect them to the feedback form,
if (!isset($_REQUEST['email_address'])) {
header( "Location: $feedback_page" );
}

// If the form fields are empty, redirect to the error page.
elseif (empty($email_address) || empty($comments)){
header( "Location: $error_page" );
}

// If email injection is detected, redirect to the error page.
elseif ( isInjected($email_address) ) {
header( "Location: $error_page" );
}

// If we passed all previous tests, send the email then redirect to the thank you page.
else {
mail( $webmaster_email, $subject,
  $comments, "From: " . $email_address);
header( "Location: $thankyou_page" );
}
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T20:04:28.523

使用编写良好的库，如 SwiftMailer 或 PHPMailer。`mail`在没有很好地掌握 PHP 的情况下使用该功能发送电子邮件是一个杀手。

[PhpMailer 与 SwiftMailer？](https://stackoverflow.com/questions/303783/phpmailer-vs-swiftmailer)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T20:07:19.447

您是否在 php.ini 文件中指定了 smtp 主机？如果是这样是正确的吗？

此外，禁用标题并打印邮件功能的输出以查看它是否成功。在 php.ini 文件中启用错误报告也是一个好主意。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-19T20:23:36.133

是`email@mail.com`有效的电子邮件吗？

# windows-phone-7 - 调试 WindowsPhoneTestFramework AutomationClient

> ID：12502018
> 
> 赞同：3
> 
> 时间：2012-09-19T20:02:03.453
> 
> 标签：windows-phone-7, wp7test

我使用了 WindowsPhoneTestFramework 并且很棒，但它不支持我需要的一些功能，例如设置更改模拟器布局的元素的宽度和高度，以便在横向和纵向等中进行测试。在尝试添加时由于某种原因，像宽度和高度这样的简单命令不起作用，因此需要调试 AutomationClient。例如，我需要查看我在 WindowsPhoneTestFramework.Client.AutomationClient.Remote 中创建的 SetWidthCommand 中发生了什么，并了解为什么在被测应用程序中没有更新该属性。

我创建了 SetWidth 命令并从控制台调用，例如： setWidth id=widthValue

我可以调试，直到我到达 ApplicationAutomationController，其中创建了带有 AutomationIdentifier 和值的命令，并且在 SyncExecuteCommand 之后我得到的结果为 false。这意味着客户端出现问题，那么如何调试 Client.AutomationClient 中的 SetWidthCommand。 Remote 这是 Client.AutomationClient.Remote 中的 SetWidthCommand

```
public partial class SetWidthCommand
{
    protected override void DoImpl()
    {

        var element = GetUIElement();
        if (element == null)
            return;

        if (AutomationElementFinder.SetElementProperty(element, "Width", Value))
        {
            SendSuccessResult();
            return;
        }
        //setWidth ContentPanel 400
        if (ValueCommandHelper.TrySetValue(element, Value.ToString(CultureInfo.InvariantCulture)))
        {
            SendSuccessResult();
            return;
        }
        // if width is missing... then give up
        SendNotFoundResult();
    } 
```

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T21:14:10.497

该框架通过以下方式工作：

**主人**

*   测试主机是 specflow 脚本或控制台应用程序
*   这个测试主机提供了一个提供 WCF 服务的 HTTP 服务器 - [https://github.com/Expensify/WindowsPhoneTestFramework/blob/master/Server/WCFHostedAutomationController/Service/IPhoneAutomationService.cs](https://github.com/Expensify/WindowsPhoneTestFramework/blob/master/Server/WCFHostedAutomationController/Service/IPhoneAutomationService.cs)
*   这里提供的主要方法是`GetNextCommand`和`SubmitResult`
    *   `GetNextCommand`返回派生自`CommandBase`这些类之一的任何类 - [https://github.com/Expensify/WindowsPhoneTestFramework/tree/master/Server/WCFHostedAutomationController/Commands](https://github.com/Expensify/WindowsPhoneTestFramework/tree/master/Server/WCFHostedAutomationController/Commands)
    *   `SubmitResult`期望任何派生自`ResultBase`这些类之一的类 - [https://github.com/Expensify/WindowsPhoneTestFramework/tree/master/Server/WCFHostedAutomationController/Results](https://github.com/Expensify/WindowsPhoneTestFramework/tree/master/Server/WCFHostedAutomationController/Results)

**客户端**

*   客户端在应用程序内的线程上运行
*   客户端连接到服务，然后不断轮询命令
*   当客户端收到命令时，它使用代码的“部分类”部分处理命令 - 例如在[https://github.com/Expensify/WindowsPhoneTestFramework/tree/master/Client/AutomationClient/Remote](https://github.com/Expensify/WindowsPhoneTestFramework/tree/master/Client/AutomationClient/Remote)
*   作为该处理的一部分，客户端必须始终将结果返回给服务

**添加命令或结果**

因为这个机制使用 WCF，那么如果你想在处理中添加一个新的 Command 或一个新的 Result，那么你首先需要将这些添加到 Host，然后你需要更新客户端代码 - 为此你将需要使用 Visual Studio 工具更新自动生成的 WCF 类在[https://github.com/Expensify/WindowsPhoneTestFramework/tree/master/Client/AutomationClient/Service%20References](https://github.com/Expensify/WindowsPhoneTestFramework/tree/master/Client/AutomationClient/Service%20References)

此 WCF 更新可能非常繁琐 - 但它是“正常”的 WCF 操作 - [http://msdn.microsoft.com/en-us/library/bb628652.aspx](http://msdn.microsoft.com/en-us/library/bb628652.aspx)

一旦更新了这些，您就可以在客户端中为您的新命令编写部分类代码。

**替代**

作为一种替代方法，有一个“通用”命令和结果对可用 -

*   GenericCommand [https://github.com/Expensify/WindowsPhoneTestFramework/blob/master/Server/WCFHostedAutomationController/Commands/GenericCommand.cs](https://github.com/Expensify/WindowsPhoneTestFramework/blob/master/Server/WCFHostedAutomationController/Commands/GenericCommand.cs)
*   SuccessResult - “ResultText”可用于任何消息 - [https://github.com/Expensify/WindowsPhoneTestFramework/blob/master/Server/WCFHostedAutomationController/Results/SuccessResult.cs](https://github.com/Expensify/WindowsPhoneTestFramework/blob/master/Server/WCFHostedAutomationController/Results/SuccessResult.cs)

如果您希望使用这些，则通用命令将传递给在[https://github.com/Expensify/WindowsPhoneTestFramework/blob/master/Client/AutomationClient/Remote/GenericCommand.cs中静态注册的处理程序](https://github.com/Expensify/WindowsPhoneTestFramework/blob/master/Client/AutomationClient/Remote/GenericCommand.cs)

例如，您可以注册以下内容：

```
GenericCommand.AddHandlerFactory("MyKey", (command, action) => {
    return (command) => {
        var result = new SuccessResult() {ResultText = "some example text" };
        result.Send(command.Configuration);
    };
}); 
```

这将用于处理任何带有`pleaseDo`“MyKey”字段的GenericCommand

**调试**

根据您的问题，我假设您已经成功调试主机。

调试客户端的最简单方法是：

*   首先启动主机（例如调试器中的控制台）
*   然后在调试器中启动应用程序 - 它应该启动并连接到主机中的 WCF 服务。
    *   您可以在 Command 部分类中正常设置断点。
    *   主运行循环位于[https://github.com/Expensify/WindowsPhoneTestFramework/blob/master/Client/AutomationClient/AutomationClient.cs](https://github.com/Expensify/WindowsPhoneTestFramework/blob/master/Client/AutomationClient/AutomationClient.cs)
    *   `GetAndProcessNextCommand`是Run循环中处理循环的核心。

* * *

我希望这会有所帮助......如果没有，也许尝试发布更大的代码示例（也许使用 gist 或 github）

# oauth - OAuth 1a MVC4 和 WebApi

> ID：12502020
> 
> 赞同：1
> 
> 时间：2012-09-19T20:02:08.913
> 
> 标签：oauth, asp.net-mvc-4, asp.net-web-api, dotnetopenauth

因此，我尝试使用 MVC 4 Webapi 而不是 WCF 从 DotNetOpenAuth 重新实现 OAuth1 OAuthConsumer 和 OAuthServiceProvider 示例。我的所有内容都在回调端点中进行。当它进行 ProcessUserAuthorization 调用时，它似乎在 MVC 4 版本中的 DotNetOpenAuth 代码中采用了与示例中不同的路径。在示例中，它调用 DatabaseTokenManager.GetRequestToken 方法。但是在 MVC 4 版本中，它调用 GetAccessToken 方法。在每种情况下，我都使用相同的消费者项目。我将 OAuth.ashx 从原始示例复制到 MVC 4 版本。我创建了一个新的令牌管理器，使用相同的数据库但不使用 EntityFramework，我使用 PetaPoco 进行数据库访问。我的问题是为什么会发生这种情况，如果有人使用 MVC4/WebApi 完成了 OAuth1 的示例。很高兴在当前的 Web 框架下看到这一点。

这是调用堆栈： `DotNetOpenAuth.OAuth.ServiceProvider.dll!DotNetOpenAuth.OAuth.ChannelElements.TokenHandlingBindingElement.VerifyThrowTokenNotExpired(DotNetOpenAuth.OAuth.Messages.AccessProtectedResourceRequest message) + 0x7d bytes DotNetOpenAuth.OAuth.ServiceProvider.dll!DotNetOpenAuth.OAuth.ChannelElements.TokenHandlingBindingElement.ProcessIncomingMessage(DotNetOpenAuth.Messaging.IProtocolMessage message) + 0x92 bytes
DotNetOpenAuth.Core.dll!DotNetOpenAuth.Messaging.Channel.ProcessIncomingMessage(DotNetOpenAuth.Messaging.IProtocolMessage message = {DotNetOpenAuth.OAuth.Messages.AccessProtectedResourceRequest}) + 0x1d3 bytes
DotNetOpenAuth.Core.dll!DotNetOpenAuth.Messaging.Channel.ReadFromRequest(System.Web.HttpRequestBase httpRequest) + 0x26d bytes
Provider.dll!Provider.OAuthHandler.ProcessRequest(System.Web.HttpContext context = {System.Web.HttpContext}) Line 29 + 0x23 bytes C# System.Web.dll!System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() + 0x391 bytes
System.Web.dll!System.Web.HttpApplication.ExecuteStep(System.Web.HttpApplication.IExecutionStep step = {System.Web.HttpApplication.CallHandlerExecutionStep}, ref bool completedSynchronously = false) + 0xa5 bytes System.Web.dll!System.Web.HttpApplication.PipelineStepManager.ResumeSteps(System.Exception error) + 0x7d1 bytes System.Web.dll!System.Web.HttpApplication.BeginProcessRequestNotification(System.Web.HttpContext context, System.AsyncCallback cb) + 0x80 bytes System.Web.dll!System.Web.HttpRuntime.ProcessRequestNotificationPrivate(System.Web.Hosting.IIS7WorkerRequest wr = {System.Web.Hosting.IIS7WorkerRequest}, System.Web.HttpContext context = {System.Web.HttpContext}) + 0x2ae bytes
System.Web.dll!System.Web.Hosting.PipelineRuntime.ProcessRequestNotificationHelper(System.IntPtr rootedObjectsPointer, System.IntPtr nativeRequestContext = 74727914648, System.IntPtr moduleData, int flags) + 0x491 bytes System.Web.dll!System.Web.Hosting.PipelineRuntime.ProcessRequestNotification(System.IntPtr rootedObjectsPointer, System.IntPtr nativeRequestContext, System.IntPtr moduleData, int flags) + 0x22 bytes`

这是日志输出：

`2012-09-21 07:57:31,143 (GMT-5) [10] INFO DotNetOpenAuth.OAuthServiceProvider - Sample starting... 2012-09-21 07:57:31,835 (GMT-5) [8] INFO DotNetOpenAuth - DotNetOpenAuth.Core, Version=4.1.0.12182, Culture=neutral, PublicKeyToken=2780ccd10d57b246 (official) 2012-09-21 07:57:31,838 (GMT-5) [8] INFO DotNetOpenAuth - Reporting will use isolated storage with scope: User, Domain, Assembly 2012-09-21 07:57:31,850 (GMT-5) [8] ERROR DotNetOpenAuth - Error while trying to initialize reporting. 2012-09-21 07:57:31,858 (GMT-5) [8] INFO DotNetOpenAuth.Messaging.Channel - Scanning incoming request for messages: `http://localhost:8092/OAuthHandler.ashx` 2012-09-21 07:57:31,953 (GMT-5) [8] DEBUG DotNetOpenAuth.Messaging.Channel - Incoming request received: UnauthorizedTokenRequest 2012-09-21 07:57:31,960 (GMT-5) [8] INFO DotNetOpenAuth.Messaging.Channel - Processing incoming UnauthorizedTokenRequest (1.0.1) message: oauth_callback: `http://localhost:8093/Home/OAuthCallBack` oauth_consumer_key: consumerkey oauth_nonce: Z8GPrfzX oauth_signature_method: HMAC-SHA1 oauth_signature: A1RrN/A/VpmGF4/cMT55qS2m4RU= oauth_version: 1.0 oauth_timestamp: 1348232249 scope: testScope 2012-09-21 07:57:31,978 (GMT-5) [8] DEBUG DotNetOpenAuth.Messaging.Bindings - Verifying incoming UnauthorizedTokenRequest message signature of: A1RrN/A/VpmGF4/cMT55qS2m4RU= 2012-09-21 07:57:31,979 (GMT-5) [8] DEBUG DotNetOpenAuth.Messaging.Channel - Applying secrets to message to prepare for signing or signature verification. 2012-09-21 07:57:32,085 (GMT-5) [8] DEBUG DotNetOpenAuth.Messaging.Bindings - Constructed signature base string: POST&http%3A%2F%2Flocalhost%3A8092%2FOAuthHandler.ashx&oauth_callback%3Dhttp%253A%252F%252Flocalhost%253A8093%252FHome%252FOAuthCallBack%26oauth_consumer_key%3Dconsumerkey%26oauth_nonce%3DZ8GPrfzX%26oauth_signature_method%3DHMAC-SHA1%26oauth_timestamp%3D1348232249%26oauth_version%3D1.0%26scope%3DtestScope 2012-09-21 07:57:32,085 (GMT-5) [8] DEBUG DotNetOpenAuth.Messaging.Bindings - Binding element DotNetOpenAuth.OAuth.ChannelElements.SigningBindingElementChain applied to message. 2012-09-21 07:57:32,088 (GMT-5) [8] DEBUG DotNetOpenAuth.Messaging.Bindings - Binding element DotNetOpenAuth.Messaging.Bindings.StandardExpirationBindingElement applied to message. 2012-09-21 07:57:32,097 (GMT-5) [8] DEBUG DotNetOpenAuth.Messaging.Bindings - Binding element DotNetOpenAuth.Messaging.Bindings.StandardReplayProtectionBindingElement applied to message. 2012-09-21 07:57:32,098 (GMT-5) [8] DEBUG DotNetOpenAuth.Messaging.Bindings - Binding element DotNetOpenAuth.OAuth.ChannelElements.OAuthHttpMethodBindingElement did not apply to message. 2012-09-21 07:57:32,099 (GMT-5) [8] DEBUG DotNetOpenAuth.Messaging.Bindings - Binding element DotNetOpenAuth.OAuth.ChannelElements.TokenHandlingBindingElement did not apply to message. 2012-09-21 07:57:32,100 (GMT-5) [8] DEBUG DotNetOpenAuth.Messaging.Channel - After binding element processing, the received UnauthorizedTokenRequest (1.0.1) message is: oauth_callback: `http://localhost:8093/Home/OAuthCallBack` oauth_consumer_key: consumerkey oauth_nonce: Z8GPrfzX oauth_signature_method: HMAC-SHA1 oauth_signature: A1RrN/A/VpmGF4/cMT55qS2m4RU= oauth_version: 1.0 oauth_timestamp: 1348232249 scope: testScope 2012-09-21 07:57:32,111 (GMT-5) [8] DEBUG DotNetOpenAuth.Messaging.Channel - Preparing to send UnauthorizedTokenResponse (1.0.1) message. 2012-09-21 07:57:32,143 (GMT-5) [8] DEBUG DotNetOpenAuth.Messaging.Bindings - Binding element DotNetOpenAuth.OAuth.ChannelElements.TokenHandlingBindingElement applied to message. 2012-09-21 07:57:32,144 (GMT-5) [8] DEBUG DotNetOpenAuth.Messaging.Bindings - Binding element DotNetOpenAuth.OAuth.ChannelElements.OAuthHttpMethodBindingElement did not apply to message. 2012-09-21 07:57:32,145 (GMT-5) [8] DEBUG DotNetOpenAuth.Messaging.Bindings - Binding element DotNetOpenAuth.Messaging.Bindings.StandardReplayProtectionBindingElement did not apply to message. 2012-09-21 07:57:32,146 (GMT-5) [8] DEBUG DotNetOpenAuth.Messaging.Bindings - Binding element DotNetOpenAuth.Messaging.Bindings.StandardExpirationBindingElement did not apply to message. 2012-09-21 07:57:32,148 (GMT-5) [8] DEBUG DotNetOpenAuth.Messaging.Bindings - Binding element DotNetOpenAuth.OAuth.ChannelElements.SigningBindingElementChain did not apply to message. 2012-09-21 07:57:32,151 (GMT-5) [8] INFO DotNetOpenAuth.Messaging.Channel - Prepared outgoing UnauthorizedTokenResponse (1.0.1) message for : oauth_token: XO93OJQIsiEtVdKuN3GCce1gYIU= oauth_token_secret: br6QQ1ZwOyx7MJuxD23nM2Ro690= oauth_callback_confirmed: true 2012-09-21 07:57:32,151 (GMT-5) [8] DEBUG DotNetOpenAuth.Messaging.Channel - Sending message: UnauthorizedTokenResponse 2012-09-21 07:57:32,337 (GMT-5) [8] INFO DotNetOpenAuth.Messaging.Channel - Scanning incoming request for messages: `http://localhost:8092/OAuthHandler.ashx` 2012-09-21 07:57:32,352 (GMT-5) [8] DEBUG DotNetOpenAuth.Messaging.Channel - Incoming request received: UserAuthorizationRequest 2012-09-21 07:57:32,352 (GMT-5) [8] INFO DotNetOpenAuth.Messaging.Channel - Processing incoming UserAuthorizationRequest (1.0.1) message: oauth_token: XO93OJQIsiEtVdKuN3GCce1gYIU= 2012-09-21 07:57:32,352 (GMT-5) [8] DEBUG DotNetOpenAuth.Messaging.Bindings - Binding element DotNetOpenAuth.OAuth.ChannelElements.SigningBindingElementChain did not apply to message. 2012-09-21 07:57:32,352 (GMT-5) [8] DEBUG DotNetOpenAuth.Messaging.Bindings - Binding element DotNetOpenAuth.Messaging.Bindings.StandardExpirationBindingElement did not apply to message. 2012-09-21 07:57:32,352 (GMT-5) [8] DEBUG DotNetOpenAuth.Messaging.Bindings - Binding element DotNetOpenAuth.Messaging.Bindings.StandardReplayProtectionBindingElement did not apply to message. 2012-09-21 07:57:32,352 (GMT-5) [8] DEBUG DotNetOpenAuth.Messaging.Bindings - Binding element DotNetOpenAuth.OAuth.ChannelElements.OAuthHttpMethodBindingElement did not apply to message. 2012-09-21 07:57:32,357 (GMT-5) [8] DEBUG DotNetOpenAuth.Messaging.Bindings - Binding element DotNetOpenAuth.OAuth.ChannelElements.TokenHandlingBindingElement did not apply to message. 2012-09-21 07:57:32,357 (GMT-5) [8] DEBUG DotNetOpenAuth.Messaging.Channel - After binding element processing, the received UserAuthorizationRequest (1.0.1) message is: oauth_token: XO93OJQIsiEtVdKuN3GCce1gYIU= 2012-09-21 07:57:32,373 (GMT-5) [8] DEBUG DotNetOpenAuth.Messaging.Channel - Preparing to send UserAuthorizationResponse (1.0.1) message. 2012-09-21 07:57:32,375 (GMT-5) [8] DEBUG DotNetOpenAuth.Messaging.Bindings - Binding element DotNetOpenAuth.OAuth.ChannelElements.TokenHandlingBindingElement applied to message. 2012-09-21 07:57:32,375 (GMT-5) [8] DEBUG DotNetOpenAuth.Messaging.Bindings - Binding element DotNetOpenAuth.OAuth.ChannelElements.OAuthHttpMethodBindingElement did not apply to message. 2012-09-21 07:57:32,376 (GMT-5) [8] DEBUG DotNetOpenAuth.Messaging.Bindings - Binding element DotNetOpenAuth.Messaging.Bindings.StandardReplayProtectionBindingElement did not apply to message. 2012-09-21 07:57:32,376 (GMT-5) [8] DEBUG DotNetOpenAuth.Messaging.Bindings - Binding element DotNetOpenAuth.Messaging.Bindings.StandardExpirationBindingElement did not apply to message. 2012-09-21 07:57:32,376 (GMT-5) [8] DEBUG DotNetOpenAuth.Messaging.Bindings - Binding element DotNetOpenAuth.OAuth.ChannelElements.SigningBindingElementChain did not apply to message. 2012-09-21 07:57:32,379 (GMT-5) [8] INFO DotNetOpenAuth.Messaging.Channel - Prepared outgoing UserAuthorizationResponse (1.0.1) message for `http://localhost:8093/Home/OAuthCallBack`: oauth_verifier: adbSjIo= oauth_token: XO93OJQIsiEtVdKuN3GCce1gYIU= 2012-09-21 07:57:32,379 (GMT-5) [8] DEBUG DotNetOpenAuth.Messaging.Channel - Sending message: UserAuthorizationResponse 2012-09-21 07:57:32,385 (GMT-5) [8] DEBUG DotNetOpenAuth.Http - Redirecting to `http://localhost:8093/Home/OAuthCallBack`?oauth_verifier=adbSjIo%3D&oauth_token=XO93OJQIsiEtVdKuN3GCce1gYIU%3D 2012-09-21 07:57:32,423 (GMT-5) [5] INFO DotNetOpenAuth.Messaging.Channel - Scanning incoming request for messages: `http://localhost:8092/OAuthHandler.ashx` 2012-09-21 07:57:32,428 (GMT-5) [5] DEBUG DotNetOpenAuth.Messaging.Channel - Incoming request received: AccessProtectedResourceRequest 2012-09-21 07:57:32,428 (GMT-5) [5] INFO DotNetOpenAuth.Messaging.Channel - Processing incoming AccessProtectedResourceRequest (1.0) message: oauth_token: XO93OJQIsiEtVdKuN3GCce1gYIU= oauth_consumer_key: consumerkey oauth_nonce: DxRe5Bax oauth_signature_method: HMAC-SHA1 oauth_signature: U1gDRYSdm6cD+lWjc3BdJObEnhE= oauth_version: 1.0 oauth_timestamp: 1348232252 oauth_verifier: adbSjIo= 2012-09-21 07:57:32,428 (GMT-5) [5] DEBUG DotNetOpenAuth.Messaging.Bindings - Verifying incoming AccessProtectedResourceRequest message signature of: U1gDRYSdm6cD+lWjc3BdJObEnhE= 2012-09-21 07:57:32,428 (GMT-5) [5] DEBUG DotNetOpenAuth.Messaging.Channel - Applying secrets to message to prepare for signing or signature verification. 2012-09-21 07:57:32,442 (GMT-5) [5] DEBUG DotNetOpenAuth.Messaging.Bindings - Constructed signature base string: POST&http%3A%2F%2Flocalhost%3A8092%2FOAuthHandler.ashx&oauth_consumer_key%3Dconsumerkey%26oauth_nonce%3DDxRe5Bax%26oauth_signature_method%3DHMAC-SHA1%26oauth_timestamp%3D1348232252%26oauth_token%3DXO93OJQIsiEtVdKuN3GCce1gYIU%253D%26oauth_verifier%3DadbSjIo%253D%26oauth_version%3D1.0 2012-09-21 07:57:32,442 (GMT-5) [5] DEBUG DotNetOpenAuth.Messaging.Bindings - Binding element DotNetOpenAuth.OAuth.ChannelElements.SigningBindingElementChain applied to message. 2012-09-21 07:57:32,442 (GMT-5) [5] DEBUG DotNetOpenAuth.Messaging.Bindings - Binding element DotNetOpenAuth.Messaging.Bindings.StandardExpirationBindingElement applied to message. 2012-09-21 07:57:32,443 (GMT-5) [5] DEBUG DotNetOpenAuth.Messaging.Bindings - Binding element DotNetOpenAuth.Messaging.Bindings.StandardReplayProtectionBindingElement applied to message. 2012-09-21 07:57:32,443 (GMT-5) [5] DEBUG DotNetOpenAuth.Messaging.Bindings - Binding element DotNetOpenAuth.OAuth.ChannelElements.OAuthHttpMethodBindingElement did not apply to message.`

这是 Provider 的处理程序中的代码：

```
public void ProcessRequest(HttpContext context)
{

IProtocolMessage protocolMessagerequest = sp.ReadRequest();
UnauthorizedTokenRequest requestToken;
UserAuthorizationRequest requestAuth;
AuthorizedTokenRequest requestAccessToken;

if ((requestToken = protocolMessagerequest as UnauthorizedTokenRequest) != null)
{
    var response = sp.PrepareUnauthorizedTokenMessage(requestToken);
    sp.Channel.Send(response);
}
else if ((requestAuth = protocolMessagerequest as UserAuthorizationRequest) != null)
{
    TokenManager mgr = new TokenManager();
    mgr.AuthorizeRequestToken(((ITokenContainingMessage)requestAuth).Token);

    var autoAuthorizeResponse = sp.PrepareAuthorizationResponse(requestAuth);
    sp.Channel.Send(autoAuthorizeResponse);

}
else if ((requestAccessToken = protocolMessagerequest as AuthorizedTokenRequest) != null)
{
    var response = sp.PrepareAccessTokenMessage(requestAccessToken);
    sp.Channel.Send(response);
}
else
{
    throw new InvalidOperationException();
}
} 
```

以下是来自消费者的代码：

```
public ActionResult StartOAuth()
{
    OAuthHelper helper = new OAuthHelper();
    var serviceProvider = helper.GetServiceDescription();
    var consumer = new WebConsumer(serviceProvider, InMemoryTokenManager.Instance);
    // Url to redirect to
    var authUrl = new Uri(Request.Url.Scheme + "://" + Request.Url.Authority + "/Home/OAuthCallBack");
    var requestParams = new Dictionary<string, string>
        {
            {"scope", "testScope"}
        };
     //request access
    consumer.Channel.Send(consumer.PrepareRequestUserAuthorization(authUrl, requestParams, null));
    // This will not get hit!
    return null;
}

public ActionResult OAuthCallback()
{
    OAuthHelper helper = new OAuthHelper();
    // Process result from the service provider
    var serviceProvider = helper.GetServiceDescription();
    var consumer = new WebConsumer(serviceProvider, InMemoryTokenManager.Instance);
    var accessTokenResponse = consumer.ProcessUserAuthorization();

    // If we didn't have an access token response, this wasn't called by the service provider
    if (accessTokenResponse == null)
        return RedirectToAction("Index");

    // Extract the access token
    string accessToken = accessTokenResponse.AccessToken;

    ViewBag.Token = accessToken;
    ViewBag.Secret = InMemoryTokenManager.Instance.GetTokenSecret(accessToken);
    return View();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T20:49:09.743

所以我发现了问题，我的 TokenManager 实现的 GetTokenType 方法中的错误。

# actionscript-3 - 字符串验证 ActionScript

> ID：12502022
> 
> 赞同：2
> 
> 时间：2012-09-19T20:02:14.310
> 
> 标签：actionscript-3, flash, apache-flex, actionscript

嘿，我正在使用动作脚本，只是简单地尝试检查一个字符串是否包含特殊字符或数字，如果它没有将它添加到我的列表中，否则错误输出......但是 NAN 给了我一个错误隐式强制值String 类型到不相关的 Number 类型...有什么建议吗？这是一些代码：

```
private function onAddName(event:Event):void {
        var newItem:Object = {label:addName_ti.text};
        //if not a number true then add onto list.
        if ( isNaN(addName_ti.text )
        {
            names_li.dataProvider.addItem(newItem);
            names_li.dataProvider.sortOn("label");
            addName_ti.text = "";
            addName_bn.enabled = false;
            //User feedback for successfully entering item.
            trace ("Item succesfully added!");
        } else 
        { 
            //User feedback for not succesffully entering item.
            addName_bn.enabled = false;
            trace ("Improper formatting");
        }

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T20:35:05.647

isNaN 方法需要一个 Number 参数，因此您必须将 String 转换为 Number：

```
if(isNaN(Number(addName_ti.text)) 
```

您还可以使用正则表达式 (regex) 来验证您的变量：

```
var isNumeric:RegExp= /^[0-9]*$/;
trace(isNumeric.test(addName_ti.text)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T20:35:40.717

isNaN 需要一个数字。这就是你得到错误的原因。您应该首先使用 parseFloat：

```
isNaN(parseFloat(addName_ti.text)); 
```

parseFloat 特别适用于外部文本，因为它会忽略空格和尾随字符。如果解析不成功，它将返回 NaN。

`" 12"`会回来`12`的。"12abc" 将返回`12`。"abc12" 将返回`NaN`。 `" 12 34 5 6"`会回来`12`的。

如果保证文本格式正确，则简单地转换为数字`Number("12")`会稍微快一些。在我的测试中，执行 1000 万次大约快 400 毫秒。

# java - java中2个数组的简单比较

> ID：12502023
> 
> 赞同：2
> 
> 时间：2012-09-19T20:02:15.620
> 
> 标签：java, arrays, compare

我想做的是让一个数组将自己与另一个数组进行比较，如果它在比较数组中找到重复项，它将跳过以下语句，这就是我目前所拥有的

```
for (int count=0; count < userId.length; count++) {
    for (int integer=0; userId[count] != excluded[integer]; integer++) {
        // The arrays hold either string or Long variables in them
        // Continued code to finish off after checking array
    }
} 
```

我想要做的是让它工作，但可能但同时保持它尽可能简单。如果代码实际上根本不清楚，我想比较两个数组 userId 和排除，我想要的是，如果数组中的任何 userId 值与排除中的任何匹配，那么就像数组状态一样，我想将它们排除在列表。

编辑：运行时，如果`(excluded[counts].contains(user))`
我得到我想要的特定输出“太棒了！”
但是我现在遇到的问题是，如果我运行 if 就好像`(!excluded[counts].contains(user))<br>` 我得到了排除的值，然后一些，许多值重复减去显示
示例的值：

```
String[] userId = new String [] { "10", "15", "17", "20", "25", "33", "45", "55", "77" }
String[] excluded = new String[] { "15", 20", "55", "77" } 
```

然后我进入我的循环来检查数组

```
int count=0;
for (String user : userId) {
for (int counts=0; counts < excluded.length; counts++) {
if (!excluded[counts].contains(user)) {
System.out.println("UID = " + userID[count]);
}
count++ 
```

!excluded 仍将显示我不想显示的 userId 的实例，因此即使我希望它排除它，它仍然显示“UID = 15”，它确实如此，但只有一次，而不是看到它4次我看到它3次。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T20:11:03.970

只需使用集合框架即可。假设您的 ID 是`int`值：

```
int[] excluded = ... ;
int[] userIds = ... ;
Set<Integer> excludedIds = new HashSet<Integer>(Arrays.asList(excluded));
for (int userId : userIds) {
    if (excluded.contains(userId))
        continue;
    // Do something with ID
} 
```

您也可以这样做，但这假设您不关心`userIds`数组中的重复项：

```
int[] excluded = ... ;
int[] userIds = ... ;
Set<Integer> excludedIds = new HashSet<Integer>(Arrays.asList(excluded));
Set<Integer> userIdSet = new HashSet<Integer>(Arrays.asList(userIds));
userIdSet.removeAll(excludedIds);
for (int userId : userIdSet) {
    // Do something with ID
} 
```

这是更好的优化，但不是特别必要，除非您有*很多*ID。你的算法是*O(n) = n ²*，我这里只是*O(n) = n*。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-19T20:09:40.333

将排除的 ID 放入一个集合中。

```
Set<Integer> excludedSet = new HashSet<Integer>();
for (int i : excluded) {
  excludedSet.add(i);
} 
```

然后你的循环看起来像这样：

```
for (int id : userId) {
    if (!excludedSet.contains(id)) {
        // process this user
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-19T20:08:02.703

除非您需要多次执行此任务，否则我不会为优化而烦恼。

否则，最好的解决方案是将第二个数组的项目放入[Set](http://docs.oracle.com/javase/6/docs/api/java/util/Set.html)并使用它的有效方法（包含）来解决集合是否有项目。

# php - 一次查询 MySQL 插入多行

> ID：12502032
> 
> 赞同：48
> 
> 时间：2012-09-19T20:03:15.167
> 
> 标签：php, mysql

我想编写脚本，具有多个插入查询的功能。让我更好地解释这一点。

我有一个`quantity`html 格式的输入。我有 MySQL 查询要插入`registered user`到表中。所以我希望我的函数为“数量”时间插入这个查询。

```
 mysql_query("INSERT INTO `pxlot` (realname,email,address,phone,status,regtime,ip) 
 VALUES ('$realname','$email','$address','$phone','0','$dateTime','$ip')")
 or die (mysql_error()); // Inserts the user. 
```

例如插入 3 次。有什么建议么？

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2012-09-19T20:05:46.660

```
 INSERT INTO table (a,b) VALUES (1,2), (2,3), (3,4); 
```

[http://dev.mysql.com/doc/refman/5.5/en/insert.html](http://dev.mysql.com/doc/refman/5.5/en/insert.html)

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2014-10-20T07:51:07.230

在大多数情况下，在 MySQL 中使用一条 Insert 语句插入多条记录比在 PHP 中使用 for/foreach 循环插入记录要快得多。

假设 $column1 和 $column2 是由 html 表单发布的大小相同的数组。

您可以像这样创建查询：

```
<?php
    $query = 'INSERT INTO TABLE (`column1`, `column2`) VALUES ';
    $query_parts = array();
    for($x=0; $x<count($column1); $x++){
        $query_parts[] = "('" . $column1[$x] . "', '" . $column2[$x] . "')";
    }
    echo $query .= implode(',', $query_parts);
?> 
```

如果为两条记录发布数据，则查询将变为：

> 插入表 ( `column1`, `column2`) 值 ('data', 'data'), ('data', 'data')

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2012-09-19T20:04:55.910

这里有一些方法可以做到

```
INSERT INTO pxlot (realname,email,address,phone,status,regtime,ip) 
select '$realname','$email','$address','$phone','0','$dateTime','$ip' 
from SOMETABLEWITHTONSOFROWS LIMIT 3; 
```

或者

```
INSERT INTO pxlot (realname,email,address,phone,status,regtime,ip) 
select '$realname','$email','$address','$phone','0','$dateTime','$ip'
union all select '$realname','$email','$address','$phone','0','$dateTime','$ip'
union all select '$realname','$email','$address','$phone','0','$dateTime','$ip' 
```

或者

```
INSERT INTO pxlot (realname,email,address,phone,status,regtime,ip) 
values ('$realname','$email','$address','$phone','0','$dateTime','$ip')
,('$realname','$email','$address','$phone','0','$dateTime','$ip')
,('$realname','$email','$address','$phone','0','$dateTime','$ip') 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2021-02-06T20:11:16.900

虽然使用单个`INSERT`语句插入多行通常更快，但它会导致更复杂且通常不安全的代码。下面我将介绍使用 PHP 一次性插入多条记录的最佳实践。

要将多条新行同时插入数据库，需要遵循以下 3 个步骤：

1.  开始事务（禁用自动提交模式）
2.  准备`INSERT`声明
3.  多次执行

使用数据库事务可确保将数据保存在一块并显着提高性能。

# 如何使用 PDO 正确插入多行

PDO 是 PHP 中最常见的数据库扩展选择，使用 PDO 插入多条记录非常简单。

```
$pdo = new \PDO("mysql:host=localhost;dbname=test;charset=utf8mb4", 'user', 'password', [
    \PDO::ATTR_ERRMODE => \PDO::ERRMODE_EXCEPTION,
    \PDO::ATTR_EMULATE_PREPARES => false
]);

// Start transaction
$pdo->beginTransaction();

// Prepare statement
$stmt = $pdo->prepare('INSERT 
    INTO `pxlot` (realname,email,address,phone,status,regtime,ip) 
    VALUES (?,?,?,?,?,?,?)');

// Perform execute() inside a loop
// Sample data coming from a fictitious data set, but the data can come from anywhere
foreach ($dataSet as $data) {
    // All seven parameters are passed into the execute() in a form of an array
    $stmt->execute([$data['name'], $data['email'], $data['address'], getPhoneNo($data['name']), '0', $data['regtime'], $data['ip']]);
}

// Commit the data into the database
$pdo->commit(); 
```

# 如何使用mysqli正确插入多行

mysqli 扩展使用起来有点麻烦，但操作原理非常相似。函数名称不同，参数也略有不同。

```
mysqli_report(MYSQLI_REPORT_ERROR | MYSQLI_REPORT_STRICT);
$mysqli = new \mysqli('localhost', 'user', 'password', 'database');
$mysqli->set_charset('utf8mb4');

// Start transaction
$mysqli->begin_transaction();

// Prepare statement
$stmt = $mysqli->prepare('INSERT 
    INTO `pxlot` (realname,email,address,phone,status,regtime,ip) 
    VALUES (?,?,?,?,?,?,?)');

// Perform execute() inside a loop
// Sample data coming from a fictitious data set, but the data can come from anywhere
foreach ($dataSet as $data) {
    // mysqli doesn't accept bind in execute yet, so we have to bind the data first
    // The first argument is a list of letters denoting types of parameters. It's best to use 's' for all unless you need a specific type
    // bind_param doesn't accept an array so we need to unpack it first using '...'
    $stmt->bind_param('sssssss', ...[$data['name'], $data['email'], $data['address'], getPhoneNo($data['name']), '0', $data['regtime'], $data['ip']]);
    $stmt->execute();
}

// Commit the data into the database
$mysqli->commit(); 
```

# 表现

这两个扩展都提供了使用事务的能力。使用事务执行准备好的语句极大地提高了性能，但它仍然不如单个 SQL 查询。但是，差异是如此微不足道，以至于为了简洁和干净的代码，多次执行准备好的语句是完全可以接受的。如果您需要一个更快的选项来一次将多条记录插入数据库，那么 PHP 可能不是正确的工具。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2015-07-28T13:17:16.030

如果您想插入多个值，可以说来自具有不同帖子值但要插入同一个表的多个输入，然后只需使用：

```
mysql_query("INSERT INTO `table` (a,b,c,d,e,f,g) VALUES 
('$a','$b','$c','$d','$e','$f','$g'),
('$a','$b','$c','$d','$e','$f','$g'),
('$a','$b','$c','$d','$e','$f','$g')")
or die (mysql_error()); // Inserts 3 times in 3 different rows 
```

# android - 从android数据库中检索数据

> ID：12502038
> 
> 赞同：0
> 
> 时间：2012-09-19T20:03:36.830
> 
> 标签：android, database, sqlite, android-layout

这是我从数据库中读取数据的代码。在这里，我只是接收值并使用“Toast”类打印它们。

```
public void onClickLogin(View btnLogin)
{
    String email,password;
    String[] cols = new String[] {DataBase_Server.EMAIL, DataBase_Server.PASS};
    EditText edtPassword = (EditText) findViewById(R.id.edtPassword);
    EditText edtLoginId = (EditText) findViewById(R.id.btnLogin);
    DataBase_Server database=new DataBase_Server(login.this);
    SQLiteDatabase db=database.getReadableDatabase();
    Cursor c=db.query(DataBase_Server.TABLE, null, null, null, null, null, null);
    //startManagingCursor(c);
    c.moveToFirst();
    email=c.getString(c.getColumnIndex(DataBase_Server.EMAIL));
    password=c.getString(c.getColumnIndex(DataBase_Server.PASS));
    Toast.makeText(this,email+" hello "+password, Toast.LENGTH_SHORT).show();
} 
```

代码中没有语法错误，但是当我运行我的应用程序并单击我的登录按钮时，我得到一个强制关闭对话框，最终退出我的应用程序，并且在“logcat”中我看到一些异常，如“无法打开堆栈文件......访问被拒绝”等等等等。

日志猫：

```
09-20 01:28:55.524: E/AndroidRuntime(378): java.lang.IllegalStateException: Could not execute method of the activity
09-20 01:28:55.524: E/AndroidRuntime(378):  at android.view.View$1.onClick(View.java:2031)
09-20 01:28:55.524: E/AndroidRuntime(378):  at android.view.View.performClick(View.java:2364)
09-20 01:28:55.564: E/dalvikvm(378): Unable to open stack trace file '/data/anr/traces.txt': Permission denied
09-20 01:45:58.265: E/AndroidRuntime(408): Uncaught handler: thread main exiting due to uncaught exception
09-20 01:45:58.295: E/AndroidRuntime(408): java.lang.IllegalStateException: Could not execute method of the activity
09-20 01:45:58.295: E/AndroidRuntime(408):  at android.view.View$1.onClick(View.java:2031)
09-20 01:45:58.295: E/AndroidRuntime(408):  at android.view.View.performClick(View.java:2364)
09-20 01:45:58.295: E/AndroidRuntime(408):  at android.view.View.onTouchEvent(View.java:4179)
09-20 01:45:58.295: E/AndroidRuntime(408):  at android.widget.TextView.onTouchEvent(TextView.java:6541)
09-20 01:45:58.295: E/AndroidRuntime(408):  at android.view.View.dispatchTouchEvent(View.java:3709)
09-20 01:45:58.295: E/AndroidRuntime(408):  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:884)
  09-20 01:45:58.295: E/AndroidRuntime(408):    at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:884)
    09-20 01:45:58.295: E/AndroidRuntime(408):  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:884)
     09-20 01:45:58.295: E/AndroidRuntime(408):     at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:884)
      09-20 01:45:58.295: E/AndroidRuntime(408):    at com.android.internal.policy.impl.PhoneWindow$DecorView.superDispatchTouchEvent(PhoneWindow.java:1659)
    09-20 01:45:58.295: E/AndroidRuntime(408):  at com.android.internal.policy.impl.PhoneWindow.superDispatchTouchEvent(PhoneWindow.java:1107)
     09-20 01:45:58.295: E/AndroidRuntime(408):     at android.app.Activity.dispatchTouchEvent(Activity.java:2061)
      09-20 01:45:58.295: E/AndroidRuntime(408):    at com.android.internal.policy.impl.PhoneWindow$DecorView.dispatchTouchEvent(PhoneWindow.java:1643)
    09-20 01:45:58.295: E/AndroidRuntime(408):  at android.view.ViewRoot.handleMessage(ViewRoot.java:1691)
     09-20 01:45:58.295: E/AndroidRuntime(408):     at android.os.Handler.dispatchMessage(Handler.java:99)
    09-20 01:45:58.295: E/AndroidRuntime(408):  at android.os.Looper.loop(Looper.java:123)
    09-20 01:45:58.295: E/AndroidRuntime(408):  at android.app.ActivityThread.main(ActivityThread.java:4363)
   09-20 01:45:58.295: E/AndroidRuntime(408):   at java.lang.reflect.Method.invokeNative(Native Method)
    09-20 01:45:58.295: E/AndroidRuntime(408):  at java.lang.reflect.Method.invoke(Method.java:521)
  09-20 01:45:58.295: E/AndroidRuntime(408):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:860)
  09-20 01:45:58.295: E/AndroidRuntime(408):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:618)
   09-20 01:45:58.295: E/AndroidRuntime(408):   at  dalvik.system.NativeStart.main(Native Method)
     09-20 01:45:58.295: E/AndroidRuntime(408): Caused by: java.lang.reflect.InvocationTargetException
  09-20 01:45:58.295: E/AndroidRuntime(408):    at com.example.curbrain.login.onClickLogin(login.java:36)
   09-20 01:45:58.295: E/AndroidRuntime(408):   at java.lang.reflect.Method.invokeNative(Native Method)
  09-20 01:45:58.295: E/AndroidRuntime(408):    at java.lang.reflect.Method.invoke(Method.java:521)
   09-20 01:45:58.295: E/AndroidRuntime(408):   at android.view.View$1.onClick(View.java:2026)
     09-20 01:45:58.295: E/AndroidRuntime(408):     ... 21 more
   09-20 01:45:58.295: E/AndroidRuntime(408): Caused by: java.lang.ClassCastException: android.widget.Button
   09-20 01:45:58.295: E/AndroidRuntime(408):   ... 25 more
    09-20 01:45:58.325: E/dalvikvm(408): Unable to open stack trace file '/data/anr/traces.txt': Permission denied 
```

XML 代码：

```
android:onClick="onClickLogin" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T20:25:33.383

您尝试引用您的 XML 登录 EditText 但您实际上使用了按钮的 ID：

```
 EditText edtLoginId = (EditText) findViewById(R.id.btnLogin); 
```

因此，您不能将返回的视图（按钮）转换为 EditText

该 ID 用于按钮：`R.id.btnLogin`检查您的 XML 以获取正确的 ID。

在 LogCat 中解释它的行是：

```
 09-20 01:45:58.295: E/AndroidRuntime(408): Caused by: java.lang.ClassCastException: android.widget.Button 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-19T20:25:10.237

你有一个错字。两者之间存在大小写差异：

```
android:onClick="onClickLogin" 
```

和：

```
public void OnClickLogin(View btnLogin) 
```

将您的方法更改为小写“o”：

```
public void onClickLogin(View btnLogin) 
```

* * *

我看到您更新了问题以修复此错字，但您是否检查过它是否在您的代码中？

# php - 多次检查两列SQL

> ID：12502048
> 
> 赞同：0
> 
> 时间：2012-09-19T20:04:36.010
> 
> 标签：php, mysql, sql

我有一张包含

*   ID
*   更新号

* * *

用户有一个他已经下载的 id 列表及其更新号。我只想给用户每次下载所需的 id（这些是新的 id - 他还没有下载或得到更新的 id）。我想提出一个查询，这给我带来了这个。假设用户下载了 3 个 ID。

*   第一：ID = 1，更新 = 0；
*   第二：ID = 2，更新 = 0；
*   第三：ID = 3，更新 = 0；

所以现在我在服务器上想要更新一个 id，所以用户将再次下载它，所以我将第一个 id 的更新编号设置为 1（如果它是 1，我将其设置为 2 或 3 甚至更多）。

我需要用户将发送到服务器的查询，以便仅获取必要的 ID。

我试过这个查询：

```
SELECT * FROM idtable WHERE (id <> 1 AND update <> 0) AND (id <> 2 AND update <> 0) AND (id <> 3 AND update <> 0) 
```

但这无效。（如果您正在查看示例，它应该只返回 id 号 1，因为我从服务器更新了它）。

请帮我！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T20:12:56.323

如果您想过滤掉已经与数据库版本相同的软件包，那么您可以使用：

```
SELECT * 
FROM idtable 
WHERE
    CASE id
        WHEN 1 THEN IF(update > 0, TRUE, FALSE)
        WHEN 2 THEN IF(update > 0, TRUE, FALSE)
        WHEN 3 THEN IF(update > 0, TRUE, FALSE)
        ELSE TRUE
    END 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T20:15:16.437

Assuming that you're incrementing update numbers, try something like this:

```
SELECT * FROM idtable
WHERE (
    (id = 1 AND update > 0) OR
    (id = 2 AND update > 0) OR
    (id = 3 AND update > 0)
) 
```

If your users have more than a couple IDs downloaded, you can consider creating another table with:

*   userID
*   ID
*   Update number

This way you could get all updates without adding multiple OR statements:

```
SELECT it.* FROM idtable it, userdownload ud WHERE ud.userID = it.id and ud.id = it.id and ud.update < it.update 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-19T20:11:00.413

获取要下载的 ID 的查询很简单

```
SELECT *
  FROM idtable
 WHERE update > 0 
```

该查询假定当有新内容要更新时，您只需将更新列切换为 1。

现在，如果您的问题是关于如何*更新*表以便将下一个非更新行变为 1，那么它就是另一回事了。

* * *

如果您将“更新”（我确定它是一个正确的名称）列更新为版本号，那么您的表结构应该类似于：

```
user_id int
version int
downloaded_version int 
```

这样当用户下载一个版本时，您更新`downloaded_version`以匹配`version`他们刚刚更新的版本。下一次，你更新`version`到`version+1`. 查找更新的查询变为：

```
SELECT *
  FROM idtable
 WHERE user_id = <userid>
   AND version > downloaded_version 
```

# spring - Spring security http-form 重定向到 404 页面

> ID：12502054
> 
> 赞同：0
> 
> 时间：2012-09-19T20:04:52.437
> 
> 标签：spring, spring-security

我需要在我的 webapp 中添加 spring 安全性。我的应用程序在管理部分使用 spring 和 vaadin。我正在使用表单登录作为身份验证模式。所以我正在努力解决的问题是，当我尝试发布以下表格时：

```
<form name='f' action="j_spring_security_check"
    method='POST'>

    <table>
        <tr>
            <td>User:</td>
            <td><input type='text' name='j_username' value=''>
            </td>
        </tr>
        <tr>
            <td>Password:</td>
            <td><input type='password' name='j_password' />
            </td>
        </tr>
        <tr>
            <td colspan='2'><input name="submit" type="submit"
                value="submit" />
            </td>
        </tr>
        <tr>
            <td colspan='2'><input name="reset" type="reset" />
            </td>
        </tr>
    </table>

</form> 
```

我得到一个 404 重定向。所以在这里我粘贴我的 web.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app version="2.5" xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd">

    <!-- The definition of the Root Spring Container shared by all Servlets and Filters -->
    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/spring/root-context.xml</param-value>
    </context-param>

    <context-param>
        <description>Vaadin production mode</description>
        <param-name>productionMode</param-name>
        <param-value>false</param-value>
    </context-param>

    <!-- Enables Spring Security -->
    <filter>
        <filter-name>springSecurityFilterChain</filter-name>
        <filter-class>
            org.springframework.web.filter.DelegatingFilterProxy
        </filter-class>
    </filter>
    <filter-mapping>
        <filter-name>springSecurityFilterChain</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>

    <!-- Enables Spring internationalization -->
    <filter>
        <filter-name>encoding-filter</filter-name>
        <filter-class>
            org.springframework.web.filter.CharacterEncodingFilter
        </filter-class>
        <init-param>
            <param-name>encoding</param-name>
            <param-value>UTF-8</param-value>
        </init-param>
    </filter>

    <filter-mapping>
        <filter-name>encoding-filter</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>

    <!-- Creates the Spring Container shared by all Servlets and Filters -->
    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>

    <!-- Processes application requests -->
    <servlet>
        <servlet-name>appServlet</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <init-param>
            <param-name>contextConfigLocation</param-name>
            <param-value>/WEB-INF/spring/appServlet/servlet-context.xml</param-value>
        </init-param>
        <load-on-startup>1</load-on-startup>
    </servlet>

    <servlet>
        <servlet-name>Vaadin Application Servlet</servlet-name>
        <servlet-class>com.vaadin.terminal.gwt.server.ApplicationServlet</servlet-class>
        <init-param>
            <description>Vaadin application class to start</description>
            <param-name>application</param-name>
            <param-value>com.windy.server.admin.MyVaadinApplication</param-value>
        </init-param>
    </servlet>

    <servlet-mapping>
        <servlet-name>Vaadin Application Servlet</servlet-name>
        <url-pattern>/admin/*</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>Vaadin Application Servlet</servlet-name>
         <url-pattern>/VAADIN/*</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>appServlet</servlet-name>
        <url-pattern>*.do</url-pattern>
    </servlet-mapping>

    <error-page>
        <error-code>404</error-code>
        <location>/WEB-INF/views/page404.jsp</location>
    </error-page> 

</web-app> 
```

这里是我的弹簧安全配置：

```
<security:http authentication-manager-ref="authenticatioManager" auto-config="true" pattern="/web/**">
    <security:intercept-url pattern="/web/**" access="ROLE_AUTH" />
    <security:form-login login-page="/loginTest.do" default-target-url="/loginWelcome.do"
        authentication-failure-url="/loginfailed.do" />
    <security:logout logout-success-url="/logout.do" invalidate-session="true"/> 
    <security:session-management>
        <security:concurrency-control max-sessions="1" error-if-maximum-exceeded="true" expired-url="/web/login" />
    </security:session-management>
</security:http>

<bean id="userDetailsService" class="com.ddelizia.server.service.core.impl.UserDetailsServiceImpl"/>

<security:authentication-manager id="authenticatioManager">
  <security:authentication-provider user-service-ref="userDetailsService">
    <!-- <security:password-encoder hash="md5"/> -->
  </security:authentication-provider> 
</security:authentication-manager> 
```

我还尝试将参数 login-processing-url="/login_spring" 添加到表单登录中，并将表单操作更改为 login_spring

我的应用程序在地址为 localhost:8080/myapp 的 tomcat 上运行，并且在 localhost:8080/myapp/login_spring 上调用了登录操作，但我仍然收到相同的错误。

我还尝试修改我的 web.xml，更改 spring 安全过滤器映射，如下所示：

```
 <filter-mapping>
        <filter-name>springSecurityFilterChain</filter-name>
        <url-pattern>*.log</url-pattern>
    </filter-mapping> 
```

并更改 login-processing-url="/login_spring.log" 但我仍然得到 404 页面。

然后我尝试切换到http-basic authentcation，但在这种情况下它可以工作......我不明白我做错了什么......

在此先感谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T20:11:26.137

将您的表单元素更改为：

```
<form name='f' action='<c:url value="/j_spring_security_check" />' method='POST'> 
```

如果您没有 JSTL Core taglib，请在文件开头添加：

```
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%> 
```

**编辑**：

我想我发现了问题的根源。`pattern="/web/**"`从`<http>`元素中移除，只留下`<security:http authentication-manager-ref="authenticatioManager" auto-config="true">`.

更重要的是，`j_spring_security_check` **必须**在`springSecurityFilterChain`，所以将映射更改为：

```
<filter-mapping>
    <filter-name>springSecurityFilterChain</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping> 
```

现在尝试不使用`login-processing-url`in`<form-login>`但使用`<c:url>`. 我们的 Vaadin 应用程序中有类似的配置，它工作得很好。

# graph - 网络流图所有可能的路径

> ID：12502057
> 
> 赞同：-2
> 
> 时间：2012-09-19T20:05:05.903
> 
> 标签：graph, network-flow

如何在有向图中找到从源（S）到汇（S）的所有可能路径？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T20:18:23.103

我假设这是家庭作业，所以我不会给出完整的答案，但我会说，如果不是全部，咨询大多数（如果不是全部）介绍性图论教科书会给你一个答案。想想如何找到两个顶点之间的路径数，它们的长度分别为 1 跳、2 跳、3 跳等。

# windows - How can I backup a 13 GB SVN repository? The dump is 100+ GB

> ID：12502058
> 
> 赞同：6
> 
> 时间：2012-09-19T20:05:10.693
> 
> 标签：windows, svn, backup, visualsvn-server

I have about a dozen repositories that on the file system are 1 GB to 10 GB in size, and I need to set up automated backups for all of them (our old backup scripts got lost when a computer went down) with our XP 64-bit machines.

After reading [this question](https://stackoverflow.com/questions/33055) about the best way to back up SVN repos, I started dumping the biggest repo we have, which is about 13 GB. This command has been executing for ~2.5 hours now, and it's currently dumping revision ~200 of 300+.

```
svnadmin --deltas \\path\to\repo\folder > \\path\to\backup\folder\dump.svn 
```

The dump file is over 100 GB and counting. I know I can 7-zip this sucker, but 100 GB?! ... o_O

The repositories contain a large amount of binary data, which could be part of the problem, but as of right now, switching to a more efficient version control system (assuming there is one) is not realistic; SVN is a part of life here.

I've considered using hotcopy, which takes up a lot less space, but I tried using one of our old hotcopy-ed backups, and subversion 1.7 couldn't find a bunch of files it needed. It seems that I'd have to install the version of SVN that originally hotcopy-ed the repo, and dump that repo to get it into a newer SVN. This statement seems to verify the problem I'm having with hotcopy: [http://svn.haxx.se/users/archive-2005-05/0842.shtml](http://svn.haxx.se/users/archive-2005-05/0842.shtml)

I feel like I've just *got* to be missing something. Maybe there's some flag for dump that magically makes the dump 1/5 the size...

Do I have any other options?

* * *

UPDATE: The last revision, #327, was just dumped. The final size of the dump file is 127 GB. That's from a 13.5 GB repo. I have probably roughly 3X that much in all of my repositories combined.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-19T21:31:41.667

For daily backup I would say you really don't need to do an `svnadmin dump`. I would use the dump method if you were about to transfer the repository to a new server which may be running a different SVN version and OS as it's the most portable way of dumping the repository, but it's not very space-efficient.

I'd recommend using the hotcopy methods referred to that link. That will guarantee that the state of the filesystem is consistent, and will also copy the configuration files and hook scripts (incidentally the svnadmin dump *doesn't* copy these, so you'll end up with an incomplete backup). Because it's just a direct copy of the repository, it's the same size so the backup should be much more manageable.

In an emergency, if you need to restore a backup done from a hotcopy then all you should need are a machine with the same major version of SVN (e.g. 1.6 or 1.7) and to be safe, the same OS. You *should* be then able to use this repository directly, or you can do an `svnadmin dump` at this point to transfer to a new server.

EDIT: comparison of svnsync and hotcopy:

common aspects:

*   Safely deals with repository writes during backup
*   Size of backup = size of repository

Advantages of hotcopy:

*   Easier to set up
*   Backs up hooks and config files

Advantages of svnsync:

*   Allows backup onto a different machine
*   Only new revisions since last sync are written so the sync is very quick and this means that you can do very compact incremental backups

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-19T22:09:00.060

Thanks to the suggestions of bahrep and the_mandrill, I decided to go with svnsync for these repositories. I was able to get it set up quite easily, and since we don't have any hooks or config files, there's nothing else to back up. Because of the problems I had with hotcopy (thanks to the_mandrill for proposing a solution to these issues) I decided that svnsync would be the simpler solution for us.

In addition to what the_mandrill pointed out, svnsync has other advantages:

*   In the event that the main repository goes down, users can download from the backup repository as long as they have the link.
*   The backups are fully-version controlled. My boss asked me to do nightly backups, but keep only those backups that are one week old. To do that with hotcopy, I'd have to write a script. With svnsync, I don't have to worry about any of that.

To set up svnsync, I had to complete the following steps. Excuse any typos. All of our repositories are hosted using VisualSVN Server.

1.  Create a new, empty repository:

    `svnadmin create \\computerB\C$\repositories\mirror`

2.  Create the file, `\mirror\hooks\pre-revprop-change.bat`. It's only content is this one line:

    `exit 0`

3.  Initialize the sync

    `svnsync init https://computerB.domain.net/svn/mirror https://computerA.domain.net/svn/repo`

4.  Synchronize the two repos

    `svnsync synchronize https://computerB.domain.net/svn/mirror https://computerA.domain.net/svn/repo`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-03-24T12:37:53.877

Beginning with VisualSVN Server 3.6, you can use [`Backup-SvnRepository`](https://www.visualsvn.com/support/topic/00088/#Backup-SvnRepository) PowerShell cmdlet to make a backup of Subversion repository. To restore the repository from backup, use [`Restore-SvnRepository`](https://www.visualsvn.com/support/topic/00088/#Restore-SvnRepository) cmdlet.

What is more, the Enterprise Edition of the server offers a [scheduled backup feature](https://www.visualsvn.com/server/features/backup/). The built-in scheduled backup [supports several backup types including **incremental backups**](https://www.visualsvn.com/support/topic/00108/) that are efficient in terms of storage space and time required to take the backup.

# php - 需要点击导航栏中的链接，将其传递给隐藏表单

> ID：12502060
> 
> 赞同：2
> 
> 时间：2012-09-19T20:05:14.803
> 
> 标签：php, javascript, forms

我根本不是程序员。我可以通过复制我看到的示例来修改奇怪的文件，通过松散地破译正在发生的事情，但如果你说“开始编程”，我不会有丝毫线索。所以，我希望有人可以帮我解决这个问题:)

我有一个 PHP 文件，其中有一个包含星期几的导航栏。我需要对其进行设置，以便当用户在导航栏中单击一周中的某一天时，将“ddate”表单变量设置为那一天，然后提交隐藏的表单。

这是我到目前为止所得到的——一些代码来自预先存在的代码：

```
<div class="day-input-form">
        <form action="<?php ?>" method="post" name="dayform">
            <input type="hidden" name="ddate" id="ddate" size="11" maxlength="10" value="<?php echo JText::_( "SELECTINPT" ); ?>" />
            <?php echo JHTML::_( 'form.token' ); ?>
        </form>
    </div>

    <div id="navcontainer">

    <ul id="navlist">
    <?php if($currentday=="Monday") : ; ?>
    <li class="currentday"><?php echo $currentday; ?></li>
    <?php else : ?>
    <li><a href="#Monday">Monday</a></li>
    <?php endif; ?>

    <?php if($currentday=="Tuesday") : ; ?>
    <li class="currentday"><?php echo $currentday; ?></li>
    <?php else : ?>
    <li><a href="#Tuesday">Tuesday</a></li>
    <?php endif; ?>

    <?php if($currentday=="Wednesday") : ; ?>
    <li class="currentday"><?php echo $currentday; ?></li>
    <?php else : ?>
    <li><a href="#Wednesday">Wednesday</a></li>
    <?php endif; ?>

    <?php if($currentday=="Thursday") : ; ?>
    <li class="currentday"><?php echo $currentday; ?></li>
    <?php else : ?>
    <li><a href="#Thursday">Thursday</a></li>
    <?php endif; ?>

    <?php if($currentday=="Friday") : ; ?>
    <li class="currentday"><?php echo $currentday; ?></li>
    <?php else : ?>
    <li><a href="#Friday">Friday</a></li>
    <?php endif; ?>

    <?php if($currentday=="Saturday") : ; ?>
    <li class="currentday"><?php echo $currentday; ?></li>
    <?php else : ?>
    <li><a href="#Saturday">Saturday</a></li>
    <?php endif; ?>

    <?php if($currentday=="Sunday") : ; ?>
    <li class="currentday"><?php echo $currentday; ?></li>
    <?php else : ?>
    <li><a href="#Sunday">Sunday</a></li>
    <?php endif; ?>

    </ul>
</div> 
```

谁能给我一个正确的方向？这将不胜感激。请记住，正如我所说，我不是程序员，但我只是勇敢地尝试理解这一切:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T20:15:12.313

This should do the trick (I'm using jquery)

```
$(document).ready(function() {
    $(".navcontainer").find("a").click(function() {
        var form = $("form[name='dayform']");
        form.find("input[name='ddate']").val($(this).attr("href"));
        form.submit();
    });
});​ 
```

Here is an example in jsfiddle [http://jsfiddle.net/tFw4Q/12/](http://jsfiddle.net/tFw4Q/12/)

# google-analytics - 从 API 获取 Google Analytics“访客流量”数据

> ID：12502062
> 
> 赞同：15
> 
> 时间：2012-09-19T20:05:21.217
> 
> 标签：google-analytics, google-analytics-api, recommendation-engine

我正在尝试从 Google Analytics 收集信息，以便为我的网站构建推荐引擎。该网站由许多页面组成，因此我正在跟踪用户点击的次数，例如，从页面 A 到页面 B。目前我可以使用 和 来衡量 Google Analytics 上的转换`A -> B`，但我真的想回答这个问题是，“在包括查看页面 A 的所有网站访问中，页面 B、C……在同一次访问中被查看了多少次？”`previousPagePath = '/A'``nextPagePath = '/B'`

例如，如果流量是`A -> homepage -> B`，那么我当前的方法不会捕捉到它，而是会被更广泛的测量捕捉到。看起来 Google Analytics（分析）网络界面上的“访问者流量”报告包含我正在寻找的数据，但我不知道如何通过 API 以编程方式访问它。

获取这些数据的最佳方式是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-05-15T13:49:52.603

这真是个好主意。我对此有点晚了，但是您应该能够通过使用 Google Analytics Reporting API 下载所有数据来完成此操作，将其存储在本地数据库/文件/任何内容中，然后通过聚合来构建您的推荐引擎手动统计并将其存储在本地。

要从 Reporting API 获取数据，请尝试使用[查询资源](http://ga-dev-tools.appspot.com/explorer/)管理器并使用类似于 @carlsoja 的方法提取所有路径对之间的页面访问次数：

```
dimensions=ga:previousPagePath,ga:pagePath&metrics=ga:visits 
```

为了获取所有数据，您必须使用[核心报告客户端库](https://developers.google.com/analytics/devguides/reporting/core/v3/gdataLibraries)之一对结果进行分页（您可以在[查询资源](https://developers.google.com/analytics/devguides/reporting/core/v3/gdataLibraries)管理器中进行试验）。

一旦你有了所有的数据，你就可以很容易地计算出一个人在访问 page后访问 page 的[马尔可夫链转移概率](http://en.wikipedia.org/wiki/Markov_chain)，或者. 然后，如果某人在过去某个时间访问过页面，那么估计他们访问页面的概率将非常简单。如果你想变得非常花哨，你可以使用他们的完整历史通过估计来为页面提出建议，但我会把它作为练习留给读者;）`/A``/B``p(/A | /B)``/A``/B``{H}``p(/A | {H})`

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T02:52:37.287

您是否有任何理由不能简单地对查看页面 A 的人进行细分并使用 pagePath / pageTitle 作为维度并返回访问次数作为指标？

```
dimensions=ga:pagePath&metrics=ga:visits&segment=dynamic::ga:pagePath=~A 
```

从理论上讲，这应该列出在与 pagePath=~A 相同的访问中查看的所有 pagePaths 以及查看两者的访问次数，这就是您要查找的内容，是吗？

# c++ - 超高清 tx_waveforms

> ID：12502064
> 
> 赞同：0
> 
> 时间：2012-09-19T20:05:27.407
> 
> 标签：c++, usrp

在 ettus research 提供的 USRP 传输波形示例代码中，可在此处找到： [tx_waveforms](http://code.ettus.com/redmine/ettus/projects/uhd/repository/revisions/d7a353461100be58eb973532ff2c1b7ddaddda52/entry/host/examples/tx_waveforms.cpp)

第 44 行：

```
static const size_t wave_table_len = 8192; 
```

选择该值是否有任何具体原因。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T21:42:46.990

我确定有，但我认为编写该代码的人可能能够更好地回答这个问题。也许它与特定硬件缓冲区的大小有关，或者只是打算成为系统页面大小的某个倍数，或者是基于特定采样率的方便时间长度，以产生合理的音调而没有过多的伪影，或者...... . 许多其他原因。

我想您可以复制代码，更改值，然后查看是否有任何问题...

# ios - 我们可以在 iOS 中修改 UIViewController 属性吗？

> ID：12502070
> 
> 赞同：0
> 
> 时间：2012-09-19T20:06:02.900
> 
> 标签：ios, cocoa-touch, uiinterfaceorientation

iOS 有一个预先声明的属性，如下所示：

```
@property(nonatomic, readonly) UIInterfaceOrientation interfaceOrientation; 
```

我可以为我的项目修改它`@property(nonatomic) UIInterfaceOrientation interfaceOrientation;`，然后`interfaceOrientation`在我的类的不同控制器方法中为“”变量分配不同的值吗？

如果我修改现有属性是否会产生问题？

另外，在谷歌搜索时，我在某处读到，如果 @property(nonatomic) 未使用“readonly”关键字声明，则默认情况下它是读写的。此规则是否仅适用于开发人员定义的属性而不适用于预定义的属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T20:09:43.337

不，如果它是只读的，那是有原因的。要提供不同的行为，您应该继承`UIViewController`并覆盖指定的方法[[1]](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIViewController_Class/Reference/Reference.html#//apple_ref/occ/instm/UIViewController/preferredInterfaceOrientationForPresentation) [[2]](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIViewController_Class/Reference/Reference.html#//apple_ref/occ/instm/UIViewController/supportedInterfaceOrientations)：

```
- (NSUInteger)supportedInterfaceOrientations
- (UIInterfaceOrientation)preferredInterfaceOrientationForPresentation 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-19T20:13:58.663

不幸的是，这是不可能的。由于 Cocoa Touch 是基于设计模式构建的（在我们的例子中是 Open Close Principle，更多信息请参见[http://www.oodesign.com/open-close-principle.html](http://www.oodesign.com/open-close-principle.html)），这将违反其中之一。您可以添加更多功能/特性，但不能修改现有功能/特性。希望有帮助

# c++ - SSE、内在函数和对齐

> ID：12502071
> 
> 赞同：26
> 
> 时间：2012-09-19T20:06:06.967
> 
> 标签：c++, alignment, sse, intrinsics

我使用大量 SSE 编译器内在函数编写了一个 3D 矢量类。一切都很好，直到我开始将具有 3D 矢量的类作为 new 的成员。我在发布模式下遇到了奇怪的崩溃，但在调试模式下却没有，反之亦然。

所以我阅读了一些文章，并认为我需要将拥有 3D 矢量类实例的类也对齐到 16 个字节。所以我只是在类前面添加了`_MM_ALIGN16`（`__declspec(align(16)`），如下所示：

```
_MM_ALIGN16 struct Sphere
{
    // ....

    Vector3 point;
    float radius
}; 
```

起初这似乎解决了这个问题。但是在更改了一些代码之后，我的程序又开始以奇怪的方式崩溃。我在网上搜索了一些，发现了[一篇博客](http://ernsthot.blogspot.de/2009/03/diving-into-sse-alignment-issues.html)文章。我尝试了作者 Ernst Hot 解决问题的方法，它也对我有用。我在我的类中添加了 new 和 delete 运算符，如下所示：

```
_MM_ALIGN16 struct Sphere
{
    // ....

    void *operator new (unsigned int size)
     { return _mm_malloc(size, 16); }

    void operator delete (void *p)
     { _mm_free(p); }

    Vector3 point;
    float radius
}; 
```

Ernst 提到这种方法也可能存在问题，但他只是链接到一个不再存在的论坛，而没有解释为什么它可能存在问题。

所以我的问题是：

1.  定义运算符有什么问题？

2.  为什么添加`_MM_ALIGN16`到类定义中还不够？

3.  处理 SSE 内在函数带来的对齐问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-09-20T12:08:17.777

首先，您必须注意两种类型的内存分配：

*   静态分配。要使自动变量正确对齐，您的类型需要正确的对齐规范（例如`__declspec(align(16))`,`__attribute__((aligned(16)))`或 your `_MM_ALIGN16`）。但幸运的是，仅当类型成员（如果有）给出的对齐要求不充分时，您才需要这样做。所以你不需要这个`Sphere`，因为你`Vector3`已经正确对齐了。如果你`Vector3`包含一个`__m128`成员（这很可能，否则我建议这样做），那么你甚至不需要它`Vector3`。因此，您通常不必弄乱编译器特定的对齐属性。

*   动态分配。简单的部分就这么多。问题是，C++ 在最低级别上使用了一个与类型无关的内存分配函数来分配任何动态内存。这只能保证所有标准类型的正确对齐，这可能恰好是 16 个字节，但不能保证。

    为此，您必须重载内置`operator new/delete`函数以实现您自己的内存分配，并在后台使用对齐的分配函数而不是 good old `malloc`。重载`operator new/delete`本身就是一个主题，但并不像起初看起来那么困难（尽管您的示例还不够），您可以在[这个出色的常见问题解答](https://stackoverflow.com/q/7194127/743214)中阅读有关它的内容。

    不幸的是，您必须为每种类型的任何成员都需要非标准对齐方式执行此操作，在您的情况下，`Sphere`和`Vector3`. 但是你可以做的让它更容易一点，就是为这些运算符创建一个具有适当重载的空基类，然后从这个基类派生所有必要的类。

    大多数人有时会忘记的是，标准分配器`std::alocator`使用全局`operator new`分配所有内存，因此您的类型不适用于标准容器（并且`std::vector<Vector3>`用例并不罕见）。您需要做的是制作自己的标准符合分配器并使用它。但是为了方便和安全，实际上最好只`std::allocator`针对您的类型进行专门化（也许只是从您的自定义分配器派生它），以便始终使用它，并且您无需在每次使用`std::vector`. 不幸的是，在这种情况下，您必须再次为每个对齐的类型专门化它，但是一个小的 evil 宏可以帮助解决这个问题。

    此外，您必须使用全局而不是您的自定义来寻找其他事物`operator new/delete`，例如`std::get_temporary_buffer`and `std::return_temporary_buffer`，并在必要时照顾这些事物。

不幸的是，我认为还没有更好的方法来解决这些问题，除非你在一个原生与 16 对齐的平台上**并且知道这一点**。或者您可能只是重载全局`operator new/delete`以始终将每个内存块对齐到 16 个字节，并且无需关心包含 SSE 成员的每个类的对齐，但我不知道这种方法的含义。在最坏的情况下，它只会导致浪费内存，但是你通常不会在 C++ 中动态分配小对象（尽管可能对此有不同的看法）`std::list`。`std::map`

所以总结一下：

*   使用类似的东西注意静态内存的正确对齐`__declspec(align(16))`，但前提是它还没有被任何成员照顾，这通常是这种情况。

*   `operator new/delete`具有非标准对齐要求的成员的每种类型的重载。

*   制作一个符合标准的定制分配器，以在对齐类型的标准容器中使用，或者更好的是，专门`std::allocator`针对每个对齐类型。

* * *

最后是一些一般性的建议。在执行许多向量运算时，您通常只能在计算量大的块中从 SSE 中获利。为了简化所有这些对齐问题，特别是关心每个包含 a 的类型的对齐问题，`Vector3`制作一个特殊的 SSE 向量类型并且只在冗长的计算中使用它可能是一个很好的方法，使用正常的非用于存储和成员变量的 SSE 向量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-20T09:49:08.847

基本上，您需要确保您的向量正确对齐，因为 SIMD 向量类型通常比任何内置类型具有更大的对齐要求。

这需要做以下事情：

1.  确保`Vector3`它在堆栈或结构的成员上时正确对齐。这是通过应用于`__attribute__((aligned(32)))`类`Vector3`（或编译器支持的任何属性）来完成的。请注意，您不需要将属性应用于包含 的结构`Vector3`，这不是必需的，而且还不够（即无需将其应用于`Sphere`）。

2.  在使用堆分配时，确保它`Vector3`或其封闭结构正确对齐。这是通过使用`posix_memalign()`（或您的平台的类似函数）而不是使用plain 来完成的，`malloc()`或者`operator new()`因为后两者为内置类型（通常为8 或16 字节）对齐内存，这不能保证对于SIMD 类型来说足够。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-20T08:24:03.943

1.  运营商的问题在于*它们本身*是不够的。它们不会影响您仍然需要的堆栈分配`__declspec(align(16))`。

2.  `__declspec(align(16))`影响编译器如何将对象放入内存中，当且仅当它有选择时。对于新的对象，编译器别无选择，只能使用`operator new`.

3.  理想情况下，使用本机处理它们的编译器。没有理论上的理由说明他们需要区别对待`double`。否则，请阅读编译器文档以了解解决方法。每个有缺陷的编译器都有自己的一组问题，因此也有自己的一组解决方法。

# java - 使用处理程序发送消息而无需排队或延迟

> ID：12502073
> 
> 赞同：0
> 
> 时间：2012-09-19T20:06:16.997
> 
> 标签：java, android, handler, pusher

我正在尝试使用处理程序将消息从一个线程发送到我的 UI 线程。我正在使用 pusher API (pusher.com) 发送消息。他们进来了，我可以看到他们进来的速度非常快，但是 UI 线程需要一段时间才能通过处理程序获取消息，并将它们排队而不是在有东西进来时立即发送和释放。

有没有更好的方法在没有处理程序的情况下执行此操作，或者有一种方法可以摆脱队列，以便一旦消息进入处理程序就可以处理它？

这是发送已进入线程的消息

```
public void onEvent(String eventName, String eventData, String channelName) {

                  String sentence = new String(eventData); 
                  try {

                      Message msg = new Message();
                      Bundle b = new Bundle();
                      b.putString("message",sentence);
                      msg.setData(b);
                      // send message to the handler with the current message handler
                      mHandler.sendMessage(msg);
                           } catch (Exception e) {
                      Log.v("Error", e.toString());

                           }
                  Log.e("server Thread", eventData);
               // mHandler.obtainMessage(MakeLightActivity.PACKET_CAME,sentence).sendToTarget(); 

              } 
```

这就是我在我的 UI 线程中阅读它的地方

```
private final Handler mHandler = new Handler() {
    @Override
    public void handleMessage(Message msg) {

            Bundle b = msg.getData();
           String key = b.getString("message");
          incomingMessage =  key;
            if (key.length() >= 30){

                Log.d(TAG, "key" + key);
            messageCame(key);
            }

        }

}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T20:17:26.260

Yes there's a better way You must use an `AsyncTask` which handles the thread and the Handler's functionality.

```
private AsyncTask<Params, Progress, Result> imageLoader = new AsyncTask<Params, Progress, Result>()
{
    @Override
    protected Result doInBackground(Params)
    {
        // do the work and onPostExecute will handle the result
        return result; 
    };

    protected void onPostExecute(Result result)
    {
        // do whatever with the result on the UI thread instead of a Handler
    }

}; 
```

# c - 替代没有 32Gb 内存限制的 valgrind？

> ID：12502077
> 
> 赞同：3
> 
> 时间：2012-09-19T20:06:33.587
> 
> 标签：c, debugging

我是 valgrind 的忠实粉丝，并且广泛使用它来捕获代码中的错误。但是现在我遇到了一个只在特定情况下出现的错误，这需要我的程序 malloc/使用超过 32Gb 的 RAM（实际上大约 37），并且 valgrind 有一个硬编码的限制，它说它不会让你分配超过 32Gb。我设法在网上找到了一些帖子，其中人们列出了对 valgrind 的各种代码修改，这应该允许您扩展此限制，但是它们似乎不起作用，或者它们似乎正在修改不同的（和未指定的）版本瓦尔格林。无论如何，我并不热衷于在 valgrind 内部进行黑客攻击，所以我开始寻找其他选择。

Clang/AddressSanitizer 似乎是一个不错的选择，但不幸的是，这里也有一个问题，因为我大量使用了嵌套函数。所以，我的问题是 - 有谁知道 valgrind 的替代品（在 64 位 linux 上）没有 valgrind 的 32Gb 内存分配限制？

Ideas v 欢迎最好的 Zam

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T11:54:56.860

现在 gcc 主干中提供了 AddressSanitizer 的 gcc 变体（很快将是 4.8）。它还没有clang版本那么成熟，但你可以试试。

```
% cat use-after-free.cc 
#include <stdlib.h>
int main() {
  char *x = (char*)malloc(10 * sizeof(char));
  free(x);
  return x[5];
}
% g++ --version | head -1 
g++ (GCC) 4.8.0 20130216 (experimental)

% g++ -fsanitize=address -static-libasan  use-after-free.cc && ./a.out 2>&1 | asan_symbolize.py 
=================================================================
==9817== ERROR: AddressSanitizer: heap-use-after-free on address 0x60040000dff5 at pc 0x4179c3 bp 0x7fffe046af30 sp 0x7fffe046af28
READ of size 1 at 0x60040000dff5 thread T0
    #0 0x4179c2 in main ??:0
    #1 0x7f469c8dc76c in __libc_start_main /build/buildd/eglibc-2.15/csu/libc-start.c:226
    #2 0x402098 in _start ??:0
0x60040000dff5 is located 5 bytes inside of 10-byte region [0x60040000dff0,0x60040000dffa)
freed by thread T0 here:
    #0 0x40f18a in free ??:0
    #1 0x417980 in main ??:0
    #2 0x7f469c8dc76c in __libc_start_main /build/buildd/eglibc-2.15/csu/libc-start.c:226
previously allocated by thread T0 here:
    #0 0x40f26a in malloc ??:0
    #1 0x417970 in main ??:0
    #2 0x7f469c8dc76c in __libc_start_main /build/buildd/eglibc-2.15/csu/libc-start.c:226 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T09:01:37.923

还有一个适用于 Linux 和 Windows 的开源内存调试器。它被称为[“记忆博士”](http://www.drmemory.org)。我不知道它是否有上限（如 valgrind），但也许你应该尝试一下。

# json - Facebook Graph API JSON 结果有 Page Next，尽管没有更多数据

> ID：12502080
> 
> 赞同：2
> 
> 时间：2012-09-19T20:06:37.937
> 
> 标签：json, facebook-graph-api

我想知道这是 Facebook 错误还是我做错了什么。无论如何，我正在开发一个服务器应用程序，它通过 Graph API 调用与我自己的简单 Facebook 应用程序对话。出于开发目的，Facebook 应用程序的唯一用户是我定义的几个***测试用户。***在这种情况下，我有一个测试用户“Lisa Mills”，我想返回她的朋友列表。她唯一的朋友是“约翰·史密斯”。我使用 Graph API HTTPS 调用来检索她的朋友列表，就像这样（链接可能不再有效，但出于说明目的将它们发布在这里）：

```
https://graph.facebook.com/100004330990794/friends?access_token=AAAGGG3niQkQBAPne8jGOcfZAUZCiqbgDMAPV0QlA5GMGorFdEZCOBAX3daZAOkcWmenyfFwYzuBCxrE2gEOXaZAa7tJptZBE826vvHdw7JtCZB0If9mJ041 
```

结果数据：

```
{
   "data": [
      {
         "name": "John Smith",
         "id": "100004375356845"
      }
   ],
   "paging": {
      "next": "https://graph.facebook.com/100004330990794/friends?access_token=AAAGGG3niQkQBAPne8jGOcfZAUZCiqbgDMAPV0QlA5GMGorFdEZCOBAX3daZAOkcWmenyfFwYzuBCxrE2gEOXaZAa7tJptZBE826vvHdw7JtCZB0If9mJ041&limit=5000&offset=5000&__after_id=100004375356845"
   }
} 
```

令人费解的是，为什么 JSON 响应包含“下一页”值，因为 Lisa 不会有任何其他朋友返回。无论如何，如果我转到 JSON 中指定的 URI，我会收到以下响应：

```
{
   "data": [
   ],
   "paging": {
      "previous": "https://graph.facebook.com/100004330990794/friends?limit=5000&offset=0&access_token=AAAGGG3niQkQBAPne8jGOcfZAUZCiqbgDMAPV0QlA5GMGorFdEZCOBAX3daZAOkcWmenyfFwYzuBCxrE2gEOXaZAa7tJptZBE826vvHdw7JtCZB0If9mJ041"
   }
} 
```

当然……没有数据返回。我自然会假设，如果 Lisa 有超过 5000 个朋友，这个“下一页”应该只有额外的数据。这是 Facebook 的 Graph API 中的错误，还是我的服务器应用程序需要正确处理的正常情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-20T10:17:13.303

# c# - 时间：2019-03-01 标签：c#send post data with javascript field

> ID：12502087
> 
> 赞同：1
> 
> 时间：2012-09-19T20:07:01.153
> 
> 标签：c#, javascript, http, post, httpwebresponse

我的按钮上绑定了这样的代码

```
private String readHtmlPage2(string url)
        {

            //setup some variables

            String country = "6";
            String city = "95";
            String lang = "17";
            String wtf = "ctl00$tresc$upPlacowka|ctl00$tresc$cbListaPlacowek";

            //setup some variables end

            String result = "";
            String strPost = "ctl00$tresc$cbListaKrajow=" + country + "&ctl00$tresc$cbListaPlacowek=" + city + "&ctl00$ddlWersjeJezykowe=" + lang + "&ctl00$tresc$ScriptManager1" + wtf;
            StreamWriter myWriter = null;

            HttpWebRequest objRequest = (HttpWebRequest)WebRequest.Create(url);
            objRequest.Method = "POST";
            objRequest.ContentLength = strPost.Length;
            objRequest.ContentType = "application/x-www-form-urlencoded";

            try
            {
                myWriter = new StreamWriter(objRequest.GetRequestStream());
                myWriter.Write(strPost);
            }
            catch (Exception e)
            {
                return e.Message;
            }
            finally
            {
                myWriter.Close();
            }

            HttpWebResponse objResponse = (HttpWebResponse)objRequest.GetResponse();
            using (StreamReader sr =
               new StreamReader(objResponse.GetResponseStream()))
            {
                result = sr.ReadToEnd();

                // Close and clean up the StreamReader
                sr.Close();
            }
            return result;
        }

        public static string PostData(string file, string data)
        {
            HttpWebRequest request = (HttpWebRequest)WebRequest.Create(file);
            request.Method = "POST";
            request.AllowAutoRedirect = true;
            request.ContentType = "application/x-www-form-urlencoded";
            byte[] EncodedPostParams = Encoding.UTF8.GetBytes(data);
            request.ContentLength = EncodedPostParams.Length;
            request.GetRequestStream().Write(EncodedPostParams,
                                             0,
                                             EncodedPostParams.Length);
            request.GetRequestStream().Close();
            HttpWebResponse response = (HttpWebResponse)request.GetResponse();
            string html = new StreamReader(response.GetResponseStream(),
                                           Encoding.UTF8).ReadToEnd();
            return html;
        } 
```

我需要在我们的页面上发送帖子数据，但主要问题是表单是动态的，某些字段看起来像这样：

```
<select name="ctl00$tresc$cbListaKrajow" onchange="javascript:setTimeout('__doPostBack(\'ctl00$tresc$cbListaKrajow\',\'\')', 0)" id="ctl00_tresc_cbListaKrajow" style="width:400px;">
    <option value="-1"></option>
    <option selected="selected" value="6">Białoruś</option>

</select> 
```

我需要告诉我的代码它必须选择此字段，它提供所有值...您可以在我们的页面上看到的所有表格：[https ://by.e-konsulat.gov.pl/default.aspx](https://by.e-konsulat.gov.pl/default.aspx)

我发送了我的数据，但没有任何反应……如何提交此表格？（然后我将被重定向）

# database - 如何在数据库中存储歌曲或歌词文本（实现换行）

> ID：12502091
> 
> 赞同：1
> 
> 时间：2012-09-19T20:07:16.737
> 
> 标签：database

我想为歌词创建一个数据库。我正在从一些网站收集歌词。我的问题是我正在复制歌词并且那些没有任何换行符。那么，当我显示这些歌词时，它会自动携带换行符还是我需要手动输入换行符？

我只是对此感到困惑！如果我需要添加换行符，那对我来说将是一项非常艰巨的任务！专家有什么想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T20:24:17.553

笼统地说，不知道你的全部意图或设计，我建议在你找到它们的地方显示歌词；作为网页。如果这样做，当歌词存储在数据库中时，您将永远不必担心歌词文本中的换行符。

# django - Django 模板标签“if”语句未正确评估尝试简单搜索

> ID：12502094
> 
> 赞同：0
> 
> 时间：2012-09-19T20:07:21.963
> 
> 标签：django, django-templates

因此，在我的网站上，我想让人们搜索已注册帐户的人。此代码的目标是尝试对所有匹配的用户名、名字和姓氏进行排序。问题是，我的 if 语句似乎不会评估它们在我的模板中应该采用的方式。例如：

我想首先评估 q 是否与用户名、名字和姓氏匹配，

然后评估如果 q= username 和 last_name 而不是 first_name，

然后 q= username=first_name 而不是 last_name，

然后 q=username 而不是 first_name 或 last_name，

然后 q= first_name 和 last_name 而不是用户名，

然后 q=last_name 但不是用户名或名字，

最后是 q=first_name 而不是用户名或姓氏。

我创建了几个测试用户，包括具有以下信息的用户：

用户名=testuser1，名字=杰森，姓氏=史密斯用户名=新人，名字=坦率，姓氏=testuser2

所以如果我搜索“testuser”，结果会显示

用户名：testuser1 名称：Jason Smith，它会声明“testuser”，q，在用户名、名字和姓氏中。我创建的另一个用户“newperson”也没有出现在搜索结果下。但是，如果我搜索 tesuser2，newperson 会出现，但是当我将它设置为姓氏时，它会声明“testuser2”是名字。这是我的代码：

```
#views.py

def search_people(request):
    errors1 = []
    if 'q' in request.GET:
        q = request.GET['q']
        ...
        #Code evlauating errors
        ...
    else:
        usernames = RegisterProfile.objects.filter(user__username__icontains=q)
        last_names = RegisterProfile.objects.filter(last_name__icontains=q)
        first_names = RegisterProfile.objects.filter(first_name__icontains=q)
    ...

#search_results.html

{% if usernames or first_names or last_names %}
    <p>The following members matched your search results:</p>
    {% if usernames and first_names and last_names %}
        {% for username in usernames %}
            <li>Username:{{ username.user.username }} First Name: {{ username.user.get_profile.first_name }} {{ username.user.get_profile.last_name }}</li>
            <li>q is in all three</li>
        {% endfor %}
    {% endif %}
    {% if usernames and last_names and not first_names %}
        {% for username in usernames %}
            <li>Username:{{ username.user.username }} First Name: {{ username.user.get_profile.first_name }} {{ username.user.get_profile.last_name }}</li>
            <li>q is in username and last name</li>
        {% endfor %}
    {% endif %} 
    {% if usernames and first_names and not last_names %}
        {% for username in usernames %}
            <li>Username:{{ username.user.username }} First Name: {{ username.user.get_profile.first_name }} {{ username.user.get_profile.last_name }}</li>
            <li>q is in username and first name</li>
        {% endfor %}
    {% endif %}
    {% if usernames and not first_names %}
        {% if not last_names %}
            {% for username in usernames %}
                <li>Username:{{ username.user.username }} First Name: {{ username.user.get_profile.first_name }} {{ username.user.get_profile.last_name }}</li>
                <li>q is only in username</li>
            {% endfor %}
        {% endif %}
    {% endif %}
    {% if last_names and first_names and not usernames %}
        {% for last_name in last_names %}
            <li>Username:{{ last_name.user.username }} First Name: {{ last_name.user.get_profile.first_name }} {{ last_name.user.get_profile.last_name }}</li>
            <li>q is in first and last name</li>
        {% endfor %}
    {% endif %}
    {% if last_names and not first_names %}
        {% if not usernames %}  
            {% for last_name in last_names %}
                <li>Username:{{ last_name.user.username }} First Name: {{ last_name.user.get_profile.first_name }} {{ last_name.user.get_profile.last_name }}</li>
                <li>q is only in last name</li>
            {% endfor %}
        {% endif %}
    {% endif %}
    {% if first_names and not last_names %}
        {% if not usernames %}  
            {% for first_name in first_names %}
                <li>Username:{{ first_name.user.username }} First Name: {{ first_name.user.get_profile.first_name }} {{ first_name.user.get_profile.last_name }}</li>
                <li>q is only in first name</li>
            {% endfor %}
        {% endif %}
    {% endif %} 
{% endif %} 
```

我知道这很长，可能不是最好的方法，但我愿意接受任何建议并感谢任何帮助。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T00:16:04.293

```
matches = RegisterProfile.objects.filter(
     Q(user__username__icontains=q)
    |Q(last_name__icontains=q)
    |Q(first_name__icontains=q)
)

<p>The following members matched your search results:</p>
{% for profile in matches %}
<li>Username: {{ profile.user.username }} Name: {{ profile.first_name }} {{ profile.last_name }}</li>
<li>q is in 
    {% if q in profile.user.username %}username, {% endif %}
    {% if q in profile.first_name %}first name, {% endif %}
    {% if q in profile.last_name %}last name.{%endif%}
</li>
{% endfor %} 
```

这可以清理一些，但构建块在那里。例如，如果 q 只是在用户名中，您将得到类似“q 在用户名中”的行。另外，我假设 RegisterProfile 是您的用户配置文件，所以我省略了 profile.user.get_profile 位。如果不是这种情况，您可能需要重新添加它。

我认为您缺少的关键部分是[Q 对象](https://docs.djangoproject.com/en/dev/topics/db/queries/#complex-lookups-with-q-objects)的东西。这些允许您在过滤器中做比“AND”更复杂的事情。

# c# - 将超链接添加到 RadioButtonList

> ID：12502098
> 
> 赞同：3
> 
> 时间：2012-09-19T20:07:39.100
> 
> 标签：c#, asp.net, webforms

如何添加超链接`RadioButtonList`？

我尝试了以下方法，但它仍然呈现为纯文本。

```
<asp:RadioButtonList runat="server" id="rdlTest">
    <asp:ListItem Value="1" Text="<a href='Page2.aspx?1'>A</a>"></asp:ListItem>
    <asp:ListItem Value="2" Text="<a href='Page2.aspx?2'>B</a>"></asp:ListItem>
</asp:RadioButtonList> 
```

我知道以下作品，但我想使用`RadioButtonList`而不是`RadioButton`.

```
<asp:RadioButton runat="server" ID="rdoTest" Text="<a href='Page2.aspx?1'>A</a>" /> 
```

**更新**

其他一些代码搞砸了。所以我的原始代码没有问题。我有一个清除和重新加载 rdlTest 的功能`Page_Load`，`rdl.Items.Add(new ListItem("1","A")`它覆盖了工作标记。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T20:11:21.490

你不能做类似的事情......

```
<asp:CheckBoxList ID="chk" runat="server">

        <asp:ListItem Value="0"><a href="http://www.asp.net">asp.net</a></asp:ListItem>

        <asp:ListItem Value="1"><a href="http://forums.asp.net">forums.asp.net</a></asp:ListItem>

</asp:CheckBoxList> 
```

RadioButtonList 和 CheckBoxList 应该类似地工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T20:12:42.190

您总是可以为它们分配一个 id，然后在 Javascript（或 jQuery）中连接一个 onclick 事件。

```
<asp:ListItem Value="1" Text="A" ID = "A"></asp:ListItem>

$('#A').click(function(){

window.location='Page2.aspx?1'

} 
```

# c++ - 指向boost共享指针向量的void指针

> ID：12502099
> 
> 赞同：1
> 
> 时间：2012-09-19T20:07:49.450
> 
> 标签：c++, visual-studio

我有一个空指针

```
void *vp; 
```

我想将它指向作为引用传递`vec_A`的函数内部`vec_A`，即

```
some_function(std::vector<boost::shared_ptr<A> >& vec_A)
{
   void *vp;
   //now i want vp to point to vec_A
} 
```

在我指向之后，我`vp`如何`vec_A`把它找回来

```
 std::vector<boost::shared_ptr<A> > 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-19T20:12:02.037

地址和演员表：

```
void * vp = &vec_A;   // address-of

std::vector< boost::shared_ptr<A> > & v =
     *static_cast< std::vector< boost::shared_ptr<A> >* >(vp); 
```

现在`v`是对您在上面一行中获取的地址的同一个向量的引用。

# iphone - 导航栏中间的按钮

> ID：12502101
> 
> 赞同：14
> 
> 时间：2012-09-19T20:07:53.667
> 
> 标签：iphone, objective-c, ios

我想创建一个自定义导航栏。

我知道我们可以在中间使用 UIButton 来代替导航栏中的标题，但是我们可以制作一些看起来像这张图片的东西吗？

如您所见，我们在此导航栏的中间有三个不同的按钮。您能否与我分享您的想法，我们如何在 iPhone 中实现这样的功能？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-19T20:42:19.020

假设您使用的是导航控制器，您可以将导航栏的 titleView 属性设置为 UIView 容器，该容器在中间保存三个按钮（以及两组三个点）。代码看起来像这样：

```
 UIView *buttonContainer = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 200, 44)];
    buttonContainer.backgroundColor = [UIColor clearColor];
    UIButton *button0 = [UIButton buttonWithType:UIButtonTypeCustom];
    [button0 setFrame:CGRectMake(0, 0, 44, 44)];
    [button0 setBackgroundImage:[UIImage imageNamed:@"button0.png"] forState:UIControlStateNormal];
    [button0 addTarget:self action:@selector(button0Action:) forControlEvents:UIControlEventTouchUpInside];
    [button0 setShowsTouchWhenHighlighted:YES];
    [buttonContainer addSubview:button0];

    //add your spacer images and button1 and button2...

    self.navigationItem.titleView = buttonContainer; 
```

或者你当然可以在 IB 中完成这一切。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-19T20:50:16.650

如果您使用的是 UINavigationController，请尝试此操作

1.  更改导航栏的背景图像`[self.navigationController.navigationBar setBackgroundImageForBarMetrics:]`
2.  `[self.navigationItem setLeftBarButtonItem:]`用和设置您的左右按钮`[self.navigationItem setRightBarButtonItem:]`。您可能必须在此处使用带有 UIButton 的 UIBarButtonItem 作为自定义视图来摆脱边框。
3.  像这样设置中间的三个按钮

（您可能必须更改尺寸）

```
UIView *buttonView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 180, 40)];
UIButton *button1 = [UIButton buttonWithType:UIButtonTypeCustom];
button1.imageView.image = [UIImage imageNamed:@"button1.png"];
button1.frame = CGRectMake(0, 0, 40, 40);

UIButton *button2 = [UIButton buttonWithType:UIButtonTypeCustom];
button2.imageView.image = [UIImage imageNamed:@"button2.png"];
button2.frame = CGRectMake(70, 0, 40, 40);

UIButton *button3 = [UIButton buttonWithType:UIButtonTypeCustom];
button3.imageView.image = [UIImage imageNamed:@"button3.png"];
button3.frame = CGRectMake(140, 0, 40, 40);

[buttonView addSubview:button1];
[buttonView addSubview:button2];
[buttonView addSubview:button3];

self.navigationItem.titleView = buttonView; 
```

# python-sphinx - 自定义 globaltoc & localtoc html 渲染

> ID：12502102
> 
> 赞同：3
> 
> 时间：2012-09-19T20:07:55.503
> 
> 标签：python-sphinx, tableofcontents

[我正在使用Sphinx](https://www.sphinx-doc.org)设置文档。我准确地说我对这个库真的很陌生。

我的文档可以使用默认主题之一构建。一切正常:)

现在，我想自定义主题。我已经更新了`layout.html`跟随我的皮肤。在这个模板中，我包含了`globaltoc.html`& `localtoc.html`。`toctree()`目录是用&渲染的`toc`。

我想知道是否有办法更新生成的 html，或者我是否需要使我的 css 适应生成的 html？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-16T05:58:44.127

我将冒险出去猜测你在寻找什么 - 因为我认为我有同样的问题。

例如，在 localtoc.html 中，模板如下所示：

```
<h3><a href="{{ pathto(master_doc) }}">{{ _('Table Of Contents') }}</a></h3>
    {{ toc }}
{%- endif %} 
```

`{{ toc }}`是 Sphinx 的全局宏，我花了大约一个小时四处挖掘试图找到它的定义位置，但绝对没有运气。

需要注意的是，`{{ toc }}`呈现为：

```
<ul>
   <li>Toc Item 1</li>
   <li>Toc Item 2</li>
   <li>Toc Item 3</li>
</ul> 
```

问题是，如果您的 CSS 想要按类处理`<ul>`或`<li>`标记，您无法轻松更改它们。最终，我认为这是 Sphinx 的 writers/html.py 的限制，它仍然手动完成了很多工作。

真正的解决方案是替换（可能是builders/html.py），但绝对是Sphinx中的writers/html.py。这比我想付出的努力要多得多。

我确实设法找到了一些已经解决了这个问题的人，但只是部分解决了：

[rst2html5](https://github.com/marianoguerra/rst2html5)，其中包含一个 html5css3 HTMLWriter & HTMLTransformer。和[docutils-html5-writer](https://github.com/Kozea/docutils-html5-writer)，它看起来非常好 - 但由于 builders/html.py 和 html5 writer 之间的差异，它不是 Sphinx 的替代品。

最终我想出了这个解决方案，使用 jinja 过滤器。这是一个丑陋的黑客，但它让我克服了障碍。

```
<h3><a href="{{ pathto(master_doc) }}">{{ _('Table Of Contents') }}</a></h3>
   {{ toc|replace("<ul>", "<ul class=\"custom\">", 1) }}
{%- endif %} 
```

# android - 图形布局编辑器的“提供上下文的片段”下拉菜单是做什么用的？

> ID：12502103
> 
> 赞同：3
> 
> 时间：2012-09-19T20:07:55.907
> 
> 标签：android, android-layout, layout, adt, graphical-layout-editor

主题下拉菜单旁边有一个下拉菜单；它的悬停文本显示为“提供上下文的相关活动或片段”。

此（新）小部件未在图形布局编辑器[文档](http://developer.android.com/tools/help/adt.html#graphical-editor)中描述（或显示） 。

我假设这是一个通常显示此视图的活动或片段。但是布局编辑器如何处理这些信息？它可以以某种方式用于预览操作栏自定义吗？

![在此处输入图像描述](../Images/f39acabd8cb4b8726c5bf4da476b212b.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-19T20:14:58.167

The [Android tools blog](http://tools.android.com/recent/newconfigchooser) documented it as follows:

> We've added a new menu: The Activity chooser. This lets you choose the activity context to use for this layout:

![enter image description here](../Images/6d36da635f7c7e92767b578cd7e055c6.png)

> When you open a layout the first time, we attempt to guess the right layout (by looking at your activity classes and seeing which layouts they reference), but you can choose a different activity here. The activity associated with a layout is used to pick which theme to render with, in the case where you've assigned themes to activities in your manifest file. You can also open the activity in the Java editor by choosing "Open activity name". In the future we will also use the activity<->layout association to drive other features.

I noticed after changing this value, a new `tools:context` attribute was added to the top-level element in the XML, which led me to this [related question and answer](https://stackoverflow.com/q/11078487/403455). I've also entered a [documentation bug report](http://code.google.com/p/android/issues/detail?id=37639) requesting that it be included in the documentation.

> That attribute is basically the persistence for the "Associated Activity" selection above the layout. At runtime, a layout is always associated with an activity. It can of course be associated with more than one, but at least one. In the tool, we need to know about this mapping (which at runtime happens in the other direction; an activity can call setContentView(layout) to display a layout) in order to drive certain features.
> 
> Right now, we're using it for one thing only: Picking the right theme to show for a layout (since the manifest file can register themes to use for an *activity*, and once we know the activity associated with the layout, we can pick the right theme to show for the layout). In the future, we'll use this to drive additional features - such as rendering the action bar (which is associated with the activity), a place to add onClick handlers, etc.
> 
> The reason this is a tools: namespace attribute is that this is only a designtime mapping for use by the tool. The layout itself can be used by multiple activities/fragments etc. We just want to give you a way to pick a designtime binding such that we can for example show the right theme; you can change it at any time, just like you can change our listview and fragment bindings, etc.
> 
> (Here's the full changeset which has more details on this: [https://android-review.googlesource.com/#/c/36273/](https://android-review.googlesource.com/#/c/36273/) )
> 
> And yeah, the link Nikolay listed above shows how the new configuration chooser looks and works: [http://tools.android.com/recent/newconfigchooser](http://tools.android.com/recent/newconfigchooser)
> 
> One more thing: The "tools" namespace is special. The android packaging tool knows to ignore it, so none of those attributes will be packaged into the APK. We're using it for extra metadata in the layout. It's also where for example the attributes to suppress lint warnings are stored -- as tools:ignore.

# python - Selenium：是否可以在两个 xpath 选择之间获取文本？

> ID：12502108
> 
> 赞同：1
> 
> 时间：2012-09-19T20:08:21.863
> 
> 标签：python, regex, xpath, selenium

我有：

```
<center><h3>Title</h3></center>
...
stuff here that I want selected in <p>...</p>elements
...
<a href="index.htm">Content</a> 
```

第一个和最后一个我可以用 xpath:`//center/h3`和分别找到它们`//a[@href="index.html"]`。

我可以在这两个 xpath 选择之间获取区域，如果可以，或者我应该在该页面的源代码上使用正则表达式吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T20:51:39.410

看看[这个链接](http://poeticcode.wordpress.com/2008/06/04/xpath-what-about-the-between-operator/)，一种在两个 xpath 之间进行选择的方法，使用`following`.

这是工作代码：

```
//p[preceding::center/h3 and following::a[@href="index.htm"]] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-06T06:54:42.663

尝试`//a[@href="index.html"]/../p`

# jsonp - 使用 jsonp 在拉力赛中创建缺陷的 url 是什么

> ID：12502109
> 
> 赞同：1
> 
> 时间：2012-09-19T20:08:22.260
> 
> 标签：jsonp, rally

我的 jsonp ajax 请求看起来像这样，但它不起作用。我的猜测是网址不正确。这个 url 工作正常，可以得到缺陷描述：

( `https://rally1.rallydev.com/slm/webservice/1.37/defect.js?workspace=https://rally1.rallydev.com/slm/webservice/1.37/workspace/108748843&query=&start=1&pagesize=20`)

但是以下内容不适用于创建缺陷的 url：

( `https://rally1.rallydev.com/slm/webservice/1.37/defect/create.js`)

```
var request = $.ajax({
          url: "https://rally1.rallydev.com/slm/webservice/1.37/defect/create.js",
          data: { 'Defect': defectData },
          dataType: 'jsonp',
          jsonp: 'jsonp',
          username: "<username>",
          password: "<pass>",
          success: function(data, textStatus, jqXHR){
              console.log(data);
            }
        }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T19:46:31.367

您是否尝试过使用任何 Rally 的 App SDK？它们使您可以轻松地使用 Rally 的 Web 服务进行 I/O，而无需了解 jsonp 与 ajax 的详细信息。它们还包含一些非常好的 ui 组件，用于显示来自 Rally 的数据。

1.x：http:
[//developer.rallydev.com/help/rally-data-source](http://developer.rallydev.com/help/rally-data-source)

2.x 预览：
[https ://rally1.rallydev.com/apps/2.0p3/doc/#!/guide/appsdk_20_data_models](https://rally1.rallydev.com/apps/2.0p3/doc/#!/guide/appsdk_20_data_models)
[https://rally1.rallydev.com/apps/2.0p3/doc/#!/guide/ appsdk_20_data_stores](https://rally1.rallydev.com/apps/2.0p3/doc/#!/guide/appsdk_20_data_stores)

# xml - 将节点的文本字符串添加到其上一个兄弟节点的子文本字符串中

> ID：12502111
> 
> 赞同：1
> 
> 时间：2012-09-19T20:08:29.723
> 
> 标签：xml, xslt, xpath, xslt-2.0

我正在尝试将一个节点移动到它的前一个兄弟姐妹的孩子中，而一切都在同一级别上的事实让我有点棘手。

我的输入说明：

```
<dl>
   <dlentry>
      <dt> Title 1 </dt>
      <dd> Title 1's definition </dd>
      <dt> Title 2 </dt>
      <dd> Title 2's definition </dd> 
      <dt> Title 3 </dt>
      <dd> Title 3's definition </dd>
   </dlentry>
</dl> 
<p> part of title 3's definition </p>
<p> another part of title 3's definition </p> 
```

我试图做的是将这两个`<p>`元素放在底部并将它们的文本连接到最后一个`<dd>`元素文本的末尾，`<dlentry>`因为它们是“标题 3”定义的一部分。

期望的输出：

```
<dl>
   <dlentry>
      <dt> Title 1 </dt>
      <dd> Title 1's definition </dd>
      <dt> Title 2 </dt>
      <dd> Title 2's definition </dd> 
      <dt> Title 3 </dt>
      <dd> Title 3's definition part of title 3's definition another part of title 3's  definition </dd>
   </dlentry>
</dl> 
```

我正在处理的另一个问题是因为我的源文档中的 XHTML 有多糟糕，我需要对这些`<p>`元素的文本进行正则表达式匹配，以确保它不会命中文档中的其他任何地方。

我能够根据需要成功插入第一个`<p>`文本，但无法让它工作，所以我可以进行正则表达式匹配并获得第二个

元素的文本也放入所需的位置。

这是我的样式表中使用 XSLT 2.0 的代码片段。

```
<xsl:analyze-string select="."
      regex="my regex expression here">

<xsl:template match="dlentry">

  <xsl:matching-substring>
    <dlentry>
     ** <xsl:copy-of select="node()[ position() lt last()]"/>
         <dd>
           <xsl:copy-of select="node()[last()]/text()" />
           <xsl:copy-of select=" parent::node()/following-sibling::node()[1]/text()"/>
         </dd>
    </dlentry>
  </xsl:matching-substring>

  <xsl:non-matching-substring>
      <xsl:value-of select=".">
  </xsl:non-matching-substring>

</xsl:template>

<xsl:template match="p[preceding-sibling::node()[1][self::node()[name(.)='dl']]]" />
<xsl:template match="p[preceding-sibling::node()[2][self::node()[name(.)='dl']]]" /> 
```

在带有 ** 星号的代码行中，Saxon 抛出一个错误，提示“Axis step child::node() cannont be used here: the context item is an atomic value。” 我不熟悉分析字符串，但如果我在分析字符串之外运行我的选择副本并且只是在模板中，它运行良好。

抱歉，这个问题有点长，但我想分享到目前为止我所拥有的一切。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-20T03:53:00.870

**这个简短而简单**的 XSLT 1.0（当然它也是 XSLT 2.0）：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:key name="kFollowing" match="p" use="generate-id(preceding-sibling::dl[1])"/>

 <xsl:template match="node()|@*">
     <xsl:copy>
       <xsl:apply-templates select="node()|@*"/>
     </xsl:copy>
 </xsl:template>

 <xsl:template match="dlentry/dd[last()]">
  <dd>
   <xsl:apply-templates select=
    "(.|key('kFollowing', generate-id(ancestor::dl[1])))/text()"/>
  </dd>
 </xsl:template>
 <xsl:template match="p"/>
</xsl:stylesheet> 
```

**应用于提供的 XML 文档时**：

```
<html>
    <dl>
        <dlentry>
            <dt> Title 1 </dt>
            <dd> Title 1's definition </dd>
            <dt> Title 2 </dt>
            <dd> Title 2's definition </dd>
            <dt> Title 3 </dt>
            <dd> Title 3's definition </dd>
        </dlentry>
    </dl>
    <p> part of title 3's definition </p>
    <p> another part of title 3's definition </p>
</html> 
```

**产生想要的正确结果：**

```
<html>
   <dl>
      <dlentry>
         <dt> Title 1 </dt>
         <dd> Title 1's definition </dd>
         <dt> Title 2 </dt>
         <dd> Title 2's definition </dd>
         <dt> Title 3 </dt>
         <dd> Title 3's definition  part of title 3's definition  another part of title 3's definition </dd>
      </dlentry>
   </dl>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-19T21:18:19.907

不确定效率，但遵循 xsl 应该会产生请求的输出：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output method="xml" indent="yes"/>
 <xsl:template match="/doc">
  <xsl:for-each select="dl">
   <dl>
    <xsl:for-each select="dlentry">
      <xsl:apply-templates select="dt|dd"/>
    </xsl:for-each>
   </dl>
  </xsl:for-each>
 </xsl:template>

 <xsl:template match="dt">
  <dt><xsl:value-of select="."/></dt>
 </xsl:template>

 <xsl:template match="dd">
  <dd>
    <xsl:value-of select="."/>
    <!-- Check if this is the last element (= no dd/dd after) -->
    <xsl:if test="not(following-sibling::*)">
     <!-- Select dl's next sibling, if it's a <p> -->
     <xsl:for-each select="../../following-sibling::*[1][name() = 'p']">
      <!-- Call recursive template -->
      <xsl:call-template name="concat"/>
     </xsl:for-each>
    </xsl:if>
  </dd>
 </xsl:template>

 <xsl:template name="concat">
   <xsl:value-of select="."/>
   <!-- Select p's next sibling, if it's a <p> -->
   <xsl:for-each select="following-sibling::*[1][name() = 'p']">
    <!-- Call recursive template -->
    <xsl:call-template name="concat"/>
   </xsl:for-each>
 </xsl:template>
</xsl:stylesheet> 
```

这是我测试它的输入：

```
<doc>
 <dl>
   <dlentry>
      <dt> Title 1 </dt>
      <dd> Title 1's definition </dd>
      <dt> Title 2 </dt>
      <dd> Title 2's definition </dd>
      <dt> Title 3 </dt>
      <dd> Title 3's definition </dd>
   </dlentry>
 </dl>
 <p> part of title 3's definition </p>
 <p> another part of title 3's definition </p>
</doc> 
```

# python - Python/numpy 浮点文本精度

> ID：12502122
> 
> 赞同：2
> 
> 时间：2012-09-19T20:08:59.760
> 
> 标签：python, numpy, floating-point, precision

假设我有一些 32 位和 64 位浮点值：

```
>>> import numpy as np
>>> v32 = np.array([5, 0.1, 2.4, 4.555555555555555, 12345678.92345678635], 
                   dtype=np.float32)
>>> v64 = np.array([5, 0.1, 2.4, 4.555555555555555, 12345678.92345678635], 
                   dtype=np.float64) 
```

我想在不丢失精度的情况下将这些值序列化为文本（或者至少非常接近不丢失精度）。我认为这样做的规范方法是`repr`：

```
>>> map(repr, v32)
['5.0', '0.1', '2.4000001', '4.5555553', '12345679.0']
>>> map(repr, v64)
['5.0', '0.10000000000000001', '2.3999999999999999', '4.5555555555555554', 
 '12345678.923456786'] 
```

但是我想让表示尽可能紧凑以最小化文件大小，所以如果像 2.4 这样的值在没有额外小数的情况下被序列化会很好。是的，我知道这是他们实际的浮点表示，但`%g`似乎能够解决这个问题：

```
>>> ('%.7g ' * len(v32)) % tuple(v32)
'5 0.1 2.4 4.555555 1.234568e+07 '
>>> ('%.16g ' * len(v32)) % tuple(v64)
'5 0.1 2.4 4.555555555555555 12345678.92345679 ' 
```

我的问题是：`%g`以这种方式使用是否安全？是否`.7`和`.16`正确的值，这样精度就不会丢失？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-19T20:54:23.497

Python 2.7 及更高版本已经有了一个智能`repr`实现，用于将 0.1 打印为`0.1`. 选择简短输出优先于其他候选，例如`0.10000000000000001`因为它是该*特定数字*的最短表示，当读回 Python 时，它往返于完全相同的浮点值。要使用此算法，请将您的 64 位浮点数转换为实际的 Python 浮点数，然后再将它们交给`repr`：

```
>>> map(repr, map(float, v64))
['5.0', '0.1', '2.4', '4.555555555555555', '12345678.923456786'] 
```

令人惊讶的是，结果看起来很自然*并且*在数字上是正确的。有关 2.7/3.2 的更多信息`repr`可以在[What's New](http://docs.python.org/py3k/whatsnew/3.2.html)和Mark Dickinson[的精彩演讲中找到。](http://www.slideshare.net/dickinsm/magical-float-repr)

不幸的是，这个技巧不适用于 32 位浮点数，至少在不重新实现 Python 2.7 使用的算法的情况下是这样`repr`。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-19T20:17:16.777

To uniquely determine a single-precision (32-bit) floating point number in IEEE-754 format, it can be necessary to use 9 (significant, i.e. not starting with 0, unless the value is 0) decimal digits, and 9 digits are always sufficient.

For double-precision (64-bit) floating point numbers, 17 (significant) decimal digits may be necessary and are always sufficient.

I'm not quite sure how the `%g` format is specified, by the looks of it, it can let the representation begin with a 0 (0.1), so the safe values for the precision would be `.9` and `.17`.

If you want to minimise the file size, writing the byte representations would produce a much smaller file, so if you can do that, that's the way to go.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-19T21:20:54.163

在 2.7 中实现花哨的 repr 的 C 代码主要在 Python/dtoa.c 中（在 Python/pystrtod.c 和 Objects/floatobject.c 中有包装器）。特别是看 _Py_dg_dtoa。应该可以借用这段代码并将其修改为使用浮点数而不是双精度数。然后你可以把它包装在一个扩展模块中，或者只是将它构建为一个 so 并 ctypes 它。

另外，请注意，消息来源说该实现是“受 Guy L. Steele, Jr. 和 Jon L. White 的“如何准确打印浮点数”的启发 [Proc. ACM SIGPLAN '90, pp. 112-126] 。” 因此，您可以通过阅读那篇论文（以及 dtoa.c 注释中记录的任何修改似乎是合适的）自己实现一些不太灵活和更简单的东西。

最后，该代码是对 David Gay 在 AT&T 发布的代码的微小更改，并在许多其他库（NSPR 等）中使用，其中一个可能具有更易于访问的版本。

但在执行任何操作之前，请通过尝试 Python 函数并测量它是否太慢来确保确实存在性能问题。

如果这确实是一个性能关键领域，您可能不想循环遍历列表并首先调用 repr（或您自己的花哨的 C 函数）；您可能需要一个函数，它可以一次将浮点数或双精度数的 numpy 数组转换为字符串。（当然，理想情况下，您希望将其构建到 numpy 中。）

最后一个想法：您正在寻找“至少非常接近不丢失精度”。可以想象，仅转换为 double 并使用 repr 就足以满足您的目的，而且显然比其他任何事情都容易得多，因此您至少应该对其进行测试以排除它。

不用说，您还应该测试是否`%.9g`足够`%.17g`接近您的目的，因为这是可能工作的下一个最简单的事情。

# php - 将 Onload 事件挂钩到 iframe

> ID：12502125
> 
> 赞同：0
> 
> 时间：2012-09-19T20:09:07.357
> 
> 标签：php, javascript, onload

将两个 onload 事件挂钩到 iframe 并在不同的 onload 尝试上发生的 javascript 代码是什么。

我希望第一个 onload 只做下一个 onload 重定向。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T20:15:15.560

**New Answer**

After re-reading your question, I realized you wanted the functions to to trigger on separate events. This is easier to achieve:

```
var ifr = document.getElementById('daiframe');

ifr.onload = function(){
    ifr.onload = function(){
        // do the redirect here
    };
};

ifr.src = 'http://initial.url/'; 
```

What is of utmost importance here is that you set the onload code above BEFORE the iframe gets the initial URL, like I did. Assuming you are writing the iframe HTML code directly, be sure that the SRC attribute points to `about:blank`.

**Edit:** *From information given in comment and my earlier warning...*

Let's say the PHP part looks like this:

```
$code = '<iframe src="http://some.url/"></iframe>';
echo $code; 
```

That code needs to be changed to:

```
$code = '<iframe src="http://some.url/"></iframe>';
echo str_replace('<iframe ', '<iframe onload="ifrLoaded();" ', $code);

?><script type="text/javascript">
    var alreadyLoaded = false;
    function ifrLoaded(){
        if(alreadyLoaded){
            // do your redirect
        }else{
            alreadyLoaded = true;
        }
    }
</script> 
```

* * *

**Old Answer**

Something like this?

```
function appendEvent(el, name, fn){
    if(typeof el[name] == 'function'){
        var oldfn = el[name];
        el[name] = function(){
            oldfn.apply(this, arguments);
            fn.apply(this, arguments);
        };
    }else{
        el[name] = fn;
    }
}

var ifr = document.getElementById('daiframe');

appendEvent(ifr, 'onload', function(){});
appendEvent(ifr, 'onload', function(){ /* do the redirect */ });

ifr.src = 'http://target.url/'; // since onload fires only after the URL is set 
```

[A working JSFiddle...](http://jsfiddle.net/r9FZX/1/)

# java - Java：是否可以打开文件进行写入，但如果文件已经存在则炸毁？

> ID：12502128
> 
> 赞同：1
> 
> 时间：2012-09-19T20:09:18.823
> 
> 标签：java, file-io

如果具有给定名称的文件已经存在，我想创建一个用于写入的文件并获取异常。我正在寻找一个线程安全的实现，并希望在 Java 标准库中。我找到的最接近的电话是：

```
FileOutputStream fos = new FileOutputStream("/some/file/path.txt"); 
```

但这会截断同名的现有文件。如果已经有同名文件，是否有任何方法会引发异常或以其他方式返回错误？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-19T20:15:19.800

尝试使用 File 类和[createNewFile](http://docs.oracle.com/javase/7/docs/api/java/io/File.html#createNewFile%28%29)。

以下解决方案是线程安全的：

```
File file = new File("/some/file/path.txt");
if (file.createNewFile()) {
  // Succesfully created a new file
  FileOutputStream fos = new FileOutputStream(file);
  try {
    // Do something with outputstream
  } finally {
    try { fos.close(); } catch (IOException exception) { }
  }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-19T20:15:04.297

这是您想要的方法：[File.createNewFile](http://docs.oracle.com/javase/7/docs/api/java/io/File.html#createNewFile%28%29)

> *当且仅当具有此名称的文件尚不存在时*，以原子方式创建一个以此抽象路径名命名的新的空文件。检查文件是否存在以及如果文件不存在则创建文件是单个操作，相对于可能影响文件的所有其他文件系统活动而言是原子操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-19T20:12:19.927

你可以

*   检查文件是否存在
*   如果它不写入临时
*   将临时文件重命名为原始文件
*   如果无法重命名临时文件，请删除它。

由于第三步在操作系统中是原子的，因此它的线程和进程是安全的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-19T20:11:37.577

```
File f = new File("/some/file/path.txt");
if(f.exists()) 
  {
   //delete the file
  }
   else
  {
    //create and do what you want
  } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-19T20:12:12.423

是的，还有另一种方法，它也很容易与您的代码集成：

```
synchronized(this) {
  File f = new File("path");

  if (f.exists())
    throw new FileExistsException();
  else {
    FileOutputStream fos = new FileOutputStream(f);
    ...
  }
} 
```

# facebook - Facebook登录FB.ui，访问令牌为空

> ID：12502134
> 
> 赞同：1
> 
> 时间：2012-09-19T20:09:59.833
> 
> 标签：facebook, facebook-graph-api, facebook-javascript-sdk, facebook-apps, facebook-ui

我正在尝试在我的 facebook 应用程序中对用户进行身份验证。我正在使用以下代码：

```
window.fbAsyncInit = function () {
        FB.Event.subscribe('auth.statusChange', fbIsReady);
        FB.init({ appId: app_id, channelUrl: channelUrl, status: true, cookie: true, xfbml: true, oauth: true});
        FB.Canvas.setAutoGrow();
        FB.Canvas.scrollTo(0, 0);
      };

      (function (d) {
        var js, id = 'facebook-jssdk'; if (d.getElementById(id)) { return; }
        js = d.createElement('script'); js.id = id; js.async = true;
        js.src = "//connect.facebook.net/en_GB/all.js";
        d.getElementsByTagName('head')[0].appendChild(js);
      } (document));

function fbIsReady(res){
  fbReady = 1;
  var params = {method: "oauth", "scope": 'publish_stream'};
  FB.ui(params, isLoggedIn);
}

function isLoggedIn(res){
  if(!res || res.status === 'not_authorized' || res.perms != 'publish_stream')
    fbIsReady();
  else if(res.hasOwnProperty('selected_profiles')){
    FB.api('/me', {access_token: FB.getAccessToken()}, checkUserInfo);
  }
}

function checkUserInfo(){
    console.log(res); // return the error bellow right after the user gives permissions and the expected result after refresh
} 
```

我的问题是，用户在应用程序中进行身份验证后，未设置访问令牌。我需要刷新页面才能正常工作。我认为在用户授权后我将能够执行 FB.api('/me'...) 但我得到：

> 代码：2500 消息：“必须使用活动访问令牌来查询有关当前用户的信息。” 类型：“OAuthException”

直到我刷新页面。任何想法？？

谢谢

# apache - Elastic Beanstalk 的 Hostmanager 无法启动 Apache，EBS 连接缓慢

> ID：12502138
> 
> 赞同：1
> 
> 时间：2012-09-19T20:10:11.617
> 
> 标签：apache, amazon-web-services, amazon-elastic-beanstalk

我正在设置一个 Elastic Beanstalk 实例以在 Tomcat 上运行 Grails 应用程序并使用 Apache 提供 UI 网页。Web 内容位于 EBS 卷上，该卷在启动时使用 init.d 脚本 ( [mountec2vol](https://forums.aws.amazon.com/thread.jspa?threadID=25071) ) 附加并挂载。Apache 的 DocumentRoot 位于此卷 /mnt/data/www 上。我的 AMI 映像基于默认的 Beanstalk 64bit-Tomcat7-linux 映像。

Hostmanager 似乎无法启动 Apache，因为 EBS 卷需要一段时间（5-20​​ 秒）才能附加。这是我在 /opt/elasticbeanstalk/var/log/bluepill.log 中得到的：

> W, [2012-09-19T18:06:15.366835 #1283] WARN -- : [hostmanager:httpd] {:stdout=>"Starting httpd: [FAILED]\r\n", :stderr=>"语法错误/etc/httpd/conf/httpd.conf 的第 293 行:\nDocumentRoot 必须是目录\n", :exit_code=>1}

因此，我没有让 Web 服务器联机，健康检查失败并且实例被终止并重新创建......

我可以将主机管理器配置为延迟 Apache 启动，直到 EBS 卷启动？这是使用 Elastic Beanstalk 实例附加+安装 EBS 的正确方法吗？

或者我在这里做了一些不必要的困难......有没有更直接的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T07:40:35.730

Elastic Beanstalk 是一个 EC2 实例，其行为方式相同。以下是关于您遇到的同一问题的一些讨论：[https ://forums.aws.amazon.com/message.jspa?messageID=304528#304528](https://forums.aws.amazon.com/message.jspa?messageID=304528#304528)

如果您希望将静态内容存储在 EBS 卷上，那么在执行任何其他操作之前，为依赖 EBS 的服务初始化脚本编写一些简单的处理程序以检查挂载卷的可用性。

然而，“云解决方案”可能是将您的内容存储到 S3 并在需要时从那里加载它。这样您就不需要单独的 EBS 进行存储了。

# django - 使用 using() 访问 Django 中的多个数据库

> ID：12502141
> 
> 赞同：1
> 
> 时间：2012-09-19T20:10:15.517
> 
> 标签：django, django-models

从今天早上开始，我一直在尝试，并阅读了所有关于在 django 中访问多个数据库的帖子，但无济于事。我正在寻找访问同一服务器上的另一个数据库，并且我已将这些数据库包含在带有别名的 settings.py 中。当我尝试在查询集中使用 using() 时，我收到一个错误，即全局名称“对象名”不存在。我正在使用带有 django 1.4 的 postgresql 9.1

我需要导入什么才能使其正常工作吗？它在控制台（python manage.py shell）或视图中都不适合我。

这是来自 settings.py 的数据库设置：

```
DATABASES = {
 'default': {
    'ENGINE': 'django.db.backends.postgresql_psycopg2',     # Add 'postgresql_psycopg2', 'postgresql', 'mysql', 'sqlite3' or 'oracle'.
    'NAME': 'testing',      # Or path to database file if using sqlite3.
    'USER': 'xxxx',                     # Not used with sqlite3.
    'PASSWORD': 'xxxx',                 # Not used with sqlite3.
    'HOST': 'localhost',                    # Set to empty string for localhost. Not used with sqlite3.
    'PORT': 'xxxx',                         # Set to empty string for default. Not used with sqlite3.
},
'app_data': {
    'ENGINE': 'django.db.backends.postgresql_psycopg2',     # Add 'postgresql_psycopg2', 'postgresql', 'mysql', 'sqlite3' or 'oracle'.
    'NAME': 'applications',      # Or path to database file if using sqlite3.
    'USER': 'xxxx',                     # Not used with sqlite3.
    'PASSWORD': 'xxxx',                 # Not used with sqlite3.
    'HOST': 'localhost',                    # Set to empty string for localhost. Not used with sqlite3.
    'PORT': 'xxxx',                         # Set to empty string for default. Not used with sqlite3.
},
'ppp_data': {
    'ENGINE': 'django.db.backends.postgresql_psycopg2',     # Add 'postgresql_psycopg2', 'postgresql', 'mysql', 'sqlite3' or 'oracle'.
    'NAME': 'platform',      # Or path to database file if using sqlite3.
    'USER': 'xxxx',                     # Not used with sqlite3.
    'PASSWORD': 'xxxx',                 # Not used with sqlite3.
    'HOST': 'localhost',                    # Set to empty string for localhost. Not used with sqlite3.
    'PORT': 'xxxx',                         # Set to empty string for default. Not used with sqlite3.
} 
```

}

这是来自控制台的代码：

```
>>> MyModel.objects.using('app_data').all()
Traceback (most recent call last):
File "<console>", line 1, in <module>
NameError: name 'MyModel' is not defined 
```

这是视图中的错误：

```
NameError at /myapp/view
global name 'MyModel' is not defined 
```

请帮忙！

编辑：只是为了提供一点背景知识，我有 3 个不同的应用程序在具有不同数据库的一台服务器上运行，我想访问不同应用程序的记录只是为了查看。这 3 个应用程序是应用程序、ppp 和测试，我正在尝试从我的测试应用程序访问应用程序和 ppp 数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T12:41:17.120

我不得不将其他应用程序的应用程序路径附加到 wsgi 文件中。

```
import os, sys
sys.path.append('/opt/www/test')
sys.path.append('/opt/www/app')
sys.path.append('/opt/www/ppp') 
```

然后我可以从其他应用程序导入模型

```
from pp_app.myapp.models import MyModel
from pp_ppp.myapp.models import MyModel 
```

然后这允许我在视图中使用 using() 方法来获取记录：

```
data1 = MyModel.objects.using('app_data').all() 
data2 = MyModel.objects.using('ppp_data').all() 
```

希望这对其他人有帮助。

# javascript - url改变时加载ajax

> ID：12502144
> 
> 赞同：0
> 
> 时间：2012-09-19T20:10:25.593
> 
> 标签：javascript, jquery, ajax

我只是第一次搞乱ajax。

目前我正在根据 url 从文本文件中加载文本。

这是我的做法：

```
var home_url = "blahblah/index.html#home";
var test_url = "blahblah/index.html#test";

$(document).on("click",".ajax_load",function(){
    if (location.href === home_url) {
        $("#main").load("src/home.txt");
    };
    if (location.href === test_url) {
        $("#main").load("src/test.txt");
    };  
}); 
```

这可行，但是直到我第二次按下按钮后才会加载内容。更容易理解：

```
button press -> 2nd button press -> content loaded 
```

我认为发生这种情况是因为我的代码直到第一次按下后才注册 url，然后`if`语句检查是否需要加载内容，但这只会在再次单击按钮之前触发。

谁能帮我一键加载内容？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T20:49:40.567

问题是，链接在事件触发后更改了“location.href”。因此，第一次单击时，将执行错误（或没有）ajax-load 代码，然后更改 URL，因此第二次单击检查正确的 URL。

所以我建议的解决方案是：不要检查位置 url，而是检查您在链接中指定的 url：

```
$('.ajax_load').bind('click', this, function(){
    if (this.href === home_url) {
        $("#main").load("src/home.txt");
    };
    if (this.href === test_url) {
        $("#main").load("src/test.txt");
    };
}); 
```

注意：“this.href”总是包含完整的 URL，即使链接是用简单的锚指定的：

```
<a href="#home">home</a> 
```

# java - Java 中的动作监听器

> ID：12502145
> 
> 赞同：1
> 
> 时间：2012-09-19T20:10:26.450
> 
> 标签：java, swing, actionlistener

```
/* I am trying to make a basic calculator in JAVA using swings. However, after adding
 * actionlisteners to each of my buttons, the actionPerformed method is never called. I can't
 *seem to figure out why .
 */

import javax.swing.*;
import java.awt.*;
import java.awt.event.*;

public class calculator extends JApplet implements ActionListener
{
         JLabel num1_label,num2_label,result_label;
         JTextField t1,t2,t3;
         JButton sum,sub,mul,div;     
         float num1,num2,res;

    public calculator ()
    {
        Container contentPanel = getContentPane();
        contentPanel.setLayout(new GridLayout(6,2));

        JLabel num1_label = new JLabel("Number 1");
        contentPanel.add(num1_label);

        JTextField t1 = new JTextField(10);
        contentPanel.add(t1);

        JLabel num2_label = new JLabel("Number 2");
        contentPanel.add(num2_label);

        JTextField t2 = new JTextField(10);
        contentPanel.add(t2);

        JLabel result_label = new JLabel("Result");
        contentPanel.add(result_label);

        JTextField t3 = new JTextField(10);
        contentPanel.add(t3);

        JButton sum = new JButton("Add");      
        sum.addActionListener(this);
        contentPanel.add(sum);

        JButton sub = new JButton("Subtract");
        sub.addActionListener(this);
        contentPanel.add(sub);

        JButton mul = new JButton("Multiply");
        mul.addActionListener(this);
        contentPanel.add(mul);

        JButton div = new JButton("Divide");
        div.addActionListener(this);
        contentPanel.add(div);

        }

        public void actionPerformed(ActionEvent ae)
        {
            if(ae.getSource() == sum)
              {
                  addition();
              }

            if(ae.getSource() == sub)
            {
                subtraction();
            }

            if(ae.getSource() == mul)
            {
                multiplication();
            }

            if(ae.getSource() == div)
            {
                division();
            }

        }

        public void addition()
        {
            try {
                  num1 = Float.parseFloat(t1.getText());
                  num2 = Float.parseFloat(t2.getText());
                  res  = num1 + num2;                
                  t3.setText(" " + res);
                }
                catch (NumberFormatException nfe) 
                {
                    t1.setText("0");
                    t2.setText("0");
                    t3.setText("0");
                }

        }

         public void subtraction()
        {
            try {
                  num1 = Float.parseFloat(t1.getText());
                  num2 = Float.parseFloat(t2.getText());
                  res  = num1 - num2;                
                  t3.setText(" " + res);
                }
                catch (NumberFormatException nfe) 
                {
                    t1.setText("0");
                    t2.setText("0");
                    t3.setText("0");
                }

        } 

        public void multiplication()
        {
            try {
                  num1 = Float.parseFloat(t1.getText());
                  num2 = Float.parseFloat(t2.getText());
                  res  = num1 * num2;                
                  t3.setText(" " + res);
                }
                catch (NumberFormatException nfe) 
                {
                    t1.setText("0");
                    t2.setText("0");
                    t3.setText("0");
                }

        }

        public void division()
        {
            try {
                  num1 = Float.parseFloat(t1.getText());
                  num2 = Float.parseFloat(t2.getText());
                  res  = num1 / num2;                
                  t3.setText(" " + res);
                }
                catch (NumberFormatException nfe) 
                {
                    t1.setText("0");
                    t2.setText("0");
                    t3.setText("0");
                }

        }

        public static void main(String argsp[])
        {
            calculator c = new calculator();
        }

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-19T20:17:23.843

You first declare the buttons as member variables and then you use (declare again and initialize) the same variable names inside the constructor. This means that the member variables remain all equal to `null`. To fix this, just drop the leading `JButton` from the buttons initialization in the constructor.

```
JButton mul = new JButton("Multiply"); 
```

becomes

```
mul = new JButton("Multiply"); 
```

The issue related to variable names that you had here is known as shadowing.

And the full solution. Please note the changes to the class name, the variable declaration, formatting,....

```
import java.awt.Container;
import java.awt.GridLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.JApplet;
import javax.swing.JButton;
import javax.swing.JLabel;
import javax.swing.JTextField;

public class Calculator extends JApplet implements ActionListener {
    private JLabel num1_label;
    private JLabel num2_label;
    private JLabel result_label;
    private JTextField t1;
    private JTextField t2;
    private JTextField t3;
    private JButton sum;
    private JButton sub;
    private JButton mul;
    private JButton div;
    private float num1;
    private float num2;
    private float res;

    public Calculator() {
        Container contentPanel = getContentPane();
        contentPanel.setLayout(new GridLayout(6, 2));

        num1_label = new JLabel("Number 1");
        contentPanel.add(num1_label);

        t1 = new JTextField(10);
        contentPanel.add(t1);

        num2_label = new JLabel("Number 2");
        contentPanel.add(num2_label);

        t2 = new JTextField(10);
        contentPanel.add(t2);

        result_label = new JLabel("Result");
        contentPanel.add(result_label);

        t3 = new JTextField(10);
        contentPanel.add(t3);

        sum = new JButton("Add");
        sum.addActionListener(this);
        contentPanel.add(sum);

        sub = new JButton("Subtract");
        sub.addActionListener(this);
        contentPanel.add(sub);

        mul = new JButton("Multiply");
        mul.addActionListener(this);
        contentPanel.add(mul);

        div = new JButton("Divide");
        div.addActionListener(this);
        contentPanel.add(div);
    }

    public void actionPerformed(ActionEvent ae) {
        System.out.println("hhhhh");
        if (ae.getSource() == sum) {
            addition();
        }

        if (ae.getSource() == sub) {
            subtraction();
        }

        if (ae.getSource() == mul) {
            multiplication();
        }

        if (ae.getSource() == div) {
            division();
        }
    }

    public void addition() {
        try {
            num1 = Float.parseFloat(t1.getText());
            num2 = Float.parseFloat(t2.getText());
            res = num1 + num2;
            t3.setText(" " + res);
        } catch (NumberFormatException nfe) {
            t1.setText("0");
            t2.setText("0");
            t3.setText("0");
        }

    }

    public void subtraction() {
        try {
            num1 = Float.parseFloat(t1.getText());
            num2 = Float.parseFloat(t2.getText());
            res = num1 - num2;
            t3.setText(" " + res);
        } catch (NumberFormatException nfe) {
            t1.setText("0");
            t2.setText("0");
            t3.setText("0");
        }
    }

    public void multiplication() {
        try {
            num1 = Float.parseFloat(t1.getText());
            num2 = Float.parseFloat(t2.getText());
            res = num1 * num2;
            t3.setText(" " + res);
        } catch (NumberFormatException nfe) {
            t1.setText("0");
            t2.setText("0");
            t3.setText("0");
        }
    }

    public void division() {
        try {
            num1 = Float.parseFloat(t1.getText());
            num2 = Float.parseFloat(t2.getText());
            res = num1 / num2;
            t3.setText(" " + res);
        } catch (NumberFormatException nfe) {
            t1.setText("0");
            t2.setText("0");
            t3.setText("0");
        }

    }

    public static void main(String argsp[]) {
        Calculator c = new Calculator();
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-19T20:14:00.423

在你的构造函数中试试这个：

```
sum.setActionCommand ("sum"); 
```

并在您的 actionPerformed 中询问：

```
if ( ae.getActionCommand().equals("sum")) {
    ...
} 
```

你所有的按钮都一样。

# jquery - expressjs POST响应不起作用

> ID：12502146
> 
> 赞同：1
> 
> 时间：2012-09-19T20:10:30.693
> 
> 标签：jquery, post, express

也许这很简单，但是下面的代码不起作用，expressjs 服务器正在接收请求和数据，但是 jQuery ajax 调用没有收到来自服务器的响应

这是服务器代码

```
 app.get('/', function(req, res){
  console.log('request for /');
  res.send('hello there!');    
 }); 
```

这是 jQuery 请求

```
 $.ajax({
    type: 'GET',
    url: 'http://localhost:3000/',
    success: function(data) {
        alert(data);
    }
  }); 
```

这是 expressjs 应用程序配置

```
 app.configure(function(){
  app.set('port', /*process.env.PORT ||*/ 3000);
  app.set('views', __dirname + '/views');
  app.set('view engine', 'jade');
  app.use(express.favicon());
  app.use(express.logger('dev'));
  app.use(express.bodyParser());
  app.use(express.methodOverride());
  app.use(app.router);
  app.use(express.static(path.join(__dirname, 'public')));
 }); 
```

编辑：取出 Json 的东西，问题仍然存在

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-27T20:27:14.230

解决方案是允许跨域标头

```
 res.header("Access-Control-Allow-Origin", "*");
      res.header("Access-Control-Allow-Headers", "X-Requested-With"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T07:11:38.420

问题是您没有在服务器代码中结束连接，如下所示。在 app.get('/', ...

```
res.end('hello there'); 
```

注意**结束**而不是发送。

# javascript - 将鼠标悬停弹出窗口添加到 d3 树叶

> ID：12502148
> 
> 赞同：1
> 
> 时间：2012-09-19T20:10:39.977
> 
> 标签：javascript, tree, d3.js

[我在这里](http://bl.ocks.org/1249394)遇到了这个使用 d3 构建可折叠动画缩进树的好例子。

`mouseover`当叶节点上发生事件时，如何添加一个有效的弹出窗口？弹出窗口应出现在实际节点旁边。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T23:52:13.647

通过将 .on 事件添加到 nodeEnter.append("svg:circle") 部分，您几乎可以在 mouseover 和 mouseout 上做任何您想做的事情：

```
nodeEnter.append("svg:circle")
  //.attr("class", "node")
  //.attr("cx", function(d) { return source.x0; })
  //.attr("cy", function(d) { return source.y0; })
  .attr("r", 4.5)
  .style("fill", function(d) { return d._children ? "lightsteelblue" : "#fff"; })
  .on("mouseover", addLabel)
  .on("mouseout", clearLabel)
  .on("click", click); 
```

除了这两行代码之外，您还必须编写 addLabel 和 clearLabel 函数（如示例中显示或隐藏子节点的 click 函数）。

您可以通过将其位置传递给函数或通过相对于鼠标定位它来让节点出现弹出窗口。

# objective-c - 如何用iOS5制作简单的横向相册

> ID：12502163
> 
> 赞同：2
> 
> 时间：2012-09-19T20:11:51.387
> 
> 标签：objective-c, cocoa-touch, ios5, gallery, scrollview

我想制作一个非常简单的照片库，一次显示一张图像，您可以向左或向右滑动以查看图像。这个画廊最多有 4-6 张图片。它不需要任何花哨的效果或缩放等。

我尝试使用图像将滚动视图旋转 90 度，但滚动速度太快，如果您向左滑动，您一次只能移动 1 个图像，如果您在中间滑动然后松开，滚动视图应该自动滚动到最近的完整图像/单元格。也许如果有人可以帮助我做那些很好的事情。我不想使用three20，因为它非常复杂并且有很多我不需要的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T20:14:06.947

不要旋转滚动视图。只需将内容大小设置为比屏幕宽。为了让它停在每张图片上，你必须使用**paging**。当用户滚动时，设置`pagingEnabled`为`YES`并且滚动视图在滚动视图边界的倍数处停止。

# java - 使用外部 Jar 文件中的主要方法从项目构建可运行 Jar

> ID：12502167
> 
> 赞同：2
> 
> 时间：2012-09-19T20:11:59.513
> 
> 标签：java, eclipse, jar, classpath, external

我的教授决定为这个作业提供一个带有主要方法的外部 jar，我们应该为后端编写代码。我把这个 jar 放到我的项目中并让它在 Eclipse 中运行没有问题，但是当我尝试导出一个可运行的 jar 时，我得到了这个错误：

“无法从给定的启动配置中找到主要方法”

这似乎很荒谬，因为它肯定可以在我在 Eclipse 中运行它时找到主要方法，我错过了什么？我已经尝试打开 jar 以获取 Manifest.mf 文件并为其提供外部 jar 内部的主要类的名称，但它仍然无法找到它。

我也将 jar 添加到项目构建路径和类路径中，但这似乎没有什么区别。

清单文件只是说：

```
Manifest-Version: 1.0
Class-Path: . 
```

我认为这是错误的，但我该如何正确设置呢？

--**编辑**--

这是我构建时由 Eclipse 生成的 ANT 文件：

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<project default="create_run_jar" name="Create Runnable Jar for Project Lab 1">
<!--this file was created by Eclipse Runnable JAR Export Wizard-->
<!--ANT 1.7 is required                                        -->
<target name="create_run_jar">
    <jar destfile="C:/lab.jar" filesetmanifest="mergewithoutmain">
        <manifest>
            <attribute name="Main-Class" value="edu.wmich.cs1120.la1.solution_gui.MainWindow"/>
            <attribute name="Class-Path" value="."/>
        </manifest>
        <zipfileset excludes="META-INF/*.SF" src="C:/LA1_GUI.jar"/>
        <fileset dir="C:/bin"/>
    </jar>
</target> 
```

好的，我看到需要将 Main-Class 属性设置为什么，所以当我编辑 Manifest.mf 以反映它有效时！但我仍然感到困惑，尤其是以下几行：

```
filesetmanifest="mergewithoutmain"
zipfileset excludes 
```

如果我为我的项目指定了 main，为什么要这样做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T22:50:44.893

有几种方法可以独立于 Eclipse 运行程序：

1.  使用 Ant，正如您已经学习的那样。

2.  使用命令行。无论您是在自己的 jar 文件中包含教授的类文件还是有两个单独的 jar 文件，确切的命令都会有所不同：

    一个。使用单个 jar 文件，您可以运行

    ```
    java -jar MyJar.jar 
    ```

    这假设您在清单文件中设置了 Main-Class 属性。如果没有，您可以手动指定主类：

    ```
    java -jar MyJar.jar MainClass 
    ```

    湾。使用两个 jar，您只需要确保第二个 jar 包含在类路径中：

    ```
    java -jar ProfsJar.jar -cp MyJar.jar 
    ```

    同样，如果需要，您可以手动指定主类：

    ```
    java -jar ProfsJar.jar -cp MyJar.jar MainClass 
    ```

3.  双击操作系统的文件资源管理器。如果您的 Java 安装已正确配置您的操作系统，您只需双击 jar 文件即可。这还假设在 jar 的清单中正确设置了 Main-Class 属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T21:03:08.600

类路径为“。” 在您的清单中，您需要将教授提供的 jar 放在您尝试从中运行创建的 jar 的同一目录中。否则，可能有一种方法可以告诉 eclipse/ant 包含所有依赖项。

-UPDATE- 由于您使用的是依赖项中的 Main 方法，因此您应该在 ant build xml 中指定以下内容，然后重新构建。

```
 filesetmanifest="merge" 
```

这将在另一个清单的主要部分合并到您的新 jar 清单中。

# html - 如何从桌面读取图像并输入 div 标签？

> ID：12502181
> 
> 赞同：2
> 
> 时间：2012-09-19T20:12:43.987
> 
> 标签：html, css, image

我似乎无法从我的桌面获取我的图像并将其放入我的 div 标签之一。有人可以帮帮我吗。

```
<!DOCTYPE html>
<html>
    <body>
    <img src="C:\Users\aldiaz\Desktop\DynamicsTest1.jpg">
        <div id="container" style="width:500px">
            <div id="header" style="background-color:#0000F8;">
                <h1 style="margin-bottom:0;"> Triton Subs</h1>
            </div>
            <div id="image" style="background-color:yellow;  height:200px;width:100px;float:left;">
                <img src="C:\Users\aldiaz\Desktop\DynamicsTest1.jpg height:200px; width:100px;floatleft;">
            </div>
            <div id="content" style="background- color:#D7D7D7;height:200px;width:400px;float:left;">Dear [FIRSTNAME] [LASTNAME],<br/> <br/>You have earned 5 videos and are ready to redeem.<br/><br/>Log into the Triton Submarines Experience now to choose your reward!
            </div>
            <div id="footer" style="background-color:#0000F8;clear:both;text-align:center;"> Trinto Sub Co
            </div>
        </div>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T20:16:07.710

你需要写：

```
<img src="C:\Users\aldiaz\Desktop\DynamicsTest1.jpg" style="height:200px;width:100px;float:left"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-19T20:16:40.333

如果 HTML 文件在您的桌面上，则使用 RELATIVE 文件路径，例如：

```
 <img src="images/DynamicsTest1.jpg"> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-19T20:50:36.217

浏览器不应该让您像那样访问计算机上的文件（嗯，IE 可以，但它不应该）。它被认为是一个安全漏洞。即使允许，访问该页面的其他人也无法看到该图像，因为他们的计算机上可能没有名为 aldiaz 的用户，即使有，该图像也可能不会存在于*他的*桌面上.

如果您在上传到网络服务器之前进行测试时在本地链接到图像，请使用相对 URL，而不是像其他人建议的那样。

现在，如果您正在查看在用户上传图像之前预览图像，那么有很多关于如何使用相对较新的 FileReader API 的优秀教程：

[http://html5doctor.com/drag-and-drop-to-server/](http://html5doctor.com/drag-and-drop-to-server/)

# objective-c - Objective C ASIHTTPRequest 在完整块中嵌套 GCD 块

> ID：12502182
> 
> 赞同：0
> 
> 时间：2012-09-19T20:12:52.783
> 
> 标签：objective-c, automatic-ref-counting, asihttprequest, objective-c-blocks, grand-central-dispatch

我想知道这是否是让嵌套块在Objective C中处理同一变量而不导致任何内存问题或ARC崩溃的正确方法。它以 ASIHttpRequest 完成块开始。

```
MyObject *object = [dataSet objectAtIndex:i];

ASIHTTPRequest *request = [[ASIHTTPRequest alloc]initWithURL:@"FOO"];

__block MyObject *mutableObject = object;

[request setCompleteBlock:^{

      mutableObject.data = request.responseData;

      __block MyObject *gcdMutableObject = mutableObject;

      dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT,0),^{

              [gcdMutableObject doLongComputation];

              dispatch_async(dispatch_get_main_queue(),^{

                     [self updateGUIWithObject:gcdMutableObject];
              }); 

      });

[request startAsynchronous]; 
```

我主要关心的是嵌套调度队列并使用前一个队列的 __block 版本来访问数据。我所做的安全吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T22:47:31.423

```
// Under ARC the blocks will automatically retain <object>
MyObject *object = [dataSet objectAtIndex:i];
ASIHTTPRequest *request = [[ASIHTTPRequest alloc]initWithURL:@"FOO"];
__weak ASIHTTPRequest *weakRequest = request;                        // EDIT
[request setCompleteBlock:^{
    // <object> is retained by the block.
    // Changing a property of <object> but not <object> itself.
    ASIHTTPRequest *request = weakRequest;                           // EDIT
    if (!request) return;                                            // EDIT
    object.data = request.responseData;    
    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT,0),^{
        // <object> retained by this block too...
        [object doLongComputation];
        dispatch_async(dispatch_get_main_queue(),^{
            // <object> retained by this block too
            // Note, <self> is also retained...
            // Use the same "weak" trick if you don't want this      // EDIT
            [self updateGUIWithObject:object];
        });
    });
}];
[request startAsynchronous]; 
```

**编辑**

`endy`确实提出了一个有效的观点（尽管`__usnafe_unretained`通常应该避免使用。虽然我最初确实注意到 request 和 self 都保留在原始帖子中，但我认为必要时会采取适当的措施。这对我来说并不是一个错误的决定.

因此，有几种方法可以打破此请求的保留周期，但使用弱引用可能是这里最安全和最好的选择。

请参阅上面代码中标有的行`// EDIT`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T21:36:02.780

我对指向同一个对象的所有指针有点迷茫，但我认为这就是你要找的。

```
__block MyObject *object = [dataSet objectAtIndex:i];

__unsafe_unretained ASIHTTPRequest *request = [ASIHTTPRequest requestWithURL:[NSURL URLWithString:@"FOO"]];

[request setCompleteBlock:^{

      object.data = request.responseData;

      dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT,0),^{

              [object doLongComputation];

              dispatch_async(dispatch_get_main_queue(),^{

                     [self updateGUIWithObject:object];
              }); 

      });
}];
[request startAsynchronous]; 
```

# ruby-on-rails - Rails 包含包含条件的记录

> ID：12502184
> 
> 赞同：0
> 
> 时间：2012-09-19T20:12:59.010
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有一个返回 activerecord 结果的函数，如下所示：

```
def athlete_statistics(game_id)
  athletes.includes(:statistics).where('statistics.game_id = ?', game_id)
end 
```

这将返回所有运动员及其特定比赛的统计数据。但是，它会删除没有该比赛统计数据的运动员，我希望将他们包括在内。

我试图像这样解决这个问题：

```
def athlete_statistics(game_id)
  athletes.includes(:statistics).where('statistics.game_id = ?', game_id) | athletes
end 
```

这会在最后添加缺少的运动员并返回正确的结果集，但是当我调用`to_json`结果时：

```
<%= @games.first.athlete_statistics.to_json(
    :include => [:user, :statistics => {:include => :attribute}]
).html_safe %> 
```

它尝试加载该运动员的所有统计数据，忽略 where 条件（我猜是因为它尝试延迟加载关联为空的位置）

有没有更好的方法来解决这个问题？

**更新：**

这种方法**行不通**

```
athletes.includes(:statistics).where('statistics.game_id = ? OR statistics.game_id IS NULL', game_id) 
```

因为它排除了所有与其他比赛相关的统计数据的运动员。我需要由`include`.

# objective-c - 从位于自定义 UITableViewCell 中的 UITextView 获取文本

> ID：12502185
> 
> 赞同：0
> 
> 时间：2012-09-19T20:13:12.657
> 
> 标签：objective-c, ios, xcode

我的 UITableViewController 的 UITableView 被自定义原型 UITableViewCell 填充了四次：`InfoCell *infoCell;`

子类单元格包含`UITextView *inputTextView;`

当`nextButtonPressed`我想从第一个单元格中获取文本时：

```
-(IBAction)nextButtonPressed:(id)sender {

NSString *firstCellText = ?
[dataSource objectAtIndex:dataIndex] setObject:firstCellText forKey:@"Texture"];
} 
```

如何从 UITableView 的第一个 infoCell 中的 textView 获取文本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T20:28:56.180

既然有一个 UITextView，为什么不让它成为你的 View Controller 的一个属性。当最初创建单元格并将其添加到您的单元格视图层次结构中时，它将被延迟创建。

然后，您可以在按下下一个按钮时使用 self.inputTextView 简单地访问它。

# ruby-on-rails - 如何从头开始重新安装 Ruby、Rails、Homebrew 等

> ID：12502186
> 
> 赞同：0
> 
> 时间：2012-09-19T20:13:15.923
> 
> 标签：ruby-on-rails, local

在一些关于如何让 Rails、Python 和 POW/Apache 运行良好的教程之后，我完全搞砸了我的本地环境。现在我不能调用像 rails new 这样的命令而不会出现捆绑错误，gems galore 安装失败。我想从头开始，但不知道如何从我的机器中删除所有垃圾并从头开始。非常感谢任何帮助，因为此时我的机器似乎搞砸了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T21:20:43.447

不想这么说，但完整的系统刷新可能是让事情再次正常运行的最快方法。假设您使用的是 Mountain Lion，这里有一篇很棒的文章，介绍了如何使用它进行安装驱动。

[http://reviews.cnet.com/8301-13727_7-57479690-263/how-to-create-an-os-x-10.8-mountain-lion-install-drive/](http://reviews.cnet.com/8301-13727_7-57479690-263/how-to-create-an-os-x-10.8-mountain-lion-install-drive/)

我很确定也有办法刻录 DVD，我会用谷歌搜索它。最后，由于您确实拥有许可证，因此有很多资源可供您获取 DVD 映像，而不会对自己感到太糟糕。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T21:42:57.423

如果你用 homebrew 和 rvm 安装了所有东西，你可以卸载这两个并重新开始......如果你做了其他任何事情，你最好刷新你的系统。谷歌卸载说明。

如果你需要重建你的系统，我通常做的是创建一个新分区，安装干净，摆脱旧分区，然后调整新分区的大小。有点不稳定，但我不需要太多关于创建可引导 DVD 等的事情。此外，您还可以获得完全干净安装的好处。

# ipython - 如何将 IPython 笔记本导出为 HTML 以用于博客文章？

> ID：12502187
> 
> 赞同：37
> 
> 时间：2012-09-19T20:13:17.023
> 
> 标签：ipython, ipython-notebook

将 ipython 笔记本转换为 html 格式以在博客文章中使用的最佳方法是什么？

将 ipython 笔记本转换为 PDF 很容易，但我宁愿发布为 html 笔记本。

我发现如果我将笔记本下载为 .ipynb 文件，然后将其加载到 gist 上，然后使用 ipython 笔记本查看器（nbviewer.ipython.org）查看它，然后获取 html 源，我可以将其粘贴到一篇博客文章（或者只是将其作为 html 加载到任何地方），它看起来很正确。但是，如果我直接从 ipython 使用“打印视图”选项，则源包含一堆 javascript 而不是处理后的 html，这没有用，因为没有直接包含图像和文本。

魔法`%pastebin`对这项任务也不是特别有用，因为它粘贴的是 python 代码，而不是 ipython notebook 格式的代码。

编辑：请注意，这正在开发中；请参阅已接受答案下的评论。

编辑 2014 年 5 月 2 日：根据 Nathaniel 的评论，ipython 2.0 需要一个新的答案

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-19T23:42:42.397

正确的方法描述在：[http](http://blog.fperez.org/2012/09/blogging-with-ipython-notebook.html) ://blog.fperez.org/2012/09/blogging-with-ipython-notebook.html 。然后，您可以`nbconvert -f blogger-html your_notebook.ipynb`获取帖子的 html 代码。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-09-22T13:13:48.740

比上面的答案更进一步。要创建 PDF 文件，

1.  创建一个tex文件

    ```
    nbconvert -f latex your_notebook.ipynb 
    ```

2.  将 tex 转换为 pdf ：

    ```
    pdflatex your_notebook.tex 
    ```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-11-24T10:59:01.620

以上所有答案似乎都已过时。这是从官方`nbconvert`[文档](http://nbconvert.readthedocs.org/en/latest/)中获取的最现代的解决方案。

`$ jupyter nbconvert --to FORMAT notebook.ipynb`

默认输出格式是`html`，`--to`可以省略参数：

`$ jupyter nbconvert notebook.ipynb`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-11-11T14:26:47.763

点击文件 > 下载 > html

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-02-09T22:48:43.233

您从 cmd 生成 html，并打开 Jupyter Notebook：

正如[https://stackoverflow.com/a/47773252/15117772](https://stackoverflow.com/a/47773252/15117772)回答了类似的问题：

还传递 --execute 标志以生成输出单元

`jupyter nbconvert --execute --to html notebook.ipynb`

`jupyter nbconvert --execute --to pdf notebook.ipynb`

# visual-studio - tfs isubscriber 作业扩展运行事件不再触发

> ID：12502188
> 
> 赞同：1
> 
> 时间：2012-09-19T20:13:29.753
> 
> 标签：visual-studio, tfs

我目前遇到了一个当前问题，即当我调用方法 jobService.QueueOneTimeJob 时，我的 tfs 服务器插件将不再运行作业。由于某种原因没有抛出异常我收到以下警告：

“扩展名 TFS.Plugin.TFSCreateProcesJobExtension 由 TFS.Plugin.TFSCreateProcesJobExtension 和 TFS.Plugin.TFSCreateProcesJobExtension 类型使用”

这让我想知道到底发生了什么。我还注意到我的事件日志中也有一个 tfsshellexet 错误。

这之前已经运行过，并且也触发了“运行”事件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T12:04:28.257

我现在已经设法解决了这个问题，是插件清单的名称发生了变化，导致 jobextension 运行方法无法正确执行。在启用跟踪和日志记录功能之后。

# javascript - 负底部边距在 IE 中不起作用

> ID：12502192
> 
> 赞同：1
> 
> 时间：2012-09-19T20:13:45.593
> 
> 标签：javascript, jquery, internet-explorer, google-chrome, jquery-animate

我有一个隐藏在视图之外的 div：

```
 position:fixed; 
 bottom:-240px; 
```

***更新二 ***

将底部从底部加倍：-240px 到 -480px 再调整动画高度已经隐藏了 IE9 中的 div 并消除了 Chrome 和 Safari 中的闪烁。溢出：隐藏在 IE9 中由于某种原因无法正常工作，我无法通过单击关闭按钮 (mediaclose) 在 IE9 中关闭 div。***

我使用 jquery animate 来显示 div，单击链接时可以访问该 div：

```
 $("#media").click(function () {
 $("#mediadetails").animate({height: "425px"}, 1000); 
```

并隐藏它：

```
 $('#mediaclose').click(function() {
 $('#mediadetails').animate({height: "0px"}, 2000); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T20:16:34.203

Try:

```
$('#mediadetails').animate({height: 0}, 2000);
$('#mediadetails').animate({height: 425}, 2000); 
```

# php - 使用 PHP 获取目录文件 - 为什么这在标准 php 页面上不起作用？

> ID：12502193
> 
> 赞同：-2
> 
> 时间：2012-09-19T20:13:44.503
> 
> 标签：php

我想用服务器上目录中的文件填充选择输入。我的代码在我的 drupal 模块中工作如下，但它不能在独立的 php 文件中工作（意味着在 Drupal 模块和框架之外）。此代码是 PHP - 不特定于 Drupal。

是的，我在 php 文件中确实需要它，因为我通过 jquery / Ajax 调用它，因为另一个选择输入正在调用文件所在的子目录 ($subdir)。

我什至尝试过绝对路径（http://...），但没有帮助。这对我来说毫无意义，这在我的模块中完美运行，但是当我拉起 .php 文件时，没有输出。 **编辑：**有输出。我看到了选择框，但我没有看到其中的任何选项。

有谁知道为什么这不起作用？这是我的代码：

```
$subdir = 'mysubdirectory';
$directory = 'sites/default/files/product_updates/' . $subdir;

$subdiroptions = '';

$files = glob($directory . '/*');

if(count($files > 0)) {
    foreach($files as $file) {
        $file = basename($file);
        $subdiroptions .= '<option value="' . $fiile . '">' . $file . '</option>';
    }
}

echo '<select>' . $subdiroptions . '</select>'; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T20:27:53.277

You are scanning the directory tree from a relative point in your directory tree.

You can do a `echo dirname(__FILE__) . $directory` to see the path you are scanning.

I think you should try this:

```
$subdir = 'mysubdirectory';
$directory = '/sites/default/files/product_updates/' . $subdir; 
```

And, a even better solution would be to compose a absolute path!

# android - 元素的内容必须由格式良好的字符数据或标记组成。AndroidManifest.xml

> ID：12502194
> 
> 赞同：4
> 
> 时间：2012-09-19T20:13:46.157
> 
> 标签：android, xml, android-manifest

当我在 AndroidManifest.xml 上使用此代码时

```
<provider 
     android:authorities="android.androidcustom.quicknotesprovider"
     android:name=".QuickNotesProvider" >="" <="" pre="">  
</provider> 
```

我有这个错误，我该如何解决？

元素的内容必须由格式良好的字符数据或标记组成。AndroidManifest.xml

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-19T20:18:56.070

从末尾删除语法错误，如下所示：

```
<provider 
    android:authorities="android.androidcustom.quicknotesprovider"
    android:name=".QuickNotesProvider" > 
```

我假设你也关闭了这个标签：

```
</provider> 
```

* * *

如果您使用的是 Eclipse，当您使用自动完成功能时，有时会在行尾出现杂项字符。（有时这些“奖励”字符甚至不显示，这可能令人沮丧！）

# ios - 选择配置文件

> ID：12502200
> 
> 赞同：0
> 
> 时间：2012-09-19T20:14:06.273
> 
> 标签：ios, xcode

我已经创建了证书，我已经在这里做了所有的事情：http: [//mobile.tutsplus.com/tutorials/iphone/iphone-sdk-install-apps-on-iphone-devices-for-development/](http://mobile.tutsplus.com/tutorials/iphone/iphone-sdk-install-apps-on-iphone-devices-for-development/)

我仍然无法选择个人资料：

[https://lh5.googleusercontent.com/qczMPnI94oVuiItodzOQtxc5iP7SJH_6L1rtc6AwQZcoCBjoKhfh1v5S0TNRH6xRc1xxbHNJbnE](https://lh5.googleusercontent.com/qczMPnI94oVuiItodzOQtxc5iP7SJH_6L1rtc6AwQZcoCBjoKhfh1v5S0TNRH6xRc1xxbHNJbnE)

我正在使用 xcode 4.2 为什么我不能选择配置文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T20:41:53.013

发生这种情况的唯一原因是您为特定字段选择了错误的配置文件（例如，当您尝试使用“分发配置文件”进行调试或“开发配置文件”进行发布时。它应该是相反的，显然）因此，请仔细检查您创建的配置文件，如果它们是出于正确的原因（调试或分发）而创建的。

为了让生活更简单，您也可以始终在“自动配置文件选择器”下方的行中进行选择。如果您在该类别中至少有一个配置文件，则可以毫无问题地运行该应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T21:01:30.470

确保您已正确安装证书和移动配置文件。打开 Xcode 管理器，选择设备，选择库下的配置文件，您应该会看到相应的配置文件具有有效的证书和有效的配置文件状态。如果在移动配置文件和您的项目设置（plist）匹配中这是正确的并且捆绑标识符，那么您将能够肯定地选择配置文件。

# facebook - 如何识别 Facebook 页面上的假点赞

> ID：12502203
> 
> 赞同：3
> 
> 时间：2012-09-19T20:14:07.670
> 
> 标签：facebook, facebook-like

有没有办法（通过 API、观察、算法）来判断着陆页之类的大量（>50%）是否是假的？

附录：好的，我得到了第一次降级。为什么？你认为这个问题没有答案吗？我可以告诉你，没有现有的在线服务可用于检查 Facebook 页面的可靠性，为什么这不是一个可靠的问题？每个人都在谈论虚假配置文件检测，但这不是我需要的。

实际上有一个假装能够：BING [http://www.bing.com/community/site_blogs/b/webmaster/archive/2011/05/17/social-and-search-a-small-business-primer .aspx](http://www.bing.com/community/site_blogs/b/webmaster/archive/2011/05/17/social-and-search-a-small-business-primer.aspx) 但我怀疑。你？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T12:43:02.360

您正在寻找的是一种实际上识别假用户的方法......而不是假喜欢......目前 Facebook 没有为我们提供一种方法来做到这一点。我确信他们有内部方法来检查这一点，但我们不能自己做。

# wordpress - 当wordpress不在主目录中时，在nginx上重写Wordpress url

> ID：12502206
> 
> 赞同：1
> 
> 时间：2012-09-19T20:14:16.983
> 
> 标签：wordpress, url-rewriting, nginx, webserver, rewrite

出于某种原因，我总是无法让 Wordpress 在 nginx 上工作。

我的 Wordpress 安装在文件夹“站点”（在 public_html 内）中。这是我的 nginx 配置：

```
server {
    server_name www.wouterds.be wouterds.be;
    access_log /srv/www/www.wouterds.be/logs/access.log;
    error_log /srv/www/www.wouterds.be/logs/error.log;

    location / {
        root /srv/www/www.wouterds.be/public_html;
        index index.php index.html index.htm;
        try_files $uri $uri/ /site/index.php?$args;
        autoindex on;
    }

   location ~ \.php$ {
        include /etc/nginx/fastcgi_params;
        fastcgi_pass unix:/var/run/php-fastcgi/php-fastcgi.socket;
        fastcgi_index index.php;
        fastcgi_param SCRIPT_FILENAME /srv/www/www.wouterds.be/public_html$fastcgi_script_name;
    }
} 
```

当我访问我的网站[http://wouterds.be/](http://wouterds.be/)时，我只得到目录索引。当我访问[http://wouterds.be/blog/](http://wouterds.be/blog/)时，我得到了正确的页面并且一切正常。但我不知道如何让它在基本 url 上工作。

任何人都可以帮助我吗？我当然不是 nginx 专家，经过 4 小时的 Google 搜索后，我决定在这里尝试一下。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-10-02T16:43:55.483

您也可以尝试（不在位置块中）：

```
rewrite /wp-admin$ $scheme://$host$uri/ last;
rewrite ^/(wp-.*.php)$ /wp/$1 last;
rewrite ^/(wp-(content|admin|includes).*) /wp/$1 last; 
```

交换或任何您`/wp/`的`/site/`wordpress 目录。

来源：

[https://wordpress.stackexchange.com/questions/138648/nginx-rules-for-subdomain-multisite-install-bedrock](https://wordpress.stackexchange.com/questions/138648/nginx-rules-for-subdomain-multisite-install-bedrock)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T06:59:30.077

只是改变：

```
 root /srv/www/www.wouterds.be/public_html; 
```

到

```
 root /srv/www/www.wouterds.be/public_html/site; 
```

假设 wordpress index.php 在`site`文件夹内。

还将线移到块`root`外和`location`块上方。

你可以试试...

```
server {
  #other stuff 

    root /srv/www/www.wouterds.be/public_html/site ;

    location / {
        root /srv/www/www.wouterds.be/public_html;
        index index.php index.html index.htm;
        try_files $uri $uri/ /site/index.php?$args;
        autoindex on;
    }

  #other stuff 
} 
```

# java - 在运行时查看方法调用 java jar 文件

> ID：12502208
> 
> 赞同：2
> 
> 时间：2012-09-19T20:14:36.920
> 
> 标签：java, testing, methods, jar

出于某些测试目的，我需要通过 java 应用程序查找方法覆盖率。我想知道他们是否有任何实用程序可以在运行时查看 jar 文件中的方法调用（调用的方法的名称）？这将非常有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T20:17:33.087

Among others:

*   [http://emma.sourceforge.net/](http://emma.sourceforge.net/)
*   [http://www.atlassian.com/software/clover/overview](http://www.atlassian.com/software/clover/overview)

# javascript - JS：获取最近的id号

> ID：12502211
> 
> 赞同：2
> 
> 时间：2012-09-19T20:15:02.450
> 
> 标签：javascript, jquery

具有以下结构：

```
<td class="padding_right padding_left">Neighborhood</td>
<td>
    <div id="neighborhoods_region">    
    <select class="inputs_form_data" id="neighborhood_id2" name="neighborhood_id2">
        <option value=""></option>
        <option value=""></option>
    </select>
    </div>
</td>
<td width="10%"><a class='delete-region'>remover</a></td>​ 
```

我试图在`remove`单击链接时获取所选 ID 的 ID 号。在这种情况下，我需要从“neighborhood_id2”中获取数字 2。

但首先我只是想获得完整的 ID。`neighborhood_id2`使用以下代码：

```
$(document.body).on('click','a.delete-region', function () {
    alert($(this).closest('select').attr("id"));
}); 
```

但这返回了我`undefined`。

注意：该`id`数字是在动态表单上即时生成的。所以我可能有`neighborhood_id3`等等。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-19T20:16:23.173

尝试使用`.closest('tr')`which will get you the`tr`然后找到`select`,

```
alert($(this).closest('tr').find('select').attr("id")); 
```

正如[安德烈亚斯](https://stackoverflow.com/questions/12502211/js-get-the-closest-id-number/12502228#comment16825242_12502228)指出的那样..使用`.on`（委托事件）/`.delegate`

# sql - 如何使用 T-SQL 读取文本文件？

> ID：12502213
> 
> 赞同：11
> 
> 时间：2012-09-19T20:15:04.010
> 
> 标签：sql, tsql

使用 T-SQL 读取文本文件的最佳方法是什么？我见过 BULK INSERT 和许多不同的功能，但没有一个是我正在寻找的。

我需要读取文本文件中的每一行，然后将其插入到一个表格中，其中包含一些其他信息，如文件名、文件位置、状态、记录日期和创建时间等。

BULK INSERT 不允许我添加额外的字段，除非我在这方面遗漏了一些东西。

任何帮助或指出正确的方向都会非常感激。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-19T20:32:02.077

您可能会批量插入临时表，然后使用要添加的数据进行另一次插入连接。这是一个例子

```
CREATE TABLE #TEXTFILE_1(
    FIELD1 varchar(100) ,
    FIELD2 varchar(100) ,
    FIELD3 varchar(100) ,
    FIELD4 varchar(100));

BULK INSERT #TEXTFILE_1 FROM 'C:\STUFF.TXT'
WITH (FIELDTERMINATOR =' | ',ROWTERMINATOR =' \n')

/*You now have your bulk data*/

insert into yourtable (field1, field2, field3, field4, field5, field6)
select txt.FIELD1, txt.FIELD2, txt.FIELD3, txt.FIELD4, 'something else1', 'something else2' 
from #TEXTFILE_1 txt

drop table #TEXTFILE_1 
```

这不是你想要的吗？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-19T20:33:02.497

我使用了一个非常简单的 CLR 过程，它读取整个文件并将行分隔成行——返回一个单列的值表。就像我说的，CLR 代码非常简单：

```
[MyFileIO.vb]

Imports System
Imports System.IO
Imports System.Data
Imports System.Data.SqlClient
Imports System.Data.SqlTypes
Imports Microsoft.SqlServer.Server
Imports System.Collections
Imports System.Runtime.InteropServices

Partial Public Class TextFiles
    <Microsoft.SqlServer.Server.SqlFunction(FillRowMethodName:="GetNextSplitString")> _
    Public Shared Function FileToTable(ByVal FileName As String) As IEnumerable

        Dim s() As String

        Using sr As New StreamReader(FileName)
            s = Split(sr.ReadToEnd, vbCrLf)
        End Using

        Return s
    End Function

    Public Shared Sub GetNextSplitString(ByVal Value As Object, <Out()> ByRef Data As SqlChars)
        Data = New SqlChars(CType(Value, String))
    End Sub
End Class 
```

## 例子

```
select *, getdate() as [CreateDate], 1 as [AnotherColumn], 'xyz' as [ETC]
from dbo.FileToTable('c:\file.ext')

select line, left(line, 10), right(line, 10)
from dbo.FileToTable('c:\file.ext')

select ...
into [tablename]
from dbo.FileToTable('c:\file.ext') 
```

## 更多细节

像这样编译 CLR DLL：

```
c:\windows\microsoft.net\framework\v3.5\vbc.exe /target:library MyFileIO.vb 
```

像这样注册 CLR DLL：

```
create assembly MyFileIO from 'c:\MyFileIO.dll' with permission_set = unsafe
go
create function dbo.FileToTable (@FileName nvarchar(255)) returns table (line nvarchar(max)) as external name MyFileIO.TextFiles.FileToTable
go 
```

如果出现错误，您可能需要在 db 中启用 CLR 支持：

```
ALTER DATABASE [dbname] SET trustworthy ON
go
sp_configure 'clr enabled', 1
GO
RECONFIGURE
GO 
```

每当您更改 DLL 时，您必须删除过程和程序集并再次从上面运行代码以重新注册它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-19T20:28:00.143

您可以使用`Integration Services`（SSIS）

链接：http: [//msdn.microsoft.com/en-us/library/ms141026.aspx](http://msdn.microsoft.com/en-us/library/ms141026.aspx)

链接：[http ://technet.microsoft.com/en-us/library/ms169917%28v=sql.105%29.aspx](http://technet.microsoft.com/en-us/library/ms169917%28v=sql.105%29.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-19T20:33:03.143

如果在 SQL Server 中启用了 OLE 自动化（如果许多站点出于安全原因禁用它，这将是一个很大的问题），您可以`FileSystemObject`使用[sp_OACreate](http://msdn.microsoft.com/en-us/library/ms189763.aspx)和相关函数创建脚本的实例。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-20T00:02:58.047

这可以使用`FORMATFILE`.When 使用格式文件来完成，您可以跳过列。使用格式文件还有很多优点。

下面的查询会将行批量加载到 field 中`Line`。

```
CREATE TABLE TextFile
    (
    [Line] varchar(500) ,
    [FileName] varchar(100) ,
    [RecordDate] DATETIME DEFAULT GETDATE(),
    [RecordID] INT IDENTITY(1,1) ,
    )

    BULK INSERT TextFile FROM 'C:\FILE.TXT'
    WITH (FORMATFILE = 'C:\FILEFORMAT.XML') 
```

上述查询中使用的格式文件是：

```
<?xml version="1.0"?>
<BCPFORMAT xmlns="http://schemas.microsoft.com/sqlserver/2004/bulkload/format" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
 <RECORD>  
  <FIELD ID="1" xsi:type="CharTerm" TERMINATOR="\r\n" MAX_LENGTH="500" COLLATION="SQL_Latin1_General_CP1_CI_AS"/>
 </RECORD>
 <ROW>
  <COLUMN SOURCE="1" NAME="Line" xsi:type="SQLVARYCHAR"/>
 </ROW>
</BCPFORMAT> 
```

# ruby-on-rails - 虚荣宝石形式错误

> ID：12502219
> 
> 赞同：0
> 
> 时间：2012-09-19T20:15:21.753
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, vanity-url

我正在尝试将虚荣网址添加到我的应用程序中，我决定使用虚荣宝石。安装非常简单，一切似乎都运行良好。我能够创建一个虚荣网址并通过控制台将其放在用户身上。当我尝试在我的用户创建和用户更新中创建一个表单字段以输入一个虚 url 虽然它不起作用时。抛出以下错误。

虚荣（#2178512900）预期，得到字符串（#2151988680）

我不确定问题可能是什么。

我的用户控制器看起来像这样

```
 def new
     @user  = User.new
     @title = "Sign up"
   end 
```

我的表单视图看起来像

```
 <div class="field">
   <%= f.label :full_name, "Full Name" %><br />
   <%= f.text_field :name, :class => "label" %>
 </div>
 <div class="field">
    <%= f.label :email, "Email (@student.shu.edu)" %><br /> 
    <%= f.text_field :email, :class => "label" %>
 </div>
 <div class="field">
   <%= f.label :password %><br />
   <%= f.password_field :password, :class => "label" %>
 </div>
 <div class="field">
   <%= f.label :password_confirmation, "Password Confirmation" %><br />
   <%= f.password_field :password_confirmation, :class => "label" %>
 </div>
 <div class="field">
   <%= f.label :vanity, "Vanity" %><br />
   <%= f.text_field :vanity, :class => "label" %>
 </div> 
```

关于问题可能是什么或如何创建表单来提交我的虚荣网址的想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T23:38:15.263

基于该错误，您用于保存虚 URL 的任何方法似乎都需要 Vanity 类型的对象，而您正在传递一个字符串。您是否将字符串值直接从表单虚文本字段传递到不期望字符串的方法中？

无法查看您的创建和更新操作，这就是我可以提供的所有信息。希望它有助于激发一些“duh时刻”：D

干杯。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T22:48:39.827

实际上，我联系了该应用程序的开发人员，他能够为我阐明该表单如何适用于 gem，并使用 gem 使用示例应用程序更新了他发布的 github。这是示例应用程序的链接，[https://github.com/jaustinhughey/vtest](https://github.com/jaustinhughey/vtest)，希望这是其他遇到此问题的人。除了这个误解之外，gem 很棒而且很容易使用，所以我强烈推荐它。

# iphone - NSString vs %i with stringWithFormat

> ID：12502220
> 
> 赞同：-3
> 
> 时间：2012-09-19T20:15:34.333
> 
> 标签：iphone, objective-c, nsstring, stringwithformat

Ok I am not sure how or why this is working but if someone could explain this to me it would be greatly appreciated.

I am debugging an iPhone app and Xcode gives me the following warning, which is correct: "Format Specifies type 'int' but the Argument has a Type 'NSString'.

The code below returns a number, but if I set it to a string it returns a very long string. I know that they wanted the integer and not the string, but I do not know why this would return a number for a string because when I do change it using [str intValue] I get "0" not the long number. So how is this working, can someone explain this to me?

Here is the code:

```
- (void) FooBar:(NSString *)myStr
{
  NSString *callback = [NSString stringWithFormat:@"Some Text Here(%i)", myStr];

  [self.webView stringByEvaluatingJavaScriptFromString:callback];
} 
```

* * *

Ok let me show you what I mean, and don't worry about the string being passed please. I just want to know how it produces a number like what is shown below from it. I did three NSLogs:

```
- (void) FooBar:(NSString *)myStr
{
  NSString *callback = [NSString stringWithFormat:@"Some Text Here(%i)", myStr];
    NSLog(@"NSString = %@", myStr);
    NSLog(@"Percent i = %i", myStr);
    NSLog(@"Percent i = %i", [myStr intValue]);

  [self.webView stringByEvaluatingJavaScriptFromString:callback];
} 
```

Results:

```
NSString = /__utm.gif?utmwv=4.8mi&utmn=1220166202&utmt=event&utme=5(Init*shoutzVersion*iPhone%20Simulator)(1)&utmcs=UTF-8&utmsr=320x480&utmsc=24-bit&utmul=en-us&utmac=UA-28151051-1&utmcc=__utma%3D1.1697021890.1347557664.1348092917.1348092961.195%3B&utmht=1348092961213&utmqt=9984

Percent i = 154448576

Percent i = 0 
```

Anyone know why this happens?

Thank You!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T20:50:55.033

```
- (void) FooBar:(NSString *)myStr
{
  NSString *callback = [NSString stringWithFormat:@"Some Text Here(%@)", myStr];

  [self.webView stringByEvaluatingJavaScriptFromString:callback];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T20:20:35.110

如果数字（在您的情况下为长数字）超出范围，您可能会得到 [str intValue] 结果 0。试试 [str floatValue] 或 [str doubleValue] 看看结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-31T11:26:56.427

由于问题是“这个不正确的代码有什么作用”而不是“如何修复它”：

```
NSString *callback = [NSString stringWithFormat:@"Some Text Here(%i)", myStr]; 
```

myStr 是一个 NSString*。%i 是 int 的格式。因此，当 stringWithFormat 方法需要一个 int 时，您正在传递一个 NSString*。

正式地，这是“未定义的行为”，这意味着绝对有可能发生任何事情。

实际上，您可以在 32 位或 64 位计算机或 iPhone 上运行此代码。“int”在所有情况下都是 32 位。myStr 是一个 NSString*，它将是 32 位或 64 位。在 32 位计算机上运行，​​stringWithFormat 很可能会获取指针的 32 位，假装它们是 int 的 32 位，并相应地打印它们，所以通常你会得到一个很大的数字；如果 myStr == nil 你可能会得到一个 0 打印。这个数字只是一个对任何人都没有用的数字。

在 64 位计算机上，myStr 是一个 64 位指针。最有可能的是，64 位中的 32 位将被解释为 int 并以这种方式打印。然后剩下 32 位。由于您没有尝试打印任何其他参数，因此这些 32 位将被忽略并且不会造成任何伤害。如果你用过

```
[NSString stringWithFormat:@"Some text %i some number %i", myStr, 117]; 
```

在 64 位计算机上，那么第二个 %i 很可能会获取 myStr 指针的剩余 32 位而不是数字 117。如果您使用

```
 [NSString stringWithFormat:@"Some number %i some text %@", myStr, myStr]; 
```

这在 64 位计算机上可能是致命的。最有可能的是 %i 获取 myStr 的前 32 位。%@ 获取第一个 myStr 的其他 32 位，再加上另外 32 位，从而给出一个完全混乱的指针，并且尝试打印它很可能会崩溃。

# ruby-on-rails - Ruby on Rails：有没有办法从数据库中提取项目并以指定的顺序返回？

> ID：12502222
> 
> 赞同：3
> 
> 时间：2012-09-19T20:15:56.483
> 
> 标签：ruby-on-rails, postgresql, activerecord, rails-activerecord

我有一组项目 ID `item_ids`，.

我将此数组传递给 ActiveRecord 查询以从数据库中检索相应的项目：`Item.where(:id => item_ids)`

`item_ids`有没有办法让返回的项目与通过数组传入的顺序相同？

如果它有所作为，我在 Ruby on Rails 3.0.12 上使用 PostgreSQL 作为我的数据库。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-19T21:07:56.267

您可以让数据库进行排序并避免多次[`index`](https://ruby-doc.org/core/Array.html#method-i-index)调用，您只需要记住 SQL ORDER BY 按*表达式*而不是*列*排序：

```
whens = item_ids.collect.with_index { |id, i| "when #{id} then #{i}" }.join(' ')
items = Item.where(:id => item_ids).order("case id #{whens} end") 
```

# ruby-on-rails-3 - Rails 3 如何将假记录附加到 ActiveRecord 数组？

> ID：12502226
> 
> 赞同：0
> 
> 时间：2012-09-19T20:16:12.740
> 
> 标签：ruby-on-rails-3, activerecord

鉴于场景：

> 检索来自“ **ModelA** ”的**X**个记录的集合，然后对所述集合执行处理以构建“ **ModelB** ”的记录，但是**X**必须等于偶数才能进行处理，并且无论如何都必须进行处理，即使**X**是奇数。

 ******是否有可能伪造集合中的单个记录以获得偶数以便成功进行处理？

举个例子，我正在尝试做什么...

```
def generate_some_modelb_data
  collection = ModelA.somemethod
  #append fake record if collection is an odd number
  if collection.count%2 > 0
    collection << somefakehash
  end
  #process the collection
  ...
  ModelB.create(:attribute_a => processed_data, :attribute_b => processed_data....)
end 
```

我不想在 ModelA 中存储任何假数据，但是如果我附加到集合中的假数据存储在 ModelB 中，如果它允许我正确处理合法数据，那也没关系。我还应该补充一点，任何附加的假数据都不应与现有的 ModelA 记录有任何相似之处，即 id 等，它应该能够被识别为假数据以供将来处理。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T22:08:02.537

尝试将 替换`collection << somefakehash`为`collection.append(somefakehash)`。[根据文档](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html)，`<<`操作员会立即触发更新 SQL，而无需等待父节点上的保存或更新。******

# c# - Asynchronously raised events which use Invoke causing problems with multithreading

> ID：12502229
> 
> 赞同：-1
> 
> 时间：2012-09-19T20:16:31.180
> 
> 标签：c#, .net, multithreading, events

**Notice**: I do not control the UI code. Only the `class PeriodicalThing` code.

* * *

Consider this scenario:

The UI thread is happily doing UI stuff, while there is another background thread which periodically raises events. The events are subscribed to by some UI, which means the event handlers generally have to use `Invoke`.

What I need is a way to perform the clean up operation (cleaning up means stopping the background thread, basically) in safe manner, that guarantees:

1.  User-defined code (i.e. event handler code) is not asynchronously aborted in the middle of execution
2.  There are no more periodical operations executed or executing after the clean up function has returned
3.  No more event handlers will be executed or executing after the clean up function has returned

I came up with something, but there is a deadlock. The deadlock is basically an error in the user-defined code, where the usage of `BeginInvoke` could have fixed the problem, but a straight out deadlock in case of a non-trivial programming error isn't the way to go.
Also note that `BeginInvoke` only happens to work in the `FormClosing` scenario because the invocation list of a Form happens to be cleared after `FormClosing`; something that seems to be consistent but I haven't found it documented yet.

***If*** there is a solution, it's apparently not obvious, but maybe I'm missing out a trick. I can't believe noone has run into a similar problem before.

```
class PeriodicalThing
{
    bool abort = false;
    Thread PeriodicalThread;
    ...
    PeriodicalThreadProc()
    {
        while (!this.abort)
        {
            DoStuff();
            OnThingsHappened(new EventArgs(...));
        }
    }

    public event EventHandler<EventArgs> ThingsHappened;
    protected virtual void OnThingsHappaned(EventArgs e)
    {
        // update -- oversight by me - see Henk Holterman's answer
        var handler = this.ThingsHappened;
        if (handler != null)
        {
            handler(this, e);
        }
    }

    public void CleanUp()
    {
        this.abort = true;
        // ui thread will deadlock here
        this.PeriodicalThread.Join();
    }
} 
```

`...`

```
// user-defined code; consider this immutable
class Form1 : Form
{
    .ctor()
    {
        ...
        this.PeriodicalThing.ThingsHappened += this.ThingsHappenedHandler
    }

    private void ThingsHappenedHandler(object sender, EventArgs e)
    {
        if (this.InvokeRequired) // actually always true
        {
            // periodical thread will deadlock here
            this.Invoke(
                new Action<object, EventArgs>(this.ThingsHappenedHandler), sender, e)
                );
            return;
        }
        this.listBox1.Items.Add("things happened");
    }

    private void Form1_FormClosing(object sender, FormClosingEventArgs e)
    {
        this.PeriodicalThing.CleanUp();
    }
} 
```

When the UI thread is shutting down due to an event such as `FormClosing`, which happened on the UI thread, then it will trigger the clean up. When the background thread issues an `Invoke` at this time, the `Invoke` has to block until the UI thread is finished with its current event handler (which triggered the clean up in the first place). Also, the clean up operation needs to wait for the background thread (and thus the current Invoke) to terminate, causing a deadlock.

* * *

The optimal solution would be to interrupt the UI thread at `Thread.Join()` and let all the waiting Invokes execute, and then going back to `Thread.Join()`. But that seems impossible to me with C#. Maybe someone has a crazy idea how I could use some helper threads to move the clean up method away from the UI thread, but I don't know how I would do that.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T20:23:16.450

问题就在这里

```
public void CleanUp()
{
    this.abort = true;
    // ui thread will deadlock here
    this.PeriodicalThread.Join();  // just delete this
} 
```

将`Join()`阻塞（！）调用线程。而这反过来又会阻止所有 Invoke 操作。

这枚硬币的另一部分是

```
{
  if (this.InvokeRequired) // actually always true
    {
        // periodical thread will deadlock here
    //    this.Invoke(
        this.BeginInvoke(            // doesn't wait so it doesn't block
            new Action<object, EventArgs>(this.ThingsHappenedHandler), sender, e)
            );
        return;
    }
    this.listBox1.Items.Add("things happened");
 } 
```

BeginInvoke 无论如何都是对 Invoke 的改进，只要您只返回`void`并且不使 MessageLoop 过载。

但是请摆脱 Join()。它没有用。

### 编辑，因为某些部分不受您的控制：

以下确实是答案，并且是可能的：

> 在 Thread.Join() 中断 UI 线程并让所有等待的 Invokes 执行，然后返回 Thread.Join()

```
public void CleanUp()
{
    this.abort = true;

    while (! this.PeriodicalThread.Join(20)) 
    { 
       Application.DoEvents(); 
    }
} 
```

这不会死锁，但使用`Application.DoEvents()`. 您必须检查所有其他事件（FormClosing）中发生的情况，这也不在您的控制之下......
它可能会起作用，但需要进行一些严格的测试。

* * *

由于您正在混合线程和事件，请使用以下模式：

```
protected virtual void OnThingsHappaned(EventArgs e)
{
    var handler = ThingsHappened;

    if (handler  != null)
    {
        handler (this, e);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T20:36:31.327

我不喜欢建议重写，但我可以建议使用`BackgroundWorker`?

我发现它是一个快速简单的异步过程，您可以将有关其状态的消息发送回调用线程（如百分比或状态对象）。

可以在此处找到快速操作方法：http: [//msdn.microsoft.com/en-us/library/cc221403 (v=vs.95).aspx](http://msdn.microsoft.com/en-us/library/cc221403%28v=vs.95%29.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-19T20:44:24.770

不确定这是否适合您的情况，但我使用 BackGroundWorker 和 SupportCancellation。如果我离开，请发表评论，我将删除。

[BackgroundWorker.WorkerSupportsCancellation 属性](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.workersupportscancellation.aspx)

我使用它来延迟加载动态创建的昂贵的 FlowDocument。如果他们单击下一个文档，则需要取消该工作并开始下一个。

抱歉，我刚刚看到另一个 BackGroundWorker 以及您无法使用它的评论。我没有在 UI 级别使用它。我什至没有使用 WinForms。我在业务/数据层使用。

# perl - In Perl how can I save a hash that contains subroutine references?

> ID：12502232
> 
> 赞同：2
> 
> 时间：2012-09-19T20:16:39.693
> 
> 标签：perl, serialization, hashmap

As the title says, in Perl, how can I save a hash that contains a list of subroutine references? For example, I have the following hash that contains the references to the subroutines which are contained in other libraries:

```
my %testMap = (
  helloTest        => \&runHello,
  goodbyeTest      => \&runGoodbye,
); 
```

When I try to use [Data::Dumper](http://search.cpan.org/~smueller/Data-Dumper-2.131/Dumper.pm) in the following matter:

```
my($out) = new FileHandle ">$fileName"; 
my $serialized => Data::Dumper->Dump([\%testMap], [$HASH_REFERENCE]); 
print $out $serialized; 
close $out; 
```

I end up with a file that looks like the following:

```
$testMap = {
             'goodbyeTest' => sub { "DUMMY" },
             'helloTest' => sub { "DUMMY" }
           }; 
```

When I would like the output to look like what appears in the original listing, is there a way to do this?

Some experimentation with Data::Dumper and [Storable](http://search.cpan.org/~ams/Storable-2.39/Storable.pm) have so far turned up nothing and I suspect that it is due to the actual code for the references not being available to the code that is running.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-19T20:20:06.760

[`Storable`](https://metacpan.org/module/Storable#CODE-REFERENCES)从 2.05 版开始就能够序列化 coderefs。

```
use strict;
use warnings;
use Storable;
use Data::Dump 'dump';

{
    no warnings;             # Suppress 'used only once' warning
    $Storable::Deparse = 1;  # Needs to be set to true as per docs
    $Storable::Eval    = 1;       # Same as above
}

sub hello_world { print "Hello world!\n" }

my %hash = (
             helloTest => \&hello_world,
             byeTest   => sub { print "Goodbye!\n" },
           );

store \%hash, 'file';            # Could use freeze/thaw for
my $cloned = retrieve( 'file' ); # in-memory serialization

$cloned->{helloTest}();          # Prints 'Hello world!' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-19T20:29:12.933

设置[`$Data::Dumper::Deparse`](http://search.cpan.org/perldoc?Data%3a%3aDumper#Configuration_Variables_or_Methods)为真值。

这用于[`B::Deparse`](http://search.cpan.org/perldoc?B%3a%3aDeparse)从操作码重建源。这通常（但并非总是）有效。

```
$ perl -MData::Dumper -e 'sub foo { print "Hello world" };' \
>     -e  '$Data::Dumper::Deparse=1; print Dumper \&foo'
$VAR1 = sub {
            print 'Hello world';
        }; 
```

* * *

如果您想解析 Perl 源代码文件并提取子例程的文本，这是一个非常不同的问题。但是[也有一个包](http://search.cpan.org/perldoc?PPI)：

```
# quick and dirty sub extractor
use PPI;
use Data::Dumper;
$doc = PPI::Document->new( "your_source_code_file_name" );
foreach $sub ( @{$doc->find( 'PPI::Statement::Sub' )} ) {
  @t = $sub->tokens;
  $name = $t[2];
  $code = "sub " . join q//, @t[3..$#t];
  $teh_codez{$name} = $code;
}    
print Data::Dumper::Dumper \%teh_codez; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-19T20:40:14.503

首先，Data::Dumper 是一个调试工具，而不是序列化器。后者并不是那么好。至少，一定要设置`Purity`选项。这将使它在某些其他情况下不起作用的情况下起作用。但是，它仍然存在破坏别名的问题。

[Storable](http://search.cpan.org/perldoc?Storable)应该用于非平凡数据，我会使用[JSON::XS](http://search.cpan.org/perldoc?JSON%3a%3aXS)或 YAML 模块来处理平凡数据。

其次，您可以通过设置选项来*尝试您想要的东西。*`Deparse`

```
use Data::Dumper qw( Dumper );

my $serialised;
{
   local $Data::Dumper::Purity  = 1;
   local $Data::Dumper::Deparse = 1;
   $serialised = Dumper($struct);
} 
```

对于闭包和 XS 函数，它将失败，并且它不会捕获有效的编译指示。

```
my $struct = { f => do { my $x = 123; sub { $x } } }; 
```

生产

```
$VAR1 = {
          'f' => sub {
                     $x;
                 }
        }; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-20T00:14:40.053

我建议您将哈希与要调用的子程序的*名称*一起存储，然后在检索后将它们解析为子程序引用

这段代码显示了这个想法

```
use strict;
use warnings;

my %testMap = (
  helloTest   => 'runHello',
  goodbyeTest => 'runGoodbye',
);

$testMap{$_} = \&{$testMap{$_}} for keys %testMap;

$testMap{helloTest}();
$testMap{goodbyeTest}();

sub runHello {
  print "runHello\n";
}

sub runGoodbye {
  print "runGoodbye\n";
} 
```

# java - Jersey UniformInterfaceException trying to proxy to REST POST service

> ID：12502233
> 
> 赞同：4
> 
> 时间：2012-09-19T20:16:44.377
> 
> 标签：java, rest, post, firefox-addon, jersey

I keep receiving a 406 HTTP response when I try to execute code structured in this way. I have tried restructuring the code and the inputs many times, but I still receive this error, and I've gotten to the point I don't even really know what to debug. The exception seems to indicate that the `post()` method isn't supplying the `@FormParam`s in the desired format, but as you can see the `.accept(MediaType.APPLICATION_FORM_URLENCODED)` and the `@Consumes(MediaType.APPLICATION_FORM_URLENCODED)` do indeed match up.

I am using the Firefox add-on [HTTPRequester](https://addons.mozilla.org/en-us/firefox/addon/httprequester/) to pass in the `@FormParam`s and have ensured that I am passing them in with the appropriate Content-Type (`application/x-www-form-urlencoded`). I've run out of things to check. Does anyone have any ideas?

* * *

*The Proxy Service*

```
Client client = Client.create();
WebResource service = client.resource(myURL);

Form form = new Form();
form.add("value1", value1);
form.add("value2", value2);
form.add("valueN", valueN);

String returnValue = service.accept(MediaType.APPLICATION_FORM_URLENCODED).post(String.class, form); 
```

*The Actual Service*

```
@POST
@Produces(MediaType.APPLICATION_XML)
@Consumes(MediaType.APPLICATION_FORM_URLENCODED)
@Path("/theService")
public String theService(
        @FormParam("value1") String value1,
        @FormParam("value2") String value2,
        @FormParam("valueN") String valueN) {

    String returnValue = null;

    /*
     * Do Stuff
     */

    return returnValue;
} 
```

*The Exception*

```
com.sun.jersey.api.client.UniformInterfaceException: POST http://theURL/theService returned a response status of 406
at com.sun.jersey.api.client.WebResource.handle(WebResource.java:563)
at com.sun.jersey.api.client.WebResource.access$300(WebResource.java:69)
at com.sun.jersey.api.client.WebResource$Builder.post(WebResource.java:499) 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-19T20:43:19.753

[UniformInterfaceException](http://jersey.java.net/nonav/apidocs/1.5/jersey/com/sun/jersey/api/client/UniformInterfaceException.html)只是一个名称很差的包罗万象的异常（之所以这样命名，是因为它是一个提供统一接口的异常，无论错误如何）。它基本上是泽西岛的任何东西抛出的 IOException 。实际错误是[406 Unacceptable](https://en.wikipedia.org/wiki/List_of_HTTP_status_codes#4xx_Client_Error)：

> 请求的资源只能生成根据请求中发送的 Accept 标头不可接受的内容。

在这里你说你接受`MediaType.APPLICATION_FORM_URLENCODED`：

```
String returnValue = service.accept(MediaType.APPLICATION_FORM_URLENCODED).post(String.class, form); 
```

但是您的服务会产生`MediaType.APPLICATION_XML`：

```
@Produces(MediaType.APPLICATION_XML) 
```

由于您的服务器无法生成客户端表示将接受的任何内容，因此它返回 406 错误。

最有可能的是，您的意思是设置[`WebResource.type`](http://jersey.java.net/nonav/apidocs/1.4/jersey/com/sun/jersey/api/client/WebResource.html#type%28javax.ws.rs.core.MediaType%29)，而不是`accept`：

```
String returnValue = service.type(MediaType.APPLICATION_FORM_URLENCODED).post(String.class, form); 
```

# css - How to prevent Webkit text rendering change during CSS transition

> ID：12502234
> 
> 赞同：83
> 
> 时间：2012-09-19T20:16:44.560
> 
> 标签：css, webkit, css-transitions, css-transforms

I'm using CSS transitions to transition between CSS transformed states (basically transitioning the scale of an element). I notice that when the element is transitioning, the rest of the text on the page (in Webkit) tends to slightly alter its rendering until the transition is done.

Fiddle: [http://jsfiddle.net/russelluresti/UeNFK/](http://jsfiddle.net/russelluresti/UeNFK/)

I also noticed that this does not occur on my headers, which have the `-webkit-font-smoothing: antialiased` property/value pair on them. So, I'm wondering, is there any way to have the text maintain its default look (the "auto" value for font-smoothing) and not alter rendering during a transition.

I've tried explicitly setting the text to use the "auto" value, but that doesn't do anything. I should also note that setting font-smoothing to "none" also prevents the rendering blink during transition.

Any help is appreciated.

**Edit 1**

I should note that I am on OS X. While looking at my test in Chrome on Parallels, I did not see the two different paragraphs behaving differently, so this may be an issue exclusive to Macs.

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2012-10-10T13:19:20.240

我想我找到了一个解决方案：

```
-webkit-transform: translateZ(0px); 
```

**在父元素上强制硬件加速**似乎可以解决问题......

**编辑** 正如评论的那样，这个 hack 会禁用字体平滑，并且会根据您的字体、浏览器和操作系统降低文本渲染！

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2014-01-15T11:23:55.333

## **2020 年 8 月更新**

您不再需要使用媒体查询来定位 Safari 以启用亚像素字体平滑。默认是好的。

**然而**，虽然它默认使用亚像素字体平滑，但对于任何寻求**一致的文本渲染的**人来说，**Chrome 的字体平滑有一个明显***的美中不足*。

 ****1.  这是 Chrome 在深色背景上对浅色文本的渲染[![黑暗中的光明](../Images/00dc1f31bcae668cb594011b59161ce3.png)](https://i.stack.imgur.com/qRSiA.png)
2.  这是 Chrome 在浅色背景上对深色文本的渲染[![明暗暗](../Images/be42acd60f404e748b089ac3cd179145.png)](https://i.stack.imgur.com/vRH7O.png)

看上面字母 e 中整体的大小。深色背景上的浅色文本比浅色背景上的深色文本明显更重（具有相同的 css 字体样式）。

对于尊重用户的深色/浅色主题设置的网站，一种解决方案是使用仅限于深色模式的媒体查询来定位 Chrome，并将其切换为非亚像素平滑，如下所示：

```
@media screen
and (-webkit-min-device-pixel-ratio: 0)
and (min-resolution: 0.001dpcm)
and (prefers-color-scheme: dark) {
  body {
    -webkit-font-smoothing: antialiased;
  }
} 
```

结果 ：

[![明暗暗](../Images/be42acd60f404e748b089ac3cd179145.png)](https://i.stack.imgur.com/vRH7O.png)[![亮暗抗锯齿](../Images/d9ffe87c0a523213aec92b2cd2135519.png)](https://i.stack.imgur.com/GnoAf.png)

无论是在深色上渲染浅色还是在浅色上渲染深色，文本重​​量都更加一致。

查看之前和之后的并排比较： [![黑暗中的光明](../Images/00dc1f31bcae668cb594011b59161ce3.png)](https://i.stack.imgur.com/qRSiA.png)[![亮暗抗锯齿](../Images/d9ffe87c0a523213aec92b2cd2135519.png)](https://i.stack.imgur.com/GnoAf.png)

--

**2018 年 5 月更新**

`-webkit-font-smoothing: subpixel-antialiased`现在在 Chrome 中没有任何效果，但在 Safari 中，它仍然可以改善很多东西，但仅限于 RETINA。如果没有它，在视网膜屏幕上的 Safari 中，文本会变得单薄而乏味，而有了它，文本就会有适当的权重。但是如果你在 Safari 中的非视网膜显示器上使用它，（尤其是在轻量值下）文本是一场灾难。强烈建议使用媒体查询：

```
@media screen and (-webkit-min-device-pixel-ratio: 2) {
  body {
    -webkit-font-smoothing: subpixel-antialiased;
  }
} 
```

* * *

`-webkit-font-smoothing: subpixel-antialiased`如果您希望至少部分避免较薄的抗锯齿文本，则显式设置是当前最好的解决方案。

--tl;博士--

对于默认字体渲染使用亚像素抗锯齿的 Safari 和 Chrome，任何强制基于 GPU 渲染的 CSS，如上面使用 translateZ 使用变换甚至只是缩放转换的建议，都会导致 Safari 和 Chrome 自动“放弃" 关于亚像素抗锯齿字体平滑，而是切换到抗锯齿文本，它看起来更轻更薄，尤其是在 Safari 上。

其他响应集中在通过简单地设置或强制字体平滑到较薄的抗锯齿文本来保持恒定的渲染。在我看来，使用 translateZ 或 backface hidden 会显着降低文本渲染的质量，如果您希望文本保持一致并且您可以接受较薄的文本，那么最好的解决方案就是使用`-webkit-font-smoothing: antialiased`. 然而，显式设置`-webkit-font-smoothing: subpixel-antialiased`确实有一些效果 - 文本仍然略有变化，并且在 GPU 上呈现的过渡期间明显变薄，但没有没有此设置时那么薄。所以看起来这至少部分地阻止了切换到直接抗锯齿文本。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2013-07-16T20:03:39.987

我注意到几乎每次由于过渡而出现图形问题（闪烁/口吃/断断续续/等）时，使用 -webkit-backface-visibility: hidden; 在起作用的元素上往往会解决问题。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-03-06T06:59:29.460

要防止由于硬件加速而导致文本呈现更改，您可以：

1.  将所有文本设置为 -webkit-font-smoothing: antialiased。这意味着文本更薄并且没有亚像素抗锯齿。

2.  如果您希望对受硬件加速影响的文本进行亚像素抗锯齿（字体平滑的默认类型），那么将该文本放入输入中，没有边框并禁用，将保持该亚像素抗锯齿（至少在 Mac OS X 上的 Chrome 上）。我没有在其他平台上测试过，但如果亚像素抗锯齿很重要，你至少可以使用这个技巧。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2015-04-03T19:25:56.717

如果您在 Mac 上使用 Firefox，您将需要使用以下 css 来解决此问题。

```
-moz-osx-font-smoothing: grayscale; 
```

更多信息[请参阅 Firefox 和 Opera 中的 Webfont Smoothing and Antialiasing](https://stackoverflow.com/questions/11459746/css3-webfont-smoothing-and-antialiasing-in-firefox-and-opera)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2017-04-24T15:39:04.587

这对我有用。希望能帮助到你。在其他 stackoverflow 帖子中找到。

```
-webkit-font-smoothing:antialiased;
-webkit-backface-visibility:hidden; 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-09-22T12:11:21.830

要防止渲染更改，您需要设置`font-smoothing: antialiased`（或`none`）。

浏览器禁用亚像素字体渲染可能是硬件加速的副作用。当您正在渲染的背景不断变化时，文本无法在单独的图层上渲染，因为必须针对所有背景图层检查每一帧。这可能会严重降低性能。

[苹果经常在他们](https://www.apple.com) [自己的](https://www.icloud.com)网站上禁用亚像素字体平滑。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-05-15T16:57:09.503

除了上述解决方案（`-webkit-transform: translateZ(0px)`在元素`-webkit-font-smoothing: antialiased`上和页面上）之外，某些元素可能仍然表现不佳。对我来说，它是输入元素中的占位符文本：为此，请使用`position:relative`

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2014-04-04T22:21:37.093

我有同样的问题。仔细阅读：

> 我注意到当元素转换时，**页面上的其余文本**（在 Webkit 中）往往会稍微改变其呈现，直到转换完成。

上述解决方案似乎都不起作用。但是，设置（类似的东西）

```
#myanimation { -webkit-transform: translateZ(0px); } 
```

**在具有动画**的元素上确实有效。

通过将动画元素带到 GPU 层，您可以将其脱离页面渲染的正常流程（例如，z-index 之类的东西也不再起作用）。作为副作用，动画和页面的其余部分将不再相互影响。

如果它影响你的字体渲染，当然它只对动画元素起作用。我在我的 Chrome 中看不到有什么不同。****

# xcode - document.getElementsByClassName subgroup

> ID：12502235
> 
> 赞同：0
> 
> 时间：2012-09-19T20:16:50.397
> 
> 标签：xcode, cocoa

I want to get the value of a table cell. but when I choose the class, I get all values of the row. How can I specify may selection? My code since now: `[myWebView stringByEvaluatingJavaScriptFromString:@"document.getElementsByClassName('class_Name')[0].innerText;"];`

My Idea was to make it like this but it does not work:

`[waerungskurse stringByEvaluatingJavaScriptFromString:@"document.getElementsByClassName('charts_table_content')[0].[2].innerText;"];` The Number is the column I want to select.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T15:19:12.653

`document.getElementsByClassName('class')[0].getElementsByClassName('subClass')[0].innerText;`

# javascript - AngularJS - 使用异步响应更新范围值

> ID：12502237
> 
> 赞同：4
> 
> 时间：2012-09-19T20:16:53.467
> 
> 标签：javascript, angularjs

我正在尝试在 AngularJS 控制器之间共享一些数据。我也通过http请求获取数据。当我从控制器访问数据时，它为空，稍后（如果通过 UI 手动刷新），数据可用。我猜这个问题与[这里](https://stackoverflow.com/questions/10179488/the-view-is-not-updated-in-angularjs)非常相似 但是我在我的案例中尝试过的任何事情都没有奏效。请看小提琴

[http://plnkr.co/edit/6SkzXK?p=preview](http://plnkr.co/edit/6SkzXK?p=preview)

所以，在控制器中，我通过

```
//myService.setName(); //commented as it breaks the code 
```

它设置了服务和访问的价值`getName()`

它很可能可以通过 , 解决`$rootScope.$apply`，如上面的链接中所示，但我无法使其工作。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-19T20:45:59.980

问题是当你的控制器被初始化时，你将 getName() 的结果复制到一个变量`$scope.name = myService.getName()`中。由于`$scope.name`保存的是字符串而不是引用，因此在更改时不会更新`getName()`。

有 3 种方法可以解决此问题。

1.  制作`$scope.name = myService.getName`并将其用作功能`Hello {{name()}}`。
2.  使`myService.getName()`返回一个对象，`{ real_name: "foo" }`并`name.real_name`在视图上使用
3.  绑定`myService`到范围并直接使用`getName`函数`$scope.myService = myService;`和视图`myService.getName()`

我更喜欢第一个，因为它更清楚。当您有更多数据时，第二个很好。在我看来，第三个不是一个好方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T21:17:19.413

要让你的 plunker 工作，你需要做三件事：

1.  将 $http 服务注入到新服务中
2.  定义视图调用的 getName() 函数
3.  将 $scope 传递给 setName() 函数并更改 $scope 上的值

[http://plnkr.co/edit/6SkzXK](http://plnkr.co/edit/6SkzXK)

# octave - Displaying Filled Markers with scatter3 in Octave while using a colormap

> ID：12502239
> 
> 赞同：0
> 
> 时间：2012-09-19T20:16:57.400
> 
> 标签：octave, scatter-plot

Using the following, I am able to get a 3D scatter plot in Octave:

```
figure()
scatter3( ...
    plot_data(:, 2),  ...
    plot_data(:, 3),  ...
    plot_data(:, 4), ...
    % Marker size ...
    9, ...
    % Color data using colormap ...
    plot_data(:, 1)
    );
colormap(copper())
shg 
```

However, the markers are not filled. Alternatively, I could increase the `linewidth` but I have no idea how to do this in Octave when I am using `colormap` syntax.

How do I adjust the `scatter3` call above to either fill the markers or increase the `linewidth`?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T17:20:46.387

只是通过`filled`选项。``scatter3 ()`在独立于您随后选择的颜色图调用时使用以下内容：

```
scatter3 (plot_data(:, 2), plot_data(:, 3), plot_data(:, 4), 9, plot_data(:, 1), "filled"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-29T20:00:04.343

很抱歉恢复这个，但我今天遇到了问题。我解决了它归因于假色标，然后绘制：

```
vet_x = rand(1,100);
vet_y = rand(1,100);
vet_z = rand(1,100);
size_scale = linspace(1,10,length(vet_x));
fake_color = linspace(1,10,length(vet_x));

scatter3(vet_x,vet_y,vet_z,size_scale,fake_color,'filled')
colormap('copper') 
```

希望这可以帮助。

# iphone - iOS - Restkit：如何处理 xml 日期时间

> ID：12502248
> 
> 赞同：1
> 
> 时间：2012-09-19T20:17:42.213
> 
> 标签：iphone, ios, web-services, xml-parsing, restkit

我正在使用 Restkit 来使用发送回 XML 的 Web 服务。一些元素是日期时间类型。看起来 Restkit 想要将这些视为 NSDictionary。有没有更简单的方法来处理这个？也许某种方式来获取标签之间的文本？

这是我正在谈论的内容。像这样的 XML：

```
<lastRenewedDate xsi:type="xs:dateTime">2012-09-18T09:53:00-04:00</lastRenewedDate> 
```

Restkit 似乎是这样解释的：

```
lastRenewedDate =     {
    text = "2012-09-18T09:53:00-04:00";
    "xmlns:xs" = "http://www.w3.org/2001/XMLSchema";
    "xmlns:xsi" = "http://www.w3.org/2001/XMLSchema-instance";
    "xsi:type" = "xs:dateTime";
}; 
```

**编辑：**为了澄清，我问的是Restkit是否有办法直接在标签之间映射该文本：

```
2012-09-18T09:53:00-04:00 
```

直接映射到一个 NSString 而不是将它映射到一个 NSDictionary 并且我不得不把那个文本拿出来。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T21:46:02.710

不确定这是否是您所要求的，但是要获得作为 NSString 对象的时间，您可以这样做

```
 NSString *dateString = [dateFormatter stringFromDate: [[[NSArray objectAtIndex:*SOME INDEX*] objectForKey:@"lastRenewedDate"] objectForKey:@"text"]; 
```

, 其中 dateFormatter 是一个 NSDateFormatter 对象

[您可以在此处](https://stackoverflow.com/questions/6724180/converting-a-date-format-in-objective-c)查看如何使用 dateFormats

# memory - Memcache 内存过度分配

> ID：12502249
> 
> 赞同：0
> 
> 时间：2012-09-19T20:17:52.547
> 
> 标签：memory, memcached

是否有可能以对获取/设置性能产生不利影响的方式将内存过度分配给 Memcache？

我读过大多数 Memcache 操作都是 O(1)，所以我认为答案是否定的，但我不是 Memcache 方面的专家。

例如，当前分配的 4GB 空间已满，浪费了 12.5% 的空间，每秒发生 8 次驱逐。多个网站使用这个专用的 Memcache 服务器。那么，双倍、三倍等……内存会损害整个系统吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T00:09:47.187

通常不可能为 memcached 过度分配内存。这里的一个例外是，如果您分配的内存比实际可用的内存多，它会导致一些 memcached 地址空间被换出到磁盘。如果您在一台机器上运行的大量应用程序都使用大量内存，则可能会发生这种情况。

# python - Where is the documentation for dictionary generators in Python 3?

> ID：12502252
> 
> 赞同：1
> 
> 时间：2012-09-19T20:17:55.830
> 
> 标签：python, dictionary

I mean this:

```
>>> d = {a : a ** 2 for a in range(7)}
>>> d
{0: 0, 1: 1, 2: 4, 3: 9, 4: 16, 5: 25, 6: 36} 
```

I managed to find these resources:

*   [http://docs.python.org/py3k/tutorial/datastructures.html?highlight=dict%20comprehension](http://docs.python.org/py3k/tutorial/datastructures.html?highlight=dict%20comprehension)
*   [http://www.python.org/dev/peps/pep-0274/](http://www.python.org/dev/peps/pep-0274/)

These seem to be just tutorials; I want to find it in the documentation itself.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-19T20:22:49.247

您正在查找参考文档的表达式章节的[“列表、集合和字典的显示”部分](http://docs.python.org/py3k/reference/expressions.html#displays-for-lists-sets-and-dictionaries)。

该部分处理定义文字列表、集合和字典，以及这些类型的理解表达式。

> 为了构造一个列表、一个集合或一个字典，Python 提供了称为“显示”的特殊语法，它们中的每一个都有两种风格：
> 
> *   要么明确列出容器内容，要么
> *   它们是通过一组循环和过滤指令计算的，称为理解。

# wordpress - Does Free theams of wordpress with incripted code is hacking my sites?

> ID：12502253
> 
> 赞同：-4
> 
> 时间：2012-09-19T20:17:56.437
> 
> 标签：wordpress, security, wordpress-theming

Do any free Wordpress themes contain encrypted code that can hack my site? If it is possible, can you please tell us how to find and remove that code?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T21:13:21.833

您通过 Wordpress 仪表板下载的任何内容（无论是主题还是插件）都会在公开发布之前由 Wordpress 团队进行搜索。

与任何第三方一样，您必须注意的是在 Wordpress 之外可用但在 Wordpress 社区内不可用的免费主题。一些要记住的事情：

*   下载插件时，请确保您是从 Wordpress 插件存储库下载它，或者至少可以从其存储库中获得它。应该以健康的怀疑态度对待无法通过此服务获得的插件。如果您下载的插件无法通过 Wordpress 自己的服务获得，请检查下载插件的站点。它有信誉吗？谷歌搜索网站和插件。如果什么都没出现，请检查以确保其中包含的所有代码至少是可读的和自记录的。如果不是，请将其删除。
*   下载免费主题时，上述内容适用。检查以确保主题也可通过 Wordpress 的主题存储库获得。如果不是，请检查源网站的声誉。如果这不可用，请检查源代码。如果至少无法理解，请将其删除。

您最好的选择是确保您下载和安装的所有内容都来自 Wordpress 仪表板或受信任的高级网站。可信来源是关键。如果您不信任来源，请不要下载内容。

# jquery - 在没有服务器端 Web 技术（如 asp.net、asp.net mvc 等）的情况下构建 Web 应用程序

> ID：12502256
> 
> 赞同：2
> 
> 时间：2012-09-19T20:18:16.440
> 
> 标签：jquery, html, mono, client-server, client-side

我需要一个小型 Web 应用程序，它必须收集一些数据，例如客户信息、客户的工作详细信息等。我只想在客户端处理数据，然后使用 ajax 调用将该数据发送到服务器端，以存储该数据在某些数据库中，例如 Sql Server。我决定在客户端使用 HTML5、JQuery，在服务器端我将使用 Web 服务与我的数据库进行交互（很可能是 WCF 或 ASP.NET Web 服务），这些 Web 服务将由 JQuery AJAX 调用使用。为了公开服务，我将使用单声道。现在我的问题是，

> 我应该如何创建仅包含 html、javascript/jquery 和 css 的母版页或布局页以保留导航菜单等常见内容？
> 
> 如何使用母版页菜单加载不同的页面，以便 URL 可以添加书签？
> 
> 是否可以仅在客户端提交 html 表单？所以当用户点击提交按钮时，页面将被提交到客户端文件，数据将由该文件处理，如果需要，将通过 ajax 调用 Web 服务保存到数据库？如果可能，如何使用 jquery 文件处理提交的表单？

如果有人可以就方法/技术/方式提出建议，如果我应该改变我的方法，或者如果我可以通过使用任何其他开源技术进行任何改进，那将是非常有帮助的。我想，我问了很多事情，但小的建议和指导也会有很大的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T20:20:25.240

我曾在一些旧网站上使用 iframe 来模拟母版页（母版页还不存在）。

你应该能够做类似的事情

您还可以考虑使用像backbone.js 或knockout 这样的前端javascript 框架。那里有很多整洁的。

**编辑**

经过一番思考，我认为 knockout.js 可能最适合您。

# mysql - 带有参数的 UNIX_TIMESTAMP() 会中断查询缓存吗？

> ID：12502260
> 
> 赞同：3
> 
> 时间：2012-09-19T20:18:43.353
> 
> 标签：mysql, database

我知道使用 UNIX_TIMESTAMP() 会导致 MySQL 不缓存查询，这是合理的。但是，如果我使用 UNIX_TIMESTAMP() 来转换 DATETIME 列，它还会错过缓存吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T20:24:22.107

如果您将值或列作为参数传递给`UNIX_TIMESTAMP()`.

如果您不知道，对表的任何更改都会导致缓存被清除，这也是值得知道的。因此，如果您查询的表经常更改，那么您可能不会从查询缓存中获得太多好处。

从 5.5[手册](http://dev.mysql.com/doc/refman/5.5/en/query-cache-operation.html)：

> > 如果查询包含下表中显示的任何函数，则无法缓存该查询。
> > - 没有参数的 UNIX_TIMESTAMP()

# objective-c - 使用 facebook id、facebook sdk、ios 进行身份验证

> ID：12502272
> 
> 赞同：1
> 
> 时间：2012-09-19T20:19:20.880
> 
> 标签：objective-c, ios, facebook

通过使用 facebook 进行身份验证后

```
FBSessionLoginBehavior behavior =   FBSessionLoginBehaviorForcingWebView;
appDelegate.session             =   [[FBSession alloc] init];

[appDelegate.session  openWithBehavior:behavior 
                     completionHandler:^(FBSession *session, FBSessionState status, NSError *error) {
                         NSLog(@"session is %d",session.state);
                         [self dismissViewControllerAnimated:YES completion:nil];

                     }
 ]; 
```

我总是得到

```
session is 513 
```

**问题 ：**

```
what is the meaning of 513 
```

请协助我解决这个问题。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T20:27:16.133

[Facebook SDK 错误代码](http://fbdevwiki.com/wiki/Error_codes)告诉我它是“用户无法通过 API 戳”。[这](https://stackoverflow.com/questions/12432983/xcode-facebook-login-error-closed)似乎是明确地处理 513 错误。也看看[这个](https://stackoverflow.com/questions/12353476/post-image-on-facbook-wall-and-facebook-friends-wall)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-29T11:10:08.393

FBSession.state = 513 是 FBSessionStateOpen。我找不到任何解释这一点的文档，可能的会话状态是：（在 iOS FacebookSDK 中找到）

```
FBSessionStateCreated                   = 0,
FBSessionStateCreatedTokenLoaded        = 1,
FBSessionStateCreatedOpening            = 2,
FBSessionStateOpen                      = 1 | FB_SESSIONSTATEOPENBIT,
FBSessionStateOpenTokenExtended         = 2 | FB_SESSIONSTATEOPENBIT,
FBSessionStateClosedLoginFailed         = 1 | FB_SESSIONSTATETERMINALBIT, // NSError obj 
FBSessionStateClosed                    = 2 | FB_SESSIONSTATETERMINALBIT, // " 
```

数字是错误的，但州是对的。尝试“po session.state”，您将设置枚举值。

# android - Android 按钮在 4.1 中拉伸，但在 2.2 中没有

> ID：12502273
> 
> 赞同：0
> 
> 时间：2012-09-19T20:19:28.367
> 
> 标签：android, android-layout, android-version

我有一个简单的待办事项列表应用程序，带有一个黑色加号形状的按钮，可以将事情添加到列表中。在 android 2.2 中，黑色加号如下所示：

![在此处输入图像描述](../Images/9199c609dd9d270aca99661f15a80703.png)

然而，在 android 4.1 中，黑色加号看起来像这样：

![在此处输入图像描述](../Images/81ceed553c4903f499ced92446ea5c7d.png)

加号应该看起来像它在 2.2 中的样子。这是我的相应片段的 xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
    android:id="@+id/widget78"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical"
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:focusable="true" android:focusableInTouchMode="true">
<ListView
    android:id="@+id/taskslist"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_weight="10" />
<LinearLayout
    android:id="@+id/widget83"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_marginBottom="12dp"
    android:layout_marginLeft="8dp"
    android:layout_marginRight="8dp">
<EditText
    android:id="@+id/taskname"
    android:layout_width="wrap_content" 
    android:layout_height="fill_parent"
    android:background="@drawable/edittextbackground"
    android:layout_marginBottom="0dp"
    android:layout_marginLeft="0dp"
    android:layout_marginRight="2dp"
    android:hint=" Add Something :)"
    android:textSize="18sp"
    android:windowSoftInputMode="adjustNothing"
    android:cursorVisible="true"
    android:textColor="#000000"
    android:textCursorDrawable="@null"
    android:layout_weight="9999999"/>
<!--    android:imeOptions="actionGo"
    android:inputType="textImeMultiLine" 
    --> 
<FrameLayout
    android:layout_height="wrap_content"
    android:layout_width="wrap_content">
<Button
    android:id="@+id/addtask"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:background="@drawable/small_black_plus"
    android:layout_marginBottom="0dp"
    android:layout_gravity="center"
    android:layout_marginLeft="2dp"
    android:layout_marginRight="0dp"
    android:text="" />
</FrameLayout>
</LinearLayout>
</LinearLayout> 
```

为什么两个版本的布局看起来不同？我怎样才能让它们看起来一样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T20:33:29.503

我认为这可能与您管理资源文件的方式有关。您测试的设备是否具有不同的分辨率？您看到的失真可能是由于操作系统自动缩放您放入 drawable-mdpi 或 drawable-hdpi 文件夹中的资源以用于 xhdpi 屏幕。

以下是有关如何管理资源文件的很好参考，希望对您有所帮助：

[http://developer.android.com/guide/practices/screens_support.html](http://developer.android.com/guide/practices/screens_support.html)

编辑：

另外，看看这个问题：

[区别：android:background 和 android:src？](https://stackoverflow.com/questions/9458774/difference-androidbackground-and-androidsrc)

正如其他人所触及的那样，您可以尝试将您的 Button 更改为 ImageView。android 中的任何视图都可以通过设置 onClickListener 来用作按钮，就像使用 Button 一样。如果这样做，请尝试使用`android:src`属性而不是`android:background`. 我不认为这是您的问题的原因，因为我不确定不同版本的 Android 会导致您的视图大小不同，但也许在这两个想法之间，您可以找出一些可行的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T20:22:31.130

这是因为 4.1 中的新 TabHost 允许“可滚动”选项卡。看看如何水平滚动它？

为了使这在两个版本的 Android 上看起来都正确，我将使用资源限定符（在文件夹名称中）为不同的 API 级别创建一个 ViewStub，并为不同的选项卡使用相同的 ID，但明确设置你的字体大小不适合（或更改文本，这取决于您）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-19T20:23:19.203

或者您可以使用 ImageView 而不是 Button，它们在您的情况下的工作方式相同。

# mysql - Mysql Doctrine2外键失败

> ID：12502277
> 
> 赞同：1
> 
> 时间：2012-09-19T20:19:48.227
> 
> 标签：mysql, doctrine-orm

您好已经设置了一个带有表状态和 StoreLocations 的数据库。我为两者创建了实体。以及 RESTful 服务。在我的本地计算机上发布新位置时，一切正常。

我已将我的项目部署到另一台服务器，当我尝试在这台机器上发布新位置时，我收到以下错误

```
Code: 23000 
Message: SQLSTATE[23000]: Integrity constraint violation: 1452 Cannot add or update a child row: a foreign key constraint fails (`vitanica`.`StoreLocation`, CONSTRAINT `storelocation_ibfk_1` FOREIGN KEY (`state_id`) REFERENCES `state` (`id`))
File: /home/audioglobe.com/zend/vendor/doctrine/dbal/lib/Doctrine/DBAL/Statement.php
Line: 131 
```

我不明白为什么这会在一台机器上而不是另一台机器上工作。提前感谢您对这个问题的任何想法！

这是我的表：

```
mysql> show create table StoreLocation

| StoreLocation | CREATE TABLE `StoreLocation` (
`id` int(11) NOT NULL AUTO_INCREMENT,
`name` varchar(60) DEFAULT NULL,
`address` varchar(80) DEFAULT NULL,
`city` varchar(80) DEFAULT NULL,
`state_id` int(11) DEFAULT NULL,
`zip` varchar(12) DEFAULT NULL,
`phone` varchar(20) DEFAULT NULL,
`lat` float(10,6) DEFAULT NULL,
`lng` float(10,6) DEFAULT NULL,
PRIMARY KEY (`id`),
KEY `state` (`state_id`),
CONSTRAINT `storelocation_ibfk_1` FOREIGN KEY (`state_id`) REFERENCES `state` (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=15 DEFAULT CHARSET=latin1 |

mysql> show create table State

| State | CREATE TABLE `State` (
`id` int(11) NOT NULL AUTO_INCREMENT,
`code` varchar(10) NOT NULL,
`state` varchar(255) NOT NULL,
PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=51 DEFAULT CHARSET=latin1 | 
```

还有来自我的实体的片段：

```
/** @Entity */ 
class State
{
  ....
    /** @OneToMany(targetEntity="StoreLocation", mappedBy="state") */
    private $stores;
}

/** @Entity @HasLifecycleCallbacks*/
class StoreLocation
{
    /**
    * @ManyToOne(targetEntity="State", inversedBy="id")
    */
    private $state;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T23:22:05.240

似乎 fk 失败了，因为 mysql 在生产中区分大小写。表名`State`虽然是引用的约束`state(id)`。我将所有表名更改为小写，并将该属性添加`@Table('state')`到我的实体中。现在一切都按预期工作！谢谢你们的帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T20:39:33.063

约束的要点是，在 内`StoreLocation`，你不能有一个`state_id`不存在于`State`表中的 a。

您是否在`State`表格中填写了完整的状态列表？

# regex - 选择包含电话号码的行的正则表达式

> ID：12502278
> 
> 赞同：2
> 
> 时间：2012-09-19T20:20:06.550
> 
> 标签：regex

我为选择包含电话号码的行编写了正则表达式代码。我必须为电话号码创建一个表达式，但它可能有 - 或 . 在数字之间，它可能有也可能没有扩展名。我想不通也没有提交作为我的家庭作业......我只是想知道它是如何正确完成的，因为我可能会在学期末的考试中得到它。

718-951-5000、718.951.5000、(718)-951-5000

我的代码

```
 "(^(\([2-9]\\d{2}\)|[2-9]\\d{2})[- .]?\d{3}[- .]?\\d{4}$)|(^(\([2-9]\\d{2}\)|[2-9]\\d{2})[- .]?\d{3}[- .]?\\d{4}[xX]\\d{1,4}$)" 
```

我的错误 *RETest1.java:4：错误：非法转义字符*

```
 "(^(\([2-9]\\d{2}\)|[2-9]\\d{2})[- .]?\\d{3}[- .]?\\d{4}$)|(^(\([2-9]\\d{2}\)|[2-9]\\d{2})[- .]?\\d{3}[- .]?\\d{4}[xX]\\d{1,4}$)"
                       ^ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-04-15T06:32:55.987

它可能不是最漂亮的，但这是一个有效的：

```
"^((\\([2-9]\\d{2}\\)|[2-9]\\d{2})(-\\d{3}-\\d{4}|\\.\\d{3}\\.\\d{4})([Xx] ?\\d{1,4})?)$" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T20:22:00.410

`[- .]?\d{3}[- .]?`

`\`你忘了第二次逃跑`\d`

应该： `"(^(\([2-9]\\d{2}\)|[2-9]\\d{2})[- .]?\\d{3}[- .]?\\d{4}$)|(^(\([2-9]\\d{2}\)|[2-9]\\d{2})[- .]?\\d{3}[- .]?\\d{4}[xX]\\d{1,4}$)"`

# fips - 此实现不属于 Windows 平台 FIPS 验证的加密算法，同时缓存

> ID：12502281
> 
> 赞同：4
> 
> 时间：2012-09-19T20:20:06.947
> 
> 标签：fips

我们创建了一个 Web 应用程序，它缓存状态的下拉列表并且每周只重新缓存一次。我在注册表中禁用了 FIPS，但找不到有关如何解决此问题的任何信息。

每次我运行应用程序时都会收到 FIPS 错误，尽管 FIPS 被禁用。

编辑：我已经在 dev.exe.config 文件中添加了这一行

问题仍然存在。任何人都知道当我不应该知道 fips 存在时，我是如何收到 FIPS 错误的。（我已经多次重启我的电脑，希望也能解决这个问题）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-20T13:19:29.457

这是一个非常难研究的问题。如果您在完成我上面所说的操作后仍然遇到问题，这就是您可以解决的方法。（假设您可以在您的计算机上关闭 FIPS 合规性。）转到 HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Lsa 在此文件夹中，您应该会看到 FipsAlgorithmPolicy。删除此注册表项并重新启动。如果您的系统是双重加密的，您将无法在 .net 中运行任何形式的缓存。

这是我在这个问题上找到的文档。 [https://getsatisfaction.com/web_active_directory/topics/why_do_i_get_a_parser_error_message_about_windows_platform_fips](https://getsatisfaction.com/web_active_directory/topics/why_do_i_get_a_parser_error_message_about_windows_platform_fips)

[http://blogs.msdn.com/b/webtopics/archive/2009/07/20/parser-error-message-this-implementation-is-not-part-of-the-windows-platform-fips-validated-密码算法-当-net-page-has-debug-true.aspx](http://blogs.msdn.com/b/webtopics/archive/2009/07/20/parser-error-message-this-implementation-is-not-part-of-the-windows-platform-fips-validated-cryptographic-algorithms-when-net-page-has-debug-true.aspx)

[http://blogs.iis.net/webtopics/archive/2009/07/20/parser-error-message-this-implementation-is-not-part-of-the-windows-platform-fips-validated-cryptographic-算法-当-net-page-has-debug-true.aspx](http://blogs.iis.net/webtopics/archive/2009/07/20/parser-error-message-this-implementation-is-not-part-of-the-windows-platform-fips-validated-cryptographic-algorithms-when-net-page-has-debug-true.aspx)

# php - 卷曲到 node.js 的服务器。但不返回任何东西。如何让 server.js 返回 200 json？

> ID：12502286
> 
> 赞同：0
> 
> 时间：2012-09-19T20:20:52.020
> 
> 标签：php, node.js, curl, express, redis

我在 node.js 上使用通知系统，我正在尝试在 php 中使用 curl 并向其推送通知。

但是，每次我在终端或 php 中使用 curl 时，它都不会返回任何内容，但确实会推送通知。

如何使此代码返回 200 而不是什么都不返回并保持 curl 运行直到超时？

```
/* CONFIGURATION */

/* Web Server Config */
var _postpath = '/send';
var _listenport = 8888;
var _listenaddr = '0.0.0.0';  //use '0.0.0.0' to listen on all interfaces

/* Slave (sub) Redis Server Config */
var _channelfilter = '*';
var _sub_db_addr = '127.0.0.1';
var _sub_db_passwd_protected = true;
var _sub_db_passwd = 'secret';
var _sub_db_port = 6379;  //default redis port is 6379

/* Master (pub) Redis Server Config */
var _pub_db_addr = '127.0.0.1';
var _pub_db_passwd_protected = true;
var _pub_db_passwd = 'secret';
var _pub_db_port = 6379;  //default redis port is 6379

/* SocketIO Config */
var _loglevel = 1;

/* simple-pub-sub Config */
var _secretkey = "secret";

/* SERVER CODE -- DO NOT MODIFY */
redis = require('redis');
express = require('express');
socketio = require('socket.io');
fs = require("fs"),
pub = redis.createClient(_pub_db_port, _pub_db_addr); if (_pub_db_passwd_protected) {  }

sub = redis.createClient(_sub_db_port, _sub_db_addr); if (_sub_db_passwd_protected) { }
sub.on("pmessage", function(pattern, channel, json) { io.sockets.volatile.emit(channel, JSON.parse(json)); });
sub.psubscribe('*');

app = express.createServer(express.static(__dirname + '/public'),express.bodyParser());
app.listen(_listenport, _listenaddr);
app.post(_postpath, function(req, res){
  if(req.body.secretkey==_secretkey){
    delete req.body.secretkey; pub.publish(req.body.channel, JSON.stringify(req.body))
  }
});

io = socketio.listen(app);
io.configure(function () { io.set('log level', _loglevel) }); 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T20:41:49.220

只需在帖子上发送 200 代码

```
app.post(_postpath, function(req, res){
  if(req.body.secretkey==_secretkey){
    delete req.body.secretkey; pub.publish(req.body.channel, JSON.stringify(req.body));
    res.send(200);
  }
}); 
```

# javascript - 使用 json 数据创建表

> ID：12502287
> 
> 赞同：-6
> 
> 时间：2012-09-19T20:20:54.747
> 
> 标签：javascript, jquery, ajax

如果我的 ajax 调用返回了一些数据。我需要循环并创建一个 Html 字符串，该字符串创建如下表：

```
 ID    NAME                  Object Type
 ==============================================
 1     SWT-F1-S32-RTR-1      Network Switch
 2     SWT-44-SR1-RTR-1      Network Switch
 etc. 
```

这是我的 json 数据的样子：

```
[
   {
      "name": "SWT-F1-S32-RTR-1",
      "id": "1",
      "dict_value": "Network switch"
   },
   {
      "name": "SWT-44-SR1-RTR-1",
      "id": "2",
      "dict_value": "Network switch"
   },
   {
      "name": "SWT-44-SR1-SW-1",
      "id": "3",
      "dict_value": "Network chassis"
   },
   {
      "name": "SWT-F1-S32-SW-2",
      "id": "4",
      "dict_value": "Network chassis"
   },
   {
      "name": "SWT-44-165-SW-1",
      "id": "5",
      "dict_value": "Network chassis"
   },
   {
      "name": "SWT-44-263-SW-1",
      "id": "6",
      "dict_value": "Network chassis"
   },
   {
      "name": "SWT-11-228-SW-1",
      "id": "7",
      "dict_value": "Network chassis"
   },
   {
      "name": "SWT-F1-S32-SW-1",
      "id": "8",
      "dict_value": "Network chassis"
   },
   {
      "name": "SWT-F2-204-SW-1",
      "id": "9",
      "dict_value": "Network chassis"
   },
   {
      "name": "SWT-R1-CC104-SW-1",
      "id": "10",
      "dict_value": "Network chassis"
   },
   {
      "name": "SWT-5-103-SW-1",
      "id": "11",
      "dict_value": "Network chassis"
   },
   {
      "name": "SWT-F1-1PF-SW-1",
      "id": "12",
      "dict_value": "Network switch"
   },
   {
      "name": "SWT-F1-1PE-SW-1",
      "id": "13",
      "dict_value": "Network chassis"
   },
   {
      "name": "SWT-11-123-SW-1",
      "id": "15",
      "dict_value": "Network switch"
   },
   {
      "name": "SWT-32-M402-SW-1",
      "id": "17",
      "dict_value": "Network switch"
   },
   {
      "name": "SWT-66-102-SW-1",
      "id": "18",
      "dict_value": "Network switch"
   },
   {
      "name": "SWT-R1-CC011-SW-1",
      "id": "19",
      "dict_value": "Network chassis"
   },
   {
      "name": "SWT-R1-CC239-SW-1",
      "id": "20",
      "dict_value": "Network switch"
   },
   {
      "name": "SWT-R1-CCPH-SW-1",
      "id": "21",
      "dict_value": "Network switch"
   },
   {
      "name": "SWT-32-K218-SW-1",
      "id": "23",
      "dict_value": "Network switch"
   },
   {
      "name": "SWT-SB1-204-SW-1",
      "id": "24",
      "dict_value": "Network chassis"
   },
   {
      "name": "SWT-SB3-107-SW-1",
      "id": "25",
      "dict_value": "Network switch"
   },
   {
      "name": "SWT-SB4-110-SW-1",
      "id": "26",
      "dict_value": "Network switch"
   },
   {
      "name": "SWT-5-119-SW-1",
      "id": "27",
      "dict_value": "Network switch"
   },
   {
      "name": "SWT-F2-113-SW-1",
      "id": "39",
      "dict_value": "Network chassis"
   },
   {
      "name": "Core Switch HSRP",
      "id": "91",
      "dict_value": "Network switch"
   },
   {
      "name": "SWT-MLO-106-SW-1",
      "id": "275",
      "dict_value": "Network switch"
   },
   {
      "name": "SWT-STP-001-SW-1",
      "id": "277",
      "dict_value": "Network switch"
   },
   {
      "name": "SWT-F1-169-SW-1",
      "id": "281",
      "dict_value": "Network switch"
   },
   {
      "name": "SWT-R1-F108-SW-1",
      "id": "283",
      "dict_value": "Network switch"
   },
   {
      "name": "SWT-GH-001-SW-1",
      "id": "285",
      "dict_value": "Network switch"
   },
   {
      "name": "SWT-11-228-SW-2",
      "id": "301",
      "dict_value": "Network switch"
   },
   {
      "name": "SWT-44-010-SW-1",
      "id": "303",
      "dict_value": "Network switch"
   },
   {
      "name": "SWT-44-141-SW-1",
      "id": "305",
      "dict_value": "Network switch"
   },
   {
      "name": "SWT-F1-169-SW-2",
      "id": "309",
      "dict_value": "Network switch"
   },
   {
      "name": "SWT-F2-114-SW-1",
      "id": "311",
      "dict_value": "Network switch"
   },
   {
      "name": "SWT-66-114-SW-1",
      "id": "313",
      "dict_value": "Network switch"
   },
   {
      "name": "SWT-R1-1109-SW-1",
      "id": "315",
      "dict_value": "Network switch"
   },
   {
      "name": "SWT-32-L009-SW-1",
      "id": "317",
      "dict_value": "Network switch"
   },
   {
      "name": "SWT-SB1-204-SW-2",
      "id": "319",
      "dict_value": "Network switch"
   },
   {
      "name": "SWT-5-103-SW-2",
      "id": "321",
      "dict_value": "Network switch"
   },
   {
      "name": "SWT-5-114-SW-1",
      "id": "323",
      "dict_value": "Network switch"
   },
   {
      "name": "SWT-F1-1PL-SW-1",
      "id": "325",
      "dict_value": "Network chassis"
   },
   {
      "name": "CAES-0xx-CAGE",
      "id": "365",
      "dict_value": "Network switch"
   },
   {
      "name": "SWT-R1-H109-SW-1",
      "id": "379",
      "dict_value": "Network chassis"
   },
   {
      "name": "SWT-FM-001-SW-1",
      "id": "385",
      "dict_value": "Network switch"
   },
   {
      "name": "SWT-LSQ-BSMT-SW-1",
      "id": "415",
      "dict_value": "Network switch"
   },
   {
      "name": "SWT-44-152-SW-1",
      "id": "417",
      "dict_value": "Network chassis"
   }
] 
```

**编辑 1** 这是我到目前为止的代码：

```
 $.ajax({
            url:"<?php echo site_url('switches/getallswitches/');?>",
            type:'POST',
            dataType:'json',
            success: function(returnDataFromController) {
                    var htmlstring;
                    htmlstring="<select name='L2Locations' id='L2Locations'>";
                    htmlstring = htmlstring + "<option value='all'>All</option>";

                    //console.log(returnDataFromController);
                     var JSONdata=returnDataFromController;
                     console.log(JSONdata);
                     if (JSONdata.length != 0) 
                     {
                            $.each(JSONdata, function(i, objswitch) {
                            var row = $('<tr class="alt2 section_1">').appendTo($('#table'));
                            row.append($('<td>').append($('<strong>').text(objswitch.name)));
                            $.each(objswitch.id, function(j, comparisonValue) {
                                row.append($('<td>').text(comparisonValue));
                            });
                        });

                     }

                }//success

        });//end ajax 
```

它基于另一篇文章中的示例。但我不确定如何将“行”转换为 html 字符串，因此我最终可以执行 (#nameofdiv).html(htmlstring) 之类的操作。

对不起，到目前为止所有读过这篇文章的人。这是疯狂的一天，并不是说你必须在发表讨厌的言论之前查看我的其他帖子，但为了它的价值，我今天一直在与其他人在 stackoverflow 上解决一些有趣的 ajaax 问题。而且我想我太快了，无法进入。我立马中招了！哇。无论如何。谢谢你的耐心。希望这篇文章更清楚一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T20:44:10.033

问题是循环中引用的表名不正确。

# ajax - 为ajax设置跨域jsonp回调函数

> ID：12502294
> 
> 赞同：0
> 
> 时间：2012-09-19T20:21:37.540
> 
> 标签：ajax

```
 $('#image_upload_form input').change(function() {

        if ( $(this).val() == '') return false;

        $('#image_upload_form').ajaxSubmit({
            url: "http://www.test.com/offers/upload_image?callback=?",
           type: "POST",
           dataType: 'jsonp',
           data: {},
            jsonpCallback: 'mycallback',

            success: function ( data ) { })     
            }   //success
            });      //submit

        //place1    var mycallback=function(data) { console.log(data);}

    });

       //place2     
       var mycallback=function(data) { console.log(data);} 
```

我的第一个问题是我应该把那个 jsonpCallback 函数放在哪里？place1 或 place2 或者没关系

从服务器端，我确保输出响应是

```
 mycallback({.....}); 
```

我在 mycallback 函数附近设置了一个断点，但它似乎没有启动。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T20:25:23.327

你没有。
jQuery 自动创建回调；你可以写

```
$.getJSON("http://www.test.com/offers/upload_image?callback=?", function(...) { ... }) 
```

# asp.net - 会话超时后重定向到登录页面

> ID：12502295
> 
> 赞同：6
> 
> 时间：2012-09-19T20:21:39.130
> 
> 标签：asp.net, .net, vb.net, visual-studio-2010, session-timeout

我发现了一些类似的问题，但没有一个给我我真正需要的东西。

这是事情，我已将其添加到我`web.config`的处理用户会话到期：

```
<sessionState mode="InProc" timeout="1" /> 
```

1分钟后，引发`Session_End`事件：`Global.asax`

```
Sub Session_End(ByVal sender As Object, ByVal e As EventArgs)
    Response.Redirect("Login.aspx")
End Sub 
```

这不起作用，因为：

```
Response is not available in this context. 
```

（顺便说一句，[这个问题](https://stackoverflow.com/questions/6264421/how-to-redirect-to-home-page-after-session-timeout/6264446#6264446)得到了一个答案，表明这没问题，并且得到了赞成）。

我不想要任何花哨的东西。我只想要一种简单的方法在会话时间到期时将用户重定向到登录页面。就这样。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T20:25:10.020

### 描述

您可以`Page_Init`在`global.asax`

### 样本

```
Protected Sub Page_Init(sender As Object, e As EventArgs)
 If Context.Session IsNot Nothing Then
  If Session.IsNewSession Then
   Dim newSessionIdCookie As HttpCookie = Request.Cookies("ASP.NET_SessionId")
   If newSessionIdCookie IsNot Nothing Then
    Dim newSessionIdCookieValue As String = newSessionIdCookie.Value
    If newSessionIdCookieValue <> String.Empty Then
     ' This means Session was timed Out and New Session was started
     Response.Redirect("Login.aspx")
    End If
   End If
  End If
 End If
End Sub 
```

### 更多信息

*   [在 ASP.NET 中检测会话超时并重定向到登录页面](http://csharpdotnetfreak.blogspot.com/2008/11/detecting-session-timeout-and-redirect.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-19T20:53:48.817

Session_End 是一个**服务器端**事件，意味着它是在 Web 服务器上触发的，与客户端的请求无关。这就是请求不可用的原因。

在这件事上你有两个选择：

1.  在每个客户端请求上，检查是否设置了特定的 Session 变量。如果不是，则表示之前的 Session 已过期，必须填充新的 Session。（我假设这就是您要检查会话到期的原因）

2.  在客户端上进行 javascript 调用，定期返回服务器以检查 Session 是否仍然有效。如果 Session 已过期，您可以将用户重定向到登录页面。

不同重定向方法的示例

```
location.href = "login.aspx";
// or you can use 
location.assign("login.aspx");
//for redirecting without storing in history
location.replace("login.aspx") 
```

不要忘记添加`?ReturnUrl=[current url]`到登录重定向路径。

高温高压

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-19T22:14:22.630

检查每个 Page_Init 事件的过期会话。如果有太多页面要做这个检查，我通常会这样做：

*   我创建了一个基类并从 System.Web.UI.Page 继承。
*   在我的基类的 Page_Init 事件中编写我的重定向逻辑。
*   让我的其余页面继承自这个基类。

祝你好运。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-27T16:02:05.197

[这是dknaack 答案](https://stackoverflow.com/a/12502326/1264804)的 C# 版本：

```
protected void Page_Init(object sender, EventArgs e)
{
    if (Context.Session != null)
    {
        if (Session.IsNewSession)
        {
            HttpCookie newSessionIdCookie = Request.Cookies["ASP.NET_SessionId"];
            if (newSessionIdCookie != null)
            {
                string newSessionIdCookieValue = newSessionIdCookie.Value;
                if (newSessionIdCookieValue != string.Empty)
                {
                    // This means Session was timed Out and New Session was started
                    Response.Redirect("Login.aspx");
                }
            }
        }
    }
} 
```

# python - IsPrime 函数错误？

> ID：12502307
> 
> 赞同：0
> 
> 时间：2012-09-19T20:22:49.083
> 
> 标签：python

我写了这个函数来检查一个数字是否是素数。它本身似乎可以正常工作，但是当我在另一个函数中使用它时，它似乎不起作用。

这是我的 IsPrime 函数：

```
def is_prime(n):
    boolean = False
    if n == 2 or n == 3:
            return True
    for x in range(3, int(n**0.5)+1, 2):
        if n % x == 0:
            return False
    return True 
```

下面的函数计算 2000000 以下的所有素数之和：

```
def problem10(prime, result):
    if prime > 2000000:
        return 
    if is_prime(prime):
        print 'prime is ', prime 
        result = result + prime
        problem10(prime + 1, result)
    return result 
```

我不明白我哪里出错了。

评论将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-19T20:30:41.777

`is_prime`不检查偶数。例如，如果你传递了 4，它会发现它既不是 2 也不是 3，然后继续执行循环，该循环将执行一次，检查它是否能被 3 整除（它不是）。退出循环，它会返回`True`，当我们知道 4 实际上不是素数时。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-19T20:42:37.303

您的`problem10`功能流程中有一个错误。归结为您实际上并未使用递归`problem10`函数的结果值。您希望您的代码看起来像这样（假设您想保持递归，您可能需要考虑使用循环）：

```
def problem10(prime):
    """ calculates the sum of primes from this prime until 2000000 (2 * 10**6) """
    if prime >= 2000000:
       return 0
    elif is_prime(prime):
       return prime + problem10(prime + 1)
    else:
       return problem10(prime + 1) 
```

请注意，此函数方法有几个关键点需要考虑：

1.  如果素数 >= 2000000，则此函数表示空和。因此返回 0。
2.  如果 is_prime(prime)，则此函数应将素数添加到总和中
3.  否则，总和与下一个数字的素数总和相同（因为无论如何我们都必须排除较低的数字，因为它不是素数）。
4.  与您最初的尝试相比：请注意在 return 语句中使用表达式如何大大简化了函数的逻辑（流程）。它确实更具可读性。另外，请注意您的原始功能是如何工作的，因为：

    一个。您的函数不会更新运行总计（结果）

    湾。即使确实如此，最终您最终还是会添加`None`一些内容，因为您的原始函数在素数 >= 2000000 的情况下没有返回任何内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-19T21:45:19.210

一个更快的素数列表是这样的：

```
import numpy as np

def primesfrom2to(n):
    """ Returns a array of primes, p < n """
    assert n>=2
    sieve = np.ones(n/2, dtype=np.bool)
    for i in xrange(3,int(n**0.5)+1,2):
        if sieve[i/2]:
            sieve[i*i/2::i] = False
    return np.r_[2, 2*np.nonzero(sieve)[0][1::]+1] 
```

然后只是总和：

```
print sum(primesfrom2to(2000000)) 
```

如果你想使用你的函数，这里是一个建议的重写：

```
def is_prime(n):
    if n in (2,3):
        return True
    if not n%2:
        return False        
    if any(n%x == 0 for x in xrange(3, int(n**0.5)+1, 2)):     
        return False   
    return True 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-19T22:15:20.920

*这是您的 is_prime 函数的正确版本，它使用试除以 2 和从 3 到n*的平方根的奇数来确定 n 是素数还是复合数：

```
def is_prime(n):
    if n % 2 == 0:
        return n == 2
    d = 3
    while d * d <= n:
        if n % d == 0:
            return False
        d += 2
    return True 
```

解决问题的更好方法是使用埃拉托色尼筛法识别所有小于 2000000 的素数，然后将它们相加。这是一个简单的埃拉托色尼筛法：

```
def sieve(n):
    b, p, ps = [True] * (n+1), 2, []
    for p in xrange(2, n+1);
        if b[p]:
            ps.append(p)
            for i in xrange(p+p, n+1, p):
                b[i] = False
    return ps 
```

有更好（更快）的方法来确定一个数字是素数还是合数，并生成所有素数的列表，但这些对于您的任务来说已经足够了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-02-20T09:58:42.250

```
def isPrime(num,div=2):
if(num==div):
    return True
elif(num % div == 0):
    return False
else:
    return isPrime(num,div+1) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-19T20:31:59.497

您是否应该这样检查范围

```
for x in range(2, sqrt(n)+1):
    if n % x == 0:
        return False 
```

没有任何根会大于平方根。

# ruby-on-rails - 获取两个日期之间的月份名称

> ID：12502315
> 
> 赞同：6
> 
> 时间：2012-09-19T20:24:03.553
> 
> 标签：ruby-on-rails, ruby, date

我必须使用 Ruby 在两个日期之间按顺序获取所有月份的名称。例如，我想得到：

```
['jan','feb','mars'] 
```

当我在以下之间进行区分时：

```
1st january and March 15th 
```

我也希望它在日期差异大于一年时工作。

任何的想法？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-19T22:37:21.720

我会去：

```
d1 = Date.parse('jan 1 2011')
d2 = Date.parse('dec 31 2012')

(d1..d2).map{ |m| m.strftime('%Y%m') }.uniq.map{ |m| Date::ABBR_MONTHNAMES[ Date.strptime(m, '%Y%m').mon ] }
=> ["Jan",
"Feb",
"Mar",
"Apr",
"May",
"Jun",
"Jul",
"Aug",
"Sep",
"Oct",
"Nov",
"Dec",
"Jan",
"Feb",
"Mar",
"Apr",
"May",
"Jun",
"Jul",
"Aug",
"Sep",
"Oct",
"Nov",
"Dec"] 
```

或者：

```
(d1..d2).map{ |m| m.strftime('%Y%m') }.uniq.map{ |m| Date::ABBR_MONTHNAMES[ m[/\d\d$/ ].to_i ] } 
```

这可能会快一点。

问题是年份边界。您必须跟踪年份和月份，而不仅仅是月份，否则在`uniq`用于删除日期时，您将删除所有重复的月份索引。我选择了`YYYYMM`格式，以获得正确的粒度。

* * *

```
require 'benchmark'
require 'date'

d1 = Date.parse('jan 1 2011')
d2 = Date.parse('dec 31 2012')

n = 100
Benchmark.bm(8) do |x|
  x.report('strptime') { n.times { (d1..d2).map{ |m| m.strftime('%Y%m') }.uniq.map{ |m| Date::ABBR_MONTHNAMES[ Date.strptime(m, '%Y%m').mon ] } } }
  x.report('regex')    { n.times { (d1..d2).map{ |m| m.strftime('%Y%m') }.uniq.map{ |m| Date::ABBR_MONTHNAMES[ m[/\\d\\d$/ ].to_i           ] } } }
end

              user     system      total        real
strptime  3.060000   0.020000   3.080000 (  3.076614)
regex     2.820000   0.010000   2.830000 (  2.829366) 
```

* * *

编辑：

让我们让它变得更有趣。

我有一些代码气味一直困扰着我。我不喜欢使用`Date.strftime`and `Date.strptime`，所以我再次运行了这个问题：这里有两个运行得更快的解决方案，以及基准测试：

```
require 'benchmark'
require 'date'

def regex_months_between(d1, d2)
  d1, d2 = [d1, d2].map{ |d| Date.parse(d) }.minmax

  (d1..d2).map{ |m| m.strftime('%Y%m') }.uniq.map{ |m| Date::ABBR_MONTHNAMES[ m[/\d\d$/ ].to_i ] }
end

def months_between1(d1, d2)
  d1, d2 = [d1, d2].map{ |d| Date.parse(d) }.minmax

  months = (d2.mon - d1.mon) + (d2.year - d1.year) * 12
  month_names = []
  months.times{ |m|
    month_names << Date::ABBR_MONTHNAMES[(d1 >> m).mon]
  }
  month_names << Date::ABBR_MONTHNAMES[d2.mon]
  month_names
end

def months_between2(d1, d2)
  d1, d2 = [d1, d2].map{ |d| Date.parse(d) }.minmax

  months = (d2.mon - d1.mon) + (d2.year - d1.year) * 12
  (d1.mon ... (d1.mon + months)).each_with_object(Date::ABBR_MONTHNAMES[d1.mon, 1]) { |month_offset, month_names_array|
    month_names_array << Date::ABBR_MONTHNAMES[(d1 >> month_offset).mon]
  }
end

puts regex_months_between('jan 1 2011', 'dec 31 2012').join(', ')
puts months_between1('jan 1 2011', 'dec 31 2012').join(', ')
puts months_between2('jan 1 2011', 'dec 31 2012').join(', ')

n = 100
Benchmark.bm(3) do |b|
  b.report('rmb') { n.times { regex_months_between('jan 1 2011', 'dec 31 2012') } }
  b.report('mb1') { n.times { months_between1('jan 1 2011', 'dec 31 2012') } }
  b.report('mb2') { n.times { months_between2('jan 1 2011', 'dec 31 2012') } }
end 
```

输出看起来像：

```
Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec, Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec
Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec, Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec
Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec, Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec
        user     system      total        real
rmb  2.810000   0.010000   2.820000 (  2.820732)
mb1  0.060000   0.000000   0.060000 (  0.057763)
mb2  0.060000   0.000000   0.060000 (  0.057112) 
```

有趣的。” `rmb`“现在已经远远落后了。将其从测试中拉出来并将循环提高 100 倍：

```
n = 10_000
Benchmark.bm(3) do |b|
  b.report('mb1') { n.times { months_between1('jan 1 2011', 'dec 31 2012') } }
  b.report('mb2') { n.times { months_between2('jan 1 2011', 'dec 31 2012') } }
end 
```

这使：

```
 user     system      total        real
mb1  5.570000   0.060000   5.630000 (  5.615789)
mb2  5.570000   0.040000   5.610000 (  5.611323) 
```

这基本上是两种获取月份的新方法之间的联系。作为肛门，我会去，`mb2`因为如果我这样做数百万次会快一点，但你的里程可能会有所不同。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-19T21:05:40.797

因此，假设您有两个日期，`d1`并且`d2`：

```
> d1 = 2.years.ago
 => Sun, 19 Sep 2010 15:51:18 CDT -05:00 
> d2 = 1.month.ago
 => Sun, 19 Aug 2012 15:51:25 CDT -05:00 
```

（在这种情况下，它们是 ActiveSupport::TimeWithZone 对象，但这与 DateTime 或 what-have-you 一样有效）

制作一个数组来包含您的输出：

```
 m = [] 
```

然后在增加月份的同时用月份缩写（使用`.strftime`）填充它：

```
 while d1 <= d2.at_end_of_month
   m << d1.strftime('%b')
   d1 = d1 + 1.month
 end 
```

它就是：

```
 > m
 => ["Sep", "Oct", "Nov", "Dec", "Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec", "Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug"] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-19T20:27:55.280

我建议使用数组。

这样的事情应该这样做：

```
months = ['jan', 'feb', 'mar', etc...] 
```

然后，您可以简单地从下个月迭代到上个月来创建您的列表。或者像这样使用对象的索引：

```
months[months.index('jan')..months.index('mar')] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-21T04:28:11.833

这是我为解决此问题而写的一种方法。这是为处理哈希数据而设计的，例如：{Sun, 01 Jan 2012=>58, Wed, 01 Feb 2012=>0, Thu, 01 Mar 2012=>0} 但可以很容易地修改为数组数据。

见：[https ://github.com/StephenOTT/add_missing_dates_ruby](https://github.com/StephenOTT/add_missing_dates_ruby)

但关键的代码是：

```
def addMissingMonths (datesHash)
    count = 0
    result = {}

    datesHash.keys.each do |x|
        if x != datesHash.keys.last
            (x+1.month).upto(datesHash.keys[count+1]-1.month) do |a|
                result[a.at_beginning_of_month] = 0
            end
        end

        count += 1
    end

    return result.merge!(datesHash)
end 
```

要看的关键内容是：`(x+1.month).upto(datesHash.keys[count+1]-1.month)`

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-09-19T21:11:32.990

```
(start_date..end_date).map{|m| m.beginning_of_month}.uniq.map{|m| Date::ABBR_MONTHNAMES[m.month]} 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-09-19T22:18:21.887

[使用 Natural Language Date Parser = the Chronic Gem](https://github.com/mojombo/chronic)将日期转换为 Ruby 日期。然后区分这两个日期。

# c# - 产品过滤器，复选框循环 - 加快流程

> ID：12502317
> 
> 赞同：0
> 
> 时间：2012-09-19T20:24:20.473
> 
> 标签：c#, asp.net, filter, webforms

我正在使用 ASP.NET 网络表单。我正在创建根据产品属性过滤产品的功能。

我现在这样做的方式花费了太长时间。我需要一个更好、更快的方法。

我目前的方法如下。我有一个 GridView，它显示属性名称。CheckBoxList 嵌套在包含属性值的 ItemTemplate 中。CheckBoxList 具有 autopostback="true"。在每个 selectedindexchanged 事件上，我循环检查复选框并根据选中状态进行过滤。然后我比较过滤结果和复选框值并禁用不在过滤结果中的复选框。

这是执行此操作的代码：

```
protected void cblAttr_SelectedIndexChanged(object sender, EventArgs e)
{
    var filteredResults = ProductAttribute.Get(Convert.ToInt32(Request.QueryString["idsite"]));
    var selectedAttributes = filteredResults;

    foreach (GridViewRow row in gridAttrSet.Rows)
    {
        foreach (ListItem item in ((CheckBoxList)row.FindControl("cblAttr")).Items)
        {
            if (item.Selected == true)
            {
                // filter
                selectedAttributes = selectedAttributes.Where(a => a.idAttr == Convert.ToInt32(item.Value)).ToList();
            }
        }
    }

    // this will now contain 
    filteredResults = (from c in filteredResults
                       join o in selectedAttributes
           on c.idProduct equals o.idProduct
                select new ProductAttribute
                {
                    idProduct = c.idProduct,
                    idAttrSet = c.idAttrSet,
                    idAttr = c.idAttr,
                }).ToList();

    foreach (GridViewRow row in gridAttrSet.Rows)
    {
        if (row.RowIndex > ((GridViewRow)((CheckBoxList)sender).NamingContainer).RowIndex)
        {
            foreach (ListItem item in ((CheckBoxList)row.FindControl("cblAttr")).Items)
            {
                // disable if filtered out
                item.Enabled = !(filteredResults.Where(a => a.idAttr == Convert.ToInt32(item.Value)).ToList().Count == 0);
            }
        }
    } 
} 
```

如您所见，有很多循环正在进行，并且可以有数千条记录。

什么是更快的方法来做到这一点？任何想法，将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T19:01:00.613

The part that was taking time here was the call to the database.

# cassandra - 构建 Cassandra 集群？

> ID：12502320
> 
> 赞同：2
> 
> 时间：2012-09-19T20:24:39.630
> 
> 标签：cassandra, nosql, cluster-computing

**背景：**

我们正在创建一个跨越 3 个地理上分离的数据中心的 Cassandra 集群。我们计划在每个数据中心有 2 个 Cassandra 节点（2 个节点 x 3 个站点 = 总共 6 个节点）。所有 6 个节点都将属于同一个集群。

这个想法是能够将数据写入集群中的任何节点，并能够从任何其他节点读取数据。[我们可以容忍 1 秒的更新延迟]。

**问题：**

我们如何设计一个客户端来写入“集群”。Cassandra 没有路由器或像 MongoDB 这样的中间层。**我们是否设计为写入环中的任何节点？如果是这样，那个节点是什么故障（即我们是否需要让我们的客户端知道集群中的所有节点 IP？）**

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-21T03:15:26.030

您可以从集群中的任何节点读取或写入，它们都能够将请求路由到正确的节点（执行路由的节点通常称为操作的“协调器”）。您应该尝试在本地数据中心的所有节点上平衡您的请求，仅在所有本地节点都关闭时才使用远程数据中心中的节点。大多数 Cassandra 客户端将以循环方式将请求传播到您指向它们的所有节点，正如 Canausa 所提到的，一些自动发现其他节点，有时使用更复杂的算法来选择将请求发送到哪个节点。

对任何数据中心的写入会自动复制到所有其他数据中心，因此您确实可以写入任何节点并从任何节点读取。通常，您将希望使用一致性级别 LOCAL_QUORUM 进行读取和写入，这需要本地数据中心中的法定数量的副本响应操作才能被视为成功。您还可以考虑在 EACH_QUORUM 写入，它等待来自每个数据中心中的法定副本的响应。显然，在这种情况下延迟会更高，但您可以在所有数据中心之间实现强一致性。

但是，每个数据中心只有 2 个节点，副本的法定人数相当于*所有*副本，因此如果任何节点出现故障，您将失去该部分数据的可用性。出于这个原因，如果您想使用仲裁一致性级别，建议您在每个数据中心中至少有 3 的复制因子，以允许丢失一个副本，同时仍保持强（或本地强）一致性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-19T20:30:14.983

大多数 Cassandra 客户端将尝试连接到 1 个节点，如果失败，将尝试列表中的下一个节点。有些人甚至会建立连接并找出集群的布局并选择正确的节点进行连接。像 Hector 这样的客户端将保持对特定节点的连接开放，以防您需要请求更多信息，这将避免昂贵的设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-21T09:13:31.470

任何 Cassandra 客户端都可以向集群中的任何节点发送请求，该节点将路由和整合来自自身和其他节点的结果。

在您的场景中，您可能会考虑复制因子为 3，每个数据中心一个，每个节点对一半数据进行分区，并使用 QUORUM 进行读取和写入。配置您的副本放置策略，以便每次写入更新每个数据中心的一个节点（例如 A1、A2、A3、B1、B2、B3）。这样，每个数据中心都可以支配所有数据，并且读取或写入请求将在收到来自第一个响应数据中心的响应以及它自己的响应时立即返回控制权。

您不需要让您的客户端知道所有节点，但它应该知道至少两个以防止单点故障。我会从每个数据中心至少选择一个。

# themes - 如何在 WebSphere Portal 7 上将“标准门户”页面转换为“静态内容”页面？

> ID：12502323
> 
> 赞同：0
> 
> 时间：2012-09-19T20:25:00.940
> 
> 标签：themes, websphere-7, websphere-portal

我正在将基于 WebSphere Portal 6.1 构建的门户迁移到 7。现在我想利用 Portal 7 中新的无表主题架构；它利用**静态内容**页面而不是传统的**标准门户**页面。

到目前为止，我已经创建了新主题并创建了一些自定义布局模板，所以剩下的就是开始将旧的传统标准页面转换为静态内容页面。

在尝试执行此任务时，我创建了一个标准页面和静态页面，从静态页面导出 XML，将静态页面的内容节点 id 替换为标准页面的 id，然后重新导入 XML。现在由于这个，我得到以下异常：

```
com.ibm.wps.command.xml.XmlCommandException: EJPXA0150E: The resource was found, but in the wrong context. In the XML input, it is contained in page [ObjectIDImpl 'Z6_ADFR4GL108G230IJR66JLR00O2', CONTENT_NODE, VP: 6112, [Domain: rel], DB: E017-AABD4D600D004131809CDB9859370058], but in the portal it is contained in page [ObjectIDImpl 'Z6_ADFR4GL10O8ID0IJRSTU121GF2', CONTENT_NODE, VP: 6112, [Domain: rel], DB: E017-AABD4D600D0023D9809C9B771F44804F]. [component Z7_ADFR4GL10O8ID0IJRSTU121GF6]
at com.ibm.wps.command.xml.items.ComponentItem.locate(ComponentItem.java:495)
at com.ibm.wps.command.xml.UpdateEngine.tryLocateItem(UpdateEngine.java:383)
at com.ibm.wps.command.xml.UpdateEngine.locateItem(UpdateEngine.java:415)
at com.ibm.wps.command.xml.UpdateEngine.processItem(UpdateEngine.java:230)
at com.ibm.wps.command.xml.UpdateEngine.processItem(UpdateEngine.java:238)
at com.ibm.wps.command.xml.UpdateEngine.updateTopLevelItem(UpdateEngine.java:188)
at com.ibm.wps.command.xml.XmlAccessHandler.fillObjectModel(XmlAccessHandler.java:345)
at com.ibm.wps.command.xml.XmlAccessHandler.endElement(XmlAccessHandler.java:227)
at org.apache.xerces.parsers.AbstractSAXParser.endElement(Unknown Source) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T22:12:19.713

您应该查看使用 web dav 修改的布局模板。除此之外，请确保您的主题基于门户 7002 主题，否则当您迁移到 v8 时，您还有一大堆工作要做

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T13:45:30.203

通过我的研究，我发现这似乎是不可能的，因为 Portal 处理不同类型页面的方式。*标准动态门户*页面的处理方式不同。这些是在门户的数据库中配置的，但*静态门户页面*不是，因此会出现有关错误上下文的错误。

# azure - 可以将 ClickOnce 直接发布到 Azure Blob 存储吗？

> ID：12502327
> 
> 赞同：7
> 
> 时间：2012-09-19T20:25:22.077
> 
> 标签：azure, clickonce, azure-storage, azure-blob-storage

是否可以让 ClickOnce 发布将其推送到 Azure blob 存储容器？

如果没有，这是为未来计划的事情吗？

* * *

我已阅读有关如何发布 ClickOnce 部署然后将文件复制到 Azure Blob 存储的文章（例如：[如何将 ClickOnce 部署到 Azure](http://kazinadudvari.wordpress.com/2009/06/01/how-to-deploy-clickonce-applications-to-windows-azure/)。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-20T19:45:40.407

Clickonce 过程是以一种从 Internet 或本地位置部署的方式打包您的应用程序。ClickOnce 进程不维护存储包后的最终单击位置。我不知道是否有关于它的未来计划，但是我认为不需要单击一次来使 Azure blob 存储依赖。它可以通过自定义构建过程来打包 clickonce 内容并通过提供适当的凭据上传到 Azure Blob 存储来完成。

由于您可以使用[MSBUILD 生成 Clickonce](http://msdn.microsoft.com/en-us/library/ms165431%28v=VS.80%29.aspx)包，因此您可以进一步自定义此过程，通过编写一个非常小的命令行应用程序并在 MSBUILD 完成创建 clickonce 包后自动将这些 clickonce 文件上传到 Azure Blob 存储。在这个[论坛讨论](http://social.msdn.microsoft.com/Forums/en/windowsazuresecurity/thread/0aad6995-1eed-4f7d-8538-2ccfecc1f909)中，用户有一些代码片段来构建 cmd 行应用程序来上传包。你肯定可以想出类似的东西来满足你的要求。

# java - 接口类型变量上的 Java 克隆

> ID：12502332
> 
> 赞同：0
> 
> 时间：2012-09-19T20:25:40.567
> 
> 标签：java, interface, clone

我有点像 Java N00B，但我对克隆很困惑。

考虑以下不正确的类

```
class blah {
   public blah(Collection<Integer> c){
       member_collection = c.clone(); //the clone here is defensive
   }
   private final Collection<Integer> member_collection;
} 
```

我想我想做的很清楚。

我理解为什么找不到 clone() 符号：clone 不是任何可能的集合中的公共方法。但是，在我想要使用的任何具体类中，我只想告诉编译器。

我确定我不是第一个想要克隆通用集合的人，但我看过的教程只解释了为什么你不能克隆集合，而不是如何解决这个问题。我已经尝试过使用 getClass() 和强制转换的 hacky 东西，但是这些通常需要我制作丑陋的 try-catch 块，而且很难确保一个初始化（指针 member_collection）是最终的！

我真正想做的是以某种方式将这些信息放入类型中。有没有很好的方法来做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T20:31:07.703

你最好像这样复制：

```
public class Blah {
    private final Collection<Integer> collection;

    public Blah(Collection<Integer> collection) {
        this.collection = new ArrayList<Integer>(collection);
    }
} 
```

或者像这样：

```
public class Blah {
    private final Collection<Integer> collection = new ArrayList<Integer>();

    public Blah(Collection<Integer> collection) {
        this.collection.addAll(collection);
    }
} 
```

这与您正在尝试的内容相同，并保证`Collection`保留给定的任何顺序。

**编辑：**如果您绝对需要它与提供给您的实现相同并且您不想重新考虑您的设计，那么您可以做一些 hacky 反射的东西并将其放入一个`static`方法中。

```
public class Blah {
    private final Collection<Integer> collection;

    public Blah(Collection<Integer> collection) {
        this.collection = clone(collection);
    }

    @SuppressWarnings("unchecked")
    private static <T> T clone(T t) {
        try {
            Method cloneMethod = t.getClass().getDeclaredMethod("clone");
            return (T) cloneMethod.invoke(t);
        } catch (Exception ex) {
            // TODO Log ex
            return null;
        }
    }
} 
```

必须将具体集合实现`clone`为公共方法，因此这应该适用于大多数集合。这将是`null`那些不这样做的人。您可能只想重新抛出您得到的任何异常。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-19T20:35:39.687

由于您是 Java 新手，我很遗憾地告诉您，`clone()`Java`Cloneable`已损坏，依赖它们不是一个好主意。但是，如果你只是想要`clone()`那该死的东西，你可以：

1.  在你的项目中包含[commons-lang](http://commons.apache.org/lang/)
2.  使用`ObjectUtils.clone()`/ `ObjectUtils.cloneIfPossible()`（不是强类型但相当安全）。

无论如何，使用 commons-lang 并不是一个坏主意，因为它包含许多实用程序“应该在 JRE 中”类和方法，而且它是非常标准的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-19T20:27:18.833

你可以只写`member_collection = new ArrayList<Integer>(c)`。

这将创建一个浅拷贝。

# linux - 使用 Qt Creator 将带有软链接的库复制到远程 Linux 设备

> ID：12502333
> 
> 赞同：3
> 
> 时间：2012-09-19T20:25:52.683
> 
> 标签：linux, qt, embedded, qt-creator, embedded-linux

我正在试验一些开源代码，但无法将其部署到远程 linux 设备。上传库的软链接时发生错误。我有以下内容：

*   Ubuntu 10.04 在 Windows 7 机器上的 VMWare Player 中运行
*   嵌入式linux设备
*   Qt 创作者 2.4.1

我在其他 Qt 项目中使用过相同的系统，并且能够部署到远程 linux 目标。这个项目的不同之处在于它使用了一个带有软链接的库。现在我的 *.pro 文件中有以下内容：

```
# remote deployment of libraries
install_lib.path = /home/name
install_lib.files = ../../lib/*
install_lib.extra = cp ../../lib/* /home/name

# install
target.path = /home/name
sources.path = /home/name
INSTALLS += target sources install_lib 
```

我收到的错误如下：

```
ln: invalid option -- 'v'
BusyBox v1.19.4 (2012-09-11 06:53:36 PDT) multi-call binary.

Usage: ln [OPTIONS] TARGET... LINK|DIR

Create a link LINK or DIR/TARGET to the specified TARGET(s)

    -s  Make symlinks instead of hardlinks
    -f  Remove existing destinations
    -n  Don't dereference symlinks - treat like normal file
    -b  Make a backup of the target (if exists) before link operation
    -S suf  Use suffix instead of ~ when making backup files

12:39:46: Failed to upload file '/home/name/Qt/proj/lib/libq.so'.
12:39:46: Deploy step failed. 
```

在我未经训练的眼睛看来，Qt 似乎试图在我的设备上使用 BusyBox 不支持的命令。有没有更好的方法将文件从我的开发环境移动到设备？我可能不需要更改库中的任何内容，但如果我这样做了，我希望自动上传。

顺便说一句，我也尝试使用 QMAKE_PRE_LINK 和 QMAKE_POST_LINK 没有成功。与尝试在 Qt Creator 中添加部署步骤相同的故事。如果有另一种方法可以将我的项目与库链接，我也愿意尝试。

**更新**

以下是 Makefile 的部分内容，用于显示 qmake 基于我的 *.pro 文件生成的内容。

```
INSTALL_PROGRAM = install -m 755 -p

install_install_lib: first FORCE
    @$(CHK_DIR_EXISTS) $(INSTALL_ROOT)/home/name/ || $(MKDIR) $(INSTALL_ROOT)/home/name/ 
    cp ../../lib/* /home/name
    -$(INSTALL_PROGRAM) (edit)/lib/libqhttpserver.so $(INSTALL_ROOT)/home/name/
    -$(INSTALL_PROGRAM) (edit)/lib/libqhttpserver.so.0 $(INSTALL_ROOT)/home/name/
    -$(INSTALL_PROGRAM) (edit)/lib/libqhttpserver.so.0.1 $(INSTALL_ROOT)/home/name/
    -$(INSTALL_PROGRAM) (edit)/lib/libqhttpserver.so.0.1.0 $(INSTALL_ROOT)/home/name/ 
```

老实说， install_lib.extra 字段似乎没有多大作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T18:25:11.557

Creator 在不使用 Makefile 的情况下自行部署文件，因此编辑这些文件将无济于事。

有很多工作要做。从 2.4 版开始，让 Creator 在远程 linux 上工作得更好，所以你应该尝试获取更新的版本。

# c++ - 调用 wxThread::OnExit() 时出现分段错误

> ID：12502334
> 
> 赞同：0
> 
> 时间：2012-09-19T20:25:54.420
> 
> 标签：c++, segmentation-fault, wxwidgets, gmp

**更新 2：**请参阅我的代码后面的部分。

我正在使用一个线程来使用 GMP 库计算 PI，但不知何故我现在在`wxThread::OnExit()`内部调用 wxWidgets 时遇到了分段错误。

这是 wxWidgets 源代码中的一行：[src/msw/thread.cpp#553](https://github.com/wxWidgets/wxWidgets/blob/66180c31f65d96c00c6f361674688a95166010a9/src/msw/thread.cpp#L553)

这是我的线程入口函数的缩短代码：

```
while (i <= m_numIterations && !TestDestroy()) {
    mpf_div(result, perimeter, edgeCount);

    mpf_pow_ui(result, result, 2);
    mpf_ui_sub(result, 1, result);
    mpf_sqrt(result, result);
    mpf_div_ui(result, result, 2);

    mpf_sub(result, half, result);
    mpf_sqrt(result, result);
    mpf_mul_ui(result, result, 2);
    mpf_mul(result, result, edgeCount);

    mpf_set(perimeter, result);

    i++;
    mpf_mul_ui(edgeCount, edgeCount, 2);
}

// Free GMP variables we don't need anymore
mpf_clear(half);
mpf_clear(result);
mpf_clear(edgeCount);

// OUTPUT_DIGITS has a constant value, e.g. 12
char outputStr[OUTPUT_DIGITS];

mp_exp_t *expptr;

// If commented out, the error does not appear!
mpf_get_str(outputStr, expptr, 10, OUTPUT_DIGITS, perimeter); 
```

**更新 2：**如果我用 注释掉最后一行`mpf_get_str()`，则不会发生错误。
我还发现了 2003 年的一个非常古老的错误请求：http: [//gmplib.org/list-archives/gmp-discuss/2003-November/000888.html](http://gmplib.org/list-archives/gmp-discuss/2003-November/000888.html)

来自 GCC 调试器的调用堆栈：

```
#0 63AE80E9 wxThreadInternal::DoThreadOnExit(thread=0x2cfa978) (../../src/msw/thread.cpp:553)
#1 63B27ACF wxScopeGuardImpl1<void (*)(wxThread*) (../../include/wx/scopeguard.h:168)
#2 63B3F95B wxPrivate::OnScopeExit<wxScopeGuardImpl1<void (*)(wxThread*) (../../include/wx/scopeguard.h:67)
#3 63B27B36 wxScopeGuardImpl1<void (*)(wxThread*) (../../include/wx/scopeguard.h:166)
#4 63AE82FB wxThreadInternal::DoThreadStart(thread=0x2cfa978) (../../src/msw/thread.cpp:561)
#5 63AE83F2 wxThreadInternal::WinThreadStart(param=0x2cfa978) (../../src/msw/thread.cpp:602)
#6 75C4906A ui64tow() (C:\Windows\SysWOW64\msvcrt.dll:??)
#7 75C49147 msvcrt!iswalnum() (C:\Windows\SysWOW64\msvcrt.dll:??)
#8 76448543 UnregisterBadMemoryNotification() (C:\Windows\SysWOW64\kernel32.dll:??)
#9 00000000 0x02cfb178 in ??() (??:??)
#10 00000000    0x77e8ac69 in ??() (??:??)
#11 00000000    0x77e8ac3c in ??() (??:??)
#12 00000000    0x00000000 in ??() (??:??) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T20:33:48.413

new 不会“失败”，就其本身而言，你在某处遇到了堆损坏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-20T09:34:50.423

如果它真的在这一行崩溃（gdb 只是丢失并且不显示后续帧的可能性也不可忽略），那么`thread`指针本身必须为 NULL 或无效，这在正常执行中不会发生，所以我确实同意另一个答复：某些东西似乎破坏了您的变量。但是一定要检查你是否`OnExit()`被输入，以防 gdb 撒谎。

并且当您使用跨平台库时，您应该能够在 Linux 下重新构建并在 valgrind 下运行它，这应该可以指出所有明显的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-24T15:57:41.717

指数指针（这里`expptr`）必须已经初始化为一个对象。

这个单线解决了这个问题：

```
expptr = new mp_exp_t();

// call mpf_get_str() 
```

我还想指出VZ。GDB（GNU 调试器）*可以*显示错误应该出现的错误源代码行是正确的。

所以不要*只*依赖它。

# javascript - 从 jQuery ajax 成功函数返回一个数组

> ID：12502336
> 
> 赞同：2
> 
> 时间：2012-09-19T20:26:03.967
> 
> 标签：javascript, jquery, ajax

我正在读取一个带有 jquery ajax 函数的 rss 文件，我成功创建了数组函数`mycarousel_itemList`并使用 push 用项目填充它。我想在我当时创建的函数中使用这个数组，但我得到了错误：

> `mycarousel_itemList`没有定义

怎么了？

```
<script type="text/javascript">
var rss = 'http://search.issuu.com/userxxx/docs/recent.rss';
$.ajax({
type: 'GET',
url: 'js/issuuGallery/proxy.php?url='+rss,
dataType: 'xml',
success: function(xml) {
    var ul = document.createElement("ul");
    ul.setAttribute('id', 'issuu-gallery');
    ul.setAttribute('class', 'overview');

    $(xml).find('item').each(function(){
        var mycarousel_itemList = [];
        var id = $(this).find('[name="documentId"]').attr('value');
        var src = 'http://image.issuu.com/'+id+'/jpg/page_1_thumb_small.jpg';
        mycarousel_itemList.push(src);
        console.log(mycarousel_itemList);
    });
}
});
function mycarousel_itemLoadCallback(carousel, state)
{

for (var i = carousel.first; i <= carousel.last; i++) {
    if (carousel.has(i)) {
        continue;
    }

    if (i > mycarousel_itemList.length) {
        break;
    }

    carousel.add(i, mycarousel_getItemHTML(mycarousel_itemList[i-1]));
}
   };

/**
 * Item html creation helper.
 */
function mycarousel_getItemHTML(item)
{
return '<img src="' + item.url + '" width="75" height="75" alt="' + item.url + '" />';
};

jQuery(document).ready(function() {
jQuery('#mycarousel').jcarousel({
    size: mycarousel_itemList.length,
    itemLoadCallback: {onBeforeAnimation: mycarousel_itemLoadCallback}
});
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T05:37:11.983

我假设您只是加载一次 rss 提要，然后创建一个带有结果的轮播。如果是这样，这很容易解决。

1.  寻找这一行：

    ```
    var mycarousel_itemList = []; 
    ```

    那是在 ajax 成功回调中创建一个局部变量。您要做的是使其成为全局并将其移至顶部（使其成为 < script> 标记内的第一行）。

2.  将 $.ajax 调用移至文档就绪回调内部。

3.  找到以下 jcarousel 代码：

    ```
    jQuery('#mycarousel').jcarousel({
        size: mycarousel_itemList.length,
        itemLoadCallback: {onBeforeAnimation: mycarousel_itemLoadCallback}
    }); 
    ```

    将它作为回调中的最后一件事移动到 $.ajax 回调中。

您的最终代码应如下所示：http: [//jsfiddle.net/h35VQ/](http://jsfiddle.net/h35VQ/)

# java - 以编程方式设置 JLabel 文本

> ID：12502338
> 
> 赞同：0
> 
> 时间：2012-09-19T20:26:19.817
> 
> 标签：java, swing, jframe, jpanel

所以我试图让 JLabel 在这段代码中工作。我可以让按钮和动作监听器工作，但不能让标签工作。MyDice 是我创建面板和按钮的地方。

```
public class MyDice
{
    public static void main(String[] args)
    {
        JFrame frame = new JFrame("MyDice v1.0");
        frame.setSize(800,600);
        frame.setLocation(560, 240);
        frame.setResizable(false);
        frame.setVisible(true);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        JPanel panel = new JPanel();
        panel.setBackground(new Color(200,200,200));
        panel.setSize(800,600);
        frame.add(panel);
        panel.setVisible(true);

        JButton button_d4    = new JButton("Roll d4");
        panel.add(button_d4);
        button_d4.addActionListener   (new MyRoll(4,panel));
    }
} 
```

MyRoll 是我在单击按钮时获得动作监听器的地方。

```
public class MyRoll implements ActionListener
{
    int dice;
    JPanel panel;

    public MyRoll (int dice, JPanel panel)
    {
        this.dice = dice;
        this.panel = panel;
    }

    public void actionPerformed(ActionEvent e)
    {
        rollDice(dice,1);
    }

    public void rollDice (int dice, int times)
    {
        int r=0;
        for (int i=0; i<times;i++)
        {
            double rand = Math.random();
            rand = rand*dice + 1;
            r = (int) rand;
        }

            System.out.println("You rolled "+r+" out of "+dice);

        JLabel output = new JLabel();
        output.setText("You rolled "+r+" out of "+dice);
        panel.add(output);

    }
} 
```

但是，这最后一部分不起作用。任何想法为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T20:27:10.267

Use a JLabel and set the Label Message in your logic

**REVISION for the updated CODE POSTED**

You should set up the Label outside of the Logic, added to the Panel with initial empty value and then on your logic you change the Label's Value

i.e

```
//Setting up your GUI
JLabel label = new JLabel("");
panel.add(label);

//Within your Logic method
System.out.println("Printing info");
label.setLabel("Printing info"); 
```

That way you are not constantly adding a JLabel to your Panel

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-19T20:29:00.140

Look at the following code:

```
 JLabel output = new JLabel(); 
    output.setText("You rolled "+r+" out of "+dice); 
    panel.add(output); 
```

Here you are adding a new `JLabel` to the panel (which happens to be in your main frame) every time you click the button. However, you there is nothing to tell it to repaint itself.

My suggestion to fix this is to create the `JLabel` and add it to the `JPanel` in `main()` and pass the JLabel reference to your `MyRoll` class. Then you can simply call `setText()` any time you wish. You really don't need a reference to the `JPanel` in `MyRoll`; you just need a reference to the `JLabel`.

**p.s.** I want to make a few comments on your `main()` method. In particular, if you organize your code differently, you can simplify it a little bit. Typically creating a Swing GUI follows these steps:

1.  Create a `JFrame`.

2.  Create a `JPanel`.

3.  Add components to the `JPanel`.

4.  Add the `JPanel` to the `JFrame`.

5.  Set the `JFrame` visible.

Notice that you only need to call `setVisible()` on the `JFrame`, if you do it very last. This will automatically call `setVisible()` on the `JPanel` and all its subcomponents.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-19T20:33:45.860

如果您正在寻找一种刷新方法，我不知道对于 . 相反，您可以设置一个线程，根据您提供的逻辑更新输出。

# ios - 内容可编辑的 UIWebView 变得懒惰，直到没有响应

> ID：12502339
> 
> 赞同：2
> 
> 时间：2012-09-19T20:26:21.760
> 
> 标签：ios, uiwebview, usability, contenteditable

在第三代 iPad（wifi/AT&T 蜂窝）上的内容可编辑 UIWebView 中键入文本几分钟后，键盘的反应越来越慢，直到应用程序不再可用。（在 iOS 5.x 和 iOS6 下测试）。这个错误已经提交给苹果，我没有得到任何消息。这是问题所在。

在内容可编辑的 UiWebView 中，用户开始在键盘上键入。您可以键入 2 到 10 分钟，或者键入一些文本，然后在应用程序仍处于前台时暂停键入

延迟一段时间后，键盘的反应时间越来越慢，直到完全没有反应。应用程序没有崩溃（添加断点会使应用程序暂停），但是无法输入文本，除了强制退出并重新加载应用程序之外没有其他解决方案。

1.  在 iOS 6 模拟器上不会出现此问题。iPad（第 3 代）于今年早些时候在法国购买，配备 64GB Wifi 和 Cellular/AT&T

2.  这个问题也出现在 iOS 5 中。

3.  我的应用程序创建了一个 NSTimer，它每 0.8 秒触发一次以调用 scroll: 专用于垂直滚动的方法（如有必要）。减少 NSTimer 触发延迟会加速问题的产生。

禁用滚动：方法时，不会发生此问题。似乎 UIWebView 中调用的 javascript 创建了永不停止的进程，因此它占用了越来越多的 CPU 时间，从而导致应用程序最终变得无响应（参见第 5 点）。

1.  在 Instruments 应用程序中使用 Time profiling，我注意到当应用程序正常运行时，主要耗时的方法是 [WebFrame(WebInternal) stringByEvaluatingJavaScriptFrom String:forceUserGesture] 函数（每次调用滚动大约需要 6 到 8 毫秒: 方法。但是当应用程序的响应性开始下降时，三种方法往往会主导时间剖面，消耗的时间继续快速增加，时间剖面图显示 iPad 上没有按键时全时活动。这里给出了相关的数字：

[WebVisiblePosition withinTextUnitOfGranularity:inDirectionIfAtBoundary]（总运行时间的 40%，在用户不活动 10 分钟后）

[WebHTMLView(WebNSTextInputSUpport) insertText:] （总运行时间的 29%，在用户不活动 10 分钟后）

[WebVisiblePosition enclosingTextUnitOfGranularity:inDirectionIfAtBoundary]（总运行时间的 16%，在用户不活动 10 分钟后）

有没有人必须处理这样的问题。能否针对该问题设计周转方案？

# c# - 在 C# 中为 ManagementObject 查询传递参数时遇到问题

> ID：12502342
> 
> 赞同：0
> 
> 时间：2012-09-19T20:26:46.917
> 
> 标签：c#, wmi

这是我的查询代码：

```
public String getDriveID()
{
    String wow = @"win32_logicaldisk.deviceid=\" + @driveID;

    ManagementObject disk = new ManagementObject(wow);
    disk.Get();
    Console.WriteLine(disk["Name"]);
    return disk["Name"].ToString();
} 
```

这就是创建该`driveID`方法使用的 String 的原因：

```
DriveInfo dInfo = therehasgottobeanotherway[driveList.SelectedIndex];

if (dInfo.IsReady) {
    diskWMI dwmi = new diskWMI(dInfo.Name);
} 
```

如果对`DriveInfo`类不熟悉，该`Name`属性返回驱动器的名称，例如`c:\`

我在网上找到了这段代码，它与我正在尝试做的事情完全相同，但是当我尝试使用它时总是会出错：

```
ManagementObject disk = new ManagementObject("win32_logicaldisk.deviceid=\"c:\"");
disk.Get();
Console.WriteLine(disk["VolumeName"]);
Console.ReadLine(); 
```

我敢打赌会发生格式错误，但我不知道要更改什么。

我正在尝试传入一个驱动器名称`deviceid=`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T21:56:37.037

```
public string GetHDDSerialNumber(string drive)
{
    //check to see if the user provided a drive letter
    //if not default it to "C"
    if (drive == "" || drive == null)
    {
        drive = "C";
    }
    //create our ManagementObject, passing it the drive letter to the
    //DevideID using WQL
    ManagementObject disk = new ManagementObject("Win32_LogicalDisk.DeviceID=\"" + drive + ":\"");
    //bind our management object
    disk.Get();
    //return the serial number
    return disk["VolumeSerialNumber"].ToString();
} 
```

或者对于您现有的示例，这对您有用

```
String drive = "c";
ManagementObject disk = new ManagementObject("Win32_LogicalDisk.DeviceID=\"" + drive + ":\"");
disk.Get();
Console.WriteLine(disk["VolumeName"]);
Console.ReadLine(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T20:41:51.310

不是一个真正的答案，但我可以确认我接受了您的代码并运行了以下代码，对我来说效果很好：

```
namespace ConsoleApplication1
{
    using System;
    using System.Management;

    class Program
    {
        static void Main(string[] args)
        {
            ManagementObject disk = new ManagementObject("win32_logicaldisk.deviceid=\"c:\"");
            disk.Get();
            Console.WriteLine(disk["VolumeName"]);
            Console.ReadLine();
        }
    }
} 
```

它在控制台窗口中显示名称失败。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-19T22:25:18.793

从 deviceId 中删除反斜杠，它应该可以工作。您提到的链接有一个反斜杠 :String drive = @"C:\"; =>**字符串驱动 = @"C:"** ;

# php - MySql 不返回任何东西

> ID：12502347
> 
> 赞同：0
> 
> 时间：2012-09-19T20:27:00.373
> 
> 标签：php, mysql, session, login, return

我只是在搞乱 PHP 和 MySql 来学习东西......直到现在一切都很好，但现在我找不到任何解决方案。该基地是一个非常简单的登录系统。现在我试图从名为“login”的数据库中读取用户名和密码，其中包含表“userTBL”和字段“用户名”和“密码”。

```
 <?php 
    session_start();

    mysql_connect ('localhost', 'root', 'root') or die('NO MYSQL CONNECTION!');
    mysql_select_db('login');  

    if ($_GET['login']) {
        $username = ($_POST['username']);
        $password = ($_POST['password']);

        $tmp = mysql_query("SELECT * FROM `user`");

        $data = mysql_fetch_array($tmp);

        if($tmp) {
            echo 'FULL<br />';
        } else {
            echo 'EMPTY<br />';
        }

        $_SESSION['username'] = $data['username'];
        $_SESSION['password'] = $data['password'];

         if ($username == $_SESSION['username'] && $password == $_SESSION['password']) {
             $_SESSION['loggedin'] = true;
             header("Location: protected.php");
             exit;
         } else echo "Wrong details!<br />";
    }
    if ($_SESSION['loggedin'] == true) {
        header("Location: protected.php"); 
    }
?> 
```

似乎数据库不会返回任何内容，但是为什么呢？！？！

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-16T07:39:46.967

您提到您的表称为“userTBL”，但您正在查询表“用户”。将您的查询更改为： $tmp = mysql_query("SELECT * FROM `userTBL`WHERE username = {$username} AND password = {$password}"); 'WHERE' 子句将确保查询只返回与输入表单的用户名和密码匹配的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T21:09:42.163

```
 <?php 
    session_start();

    mysql_connect ('localhost', 'root', 'root') or die('NO MYSQL CONNECTION!');
    mysql_select_db('login');  

    if ($_GET['login']) {
        $username = htmlspecialchars($_POST['username']);
        $password = htmlspecialchars($_POST['password']);

        $tmp = mysql_query('SELECT * FROM `userTBL` WHERE `user` = "'.$username.'"');

        while ($data = mysql_fetch_array($tmp))
        {
            $_SESSION['username'] = $username;
            $_SESSION['password'] = $data['password'];

         if ($password == $_SESSION['password']) {
             $_SESSION['loggedin'] = true;
             header("Location: protected.php");
             exit;
         } else echo "Wrong details!<br />";
         }
    }
    if ($_SESSION['loggedin'] == true) {
        header("Location: protected.php"); 
    }
?> 
```

另外：使用 salt+hash 将密码存储在数据库中。

# hadoop - Hadoop Compiled with Different Version than the cluster

> ID：12502350
> 
> 赞同：0
> 
> 时间：2012-09-19T20:27:12.143
> 
> 标签：hadoop

If I develop my map-reduce logic with a older hadoop lib version like 0.20.0 and then crated a jar file and run the jar file on a cluster on which the cluster version is higher like 1.0.3 then what will happen? Does the cluster uses the same version of hadoop that compiled my code with or does it ignore what I have compiled it with? Would you please explain how this process work on hadoop in general?

I know that it will run but I see some logs which looks to be the older version of hadoop.common was used. The jar file does not include the lib also.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T16:28:14.367

首先，您需要从胖 jar 中排除 hadoop-core 库，hadoop 提供了这一点。

我认为会发生什么，如果您使用了任何 API 已从版本更改为版本的库，您将收到一个异常指示。

理论上，如果 API 没有改变，它应该可以工作，尽管不能保证。最好在同一个版本上编译和运行。

# iphone - Adapting iOS apps to iPhone-5's 4 inch screen

> ID：12502355
> 
> 赞同：2
> 
> 时间：2012-09-19T20:27:26.653
> 
> 标签：iphone, ios6

> **Possible Duplicate:**
> [How to develop or migrate apps for iPhone 5 screen resolution?](https://stackoverflow.com/questions/12395200/how-to-develop-or-migrate-apps-for-iphone-5-screen-resolution)

What do we need to do to migrate pre-iPhone 5 apps to the iPhone 5's 4 inch screen?

# c# - 使用用作受保护字段的内部类型

> ID：12502358
> 
> 赞同：7
> 
> 时间：2012-09-19T20:27:47.020
> 
> 标签：c#, .net

我有一个类库，其中包含 2 个从抽象类继承的公共类。在抽象类上，我有一个受保护的字段，只能被继承的类访问。用于该字段的类型是内部类的类型。

例如我有：

```
internal class MyInternalClass
{
    ...
}

public abstract class MyAbstractClass
{
    protected MyInternalClass myField;
} 
```

现在我明白这是行不通的，因为如果从 MyAbstract 类派生的类之一在程序集之外扩展，则访问 myField 将是非法的。

我的问题是如何在保持 MyInternalClass 内部（不应在程序集外部访问它）并允许程序集中的类扩展 MyAbstractClass 并访问 myField 的同时使事情正常工作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-19T20:31:12.680

创建一个`MyAbstractClass`需要和`MyInternalClass`实现的公共接口。

像这样的东西，所以你可以`MyInternalClass`默认使用它，但如果你需要注入新的行为（例如，模拟）：

```
internal class MyInternalClass : IMyInterface
{
}

public interface IMyInterface
{            
}

public abstract class MyAbstractClass
{
    protected IMyInterface myField;

    protected MyAbstractClass(IMyInterface required = null)
    {
        myField = required ?? new MyInternalClass();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T20:31:22.063

你不能。如果`MyAbstractClass`是从外部类派生的，则`MyInternalClass`需要知道。

如果你需要考虑这样的事情，设计可能需要返工。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-19T20:40:22.920

您需要一个关键字来指定*受保护的“和”内部*而不是*受保护的“或”内部*。不存在这样的关键字（从 C# 5.0 开始）。他们可以在以后的版本中添加它。

这里有很多关于这个的线程。例如[问题 5596338](https://stackoverflow.com/questions/5596338/)。

**补充：**现在我想出了这个“解决方案”：

```
public abstract class MyAbstractClass
{
    protected class AccessMyFieldHelper
    {
        internal MyInternalClass this[MyAbstractClass mac]
        {
            get { return mac.myField; }
            set { mac.myField = value; }
        }
    }
    protected static readonly AccessMyFieldHelper AccessMyField = new AccessMyFieldHelper();

    private MyInternalClass myField;
} 
```

现在`myField`是`private`，但通过`AccessMyField`. 由于它是一个索引器，因此您必须使用方括号`[]`。

你怎么看？这可以做得更漂亮吗？

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-19T20:33:50.097

使字段*myField* `internal protected`。

您还必须将*MyAbstractClass 设为*内部。如果它继承自内部类，它就不可能是公共的。如果该类必须是公共的，那么就必须有一种解决方法：例如，创建一个接口来公开继承类所需的*MyInternalClass的功能。*

# iphone - How to download large Image 50 MB from server and show at iphone application with memory Management?

> ID：12502359
> 
> 赞同：0
> 
> 时间：2012-09-19T20:27:47.813
> 
> 标签：iphone, memory-management

I have stuck a Memory Issue about my application.
In My application I am going download 50 MB image and show into my iphone application.
Please suggest an example and proper step without Manage memory.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T21:01:15.557

正如已经建议的那样，它绝对应该在服务器上完成。

如果您无法在服务器端执行此操作，那么下载小图像和大图像应该没有区别。
只需使用`NSURLConnection`（或其他异步方法）下载数据，从数据创建图像并将其设置为图像视图。

我建议显示某种动画甚至进度，因为下载它并将数据转换为图像可能需要很长时间。
也许您最好在下载后根据需要调整大小以获得更好的性能。

确保在使用对象后立即释放所有内存。
一般来说，我认为 iOS 应用程序可以处理 50 MB 的图像大小......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T20:30:55.520

将其缩放到实际呈现的大小和质量（最大）。这种缩放/转换应该自然发生在服务器端。

请注意，目前 ios 设备的最大可呈现像素数为 3145728（iPad 第 3 代 - Retina）。使用每像素 3 位且**无压缩**，对于像素最多的设备来说，这*不到 10 MB*。

当然，您应该**使用压缩**（有损或无损由您决定）以最小化下载大小/时间。文件压缩后的结果大小将根据信号的复杂性和用于压缩的算法而有所不同——预计输入的一小部分。

您还应该考虑以多种大小存储源文件，以便非视网膜 ipod 或 iphone（内存比第三代 ipad 少）不需要下载和处理比设备能够呈现的文件大几倍的文件。

# php - Postgres SELECT SETOF 函数的重复记录

> ID：12502360
> 
> 赞同：1
> 
> 时间：2012-09-19T20:27:50.607
> 
> 标签：php, postgresql, pdo

我将 SETOF 从 Postgres FUNCTION 返回到 PHP/PDO。不幸的是，我得到了每行返回的 2 个副本。

这是 Postgres 类型：

```
CREATE TYPE marker AS (i BOOLEAN, r DOUBLE PRECISION, la DOUBLE PRECISION, lo DOUBLE PRECISION, n INTEGER); 
```

和功能：

```
CREATE OR REPLACE FUNCTION rl_select_markers (latitude DOUBLE PRECISION, longitude DOUBLE PRECISION) RETURNS setof marker AS $$
DECLARE
ROW marker%ROWTYPE;
BEGIN
    FOR ROW IN SELECT is_male, rate, lat, lon, (EXTRACT(EPOCH FROM CURRENT_TIMESTAMP - created_at)/60)::INTEGER FROM markers 
    WHERE expires_at > CURRENT_TIMESTAMP 
    ORDER BY ST_Distance(ST_Point(longitude, latitude), geog, FALSE) LIMIT 25 
    LOOP
    RETURN NEXT ROW;
    END LOOP;
    RETURN;
END;
$$ LANGUAGE plpgsql; 
```

这是相关的PHP：

```
$dbh = new PDO('pgsql:host=' . $host . ';dbname=' . $db, $user, $pw);
$stmt = $dbh->prepare("SELECT rl_select_markers (:lat, :lon)");
$stmt->bindParam(':lat', $lat, PDO::PARAM_INT);
$stmt->bindParam(':lon', $lon, PDO::PARAM_INT);
$stmt->execute();

$keys = array('i', 'r', 'la', 'lo', 'n');
$markers = array();
while ($lines = $stmt->fetch()) 
{   
    $log->logInfo($log_id . " lines=" . $lines);
    $combined = array();
    foreach ($lines as $line) 
    { 
        $log->logInfo($log_id . " line=" . $line);
        // Remove brackets around $line and put in array
        $vals = explode(",", substr($line, 1, strlen($line)-2));
        // Combine into key value pairs
        $combined = array_combine($keys, $vals);
    }
    $markers[] = array("m"=>$combined);
}

$dbh = null;
$stmt = null;

$log->logInfo($log_id . " Send 200 OK");
sendResponse(200, json_encode(array("mks"=>$markers)), "application/json"); 
```

意想不到的行为是每个`$lines`都是同一行的两个副本的数组。

EG 当有一条记录要返回时`$lines`，将是一个由 2 个完全相同的字符串组成的数组。所以上面的日志会产生：

```
lines=Array
line=(f,10,51.505601,-0.109917,8)
line=(f,10,51.505601,-0.109917,8) 
```

我知道我的内部 PHP 循环是无稽之谈，但它有效。我可以看到变通方法（例如添加 a `break;`），但想删除重复项。

我希望我已经清楚地解释了这一点。你能明白为什么我得到每条记录的这些重复项吗？

**编辑**

关注@a_horse_with_no_name 的评论问题：

从 phpPgAdmin 调用 SQL 或 FUNCTION**不会**产生重复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T23:30:34.120

我认为你错误地认为`fetch()`函数会返回多行——它总是返回一行——一个列数组。

默认情况下`$fetch_style`，`PDO::FETCH_BOTH`该数组在列名和 0 索引的列号上都有索引，并且每列都有两个元素：

```
0 => (f,10,51.505601,-0.109917,8)
'rl_select_markers' => (f,10,51.505601,-0.109917,8) 
```

所以：

*   使用 fetch(PDO::FETCH_NUM)，所以你会得到一个数字索引列；
*   摆脱`foreach ($lines as $line)`
*   将变量重命名`$lines`为`$line`
*   只需使用`$line[0]`

更正的代码：

```
while ($line = $stmt->fetch(PDO::FETCH_NUM)) 
{   
    $log->logInfo($log_id . " line=" . print_r($line,TRUE));
    $combined = array();
    // Remove brackets around $line and put in array
    $vals = explode(",", substr($line[0], 1, strlen($line[0])-2));
    // Combine into key value pairs
    $combined = array_combine($keys, $vals);
    $markers[] = array("m"=>$combined);
} 
```

*PHP GOTHA 编号 64372*

更好的是：我会使用`select (rl_select_markers (:lat, :lon)).*`查询，然后只是：

```
while ( $combined = $stmt->fetch(PDO::FETCH_ASSOC) ) {
    $markers[] = array("m"=>$combined);
} 
```

# c# - 如何创建白色的 1024x1024 RGB 位图图像？

> ID：12502365
> 
> 赞同：40
> 
> 时间：2012-09-19T20:27:59.333
> 
> 标签：c#

问这个问题很尴尬，但找不到答案。

我徒劳地尝试了这个。

```
Image resultImage = new Bitmap(image1.Width, image1.Height, PixelFormat.Format24bppRgb);

using (Graphics grp = Graphics.FromImage(resultImage)) 
{
    grp.FillRectangle(
        Brushes.White, 0, 0, image1.Width, image1.Height);
    resultImage = new Bitmap(image1.Width, image1.Height, grp);
} 
```

我基本上想在 C# 中用白色填充 1024x1024 RGB 位图图像。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-09-19T20:35:48.177

你几乎拥有它：

```
private Bitmap DrawFilledRectangle(int x, int y)
{
    Bitmap bmp = new Bitmap(x, y);
    using (Graphics graph = Graphics.FromImage(bmp))
    {
        Rectangle ImageSize = new Rectangle(0,0,x,y);
        graph.FillRectangle(Brushes.White, ImageSize);
    }
    return bmp;
} 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2012-09-19T20:30:05.573

您正在为 分配一个新图像`resultImage`，从而覆盖您之前创建白色图像的尝试（顺便说一句，这应该会成功）。

所以只需删除该行

```
resultImage = new Bitmap(image1.Width, image1.Height, grp); 
```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2012-09-19T21:05:34.130

另一种方法，

创建单位位图

```
var b = new Bitmap(1, 1);
b.SetPixel(0, 0, Color.White); 
```

并对其进行缩放

```
var result = new Bitmap(b, 1024, 1024); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2019-03-12T06:27:11.647

[Graphics.Clear（颜色）](https://docs.microsoft.com/en-us/dotnet/api/system.drawing.graphics.clear?view=netframework-4.7.2)

```
Bitmap bmp = new Bitmap(1024, 1024);
using (Graphics g = Graphics.FromImage(bmp)){g.Clear(Color.White);} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-01-16T23:25:37.067

根据您的需要，*BitmapSource*可能适合。*您可以使用Enumerable.Repeat()快速用**0xff*（即白色）填充字节数组。

 *```
int w = 1024;
int h = 1024;
byte[] pix = Enumerable.Repeat((byte)0xff, w * h * 4).ToArray();
SomeImage.Source = BitmapSource.Create(w, h, 96, 96, PixelFormats.Pbgra32, null, pix, w * 4); 
```*

# android - Strange Behaviour With Title Bar Color

> ID：12502368
> 
> 赞同：4
> 
> 时间：2012-09-19T20:28:16.523
> 
> 标签：android, android-ui

I intent to change the title bar color and actually it works pretty well.

```
<style name="CustomTheme.Dark" parent="android:Theme.Black">
    [...]
    <item name="android:windowTitleBackgroundStyle">@style/TitlebarBackground.Dark</item>
</style>

<style name="TitlebarBackground.Dark">
    <item name="android:background">#303031</item>
</style> 
```

I have a `PreferenceActivity`. I apply a background drawable to the `ListView` for having a border with rounded corners. And now I want to equalize the title bar color with the border color, so in this case I want the title bar color to be `#303030`. But as soon as the title bar color has exactly the same as the border color, it becomes clean black `#000000`:

![](../Images/99868a53d632f591807a6f97cdca9e57.png)

When I set the title bar color to **almost** the same as the border color - for example `#303031` - everything works fine:

![](../Images/934397c5a6e3c26c56ff6dede51a457d.png)

Here's the background drawable which generates the border with rounded corners:

```
<shape xmlns:android="http://schemas.android.com/apk/res/android" >

    <stroke
        android:width="4dp"
        android:color="@color/border_color" />

    <solid android:color="@color/bg_color" />

    <padding
        android:bottom="4dp"
        android:left="4dp"
        android:right="4dp" />

    <corners
        android:bottomLeftRadius="4dp"
        android:bottomRightRadius="4dp" />

</shape> 
```

Does anybody have **any** explanation for this... well... strange behaviour?

**edit:** What - for some strange reason - works as well is setting the title bar background color programmatically:

```
View title = ((ListActivity) context).getWindow().findViewById(android.R.id.title);
View titleBar = (View) title.getParent();
titleBar.setBackgroundColor(context.getResources().getColor(R.color.border_color_dark)); 
```

That way I can equalize both colors as well. Still, I don't understand why specifying the title bar color in `XML` does not work. No clue. Very mysterious.

# c++ - 采用 TBB 的并行性 - 我们的检查清单中应该包含哪些内容？

> ID：12502370
> 
> 赞同：4
> 
> 时间：2012-09-19T20:28:17.800
> 
> 标签：c++, parallel-processing, tbb

直到最近，并行编程的前景才引起了我的注意。从那以后，我使用了各种并行编程库。也许我的第一站是英特尔线程构建模块 (TBB)。但是，经常成为瓶颈的是由于诸如舍入和这些程序在不同处理器架构中的不可预测行为等因素导致的错误。下面是一段计算两组值的 Pearsons 相关系数的代码。它采用了 TBB 非常基本的并行模式 - *parallel_for* 和 *parallel_reduce* ：

```
 // A programme to calculate Pearsons Correlation coefficient 

#include <math.h>
#include <stdlib.h>
#include <iostream>
#include <tbb/task_scheduler_init.h>
#include <tbb/parallel_for.h>
#include <tbb/parallel_reduce.h>
#include <tbb/blocked_range.h>
#include <tbb/tick_count.h>

using namespace std;
using namespace tbb;
const size_t n=100000;
double global=0;

namespace s //Namesapce for serial part
{
double *a,*b;
int j;
double mean_a,mean_b,sd_a=0,sd_b=0,pcc=0;
double sum_a,sum_b,i;
}

namespace p //Namespace for parallel part
{
double *a,*b;
double mean_a,mean_b,pcc;
double sum_a,sum_b,i;
double sd_a,sd_b;
}

class serials
{
public:
               void computemean_serial()
               {
                using namespace s;
            sum_a=0,sum_b=0,i=0;
                a=(double*) malloc(n*sizeof(double));
                b=(double*) malloc(n*sizeof(double));
                for(j=0;j<n;j++,i++)
                { 
                    a[j]=sin(i);
                    b[j]=cos(i);

                    sum_a=sum_a+a[j];
                    sum_b=sum_b+b[j];
                }
                mean_a=sum_a/n;
            mean_b=sum_b/n;
                cout<<"\nMean of a :"<<mean_a;
                cout<<"\nMean of b :"<<mean_b;
               }
               void computesd_serial()
               {
               using namespace s;
               for(j=0;j<n;j++)
               {sd_a=sd_a+pow((a[j]-mean_a),2);
                sd_b=sd_b+pow((b[j]-mean_b),2);
               }
                sd_a=sd_a/n;
               sd_a=sqrt(sd_a);
               sd_b=sd_b/n;
               sd_b=sqrt(sd_b);
               cout<<"\nStandard deviation of a :"<<sd_a;
               cout<<"\nStandard deviation of b :"<<sd_b;
               }
               void pearson_correlation_coefficient_serial()
               {
                using namespace s;
                pcc=0;
                for(j=0;j<n;j++)
                {
                pcc+=(a[j]-mean_a)*(b[j]-mean_b);
                }
                pcc=pcc/(n*sd_a*sd_b);
                cout<<"\nPearson Correlation Coefficient: "<<pcc;
               }

};

class parallel
{
public:

class compute_mean 
{

double *store1,*store2;
public: 

double mean_a,mean_b;

    void operator()( const blocked_range<size_t>& r)
    {
    double *a= store1;
    double *b= store2;

    for(size_t i =r.begin();i!=r.end(); ++i)
    {    
         mean_a+=a[i];
         mean_b+=b[i];
    }
    }
    compute_mean( compute_mean& x, split) : store1(x.store1),store2(x.store2),mean_a(0),mean_b(0){}

    void join(const compute_mean& y) {mean_a+=y.mean_a;mean_b+=y.mean_b;}
    compute_mean(double* a,double* b): store1(a),store2(b),mean_a(0),mean_b(0){}
};

               class read_array
                {
               double *const a,*const b;

                 public:

             read_array(double* vec1, double* vec2) : a(vec1),b(vec2){}  // constructor copies the arguments into local store 
             void operator() (const blocked_range<size_t> &r) const {              // opration to be used in parallel_for 

                     for(size_t k = r.begin(); k!=r.end(); k++,global++)
                     {   
                         a[k]=sin(global);
                         b[k]=cos(global);
                     }

                 }};

            void computemean_parallel()
                        {
                        using namespace p;
                        i=0;
                        a=(double*) malloc(n*sizeof(double));
                        b=(double*) malloc(n*sizeof(double));

                parallel_for(blocked_range<size_t>(0,n,5000),read_array(a,b));
                compute_mean sf(a,b);
                parallel_reduce(blocked_range<size_t>(0,n,5000),sf);
                mean_a=sf.mean_a/n;
                mean_b=sf.mean_b/n;
                cout<<"\nMean of a :"<<mean_a;
                cout<<"\nMean of b :"<<mean_b;
               }

class compute_sd 
{
double *store1,*store2;
double store3,store4;
public: 
double sd_a,sd_b,dif_a,dif_b,temp_pcc;
void operator()( const blocked_range<size_t>& r)
{
    double *a= store1;
    double *b= store2;
    double mean_a=store3;
    double mean_b=store4;
    for(size_t i =r.begin();i!=r.end(); ++i)
    { 
     dif_a=a[i]-mean_a;
     dif_b=b[i]-mean_b;
     temp_pcc+=dif_a*dif_b;
     sd_a+=pow(dif_a,2);
     sd_b+=pow(dif_b,2);
    }}
    compute_sd( compute_sd& x, split) : store1(x.store1),store2(x.store2),store3(p::mean_a),store4(p::mean_b),sd_a(0),sd_b(0),temp_pcc(0){}
    void join(const compute_sd& y) {sd_a+=y.sd_a;sd_b+=y.sd_b;}
    compute_sd(double* a,double* b,double mean_a,double mean_b): store1(a),store2(b),store3(mean_a),store4(mean_b),sd_a(0),sd_b(0),temp_pcc(0){}
};

               void computesd_and_pearson_correlation_coefficient_parallel()
               {
               using namespace p;
               compute_sd obj2(a,b,mean_a,mean_b);
               parallel_reduce(blocked_range<size_t>(0,n,5000),obj2);
               sd_a=obj2.sd_a;
               sd_b=obj2.sd_b;
               sd_a=sd_a/n;
               sd_a=sqrt(sd_a);
               sd_b=sd_b/n;
               sd_b=sqrt(sd_b);
               cout<<"\nStandard deviation of a :"<<sd_a;
               cout<<"\nStandard deviation of b :"<<sd_b;
               pcc=obj2.temp_pcc;
               pcc=pcc/(n*sd_a*sd_b);
               cout<<"\nPearson Correlation Coefficient: "<<pcc;
               }
};

main()
{       
        serials obj_s;
        parallel obj_p;
        cout<<"\nSerial Part";
        cout<<"\n-----------";
        tick_count start_s=tick_count::now();
        obj_s.computemean_serial();
        obj_s.computesd_serial();
        obj_s.pearson_correlation_coefficient_serial();
        tick_count end_s=tick_count::now();
        cout<<"\n";
        task_scheduler_init init;
        cout<<"\nParallel Part";
        cout<<"\n-------------";
        tick_count start_p=tick_count::now();
        obj_p.computemean_parallel();
        obj_p.computesd_and_pearson_correlation_coefficient_parallel();
        tick_count end_p=tick_count::now();
        cout<<"\n";
        cout<<"\nTime Estimates";
        cout<<"\n--------------";
        cout<<"\nSerial Time :"<<(end_s-start_s).seconds()<<" Seconds";
        cout<<"\nParallel time :"<<(end_p-start_p).seconds()<<" Seconds\n";

} 
```

好 ！它在装有 Core i5 的 Windows 机器上运行良好。它为输出中的每个参数提供了完全相同的值，并行代码流形比串行代码快。这是我的**输出**：

**操作系统**：Windows 7 Ultimate 64 位**处理器**：核心 i5

```
Serial Part
-----------
Mean of a :1.81203e-05
Mean of b :1.0324e-05
Standard deviation of a :0.707107
Standard deviation of b :0.707107
Pearson Correlation Coefficient: 3.65091e-07

Parallel Part
-------------
Mean of a :1.81203e-05
Mean of b :1.0324e-05
Standard deviation of a :0.707107
Standard deviation of b :0.707107
Pearson Correlation Coefficient: 3.65091e-07

Time Estimates
--------------
Serial Time : 0.0204829 Seconds
Parallel Time : 0.00939971 Seconds 
```

那么其他机器呢？如果我说它会正常工作，那么至少我的一些朋友会说“等等，伙计！有些东西很可疑。” 尽管并行代码总是比串行代码快，但不同机器的答案（并行代码和串行代码产生的答案之间）存在细微差别。那么是什么造成了这些差异呢？我们得出的结论是，这种异常行为是舍入错误，其代价是过度并行性和处理器架构的差异。

这导致了我的问题：

*   当我们在代码中使用并行处理库以利用多核处理器时，我们需要采取哪些预防措施？
*   即使有多个处理器可用，在哪些情况下我们不应该使用并行方法？
*   为了避免舍入错误，我们能做的最好的事情是什么？（让我说明一下，我不是在谈论强制互斥锁和障碍，它们有时可能会限制并行性的扩展，而是关于简单的编程技巧，可以有时很方便）

我很高兴看到您对这些问题的建议。如果您有时间限制，请自由回答最适合您的部分。

**编辑 - 我在这里包含了更多结果**

**操作系统**：Linux Ubuntu 64 位**处理器**：核心 i5

```
 Serial Part
    -----------
    Mean of a :1.81203e-05
    Mean of b :1.0324e-05
    Standard deviation of a :0.707107
    Standard deviation of b :0.707107
    Pearson Correlation Coefficient: 3.65091e-07

    Parallel Part
    -------------
    Mean of a :-0.000233041
    Mean of b :0.00414375
    Standard deviation of a :2.58428
    Standard deviation of b :54.6333
    Pearson Correlation Coefficient: -0.000538456

    Time Estimates
    --------------
    Serial Time :0.0161237 Seconds
    Parallel Time :0.0103125 Seconds 
```

**操作系统**：Linux Fedora 64 位**处理器**：核心 i3

```
Serial Part
-----------
Mean of a :1.81203e-05
Mean of b :1.0324e-05
Standard deviation of a :0.707107
Standard deviation of b :0.707107
Pearson Correlation Coefficient: 3.65091e-07

Parallel Part
-------------
Mean of a :-0.00197118
Mean of b :0.00124329
Standard deviation of a :0.707783
Standard deviation of b :0.703951
Pearson Correlation Coefficient: -0.129055

Time Estimates
--------------
Serial Time :0.02257 Seconds
Parallel Time :0.0107966 Seconds 
```

**编辑**：在 timday 建议的更改之后

**操作系统**：Linux Ubuntu 64 位**处理器**：corei5

```
Serial Part
-----------
Mean of a :1.81203e-05
Mean of b :1.0324e-05
Standard deviation of a :0.707107
Standard deviation of b :0.707107
Pearson Correlation Coefficient: 3.65091e-07

Parallel Part
-------------
Mean of a :-0.000304446
Mean of b :0.00172593
Standard deviation of a :0.708465
Standard deviation of b :0.7039
Pearson Correlation Coefficient: -0.140716

Time Estimates
--------------
Serial Time :0.0235391 Seconds
Parallel time :0.00810775 Seconds 
```

最好的祝福。

*注意1：我不保证上面的代码是正确的。我相信是的。*

*注意 2：这段代码也在 Linux 机器上进行了测试。*

*注 3：尝试了不同的粒度组合和自动分区选项。*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-20T12:31:56.720

我`/*,mean_a(0),mean_b(0)*/`对`compute_mean( compute_mean& x, split)`构造函数中的注释深表怀疑。似乎您的差异可能是由于未初始化的数据污染了结果。我猜在您获得一致结果的机器上，没有发生任务拆分，或者这些成员恰好在零内存上。

同样你的`compute_sd( compute_sd& x, split)`叶子`store3`和`store4`未初始化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-23T15:51:07.350

> 这导致了我的问题：
> 
> 当我们在代码中使用并行处理库以利用多核处理器时，我们需要采取哪些预防措施？

除了 timday 的回答中的要点之外，您的问题似乎并不特定于并行性。浮点数计算的稳定算法很难设计；有效使用并行性所固有的较低确定性暴露了算法不足的问题。请参阅下文了解我的意思。在决定是并行性还是算法导致数值不稳定之前，您应该测试串行代码相对于输入数据顺序的稳健性。

> 即使有多个处理器可用，在哪些情况下我们不应该使用并行方法？

当循环中没有足够的操作来支付开销时。这取决于算法、硬件和问题大小。

> 为了避免舍入错误，我们能做的最好的事情是什么？（让我说明一下，我不是在谈论强制互斥锁和障碍，它们有时可能会限制并行性的扩展，而是关于简单的编程技巧，可以有时很方便）

无论是编写串行代码还是并行代码，您都应该使用专为数值稳定性而设计的算法。你在高中教的那些都是为了易于理解而设计的！:-) 例如，请参阅[http://en.m.wikipedia.org/wiki/Algorithms_for_calculating_variance](http://en.m.wikipedia.org/wiki/Algorithms_for_calculating_variance)。

# java - REST 资源异常拦截器

> ID：12502372
> 
> 赞同：2
> 
> 时间：2012-09-19T20:28:26.073
> 
> 标签：java, rest, jakarta-ee, interceptor

我正在尝试确定是否可以在 REST 资源上设置类似解决方案的拦截器，这样如果抛出异常，我可以记录异常并更改返回的响应。我基本上不想用 try/catch 块包装我所有的 REST 资源。如果管理 REST 资源，我只会在所有调用中使用 @Interceptor，但由于它不受管理，这似乎是不可能的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T20:51:25.420

您可以使用一个实现`javax.ws.rs.ext.ExceptionMapper`。假设您的代码可能会`YourFancyException`从资源中抛出一个。然后您可以使用以下映射器：

```
@Provider
public class YourFancyExceptionMapper 
                implements ExceptionMapper <YourFancyException> {
    @Override
    public Response toResponse(YourFancyException exception) {
        return Response.status(Response.Status.BAD_REQUEST)
                        .entity(exception.getMessage()).build();
    }
} 
```

不要忘记使用注释映射器`@Provider`并使您的资源方法可以 throw `YourFancyException`。

# windows - How do I aquire an encoded kerberos ticket in windows?

> ID：12502373
> 
> 赞同：0
> 
> 时间：2012-09-19T20:28:28.897
> 
> 标签：windows, kerberos, klist

On a windows client, I have a service ticket for a web service (I can see the ticket with klist), and I am trying to write an app to get the encoded service ticket and pass it on to the service (over HTTPS) so that it can be decrypted with the service key.

By using the klist example provide in the windows SDK (at *\Microsoft SDKs\Windows\v7.0\Samples\security\authorization\klist*) I am able to get a handle to the service ticket and get a [KERB_EXTERNAL_TICKET](http://msdn.microsoft.com/en-us/library/windows/desktop/aa378073%28v=vs.85%29.aspx) structure that contains the "EncodedTicket" which claims to be "*A buffer that contains the Abstract Syntax Notation One (ASN.1)-encoded ticket.*"

Is this "EncodedTicket" the ticket that I want to pass onto my webserivce? Will it still be encrypted with the service key? How do I convert this buffer into a base64 string that I can pass on to my webservice?

# asp.net - StructureMap Initialize web forms

> ID：12502374
> 
> 赞同：2
> 
> 时间：2012-09-19T20:28:39.280
> 
> 标签：asp.net, webforms, structuremap

I have a very strange problem. In my MVC 4 application I have this code to initialize StructureMap :

```
public static class IoC {
public static IContainer Initialize() {
    ObjectFactory.Initialize(x =>
                {
                    x.Scan(scan =>
                            {
                                scan.TheCallingAssembly();
                                scan.WithDefaultConventions();
                            });
                    x.For<IRestHttpClient>().Use<AtlamHttpClient>().Ctor<string>().Is(Settings.AtlamServicesURL);
                });
    ObjectFactory.AssertConfigurationIsValid();
    return ObjectFactory.Container;
} 
```

}

that works as expected. However, I also have a .NET 4.5 Web forms application with the same basic initialization code:

```
public static class IoC
{
    public static IContainer Configure()
    {
        ObjectFactory.Initialize(x =>
            {
                x.Scan(scan =>
                {
                    scan.TheCallingAssembly();
                    scan.WithDefaultConventions();
                    scan.AssemblyContainingType<IRestHttpClient>();
                    scan.AssemblyContainingType<MessagePackMediaTypeFormatter>();
                });
                x.For<IRestHttpClient>().Use<AtlamHttpClient>().Ctor<string>().Is(Settings.BaseServiceUrl);
                /*x.SetAllProperties(y =>
                    {
                        y.OfType<IRestHttpClient>();
                    });*/
            });
        ObjectFactory.AssertConfigurationIsValid();
        return ObjectFactory.Container;
    }
} 
```

that throws an exception on AssertConfigurationIsValid() and is failing here in the AtlamHttpClient:

```
public static List<ContentNegotiator> extensionMappings = new List<ContentNegotiator>()
        {
            new ContentNegotiator("xml", "application/xml", new XmlMediaTypeFormatter()),
            new ContentNegotiator("json", "application/json", new JsonMediaTypeFormatter()),
            new ContentNegotiator("pack", "application/x-msgpack", new MessagePackMediaTypeFormatter())
        }; 
```

which in turn calls:

```
public MessagePackMediaTypeFormatter()
        {
            MediaTypeHeaderValue val = MediaTypeHeaderValue.Parse(mime);
            SupportedMediaTypes.Add(val);
        } 
```

and fails with an ArrayTypeMismatchException. Can't figure out why the first project works fine and the second one is failing. Any help would be greatly appreciated.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T19:02:50.773

终于想通了。原来问题是我有一个绑定重定向到 System.Net.Http 2.0 版。删除它，一切正常。

# c++ - videoInput 是否保证 rgb 摄像头输入？（从 videoInput/dshow -> Java BufferedImage 传输图像）

> ID：12502381
> 
> 赞同：0
> 
> 时间：2012-09-19T20:29:05.320
> 
> 标签：c++, visual-c++, directshow, color-space

我正在使用[videoInput](http://www.muonics.net/school/spring05/videoInput/)从我的网络摄像头获取实时流，但我遇到了一个问题，videoInput 的文档暗示我应该始终获取 BGR/RGB，但是，“详细”输出告诉我像素格式是 YUY2 .

```
***** VIDEOINPUT LIBRARY - 0.1995 - TFW07 *****
SETUP: Setting up device 0
SETUP: 1.3M WebCam
SETUP: Couldn't find preview pin using SmartTee
SETUP: Default Format is set to 640 by 480 
SETUP: trying format RGB24 @ 640 by 480
SETUP: trying format RGB32 @ 640 by 480
SETUP: trying format RGB555 @ 640 by 480
SETUP: trying format RGB565 @ 640 by 480
SETUP: trying format YUY2 @ 640 by 480
SETUP: Capture callback set
SETUP: Device is setup and ready to capture. 
```

我的第一个想法是尝试转换为 RGB（假设我真的得到了 YUY2 数据），我最终得到了一个高度失真的蓝色图像。

这是我将 YUY2 转换为 BGR 的代码（**注意：**这是一个更大的程序的一部分，这是借用的代码 - 我可以根据任何人的要求获取 url）：

```
#define CLAMP_MIN( in, min ) ((in) < (min))?(min):(in)
#define CLAMP_MAX( in, max ) ((in) > (max))?(max):(in)

#define FIXNUM 16
#define FIX(a, b) ((int)((a)*(1<<(b))))
#define UNFIX(a, b) ((a+(1<<(b-1)))>>(b))

#define ICCIRUV(x) (((x)<<8)/224)
#define ICCIRY(x) ((((x)-16)<<8)/219)
#define CLIP(t) CLAMP_MIN( CLAMP_MAX( (t), 255 ), 0 )
#define GET_R_FROM_YUV(y, u, v) UNFIX((FIX(1.0, FIXNUM)*(y) + FIX(1.402, FIXNUM)*(v)), FIXNUM)
#define GET_G_FROM_YUV(y, u, v) UNFIX((FIX(1.0, FIXNUM)*(y) + FIX(-0.344, FIXNUM)*(u) + FIX(-0.714, FIXNUM)*(v)), FIXNUM)
#define GET_B_FROM_YUV(y, u, v) UNFIX((FIX(1.0, FIXNUM)*(y) + FIX(1.772, FIXNUM)*(u)), FIXNUM)
bool yuy2_to_rgb24(int streamid) {
    int i;
    unsigned char y1, u, y2, v;
    int Y1, Y2, U, V;
    unsigned char r, g, b;

    int size = stream[streamid]->config.g_h * (stream[streamid]->config.g_w / 2);
    unsigned long srcIndex = 0;
    unsigned long dstIndex = 0;

    try {

        for(i = 0 ; i < size ; i++) {

            y1 = stream[streamid]->vi_buffer[srcIndex];
            u = stream[streamid]->vi_buffer[srcIndex+ 1];
            y2 = stream[streamid]->vi_buffer[srcIndex+ 2];
            v = stream[streamid]->vi_buffer[srcIndex+ 3];

            Y1 = ICCIRY(y1);
            U = ICCIRUV(u - 128);
            Y2 = ICCIRY(y2);
            V = ICCIRUV(v - 128);

            r = CLIP(GET_R_FROM_YUV(Y1, U, V));
            //r = (unsigned char)CLIP( (1.164f * (float(Y1) - 16.0f)) + (1.596f * (float(V) - 128)) );
            g = CLIP(GET_G_FROM_YUV(Y1, U, V));
            //g = (unsigned char)CLIP( (1.164f * (float(Y1) - 16.0f)) - (0.813f * (float(V) - 128.0f)) - (0.391f * (float(U) - 128.0f)) );
            b = CLIP(GET_B_FROM_YUV(Y1, U, V));
            //b = (unsigned char)CLIP( (1.164f * (float(Y1) - 16.0f)) + (2.018f * (float(U) - 128.0f)) );

            stream[streamid]->rgb_buffer[dstIndex] = b;
            stream[streamid]->rgb_buffer[dstIndex + 1] = g;
            stream[streamid]->rgb_buffer[dstIndex + 2] = r;

            dstIndex += 3;

            r = CLIP(GET_R_FROM_YUV(Y2, U, V));
            //r = (unsigned char)CLIP( (1.164f * (float(Y2) - 16.0f)) + (1.596f * (float(V) - 128)) );
            g = CLIP(GET_G_FROM_YUV(Y2, U, V));
            //g = (unsigned char)CLIP( (1.164f * (float(Y2) - 16.0f)) - (0.813f * (float(V) - 128.0f)) - (0.391f * (float(U) - 128.0f)) );
            b = CLIP(GET_B_FROM_YUV(Y2, U, V));
            //b = (unsigned char)CLIP( (1.164f * (float(Y2) - 16.0f)) + (2.018f * (float(U) - 128.0f)) );

            stream[streamid]->rgb_buffer[dstIndex] = b;
            stream[streamid]->rgb_buffer[dstIndex + 1] = g;
            stream[streamid]->rgb_buffer[dstIndex + 2] = r;

            dstIndex += 3;

            srcIndex += 4;
        }

        return true;
    } catch(...) {
        return false;
    }
} 
```

在这不起作用之后，我假设 a) 我的色彩空间转换功能是错误的，或者 b) videoInput 对我说谎。

好吧，我想仔细检查一下 videoInput 确实告诉了我真相，事实证明，除了详细信息之外，我绝对无法看到我从 videoInput::getPixels() 函数获得的像素格式文本（除非我非常疯狂并且看不到它）。这让我假设 videoInput 有可能在幕后进行某种色彩空间转换，因此无论网络摄像头如何，您始终都能获得一致的图像。考虑到这一点，并遵循 videoInput.h:96 中的一些文档，它似乎只是给出了 RGB 或 BGR 图像。

我用来显示图像的实用程序采用 RGB 图像（Java BufferedImage），所以我想我可以直接从 videoInput 提供原始数据，应该没问题。

这是我在 Java 中设置图像的方法：

```
BufferedImage buffer = new BufferedImage(directShow.device_stream_width(stream),directShow.device_stream_height(stream), BufferedImage.TYPE_INT_RGB );

int rgbdata[] = directShow.grab_frame_stream(stream);
if( rgbdata.length > 0 ) {
  buffer.setRGB(
    0, 0,
    directShow.device_stream_width(stream),
    directShow.device_stream_height(stream),
    rgbdata,
    0, directShow.device_stream_width(stream)
  );
} 
```

以下是我将它发送到 Java (C++/JNI) 的方式：

```
JNIEXPORT jintArray JNICALL Java_directshowcamera_dsInterface_grab_1frame_1stream(JNIEnv *env, jobject obj, jint streamid)
{
    //jclass bbclass = env->FindClass( "java/nio/IntBuffer" );
    //jmethodID putMethod = env->GetMethodID(bbclass, "put", "(B)Ljava/nio/IntBuffer;");
    int buffer_size;
    jintArray ia;
    jint *intbuffer = NULL;
    unsigned char *buffer = NULL;

    append_stream( streamid );

    buffer_size = stream_device_rgb24_size(streamid);
    ia = env->NewIntArray( buffer_size );
    intbuffer = (jint *)calloc( buffer_size, sizeof(jint) );

    buffer = stream_device_buffer_rgb( streamid );
    if( buffer == NULL ) {
        env->DeleteLocalRef( ia );
        return env->NewIntArray( 0 );
    }

    for(int i=0; i < buffer_size; i++ ) {
        intbuffer[i] = (jint)buffer[i];
    }
    env->SetIntArrayRegion( ia, 0, buffer_size, intbuffer );

    free( intbuffer );

    return ia;
} 
```

在过去的两周里，这一直让我发疯，我也尝试了向我建议的任何变化，但绝对没有成功。

# javascript - jQuery 模糊不适用于 IE8 和 IE7

> ID：12502386
> 
> 赞同：0
> 
> 时间：2012-09-19T20:29:17.643
> 
> 标签：javascript, jquery, asp.net, internet-explorer, telerik

我有以下代码：

```
jQuery(document).ready(function ($) {
    // ...
    Sys.Application.add_load(function () {
        $(".RadGrid td > .RadInput.RadInput_Default > .riTextBox.riEnabled").each(function () {
            $(this).val($(this).val().replace(/,/g, ""));
        });

        $(".RadGrid td > .RadInput.RadInput_Default > .riTextBox.riEnabled").blur(function () {
            $(this).val($(this).val().replace(/,/g, ""));
        });
    });
} 
```

我编写此代码的原因是我正在使用 Telerik RadGrid，它有一些自动生成的列和一个列过滤器，它格式化整数列过滤器值的值。例如，1000000 变为 1,000,000。它工作正常，但我必须摆脱格式，因为它打扰了一些人。本质上，我们讨论的 HTML 元素是输入，它们由 Telerik 修改，可以通过您在代码中看到的选择器找到。我想确保用户永远不会在这些输入中看到逗号。我的代码在 google Chrome、FF 和 IE9 中运行良好，但无法在 IE8 和 IE7 中运行。事实上，在加载我的页面后，我看不到逗号，但是，如果我将它们编辑到项目之外，则会出现逗号。这些问题仅适用于 IE8 和 IE7。如何修复我的代码以在 Chrome、FF、IE9 中工作，

预先感谢您的任何帮助。

最好的祝福，

拉霍斯阿尔帕德。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T21:35:50.597

从[JQuery 文档](http://api.jquery.com/blur/)：

> blur 事件在失去焦点时发送到元素。原本这个事件只适用于表单元素，比如<input>。在最近的浏览器中，事件的域已扩展为包括所有元素类型。

因此，如果，正如我猜想的那样，riTextBox 是一个包含输入的跨度类，那么这应该可以工作：

```
 $(".RadGrid td > .RadInput.RadInput_Default > .riTextBox.riEnabled input")
       .blur(function () {
                 $(this).val($(this).val().replace(/,/g, ""));
    }); 
```

# java - Java泛型：通配符捕获编译错误

> ID：12502388
> 
> 赞同：0
> 
> 时间：2012-09-19T20:29:22.527
> 
> 标签：java, templates, generics, compiler-errors

**我收到以下编译错误：**

```
The method sort(List<T>, Comparator<? super T>) in the type Collections is not applicable for the arguments (T[], Comparator<capture#1-of ? extends T>) Main.java   /Sorting/src/com/kash/test  line 11
The method sort(List<T>, Comparator<? super T>) in the type Collections is not applicable for the arguments (T[], Comparator<capture#2-of ? super T>)   Main.java   /Sorting/src/com/kash/test  line 15
The method sort(List<T>, Comparator<? super T>) in the type Collections is not applicable for the arguments (T[], Comparator<T>)    Main.java   /Sorting/src/com/kash/test  line 19 
```

**当我编译（在 Eclipse Juno 中使用 JDK 1.7.0）此代码时：**

```
package com.kash.test;

import java.util.Collections;
import java.util.Comparator;

// 3 attempts to write a wrapper over: Collections' method
//      public static <T> void sort(List<T> list, Comparator<? super T> c)
public class Main {

    public static <T> void sort1(T[] array, Comparator<? extends T> c) {
        Collections.sort(array, c); // line 11
    }

    public static <T> void sort2(T[] array, Comparator<? super T> c) {
        Collections.sort(array, c); // line 15
    }

    public static <T> void sort3(T[] array, Comparator<T> c) {
        Collections.sort(array, c); // line 19
    }

    public static void main(String[] args) {

    }
} 
```

我已阅读以下内容，但并不太了解。有什么帮助吗？

*   [Java 泛型：通配符捕获误解](https://stackoverflow.com/questions/12043874/java-generics-wildcard-capture-misunderstanding)
*   [什么是PECS（Producer Extends Consumer Super）？](https://stackoverflow.com/questions/2723397/java-generics-what-is-pecs/2723538)
*   从上面的线程中阅读更多内容：
    *   [无法使用通配符泛型类型向 Java 集合添加值](https://stackoverflow.com/questions/3716920/cant-add-value-to-the-java-collection-with-wildcard-generic-type)
    *   [使用通配符的 Java 集合](https://stackoverflow.com/questions/69702/java-collections-using-wildcard)
    *   [java中的通用集合和通配符](https://stackoverflow.com/questions/7363170/generic-collection-wildcard-in-java)
    *   [泛型 - 无法使用无界通配符添加到列表](https://stackoverflow.com/questions/9637125/generics-cannot-add-to-a-list-with-unbounded-wildcard)
    *   [Collection<?> 和 Collection<T> 有什么区别](https://stackoverflow.com/questions/10777701/what-is-the-difference-betwen-collection-and-collectiont)

- 编辑 -

对于那些想知道我为什么做这么愚蠢的事情的挑剔的人。如果你不在乎我为什么要这样做，那就别打扰其他人了。

为什么？

我正在编写以下接口的几个实现（例如 Quick、Insertion、Heap、Mixed、Intro、Bubble...）：

```
package com.kash.src;

import java.util.Comparator;
import java.util.List;

/**
 * Interface that provides all sorting functions for all possible representations of a list of Objects (non-primitive
 * types). <br>
 * - {@link List}<{@link Comparable}><br>
 * - Array of < ? extends {@link Comparable}><br>
 * - {@link List}< ? > with external {@link Comparator}<br>
 * - Array of < ? > with external {@link Comparator}<br>
 * 
 * @author Kashyap Bhatt
 * 
 */

public interface Sorter {
    <T extends Comparable<T>> void sort(List<T> list);

    <T extends Comparable<T>> void sort(T[] array);

    <T extends Object> void sort(List<T> list, Comparator<? super T> c);

    <T extends Object> void sort(T[] array, Comparator<? super T> c);
} 
```

这样我就可以测试我所有的排序实现并测试它们。我想将结果与 Java 的排序实现进行比较，所以我也在编写这个接口的实现，它在内部只调用 Java 的排序方法。这就是我遇到问题的地方。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T20:32:57.740

[Collections#sort](http://docs.oracle.com/javase/6/docs/api/java/util/Collections.html#sort%28java.util.List%29)预计`List`您正在传递一个数组。
做：

```
public static <T> void sort1(T[] array, Comparator<? extends T> c) {
        Collections.sort(Arrays.asList(array), c); // line 11
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-19T20:33:11.573

`Collections.sort()`不对数组进行排序，而是对`List`s.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-19T20:35:30.740

> Collections 类型中的方法`sort(List<T>, Comparator<? super T>)`不适用于参数`(T[], Comparator<capture#1-of ? extends T>)`Main.java /Sorting/src/com/kash/test 第 11 行

您正在通过预期的`T[]`地方和预期的地方。`List<T>``Comparator<? extends T>``Comparator<? super T>`

**为什么你认为它不应该给出错误？**

# html - 如何匹配 HTML 标签之外的 RegExp

> ID：12502391
> 
> 赞同：2
> 
> 时间：2012-09-19T20:29:40.997
> 
> 标签：html, regex, replace, tags

> **可能重复：**
> [正则表达式匹配打开的标签，XHTML 自包含标签除外](http://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags)

如何匹配HTML 标记*之外*的一些字母数字单词，而不是匹配每个单词

例子：

```
<div id="mariano mariano mariano" nota="mariano/mariano">mariano was looking forward Mariano. I want to match this "Mariano" too. Mariano</div> 
```

在此示例中，我想匹配标签 ID 之外的所有“Mariano”。

我认为这个问题的关键是在“<”之前期待“<”并匹配该单词，但如果正则表达式在“<”之前找到“>”，这意味着该单词在标签中，但我无法为此实现/生成正则表达式。

我无法尝试将此正则表达式`(?<=^|>)[^><]+?(?=<|$)`与另一个正则表达式连接起来。我最终的最低质量解决方案是：

```
<!-- language: lang-js -->
var searchFor = new RegExp("((!?<=^|>)" + termino + ")","ig");
var searchFor2 = new RegExp("(" + termino + "(?=<|$))","ig");
var searchFor3 = new RegExp("(!?<=^|[\\s\\.;,])" + termino + "(?=[\\s\\.;,]|$)","ig"); 
```

但是这 3 个并没有涵盖所有的选择。

编辑：我正在使用 javascript：

```
<script>
container.find("p, span, div, .texto,").each(function() {
var containerText = $(this).html();
for (var i = 0; i < terms.length; i++) {
    var termino = terms[i];
    // 1st issue ">termino" was remplaced for: ">Pedro"
    var searchFor = new RegExp("((!?<=^|>)" + termino + ")","ig");
    containerText = containerText.replace(searchFor,">Pedroedro");
    // 2nd issue "termino<" was remplaced for: "Pedro"
    var searchFor2 = new RegExp("(" + termino + "(?=<|$))","ig");
    containerText = containerText.replace(searchFor2,"Pedro");
    // 3rd issue "[\.\s,;:]termino[\.\s,;:]
    var searchFor3 = new RegExp("(!?<=^|[\\s\\.;,])" + termino + "(?=[\\s        \\.;,]|$)","ig");
    containerText = containerText.replace(searchFor3," Pedro");
};
$(this).html(containerText);
}); 
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T22:00:47.390

一些东西 -

1.  欢迎来到堆栈溢出！
2.  请在提问前搜索问题。使用正则表达式解析 xml 有很多结果。
3.  不要使用正则表达式来解析 xml/html！ [试试 xpath](https://developer.mozilla.org/en-US/docs/Introduction_to_using_XPath_in_JavaScript#Iterator_Example)！

    ```
    var termino = // how ever you were defining before...

    // Give me all divs, where the text content contains value of "termino"
    var iterator = document.evaluate('//div/text()[contains(.,' + termino + ')]', documentNode, null, XPathResult.UNORDERED_NODE_ITERATOR_TYPE, null );

    try {
      // init thisNode to the first item in the iterator
      var thisNode = iterator.iterateNext();

      // go through all items, alert their content (which should contain termino)
      while (thisNode) {
        alert( thisNode.textContent );
        thisNode = iterator.iterateNext();
      } 
    }
    catch (e) {
       dump( 'Error: Document tree modified during iteration ' + e );
    } 
    ```

# ios - 请将设备恢复到以下列出的操作系统版本，或更新到最新版本的 iOS SDK

> ID：12502392
> 
> 赞同：1
> 
> 时间：2012-09-19T20:29:43.533
> 
> 标签：ios, ipad, provisioning, xcode3.2

我刚刚注册了 iOS 开发计划。我有一台运行 iOs 5.1.1 的 iPad2，并且正在 XCode3.2.6 中开发。我已经完成了获取配置文件并使用我的 iPad 进行开发的步骤，但它不工作......

> 未连接配置的 iOS 设备。请检查管理器以查看任何已连接设备的状态。

我的设备在“整理”屏幕中显示为黄色，并显示以下消息：

> XXXXX 上的 iOS 版本与使用此 iOS SDK 安装支持开发的任何 iOS 版本不匹配。请将设备恢复到以下列出的操作系统版本，或更新到最新版本的 iOS SDK；可在此处获得。
> 
> 操作系统安装在 XXXXX 5.1.1 (9B206)
> 
> Xcode 支持的 iOS 版本 最新 4.3 (8F190) 4.2 4.1 4.0 4.0.2 4.0.1 3.2 3.2.2 3.2.1 3.1 3.1.3 3.1.2

我认为这是 iOS 版本和 SDK 之间的一些不兼容，但我应该怎么做？管理器屏幕似乎让我可以更改 iOS，但询问我在哪里可以找到我没有的文件图像。而且我不知道如何或在哪里安装不同的 SDK。

抱歉，如果我解释得不好，我在这里迷路了。尽管我的应用程序在模拟器中运行，但即使在阅读了入门指南之后，我也确实没有遵循所有这些配置/配置文件的内容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T20:34:05.920

你的 Xcode 太旧了。您必须至少升级到 XCode 4.3。但是要升级到 XCode 4.3，你的 mac 需要运行 Lion。这很麻烦，但在那之后，您将能够为您当前在 iOS 5 上的 iPad 构建。否则，您需要一个在以前版本的 iOS 上的设备，但这不可持续，因为苹果有一种“自动更新”你的软件......（当然，或者因为一些粗心的设置）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-31T05:08:59.703

1 打开 Xcode 5（你应该有 Xcode 5）

2 在 Xcode 5 的设备选择中为您的应用选择您的 iPhone5（iOS7 或 +）。

3 关闭 Xcode 5，然后打开 Xcode 4

4 Your iPhone5 with iOS7 can now be used as test device.

Hope this helps.

# licensing - IOS6 Mapkit 许可、使用条款

> ID：12502393
> 
> 赞同：3
> 
> 时间：2012-09-19T20:29:43.983
> 
> 标签：licensing, mapkit, ios6, ios6-maps

在 IOS6 中，地图数据从 Google 替换为 Apple 自己的地图数据。

过去，使用 MapKit 时，您必须接受 Google 地图许可和使用条款 ( [https://developers.google.com/maps/iphone/terms](https://developers.google.com/maps/iphone/terms) )。新 MapKit 及其新地图数据的情况如何？例如，GoogleMaps 无法在商业应用程序中免费使用，要使用它，您必须购买一些高级套餐。等等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-24T21:31:41.123

由于评论变得太长，重新开始。要点是

1) 您无需为在商业应用程序中使用 MapKit 付费（请注意，如果您仅对地图访问收费，则您违反了条款 - 没有提及采取了什么行动，还有一些人将 Javascript API 条款与 MapKit 条款混淆）。

1.2) 许可协议第 10.9 条规定的例外情况除外

2) 在 iOS 6 下使用 MapKit 与使用 ApplicationKit、UIKit 或 Apple 提供的任何其他框架没有什么不同。您可以在商业应用程序中使用它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T19:57:23.313

这个特殊的主题非常模糊。过去 2 天我一直在研究这个问题......所以这是我的 2 美分：

*   Mapkit 是一回事，GMAP 条款和条件是另一回事。Mapkit 是免费的这一事实并不意味着地图提供商将免费为您提供数据并允许任何形式的使用。
*   如果您要在地图上显示车辆的位置并且这些车辆是您的客户（您为服务收费），您需要 GMAP 商业版和 Premier API。没有办法绕过它，*无论 iPhone 应用程序是否免费*，这也*与框架 (Mapkit) 无关*。
*   解决有关 Apple Maps 是否会免费的最初问题，至少现在无法知道......没有人知道。我们可以*推测*它将是免费的，因为如果不是这样，它将破坏在 iOS 5 时代开发的其他跟踪应用程序的当前功能，其中 GMAP 是当前的数据提供者。我们还可以推测，由于 GMAP Business 每年 1 万美元 + 流量，它不会是免费的！

最重要的是，关于“使用基于位置的 API 进行调度、车队管理或紧急服务的应用将被拒绝”，请注意它说的是“基于位置的 API”，您的应用“不会使用”它，因为您的服务器上已经有了位置数据。这句话背后的想法是避免应用会实时跟踪 iPhone 用户。您可以拥有最出色的 Fleet Management 应用程序，而永远不要使用内置 GPS 天线，仅仅是因为您不需要它。

资料来源：

*   [https://developers.google.com/maps/licensing](https://developers.google.com/maps/licensing)
*   [https://developers.google.com/maps/iphone/terms](https://developers.google.com/maps/iphone/terms)
*   [http://www.google.com.pr/enterprise/earthmaps/maps-faq.html](http://www.google.com.pr/enterprise/earthmaps/maps-faq.html)（查看问题“Google Maps API for Business 的成本是多少？”）

已经在这样做的应用程序：

*   [https://itunes.apple.com/us/app/fleetmatics/id441922434?mt=8](https://itunes.apple.com/us/app/fleetmatics/id441922434?mt=8)
*   [https://itunes.apple.com/en/app/scania-fleet-management/id513863147?mt=8](https://itunes.apple.com/en/app/scania-fleet-management/id513863147?mt=8)

希望有帮助。-

# java - 所有选项卡末尾的按钮用于关闭窗口

> ID：12502401
> 
> 赞同：0
> 
> 时间：2012-09-19T20:30:20.747
> 
> 标签：java, tabs, jbutton, jtabbedpane

`JTabbedPane`我需要将最小化和关闭按钮放在我结束的右上角。为清楚起见，圈出的区域是我需要的两个按钮（我有一个未装饰的框架）

![显示两个按钮的圆圈区域](../Images/4688d52b47423272d5b88c60865607d3.png)

谁能指导我如何实现这一目标？我的问题是（更多）关于按钮的定位（在 JTabbedPane 上）而不是实现最小化/关闭的功能

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T22:10:35.270

作为子项添加到 JTabbedPane 的所有组件都将包装在选项卡中。这意味着无法将按钮直接添加到 JTabbedPane。如果您想将关闭和最小化按钮直接作为选项卡式窗格的一部分（而不是稍微放在一边），我建议使用自定义选项卡组件 ( `JTabbedPane.setTabComponentAt()`) 将两个选项卡添加到选项卡式窗格中，这些组件是按钮。由于按钮是选项卡的唯一组件，因此无法选择实际的“选项卡”本身，只会发生按钮事件。使用 JTabbedPane 无法固定选项卡的位置，这将导致这两个“按钮选项卡”在您选择的布局中浮动。在它们的左侧插入更多选项卡将具有始终以关闭和最小化按钮结束选项卡列表的效果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-13T22:04:55.933

我有一个解决这个问题的方法：只需在选项卡式窗格旁边放一个工具栏

```
import java.awt.BorderLayout;
import java.awt.EventQueue;

import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.UIManager;
import javax.swing.UnsupportedLookAndFeelException;
import javax.swing.border.EmptyBorder;

import java.awt.GridBagLayout;
import java.awt.GridBagConstraints;

import javax.swing.JTabbedPane;

import java.awt.FlowLayout;
import java.awt.Insets;

import javax.swing.JToolBar;

import java.awt.ComponentOrientation;

import javax.swing.JButton;

import java.awt.Cursor;

public class PanelTab extends JFrame {

private JPanel contentPane;

/**
 * Launch the application.
 */
public static void main(String[] args) {
    try {
        UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
    } catch (ClassNotFoundException e1) {
        // TODO Auto-generated catch block
        e1.printStackTrace();
    } catch (InstantiationException e1) {
        // TODO Auto-generated catch block
        e1.printStackTrace();
    } catch (IllegalAccessException e1) {
        // TODO Auto-generated catch block
        e1.printStackTrace();
    } catch (UnsupportedLookAndFeelException e1) {
        // TODO Auto-generated catch block
        e1.printStackTrace();
    }
    EventQueue.invokeLater(new Runnable() {
        public void run() {
            try {
                PanelTab frame = new PanelTab();
                frame.setVisible(true);
            } catch (Exception e) {
                e.printStackTrace();
            }
        }
    });
}

/**
 * Create the frame.
 */
public PanelTab() {
    setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    setBounds(100, 100, 450, 300);
    contentPane = new JPanel();
    contentPane.setBorder(new EmptyBorder(5, 5, 5, 5));
    setContentPane(contentPane);

    GridBagLayout gbl_contentPane = new GridBagLayout();
    gbl_contentPane.columnWidths = new int[] { 424, 0 };
    gbl_contentPane.rowHeights = new int[] { 51, 0 };
    gbl_contentPane.columnWeights = new double[] { 1.0, Double.MIN_VALUE };
    gbl_contentPane.rowWeights = new double[] { 1.0, Double.MIN_VALUE };
    contentPane.setLayout(gbl_contentPane);

    JPanel panel = new JPanel();
    GridBagConstraints gbc_panel = new GridBagConstraints();
    gbc_panel.fill = GridBagConstraints.BOTH;
    gbc_panel.gridx = 0;
    gbc_panel.gridy = 0;
    contentPane.add(panel, gbc_panel);

    GridBagLayout gbl_panel = new GridBagLayout();
    gbl_panel.columnWidths = new int[] { 184, 0 };
    gbl_panel.rowHeights = new int[] { 54, 0 };
    gbl_panel.columnWeights = new double[] { 1.0, Double.MIN_VALUE };
    gbl_panel.rowWeights = new double[] { 1.0, Double.MIN_VALUE };
    panel.setLayout(gbl_panel);

    JToolBar toolBar = new JToolBar();
    toolBar.setOpaque(false);
    toolBar.setComponentOrientation(ComponentOrientation.LEFT_TO_RIGHT);
    toolBar.setFloatable(false); // The toolbar must not be float

    GridBagConstraints gbc_toolBar = new GridBagConstraints();
    gbc_toolBar.anchor = GridBagConstraints.NORTHEAST;
    gbc_toolBar.gridx = 0;
    gbc_toolBar.gridy = 0;
    panel.add(toolBar, gbc_toolBar);

    JButton btnHola = new JButton("You must put your exit icon here");
    btnHola.setOpaque(false);
    toolBar.add(btnHola);

    JTabbedPane tabbedPane = new JTabbedPane(JTabbedPane.TOP);
    GridBagConstraints gbc_tabbedPane = new GridBagConstraints();
    gbc_tabbedPane.fill = GridBagConstraints.BOTH;
    gbc_tabbedPane.gridx = 0;
    gbc_tabbedPane.gridy = 0;
    panel.add(tabbedPane, gbc_tabbedPane);

    JPanel panel_1 = new JPanel();
    tabbedPane.addTab("New tab", null, panel_1, null);
}
} 
```

我想这可能会帮助你...

# java - 从 jtextarea 获取文本拆分它并将其传递给新行的 jlabel？

> ID：12502406
> 
> 赞同：1
> 
> 时间：2012-09-19T20:30:44.490
> 
> 标签：java, user-interface

嗨，朋友们，我是新来的，我在两个类中编写了一个代码，在一个类中，当我们单击按钮时，我声明了一个 jtextarea 和一个按钮，然后文本将拆分并显示在 jlabel 中，但问题是文本是用 jtext 编写的区域和按钮也可以工作，但是当 jlabel 框架打开时，这里什么都不显示，这是我的代码第一类

```
import java.awt.Container;
import java.awt.Dimension;
import java.awt.FlowLayout;
import java.awt.Font;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JTextArea;

public class Try extends JFrame {

    JTextArea text;
    String string;
   public Try(){

 super("survey");
          Container container=getContentPane();
          container.setLayout(new FlowLayout());
          text=new JTextArea();
                text.setLineWrap(true);
        text.setWrapStyleWord(true);
        text.setPreferredSize(new Dimension(350,150));
           string=text.getText();
         JButton showDialogBtn = new JButton("Add Text");
        container.add(text);
        container.add( showDialogBtn);

       showDialogBtn.addActionListener(new ActionListener() {
            @Override
         public void actionPerformed(ActionEvent e) {
     jlabel l=new jlabel();
     l.setSize(700,700);
   l.setVisible(true);          
            }
      });

   }  

    public static void main(String[] args) {
        // TODO code application logic here
        Try t=new Try();
        t.setSize(400,500);
  t.setVisible(true);
    }

    String getArray()
  {
  return  string ;
           }

} 
```

但是第二个类是 jlabel 类没有显示所需的结果请在这方面提供帮助

```
import java.awt.Container;
import java.awt.Font;
import javax.swing.*;
 class jlabel extends JFrame {
 Try t=new Try();
   public jlabel(){
          JFrame frame=new JFrame("jlabel");
          JPanel jp1=new JPanel();
   String string=t.getArray();
    String[] labelStrings = string.split(" \\s*");   
     for (String labelString : labelStrings)
    {
      // create JLabels and add
      JLabel label = new JLabel(labelString);
      jp1.add(label);
      frame.add(jp1);

    }

 }
 } 
```

等待回复提前谢谢问候，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T20:44:38.167

第一堂课还不错，但“jLabel”课有很多错误。请看下面那个有效的。

jlabel类中的问题总结：

*   实例化了另一个 Try 对象，并使用了此实例
*   您正在创建一个新的 JFrame，即使您已经对它进行了子类化。
*   没有布局管理器。

等等...

```
import javax.swing.BoxLayout;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;

class Label extends JFrame {

    public Label(String string) {
        super("jlabel");
        JPanel jp1 = new JPanel();
        jp1.setLayout(new BoxLayout(jp1, BoxLayout.Y_AXIS));
        String[] labelStrings = string.split(" \\s*");
        for (String labelString : labelStrings) {
            // create JLabels and add
            JLabel label = new JLabel(labelString);
            jp1.add(label);
        }
        getContentPane().add(jp1);
    }
} 
```

在 Try 类中，以这种方式初始化它：

```
Label l = new Label(text.getText()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T20:38:38.453

问题是您在 actionPerformed() 方法之外调用 getText() 。这个方法在按钮被按下时运行，所以如果你想获取文本，你应该在 actionPerformed() 中调用 getText() 方法。

您的代码在运行后会立即获取文本，而它所能找到的一切都没有！所以，这就是粘贴到 JLabel 中的内容。

# json - JQuery JSON 服务不会消耗

> ID：12502409
> 
> 赞同：0
> 
> 时间：2012-09-19T20:30:53.850
> 
> 标签：json, wcf, web-services, jquery

我正在尝试使用我新设置的 JSON 服务。我创建了一个基本的小提琴，它只是在运行时发出警报。正如您将看到的，它似乎无法获得响应，但是当您检查 Web 服务 URL 时，它显然正在发送响应。[http://196.34.92.60/api/api/v1/public.svc/getoperators]

感谢能够指出我错误的冠军的帮助。

小提琴地址：http: [//jsfiddle.net/devin85/JmTe4/3/](http://jsfiddle.net/devin85/JmTe4/3/)

干杯德文

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T20:44:35.320

您的 Json 无效，因此您的请求无法解析。此外，如果它来自不同的域，您的数据类型应该是 jsonp。更改您的错误以查看问题

```
 error: function(jqXHR, textStatus, errorThrown) {
        alert(textStatus);
    } 
```

您要求 url 返回一个 JSON，但您的 json 是这样的 :: `golden arrowjammiemyciti`这是无效的。所以你需要让你的结果正确。它可以看起来像这样。

```
"result":"golden arrowjammiemyciti" 
```

此外，如果您的域不同，则需要将其更改为 JSONP。否则做一个没有任何 json 类型的普通 ajax 请求。

# java - 无法为 JSP 编译类：无法解析为类型

> ID：12502412
> 
> 赞同：7
> 
> 时间：2012-09-19T20:30:56.197
> 
> 标签：java, jsp, jakarta-ee, tomcat, servlets

我正在开发一个动态网络项目。项目在本地服务器上运行良好，但不是在现场。在实时服务器上，它在我使用任何 java 对象的行抛出异常：

org.apache.jasper.JasperException：无法为 JSP 编译类：

```
 An error occurred at line: 7 in the jsp file: /groups.jsp
CollectionAppService cannot be resolved to a type
4: <%
5:  String json = "[]";
6:  try {
7:      CollectionAppService collectionAppService = new CollectionAppService();
8:      json = collectionAppService.getGroupsJson();
9:  } catch (Exception e) {
10:         e.printStackTrace(); 
```

项目在本地服务器上运行，但在最大类文件的错误日志中也有错误：

错误：

```
Thu Sep 20 01:16:11 GMT+05:30 2012
File not found: /Users/sukhpal/Data/Workspaces/J2EE Workspace/CollectionApp/build/classes/com/mut/service/common/Constants.class. 
```

请帮忙。（Tomcat 在我的实时服务器上启用）。

以下是实时服务器的链接 [http://mutmanager.com/webservice/groups.jsp](http://mutmanager.com/webservice/groups.jsp)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-19T20:36:18.497

看起来您忘记`CollectionAppService`在 JSP 中导入您的：

```
<%@ page import="your.package.CollectionAppService" %> 
```

但是，有一个主要问题，您不应该将 Java 代码放在您的 JSP 中。相反，您应该将代码移动到一个类并从 Servlet 或类似的类中调用它。

主要文章：

*   [如何避免 JSP 文件中的 Java 代码？](https://stackoverflow.com/q/3177733/1065197)

不要忘记学习是好的，而且要以正确的方式学习。

* * *

再次阅读您的问题后，我看到了这条 Stacktrace 行：

> 找不到文件：/Users/sukhpal/Data/Workspaces/J2EE Workspace/CollectionApp/build/classes/com/mut/service/common/Constants.class

我猜您的问题是`Constant`类（以及您的问题`CollectionApp`）在项目 B 中。您正在使用来自另一个包含这些类的项目的绝对路径引用，并且您可能没有上传它。

想象一下这种情况：您有一个 Web 项目（项目 A），并且您有一些类已经在另一个项目（项目 B）中完成了繁重而精美的工作，您在您从事的大多数项目中重复使用这些类。在您的开发环境中，您有从项目 A 到项目 B 的引用，但是您只将项目 A 上传到您的生产环境。这样当A项目想调用B项目的一个类时，永远找不到，抛出异常。

最佳解决方案：

*   从项目 B 创建一个 jar。
*   在项目 A 中，删除对项目 B 的所有引用。
*   将 jar 添加到项目 A 中并将其设置在 Build Path 中。
*   将您的项目 A 上传到生产环境。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T20:32:18.177

看来您在 JSP 之上缺少导入语句

您需要使用 import 导入用户定义的类

例子：

```
<%@ page import="yourpackage.CollectionAppService" %> 
```

# jquery - 如何在使用委托（）处理其事件的元素上触发（）事件

> ID：12502414
> 
> 赞同：3
> 
> 时间：2012-09-19T20:30:59.937
> 
> 标签：jquery, delegates, triggers

我在页面上有一个标签样式导航。如果页面加载时在 URL 中传递了选项卡标识符，我想显示相应的选项卡，例如[http://example.com/page.html#my-tab](http://example.com/page.html#my-tab)。

目前，触发选项卡显示的 A 标记的事件处理程序被委托给它的父级：

```
$("nav.tabs").delegate("a", "click", function (e) {
    //trigger event
} 
```

我正在检查 URL 中 HASH 的页面加载，检查它是否对应于 A 标记的 HREF 属性，然后触发该事件，但它不起作用。

```
var tab = window.location.hash;

    if (tab != undefined) {
        console.log(tab)
        if ( $("a[href="+tab+"]" ).length > 0) {
            console.log(tab)
            $("a[href="+tab+"]").trigger("click");  
        }
    } 
```

有什么建议么？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T21:09:07.313

我发现它在 Firefox 中有效，但在 Chrome 和 IE 中无效。最好的方法是，您可以命名它，而不是使用匿名函数，然后“伪造”调用

```
var $nav_tabs = $("nav.tabs");
$nav_tabs.delegate("a", "click", function clickme(e) {
 //trigger event
});

var tab = window.location.hash;
if (tab != undefined) {
    console.log(tab);
    if ((tab = $nav_tabs.find("a#" + tab)).length > 0) {
        console.log(tab);
        clickme.apply( $nav_tabs, [ { target: this } ]);   
    }
} 
```

# ruby-on-rails-3 - Rails nested_form 将项目添加到表行

> ID：12502416
> 
> 赞同：9
> 
> 时间：2012-09-19T20:31:08.550
> 
> 标签：ruby-on-rails-3, html-table, nested-forms

我的目标是使用nested_form gem：[https](https://github.com/ryanb/nested_form) ://github.com/ryanb/nested_form 但不是每次添加对象时只创建一组新的标签和字段，而是想在现有表中插入一行。

```
= nested_form_for @transaction do |f|
%h3 Line Items 
%table
  %tr
    %th Branch
    %th Department
    %th Invoice #
    %th Amount
    %th Transaction Type
    %th Deposit (y/n)
    %th

  = f.fields_for :line_items do |line_item|
    %tr
      %td 
        = line_item.text_field :location_id
      %td 
        = line_item.text_field :department_id
      %td 
        = line_item.text_field :invoice_num
      %td 
        = line_item.text_field :amount
      %td 
        = line_item.text_field :transaction_type
      %td 
        = line_item.text_field :deposit
      %td= line_item.link_to_remove "Remove"
    %p= f.link_to_add "Add", :line_items 
```

.link_to_add 按钮只是在第一行创建一堆字段，第一个 td。

```
<h3>Line Items</h3>
<table>
  <tr>
    <th>Branch</th>
    <th>Department</th>
    <th>Invoice #</th>
    <th>Amount</th>
    <th>Transaction Type</th>
    <th>Deposit (y/n)</th>
    <th></th>
  </tr>
  <div class="fields"><tr>
    <td>
      <input id="transaction_line_items_attributes_0_location_id" name="transaction[line_items_attributes][0][location_id]" size="30" type="text" />
    </td>
    <td>
      <input id="transaction_line_items_attributes_0_department_id" name="transaction[line_items_attributes][0][department_id]" size="30" type="text" />
    </td>
    <td>
      <input id="transaction_line_items_attributes_0_invoice_num" name="transaction[line_items_attributes][0][invoice_num]" size="30" type="text" />
    </td>
    <td>
      <input id="transaction_line_items_attributes_0_amount" name="transaction[line_items_attributes][0][amount]" size="30" type="text" />
    </td>
    <td>
      <input id="transaction_line_items_attributes_0_transaction_type" name="transaction[line_items_attributes][0][transaction_type]" size="30" type="text" />
    </td>
    <td>
      <input id="transaction_line_items_attributes_0_deposit" name="transaction[line_items_attributes][0][deposit]" size="30" type="text" />
    </td>
    <td><input id="transaction_line_items_attributes_0__destroy" name="transaction[line_items_attributes][0][_destroy]" type="hidden" value="false" /><a href="javascript:void(0)" class="remove_nested_fields" data-association="line_items">Remove</a></td>
  </tr>
  <td><a href="javascript:void(0)" class="add_nested_fields" data-association="line_items">Add</a></td>
  </div>
</table> 
```

我尝试将 .link_to_add 放在几个地方，但它没有将它们放在自己的行中。

有没有一种简单的方法可以每次添加一行输入框？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-28T00:59:26.707

这对我帮助很大：[https ://github.com/ryanb/nested_form/wiki/How-To:-Render-nested-fields-inside-a-table](https://github.com/ryanb/nested_form/wiki/How-To:-Render-nested-fields-inside-a-table)

> 默认情况下`fields_for`，内部会在每个嵌套对象周围`nested_form_for`添加`<div class="fields">`包装器。但是当您需要在表格中呈现嵌套字段时，您可以使用`:wrapper => false`选项禁用默认包装器并使用自定义包装器：
> 
> ```
> <table>
>   <%= f.fields_for :tasks, :wrapper => false do |task_form| %>
>     <tr class="fields">
>       <td>
>         <%= task_form.hidden_field :id %>
>         <%= task_form.text_field :name %>
>       </td>
>       <td><%= task_form.link_to_remove 'Remove' %></td>
>     </tr>
>   <% end %>
>   <tr>
>     <td><%= f.link_to_add 'Add', :tasks %></td>
>   </tr>
> </table> 
> ```
> 
> 注意：您需要指定 id 字段。否则 fields_for 将在`</tr>`.
> 
> 您还需要使用 javascript 覆盖将新子表单插入表单的默认行为：
> 
> ```
> window.NestedFormEvents.prototype.insertFields = function(content, assoc, link) {
>   var $tr = $(link).closest('tr');
>   return $(content).insertBefore($tr);
> } 
> ```
> 
> 类似的技术可用于列表，以与 jQuery UI 可排序列表兼容。
> 
> 如果您使用的是 simple_form，则将 :wrapper => false 选项添加到周围的 simple_nested_form_for 调用中，否则它会被 :wrapper => nil 默认值覆盖。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T17:55:06.897

我最终将我的 link_to_add 作为表格的最后一行，将其添加到我的 application.js 中（主要来自 wiki 上的示例）

```
jQuery(function ($) {
  window.NestedFormEvents.prototype.insertFields = function(content, assoc, link) {
    if($(link).hasClass('insert_in_table')){
      return $(content).insertBefore($(link).parent().parent());
    }
    else{
      return $(content).insertBefore(link);
    }
  };
}); 
```

我的表格如下所示：

```
<table class="tab">
  <tr>
    <th>My Headers</th>
  </tr>
<%= f.fields_for :line_items, :wrapper => false do |form| %>
  <tr class="fields">
    <td>MY FIELDS</td>
  </tr>
<% end %>
  <tr>
     <td><%= f.link_to_add "Add more line items", :line_items, :class => 'insert_in_table' %></td>
  </tr>
</table> 
```

# image - 自动查找和裁剪定义的图像区域

> ID：12502417
> 
> 赞同：1
> 
> 时间：2012-09-19T20:31:09.297
> 
> 标签：image, matlab, image-processing, crop, image-segmentation

我想在matlab中处理图像

![在此处输入图像描述](../Images/f51c9d7035ec1dbffcabc0b72a2ffa0a.png)

该图像由实心背景和两个样本（顶部和底部）组成。我已经有一个将顶部和底部分开并使其成为两个图像的代码。但是我没有工作的部分是将图像仅裁剪到粘合区域（图像中的红色框，我只标记了顶部）。但是，裁剪后的图像应该是一个矩形，就像红色框一样（黄色背景，之后可以丢弃）。

我知道这可以用 来完成`imcrop`，但这需要用户手动输入。代码需要自动化，以便可以在没有用户输入的情况下处理更多图像。所有图像将具有相同的颜色（红色为胶水，黑色为材料）。

有人可以帮我弄这个吗？

编辑：感谢您的帮助。我使用以下代码来解决问题。但是，我无法摆脱红色框右侧的黑色部分。这可以通过在拍照前贴上该部分来解决。我使用的代码看起来有点奇怪，但它成功地计算了图片中的黑色区域并获得了百分比。

```
a=imread('testim0.png');
level = graythresh(a);
bw2=im2bw(a, level);
rgb2=bw2rgb(bw2);
IM2 = imclearborder(rgb2,4);
pic_negative = ait_imgneg(IM2);

%% figures
% figure()
% image(rgb2)
% 
% figure()
% imshow(pic_negative)
%% Counting percentage
g=0;
for j=1:size(rgb2,2)
    for i=1:size(rgb2,1)
        if  rgb2(i,j,1) <= 0 ...
          & rgb2(i,j,2) <= 0 ...
          & rgb2(i,j,3) <= 0
        g=g+1;
        end
    end
end

h=0;
for j=1:size(pic_negative,2)
    for i=1:size(pic_negative,1)
        if  pic_negative(i,j)== 0
        h=h+1;
        end
    end
end

per=g/(g+h) 
```

如果有人对改进代码有一些建议，我很高兴听到。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T22:18:07.167

对于基于颜色（黄色、黑色在您的情况下突出）的直接图像分割成 2 个区域（背景、前景），一个选项可以是使用[kmeans](http://en.wikipedia.org/wiki/K-means_clustering)算法对图像颜色值进行聚类。为了获得额外的鲁棒性，您可以将图像从 RGB 转换为[L *a* b*](http://en.wikipedia.org/wiki/Lab_color_space)颜色空间。

您的案例示例遵循[此处](http://www.mathworks.com/help/images/examples/color-based-segmentation-using-k-means-clustering.html)的 MATLAB Imape 处理示例。

```
% read and transform to L*a*b space
im_rgb = double(imread('testim0.png'))./256;
im_lab = applycform(im_rgb, makecform('srgb2lab')); 
```

![在此处输入图像描述](../Images/3a17719adf34096c98a881b49e6c0a4b.png)

![在此处输入图像描述](../Images/f2fde853ea3d58d274d134c9824aac6e.png)

```
% keep only a,b-channels and form feature vector
ab = double(lab_I(:,:,2:3));
[nRows, nCols, ~] = size(ab);
ab = reshape(ab,nRows * nCols,2);

% apply k-means for 2 regions, repeat c times, e.g. c = 5  
nRegions = 2;
[cluster_idx cluster_center] = kmeans(ab,nRegions, 'Replicates', 5); 

% get foreground-background mask
im_regions = reshape(cluster_idx, nRows, nCols); 
```

![在此处输入图像描述](../Images/327033377f545a3099e8f57220e566bf.png)

您可以使用生成的二值图像来索引原始参考图像中的感兴趣区域（或找到边界）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T20:52:53.687

您可以通过以下方式轻松获得未知的有界作物

1）轮廓绘制图像，

2)`find()`关于最大/最小 X/ys 的结果，

3) 使用@slayton 的方法来执行实际的裁剪。

编辑：只是看看你的实际形象 - 它不会那么容易。但是首先要对图像进行颜色增强/阈值处理，并且轮廓应该以合理的精度工作。不用说，这需要根据您的具体情况进行调整。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-19T20:38:19.673

图像保存为矩阵。如果您知道要裁剪的裁剪框的像素范围，您可以使用索引执行裁剪。

```
M = rand(100); % create a 100x100 matrix or load it from an image
left = 50;
right = 75;
top = 80;
bottom = 10;

croppedM = M(bottom:top, left:right);
%save croppedm 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-21T04:31:55.013

由于您已经能够将顶部和底部分开，并且还能够分割您想要的区域（包括您不想要的右侧的一小部分），我建议您只需在最后添加一个修复通过以下代码。

分割后，对每列蓝色强度值求和，以便将图像从 2d 压缩到 1d。因此，如果原始区域宽度=683 高度=59，则新矩阵/图像将简单地宽度=683 高度=1。现在，您可以应用一个小阈值来确定边缘应该位于的位置，并对该位置的图像应用裁剪。现在你得到你的统计数据。

# php - 我有一个 php 应用程序，当我从网页运行它时可以工作，但当我 cron 独立的 php 文件时不能

> ID：12502418
> 
> 赞同：0
> 
> 时间：2012-09-19T20:31:11.193
> 
> 标签：php, cron

我的问题很疯狂。因为，当我使用此代码执行网页时，我有一个运行良好的 PHP 脚本。

```
<html>
<body>
<p>Hello</P>
<?php
$file1 = file_get_contents("http://services.runescape.com/m=itemdb_rs/api/graph/440.json");
$file2 = file_get_contents("http://services.runescape.com/m=itemdb_rs/api/graph            /434.json");
$file3 = file_get_contents("http://services.runescape.com/m=itemdb_rs/api/graph/10294.json");
$file4 = file_get_contents("http://services.runescape.com/m=itemdb_rs/api/graph/2621.json");
$file5 = file_get_contents("../json/440.json");
$file6 = file_get_contents("../json/434.json");
$file7 = file_get_contents("../json/10294.json");
$file8 = file_get_contents("../json/2621.json");
if(($file1 != $file5)or($file2 != $file6)or($file3 != $file7)or($file4 != $file8))
{

$my_t=getdate(date("U"));
$hour = $my_t[hours];
$setTime = 12;
$ending = " # ";
if($hour > $setTime){
$hour-=$setTime;
$ending = "PM";
}else{
$ending = "AM";
}

print($file);
print("$my_t[weekday], $my_t[month] $my_t[mday], $my_t[year]   $hour:$my_t[minutes] $ending");
 $to = "php.tester@mailinator.com";
 $subject = "Ge Has Updated";
 $body = "$my_t[weekday], $my_t[month] $my_t[mday], $my_t[year]     \n$hour:$my_t[minutes] $ending";
 if (mail($to, $subject, $body)) {
   echo("<p>Message successfully sent to ".$to." !</p>");
  } else {
   echo("<p>Message delivery failed...</p>");
  }

copy("http://services.runescape.com/m=itemdb_rs/api/graph/440.json","../json/440.json");
copy("http://services.runescape.com/m=itemdb_rs/api/graph/434.json","../json/434.json");
copy("http://services.runescape.com/m=itemdb_rs/api/graph/10294.json","../json/10294.json");
copy("http://services.runescape.com/m=itemdb_rs/api/graph/2621.json","../json/2621.json");

 } 
?>
</body>
</html> 
```

但是当我只是去掉`<?php.... ?>`标签中的内容时......但我也复制了 php 标签。并保存为一个独立的 php 脚本，我使用 Cron 每五分钟运行一次。不起作用。有什么帮助吗？

附言。我尝试手动编辑我的本地 .json 文件，以确保它不起作用。

编辑：我复制了所有内容的开头`<?php`和结尾`?>`。包括标签。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T21:20:26.417

脚本是否可执行。我也可能会将脚本本身的相对路径更改为绝对路径。

[https://askubuntu.com/questions/23009/reasons-why-crontab-does-not-work](https://askubuntu.com/questions/23009/reasons-why-crontab-does-not-work)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T20:37:01.913

`<?php....?>`没有标签，PHP 脚本将无法运行。

# jquery - CSS 动画比例

> ID：12502420
> 
> 赞同：0
> 
> 时间：2012-09-19T20:31:13.867
> 
> 标签：jquery, css

我正在尝试从 0.5 - 1 设置动画比例。当第一次添加 div 时，我添加 css 以将其缩放到 0.5，然后我在元素 css 上将其缩放回 1。

```
 $('.item').each(function(count){
        $(this).css({top: 0, left:20, transform : "scale(.5)"});
    }); 
```

CSS

```
.item {
  -webkit-transition: top 0.4s ease-out 0s, left 0.4s ease-out 0s, right 0.4s ease-out 0s;
     -moz-transition: top 0.5s ease-in-out 0s, left 0.5s ease-in-out 0s, right 0.5s ease-in-out 0s;
       -o-transition: top 0.4s ease-out 0s, left 0.4s ease-out 0s, right 0.4s ease-out 0s;
      -ms-transition: top 0.4s ease-out 0s, left 0.4s ease-out 0s, right 0.4s ease-out 0s;
          transition: top 0.4s ease-out 0s, left 0.4s ease-out 0s, right 0.4s ease-out 0s;

  transform: scale(1) ease-in-out 0s;   
  -moz-transform: scale(1) ease-in-out 0s;
} 
```

为什么这行不通。它保持在 0.5 并且不动画到 1

这种风格也没有动画。

```
-moz-transform: scale(.4) 2s ease-in-out 4s; 
```

我正在使用 Firefox 不应该那样工作。还是我把它写成不正确的速记

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T20:35:06.827

首先，我认为通过 jquery css 函数设置转换不会应用特定于浏览器的样式（-webkit、-moz-、-o、-ms），这意味着它们可能无法在当今的大多数浏览器上运行.

其次，通过`style`元素上的属性使用 JS 设置样式称为 an`inline style`并覆盖任何 css 类/选择器。我认为这不会造成问题。

你需要的是 2 节课。一个已经有 0.5 的比例，然后在加载时使用 JS 应用第二个类。另一种方法是使用 CSS 关键帧。[http://www.w3schools.com/cssref/css3_pr_keyframes.asp](http://www.w3schools.com/cssref/css3_pr_keyframes.asp)

# java - 如何以编程方式从 iPhone 和 Android 等移动设备控制遥控车或遥控飞机

> ID：12502424
> 
> 赞同：-1
> 
> 时间：2012-09-19T20:31:30.087
> 
> 标签：java, android, iphone, ios, xcode

我正在考虑在 Android 和 iPhone 上制作一个移动应用程序，它可以作为遥控车或遥控飞机的遥控器。所以我需要帮助。我没有任何关于如何开始的事情。请帮我做这个应用程序。如果有关于此主题的任何文章或教程，请建议我。（任何建议Commonware）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T20:35:42.860

您需要深入了解：[http](http://www.arduino.cc/) ://www.arduino.cc/ ，这是一个微控制器的开源平台。它将让您构建一个可以访问 LAN 的小板。然后您将构建一个 android / ios 应用程序，该应用程序将发送`sockets`到您`IP`的`Port`微控制器。我的朋友做到了：）

# php - PHP注册表格，数据输入数据库

> ID：12502425
> 
> 赞同：0
> 
> 时间：2012-09-19T20:31:34.823
> 
> 标签：php, admin

我的网站有一个管理员部分，并且希望具有允许管理员注册然后能够登录的功能。现在我正在处理注册表单。当我提交我的用户名和密码时，网络浏览器只显示一个空白屏幕，并且没有任何内容添加到我的数据库中。这是我的代码。任何想法为什么会发生这种情况，但不起作用？

```
<?
$con = mysql_connect("localhost", "root", "");
if(!$con)
    {
    die('Could not connect: ' .mysql_error());
    }
mysql_select_db("bics_place", $con);

$myusername=$_POST['myusername']; 
$mypassword=$_POST['mypassword']; 
$encrypted_mypassword=md5($mypassword);

$sql = "INSERT INTO admin
            (username, password)
            VALUES
            ('myusername','encrypted_mypassword')";

if(!mysql_query($sql, $con))
    {
    die('Error: ' .mysql_Error());
    }
echo "1 record added";

mysql_close($con);

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T20:51:14.950

我在本地测试了您的代码，它可以正常工作。有几件事要检查。

您的服务器可能未配置为允许短标签。尝试将`'<?'`第 1 行更改为`'<?php'`.

如果您必须使用短标签（您正在使用使用它们的其他人的代码），您需要编辑您的 php.ini 文件以允许它。出于兼容性原因，我倾向于避免使用它们。

```
short_open_tag=On 
```

如果这不能解决您的问题，请添加`error_reporting(E_ALL);`到文件的开头，它应该会向您显示错误。一旦您的代码正常工作，就将其删除。

此外，您将需要编辑 $sql 变量。将 $ 放在变量名的前面。

```
$sql = "INSERT INTO admin
        (username, password)
        VALUES
        ('$myusername','$encrypted_mypassword')"; 
```

否则，您的服务器错误日志会告诉您什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T20:35:17.787

不知道为什么您看不到任何错误，但您的 SQL 不正确。

你有：

```
$sql = "INSERT INTO admin (username, password) VALUES ('myusername','encrypted_mypassword')"; 
```

应该是：

```
$sql = "INSERT INTO admin (username, password) VALUES ('$myusername','$encrypted_mypassword')"; 
```

你错过了`$`变量前面的。

# android - 在 webview 中从另一个域加载图像

> ID：12502429
> 
> 赞同：2
> 
> 时间：2012-09-19T20:31:41.907
> 
> 标签：android, webview, android-image

在 webview 中加载页面时，我无法引用另一台服务器上的图像 - 如果 webview 加载的页面是 example.com，那么

img src="http://anotherexample.com/image.jpg" 不会加载。

有解决办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-03-01T17:57:46.643

太棒了，但对我来说，通过添加 shouldOverrideUrlLoading 解决了问题：

```
 webview.setWebViewClient(new WebViewClient() {
        @Override
        public boolean shouldOverrideUrlLoading(WebView view, String url)
        {
            view.loadUrl(url);
            return true;
        }
} 
```

# php - PHP：空值

> ID：12502436
> 
> 赞同：0
> 
> 时间：2012-09-19T20:32:13.950
> 
> 标签：php, smarty

我有一个像这样生成的下拉菜单：

```
 <select multiple="multiple" name="application_occupation" id="application_occupation" value="{$fields.Occupation}" class="application_occupation">
              <option selected="selected" value="">All categories</option>
                 {foreach from=$mainArray key=topkey item=topitem}
                 {foreach from=$topitem key=key item=item}
                 <option value="{$item.categoryid}">{$item.name}</option>
            {/foreach}
            {/foreach}<!-- Master -->
      </select> 
```

这会生成一个下拉菜单：

在我的 php 代码中，我有`$fields['Occupation'] = CMS::getFormData('Occupation', false);`

这是为什么返回空白？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T20:33:52.210

尝试使用此代码

```
$fields['Occupation'] = CMS::getFormData('application_occupation[]', false); 
```

如果你想使用多选 - 名称必须是这个 application_occupation[]

# r - GitHub 中的 Markdown 公式显示

> ID：12502440
> 
> 赞同：12
> 
> 时间：2012-09-19T20:32:25.020
> 
> 标签：r, github, markdown, knitr, rstudio

当我在 RStudio 中编写 R markdown 文件时`Knit HTML`，我的公式（使用 $..$ 内联或使用 $$..$$ 显示）可以正确显示。但是，当我将 .md 文件推送到 GitHub 时，这些公式无法显示。它们只显示 $..$ 和 $$..$$。有没有办法让 GitHub 知道如何解析乳胶公式？谢谢！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-19T21:16:06.443

> 有没有办法让 GitHub 知道如何解析乳胶公式？

一些网站为用户提供了一项无需涉及任何 javascript 即可满足您的需求的服务：从 url 编码的乳胶公式中即时生成图像。

*   **[codecogs.com](https://www.codecogs.com/latex/about.php)**
*   **[iTex2Img](http://www.sciweavers.org/free-online-latex-equation-editor)**。

给定以下降价语法

```
![equation](https://latex.codecogs.com/gif.latex?1%2Bsin%28mc%5E2%29%0D%0A) 
```

它将显示以下图像

![方程](../Images/e911ba44a3aceb63b30bb08fb21c9d75.png)

**注意**：为了正确显示图像，您必须确保 url 的查询字符串部分是**[百分比编码](http://en.wikipedia.org/wiki/Percent-encoding)**的。您可以轻松找到在线工具来帮助您完成该任务，例如**[www.url-encode-decode.com](http://www.url-encode-decode.com/urlencode)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-04-29T15:07:35.000

我也在寻找如何在 GitHub 页面上渲染数学，经过长时间的研究，我找到了一个不错的解决方案。

我使用 KateX 来渲染公式服务器端：它确实比 MathJaX 快。

请注意，同样的解决方案也可以安排在客户端工作，但是，我更喜欢服务器端渲染，因为

1.  你知道你的服务器环境，但你不知道你的访问者的客户端环境
2.  它也是更快的客户端，如果公式在服务器上呈现，只呈现一次。

我写了一篇文章展示了这些步骤，希望它可以帮助数学的传播：见[GitHub Pages 上的数学](http://g14n.info/2014/09/math-on-github-pages/)。

# android - 时间事件监听器

> ID：12502441
> 
> 赞同：3
> 
> 时间：2012-09-19T20:32:29.810
> 
> 标签：android, events, time

**我的问题：**我如何让我的应用程序在特定时间做某事？特别是在技术上没有运行的情况下（可能）。最佳实践？事件监听器？ETC...

**扩展：**我对 Android 开发很陌生。我想构建一个调度应用程序，它可以在预定时间控制手机的某些功能。因此，假设我在应用程序中安排在 3:00 从响铃更改为振动，现在是 2:00。那么，如何在 3:00 运行该更改时捕获系统时间？

我不确定是否有更多信息有用。在我真正开始开发它之前，我只是想立即设计它，所以我正在寻找最佳实践以及如何在应用程序在后台运行或根本不运行时运行事件侦听器（如果这是可能的）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-19T20:41:54.573

您可以像这样使用`pendingIntent`a `BroadCastReceiver`：

```
Calendar cal = Calendar.getInstance();
Intent activate = new Intent(context, Alarm.class);
AlarmManager alarms ;
PendingIntent alarmIntent = PendingIntent.getBroadcast(context, 0, activate, 0);
alarms = (AlarmManager) context.getSystemService(Context.ALARM_SERVICE);
cal.set(Calendar.HOUR_OF_DAY, hour);
cal.set(Calendar.MINUTE, minute);
cal.set(Calendar.SECOND, 00);
alarms.set(AlarmManager.RTC_WAKEUP, cal.getTimeInMillis(), alarmIntent); 
```

然后是广播接收器：

```
public class Alarm extends BroadcastReceiver {

    @Override
    public void onReceive(Context context, Intent intent) {
      MediaPlayer mp = MediaPlayer.create(context, R.raw.ferry_sound);
      mp.start();
      PowerManager pm = (PowerManager)     context.getSystemService(Context.POWER_SERVICE);
      PowerManager.WakeLock wl = pm.newWakeLock(PowerManager.FULL_WAKE_LOCK, "My Tag");
      wl.acquire();
      Vibrator vibrator = (Vibrator) context.getSystemService(Context.VIBRATOR_SERVICE);
      long[] s = { 0, 100, 10, 500, 10, 100, 0, 500, 10, 100, 10, 500 };
      vibrator.vibrate(s, -1);
   }
} 
```

不要忘记将这些权限包含在您的`AndroidManifest.xml`:

```
....
<uses-permission android:name="android.permission.WAKE_LOCK"/>
<uses-permission android:name="android.permission.VIBRATE"/>
.... 
```

和应用程序标签中的广播接收器：

```
<receiver  android:process=":remote" android:name="Alarm" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-05T21:39:30.947

不要忘记权限：

```
 ....
    <uses-permission android:name="android.permission.WAKE_LOCK"/>
    <uses-permission android:name="android.permission.VIBRATE"/>
    ....
    AND broadcast receiver in application tag:        
    <receiver android:process=":remote" android:name="Alarm" />
  .... 
```

谢谢

# ruby-on-rails - 我如何将这个erb转换为haml？

> ID：12502445
> 
> 赞同：0
> 
> 时间：2012-09-19T20:32:34.387
> 
> 标签：ruby-on-rails, haml, erb

我如何将其转换为haml？

```
<div class="alert alert-<%= name == :notice ? "success" : "error" %>"> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T20:34:31.747

```
%div{:class => "alert alert-#{name == :notice ? 'success' : 'error' }"} 
```

或者，更干净：

```
- alert_type = name == :notice ? 'success' : 'error'
%div{ :class => "alert alert-#{alert_type}" } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-19T20:34:47.810

像这样的东西？

```
.alert{ class: "alert-#{name == :notice ? 'success' : 'error' }" } 
```

或者这看起来更整洁：

```
%div{ class: "alert alert-#{name == :notice ? 'success' : 'error' }" } 
```

# ide - ATtiny45，Arduino 编程错误？

> ID：12502446
> 
> 赞同：0
> 
> 时间：2012-09-19T20:32:37.363
> 
> 标签：ide, arduino, microcontroller

我按照教程*[How-To: Shrinkify Your Arduino Projects](http://www.youtube.com/watch?v=30rPt802n1k)*显示的方式设置了我的 Arduino 和[ATtiny45](http://www.atmel.com/devices/attiny45.aspx)。我希望制作一个连接到我的面包板的 LED 闪烁。

我正在运行 Windows XP，并且我拥有最新版本的 Arduino IDE，并将我的程序员设置为 Arduino 作为 ISP，并将我的板设置为 ATtiny45（8 MHz 内部时钟）。

当我尝试将编译后的代码上传到板上时会出现问题。IDE 返回此错误：

> avrdude：stk500_getsync（）：不同步：resp=0x00

我已经搜索了很长时间的答案，但我一无所获。我如何解决它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T06:55:37.603

这意味着未检测到您的微控制器。检查事项：

1.  接线：用于芯片编程的引脚是否正确连接（没有交叉？）
2.  电源：电路板是否正确供电？
3.  PC 配置：Arduino IDE 是否使用了正确的 PC 端口？

并从[Arduino 帮助](http://www.ladyada.net/learn/arduino/help.html)：

1.  如果您有[Arduino NG](http://en.wikipedia.org/wiki/List_of_Arduino_compatibles#Arduino_NG)，您是否在选择 Upload 菜单项之前按了 reset？
2.  是否选择了正确的串口？
3.  是否安装了正确的驱动程序？
4.  芯片是否正确插入 Arduino？
5.  如果您构建了自己的 Arduino 或自己烧录了引导加载程序：芯片上是否有正确的引导加载程序？

Arduino 是基于引导加载程序的。这意味着芯片内部必须有一个小软件，负责与 Arduino IDE 的通信以及将应用程序二进制文件自编程到芯片中。该软件称为“引导加载程序”。如果您的芯片空了（单独出售或错误擦除），则内部没有引导加载程序。

如果不使用外部编程器，就无法将 booloader 编程到芯片中。（或者内部已经有另一个引导加载程序。一些芯片在 ROM 中包含一个低级引导加载程序......）但是，幸运的是，为 AtTiny 构建一个自制的编程器很容易。在谷歌搜索“AtTyny ISP 程序员”。

如果您对此有任何疑问，请在“电气工程 StackExchange”中提问

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-10T03:08:28.797

就我而言，我购买的 Duemilenove Arduino 兼容板也有同样的问题

我找到了这个修复。

转到\hardware\arduino\boards.txt，找到这一行“uno.name=Arduino Uno uno.upload.protocol=arduino”，将protocol=arduino替换为=stk500。我不知道它是否适用于 Uno，但它确实使我免于与 Duemilanove 类似的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-25T22:29:07.773

When you get a virgin ATTiny, you need to set the fuse bits on it. **It does not require the Arduino bootloader**, but the process is similar to burning the bootloader. [This tutorial](http://hlt.media.mit.edu/?p=1695) helped me get my ATTiny85 up and running, take note of the "Configuring the ATtiny to run at 8 MHz (for SoftwareSerial support)" section.

Also, I've noticed there are different 'board drivers': the items that appear in 'Tools > Board' in the Arduino IDE. You may be using a set that does not work, try [this](https://github.com/damellis/attiny/tree/Arduino1), [this](http://hlt.media.mit.edu/wp-content/uploads/2011/06/attiny45_85.zip) or have a google around to find more. Just be sure to go through the entire process when you try a new set (i.e. burn the bootloader, reboot, burn your code).

Good luck.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-03-30T15:29:03.927

我在让 attiny85 工作时遇到了同样的问题。就我而言，arduino micro 用于对其进行编程。我深入研究了这个问题，发现最新版本的 arduino IDE(1.8.5) 在使用 avrdude 的配置上略有错误。我假设您已经尝试过刻录引导加载程序，但它因 STK500 同步错误而失败。

怎么修：

1.  准备一个能够正确编辑 unix 行结束文件的文本编辑器程序。例如）Vim、Emacs、Microsoft Visual Studio、notepad+、atom
2.  转到 arduino 安装目录。例如）C:\Program Files(x86)\Arduino
3.  使用您准备的编辑器打开 hardware\arduino\avr\programmers.txt。如果它在程序文件目录下，以管理员身份运行文本编辑器会很有用。
4.  在第 44 行，您可以找到`Arduino as ISP`. 继续遵循这些行并编辑这两行，如下所示。 `arduinoasisp.protocol=arduino arduinoasisp.program.protocol=arduino`
5.  保存并再次尝试刻录引导加载程序。

它必须具有`stk500v1`默认值。它基本上应该是相同的，但最新版本的 avrdude（默认情况下也包含在 arduino ide 中）有不同的工作流程。

另一个有用的信息：在 attiny 上刻录引导加载程序也可以熔断。

# sql-server - SQL Server 心跳监控

> ID：12502448
> 
> 赞同：-2
> 
> 时间：2012-09-19T20:32:42.377
> 
> 标签：sql-server

我希望编写以下场景的脚本。

我有 100 个 SQL Server 的列表（命名实例也很少）。我的目标是

1.  从 table/textpad 读取每个服务器。

2.  尝试使用提供的用户名和密码建立连接。（这是一个高权限的 Windows 帐户，对所有服务器都通用。）

    注意： SQLCMD 、T-SQL 或 POWERSHELL 可以。

3.  检查服务器是否在线。如果是，

    *) 跳过它并转到列表中的下一个服务器或实例。

4.  如果不，

    *) 需要发送一封服务器/实例已关闭的邮件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T20:56:34.360

请注意，对于第 2 步，如果您使用集成安全性（即 Windows 帐户）进行连接，则在尝试连接到 SQL Server 之前，您的线程需要在该帐户下运行。您无法在连接级别指定 Windows 帐户。

# android - 在 android 应用程序中分离 string.xml

> ID：12502449
> 
> 赞同：2
> 
> 时间：2012-09-19T20:32:43.023
> 
> 标签：android, android-resources

有没有办法在android应用程序中分离string.xml。就我而言，我有 5 个大模块（我将创建），例如 usersModule、gisModule、settingsModule、rolesModule 和 operationsModule。每个模块都有很多活动。这意味着 string.xml 将包含所有这些模块的字符串值。所以我想创建以下层次结构：

```
-res
|---->values
|     |---->usersModule-en 
|     |      |---->string.xml
|     |---->usersModule-tr 
|     |      |---->string.xml
|     |---->rolesModule-en 
|     |      |---->string.xml
|     |---->rolesModule-tr 
|           |---->string.xml
|---->style.xml 
```

这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T20:41:25.640

以我的评论为基础：

这是翻译吗`-en`，`-tr`？，使用`values-e`n，否则我认为你可以在值中有多个xml文件，我认为Android没有在文件名上设置一个大点，我认为Android读取所有XML文件并将其加入一个大XML 文件？你可以试试这个？

```
-res
|---->values
|     |---->style.xml
|---->values-en
|     |---->usersModule.xml
|     |---->rolesModule.xml
|---->values-tr
|     |---->usersModule.xml
|     |---->rolesModule.xml 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T22:37:19.953

您可以将其分成多个文件，但您可以专门将一个文件附加到一个模块；因此，您不能使用相同的名称来指代不同模块的不同值。

您可能需要做的是将其分成多个文件，但为每个变量添加一个指示所需模块的前缀。

# java - 您如何为 jgit 设置 jschconfigsessionfactory 的配置以便拉取和推送工作？

> ID：12502452
> 
> 赞同：9
> 
> 时间：2012-09-19T20:32:51.380
> 
> 标签：java, jsch, jgit

我正在尝试使用 jgit 的 api 和以下代码进行 git pull/push

```
org.eclipse.jgit.api.Git.open(theRepoFile).pull().call() 
```

但我遇到了例外

```
JSchException Auth fail
com.jcraft.jsch.Session.connect (Session.java:461)
org.eclipse.jgit.transport.JschConfigSessionFactory.getSession (JschConfigSessionFactory.java:116)
org.eclipse.jgit.transport.SshTransport.getSession (SshTransport.java:121)
org.eclipse.jgit.transport.TransportGitSsh$SshPushConnection.<init> (TransportGitSsh.java:306)
org.eclipse.jgit.transport.TransportGitSsh.openPush (TransportGitSsh.java:152)
org.eclipse.jgit.transport.PushProcess.execute (PushProcess.java:130)
org.eclipse.jgit.transport.Transport.push (Transport.java:1127)
org.eclipse.jgit.api.PushCommand.call (PushCommand.java:153) 
```

即使使用 cgit pull 和 push 也可以。

我尝试检查示例代码

[使用 jgit 的 Java git 客户端](https://stackoverflow.com/questions/7951307/java-git-client-using-jgit)

但是上面的问题没有提供完整的编码示例，说明使用通常通过 ssh 密钥进行身份验证的远程 repo 执行 git pull 所需的内容。应该有一种方法可以从`~/.ssh/`或 windows 等效项获取凭据信息。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-08T09:39:19.523

Jsch 将自动检测您的 SSH 密钥，但如果这些密钥受密码保护，则会失败。您需要通过 CredentialsProvider 指定密码，如下所示：

```
JschConfigSessionFactory sessionFactory = new JschConfigSessionFactory() {
@Override
protected void configure(OpenSshConfig.Host hc, Session session) {
    CredentialsProvider provider = new CredentialsProvider() {
        @Override
        public boolean isInteractive() {
            return false;
        }

        @Override
        public boolean supports(CredentialItem... items) {
            return true;
        }

        @Override
        public boolean get(URIish uri, CredentialItem... items) throws UnsupportedCredentialItem {
            for (CredentialItem item : items) {
                ((CredentialItem.StringType) item).setValue("yourpassphrase");
            }
            return true;
        }
    };
    UserInfo userInfo = new CredentialsProviderUserInfo(session, provider);
    session.setUserInfo(userInfo);
}
};
SshSessionFactory.setInstance(sessionFactory); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-21T19:59:56.297

问题是 Jsch 不支持`ssh-agent`s 开箱即用。需要配置[https://github.com/ymnk/jsch-agent-proxy](https://github.com/ymnk/jsch-agent-proxy)才能使其工作。

另一种方法是自己制作`org.eclipse.jgit.transport.CredentialsProvider`并将其设置`org.eclipse.jgit.transport.CredentialItem`为正确的值（通过向用户请求它们或查找文件）。您可以更改默认`CredentialsProvider`值`org.eclipse.jgit.transport.CredentialsProvider/setDefault`

有关详细信息，请参阅我的 clojure 库 dj：[https ://github.com/bmillare/dj/blob/library/src/dj/git.clj](https://github.com/bmillare/dj/blob/library/src/dj/git.clj)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-19T21:19:49.920

我隐约记得 JSch 出错了，因为日志不是很明确，所以我被阻止了一段时间。我不能确定这是同一个问题，但我按照这个页面解决了我的问题：

[https://help.github.com/articles/generating-ssh-keys](https://help.github.com/articles/generating-ssh-keys)

（这是由于网络配置错误）

# binding - ObjectController 上的绑定 - Ember.js

> ID：12502465
> 
> 赞同：13
> 
> 时间：2012-09-19T20:33:44.083
> 
> 标签：binding, ember.js

当您尝试向 an 添加绑定时，`ObjectController`它不起作用。

```
App.FailController = Em.ObjectController.extend({
    content: null,
    myBinding: "App.router.myController" // <-- fails
}); 
```

### 错误：

```
Uncaught Error: assertion failed: Cannot delegate set('my', ) to the 'content' property of object proxy <.FailController:ember154>: its 'content' is undefined. 
```

它尝试将其添加到`content`属性中。

jsFiddle：[演示](http://jsfiddle.net/3PTpt/1/)

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-09-19T20:33:44.083

**致谢：**感谢[caligo-mentis](https://github.com/caligo-mentis)，他在 github 上[回答了这个问题。](https://github.com/emberjs/ember.js/issues/1390#issuecomment-8703178)

`ObjectProxy`委托对该属性的任何调用，`set`除非实例`content`上存在同名的属性。`ObjectProxy`简单的解决方案是在声明绑定之前定义一个具有所需名称的属性。

```
App.FailController = Em.ObjectController.extend({
    my: null,
    myBinding: "App.router.myController" // <-- works
}); 
```

jsFiddle：[演示](http://jsfiddle.net/3PTpt/3/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-16T14:00:57.237

替代解决方案：

```
App.FailController = Em.ObjectController.extend({
    content: Ember.Object.create(),
    my: function() {
      return App.router.myController;
    }.property('App.router.myController')
}); 
```

或更好：

```
App.FailController = Em.ObjectController.extend({
    content: Ember.Object.create(),
    my: Ember.computed.alias('App.router.myController')
}); 
```

# c# - ARGOX 移动电脑 SDK

> ID：12502470
> 
> 赞同：0
> 
> 时间：2012-09-19T20:33:51.357
> 
> 标签：c#, windows, sdk, windows-mobile, compact-framework

我搜索适用于 .NET C# 的 Argox 移动 SDK。我从[http://www.argox.com/content2011.php?sno=0000033&P_ID=53](http://www.argox.com/content2011.php?sno=0000033&P_ID=53)下载了 SDK， 但它不起作用，因为我认为它适用于 c++... ;/

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T04:09:41.067

我刚刚检查了那里的网站和互联网，应该有一些随 SDK 一起安装的 .NET 示例：[http ://webcache.googleusercontent.com/search?q=cache:zPo5BIItBLEJ:www.argox.com/file.php% 3FA_ID%3D213+&cd=3&hl=en&ct=clnk](http://webcache.googleusercontent.com/search?q=cache:zPo5BIItBLEJ:www.argox.com/file.php%3FA_ID%3D213+&cd=3&hl=en&ct=clnk)

我没有完成下载和安装 SDK。如果它真的只支持这里写的 C/C++ [http://webcache.googleusercontent.com/search?q=cache:VTResc3njWYJ:www.koncept-l.pl/assets/Wsparcie/Pliki-do-pobrania/Terminale_kolektory_danych_komputery/ Terminale-reczne/Argox_PT-60_Programming_manual_v1.2-.pdf+&cd=10&hl=en&ct=clnk](http://webcache.googleusercontent.com/search?q=cache:VTResc3njWYJ:www.koncept-l.pl/assets/Wsparcie/Pliki-do-pobrania/Terminale_kolektory_danych_komputery/Terminale-reczne/Argox_PT-60_Programming_manual_v1.2-.pdf+&cd=10&hl=en&ct=clnk)您必须在本机 API 上使用 P/Invoke 构建自己的 .NET 库。

AFAIS 扫描仪 API 使用消息通知侦听器扫描数据已准备就绪： BOOL API_Register(hwnd) 可以通过 P/Invoke 从 .NET 使用，并将表单句柄用作 hwnd 参数。您还必须实现 MessageWindow 并侦听 SM_Data_Ready（请参阅 PT-60 SDK 包含头文件以获取 const 值）。然后您的代码可以调用 API_GetBarData（另一个 p/invoke 来定义）来读取实际的条形码数据。

如果您在为 PT-60 实现 .NET 库时需要帮助，请在 P/Invoke 上进行更多搜索。还有一些自动生成器 [http://blogs.msdn.com/b/bclteam/archive/2008/06/23/p-invoke-interop-assistant-justin-van-patten.aspx](http://blogs.msdn.com/b/bclteam/archive/2008/06/23/p-invoke-interop-assistant-justin-van-patten.aspx)

（https://www.google.com/search?q=generate+p%2Finvoke+lib）

# java - 对超参数使用 null

> ID：12502475
> 
> 赞同：0
> 
> 时间：2012-09-19T20:34:05.970
> 
> 标签：java

如果抽象超类有一个只定义初始字段参数的构造函数，并且其中一个子类在其初始化中不使用其中一个字段参数，我可以简单地在 super() 中未使用的字段参数所在的位置放置一个“null”吗？称呼？

为了更清楚地说明这一点，这里有一个例子：

```
public abstract class SuperClass {
    protected int xPos;
    protected int yPos;
    protected int zPos; 

    public SuperClass(int xPos, int yPos, int zPos) {
        this.xPos = xPos;
        this.yPos = yPos;
        this.zPos = zPos;
    }
    ... getters & setters, etc.
}

public class SubClass extends SuperClass {
    public SubClass(int xPos, int yPos) {
        super(xPos, yPos, null);
    }
} 
```

这可以接受吗？这是良好的编码习惯吗？还是让多个构造函数接受不同类型的参数更好？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-19T20:34:56.513

您不能分配`null`给 int 类型。

我建议有几个构造函数。通过这种方式，您可以控制类中的“未初始化”参数，这将简化维护和可读性

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-19T21:03:56.187

因为这是一个原语 ( `int`)，所以您不能将其设置为`null`。

此外，不得不做这样的事情是一种普遍的糟糕设计“气味”。如果子类不需要超类的某些功能，那么这里的层次结构很可能会颠倒过来。子类实际上应该是其父类的一切，甚至更多。

至少在您列出的示例中，子类似乎真的应该是超类，反之亦然。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-19T20:35:08.080

如果是原始类型，则设置为`ZERO`. 你不能设置为`null`

# android - WebView 上的 Android 4.0.4 软键盘导致白页

> ID：12502476
> 
> 赞同：3
> 
> 时间：2012-09-19T20:34:09.440
> 
> 标签：android, webview, keypress

如果我在运行 Android 4.0.4 的 web 视图中加载一个大的 html 文件，然后按下该 web 视图中的输入，它可以正常工作。但是，当我单击键盘上的按钮（“a”或什至使用语音输入）时，整个屏幕变白，用户只能看到最初选择的输入。

这在 4.0.3 和 4.1 中运行良好。它只发生在比屏幕长的网页视图中（即需要滚动）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-05-09T01:29:38.890

在变量尝试之后，我想出了这个。
原因是你在 input.onblur 完成它的工作之前做你的事情。
所以解决方案之一就是用 setTimeout() 包装你的东西

这是一个例子

```
var ipt = document.createElement('input');
ipt.type = "text";
document.body.appendChild(ipt);

ipt.onkeyup = function(e){
    e=e||window.event;
    var key = e.keyCode || e.which,
        ipt = e.target || e.srcElement;
    if(key==13){
        ipt.blur();
        setTimeout(function(){

           //DO YOUR STUFF HERE !!!

        }, 100);
    }
} 
```

# javascript - 使用 jquery 和 ajax 创建用于上传文件的进度条

> ID：12502482
> 
> 赞同：3
> 
> 时间：2012-09-19T20:34:49.643
> 
> 标签：javascript, jquery, ajax, uploading

我想为使用 jquery 和 ajax 上传文件创建一个进度条。所以我写了下面的jquery代码。

```
function updateProgress(evt)
{
    // evt is an ProgressEvent.
    if (evt.lengthComputable)
    {
        var percentLoaded = Math.round((evt.loaded / evt.total) * 100);
        // Increase the progress bar length.
        $(".progress > div").css(
        {
            width: percentLoaded + '%'
        });

    }
}

$.ajax(
{
    url: 'assets/php/upload.php?action=uploadFiles',
    type: 'POST',
    data: newFormData,
    cache: false,
    xhr: function ()
    {
        myXhr = $.ajaxSettings.xhr();
        if (myXhr.upload)
        {
            myXhr.upload.addEventListener('progress', updateProgress, false);
        }
        return myXhr;
    },
    contentType: false,
    processData: false,
}); 
```

但问题是上传文件尚未完成时，进度条将在一秒钟内达到 100%。我的代码有什么问题？

谢谢，

阿里雷萨

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-21T15:01:24.553

也许这与您的风格有关...不知道，因为我看不到您的所有代码。尝试以下。它可以工作，但对于小文件是难以察觉的。您可以使用断点或上传一个非常大的文件来查看它。来源：[http ://www.html5rocks.com/en/tutorials/file/dndfiles/](http://www.html5rocks.com/en/tutorials/file/dndfiles/)

```
<style>
  #progress_bar {
    margin: 10px 0;
    padding: 3px;
    border: 1px solid #000;
    font-size: 14px;
    clear: both;
    opacity: 1.0;
    -moz-transition: opacity 1s linear;
    -o-transition: opacity 1s linear;
    -webkit-transition: opacity 1s linear;
  }
  #progress_bar.loading {
    opacity: 1.0;
  }
  #progress_bar .percent {
    background-color: #99ccff;
    height: auto;
    width: 0;
  }
</style>

<input type="file" id="files" name="file" />
<button onclick="abortRead();">Cancel read</button>
<div id="progress_bar"><div class="percent">0%</div></div>

<script>
  var reader;
  var progress = document.querySelector('.percent');

  function abortRead() {
    reader.abort();
  }

  function errorHandler(evt) {
    switch(evt.target.error.code) {
      case evt.target.error.NOT_FOUND_ERR:
        alert('File Not Found!');
        break;
      case evt.target.error.NOT_READABLE_ERR:
        alert('File is not readable');
        break;
      case evt.target.error.ABORT_ERR:
        break; // noop
      default:
        alert('An error occurred reading this file.');
    };
  }

  function updateProgress(evt) {
    // evt is an ProgressEvent.
    if (evt.lengthComputable) {
      var percentLoaded = Math.round((evt.loaded / evt.total) * 100);
      // Increase the progress bar length.
      if (percentLoaded < 100) {
        progress.style.width = percentLoaded + '%';
        progress.textContent = percentLoaded + '%';
      }
    }
  }

  function handleFileSelect(evt) {
    // Reset progress indicator on new file selection.
    progress.style.width = '0%';
    progress.textContent = '0%';

    reader = new FileReader();
    reader.onerror = errorHandler;
    reader.onprogress = updateProgress;
    reader.onabort = function(e) {
      alert('File read cancelled');
    };
    reader.onloadstart = function(e) {
      document.getElementById('progress_bar').className = 'loading';
    };
    reader.onload = function(e) {
      // Ensure that the progress bar displays 100% at the end.
      progress.style.width = '100%';
      progress.textContent = '100%';
      setTimeout("document.getElementById('progress_bar').className='';", 2000);
    }

    // Read in the image file as a binary string.
    reader.readAsBinaryString(evt.target.files[0]);
  }

  document.getElementById('files').addEventListener('change', handleFileSelect, false);
</script> 
```

# mysql - 事务中的“无法添加或更新子行：外键约束失败”

> ID：12502483
> 
> 赞同：0
> 
> 时间：2012-09-19T20:34:51.320
> 
> 标签：mysql, database

我得到了三个表，一个父级（称为**配置文件**）和两个可以考虑一个子级的表（**值**和**url**）。这只是一个测试，所以不要介意缺少 SQL 注入安全性。

```
CREATE TABLE `profiles` (
 `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
 `profile` int(10) unsigned NOT NULL,
 `url_hash` varchar(32) NOT NULL,
 PRIMARY KEY (`id`,`profile`,`url_hash`),
 UNIQUE KEY `id` (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=22 DEFAULT CHARSET=latin1

CREATE TABLE `urls` (
 `id` int(10) unsigned NOT NULL,
 `url` text NOT NULL,
 `title` text,
 PRIMARY KEY (`id`),
 CONSTRAINT `urls_ibfk_1` FOREIGN KEY (`id`) REFERENCES `profiles` (`id`) 
ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=latin1

CREATE TABLE `values` (
 `id` int(10) unsigned NOT NULL,
 `seller` text NOT NULL,
 `seller_language` text,
 `quality` tinyint(3) unsigned NOT NULL,
 `note` text,
 `price` int(10) unsigned NOT NULL,
 `count` tinyint(3) unsigned NOT NULL,
 PRIMARY KEY (`id`),
 CONSTRAINT `values_mtg_ibfk_1` FOREIGN KEY (`id`) REFERENCES `profiles` (`id`) 
ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=latin1 
```

我正在执行以下三个查询作为事务（省略了 autocommit(false)、commit() 和 rollback()）：

```
$db->query('INSERT INTO profiles(id, profile, url_hash) 
VALUES (null, ' . $profile . ', "' . md5($url) . '")')
or throwException(...);

$db->query('INSERT INTO urls(id, url, title) 
VALUES (' . mysqli_insert_id($db) . ', "' . $url . '", "' . $c->data('title') . '")')
 or throwException(...);

$db->query('INSERT INTO values(id, seller, seller_language, quality, 
note, price, count) 
VALUES (' . mysqli_insert_id($db) . ', "'. $seller .'", "'. $seller_lang .'", 
'. $qual .', "'. $notice .'", '. $price .', '. $ount .')') 
or throwException(..); 
```

导致

```
exception 'Exception' with message 'Query failed (table: values): 
(1452) Cannot add or update a child row: a foreign key constraint fails
(`crawler`.`values`, CONSTRAINT `values_ibfk_1` FOREIGN KEY (`id`) REFERENCES
`profiles` (`id`) ON DELETE CASCADE ON UPDATE CASCADE)' 
```

我只是不明白为什么。它说明缺少父表中的相应**id**。如果是这种情况，为什么第二个查询会起作用，因为它的表**url与表****配置文件**（如表**值**）具有完全相同的外键关系？

**编辑**：我的数据库设计中有一个巨大的缺陷，关于 FK 的**值**不能是唯一的。明天再考虑。:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T12:02:28.513

该错误是由于我有缺陷的数据库设计（我从未想过）造成的。在我的脚本尝试插入具有相同 id 的多个值时，**值中的 id 是唯一的。**

# c# - 支持新 CSS3 功能的自定义 Web 浏览器控件

> ID：12502485
> 
> 赞同：2
> 
> 时间：2012-09-19T20:35:04.027
> 
> 标签：c#, .net, browser, wrapper

我正在寻找 .net 框架的自定义 Web 浏览器控件。

[这里](https://stackoverflow.com/questions/2141668/use-chrome-as-browser-in-c)有很多，但它们很旧，不能顺利运行新的 CSS3 功能（或者它们根本不能！）。例如，[Awesomium](http://awesomium.com/)和[Webkit.NET](http://sourceforge.net/projects/webkitdotnet/)可用，但它们无法运行硬件加速的动画/过渡。

但是，新的网络浏览器（Chrome 21、Firefox 15）正在流畅地支持这些新功能并且硬件加速。

是否有任何支持新 HTML5/CSS3 功能的 .Net Web 浏览器控件？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-19T20:38:30.737

您始终可以[使用 .NET 中的铬](http://code.google.com/p/chromiumembedded/)。Chromium 支持最新功能。Chromium Embedded Framework ( [CEF](http://code.google.com/p/chromiumembedded/) ) 是一个开源项目，用于开发基于 Google Chromium 项目的 Web 浏览器控件。已经有一个 .NET 版本（ [CEF1](https://github.com/chillitom/CefSharp)），您可以实现它，虽然不容易但绝对可行，请参阅为特定文档提供的链接。

此外，还有一个[用于 .Net 的 CEF3 包装器，您可以](https://bitbucket.org/xilium/xilium.cefglue/wiki/Home)[在官方论坛下](http://www.magpcss.org/ceforum/viewforum.php?f=14)下载二进制文件。

*CEF3 支持 3D，而 CEF1 不支持。*

***更新：***[您可以从此处](http://xilium.bitbucket.org/cefglue/)下载 CEF3 包装器的最新二进制文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-13T12:36:29.527

如果您真的不需要 CEF1/3，为什么不尝试[GeckoFX](https://bitbucket.org/geckofx)控制？它非常温和，支持 css3、带有音频/视频标签的 html5、webgl，并且该项目似乎正在积极开发中。

# java - 嵌套异常是 java.lang.IllegalArgumentException: ::0 处的错误找不到引用的切入点

> ID：12502498
> 
> 赞同：2
> 
> 时间：2012-09-19T20:35:48.787
> 
> 标签：java, spring-aop

我是 AOP 的新手。阅读《春天在行动》一书。有AOP的章节和例子。我已经用 XML 做到了，一切都很好。有Aspects的注释配置示例。我已经像书里那样做了一个，但它不起作用。请帮忙。

**错误：**

```
 Exception in thread "main" org.springframework.beans.factory.BeanCreationException: 
    Error creating bean with name 'guitar' defined in class path resource [springIdolBeansAnnotation.xml]: 
    Initialization of bean failed; nested exception is java.lang.IllegalArgumentException: error at ::0 c
    an't find referenced pointcut performance 
```

带有名为 springIdolBeansAnnotation.xml 的 bean 的文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:aop="http://www.springframework.org/schema/aop"
xsi:schemaLocation="http://www.springframework.org/schema/beans
http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
http://www.springframework.org/schema/aop
http://www.springframework.org/schema/aop/spring-aop-3.0.xsd">

    <bean id="guitar" class="com.springinaction.springidol.Guitar"/>
    <aop:aspectj-autoproxy/>
    <bean id="kenny2" class="com.springinaction.springidol.Instrumentalist">
        <property name="song" value="Jingle B"/>
        <property name="instrument" ref="guitar"/>
    </bean>
    <bean id="audience" class="com.springinaction.springidol.Audience"/>
</beans> 
```

**档案吉他：**

```
package com.springinaction.springidol;

public class Guitar implements Instrument {

    @Override
    public void play() {
        System.out.println("Guitar playing");
    }

} 
```

**文件乐器演奏家：**

```
package com.springinaction.springidol;

public class Instrumentalist implements Performer {

    private String song;

    private Instrument instrument;

    public Instrumentalist(){}

    @Override
    public void perform() throws Exception {
        System.out.println("Playing "+song + " : ");
        instrument.play();
    }

    public String getSong() {
        return song;
    }

    public void setSong(String song) {
        this.song = song;
    }

    public String screamSong(){
        return song;
    }

    public void setInstrument(Instrument instrument) {
        this.instrument = instrument;
    }

} 
```

文件受众（方面）：

```
package com.springinaction.springidol;

import org.aspectj.lang.ProceedingJoinPoint;
import org.aspectj.lang.annotation.AfterReturning;
import org.aspectj.lang.annotation.AfterThrowing;
import org.aspectj.lang.annotation.Around;
import org.aspectj.lang.annotation.Aspect;
import org.aspectj.lang.annotation.Before;
import org.aspectj.lang.annotation.Pointcut;

@Aspect
public class Audience {
    @Pointcut("execution(* com.springinaction.springidol.Performer.perform(..))")
    public void performance(){}

    @Before("performance()")
    public void takeSeats(){
        System.out.println("The audience is takig their seats");
    }

    @Before("performance()")
    public void turnOffCellPhones(){
        System.out.println("The audience is turning off their cellphones");
    }

    @AfterReturning("performance()")
    public void applaud(){
        System.out.println("CLAP CLAP CLAP CLAP CLAP");
    }

    @AfterThrowing("performance()")
    public void demandRefund(){
        System.out.println("Boo! We want our money back");
    }

    @Around("performance()")
    public void watchPerformance(ProceedingJoinPoint joinpoint){
        try {
            System.out.println("Theaudienceistakingtheirseats.");
            System.out.println("Theaudienceisturningofftheircellphones");
            long start=System.currentTimeMillis();
            joinpoint.proceed();
            long end=System.currentTimeMillis();
            System.out.println("CLAP CLAP CLAP CLAP CLAP");
            System.out.println("Theperformancetook"+(end-start)
            + "milliseconds.");
        } catch(Throwable t){
            System.out.println("Boo!Wewantourmoneyback!");
        }
    }
} 
```

**主文件：**

```
package com.springinaction.springidol;

import org.springframework.context.ApplicationContext;
import org.springframework.context.support.ClassPathXmlApplicationContext;

public class SpringIdolMain {

    public static void main(String[] args) {
        ApplicationContext ctx = new ClassPathXmlApplicationContext("springIdolBeansAnnotation.xml");
        Performer performer = (Performer) ctx.getBean("kenny2");
        try {
            performer.perform();
        } catch (Exception e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T19:34:18.310

是的，这可能是因为旧罐子。正如我假设您使用 spring 3.x jars 和 confiduration 。尝试使用最新的 jar

几天前我遇到了类似的问题，**org.springframework.beans.factory.BeanCreationException: Error creating bean**

就我而言，这是旧罐子的[问题 我的问题](https://stackoverflow.com/questions/13895963/aspectj-based-aop-with-spring-3-1)

您可以尝试使用最新的 jar 运行您的应用程序吗：

```
aopalliance-1.0.jar
asm-3.3.1.jar
aspectj-1.7.1.jar
aspectjrt-1.7.0.jar
aspectjweaver-1.7.0.jar
cglib-2.2.2.jar 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-16T06:40:13.367

添加 1.7 jar 的依赖项为我解决了这个问题。

```
 <dependency>
        <groupId>org.aspectj</groupId>
        <artifactId>aspectjrt</artifactId>
        <version>1.7.0</version>
    </dependency>
    <dependency>
        <groupId>org.aspectj</groupId>
        <artifactId>aspectjweaver</artifactId>
        <version>1.7.0</version>
    </dependency> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-20T11:28:31.930

参考：[Spring AOP](http://veerasundar.com/blog/2010/01/spring-aop-example-profiling-method-execution-time-tutorial/)，检查你的`@Pointcut`配置。

# sql - SQL Server - 如何删除递归行

> ID：12502502
> 
> 赞同：4
> 
> 时间：2012-09-19T20:35:59.267
> 
> 标签：sql, sql-server-2008

![在此处输入图像描述](../Images/9be2991f56b8de13fa0cb30dc6304178.png)

我有一个`department`表，我想从表中选择并删除所有参考行以`departmentid`获取`departmentidparent`部门 ID，假设`departmentid=13`。

这意味着

```
Departmentid         departmentidparent
13                     13
14                     13
15                     13
16                     14
17                     14 
```

在此应从表中删除所有行。我很困惑，不知道如何解决它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-19T20:46:06.337

带样品表

```
create table tbl (departmentid int, departmentidparent int)
insert tbl select 13,13
insert tbl select 14,13
insert tbl select 15,13
insert tbl select 16,14
insert tbl select 17,11
insert tbl select 115,17 
```

这是将执行您需要的查询

```
;with cte as
(
select *
 from tbl
 where departmentid=13
 union all
 select tbl.*
 from tbl
 join cte on tbl.departmentidparent=cte.departmentid
 -- the next line is only required because the sample data has parent=self!
 where tbl.departmentid!=cte.departmentid
)
delete tbl
from cte
where tbl.departmentid = cte.departmentid 
```

# ajax - 使用 IIS Express 托管静态网站

> ID：12502503
> 
> 赞同：3
> 
> 时间：2012-09-19T20:36:05.000
> 
> 标签：ajax, webserver, iis-express

是否可以在没有 web.config 的情况下仅在 IISExpress 上托管静态文件？

我有一个 html5 应用程序原型（没有服务器端代码），我想在 IISExpress Webserver 上托管网站，因为有一些 json 文件模拟了我使用 AJAX 访问的 REST-API。

有一个 main.html 文件和一些 api/data.json 文件。

当我创建一个 VS 项目时，一切正常。

我删除了所有配置和 VS 相关文件，并手动添加了站点

```
appcmd add site /name:"HTMLStandalone" /bindings:http/*:56668 /physicalPath:"C:\Users\me\somefoler\myapp" 
```

更新：工作正常，它会在 applicationhost.config 中产生以下条目

```
<site name="HTMLStandalone" id="4">
                <application path="/">
                    <virtualDirectory path="/" physicalPath="C:\Users\me\somefolder\myapp" />
                </application>
                <bindings>
                    <binding protocol="http" bindingInformation="*:56668" />
                </bindings>
            </site> 
```

当我启动网站时

```
 iisexpress.exe /site:HTMLStandalone 
```

该过程失败：

```
Failed to translate binding to url prefix *:56668
Registration completed for site "HTMLStandalone"
Failed to process sites
Report ListenerChannel stopped due to failure; ProtocolId:http, ListenerChannelI
d:0
HostableWebCore activation failed. 
```

是否可以只托管没有 web.config 的静态文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T15:36:43.553

web.config 文件不是强制性的。看来您的 appcmd.exe 命令有点不对劲...改为运行以下命令

appcmd 添加站点 /name:"HTMLStandalone" /bindings: **http/*:56668:** /physicalPath:"C:\Users\me\somefoler\myapp"

请注意，要运行此站点，您必须以管理员身份运行。如果要以非管理员身份运行，请运行以下命令

appcmd 添加站点 /name:"HTMLStandalone" /bindings: **http/*:56668:localhost** /physicalPath:"C:\Users\me\somefoler\myapp"

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-18T11:02:12.920

来自 iis.net 网站

> 您还可以使用 /path 选项直接从文件夹运行站点。此选项适用于任何类型的应用程序，包括静态 HTML、ASP.NET、PHP 和 WCF。默认情况下，IIS Express 将在`http://localhost:8080/`. 对于托管网站，例如 ASP.NET，IIS Express 将使用 .NET 4.0。您可以使用 /port 和 /clr 选项来覆盖这些默认值。

就我而言，这还不够。/path 和 /config 标志不可组合。我想要一个自定义的 applicationhost.config 文件（为了添加 json 和 text/cache-manifest 的 mime-extensions）

当前的解决方案是添加绑定：http/*:56668: **localhost**

或者，要使站点在（本地）网络上可用，您可以使用 pc/服务器的 dns 名称，例如 bindings:http://*:56668: **my-pc**

# java - JSLint 命令行导致“文件名或扩展名太长”java 错误

> ID：12502504
> 
> 赞同：2
> 
> 时间：2012-09-19T20:36:09.877
> 
> 标签：java, processbuilder, createprocess

我的任务是尝试让 JSLint 工作输出到 XML 文件，但我遇到了一些障碍。我遇到了返回“CreateProcess error=206，文件名或扩展名太长”的错误。

我的意图是尝试抓取文件夹中的所有内容，而不必将其拆分为单独的文件路径，尽管我认为这可能是我必须做的。

我的基本蚂蚁目标如下：

```
<target name="d">
  <fileset dir="../" id="src.files">
    <include name="**/*.js"/>
  </fileset>
  <pathconvert pathsep=" " refid="src.files" property="spacedelim"/>
<exec executable="java" output="jslint.xml">
  <arg line="-jar jslint4java-2.0.2.jar --report xml ${spacedelim}" />
</exec>
</target> 
```

spacedelim 返回包含 js 文件的文件夹内所有以 js 结尾的文件的空格分隔列表。如果我粘贴 ${spacedelim} 包含的文件列表，那么即使在调用 ant 目标时它也可以正常工作......所以我真的不知道该怎么做。

这是完整的错误：

```
BUILD FAILED
D:\dev\features\2011.2\webui\wmd\webclient\jslint4java-2.0.2\build.xml:53: Execu
te failed: java.io.IOException: Cannot run program "java": CreateProcess error=206, The filename or extension is too long
    at java.lang.ProcessBuilder.start(ProcessBuilder.java:460)
    at java.lang.Runtime.exec(Runtime.java:593)
    at org.apache.tools.ant.taskdefs.Execute$Java13CommandLauncher.exec(Exec
ute.java:862)
    at org.apache.tools.ant.taskdefs.Execute.launch(Execute.java:481)
    at org.apache.tools.ant.taskdefs.Execute.execute(Execute.java:495)
    at org.apache.tools.ant.taskdefs.ExecTask.runExecute(ExecTask.java:631)
    at org.apache.tools.ant.taskdefs.ExecTask.runExec(ExecTask.java:672)
    at org.apache.tools.ant.taskdefs.ExecTask.execute(ExecTask.java:498)
    at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAcces
sorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.jav
a:106)
    at org.apache.tools.ant.Task.perform(Task.java:348)
    at org.apache.tools.ant.Target.execute(Target.java:390)
    at org.apache.tools.ant.Target.performTasks(Target.java:411)
    at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1399)
    at org.apache.tools.ant.Project.executeTarget(Project.java:1368)
    at     org.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExecutor.java:41)
    at org.apache.tools.ant.Project.executeTargets(Project.java:1251)
    at org.apache.tools.ant.Main.runBuild(Main.java:809)
    at org.apache.tools.ant.Main.startAnt(Main.java:217)
    at org.apache.tools.ant.launch.Launcher.run(Launcher.java:280)
    at org.apache.tools.ant.launch.Launcher.main(Launcher.java:109)
Caused by: java.io.IOException: CreateProcess error=206, The filename or extension is too long
    at java.lang.ProcessImpl.create(Native Method)
    at java.lang.ProcessImpl.<init>(ProcessImpl.java:81)
    at java.lang.ProcessImpl.start(ProcessImpl.java:30)
    at java.lang.ProcessBuilder.start(ProcessBuilder.java:453)
    ... 24 more

Total time: 4 seconds 
```

感谢任何人提供的任何见解！

# android - 更改文本视图？当我尝试时它会抛出错误

> ID：12502506
> 
> 赞同：0
> 
> 时间：2012-09-19T20:36:11.517
> 
> 标签：android, android-layout

```
int resID = getResources().getIdentifier(getResources().getString(R.string.hello_world), "id", "com.example.test.projects");
       TextView text = (TextView)findViewById(resID);
       text.setText("cpu: " ); 
```

我似乎无法更改 hello_world 消息...每次都会抛出错误

最初它的前瞻性要严格得多，但是：/我在我的 R 文件中注意到，我的 hello world 字符串似乎没有像许多更改文本视图的示例中那样的 ID，所以我把它放在一起

这是我进行布局的地方：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent" >

<TextView
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_centerHorizontal="true"
    android:layout_centerVertical="true"
    android:text="@string/hello_world"
    tools:context=".MainActivity" /> 
```

和我的主要 xml：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.example.test.projects"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="7"
    android:targetSdkVersion="16" />
<uses-feature android:name="android.hardware.bluetooth"/>
<uses-permission android:name="android.permission.WRITE_SETTINGS"/>
<uses-permission android:name="android.permission.WRITE_SECURE_SETTINGS"/>
<uses-permission android:name="android.permission.BLUETOOTH"/>
<uses-permission android:name="android.permission.BLUETOOTH_ADMIN"/>

<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" 
    >
    <activity
        android:name=".MainActivity"
        android:label="@string/title_activity_main" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
</application> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T20:47:29.810

我建议一种不同的方法，在您的 TextView 中添加一个 id：

```
<TextView
    android:id="@+id/helloTextView"
    ... /> 
```

您可以使用以下方法更改其文本：

```
TextView text = (TextView) findViewById(R.id.helloTextView);
text.setText("cpu: " ); 
```

（此外，如果您的应用程序崩溃，您应该始终发布您的 LogCat，以便我们可以确切地看到正在发生的事情。）

# javascript - Google maps API 3，关闭多边形（与“Google maps polygons”相同）

> ID：12502510
> 
> 赞同：1
> 
> 时间：2012-09-19T20:36:28.240
> 
> 标签：javascript, api, google-maps, google-maps-api-3, polygons

这个问题已经问过了（见问题“谷歌地图多边形”）。但我有完全相同的问题，只是想鼓励某人接受它......

简而言之，如何将多个多边形添加到地图中而不会出现一条线来连接每个多边形？简而言之，如何在绘制另一个多边形之前“关闭”一个多边形？

我的页面在下面。如您所见，如果您在浏览器中查看，则在两种状态之间出现一条线（如果您添加更多形状，它们也似乎与一条线相连）是否有一些简单的解决方案，或者您是否需要复杂的JS代码来检测交叉点或者其他的东西？

```
<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <style type="text/css">
        html { height: 100% }
        body { height: 100%; margin: 0; padding: 0 }
    </style>

    <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js? key=MY_VALID_KEY_HERE&sensor=false"></script>

    <!--<script type="text/javascript" src="AAAA_State_Coordinates.js"></script>-->

    <script type="text/javascript">
        function initialize() {
            var myLatLng = new google.maps.LatLng(46, -100);
            var mapOptions = {
                zoom: 5,
                center: myLatLng,
                mapTypeId: google.maps.MapTypeId.TERRAIN
            };

            var map = new google.maps.Map(document.getElementById("map_canvas"),mapOptions);

            var shape_ND = [
                new google.maps.LatLng(45.9445, -104.0446),
                new google.maps.LatLng(45.934, -96.5671),
                new google.maps.LatLng(46.3242, -96.6028),
                new google.maps.LatLng(46.6636, -96.7978),
                new google.maps.LatLng(46.8602, -96.7896),
                new google.maps.LatLng(46.9503, -96.7896),
                new google.maps.LatLng(47.13, -96.8335),
                new google.maps.LatLng(47.2345, -96.8335),
                new google.maps.LatLng(47.4132, -96.8555),
                new google.maps.LatLng(47.5469, -96.8555),
                new google.maps.LatLng(47.6506, -96.8774),
                new google.maps.LatLng(47.9918, -97.0601),
                new google.maps.LatLng(48.1267, -97.126),
                new google.maps.LatLng(48.2859, -97.1109),
                new google.maps.LatLng(48.4301, -97.1233),
                new google.maps.LatLng(48.553, -97.1425),
                new google.maps.LatLng(48.6765, -97.0999),
                new google.maps.LatLng(48.7326, -97.1356),
                new google.maps.LatLng(48.7951, -97.1727),
                new google.maps.LatLng(48.9081, -97.229),
                new google.maps.LatLng(48.9982, -97.2331),
                new google.maps.LatLng(48.9946, -104.0501)
            ];

            var shape_WY = [
                new google.maps.LatLng(48.9946, -104.0501),
                new google.maps.LatLng(44.9949, -104.0584),
                new google.maps.LatLng(44.9998, -111.0539),
                new google.maps.LatLng(40.9986, -111.0457),
                new google.maps.LatLng(41.0006, -104.0556)
            ];

            ND = new google.maps.Polygon({paths: shape_ND,strokeColor: '#FF0000',strokeOpacity: 0.8,strokeWeight: 2,fillColor: '#FF0000',fillOpacity: 0.35});
            ND.setMap(map);

            WY = new google.maps.Polygon({paths: shape_WY,strokeColor: '#FF0000',strokeOpacity: 0.8,strokeWeight: 2,fillColor: '#FF0000',fillOpacity: 0.35});
            WY.setMap(map);
        }
    </script>
</head>
<body onload="initialize()">
    <div id="map_canvas" style="width:70%; height:70%"></div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T20:53:54.170

您已经复制了 WY 中 ND 的最后一个坐标，因此该点是两个形状的一部分。对 WY 使用以下内容：

```
var shape_WY = [
new google.maps.LatLng(44.9949, -104.0584),
new google.maps.LatLng(44.9998, -111.0539),
new google.maps.LatLng(40.9986, -111.0457),
new google.maps.LatLng(41.0006, -104.0556)
]; 
```

# wpf - 如果单列数据表没有主键，如何检查它是否包含某个字符串？

> ID：12502512
> 
> 赞同：2
> 
> 时间：2012-09-19T20:36:33.487
> 
> 标签：wpf, vb.net, linq, datatable, contains

如果不循环和检查每个值，这可能吗？有没有像在列表中使用包含这样简单的东西？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-19T20:41:53.707

你可以使用`Linq-To-DataSet`and [`Enumerable.Any`](http://msdn.microsoft.com/en-us/library/bb534972.aspx)：

```
Dim containsValue = table.AsEnumerable()
                         .Any(Function(r) r.Field(Of String)("Column") = "Foo") 
```

或在查询语法中：

```
Dim containsValue = (From r In table
                     Where r.Field(Of String)("Column") = "Foo").Any() 
```

您需要添加`Imports System.Linq`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-19T20:39:59.973

您可以使用[DataTable.Select](http://msdn.microsoft.com/en-us/library/det4aw50.aspx)方法并指定一个过滤器。

# javascript - 在 Ext 4 中扩展具有私有范围的单例？

> ID：12502519
> 
> 赞同：0
> 
> 时间：2012-09-19T20:37:05.143
> 
> 标签：javascript, singleton, extjs4.1, private-members

在 ExtJS 3 到 4 的迁移过程中，我遇到了一个问题，我想知道是否有人解决了问题：即，如何扩展具有私有范围的单例？

在 Ext3 中，我会使用 Extend：

```
Ext.namespace("My.New.Obj");

My.New.Obj = (function() {
    var privateVar = 3;
    function privateFunc() { alert(privateVar); }

    var extendedObj = Ext.extend(My.Other.Obj, {
        newFunc: function() { alert(this.publicVar+privateVar); },
        publicVar: 4
    });

    return new extendedObj();
})(); 
```

据我所知，我会使用 Ext.define 创建一个单例模式，但我不知道如何扩展内部对象。

```
Ext.define('My.New.Obj', function() {
  var privateVar = 3;
  function privateFunc() { alert(privateVar); }

  var extendedObj = Ext.create('My.Old.Obj',{
    newFunc: function() { alert(this.publicVar+privateVar); },
    publicVar: 4
  });

  return extendedObj;
}); 
```

上面例子的唯一问题是我相信在 Ext.extend 中保留的超级方法被覆盖了。

如何在保持私有范围的同时扩展单例？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T23:16:30.073

```
Ext.define('A', {
    someMethod: function(){
        return 'a';
    }
});

Ext.define('B', (function(){
    var fn = function(){
        return 'b';
    };

    return {
        extend: 'A',

        someMethod: function(){
            return this.callParent() + fn();
        }
    }
})());

console.log(new A().someMethod());
console.log(new B().someMethod()); 
```

# android - GLSurfaceView.Renderer - 无法解析为类型

> ID：12502520
> 
> 赞同：1
> 
> 时间：2012-09-19T20:37:08.460
> 
> 标签：android, interface, opengl-es-2.0, glsurfaceview

我有一个问题，我正在尝试实现 GLSurfaceView.Renderer 接口，但我无法让它工作。我正在导入 android.opengl.GLSurfaceView 但它仍然无法解析为一种类型。

我在下面包括了我班级的代码。

```
package se.mima.opengl20test;

import android.opengl.GLSurfaceView;

public class MyGL20Renderer implements GLSurfaceview.Renderer{

} 
```

我只是不明白，这不应该工作吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T20:39:33.700

GLSurface **View.Renderer**，不是 GLSurface**视图**。

# ruby-on-rails - Rails：form_for 不转参数

> ID：12502521
> 
> 赞同：0
> 
> 时间：2012-09-19T20:37:23.873
> 
> 标签：ruby-on-rails, forms, post

我基本上是在尝试创建一个 Rails **form_for**，但它根本不转参数。我检查了服务器日志，它接收到参数，但无法在 create 函数上捕获。我正在观看**andrewperk**关于**创建**和**保存**方法的教程 (http://www.youtube.com/watch?v=unq1yubL6lQ)。我可能做错了什么？这是我的用户控制器；

```
 def new
    @user=User.new
  end
  def create
    @user=User.new(params[:user])
    if @user.blank?
      render :new
    else
      @user.save
      render :index
    end
  end 
```

这是我的表格；

```
<h1>Add an available user</h1>

    <%= form_for @user do |a| %>
        <p>
            <%= a.label :name %>
            <%= a.text_field :name %>
        </p>
        <p>
            <%= a.label :surname %>
            <%= a.text_field :surname %>
        </p>
        <p>
            <%= a.submit "Add new available user"%>
        </p>
    <% end %> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T20:40:39.317

您应该`params[:user]`在控制器中使用，因为这是默认情况下 HTML 表单字段的命名方式（您可以检查页面源代码）。

另外我建议稍微重构一下`create`方法。这是一种约定，您重定向到索引页面，而不是在创建记录后才呈现它。

```
def create
  @user = User.new(params[:user])
  if @user.save
    redirect_to users_path
  else
    render :new
  end
end 
```

# ios - 如何防止 UITableViewCell 中的缩进 contentView 而不是 textLabel

> ID：12502522
> 
> 赞同：0
> 
> 时间：2012-09-19T20:37:27.363
> 
> 标签：ios, uitableview, uikit

我发现了如何在编辑模式下防止 contentView[缩进](https://stackoverflow.com/questions/5789467/prevent-indentation-of-uitableviewcell-contentview-while-editing)。我的问题是：

如何防止 contentView 而不是 textLabel 的缩进？我已经尝试在 observeValueForKeyPath 中更改 textLabel 的框架，但运气不好，textLabel 的框架始终相同。

我的目标是，当进入编辑模式时，在 textLabel 上有漂亮的小缩进动画，但在 contentView 上没有

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T14:17:09.313

感谢A-Live指出解决方案。为了解决我的问题，我不得不使用基于这个[链接](https://stackoverflow.com/a/4718228/792677)和这个[链接](https://stackoverflow.com/questions/5789467/prevent-indentation-of-uitableviewcell-contentview-while-editing)的解决方案。首先，我必须创建一个 UITableViewCell 的子类，在其中我重新实现了 setEditing 并添加了 observeValueForKeyPath 函数。

第一步，observeValueForKeyPath禁止contentView的缩进，其次setEditing负责textLabel的动画

这是我的代码：

```
 #import "UI_CategoryTableViewCell.h"

@implementation UI_CategoryTableViewCell

- (id)initWithStyle:(UITableViewCellStyle)style reuseIdentifier:(NSString *)reuseIdentifier
{
  self = [super initWithStyle:style reuseIdentifier:reuseIdentifier];
  if (self) {
    [self.contentView addObserver:self forKeyPath:@"frame" options:NSKeyValueObservingOptionOld context:nil];
  }
  return self;
}

- (void)dealloc
{
  [self.contentView removeObserver:self forKeyPath:@"frame"];
  [super dealloc];
}
- (void)layoutSubviews
{
  [super layoutSubviews];

  [UIView beginAnimations:nil context:NULL];
  [UIView setAnimationBeginsFromCurrentState:YES];
  [UIView setAnimationDuration:0.0f];

  for (UIView *subview in self.subviews) {
    //NSLog(@"%@", NSStringFromClass([subview class]));

    if ([NSStringFromClass([subview class]) isEqualToString:@"UITableViewCellDeleteConfirmationControl"]) {
      CGRect newFrame = subview.frame;
      newFrame.origin.x = 416;
      newFrame.origin.y = -26;
      subview.frame = newFrame;
    }
    else if ([NSStringFromClass([subview class]) isEqualToString:@"UITableViewCellEditControl"]) {
      CGRect newFrame = subview.frame;
      newFrame.origin.x = 5;
      newFrame.origin.y = -31;
      subview.frame = newFrame;
    }
  }
  [UIView commitAnimations];

  if ([super showingDeleteConfirmation] || [super isEditing]) {
    self.textLabel.frame = CGRectMake(38,-30, self.textLabel.frame.size.width, self.textLabel.frame.size.height);
  }
  else{
    self.textLabel.frame = CGRectMake(10,-30,self.textLabel.frame.size.width, self.textLabel.frame.size.height);
  }
}

-(void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary *)change context:(void *)context
{
  //NSLog(@"observed value for kp %@ changed: %@",keyPath,change);
  if ( [keyPath isEqual:@"frame"] && object == self.contentView )
  {
    CGRect newFrame = self.contentView.frame;
    CGRect oldFrame = [[change objectForKey:NSKeyValueChangeOldKey] CGRectValue];
    //NSLog(@"frame old: %@  new: %@",NSStringFromCGRect(oldFrame),NSStringFromCGRect(newFrame));

    if ( newFrame.origin.x != 0 )
      self.contentView.frame = oldFrame;
  }
}

- (void)setEditing:(BOOL)editing animated:(BOOL)animate
{
  [super setEditing:editing animated:animate];

  if(editing) {
    [UIView beginAnimations:nil context:nil];
    [UIView setAnimationDuration:0.2];
    self.textLabel.frame = CGRectMake(38,-30, self.textLabel.frame.size.width, self.textLabel.frame.size.height);
    [UIView commitAnimations];
  } else {
    [UIView beginAnimations:nil context:nil];
    [UIView setAnimationDuration:0.2];
    self.textLabel.frame = CGRectMake(10,-30, self.textLabel.frame.size.width, self.textLabel.frame.size.height);
    [UIView commitAnimations];
  }
}

@end 
```

# django - 带有 Sencha Touch 和 Django 后端的移动应用程序

> ID：12502523
> 
> 赞同：2
> 
> 时间：2012-09-19T20:37:29.457
> 
> 标签：django, rest, sencha-touch

我正在启动一个具有 API 服务器和 UI 服务器的应用程序。API 服务器将使用 django rest 框架，而 UI 服务器将使用 Sencha Touch。API 服务器将接受 http 请求并发送 JSON，而 UI 服务器应接受 JSON 并发送 http 请求。我只是想知道 Sencha Touch 是否具有接受 JSON 和发送 http 请求的功能。如果没有，那么我假设我需要在 http 服务器后面运行它。请让我知道 Sencha touch 是否可以做我需要它做的事情，如果不能，我最好的选择是什么。

ps 如果您需要更多信息，请告诉我

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T19:12:55.217

是的，您可以使用 sencha touch、jquery-mobile 或 HTML、JS 和 CSS 的自定义配置（例如 bootstrap、jquery 和backbone.js）来做到这一点。您可以将 Django 用于 API 服务器和 UI 服务器。对于 API，请考虑 django-tastypie，因为您将免费获得 JSON api。UI 服务器将非常简单，因为您将在浏览器中执行大多数操作。因此，您可以选择任何实现......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-20T01:15:05.280

是的，你在正确的轨道上。请参阅以下帮助文章[http://docs.sencha.com/touch/2-0/#!/guide/stores](http://docs.sencha.com/touch/2-0/#!/guide/stores)

您基本上使用 Django 在移动平台上提供 JSON 和 sencha 以使用它。

干杯，

_M

# geolocation - 从 Geonames 数据库中定位最近的 GPS 标记

> ID：12502526
> 
> 赞同：2
> 
> 时间：2012-09-19T20:37:34.503
> 
> 标签：geolocation, gps, maps, geonames

我正在开发一个使用 geonames.org 数据库的 Android 应用程序。我只使用地名提供的城市/人口稠密的地方类别及其相应的坐标。

我希望用户能够提供他/她的 GPS 坐标并获得最近的城市/人口稠密地点及其坐标的结果。

即使用户在一个城市，我也希望该城市的坐标与更远的坐标一起显示。

这可以在没有谷歌或网络服务的帮助下完成吗？我可能会在自己的服务器上托管世界城市的地理位置。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T06:06:45.530

自发布此消息以来，我找到了自己问题的答案。MongoDB 支持地理空间索引。确保经度和纬度字段保存在一个字符串中，并将地理空间索引指向您的 loc: 字段。然后，您可以使用边界框执行查询，以查找某个半径内最近的位置。可以在此处找到有关 MongoDB 地理空间索引的更多信息：[http ://www.mongodb.org/display/DOCS/Geospatial+Indexing](http://www.mongodb.org/display/DOCS/Geospatial+Indexing)

# java - 正则表达式不起作用

> ID：12502530
> 
> 赞同：0
> 
> 时间：2012-09-19T20:38:04.363
> 
> 标签：java, regex

也许有人可以用正则表达式帮助我。这个不行：

```
public static void main(String[] args){
    String pattern = "(?i).*a[\\s-\\.]?nton.*";
    String text = "a-nton vom 27.2.2012";
    if (pattern.matches(text)){
        System.out.println("FOUND");
    }else{
        System.out.println("NOT FOUND");
    }
} 
```

如果文本包含以下单词之一，则正则表达式应该为真：

> a-nton OR a nton OR anton

这个词之前和之后可以是任何文本

但上面的模式将是“未找到”

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-19T20:39:47.287

更改`if (pattern.matches(text)) {`为`if (text.matches(pattern)) {`。

匹配方法检查调用的字符串中的模式传递给方法，因此在文本上调用它并将其传递给模式。如果您将来想要更高级的正则表达式，您可能还想查看`Pattern`and类。`Matcher`

请参阅[match(String)](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#matches%28java.lang.String%29)方法的 javadoc：

> 参数： regex - 此字符串要匹配的正则表达式

# javascript - 如何通过单击相同的链接从两个不同的 div（来自 html）加载两个 div

> ID：12502531
> 
> 赞同：1
> 
> 时间：2012-09-19T20:38:10.597
> 
> 标签：javascript, jquery, html, css

我想单击`a#lanostracasa`以从外部获取两个不同的 div，`.html`然后将其加载到另外两个 div（`#fotoCasa`来自外部文件`havePicture`）（[http://frostcode.altervista.org](http://frostcode.altervista.org)和[http://frostcode.altervista.org/db。 html](http://frostcode.altervista.org/db.html)用于外部 HTML。）

我快疯了，因为我在看到容器加载时看到了容器中的文本，并且所有文本都消失了，并且没有加载任何内容。

```
<div id="contAll">
   <div id="fotoCasaHtml"></div>
   <div id="container">
    <p>
    <div id="imgHome"><img class="img"src="images/noimg.png"></div>
          blablablablablablabla
    </p>
   </div>
</div> 
```

我要点击的链接：

```
<div id="cssmenu">
<li><a id="lanostracasa"href='#'><span>La Nostra Casa</span></a>
</div> 
```

和不起作用的 JavaScript：

```
 <script type="text/javascript" language="javascript">
   $( function() {

      $( 'a#lanostracasa' ).click(function() {
         var postData = ''; // you can send any data to ajax file.
         $('#container , #fotoCasaHtml').html('<p>loading</p>');
         $.ajax( {
            url : 'db.html',
            type : 'post',
            data : postData,
            success : function( resp ) {
               $('#container').html($('#lanostracasa-ita' , resp).html());
               $('#fotoCasaHtml').html($('#fotoCasa' , resp).html());
            }
         });
            return false;
      });
   });
   </script> 
```

我也在 jQuery 中对同一个链接使用这个调用，但我认为它不会影响 JavaScript：

```
$("#cssmenu a#lanostracasa").click(function(){
$('#container').load('db.html #lanostracasa-ita')
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T00:02:14.747

所以你有两个事件绑定到同一个元素，它们本身就是矛盾的。您不能将同一个事件（单击）两次绑定到同一个元素。在这种情况下，您有一个需要解决的优先级问题。一个函数被触发，一个未被触发，选择使用哪一个。此外，如果您从逻辑角度考虑这一点……将同一事件绑定两次有什么意义？如果 ONCLICK 您想要发生两件事，只需将它们放在一个函数中即可。

此外，您必须记住，将事件绑定到元素时，元素本身必须在绑定之前存在。我看不到您的 HTML 来验证您的第二个 .click() 事件是否包含在函数闭包或 $(document).ready() 中，但这也可能是混淆的根源。

# ios - iOS KMLViewer 示例多边形标注？

> ID：12502534
> 
> 赞同：1
> 
> 时间：2012-09-19T20:38:24.170
> 
> 标签：ios, mapkit

我对 iOS 世界很陌生，因为我是一名地理学家，所以我当然想玩一些 Mapkit 功能。

我下载了 KMLViewer 示例，作为该示例的一部分，KML 文件具有点和多边形。对于点，用户可以按下其中一个点并获得带有该点属性的调用。这在功能上不是为多边形内置的。我希望能够按下其中一个多边形并打开带有其属性的调用？

有人可以帮助指导我如何做到这一点吗？非常感谢您的帮助、指导和患者。

谢谢，

保罗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T20:53:17.770

这都是关于叠加视图的。使用[MKAnnotationView](http://developer.apple.com/library/ios/#DOCUMENTATION/MapKit/Reference/MKAnnotationView_Class/Reference/Reference.html)类来设置属性并尽可能多地注释。这是一个视图，因此您可以像任何视图一样构建它并将其放在地图上。您还可以[在此处](http://developer.apple.com/library/ios/#DOCUMENTATION/MapKit/Reference/MKAnnotationView_Class/Reference/Reference.html)找到其他示例代码。[还在这里](http://developer.apple.com/library/mac/#samplecode/OverlayView/Introduction/Intro.html#//apple_ref/doc/uid/DTS40008906-Intro-DontLinkElementID_2)找到了关于 OverlayView 的好例子。

# java - Java 整数与整数

> ID：12502538
> 
> 赞同：2
> 
> 时间：2012-09-19T20:38:33.810
> 
> 标签：java, increment

> **可能重复：**
> [为什么 Java 看不到整数相等？](https://stackoverflow.com/questions/4428774/why-java-does-not-see-that-integers-are-equal)

我从同一个参数分配了 2 个整数。

我将其中一个整数减 1，然后将值加 1。

当我再次比较它们时，它们并不总是相等的。

这是我的书，有人可以解释一下，我看不懂我的书解释。

```
class Test{

    public static void main(String[] args){
        Integer i = Integer.parseInt(args[0]);
        Integer j = i;
        System.out.println("1:" + i + ", j:" + j);
        i--;
        System.out.println("2:" + i + ", j:" + j);
        i++;
        System.out.println("3:" + i + ", j:" + j);
        System.out.println((i==j));

    }
} 
```

输出：输入 256 作为参数

```
1:256, j:256
2:255, j:256
3:256, j:256
false 
```

谢谢您的考虑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T20:43:52.637

由于 ++-- （已创建新对象），您正在比较两个不同的引用。比较两个 Integer 对象的方法 equals() 方法。equals() 将检查 Integer 的内部状态。检查此代码：

```
 Integer i = 256;
    Integer j=i;
    System.out.println(i==j);         //True  (Because we are pointing the same object)
    i--;
    i++;        
    System.out.println(i==j);         //False (Because reference has changed)
    System.out.println(i.equals(j));  //True  (Because the inner state is the same) 
```

# ant - sshexec 命令 - ftp 获取参数

> ID：12502544
> 
> 赞同：0
> 
> 时间：2012-09-19T20:39:09.440
> 
> 标签：ant, ssh, ftp

在我的代码中使用类似的东西

```
 <sshexec host="somehost"
username="dude"
password="yo"
command="ftp_download"/>

<ftp action="get" server="server_todownload" userid="user" password="aaa" remotedir="dowload/dir">
        <fileset dir="${installerdirectory}"><include name="${file_name}"/></fileset>
    </ftp> 
```

在 sshexec 的“命令”中，我如何将 ftp 操作作为参数传递？是否有任何示例或文件可以获取更多知识？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T02:20:46.140

我猜你想：

*   ssh 到另一台机器，并且
*   使用 ftp 在该机器上下载一些东西。

我想你误会了什么。`<sshexec>`是一个连接到机器并在该机器上执行命令的任务。它执行的命令必须存在于该机器上。例如，您的代码：

```
<sshexec host="somehost" username="dude" password="yo" command="ftp_download"/> 
```

必须有一个名为`ftp_download`existing on的命令，`somehost`否则您`<sshexec>`将失败。您不能在本地构建文件中使用 ant 任务作为参数，因为`<sshexec>`这种方式根本不起作用。

建议：

你可以把`ftp`task放在一个ant build文件中，然后部署到远程机器上（可以使用`scp`task）`sshexec`。在`sshexec`'s 命令中，您编写`ant -f path_to_build_file ftp_target`. 你需要确保那台机器上有蚂蚁。

# moodle - 在线设置moodle

> ID：12502545
> 
> 赞同：0
> 
> 时间：2012-09-19T20:39:13.747
> 
> 标签：moodle

大家好，我一直在尝试将我的moodle放到网上，以便互联网上的电脑可以访问它，但直到现在，一点运气都没有。（我在 Windows Server 2008 和 IIS 7 上使用 moodle 2.3.2）。

我尝试配置moodle文件config.php，设置指令$CFG -> wwwroot = "my-public-ip/moodle"。然后，当我从服务器访问moodle时，我可以通过“http://my-public-ip/moodle”访问它，当我尝试通过localhost访问时，它会发送一个错误，它是好的。

但有趣的是，当我尝试从外部电脑访问服务器时。当我输入“http://my-public-ip/moodle”时，它根本无法“看到”我对 config.php 文件所做的配置（它说：这个服务器只能通过 localhost/moodle 访问）它看起来像外部电脑要么忽略它，要么搜索另一个配置文件。我不知道到底发生了什么，这很奇怪。

有任何想法吗？？天呐！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-08T11:59:07.810

我意识到这是一个老问题，但值得指出的是，您可能还需要运行数据库搜索和替换脚本，位于：

[http://my-public-ip/moodle/admin/tool/replace/index.php](http://my-public-ip/moodle/admin/tool/replace/index.php)

如方法 2 中所述[。](https://docs.moodle.org/27/en/Moodle_migration)

如果您在安装站点后**更改**站点名称，则需要这样做。如果您已经在“localhost”下使用 Moodle，那么将有许多对存储在数据库中的旧 localhost 地址的引用需要更新为新的基于 IP 的地址。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-16T16:17:05.473

更改以下文件：

> lib-->setuplib.php

```
Redirect ($CFG->wwwroot, get_string('wwwrootmismatch', 'error', $CFG->wwwroot), 3); 
```

为了

```
Redirect ($CFG->wwwroot, get_string('wwwrootmismatch', 'error', $CFG->wwwroot), 0); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-05T09:48:01.127

可能是因为缺少 http:// 部分？

```
$CFG->wwwroot = "my-public-ip/moodle" 
```

应该

```
$CFG->wwwroot = "http://my-public-ip/moodle" 
```

# c# - 在 Windows 窗体中全屏自动调整控件大小

> ID：12502547
> 
> 赞同：3
> 
> 时间：2012-09-19T20:39:25.353
> 
> 标签：c#, winforms, fullscreen, autoresize, dock

我想在全屏上自动调整我的 Windows 窗体控件的大小。我使用 tableLayoutPanel 和锚定。

但这并不令人赏心悦目。我使用了flowLayoutPanel，但它不起作用。我在一个表单上有大约 35 个控件，包括标签、文本框、comboboxex、单选按钮、datagridview 和复选框。

有没有其他方法可以调整控件的大小？如果没有，有人可以建议我一种更有效地使用 tableLayoutPanel 和锚定的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T22:03:55.050

在我看来，您想要使用的是所有控件的[Dock](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.dock.aspx "码头")属性以及使用[TableLayoutPanel](http://msdn.microsoft.com/en-us/library/system.windows.forms.tablelayoutpanel.aspx "表格布局面板")。从您提供的图像看来，您希望表单的上半部分成为 TableLayoutPanel，并将 Dock 属性设置为 DockStyles.Fill。然后将底部的 ListView 设置为 DockStyles.Bottom。

您可以将每个控件停靠在 TableLayoutPanel 单元格中，也可以将[Anchor](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.anchor.aspx "锚")属性设置为 AnchorStyles.None 以使控件在单元格中自动居中。

# objective-c - 为什么无法在目标 c 中获取文件大小？总是返回 0

> ID：12502551
> 
> 赞同：1
> 
> 时间：2012-09-19T20:39:35.200
> 
> 标签：objective-c, ios, xcode

我是objective c的新手，我尝试了很多小时来找出如何获取文件大小但我失败了，请帮助我，谢谢。

首先我使用这样的代码：

```
NSString *yourPath = @"http://www.xxx.com.au/magazine/nm.pdf";
NSFileManager *man = [[NSFileManager alloc] init];
NSDictionary *attrs = [man attributesOfItemAtPath: yourPath error: nil];
unsigned long long result = [[attrs objectForKey: NSFileSize] unsignedLongLongValue];
NSLog(@"%llu", result); 
```

输出为 0

然后我试试这个：

```
NSString *yourPath = @"http://www.xxx.com.au/magazine/nm.pdf";
unsigned long long result = [[[NSFileManager defaultManager] attributesOfItemAtPath: yourPath error:nil] fileSize];
NSLog(@"%llu", result); 
```

也得到 0。在我更改本地文件的路径后，结果相同。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T21:32:35.320

您的路径不是路径，它是带有 http 协议的 URL。

`NSFileManager`仅适用于文件系统文件（期望路径，而不是 url）。也`NSFileManager`不再推荐使用 Cocoa 中获取文件大小的方法。

现在推荐的方法是使用`NSURL`. 但它必须是一个“文件 url”（使用创建它`[NSURL fileURLWithPath:myPath]`）。如果它是“文件 url”，您可以使用`getResourceValue:forKey:error:`或`resourceValuesForKeys:error:`获取文件大小等信息。

但是，在您的情况下，您没有路径，而是 http URL。http URL 指的是资源，而不是文件（资源可能是文件，也可能不是文件）。如果它是一个文件，那么至少不开始下载它就无法知道它的大小。根据服务器的响应方式，它可能会或可能不会在下载开始时知道大小。在最坏的情况下，您只有在完全下载文件后才知道大小。

# c - 我可以检查两个 FILE* 或文件描述符编号是否引用同一个文件吗？

> ID：12502552
> 
> 赞同：11
> 
> 时间：2012-09-19T20:39:38.963
> 
> 标签：c

我有一个从文件读取并写入文件的程序。我想阻止用户为两者指定相同的文件（出于显而易见的原因）。假设第一条路径在`char* path1`，第二条路径在`char* path2`。我可以`fopen()`两条路径，`fileno()`分别调用并获得相同的号码吗？

为了更清楚地解释：

```
char* path1 = "/asdf"
char* path2 = "/asdf"

FILE* f1 = fopen(path1, "r");
FILE* f2 = fopen(path2, "w");

int fd1 = fileno(f1);
int fd2 = fileno(f2);

if(fd1 == fd2) {
  printf("These are the same file, you really shouldn't do this\n");
} 
```

### 编辑：

我不想比较文件名，因为使用类似路径`/asdf/./asdf`或使用符号链接很容易击败它。最终，我不想将我的输出写入我正在读取的文件中（可能会导致严重的问题）。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-09-19T20:54:31.933

是 - 比较文件设备 ID 和 inode。根据[`<sys/stat.h>`规范](http://pubs.opengroup.org/onlinepubs/009696699/basedefs/sys/stat.h.html)：

> st_ino 和 st_dev 字段共同唯一标识系统中的文件。

采用

```
int same_file(int fd1, int fd2) {
    struct stat stat1, stat2;
    if(fstat(fd1, &stat1) < 0) return -1;
    if(fstat(fd2, &stat2) < 0) return -1;
    return (stat1.st_dev == stat2.st_dev) && (stat1.st_ino == stat2.st_ino);
} 
```

# javascript - 用于管理（禁用和检查）某些复选框的 Javascript 函数

> ID：12502553
> 
> 赞同：1
> 
> 时间：2012-09-19T20:39:44.823
> 
> 标签：javascript, checkbox

我对这个简单的 Javascript 代码有疑问：

```
function select_checkbox(i)
{
    switch(i)
    {
        case 3: 
        if (document.upload_form.3.checked=true)
        {   
            document.upload_form.4.checked=true; 
            document.upload_form.4.disabled=true; 
            document.upload_form.5.checked=true; 
            document.upload_form.5.disabled=true;
        }

        if (document.upload_form.3.checked=false)
        {   
            document.upload_form.4.checked=false; 
            document.upload_form.4.disabled=false; 
            document.upload_form.5.checked=false; 
            document.upload_form.5.disabled=false;
        }  

        break;

        [other code] 
```

与此 HTML 代码相关联：

```
 <input type="checkbox" name="3" onclick="select_checkbox(3)" />
     <input type="checkbox" name="4" onclick="select_checkbox(4)" /> 
     <input type="checkbox" name="5" onclick="select_checkbox(5)" /> 
```

我想这样做：

*   如果我选择复选框“3”，请检查并禁用 4 和 5
*   如果我选中复选框“4”，请选中并禁用 3 + 取消选中并禁用 5
*   如果我选择复选框“5”，取消选中并禁用 3 和 4
*   取消选中时重新启用并取消选中所有

代码的第一部分（我只报告复选框“3”的一部分）效果很好，但是通过取消选中复选框来恢复配置时遇到问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T20:45:58.723

您不能通过点语法访问以数字开头的属性，请使用`[]`语法。此外，您在 if 语句中进行分配而不是比较。

```
 function select_checkbox(i)
    {
        switch(i)
        {
            case 3: 
            if (document.upload_form['3'].checked)
            {   
                document.upload_form['4'].checked=true; 
                document.upload_form['4'].disabled=true; 
                document.upload_form['5'].checked=true; 
                document.upload_form['5'].disabled=true;
            }

            if (!document.upload_form['3'].checked)
            {   
                document.upload_form['4'].checked=false; 
                document.upload_form['4'].disabled=false; 
                document.upload_form['5'].checked=false; 
                document.upload_form['5'].disabled=false;
            }  

            break;

                            [other code] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-19T20:41:01.213

```
if (document.upload_form.3.checked=true)
{ 
}

should be replaced by

if (document.upload_form.3.checked==true)
{
} 
```

那应该是==

# javascript - 右键单击图像显示DIV

> ID：12502558
> 
> 赞同：2
> 
> 时间：2012-09-19T20:40:07.187
> 
> 标签：javascript, jquery

我试图弄清楚当有人右键单击图像时如何让 DIV 显示在鼠标的位置。一个例子可以在[这里](http://www.icstone.us/)找到。

我四处搜索，发现以下代码...

```
$('img').bind('contextmenu', function(e){
return false;
}); 
```

这当然会阻止右键单击。虽然我不知道如何让 DIV 出现在鼠标点击的位置。

请问我可以指出正确的方向吗？

谢谢！​</p>

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-19T21:03:23.090

我整理了一个关于如何做到这一点的快速演示（[在这里查看）。](http://jsfiddle.net/jasonmerino/qKejd/2/)div 是绝对定位的，我们捕获`contextmenu`事件，在该事件上我们根据对象中的和键`preventDefault()`设置位置。`div``pageX``pageY``event`

JS 看起来像这样：

```
$('body').on('contextmenu', function(event) {
    event.preventDefault();
    $('div').css({
        'top': event.pageY,
        'left': event.pageX
    });
});​ 
```

CSS 看起来像这样：

```
body {
    width: 500px;
    height: 500px;
}

div {
    width: 100px;
    height: 100px;    
    background-color: #ccc;
    position: absolute;
    top: 0;
    left: 0;
}​ 
```

我已经在最新的 Firefox 和 Chrome 以及 IE7 - IE9 中测试了该演示，并且它在所有这些中都有效。希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T21:08:01.463

您可以使用传递给处理程序的事件对象的`offsetX`和属性，如下所示：`offsetY``contextmenu`

HTML：

```
<img src="http://mikecane.files.wordpress.com/2007/03/kitten.jpg" alt="click me, I'm a kitten!" id="picture" />

<div id="pictureCaption">Pretty picture of a kitten</div>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

Javascript：

```
​$('#pictureCaption').hide();

$('#picture').contextmenu( function(e) {
    e.preventDefault();
    $('#pictureCaption').offset( {top: e.offsetY, left:e.offsetX} ).show();
})​​​​​​​​​​​​​​​;​​​​ 
```

jsFiddle在这里：http: [//jsfiddle.net/HFC5g/](http://jsfiddle.net/HFC5g/)

# android - Android 多屏幕分辨率

> ID：12502566
> 
> 赞同：2
> 
> 时间：2012-09-19T20:40:45.587
> 
> 标签：android, android-layout

我创建了一个在我的 Galaxy s2 (480×800) 设备上看起来不错的 android 布局。我想支持 Galaxy s3 (720x1280) 的布局，所以我使用这些规格创建了一个 AVD，然后将 res/layout 目录和内容复制到另外两个目录：res/layout、res/layout-large 和 res/layout-超大。为了测试布局是否正常工作，将测试按钮放置在 res/layout 中的 parent-center、res/layout-large 中的 parent-left 和 res/layout-xlarge 中的 parent-right。如果我在我的设备 (480×800) 或 AVD (720x1280) 上运行应用程序，则测试按钮始终位于父中心。为什么测试按钮不是由 res/layout-large 或 res/layout-xlarge 中指定的值定位。

我的清单如下：

```
<uses-sdk android:minSdkVersion="10" android:targetSdkVersion="10" />

<supports-screens 
        android:normalScreens="true" 
        android:largeScreens="true" 
        android:xlargeScreens="true"
        android:anyDensity="true" /> 
```

我的目标是 2.3.3，并且在测试之前还清理了我的构建

我真的要疯了，所以任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T20:54:45.070

我不相信 Galaxy S3 是一个“大”屏幕。小/正常/大/xlarge 指的是物理尺寸，而不是像素。您需要结合屏幕密度和屏幕尺寸来定位不同的设备。阅读 Android[指南](http://developer.android.com/guide/practices/screens_support.html)和[培训](http://developer.android.com/training/multiscreen/index.html)以获取更多详细信息。

# php - PHP - mysql_fetch_assoc 的函数

> ID：12502568
> 
> 赞同：1
> 
> 时间：2012-09-19T20:40:58.397
> 
> 标签：php, mysql

如果我在 PHP 中执行此操作，它可以正常工作并按预期循环：

```
$rs = mysql_query($sql);
while ($row = mysql_fetch_assoc($rs)){
    writeme("UserID: " . $row["UserID"]);
} 
```

但我一直想把它抽象成一个我称之为 ExecuteQuery 的函数：

```
function ExecuteQuery($sql){
$result = mysql_query($sql);

if ($result) {
    if($result != 1){
        return mysql_fetch_assoc($result); // return recordset
    }
}else{
    $message  = 'Invalid query: ' . mysql_error() . "<br>";
    $message .= 'Whole query: ' . $sql;
    echo $message;
    die();
} 
```

}

此功能在 3 种情况中的 2 种情况下效果很好：

1- 适用于返回 1 行的查询，我可以这样访问：

$rs = ExecuteQuery($sql);

$foo = $rs["用户 ID"];

2- 适用于不返回任何记录的 sql 语句，例如 UPDATE 或 DELETE。

3-但是当我尝试取回一个返回多条记录的记录集，然后循环遍历它时，我得到一个无限循环并且我的浏览器崩溃了。像这样：

```
$rs = ExecuteQuery($sql);
while ($row = $rs){
    writeme("UserID: " . $row["UserID"]);
} 
```

如何修改我的 while 循环，使其前进到记录集中的每条新记录并在最后一条记录之后停止？我敢肯定这是一个愚蠢的小东西，但我还不是 PHP 专家。我真的很希望我的 ExecuteQuery 函数能够处理所有 3 个场景，它非常方便。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T20:43:44.750

尝试`foreach($rs as $row){`代替`while ($row = $rs){`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T20:44:09.607

不要使用while，使用foreach：

```
$rs = ExecuteQuery($sql);
foreach ($rs as $row){
    writeme("UserID: " . $row["UserID"]);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-19T20:52:56.303

mysql_fetch_assoc() 只返回一行结果。要获取下一行，您需要再次调用 mysql_fetch_assoc()。您可以做的一件事是让您的 ExecuteQuery 函数返回一个数组数组：

```
$rows = array();
while ($row = mysql_fetch_assoc($result) !== false) {
   $rows[] = $row;
}
return $rows; 
```

此外，您不应使用 mysql_* 函数，因为它们已被弃用。尝试改用 PDO 或 mysqli_*。

# javascript - Javascript For 循环

> ID：12502571
> 
> 赞同：1
> 
> 时间：2012-09-19T20:41:11.327
> 
> 标签：javascript, raphael

目前我正在使用 RaphealJS 库进行一个项目，在遇到这样的问题之前一切似乎都很好。

而不是多次这样做：

```
 dolphinIcon[1].click(function() {              
           this.attr({  
             stroke: 'black', 'stroke-width': 2,  
             fill: 'green'  
           }); 
           alert(1);
   });

   dolphinIcon[2].click(function() {              
           this.attr({  
             stroke: 'black', 'stroke-width': 2,  
             fill: 'green'  
           }); 
           alert(2);
   });

  dolphinIcon[3].click(function() {              
           this.attr({  
             stroke: 'black', 'stroke-width': 2,  
             fill: 'green'  
           }); 
           alert(3);
   }); 
```

为什么我不能这样做？

```
for(var i=0; i<dolphinIcon.length; i++){
     dolphinIcon[i].click(function() {              
        this.attr({  
           stroke: 'black', 'stroke-width': 2,  
           fill: 'green'  
        });      
        alert(i);
     });
} 
```

我只希望存储在数组中的每个图标警报（）其索引的数量，但是当我使用 for 循环时，无论我点击哪个图标，它总是警报（）相同的数字（数组的大小） . 我应该如何解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-19T20:45:25.517

这是一个经典的 JavaScript 问题。每个回调函数中的变量都是相同的，一旦循环完成`i`，它将是相同的。`dolphinIcon.length`

您需要使用闭包来“捕获”`i`变量。

```
var clickFunc = function(i){
    return function(){
        this.attr({  
           stroke: 'black', 'stroke-width': 2,  
           fill: 'green'  
        });      
        alert(i);
    }
};
for(var i=0; i<dolphinIcon.length; i++){
     dolphinIcon[i].click(clickFunc(i));
} 
```

`clickFunc`将返回一个对 . 的值“关闭”的函数`i`。

您还可以将额外数据传递给`click`处理程序，以便在调用时使用。

```
for(var i=0; i<dolphinIcon.length; i++){
     dolphinIcon[i].click({i: i}, function(e) {              
        this.attr({  
           stroke: 'black', 'stroke-width': 2,  
           fill: 'green'  
        });      
        alert(e.data.i);
     });
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-19T20:46:11.607

这是因为 javascript 闭包的工作方式 - 基本上，您的回调/事件处理函数绑定到循环变量 i 而不是 i 在循环的连续迭代中的特定值。

这是简单的解决方法：只需使用匿名函数包装循环的内部，然后将循环变量传递给该函数。这将导致闭包附加到该特定值。

例如：

```
for(var i=0; i<dolphinIcon.length; i++)
{
    (   function(i) 
        {
            dolphinIcon[i].click(function() 
            {              
                this.attr({ stroke: 'black', 'stroke-width': 2, fill: 'green'});      
                alert(i);
            } );
        } )( i );
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-19T20:46:34.433

试试这个：

```
for(var i=0; i<dolphinIcon.length; i++){ 
     dolphinIcon[i].bind('click', {index: i}, function(e) {             
        $(this).attr({   
           stroke: 'black', 'stroke-width': 2,   
           fill: 'green'   
        });       
        alert(e.data.index); 
     }); 
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-19T21:26:14.337

我想推荐 underscore.js 库。它包含许多处理数组和 onbject 的实用方法（在您的情况下为每个和绑定）[http://underscorejs.org/#each](http://underscorejs.org/#each)

在您的示例中，此代码将简化为：

```
_.each(dolphicons, function(dolphicon, index){  
    var func = function() {              
        this.attr({  
           stroke: 'black', 'stroke-width': 2,  
           fill: 'green'  
        });      
        console.log(index);
    }
    func = _.bind(func, dolphicon);

    dolphicon.click(func);
}); 
```

“this”将引用 dolphicon 因为绑定。示例也位于：http: [//jsfiddle.net/SyJdv/](http://jsfiddle.net/SyJdv/)

您还可以在每个循环之外限定函数

```
var func = function() {              
   this.obj.attr({  
      stroke: 'black', 'stroke-width': 2,  
      fill: 'green'  
    });      
    console.log(this.index);
}

_.each(dolphicons, function(dolphicon, index){  
   var clickfunc = _.bind(func, {obj: dolphicon, index: index});    
   dolphicon.click(clickfunc);
}); 
```

[http://jsfiddle.net/PW9WX/1/](http://jsfiddle.net/PW9WX/1/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-03-08T16:36:48.090

在这里，我为您提供了一个代码链接，我准备通过示例和详细信息向您解释： JavaScript for loop 三种不同的方式，单击链接阅读代码，测试自己并给个赞。

[https://code.sololearn.com/WHc3WmA7TrMP](https://code.sololearn.com/WHc3WmA7TrMP)

下面是代码：

```
<!DOCTYPE html>
<html>
   <body>

      <script type="text/javascript">
         /*
        The For Loop. Bellow are three examples using the same code in different ways, 
        returning the same results. Before let's explain which are the components fo the for loop.

        for loop have 3 components:
        1.initialization 
        2.condition
        3.Iteration 

      syntax: for (Initialization;condition;iteration)

        e.g.: for (i=1; i<=5; i++)

        In JavaScript <br> this tag is used as a line break.
        */

        //The example below creates a for loop that prints numbers 1 through 5.
        document.write("The example below creates a for loop that prints numbers 1 through 5\. <br/>");
        for (i=1; i<=5; i++) {
           document.write(i + "<br />"); // <br /> is use to line break
        }

        //Statement 1 is optional, and can be omitted, if your values are set before the loop starts.
        document.write("<br/> Statement 1 is optional, and can be omitted, if your values are set before the loop starts. <br/>");
        var i = 1;
        for (; i<=5; i++) {
           document.write(i + "<br />");
        }

        //Also, you can initiate more than one value in statement 1, using commas to separate them.
        document.write("<br/> Also, you can initiate more than one value in statement 1, using commas to separate them. <br/>");
        for (i=1, text=""; i<=5; i++) {
            text = i;
            document.write(text + "<br />");
        }

        /* 
        If you notice in the for loop in JavaScript is not mandatory to declare explicitly a variable.
        e.g.: for (i=1; i<=5; i++) {}

        this is equivalent to say:
        for (var i=1; i<=5; i++) {}

        */

        // the following code will generate an infinite loop if you do not include break;
        var i = 0;
        for (; ; ) {
            document.write(i);
            i++;
            // if you comment or delete the break, this for loop will never end
            break;
        }

      </script>

      <p>Please like this code, I hope it helps you to learn more about For Loop ...</p>
   </body>
</html> 
```

# ruby-on-rails - 有没有人用过 ubuntu desktop 12.04，并在上面安装了更新的 ruby on rails ？

> ID：12502572
> 
> 赞同：0
> 
> 时间：2012-09-19T20:41:12.123
> 
> 标签：ruby-on-rails, ruby, ubuntu

当我想要最新的时，我不断获得 ruby​​ 1.8.7 和 rails 2.3.14，但它不允许我更新。我对 linux 和 ubuntu 操作系统还是新手，所以这没有帮助吗？在线上的所有方向都像 2007、2009、2010 一样旧，因此它们不适用于当前 ruby​​ on rails 2012 次。我希望有人能指出我正确的方向。

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T21:16:49.500

Hartl 的 RailsTutorial 也有一个很棒的章节，介绍了（几乎）获得 Rails 开发所需的一切。

[http://ruby.railstutorial.org/ruby-on-rails-tutorial-book#sec-rubygems](http://ruby.railstutorial.org/ruby-on-rails-tutorial-book#sec-rubygems)

# android - 也用于拍照的预览缓冲区？

> ID：12502573
> 
> 赞同：1
> 
> 时间：2012-09-19T20:41:14.543
> 
> 标签：android, camera

我正在开发一个自定义相机应用程序，当我尝试拍摄更高分辨率的照片时，我的 jpeg 回调永远不会被调用。我运行 logcat，我看到这条消息：

E/Camera-JNI(14689)：手动设置的缓冲区太小！预期为 1473253 字节，但得到了 768000！

据我所知，我不会手动设置拍照的缓冲区大小，但我会调用 addCallbackBuffer 来捕获预览图像。

那些用于拍照和预览的缓冲区是否相同？android 开发者文档中的描述说“将预分配的缓冲区添加到预览回调缓冲区队列”。它使用了“预览”这个词，所以我认为它与 takePicture() 没有任何关系。

那么它所说的这个手动分配的缓冲区是从哪里来的呢？

# javascript - VBA .getElementbyID 并将值传递给 onchange javascript 事件

> ID：12502574
> 
> 赞同：0
> 
> 时间：2012-09-19T20:41:20.110
> 
> 标签：javascript, html, vbscript

我有以下代码，它使用 .getelementbyid 方法从下拉列表中选择一个项目。页面的工作方式是一旦选择了项目，就会出现一个新屏幕，允许向用户发送消息给某人（当您从下拉列表中选择项目时，表单使用 onchange 事件来处理）。运行此代码时，它会选择正确的项目，但不会重新填充页面。

```
With HTMLDoc2

.getElementById("navbar1").setAttribute "value", "getaddr"

End With 
```

您如何强制表单识别您已选择下拉项目之一并处理 onchange 事件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-15T05:18:40.170

我一直在寻找类似的答案，发现这可能有用。

我在网页上有一个 SELECT 元素（它有一个 ID），它有一个与之关联的 onchange javascript。我按如下方式访问它（使用您的示例）：-

```
dim objURLpage as MSHTML.HTMLdocument

dim appIE as InternetExplorer

dim objSELECTelement as MSHTML.HTMLSelectElement 
```

'此类型将取决于您的 HTML 元素类型，但通常下拉列表是“SELECT”元素之间的“OPTION”元素

```
Set objURLpage = appIE.document  'I found this gives current web page that's open

set objSELECTelement = objURLpage.getElemebtById("navbar1")

objSELECTelement.selectedindex = 0 
```

'数字取决于从“0”开始的下拉列表中项目的位置

```
objSELECTelement.FireEvent("onchange") 
```

# jquery - img lazyload 需要滚动操作才能工作

> ID：12502576
> 
> 赞同：0
> 
> 时间：2012-09-19T20:41:29.170
> 
> 标签：jquery, lazy-loading

我正在使用 Arial Fleser 的图像延迟加载，它工作得很好，但是，每当我决定将某些图像放在其他东西中时就会出现问题，比如水平手风琴，或者水平移动 div 的东西，就像延迟加载插件期望你图像通过一些垂直滚动出现在视口中，但是如果你的图像要水平显示，例如，通过一些 jQuery 函数从 css left -1500px，你最终得到的只是图像占位符。然后，您必须向上或向下滚动至少 1 个像素，以便加载图像。

在我开始弄清楚一些使某些容器向上滚动或向下滚动 1 个像素的俗气 hack 之前，我想我会问：一定有某种方法可以告诉lazyload 理解的不仅仅是滚动动作吗？一旦图像进入视野（无论如何），图像应该加载。或者无论如何，我会寻求任何创造性的解决方案，即使它有点俗气。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T20:53:22.330

如果我误解了您的请求，我深表歉意，但我相信您可以设置几个延迟加载选项以在您描述的实例（我认为）中工作：

第一个是用于水平滚动 div 之类的实现，您必须告诉lazyload 在所述 div 上工作，如下所示：

```
$("img.needstoload").lazyload({         
     container: $("#scrollydivid")
}); 
```

还有'skip_invisible'参数，您可能需要将其设置为false，因为默认情况下lazyload会忽略不可见的图像（直到您垂直滚动，当它重新检查图像以查看是否需要加载时）...

# ruby-on-rails - CDN 和 Heroku：背景图片不显示

> ID：12502577
> 
> 赞同：0
> 
> 时间：2012-09-19T20:41:36.600
> 
> 标签：ruby-on-rails, heroku, cdn

在我的 Heroku rails 应用程序中。我按照这个说明实施了 CDN。 [https://devcenter.heroku.com/articles/cdn-asset-host-rails31#configuration](https://devcenter.heroku.com/articles/cdn-asset-host-rails31#configuration)

它几乎可以正常工作，但是我在 css.scss.erb 文件中编写的背景图像没有显示出来。我的文件和问题如下。

# custom.css.scss.erb

```
.ap-sidebar .ap-nav li a span { 
   background: transparent url(asset-path('nav_arrows.png', image)) no-repeat 0 50%;
} 
```

# 分期.rb

```
config.action_controller.asset_host = "//#{ENV['FOG_DIRECTORY']}.s3.amazonaws.com" 
```

输出网址应为：staging-bucket.s3.amazonaws.com/assets/nav_arrows-digest.png

但实际输出如下：.s3.amazonaws.com/assets/nav_arrows-digest.png

我将资产路径更改为资产 url，但它不起作用。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T16:28:04.467

我找到了解决这个问题的方法。

只是改变这个：

```
.ap-sidebar .ap-nav li a span { 
   background: transparent url(asset-path('nav_arrows.png', image)) no-repeat 0 50%;
} 
```

对此：

```
.ap-sidebar .ap-nav li a span { 
   background: transparent url('nav_arrows.png') no-repeat 0 50%;
} 
```

css.scss.erb 不起作用，所以我也从文件中省略了 erb。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-20T03:33:08.630

你应该检查两件事：

*   环境变量 ENV['FOG_DIRECTORY'] 可能为零。您可以使用以下命令检查环境变量：

    heroku 配置 --app

更多细节：[https ://devcenter.heroku.com/articles/config-vars](https://devcenter.heroku.com/articles/config-vars)

*   您的应用在 Heroku 上运行的模式。默认情况下，您的应用程序将在生产模式下运行，而您正在配置暂存模式。您可以按照这篇文章更改模式：[https ://devcenter.heroku.com/articles/multiple-environments](https://devcenter.heroku.com/articles/multiple-environments)

# email - 注释 公式语言“@ValidateInternetAddress”无法正确验证？

> ID：12502587
> 
> 赞同：1
> 
> 时间：2012-09-19T20:42:02.037
> 
> 标签：email, lotus-notes, email-validation, lotus-formula, rfc822

我们正在使用以下验证代码来检查由 Lotus Notes 驱动的 Web 表单上的有效电子邮件地址格式：

```
@If((@ValidateInternetAddress([Address821]; @ThisValue)!="" 
| @Contains(@ThisValue; "\"") | @Contains(@ThisValue; "'") 
| @Contains(@ThisValue; " ")); "Please include a valid email address."; ""); 
```

目前，如果用户输入以下任何输入，验证将引发错误消息：

*   空场
*   " "、' 或 / 字符
*   电子邮件的域部分：“test.com”
*   只要 @

*但是*，如果用户输入**test@test**，则表单会将此验证为有效的电子邮件地址格式。

这种格式是否被认为是有效的“Address821”格式？或者表单是否将错误的格式验证为有效的电子邮件地址？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T22:20:48.827

是的，按照过去和当前的标准，它在技术上是有效的地址语法。

RFC 中的语言随着时间的推移而演变：

> RFC-821：3.7。域
> 
> 域是最近在 ARPA Internet 邮件系统中引入的概念。域的使用将地址空间从简单字符串主机名的平面全局空间更改为全局地址的层次结构根树。主机名由域和主机指示符替换，域和主机指示符是由句点分隔的域元素字符串序列，域元素按从最具体到最一般的顺序排列。

这不是很精确。它没有明确规定域名中必须有多个元素，但也没有明确禁止。但这已被淘汰：

> RFC-2821：2.3.5 域
> 
> 域（或域名）由一个或多个点分隔的
> 组件组成。... 如本文档和 [22] 中所述，域名是完整的、完全限定的名称（通常称为“FQDN”）。非 FQDN 形式的域名只不过是本地别名。本地别名不得出现在任何 SMTP 事务中。

这似乎是在说这是非法的，但实际上并不是这样。我将在下面进行解释，但首先让我们看一下旨在淘汰 2821 的标准草案，它澄清了很多事情：

> RFC-5321 2.3.5 域名
> 
> 域名（或通常只是一个“域”）由一个或多个组件组成，如果出现多个组件，则以点分隔。在电子邮件地址中单独使用顶级域的情况下，使用单个字符串，不带任何点。这使得在公共 Internet 上的 SMTP 事务中只出现完全限定域名的要求（下文将详细描述）在涉及顶级域的情况下尤为重要。... 如本文档和 RFC 1035 [2] 中所述，域名是完整的、完全限定的名称（通常称为“FQDN”）。非 FQDN 形式的域名只不过是本地别名。本地别名不得出现在任何 SMTP 事务中。

这清楚地表明，域名中不需要点，只要它是顶级域。

@ValidateInternetAddress 无法合理地知道“test”是否是有效的顶级域。即使 IBM 在已批准的公共 TLD 列表中进行了编程（恕我直言，这是一个坏主意，因为它可以而且确实会改变），您实际上可以在您自己的 DNS 中设置一个称为“测试”的私有 TLD。这与标准确实禁止的“本地别名”不同。没有针对实际 TLD 的规则。

就此而言，它甚至可以是一个公共 TLD。理论上，TLD 的所有者可以为 TLD 设置邮件服务器。即，President@US 或 Queen@UK。不太可能，但在这些情况下是可能的，但是随着所有新 TLD 的上线，如果某些注册商使用 info@domain，我不会感到惊讶。

I guess theoretically @ValidateInternetAddress could make the DNS call to check whether it can resolve "test" as a TLD, but the doc for that function only says that it checks the syntax of the address, and the existence of the TLD is a semantic issue, not a syntax issue.

# python - 计算百分比差异python

> ID：12502588
> 
> 赞同：1
> 
> 时间：2012-09-19T20:42:13.923
> 
> 标签：python, percentage

我正在尝试在我为我的工作构建的表单上工作，但它似乎并没有按照我期望的方式工作。

我想计算两个字段之间的百分比差异`ANL_CMA1_NUM_CLOSED_SALES`和`ANL_CMA2_NUM_CLOSED_SALES`.

我认为我的数学是正确的，但我只得到个位数的结果，根据输入的值是正数还是负数。

我正在研究一种可以自定义权限级别和四舍五入的表格，我正在将其四舍五入到最接近的百分之一。谁能帮我解决这个问题？

原始公式的末尾没有该`-100) * 100)`部分，但也无法正常工作。

```
FormSet.SetFieldValue(CurrentForm, "ANL_CHG_NUM_CLOSED_SALES", 
(((FormSet.GetFieldValue(CurrentForm, "ANL_CMA2_NUM_CLOSED_SALES") - 
FormSet.GetFieldValue(CurrentForm, "ANL_CMA1_NUM_CLOSED_SALES")) /    
 FormSet.GetFieldValue(CurrentForm, "ANL_CMA1_NUM_CLOSED_SALES")) -100) * 100) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-19T20:44:50.303

您可能在需要浮点除法（即 1./3 == 0.3333333）的地方使用整数除法（即 1/3 == 0）。

如果您将其分解一下，也可能更容易理解-

```
cma1 = FormSet.GetFieldValue(CurrentForm, "ANL_CMA1_NUM_CLOSED_SALES")
cma2 = FormSet.GetFieldValue(CurrentForm, "ANL_CMA2_NUM_CLOSED_SALES")
delta = float(cma2 - cma1) / cma1
FormSet.SetFieldValue(CurrentForm, "ANL_CHG_NUM_CLOSED_SALES", delta*100.0) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-19T20:50:04.297

您需要将值转换`float`为以获得浮点除法（否则，Python 会进行整数除法，将结果截断为整数）。

使用临时变量来保持理智：

```
cma1_closed_sales = FormSet.GetFieldValue(CurrentForm, "ANL_CMA1_NUM_CLOSED_SALES")
cma2_closed_sales = FormSet.GetFieldValue(CurrentForm, "ANL_CMA2_NUM_CLOSED_SALES")
pct_change = 100.0 * (cma2_closed_sales - cma1_closed_sales) / float(cma1_closed_sales)
FormSet.SetFieldValue(CurrentForm, "ANL_CHG_NUM_CLOSED_SALES", pct_change) 
```

# java - 在android apk文件运行时查看方法调用

> ID：12502592
> 
> 赞同：-1
> 
> 时间：2012-09-19T20:42:31.093
> 
> 标签：java, android, testing, code-coverage, apk

嗨，我需要对 android apk 文件进行一些覆盖测试。我无权访问源代码。是否有任何此类工具可以让我查看 apk 文件运行时中的方法调用？这样我就可以做一些功能覆盖分析？我听说像 emma 这样的工具可以处理 java jar 文件。那么apk文件有什么方法吗？我想在手机或模拟器中运行 apk 并观察方法调用/或获取方法调用的报告。

所以这是我的目标，在使用 apk 运行应用程序时，我想要一份所调用方法的覆盖率报告。现在，如果 emma 可以使用 apk 那就太好了。因为我可以将 apk 转换为 jar 文件。但我不能像 apk 一样运行 jar，所以我想在 jar 上运行 emma 对我没有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T20:48:44.500

您确实可以在 Android 上使用 EMMA：

*   [http://blog.appmakr.com/android-code-coverage/](http://blog.appmakr.com/android-code-coverage/)
*   [http://www.betaful.com/2009/08/emma-code-coverage-for-your-android-projects/](http://www.betaful.com/2009/08/emma-code-coverage-for-your-android-projects/)
*   使用 Android Maven... [http://maven-android-plugin-m2site.googlecode.com/svn/emma-mojo.html](http://maven-android-plugin-m2site.googlecode.com/svn/emma-mojo.html)

您可以使用 Instrumentation 和[robotsium](http://code.google.com/p/robotium/)来测试您的 Android 项目的其他部分，以调查 GUI 行为，即使您没有应用程序的源代码。

# jquery - 在此链接滑块上自动播放 - 工作示例

> ID：12502596
> 
> 赞同：1
> 
> 时间：2012-09-19T20:42:39.130
> 
> 标签：jquery, slider, carousel, autoplay

自动播放自定义滑块。

目前我的滑块正在工作，因此当单击链接时，滑块会移动到下一张幻灯片，或跳转到您选择的幻灯片。这一切都很好。

我希望滑块在设定的时间后自动播放。

我仍然需要每个链接都是可点击的，并将您带到相关的幻灯片。

单击链接后，将需要禁用自动播放功能，以便可以在用户决定的时间内查看幻灯片。

我尝试了一些解决方案，但似乎没有任何效果，可以这样做吗？

谢谢

请参阅工作示例的链接[http://www.designashby.co.uk/slider.php](http://www.designashby.co.uk/slider.php)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T03:50:52.900

要拥有一个计时器，您需要执行以下操作：

```
setInterval(5000, function(){
  $('#list-links li a').trigger('click');
}); 
```

5 秒后，该链接将被单击，您的幻灯片将移动。

# google-app-engine - Google Appengine 适合我吗

> ID：12502598
> 
> 赞同：0
> 
> 时间：2012-09-19T20:42:49.613
> 
> 标签：google-app-engine

我想创建一个 Web 应用程序，它结合了 CMS 和 CRM 以及 JasperReports 功能。

该应用程序允许群组在前端呈现网络状态，并在后端维护群组成员列表。我想在开源 CMS 上进行构建，并为我的特定目的添加我需要的功能。我需要使用 JasperRepots 对分布式材料进行像素完美打印。

我需要该应用程序做的主要事情是支持许多域和子域，使我能够在所有实例中添加新功能和错误修复。

看了几篇文章，我会回答一些问题。对于许多领域，我的意思是最初几年不到 100 个，然后每年大约 20 个。图像存储将是最小的。所有网站看起来基本相同，并使用一组图像。每个域或子域将拥有少于 5GB 的图像存储空间。

感谢您的帮助和任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T02:37:47.923

可能不是。对于 PDF 导出，Jasper 使用 GAE 不支持的 iText。而对于“像素完美”，Jasper 使用 java.awt 类，它们中的大多数也不支持。

[https://groups.google.com/forum/?fromgroups=#!topic/google-appengine-java/oH0jGwCGrV8](https://groups.google.com/forum/?fromgroups=#!topic/google-appengine-java/oH0jGwCGrV8)

# azure-sql-database - 如何从 SQL Azure 联合成员向 SQL Azure 联合根发送选择查询？

> ID：12502604
> 
> 赞同：1
> 
> 时间：2012-09-19T20:43:18.280
> 
> 标签：azure-sql-database

假设我们有一些联邦成员和 1 个联邦根，并且联邦根有一个名为“common”的表。

每天一次，我想在公用表（在联合根中）和联合成员中的表之间运行一次连接查询。查询骨架如下所示：

（在联盟成员中......）

SELECT * FROM FED_MEMBER_TABLE WHERE id in (SELECT id FROM common)

// 注意'common'表在联邦根目录，而不是联邦成员

是否可以？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T04:10:33.513

阿法克，没有。

如果它是联邦成员之间的公用表，则应将其作为所有联邦成员的参考表。

# xml - xsd 中的字母数字密码验证

> ID：12502606
> 
> 赞同：0
> 
> 时间：2012-09-19T20:43:19.707
> 
> 标签：xml, validation, passwords, xsd

您好我只需要验证字母数字字符的密码（应该同时显示 0..9 的字母和数字）。我的意思是它应该包含至少一个数字和剩余的字母

我使用的正则表达式是这样的：

```
 <xsd:simpleType name="PasswordType">
         <xsd:restriction base="xsd:string">
             <xsd:pattern value="?!^[0-9]*$)(?!^[a-zA-Z]*$)^([a-zA-Z0-9]{8,20})$"/>
         </xsd:restriction>
    </xsd:simpleType> 
```

但是eclipse抱怨错误： *InvalidRegex: Pattern value '?!^[0-9] *$)(?!^[a-zA-Z]* $)^([a-zA-Z0-9]{8,20} )$' 不是有效的正则表达式。报告的错误是：“意外的元字符。”。*

任何人都可以帮助如何解决这个问题？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T00:47:46.797

我不确定您使用的是什么正则表达式语法，但您给出的表达式不符合 XSD 规范中定义的语法。你说你想要一串至少包含一个数字的字母数字字符。一种识别该语言的 XSD 样式的正则表达式是

```
\p{L}*\d(\p{L}|\d)* 
```

接受 Unicode 字母和十进制数字的任何混合；如果你想将密码限制为 ASCII，你可以说

```
[a-zA-Z]*[0-9][a-zA-Z0-9]* 
```

要将长度限制在 8 到 20 之间，最简单的方法是使用`minLength`和`maxLength`刻面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-20T14:41:49.597

缺少左括号？

```
<xsd:simpleType name="PasswordType"> 
  <xsd:restriction base="xsd:string"> 
    <xsd:pattern value="(?!^[0-9]*$)(?!^[a-zA-Z]*$)^([a-zA-Z0-9]{8,20})$"/> 
  </xsd:restriction> 
</xsd:simpleType> 
```

# jquery - 当 jQuery 自己被传递时会发生什么？

> ID：12502610
> 
> 赞同：4
> 
> 时间：2012-09-19T20:43:25.660
> 
> 标签：jquery, jquery-plugins

所以我有一个难题，希望有人已经掌握了答案。阅读 jQuery 源代码，我还没有理解这里到底发生了什么。

```
 $('#div')      //returns a jQuery object
 $( $('#div') ) // returns an identical jQuery object
 $( $( $( $( $( $('#div') ) ) ) ) ) // returns the same idential object 
```

我在插件开发中遇到过我不知道需要一个 sting 选择器或 jQuery 对象的实例。在这些情况下，我只是将选择器或 jQuery 对象传递给 jQuery，这样就可以保证得到我想要的 jQuery 对象。效果很好，但感觉太神奇了。当我这样做时，到底发生了什么？有没有更好的办法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T20:48:13.257

基本我认为在函数中`$(...)`存在一些基本情况。

*   在 Arg 是 String 类型中，传递 this 并找到或创建 HTML Dom 元素，然后将其封装到 JQuery 对象中。
*   在 Arg 是 HTML Dom 类型中，将对象封装成 JQuery 对象
*   在 Arg 是 JQuery 对象中，按原样返回它

但实际上存在更多的情况，并且在此之前进行了大量的调试和错误检查。

[在http://jsapi.info/jquery/1.8.0/jQuery.fn.init](http://jsapi.info/jquery/1.8.0/jQuery.fn.init)查看更多信息 我可以从代码中看到什么，如果我们有的话。

```
var x = $('#div');
var y = $(x); 
```

`x`和的内容`y`相等，但记忆的`x`和`y`不相等。

假设我们有：

```
class $ {
  var x;
  $($ t) {
    this.x = t.x
  }
} 
```

如果我们都称`$`这将具有相同的内在价值，但实际上与两个不同的对象不同，这将是可行的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-19T21:56:43.927

在回答这个问题之前，需要了解 $(...) 返回一个具有类似数组属性的特殊对象。从文档中：

> jQuery 工厂函数 $() 返回一个 jQuery 对象，该对象具有数组的许多属性（长度、[] 数组访问运算符等），但与数组不完全相同，缺少数组的一些内置属性-in 方法（例如 .pop() 和 .reverse()）。

所以，这就是发生的事情。

1.  无论选择器的类型如何，`new jQuery.fn.init( selector, context, rootjQuery );`都会调用它，因此会创建一个新对象，并在此`init()`构造函数中设置其属性。

2.  $(...) 的参数经过检查是否为空、DOMElement、字符串或函数（通过 isFunction）

所有检查均失败，最后调用以下代码。

```
if (selector.selector !== undefined ) {
    this.selector = selector.selector;
    this.context = selector.context;
}
return jQuery.makeArray( selector, this ); 
```

`this.length`函数 makeArray() 通过简单地设置属性将提供的选择器转换为类似数组的对象，`this.ret[0]=..., this.ret[1]=...`这样它就“感觉”像一个数组，而它仍然是一个基于 jQuery 原型（又名`$.fn`）的对象。请记住，`this`上面的代码只是原型中的一个全新对象`$.fn`。此外，`.selector`属性`.context`从原始复制到此。

重要的是要注意，例如`.prevObject`属性将丢失，但可能会根据方法链接添加一个新属性。

总而言之，这需要时间和内存，简单地检查`.selector`何时有人可能将 jQuery 对象传递到您的插件中可能是有意义的。另一方面，与原始实例具有相同行为的新实例可能会有所帮助。

# python - AttributeError：“unicode”对象没有属性“pop”

> ID：12502612
> 
> 赞同：-1
> 
> 时间：2012-09-19T20:43:35.740
> 
> 标签：python, google-app-engine, unicode, webapp2

我在 gae 中有这段 python 代码。

```
def post(self):
    cases=self.request.get('cases')
    while cases:
        logging.info("cases: %s " % cases)
        case=cases.pop() 
```

这会产生这个日志。

```
INFO     2012-09-19 20:23:50,690 views.py:674] cases: [u'court1150'] 
ERROR    2012-09-19 20:23:50,690 webapp2.py:1553] 'unicode' object has no attribute 'pop'
Traceback (most recent call last):
  File "/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/lib/webapp2/webapp2.py", line 1536, in __call__
    rv = self.handle_exception(request, response, e)
  File "/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/lib/webapp2/webapp2.py", line 1530, in __call__
    rv = self.router.dispatch(request, response)
  File "/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/lib/webapp2/webapp2.py", line 1278, in default_dispatcher
    return route.handler_adapter(request, response)
  File "/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/lib/webapp2/webapp2.py", line 1102, in __call__
    return handler.dispatch()
  File "/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/lib/webapp2/webapp2.py", line 572, in dispatch
    return self.handle_exception(e, self.app.debug)
  File "/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/lib/webapp2/webapp2.py", line 570, in dispatch
    return method(*args, **kwargs)
  File "/Users/brian/googleapps/scheduler/views.py", line 675, in post
    case=cases.pop()
AttributeError: 'unicode' object has no attribute 'pop' 
```

另一方面，在交互式控制台中使用几乎相同的代码。

```
cases = [u'court1150'] 
while cases:
    case=cases.pop()
    print case
print cases 
```

我没有收到任何错误，并打印出以下内容。

```
court1150
[] 
```

为什么我在 gae 启动器中收到 unicode 错误，我该如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T20:52:13.687

`self.request.get('cases')`不返回值列表，它只返回*一个*值。尝试`get_all('cases')`改用：

```
def post(self):
    cases=self.request.get_all('cases')
    while cases:
        logging.info("cases: %s " % cases)
        case=cases.pop() 
```

无需使用 while 循环，for 循环效果更好：

```
def post(self):
    cases=self.request.get_all('cases')
    logging.info("cases: %s " % cases)
    for case in cases:
        # do something with case. 
```

# c# - Equals 和 GetHashCode 方法不一致

> ID：12502613
> 
> 赞同：13
> 
> 时间：2012-09-19T20:43:38.100
> 
> 标签：c#, .net, equals, hashcode

看完这个问题[为什么“int”和“sbyte”GetHashCode函数会产生不同的值？](https://stackoverflow.com/questions/12501979/why-do-int-and-sbyte-gethashcode-functions-generate-different-values)我想进一步挖掘并发现以下行为：

```
sbyte i = 1;            
int j = 1;
object.Equals(i, j) //false (1)
object.Equals(j, i) //false (2) 
i.Equals(j) //false (3)
j.Equals(i) //true (4)
i == j //true (5)
j == i //true (6)
i.GetHashCode() == j.GetHashCode() //false (7) 
```

1.  (3) 和 (4) 之间的差异打破了 Equals 应该是对称的要求。
2.  [(2) 和 (4) 之间的区别与MSDN 规范](http://msdn.microsoft.com/en-us/library/w4hkze5k.aspx)不一致：

    > 如果这两个对象不代表同一个对象引用且都不为 null，则调用 objA.Equals(objB) 并返回结果。这意味着如果 objA 覆盖 Object.Equals(Object) 方法，则调用此覆盖。

3.  (3) 和 (5) 之间的差异意味着 operator == 返回 true，但是对象在 Equals 方面并不相等。
4.  (4), (5), (6) 和 (7) 之间的区别意味着两个对象在运算符 == 和 Equals 方面是相等的，但是它们具有不同的哈希码。

如果有人能解释为什么我认为在相当基本的 .NET 类型中观察到这种不一致的行为，我将非常感兴趣。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-19T20:45:57.180

您的问题是您错过了`i.Equals(j)`. 它去过载`int.Equals(int)`。在这里，您正在比较`i`和`(int)j`，它们是相同的。相同的隐式转换发生在`==`.

其他比较适用于 an`int`和 a `sbyte`，根据定义，它们是不同的。`j.Equals(i)`转到重载`int.Equals(object)`，因为参数不能隐式转换为`sbyte`.

`Equals`对他们来说是对称的，但你的调用代码不是。如果你用 抑制隐式转换`i.Equals((object)j)`，它会返回`false`，表明它`Equals`确实是对称的。

# makefile - Makefile 包含相同目标的文件

> ID：12502617
> 
> 赞同：0
> 
> 时间：2012-09-19T20:43:54.983
> 
> 标签：makefile, multiple-makefiles

我有一个使用递归 Make 的大型项目。几乎所有的 Makefile 都是一样的。我基本上将所有目标文件构建到同一个目录中，如下所示：

```
$(OBJ)/%.o: %.c
        $(COMPILE) ${INCLUDES} -c $< -o $@

$(OBJ)/%.o: %.cpp
        ${CXX} ${INCLUDES} ${FLAGS}  -c -fPIC $< -o $@ 
```

是否可以将这些目标放在一个包含文件中，这样我就不必在每个 Makefile 中放置相同的行？

include 我只用于共享变量，当我使用 include 测试它时它不起作用。

# cakephp - 为什么使用 Doctrine 而不是 CakePHP 的标准数据库 ORM？

> ID：12502618
> 
> 赞同：15
> 
> 时间：2012-09-19T20:44:06.603
> 
> 标签：cakephp, doctrine, doctrine-orm

我即将开始使用 CakePHP 2.2 开发一个新的 Web 项目，以前主要使用 Zend Framework 1。

乍一看，我真的很喜欢 CakePHP 处理模型和底层数据库表的方式，尤其是在快速设置一对多和多对多关系方面，并且尽量减少麻烦。坦率地说，与我过去在 Zend Framework 中做事的方式相比，这似乎是一股清新的空气。

然而，在过去几年中，在使用 Zend Framework 时，我曾研究过使用 Doctrine 来提供 ZF 相当笨拙的模型关系。在我看来，教义非常强大和灵活。

所以现在我想知道，在我深入研究我的新 CakePHP 项目之前，我是否还应该考虑将 Doctrine 与我新选择的框架一起使用？与 CakePHP 的内置 ORM 和数据库功能相比，Doctrine 带来了哪些优势和劣势（不是双关语！）？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-21T05:57:42.877

如果作为一个整体使用，CakePHP 效果最好。在您的特定情况下，尽管您可以根据需要使用 Doctrine 而不是 Cake 的 ORM，但您会失去很多 cake 的功能。例如。FormHelper 做了很多“神奇”的事情，比如使用模型的模式猜测字段的正确输入类型等，当验证失败时自动在表单中的适当字段下方显示错误消息等。

正如您所评论的那样，您对 Doctrine 也没有太多经验，因此我建议您坚持使用 CakePHP 的 ORM，并且仅在您发现它不足以满足您的需求时才寻找选项。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-19T20:48:07.060

如果你已经使用过 Doctrine 和 CakePHP 的 ORM，你可以根据主要原因来决定改变：

*   什么会给你更多的生产力？
*   什么会给你更多的可维护性？
*   什么会减少你的学习曲线？

就个人而言，我会选择 Doctrine，因为它确实针对一个问题。

# eclipse - 如何在 Eclipse 中分析非 Web 应用程序？

> ID：12502619
> 
> 赞同：0
> 
> 时间：2012-09-19T20:44:07.340
> 
> 标签：eclipse, ide, profiling

我有一个带有 main(String[] args) 方法的类。它是 Swing 应用程序的入口点，在大多数情况下运行良好。应用程序中的一些操作很慢，所以我想我会尝试 Eclipse Juno 中的分析器。

当我在 Eclipse 的 Project Explorer 中右键单击 .java 文件时，转到“Run As->”我的选项是“Run on Server”、“Java Application”和“Run Configurations ...”。与“Debug As->”类似，除了有“Debug Configurations ...”。

但是，如果我右键单击并进入“Profile As->”，唯一的选项是“Profile on Server”和“Profile Configurations ...”。

我看不到可用的“分析”视角。如果我需要安装额外的组件或模块，如果我安装了与之冲突的东西，我无法确定该功能是否已被删除或[可能完全停止](http://www.eclipse.org/tptp/home/project_info/devplans/EclipseTPTPProjectPlan2010.htm)（没有替换，但似乎有些东西在那里）功能，如果有需要更改的配置设置，或者由于某种原因它不适用。到目前为止，Google 会为我提出的每个搜索查询提供许多不相关的结果。

所以我的问题是：在桌面应用程序上运行探查器需要做什么，最好是在 Eclipse (Juno) 中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T05:09:27.917

您的问题似乎已在此处得到解答：[https ://stackoverflow.com/questions/2713940/eclipse-java-profiler](https://stackoverflow.com/questions/2713940/eclipse-java-profiler)

虽然问题可以追溯到 TPTP 终止之前，但建议替代方案的答案仍然是相关的。

# java - Java 中两个表模式（Oracle 11g）的最快 CRUD 应用程序？

> ID：12502623
> 
> 赞同：2
> 
> 时间：2012-09-19T20:44:21.220
> 
> 标签：java, frameworks, crud

我有两张桌子，每张大约有 10 列。我需要开发一个 CRUD Web 应用程序，它可以搜索、读取、更新、创建或删除该表中的记录。更新仅限于两个字段 - 状态和日期字段。

我想知道实现这个 CRUD 应用程序的最快方法是什么。我们使用 java / Oracle Application Server 10g（我知道，我知道！！），所以我猜 CRUD 应用程序需要在 java 中。也因为它是一个内部应用程序，我真的不需要它超级健壮和花哨等等。只是一个适用于 Web UI 的基本功能。我们现在使用 vanilla servlets / jsp。

TL;DR 我想（不确定）我的问题是关于我可以使用哪个框架来为 2 表模式的 CRUD 应用程序实现最快的结果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-12-15T16:29:41.453

从现有数据库构建 Java/CRUD 脚手架的最简单方法可能是 Telosys Tools 代码生成器（请参阅[https://sites.google.com/site/telosystools/](https://sites.google.com/site/telosystools/)）（和教程 [https://sites.google.com/site /telosystutorial/](https://sites.google.com/site/telosystutorial/) )

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-19T23:30:53.907

[openxava](http://openxava.org/en)

**Others**

*   Spring Roo
*   [JBOSS Forge](http://forge.jboss.org/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-01T14:53:24.303

您可以使用 Jboss forge 创建一个简单的 crud 应用程序[此处列出了使用 JSF CDI 和 Hibernate 创建一个简单的 crud 应用程序的步骤](http://nueron.blogspot.in/2013/08/jboss-forge-for-headstart-in-web.html)

# php - 拆分字符串并将每个值输入mysql

> ID：12502624
> 
> 赞同：0
> 
> 时间：2012-09-19T20:44:22.007
> 
> 标签：php, mysql, arrays, explode

`tag1,tag2,tag3`我有我想进入表格的形式的标签，即

```
tag_id    tag_name    topic_id
  1         php          1
  2         ajax         2
  3         mysql        3
  4         html         4 
```

下面的脚本没有这样做。我在屏幕上没有收到任何错误

```
$topic_tag = explode("," , $topic_tags) ;

       foreach($topic_tag as $topic_tags) {
       $query = "INSERT INTO `forum_tags` (`tag_id`, `tag_name`) 
       VALUES ( NULL, '" .mysql_real_escape_string(trim($topic_tags))."')";
       } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T20:53:42.503

考虑为您的 SQL 请求使用 PDO：http: [//php.net/manual/en/book.pdo.php](http://php.net/manual/en/book.pdo.php)

例如 ：

```
$statement = $pdo_object->prepare('INSERT INTO `forum_tags` (`tag_id`, `tag_name`, `topic_id` ) VALUES ( ?, ?, ?) ');
$statement->execute( $topic_tags ); 
```

# eclipse - 在 Eclipse 中，如何在 Team Perspective 中默认设置 Flat Presentation？

> ID：12502630
> 
> 赞同：4
> 
> 时间：2012-09-19T20:44:43.623
> 
> 标签：eclipse, svn

当使用像 CVS 或 SVN 这样的集中式版本控制系统时，我喜欢在提交之前在*Team Synchronizing View中查看我的更改。*默认情况下，Eclipse 会折叠源代码树，我总是需要单击“显示 Java 工作区”图标中的小箭头并选中*Flat Presentation*的复选框：

![用于选择平面演示的下拉菜单](../Images/1ac1330319ed74f92d54a009361c105c.png)

有没有办法让它成为 Synchronizing 透视图的默认值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T14:42:52.700

“同样可以在 Team -> CVS -> Synchronize/Compare settings 中对 CVS 执行相同的操作，尽管我还没有测试过。”

为 CVS 测试了它。不工作。渣男日食：/

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-20T14:17:58.480

我为 SVN 找到了一种方法，取消选中*允许模型参与同步*选项：

![Eclipse - 团队 - SVN - 查看设置](../Images/0f9aed832dbdc481320a321883d6c42d.png)

可以在*Team* -> *CVS* -> *Synchronize/Compare*设置中对 CVS 执行相同的操作，尽管我还没有真正测试过它。

**更新：**如果这在第一次不起作用，请在 View Menu 上（单击 Synchronize 面板的最小化按钮旁边的小箭头激活），选择*Presentation* -> *Tree*。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-20T14:01:24.390

Window > Preferences > Team > 选择显示 Workspace 项目时要使用的演示文稿：平面

# events - MediaElement.js flash fallback 不执行 onplay、onpase、onended 事件

> ID：12502633
> 
> 赞同：1
> 
> 时间：2012-09-19T20:45:15.867
> 
> 标签：events, mediaelement.js

我有一个使用以下代码嵌入的视频：

```
<video controls='false' preload='true' 
        onplay='doPlayEvent()' 
        onpause='doPauseEvent()'
        onended='doEndEvent()';
        src='/the_video.mp4' 
        id='VideoID'>
    <source type='video/mp4' src='/the_video.mp4'></source>
    <source type='video/ogg' src='/the_video.ogg'></source>
    <source type='video/webm' src='/the_video.webm'></source>
</video> 
```

一些奇怪的行为是 FireFox 正在播放 flash 后备*，*更重要的是 onplay、pause 和 end 事件在 FF 或 IE8 中没有触发（我假设任何使用 flash 的东西）。

有谁知道我缺少什么来启用 Flash 中的事件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-20T10:42:52.470

对于 onplay、onpause 等，要在 flash 后备中工作，您需要将事件侦听器添加到创建 MediaElement 的 JavaScript 中，例如

```
mediaElement = new MediaElementPlayer('video',{
    //options etc

    // method that fires when the Flash or Silverlight object is ready
    success: function (mediaElement, domObject) {   

       // add event listeners
       mediaElement.addEventListener('timeupdate', function(e) {
           onVideoTimeUpdate(e);
       }, false);

       mediaElement.addEventListener('pause', function(e) {
           onVideoPaused(e);
       }, false);

       mediaElement.addEventListener('play', function(e) {
           onVideoPlayed(e);
       }, false);

       //etc
   } 
```

# android-ndk - 我的 android 应用程序在本机层崩溃，没有任何消息

> ID：12502635
> 
> 赞同：0
> 
> 时间：2012-09-19T20:45:20.923
> 
> 标签：android-ndk

我的 android 应用程序在我的本机代码中崩溃，没有任何消息。有一次，通过检查代码，我发现问题是内存不足。这次通过检查代码我什么也没看到。对于这种情况，是否有一种通用的方法？我应该如何处理这个问题？有时它会因“0xdeadbad 处的无效地址”而崩溃，有时它会打印一个（NDK）堆栈跟踪，但我真的不知道该怎么处理它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T03:32:33.923

**不要依赖阅读代码来查找错误**，它永远不会奏效。你最终会改变实际上是理智的代码，只会导致更多的错误......

**使用[ndk-gdb](https://stackoverflow.com/questions/10534367/how-to-get-ndk-gdb-working-on-android)**`SEGFAULT` ，它可以在没有任何断点的情况下捕捉原生问题。您必须使用调试符号编译您的二进制文件。希望自从 ndk 的最新版本以来，所有过程都非常简单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-20T00:27:42.383

请参阅[如何在 Android 中使用 addr2line](https://stackoverflow.com/questions/5314036/how-to-use-addr2line-in-android) - 答案解释了您如何理解崩溃堆栈跟踪。

# mongodb - 为什么这个 mongodb 查询这么慢？

> ID：12502642
> 
> 赞同：0
> 
> 时间：2012-09-19T20:46:00.733
> 
> 标签：mongodb, indexing

我有两个集合，如下：

**db.ships**
文档格式：{ mmsi: Long, ... some other fields }
索引：{ {mmsi: 1}, {unique: true} }

**db.navUpdates**
文档格式：{ mmsi: Long, time: ISODate, ... some other fields }
索引：{ mmsi: 1 }, { time: 1 }

对于 中的每个文档，我需要找到匹配的`db.ships`最新文档。我不能用来查找最新的文档，因为文档不一定按时间顺序（由时间戳定义）输入。`db.navUpdates``mmsi``_id``time`

例如：

```
ship document:
{ mmsi: 12345 }

navUpdate documents:
{ mmsi: 12345, time: ISODate("2012-09-19T12:00:00.000Z") }
{ mmsi: 12345, time: ISODate("2012-09-18T12:00:00.000Z") }
{ mmsi: 54321, time: ISODate("2012-09-19T12:00:00.000Z") } 
```

因此对于`ship`with `mmsi:12345`，最新`navUpdate`的是上面列表中的第一个文档 with `time:ISODate("2012-09-19T12:00:00.000Z")`。

我尝试了以下 mongo shell 脚本，但速度非常慢（仅 10 个查询需要几秒钟），并且[出现在服务器上的消息表明我缺少 index](https://stackoverflow.com/questions/4758377/mongodb-geting-client-cursoryield-cant-unlock-b-c-of-recursive-lock-warnin)。

```
db.ships.find().limit(10).forEach(function(ship) {
    var n = db.navUpdates.find({mmsi:ship.mmsi}).count();
    if (n==0) { return; }
    var t = db.navUpdates.find({mmsi:ship.mmsi}).sort({time:-1}).limit(1)[0].time;
    print(t);
}); 
```

为什么这个查询这么慢？我尝试向 中添加`{time: -1}`索引`navUpdate`，认为这`sort({time: -1})`可能是罪魁祸首，但仍然没有改善。

另外，这个查询可以优化吗？我`count()`在那里打了电话，因为有些`ship`文件的`mmsi`s 不在`navUpdates`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T21:08:34.037

单个查询只能使用一个索引，因此您应该添加一个复合索引`{ mmsi: 1, time: -1 }` 来`navUpdates`满足您的查找和排序需求。

然后用于[`.explain()`](http://www.mongodb.org/display/DOCS/Explain)确定您的索引是否正在您的查询中使用。

# python - 访问 Flask 中的多选表单字段

> ID：12502646
> 
> 赞同：42
> 
> 时间：2012-09-19T20:46:15.123
> 
> 标签：python, flask

我在 html 文件中有一个多选，如下所示：

```
<select multiple id="mymultiselect" name="mymultiselect">         
        <option value="1">this</option>       
        <option value="2">that</option>       
        <option value="3">other thing</option>
</select> 
```

当我通过以下方式访问 flask/python 中的 mymultiselect 字段时：

```
request.form['mymultiselect'] 
```

或者通过使用 request.args.get 函数它只返回一个选定的项目。我了解到，要获取所有选定的项目，我必须将 [] 添加到字段名称中，如下所示：

```
<select multiple id="mymultiselect" name="mymultiselect[]">       
        <option value="1">this</option>       
        <option value="2">that</option>       
        <option value="3">other thing</option>
</select> 
```

我可以通过在 firebug 中查看 post 数据看到这是有效的，但是我任何时候尝试在 flask/python 中访问该字段时，它都会返回为 null 或 None。

您如何访问这些名称末尾带有“[]”的多选表单字段？我也尝试将“[]”附加到 python 代码中的字段名称，但这似乎不起作用。

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2012-09-19T20:49:13.827

您想使用该[`getlist()`函数](http://werkzeug.pocoo.org/docs/datastructures/#werkzeug.datastructures.MultiDict.getlist)来获取值列表：

```
multiselect = request.form.getlist('mymultiselect') 
```

您*无需*添加`[]`名称即可完成此操作；事实上，它`[]`并没有帮助，根本不要使用它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2020-04-16T15:39:43.810

[![在此处输入图像描述](../Images/8ff91a7ed1beb774b6fa41d534ddaf0c.png)](https://i.stack.imgur.com/YCSTJ.png)> 有时，如果您使用 Ajax POST 方法，请检查网络选项卡中的参数名称。检查描述如何验证参数名称的附加图像。

在 Flask 视图中：

> 您可以根据参数名称访问列表响应。

```
request.form.getlist('mymultiselect[]') 
```

> 或者

```
request.form.getlist('mymultiselect') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-02-10T11:06:29.280

您可以创建一个函数来获取值作为字典

```
def __get_form_data(self, method='POST', compare_with=dict()):
    # Get form MiniFieldStorage items
    form = cgi.FieldStorage(fp=self.rfile, headers=self.headers, environ={ 'REQUEST_METHOD' : method })
    # Convert to dictionary
    return { key.rstrip('[]'):form.getlist(key) if key.endswith('[]') else form.getvalue(key) for key in form.keys() if compare_with.get(key)!=form.getvalue(key) } 
```

# asp.net - WCF 服务和 AspNetCompatibilityEnabled="true" 导致请求错误

> ID：12502649
> 
> 赞同：2
> 
> 时间：2012-09-19T20:46:27.437
> 
> 标签：asp.net, json, wcf, jsonp

我有一个 WCF 服务定义为：

```
[ServiceContract]
[AspNetCompatibilityRequirements(RequirementsMode = AspNetCompatibilityRequirementsMode.Required)]
public class Service
{
    [OperationContract]
    [WebGet(ResponseFormat = WebMessageFormat.Json)]
    public string HelloWorld()
    {
        return "Hello World";
    }
} 
```

我的 Web.Config 文件：

```
<configuration>
  <system.web>
    <compilation debug="true" targetFramework="4.0"/>
  </system.web>
  <system.serviceModel>
    <behaviors>
      <serviceBehaviors>
        <behavior name="">
          <serviceMetadata httpGetEnabled="true"/>
          <serviceDebug includeExceptionDetailInFaults="false"/>
        </behavior>
      </serviceBehaviors>
        <endpointBehaviors>
            <behavior name="webHttpBehavior">
                <webHttp />
            </behavior>
        </endpointBehaviors>
    </behaviors>
    <bindings>
      <webHttpBinding>
        <binding name="webHttpBindingWithJsonP" crossDomainScriptAccessEnabled="true"/>
      </webHttpBinding>
    </bindings>
    <services>
      <service name="Service">
        <endpoint address="" binding="webHttpBinding" bindingConfiguration="webHttpBindingWithJsonP" contract="Service" behaviorConfiguration="webHttpBehavior"/>
      </service>
    </services>
    <serviceHostingEnvironment multipleSiteBindingsEnabled="true" aspNetCompatibilityEnabled="true"/>
  </system.serviceModel>
</configuration> 
```

我希望能够在我的 WCF 服务中访问 ASP .Net 会话变量，并且我希望 WCF 服务返回 JSONP 数据，但是即使使用这个简单的服务，浏览到 ../Service.svc/HelloWorld 我也会得到一个400 错误请求错误。

有人可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-19T21:22:38.970

[看起来这个](http://social.msdn.microsoft.com/Forums/eu/wcf/thread/634bb3b1-8396-4dee-8247-1fb2649c9af1)Microsoft 论坛不支持 JSONP、ASP.NET 兼容性和经过身份验证的用户的组合。

根据论坛版主的说法，您需要禁用这三个中的一个。

可能不是您希望的答案，但版主的解释非常好，并提供了一些建议。

希望这可以帮助。祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-01T11:07:17.273

我意识到这已经得到解答，但是有可能（尽管我不确定是否从安全角度推荐）足够早地“取消身份验证”请求以通过 webHttpBinding 进行的检查。

要点是设置`HttpContext.Current.User`为一个新`GenericPrincipal`构建的`GenericIdentity`，没有名称或类型，模仿未经身份验证的用户刚刚访问您的服务时您会看到的内容 - 当 webHttpBinding 执行其“未经过身份验证的 JSONP 调用”时，检查请求是发生在未经身份验证的用户的上下文中。

**注意：**我不确定这是否存在安全隐患 - 我最想知道的是，如果您有一个经过身份验证的用户，他们的会话状态仍然可用于您的服务，这可能是一件坏事，具体取决于您正在做。

您可以在几个地方执行此操作

*   通过挂钩 Application.AuthenticateRequest 事件，按请求 URL 过滤
*   使用自定义 WCF 消息检查器

示例消息检查器和行为元素（同一类，使用风险自负）：

```
using System;
using System.Security.Principal;
using System.ServiceModel;
using System.ServiceModel.Channels;
using System.ServiceModel.Configuration;
using System.ServiceModel.Description;
using System.ServiceModel.Dispatcher;
using System.Threading;
using System.Web;

namespace MyNamespace
{
    public class ForceAnonymousEndpointBehavior : BehaviorExtensionElement, IDispatchMessageInspector, IEndpointBehavior
    {
        public override Type BehaviorType
        {
            get { return typeof(ForceAnonymousEndpointBehavior); }
        }

        protected override object CreateBehavior()
        {
            return new ForceAnonymousEndpointBehavior();
        }

        object IDispatchMessageInspector.AfterReceiveRequest(ref Message request, IClientChannel channel, InstanceContext instanceContext)
        {
            HttpContext.Current.User = Thread.CurrentPrincipal = new GenericPrincipal(new GenericIdentity("", ""), null);
            return null;
        }

        void IDispatchMessageInspector.BeforeSendReply(ref Message reply, object correlationState)
        {

        }

        void IEndpointBehavior.ApplyDispatchBehavior(ServiceEndpoint endpoint, EndpointDispatcher endpointDispatcher)
        {
            endpointDispatcher.DispatchRuntime.MessageInspectors.Add(new ForceAnonymousEndpointBehavior());
        }

        void IEndpointBehavior.AddBindingParameters(ServiceEndpoint endpoint, BindingParameterCollection bindingParameters)
        {

        }

        void IEndpointBehavior.ApplyClientBehavior(ServiceEndpoint endpoint, ClientRuntime clientRuntime)
        {

        }

        void IEndpointBehavior.Validate(ServiceEndpoint endpoint)
        {

        }
    }
} 
```

然后在 web.config 中注册行为扩展（在 system.serviceModel 元素中）：

```
<extensions>
  <behaviorExtensions>
    <add name="ForceAnonymous" type="MyNamespace.ForceAnonymousEndpointBehavior, MyAssembly" />
  </behaviorExtensions>
</extensions> 
```

将行为添加到有问题的端点行为（同样在 system.serviceModel 下）：

```
<behaviors>
  <endpointBehaviors>
    <behavior name="jsonpBehavior">
      <ForceAnonymous />
    </behavior>
  </endpointBehaviors>
</behaviors> 
```

`behaviorConfiguration`...并通过将属性设置为与您在上面使用的行为名称相匹配，确保在服务的端点声明中调用端点行为。

# java - Java：控制台类

> ID：12502653
> 
> 赞同：1
> 
> 时间：2012-09-19T20:46:50.803
> 
> 标签：java, input, console, passwords, overwrite

> **可能重复：**
> [为什么 char[] 优先于密码字符串？](https://stackoverflow.com/questions/8881291/why-is-char-preferred-over-string-for-passwords)

阅读java文档，我发现了这个关于[控制台](http://docs.oracle.com/javase/7/docs/api/java/io/Console.html)类的声明

> 首先，它禁止回显，因此密码在用户屏幕上不可见。其次，readPassword 返回一个字符数组，而不是字符串，因此可以覆盖密码，一旦不再需要它就将其从内存中删除。

为什么可以覆盖字符数组而不能覆盖字符串？或者也许可以以更简单的方式覆盖字符数组？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T20:48:05.670

JVM 可以将A`String`保存在称为 a 的东西中，以更有效`String pool`地管理 s 的内存使用。`String`然而，这样做的一个副作用是，即使在您用新的`String`.
然而，字符数组可以直接被覆盖，因此在这方面更安全。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-19T20:49:18.837

来自 Sun Certified Java Programmer for Java 6 Study Guide：

> readPassword 方法不返回字符串：它返回一个字符数组。原因如下：获得密码后，您可以对其进行验证，然后将其从内存中彻底删除。如果返回一个字符串，它可能存在于内存中某处的池中，也许某些邪恶的黑客可以找到它。

# vb.net - Delphi相当于VB的“DirectCast”？

> ID：12502654
> 
> 赞同：3
> 
> 时间：2012-09-19T20:46:52.677
> 
> 标签：vb.net, delphi

在 VB.Net 中，您可以使用“DirectCast”将鼠标点击或其他事件发送到其他 DirectX 应用程序。

Delphi中是否有与此等价的功能？或者有什么其他有用的方法吗？

```
 Public Sub ClickToL(ByVal WindowHandle As IntPtr, ByVal X As Integer, ByVal Y As Integer)
        Dim num As Integer = Me.MakeLong(X, Y)
        Form1.SendMessage(WindowHandle, DirectCast(&H201, IntPtr), IntPtr.Zero, DirectCast(num, IntPtr))
        Form1.SendMessage(WindowHandle, DirectCast(&H202, IntPtr), IntPtr.Zero, DirectCast(num, IntPtr))
    End Sub 
```

此示例将鼠标单击发送到最小化的应用程序 (DirectX)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T21:12:11.127

你不需要演员来调用 SendMessage：

```
SendMessage(WindowHandle, WM_LBUTTONDOWN, 0, MakeLong(X, Y));
SendMessage(WindowHandle, WM_LBUTTONUP, 0, MakeLong(X, Y)); 
```

对于它的价值，您的 VB.net 代码错误地将 SendMessage 的第二个参数声明为 IntPtr。它应该是一个无符号的 32 位整数。

如果您确实需要在 Delphi 中实现强制转换，从一种类型到另一种类型，您有两种选择。未经检查的演员表，

```
X := SomeType(Y); 
```

它将 Y 转换为 SomeType 类型而无需运行时检查。或检查演员表，

```
X := Y as SomeClass; 
```

这将引发异常是 Y 不是 SomeClass。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-19T21:01:39.157

Delphi 等价的`DirectCast`将是类型转换。

例如将引用变量转换为类`Form`：

```
VB:      DirectCast(myRef, Form)

Deplhi:  Form(myRef) 
```

# ruby - 为什么我得到一个找不到 Padrino 的命令？

> ID：12502658
> 
> 赞同：1
> 
> 时间：2012-09-19T20:47:14.853
> 
> 标签：ruby, sinatra, padrino, gemfile

编辑：这似乎适用于我的 CentOS 机器，但不适用于我的 Ubuntu 机器。

```
$ which gem
/usr/bin/gem
$ which padrino
/usr/bin/padrino
$ which padrino-gen
/usr/bin/padrino-gen 
```

我开始使用 Sinatra，但当我开始考虑一些管理/身份验证支持时，我被引导到了 Padrino。

问题如下。

我跑了：

```
sudo gem install padrino 
```

但是当我运行创建命令时，我遇到了一个找不到命令的问题：

```
$ padrino g project demo-app
padrino: command not found 
```

这似乎在我创建 heroku 应用程序的目录中有效，因为那里有一个 gemfile，所以我可以在命令`bundle exec`之前运行。`padrino`但是我不应该能够在没有 gemfile 的情况下创建一个 padrino 项目吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-01-26T20:19:17.143

我遇到了同样的问题，以下帮助了我：只需重新启动我的终端。

如果在您的情况下不可行，请尝试获取您的`.bashrc`/ `.bash_profile`。

*不幸的是，像rbenv*、*rvm*这样的环境管理器需要这一步。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T21:16:42.863

很奇怪，试试：

```
sudo gem install padrino-gen 
```

如果没有帮助尝试直接

```
padrino-gen project demo-app 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-20T13:49:40.337

这在 Ubuntu 11.04 中对我有用

```
# Setup Ubuntu LTS 10.4
sudo apt-get install ruby 
sudo apt-get install ruby-dev 
sudo apt-get install sqlite 
sudo apt-get install libsqlite3-dev
sudo apt-get install irb
sudo apt-get install rdoc
sudo apt-get install libopenssl-ruby
sudo apt-get install g++
wget http://rubyforge.org/frs/download.php/69365/rubygems-1.3.6.tgz
>tar zxvf rubygems-1.3.6.tgz 
cd rubygems-1.3.6
sudo ruby setup.rb
sudo gem1.8 install rake rspec padrino --no-ri --no-rdoc
padrino g project foo -d activerecord -b
padrino g admin
padrino rake ar:setup 
```

参考：[https ://gist.github.com/1016133](https://gist.github.com/1016133)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-04-30T17:14:33.543

我遇到了同样的问题，并通过从安装 RVM 时创建的 .bash_profile 文件复制此命令并将其添加到我的 .bashrc 的末尾来修复它：

```
source "$HOME/.rvm/scripts/rvm" 
```

# jquery - 使用具有外部站点和 JQuery 事件的 iframe

> ID：12502661
> 
> 赞同：1
> 
> 时间：2012-09-19T20:47:28.160
> 
> 标签：jquery, html, iframe, external

我读了很多东西，我不确定这是否可以做到，每个人对此都有不同的方法。

我有一个与第三个合作伙伴网站链接的网站，甚至通过安全句柄，如果用户没有登录我的网站，第三个合作伙伴网站将不允许用户登录。此评论的提示是无法更改第三个合作伙伴上的任何单行代码。

另一方面，我在我的网站上有一个包含两件事的 html：

1.  与`<iframe>`第三个合作伙伴站点。
2.  一个`<div>`在`position:absolute`iframe 上工作的指南，就像“现在点击这里，现在去那里”。

到目前为止一切顺利，我还使用以下 JQuery 脚本将 iframe 高度调整为供应商文档：

```
<script type="text/javascript">
function adjustmyiframe() {
var theFrame = $('#iFrameToAdjust', parent.document.body);
theFrame.height($(document.body).height() + 100);
}
</script> 
```

我的 iframe 是：

```
<iframe 
id="iFrameToAdjust" 
onload="adjustmyiframe();"
width="100%"
height="100%" name="myiframe" frameborder="1" vspace="0" hspace="0"
marginwidth="0" marginheight="0" scrolling="no" noresize

 src="http://externalsite"></iframe> 
```

再说一次，到目前为止一切都很好。但是当用户点击 iframe 内的链接时，供应商网站当然会重新加载并具有不同的高度，并且我的 iframe 不会再次调整。

所以我的问题是：

*   每次供应商网站调整高度或加载新页面时，我可以自动调整 iframe 高度吗？我该怎么做？
*   计时器选项的性能真的很差吗？

谢谢和亲切的问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T20:51:09.980

在这种情况下，最好避免事件侦听并使用递归轮询它`setTimeout`

```
function adjustmyiframe() {
    var theFrame = $('#iFrameToAdjust', parent.document.body);
    theFrame.height($(document.body).height() + 100);
    setTimeout(adjustmyiframe, 1000); // check again in 1 second.
} 
```

# java - 用于管理由不同控制器在 http 会话中设置/修改/使用的信息的设计模式？

> ID：12502663
> 
> 赞同：1
> 
> 时间：2012-09-19T20:47:29.753
> 
> 标签：java, design-patterns, controller, httpsession

**这个“问题”的常用方法（或设计模式）是什么：**

1.  我在 Web 应用程序中有很多控制器（准确地说是 JAVA 中的 struts 操作）。
2.  一些控制器在用户会话中设置变量。
3.  一些控制器使用这些变量，删除它们，修改它们等等......

这很混乱，因为很难知道谁设置了什么，在什么条件下，在哪里改变......

我应该使用调解员模式： [http ://en.wikipedia.org/wiki/Mediator_pattern](http://en.wikipedia.org/wiki/Mediator_pattern)

或者像这样的外观模式（c# 中的示例）： http: [//foxsys.blogspot.ca/2007/01/session-facade-aspnet-c.html](http://foxsys.blogspot.ca/2007/01/session-facade-aspnet-c.html)

或者是其他东西？

* * *

**变量的工作流程示例及其混乱程度：**

1.  用户选择了喜欢的产品。ChooseProductController 设置会话中首选产品的 id

2.  用户创建一个帐户： CreateAccountController 检查首选产品是否在会话中。如果是这种情况，它会在 DB 中创建具有此 ID 的帐户

3.  用户已登录。 LoginController 检查首选产品是否在会话中。如果它与创建帐户时数据库中的不同，则视图需要显示一条消息，要求用户选择首选产品。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T21:30:57.520

第一个建议：尽可能少地使用会话。尝试仅将其用于生命周期与会话生命周期相同的事物，并且不能轻松或足够快地从数据库中检索。

第二个建议：不要直接使用会话。将对会话的访问封装在一个或几个专用类中（就像您对数据库所做的那样，除了会话是内存数据库）。而不是做

```
Product preferredProduct = (Product) session.getAttribute("preferredProduct"); 
```

，做类似的事情

```
SessionStore.getInstance(session).getPreferredProduct(); 
```

这更具可读性，更不容易出错，并且允许在所有代码库中轻松找到首选产品的获取或设置。

# xml - xsl：如何翻译或替换字符串？

> ID：12502665
> 
> 赞同：2
> 
> 时间：2012-09-19T20:47:51.860
> 
> 标签：xml, string, xslt, replace, translate

我的 xsl 变量：

```
<xsl:variable name="string">Satur - Sun - Mon - Tues - Wednes - Thurs - Fri</xsl:variable> 
```

我需要从以下位置翻译或替换`string`变量数据：

```
Satur - Sun - Mon - Tues - Wednes - Thurs - Fri 
```

**所以，输出应该是这样的：**

```
Saturday - Sunday - Monday - Tuesday - Wednesday - Thursday - Friday 
```

...................................

@Mads Hansen
，我是新手，`xsl`我`xml`尝试了您的代码，但它不起作用
`100%`，这是错误的

**我的 xsl 文件：**

```
 <xsl:variable name="string">Satur - Sun - Mon - Tues - Wednes - Thurs - Fri</xsl:variable>
    <xsl:template match="/">
        <html>
            <body>
                <h2>result: </h2>
                <xsl:value-of 
                    select="for $token in tokenize($string, '\s-\s') 
                            return(
                                document('')/*/config/replacement[find[.=$token]]/replace,             
                                $token
                            )[1]" 
                    separator=" - "
                />
            </body>
        </html>
    </xsl:template>

</xsl:stylesheet> 
```

**我的 xml 文件：**

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<?xml-stylesheet type="text/xsl" href="index.xsl"?>
    <config>
       <replacement>
            <find>Satur</find>
            <replace>Saturday</replace>
        </replacement>
        <replacement>
            <find>Sun</find>
            <replace>Sunday</replace>
        </replacement>
        <replacement>
            <find>Mon</find>
            <replace>Monday</replace>
        </replacement>
        <replacement>
            <find>Tues</find>
            <replace>Tuesday</replace>
        </replacement>
        <replacement>
            <find>Wednes</find>
            <replace>Wednesday</replace>
        </replacement>
        <replacement>
            <find>Thurs</find>
            <replace>Thursday</replace>
        </replacement>
        <replacement>
            <find>Fri</find>
            <replace>Friday</replace>
        </replacement>
    </config> 
```

**我的代码有什么问题？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-20T03:16:29.277

**一、XPath 2.0（XSLT 2.0）解决方案**：

**使用以下 XPath 2.0 one-liner**：

```
concat(replace(.,'\s+-\s*', 'day - '), 'day') 
```

**基于 XSLT 的验证**：

```
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output method="text"/>

 <xsl:template match="/*">
   <xsl:sequence select="concat(replace(.,'\s+-\s*', 'day - '), 'day')"/>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于以下 XML 文档时：**

```
<t>Satur - Sun - Mon - Tues - Wednes - Thurs - Fri</t> 
```

**产生了想要的正确结果**：

```
Saturday - Sunday - Monday - Tuesday - Wednesday - Thursday - Friday 
```

* * *

**二、XSLT 1.0 解决方案：**

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="text"/>

 <xsl:template match="/*">
      <xsl:call-template name="replace">
       <xsl:with-param name="pS" select=
       "concat(normalize-space(translate(., '-', ' ')), 'day')"/>
     </xsl:call-template>
 </xsl:template>

 <xsl:template name="replace">
  <xsl:param name="pS"/>
  <xsl:param name="pTarget" select="' '"/>
  <xsl:param name="pReplacement" select="'day - '"/>

  <xsl:if test="$pS">
   <xsl:value-of select="substring-before(concat($pS,$pTarget), $pTarget)"/>
   <xsl:if test="contains($pS, $pTarget)">
     <xsl:value-of select="$pReplacement"/>
   </xsl:if>
   <xsl:call-template name="replace">
     <xsl:with-param name="pS" select="substring-after($pS, $pTarget)"/>
     <xsl:with-param name="pTarget" select="$pTarget"/>
     <xsl:with-param name="pReplacement" select="$pReplacement"/>
   </xsl:call-template>
  </xsl:if>
 </xsl:template>
</xsl:stylesheet> 
```

**当将此转换应用于同一个 XML 文档（上图）时，会产生相同的所需、正确的结果**：

```
Saturday - Sunday - Monday - Tuesday - Wednesday - Thursday - Friday 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-20T01:35:37.263

@Mads 答案的变体：

```
<xsl:template match="/">
  <xsl:value-of 
     select="for $token in tokenize($string, '\s-\s') 
        return concat($token, 'day')"
     separator=" - " />
</xsl:template> 
```

然后你可以省略`<my:config>`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-20T00:44:20.693

**XSLT 2.0 解决方案：**

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
    version="2.0"
    xmlns:my="http://stackoverflow.com/questions/12502665/xsl-how-to-translate-or-replace-string">
    <xsl:output indent="yes"/>

    <xsl:variable name="string">Satur - Sun - Mon - Tues - Wednes - Thurs - Fri</xsl:variable>

    <my:config>
        <replacement>
            <find>Satur</find>
            <replace>Saturday</replace>
        </replacement>
        <replacement>
            <find>Sun</find>
            <replace>Sunday</replace>
        </replacement>
        <replacement>
            <find>Mon</find>
            <replace>Monday</replace>
        </replacement>
        <replacement>
            <find>Tues</find>
            <replace>Tuesday</replace>
        </replacement>
        <replacement>
            <find>Wednes</find>
            <replace>Wednesday</replace>
        </replacement>
        <replacement>
            <find>Thurs</find>
            <replace>Thursday</replace>
        </replacement>
        <replacement>
            <find>Fri</find>
            <replace>Friday</replace>
        </replacement>
    </my:config>

    <xsl:template match="/">
        <xsl:value-of 
              select="for $token in tokenize($string, '\s-\s') 
                        return
                         (
                          document('')/*/my:config/replacement[find[.=$token]]/replace,             
                          $token
                         )[1]" 
              separator=" - " />
    </xsl:template>

</xsl:stylesheet> 
```

# java - 正则表达式解析java中的字符串

> ID：12502668
> 
> 赞同：-5
> 
> 时间：2012-09-19T20:48:08.090
> 
> 标签：java, regex

我正在用java编写一个简单的正则表达式，由于某些原因我的正则表达式不起作用。

我想要实现的是解析一个字符串，

*   以数字 9 开头
*   正好有 10 位数字（包括前缀 9）

我的正则表达式是`(^9\\d[0-9]{10})`，我想以 91234567890 为例进行解析。但它不起作用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-19T20:49:56.887

您不应该逃避`[`（因为这使您的正则表达式期望在`[`之后有文字`9`）。

另外，1 + 10 = 11，所以你需要降低量词。

最后，使用字符串结尾锚`$`来确保在第 10 位之后没有其他字符出现：

```
^9[0-9]{9}$ 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-19T20:50:58.217

```
9[0-9]{9} 
```

应该管用。它查找数字 9，然后再查找 9 个数字

# postgresql - 如何判断 Postgres 中的记录是否已更改

> ID：12502669
> 
> 赞同：5
> 
> 时间：2012-09-19T20:48:10.753
> 
> 标签：postgresql, file-io, postgresql-9.1, upsert, postgresql-copy

我有一些“upsert”类型的问题......但是，我想把它扔在那里，因为它与我在 stackoverflow 上读到的任何内容都有点不同。

基本问题。

我正在从 mysql 迁移到 PostgreSQL 9.1.5（托管在 Heroku 上）。作为其中的一部分，我需要每天导入多个 CSV 文件。有些数据是销售信息，几乎可以保证是新的，需要插入。但是，数据的其他部分几乎可以保证是相同的。例如，csv 文件（注意复数）将包含 POS（销售点）信息。这很少改变（很可能只是通过添加）。然后是产品信息。大约有 10,000 种产品（绝大多数将保持不变，但可以同时进行添加和更新）。

最后一项（但很重要）是我要求能够为任何给定项目提供审计跟踪/信息。例如，如果我添加了一条新的 POS 记录，我需要能够将其追溯到它所在的文件。如果我更改了 UPC 代码或产品描述，那么我需要能够追溯它到更改来自的导入（和文件）。

我正在考虑的解决方案。

由于数据是通过 CSV 提供给我的，因此我正在考虑 COPY 将是最佳/最快方式的想法。文件中的数据结构并不完全是我在数据库中的结构（即最终目的地）。因此，我将它们复制到与 CSV 匹配的暂存模式中的表中（注意：每个数据源一个模式）。暂存模式中的表将有一个前插入行触发器。这些触发器可以决定如何处理数据（插入、更新或忽略）。

对于最有可能包含新数据的表，它会先尝试插入。如果记录已经存在，那么它将返回 NULL（并停止插入临时表）。对于很少更改的表，那么它将查询该表并查看是否找到记录。如果是，那么我需要一种方法来查看是否有任何字段被更改。（因为请记住，我需要证明记录是通过从文件 y 中导入 x 来修改的）我显然可以将代码样板化并测试每一列。但是，正在寻找比这更“雄辩”和更易于维护的东西。

在某种程度上，我正在做的是将导入系统与审计跟踪系统结合起来。因此，在研究审计跟踪时，我查看了以下[wiki.postgresql.org](http://wiki.postgresql.org/wiki/Audit_trigger_91plus)文章。看起来 hstore 可能是获取更改的好方法（并且能够轻松忽略表中不重要的某些列 - 例如“last_modified”）

我大约有 90% 的把握这一切都会奏效......我已经创建了一些测试表等并使用它。

我的问题？

是一种更好、更易于维护的方式来完成从 10K 中查找可能需要更改数据库的 3 条记录的任务。我当然可以编写一个 python 脚本（或其他东西）来读取文件并试图弄清楚如何处理每条记录，但这感觉效率非常低，并且会导致大量往返。

最后的几件事：

1.  我无法控制输入文件。如果他们只向我发送增量，我会很高兴，但他们没有，这完全超出了我的控制或影响。
2.  他的系统正在增长，可能会添加新的数据源，这将大大增加正在处理的数据量（所以，我正在努力保持高效）
3.  我知道这不是一个好的、简单的 SO 问题（例如“如何在 python 中对列表进行排序”），但我相信 SO 的一大优点是您可以提出棘手的问题，人们会分享他们对解决它的最好方法是。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-19T21:38:59.060

我有很多类似的操作。我所做的是`COPY`临时**登台表**：

```
CREATE TEMP TABLE target_tmp AS
SELECT * FROM target_tbl LIMIT 0;  -- only copy structure, no data

COPY target_tmp FROM '/path/to/target.csv'; 
```

为了**性能**，运行`ANALYZE`-temp。表不被 autovacuum 分析！

```
ANALYZE target_tmp; 
```

同样为了性能，甚至可能在临时表上创建一个或两个索引，或者如果数据允许，则添加一个主键。

```
ALTER TABLE ADD CONSTRAINT target_tmp_pkey PRIMARY KEY(target_id); 
```

您不需要小型进口的性能材料。

然后使用完整范围的 SQL 命令来消化新数据。
例如，如果目标表的主键是`target_id`..

也许**`DELETE`**什么已经不存在了？

```
DELETE FROM target_tbl t
WHERE NOT EXISTS (
   SELECT 1 FROM target_tmp t1
   WHERE  t1.target_id = t.target_id
); 
```

那么**`UPDATE`**已经存在的东西：

```
UPDATE target_tbl t
SET    col1 = t1.col1
FROM   target_tmp t1
WHERE  t.target_id = t1.target_id 
```

为避免*空*更新，只需添加：

```
...
AND    col1 IS DISTINCT FROM t1.col1; -- repeat for relevant columns 
```

或者，如果整行相关：

```
...
AND    t IS DISTINCT FROM t1;         -- check the whole row 
```

然后**`INSERT`**有什么新的：

```
INSERT INTO target_tbl(target_id, col1)
SELECT t1.target_id, t1.col1
FROM   target_tmp t1
LEFT   JOIN target_tbl t USING (target_id)
WHERE  t.target_id IS NULL; 
```

如果您的会话继续进行清理（临时表在会话结束时自动删除）：

```
DROP TABLE target_tmp; 
```

或使用`ON COMMIT DROP`或与[`CREATE TEMP TABLE`](http://www.postgresql.org/docs/current/interactive/sql-createtable.html).
[代码未经测试，但可以在任何现代版本的 PostgreSQL 中工作，除了拼写错误。]

# php - CodeIgniter - 验证提交表单之外的数据？

> ID：12502671
> 
> 赞同：1
> 
> 时间：2012-09-19T20:48:13.437
> 
> 标签：php, forms, codeigniter, validation

我如何验证我没有从表单中得到的东西。我想验证我的变量，我希望这个规则是 is_uniqe() 来检查重复项。

我尝试将 $rules 数组中的规则设置为 array('field' => $this->characterNAME, 'rules' => 'is_unique[members.char_name]) 但没有效果我尝试在其上调用 is_unique()拥有但没有效果，我尝试将变量分配给 $_POST['charNAME'] = $this->characterNAME; 然后将其传递给 set_rules() 但没有效果。

如何验证我的变量？

我的代码：

```
<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');

class Registration extends CI_Controller {

var $characterNAME = "";
var $characterCORP = "";
var $characterALLY = "";
var $characterJDAT = "";

function __construct() {
    parent::__construct();
    $this->load->helper('form');
    $this->load->library('form_validation');
    $this->load->model('Registration_model', 'reg');
}

public function index()
{

    $this->load->view('registration_view');
}

function insert()
{

    $rules = array(
        array(
            'field' => 'username',
            'label' => 'Username',
            'rules' => 'required|min_length[6]|max_length[250]|is_unique[members.username]'
            ),
        array(
            'field' => 'password',
            'label' => 'Password',
            'rules' => 'required|min_length[6]|max_length[250]|md5'
            ),
        array(
            'field' => 'apiid',
            'label' => 'apiid',
            'rules' => 'required|integer|min_length[6]|max_length[250]|callback_api_check[' . $this->input->post('apikey') . ']'
            ),
        array(
            'field' => 'apikey',
            'label' => 'apikey',
            'rules' => 'required|min_length[6]|max_length[255]'
            ),
        );

    $_POST['charNAME'] = $this->characterNAME;
    $this->form_validation->set_rules('charNAME', 'CharacterName', 'is_unique[members.char_name]');
    $this->form_validation->set_rules($rules);

    if($this->form_validation->run() == FALSE) 
    {
        $this->load->view('registration_view'); 
    } else {

        // PROCESS REGISTRATION 
        $this->reg->add_user($_POST['username'], $_POST['password'], $_POST['apiid'], $_POST['apikey'], $this->characterNAME, $this->characterCORP, $this->characterALLY, $this->characterJDAT);
        // REDIRECT
        $this->load->view('registration_done');
    }
}

function api_check($apiid, $apikey) 
{
    $url = 'http://api.eveonline.com/account/Characters.xml.aspx?keyID='.$apiid.'&vCode='.$apikey;

    $xml = new DOMDocument();
    $xml->load($url);

    $chars = $xml->getElementsByTagName('row');

    foreach ($chars as $character) 
    {
        $charid = $character->attributes;
        $curl = 'http://api.eveonline.com/eve/CharacterInfo.xml.aspx?keyID='. $apiid . '&vCode='.$apikey . '&characterID=' . $charid->item(1)->nodeValue;

        $cxml = new DOMDocument();
        $cxml->load($curl);

        $corp = $cxml->getElementsByTagName("corporation");
        $ally = $cxml->getElementsByTagName("alliance");
        $char = $cxml->getElementsByTagName("characterName");
        $jdat = $cxml->getElementsByTagName("corporationDate");

        // Check database instead

        if($this->reg->validate_entity($corp->item(0)->nodeValue) || $this->reg->validate_entity($ally->item(0)->nodeValue)) 
        {
            $this->characterNAME = $char->item(0)->nodeValue;
            $this->characterCORP = $corp->item(0)->nodeValue;
            $this->characterALLY = $ally->item(0)->nodeValue;
            $this->characterJDAT = $jdat->item(0)->nodeValue;
            return true;
        }

    }
    $this->form_validation->set_message('api_check','None of the characters on this account are allowed to join.');
    return false;
}

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T21:10:00.947

您可以通过（示例）直接调用 is_unique 函数来验证您的表单输入不是重复的：

$this->form_validation->is_unique($email, 'users.email');

这将返回一个布尔值 true/false。True = 是唯一的——在这种情况下

因此，您可以将其放在 if() 中并以这种方式检查...

希望这可以帮助

# azure - 可以使用来自私有 Azure blob 存储容器的 ClickOnce 部署吗？

> ID：12502674
> 
> 赞同：2
> 
> 时间：2012-09-19T20:48:41.347
> 
> 标签：azure, clickonce, azure-storage, azure-blob-storage

我已经设置了一个公开的 blob 存储容器。然后我将 ClickOnce 应用程序放入该容器中，它工作正常。有关于将存储容器私有化以提高安全性的讨论。

我读过的大部分内容都说这目前是不可能的。想把它扔给 StackOverflow 社区。

是否可以将 ClickOnce 应用程序设置为在私有存储容器中工作。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-20T19:52:31.103

仅仅通过将容器设置为私有并使用 URL 作为 clickonce 应用程序的安装点是行不通的。因为您需要用户可以访问发布 URL，并且私有容器不会使 URL 可公开访问。

如果我们谈论“是否可能”，那在技术上肯定是可能的。对于您的私有容器，如果您使用 SAS（共享访问签名）和 ACS 服务，您可以使私有容器在 X 时间内可供某些用途访问。在有效期间，特定用户可以访问 URL，并且在时间到期后，URL 将被锁定，因为带来了私有容器。这肯定是一个复杂的过程，但要使答案完整，如果必须满足您的要求，它肯定可以完成。

# c# - C# Windows 7 块输入

> ID：12502676
> 
> 赞同：1
> 
> 时间：2012-09-19T20:48:48.480
> 
> 标签：c#, windows-7, service

我使用 C# 在 Win7 中创建了一个服务。在该服务中，我想使用 BlockInput 功能，在 Win7 中它似乎需要管理员。

我在代码中将服务处理器安装程序、帐户、用户名和密码设置为管理员帐户，但 BlockInput 不起作用。注意：在服务属性/登录选项卡下已正确设置。

然后我为我的服务添加了一个清单并将requestedExecutionLevel 设置为“requireAdministrator”。然而 BlockInput 仍然不想工作。

我尝试将 BlockInput 向下移动到客户端级别，然后移动到客户端包装器，但它仍然不想工作。

没有想法了……有什么建议吗？

从这里开始编辑：

这是我的清单（或其中的一部分，抱歉格式很糟糕） `<assemblyIdentity version="1.0.0.0" name="BlockInputService.app"/>` `<trustInfo xmlns="urn:schemas-microsoft-com:asm.v2">` `<security>` `<requestedPrivileges xmlns="urn:schemas-microsoft-com:asm.v3">` `<requestedExecutionLevel level="requireAdministrator" uiAccess="false" />` `</requestedPrivileges>` `</security>` `</trustInfo>`

```
 namespace BlockInputService
    {
       [ServiceContract(Namespace = "http://BlockInputService")]
       public interface IBlockInputTest
       {
          [OperationContract]
          void BlockInputMethod();
       }

       public class BlockInputTest : IBlockInputTest
       {
          private const string SOURCE = "BlockInputService";
          private const string LOGNAME = "Application";

          [return: MarshalAs(UnmanagedType.Bool)]
          [DllImport("user32.dll", CharSet = CharSet.Auto, ExactSpelling = true)]
          public static extern bool BlockInput([In, MarshalAs(UnmanagedType.Bool)] bool fBlockIt);

          public void BlockInputMethod()
          {
             if (!EventLog.SourceExists(SOURCE))
             {
                EventLog.CreateEventSource(SOURCE, LOGNAME);
             }

             try
             {
                bool flag = BlockInput(true);
                EventLog.WriteEntry(SOURCE, "BlockInput(true) returned: " + flag);

                EventLog.WriteEntry(SOURCE, "Sleep for 5 sec");
                Thread.Sleep(5000);
             }
             catch (Exception ex)
             {
                EventLog.WriteEntry(SOURCE, ex.Message);
             }
             finally
             {
                bool flag = BlockInput(false);
                EventLog.WriteEntry(SOURCE, "BlockInput(false) returned: " + flag);
             }
          }
       }
    } 

```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-22T14:08:29.797

我继续前进并使用 SetWindowsHookEx 来捕获 WH_KEYBOARD_LL 和 WH_MOUSE_LL 事件。

我尝试了所有我能想到的让 BlockInput 工作的方法。我仍然认为我只是配置了我的服务错误或其他什么，但我没有时间再担心它了。

谢谢。

# c# - 使用 StructureMap 进行 C# 依赖注入

> ID：12502677
> 
> 赞同：2
> 
> 时间：2012-09-19T20:48:50.880
> 
> 标签：c#, asp.net-mvc-3, structuremap

我们一直在使用 C# 在我们的 ASP.Net MvC 3 Web 应用程序中使用 StructureMap 进行依赖注入，但是今天我无法将所需的类型注入到我构建的 C# CustomResolver 中。

这是我们的 StructureMapInitialization.cs 文件中的代码：

```
namespace UI.DependencyResolution
{
/// <summary>
/// Class Structure Map IOC intialization
/// </summary>
public static class StructureMapIocInitialization
{
    /// <summary>
    /// Initialize Method for Structure Map IOC Initialization
    /// </summary>
    /// <returns>an IContainer for Services and Repository</returns>
    public static IContainer Initialize()
    {
        ObjectFactory.Initialize(cfg =>
        {
            cfg.Scan(scan =>
            {
                scan.Assembly("Infrastructure");
                scan.Assembly("Core");
                scan.WithDefaultConventions();
                scan.ConnectImplementationsToTypesClosing(typeof(IAlertGenerator<>));
                scan.ConnectImplementationsToTypesClosing(typeof(IValidationRule<>));
            });

            cfg.For<IFilterProvider>().Use<StructureMapFilterProvider>();
            cfg.For<IControllerActivator>().Use<StructureMapControllerActivator>();

            cfg.SetAllProperties(c =>
            {
                c.WithAnyTypeFromNamespaceContainingType<ICustomerRepository>();
                c.WithAnyTypeFromNamespaceContainingType<IMachineRepository>();
                c.WithAnyTypeFromNamespaceContainingType<ICurrentUserService>();
                c.WithAnyTypeFromNamespaceContainingType<ICircuitRegistrationRepository>();
                c.WithAnyTypeFromNamespaceContainingType<IWorkflowRequestInformationRepository>();
                c.WithAnyTypeFromNamespaceContainingType<IEnumerable<IAlertGenerator<Customer>>>();

            });

        });

        return ObjectFactory.Container;
    }
} 
```

}

这是我们 AutoMapperProfile.cs 文件中的代码片段：

```
Mapper.CreateMap<AbstractOrganization, DashboardDetails>()
    .ForMember(dashboard => dashboard.AlertsDictionary,
    member => member.ResolveUsing<OrganizationAlertResolver>()
    .ConstructedBy(() => new OrganizationAlertResolver(
        ObjectFactory.GetInstance<ICustomerRepository>(), ObjectFactory.GetInstance<IEnumerable<IAlertGenerator<Customer>>>()))); 
```

这是我的 CustomResolver 代码：

```
namespace UI.Models.CustomResolvers
{
    public class OrganizationAlertResolver : ValueResolver<Organization, Dictionary<string,   string>>
    {
        private readonly ICustomerRepository _customerRepository;

        /// <summary>
        /// Storage for customer alert generator.
        /// </summary>
        private readonly IEnumerable<IAlertGenerator<Customer>> _customerAlertGenerators;

        public OrganizationAlertResolver(ICustomerRepository customerRepository, 
            IEnumerable<IAlertGenerator<Customer>> customerAlertGenerators)
        {
            _customerRepository = customerRepository;
            _customerAlertGenerators = customerAlertGenerators;
        }

        protected override Dictionary<string,string> ResolveCore(Organization organization)
        {
            var customers = _customerRepository.GetActiveCustomersByOrgNumber(organization.OrgNumber);
            foreach (var generator in _customerAlertGenerators)
            {
                generator.PopulateAlerts(customers);
            }

        Dictionary<string, string> alertsDictionary = new Dictionary<string, string>();

            foreach (var customer in customers)
            {
                foreach (var alert in customer.Alerts)
                {
                    if(alertsDictionary.ContainsKey(alert.ToString()))
                    {
                        alertsDictionary[alert.ToString()] = alert.Message;
                    }
                    else
                    {
                        alertsDictionary.Add(alert.ToString(), alert.Message);
                    }
                }
            }
            return alertsDictionary;
        }
    }
} 
```

因此，我正在尝试使用 StructureMap 将 Customer 类型的 IAlertGenerator 的 IEnumerable 注入到我的 CustomResolver 中，但是我得到一个 StructureMap 202 异常，说没有找到该类型的默认实例，即使我在其中创建了它的实例StructureMap 初始化文件中的最后一个条目。

这是我运行它时收到的错误消息的副本：

> StructureMap 异常代码：202 没有为 PluginFamily System.Collections.Generic.IEnumerable 定义默认实例`1[[Core.Domain.Alerts.IAlertGenerator`1[[Core.Domain.Model.Customer，Core，Version=1.0.0.0，Culture=neutral，PublicKeyToken=null]]，Core，Version =1.0.0.0，文化=中性，PublicKeyToken=null]]，mscorlib，版本=4.0.0.0，文化=中性，PublicKeyToken=b77a5c561934e089

任何人都可以提供有关如何解决此问题的建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T17:01:11.873

除了[Mike 指出的，](https://stackoverflow.com/a/12583061/61654)这个问题可能是由多个实例关闭类型引起的。根据您的代码：

```
ObjectFactory.GetInstance<IEnumerable<IAlertGenerator<Customer>>>() 
```

我猜这就是正在发生的事情。

它应该像将上面的内容更改为一样简单：

```
ObjectFactory.GetAllInstances<IAlertGenerator<Customer>>() 
```

这将找到所有关闭的实例`IAlertGenerator<Customer>`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T12:34:33.840

我不是 100% 确定这里发生了什么，但是当我收到此错误时，我在 StructureMap 中看到了两个不同的问题。第一个是被实例化的类需要一个无参数的构造函数，所以`Customer`可能没有。

第二个是即使存在无参数构造函数，StructureMap 也会尝试使用最完全限定的构造函数，我已经在`SqlConnection`. 以下是如何解决此问题的示例。

```
x.ForRequestedType<IDbConnection>()
    .CacheBy(InstanceScope.Singleton)
    .TheDefault.Is.ConstructedBy(ctor => new SqlConnection("connection string")); 
```

请注意，我必须使用`.TheDefault.Is.ConstructedBy`构造来让它使用正确的构造函数。在诉诸于此之前，我曾尝试使用`.Ctor`构造传递参数，但无法使其正常工作。

我希望这有助于为您指明正确的方向。

# c# - C# 引用另一个 .cs（以过程/oo 方式拆分代码的方法）

> ID：12502683
> 
> 赞同：0
> 
> 时间：2012-09-19T20:49:24.577
> 
> 标签：c#, visual-studio-2010, class

我来自一个程序世界，所以请耐心等待。我不确定“正确”的术语。我得到了函数——类不多（我收集它们是蓝图，但我还不能说服自己使用它们，可能是因为我不明白它们有多大帮助）

我正在尝试创建一个 C# 控制台应用程序（在 VS2010 中）。它具有程序性质（从顶部开始，可能每隔一段时间引用一个函数或尝试捕获然后退出）。我的问题是应用程序会有 4 个部分 - 定义 sql 字符串的部分、连接到数据库的部分、执行 sql 语句的部分以及根据结果进行额外计算的部分。

我正在尝试确定一种将这些代码块拆分为我可以调用的不同文件的方法 - 基本上保持默认的“program.cs”不会过于庞大。我的最新代码可以滚动浏览以挑选项目。

建议？

（我知道这是非常主观的）

[添加]

我的代码结构现在看起来类似于以下 - 注意，[[[[[]]]]] 是我所说的块：

```
 [[[[[
        string sqlQueryFetchCalls = "sql lives here";
        ... and more strings for sql... and more... and more
        ]]]]]

        SqlConnection mssqlConnection = new SqlConnection(params);
        try{
            mssqlConnection.Open();
            System.Console.WriteLine("connection opened");}
        catch (Exception errorVar){
            output.Text = errorVar.ToString();}

        [[[[[
        SqlDataReader results = null;
        SqlCommand exec_sqlQueryFetchCalls = new SqlCommand(sqlQueryFetchCalls, mssqlConnection);
        results = exec_sqlQueryFetchCalls.ExecuteReader();

        while (results.Read())
        {
            // do something
            }results.Close();

        ... again... again ... again... again, though the resulting actions are quite different each time ]]]]]

        mssqlConnection.Close(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T20:53:10.390

虽然这不是安排代码的最佳方式，但可以做到。

如果您正在使用`static`方法，只需确保所有方法都在同一个命名空间中。然后他们都将能够看到对方。

您可以使用单个类并使用`partial`关键字将定义拆分到多个文件中。

但是，我建议您阅读更多关于类及其组织方式的内容，因为如果使用它们，您会发现管理代码要容易得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T21:05:15.290

类通常意味着“名词”

您的“部分”听起来像（静态？）方法（即函数）。

您可以使用类来表示来自 SQL 数据库的数据。一个典型的例子是，例如，如果您在数据库中存储有关人员的数据，那么通常您可能有一个名为 Person 的类。您的班级中可能有属性，例如 Age 和 Name。

每行将代表您的类的一个实例。

使用类只是一种抽象，使用类为聚会带来了一大堆东西，但其中最明显的一个是它使您的代码易于阅读，请考虑这个简单的示例

```
// Remember Person would be a class you defined somewhere else

// Get a list of people from the database
List<Person> people = GetPeopleFromDatabase();

 // do something to each row in the database .. or person in your List<>
foreach (person in people)
 {
    Console.WriteLine(person.Name  + " is " person.Age + " years old");
 } 
```

这比理解容易得多

```
 results = exec_sqlQueryFetchCalls.ExecuteReader();

    while (results.Read())
    {
         Console.WriteLine(row[0]  + " is " + row[2] + " years old");
    } 
```

# actionscript-3 - as3 if else, min max value

> ID：12502685
> 
> 赞同：1
> 
> 时间：2012-09-19T20:49:36.630
> 
> 标签：actionscript-3

我希望用户在文本字段 (INPUTFIELD) 中填写 1-350 之间的数字。通过 XML，我想在另一个文本字段 (OUTPUFIELD) 中返回一个字符串。

我得到了 99% 的工作，但是在用户填写数字 0 或大于 350 后，我想在 OUTPUFIELD 中返回一条消息。

**我没有让这个工作，我收到消息：**

```
TypeError: Error #2007: Parameter text must be non-null.
    at flash.text::TextField/set text()
    at MethodInfo-2() 
```

**我的代码如下：**

```
this.stage.addEventListener(KeyboardEvent.KEY_DOWN, keyDownHandler);
function keyDownHandler(event : KeyboardEvent):void {
    if (event.keyCode == Keyboard.ENTER) { 
        if (inputField.text > "0") {
               outputField.text = xmlData.prefix_list.country[Number(inputField.text)];
               outputField.setTextFormat(myTextFormat);
        } else {
               if (inputField.text > "350") {
                   outputField.text = "DOES NOT EXIST";
                   outputField.setTextFormat(myTextFormat);
               } 
        }
    }
} 
```

我在“if”条件中尝试了许多选项，例如只有几个：

```
if (inputField.text > "0" || inputField.text < "350")
if (inputField.text >= 0 && inputField.text =< 350)
if (inputField.text >= "0" && inputField.text =< "350") 
```

“其他”条件也是如此。

```
} else {
    if (inputField.text > "350") { 
```

也许有人可以指出我正确的方向。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T21:01:05.197

```
if (int(inputField.text) > 0 && int(inputField.text) < 350)    {
  outputField.text = xmlData.prefix_list.country[Number(inputField.text)];
  outputField.setTextFormat(myTextFormat);
} else {
  outputField.text = "DOES NOT EXIST";
  outputField.setTextFormat(myTextFormat);
} 
```

如果您使用整数，则必须将 value 转换为 int。

在 AS3 中的类型之间转换很容易。这是如何将字符串转换为数字的教程[http://www.trainingtutorials101.com/2011/01/actionscript-3-convert-strings-to.html](http://www.trainingtutorials101.com/2011/01/actionscript-3-convert-strings-to.html)

# xml - 根据特定 ID 和前面的属性计算 YTD 总计

> ID：12502688
> 
> 赞同：1
> 
> 时间：2012-09-19T20:49:40.203
> 
> 标签：xml, xslt

我正在尝试根据特定 ID 和 YTD 计算总数。我到处寻找，似乎无法找出解决方案。XML 文档与此类似：

```
<pay>
  <pay_year year="Year-2011">
    <paycheck date="Jun-20-2011">
      <hours>
        <hours_type HID="Reg" qty="38.75" pay="1115.25"/> 
      </hours>
    </paycheck>
    <paycheck date="Jul-05-2011">
      <hours>
        <hours_type HID="Reg" qty="76.21" pay="2193.60"/>
        <hours_type HID="Hol" qty="7.75" pay="223.07"/>
      </hours>
    </paycheck>
    <paycheck date="Jul-20-2011">
      <hours>
        <hours_type HID="Reg" qty="76.21" pay="2193.60"/>
        <hours_type HID="Sic" qty="7.75" pay="223.07"/>
      </hours>
    </paycheck>
  </pay_year>
</pay> 
```

我正在使用的 XSLT 是：

```
<xsl:template match="hours">
 <xsl:apply-templates select="hours_type">
   <xsl:sort order="descending" />
 </xsl:apply-templates>

<tr>
  <th class="sub" colspan="" align="justify">Subtotal / Totals YTD</th>
  <td class="sub"><xsl:value-of select="sum(hours_type/@qty)" /></td>
  <td class="sub"><xsl:value-of select="format-number(sum(preceding::paycheck/hours/hours_type/@qty) + sum(hours_type/@qty), '###,###.##')"/></td>
  <td class="sub">
    <xsl:value-of select="format-number(sum(hours_type/@pay), '$###,##0.00')" />
  </td>
  <td class="sub">
    <xsl:value-of select="format-number(sum(preceding::paycheck/hours/hours_type/@pay) + sum(hours_type/@pay), '$###,##0.00')"/>
  </td>
</tr>
</xsl:template>

<xsl:template match="hours_type">
<xsl:if test="position()=1">
<xsl:apply_templates select="@qty" />
<!--Not Sure how to make this work here -->
<xsl:apply_templates select="@pay" />
<!--Not Sure how to make this work here -->
</xsl:if>
<xsl:if test="position()=2">
<xsl:apply_templates select="@qty" />
<!--Not Sure how to make this work here -->
<xsl:apply_templates select="@pay" />
<!--Not Sure how to make this work here -->
</xsl:if>
<xsl:if test="position()=3">
<xsl:apply_templates select="@qty" />
<!--Not Sure how to make this work here -->
<xsl:apply_templates select="@pay" />
<!--Not Sure how to make this work here -->
</xsl:if>
</xsl:template>

<xsl:template match="@qty|@pay">
<td align="justify"><xsl:value-of select="." /></td>
</xsl:template> 
```

输出在 html 中看起来像这样：

```
Date---------Hours Type-----------Qty-----YTD-------Amount-----Pay YTD
Jun-20-2011--Reg------------------38.75---38.75-----1115.25----1115.25
Subtotal--------------------------38.78---38.75-----1115.25----1115.25

Jul-05-2011--Reg------------------76.21---114.96----2193.60----3308.85
-------------Hol------------------7.75----7.75------223.07-----223.07
Subtotal--------------------------83.96---122.71----2416.67----3531.92

Jul-20-2011--Reg------------------76.21---191.17----2193.60----5502.45
-------------Sic------------------7.75----7.75------223.07-----223.07
Subtotal--------------------------83.96---198.92----2416.67----5725.52 
```

我可以很好地获得 Subtotal 行，问题是我无法通过特定 ID 获得内联 YTD 总计。我可能会让这比现在更难。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T08:17:19.523

首先，对于您的小计行，您目前正在执行此操作

```
<xsl:value-of 
   select="format-number(sum(preceding::paycheck/hours/hours_type/@qty) 
   + sum(hours_type/@qty), '###,###.##')"/> 
```

这有几个问题。首先，您可能应该使用previous **-sibling**，而不是previous，否则如果它们出现在您的XML 中，它可能会选择前几年**。**其次，小计只需要汇总您正在查看的当前**薪水/小时数中存在****@HID属性的先前值。**

 **所以你需要有点害怕的表情

```
<xsl:value-of 
    select="format-number(sum(../preceding-sibling::paycheck/hours/hours_type
       [@HID=current()/hours_type/@HID]/@qty) 
       + sum(hours_type/@qty), '###,###.##')"/> 
```

同样，对于您的**hours_type**模板，您将使用previous **-sibling**进行总计

```
<xsl:value-of 
   select="@qty + sum(../../preceding-sibling::paycheck/hours/hours_type
     [@HID = current()/@HID]/@qty)" /> 
```

尝试以下 XSLT：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
   <xsl:output method="xml" indent="yes"/>

   <xsl:template match="pay_year">
      <table>
         <tr>
            <th>Date</th>
            <th>Type</th>
            <th>Qty</th>
            <th>Qty YTD</th>
            <th>Pay</th>
            <th>Pay YTD</th>
         </tr>
         <xsl:apply-templates select="paycheck/hours" />
      </table>
   </xsl:template>

   <xsl:template match="hours">
      <xsl:apply-templates select="hours_type">
         <xsl:sort order="descending"/>
      </xsl:apply-templates>

      <tr>
         <th class="sub" colspan="2" align="justify">Subtotal / Totals YTD</th>
         <td class="sub">
            <xsl:value-of select="format-number(sum(hours_type/@qty), '###,##0.00')"/>
         </td>
         <td class="sub">
            <xsl:value-of select="format-number(sum(../preceding-sibling::paycheck/hours/hours_type[@HID=current()/hours_type/@HID]/@qty) + sum(hours_type/@qty), '###,###.##')"/>
         </td>
         <td class="sub">
            <xsl:value-of select="format-number(sum(hours_type/@pay), '###,##0.00')"/>
         </td>
         <td class="sub">
            <xsl:value-of select="format-number(sum(../preceding-sibling::paycheck/hours/hours_type[@HID=current()/hours_type/@HID]/@pay) + sum(hours_type/@pay), '###,##0.00')"/>
         </td>
      </tr>
   </xsl:template>

   <xsl:template match="hours_type">
      <tr>
         <td>
            <xsl:value-of select="../../@date" />
         </td>
         <td>
            <xsl:value-of select="@HID" />
         </td>
         <xsl:apply-templates select="@qty"/><!--Not Sure how to make this work here -->
         <td align="justify">
            <xsl:value-of select="@qty + sum(../../preceding-sibling::paycheck/hours/hours_type[@HID = current()/@HID]/@qty)" />
         </td>
         <xsl:apply-templates select="@pay"/><!--Not Sure how to make this work here -->
         <td align="justify">
            <xsl:value-of select="@pay + sum(../../preceding-sibling::paycheck/hours/hours_type[@HID = current()/@HID]/@pay)" />
         </td>
      </tr>
   </xsl:template>

   <xsl:template match="@qty|@pay">
      <td align="justify">
         <xsl:value-of select="."/>
      </td>
   </xsl:template>
</xsl:stylesheet> 
```

应用于您的示例 XML 时，将输出以下内容

```
<table>
   <tr>
      <th>Date</th>
      <th>Type</th>
      <th>Qty</th>
      <th>Qty YTD</th>
      <th>Pay</th>
      <th>Pay YTD</th>
   </tr>
   <tr>
      <td>Jun-20-2011</td>
      <td>Reg</td>
      <td align="justify">38.75</td>
      <td align="justify">38.75</td>
      <td align="justify">1115.25</td>
      <td align="justify">1115.25</td>
   </tr>
   <tr>
      <th class="sub" colspan="2" align="justify">Subtotal / Totals YTD</th>
      <td class="sub">38.75</td>
      <td class="sub">38.75</td>
      <td class="sub">1,115.25</td>
      <td class="sub">1,115.25</td>
   </tr>
   <tr>
      <td>Jul-05-2011</td>
      <td>Reg</td>
      <td align="justify">76.21</td>
      <td align="justify">114.96</td>
      <td align="justify">2193.60</td>
      <td align="justify">3308.85</td>
   </tr>
   <tr>
      <td>Jul-05-2011</td>
      <td>Hol</td>
      <td align="justify">7.75</td>
      <td align="justify">7.75</td>
      <td align="justify">223.07</td>
      <td align="justify">223.07</td>
   </tr>
   <tr>
      <th class="sub" colspan="2" align="justify">Subtotal / Totals YTD</th>
      <td class="sub">83.96</td>
      <td class="sub">122.71</td>
      <td class="sub">2,416.67</td>
      <td class="sub">3,531.92</td>
   </tr>
   <tr>
      <td>Jul-20-2011</td>
      <td>Reg</td>
      <td align="justify">76.21</td>
      <td align="justify">191.17</td>
      <td align="justify">2193.60</td>
      <td align="justify">5502.45</td>
   </tr>
   <tr>
      <td>Jul-20-2011</td>
      <td>Sic</td>
      <td align="justify">7.75</td>
      <td align="justify">7.75</td>
      <td align="justify">223.07</td>
      <td align="justify">223.07</td>
   </tr>
   <tr>
      <th class="sub" colspan="2" align="justify">Subtotal / Totals YTD</th>
      <td class="sub">83.96</td>
      <td class="sub">198.92</td>
      <td class="sub">2,416.67</td>
      <td class="sub">5,725.52</td>
   </tr>
</table> 
```**

# python - 到 postgreSQL 模式的 URL 映射（使用 Route 53？）

> ID：12502690
> 
> 赞同：1
> 
> 时间：2012-09-19T20:49:51.173
> 
> 标签：python, django, schema, amazon-route53, django-postgresql

我正在使用多个 PostgreSQL 模式来提供数据分离和分段。有一个很好的教程关于如何做到这一点[here](http://blog.dyve.net/django-subdomains-and-postgresql-schemas)，但我不喜欢这种方法的一件事是它绝对依赖于URL来选择一个模式（所以，例如，如果我想运行一个本地测试服务器来测试某些东西，它自己将无法选择正确的模式）。

我还有其他选项可以根据 URL/源选择架构吗？亚马逊的 Route 53 在这里会有所帮助吗（因为我很可能会使用它）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T12:02:25.053

您链接到的博客文章不再存在，所以我不能确定这是否适用于您的问题，但在我看来，显而易见的答案是在架构和 URL 之间进行某种抽象，以便这些是不紧密耦合。然后可以使用测试配置来定向到适当的模式。

我看不出有什么理由必须要有一个完全静态的映射。您应该能够进行设置，以便在测试配置中映射是不同的。

# visual-studio - Devenv ProjectConfig 开关 - Win32 和 x64

> ID：12502692
> 
> 赞同：3
> 
> 时间：2012-09-19T20:49:56.633
> 
> 标签：visual-studio, visual-studio-2008

以交互方式运行 Visual Studio 2008，我可以成功地为 x64 和 Win32 目标构建项目。但是，如果我调用 devenv，无论我的 /projectconfig 参数如何，它总是执行 x64 构建：

```
devenv /Rebuild Release MySolution.sln /projectconfig "Release|Win32"

Microsoft (R) Visual Studio Version 9.0.21022.8.
Copyright (C) Microsoft Corp. All rights reserved.
------ Rebuild All started: Project: my-project, Configuration: Release x64 ------ 
```

请注意，/projectconfig 参数与 Configuration: 输出不匹配。我错过了一些简单的东西吗？它在 IDE 中运行良好，但有很多目标，我更喜欢编写脚本。

提前致谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-20T08:21:35.457

我不确定为什么会发生这种情况，但它是否适用于以下情况？

```
devenv /Rebuild "Release|Win32" MySolution.sln 
```

或者，使用`msbuild`：

```
msbuild MySolution.sln /p:Configuration=Release;Platform=Win32 /t:proj:Rebuild 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-10-08T12:50:24.147

使用 Visual Studio 2019 在命令行中使用 devenv.exe 构建 .NET 5 解决方案：

```
C:\Program Files (x86)\Microsoft Visual Studio\2019\Professional\Common7\IDE\devenv.com SolutionName.sln /build "Release|x86" /project Project /projectconfig Release 
```

仍然不影响构建配置并使用**Any CPU**而不是**x86**：

```
14:08:42      [exec] 80>------ Build started: Project: Project, Configuration: Release Any CPU ------ 
```

在挖掘 Project.csproj（注意这是**.NET 5**项目文件格式）文件后，我发现了这个：

```
<Platforms>AnyCPU;x86;x64</Platforms> 
```

实验性更改平台顺序为：

```
<Platforms>x86;AnyCPU;x64</Platforms> 
```

它成功了：

```
15:27:30      [exec] 80>------ Build started: Project: Project, Configuration: Release x86 ------ 
```

希望这对现在使用 devenv.com 进行组装的人有所帮助。

# ruby-on-rails-3 - RoR：为什么我的微博没有显示？

> ID：12502697
> 
> 赞同：0
> 
> 时间：2012-09-19T20:50:07.510
> 
> 标签：ruby-on-rails-3

这是用户显示他们应该显示的视图。..

编辑（我已经稍微更新了这篇文章，你可以在[RoR 看到它：我怎样才能让我的微博出现？](https://stackoverflow.com/questions/12520635/ror-how-can-i-get-my-microposts-to-show-up)）

```
<section>
  <div id= "purchases">
    <%= render 'shared/micropost_form_purchase' %>
  </div>
  <div id="sales">
    <%= render 'shared/micropost_form_sale' %>
  </div>
</section>

<div id="purchases list">
  <ol class="microposts">
    <%= render @purchases unless @purchases.nil? %>
  </ol>
</div>

<div id="sales list">
  <ol class="microposts">
    <%= render @sales unless @sales.nil? %>
  </ol>
</div> 
```

所以表格（部分）加载得很好，但是当我发帖时，无论是购买清单还是销售清单都没有出现。我检查了数据库，它们正在与列中指示种类（销售或购买）的条目一起创建

以下是表格：

```
<%= form_for (@micropost) do |f| %>

  <div class="field no-indent">
    <%= f.text_area :content, placeholder: "What's something else you want to buy?" %>
    <%= hidden_field_tag 'micropost[kind]', "purchase" %>
  </div>
  <%= f.submit "Post", class: "btn btn-large btn-primary" %>
<% end %> 
```

和

```
<%= form_for (@micropost) do |f| %>

  <div class="field no-indent">
    <%= f.text_area :content, placeholder: "What's something else you want to buy?" %>
    <%= hidden_field_tag 'micropost[kind]', "sale" %>
  </div>
  <%= f.submit "Post", class: "btn btn-large btn-primary" %>
<% end %> 
```

另外，这里是 users_controller.rb 的显示部分

```
 def show
    @user = User.find(params[:id])
    @micropost=Micropost.new
    @microposts = @user.microposts.paginate(page: params[:page])
  end 
```

这是 microposts_controller.rb 的显示部分

```
def show

    @micropost = Micropost.find(params[:id])
    @microposts = Micropost.where(:user_id => @user.id)
    @purchases = @microposts.where(:kind => "purchase")
    @sales = @microposts.where(:kind => "sale")

  end 
```

谁能帮我吗？我还需要什么吗？嗯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T23:27:11.793

首先，为了确保你得到你想要的结果，你应该在你的视图中尝试这样的事情

```
<%= @sales %> 
```

这应该是您想要的结果的哈希值。然后，如果看起来不错，你想做这样的事情

```
<div id="sales_list">
  <ol class="microposts">
    <% if @sales.any? %>
      <% @sales.each do |sale| %>
        <li><%= sale %></li>
      <% end %>
    <% end %>
  </ol>
</div> 
```

并重复购买

# android - ListView onClick

> ID：12502698
> 
> 赞同：0
> 
> 时间：2012-09-19T20:50:09.377
> 
> 标签：android

我正在尝试做一些非常简单的事情：创建一个常见问题列表视图，当点击一个问题时，答案会出现在一个文本视图中。我为问题和答案创建了两个字符串数组，每个元素都被列为一个项目。有 5 个 q 和 5 个 a。现在问题正在列表视图中正确显示，但 onclick 不起作用。怎么了？？

```
package freq.asked;

import android.app.ListActivity;
import android.os.Bundle;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.TextView;

public class FreqActivity extends ListActivity {

    @Override
        public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            //displays all elements of questions array in listview
            setListAdapter(ArrayAdapter.createFromResource(getApplicationContext(),
                    R.array.questions, R.layout.main));
    }

    public void onItemClick(AdapterView<?> arg0, TextView v, int position, long id) {
        String[] ans = getResources().getStringArray(R.array.answers);
        for (int i=0; i<6; i++) {
                    //should display answer to question in textview
            v.setTag(ans[i]);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T20:53:02.707

我相信您使用了错误的方法，请尝试`onListItemClick()`：

```
protected void onListItemClick(ListView l, View v, int position, long id) { 
```

* * *

一个例子：

```
public class FreqActivity extends ListActivity {
    String[] ans;
    String[] questions;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        ans = getResources().getStringArray(R.array.answers);
        questions = getResources().getStringArray(R.array.questions);
        //displays all elements of questions array in listview
        setListAdapter(ArrayAdapter.createFromResource(getApplicationContext(),
                R.array.questions, android.R.layout.simple_list_item_1));
    }

    protected void onListItemClick(ListView l, View v, int position, long id) {
        ((TextView) v).setText(questions[position] + ": " + ans[position]);
    }
} 
```

请注意，您不需要`ans`每次用户单击一行时都获取，您只需要在其中执行一次`onCreate()`

* * *

如果您只想在单击“问题”后开始新的活动，请在以下位置使用`onListItemClick()`：

```
Intent i = new Intent(this, AnswerActivity.class);
i.putExtra("answer", ans[position]);
startActivity(i); 
```

您可以在此处阅读有关如何读取此数据的信息：[如何在 Android 应用程序中的活动之间传递数据？](https://stackoverflow.com/q/2091465/1267661)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T20:57:29.610

请使用以下替换方法 onItemClick，

```
protected void onListItemClick(ListView l, View v, int position, long id) {
    // TODO Auto-generated method stub
    super.onListItemClick(l, v, position, id);
} 
```

# excel - 使用 VBA 复制格式

> ID：12502699
> 
> 赞同：0
> 
> 时间：2012-09-19T20:50:11.463
> 
> 标签：excel, vba

我有一个脚本，一个非常简单的脚本，它是一个更大的脚本的一部分，现在这最后一点给我带来了问题，我不知道为什么。

这是脚本中给我带来问题的部分。

```
Option Explicit

Sub Test()

    Dim wsJL As Worksheet 'Jobs List
    Dim lastrow As Long    
    Set wsJL = Sheets("Jobs List")

    lastrow = wsJL.Range("B" & Rows.Count).End(xlUp).Row
    wsJL.Range("B3:N3").Copy
    wsJL.Range("B4:N" & lastrow).PasteSpecial xlPasteFormats

End Sub 
```

这是工作簿。

[https://dl.dropbox.com/u/3327208/Excel/format.xlsm](https://dl.dropbox.com/u/3327208/Excel/format.xlsm)

据我所知，我正在做的事情不应该发生。发生的事情是它会覆盖所有内容，而不是用最初复制的格式替换格式。

有人可以尝试重现这个并告诉我我的错误在哪里吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-20T01:57:36.927

您可以在不复制和粘贴的情况下做同样的事情。它需要更多代码，但不使用剪贴板，也不选择工作表上的任何内容。

它运行得更快。我很想知道这在您的工作计算机上是否比您已经尝试过的效果更好。

尝试这个：

```
Sub WriteInsteadOfCopyFormatting()

    Dim wsJL As Worksheet 'Jobs List
    Dim rng As Range ' Columns B through N
    Dim dateRng As Range ' Column F
    Dim numbersRng As Range ' Columns J through L
    Dim NCMRRng As Range ' Column M

    Dim lastRow As Long
    Dim firstCopyRow As Long

    Set wsJL = Sheets("Jobs List")

    lastRow = wsJL.Range("B" & Rows.Count).End(xlUp).Row
    firstCopyRow = 4
    Set rng = wsJL.Range("B" & firstCopyRow & ":N" & lastRow)
    Set dateRng = wsJL.Range("F" & firstCopyRow & ":F" & lastRow)
    Set numbersRng = wsJL.Range("J" & firstCopyRow & ":J" & lastRow)
    Set NCMRRng = wsJL.Range("M" & firstCopyRow & ":M" & lastRow)

    With rng
        .Interior.Color = 16777215
        .Font.Name = "Calibri"
        .Font.Size = 11
        .Font.Color = vbBlack
        .BorderAround Weight:=xlThin, Color:=vbBlack
    End With
    With rng.Borders(xlInsideVertical)
        .Weight = xlThin
        .Color = vbBlack
    End With
    With rng.Borders(xlInsideHorizontal)
        .Weight = xlThin
        .Color = vbBlack
    End With

    dateRng.NumberFormat = "d/mm/yyyy"
    numbersRng.NumberFormat = "#,##0"
    NCMRRng.NumberFormat = "0######"

End Sub 
```

# php - 在每行的开头和结尾添加一个字符 txt 文件 file php

> ID：12502701
> 
> 赞同：-4
> 
> 时间：2012-09-19T20:50:18.933
> 
> 标签：php, regex, preg-replace

我有一个名为 list.txt 的文件，我想将字母“a”放在前面，将字母“b”放在列表中每一行的后面。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-19T20:52:25.733

在php中

```
$fileContents = file_get_contents('list.txt');
$fixedFileContents = preg_replace('/.+/', 'a$0b', $fileContents);
file_put_contents($fixedFileContents, 'list.txt'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-19T20:54:24.780

```
<?php 
   $text = file_get_contents('./list.txt');
    $array = explode("\n", $text);
    foreach($array as $ar)
    {
    $new_text .= 'a'.$ar."b\n";
    }
    file_put_contents('./list.txt', $new_text);
?> 
```

# c# - 字符串中的修剪线

> ID：12502702
> 
> 赞同：0
> 
> 时间：2012-09-19T20:50:20.457
> 
> 标签：c#, excel

我正在将 .txt 文件导入 Microsoft Excel 工作表，效果很好，但问题是当我想编辑单元格的内容时，例如我有我的列，然后将其传递给 Excel 工作表，这是我在单元格“Patient Name:Robin”中得到的内容，我只想在该单元格中包含“：”之后的内容。这是我的代码。

```
 System.IO.StreamReader archivo = new System.IO.StreamReader(NombreFile);

 int lineacnt = 0;
    string[] ListInfo = new string[49];

for (int b = 1; b < 49; b++)
{
    ListInfo[b] = archivo.ReadLine();
    //Here I got an error of an object reference//
    **contenidoEMG[0, i] = ListInfo[7].Remove(ListInfo[7].IndexOf(':'));** 
    contenidoEMG[1, i] = ListInfo[11];
    contenidoEMG[2, i] = ListInfo[12]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T20:59:04.567

string.Remove(int startIndex) 返回一个字符串，其中 startIndex 后面的所有字符都已删除。

```
var str = "patient name:Robin";
var newStr = str.Remove(str.IndexOf(':'));
Console.WriteLine(newStr); // prints 'patient name' 
```

如果你想要罗宾，你应该这样做`str.Remove(0, str.IndexOf(':')+1);`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T20:53:07.910

你在做什么来检查这`ListInfo[7]`是一个正确的字符串而不是空字符串？那可能是你遇到问题的地方。

# tabbar - Xcode 4.5 在全屏模式下隐藏标签栏！这可以解决吗？

> ID：12502705
> 
> 赞同：6
> 
> 时间：2012-09-19T20:50:27.197
> 
> 标签：tabbar, xcode4.5

我刚刚安装了 Xcode 4.5，并注意到当我处于全屏模式时，Xcode 选项卡栏与菜单栏一起消失。即使菜单栏消失，它也仍然可见。有没有其他人经历过这个？有没有人发现让标签栏可见的偏好？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T21:00:52.473

好吧，事实证明，如果您关闭全屏并重新打开，一切都会恢复正常。这似乎是升级后的故障，似乎可以自行修复。

# css - div 内 100% 宽的表格不喜欢边距

> ID：12502711
> 
> 赞同：1
> 
> 时间：2012-09-19T20:51:04.527
> 
> 标签：css, html, nested-table

似乎当我在 div 中有一个表格并将表格设置为 100% 宽度并给它一些边距时，它似乎忽略了右侧边距。这是它的小提琴：

[http://jsfiddle.net/gFQGb/](http://jsfiddle.net/gFQGb/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T20:56:01.123

宽度适用于元素的实际*内容*，因此您有一个*内容*为 100% 宽的表格，除此之外，您添加了一些边距，将宽度推到 100% 以上，因此表格的右侧超出了父级的右侧边缘。可能您应该在父级上使用填充而不是在表格上使用边距，或者`<div>`只使用边距的附加包装器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T20:59:07.640

只需添加`padding: 10px;`到`.inner`班级并`margin`从表格中删除。
[这](http://jsfiddle.net/gFQGb/3/)是演示

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-19T21:03:22.623

这就是 CSS 默认盒子模型的工作原理：元素的宽度（通过 定义`width: x`）+ 边框 + 边距 + 填充 = 它占用的空间总量。

[http://css-tricks.com/the-css-box-model/](http://css-tricks.com/the-css-box-model/)

您可以使用 更改盒子模型`box-sizing: border-box`，这将导致`width: 100%`包含您的填充/边框。

[http://css-tricks.com/box-sizing/](http://css-tricks.com/box-sizing/)

# ruby - dup 和 clone 都返回不同的对象，但是修改它们会改变原始对象

> ID：12502715
> 
> 赞同：7
> 
> 时间：2012-09-19T20:51:17.140
> 
> 标签：ruby, object, duplicates, clone

当我打印出哈希值时，我有一个值数组用作订单的参考。我想修改数组，使数组值“更漂亮”。我想我只是复制或克隆数组，更改值并且原始对象将保持不变。但是（在 irb 中）...

```
@arr = ['stuff', 'things']
a = @arr.clone
b = @arr.dup 
```

因此，至少 a 和 @arr 是不同的对象：

```
a.object_id == @arr.object_id
=> false 
```

但现在变得奇怪了

```
a[0].capitalize!
a
=> ['Stuff', 'things']
@arr
=> ['Stuff', 'things'] ##<-what?
b
=> ['Stuff', 'things']## <-what??? 
```

好的...所以修改一个会改变其他的，让我们把它改回来？

```
a[0] = 'stuff'
a
=> ['stuff', 'things']
@arr
=> ['Stuff', 'things'] ## <- WHAT????? 
```

为了完整性 b[1].capitalize! 具有相同的效果，将三个数组的第二个位置全部大写

那么......大写结尾的爆炸是否使它更加有效？足以穿越到其他物体？？我知道这样做的其他方法，但这对我来说似乎非常奇怪。我认为这与“浅拷贝”有关。关于最好的方法的建议？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-19T21:04:51.663

`dup`并`clone`创建数组的新实例，但不是内容，它不是深拷贝。

看：

```
array0 = ['stuff', 'things']
array1 = array0.clone
array2 = array0.dup

puts "Array-Ids"
p array0.object_id
p array1.object_id
p array2.object_id

puts "Object ids"
array0.each_with_index{|_,i|
  p array0[i].object_id
  p array1[i].object_id
  p array2[i].object_id
  p '--------'
} 
```

数组中的元素共享相同的 object_id - 它们是相同的对象。数组具有不同的对象 ID。

当您`a[0].capitalize!`修改一个对象时，该对象属于三个不同的数组。

也可以看看

*   [复制 Ruby 字符串数组](https://stackoverflow.com/questions/2579879/duplicating-an-array-of-strings)
*   [Ruby中数组的深拷贝](https://stackoverflow.com/questions/8607852/deep-copy-of-arrays-in-ruby)
*   [如何在 Ruby 中创建对象的深层副本？](https://stackoverflow.com/questions/8206523/how-to-create-a-deep-copy-of-an-object-in-ruby)

# html - 空表格单元格在 IE7 标准模式下的高度为 1px

> ID：12502716
> 
> 赞同：3
> 
> 时间：2012-09-19T20:51:17.333
> 
> 标签：html, css, internet-explorer, internet-explorer-7

在 IE9 中使用 IE7 标准模式时，空表格单元格的高度为 1px。这会导致表格下方的元素在页面上的显示低于应有的位置。我使用下面的代码为此创建了一个 JSFiddle：http: [//jsfiddle.net/Zr7T2/3/](http://jsfiddle.net/Zr7T2/3/)

**有没有办法让空表格单元格在 IE7 标准模式下的高度为 0px？**

我需要用 HTML/CSS 解决这个问题，而不是 JS。简单地删除空单元格不是一种选择。谢谢！

```
<!-- DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd" -->
    <html xmlns="http://www.w3.org/1999/xhtml">
        <head>
            <title>IE7 empty cell bug?</title>
        </head>
        <body>
            <table cellpadding="0" cellspacing="0">
                <tbody>
                    <tr><td /></tr>
                    <tr><td /></tr>
                    <tr><td /></tr>
                    <tr><td /></tr>
                    <tr><td /></tr>
                    <tr><td /></tr>
                    <tr><td /></tr>
                    <tr><td /></tr>
                    <tr><td /></tr>
                    <tr><td /></tr>
                    <tr><td /></tr>
                    <tr><td /></tr>
                    <tr><td /></tr>
                    <tr><td /></tr>
                    <tr><td /></tr>
                    <tr><td /></tr>
                    <tr><td /></tr>
                    <tr><td /></tr>
                    <tr><td /></tr>
                    <tr><td /></tr>
                    <tr><td /></tr>
                    <tr><td /></tr>
                    <tr><td /></tr>
                    <tr><td /></tr>
                    <tr><td /></tr>
                    <tr><td /></tr>
                    <tr><td /></tr>
                    <tr><td /></tr>
                    <tr><td /></tr>
                    <tr><td /></tr>
                    <tr><td /></tr>
                    <tr><td /></tr>
                </tbody>
            </table>
            This text should be at the top of the page. It isn't when running in IE9 with IE7 standards mode turned on.
        </body>
    </html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T08:35:08.520

You can use browser specific CSS like this:

```
body
{
*margin-top:-30px; /* IE 7 and below */
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-20T10:36:54.920

我有这个问题。我简单地说

```
<td>&nbsp;</td> 
```

但这不是一个好的假肢，而不是好的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-19T21:14:45.840

将像元高度显式设置为零：

```
td { height: 0; } 
```

# magento - 如何在 Magento 的管理界面中指定自定义 frontend_model

> ID：12502722
> 
> 赞同：0
> 
> 时间：2012-09-19T20:51:58.180
> 
> 标签：magento

我的问题与这个问题基本相同： [Add a date picker to system.xml on custom module](https://stackoverflow.com/questions/3660842/add-a-date-picker-to-system-xml-on-custom-module/10411804)

我想在 Magento 的管理配置中添加一个客户 frontend_model 以支持日期选择器。

当我尝试按照链接帖子中的步骤操作时，我得到一个空白屏幕。我可以在我的 system.log 中看到“Mage/”包含在文件路径的前面。通常这意味着相关模块的 config.xml 不正确，但我在 frontend_model 上阅读的所有内容都没有在配置中注册。

添加自定义frontend_model时，是否需要在config.xml中注册block？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T17:36:13.517

无需注册自定义前端模型。必须通过为模块提供的名称来引用模型。

# iphone - iphone 应用程序 - 防止垃圾邮件

> ID：12502723
> 
> 赞同：0
> 
> 时间：2012-09-19T20:52:06.760
> 
> 标签：iphone, ios, ipad, bots, spam

我开发了一个应用程序，允许用户上传一些照片并在 Facebook/Dropbox/Twitter 等上分享它们。最近它在应用程序商店上线。

但是，我现在遇到了一个问题：一个机器人正在创建帐户并在我的服务器上上传许多照片。我暂时禁用了该应用程序，但现在我正在寻找一种有效的方法来阻止该机器人执行此操作。

机器人的 ip 地址经常变化，因此不可能阻止 ip。他使用非常真实的姓名和电子邮件地址创建帐户，因此很难找出哪些用户是真实的，哪些是由机器人创建的。

我正在考虑使用验证码，但我不确定如果我实施此应用程序是否会被 Apple 拒绝。我最好寻找一种方法，这样我就可以阻止他做他的工作，这样我就不必再次将应用程序重新发送给 Apple。

谁能给我一些关于我可以做什么的建议？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T21:12:52.680

这就是我解决类似问题的方法：

我实现了一个令牌生成器，它为与服务器的每一次数据传输生成一个一次性令牌，所以即使是一个用于登录数据、发送文件等的令牌。这个令牌是由一个秘密算法生成的，可以在服务器端进行验证，因为您知道如何生成一个。

使用一个令牌后，将其放入一个临时列表中以供接下来 X 分钟/小时/天使用（取决于您的服务器可以处理多少数据传输）。当用户尝试使用使用过的令牌发送数据时（即令牌与“禁止”列表中的令牌匹配），您可以确定有人试图向您发送垃圾邮件 -> 将帐户标记为“垃圾邮件发送者”并决定您希望做什么做。

该算法每次都必须生成不同的令牌（最好的方法是单向哈希），但是您必须确保特定的“属性”，从而可以证明其真实性。

所以一个非常简单的例子：

您在客户端中的算法正在生成一个介于 1000000000000000000000 和 99999999999999999999999 之间的数字，然后将该数字乘以 12456564 并增加 20349。

服务器成为特定的命令和数据，以及生成的令牌。现在它检查是否`(number - 20349)%12456564`为 0。如果为 0，则可能是由您的“秘密”算法生成的。

这是一个非常基本的例子，但你明白了……</p>

# c++ - 如何使用 Visual Studio 构建 notepad++ 源代码？

> ID：12502724
> 
> 赞同：2
> 
> 时间：2012-09-19T20:52:06.243
> 
> 标签：c++, visual-studio, notepad++

选择 notepad++ 源代码来学习一些最佳实践并潜入这个流行的文本编辑器的代码中。

自述文件说 -

> 双击 Notepad++\trunk\PowerEditor\visual.net\notepadPlus.vcproj 以在 Visual Studio 中启动 Notepad++ 项目，然后使用您想要的模式构建它，就是这样。

但是尝试在 VS-2012 RC 构建中构建它失败并显示错误消息 - 1\. 缺少某些文件，2\. IntelliSense：不允许指向不完整类类型的指针。

为了使问题简洁易读，而不是发布确切的错误。请让我知道是否需要。

**编辑** 添加的错误，根据要求 -

> 错误 1 ​​错误 C1083：无法打开包含文件：'FindCharsInRange.h'：没有这样的文件或目录 c:\myLocalSourcePath\notepad++\powereditor\src\Notepad_plus.h 68 1 Notepad++
> 
> 错误 8 错误 C2511: 'void ScintillaEditView::getGenericText(TCHAR *,int,int,int *,int *) const' : 在 'ScintillaEditView' c:\myLocalSourcePath\Notepad++\PowerEditor\src\ScitillaComponent\ 中找不到重载的成员函数ScintillaEditView.cpp 1715 1 记事本++
> 
> 16 IntelliSense：无法打开源文件“VerticalFileSwitcher.h”c:\myLocalSourcePath\Notepad++\PowerEditor\src\NppCommands.cpp 35 1 Notepad++
> 
> 17 IntelliSense：无法打开源文件“documentMap.h”\Notepad++\PowerEditor\src\NppCommands.cpp 36 1 Notepad++
> 
> 25 IntelliSense：标识符“FindCharsInRangeDlg”未定义 c:\myLocalSourcePath\Notepad++\PowerEditor\src\Notepad_plus.h 351 2 Notepad++

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T17:25:22.327

更改构建配置文件后，我可以解决此问题。在这里发帖，希望有一天它对某人有所帮助。

1.  以前它被选为 ANSI Debug Build。它必须更改为 Unicode 调试版本。
2.  我不得不删除 Notepad++.exe 清单文件。

此时构建成功。

然而，在运行应用程序时，无法找到 Scintilla DLL，因为我将 SCiLexer.DLL 从安装的 Notepad++ 目录中的 Program Files 复制到 Notepad++ 源代码内的 bin 目录中。

# iphone - 是否可以制作具有最小宽度的视口？

> ID：12502727
> 
> 赞同：2
> 
> 时间：2012-09-19T20:52:29.737
> 
> 标签：iphone, css

```
<meta content="minimum-scale=1.0, width=device-width, maximum-scale=1.0, user-scalable=no" name="viewport"> 
```

为了能够看到所有重要的东西，在普通桌面上，窗口宽度始终为 1000 像素或更多，但在 iphone 上，我喜欢确保屏幕的最小宽度为 1000 像素

可以这样做吗？

导致问题的网站是：[http ://www.benoitjacquesdesigner.com/index.html](http://www.benoitjacquesdesigner.com/index.html)

看看上面的文字，它剪掉了....或者向我解释右边的白色带子（缺少背景）

--

子问题，有没有一个地方可以让我自己学习所有的移动技巧和技巧……我经常去 w3school，但是人们对这个网站说一些不好的东西……

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T20:54:22.857

iOS 产品（大多数 Android 产品也是如此）的最小宽度为 600 像素，并且这样做可以正常工作。研究`media queries`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T20:55:13.657

尝试

```
<meta content="minimum-scale=1.0, width=device-1000, maximum-scale=1.0, user-scalable=no" name="viewport"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-19T21:15:34.310

好的，通过一些有效的测试：`<meta name="viewport" content="width=1200">`

# html - 在不使用表格单元格的情况下从带有超链接的图像中删除换行符

> ID：12502729
> 
> 赞同：0
> 
> 时间：2012-09-19T20:52:54.027
> 
> 标签：html, css

我有一个`<div>`包含图像

```
<div>
   <img src="pic1.jpg" />
   <img src="pic2.jpg" />
   <img src="pic3.jpg" />
</div> 
```

现在，每当我在任何图像上放置超链接时，都会导致换行。

我已经尝试添加`display:block; display:inline; float: left`到图像。但是仍然会出现换行符。

在这种情况下使用 a`<table>`不是一个选项。如何修复线路 - 不使用中断`<table>`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T22:56:27.360

尝试这个：`float: left; clear: none;`

# javascript - 部分扩展 div 以预览内容

> ID：12502734
> 
> 赞同：2
> 
> 时间：2012-09-19T20:53:09.020
> 
> 标签：javascript, jquery

当我将鼠标悬停在一个 div 上时，我希望另一个 div（以 开头`display:none`）部分向下扩展，仅显示其内容的顶部。如何使用 jQuery 部分扩展隐藏的 div？最好使 div 向底部淡出。该命令似乎没有参数`toggle()`或`fadeIn()`允许部分扩展。

# 编辑

不幸的是，要求不允许使用单独的“预告片”div。包含所有文本的隐藏 div 必须部分展开。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T20:54:20.407

而不是切换整个 div，将内部内容分成一个预告片 div 和一个内容 div，然后在你想要偷偷摸摸的时候只切换预告片 div

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T21:10:43.803

假设您只想显示隐藏 div 的前 30 个像素：

```
var HowManyPixelsToShow = 30;

$(body).on({
   mouseenter: function() { ShowInfoBoxDiv($(this)); },
   mouseleave: HideInfoBoxes
}, '.info-box');

function ShowInfoBoxDiv(TheInfoBox) {
   //this assumes the 'more-info' divs are located after the '.info-box' divs
   TheInfoBox.next('.more-info') 
             .css('overflow':'hidden')
             .height(HowManyPixelsToShow)
             .slideDown(500);
}

function HideInfoBoxes() {
  $('.more-info').hide();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-19T21:24:16.440

您可以使用 jQuery 的动画功能来显示预览。（打开一定量）在该div的底部添加一个具有透明渐变的PNG，使其淡化为白色。#contentDiv 以 0px 的高度开始。

```
$("#hoverDiv").hover(
  function(){
    $("#contentDiv").animate({"height":"100px"});
  }, 
  function(){
    $("#contentDiv").animate({"height":"0px"});
  }
); 
```

# c++ - 所有宽字符类型的模板特化

> ID：12502745
> 
> 赞同：1
> 
> 时间：2012-09-19T20:54:04.370
> 
> 标签：c++, templates

我现在想提高我在 C++ 模板方面的知识，但遇到了一个问题。是否可以编写一个模板函数来接受所有宽字符类型，如 std::wstring、wchar_t、wchar_t* 等？这是一个例子来说明我的意思：

```
template <typename T> Function(T1 var)
{
    // Do something with std::stringstream and the passed var;
} 
```

上述函数的问题是它不适用于 wchar_t 或 std::wstring 例如。您需要改用 std::wstringstream 。我现在可以专注于：

```
template <> Function(wchar_t var)
{
    // Do something with std::wstringstream and the passed var;
} 
```

现在我必须为每个宽字符串类型编写相同的函数，但是是否可以专门化一次并涵盖所有宽字符串类型？

提前谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T21:17:43.357

使用特征技术。定义一些`is_wide_char_type`类模板。像这样：

```
template <T>
struct is_wide_char_type { static const bool VALUE = false; };
template <>
struct is_wide_char_type<wchar_t> { static const bool VALUE = TRUE; };
... for others types the same. 
```

然后将您的函数特化为两个版本，您需要定义类模板，因为函数模板不能部分特化：

```
template <typename T, boo isWideChar> class FunctionImpl;
template <typename T> struct FunctionImpl<T, false> {
  static void doIt() {
     // code for not wide char types
  }
};
template <typename T> struct FunctionImpl<T, true> {
  static void doIt() {
     // code for wide char types
  }
};

template <typename T> Function(T1 var)
{
   FunctionImpl<T, is_wide_char_type<T>::VALUE>::doIt();
} 
```

或者考虑让它变得更容易，并在特征`is_wide_char_type<T>`中包含不仅仅是类型的标签信息，`T`还包括关于使用哪个字符串流以及您喜欢的任何内容。

# algorithm - 这种优化对 Heapsort 有多大价值？

> ID：12502748
> 
> 赞同：3
> 
> 时间：2012-09-19T20:54:20.283
> 
> 标签：algorithm, sorting, heapsort, max-heap

传统`Heapsort`算法在每个 之后将堆的最后一个元素与当前堆的根交换`heapification`，然后再次继续该过程。但是，我注意到这是不必要的。

在`heapification`子数组的 a 之后，虽然节点包含最高值（如果它是 a `max-heap`），但数组中接下来的 2 个元素*必须*跟随排序数组中的根，或者按照与现在相同的顺序，或者交换它们如果它们是反向排序的。因此，与其仅将根与最后一个元素交换，不如将前 3 个元素（包括节点以及在必要时交换第 2 和第 3 个元素之后）与最后 3 个元素交换，这样 2随后`heapifications`的（对于第 2 和第 3 个元素）被省去了？

这种方法有什么缺点吗（除了如果需要交换第二个和第三个元素，这应该是微不足道的）？如果不是，如果它确实更好，它会带来多少性能提升？这是伪代码：

```
function heapify(a,i) {
  #assumes node i has two nodes, both heaps. However node i itself might not be a heap, i.e one of its children may be greater than its value.
  #if so, find the greater of its two children, then swp the parent with that value.
  #this might render that child as no longer a heap, so recurse
 }

function create_heap(a) {
   #all elements following index |_n/2_| are leaf nodes, thus heapify() should be applied to all elements within index 1 to |_n/2_|
   }

function heapsort(a) {
  create_heap(a);  #a is now a max-heap
  #root of the heap, that is a[1] is the maximum, so swap it with a[n].
  #The root now contains an element smaller than its children, both of which are themselves heaps.
  #so apply heapify(a,1). Note: heap length is now n-1, as a[n] is the largest element already found
  #now again the array is a heap. The highest value is in a[1]. Swap it with a[n-1].
  #continue
  } 
```

假设数组是`[4,1,3,2,16,9,10,14,8,7]`。运行一个之后`heapify`，就会变成`[16,14,10,8,7,9,3,2,4]`。现在 的`heapsort`第一次迭代将交换 16 和 4，导致`[4,14,10,8,7,9,3,2,16]`. 由于这现在已经将新堆的根渲染`[4,14,10,8,7,9,3,2]`为，嗯，未堆，（14 和 10 都大于 4），运行另一个`heapify`来生成`[14,8,10,4,7,9,3,2]`. 现在 14 是根，将其与 2 交换为 yield `[2,8,10,4,7,9,3,14]`，从而使数组 current `[2,8,10,4,7,9,3,14,16]`。我们再次发现 2 未堆，因此再次执行 a`heapify`使堆为`[10,8,9,4,7,2,3]`。然后将 10 与 3 交换，使数组为`[3,8,9,4,7,2,3,10,14,16]`. 我的观点是`heapification`，我们可以从第一个开始，而不是在 16 之前存储 10 和 14，而不是执行 2nd 和 3rd s`heapification`因为 10 和 14 在 16 之后，所以它们是第二和第三大元素（反之亦然）。因此，在它们之间进行比较之后（如果它们已经排序，则 14 在 10 之前），我将那里的所有内容`(16,14,10)`与 交换`(3,2,4)`，使数组`[3,2,4,8,7,9,16,14,10]`. 这将我们减少到与另外两个`heapification`s 之后的情况类似的情况——`[3,8,9,4,7,2,3,10,14,16]`最初，与`[3,2,4,8,7,9,16,14,10]`现在相比。两者现在都需要进一步`heapification`，但第二种方法让我们直接通过两个元素（14 和 10）之间的比较来到达这个关口。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-19T21:48:31.947

堆的第二大元素出现在第二或第三位置，但第三大元素可以出现在更下方，深度 2。（参见[http://en.wikipedia.org/wiki/Heap_(data_structure ）](http://en.wikipedia.org/wiki/Heap_(data_structure))）。此外，在将前三个元素与后三个元素交换之后，heapify 方法将首先堆化根的第一个子树，然后是根的第二个子树，然后是整棵树。因此，此操作的总成本接近于将顶部元素与最后一个元素交换并调用 heapify 的成本的三倍。所以你这样做不会有任何收获。

# screenshot - 有没有一种快速的方法来更改 .snag Snagit 文件中的底层图像？

> ID：12502752
> 
> 赞同：1
> 
> 时间：2012-09-19T20:54:28.090
> 
> 标签：screenshot

我正在使用 Snagit 作为用户指南截图。（新的，但到目前为止它很棒！）。我将屏幕截图保存为分层的 .snag 文件，然后导出 .png 文件以放入文档中。.snag 文件中的图层由底层光栅图像（背景）加上顶部的注释和标注图层组成。

这样做可以让我轻松移动和编辑注释和标注，然后导出替换的 .png 文件。但是，如果我在屏幕截图上有一堆标注并且屏幕本身发生了变化怎么办？

有没有办法用新的栅格图层（背景）替换，同时保持标注到位，所以我不必创建新的 .snag 文件？（我想避免将现有文件中的标注复制并粘贴到新创建的文件中......）

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T22:50:26.577

是的，这是可能的，只要您的注释和标注仍然是矢量对象。这是您需要做的：

1.  删除现有的屏幕截图。
2.  制作一个新的屏幕截图并将其粘贴到 snag 文件中。
3.  选择屏幕截图并使用**Send to Back**功能将其移动到底层。
4.  如果需要，调整注释的位置。

# .net - 如何调试在云中运行的 Azure Web 角色？

> ID：12502753
> 
> 赞同：3
> 
> 时间：2012-09-19T20:54:27.927
> 
> 标签：.net, azure, remote-debugging, visual-studio-debugging, azure-web-roles

我们需要调试仅在云中表现出来的问题。它不会出现在模拟器中（即使使用云连接字符串等）。我们在暂存 Web 角色实例上安装了 RDP，并在其上启用了 WebDeploy，以便快速轻松地进行调试/代码更改。

我们想要的是更强大的东西，我们的本地 VS2010 (Ultimate) 可以在远程 Web 角色上设置/触发断点并检查本地变量等。

有谁知道设置上述内容的方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-21T04:02:25.467

好的，由于 Azure SDK 更新、不正确的教程、VS2012 怪癖的结合，我花了几个小时来解决这个问题。GertH 上面所说的在理论上是正确的（谢谢！），但是如果没有系统层面的工作细节，它就不起作用，所以它在实践中不是很有用。

我已经在[http://antirandom.com/2012/09/remotely-debugging-a-windows-azure-webrole-via-visual-studio-debugger/记录了我为未来战士的工作经验](http://antirandom.com/2012/09/remotely-debugging-a-windows-azure-webrole-via-visual-studio-debugger/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-12T18:59:56.807

在 VS 2012 中有一种更简单的方法来进行 Web 角色调试，因为远程调试器可以作为 TCP 服务端点公开。因此，您将不再需要 Azure Connect 部分。

一篇很棒的博文在这里：[http ://blog.fullscale180.com/remote-debugging-windows-azure-cloud-services-with-visual-studio-2012/](http://blog.fullscale180.com/remote-debugging-windows-azure-cloud-services-with-visual-studio-2012/)

作为奖励，远程工具会在 WebRole 本身启动时自动配置和启动，因此您无需关心角色何时被回收。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-20T14:07:21.393

您可以使用 Visual Studio 远程调试器来执行此操作。要启用此功能，您必须执行几个步骤。简而言之：

1.  在 azure 角色上安装远程调试器代理
2.  使用 azure 角色创建一个加入本地计算机的虚拟网络组
3.  使用远程调试器

更详细的解释可以在这里找到： [http ://www.4tecture.ch/blog/remote-debugging-a-windows-azure-role-instance](http://www.4tecture.ch/blog/remote-debugging-a-windows-azure-role-instance)

# java - 涉及线程的 c++/Java 之间的函数完成信号

> ID：12502755
> 
> 赞同：1
> 
> 时间：2012-09-19T20:54:36.183
> 
> 标签：java, c++, multithreading, java-native-interface

在 C++ JNI 函数（包括在下面的半伪函数）中，至少在该`client_ = new VClient(&callback_)`行创建了一个（并且可能是两个）附加线程。我认为完成这个函数就足够了，但显然当下一个函数（另一个 JNICALL 函数）在此之后“立即”调用时，它会导致一个 SEGFUALT（“立即”在引号中，因为该函数被调用的速度很快有人可以按下下一个按钮）。我认为这是因为`new VClient`在 Init 函数返回并调用下一个函数时创建尚未完成，因为在下`client_`一个函数中使用了。

我对所有这些线程业务都很陌生，我不确定这是否是正确的思路。我习惯于顺序执行代码，因此当代码从该`client_`行继续移动时，那是因为该行的所有内容都已完成。代码是否可以从这一行继续，并在新`VClient`的完全创建之前从 JNI Init 函数返回？如果是这样，我如何让这个函数等到类/对象创建完成？

```
JNIEXPORT void JNICALL Java_com_ClassDir_Init(JNIEnv *env, jobject obj)
{
  LOGI("%s", __PRETTY_FUNCTION__);
  if(!client_)
  {
    LOGI("Initializing client");
    client_ = new VClient(&callback_);
    [Bunch of JNI/JAVA class and methodID lookup and saving]
  }
  else
    LOGI("Client already initialized");
} 
```

*这`callback_`是一个处理向 JNI/JAVA 发送枚举类型信号以更新程序进度的类。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T10:03:40.963

你说`VClient`构造函数创建线程。**创建**线程是一个*同步*过程：在`VClient`线程完全创建并且很可能启动之前，ctor 的执行不会继续，因为我没有看到 VClient istance 上的任何其他方法调用来执行它。什么**不**同步，就是这个*开始*的线程。这并不意味着“完全可操作”，只是您的主线程已指示创建的线程开始在自己的上下文中运行。当新线程的执行循环建立并进入时，是完全异步的（对于您的 VClient 构造）并且取决于线程调度。因此，如果您的“下一个 JNI 函数”试图调用该线程并在那里使用一些资源，则该资源必须已经可用（这意味着您希望新线程已经进展到使其可用）并且可以访问必须保护该资源以进行线程安全访问。

所以你需要在这个线程业务中变得不那么新鲜 :-) 查找两个基本构建块：

1.  **等待条件**（也称为“阻塞条件变量”）。调用 VClient ctor 后，您将等待需要传递给线程的对象。线程将在完成其基本工作时通知条件，从而解除第一个线程中的等待。
2.  **互斥体**。每当有一个资源（数据结构）可以通过执行多个线程并发访问时，您需要在访问代码之前锁定互斥锁，然后再解锁。稍后到达的线程将在锁上阻塞，直到第一个线程完成。否则当两个线程试图修改同一个内存时，你会得到奇怪的结果或直接崩溃。

这些在每个操作系统和每个框架的各种 API 中实现不同。甚至同一操作系统上的不同框架也往往不同。但哲学是平等的。

顺便说一句，我理所当然地认为，当*“下一个 JNI 函数”*尝试使用它`client_`时，它不会超出范围。这可能意味着 JNI 实现中的全局变量——我没有看到本地代码的任何类包装器。

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T23:17:15.500

不。调用“new VClient()”的代码行不会继续到下一行，直到 VClient 构造函数退出。执行是顺序的。你的问题在别处。*

# visual-studio-2012 - Visual Studio 2012 先决条件：安装过程中出现致命错误

> ID：12502756
> 
> 赞同：6
> 
> 时间：2012-09-19T20:54:39.413
> 
> 标签：visual-studio-2012

是什么导致在安装 Visual Studio 2012 期间出现此错误？

![是什么导致在安装 Visual Studio 2012 期间出现此错误？](../Images/137cd1628106951d7b93697988b0f149.png)

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-30T06:33:31.437

在开始安装 VS2012 之前从 Internet 下载并安装，然后它不会显示任何错误

*   Visual Studio 2012 Update 1 - 从文档顶部提供的链接在线安装

*   Visual Studio 2012 的团队资源管理器

*   用于 TFS 2012 的 Team Explorer Everywhere 和 Update 1

*   .NET 4.5

*   Microsoft Visual Studio 2012 Update 1 的代理

*   Visual Studio 的 IntelliTrace 收集器

*   TFS 的反馈客户端 - 从文档顶部提供的链接在线安装

*   Visual Studio 2012 更新 1 的 C++ 可再发行组件

*   Visual Studio 2012 外壳

*   视觉工作室 2012 SDK

# clearcase - 如何在 ClearCase 中搜索活动以确定它是否已交付？

> ID：12502768
> 
> 赞同：1
> 
> 时间：2012-09-19T20:55:19.397
> 
> 标签：clearcase, cleartool, clearquest

我们结合使用 ClearQuest 和 ClearCase 进行代码版本控制。我们在 FixComplete 中有几个活动，但有些已经交付，有些还没有。我们希望找到已交付的活动，并将它们移至已关闭。有没有办法使用 cleartool 搜索特定的活动 ID 并查看它是否已交付？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T21:26:46.427

对于每个交付基线，您可以列出贡献活动的列表，以便查看哪些是交付的一部分。
请参阅“[描述基线并扩展交付和变基活动](https://stackoverflow.com/questions/9327917/describe-baseline-and-expand-deliver-and-rebase-activities)”。

不过，这不是一个明确的答案，因为您可以在交付*后*重用其中一项活动以进行额外的签入。

但是，如果您进行检查（描述已交付的活动，并列出*参与*的活动），您可以通过关闭它们关联的 ClearQuest 项来关闭这些活动。这将防止重复使用该活动进行签到。

# javascript - 滚动时如何获取div顶部位置值

> ID：12502769
> 
> 赞同：5
> 
> 时间：2012-09-19T20:55:22.920
> 
> 标签：javascript, jquery, javascript-events

当 div 滚动到某个点时，我正在尝试运行一些脚本。有一个固定的导航，当用户滚动窗口时，它假设一旦接近导航就会更改导航名称。我正在使用 $(window).scroll 函数，但它只检查一次 div 位置而不更新值。如何让滚动检查每移动 5-10 像素的窗口大小，以便它不会占用太多内存/处理。代码设置在：http: [//jsfiddle.net/rexonms/hyMxq/](http://jsfiddle.net/rexonms/hyMxq/)

HTML

```
<div id="nav"> NAVIGATION
  <div class="message">div name</div>
</div>
<div id="main">
<div id="a">Div A</div>
<div id ="b"> Div B</div>
<div id ="c"> Div C</div>
</div>​ 
```

CSS

```
#nav {
    height: 50px;
    background-color: #999;
    position:fixed;
    top:0;
    width:100%;

}

#main{
    margin-top:55px;
}
#a, #b, #c {
    height:300px;
    background-color:#ddd;
    margin-bottom:2px;
} 
```

脚本

```
$(window).scroll(function() {

    var b = $('#b').position();

    $('.message').text(b.top);

    if (b.top == 55) {
        $('.message').text("Div B");
    }
});​ 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-19T21:01:22.067

试试这个**[jsFiddle 例子](http://jsfiddle.net/j08691/hyMxq/1/)**

```
$(window).scroll(function() {
    var scrollTop = $(window).scrollTop(),
        divOffset = $('#b').offset().top,
        dist = (divOffset - scrollTop);
    $('.message').text(dist);
    if (b.top == 55) {
        $('.message').text("Div B");
    }
});​ 
```

您的原始代码仅检查 div 相对于文档顶部的位置，该位置永远不会改变。您需要计算窗口发生的滚动量并相应地计算。

还要注意 jQuery`.position()`和`.offset()`方法之间的区别。该`.position()`方法允许我们检索元素相对于偏移父元素的当前位置。将此与 对比`.offset()`，后者检索相对于文档的当前位置。

# java - VC++ 与 Java 的结果不一致

> ID：12502770
> 
> 赞同：2
> 
> 时间：2012-09-19T20:55:26.230
> 
> 标签：java, android, visual-c++, coordinates, trigonometry

我有一个在 PC 上运行的用 Visual C++ 编写的由来已久的例程，它根据纬度/经度坐标计算地球表面上两点之间的距离。

我已将其转换为 Java 作为 Android 移植的一部分，但我得到了不同的结果。为了调查其原因，我将一个复杂的三角方程拆分为多个位，以跟踪每一步发生的情况。

但是，在 Visual C++ 中，逐步计算的结果与复杂语句得到的结果不同，尽管它们显然应该是相同的。我想知道为什么！

正如预期的那样，Java 版本在这两种情况下都会产生相同的结果。

这是 Visual C++ 代码：

```
double CCoord::GetDistanceRadians(double dLatRadians, double dLongRadians)
{
    double dResult;

    // This is the step by step code
    double r1, r2, r3, r4, r5;
    r1 = sin(m_dLatRadians);
    r2 = sin(dLatRadians);
    r3 = cos(dLatRadians);
    r4 = m_dLongRadians - dLongRadians;
    r5 = cos(r4);

    r1 *= r2;
    r2 = r3 * r3;
    r2 *= r5;
    r4 = r1 + r2;

    // This is the original statement: r4 and dResult should be equal
    // (but they aren't)
    dResult = sin(m_dLatRadians) * sin(dLatRadians) +
        cos(m_dLatRadians) * cos(dLatRadians) * cos(m_dLongRadians - dLongRadians);

    // Protect against maths processor inaccuracies
    if ((dResult > 1.0) || (dResult < -1.0))
        dResult = 0.0;
    else
        dResult = acos(dResult);

    return dResult;
} 
```

这是Java代码：

```
 // Return angular distance in radians
private double getDistanceRadians(double dLatRadians, double dLongRadians)
{
    double result;

    // Do JIT test
    checkRadianValues();

            // This is the step by step code
    double r1, r2, r3, r4, r5;
    r1 = Math.sin(m_dLatRadians);
    r2 = Math.sin(dLatRadians);
    r3 = Math.cos(dLatRadians);
    r4 = m_dLongRadians - dLongRadians;
    r5 = Math.cos(r4);

    r1 *= r2;
    r2 = r3 * r3;
    r2 *= r5;
    r4 = r1 + r2;

    // This is the original statement: r4 and result should be equal
    // (and they are)
    result = Math.sin(m_dLatRadians) * Math.sin(dLatRadians) +
                Math.cos(dLatRadians) * Math.cos(dLatRadians) *
                Math.cos(m_dLongRadians - dLongRadians);

    // Protect against maths processor inaccuracies
    if ((result > 1.0d) || (result < -1.0d))
        result = 0.0d;
    else
        result = Math.acos(result);

    return result;
} 
```

这些是输入和结果值：

```
Variable         VC++ value         Java value
m_dLatRadians    0.896808347        0.896808378
m_dLongRadians  -0.047414778(0)    -0.047414778(6)
dLatRadians      0.896192633(9)     0.896192588(9)
dLongRadians    -0.026897463       -0.026897463
r4               1.000218106        1.0002181433
dResult/result   0.999917766        1.0002181433 
```

请任何人都可以建议为什么 r4 和 dResult 在 Visual C++ 版本中应该不同？

PS 我从 VC++ 版本中获得了良好的最终距离结果，而从 Java 中获得了糟糕的最终结果 - 几乎所有距离都为零（调用这些例程的更高级别的代码没有显示，因为它有很多！但是这是差异我有兴趣了解）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T21:07:21.327

在 C++ 代码中

```
cos(m_dLatRadians) * cos(dLatRadians) 
```

应该

```
cos(dLatRadians) * cos(dLatRadians) 
```

`r2 = r3 * r3;`与您在 Java 中所做的事情保持一致并匹配。

此外，正如[@CaseyB](https://stackoverflow.com/users/236136/caseyb)指出的那样，`dLatRadians`参数是不同的（就像 一样`m_dLatRadians`）。

# file-upload - 会话上传进度是否适用于 nginx 和 php-fpm？

> ID：12502775
> 
> 赞同：3
> 
> 时间：2012-09-19T20:55:50.163
> 
> 标签：file-upload, nginx, php

我正在运行 nginx 1.2.3 / php-fpm 5.4.6 并尝试使用[会话上传进度](http://www.php.net/manual/en/session.upload-progress.php)功能。在上传期间，`$_SESSION`绝不会包含任何上传数据。起初我假设编码错误，但即使是最简单/基本的上传进度测试也无法在`$_SESSION`. 我现在怀疑该文件被直接发布到 nginx，它完全处理从头到尾的上传，然后 nginx 将上传传递到 php-fpm 如此之快，以至于没有真正的“进度”要报告。我在这个评估中是否正确？如果是这样，我该如何解决这个问题？

phpconfig 确认 session.upload 设置都设置正确。

下面是当前的测试代码，从[这个博客](http://codeseekah.com/2012/03/09/file-upload-progress-in-php-5-4/)借来的。

```
<?php
  /* File upload progress in PHP 5.4 */

  /* needs a 5.4+ version */
  $version = explode( '.', phpversion() );
  if ( ($version[0] * 10000 + $version[1] * 100 + $version[2]) < 50400 )
    die( 'PHP 5.4.0 or higher is required' );

  if ( !intval(ini_get('session.upload_progress.enabled')) )
    die( 'session.upload_progress.enabled is not enabled' );

  session_start();

  if ( isset( $_GET['progress'] ) ) {

    $progress_key = strtolower(ini_get("session.upload_progress.prefix").'demo');

    if ( !isset( $_SESSION[$progress_key] ) ) exit( "uploading..." );

    $upload_progress = $_SESSION[$progress_key];
    /* get percentage */
    $progress = round( ($upload_progress['bytes_processed'] / $upload_progress['content_length']) * 100, 2 );

    exit( "Upload progress: $progress%" );
  }
?>

<script type="text/javascript" src="http://code.jquery.com/jquery-1.7.1.min.js"></script>

<?php if ( isset($_GET['iframe']) ): /* thank you Webkit... */ ?>
<form action="" method="POST" enctype="multipart/form-data">
  <input type="hidden" name="<?php echo ini_get("session.upload_progress.name"); ?>" value="demo">
  <input type="file" name="uploaded_file">
  <input type="submit" value="Upload">
</form>

<script type="text/javascript">
window.location.hash = ""; /* reset */
jQuery("form").bind("submit", function() { window.location.hash = "uploading"; });
</script>

<?php else: ?>

<iframe src="?iframe" id="upload_form"></iframe>
<script type="text/javascript">
  jQuery(document).ready(init);

  function init() {
    /* start listening on submit */
    update_file_upload_progress();
  }

  function update_file_upload_progress() {
    if ( window.frames.upload_form.location.hash != "#uploading" ) {
      setTimeout( update_file_upload_progress, 100 ); /* has upload started yet? */
      return;
    }
    $.get( /* lather */
      "?progress",
      function(data) {
        /* rinse */
        jQuery("#file_upload_progress").html(data);
        /* repeat */
        setTimeout( update_file_upload_progress, 500 );
      }
    ).error(function(jqXHR, error) { alert(error); });
  }
</script>

<div id="file_upload_progress"></div>
<?php endif; ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T09:42:04.513

php.net 文档页面中的注释说：

> s.zarges 2012 年 6 月 19 日 09:32
> 请注意，当您的网络服务器通过 FastCGI 运行 PHP 时，此功能不起作用。会话数组中不会有进度信息。

不幸的是，PHP 仅在上传完成后才能获取数据，并且无法显示任何进度。

# security - CAPICOM dll 在 x64 位服务器中不起作用

> ID：12502779
> 
> 赞同：0
> 
> 时间：2012-09-19T20:56:23.600
> 
> 标签：security, cryptography

我在我的项目中使用 CAPICOM dll 来生成证书。在我的 32 位系统本地机器上，它工作正常，但在我托管我的应用程序的服务器上，它是 64 位服务器机器，它给出了 0x80090020 错误。

作为我的本地计算机，我在 system32 文件夹中使用 regsvr32 CAPICOM.dll 命令注册 CAPICOM.dll，并在 system32 和 syswow64 两个文件夹中使用 regsvr32 CAPICOM.dll 命令注册 CAPICOM.dll。显示 dll 注册成功的消息。

当我运行我的应用程序时，它会给出 0x80090020 错误。此错误表示“内部服务器错误”。

我不想使用 CAPICOM.dll 的其他替代品。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T07:54:59.513

您需要将 64 位版本的“CAPICOM.dll”放在 64 位机器上的 system32 文件夹中。我不确定他们的 regsvr32 命令。对于 64 位库，它可能会有所不同。

# html - Safari 6 无法播放 .mov 文件

> ID：12502782
> 
> 赞同：0
> 
> 时间：2012-09-19T20:56:35.480
> 
> 标签：html, video, safari, .mov

我在这里扯头发，试图弄清楚为什么 Safari (v6) 不会播放 .mov 文件。这是我的设置，简化 -

```
<video width="800" height="450" controls="controls" preload="none">
    <source src="example.mov" type="video/mp4" />
    Your browser can't play this video.
</video> 
```

我想要实现的是将电影剪辑从 iPhone 上传到 WordPress 博客。iPhone 使用 h264 编码将视频保存在 .mov 中（正确吗？）。客户端在上传时渲染其他格式太麻烦了，我们决定以这种格式解决。
在 Chrome 中，我可以看到这个视频，但在 Safari 中它不会播放，即使直接访问文件也是如此。播放器只需显示带有加载语句的 UI 栏。我没有错误。
我还确保将 .htaccess 文件设置为包含 .mov / quicktime 的 AddType。
我可能会错过什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-21T11:47:55.320

你能把这个例子放到网上吗？`example.mov`最好用[ffprobe](http://ffmpeg.org/ffprobe.html)进行检查。

IOS Safari 似乎对 MP4 的编码方式非常敏感。我发现唯一对我有用的是`libx264-ipod640.ffpreset`with ffmpeg。有关更多信息，请参见[https://github.com/kaihendry/recordmydesktop2.0](https://github.com/kaihendry/recordmydesktop2.0)。

# angularjs - angularjs中的动态指令

> ID：12502783
> 
> 赞同：5
> 
> 时间：2012-09-19T20:56:38.830
> 
> 标签：angularjs

更新范围时指令的属性不会改变，它们仍然保持初始值。我在这里想念什么？

**HTML**

```
<ul class="nav nav-pills nav-stacked" navlist>
    <navelem href="#!/notworking/{{foo}}"></navelem>
    <navelem href="#!/working">works great</navelem>
</ul>

<p>works: {{foo}}</p> 
```

**Javascript** （基于首页上的角度标签示例）

```
angular.module('myApp.directives', []).
directive('navlist', function() {
    return {
        scope: {},
        controller: function ($scope) {
            var panes = $scope.panes = [];

            this.select = function(pane) {
                angular.forEach(panes, function(pane) {
                    pane.selected = false;
                });
                pane.selected = true;
            }

            this.addPane = function(pane) {
                if (panes.length == 0)
                    this.select(pane);
                panes.push(pane);
            }

        }
    }
}).
directive('navelem', function() {
    return {
        require: '^navlist',
        restrict: 'E',
        replace: true,
        transclude: true,
        scope: { href: '@href' },
        link: function(scope, element, attrs, tabsCtrl) {
            tabsCtrl.addPane(scope);
            scope.select = tabsCtrl.select;
        },
        template:
            '<li ng-class="{active: selected}" ng-click="select(this)"><a href="{{href}}" ng-transclude></a></li>'
    };
}); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-19T23:28:49.363

通过`scope: {}`在您的指令中定义，它正在创建一个`isolated scope`. 所以父范围现在从指令中是不可见的。

如果你想引用父作用域，那么你可以把`scope: true`共享作用域（在相同的指令中）放在普通作用域嵌套中省略作用域声明。或者，如果您只想引用`$scope.foo`父级，则可以像在子指令中所做的那样定义显式范围变量。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-01T05:00:35.470

指令范围继承分为三种类型：

1.  没有“范围：...”或显式`scope: false`- 没有创建新范围。该指令使用与父级相同的范围。这既简单又方便，但是如果您正在构建可重用的组件，则不建议这样做，因为该指令可能仅在父作用域具有定义指令需要使用/访问的某些作用域属性时才可用。
2.  `scope: true`- 创建一个新范围，由同一元素上的所有指令共享，具有父范围的正常原型继承。同样，可能不是可重用组件的最佳选择，因为该指令可能不应该访问父范围属性——它可能会意外更改父范围内的某些内容。
3.  `scope: { ... }`- 创建一个新的“隔离”范围——它在原型上并不从父范围继承。但是，对象散列（即 { ... } ）允许我们定义从父范围派生的本地指令范围属性——因此我们可以控制哪些属性是共享的，以及如何共享。
    1.  使用 '=' 在父作用域属性和指令作用域属性之间进行强大的双向绑定——对任一作用域属性的更改都会影响另一个。
    2.  使用“@”将父属性值绑定到指令范围属性。这本质上是单向绑定。只有父范围更改会影响指令范围。
    3.  使用 '&' 绑定到父范围表达式/函数。

对于您的特定问题，您需要在对象哈希中指出您希望哪些范围属性具有 2-way 绑定。

有关指令范围（包括图片）的更多信息，请参阅此处的**指令部分：** [AngularJS 中范围原型/原型继承的细微差别是什么？](https://stackoverflow.com/questions/14049480/what-are-the-nuances-of-scope-prototypal-prototypical-inheritance-in-angularjs)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-20T14:13:36.573

就像 Mark Rajcok 所说 - scope: {} 将创建一个新的隔离范围，它不会从父级继承属性，但是我们仍然可以通过使用 $parent 属性来访问这些属性。

**控制器：**

```
app.controller('indexController', function($scope) {
    $scope.test="Hello world!";
}); 
```

**指示**

```
app.directive("test", function() {
    return{
        restrict: "A",
        scope: {},
        controller: function($scope){
            console.log("directiv $scope.$parent.test: " + $scope.$parent.test);
            console.log("directiv $scope.test: " + $scope.test);
        }
    };
}); 
```

**输出：**

```
directiv $scope.$parent.test: Hello world!
directiv $scope.test: undefined 
```

# css - 如果我在上面的 div 中使用 clearfix，页脚会在 Chrome 中吓坏

> ID：12502784
> 
> 赞同：0
> 
> 时间：2012-09-19T20:56:39.830
> 
> 标签：css, footer, clearfix

如果我删除了页脚上方的 clearfix div，文本就会就位，就像在 Firefox 上一样。

但这会破坏其他事情。我不明白 clearfix 是如何影响页脚的...

我的页面：

[http://www.craftonhills.edu/Current_Students/Counseling/Assessment.aspx](http://www.craftonhills.edu/Current_Students/Counseling/Assessment.aspx)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T21:04:34.367

它看起来像您的页脚元素，因为这些样式规则与之关联：

```
#footer {
    clear: both;
    font-size: 1.4em;
    height: 150px;
    margin-top: -150px;
    position: relative;
} 
```

如果您删除该`margin-top: -150px`规则，Chrome 似乎会被清除。

在#content 样式中，您似乎有一条`padding-bottom: 150px;`规则将所有内容都推低了很多。可能也想减少一点。

如果您的目标是粘性页脚，出于某种原因，将`margin-bottom: -150px;`规则添加到`#container`元素中对我来说在 Firefox、Chrome 和 IE 中有效。但是，我认为它比 150px 高一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T22:42:29.380

我最终在我的 clearfix div 下方添加了一个 .push div，使其高度为 180 像素（正确的高度，带有填充，而不是 150 像素）。不是语义的，但它似乎修复了 Chrome。

# java - 我在做什么错最后一部分没有打开一个盒子或给出一个错误？

> ID：12502787
> 
> 赞同：0
> 
> 时间：2012-09-19T20:57:24.650
> 
> 标签：java

我已经尝试了很多东西，其中一部分会运行，另一部分不会给我错误，但盒子不会打开我正在寻找的答案。我不确定我发布的问题是否完全正确，这是我第一次，也不知道在哪里发布我一直在研究的程序。很抱歉，如果我打扰了您，我确实搜索并阅读了，但我束手无策。– 帕梅拉·海耶 16 小时前

尝试再次发布，但也要发布您的代码并说明哪个部分没有按预期工作或给出错误。这里 (stackoverflow.com/questions/12488605/...) 是一个很好的简单示例，它提供了一些代码，然后说明哪个部分不起作用，并提出一个问题。– dann.dev 16 小时前

```
double averageNumber;
double sum;
sum = (number1 + number2 + number3);
averageNumber = (number1 + number2 + number3) /3; //Display results 
JOptionPane.showMessageDialog(null, "The sum of the three numbers is " + sum + "and the average of the numbers is " + averageNumber); 
```

此代码的最后一部分不起作用。我希望盒子打开并给我总和和平均值。我如何找出我做错了什么？第一部分工作，盒子打开，你输入三个数字，然后我什么也得不到。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T21:14:41.677

当我跑

```
public static void main(String... args) {
    double number1 = 5, number2 = 6, number3 = 7;

    double averageNumber;
    double sum;
    sum = (number1 + number2 + number3);
    averageNumber = (number1 + number2 + number3) /3; //Display results
    JOptionPane.showMessageDialog(null, "The sum of the three numbers is " + sum + "and the average of the numbers is " + averageNumber);
} 
```

它显示

![显示结果](../Images/17dd709aab7208dfb43a5c5f084de0f8.png)

如果有问题不在您提供的代码中。

顺便说一句：我会在`sum`;)之后添加一个空格

# windows - 如何从现有的matlab中制作新的结构？

> ID：12502793
> 
> 赞同：1
> 
> 时间：2012-09-19T20:58:35.577
> 
> 标签：windows, matlab

我有`stations`字段的结构`name`和`code`. 例如：

```
stations = struct(...
    'name',{'a','b','c','d'},...
    'code',{[0 0],[0 1],[1 0],[1 1]}) 
```

（我将改变这个结构，添加新的站点名称和代码等。）我想创建一个新的结构`sessions'`，它也有字段`name`，`code`但值将是两个站点的组合？

例如：

```
stations = struct(...
    'name',{'ab','ac','ad','bc','bd','cd'},...
    'code',{[0 0 0 1],[0 0 1 0],[0 0 1 1],[0 1 1 0],[0 1 1 1],[1 0 1 1]}). 
```

我正在尝试类似的东西：

```
for i=1:numberOfStations-1
    for j=i+1:numberOfStations
        strcat(stations(i).name,stations(j).name);
        cat(2,stations(i).code,stations(j).code);
    end 
end 
```

但我不知道将这些值放在哪里。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T21:20:11.607

您拥有的`struct`是一个结构数组，因此您可以访问每个元素，例如：

```
stations(1)

ans = 

    name: 'a'
    code: [0 0] 
```

然后对于特定的元素和成员

```
stations(2).name

ans =

b 
```

如果要添加到结构中，可以执行以下操作：

```
stations(end+1) = struct('name','hi','code',[1 1]); 
```

如果要将新的结构数组合并到当前结构：

```
% current struct array, stations
% new data, new_station_data
for ii=1:length(new_station_data)
    station(end+1) = new_station_data(ii);
end 
```

希望这可以帮助！

# iis - 在 Umbraco 中将 BlogEngine 实现为应用程序

> ID：12502794
> 
> 赞同：0
> 
> 时间：2012-09-19T20:58:51.187
> 
> 标签：iis, umbraco, blogengine.net

我安装了 Umbraco v4.9.0，我正在尝试在其中安装 BlogEngine.NET v2.6.0.5

这是在 Windows 8 机器上的 IIS8 中。

到目前为止，我已经能够在子文件夹中设置 BlogEngine 并且该应用程序运行良好，直到我尝试打开带有`cshtml`扩展名的页面。

我得到的错误是

> 不提供此类页面。
> 
> 说明：您请求的页面类型未提供服务，因为它已被明确禁止。扩展名“.cshtml”可能不正确。请查看下面的 URL 并确保其拼写正确。
> 
> 请求的 URL：/blog/admin/default.cshtml

两个 web.configs 都有旨在防止此错误发生的条目。

**乌姆布拉科**

```
<buildProviders>
<add extension=".cshtml" 
     type="umbraco.MacroEngines.RazorBuildProvider, umbraco.MacroEngines" />
<add extension=".vbhtml" 
     type="umbraco.MacroEngines.RazorBuildProvider, umbraco.MacroEngines" />
<add extension=".razor" 
     type="umbraco.MacroEngines.RazorBuildProvider, umbraco.MacroEngines" />
</buildProviders> 
```

**博客引擎**

```
<buildProviders>
<remove extension=".cshtml" />
<add extension=".cshtml" 
type="System.Web.WebPages.Razor.RazorBuildProvider, System.Web.WebPages.Razor"/>
</buildProviders> 
```

我在各自的 bin 文件夹中有相关的 MVC 二进制文件，我什至尝试向两个 web.configs 添加请求过滤指令，例如

```
<requestFiltering>
    <fileExtensions>
        <add fileExtension=".cshtml" allowed="true" />
    </fileExtensions>
</requestFiltering> 
```

我错过了什么明显的东西吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T10:03:55.710

您的 IIS 站点是在经典模式还是集成模式下运行？尝试切换到集成模式，看看是否能解决您的问题。

# script# - 控制 C# 属性的函数名称

> ID：12502796
> 
> 赞同：0
> 
> 时间：2012-09-19T20:58:59.970
> 
> 标签：script#

我在 C# 中有这段代码（作为 ImportLibrary）：

```
[IgnoreNamespace]
[Imported]
public class MyClass
{
    public object Value
    {
        get { return null; }
        set { }
    }
} 
```

然后我像这样开始上课：

```
myClass.Value = 0;
obj val = myClass.Value; 
```

一切都很好并且可以编译 - 这很好:) 但是，结果是这样的：

```
myClass.set_value(0);
var val = myClass.get_value(); 
```

我真正想要的是：

```
myClass.setValue(0);
var val = myClass.getValue(); 
```

因此，没有下划线 (_) 和大写字母。我该如何控制这个？我试过 [ScriptName("Value")]，但没有运气。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T17:07:33.213

Right now there isn't support for that pattern of properties. You'd simply have to have methods - GetValue and SetValue.

Its changeable of course, but I fear creating endless set of permutations for all the possible different patterns when looking at script generation overall, rather than just property syntax. I actually am not attached to "get_" ... it was simply to separate what is the actual name vs. what was tacked on, as well as to use the same pascal-case to camel-case routine already in place ... so open to the idea of switching to just "get" but it would need to apply to "add_" and "remove_" as well for events. Why don't you open an issue on the script# github repo (https://github.com/nikhilk/scriptsharp), and see if there is concensus for changing?

So to understand the motivation, is it because you're trying to generate script that something else existing is calling and hence must be called "getValue"... or is this stemming from preference.

# iphone - 遍历 NSFetchRequest 结果时崩溃且没有错误

> ID：12502800
> 
> 赞同：0
> 
> 时间：2012-09-19T20:59:16.313
> 
> 标签：iphone, objective-c, ios, core-data, nsfetchrequest

我正在使用一个`NSFetchRequest`上下文中的所有核心数据实体，并将它们移动到另一个上下文中。

只需 1 个实体就可以正常工作。我可以非常快速地遍历结果。然而，该实体与另一个实体有关系，所以我需要运行第二个`NSFetchRequest`来获取通过这种关系连接的实体。`NSFetchRequest`这是导致崩溃的第二个。崩溃只是使应用程序退出到主屏幕，并且 xcode 日志中没有错误出现。我已经注释掉了我的代码以找出问题所在，并将其归结为：

```
 NSError *error;
    NSFileManager *manager = [NSFileManager defaultManager];

    NSManagedObjectContext *oldContext = [self version1ManagedObjectContext];
    TICDSSynchronizedManagedObjectContext *newContext = [self version1_1ManagedObjectContext];

    NSFetchRequest *oldFetchRequest = [[NSFetchRequest alloc] init];
    NSEntityDescription *oldEntryEntity = [NSEntityDescription entityForName:@"Entry"
                                                      inManagedObjectContext:oldContext];
    [oldFetchRequest setEntity:oldEntryEntity];
    [oldFetchRequest setFetchBatchSize:10];
    NSArray *entrys = [oldContext executeFetchRequest:oldFetchRequest error:&error];

    int totalEntries = [oldContext countForFetchRequest:oldFetchRequest error:nil];

    NSLog(@"total entries: %i", totalEntries);

    int i = 0;

    while (i < totalEntries) {
        @autoreleasepool {

            Entry *entry = [entrys objectAtIndex:i];

            Entry *newEntry = [NSEntityDescription
                               insertNewObjectForEntityForName:@"Entry"
                               inManagedObjectContext:newContext];

            //Taking out this fetch request means it functions fine
            NSFetchRequest *mediaRequest = [[NSFetchRequest alloc] init];

            NSEntityDescription *mediaEntity = [NSEntityDescription
                                                entityForName:@"Media"
                                                inManagedObjectContext:oldContext];

            [mediaRequest setEntity:mediaEntity];

            NSPredicate *predicate = [NSPredicate predicateWithFormat:
                                      @"(entry == %@)", entry];
            [mediaRequest setPredicate:predicate];

            NSArray *mediaItems = [oldContext executeFetchRequest:mediaRequest error:&error];

            int totalMediaItems = [oldContext countForFetchRequest:mediaRequest error:nil];

            NSLog(@"total media items: %i", totalMediaItems);

            int i2 = 0;

            while (i2 < totalMediaItems) {
                @autoreleasepool {

                    Media *newMedia = [NSEntityDescription
                                       insertNewObjectForEntityForName:@"Media"
                                       inManagedObjectContext:newContext];

                    i2++;

                }
            }

            [newContext save:&error];

            i++;
        }
    } 
```

任何想法为什么这可能会使我的应用程序崩溃？

在回答有关我正在尝试做什么的任何问题时 - 我正在尝试在 2 个版本之间迁移数据。使用映射的标准数据迁移不适用于大数据，例如`NSData`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T21:18:51.277

我相信您没有在这里公开的更多代码行。您将数据从旧实体复制到新实体的那些......
也许问题就在那里。

无论如何，我会在每 2 行代码之间添加 NSLog，看看哪个是最后打印的...
我认为某些东西是在内部循环中自动释放的，您尝试在下一次迭代中使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-20T00:09:46.510

我建议您编辑用于构建和启用诊断选项卡的所有内容的方案。这可能会吐出可能导致问题的任何原因。

# visual-studio-2012 - VS 2012 中 F5 上的“无法启动程序”

> ID：12502804
> 
> 赞同：1
> 
> 时间：2012-09-19T20:59:33.713
> 
> 标签：visual-studio-2012

全新的 Windows 8 发布版本。新鲜 VS 2012。新鲜的新项目。没有代码改变。按 F5 并获得：

> 无法启动程序“http://localhost:2209/”。
> 
> 该系统找不到指定的文件。

拥有管理员权限。以管理员身份运行，提升。

在全新安装时看到这一点非常震惊。唯一安装的其他东西是Chrome。使用进程监视器，我可以看到 IIS Express 一切正常。内部浏览器启动正常并显示站点。它甚至在 Azure 上发布，所以它的构建很好。

Procmon 中的唯一错误是 C:\DATA\Code\My.Solution.Folder\enc_temp_folder 上的“NAME NOT FOUND”

我尝试制作这个文件夹，有趣的是，VS 删除了它。我认为 Procmon 正在采取一些清理行动。

更新 1

将 c:\Program Files\Internet Explorer\iexplore.exe 添加到“Browse with...”程序中，但它没有第二次添加它，所以我用假开关添加了它，并且发生了同样的错误。添加 x86 iexplore.exe 会导致调试器加载但没有 IE。

添加了 Chrome.exe 的路径并且可以正常工作。似乎 IE 10 是开箱即用的 FUBAR。

更新 2

通过程序和功能重新安装了 IE 10，但没有运气。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T20:21:11.607

看起来很可能是这样的：

[http://connect.microsoft.com/VisualStudio/feedback/details/758876/visual-studio-2012-unable-to-start-program-error-when-debuging-website-on-win8-ie10](http://connect.microsoft.com/VisualStudio/feedback/details/758876/visual-studio-2012-unable-to-start-program-error-when-debuging-website-on-win8-ie10)

会更新。

# html - IE9溢出隐藏问题

> ID：12502805
> 
> 赞同：5
> 
> 时间：2012-09-19T20:59:44.790
> 
> 标签：html, css, internet-explorer, internet-explorer-9, overflow

我在 IE9 中遇到问题（至少，没有检查其他 IE），其中一个 div`overflow:hidden`被它的子 div 忽略。图中蓝色轮廓的 div 是`overflow:hidden`容器 div。图像应包含在容器中。

我知道将容器 div 设置为`position:relative`将起作用，但是如果我这样做，绝对定位的“上一个”和“下一个”按钮将不会显示。

这在 Firefox 和 Chrome 中显示正常

**实际的** ![实际的](../Images/9cbdc07f6e19348a6ec16852fb0dbf58.png)

**预期的** ![预期的](../Images/af2e3473b83e1fade666aa83690ae7e7.png)

html

```
<div id="instagramViewer" class="slideshow">
    <div class="slideshowButton" id="prevImage" style="display: block;">
        <a href="#" title="Previous">Previous</a>
    </div>
    <div class="slideshowButton" id="nextImage">
        <a href="#" title="Next">Next</a>
    </div>
    <div class="contentItem>
        <span class="contentItem" style="display: block;">
            <a href="javascript: void(0);">
                <img alt="words" src="http://www.example.com/image.jpg">
            </a>
            <div class="detailsWrapper" style="display: none; opacity: 0.678511;">...</div>
        </span>
        <span class="contentItem" style="display: block;">
            <a href="javascript: void(0);">
                <img alt="words" src="http://www.example.com/image.jpg">
            </a>
            <div class="detailsWrapper" style="display: none; opacity: 0.678511;">...</div>
        </span>
        <span class="contentItem" style="display: block;">
            <a href="javascript: void(0);">
                <img alt="words" src="http://www.example.com/image.jpg">
            </a>
            <div class="detailsWrapper" style="display: none; opacity: 0.678511;">...</div>
        </span>
    </div>
</div> 
```

css

```
.instagramViewerWrapper .slideshow {
    overflow: hidden;
}
.instagramViewerWrapper .slideshow .content {
    margin-left: 256px;
    padding-top: 14px;
    position: relative;
    white-space: nowrap;
}
.instagramViewerWrapper .slideshow .content .contentItem {
    display: inline-block !important;
    margin: 0 14px 0 0;
    vertical-align: top;
}
.instagramViewerWrapper .slideshow .slideshowButton {
    margin-top: 20%;
    position: absolute;
}
.instagramViewerWrapper .slideshow #prevImage {
    left: -75px;
}
.instagramViewerWrapper .slideshow #nextImage {
    right: -75px;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-19T21:25:49.793

尝试添加`position:relative`到`overflow:hidden`在您的 css 正下方溢出添加位置相对的元素。我以前在 IE 中遇到过这个问题，并且修复了它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-20T16:45:09.627

我有几个想法。

1.  尝试将内容项的显示样式更改为 inline-block。
2.  尝试将幻灯片的内容包装在相对定位的 div 中 - 这会告诉浏览器后代的呈现顺序。（你需要重新计算你的上一个和下一个按钮的位置。事实上，它们不再需要绝对定位——它们可以在包装之外，左右浮动。或者你可以相对于身体绝对定位它们。由你决定。）

# iphone - MPMediaPickerController.showsCloudItems 似乎什么都不做

> ID：12502806
> 
> 赞同：16
> 
> 时间：2012-09-19T20:59:45.070
> 
> 标签：iphone, ios, itunes, mpmediapickercontroller

在 Apple 上发布此消息时运气不佳，但现在 iOS 6 NDA 已启动，希望更多人能在这里看到它。

我正在尝试修改应用程序以仅允许用户选择已在本地下载的音乐。我在 iOS 6 GM 下有以下代码：

```
 MPMediaPickerController* mpc = [[MPMediaPickerController alloc] initWithMediaTypes: MPMediaTypeAnyAudio];

mpc.allowsPickingMultipleItems = YES;
mpc.modalPresentationStyle = UIModalPresentationCurrentContext;
mpc.showsCloudItems = NO;

[self presentViewController:mpc animated:YES completion:nil]; 
```

从文档中：

> 媒体项目选择器的默认行为是 YES，这意味着选择器显示可用的 iCloud 项目。如果媒体项目可通过 iTunes Match 获得并且尚未存储在设备上，则该媒体项目被视为 iCloud 项目。

我认为这意味着如果启用了 iTunes Match，则只有已下载到设备的项目才会显示在选择器中，但我总是会看到整个 iTunes Match 库。我为此提交了一个雷达，因为它似乎是一个严重的错误。如果有人可以告诉我，我很想知道我在这里缺少什么。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2014-04-07T18:24:40.113

这似乎是一个操作系统问题。

正确使用会`picker.showsCloudItems = NO;`显示**更少的**歌曲，而不是整个列表...列出的歌曲要么是在音乐应用程序中手动下载的歌曲，要么是流式传输并因此缓存的歌曲。

至少在我的情况下，问题在于处理缓存的问题。

如果我选择一首手动下载的歌曲，则值为`MPMediaItemPropertyIsCloudItem`is `NO`，这是正确的。我还可以通过该`MPMediaItemPropertyAssetURL`属性访问资产的 URL。

另一方面，选择一首被缓存的歌曲会不断返回，`YES`这让这首歌对我来说几乎毫无用处。`MPMediaItemPropertyIsCloudItem``nil``MPMediaItemPropertyAssetURL`

抱歉，我没有实际的答案，但我没有足够的声誉来简单地发表评论。

希望我的 2 美分能以某种方式有所帮助，但在我看来，这个问题真的只能由 Apple 在未来的更新中解决。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-24T14:10:46.263

在 didPickMediaItems 委托中测试项目是否来自 iCloud 的更好解决方案：

```
 MPMediaItem *selectedItem = [selectedItems objectAtIndex:0];

     if (![[selectedItem valueForProperty:MPMediaItemPropertyIsCloudItem] boolValue]) 
```

你真的不需要播放它，使用 MPMediaItem 中的嵌入属性更有效。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-16T00:24:11.957

I had this same problem. Although I was unable to hide the items, here's a good workaround that I used to prevent people from being able to select them. Inside `didPickMediaItems`, you should temporarily load it into an `AVPlayerItem` and then just check the validity of that item like so:

```
- (void)mediaPicker:(MPMediaPickerController *)mediaPicker didPickMediaItems:(MPMediaItemCollection *)mediaItemCollection
{
   MPMediaItem *selectedItem = [[mediaItemCollection items]objectAtIndex:0];
   NSURL *tempURL = [selectedItem valueForProperty:MPMediaItemPropertyAssetURL];
   AVPlayerItem *playerItem = [[AVPlayerItem alloc]initWithURL:tempURL];

   if(playerItem.loadedTimeRanges==NULL)
   {
     UIAlertView *alert=[[[UIAlertView alloc]initWithTitle:NSLocalizedString(@"Invalid Song Choice",NULL) message:NSLocalizedString(@"Please choose a song that is local to your phone.",NULL) delegate:self cancelButtonTitle:NSLocalizedString(@"Okay",NULL) otherButtonTitles:nil]autorelease];
     [alert show];
     [playerItem release];
   }
   else
   { 
       NSLog(@"Your good to go...do whatever you want with the local song");
   }
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-12-16T21:18:08.790

它似乎已在 iOS 7 中修复。

以下代码有效；iCloud 项目未显示：

```
 MPMediaPickerController *picker = [[MPMediaPickerController alloc] initWithMediaTypes: MPMediaTypeMusic];
 picker.delegate = self;
 picker.allowsPickingMultipleItems   = NO;
 picker.showsCloudItems = NO; 
```

# java - 如何获取列表中每个元素的计数？

> ID：12502807
> 
> 赞同：2
> 
> 时间：2012-09-19T20:59:52.027
> 
> 标签：java

给定某事物的排序列表 (a,a,b,c,c)

`a`识别列表中存在 2 次、`b`一次和2 次的最有效方法是`c`什么？

除了明显地制作一张计数图。我们能做得更好吗？

```
 if (map.containsKey(key)) {
                map.put(key, map.get(key) + 1);
            } else {
                map.put(key, 1);
            } 
```

最终目标是迭代列表并知道在任何给定点之前看到过多少次键。将事物放入地图中，似乎是我们并不真正需要的一步。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T21:04:38.450

我会在[Guava](https://code.google.com/p/guava-libraries/)[`Multiset`](http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/Multiset.html)中使用一个实现——可能是. 这避免了必须在每次迭代中执行/ - 如果添加时该项目已经存在，它只会增加计数。这有点像使用.[`HashMultiset`](http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/collect/HashMultiset.html)`put``get``HashMap<Foo, AtomicInteger>`

有关更多详细信息，请参阅[Guava 用户指南条目。`Multiset`](http://code.google.com/p/guava-libraries/wiki/NewCollectionTypesExplained#Multiset)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-19T21:05:31.687

你的方法，在每次迭代中，都会使

*   一次查找 containsKey
*   一次查找获取
*   一个从整数到整数的拆箱
*   从 int 到 Integer 的一拳击
*   一放

您可以简单地将当前元素与前一个元素进行比较，如果相等则增加一个计数，如果不相等则放入计数（并将计数器重置为 1）。

但即使你保留你的算法，使用 get 并将结果与​​ null 进行比较至少可以避免不必要的查找。

# c# - .net 中的三层应用程序

> ID：12502810
> 
> 赞同：-6
> 
> 时间：2012-09-19T21:00:32.077
> 
> 标签：c#, wpf, wcf

我目前正在当地的一所大学学习 MCPD，我已经形成了我的讲师对他/她的学科知之甚少的基础。

这是我们从该地区的另一位讲师那里得到的项目。

（它在 VS 2010 中并通过 C#）

> 为辅导员创建一个 3 层应用程序来处理学生/
> 
> 1（创建数据库）<----这很容易并且实际上很有意义。做到这一点不费吹灰之力
> 
> 2 - 创建一个 DataLayer - 这必须是一个 DataService
> 
> 2.1 将 .edmx 模型添加到从您在步骤 1 中创建的数据库生成的 DataService
> 
> 2.2 添加以下可查询服务操作符：
> 
> 2.2.1 GetStudent() - 列出数据库中的所有学生
> 
> <<<<-- 此处还有 5 个查询-->>>>
> 
> 2.3 - 仅授予您的所有客户对您所有实体的读取权限。
> 
> 2.4 - 授予所有客户对所有服务操作和学生实体的读/写（是的，我从页面中引用）权限。
> 
> 2.5 - 配置您的 Service1.svc 文件以使用 System.Data.Services.DataServiceHostFactory
> 
> 3 - 创建一个 Wpf 应用程序
> 
> 3.1 使用户能够根据他们的登录查看学生、资格等。
> 
> 3.2 创建功能以允许辅导员使用 xml 文件广告新学生。
> 
> 3.3 必须创建一个 Add using xml 或 Add using text files 窗口。

现在，我的免责声明：我绝对不是专家或任何好东西。我有 4 年的 WinForms 数据库经验。所以这是一些非常有限的知识。

但是：我的知识有限..告诉我nr 2.想要一个Web服务或后者的东西然后不使用它，而是使用WPF应用程序与数据库通信。

现在我愿意侮辱这个经过深思熟虑的项目的想法，我也愿意接受这个事实，如果我错了或没有正确理解。

那么现在，任何人都可以向我解释这个项目是否可行或精明？

如果是这样，我将欣然接受推理并承认我的失败。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T21:03:49.020

描述完全令人困惑，但我的假设是您应该使用 EF 创建模型，然后将其包装在 WCF 服务中，然后让 WPF 应用程序与 Web 服务通信。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T21:09:35.207

我真的不明白这里有什么问题。

基本上你：

1.  创建一个数据库（meh）
2.  创建一个 DataLayer，即一个独立的类库，其中包含描述数据库中每个实体的对象（如果你想看起来很酷，你可以使用`NHibernate`/ ，或者你可以简单地创建对象并在单独的方法中定义数据库查询，这些方法只是在数据库中读取`EntityFramework`并返回您在 DataLayer 中定义的对象，但其中包含详细信息）
3.  创建一个 WPF 应用程序，该应用程序将使用此 DataLayer 作为模型，并显示一个 GUI 以允许用户浏览学生（即查询学生数据库，添加/编辑/删除他们的详细信息......）。

再一次，这对我来说似乎都很基本，除非我不明白

# css - 修复 CSS 文件：规则上的冒号后有空格，而不是选择器（Sublime Text 2）

> ID：12502820
> 
> 赞同：0
> 
> 时间：2012-09-19T21:01:07.053
> 
> 标签：css, sublimetext2

好的——我有一个巨大的 css 文件，继承自另一个设计师。我正在清理它。我需要做的一件事是在冒号后为规则添加一个空格，而不是选择器。IE：

```
.selector:after {
foo: bar;
} 
```

我在 foo: 之后添加一个空格：但不是在 .selector 之后（在选择器：和之后）。

我假设有一种比查找/替换和手动/视觉跳过选择器冒号更简单的方法，但任何建议都值得赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T21:20:31.190

为什么创建正则表达式会很好用。我认为最简单和最快的方法是简单地使用你的 IDE 的查找和替换在每个冒号后添加一个空格，然后再次使用查找和替换从你的伪类中删除空格。由于可能只使用了大约 8 个不同的伪类，因此在每个伪类上执行查找替换不需要很长时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T21:19:19.063

我最终使用了[ProCssor](http://procssor.com/)，这非常酷，感谢 SteveAx。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-25T21:03:55.727

这在 Sublime 文本中大约需要 5 秒，我会这样做：

*   `:`用光标突出显示
*   alt+f3 选择冒号的所有实例
*   点击右箭头键跳到冒号的右边
*   添加一个空格

如果要“规范化”并确保冒号后没有双空格，只需在其中一个冒号后添加两个空格，然后执行 alt+f3 以选择它的所有实例并更正它。

# android - 您可以在单独的进程上启动 IntentService 吗？

> ID：12502821
> 
> 赞同：26
> 
> 时间：2012-09-19T21:01:12.840
> 
> 标签：android, android-service

1.  是否可以在单独的进程上启动[IntentService ？](http://developer.android.com/reference/android/app/IntentService.html)如何？如果是这样，是否必须绑定到它？
2.  是否可以在单独的进程上启动[IntentService](http://developer.android.com/reference/android/app/IntentService.html)[并在前台运行它](http://developer.android.com/guide/components/services.html#Foreground)？
3.  `android:isolatedProcess`和有什么区别`android:process`？请参阅：http: [//developer.android.com/guide/topics/manifest/service-element.html](http://developer.android.com/guide/topics/manifest/service-element.html)

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-09-19T21:17:49.847

> 1）是否可以启动`IntentService`一个单独的进程？如何？如果是这样，是否必须绑定到它？

是的，您可以`IntentService`在单独的进程中启动。只需添加`android:process=":whatever"`到该服务的清单条目即可。

不，你不需要绑定它。您可以通过向它发送 Intent 来与它通信`startService()`

> 2）是否可以在单独的进程上启动 IntentService 并在前台运行它？

是的（见上文）。为了让您的服务在前台运行，它可以随时调用`startForeground()`它。服务本身可以控制它是在前台运行还是在后台运行。

> `android:isolatedProcess`3)和有什么区别`android:process`？请参阅：http: [//developer.android.com/guide/topics/manifest/service-element.html](http://developer.android.com/guide/topics/manifest/service-element.html)

`android:process`允许您控制每个特定组件在哪个进程中运行（通过指定进程的名称）。您可以将应用程序的组件分组以在单独的进程中运行（例如，一个进程中的所有 UI 组件和另一个进程中的所有服务）。默认行为是应用程序的所有组件在同一进程中运行。

`android:isolatedProcess`是一个标志（真/假），如果您希望特定服务组件在与应用程序的其余部分隔离的单独进程中运行，则可以设置该标志。隔离进程没有授予应用程序其余部分的任何权限。通常，权限被授予应用程序，并且应用程序的所有组件都具有应用程序获得的所有权限。`android:isolatedProcess`仅从 API 级别 16 (Jellybean) 开始可用。请参阅[http://aleksmaus.blogspot.de/2012/09/a-feature-of-android-jelly-bean.html](http://aleksmaus.blogspot.de/2012/09/a-feature-of-android-jelly-bean.html)和[在 JellyBean 的服务中引入独立进程标签的优势[Android]](https://stackoverflow.com/questions/11681115/advantage-of-introducing-isolatedprocess-tag-within-services-in-jellybeanandroi)

# sql - SQL 计数查询，使用来自 2 个不同表的 where 子句

> ID：12502824
> 
> 赞同：3
> 
> 时间：2012-09-19T21:01:17.153
> 
> 标签：sql, count

我是 SQL 新手。我需要在几个不同的站点上运行一次查询才能获得计数。查询需要根据 where 子句向我提供所有记录的计数。但我无法弄清楚语法。

这是我尝试过的：

```
SELECT COUNT(KEYS.IDXKEYID) FROM KEYS, KEYFLAGS 
WHERE IDXLEVELID = 1 
AND KEYFLAGS.BKEYSEVERMADE = -1 
```

这给了我一个疯狂的数字。

基本上，IDXKEYID 是一个主键，并且存在于 KEYS 和 KEYFLAGS 表中。我想要统计数据库中满足上述 WHERE 子句标准的所有 IDXKEYID 记录。我只想要 1 列/行中的 1 个简单结果。

```
COUNT
-----
12346 
```

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T21:03:16.733

```
SELECT COUNT(DISTINCT KEYS.IDXKEYID) -- count each key only once
  FROM KEYS, KEYFLAGS 
 WHERE KEYS.IDXLEVELID = 1 
   AND KEYFLAGS.BKEYSEVERMADE = -1
   AND KEYS.IDXKEYID = KEYFLAGS.IDXKEYID -- you're missing this link 
```

或者您可以使用 EXISTS 编写它

```
SELECT COUNT(1) -- count each key only once
  FROM KEYS
 WHERE KEYS.IDXLEVELID = 1 
   AND EXISTS (
       SELECT *
         FROM KEYFLAGS
        WHERE KEYS.IDXKEYID = KEYFLAGS.IDXKEYID -- correlate
          AND KEYFLAGS.BKEYSEVERMADE = -1) 
```

# raphael - Raphael JS - 同步动画

> ID：12502828
> 
> 赞同：0
> 
> 时间：2012-09-19T21:01:30.653
> 
> 标签：raphael

我遇到了 Raphael JS 的问题。我用一张图来解释： ![例子](../Images/24a88213b27d60fd2d04bb706ab9f005.png)

基本上，我希望当红点移动时，路径保持连接到它，它应该随之移动。我最初尝试的是在红点上使用*animate ，在路径上使用**animateWith*。没有成功。

有人可以指出我正确的方向吗？我想用计时器等创建自己的动画，但我想检查这是否是个好主意。

此外，在某些时候，所有点都会移动，并且它们之间的路径仍将连接。我不知道怎么弄明白。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T21:29:36.170

在这种情况下，诀窍是 a) 知道在给定的时间窗口内所有圆圈的位置，以及 b)`path`在与圆圈相同的时间跨度内为连接线的属性设置动画。因此，如果您的中心圆将动画到 (nx,ny) 并且您的卫星圆将动画到 (cx,cy)，您需要像这样为相应的连接器制作动画：

```
cl.animate( { path: [ "M", nx, ny, "L", cx, cy } }, duration, easing_method ); 
```

但是你必须小心保持持续时间和缓动方法相同，否则你会得到马虎。

显然，您可以使用许多可能的状态管理策略——没有代码很难猜到。但我在[这里](http://voidblossom.com/tests/connectors.php)模拟了一种可能的解决方案。

# jquery - jquery“else if”：第一个工作但第二个不是

> ID：12502829
> 
> 赞同：0
> 
> 时间：2012-09-19T21:01:33.933
> 
> 标签：jquery, if-statement

我正在尝试根据一天中的时间显示/隐藏某些 div，如下所示：

```
function timetheme(){

    $("#dawn,#day,#dusk,#night").hide();
    var d = new Date();
    var n = d.getHours();
    if (n > 5 && n < 8){
        $("#dawn").show();
    }
    else if (n > 8 && n < 16){
        $("#day").show();
    }
    else if (n > 16 && n < 20){
        $("#dusk").show();
    }
    else {
        $("#night").show();
    };
};

window.onload = timetheme; 
```

我已经通过改变我的电脑时钟（以及一天中的所有时间）对其进行了测试，它工作得很好......除了“#dusk”。如果它在 4p 和 8p 之间，它会直接进入“#night”，就好像#dusk 不存在一样。

我什至尝试过改变其他的（例如将#day 从 8a 拉伸到 8p 甚至 10p）并且 #day 工作得很好。但是当我尝试插入#dusk（或任何其他名称和参数的其他内容）时，它就好像它不存在一样。

我在这里搜索并阅读了所有类似的问题，但他们总是有一些不同的东西，以至于它没有解决我的特定问题。

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T21:06:26.223

您的范围应包括边缘的小时数：

```
if (n >= 5 && n < 8){
    $("#dawn").show();
}
else if (n >= 8 && n < 16){
    $("#day").show();
}
else if (n >= 16 && n < 20){
    $("#dusk").show();
}
else {
    $("#night").show();
}; 
```

# javascript - 如何从 IndexedDB 中的 objectstore.put() 返回自动增量 ID？

> ID：12502830
> 
> 赞同：7
> 
> 时间：2012-09-19T21:01:37.363
> 
> 标签：javascript, indexeddb

使用 objectstore.put() 将记录插入 IndexedDB 后，如何返回自动递增的 ID？

下面是我的代码：

```
idb.indexedDB.addData = function (objectStore, data) {
    var db = idb.indexedDB.db;
    var trans = db.transaction([objectStore], READ_WRITE);
    var store = trans.objectStore(objectStore);

    var request = store.put(data);
    request.onsuccess = function (e) {
        //Success, how do I get the auto incremented id?
    };
    request.onerror = function (e) {
        console.log("Error Adding: ", e);
    };
}; 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-20T05:54:57.927

使用`e.target.result`. 由于 API 是异步的，因此您必须使用回调来获取返回值，如下所示：

```
idb.indexedDB.addData = function (objectStore, data, callback) {
    var db = idb.indexedDB.db;
    var trans = db.transaction([objectStore], READ_WRITE);
    var store = trans.objectStore(objectStore);

    var request = store.put(data);
    request.onsuccess = function (e) {
        callback(e.target.result);
    };
    request.onerror = function (e) {
        console.log("Error Adding: ", e);
        callback(undefined);
    };
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-19T21:18:42.000

解决了。您可以使用`request.result`.

# ios - 后台线程上的 iOS 网络导致应用程序挂起

> ID：12502833
> 
> 赞同：0
> 
> 时间：2012-09-19T21:01:47.630
> 
> 标签：ios, multithreading, networking, nsstream

我有一个为网络消息创建后台线程的应用程序。除非它连接到的服务器关闭连接，否则该应用程序几乎可以完美运行。我不确定为什么会发生这种情况，但非常感谢任何建议。我已经包含了可以解决问题的代码片段。如果某些内容含糊不清或需要更多细节，请告诉我。

```
- (void)stream:(NSStream *)stream handleEvent:(NSStreamEvent)eventCode {
switch(eventCode) {
    case NSStreamEventErrorOccurred:
        {
            NSLog(@"NSStreamEventErrorOccurred");

            [self Disconnect:self];
        }
    }
}

- (void)Disconnect:(id)sender {
    [self performSelector:@selector(closeThread) onThread:[[self class]networkThread] withObject:nil waitUntilDone:YES];

    [outputStream close];
    [outputStream removeFromRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode];
    [outputStream release];
    outputStream = nil;
}

+ (NSThread*)networkThread
{
    // networkThread needs to be static otherwise I get an error about a missing block type specifier
    static NSThread* networkThread = nil;
    static dispatch_once_t onceToken;
    dispatch_once(&onceToken, ^{
        networkThread = [[NSThread alloc] initWithTarget:self selector:@selector(networkThreadMain:) object:nil];

        [networkThread start];
    });

    return networkThread;
} 
```

挂断发生在返回 networkThread 线上。执行该行后，应用程序似乎挂起并冻结，我无法确定原因。

提前致谢。

**编辑**

这是 CloseThread 的代码片段，供感兴趣的人使用

```
- (void)closeThread
{   
    /*if(!inputStream)
        return;

    [inputStream close];
    [inputStream removeFromRunLoop:[NSRunLoop currentRunLoop] forMode:NSRunLoopCommonModes];
    [inputStream release];
    inputStream = nil;*/
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T23:46:44.270

我建议改变：

[self performSelector:@selector(closeThread) onThread:[[self class]networkThread] withObject:nil waitUntilDone:YES];

至：

[self performSelector:@selector(closeThread) onThread:[[self class]networkThread] withObject:nil waitUntilDone:NO];

也就是说，不要等待。

# javascript - 在 JavaScript 中为字符串 hh:mm 添加分钟

> ID：12502834
> 
> 赞同：-1
> 
> 时间：2012-09-19T21:01:50.460
> 
> 标签：javascript

我有一个以 hh:mm (17:30) 为单位的字符串和以分钟为单位的持续时间（例如 120 分钟）。如何将 120 分钟添加到 17:30 字符串以得出 17:30 + 120 分钟。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T21:39:52.550

使用[phpjs](http://phpjs.org)，我可以通过以下方式使其工作：

```
var a = strtotime('+120 minutes', strtotime('2000-01-01 15:30:00'))
var b = date('H:i', a)
alert(b); // '17:30' 
```

或者，如果您愿意，请尝试[http://www.datejs.com/](http://www.datejs.com/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-01-30T07:43:39.620

我有同样的问题，在下面的代码中使用。也可以使用相同的代码来更新小时和分钟。

```
var timeValue = ("23:59").split(":")
var minuteAddValue = Number(timeValue[1]) + 1
var date = new Date(null,null,null,timeValue[0],minuteAddValue);
var minuteValue = date.getMinutes();
minuteValue = minuteValue.length == 1 ? ("0" + minuteValue) : minuteValue
var hourValue = date.getHours();
var updatedTime = minuteValue+":"+hourValue 

//output - "00:00" 
```

# html - 可以将单选按钮变量与其他元素连接起来

> ID：12502837
> 
> 赞同：0
> 
> 时间：2012-09-19T21:02:26.820
> 
> 标签：html, coldfusion, radio-button, html-select

# 背景

我的公司网站有一个数据库，其中我将零件存储在一个表中，将零件选项存储在另一个表中。

当用户单击“添加到购物车”按钮时，将提交以下示例数据（用 抓取`<cfdump>`）：

```
ADDDESCRIPTION: Mass Meters
ADDPARTNUMBER: M-                         //part number minus option suffixes
ADDPRICE: 0                               //if 0 then is RFQ
FIELDNAMES:                               //form field names
OPTIONS: .5 SCCM,5M,AIR,,_,_,Standard     //part options list 
```

目前，我使用`<select>`元素和复选框的组合（参见[水冷闭环：Turmoil OCO-20R Chiller - Pascal Technologies, Inc](http://www.pascaltechnologies.com/product-details.cfm?SubCategoryID=1069 "帕斯卡冷水机组")示例）。每个`<select>`都有名称“选项”，因此这些值作为您在上面看到的逗号分隔列表返回。

我希望能够使用单选按钮而不是`<select>`每个部分选项少于四个项目的列表的元素。显然，单选按钮需要单独的名称才能正确分组，但我需要将它们提交的数据插入到列表中的适当位置。

* * *

## 问题

我尝试将单选按钮命名为`options[#id#]`并将所有元素访问为

```
<cfif qPartOptionGroups.recordcount is not 0>  <!--- There are possible options for this part --->
    <cfif not isDefined(FORM['options[]']) or qPartOptionGroups.recordcount is not ListLen(FORM['options[]'])>
        <cfset ValidForm="">
        <cfset InfoSpan="#InfoSpan#The number of options specified does not match the number of options available [#qPartOptionGroups.recordcount#] please add the item to your cart again.<br>">
    <cfelse> 
```

但它抛出一个未定义的元素异常，说`Element options[] is undefined in a Java object of type class coldfusion.filter.FormScope`

我确定这是我错过的东西；有任何想法吗？

*PS - 如果我被迫坚持使用`<select>`元素，那么我会这样做，但出于 UI 原因，我更喜欢单选按钮。*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T21:44:30.070

> 显然，单选按钮需要单独的名称才能正确分组，但我需要将它们提交的数据插入到列表中的适当位置。

我不认为你可以同时拥有它。只要您需要单独的组，每个组的值都会单独提交。但是，如果您按顺序命名组，即`option_1,option_2,...`您当然可以连接服务器端的值。（您也可以使用 javascript 连接值并将它们存储在隐藏字段中，但听起来您正在寻找服务器端选项，而不是客户端）

**形式**

```
<!--- use sequentially numbered fields and store total number in hidden field --->
<input type="radio" name="option_1" ...>
<input type="radio" name="option_1" ...>

<input type="radio" name="option_2" ...>
<input type="radio" name="option_2" ...>

<input type="radio" name="option_3" ...>
<input type="radio" name="option_3" ...>

<input type="hidden" name="numberOfOptions" value="3"> 
```

**行动**

```
<!--- create list of selected options --->
<cfset variables.options = "">
<cfloop from="1" to="#form.numberOfOptions#" index="x">
    <cfif structKeyExists(FORM, "option_"& x)>
        <cfset variables.options = listAppend(variables.options, form["option_"& x)>
    </cfif>
</cfloop> 
```

> 抛出一个未定义的元素异常，说 Element options[] is undefined

关于原始错误的旁注。`IsDefined`需要一个变量的*名称*。省略引号`FORM.options[]`会强制首先对其进行评估，从而导致您试图防止的错误。如果不是方括号，正确的语法应该是：

```
 <cfif IsDefined("FORM.options[]")> 
```

但是 Adob​​e 的`IsDefined`函数只接受[有效的变量名](http://livedocs.adobe.com/coldfusion/8/htmldocs/help.html?content=Variables_03.html)。因此，如果您的字段确实被命名为“options[]”，则需要改用 structKeyExists：

```
 <cfif structKeyExists(FORM, "options[]")> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-19T21:07:58.970

为什么不为每个单选按钮使用相同的名称？由于是收音机，他们只能选择一个。

# xpages - CSS 宽度和视图列和标题的问题

> ID：12502838
> 
> 赞同：1
> 
> 时间：2012-09-19T21:02:34.167
> 
> 标签：xpages

我有一些 CSS 应用于视图标题和视图列。

这是一个示例

```
.viewHeaderName {
width:235px;
background-color:rgb(192,192,192);
color:rgb(0,0,0);
font-family:Trebuchet MS,sans-serif;
font-size:10t;
font-weight:bold;
text-align:left;
}

.viewColumnName {

font-family:Trebuchet MS,sans-serif;
font-size:9pt;      

} 
```

基本上我正在尝试将列的宽度设置为我想要的。我不希望标题或列中的文本换行。这非常适用于所有列的分类视图。

但是对于简单的排序视图，标题从列中的文本向右偏移几个字符。

如果我删除 CSS 中的宽度参数，那么一切都很好，但我没有得到我想要的宽度。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T08:49:56.737

您可以使用此处描述的 td/th nowrap 属性

[http://www.w3schools.com/tags/att_td_nowrap.asp](http://www.w3schools.com/tags/att_td_nowrap.asp)

**或者**

在此处描述的 CSS 中使用空白元素

[http://www.w3schools.com/cssref/pr_text_white-space.asp](http://www.w3schools.com/cssref/pr_text_white-space.asp)

空白：nowrap；

# google-drive-api - 是否可以在文件请求中获取权限列表

> ID：12502839
> 
> 赞同：1
> 
> 时间：2012-09-19T21:02:34.500
> 
> 标签：google-drive-api

我正在显示谷歌驱动器根目录中的文件夹列表，并且我想在与其他人共享文件夹时显示一个图标，无论与谁共享。

是否可以在 file.list 请求中获取该信息？或者我必须为每个文件夹发出新请求以获取权限列表？

在 google docs api 中有一个包含此信息的类别标签。

问候，阿尔瓦罗。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-20T01:35:21.477

当您使用 file.list 请求时，返回的响应正文将包含以下内容：

```
 {
       "kind": "drive#fileList",
        "etag": etag,
        "selfLink": string,
        "nextPageToken": string,
        "nextLink": string,
        "items": [files Resource]
    } 
```

然后在【文件资源】中，结构如下：

```
 {
   "kind": "drive#file",
   "id": string,
   "etag": etag,
   "selfLink": string,
   "webContentLink": string,
   "alternateLink": string,
   "embedLink": string,
   "thumbnailLink": string,
   "title": string,
   "mimeType": string,
   "description": string,
   "labels": {
   "starred": boolean,
   "hidden": boolean,
   "trashed": boolean,
   "restricted": boolean,
   "viewed": boolean
    },
  "createdDate": datetime,
  "modifiedDate": datetime,
  "modifiedByMeDate": datetime,
  "lastViewedByMeDate": datetime,
  "sharedWithMeDate": datetime,
  "parents": [
           parents Resource
     ],
  "downloadUrl": string,
  "exportLinks": {
  (key): string
    },
  "indexableText": {
  "text": string
    },
  "userPermission": permissions Resource,
  "originalFilename": string,
  "fileExtension": string,
  "md5Checksum": string,
  "fileSize": long,
  "quotaBytesUsed": long,
  "ownerNames": [
        string
   ],
  "lastModifyingUserName": string,
  "editable": boolean,
  "writersCanShare": boolean,
  "explicitlyTrashed": boolean,
  "imageMediaMetadata": {
      "width": integer,
      "height": integer,
      "rotation": integer,
   "location": {
       "latitude": double,
       "longitude": double,
       "altitude": double
      }
    }
 } 
```

“userPermission”字段是您可以找到答案的字段。

# postgresql - 当 pg_cancel_backend 不起作用时，我应该如何终止进程？

> ID：12502841
> 
> 赞同：1
> 
> 时间：2012-09-19T21:02:44.370
> 
> 标签：postgresql

有时，即使我在 pgAdmin 中“停止”它，查询仍会继续运行，运行`pg_cancel_backend`，`pg_terminate_backend`并从命令行杀死。我发现的唯一选择是完全停止并重新启动 postgres 服务（通常使用`pg_ctl -m immediate`）。我目前正在使用**Postgres 9.1**。

是否有其他选项可以完全终止正在运行的进程？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T23:40:07.463

这不应该真的发生。问题后端在做什么？查看：

```
ps -C postgres -o pid,ppid,stat,start,time,%cpu,%mem,blocked,ignored,wchan:80,cmd 
```

如果您知道，请替换`-C postgres`为。`-p the_pid`确保包括出现在宽`chan`行之后的进程名称。用整行更新您的答案。

您可能还想从后端获取回溯以查看它在做什么。您可能在 Linux 或 BSD given 上`kill`，因此请尝试：

```
gdb -p the_pid
(gdb) bt
... blah blah copy this blah ...
(gdb) q 
```

例如：

```
gdb -p 914
......blah blah ........
(gdb) bt
#0  0x0000003c31ceacc3 in __select_nocancel () from /lib64/libc.so.6
#1  0x00000000005f73b6 in ?? ()
#2  0x00000000005f7c36 in SysLogger_Start ()
#3  0x00000000005f60b0 in PostmasterMain ()
#4  0x0000000000457039 in main ()
(gdb) q
A debugging session is active.

        Inferior 1 [process 914] will be detached.

Quit anyway? (y or n) y
Detaching from program: /usr/bin/postgres, process 914 
```

如果可能，请先安装调试符号包。我的机器上没有 Pg 9.1，所以我上面的回溯不是很有用。请参阅[Pg 维基文章](http://wiki.postgresql.org/wiki/Getting_a_stack_trace_of_a_running_PostgreSQL_backend_on_Linux/BSD#Installing_External_symbols)。

回溯可能很长，因此请考虑将其放在 pastebin 站点上，而不是直接放到您的问题中，而只是在此处链接到它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-10T08:03:06.937

回顾一下，有些地方 PostgreSQL 后端正在做一些有`CHECK_FOR_INTERRUPTS`一段时间没有工作的地方。这些补丁在可能的情况下被避免，但仍然会发生。

如果您发现此类情况，请报告。

在后端检查中断之前，您无法完全停止后端，因此您必须简单地等待。或者您可以重新启动整个数据库服务器。如果你用 (eg) 硬杀死感兴趣的后端`kill -9`，PostgreSQL 将`shared_buffers`视为潜在损坏并立即强制重启，断开所有当前会话。因此，您不妨改用立即关机。

# java - 查找所有数组的长度多维数组，Java

> ID：12502843
> 
> 赞同：7
> 
> 时间：2012-09-19T21:03:08.487
> 
> 标签：java, arrays, multidimensional-array, variable-length

我想使用多维数组来存储数据网格。但是，我还没有找到一种简单的方法来查找数组**第二**部分的长度。例如：

```
boolean[][] array = new boolean[3][5];
System.out.println(array.length); 
```

只会输出**3**。

是否有另一个简单的命令来查找第二个数组的长度？（即以同样的方式输出5）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-19T21:05:14.460

尝试使用`array[0].length`，这将给出您正在寻找的维度（因为您的数组不是锯齿状的）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-19T21:57:24.057

```
boolean[][] array = new boolean[3][5]; 
```

创建一个由三个数组组成的数组（`boolean`每个 5 秒）。在 Java 中，多维数组只是数组的数组：

```
array.length 
```

为您提供“外部”数组的长度（在本例中为 3）。

```
array[0].length 
```

为您提供第一个“内部”数组的长度（在本例中为 5）。

```
array[1].length 
```

和

```
array[2].length 
```

也会给你 5，因为在这种情况下，所有三个“内部”数组、、、`array[0]`和`array[1]`都是`array[2]`相同的长度。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-19T21:06:24.043

array[0].length 会给你 5

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-19T21:06:53.290

```
int a = array.length;

if (a > 0) {
  int b = array[a - 1].length;
} 
```

应该做的伎俩，在你的情况下 a 将是 3, b 5

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-11-12T22:48:35.630

您想在 3 维数组中获取内部数组的长度

例如

```
int ia[][][] = new ia [4][3][5];
System.out.print(ia.length);//prints 4
System.out.print(ia[0].length);//prints 3
System.out.print(ia[0].[0].length); // prints 5 the inner          array in a three  D array 
```

通过归纳：对于一个四维数组，它是：

```
ia[0].[0].[0].length 
```

……

# php - 避免php post变量重写

> ID：12502844
> 
> 赞同：-6
> 
> 时间：2012-09-19T21:03:13.267
> 
> 标签：php

是否可以仅使用 1 个输入获得这样的输出？

```
<input name="value"/>
$_POST['value'] = 1;
$_POST['value'] = 2;
$_POST['value'] = 3;
$_POST['value'] = etc; 
```

编辑：我正在尝试使用单个表单输入传递一个数组。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T21:06:53.553

要提交具有相同名称的多个输入，`[]`请在末尾附加括号，如下所示

```
<input type="text" name="bob[]" />
<input type="text" name="bob[]" />
<input type="text" name="bob[]" />
<input type="text" name="bob[]" />
<input type="text" name="bob[]" /> 
```

另一方面，`bob`将是一个数组：

```
<?php

$Bob = (isset($_POST['bob']) === TRUE ? $_POST['bob'] array());

echo 'RES:'. implode(',', $Bob);

?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T21:05:31.497

不，除非您使用 ajax 一次存储一个值，否则不会。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-19T21:14:27.060

您的问题有点不清楚，但是如果您尝试使用单个表单传递数组，`input`那么简短的回答是否定的，使用单个元素您不能将数组传递到 POST 数组（[多选表单除外element](https://stackoverflow.com/questions/2407284/how-to-get-multiple-selected-values-of-select-box-in-php) )，但是一旦提交，只需进行一点处理*就很*容易了。您只需在值上使用分隔符并在 PHP 中将其分解：

在 HTML 中：

```
<input name="value" value="1|2|4|4|5" /> 
```

在 PHP 中

```
$values = explode('|',$_POST['value']); 
```

这将导致：

```
$values[0] == 1;
$values[1] == 2;
... 
```

然而，**从来没有办法让一个 PHP 数组同时为一个键具有多个值**，所以你永远不会有一个看起来像这样的 PHP 数组：

```
$_POST['value'] = 1;
$_POST['value'] = 2;
$_POST['value'] = 3;
$_POST['value'] = etc; 
```

因为对于任何数组（`_POST`或其他），$array[KEY] 都不能有两个值（即，怎么可能`if ($_POST['value'] === $_POST['value'])`不为真？它不能，任何更多`if ($x===$x)`或`if (1===1)`可以是假的）。但是，您可以使用多维数组，如下所示：

```
$_POST['value'][0] = 1;
$_POST['value'][1] = 2;
$_POST['value'][2] = 3;
$_POST['value'][3] = 'etc'; 
```

然后通过以下方式使用它：

```
foreach($_POST['value'] as $key =>$value){
    echo $value.',';
} 
```

这将输出

```
1,2,3,etc 
```

# google-app-engine - GAE ImagesService 中的 Jpeg 2000 灰度支持

> ID：12502847
> 
> 赞同：1
> 
> 时间：2012-09-19T21:03:21.300
> 
> 标签：google-app-engine

当我们尝试将一些 JPEG2000 灰度图像上传到 Google Appengine 并尝试使用 ImagesService 处理它们时，我们遇到了一个问题。生产的错误是：

> > > com.google.appengine.api.images.ImagesServiceFailureException：在 com.google.appengine.api.images.ImagesServiceImpl.getServingUrl(ImagesServiceImpl.java:284)

根据 GAE 图片服务：

> > > 该服务接受 JPEG、PNG、WEBP、GIF（包括动画 GIF）、BMP、TIFF 和 ICO 格式的图像数据。

我的问题是我们如何将 ImagesService 配置为服务器 Jpeg2000 灰度图像，而不是在将它们上传到 GAE 之前将已压缩的图像重新压缩为支持的格式。重复压缩会极大地损害图像质量！

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T21:43:24.380

您无法更改支持的格式列表。

[如果您在问题跟踪器](http://code.google.com/p/googleappengine/issues/list)中提交功能请求，这可能是一个好主意。然后，我们可以对请求进行分类并评估对它的需求。

# hibernate - 类未映射异常（但已映射）？

> ID：12502850
> 
> 赞同：0
> 
> 时间：2012-09-19T21:03:22.483
> 
> 标签：hibernate

我得到了一个类未映射的异常，但是我想我确实映射了它！我有 2 个类 ClientAppts 和 Appointments 有一对多的关系。我想得到所有的客户和他们的约会日期。是什么原因造成的？欢迎所有建议。

这是课程：

```
@Entity(name="ClientAppts")
@Table(name="person")
public class ClientAppts {
private Integer person_id;
private String  fName;
private String  lName;
private Date    appt;
private String  phone;
private String  cell;

private String  address1;
private String  address2;
private String  city;
private String  state;
private String  zip;
private String  doctor;
private String  notes;

@ElementCollection
@CollectionTable(name="Appointment", joinColumns= @JoinColumn(name="person_id"))
@Column(name="appt")
Collection<Date> appointments;

    // various getters and setters follow. 
```

为了清楚起见，这里是上面提到的 Appointment 类：

```
@Entity(name="Appointment")
@Table(name="appointment")

public class Appointment {
private int         id;
private Date        appt;
private Date        apptfinish;
private String      title;
private String      location;
private BigDecimal  fee;
private BigDecimal  amtPaid;
private Boolean     serviceRendered;
private int         person_id;
private String      description; 
```

这是引发异常的代码：

```
List<ClientAppts> list = getSessionFactory().getCurrentSession().createQuery(" from ClientAppts client order by client.lName ").list(); 
```

最后，堆栈跟踪：

org.hibernate.hql.internal.ast.QuerySyntaxException：ClientAppts 未映射 [from ClientAppts client order by client.lName] at org.hibernate.hql.internal.ast.util.SessionFactoryHelper.requireClassPersister(SessionFactoryHelper.java:180) at org.hibernate.hql.internal.ast.tree.FromElementFactory.addFromElement(FromElementFactory.java:110) 在 org.hibernate.hql.internal.ast.tree.FromClause.addFromElement(FromClause.java:93) 在 org.hibernate。 hql.internal.ast.HqlSqlWalker.createFromElement(HqlSqlWalker.java:326) 在 org.hibernate.hql.internal.antlr.HqlSqlBaseWalker.fromElement(HqlSqlBaseWalker.java:3252) 在 org.hibernate.hql.internal.antlr.HqlSqlBaseWalker。 fromElementList(HqlSqlBaseWalker.java:3141) at org.hibernate.hql.internal.antlr.HqlSqlBaseWalker.fromClause(HqlSqlBaseWalker.java:694) at org.hibernate.hql.internal。antlr.HqlSqlBaseWalker.query(HqlSqlBaseWalker.java:550) at org.hibernate.hql.internal.antlr.HqlSqlBaseWalker.selectStatement(HqlSqlBaseWalker.java:287) at org.hibernate.hql.internal.antlr.HqlSqlBaseWalker.statement(HqlSqlBaseWalker. java:235) 在 org.hibernate.hql.internal.ast.QueryTranslatorImpl.doCompile(QueryTranslatorImpl.java:183) 在 org.hibernate 的 org.hibernate.hql.internal.ast.QueryTranslatorImpl.analyze(QueryTranslatorImpl.java:248) .hql.internal.ast.QueryTranslatorImpl.compile(QueryTranslatorImpl.java:136) 在 org.hibernate.engine.query.spi.HQLQueryPlan.(HQLQueryPlan.java:101) 在 org.hibernate.engine.query.spi.HQLQueryPlan。 (HQLQueryPlan.java:80) 位于 org.hibernate.engine.query.spi.QueryPlanCache.getHQLQueryPlan(QueryPlanCache.java:119) 位于 org.hibernate.internal.AbstractSessionImpl。getHQLQueryPlan(AbstractSessionImpl.java:215) 在 org.hibernate.internal.AbstractSessionImpl.createQuery(AbstractSessionImpl.java:193) 在 org.hibernate.internal.SessionImpl.createQuery(SessionImpl.java:1649) 在 com.dave.user.dao .UserDAO.getClientAppts(UserDAO.java:130) 在 com.dave.user.service.UserService.getClientAppts(UserService.java:126) 在 sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) 在 sun.reflect.NativeMethodAccessorImpl.invoke (NativeMethodAccessorImpl.java:39) 在 sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) 在 java.lang.reflect.Method.invoke(Method.java:597) 在 org.springframework.aop.support.AopUtils。在 org.springframework.aop.framework.ReflectiveMethodInvocation 处调用JoinpointUsingReflection(AopUtils.java:318)。invokeJoinpoint(ReflectiveMethodInvocation.java:183) at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150) at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:110) at org.springframework .aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172) at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202) at $Proxy251.getClientAppts(Unknown Source) at com.dave.managed。 bean.AppointmentsMB.loadAppointments(AppointmentsMB.java:45) 在 com.dave.managed.bean.AppointmentsMB.init(AppointmentsMB.java:40) 在 sun.reflect.NativeMethodAccessorImpl.invoke0（Native Method） 在 sun.reflect.NativeMethodAccessorImpl。在太阳调用（NativeMethodAccessorImpl.java:39）。reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) at java.lang.reflect.Method.invoke(Method.java:597) at org.glassfish.faces.integration.GlassFishInjectionProvider$2.run(GlassFishInjectionProvider.java:382) at java.security.AccessController.doPrivileged(Native Method) at org.glassfish.faces.integration.GlassFishInjectionProvider.invokeLifecycleMethod(GlassFishInjectionProvider.java:376) at org.glassfish.faces.integration.GlassFishInjectionProvider.invokePostConstruct(GlassFishInjectionProvider.java:306) at org.glassfish.faces.integration.GlassFishInjectionProvider.invokePostConstruct(GlassFishInjectionProvider.java:229) at com.sun.faces.mgbean.BeanBuilder.invokePostConstruct(BeanBuilder.java:223) at com.sun.faces.mgbean.BeanBuilder.build( BeanBuilder.java:105) 在 com.sun.faces。mgbean.BeanManager.createAndPush(BeanManager.java:409) at com.sun.faces.mgbean.BeanManager.create(BeanManager.java:269) at com.sun.faces.el.ManagedBeanELResolver.resolveBean(ManagedBeanELResolver.java:244)在 com.sun.faces.el.ManagedBeanELResolver.getValue(ManagedBeanELResolver.java:116) 在 com.sun.faces.el.DemuxCompositeELResolver._getValue(DemuxCompositeELResolver.java:176) 在 com.sun.faces.el.DemuxCompositeELResolver.getValue (DemuxCompositeELResolver.java:203) 在 com.sun.el.parser.AstValue.getValue(AstValue.java:179) 在 com.sun.sun.el.parser.AstIdentifier.getValue(AstIdentifier.java:103)。 el.ValueExpressionImpl.getValue(ValueExpressionImpl.java:224) 在 com.sun.faces.facelets.el.TagValueExpression.getValue(TagValueExpression.java:109) 在 javax.faces.component.ComponentStateHelper。eval(ComponentStateHelper.java:194) at javax.faces.component.ComponentStateHelper.eval(ComponentStateHelper.java:182) at javax.faces.component.UIOutput.getValue(UIOutput.java:169) at org.primefaces.component.calendar .CalendarUtils.getValueAsString(CalendarUtils.java:35) at org.primefaces.component.calendar.CalendarRenderer.encodeEnd(CalendarRenderer.java:58) at javax.faces.component.UIComponentBase.encodeEnd(UIComponentBase.java:875) at com。 sun.faces.renderkit.html_basic.HtmlBasicRenderer.encodeRecursive(HtmlBasicRenderer.java:312) at com.sun.faces.renderkit.html_basic.GroupRenderer.encodeChildren(GroupRenderer.java:105) at javax.faces.component.UIComponentBase.encodeChildren( UIComponentBase.java:845) 在 com.sun.faces.renderkit.html_basic.HtmlBasicRenderer.encodeRecursive(HtmlBasicRenderer.java:304) 在 com.sun.faces.renderkit.html_basic.GridRenderer.renderRow(GridRenderer.java:185) at com.sun.faces.renderkit.html_basic.GridRenderer.encodeChildren(GridRenderer.java:129) at javax.faces.component.UIComponentBase.encodeChildren( UIComponentBase.java:845) 在 javax.faces.component.UIComponent.encodeAll(UIComponent.java:1757) 在 javax.faces.render.Renderer.encodeChildren(Renderer.java:168) 在 javax.faces.component.UIComponentBase.encodeChildren (UIComponentBase.java:845) 在 javax.faces.component.UIComponent.encodeAll(UIComponent.java:1757) 在 javax.faces.component.UIComponent.encodeAll(UIComponent.java:1760) 在 javax.faces.component.UIComponent。 com.sun.faces.application.view.FaceletViewHandlingStrategy 的 javax.faces.component.UIComponent.encodeAll(UIComponent.java:1760) 的 encodeAll(UIComponent.java:1760)。renderView(FaceletViewHandlingStrategy.java:402) at com.sun.faces.application.view.MultiViewHandler.renderView(MultiViewHandler.java:131) at javax.faces.application.ViewHandlerWrapper.renderView(ViewHandlerWrapper.java:288) at org.apache .myfaces.tomahawk.application.ResourceViewHandlerWrapper.renderView(ResourceViewHandlerWrapper.java:93) 在 com.sun.faces.lifecycle.RenderResponsePhase.execute(RenderResponsePhase.java:121) 在 com.sun.faces.lifecycle.Phase.doPhase(Phase .java:101) 在 com.sun.faces.lifecycle.LifecycleImpl.render(LifecycleImpl.java:139) 在 javax.faces.webapp.FacesServlet.service(FacesServlet.java:594) 在 org.apache.catalina.core。 StandardWrapper.service(StandardWrapper.java:1542) 在 org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:281) 在 org.apache.catalina.core。StandardContextValve.invoke(StandardContextValve.java:175) at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655) at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595) at org .apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:161) at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:331) at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter .java:231) 在 com.sun.enterprise.v3.services.impl.ContainerMapper$AdapterCallable.call(ContainerMapper.java:317) 在 com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java :195) 在 com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:849) 在 com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:746) 在 com.sun.grizzly。http.ProcessorTask.process(ProcessorTask.java:1045) 在 com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:228) 在 com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137) 在 com .sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104) 在 com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90) 在 com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79 ) 在 com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54) 在 com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59) 在 com.sun.grizzly.ContextTask.run(ContextTask.java: 71) 在 com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532) 在 com.sun.grizzly.util。AbstractThreadPool$Worker.run(AbstractThreadPool.java:513) 在 java.lang.Thread.run(Thread.java:662)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T04:21:35.473

试试这个关系映射：

```
public class ClientAppts {
...

@OneToMany(mappedBy = "clientAppt", fetch = FetchType.LAZY, trgetEntity = Appointment.class)
private Collection<Date> appointments;
...
} 
```

* * *

```
public class Appointment {
...

@ManyToOne
private ClientAppts clientAppt;
...
} 
```

# javascript - 使用 javascript 从 sourceUrl 获取图像

> ID：12502853
> 
> 赞同：1
> 
> 时间：2012-09-19T21:03:37.970
> 
> 标签：javascript, google-chrome, google-chrome-extension

我正在写一个 chrome 扩展。我想将某个网页上的图像发送到我的网站。

使用 chrome contextMenus，我可以获得该图像的源 URL。我想知道如何使用该源下载它或将其发送到其他地方。（类似于浏览器提供的另存为功能）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T05:11:24.483

这是我要通过上下文菜单上传图像 URL 的内容：

```
chrome.contextMenus.onClicked.addListener(function (info) {

  var data = new FormData();
  data.append('url', info.srcUrl);

  var xhr = new XMLHttpRequest();
  xhr.open('POST', 'http://mywebsite.com', true);
  xhr.onload = function(e) { console.log(e); }
  xhr.send(data);

}); 
```

希望能帮助到你。

# performance - 向量参考缓冲区实现

> ID：12502858
> 
> 赞同：1
> 
> 时间：2012-09-19T21:03:56.337
> 
> 标签：performance, buffer, zero-copy

我正在阅读来自 github 的其中一个项目的代码。我遇到了一个叫做向量引用缓冲区实现的东西。有人能遇到这个吗？这有什么实际应用。我做了一个快速的谷歌搜索，但找不到任何简单的示例实现。

一些见解会有所帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T21:07:09.713

[http://www.ibm.com/developerworks/library/j-zerocopy/](http://www.ibm.com/developerworks/library/j-zerocopy/)

[http://www.linuxjournal.com/article/6345](http://www.linuxjournal.com/article/6345)

[http://www.seccuris.com/documents/whitepapers/20070517-devsum​​mit-zerocopybpf.pdf](http://www.seccuris.com/documents/whitepapers/20070517-devsummit-zerocopybpf.pdf)

[https://github.com/joyent/node/pull/304](https://github.com/joyent/node/pull/304)

我认为对您的特定项目/用法/等有更多的了解可以得到更具体的答案。

但是，该术语通常用于更改或启动接口/函数/例程，其目标是不分配其输入的另一个实例以执行其操作。

编辑：好的，在阅读新标题后，我认为您只是在谈论将缓冲区推入缓冲区向量。这使您的代码保持干净，您可以以最小的开销将所需的任何缓冲区传递给任何函数调用，并且如果您的代码不受管理，则可以有更好的清理时间。

编辑2：你的意思是这个[http://cpansearch.perl.org/src/TYPESTER/Data-MessagePack-Stream-0.07/msgpack-0.5.7/src/msgpack/vrefbuffer.h](http://cpansearch.perl.org/src/TYPESTER/Data-MessagePack-Stream-0.07/msgpack-0.5.7/src/msgpack/vrefbuffer.h)

# django - 删除与删除（）

> ID：12502859
> 
> 赞同：0
> 
> 时间：2012-09-19T21:04:08.060
> 
> 标签：django, object

```
class myClass (models.Model):
  related_operation = models.ForeignKey('self', null = True)

  __related_operation = None

  def save(self, force_insert=False, force_update=False):
    if self.related_operation != self.__related_operation:
      del self.__related_operation

    super(Operation, self).save(force_insert, force_update)
    self.__related_operation = self.related_operation 
```

我应该使用 del self.__related_operation 还是应该使用 self.__related_operation.delete()？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T21:08:17.377

`del self.__related_operation`将尝试删除实例的`__related_operation`属性。我不确定你为什么要这样做。

如果要从数据库中删除对象，请使用该`delete()`方法。

# c# - C# 中的线程安全数据库访问

> ID：12502862
> 
> 赞同：1
> 
> 时间：2012-09-19T21:04:28.020
> 
> 标签：c#, sql-server, winforms, multithreading, thread-safety

我有一个执行大量数据库工作的 Winforms 应用程序。它做了很多读取和一些记录的插入。该操作最多可能需要 30 秒到一分钟，具体取决于数据库的大小。现在，我的程序运行良好。

我的问题是，当我的程序执行此操作时，我的 UI 线程被阻塞，直到数据库完成。我想将数据库函数放入一个线程中，但是，根据[这篇 MSDN 文章](http://msdn.microsoft.com/en-us/library/ms971481.aspx#adonetbest_topic7)，ADO.NET 不是线程安全的。

有没有办法在我的用户界面上提供进度条或以某种方式解决“ADO.NET 不是线程安全的”？也许要编写我自己的继承类`SqlDataReader`或`SqlConnection`使其成为线程安全的。这甚至可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T21:05:45.230

只需使用 backgroundworker 并确保每个线程 (bgw) 创建自己的 Connection 对象。

关于链接的文章，请确保您有一种并发安全的方式来生成密钥。让 Db 生成它们是最好的选择。

> 有没有办法在我的 UI 上提供进度条

这很棘手。Bgw 可以很好地报告进度，但从正在运行的查询中获取它是一个问题。甚至行的总 nr 通常也只有在最后才知道。
但是你总是可以伪造它，用户不介意/知道。

# visual-studio - Visual Studio 2012 默认滚动条

> ID：12502866
> 
> 赞同：1
> 
> 时间：2012-09-19T21:04:46.050
> 
> 标签：visual-studio, themes, visual-studio-2012

我试图让我的 Visual Studio 更漂亮，所以我从[这里](http://www.rickardnilsson.net/post/2012/05/20/son-of-obsidian-color-scheme-for-resharper.aspx)下载了黑曜石之子配色方案。然后一切都好，除了滚动条。滚动条现在不是 Visual Studio 2012 酷炫的自定义滚动条，而是 Windows 默认滚动条。我尝试使用“导入和导出选项...”菜单转售所有首选项，但这不起作用。颜色返回默认状态，但滚动条与 Windows 滚动条相同。顺便说一句，我使用的是深色主题。所以问题是如何返回正常的自定义滚动条？这个默认值真的很烦人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-13T16:44:46.917

如果重置不起作用，听起来您需要全新安装。

要获得干净的“黑曜石之子”或其他不影响滚动条的主题，请[转到此处。](https://studiostyl.es/schemes/son-of-obsidian)

另请参阅适用于您的工作室版本的[Visual Studio 颜色主题编辑器](https://www.google.com/webhp?sourceid=chrome-instant&ion=1&espv=2&es_th=1&ie=UTF-8#q=visual%20studio%20color%20theme%20editor&es_th=1)扩展，该扩展可让您管理主题。这应该让您回到默认主题设置或帮助创建新的默认主题设置。

之后，您可以在 Visual Studio 2012-13中调整一些难以找到的*地图模式滚动条颜色*

工具>选项>环境>字体和颜色>文本编辑器>

**显示项目：**

*   概述背景
*   概述插入符号
*   概览折叠区域
*   概览可见

# wordpress - Wordpress - 在主页上显示某些类别

> ID：12502867
> 
> 赞同：0
> 
> 时间：2012-09-19T21:04:46.380
> 
> 标签：wordpress, wordpress-theming

我一直在尝试更改我当前的代码，但这对我来说毫无意义（它不会像我被告知的那样做）。我想做的只是在我的主页上显示类别 13 的帖子，我希望能够为帖子添加多个类别。

*   帖子 1（类别 13 和 1）= 显示在主页上
*   帖子 2（类别 13、4 和 5）= 显示在主页上
*   帖子 3（第 6 类和第 1 类）= 在主页上不可见
*   帖子 4（类别 2）= 在主页上不可见

这是我当前只在主页上显示类别 13 的代码，如果将另一个类别添加到帖子中，则根本不会显示。

```
<?php get_header(); ?>

<div id="primary">
<div id="content" role="main">

<?php
    if (is_home()) {
        query_posts("cat=-6,-4,-1,-11");
    }
?>

<?php if ( have_posts() ) : ?>
<?php twentyeleven_content_nav( 'nav-above' ); ?>
    <?php /* Start the Loop */ ?>
    <?php while ( have_posts() ) : the_post(); ?>
        <?php get_template_part( 'content', get_post_format() ); ?>
    <?php endwhile; ?>

<?php
    $paged = (get_query_var('paged')) ? get_query_var('paged') : 1;
    $args = array(
    'cat' => 13,
    'posts_per_page' => 5,
    'paged' => $paged);
    query_posts($args);
?>

<?php twentyeleven_content_nav( 'nav-below' ); ?>

<?php else : ?>
    <article id="post-0" class="post no-results not-found">
    <header class="entry-header">
    <h1 class="entry-title"><?php _e( 'Geen berichten beschikbaar', 'twentyeleven' ); ?></h1>
    </header><!-- .entry-header -->

    <div class="entry-content">
    <p><?php _e( 'Helaas, er zijn nog geen gearchiveerde berichten in deze categorie. ', 'twentyeleven' ); ?></p>
    <?php get_search_form(); ?>
    </div><!-- .entry-content -->
    </article><!-- #post-0 -->
<?php endif; ?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T18:50:08.443

您在这段代码中看起来太难了。你不需要排除任何东西，你只需要包含 cat `13`，它将包含 cat 中的所有内容`13`；*即使*它也属于其他类别。只需像这样运行常规[`WP_Query()`](https://codex.wordpress.org/Class_Reference/WP_Query)：

```
<?php get_header(); ?>

<div id="primary">
<div id="content" role="main">

<?php
    if (is_home()) {
        // The Query
        $the_query = new WP_Query("cat=13, paged=".get_query_var('paged'));
    }
?>

<?php if ( have_posts() ) : ?>
<?php twentyeleven_content_nav( 'nav-above' ); ?>
    <?php /* Start the Loop */ ?>
    <?php while ( $the_query->have_posts() ) : $the_query->the_post(); ?>
        <?php get_template_part( 'content', get_post_format() ); ?>
    <?php endwhile; ?>
<?php twentyeleven_content_nav( 'nav-below' ); ?>

<?php else : ?>
    <article id="post-0" class="post no-results not-found">
    <header class="entry-header">
    <h1 class="entry-title"><?php _e( 'Geen berichten beschikbaar', 'twentyeleven' ); ?></h1>
    </header><!-- .entry-header -->

    <div class="entry-content">
    <p><?php _e( 'Helaas, er zijn nog geen gearchiveerde berichten in deze categorie. ', 'twentyeleven' ); ?></p>
    <?php get_search_form(); ?>
    </div><!-- .entry-content -->
    </article><!-- #post-0 -->
<?php endif; ?> 
```

（必须添加一些字符，否则我无法编辑，抱歉：P）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-20T07:17:38.853

试试这个...

```
<?php
  $temp = $wp_query; 
  $wp_query = null; 
  $wp_query = new WP_Query(); 
  $wp_query->query('showposts=6&cat=13'.'&paged='.$paged);
?>
<?php while ($wp_query->have_posts()) : $wp_query->the_post(); ?>

    Your stuff goes here...

<?php endwhile; ?>
<?php 
  $wp_query = null; 
  $wp_query = $temp;  // Reset
?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-09T13:56:12.473

试试这个代码

```
<?php
global $post;
if (is_home()) {
    $args = array( 'numberposts' => 5, 'category' => 13 );
    $myposts = get_posts( $args );
    foreach( $myposts as $post ) :  setup_postdata($post); ?>
        <h2><a href="<?php the_permalink(); ?>"><?php the_title(); ?></a></h2>
            <div class="entry-content">
                <?php the_content( 'Continue reading <span class="meta-nav">&raquo;</span>); ?>
            </div>
    <?php endforeach;
}
?> 
```

这将显示标题和内容。如果您想要日期、作者、类别、标签等附加信息，您可能必须使用其他模板标签。此外，如果您想以不同的方式设置这些样式，则必须使用适当的 CSS。

# node.js - 在nodejs和meteor之间共享mongodb

> ID：12502870
> 
> 赞同：3
> 
> 时间：2012-09-19T21:05:09.937
> 
> 标签：node.js, mongodb, meteor

我刚刚使用 express、passport 和 mongodb 在 nodejs 中完成了一个 REST 服务器应用程序

我想为该 mongodb REST api 的实时统计信息创建一个流星应用程序，例如连接数、在线用户等。

但我想不出一种将自定义 mongodb 与流星一起使用的方法。基本上我想与 nodejs/express 应用程序和流星共享同一个数据库。

是否可以？我敢肯定它应该是，但我不知道如何！

请帮忙！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-20T11:23:08.133

好的，我到了该做什么。

在部署流星时，他们可以选择数据库。

所以我在meteor上创建了一个应用程序，然后为nodejs部署了它

这里是如何，

流星捆绑 myapp.tgz

提取 myapp.tgz 并使用以下命令。

PORT=3000 MONGO_URL=mongodb://localhost:27017/myapp node bundle/main.js

这是完整的文档：[http ://docs.meteor.com/#deploying](http://docs.meteor.com/#deploying)

# floating-point - IEEE 24 位浮点数的最小正值是多少？

> ID：12502880
> 
> 赞同：3
> 
> 时间：2012-09-19T21:05:36.207
> 
> 标签：floating-point, ieee-754, floating-point-precision, 24-bit

IEEE-754 32 位浮点数的最小正值是`2^−149`16 位浮点数是`2^-14`。**如果 IEEE-754 标准化了 24 位浮点数，它的最小正值是多少？**

对不起，如果这在某处明确记录，但我无法在搜索中找到它。

如果您想了解实用性，这将用于将四个不同精度的浮点值拟合到 64 位中，以便在内存不足的系统中使用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T21:13:48.010

IEEE-754 实际上并没有回答这个问题。它没有提供 24 位格式的标准化，并且用于确定浮点格式中有效位数的常用公式分解为小宽度。

也就是说，最自然的选择是具有 7 个指数位和 16 个显式有效位，这使得最小的正正常数`2^-62`。

# apache - 如何排除除一个目录之外的所有文件和目录，RewriteCond

> ID：12502885
> 
> 赞同：1
> 
> 时间：2012-09-19T21:06:09.107
> 
> 标签：apache, .htaccess, mod-rewrite

我想将所有非文件、非目录重定向到 index.php，因此存在的所有内容都可以直接访问 - 除了一个目录（也应该转到 index.php）

我所拥有的是：

```
# Files
RewriteCond %{REQUEST_FILENAME} !-f

# Directories except /orderfiles/*
RewriteCond %{REQUEST_FILENAME} ^/(orderfiles/)* [OR]
RewriteCond %{REQUEST_FILENAME} !-d

RewriteRule .* index.php [L,QSA] 
```

这适用于/orderfiles 内的**目录**，但 /orderfiles内的**文件**仍会转到该文件。我尝试添加

```
RewriteCond %{REQUEST_FILENAME} ^/(orderfiles/)* [OR]
RewriteCond %{REQUEST_FILENAME} !-f 
```

但这会中断并将每个文件发送到 index.php。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-19T21:09:17.313

你很接近，你想要这样的东西：

```
# Files
RewriteCond %{REQUEST_FILENAME} !-f

# Directories
RewriteCond %{REQUEST_FILENAME} !-d

# except /orderfiles
RewriteRule !^/?orderfiles index.php [L,QSA] 
```

* * *

> 我意识到我打错了我想要做的事情，我的意思是“但将一个目录发送到 index.php”（我编辑了我的问题以更准确）。我确实希望 /orderfiles 被路由到 index.php

那么你所拥有的是正确的，但你需要改变这一行：

```
RewriteCond %{REQUEST_FILENAME} ^/(orderfiles/)* [OR] 
```

到：

```
RewriteCond %{REQUEST_URI} ^/orderfiles/ [OR] 
```

# c# - 使用 var + 基本依赖工厂是否比 C# 接口更松散耦合？

> ID：12502888
> 
> 赞同：-1
> 
> 时间：2012-09-19T21:06:19.280
> 
> 标签：c#, oop, dynamic, interface, var

这是一个通用的设计问题。我们经常使用接口来解耦组件，写入接口而不是实现等。有时接口使用基本的注入技术，例如，

```
interface IMyInterface
{
    void DoSomething();
}

static class IMyInterfaceFactory
{
    public static IMyInterface GetInstance()
    {
        return new MyInterfaceInstance();
    }
}

class IMyInterfaceConsumer
{
    IMyInterface mInterface;

    public IMyInterfaceConsumer()
    {
        this.mInterface = IMyInterfaceFactory.GetInstance();
    }

    public void UseTheInterface()
    {
        this.mInterface.DoSomething();
    }
} 
```

我的问题是关于使用 var 关键字。甚至不使用真正的 C# 接口，但仍然在设计意义上创建一个“接口”，

```
static class IMyInterfaceFactory
{
    // of course, this doesnt need to be a single instance
    static MyInterfaceInstance mSingleInstance; 

    // no longer programming to the interface, just returning the instance
    public static MyInterfaceInstance GetInstance()
    {
        // null coalesce
        return mSingleInstance ?? (mSingleInstance = new MyInterfaceInstance());
    }
}

class IMyInterfaceConsumer
{
    public void UseTheInterface()
    {
        // shorthand way, could also omit var, too 
        var myInterface = IMyInterfaceFactory.GetInstance();
        myInterface.DoSomething();
    }
} 
```

这样我仍然只需要更改一次工厂，只要它返回的任何实例支持需要使用的方法，它就可以工作。然而，优点是生产和消费对象甚至不需要知道任何显式接口，不存在。它还可以干净地支持具有多个方法的接口（防止臃肿的接口声明）。

一个明显的缺点是，每次您想从“接口”使用方法时，工厂可能必须重新实例化该类，除非缓存了单个实例（如上）或使用了一些记忆技术。

这种方法的优点/缺点？这是一种常见的做法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-19T21:08:47.437

`var`关键字没有什么动态或松散的。它在编译时触发静态类型推断。

您的第二段代码的行为与

```
public void UseTheInterface()
{
    // shorthand way, could also omit var, too 
    MyInterfaceInstance myInterface = IMyInterfaceFactory.GetInstance();
    myInterface.DoSomething();
} 
```

工厂函数仍然是强类型的。事实上，通过删除接口，您使消费者代码的耦合更加紧密。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-19T21:17:27.507

Var 关键字在技术上仍然是强类型的，因此您的代码确实知道它是什么类/接口。如果您打算将其转储到一个对象中，那么我们是说您的其余代码不知道该工厂的内容是什么。我不建议这样做，因为这会导致您强制转换该对象以利用其中的任何内容。

我不确定您要尝试使用“防止臃肿的接口声明”，但您也可以通过扩展基类或抽象类来实现多态性。这样一来，子类之间的任何通用代码都可以单独保留，并且每个子类的任何特定代码（方法或属性）都可以被覆盖。

如果您希望一起更改接口，则需要在接口中实现接口，[请参阅这篇文章](https://stackoverflow.com/questions/2283432/c-sharp-interfaces-only-implement-an-interface-in-other-interfaces)。所以你基本上只有接口 A 只有方法 DoStuff() 和从这个接口继承的其他接口可以像你描述的那样多态地使用。

```
interface A
{

DoStuff();
}

interface B : A
{
DoSomethingElse();
}

class C : B
{

DoStuff(){}
DoSomethingElse(){}
} 
```

顺便说一句，您上面的“单实例缓存”代码接近于所谓的单例[模式](http://msdn.microsoft.com/en-us/library/ff650316.aspx)。

# joomla - 在哪里访问/更改 Joomla 模块生成的内容

> ID：12502890
> 
> 赞同：0
> 
> 时间：2012-09-19T21:06:24.627
> 
> 标签：joomla

我的任务是添加一个指向 Joomla v1.5 站点的链接。为简洁起见，我不会包括背景故事。长话短说……这个 Joomla 网站将在不久的将来被 Drupal 取代。目前我需要在 Joomla 版本中添加一些内容。

我有一个菜单，其中包含一系列`<li>`项目，这些项目是指向其他页面的超链接。[我可以使用FireBug](http://getfirebug.com/)查看 HTML 源代码，因此我可以看到 Joomla 模板代码正在生成。

Joomla 模板代码是...

```
<jdoc:include type="modules" name="menu5" /> 
```

它创建以下 HTML

```
<li><a href="/index.php?option=com_dmenu&id=35&mid=6">Link #1 Text</a></li>
<li><a href="/index.php?option=com_dmenu&id=36&mid=7">Link #2 Text</a></li>
<li><a href="/index.php?option=com_dmenu&id=37&mid=7">Link #3 Text</a></li>
<li><a href="/index.php?option=com_dmenu&id=38&mid=7">Link #4 Text</a></li> 
```

我可以通过 Joomla 界面查看名为**menu5**的模块，但我看不到任何编辑它生成的内容的方法。我可以更改有关菜单的元数据（标题、位置、顺序、访问级别等），但不能更改菜单​​生成的内容。我要做的就是在此列表中插入另一个链接。我可以修改模板并对其进行硬编码，除非它需要插入到列表的中间。

那里有任何 Joomla 大师可以告诉我在哪里修改这个模块生成的内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T23:19:05.727

这听起来像是一个[Joomla！`Menu`模块](http://docs.joomla.org/Menu)（在`Module Manager`您可以检查类型列并查看它是否为菜单类型）。

如果是菜单，则需要使用`Menu`菜单选择正确的菜单，然后向其中添加菜单项。（对不起所有的菜单，这是一个自我参考的主题）。

通常，菜单模块将具有与其显示的菜单相同/相似的名称。

# php - 如何声明一个包含一项调用函数的数组？

> ID：12502892
> 
> 赞同：1
> 
> 时间：2012-09-19T21:06:45.227
> 
> 标签：php

我正在开发一个项目，该项目将根据存储在文本文件中的数据生成大量表。

无论如何我想让我的代码看起来像这样..

```
 function Phone($arg){
   ....
   return $phone_nr
   }

   function Adress($arg){
   ....
   return $adress_nr
   }

   function Arr_push($args) {
        for ($i = 1; $i < func_num_args(); $i++) {
            $keys[$i - 1] = func_get_arg($i);
        }
        foreach ($keys as $key) {
            $arr_return[] = $key;
        }
        return $arr_return;
    }

    $Table1[] = Arr_push($DB,'Name:', 'John', 'Gender:', 'male');
    $Table1[] = Arr_push($DB,'phone:', Phone('John'), 'Address', Adress('John'));

    $table = new TableClass();
    $table->show($Table1);

    ($DB is the database a 2d array with keys and values) 
```

这可以做到吗？还是我必须为此编写某种解析器

```
"Parser method"

 $Table1[] = Arr_push('phone:', '^phone,John', 'Address', ^adress,John');

 in Arr_push function check if the string start with a '^'. In that case explode
 it on the delimiter ',' and have switch loop for the different cases. 
```

我一直在寻找这几天没有，所以我不得不提出这个问题。

扩展信息...

文件看起来像这样......

1 2 PRD~1 3 ISO 8859-1~1 4 0 ~2 1 Rundvirke Skog~2 2 VIRK1209.APT~3 1 311214~3 2 000000~3 3 1 ~803 4 311214~3 5 Valmet~3 6 911.3~ 3 7 ........它一直在继续

使用糟糕的正则表达式进行了管理：

```
%((\d{1,}\s?)+(?=~))|(((\d{1,}\s\d{1,})\s?\r?\n)(^(\w|\s|[å-ö]|[Å-Ö]|,|\.|
    \?|-|\?|@|\*|/)+))%mx 
```

将其读入这样的二维数组...

```
[Var_id] [Type]  [Data]
 1        4       0 
 1        3       ISO 8859-1
 1        2       PRD
 2        2       VIRK1209.APT
 2        1       Rundvirke Skog
 3        6       911.3
 3        7       Valmet 
 3        8       360.1/360.2
 3        5       Valmet
 3        3       1
 3        2       000000
  ..... 
```

我想要的输出是带有一些数据的表格，例如

```
| Machine   | Valmet  | Type  | 911.3
| ......    | ...... 
```

数据（Valmet 和 911.3）由其 [Var_id] 和 [Type] 调用

所以当做那些表时，我会很高兴有一个“干净”的代码

```
 $array[] = arr_push($DB, 'Produktion:', '', 'Apteringsinstruktion:', '');
    $array[] = arr_push($DB, 'FilNamn:', '^get, 1, 2', 'Filnamn:', '^get, 2, 2');
    $array[] = arr_push($DB, 'Nollställ datum:', '^get, 11, 4', 'Indetitetsuppgifter', '^get, 2, 1');
    $array[] = arr_push($DB, 'Lagrind datum:', '^get, 12, 4', 'Skapat datum:', '^get, 13, 4');
    display_table($array);

    How the input looks like now with the "parser" method. 
```

那么有没有办法用函数调用替换这个 '^get,var_id,type' 解析器呢？

有关 StandforD 标准的更多信息，请访问：[http ://www.skogforsk.se/en/About-skogforsk/Collaboration-groups/StanForD/](http://www.skogforsk.se/en/About-skogforsk/Collaboration-groups/StanForD/)

更多关于解释 [var_id] [type] 的文件：[http](http://www.skogforsk.se/PageFiles/60712/AllVarNo_ENG_120418.pdf) ://www.skogforsk.se/PageFiles/60712/AllVarNo_ENG_120418.pdf 。

背景：Harvester 正在制作 prd 文件，其中包括所有的木材、体积和时间等。市场上没有免费的查看器（据我所知）。所以我正在做一个 prd 查看器 i PHP。

我不知道在哪里托管它，所以我不想要一个 sql 服务器作为后端。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T05:02:30.070

这就是我目前要走的路线。消极的部分是“函数调用”

> '^abc,a'

将与语法突出显示中的其他字符串具有相同的颜色（使用 netbeans）。正在使用 lambda 进行测试，但它似乎无法在数组中工作。

为什么这不起作用？

```
$hello = function() {
   return 'hello world';
};

$stack = array("orange", "banana");
array_push($stack, "apple", "raspberry", hello());
print_r($stack); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-20T04:02:26.263

```
function abc($a)
{
    return '2'.$a;
}

$array = Array('a','^abc,a');
foreach ($array as $key => $value)
{
    $a = substr($value,0,1);
    if ($a=='^')
    {
        $e = explode(',',$value);
        $func = substr($e[0],1);
        unset($e[0]);
        // return any second, thrird... commas
        $value2 = implode(',',$e);
        $value3 = call_user_func_array($func,Array($value2));
        $array[$key] = $value3;
    }
}

echo var_dump($array); 
```

结果：

```
array (size=2)
  0 => string 'a' (length=1)
  1 => string '2a' (length=2) 
```

# apache - 子目录中的 joomla

> ID：12502896
> 
> 赞同：0
> 
> 时间：2012-09-19T21:06:58.940
> 
> 标签：apache, .htaccess, joomla

我无法在我的服务器子目录中设置 joomla。在服务器的主目录中，我有 .htaccess ：

```
<IfModule mod_rewrite.c>
 RewriteCond %{HTTP_HOST} joomlasite.domaniew.pl
 RewriteCond %{REQUEST_URI} !^/joomlasite
 RewriteRule ^(.*)$ one/$1 [L]

 RewriteRule    ^$ app/webroot/    [L]
 RewriteRule    (.*) app/webroot/$1 [L]
</IfModule> 
```

在 joomlasite 子目录中，我有 .htaccess：

```
<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteRule ^(.*)$ index.php/$1 [QSA,L]
</IfModule> 
```

我尝试了几种不同的组合，但仍然出现错误： `Parse error: syntax error, unexpected '=', expecting '(' in /homez.221/myserver/www/joomlasite/includes/framework.php on line 42`

我怎样才能使它工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T21:17:41.900

这不是 htaccess 的问题，您得到的错误是：

> 解析错误：语法错误，意外的“=”，在第 42 行的 /homez.221/myserver/www/joomlasite/includes/framework.php 中期待“（”

与您的 Joomla 安装有关。[Joomla 论坛上的这个帖子](http://forum.joomla.org/viewtopic.php?t=695168)讨论了这个特定的错误，您可以尝试从该帖子中进行一些故障排除，特别是确保您拥有正确的 PHP 版本和正确的处理程序。

# python - 使用 boto 将 AWS 实例/卷映射到快照

> ID：12502897
> 
> 赞同：0
> 
> 时间：2012-09-19T21:07:02.743
> 
> 标签：python, amazon-web-services, boto

我正在编写一个**python**脚本来检查我所有正在运行的实例是否有**ebs**快照......

```
rsv = self.botoEC2.get_all_instances()
for r in rsv:
  ins = r.instances[0]
  blockDevice = self.getInstanceAttribute(ins,"blockDeviceMapping")
  print blockDevice

def getInstanceAttribute(self,instance,attribute):
    return instance.get_attribute(attribute) 
```

输出：

```
{u'blockDeviceMapping': {u'/dev/sda1': <boto.ec2.blockdevicemapping.BlockDeviceType object at 0x10d5faed0>}} 
```

我是新手。我在正确的道路上吗？

我需要先获取`blockDeviceMapping`，然后调用音量函数吗？

如何获取实际的卷 ID，以便检查现有快照？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-20T03:08:02.533

听起来您想遍历所有正在运行的实例，然后遍历连接到这些实例的所有 EBS 卷。那正确吗？如果是这样，我会做这样的事情：

```
import boto

ec2 = boto.connect_ec2()
reservations = ec2.get_all_instances(filters={'instance-state-name': 'running'})
volumes = []
for r in reservations:
    for i in r.instances:
        volumes.extend(ec2.get_all_volumes(filters={'attachment.instance-id': i.id})) 
```

此时，卷将包含附加到正在运行的 EC2 实例的所有卷对象的列表。

# javascript - jQuery滑动菜单错误

> ID：12502900
> 
> 赞同：0
> 
> 时间：2012-09-19T21:07:20.113
> 
> 标签：javascript, jquery, html, css

我正在使用**jQuery**（3 级）制作动画菜单。我正在使用效果`slideDown`和`slideUp`. 有时（但并非总是如此），当我打开第一个主要项目的子菜单时，第二个主要项目的子菜单在我刷新页面之前将不起作用。它适用于效果`fadeIn`和`fadeOut`，但我想使用幻灯片。

这是我的代码：http: [//jsfiddle.net/mcCAx/](http://jsfiddle.net/mcCAx/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T21:25:57.347

这为我解决了 [这里](http://jsfiddle.net/mcCAx/2/)

```
$(document).ready(function()
    {    
        $('li.MainStage').hover(        function()
            {
                $(this).stop();
                $(this).find('ul.SubStage').slideDown('slow');
            },        function()
            {
                $(this).stop();
                $(this).find('ul.SubStage').slideUp('slow');
            });

        $('li.SubStage').hover(        function()
            {
                $(this).stop();
                $(this).find('ul.Sub2Stage').slideDown('slow');
            },        function()
            {
                $(this).stop();
                $(this).find('ul.Sub2Stage').slideUp('slow');
            });        
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T23:07:44.170

问题是`<ul class="SubStage">`元素的样式被覆盖了。因此，通过在回调中重新覆盖样式来以防万一。您的侧边菜单每次都会出现。:)

```
$(document).ready(function()
{    

    $('li.MainStage').hover(
    function()
        {
            $(this).find('ul.SubStage').slideDown('slow',function(){
                $(this).parent().find('ul.SubStage').css({overflow:"visible"});
            });
        },
    function()
        {
            $(this).find('ul.SubStage').stop().slideUp('slow');
        });

    $('li.SubStage').hover(
    function()
        {
            $(this).find('ul.Sub2Stage').slideDown('slow');
        },
    function()
        {
            $(this).find('ul.Sub2Stage').stop().slideUp('slow');
        });        
});​ 
```

[在这里查看。](http://jsfiddle.net/mcCAx/3/)

# oop - 无法链接到需要参数的基本构造函数

> ID：12502904
> 
> 赞同：1
> 
> 时间：2012-09-19T21:07:28.227
> 
> 标签：oop, sdl, vala, sdl-ttf

```
public class Font : SDLTTF.Font {
    public Font (string _filename, int _size) {

    }

    public void draw () {

    }
} 
```

那是我的代码。当我尝试构建它时，我得到：

```
Font.vala:4.5-4.15: error: unable to chain up to base constructor requiring arguments
    public Font (string _filename, int _size) {
    ^^^^^^^^^^^
Compilation failed: 1 error(s), 0 warning(s) 
```

我以为我需要重写构造函数，所以我尝试了`public override`它，但现在我得到了：

```
Font.vala:4.5-4.24: error: abstract, virtual, and override modifiers are not applicable to creation methods
    public override Font (string _filename, int _size) {
    ^^^^^^^^^^^^^^^^^^^^
Compilation failed: 1 error(s), 0 warning(s) 
```

有想法该怎么解决这个吗？我正在尝试继承 SDLTTF.Font 类。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T21:14:22.070

你试过把

```
base(_filename, _size); 
```

在你的构造函数中？

**编辑**：这对我有用。但是请注意，SDLTTF.Font 在 vapi 中定义为紧凑类，这意味着当您派生它时，您只能为您的子类定义新函数，但不能定义实例数据（成员变量等）。如果你需要这个，我建议你按照 apmasell 的建议去创建一个从 (G)Object 派生的包装类。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-19T22:29:57.433

SDLTTF 不由 GObject 管理，因此 Vala 无法创建派生类。Vala 只有使用 GObject 才能创建派生类，这在 GLib、GTK+、Pango、ATK 和许多 GNOME 库中很常见。

根据您想要做什么，您可以创建一个包含 SDLTFF.Font 实例的新类并代理适当的请求。

# django - 我怎么知道我正在处理表单集中的额外（空）表单？

> ID：12502907
> 
> 赞同：1
> 
> 时间：2012-09-19T21:07:53.777
> 
> 标签：django, django-forms

```
deals_formset_factory = modelformset_factory(Deal, form=DealForm, extra=1)   
formset = deals_formset_factory(queryset=query, prefix='deals')  

{% for fs in formset.forms %}
    {{ fs.id }}                     
{% endfor %} 
```

在遍历表单集的表单时，是否可以找出哪个表单包含实例数据以及哪个表单是多余的，因此是空的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T21:30:46.117

您可以检查表单实例是否具有主键。如果是，则它存在于数据库中。如果没有，那么它是一个额外的形式。

未经测试的代码：

```
{% for form in formset.forms %}
    {% if form.instance.pk %}
    Form instance is saved in db
    {% else %}
    New instance
    {% endif %}                 
{% endfor %} 
```

# r - 在 R 中使用 locator() 向绘图添加箭头

> ID：12502910
> 
> 赞同：3
> 
> 时间：2012-09-19T21:07:58.173
> 
> 标签：r, plot, graphics

是否可以使用定位器添加箭头？我试了一下，但没有运气......

```
plot(1:3)
arrows(x0=locator(1), x1=locator(1),
       y0=locator(1), y1=locator(1), code=1)#single headed arrow 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-19T21:14:44.767

如果您查看`locator(1)`返回的内容，您会明白为什么这甚至无法正常工作：

```
> locator(1)
$x
[1] 1.365533

$y
[1] 2.25695 
```

因此，您将长度为 2 的列表传递给每个参数。我可能会（虽然这不会是可重现的，所以在任何分析中我都不会真的生气地这样做）通过以下方式解决这个问题：

```
> locs <- locator(2)
> locs
$x
[1] 1.265845 1.587567

$y
[1] 2.604642 2.267028 
```

使用保存在中的数据添加箭头`locs`：

```
with(locs, arrows(x0=x[1], x1=x[2], y0=y[1], y1= y[2], code=1)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-20T10:12:04.617

在这种情况下，我个人不喜欢使用定位器。一个非常快速起草的替代方案可能如下。需要注意的是，您可以随时更改设计“arrow_pos”的方式

```
arrow_pos = as.data.frame(matrix(1:2,2,2))
colnames(arrow_pos)<- c("x","y")
with(arrow_pos, arrows(x0=x[1],x1=x[2], y0=y[1],y1=y[2])) 
```

或者，您也可以执行以下操作：

```
x_s<-c(1,2)
y_s<-c(1,2)
arrow_pos <- as.data.frame(rbind(x_s,y_s)) 
```

在这种情况下，您还可以使用直接从您正在绘制的向量获取数据的命令填充 x_s。

```
V1 = 1:3 
```

作为示例，您然后将这些存储在您的“arrow_pos”中

```
length(V1); ceiling(mean(V1)); median(V1) 
```

# java - oracle.sql.ARRAY 和 oracle.sql.ArrayDescriptor 的通用实现

> ID：12502912
> 
> 赞同：1
> 
> 时间：2012-09-19T21:08:05.567
> 
> 标签：java, sql, oracle

我试图从我的持久层中抽象出一些实现细节。就目前而言，我有两个函数，一个创建一个`ARRAY`，一个创建一个`ArrayDescriptor`. 我目前正在使用 HSQL 编写测试，并一直遇到一个问题，在`ClassCastException`从. 这是由以下原因引起的： [createDescriptor](http://docs.oracle.com/cd/E16338_01/appdev.112/e13995/oracle/sql/ArrayDescriptor.html#createDescriptor_java_lang_String__java_sql_Connection_)。有没有办法删除 Oracle 细节并以通用方式使用 ARRAY 和 ArrayDescriptor 的概念？我目前不在我的源代码附近，所以我会从记忆中回忆。`JDBCConnection``OracleConnection`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T22:52:49.337

如果您使用的是 JDBC 4 / Java 6 或更高版本，您可以尝试使用 JDBC 数组创建方法，

[Connection.createArrayOf()](http://docs.oracle.com/javase/6/docs/api/java/sql/Connection.html#createArrayOf%28java.lang.String,%20java.lang.Object%5B%5D%29)

从内存来看，Oracle 特定的 API 为您提供了更多的选择和灵活性，但如果您想使用 Oracle 以外的其他东西作为数据库，则使用 JDBC API 确实是唯一的选择。

* * *

编辑：根据[此文档](http://docs.oracle.com/cd/B28359_01/java.111/b31224/oraarr.htm)，Oracle JDBC 驱动程序不支持 createArrayOf()。因此，您可能做的最好的事情就是`instanceof`检查您的代码，如果检测到 OracleConnection，则使用 Oracle 特定的 API，否则使用 Connection.createArrayOf()。

# c# - Linq Complex OrderBy by Props 属性

> ID：12502913
> 
> 赞同：3
> 
> 时间：2012-09-19T21:08:16.787
> 
> 标签：c#, linq, sorting, attributes, sql-order-by

我有一个带有一些带有一些属性标记的道具的类。我想按特定顺序显示它们。到目前为止，我可以将它们按顺序排列，但不能按我想要的顺序排列。

这是带有属性的道具的简单示例

```
[IncludeInEditor]
[IsInPk]
ID
[IncludeInEditor(IsReadOnlyOnModify=true)]
Name
[IncludeInEditor]
Address
[IncludeInEditor]
DOB

The order that I want is:
  1st - Props with IsInPk attribute
  2nd - Props with IncludeInEditor(IsReadOnlyOnModify=true)
  3rd - Props with IncludeInEditor 
```

到目前为止，我没有成功，也没有 100% 完成（仍然缺少 IsReadOnlyOnModify=true 部分）

```
var properties =
item.GetType().GetProperties()
.Where(p => p.GetCustomAttributes(true)
                            .OfType<IncludeInEditorAttribute>()
                            .Count() > 0)
                .Select (x => new 
                {
                    Property = x,
                    Attribute = (IsInPkAttribute)Attribute.GetCustomAttribute(x, typeof(IsInPkAttribute), true) 
                })
                .OrderBy(x => x.Attribute != null ? 1 : -1)
                .Select(x => x.Property)
                .ToArray(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T21:46:02.920

您可以创建自己的`IComparer<T>`实现来比较每个属性的属性：

```
public class AttributeComparer : IComparer<Attribute>
{
    public int Comparer(Attribute x, Attribute y)
    {
        if(x == null) return y == null ? 0 : -1;
        if(y == null) return 1;

        if(x is IsInPkAttribute) return (y is IsInPkAttribute) ? 0 : 1;
        else if(y is IsInPkAttribute) return -1;
        else
        {
            xa = (IncludeInEditorAttribute)x;
            ya = (IncludeInEditorAttribute)y;

            if(xa.IsReadOnlyOnModify == ya.IsReadOnlyOnModify) return 0;
            else return x.IsReadOnlyOnModify ? 1 : -1;
        }
    }
} 
```

然后您的查询变为：

```
var properties = item.GetType().GetProperties()
    .Where(p => p.GetCustomAttributes(true)
                .OfType<IncludeInEditorAttribute>()
                .Any())
    .Select (x => new 
    {
        Property = x,
        Attribute = Attribute.GetCustomAttribute(x, typeof(IsInPkAttribute), true) ?? Attribute.GetCustomAttribute(x, typeof(IncludeInEditorAttribute, true))
    })
    .OrderBy(x => x.Attribute, new AttributeComparer())
    .Select(x => x.Property)
    .ToArray(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-20T16:50:22.537

在李的帮助下，终于成功了。正确的代码是：

```
var properties =
                item.GetType().GetProperties()
                                .Where(p => p.GetCustomAttributes(true)
                                            .OfType<IncludeInEditorAttribute>()
                                            .Any())
                                .Select(x => new
                                {
                                    Property = x,
                                    Attribute = Attribute.GetCustomAttribute(x, typeof(IsInPkAttribute), true)
                                                    ?? Attribute.GetCustomAttribute(x, typeof(IncludeInEditorAttribute), true)
                                })
                                .OrderBy(x => x.Attribute, new IncludeInEditorAttributeComparer())
                                .Select(x => x.Property)
                                .ToArray(); 
```

Lee发送的这段代码，我做了一点改动。

```
public class IncludeInEditorAttributeComparer : IComparer<Attribute>
    {
        public int Compare(Attribute x, Attribute y)
        {
            //In this case we can assume that
            //won´t have null values

            if (x is IsInPkAttribute && !(y is IsInPkAttribute))
                return -1;
            else if (y is IsInPkAttribute && !(x is IsInPkAttribute))
                return 1;
            else 
            { 
                bool xa = (x is IncludeInEditorAttribute ? (x as IncludeInEditorAttribute).IsReadOnlyOnModify : false);
                bool ya = (y is IncludeInEditorAttribute ? (y as IncludeInEditorAttribute).IsReadOnlyOnModify: false);

                if (xa && !ya)
                    return -1;
                else if (ya && !xa)
                    return 1;
                else
                    return 0;
            }
        }
    } 
```

# jquery - jQuery ajax 请求只同步工作，异步时不返回

> ID：12502915
> 
> 赞同：0
> 
> 时间：2012-09-19T21:08:19.043
> 
> 标签：jquery, asynchronous

我正在通过 jQuery ajax 向 .NET 通用处理程序 (.ashx) 发出请求。

我正在返回 JSON，我已在 JSONLint 上进行了验证，但无法发布，因为它是敏感数据。

问题是调用仅在同步完成时返回（`async:false`）。当异步完成时，它永远不会回来。 `async:false`将调用我的成功函数以及所有全局函数。 `async:true`只会调用全局函数，`ajaxStart`并且会调用这些函数以及其他函数。`ajaxSend``async:false`

我不知道如何进一步调试或确定为什么没有响应返回。

```
$.ajax({
    type: "POST",
    async: false,
    cache: false,
    timout: 600000,
    data: request_object.GetQueryString(),
    dataType: "json",
    responseType: "json",
    error: function (request, error_type, error_message) {
        alert("error");
    },
    success: function (data, status, request) {
        alert("success");
    },
    url: "./ReportRequestHandler.ashx",
    complete: function () {
        alert("here");
    }
});

$(document).ajaxError(function () {
    alert("ajaxError");
}).ajaxSend(function () {
    alert("ajaxSend");
}).ajaxStart(function () {
    alert("ajaxStart");
}).ajaxStop(function () {
    alert("ajaxStop");
}).ajaxSuccess(function () {
    alert("ajaxSuccess");
}).ajaxComplete(function () {
    alert("ajaxComplete");
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T11:49:27.920

我发现了问题。用于触发事件的按钮是提交页面并重新加载太快，我看不到任何闪烁。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T21:25:45.947

我认为是因为“。” 在网址中。您是否尝试删除它？检查这个以及他们有类似的东西

[使用异步时jQuery没有得到回复](https://stackoverflow.com/questions/8629576/jquery-not-getting-reply-when-using-asynchronous?rq=1)

希望能帮助到你

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-19T21:30:42.597

我在您的配置无异步属性的页面中运行代码，它似乎对我来说工作正常..

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="Default.aspx.cs" Inherits="Pages" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">

    <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script>

    <title></title>

    <script type="text/javascript">
        $(document).ajaxError(function() {
            alert("ajaxError");
        }).ajaxSend(function() {
            alert("ajaxSend");
        }).ajaxStart(function() {
            alert("ajaxStart");
        }).ajaxStop(function() {
            alert("ajaxStop");
        }).ajaxSuccess(function() {
            alert("ajaxSuccess");
        }).ajaxComplete(function() {
            alert("ajaxComplete");
        });
        $.ajax({
            type: "POST",
            timout: 600000,
            data: { 'type': 'check' },
            dataType: "json",
            responseType: "json",
            error: function(request, error_type, error_message) {
                alert("error");
            },
            success: function(data, status, request) {
                alert("success");
            },
            url: "../../Ajax/GenericData.ashx",
            complete: function() {
                alert("here");
            }
        });

    </script>

</head>
<body>
    <form id="form1" runat="server">
    <div>
        <asp:ScriptManager ID="ScriptManager1" runat="server" />
    </div>
    </form>
</body>
</html> 
```

我按顺序收到了所有警报消息。您能否检查浏览器的控制台部分，并查看从您的配置中删除 async:false 时您的请求到底发生了什么。

# c# - await 语句与表达式

> ID：12502917
> 
> 赞同：5
> 
> 时间：2012-09-19T21:08:25.517
> 
> 标签：c#, async-await

我正在关注 MSDN 上的[await](http://msdn.microsoft.com/en-us/library/hh156528.aspx)教程，并试图找出 using `await`as a *statement*与 using `await`as an *expression*之间的区别。这整个 async-await 事情让我心烦意乱，我找不到这个特殊情况的任何例子。

基本上，我想看看如何`await`异步使用多个 s，这意味着我不想在第二个开始之前等待第一个完成。对我来说，这违背了异步的目的：

```
private async void button1_Click(object sender, EventArgs e)
{
    // Using await as an expression
    string result_a = await WaitAsynchronouslyAsync();
    string result_b = await WaitAsynchronouslyAsync();

    // This takes six seconds to appear
    textBox1.Text = result_a + Environment.NewLine;
    textBox1.Text += result_b;
}

public async Task<string> WaitAsynchronouslyAsync()
{
    await Task.Delay(3000);
    return "Finished";
} 
```

然而，通过一个细微的改变，两个“Finished”的出现总共只需要 3 秒，这就是我想要的——这两个`await`s 真正异步运行：

```
private async void button1_Click(object sender, EventArgs e)
{
    var a = WaitAsynchronouslyAsync();
    var b = WaitAsynchronouslyAsync();

    // Using await as a statement
    await a;
    await b;

    // This takes three seconds to appear
    textBox1.Text = a.Result + Environment.NewLine;
    textBox1.Text += b.Result;
} 
```

我的问题是，为什么这些行为不同？我在这里错过了什么微妙的点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-19T21:12:23.740

首先，你需要区分*并行*和*异步*。在第一种情况下，很容易仍然值得同步执行操作（实际上第二个操作可能取决于第一个操作的结果）以释放 UI 线程等。

但至于为什么他们的行为不同 -*只是*`await`一种表达。这是一种可以作为语句出现的表达式，但它的行为方式相同，就像调用返回字符串但忽略返回值的方法一样。您可以通过将第一个代码更改为：

 *```
// Still takes 6 seconds...
var a = WaitAsynchronouslyAsync();
await a;

var b = WaitAsynchronouslyAsync();
await b; 
```

这仍然需要 6 秒。关键是您在等待第一个异步操作*完成后才开始第二个异步操作。*在您的第二个示例中，两个异步操作同时发生。

您仍然可以这样做*并将*值分配给变量，您只需要记住等待对象：

```
// This will only take 3 seconds
var a = WaitAsynchronouslyAsync();
var b = WaitAsynchronouslyAsync();
string result_a = await a;
string result_b = await b; 
```

所以基本上，区别与语句/表达式无关 - 它与序列是开始/等待/开始/等待还是开始/开始/等待/等待有关。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-19T21:20:26.317

在这两种情况下，await 关键字都会引入异步。您看到差异的原因是，在案例 1 中，您按顺序启动两个任务，而在案例 2 中，您让它们并行运行。

也许对这两种情况的逐步解释可以解决问题

```
string result_a = await WaitAsynchronouslyAsync(); 
string result_b = await WaitAsynchronouslyAsync(); 
```

这里发生的是：

*   任务 (a) 开始
*   等待任务 a（控制权返回给调用者）
*   当任务a在3秒后完成时，方法继续；任务 (b) 开始
*   等待任务 b（控制权返回给调用者）
*   当任务 b 再过 3 秒后完成时，会出现文本

在第二种情况下：

```
var a = WaitAsynchronouslyAsync();     
var b = WaitAsynchronouslyAsync();     
await a;     
await b; 
```

*   任务 (a) 开始
*   任务 (b) 开始
*   任务 (a) 被“等待”（即，控制权返回给调用者）
*   当任务（a）在 3 秒后完成时，等待任务（b）
*   由于任务 b 大约在 3 秒前开始，它或多或少与（a）同时完成
*   文字出现*

# java - facebook 事件 start_time 没有返回正确的值

> ID：12502918
> 
> 赞同：0
> 
> 时间：2012-09-19T21:08:29.823
> 
> 标签：java, facebook, facebook-graph-api

从 java 代码中使用 fql 返回的 start_time 值不同于从图形资源管理器返回的值。

fql:

```
fql?q={"events":"SELECT eid, name,description, start_time, end_time, pic_small,pic_big, eid,venue,location from event WHERE eid in (SELECT eid FROM event_member WHERE uid = me() and start_time > 1347482366)" ,"locations":"select page_id,location from page where page_id IN (select venue.id from #events)" ,"rsvpStatus":"select eid, rsvp_status from event_member where eid IN (select eid from #events) AND uid = me()"} 
```

java代码结果：

```
{
  "data": [
    {
      "name": "events",
      "fql_result_set": [
        {
          "eid": 495493753795633,
          "name": "Yo yo party",
          "description": "",
          "start_time": **1347656400**,
          "end_time": **1347670800**,
          "pic_small": "http:\/\/profile.ak.fbcdn.net\/static-ak\/rsrc.php\/v2\/yy\/r\/XcB-JGXohjk.png",
          "pic_big": "http:\/\/profile.ak.fbcdn.net\/static-ak\/rsrc.php\/v2\/yn\/r\/5uwzdFmIMKQ.png",
          "venue": {
            "id": 154409375600
          },
          "location": "PIKE PLACE FISH MARKET"
        }
      ]
    },
    {
      "name": "locations",
      "fql_result_set": [
        {
          "page_id": 154409375600,
          "location": {
            "street": "86 Pike Place",
            "city": "Seattle",
            "state": "WA",
            "country": "United States",
            "zip": "98101",
            "latitude": 47.608639747653,
            "longitude": -122.3405485174
          }
        }
      ]
    },
    {
      "name": "rsvpStatus",
      "fql_result_set": [
        {
          "eid": 495493753795633,
          "rsvp_status": "attending"
        }
      ]
    }
  ]
} 
```

图浏览器结果：

```
{
  "data": [
    {
      "name": "events",
      "fql_result_set": [
        {
          "eid": 495493753795633,
          "name": "Yo yo party",
          "description": "",
          "start_time": "**2012-09-14T14:00:00-0700**",
          "end_time": "**2012-09-14T18:00:00-0700**",
          "pic_small": "http://profile.ak.fbcdn.net/static-ak/rsrc.php/v2/yy/r/XcB-JGXohjk.png",
          "pic_big": "http://profile.ak.fbcdn.net/static-ak/rsrc.php/v2/yn/r/5uwzdFmIMKQ.png",
          "venue": {
            "id": 154409375600
          },
          "location": "PIKE PLACE FISH MARKET"
        }
      ]
    },
    {
      "name": "locations",
      "fql_result_set": [
        {
          "page_id": 154409375600,
          "location": {
            "street": "86 Pike Place",
            "city": "Seattle",
            "state": "WA",
            "country": "United States",
            "zip": "98101",
            "latitude": 47.608639747653,
            "longitude": -122.3405485174
          }
        }
      ]
    },
    {
      "name": "rsvpStatus",
      "fql_result_set": [
        {
          "eid": 495493753795633,
          "rsvp_status": "attending"
        }
      ]
    }
  ]
} 
```

以下是问题：

1.  时间格式差异
2.  返回给java代码的start_time和end_time不正确。当我转换 unix 时间戳时，结果比实际事件开始和结束时间少一小时。

这是一个已知的问题？任何信息将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T21:24:02.353

根据时间戳，图形 API 资源管理器结果为 UTC -7 这是否只是 FQL 结果是 UTC-8 中的 unix 时间戳？（直到最近，这是 Facebook 上的默认设置，并非所有应用程序都有正确的时区 - 我认为这是应用程序设置中的迁移选项）

# java - 如何加载用户的好友列表？

> ID：12502922
> 
> 赞同：0
> 
> 时间：2012-09-19T21:08:58.983
> 
> 标签：java, android, google-app-engine

我正在尝试创建一个允许人们登录我的应用程序并为他们创建个人资料的结构。他们还可以查找和添加朋友。他们还可以查看当前朋友的列表，然后查看他们的朋友资料。

所以，我意识到我可以利用谷歌的 AppEgnine 数据存储系统来做很多事情。[https://developers.google.com/appengine/docs/java/datastore/entities#Kinds_and_Identifiers](https://developers.google.com/appengine/docs/java/datastore/entities#Kinds_and_Identifiers)

不过我有几个问题。存储用户朋友列表和管理这些朋友的照片图标等的最佳方法是什么？

谷歌数据存储有一个查询非常具体的选项的选项，因此这在搜索功能期间很容易实现，甚至当用户单击朋友的名字以拉出那里的个人资料时。

我只是想知道管理朋友列表然后为每个用户加载照片图标的最佳方法是什么？我不确定你们中是否有人看过 facebook 应用程序，但是当您查看朋友列表时，它会很快将其拉起并在后台加载图像（可能为此使用 asynctask）。

有什么建议或答案吗？

谢谢！

**编辑：**我的主要问题是如何跟踪用户朋友列表并在从朋友列表中单击名称后允许加载用户个人资料？有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T22:16:21.637

使用应用引擎应用引擎高性能图像服务完成的图像服务几乎是免费的，而且速度非常快。这是一篇文章：http: [//ikaisays.com/2010/09/08/gwt-blobstore-the-new-high-performance-image-serving-api-and-cute-dogs-on-office-chairs/](http://ikaisays.com/2010/09/08/gwt-blobstore-the-new-high-performance-image-serving-api-and-cute-dogs-on-office-chairs/)

# haskell - 无法在 ghc 6.12.3 中加载 X11 库

> ID：12502923
> 
> 赞同：1
> 
> 时间：2012-09-19T21:09:02.990
> 
> 标签：haskell, osx-lion, x11

操作系统：OS X Mountain Lion 平台：ghc 6.12.3

我在使用 X11 1.6.0 库时遇到问题。当我编译我的文件时，我得到了这个错误。

`Loading package X11-1.6.0 ... can't load .so/.DLL for: Xext (dlopen(libXext.dylib, 9): image not found)`

我已经在互联网上进行了搜索，但找不到解决方案。我安装了 X11 并且还创建了指向 /usr 文件夹的符号链接，因为它默认安装在 /opt 中

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T06:21:37.787

根据[我们在 github 上的讨论](https://github.com/haskell-pkg-janitors/X11/issues/14)，他需要`dyld`指向`libXext.dylib`.

# java - Java Web 应用程序你好世界

> ID：12502926
> 
> 赞同：2
> 
> 时间：2012-09-19T21:09:08.847
> 
> 标签：java, eclipse, spring, maven, spring-mvc

我有一些问题。

我正在尝试学习如何使用 Java 制作 Web 应用程序（我来自 C#）。我要处理的项目是使用 Spring MVC。

现在Spring MVC / Java的所有教程都希望我使用Maven。我也在使用 Eclipse。

我的问题是，每次我尝试运行从以下教程下载的项目时： http: [//tech-read.com/2011/10/31/spring-3-mvc-annotations/](http://tech-read.com/2011/10/31/spring-3-mvc-annotations/) http://www.mkyong .com/spring3/spring-3-mvc-hello-world-example/

我无法运行该项目。它告诉我该项目没有 main 然后试图找到一个类，没有什么很清楚...我还观看了有关它的 youtube 视频，并且有人正在使用 Jetty 启动该网站。（视频链接：[http](http://www.youtube.com/watch?v=uv9tXFrTLtI) ://www.youtube.com/watch?v=uv9tXFrTLtI ）

所以我的问题是：

如果我有 Eclipse、Oracle JDK 1.7、Spring Tool Suite 3、Maven + m2e - Eclipse 的 Maven 集成、Spring IDE 等等等等插件，我应该能够从一个简单的 Hello World 项目运行网站吗？如果是这样，我是否必须告诉 Maven / Eclipse 启动我的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T21:12:37.120

您需要在服务器上下文中运行它。

为此，您需要安装一个 java web 服务器，就像 svz 说的那样。Tomcat是我使用的。

Spring Source Toolkit ( [STS](http://www.springsource.org/sts) ) 是开箱即用的。Spring 学习起来很混乱，我建议在你掌握它之前使用这个 IDE，然后你可以尝试更好的（不同的？）Web 服务器。

尝试右键单击您的项目并在服务器上运行它。它应该设置为开箱即用。

您也可以将其作为插件安装到 Eclipse，或者手动安装 tomcat 并将您的 war 文件放入 app 目录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-20T10:27:29.670

你可以使用码头。像这样在你的 pom 中添加 jetty 插件：

```
 <build>
  <finalName>spring-mvc-webapp</finalName>
  <plugins>
    <plugin>
      <artifactId>maven-compiler-plugin</artifactId>
      <configuration>
        <source>1.7</source>
        <target>1.7</target>
      </configuration>
    </plugin>
    <plugin>
      <groupId>org.mortbay.jetty</groupId>
      <artifactId>maven-jetty-plugin</artifactId>
      <version>6.0.1</version>
      <configuration>
        <scanIntervalSeconds>10</scanIntervalSeconds>
      </configuration>
    </plugin>
  </plugins>
</build> 
```

执行 mvn jetty:run

连接到网址：`http://localhost:8080/spring-mvc-webapp/`

# imagemagick - ImageMagick 调整大小：对于“只缩小更大”的情况，什么都不做

> ID：12502931
> 
> 赞同：3
> 
> 时间：2012-09-19T21:09:35.100
> 
> 标签：imagemagick, imagemagick-convert

原图： [http](http://www.tiaoyue.com/img/_test/original.jpg) *://www.tiaoyue.com/img/_test/original.jpg（2457字节）*

尝试通过 ImageMagick 获取缩略图：

```
convert \
   http://www.tiaoyue.com/img/_test/original.jpg \
  -thumbnail 200x200\> \
   SecondaryCompression.jpg 
```

或在 Windows 中：

```
convert ^
   http://www.tiaoyue.com/img/_test/original.jpg ^
  -thumbnail 200x200^> ^
   SecondaryCompression.jpg 
```

获取文件： `SecondaryCompression.jpg` *（2,452 字节）*

我可以在没有二次压缩的情况下获得目标文件（SecondaryCompression.jpg），只复制原始图像吗？（图像的*2,457 字节*）

参考：

*   [http://www.imagemagick.org/Usage/resize/#shrink](http://www.imagemagick.org/Usage/resize/#shrink)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-20T21:39:32.180

您的“转换”命令的真正问题***不是***文件经历了您所说的“二次压缩”。

真正的问题是，一些像素的颜色值变化非常轻微（这反过来确实可以为整个文件带来更好甚至更糟的压缩结果）。

因此，您应该首先研究如何防止颜色变化！

要记录 + 验证每个像素的颜色变化，请运行以下命令：

```
convert  http://www.tiaoyue.com/img/_test/original.jpg  original.txt
convert  SecondaryCompression.jpg                       SecondaryCompression.txt
sdiff -sbB  SecondaryCompression.txt  original.txt 
```

**提示：** TXT 输出格式`convert`是每个像素的坐标位置及其各自颜色值的文本表示（这些值以 3 种不同方式给出：十进制 RGB（或 CMYK）值、十六进制 RGB（或 CMYK）值、人类可读的颜色名称（如果可能的话）。如果您看到格式一次，您会立即理解它。

可以确定，在总共 7500 个像素中，总共有 1415 个像素改变了颜色值。那是 18.86% 的像素发生了变化。

要为像素差异创建视觉表示，请运行：

```
compare  original.jpg  SecondaryCompression.jpg                delta1.jpg
compare  original.jpg  SecondaryCompression.jpg  -compose src  delta2.jpg 
```

![delta1.jpg](../Images/47d174bed06225901f06f1f36c06acb3.png)    ![delta2.jpg](../Images/1e9441006a9f5306f21e0249b21d7d7c.png)    ![原创.jpg](../Images/bc370a90c24d6e325225c1982b786baa.png)    ![二次压缩.jpg](../Images/8d88da36913b4dabf94ac7f38478f0c1.png)

第一个图像（`delta1.jpg`，最左边）将具有不同颜色值的那些像素绘制为红色，使用 original.jpg 作为浅灰色背景图像。

第二个图像（`delta2.jpg`，左起第二个）仅绘制具有不同颜色的红色像素，并将相同的颜色值绘制为白色像素。

第三张图片（右二）是您的原始 JPEG。第四个（最右边）是您的“未更改”缩略图（实际上对某些像素进行了一些细微的更改）。

我现在没有时间调查轻微颜色变化的原因（我无法给出一个原因），但稍后可能会回到这个话题。

# debugging - 返回 Clojure 中所有当前作用域符号的表达式？

> ID：12502933
> 
> 赞同：6
> 
> 时间：2012-09-19T21:09:51.900
> 
> 标签：debugging, clojure, symbols

假设以下，

```
(in-ns silly.fun)

(def a 1)

(defn fx [b]
  ((fn [c] (return-all-symbols)) (first b))) 
```

我想知道是否有可能有一个 return-all-symbols 函数来返回当前在其调用范围内的符号/值的映射。因此，假设上面已经编译并且我们在 'silly.fun 命名空间中，我们可以运行类似下面的内容。

```
(fx [:hello]) => {"a" 1, "b" [:hello], "c" :hello} 
```

我想使用 return-all-symbols 进行调试。是否有可能返回所有符号？如果是这样，它的实现是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-19T22:56:34.223

这是可能的，但正如你定义的那样，你会很伤心：你不想要一个包含数百个条目的映射，这些条目引用了 clojure.core 中的所有函数！即使您只查看当前命名空间，您也忘记了 include `fx`，它是一个符号，其值是一个函数。另外，通常会有你不想要的词汇符号，由宏引入。例如，`(let [[x y] foo])`将显示四个可用符号：foo、x、y 和类似`vec__auto__4863`.

无论如何，您可能必须在这些问题上做出一些妥协，否则（实际上我认为这更好）指定您真正想要地图的符号。但是要自动获取（a）词法或（b）在当前命名空间中定义的那些符号的值，并且（c）不映射到函数，您可以使用：

```
(defmacro return-all-symbols []
  (let [globals (remove (comp :macro meta val) (ns-publics *ns*))
        syms (mapcat keys [globals, &env])
        entries (for [sym syms]
                  [`(quote ~sym) sym])]
    `(into {}
           (for [[sym# value#] [~@entries]
                 :when (not (fn? value#))]
             [sym# value#]))))

(def a 1)

(defn fx [b]
  ((fn [c] (return-all-symbols)) (first b)))

(fx [:hello])
;=> {a 1, c :hello, b [:hello]} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-20T00:18:20.330

[(ns-interns)](http://clojuredocs.org/clojure_core/clojure.core/ns-interns)可能是您想要的，但使用[(ns-map)](http://clojuredocs.org/clojure_core/clojure.core/ns-map)包裹在[(lazy-seq)](http://clojuredocs.org/clojure_core/clojure.core/lazy-seq)中对于大命名空间很有用。

```
1   (ns-map 'clojure.core)
2   {sorted-map #'clojure.core/sorted-map, read-line #'clojure.core/read-line, re-pattern #'clojure.core/re-pattern, keyword? #'clojure.core/keyword?, ClassVisitor clojure.asm.ClassVisitor, asm-type #'clojure.core/asm-type, val #'clojure.core/val, ...chop...} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-19T22:06:32.553

命名空间包含一个包含所有当前作用域变量的映射，它为您提供了您想要的部分内容。它会错过表达式中的词法范围符号，例如`(let [x 4] (return-all-symbols))`尽管可能仍然对调试有用：

```
core> (take 2 (ns-map *ns*))
([sorted-map #'clojure.core/sorted-map] [read-line #'clojure.core/read-line]) 
```

如果您需要更多，那么您可能需要一个使用 java 调试接口的真正调试器。查看[clojure 调试工具包](http://georgejahad.com/clojure/cdt.html)

# android - 我可以让一个活动扩展我的活动吗

> ID：12502937
> 
> 赞同：-3
> 
> 时间：2012-09-19T21:10:21.810
> 
> 标签：android

我创建了一个`Activity`允许用户创建页面的。这个 PageActivity 扩展了一个`Activity`. 我可以创建一个扩展 PageActivity 的名为 Update PageActivity 的类吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T21:13:43.463

是的，你可以，只要你没有声明`PageActivity`你`final`可以扩展它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-19T21:14:49.403

当然可以。Activity 就像任何其他 Java 类一样。确保覆盖相关的 Activity 生命周期函数 - onCreate、onResume 等...

# java - Jersey 服务器 - 在响应传输期间捕获连接失败

> ID：12502938
> 
> 赞同：2
> 
> 时间：2012-09-19T21:10:31.580
> 
> 标签：java, rest, timeout, connection, jersey

我们有一个使用**Jersey开发的 RESTful** **java**应用程序，部署在**CentOS 5.7**机器上的**weblogic 11g**中，可用于移动客户端 ( **Android** ) 连接。

 ******有时，由于移动网络的原因，服务器发送的响应（200OK w/payload）没有到达需要处理超时异常的客户端；服务器似乎没有意识到任何问题。

有没有办法捕获服务器端（在泽西岛）这种情况？我认为 tcp 应该引发 http 堆栈和 Jersey 应该处理的异常。

是否引发异常？

谢谢你的时间******

# drupal - Drupal 7 : get all node ids that has the same tag

> ID：12502945
> 
> 赞同：0
> 
> 时间：2012-09-19T21:10:56.790
> 
> 标签：drupal, drupal-7

How can i get all node ids that has the same tag. Thanks

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T22:28:29.787

您还可以使用分类 api。例如，如果您知道您的分类术语 id（标签 id），您可以使用该函数

[taxonomy_select_nodes](http://api.drupal.org/api/drupal/modules%21taxonomy%21taxonomy.module/function/taxonomy_select_nodes/7)

如果您现在有了标签的名称而没有 id，您可以使用函数[taxonomy_get_term_by_name](http://api.drupal.org/api/drupal/modules!taxonomy!taxonomy.module/function/taxonomy_get_term_by_name/7)

[http://api.drupal.org/api/drupal/modules%21taxonomy%21taxonomy.module/function/taxonomy_select_nodes/7](http://api.drupal.org/api/drupal/modules%21taxonomy%21taxonomy.module/function/taxonomy_select_nodes/7)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T21:17:31.800

以编程方式： http: [//api.drupal.org/api/drupal/includes%21database%21database.inc/function/db_select/7](http://api.drupal.org/api/drupal/includes%21database%21database.inc/function/db_select/7)

界面：[http ://drupal.org/project/views](http://drupal.org/project/views)

# php - MSSQL dump as PHP arrays

> ID：12502948
> 
> 赞同：0
> 
> 时间：2012-09-19T21:11:08.060
> 
> 标签：php, sql, multidimensional-array

I have a giant dump of an mssql file. I want to read that file via file_get_contents(), and plop it all into a bunch of arrays based on an ID from each line. Unfortunately, the ID is named something different in different tables. The lines below are all for one particular post (and are among 29 entries with the same ID). The ID is 1234567890 in the examples below.

Example:

[ID] below

```
INSERT [dbo].[sf_CmsContentBase] ([Application], [ID], [MimeType], [StreamingProviderName], [ParentID], [Url], [LoweredUrl], [CommentsCount], [ItemInfo], [Creator]) VALUES (N'/News', N'1234567890', N'text/html', NULL, NULL, N'/2012/URL', N'/2012/url', 0, NULL, N'author') 
```

[ContentID] below

```
INSERT [dbo].[sf_CmsTaggedContent] ([Application], [ContentID], [TagID], [Owner]) VALUES (N'/News', N'1234567890', N'3434', N'author') 
```

[ItemID] below

```
INSERT [dbo].[sf_VrsTxtData] ([Application], [ItemID], [CultureID], [Version], [KeyValue], [DataImpl], [HasDynamicLinks], [TypeCode]) VALUES (N'/', N'1234567890', 101, 1, N'Thumbnail', N'/news/images/thumbnail.jpg', 0, 18) 
```

So essentially what I'd do is form an array out of each of these lines first, so the first one would be something like

```
$sqlLineArray = array(
    'Application'           => '/News',
    'ID'                    => '1234567890',
    'MimeType'              => 'text/html',
    'StreamingProviderName' => NULL,
    'ParentID'              => NULL,
    'Url'                   => '/2012/URL',
    'LoweredUrl'            => '/2012/url',
    'CommentsCount'         => '0',
    'ItemInfo'              => NULL,
    'Creator'               => 'author'
); 
```

Then I would foreach over each of those arrays, apply some conditionals for the difference in ID naming, and then have another multidimensional array where the ID is the key, and it has all of the associate subarrays just created within in, so I've kind of linked the data together and I can normalize it for another database later.

Is there an easy way to do this with PHP without actually querying a database? I only have a data dump. I'm thinking I could just explode() in a bunch of places, but there's no rhyme or reason to the order where the ID appears, so I can't necessarily say that ID is $sqlLineArray[2] or something, because it's not always going to be that.

mssql_fetch_array() kind of seems appropriate, but the first parameter has to be a resource, not just a query string.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T21:16:48.613

**更新**

重新阅读问题后，我错过了从 SQL => PHP Array 开始的重要要求。鉴于所有`INSERT`语句都是标准化的，您必须按以下顺序解析：

1.  找到每一`INSERT`行，
2.  查找列列表
3.  查找值

* * *

这是一个快速而肮脏的解决方案：

```
$sql  = "INSERT INTO [dbo].[table]";

//Implode keys
$sql .= " ([" . implode("], [", array_keys($sqlLineArray)) . "])";

//Implode values
$sql .= " VALUES ('" . implode("', '", $sqlLineArray) . "') "; 
```

**结果**

```
插入 [dbo].[table] ([Application], [ID], [MimeType], [StreamingProviderName],
[ParentID], [Url], [LoweredUrl], [CommentsCount], [ItemInfo], [Creator]) VALUES ('/News',
'1234567890', 'text/html', '', '', '/2012/URL', '/2012/url', '0', '', '作者')
```

此解决方案将彻底准备您的数组，省略`NULL`s：

```
$cmd = "INSERT INTO [dbo].[table]";

foreach($sqlLineArray as $key=>$val) {
  if(isset($val)) {
    $colList[] = '[' . $key . ']';

    if(is_numeric($val)) {
      $valList[] = $val;
    }
    else {
      $valList[] = "N'" . $val . "'";
    }
  }
}

$sql = $cmd . '(' . implode(", ", $colList) . ') VALUES (' . implode(", ", $valList) . ')'; 
```

**结果**

```
插入 [dbo].[table]([Application], [ID], [MimeType], [Url], [LoweredUrl],
 [CommentsCount], [Creator]) VALUES (N'/News', 1234567890, N'text/html',
N'/2012/URL', N'/2012/url', 0, N'作者')
```

最后，此解决方案将准备您的数组，包括`NULL`：

```
$cmd = "INSERT INTO [dbo].[table]";

foreach($sqlLineArray as $key=>$val) {
  $colList[] = '[' . $key . ']';

  if(is_numeric($val)) {
    $valList[] = $val;
  }
  elseif(isset($val)) {
    $valList[] = "N'" . $val . "'";
  }
  else {
    $valList[] = 'NULL';
  }
}

$sql = $cmd . '(' . implode(", ", $colList) . ') VALUES (' . implode(", ", $valList) . ')'; 
```

**结果**

```
插入 [dbo].[table]([Application], [ID], [MimeType], [StreamingProviderName],
 [ParentID]、[Url]、[LoweredUrl]、[CommentsCount]、[ItemInfo]、[Creator]）值
(N'/News', 1234567890, N'text/html', NULL, NULL, N'/2012/URL', N'/2012/url', 0, NULL, N'author')
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T21:30:52.187

我喜欢 njks 解决方案，但我也想出了自己的可怕解决方案，以防有人感兴趣：

```
$data = file_get_contents('relevantlinesoriginal.sql');
$lines = explode("\n",$data);
foreach ($lines as $line) {
    $noInsert = explode("] (", $line);
    $noInsert = array_pop($noInsert);
    $separatingNamesAndValues = explode(") VALUES (N'", $noInsert);
    $namesString = $separatingNamesAndValues[0];
    $valuesString = $separatingNamesAndValues[1];
    $names = str_replace(array('[',']'), "", $namesString);
    $values = substr_replace($valuesString, "", -2);
    $names = explode(', ', $names);
    $values = explode(', ', $values);
    $finalArray = array_combine($names, $values);
    var_dump("<pre>", $finalArray, "</pre>");
} 
```

# java - 当 JTextPane 嵌入到 JScrollPane 中时，哪个组件处理箭头 KeyEvents？

> ID：12502954
> 
> 赞同：0
> 
> 时间：2012-09-19T21:11:27.140
> 
> 标签：java, swing, jscrollpane, key-bindings

好的，我们又来了。史蒂夫必须编写另一组非标准击键。我们在 JScrollPane 中嵌入了一个可编辑的 JTextPane。此窗格正确处理向上和向下箭头键，但我不知道如何。如果我能弄清楚如何，我可以实现我需要实现的非标准事物。

具体来说，因为 PageDown 键被全局映射到执行另一个功能，我们不执行 PageUp、PageDown、Ctrl-PageUp 和 Ctrl-PageDown 的默认操作。相反，我们希望将这些功能映射到移动的箭头键，而不是数字键盘上的那些。

特别是在 JScrollPane 类的祖先输入映射 ((InputMap)UIManager.get("ScrollPane.ancestorInputMap");) 我们添加

*   向下移动箭头键到指向“scrollDown”动作的祖先输入映射
*   向上移动箭头键到指向“scrollUp”动作的祖先输入映射
*   将左箭头键移到指向“scrollHome”操作的祖先输入映射
*   将右箭头键移到指向“scrollEnd”操作的祖先输入映射

这些击键都没有任何作用。我什至重写了 JComponent 的 processKeyEvent() 和 processKeyBinding() 方法来记录发生的事情，我发现这些击键永远不会触发这些方法。此外，普通的标准向上箭头和向下箭头击键不会触发这些方法，即使这些击键确实有效。

因此，似乎很明显其他东西正在处理这些击键。但那是什么组件？是的，当我尝试这个时，文本窗格确实有焦点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T21:37:20.823

*   史蒂夫的参考版本:-)

![在此处输入图像描述](../Images/581689802c290afb877c16d9d855aca2.png)

![在此处输入图像描述](../Images/91dd149f9b007885a221dd739602e786.png)

![在此处输入图像描述](../Images/dee965be0d00d63fab6e60c70563a766.png)

![在此处输入图像描述](../Images/d75fe203b2193bed33141d67e01bb11c.png)

![在此处输入图像描述](../Images/834c2c0bfde09bf0880ef2619635832a.png)

![在此处输入图像描述](../Images/088744341fca24560d56e9355f57540b.png)

*   DU也喜欢这个论坛，

*   SSCCE 可以为第二侧的志愿者打开任何门。不是吗

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-20T06:12:55.000

正如 mKorbel 正确显示的那样，有一个动作“向上翻页”和“向下翻页”（参见第 3 个屏幕）。所以只需使用 ActionMap 并将操作替换为您的操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-20T21:42:16.720

好吧，垃圾神基本上是对的。解决方案是对操作使用 KeyBindings 名称。找到正确答案的延迟是由于一些杂散的代码在其他地方撤消了映射。

更具体地说，我们禁用 JTextPane 中的默认击键，然后将它们添加到 Scroll Pane 的输入映射，映射到它们的新操作。

在 TextPane 构造函数中

```
...
        disableAction("caret-down"); // down arrow
        disableAction("caret-up");   // up arrow
        disableAction("selection-backward"); // shift-left-arrow
        disableAction("selection-forward");  // shift-right-arrow
        disableAction("selection-up");  //shift-up-arrow
        disableAction("selection-down"); // shift-down-arrow

    }

    private void disableAction(String name) {
        Action a = getActionMap().get(name);
        if (a != null) {
            a.setEnabled(false);
        }
    } 
```

在滚动窗格中

```
import static javax.swing.KeyStroke.getKeyStroke;
import static java.awt.event.KeyEvent.*;
...
    private void remapShiftedArrowKeys() {
        InputMap map = (InputMap)UIManager.get("ScrollPane.ancestorInputMap");
        map.put(getKeyStroke(VK_DOWN, SHIFT_DOWN_MASK), "scrollDown");
        map.put(getKeyStroke(VK_UP, SHIFT_DOWN_MASK), "scrollUp");
        map.put(getKeyStroke(VK_LEFT, SHIFT_DOWN_MASK), "scrollHome");
        map.put(getKeyStroke(VK_RIGHT, SHIFT_DOWN_MASK), "scrollEnd");
    } 
```

请注意，我们不必映射移动的 Up 和 Down 键，因为 JScrollPane 已经使用这些键完成了我们想要的操作。从 JTextPane 中取消映射它们就足够了。而其他四个击键是完全非标准的，也必须在滚动窗格中重新映射。

感谢你的帮助！

哦，实际的答案是 JTextPane 当然通常会处理这些箭头键。为了做我想做的事，我必须打败它并在滚动窗格中适当地映射，

# jquery - 为什么不通过表单元素上的 submit 方法提交表单调用 $.submit 处理程序？

> ID：12502957
> 
> 赞同：2
> 
> 时间：2012-09-19T21:11:38.020
> 
> 标签：jquery, forms

有关我正在谈论的工作示例，请参阅[http://jsfiddle.net/8KNc7/5/ （现在在 Firefox 15 中进行测试，尚未尝试其他方法）。](http://jsfiddle.net/8KNc7/5/)

我有一个带有`submit`输入和`button`输入的表单，它们都将表单数据提交到服务器，但只有`submit`输入会导致 jQuery 提交事件运行。为什么是这样？

形式：

```
<form action='/echo/html/' method='post' id='Form' name='Form'>
    <input type='hidden' value='posted' id='html' name='html'>
    <input type='submit' id='submit1' value='submit type'>
    <input type='button' id='submit2' value='button type' onclick='submitForm();'>
</form> 
```

Javascript（在 body 标签的末尾运行）：

```
var theForm = document.forms['Form'];
if (!theForm) {
    theForm = document.Form;
}
function submitForm() {
    theForm.submit();
}

$(function () {
    $('form').submit(function () {
        alert('ok');
    });
}); 
```

重点是，我希望两个按钮都会引起警报，但只有一个会引起警报。我知道我可以提交更改`submitForm`功能以使其正常工作，但我试图弄清楚为什么其中一个有效而另一个无效的区别是什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T21:49:18.393

本机表单提交方法绕过了 jQuery 提交处理程序。您可以在多种情况下利用它来发挥自己的优势。

```
$("#form").submit(function(e) {
    e.preventDefault();

    // validation
    if (valid(this)) {
        this.submit(); // submit form, bypassing jQuery bound submit handler
    }

}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-19T21:16:59.503

这是因为 jQuery 事件“提交”仅在提交类型按钮提交表单时触发。

> 当用户尝试提交表单时，提交事件被发送到元素。它只能附加到元素上。`<input type="submit">`可以通过单击显式、`<input type="image">`或`<button type="submit">`或在某些表单元素具有焦点时按 Enter来提交 表单。

取自[http://api.jquery.com/submit/](http://api.jquery.com/submit/)

一种方法是代替您的 onClick 事件和另一个按钮的 JS 函数添加一个 jQuery click() 事件处理程序：

```
$('#submit1').click(function(){
   alert('Ok');
   $('#Form').submit();
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-19T21:20:15.723

可能是因为`$('form').submit(...)`是 jQuery，而不是纯 JavaScript。

不管是什么原因，不要使用 JavaScript 的，而是`form.submit()`使用 jQuery 的`.trigger()`：

```
function submitForm() { 
    $(theForm).trigger('submit');
} 
```

[http://jsfiddle.net/8KNc7/6/](http://jsfiddle.net/8KNc7/6/)

# magento - Magento - what determines home page layout?

> ID：12502958
> 
> 赞同：1
> 
> 时间：2012-09-19T21:11:49.963
> 
> 标签：magento

I have a magento installation. In CMS pages I have two entries with URL keys:

```
home_en
home_page_sp 
```

These seem to govern the entire front page. Each one is for a specific Store View. Both use 3-colums layout

My Question: Where do I look to see which store is attached to which page?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T21:29:03.247

检查设置的配置值

```
System -> Configuration -> Web -> Default Pages -> CMS Home Page 
```

此设置确定 Magento 将为主页加载哪个 CMS 页面。使用左上角的商店切换器来确定在什么级别设置什么值。（下拉的标签是页面标题，但选项值是实际的`home_en`/`home_page_sp`代码）。

# objective-c - Ivars type Nsstring in Obejctive c are nil after button event

> ID：12502959
> 
> 赞同：1
> 
> 时间：2012-09-19T21:11:57.217
> 
> 标签：objective-c, memory-management, setting, ivars

I dont understand this yet. If I create an ivar of a class (no property). I set the ivar directly to for example `@"patrik"` in the `- (void)viewDidLoad` then the ivar value is still there when I click a button and checks for the Ivar value in the handler.

BUT! If I have two buttons. I set the ivar directly in the first button handler that I fire with a click. And then I check the Ivar in the second button handler that i fire. Then the ivar i empty?

Can someone explain what is happining?

Here is the code. Dead simple:

```
- (void)viewDidLoad
{
   Ivar=@"Patrik";      
   [super viewDidLoad];
}

- (IBAction)secondButtonHandler: (id)sender{

   NSString *result=Ivar;

}

- (IBAction)firstButtonHandler: (id)sender{

} 
```

Here the Ivar is still here when I press the second button.

* * *

```
- (void)viewDidLoad
{

   [super viewDidLoad];
}

- (IBAction)secondButtonHandler: (id)sender{

   NSString *result=Ivar;

}

- (IBAction)firstButtonHandler: (id)sender{

   Ivar=@"Patrik";      
} 
```

But here its not after I have pressed the first button and then the second!?

# php - php 如果大于

> ID：12502960
> 
> 赞同：0
> 
> 时间：2012-09-19T21:11:58.543
> 
> 标签：php, if-statement, logic

我遇到了php问题，我只是不明白，

这是我的代码

```
$pieces = explode("|", $result);
if (count($pieces) == 3){
    $size = $pieces[2];
    echo "here";
    if($bw>=$pieces[2]){
        $manfi = $bw - $pieces[2];
        echo "<br>$manfi<br>";
        echo $size;
    }
    else{
        echo "is not big!!!";echo $size."aaa". $bw;
   } 
```

这是输出

> 这里不大！！！183773480 aaa 1000000000000000

我只是想不通，这个数字 1000000000000000 怎么小于 183773480？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T21:16:43.293

问题是数字`1000000000000000`是数据类型字符串。如果然后将其与整数进行比较，它将被转换为整数。由于`1000000000000000`溢出 PHP 使用的 32 位整数，它将变为负值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-19T21:17:20.703

尝试：

```
$bw = intval($bw);
$pieces = array_map(intval, explode("|", $result));
if (count($pieces) == 3){
    $size = $pieces[2];
    echo "here";
    if($bw>=$pieces[2]){
        $manfi = $bw - $pieces[2];
        echo "<br>$manfi<br>";
        echo $size;
    }else{
        echo "is not big!!!";echo $size."aaa". $bw;
    }
} 
```

我更改了 $pieces 以便它包含一个整数数组，并且我还确保 $bw 包含一个整数

# iphone - 在iOS中的经度和纬度谷歌查询中没有得到json响应？

> ID：12502961
> 
> 赞同：2
> 
> 时间：2012-09-19T21:11:59.667
> 
> 标签：iphone, json, google-maps-api-3

我是iOS新手，所以如果有任何帮助，将不胜感激。我正在尝试从地址获取经度和纬度，之前代码工作正常，但现在 JSON 数据为空。

这是我的示例代码，

```
 url = [NSString stringWithFormat:@"http://maps.google.com/maps/api/geocode/json?address=%@&sensor=false",appDelegate.sAddress];

    url=[url stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding];
    NSLog(@"Address URL: %@",url);

    //Formulate the string as a URL object.
    NSURL *requestURL=[NSURL URLWithString:url];
    NSData* data = [NSData dataWithContentsOfURL: requestURL];

    NSString *returnString = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];

    NSLog(@"my Coordinate : %@",returnString);

    NSError* error;
    NSDictionary* json = [NSJSONSerialization 
                          JSONObjectWithData:data
                          options:kNilOptions 
                          error:&error]; 
```

但我得到的输出为空。

所以请帮帮我。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T21:22:07.667

谢谢大家的回复，让我学到了很多。作为我的一位朋友，请告诉我解决方案，所以我与您分享。

这是代码，

```
url = [NSString stringWithFormat:@"http://maps.google.com/maps/api/geocode/json?address=%@&sensor=false",appDelegate.sAddress];

url=[url stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding];
NSLog(@"Address URL: %@",url);

//Formulate the string as a URL object.
NSURL *requestURL=[NSURL URLWithString:url];
NSData* data = [NSData dataWithContentsOfURL: requestURL];

NSString *returnString = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];

SBJSON *parser = [[SBJSON alloc] init];
NSDictionary *locationResult = [parser objectWithString:returnString];
//[reverseGeoString copy]` 
```

它工作正常。

**但是仍然有一个问题是为什么会发生这种情况。如前所述，代码工作正常，但突然停止工作。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T21:29:36.587

您必须在以下实际接收数据的方法中构造您的 returnString：

```
- (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response 
```

查看[这个](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/URLLoadingSystem/Tasks/UsingNSURLConnection.html)以获取有关如何使用 NSURLConnection 和委托方法的更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-19T22:06:54.890

我会说你错过了最重要的“请求”......

这就是我所做的。希望能帮助到你：

```
 NSString *encodedAddress = (__bridge_transfer NSString *) CFURLCreateStringByAddingPercentEscapes(NULL, (__bridge_retained CFStringRef)searchBar.text, NULL, (CFStringRef) @"!*'();:@&=+$,/?%#[]",kCFStringEncodingUTF8 );

    NSString* searchURL = [NSString stringWithFormat:@"http://maps.googleapis.com/maps/api/geocode/json?address=%@&sensor=true",encodedAddress];
    NSError* error = nil;
    NSURLResponse* response = nil;
    NSMutableURLRequest* request = [[NSMutableURLRequest alloc] init];

    NSURL* URL = [NSURL URLWithString:searchURL];
    [request setURL:URL];
    [request setCachePolicy:NSURLRequestReloadIgnoringLocalCacheData];
    [request setTimeoutInterval:30];

    NSData* data = [NSURLConnection sendSynchronousRequest:request returningResponse:&response error:&error];

    if (error){
        NSLog(@"Error performing request %@", searchURL);
        return;
    }

    NSString *jsonString = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];
    if (jsonString!=nil){
        NSLog(@"%@",jsonString);
    } 
```

# java - 表单提交后如何显示消息并且是幂等的

> ID：12502964
> 
> 赞同：0
> 
> 时间：2012-09-19T21:12:23.330
> 
> 标签：java, jsp, servlets, idempotent

当提交向数据库中插入记录并且操作成功的表单时，我会进行重定向，然后在 Url 中传递一些参数以显示新插入的记录以及标题消息（即“插入成功”） .

`response.sendRedirect(yPage + "?pid=" + ipd + "&feedback=" + form.getFormFeebackSB() );`

然后我会在jsp中显示如下： `<c:out value="${param.feedback}" />`

我使用重定向而不是转发，因为我希望操作是幂等的。当我使用`forward`成功插入后点击刷新的用户时，通常总是在警告弹出窗口上单击重试，这会导致重复插入。

然后我们的 IT 部门发现我有一个 XSS 漏洞：

`page.jsp?feedback=%3Cscript%20type=%22text/javascript%22%3Ealert%28%27xss%27%29;%3C/script%3E`

所以我改成这样： `<c:out value="${param.feedback}" escapeXml='true'/>`

但是现在`<br>`我的 FeedbackSB 中的任何内容都被转义了，我最终得到了这样的标题消息

`Insert was successful<br>An email was sent to Joe<br>Now Complete the XYZ Form;`

将消息传递回用户的标准方法是什么，同时保持任何提交幂等并防止 XSS？

# 编辑：

我搜索了 Flash Scope 并遇到了这个[http://blog.smartkey.co.uk/2011/01/implementing-flash-scope-in​​-java](http://blog.smartkey.co.uk/2011/01/implementing-flash-scope-in-java-web-applications/) -web -applications/ 因为我的应用程序需要做很多工作才能合并框架，该链接中提到的过滤器很容易合并，并且能够轻松实现闪存范围。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T21:20:40.653

不要在重定向中传递消息本身。将消息存储在会话中的唯一键下，使用此消息的键作为 URL 参数进行重定向，然后转到会话，获取消息并显示它。

我也会立即从会话中删除消息：如果用户刷新，没有理由再次告诉他插入成功。

大多数 MVC 框架使用它们通常称为 Flash 作用域（一旦检索到它们就从会话中删除的会话属性）为您执行此操作。

# c - C函数：以字符串为参数并打印

> ID：12502966
> 
> 赞同：-1
> 
> 时间：2012-09-19T21:12:36.850
> 
> 标签：c, printf

在学习C的过程中……尝试为一些测试用例创建一个函数；我想要打印出从输入中获取的每个测试用例的名称的东西。只是想消除每个测试用例中的一些 dup 代码，即 `printf("Testing foo); 等。有一个这样调用的函数：outTesting("foo"); 非常基本，但我不熟悉一些这些数据结构中的;帮助表示赞赏。这是我到目前为止所拥有的：

```
void outTesting(const char *c) {
    printf("\n\nTesting %u\n_____________\n\n", (char) *c);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-19T21:14:03.440

使用`%s`：

```
printf("\n\nTesting %s\n_____________\n\n", c); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-19T21:15:11.730

那应该是：

```
printf("\n\nTesting %s\n_____________\n\n", c); 
```

反而？

# mysql - mysql触发变量

> ID：12502967
> 
> 赞同：0
> 
> 时间：2012-09-19T21:12:38.780
> 
> 标签：mysql, sql, triggers

在 MYSQL 中，如何将`fname`表`ftable`中的字段名称分配给触发器查询中的变量？

我知道mysql全局变量：`@@`
局部变量？`@`

但这甚至是正确的语法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T21:17:56.363

您可以从选择中的字段中分配它；如果返回多行，它将获得最后选择的值。

```
SELECT @tmp:=fvalue FROM ftable WHERE ... 
```

这里有一个简单的[SQLfiddle](http://sqlfiddle.com/#!2/25977/1)。

# paypal - 使用 GetAdvancedPersonalData API 获取 PayPal 帐户类型

> ID：12502970
> 
> 赞同：0
> 
> 时间：2012-09-19T21:12:56.347
> 
> 标签：paypal, paypal-adaptive-payments

您好我需要使用某种 API 调用来获取**PayPal帐户类型（个人、专业、商家等）。**我正在研究`GetAdvancedPersonalData`API，但是在文档中我没有将帐户类型视为可以检索的信息。

首先，这可能吗？

如果不是，我有什么选择？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T14:37:34.550

您需要成为专业人士或商家持有人才能使用 API。

如果您是个人账户持有人，您不能授权其他提供商通过 API 访问您的账户

在您的贝宝帐户（沙盒或实时）中，转到“个人资料”>“我的销售偏好”，如果您在那里没有看到 API 链接，则意味着您需要将您的帐户升级为专业人士或商家

# php - facebook 图表发布提要 PHP

> ID：12502971
> 
> 赞同：-1
> 
> 时间：2012-09-19T21:13:02.897
> 
> 标签：php, facebook-graph-api

[使用这个参考](https://developers.facebook.com/docs/reference/php/exception-getType/)我试图简单地发布用户提要。
谁能告诉我为什么这不起作用？

```
require '../src/facebook.php';
$facebook = new Facebook(array(
    'appId'  => '<MY ID>',
    'secret' => '<MY SECRET>'
));

// Get User ID
$user = $facebook->getUser();
$token = $facebook->getAccessToken();

if ($user) {
    try {
        $post_id = $facebook->api('/me/feed', 'POST', array('message'=>'Hello World!'));
        if($post_id)
            echo '1';// nothing echo's
        else
            echo '0';

    } catch (FacebookApiException $e) {
        error_log($e);
        $user = null;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T00:01:02.367

固定`JS`范围

```
function fb_oAuth(){

    FB.login(function(response) {
     if (response.authResponse) {
         console.log('Welcome!  Fetching your information.... ');
         FB.api('/me', function(response) {
             console.log('Good to see you, ' + response.name + '.');
         });
     } else {
         console.log('User cancelled login or did not fully authorize.');
     }
 }, {scope: 'publish_stream'});//< - FIX

} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-19T21:15:53.657

你看到的反应是什么？Facebook应该返回一些东西吗？或者你甚至没有点击 facebook 服务器？

# java - Android：设置为按钮背景的图像没有被缩小？

> ID：12502972
> 
> 赞同：0
> 
> 时间：2012-09-19T21:13:18.720
> 
> 标签：java, android, xml

我通过可绘制对象创建了一个将图像设置为背景的按钮。当我运行程序时，图像没有居中也没有缩小以适合按钮。但是当您单击它时，按下的图像会正确显示。这只是前几天的工作，我不知道发生了什么改变它。

主要的.xml

```
<Button
            android:id="@+id/rightarrow"
            android:layout_width="0dp"
            android:layout_height="fill_parent"
            android:layout_weight="1"
            android:background="@android:color/transparent"
            android:clickable="false" /> 
```

活动.java

```
rightarrow = (Button) findViewById(R.id.rightarrow);
rightarrow.setBackgroundResource(R.drawable.rightarrow_drawable); 
```

rightarrow_drawable.xml

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:drawable="@drawable/rightarrow_pressed" android:state_pressed="true"/>
    <item android:drawable="@drawable/rightarrow" />
</selector> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T21:24:54.867

为什么不在 XML 中设置选择器？您不必通过代码设置它。在 Eclipse 中尝试 Project->Clean - 也许你的资源混在一起了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T21:25:20.387

只需将您的替换`Button`为`ImageView`

# javascript - jQuery Prepend Open Tag Append Closing Tag

> ID：12502983
> 
> 赞同：0
> 
> 时间：2012-09-19T21:14:11.987
> 
> 标签：javascript, jquery, append, prepend

首先，我熟悉 . `wrapAll()`这不是我需要的。我有一些我无法更改的标记，我需要将所有内容包装在`<li>`.

这是我正在尝试做的事情：

```
$('nav[role="breadcrumb"] ul a').wrap('<li></li>');

$('nav[role="breadcrumb"] ul li:last').after('<li>');

$('nav[role="breadcrumb"] ul').append('</li>');
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<nav role="breadcrumb">
  <ul class="clearfix">
    <a href="http://eggaday.armystage.com/">Home</a>
    <a href="http://eggaday.armystage.com/health-care-professionals/">Health Care Professionals</a> Healthy Choices Cholesterol Kits
  </ul>
</nav>
```

问题是 jQuery 关闭了这些`<li>`标签中的每一个。这是原始标记：

```
<nav role="breadcrumb">
  <ul class="clearfix">
    <a href="http://eggaday.armystage.com/">Home</a>
    <a href="http://eggaday.armystage.com/health-care-professionals/">Health Care Professionals</a> Healthy Choices Cholesterol Kits
  </ul>
</nav>
```

如您所见，我在底部有一些松散的文字，`<ul>`我正试图将它包裹在一个`<li>`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T21:22:21.840

`.contents()`将得到所有的孩子，包括文本节点

```
$('nav[role="breadcrumb"] ul').contents().filter(function() {
   return $.trim($(this).text())!=="";
}).wrap('<li/>'); 
```

编辑：添加了过滤器方法来摆脱空白文本节点

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T21:14:45.353

jQuery 只适用于完整的元素，你不能只附加一个结束或开始标签。

如果 ul 没有任何其他列表项，您可以简单地使用 wrapInner

```
$('nav[role="breadcrumb"] ul').wrapInner("<li />"); 
```

如果它确实包含 LI，最简单的方法是将它们分离，包装内部，然后附加它们。

```
var $lis = $('nav[role="breadcrumb"] ul > li').detach();
$('nav[role="breadcrumb"] ul').wrapInner("<li />").prepend($lis); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-19T21:22:01.480

尝试先创建您的 <li> ，然后将您的选择器附加到它：

```
var $li = $('<li>').append('nav[role="breadcrumb"] ul a'); 
```

然后使用 $li 替换或附加您喜欢的任何位置。

# jquery - 填充 单击链接时，单击另一个链接时替换内容

> ID：12502986
> 
> 赞同：2
> 
> 时间：2012-09-19T21:14:22.120
> 
> 标签：jquery

JS新手领先。

简而言之，这就是我想要的：我单击 an`<a>`并且 a`<div>`填充了文本。我单击另一个链接，其中的文本`<div>`被替换并填充了不同的文本。

我有大约 10`<a>`条和 10 条文本。我总是希望新点击的链接替换任何现有内容。

提前致谢...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T21:27:13.483

```
$('#link_1_id').click(function(){
  $('#div_id').text('Content for clicking Link 1');
}); 
```

您应该能够在上述模式中使用链接 ID 到文本的映射来做您想做的事情，或类似的事情

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T21:45:18.497

检查这个[小提琴](http://jsfiddle.net/sushanth009/D4aS9/)

```
$('a').on('click', function(e) {
    $('#divresult').html($(this).text());
    e.preventDefault();
});​ 
```

这会将锚内的文本放入 div

# c++ - 堆栈分配的类发生不需要的析构函数调用 - C++

> ID：12502988
> 
> 赞同：1
> 
> 时间：2012-09-19T21:14:26.497
> 
> 标签：c++, pointers, heap-memory, stack-memory

在 Game 类函数中，我将 Boundary 类分配给堆栈

```
void Game::loadContent()
{
    Boundary b(this, body); 
} 
```

边界类有一个指向主游戏类的指针和一个指向刚体的指针。我不确定是否应该为每个使用参考？由于稍后解释的原因，这里的一些清晰度会有所帮助。

```
class Boundary : public DynamicEntity
{
public:
    Boundary(Game *game, btRigidBody *body);
    ~Boundary(void);

    // Override functions
    virtual void draw(float dt);
    virtual glm::vec3 getPosition();
    virtual void update(float dt);
}; 
```

DynamicEntity 类分配主体并在其析构函数中处理指针删除。

```
class DynamicEntity : public Entity
{
public:
    virtual ~DynamicEntity(void);

    virtual void draw(float dt) = 0;
    btRigidBody* getBody();
    glm::vec3 getPosition() = 0;
    virtual void update(float dt) = 0;

protected:
    explicit DynamicEntity(Game *game, btRigidBody *body);
    btRigidBody *m_body;
}; 
```

# DynamicEntity.cpp 析构函数

```
DynamicEntity::~DynamicEntity(void)
{
    m_game->m_dynamicsWorld->removeRigidBody(m_body);

    delete m_body;
} 
```

DynamicEntity 派生自所有名为 Entity 的游戏对象的基类

# 实体.h

```
class Entity
{
public:
    // Make destructor virtual as this is a base class
    virtual ~Entity(void);

    virtual void draw(float dt) = 0;
    int getID();                                
    virtual glm::vec3 getPosition() = 0;
    virtual void update(float dt) = 0;          

protected:
    explicit Entity(Game *game);                // Abstract base constructor

    Game *m_game;
    int m_id;                                   // Unique ID
}; 
```

我不能在此类的析构函数中对 Game 类指针调用 delete，但这就是为什么我不确定作为指针传递是否是正确的方法（而不是引用）？

```
Entity::~Entity(void)
{
    // Derived class destructors are called first
    delete m_game;  // ERROR
} 
```

Entity 类添加一个指向自身的指针，该指针可以通过 Game 类中的列表访问（对于在主 Game 类中迭代和调用 Entity 函数很有用）。

```
Entity::Entity(Game *game) 
    : m_game(game),                                         // Initialise members
    m_id(m_game->g_idGenerator->generateNewID())            // Generate unique ID                       
{
    m_game->m_entities.push_back(std::shared_ptr<Entity>(this));
} 
```

我遇到的主要问题是，一旦*Game::loadContent()*方法完成，就会为 Entity 类调用析构函数。这会破坏存储在列表中的 *shared_ptr*，并且在尝试调用任何虚拟方法时会发生错误。

我希望边界指针一直存在，直到我说删除。有没有办法在不将边界分配给堆的情况下做到这一点？

# 编辑

回应使用*const& Game的建议*

看来我必须将我的实体标头更改为以下

# 实体.h

```
#pragma once

#include <glm\glm\glm.hpp>

#include "Game.h"

// Forward declarations
class Game;

class Entity
{
public:
    // Make destructor virtual as this is a base class
    virtual ~Entity(void);

    // '= 0' means pure virtual function (like 'abstract' in C#)
    // This means they do not have to be declared in the source file '.cpp'
    virtual void draw(float dt) = 0;
    int getID();                                
    virtual glm::vec3 getPosition() = 0;
    virtual void update(float dt) = 0;          

protected:
    explicit Entity(const Game &game);          // Abstract base constructor

    Game m_game;
    int m_id;                                   // Unique ID
}; 
```

不是`Game m_game`将 Game 类的实例分配给堆栈吗？如果它代表一个引用，它应该如何在标题中声明？

# 编辑 2

如果我在基实体类中存储对 Game 类的受保护引用，`const Game &m_game`我似乎无法访问`g_wireShapeDrawer`派生类中 Game 类的全局成员。

```
class Game
{
public:
    GL_WireShapeDrawer g_wireShapeDrawer;

    Game(void);
    ~Game(void);

    void init();
    void draw(float dt);
    void handleInput(float dt);
    void loadContent();
    void update(float dt);
}; 
```

例如，尝试访问派生 Boundary 类源的 draw 方法中的全局成员时出现以下错误

```
void Boundary::draw(float dt)
{
    m_game.g_wireShapeDrawer.drawPlane(glm::vec3(0, 1, 0), 0.0f, glm::vec4(1, 1, 1, 1));
} 
```

> > 错误 C2662：“GL_WireShapeDrawer::drawPlane”：无法将“this”指针从“const GL_WireShapeDrawer”转换为“GL_WireShapeDrawer &

为什么是这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T21:20:21.357

你的设计有缺陷。您需要清楚地说明（通过您的设计）谁拥有指针。如果`Entity`拥有该指针，那么它应该像您所做的那样在其析构函数中释放它（更好；只需将其包装在 a 中`std::unique_ptr`）。如果它不拥有指针，那么就不要释放它。

你不能同时拥有它。您正在使用 a `shared_ptr`，因此这意味着多个“所有者”，并且一旦最后一个所有者完成了它，内存将被释放。同样，您需要围绕谁拥有此内存进行明确设计。

从您的代码来看，似乎`Entity`并不真正拥有`Game*`. 它出于实现原因需要它，但不应对其释放负责。

* * *

在旁注中，您违反[了三法则](http://en.wikipedia.org/wiki/Rule_of_three_%28C++_programming%29)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-19T21:43:32.967

`Game`永远不要从任何`Entity`类或派生类中删除该对象。在应用程序关闭之前，它应该是最后被释放的东西之一。

您应该将其`Entity`作为`Game&`. 为什么？因为你只有一个 的实例`Game`，所以不需要重置它指向的东西，它应该*总是*有效的（因为游戏将在`Entity`对象之前存在）。

另一种选择是在你的类中实现**单例模式**`Game`，并像这样访问它`Game::GetInstance().m_dynamicsWorld->removeRigidBody(m_body);`

根据您的编辑，您可以`Entity`使用初始化列表创建一个。这样您就可以存储 const 成员，如下所示：

```
class Entity
{
  protected:
    explicit Entity(Game &game) : m_game(game) {}
  private:
    Game& m_game;
} 
```

# javascript - 关键字 - 调试器 | 一个实际的例子

> ID：12502990
> 
> 赞同：1
> 
> 时间：2012-09-19T21:14:28.280
> 
> 标签：javascript

来自[MDN](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/debugger)。

> 调用任何可用的调试功能。如果没有可用的调试功能，则此语句无效。

我在 IE、Safari 和 FF 中调试过，发现不需要这个关键字。它有实际用途吗？有人可以提供一个实际的例子吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T21:39:39.407

打字调试器；进入您的代码会触发与在调试实用程序中设置断点相同的功能。由于在 cms 中使用脚本或其他未知原因，我有各种调试实用程序不显示脚本。然而，脚本仍然停止并允许我检查我使用调试器的变量状态；

这可能是一个实际示例的一部分，但我发现了它的用途。

技术上

```
debugger; 
```

似乎是触发调试实用程序的手动或编码方式，而不是在调试实用程序内设置断点。希望这可以帮助。

# silverlight - 使用 mvvm 登录后从登录页面导航到用户控件

> ID：12502993
> 
> 赞同：0
> 
> 时间：2012-09-19T21:14:41.380
> 
> 标签：silverlight, mvvm, navigation

我有登录页面，并且我有绑定登录按钮到视图模型中的命令。我想从此页面导航到其他用户控件，即主页。

可以使用视图和视图模型之间的绑定来做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T07:53:28.373

这是一个很好的问题。让我们不要忘记您首先使用 MVVM 的原因。MVVM 的好处是您可以将呈现的数据与呈现代码分开。希望通过这样做，您的应用程序更容易测试，并且您可以在其上添加不同的 UI，例如 WinRT，它会工作。

要求是：

1.  你显示一个登录页面，
2.  用户输入他们的凭据，
3.  您导航到应用程序页面。

但是，如果您使用 NavigationService，那么当用户点击后退按钮时，他们将返回您可能不想要的登录页面。

在这种情况下，您最好显示一个覆盖整个应用程序页面的弹出窗口。然后在验证凭据后关闭弹出窗口。

根据您更喜欢 View-First 还是 ViewModel-First，您的结构会有所不同。这是 ViewModel 第一种方法：

```
LogonViewModel logon = new LogonViewModel();

logon.LogonSucceeded += () =>
{
      App.DismissViewFor<LogonViewModel>(logon);
      AppViewModel appViewModel = new AppViewModel();
      App.ShowViewFor<AppViewModel>(appViewModel);
}

App.ShowViewFor<LogonViewModel>(logon); 
```

您可以使用自己的框架来实现 App.DismissViewFor、App.ShowViewFor 或使用像 Caliburn.Micro 这样提供 ViewLocator 的框架。