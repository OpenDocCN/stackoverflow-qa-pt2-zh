# StackOverflow 问答 14762000-14762999

# mysql - MySQL 如何将列的值添加在一起并删除重复的行？

> ID：14762003
> 
> 赞同：4
> 
> 时间：2013-02-07T22:12:09.383
> 
> 标签：mysql, sql

再会，

我有一个 MySQL 表，其中有一些重复的行必须删除，同时将重复行中的一列的值添加到原始表中。

问题是当另一列的值错误时引起的，现在已修复，但它使余额在必须添加在一起的不同行之间分裂。然后必须删除添加的较新行。

在此示例中，用户 ID 列确定它们是否重复（或三次）。用户标识 6 重复，用户标识 3 重复三次。

作为用户 ID 3 的示例，它必须将第 3 行、第 11 行和第 13 行的所有余额相加，并且必须将该总数放入第 3 行，然后删除第 11 和 13 行。这两个列的余额必须一起添加到必须删除原始的较低 ID 行和更新的较高 ID 行。

```
ID | balance | userid
---------------------
1  | 10      | 1
2  | 15      | 2
3  | 300     | 3
4  | 80      | 4
5  | 0       | 5
6  | 65      | 6
7  | 178     | 7
8  | 201     | 8
9  | 92      | 9
10 | 0       | 10
11 | 140     | 3
12 | 46      | 6
13 | 30      | 3 
```

我希望这足够清楚，并且我提供了足够的信息。谢谢 =)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T22:17:28.067

```
SELECT SUM(balance)
FROM your_table
GROUP BY userid 
```

应该可以，但是说修复表格的评论确实是最好的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T22:34:54.890

两步。

**1.更新：**

```
 UPDATE 
        tableX AS t
      JOIN
        ( SELECT userid
               , MIN(id) AS min_id
               , SUM(balance) AS sum_balance
          FROM tableX
          GROUP BY userid
        ) AS c
        ON  t.userid = c.userid
    SET
        t.balance = CASE WHEN t.id = c.min_id 
                        THEN c.sum_balance
                        ELSE 0 
                    END ; 
```

**2\. 删除多余的行：**

```
 DELETE t
    FROM
        tableX AS t
      JOIN
        ( SELECT userid
               , MIN(id) AS min_id
          FROM tableX
          GROUP BY userid
        ) AS c
        ON  t.userid = c.userid
        AND t.id > c.min_id
    WHERE
        t.balance = 0 ; 
```

* * *

一旦你解决了这个问题，最好添加一个`UNIQUE`约束，`userid`因为你似乎想在这里为每个用户存储余额。这将避免将来出现任何重复。您还可以删除（无用的？）`id`列。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T22:31:13.720

您可以创建具有相同结构的表并使用此查询将数据传输到该表

```
insert into newPriceTable(id, userid, balance)
    select u.id, p.userid, sum(balance) as summation 
    from price p
    join (
        select userid, min(id) as id from price group by userid
    ) u ON p.userid = u.userid
    group by p.userid 
```

在这里玩查询：[http ://sqlfiddle.com/#!2/4bb58/2](http://sqlfiddle.com/#!2/4bb58/2)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-07T22:31:17.860

工作主要在 MSSQL 中完成，但您应该能够转换语法。

使用 GROUP BY UserID，您可以 SUM() 余额，将其加入主表以更新所有重复项的余额。最后，您可以使用 RANK() 对重复的用户 ID 进行排序并仅保留最早的值。

我会将所有这些选择到一个新表中，如果它看起来不错，请弃用您的旧表并重命名然后重新命名。

[http://sqlfiddle.com/#!3/068ee/2](http://sqlfiddle.com/#!3/068ee/2)

# windows-8 - 指南针和倾角仪没有读数

> ID：14762011
> 
> 赞同：0
> 
> 时间：2013-02-07T22:12:25.970
> 
> 标签：windows-8, windows-runtime

我有一台三星 700T ATIV Smart PC Pro 平板电脑，我尝试使用基本的 Windows Store 应用程序模板访问不同的传感器来测试一些东西。我使用了这里的示例：http: [//msdn.microsoft.com/en-us/library/windows/apps/xaml/hh465294.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/hh465294.aspx)

到目前为止，我能够从加速度计和陀螺仪获取数据。

然而，倾角计和指南针没有给我任何数据。我可以使用 Compass.GetDefault(); 很好地实例化它们（它们不为空）；和测斜仪.GetDefault();。“阅读”事件处理程序没有被调用。

我也尝试了 SDK 中的倾斜计和指南针示例。结果相同，没有读数。

根据三星更新程序工具，平板电脑应该是最新的。

有没有其他方法可以检查这些传感器是否已启用并正常工作？

任何帮助是极大的赞赏。

**更新1：**

使用 Windows 驱动程序工具包 ( [Link](http://msdn.microsoft.com/en-us/library/windows/hardware/gg487428.aspx) ) 中的传感器诊断工具，我可以获得更多信息（它位于 prog.files\Windows Kits\8.0\Tools\）。

我从罗盘传感器获得 X、Y 和 Z 值的读数，但“磁北度数”始终为 VT_NULL。由于运行时 API 只给我 HeadingMagneticNorth 和 HeadingTrueNorth 而不是原始值，这可能是问题的根源。[截屏](http://i.imgur.com/k0LT1EP.png)

*现在因为似乎有一个工作指南针，我想知道问题可能是什么。驱动相关？*

对于倾斜器，我使用传感器诊断工具根本没有得到任何读数。X、Y 和 Z 值为 VT_NULL。[截屏](http://i.imgur.com/e7JNQSG.png)

还有其他三星 Win8 平板电脑用户愿意测试吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T22:17:16.690

两个传感器现在都可以工作并提供预期值。

解决方案是移动到房子的不同位置，并在每个轴上旋转数次平板电脑。这导致重新校准传感器。

传感器可能被强磁干扰分散注意力，导致无法正确校准。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T01:01:29.733

您可能还需要设置报告间隔属性。

# derbyjs - 如何在生成的 html 中添加换行符

> ID：14762015
> 
> 赞同：0
> 
> 时间：2013-02-07T22:12:36.333
> 
> 标签：derbyjs

我从`derby new first-project`. 因此，生成的 html 的主体被写在一行中。我怎样才能关闭这种行为以获得漂亮的打印 html 以便能够追踪像这样的错误`Uncaught SyntaxError: Unexpected token <`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T05:03:25.167

如果您的问题确实是单行 html，那么您的答案是 x-no-minify: [http://derbyjs.com/#whitespace_and_html_conformance](http://derbyjs.com/#whitespace_and_html_conformance)。

但是，我认为您的问题只是 derby 入门项目生成器和示例已经过时了。使用[derby-boilerplate 项目](https://github.com/codeparty/derby/wiki/Using-Derby-%22Edge%22)

# c# - 用户输入的文本框中的会话数据

> ID：14762020
> 
> 赞同：1
> 
> 时间：2013-02-07T22:12:56.357
> 
> 标签：c#, asp.net, visual-studio-2010

我有这个项目，我想从其上`textbox1`的会话“sam”传输数据。问题是当我输入一个数字时，它没有显示在. 我的问题是我在“Αριθμός Επιβατών:”上输入了一些东西（例如一个数字），然后我点击提交我需要在“Ari8mos epivatwn:”旁边的关于页面上获取数字`about.aspx``label``label``textbox`

默认aspxcs.txt：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

namespace WebApplication4
{
    public partial class _Default : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {

        }

        protected void Button1_Click2(object sender, EventArgs e)
        {
            string txt = TextBox1.Text;
            Session["sam"] = txt;
        }
    }
} 
```

关于aspxcs.txt：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

namespace WebApplication4
{
    public partial class About : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            Label1.Text = (string)Session["sam"];
        }
    }
} 
```

关于aspx.txt：

```
<%@ Page Title="About Us" Language="C#" MasterPageFile="~/Site.master"  AutoEventWireup="true"
CodeBehind="About.aspx.cs" Inherits="WebApplication4.About" %>

<asp:Content ID="HeaderContent" runat="server" ContentPlaceHolderID="HeadContent">
</asp:Content>
<asp:Content ID="BodyContent" runat="server" ContentPlaceHolderID="MainContent">
<p>
    Ari8mos epivatwn :
    <asp:Label ID="Label1" runat="server" Text="Label"></asp:Label>
</p>
</asp:Content> 
```

[https://www.dropbox.com/sh/4ftlddfhqo8n99p/gm-TNvol0S](https://www.dropbox.com/sh/4ftlddfhqo8n99p/gm-TNvol0S)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T22:54:00.497

Label 的内容很可能被写入了两次，而不是按照您期望的顺序。

首先熟悉[asp.net 页面生命周期](http://msdn.microsoft.com/en-us/library/ms178472%28v=vs.100%29.aspx)

你会注意到`PageLoad`很久以前就被调用了`Render`。

因此，页面加载如下：

1.  `PageLoad`标签文本设置为代码中的某个数字
2.  一堆其他的东西
3.  `Render`而是将标签文本设置为“标签”，因为这是您在 chtml 中定义的。

查看这部分代码：

```
...
<asp:Label ID="Label1" runat="server" Text="Label"></asp:Label>
... 
```

试试这个：

```
...
<asp:Label ID="Label1" runat="server"></asp:Label>
... 
```

# assembly - x86 组装短和长尺寸

> ID：14762023
> 
> 赞同：0
> 
> 时间：2013-02-07T22:13:05.107
> 
> 标签：assembly, x86, gnu-assembler

我正在编写一个小 x86 程序，我对“类型”大小感到惊讶。

.short 正在处理 4 个字节的值，例如 .short 0xFFFF 和 .long 8 个字节，而 .bytes 正在处理 2 个字节。

我找不到解释，我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T22:15:48.883

0xFFFF 是两个字节，而不是四个。一个十六进制数字是四位（一个 nybble），一个字节中有八位。

# ruby-on-rails - （设计）更新时需要密码，即使它留空

> ID：14762028
> 
> 赞同：1
> 
> 时间：2013-02-07T22:13:29.357
> 
> 标签：ruby-on-rails, ruby, devise

我的用户模型无法保存，因为密码和密码确认不能为空。这发生在：

*   在 edit_user_registration 上更新用户并将密码和密码确认留空。这是我第一次注意到的地方
*   在控制台上，在加载对象并调用 save 之后立即。

如果 password_required，设计将验证密码的存在？

```
 validates_presence_of     :password, :if => :password_required?

  def password_required?
    !persisted? || !password.nil? || !password_confirmation.nil?
  end 
```

这是我的 Rails 控制台输出：

```
 Loading development environment (Rails 3.2.11)
  1.9.3p374 :001 > u = User.last
    User Load (1.0ms)  SELECT "users".* FROM "users" ORDER BY "users"."id" DESC LIMIT 1
   => #<User id: 9, name: "Name", email: "name@example.com", encrypted_password: "$2a$10$oCL2K0nEa8LxaMGuC1oyNOuwIHk8l/IOW.AylGcWTYj3...", reset_password_token: nil, reset_password_sent_at: nil, remember_created_at: nil, sign_in_count: 2, current_sign_in_at: "2013-02-06 20:56:14", last_sign_in_at: "2013-02-06 20:52:01", current_sign_in_ip: "127.0.0.1", last_sign_in_ip: "127.0.0.1", confirmation_token: nil, confirmed_at: "2013-02-07 22:04:01", confirmation_sent_at: "2013-02-07 22:03:25", unconfirmed_email: nil, authentication_token: nil, created_at: "2013-02-06 20:52:00", updated_at: "2013-02-07 22:04:31"> 
  1.9.3p374 :002 > u.save
     (0.2ms)  BEGIN
     (0.2ms)  ROLLBACK
   => false 
  1.9.3p374 :003 > u.errors
   => #<ActiveModel::Errors:0x007f832c04f090 @base=#<User id: 9, name: "Name", email: "name@example.com", encrypted_password: "$2a$10$oCL2K0nEa8LxaMGuC1oyNOuwIHk8l/IOW.AylGcWTYj3...", reset_password_token: nil, reset_password_sent_at: nil, remember_created_at: nil, sign_in_count: 2, current_sign_in_at: "2013-02-06 20:56:14", last_sign_in_at: "2013-02-06 20:52:01", current_sign_in_ip: "127.0.0.1", last_sign_in_ip: "127.0.0.1", confirmation_token: nil, confirmed_at: "2013-02-07 22:04:01", confirmation_sent_at: "2013-02-07 22:03:25", unconfirmed_email: nil, authentication_token: nil, created_at: "2013-02-06 20:52:00", updated_at: "2013-02-07 22:04:31">, @messages={:password=>["can't be blank"], :password_confirmation=>["can't be blank"]}> 
  1.9.3p374 :004 > !u.persisted? || !u.password.nil? || !u.password_confirmation.nil?
   => false 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T15:31:49.877

感谢@rainkinz，我回到了基础（用户模型）并仔细研究了。我发现我正在导入的一个模块正在添加一个额外的

```
validates :email, :password, :password_confirmation, presence: true 
```

我可以通过在控制台中运行看到这一点：

```
User.validators

 ...
 #<ActiveModel::Validations::PresenceValidator:0x007fb80fbcd260
   @attributes=[:email, :password, :password_confirmation],
   @options={}>,
 ... 
```

这与设计中的验证不同，其中包含：

```
@options={:if=>:password_required?}>, 
```

删除那些解决了问题。谢谢你的帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-08T05:10:59.323

在您的更新方法中执行此操作。

```
user = User.find_by_id(params[:id])
    unless user.blank?
      if user.update_attributes(params[:user])
        flash[:notice] = "User updated successfully."
        redirect_to "somwhere"
      else
        render :action => 'edit'
      end
    else
      render :action => 'edit'
    end 
```

如果您不想更新旧密码，请在更新之前添加这些行，以便新代码为：

```
 user = User.find_by_id(params[:id])
        unless user.blank?
          params[:user].delete(:password) if params[:user][:password].blank?
          params[:user].delete(:password_confirmation) if params[:user][:password_confirmation].blank?
if user.update_attributes(params[:user])
            flash[:notice] = "User updated successfully."
            redirect_to "somwhere"
          else
            render :action => 'edit'
          end
        else
          render :action => 'edit'
        end 
```

在 user.rb 模型中写这样的东西

```
devise :database_authenticatable, :registerable,
         :recoverable, :rememberable, :trackable, :validatable, :locakable 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-07-22T20:18:56.640

我遇到了类似的问题，但对我有用的解决方案是`super`在做了我想要的之后再次调用 devise 的方法。例如：

```
def password_required?
  return false if some_check?
  super
end 
```

[这个其他答案](https://stackoverflow.com/a/32186236/4812034)的学分让我明白了。

# android - 来自 Android 计费示例的 IabHelper 类的在线文档？

> ID：14762033
> 
> 赞同：1
> 
> 时间：2013-02-07T22:13:48.730
> 
> 标签：android, in-app-purchase, android-billing

Android 的 In-app billing V3 开发人员指南附带一个名为[TrivialDrive](http://developer.android.com/training/in-app-billing/preparing-iab-app.html#GetSample)的示例应用程序。其中有一个名为 IabHelper 的实用程序类，指南建议我们将其导入到我们自己的应用程序中。

我想知道是否有 IabHelper 类的在线文档？我搜索了 d.android.com 但没有找到任何东西。或者我应该只从源文件中提取 Javadocs 吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-08T23:04:19.157

好吧，如果有人关心，我将 JavaDoc 上传到 github：http: [//vibrunazo.github.com/IAPTest01/](http://vibrunazo.github.com/IAPTest01/)

因此，当 IDE 不可用时，您可以将其用作在线参考。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-06T13:16:26.670

我将此用作 IabHelper 的文档：http:
[//developer.android.com/training/in-app-billing/preparing-iab-app.html](http://developer.android.com/training/in-app-billing/preparing-iab-app.html)

...但是您的文档很好！

# github - 使用 ssh-key 无密码推送到 GitHub

> ID：14762034
> 
> 赞同：328
> 
> 时间：2013-02-07T22:13:53.190
> 
> 标签：github, ssh-keys

我生成了一个没有密码的 SSH 密钥对，并将公钥添加到 GitHub。

连接

```
user@dev:/var/www/project# ssh -T git@github.com
Hi User! You've successfully authenticated, but GitHub does not provide shell access. 
```

成功了，当我重命名密钥时，它失败了。

但是当我想推送我的更改时，它仍然会询问我的用户名和密码组合。

有没有没有密码的推送方法？

* * *

## 回答 #1

> 赞同：654
> 
> 时间：2013-02-08T04:46:33.110

如果它要求您输入**用户名**和密码，则您的源远程指向的是 HTTPS URL 而不是 SSH URL。

将其更改为 ssh。

例如，像 Git 这样的 GitHub 项目将有一个 HTTPS URL：

```
https://github.com/<Username>/<Project>.git 
```

和 SSH 之一：

```
git@github.com:<Username>/<Project>.git 
```

你可以做：

```
git remote set-url origin git@github.com:<Username>/<Project>.git 
```

更改 URL。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2018-01-26T18:15:14.357

如果您确实在使用 SSH URL，但在 git 推送时仍被要求输入用户名和密码：

```
git remote set-url origin git@github.com:<Username>/<Project>.git 
```

您应该尝试使用以下方法进行故障排除：

```
ssh -vT git@github.com 
```

下面是一段示例输出：

```
...
debug1: Trying private key: /c/Users/Yuci/.ssh/id_rsa
debug1: Trying private key: /c/Users/Yuci/.ssh/id_dsa
debug1: Trying private key: /c/Users/Yuci/.ssh/id_ecdsa
debug1: Trying private key: /c/Users/Yuci/.ssh/id_ed25519
debug1: No more authentication methods to try.
Permission denied (publickey). 
```

其实我之前已经把公钥加到GitHub了，我本地也有私钥。但是，我的私钥具有不同的名称，称为`/c/Users/Yuci/.ssh/github_rsa`.

根据示例输出，Git 正在尝试`/c/Users/Yuci/.ssh/id_rsa`，而我没有。因此，我可以简单地复制`github_rsa`到`id_rsa`同一目录中。

```
cp /c/Users/Yuci/.ssh/github_rsa /c/Users/Yuci/.ssh/id_rsa 
```

现在当我`ssh -vT git@github.com`再次跑步时，我有：

```
...
debug1: Trying private key: /c/Users/Yuci/.ssh/id_rsa
debug1: Authentication succeeded (publickey).
...
Hi <my username>! You've successfully authenticated, but GitHub does not provide shell access.
... 
```

现在我可以推送到 GitHub 而无需输入用户名和密码 :-)

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2014-10-07T07:05:27.887

此外，对于要点，您似乎必须省略用户名

```
git remote set-url origin git@gist.github.com:<Project code> 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2018-12-24T15:09:13.737

像往常一样，创建一个 SSH 密钥并将公钥粘贴到 GitHub。将私钥添加到 ssh-agent。（我假设这就是你所做的。）

要检查一切是否正确，请使用`ssh -T git@github.com`

接下来别忘了修改远程点如下：

```
git remote set-url origin git@github.com:username/your-repository.git 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2016-05-06T15:02:10.803

您必须使用**SSH**版本，而不是**HTTPS**。从存储库克隆时，复制带有**SSH**版本的链接，因为 SSH 易于使用并解决了所有访问问题。您可以为输入到您的帐户的每个 SSH 设置访问权限（如推送、拉取、克隆等...）

这是一个链接，它说明了为什么我们需要 SSH 以及如何使用它：一步一步

[Git 生成 SSH 密钥](http://www.w3docs.com/snippets/git/how-to-generate-ssh-key-for-git.html)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2021-11-30T12:22:43.310

与提到的其他用户一样，您必须将其从使用 HTTPS 转换为 SSH。我没有看到端到端解决方案的答案。[设置 ssh 密钥](https://docs.github.com/en/authentication/connecting-to-github-with-ssh/adding-a-new-ssh-key-to-your-github-account)后，执行（在本地计算机上）：

```
$ git remote set-url origin git@github.com:username/your_repo.git  # Convert HTTPS -> SSH
$ ssh-add ~/.ssh/id_rsa_github    # add private github ssh key ssh-agent (assuming you have it already running)
$ git push 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-11-19T07:40:09.427

你做的一切都很好，但 git 仍然通过密码询问，这对我有用，在你当前项目的路径中执行下一个突击队：

```
~ ssh-add -K ~/.ssh/id_rsaYourIdRsa 
```

将您的 SSH 私钥添加到 ssh-agent 并将您的密码存储在钥匙串中。如果您使用不同的名称创建了密钥，或者如果您要添加具有不同名称的现有密钥，请将命令中的 id_rsaYourIdRsa 替换为您的**私钥**文件的名称。

* * *

## 回答 #8

> 赞同：-5
> 
> 时间：2017-03-03T20:23:18.757

使用命令行：

输入`ls -al ~/.ssh`以查看是否存在现有的 SSH 密钥。

在终端中显示：没有目录存在

然后生成一个新的 SSH 密钥

第1步。

```
ssh-keygen -t rsa -b 4096 -C "your_email@example.com" 
```

第2步。

```
Enter a file in which to save the key (/Users/you/.ssh/id_rsa): <here is file name and enter the key> 
```

步骤 3。

```
Enter passphrase (empty for no passphrase): [Type a password]

Enter same passphrase again: [Type password again] 
```

# autotools - autoconf 不启用功能...

> ID：14762035
> 
> 赞同：0
> 
> 时间：2013-02-07T22:13:56.533
> 
> 标签：autotools, configure, autoconf

我想在我的 configure.ac 中有一个名为“stdout”的配置选项，这会导致将变量定义为“1”或“0”。这是我放入configure.ac的内容：

```
 AC_ARG_ENABLE([stdout],
   [AS_HELP_STRING([--enable-stdout[=yes/no], --disable-stdout],
     [Enable or disable output to stdout. Default is disabled.])],
   [ if test "x$enableval" = "yes" ; then
       AC_DEFINE([WRITETOSTDOUT],[1],[Enable output to stdout])
     else
       AC_DEFINE([WRITETOSTDOUT],[0],[Disable output to stdout])
     fi ],
   [AC_DEFINE([WRITETOSTDOUT],[0],[Enable output to stdout])]) 
```

我期望的是，当我添加到`configure`选项`--enable-stdout`or时`--enable-stdout=yes`，我得到一个`#define WRITETOSTDOUT 1`，当我添加`--disable-stdout`or时`--enable-stdout=no`，我得到一个`#define WRITETOSTDOUT 0`

它按预期工作，除了**（**`--enable-stdout`不带参数）导致`#define WRITETOSTDOUT 0`

另一个观察结果是，当我键入`configure --enable-std`并按下它时，它会竞争`./configure --enable-stdout=`

如何让简单的启用选项起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T22:36:10.810

秘诀是你应该将你的 shell 变量`enable_`*foo*命名为`--enable-`*foo*或`--disable-`*foo*。所以：

```
AC_ARG_ENABLE([stdout],
 [AS_HELP_STRING([--enable-stdout=yes|no],
                 [Enable or disable output to stdout. Default is disabled.])],
 [enable_stdout="$enableval"],
 [enable_stdout="no"])

 ...
 stdout_val=0
 if test "x$enable_stdout" = "xyes" ; then
   stdout_val=1
 fi
 AC_DEFINE_UNQUOTED([WRITETOSTDOUT],[$stdout_val],[Enable output to stdout]) 
```

[Autotools Mythbuster](http://www.flameeyes.eu/autotools-mythbuster/autoconf/arguments.html)页面有一些这样的例子。

# emacs - 错误的类型参数：stringp，nil 错误

> ID：14762036
> 
> 赞同：9
> 
> 时间：2013-02-07T22:14:01.087
> 
> 标签：emacs, elisp

我需要`update-directory-autoloads`在一个小 el 脚本中使用函数。当我尝试使用作为目录名称的参数调用此函数时，我收到此错误：

`Wrong type argument: stringp, nil.`

调用如下所示： `(update-directory-autoloads "~/test")`

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-08T02:40:50.723

当你得到 时`Wrong type argument: foo, bar.`，你应该`M-: (setq debug-on-error t) RET`然后重现错误以获得回溯。实际上，您可以`debug-on-error`在 .emacs 中进行这样的设置，并且 Emacs 通常保持完全可用。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-07T22:41:24.400

生成自动加载文件的文档很少。您遇到了由于您没有设置变量而出现的问题`generated-autoload-file`。尝试以下操作：

```
(let ((generated-autoload-file "~/test/loaddefs.el"))
  (update-directory-autoloads "~/test")) 
```

将绑定更新为您希望文件`generated-autoloads-file`存在的位置。`loaddefs.el`

# asp.net - SQL 生成 Word 模板

> ID：14762037
> 
> 赞同：1
> 
> 时间：2013-02-07T22:14:02.830
> 
> 标签：asp.net, sql, ms-word, sql-agent-job

我有一个 MS Word 模板 .dot。我想使用 SQL 数据库填写 .dot 文件的书签内的数据并将文档保存在文件服务器上。我最好的选择是什么？SSIS会处理这个吗？请指教。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T22:31:17.767

你*可以*在 SSIS 中做到这一点，但不能没有通过脚本任务编写一些脚本。你对 c# 或 vb 感觉如何？您曾经使用过[Microsoft Office 对象库](http://msdn.microsoft.com/en-us/library/d2tx7z6d%28v=vs.100%29.aspx)吗？

坦率地说，当我盯着这么多脚本的桶时，我通常会跳过 SSIS 并简单地编写一个完整的 c# 应用程序。

# ms-access - 用单引号包裹插入语句 MS Access，设置默认值

> ID：14762041
> 
> 赞同：0
> 
> 时间：2013-02-07T22:14:17.453
> 
> 标签：ms-access

我在 MS Access 中有一个插入语句，它需要用单引号括起来，以便它可以作为字符串传递给另一个表中的列。这是我下面的插入语句

插入员工（EmpName，EmpDepartment）值（'Mike'，NULL）

当我包装时，我在'Mike'周围遇到错误

'插入员工（EmpName，EmpDepartment）值（'Mike'，NULL）'

下面是我用两个主键创建的表

创建表 Employee([OBJECTID] AUTOINCREMENT(1, 1), EmpName Text(10), EmpDepartment Text(50), Primary Key (OBJECTID, EmpName))

如何在自己创建表时将默认值设置为 EmpName 作为 Mike 并将 Null 设置为 EmpDepartment ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T22:27:02.170

您将需要 ADO 使用标准 SQL 模式轻松地为 Access 创建默认值。这将在 VBA 中运行。

```
sSQL = "create table Employee([OBJECTID] AUTOINCREMENT(1, 1), " _
     & "EmpName Text(10) default mike, EmpDepartment Text(50), " _
     & "Primary Key (OBJECTID, EmpName))"
CurrentProject.Connection.Execute sSQL 
```

# java - python中的子进程调用以使用JAVA_OPTS调用java jar文件

> ID：14762048
> 
> 赞同：12
> 
> 时间：2013-02-07T22:14:39.730
> 
> 标签：java, python

示例代码：

```
import subprocess
subprocess.call(['java', '-jar', 'temp.jar']) 
```

如何在上述命令中指定 JAVA_OPTS？当我使用上述命令时，我得到一个'java.lang.OutOfMemoryError：无法创建新的本机线程'，我认为在命令中指定 JAVA_OPTS 可以解决问题。

我确实在 .bashrc 文件中指定了 JAVA_OPTS，但它没有任何效果。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-08T00:31:52.713

你可以这样做，但是在文档中找到如何做到这一点是一种疯狂的追逐。

[`subprocess.call()`文件](http://docs.python.org/2/library/subprocess.html#subprocess.call)说，

> **`subprocess.call(args, *, stdin=None, stdout=None, stderr=None, shell=False)`** 上面显示的参数只是最常见的参数，下面在[常用参数](http://docs.python.org/2/library/subprocess.html#frequently-used-arguments)中进行了描述（因此缩写签名中的符号有点奇怪）。

然后“[常用参数](http://docs.python.org/2/library/subprocess.html#frequently-used-arguments)”部分在描述了一堆其他参数后在最后说：

> 这些选项以及所有其他选项在[`Popen`](http://docs.python.org/2/library/subprocess.html#subprocess.Popen)构造函数文档中进行了更详细的描述。

好吧！该[`Popen`](http://docs.python.org/2/library/subprocess.html#subprocess.Popen)文档给出了完整的签名：

> `class subprocess.Popen(args, bufsize=0, executable=None, stdin=None, stdout=None, stderr=None, preexec_fn=None, close_fds=False, shell=False, cwd=None, env=None, universal_newlines=False, startupinfo=None, creationflags=0)`

`env`是你想要的！但是，如果您只是通过`env={'JAVA_OPTS': 'foo'}`，那么这将覆盖*所有*环境变量，包括诸如 之类的东西`CLASSPATH`，这可能会破坏其他东西。因此，您可能希望使用这样的代码`JAVA_OPTS`为新流程执行添加环境变量，而不是在当前流程中设置它：

```
#!/usr/bin/env python2.7

import os
import subprocess

# Make a copy of the environment    
env = dict(os.environ)
env['JAVA_OPTS'] = 'foo'
subprocess.call(['java', '-jar', 'temp.jar'], env=env) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-07T22:42:07.883

无需使用 JAVA_OPTS - 只需将更多参数传递给`call()`. 例如：

```
import subprocess
subprocess.call(['java', '-jar', 'temp.jar', '-Xmx1024m', '-Xms256m']) 
```

# php - 处理 Codeigniter 查询中的括号

> ID：14762051
> 
> 赞同：5
> 
> 时间：2013-02-07T22:14:43.037
> 
> 标签：php, codeigniter, postgresql, activerecord

我有以下代码块，预计将返回`count`

```
 $sql = "SELECT sum(count) as count 
            FROM multipleowners WHERE owner = ? " . $localityquery;
    $queryarray = array($owner, $locality);
    $query = $this->db->query($sql, $queryarray);
    if ($query->num_rows() > 0)
    {
        $result = $query->row_array();
        $count = $result['count']; 
    } 
```

但是当我尝试打印时，我得到了空值`$count`。

我用过`print_r($this->db->last_query());`，我得到了以下查询，

```
SELECT sum(count) as count FROM multipleowners WHERE owner = 'Davenports Harbour Trustee (2012) Limited' and locality = 'Auckland Central' 
```

当我直接在我的身上执行这个查询时，我`Postgresql` `IDE`得到了`count`as的输出`2`。

这个查询会出现什么问题以及在哪里出错？我怀疑从句中`(`and`)`的存在。`WHERE`我该如何解决 ？

**更新**

当我启用探查器时，我得到了以下查询，

```
SELECT sum(count) as count 
            FROM multipleowners WHERE owner = 'Davenports Harbour Trustee &#40;2012&#41; Limited'  and locality = 'Auckland Central' 
```

所以很明显问题存在于`(`and `)`!!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T01:47:17.810

答对了！！在将变量传递给查询之前，我添加了以下行`$owner`并且它起作用了，

```
$owner = html_entity_decode($owner); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T00:30:57.790

您是否尝试过 select sum(db.[count] as icount，因为在语言中 count 也可能是保留字。所以将该字段括起来或重命名，尽量不要将新输出命名为 count..

# python - 神经网络 octave 实现

> ID：14762054
> 
> 赞同：0
> 
> 时间：2013-02-07T22:15:00.790
> 
> 标签：python, machine-learning, neural-network, octave

谁能给我解释一下：

```
Theta1_grad(:, 1) = Theta1_grad(:, 1) ./ m;

Theta1_grad(:, 2:end) = Theta1_grad(:, 2:end) ./ m + ((lambda/m) * Theta1(:, 2:end)); 
```

我正在用python实现，我不知道Octave，我只是找到了这个神经网络实现，但我不明白这是在做什么。

参考： http: [//feature-space.com/en/document49.pdf](http://feature-space.com/en/document49.pdf) - 第 12 页 (2.5)

## 编辑：

没关系，我认为它试图不修改第一列。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T03:55:07.123

`Theta1_grad(:, 1)`获取矩阵的第一列，`Theta1_grad`然后将此向量的*每个元素除以*`m`

`Theta1_grad(:, 2:end)`获取从第 2 列到最后的矩阵的其余部分（基本上除了第一列之外的所有列）

通常，第一列设置为`1`允许估计模型截距

一般来说，`.`Octave中的算术运算之前的意思是逐个元素的运算，例如，`A * B`是普通的矩阵乘法，但是`A .* B`是逐个元素的乘法

快速阅读[Octave](http://folk.ntnu.no/joern/itgk/refcard-a4.pdf)会对您有所帮助。

**编辑：**

此方程适用于正则化神经网络（以降低过拟合风险）

```
 Theta1_grad(:, 2:end) = Theta1_grad(:, 2:end) ./ m + ((lambda/m) * Theta1(:, 2:end)); 
```

我没有看到完整的代码，但我相信 lambda*不是*学习率，它是正则化参数（或惩罚），它`Theta1`自身相乘而*不是*梯度。

# javascript - 使用 Enter 键提交表单

> ID：14762055
> 
> 赞同：1
> 
> 时间：2013-02-07T22:15:08.180
> 
> 标签：javascript, jquery, html, forms, twitter-bootstrap

我有一个使用 Twitter Bootstrap 在模式窗口中打开的登录表单。Enter 键使窗口关闭而不是提交表单。我尝试使用 javascript 来捕获按键并提交表单，但事件侦听器似乎永远不会触发。我究竟做错了什么？

```
<!-- Modal -->
<div id="loginModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
        <h3 id="loginModalLabel">TTU</h3>
    </div>
            <form class="loginLoginForm form-inline" action="html-email/tt-facstaff" method="post">
        <fieldset class="loginLoginFieldset">
            <div class="modal-body">
                <div class="loginForm">
                    <div class="loginMessage"></div>
                    <div class="loginLogin">
                        <legend class="loginLegend">Login</legend>
                        <label class="loginUsernameLabel">
                            <div class="input-append">
                                <input class="loginUsername input-medium" type="text" name="username" placeholder="username..." />
                                <span class="add-on"><del>@tntech.edu</del></span>
                            </div>
                        </label>

                        <label class="loginPasswordLabel">
                            <input class="loginPassword input-medium" type="password" name="password" placeholder="password..." />
                        </label>
                        <input class="returnUrl" type="hidden" name="returnUrl" value="/html-email/tt-facstaff" />

                        <input class="loginLoginValue" type="hidden" name="service" value="login" />
                        <label class="checkbox">
                            <input type="checkbox" name="rememberMe"> Remember Me
                        </label>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
                <span class="loginLoginButton"><input id="loginBtn" class="btn btn-primary" type="submit" name="Login" value="Login" /></span>
            </div>
        </fieldset>
    </form>

    <style type="text/css">
        #loginResponse{display:none;}
    </style>

    <script type="text/javascript">
     $("#loginForm *").keypress(function(e){
         e.preventDefault();

         console.log(e);
        if((e.which && e.which == 13) || (e.keyCode && e.keyCode == 13)){
            $("#loginBtn").click();
            return false;
        } else {
            return true;
        }
    });
    </script>
</div> 
```

# java - Java TCP。如何确认你收到的数据包是一个完整的数据结构？

> ID：14762056
> 
> 赞同：0
> 
> 时间：2013-02-07T22:15:12.317
> 
> 标签：java, tcp

我目前有一个在 TCP 套接字上侦听和发送的程序。

我遇到的**问题**是我发送了一个数据包，有时它会分解成碎片。所以我的监听 TCP 套接字类认为进来的第一部分是整个有效载荷。

人们在使用 TCP 连接进行编程时采用的典型方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T22:48:20.283

您不能假设第一部分是整个有效负载。您必须继续阅读套接字，直到获得所有内容。

有两种选择：

**选项 1**
标记消息（数据结构）的结尾。然后，您的听众会继续阅读，直到收到消息结束标记。

**选项 2**
在发送实际数据之前发送消息或数据结构的长度。然后，您的侦听器会继续阅读，直到它读取所有字节。

# tcp - 使用 SNMP 检查打开的 TCP/UDP 端口

> ID：14762057
> 
> 赞同：2
> 
> 时间：2013-02-07T22:15:16.000
> 
> 标签：tcp, udp, snmp, ports

我需要找到一个可以与“snmpwalk”一起使用的 OID，它描述了在我的机器（本地主机）上打开和可用的 TCP/UDP 端口

关于此的类似帖子（[此处](https://stackoverflow.com/questions/3485203/check-ports-with-snmp-net-snmp?answertab=votes#tab-top)）是使用：

snmpwalk -v2c -c 公共本地主机 tcpConnState
snmpwalk -v2c -c 公共本地主机 udpLocalAddress

但据我了解，这现在只显示打开的连接？无论如何，我的实验室因使用这些而被纠正错误。

是否有任何其他 OID 可以显示可用的 TCP/UDP 端口？

（我在 Ubuntu 中使用终端）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T09:10:50.220

干得好！

```
snmpwalk -v2c -c public localhost tcpConnLocalPort
snmpwalk -v2c -c public localhost1.3.6.1.2.1.6.13.1.3

snmpwalk -v2c -c public localhost udpLocalPort
snmpwalk -v2c -c public localhost 1.3.6.1.2.1.7.5.1.2 
```

# python - 使用 Stacks 的 Python Palindrom 程序

> ID：14762058
> 
> 赞同：0
> 
> 时间：2013-02-07T22:15:17.867
> 
> 标签：python, stack, palindrome

我的任务是用 python 编写一个回文程序。我在这里做的

```
def isPalindrome(word):
    for i in range(len(word)//2):
        if word[i] != word[-1-i]:
            return False
    return True

print (isPalindrome("maam")) #returns TRUE
print (isPalindrome("madam")) #returns TRUE
print (isPalindrome("hello")) #returns FALSE
print (isPalindrome("macdam")) #returns FALSE
print (isPalindrome("buffalolaffub")) #returns TRUE
print (isPalindrome("argentina")) #returns FALSE 
```

现在我的导师希望使用`Stack`s 转换它。有人可以帮忙吗？

这是`Stack`我拥有的数据结构：

```
class Stack:

    def __init__(self):
        self.items = []

    def isEmpty(self):
        return self.items == []

    def push(self, item):
        self.items.append(item)

    def pop(self):
        return self.items.pop()

    def peek(self):
        return self.items[len(self.items)-1]

    def size(self):
        return len(self.items) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T00:05:08.343

鉴于：

```
tests=["maam", "madam","hello","macdam","buffalolaffub","argentina"] 
```

惯用的 Python 检查字符串是否为回文将是这样的：

```
word==word[::-1]   # True or False 
```

所以你可以像这样打印一个回文列表：

```
print [word for word in tests if word==word[::-1]] 
```

要使用堆栈执行此操作，您需要将字符串转换为列表，然后您可以使用 Python 列表/堆栈操作。这是一个小演示：

```
def stack_cmp(s1,s2):
    l1=list(s1)
    l2=list(s2)
    if len(l1)!=len(l2): return False
    while True:
        try:
            if l1.pop()!=l2.pop(): return False
        except IndexError:
            return True  

print [word for word in tests if stack_cmp(word, word[::-1])] 
```

另一个版本`stack_cmp`不使用异常：

```
def stack_cmp(s1,s2):
    l1=list(s1)
    l2=list(s2)
    while l1 and l2:
        if l1.pop()!=l2.pop(): return False
    if l1 or l2: return False
    return True 
```

然后以这种方式工作：

```
>>> stack_cmp('mmmm','mmmm')
True
>>> stack_cmp('mmmm','mmmmm')
False 
```

您的老师可能会反对使用切片来反转列表；即，`revered_list=orig_list[::-1]`。如果是这种情况，您可以使用以下方法：

```
reversed_list=[]
orig_list_copy=orig_list[:]
while orig_list_copy:
    reversed_list.append(orig_list_copy.pop())    # this reverses the list 
```

这可以用作带有回文检查器的 Stack 类：

```
class Stack(object):
    def __init__(self,items):
        self.items=[]
        for e in items:
            self.push(e)

    def push(self,item):
        self.items.append(item)

    def pop(self):
        return self.items.pop()

    def __repr__(self):
        return str(self.items)  

    def isPalindrome(self):
        tr=Stack([])
        t=Stack(self.items)
        while t.items:
            tr.push(t.pop())
        t=Stack(self.items)    
        while t.items and tr.items:
            c1=t.pop()
            c2=tr.pop()
            print c1,c2
            if c1!=c2: return False
        return True 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T22:36:27.863

好吧，既然堆栈是先进后出的，他们自然会颠倒事情。您可以遍历字符串，推动前半部分，然后弹出并比较后半部分。

# python - 在 django 教程中找不到页面 (404)

> ID：14762060
> 
> 赞同：1
> 
> 时间：2013-02-07T22:15:26.310
> 
> 标签：python, django

我正在通过[https://docs.djangoproject.com/en/1.4/intro/tutorial02/](https://docs.djangoproject.com/en/1.4/intro/tutorial02/)工作。

将 urls.py 更改为

```
from django.conf.urls import patterns, include, url

# Uncomment the next two lines to enable the admin:
from django.contrib import admin
admin.autodiscover()

urlpatterns = patterns('',
    # Examples:
    # url(r'^$', 'mysite.views.home', name='home'),
    # url(r'^mysite/', include('mysite.foo.urls')),

    # Uncomment the admin/doc line below to enable admin documentation:
    # url(r'^admin/doc/', include('django.contrib.admindocs.urls')),

    # Uncomment the next line to enable the admin:
      url(r'^admin/', include(admin.site.urls)),
) 
```

当我启动运行服务器时，我得到以下信息：

```
404 error

Using the URLconf defined in mysite.urls, Django tried these URL patterns, in this order:
^admin/
The current URL, , didn't match any of these. 
```

有什么明显的我做错了吗？

提前致谢，

账单

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T22:18:28.160

您没有定义基本网址。你需要类似的东西 -

```
urlpatterns = patterns('',

    # ...
    url(r'^$', HomeView.as_view())

) 
```

您应该能够在 - localhost:8000/admin/ 看到您的站点（假设您正在运行您的开发服务器`python manage.py runserver`）。

Django 检查您在 url conf 文件中定义的所有 URL，并查找与您在浏览器中输入的 url 匹配的 URL。如果它找到一个匹配的 URL，那么它会提供由 url 的相应视图返回的 http 响应（`HomeView`在上面的代码中）。urls.py 文件将 url 与视图匹配。视图返回 http 响应。

查看您收到的错误消息（以及您从`url.py`文件中包含的代码），您可以看到您的应用程序中只定义了一个 url - `admin/`. 尝试在任何其他 url 获取页面将失败。

有关更多信息，请[查看 django 的 URL Dispatcher 的文档](https://docs.djangoproject.com/en/1.4/topics/http/urls/)。

# html - -webkit-transition 期间伪元素的 z-index 变化：不透明度

> ID：14762061
> 
> 赞同：1
> 
> 时间：2013-02-07T22:15:28.087
> 
> 标签：html, css, webkit, z-index, css-transitions

我正在使用 -webkit-transition 为具有绝对定位的伪元素的元素的不透明度设置动画。麻烦的是伪元素应该出现在元素的后面，但在过渡期间它出现在前面。您可以[在这里看到它的实际效果](http://tinker.io/c4977/20)。我该怎么做才能把它放在后面？

# css - 如何在样式标签中添加嵌入的 ruby

> ID：14762062
> 
> 赞同：2
> 
> 时间：2013-02-07T22:15:27.667
> 
> 标签：css, ruby, embedded-ruby

我想动态定义状态栏的宽度。

首先我定义变量：

```
<% target = (clicks/total_clicks)*100 %> 
```

然后我尝试将 ruby​​ 代码嵌入到 css 宽度标签中：

```
<div class="bar" style="width: <%= target %>%"> 
```

但是，html 输出看起来像这样

```
<div class="progress progress-striped">
<div class="bar" style="width: 0%"></div>
</div> 
```

我试图将目标变量转换为字符串：

```
<% target = ((clicks/total_clicks)*100).to_s %> 
```

我显然也尝试分配一个非动态值：

```
<% target = 40.to_s %> 
```

但没有成功。

如何将 ruby​​ var 嵌入到 CSS 样式标签中？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T22:40:45.183

由于您使用数字的方式，您得到 0。您正在使用`Integers`. 做这个：

`<%= target = (Float(10)/Float(20))/100 %>`

使用浮点数将允许您获得正在使用的百分比。当您使用整数时，它通常会将数字四舍五入。希望这可以帮助。

编辑：

您也可以使用该`.to_f`方法，而不是`Float`

# ruby - 安装指南针成功，但无法访问

> ID：14762064
> 
> 赞同：1
> 
> 时间：2013-02-07T22:15:38.217
> 
> 标签：ruby, gem

（这里是红宝石的新手）

我正在运行`CrunchBang Linux statler`。

我已经卸载并重新安装`compass`了几次，只是为了确保。

这就是我所做的：

```
» gem query

*** LOCAL GEMS ***

chunky_png (1.2.7)
fssm (0.2.10)
sass (3.2.5) 
```

接着：

```
» sudo gem install compass
Successfully installed compass-0.12.2
1 gem installed
Installing ri documentation for compass-0.12.2...
Installing RDoc documentation for compass-0.12.2... 
```

让我们检查：

```
» gem query

*** LOCAL GEMS ***

chunky_png (1.2.7)
compass (0.12.2)
fssm (0.2.10)
sass (3.2.5) 
```

和：

```
» gem which compass
/var/lib/gems/1.8/gems/compass-0.12.2/lib/compass.rb 
```

但：

```
» compass
-bash: compass: command not found 
```

那么，我做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-06-25T04:19:26.393

如果您正在使用`rbenv`，请运行`$ rbenv rehash`.

每当您安装包含可执行文件的 gem（通常是`.../bin/<someExecutable>`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-12T15:13:36.997

它似乎`gem`在 Ubuntu 中被破坏了。需要以下内容：

```
PATH=/var/lib/gems/1.8/bin:$PATH 
```

# php - 插入数组值，多行

> ID：14762066
> 
> 赞同：1
> 
> 时间：2013-02-07T22:15:46.357
> 
> 标签：php, mysql

我正在尝试在数据库中记录一些信息。我的帖子是这样的：

```
 Array
(
[Action] => 1000

[Date_Stat] => 07/02/2013
[Date_Final] => 07/02/2013
[Product_Id] => Array
    (
        [0] => 2
        [1] => 6
        [2] => 1
    )

[Conversion] => Array
    (
        [0] => 1,20
        [1] => 1,00
        [2] => 2,03
    )

[ValueMin] => Array
    (
        [0] => 2,00
        [1] => 1,58
        [2] => 2,70
    )

[ValueMax] => Array
    (
        [0] => 2,50
        [1] => 1,98
        [2] => 2,90
    )

[ValueMedio] => Array
    (
        [0] => 2,20
        [1] => 1,68
        [2] => 2,80
    )

  ) 
```

如何以正确的方式将所有这些插入数据库？

我不确定设计表格和存储信息的最佳方式。我用它来制作一个包含开始日期、最终日期的价格表，并列出所有产品的价格。

我也在想什么是最好的方法。我认为有两种可能性

```
Date_Start | Date_End   |Product_Id | ValueMin | ValueMax | ValueMedio | Conversion
02-02-2013   02-03-2013  1            1.00       2.00       3.00         4.00
02-02-2013   02-03-2013  2            1.00       2.00       3.00         4.20
02-02-2013   02-03-2013  3            1.00       2.00       2.00         4.40 
```

或（使用 implode 并将所有值放在同一行）

```
Date_Start  | Date_End   |Product_Id | ValueMin | ValueMax | ValueMedio | Conversion
02-02-2013    02-03-2013  1,2,3        1,1,1      2, 2,2     3,3,2        4, 4.3, 4.4 
```

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T22:23:45.563

选择首先提到的选项。如果你这样做，选择行会变得容易得多。

要插入记录，请使用简单的准备好的语句（[PHP 手册](http://www.php.net/manual/en/mysqli.quickstart.prepared-statements.php)）并使用 for 循环。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T22:28:51.450

我建议对第一个选项进行一些调整。如果您创建一个单独的表（类似于“价格”的内容），如下所示：

```
id|DateStart|DateEnd|
1|02-02-2013|02-02-2013| 
```

然后，在您建议的表中，您将替换 PriceId 的日期范围（此表的外键）。这样，您就可以更轻松地保持日期范围更改的一致性。

# xaml - WinRT 和 XAML - 资源文件，但语言不是本地化？

> ID：14762067
> 
> 赞同：4
> 
> 时间：2013-02-07T22:15:47.200
> 
> 标签：xaml, localization, windows-runtime

粗略地，阅读 Windows 商店应用程序的本地化和 Visual Studio 2012 C# 和 XAML 指向我这里：http: [//msdn.microsoft.com/en-us/library/windows/apps/xaml/Hh965329.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/Hh965329.aspx)

这显示了如何为 en-US 和 fr-FR（美国英语和法国法语）创建资源文件。向您展示如何使用资源加载器来加载它。这很好，并使用 Xaml 页面中的 UID 自动加载它。

但是，我的困惑来自于我想创建一个西班牙语资源文件。但我想让它用于任何西班牙语本地化。如果我为 mx-ES 设置它，如果本地化是秘鲁西班牙语的 pe-Es 或西班牙西班牙语的 es-ES，会发生什么。基本上，我对如何使 1 个资源适用于所有英语或所有法语或所有西班牙语而不受国家/地区的约束并且不必为每个国家/语言组合制作单独的资源文件有点困惑。

我认为这将是一个简单的问题，但我还没有看到有人问过这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T01:00:00.500

只使用文化的语言代码，所以 ES 而不是 es-ES。

# linux - 初始化脚本不会“停止”分叉的 C 程序

> ID：14762074
> 
> 赞同：0
> 
> 时间：2013-02-07T22:16:04.563
> 
> 标签：linux, init, raspbian

我有一个 C 程序，它有一个“守护进程”模式，这样我就可以让它在后台运行。当它使用“-d”运行时，它使用以下代码进行分叉：

```
if(daemon_mode == 1)
{
    int i = fork();
    if(i<0) exit(1); // error
    if(i>0) exit(0); // parent
} 
```

我创建了一个初始化脚本，当我手动运行初始化脚本来启动我的守护进程时，它启动正常，但是，如果我用“停止”运行它，守护进程不会停止。

我想问题是由于分叉导致PID发生了变化，我没有错，我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T22:22:15.703

如果您使用 pid 文件来控制进程，那么您很可能正确地认为更改 pid 会导致问题。只需在守护进程之后而不是之前编写 pid 文件。

# jquery - jquery cfajaxproxy fullcalendar 传递开始和结束日期

> ID：14762076
> 
> 赞同：2
> 
> 时间：2013-02-07T22:16:14.890
> 
> 标签：jquery, coldfusion, fullcalendar, cfc, cfajaxproxy

我使用的是 FullCalendar (1.5.2)、jQuery (1.8.1)，但使用的是较旧的 ColdFusion 8。

我遇到的问题是如何正确地将当前日历月的开始和结束日期传递给使用代理的 cfc。

日历显示，但是 json 结果不显示。我怀疑这是如何将开始日期和结束日期传递给代理条目。

这是代码片段。

```
<cfajaxproxy cfc="xxx.ScheduleEvents" jsclassname = "schEvents">
<script type="text/javascript">
  var date = new Date();
  var d = date.getDate();
  var m = date.getMonth();
  var y = date.getFullYear();
  var jEvents = new schEvents();

  jQuery('#calendar').fullCalendar({
    header:  {
        left:  'prev,next today',
        center:  'title',
        right:  'month, basicWeek, basicDay'
     },
     editable:  true,
     events:  jEvents.getEvents()
      });
   });
</script> 
```

我已经测试了该函数，它使用 cfinvoke 和 createobject 工作，以正确的 json 格式返回正确的信息以用于 fullcalendar。我唯一的问题是在这方面如何将 start 和 end 传递给 cfc。我是把它作为参数放在 () 中的 getEvents 还是什么？

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T01:11:35.760

我没有使用 cfajaxproxy，但是当您序列化为 JSON 时，您需要注意区分大小写。

```
<cfset event.id = 4 />
<cfset event["title"] = "something" /> 
```

一旦它被序列化为 JSON，它就变成了 event.ID 和 event.title，即在结构上使用点表示法，所有的键最终都是大写的。

我当然记得在使用该插件时遇到过这个问题，并且我还记得必须将 javaCast 某些内容转换为 int，但我不知道该插件是否仍然如此。

# c++ - 有 C++11 到 C++03 的转换器吗？

> ID：14762078
> 
> 赞同：8
> 
> 时间：2013-02-07T22:16:15.797
> 
> 标签：c++, c++11, converter, c++03

是否有这样的工具能够将使用某些 C++11 功能的代码转换为与 C++03 兼容的代码（可能使用一些第三方库，如 Boost）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-07T22:51:24.477

因为没有人给出实际答案，所以答案是“否”。只需升级您的工具链。无论如何，有很多充分的理由这样做。

对于 Ubuntu 和其他 Linux 变体，如果您想在非常旧的系统上使用新的工具链，您甚至可以下载源代码形式的包并为您的旧系统编译它。当然，如果您随后使用它发布程序，则必须`libstdc++`静态链接或将共享库与您的程序一起发布。

任何人都不太可能编写转换器，因为升级工具链非常容易。这将是一个有趣（而且相当复杂）的爱好项目。也许有一天有人会写一个 C++11 编译器而不是编译成 C99。:-) 那可能会容易得多。

# stackmob - 有没有办法让 LIKE 运算符对 stackmob 中的数据进行操作

> ID：14762081
> 
> 赞同：1
> 
> 时间：2013-02-07T22:16:37.937
> 
> 标签：stackmob

我在用户列表上有一个搜索用例。在这种情况下如何使用 Stackmob？我不认为我可以使用 IN ，有什么建议吗？如何从用户模式中检索所有具有相似名称的用户，如 JOHN 或 JOHNSON。StackMob 是否在字段上提供 SQL 中的 LIKE 类型的运算符？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T10:53:14.340

完全披露，我在 StackMob 工作......

IN 运算符是目前您的最佳选择，但我们正在考虑在不久的将来添加全文搜索。我们不公开 LIKE 或 REGEX 查询的原因是它们的性能不是很好，并且通常会导致完整的集合/表扫描。在这种情况下，并且只想提供可扩展的服务，我们正在寻找更强大的解决方案，例如全文搜索。

# c# - 使用正则表达式删除 C# 中的空 Html 属性

> ID：14762082
> 
> 赞同：1
> 
> 时间：2013-02-07T22:16:42.347
> 
> 标签：c#, html, regex

我有一些像下面这样的html：

```
<img src="/web/20110208042711im_/http://coralifeaqualight.com/wp-content/themes/xtheme/images/coralife-aqualight-pro.png" alt=""> 
```

我想要做的是使用正则表达式来清除任何没有值的html属性，在这种情况下：alt=""。我不知道如何查找任何带有空格并包含 ="" 的字符串，因为那会为我做，有人知道吗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T22:42:54.607

使用 Regex 解析 HTML 通常被认为是一个坏主意，因为有太多的边缘情况。为自己阅读。[http://www.codinghorror.com/blog/2009/11/parsing-html-the-cthulhu-way.html](http://www.codinghorror.com/blog/2009/11/parsing-html-the-cthulhu-way.html)

一个受欢迎的解决方案是[HTML Agility Pack](http://htmlagilitypack.codeplex.com/wikipage?title=Examples)

另请参阅有关在 HTML 中使用 Regex 的 Stackoverflow 问题：[这里](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags/1732454#1732454)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T22:31:55.407

我不是正则表达式天才，但我相信`String.Replace("\s\w+=\"\"", String.Empty)`如果你将整个标签放在一个字符串中，我会这样做。

# macos - CGI 脚本，使用终端 (OS X) 将 `printf` 保存到文件

> ID：14762083
> 
> 赞同：0
> 
> 时间：2013-02-07T22:16:44.063
> 
> 标签：macos, post, terminal, save, printf

我之前问过一个[关于](https://stackoverflow.com/questions/10599535/os-x-post-reciver-server)如何`POST request`使用您自己的本地服务器读取 a 的问题（在 OS X 上）

现在我的问题是我无法保存在我的服务器上收到的 POST 数据。

我目前用于`while true; do nc -l 10000 < /dev/null ; printf '\n\n\n'; done`接收和显示从我的 iOS 设备发送的 POST 消息，它运行良好。

但是我怎样才能保存`printf`输出？

我尝试使用本地`.sh`文件并发送`POST Request`以下代码（没有成功）：

```
#!/bin/sh

printf 'Content-type: text/plain\r\n\r\n'
cat > /MYPATH/post-data
echo OK 
```

我还尝试直接从终端保存文件（也没有成功）：

```
while true; do nc -l 10000 < /dev/null ; printf 'Content-type: text/plain\r\n\r\n' >> /MYPATH/post-data echo OK; done 
```

然而，我在终端中使用的代码实际上创建了`post-data`文件，但只有`Content-type: text/plain`文本，而不是实际的 POST（终端显示了帖子）。

**我今晚**需要这个答案，所以如果你能帮助我解决这个问题，我将不胜感激。

基本综述：我想将`printf`包含 POST 请求数据的文件保存到文件中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T22:37:37.300

我相信你想要这个：

```
while true; do (printf 'Content-type: text/plain\r\n\r\n'; nc -l 10000 < /dev/null) >> /MYPATH/post-data; echo OK; done 
```

不确定您希望内容类型在哪一侧...

# java - 如何使用当前经过 Google App Engine 身份验证的用户从 GAE 发出 http 请求

> ID：14762084
> 
> 赞同：0
> 
> 时间：2013-02-07T22:16:42.643
> 
> 标签：java, google-app-engine, login, oauth-2.0

我在一家大公司工作，该公司在谷歌注册了一个域名。所有用户身份验证均通过 Google 登录页面完成

我有在 GAE 中运行的项目，该项目*（尚未）*在注册域内（*即：[https](https://appengine.google.com/a/MYDOMAIN.COM)* ://appengine.google.com/a/MYDOMAIN.COM ）并且仍然在 apppot（[http://mygreatapp.appspot）上运行。 com](http://mygreatapp.appspot.com) )

为了能够访问我的应用程序，用户**必须**登录我们的域。这是按照 GAE 教程中的建议实现的：（*非常简化的版本，实际上不是真正的代码）*

```
UserService userService = UserServiceFactory.getUserService();
currentUser=userService.getCurrentUser();
if (currentUser==null){   //not yet logged-in, so we redirect to the Google login page
    String url=userService.createLoginURL(thisURL);
    HttpResponse.sendRedirect(url);
}else{
    String myOrg=ApiProxy.getCurrentEnvironment().getAttributes().get("com.google.appengine.api.users.UserService.user_organization");
    if (myOrg!="myOrganization"){
        /* We show an 'unauthorised access page', 
          with a link to the Google logout page */
    {
} 
```

一旦我们获得了经过身份验证的用户，我们还会检查该`com.google.appengine.api.users.UserService.user_organization`属性以确保经过身份验证的用户来自我们的域。

一旦正确通过身份验证，用户可以在某个时候要求应用程序 (GAE) 必须向属于另一个应用程序的服务发出*http 请求，该应用***程序**位于我们的域中，并且**需要**由经过身份验证的用户访问（来自我们的域， 当然）。由于我已经有一个完全有效的用户，我想使用 *it* 来执行 Http 请求。

所以，要清楚，我的问题是：

**如何使用已经通过身份验证的用户调用外部服务？**

* * *

**部分答案**

我想我几乎明白了！

这是我正在做的事情：

用户通过 jsp 页面访问我的应用程序，该页面的行为基本上类似于 servlet（即 HTTPRequest 和 HTTPResponse 可用）。

当未经身份验证的用户完成访问时，他/她将被重定向到谷歌登录页面，这要归功于 `userService.createLoginURL(HttpRequest.getRequestURI());`

感谢 Google 管理身份验证的方式，一旦用户登录，他/她就会自动重定向到我的 jsp 页面。

当服务器收到“来自”jsp 的请求时，我会检查经过身份验证的用户是否属于我的公司（记住“ `com.google.appengine.api.users.UserService.user_organization`”属性..）。如果是真的，我从 HTTPResquest ( `HttpRequest.getCookies()`) 中检索所有的 cookie，查找名为“ **ACSID** ”的那个并存储它。

从那里我应该能够使用此 cookie 在需要对用户进行身份验证的任何 Web 应用程序上进行调用。

但这就是事情出错的地方。

*   当我在本地（在我的电脑上）用检索到的 cookie 对 mygreatapp.appspot.com（例如使用 NetTool）进行 GET 调用时，一切都很顺利。

*   *当我在Eclipse*中本地运行我的应用程序（使用硬编码的 cookie，因为您实际上无法登录）并调用 mygreatapp.appspot.com 时，一切也都很顺利。

*   但是当我将应用程序上传到谷歌并尝试它时，它无法通过身份验证（实际上，我得到一个 302 OK 作为答案，以及一个登录页面的位置标题！）。由于很难调试，我有点卡住了。

任何人都知道什么可能会失败？

## 非常感谢！

最后，我不得不承认我想要实现的目标没有任何解决方案。从某种意义上说，这实际上是一个好消息，因为它证明了谷歌的安全并不是那么容易被破解的！问题已关闭。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T05:43:55.127

您应该查看[Google Accounts 3rd party app authorization](https://developers.google.com/accounts/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T22:19:53.783

也许 App Engine 文档的这一部分是相关的？

[https://developers.google.com/appengine/docs/python/urlfetch/overview#Secure_Data_Connection](https://developers.google.com/appengine/docs/python/urlfetch/overview#Secure_Data_Connection)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-17T20:50:01.927

如果我对您的理解正确，您尝试使用在 Google Apps 域（“域”）下登录的用户的凭据让不在域下运行的 GAE 应用程序（“应用程序 A”）访问 GAE 应用程序（ “app B”）在域下运行，并要求所有使用都在域下进行身份验证。

这是一个糟糕的设计，不应该工作。

我猜你没有让它在 App Engine 上工作的原因是会话 cookie 绑定到特定的 ip-address/range/user-agent

我不太明白您打算如何让应用程序 A 获取用户的会话 cookie，因为 cookie 旨在仅向原始域公开。

显而易见的方法是使用 oauth。

# iphone - 从纵向更改为横向时如何在单元格中调整 UITextView 的大小？

> ID：14762090
> 
> 赞同：1
> 
> 时间：2013-02-07T22:17:05.257
> 
> 标签：iphone, ios, xcode, ios5

我有一个由代码制作的 TextView。

```
CGRect textFrame = CGRectMake(5, 20, 300, 50);

UITextView *textView = [[UITextView alloc] initWithFrame:textFrame]; 
```

问题是，我想在调用横向模式时调整它的大小。

这里有些例子：

[https://docs.google.com/file/d/0BzsX_FHtJa9nSjRVamtFX1pjdlE/edit?usp=sharing](https://docs.google.com/file/d/0BzsX_FHtJa9nSjRVamtFX1pjdlE/edit?usp=sharing)

[https://docs.google.com/file/d/0BzsX_FHtJa9nU0U5T3JvZkgzZWc/edit?usp=sharing](https://docs.google.com/file/d/0BzsX_FHtJa9nU0U5T3JvZkgzZWc/edit?usp=sharing)

谢谢

PS：这仅适用于iPhone。没有 iPad 实施。

编辑：

表视图代码：

```
tableProducts.dataSource = self;
tableProducts.delegate = self;
tableProducts.bounces = YES; 
```

单元格代码：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

static NSString *CellIdentifier = @"Cell";

UITableViewCell *cell = [tableProducts dequeueReusableCellWithIdentifier:CellIdentifier];
if(cell == nil) {
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    cell.selectionStyle = UITableViewCellSelectionStyleNone;
    cell.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight;        
}

/* ------ Product title in RED ------*/

CGRect titleFrame = CGRectMake(5, 5, 250, 15);
UILabel *productTitle = [[UILabel alloc] initWithFrame:titleFrame];
productTitle.font = [UIFont boldSystemFontOfSize:14];
productTitle.textColor = [UIColor redColor];
productTitle.text = [listProducts objectAtIndex:indexPath.row];

[cell.contentView addSubview:productTitle];

/* ------ Product title in RED ------*/

/* ------ Product Text ------*/

CGRect textFrame = CGRectMake(5, 20, 300, 50);
UITextView *textView = [[UITextView alloc] initWithFrame:textFrame];
textView.textColor = [UIColor blackColor];
textView.font = [UIFont boldSystemFontOfSize:11.5];
textView.text = [listTexts objectAtIndex:indexPath.row];
textView.scrollEnabled = NO;
textView.editable = NO;

[cell.contentView addSubview:textView];

/* ------ Product Text ------*/

return cell;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T22:48:46.027

只需在切换方向时更改框架。为 shouldAutoRotate 返回 yes，然后在 willAnimateRotation 中执行以下操作：

```
-(void)willAnimateRotationToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration
{
    if(UIInterfaceOrientationIsLandscape(toInterfaceOrientation))
    {
       textView.frame = CGRectMake(x,y,width,height)//whatever values you want for landscape
    }
    else
    {
       textView.frame = CGRectMake(x,y,width,height)//whatever values you want for portrait
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T22:26:41.843

设置文本的自动调整大小掩码

```
 textview.autoresizingMask = UIViewAutoresizingFlexibleWidth; 
```

# php - 正则表达式问题，多个匹配，但为什么？

> ID：14762091
> 
> 赞同：0
> 
> 时间：2013-02-07T22:17:07.287
> 
> 标签：php, regex, preg-match

我有这段文字：

之前的内容

```
[row marginTop="10" marginBottom="10"]

[column_3]

[column][article id="12" /][/column]

[column][article id="13" /][/column]

[column][article id="14" /][/column]

[/column_3]

[/row] 
```

当我这样做时：

```
$pattern = '/^(\[([a-zA-Z0-9][a-zA-Z0-9_]+[a-zA-Z0-9]) *( [a-zA-Z]+( ="[^".]*")?)*( *\/)?\])$/';
preg_match($pattern, $text, $matches, PREG_OFFSET_CAPTURE);

print_r($matches);

```

结果是：

```
大批
(
    [0] => 数组
        (
            [0] => [行 marginTop="10" marginBottom="10"]
            [1] => 137
        )

    [1] => 数组
        (
            [0] => marginBottom="10"
            [1] => 156
        )

    [2] => 数组
        (
            [0] => =“10”
            [1] => 166
        )

)

```

为什么？我能做些什么来避免这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T22:22:29.053

子模式符号`(...)`有两个目的：分组和捕获。所以`$matches`最终得到所有子模式的内容，以及整个匹配。

如果您不希望这样，您可以删除分组不需要的括号，并且如果您需要分组而不捕获，您可以使用*非捕获子模式*表示法`(?:...)`：

```
$pattern = '/^\[[a-zA-Z0-9][a-zA-Z0-9_]+[a-zA-Z0-9] *(?: [a-zA-Z]+(?:="[^".]*")?)*(?: *\/)?\]$/'; 
```

（有关更多信息，请参阅[PHP 手册中的“子模式”](http://php.net/manual/en/regexp.reference.subpatterns.php)。）

# groovy - 如果我也在使用 Java 7，我应该使用 Groovy 的 @CompileStatic

> ID：14762094
> 
> 赞同：14
> 
> 时间：2013-02-07T22:17:34.053
> 
> 标签：groovy, java-7, invokedynamic, groovy-2, compile-static

我已经阅读了[“Groovy 2.0 中的新增功能”](http://www.infoq.com/articles/new-groovy-20)，但对于何时使用 @CompileStatic 感到有些困惑。文章提到，`@CompileStatic`注释是为无法利用 Java7 的调用动态部分的开发人员添加的。

> 因此，如果无法在 JDK 7 上运行，寻求性能改进的开发人员不会在 Groovy 2.0 中看到太多变化。幸运的是，Groovy 开发团队认为这些开发人员可以通过允许类型检查获得有趣的性能提升以及其他优势静态编译的代码。

我的问题是，如果我使用的是 JDK 7 并按照说明添加`--indy`标志，是否需要添加`@CompileStatic`才能看到一些性能提升？ [这个博客](http://objectscape.blogspot.com/2012/08/groovy-20-performance-compared-to-java.html)建议我这样做，但我不确定他是否正确编译，因为他是在 Eclipse 中完成的。

**更新：**以下是运行斐波那契代码的不同排列时的统计数据。

```
> groovy --indy FibBoth.groovy
..........Fib (non-static indy): 1994.465
..........Fib (static indy): 529.197

> groovy FibBoth.groovy       
..........Fib (non-static): 1212.788
..........Fib (static): 525.671 
```

注意：这个问题现在似乎有点令人困惑，因为我知道这些功能是独立的。由于问题的基础是围绕使我认为这两个功能相关的注释中的混淆，我认为不更改问题措辞并允许解释差异的公认答案是有意义的。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-19T14:08:13.500

众所周知，indy 版本是完全动态的 Groovy，由于 JDK 7 的 invokedynamic，速度更快。@CompileStatic 表示静态编译​​。虽然比普通的 Groovy 更快，但它只能编译 Groovy 的一个子集，并且行为有点不同。尤其是所有动态功能都不再可用。因此，如果您想使用动态功能，那么 indy 是唯一的选择。如果你是一个静态的人并且只使用语言的一小部分，那么可以使用@CompileStatic。

顺便说一句，斐波那契不是一个可以让 invokedynamic 发光的测试。印地港口并不总是更好。但是如果你做很多元编程，那么 indy 会更好。

你最终要根据你的使用情况来决定

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-21T07:47:06.780

归根结底，@CompileStatic 删除了一些 Groovy 动态运行时功能以提高速度。

所以，理论上：

*   由于invokedynamic，JDK7应该比JDK6快
*   @CompileStatic 应该比标准更快，因为删除了一些开销和功能。

需要注意的是，这在很大程度上取决于您在做什么，因为各种功能都在不同程度上进行了优化。

# python - 收到 POST http 请求后的“资源暂时不可用”-Python

> ID：14762097
> 
> 赞同：0
> 
> 时间：2013-02-07T22:18:03.883
> 
> 标签：python, forms, http-post

我的服务器套接字有问题。我正在制作一个网络服务器并试图从浏览器中填充一个。表单 HTML 脚本如下所示：

```
<html>
<body bgcolor = black text= white>
<FORM method="post" action="/processData.py">
<P>
<LABEL for="firstname">First name: </LABEL>
<INPUT type="text" id="firstname"><BR>

<LABEL for="lastname">Last name: </LABEL>
<INPUT type="text" id="lastname"><BR>

<LABEL for="email">email: </LABEL>
<INPUT type="text" id="email"><BR>

<INPUT type="radio" name="sex" value="Male"> Male<BR>
<INPUT type="radio" name="sex" value="Female"> Female<BR>

<INPUT type="submit" value="Send"> <INPUT type="reset">
</P>
</FORM>
</body>
</html> 
```

当点击“提交”后从浏览器发送 POST 请求时，我试图在我的终端上打印整个请求。当我在我的 Web 服务器上收到 POST 请求时，套接字会抛出“[Errno 35] 资源暂时不可用”。我没有关闭连接或任何东西，但不知何故我失去了连接。这是我在 python 中用来获取 POST 的代码。

```
while not recvIsComplete:
    rcvdStr = fd.recv( 1024 )
    if rcvdStr[0:3] == "GET":
        toGET()

    elif rcvdStr[0:4] == "POST":       
        print rcvdStr 
```

知道发生了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T22:31:45.803

这可能不正确，但似乎很可能基于您提供的信息：

您已经编写了一个阻塞服务器——可能每个客户端连接都在其自己的线程中（但可能使用进程或 greenlet，或者甚至一次只处理一个客户端）。但是您使用的是非阻塞套接字。

详细信息取决于您的确切代码和平台，但最常见的原因是您调用`recv`了一个没有数据的非阻塞套接字，并且它正在返回`EWOULDBLOCK`，并且您的平台具有相同的错误号`EAGAIN`和`EWOULDBLOCK`。

如果是这样，简单的答案是：不要将非阻塞套接字与阻塞服务器一起使用。要么确保套接字处于阻塞模式，要么不要调用`recv`它们，除非你知道有数据（例如，因为`select`刚刚告诉你）。

您*可以*`try`通过在阻塞服务器中处理非阻塞套接字`recv`并`EWOULDBLOCK`以某种方式处理（例如，`select`仅在该套接字上再试一次，或发送心跳/空闲数据包以确保另一端仍然存在，或其他适合您的设计）。但通常，这不是你想要做的。你可以用`settimeout`.

# linux - 无互联网语音触发识别

> ID：14762100
> 
> 赞同：3
> 
> 时间：2013-02-07T22:18:13.307
> 
> 标签：linux, speech-recognition, speech, raspberry-pi, human-computer-interface

手持设备上的语音识别通常由按下按钮触发。如果没有它，我该如何触发语音识别？我的基于 Raspberry PI 的设备故意没有用户可以手动交互的任何东西——只有一个麦克风挂在墙上。

我正在尝试实现一种方法来让它理解一个简单的触发命令，该命令将启动一系列动作。简而言之，我想在“听到”音频触发器时运行单个 .sh 脚本。我不希望它理解其他任何东西，而只是一个触发器 - 它没有任何意义，它必须从触发器本身解码 - 比如脚本或参数的名称。一个非常简单的功能 - “听到触发器 -> 执行 .sh 脚本”

我探索了不同的选择：

1.  将音频流连续发送到谷歌语音识别服务 - 不是一个好主意 - 浪费了太多的流量和资源

2.  让一个无互联网的语音识别应用程序持续收听音频流并“挑选”触发词 - 这有点好，但几乎浪费资源，并且这些系统必须学习音频样本 - 这几乎消除了快速为设备设置自定义名称

3.  使用某种音高处理让它对一系列响亮的声音做出反应 - 拍手两次或类似的东西 - 还不错，但我想我的手在我得到正确测试后会掉下来，否则我会被我的家庭成员，因为我通常会在晚上睡觉时尝试我的玩具。

4.  口哨识别 - 与之前的选项没有太大区别，但你的手掌不会酸痛，如果我学会安静地吹口哨，我很有可能在测试中幸存下来。我能够找到 IBM 的一篇关于通过口哨命令控制计算机的文章 - 该方法与本地语音识别应用程序几乎相同，但您教它理解不同的口哨序列。然而，从那以后我不明白我怎么能教它理解任何口哨，不管它的语气如何。

我有点喜欢吹口哨的想法——看起来它应该是其他选项中资源消耗最少的——我该怎么做？

鉴于我受到 Raspberry PI 硬件的限制，是否还有其他可以轻松实现的声音触发器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T02:59:11.800

Mono 是一个可以安装在 pi 上的框架，用于编译和运行 C# 应用程序，我相信它支持 System.Speech 和 System.Speech.Recognition。您可以使用它们轻松编写应用程序，只需指定您希望它收听的单词。将它写在您的计算机上，然后将 exe 移动到 pi 并使用悬挂在 pi 上的麦克风运行它。我做了一个类似的应用程序，但我使用了套接字服务器并以这种方式发送命令。您设置命令的方式非常简单。

```
 SpeechRecognitionEngine rec = new SpeechRecognitionEngine(new System.Globalization.CultureInfo("en-US")); 
    rec.SetInputToDefaultAudioDevice();
    rec.SpeechRecognized += speech_recognized;
    var c = new Choices();
    c.Add("Trigger");
    var gb = new GrammarBuilder(c);
    var g = new Grammar(gb);
    rec.LoadGrammar(g);
    rec.RecognizeAsync(RecognizeMode.Multiple);
    rec.MaxAlternates = 0;

    private void speech_recognized(object speechsender, SpeechRecognizedEventArgs e)
    {
    if(e.Result.Text == "Trigger"){
    //run your script
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-11-27T21:59:07.907

查看 nodejs 进程，它处理来自麦克风的音频流事件，然后使用带有有限自定义字典的 pocketsphinx 离线语音识别来识别简单的语音命令：

[https://github.com/ybutb/yee-voice](https://github.com/ybutb/yee-voice)

# linux - 从 ALSA 录制 - 理解内存映射

> ID：14762103
> 
> 赞同：8
> 
> 时间：2013-02-07T22:18:19.097
> 
> 标签：linux, audio, usb, alsa

我试图使用 ALSA 从 USB 音频设备获取输入并将其作为一系列`signed short`值写入磁盘。我最终得到的是似乎是有效数据的块，其中散布着大块零。我猜我的缓冲区设置不正确，并且没有正确使用内存映射。

我正在尝试什么：

> *   采样率：8K（这是设备强制的）
> *   缓冲区大小：2048
> *   期数：512
> *   一个频道

该设备似乎已正确打开并接受各种参数。经过一些设置后，循环运行为：

```
snd_pcm_avail_update   
snd_pcm_mmap_begin   
   memcpy data from mmap buffer to array of short   
snd_pcm_mmap_commit 
```

memcpy 是指向 short 数组的指针，并按每次传递返回的帧数递增。

在此记录几秒钟后，我将其关闭并将后续缓冲区作为每行上的单个短值写入磁盘。我期待的是一两秒在 1200 到 2300 赫兹之间变化的 PCM 数据。我得到的是一些有很多零的数据。

我想知道的是：我的缓冲区和周期值是否合理？有没有人成功使用 ALSA 的内存映射输出？

编辑：一些代码

```
const snd_pcm_channel_area_t *areas;  
snd_pcm_uframes_t offset, frames, size;   
short* pCID = (short*)malloc( 50000 * sizeof( short ));  
short* ppCID = pCID;
while( size > 0 )  
{  
   frames = size;  
   snd_pcm_mmap_begin (device, &areas, &offset, &frames);     
   short* pd = (short*)areas[0].addr;   
   memcpy( ppCID, (pd + (offset*sizeof(short))), frames * sizeof( short ));  
   ppCID += frames;  
   snd_pcm_mmap_commit(device, offset, frames);  

   size -= frames;
} 
```

（为清楚起见，删除了错误检查）
当一切都说完了，我循环通过 pCID 并写入磁盘。每行一个值。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-08T08:28:05.270

ARM 上的 USB 音频驱动程序存在一个[已知错误](http://www.spinics.net/lists/arm-kernel/msg222433.html)，其中内核和应用程序的同一缓冲区映射可能不是缓存一致的。

*仅当*代码可以直接处理样本而不将它们复制到另一个缓冲区时，使用 ALSA 内存映射函数才有意义。如果您确实复制它们，那么您所做的与已经做的*完全相同*`snd_pcm_readi`。换句话说，就是不要使用内存映射。

捕获时，缓冲区大小对延迟没有影响，因此应将其设置得尽可能大以避免可能的溢出。

较小的周期大小可以降低延迟，但您的程序不会执行任何与实时相关的操作，因此您可以使用较大的周期大小来节省一点功率。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T22:34:56.157

来自[文档](http://www.alsa-project.org/alsa-doc/alsa-lib/group___p_c_m___direct.html)：“有必要在此调用之前直接调用 snd_pcm_avail_update() 函数。否则，此函数可能会返回错误的可用帧数。” 我认为问题在于 snd_pcm_mmap_begin 误报了可用帧的数量，因此您正在读取尚未写入的区域。

另外，我并不肯定，但我认为 alsa mmap 函数在有数据之前不会阻塞，尽管这可能被我在这里没有看到的其他代码所覆盖。它与文件 mmap 不太一样，所以不要开始认为它是。如果您的粉丝开始发疯并且一切变得缓慢，那么您的代码很可能正在从应用程序切换到内核上下文并在要读取零字节时不断地再次切换回来。

正如之前的海报所指出的，无论如何，这都是 snd_pcm_readi 的完美用例，所以使用它。

# facebook - Facebook FQL 收集网站上所有页面的统计信息，而不仅仅是主页

> ID：14762105
> 
> 赞同：0
> 
> 时间：2013-02-07T22:18:24.187
> 
> 标签：facebook, facebook-graph-api, facebook-fql

我目前正在使用：

```
SELECT url, normalized_url, share_count, like_count, comment_count,
total_count, commentsbox_count, comments_fbid, click_count
FROM link_stat WHERE url='http://www.mediauk.com/' 
```

...收集特定网站的 Facebook 链接统计信息。

当然，这只做一页；并且会错过例如[http://www.mediauk.com/jobs的任何 Facebook 统计信息](http://www.mediauk.com/jobs)

有没有办法可以使用通配符或类似的东西将来自一个域的所有 URL 组合在一起？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-11T23:30:42.813

使用 PHP 我会这样做：

```
<?php 

$fb_links = array();

//THEN POPULATE ARRAY WITH LINKS YOU GET FROM YOUR DB
...
//AND FINALLY CREATE FACEBOOK QUERY USING "IN" TOGETHER WITH PHP's implode() 

$fql = "SELECT url, normalized_url, share_count, like_count, comment_count, total_count, commentsbox_count, comments_fbid, click_count
FROM link_stat 
WHERE url IN ('".implode("','",$fb_links)."')";

echo $fql; 

// Result will be: SELECT url, normalized_url, share_count, like_count, comment_count, total_count, commentsbox_count, comments_fbid, click_count FROM link_stat WHERE url IN ('link1','link2','link3')

?> 
```

编辑：只是一个错字

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T19:32:29.390

如果您正在使用某种 CMS，您可以通过所有页面/帖子/任何内容进行循环，然后收集所有信息。如果它是手动编码的普通 html 服务，那么除了创建一个包含所有链接的数组然后为它们获取这些数据之外，可能没有其他答案:(。

# jquery - 将类添加到元素

> ID：14762108
> 
> 赞同：-1
> 
> 时间：2013-02-07T22:18:37.963
> 
> 标签：jquery, class, add

像这样，我有两个选项卡，所以当我单击一个选项卡时，它是活动的，逻辑。现在我试图区分活动和非活动选项卡，但不是使用 .css 属性，但我想将特定类添加到单击的选项卡，如下所示：

```
$(".tab1").addClass('active'); 
```

但是，不好。还请记住，我正在使用外部 css 文件。

```
<div id="menuitem" class="tab1"></div>
<div id="menuitem" class="tab2"></div>

.active {
    width: 170px;
    height: 70px;
    float: right;
    background-color: red;
}

#menuitem {
    width: 170px;
    height: 70px;
    float: right;
    background-color: white;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T22:23:14.140

HTML 中的两个 div 不能有相同的 id。尝试像这样更改您的 HTML。

```
<div id="menuitem1" class="menuitem tab1"></div>
<div id="menuitem2" class="menuitem tab2"></div>

.active {
background-color: red;
}

.menuitem {
width: 170px;
height: 70px;
float: right;
background-color: white;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T22:30:47.913

另一个问题可能是您在 div 元素存在之前运行 jQuery 函数。

所以要么，移动代码

```
$(".tab1").addClass('active'); 
```

在要更改的 div 下方，或将其包装在文档就绪函数中。

```
$(document).ready(function(){
    $(".tab1").addClass('active');
}); 
```

在运行您的代码之前，它将等到创建了 dom。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T22:23:50.047

首先不要`id`在不同的元素上使用相同的，`id`'s 必须是唯一的，试试这个：

**jQuery：**

```
$('.menuitem').click(function() {
    $('.menuitem').removeClass('active');
    //removes active class from all menu items

    $(this).addClass('active');
    //adds active class to clicked one
}); 
```

**html:**

```
<div id="tab1" class="menuitem"></div>
<div id="tab2" class="menuitem"></div> 
```

**css：**您不需要为活动类定义相同的属性，只需定义差异：

```
.active { background-color: red; }

.menuitem {
  width: 170px;
  height: 70px;
  float: right;
  background-color: white;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-07T22:25:22.657

首先，`id`s 应该始终是唯一的。

但是，您的问题的原因是 css 特异性。`id`规则比一类更具体。试试这个。

```
#menuitem.active {
width: 170px;
height: 70px;
float: right;
background-color: red;
}

#menuitem {
width: 170px;
height: 70px;
float: right;
background-color: white;
} 
```

但请记住，这将有助于克服特异性问题。它没有解决您需要摆脱重复`id`的 s 的事实。

[CSS 特异性](http://coding.smashingmagazine.com/2007/07/27/css-specificity-things-you-should-know/)

# matlab - 使用 cellfun 检查工作区中是否存在变量

> ID：14762112
> 
> 赞同：9
> 
> 时间：2013-02-07T22:18:49.050
> 
> 标签：matlab, exists

考虑以下示例：

```
dat1 = 1;
dat2 = 2;

Variables = {'dat1','dat2'};

a = cellfun(@(x)exist(x,'var'),Variables);

for i = 1:length(Variables);
    a2(i) = exist(Variables{i},'var');
end 
```

为什么“a”和“a2”返回不同的值，即为什么使用 cellfun 没有说明变量存在于工作区中？我错过了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T16:33:53.490

好的，我想我明白这里发生了什么：

当您调用匿名函数时，它会创建自己的工作区，就像任何普通函数一样。但是，此新工作区将无权访问调用方工作区。

因此

```
funH = @(x)exist(x,'var') 
```

如果您`'x'`作为输入 ( `funH('x')`) 提供，则只会返回 1，因为它的整个工作区由变量`'x'`.

最后，

```
funH = @(x)exist('x','var') 
```

将始终返回 1，无论您提供什么作为输入。

有两种可能的方法：

(1) 用于`evalin`在调用者的工作空间中进行评估

```
 funH =  @(x)evalin('caller',sprintf('exist(''%s'',''var'')',x)) 
```

(2) 使用 的输出`whos`，并检查现有变量列表

```
 Variables = {'dat1','dat2'};
 allVariables = whos;
 a3 = ismember(Variables,{allVariables.name}) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-08T00:55:16.507

我认为你应该把这`cellfun`一行写成：

```
a = cellfun(@(x) exist('x','var'),Variables); 
```

使其等效于 for 循环。另请参阅如何`exist`在[Matlab 的文档](http://www.mathworks.com/help/matlab/ref/exist.html)示例中使用...

**编辑：**

在（我想我）理解乔纳斯的回答之后，上面的行将始终返回 true，无论是否`dat1=1`或`dat1=[]`。为了使用`cellfun`看到乔纳斯的回答......

# java - JPA2.0映射一个Map Map 如何指定列名？

> ID：14762117
> 
> 赞同：0
> 
> 时间：2013-02-07T22:19:15.820
> 
> 标签：java, jakarta-ee, jpa, eclipselink

```
@ManyToMany
@JoinTable(schema = "cust_tables", joinColumns = @JoinColumn(name = "item_id"))
public Map<Attribute, Option> attributeValues; 
```

Attribute 是属性名称，option 是该属性的有效值。

EclipseLink 当前为表生成以下 DDL：

```
CREATE TABLE `items_options` (
  `attributes_id` bigint(20) NOT NULL,
  `item_id` bigint(20) NOT NULL,
  `attributes_KEY` bigint(20) DEFAULT NULL,
  PRIMARY KEY (`item_id`,`attributes_id`),
  KEY `FK_items_options_attributes_id` (`attributes_id`),
  KEY `FK_items_options_attributes_KEY` (`attributes_KEY`),
  CONSTRAINT `FK_items_options_attributes_id` FOREIGN KEY (`attributes_id`) REFERENCES `options` (`id`),
  CONSTRAINT `FK_items_options_attributes_KEY` FOREIGN KEY (`attributes_KEY`) REFERENCES `attributes` (`id`),
  CONSTRAINT `FK_items_options_item_id` FOREIGN KEY (`item_id`) REFERENCES `items` (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci; 
```

在连接表上，我需要更改列名：“attributes_id”和“attributes_KEY”。我该如何指定？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T09:19:49.087

要更改列 Attribute 的名称，请尝试使用注解 @MayKeyJoinColumn。像这样的东西：

```
@ManyToMany
@JoinTable(schema = "cust_tables", joinColumns = @JoinColumn(name = "item_id"))
@MapKeyJoinColumn(name="ATTRIBUTE")
public Map<Attribute, Option> attributeValues; 
```

# c# - 如何获取从 onload 事件期间生成的数组文本框的值

> ID：14762119
> 
> 赞同：1
> 
> 时间：2013-02-07T22:19:17.177
> 
> 标签：c#, arrays, winforms, textbox, onload-event

我无法在 onload 事件中检索从运行时生成的数组文本框的值。这是代码。

来自表单 onload 事件：

```
private void frmMain_Load(object sender, EventArgs e)
{           
TextBox[] txtFldNames = new TextBox[15];
int x = 155, y = 65, w = 300, h = 20;

for (int i = 0; i < 15; i++)
{
    y = y + 30;
    txtFldNames[i] = new TextBox();
    txtFldNames[i].Location = new System.Drawing.Point(x, y);
    txtFldNames[i].Size = new System.Drawing.Size(w, h);
    this.Controls.Add(txtFldNames[i]);
    txtFldNames[i].ReadOnly = true;
    txtFldNames[i].BackColor = Color.White;
}
} 
```

现在如何从按钮访问文本框值？

```
private void button1_Click(object sender, EventArgs e)
{
     //what to do here?
} 
```

我已经在下面尝试过这个，但它不起作用。我得到的只是空值。所以请指出我正确的方向

```
private void button1_Click(object sender, EventArgs e)
{
    TextBox[] txtFldNames = new TextBox[15];

    for (int j = 0; j < 15; j++)
    {
        txtFldNames[j] = new TextBox();
        MessageBox.Show("" + txtFldNames[j].Text);
    }
} 
```

这是完整的代码：

```
public partial class classMain : Form
{
    public frmMain()
    {
        InitializeComponent();
    }

    private void frmMain_Load(object sender, EventArgs e)
    {
        TextBox[] txtFldNames = new TextBox[15];
        int x = 155, y = 65, w = 300, h = 20;

        for (int i = 0; i < 15; i++)
        {
            y = y + 30;
            txtFldNames[i] = new TextBox();
            txtFldNames[i].Location = new System.Drawing.Point(x, y);
            txtFldNames[i].Size = new System.Drawing.Size(w, h);
            this.Controls.Add(txtFldNames[i]);
            txtFldNames[i].ReadOnly = true;
            txtFldNames[i].BackColor = Color.White;
        }
    }

    private void button1_Click(object sender, EventArgs e)
    {
        //what to do here?
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T22:21:22.550

您需要访问之前创建的文本框，而不是新的：

```
private void button1_Click(object sender, EventArgs e)
{
    for (int j = 0; j < 15; j++)
    {
        MessageBox.Show("" + txtFldNames[j].Text);
    }
} 
```

如果`txtFldNames`是加载事件中的局部变量，那么您需要将其更改为表单的实例字段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T22:45:07.833

给定完整的代码，您可以这样做：

```
public partial class classMain : Form
{
    // Move your list to a global scope in the classMain form.
    TextBox[] txtFldNames = new TextBox[15];

    public frmMain()
    {
        InitializeComponent();
    }

    private void frmMain_Load(object sender, EventArgs e)
    {
        int x = 155, y = 65, w = 300, h = 20;

        for (int i = 0; i < 15; i++)
        {
            y = y + 30;
            txtFldNames[i] = new TextBox();
            txtFldNames[i].Location = new System.Drawing.Point(x, y);
            txtFldNames[i].Size = new System.Drawing.Size(w, h);
            this.Controls.Add(txtFldNames[i]);
            txtFldNames[i].ReadOnly = true;
            txtFldNames[i].BackColor = Color.White;
        }
    }

    private void button1_Click(object sender, EventArgs e)
    {
        //what to do here?

        // Now you can access the global array variable.
        for (int i = 0; i < 15; i++)
        {
            MessageBox.Show(txtFldNames[i].Text);
        }
    }
} 
```

如果您想稍微清理一下代码：

```
public partial class classMain : Form
{
    // Move your list to a global scope in the classMain form.
    TextBox[] txtFldNames = new TextBox[15];

    public frmMain()
    {
        InitializeComponent();
    }

    private void frmMain_Load(object sender, EventArgs e)
    {
        int x = 155, y = 65, w = 300, h = 20;

        for (int i = 0; i < 15; i++)
        {
            y = y + 30;

            var t = new TextBox
            {
                Location = new System.Drawing.Point(x, y),
                Size = new System.Drawing.Size(w, h),
                ReadOnly = true,
                BackColor = Color.White
            };

            txtFldNames[i] = t;
            this.Controls.Add(t);
        }
    }

    private void button1_Click(object sender, EventArgs e)
    {
        //what to do here?

        // Now you can access the global array variable.
        for (int i = 0; i < txtFldNames.Length; i++)
        {
            MessageBox.Show(txtFldNames[i].Text);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T22:22:38.633

您可以使用`Enumerable.OfType`来查找您的文本框：

```
foreach(TextBox txt in this.Controls.OfType<TextBox>())
{
    string text = txt.Text; 
} 
```

（记得加`using System.Linq;`）

您还可以通过`foreach(TextBox txt in txtFldNames)`.

您的方法不起作用，因为您是`new`在循环中创建 TextBoxes 而不是引用已经存在的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-07T22:28:09.250

我从您的代码示例中假设它`txtFldNames`是一个实例变量（即在表单范围内声明，而不是在表单加载事件内）。

因此，在您的按钮单击处理程序中，您需要使用`txtFldNames`数组中的 TextBox 对象 - 即您在表单加载时创建的对象。您当前的代码改为创建一个新的 TextBox 对象数组。

例如

```
foreach(TextBox textBox in tbFldNames) {
    MessageBox.Show(textBox.Text);
} 
```

编辑：

发布完整代码后，您需要创建`txtFldNames`一个实例变量。

IE

```
public partial class classMain : Form
{
    TextBox[] txtFldNames = new TextBox[15]; // <--- Move txtFldNames outside of your frmMain_Load() method. 
```

# javascript - 正则表达式获取除逗号、破折号和单引号之外的所有字母数字字段

> ID：14762120
> 
> 赞同：3
> 
> 时间：2013-02-07T22:19:28.107
> 
> 标签：javascript, regex

我试图去除除逗号、破折号和单引号之外的所有非字母数字字符。我知道如何从字符串中删除所有非单词，即

```
myString.replace(/\W/g,''); 
```

`,` `-`但是除了and之外，我该怎么做`'`呢？我试过

```
myString.replace(/\W+[^,]/g,''); 
```

因为我知道如何使用 `^`运算符否定，只是在组合正则表达式时遇到了麻烦。

任何帮助表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-07T22:21:05.770

`\w`是 的倒数`\W`，所以你可以使用`/[^\w,'-]/`

编辑：如果也不需要下划线：`/[^\w,'-]|_/`

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-02-07T22:23:26.937

以下字符类匹配属于字母、数字、逗号、破折号和单引号类的单个字符。

```
[-,'A-Za-z0-9] 
```

以下匹配不属于其中之一的字符：

```
[^-,'A-Za-z0-9] 
```

所以

```
var stripped = myString.replace(/[^-,'A-Za-z0-9]+/g, ''); 
```

# node.js - Mocha-phantomjs 测试没有输出

> ID：14762121
> 
> 赞同：1
> 
> 时间：2013-02-07T22:19:34.587
> 
> 标签：node.js, phantomjs, mocha.js

我已经在[这里](https://github.com/metaskills/mocha-phantomjs#readme)成功安装了节点模块“mocha-phantomjs” 。我写了以下测试用例：

test1.js

```
describe("DOM Tests", function () {
    var el = document.createElement("div");
    el.id = "myDiv";
    el.innerHTML = "Hi there!";
    el.style.background = "#ccc";
    document.body.appendChild(el);
    var myEl = document.getElementById('myDiv');
    it("is in the DOM", function () {
        expect(myEl).to.equal(null);
    });
    it("is a child of the body", function () {
        expect(myEl.parentElement).to.equal(document.body);
    });
    it("has the right text", function () {
        expect(myEl.innerHTML).to.equal("Hi there!");
    });
    it("has the right background", function () {
        expect(myEl.style.background).to.equal("rgb(204, 204, 204)");
    });
}); 
```

测试用例.html

```
<html>
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="mocha.css" />
  </head>
  <body>
    <div id="mocha"></div>
    <script src="mocha.js"></script>
    <script src="chai.js"></script>
    <script>
      mocha.ui('bdd');
      mocha.reporter('html');
      expect = chai.expect;
    </script>
    <script src="test1.js"></script>
    <script>
      if (window.mochaPhantomJS) { mochaPhantomJS.run(); }
      else { mocha.run(); }
    </script>
  </body>
</html> 
```

我得到的是绝对没有输出，即使我在我的 js 文件中做了错字。

这里的重点是我必须在无头服务器中使用一些自动化的 dom 和 js 测试并将其与 Jenkins 集成，我认为使用 TAP 报告是可以的。欢迎任何其他建议。

编辑

我更新了我的 phantomjs 版本，现在我得到以下信息：

```
TypeError: 'undefined' is not a function (evaluating 'mocha.ui('bdd')')

  file:///home/seventeenlive/site/tests/TestRunner2.html:11
ReferenceError: Can't find variable: describe

  file:///home/seventeenlive/site/tests/test1.js:20
ReferenceError: Can't find variable: process

  mocha-phantomjs/core_extensions.js:21
  mocha-phantomjs/core_extensions.js:82
ReferenceError: Can't find variable: process

  phantomjs://webpage.evaluate():2
  phantomjs://webpage.evaluate():8
  phantomjs://webpage.evaluate():8
ReferenceError: Can't find variable: process

  phantomjs://webpage.evaluate():3
  phantomjs://webpage.evaluate():17
  phantomjs://webpage.evaluate():17
Failed to start mocha. 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-30T20:09:32.970

我通过使用 node_modules/mocha 的相对路径提供 mocha.js 解决了这个问题。

```
<div id="mocha"></div>
<script src="../node_modules/mocha/mocha.js"></script>
<script src="../node_modules/chai/chai.js"></script> 
```

这个 html 应该在 '/test' 目录下。如果不是，请调整路径。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-06T03:28:40.323

我也有这个问题，问题是我的 mocha 版本——回到 1.9.0 修复了它。

# wampserver - wamp服务器登录错误

> ID：14762123
> 
> 赞同：0
> 
> 时间：2013-02-07T22:19:37.297
> 
> 标签：wampserver

![wamp 像这样出现在桌面上](../Images/4b2d201053c87e364cab6c409da3712e.png)Wamp 服务器问题

我在这里有一个奇怪的问题：当我在 Windows 服务中检查 wamp mysql 时它正在运行并且 apache 已停止，并且在我将端口从 80 更改为 8080 之后，wamp 服务器图标现在是绿色的，但是 phpmyadmin 不工作并且错误消息是：

HTTP 错误 404。未找到请求的资源。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-12T09:02:51.303

你最好的解决方案是找出为什么你不能在端口 80 上运行 Apache 并修复它。

使用 Wampmanager 图标（系统托盘中的绿色 W 图标）执行以下操作：

```
left click wampmanager -> Apache -> Service -> Test Port 80 
```

这将加载一个命令窗口并告诉你什么正在使用端口 80。

然后，它只是重新配置任何内容的情况。

阻碍的正常事情是

SKYPE, TEAM VIEWER, IIS 如果它的 IIS 这些也可以运行并且也将报告为 IIS，也应该从服务面板禁用。

1.  IIS
2.  网络部署 2.0
3.  MS Sql Server 报告服务。

Skype 和 Team Viewer 可以很容易地重新配置为不使用端口 80。可以从您的服务面板禁用 IIS，如果您从不希望使用它，甚至可以将其卸载。

**如何配置 SKYPE，使其不需要端口 80 或 443**

运行 SKYPE，然后使用菜单执行以下操作：

工具 -> 选项 -> 高级 -> 连接

取消选中“使用端口 80 和 443 作为传入连接的替代方案”旁边的复选框

现在重新启动 SKYPE 以使这些更改生效。

如果您正在运行 Windows 8 SKYPE 作为应用程序提供，并且不能（目前）以这种方式进行配置。但是，如果您卸载 SKYPE 应用程序并以旧方式安装 SKYPE，您可以重新配置它，它也可以正常工作。

**如何配置 Team Viewer，使其不需要端口 80 或 443** 运行 TV Extras -> Options -> Advanced -> Press the Advanced Button -> Advanced Network Connections 检查复选框 [ 不要使用传入端口 80（仅推荐用于 Web 服务器)

# android - mdpi Android 设计的 PSD 文档大小

> ID：14762125
> 
> 赞同：3
> 
> 时间：2013-02-07T22:19:40.063
> 
> 标签：android, photoshop

我有一个 iPhone 应用程序设计 PSD，我需要适应 Android 应用程序设计。

我已经阅读了五篇不同的官方文档文章、几篇博客文章、Stack Overflow 答案、模板 PSD 文件，应有尽有。

我现在知道我的任务是在 mdpi 基线密度中进行设计，然后使用 3:4:6:8 比例规则为每个密度提取位图可绘制对象。

然而，每一个写我所读内容的聪明人似乎都忽略了告诉我的一件事是我应该使用什么确切的像素值来创建所说的 mdpi 设计。

我读过的每个示例都以“例如，如果您在 mdpi 中有一个 100x100 图标...”开头。好吧，我不知道我的图标在 mdpi 中有多少像素。

[该文档](http://developer.android.com/guide/practices/screens_support.html)说“普通屏幕至少为 470dp x 320dp”。我认为“正常”这个词适用于屏幕*尺寸*，而不是*密度*。什么是“至少”？如果我以“至少”大小制作可绘制对象，然后有人的屏幕比这更大怎么办？最后还有一张表格，我可以从中收集到 mdpi 屏幕是 320x480 或 1280x800。所以这一切都清楚了。

我不是 Android 开发者，也不渴望成为其中的一员。我只是一个悲伤、愤怒的设计师，他想知道我应该在 Photoshop 的“图像大小”对话框中输入的确切数字，以将我的 Retina iPhone 设计（640x960 老式像素）变成 Android 中 mdpi 的大小代表. 请有人向我提供这些数字。谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T22:56:37.243

在具有 326dpi 的 640x960 iPhone res 上，您正试图达到 160dpi (mdpi) 级别。

因此，这意味着您需要将尺寸乘以 160/326 或 0.49。这将产生一个 314x471 的模板。

还可以查看[http://code.google.com/p/android-ui-utils/](http://code.google.com/p/android-ui-utils/)，其中包含一些设备屏幕模板，您可以将它们导入 Photoshop 或其他编辑器。从那里开始，如果您使用带有 HDPI 手机的模板，您可以相应地进行缩放。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T23:52:06.120

首先一些可以阐明android设计的可拉伸概念的链接：

[http://developer.android.com/guide/topics/resources/more-resources.html#Dimension](http://developer.android.com/guide/topics/resources/more-resources.html#Dimension) [http://blog.edwinevans.me/?p=131](http://blog.edwinevans.me/?p=131)

“我认为“正常”这个词适用于屏幕尺寸，而不是密度。”

我有一个 4" 屏幕和 480x800 分辨率的手机。这大约是 240dpi 另一部手机有一个 4" 屏幕 320x480 res，但只有 160dpi (mdpi)。

可以将其想象为尝试在老式 150dpi 打印机上以全分辨率打印 16 兆像素的照片。你最终会得到一个巨大的打印输出。

为了避免这个分辨率问题，在android中使用了sp/dp，使不同分辨率的屏幕看起来非常相似。

您应该能够设置 Photoshop 以所需的目标 DPI 向您展示您的设计。

我希望这有助于解开你的困惑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-10T19:30:06.367

对于 mdpi 基线 photoshop 画布，尺寸为：

宽度：360 像素高度：640 像素 ppi：72

这将为您提供 16:9 格式的屏幕，您可以轻松地将组件缩放到 1920x1080 xxhdpi 屏幕。

# php - 如何使用 MYSQLI store_result（和 dataseek？）对随机结果进行分页？

> ID：14762126
> 
> 赞同：0
> 
> 时间：2013-02-07T22:19:41.920
> 
> 标签：php, random, mysqli

我需要使用 PHP 提取数据集并随机排序。每次拉动时，我都需要一个不同的随机顺序。

提取数据后，我将使用 ajax/jquery 一次提取 12 个结果。所以我必须继续使用相同的结果集，根据分页一次只提取 12 条记录。

谁能向我解释如何使用 mysqli/php 执行此操作，我认为它将使用 store_result 和可能的 data_seek。但我希望这里有一些经验的人可以为我指明正确的方向。

我当前的查询...

```
SELECT * FROM mytable WHERE status='active' limit 0,12 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T22:28:14.313

我使用 MD5 函数做过一次。您使用 php 生成一个随机种子（盐）并将其附加到您的所有 ID，例如：

```
SELECT * FROM mytable WHERE status='active' ORDER BY MD5(CONCAT(id, :salt)) DESC LIMIT 0,12 
```

（例如，将 :salt 替换为 'aE41n'）

然后，您所要做的就是将盐存储在每个用户的会话中。

不知道这是否是考虑性能的最佳解决方案，但我希望它会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T01:21:39.580

> 所以我必须继续使用相同的结果集

这是错误的假设。在您调用下一页时，没有旧的结果集。

所以，你最好坚持使用 mimipc 的解决方案，它非常聪明。

# php - 将单个字段的“必需”信息传递给复合 Symfony2 表单

> ID：14762128
> 
> 赞同：1
> 
> 时间：2013-02-07T22:19:45.123
> 
> 标签：php, forms, symfony, symfony-forms

我需要在 Symfony2 应用程序的多个位置输入一对日期和时间。为此，我创建了一个`custom_datetime`表单类型。我想决定是否需要，如果整个 custom_datetime 有一个标志`time`，则保持需要。`date``required`

```
class DateTime extends AbstractType
{

    public function buildForm(FormBuilderInterface $builder, array $options)
    {
        $builder
            ->add('date', 'text', [
                'attr' => ['required' => true] // Here I maybe should inherit what is passed by the parent form
            ])
            ->add('time', 'text', [
                'attr' => ['required' => $options['time_required']]
            ])
        ;
    }

    public function setDefaultOptions(OptionsResolverInterface $resolver)
    {
        $resolver->setDefaults(array(
            'time_required' => false
        ));
    }

    public function getName()
    {
        return 'custom_datetime';
    }
} 
```

然后`custom_datetime`是其他形式。目前我这样使用它：

```
// date should be entered, time should not -- this does not currently work
$builder->add('dt', 'custom_datetime', ['required' => true, 'time_required' => false]);
// date + time should be entered
$builder->add('dt', 'custom_datetime', ['required' => true, 'time_required' => true]);
// neither of date or time is required
$builder->add('dt', 'custom_datetime', ['required' => false]); 
```

不幸的是，该`time`字段在以 HTML 呈现时获得了必需的属性。

**应该怎么做才能允许父表单`custom_datetime`传递有关时间字段的“必需”信息？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T02:25:53.847

您不应该为此使用该`attr`属性。

```
$builder
    ->add('time', 'text', array('required' => true)) 
```

# python - Gunicorn 崩溃时如何让 Upstart 重定向

> ID：14762129
> 
> 赞同：1
> 
> 时间：2013-02-07T22:19:50.640
> 
> 标签：python, django, gunicorn, upstart

我有一个使用 gunicorn 0.17.0 部署的 Django 网站，该网站由 Upstart 在 Ubuntu 12.04 上启动，并使用 nginx/1.1.19 作为静态媒体。有时当我的 django 代码出现错误时，Gunicorn 会引发 gunicorn.errors.HaltServer 并不断崩溃并一次又一次地启动。我发现的方法是当我看到日志迅速变大时。而且我必须手动停止 Gunicorn 服务。然后删除巨大的日志文件。调试并再次运行它。

我的问题是：处理这种崩溃并再次启动的最佳方法是什么？我知道自动启动是 Upstart 的重点，但在这种情况下，当 Gunicorn 崩溃时再次启动它是没有意义的。出现此错误时，Upstart 是否可以停止启动 Gunicorn？然后启动另一项服务，将用户重定向到网站上的不同页面？你有什么建议吗？

这是不断重复的 Gunicorn 日志部分： [https ://github.com/erasmose/kart/blob/master/kart/issues/kart_gunicorn_log.txt](https://github.com/erasmose/kart/blob/master/kart/issues/kart_gunicorn_log.txt)

谢谢，时代

# scala - Spray.io 指令未注册？

> ID：14762141
> 
> 赞同：1
> 
> 时间：2013-02-07T22:20:17.023
> 
> 标签：scala, spray

我想`users/{id}/permission`使用 POST 方法通过 Spray 路由访问路径。出于某种原因（我尝试了不同的配置）它没有注册路由，我得到一个`405 METHOD NOT ALLOWED`.

下面的代码是路径前缀“用户”的一部分。GET 有效，但 POST 无效。

```
path(Rest / "permission") { id =>
        /**
         * save permissions object for a user
         */
        post {
          entity(as[String]) { body =>
              try {
                val uperm = parse[UserPermission](body)
                UserPermission.store(uperm)
                respondWithMediaType(`application/json`) {
                  complete {
                    generate(uperm)
                  }
                }
              } catch {
                case e: com.codahale.jerkson.ParsingException =>
                  complete {
                    HttpResponse(BadRequest, "Submitted malformed data.")
                  }
              }
          }
        } ~
          /**
           * grab permissions for a single user
           */
        get {
          try {
            val uperm = UserPermission.fetch(id)
            respondWithMediaType(`application/json`) {
              complete {
                generate(uperm)
              }
            }
          } catch {
            case e: java.lang.NullPointerException =>
              complete {
                HttpResponse(NotFound, "Object not found.")
              }
          }
        }
      } ~ 
```

我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T12:34:00.350

您不应该那样使用“Rest”，而是尝试“PathElement”：

```
path(PathElement / "permission") { id =>
  ...
} 
```

如果它是一个 Int 使用 IntNumber，但 Rest 是如果你想将 url 的“rest”匹配到最后......所以你使用的方式没有意义，它应该放在最后。

# java - Eclipse 调试步进与 AspectJ

> ID：14762142
> 
> 赞同：5
> 
> 时间：2013-02-07T22:20:20.660
> 
> 标签：java, eclipse, eclipse-plugin, aspectj

我有带有“AspectJ 开发工具”插件的 Eclipse 设置。我正在尝试调试一些使用 AspectJ 的代码并单步执行它，但由于 AspectJ 在编译时添加了额外的东西，它无法匹配源代码行。似乎没有其他人抱怨似乎是一个重大缺陷（无法调试！），所以我希望我只需要调整一些东西以使其工作。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-09-18T10:25:26.843

到目前为止，我遇到了您仅通过`@Around`建议描述的行为。`@Before`或`@After`建议从未混淆我使用的调试器。

`@Around`默认情况下内联在编织类中（包括目标类和方面本身）。这与我尝试过的其他建议不同。内联使调试器即使不是不可能也很难遵循流程。

您可以在 AspectJ 编译器中禁用内联，这将以调试器友好的方式生成编织类。禁用内联可能会产生更慢的代码和更多的编织类（创建辅助类）。

行家方式：

```
<plugin>
    <groupId>org.codehaus.mojo</groupId>
    <artifactId>aspectj-maven-plugin</artifactId>
    <version>1.7</version>
    <executions>
        <execution>
            <goals>
                <goal>compile</goal>
            </goals>
        </execution>
    </executions>
    <configuration>
        <source>${java.compiler.source}</source>
        <target>${java.compiler.target}</target>
        <complianceLevel>${java.compiler.target}</complianceLevel>

        <!-- Avoid some optimizations that make debugger useless. -->
        <XnoInline>true</XnoInline>
    </configuration>
</plugin> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T23:46:00.217

是的，这是 AspectJ 的一个错误。单步执行建议附加了不正确的文件属性。最好的解决方法是在您的建议中委托一个适当的方法，并且行号将对齐。

# iphone - UITableView 页脚视图正在更改组表样式

> ID：14762143
> 
> 赞同：0
> 
> 时间：2013-02-07T22:20:25.203
> 
> 标签：iphone, ios, objective-c, xcode, ipad

我有一个分组表，我正在尝试向其中添加页脚视图。但是，当我执行我的代码时，它会在每个部分之间添加一个灰色条，并将视觉样式从分组表外观更改为普通 UITableView。

如何防止在每个部分之间添加页脚视图？这是我的代码（在 init 方法中）

```
 UIView *footerView = [[UIView alloc] initWithFrame:CGRectMake(0,0,320,500)];
    SubmitButton *submitButton;
    submitButton = [[SubmitButton alloc] init];
    [submitButton setTitle:NSLocalizedString(@"BUTTON_TITLE_SEARCH", nil) forState:UIControlStateNormal];
    submitButton.frame=CGRectMake(0,10,self.tableView.frame.size.width,50);
    submitButton.autoresizingMask = UIViewAutoresizingFlexibleWidth;
    [footerView addSubview:submitButton];
    self.tableView.tableFooterView = footerView; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T22:35:49.480

使用委托方法中的节号来确定这是否确实是最后一节

```
 - (UIView *)tableView:(UITableView *)tableView viewForFooterInSection:(NSInteger)section; 
    {
          if (section == 5){
                format section.....
          } else {
             return nil;
          }
    } 
```

我使用数字 5 作为表格最后一部分的示例。如果您不想要偏移量，您还需要将其他部分的高度设置为 0

```
 - (CGFloat)tableView:(UITableView *)tableView heightForFooterInSection:(NSInteger)section
 {
       if (section == 5) {
          return 100;
       } else {
          return 0;
       }
 } 
```

# salesforce - 如何使 Salesforce 字段在准确的目标电子邮件中可用

> ID：14762147
> 
> 赞同：0
> 
> 时间：2013-02-07T22:20:45.050
> 
> 标签：salesforce, exacttarget

我正在为使用精确目标[http://www.exacttarget.com/](http://www.exacttarget.com/)的客户创建电子邮件活动。客户 Salesforce 帐户已连接到其确切的目标帐户。我想使用 Salesforce 字段在精确目标中提供更多个性化字段（marge 字段）。目前我只有名字可用。

有人可以解释或提供一些文档的链接吗？网络搜索没有返回我需要的东西

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T15:23:45.557

如果 Salesforce 已正确集成，那么当您在订阅者 > 我的订阅者 > 配置文件管理中创建新配置文件属性时，您应该启用 Salesforce 选项卡。

配置文件属性映射到 Salesforce 字段后，它们将在您的电子邮件中作为个性化字符串提供：

```
%%[SalesForceField1]%% 
```

来自 ExactTarget 的文档：

[SalesForce 属性](http://help.exacttarget.com/en/documentation/integrated_products__crm_and_web_analytic_solutions/exacttarget_for_appexchange/attributes_for_salesforce_leads_and_contacts_procedures/)

[个性化字符串](http://help.exacttarget.com/en/documentation/exacttarget/content/personalization_strings/)

# c# - 创建一个依赖于间隔状态的可观察对象

> ID：14762151
> 
> 赞同：0
> 
> 时间：2013-02-07T22:20:57.423
> 
> 标签：c#, system.reactive

我正在尝试编写一个类，它将每隔 x 秒从数据库中查询一组数据。

问题是这个 observable 记住了它之前的状态，并且这个状态被用来确定 observable 上实际发送的内容。

例如我想要一个

```
IObservable<SomeEntity> AddedEntities { get; private set; }
IObservable<SomeEntity> ChangedEntities { get; private set; }
IObservable<SomeEntity> DeletedEntities { get; private set; } 
```

我的问题是我一直在阅读[http://www.introtorx.com/](http://www.introtorx.com/)他们说使用主题是一个坏主意。相反，我应该使用 Observable.Create 方法。

我的问题是我只想查询数据库一次，然后将相关信息发送回正确的 observable，但我不希望每个订阅我的 observable 启动它自己的计时器，并且每次订阅每个 IObservable 时每 5 秒查询一次数据库。

我只制作了一个 observable，它返回一个新模型，并将更改为一组：

```
IObservable<EntityChangeSet> Changes {get; private set;}

public class EntityChangeSet
{
    Public IEnumerable<SomeEntity> Added {get; set;}
    Public IEnumerable<SomeEntity> Changed {get; set;}
    Public IEnumerable<SomeEntity> Deleted {get; set;}
} 
```

我也对任何这样的解决方案持开放态度。

到目前为止，我所拥有的是：

```
public class IntervalChangeReader
{
    // My state between ticks.
    private IEnumerable<SomeEntity> knowEntities;

    // Reads the data from the db and uses knowEntities to determine adds, changes, 
    // and deletes which are exposed through properties.
    private DbReaderAndChangeChecker checker;

    IDisposeable timerCancel;

    public IntervalChangeReader(DbReaderAndChangeChecker checker)
    {
        this.checker = checker;
    }

    public IObservable<EntityChangeSet> Changes { get; private set; }

    public Start(int seconds)
    {
        this.timerCancel = Observable.Interval(new TimeSpan.FromSeconds(seconds)).Subscribe(
            x => 
            {
                var results = this.checker.Refresh(this.knownEntities);

                // Update this.knownEntities with results.

                // Inform produce a value on the observable ????
                // I could call .OnNext If I had a subject exposed for my Observable.
            }
    }

    public Stop()
    {
        this.timerCancel.Dispose();

        // Complete on all subscriptions?
        // If I were using subjects I could just call .OnComplete here.
    }
} 
```

如何在不使用主题的情况下创建 Observable 以及如何通过它传递结果？我想只用一个计时器而不是每次订阅我的 observables 的计时器来完成这一切。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T23:11:33.027

我相信你所追求的是`ConnectableObservable`方法......玩弄这个（注意，在电话上，所以我的语法可能有点偏离）

```
public void Start(int seconds)
{
    // Every tick, generate a "changeset"
    var changeCentral =
        from tick in Observable.Interval(TimeSpan.FromSeconds(seconds))
        let results = this.checker.Refresh(this.knowEntities)
        select new EntityChangeSet(results);

    // Publish means one subscription for all "connecting" subscribers
    // RefCount means so long as one subscriber is subscribed, the subscription remains alive
    var connector = changeCentral.Publish().RefCount();
    Changes = connector;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T23:44:15.950

我想我已经找到了解决问题的方法。

```
public class IntervalChangeReader
{
    // My state between ticks.
    private IEnumerable<SomeEntity> knowEntities;

    // Reads the data from the db and uses knowEntities to determine adds, changes, 
    // and deletes which are exposed through properties.
    private DbReaderAndChangeChecker checker;

    private EntityChangeSet lastChangeResult;

    public IntervalChangeReader(DbReaderAndChangeChecker checker)
    {
        this.checker = checker;

        // I like to use Do instead of just combining this all into Select to make the side effect obvious.
        this.Changes = Observable.Interval(TimeSpan.FromSeconds(seconds), scheduler).Do(
            x =>
                {
                    var changes = DbReaderAndChangeChecker.Refresh(this.knownXRefs);

                    // Make changes to knownXRefs which is my state.
                    this.knownXRefs.AddRange(changes.Added);
                    this.knownXRefs.RemoveAll(y => changes.Removed.Any(z => z.Id == y.Id));
                    this.knownXRefs.RemoveAll(y => changes.Changed.Any(z => z.Id == y.Id));
                    this.knownXRefs.AddRange(changes.Changed);

                    lastChangeResult = changes;
                }).Select(x => this.lastChangeResult);

            }

    public IObservable<EntityChangeSet> Changes { get; private set; }

} 
```

# javascript - 如何在文本输入中创建倒数计时器？

> ID：14762153
> 
> 赞同：2
> 
> 时间：2013-02-07T22:21:06.117
> 
> 标签：javascript, jquery, html

下面我有一个运行良好的javascript倒数计时器：

```
 <h1><span id='countdown'><?php echo $dbSessionDuration; ?></span></h1>

...

  $(document).ready(function() {
    var time = <?php echo json_encode($dbSessionDuration); ?>,
      parts = time.split(':'),
      hours = +parts[0],
      minutes = +parts[1],
      seconds = +parts[2],
      span = $('#countdown');

    function correctNum(num) {
      return (num<10)? ("0"+num):num;
    }

    var timer = setInterval(function(){
        seconds--;
        if(seconds == -1) {
            seconds = 59;
            minutes--;

            if(minutes == -1) {
                minutes = 59;
                hours--;

                if(hours==-1) {
                  alert("timer finished");
                  clearInterval(timer);
                  return;
                }
            }
        }
        span.text(correctNum(hours) + ":" + correctNum(minutes) + ":" + correctNum(seconds));
    }, 1000);

}); 
```

现在我想做的是使用上面的示例并操作它现在做相反的事情并创建一个从 00:00:00（小时、分钟、秒）开始的计数计时器。

但问题是它不起作用。什么都没有发生。我不知道我在下面的函数中是否需要一个小时，因为作为一个计数，时间可以根据需要增加到尽可能多的小时。但我的问题是如何修复倒计时计时器以使其完全正常工作？

```
<p><input type='text' class='responseTime' name='responsetime' value='00:00:00' /></p>

...

$(document).ready(function() {
var response = "00:00:00",
      parts = time.split(':'),
      hours = +parts[0],
      minutes = +parts[1],
      seconds = +parts[2],
      input = $('.responseTime');

    function correctResponse(responsenum) {
      return (responsenum<10)? ("0"+responsenum):responsenum;
    }

    var responsetimer = setInterval(function(){
        seconds--;
        if(seconds == +59) {
            seconds = 00;
            minutes--;

            if(minutes == +59) {
                minutes = 00;
                hours--;

                  return;

            }
        }
        input.text(correctResponse(hours) + ":" + correctResponse(minutes) + ":" + correctResponse(seconds));
    }, 1000);

  }); 
```

**更新：**

另外作为旁注，我意识到我认为倒计时计时器每秒每 2 秒倒计时一次。如何为倒数计时器排序并包含在正数计时器中？

下面的代码我已更改为包含增量 ++ 并包含 .val 而不是 .text 但发生的情况是它从 00:00:00 开始，然后下降到 00:59:60 然后停止：

```
var response = "00:00:00",
          parts = time.split(':'),
          hours = +parts[0],
          minutes = +parts[1],
          seconds = +parts[2],
          input = $('.responseTime');

        function correctResponse(responsenum) {
          return (responsenum<10)? ("0"+responsenum):responsenum;
        }

        var responsetimer = setInterval(function(){
            seconds++;
            if(seconds == +59) {
                seconds = 00;
                minutes++;

                if(minutes == +59) {
                    minutes = 00;
                    hours++;

                      return;

                }
            }
            input.val(correctResponse(hours) + ":" + correctResponse(minutes) + ":" + correctResponse(seconds));
        }, 1000);

      }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T22:25:48.163

在 jQuery 中，使用该`val('value')`函数更改/设置输入字段的值。

更改`input.text(...)`为`input.val(...)`

还：

1.  在增加秒数后使用`seconds = seconds % 60;`将它们带回`0`.
2.  另外，考虑使用`data-attributes`用于将值传递给 javascript。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T22:32:07.010

您可以像这里一样轻松地修改当前的倒数计时器：http: [//jsfiddle.net/Sergiu/CDpeJ/3](http://jsfiddle.net/Sergiu/CDpeJ/3)

```
var timer = setInterval(function(){
    seconds++;
    if(seconds == 60) {
        seconds = 00;
        minutes++;

        if(minutes == 60) {
            minutes = 00;
            hours++;
        }
    }
    var newTime = hours + ":" + minutes + ":" + seconds;
    if(!newTime.match(/^(20|21|22|23|[01]\d|\d)(([:.][0-5]\d){1,2})$/)) newTime = "finished";
    $('#timeInput').val(newTime);
}, 1000); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-07T22:52:05.530

这就是我实现这样一个计时器的方式：

```
function startTimer() {
    var time = 0
    setInterval(function(){
        time++
        var sec = time % 60
        var min = (time-sec)/60 % 60
        var hour = (time-sec-min*60)/3600
        var str= hour+':'+("0"+min).slice(-2)+':'+("0"+sec).slice(-2)
        $('.responseTime').val(str)
    },1000);
} 
```

使用带有类的输入`responseTime`来显示计时器。（为什么不使用 id 顺便说一句？）

在适当的调用时开始`startTimer()`（在您的示例中使用`document.onload=startTimer`）

如果要从 0 以外的其他时间开始，请设置`time`适当的秒数。对于倒计时，替换`time++`为`time--`（可能为 增加一些物流`time==0`）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-01-19T10:02:41.720

数数试试这个

```
var millis = <?php echo $dbSessionDurationTime; ?> ( diff in seconds )

function displaytimer(){
    var hours = Math.floor(millis / 36e5),
        mins = Math.floor((millis % 36e5) / 6e4),
        secs = Math.floor((millis % 6e4) / 1000);
        //Here, the DOM that the timer will appear using jQuery
        $('.count').html(hours+':'+mins+':'+secs);  
}

setInterval(function(){
    millis += 1000;
    displaytimer();
}, 1000); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-02-09T12:31:32.710

我向 JSFiddle 添加了 Mariusnn 解决方案和 Oerd 建议，并在 Jquery 中将 val 更改为文本。

HTML 文件

`<body> <h1 style="color:blue">Time</h1> <h2><span class="responseTime" style="color:indianred"></span> </h2> </body>`

JS代码

` var startTimer;

```
startTimer = function() {
var time;
time = 0;
setInterval((function() {
    var hour, min, sec, str;
    time++;
    sec = time % 60;
    min = (time - sec) / 60 % 60;
    hour = (time - sec - (min * 60)) / 3600;
    count = hour + ':' + ('0' + min).slice(-2) + ':' + ('0' + sec).slice(-2);
    $('.responseTime').text(count);
    }), 1000);
   };

$( document ).ready(function() {
    startTimer();
}); 
```

`

### JS小提琴解决方案在这里。

[https://jsfiddle.net/hzLf3e38/4/](https://jsfiddle.net/hzLf3e38/4/)

# c++ - 枚举电池设备 c++ windows

> ID：14762154
> 
> 赞同：1
> 
> 时间：2013-02-07T22:21:08.667
> 
> 标签：c++, winapi, battery

我正在使用 windows api 来获取各种硬件信息，例如 cpu 使用情况和电池信息。我一直在尝试按照本指南[http://msdn.microsoft.com/en-us/library/windows/desktop/bb204769%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/bb204769%28v=vs.85%29.aspx)获取电池设备名称的名称但是当我到达这里时，我被困住了。

```
#define INITGUID
#include<windows.h>
#include<batclass.h>
#include<setupapi.h>
#include<devguid.h>

using namespace std;

int main()
{
HDEVINFO hdev = SetupDiGetClassDevs(&GUID_DEVCLASS_BATTERY, 0, 0, DIGCF_PRESENT 
| DIGCF_DEVICEINTERFACE);
} 
```

但我收到以下错误

```
[Linker error] C:\Users\Owner\AppData\Local\Temp\ccTMeaf9.o:Untitled1.cpp:(.text+0x28): undefined reference to `__imp_SetupDiGetClassDevsA' collect2: ld returned 1 exit status 
```

我是 C++ 的初学者，所以我可能会遗漏一些明显的东西，但这就是他们在指南中的做法。任何建议都会很棒。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T22:28:17.747

文档说谎，GUID 实际上是在 devguid.h 中定义的。另外（如果你还没有在另一个源文件中这样做）你需要

```
#define INITGUID 
```

在包括 BatClass.h 和 devguid.h 之前。如果你的项目中没有这个，你会在链接时得到一个未定义的符号错误，如果你有多个，则会在链接时得到一个多重定义的符号错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T23:00:35.853

以下代码在 DevCPP 上编译：

```
#define INITGUID
#include <windows.h>
#include<ddk\batclass.h>
#include<setupapi.h>

int main() {
{
    HDEVINFO hdev = SetupDiGetClassDevs(&GUID_DEVICE_BATTERY, 0, 0, DIGCF_PRESENT | DIGCF_DEVICEINTERFACE);
} 
```

注意**GUID_DEVICE_BATTERY**。

为了获得正确的链接，您必须将库 libsetupapi.a 添加到项目选项|参数|链接器

该程序未经测试运行。它只能正确编译。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T22:27:45.720

它`devguid.h`在我的 mingw/GCC 头文件和我的 MSSDK 旧副本中定义。

尝试添加这个：

```
#include <devguid.h> 
```

# c# - 从远程服务器上运行的控制台应用程序捕获输出

> ID：14762159
> 
> 赞同：0
> 
> 时间：2013-02-07T22:21:28.333
> 
> 标签：c#, wmi, remote-server

我正在使用 WMI（C# 代码）在远程服务器上运行控制台应用程序

我想捕获该过程的输出。

有人可以帮我这样做吗？

**设想：**

我有一个网页，用户将在其中提供服务器详细信息。当用户点击提交时，我想调用远程服务器上的应用程序并传递参数。远程服务器上的应用程序将执行该操作并返回输出（输出可以是数字、字符串或布尔值）。

根据输出，我需要提示用户提供更多详细信息或显示错误。

```
object[] processToRun = new[] { "\"Path to exe\" \"Param1\" \"Param2\"" };
ConnectionOptions connection = new ConnectionOptions();
connection.Username = "username";
connection.Password = "password";
ManagementScope wmiScope = new ManagementScope(String.Format("\\\\{0}\\root\\cimv2", "ServerName"), connection);
ManagementClass wmiProcess = new ManagementClass(wmiScope, new ManagementPath("Win32_Process"), new ObjectGetOptions());
wmiProcess.InvokeMethod("Create", processToRun); 
```

我想得到这个的输出。

**临时解决方案：但不起作用**

作为一个临时解决方案，我添加了代码以在每个人都可以访问的共享路径上创建一个日志文件。但是在这里我又遇到了问题，当我在远程服务器上调用 exe 写入共享路径时，我总是收到错误消息“拒绝访问”。但是当我从服务器本身运行 exe 时，它​​工作正常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T22:32:26.477

我过去使用过[PsExec](http://technet.microsoft.com/en-us/sysinternals/bb897553.aspx)。当防火墙阻止 WMI 请求时，这会有所帮助。您应该能够像从 C# 启动任何其他进程一样启动 PsExec，并且只需重定向标准输出。我认为您将在 PsExec 本身的输出流中包含一些额外的字节和位，但它应该可以让您在进行一些修剪后到达您需要去的地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T23:27:05.493

假设您想从第二台机器收集输出，一种方法是使用套接字。第二台机器将托管一个基于套接字的侦听服务绑定的预定义端口。

一旦你的控制台应用程序有东西要发回，它就会打开与第二台机器的连接并发送数据。

如果有很多客户端，并且您希望他们经常进行通信，您可以使用基于 WCF 或 Web 服务之类的解决方案，其中有许多现成的框架可供使用

**根据您提供的附加信息**，

创建远程控制台进程时，向其传递一个唯一 ID (GUID)，将其与源自 Web 服务器的客户端请求联系起来。您的控制台应用程序现在将捕获输入并将其与 guid 一起通过套接字发送到服务器。

服务器可以使用 GUID 将每个输出记录到数据库表中以识别每个会话。现在启动的用户可以使用相同的 GUID 查询输出（记住 GUID 是在用户创建请求时生成的，因此用户将始终拥有它）并且服务器将从表中获取输出并显示

此外，您可以有一个管理任务来清除超过 x 天的所有结果的输出表

希望这可以帮助

# java - 在 Ubuntu 上作为守护进程运行时，如何给 Jenkins 更多的堆空间？

> ID：14762162
> 
> 赞同：54
> 
> 时间：2013-02-07T22:21:53.243
> 
> 标签：java, ubuntu, jenkins, out-of-memory, heap-memory

我的 Jenkins 作业内存不足，`java.lang.OutOfMemoryError`在构建日志中提供消息。但是我使用了 Ubuntu 包管理器，`aptitude`或者`apt-get`安装了 Jenkins，但我不知道在哪里可以更改分配给 Jenkins 的堆空间量。

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2013-02-07T22:21:53.243

`OutOfMemoryError`在Jenkins 作业运行时，您可能会遇到两种类型的消息：

*   `java.lang.OutOfMemoryError: Heap space`– 这意味着您需要在守护进程启动时增加分配给 Jenkins 的堆空间量。
*   `java.lang.OutOfMemoryError: PermGen space`– 这意味着您需要增加为存储 Java 对象元数据分配的生成空间量。增加`-Xmx`参数的值不会影响这个错误。

在 Ubuntu 12.04 LTS`JAVA_ARGS`上，取消注释第 10 行的设置`/etc/default/jenkins`：

*   要添加更多 Java 堆空间，请增加`-Xmx`Java 参数的值。这设置了内存分配池（垃圾收集堆）的最大大小。
*   要添加更多 PermGen 空间，请添加参数（如果需要更多，请`XX:MaxPermSize=512m`替换为其他内容。永久代堆包含有关用户类的元信息。`512`

例如，此摘录来自`/etc/default/jenkins`全新安装 Jenkins 后的默认值：

```
# arguments to pass to java
#JAVA_ARGS="-Xmx256m" 
```

如果将堆空间设置为 1 GB，它会是这样的：

```
# arguments to pass to java
JAVA_ARGS="-Xmx1048m" 
```

注意不要将堆大小设置得太大，因为无论您分配什么都会减少操作系统和其他程序可用的内存量，这可能会导致过多的分页（内存在 RAM 和交换磁盘之间来回交换，这会减慢您的系统已关闭）。

如果还设置`MaxPermSpace`了，需要在参数之间加一个空格）：

```
# arguments to pass to java
JAVA_ARGS="-Xmx1048m -XX:MaxPermSize=512m" 
```

进行更改后，从 Jenkins Web 界面优雅地重新启动 Jenkins，或者从命令行使用`sudo /etc/init.d/jenkins restart`.

我发现以下站点对于理解 Java 最大和永久代堆大小很有用：[http](http://www.freshblurbs.com/blog/2005/05/19/explaining-java-lang-outofmemoryerror-permgen-space.html) ://www.freshblurbs.com/blog/2005/05/19/explaining-java-lang-outofmemoryerror-permgen-space.html 。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2014-09-10T22:42:30.423

对于 CentOS，jenkins-1.579-1.1 默认的 Jenkins.xml 所在目录是 /etc/sysconfig/

`JENKINS_JAVA_OPTIONS="-Djava.awt.headless=true -Xmx -XX:MaxPermSize="`

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2017-07-03T14:47:49.953

如果您使用的是 Ubuntu Server，请先安装[Monitoring](https://wiki.jenkins.io/display/JENKINS/Monitoring)插件以查看 Jenkins 使用了多少内存。例如，这是我安装后看到的：

[![在此处输入图像描述](../Images/ecc8a23eacebb73d04f4d7fddd964204.png)](https://i.stack.imgur.com/MwbTb.png)

然后，使用命令`free -m`，我计算出服务器的内存大小。就我而言，16Gb。有了这些信息，我打开`/etc/default/jenkins`并更改了：

`JAVA_ARGS="-Djava.awt.headless=true"`

至

`JAVA_ARGS="-Xmx8384m -Djava.awt.headless=true"`

其中 8384 是 8Gb。然后我使用命令重新启动了 Jenkins，`sudo service jenkins restart`然后，在触发出现内存问题的作业后，情况看起来好多了，并且该作业可以在此运行和后续运行中完成：

[![在此处输入图像描述](../Images/aa9bc3758042f52fde64a3578f27e0eb.png)](https://i.stack.imgur.com/DvNg1.png)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2020-04-15T06:09:08.680

为特定作业设置堆大小的另一种方法是为每个作业使用环境变量。这可确保当需要更高内存的作业未使用时，内存可用。

```
GRADLE_OPTS="-Dorg.gradle.jvmargs=-Xms1024M -Xmx8192M -XX:PermSize=512M -XX:MaxPermSize=2048 -XX:+CMSClassUnloadingEnabled -XX:+HeapDumpOnOutOfMemoryError -Dfile.encoding=UTF-8"

JAVA_OPTS="-XX:MaxPermSize=2048M" 
```

[![詹金斯作业配置](../Images/06e909d7e99008ad64174e9728034e37.png)](https://i.stack.imgur.com/49CnC.png)

# msbuild - 我应该如何构建我的 MSBuild 脚本

> ID：14762167
> 
> 赞同：3
> 
> 时间：2013-02-07T22:22:05.440
> 
> 标签：msbuild

最近，我开始学习 MSBuild，以便灵活地为本地和服务器构建（CI、Nightly、Weekly）构建脚本。根据我的经验，我知道构建脚本可能非常尴尬。即使在我的公司有一些指导，了解所有目标以及它们如何协同工作也是一种痛苦。当然，这是一个长期的过程：你需要一些东西，你没有足够的时间，你开始变得懒惰和凌乱。但我问自己，如何构建一个 MSBuild 脚本以便于扩展性和可读性？**尤其是目标DependsOnTargets、BeforeTargets、AfterTargets**之间的三个关系，对我的脚下射击很有用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-12T02:13:00.150

如果您有兴趣，在我的[MSBuild 书中](http://msbuildbook.com)，我有一节介绍如何在 MSBuild 中创建可重用元素。不过，我也会在这里发表一些评论。这个内容与书中的内容不同。

创建 MSBuild 文件时，您应该小心区分**what**与**how**。为了稍微解释一下，让我们看看托管 VS 项目是如何开箱即用的（*这是可重用元素的一个很好的模型*）。

当您创建 C#/VB 项目时，您将获得一个 .csproj 文件，该 .csproj 文件主要包含属性和项。您不会在该文件中找到单个目标。这些文件包含**将**要构建的内容（以及与构建相关的一些设置）。在项目文件的底部，您将找到一个导入语句。这个导入带来了项目是**如何**构建的。

导入的文件包括：

*   Microsoft.CSharp/VisualBasic/FSharp.targets
*   Microsoft.common.targets

在这种情况下，Microsoft.common.targets 定义了所有托管语言的整体构建过程。然后 Microsoft.CSharp.targets（*或其他特定语言的 .targets 文件之一*）填补了如何调用特定语言特定工具的空白。

## DependsOnTargets 与 Before/AfterTargets

在您上面的回答中，您声明“*我建议避免使用 DependsOnTargets，除非确实有必要，例如两个*”。我不同意这一点。这是我对 DependsOnTargets 与 Before/AfterTargets 的看法。

**使用 DependsOnTargets 时**

*   当您尝试创建要执行的目标工作流时
*   当一个目标在没有其他目标首先执行的情况下无法运行时
*   当您需要根据所需操作在特定步骤注入不同目标时

**使用 Before/AfterTargets 时**

*   当您不拥有目标所在的文件并且它没有可以扩展的 DependsOnTargets 属性时
*   无论何时执行，您都希望目标在特定目标之前/之后执行

稍微梳理一下差异，请考虑 Web 项目。对于 Web 项目，.csproj/.vbproj 负责两个工作流程：

1.  建造
2.  发布

如果我想在构建目标之前将目标添加到要执行的目标列表中，我可以仅为发布场景动态更新 BuildDependsOn 属性。您不能使用 Before/AfterTargets 执行此操作。

在理想的世界中，每个目标都将具有以下 DependsOnTargets。

*   所有目标都有一个 DependsOnTargets 属性，该属性由属性提供
*   每个 DependsOnTargets 总是将现有值添加到属性定义中

例如

```
<MyTargetDependsOn>
    $(MyTargetDependsOn);
    Target1;
    Target2
</MyTargetDependsOn> 
```

不幸的是，许多目标不遵循这种模式，因此 DependsOnTargets 在许多情况下都死在了水中。

当我创作 MSBuild 脚本时**，我总是使用 DependsOnTargets ，除非我有充分的理由选择使用 Before/AfterTargets**。我觉得（*我对设计的真正原因没有洞察力，因为我当时不在 Microsoft 工作*）Before/AfterTargets 的真正创建是为了允许用户在他们没有的目标之前/之后注入要执行的目标自己的，创作者没有使用上面的模式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T22:22:05.440

好吧，正如我已经说过的，我有自己的经历:)

1.  每个目标都进入一个**文件**，就像在面向对象编程中一样：）公共属性和项目组也应该保留在它们自己的文件中（例如，包含所有要构建的项目的*Projects.conf ；包含所有工具路径的**Environment.conf*和扩展包）。正如您将看到的，这对于不同的构建集（如本地和服务器构建）非常方便。
2.  **定义**您需要的所有路径、文件和属性。不要遵循 DRY 原则。这是很难的事情，但根据我的经验，很难根据已经定义的价值观来构建新的价值观。因此，如果您有一个包含*.csproj*和*.nuspec*文件的项目，请不要费心显式声明它们。
3.  声明一个**初始化目标**。解释如下。
4.  声明一些在构建过程中必须处理的**主要目标，如***Clean、Build、Test、Package、Deploy、Archive*等。使它们相互依赖（*DependsOnTargets*）。*例如，测试*和*打包*取决于*构建*目标。它们都应该取决于*Init*目标。
5.  健全性检查是**规则 1 的例外**。它们属于需要它们的同一个文件。例如，*PackageCheck*目标将监视*.nuspec*文件是否存在，并将*Init*声明为*AfterTargets*。这允许快速失败构建。
6.  所有**其他目标**将使用*BeforeTargets、AfterTargets*进行排序。我建议避免使用*DependsOnTargets*，除非确实有必要，例如如果必须在*Build*之前处理两个目标，但彼此之间也有顺序。
7.  在服务器和本地构建脚本中，**只需导入**您需要的所有内容以及应该是公共 API 的内容。正如我所说，每个目标都进入一个文件 (1)。现在，如果您有一个*UpdateAssemblyVersion*目标，则应在*AfterTargets* (5)中声明*Build 。*您可以通过简单地添加/删除导入来激活/停用该目标。
**   利用**MSBuildExtensionPack**。他们真的很有帮助！但也不要害怕**编写自己的任务**！*

 *所以这些是我的规则。我将不胜感激任何意见或补充！*

# jquery - jqzoom 限制小图像尺寸

> ID：14762169
> 
> 赞同：1
> 
> 时间：2013-02-07T22:22:05.923
> 
> 标签：jquery, image, jqzoom

我正在使用效果很好的 jqzoom，但是当我将大小应用于主图像上的 img 标签时，然后单击其他图像缩略图时，图像被拉伸到初始图像的尺寸。

有没有一种方法可以在没有其他图像的情况下限制小图像尺寸（小于实际图像尺寸），假设尺寸相同但仍然受到限制并保持其纵横比？

# vb.net - 从带有凭据的 Windows 窗体中打开 URL

> ID：14762172
> 
> 赞同：0
> 
> 时间：2013-02-07T22:22:07.557
> 
> 标签：vb.net, winforms

我正在尝试使用用户名和密码打开一个外部网站。我有正确的凭据，但是当我尝试以下代码时，我收到“登录失败：未知用户名或密码错误”错误。

```
 Dim username As String = "username"
        Dim password As New System.Security.SecureString

        'Set value for SecureString type variable   
        Dim plainPassword As String = "pass"
        For Each c As String In plainPassword.ToCharArray
            password.AppendChar(c)
        Next c

        Dim IEprocess As System.Diagnostics.Process = New System.Diagnostics.Process
        IEprocess.StartInfo.FileName = "http://www.website.com/"
        IEprocess.StartInfo.UserName = username
        IEprocess.StartInfo.Password = password
        IEprocess.StartInfo.UseShellExecute = False
        IEprocess.Start() 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T02:06:54.183

如果您想登录网站，我认为最好使用 HTTP 的 POST 方法，并且您必须定义您的登录页面参数用户和密码（Php、ASP.Net、JAVA 推荐可以使用操作方法）。

```
Dim PostData As String = "define your action login" 'example https://login.yahoo.com/config/login_verify2?&.src=ym,username and Password parameters
    Dim bytes() As Byte = ASCIIEncoding.UTF8.GetBytes(PostData)
    Dim httpReg As HttpWebRequest = WebRequest.Create("http://www.website.com/")
    httpReg.Method = "POST"
    httpReg.KeepAlive = True
    httpReg.CookieContainer = mainCookie
    httpReg.ContentType = "application/x-www-form-urlencoded"
    httpReg.Referer = "http://www.website.com/index.html"
    httpReg.ContentLength = bytes.Length
    Dim DtStream As Stream = httpReg.GetRequestStream()
    DtStream.Write(bytes, 0, bytes.Length)
    DtStream.Close()
    Dim httpResponse As HttpWebResponse
    httpResponse = httpReg.GetResponse()
    mainCookie.Add(httpResponse.Cookies)
    Dim reader As New StreamReader(httpResponse.GetResponseStream())
    Dim strSource As String = reader.ReadToEnd
    If strSource.Contains("Selamat Datang") Then
        MessageBox.Show("Sukses Login")
    Else
        MessageBox.Show("Gagal Login")
    End If 
```

[参考文章： http](http://tech.reboot.pro/showthread.php?tid=61) ://tech.reboot.pro/showthread.php?tid=61

# ruby-on-rails - 在辅助方法中打印数组

> ID：14762177
> 
> 赞同：1
> 
> 时间：2013-02-07T22:22:28.383
> 
> 标签：ruby-on-rails, arrays, printing

我是 Ruby-on-rails 的新手。我有一个非常简单的问题：这个在我的视图文件中有效：

```
- @posts.each do |child|
    = child.name
end 
```

但是，我无法创建一个将数组作为参数并使用“每个”对其进行迭代的辅助方法。

在我的视图文件中：

```
=f1(@posts) 
```

在我的帮助文件中：

```
def f1(abc)
    abc.each do |child|
            puts child.name
    end
end 
```

请帮我解决这个愚蠢的问题。非常感谢提前

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T22:27:21.913

这样的事情有用吗？

```
def f1(abc)
  output = ''
  abc.each do |child|
    output << "<br/> #{child.name}"
  end
  output
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T22:48:27.587

在运行的 rails 应用程序`puts`中，输出到日志文件中。

我建议尝试这种方法：

在帖子视图目录中创建一个“_post”部分，然后将要渲染的内容`post`用作对象（即：），然后在视图中`post.name`使用`render @posts`。这将自动渲染集合中每个对象的部分。

有关更多信息，请参阅[Ruby on Rails 布局和渲染指南](http://guides.rubyonrails.org/layouts_and_rendering.html)中的第 3.4.5 节

# python - 在 matplotlib 中将 y 轴标签添加到辅助 y 轴

> ID：14762181
> 
> 赞同：169
> 
> 时间：2013-02-07T22:22:37.140
> 
> 标签：python, matplotlib

我可以使用 将 y 标签添加到左侧 y 轴`plt.ylabel`，但是如何将其添加到辅助 y 轴？

```
table = sql.read_frame(query,connection)

table[0].plot(color=colors[0],ylim=(0,100))
table[1].plot(secondary_y=True,color=colors[1])
plt.ylabel('$') 
```

* * *

## 回答 #1

> 赞同：340
> 
> 时间：2013-02-07T22:52:14.123

最好的方法是直接与`axes`对象交互

```
import numpy as np
import matplotlib.pyplot as plt
x = np.arange(0, 10, 0.1)
y1 = 0.05 * x**2
y2 = -1 *y1

fig, ax1 = plt.subplots()

ax2 = ax1.twinx()
ax1.plot(x, y1, 'g-')
ax2.plot(x, y2, 'b-')

ax1.set_xlabel('X data')
ax1.set_ylabel('Y1 data', color='g')
ax2.set_ylabel('Y2 data', color='b')

plt.show() 
```

![示例图](../Images/148065230c6bc6dbc8427f350cf06fe6.png)

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2017-08-04T04:57:18.157

有一个简单的解决方案，不会弄乱 matplotlib：只是 pandas。

调整原始示例：

```
table = sql.read_frame(query,connection)

ax = table[0].plot(color=colors[0],ylim=(0,100))
ax2 = table[1].plot(secondary_y=True,color=colors[1], ax=ax)

ax.set_ylabel('Left axes label')
ax2.set_ylabel('Right axes label') 
```

基本上，当`secondary_y=True`给出选项时（即使`ax=ax`也传递了）`pandas.plot`返回一个不同的轴，我们用它来设置标签。

我知道这是很久以前回答的，但我认为这种方法值得。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-02-07T23:01:59.250

我现在无法访问 Python，但我想不到：

```
fig = plt.figure()

axes1 = fig.add_subplot(111)
# set props for left y-axis here

axes2 = axes1.twinx()   # mirror them
axes2.set_ylabel(...) 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2020-11-11T07:50:33.573

对于因为提到 pandas 而偶然发现这篇文章的每个人，您现在可以使用非常优雅和直接的选项直接访问pandas 中[的 secondary_y 轴](https://pandas.pydata.org/pandas-docs/stable/user_guide/visualization.html#plotting-on-a-secondary-y-axis)`ax.right_ax`

因此，解释最初发布的示例，您将编写：

```
table = sql.read_frame(query,connection)

ax = table[[0, 1]].plot(ylim=(0,100), secondary_y=table[1])
ax.set_ylabel('$')
ax.right_ax.set_ylabel('Your second Y-Axis Label goes here!') 
```

（这在这些帖子中也已经提到：[1](https://stackoverflow.com/a/58047785) [2](https://stackoverflow.com/a/18078496)）

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2021-04-14T11:25:32.153

带有少量 loc 的简单示例：

```
plot(y1)
plt.gca().twinx().plot(y2, color = 'r') # default color is same as first ax 
```

解释：

```
ax = plt.gca()    # Get current axis
ax2 = ax.twinx()  # make twin axis based on x
ax2.plot(...)     # ... 
```

# android - 在相对布局中将 TextView 对齐到 ImageButton 下方

> ID：14762186
> 
> 赞同：4
> 
> 时间：2013-02-07T22:22:42.003
> 
> 标签：android, android-layout

尽管我尝试了属性 android:gravity="center"，但在将图像按钮下方的文本视图居中对齐时遇到困难，前两个文本视图在相应图像按钮的中心对齐，但第三个没有很适合这里是我的 xml 代码：

```
<ImageView
    android:id="@+id/view"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"
    android:layout_centerHorizontal="true"
    android:scaleType="fitXY"
    android:background="@null"
    android:src="@drawable/imageview" />

<ImageButton
    android:id="@+id/recBook"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignLeft="@+id/textViewBook"
    android:layout_alignParentTop="true"
    android:layout_marginLeft="30dp"
    android:layout_marginTop="107dp"
    android:background="@null"
    android:scaleType="fitXY"
    android:src="@drawable/recipebook" />

<TextView
    android:id="@+id/textViewBook"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_below="@+id/recBook"
    android:layout_marginLeft="33dp"
    android:text="@string/BookTV"
    android:textAppearance="?android:attr/textAppearanceSmall" />

<ImageButton
    android:id="@+id/search"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_above="@+id/textViewBook"
    android:layout_marginLeft="60dp"
    android:layout_toRightOf="@+id/textViewBook"
    android:background="@null"
    android:scaleType="fitXY"
    android:src="@drawable/search" />

<TextView
    android:id="@+id/textViewSearch"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/textViewBook"
    android:layout_alignBottom="@+id/textViewBook"
    android:layout_marginLeft="37dp"
    android:layout_toRightOf="@+id/textViewBook"
    android:text="@string/Search"
    android:textAppearance="?android:attr/textAppearanceSmall" />

<ImageButton
    android:id="@+id/favorite"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignLeft="@+id/recBook"
    android:layout_centerVertical="true"
    android:background="@null"
    android:scaleType="fitXY"
    android:src="@drawable/favorites" />

<TextView
    android:id="@+id/textViewFav"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_="@+id/favorite"
    android:layout_alignLeft="@+id/textViewBook"
    android:layout_below="@+id/favorite"
    android:text="@string/FavTV"
    android:textAppearance="?android:attr/textAppearanceSmall" />

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-07T22:27:02.477

使用[RelativeLayout](http://developer.android.com/reference/android/widget/RelativeLayout.html)并使用它：

```
<TextView
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_below="@+id/imageButton"
    android:layout_centerInParent="true"
    android:text="text" /> 
```

# java - 在 JPA 实体中，如何定义 getter 上使用的 SQL？

> ID：14762189
> 
> 赞同：1
> 
> 时间：2013-02-07T22:22:59.027
> 
> 标签：java, jpa, eclipselink

我有一个名为 PetOwner 的实体。PetOwner 有一个宠物列表。每个宠物都有一个商店（即：这个宠物来自的商店）。Pet 是一个抽象类，获得一个具体版本会执行很多连接 ( `@Inheritance(strategy = InheritanceType.JOINED)`)。我想在 PetOwner 上有一个带有这个签名的方法：

```
Set<Store> getAllStores(); 
```

问题是加载宠物列表非常慢，实际上没有必要获取商店列表。当我打电话时`getAllStores`，我希望它像这样运行 SQL：

```
SELECT DISTINCT store_id
FROM pet
WHERE petowner_id = x; 
```

但如果我这样实现它：

```
Set<Stores> stores = //
for (pet : pets)
   stores.add(pet.getStore());
return stores; 
```

它会拉入所有宠物并且非常缓慢。那么我怎样才能防止它拉进所有的宠物呢？理想情况下，我确实希望在 PetOwner 对象上使用此方法，因为我认为这样的代码更加面向对象。

此外，在 PetOwner 中还有其他方法，即使速度很慢，我也确实需要加载宠物列表。但我并不总是调用它，这就是为什么我只想要这种方法来避免加载宠物列表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T23:34:08.980

我假设您有一项服务可以用来获取您的 PetOwners。我建议您在服务上创建一个新方法，而不是将您的方法添加到 PetOwner。

```
public Set<Stores> getStoresForOwner( PetOwner owner ); 
```

并使用您用于数据访问层的任何内容（hibernate 模板、Spring-data-jpa 存储库、EntityManager 直接）使用命名查询进行调用。

```
@NamedQuery(name="PetOwnerStore.findAll", query="SELECT distinct p.Store from Pet p where p.Owner.id = :petOwnerId"); 
```

可以说，由于您是从 Pet 中选择的，因此 JPA 可能无论如何都必须完成所有连接......

以上所有假设（除其他外，因为您没有提供任何实体映射） Pet 和 Store 之间的关系是惰性获取，因此尚未填充。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T12:29:16.107

没有标准的方法可以做到这一点，因为您没有映射此数据。我看到的不同选项是

1.  直接在 EM 上使用命名查询
2.  将方法添加到 PetOwner 接受 ENntityManager 并直接进行查询，或者
3.  向宠物主人添加一个临时列表，并将其填充到运行查询的加载后事件中。除非重新加载 PetOwner，否则这将无法看到更新。

# c# - 项目选择上的 WPF 调用函数（使用 MVVM 范例）

> ID：14762191
> 
> 赞同：0
> 
> 时间：2013-02-07T22:23:02.250
> 
> 标签：c#, wpf, data-binding, mvvm, mvvm-light

我有一个绑定到`ObservableCollection`客户的列表框。用于此的 XAML 代码是：

```
<ListBox x:Name="lb_Customers" Height="683" ItemsSource="{Binding Path=Customers, UpdateSourceTrigger=PropertyChanged}">
     <ListBox.ItemTemplate>
          <DataTemplate>
               <Label Margin="0,0,0,0" Padding="0,0,0,0" Content="{Binding Name}" />
          </DataTemplate>
      </ListBox.ItemTemplate>
</ListBox> 
```

这指向了我`MainViewModel`课堂上的一些代码：

```
public ObservableCollection<Customer> Customers
{
    get { return _customers; }
    set
    {
        Set("Customers", ref _customers, value);
        this.RaisePropertyChanged("Customers");
    }
} 
```

当我在此列表框中选择客户时，我想执行一些代码来编译客户的订单历史记录。

但是，我不知道如何使用 DataBinding/CommandBinding 来做到这一点。

我的问题：*我什至从哪里开始？*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T22:28:51.100

您可以将“当前选定”对象添加到您的视图模型并将其绑定到列表框的“SelectedItem”属性。然后在“set”访问器中执行您想要的操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T23:05:07.590

正如托蒙德建议的那样：

改变

```
<ListBox x:Name="lb_Customers" Height="683" ItemsSource="{Binding Path=Customers, UpdateSourceTrigger=PropertyChanged}"> 
```

到

```
<ListBox x:Name="lb_Customers" Height="683" ItemsSource="{Binding Path=Customers, UpdateSourceTrigger=PropertyChanged}", SelectedValue="{Binding SelectedCustomer}"> 
```

然后在您的 ViewModel 中添加：

```
private Customer _selectedCustomer;
public Customer SelectedCustomer
{
    get {}
    set
    {
        if (_selectedCustomer != value)
        {
            Set("SelectedCustomer", ref _selectedCustomer, value);
            this.RaisePropertyChanged("SelectedCustomer");

            // Execute other changes to the VM based on this selection...
        }
    }
} 
```

# networking - 获取 IPv6 标头的确切大小，包括扩展标头

> ID：14762193
> 
> 赞同：0
> 
> 时间：2013-02-07T22:23:11.493
> 
> 标签：networking, ipv6, ipv4, istream, icmp

如果 IPv4 存在问题并且我想从 std::istream 中提取 IP 和 ICMP 标头，首先我得到最初的 20 个字节，然后检查 IPv4 标头中提供的标头长度是否大于 20 个字节，以便提取任何选项。下一个字节是 ICMP 数据包。使用 IPv4 标头中携带的标头长度值，我可以看到 IP 标头的预期大小。

但是如何获得 IPv6 标头的确切大小？IPv6 标头中有一个有效负载值，其中包括标头扩展的大小以及 ICMP 等更高级别的数据。我需要知道 IPv6 标头的大小，包括标头扩展但没有更高级别的数据，以便知道 ICMPv6 标头在 std::istream 中的哪个位置开始。

谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-08T00:08:55.397

IPv6 标头的大小固定为 40 字节 - 尽管您知道在初始 IPv6 标头之后可能有扩展，它们不是传输层数据报的一部分。要确定 IPv6 标头后面是否有标头扩展，请检查“下一个标头”字段。存储在此字段中的值将告诉您下一个标头是传输级别标头（IE TCP/UDP 标头）、IP 级别标头扩展（IE ICMP）还是介于两者之间的任何标头。[此列表](http://en.wikipedia.org/wiki/List_of_IP_protocol_numbers)列出了下一个标头字段的所有可能值。

一旦确定下一个标头的类型，您就可以相应地处理它 - 所有扩展标头的第一个字节应该是“下一个标头”字段，以便它们可以链接在一起，如果扩展标头是可变长度的第二个字节应该是“hdr ext field”，可用于确定其大小。

# java - 带有 2 个类和外部库的 JAVA 编译问题

> ID：14762195
> 
> 赞同：1
> 
> 时间：2013-02-07T22:23:17.857
> 
> 标签：java, compiler-errors

尝试在 Windows 的命令提示符中编译时遇到编译问题。我的目录设置如下 我在 src 目录中有我的 .java 文件（Main.java & getSource.java） 我在 src 的子目录中有一个 .jar 文件（./lib/jsoup.jar）

当我尝试编译时

```
C:\src> javac -cp ".;/lib/*" Main.java 
```

但我明白了

```
.\getSource.java:1: error: package org.jsoup does not exist
import org.jsoup.Jsoup;
                ^
.\getSource.java:2: error: package org.jsoup.nodes does not exist
import org.jsoup.nodes.Document; 
```

我不确定我哪里出错了。

我通过 eclipse 编写了这个应用程序，它在 eclipse 中编译得很好，但是当我尝试通过命令行执行它时它不起作用。

另外，我碰巧找到了 Eclipse 编译的 .class 并尝试使用

```
java Main 
```

但它仍然给我一个相关的错误

```
Exception in thread "main" java.lang.NoClassDefFoundError: org/jsoup/Jsoup
        at getSource.<init>(getSource.java:20)
        at Main.main(Main.java:10)
Caused by: java.lang.ClassNotFoundException: org.jsoup.Jsoup
        at java.net.URLClassLoader$1.run(Unknown Source)
        at java.net.URLClassLoader$1.run(Unknown Source)
        at java.security.AccessController.doPrivileged(Native Method)
        at java.net.URLClassLoader.findClass(Unknown Source)
        at java.lang.ClassLoader.loadClass(Unknown Source)
        at sun.misc.Launcher$AppClassLoader.loadClass(Unknown Source)
        at java.lang.ClassLoader.loadClass(Unknown Source)
        ... 2 more 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T22:36:31.037

尝试

`C:\src> javac -cp .;lib/* Main.java`

参考：了解[http://docs.oracle.com/javase/6/docs/technotes/tools/windows/classpath.html](http://docs.oracle.com/javase/6/docs/technotes/tools/windows/classpath.html)中的 **类路径通配符**

要运行程序，请使用**java**命令，如下所示

`C:\src> java -cp .;lib/* Main`

# regex - sed（或 awk）正则表达式替换匹配的子字符串

> ID：14762196
> 
> 赞同：2
> 
> 时间：2013-02-07T22:23:26.150
> 
> 标签：regex, sed, awk

我有一个包含以下内容的文本文件（“file.txt”）：

```
#   disutil_screening = 0.00000; # favorable
    disutil_screening = 0.00009; # base
#   disutil_screening = 0.00019; # unfavorable 
```

我需要切换使用 GNU Sed 注释掉这 3 行中的哪一行（“有利”、“基础”或“不利”）。

我知道我可以将“有利”行与如下代码匹配（作为一个虚拟示例，我只是将文本替换为“aaa”）：

```
$ cat file.txt | sed -r 's/#[\t]disutil_screening[\ =0-9\.;]+# favorable/aaa/'
aaa
    disutil_screening = 0.00009; # base
#   disutil_screening = 0.00019; # unfavorable 
```

但是，这个示例 Sed 语句显然与我真正想要的相去甚远。我需要一个只会删除前导“#”的 Sed 表达式。也就是说，我需要一个 Sed 表达式`$EXPR`（

```
$ cat file.txt | sed -r $EXPR
    disutil_screening = 0.00000; # favorable
    disutil_screening = 0.00009; # base
#   disutil_screening = 0.00019; # unfavorable 
```

一旦我知道如何做到这一点（用“”替换“有利”行的前导“#”），那么我相信我可以弄清楚如何在“base”行中添加“#”（即注释掉行目前没有被注释掉）。

**注意**：我愿意在这项任务中使用 awk 而不是 sed，但我对 awk 有点害怕，以前从未使用过它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-07T22:29:19.590

我认为你需要的是所谓的分组。试试这个：

```
$ cat file.txt | sed -r 's/#([\t]disutil_screening[\ =0-9\.;]+# favorable)/\1/' 
```

我将所有匹配项（期望第一个评论字符）包装到组中，然后用该组替换整个匹配项，以便删除第一个字符。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-07T22:33:26.833

这就是我想出的。注意， -i 使替换内联（即您的原始文件将被更改）。

```
$ sed -i 's/^#\(.*# favorable\)$/ \1/' text.txt 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-08T01:43:54.057

使用 awk

```
awk -F= '$2 ~ / favorable/{sub("#","")}1' temp.txt 
```

输出

```
 disutil_screening = 0.00000; # favorable
    disutil_screening = 0.00009; # base
#   disutil_screening = 0.00019; # unfavorable 
```

# php - 在while php循环中提交表单

> ID：14762198
> 
> 赞同：0
> 
> 时间：2013-02-07T22:23:27.717
> 
> 标签：php, html, forms, loops, if-statement

我正在尝试在这里运行我的代码，但是当我按下**Send**按钮时，它都以某种方式**同时运行 Approve 和 Send**。我认为这种情况正在发生，因为这是在一个 while 循环内，但我只想在它的 presend 和 Approve 相同的情况下执行 Send 函数。欢迎所有建议。

干杯！;)

```
<?php 
//0 = No presentation
//1 = Presentation under review
//2 = Presentation approved
//3 = Presentation declined

//GET ALL PRESENTATIONS WHICH NEEDS TO BE APPROVED APPROVED
while($presentation_unapproved = mysql_fetch_array($approve_presentation)){

$display_user_id_presentation = mysql_real_escape_string($presentation_unapproved['profile_user_id']);
$display_presentation_id = mysql_real_escape_string($presentation_unapproved['profileid']);
//Här går vi in i users tabellen och hämtar all nödvändig information om själva användaren
$who_is_user_unapp = mysql_query("SELECT id, s_id, user_name, gender, user_age, profile_image_url, country FROM users WHERE id='$display_user_id_presentation'");
$who_is_user_show_unapp = mysql_fetch_array($who_is_user_unapp);

if (isset($_POST[$presentation_unapproved['profileid']]) == 'Send') 
            {
                $what_reason = $_POST['decline_reason'];
                echo $what_reason;
            }

//Approve presentation
    if (isset($_POST[$presentation_unapproved['profileid']]) == 'Approve') 
            {
                //$presid_number = mysql_real_escape_string($presentation_unapproved['profileid']);
                //mysql_query("UPDATE profile_info SET profile_text_approved='2' WHERE profileid='$presid_number'");
                //header('Location: '.selfURL());       
                echo "this should not be output";
            }

?>

<div class="main">
<div class="main_left">
    <div class="inside">
        <div class="inside_left">
            <img src="<?php echo $path_90_120_image;?><?php echo $who_is_user_show_unapp['profile_image_url'];?>">
            <br>
            <b><?php echo $who_is_user_show_unapp['user_name'];?></b><br>
                <?php echo $who_is_user_show_unapp['country'];?><br><br>
        </div>
        <div class="inside_right"><?php echo $presentation_unapproved['profile_text'];?></div>
    </div>
</div>
<div class="main_right">
    <form method="post" action="">
    <input type="submit" class="approve" value="Approve" name="<?php echo $presentation_unapproved['profileid'];?>"><br>
    <input type="submit" class="decline" value="Decline"><br>
    <input type="submit" class="warning" value="Warn user"><br>
    <b>

    <?php

    $words = $presentation_unapproved['profile_text'];
    print_r( strlen($words) );
    ?> chars written</b>
    <br><br>
    <div id="panel">
        <b>Decline reason</b>
        <?php 
        //Get all decline reasons
        $decline_reasons = mysql_query("SELECT * FROM admin_messages_default WHERE category = 'Presentation'");
        ?>
        <br><br>
        <select name="decline_reason">
            <?php
            while($decline_reasons_view = mysql_fetch_array($decline_reasons)) {

            ?>
            <option value="<?php echo $decline_reasons_view['id'];?>"><?php echo $decline_reasons_view['title'];?></option>
            <?php } ?>
        </select>   <br><br>
        <input type="submit" value="Send" name="<?php echo $presentation_unapproved['profileid'];?>">
    </div>
    </form>
</div> 
```

```
<?php } ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T22:31:03.940

这不是你想的那样：

`isset($_POST[$presentation_unapproved['profileid']]) == 'Approve'`

`isset`在这种情况下返回 a `bool`，所以如果它有任何东西，我想它会返回 true，那么你`==`可能`'Approve'`会“逻辑上”为 true。

您可能想要检查它是否已设置（一次），然后根据字符串比较更改行为。所以，像这样：

```
if (isset($_POST[$presentation_unapproved['profileid']])) {
  if (strcmp($_POST[$presentation_unapproved['profileid'], "Send") {
    ...
  } else if (strcmp($_POST[$presentation_unapproved['profileid'], "Approve") {
    ....
  }
} 
```

# java - AES加密算法，并行编程，java

> ID：14762202
> 
> 赞同：-2
> 
> 时间：2013-02-07T22:23:33.627
> 
> 标签：java, aes

我有一个和朋友一起写的项目，但我们遇到了线程问题。代码选择一个文件，对其进行加密或解密并将其写入一个文件（每个文件 pdf、docx、mpeg、mkv 等）。

选择，用 RandomAccessFile 打开一个输入和输出对象，

```
byte[] temp new byte[16];
readedByte=1;
while(16*readedByte<fileLenght){
                for(i=0;i<16;i++){
                temp[i]=input.readByte();
                }
                byte[] newTemp=AES.encrypt(temp, k.getBytes("ISO-8859-9"));
                output.write(newTemp);
                readedByte++;
            } 
```

我想写一个线程来完成这项工作。线程将读取 16 个字节，加密它们并写入输出对象。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T22:28:07.340

只需将您的方法放在运行中。并尝试对其进行调整以解决您的问题

```
Thread thread = new Thread(new Runnable() {

            @Override
            public void run() {
                byte[] temp = new byte[16];
                int readedByte = 1;
                while(16 * readedByte < fileLenght) {

                    for(int i = 0; i < 16; i++) {
                        temp[i] = input.readByte();
                    }
                    byte[] newTemp = AES.encrypt(temp, k.getBytes("ISO-8859-9"));
                    output.write(newTemp);
                    readedByte++;
                }

            }
        });
        thread.start(); 
```

# magento - 基于商店模式的 Magento 动态内容

> ID：14762209
> 
> 赞同：0
> 
> 时间：2013-02-07T22:24:04.187
> 
> 标签：magento

在我正在使用的线框中，主页上有三个 div。这些 div 的内容需要根据 store 模式而改变。例如，美国版本的网站将在每个 div 中显示与欧洲版本不同的内容。IE

* * *

美国网站

欢迎使用 bob 小部件

[美国内容 1] [美国内容 2] [美国内容 3]

* * *

欧元网站

欢迎使用 bob 小部件

[ 欧元含量 1 ] [ 欧元含量 2] [ 欧元含量 3 ]

* * *

根据我对静态块的理解，这些指向单个内容条目。因此，如果里面的内容需要根据站点模式进行更改，那么拥有 home_content_1、home_content_2 等就不会那么好用。

我想做的是类似的事情。“获取这个国家/商店的所有‘主页功能’内容，在一个 div 中显示”

（PS 我是 Magento Noob，但不是 noob 开发人员，尽管这个问题的非技术性质 :)）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T07:30:41.403

创建静态块时，您可以将它们附加到商店视图。

为每个商店创建一个块 home_content_1_storecode。

然后你只需要调用在 php 中添加 storecode 的块，它会根据你所在的商店调用正确的块。

如果您不为每个商店使用相同的设计模板，您还可以使用 phtml 来展示您的街区。每个商店都有自己的街区。

# c# - ServiceStack DELETE 请求是默认对象，POST 工作正常

> ID：14762211
> 
> 赞同：7
> 
> 时间：2013-02-07T22:24:21.063
> 
> 标签：c#, servicestack

我有一个来自 Javascript 客户端的 DTO。当我尝试发送`deleteFromService`请求对象为空时（看起来它只是新的）。如果我将方法更改为`postToService`请求对象，则会正确填充。

我正在使用 3.9 API。我在这里不知所措。

服务：

```
public object Post(Order request)
{
    return _orderRepository.InsertOrder(request);
}

public object Delete(Order request)
{
    _orderRepository.DeleteOrder(request.Uuid);
    return true;
} 
```

JS：

```
//Fails
serviceClient.deleteFromService("order", order, function () { }, deleteFailed);
//Works
serviceClient.postToService("order", order, function () { }, deleteFailed); 
```

* * *

**更新：**

我在[ServiceStack 源代码](https://github.com/ServiceStack/ServiceStack/blob/master/src/ServiceStack/WebHost.Endpoints/Support/EndpointHandlerBase.cs#L60)中发现了这个问题。它将 DELETE 视为 GET 并创建请求对象而不是正文，就像它为 POST 所做的那样。

```
if (httpMethod == HttpMethods.Get || httpMethod == HttpMethods.Delete || httpMethod == HttpMethods.Options)
{
    try
    {
        return KeyValueDataContractDeserializer.Instance.Parse(queryString, operationType);
    }
} 
```

这样做的问题在于，[ServiceStack JS 客户端](https://github.com/ServiceStack/ServiceStack/blob/master/release/latest/js/JsonServiceClient.js#L85)使用与 POST 相同的逻辑创建 DELETE 请求，通过将您发送的数据填充到正文中（技术上是 jQuery XHR`data`属性），这意味着服务器没有办法获取客户端发送的消息。

我读对了吗？JS客户端的delete坏了吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-31T15:11:56.093

我重写了客户端，在选项 var 初始化之前在函数`servicestack.js`中添加了以下行...`P.Send`

```
if (ajaxOptions.type === "DELETE") {
    requestUrl = requestUrl + "?" + decodeURIComponent($.param(request[webMethod]));
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-01T14:24:31.480

消息不应带有`DELETE`消息体，这意味着您只能在 url 中将参数传递给 DELETE 请求（即，如您要删除的对象的 ID）。因此，除了 ServiceStack 所做的之外，您永远不应该在 DELETE 请求中发送 DTO。

请参阅此相关问题：[HTTP DELETE 请求是否允许实体主体？](https://stackoverflow.com/questions/299628/is-an-entity-body-allowed-for-an-http-delete-request)

# java - Mac OS 中的 Java 弹出菜单

> ID：14762212
> 
> 赞同：5
> 
> 时间：2013-02-07T22:24:35.327
> 
> 标签：java, macos, swing

当用户右键单击我的 JTable 时，我正在尝试显示 JPopUpMenu。在我扩展 JTable 的类中，我调用以下代码：

```
addMouseListener(new MouseAdapter()
    {
        @Override
        public void mouseReleased(MouseEvent e)
        {
            rowClicked = rowAtPoint(e.getPoint());
            colClicked = columnAtPoint(e.getPoint());
            if (e.isPopupTrigger())
            {
                popUpMenu.show(e.getComponent(), e.getX(), e.getY());
            }
        }

        @Override
        public void mouseClicked(MouseEvent e)
        {
            rowClicked = rowAtPoint(e.getPoint());
            colClicked = columnAtPoint(e.getPoint());

            if(e.isPopupTrigger())
            {
                popUpMenu.show(e.getComponent(), e.getX(), e.getY());
            }
        }
    }); 
```

每当我用鼠标右键单击触控板或使用 ctrl + 右键单击​​时，`if(e.isPopupTrigger())`永远不会评估为 true，并且永远不会显示菜单。我在那里有断点来验证。

我在网上做了一些研究，似乎这个解决方案应该有效。由于右键单击取决于平台，因此使用 isPopupTrigger() 应该是要走的路。

自从我使用 Mac 以来，有什么特别的事情吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-07T22:46:34.547

这个简单的例子对我有用，也许它会帮助你找到你的问题。我在 Mac 上，使用 Java 7。

![在此处输入图像描述](../Images/9787f63903caa8be0390b403e54d2e19.png)

```
public static void main(String[] args)
{
    JFrame frame = new JFrame();
    JPanel panel = new JPanel();

    String columnNames[] = { "Column 1", "Column 2", "Column 3" };

    String dataValues[][] = { { "12", "234", "67" }, { "-123", "43", "853" }, { "93", "89.2", "109" }, { "279", "9033", "3092" } };
    JTable table = new JTable(dataValues, columnNames);

    panel.add(table);

    final JPopupMenu menu = new JPopupMenu();
    JMenuItem item = new JMenuItem("item");
    menu.add(item);
    table.setComponentPopupMenu(menu);

    table.addMouseListener(new MouseAdapter()
    {
        @Override
        public void mouseReleased(MouseEvent e)
        {
            if (e.isPopupTrigger())
            {
                menu.show(e.getComponent(), e.getX(), e.getY());
            }
        }

        @Override
        public void mouseClicked(MouseEvent e)
        {
            if (e.isPopupTrigger())
            {
                menu.show(e.getComponent(), e.getX(), e.getY());
            }
        }
    });

    frame.setContentPane(panel);
    frame.pack();
    frame.setVisible(true);
} 
```

# php - 本地主机上的 .htaccess 网址

> ID：14762213
> 
> 赞同：-1
> 
> 时间：2013-02-07T22:24:35.497
> 
> 标签：php, .htaccess, localhost

我的 .htaccess 文件有一个小问题。它确实有效，但不知何故不能 100% 有效。我正在寻找一种根据 url 构建网站的方法。因此，例如“example.com/en/home”将是主页。问题是我只能在 url 是这样的时候让它工作：'example.com/index/en/home'

我在 .htaccess 文件中的代码是：

```
RewriteEngine on
RewriteBase /htaccess/

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

RewriteRule ^(.*)$ index.php/$1 
```

领域：

```
localhost/~axll/htaccess/ 
```

根文件夹位于 htaccess 下的 localhost（Mac 的 xampp）上。如果我理解正确，它应该将 'en/home' 附加到索引文件中，所以我应该能够将 'index' 部分留在 url 中，对吗？

编辑 1：我在 php 中使用了 $_SERVER['PATH_INFO'] 并返回以下内容：

```
Array ( [0] => [1] => php [2] => test ) 
```

数组的索引不应该与NULL不同吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T22:32:00.287

也许在您的主机配置中您设置**了 AllowOverride None**？它将禁用 .htaccess 文件

将其更改为 AllowOverride **All**以启用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T09:10:14.263

我想我解决了这个问题。我找不到任何错误，所以我只是重新安装了我的本地主机，它就成功了。感谢大家的帮助！

# objective-c - 如何在Objective-C中按照定义的顺序枚举字典

> ID：14762224
> 
> 赞同：1
> 
> 时间：2013-02-07T22:25:36.900
> 
> 标签：objective-c, nsdictionary, enumeration

是否可以按定义键值的顺序枚举 NSDictionary？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T22:27:25.493

没有内置的方法可以做到这一点。您必须将订单存储为添加对象的属性或使用 NSNumber 作为键。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T22:28:00.937

没有。从文档中：

> allKeys 返回一个包含字典键的新数组。
> 
> *   (NSArray *)allKeys 返回值 包含字典键的新数组，如果字典没有条目，则为空数组。
> 
> 讨论 未定义数组中元素的顺序。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-03-22T10:51:48.533

您可以做到这一点的唯一方法是首先创建一个键数组。然后使用该数组，对其进行迭代以创建字典。字典没有任何固有的顺序概念。

# matlab - MATLAB - 使用 fm demod 解码数据

> ID：14762226
> 
> 赞同：2
> 
> 时间：2013-02-07T22:25:52.543
> 
> 标签：matlab

我正在尝试提取一个正弦曲线，它本身具有正弦变化的速度。this 的形式大约是 sin (a(sin(b*t)))，a+b 是常数。

这是我目前正在尝试的，但是它并没有像我希望的那样给我一个很好的罪孽图。

```
Fs = 100; % Sampling rate of signal
Fc = 2*pi; % Carrier frequency
t = [0:(20*(Fs-1))]'/Fs; % Sampling times
s1 = sin(11*sin(t)); % Channel 1, this generates the signal
x = [s1]; 
dev = 50; % Frequency deviation in modulated signal
z = fmdemod(x,Fc,Fs,fm); % Demodulate both channels.
plot(z); 
```

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T01:30:34.030

1.  您的代码中有一个错误，而不是：

    ```
    z = fmdemod(x,Fc,Fs,fm); 
    ```

你应该有：

```
z = fmdemod(x,Fc,Fs,dev); 
```

还要看到一个漂亮的正弦图，您需要绘制`s1`.

看起来您没有创建正确调制的 FM 信号，因此您也无法使用`fmdemod`. 这是一个正确执行此操作的示例：

```
 Fs = 8000; % Sampling rate of signal
 Fc = 3000; % Carrier frequency
 t = [0:Fs]'/Fs; % Sampling times
 s1 = sin(2*pi*300*t)+2*sin(2*pi*600*t); % Channel 1
 s2 = sin(2*pi*150*t)+2*sin(2*pi*900*t); % Channel 2
 x = [s1,s2]; % Two-channel signal
 dev = 50; % Frequency deviation in modulated signal
 y = fmmod(x,Fc,Fs,dev); % Modulate both channels.
 z = fmdemod(y,Fc,Fs,dev); % Demodulate both channels. 
```

如果您发现这些答案有用，您可以同时投票并接受它们，谢谢。

# c# - 将 asp.net 应用程序与 quickbooks 桌面版集成

> ID：14762229
> 
> 赞同：2
> 
> 时间：2013-02-07T22:26:38.253
> 
> 标签：c#, desktop, quickbooks

我有一个 asp.net 应用程序，我想将它连接到 quickbooks 桌面版，在 web 应用程序中我想做以下事情： 1- 从 quickbooks 获取客户列表。2-创建新发票并保存发送到quickbooks。

这是我在示例代码中找到的，但我想知道我必须在 (sessionManager.BeginSession("", ENOpenMode.omDontCare);) 中的 AppId 参数中设置的值是多少。

```
private void getCustomers()
{
bool sessionBegun = false;
        bool connectionOpen = false;
        QBSessionManager sessionManager = null;

        try
        {
            //Create the session Manager object
            sessionManager = new QBSessionManager();

            //Create the message set request object to hold our request
            IMsgSetRequest requestMsgSet = sessionManager.CreateMsgSetRequest("US", 8,      0);
            requestMsgSet.Attributes.OnError = ENRqOnError.roeContinue;

            //Connect to QuickBooks and begin a session
            sessionManager.OpenConnection(@"D:\A to Z Wholesale Inc.QBW", "QuickBooks Integration Demo");
            connectionOpen = true;
            sessionManager.BeginSession("", ENOpenMode.omDontCare);
            sessionBegun = true;

            ICustomerAdd customerAddRq = requestMsgSet.AppendCustomerAddRq();
            customerAddRq.Name.SetValue("Amer");
            ICustomerQuery customer = requestMsgSet.AppendCustomerQueryRq();
            //Send the request and get the response from QuickBooks
            IMsgSetResponse responseMsgSet = sessionManager.DoRequests(requestMsgSet);
            IResponse response = responseMsgSet.ResponseList.GetAt(0);
            ICustomerRet customerRet = (ICustomerRet)response.Detail;
        }
        catch (Exception ex)
        {

        }
        finally
        {
            //End the session and close the connection to QuickBooks
            if (sessionBegun)
            {
                sessionManager.EndSession();
            }
            if (connectionOpen)
            {
                sessionManager.CloseConnection();
            }
        } 
```

}

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-07T22:54:09.140

您使用 COM 的方法可能行不通。

QuickBooks SDK/API 有点愚蠢，因为它使用 Windows COM GUI 消息泵来完成与 QuickBooks 实际通信的肮脏工作。这意味着*必须*存在 Windows GUI 才能与 QuickBooks 进行数据交换。

这对您来说将是一个问题，因为您正在构建一个 Web 应用程序......它将在 IIS 内部运行，因此没有可用的 Windows GUI 会话。

**如果您正在构建一个 SaaS 应用程序，那么目标是允许多个其他人将他们的 QuickBooks 文件连接到您的 Web 应用程序：**

考虑查看[Intuit 合作伙伴平台/Intuit Anywhere](http://developer.intuit.com/ipp.html)。请注意，这仅适用于 SaaS 类型的应用程序。基本思想是人们将他们的 QuickBooks 数据文件同步到 Intuit 的云中，然后您可以使用 REST Web 服务来交换数据。

Intuit 甚至有一些有用[的 DevKit](https://ipp.developer.intuit.com/0010_Intuit_Partner_Platform/0200_DevKits_for_Intuit_Partner_Platform)，它们提供了一些示例代码和对象/方法来进行数据交换。

**否则，如果您不采用 Intuit Anywhere 路线，请查看 QuickBooks Web 连接器：**

QuickBooks Web 连接器的全部意义在于支持您正在做的集成。

[这是QuickBooks Web 连接器](http://wiki.consolibyte.com/wiki/doku.php/quickbooks_web_connector)的一个很好的概述。它基本上是 QuickBooks 原生理解的 qbXML 模式的简单 SOAP 包装器。

如果您下载[QuickBooks SDK](https://ipp.developer.intuit.com/0085_QuickBooks_Windows_SDK/010_qb/0020_Get_Set_Up/SDK_Downloads)，此文件夹中有一些示例代码：C:\Program Files (x86)\Intuit\IDN\QBSDK12.0\samples\qbdt

那里有 Web 连接器的 .NET 示例代码，应该会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T22:37:45.160

**我建议您查看下面的[@Keith Palmer Jr. 的回答](https://stackoverflow.com/a/14762636/12744)，它比这个更有帮助。我不能删除这个，因为它被接受了。**

原答案：

我找到了这个网页：[QuickBooks Integration (Mad Computer Scientist)](http://www.mad-computer-scientist.com/blog/2008/03/25/quickbooks-integration/)

它说你可以使用任何东西：

> 打开连接时，您需要指定应用程序标识 ID 和名称。这将在 QuickBooks 中显示给用户以允许/禁止访问。这些是字符串，据我所知，不会运行任何检查，允许用户将他们关心的任何内容放在这里。

“向用户显示”位意味着如果您在 ASP.NET 服务器上使用它，您可能需要使用 AutoIt 或类似工具来关闭对话框！

# python - 用于 64 位 Windows 上的 Python 2.7 的 NumPy

> ID：14762248
> 
> 赞同：3
> 
> 时间：2013-02-07T22:27:51.843
> 
> 标签：python, windows, numpy, 64-bit

我一直在尝试在 Windows 64 位上获取 Python 2.7 的 NumPy，但是每个人都提到的页面[http://www.lfd.uci.edu/~gohlke/pythonlibs/没有在我的任何设备上打开。](http://www.lfd.uci.edu/~gohlke/pythonlibs/)

在其他地方我可以找到它吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-09T03:54:26.993

我建议[WinPython](http://winpython.sourceforge.net/)，一个适用于 Windows 的 Python 2.7 发行版，有 32 位和 64 位版本。

[WinPython 创建者的这篇博](http://spyder-ide.blogspot.fr/2012/08/scientific-python-distribution-for.html)文解释了为什么通常很难找到 64 位 Windows NumPy：

> 根据经验丰富的开发人员的说法，Windows 64 位平台没有像样的开源（免费）Fortran 编译器。因此，仅使用免费和开源工具在这个平台上构建 NumPy 或 SciPy 是不可能的。这就是为什么这两个库没有官方的 Windows 64 位二进制文​​件的原因。唯一可用的现成安装程序是由 Christoph Gohlke 准备的（使用 Intel Fortran 编译器，又名“ifort”），这些显然是非官方的二进制文件。此外，Christoph 为 NumPy 构建了两种不同的安装程序：一种未优化，另一种使用英特尔数学内核库 (MKL) 进行了优化，从而提供了更好的性能。Gohlke 的 SciPy 64 位二进制包（唯一可在线免费获得的包）需要 NumPy MKL。问题在于，根据 Christoph Gohlke 的说法，MKL 许可证不允许我（或其他任何人）重新分发这些二进制文件，除非我已经购买了这样的许可证。我仍然不清楚最终用户是否也需要此许可证。希望没有。让我们假设。此外，在仔细阅读英特尔 MKL 许可条款后，我很确定我可以重新分发基于 MKL 构建的 NumPy，因为它只是运行时重新分发。所以我想我会购买一个英特尔 Fortran 编译器许可证（包括 MKL），以便能够在不久的将来重建 NumPy 和 SciPy，但同时我将重新分发由 Christoph Gohlke 构建的包。此外，在仔细阅读英特尔 MKL 许可条款后，我很确定我可以重新分发基于 MKL 构建的 NumPy，因为它只是运行时重新分发。所以我想我会购买一个英特尔 Fortran 编译器许可证（包括 MKL），以便能够在不久的将来重建 NumPy 和 SciPy，但同时我将重新分发由 Christoph Gohlke 构建的包。此外，在仔细阅读英特尔 MKL 许可条款后，我很确定我可以重新分发基于 MKL 构建的 NumPy，因为它只是运行时重新分发。所以我想我会购买一个英特尔 Fortran 编译器许可证（包括 MKL），以便能够在不久的将来重建 NumPy 和 SciPy，但同时我将重新分发由 Christoph Gohlke 构建的包。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T22:57:21.847

I don't know where else to find it but I'd like to mention that it actually isn't that difficult to build yourself, if you have the numpy source and a MSVC compiler.

Numpy builds using the python distutils package and as such deals with manifest files. If you are using VC9 then you can probably go right ahead.

I did this today using the VC10 compiler, and as such had to alter my distutils package (msvc9compiler.py) to not handle any manifests. I simply commented out those lines. Then before I built the package, I set the env var to point to my actual compiler:

```
set VS90COMNTOOLS=%VS100COMNTOOLS%
c:\python27_64\python.exe setup.py build 
```

And after the build, I find the numpy package in the build folder.

Numpy complains a lot about ATLAS and BLAS and stuff, but in the end, you'll get a compiled numpy that will run the tests successfully.

# c# - 为什么我在这里遇到无法投射异常

> ID：14762252
> 
> 赞同：1
> 
> 时间：2013-02-07T22:27:59.627
> 
> 标签：c#, oop

这是代码：

```
interface IA
{
}

interface IC<T>
{
}

class A : IA
{
}

class CA : IC<A>
{
}

class Program
{
    static void Main(string[] args)
    {
        IA a;
        a = (IA)new A();    // <~~~ No exception here

        IC<IA> ica;

        ica = (IC<IA>)(new CA()); // <~~~ Runtime exception: Unable to cast object of type 'MyApp.CA' to type 'MyApp.IC`1[MyApp.IA]'.
    }
} 
```

为什么我在代码的最后一行得到强制转换异常？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T22:52:04.763

您需要声明`IC`演员`interface IC<out T>`才能工作。这告诉编译器`IC<A>`可以分配给类型为 的变量`IC<IA>`。

请参阅[此页面](http://tomasp.net/blog/variance-explained.aspx)以获取说明。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T22:41:11.190

你可以做

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace ConsoleApplication1
{
    interface IPerson
    {
    }

    //Have to declare T as out
    interface ICrazy<out T>
    {
    }

    class GTFan : IPerson
    {
    }

    class CrazyOldDude : ICrazy<GTFan>
    {
    }

    class Program
    {
        static void Main(string[] args) {
            IPerson someone;
            someone = (IPerson)new GTFan();    // <~~~ No exception here

            ICrazy<GTFan> crazyGTFanatic;
            ICrazy<IPerson> crazyPerson;

            crazyGTFanatic = new CrazyOldDude() as ICrazy<GTFan>;

            crazyGTFanatic = (ICrazy<GTFan>)(new CrazyOldDude());

            crazyPerson = (ICrazy<IPerson>)crazyGTFanatic;
        }
    }
} 
```

# javascript - Javascript 密码 - 记住用户的输入

> ID：14762254
> 
> 赞同：0
> 
> 时间：2013-02-07T22:28:01.357
> 
> 标签：javascript, password-protection

我下面的 JS 密码脚本：

```
<SCRIPT language="JavaScript">
var password;
var pass1="hello";
password=prompt('Please enter your password to view this page!',' ');
if (password==pass1 )
alert('Password Correct! Click OK to enter!');
else
{
window.location="test.html";
}
</SCRIPT> 
```

我希望用户输入密码后在弹出框中记住密码，无论是对还是错。

甚至......如果用户输入了正确的密码，页面会“记住”（cookie）用户已经成功并且在浏览器关闭之前不会再次要求输入密码。

我希望这是有道理的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T22:34:31.730

您可以通过以下方式将授权状态存储在 cookie 中：

```
document.cookie = 'authorized=1'; 
```

然后检查它：

```
if (document.cookie.match(/\bauthorized=1\b/))
{
    //do something
} 
```

# c# - 正确打印二维数组？

> ID：14762256
> 
> 赞同：2
> 
> 时间：2013-02-07T22:28:08.583
> 
> 标签：c#, multidimensional-array

目前正在为课堂编写 C# 中的康威生活。我一直在采取一些小步骤来学习语言和游戏编程，并且在打印我的 2D 字符数组时遇到了障碍。目前我正在使用 GetLength - 1 来不超过界限，但它无法打印出数组中的最后一个字符。

我的初始文件是什么样的

```
 +*++
 ++*+
 **** 
```

读入后放入 Char （我相信）

```
 *  
  * 
**** 
```

最终打印了什么

```
 *

**

using System;
using System.IO;
using System.Collections.Generic;
using System.Text;

namespace ConwaysLife
{
    class Program
    {
        static char[,] universe;
        static void bigBang(int h, int w, List<string> grid)
        {
            universe = new char[h,w];

            int row = 0;

            foreach (string line in grid)
            {

                for (int i = 0; i < line.Length; i++)
                {
                    if (line.ToCharArray()[i] == '*')
                    {
                        universe[row, i] = '*';
                    }
                }
                row++;
            }
        }

         //How I'm attempting to print out my 2D char array
        static void offspring()
        {
            StringBuilder cellLine = new StringBuilder();
            for (int y = 0; y < universe.GetLength(1)-1; y++)
             {
                for (int x = 0; x < universe.GetLength(0)-1; x++)
                {
                    Console.Write(universe[y, x]);
                }
                Console.WriteLine();                
            }
            //pause
            Console.ReadLine();
        }

        static void Main(string[] args)
        {
            List<string> tempLine = new List<string>();

            //Console.WriteLine("File Path?");
            int width = 0;
            int height = 0;

            //read file into List
            using (StreamReader r = new StreamReader("life.txt"))
            {
                while (r.Peek() >= 0)
                {
                    tempLine.Add(r.ReadLine());

                    //compare current width to new width
                    if (tempLine[height].Length >= width) { width = tempLine[height].Length; }

                    //increase height when going to next row
                    height++;
                }
                bigBang(height, width, tempLine);
            }
            offspring();
        }
    }
} 
```

更新后代（）

```
static void offspring()
        {
            StringBuilder cellLine = new StringBuilder();
            for (int x = 0; x <= universe.GetLength(1); x++)
            {
                for (int y = 0; y <= universe.GetLength(0); y++)
                {
                    Console.Write(universe[x, y]);
                }
                Console.WriteLine();
            }
            //pause
            Console.ReadLine();
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T22:35:52.570

您的`offspring`函数中有一个错误。请注意，您在`bigBang`函数中正确执行此操作。

您正在循环 while `x < GetLength()-1`。您只需要`x < GetLength()`，因为不包括 when 的情况`x == GetLength()`。

一个类比循环：

```
for (i = 0; i < 4; i++) 
   Console.WriteLine(i); 
```

输出：

> 0
> 1
> 2
> 3

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T22:44:08.383

我不熟悉游戏原理，但你的`offspring`方法有问题。

```
y < universe.GetLength(1)-1 
```

这转换为`y < 3 - 1`or `y < 2`，使您的迭代从 y = 0 变为 1。

要修复，只需删除出现的两个`-1`.

```
 for (int y = 0; y < universe.GetLength(1); y++)
        {
            for (int x = 0; x < universe.GetLength(0); x++)
            { 
```

此外，当您访问`universe`.

```
Console.Write(universe[y, x]); 
```

在那里，您使用 y 变量访问行，使用 x 访问列。逆向应该像这样完成：

```
Console.Write(universe[x, y]); 
```

给出最终输出

```
++*
*+*
+**
++* 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-10T23:23:05.050

虽然我将深入研究为什么它没有按预期工作，但我只是在创建数组时将数组的大小传递给我的 offspring() 并在打印时使用这些值。一旦完成了那个小的改变，输出就会按预期出现。

```
 *  
  * 
**** 
```

# python - 如何在 Python 中从文本文件构建字典

> ID：14762269
> 
> 赞同：2
> 
> 时间：2013-02-07T22:29:14.537
> 
> 标签：python, text, dictionary, fileparsing

我有一个包含如下条目的文本文件：

```
JohnDoe

Assignment 9  
Reading: NO  
header: NO  
HW: NO  
Solutions: 0 
show: NO  
Journals: NO  
free: NO  
Finished: NO  
Quiz: 0  
Done     
Assignment 3  
E-book: NO  
HW: NO  
Readings: NO  
Show: 0  
Journal: NO 
Study: NO  
Test: NO  
Finished: NO  
Quiz: 0  
Done 
```

这是一个小样本。该文件中有几个学生。每个学生在他们的名字下都有两个作业，只有当每个作业中以“已完成”开头的行显示“已完成：是”时，他们才会通过。每个作业下的所有数据都是杂乱无章的，但在每个作业下的某处会显示“已完成：是（或否）”我需要一种方法来读取文件并说明是否有学生通过。到目前为止，我有

```
def get_entries( file ):
with open( "dicrete.txt.rtf", 'rt') as file:
    for line in file:
        if "Finished" in line:
            finished, answer = line.split(':')
            yield finished, answer

# dict takes a sequence of  `(key, value)` pairs and turns in into a dict
print dict(get_entries( file )) 
```

我只能让这段代码返回一个条目（第一个“完成”它读取为键，“是或否”作为值，这是我想要的，但我希望它返回文件中开始的每一行与“完成”。所以我提供的示例数据我想返回一个包含 2 个条目的字典 {Finished:"NO" , Finished:"NO"}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T22:32:25.843

字典每个键只能存储一个映射。因此，您永远不能拥有一个字典，其中同一个键有两个不同的条目。

考虑使用一个二元组列表，例如`[("Finished", "NO"), ("Finished", "NO")]`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-09T05:59:01.200

听起来你需要一个更好的数据模型！让我们看看，好吗？

让我们定义一个`Assignment`类，我们可以使用 和 之间的所有文本行来调用`Assignment: #`它`Finished: YES/NO`。

```
class Assignment(object):
    def __init__(self, id, *args, **kwargs):
        self.id = id
        for key,val in kwargs.items():
            setattr(self, key.lower(), val)
        finished = getattr(self, 'finished', None)
        if finished is None:
            raise AttributeError("All assignments must have a 'finished' value")
        else:
            self.finished = True if finished.lower() == "yes" else False

    @classmethod
    def from_string(cls, s):
        """Builds an Assignment object from a string

        a = Assignment.from_string('''Assignment: 1\nAttributes: Go Here\nFinished: yes''')
        >>> a.id
        1
        >>> a.finished
        True"""
        d = dict()
        id = None
        for line in s.splitlines():
            key,*val = map(str.strip, line.split(":"))
            val = ' '.join(val) or None
            if key.lower().startswith('assignment'):
                id = int(key.split()[-1])
                continue
            d[key.lower()] = val
        if id is not None:
            return cls(id, **d)
        else:
            raise ValueError("No 'Assignment' field in string {}".format(s)) 
```

一旦你有了你的模型，你就需要解析你的输入。幸运的是，这实际上非常简单。

```
def splitlineson(s, sentinel):
    """splits an iterable of strings into a newline separated string beginning with each sentinel.

    >>> s = ["Garbage", "lines", "SENT$", "first", "group", "SENT$", "second", "group"]
    >>> splitlineson(s, "SENT$")
    iter("SENT$\nfirst\ngroup",
         "SENT$\nsecond\ngroup")"""

    lines = []
    for line in s:
        if line.lower().strip().startswith(sentinel.lower()):
            if any((sentinel.lower() in line.lower() for line in lines)):
                yield "\n".join(lines)
            lines = [line.strip()]
        else:
            if line:
                lines.append(line.strip())
    yield "\n".join(lines)

with open('path/to/textfile.txt') as inf:
    assignments = splitlineson(inf, "assignment ")

assignment_list = [Assignment.from_string(a) for a in assignments] 
```

# c# - 如何将上传文件的文件名传递给 ASP.NET C# 中的 SQL 值？

> ID：14762270
> 
> 赞同：1
> 
> 时间：2013-02-07T22:29:15.097
> 
> 标签：c#, asp.net, sql

我需要帮助弄清楚如何在上传文件时将上传文件的名称传递到 SQL 数据库中；到目前为止，我只能让上传者工作。

由于我在 Visual Web Developer 2008 中构建此项目，因此在页面代码中建立了 Sql 数据源和连接字符串：

```
<asp:SqlDataSource ID="SqlDataSource1" runat="server" 
    ConnectionString="<%$ ConnectionStrings:ARW-KidsConnectionString1 %>" 
    DeleteCommand=" ... " 
    InsertCommand="INSERT INTO [Kids] ( ... , [Picture],  ...) VALUES ( ... , @Picture,  ...)" 
    ProviderName="<%$ ConnectionStrings:ARW-KidsConnectionString1.ProviderName %>" 
    SelectCommand=" ... " 
    UpdateCommand=" ... "> 
```

我已经编辑了该片段，因为它是重点关注的插入命令。“孩子”表中的“图片”列应该包含给定孩子的上传图片的名称，这很重要，因为我们确实有一个占位符图片，当没有可用图片时使用它。

这是上传图片的表单中的代码；它是 DetailsView 的一部分，其中包含收集新列表的所有信息的表单。

```
<InsertItemTemplate>
                Upload Image:<br />
                <asp:FileUpload ID="picUpload" runat="server" />
                <asp:CustomValidator ID="imageCheck" runat="server" ErrorMessage="Upload Image Files Only" CssClass="ErrorMsg"></asp:CustomValidator>
            </InsertItemTemplate> 
```

这是处理图片上传的代码中的完整方法。您会注意到我在 DetailsView 的 ItemInserting 事件上触发了它。

```
protected void DetailsView1_ItemInserting(object sender, DetailsViewInsertEventArgs e)
{
    FileUpload pu = (FileUpload)DetailsView1.FindControl("picUpload");
    string virtualFolder = "~/WisconsinKids/Kid_Images/";
    string physicalFolder = Server.MapPath(virtualFolder);
    string fileName = "nopic.jpg";

    if (!pu.HasFile)
    {
    }

    if (pu.HasFile)
    {
        if (pu.FileName.ToLower().EndsWith(".jpg") ||
            pu.FileName.ToLower().EndsWith(".jpeg") ||
            pu.FileName.ToLower().EndsWith(".gif") ||
            pu.FileName.ToLower().EndsWith(".png") ||
            pu.FileName.ToLower().EndsWith(".bmp"))
        {
            fileName = pu.FileName.ToString();
            pu.SaveAs(System.IO.Path.Combine(physicalFolder, fileName));
        }

        else
        {
            CustomValidator imageCheck = (CustomValidator)DetailsView1.FindControl("imageCheck");
            imageCheck.IsValid = false;
            e.Cancel = true;
        }
    }
} 
```

我想要做的是将该字符串“fileName”推送到表 Kids 的图片记录中。由于我已经在前端建立了数据源连接，我的直觉告诉我，我不应该在代码隐藏中再次这样做，但经过三天的搜索，我已经没有想法了。

提前感谢您提供的任何帮助。如果您需要更多信息，请告诉我，我会尽力澄清，请记住我是新手。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T01:17:54.613

尝试：

```
e.Values["Picture"] = pu.FileName; 
```

[这里](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.detailsviewinserteventargs.values.aspx)有一个例子。据此，以上应该是你所需要的。

# jsp - html 选择中的填充

> ID：14762273
> 
> 赞同：0
> 
> 时间：2013-02-07T22:29:23.777
> 
> 标签：jsp, jstl, padding, option

我正在尝试完成与这个问题通常提出的一些不同的事情......

我的选择实际上包含两位信息，如下所示：

```
<select name="location" size="20" >
<c:forEach ...>
   <option value="${id}">${name} ${state}</option>
</c:forEach>
</select> 
```

我知道 ${name} 的最大大小是 30，所以我想做的是用空格将其右填充为 30 个字符，这样我就可以设置列标题的样式（“名称”和“状态”）在选择上方，它们将相当接近对齐。
似乎没有任何标准 JSTL 标记可以对纯字符串执行此操作，还是我缺少一个？我想尝试避免在我的对象上创建单独的 getter，所以如果标签库可以实现这一点，那将是理想的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T23:23:37.723

您可以使用[fn:length](http://docs.oracle.com/cd/E17802_01/products/products/jsp/jstl/1.1/docs/tlddocs/index.html)函数尝试类似的操作：

```
<select name="location" size="20" >
    <c:forEach ...>
        <c:remove var="filling_spaces" scope="page"/>
        <c:forEach begin="0" end="${30 - fn:length(name)}" varStatus="status">
            <c:set var="filling_spaces" value="${filling_spaces} "/> 
                <%-- ^notice the space concatenation --%>
        </c:forEach>
        <option value="${id}">${name}${filling_spaces}${state}</option>
    </c:forEach>
</select> 
```

# gridview - Gridview 项目过渡

> ID：14762276
> 
> 赞同：0
> 
> 时间：2013-02-07T22:29:32.783
> 
> 标签：gridview, windows-runtime, transition

有什么办法可以将过渡分配给Gridview的项目而不是整个gridview，就像[这里](http://www.codeproject.com/Articles/269351/WinRT-Transitions-Creating-Fast-and-Fluid-Metro-UI)一样？这个我好像搞不定...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T00:57:27.743

您需要将转换放在 GridView/ItemsPanel/ItemsPanelTemplate/WrapGrid/ChildrenTransitions/TransitionCollection 下。

# ios - 我的 iOS 静态库中的配置参数

> ID：14762277
> 
> 赞同：0
> 
> 时间：2013-02-07T22:29:52.543
> 
> 标签：ios, objective-c, static-libraries

我在我的静态库中：我希望我有办法添加一些配置参数，例如我的服务器的地址：如果有一个静态库，我会这样做：

```
NSString *serverURL =  [[[NSBundle mainBundle] infoDictionary] objectForKey:@"kServerURL"]; 
```

我怎样才能在我的静态库中做到这一点？

# java - 通过网络将 json_encode 数组传递给 java

> ID：14762279
> 
> 赞同：0
> 
> 时间：2013-02-07T22:29:56.220
> 
> 标签：java, php, arrays, networking, serialization

我正在做一个课程，我试图将一个数组从 php 'client' 传递给 java 'server'。我在 php 中创建了一个数组，使用 json_encode 对其进行编码，并使用 StringVariable.readLine() 在服务器站点上接收它。我的问题：

php 数组的值在 java 中作为数组的一个值接收。请看一下代码和输出。

**PHP - 作为“发件人”**

```
$array = array("foo", "bar", "hallo", "world");
$array2 = json_encode($array);
//var_dump($array);

$socket = fsockopen($server, $port, $eN, $eS);  

if ($socket)  
{  

fwrite($socket, $array2); 
```

**Java - 作为“接收者”**

```
BufferedReader in = new BufferedReader(new InputStreamReader(socket1.getInputStream())); 

 while ((in1 = in.readLine()) != null) 
                {  
                    String[] Decoder = {in1};
                    System.out.println(Arrays.asList(Decoder)); 
```

**结果**

[["foo","bar","你好","world"]]

我通常在寻找一种解决方案，通过我的局域网将数组从 PHP 传递到 JAVA。任何解决方案都会很棒..我也尝试过**serialize()**，我收到的是

[a:4:{i:0;s:3:"foo";i:1;s:3:"bar";i:2;s:5:"你好";i:3;s:5: “世界”;}]

帮助将不胜感激！！！谢谢你！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T22:45:03.297

您可以`json_encode`像现在一样在 PHP 中使用，然后在 Java 端使用 JSON 解码器；有几个（杰克逊和格森都是流行的）。

[这是一个使用Gson](http://code.google.com/p/google-gson/)的基本示例：

```
String[] myStrings = new Gson().fromJson(in1, String[].class); 
```

更好的是不要在 Java 中使用数组，而是使用 List：

```
Type type = new TypeToken<List<String>>(){}.getType();
List<String> myStrings = new Gson().fromJson(in1, type); 
```

# objective-c - 如何将罗马数字转换为 NSNumer

> ID：14762282
> 
> 赞同：0
> 
> 时间：2013-02-07T22:30:26.683
> 
> 标签：objective-c, nsnumber, roman-numerals

我正在制作一个具有罗马数字模式的计算器。我在模型视图和视图控制器中执行了操作。我的问题是我需要将罗马数字转换为 NSNumber。有一个 UILabel，视图控制器获取标签中的内容并将其设置为模型视图的操作数。有谁知道我如何从标签中取出罗马数字并将其设为 NSNumber？这是一些代码：

```
- (IBAction)digitPressed:(UIButton *)sender {

    NSString *digit = [[sender titleLabel] text];
    if (self.userIsTypingNumber) {
      [self.display setText:[self.display.text stringByAppendingString:digit]];
    } else {
        [self.display setText:digit];
        self.userIsTypingNumber = YES;
    }
}

- (IBAction)operationPressed:(UIButton *)sender {

    if (self.userIsTypingNumber) {
        if ([self isValidForRoman:self.display.text] == YES) {
            //find out what roman numeral is in the display
        } else {
        NSNumberFormatter *numberFormatter = [[NSNumberFormatter alloc]init];
        [numberFormatter setNumberStyle: NSNumberFormatterDecimalStyle];
        NSNumber *n = [numberFormatter numberFromString:self.display.text];
        [[Model singleton] setOperand:n];
        self.userIsTypingNumber = NO;
        }
    }
    NSString *operation = [[sender titleLabel] text];
    NSNumber *result = [[Model singleton] performOperation:operation];
    [self.display setText:[NSString stringWithFormat:@"%@", result]];
}

- (IBAction)clearDigitPressed:(UIButton *)sender {

    [self.display setText:@""];
}

- (IBAction)clearOperationPressed:(UIButton *)sender {

    [[Model singleton] performOperation:nil];
    [self.display setText:@""];
}

- (IBAction)changeNumeralType:(id)sender {

    switch ([sender selectedSegmentIndex]) {
        case 0:
        {            
            [self.button1 setTitle:@"1" forState:UIControlStateNormal];
            [self.button2 setTitle:@"2" forState:UIControlStateNormal];
            [self.button3 setTitle:@"3" forState:UIControlStateNormal];
            [self.button4 setTitle:@"4" forState:UIControlStateNormal];
            [self.button5 setTitle:@"5" forState:UIControlStateNormal];
            [self.button6 setTitle:@"6" forState:UIControlStateNormal];
            [self.button7 setTitle:@"7" forState:UIControlStateNormal];
            [self.button8 setTitle:@"8" forState:UIControlStateNormal];
            [self.button9 setTitle:@"9" forState:UIControlStateNormal];
            [self.button0 setTitle:@"0" forState:UIControlStateNormal];
        } break;

        case 1:
        {
            [self.button1 setTitle:@"L" forState:UIControlStateNormal];
            [self.button2 setTitle:@"C" forState:UIControlStateNormal];
            [self.button3 setTitle:@"D" forState:UIControlStateNormal];
            [self.button4 setTitle:@"I" forState:UIControlStateNormal];
            [self.button5 setTitle:@"V" forState:UIControlStateNormal];
            [self.button6 setTitle:@"X" forState:UIControlStateNormal];
            [self.button7 setTitle:@"" forState:UIControlStateNormal];
            [self.button8 setTitle:@"" forState:UIControlStateNormal];
            [self.button9 setTitle:@"" forState:UIControlStateNormal];
            [self.button0 setTitle:@"M" forState:UIControlStateNormal];

        } break;

    }
}

- (BOOL)isValidForRoman:(NSString *)text
{
    NSString *romanRegex = @"^(?=.)(?i)M*(D?C{0,3}|C[DM])(L?X{0,3}|X[LC])(V?I{0,3}|I[VX])$";
    NSPredicate *romanTest = [NSPredicate predicateWithFormat:@"SELF MATCHES %@", romanRegex];
    return ([romanTest evaluateWithObject:text]);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T22:36:07.870

以下是一些可能对您有所帮助的资源：

[罗马数字转换](https://bitbucket.org/exister/roman-numbers-converter/src/ed0559cc63ee/roman_converter/RomanNumber.m) - 这个可能是两者中更好的一个，因为它具有向前/向后翻译

[pzearfoss / NSNumber-RomanNumerals](https://github.com/pzearfoss/NSNumber-RomanNumerals) - 这是一个简单的类别；但是，它只将 NSNumber 转换为罗马数字。您也许可以对其进行调整以使其相反。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-24T12:46:08.940

你可以试试这个功能

```
-(NSString*)numberToRomanNumerals:(int)num{

    if (num < 0 || num > 9999) { return @""; } // out of range

    NSArray *r_ones = [[NSArray alloc]initWithObjects:@"I", @"II", @"III", @"IV", @"V", @"VI", @"VII", @"VIII",@"IX",nil];
    NSArray *r_tens = [[NSArray alloc]initWithObjects:@"X", @"XX", @"XXX", @"XL", @"L", @"LX", @"LXX",@"LXXX", @"XC",nil];
    NSArray *r_hund = [[NSArray alloc]initWithObjects:@"C", @"CC", @"CCC", @"CD", @"D", @"DC", @"DCC",@"DCCC", @"CM",nil];
    NSArray *r_thou = [[NSArray alloc]initWithObjects:@"M", @"MM", @"MMM", @"MMMM", @"MMMMM", @"MMMMMM",@"MMMMMMM",
               @"MMMMMMMM", @"MMMMMMMMM",nil];

    int ones = num % 10;
    int tens = (num - ones) % 100;
    int hundreds = (num - tens - ones) % 1000;
    int thou = (num - hundreds - tens - ones) % 10000;

    tens = tens / 10;
    hundreds = hundreds / 100;
    thou = thou / 1000;

    NSString *rnum=@"";

    if (thou) { rnum = [rnum stringByAppendingString:[r_thou objectAtIndex:thou-1]]; }
    if (hundreds) { rnum = [rnum stringByAppendingString:[r_hund objectAtIndex:hundreds-1]];    }
    if (tens) { rnum = [rnum stringByAppendingString:[r_tens objectAtIndex:tens-1]]; }
    if (ones) { rnum = [rnum stringByAppendingString:[r_ones objectAtIndex:ones-1]]; }

    [r_ones release];
    [r_tens release];
    [r_hund release];
    [r_thou release];

    return rnum;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-24T23:33:33.437

刚写了一篇，因为之前看到的都觉得有点怪，欢迎大家尝试：[https ://github.com/shoumikhin/RomanNumeral](https://github.com/shoumikhin/RomanNumeral)

```
//==============================================================================
@implementation NSNumber (RomanNumeral)
//------------------------------------------------------------------------------
- (NSString *)encodeRomanDigit:(NSInteger)value one:(NSString *)one five:(NSString *)five ten:(NSString *)ten
{
    switch (value)
    {
        case 1 :

            return [NSString stringWithFormat:@"%@", one];

        case 2 :

            return [NSString stringWithFormat:@"%@%@", one, one];

        case 3 :

            return [NSString stringWithFormat:@"%@%@%@", one, one, one];

        case 4 :

            return [NSString stringWithFormat:@"%@%@", one, five];

        case 5 :

            return [NSString stringWithFormat:@"%@", five];

        case 6 :

            return [NSString stringWithFormat:@"%@%@", five, one];

        case 7 :

            return [NSString stringWithFormat:@"%@%@%@", five, one, one];

        case 8 :

            return [NSString stringWithFormat:@"%@%@%@%@", five, one, one, one];

        case 9 :

            return [NSString stringWithFormat:@"%@%@", one, ten];
    }

    return @"";
}
//------------------------------------------------------------------------------
- (NSString *)encodeRomanDigit:(NSInteger)value withDigitNumber:(NSUInteger)digitPosition
{
    switch (digitPosition)
    {
        case 0 :

            return [self encodeRomanDigit:value one:@"I" five:@"V" ten:@"X"];

        case 1 :

            return [self encodeRomanDigit:value one:@"X" five:@"L" ten:@"C"];

        case 2 :

            return [self encodeRomanDigit:value one:@"C" five:@"D" ten:@"M"];

        case 3 :

            return [self encodeRomanDigit:value one:@"M" five:@"" ten:@""];
    }

    return @"";
}
//------------------------------------------------------------------------------
- (NSString *)romanNumeralStringValue
{
    NSMutableString *ret = @"".mutableCopy;
    NSUInteger value = self.unsignedIntegerValue;
    NSUInteger base = 10;
    NSUInteger digitPosition = 0;
    NSUInteger const ROMAN_NUMBER_MAX = 4000;

    if (value < ROMAN_NUMBER_MAX)
      do
      {
          [ret insertString:[self encodeRomanDigit:value % base withBase:digitPosition] atIndex:0];
          digitPosition++;
      }
      while (value /= base);

    return ret;
}
//------------------------------------------------------------------------------
@end
//==============================================================================
@implementation NSString (RomanNumeral)
//------------------------------------------------------------------------------
- (NSInteger)decodeRomanDigit:(char)romanDigit
{
    switch (romanDigit)
    {
        case 'I' :
        case 'i' :

            return 1;

        case 'V' :
        case 'v' :
        case 'U' :
        case 'u' :

            return 5;

        case 'X' :
        case 'x' :

            return 10;

        case 'L' :
        case 'l' :

            return 50;

        case 'C' :
        case 'c' :

            return 100;

        case 'D' :
        case 'd' :

            return 500;

        case 'M' :
        case 'm' :

            return 1000;
    }

    return 0;
}
//------------------------------------------------------------------------------
- (NSInteger)romanNumeralValue
{
    NSInteger ret = 0;
    NSUInteger length = self.length;
    unichar buffer[length];

    [self getCharacters:buffer range:NSMakeRange(0, length)];

    for (int i = 0; i < length; ++i)
    {
        NSInteger current = [self decodeRomanDigit:buffer[i]];
        NSInteger next = i + 1 < length ? [self decodeRomanDigit:buffer[i + 1]] : 0;

        if (next > current)
        {
            ret += next - current;
            i++;
        }
        else
            ret += current;
    }

    return ret;
}
//------------------------------------------------------------------------------
@end
//============================================================================== 
```

# android - 不允许 Android 应用的 Activity 有多个实例

> ID：14762291
> 
> 赞同：0
> 
> 时间：2013-02-07T22:31:09.773
> 
> 标签：android

我正在尝试为 Android 创建一个非常简单的应用程序，它将播放音乐文件（我真的才刚刚开始进入 Android）。我只有一个 Activity 在应用程序启动时启动，它开始播放音乐文件。我需要的是该活动始终运行（播放音乐），无论您按后退还是主页按钮，除非您明确告诉它从“设置”菜单中关闭，如果您尝试再次运行它，它应该只是恢复该活动到前面（基本上，其他所有玩家的工作方式）。但是，对我来说，当我按下返回以返回菜单屏幕并再次单击该应用程序时，它会运行另一个活动实例（我可以说，因为音乐加倍）。我能做些什么来防止这种情况发生？非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T22:36:10.327

对于在后台播放音乐，我建议您使用[服务](http://developer.android.com/reference/android/app/Service.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T22:35:11.853

`android:launchMode= "singleInstance"`在清单文件中指定。这意味着您的活动是您的整个应用程序。

不要忘记保存音乐时间的状态。用于`SharedPreferences`在声音结束播放时保存一个整数和秒，并在`onResume()`方法中恢复状态。

不幸的是，当活动被破坏时，您按下后退按钮后无法播放音乐。如果您希望按照其他答案的建议这样做，则必须启动服务。`onDestroy()`原因是您需要一个 Context 对象来播放音乐，并且在调用方法后它将不再可用。

[http://developer.android.com/guide/topics/media/mediaplayer.html](http://developer.android.com/guide/topics/media/mediaplayer.html) 在这里您可以找到在服务中播放媒体文件的示例。

# ios - 即使 AVCaptureSession 正在运行，isRunning 也会返回 NO

> ID：14762298
> 
> 赞同：1
> 
> 时间：2013-02-07T22:31:31.287
> 
> 标签：ios, avfoundation

我正在使用 AVCaptureSession 捕获视频，并且在 iOS 6.1 上一切正常。但是，我一直在尝试从另一个线程检查我的捕获会话是否正在通过 isRunning 方法运行。但是，无论我的捕获会话是否正在运行，该方法都会返回 NO。

但是，如果我在主线程上调用 isRunning 方法；我得到了正确的值。

有人对此有很好的解释吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T22:32:11.247

My bad. It turns out that the way I was accessing my capture session was not thread safe. Also it is worth pointing out that running( with "isRunning" method as a getter) is a non-atomic property, which does not help with the whole problem either.

# c++ - 带有基类的 Boost Variant 导致“C1060 编译器堆空间不足”

> ID：14762301
> 
> 赞同：2
> 
> 时间：2013-02-07T22:31:47.410
> 
> 标签：c++, visual-studio-2010

我希望这里有人对此有解决方法。此代码在 gcc 和 VS2010 SP1（Debug x32、Release x32、Debug x64）上编译良好，但对于 64 位 Release 构建失败，并出现致命错误 C1060：编译器堆空间不足。我正在使用 Boost 1.52

```
#include "stdafx.h"
#include <boost/variant.hpp>
#include <string>
#include <vector>
#include <map>

typedef boost::make_recursive_variant<
    boost::blank,
    std::string,
    int,
    double,
    std::vector<std::vector<int> >,
    std::vector<std::vector<double> >,
    std::vector<std::vector<std::string> >,
    std::map<std::string, std::vector<std::string> >,
    std::map<std::string, std::vector<double> >,
    std::map<std::string, std::vector<int> >,
    std::map<std::string,boost::recursive_variant_>
>::type InfoHolder2;

class Test
{
    InfoHolder2 test;
};

class Test3
{};

class Test4
{};

template <class T>
class Base
{
public:
    Base(){};
    virtual std::string Foo(const T& val, const std::string& header = "")  const = 0;
    virtual T Bar(const std::string& buffer, size_t offset = 0) const = 0;
};

template <class Payload, class iArchive, class oArchive> 
class TestSer : Base<Payload>
{
public:
    TestSer():Base()
    {    }

    virtual std::string Foo(const Payload& holder,const std::string& header = "") const
    {
        return "";
    }

    virtual Payload Bar( const std::string& buffer, size_t offset = 0) const
    {   
        Payload retval;
        return retval;
    }
};

int _tmain(int argc, _TCHAR* argv[])
{
    new TestSer<Test, Test3, Test4>();
    return 0;
} 
```

这每次都失败。如果我减少变体可以处理的元素数量，我可以编译它，但这并不是真正的首选，因为这对我来说很好用。如果我将课程更改为以下版本，它可以工作。有没有人对解决方法有任何想法？

```
template <class Payload, class iArchive, class oArchive> 
class TestSer 
{
public:
    TestSer()
    {    }

    std::string Foo(const Payload& holder,const std::string& header = "") const
    {
        return "";
    }

    Payload Bar( const std::string& buffer, size_t offset = 0) const
    {   
        Payload retval;
        return retval;
    }

}; 
```

# php - 这是如何工作的： chr(($number >>6 )+192).chr(($number & 63)+128);

> ID：14762311
> 
> 赞同：2
> 
> 时间：2013-02-07T22:32:12.987
> 
> 标签：php, utf-8, multibyte, chr

您能否解释一下这行代码如何等效于下一个代码：

```
<?php
$string = chr( ( $number >> 6 ) + 192 ).chr( ( $number & 63 ) + 128 );
?> 
```

它相当于：

```
if ( $number >=128 && $number <=2047 ){

   $byte1 = 192 + (int)($number / 64); //= 192 + ( $number >> 6 )
   $byte2 = 128 + ($number % 64);      //= 128 + ( $number & 63 )
   $utf = chr($byte1).chr($byte2);
 } 
```

例如输入数字 1989 都会产生`߅`

这些代码用于将 UNICODE 实体转换回原始 UTF-8 字符。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T22:39:02.227

`$number >> 6`是二元右移操作，即：`11000000 >> 6 == 00000011`相当于`$number / pow(2,6)`aka`$number / 64`

`$number & 63``AND`是一个二进制文件`00111111`

两者作为二元运算的速度要快得多，因为它们处理的是一两个幂。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T22:40:01.090

上面的代码使用二元运算符。 `>>`是右移运算符。它将数字中的位向右移动（朝向更重要的位）。

所以`11110000 >> 2 = 00111100`

相当于除以 2 的幂 `$number >> $n`等于`$number / pow(2,$n)`。

是“`&`按位与”运算符。它比较两个数字上的相应位，并设置两个数字中的结果`1`。

`11110000 & 01010101 = 01010000`

通过`$number`与 63 ( `001111111`) 进行与运算，得到除以`$number`64 的余数（也称为模数），写成`$number % 64`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-02-12T11:32:47.167

添加到@Mchl 的答案中，在 UTF 序列中添加 192 的原因是表示字节信息的开始

192 - 11000000 - 2 字节序列的开始 (128 + 64)

224 - 11100000 - 3 字节序列的开始（128 + 64 + 32）

240 - 11110000 - 4 字节序列的开始（128 + 64 + 32 + 16）

248 - 11111000 - 5 字节序列的开始（受限）（... + 8）

252 - 11111100 - 6 字节序列的开始（受限）（... + 4）

254 - 11111110 - 无效

Table Reference : [https://en.wikipedia.org/w/index.php?title=UTF-8&oldid=388157043](https://en.wikipedia.org/w/index.php?title=UTF-8&oldid=388157043)

[UTF-8 byte range table](https://i.stack.imgur.com/wRQ1f.png)

# sql - 如何对子查询中的值执行 CASE

> ID：14762313
> 
> 赞同：1
> 
> 时间：2013-02-07T22:32:21.483
> 
> 标签：sql, case

这将很难解释，但在这里。

我希望在一个`SELECT`子句中执行 CASE 条件，该条件将使用两个计算的结果来确定为列值返回哪个计算值。

也许代码示例会有所帮助：

这有效：

```
SELECT 
   A.[COLUMN1]
   , B.[COLUMN1]
   , CASE 
      WHEN A.[COLUMN2] + A.[COLUMN3] >= B.[COLUMN2] + B.[COLUMN3] THEN A.[COLUMN2] + A.[COLUMN3]
      ELSE B.[COLUMN2] + B.[COLUMN3]
FROM
   [TABLE_A] A
      INNER JOIN [TABLE_B] B INNER JOIN ON A.ID = B.ID 
```

这里的问题是上面的查询，在case语句中，被强制执行了两次计算。一次用于`WHEN`子句，再次用于`THEN`子句。

我想做这样的事情，但 SQL 对此并不满意。

```
SELECT 
   A.[COLUMN1]
   , B.[COLUMN1]
   , CASE 
      WHEN AB.X >= AB.Y THEN AB.X
      ELSE AB.Y
     END
     FROM ((A.[COLUMN2] + A.[COLUMN3]) X, (B.[COLUMN2] + B.[COLUMN3]) Y)
FROM
   [TABLE_A] A
      INNER JOIN [TABLE_B] B INNER JOIN ON A.ID = B.ID 
```

这甚至可能吗？在第二个示例中，我只计算一次值并在 case 语句中引用它们，包括 the`WHEN`和`THEN`子句。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T22:39:37.037

您可以将其重新表述为

```
SELECT a_column1, 
       b_column1, 
       CASE 
         WHEN x >= y THEN x 
         ELSE y 
       END AS foo 
FROM   (SELECT A.[column1]                   A_COLUMN1, 
               B.[column1]                   B_COLUMN1, 
               ( A.[column2] + A.[column3] ) X, 
               ( B.[column2] + B.[column3] ) Y 
        FROM   [table_a] A 
               INNER JOIN [table_b] B 
                       ON A.id = B.id)t 
```

但我不确定它是否会有所作为，因为无论如何操作可能每行执行一次

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T22:46:07.077

我更愿意将计算下推到每个表中。这使查询的结构非常相似。因此，语法正确（或几乎正确）的版本将是：

```
SELECT A.[COLUMN1], B.[COLUMN1],
       (CASE WHEN a.col_2_3 >= b.col_2_3 THEN a.col_2_3
             ELSE b.col_2_3
        end)
FROM (select a.*,  (A.[COLUMN2] + A.[COLUMN3]) as col_2_3
      from [TABLE_A] a
     ) a INNER JOIN
     (select b.*, (B.[COLUMN2] + B.[COLUMN3]) as col_2_3
      from [TABLE_B] b
     )b
     ON a.ID = b.ID 
```

性能有很多重要因素，简单计算的开销不是其中之一。读取数据和连接比简单的计算要昂贵得多。

但是，出于几个原因，将变量移动到子查询中很有用。首先，计算可能更昂贵（例如，使用子查询）。它还有助于提高可读性，从而提高可维护性。

最后，SQL 引擎*可以*决定只对这些表达式求值一次。在实践中，我猜没有人会进行这种微不足道的优化。

# vb.net - 对象内部的变量？

> ID：14762314
> 
> 赞同：0
> 
> 时间：2013-02-07T22:32:22.940
> 
> 标签：vb.net, variables, resources

如何将变量放入 My.Resources，例如

```
My.Resources.[var] 
```

这是我的代码：

```
Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
  For Each Fe In My.Resources.ResourceManager.GetResourceSet(System.Globalization.CultureInfo.CurrentCulture, False, True)
    ProgressBar1.Maximum += 1
    ' MsgBox(Fe.Key)

    My.Computer.FileSystem.WriteAllBytes _
       (appath & "\bin\" & Fe.Key & ".jpeg", My.Resources.F.Key, True) 'Fe.Key As Variable

  Next
End Sub 
```

如何在 My.Resources 中使用 Fe.Key？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T23:37:46.473

自从您询问密钥以来，也许可以为您的解决方案添加一些东西。尝试这个 ：

```
Dim RSet As Resources.ResourceSet = My.Resources.ResourceManager.GetResourceSet(System.Globalization.CultureInfo.CurrentCulture, False, True)

If RSet IsNot Nothing Then

    Dim enumerator As IDictionaryEnumerator = RSet.GetEnumerator

    While (enumerator.MoveNext)

     ' You can now use enumerator.key

    End While   

End If 
```

[资源](http://forums.asp.net/t/1321942.aspx/1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T23:27:11.753

解决了。​​☺</p>

[这里](https://stackoverflow.com/questions/4631142/vb-net-my-resources-variable?rq=1)

引用 ：

`My.Resources.ResourceManager.GetObject(var)`

# objective-c - 覆盖类别中的方法？

> ID：14762325
> 
> 赞同：-1
> 
> 时间：2013-02-07T22:33:13.823
> 
> 标签：objective-c, ios6, cocos2d-iphone

是否可以将方法重写为类别方法？

```
@implementation CCSprite (Utilities)

-(void)draw //its already a member of CCSprite but I wantto override it. but within a category
{
   [super draw];
   [self doSomethingExtra];
}
@end 
```

目的：防止为每个驱动的 CCMySprite 类复制粘贴相同的代码块。thinking 只需导入和使用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T22:34:55.960

不，Apple 不建议这样做，如果您这样做，这是未定义的行为。在这种情况下将使用两种方法中的一种，您无法知道是哪一种。

> 避免类别方法名称冲突
> 
> 因为在类别中声明的方法被添加到现有类中，所以您需要非常小心方法名称。
> 
> 如果在一个类别中声明的方法的名称与原始类中的方法相同，或者与同一类（甚至是超类）上的另一个类别中的方法相同，则对于在哪个方法实现中使用的行为是不确定的运行。如果您在自己的类中使用类别，这不太可能成为问题，但在使用类别向标准 Cocoa 或 Cocoa Touch 类添加方法时可能会导致问题。

# ajax - 如何处理 Modx Evolution 中的 AjaxSearch 和 htmlspecialchars 错误？

> ID：14762327
> 
> 赞同：0
> 
> 时间：2013-02-07T22:33:23.760
> 
> 标签：ajax, search, modx, htmlspecialchars, modx-evolution

我必须在 MODX 中制作搜索栏，并且我想使用 MODX 中内置的 AjaxSearch。

我阅读了有关如何设置它的帮助，并且我已经获得了以下页面：

```
 [!AjaxSearch? &showResults=`0` &landingPage=`52` &showMoreResults=`1` &moreResultsPage=`52`!] 
```

在页面上`ID=52`我有：

```
[!AjaxSearch? &showInputForm=`0` &ajaxSearch=`0`!] 
```

在我点击带有空白字段的搜索的地方是可以的 - 我对此有所警惕。

但是当我输入一些东西并搜索时，我得到了：

> « MODx 解析错误 »
> 
> MODx 在尝试解析请求的资源时遇到以下错误：
> 
> « PHP Parse Error » PHP 错误调试
> 
> 错误：
> 
> htmlspecialchars() [function.htmlspecialchars]：不支持字符集“ISO-8859-2”，假设为iso-8859-1
> 
> 错误类型/编号：警告 - 2
> 
> 文件：
> 
> /home/users/xxx/public_html/xxx/xxx/assets/snippets/ajaxSearch/classes/ajaxSearchInput.class.inc.php
> Line: 340
> Line 340 source:
> if (version_compare(PHP_VERSION, '5.2.3', '>= ')) $string = htmlspecialchars($string, $quote_style, $charset, $double_encode);

我该如何处理？我该如何修复这个？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T20:13:29.737

在 wiki 中，您可能需要将 TinyMCE 配置更改为原始配置：

搜索包含“å,ä,ö,Å,Ä,Ö”等字符的单词需要配置您的编辑器以避免实体编码。为此，使用 TinyMCE，在配置选项卡中将 entity_encoding 参数从“named”更改为“raw”，然后再次保存您的文档。

这里还有一个来自论坛的类似情况的帖子。 [http://forums.modx.com/thread/?thread=26336.ne&i=1&page=2](http://forums.modx.com/thread/?thread=26336.ne&i=1&page=2)

# c++ - 魔鬼不使用 linux 构建加载图像

> ID：14762329
> 
> 赞同：5
> 
> 时间：2013-02-07T22:33:42.863
> 
> 标签：c++, c, linux, devil

我在将图像加载到 Devil 时遇到问题，所以我准确地提供了我如何构建库以及我如何尝试使用它。

[从他们的网站](http://openil.sourceforge.net/download.php)下载了 Devel 源代码。

```
$ unzip DevIL-1.7.8.zip
$ mkdir devil
$ cd Devil-1.7.8
+-------------------------------------------+
| Just type:                                |
| autoreconf -i                             |
| ./configure <your options here>           |
| make                                      |
| sudo make install                         |
+-------------------------------------------+ 
```

如果我使用 autoreconf -i 然后 ./configure 带有前缀和 ilu 和 ilut。我得到一个错误..forgot..来记录它。**这有多重要？**我只是没有使用它。

```
$ chmod +x configure
$  ./configure --prefix=/home/path/to/TestingDevil/devil --enable-ILU --enable-ILUT
$ make
$ make install 
```

所以此时*应该*建立我的库。我下载了魔鬼[简单示例](http://openil.cvs.sourceforge.net/viewvc/openil/DevIL/examples/simple_example/)（simple.c）到TestingDevil/simple/simple.c 构建它。

```
$ gcc -I ../devil/include -L ../devil/lib/ simple.c -o simple -lIL -lILU -lILUT
$ cp ../devil/lib/*.so* . 
```

我添加了一张图片（jpg）来测试。

```
$ LD_LIBRARY_PATH=. ./simple image.jpg 
```

> “无法打开文件...正在退出”

我从简单目录运行可执行文件。

```
simple$ ls 
```

> image.jpg libIL.so.1.1.0 libILU.so.1.1.0 libILUT.so.1.1.0 libIL.so libILU.so libILUT.so simple libIL.so.1 libILU.so.1
> libILUT.so.1 simple 。C

**怎么了？**我正在使用来自 devIL 的示例，它编译并运行良好。只是无法加载任何文件。

我的系统是 Ubuntu 12.10 64，安装了 build-essential 和其他用于 opengl 开发的开发包。

Uni System 是 Fedora 15(?) 32。同样的方式构建 devIL 后，这也有完全相同的问题。

在我的家用机器上，我安装了软件包 libdevel-dev 并且工作正常。

这个问题**没有**询问opengl，纯粹是devIL lib和示例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T08:23:41.023

看起来您构建它时没有 jpg 支持，或者您没有可用的 jpeg 库？

# javascript - jqBootstrapValidation.js 在 IE 中不起作用

> ID：14762334
> 
> 赞同：0
> 
> 时间：2013-02-07T22:33:59.890
> 
> 标签：javascript, forms, internet-explorer, validation

我正在使用 js 表单验证库[jqBootstrapValidation.js](http://reactiveraven.github.com/jqBootstrapValidation/)来验证我拥有的注册表单。在我在 Internet Explorer 9 中尝试之前，一切都很好。

我对所有内容（最小/最大长度，有效电子邮件等）都有“必需”规则。在 IE 中，验证库仅适用于电子邮件字段。电子邮件字段和名字字段之间的唯一区别是电子邮件的类型为“电子邮件”，而名字的类型为“文本”。

我在字段上有占位符属性，并且为加载占位符的 IE 提供了一个modernizr 工作。有趣的是，当我取出“名字”字段上的占位符时，验证库会识别它并根据需要标记它。

有人在 IE 中使用这个库有困难吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T17:02:52.503

我认为这可能会有所帮助： [链接](https://stackoverflow.com/questions/13992465/how-did-i-validate-required-jqbootstrapvalidation-on-ie9-ios)

> IE 或 Safari 不支持 required 属性

# perl - 如何在perl的文件夹中的所有文件中查找第一次出现的字符串

> ID：14762335
> 
> 赞同：0
> 
> 时间：2013-02-07T22:34:05.483
> 
> 标签：perl

我试图在文件夹中的每个 txt 文件中找到字符串“victory”第一次出现的行。对于文件中的每个第一个“胜利”，我想将该行中的数字保存到 @num 并将文件名保存到 @filename

示例：对于以以下行开头的文件 a.txt：“lalala 胜利 123456”-> $num[$i]=123456 和 $filename[$i]="a.txt"

ARGV 保存所有文件名。我的问题是我试图逐行进行，但我不知道自己做错了什么。还有一件事 - 我怎样才能在最后一个文件中获得最后一次出现的“胜利”？

```
use strict;
use warnings;
use File::Find;

my $dir = "D:/New folder";   
find(sub { if (-f && /\.txt$/) { push @ARGV, $File::Find::name } }, $dir);   $^I = ".bak"; 

my $argvv;
my $counter=0;
my $prev_arg=0;
my $line = 0;

my @filename=0;
my @num=0;
my $i = 0;

foreach $argvv (@ARGV)
{
    #open $line, $argvv or die "Could not open file: $!";
    my $line = IN 
    while (<$line>)
    {
        if (/victory/)
        {
            $line = s/[^0-9]//g;    
            $first_bit[$i] = $line;
            $filename[$i]=$argvv;
            $i++;
            last;
        }

    }
    close $line;
}

for ($i=0; $i<3; $i++)
{
    print $filename[$i]."  ".$num[$i]."\n";
} 
```

非常感谢你！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T01:54:58.397

您的示例脚本有许多小问题。以下示例应该以相当干净的方式执行您想要的操作：

```
#!/usr/bin/perl 
use strict;
use warnings;
use File::Find;

# Find the files we're interested in parsing
my @files = ();
my $dir = "D:/New folder";
find(sub { if (-f && /\.txt$/) { push @files, $File::Find::name } }, $dir);

# We'll store our results in a hash, rather than in 2 arrays as you did
my %foundItems = ();

foreach my $file (@files)
{
    # Using a lexical file handle is the recommended way to open files
    open my $in, '<', $file or die "Could not open $file: $!";
    while (<$in>)
    {
        # Uncomment the next two lines to see what's being parsed
        # chomp; # Not required, but helpful for the debug print below
        # print "$_\n"; # Print out the line being parsed; for debugging

        # Capture the number if we find the word 'victory'
        # This assumes the number is immediately after the word; if that
        # is not the case, it's up to you to modify the logic here
        if (m/victory\s+(\d+)/)
        {
            $foundItems{$file} = $1; # Store the item
            last;
        }
    }
    close $in;
}

foreach my $file (sort keys %foundItems)
{
    print "$file=> $foundItems{$file}\n";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T07:01:38.273

下面在所有文件(file*.txt) 中搜索字符串 abc 并仅打印第一行。

```
perl -lne 'BEGIN{$flag=1}if(/abc/ && $flag){print $_;$flag=0}if(eof){$flag=1}' file*.txt 
```

测试：

```
> cat temp
abc 11
22
13
,,
abc 22
bb
cc
,,
ww
kk
ll
,,

> cat temp2
abc t goes into 1000
fileA1, act that abc specific place

> perl -lne 'BEGIN{$flag=1}if(/abc/ && $flag){print $_;$flag=0}if(eof){$flag=1}' temp temp2
abc 11
abc t goes into 1000
> 
```

# c++ - 按 C++ 中接受参数的函数排序？

> ID：14762344
> 
> 赞同：2
> 
> 时间：2013-02-07T22:34:44.773
> 
> 标签：c++, sorting

我正在尝试编写一个函数来按各种不同的属性对自定义类对象的向量进行排序。

C++ 排序参考，可在此处找到：

[http://www.cplusplus.com/reference/algorithm/sort/](http://www.cplusplus.com/reference/algorithm/sort/)

说你可以这样排序：

```
std::sort (myvector.begin(), myvector.end(), myfunction); 
```

除了来自我的向量的两个对象之外，我想要做的是向 myfunction 传递一个参数，如下所示：

```
std::sort (myvector.begin(), myvector.end(), myfunction(mode=7)); 
```

你知道这样做的方法吗？

我对 c++ 比较陌生，来自 python，这很容易。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-07T22:39:32.127

如果您使用的是 C++11，则可以使用 lambda：

```
sort(myvec.begin(), myvec.end(), [] (Type a, Type b) { return myfunction(a,b,7); }); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-07T22:37:09.990

您可以使用仿函数而不是自由函数：

```
struct Functor{
  int mode;
  bool operator() (int a,int b) { return (a<b);}
} functor; 
```

重载的`()`运算符在由 调用仿函数时执行`sort`。在那里你可以有一个变量`mode`并根据需要使用它。然后设置模式（您也可以在仿函数构造函数中设置）并`sort`使用它调用：

```
functor.mode = 7; // or set it in the constructor
std::sort (myvector.begin(), myvector.end(), functor); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T22:37:03.620

创建一个函子：

```
struct MyFunction {
  bool operator()(const T& lhs, const T& rhs) const { /* implement logic here */ }
  int mode;
}; 
```

然后传递一个实例而不是你的普通函数`myfunction`。这里，`T`是用于实例化您的`std::vector`.

```
MyFunction f;
f.mode = 7;
std::sort (myvector.begin(), myvector.end(), f); 
```

如果您有 C++11 支持，则可以使用 lambda 函数：

```
std::sort(myvector.begin(), myvector.end(), [](const T&a, const T& b) { /* implement*/ }); 
```

# ruby-on-rails - 从远程 mp3 文件中检索 id3 信息

> ID：14762348
> 
> 赞同：1
> 
> 时间：2013-02-07T22:34:56.357
> 
> 标签：ruby-on-rails, ruby, taglib, id3

我需要不是从我机器上的文件中获取这些信息，而是从另一个文件中获取这些信息。

一般来说，我可以通过这种方式获取这些信息：

```
TagLib::MPEG::File.open("myfile.mp3") do |file|

    tag = file.tag

    "Artist:     "      +   tag.artist      + " " +
    "Title:      "      +   tag.title       + " " +
    "Album:      "      +   tag.album       + " "

end 
```

...但是如果我打开指向“http:// .../myfile.mp3”之类的文件的链接，它将不起作用。为什么？

有没有不同的方法来解决它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T20:26:18.087

TagLib 仅适用于本地文件系统上的文件。要从远程文件中检索标签，您首先必须将该文件下载到本地磁盘。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-07-26T16:14:31.707

所以文件系统的**路径**应该给`TagLib::MPEG::File.open`参数，而不是**url**。

# php - 删除操作失败。（Fsys 错误=32，服务器错误=1015）

> ID：14762349
> 
> 赞同：0
> 
> 时间：2013-02-07T22:35:00.740
> 
> 标签：php, ftp

`PHP`我对网络服务器和媒体服务器有一个非常奇怪的问题。我在网络服务器上有一个网站，可以将音频文件上传到媒体服务器。该网站还负责删除音频文件。但是，我遇到了一个非常奇怪的错误，我用谷歌搜索了我的大脑试图找到但没有运气。

> 警告：ftp_delete() [function.ftp-delete]：删除操作失败。（Fsys 错误=32，服务器错误=1015）在 /......./page.php 第 175 行

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T15:47:46.443

我遇到了类似的事情。我就是这样做的，问题解决了

代码：

```
ftp_chmod( $ftpConnection, 777, $filelist ) ;
ftp_get( $ftpConnection, $dest . '\\' . $str, $str, FTP_BINARY ) ;
ftp_delete( $ftpConnection, $str ) ; 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-26T21:29:31.473

在玩了一些之后，我们能够弄清楚问题出在媒体服务器上。删除命令来自网络服务器，但如果音频文件是最近播放的，则媒体服务器会保持音频文件打开以进行流式传输，因此在媒体服务器发布之前无法对文件本身执行任何命令文件。所以我们所要做的就是等待 2 或 3 秒，我们就不再有这个问题了。

# php - PHP：抽象 PDO 数据库。性能注意事项

> ID：14762350
> 
> 赞同：0
> 
> 时间：2013-02-07T22:35:01.283
> 
> 标签：php, performance, design-patterns, pdo

我正在 PHP 中的数据库上构建一个抽象层。

我使用 PDO，一切都在纯命令式脚本中完美运行。

现在我想用 MVC 将这堆代码（一个 Web 服务 API）交换为 OOP 方法，我试图抽象 DB 接口以进行调用，例如（在竞赛数据库环境中）getRaceList(); 或 getRookieAthlets(); 等，并在其他任何地方展示它们。

如果我在要调用的持久性类中做这样的事情，它会完美地工作

```
class Persistantance{

   //other methods

/**
 * return all races
 **/
public function getRaces(){

    $result = null;
    try {   
        $db = $this->connect(); //return a PDO object
        $query = "SELECT races.title, races.year, races.id FROM races;";
        //here use prepared statement statements if needed
        $result = $db->query($query);
        $races = array();
        foreach ($result as $record) {
            //here insert $record in $races
        }
        $result->closeCursor();

        $db = null;
    }catch(PDOException $e){
        // Print PDOException message
        echo $e->getMessage();
    }
    return $races;
}
}

class View{
    public function viewRaces(){
        //...
        $races = $pers->getRaces();
        foreach($races as $race)
            printRecord($race);
        //...
    }
} 
```

它会起作用，但就像 $stmnt->fetchAll() 它非常占用内存，因为它将所有内容都带入内存。Db 相当大，但由于想象力，我不太可能得到非常大的数组，但我想知道一个尽可能与大小无关的模式。另一方面，如果我构建一个迭代器，我会使 Persistance 接口复杂化很多（我想分发接口）：

```
//from a view class
perist->a_query()
repeat untill null
    perist->fetch_last_query_next()
perist->close_conn() 
```

此外，如果不使具有多个迭代器方法的接口更加复杂，就不可能并行执行更多查询。

# zend-framework2 - Zend2 隔离模块配置

> ID：14762351
> 
> 赞同：0
> 
> 时间：2013-02-07T22:35:02.107
> 
> 标签：zend-framework2

似乎`Module.php`在`getConfig`方法中定义的所有配置设置都在应用程序中全局合并。这对我来说很奇怪，因为我需要为每个模块设置不同的配置：数据库设置、一些工厂和 view_manager 设置，这些设置当前被最后一个加载的模块覆盖。如何使用某些模块专有的配置是`$this->getServiceLocator()->get('Config')`该模块的范围。我现在唯一的想法是将我的模块配置与`$this->getServiceLocator()->get('Config')`调度事件合并，如果这是唯一的情况，那么使用什么优先级更好，这样我就可以利用所有设置：view_manager、service_manager 等？

对我来说，理想的解决方案是，如果某个命名空间范围内的配置设置仅在该命名空间下使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T01:28:09.300

您可以随意嵌套配置值。

想象一下，您有一个名为“mymodule”的模块，它需要连接到一个特殊的、特定于模块的数据库（与整个应用程序的主数据库不同）。你会做这样的事情：

**mymodule.global.php.dist：**

```
return array(
    'mymodule' => array(
        'db' => array('host'=>'localhost', ... )
    )
) 
```

然后确保 myModule 正在查看`$config['mymodule']['db']`，而不是`$config['db']`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-06T02:10:52.713

可以通过这种方式获取模块的配置设置：

```
$moduleManager = $this->getServiceLocator()->get('ModuleManager');
$applicationModule = $moduleManager->getModule('Application');
$applicationConfig = $applicationModule->getConfig(); 
```

# javascript - 使用空模型作为占位符填充主干集合

> ID：14762352
> 
> 赞同：0
> 
> 时间：2013-02-07T22:35:03.900
> 
> 标签：javascript, model-view-controller, backbone.js, backbone-views, backbone.js-collections

我正在使用主干编写一个 Web 应用程序。我将在网页上以网格格式显示缩略图列表。

我创建了一个名为 PhotosView 的视图，它正在监听主干集合

```
PhotosView = Backbone.View.extend({
    template: _.template( $('#container').html() ), 
```

然后对于每张照片，我创建了另一个视图，它代表该列表中的每个缩略图

```
EachPhotoView = Backbone.View.extend({
    template: _.template($('#thumbnail').html()), 
```

照片视图正在侦听一个集合，并在重置事件时为所有要显示的照片创建 EachPhotoView。EachPhotoView 然后侦听与其关联的模型以获取更改事件。

我现在正在尝试对这些缩略图进行分页。我现在只要求查看那些缩略图，但我仍然必须为所有图像创建占位符。

所以我的问题是，用空骨干模型的数量填充集合是否是个好主意，并且将来当我真正得到这些模型时，从集合中替换它们。这将解决我有占位符的问题。有没有其他方法可以做到这一点？

* * *

编辑：我说的是缩略图的网格布局，比如单个页面上的 500 个，当您向下滚动时，我请求这 500 个中的部分。我必须创建所有占位符（全部 500 个）缩略图，因为那样会给容器 div 适当的高度（对于 500 个图像），所以我必须在集合中拥有所有 500 个模型（虽然是虚拟的），这将帮助我将视图上的事件附加到那些空模型，并且当我获得这些缩略图元数据时，我将添加它在集合中的相应模型中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T01:20:22.663

如果我理解正确，您将有一个缩略图网格（比如 30 个缩略图）和后退/前进按钮。

我要做的是让您的收藏只代表视图中的项目，并使用您的后退/前进按钮来更改 this.page 属性，然后重新`fetch()`整个收藏（将 30 个缩略图替换为下一页上的 30 个）。

[这段代码](https://gist.github.com/io41/838460)是如何设置分页集合和分页视图的一个很好的例子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T18:42:44.113

我想，每一个`Model`已经存在的地方都已经有一个与之关联的记录。如果没有，您`Data Source`应该包含它们，并且您的客户端`View`将根据该`Collection`记录呈现它们。唯一缺少的是，`Image`目前这些记录中的某些记录不可用。

Those `Models` will have a property of `imgSource` that will be empty. Your `View` will then handle and perform a check if whether the `imgSource` property is empty and replace it some default `Thumbnail`.

```
<img src="<%- imgSource ==='' ? '/images/default.jpg' : '/images/'+ imgSource %>" 
   alt="imgDesc" /> 
```

# java - 使用杰克逊注释反序列化带有子数组的JSON？

> ID：14762358
> 
> 赞同：1
> 
> 时间：2013-02-07T22:35:37.660
> 
> 标签：java, json, jackson

我正在尝试解析一些包含嵌套数组的 JSON。我希望数组映射到我正在映射的父对象中的子对象列表。这是（稍微缩写的）JSON 和 Java 类

JSON：

```
{
    "id": "12121212121",
    "title": "Test Object",
    "media$content": [
        {
            "plfile$audioChannels": 1,
            "plfile$audioSampleRate": 18000,
        },
        {
            "plfile$audioChannels": 2,
            "plfile$audioSampleRate": 48000,
        },
        {
            "plfile$audioChannels": 2,
            "plfile$audioSampleRate": 48000,
        }
    ]
} 
```

Java 类

```
class MediaObject {
    @JsonProperty("id")
    private String id;

    @JsonProperty("title")
    private String title;

    @JsonProperty("media$Content")
    private List<MediaContent> mediaContent;

    ... getters/setters ...

}

class MediaContent {

    @JsonProperty("plfile$audioChannels")
    private int audioChannels;

    @JsonProperty("plfile$audioSampleRate")
    private int audioSampleRate;

    ... getters/setters ...
} 
```

我希望能够使用注释以及标准映射器代码进行反序列化，即 mapper.readValue(jsonString, MediaObject.class)

“id”和“title”字段一切正常，但我的 MediaContent 对象列表总是为空。这似乎是杰克逊应该能够毫不费力地处理的事情，谁能看到我在这里做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T22:47:06.183

json 字段的名称是错误的 - 属性不是`media$Content`，而是`media$[c]ontent`。否则我不明白为什么它不起作用。

# c# - 如何将模拟对象传递给另一个模拟对象构造函数

> ID：14762362
> 
> 赞同：0
> 
> 时间：2013-02-07T22:35:49.097
> 
> 标签：c#, unit-testing, moq

```
 /// <summary>
    ///A test for ReverseName
    ///</summary>
    [TestMethod()]
    public void ReverseNameTest()
    {
        Mock<IEntityName> entityName = new Mock<IEntityName>();
        entityName.SetupProperty(x => x.FirstName, "John");
        entityName.SetupProperty(x => x.LastName, "T.");

        var p = new Person(entityName.Object);

        string expected = "Your reverse name is T. John"; 
        string actual;
        actual = p.ReverseName();
        Assert.AreEqual(expected, actual);
    }
} 
```

//人物类

```
 public Person(IEntityName EntityName)
    {
        this.EntityName = EntityName;
    } 
```

是否可以在 TestMehod 中模拟 Person 类，或者我是否必须像上面那样创建 Person 的实例？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T22:41:47.570

是的你可以。犀牛模拟支持这一点，不确定起订量，但我认为你也可以这样做

看看这个线程。 [将 Moq 模拟对象传递给构造函数](https://stackoverflow.com/questions/7011572/passing-moq-mock-objects-to-constructor)

[当构造函数有参数时使用 Moq 模拟对象](https://stackoverflow.com/questions/7414704/mocking-objects-with-moq-when-constructor-has-parameters)

# java - 在 xcode 中为 java 使用 OpenGL 包装器

> ID：14762365
> 
> 赞同：0
> 
> 时间：2013-02-07T22:35:53.447
> 
> 标签：java, xcode, opengl, jogl

我已经在 c++ 中使用 opengl 已经有一段时间了，我希望通过学习在 java 中使用 opengl 来扩展到 android/mac-app 市场。我希望能够在 xcode 中执行此操作，因为它将应用程序打包得如此整齐，但我对 xcode 大多是新手，而且对我来说很陌生。我一直在试图弄清楚如何让它与 jogl 一起工作，但没有成功——而且我不知道该去哪里！互联网完全没有帮助。有没有人有想法或建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T22:48:22.593

Xcode 对于开发 java 来说是非常痛苦的。我会劝阻它。有很多非常不错的 java 编辑器提供相同类型的调试和打包。Xcode 不允许您在没有经过认真修改和黑客攻击的情况下为 Android 构建。

Xcode 非常适合开发 Objective-C，如果您计划为 iOS/Mac 开发，您应该关注这一点。

Apple 有很多关于使用 OpenGL (ES) 的教程，但它们都是基于 Obj-C 的。

我建议为 Java 寻找一个好的 IDE，例如 Eclipse。下载 Android SDK 将为您提供专门用于 Android 开发的 Eclipse 版本。然后遵循一个java教程，例如：

[http://www.land-of-kain.de/docs/jogl/](http://www.land-of-kain.de/docs/jogl/)

谷歌还通过他们的 api 提供 Android 的 OpenGL ES 教程：http: [//developer.android.com/guide/topics/graphics/opengl.html](http://developer.android.com/guide/topics/graphics/opengl.html)

总而言之，我试图让 Xcode 与 Java 配合得很好的经验会导致挫败感。学习 eclipse 非常有价值，因为它实际上是一个无处不在的编辑器。

# c# - 如何在 WinForms 的当前活动选项卡中获取 Webbrowser 的实例

> ID：14762369
> 
> 赞同：-2
> 
> 时间：2013-02-07T22:36:08.257
> 
> 标签：c#, winforms

我有一个选项卡控件，其中包含三个选项卡，每个选项卡在选项卡内都有一个 Web 浏览器。（选项卡里面也有其他控件）。

我想在当前活动的选项卡中获取 Web 浏览器的实例。

我如何得到它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T23:02:02.350

假设一个名为“TabControl1”的 TabControl，这应该可以解决问题：

```
public Control GetWebBrowserControl()
{
    foreach (Control ctl in TabControl1.SelectedTab.Controls) {
        if (ctl is WebBrowser) {
            return ctl;
        }
    }
    return null;
} 
```

# actionscript-3 - Flash Actionscript 3 错误？在 switch/case 中使用 int 和负数

> ID：14762373
> 
> 赞同：20
> 
> 时间：2013-02-07T22:36:14.683
> 
> 标签：actionscript-3, flash, debugging, actionscript, flash-builder

运行此代码

```
var myValue1:int = 2;
switch (myValue1)
{
    case -3: trace(myValue1 + " == -3"); break;
    case -2: trace(myValue1 + " == -2"); break;
    case -1: trace(myValue1 + " == -1"); break;
    case 0:  trace(myValue1 + " == 0"); break;
    case 1:  trace(myValue1 + " == 1"); break;
    case 2:  trace(myValue1 + " == 2"); break;
    case 3:  trace(myValue1 + " == 3"); break;
    default: trace(myValue1 + " is unknown"); break;
}

var myValue2:int = -2;
switch (myValue2)
{
    case -3: trace(myValue2 + " == -3"); break;
    case -2: trace(myValue2 + " == -2"); break;
    case -1: trace(myValue2 + " == -1"); break;
    case 0:  trace(myValue2 + " == 0"); break;
    case 1:  trace(myValue2 + " == 1"); break;
    case 2:  trace(myValue2 + " == 2"); break;
    case 3:  trace(myValue2 + " == 3"); break;
    default: trace(myValue2 + " is unknown"); break;
} 
```

给出这个输出：

```
2 == 0
-2 未知

```

*（在 Flash Builder 4.7.0.349722 中编译，在 Flash 11.5.502.149 上运行。在 Windows 7 SP1、Firefox 18.0.2 中运行）*

以下更改都解决了上述问题，并提供了正确的输出：

*   将值类型更改为`Number`.
*   删除负数`case`语句。
*   将语句更改`case`为使用`int`-**变量**而不是**文字**......除非这些变量也是`const`，在这种情况下它会被破坏！

改变`myValue2 = -1`给出了输出`-1 == -3`，这同样是 wtf-ish。

* * *

显然这是一个错误，但是......是什么原因造成的？`int` 在我不理解的案例陈述中使用或负数是否有一些微妙的细微差别？我的代码有什么错误吗？或者这仅仅是 Flash Builder 中字节码编译器的问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T14:22:47.163

我不认为你会找到这个问题的具体答案。我可以提供的是对 AS3 编译器错误的确认。我花了很长时间试图解决类似的“神奇”错误，结果却一无所获。一个这样的例子是 For 和 While 循环无缘无故地跳过数组中的第一项或最后一项，而 Foreach 循环工作得很好。

对我来说，最合理的原因是内存管理中的错误。这也可能与硬件有关，因为在我或我的同事工作的某些机器上发生此类事情的频率更高。我认为满足一些“不可见”条件，例如执行操作的顺序（您可以尝试在 var 声明和开关之间放置一些虚拟代码，或者可能多次分配 var 值，只是为了“慢跑记忆” ) 与容易出错的编译器相结合会弄乱内存寻址，并且您的开关认为它与两个整数有关，而实际上它从内存中获得了不同的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T22:25:18.137

您可以通过将原始值转换为 String 并将您的案例转换为 String 值来强制编译器进行操作。

```
switch( String(value) )
{
   case "-3": /*do something*/; break;
   case "-2": /*do something*/; break;
   case "-1": /*do something*/; break;
   case  "0": /*do something*/; break;
   case  "1": /*do something*/; break;
   case  "2": /*do something*/; break;
   case  "3": /*do something*/; break;
   default: break;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-17T21:52:33.047

这只是 Flash Builder 中字节码编译器的一个问题。

显然，您的语法很好；可追溯到 2005 年的编译器实际上存在数百个已知问题，这些问题仍然存在或未解决。

# sql - 在我的示例中，如何在 SQL 中使用 CASE？

> ID：14762374
> 
> 赞同：0
> 
> 时间：2013-02-07T22:36:21.157
> 
> 标签：sql, sql-server-2008

我有 3 列数据：年龄、性别、分数。年龄是年龄，性别是 M 或 F，分数范围为 1-100。

如何创建一个新列，以便如果性别为 M，则在 Points 列中添加 5 分，如果性别为 F，则从 Points 列中的任何内容中减去 3 分？

我想我需要 CASE。我使用 ALTER TABLE 添加了一个名为 PointsRevised 的新列，然后添加。

现在，我想用新值填充这个新的 PointsRevised 列，具体取决于性别是 M 还是 F。

```
UPDATE [Example].[dbo].[example]
SET POINTSREVISED
CASE 
WHEN Gender = 'M' Then PointsRevised = Points + 5  
WHEN Gender = 'F' Then PointsRevised = Points - 3
END 
```

我显然做错了什么。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-07T22:38:17.883

这将起作用：

```
UPDATE [Example].[dbo].[example]
SET POINTSREVISED =
  CASE 
  WHEN Gender = 'M' THEN Points + 5  
  WHEN Gender = 'F' THEN Points - 3
  END 
```

更简单：

```
UPDATE [Example].[dbo].[example]
SET POINTSREVISED =
  CASE Gender
  WHEN 'M' THEN Points + 5  
  WHEN 'F' THEN Points - 3
  END 
```

如果 Gender 的唯一有效值是 'M' 和 'F' （并且不能为 NULL），您可以将上面`WHEN 'F' THEN`的内容简单地替换为`ELSE`.

根据您的要求，[计算列](https://stackoverflow.com/questions/4093014/sql-server-calculated-column)可能会更好。

# c# - UdpClient 语法 FromAsync

> ID：14762375
> 
> 赞同：1
> 
> 时间：2013-02-07T22:36:21.833
> 
> 标签：c#, task-parallel-library

对 c# 和任务来说非常新...试图找到将 UDPclient 包装到 FromAsync(...) 中的正确语法，似乎我错过了一些参数...（不能使用 ReceiveAsync，因为它应该与 .NET 4.0 一起使用）

```
public Task<byte[]> GetUDPmessageAsync()
{
    byte[] data = new byte[100];
    myUdpClient = new UdpClient(12000);

    Task<byte[]> task = Task<byte[]>.Factory.FromAsync(myUdpClient.BeginReceive, myUdpClient.EndReceive,?,?);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T22:51:17.760

我不认为你可以使用`FromAsync`，因为`UdpClient.EndReceive`需要一个 ref 参数，这使得它与`FromAsync`. 您可以制作自己的扩展方法：

```
public static Task<byte[]> ReceiveAsync(this UdpClient client, IPEndPoint endpoint)
{
    TaskCompletionSource<byte[]> tcs = new TaskCompletionSource<byte[]>();
    AsyncCallback callback = ar => {
        try
        {
            byte[] bytes = client.EndReceive(ar, ref endpoint);
            tcs.SetResult(bytes);
        }
        catch(Exception ex)
        {
            tcs.SetException(ex);
        }
    };
    client.BeginReceive(callback, null);
    return tcs.Task;
} 
```

# c# - C#中的匹配标签

> ID：14762376
> 
> 赞同：2
> 
> 时间：2013-02-07T22:36:24.730
> 
> 标签：c#

我正在尝试将标签与 C# 匹配，但在使其正常工作时遇到了一些麻烦。我有这些标签：

```
<categories=1></categories=1> 
```

`=1`可以是任何数字。它可以是 1、2、3 或任何其他给定的数字。有没有办法在 C# 中使用 IndexOf 或 RegEx 或更好的方法来匹配这个标签。

所以举一个我想如何使用它的例子。我会有类似的东西：

```
if (PUT WORKING CODE HERE ONCE FIGURED OUT)
{
    Do Something
} 
```

是否有捷径可寻？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T22:42:52.063

我建议首先通过替换那些等式符号使文档成为有效的 XML，然后使用任何 XML 解析器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T22:39:23.360

这种需求只有一个有效的答案，除非你正在做作业并且需要学习如何自己编写代码......

避免从头开始重新发明事物并使用[Html Agility Pack](http://htmlagilitypack.codeplex.com/)

它被称为 Html，但也处理 XML 文件，以防您必须做更复杂的事情，例如解析，并且不想或不能使用纯 XPath 和 XML 相关的 .NET Framework 类。

有关示例，请参见此处：[如何使用 HTML 敏捷包](https://stackoverflow.com/questions/846994/how-to-use-html-agility-pack)

# entity-framework - EF Code First Edit 对映射实体没有影响

> ID：14762382
> 
> 赞同：0
> 
> 时间：2013-02-07T22:36:38.207
> 
> 标签：entity-framework, code-first

我首先使用实体​​框架代码。我有两个实体：

```
 public class Meal 
{
    [Key]
    [DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    public int MealID { get; set; }

    public virtual List<MealCategory> MealCategories { get; set; }

} 
  public class MealCategory
{
    [Key]
    [DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    public int MealCategoryID { get; set; }

    public virtual List<Meal> Meals { get; set; }

} 
```

它们在配置中映射：

```
 protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
      modelBuilder.Entity<Meal>()
         .HasMany(c => c.MealCategories)
         .WithMany(x => x.Meals)
         .Map(a =>
         {
             a.ToTable("MealCategoryMapping");
             a.MapLeftKey("MealID");
             a.MapRightKey("MealCategoryID");
         });

    } 
```

添加具有现有类别的新餐点时，它可以完美运行，ID 已正确插入映射表中

```
 Meal Meal = new Meal();

        Meal.MealCategories = new List<MealCategory>();

        var categoryToBeAdded = (from x in Context.MealCategoreis where x.MealCategoryID == 1 select x).FirstOrDefault(); 
      Meal.MealCategories.Add(categoryToBeAdded);

        MealDataContext.Add(Meal);
        MealDataContext.SaveChanges(); 
```

但是，如果我尝试编辑餐点并添加新类别，则映射表中不会发生任何事情。旧条目保持不变，不添加新条目。

```
 Meal Meal = (from x in MealDataContext where x.MealID == 1 select x).FirstOrDefault();

        Meal.MealCategories = new List<MealCategory>();

        var categoryToBeAdded = (from x in Context.MealCategoreis where x.MealCategoryID == 4 select x).FirstOrDefault(); 
      Meal.MealCategories.Add(categoryToBeAdded);

        MealDataContext.Attach(entityToUpdate);
        MealDataContext.Entry(entityToUpdate).State = EntityState.Modified;
        MealDataContext.SaveChanges(); 
```

没有异常或一些想法被抛出。你能告诉我如何删除所有旧的映射条目并在编辑时添加新的条目吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T00:18:39.230

首先让我说您可以使用[`Find`](http://msdn.microsoft.com/en-us/library/system.data.entity.dbset.find%28v=vs.103%29.aspx)从数据库中获取一个对象（或者如果它已经存在于本地集合中，则从 DbContext 缓存中获取）：

```
Meal meal = MealDataContext.Meals.Find(4);
// (lower case variable name is conventional) 
```

您应该意识到此时的`meal`对象有一个`MealCategories`由 Entity Framework 跟踪的集合。您不必，不，不*应该*用新的替换它。如果此时已加载集合，则替换它会从所有者那里删除类别，`meal`并且当您保存更改时，连接记录将被删除！

在您的情况下，未加载集合，因此不会发生这种情况。

我不完全清楚为什么您添加到`MealCategories`集合中的类别没有保存。也许是因为它似乎来自不同的上下文（或者这是一个错字？）。但这应该引发异常。无论如何，请确保

1.  您不替换`MealCategories`集合，并且
2.  向其添加一个类别，该类别由与餐点相同的上下文实例获取

你应该没事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T11:42:31.750

试试这个。调用`Collection("MealCategories").Load();`应该让 EF 创建一个跟踪的集合。

```
Meal Meal = (from x in MealDataContext where x.MealID == 1 select x).FirstOrDefault();

MealDataContext.Attach(entityToUpdate);
MealDataContext.Entry(entityToUpdate).State = EntityState.Modified;
MealDataContext.Entry(entityToUpdate).Collection("MealCategories").Load();

var categoryToBeAdded = (
    from x in Context.MealCategories 
    where x.MealCategoryID == 4 
    select x).FirstOrDefault(); 

Meal.MealCategories.Add(categoryToBeAdded);

MealDataContext.SaveChanges(); 
```

# javascript - JQuery 工具提示仅在输入字段焦点上可见

> ID：14762387
> 
> 赞同：0
> 
> 时间：2013-02-07T22:36:57.173
> 
> 标签：javascript, jquery, jquery-ui, jquery-plugins, mouseover

如何使工具提示仅在输入字段焦点上可见并在焦点消失时隐藏工具提示。我不希望工具提示出现`mouseover`在`mouseout`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T22:40:14.373

```
$("input[id$=Textboxid]").focus(function() {
$("div[id$=tooltip]").show();
 });

 $("input[id$=Textboxid]").blur(function() {
 $("div[id$=tooltip]").hide();
}); 
```

这是一般的想法，但您可以根据需要进行操作

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T23:50:53.420

我通过解除绑定鼠标事件解决了这个问题

```
$(target).unbind('mouseenter mouseleave mouseover mouseout'); 
```

# mysql - MySQL选择日期范围，但也介于

> ID：14762394
> 
> 赞同：0
> 
> 时间：2013-02-07T22:37:28.807
> 
> 标签：mysql, dateadd

我的数据库由一组条目（按用户）组成，一周中的每一天都有一行，还有一年中每周只有一行的组。本周可能从周六、周日或周一开始。
sql按用户ID对所有这些行进行分组，并且对于用户每天都有一行的条目可以正常工作
我遇到的问题是选择每周只有一个条目的用户行
基本上如果行日期是2012年2月11日那么我需要能够选择该行，如果开始日期标准落在该日期或下一周内，并且所有行都在但不包括日期列在结束日期之后的*行*
我正在尝试像 dateadd 这样的所有内容sql，但我无法让它添加这些行。
希望我已经说清楚了。

假设我在 db 2013-02-02
2013-02-09中有两个条目

我的开始日期为 2013-02-05，结束日期为 2012-02-13
我需要将这两行作为：
开始日期在 2013-02-02 的一周内或之内
，我还需要 2013-02-09，因为结束日期在该日期的一周内或之内。
希望这能让它更清楚一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T22:46:32.080

不确定您的问题到底在问什么。

如果您的字段是 mysql date 或 datetime 类型，并且您想查找给定周是否有条目，您是否可以不使用[MySQL WEEK 函数](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_week)查找给定周的所有条目，您可能还需要包括限制年也是。

您也可以包括下一周，但您可能会遇到问题。主要问题是 2012 年的第 52+1 周不会给出 2013 年的第 1 周，而是 2012 年的第 1 周。

# windows - 程序将显示器从显示器切换到电视（并返回）

> ID：14762395
> 
> 赞同：0
> 
> 时间：2013-02-07T22:37:32.883
> 
> 标签：windows, winapi, multiple-monitors

我经常将我的桌面从 LCD 显示器切换到电视（来自 Nvidia 660 gtx 的 HDMI 输出）然后再切换回来。这样做是相当麻烦的——我也想让孩子们很简单。目前我必须右键单击桌面 -> 屏幕分辨率 -> 多显示器 -> 仅在 1 上显示桌面 -> 好的。然后转到电视并在“此分辨率是否正常”提示上单击“确定”。

我想要一个按钮 - 最好在另一台设备上没有提示。

知道我需要查看 Windows API 的哪一部分吗？也许我可以通过shell命令来做到这一点？

任何指针都会受到欢迎，因为我不知道从哪里开始。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T23:46:51.897

Windows 7 中有一个键盘快捷键可以做你想做的事.... Windows + P

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T22:54:36.533

我找到了 3 个不同的链接，这些链接描述了您的问题的可能解决方案。[WPF](http://www.kirupa.com/forum/showthread.php?249459-C-WPF-Monitor-Switcher)中的监视器切换器应用程序， [windows xp 的描述](http://www.codeproject.com/Articles/178027/How-to-create-a-display-switcher-for-Windows-XP)和有关该主题的[论坛帖子。](http://social.msdn.microsoft.com/Forums/en/csharpgeneral/thread/871a145c-1b24-48e0-9ddd-ea98957d3332)所有在第一个和第二个[谷歌页面](https://www.google.de/webhp?q=monitor%20switch%20c#)中，也许你可以在那里找到你的答案？

# eclipse-plugin - 为什么在编辑器中选择文本时会调用我的属性测试器？

> ID：14762401
> 
> 赞同：0
> 
> 时间：2013-02-07T22:38:01.450
> 
> 标签：eclipse-plugin, popup

在我正在编写的 Eclipse 插件中，我希望能够根据编辑器中当前选定行的内容使弹出菜单贡献可见或不可见。

为了配合这个，我使用了一个属性测试器。属性测试器执行的测试可能会有点耗时（约 200 毫秒），这在等待弹出菜单显示时是可以的。

但是我注意到，属性测试器不仅在即将显示弹出窗口时被调用，而且在我在编辑器中标记文本时也会调用它，从而使文本选择变得非常缓慢和烦人。

所以问题是：为什么在我选择/标记文本时调用它，而不仅仅是在即将显示弹出窗口时调用，我该如何避免这种情况？

这就是我设置属性测试器和菜单的方式：

```
<extension
     point="org.eclipse.core.expressions.propertyTesters">
  <propertyTester 
        class="popupmenucontribtest.PropertyTester"
        id="PopupMenuContribTest.test1"
        namespace="PopupMenuContribTest.propertyTester"
        properties="propertyTester1"
        type="java.lang.Object">
  </propertyTester> 
```

```
<extension
     point="org.eclipse.ui.menus">
<menuContribution
        allPopups="false"
        locationURI="popup:org.eclipse.ui.popup.any?after=additions">
     <command
           commandId="PopupMenuContribTest.command"
           label="My Popup Option"
           style="push">
        <visibleWhen
              checkEnabled="false">
           <and>
              <test
                 forcePluginActivation="true"
                 property="PopupMenuContribTest.propertyTester.propertyTester1">
              </test>
           </and>
        </visibleWhen>
     </command>
  </menuContribution> 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T05:07:48.410

`java.lang.Object`您使用定义中的属性指定要为 的每个实例调用该属性测试器`type`。将此限制为编辑器的更具体的超类。请参阅[此示例](http://help.eclipse.org/galileo/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/extension-points/org_eclipse_core_expressions_propertyTesters.html)，它仅限于资源。

也就是说，在我看来，200 毫秒的属性测试持续时间是不可接受的，因为用户会注意到这种延迟。

# coffeescript - 有没有更优雅的方式来编写这个 CoffeeScript？

> ID：14762404
> 
> 赞同：0
> 
> 时间：2013-02-07T22:38:07.330
> 
> 标签：coffeescript

这行得通，但是有没有人建议以更简化/优雅的方式来写这个？：

```
if @mediaAddQueue[''+mid]['mediaType'] is 'photo' and
  @mediaAddQueue[''+mid]['econ_status'] is 'loaded' and
  @mediaAddQueue[''+mid]['medium_status'] is 'loaded' and
  @mediaAddQueue[''+mid]['thumb_status'] is 'loaded' and
  not @mediaAddQueue[''+mid]['targetEventRecord']?
    @addMedia @mediaAddQueue[''+mid]['targetEventRecord'], mid, @mediaAddQueue[''+mid]['mediaType']
else if @mediaAddQueue[''+mid]['mediaType'] is 'video' and
  @mediaAddQueue[''+mid]['video_status'] is 'loaded' and
  not @mediaAddQueue[''+mid]['targetEventRecord']?
    @addMedia @mediaAddQueue[''+mid]['targetEventRecord'], mid, @mediaAddQueue[''+mid]['mediaType'] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T23:37:53.603

当然是。总有*一些东西*可以重构。

**临时变量**

```
@mediaAddQueue[''+mid] 
```

无处不在。考虑通过引入一个临时辅助变量来重构：

```
elem = @mediaAddQueue[''+mid] 
```

代码会突然变得更具可读性。

**功能，功能，功能！**

我看到您执行了特定类型的检查（我假设我们有`elem`变量）：

```
elem['econ_status'] is 'loaded' and
elem['medium_status'] is 'loaded' and
elem['thumb_status'] is 'loaded' 
```

您可以编写一个函数来接受此类`elem`（或任何该对象）并执行此检查，其参数是对象、要比较的值和对象的键。由于 splats，这在 Coffee 中非常容易。

```
##
# Check whether all obj's keys are set to value.
checkAllKeys = (obj, value, keys...) ->
    for k in keys
        if obj[k] != value
           return false

    return true 
```

现在之前的代码块将变为：

```
checkAllKeys(elem, 'loaded', 'econ_status', 'medium_status', 'thumb_status') 
```

If you know that you will check for 'loaded' value often, make yourself another function:

```
checkLoaded = (elem, keys...) ->
    checkAllKeys(elem, 'loaded', keys...) 
```

If `'econ_status', 'medium_status', 'thumb_status'` keys are often checked together, then even one more function might be a good idea:

```
checkPhotoLoaded = (photo) ->
    checkLoaded(photo, 'econ_status', 'medium_status', 'thumb_status') 
```

My rule for refactorings is that one should write a function for all stuff that repeats more than twice. CoffeeScript makes writing functions fun, and fast.

I hope this has been helpful.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-07T23:40:53.980

Sure! First, notice that `@mediaAddQueue[''+mid]` is repeated all over the place, you can replace that with a variable. Also, there's no need to access properties like `something['prop']` if the property has a valid identifier as a name; you can do `something.prop`. Changing those two things already cleans the code quite a bit:

```
media = @mediaAddQueue[mid]

if media.mediaType is 'photo' and
  media.econ_status is 'loaded' and
  media.medium_status is 'loaded' and
  media.thumb_status is 'loaded' and
  not media.targetEventRecord?
    @addMedia media.targetEventRecord, mid, media.mediaType
else if media.mediaType is 'video' and
  media.video_status is 'loaded' and
  not media.targetEventRecord?
    @addMedia media.targetEventRecord, mid, media.mediaType 
```

Then, notice that the code inside both the `if` and the `else if` is the same. I think it would be great if you could give some meaningful name to the conditions so that the code becomes more self-documented and DRY. I don't know much about the context of this code, so i'll be guessing the variable names; try to use something that explains their meaning as clearly as possible:

```
media = @mediaAddQueue[mid]

isValidPhoto = media.mediaType is 'photo' and
  media.econ_status is 'loaded' and
  media.medium_status is 'loaded' and
  media.thumb_status is 'loaded' and
  not media.targetEventRecord?

isValidVideo = media.mediaType is 'video' and
  media.video_status is 'loaded' and
  not media.targetEventRecord?

if isValidPhoto or isValidVideo
  @addMedia media.targetEventRecord, mid, media.mediaType 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T17:13:00.487

Going from the epidemian answer, I would still refactor it a bit to this:

```
media = @mediaAddQueue[mid]

typeValidationMap =
  'photo' : (m) ->
    m.econ_status is 'loaded' and
    m.medium_status is 'loaded' and
    m.thumb_status is 'loaded'
  'video' : (m) ->
    m.video_status is 'loaded'
  'default': () -> no

isValidMedia = (m) ->
  return no if m.targetEventRecord?
  validate = typeValidationMap[m.mediaType] or typeValidationMap.default
  validate m

if isValidMedia media
  @addMedia media.targetEventRecord, mid, media.mediaType 
```

side note: I noticed you pass a always null targetEventRecord in that case

# haskell - 在“块”中的哪个位置

> ID：14762407
> 
> 赞同：0
> 
> 时间：2013-02-07T22:38:18.097
> 
> 标签：haskell

我正在做一个具有非常相似代码块的程序，并且我试图在“块”中创建一个位置。只是一个例子

```
function "sum" x = x + a
function "product" x = x * a
  where 
    a = 2 
```

我希望在两行中都替换“a”，但我没有发现这是否可以使用 where

提前致谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-07T23:28:15.430

如果你真的需要这个，你需要合并两个函数子句。一种方法：

```
func what x = case what of
        "add" -> x+a
        "mul" -> x*a
    where
       a = 2 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-08T01:05:38.737

您还可以引入第二个功能：

```
function fName x = function' fName x
   where
      a = 2
      function' "sum"     x = x + a
      function' "product" x = x * a 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T22:42:34.527

（请原谅我，因为我是新手。）我认为这是不可能的。“块”的范围`where`是它定义的函数。但是你可以做的是：

```
Prelude> let a = 2
Prelude> let sum x = x + a
Prelude> let product x = x * a
Prelude> sum 3
5 
```

这是在 GHCi 中完成的。您可能担心*每个人都*可以看到`a`，但是如果这是在 .hs 文件中，您可以将其设为模块而不是 export `a`，然后只有这些函数可以看到它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-08T01:36:08.363

我认为您可以定义一个新功能 geta

```
geta=2 
```

然后您可以在任何其他功能中使用 geta 功能。

我不认为混合每个函数是一个好方法，也许你会有 20 个函数需要相同的值

# groovy - 在 Mule ESB 中运行已编译的 Groovy 代码时无法调用 Java newInstance() 而不是 Groovy

> ID：14762408
> 
> 赞同：2
> 
> 时间：2013-02-07T22:38:19.423
> 
> 标签：groovy, mule

在我的 Mule ESB 3.3.0 应用程序中，以独立模式运行，我有一个调用 Groovy 代码的转换器，该代码作为 maven 相关 jar 包含在内。在我的 groovy 代码中，我正在调用一个具有 newInstance() 静态方法的 Java 对象，如下所示：

```
TransformerFactory.newInstance("net.sf.saxon.TransformerFactoryImpl", null) 
```

这在 Groovy 中导致错误，因为我认为它试图调用 Groovy 增强的 Class.newInstance() 方法。在 Mule 独立之外运行时不会发生这种情况（有关测试说明，请参阅下面的更新）。如何让它调用 Java 方法而不是 Groovy 方法？

这是我的堆栈跟踪的片段。你可以看到它的呼唤`DefaultGroovyMethods.newInstance()`。但我想改为调用该`javax.xml.transform.TransformerFactory.newInstance(String, ClassLoader)`方法。如何？

```
groovy.lang.GroovyRuntimeException: Could not find matching constructor for: javax.xml.transform.TransformerFactory(java.lang.String, null)
at groovy.lang.MetaClassImpl.invokeConstructor(MetaClassImpl.java:1459)
at groovy.lang.MetaClassImpl.invokeConstructor(MetaClassImpl.java:1375)
at org.codehaus.groovy.runtime.InvokerHelper.invokeConstructorOf(InvokerHelper.java:824)
at org.codehaus.groovy.runtime.DefaultGroovyMethods.newInstance(DefaultGroovyMethods.java:18025) 
```

更新：有关运行时环境的更多信息。Groovy 代码打包为 jar 文件，并从 Mule ESB 应用程序中调用。Mule 3.3.0 附带 groovy-all-1.8.6.jar。

UPDATE2：我做了一些进一步的测试并将一个 Groovy 类编译成一个 jar 文件并从一个独立的 Java 程序中调用它，并且没有遇到这个问题。这让我相信这是从 Mule 3.3.0 独立环境运行的问题。我在这篇文章中添加了一个骡子标签。希望Mule专家能告诉我发生了什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T13:09:52.647

在 Groovy 用户邮件列表的帮助下，我们确定在提供`javax.xml.transformer.Transformer`该类的 mule 类路径上必须有另一个 jar。我添加了这个示例代码：

```
Class klass = TransformerFactory.class; 
URL location = klass.getResource('/'+klass.getName().replace('.', '/')+".class"); 
```

果然！Mule 正在添加他们自己的 XML API jar。

```
TranformerFactory JAR: jar:file:/D:/java/mule/mule-standalone-3.3.0/lib/endorsed/xml-apis-1.3.04.jar!/javax/xml/transform/TransformerFactory.class 
```

为什么要覆盖 JDK Mule？

我的工作是直接实例化 Saxon TransformerFactory。它不是很优雅，但我唯一的选择。

```
tFactory = new net.sf.saxon.TransformerFactoryImpl() 
```

# github - Github 和 Dropbox 冲突风险？

> ID：14762409
> 
> 赞同：0
> 
> 时间：2013-02-07T22:38:19.947
> 
> 标签：github, dropbox

我有一个包含所有项目的 dev 文件夹。其中一些在 github 上，有些不在。我还使用 Dropbox（带有符号链接）来让我的数据在多台计算机上保持同步。

例如，如果我在一台 PC 上的 Documents 文件夹中添加了一些内容，那么我可以在另一台 PC 上的相应文件夹中看到它。

我的问题是：如果我对我的 dev 文件夹做同样的事情（所以 dev 文件夹由两台 PC 上的 Dropbox 同步）会导致我推送到 github 出现问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T20:00:45.927

您**永远**不想混合代码版本控制策略。您的所有代码都存在于 git 中（这是一个好主意），或者它们都存在于 Dropbox 中（这不会给您任何历史记录，因此是一个***非常糟糕的***主意）。

当您将源文件添加到 git 时，您*应该*强制将其推送到 Github，以便以后可以将其拉取。

我感觉你在推送代码时会遇到问题——你将通过一个源添加新文件，但从另一个源中提取——这将变成一个令人头疼的问题，而不是一个好处。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T15:48:24.447

我不确定您如何“证明”这是可以的。但是，我完全使用了这种开发模型，没有任何问题。我个人，不要在我的保管箱中使用符号链接，但这不会影响任何事情。我所有的 git 存储库都在我的 Dropbox 上。我已经在 OXS、Windows 和 Ubuntu 上以这种方式工作了一年多。我所有的提交和推送都工作得很好。

此外，这可能是对这个问题的重复：[有效地同时使用 Git 和 Dropbox？](https://stackoverflow.com/questions/1960799/using-gitdropbox-together-effectively)

[编辑：]

实际上，最近引起我注意的一件事是，您可能会遇到跨系统行尾的问题。来自 GitHub 的这篇文章（带有返回 SO question 的链接）解释了如何处理行尾。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-12T03:15:24.527

我有同样的问题，现在我的答案是“**只需将您的存储库移出 Dropbox** ”。

如您所见，[有效地同时使用 Git 和 Dropbox？](https://stackoverflow.com/questions/1960799/using-git-and-dropbox-together-effectively)不是同一个问题，但是如果你只是搜索关键词“GitHub”，你会看到关于你的困惑的争论。也许你会做出自己的决定。

# gxt - 其他区域折叠/展开时如何触发BorderLayoutContainer中心ContentPanel调整大小？

> ID：14762410
> 
> 赞同：0
> 
> 时间：2013-02-07T22:38:48.370
> 
> 标签：gxt

我希望 BorderLayoutContainer Center 区域内容面板在其他区域折叠/展开时填充到可用空间。

现在，中心区域移动到折叠空间但不调整大小。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T18:01:53.273

我已经通过 Sencha 论坛中的 api、源和提示进行了一系列挖掘，从而发现了这一点。

我的设置是一个中心 BorderLayoutContainer ContentPanel 和一个 MPV 视图 Composite VerticalLayoutContainer 围绕两个工具栏和一个网格。

问题是当中心 ContentPanel 调整大小时，工具栏和网格不会调整大小以填充空间。

我的解决方案是让 View VerticalLayoutContainer Composite 实现 HasLayout 接口，并在周围的 ContentPanel 中添加一个 ResizeHandler()。

```
centerContentPanel.addResizeHandler( new ResizeHandler() {

@Override
public void onResize(ResizeEvent event) {
    Widget w = centerContentPanel.getWidget();
    if (w instanceof HasLayout) {
        ((HasLayout) w).forceLayout();
    }
  }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T20:26:33.790

我知道这个答案已经很晚了......但试着把你`BorderLayoutContainer`放在一个`ViewPort`. 这是`ViewPort`小部件的 JavaDoc：[GXT ViewPort](http://dev.sencha.com/deploy/gxt-3.0.0/javadoc/gxt/)。

# android - 我的 Android 多线程有什么问题？

> ID：14762411
> 
> 赞同：0
> 
> 时间：2013-02-07T22:38:48.140
> 
> 标签：android, multithreading, runnable, android-anr-dialog

我有一个从服务器发送和接收数据的应用程序。这些请求中的每一个都是通过创建一个新线程来发出的，以防止锁定 UI。在我的设备上和测试中，我没有收到任何 ANR，但似乎其他用户会不时遇到它们。

在一个示例中，在 Play 商店中查看我的 ANR 报告表明我从我的登录功能收到了一些 ANR。

当用户输入他们的凭据并按下登录按钮时，onCreate 会调用 login() 函数来检索有关用户的其他信息。该代码包含以下内容：

```
 new Thread(new Runnable() {
        public void run() {
            UserClient userClient = application.getUserClient();

            final Map<String, Object> user = userClient.getUser();

          runOnUiThread(new Runnable() {
            public void run() {
                Login.this.hideLoadingThrobber();

                if (user != null) {
                    startActivity(new Intent(Login.this, AccountOverview.class));
                    finish();
                } else {
                    showLoginFailed();
                }
            }
          });
        }
    }).start(); 
```

userClient.getUser() 看起来像这样：

```
public Map<String, Object> getUser() {
    RestClient client = getRestClient();
    String result = client.queryRESTurl("/user/");
    if (result != null && !result.equals("login failed")) {
        return JsonParser.toMap(result);
    } else {
        return null;
    }
} 
```

据我所知，这是为了防止任何类型的 ANR 而正确设置的，但对于某些用户，它仍然会不时弹出。

有什么看起来不寻常或我做错了吗？我应该以不同的方式处理我的线程吗？

# visual-studio-2012 - 如何在 Visual Studio 数据库项目脚本中获取数据库名称？

> ID：14762412
> 
> 赞同：3
> 
> 时间：2013-02-07T22:38:50.933
> 
> 标签：visual-studio-2012, sql-server-data-tools, database-project

我想使用 Visual Studio 数据库项目在我的数据库中启用更改跟踪。

命令是

```
ALTER DATABASE ##database name##
SET CHANGE_TRACKING = ON
(CHANGE_RETENTION = 2 DAYS, AUTO_CLEANUP = ON) 
```

但我无法计算出格式字符串来获取数据库名称

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-07T22:44:43.113

使用该`$(DatabaseName)`物业。在 .sqlcmdvars 文件中：

> 目标数据库名称（部署时设置）。按 F1 了解更多信息。

# ruby-on-rails - 路由嵌套资源和匹配控制器

> ID：14762418
> 
> 赞同：7
> 
> 时间：2013-02-07T22:39:02.937
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, routes, nested

在过去的几天里，我在让我的嵌套资源正确创建和显示时遇到了问题。StackOverflow 上有很多类似的问题，也有很多关于此的博客文章，但它们似乎都处理的是旧版本的 Rails 或不同的问题。我正处于一旦我最终修复某些东西，就会弹出另一个错误的地步。我把它缩小到我犯了一个愚蠢的错误或错字太缺乏经验而没有注意到。

我有一个属于 Venue 模型的 Jobs 模型。场地运行良好，我什至能够进入每个场地下的嵌套作业索引并调出新建和编辑表单，但是去“显示”或创建新作业会导致`undefined method`错误。经过大量搜索后，我发现了很多相同的问题并尝试实施他们的修复，但现在我遇到了路由错误。

我的大部分困惑来自何时离开@，何时在参数中使用 :venue_id 而不是 :id 等等。我看到的每个示例似乎都有不同的方式，我似乎无法让它们中的任何一个工作我。

任何朝着正确方向的颠簸都会非常有帮助。

**路由错误**

```
No route matches {:action=>"show", :controller=>"jobs", :venue_id=>#<Venue id: 1, name: "Burger Chef", city: "Chicago", state: "Illinois", areacode: 60614, created_at: "2013-02-05 21:33:41", updated_at: "2013-02-06 23:01:05", avatar_file_name: nil, avatar_content_type: nil, avatar_file_size: nil, avatar_updated_at: nil>} 
```

**路线.rb**

```
Twist::Application.routes.draw do

  resources :users
  devise_for :users

  resources :venues do
    resources :jobs
  end

end 
```

**作业控制器.rb**

```
class JobsController < ApplicationController
  # GET /jobs
  # GET /jobs.json
  before_filter :get_venue

  def get_venue
    @venue = Venue.find(params[:venue_id])
  end

  def index
    @jobs = @venue.jobs

    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @jobs }
    end
  end

  # GET /jobs/1
  # GET /jobs/1.json
  def show
    @job = @venue.job.find(params[:id])

    if params[:id]
      @venue = Venue.where(:id => params[:id]).first
      @jobs = @venue.job_url
    else
      @jobs = Jobs.all
    end

    respond_to do |format|
      format.html # show.html.erb
      format.json { render json: @job }
    end
  end

  # GET /jobs/new
  # GET /jobs/new.json
  def new
    @job = @venue.jobs.build

    respond_to do |format|
      format.html # new.html.erb
      format.json { render json: @job }
    end
  end

  # GET /jobs/1/edit
  def edit
    @job = @venue.job.find(params[:venue_id])

  end

  # POST /jobs
  # POST /jobs.json
  def create
    @job = @venue.jobs.new(params[:job])

    respond_to do |format|
      if @job.save

        format.html { redirect_to :action => :show, :id => @venue.id, 
                      notice: 'Job was successfully created.' }
        format.json { render json: [@venue, @job],
                             status: :created, 
                             location: [@venue, @job] }
      else
        format.html { render action: "new" }
        format.json { render json: @job.errors, status: :unprocessable_entity }
      end
    end
  end

  # PUT /jobs/1
  # PUT /jobs/1.json
  def update
    @job = Job.find(params[:id])

    respond_to do |format|
      if @job.update_attributes(params[:job])
        format.html { redirect_to @job, notice: 'Job was successfully updated.' }
        format.json { head :no_content }
      else
        format.html { render action: "edit" }
        format.json { render json: @job.errors, status: :unprocessable_entity }
      end
    end
  end

  # DELETE /jobs/1
  # DELETE /jobs/1.json
  def destroy
    @job = Job.find(params[:id])
    @job.destroy

    respond_to do |format|
      format.html { redirect_to jobs_url }
      format.json { head :no_content }
    end
  end
end 
```

**场地控制器.rb**

```
class VenuesController < ApplicationController
  # GET /venues
  # GET /venues.json

  def index
    @venues = Venue.all

    if params[:name]
      @user = User.where(:name => params[:name]).first
      @venues = @user.venues
    end

    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @venues }
    end
  end

  # GET /venues/1
  # GET /venues/1.json
  def show
    @venue = Venue.find(params[:id])

    respond_to do |format|
      format.html # show.html.erb
      format.json { render json: @venue }
    end
  end

  # GET /venues/new
  # GET /venues/new.json
  def new
    @venue = Venue.new

    respond_to do |format|
      format.html # new.html.erb
      format.json { render json: @venue }
    end
  end

  # GET /venues/1/edit
  def edit
    @venue = Venue.find(params[:id])

    #if session[:user_id] != @venue.user_id
    #  flash[:notice] = "Sorry, you cannot edit this venue."
    #  redirect_to(venues_path)
    # =>end
  end

  # POST /venues
  # POST /venues.json
  def create
    @venue = Venue.new(params[:venue_id])

    respond_to do |format|
      if @venue.save
        format.html { redirect_to @venue, notice: 'Venue was successfully created.' }
        format.json { render json: @venue, status: :created, location: @venue }
      else
        format.html { render action: "new" }
        format.json { render json: @venue.errors, status: :unprocessable_entity }
      end
    end
  end

  # PUT /venues/1
  # PUT /venues/1.json
  def update
    @venue = Venue.find(params[:id])

    respond_to do |format|
      if @venue.update_attributes(params[:venue])
        format.html { redirect_to @venue, notice: 'Venue was successfully updated.' }
        format.json { head :no_content }
      else
        format.html { render action: "edit" }
        format.json { render json: @venue.errors, status: :unprocessable_entity }
      end
    end
  end

  # DELETE /venues/1
  # DELETE /venues/1.json
  def destroy
    @venue = Venue.find(params[:id])
    @venue.destroy

    respond_to do |format|
      format.html { redirect_to venues_url }
      format.json { head :no_content }
    end
  end
end 
```

**工作.rb**

```
class Job < ActiveRecord::Base
  attr_accessible :description, :name, :requirement, :venue_id

  validates :name, :presence => true, :length => { :minimum => 3 }

  belongs_to :venue
end 
```

**场地.rb**

```
class Venue < ActiveRecord::Base
  attr_accessible :areacode, :avatar, :city, :name, :state

  has_many :jobs

  has_attached_file :avatar, :styles => { :medium => "300x300>", :thumb => "100x100>" }

end 
```

**/jobs/show.html.erb**

```
<p id="notice"><%= notice %></p>

    <% @job = Job.find(param[:venue_id]) %>

    <p>
      <b>Name:</b>
      <%= @job.name %>
    </p>

    <p>
      <b>Company:</b>
      <p><%= @venue.name %></p>
      <p><%= link_to @job.venue.name, venue_path(@venue) %></p>

    <p>
      <b>Job:</b>
      <%= @job.job_id %>
    </p>

    <p>
      <b>Description:</b>
      <%= @job.description %>
    </p>

    <p>
      <b>Requirement:</b>
      <%= @job.requirement %>
    </p>

    <%= link_to 'Edit', edit_venue_job_path(@venue, @job) %> |
    <%= link_to 'Back', venue_jobs_path(@venue, @job) %>

**/jobs/index.html.erb**

<div class="usergrid">

  <% jobs = @venue.jobs %>

  <% @venue.jobs.each do |job| %>
<div class = "user venue">

    <p>
        <h2><%= link_to job.name, venue_job_path(@venue) %></h2>
        <%= link_to 'Edit', edit_venue_job_path(@venue, job) %><br/>
        <%= link_to 'Delete', venue_jobs_path(@venue, @job), :confirm => 'Are you sure?', :method => :delete %>
</div>
<% end %>
<div style="clear:both"></div>
</div>

<%= link_to 'New Job', new_venue_job_path(@venue) %> 
```

我意识到...

1.  这可能是一个非常明显的解决方法，但是对于 Rails 的新手来说，肯定还有一些我不完全理解的基础知识。
2.  如果我发布了太多或太少的代码，请告诉我，我不完全确定最少需要多少。
3.  可能有不止一个错误，可能有很多错误，其中许多可能是由于我在我真的不知道自己在做什么时试图修复这个问题造成的。我想自己解决这个问题，但是当我真的让它变得更糟时，我无法再处理它了。

我尝试过弄乱路线，更改实际的链接和路线，弄乱范围，以及我能找到的针对这些错误的许多常见修复程序，但似乎都没有帮助。

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-08T01:34:17.597

错误是说给定的参数没有路由：

```
{:action=>"show", :controller=>"jobs", :venue_id=> "an_id"} 
```

您可以通过运行 rake 路由来检查这一点，您会看到，由于作业嵌套在场地下，`jobs#show`控制器操作需要两个参数：（`venue_id`这是作业的“父级”）和`id`作业 ID。

我很快检查了你的代码，我认为导致错误的原因之一是这一行：

```
<h2><%= link_to job.name, venue_job_path(@venue) %></h2> 
```

这应该是

```
<h2><%= link_to job.name, venue_job_path(@venue, @job) %></h2> 
```

基本上，每当您尝试在不提供场地的情况下呈现作业链接时，您都会遇到这种错误。

如果您需要更多详细信息或更多信息，请告诉我。

# android - listview之前的Android进度对话框

> ID：14762419
> 
> 赞同：0
> 
> 时间：2013-02-07T22:39:06.693
> 
> 标签：android, multithreading, listview, progressdialog

我正在尝试在显示列表视图之前进行进度对话框，因为列表视图上的项目已下载。

我得到这个是因为我正在尝试使用 displayListView(); 更改线程中的列表视图；

```
02-08 00:25:48.959: W/System.err(3244): android.view.ViewRoot$CalledFromWrongThreadException: Only the original thread that created a view hierarchy can touch its views. 
```

如果我将 displayListView() 放在我的线程之外，我会得到 nullpointerexeption。displayListView() 使用下载的**fieldsList 数组列表**。我试图在 myThread.isAlive 时等待，但这样不会显示进度对话框。如何解决？

我的代码：

```
@Override
public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.build_main);
        final ProgressDialog dialog = new ProgressDialog(this);
        dialog.setCancelable(true);
        dialog.setMessage("Loading...");
        dialog.setProgressStyle(ProgressDialog.STYLE_HORIZONTAL);
        dialog.setProgress(0);
        dialog.setMax(100);
        dialog.show();

        Thread myThread = new Thread(new Runnable() {
            public void run() {

                Builder builder = new Builder(server, user, password, BuildFieldsViewActivity.this, USER_AGENT);
                Document doc = null;
                doc = builder.DownloadPage("d.php?ne="+gyv_id);

                fieldsList = builder.getKaimas(doc);

                displayListView();

                dialog.setProgress(100);
                dialog.dismiss();
            }
        });
        myThread.start();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T22:40:49.113

任何 UI 元素都必须从 UI 线程更新。您正在从后台线程操作对话框。于是，崩溃发生了。

一个快速的解决方法是使用 runOnUiThread(Runnable)，在 runnable 中，您可以安全地更新任何 UI 元素。

# javascript - IE10：如何在拖动时获取鼠标坐标

> ID：14762420
> 
> 赞同：2
> 
> 时间：2013-02-07T22:39:11.923
> 
> 标签：javascript, jquery, internet-explorer, drag-and-drop

在 IE 10 中，当触发 ondragover 事件时，属性 clientX、clientY、pageX、pageY 的值似乎不会在鼠标移动时刷新。Webkit 浏览器和 Firefox 准确更新鼠标坐标。

简单的例子：

```
$(document).ready(function () {  
    $('#log').on('dragover', function(e) {
        $('#log').text(e.originalEvent.pageX + " | " + e.originalEvent.pageY);
    });
}); 
```

[http://jsfiddle.net/kristoffer/kCZmg/](http://jsfiddle.net/kristoffer/kCZmg/)

IE10有解决方法吗？

# c# - WPF 数据表单分页

> ID：14762425
> 
> 赞同：1
> 
> 时间：2013-02-07T22:39:33.217
> 
> 标签：c#, .net, wpf, paging, datapager

我正在尝试创建在表单底部具有一组字段和分页按钮的数据表单。

我希望 Paging 成为一个单独的控件，其中包含 First、Previous、Next、Last 和标签 Item 1 of n。

这种分页控件将用于任何数据输入表单，以允许用户在前一条记录之间来回切换。例如，订单、发票、付款是数据表单。用户选择订单时，会显示新订单。它还具有用于移动到上一条记录的分页按钮。

我创建了一个名为 DataPager 的 UserControl，它具有 PagingItems 的依赖属性。我希望这个依赖属性是通用的，以便我可以传递项目列表（订单、发票、付款）

为此，我做了：在用户控件中列出。我尝试以需要分页的形式绑定它。

```
public List<object> Items
{
    get { return (List<object>)GetValue(ItemsProperty); }
    set { SetValue(ItemsProperty, value); }
}

// Using a DependencyProperty as the backing store for Items.  This enables animation, styling, binding, etc...
public static readonly DependencyProperty ItemsProperty =
        DependencyProperty.Register("Items", typeof(List<object>), typeof(DataPager), new UIPropertyMetadata(null, LoadItems));

private static void LoadItems(DependencyObject obj, DependencyPropertyChangedEventArgs e)
{
    DataPager thisControl = (DataPager)obj;
    thisControl.RefreshItems();
} 
```

我在使用控件和绑定的页面中收到以下错误：

```
System.Windows.Data Error: 1 : Cannot create default converter to perform 'one-way' conversions between types 'System.Collections.Generic.List`1[PagingSample.Order]' and 'System.Collections.Generic.List`1[System.Object]'. Consider using Converter property of Binding. BindingExpression:Path=Orders; DataItem='MainViewModel' (HashCode=26754911); target element is 'DataPager' (Name='dataPager1'); target property is 'Items' (type 'List`1')

System.Windows.Data Error: 5 : Value produced by BindingExpression is not valid for target property.; Value='System.Collections.Generic.List`1[PagingSample.Order]' BindingExpression:Path=Orders; DataItem='MainViewModel' (HashCode=26754911); target element is 'DataPager' (Name='dataPager1'); target property is 'Items' (type 'List`1') 
```

不确定如何使 DataPager 控件项属性保持通用。我还没有想出如何告诉父控件 CurrentItem 显示。

但想清除第一道障碍。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T00:25:56.133

您无法`List<Order>`转换为`List<object>`- 这就是您收到此错误的原因。

如果您的`DataPager`控件只需要控制显示哪个页面，而不是实际修改集合，您可以简单地将您的`Items`属性定义为 type`IEnumerable`而不是`List<object>`，这样问题就解决了。

这是因为对于任何`T`，`List<T>`都是可铸的`IEnumerable`。

# mysql - 大行的 MySQL 简单查询改进

> ID：14762431
> 
> 赞同：0
> 
> 时间：2013-02-07T22:39:57.517
> 
> 标签：mysql, query-optimization

我有一个跨 2000 万条记录表的简单查询，我需要一个索引来改进以下查询的 select 语句：

```
 SELECT count(item_id), count(distinct user_id)
 FROM activity
 INNER JOIN item on item.item_id = activity.item_id
 WHERE item.item_id = 3839 and activity.created_at >= DATE_SUB(NOW(), INTERVAL 30 DAY) 
```

我有一个索引：

```
activity - activity_id (PRIMARY), item_id, created_at - All Single Index
item - item_id (PRIMARY) 
```

对于具有大量内容（如 600k）的项目，运行查询需要 4-5 秒。

有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T23:39:47.970

If there is a `FOREIGN KEY` constraint from `activity` to `item` (and assuming that `user_id` is in table `activity`), then your query is equivalent to:

```
SELECT COUNT(*), COUNT(DISTINCT user_id)
FROM activity
WHERE item_id = 3839 
  AND created_at >= DATE_SUB(NOW(), INTERVAL 30 DAY) ; 
```

which should be more efficient as it has to get data from only one table or just one index. An index on `(item_id, created_at, user_id)` would be useful.

# javascript - Backbone Forms - 通过数组呈现选项

> ID：14762433
> 
> 赞同：0
> 
> 时间：2013-02-07T22:40:06.397
> 
> 标签：javascript, backbone.js

你好，我想为基于数组的 div-array 创建一个编辑界面。例如我在一个循环中创建 15 个 div，

基于此，我想通过 ajax 加载一个编辑界面，我可以在其中选择其中一个 div 并更改它们的类，就像这样，我可以手动执行此操作，

```
 var divs = {
        'selector': ['Select One'],
        'id': ['div-1', 'div-2', 'div-3', 'div-4'],
        'class': ['class-1', 'class-2', 'class-3', 'class-4']
    }; 
```

关键是我不知道它们有多少，直到用户输入一个 int 来呈现它们。id 和 class 应该根据我当前渲染的 div 数量来填充，例如：

当前代码：

```
 (function($) {
    var container = $('.holder');

    //The input getter for amount of divs
    var form1 = new Backbone.Form({
        schema: {
            nDefine: 'Number',
        }
    }).render();
    $('.input').append(form1.el);

// rendering amount of divs
function render(){
    num = parseInt($('input').val());
    for(var i = 1; i <= num; i++) {
         container.append('<div id="id'+i+'" class="box category'+i+'">Id:'+i+'</div>');

     }
}

// renders divs on click
$('.n-definer').click(function() {

    container.empty();
    render();
    //form1.commit();
});

})(jQuery); 
```

这很好用，我现在如何将这些 id 和类以数组形式放入我的主干形式中？

# facebook-graph-api - 通过图形 API 从状态中检索墙壁照片

> ID：14762437
> 
> 赞同：0
> 
> 时间：2013-02-07T22:40:15.710
> 
> 标签：facebook-graph-api, photo

如何通过图形 API检索[这张照片？](https://www.facebook.com/412778502140672/posts/425592530859269)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-25T10:42:04.617

如果您正在使用 Android，那么这种方式可以帮助您

```
 Request r=Request.newMeRequest(session, new Request.GraphUserCallback() {

            @Override
            public void onCompleted(GraphUser user, Response response) {
                // TODO Auto-generated method stub
                JSONObject jso=null;
                try{
    //Parse json here

                }
                catch ( Exception e)
                {
                    //Log.d(sTag,e.getMessage());
                }

            }

        });
        Bundle paramsPics=r.getParameters();
        paramsPics.putString("fields", 
                "photos");

        r.setParameters(paramsPics);
        Response response=r.executeAndWait(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T23:58:06.610

不可能将照片张贴到像您的样本这样的活动的墙上。

去年夏天，我有一位客户发起了一场比赛，让人们将照片发布到活动墙上。他们要求我让他们在他们的网站上展示。我们必须手动下载它们才能获得它们。

您可以使用查看`feed`该事件的

```
/412778502140672/event?fields=feed 
```

但是没有附件，也没有连接。我不相信甚至可以`stream`使用 FQL 来获得事件。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-08T17:06:25.820

在“me/home”API 调用中，具有照片的项目将具有“图片”字段，其中包含低分辨率图片的源 URL。要获得原始高分辨率图片及其尺寸变体，您必须使用与“图片”字段相同的 JSONObject 中的“object_id”字段进行另一个 API 调用。

对“object_id”进行图形调用将为您提供一个“源”字段，其中包含原始源图像 URL，以及不同图像大小的数组。

编辑：

将帖子的图形路径设置为“412778502140672_425592530859269”。

将照片的图形路径设置为“482760011786004”。

# c# - 传递多个多字符分隔符时，String.Split 方法如何确定分隔符优先级？

> ID：14762440
> 
> 赞同：8
> 
> 时间：2013-02-07T22:40:21.710
> 
> 标签：c#, string, tokenize, stringtokenizer

如果您有此代码：

```
"......".Split(new String[]{"...", ".."}, StringSplitOptions.None); 
```

结果数组元素是：

```
 1\. ""
 2\. ""
 3\. "" 
```

现在如果你颠倒分隔符的顺序，

```
"......".Split(new String[]{"..", "..."}, StringSplitOptions.None); 
```

结果数组元素是：

```
 1\. ""
 2\. ""
 3\. ""
 4\. "" 
```

从这两个示例中，我倾向于得出结论，Split 方法在从左到右遍历数组的每个元素时递归地进行标记。

但是，一旦我们将包含字母数字字符的分隔符放入等式中，很明显上述理论是错误的。

```
 "5.x.7".Split(new String[]{".x", "x."}, StringSplitOptions.None) 
```

结果是：`1\. "5" 2\. ".7"`

```
 "5.x.7".Split(new String[]{"x.", ".x"}, StringSplitOptions.None) 
```

结果是：`1\. "5" 2\. ".7"`

这次我们获得了相同的输出，这意味着基于第一组示例理论化的规则不再适用。（即：如果分隔符的优先级始终根据数组中分隔符的位置确定，那么在最后一个示例中，我们将获得`"5."`&`"7"`而不是`"5"`& `".7"`。

至于为什么我浪费时间试图猜测 .NET 标准 API 的工作原理，这是因为我想为我的 java 应用程序实现类似的功能，但是 StringTokenizer 和 org.apache.commons.lang.StringUtils 都没有提供拆分一个使用*多个多字符*分隔符的字符串（即使我要找到确实提供此功能的 API，也很难知道它是否总是使用 String.Split 方法使用的相同算法进行标记。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-07T23:12:09.693

来自[MSDN](http://msdn.microsoft.com/en-us/library/tabh47cf%28v=vs.80%29.aspx)：

> 为避免在分隔符中的字符串具有共同字符时产生模棱两可的结果，Split 操作从实例值的开头到结尾进行，并匹配分隔符中等于实例中分隔符的第一个元素。在实例中遇到子字符串的顺序优先于分隔符中元素的顺序。

因此，对于第一种情况，“..”和“...”位于同一位置，并且它们在分隔符中的顺序用于确定使用的位置。对于第二种情况，“.x”位于“x”之前。并且分隔符中的元素顺序不适用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T23:13:02.820

我已经快速查看了这个.. 并且看起来类中的私有方法`MakeSeparatorList`实际上`string`检索了一个索引数组.. 但它会匹配它找到的第一个。

因此，因为在您的两个示例中都`.x`出现在前面，所以`x.`存储了该索引。

这是我用来测试的代码：

```
var s = "5.x.7";

string[] separators = new string[] { "x.", ".x" };
int[] sepList = new int[1024];
int[] lengthList = new int[1024];

MethodInfo dynMethod = s.GetType().GetMethods(BindingFlags.NonPublic | BindingFlags.Instance).Last(x => x.Name == "MakeSeparatorList");
dynMethod.Invoke(s, new object[] { separators, sepList, lengthList });

Debugger.Break(); 
```

看这个截图：

![](../Images/27b721fa95cd81d8a29ffe46f10c4f63.png)

（我的屏幕截图没有显示？：/）

请注意索引如何为 1（导致`.x`），即使它`.x`是数组中的第二个条目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T23:29:11.893

string .split 会拆分与参数匹配的第一个匹配字符。在简单的问题中：假设您提供了选项 split("a", "b") 并且字符串包含“appaleisbigapll”，该算法很简单，从第一个字符开始并与 a 或 b 匹配。如果它找到这些，它会分裂并从下一个字符开始。在你的例子中

5.x.7 带有“.x”、“x.”。它使用“或”运算符进行规则，因此它首先找到 .x 并检查剩余的 .7，因为没有剩余的匹配字符，所以它保留 .7 原样。结果 5 和 .7

在第二个问题中也发生了同样的情况，它找到了 .x，正如规则所说的 .x 或 x。它以 .7 继续，此处不应用优先级。对于您的第一组示例，是的，它递归地执行拆分操作。

# c++ - 如何计算函数模板实例化

> ID：14762441
> 
> 赞同：0
> 
> 时间：2013-02-07T22:40:23.107
> 
> 标签：c++, templates

假设我有一个函数模板`func`，它使用相同的模板参数被实例化了几次。应该对具有相同模板参数的单个实例进行计数（从 0 开始），并且应该可以从`func`的实现中访问实例计数。显然，静态成员不是我要寻找的。相反，在我看来，实例计数需要通过编译时类型计算来实现。

示例（用户代码）：

```
{
  for(int i=0;i<10;i++) {
    func<float>();           // This should be instance number 0
  }
  func<float>();             // This should be instance number 1
} 
```

尽管运行时循环，第一个实例`func`的编号为 0。也就是说，在所有循环迭代中，实例编号不应更改。只有当循环退出并再次调用该函数时，该数字才应该递增，即递增到 1。

原始模板：

```
template<class T> void func() {} 
```

访问实例计数的可能方法：

```
template<class T,int COUNT> void func() {}   // instance number as template parameter
template<class T> void func(int count) {}    // or as function argument 
```

这可以用一些花哨的调用包装器来完成吗？如果是这样，怎么做？

我担心这是不可能的......但是，现在我有一个很好的用途......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T22:55:38.820

实例化的函数模板是一个函数。每个函数在你的程序中只存在一次。因此，您不能计算实例化，因为只有一个`func<float>`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T23:34:28.727

您在评论中解释的是您要缓存函数结果。这称为[记忆](http://en.wikipedia.org/wiki/Memoization)。您也许应该创建一个完整的类来处理函数对每个模板参数的记忆。

如果您希望函数每次都减少到相同的值，也许首先检查编译器是否自行执行（`g++ -S -g`不应该太难读......）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T23:04:21.300

```
template<class T> class impl {
    template<int count>
    static void funcImpl() {}
}

#define func funcImpl<__COUNTER__>

...

impl<float>::func() 
```

# ruby-on-rails - 如何在控制器中测试 RSpec 关联已设置？

> ID：14762442
> 
> 赞同：0
> 
> 时间：2013-02-07T22:40:24.440
> 
> 标签：ruby-on-rails, rspec

我有以下内容：

```
let(:coupon) { mock_model Coupon, code: 'special' }
let(:cart) { mock_model Cart }

it "assigns a coupon to the cart" do
  post :redeem_coupon, coupon: {coupon: coupon.code}
  assigns(:cart).coupon.should eql(coupon)
end 
```

我有以下错误：

```
 Failure/Error: assigns(:cart).coupon.should eql(coupon)
 NoMethodError:
   undefined method `coupon' for nil:NilClass 
```

我只想确保以下工作：

```
@cart = current_cart

if request.post?
  coupon = Coupon.find_active_by_code(params[:coupon][:coupon], @cart.subtotal, current_member)
  if coupon
    @cart.coupon = coupon
    @cart.save!
  end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T22:51:53.033

我猜`current_cart`是返回零。您可以使用已创建的模拟购物车将其存根：

```
before { subject.stub(:current_cart) { cart } } 
```

# node.js - 在 Mocha 测试中使用 Superagent/Supertest 和 Express 应用程序

> ID：14762443
> 
> 赞同：8
> 
> 时间：2013-02-07T22:40:33.183
> 
> 标签：node.js, express, mongoose, mocha.js, superagent

我正在尝试使用 Mocha 为我正在开发的 REST API 编写测试。我发现了允许我发出 HTTP 请求的 Superagent。我正在使用一个 Express 应用程序，我将它传递给 Superagent，但是在尝试使用以这种方式传递的 Express 应用程序运行这些测试时，我收到了关于 Mongoose 的奇怪错误。这是我的测试代码：

```
var
    // Node modules
    mongoose = require('mongoose')
  , async = require('async')
  , should = require('should')
  , request = require('superagent')

  , app = require('../../app_mocked')
  , Link = mongoose.model('Link')

request = request(app)

describe('Links resource', function () {

  var userId = '50dc81654dca01006b000005'
    , linkId
    , sampleLink = {
        'uri': 'http://test.com/',
        'meta': {
          'title': 'Test',
          'desc': 'Test link desc'
        },
        'shares': [{
          'uid': userId,
          'date': new Date(),
          'message': 'Test link message'
        }]
      }

  it('POST /api/users/:id/links', function (done) {
    request(app).post('/api/users/' + userId + '/links')
      .send(sampleLink)
      .end(function (err, res) {
        res.should.have.status(200)
        res.body.should.have.property('id')

        linkId = res.body.id

        done()
      })
  })

  it('GET /api/users/:id/links', function (done) {
    request(app).get('/api/users/50dc81654dca01006b000005/links')
      .end(function (err, res) {
        res.should.have.status(200)
        res.body.should.have.lengthOf(1)

        done()
      })
  })

}) 
```

我得到的错误是这样的：

```
1) Links resource POST /api/users/:id/links:
   TypeError: Cannot call method 'update' of null
    at MongoStore.MONGOSTORE.set (/Users/Oliver/Development/Personal/Reader/node_modules/connect-mongodb/lib/connect-mongodb.js:146:15)
    at Session.save (/Users/Oliver/Development/Personal/Reader/node_modules/express/node_modules/connect/lib/middleware/session/session.js:63:25)
    at ServerResponse.res.end (/Users/Oliver/Development/Personal/Reader/node_modules/express/node_modules/connect/lib/middleware/session.js:280:19)
    at ServerResponse.res.send (/Users/Oliver/Development/Personal/Reader/node_modules/express/lib/response.js:149:8)
    at ServerResponse.res.json (/Users/Oliver/Development/Personal/Reader/node_modules/express/lib/response.js:191:15)
    at ServerResponse.res.send (/Users/Oliver/Development/Personal/Reader/node_modules/express/lib/response.js:117:21)
    at Promise.exports.create (/Users/Oliver/Development/Personal/Reader/server/resources/links.js:29:9) 
```

但是，此错误仅有时会出现。1/5 次，测试将毫无问题地通过。这让我觉得测试有时会在`app`完全加载之前运行。

或者，如果我在单独的会话中运行应用程序并将 URL 传递给`request`，如下所示，那么它每次都有效：

`request = request('http://localhost:3000')`

这是原因吗？`app`如果是这样，我怎样才能在完全加载后才运行测试？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-07T22:52:06.030

事实证明，在运行测试之前，我必须指定一个`before`测试来等待 MongoDB 连接打开。

```
before(function (done) {
  mongoose.connection.on('open', done)
}) 
```

# performance - 用于理解 JVM 语言的字节码分析工具

> ID：14762445
> 
> 赞同：1
> 
> 时间：2013-02-07T22:40:37.807
> 
> 标签：performance, clojure, jvm, profiling, instrumentation

我正在（和一些朋友）试验 JVM 语言，例如 Clojure 和 Scala。我们最近发现了一种算法的函数式解决方案，该算法在 Scala 中的执行速度比在 Java 中快 30 倍。使用这些函数式语言，是否有人使用字节码分析工具来查看这些函数在 JVM 字节码中变成了什么？用于此目的的最佳工具是什么？

就此而言，当我刚刚开始研究字节码检测和分析产品时，哪种工具最适合使用？我看到有关 Stackoverflow 的建议，但我不确定它们是否专门针对希望查看两段代码之间存在哪些机器实现差异的愿望，或者它们是否纯粹是为了代码覆盖目的，这不是我的兴趣。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T23:11:11.130

从工具的角度来看，JVM 语言与普通 Java 字节码相比，不会对分析造成任何不同的问题。您需要了解事物在您花哨的功能构造背后的工作原理，以便正确读取分析器的结果。

[YourKit](http://www.yourkit.com/)或[visualVM](http://visualvm.java.net/)将再次成为您的朋友。

# java - Spring MVC - 处理 HttpMediaTypeNotAcceptableException 时如何设置返回媒体类型？

> ID：14762447
> 
> 赞同：1
> 
> 时间：2013-02-07T22:40:43.823
> 
> 标签：java, spring, spring-mvc

我有一个 Spring 3.2 MVC REST 服务，它通过扩展`ResponseEntityExceptionHandler`. 这会处理[标准的 Spring 异常](http://static.springsource.org/spring/docs/3.2.x/spring-framework-reference/html/mvc.html#mvc-ann-rest-spring-mvc-exceptions)，并将响应客户端请求的 XML 或 JSON 中的适当 HTTP 状态和自定义“错误”ResponseEntity 对象。这适用于除`HttpMediaTypeNotAcceptableException`.

我遇到的这个异常的问题是它首先抛出的原因是因为无法从请求中确定响应媒体类型（应用程序/xml、应用程序/json 等）。如果我尝试为此异常返回“错误”ResponseEntity 对象，它将失败，因为无法确定响应媒体类型（这就是首先处理此异常的原因）......并且基本上`HttpMediaTypeNotAcceptableException`从我的异常处理程序。

`HttpMediaTypeNotAcceptableException`在处理指定有效的响应媒体类型时，我需要找出一种方法，因此 ResponseEntity 将其发送给客户端。由于无法确定请求的媒体类型，这可能只是我的服务（应用程序/xml）的默认值

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T22:48:00.690

**编辑：**这个答案非常没用，请参阅下面的评论。对不起。

在这种情况下，无论如何通信都非常混乱，也许将状态代码设置为`400 - Bad Request`并希望客户端并不真正期望服务器不知道格式的机器可读答案就足够了。如果发送了响应正文，则可能使用`Content-Type: text/plain`- 这对客户端没有用，但可能是调试情况的人；）好吧，或者任何适合您心情的东西。

*更新：*更好的解决方案可能是使用手册中解释的方法；在：[http](http://static.springsource.org/spring/docs/3.2.x/spring-framework-reference/html/mvc.html#mvc-ann-customer-servlet-container-error-page) ://static.springsource.org/spring/docs/3.2.x/spring-framework-reference/html/mvc.html#mvc-ann-customer-servlet-container-error-page但是我不得不承认如果可行，我并没有真正尝试过。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-02-05T09:12:11.770

我在我的开发中发现了同样的问题，所以要解决这个问题，你需要在你的所有方法中注释的错误消息的响应体`@ExceptionHandler`中`controllerAdvicer`指定`contentType`：

例如：您的接收标头`Accept: application/pdf`但您的应用程序生成`application/json`.

`GlobalExceptionHandler` 带有注释的类`@ControllerAdvice`以管理特定的正文响应：

```
 package com.obs.sfu.exception;

import javax.validation.ConstraintViolationException;

import org.springframework.http.HttpHeaders;
import org.springframework.http.HttpStatus;
import org.springframework.http.MediaType;
import org.springframework.http.ResponseEntity;
import org.springframework.web.HttpMediaTypeNotAcceptableException;
import org.springframework.web.HttpMediaTypeNotSupportedException;
import org.springframework.web.HttpRequestMethodNotSupportedException;
import org.springframework.web.bind.annotation.ControllerAdvice;
import org.springframework.web.bind.annotation.ExceptionHandler;
import org.springframework.web.context.request.WebRequest;
import org.springframework.web.servlet.NoHandlerFoundException;
import org.springframework.web.servlet.mvc.method.annotation.ResponseEntityExceptionHandler;
import org.springframework.ws.soap.client.SoapFaultClientException;

@ControllerAdvice
public class GlobalExceptionHandler extends ResponseEntityExceptionHandler {

    private static final String SIZE_MUST_BE_FROM_1_TO_15_CHARACTERS = "Size must be from 1 to 15 characters";
    private static final int CODE_INTERNAL_SERVER_ERROR = 1;
    private static final String MESSAGE_INTERNAL_SERVER_ERROR = "Internal error";
    private static final String DESCRIPTION_INTERNAL_SERVER_ERROR = "Generic failure message";

    private static final int CODE_SERVICE_UNAVAILABLE = 5;
    private static final String MESSAGE_SERVICE_UNAVAILABLE = "The service is temporarily unavailable";
    private static final String DESCRIPTION_SERVICE_UNAVAILABLE = "The service can not handle the call.";

    private static final int CODE_UNSUPPORTED_MEDIA_TYPE = 68;
    private static final String MESSAGE_UNSUPPORTED_MEDIA_TYPE = "Unsupported Media Type";
    private static final String DESCRIPTION_UNSUPPORTED_MEDIA_TYPE = "The format of the posted body is not supported by the endpoint.";

    private static final int CODE_NOT_FOUND = 60;
    private static final String MESSAGE_NOT_FOUND = "Resource not found";
    private static final String DESCRIPTION_NOT_FOUND = "The Requested URI or the requested resource does not exist.";

    private static final int CODE_METHOD_NOT_ALLOWED = 61;
    private static final String MESSAGE_METHOD_NOT_ALLOWED = "Method not allowed";
    private static final String DESCRIPTION_METHOD_NOT_ALLOWED = "The URI does not support the requested method. The available methods should be set in the response header 'Allow'";

    private static final int CODE_NOT_ACCEPTABLE = 62;
    private static final String MESSAGE_NOT_ACCEPTABLE = "Not acceptable";
    private static final String DESCRIPTION_NOT_ACCEPTABLE = "The Accept incoming header does not match any available content-type.";

    private static final int CODE_CONSTRAINT_VIOLATION_FIELD = 20;
    private static final String MESSAGE_INVALID_BODY_FIELD = "Invalid Via field";

    private static final String HEADER_ALLOW = "Allow";
    private static final String HEADER_ALLOW_VALUE = "GET, OPTIONS";

    @Override
    protected ResponseEntity<Object> handleNoHandlerFoundException(NoHandlerFoundException ex, HttpHeaders headers,
            HttpStatus status, WebRequest request) {
        ErrorDetails errorDetails = new ErrorDetails(request.getContextPath(), MESSAGE_NOT_FOUND, DESCRIPTION_NOT_FOUND,
                CODE_NOT_FOUND);
        return ResponseEntity.status(status).contentType(MediaType.APPLICATION_JSON).body(errorDetails);
    }

    @Override
    protected ResponseEntity<Object> handleHttpRequestMethodNotSupported(HttpRequestMethodNotSupportedException ex,
            HttpHeaders headers, HttpStatus status, WebRequest request) {
        ErrorDetails errorDetails = new ErrorDetails(request.getContextPath(), MESSAGE_METHOD_NOT_ALLOWED,
                DESCRIPTION_METHOD_NOT_ALLOWED, CODE_METHOD_NOT_ALLOWED);
        HttpHeaders responseHeaders = new HttpHeaders();
        responseHeaders.set(HEADER_ALLOW, HEADER_ALLOW_VALUE);
        return ResponseEntity.status(status).headers(responseHeaders).contentType(MediaType.APPLICATION_JSON)
                .body(errorDetails);
    }

    @Override
    protected ResponseEntity<Object> handleHttpMediaTypeNotSupported(HttpMediaTypeNotSupportedException ex,
            HttpHeaders headers, HttpStatus status, WebRequest request) {
        ErrorDetails errorDetails = new ErrorDetails(request.getContextPath(), MESSAGE_UNSUPPORTED_MEDIA_TYPE,
                DESCRIPTION_UNSUPPORTED_MEDIA_TYPE, CODE_UNSUPPORTED_MEDIA_TYPE);
        HttpHeaders responseHeaders = new HttpHeaders();
        responseHeaders.set("Accept", MediaType.APPLICATION_JSON_VALUE);
        return ResponseEntity.status(status).headers(responseHeaders).contentType(MediaType.APPLICATION_JSON)
                .body(errorDetails);
    }

    @Override
    protected ResponseEntity<Object> handleHttpMediaTypeNotAcceptable(HttpMediaTypeNotAcceptableException ex,
            HttpHeaders headers, HttpStatus status, WebRequest request) {
        ErrorDetails errorDetails = new ErrorDetails(request.getContextPath(), MESSAGE_NOT_ACCEPTABLE,
                DESCRIPTION_NOT_ACCEPTABLE, CODE_NOT_ACCEPTABLE);
        return ResponseEntity.status(status).contentType(MediaType.APPLICATION_JSON).body(errorDetails);
    }

    @ExceptionHandler(ConstraintViolationException.class)
    public ResponseEntity<Object> handleConstraintViolation(ConstraintViolationException ex, WebRequest request) {
        ErrorDetails errorDetails = new ErrorDetails(request.getContextPath(), MESSAGE_INVALID_BODY_FIELD,
                SIZE_MUST_BE_FROM_1_TO_15_CHARACTERS, CODE_CONSTRAINT_VIOLATION_FIELD);
        return ResponseEntity.status(HttpStatus.BAD_REQUEST).contentType(MediaType.APPLICATION_JSON).body(errorDetails);
    }

    @ExceptionHandler(SoapFaultClientException.class)
    public ResponseEntity<Object> handleSoapFaultClient(Exception ex, WebRequest request) {
        ErrorDetails errorDetails = new ErrorDetails(request.getContextPath(), MESSAGE_SERVICE_UNAVAILABLE,
                DESCRIPTION_SERVICE_UNAVAILABLE, CODE_SERVICE_UNAVAILABLE);
        return ResponseEntity.status(HttpStatus.SERVICE_UNAVAILABLE).contentType(MediaType.APPLICATION_JSON)
                .body(errorDetails);
    }

    @ExceptionHandler(Exception.class)
    public ResponseEntity<Object> handleGlobalException(Exception ex, WebRequest request) {
        ErrorDetails errorDetails = new ErrorDetails(request.getContextPath(), MESSAGE_INTERNAL_SERVER_ERROR,
                DESCRIPTION_INTERNAL_SERVER_ERROR, CODE_INTERNAL_SERVER_ERROR);
        return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).contentType(MediaType.APPLICATION_JSON)
                .body(errorDetails);
    }
} 
```

文件`application.properties`需要这些属性来管理`NoHandlerFoundException`（`throwExceptionIfNoHandlerFound`）：

```
spring:
  mvc: 
    throw-exception-if-no-handler-found: true
    static-path-pattern: /swagger* # to available swagger-ui.html 
```

# java - Tomcat java应用程序后台处理

> ID：14762451
> 
> 赞同：1
> 
> 时间：2013-02-07T22:40:49.977
> 
> 标签：java, jsp, tomcat, servlets, cronexpression

我有一个需要执行各种后台管理任务的 Tomcat 应用程序。

例如，用户更新了一些东西，并在事件队列表中创建了一个条目。然后后台任务读取队列并发送电子邮件。无论如何我都需要该表，因为我会将其用作 UI 中的事件日志。

过去我只是使用 cron 从命令行安排它们。但我想这次我应该花几分钟时间寻找更好的方法......

理想情况下，我会在应用程序后台有一些任务空闲。它将监视应用程序范围变量以触发某些活动。

我不认为它足够复杂来实现另一个框架。只是在寻找某种标志和触发器。

有什么建议么？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T00:06:28.510

[Quartz Scheduler](http://quartz-scheduler.org)易于使用，使您能够从应用程序中实现这一目标。

# javascript - 试图在悬停时将一种类型淡入另一种类型 - CSS3或Jquery？

> ID：14762452
> 
> 赞同：0
> 
> 时间：2013-02-07T22:41:02.330
> 
> 标签：javascript, jquery, css

我的困境是我知道如何使用 jquery animate 方法在悬停时将一个图像淡入另一个图像：

```
$(document).ready(function(){
    $("img.a").hover(function() {
        $(this).stop().animate({"opacity": "0"}, "slow");
    },function() {
        $(this).stop().animate({"opacity": "1"}, "slow");
    });
}); 
```

而且我还知道如何使用 CSS3 过渡来更改文本上的悬停颜色：

```
a.squirrel{
color:black;  
padding:5px; 
-webkit-border-radius: 5px; 

-webkit-transition-property:color, background; 
-webkit-transition-duration: 1s, 1s; 
-webkit-transition-timing-function: linear, ease-in;
} 
a.squirrel:hover{color:red;} 
```

我不知道怎么做，但想做的是用一种像格鲁吉亚这样的字体链接（为了演示目的，尽量保持简单），当你将鼠标悬停在它上面时，将它淡化成一种完全不同的字体类型如 Tahoma。

我已经使用了这两种方法，但似乎都没有给我想要的效果。

我知道我可以使用我想要使用的类型的图像，但我试图不使用图像，所以我正在寻找 vanilla Javascript 或其他一些 jQuery 方法。

这个可以吗？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T23:28:38.093

如果您正在谈论实际在字体样式之间创建平滑转换，这确实是不可能的。但是，如果您只想在悬停时创建淡入淡出效果以在两种字体样式之间进行转换，那么应该可以使用以下方法：

[http://jsfiddle.net/7NATE/8/](http://jsfiddle.net/7NATE/8/)

HTML

```
<div id="container">
    <span class="font1">Hello World!</span>
    <span class="font2">Hello World!</span>
</div> 
```

CSS

```
.font1{
    font-family: Tahoma;
}

.font2{
    font-family: Georgia;
    display: none;
} 
```

JS

```
var $f1 = $(".font1"), $f2 = $(".font2"), $c = $('#container');

$c.hover(function(){    
    if(!$f1.is(':animated') && !$f2.is(':animated')){
        $f1.fadeOut(function(){
             $f2.fadeIn();
        });
    }
},
function(){
    if(!$f1.is(':animated') && !$f2.is(':animated')){
        $f2.fadeOut(function(){
            $f1.fadeIn();
        });
    };
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T22:53:09.180

使用 .fadeOut，将新图像加载到元素，然后使用 .fadeIn 怎么样？淡入/淡出功能比使用不透明度要方便得多。您甚至可以更改过渡的速度和“斜率”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T23:58:31.893

无论哪种方式，css 或 js，我都不能以慢动作更改字体系列。

对于颜色、背景、宽度、高度等，我们可以计算每一帧动画时的状态。

但是对于 font-family，我认为不可能在动画期间计算帧状态，除非 font-family 是图像，但它不是。

# firefox - 无法修改 Firefox 扩展中的 POST 数据

> ID：14762454
> 
> 赞同：0
> 
> 时间：2013-02-07T22:41:08.793
> 
> 标签：firefox, firefox-addon, xpcom, xulrunner

我正在尝试实现一个修改 POST 请求数据的 Firefox 扩展。

代码如下，它在标记为“*这里失败！！！* ”的地方失败

任何见解都会有所帮助。

```
 Components.utils.import("resource://gre/modules/XPCOMUtils.jsm");

    var newData = "test 123";
    function LOG(msg) {
        var consoleService = Components.classes["@mozilla.org/consoleservice;1"]
                                     .getService(Components.interfaces.nsIConsoleService);
        consoleService.logStringMessage(msg);
    }

    function CMP() {
        this.registered = false;
        this.register();
    }

    CMP.prototype = {

        register: function() {
            if (this.registered == false) {
                var observerService = Components.classes["@mozilla.org/observer-service;1"]
                    .getService(Components.interfaces.nsIObserverService);
                observerService.addObserver(this, "http-on-modify-request", false);
                this.registered = true;
            }
        },

        observe: function(subject, topic, data) 
        {
            LOG("Inside observe");
            if (topic == "http-on-modify-request") 
            {
                LOG("TOPIC is http-on-modify-request");
                var httpChannel = subject.QueryInterface(Components.interfaces.nsIHttpChannel);

                if(httpChannel.requestMethod == "POST"){
                    LOG("Inside POST")
                    var uploadChannel = httpChannel.QueryInterface(Components.interfaces.nsIUploadChannel);
                    //var uploadChannelStream = uploadChannel.uploadStream; 
```

在这里修改数据。在这里进行测试，我将“测试 123”作为新数据通过

```
 var newStringInputStream = Components.classes['@mozilla.org/io/string-input-stream;1'].createInstance(Components.interfaces.nsIStringInputStream);
                    newStringInputStream.setData(newData,newData.length);
                    LOG("set data in newStringInputStream!!");

                    uploadChannel.setUploadStream(newStringInputStream, "text/plain", -1 );// Fails here!!!
                    httpChannel.requestMethod = "POST";
                    LOG("upload DONE!!")  
                }   
            }
        },

        QueryInterface : function(aIID) {
        if (aIID.equals(Components.interfaces.nsISupports) ||
            aIID.equals(Components.interfaces.nsIObserver))
          return this;
        throw Components.results.NS_NOINTERFACE;
        },

        unregister: function() {
            var observerService = Components.classes["@mozilla.org/observer-service;1"]
                .getService(Components.interfaces.nsIObserverService);
            observerService.removeObserver(this, "http-on-modify-request");
        },

        classID: Components.ID('{F799F47E-ABA5-4AF1-B8F2-BD74E3E5BCC0}'),
        QueryInterface: XPCOMUtils.generateQI([Components.interfaces.nsIObserver])
    };

    if (XPCOMUtils.generateNSGetFactory)
    {
      var NSGetFactory = XPCOMUtils.generateNSGetFactory([CMP]);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T00:42:08.407

通过按照上面的代码进行更改来修复它。主要变化是在 httpChannel.uploadStream 中设置修改后的数据。

希望这对某人有帮助！

```
var httpChannel = subject.QueryInterface(Components.interfaces.nsIHttpChannel);
            if(httpChannel.requestMethod == "POST")
            {
                LOG("Inside POST")
                var uploadChannel = httpChannel.QueryInterface(Components.interfaces.nsIUploadChannel); 
                var newStringInputStream = Components.classes['@mozilla.org/io/string-input-stream;1'].createInstance(Components.interfaces.nsIStringInputStream);
                newStringInputStream.setData(newData,newData.length);
                var uploadChannelStream = uploadChannel.uploadStream;
                uploadChannelStream = uploadChannelStream.QueryInterface(Components.interfaces.nsISeekableStream).seek(Components.interfaces.nsISeekableStream.NS_SEEK_SET, 0);
                httpChannel.uploadStream.QueryInterface(Components.interfaces.nsIMIMEInputStream);
                httpChannel.uploadStream.setData(newStringInputStream);
                LOG("Done POST")
            } 
```

# c++ - 获取剪贴板数据（CF_TEXT）

> ID：14762456
> 
> 赞同：10
> 
> 时间：2013-02-07T22:41:17.243
> 
> 标签：c++, winapi, clipboard

如何在**`GetClipboardData(CF_TEXT);`** 不调用和使用 C++ 中的进程 ID 的情况下使用？属于
哪个库？**`GetClipboardData(CF_TEXT)`**

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2013-02-07T23:23:20.727

[`GetClipboardData()`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms649039%28v=vs.85%29.aspx)是一个 Win32 API 函数。

返回的句柄`GetClipboardData()`必须先用 锁定`GlobalLock()`，然后才能`char*`在剪贴板中检索ANSI文本的指针（注意，如果要检索Unicode文本，则应使用[`CF_UNICODETEXT`格式](http://msdn.microsoft.com/en-us/library/windows/desktop/ff729168%28v=vs.85%29.aspx#CF_UNICODETEXT)）。

下面是从剪贴板检索文本并将其存储在方便的`std::string`类实例中的示例代码（为简单起见，省略了错误管理）：

```
std::string GetClipboardText()
{
  // Try opening the clipboard
  if (! OpenClipboard(nullptr))
    ... // error

  // Get handle of clipboard object for ANSI text
  HANDLE hData = GetClipboardData(CF_TEXT);
  if (hData == nullptr)
    ... // error

  // Lock the handle to get the actual text pointer
  char * pszText = static_cast<char*>( GlobalLock(hData) );
  if (pszText == nullptr)
    ... // error

  // Save text in a string class instance
  std::string text( pszText );

  // Release the lock
  GlobalUnlock( hData );

  // Release the clipboard
  CloseClipboard();

  return text;
} 
```

您可以使用 C++ RAII 模式并使用异常管理错误条件，如下所示：

```
#include <exception>
#include <iostream>
#include <ostream>
#include <stdexcept>
#include <string>
#include <windows.h>
using namespace std;

class RaiiClipboard
{
public:
  RaiiClipboard()
  {
    if (! OpenClipboard(nullptr))
      throw runtime_error("Can't open clipboard.");
      // ... or define some custom exception class for clipboard errors.
  }

  ~RaiiClipboard()
  {
    CloseClipboard();
  }

  // Ban copy   
private:
  RaiiClipboard(const RaiiClipboard&);
  RaiiClipboard& operator=(const RaiiClipboard&);
};

class RaiiTextGlobalLock
{
public:
  explicit RaiiTextGlobalLock(HANDLE hData)
    : m_hData(hData)
  {
    m_psz = static_cast<const char*>(GlobalLock(m_hData));
    if (! m_psz)
      throw runtime_error("Can't acquire lock on clipboard text.");  
  }

  ~RaiiTextGlobalLock()
  {
    GlobalUnlock(m_hData);
  }

  const char* Get() const
  { 
    return m_psz;
  }

private:
  HANDLE m_hData;
  const char* m_psz;

  // Ban copy
  RaiiTextGlobalLock(const RaiiTextGlobalLock&);
  RaiiTextGlobalLock& operator=(const RaiiTextGlobalLock&);
};

string GetClipboardText()
{
  RaiiClipboard clipboard;

  HANDLE hData = GetClipboardData(CF_TEXT);
  if (hData == nullptr)
    throw runtime_error("Can't get clipboard text.");

  RaiiTextGlobalLock textGlobalLock(hData);
  string text( textGlobalLock.Get() );

  return text;
}

int main()
{
  static const int kExitOk = 0;
  static const int kExitError = 1;
  try
  {
    cout << GetClipboardText() << endl;
    return kExitOk;
  }
  catch(const exception& e)
  {
    cerr << "*** ERROR: " << e.what() << endl;
    return kExitError;
  }
} 
```

# django - 比 django 中的会话具有更精细粒度的持久数据

> ID：14762459
> 
> 赞同：0
> 
> 时间：2013-02-07T22:41:37.730
> 
> 标签：django, session

假设使用网站的工作人员可以为客户换票。在会话中存储有关多视图交换的数据很方便。但可能同时进行不止一种交换。

跟踪会话中单独数据的一种方法是创建子会话密钥并使用它来访问会话数据。该键需要作为隐藏输入作为视图的一部分，或者需要在 URL 中。这一切都变得非常混乱，隐藏变量方法也不是很好，因为在交换期间可能会发生重定向。

有没有一种干净的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T22:47:39.800

使用数据库表来跟踪特定交换的信息，并在打开/提交向导页面时从中读取/写入。会话本质上更加不稳定。

# css - Multiple spinners without the use of multiple functions

> ID：14762464
> 
> 赞同：1
> 
> 时间：2013-02-07T22:42:02.847
> 
> 标签：css, ajax, jquery

I am using a loading icon for my Ajax functions as follows :

```
div id='loader' style="display: none;" align="right">
     <img src="assets/img/ajax-loader.gif"/>
</div>

complete: function(){
    $('#loader').hide();
},
beforeSend: function(data) { 

    $('#loader').show();
 }, 
```

However If I want to have multiple spinners on the same page I will normally needs to have many divs e.g

```
div id='loader2' style="display: none;" align="right">
    <img src="assets/img/ajax-loader.gif"/>
</div>
div id='loader3' style="display: none;" align="right">
    <img src="assets/img/ajax-loader.gif"/>
</div> 
```

etc ..

Is there a way to do this somewhat dynamically so I don't have to define every each of them ?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T22:45:55.697

Rather than targeting by ID, you can just look for .loader within some unique HTML scope. For example:

```
complete: function(){
  $(this).parents('.some-class').find('.loader').hide();
},

beforeSend: function(data) {
  $(this).parents('.some-class').find('.loader').show();
}, 
```

# javascript - 数字：有什么方法可以确定语言环境？

> ID：14762467
> 
> 赞同：1
> 
> 时间：2013-02-07T22:42:05.587
> 
> 标签：javascript, html, locale, number-formatting

我有一个脚本可以扫描网页以将格式应用于数字。例如，如果它发现一个大于 50000 的数字，它会应用红色背景。

该脚本在使用点作为小数分隔符的语言中运行良好（例如，英语**12,345.67**将被解释为 12345.67），但在使用逗号作为小数分隔符的语言中失败（法语**1,234**将被解释为 1234 而不是 1.234）。

我的问题：有没有办法检测网页区域设置，并相应地解释数字？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T23:41:35.130

You can use JavaScript to determine if the locale uses commas or dots as the decimal separator as such:

```
function getDecimalSeparator() {
  return (0.1).toLocaleString().substring(1, 2)
}

getDecimalSeparator(); // "." on a US locale machine.
getDecimalSeparator(); // "," on a FR locale machine. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T02:14:38.323

网页中数值的格式不是基于客户端系统的设置，而是由页面的作者决定，可能基于预期或预期受众的语言。

浏览器不会根据系统设置重新格式化页面中文本中的数字。运气好的话，可能会有一个`lang`属性指示内容的语言，但我认为这不会是可靠的，甚至不会被广泛实施。

可以收集页面中的所有数字并根据以下内容猜测分隔符：

1.  如果任何数字匹配`/^[+-]?0?\.\d/`，则小数分隔符为句点，千位分隔符为逗号
2.  如果任何数字匹配`/^[+-]?0?,\d/`，则小数分隔符为逗号，千位分隔符为句点
3.  如果任何数字匹配`/\.\d\d\d\./`，则千位分隔符是句点，小数分隔符是逗号
4.  如果任何数字匹配`/,\d\d\d,/`，则千位分隔符为逗号，小数分隔符为句点

等等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T22:45:15.013

您可以尝试获取 html`lang`属性，但仍有许多网页缺少该属性

# c# - 如何构建区域数组？

> ID：14762470
> 
> 赞同：-8
> 
> 时间：2013-02-07T22:42:10.160
> 
> 标签：c#, arrays, multidimensional-array

该数组应包含 3 个区域。每个区域应包括两个数字：

例如，区域 1 将包含 3,4 区域 2 5,5 区域 3 23,100

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T22:50:29.077

```
// Three-dimensional array. 
int[, ,] array3D = new int[,,] { { { 1, 2, 3 }, { 4, 5, 6 } }, 
                             { { 7, 8, 9 }, { 10, 11, 12 } } }; 
```

取自[此处](http://msdn.microsoft.com/en-us/library/2yd9wwz4.aspx)，我使用[Google](http://www.google.com/)并使用此字符串搜索“C# 中的多维数组”找到了它。

# java - 如何配置 dao 文件来处理插入列表 在 MyBatis 中

> ID：14762471
> 
> 赞同：0
> 
> 时间：2013-02-07T22:42:32.343
> 
> 标签：java, datamapper, mybatis, ibatis, typehandler

我有一个对象，它有一个像这样的 List 变量：

**导出队列.java**

```
public class ExportQueue implements Serializable {
    private List<String> errors;

    public List<String> getErrors() {
        return errors;
    }

    public void setErrors(List<String> errors) {
        this.errors = errors;
    }
    public void addError(String error) {
        if(this.errors == null) this.errors = new ArrayList<String>();
        this.errors.add(error);
    }
} 
```

我已经为此定义了 ResultMap ...

**ExportQueueDao.xml**

```
<mapper namespace="...">
    <resultMap id="exportQueueResultMap" type="...ExportQueue">
         <result property="errors" column="errors"
            typeHandler="...CommaSeparatedStringListTypeHandler" />
    </resultMap>
</mapper> 
```

**ExportQueueDao.java**

```
@Insert(INSERT_UPDATE)
@Options(useGeneratedKeys = true, keyProperty = "id")
int insertOrUpdate(ExportQueue ExportQueue); 
```

我定义了**CommaSeparatedStringListTypeHandler**，但是当我尝试插入对象时出现错误。据我了解，INSERT 不使用 ResultMap，因此看不到 TypeHander，因此它不知道如何处理 List 错误。

这是我在当前设置中遇到的错误...

```
Caused by: org.apache.ibatis.executor.ExecutorException: There was no TypeHandler found for parameter errors of statement ....dao.ExportQueueDao.insertOrUpdate 
```

我如何配置它以便 MyBatis 知道如何处理`List<String> errors`?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-12T09:05:45.860

您可以在 myBatis-config 中定义使用 CommaSeparatedStringListTypeHandler 作为类型 List 的默认句柄

一旦你定义了 this ，你就不必在结果映射中特别提到“错误”的 typeHandler ，同时插入 MyBatis 将默认使用 CommaSeparatedStringListTypeHandler 来处理你的错误。

```
<typeHandlers> 
        <typeHandler javaType='List' handler='CommaSeparatedStringListTypeHandler' /> 
</typeHandlers> 
```

# php - 括号内的匹配模式

> ID：14762473
> 
> 赞同：0
> 
> 时间：2013-02-07T22:42:36.507
> 
> 标签：php, regex, preg-match

我正在尝试制作一个移动检测类，该类应该将用户代理剥离为一个简单的基本字符串，如下所示：

> **输出：** Mozilla/5.0 (*Linux x86_64*) AppleWebKit/* (KHTML, like Gecko) Chrome/* Safari/*

由此：

> **输入： (HTTP_USER_AGENT)** Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.17 (KHTML, like Gecko) Chrome/24.0.1312.69 Safari/537.17

我正在使用这个：`/[0-9.-]{4,}/i`模式来去除数字，我得到：

> **上述模式的结果：** Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/* (KHTML, like Gecko) Chrome/* Safari/*

但我的问题是如何删除`X11;`我想要的模式，该模式将删除第一个左括号之后的所有内容，直到第一个空白空间，我认为这是正确的方法。可接受的替代方案是能够使用图案完全移除括号。

有什么建议么？

PS：我需要这个来解决移动检测和对browscap的依赖问题。所以请不要拒绝投票！

PS2：这样做的主要目的是检测移动客户端和桌面。之后，我将对其进行调整以提供操作系统等信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T23:16:48.160

更换**X11；**但不是**KHTML**：

```
preg_replace('/\([^,)]*? ([^\)]+)/','(*\1*',$agent); 
```

在这里解释演示：[http ://regex101.com/r/vL6gT1](http://regex101.com/r/vL6gT1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T23:18:01.293

尝试使用

```
preg_replace('/[0-9.-]{4,} #your original regex
    | # OR
    ( # start capture
       \( # open paren
    ) # end capture (so we can put the paren back)
    [^\s]+ # any number of non-space characters
    \d # a digit
    [^\s]+ # the remaining non-space characters (including other digits)
    \s # the final space
/xi', '\1', $str); 
```

# c - 二进制文件函数中的 fseek、fread 和返回指针 (C) 无法正常工作

> ID：14762476
> 
> 赞同：0
> 
> 时间：2013-02-07T22:42:53.590
> 
> 标签：c, pointers, fread, fseek

我想返回指向我从文件中读取的结构的指针（它转到另一个基本上只是打印数据的函数。）函数通过 int sem 获取（序列号-1），然后的想法是，设置文件指针指向我想用 fseek 读取的结构的开头，然后简单地读取整个结构并返回指针。（示例：如果文件中写入的结构数为5，我想读取4号结构，则函数获取的sem值为3，则用fseek指针跳过前3个结构，函数读取并返回结构 4 号）。如果 sem 值为 0，它可以正常工作，但当我寻找任何其他结构时，它就不那么好了。我不知道出了什么问题！帮助？:)

```
type_seminar *file_seminars_search(int sem) {
     type_seminar *temp_s = (type_seminar*) malloc(sizeof(type_seminar));
     FILE *f_sem;
     if ((f_sem = fopen("seminars.bin", "r")) != NULL ) {
          fseek(f_sem, sem * sizeof(type_seminar), SEEK_SET);
          fread(temp_s, sizeof(type_seminar), 1, f_sem);
          fclose(f_sem);
          return (temp_s);
     } else
          printf("Cannot access file. \n ");
     return 0;
} 
```

结构定义：

```
typedef struct {
     char s_title[A];
     char s_street[B];
     char s_town[C];
     int max_no_teachers;
     int no_applied_teachers;
} type_seminar; 
```

*   [研讨会.txt 文件的内容](http://www.flickr.com/photos/92976167@N05/8454761716/in/photostream/)
*   [如果我选择文件中的第二个结构，它会在屏幕上打印什么](http://www.flickr.com/photos/92976167@N05/8454761702/in/photostream)

如果问题出在此处，则打印数据的功能：

```
void seminar_details(type_seminar *temp_s) {
      printf("   SEMINAR TITLE : %s", temp_s->s_title);
      printf("   Street: %s ", temp_s->s_street);
      printf("   Town: %s", temp_s->s_town);
      printf("   Max no of applied teachers: %d \n", temp_s->max_no_teachers);
      printf("   No of applied teachers: %d \n", temp_s->no_applied_teachers);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T23:44:26.723

我觉得seminars.bin 的创建方式将决定文件的读取方式。与 ascii 模式相比，以二进制模式打开文件也可能会有所帮助。

我使用以下函数创建了seminars.bin

```
void createData()
{
FILE    *fcre;
type_seminar element;
int counter;

fcre = fopen("seminars.bin", "wb");
for(counter = 0; counter < 5; counter++)
{
    printf("Enter type_seminar.s_title:");
    scanf("%s", element.s_title);
    printf("Enter type_seminar.s_street:");
    scanf("%s", element.s_street);
    printf("Enter type_seminar.s_town:");
    scanf("%s", element.s_town);
    printf("Enter type_seminar.max_no_teachers:");
    scanf("%d", &element.max_no_teachers);
    printf("Enter type_seminar.no_applied_teachers:");
    scanf("%d", &element.no_applied_teachers);

    fwrite(&element, sizeof(type_seminar), 1, fcre);
}
fclose(fcre);
} 
```

我将原始文件中的几行修改为

```
if ((f_sem = fopen("seminars.bin", "rb")) != NULL ) 
```

和

```
 fread(temp_s, sizeof(type_seminar), 1, f_sem); 
```

通过这些更改，我可以让您的代码按照您的预期设计工作！

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-07T23:01:01.340

问题在

```
return 0; 
```

线。因为你没有返回 int。

# android - 不要因为我启动的另一个活动暂时处于前台而关闭相机

> ID：14762477
> 
> 赞同：1
> 
> 时间：2013-02-07T22:42:54.297
> 
> 标签：android, camera, android-camera, activity-lifecycle

我有一个使用相机的非常稳定的应用程序，我在我的活动的 onResume() 中调用 camera.open() 和在 onDestroy() 中调用 camera.release()。

这很好，直到我做了一些需要在我的顶部启动另一个活动的小任务，例如让用户选择一个联系人。

问题是，一旦我的活动失去前景，就会调用 onDestroy() 来关闭相机。然后，一旦用户选择了联系人，我们就回到我的活动，相机再次打开。

我想在不关闭相机的情况下调用联系人应用程序来选择一个联系人，但是当我的应用程序通过后退按钮、主页按钮或其他东西合法关闭时，我还需要干净地关闭相机。

这是一个问题，因为该设备是三星 Galaxy 相机，每个阶段打开和关闭相机大约需要 2 秒，并且镜头也会稍微伸出，如果您将设备握在手中，这可能会很烦人。

关于如何区分我的应用程序的真正关闭和由于我调用的另一个活动而被简单地置于后台的任何建议？

谢谢。

# django - 在自定义模板中使用 django 注册表单

> ID：14762480
> 
> 赞同：1
> 
> 时间：2013-02-07T22:43:01.100
> 
> 标签：django, django-registration

我正在尝试为登录用户创建一个帐户设置页面。用户应该能够做的一件事是更改他们的密码。

我正在使用 django-registration，它默认在 site/accounts/password/change 处提供密码更改表单，并且可以正常工作。但是，我希望在帐户设置页面上可以使用此功能，以及其他管理功能。

我首先尝试复制模板代码，但它不起作用，因为它包含一个特殊的表单来创建密码输入（以处理验证）。我不知道如何将此表单包含在我自己的模板中。

如何在我自己的帐户设置模板中重新创建这些表格？

[这](https://gist.github.com/hph/4734922)是默认的密码更改模板。我想`form.oldpassword`在单独的模板中重用和其他人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T10:12:05.837

Django-registration 没有实现自己的密码更改视图，它重用了 Django ( `django.contrib.auth.views.password_change`) 中包含的那个。它通过`registration.auth_urls`它被包含在`default`和`simple`注册后端中。

默认情况下视图使用`django.contrib.auth.forms.PasswordChangeForm`（可以通过`password_change_form`参数覆盖）。

当您只重用表单时（您当然可以这样做，只需在自定义视图中导入上述表单），您应该知道您仍然会丢失整个视图逻辑。因此，除非您考虑到更复杂的视图，否则您应该考虑重用它并覆盖`registration/password_change_form.html`and`registration/password_change_done.html`模板。

# visual-studio-2010 - 如何修复分析错误“无法添加计数器：cta_launched_vsm0”

> ID：14762482
> 
> 赞同：0
> 
> 时间：2013-02-07T22:43:17.633
> 
> 标签：visual-studio-2010, cuda, profiling

当我尝试运行内核分析时，我收到了一系列`Couldn't add counter: cta_launched_vsm0`错误。我认为这可能是由于分析器针对的是费米卡，而机器中有一张开普勒卡。我正在使用`Code Generation` `compute_30,sm_30`. 我该如何解决这个错误？

环境：

*   Windows 7 64 位
*   视觉工作室 2010
*   CUDA 4.2 + CUDA 5.0（5.0 安装在 4.2 之上）
*   发生在使用 CUDA 5.0 向导和 5.0 SDK 示例创建的项目中。使用 4.2 向导创建的项目也会出现这种情况。调试和发布版本。
*   GPU：单个 GTX660。（GTX570 之前安装过，但现在不再安装）。
*   分析活动：分析 CUDA 应用程序。要运行的实验：全部。其他默认设置。
*   Nsight 2.2，与 CUDA 5 捆绑在一起。

错误：

```
Nsight：分析内核内核
Nsight：实现入住实验（1/13）：。
Nsight：实现翻牌实验（2/13）：。
Nsight：指令统计实验（3/13）：无法添加计数器：cta_launched_vsm0
（设备不支持）
Nsight：问题效率实验（4/13）：无法添加计数器：cta_launched_vsm0
（设备不支持）
Nsight：分支实验（5/13）：..
Nsight：内存全局实验（6/13）：无法添加计数器：cta_launched_vsm0
（设备不支持）
Nsight：内存本地实验（7/13）：无法添加计数器：cta_launched_vsm0
（设备不支持）
Nsight：内存原子实验（8/13）：无法添加计数器：cta_launched_vsm0
（设备不支持）
Nsight：内存共享实验（9/13）：无法添加计数器：cta_launched_vsm0
（设备不支持）
Nsight：内存纹理实验（10/13）：无法添加计数器：tex0_cache_sector_misses_gpc0_tpc0
（设备不支持）
Nsight：内存缓存实验（11/13）：..无法添加计数器：l2_slice0_read_sectors_l1_fb0

Nsight：内存帧缓冲实验（12/13）：无法添加计数器：l2_slice0_read_sysmem_sectors_fb0
（设备不支持）
Nsight：启动信息实验（13/13）：。
Nsight：实验完成，需要的总重放：7

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T03:11:11.193

Nsight Visual Studio 版本 2.2 在 GTX 660 (GK106) 上市之前发布。Nsight 2.2 已多次更新，可与与 GTX 660 兼容的驱动程序一起使用。但是，PM 编程库并未针对 2.2 进行更新。

[Nsight Visual Studio 3.0 RC1 可在此处](https://developer.nvidia.com/nvidia-nsight-visual-studio-edition)下载，支持 GTX 660 和 Tesla K20。

# postgresql - JPA SequenceGenerator 和 GeneratedValue：名称/生成器属性仅每个类唯一？

> ID：14762483
> 
> 赞同：5
> 
> 时间：2013-02-07T22:43:24.263
> 
> 标签：postgresql, jpa, sequence, auto-increment, openjpa

我使用 JPA + OpenJPA 和 PostgreSQL 作为后端 RDBMS。我的表的主键通常由`SERIAL`/`BIGSERIAL`列组成。因此 PostgreSQL 会自动为新条目 ( `strategy=GenerationType.IDENTITY`) 生成 ID。

ID 属性的注解如下所示：

```
@Id
@SequenceGenerator(name="myseq",sequenceName="foobartable_fooid_seq")
@GeneratedValue(generator="myseq",strategy=GenerationType.IDENTITY) 
```

我的问题是：我可以将此注释块复制并粘贴到多个实体，同时只修改`sequenceName`值吗？表`sequenceName`与表不同。但是可以命名所有实体的 SequenceGenerator`myseq`或类似的名称吗？还是必须为每个实体的 SequenceGenerator 指定一个唯一的生成器名称？那么每个 SequenceGenerator 名称在持久化单元中必须是唯一的吗？

使用与数据库中的 sequenceName 相同的值可能是个好主意吗？所以我会写一些类似的东西

```
@Id
@SequenceGenerator(name="foobartable_fooid_seq",sequenceName="foobartable_fooid_seq")
@GeneratedValue(generator="foobartable_fooid_seq",strategy=GenerationType.IDENTITY) 
```

关于如何命名 SequenceGenerators 有什么建议吗？

非常感谢您的任何建议！

您的，Snrub 先生

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T22:52:31.630

在[Javadoc](http://docs.oracle.com/javaee/6/api/javax/persistence/SequenceGenerator.html) for 中`SequenceGenerator`，重点是我的：

> 定义一个主键生成器，当为 GeneratedValue 注释指定生成器元素时，该生成器可以按名称引用。可以在实体类或主键字段或属性上指定序列生成器。**生成器名称的范围对于持久性单元是全局的（跨所有生成器类型）。**

因此，您需要为持久性单元中定义的每个序列使用唯一名称。`GeneratedValue`正如上面评论中所指出的，在切线上，您的策略应该是 SEQUENCE。

# php - PHP脚本在命令行上运行，但不在浏览器中

> ID：14762484
> 
> 赞同：2
> 
> 时间：2013-02-07T22:43:33.033
> 
> 标签：php, mysql, apache2

我是一个完整的初学者，但我已经设置了一个 EC2 服务器，并且我正在尝试开发一个简单的基于 php-mysql 的网站。

我已经设法让 apache2 运行，并且我有一个指向服务器的域。我正在尝试设置一个非常简单的 php 脚本来附加到数据库。当我使用命令行时，以下脚本运行良好`php simple_script.php`

```
<?php

echo "Hello\n";

$con = mysql_connect("localhost","james","<password>");
if($con){
echo "Connected\n";
}
?> 
```

然而，当我去的时候，`www.myurl.com/simple_script.php`我只看到“你好”这一行。任何帮助将不胜感激！

好的，所以我检查了 apache 错误日志，上面写着： `PHP Fatal error: Call to undefined function mysql_connect() in /var/www/www.myurl.com/simple_script.php on line 5` 任何想法如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T22:47:04.803

添加：

```
else {
    die(mysql_error());
} 
```

找出错误

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T00:11:40.233

您正在使用已弃用的功能。使用 mysqli_* 或查看 PDO 类。 [http://php.net](http://php.net)有很好的语言文档 :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T22:53:58.477

如果您试图解决问题（并且如果这不在生产服务器上），我将首先通过在您的 php.ini 文件中启用错误报告来显示 php 错误。要找出 php.ini 的位置，请创建一个使用 phpinfo() 函数的文件，您应该会得到路径。（这也会告诉你 mysql 是否正在运行。）

```
<?php phpinfo();?> 
```

在 php.ini 中，查找“error_reporting”行并将其设置为：

error_reporting = E_ALL & ~E_NOTICE

# jquery - jquery 字符串 + 添加额外字符开始

> ID：14762485
> 
> 赞同：0
> 
> 时间：2013-02-07T22:43:45.877
> 
> 标签：jquery, html

我有以下 JQUERY 函数：

```
function siteCounterUpdate(n) {
    $('ul#indexSiteCounterBottom').empty();
    for(i=0;i<9;i++) {

            //alert(n.toString()[i]);

      $('ul#indexSiteCounterBottom').append('<li>'+n.toString()[i]+'</li>');
      $('ul#indexSiteCounterBottom li:nth-child(3n)').addClass('extra-margin');
    }
} 
```

该函数接收一个数字（字符串），如果它的长度为 9 个字符，则它可以完美运行。9是全长。

但是，如果数字说 7 个字符长，我需要用 HTML 替换前 2 个项目，没有空格。

```
&nbsp; 
```

我正在努力理解如何做到这一点。

例如：6 个字符的长字符串将是 1.nbsp 2.nbsp 3.nbsp 4 - 9.字符串。

任何建议都会很棒。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T22:52:02.993

以下是填充字符串的方法：

```
function padString (str, len, padWith) {
    var padLength = len - str.length;
    return padLength < 1 ? str : Array(padLength + 1).join(padWith) + str;
} 
```

示例用法：

```
padString('1234567899', 9, '&nbsp;'); // "1234567899"
padString('123456789', 9, '&nbsp;');  // "123456789"
padString('12345678', 9, '&nbsp;');   // "&nbsp;12345678"
padString('1234567', 9, '&nbsp;');    // "&nbsp;&nbsp;1234567"
padString('234567', 9, '&nbsp;');     // "&nbsp;&nbsp;&nbsp;234567" 
```

这是小提琴：http: [//jsfiddle.net/8JdwP/](http://jsfiddle.net/8JdwP/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T22:49:06.697

您可以使用几个`for`这样的循环来计算您的 's 和and字符串之间的`n`和：`9``&nbsp;``0``n`

```
function siteCounterUpdate(n) {
    var target = $('ul#indexSiteCounterBottom').empty();

    for (var i=n.length;i<9;i++) {
        target.append('<li>&nbsp;</li>');
    }

    // `i` doesn't have to be declared again because there's no block
    // scope in JavaScript, but I think it looks ugly otherwise :(.
    for (var i=0;i<n.length;i++) {
        target.append('<li>' + n + '</li>');
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T22:59:29.397

我可能对你想要什么感到困惑，但你能不能把柜台右对齐，这样你就不需要空格了？

如果没有，您可以创建一个 pad 函数，如此[处](https://stackoverflow.com/questions/6466135/adding-extra-zeros-in-front-of-a-number-using-jquery)所述。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-07T23:03:10.087

```
while (yourString.length < 9)
{
    yourString = "\u00A0" + yourString;   
} 
```

[***演示***](http://jsfiddle.net/u7BYz/)

# javascript - 使用 angularjs 设置默认的 http 主机

> ID：14762486
> 
> 赞同：6
> 
> 时间：2013-02-07T22:43:55.170
> 
> 标签：javascript, angularjs

有没有办法将我的 API 主机设置为默认主机，例如[http://example.com/v1](http://example.com/v1)，这样我就不必在每个 $http 或 $resource 请求中指定完整的 url？这样我就可以使用相对 URL。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-22T01:53:02.980

我找了类似的东西，结果空空如也。最后我真的不想要这样，因为它会阻止我访问除指定主机之外的 API。我最终做的是使用 API url 创建了一个常量，然后我将其注入任何需要它的服务中。像这样的东西：

```
angular.module('admin').constant('ApiUrl', 'http://example.com/v1'); 
```

这可以在您的模块文件上，然后在服务上：

```
(function () {
'use strict';

angular
    .module('admin')
    .factory('SampleFactory', SampleFactory);

SampleFactory.$inject = ['$resource', 'ApiUrl'];

function SampleFactory($resource, ApiUrl) {
    var resource = $resource(ApiUrl + 'cohort/:id', {}, { update: { method: 'PUT' } });
    return resource;
}
})(); 
```

# javascript - RaphaelJS 切换转换

> ID：14762491
> 
> 赞同：1
> 
> 时间：2013-02-07T22:44:20.843
> 
> 标签：javascript, animation, raphael

有什么方法可以切换您在 RaphaelJS 中所做的转换？截至目前，以下代码可在单击时使圆圈变大。我需要的是切换转换，以便我可以再次单击，然后圆圈缩小并移回原位。

```
window.onload = function() {
    centerX = 300;
    centerY = 300;
    var paper = new Raphael(document.getElementById('canvas_container'), 900, 900);

    //setup main circle
    var mainCircle = paper.circle(centerX,centerY,90);
    mainCircle.attr(
        {
            gradient: '90-#526c7a-#64a0c1',
            stroke: '#3b4449',
            'stroke-width': 10,
            'stroke-linejoin': 'round',
            rotation: -90  
        }  
    );

    //when clicking main circle
    mainCircle.click( function(e) {

        //move and grow the main circle
        mainCircle.animate({cx:00, cy:00, r:100}, 1000, "easeout");
        mainCircle.animate({
                "transform": "s " + (s = 3)}, 1000, "easeout"
    });

}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T23:07:20.353

您可以应用一个简单的技巧来切换动画属性（或任何对象）；将它们放在一个数组中，并通过将数字开关作为索引来交替调用它们：

```
var animAttrArr = [{
    "transform": "s 3"
}, {
    "transform": "s 1"
}],
    now = 1;

mainCircle.click(function (e) {
    this.animate(animAttrArr[+(now = !now)], 1000, "easeout");
}); 
```

我们只是在 JavaScript 中使用软类型来为我们带来好处——数字可以被评估为布尔值并充当标志。

**在 jsFiddle 上查看[现场演示](http://jsfiddle.net/eliranmal/nLmrB/)。**

* * *

*   作为旁注，我建议`stop()`在触发任何动画之前添加一个调用，以防止重叠动画，例如：

    ```
    this.stop().animate(animAttrArr[+(now = !now)], 1000, "easeout"); 
    ```

*   作为另一个说明，可以通过提取计数器的模数和数组长度来更新代码以支持`n > 2`转换的切换，然后将其递增（感谢@gion_13）：

    ```
    this.stop().animate(animAttrArr[now++ % animAttrArr.length], 1000, "easeout"); 
    ```

    模运算将优先于增量，所以不要担心命中`+Infinity`（如果你真的很担心:)）。

# php - preg_replace：将换行符转换为段落

> ID：14762492
> 
> 赞同：7
> 
> 时间：2013-02-07T22:44:24.373
> 
> 标签：php, regex

我想将换行符转换为段落。

例如

```
$string = "1st paragraph

2nd paragraph

3rd paragraph 
"; 
```

我想得到，

```
<p>1st paragraph</p>
<p>2nd paragraph</p>
<p>3rd paragraph</p> 
```

和，

```
$string = "1st paragraph

2nd paragraph
a line break

3rd paragraph 
"; 
```

进入，

```
<p>1st paragraph</p>
<p>2nd paragraph<br/>a line break</p>
<p>3rd paragraph</p> 
```

`regex`和有可能`reg_replace`吗？或者其他更好的东西 - `xpath`？

这个我试过了，还没有结果

```
echo preg_replace("'/^(.*?)(<br\s*\/?>\s*)+/'", "<p>$1</p>", nl2br($string)); 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-07T22:48:09.917

你可以反过来做：首先用段落替换多个换行符，然后用`<br>`元素替换单个换行符。

```
$str = preg_replace('/\n(\s*\n)+/', '</p><p>', $str);
$str = preg_replace('/\n/', '<br>', $str);
$str = '<p>'.$str.'</p>'; 
```

您还应该首先规范化行尾（windows 风格到 unix 风格）：

```
function normalize($str) {
    // Normalize line endings
    // Convert all line-endings to UNIX format
    $s = str_replace("\r\n", "\n", $str);
    $s = str_replace("\r", "\n", $s);
    // Don't allow out-of-control blank lines
    $s = preg_replace("/\n{2,}/", "\n\n", $s);
    return $s;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-07T22:55:53.843

另一个解决方案：

```
$string = preg_replace('/\n{2,}/', "</p><p>", trim($string));
$string = preg_replace('/\n/', '<br>',$string);
$string = "<p>{$string}</p>"; 
```

# time - 三次以上的哦符号

> ID：14762495
> 
> 赞同：0
> 
> 时间：2013-02-07T22:44:48.003
> 
> 标签：time, complexity-theory, notation

我有一个关于在算法中计算时间复杂度的问题。如果您有四个嵌套的 for 循环，是否可以使用诸如 O(n^4) 之类的符号？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T22:46:57.333

很简单，答案是肯定的。四个嵌套循环可以（取决于循环）为 O(n ⁴ )。

复杂度高于三次的多项式时间算法并不多，但它们确实存在。例如，众所周知的 AKS 素性检验在其原始公式中是 O(k ^(12) )（其中 k 是输入数字的长度），尽管它最近已减少到 k ^(7.5)。

# screen - 如何使用自己的菜单|选项创建 3270 屏幕？

> ID：14762502
> 
> 赞同：0
> 
> 时间：2013-02-07T22:45:12.657
> 
> 标签：screen, rexx, 3270

我想知道是否可以使用我自己的选项创建一个 3270 类型的屏幕，比如一个程序。如果可能，是否使用 REXX 完成？直到现在我都找不到任何关于它的东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-07T23:03:01.940

这取决于您的 Rexx 程序在哪里运行。例如，如果您在[ISPF](https://www.ibm.com/docs/en/zos/2.4.0?topic=ispf)中运行 Rexx，您可以创建一个[ISPF 对话框](https://www.ibm.com/docs/en/zos/2.4.0?topic=ispf-zos-dialog-developers-guide-reference)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-14T15:40:34.203

REXX 并没有真正做到这一点，而是 ISPF 做到了。面板定义作为文本文件存储在您的 ISPPLIB 连接中，然后通过 ISPF 对话服务 DISPLAY PANEL 调用。这可以从 REXX、Clist、汇编器等调用。

您需要阅读 ISPF Dialog Developer's Guide and Reference。REXX 手册中没有提到它。

[http://publibz.boulder.ibm.com/epubs/pdf/ispzdg80.pdf](http://publibz.boulder.ibm.com/epubs/pdf/ispzdg80.pdf)

（有一个较新的版本，但这些东西并没有太大变化）。

要查看面板定义，请查看 TSO 中 ISSPLIB 连接中的任何数据集。使用 TSO ISRDDN 命令查看您分配了哪些库。

ISPPLIB - 面板 SYSPROC/SYSEXEC - Clist/REXX ISPSLIB - 骨架 ISPTLIB - 表格

等等等等

史蒂夫

# ruby-on-rails - 使用 Devise 完成电子邮件确认后，如何添加此交易？

> ID：14762503
> 
> 赞同：0
> 
> 时间：2013-02-07T22:45:13.063
> 
> 标签：ruby-on-rails, ruby-on-rails-3, devise

假设现有用户（ID：1367）可以将此网址作为邀请发送给他的朋友。

```
http://example.com/users/sign_up?invitation=1367 
```

然后用户表有一个隐藏的列名为`invitation`。

这是我想要的程序。

1.  他的朋友输入信息注册。

2.  他点击提交按钮，然后隐藏字段“邀请”也将发送到表单。

3.  `1367`将在记录的“邀请”列中设置。

4.  他会收到确认邮件，当他点击链接时，我想添加这个交易，并且只为他的账户执行一次。
    当然，当现有用户尝试重新激活时，不应执行此操作。
    仅用于新用户的第一次确认。

**代码**

```
@user = User.find_by_invitation(current_user.invitation)
@user.friends = @user.friends + 1
@user.save 
```

我已经有了注册控制器，可以帮助向 Devise 添加额外的事务。
现在我想知道如何在我的应用程序中实现这个过程。

应该是这样的吗？

**注册控制器.rb**

```
def after_????????
    if @user = User.find_by_invitation(current_user.invitation)
        @user.friends = @user.friends + 1
        @user.save
    end
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T01:58:47.647

您可以在用户模型上执行此操作。使用`after_create`在创建用户后触发的回调。

```
# user.rb
after_create :handle_invitation_code

private

def handle_invitation_code
  # do something with invitation here
  # i'm assuming that you want to credit
  # whoever it is that invited this user
  # assuming that invitation contains the
  # id of the referrer
  if referrer = User.find_by_id(invitation)
    # do something with referrer
  end
end 
```

请注意，如果您在回调中返回 false，则会导致回滚并且不会保存记录。

更新：确认后回调

而不是使用`after_create`，`before_save`与`if`选项一起使用

```
before_save :handle_invitation_code, if: :just_confirmed?

def just_confirmed?
  confirmed_at_changed? && confirmed_at_was.nil?
end

def handle_invitation_code
  ...
end 
```

# wcf - WCF basicHttpsBinding 警告：“根据其数据类型无效”

> ID：14762507
> 
> 赞同：1
> 
> 时间：2013-02-07T22:45:30.670
> 
> 标签：wcf, wcf-binding, wcf-endpoint

我创建了一个 WCF 应用程序，从 basicHttpBinding 开始。在 app.config 中，我配置了以下端点：

```
<endpoint address="" binding="basicHttpBinding" contract="JMMEcommerceService.IJMMEcommerceService">
  <identity>
    <dns value="localhost" />
  </identity>
</endpoint> 
```

这很好。但是，我想将协议从 HTTP 更改为 HTTPS。如果我将端点声明更改为：

```
<endpoint address="" binding="basicHttpsBinding" contract="JMMEcommerceService.IJMMEcommerceService">
  <identity>
    <dns value="localhost" />
  </identity>
</endpoint> 
```

（注意：唯一的变化是 basicHttpBinding -> basicHttpsBinding）

我在构建时间收到以下警告：

```
WCF configuration validation warning: The 'binding' attribute is invalid - The value 'basicHttpsBinding' is invalid according to its datatype 'serviceBindingType'. 
```

为什么我会收到此警告？还有什么我需要改变的吗？

这是完整的 app.config：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <appSettings>
    <add key="aspnet:UseTaskFriendlySynchronizationContext" value="true" />
  </appSettings>
  <system.web>
    <compilation debug="true" />
  </system.web>
  <!-- When deploying the service library project, the content of the config file must be added to the host's 
  app.config file. System.Configuration does not support config files for libraries. -->
  <system.serviceModel>
    <services>
      <service name="JMMEcommerceService.JMMEcommerceService">
        <endpoint address="" binding="basicHttpsBinding" contract="JMMEcommerceService.IJMMEcommerceService">
          <identity>
            <dns value="localhost" />
          </identity>
        </endpoint>
        <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
        <host>
          <baseAddresses>
            <add baseAddress="https://localhost:8733/Design_Time_Addresses/JMMEcommerceService/JMMEcommerceService/" />
          </baseAddresses>
        </host>
      </service>
    </services>
    <behaviors>
      <serviceBehaviors>
        <behavior>
          <!-- To avoid disclosing metadata information, 
          set the values below to false before deployment -->
          <serviceMetadata httpGetEnabled="True" httpsGetEnabled="True"/>
          <!-- To receive exception details in faults for debugging purposes, 
          set the value below to true.  Set to false before deployment 
          to avoid disclosing exception information -->
          <serviceDebug includeExceptionDetailInFaults="True" />
        </behavior>
      </serviceBehaviors>
    </behaviors>
  </system.serviceModel>

</configuration> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T22:52:49.553

.NET 4.0中`basicHttpsBinding`似乎不存在，仅在 4.5 中存在。您的目标是哪个版本的 .NET？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-24T12:58:38.710

如果您想为您的服务启用 HTTPS，但不为您的元数据启用 HTTPS，您必须为基于 HTTP 的元数据交换端点提供另一个基地址。

```
<baseAddresses>
  <add baseAddress="https://localhost:8733/Design_Time_Addresses/JMMEcommerceService/JMMEcommerceService/" />
  <add baseAddress="http://localhost:8734/Design_Time_Addresses/JMMEcommerceService/JMMEcommerceService/" />
</baseAddresses> 
```

请注意，您还必须分配另一个端口（8734）。两个协议不能使用同一个端口！

PS：别忘了给8733端口分配正确的证书

# ms-access - 访问 UI 挂断

> ID：14762508
> 
> 赞同：0
> 
> 时间：2013-02-07T22:45:38.853
> 
> 标签：ms-access, vba

所以我有一个正在使用的访问数据库。在所述数据库中，我构建了一个运行搜索引擎的表单。该搜索引擎根据相关性对结果进行排名。根据搜索的不同，可能会有超过 10,000 个结果需要通过和排名。所以我添加了一个状态栏来向用户显示需要多长时间。对于更大的搜索，大约 7,000 个结果，一旦状态栏达到大约 1/3 的位置，它就会冻结，但整个程序并没有被冻结。最终它将排名结果返回给用户。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T14:34:28.660

离开一个项目一段时间会有多大帮助，真是令人惊讶。早上进去，10分钟就搞定了。每 500 条记录我暂停 1/8 并运行`DoEvents`它，这样状态栏就可以赶上程序的其余部分。

# c++ - 如何在 C++11 中给全局命名空间起别名

> ID：14762510
> 
> 赞同：11
> 
> 时间：2013-02-07T22:45:44.290
> 
> 标签：c++, c++11, namespaces, alias, global-scope

**简短形式**：如何在 C++11 中为根（全局）命名空间定义别名？它可能看起来像

`namespace root_namespace = :: ;`

其中，上面裸形式的范围解析运算符是全局命名空间的某个句柄的占位符。我在[GCC Internals Manual](http://gcc.gnu.org/onlinedocs/gccint/Namespaces.html)中读到

...[编译器]整个中间表示的根是变量 global_namespace。这是`::`在 C++ 源代码中指定的命名空间... 全局命名空间的名称是`::`，尽管在 C++ 中全局命名空间是未命名的。

**PS 编辑**：对于迄今为止的受访者，我在以下**长表格之后附加了一个****痛苦的长表格**来解决一些问题，因为它*可能会*澄清一些事情。追随者，如果你看到我们在谈论而不是互相交谈，请深入了解。

 **** * *

**长格式**：以下是其潜在用途的一个示例。如果不满意，那么是的，这是一个学术问题；看看下面这个**令人痛苦的长表格**。

想象一下，有一天你的老板闯入说：“我刚读了一本关于后实证主义的书。摆脱…… `namespace ObjectiveReality`”。在下面的代码中，你所要做的就是省略我这样标记的`/* -> */`行`/* <- */`。您目前**可以**对中间级别的嵌套执行此操作；但是，我不确定如何定义全局范围`namespace current_authority`以允许简单地省略第一个非全局命名空间。

```
#include <iostream>
#include <iomanip>

// ...
using cat_is_alive = std::true_type ; // because I like cats
using cat_is_alive = ::cat_is_alive ; // seems to work, see `g++ -v` below
// ...

// ASIDE: I originally had `namespace higher_authority = COMPILER ;` as a comment, but changed it for simpler chaining closure

// The next two lines are the crux of my question...

namespace higher_authority = global_namespace ;
namespace current_authority = global_namespace ; // a.k.a. the naked ::

// If the above two lines defined aliases for the (unnamed) global namespace, then the suggested elisions/replacements work...

/* -> */
namespace ObjectiveReality {
/* <- */
// Simplest fix: replace with `using ObjectiveReality = current_authority ;`
//   (Otherwise, a few other changes are necessary)

    namespace higher_authority = current_authority ;
    namespace current_authority = ObjectiveReality ;

    using cat_is_alive = higher_authority::cat_is_alive ;

    namespace EntangledObserver {

        namespace higher_authority = current_authority ;
        namespace current_authority = EntangledObserver ;

        using cat_is_alive = higher_authority::cat_is_alive ;
    } ;
/* -> */
} ;
/* <- */

int main( int argc, char** argv ) {

    std::cout
        << "It is "
        << ObjectiveReality::EntangledObserver::cat_is_alive::value
       << " that the cat is alive." << std::endl ;

    return 0 ;
}

// EOF 
```

如果需要编译器信息：

```
$ g++ -std=c++11 -v

Using built-in specs.
COLLECT_GCC=g++
COLLECT_LTO_WRAPPER=/usr/lib/gcc/i686-linux-gnu/4.7/lto-wrapper
Target: i686-linux-gnu
Configured with: ../src/configure -v --with-pkgversion='Ubuntu/Linaro 4.7.2-11precise2' 
--with-bugurl=file:///usr/share/doc/gcc-4.7/README.Bugs 
--enable-languages=c,c++,go,fortran,objc,obj-c++ --prefix=/usr --program-suffix=-4.7 
--enable-shared --enable-linker-build-id --with-system-zlib --libexecdir=/usr/lib 
--without-included-gettext --enable-threads=posix
--with-gxx-include-dir=/usr/include/c++/4.7 --libdir=/usr/lib
--enable-nls --with-sysroot=/ --enable-clocale=gnu --enable-libstdcxx-debug 
--enable-libstdcxx-time=yes --enable-gnu-unique-object --enable-plugin
--enable-objc-gc --enable-targets=all --disable-werror --with-arch-32=i686
--with-multilib-list=m32,m64 --with-tune=generic --enable-checking=release 
--build=i686-linux-gnu --host=i686-linux-gnu --target=i686-linux-gnu
Thread model: posix
gcc version 4.7.2 (Ubuntu/Linaro 4.7.2-11precise2) 
```

* * *

**PAINFULLY LONG FORM**：作为对“从嵌套命名空间开始”的一些答案的回应，请注意“HOME！” 是不可访问的，而且我可能没有在团队中手工挑选命名空间的奢侈。

```
//
// alice.cpp
//

#include <iostream>
#include <type_traits>

/////
///// The Setup
/////

//
// One-and-a-half macros
//

// BOO! Get rid of this case!
#define ENABLE_SUBSPACE_1( namespace_name ) \
    namespace namespace_name { \
    namespace last_namespace = ::namespace_name ; \
    namespace this_namespace = ::namespace_name ;

// YEAH! Instead, define 'namespace this_namespace = :: ;' and then...
#define ENABLE_SUBSPACE( namespace_name ) \
    namespace namespace_name { \
    namespace last_namespace = this_namespace ; \
    namespace this_namespace = last_namespace::namespace_name ;

//
// Some characters
//

struct dorothy {
    static constexpr auto obvious_statement = "There's no place like " ;
} ;

struct rabbit {
    template< typename T >
    static constexpr char const* says( T ) {
        return T::value ? "I'm late!" : "I'm late, but I ditched that addled girl." ;
    }
} ;

struct alice {

    using blue_pill = std::false_type ;
    static constexpr auto where_am_i = "HOME!" ;
} ;

/////
///// The Central Structure
/////

ENABLE_SUBSPACE_1( oxford_england ) // {

    using has_strangers_with_candy = std::true_type ;

    struct alice {
        using blue_pill = this_namespace::has_strangers_with_candy ;
        static constexpr auto where_am_i = "Uncle Charles' picnic blanket." ;
    } ;

ENABLE_SUBSPACE( rabbit_hole ) // {
    struct rabbit { using is_late = typename alice::blue_pill ; } ;
ENABLE_SUBSPACE( rabbit_hole ) // {
    struct rabbit { using is_late = typename alice::blue_pill ; } ;
ENABLE_SUBSPACE( rabbit_hole ) // {
    struct rabbit { using is_late = typename alice::blue_pill ; } ;
    using has_strangers_with_candy = std::false_type ; ///// Different...
ENABLE_SUBSPACE( rabbit_hole ) // {
    struct rabbit { using is_late = typename alice::blue_pill ; } ;
ENABLE_SUBSPACE( rabbit_hole ) // {
    struct rabbit { using is_late = typename alice::blue_pill ; } ;
    struct alice { ///// Different...
        using blue_pill = has_strangers_with_candy ;
        static constexpr auto where_am_i = "needing a fix." ;
    } ;
ENABLE_SUBSPACE( rabbit_hole ) // {
    struct rabbit { using is_late = typename alice::blue_pill ; } ;
    struct alice : last_namespace::alice { ///// Different...
        static constexpr auto where_am_i = "an empty rabbit hole." ;
    } ;
} ; // END rabbit_hole
} ; // END rabbit_hole
} ; // END rabbit_hole
} ; // END rabbit_hole
} ; // END rabbit_hole
} ; // END rabbit_hole
} ; // END oxford_england

/////
///// Snarky Output
/////

int main( int argc, char** argv ) {

    std::cout << std::endl
        << dorothy::obvious_statement
        << alice::where_am_i
        << std::endl ; // There's no place like HOME!

    std::cout
        << dorothy::obvious_statement
        << oxford_england::rabbit_hole::rabbit_hole::rabbit_hole::rabbit_hole::rabbit_hole::alice::where_am_i
        << std::endl ; // There's no place like needing a fix.

    std::cout
        << dorothy::obvious_statement
        << oxford_england::rabbit_hole::rabbit_hole::rabbit_hole::rabbit_hole::rabbit_hole::rabbit_hole::alice::where_am_i
        << std::endl ; // There's no place like an empty rabbit hole.

    std::cout << std::endl
        << rabbit::says(
            oxford_england::
                rabbit_hole::
                    rabbit_hole::
                        rabbit_hole::
                            rabbit_hole::
                                rabbit_hole::rabbit::is_late()
        ) << std::endl ; // I'm late!
    std::cout
        << rabbit::says(
            oxford_england::
                rabbit_hole::
                    rabbit_hole::
                        rabbit_hole::
                            rabbit_hole::
                                rabbit_hole:: // NOTE : alice::blue_pill is false_type
                                    rabbit_hole::rabbit::is_late() // ... not this time ; Alice is crashing.
        ) << std::endl ; // I'm late, but I ditched that addled girl.

    std::cout << std::endl
        << dorothy::obvious_statement
        << oxford_england::
                rabbit_hole:: // 1
                    rabbit_hole:: // 2
                        rabbit_hole:: // 3
                            rabbit_hole:: // 4
                                rabbit_hole:: // 5
                                    rabbit_hole:: // rabbit_hole #6
                                last_namespace:: // rabbit_hole #5
                            last_namespace:: // rabbit_hole #4
                        last_namespace:: // rabbit_hole #3
                    last_namespace:: // rabbit_hole #2
                last_namespace:: // rabbit_hole #1
            last_namespace::alice::where_am_i // oxford_england
        << std::endl ; // There's no place like Uncle Charles' picnic blanket.
    std::cout
        << dorothy::obvious_statement
        << oxford_england::
                rabbit_hole::
                    rabbit_hole::
                        rabbit_hole::
                            rabbit_hole::
                                rabbit_hole::
                                    rabbit_hole::
                                last_namespace::
                            last_namespace::
                        last_namespace:: // 3
                    last_namespace:: // 2
                last_namespace:: // 1
            last_namespace:: // oxford
        last_namespace::alice::where_am_i // not the global namespace!
        << ".. but I'd rather be " << ::alice::where_am_i // the global namespace.
        << std::endl ; // There's no place like Uncle Charles' picnic blanket... but I'd rather be HOME!

    std::cout << std::endl ;
    return 0 ;
}

/////
///// EOF
/////

/* Compiled with:
    `g++ -std=c++11 -o alice alice.cpp`
*/

/* Output of `alice` :

There's no place like HOME!
There's no place like needing a fix.
There's no place like an empty rabbit hole.

I'm late!
I'm late, but I ditched that addled girl.

There's no place like Uncle Charles' picnic blanket.
There's no place like Uncle Charles' picnic blanket... but I'd rather be HOME!

*/ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T00:14:42.837

我不认为你可以给全局命名空间取别名。

该标准定义了一个名称空间别名，其中 :: 显式调用，而不是将其视为另一个名称空间名称：

```
7.3.2   Namespace alias
A namespace-alias-definition declares an alternate name for a namespace according to the following grammar:
namespace-alias:
    identifier 
namespace-alias-definition:
    namespace identifier = qualified-namespace-specifier ;
qualified-namespace-specifier:
    ::_opt nested-name-specifier_opt namespace-name 
```

请注意 :: 是 opt（可选），但 namespace-name 不是。

但是，您不能只使用全局名称空间以外的东西作为名称空间堆栈的开始，并且仍然遵循您概述的模式吗？

另请注意，当您删除 ObjectiveReality 时，您的示例实际上确实需要编辑几行：

```
namespace current_authority = ObjectiveReality ; 
```

和：

```
<< ObjectiveReality::EntangledObserver::cat_is_alive::value 
```

这是您的示例使用命名空间“something”而不是全局命名空间作为命名空间堆栈的根的样子。

```
#include <iostream>
#include <iomanip>

// ...                                                                                                                                                                                                                                                                                                                                                                    
namespace something {
  using cat_is_alive = std::true_type ; // because I like cats                                                                                                                                                                                                                                                                                                            
}
using namespace something;
// ...                                                                                                                                                                                                                                                                                                                                                                    

// ASIDE: I originally had `namespace higher_authority = COMPILER ;` as a comment, but changed it for simpler chaining closure                                                                                                                                                                                                                                            

// The next two lines are the crux of my question...                                                                                                                                                                                                                                                                                                                      

namespace higher_authority = something;
namespace current_authority = something;                                                                                                                                                                                                                                                                                                         

// If the above two lines defined aliases for the (unnamed) global namespace, then the suggested elisions/replacements work...                                                                                                                                                                                                                                            

/* -> */
namespace ObjectiveReality {
  /* <- */
  // Simplest fix: replace with `using ObjectiveReality = current_authority ;`                                                                                                                                                                                                                                                                                            
  //   (Otherwise, a few other changes are necessary)                                                                                                                                                                                                                                                                                                                     

  namespace higher_authority = current_authority ;
  namespace current_authority = ObjectiveReality ;

  using cat_is_alive = higher_authority::cat_is_alive ;

  namespace EntangledObserver {

    namespace higher_authority = current_authority ;
    namespace current_authority = EntangledObserver ;

    using cat_is_alive = higher_authority::cat_is_alive ;
  } ;
  /* -> */
} ;
/* <- */

int main( int argc, char** argv ) {

  std::cout
    << "It is "
    << ObjectiveReality::EntangledObserver::cat_is_alive::value
    << " that the cat is alive." << std::endl ;

  return 0 ;
}

// EOF 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T21:12:57.990

我不知道直接别名默认命名空间的方法，但作为一种解决方法，您可以使用宏（假设您愿意忍受宏的名称与不相关的符号冲突）。

```
#define root_namespace 
```

用法：

```
root_namespace::cat_is_alive 
```

正如 Mooing Duck 正确指出的那样，此 hack 不适用于`using`子句。***

# xcode - 使用 NSNumberFormatter 的问题？

> ID：14762511
> 
> 赞同：0
> 
> 时间：2013-02-07T22:45:46.310
> 
> 标签：xcode, nsstring, nsnumberformatter

我正在尝试制作一个标签来显示温度，超过 100 的温度最多使用 3 位数字，但我不想要任何小数...

```
 NSString *longtempstring = [tmp description];
    NSNumberFormatter *formatter = [[NSNumberFormatter alloc] init];
    [formatter setMaximumFractionDigits:3];
    [formatter setMinimumFractionDigits:0];
    NSString *shorttempstring = [formatter stringForObjectValue:[NSString  stringWithString:longtempstring]]; 
```

上面的代码总是返回 (null)

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T22:55:33.593

你得到`nil`是因为你传递给的对象`stringForObjectValue:`不是预期的类型。

首先，不要使用`stringForObjectValue:`. 那是父类的成员，`NSFormatter`. `NSNumberFormatter`具有更具体的方法，可以避免混淆对象类型，如`numberFromString:`和`stringFromNumber:`。

其次，`NSNumberFormatter`用于从数字到格式化字符串或格式化字符串到数字。不是直接从格式化字符串到格式化字符串。您将需要使用一个数字格式化程序来读取您的原​​始字符串并生成一个数字，另一个从该数字生成一个新的更短的格式化字符串。

当然，您可以通过使用`NSScanner`或获取长字符串的子字符串（删除除数字本身之外的所有内容）然后使用`NSString`方法`integerValue`或`doubleValue`. 也可以使用正则表达式从第一个（较长的）字符串中提取数字。

总而言之，这是一个两步过程。第一步（获取数字）可以通过多种方式完成，并且`NSNumberFormatter`可能不是最简单的方法。第二步（获得一个新的较短的字符串）是`NSNumberFormatter`完美的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T23:00:02.343

我通过将 NSString 转换为 NSNumber 并仅从字符串中提取整数值来修复它，从而删除任何小数。

```
 NSString *longtempstring = [tmp description];
        NSNumber *tempintegervalue = [NSNumber numberWithInteger:[longtempstring integerValue]];
        NSString *shorttempstring = [tempintegervalue stringValue]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T23:02:44.293

```
NSString *longtempstring = [tmp description]; 
```

What is the value of `longtempstring` here? Is it even a number?

```
NSNumberFormatter *formatter = [[NSNumberFormatter alloc] init];
[formatter setMaximumFractionDigits:3];
[formatter setMinimumFractionDigits:0]; 
```

Why do you set maximum fraction digits to `3` if you say that you don't want any fraction digits? Fraction digits are what is "after the dot" and you say you don't want any decimals. If you don't want any decimals, minimum and maximum must be set to `0`.

```
NSString *shorttempstring = [formatter stringForObjectValue:[NSString  stringWithString:longtempstring]]; 
```

First of all, why are you copying the string? `[NSString stringWithString:...]` creates a new string that is a copy of the string you provide as argument. Strings are immutable, there is no need to copy them, they won't be modified. If you are afraid that a `NSString` may in fact be a `NSMutableString`, after all that is a subclass of `NSString` and you want to copy it, just **copy it** by calling `[aString copy]`. `copy` is a very smart method here. If the `NSString` is in fact a mutable string, it will really copy it, so you get an immutable copy. If it is not a mutable string, though, `copy` just returns the same string with a retain count increased by one (so in that case `copy` behaves exactly like `retain`). However, in your case copying makes no sense whatsoever.

And second, what makes you believe, that you can feed a string into a `NSNumberFormater`? It is called `NSNumberFormater` because it formats objects of type `NSNumber`. How is a `NSString` a `NSNumber`? It is not called `NSStringFormater`. If you feed an object of the wrong class to a formater, it will return `nil`, that's how this method is documented.

If your `longtempstring` contains a number with fraction, e.g. `12.345`, then the correct code would look like this:

```
NSString * longtempstring = [tmp description];
NSNumberFormatter * formatter = [[NSNumberFormatter alloc] init];
[formatter setMaximumFractionDigits:0];
[formatter setMinimumFractionDigits:0];
NSNumber * tempnumber = [NSNumber numberWithDouble:[longtempstring doubleValue]];
NSString * shorttempstring = [formatter stringForObjectValue:tempnumber]; 
```

However, if all you want to do is cut off the decimals, that is a horrible way to do it. This can be done much more effective:

```
double d;
NSString * longtempstring;
NSString * shorttempstring;

longtempstring = @"12.345";
d = [longtempstring doubleValue];
shorttempstring = [NSString stringWithFormat:@"%d", (int)d]; 
```

This is much shorter, needs less memory, and is at least three times faster. If you want to round the number (that means everything with a fraction `.5` and above is rounded to the next higher value), just round it:

```
d = round([longtempstring doubleValue]); 
```

# asp.net - 第二个并发页面方法调用不起作用

> ID：14762515
> 
> 赞同：1
> 
> 时间：2013-02-07T22:46:12.197
> 
> 标签：asp.net, internet-explorer-7, pagemethods

我有两个要执行的页面方法调用。一个是执行大量处理的长请求。第二个用于检索第一个呼叫的状态。问题是第二个电话在第一个电话结束之前没有得到响应。看着提琴手，我看到第一个页面方法调用发送一个请求，然后是第二个页面方法发送一个背靠背的请求，但是直到第一个结束，我才在 Visual Studio 中收到第二个请求。我认为 ie7 一次允许 2 个并发请求。

# python - Python datetime strptime() 和 strftime()：如何保存时区信息

> ID：14762518
> 
> 赞同：51
> 
> 时间：2013-02-07T22:46:13.597
> 
> 标签：python, datetime, python-datetime, python-dateutil

请参阅以下代码：

```
import datetime
import pytz

fmt = '%Y-%m-%d %H:%M:%S %Z'

d = datetime.datetime.now(pytz.timezone("America/New_York"))
d_string = d.strftime(fmt)
d2 = datetime.datetime.strptime(d_string, fmt)
print d_string 
print d2.strftime(fmt) 
```

输出是

```
2013-02-07 17:42:31 EST
2013-02-07 17:42:31 
```

时区信息只是在翻译中丢失了。

如果我将“%Z”切换为“%z”，我会得到

```
ValueError: 'z' is a bad directive in format '%Y-%m-%d %H:%M:%S %z' 
```

我知道我可以使用`python-dateutil`，但我只是觉得奇怪的是我无法在 datetime 中实现这个简单的功能并且必须引入更多的依赖关系？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-02-07T23:55:03.130

这里的部分问题是通常用于表示时区的字符串实际上并不是唯一的。“EST”对北美人来说仅意味着“America/New_York”。这是 C 时间 API 的一个限制，而 Python 解决方案是……如果有人愿意编写 PEP，那么现在任何一天都可以在未来的某个版本中添加完整的 tz 功能。

您*可以*将时区格式化和解析为偏移量，但这会丢失夏令时/夏季时间信息（例如，您无法在夏季区分“America/Phoenix”和“America/Los_Angeles”）。您可以将时区格式化为 3 个字母的缩写，但不能从中解析回来。

如果你想要一些模糊不清但通常是你想要的东西，你需要一个第三方库，比如`dateutil`.

如果你想要一些真正明确的东西，只需将实际的 tz 名称附加到本地日期时间字符串，然后在另一端将其拆分：

```
d = datetime.datetime.now(pytz.timezone("America/New_York"))
dtz_string = d.strftime(fmt) + ' ' + "America/New_York"

d_string, tz_string = dtz_string.rsplit(' ', 1)
d2 = datetime.datetime.strptime(d_string, fmt)
tz2 = pytz.timezone(tz_string)

print dtz_string 
print d2.strftime(fmt) + ' ' + tz_string 
```

或者......在这两者之间，您已经在使用该`pytz`库，它可以解析（根据一些任意但明确定义的消歧规则）格式，如“EST”。因此，如果您真的想要，您可以将`%Z`in 保留在格式化一侧，然后将其拉出并解析它，`pytz.timezone()`然后再将其余部分传递给`strptime`.

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-02-07T23:43:34.977

不幸的是，`strptime()`只能处理您的操作系统配置的时区，然后只能作为时间偏移量，真的。从[文档](http://docs.python.org/2/library/time.html#time.strptime)中：

> 对`%Z`指令的支持基于其中包含的值`tzname`以及是否`daylight`为真。因此，它是特定于平台的，除了识别始终已知的 UTC 和 GMT（并且被认为是非夏令时时区）。

`strftime()`官方不支持`%z`。

`python-dateutil`恐怕你坚持支持时区解析。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-08-10T13:07:17.767

这是我在 Python 2.7 中的回答

### 使用时区打印当前时间

```
from datetime import datetime
import tzlocal  # pip install tzlocal

print datetime.now(tzlocal.get_localzone()).strftime("%Y-%m-%d %H:%M:%S %z") 
```

### 使用特定时区打印当前时间

```
from datetime import datetime
import pytz # pip install pytz

print datetime.now(pytz.timezone('Asia/Taipei')).strftime("%Y-%m-%d %H:%M:%S %z") 
```

它会打印出类似的东西

```
2017-08-10 20:46:24 +0800 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-01-13T18:14:39.440

试试这个：

```
import pytz
import datetime

fmt = '%Y-%m-%d %H:%M:%S %Z'

d = datetime.datetime.now(pytz.timezone("America/New_York"))
d_string = d.strftime(fmt)
d2 = pytz.timezone('America/New_York').localize(d.strptime(d_string,fmt), is_dst=None)
print(d_string)
print(d2.strftime(fmt)) 
```

# actionscript-3 - 试图从本质上通过类推送细节

> ID：14762521
> 
> 赞同：0
> 
> 时间：2013-02-07T22:46:32.190
> 
> 标签：actionscript-3, apache-flex, class, push

我正在开发一个游戏，它创建了三个圆圈“红色，绿色和蓝色，分别具有 3,2,1 生命值。它们在生命值达到 0 后从舞台上移除，每次点击减少 1。我正在使用一个 Main.mxml 文件然后我有一个 Target.as 文件，以及 RedTarget.as、GreenTarget.as 和 BlueTarget.as。我的问题是我想在我的 Target.as 文件中设置所有内容，然后推送诸如颜色，健康状况以及它们是否通过这些功能已死或未通过这些功能之类的详细信息。但是，我在这样做时遇到了麻烦，因为我不确定在 Target.as 中需要什么，然后在每个中需要编写什么代码的彩色目标文件。这是我的 Target.as 文件：

```
package com.multiClicker {
//import the needed classes
import flash.display.Shape;
import flash.events.MouseEvent;

import spark.components.Image;

public class Target extends Image {

public function Target() {

    //add event listeners
    this.addEventListener(MouseEvent.CLICK, onClick);

}

//sets the hp of the target
public function hp():Number { 
    return hp;
}

//get function that returns false if alpha is <= 0
public function dead():Boolean {

    if(alpha <= 0){
        return false;
    }

    return true;
}

//subtracts one from targets HP when clicked
public function onClick(e:MouseEvent = null):void {

    //subtracts one from hp each click
    hp --;

    if(hp <=0) {
        this.addEventListener(onEnterFrame);
    }

}

//subtracts .1 from the classes alpha
public function onEnterFrame():void{
    this.alpha =- .1;

}

//draws the target
public function drawTarget(color):void {

    var circle:Shape = new Shape();

    circle.graphics.beginFill(color);
    circle.graphics.drawCircle(0,0,30);

}

}
} 
```

然后是我的 RedTarget.as 文件，它与蓝色和绿色相同，只是它们在变量中被标记为：

```
package com.multiClicker {
import flash.events.MouseEvent;
public class RedTarget extends Target{

private var redHP:Number = 3;
private var redDead:Boolean = false;
private var redColor:String = "red";

public function RedTarget()
{

    redHP = hp;
    redDead = dead;
    redColor = color;

    //include the super function
    super();
}

//subtracts one from targets HP when clicked
override public function onClick(e:MouseEvent=null):void {

    super.onClick(e);

    //push all to super
}

}
} 
```

在这个问题上的任何帮助都会很棒。我一整天都在试图弄清楚，但还没有弄清楚。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T23:02:16.100

您只是在问如何在创建 Target 对象时传递变量吗？

```
public class Target extends Image {

    public function Target(hp:Number, dead:Boolean, color:String) {

        this.hp = hp;
        this.dead = dead;
        this.color = color;

    }

} 
```

然后像这样实例化每个目标：

```
var redTarget:Target = new Target(3, false, "red");
var greenTarget:Target = new Target(2, false, "green"); 
```

ETC...

# oracle - Oracle DDL 导出

> ID：14762526
> 
> 赞同：4
> 
> 时间：2013-02-07T22:46:40.070
> 
> 标签：oracle, hsqldb, ddl

我正在尝试在 HSQL 数据库中重新创建一个 oracle 数据库。这是为了在本地开发人员系统上进行更好的单元测试。

我需要知道的是我可以在 oracle 服务器/客户端中使用什么工具/命令，它可以为我提供 oracle 数据库中所有对象（表、同义词、视图等）的所有 DDL 命令。

我计划通过创建的 DDL 命令并尝试将这些命令转换为 HSQL 兼容的命令。

可能吗？

任何建议都将受到欢迎。

系统信息：

```
Oracle DB: Oracle enterprise server 11g R2\. 
HSQL DB: hsql 2.2.9 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T23:07:28.307

您可以使用该[`DBMS_METADATA`包](http://docs.oracle.com/cd/B19306_01/appdev.102/b14258/d_metada.htm)和数据字典来为您的对象生成 DDL。例如，为模式中的每个表生成 DDL

```
declare
  l_ddl clob;
begin
  for t in (select * from user_tables)
  loop
    l_ddl := dbms_metadata.get_ddl( 'TABLE', t.table_name, USER );
    <<do something with l_ddl>>
  end loop;
end; 
```

您确定使用与您真正要部署的数据库完全不同的数据库进行测试有意义吗？即使您将 DDL 转换为最接近的模拟，根据您连接的数据库，您似乎很可能会在某些测试中获得不同的结果。您确定不能在开发人员的机器上安装 Oracle（如果您主要关注许可，则可能是 Oracle XE）？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T23:17:52.863

有很多产品可以提供帮助。

开源： [http ://www.liquibase.org/manual/formatted_sql_changelogs](http://www.liquibase.org/manual/formatted_sql_changelogs)

商业免费试用： http: [//www.devart.com/dbforge/oracle/schemacompare/new-export-oracle-schema.html](http://www.devart.com/dbforge/oracle/schemacompare/new-export-oracle-schema.html)

如果您使用通常仅设计用于 Oracle 数据库的工具，您可能会得到相当多需要转换的非标准 Oracle DDL。跨平台工具更有可能减少工作量。

在 ORA 兼容模式下使用 HSQLDB 时，它可以将 DDL 中的一些 Oracle 类型转换为类似的 SQL 标准类型。所以这些类型可能不会造成问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-15T06:16:57.683

一个开源非活动项目做完全相同的事情。

[http://schemamule.sourceforge.net/index.html](http://schemamule.sourceforge.net/index.html)

# image-uploading - Plupload 创建多种尺寸的缩略图

> ID：14762529
> 
> 赞同：5
> 
> 时间：2013-02-07T22:46:55.297
> 
> 标签：image-uploading, plupload

我在客户端创建和上传缩略图图像时发现了这个线程。踏板显示如何上传第一张图片，然后通过调整大小并再次上传来跟进。我想知道是否有一种简单的方法可以添加另一个步骤，以便最终结果会产生原始、中等大小和缩略图

```
A better solution is to trigger QueueChanged in the FileUploaded handler, and then call refresh. This will initiate the upload again for the same file and you can set a property that you read in the BeforeUpload handler to adjust the file size. 
```

警告＃1：您应该在全尺寸图像之后上传缩略图，否则全尺寸图像可能会出现一些缓冲区问题并被截断。

警告 #2：这仅在对 FileUploaded 的绑定调用发生在 uploader.init() 之后才有效，否则上传者自己的 FileUploaded 处理程序将在您的处理程序之后将 file.status 覆盖回 DONE。

下面是这个帖子的原始回复[Plupload Thumbnail](https://stackoverflow.com/questions/11507173/plupload-thumbnail)

```
uploader.bind('BeforeUpload', function(up, file) {
    if('thumb' in file)
      up.settings.resize = {width : 150, height : 150, quality : 100};
    else
      up.settings.resize = {width : 1600, height : 1600, quality : 100};
}

uploader.bind('FileUploaded', function(up, file) {
    if(!('thumb' in file)) {
        file.thumb = true;
        file.loaded = 0;
        file.percent = 0;
        file.status = plupload.QUEUED;
        up.trigger("QueueChanged");
        up.refresh();
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-04T16:14:02.140

很简单，我在我的项目中就是这样做的，做了两个小调整。

在upload.php中，我动态地制作了目录信息：

```
$diretorio = $_REQUEST["diretorio"];
$targetDir = 'upload/'.$diretorio; 
```

并更改了上传界面中的代码：

```
uploader.bind('BeforeUpload', function(up, file) {
    if('thumb' in file){

        //thumb
        up.settings.url = 'upload/upload.php?diretorio=thumbs',
        up.settings.resize = {width : 100, height : 75, quality : 60};

        // medium size
        up.settings.url = 'upload/upload.php?diretorio=medium',
        up.settings.resize = {width : 200, height : 150, quality : 60}; 

    }else{
        up.settings.url = 'upload/upload.php?diretorio=full-size',
        up.settings.resize = {quality : 100};
    }    
        uploader.bind('FileUploaded', function(up, file) {
            if(!('thumb' in file)) {
                file.thumb = true;
                file.loaded = 0;
                file.percent = 0;
                file.status = plupload.QUEUED;
                up.trigger("QueueChanged");
                up.refresh();
            }
    });            
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-10T04:31:41.830

[Eduardo de Souza](https://stackoverflow.com/users/1539529/eduardo-de-souza)给出的答案对我非常有用，但是这里的代码有一些变化不能上传媒体文件，另一个是图像不能作为 resize 参数调整大小，因为我发现我的情况有一些变化是：

```
var i = 1;
uploader.bind('BeforeUpload', function (up, file) {
                if ('thumb' in file) {
                    if (i == 1) {
                        //thumb
                        up.settings.url = 'http://localhost/plupload_new/public_html/upload.php?diretorio=thumb',
                                up.settings.resize = {width: 80, height: 80, enabled: true};
                    } else {
                        // medium size
                        up.settings.url = 'http://localhost/plupload_new/public_html/upload.php?diretorio=medium',
                                up.settings.resize = {width: 800, height: 600, enabled: true};
                    }
                } else {
                    up.settings.url = 'http://localhost/plupload_new/public_html/upload.php?diretorio=full';
                }
                uploader.bind('FileUploaded', function (up, file) {
                    if (!('thumb' in file)) {
                        file.thumb = true;
                        file.loaded = 0;
                        file.percent = 0;
                        file.status = plupload.QUEUED;
                        up.trigger("QueueChanged");
                        up.refresh();
                    } else {
                        if (i < 2) {
                            i++;
                            file.medium = true;
                            file.loaded = 0;
                            file.percent = 0;
                            file.status = plupload.QUEUED;
                            up.trigger("QueueChanged");
                            up.refresh();
                        }
                    }
                });
            }); 
```

`enabled:true`在 resize 参数中添加了一个属性，它可以调整图像大小，并使用`i`变量进行一些检查，以便在中等 url 上获得通知，我认为这可能很有用。

# python - 在同一模块文件中定义的导入类？

> ID：14762531
> 
> 赞同：3
> 
> 时间：2013-02-07T22:47:03.447
> 
> 标签：python

我有一个名为 的模块文件`mymodule.py`，其中包含以下代码：

```
class foo:
    def __init__(self):
        self.foo = 1

class bar:
    import foo
    def __init__(self):
        self.bar = foo().foo 
```

同一目录下的`__init__.py`文件有

```
from mymodule import foo 
```

从同一目录中的脚本，我有以下代码：

```
from mymodule import bar 
```

当我尝试运行时`bar()`，我收到错误消息`No module named foo`。当它们在同一个模块文件中定义时，如何创建`foo`in的实例？`bar`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-07T22:49:08.117

首先使用模块名称导入类。但是，您不需要从 mymodule 中导入 mymodule 中的类，只需使用它即可。含义：删除 import foo 行

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-07T22:52:49.027

您不需要导入在同一模块中定义的对象：

```
class foo:
    def __init__(self):
        self.foo = 1

class bar:
    def __init__(self):
        self.bar = foo().foo 
```

该`import`语句仅适用于*其他*文件中定义的对象；您将另一个 python 文件中定义的名称导入当前模块。

# c - 编写就地浮点类型提升循环的正确方法？

> ID：14762533
> 
> 赞同：1
> 
> 时间：2013-02-07T22:47:05.717
> 
> 标签：c, c99, strict-aliasing

我有一个例程，它使用适当大小的数组来处理额外的字节，将*单*精度数据数组提升为双精度：

```
void dpromote(const int n, double *x)             
{
    for (int i = n; i --> 0 ;) {    
        x[i] = ((float *)x)[i];
    }
} 
```

进入`x`时应包含`n` `float`s，退出时应包含`n` `double`s：

```
void test_dpromote()
{
    double  e[]   = {1, 2, 3, 4, 5, 6, 7};
    float   x[]   = {1, 2, 3, 4, 5, 6, 7, 0, 0, 0, 0, 0, 0, 0};
    const int n = sizeof(e)/sizeof(e[0]);
    dpromote(n, (void *) x);
    /* memcmp(x, e, sizeof(e)) will return 0 when this works as expected */
} 
```

我为什么要这样做？数字密集型代码中的混合精度迭代细化。出于这个问题的目的，您可以忽略原因，因为它确实无关紧要。

多个编译器可以`dpromote`在启用严格别名的各种积极优化级别上处理逻辑。最近，一位编译器供应商（将保持匿名）决定重新索引我的循环，以便它是通过内存的前向遍历而不是向后遍历。如果你盯着代码半分钟，你会发现循环转换产生了完全的垃圾。

`dpromote`启用所有 C99 严格混叠花哨的逻辑是否依赖于未定义的行为？我不明白为什么编译器会认为可以更改循环索引，除非代码正在做未定义的事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T06:57:32.943

是的，您违反了严格的别名规则。使用联合 - 它可能不会保持您的原始布局，但它可以更好地反映您的意图并且通常更清洁：

```
#include <stdio.h>

union value 
{
    double d;
    float f;
};

void dpromote (const int n, value* x)
{
    for (int i=0; i < n; ++i)
        x[i].d = x[i].f;
}

void test_dpromote()
{
    value x[] = {{.f=1}, {.f=2}, {.f=3}, {.f=4}, {.f=5}, {.f=6}, {.f=7}};
    const int n = sizeof(x) / sizeof(x[0]);

    for (int i=0; i < n; ++i)
        printf("float: %f\n", x[i].f);

    dpromote(n, x);

    for (int i=0; i < n; ++i)
        printf("double: %f\n", x[i].d);
}

int main ()
{
    test_dpromote();
    return 0;
} 
```

如果您必须保持原始布局，则需要手动管理内存块以满足严格的别名规则：

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

double* dpromote (const int n, char* x)
{
    for (int i=n; i-- > 0; )
    {
        float f;
        memcpy(&f, &x[i*sizeof(float)], sizeof(f));
        double d = f;
        memcpy(&x[i*sizeof(double)], &d, sizeof(d));
    }

    return (double*)x;
}

void test_dpromote()
{
    int const n = 7;
    char* block = (char*)malloc(n*sizeof(double));
    for (int i=0; i < n; ++i)
    {
        float const x = i+1;
        memcpy(&block[i*sizeof(float)], &x, sizeof(x));
    }

    // It is now safe to access block through x

    float* x = (float*)block;
    for (int i=0; i < n; ++i)
        printf("float: %f\n", x[i]);

    double* y = dpromote(n, block);
    for (int i=0; i < n; ++i)
        printf("double: %f\n", y[i]);

    // It is now safe to access block through y, however
    // subsequent access through x will violate strict aliasing rules
}

int main ()
{
    test_dpromote();
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-10-05T20:56:51.277

该标准要求编译器在一些不太可能有用的地方做出悲观的别名假设，但被解释为邀请编译器忽略其他类型别名的证据。我认为如果读取为 float 的每个元素之前都被写为 float，并且在任何将其写为“double”的操作*之前*排序，那么您的代码将定义行为。但是，我认为您的代码在最后一次迭代中调用了 UB，因为分配读取和写入重叠的对象。

如果你的代码写成：

```
void dpromote(const int n, double *x)             
{
    float *fp = x;
    for (int i = n; i --> 0 ;) {    
        double d = fp[i];
        x[i] = d;
    }
} 
```

我不会特别谴责没有注意到混叠的编译器，因为*循环内*没有证据表明可能会发生混叠。我不热衷于编译器重新安排循环的行为，尽管考虑到重叠的读写，我不会指责由于其他原因而出现故障的编译器[例如，如果针对没有 FPU 的 CPU 的编译器做了类似 clear some “双”的位，然后用原始指数和尾数的位移版本覆盖它的部分]。但是，如果将分配拆分为单独的读取和写入并不能修复编译器的行为，那么我会认为它是狡猾的，因为这种行为既不符合标准也不符合常识。

# php - 在 .htaccess 中重写 Url（URL 路由）

> ID：14762536
> 
> 赞同：0
> 
> 时间：2013-02-07T22:47:19.690
> 
> 标签：php, .htaccess, url-rewriting, directory, url-routing

我的目录如下：

```
http://www.mydomain.com/macbook-computer 
http://www.mydomain.com/sony-computer
http://www.mydomain.com/lenovo-computer 
```

**如果用户键入以下计算机/macbook-computer**，我想这样做：

```
http://www.mydomain.com/computers/macbook-computer 
```

我想显示页面是 : `http://www.mydomain.com/macbook-computer`。

我的限制是：

```
1\. User must type /computers                                (segment 1)
2\. String coming from computers/ must end with "computer".  (segment 2) 
```

如何在我的 .htaccess 文件中实现这一目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T00:01:28.653

你可以试试这个：

```
Options +FollowSymlinks
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_URI} ^/computers/([^-]+)-computer/? [NC]
RewriteRule .*  %1-computer?  [R=301,L] 
```

永久重定向

`http://www.mydomain.com/computers/anyname-computer` 带或不带斜杠。

至：

`http://www.mydomain.com/anyname-computer`

字符串`computers`和`computer`假定是固定的，而`anything`假定是可变的。

必须保留传入的 URL 结构以使规则集起作用：第一个文件夹`/computers`，后跟`/anyname-computer`.

对于静默映射，`R=301`从`[R=301,L]`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T23:05:34.073

您需要在 .htaccess 文件中设置重写规则，以及一点正则表达式的魔力。像这样的东西应该可以解决问题

```
RewriteRule ^computers/macbook-computer$ http://www.mydomain.com/macbook-computer 
```

这是一个很好的在线工具，用于检查重写规则

[http://htaccess.madewithlove.be/](http://htaccess.madewithlove.be/)

# ruby - ruby on rails：如何将数据库的更改引入模型

> ID：14762538
> 
> 赞同：0
> 
> 时间：2013-02-07T22:47:29.473
> 
> 标签：ruby, ruby-on-rails-3

我在 db/migrate 下更新了迁移脚本，我做了一个

```
rake db:migrate 
```

更新前的数据库脚本

```
class CreateStudents < ActiveRecord::Migration
  def change
    create_table :students do |t|
      t.string :firstname
      t.string :lastname      
      t.string :account
      t.timestamps
    end
  end
end 
```

更新后的数据库脚本

```
class CreateStudents < ActiveRecord::Migration
  def change
    create_table :students do |t|
      t.string :firstname
      t.string :lastname      
      t.string :account
      t.string :address      
      t.string :city
      t.string :state
      t.string :postcode                        
      t.string :homephone
      t.timestamps
    end
  end
end 
```

在我删除了 schame.rb 中的旧 development.sqlite3 和旧模式之后。
假设我添加了几列，但在模型中这些列缺失。

但我的模型仍然是

```
class Student < ActiveRecord::Base
  attr_accessible :firstname,:lastname,:account,
end 
```

有没有一种简单的方法可以将新迁移脚本中的更改带到模型中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T01:30:49.830

如果要允许对其他属性进行批量分配，只需将键添加到 attr_accessible

```
class Student < ActiveRecord::Base
  attr_accessible :firstname,:lastname,:account,:address, :city, :state, :postcode, :homephone
end 
```

但是，您的模型仍然具有这些属性（或您所称的列）。如果不先使它们 attr_accessible，您就无法进行批量分配（例如 create 或 update_attributes）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T01:31:27.640

看起来也许你做了`rails generate migration`这并不意味着影响你的模型。我相信在您创建模型之后，之后的一切都必须手动完成。

如果你真的想同时改变你的数据库和模型，你最好的选择可能是删除你的迁移和模型并做一个`rails generate scaffold`（[文档](http://guides.rubyonrails.org/getting_started.html)）从头开始创建你的整个脚手架。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T01:30:37.753

在模型中手动添加新列没有问题。

# sql - 是否可以使用来自不同服务器的提供程序？

> ID：14762540
> 
> 赞同：0
> 
> 时间：2013-02-07T22:47:34.530
> 
> 标签：sql, sql-server, tsql, sql-server-2005, sql-server-2012

我可能已经弄清楚为什么我不能使用 ODBC/OLEDB 在 sql server 2012 上建立一个链接服务器到一个普遍的 sql 中。

我有另一个**能够**连接到普遍 sql 的 sql server 2005，因为它有一个名为 PervasiveOLEDB.11.0 的提供程序。

我想使用相同的提供程序，我想知道是否可以让我的 sql server 2012 使用这个提供程序（它位于不同的服务器上）？\

如果没有，我是否可以通过其他方式导出/导入此提供程序？

我正在尝试以这种方式建立连接，但无法与提供者进行连接：

```
EXEC sp_addlinkedserver 
   @server = 'kslap208', 
   @provider = 'MSDASQL', 
   @datasrc = 'C003',
   @srvproduct = 'Pervasive'
GO 
```

**更新**：虽然我能够成功连接，但当我尝试从表中选择时出现此错误：

```
OLE DB provider "MSDASQL" for linked server "kslap208" returned message "Unspecified error".
OLE DB provider "MSDASQL" for linked server "kslap208" returned message "[Pervasive][ODBC Client Interface][LNA][Pervasive][ODBC Engine Interface][Data Record Manager]Cannot locate the named database you specified(Btrieve Error 2301)".
Msg 7311, Level 16, State 2, Line 1
Cannot obtain the schema rowset "DBSCHEMA_TABLES" for OLE DB provider "MSDASQL" for linked server "kslap208". The provider supports the interface, but returns a failure code when it is used. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T23:16:33.453

我认为您需要从[此处](http://www.pervasivedb.com/psqlv11/pages/default.aspx)下载 Pervasive SQL 11 客户端。这应该安装所有驱动程序

# php - PHP/SOAP/XML 文档中根元素之前的标记必须格式正确

> ID：14762544
> 
> 赞同：1
> 
> 时间：2013-02-07T22:47:55.603
> 
> 标签：php, xml, soap

我正在尝试与支付网关（FirstData）进行交互。到目前为止，我已经创建了 cURL 请求，并终于让它工作了。现在我可以生成包含在 SOAP 中的 XML。我收到一条错误消息：

输入 SOAP 请求格式不正确。异常是 org.xml.sax.SAXParseException：根元素之前的文档中的标记必须格式正确。

这是我正在喂它的xml：

```
$this->xml = "<?xml version=\"1.0\"?>";
$this->xml = "<SOAP-ENV:Envelope xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\">";
$this->xml = "<SOAP-ENV:Header />";
$this->xml = "<SOAP-ENV:Body>";
$this->xml = "<fdggwsapi:FDGGWSApiOrderRequest xmlns:fdggwsapi=\“http://secure.linkpt.net/fdggwsapi/schemas_us/fdggwsapi\">";
$this->xml = "<v1:Transaction xmlns:v1=\"http://secure.linkpt.net/fdggwsapi/schemas_us/v1\">";
$this->xml = "<v1:CreditCardTxType>";
$this->xml = "<v1:Type>sale</v1:Type>";
$this->xml = "</v1:CreditCardTxType>";
$this->xml = "<v1:CreditCardData>";
$this->xml = "<v1:CardNumber>4012000033330026</v1:CardNumber>";
$this->xml = "<v1:ExpMonth>12</v1:ExpMonth>";
$this->xml = "<v1:ExpYear>12</v1:ExpYear>";
$this->xml = "</v1:CreditCardData>";
$this->xml = "<v1:Payment>";
$this->xml = "<v1:ChargeTotal>12</v1:ChargeTotal>";
$this->xml = "</v1:Payment>";
$this->xml = "</v1:Transaction>";
$this->xml = "</fdggwsapi:FDGGWSApiOrderRequest>";
$this->xml = "</SOAP-ENV:Body>";
$this->xml = "</SOAP-ENV:Envelope>";

return $this->xml; 
```

我找不到太多关于这个的东西，并且已经尝试了一切。以下是我通过 cURL 请求发送的标头：

```
$headers = array(
        "Content-type: text/xml;charset=\"utf-8\"", 
        "Accept: text/xml", 
        "Cache-Control: no-cache", 
        "Pragma: no-cache", 
        "SOAPAction: \"run\"", 
        "Content-length: ".strlen($this->genXML()),
        ); 
```

*genXML() 包含上面列出的 XML 的 XML 消息

任何信息表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T23:36:40.613

你的意思是`$this->xml .= "..."`？否则它只是每次都覆盖字符串，对吗？

# objective-c - 解析未知结构的 JSON Objective-C

> ID：14762545
> 
> 赞同：1
> 
> 时间：2013-02-07T22:47:59.363
> 
> 标签：objective-c, json, nsarray

我正在尝试解析这个 json 并且不确定是否解析它，因为“vis-progress-control”之类的键可能会改变，我正在尝试构建一个解析这种类型的 json 的通用代码。我确信“类型”键将出现在 json 结构中。

```
NSDictionary *dict = [sData JSONValue];

NSArray *items = [dict valueForKeyPath:@"assets"];

NSLog(@"%@", items);

for (NSString *key in [[dict objectForKey:@"assets"]allKeys]) {

    for (NSString *subKey in [[[dict objectForKey:@"assets"] objectForKey:key]allKeys]) {
        NSLog(@"Value at subkey:%@ is %@\n",subKey,[[[dict objectForKey:@"assets"]objectForKey:key]objectForKey:subKey]);

         }
  } 
```

我在 Github 上使用 SBJson 库。我的实际问题是当我不知道“vjs-progress-holder”键时如何访问“方向”、“度数”等？我还有一个嵌套在小部件数组中的小部件数组。我如何获得这些值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T01:03:51.700

假设我在这里了解您的目标，您似乎想做这样的事情？

```
NSDictionary *outerDict = [sData JSONValue];
NSDictionary *assets = outerDict[@"assets"];

for (NSDictionary *asset in [assets allValues]) {

    NSString *type = asset[@"type"];

    if ([type isEqualToString:@"gradient"]) {

        float degrees = [asset[@"degrees"] floatValue];
        // and read whatever other values you need for gradients
    }

    if ([type isEqualToString:@"image"]) {

        // and read the appropriate values for images here... 

    }
} 
```

所以我在这里做一个不同的假设，那就是你想要一个渐变数组。那么这看起来基本上是这样的：

```
NSDictionary *outerDict = [sData JSONValue];
NSDictionary *assets = outerDict[@"assets"];
NSMutableArray *gradients = [NSMutableArray array];

for (NSDictionary *asset in [assets allValues]) {

  NSString *type = asset[@"type"];

  if ([type isEqualToString:@"gradient"]) {

    // Add this asset to the list of gradients:
    [gradients addObject:asset];
  }

  if ([type isEqualToString:@"image"]) {

    // do something similar for images

  }
} 
```

然后，在完成之后，如果您想读取第四个渐变的“度”字段，例如，您会在以下位置找到它`gradients[3][@"degrees"]`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T02:15:41.810

阅读有关树遍历的信息。听起来你想遍历节点的“树”，当你找到一个特定的叶子值时，你将向后遍历一个级别并知道父级是你想要的容器。

所以想法是，一旦从 JSON 中解析出来，就忘记它是 JSON，因为现在它只是数组和字典中的一棵树。通过获取字典中的所有键来遍历它`allKeys`（返回键的数组），然后遍历它们以获取关联的值（使用类似（伪代码）：

```
for ( NSString * key in allkeysarray) { 
  NSString * val = [dict objectForKey: key];
  if ( [val isEqualToString: @"gradient"] )
  {
     // now you know that this dictionary is the one you're looking for so you can maybe break out of this loop and just use the keys you know reference these values.
     break;
  }
} 
```

希望这足以让你继续前进。

# jquery - 单击时的多方向滑块

> ID：14762547
> 
> 赞同：0
> 
> 时间：2013-02-07T22:48:04.017
> 
> 标签：jquery, css, slider

我正在寻找可以执行以下操作的插件或脚本：

单击按钮时，图像将从 div 的外部（右侧）滑入。

下次单击它时，另一个图像将从 div 的顶部滑入。

这将重复，直到不再显示任何图像。

我到处搜索，找不到这样的东西，到目前为止还没有什么可使用的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-12T00:15:06.100

刚刚偶然发现这篇文章，并创建了一支快速笔来说明我*所设想*的你所描述的内容......也许迟到了一天，并且少了一美元（刚刚注意到原始帖子的日期），但它仍然存在； [http://cdpn.io/FAkuE](http://cdpn.io/FAkuE)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-07T22:50:54.203

Carousel 是您正在寻找的，您可能需要调整动画以使其从顶部滑动。试试[http://www.tripwiremagazine.com/2012/12/jquery-carousel.html](http://www.tripwiremagazine.com/2012/12/jquery-carousel.html)

# c++ - C ++删除二叉树中的最小元素

> ID：14762554
> 
> 赞同：0
> 
> 时间：2013-02-07T22:48:37.030
> 
> 标签：c++, pointers, binary-tree

我有以下用于删除 min 元素的功能：

```
int BinaryTree::delete_min_helper(TreeNode *node){

   while(node->left != NULL){
     node = node->left;
   }

   if(node == root){
     return 1;
   }

   delete node;
   node = NULL;
   return 0;
} 
```

我总是将一个指向根节点的指针传递给这个函数。我已经尝试过这个和它的一些变体，但它似乎总是删除错误的东西或根本不删除任何东西。任何想法为什么？

这是一个可编译的示例：

```
#ifndef _TREE_H_
#define _TREE_H_

#include <stdlib.h>
#include <stdio.h>
#include <string.h>

struct TreeNode {
  int val;
  char *str;
  TreeNode *left;
  TreeNode *right;
};

class BinaryTree {
  public:

 BinaryTree();
 ~BinaryTree();

 int insert_node(unsigned int val, char *str);
 TreeNode *find_min();
 int delete_min();
 void print();

 private:

 int insert_node_helper(TreeNode *&node, unsigned int val, char *str);
 int delete_min_helper(TreeNode *node);
 void print_helper(TreeNode *node);

 TreeNode *root;  
};

#endif

BinaryTree::BinaryTree(){
  this->root = NULL;
}

BinaryTree::~BinaryTree(){
}

int BinaryTree::insert_node(unsigned int val, char *str){
  return insert_node_helper(this->root, val, str);
}

int BinaryTree::insert_node_helper(TreeNode *&node, unsigned int val, char *str){

  if(node == NULL){
    node = new TreeNode;
    node->val = val;
    node->str = strdup(str);
    node->left = NULL;
    node->right = NULL;
    if(node != NULL){
      return 0;
    }else{
      puts("inserted null node");
      return 1;
   }
 }else if(val <= node->val){
   return insert_node_helper(node->left, val, str);
 }else if(val > node->val){
   return insert_node_helper(node->right, val, str);
 }

 return 1;
}

void BinaryTree::print(){
  print_helper(this->root);
}

void BinaryTree::print_helper(TreeNode *node){

    if(node != NULL){
      print_helper(node->right);
      printf("%d occurrences of \"%s\"\n", node->val, node->str);
      print_helper(node->left);
    }

}

TreeNode *BinaryTree::find_min(){
  TreeNode *temp = this->root;
  while(temp->left != NULL){
    temp = temp->left;
  }
  return temp;
}

int BinaryTree::delete_min(){
   return delete_min_helper(root);
}

int BinaryTree::delete_min_helper(TreeNode *node){

   while(node->left != NULL){
     node = node->left;
   }

  if(node == root){
    puts("attempted to delete root");
    return 1;
  }

  delete node;
  node = NULL;
  return 0;
}

#include <time.h>

int main(){

  BinaryTree bt;

  srand(time(NULL));
  for(int i = 0; i < 10; i++){
     bt.insert_node(rand() % 20, "test");
  }

  bt.print();
  printf("min val = %d\n", bt.find_min()->val);
  puts("#################################");
  bt.delete_min();
  bt.print();
  printf("min val = %d\n", bt.find_min()->val);

  return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T22:53:09.283

您将对指针的引用作为参数 ( `TreeNode *&node`)，然后对其进行修改。因此，如果您将树的根传递给此方法，您最终会将根设置为`NULL`.

此外，这实际上绝对不会删除任何内容，因为您在将指针设置为 NULL 后调用 delete，而`delete`在空指针上调用什么也不做。

*原帖编辑后更新：*

我假设`root`是 BinaryTree 的成员。如果您发布了一个[简短的、自包含的、可编译的示例，](http://sscce.org/)会更容易为您提供帮助。

你仍然把根作为参考。因此`node == root`将永远是正确的，你永远不会达到你的`delete`陈述。所以实际上你没有删除任何东西，但你正在将你的根更改为最左边的子节点。

尝试将您的方法签名更改为

```
int BinaryTree::delete_min_helper(TreeNode *node){ 
```

也就是说，没有与号 ( `&`)。

*编辑后：*

好的，现在我已经运行了你的程序，发现了你的第二个问题。在行

```
node = NULL; 
```

您正在更改本地指针的值，而不是`left`父节点中的 -pointer 的值。这意味着下次遍历树时，您将访问指向刚刚删除的内存的指针。这会触发未定义的行为。为了解决这个问题，您应该`left`在删除叶节点时将父节点的指针设置为 0。

# php - 使用 PHP 从 MYSQL 数据库中格式化 DATETIME

> ID：14762556
> 
> 赞同：1
> 
> 时间：2013-02-07T22:48:39.820
> 
> 标签：php, mysql, sql

所以我的数据库中有一个名为“DateTime”的字段和以下代码行：

```
echo "Date/Time: ";
echo $row['DateTime']; 
```

我如何格式化它，而不是像这样：'2013-02-07 22:14:56'，它将是这样的：'07/02/13 - 22:14'

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-24T10:33:00.610

$timestamp 包含任何格式的日期和时间.....................

date('Y/m/d - H:i',strtotime($timeStamp));

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-24T10:15:17.883

如何将日期输出到年文本框月文本框日文本框

```
$book_date = $myrow["Publication_Day"];
$book_year = Date("Y", strtotime($book_date)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T23:18:03.323

另一种选择是让 MySQL 使用 DATE_FORMAT 函数将 DATETIME 值格式化为所需格式的字符串。

```
SELECT DATE_FORMAT(`DateTime`,'%d/%m/%y - %H:%i') AS `DateTime`
   ... 
```

除了发送到数据库服务器的 SQL 文本外，您的 PHP 代码不需要任何更改。

如果您对这个字符串所做的只是显示它，这种方法可以非常有效，并减少您需要的代码量。如果您正在对该值进行任何类型的操作，那么将从 MySQL 结果集返回的字符串值转换为 datetime 对象可能是一种更好的方法。

* * *

DATE_FORMAT 函数的演示：

```
SELECT DATE_FORMAT('2013-02-07 22:14:56','%d/%m/%y - %H:%i') AS `DateTime`

DateTime
----------------
07/02/13 - 22:14 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-07T22:55:27.757

或者，您可以使用： DateTime::createFromFormat('Y/m/d H:i:s',$row['DateTime']); 这将为您提供一个日期时间对象，使用起来非常好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-07T22:54:02.907

```
$mytime = strtotime('2013-06-07 22:14:56');
$newDate = date('m/d/y - G:i', $mytime);
echo $newDate; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-07T22:51:07.547

```
echo date('d/m/y H:i', strtotime($row['DateTime'])); 
```

有关文档中函数的更多详细信息，请参阅[date](http://php.net/manual/en/function.date.php)和[strtotime](http://php.net/manual/en/function.strtotime.php)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-08T04:45:53.320

[这是使用DateTime](http://php.net/manual/en/class.datetime.php)的替代方法。如果您使用时区，则可以轻松修改此代码以处理该问题。

```
$datetime = new DateTime('2013-02-07 22:14:56');
echo $datetime->format('d/m/y H:i'); 
```

[看到它在行动](http://codepad.viper-7.com/EJyzhY)

# css - 复制简单图像/文本布局的 css 和/或 javascript

> ID：14762565
> 
> 赞同：0
> 
> 时间：2013-02-07T22:49:37.550
> 
> 标签：css

所以我试图复制一个页面布局，它是一个图像，它是一个页面的完整高度，其右侧有文本。文本宽度似乎根据图像进行调整，我只是不确定它是如何完成的。 [http://mcgarrybowen.com/en/People/Bill-Borrelle](http://mcgarrybowen.com/en/People/Bill-Borrelle) 就是这个页面，有什么想法是如何做到的吗？

这是我尝试过但不太正常的方法，看起来像这样 [http://www.klossal.com/klossviolins/about.html](http://www.klossal.com/klossviolins/about.html)：

```
<div style="width:100%;padding-top:40px;padding-bottom:40px;">
<div style="width:920px;position:relative;">
    <div style="float:left;">
        <img style="height:100%;" src="http://www.klossal.com/klossviolins/elements/horst.jpg" alt="">
    </div>
    <div style="float:left;">
    <p style="color: #b9b8b4;
      font-family: 'Source Sans Pro' , sans-serif;
      font-size: 24px;
      text-align: left;   
      position:relative;
      width:auto;">About</p>            

    <p style="color: #b9b8b4;
      font-family: 'Source Sans Pro' , sans-serif;
      font-size: 14px;
      text-align: left;      
      position:relative;
      width:auto;">
        Mittenwald-trained, Master Violin Maker, Horst Kloss, has worked with fine stringed instruments and bows for over three decades. The Kloss Shop specializes in the repair, restoration, appraisal and sale of historic instruments and bows. Mr. Kloss further offers acoustic adjustment tailored to the individual musician's requirements, the application of museum conservation standards to preserve instrument integrity and maintain value as well as baroque conversion. Mr. Kloss is experienced in providing musicians with custom instrument set up designed to prevent overuse syndrome while maintaining maximal adjustment of tonal color, clarity and projection.<br><br>

        Since 1972, Horst Kloss has cared for collections of note along the East Coast of the United States, including the Boston Museum of Fine Art's collection of historic stringed instruments. He is one of under a hundred makers, nation-wide, whose extensive training and high caliber skills qualified him for full membership status in the American Federation of Violin and Bow Makers.<br><br>

        Raised among musicians and makers, Horst Kloss was imbued with a love of music and a profound sense of stewardship in caretaking for stringed instruments. At the age of 14, he began an apprenticeship in his hometown of Mittenwald, a center for violin-making since the 1600's. He received his formal training at the Bavarian State School of Violin Making in Southern Germany where he earned his Journeyman's diploma in 1964 and his Master's degree in 1972 under the tutelage of Josef Kantuscher. He moved to the United States in 1964 following the exodus of finer instruments from Europe and gained exposure to many of them while working for Carl Becker at Lewis & Sons. Mr. Kloss instructs the courses offered in instrument repair and restoration at the University of New Hampshire's Violin Craftsmanship Institute. He established shops in Houston and Boston before settling in Needham, Massachusetts.<br><br>

        Horst Kloss has attracted an international clientele, including many distinguished concert performers, who value his consistently high quality restoration and sound adjustments. His experienced eye and broad client base make him especially well-suited to bring buyers and sellers of fine stringed instruments together.</p>
        </div>
        <br class="clear">

</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T22:54:45.240

该布局基于[Twitter Bootstrap](http://twitter.github.com/bootstrap/index.html)构建，并实现了其[响应](http://twitter.github.com/bootstrap/scaffolding.html#responsive)式功能。

更新：这是一个开始。你真的应该使用类而不是所有那些内联样式。它使修改布局变得非常容易。

[http://jsfiddle.net/xfPKx/2/](http://jsfiddle.net/xfPKx/2/)

```
.wrapper {
    width:100%;
}
.portrait {
    height: 100%;
    left: 0;
    position: fixed;
    width: 50%;
}
.text {
    float: right;
    margin: 5% 0;
    max-width: 30%;
    width: auto;
}

<div class="wrapper">
    <div class="portrait">
        <img src="http://www.klossal.com/klossviolins/elements/horst.jpg" alt=""
        />
    </div>
    <div class="text">
... 
```

# java - 如何确保为该线程分配了一个唯一的 id

> ID：14762566
> 
> 赞同：2
> 
> 时间：2013-02-07T22:49:38.087
> 
> 标签：java, multithreading, thread-safety, atomic

我需要插入有两列的数据库 -

```
ID      PrimaryKey String
ACCOUNT String 
```

所以这意味着每个线程应该始终使用唯一的 id，我也需要`ID`在`Account`列中存储相同的 id。所以假设如果`ID is 1`然后在数据库中它应该存储为

```
ID  Account
1   SomeString+1
2   SomeString+2
3   SomeString+3
....
..

100 SomeString+100 
```

我总是在帐户列中将该用户 ID 与该字符串连接起来。

下面是我的多线程代码，它将产生多个线程 - 每个线程每次都会获得一个新的唯一 ID，因为我正在使用`AtomicInteger`它。它会将其插入并附`ID`加到列`ID column``ID``Account`

但不知何故，在我下面的程序中，我在该数据库中看到的是 -

```
ID Account
1  String+2
2  String+1
3  String+3 
```

这是不对的。应该是这样的——

```
ID Account
1  String+1
2  String+2
3  String+3 
```

下面是代码

```
 public static void main(String[] args) {

        final int noOfThreads = 4;
        final int noOfTasks = 10;

        final AtomicInteger id = new AtomicInteger(1);

        ExecutorService service = Executors.newFixedThreadPool(noOfThreads);

        for (int i = 0; i < noOfTasks * noOfThreads; i++) {
            service.submit(new Task(id));
        }
    }

class Task implements Runnable {

    private final AtomicInteger id;
    private volatile int userId;

    public Task(AtomicInteger id) {
        this.id = id;
    }

    @Override
    public void run() {

        dbConnection = getDBConnection();

        preparedStatement = dbConnection.prepareStatement(Constants.INSERT_ORACLE_SQL);

        userId = id.getAndIncrement();

        preparedStatement.setString(1, String.valueOf(userId));
        preparedStatement.setString(2, Constants.getaAccount(userId));

        preparedStatement.executeUpdate();
    }  
} 
```

下面是我`Constants class`的不可变的。

```
public final class Constants {

    public static String A_ACCOUNT;

    public final static String INSERT_ORACLE_SQL = "INSERT INTO XMP_TEST"
        + "("
        + "ID, A_ACCOUNT) VALUES"
        + "(?, ?)";

    public static String getaAccount(int userId) {      
        A_ACCOUNT = "{\"lv\":[{\"v\":{\"userId\":"+userId+"},\"cn\":1}]}";

        return A_ACCOUNT;
    }

} 
```

谁能告诉我我在这里做错了什么？我相信这是因为线程安全问题而发生的。多个线程修改了`userID`我猜的整数，这就是为什么它被错误地写入数据库的原因。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-07T23:00:12.430

我看到的主要问题不是`Task.userId`，而是`Constants.A_ACCOUNT`：如果两个单独的线程`getaAccount`同时调用，那么它们都会设置`Constants.A_ACCOUNT`并读取它，因此它们最终可能都具有相同的值，或者每个都有另一个的值价值，或诸如此类。要解决此问题，您可以使用局部变量而不是静态字段：

```
 public static String getaAccount(int userId) {      
        final String ret = "{\"lv\":[{\"v\":{\"userId\":"+userId+"},\"cn\":1}]}";

        return ret;
    } 
```

或者只是省去变量：

```
 public static String getaAccount(int userId) {      
        return "{\"lv\":[{\"v\":{\"userId\":"+userId+"},\"cn\":1}]}";
    } 
```

（你说你已经做到了`Constants`不可变，但这不是真的。*实例*将`Constants`是不可变的，因为它们根本没有字段；但`Constants`它本身有一个可公开修改的字段，所以它*非常*可变！）

更一般地说，您不应该将字段用于仅在特定方法中需要的临时值，并且仅在对其进行一次调用期间。即使不是同步问题，也是维护问题。例如，`Task`不需要`volatile int userId`; `userId`应该只是其`run`方法中的局部变量。

另外，我建议将您包装`AtomicInteger`在它自己的类中，`IncrementingCounter`或者其他只提供一种方法的东西中，称为 (say) `getNewId`。然后`getNewId`将是唯一必须处理线程之间协调的类。所有其他类都可以通过常规技术（不变性，仅存在于单个线程中等）成为线程安全的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T23:00:45.190

您正在读取和修改静态变量，而无需从多个线程进行任何同步：`A_ACCOUNT`. 只需将其设为局部变量`getaacount()`，一切都应按预期工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-08T00:03:23.500

考虑到数字的数字也是字符串，这个问题在很多年前就已经解决了：

*   向父表添加自动增量列
*   现在插入父记录会给你一个唯一的数字
*   你没有说你正在使用哪个数据库，但是每个数据库都有一种方法来检索刚刚插入的自动增量的值，所以检索它并将其用作你的唯一值。

如果您的键无法更改数据类型，请将自动增量值复制到您的字符串列中。它是数字无关紧要 - 它仍然是唯一的。

# css - 苏西在底部得到页脚

> ID：14762569
> 
> 赞同：0
> 
> 时间：2013-02-07T22:50:22.713
> 
> 标签：css, footer, sticky, susy-compass

使用 Susy Grids，如何强制容器最小高度为 100%，页脚位于页面底部。

html

```
<div class="page">
  <header id="header-container">header</header>
  <section ="main-container">
    some short content
  </section>
  <footer id="footer-container">footer</footer>
</div> 
```

css/scss

```
$total-columns  : 16; 
$column-width   : 4.5%;
$gutter-width   : 1%;
$grid-padding   : 6.5%;
$legacy-support-for-ie6 : false;

.page { @include container;}
#main-container{@include span-columns($total-columns omega);}
#footer-container{
    @include clearfix;
    @include reset-columns; 
    min-height:100px;} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T21:16:21.203

这可能是[Compass Sticky Footer mixin](http://compass-style.org/reference/compass/layout/sticky_footer/)的工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T23:23:15.003

我可能错了——但 susy 通常处理基于宽度或水平的定位问题（xy 定位的 Y）——高度和垂直定位不是 susy 担心的问题。

同样，我可能是错的——但我认为你正在寻找错误的工具——另外，你总是可以只写*普通*的 css 来实现你想要做的事情。

像这样的工具很棒，但是记住最后你真的只是得到 CSS 是一件好事 - 所以如果你不确定如何使用 CSS 来完成某事，也许你不应该使用工具来为您编写该 CSS。我总是确保我使用的工具产生了我想要的 CSS，如果不是 - 我不使用那个工具。

# excel - 使用VBA代码在excel中从具有不同日期的网页导入数据

> ID：14762570
> 
> 赞同：0
> 
> 时间：2013-02-07T22:50:24.513
> 
> 标签：excel, vba, date, webpage

我不知道如何从网站导入数据，从 2012 年 7 月 1 日到现在我都需要这样做。有什么想法吗？由于网址更改，我不知道该怎么做。我想导入自 2012 年 7 月至今的所有数据，我可以通过网页的 html 源来导入吗？

```
Sub websitee()

With ActiveSheet.QueryTables.Add(Connection:= _
    "URL;http://www.epexspot.com/en/market-data/intraday", Destination:=Range( _
    "$A$1"))
    .Name = "intraday"
    .FieldNames = True
    .RowNumbers = False
    .FillAdjacentFormulas = False
    .PreserveFormatting = True
    .RefreshOnFileOpen = False
    .BackgroundQuery = True
    .RefreshStyle = xlInsertDeleteCells
    .SavePassword = False
    .SaveData = True
    .AdjustColumnWidth = True
    .RefreshPeriod = 0
    .WebSelectionType = xlTables
    .WebFormatting = xlWebFormattingNone
    .WebPreFormattedTextToColumns = True
    .WebConsecutiveDelimitersAsOne = True
    .WebSingleBlockTextImport = False
    .WebDisableDateRecognition = False
    .WebDisableRedirections = False
    .Refresh BackgroundQuery:=False
     Union(Columns(3), Columns(4), Columns(5), Columns(7), Columns(8),           Columns(9)).Delete

     End With

End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T02:57:14.807

下一次迭代：您现在可以调用 DownloadPeriod，它*应该*将数据放到 2012 年 1 月每天的第一工作表中。请测试，我们可以继续下一次代码迭代。

```
Sub DownloadDayFromUser()
     Dim sInput as String
     sInput = InputBox("Enter a date in YYYY-MM-DD format")
     Call websitee(sInput)
End Sub

Sub DownloadPeriod()
     Dim DownloadDay as Date
     DownloadDay = #1/1/2012#

     Do While DownloadDay < #1/2/2012#
         ' Create a new workbook to put the data into
         ActiveWorkBook.Worksheets.Add
         ' Call the web service for today
         Call websitee(Format(DownloadDay,"YYYY-MM-DD"))
         ' Increment the day
         DownloadDay = DownloadDay + 1
     Loop
End Sub

Sub websitee(sDate as String)

With ActiveSheet.QueryTables.Add(Connection:= _
"URL;http://www.epexspot.com/en/market-data/intraday/" & sDate & "/", Destination:=Range( _
"$A$1"))
.Name = "intraday"
.FieldNames = True
.RowNumbers = False
.FillAdjacentFormulas = False
.PreserveFormatting = True
.RefreshOnFileOpen = False
.BackgroundQuery = True
.RefreshStyle = xlInsertDeleteCells
.SavePassword = False
.SaveData = True
.AdjustColumnWidth = True
.RefreshPeriod = 0
.WebSelectionType = xlTables
.WebFormatting = xlWebFormattingNone
.WebPreFormattedTextToColumns = True
.WebConsecutiveDelimitersAsOne = True
.WebSingleBlockTextImport = False
.WebDisableDateRecognition = False
.WebDisableRedirections = False
.Refresh BackgroundQuery:=False
 Union(Columns(3), Columns(4), Columns(5), Columns(7), Columns(8),           Columns(9)).Delete

 End With 
```

结束子

# ruby-on-rails-3 - Capistrano 部署后使用“未知键名'sql_attr_string'”思考 Sphinx 失败

> ID：14762574
> 
> 赞同：0
> 
> 时间：2013-02-07T22:50:32.050
> 
> 标签：ruby-on-rails-3, capistrano, sphinx, thinking-sphinx

Thinking Sphinx 在我的 Rails 应用程序开发环境中就像一个梦想。但是当我尝试通过 Capistrano 将它部署到我的生产环境时，它失败了。我尝试进入并手动构建索引并得到最奇怪的错误：

```
myuser@myhost:/domains/myappname.com/current$ bundle exec rake RAILS_ENV=production ts:index

Generating Configuration to /domains/myappname.com/releases/20130207221841/config/production.sphinx.conf
Sphinx 0.9.9-release (r2117)
Copyright (c) 2001-2009, Andrew Aksyonoff

using config file '/domains/myappname.com/releases/20130207221841/config/production.sphinx.conf'...
ERROR: unknown key name 'sql_attr_string' in /domains/myappname.com/releases/20130207221841/config/production.sphinx.conf line 27 col 18.
FATAL: failed to parse config file '/domains/myappname.com/releases/20130207221841/config/production.sphinx.conf' 
```

查看文件的相关部分`.conf`，我没有看到任何特别奇怪的地方：

```
source piece_core_0
{
  type = mysql
  sql_host = localhost
  sql_user = [user redacted]
  sql_pass = [pass redacted]
  sql_db = [db redacted]
  sql_query_pre = SET NAMES utf8
  sql_query_pre = SET TIME_ZONE = '+0:00'
  sql_query = SELECT SQL_NO_CACHE `posts`.`id` * CAST(2 AS SIGNED) + 0 AS `id` , `posts`.`title` AS `title`, `posts`.`body` AS `body`, `users`.`name` AS `author_name`, `post$
  sql_query_range = SELECT IFNULL(MIN(`id`), 1), IFNULL(MAX(`id`), 1) FROM `posts`
  sql_attr_uint = sphinx_internal_id
  sql_attr_uint = sphinx_deleted
  sql_attr_uint = class_crc
  sql_attr_string = sphinx_internal_class
  sql_query_info = SELECT * FROM `posts` WHERE `id` = (($id - 0) / 2)
} 
```

有什么解释吗？我只是不明白 sphinx 怎么会无法理解某些东西（`sql_attr_string`），这显然只是它自己的配置文件的正常部分。这个错误甚至是真正的错误，还是指向其他问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T09:28:59.280

看来您正在使用 Sphinx **0.9.9-release (r2117)**

根据[sphinx 文档](http://sphinxsearch.com/docs/1.10/conf-sql-attr-string.html)，`sql_attr_string`仅在**1.10-beta 版中引入。**

请检查您的生产环境并安装更新版本以使用此功能。

# php - php mysqli脚本神秘地不起作用

> ID：14762580
> 
> 赞同：0
> 
> 时间：2013-02-07T22:50:59.017
> 
> 标签：php, mysqli

我有以下代码：

```
<?php 
session_start();
echo $_SESSION['Username'];
$mysqli = new mysqli('****','****','****','****');
if($mysqli->errno)
{
    mail("**@yahoo.com", "***/Account.php Connection Error", $mysqli->error . "\nUser: " . $_SESSION['Username']);
}
else 
{
    $stmt = $mysqli->prepare("SELECT FirstName, LastName, Expires, Expires WHERE EMail=?");
    $stmt->bind_param('s', $_SESSION['Username']);
    $stmt->execute();
    $stmt->bind_result($FirstName, $LastName, $Expires);
    $stmt->store_result();
    while($row = $stmt->fetch())
    {
                .... 
```

我的行为很奇怪。我收到错误`Fatal error: Call to a member function bind_param() on a non-object in /home/content/42/7401242/html/****/Account.php on line 12`

我在许多其他页面上使用了这个 EXACT 代码，它运行良好。任何想法为什么我可能会随机收到此错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T22:53:53.567

你错过了`FROM`表名之前的

```
SELECT FirstName, LastName, Expires FROM Expires WHERE EMail=? 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T22:59:29.163

我不知道您是否将用户名与电子邮件绑定。而且你也缺少`FROM`条款

```
 $stmt = $mysqli->prepare("SELECT FirstName, LastName, Expires from Expires WHERE EMail=?");
   $stmt->bind_param('s', $_SESSION['Username']);
                               ^^^^^^^^^^-----------------be sure if its email variable 
```

# css - 将两个元素并排定位，浮动会使img消失

> ID：14762590
> 
> 赞同：0
> 
> 时间：2013-02-07T22:51:41.310
> 
> 标签：css, html, position, alignment

我是设计新手，我需要将两个 imgs 并排放置，并在它们之间留一些空间。这就是我的网站目前的样子：不要担心被切断，它应该是这样的。我需要准备这个，以便稍后在其上添加响应元素，这样我就不能使用绝对位置或任何将图像锁定到位的东西。

![这是我的网站目前的样子](../Images/0b4ca1f3844936a27e95eeb1c7a09e76.png)

两个图像的高度相同，均为 125 像素。当我将图片向左或向右浮动时，图片在我的网页边缘出现 95% 的截断。我不明白为什么它被放置在彼此下方，第二张图像似乎有足够的空间处于同一水平。

这是我到目前为止所拥有的：“navi”是我的容器或包装器......`mainlogo`我`slidertop`曾经进行过实验，目前每个下面都没有代码。

```
<div id="navi">
<div id="mainlogo"><header><a href="#"></a></header></div>
<div id="slidertop"><header id="topad"><a href="#"></a></header></div>
<div style="clear:both"></div>
</div>

#navi{
height: 130px;
}
#mainlogo{
}
#slidertop{
} 
```

这就是我调用我的图像的方式：

```
header{
background: url(../Images/logo1.gif) no-repeat 15% 0px;
border: none;
height: 125px;
top:100px;
}
header#topad{
background: url(../Images/TopAd.gif) no-repeat 80% 0px;
border: none;
height: 125px;
vertical-align: middle;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T23:05:52.843

你试过浮动div吗？

```
#mainlogo{
    float: left;
}
#slidertop{
    float: left;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T23:53:07.310

在您发布的原始代码中，我认为 div 都是可用宽度的 100%，并且它们将在页面上彼此重叠出现。如果您暂时在每个 div 周围添加一个彩色边框，您可以自己看到这一点，这样您就可以看到它们的位置。

如果您希望它们并排，则必须添加样式来完成此操作。例如，您可以浮动它们并指定宽度：

```
header { width: 45%; float: left; }
header#topad { float: right;} 
```

例如：[http ://codepen.io/anon/pen/ynuoa](http://codepen.io/anon/pen/ynuoa)

# iphone - 为什么我在 Xcode 中遇到此解析问题？

> ID：14762595
> 
> 赞同：0
> 
> 时间：2013-02-07T22:51:55.043
> 
> 标签：iphone, objective-c

我目前正在学习 Objective-C 和应用程序开发，但我也在使用罐装框架 (buzztouch) 来开发简单的应用程序。目前，我收到了这个解析问题：

'theTitle' 用作前一个参数的名称而不是选择器的一部分

这是代码行：

```
-(void)showAlert:(NSString *)theTitle:(NSString *)theMessage:(int)alertTag; 
```

我做错了什么，将来如何避免这种情况？抱歉，如果这是一个简单的问题，我只是想了解所有这些是如何工作的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T22:54:41.230

比较两者：

你的代码：

```
-(void)showAlert:(NSString *)theTitle:(NSString *)theMessage:(int)alertTag; 
```

现在，看看这个：

```
-(void)showAlert:(NSString *)theTitle theMessage:(NSString *)theMessage alertTag:(int)alertTag; 
```

问题在于您声明方法的方式：

以下是有关声明方法的一些详细信息：[Mac Developer Library](https://developer.apple.com/library/mac/#referencelibrary/GettingStarted/Learning_Objective-C_A_Primer/)。查看标题为**方法和消息传递**的部分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T23:31:58.030

我发现将 Objective C 方法与 C++ 或 C# 风格的方法进行比较很有用。

在 C# 中

```
public int Add(int number1, int number2) { 
     return number1 + number2;
} 
```

在目标 C

```
- (int)add:(int)number1 toNumber:(int)number2 {
    return number1 + number2
} 
```

# php - 如何让 $load 响应并打印出来

> ID：14762602
> 
> 赞同：0
> 
> 时间：2013-02-07T22:52:17.763
> 
> 标签：php, javascript, jquery

```
var $respond=$("#sql").load("sql/loaduser.php); 
```

我想提醒 $respond 它只给我对象对象，我怎样才能看到信息，我在 php 中回显了一些东西，所以我想看看。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T22:57:36.003

`load` returns a jQuery object, alerting an object results in [Object object], you can use `$.get` utility function.

```
$.get('sql/loaduser.php', function(data){
    $("#sql").html(data);
    alert(data);
}, 'html') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T22:56:20.473

或者使用 jQuery 的[AJAX-get()-Method](http://api.jquery.com/jQuery.get/)。你可以在回调函数中做任何你想做的事情，回调函数会以返回的数据作为它的第一个参数来调用。

# css - 按钮之间没有空格的CSS按钮定位

> ID：14762604
> 
> 赞同：0
> 
> 时间：2013-02-07T22:52:21.913
> 
> 标签：css, css-float

我想定位我的导航内联，但按钮之间没有空格。您也可以建议一些提示如何将它们放置在页面中间。我试过了，`margin:0, padding-left:0px`但它们之间还有空间。这是html代码：

```
<div id="nav">
<nav role="navigation">
<ul>
<li><a href="./" class="button" title="Go to the home page"</title>Home</a></li>
<li><a href="about.php" class="button">About</a></li>
<li><a href="contact.php" class="button">Contact</a></li>    
</ul></nav></div> 
```

**和 CSS 样式：**

```
.button{ 
 color: rgb(0, 0, 0);
 font-size: 15px;
padding: 11px;
   text-shadow: 0px 2px 2px rgba(144,150,150,0.75);
  background: rgb(255, 255, 248);
  background: -moz-linear-gradient(90deg, rgb(255, 255, 248) 69%, rgb(56, 2, 137) 92%);
  background: -webkit-linear-gradient(90deg, rgb(255, 255, 248) 69%, rgb(56, 2, 137) 92%);
 background: -o-linear-gradient(90deg, rgb(255, 255, 248) 69%, rgb(56, 2, 137) 92%);
 background: -ms-linear-gradient(90deg, rgb(255, 255, 248) 69%, rgb(56, 2, 137) 92%);
 background: linear-gradient(0deg, rgb(255, 255, 248) 69%, rgb(56, 2, 137) 92%);
-webkit-box-shadow: 0px 2px 1px rgba(50, 50, 50, 0.73);
-moz-box-shadow:    0px 2px 1px rgba(50, 50, 50, 0.73);
 box-shadow:         0px 2px 1px rgba(50, 50, 50, 0.73);
  }
 #nav li{
 display:inline;
 }

 #nav ul{
 list-style-type:none;
 margin:0;
  }
 #nav ul li a{text-decoration:none;
font:Tahoma, Helvetica, Arial, sans-serif;
letter-spacing:0.1em;

 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T23:21:28.273

在你的`#nav li`, 使用`display: block`and`float: left`代替，像这样：

```
#nav li {
  display: block;
  float: left;
} 
```

见[演示](http://jsfiddle.net/zaknotzak/FenqC/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T23:23:59.687

首先将您的导航置于屏幕中间，使用下面的方法。

```
#nav{
        width:960px; -- change me to correct size
        margin-right:auto;
        margin-left:auto;
        height:110px;  -- change me! 
} 
```

至于列表，这将采用列表并从左到右排列。链接之间的唯一间隙应该是小填充，因此它看起来不会彼此重叠。

```
#nav ul {
    display: inline;
    list-style: none outside none;
    margin: 0;
    padding: 0;
}

#nav li {
    display: inline;
    font-size: 11px;
    padding-right: 2px;
    padding-left: 2px;
    width: 100px; -- this depends on the number of buttons you have of course. 
} 
```

希望这可以帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T23:25:12.173

如果要在没有空格的情况下内联显示它，请尝试使用`letter-spacing`or`word-spacing`负值

# javascript - AngularJS 中的测试：注入函数的引用错误

> ID：14762605
> 
> 赞同：18
> 
> 时间：2013-02-07T22:52:24.447
> 
> 标签：javascript, angularjs, testing, karma-runner

我尝试测试下面的代码：

```
describe('myService test', function () {
    describe('when I call myService.one', function () {
        beforeEach(angular.module('TargetMarketServices'));
        it('returns 1', inject(function (imagesRepository) {
            expect(true).toEqual(true);
        }));

    });

}); 
```

执行此代码时，我收到此错误：

```
TypeError: 'undefined' is not a function (evaluating 'this.func.apply(this.spec)')
    at http://localhost:8080/testacular.js:76
    at http://localhost:8080/context.html:35
ReferenceError: Can't find variable: inject
    at /home/peter/Dropbox/AngularJS/set-component/test/sets/sets-ihm.js:6
    at /home/peter/Dropbox/AngularJS/set-component/test/sets/sets-ihm.js:8
    at /home/peter/Dropbox/AngularJS/set-component/test/sets/sets-ihm.js:10 
```

PhantomJS 1.8：执行 1 of 3（1 FAILED）（跳过 2）（0.072 秒 / 0.01 秒）

对于我的测试，我将 Testacular 与 Jasmine 和 PhantomJS 一起使用。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-09-04T14:32:52.900

AngularJS 提供了两个测试库：

*   角模拟.js
*   角度场景.js

angular-mocks 用于 Jasmine 和 Karma 测试。它发布全局方法 module() 和 inject() 以在 Jasmine 规范测试中使用。这意味着您必须加载 angular-mocks.js 脚本（在加载 angular.js 库/脚本之后）

angular-scenario 仅用于 e2e 测试。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-02-07T23:45:29.690

你拥有的那条线

```
beforeEach(angular.module('TargetMarketServices')); 
```

应该

```
beforeEach(module('TargetMarketServices')); 
```

如果您查看它使用的 test/unit/directivesSpec.js中的[angular-phonecat项目](https://github.com/angular/angular-phonecat)

```
beforeEach(module('myApp.directives')); 
```

如果我修改它以使用 angular.module 代替：

```
beforeEach(angular.module('myApp.directives')); 
```

然后我在运行 testacular 时也收到此错误：

```
TypeError: 'undefined' is not a function (evaluating 'this.func.apply(this.spec)') 
```

# multithreading - Netty OrderedMemoryAwareThreadPoolExecutor 没有创建多个线程

> ID：14762611
> 
> 赞同：0
> 
> 时间：2013-02-07T22:53:00.807
> 
> 标签：multithreading, netty, persistent-connection, threadpoolexecutor

我将 Netty 用于多线程 TCP 服务器和单个客户端持久连接。客户端发送许多二进制消息（在我的用例中为 10000 条），并且应该接收每条消息的答案。我在管道中添加了一个 OrderedMemoryAwareThreadPoolExecutor 来处理在多个线程上执行 DB 调用。

如果我在 messageReceived() 方法中运行数据库调用（或使用 Thread.currentThread().sleep(50) 模拟它），那么所有事件都由**单个线程**处理。

```
 5 count of {main}
    1 count of {New
10000 count of {pool-3-thread-4} 
```

对于 messageReceived() 的简单实现，服务器按预期创建了许多执行线程。

请问我应该如何配置 ExecutionHandler 以获取业务逻辑的多个线程执行器？

这是我的代码：

```
public class MyServer {

      public void run() {
            OrderedMemoryAwareThreadPoolExecutor eventExecutor = new OrderedMemoryAwareThreadPoolExecutor(16, 1048576L, 1048576L, 1000, TimeUnit.MILLISECONDS, Executors.defaultThreadFactory());  
            ExecutionHandler executionHandler = new ExecutionHandler(eventExecutor);        
            bootstrap.setPipelineFactory(new ServerChannelPipelineFactory(executionHandler));
      }
    }  

    public class ServerChannelPipelineFactory implements ChannelPipelineFactory {

      public ChannelPipeline getPipeline() throws Exception {

        pipeline.addLast("encoder", new MyProtocolEncoder());
        pipeline.addLast("decoder", new MyProtocolDecoder());
        pipeline.addLast("executor", executionHandler);
        pipeline.addLast("myHandler", new MyServerHandler(dataSource));

      }
    }

    public class MyServerHandler extends SimpleChannelHandler {

      public void messageReceived(ChannelHandlerContext ctx, final MessageEvent e) throws DBException {

          // long running DB call simulation
          try {
            Thread.currentThread().sleep(50);
          } catch (InterruptedException ex) {

          }  

          // a simple message  
          final MyMessage answerMsg = new MyMessage();
          if (e.getChannel().isWritable()) {
            e.getChannel().write(answerMsg);
          }  
      }      
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T14:48:27.587

OrderedMemoryAwareThreadPoolExecutor 保证来自单个通道的事件按顺序处理。您可以将其视为将通道绑定到池中的特定线程，然后处理该线程上的所有事件 - 尽管它比这更复杂一些，因此不要依赖始终由同一线程处理的通道。

如果您启动第二个客户端，您将看到它（很可能）在池中的另一个线程上进行处理。如果您真的可以并行处理单个客户端的请求，那么您可能需要 MemoryAwareThreadPoolExecutor 但请注意，这不能保证通道事件的顺序。

# javascript - JavaScript 插入位置

> ID：14762613
> 
> 赞同：2
> 
> 时间：2013-02-07T22:53:08.343
> 
> 标签：javascript, jquery, indexing, append

假设我有一个包含一堆有序元素的集合，在它的**抽象 order-position**插入另一个新子元素的常用方法是什么？

使用 dom 库`$(new).eq($(new).data('orderPosition'));`不起作用，因为它不是有效的索引。

```
// Add this element to it's logic position in the collection:
<div data-order-position="10"></div>

// The collection
<div id="myCollection">
   <div data-order-position="4"></div>
   <div data-order-position="67"></div>
   <div data-order-position="81"></div>
   <div data-order-position="82"></div>
   <div data-order-position="761"></div>
</div> 
```

我的真实收藏包含大约 400 个元素。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T23:12:53.267

我认为使用整数数组可能是最有效的方法。您可以在某处维护数组中已排序元素的常量列表（甚至根据需要继续排序）：

```
//Array of positions
var positions = [];

//Initially set up the array in question
//divs are already sorted, as we know
$("#myCollection div").each(function () {
   positions.push(parseInt(this.dataset.orderPosition)); 
});

//Create the new node we want to insert (in your case it may already exist)
var $new = $("<div>").data('order-position', 10).text(10);

//Append the new node index (if node already exists, just use `.data` as above)
positions.push(10);

//Yes, for whatever reason JS sorts by string and not number by default.
//There may also be a more efficient way to add the integer in the correct spot
//without having to sort all over again, but this is fast enough
positions.sort(function (a, b) {
    return a - b;
});

//Insert the new node!
$("#myCollection div").eq(positions.indexOf(10) - 1).after($new); 
```

[http://jsfiddle.net/ExplosionPIlls/ULEFX/](http://jsfiddle.net/ExplosionPIlls/ULEFX/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T23:08:11.723

为什么不将订单位置存储在数组中，然后使用它计算索引？这是更好的解决方案，因为读取 DOM 属性消耗的 CPU 比仅循环遍历数组并将新项目与现有项目进行比较要多得多

# ruby-on-rails - Rails Devise 允许 1 人注册

> ID：14762616
> 
> 赞同：1
> 
> 时间：2013-02-07T22:53:13.790
> 
> 标签：ruby-on-rails, devise, singleton, registration

我有一个供个人使用的 Rails 应用程序，它使用 Devise 进行身份验证。我希望我的应用程序只有一个用户。换句话说，在已经有 1 个用户注册后，如何禁用 Devise 中的注册？

我正在考虑在控制器中创建一个自定义方法。但是有什么好的方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-07T23:03:21.300

您想删除`:registerable`模型中的选项。然后在您的应用程序中创建您的单一帐户，`seed.rb`然后为您的应用程序播种。无需为了您自己的使用而使事情复杂化。

# command-line - WiX Bootstrapper：如何从命令行设置刻录变量？

> ID：14762617
> 
> 赞同：19
> 
> 时间：2013-02-07T22:53:18.267
> 
> 标签：command-line, wix, bootstrapper

使用 WiX 3.7 和 .NET 4.0。

从命令行运行 WiX 引导程序 EXE 时，一组刻录变量如何？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-02-07T22:53:18.267

首先，您希望设置的烧录变量需要设置为`Overridable`. 为此，您必须在 WXS 中包含以下命名空间：`xmlns:bal="http://schemas.microsoft.com/wix/BalExtension"`如果您像我一样使用 Visual Studio，则需要`WixBalExtension.dll`在项目引用中包含。接下来，您需要将以下属性添加到要通过命令行设置的所有刻录变量：`bal:Overridable="yes"`.

现在您可以通过命令行以这种方式设置变量：

```
BootstrapperSetup.exe /i /passive MyBurnVariable1=1 MyBurnVariable2=2 
```

以下是满足上述所有条件的 WXS 文件示例：

```
<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi"
         xmlns:bal="http://schemas.microsoft.com/wix/BalExtension">

  <Bundle Name="MyProduct" Version="1.0.0" Manufacturer="MyManufacturer" UpgradeCode="PUT-UPGRADE-CODE-HERE">

    <BootstrapperApplicationRef Id="WixStandardBootstrapperApplication.HyperlinkLicense">
      <bal:WixStandardBootstrapperApplication LicenseUrl="MyLicense.htm" ThemeFile="MyThemeFile.xml" LocalizationFile="MyLocFile.wxl" />
    </BootstrapperApplicationRef>

    <Variable Name="MyBurnVariable1" bal:Overridable="yes" Type="numeric" Value="0" />
    <Variable Name="MyBurnVariable2" bal:Overridable="yes" Type="numeric" Value="0" />

    <Chain>
      <MsiPackage Id="MyFirstMsiPackage"
                  SourceFile="first.msi"
                  InstallCondition="MyBurnVariable1 = 1" />

      <MsiPackage Id="MySecondMsiPackage"
                  SourceFile="second.msi">
        <MsiProperty Name="MY_PROPERTY" Value="[MyBurnVariable2]" />
      </MsiPackage>
    </Chain>
  </Bundle>
</Wix> 
```

# java - 应用服务器架构：通过单一地址访问集群服务器应用

> ID：14762621
> 
> 赞同：1
> 
> 时间：2013-02-07T22:53:23.183
> 
> 标签：java, jakarta-ee, web-applications, glassfish, application-server

我一直在阅读无数的 oracle 文档、博客等，但我无法完全理解这个概念。

我已成功将应用程序部署到 GlassFish 服务器集群。看截图： ![应用程序实例](../Images/fb7109f9d6a279cb138dacc2505f67e1.png)

我想通过使用单个 url 地址访问我的应用程序来进行负载平衡和故障转移。

例如，目前要访问我必须使用的应用程序，`http://<server-name>:28080/AppName`但我想使用`http://cluster:28080/AppName`并让可用的负载平衡服务自动选择它。

目前我有 3 台带有基本默认设置和 GMS 的 GlassFish 3.1 服务器。GlassFish 是否能够进行自动负载平衡和故障转移，或者我是否需要在 GlassFish 集群前使用 Web 服务器（如 Apache 或 Oracle IPlanet）来分配连接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T16:08:13.050

您需要一个前端负载均衡器（软件或硬件）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T20:54:20.510

正如 Olivier 所说，您需要在集群前面放置一个负载均衡器。您可以使用硬件设备，也可以使用软件。

我都用过，每个都很好用。您应该阅读[为 HTTP 负载平衡配置 Web 服务器以](http://docs.oracle.com/cd/E18930_01/html/821-2426/gchvt.html)获得更好的理解。

# cocos2d-iphone - 刚开始学习 Cocos2D，有什么推荐的资源吗？

> ID：14762625
> 
> 赞同：0
> 
> 时间：2013-02-07T22:53:39.590
> 
> 标签：cocos2d-iphone

我开始学习 Cocos2D，我个人更像是一个视觉学习者，所以如果有人知道他们可以指导我的任何好的视频教程，我将非常感激 :)

提前感谢您的时间和任何帮助:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T22:59:51.327

首先，Cocos2D 是一款出色且（相对）容易上手的引擎。好的选择！我强烈推荐在[这里](http://www.learn-cocos2d.com)找到的 Steffen Itterheim 的书。在短短几天内，我对使用引擎感觉良好。几个月后，这是第二天性。还可以查看 Kobold2D，它是 Cocos2D 的扩展，可以为您处理很多烦人的细节问题。此外，[Ray Wenderlich](http://www.raywenderlich.com)拥有大量 Cocos2D 在线教程，但并非所有教程都与最新版本保持同步。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T22:40:11.790

有一篇关于良好资源的博客文章可以帮助您从[这里](http://woohoogames.wordpress.com/2013/02/10/beginning-cocos2d/)开始。

# php - PHP：使用 strtotime 的问题

> ID：14762628
> 
> 赞同：0
> 
> 时间：2013-02-07T22:53:57.440
> 
> 标签：php

我想过滤我的输出：

```
07-02-13 20:08:41   test11@gmail.com
07-02-13 20:09:41   test11@gmail.com
07-02-13 20:21:25   hottie@gmail.com
07-02-13 20:56:51   ugly@gmail.com
07-02-13 21:42:37   selma532@gmail.com
07-02-13 22:09:11   blalbla421@gmail.com 
```

我想过滤我的输出，所以在 2 分钟内出现的电子邮件必须做一些事情。到目前为止，这是我的“过滤器代码”。但它不起作用。我究竟做错了什么？

```
strtotime('-2 minutes"', strtotime(date('d-m-y H:i:s', $filter['created']) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T22:58:33.563

The problem is that you date format is ambiguous. Does `07-02-13` mean February 7th 2013 (ie today) or does it mean July 2nd 2013 (US standard format), or does it mean February 13th 2007 (big-endian format) or what?

I would suggest rewriting your code so that it produces timestamps in big-endian format,
that is `Y-m-d H:i:s`. In this format, you can compare them as if they were strings, so all you'd have to do is:

```
$two_minutes_ago = date("Y-m-d H:i:s",strtotime("-2 minutes"));
if( $value_to_test > $two_mintes_ago) {
    do_something();
} 
```

# javascript - jQuery 在 div 外部单击动画它关闭的作品，但必须单击两次才能打开

> ID：14762629
> 
> 赞同：0
> 
> 时间：2013-02-07T22:53:57.477
> 
> 标签：javascript, jquery

我在这里设置了一个开发页面：http: [//dev.harryg.me/da/](http://dev.harryg.me/da/)

在侧面，我有 3 个 div 应该在单击时动画打开并在再次单击标题时动画关闭。

我想添加该功能，以便当用户单击文档上的其他位置时，所有 div 都会关闭。这几乎可以很好地工作，除了一旦由于单击外部而打开和关闭了一个 div，用户必须单击它两次才能重新打开它。

知道原因吗？

这是我的jQuery ...

```
jQuery(function($) {
    $('h2.tab-title').toggle(function() {
        $(this).parent().animate({left:'0px'}, {queue:false, duration: 500});
    }, function() {
        $(this).parent().animate({left:'-338px'}, {queue:false, duration: 500});
    });

});
jQuery(".side-tab").click(function(){ return false; });
jQuery(document).bind("click", function() { jQuery(".side-tab").animate({left:'-338px'}, {queue:false, duration: 500}); }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T23:00:24.537

我认为最好的方法是添加一个类，`opened`例如添加到打开的 div 中，然后`toggle`使用该类触发 div 的方法。被调用`toggle`的方法将处理关闭的动画。**正如popnoodles**提醒我的那样，当然`opened`应该在切换回关闭状态时删除课程。

 ****编辑：**按照您的意愿更新的代码：

```
jQuery(function($) {
    $('h2.tab-title').toggle(function() {
        $(this).parent().animate({left:'0px'}, {queue:false, duration: 500});
        $(this).parent().addClass('opened');
    }, function() {
        $(this).parent().animate({left:'-338px'}, {queue:false, duration: 500});
        $(this).parent().removeClass('opened');
    });

});
jQuery(".side-tab").click(function(){ return false; });
jQuery(document).bind("click", function() { jQuery(".opened h2.tab-title").trigger('click');}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T23:11:45.293

[**演示**](http://jsfiddle.net/yrJwv/1/)

创建一个打开和关闭事件并在随后的点击中触发一个或另一个，在文档点击时触发关闭。

```
<div><h2 class="tab-title">h2</h2></div>
<div><h2 class="tab-title">h2</h2></div>
<div><h2 class="tab-title">h2</h2></div>
<div><h2 class="tab-title">h2</h2></div> 
```

JS

```
$('h2.tab-title').on('open', function() {
    $(this).parent().animate({left:'0px'}, {queue:false, duration: 500}).data('open',true);
}).on('close', function() {
    $(this).parent().animate({left:'-338px'}, {queue:false, duration: 500}).data('open',false);
}).on('click', function(){
    if ($(this).parent().data('open')){
        $(this).trigger('close');
    }else{
        $(this).trigger('open');
    }
});
$(document).on('click', function(){
     $('h2.tab-title').trigger('close');
});

$('.side-tab').on('click', function(e){ e.stopPropagation(); }); // stop any click in the side tab from bubbling up to the document 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T22:59:30.193

将切换切换为单击，删除第二个功能并进行验证以检查其是否打开或关闭（例如获取 left 属性并检查是否小于 0 ）

第一次单击调用第一个函数并显示 div。当您在 div 外部单击时，该 div 将关闭。

当您再次单击它时，您调用了第二个函数，即关闭函数！这就是为什么不起作用！**

# jquery - Photo Gallery that thumbnails many, many photos

> ID：14762635
> 
> 赞同：1
> 
> 时间：2013-02-07T22:54:04.467
> 
> 标签：jquery, lightbox, image-gallery, photo-gallery

Can anyone recommend a jquery (or other) photo gallery that handles lots and lots of photos?

We have company events that generate maybe 250 photos. I'd like to put up a "wall" of thumbnails like MSN's "Wonderwall" but just the thumbnails- not all the crazy animation. Then viewers can go find themselves or co-workers in the thumbnails quickly and just click on (lightbox) the 15 or 20 photos they're interested in.

We're trying to avoid employees wading through 250 photos for an hour with a below-the-image slidebar gallery.

thanks, J

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T01:53:04.760

hi look at this [http://trentacular.com/downloads/](http://trentacular.com/downloads/) at the galleriffic-2.0.zip (~135 KB) eks nr 2 i think and if you want to then you can connect fancy box to the gallery tumbnails..if not us it ass it are..

hope this works

# mysql - MySQL OUTFILE 查询抱怨“文件已存在”但文件根本不存在

> ID：14762640
> 
> 赞同：7
> 
> 时间：2013-02-07T22:54:35.247
> 
> 标签：mysql, linux

我正在编写一个非常简单的 shell 脚本来将表转储到 CSV 文件中。这是其中的一部分：

```
day=`/bin/date +'%Y-%m-%d'`
file="/tmp/table-$day.csv"
rm $file
query="SELECT * FROM table INTO OUTFILE '$file' FIELDS TERMINATED BY ',' ENCLOSED BY '\"' LINES TERMINATED BY '\\n'"
echo "$query" | mysql <connection_parameters> 
```

我输入`rm $file`以确保在查询执行之前该文件不存在。

但是，当我执行脚本时，会收到相互冲突的消息：

```
rm: cannot remove `/tmp/table-2013-02-08.csv': No such file or directory
ERROR 1086 (HY000) at line 1: File '/tmp/table-2013-02-08.csv' already exists 
```

我在机器的任何地方都找不到 OUTFILE。

那么有什么问题..？

谢谢你。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-07T23:37:52.303

我找到了答案。

OUTFILE 在 MySQL 服务器上创建文件，而不是在我的 MySQL 客户端机器上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-25T04:34:51.497

检查你是否在 /etc/passwd 中有这个

mysql:x:27:27:MariaDB 服务器:/var/lib/mysql:/sbin/nologin

将 shell 更改为 /bin/bash

# oracle - 使用集合时 oracle pl/sql 中的 no_data_found 异常

> ID：14762641
> 
> 赞同：1
> 
> 时间：2013-02-07T22:54:35.577
> 
> 标签：oracle, collections, plsql

```
DECLARE
   TYPE EmpList IS TABLE OF varchar2(50) INDEX BY BINARY_INTEGER;

   temp    SYS_REFCURSOR;
   v_temp  varchar2(50);
   v_emp   EmpList;
BEGIN
   v_emp (1) := 'gaurav';
   v_emp (2) := 'manu';

   open temp for select v_emp(level) from dual connect by level<=2;
   loop
    fetch temp into v_temp;
     exit when temp%notfound;
       DBMS_OUTPUT.put_line (v_temp);
    end loop;
   close temp;

--the below part works, then why not the above part dint works
 for i in v_emp.first..v_emp.last
  loop
      dbms_output.put_line(v_emp(i));
  end loop;

EXCEPTION
   WHEN OTHERS
   THEN
      DBMS_OUTPUT.put_line (SQLERRM);
END; 
```

谁能告诉我为什么这个集合在这里工作？？它给了我 no_data_found 异常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T23:46:18.677

失败的原因是

```
v_emp(level) 
```

在运行时被评估（作为它的一个变量），所以实际上会对所有行进行评估 `v_emp(0);`

如果您将数组更改为

```
v_emp (0) := 'gaurav';
v_emp (1) := 'manu'; 
```

正确的方法（如果你不知道）是：

```
create TYPE EmpList IS TABLE OF varchar2(50);
/ 
```

进而 ：

```
v_emp := EmpList('gaurav', 'manu');
open temp for select column_value from table(v_emp); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T04:54:36.830

试试这个：

```
DECLARE
   TYPE EmpList IS TABLE OF varchar2(50) INDEX BY BINARY_INTEGER;

   temp    SYS_REFCURSOR;
   v_temp  varchar2(50);
   v_emp   EmpList;
BEGIN
   v_emp (0) := 'gaurav';
   v_emp (1) := 'manu';

   open temp for select v_emp(level) from dual connect by level<=2;
   loop
    fetch temp into v_temp;
        exit when temp%notfound;
       DBMS_OUTPUT.put_line ('v_temp' || v_temp);
    end loop;
   close temp;

--the below part works, then why not the above part dint works
 for i in v_emp.first..v_emp.last
  loop
      dbms_output.put_line(v_emp(i));
  end loop;

EXCEPTION
   WHEN OTHERS
   THEN
      DBMS_OUTPUT.put_line (SQLERRM);
END; 
```

# asp.net-mvc - 在 VS2012 中调试 MVC 应用程序尝试启动 IIS Express 两次

> ID：14762646
> 
> 赞同：29
> 
> 时间：2013-02-07T22:54:56.773
> 
> 标签：asp.net-mvc, visual-studio-2012, visual-studio-debugging, iis-express

**更新**

我确定这是一个没有明显解决方案的 Visual Studio 错误。我遇到过很多人有同样的问题。我在这里向 Microsoft 提交了错误票：

[http://connect.microsoft.com/VisualStudio/feedback/details/778864/vs2012-is-spawning-two-iisexpress-processes-when-attempting-to-debug](http://connect.microsoft.com/VisualStudio/feedback/details/778864/vs2012-is-spawning-two-iisexpress-processes-when-attempting-to-debug)

如果您遇到与下面描述的相同的问题，*请*投票给错误票，以便得到更多关注。

* * *

每当我尝试在配置为在 IIS express（版本 8）上运行的 Visual Studio 2012 中调试 MVC3（或 MVC4）应用程序时，都会收到以下错误：

![在此处输入图像描述](../Images/d3e251344a4af150596fbf1aa2a3d9f1.png)

关键是：IIS Express*正在*启动，尽管 Visual Studio 不这么认为并且调试器无法附加。IIS Express 托盘打开，我可以清楚地看到所有配置的网站都已启动：

![在此处输入图像描述](../Images/1c300697193a541528940e0c5c111fb8.png)

奇怪的是，IIS Express 系统托盘报告运行 IIS Express 时出现了一些错误。它是这样说的：

![在此处输入图像描述](../Images/89bf87ee875a6a02bcdbbcf7a59cb8d6.png)

这是一个严重的WTF。它报告 8080 正在被 IIS Express 进程使用 - Visual Studio*刚刚启动的进程。*因此，Visual Studio 尝试启动 IIS 两次，而当它可以预见地第二次失败时，调试器就会退出。我应该注意，在 Visual Studio 中启动调试配置之前，我*绝对确定*没有 IIS Express 进程已经在运行。我使用 Process Monitor 来验证 Visual Studio 实际上是在尝试启动 IIS Express 两次：

![在此处输入图像描述](../Images/1571f3dec34813b73e8a4924ecd97862.png)

请注意，在上面的屏幕截图中，您可以清楚地看到在 IIS Express PID 4732 上运行的网站。PID 4924 是启动 IIS Express 的第二次失败尝试。

此问题最初发生在 Windows 7 安装上。我完全重新格式化，安装了 VS2012 的新副本，并遇到了同样的问题。我更进一步，重新格式化，安装了 Windows 8 和 VS2012 的新副本，但问题仍然存在。

我创建了全新的空白 MVC3 和 MVC4 项目。 *没有什么能解决它。*

我在这里扯头发。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-20T21:47:27.647

w.Brian，我从一开始就关注了这篇文章，并且已经有很长一段时间遇到完全相同的问题，我刚刚发现是什么导致了我的问题。我已经能够通过以下方式为自己重现和修复错误：

VS2012启动iis express两次的原因与被附加到域并登录到域帐户有关。一旦我登录到一个完全本地的管理员帐户，我就可以毫无问题地启动和调试 MVC4 应用程序。这是使用附加到我的域的 Windows 8 Pro、VS2012 Update 1，并且没有其他软件/扩展/配置。完全干净的安装。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-11T07:51:18.000

嗨，也许这个解决方案可以帮助你。

*   管理 RuntimeVersion="4.0" 到 "4.0.30319"<br/>

例子：

```
<applicationPools>
<add name=”Clr4IntegratedAppPool” managedRuntimeVersion=”v4.0.30319″ managedPipelineMode=”Integrated”     CLRConfigFile=”%IIS_USER_HOME%\config\aspnet.config” autoStart=”true” /><br/><br/> 
```

**参考：[问题：Visual Studio 2012 > “无法启动 IIS Express Web 服务器”</a>](http://roykimsharepoint.wordpress.com/2012/11/10/issue-visual-studio-2012-unable-to-launch-the-iis-express-web-server/)** [](http://roykimsharepoint.wordpress.com/2012/11/10/issue-visual-studio-2012-unable-to-launch-the-iis-express-web-server/) 

[](http://roykimsharepoint.wordpress.com/2012/11/10/issue-visual-studio-2012-unable-to-launch-the-iis-express-web-server/)

[](http://roykimsharepoint.wordpress.com/2012/11/10/issue-visual-studio-2012-unable-to-launch-the-iis-express-web-server/)
*   [使用](http://roykimsharepoint.wordpress.com/2012/11/10/issue-visual-studio-2012-unable-to-launch-the-iis-express-web-server/)[进程监视器](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)解决问题

    **参考：[调试“无法启动IIS Express Web服务器”。来自 Visual Studio 2012 的错误。](http://blogs.msdn.com/b/finbar_ryan/archive/2013/01/02/debugging-the-unable-to-launch-the-iis-express-web-server-error-from-visual-studio-2012.aspx)**

*   尝试切换到内置于 web 主机的 Visual Studio 并运行它。运行一次后应该可以切换回 iis express

    **参考：来自论坛[Unable to launch the IIS Express Web server](http://forums.asp.net/t/1793014.aspx/1)**

*   尝试重新安装包含 iis-express的[Visual Studio 2010 SP1 。](http://www.microsoft.com/en-us/download/details.aspx?id=23691)

*   通过修改位于 %userprofile%\documents\IISexpress\config 目录中的 applicationhost.config 来禁用日志记录模块。为此，您需要在文件中注释掉几行。

在 / 元素下，注释掉该行

```
<add name="HttpLoggingModule" image="%IIS_BIN%\loghttp.dll" /> 
```

在 // 元素下，注释掉该行

```
<add name="HttpLoggingModule" lockItem="true" /> 
```

保存更改后，尝试重新启动 iis express。

**参考：来自 stackoverflow 论坛：[无法启动 IIS Express Web 服务器](https://stackoverflow.com/questions/6171656/unable-to-launch-the-iis-express-web-server)**

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-27T10:09:42.307

右键单击您的 MVC 项目/*所有项目一一*/
转到属性
转到 Web 选项卡
，您必须在其
下方的文本框中选中“使用本地 IIS 网络服务器”单选框，确保项目具有相同的端口在你的情况下是`8080`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-04-23T13:45:09.470

看看这里的答案：

[http://forums.asp.net/t/1953087.aspx?VS+2013+Unable+to+launch+the+IIS+Express+Web+Server](http://forums.asp.net/t/1953087.aspx?VS+2013+Unable+to+launch+the+IIS+Express+Web+Server)

当“bg”是用户名的一部分时，在 Windows 8 机器上这是一种奇怪的行为

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-02-20T14:33:56.153

我参加聚会可能有点晚了——这是我的两便士：

a) [http://saintgimp.org/2012/05/03/fixing-the-error-unable-to-launch-the-iis-express-web-server-failed-to-register-url-access-is-拒绝/](http://saintgimp.org/2012/05/03/fixing-the-error-unable-to-launch-the-iis-express-web-server-failed-to-register-url-access-is-denied/)

b) [http://abhijitjana.net/2010/07/20/unable-to-start-web-site-on-iis-process-can-not-access-the-file-because-its-being-used-通过另一个过程如何解决/](http://abhijitjana.net/2010/07/20/unable-to-start-web-site-on-iis-process-can-not-access-the-file-because-its-being-used-by-another-process-how-to-resolve/)

概要：当前端口（通常是 Skype）有一个 URL 预留

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-02-27T13:17:00.420

以防万一，您是否已`127.0.0.1 localhost`在*文件夹*/system32/drivers/stc/hosts 中定义？否则，您可以[在这里查看](http://blogs.msdn.com/b/finbar_ryan/archive/2013/01/02/debugging-the-unable-to-launch-the-iis-express-web-server-error-from-visual-studio-2012.aspx)，这可能只是关键。

干杯

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-01-23T17:17:36.860

我在使用我的域帐户的 Windows 8 和 Windows 8.1 上遇到了同样的问题。在我的情况下，将 Documents 文件夹路径（右键单击 Documents 文件夹 -> 属性 -> 位置）从*C:\Users\username\Documents*更改为*D:\Documents*帮助

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-10-14T17:44:53.080

本周，我遇到了同样的问题：IIS Express 启动，但是 VS 抱怨它无法启动 IIS Express 并且调试失败。

我终于通过对 IIS Express 应用 2014 年 6 月的热修复解决了这个问题：

*   [http://www.microsoft.com/en-us/download/confirmation.aspx?id=43380](http://www.microsoft.com/en-us/download/confirmation.aspx?id=43380)

我们（我的 IT 支持人员和我）在遇到一个非常不可能的问题后发现了这个修补程序。显然，MS 验证了 IISExpress 8.0 中的一个错误，如果应用程序名称的任何部分包含字母组合“bg”（我的用户名以 bg 开头），它会导致行为异常：

*   [https://connect.microsoft.com/VisualStudio/feedback/details/848945/visual-studio-2012-iis-express-fails-to-start-if-application-name-contains-bg](https://connect.microsoft.com/VisualStudio/feedback/details/848945/visual-studio-2012-iis-express-fails-to-start-if-application-name-contains-bg)

注意：VS 2013 Update 4 已经包含了这个修复，这可能就是为什么有些人仅仅通过更新到 VS 2013 就能成功的原因。

我们发现的其他一些关于该问题的链接（您可能需要浏览一下才能找到该主题）：

*   [http://forums.asp.net/t/1953087.aspx?VS+2013+Unable+to+launch+the+IIS+Express+Web+Server](http://forums.asp.net/t/1953087.aspx?VS+2013+Unable+to+launch+the+IIS+Express+Web+Server)
*   [https://connect.microsoft.com/VisualStudio/feedback/details/865116/process-with-an-id-of-id-is-not-running](https://connect.microsoft.com/VisualStudio/feedback/details/865116/process-with-an-id-of-id-is-not-running)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-05-03T13:36:41.833

在我的情况下起作用的是卸载项目，然后编辑 csproj 文件。我删除了有关 IIS 和 IISEXPRESS 的所有部分。然后我重新加载项目并再次从项目属性中选择使用 IIS EXPRESS。然后它起作用了。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-09-30T19:14:17.240

我今天遇到了一个相同的问题（IISExpress 尝试启动两次并在 Visual Studio 中点击调试时失败）同时帮助另一个开发人员使用 Web 表单站点。在尝试了几种解决方案后，我们发现我们可以通过以下方式解决问题：

*   创建新的空 Visual Studio 解决方案
*   添加指向新的空文件夹的“现有网站”
*   将现有（非工作）网站的内容复制到我们创建的新文件夹中

简单地删除网站并将其重新添加到原始解决方案中不起作用，创建新解决方案并添加回现有网站也不起作用。我可以从命令行启动 IISExpress 就好了。

在对 .SLN 文件进行前后比较之后，我相信这就是问题所在。由于我找到了解决方法，因此我没有花很多额外的时间。显然，从头开始重新创建整个解决方案可能不是大型项目的选择（我们的项目非常小），但希望这至少指向正确的方向。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-05-02T08:32:48.170

当然，该站点有两个实例`FrontEnd`正在运行，但请注意，一个实例是 HTTP，另一个是HTTP **S。**

在网站属性中`SSL Enabled`设置为*True*`Project Url`但在*Web*选项卡上设置为 HTTP 地址时，可以获得两个实例。

使它们都成为 HTTP（或 HTTPS），这可能会解决它。

# json - 为什么当我在网格行的内联编辑上单击更新时调用我的读取方法

> ID：14762647
> 
> 赞同：0
> 
> 时间：2013-02-07T22:55:03.960
> 
> 标签：json, asp.net-mvc-3, asp.net-mvc-4, kendo-ui, kendo-grid

剑道网格的另一个令人沮丧的一天。无论如何，我的问题是：当我在网格行项目上单击“编辑”时，它会进入编辑模式。好的。然后我修改一条记录，然后点击更新。我希望调用“/Company/SaveAccountAdmin”方法。但是没有......再次调用读取方法。当我单击“取消”时，记录就消失了！$("#save") 点击事件只是试图强制保存，但这些事件肯定可以从网格命令按钮触发吗？有什么想法吗？

```
/// <reference path="../kendo.all-vsdoc.js" />

$(document).ready(function () {

var CompanyId = $("#CompanyId").val();

var dataSource = new kendo.data.DataSource(
  {
      batch: true,
      pageSize: 10,

      transport: {
          create: {
              url: "/Company/SaveAccountAdmin",
              contentType: "application/json; charset=utf-8",
              type: "POST",
              dataType: "json",
              url: "/Company/ReadAccountAdmin",
          },

          read: {
              url: "/Company/ReadAccountAdmin"
          },

          update: {
              url: "/Company/SaveAccountAdmin",
              contentType: "application/json; charset=utf-8",
              type: "POST",
              dataType: "json",
              url: "/Company/ReadAccountAdmin",
          },
          //destroy: {},
          parameterMap: function (options, operation) {
              if (operation !== "read" && options.model) {
                  return { model: kendo.stringify(options.model) };
              }
          }
      },

      schema: {

          model: {
              id: "ComanyContactId",
              fields: {
                  CompanyId: { type: "number", editable: false, nullable: false, defaultVaue: CompanyId },
                  CompanyContactId: { type: "number", editable: false, defaultValue: 0 },
                  FirstName: { type: "string", nullable: false, validation: { required: true } },
                  LastName: { type: "string", nullable: false, validation: { required: true } },
                  Email: { type: "string", nullable: false, validation: { required: true } },
                  Phone: { type: "string", nullable: false, validation: { required: true } },
                  IsActive: { type: "boolean" }
              }
          }
      }
  });

$("#save").click(function (event) {

    event.preventDefault();

    var rows = $.map(dataSource.data(), function (value, index) {

        return {
            CompanyId: value["CompanyId"],
            CompanyContactId: value["CompanyContactId"],
            FirstName: value["FirstName"],
            LastName: value["LastName"],
            Email: value["Email"],
            Phone: value["Phone"],
            IsActive: value["IsActive"]
        }
    });

    var jsonCompanyContacts = JSON.stringify(rows);

    $.ajax({
        url: '/Company/SaveAccountAdmin',
        type: 'POST',
        traditional: true,
        data: { "jsonCompanyContacts": jsonCompanyContacts },
        success: alert("Data Saved")
    })
});

$("#AccountAdmins").kendoGrid({
    dataSource: dataSource,
    toolbar: ["create"],

    editable: "inline",
    sortable: true,
    pageable: true,
    navigatable: true,
    editable: "inline",
    columns: [
        { field: "CompanyId", title: "CompanyID", sortable: true },
        { field: "CompanyContactId", title: "Company ContactID", sortable: true },
        { field: "FirstName", title: "First Name", sortable: true },
        { field: "LastName", title: "Last Name" },
        { field: "Email", title: "Email", },
        { field: "Phone", title: "Phone", },
        { field: "IsActive", title: "Is Active" },
        { command: ["edit", "destroy"], title: "&nbsp;", width: "210px" }]

}); 
```

});

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T23:52:30.760

我的猜测是，这是因为您为 Update 命令设置了读取 URL：

```
 update: {
          url: "/Company/SaveAccountAdmin", // <-- Not used because it is changed below
          contentType: "application/json; charset=utf-8",
          type: "POST",
          dataType: "json",
          url: "/Company/ReadAccountAdmin", // <-- Read URL set
      }, 
```

# scala - Scala 的 Java EE 替代品？

> ID：14762649
> 
> 赞同：11
> 
> 时间：2013-02-07T22:55:09.257
> 
> 标签：scala, jakarta-ee, typesafe-stack

许多 Java x Scala 比较似乎只关注语言（语法、集合 api、actor 等），但企业应用程序开发呢？

如果您想使用 Scala 构建分布式企业系统，您会使用 Scala 语法（例如，使用 Scala 语法的 EJB 兼容类）编写传统的 Java EE 应用程序并在 Java EE 容器中运行它，或者是否有 Java EE 替代品？ Scala 生态系统？

如果是第二个，到目前为止我发现的最接近的是类型安全堆栈；它是 Scala 替代 Java EE 容器的吗？

Akka 是 JMS（可能还有 Session Beans）的替代品，还是您的 Scala 系统仍会利用 Java EE 服务？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-02-08T00:13:42.063

好吧，
Scala / Akka 为系统开发中的许多常见陷阱提供了不同的概念。仅将一些与 Java EE 进行比较：

=> JavaBeans：
可变数据结构只是邪恶的，不是线程安全的。将它们放入容器中不会改变任何东西。改为使用不可变数据结构，因为 scala 使用 CaseClasses 强制执行。

=> EJB：EJB
的组合很糟糕。实际问题是 EJB 需要具有高度的内聚性才能在可重用性方面发挥作用，而这在实践中几乎没有。把它们塞进一个容器不会让它变得更好。在 Scala 中，使用特征组合，您可以通过受 f 有界多态性保护的构造函数注入来使用临时组合。生活可以如此简单。

=> 事务：
是的，事务管理器已经使事情变得更好，但它仍然需要大型 Java EE 堆栈才能使其工作。在 Scala 中，只需使用 akka 提供的软件事务内存 (STM) 即可。

=> 持久性：
我们真的需要 ORM 吗？像 squeryl.org 这样的项目将强类型 LINQ 添加到 Scala。它不像 Hibernate 那样使用重量级查询语言映射，它只是将查询集成到 scala 中，并由编译器进行全面检查。这当然只适用于关系数据库。对于 no-sql，还有其他可用的解决方案。

=> 缩放？
集群 Java EE？我需要多说吗？
在 akka 中，您只需添加更多服务器，系统就会扩展。为什么？因为远程 Actor 的处理和访问方式与本地 Actor 相同，其他一切都只是配置您的分布式 Actor 系统的问题。Akka 是基于 Erlang 模型的，所以他们不寻找 5-9 的正常运行时间，而是在全系统负载下寻找 9-9 的正常运行时间。同时，akka 非常简单和轻量，您可以在 Android 上使用它。你会尝试在 Android 上运行 Java EE 吗？
[https://github.com/gseitz/DiningAkkaDroids](https://github.com/gseitz/DiningAkkaDroids)

需要明确的是，也许十年前，Java EE 是如何构建大型企业级软件的问题的答案，一旦 Spring 使其可用，它可能是当时最好的可用解决方案。
今天，世界发生了很大变化，大多数旧答案不再适合今天的现实。Scala 并不完美，但如果它真的归结为一行，那就是：

在 scala 中，我在 Java EE 和容器设置所需的一小部分时间内完成了我的实际编程。

甚至 Spring，作为 Java EE 的首选框架，也在向 scala 发展：

[http://blog.springsource.org/2012/12/10/introducing-spring-scala/](http://blog.springsource.org/2012/12/10/introducing-spring-scala/)

从 Akka 的概念和最佳实践开始，有一本名​​为“Akka Essential”的方便的书

[http://www.akkaessentials.in/2012/12/adding-turbchargers-to-jee-apps.html](http://www.akkaessentials.in/2012/12/adding-turbchargers-to-jee-apps.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-08T00:01:06.040

Akka 确实是 JMS 的一种“替代品”。在这个想法（和你的问题）背后，确实是范式的改变，我们必须意识到这一点，但从这个事实开始，我认为 akka 有机会在未来被广泛用于多种用途，从消息传递分布式以太并发平台之间的集成。

类型安全堆栈是一个堆栈，所以我发现认为关于 Java EE 容器是没有用的。

最后，第一个答案：如果你想使用 EJB 语法，请考虑使用注解，你应该有机会或多或少地用与 java 相同的方式编写 EJB，加上一些 scala 的“语法糖”

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-08T00:01:37.933

如果您想要 Java EE，您可以直接使用 Java EE 和 Scala。但是，我不知道 Scala 社区中的任何人都不想*摆脱*Java EE（或继续避免使用它）。

# mysql - MySQL | 左连接 wp_posts 和 wp_postmeta

> ID：14762650
> 
> 赞同：1
> 
> 时间：2013-02-07T22:55:11.120
> 
> 标签：mysql, sql, wordpress, left-join

我喜欢 LEFT JOIN 两个表 wp_posts 和 wp_postmeta。在我的帖子中，我创建了几个元框选项。

假设我创建了一个名为“广告”的自定义帖子类型，对于每个广告，我都有发布日期和到期日期作为元选项。

问题是，我如何加入这两个表，以便从 wp_posts 表中获取帖子的 ID，其中当前日期高于帖子元表中的开始日期并且低于帖子中的到期日期元表。

对于非 WP 用户，wp_posts 表是一个传统表，其中每一行代表一个帖子，而 wp_postmeta 是一个键值分析表，其中基于帖子 id，包含多行来描述帖子的元选项。

有没有办法在单个 MySQL Query 中进行该查询？

亲切的问候。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T23:06:38.570

我认为您的意思是“开始日期”是“publication_date”。

如果没有模式定义，我会猜测列名和数据类型

一种方法是在 EXISTS 谓词中使用相关子查询，尽管这可能不是最有效的方法：

```
SELECT p.id
  FROM wp_posts p
 WHERE EXISTS
       ( SELECT 1
           FROM wp_postmeta m1
          WHERE m1.wp_posts_id = p.id
            AND m1.meta_option_name = 'publication date'
            AND m1.meta_option_date_value <= NOW()
       )
   AND EXISTS
       ( SELECT 1
           FROM wp_postmeta m2
          WHERE m2.wp_posts_id = p.id
            AND m2.meta_option_name = 'expiration date'
            AND m2.meta_option_date_value > NOW()
       ) 
```

* * *

您特别询问了使用 LEFT JOIN

使用 LEFT JOIN 操作可以获得等效的结果（尽管此查询实际上等同于进行 INNER JOIN 操作）：

```
SELECT p.id
  FROM wp_posts p
  LEFT
  JOIN wp_postmeta m1
    ON m1.wp_posts_id = p.id 
   AND m1.meta_option_name = 'publication date'
   AND m1.meta_option_date_value <= NOW()
  LEFT 
  JOIN wp_postmeta m2
    ON m2.wp_posts_id = p.id
   AND m2.meta_option_name = 'expiration date'
   AND m2.meta_option_date_value > NOW()
 WHERE m1.id IS NOT NULL
   AND m2.id IS NOT NULL
 GROUP 
    BY p.id 
```

# ios - 遍历字典

> ID：14762652
> 
> 赞同：0
> 
> 时间：2013-02-07T22:55:24.443
> 
> 标签：ios, objective-c, iteration, nsdictionary

我正在尝试遍历 NSMutableDictionary，但我似乎无法得到我想要的。我有一个字典将字符串映射到这样的颜色......

```
squareColors = [NSMutableDictionary dictionaryWithObjects: [NSMutableArray arrayWithObjects:
                                                                [NSNumber numberWithInt:0],
                                                                [NSNumber numberWithInt:0],
                                                                [NSNumber numberWithInt:0],
                                                                [NSNumber numberWithInt:0],
                                                                [NSNumber numberWithInt:0],
                                                                nil]

                                                      forKeys: [NSMutableArray arrayWithObjects:
                                                                @"yellow",
                                                                @"blue",
                                                                @"green",
                                                                @"purple",
                                                                @"orange",
                                                                nil]]; 
```

随着时间的推移，每个条目的价值都会增加。每隔一段时间，我就想查查字典并选择计数最高的颜色。我该怎么做？这是我正在尝试的，但我不熟悉块。

```
__block int mostSquares = 0;
__block NSString* color = @"";
/* Look through the dictionary to find the color with the most number of squares */
[squareColors enumerateKeysAndObjectsUsingBlock:^(id key, id obj, BOOL *stop) {
   NSLog(@"%@ => %@", key, obj);
   NSInteger count = [key integerValue];
   if (count > mostSquares)
   {
        color = key;
        mostSquares = count;
   }
}]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T23:18:07.977

您的代码中有一个非常简单的错误。这一行：

```
NSInteger count = [key integerValue]; 
```

应该：

```
NSInteger count = [obj integerValue]; 
```

'key' 是颜色名称，`obj`是数字。正如你所拥有的，每次迭代`count`都设置为`0`，因为调用`integerValue`非数字字符串会给你`0`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T23:04:11.880

Simple solution using your example:

```
NSMutableArray *arrayNumbers = [NSMutableArray arrayWithObjects:
                                [NSNumber numberWithInt:0],
                                [NSNumber numberWithInt:1],
                                [NSNumber numberWithInt:2],
                                [NSNumber numberWithInt:6],
                                [NSNumber numberWithInt:4],
                                nil];
NSMutableArray *arrayColours =  [NSMutableArray arrayWithObjects:
                                 @"yellow",
                                 @"blue",
                                 @"green",
                                 @"purple",
                                 @"orange",
                                 nil];
NSMutableDictionary *squareColors = [NSMutableDictionary dictionaryWithObjects:arrayNumbers
                                                                       forKeys:arrayColours];
NSUInteger indexOfArray = [arrayNumbers indexOfObject:[arrayNumbers valueForKeyPath:@"@max.intValue"]];
NSLog (@"Colour with largest value is %@", [arrayColours objectAtIndex:indexOfArray]); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T23:11:58.273

您可以将您的密钥存储到一个数组中并使用该数组进行迭代吗？这可能是最有效的解决方案，因为无论如何您都需要知道每个键。

# c# - 仅在 C# 中的指定组中搜索 Active Directory 用户

> ID：14762653
> 
> 赞同：0
> 
> 时间：2013-02-07T22:55:27.397
> 
> 标签：c#, .net, active-directory

我一直在努力寻找一种查询指定 AD 组成员的好方法。

我在查找组，甚至根据条件查询用户方面没有问题。

目前我有

```
 PrincipalContext context = new PrincipalContext(ContextType.Domain, _domain, ADServerUser, ADServerPassword);
 UserPrincipal userPrinciple = new UserPrincipal(context);
 userPrinciple.GivenName = "stringToSearchForFirstName";
 userPrinciple.Name = "stringToSearchForUserName";
 userPrinciple.Surname = "stringToSearchForLastName";
 PrincipalSearcher srch = new PrincipalSearcher(new UserPrincipal(context));                    
 srch.QueryFilter = userPrinciple;
 var result = srch.FindAll(); 
```

这为我提供了我想要的所有用户，但它不会过滤组。

我可以将 GroupPrincipal 对象与主体搜索一起使用，但我无法过滤掉用户。

我有点想要一种方法，能够同时应用 UserPrincipal 和 GroupPrincipal 来过滤由 Group 和 User 参数返回的结果。

我使用了一个 linq where 子句来尝试进行匹配以查看用户是否在一个组中，但是当我得到所有用户时，查询超时。总的来说是有道理的。

但是，如果我查询该组，我无法使用 principalSearcher 来应用查询。

关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T23:12:04.137

```
PrincipalContext ctx = new PrincipalContext(ContextType.Domain, _domain);
// get the AD Group you are wanting to Query
GroupPrincipal group = GroupPrincipal.FindByIdentity("cn=YourGroupname");
foreach(Principal p in group.Members)
{
    //do what ever coding you need to do here            
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-17T06:43:04.093

根据我的研究，我得出的结论是，使用主体对象来过滤组和用户参数是不可能的。我们需要恢复使用对 AD 的查询字符串方法来解决问题。

# javascript - JavaScript 从函数或对象中捕获异常

> ID：14762658
> 
> 赞同：0
> 
> 时间：2013-02-07T22:55:36.900
> 
> 标签：javascript, oop, error-handling

我遇到了相当烦人的问题。我无法捕获从函数中抛出的错误。老实说 - 如果不是同样适用于从 JavaScript 对象中抛出错误的事实，我不会太在意。

这是示例代码：

[[http://jsfiddle.net/TxsHK/1/](http://jsfiddle.net/TxsHK/1/)（你需要firebug控制台来测试这段代码）]

```
function ViewError($CONTENT){
    this.content = $CONTENT;

    return this.content;
};

try{
    $(document).ready(function() {
    //--------------
          throw ViewError('Test error');
    //--------------
    });//$(document).ready(function() {
}catch (e) {
    if (e instanceof ViewError) {
        console.info(e.message);
    }
    else{
        console.warn(e.message);
    }
} 
```

给出错误

```
TypeError: e is undefined 
```

为什么？函数（或对象）抛出的错误应该是完全可以捕获的。这就是 try-catch 块的全部目的：从函数中捕获异常。至少……在其他语言中也是如此。

任何人都可以解释发生了什么？以及如何从函数/对象中捕获异常？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T22:58:07.957

您的“ViewError”函数不返回任何内容。因此，您正在投掷`undefined`. （*编辑*-您的小提琴与发布的代码不同-不要那样做！）

考虑到代码的编写方式，正在以我认为不正确的方式调用“ViewError”函数。我认为您想要`throw new ViewError("Test error");`确保创建了一个新对象。

还有另一个问题：您希望能够捕获从调用 to 引发的异常`$(document).ready()`，但这并不一定会奏效。如果该代码运行时文档还没有准备好，那么您将不会收到任何异常，因为调用会立即返回。当文档准备好时，您传入的函数将在稍后调用。

# ruby-on-rails - 从 wrapbootstrap 实现引导主题

> ID：14762660
> 
> 赞同：2
> 
> 时间：2013-02-07T22:55:43.407
> 
> 标签：ruby-on-rails, ruby-on-rails-3, twitter-bootstrap, themes

我已经通过 wrapbootstrap 下载了一个主题，但不知道如何实现它。我以为它只是复制 CSS 和 JS 文件，但似乎还有更多。

我下载的主题是[https://wrapbootstrap.com/theme/awesome-admin-WB0663265](https://wrapbootstrap.com/theme/awesome-admin-WB0663265)

我已经将它暂时上传到 Github 上~~github.com/raycchan/temp~~（一旦我解决它，我会尽快删除它）

这里有示例模板，其中包含生成的 .html 文件以及 .html.erb 文件，一旦我将 erb 文件插入到我的 rails 应用程序中，它就会抛出如下错误：

但它不承认这些：

```
<%= data.page.title || "Bootstrap Admin" %>         # data undefined
<%=partial 'dashboard-navigation'%>                 # partial undefined 
```

有人可以逐步指导我如何实现这个引导主题吗？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T23:12:07.660

为漂亮的模板赋予 Rails 灵魂真的很有趣。几个简单的步骤：

*   复制 .css 到`app/assets/stylesheets`.js 到`app/assets/javasripts`
*   在清单文件中包含新文件`application.css`和`application.js`
*   对于字体真棒使用[这个描述](https://stackoverflow.com/questions/14247811/rails-font-awesome-doesnt-download/14248517#14248517)

然后与我们分享结果。

# spring - 如何使用客户端上传多部分表单数据

> ID：14762661
> 
> 赞同：0
> 
> 时间：2013-02-07T22:55:45.813
> 
> 标签：spring, spring-mvc

我正在尝试将多部分表单数据从 Web 客户端上传到 Spring MVC 控制器。我在“Spring”实现中搜索以下 curl 命令：

```
curl -v -X POST -F "logo=@walmart.jpg" -F "id=12345" -F "name=Walmart" http://localhost:8080/api/cardprovider/logo 
```

请注意：我不是通过 html 表单上传表单，这不是我想要实现的。

现在我的问题是：

*   您会按照本 [博客](http://evgenyg.wordpress.com/2010/05/01/uploading-files-multipart-post-apache/)中的说明使用 Apache Commons HttpClient吗？
*   或者是否有一种“春天”的魔法图书馆可以帮助我做到这一点？

我花了几天时间寻找使用 Spring 库的解决方案，但 Spring 手册中的所有示例都指的是 html 表单上传，或者非常基本和简单，只有基本文本。

Spring 对我来说相当新，但是里面有这么多很棒的库，如果 Spring 的人不会想到让上传多部分数据变得更容易的东西，我会感到惊讶（看起来好像它会是从表格发送）。

上面的 curl 命令与以下服务器端代码一起成功运行：

控制器：

```
@Controller
@RequestMapping("/api/cardprovider/logo")
public class CardproviderLogoResourceController {

  @Resource(name = "cardproviderLogoService")
  private CardproviderLogoService cardproviderLogoService;

  /**
   * Used to upload a binary logo of a Cardprovider through a Multipart request. The  id is provided as form element.
   * <p/>
   * Example to upload a file using curl:
   * curl -v -X POST -F "image=@star.jpg" -F "id=12345" -F "name=Walmart" http://localhost:8080/api/cardprovider/logo
   * <p/>
   *
   * @param logo the Multipart request
   * @param id    the Cardprovider id
   * @param name  the Cardprovider name
   */
  @RequestMapping(value = "", method = RequestMethod.POST)
  @ResponseStatus(HttpStatus.NO_CONTENT)
  public void storeCardproviderLogo(@RequestParam(value = "logo", required = false) MultipartFile logo,
                                  @RequestParam(value = "name") String name,
                                  @RequestParam(value = "id") String id) throws IOException {

    cardproviderLogoService.storeLogo(logo, id, name);
  }
} 
```

这是我的服务类，它将 Multipart 请求存储到 GridFS 数据库中：

服务：

```
@Service
public class CardproviderLogoService {

  @Autowired
  GridFsOperations gridOperation;

  /**
   * Create the logo in MongoDB GridFS with the data returned from the Multipart
   * <p/>
   *
   * @param logo the MultipartFile content
   * @param id      the Cardprovider id
   * @param name    the Cardprovider name
   * @return true if the image can be saved in the database, else false
   */
  public Boolean storeLogo(MultipartFile logo, String id, String name) {
    Boolean save_state = false;

    BasicDBObject metadata = new BasicDBObject();
    metadata.put("cardproviderId", id);
    metadata.put("cardproviderName", name);
    metadata.put("contentType", logo.getContentType());
    metadata.put("fileName", createLogoFilename(name, logo.getOriginalFilename()));
    metadata.put("originalFilename", logo.getOriginalFilename());
    metadata.put("dirShortcut", "cardproviderLogo");
    metadata.put("filePath", "/resources/images/cardproviders/logos/");

    try {
        gridOperation.store(logo.getInputStream(),
                metadata.getString("fileName").toLowerCase().replace(" ", "-"),
                metadata);
        save_state = true;
    } catch (Exception ex) {
        Logger.getLogger(CardproviderLogoService.class.getName())
                .log(Level.SEVERE, "Storage of Logo failed!", ex);
    }

    return save_state;
}

/**
 * Creates the new filename before storing the file in MongoDB GridFS. The filename is created by taking the
 * name of the Cardprovider, lowercase the name and replace the whitespaces with dashes. At last the file
 * extension is added that was provided by the original filename.
 * <p/>
 *
 * @param name the Cardprovider name
 * @param originalFilename the original filename
 * @return the new filename as String
 */
private String createLogoFilename(String name, String originalFilename) {
    String cpName = name.toLowerCase().replace(" ", "-");

    String extension = "";
    int i = originalFilename.lastIndexOf('.');
    if (i > 0 && i < originalFilename.length() - 1) {
        extension = originalFilename.substring(i + 1).toLowerCase();
    }
    return cpName + "." + extension;
  }
} 
```

感谢您的帮助和亲切的问候，克里斯

**解决方案**

我可以通过以下方式解决问题。我有我的 HtmlController，它采用 Input 形式并建立与 RestController 的连接以传输文件。

下面是 HtmlController 的方法：

```
@RequestMapping(value = "/add", method = RequestMethod.POST)
public String addCardprovider(
        @ModelAttribute("cardproviderAttribute") Cardprovider cardprovider,
        Model model) {

    // Prepare acceptable media type
    List<MediaType> acceptableMediaTypes = new ArrayList<MediaType>();
    acceptableMediaTypes.add(MediaType.APPLICATION_XML);

    // Prepare header
    HttpHeaders headers = new HttpHeaders();
    headers.setAccept(acceptableMediaTypes);
    // Pass the new person and header
    HttpEntity<Cardprovider> entity = new HttpEntity<Cardprovider>(
            cardprovider, headers);

    // Send the request as POST
    try {
        // Save Cardprovider details
        ResponseEntity<Cardprovider> response = restTemplate.exchange(
                "http://localhost:8080/api/cardprovider", HttpMethod.POST,
                entity, Cardprovider.class);

        // Save Cardprovider logo
        String tempDir = System.getProperty("java.io.tmpdir");
        File file = new File(tempDir + "/" + cardprovider.getLogo().getOriginalFilename());
        cardprovider.getLogo().transferTo(file);

        MultiValueMap<String, Object> parts = new LinkedMultiValueMap<String, Object>();
        parts.add("id", response.getBody().getId());
        parts.add("name", response.getBody().getName());
        parts.add("logo", new FileSystemResource(file));

        restTemplate.postForLocation("http://localhost:8080/api/cardprovider/logo", parts);

    } catch (Exception e) {
        e.printStackTrace();
    }

    // This will redirect to /web/cardprovider/getall
    return "redirect:/web/cardprovider/getall";
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T23:12:02.470

我对春天一无所知。在我的圈子中，使用 Apache Commons HttpClient 执行此类任务是常见的做法。

**更新**

当然 Spring 对此提供了支持 - 抱歉，我忽略了最明显的：[RestTemplate](http://static.springsource.org/spring/docs/3.2.x/javadoc-api/org/springframework/web/client/RestTemplate.html)！

XML:

```
<bean id="restTemplate" class="org.springframework.web.client.RestTemplate">
 <property name="messageConverters">
  <list>
   <bean class="org.springframework.http.converter.StringHttpMessageConverter" />
   <bean class="org.springframework.http.converter.FormHttpMessageConverter" />
  </list>
 </property>
</bean> 
```

爪哇：

```
MultiValueMap<String, Object> form = new LinkedMultiValueMap<String, Object>();
form.add("key", value);
...
form.add("file", new FileSystemResource(file));
restTemplate.postForLocation(url, form); 
```

# c++ - PostMessage 只能工作一次？

> ID：14762665
> 
> 赞同：0
> 
> 时间：2013-02-07T22:56:20.037
> 
> 标签：c++, winapi

我正在尝试将消息从全局 WindowProc 函数发送到 GUI 类。消息定义如下：

```
#define WM_ENV_RESIZED (WM_APP + 0) 
```

我的 WindowProc 函数看起来像这样

```
LRESULT CALLBACK windowProcedure(HWND hWnd, UINT message, WPARAM wParam, LPARAM lParam)
{
    int res;
    switch (message)
    {
        case WM_SIZE:
            std::cout << "window resized" << std::endl;

            res = PostMessage(hWnd, WM_ENV_RESIZED, 0, 0);
            if ( res == 0 )    //<-- res is never 0
            {
                std::cout << "PostMessage failure!" << std::endl;
                std::cout << "Error code: " << GetLastError() << std::endl;
            }
            break;
        default:
            return DefWindowProc(hWnd, message, wParam, lParam);
    }

    return DefWindowProc(hWnd, message, wParam, lParam);
} 
```

然后在 GUI 类中接收到消息，如下所示：

```
MSG msg;
while (running)
{
    while ( PeekMessage(&msg, NULL, 0, 0, PM_REMOVE) )
        processWindowsMessage(&msg);

    //DirectX render calls
} 
```

现在我的问题是 PeekMessage() 从未收到该消息。它仅在创建窗口时收到一次。之后就再也没有收到了。

在 PostMessage() 之后直接调用 GetLastError() 总是返回错误代码 6，根据[MSDN](http://msdn.microsoft.com/en-us/library/windows/desktop/ms681382%28v=vs.85%29.aspx) ，它代表 ERROR_INVALID_HANDLE 。但这没有任何意义，因为 PostMessage() 永远不会返回 0，这意味着在发布过程中出现了问题。我尝试绕过消息队列并使用 SendMessage() 将消息直接发送到窗口，但始终返回 0（具有相同的错误代码 6..）。

我真的不知道我做错了什么。使用 PeekMessage() 时，如何确保始终收到已发布的消息？

**编辑：** 我已经按照 Remy 的建议更新了消息循环。下面是 processWindowsMessage() 中的代码

```
void Environment::processWindowsMessage( MSG *msg )
{
    switch ( msg->message )
    {
        case WM_ENV_RESIZED:
            std::cout << "WM_ENV_RESIZED caught" << std::endl;
            break;
        case WM_QUIT:
            running = false;
            break;
        default:
            TranslateMessage(msg);
            DispatchMessage(msg);
            break;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T03:59:16.677

由于您的消息被发布到正在调整大小的同一窗口，因此`DispatchMessage()`会将消息发送到窗口的过程，就像针对该窗口的任何其他消息一样。所以要么：

1）处理内部的消息`windowProcedure()`：

```
LRESULT CALLBACK windowProcedure(HWND hWnd, UINT message, WPARAM wParam, LPARAM lParam)
{
    switch (message)
    {
        case WM_SIZE:
            std::cout << "window resized" << std::endl;

            if (!PostMessage(hWnd, WM_ENV_RESIZED, 0, 0))
            {
                std::cout << "PostMessage failure!" << std::endl;
                std::cout << "Error code: " << GetLastError() << std::endl;
            }
            break;

        case WM_ENV_RESIZED:
            std::cout << "env resized" << std::endl;
            //...
            return 0;
    }

    return DefWindowProc(hWnd, message, wParam, lParam);
} 
```

.

```
MSG msg;
while (running)
{
    while (PeekMessage(&msg, NULL, 0, 0, PM_REMOVE) )
    {
        TranslateMessage(&msg);
        DispatchMessage(&msg);
    }

    //DirectX render calls
} 
```

2）如果您不想在窗口过程中处理自定义消息，则更改消息循环以将`TranslateMessage()`and`DispatchMessage()`调用移入`processWindowsMessage()`并仅对非自定义消息调用它们，不要翻译/发送自定义消息：

```
LRESULT CALLBACK windowProcedure(HWND hWnd, UINT message, WPARAM wParam, LPARAM lParam)
{
    switch (message)
    {
        case WM_SIZE:
            std::cout << "window resized" << std::endl;

            if (!PostMessage(hWnd, WM_ENV_RESIZED, 0, 0))
            {
                std::cout << "PostMessage failure!" << std::endl;
                std::cout << "Error code: " << GetLastError() << std::endl;
            }
            break;
    }

    return DefWindowProc(hWnd, message, wParam, lParam);
} 
```

.

```
MSG msg;
while (running)
{
    while (PeekMessage(&msg, NULL, 0, 0, PM_REMOVE))
        processWindowsMessage(&msg);

    //DirectX render calls
} 
```

.

```
void processWindowsMessage(MSG *msg)
{
    switch (msg->message)
    {
        case WM_ENV_RESIZED:
            std::cout << "env resized" << std::endl;
            //...
            break;

        default:
            TranslateMessage(msg);
            DispatchMessage(msg);
            break;
    }
} 
```

# sockets - Unix和python套接字模块？

> ID：14762670
> 
> 赞同：0
> 
> 时间：2013-02-07T22:56:42.967
> 
> 标签：sockets, unix

我刚刚遇到了套接字和 python 套接字模块（而且对 python 很陌生！）。`AF_UNIX`和`SOCK_STREAM`变量（？）用于什么？我在一些代码中找到了它们（在类的方法中）：

```
self._sock = socket.socket(socket.AF_UNIX, socket.SOCK_STREAM) 
```

这个任务是做什么的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T23:36:47.267

`AF_UNIX`正在将套接字配置为[unix 套接字](http://en.wikipedia.org/wiki/Unix_domain_socket)。unix 套接字是同一系统上的两个进程相互通信的机制。如果它被设置为`AF_INET`它将是一个 TCP/IP 套接字。

`SOCK_STREAM`正在配置进程应如何通过套接字进行通信，在这种情况下，进程交换字节流。见[这里](http://publib.boulder.ibm.com/infocenter/pseries/v5r3/index.jsp?topic=/com.ibm.aix.progcomm/doc/progcomc/skt_types.htm)。

您还应该查看[python socket docs](http://docs.python.org/2/library/socket.html)，因为它们非常好。

# jquery - 根据选项值隐藏 div

> ID：14762671
> 
> 赞同：-2
> 
> 时间：2013-02-07T22:56:43.873
> 
> 标签：jquery

如何更改它以隐藏与选项值匹配的所有 div，第一个 div 除外？

到目前为止，我所做的是在做出选择之前隐藏所有 div，但是我需要在用户做出选择之前显示第一个 div。

[http://jsfiddle.net/infatti/fj63g/](http://jsfiddle.net/infatti/fj63g/)

```
$('.dd-show-hide').find('option').each(function(){
    $('#' + this.value).hide();
});

$('.dd-show-hide').change(function(){
   $(this).find('option').each(function(){
      $('#' + this.value).hide();
    });
    $('#' + this.value).show();
});

<select class="dd-show-hide">
    <option>Choose</option>
    <option value="div1">Show Div 1</option>
    <option value="div2">Show Div 2</option>
    <option value="div3">Show Div 3</option>
</select>

<div  id="div1" class="drop-down-show-hide">div 1</div>
<div  id="div2" class="drop-down-show-hide">div 2</div>
<div  id="div3" class="drop-down-show-hide">div 3</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T22:58:53.007

replacing `$('.dd-show-hide').find('option')` with `$('.dd-show-hide').find('option:gt(1)')` should be ok

# version-control - 使用 Team Foundation Server 的网站项目

> ID：14762672
> 
> 赞同：7
> 
> 时间：2013-02-07T22:56:45.420
> 
> 标签：version-control, tfs, web-site-project, web-application-project, azure-devops

是否可以在 Team Foundation Server 中使用网站项目而不是 Web 应用程序项目？我看到添加 Web 应用程序很容易，但找不到如何在网站项目中使用版本控制。对此的任何帮助将不胜感激，因为我已经搜索过并且没有找到任何解决方案。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-08T00:15:49.220

正如约翰桑德斯所说，避免像瘟疫这样的网站项目。您可以通过右键单击站点并选择“转换为 Web 应用程序”将您的站点转换为应用程序，但请注意，您需要对项目结构和代码进行一些返工。

如果这不是一个选项，那么您可以通过右键单击解决方案资源管理器中的解决方案并选择“将解决方案添加到源代码管理”来将它们添加到 TFS

这会将解决方案和其中包含的任何项目添加到 TFS，包括网站。它将在 .sln 文件中创建 TFS 绑定

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-29T17:55:39.160

我在同一条船上，需要 TFS 中的网站。

我的解决方案是在 TFS 中创建一个空白解决方案，然后将网站添加到该解决方案中。

# ios - 如何使用点符号内的字符串访问属性？

> ID：14762673
> 
> 赞同：0
> 
> 时间：2013-02-07T22:56:46.463
> 
> 标签：ios, objective-c, syntax, properties

查看以下代码：

```
@property (weak, nonatomic) UILabel *l112;
@property (weak, nonatomic) UILabel *l212:
@property (weak, nonatomic) UILabel *l312:

((RBScorecardVC *)self.presentingViewController).l112.text = @"Hello"
((RBScorecardVC *)self.presentingViewController).l212.text = @"Hello"
((RBScorecardVC *)self.presentingViewController).l312.text = @"Hello" 
```

请注意我如何将标签的所有文本设置为“Hello”。必须有一种更有效的方法来做到这一点。我希望我能以某种方式访问​​ UIlabels 的名称（l112、1212 等）来做到这一点。这有意义吗？在我的实际应用程序中，我并没有真正将所有内容都设置为“Hello”，而是文本是计算的结果。此外，在我的实际应用程序中，我要设置超过 3 个标签（有 50 多个）这是我的实际代码，它使用重复的 if 语句单独访问每个 UILabel：

```
-(IBAction) submitScore: (id)sender
{
self.stringID = ((RBScorecardVC *)self.presentingViewController).self.giveString;

if (self.stringID isEqualToString:@"l112")
{ ((RBScorecardVC *)self.presentingViewController).l112.text = [[NSString alloc]initWithFormat:@"%d", self.accumulator];} //l112 is the name of my UILabel
else if (self.stringID is EqualToString:@"l212")
{ ((RBScorecardVC *)self.presentingViewController).l212.text = [[NSString alloc]initWithFormat:@"%d", self.accumulator];} //l212 is the name of my UILabel
} 
```

我希望能够像这样更有效地做到这一点：

```
-(IBAction) submitScore: (id)sender
 self.stringID = ((RBScorecardVC *)self.presentingViewController).self.giveString;

 ((RBScorecardVC *)self.presentingViewController).[UILabel withTitle:@"%@",stringID].text = [[NSString alloc]initWithFormat:@"%d", self.accumulator];} 
```

注意我在点符号中使用的 [UILabel withTitle: @"%@", stringID] 部分。我知道这不起作用，但我想知道如何正确编写它，以便可以使用 stringID 访问我需要的 UILabel 的名称？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-07T23:01:59.620

尝试`valueForKey:`在您的 UILabel 上使用。

但是，更简洁的解决方案可能是将这些属性简单地存储在 NSDictionary 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T23:26:18.763

这里的其他答案涉及对象的属性。在这种情况下，您尝试访问对象本身。当您开始问自己这样的问题时，您应该只将所有对象（在本例中为标签）存储在数组属性中，而不是每个标签的单独属性中。与其将标签视为/引用标签作为命名变量`l112`，不如将它们视为数组中的索引：

> UILabel *theLabelINeed = [self.myArray objectAtIndex:2]; [theLabelINeed callWhateverMethodINeedTo];

或者更短，如果你来自 python/ruby 背景，这对你来说更具可读性：

> [self.myArray[2] callWhateverMethodINeedTo];

如果您需要快速访问数组中的每个标签，您可以在 for 循环中使用快速枚举：

```
for (UILabel *currLabel in self.myArray) {
    [currLabel callWhateverMethodINeedTo];
} 
```

您也可以使用 an `NSDictionary`instead，它可以让您将“键”或名称分配给对象。

```
NSDictionary *dict {"l112": label1, "l113": label2}; // or some other dictionary creation method, maybe a mutable dictionary or whatever.
UILabel *myLabel = [dict objectForKey:@"l112"]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T23:06:17.603

为什么要使用点表示法——最初是为对象@properties 设计的——用于其他东西？

请参阅[点表示法与方法表示法](https://stackoverflow.com/questions/11386256/dot-notation-vs-method-notation)

您似乎对 Objective-C 语法感到困惑：为什么`[UILabel withTitle:"%@", stringId]`不是更简单`[UILabel withTitle:stringID]`，或者如果 stringId 不是字符串，`[UILabel withTitle:[NSString stringWithFormat:@"%@", stringID]]`

另外，为什么是`withTitle`类方法`UILabel`而不是您的实例方法`presentingViewController`？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-07T23:20:18.793

这样的事情可能会满足您的要求，但我同意使用 NSDictionary 的答案可能更易于维护。或者，您可以在 IB 中的标签上使用整数标记属性并调用父视图的 viewWithTag: 方法。

```
- (UILabel *)labelWithName:(NSString *)name
{
    SEL selector = NSSelectorFromString(name);
    if (![self respondsToSelector:selector])
        return nil;

#pragma clang diagnostic push
#pragma clang diagnostic ignored "-Warc-performSelector-leaks"
    id result = [self performSelector:selector];
#pragma clang diagnostic pop
    if (!result)
        return nil;
    if (![result isKindOfClass:[UILabel class]])
        return nil;
    return (UILabel *)result;
}

- (IBAction)derp:(id)sender
{
    UILabel *label = [self labelWithName:@"label1"];
    [label setText:@"I'm label 1"];
    label = [self labelWithName:@"label2"];
    [label setText:@"I'm label 2"];
} 
```

# php - jQuery 使用 FormData 上传 PDF？

> ID：14762675
> 
> 赞同：1
> 
> 时间：2013-02-07T22:56:58.083
> 
> 标签：php, javascript, jquery

我试图通过 jQuery 将文件上传到我的远程服务器，但我似乎无法让它工作。

用户需要能够上传 pdf 文件，然后由服务器处理并保存到根文件夹。

**jQuery**

```
$('form').submit(function (e) {
    var fd = new FormData();
    fd.append('file', $('#file')[0].files[0]);
    $.ajax({
        cache: false,
        beforeSend: function (xhr) {
            xhr.setRequestHeader("Cache-Control", "no-cache");
            xhr.setRequestHeader("pragma", "no-cache");
        },
        url: 'http://www.codekraken.com/testing/pointify/test.php?callback=?',
        data: fd,
        dataType: "json",
        processData: false,
        contentType: false,
        type: 'POST',
        success: function (data) {
            console.log(data);
        },
        error: function (data) {
            console.log(data);
        }
    });
    e.preventDefault();
}); 
```

**PHP**

```
<?php
header('content-type: application/json; charset=utf-8');

$name = $_FILES["fd"]["name"];
echo ($_GET['callback'] . '('.json_encode($name).')');
?> 
```

**HTML**

```
<form>
    <input type="file" id="file" name="file">
    <input type="submit">
</form> 
```

当我提交文件时，例如`input.pdf`然后按提交，我得到了响应`(null)`。我希望得到文件的名称`input.pdf`，这意味着我错过了这个过程中的关键步骤。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T23:19:49.640

我猜这个

```
$name = $_FILES["fd"]["name"]; 
```

应该

```
$name = $_FILES["file"]["name"]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T23:53:45.223

我只是想让这个可见，所以我正在回答这个问题的主要问题。

`JSONP`仅用于请求，因此`POST`无法使用。随后，您可以使用`CORS`来解决问题。

[我找到了一个网站](http://enable-cors.org/index.html)，其中列出了您可以启用的多种类型的服务器，`CORS`我建议您查看一下。

就我而言，我在 PHP 代码中使用了以下标头：

```
header("Access-Control-Allow-Origin: *"); 
```

这会为所有请求打开该页面，但它仍然无法使用我的 jQuery`AJAX`代码。为了解决这个问题，我不得不删除设置标头的代码部分，这在发出这些请求时显然是不允许的。所以，我删除了这部分：

```
beforeSend: function (xhr) {
            xhr.setRequestHeader("Cache-Control", "no-cache");
            xhr.setRequestHeader("pragma", "no-cache");
        }, 
```

# templates - Joomla 模块和显示位置不显示

> ID：14762676
> 
> 赞同：0
> 
> 时间：2013-02-07T22:57:12.157
> 
> 标签：templates, joomla, module, position

我正在使用 Joomla 1.5.26 的安装，并且已经安装并默认了 JTouch 模板（版本 1.5.2-stable）。我发现`?tp=1`主页地址末尾的命令运行良好（显示模块位置等），但该命令在任何其他页面上都不起作用。

此外，可能沿着相同的思路，我有一个模块，我想在主页以外的页面上激活（在位置`jtouch-top`）所以我将此模块分配给我想要的页面的菜单项，但它仍然不是显示...即使菜单项也显示该模块应该处于活动状态...如果我希望模块显示在主页上，此过程可以正常工作。

这个模板可能会破坏除主页之外的每个页面的这些 Joomla 功能吗？

该站点的地址是：（`http://198.1.124.170/~lawson2/`这是在开发服务器上，因此还没有实际的 www 地址。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T10:28:23.807

你试过这样做吗？

[http://www.lawsonsp.com/lawson-equipment?tp=1](http://www.lawsonsp.com/lawson-equipment?tp=1)

我可以看到模板位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T23:10:42.783

关于您的第一个问题，URL 参数由 & 分隔，而不是？。所以不会让我发布 IP 链接，所以在第一个斜线之后试试这个：

```
?jtouchTemplateSelector=yoo_enterprise&jtpl=yoo_enterprise&tp=1 
```

更新：这是一个直接链接：[http ://tinyurl.com/a4uc6yc](http://tinyurl.com/a4uc6yc)

至于您的后续问题，如果没有更多信息，很难说。模块发布了吗？

更新：知道您正在专门对移动模板进行故障排除，我会查看位置映射。根据我的经验，模板开发人员不一定会为移动设备加载相同的位置，有些甚至可能不存在。例如，RocketTheme 在其控制面板中内置了特定的映射。

# sql - 关于 SQL 和复杂性

> ID：14762677
> 
> 赞同：0
> 
> 时间：2013-02-07T22:57:13.377
> 
> 标签：sql, database-design, aggregate-functions, data-modeling

我创建了一个带有字段 X 和字段 DATE 的 SQL 表。我想计算 DATE < d 的 X 的总和。我有两种可能：

*   创建一个新字段，“sum of X”，表示当 date < date[field] 时 X 的总和
*   使用 SQL 请求“手动”计算 X 的总和

有没有一种永远优越的方法？或者，如果不是，我认为这取决于表的大小。使这两种方法相等的近似大小是多少？

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T00:46:34.947

> 有没有一种永远优越的方法？

不会。但总的来说，坚持使用最简单的解决方案，直到您发现它不再起作用。在这种情况下，最简单的解决方案是每次需要时计算派生字段。

> 或者，如果不是，我认为这取决于表的大小。

是的。以及插入次数与读取次数。以及日期是否单调递增。以及系统及其要求的空间（内存/磁盘）与时间（处理能力）的权衡。可能还有很多其他的事情。

> 使这两种方法相等的近似大小是多少？

一段绳子有多长？太多其他变量无法回答这个问题。

重复一遍：坚持简单，直到被迫做其他事情。维护缓存值会引入复杂性和极端情况：您的事务边界是什么？如果添加新行会发生什么？这可能会触发后续事务以检测和更新受影响的行。如果您随后回滚原始事务会发生什么？

这*更*符合逻辑。出错的可能性更大。坚持使用[YAGNI](http://en.wikipedia.org/wiki/You_aren%27t_gonna_need_it)，直到你发现你做到了。

hth。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T13:48:59.837

不要存储计算字段以避免数据不一致。当您有这样的问题时，请考虑您的模型以及是否应该发展以使该问题过时。

# c# - How should i structure my View Model - ASP.NET MVC

> ID：14762680
> 
> 赞同：1
> 
> 时间：2013-02-07T22:57:17.550
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, model-view-controller, viewmodel

I am wanting to create a survey using ASP.NET MVC 3.0\. Some questions will have radio buttons and some check boxes. I want to know the correct syntax for my View side as well as my ViewModel. I want to store my options for the answers in a Collection. Would IEnumerable be a good collection to use? Here is some of my ViewModel code.

```
 [DisplayName("Country")]
    [Required(ErrorMessage = "Country is required.")]
    public string Country { get; set; }

    public IEnumerable<string> Countries { get; set; }

    [DisplayName("Business")]
    [Required(ErrorMessage = "Please select a business unit.")]
    public string BusinessUnit { get; set; }

    public IEnumerable<string> Businesses { get; set; }

    public Boolean ToGetFit { get; set; }
    public Boolean ToChallengeMyself { get; set; }      
    public Boolean ToBeHealthier { get; set; }
    public Boolean ChallengeOther { get; set; }
    public string OtherString { get; set; }

    public void build()
    {
        var myService = new SurveyService(new SurveyRepository());
        Name = myService.getName();
        Email = myService.getEmail();
    } 
```

What is the best way to get the information into my ViewModel when my build method is called? Should i be using IEnumerable or just strings?

here is my code on my .aspx page.

```
<li>    What country do you live in? <br />   
    <%= Html.RadioButtonFor(model => model.Country, "Canada", true) %> Ecuador<br />   
    <%= Html.RadioButtonFor(model => model.Country, "Chile", true) %> Ghana   <br />
    <%= Html.RadioButtonFor(model => model.Country, "Italy", true) %> Nigeria   <br />
    <%= Html.RadioButtonFor(model => model.Country, "Germany", true) %> Romania   
</li>

<li> What business unit do you work in?<br />
    <%= Html.RadioButtonFor(model => model.BusinessUnit, "Pharmaceuticals", true ) %> Pharmaceuticals <br />        
    <%= Html.RadioButtonFor(model => model.BusinessUnit, "Mechanics", true) %> Vaccines  <br />
    <%= Html.RadioButtonFor(model => model.BusinessUnit, "R&D") %> R&D   <br />
    <%= Html.RadioButtonFor(model => model.BusinessUnit, "Distribution", true) %> Distribution   <br />
</li>           

<li>    Why do you want to take part in this workout? <br />
    <%= Html.CheckBoxFor(model => model.ToGetFit ) %>   To get in shape   <br />
    <%= Html.CheckBoxFor(model => model.ToChallengeMyself ) %> To challenge myself     <br />       
    <%= Html.CheckBoxFor(model => model.ToBeHealthier) %>   To be healthier     <br />
    <%= Html.CheckBoxFor(model => model.ChallengeOther) %>  Other  
    <%= Html.TextBoxFor(model => model.OtherString) %>
</li> 
```

I am new to ASP.NET MVC but I have experience with both ASP.NET and the MVC pattern. I want as much emphasis placed on seperation of concerns as possible.

My controller class calls my build method. I have a Service class which grabs a Repository object which will be grabbing information from my Model/Database.

! I want my Radio buttons to be dynamically taken from my Database. And then if the user already has something selected from a previous session i want that to be found in my ViewModel and already selected when they load the page.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T15:14:35.270

我在上面的方法中看到的问题是您的单选按钮和复选框是在您的视图中定义的。如果它们来自数据库或枚举或其他东西，这显然是一个问题。您应该做的是添加一个 ViewModel 属性，该属性表示给定单选/复选框组的所有可能选项，以及一个包含用户为该组选择的选定值的属性。

首先，查看“ [CheckBoxListFor](http://twentyeighttwelve.com/checkboxlist-helper-extension-method-asp-net-mvc-3/) ”和“ [RadioButtonListFor ”的这些](http://jonlanceley.blogspot.com/2011/06/mvc3-radiobuttonlist-helper.html)**GREAT**辅助方法。将它们复制到您的项目中。

接下来，您需要将 ViewModel 上的集合公开为`IEnumerable<SelectListItem>`. 这些是您的 radiolist/checkboxlist/dropdown 元素的可能选项。

然后，您的 ViewModel，您将需要为单个选定选项（来自下拉列表或单选按钮列表）或选定选项的集合（来自复选框列表）定义一个道具。您可以使用项目数据库 ID 中的 int/string，或者如果要选择的类型是枚举，则可以直接绑定到它。

最后，您的视图变得超级简单，如果您添加新选项，则无需触摸。在数据库驱动选项的情况下，根本不需要更改任何代码。

以下是我打开的演示页面的示例。我相信您应该能够查看它并将其应用到您自己的项目中。

**视图模型：**

```
public class OrderViewModel
    {
        public int FavoriteMovieID { get; set; }
        public List<int> MovieIdsForMoviesILike { get; set; }

        public MovieCategories FavoriteMovieType { get; set; }
        public List<MovieCategories> MovieCategoriesILike { get; set; }

        public IEnumerable<SelectListItem> MoviesToSelectFrom 
        {
            get
            {
                return from x in OrderDetailsRepo.GetAllMovies()
                       select new SelectListItem {
                           Text = x.Title,
                           Value = x.ID.ToString(),
                           Selected = MovieIdsForMoviesILike.Contains(x.ID),
                       };
            }
        }

        public IEnumerable<SelectListItem> MovieCategoriesToSelectFrom
        {
            get
            {
                return from cat in Enum.GetValues(typeof(MovieCategories)).Cast<MovieCategories>()
                       select new SelectListItem {
                           Text = cat.ToString(),
                           Value = cat.ToString(),
                           Selected = MovieCategoriesILike.Contains(cat),
                       };
            }
        }

        public OrderViewModel()
        {
            // to ensure they are never NULL
            MovieIdsForMoviesILike = new List<int>();
            MovieCategoriesILike = new List<MovieCategories>();
        }
} 
```

**域模型类和提供集合的方法：**

```
 public static class OrderDetailsRepo
        {
            public static List<Movie> GetAllMovies()
            {
                return new List<Movie> {
                    new Movie { ID = 0, Title = "Great Expectation" },
                    new Movie { ID = 1, Title = "Gone with the Wind" },
                    new Movie { ID = 2, Title = "Lion of Winter" },
                };
            }
        }

    public class Movie
        {
            public string Title { get; set; }
            public int ID { get; set; }
        }

    public enum MovieCategories
        {
            Horror,
            Drama,
            Comedy,
        } 
```

**以及超级简化的视图：**

```
@model MVC3App.ViewModels.OrderViewModel
@using MVC3App.MVCHtmlHelpers @* RadioButtonList and CheckBoxList are defined in here *@

@{
    ViewBag.Title = "ViewPage1";
}

<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>

@using (Html.BeginForm()) {
    @Html.ValidationSummary(true)

    <div class="editor-label">
        What's your favorite movie?
    </div>
    <div class="editor-field">
        @Html.RadioButtonListFor(model => model.FavoriteMovieID, Model.MoviesToSelectFrom)
        @Html.ValidationMessageFor(model => model.FavoriteMovieID)
    </div>

    <div class="editor-label">
        What movies do you like in general?
    </div>
    <div class="editor-field">
        @Html.CheckboxListFor(model => model.MovieIdsForMoviesILike, Model.MoviesToSelectFrom)
        @Html.ValidationMessageFor(model => model.MovieIdsForMoviesILike)
    </div>

    <div class="editor-label">
        What's your favorite Movie Genre?
    </div>
    <div class="editor-field">
        @Html.RadioButtonListFor(model => model.FavoriteMovieType, Model.MovieCategoriesToSelectFrom)
        @Html.ValidationMessageFor(model => model.FavoriteMovieType)
    </div>

    <div class="editor-label">
        What Movie Genres do you like in general?
    </div>
    <div class="editor-field">
        @Html.CheckboxListFor(model => model.MovieCategoriesILike, Model.MovieCategoriesToSelectFrom)
        @Html.ValidationMessageFor(model => model.MovieCategoriesILike)
    </div>

    <br /><br />
    <input type="submit" value="Save" />
} 
```

# javascript - How to access OAuth 2.0, REST API in GNOME 3.0 shell extension?

> ID：14762682
> 
> 赞同：5
> 
> 时间：2013-02-07T22:57:26.233
> 
> 标签：javascript, rest, gnome-shell-extensions, oauth2client

How would I port the OAuth 2.0 implict grant flow from a browser environment if I wanted to access the REST API beneath it through a GNOME shell extension ? How would I redirect the user to the OAuth 2.0 decision endpoint through a login screen?

If it isn't possible with a OAuth 2.0 REST API in what other way can I integrate a web service with a shell extension?

# cookies - Are cookies stored per App?

> ID：14762684
> 
> 赞同：0
> 
> 时间：2013-02-07T22:57:41.273
> 
> 标签：cookies, browser, windows-phone

Are cookies in Windows Phone stored on a per-App basis? And if yes: how can I clear the cookies which are stored by an App (given I control the source code of this App)?

And phrased from a slightly different angle: If I clear the history in the phone's Internet Explorer are cookies in Apps (that embed the web browser control) deleted, too?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T09:08:04.597

> Windows Phone 中的 cookie 是按应用程序存储的吗？

是的，它们是按应用程序存储的。这意味着您可以在 IE 中使用一个 Facebook 帐户登录，在 App X 中使用另一个帐户，在 App Y 中使用第三个帐户登录。

> 如何清除应用程序存储的 cookie

据我所知，没有简单的方法可以做到这一点。也许你应该试试：

*   [在 Windows Phone 7 上清除 Cookie](http://www.codeproject.com/Articles/120763/Clearing-Cookies-on-Windows-Phone-7-or-How-to-Log)
*   [Facebook 注销 Windows Phone 应用程序而不打开 WebBrowser](https://stackoverflow.com/questions/14551662/facebook-logout-windows-phone-application-without-opening-webbrowser)

> 如果我清除手机 Internet Explorer 中的历史记录，是否也会删除应用程序（嵌入 Web 浏览器控件）中的 cookie？

不，来自 IE 的 cookie 与`WebBrowser`控件存储的 cookie 不同。

# objective-c - Objective C 中的部分屏幕截图

> ID：14762686
> 
> 赞同：2
> 
> 时间：2013-02-07T22:57:43.943
> 
> 标签：objective-c, macos, xcode4, core-graphics, screenshot

我一直在试图弄清楚如何在目标 C 中创建一个 OS X 例程：

*   在后台运行（单独的线程）和

*   重复（定时或满足某些条件时）捕获指定窗口/屏幕的几个定义子集（即没有用户交互）和

*   将图像保存到指定路径。

类似于“cmd-shift-4 + mouseDown-drag 的预编程循环”的输出。

Mac Developer Library 中的 SonofGrab 和 ScreenSnapshot 似乎都没有表明如何做到这一点，但我怀疑 CGImageRef 是一种/（？）方法。

1.  有谁知道该怎么做？

2.  除了 CGImageRef 还有其他可能的方法来解决这个问题吗？例如，它可以通过命令行工具和 NSTask 来完成吗？

3.  如果是这样，就速度和复杂性而言，不同方法的优点/缺点是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T00:31:12.980

假设您具有执行屏幕抓取所需的逻辑（您可以在 SonOfGrab 中看到），您只需使用调度队列或计时器来完成这项工作。

```
void MyTakeScreengrab();

dispatch_queue_t  queue    = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_BACKGROUND,  0);

dispatch_source_t timerSrc = dispatch_source_create(DISPATCH_SOURCE_TYPE_TIMER,0,0,queue);

dispatch_source_set_timer(timerSrc, 
      dispatch_time(DISPATCH_TIME_NOW,0) /* start on */,
      SECONDS_PER_GRAB * NSEC_PER_SEC /* interval */, 
      NSEC_PER_SEC /* leeway */);

dispatch_source_set_event_handler_f(timerSrc, MyTakeScreengrab);

dispatch_resume(timerSrc); 
```

您也可以使用 NSTimer。

```
-(void)setup {
    _timer = [[NSTimer scheduledTimerWithTimeInterval: (NSTimerInterval)SECONDS_PER_GRAB 
            target: self 
            selector: @selector(takeScreegrabOnBGThread:) 
            userInfo: @{ @"folderPath" : MyFolderPath(), 
                         @"imageSettings" : MYCGImageSettings() }  
            repeats: YES];
    [_timer fire];
}

-(void)takeScreengrabOnBGThread:(id)userInfo {
    [self performSelectorInBackground:@selector(takeScreengrabBlocking:) 
            withObject:userInfo];
}

-(void)takeScreengrabBlocking:(id)userInfo {

    MyTakeScreengab(userInfo);
} 
```

要使用终端执行此操作，您要查找的命令是`screencapture(1)`.

# c - total vertices without edges C

> ID：14762688
> 
> 赞同：0
> 
> 时间：2013-02-07T22:57:52.180
> 
> 标签：c, algorithm, graph

So I'am studying for my exam, and found the following question which i couldn't understood how to solve it:

The Graph:

```
 typedef struct NODE{
             int weight;
             int idEdge;
             int idDestination;
             struct NODO *next;
        }Node; 
```

And following this prototype:

```
 int totVertexWithoutEdges(Node **g, int totv) 
```

I must create the function that gives me the total number of vertex without edges but I have no ideia how to do it, can anyone just explain me how should I solve it, not asking for the answer just some steps to reach it.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T23:15:24.740

您的 totVertexWithoutEdges 只需要浏览您的 Node** g，这将是指向链表的指针的地址。

可能类似于（基于最后一个元素指向 NULL 的事实）

```
while (*g != NULL)
{
     // Check out what you want about your edge things
     g = &(*g)->next;
} 
```

但如果 totv 表示顶点数，则为

```
int   counter;

counter = 0;
while (counter < totv)
{
     // Check out what you want about your edge things
     g = &(*g)->next;
     counter = counter + 1;
} 
```

链表是一种众所周知的数据结构；），祝您练习顺利。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T23:14:36.833

一种方法是创建一个数组，每个节点有一个条目。最初，将此数组中的所有元素设置为 0。

然后，遍历所有边。对于每条边，将表示对应于源节点（和/或目标节点，具体取决于您如何解释问题）的数组元素的数组元素更改为 1。这标志着该节点有一条边与之相连。

最后，遍历数组并计算 0 条目的数量，它告诉您没有传入/传出边的节点总数。

希望这可以帮助！

# css - safari position css not working

> ID：14762694
> 
> 赞同：3
> 
> 时间：2013-02-07T22:58:31.603
> 
> 标签：css, safari, background-position

We are working on a new website and are having an issue with the "Join the Conversation" box in Safari only. Works fine on other browsers. The background is only suppose to appear on the bottom of the box, but in Safari, it displays on the entire box: [http://futurethink.colorandinformationdev.com](http://futurethink.colorandinformationdev.com)

The old dev site is here, and it displays fine on Safari and other browsers. I did a diff check between the home page and css, but can't figure this one out: [http://cool-quotes.org/future](http://cool-quotes.org/future)

```
#email_newsletter.home_content {
   background:#fff url(img/addons/news_letter_container_bg.png) repeat-x left bottom;
   overflow: hidden !important;
   border:1px solid #B3B3B3;
   /* */ 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-28T14:55:13.570

根据[W3Schools](http://www.w3schools.com/cssref/pr_background-position.asp)，您可以提供以下格式的值：

*   **右上/右中/右下**：只指定一个关键字
*   xpos ypos : 单位可以是像素 (0px 0px) 或任何其他[CSS 单位](http://www.w3schools.com/cssref/css_units.asp)
*   inherit ：指定 background-position 属性的设置应该从父元素继承

我也亲自尝试过你的东西，我发现它真的不适用于 Safari，但如果你真的有必要，并且如果你可以做下面提到的技巧，那么你的问题就解决了 :-)

**为你工作的[小提琴](http://jsfiddle.net/ZkBb2/)**

```
<!-- The CSS -->
<style type="text/css">
div {
background: url(https://www.google.co.in/images/srpr/logo4w.png) no-repeat scroll right bottom transparent;
margin-right: 100px;
}
p {
margin-right: -100px;
}
</style>

<!-- The HTML -->
<div>
    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. In euismod adipiscing elementum. In turpis ipsum, adipiscing vitae magna vitae, consequat hendrerit justo. Aliquam non facilisis dui, tempus convallis tortor. Donec ultricies pharetra tortor, a tempor magna commodo nec. Donec id justo ornare, ullamcorper est ac, aliquet justo. Duis rutrum justo a laoreet volutpat. Phasellus molestie consequat risus at varius. Aenean imperdiet ornare odio, a aliquam leo pharetra id. Integer lectus felis, semper id sapien viverra, dignissim molestie massa. Mauris blandit eros eget lorem cursus, sed consectetur lectus tincidunt. Cras tristique vel orci eu cursus. Sed congue tempor venenatis. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Maecenas vehicula nec eros sit amet mollis. Nam ipsum arcu, pretium et tempus ac, scelerisque sed nulla. Sed dapibus in massa in consequat.</p>
</div> 
```

干杯和好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-02T08:52:42.367

尝试这个 ！

```
#email_newsletter .home_content {
   background: #ffffff url('img/addons/news_letter_container_bg.png') left bottom repeat-x;
   width: 600px;
   height: 400px;
   float: left;
   overflow: hidden !important;
   border:1px solid #B3B3B3;
   /* */ 
  } 
```

# php - PHP array to JSON plotting column chart with Google Chart Tools

> ID：14762701
> 
> 赞同：0
> 
> 时间：2013-02-07T22:58:56.813
> 
> 标签：php, json, api

I've already read multiple questions/answers here and on other websites but I just can't get it to work.

I have a database containing Date and Count. With PHP I've constructed a nested array which when encoded becomes valid json. At least according to [http://jsonlint.com/](http://jsonlint.com/). The json (from what I can see) looks like the ones on [https://google-developers.appspot.com/chart/interactive/docs/php_example](https://google-developers.appspot.com/chart/interactive/docs/php_example).

The only thing I'm trying to do is create a column chart with Google API (shouldn't be so hard)... I want Count (quantity) on the y-axis and the date on the x-axis.

Here's one json output example (believe me I've tried several):

> {"cols":[{"id":"","label":"Date","type":"date"},{"id":"","label":"Count","type":"number"}],"rows":[{"c":[{"v":"2013-02-08"},{"v":"13"}]},{"c":[{"v":"2013-02-09"},{"v":"80"}]},{"c":[{"v":"2013-02-10"},{"v":"2021"}]},{"c":[{"v":"2013-02-11"},{"v":"18"}]},{"c":[{"v":"2013-02-12"},{"v":"8"}]},{"c":[{"v":"2013-02-13"},{"v":"4"}]},{"c":[{"v":"2013-02-14"},{"v":"687"}]},{"c":[{"v":"2013-02-15"},{"v":"6674"}]},{"c":[{"v":"2013-02-16"},{"v":"656"}]},{"c":[{"v":"2013-02-17"},{"v":"646"}]},{"c":[{"v":"2013-02-18"},{"v":"672"}]},{"c":[{"v":"2013-02-19"},{"v":"656"}]},{"c":[{"v":"2013-02-20"},{"v":"653"}]},{"c":[{"v":"2013-02-21"},{"v":"697"}]},{"c":[{"v":"2013-02-22"},{"v":"696"}]},{"c":[{"v":"2013-02-23"},{"v":"679"}]},{"c":[{"v":"2013-02-24"},{"v":"647"}]},{"c":[{"v":"2013-02-25"},{"v":"638"}]},{"c":[{"v":"2013-02-26"},{"v":"636"}]},{"c":[{"v":"2013-02-27"},{"v":"629"}]},{"c":[{"v":"2013-02-28"},{"v":"644"}]},{"c":[{"v":"2013-03-01"},{"v":"5648"}]},{"c":[{"v":"2013-03-02"},{"v":"4378"}]},{"c":[{"v":"2013-03-03"},{"v":"664"}]},{"c":[{"v":"2013-03-04"},{"v":"663"}]},{"c":[{"v":"2013-03-05"},{"v":"630"}]},{"c":[{"v":"2013-03-06"},{"v":"640"}]},{"c":[{"v":"2013-03-07"},{"v":"16"}]},{"c":[{"v":"2013-03-08"},{"v":"25"}]},{"c":[{"v":"2013-03-09"},{"v":"31"}]},{"c":[{"v":"2013-03-10"},{"v":"324"}]},{"c":[{"v":"2013-03-11"},{"v":"9"}]},{"c":[{"v":"2013-03-12"},{"v":"22"}]},{"c":[{"v":"2013-03-13"},{"v":"23"}]},{"c":[{"v":"2013-03-14"},{"v":"31"}]},{"c":[{"v":"2013-03-15"},{"v":"29"}]},{"c":[{"v":"2013-03-16"},{"v":"40"}]},{"c":[{"v":"2013-03-17"},{"v":"15"}]},{"c":[{"v":"2013-03-18"},{"v":"5"}]},{"c":[{"v":"2013-03-19"},{"v":"13"}]},{"c":[{"v":"2013-03-20"},{"v":"24"}]},{"c":[{"v":"2013-03-21"},{"v":"53"}]},{"c":[{"v":"2013-03-22"},{"v":"808"}]},{"c":[{"v":"2013-03-23"},{"v":"59"}]},{"c":[{"v":"2013-03-24"},{"v":"24"}]},{"c":[{"v":"2013-03-25"},{"v":"2"}]},{"c":[{"v":"2013-03-26"},{"v":"16"}]},{"c":[{"v":"2013-03-27"},{"v":"1546"}]},{"c":[{"v":"2013-03-28"},{"v":"1554"}]},{"c":[{"v":"2013-03-29"},{"v":"1587"}]},{"c":[{"v":"2013-03-30"},{"v":"1570"}]},{"c":[{"v":"2013-03-31"},{"v":"1552"}]},{"c":[{"v":"2013-04-01"},{"v":"1559"}]},{"c":[{"v":"2013-04-02"},{"v":"1568"}]},{"c":[{"v":"2013-04-03"},{"v":"1566"}]},{"c":[{"v":"2013-04-04"},{"v":"1574"}]},{"c":[{"v":"2013-04-05"},{"v":"1558"}]},{"c":[{"v":"2013-04-06"},{"v":"1626"}]},{"c":[{"v":"2013-04-07"},{"v":"1562"}]},{"c":[{"v":"2013-04-08"},{"v":"1536"}]},{"c":[{"v":"2013-04-09"},{"v":"1565"}]},{"c":[{"v":"2013-04-10"},{"v":"1551"}]},{"c":[{"v":"2013-04-11"},{"v":"1547"}]},{"c":[{"v":"2013-04-12"},{"v":"1628"}]},{"c":[{"v":"2013-04-13"},{"v":"1541"}]},{"c":[{"v":"2013-04-14"},{"v":"1515"}]},{"c":[{"v":"2013-04-15"},{"v":"1537"}]},{"c":[{"v":"2013-04-16"},{"v":"1536"}]}]}

And the API script

```
// Load the Visualization API and the piechart package.
google.load('visualization', '1', {'packages':['corechart']});

// Set a callback to run when the Google Visualization API is loaded.
google.setOnLoadCallback(drawChart);

function drawChart() {
  var jsonData = $.ajax({
      url: "chartjson.php",
      dataType:"json",
      async: false
      }).responseText;

  // Create our data table out of JSON data loaded from server.
  var data = new google.visualization.DataTable(jsonData);

  // Instantiate and draw our chart, passing in some options.
  var chart = new google.visualization.ColumnChart(document.getElementById('chart_div'));
  chart.draw(data, {width: 400, height: 240});
} 
```

I'm at the point where I'm seriously considering making the charts in excel and upload screenshots everyday.

Any ideas on how to solve this? Am I even close (don't be mean)?

Any help is much appreciated!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T23:14:52.723

感觉有点愚蠢......经过更多挖掘后，我发现我必须使用“字符串”作为日期而不是日期，然后才能解决整个问题。

# c - 是否可以跳过文件中的输入并从中间某处开始扫描？

> ID：14762710
> 
> 赞同：1
> 
> 时间：2013-02-07T22:59:31.483
> 
> 标签：c, input, scanf, skip

在 C 中，我只想扫描输入中的一些行以节省程序的运行时间。例如：

假设我的输入文件包含一些随机数，例如：

```
5 1
1 2
1 7
5 6
3 4
1 6
2 5 3
1 5 4
3 1 1 
```

在这里，我想跳过所有双打数字并从三倍数字开始，即

```
2 5 3
1 5 4
3 1 1 
```

我可以重定向 scanf() 以便它从中间的某个地方开始扫描吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T23:02:22.947

您可以使用该[`fseek`](http://pubs.opengroup.org/onlinepubs/009696699/functions/fseek.html)函数将文件光标跳转到文件中的任意偏移量，前提是您知道需要跳过的字节数。

如果您事先不知道需要跳过多少个字符，最好的选择是不断地从文件中读取行并跳过那些不符合您的条件的行。在你的情况下，你可以跳过所有只有一个空格字符的行，一旦你找到一行有两个空格就可以继续阅读。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T23:03:05.007

You can read and ignore data until you reach what you want. For example, read a line with `fgets`, then use `sscanf` to try to convert that line to three numbers. If the return from `sscanf` isn't 3, it couldn't convert three numbers, so continue to the next line. When `sscanf` does return 3, then you can save the results in an array (or whatever).

To truly skip to a later point in the file, you'd need to know the offset to skip to, and feed that to `fseek`. That seems unlikely to apply here though.

If your file is large *and* you know (for sure) that it consists solely of 2-number lines followed by 3-number lines, you could do something like a binary search to find the first 3-number line. You'd start by finding the file length, then seek (about) halfway into the file. Read and ignore one line (because you probably didn't seek to the beginning of a line). Then read the next line and try to convert it as above. If it has three numbers, then you're past the point that the three-number lines started, so try again about halfway back to the beginning (and if it's only a 2-number line, halfway further to the end).

You probably don't want to keep this up too long -- when you're within a few kilobytes (or so) of the beginning of the three-number lines, it's probably faster to just read sequentially until you find the beginning instead of doing a lot more seeking to find exactly the right point.

# ruby-on-rails - 如何列出具有活跃记录的前 10 名学校 - rails

> ID：14762714
> 
> 赞同：4
> 
> 时间：2013-02-07T22:59:50.317
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, rails-activerecord

我有两个模型：`School`和`Review`.

该`School`模型如下所示：`{ID, name, city, state}`

该`Review`模型如下所示：`{ID, content, score, school_id}`

如何根据审查模型的分数列出前十名的学校？

我想也许是学校模型中的一种方法，如下所示：

```
class School < ActiveRecord::Base
 def top_schools
   @top_schools = School.limit(10)
   ...
 end
end 
```

然后将它们循环到一个`<li>`列表中：

```
<div>
 <ul>
   <% @top_schools.each do |school| %>
      <li>school.name</li>
   <%end>
 </ul>
</div> 
```

但是，我真的不知道如何完成该`top_schools`方法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-08T00:02:02.953

你应该对每所学校进行平均评价。

如果您使用 MySQL 运行，SQL 查询应该类似于：

```
SELECT schools.* FROM schools 
JOIN reviews ON reviews.school_id=schools.id 
GROUP BY schools.id
ORDER BY AVG(reviews.score) DESC
LIMIT 10 
```

**在 Rails 中翻译：**

在您的学校模型中：

```
scope :by_score, :joins => :reviews, :group => "schools.id", :order => "AVG(reviews.score) DESC" 
```

在您的控制器中：

```
@top_schools = School.by_score.limit(10) 
```

选择不包括范围限制，可以更灵活，允许显示 5 或 15。

我只测试了 MySQL 请求。我不确定我的 Rails 翻译。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T23:19:54.277

编辑：我完全错过了该答案中的评论模型。

```
School.all(:select => "schools.*, AVG(reviews.score) as avg_score", 
:joins => :reviews, 
:group => 'schools.id', 
:order => 'avg_score desc', 
:limit => 10) 
```

但是，当您添加评论时，这会变慢。我喜欢 total_score 的答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T23:28:50.093

假设每所学校只有一条评论 (`has_one`和`belongs_to`)，您需要先订购评论，然后找到相应的学校：

```
Review.order('score DESC').first(10).each do |r|
   School.find_by_id(r.school_id)
end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-07T23:53:08.140

我会`total_score`在学校表中添加一个新字段 - 默认设置为 0。然后在 Review 模型中添加一个回调，以在向该学校添加/更新新评论时计算该学校的总分。

然后这样做： `School.order("total_score DESC").limit(10)`

# java - 十进制的 JAVA OptionPane.showMessageDialog 输出格式

> ID：14762716
> 
> 赞同：1
> 
> 时间：2013-02-07T22:59:51.737
> 
> 标签：java, swing, joptionpane, number-formatting, decimalformat

我对 Java 非常陌生，并且正在使用 GUI 显示消息。所以如果使用控制台

```
System.out.printf("Your total montly bill is $%.2f",  totalCost); 
```

以应有的方式给我带十进制的输出。我试图用这个做同样的事情，但我在小数点后得到更多的数字，因为 totalCost 是双精度类型。如何格式化输出以仅显示小数点后两位？谢谢。

```
JOptionPane.showMessageDialog(null, "Your monthly payment is " + totalCost); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-07T23:03:15.013

你可以这样做：

```
JOptionPane.showMessageDialog(null, String.format("Your monthly payment is $%.2f",  totalCost)); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-07T23:01:49.037

```
double d = 1.234567;
DecimalFormat df = new DecimalFormat("#.##");
JOptionPane.showMessageDialog(null, "Your monthly payment is " + df.format(d));
System.out.println(df.format(d)); 
```

[类 DecimalFormat API](http://docs.oracle.com/javase/7/docs/api/java/text/DecimalFormat.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-06-30T18:10:13.320

***你也可以这样做：*** JOptionPane.showMessageDialog(this, "你的月供是 " + totalCost);

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-11T03:02:43.413

```
DecimalFormat df = new DecimalFormat("#.##");
                String hour = JOptionPane.showInputDialog("Please input your hourly salary: ");
                double hr = Double.parseDouble(hour);
                double dr = hr * 8;             
                double wr = hr * 40;
                double mr = hr * 160;
                double yr = mr * 12;

    JOptionPane.showMessageDialog(null, "Yearly: " + df.format(yr) + " / " + "Monthly: "
                    + df.format(mr) + " / " + "Weekly: "+ df.format(wr) + " / " + "Hour: " + df.format(hr),
                    "Yearly Salary Calculator by the hour", JOptionPane.OK_OPTION, icon); 
```

# html - 部分标签是否适合对表单元素进行分组？

> ID：14762717
> 
> 赞同：6
> 
> 时间：2013-02-07T22:59:56.080
> 
> 标签：html, forms, semantics

我目前正在使用 p 标签来包围表单分组（例如标签、输入和错误消息）...

p 标签是我多年来一直使用的标签，但我遇到了一些问题，因为**p 标签不能包含 div 等**……所以我正在考虑使用“section”标签来分解“sections”表单： )...

如果你们认为在这种情况下使用这个标签在语义/功能上是合适的，我正在寻找一些反馈......作为网络开发人员的表单是我一天中 90% 的时间，所以非常感谢你的想法和反馈:)

仅供参考（尽管无关紧要）我正在使用 Laravel Form 作为示例！

**前**

```
<p>
    <label>First Name</label>
    <input type="text" name="first_name" value="{{ Form::form_value('first_name', $user) }}">
    <span class="error_message">{{ $errors->first('first_name') }}</span>
</p>

<p>
    <label>Surame</label>
    <input type="text" name="surname" value="{{ Form::form_value('surname', $user) }}">
    <span class="error_message">{{ $errors->first('surname') }}</span>
</p> 
```

**后**

```
<section>
    <label>First Name</label>
    <input type="text" name="first_name" value="{{ Form::form_value('first_name', $user) }}">
    <span class="error_message">{{ $errors->first('first_name') }}</span>
</section>

<section>
    <label>Surame</label>
    <input type="text" name="surname" value="{{ Form::form_value('surname', $user) }}">
    <span class="error_message">{{ $errors->first('surname') }}</span>
</section> 
```

感谢您的反馈意见[![微笑](../Images/c5484cb345e5fe8bedafbc39e4ca81d4.png)](https://i.stack.imgur.com/V7xAw.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-11-07T09:49:30.413

该[`section`元素](https://www.w3.org/TR/2016/REC-html51-20161101/sections.html#the-section-element) *可以*适用于对表单元素进行分组，但肯定不适用于每个输入+标签组。它是一个分段内容元素，这意味着每个元素都`section`可以列在[文档的大纲](https://www.w3.org/TR/2016/REC-html51-20161101/sections.html#creating-an-outline)中。这很可能不是您想要的。

一个很好的例子`section`可能是*非常*长/复杂的表格，其中每个部分可能包含多个[`fieldset`元素](https://www.w3.org/TR/2016/REC-html51-20161101/sec-forms.html#the-fieldset-element)。一般使用的经验法则`section`：

*   `section`如果您为内容提供标题 ( `h1`- )，则应使用`h6`；
*   如果为内容提供标题是合适的，您可以使用`section`，但由于某种原因您不这样做。

该[`p`元素](https://www.w3.org/TR/2016/REC-html51-20161101/grouping-content.html#the-p-element)适用于对一个或多个输入+标签组进行分组，如[示例 1](https://www.w3.org/TR/2016/REC-html51-20161101/grouping-content.html#example-d5e88398)中的第二个片段所示。由于您想包含可能的错误消息，`div`因此对组使用（无意义的）元素，将`p`元素作为子元素，似乎是合适的：

```
<div>
  <p>
    <label>First Name</label>
    <input type="text" name="first_name" value="">
  </p>
  <p class="error_message"></p>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T00:21:33.937

我认为`<section>`使用的语义不是正确的。您可以使用`<fieldset>`，但我认为这是用于多个输入，或者您可以将所有内容都包含在`<label>`.

例如

```
<label>
  First Name
  <input type="text" name="surname" value="{{ Form::form_value('surname', $user) }}">
  <span class="error_message">{{ $errors->first('surname') }}</span>
</label> 
```

否则，一个`<p>`标签就很好了，无论如何，表单没有太多语义。

# javascript - 简单的 if 语句在 NodeJS 中不起作用

> ID：14762731
> 
> 赞同：2
> 
> 时间：2013-02-07T23:00:38.240
> 
> 标签：javascript, node.js

我编写了一个 NodeJS 应用程序，它使用 eBay API 从 eBay 获取列表。我遇到了一个问题，即某些项目正在通过，即使它们应该用一个简单的 if 语句过滤掉。

该应用程序从前端以 JSON 形式接收帖子数据，执行每个搜索，然后根据某些参数过滤掉项目。这是有问题的代码：

```
if ( items[i].listingInfo.listingType != 'Auction' ) {
    //console.log( items[i].listingInfo.listingType );

    if ( items[i].primaryCategory.categoryId == '9355' ) {
        //console.log( items[i].primaryCategory.categoryId );

        if ( price < maxPrice && price > 40 ) {
            //console.log( price, maxPrice );
            file =  path + 
                    items[i].itemId + '-' + 
                    price + '-' + maxPrice + '-' + 
                    items[i].primaryCategory.categoryId + '-' + 
                    items[i].listingInfo.listingType;

            if ( !fs.existsSync( file ) ) {
                console.log(
                    'File ' + file + ' does not exist.', 
                    !fs.existsSync( file ), 
                    items[i].listingInfo.listingType, 
                    price < maxPrice,
                    items[i].itemId
                );

                fs.writeFile( file, ' ', function(err) {
                    if (err) {
                        if (debug)
                            console.log('Writing ' + file + ' failed.');
                    }
                    else {
                        if (debug)
                            console.log('Writing ' + file + ' worked.');      
                        returnData.success = true;
                        returnData.results[ result.itemId ] = result;
                        console.log( price, maxPrice, !fs.existsSync( file ) );
                        console.log('success');
                    }
                })
            }
            else {
                returnData.discard.file[ result.itemId ] = result;
                delete returnData.results[ result.itemId ];
            }

        }
        else {
            returnData.discard.price[ result.itemId ] = result;
            if (debug)
                console.log('FAILED (price): ' + items[i].itemId + ' is ' + ( price - maxPrice ) + ' greater than maxPrice.');
        }
    }
    else {
        returnData.discard.cat[ result.itemId ] = result;
        if (debug)
            console.log('FAILED (categoryId): ' + items[i].itemId + ' is ' + items[i].primaryCategory.categoryId);
    }                    
}
else {
    returnData.discard.type[ result.itemId ] = result;
    if (debug)
        console.log('FAILED (listingType): ' + items[i].itemId + ' is a ' + items[i].listingInfo.listingType);                
} 
```

您可以看到此行`if ( price < maxPrice && price > 40 )`应该过滤掉任何大于 maxPrice 且小于 40 的项目。但是，它不会这样做。我不知道为什么会这样，也不知道这里发生了什么。它看起来非常简单明了，但事实并非如此。这是返回的对象，您可以在其中看到它无法正常工作。

```
111004318957:
    listingType: "FixedPrice"
    maxPrice: 170
    price: 349 
```

我也在使用节点集群，所以我的 server.js 文件有这个：

```
 function start(route, handle) {
        if ( cluster.isMaster ) {

            for ( var i = 0; i < numCPUs; i++ ) {
                cluster.fork();
            }

            cluster.on('exit', function( worker, code, signal) {
                console.log( 'worker ' + worker.process.pid + ' died' );
            })
        }
        else {
            function onRequest(request, response) {
                var postData = "";
                var pathname = url.parse(request.url).pathname;

                request.setEncoding("utf8");
                request.addListener("data", function(postDataChunk) {
                    postData += postDataChunk;
                });
                request.addListener("end", function() {
                    //console.log('Request ended.');
                    if ( postData != '' ) {
                        postData = JSON.parse(postData);
                    }
                    //console.log(postData.search.searches[0]);
                    route(handle, pathname, response, postData);
                });
            }
            http.createServer(onRequest).listen(8888);
            console.log("Server has started.");
        }
    } 
```

感谢这里的任何帮助，谢谢。

**编辑：**我应该解释的`111004318957`是 eBay 返回的 itemId。结果对象如下所示：

```
results: {
    itemId1: {
        listingType: '',
        maxPrice: '',
        price: ''
    },
    itemId2: {
        listingType: '',
        maxPrice: '',
        price: ''
    }
} 
```

**编辑 2：** `price`在此代码段之前设置。它在 eBay 的响应中返回，它的位置取决于 items[i].listingInfo.listingType，所以有一个简单的 if/else 来设置它。

```
if ( items[i].listingInfo.listingType == 'AuctionWithBIN' ) {
    price = parseInt( items[i].listingInfo.buyItNowPrice.USD );
}
else {
    price = parseInt( items[i].sellingStatus.currentPrice.USD );
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T23:29:57.630

JSON 返回listingType、maxPrice、价格。

尝试`if (items[i].price < maxPrice && items[i].price > 40)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-05-31T15:49:33.137

作者几乎可以肯定无法对这个问题做出任何贡献，以澄清我的陈述是否真实，就像六年前被问到的那样。

但是，可以肯定的是，问题与以下代码部分有关：

```
fs.writeFile( file, ' ', function(err) {
  if (err) {
    if (debug)
      console.log('Writing ' + file + ' failed.');
  }
  else {
    if (debug)
      console.log('Writing ' + file + ' worked.');      
    returnData.success = true;
    returnData.results[ result.itemId ] = result;
    console.log( price, maxPrice, !fs.existsSync( file ) );
    console.log('success');
  }
}) 
```

`fs.writeFile`是异步的，如果 OP 循环遍历结果列表，那么`result`in`returnData.results[ result.itemId ] = result`将始终引用循环的最后一个元素，无论该元素是否匹配条件`if ( price < maxPrice && price > 40 ) {`。

# .net - VS 单元测试在哪个秘密、神奇的目录中执行？

> ID：14762733
> 
> 赞同：4
> 
> 时间：2013-02-07T23:00:50.540
> 
> 标签：.net, visual-studio-2012, nunit

所以，我的第一次 VS(2012)/NUnit 单元测试经验...

单元测试项目引用程序集A（需要测试的代码），这需要程序集B。所以，我也引用了程序集B。两个文件都复制到输出目录。

但是，当我运行测试时，它失败了，因为它无法加载程序集 B。奇怪的是，它必须从另一个目录运行测试。

所以，我打开 Resharper，禁用卷影复制。仍然失败。

双重和三重检查所有必要的文件都被引用并在输出目录中。他们是。

开始做一些研究，找到[这篇文章](http://msdn.microsoft.com/en-us/library/ms182475%28v=vs.90%29.aspx)，这意味着我可以禁用部署并从我的输出目录运行测试。但是，我的单元测试项目没有我可以找到的“运行配置文件”，但在演练的第一步中需要它。德拉特。

然后我偶然发现了[DeploymentItem](http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.testtools.unittesting.deploymentitemattribute%28v=VS.90%29.aspx)属性。我将它添加到我的测试方法中，你瞧，它有效。但是，我宁愿不要永远在每个测试方法中都使用这个属性，所以我正在寻找更好的解决方案。

有谁知道如何告诉该死的测试框架复制我的输出目录中的所有文件，*或者*从该目录开始运行该东西？这似乎应该是简单和默认的，而不是神奇和隐藏的......在此先感谢。

我先去发泄一下。这是我遇到过的最脑残的设计决策之一。他们有项目文件，他们知道引用了哪些程序集/文件，他们知道是否将它们设置为“始终复制”......但他们忽略了所有这些。

默认行为是只运行最琐碎的“Hello World”项目并破坏其他一切，浪费我/你的时间。这些开发者在想什么？...现在感觉好多了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T21:04:52.363

If you want to deploy additional files into test folder, and don't want to use DeploymentItemAttribute - you can create and add to your solution a .testsettings file. There you can configure your additional files / directories for deployment, setup and cleanup scripts, etc. See MSDN description of [**test settings files**](http://msdn.microsoft.com/en-us/library/ee256991.aspx).

# sql-server - 如何更新其主键设置为 IsIdentity 的数据？

> ID：14762741
> 
> 赞同：0
> 
> 时间：2013-02-07T23:01:41.580
> 
> 标签：sql-server, vb.net, tsql

在下面的代码中，命令执行但没有更新。主要问题是SQL Server 数据库**中将 IDNumber**设置为**IsIdentity的主要问题。**如果有人可以帮助我，我将不胜感激。

```
If rbnCore.Checked = True Then
                    subject = "Core"
                Else : subject = "Elective"
                End If
 qry = "Update ProgramDetails.Subjects set SubjectCode=@SubjectCode,SubjectName=@SubjectName,SubjectType=@SubjectType,UserID=@UserID,Password=@Password where IDNumber='" & txtIDNumber.Text & "'"
                cmd = New SqlCommand(qry, cn)
                cmd.Parameters.Add(New SqlParameter("@SubjectCode", txtSubjectCode.Text))
                cmd.Parameters.Add(New SqlParameter("@SubjectName", txtSubName.Text))
                cmd.Parameters.Add(New SqlParameter("@SubjectType", subject))
                cmd.Parameters.Add(New SqlParameter("@UserID", txtUserName.Text))
                cmd.Parameters.Add(New SqlParameter("@Password", txtPassword.Text))
                cmd.ExecuteNonQuery()
                MessageBox.Show("Record successfully updated", "Updated", MessageBoxButtons.OK, MessageBoxIcon.Information)
                showgrid()
            End If 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T10:55:20.790

首先，您绝对希望将 IDNumber 作为参数传入，以帮助防止 SQL 注入攻击（只需添加一个新参数并将代码更改为 IDNumber=@IDNumber 的位置）

您可以通过检查 cmd.ExecuteNonQuery() 的结果轻松查看是否发生了更新 - 它返回受影响的行数，如果什么也没发生，显然为零。

```
If rbnCore.Checked = True Then
                    subject = "Core"
                Else : subject = "Elective"
                End If
 qry = "Update ProgramDetails.Subjects set SubjectCode=@SubjectCode,SubjectName=@SubjectName,SubjectType=@SubjectType,UserID=@UserID,Password=@Password where IDNumber=@IDNumber"
                cmd = New SqlCommand(qry, cn)
                cmd.Parameters.Add(New SqlParameter("@IDNumber", txtIDNumber.Text))
                cmd.Parameters.Add(New SqlParameter("@SubjectCode", txtSubjectCode.Text))
                cmd.Parameters.Add(New SqlParameter("@SubjectName", txtSubName.Text))
                cmd.Parameters.Add(New SqlParameter("@SubjectType", subject))
                cmd.Parameters.Add(New SqlParameter("@UserID", txtUserName.Text))
                cmd.Parameters.Add(New SqlParameter("@Password", txtPassword.Text))
                If cmd.ExecuteNonQuery() > 0 Then
                  MessageBox.Show("Record successfully updated", "Updated", MessageBoxButtons.OK, MessageBoxIcon.Information)
                  showgrid()
                Else
                  'nothing affected...
                End If
            End If 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T11:54:25.337

这是.Net 环境吗？为什么你的字符串使用'&'而不是'+'进行连接。检查那个。因此，将您的查询重写为： qry = "Update ProgramDetails.Subjects set SubjectCode=@SubjectCode,SubjectName=@SubjectName,SubjectType=@SubjectType,UserID=@UserID,Pass word=@Password where IDNumber='" + txtIDNumber.Text + "'"

# outlook - CRM 2011 Outlook 客户端打开自定义 Web 应用程序，两个站点都使用 ADFS 身份验证

> ID：14762754
> 
> 赞同：3
> 
> 时间：2013-02-07T23:02:28.793
> 
> 标签：outlook, dynamics-crm-2011, dynamics-crm

目前我正在处理一项任务，以修复从自定义功能区按钮在 Outlook 客户端中打开自定义网页的过程，它类似于这个问题： [JavaScript pop-up in Dynamics CRM 2011 Outlook client](https://stackoverflow.com/questions/10460559/javascript-pop-up-in-dynamics-crm-2011-outlook-) client

但是，我已将网站配置为具有来自与 CRM Web 相同的 ADFS 的相同身份验证令牌。如果我使用 IE/任何其他网络浏览器（在 UR 12 中）打开它，它工作正常。如果我使用 Outlook 客户端打开它，它会不断提示用户进行身份验证（这对某些用户来说很烦人）。

我已阅读这些内容，但它们仅适用于 CRM 表单，不适用于自定义 Web 应用程序： [ADFS (CRM 2011) - Microsoft Outlook Client for CRM 中的身份验证问题（Response.Redirect(...) & Window.Open(.. .))](https://stackoverflow.com/questions/7832964/adfs-crm-2011-authentication-issue-in-microsoft-outlook-client-for-crm-resp) [http://msdn.microsoft.com/en-us/library/jj602956.aspx](http://msdn.microsoft.com/en-us/library/jj602956.aspx)

有人对此有任何想法吗？仅供参考，我正在使用 CRM 2011 UR 12，以及带有 CRM 客户端的 Outlook 2010。

TIA

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-20T08:28:13.167

我最终使用了 openStdWin，基于： http: [//blog.customereffective.com/blog/2011/12/jscript-pop-up-in-crm-402011-internet-explorer-vs-outlook.html](http://blog.customereffective.com/blog/2011/12/jscript-pop-up-in-crm-402011-internet-explorer-vs-outlook.html)和 Dieter 的评论. 即使我在 Outlook 客户端设置中提供了登录详细信息，它仍然要求我进行一次身份验证。

javascript函数：

```
function openNewWindow(url) { 
var name = "newWindow"; 
var width = 800; 
var height = 600; 
var newWindowFeatures = "status=1"; 
var oldWindowFeatures = "width=800,height=600,status=1"; 
// Regular Jscript function to open a new window 
//window.open(url, name, oldWindowFeatures); 

// CRM function to open a new window 
openStdWin(url, name, width, height, newWindowFeatures); 
// CRM function to open a new window 
// with default CRM parameters 
//openStdWin(url, name); 
} 
```

# java - java中的扩展collat z计算

> ID：14762765
> 
> 赞同：0
> 
> 时间：2013-02-07T23:03:18.957
> 
> 标签：java, for-loop, collatz

我真的很困惑如何使用 java for each - 循环正确。谁能帮我？

好的，这就是交易。我有一个无法摆脱的扩展 Collat​​z 问题。问题是我想列出两个变量 x 和 y 之间范围内的所有 Collat​​z 迭代，其中 x>y 在 0-10000 范围内。我的问题是，在第二个 foror 循环中，我想对 value 中的每个数字执行整个 collat​​z 计算，所以如果 value = 7 我想计算 x = 7 (16) 的 collat​​z 迭代，依此类推直到 y = 19 (20)，整个序列是 16, 3, 19, 6, 14, 9, 9, 17, 17, 4, 12, 20, 20。我在 Java 中这样做。

导入 java.util。*; 导入 java.lang。*;

公共类 hackCollat​​z{

```
public static void main(String[] args){

    Scanner input = new Scanner(System.in);

    int x;
    int y;
    int result = 0;

    System.err.print("Sätt ett värde på x: ");
    x  = input.nextInt();
    System.err.print("Sätt ett värde på y: ");
    y = input.nextInt();

    List<Integer> storeValue = new ArrayList<Integer>();

    for(int i=x; i<=y; i++){
        int value = i;
        storeValue.add(value);
        }       

    for(Integer value : storeValue){
        for(int j = value; j > 1; j++){
            if(j % 2 == 0){
                j=j/2;
            //  System.out.println(j);
                result++;

            }
            else{
                j=j*3+1;
                result++;
        //      System.out.println(j);
            }
        }
        }
        System.out.println(result);
        } 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T23:23:06.170

如果将内部 FOR 循环更改为：`for(int j = value; j > 1;)`，那么 if `value = 7`，将需要 16 次迭代才能达到值 1（如预期的那样）。

# wpf - WPF Image only updates in run-time on last frame

> ID：14762766
> 
> 赞同：0
> 
> 时间：2013-02-07T23:03:19.943
> 
> 标签：wpf, vb.net, xaml

I'm new to XAML. I wrote following routine to rotate an image by a given angle (0 to 360). I put in a slider control to set the angle based on slider value. Works great! However, when running the program and clicking the 'spin' button,a For/Next loop goes from 0 to 360 and the image will only display the last angle rotation (360). I did put in a Sleep command to slow, just in case I wasn't catching the previous updates. Any help with why it won't update continuously would be greatly appreciated. Thank you.

```
Imports System.Threading.Thread
Imports System.Windows.Media.Imaging.BitmapImage

Class MainWindow

    Private Sub Slider1_ValueChanged(sender As System.Object, e As System.Windows.RoutedPropertyChangedEventArgs(Of System.Double)) Handles Slider1.ValueChanged
' ---- when I adjust manually, this works perfectly
        Dim rotateTransform1 As New RotateTransform
        rotateTransform1.Angle = Slider1.Value
        lblAngle.Content = rotateTransform1.Angle
        Image1.RenderTransform = rotateTransform1
    End Sub

    Private Sub btnSpin_Click(sender As System.Object, e As System.Windows.RoutedEventArgs) Handles btnSpin.Click
    Dim spinAngle as Double
    For SpinAngle 0 to 360
            spinWheel(spinAngle)
            Sleep(50)
        Next spinAngle
    End Sub

    Private Sub spinWheel(ByVal spinAngle)
        Dim rotateTransform1 As New RotateTransform
        rotateTransform1.Angle = SpinAngle 'Slider1.Value
       Image1.RenderTransform = rotateTransform1
        lblAngle.Content = rotateTransform1.Angle
        Image1.InvalidateVisual()

    End Sub

    Public Sub New()

        ' This call is required by the designer.
        InitializeComponent()

        ' Add any initialization after the InitializeComponent() call.
        ' Image1.createOption = BitmapCreateOptions.IgnoreImageCache

    End Sub

End Class

XAML

<Window x:Class="MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="677" Width="910">
    <Grid Background="#FF006903">
        <Grid.RowDefinitions>
            <RowDefinition Height="238*" />
            <RowDefinition Height="178*" />
        </Grid.RowDefinitions>
        <Button Content="SPIN!" Height="23" HorizontalAlignment="Left" Margin="521,101,0,0" Name="btnSpin" VerticalAlignment="Top" Width="75" Grid.Row="1" FontFamily="Tahoma" FontSize="15" FontWeight="ExtraBold" />
        <Image Height="615" Margin="32,7,0,0" Name="Image1" Stretch="None" VerticalAlignment="Top"
               RenderTransformOrigin=" 0.5,0.5"    Source="/rotatePicture;component/Images/purp_wheel_cropped.png"
               Grid.RowSpan="2" HorizontalAlignment="Left" Width="619" />

        <Slider Height="25" HorizontalAlignment="Left" Margin="127,188,0,0" Name="Slider1" VerticalAlignment="Top" Width="350" Maximum="360" Grid.Row="1" />
        <Label Content="Label" Height="28" HorizontalAlignment="Left" Margin="521,175,0,0" Name="lblAngle" VerticalAlignment="Top" Width="75" Grid.Row="1" FontFamily="Tahoma" FontSize="15" FontWeight="ExtraBold" />
        <Image Height="29" HorizontalAlignment="Left" Margin="535,252,0,0" Name="Image2" Stretch="Fill" VerticalAlignment="Top" Width="55" Source="/rotatePicture;component/Images/wheel_pointer.png" />
    </Grid>
</Window> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T08:47:55.117

您的方法的问题是您通过重复调用Click 处理程序来**阻塞 UI 线程。**`Sleep`WPF 为您尝试做的事情提供了一种非常优雅的机制。它被称为[动画](http://msdn.microsoft.com/en-us/library/ms752312.aspx)。

动画 a 的旋转的方法`FrameworkElement`在 C# 中可能如下所示（抱歉，我不会说 VB）。

```
private void RotateElement(
    FrameworkElement element, double from, double to, TimeSpan duration)
{
    var transform = element.RenderTransform as RotateTransform;
    if (transform != null)
    {
        var animation = new DoubleAnimation(from, to, duration);
        transform.BeginAnimation(RotateTransform.AngleProperty, animation);
    }
} 
```

请注意，`RotateTransform`必须已经包含在 的`RenderTransform`属性中`FrameworkElement`。例如，它可以像这样在 XAML 中分配：

```
<Image RenderTransformOrigin="0.5,0.5" ...>
    <Image.RenderTransform>
        <RotateTransform/>
    </Image.RenderTransform>
</Image> 
```

您将在 Button Click 处理程序中调用该`RotateElement`方法，如下所示：

```
private void btnSpin_Click(object sender, RoutedEventArgs e)
{
    RotateElement(Image1, 0, 360, TimeSpan.FromMilliseconds(360 * 50));
} 
```

* * *

另请注意，您`Slider1_ValueChanged`也不必`RotateTransform`每次都创建一个新的。

此外，很少需要调用`InvalidateVisual`，就像您在 中所做的那样`spinWheel`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T12:34:07.407

克莱门斯的回答很好。不要忘记您可以暂停/恢复动画，但前提是您在代码隐藏中创建它们。如果我没记错的话，如果你在 XAML 中启动它们，你就无法控制动画。

# nsstring - Date string has all zeros, unable to convert into NSDate object using NSDateFormatter

> ID：14762768
> 
> 赞同：1
> 
> 时间：2013-02-07T23:03:23.920
> 
> 标签：nsstring, nsdate, nsdateformatter

I am receiving all zeros as a date string for some objects from the server (0000-00-00 00:00:00), So as I am trying to convert this string to `NSDate` object using `NSDateFormatter`, **it is returning nil**. `dateformat style: @"yyyy-MM-dd HH:mm:ss`"

Could anybody help me on how to get this done?

# html - 缓存清单 - 链接到更新/无效清单的缓存页面会发生什么？

> ID：14762772
> 
> 赞同：0
> 
> 时间：2013-02-07T23:03:46.390
> 
> 标签：html, frontend, html5-appcache, cache-manifest

想象一下这个场景：

`/pageone.html`并且`/pagetwo.html`两者都参考`/cache.manifest`。清单中没有明确提到这两个页面。

用户同时访问`/pageone.html`和`/pagetwo.html`同时**在线**访问，因此现在这两个页面以及清单中的所有文件都将离线**缓存在他们的浏览器中。**

现在`/cache.manifest`文件被更新了，`/pagetwo.html`.

用户再次请求`/pageone.html`，他们的浏览器现在将刷新`/cache.manifest`所有提到的文件。

现在用户**下线**，然后访问`/pagetwo.html`。发生什么了？

*   即使没有明确提及，新的 /pagetwo.html 是否已经与新的清单一起下载？
*   还是浏览器只会显示旧的 /pagetwo.html 和新的清单？
*   还是浏览器只会显示一个页面不可用的页面？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T00:04:56.207

我测试了它。它将显示页面的旧版本（至少在 chrome 中）。

# php - 修改来自不同 PHP 会话的变量

> ID：14762774
> 
> 赞同：0
> 
> 时间：2013-02-07T23:03:54.153
> 
> 标签：php, session

我正在使用 PHP 和 MySQL 为我的网站制作会话系统。这个想法是，如果用户会话处于非活动状态，用户会话将持续大约 5 分钟，并且 CronJob 不时运行并检查会话是否过期，如果是，则删除会话。

问题：

每次有人加载他们的页面时，它都必须检查数据库以查看他们的会话是否仍然有效。我想知道是否在那个 CronJob 任务中，我可以让它找到用户 PHP Session 并更改一个变量，例如`$_SESSION['isValidSession']`并将其设置为`false`.

因此，一旦他们加载页面，它只会检查该变量是否会话有效。

对不起文字墙！

**TL;DR：**我想修改不同指定会话的会话变量。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T23:27:37.323

> 每次有人加载他们的页面时，它都必须检查数据库以查看他们的会话是否仍然有效。我想知道是否在那个 CronJob 任务中，我可以让它找到用户 PHP Session 并更改像 $_SESSION['isValidSession'] 这样的变量并将其设置为 false。

无论如何，您都必须这样做。当用户加载他们的页面时，系统必须验证数据库中是否*存在*会话（我假设您正在使用数据库）。

如果你每分钟运行一次 cron 作业，并让所有超过 5 分钟的会话过期（这似乎有点过分？如果我正在阅读一个长页面，我经常在网站上保持不活动状态 5、10 甚至 15 分钟），这将自动“标记无效”（实际上是*删除*）会话。

通常，您会保留一`TIMESTAMP`列，其中包含该行的最后更新时间（即该会话），并且 cron 作业将`DELETE`所有行的时间戳早于五分钟前。重新加载页面时，系统将不再找到相关的会话行，并推断（正确）会话已过期。

但是，您想要**的（读取会话知道其 SessionID**）可以通过 cron 作业（您可以在 PHP 中编写作业）读取会话来完成，或者加载为给定其 ID 的现存会话，或者通过读取数据库列保存使用 a 的序列化数据并对其进行`SELECT SessionData FROM SessionTable WHERE id = 'SessionId';`反序列化。然后修改膨胀的对象，重新序列化它并使用 SQL 将其存储回数据库中`UPDATE`。嘿 presto！，会话现已修改。

但请注意，这可能会导致活动客户端出现并发问题，并且不能一劳永逸地在 SQL 中完成 - 您不能`UPDATE Sessions SET isInactive = 1 WHERE expiry...`直接执行。通常，您需要逐一读取感兴趣的行，将它们反序列化并将它们存储回来，并使用 PHP 代码对其进行处理。

您可以通过两种不同的解决方法间接地做到这一点。

一，您更改会话代码以使用*非序列化数据*。这将影响可维护性和性能（您不能“只是添加”某些内容到会话中：您必须为其创建一个列）。

二：您利用序列化形式中“0”和“1”具有相同长度的事实。也就是说，包含`isValidSession`（14 个字符的名称）的序列化会话将包含文本

```
 ...{s:14:"isValidSession";b:1;}... 
```

你可以用 改变那段字符串`{s:14:"isValidSession";b:0;}`，从而`isValidSession`变成`False`。这不是特别好的做法——你在弄乱系统的内部结构。当然，我认为没有人期望 PHP 的序列化数据语法会很快改变（……或者是吗？）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T23:06:25.987

```
<?php var_dump($_SESSION); ?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T23:18:48.223

1.  您应该将用户上次请求的时间存储在数据库中。
2.  在cornjob中，您应该检查用户上次查看时间并与当前时间进行比较，然后检查哪个用户时间已过期。
3.  然后将过期用户的数据库列更新为false。
4.  之后，您只需检查数据库中的该列即可轻松找出应该注销的用户。

# javascript - $.ajax if condition

> ID：14762775
> 
> 赞同：23
> 
> 时间：2013-02-07T23:04:07.700
> 
> 标签：javascript, jquery

I failed to write a condition inside of ajax by using the following syntax.

```
 var num = 1;
      $.ajax({
          type: "POST",
      //condition starts
        if (num === 1){
          url: url1,
          data: data1,
        }else{
          url: url2,
          data: data2,
        }
        //condition finishes
          success: success,
          dataType: dataType
        }); 
```

but this way works.

```
 var num = 1;
if(num === 1){
    $.ajax({
  type: "POST",
  url: url1,
  data: data1,
  success: success,
  dataType: dataType
});
}else{
    $.ajax({
  type: "POST",
  url: url2,
  data: data2,
  success: success,
  dataType: dataType
});
} 
```

the 2nd method is not quite ideal as repeating my code. is my first script in a wrong syntax? Could someone please point out? thanks

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2013-02-07T23:07:11.337

> 我的第一个脚本语法错误吗？

是的，一点没错。您只是在对象文字的中间插入 if-else-statement 部分。你应该使用这样的东西：

```
var params = {
    type: "POST",
    success: success,
    dataType: dataType
};
if (num == 1) {
    params.url = url1;
    params.data = data1;
} else {
    params.url = url2;
    params.data = data2;
}
$.ajax(params); 
```

或者如果你想内联它们，你可以使用[三元运算符](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Conditional_Operator)：

```
$.ajax({
    type: "POST",
    url: (num == 1) ? url1 : url2,
    data: (num == 1) ? data1 : data2,
    success: success,
    dataType: dataType
}); 
```

（如果您不想重复条件，请将其布尔结果存储在变量中）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-07T23:06:41.827

你可以这样做：

```
var num = 1, url, data;

if (num === 1) {
    url = url1;
    data = data1;
} else {
    url = url2;
    data = data2;
}

$.ajax({
    type: "POST",
    url: url,
    data: data,
    success: success,
    dataType: dataType
}); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-07T23:10:05.280

`{`大括号中的东西`}`是一个对象字面量。您可以在调用之前声明并修改它`$.ajax`。

```
var options =
{
    type: "POST",
    url: url2,
    data: data2,
    success: success,
    dataType: dataType
};

if (num === 1) { options.url = url; options.data = data; }

$.ajax(options); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-02-07T23:09:09.697

`$.ajax`接受一个常规的 JavaScript 对象，所以你可以分段填充它：

```
request = {type: "POST", success: success, dataType: dataType};
if(num == 1) {
    request.url = url1;
    request.data = data1;
} else {
    request.url = url2;
    request.data = data2;
}
$.ajax(request); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-02-07T23:08:40.300

如果 url 和 data 非常简单，请尝试这种方式。

```
 var num = 1;
  $.ajax({
      type: "POST",
      url : (num==1? url1 : url2),
      data: (num==1? data1 : data2),
      success: success,
      dataType: dataType
    }); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-07T23:06:07.057

将条件放在 ajax 语句之前并在那里分配公共变量。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-07T23:09:54.437

尝试这个：

```
var num = 1;
$.ajax({
    type: "POST",
    url: (num === 1 ? url1 : url2)
    data: (num === 1 ? data1 : data2)
    success: success,
    dataType: dataType
}); 
```

但正如其他人所提到的，最好只在 ajax 调用之外分配变量。

# .net - Moving existing configuration settings over when upgrading executable

> ID：14762779
> 
> 赞同：1
> 
> 时间：2013-02-07T23:04:18.903
> 
> 标签：.net, wpf, configuration

I'm distributing a wpf .net executable to internal customers. I'm saving their preferences to a configuration file that's automatically written to a unique folder in the Temp directory, using the .NET Configuration class. When I distribute the newest .exe, it creates a new unique folder under Temp, and starts the configuration settings from scratch. There are two config files: 1 for global app settings, and 1 for each specific data set.

How can I make the settings from the previous version get moved into the new version, so the users don't have to lose their settings?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T17:25:19.610

我的解决方案：在启动时，我查看 %localappdata% 下保存配置文件的目录。我检查版本号以查看当前版本是否比已保存的任何其他版本更新。然后我只是从旧目录复制到新目录。为了向后兼容，我无法从配置中删除任何旧设置；我只能弃用它们。此外，我无法在配置中将任何新设置标记为“必需”。

实际上，现在我正在输入这个，我意识到也许我没有找到更通用的方法的原因是因为配置系统无法知道你是否搞砸了与以前的可执行文件的向后兼容性。

# sql - 如何正确加入这些选择？

> ID：14762781
> 
> 赞同：0
> 
> 时间：2013-02-07T23:04:36.920
> 
> 标签：sql, sql-server-2012

```
[1] SELECT X.id FROM somwhere WHERE X.location = _stringReturnedFromC#_
            // I need ID from this table, I only know strin: Location (from C#)

[2] SELECT Y.NameID FROM _relationBetweenXandY_ xy WHERE xy.ID = [1]
           // I use the ID I just found in [1]

[3] SELECT Z.Name FROM Z WHERE Z.NameID = [2]
           // I use the ID I found in [2] 
```

现在我怎么知道`select [2]`我在找`xy.ID = result from select [1]`

我`select [3]`正在寻找那个有身份证的人的名字`Z.NameID`

[我在这里](https://stackoverflow.com/questions/14761088/how-to-use-the-result-from-a-second-select-in-my-first-select)问了这个问题，但就我而言，这个问题无法挽救。

```
Z table: 
      Z.Name, Z.NameID
Y Table: 
      Y.PLACE, Y.PlaceID // fixed, Used to be PlaceID, is inface string: Place
X Table:
      X.Name, X.PlaceID 
```

如果它们具有相同的名称，则它们是外键（NameID，PlaceID）

这是实际代码的样子：

```
SELECT * FROM Angajati a
JOIN Distribuire d ON d.Locatie = 'Oradea'
// now I need to get d.DistribuireID while I know d.Locatie (d.location). How ?
JOIN Angajari an ON d.DistribuireID = an.DistribuireID 
```

因此

```
SELECT *
FROM TableX X 
   JOIN TableY y on x.PlaceId = y.PlaceId
   JOIN TableZ z on y.NameId = z.NameId 
```

不起作用，因为我不知道 Y.PlaceID，我只知道 Y.Place

**最后编辑**

对不起，如果这太长了。这是它的样子（我的意思是，即使语法不起作用，这就是逻辑）现在我只需要这个语法！

```
SELECT d.DistribuireID FROM Distribuire d WHERE d.Locatie = 'Oradea'
JOIN Angajari an ON an.DistribuireID = d.DistribuireID /*Here I'd need an.AngajatID for the locationID I just selected*/
JOIN Angajati a ON a.AngajatID = an.AngajatID 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T23:11:56.577

看起来你只需要一些 INNER JOIN：

```
SELECT *
FROM TableX X 
   JOIN TableY y on x.PlaceId = y.PlaceId
   JOIN TableZ z on y.NameId = z.NameId 
```

希望这可以帮助。

-编辑 - 为什么这不起作用？对不起，如果我不理解你的问题......

```
SELECT d.DistribuireID 
FROM Distribuire d 
   JOIN Angajari an ON an.DistribuireID = d.DistribuireID
   JOIN Angajati a ON a.AngajatID = an.AngajatID
WHERE d.Locatie = 'Oradea' 
```

祝你好运。

# perl - 使用 perl 进行快速字节交换

> ID：14762782
> 
> 赞同：3
> 
> 时间：2013-02-07T23:04:39.980
> 
> 标签：perl, byte, swap

我最初在这里问了这个问题：[byte swap with perl](https://stackoverflow.com/questions/14586336/byte-swap-with-perl)

我已经修改了代码，但我发现一个程序可以在 0.002 秒内完成相同的任务。如果您查看链接，您将看到我如何修改代码。现在虽然这确实加快了一点速度，但它仍然没有其他倒车程序那么快。这是修改后的代码：

```
my $hexin;
my $n;
 while (($n = read($fin, $bytes_in, 512)) == 512) {
        my @c = split('', $bytes_in);
        my $bytes_out = join('', $c[1], $c[0], $c[3], $c[2], $c[5], $c[4], $c[7], $c[6], $c[9], $c[8], $c[11], $c[10], $c[13], $c[12], $c[15], $c[14], 
                              $c[17], $c[16], $c[19], $c[18], $c[21], $c[20], $c[23], $c[22], $c[25], $c[24], $c[27], $c[26], $c[29], $c[28], $c[31], $c[30], 
                              $c[33], $c[32], $c[35], $c[34], $c[37], $c[36], $c[39], $c[38], $c[41], $c[40], $c[43], $c[42], $c[45], $c[44], $c[47], $c[46], 
                              $c[49], $c[48], $c[51], $c[50], $c[53], $c[52], $c[55], $c[54], $c[57], $c[56], $c[59], $c[58], $c[61], $c[60], $c[63], $c[62],
                              $c[65], $c[64], $c[67], $c[66], $c[69], $c[68], $c[71], $c[70], $c[73], $c[72], $c[75], $c[74], $c[77], $c[76], $c[79], $c[78], 
                              $c[81], $c[80], $c[83], $c[82], $c[85], $c[84], $c[87], $c[86], $c[89], $c[88], $c[91], $c[90], $c[93], $c[92], $c[95], $c[94],
                              $c[97], $c[96], $c[99], $c[98], $c[101], $c[100], $c[103], $c[102], $c[105], $c[104], $c[107], $c[106], $c[109], $c[108], $c[111], $c[110], 
                              $c[113], $c[112], $c[115], $c[114], $c[117], $c[116], $c[119], $c[118], $c[121], $c[120], $c[123], $c[122], $c[125], $c[124], $c[127], $c[126], 
                              $c[129], $c[128], $c[131], $c[130], $c[133], $c[132], $c[135], $c[134], $c[137], $c[136], $c[139], $c[138], $c[141], $c[140], $c[143], $c[142], 
                              $c[145], $c[144], $c[147], $c[146], $c[149], $c[148], $c[151], $c[150], $c[153], $c[152], $c[155], $c[154], $c[157], $c[156], $c[159], $c[158], 
                              $c[161], $c[160], $c[163], $c[162], $c[165], $c[164], $c[167], $c[166], $c[169], $c[168], $c[171], $c[170], $c[173], $c[172], $c[175], $c[174], 
                              $c[177], $c[176], $c[179], $c[178], $c[181], $c[180], $c[183], $c[182], $c[185], $c[184], $c[187], $c[186], $c[189], $c[188], $c[191], $c[190], 
                              $c[193], $c[192], $c[195], $c[194], $c[197], $c[196], $c[199], $c[198], $c[201], $c[200], $c[203], $c[202], $c[205], $c[204], $c[207], $c[206], 
                              $c[209], $c[208], $c[211], $c[210], $c[213], $c[212], $c[215], $c[214], $c[217], $c[216], $c[219], $c[218], $c[221], $c[220], $c[223], $c[222], 
                              $c[225], $c[224], $c[227], $c[226], $c[229], $c[228], $c[231], $c[230], $c[233], $c[232], $c[235], $c[234], $c[237], $c[236], $c[239], $c[238], 
                              $c[241], $c[240], $c[243], $c[242], $c[245], $c[244], $c[247], $c[246], $c[249], $c[248], $c[251], $c[250], $c[253], $c[252], $c[255], $c[254],
                              $c[257], $c[256], $c[259], $c[258], $c[261], $c[260], $c[263], $c[262], $c[265], $c[264], $c[267], $c[266], $c[269], $c[268], $c[271], $c[270], 
                              $c[273], $c[272], $c[275], $c[274], $c[277], $c[276], $c[279], $c[278], $c[281], $c[280], $c[283], $c[282], $c[285], $c[284], $c[287], $c[286], 
                              $c[289], $c[288], $c[291], $c[290], $c[293], $c[292], $c[295], $c[294], $c[297], $c[296], $c[299], $c[298], $c[301], $c[300], $c[303], $c[302], 
                              $c[305], $c[304], $c[307], $c[306], $c[309], $c[308], $c[311], $c[310], $c[313], $c[312], $c[315], $c[314], $c[317], $c[316], $c[319], $c[318],
                              $c[321], $c[320], $c[323], $c[322], $c[325], $c[324], $c[327], $c[326], $c[329], $c[328], $c[331], $c[330], $c[333], $c[332], $c[335], $c[334], 
                              $c[337], $c[336], $c[339], $c[338], $c[341], $c[340], $c[343], $c[342], $c[345], $c[344], $c[347], $c[346], $c[349], $c[348], $c[351], $c[350],
                              $c[353], $c[352], $c[355], $c[354], $c[357], $c[356], $c[359], $c[358], $c[361], $c[360], $c[363], $c[362], $c[365], $c[364], $c[367], $c[366], 
                              $c[369], $c[368], $c[371], $c[370], $c[373], $c[372], $c[375], $c[374], $c[377], $c[376], $c[379], $c[378], $c[381], $c[380], $c[383], $c[382], 
                              $c[385], $c[384], $c[387], $c[386], $c[389], $c[388], $c[391], $c[390], $c[393], $c[392], $c[395], $c[394], $c[397], $c[396], $c[399], $c[398], 
                              $c[401], $c[400], $c[403], $c[402], $c[405], $c[404], $c[407], $c[406], $c[409], $c[408], $c[411], $c[410], $c[413], $c[412], $c[415], $c[414], 
                              $c[417], $c[416], $c[419], $c[418], $c[421], $c[420], $c[423], $c[422], $c[425], $c[424], $c[427], $c[426], $c[429], $c[428], $c[431], $c[430], 
                              $c[433], $c[432], $c[435], $c[434], $c[437], $c[436], $c[439], $c[438], $c[441], $c[440], $c[443], $c[442], $c[445], $c[444], $c[447], $c[446], 
                              $c[449], $c[448], $c[451], $c[450], $c[453], $c[452], $c[455], $c[454], $c[457], $c[456], $c[459], $c[458], $c[461], $c[460], $c[463], $c[462], 
                              $c[465], $c[464], $c[467], $c[466], $c[469], $c[468], $c[471], $c[470], $c[473], $c[472], $c[475], $c[474], $c[477], $c[476], $c[479], $c[478], 
                              $c[481], $c[480], $c[483], $c[482], $c[485], $c[484], $c[487], $c[486], $c[489], $c[488], $c[491], $c[490], $c[493], $c[492], $c[495], $c[494], 
                              $c[497], $c[496], $c[499], $c[498], $c[501], $c[500], $c[503], $c[502], $c[505], $c[504], $c[507], $c[506], $c[509], $c[508], $c[511], $c[510]);
        print $fout $bytes_out;
} 
```

**编辑** 这就是我现在的做法。瞬间发生；）

```
my ($buf, $data, $n, $bytes);

 while (($n = read $infile, $data, 16384) != 0) {
    print $outfile pack("v*", unpack("n*", $data));
    $bytes+=$n;
} 
```

使用打包/解包速度更快......甚至成倍增长

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-07T23:14:24.037

下次你想做这样的事情时，用一片！

```
print $fout join '', @c[1,0,3,2,...]; 
```

但这在速度方面不会有太大的不同。下面应该会好很多。

```
print $fout pack 'N*', unpack 'V*', pack 'v*', unpack 'n*', $bytes_in; 
```

或者

```
$bytes =~ s/(..)(..)/$2$1/sg;
print $fout $bytes; 
```

此外，一次读取更大的块，例如 64*1024。

* * *

处理 512 字节字符串时：（“list”是您的原始代码）

```
 Rate slice  list subst  pack
slice  3100/s    --   -7%  -38%  -86%
list   3327/s    7%    --  -34%  -85%
subst  5038/s   63%   51%    --  -77%
pack  21859/s  605%  557%  334%    -- 
```

处理 64KB 字符串时：

```
 Rate  list slice subst  pack
list  14.9/s    --   -2%  -60%  -92%
slice 15.2/s    2%    --  -59%  -92%
subst 37.1/s  148%  144%    --  -80%
pack   188/s 1160% 1135%  407%    -- 
```

基准代码：

```
use strict;
use warnings;

use Benchmark qw( cmpthese );

my @indexes = map { $_+1, $_+0, $_+3, $_+2 } 0..512/4-1;

my $list = join ',', map "\$c[$_]", @indexes;
my $slice = '@c['.join(',', @indexes).']';

my %tests512 = (
   list  => 'my @c = split //, $str; my $x = join "", '.$list.';',
   slice => 'my @c = split //, $str; my $x = join "", '.$slice.';',
   pack  => 'my $x = pack "N*", unpack "V*", pack "v*", unpack "n*", $str;',
   subst => '$str =~ s/(..)(..)/$2$1/sg; my $x = $str;',
);

my %tests64KB = (
   list  => 'my $x = join "", map { my @c = split //; '.$list.' } unpack "(a512)*", $str;',
   slice => 'my $x = join "", map { my @c = split //; '.$slice.' } unpack "(a512)*", $str;',
   pack  => 'my $x = pack "N*", unpack "V*", pack "v*", unpack "n*", $str;',
   subst => '$str =~ s/(..)(..)/$2$1/sg; my $x = $str;',
);

$_ = 'use strict; use warnings; our $str; ' . $_ . ' 1;'
   for values(%tests512), values(%tests64KB);

{ local our $str = "\x00" x 512;       cmpthese(-3, \%tests512 ); }
{ local our $str = "\x00" x (64*1024); cmpthese(-3, \%tests64KB); } 
```

# php - PHP/mysql 查询时缺少行

> ID：14762783
> 
> 赞同：2
> 
> 时间：2013-02-07T23:04:41.887
> 
> 标签：php, mysql

我在 PHP 脚本中运行以下查询：

```
$radius_query = "SELECT zip, ( 3959 * acos( cos( radians(" . $latitude .") ) * cos(         radians( lat ) ) * cos( radians( lng ) - radians( " . $longitude . ") ) + sin( radians(" .     $latitude .") ) * sin( radians( lat ) ) ) ) AS distance 
FROM ZIP HAVING distance < ". $radius;
$radius_result = $db_zipcode->query($radius_query);

if (!$radius_result){
   echo 'Could not run query: ' . mysql_error();
   exit;
   }

$row = $radius_result->fetch(PDO::FETCH_ASSOC);

    While($row = $radius_result->fetch(PDO::FETCH_ASSOC))
{
     $zip[] = $row['zip'];
}

foreach ($zip as $zip_display){
echo $zip_display . ",  " . '';
} 
```

查询本身有一个小错误 - 它不返回第一行数据。它应该返回类似于以下的邮政编码列表：

40324、40339、40340、40347、40356...

这是我在 phpMyAdmin 中运行相同查询时得到的结果。

但是，当我在 PHP 脚本中运行上述查询时，结果集以 40339 开头，然后包括所有剩余的邮政编码。它不是里程问题（即丢失的 zip 完全在半径范围内 - 正如我在 phpMyAdmin 中运行查询时显示的那样）。

我在 PHP 查询中做错了什么以错过第一行数据？这不仅仅是一个显示问题，因为当我将查询结果插入数据库时​​，它也缺少第一行。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T23:13:06.553

问题出在第一个`fetch`，他们占据了你的第一排......在没有 `$row = $radius_result->fetch(PDO::FETCH_ASSOC);` 我一天前遇到同样问题的情况下运行这个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T23:06:43.003

没有必要在 PHP 中做一个隐式循环，试试

```
$zip = $radius_result->fetchAll(PDO::FETCH_ASSOC); 
```

# javascript - 保存和恢复包含嵌套 observableArrays 的 observableArray

> ID：14762785
> 
> 赞同：0
> 
> 时间：2013-02-07T23:04:46.443
> 
> 标签：javascript, json, knockout.js

我有一个模型需要保存到 JSON 并根据需要重新加载。这个想法是用户可以将模型保存到篮子或数据库（作为 JSON 字符串），然后重新加载它。创建 JSON 并保存它很简单，但重新加载似乎要困难得多。问题是我的模型包含一些类似于 Knockout Contacts 示例的复杂对象：

[http://knockoutjs.com/examples/contactsEditor.html](http://knockoutjs.com/examples/contactsEditor.html)

我什至可以生成 JSON 并通过 Web 服务将其传递给 .NET 对象。

我查看了用于加载数据模型的 Knockout 文档：

[http://knockoutjs.com/documentation/json-data.html](http://knockoutjs.com/documentation/json-data.html)

...而且我可以轻松地恢复我的“简单”可观察对象，但我不知道如何初始化复杂对象的数组，其中这些对象还包含可观察数组。有任何想法吗？

我什至尝试过使用映射插件，但生成的 JSON 不包含数组中的信息。

这样做会创建 JSON，并且我的所有数据都在其中：

```
var jsonData = JSON.stringify(ko.toJS(self.contacts), null, 2) 
```

理想情况下，我只需要扭转这一点，或者至少一个一个地创建所有对象。

谢谢你看:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T23:43:16.973

映射插件*应该可以*工作。我不确定我是否正确理解了您的情况，但请尝试这样的事情：

```
ViewModel = function() {
    this.contacts = ko.observableArray();
}

var model = new ViewModel();

ko.applyBindings(model);

var json = '{"contacts":[{"name":"Tom","phones":["00000000","1111111111"]},{"name":"Bill","phones":["222222222","333333333"]},{"name":"Bert","phones":["444444444","55555555"]}]}';

ko.mapping.fromJSON(json, {}, model); 
```

每个联系人中的“联系人”和“电话”的 observableArray 都从 json 字符串正确反序列化。

[http://jsfiddle.net/k4Sth/1/](http://jsfiddle.net/k4Sth/1/)

# azure - 引用的缓存不存在

> ID：14762787
> 
> 赞同：2
> 
> 时间：2013-02-07T23:05:00.490
> 
> 标签：azure

**历史** 在我的开发环境中，我一直在与运行 Windows Azure 模拟器时反复出现的错误作斗争。在我创建基于 Azure 模板的新解决方案和项目之前解决，同时重新安装 2012 年 10 月更新 SDK。然后我不得不将所有文件复制到新项目中。在经历所有这些之前，因为我知道它可以工作，所以我想看看是否还有其他事情可以做。

**设置**

*   视窗 8
*   Visual Studio 2012 更新 1
*   IIS Express 8
*   Windows Azure 工具 - 2012 年 10 月
*   Windows Azure 缓存 1.8.1.0
*   ASP.NET MVC 4.0 项目
*   Web 角色（2 个实例）
*   缓存工作者角色（2 个实例）
*   在缓存工作角色上启用缓存并设置为专用角色（本地角色状态为：UseDevelopmentStorage=true）
*   会话使用分布式缓存
*   输出缓存使用分布式缓存

**Web.config 设置**

```
 <sessionState mode="Custom" customProvider="AFCacheSessionStateProvider" cookieName="abc_session">
          <providers>
            <add name="AFCacheSessionStateProvider" type="Microsoft.Web.DistributedCache.DistributedCacheSessionStateStoreProvider, Microsoft.Web.DistributedCache" cacheName="default" dataCacheClientName="default" applicationName="AFCacheSessionState" />
          </providers>
        </sessionState>

<outputCache defaultProvider="AFCacheOutputCacheProvider">
        <providers>
          <add name="AFCacheOutputCacheProvider" type="Microsoft.Web.DistributedCache.DistributedCacheOutputCacheProvider, Microsoft.Web.DistributedCache" cacheName="default" dataCacheClientName="default" applicationName="AFCacheOutputCache" />
        </providers>
      </outputCache>
    </caching>

  <dataCacheClients>
    <dataCacheClient name="default">
      <autoDiscover isEnabled="true" identifier="AppNameCacheWorkerRole" />
    </dataCacheClient>
  </dataCacheClients> 
```

**错误详情**

```
ErrorCode<ERRCA0009>:SubStatus<ES0001>:Cache referred to does not exist
[DataCacheException: ErrorCode<ERRCA0009>:SubStatus<ES0001>:Cache referred to does not exist. Contact administrator or use the Cache administration tool to create a Cache.]
   Microsoft.ApplicationServer.Caching.DataCache.ThrowException(ErrStatus errStatus, Guid trackingId, Exception responseException, Byte[][] payload, EndpointID destination) +767
   Microsoft.ApplicationServer.Caching.DataCache.ThrowException(ResponseBody respBody, EndpointID destination) +149
   Microsoft.ApplicationServer.Caching.DataCacheFactory.EstablishConnection(IEnumerable`1 servers, RequestBody request, Func`3 sendMessageDelegate, DataCacheReadyRetryPolicy retryPolicy) +967
   Microsoft.ApplicationServer.Caching.<>c__DisplayClass4.<Initialize>b__1(RequestBody req) +198
   Microsoft.ApplicationServer.Caching.SocketClientProtocol.SendReceive(IVelocityRequestPacket request, Func`2 delegate, EndpointID& destination) +121
   Microsoft.ApplicationServer.Caching.SocketClientProtocol.Initialize(IEnumerable`1 servers) +1011
   Microsoft.ApplicationServer.Caching.DataCacheFactory.GetCache(String cacheName, CreateNewCacheDelegate cacheCreationDelegate, DataCacheInitializationViaCopyDelegate initializeDelegate) +1103
   Microsoft.ApplicationServer.Caching.DataCacheFactory.GetCache(String cacheName) +131
   Microsoft.Web.DistributedCache.DataCacheFactoryWrapper.CreateDataCacheFromFactory(DataCacheFactory factory, String cacheName) +63
   Microsoft.Web.DistributedCache.CacheHelpers.RunCacheCreationHooks(CacheConnectingEventArgs fetchingEventArgs, IDataCacheFactory dataCacheFactory, Object sender, EventHandler`1 fetchingHandler, EventHandler`1 fetchedHandler) +356
   Microsoft.Web.DistributedCache.DistributedCacheOutputCacheProvider.CreateInternalProvider(IHttpRuntime httpRuntime, OutputCacheInitializationData initData, IDataCacheFactory dataCacheFactory, EventHandler`1 cacheFetching, EventHandler`1 cacheFetched) +399
   Microsoft.Web.DistributedCache.DistributedCacheOutputCacheProvider.GetInternalProvider() +315
   Microsoft.Web.DistributedCache.DistributedCacheOutputCacheProvider.Get(String key) +54
   System.Web.Caching.OutputCache.Get(String key) +80
   System.Web.Caching.OutputCacheModule.OnEnter(Object source, EventArgs eventArgs) +341
   System.Web.SyncEventExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +80
   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +165 
```

杂项注释：

*   相同的配置在部署到 Azure 时运行良好，因此与我的本地环境有关。
*   当我设置了多个 Web 角色实例时，IIS Express 崩溃了，我找到了运行 Visual Studio 2010 SP1 来解决的建议。我在系统上安装了 VS2010，因为一个工具（相信是 SQL）安装了它。安装 SP1 解决了 IIS Express 崩溃的问题，但随后再次出现此错误。
*   如果我注释掉上面列出的 OutputCache 节点，错误就会消失。
*   如果我将缓存工作人员角色从专用角色切换到并置角色，错误就会消失。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T14:20:28.677

Spoke with Microsoft tech support and it appears this a known issue. Most of the time it can be resolved by forcing a refresh in the browser. I've had mixed success. The fix for this issue will be part of the next Azure SDK release.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T00:12:44.110

This happens to me in production a lot! I upload my package to staging first, and have to always wait until all the instances are running before hitting the staging URL. Sometimes this error still occurs and I restart all my instances for it to fix itself.

# linux - 如何在 windows7 上安装 nodejs 模块？

> ID：14762789
> 
> 赞同：0
> 
> 时间：2013-02-07T23:05:09.103
> 
> 标签：linux, windows, node.js

我尝试在 Windows 7 上安装[MySQL](https://github.com/mariano/node-db-mysql)和[Canvas2D](https://github.com/LearnBoost/node-canvas)模块，但是构建说明中有 linux 命令，例如`make`，还有一些 shell 脚本。我一无所知。我不知道如何在 Windows 7 上安装它们。对不起，我不是专业程序员，只是一个初学者，我只是想用 mysql 和 canvas2d 尝试 nodejs。

提前致谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T23:12:44.367

为什么不安装`npm`？

NodeJS 带有 Node Package Manager，这是一个使用[npmjs](http://npmjs.org/)上的存储库的简单管理器。它解决了依赖关系，并且不需要构建。

```
npm install db-mysql
npm install canvas 
```

我还建议使用 mysql 驱动程序`mysql`而不是`db-mysql`.

```
npm install mysql 
```

我发现`mysql`更容易使用。

您可能想知道的其他命令：

```
npm help
npm install
npm ls
npm update
npm link
npm publish 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T17:04:53.980

让画布在 Windows 上工作通常很困难（您需要安装 Python、Visual Studio Express + 修补程序等）。PhantomJs 在 Windows 上很容易运行，但对 mysql afaik 的支持很少。

# .htaccess - 如何使用 htaccess 重定向 url？

> ID：14762790
> 
> 赞同：0
> 
> 时间：2013-02-07T23:05:15.593
> 
> 标签：.htaccess, url, redirect, url-rewriting

您好，我需要从这样的网址重定向： [https ://www.domain.com/folder1/](https://www.domain.com/folder1/)

至

[https://www.domain.com/folder1/file.html](https://www.domain.com/folder1/file.html)

如何在 htaccess 文件上执行此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T23:10:43.310

您可以使用`DirectoryIndex file.html`来设置新的文件夹索引。

# android - android动态壁纸：如何销毁adview？

> ID：14762791
> 
> 赞同：0
> 
> 时间：2013-02-07T23:05:15.197
> 
> 标签：android, wallpaper

我的问题是我的动态壁纸在设置屏幕中以线性布局显示一些广告（它工作得很好），但是当我将它发送到后台（例如：按主页按钮）时，似乎 adview 没有被破坏并且导致更高的 cpu使用 (25-50%)。如果我关闭我的互联网连接或只是删除广告显示代码，它可以在不旋转的情况下工作。在我调查了这个问题之后，我发现（[https://developers.google.com/mobile-ads-sdk/docs/admob/fundamentals](https://developers.google.com/mobile-ads-sdk/docs/admob/fundamentals)）我必须在 onDestroy 销毁广告视图，但我的问题是这应该发生在我无法访问 adview 的活动。而且我不知道如何解决它，所以如果您有任何想法，请帮助我。我的代码：AdPreference.java：

```
public class AdPreference extends Preference {
public AdPreference(Context context, AttributeSet attrs, int defStyle) {super (context, attrs, defStyle);}
public AdPreference(Context context, AttributeSet attrs) {super(context, attrs);}
public AdPreference(Context context) {super(context);}
public AdView adView;
@Override  
protected View onCreateView(ViewGroup parent) {
  // this will create the linear layout defined in ads_layout.xml
  View view = super.onCreateView(parent);

  // the context is a PreferenceActivity
  Activity activity = (Activity)getContext();

  // Create the adView
  adView = new AdView(activity, AdSize.BANNER, "mybanner");
  ((LinearLayout)view).addView(adView);

  // Initiate a generic request to load it with an ad
  AdRequest request = new AdRequest();
  adView.loadAd(request);                 
  return view;    
  } 
```

和我的活动： public class Prefs extends PreferenceActivity implements SharedPreferences.OnSharedPreferenceChangeListener {

```
 @Override
 protected void onCreate(Bundle icicle) {
 super.onCreate(icicle);
 addPreferencesFromResource(R.xml.wallpaper_settings);   

  }
 @Override
 protected void onDestroy()
{               
 getPreferenceManager().getSharedPreferences().unregisterOnSharedPreferenceChangeListener(this);
 super.onDestroy();
}

public void onSharedPreferenceChanged(SharedPreferences sharedPreferences, String key)
{
} } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-10T05:58:52.020

我可能是错的，因为我在这方面不是最好的，但看起来你可能错过了

```
@Override
  public void onDestroy() {
    if (adView != null) {
      adView.destroy();
    }
    super.onDestroy();
  } 
```

或类似的东西。我的意思是，我真的没有看到你告诉动态壁纸停止广告请求的任何地方。

就像我说的，我可能是错的，但这是我对手头问题的看法。

# unix - 在 Max/MSP 独立的临时目录中打开文件

> ID：14762796
> 
> 赞同：1
> 
> 时间：2013-02-07T23:05:46.057
> 
> 标签：unix, named-pipes, max-msp-jitter

我有一个独立的 Max/MSP，它在打开时会查找外部文件夹（它包含由 R 生成的 JSON 文件），它使用`loadbang`->来完成`prefix ~/folder_name`。

这工作正常，但我不想将文件夹存储在`home`. 我真正想要的是使用终端告诉我的独立查看位置，例如：

```
open -a standalone.app /var/folders/whatevercrazytempdirname/folder_name 
```

但这不起作用。也许我可以在生成文件夹 (R) 的程序和我的独立程序之间建立一个管道，但我不知道这对于 Max/MSP 独立程序来说是可能的，而且我找不到任何做过的人这个。

感谢您的任何建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T13:08:59.307

我认为没有办法在 Max 独立中获取运行时参数。

或许您可以让 R 将文本文件写入包含whatevercrazytempdir 路径的标准目录（例如~/Library/Application Support/MaxAppName/）？Max 应用程序可以从那里得到它。

或者，如果 R 支持 udp 网络，您可以向 Max 发送一条带有路径的 OSC 消息。

# github - EGit 提交到没有本地分支的远程分支

> ID：14762797
> 
> 赞同：0
> 
> 时间：2013-02-07T23:05:45.763
> 
> 标签：github, eclipse-plugin, egit

我有一个在我的桌面上工作了很长时间的分支。首先，我将更改提交到桌面的本地分支，然后将它们推送到远程分支，一切都很好。

今天早上，我正在使用笔记本电脑并选择要更改的远程分支。下图显示了我的 EGit 存储库窗口在我的笔记本电脑上的样子，除了没有本地“MethodMigration”分支（虽然有一个本地 master）。远程“MethodMigration”分支旁边有一个黑色的小复选标记，告诉我我正在查看它，如图所示。

[https://docs.google.com/file/d/0B7yGmb99B5enZm5OcTcydnEwLUE/edit](https://docs.google.com/file/d/0B7yGmb99B5enZm5OcTcydnEwLUE/edit)（对不起，贫民窟谷歌驱动器链接。我不知道如何获取图像链接）

无论如何，我开始添加一大堆东西。完成后，我在给它一个消息后做了一个“Team->Commit->Commit & Push”。那时，我记得我还没有为它创建一个本地分支......它告诉我“没有什么可以推送”，即使刚刚指定了一大堆东西（这是有道理的，因为我从未克隆过远程分支首先制作本地副本）。不好的部分是我的所有代码都恢复为原始的“MethodMigration”远程分支代码。此外，BitBucket 没有显示任何提交或任何内容。

我所有更改的代码都去哪儿了？有没有办法把它找回来？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T23:35:27.477

不用担心！

您可以使用它`git reflog`来查找丢失提交的提交 ID `SHA`。之后只需将其与您的本地分支合并：

`git merge <commit-id>`

# java - 使用 super 将变量提升到抽象超类是否比在子类中分配它提供了好处？

> ID：14762798
> 
> 赞同：0
> 
> 时间：2013-02-07T23:05:47.150
> 
> 标签：java, inheritance, abstract

首先，我希望我的问题措辞足够好。如果没有，请随时对其进行编辑或提出更改建议。
我正在阅读 Java 教科书以帮助完成我的大学课程，并且遇到了一个练习，要求我创建一架`abstract class`飞机，它具有三个子类 B747、B757 和 B767。这三个子类的每个对象都有一个唯一的序列号。

删除了问题的许多其他部分（我希望这不相关！），我这样做了：

```
public abstract class Airplane {
    String serialNumber;

    public String toString() {
    return getClass().getName() + ": " + serialNumber
    }
} 
```

然后我声明了三个子类，每个子类如下所示：

```
public class B747 extends Airplane {
    B747(String serial) {
    serialNumber = serial;
    }
} 
```

最后，在我的主程序中，我使用以下代码实例化了新对象：

```
Airplane a = new B747("ABC101");
System.out.println ("Airplane a: " + a); 
```

现在，代码工作正常。但是，当我查看书中的答案时，他们选择了不同的方式。他们以相同的方式实例化每个对象，但在每个类中都有以下方法：

```
public B747 (String serial) {
    super (serial);
} 
```

在抽象超类飞机中，他们有：

```
public Airplane (String serial) {
    this.serial = serial;
} 
```

这只是个人喜好问题，将 String 提升到超类并在那里对其进行操作，或者这是否提供任何好处，无论是安全性还是其他方面？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-07T23:07:43.513

> 这只是个人喜好问题，将 String 提升到超类并在那里对其进行操作，或者这是否提供任何好处，无论是安全性还是其他方面？

它只是改变*访问*变量的位置- 而不是声明它的位置。这是一件好事：

*   每个人都应该有一个序列号，因此班级强制执行该`Aeroplane`序列号是有意义的`Aeroplane`
*   它允许该字段位于`private`（和`final`）内`Aeroplane`，并带有“getter”以根据需要提供对其的只读访问

这两部分都很重要——但是如果你不确定第一个方面，考虑一下如果你有另外几个子类会发生什么。您真的希望分配发生在每个子类中吗？总会有一个超*构造*函数调用——无论是隐式的还是显式的——但没有理由重复分配。

我绝对更喜欢这本书的解决方案而不是你的解决方案——特别是如果他们在这个领域`private`和`final`. 在我的代码中，除了常量之外，我几乎*从不*使用非私有字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T23:19:53.433

另外 super() 只是对超类构造函数（Aeroplane）的调用，在创建类层次结构时（据我所知）您调用超类构造函数是常见的做法。有像“this”和“super”这样的关键字，它们定义了它是否是层次结构中的超级/子（子）类中的值。Java 通常知道您是否只是简单地编写字段值名称，但它实际上是在秘密地为您放入“this”部分。

# facebook-apps - 重新获得对由 FB 主页帐户创建的应用程序的访问权限

> ID：14762807
> 
> 赞同：2
> 
> 时间：2013-02-07T23:06:26.870
> 
> 标签：facebook-apps, facebook-page

几个月前，在 FB 限制主页帐户创建应用程序的能力之前，我创建了一个应用程序并链接到该页面。

现在我无法使用此帐户访问开发者页面。我必须使用我的个人帐户创建一个新应用程序，但我找不到从页面中删除或取消链接旧应用程序的方法。

由于在当前页面上进行了近一年的活动，我无法创建新页面，并且尝试将新应用程序链接到旧页面时出现未定义的错误。

我们陷入了某种困境……

任何人都知道如何解决这种情况？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T00:19:44.777

我假设您的意思是“商业帐户”，而不是 Page？

如果是这样，并且您仍然可以登录企业帐户来管理您的广告和页面，您可以通过使用[客户端 Oauth 流程](https://developers.facebook.com/docs/howtos/login/client-side-without-js-sdk/)手动调用 Oauth 对话框来授权您的应用，然后使用访问令牌（这将是对于您的企业帐户，应用程序的管理员），将您的真实用户帐户添加为附加管理员

[https://developers.facebook.com/docs/reference/api/application/#roles](https://developers.facebook.com/docs/reference/api/application/#roles)

> 您可以通过使用应用程序管理员的用户访问令牌向 APP_ID/roles 发出 HTTP POST 请求来定义用户角色...

所以调用`https://graph.facebook.com/<APP ID>/roles?user=<USER ID OF REAL ACCOUNT>&role= administrators&access_token=<ACCESS TOKEN>&message=POST`将添加另一个管理员

# string - 从 CSV 文件读取的数据框中删除级别 - R

> ID：14762808
> 
> 赞同：6
> 
> 时间：2013-02-07T23:06:35.073
> 
> 标签：string, r, dataframe

[我尝试从此](http://baseballguru.com/MLB2011.xls)链接加载棒球统计数据。当我使用从文件中读取它时

```
data <- read.csv("MLB2011.csv") 
```

它似乎将所有字段作为因子值读取。我尝试通过以下方式删除这些因子值：

```
read.csv("MLB2011.xls", as.is= FALSE) 
```

..但看起来这些值仍被视为因素。我该怎么做才能将它们加载为简单的字符值而不是因子？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-07T23:19:09.830

您不是在读取`csv`文件，它是一个 excel 电子表格（.xls 格式）。它包含两个工作表`bat2011`和`pitch2011`

你可以使用`XLConnect`图书馆来阅读这个

```
library(XLConnect)
# load the work book (connect to the file)
wb <- loadWorkbook("MLB2011.xls")

# read in the data from the bat2011 sheet
bat2011 <- readWorksheet(wb, sheet = 'bat2011') 
```

`readWorksheet`有一个`colType`可用于指定列类型的参数。

* * *

编辑

如果您已经将工作表保存为 csv 文件，那么

`as.is = TRUE`或`stringsAsFactors = FALSE`将是正确的参数值

# android - 如何将 SD 卡中的图像以 png 格式保存到 Android 画廊？

> ID：14762810
> 
> 赞同：0
> 
> 时间：2013-02-07T23:06:38.850
> 
> 标签：android, bitmap, mediastore

我想将图像从我的 SD 卡保存到 android 的设备库中。问题是图像保存为 jpeg 而不是 png，它会失去质量并且看起来很糟糕。

这是我的代码：

```
File sdCard = Environment.getExternalStorageDirectory();
File file = new File(sdCard, "fileName.png");
Bitmap top = BitmapFactory.decodeFile(file.getPath());
MediaStore.Images.Media.insertImage(getContentResolver(), top, "someText" , "someDescription");
Toast toast = Toast.makeText(getBaseContext(), "Image saved to gallery", Toast.LENGTH_SHORT);
toast.show(); 
```

为什么图像保存为 jpeg，如何保存而不损失质量？顺便说一句 - SD 卡上的图像质量非常好，如果我将图像添加到意图并通过电子邮件发送 - 质量非常好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T05:43:27.077

您可以使用此代码将图像保存为 png 格式。

```
Bitmap bitmap = createYourBitmap();
OutputStream stream = new FileOutputStream("/sdcard/test.png");
/* Write bitmap to file using JPEG or PNG and 80% quality hint for JPEG. */
bitmap.compress(CompressFormat.PNG, 80, stream);
stream.close(); 
```

# batch-file - 删除批处理文件中的前导零

> ID：14762813
> 
> 赞同：24
> 
> 时间：2013-02-07T23:06:55.903
> 
> 标签：batch-file, zero, trim

在我的应用程序中，我得到一个前导零的数字。我正在尝试修剪前导零并获得实际数字。我尝试使用`/a`将赋值右侧视为算术表达式的开关。所以我尝试了：

```
SET /a N = 00027 
```

上面给了我**23**的输出，它是八进制数**27**的十进制等价物。然后我在网上找到[了这个解决方案。](https://groups.google.com/forum/?fromgroups=#!topic/alt.msdos.batch.nt/WbUgca7IBsU)

```
SET N = 00027
SET /a N = 1%N%-(11%N%-1%N%)/10 
```

这似乎有效，并给出了输出**27**。有没有更简单的方法来修剪批处理文件中的前导零？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-02-08T12:00:13.893

你找到的方法很好。它支持高达 99,999,999 的数字，而且速度非常快。

使用 SET /A 有一种更简单的方法，它适用于最大为 9999 的数字。它使用模数运算。该方法不能扩展到更大的数字。

```
 set n=0027
 set /a n=10000%n% %% 10000 
```

Dale 发布的 FOR /F 方法适用于“任何”大小数字（最多 8191 位）。但是，处理零值只需要更多的工作。

```
set n=000000000000000000000000000000000000000000000000000027
for /f "tokens=* delims=0" %%N in ("%n%") do set "n=%%N"
if not defined n set "n=0" 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-09-22T15:17:01.827

exit 命令非常擅长清除前导零：

```
>set n=0000890

>cmd /c exit /b %n%

>echo %errorlevel%
890 
```

有了这个，您可以使用最多 32 位整数限制的数字，并且这段代码非常小，尽管额外调用 cmd.exe 可能会损害性能。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2020-02-22T08:09:22.047

我在尝试自己解决类似问题时发现了这个问题。我喜欢你的解决方案，直到我意识到有一个更好的方法：

```
SET /a N=1%N%+1%N%-2%N% 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-02-08T08:57:52.750

您可以使用`FOR /F`删除前导零。

```
C:\>SET n=00030
echo off
for /f "tokens=* delims=0" %a in ("%n%") DO echo %a
30 
```

如您所见，`delims`设置为 0。这将使 0 作为分隔符。同时`tokens`，`*`这将确保前导 0 将被删除，而行的其余部分将被处理（包括尾随 0）。

您可以参考[此链接](http://www.robvanderwoude.com/battech_leadingzero.php)以获取有关删除前导 0 的更多信息。

PS 请记住使用`%%a`，而不是`%a`在`FOR /F`.

# sql-server-2005 - 是否可以使用游标遍历表变量？

> ID：14762814
> 
> 赞同：0
> 
> 时间：2013-02-07T23:06:57.503
> 
> 标签：sql-server-2005, cursor, table-variable

在 SQL Server 2005 中，是否可以使用游标遍历表变量？

# c - 为什么我的 TTL 值每次增加 2？（C 套接字编程）

> ID：14762825
> 
> 赞同：1
> 
> 时间：2013-02-07T23:07:58.737
> 
> 标签：c, linux, sockets, icmp, traceroute

我正在尝试实现一个 Traceroute 程序，但我遇到了两个问题，一个是 TTL 和 RTT 打印错误；尽管它们在作为 ping 程序实施时正确打印出来。最后，我的主要问题是，当我增加 TTL 时，它会增加 2 而不是 1。

我只包含了我认为必要的代码，谢谢。

提前致谢 ：）

```
void
respond (int signum) {
   struct sockaddr_storage peer_addr;
   socklen_t               peer_addrlen;
   struct sockaddr_in      addr;
   struct sockaddr_in      dstaddr;
   struct iphdr   *        ip;
   struct icmphdr *        icmp;
   struct timeval *        sent;
   int skt;
   int sequence;
   long int length;
   fd_set rdfds;
   int ready;
   int rtt;
   char buff [BUF_SIZE];

   /* Create and check Socket Number */
   skt = socket (AF_INET, SOCK_RAW, IPPROTO_ICMP);

    int ttl = 0;
    setsockopt(skt, IPPROTO_IP, IP_TTL, &ttl, sizeof(ttl)) < 0;

    /* START SEND LOOP*/
    int i;
    for (i = 0; i < 4; i++){
        ttl+=1;
        setsockopt(skt, IPPROTO_IP, IP_TTL, &ttl, sizeof(ttl));

   /* Check Socket */
   if (skt < 0) {
      perror ("socket()");
      exit (1);
   }

   /* Set IP Addresses */
   addr.sin_family      = AF_INET;
   addr.sin_port        = 0;
   addr.sin_addr.s_addr = INADDR_ANY;

   /* Check Socket Bind */
   if (bind (skt, (struct sockaddr *)&addr, sizeof(struct sockaddr_in))) {
      perror ("Can't bind socket");
      exit (1);
   }

    /* IP Buffer */
   ip = (struct iphdr *)buff;
   peer_addrlen = (socklen_t) sizeof (struct sockaddr_storage);
   memset (&dstaddr, 0, sizeof(struct sockaddr_in));
   dstaddr.sin_addr.s_addr = inet_addr(HOSTADDR);
   dstaddr.sin_family = AF_INET;

   ip->ttl=(ttl++);

   /* ICMP Buffer */
   memset (buff, 0, sizeof(buff));
   icmp = (struct icmphdr *) buff;
   icmp->type   = ECHO_REQ;
   icmp->id     = htons(getpid( ) & 0xffff);
   icmp->seqNum = htons(sequence++);

   /* Check Send Time */
   if (gettimeofday ((struct timeval *)icmp->data, NULL)) {
      perror ("Can't establish send time");
      exit (1);
   }

   /*Calculating packet size*/
   length = sizeof(struct icmphdr) + sizeof(struct timeval);
   icmp->checksum = ~(sum (0, buff, length));

   /* Packet too small, ERROR
   SEND Request             */
   if (sendto (skt, buff, length, 0,
         (struct sockaddr *) &dstaddr, sizeof(struct sockaddr_in)) <= 0) {
      perror ("sendto()");
      exit (1);
}

   /* Define File Descriptor */
   timeout.tv_sec  = 2;
   timeout.tv_usec = 0;
   FD_ZERO(&rdfds);
   FD_SET (skt, &rdfds);

   /* Select Data from File Descriptor */
   ready = select (skt + 1, &rdfds, NULL, NULL, &timeout);
   if (ready < 0) {
      perror ("Select()");
      exit (1);
   }

 /* Recieve Reply */
 memset (buff, 0, sizeof(buff));
   if (recvfrom (skt, buff, sizeof(buff), 0,
        (struct sockaddr *) &peer_addr, &peer_addrlen) <= 0) exit (1);

   /* Check Time Stamp */
   if (gettimeofday (&end, NULL)) {   // Timestamp reception
      perror ("Can't establish time of receipt");
      exit (1);
   }

   /* Check IP Protocol */
   if (ip->version != 4 ||
       sum (0, buff, sizeof(struct iphdr)) != 0xffff ||
       ip->protocol != ICMP)
      exit(1);

   /* Get IP Payload legth and ICMP Address*/
   length = ntohs(ip->length) - ip->hdrlen * 4;       // Length of IP payload
   icmp = (struct icmphdr *)((uint32_t *)ip + ip->hdrlen);   // Find ICMP hdr

   /* Check ICMP response type*/
   if (icmp->type == 11){
       printf("Type 11: ICMP....");
       }

  /* if (icmp->type != ECHO_REPL || sum (0, icmp, length) != 0xffff) {
      fprintf (stderr, "Received %s\n", messages[icmp->type]);
      //exit (1);
   } */

   /*   Find the difference between sent and end times in 10s of ms */
   sent = (struct timeval *)icmp->data;
   if ((rtt = (end.tv_usec - sent->tv_usec) / 100) < 0)
      rtt += 10000;  // We've cycled to a new second
   rtt += (end.tv_sec - sent->tv_sec) * 10000;  // Add any seconds

   /* PRINT ICMP REPLY*/
   printf ("%ld bytes from %s: icmp_req=%d ttl=%d time=%0.1f ms\n",
      length,
      iptos(ntohl(ip->srcip)),
      ntohs(icmp->seqNum),
      /*Set initial TTL */
      ip->ttl,
      ((float)rtt) / 10);

    } /*END SEND LOOP

   /* Invalid Signal returned */
   if (signum == SIGINT) {
      printf ("\nGoodbye!\n");
      exit(0);
   }

   /* 3 Second Probe */
   alarm (3);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T23:19:19.907

```
/* START SEND LOOP*/
int i;
for (i = 0; i < 4; i++){
    ttl+=1;
    setsockopt(skt, IPPROTO_IP, IP_TTL, &ttl, sizeof(ttl)); 
```

`ttl`每次循环迭代时，您都会增加一。

```
 ip->ttl=(ttl++); 
```

在这里你再增加一。因此，如果它是 1，那么在此行之后它将是 2。然而，一旦循环迭代，你再次增加它，所以它现在是 3。这就是你的 ttl 在每次迭代中增加 2 的原因。

该行的`ip->ttl=(ttl++)`意思是：取 的值`ttl`并将其复制到`ip->ttl`，然后在这样做之后加`ttl`一。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T23:19:53.933

您在该循环中将 ttl 增加两次。当 for 循环开始时：

```
 ttl+=1; 
```

然后再次将其分配给结构

```
 ip->ttl=(ttl++); 
```

至于 rtt，那段代码在我看来是错误的。

# android - 从android外部文件夹编译源代码

> ID：14762827
> 
> 赞同：2
> 
> 时间：2013-02-07T23:08:03.547
> 
> 标签：android, android-emulator, emulation, android-source, openssh

我从 Android 网站下载了 AOSP android-4.0.1_r1。 [http://source.android.com/source/downloading.html](http://source.android.com/source/downloading.html)

/external 文件夹中有 OpenSSH 文件夹和源。

当我为模拟器编译整个 aosp 时，我无法 ssh 在模拟器的 android out 文件夹中创建的可执行文件。

有没有办法从android的外部文件夹编译OpenSSH？

*   鲁奇克

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T08:53:13.217

如果您查看 OpenSSH 的 Android.mk 文件，您会发现以下行：

```
LOCAL_MODULE_TAGS := optional 
```

`build/target/product/core.mk`这意味着如果模块名称列在适当的 make 文件中（例如，在 a 中），则该模块将包含在构建中

# javascript - 输入必须是数字格式 仅检查

> ID：14762829
> 
> 赞同：0
> 
> 时间：2013-02-07T23:08:16.323
> 
> 标签：javascript, jquery

我有一个带有简单数学函数的简单脚本。我希望用户只插入数字。我怎样才能在代码中做到这一点？甚至更好 - 如何防止输入非数字字符？

```
 $('form').submit(
 function (e) {
   e.preventDefault();

    $('#result').text("Result is " + parseInt($('#var1').val()) / 2 + " days");
 }); 
```

[http://jsfiddle.net/eWXUT/1/](http://jsfiddle.net/eWXUT/1/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T23:12:21.520

您可以通过以下方式检查输入：

```
$('#var1').keypress(function(event) {
var code = (event.keyCode ? event.keyCode : event.which);
if (!(
        (code >= 48 && code <= 57) //numbers
        || (code == 46) //period
    )
    || (code == 46 && $(this).val().indexOf('.') != -1)
   )
    event.preventDefault();
}); 
```

或使用 jquery：

```
$('#val1').change(function() {
  $(this).val($(this).val().match(/\d*\.?\d+/));
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T23:15:29.150

尝试在按键/上/下删除非整数值 - 这是一个[活生生的例子](http://jsfiddle.net/eWXUT/2/)

```
$('#var1').on('keypress keydown keyup', function(){
       $(this).val($(this).val().replace(/([^\d]+)/, '')); 
    }); 
```

# jquery - jQuery-mobile 1.3 面板始终可见

> ID：14762831
> 
> 赞同：2
> 
> 时间：2013-02-07T23:08:23.843
> 
> 标签：jquery, css, jquery-mobile, menu, panel

在新的 jQuery-mobile 1.3 版本中，如何添加一个从一开始就始终可见的左侧面板？

该面板将用作导航菜单。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T08:30:34.550

您可以像这样以编程方式打开它：

```
$(document).on('pagebeforeshow', '#index', function(){       
    $( "#mypanel" ).panel( "open");
}); 
```

这是一个有效的 jsFiddle 示例：http: [//jsfiddle.net/Gajotres/EkbYe/](http://jsfiddle.net/Gajotres/EkbYe/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T22:21:50.643

将面板用作菜单栏时，有些事情会搞砸。（然而）如果您以这种方式打开面板，它在宽度较小的设备中将无法完美运行。它会起作用，但很奇怪，因为页面的一部分不在屏幕上并且没有水平滚动。在面板打开并锁定为菜单栏的情况下，无法在手机中导航。（我假设您不想使用按钮来打开和关闭面板！）也许您的目标用户只使用桌面或更大屏幕的设备。在这种情况下，您可以使用此代码，加上面板标签中的 data-dismissible="false" AND data-swipe-close="false"。但仍然有一个问题：ESC 键。如果用户按下 ESC 键，面板将关闭，如果你没有按钮再次打开它，菜单会爆炸！我还没有找到一种将面板用作菜单栏的方法。如果有人这样做，

# excel - 在 Excel 中保存为 CSV 会丢失区域日期格式

> ID：14762834
> 
> 赞同：15
> 
> 时间：2013-02-07T23:08:45.803
> 
> 标签：excel, csv, export-to-csv

我有一个需要转换为 .csv 的 .xls

该文件包含一些日期列。日期格式为“*14/03/2001”，根据 Excel，这意味着日期响应为操作系统指定的区域日期和时间设置。

在 Excel 中打开您会看到：

```
20/01/2013
01/05/2013 
```

另存为... CSV

在记事本中打开：

```
01/20/2013
05/01/2013 
```

我通过将日期格式设置为“14/03/2001”（无 *）暂时修复了问题，但即使是其他一些没有 * 的自定义格式，例如“d/mm/yyyy h:mm”，在保存到 CSV 时也会被破坏。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2014-12-11T21:18:03.870

您可以按照以下过程将所需的日期格式从 Excel 保存为 .csv，希望 excel 大师可以进一步改进并减少步骤数：

1.  创建一个新列 DATE_TMP 并将其设置为等于 =TEXT(oldcolumn, "date-format-arg" ) 公式。

例如，在您的示例中，如果您的日期在 A 列中，则此新列的第 1 行中的值将是：

=TEXT（A1，“dd/mm/yyyy”）

2.  在现有日期列旁边插入一个空白列 DATE_NEW。

3.  使用“粘贴为值”选项将 DATE_TMP 的内容粘贴到 DATE_NEW 中。

4.  删除 DATE_TMP 和您现有的日期列，将 DATE_NEW 重命名为您的旧日期列。

5.  另存为 .csv。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2014-05-08T00:01:26.747

虽然记住这一点[http://xkcd.com/1179/](http://xkcd.com/1179/)

最后我决定`YYYYMMDD`在所有 CSV 文件中使用该格式，它不会在 Excel 中转换为日期，但可以被我们所有的应用程序正确读取。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-10-22T18:35:46.750

在日历设置下以“短日期”格式更改计算机的日期和时间设置。这将更改所有 yyyy-mm-dd 的格式，或者您希望它显示的任何格式；但请记住，即使对于保存在您计算机上的文件，它也会看起来像这样。

至少它有效。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-02-15T07:21:22.723

您需要做的工作远不止 1\. 单击导出 2\. 打开文件。

我认为当 Excel CSV 文档谈到正在解释的操作系统和区域设置时，这意味着 Excel 在打开文件时会这样做（这是它们的“特殊”csv 格式）。请参阅这篇文章，[“Excel 格式和功能不会转移到其他文件格式”](http://office.microsoft.com/en-us/excel-help/excel-formatting-and-features-that-are-not-transferred-to-other-file-formats-HP010014105.aspx?CTT=5&origin=HP010099725)

此外，Excel 实际上是存储一个数字，并转换为日期字符串仅用于显示。当它导出为 CSV 时，它会将其转换为不同的日期字符串。如果您希望该日期字符串为非默认值，则需要在执行导出之前将 Excel 单元格转换为字符串。

或者，您可以将日期转换为 Excel 正在保存的数值。由于这是一个时间码，假设您正确导入它，它实际上将遵循操作系统和区域设置。不过，记事本只会显示 10 位数字。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2016-08-30T09:50:18.743

如果您使用自定义格式，而不是预先选择的日期格式之一，导出到 CSV 将保留您选择的格式。否则默认返回美国格式

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-06-25T15:17:04.560

在日期前面放置一个撇号，它应该以正确的格式导出。刚刚自己发现了，我发现这个线程正在寻找答案。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-12-18T01:23:57.460

我用于此的一个不可扩展的修复方法是将数据复制到纯文本编辑器，将单元格转换为文本，然后将数据复制回电子表格。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-10-25T03:36:55.410

`numberformat = "d/m/yyyy"`将日期范围更改为“常规”格式并保存工作簿一次，然后在保存和关闭工作簿之前将其更改回日期格式（例如， ）。`savechanges`参数为真。

# jquery - jQuery 我可以得到 val 但 id 未定义？

> ID：14762839
> 
> 赞同：0
> 
> 时间：2013-02-07T23:09:16.510
> 
> 标签：jquery

我错过了一些我认为的东西......我需要表格每一行中的日期选择器输入的值和 id。此代码循环和搜索，但没有按我预期的那样工作。该表包含这样的行

```
<tr>
 <td><input type="text" id="pd_abc_123" class="datePicker"></td>
 <td><input type ="checkbox" id="blahblah"></td>
</tr>

$(table).find("tbody>tr").not(':first').each(function () {
                    var datePicker = $(this).find("input[type=text]");
                    var dt = $(datePicker).val();
                    alert(dt);
                    alert($(datepicker).id);
                    alert($(datepicker).attr("id"));
                }); 
```

我也试图通过类找到输入，但它也返回未定义

```
var temp = $(this).find(".datePicker"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T23:25:33.673

您的代码中有一些错误：

1.  在您的警报`datepicker`中有一个小写字母`p`
2.  第二次警报后缺少分号。

也不要忘记关闭`<input>`标签`/>`

固定示例：

```
$('table').find("tbody>tr").not(':first').each(function () {
    var datePicker = $(this).find("input[type=text]");
    var dt = datePicker.val();
    alert(dt);
    alert(datePicker.attr("id"));
}); 
```

演示：http: [//jsfiddle.net/c5bjd/2/](http://jsfiddle.net/c5bjd/2/)

[您可以使用浏览器开发工具](https://www.scirra.com/tutorials/147/checking-for-errors-in-browsers/page-1)找出这些错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T23:19:40.890

```
$("table").find("tbody>tr").not(':first').each(function () {
    var datePicker = $(this).find("input[type=text]");
    var dt = datePicker.val();
    alert(dt);                    // value
    alert(datePicker.attr("id")); // ID
}); 
```

[***演示***](http://jsfiddle.net/jNZg6/)

# java - 没有框架的复合 Web 应用程序

> ID：14762842
> 
> 赞同：2
> 
> 时间：2013-02-07T23:09:27.680
> 
> 标签：java, web, menu, frames, composite

我已经构建了两个 Web 应用程序，我们将它们称为 App1 和 App2。

App1 有多个页面（Page1.jsp 和 Page2.jsp）。App1 是一个独立的应用程序，它有一个链接到两个页面的菜单。

App2 有多个页面（Page3.jsp 和 Page4.jsp）。App2 也是一个独立的应用程序，它有一个链接到两个页面的菜单。

现在我想把App1和App2组合成一个超级应用程序，而不需要修改App1或App2。这个超级应用程序应该有一个链接到 App1/Page1.jsp、App1/Page2.jsp、App2/Page3.jsp 和 App2/Page4.jsp 的菜单。

我想到了几种方法来做到这一点：

**解决方案 1：框架**

我可以创建一个菜单框架，它有一个链接到 App1 和 App2 页面的菜单。

我可以有一个单独的框架，用于显示 App1 和 App2 的内容。

但是，我并不热衷于使用框架（[http://www.html-faq.com/htmlframes/?framesareevil](http://www.html-faq.com/htmlframes/?framesareevil)）。

**方案二：根据 URL 参数动态构建菜单**

超级应用程序可以有一个基于 div 的菜单链接到 App1 和 App2。它可以在 URL 上传递一个参数，例如 App1/Page1.jsp?parent=SuperApp。

App1 和 App2 可以根据 parent 参数动态构建菜单。

例如，如果 parent 参数不存在，那么 App1 将使用其链接到 Page1.jsp 和 Page2.jsp 的正常菜单。

但是，如果 parent 参数存在，那么 App1 将使用 SuperApp 菜单 (SuperApp/header.html) - 它会在 JSP 页面中动态包含此 HTML。此 SuperApp 菜单将链接到 App1 和 App2 中提供的所有页面。

第二个解决方案将在不使用框架的情况下工作，但我想探索是否还有其他我没有考虑过的解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T07:04:25.083

让第三个 Web 应用程序负责菜单怎么样：

![在此处输入图像描述](../Images/f3e563e44e3be91eaa2bcf84be48b882.png)

在每个页面中配置一个非常小的 JavaScript 组件，该组件对菜单应用程序进行 AJAX 调用以填充它。通常，这将使用`<div>`具有特殊类或 ID 的空来实现。您还有一个脚本（从 MenuApp 下载）可以定位`<div>`并添加菜单。

一些想法：

*   最简单的实现是 MenuApp 使用 servlet config 来配置菜单选项。更灵活的方法可以使用 SQL 或 NoSQL DB
*   参数化调用，调用页面可以使用菜单上下文（例如 LoggedIn、AdvancedUser、Configuration）进行调用，并且 MenuApp 返回适当的菜单项子集
*   更高级：用户可以配置自己的收藏夹

这样做的主要缺点是额外的回调，尽管如果您已经在使用 AJAX，这可能是一个非常低的开销。

顺便说一句，这类似于 FaceBook、Google+、Twitter、Pinterest 等实现其 Like、PlusOne 等按钮的方式，同时对第三方 Web 应用程序的侵入性最低。例如参见：[https ://developers.google.com/+/plugins/+1button/](https://developers.google.com/+/plugins/+1button/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T21:32:45.563

当您想同时使用两个应用程序时，一种可能的解决方案是使用 portlet。部署将相同，您无需在 App1 和 App2 中进行任何更改。根据您想要使用的 portlet 容器，配置会有所不同，但最终您将为每个应用程序拥有一个 portlet，并配置该门户的菜单以定位每个应用程序的 url。

两种可能的解决方案是[Liferay](http://www.liferay.com/)和[Jetspeed](http://portals.apache.org/jetspeed-2/)。我和那两个人一起工作。还有 JBoss [GateIn](http://www.jboss.org/gatein/portletcontainer.html) portlet 容器。

# c# - 如何将位图返回到浏览器 WebApi

> ID：14762845
> 
> 赞同：5
> 
> 时间：2013-02-07T23:09:41.797
> 
> 标签：c#, javascript, image, asp.net-web-api

我正在使用 JavaScript 从客户端已加载的文档向服务器“WebApi”发出请求。

当服务器收到请求时，它会即时构建位图并将其以 .png 格式返回给客户端。

当我在客户端读取响应时，我从 .ajax 请求的数据部分得到的只是一个空字符串。

如何使用 WebApi 从服务器读取和请求图像，然后使用从服务器接收到的新图像在客户端设置图像的 src 属性？

--WebApi

```
public HttpResponseMessage Get(int id)
    {
        ElevationResponse elev = ElevationHelper.GetElevation(id);

        Bitmap canvas = ShopDrawing.Elevation.Elevation.GetShopDrawing(elev, true);

        var ms = new MemoryStream();
        canvas.Save(ms, System.Drawing.Imaging.ImageFormat.Png);

        HttpResponseMessage r = Request.CreateResponse();
        r.Content = new StreamContent(ms);
        r.Content.Headers.ContentType = new System.Net.Http.Headers.MediaTypeHeaderValue("image/png");
        return r;
    } 
```

- 客户

```
 $.ajax(
         {
             async: true,
             url: '/api/drawings?id=' + this.id,
             type: 'GET',
             contentType: "application/json",
             success: function (d, status) {
                 debugger

             }
         }); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-08T11:38:48.143

只需指定`'/api/drawings?id=' + this.id`为图像`src`属性。

在服务器端，您应该在之后重置内存流，`canvas.Save()`以便从头开始发送。此外，指定 http`Content-Length`标头，以便浏览器在下载时知道总大小：

```
ms.Position = 0;
r.Content.Headers.ContentLength = ms.Length; 
```

如果这不起作用，请直接在浏览器中输入 url 并启用开发人员工具以查看网络流量。

# javascript - 如何在活动的 jQuery UI 选项卡中更改图像的大小？

> ID：14762846
> 
> 赞同：0
> 
> 时间：2013-02-07T23:09:47.777
> 
> 标签：javascript, jquery, jquery-ui, tabs

我正在使用 jQuery UI 选项卡，并且在每个选项卡列表项 (li) 的锚点内都有一个图像。我想要发生的是每个非活动选项卡的图像大小为一定大小，单个活动选项卡的大小更大。我不知道该怎么做。我对 javascript 不是很好，无法弄清楚如何让脚本的 if 语句（见下文）正确......我想我需要做的就是做到这一点，以便当有一个选定的选项卡时，该选项卡内的图像获得更大的尺寸。

这是我拥有的脚本：

```
 <script type="text/javascript">
     $(function() {
         $( "#tabs" ).tabs();

         if( $('#tabs .ui-tabs-active').attr('active') ) {
             $('.theLogo').css({'width' : '120px' , 'height' : '60px'});
         }
         else {
            $('.theLogo').css({'width' : '90px' , 'height' : '45px'});
         };

     });
 </script> 
```

这是选项卡的 HTML：

```
 <div id="tabs">
                <ul>
                    <li><a href="#tabs-1"><img src="picture1.png" alt="Picture 1" name="photo" id="photo" class="theLogo" /></a></li>
                    <li><a href="#tabs-2"><img src="picture2.png" alt="Picture 2" name="photo2" id="photo2" class="theLogo" /></a></li>
                    <li><a href="#tabs-3"><img src="picture3.png" alt="Picture 3" name="photo3" id="photo3" class="theLogo" /></a></li>
                </ul>
                <div id="tabs-1">
                  <iframe class="resultFrame" src="http://www.fakesite123.net"></iframe>
                </div>
                <div id="tabs-2">
                    <iframe class="resultFrame" src="http://www.fakesite1234.net"></iframe>
                </div>
                <div id="tabs-3">
                    <iframe class="resultFrame" src="http://www.fakesite1235.net"></iframe>
                </div>
            </div> 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T23:39:30.333

Figured it out by using CSS instead of javascript. I put the following CSS:

```
 .ui-state-default img {
     width:90px;
     height:45px;
 }
 .ui-state-active img {
     width:120px;
     height:60px;
 } 
```

I hope this helps someone who runs into the same problem.

Anyone that finds a javascript solution for this is more than welcome to post it!

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T23:38:12.457

有什么理由你必须用 JS 来做吗？

```
ul#tabs li a img {width: 90px; height: 45px;}
ul#tabs li.ui-tabs-active a img {width: 120px; height: 60px;} 
```

# c++ - 为什么 std::wcout 不能输出所有 UCS-2 字符？

> ID：14762850
> 
> 赞同：-1
> 
> 时间：2013-02-07T23:10:16.113
> 
> 标签：c++, unicode, character-encoding, locale, iostream

```
#include <iostream>
#include <locale>

using namespace std;

int main()
{
    wcout.imbue(/* What to place here? */);

    for (wchar_t c = 0; c <= 0xFFFF; c++)
    {
        if (IsHumanReadable(c))
        {
            wcout << c; // c may be a Chinese or Arabic character.
        }
    }
} 
```

我的机器是基于 unicode 的 Windows 7。

上面的代码没有输出任何阿拉伯字符，而在源文件中可以正确显示相同的字符，这证明我的机器支持显示阿拉伯字符。

为什么阿拉伯字符不能在控制台窗口中显示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T01:02:12.997

第一行应该是

```
 _setmode(_fileno(stdout), _O_WTEXT); 
```

这是用于宽字符输出的适当 imbue() 的 Windows 等效项（它们仍然不支持标准 C++ 中的 Unicode，除非 C++11 提出了要求）。

检查 MSDN 的标头以#include

另请注意，安装在控制台窗口中的字体通常缺少许多其他 Windows 程序可以显示的内容。如有疑问，请将程序输出重定向到文件并使用写字板等打开该文件。

# iphone - IOS中的亮度错误

> ID：14762851
> 
> 赞同：0
> 
> 时间：2013-02-07T23:10:18.587
> 
> 标签：iphone, ios, ios5, mobile, ios6

在我的应用程序的某些部分中，我正在更改屏幕的亮度，并在某些页面上恢复为默认值，但是如果用户按下主页按钮并退出我的应用程序，当屏幕的亮度发生更改时，我无法返回屏幕亮度恢复到它的值。

我在这些委托调用上放置了代码以将亮度恢复为默认值，但它也不起作用

```
- (void)applicationDidEnterBackground:(UIApplication *)application
- (void)applicationWillEnterForeground:(UIApplication *)application
- (void)applicationWillResignActive:(UIApplication *)application
- (void)applicationDidBecomeActive:(UIApplication *)application 
```

在某些网站上，我读到它是 IOS 的错误，实际上不是错误，但它不允许您更改亮度：按下主页按钮后，操作系统会控制它。

但是存折应用程序可以做到这一点，所以有人知道有没有解决方案，或者存折可以做到这一点，因为它是由苹果编写的？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-08T00:00:50.613

如果问题确实是无法从应用程序委托方法更改亮度（我并不是说这是问题；我不确定），您可以尝试从`view[Will/Did]Disappear`相关的 UIViewController 更改它。

# javascript - 将接收到的 XML 数据从 ajax post 输出到屏幕

> ID：14762852
> 
> 赞同：0
> 
> 时间：2013-02-07T23:10:24.257
> 
> 标签：javascript, xml, ajax, cordova

不幸的是，js 和 ajax 更不是我的强项。我有一些通过 ajax 发布到站点并接收 xml 响应的代码。我需要进行一些调试，并且需要查看整个 xml 响应以确保脚本正确解析响应。

同样重要的是，这是在使用一些 phonegap 代码的移动应用程序中，所以我不能使用 FF、Chrome 等中可用的标准开发工具。

下面是相关代码：

```
$.ajax({
type: "POST",
timeout:120000,
url: urltxt,
async: true,
data:tdata,
beforeSend: function() { $.mobile.showPageLoadingMsg("c","Processing...",false);
}, //Show spinner
complete: function() { $.mobile.hidePageLoadingMsg()
}, //Hide spinner

success: function(msg){
error = "";
$(msg).find('response').each(function(){

lots of code to test various responses...
}); 
```

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T23:56:25.623

我发现打开[Fiddler](http://www.fiddler2.com/fiddler2/)，因为我正在以最佳方式捕获和检查浏览器和服务器之间的所有请求和响应。它允许您检查原始流量，或为 XML 和 JSON 提供特定于语法的过滤器，您可以从中复制到其他编辑器。您还可以保存会话以供以后使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T23:36:19.727

检查响应 xml 的最佳方法是在 firefox 或 chrome 中使用 Firebug 插件（推荐 firefox）。该插件有一个名为 net 的选项卡，它将显示任何 ajax 请求（xml、json 等）的树结构。您可以谷歌了解更多详情。希望这可以帮助 ：-）

# jquery - Jquery单击绑定第二次不起作用

> ID：14762859
> 
> 赞同：2
> 
> 时间：2013-02-07T23:10:53.890
> 
> 标签：jquery, click, bind, href

我有一个奇怪的行为，里面`a`有`img`标签。

我有一个带有记录列表的表的 php 页面。在每一行的末尾，我都有一个删除行的按钮。

这是我的表的代码：

```
<div class='edit' >
    <a id='20' href='#' return;>
        <img src='images/edit.png'  />
    </a>
</div> 
```

主表的每条记录，每一行，都有上面的代码，id互不相同。

我的脚本代码是：

```
$("#delete a").click(function(e) {

e.preventDefault();

$('#action').val("delete");
$('#keyAction').val(this.id);

$.ajax({
        type: "POST",
        url: "processAttivita.php",
        data: $("#attivita_form").serialize(),
        error: function(msg) {
            $("#errore").html(msg);
        },
        success: function(msg) {
            // display the errors returned by server side validation (if any)
            ricaricaLista();                

        }
    });     

 // end click delete event  
 }); 
```

我尝试删除的第一行单击图像效果很好。在第二个中，jquery 似乎没有绑定“click”事件并且`a`元素的默认 href 发生，由于 href 属性中的“#”而保留在同一页面上。

为什么第二次 jquery 不拦截点击`<a>`元素的任何想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-07T23:15:26.377

您正在使用`#delete a`仅匹配一个（通常是第一个）元素的 ID 选择器。

尝试使用一个类，例如`.delete a`.

`#`你只得到一个元素的原因是因为 JQuery 优化了任何以传递 to开头的选择器，`document.getElementById`它只返回 1 个元素。

这是一个如何使用事件委托来实现相同目的的示例：

```
$("#tableid").click(".delete a", function(e) {
    // your code
}); 
```

您的 html 需要在您的表格上有一个 ID，并提供`class="delete"`给您的删除链接的容器。

# data-visualization - Excel中的分层而非堆叠柱形图

> ID：14762860
> 
> 赞同：0
> 
> 时间：2013-02-07T21:50:16.913
> 
> 标签：data-visualization, excel

我想在 Excel 中将一个柱形图分层（叠加）到另一个柱形图上。所以它就像一个堆积柱形图，除了 x 轴上给定类别的每一列的原点都在 y 轴上的 0 处。我的数据是在分数之前和之后。通过将列分层而不是并排放置，可以更容易地可视化两个分数之间差异的大小和方向。我已经看到使用 R 完成此操作，但在 Excel 中找不到示例。有人尝试过吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-29T06:43:27.503

我尝试了 3D 建议，它奏效了。但我发现的另一个答案是选择一个聚集柱形图并单击“格式化数据系列”并将“重叠”百分比更改为 100%。我使用的是 Mac，所以略有不同，但帮助我的人是在 PC 上，我主要使用 PC。我最终发现使用 90% 看起来相当不错，但 100% 会达到您想要的效果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T23:19:20.953

**简短回答：**将帖子分数更改为（post - pre），然后您可以继续制作堆叠条形图。

**长而正确的答案：**不要这样做。聚类条形图要好得多，因为：

1.  无论如何，比较的视线是同一条线，您无论如何都不会促进理解。
2.  任何类型的条形重叠都会隐藏分数后的区域，从而导致视觉失真。预分 10 分和后分 20 分的列面积比应为 1:2。但如果你完全重叠它们，它会减少到 1:1。部分重叠同样有问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T22:07:51.047

我为我的论文演示做了同样的事情。这有点棘手，我自己做了。为此，您必须创建一个 3D 条形图（不是堆叠的），其中您的列被放置在彼此的前面。您必须确保每个 X 单元格中的所有较高列都位于 X 轴上该单元格中较短列的后面。

创建该图形后，您可以旋转 3D 图形，使其看起来像 2D 图形（通过将轴值重置为零）。现在您有一个条形图，其中每个条形图都有不同的列，并且所有列都从零开始。;)

# iphone - 4 英寸屏幕的 iOS 5 应用程序

> ID：14762863
> 
> 赞同：0
> 
> 时间：2013-02-07T23:11:09.210
> 
> 标签：iphone, ios, app-store, appstore-approval

我正在编写一个需要至少针对 iOS 5 的应用程序。

我还编写了它以使其与 iPhone 5 4" 屏幕兼容。

我不是 100% 确定，但我想我看到了一些事情，说苹果不会允许应用程序使用完整的 4 英寸屏幕，而不是 iOS 6 的最低目标。

即，如果您以 iOS 5 为目标并且您的应用程序使用 4" 屏幕，那么该应用程序将被拒绝。

这是真的？如果是这样，我将不得不决定牺牲什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T23:20:29.877

不，这不是真的，您可以在构建设置中将最低 iOS 版本设置为 5.0，并且仍然支持 iphone 5 屏幕。

不过，这种相反的情况是正确的。如果 Base SDK 不是 6.0，那么您就不能使用 iphone 5 的屏幕尺寸（无论如何这都是不可能的，因为没有 iphone5 可以使用 < 6.0）。

但是，您必须做出一些牺牲，例如如果您还支持 ios5，则无法使用自动布局。您必须手动处理不同的屏幕尺寸。

# python - python目录递归遍历程序

> ID：14762866
> 
> 赞同：2
> 
> 时间：2013-02-07T23:11:24.607
> 
> 标签：python, recursion, directory

我的程序不相信文件夹是目录，假设它们是文件，因此，递归将文件夹打印为文件，然后由于没有等待遍历的文件夹，程序完成。

```
import os
import sys
class DRT:
    def dirTrav(self, dir, buff):
        newdir = []
        for file in os.listdir(dir):
            print(file)
            if(os.path.isdir(file)):
                newdir.append(os.path.join(dir, file))
        for f in newdir:
            print("dir: " + f)
            self.dirTrav(f, "")
dr = DRT()
dr.dirTrav(".", "") 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-07T23:15:49.763

从那里看到[os.walk ：](http://docs.python.org/2/library/os.html#os.walk)

*此示例显示起始目录下每个目录中的非目录文件占用的字节数，除了它不在任何 CVS 子目录下查找：*

```
import os
from os.path import join, getsize
for root, dirs, files in os.walk('python/Lib/email'):
    print root, "consumes",
    print sum(getsize(join(root, name)) for name in files),
    print "bytes in", len(files), "non-directory files"
    if 'CVS' in dirs:
        dirs.remove('CVS')  # don't visit CVS directories 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T23:44:35.960

问题是你没有检查正确的事情。`file`只是文件名，而不是路径名。这就是为什么你需要`os.path.join(dir, file)`, 在下一行，对吧？所以你在`isdir`通话中也需要它。但你只是路过`file`。

所以，与其问“是`.foo/bar/baz`目录吗？” 您只是在问“是`baz`目录吗？” 正如您所期望的`baz`那样，它解释为 。`./baz`而且，由于（可能）没有“ `./baz`”，你会得到 False。

所以，改变这个：

```
if(os.path.isdir(file)):
    newdir.append(os.path.join(dir, file)) 
```

至：

```
path = os.path.join(dir, file)
if os.path.isdir(path):
    newdir.append(path) 
```

话虽如此，`os.walk`按照 sotapme 的建议使用比尝试自己构建更简单。

# python - Python - 使用 C 类型和本机 ioctl() 获取 Mac 地址会产生未知结果

> ID：14762870
> 
> 赞同：1
> 
> 时间：2013-02-07T23:11:40.690
> 
> 标签：python, python-2.7, ctypes, ioctl

我正在开发一个迷你模块，以便在 python 中为我的大学作业（不是说这是一个实际的作业，只是为了澄清）提供低级网络接口访问权限。实际的分配是在 C 中完成的，但在那之后我决定使用 ctypes 进行一些练习并启动 lib，目标是 Linux 和 Python 2.7。

我*已经*知道 Python 3.3 公开了很多我试图涵盖的功能，并且自 arround 2.3 版左右以来它已经有一个 fcntl.ioctl 模块（确切的版本并不重要，只是它存在在 2.7 中），但这个任务是为了学习。

我遇到的问题非常简单。我已经根据 C 对应物的布局定义了以下类（为了清楚起见，请忍受长片段）：

```
class struct_ifmap(Structure):
    _fields_ = [
        ('mem_start', c_ulong),
        ('mem_end', c_ulong),
        ('base_addr', c_ushort),
        ('irq', c_ubyte),
        ('dma', c_ubyte),
        ('port', c_ubyte),]

class union_ifreq_anon(Union):
    _fields_ = [
        ('ifr_addr', struct_sockaddr), 
        ('ifr_dstaddr', struct_sockaddr),
        ('ifr_broadaddr', struct_sockaddr),
        ('ifr_netmask', struct_sockaddr),
        ('ifr_hwaddr', struct_sockaddr),
        ('ifr_flags', c_short),
        ('ifr_ifindex', c_int),
        ('ifr_metric', c_int),
        ('ifr_mtu', c_int),
        ('ifr_map', struct_ifmap),
        ('ifr_slave', c_char),
        ('ifr_newname', c_char),
        ('ifr_data', c_char_p),
        ('raw', c_short * 15),]

class struct_ifreq(Structure):
    __IFNAMSIZ = 16
    _anonymous_ = [
        ('u'),]
    _fields_ = [
        ('ifr_name', c_char * __IFNAMSIZ),
        ('u', union_ifreq_anon),] 
```

以及以下功能：

```
def _getfahwdraddr(name):
    sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM,
        socket.IPPROTO_IP)
    ifr = struct_ifreq()
    ifr.ifr_name = name
    result = _libc.ioctl(sock.fileno(), 0x8927, pointer(ifr))
    if result != 0:
        raise OSError(get_errno())
    return ''.join(['%02x:' % pair for pair in \
ifr.ifr_hwaddr.sa_data[0:6]])[:-1] 
```

这给出的输出是 -6c:39:-1b:XX:XX:XX，这与真正的 MAC 不对应，即 94:39:e5:XX:XX:XX。一个线索可能是某些元素是正确的，但正如您所看到的，输出是错误的。我不知道为什么。

令人惊讶的是，我在 SO 中发现了一个类似的问题，其目的几乎相同，但使用了打包结构和 python 自己的 ioctl。它只是工作：[获取 MAC 地址](https://stackoverflow.com/questions/159137/getting-mac-address)。不过，我的问题是如何正确表示和使用 ctype 结构。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T23:34:03.020

你得到了正确的答案，你只是没有正确格式化它：

```
-6c:39:-1b:XX:XX:XX 
```

那是显示有符号字节。你想要的结果是这样的：

```
94:39:e5:XX:XX:XX 
```

这与无符号字节的值完全相同。比较：

```
>>> hex(0x100-0x6c)
'0x94'
>>> hex(0x100-0x1b)
'0xe5' 
```

你没有展示你是如何定义的`struct_sockaddr`。您可以在那里修复它，只需使用无符号类型，例如`c_uint8 * 14`代替`c_char * 14`.

或者，您可以在格式化时进行投射：

```
return ''.join(['%02x:' % c_uint8(pair).value for pair in
                ifr.ifr_hwaddr.sa_data[0:6]])[:-1] 
```

或其他 30 种解决相同问题的方法。

# php - PHP 正在更新一个不存在的数据库索引

> ID：14762873
> 
> 赞同：1
> 
> 时间：2013-02-07T23:11:46.977
> 
> 标签：php, mysql, sql, database

在我的主页上，当有人登录时，我让 jQuery 使用 AJAX 与 PHP 文件“对话”，当他们注销时也是如此。但是，当他们退出时，应该使用他们离开的时间来更新数据库索引。如果他们的姓氏的数据库条目不存在（意味着他们没有登录），则应该返回错误。相反，PHP 文件说它正在更新一个不存在的数据库索引。我正在使用 IF 语句来实现这一点。由于某种原因，它认为该索引确实存在。我检查了它正在写入的数据库，并且它应该更新的索引不存在。

这是我的代码：

```
if ($Type == 1)
{
$mysqli = new mysqli("localhost","----","----", "----");
if (!$mysqli)
    $Type = 3;

$Select = $mysqli->query("SELECT Time_Out FROM " . $Date . " WHERE Last_Name = '" . $LName . "'");
$Row = $Select->fetch_assoc();
$Row2 = $Row['Time_Out'];
if ($Row2 !== "-1") $Type = 4;

if ($Type == 1)
    {if ($mysqli->query("UPDATE " . $Date . " SET Time_Out='" . $Time . "' WHERE Last_Name='" . $LName . "'"))
        {}
     else
        {$Type = 5;}
    }

$Select = $mysqli->query("SELECT Time_In FROM " . $Date . " WHERE Last_Name='" . $LName . "'");
$Row = $Select->fetch_assoc();
$Row2 = $Row['Time_In'];
$Time2 = explode(":",$Row2);
$Hour2 =  $Hour - $Time2[0];

if ($mysqli->query("SELECT Hours FROM Names WHERE Last_Name='" . $LName . "'"))
    {$Select = $mysqli->query("SELECT Hours FROM Names WHERE Last_Name='" . $LName . "'");
     $Row = $Select->fetch_assoc();
     $Row3 = $Row['Hours'];
     $Auto += 1;}

$Time3 = 60-$Time2[1];
if ($Hour != 21) $Time4 = $Min;
$Time5 = $Time3+$Time4;
if ($Time2[0]+1 != $Hour)
    {$Time5 = $Time5+60;}
$Total = $Time5+intval($Row3);

if ($Type == 1)
{
if ($mysqli->query("UPDATE Names SET Hours = '" . $Total . "' WHERE Last_Name = '" . $LName . "'"))
    {$Auto += 1;}
else
    {$mysqli->query("INSERT INTO Names (Last_Name, First_Name, Hours) VALUES ('" . $LName . "', '" . $FName . "', '" . $Total . "')");}
}

$mysqli->close();
}

if ($Type == 1) echo "Thank you " . $FName . " " . $LName . " for signing out! See you next time!";
if ($Type == 2) echo "The entered Student ID# is invalid. Please try again!";
if ($Type == 3) echo "An unexpected error has occured. Please try again!";
if ($Type == 4) echo "You have already signed out today!" . $Auto;
if ($Type == 5) echo "You didn't sign in today."; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T01:14:07.897

UPDATE sql 语句将返回 true，即使它没有找到任何匹配项（它仍然正确运行，它只是更新 0 行）。

改变这个：

```
if ($Type == 1)
{if ($mysqli->query("UPDATE " . $Date . " SET Time_Out='" . $Time . "' WHERE Last_Name='" . $LName . "'"))
    {}
else
    {$Type = 5;}
} 
```

对此：

```
if ($Type == 1) {
    if ($mysqli->query("SELECT * FROM " . $Date . " WHERE Last_Name='" . $LName . "'")->num_rows > 0)
        $mysqli->query("UPDATE " . $Date . " SET Time_Out='" . $Time . "' WHERE Last_Name='" . $LName . "'");
    else
        $Type = 5;
} 
```

您运行 select 查询首先确定记录是否存在（如果结果的 num_rows 属性 > 0）并基于此更新记录或将返回值设置为 5。

# javascript - 未捕获的 ReferenceError：库未在 js 中定义

> ID：14762876
> 
> 赞同：0
> 
> 时间：2013-02-07T23:11:56.630
> 
> 标签：javascript, jquery, css, jquery-ui, javascript-events

我正在处理多维数据集库以显示多维数据集....我遇到错误....未捕获的 ReferenceError: Gallery is not defined fiddle.jshell.net:722

如何修复错误.....\

我的小提琴也在下面

[http://jsfiddle.net/N3GTy/12/](http://jsfiddle.net/N3GTy/12/)

在下面提供我的代码

```
<script type="text/javascript">
            /*
            |------------------------------------------|
            | MelonHTML5 - 3D Cube Gallery             |
            |------------------------------------------|
            | @author:  Lee Le (lee@melonhtml5.com)    |
            | @version: 1.02 (09 Jan 2013)             |
            | @website: www.melonhtml5.com             |
            |------------------------------------------|
            */
            Gallery = {
                _config: {
                    speed: 500,
                    size: 100,
                    lightbox: !0,
                    closeOnEsc: !0,
                    animation: "default",
                    slideshow: !1,
                    slideshow_speed: 3E3,
                    cube_speed: 1E3
                },
                lightbox_speed: 300,
                window_width: null,
                window_height: null,
                _cube_timeout: null,
                _gallery: null,
                _overlay: null,
                _lightbox: null,
                _current: null,
                _in_slideshow: !1,
                init: function() {
                    Gallery._buildContainer(!0, !0);
                    Gallery.window_width = $(window).width();
                    Gallery.window_height = $(window).height();
                    $(document).keydown(Gallery.Events.keyDown);
                    $(window).resize(Gallery.Events.windowResize);
                    Gallery._startCube()
                }, 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T23:26:44.380

你打电话`Gallery.setOptions({...})`之前`Gallery`甚至被定义。

# many-to-many - 带有 ID 列表的 EF 代码优先多对多

> ID：14762878
> 
> 赞同：0
> 
> 时间：2013-02-07T23:11:59.363
> 
> 标签：many-to-many, json.net, entity-framework-5

我在用户和客户之间有一个多对多的关系。我将 EF 5 Code First 与 Fluent API 一起使用。我的实体如下所示：

```
public class UserProfile 
{
    public int Id { get; set; }
    public virtual Collection<Client> Clients { get; set; }
}

public class Client
{
    public int Id { get; set; }
    public virtual Collection<UserProfile> Users { get; set; }
} 
```

在我的 UserProfile 配置类中有以下流利的 API 来声明关系：

```
HasMany(u => u.Clients)
    .WithMany(c => c.Users)
    .Map(m => m.MapLeftKey("UserId").MapRightKey("ClientId").ToTable("ClientUsers")); 
```

所有这一切都完美无缺，我的 Join 表就像您期望的那样创建。

我的问题是这些实体被序列化为 JSON 并且它们之间的循环依赖会导致问题。我希望做的是序列化客户或用户的 ID 列表。像这样的东西：

```
public class UserProfile 
{
    public int Id { get; set; }
    public virtual Collection<int> ClientIds { get; set; }

    [JsonIgnore]
    public virtual Collection<Client> Clients { get; set; }
}

public class Client
{
    public int Id { get; set; }
    public virtual Collection<int> UserIds { get; set; }

    [JsonIgnore]
    public virtual Collection<UserProfile> Users { get; set; }
} 
```

如何使用 Fluent API 进行配置？

或者，如果我可以将 JSON 序列化程序配置为仅序列化关系的 ID，我会同样高兴。像这样的东西：

```
public class UserProfile 
{
    public int Id { get; set; }

    [SomeAnnotation to make it only output the ID of each client]
    public virtual Collection<Client> Clients { get; set; }
}

public class Client
{
    public int Id { get; set; }

    [SomeAnnotation to make it only output the ID of each user]
    public virtual Collection<UserProfile> Users { get; set; }
} 
```

最后，我希望我的序列化 JSON 看起来像这样：

```
List of all users:
[
  {"userId": 1, "clientIds": [1,2]},
  {"userId": 2, "clientIds": [2,3]}
]

List of all clients:
[
  {"clientId": 1, "userIds": [1]},
  {"clientId": 2, "userIds": [1,2]},
  {"clientId": 3, "userIds": [2]}
] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T09:22:06.260

您无法使用流畅的 API 来实现这一点 - 这是您的序列化问题，而不是映射问题。您的映射按原样正确。您必须在不更改映射的情况下解决序列化问题 - 它可能涉及创建从映射类型投影的新 DTO 类型，然后这些类型将被正确序列化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T14:19:59.297

我想出了一个可行的解决方案，它给了我想要的东西。我很好奇社区是否认为这是一个好模式......

```
public class UserProfile 
{
    public int Id { get; set; }

    [JsonIgnore]
    public virtual Collection<Client> Clients { get; set; }

    public ICollection<int> ClientIds
    {
        get
        {
            return this.Clients == null ? null : this.Clients.Select(c => c.Id).ToList();
        }
    }
}

public class Client
{
    public int Id { get; set; }

    [JsonIgnore]
    public virtual Collection<UserProfile> Users { get; set; }

    public ICollection<int> UserIds
    {
        get
        {
            return this.Users == null ? null : this.Users.Select(c => c.Id).ToList();
        }
    }
} 
```

然后在我的 FluentAPI 配置中

```
User Configuration:
Ignore(u => u.ClientIds);

Client Configuration:
Ignore(c => c.UserIds); 
```

# intellij-idea - 可以从 IntelliJ IDEA 的打开文件列表中删除 .class 文件吗？

> ID：14762884
> 
> 赞同：29
> 
> 时间：2013-02-07T23:12:16.290
> 
> 标签：intellij-idea

我在 IntelliJ IDEA 中有一个 Android 项目。当我点击`Ctrl`++打开文件时，文件名的下拉列表包括 .class 和 .java 文件`Shift`。`N`.class 文件位于我项目的 bin 目录中。

我可以看到需要用于外部库的 .class 文件（如 jar 文件中的链接），但我不希望它们用于我自己的源。我是 IDEA 的新手，并认为这是一件简单的事情，我只是做得不对，但我似乎找不到它，这让我发疯。有任何想法吗？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-02-07T23:45:40.437

将`bin`目录设置为**Excluded**，通常 IDEA 默认会排除所有输出文件夹，并且不会显示任何`.class`文件。

![排除](../Images/1f04e3e28c143561151028acddcb1e15.png)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2014-03-21T00:42:05.040

对于 Android Studio，当“输入文件名”（CMD + SHIFT + O）窗口处于活动状态时，会出现一个蓝色三角形。单击三角形会显示要在搜索中包含/排除的文件类型的下拉列表

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-03-07T07:21:42.513

当您按 Ctrl+Shift+N 打开文件时，您会发现下面的下拉菜单中包含文件列表并取消选择过滤器下的类文件。

[https://i.stack.imgur.com/AmhxD.png](https://i.stack.imgur.com/AmhxD.png)

# three.js - 在 Three.js 中使用折痕角度生成顶点法线以实现平滑着色

> ID：14762889
> 
> 赞同：5
> 
> 时间：2013-02-07T23:12:41.283
> 
> 标签：three.js, computational-geometry

我在 Three.js 的[JSON Model Format](https://github.com/mrdoob/three.js/wiki/JSON-Model-format-3.1)中有几个对象。它指定顶点位置和面——有时是三角形，有时是四边形，有时有材质索引，有时没有。

但是，这些文件都没有指定顶点法线。

我想要一种可以在一组网格面上计算此类法线的算法。我想指定一个角度限制，超过该限制会显示折痕（顶点处的相邻面不共享法线。）

在我自己编码之前，我想知道这是否已经存在于 Three.js 中或其他可用的地方？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-07T23:30:30.840

唯一可用的是

```
geometry.computeFaceNormals();
geometry.computeVertexNormals(); 
```

请参阅算法的来源。

三.js r.55

# c++ - 创建拉普拉斯矩阵，过滤图像

> ID：14762891
> 
> 赞同：2
> 
> 时间：2013-02-07T23:12:44.030
> 
> 标签：c++, math, image-processing

我正在做一个实现图像过滤器的项目。我的问题是，用户说要在图像中应用拉普拉斯滤波器，内核是 nxn 大小。我知道拉普拉斯使用以下矩阵 3x3：

```
0  1  0

1 -4  1

0  1  0 
```

但如果他想要一个 nxn 矩阵，我该如何创建它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T23:39:49.053

图像处理中的“拉普拉斯滤波器”之所以被称为是因为您可以完全从图上离散拉普拉斯算子的正式定义中推导出它。这种方法导致两个立即有意义的卷积核，

```
1  1  1
1 -8  1
1  1  1 
```

和

```
0  1  0
1 -4  1
0  1  0 
```

，取决于您是否将对角相邻的像素视为邻居。

您当然可以使用其他矩阵作为卷积核（卷积的工作方式完全相同，操作与矩阵维度无关），但它们不再是“拉普拉斯算子”。`nxn`您可以计算近似其他连续运算符的更大卷积核，但恕我直言，拉普拉斯矩阵没有一个“正确定义” 。

要么依赖用户输入并相信用户为你的目的输入一个合理的内核，要么对如何逼近其他运算符进行一些研究。这里给出了一个拉普拉斯高斯近似值的例子：http: [//homepages.inf.ed.ac.uk/rbf/HIPR2/log.htm](http://homepages.inf.ed.ac.uk/rbf/HIPR2/log.htm)

# database - 5 场复合 PK 与代理 PK

> ID：14762896
> 
> 赞同：2
> 
> 时间：2013-02-07T23:13:13.623
> 
> 标签：database, relational-database, primary-key, composite-key

我需要创建一个数据库，动物园将使用它来跟踪他们的动物和员工等。我唯一需要帮助的是服务表，它将用于记录对动物执行的服务，例如疫苗接种或健康检查。需要记录的信息是提供服务的员工（假设每项服务只有一名员工负责）、服务的动物、提供的服务以及提供服务的日期/时间。

我的主要问题是在第一个表中显示的复合 PK 和第二个表中显示的代理 PK 之间进行选择。您能否就哪种设计最合适以及每种方法的优缺点给我您的意见。

提前感谢您的帮助。

```
+-----------------------+
|  Service              |                     
+-----------------------+
| (PK)(FK1) animal_id   |
| (PK)(FK2) employee_id |
| (PK) service_type     |
| (PK) date             |
| (PK) time             |
+-----------------------+

+-------------------+
|  Service          |                     
+-------------------+
| (PK) service_id   |
| (FK1) animal_id   |
| (FK2) employee_id |
| service_type      |
| datetime          |
+-------------------+ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T00:11:44.190

首先，不要将日期和时间分成两列。将该列*称为*“service_time”。

如果列集 {animal_id, employee_id, service_type, service_time} 唯一标识一行，则无论您是否决定使用代理键，都*必须对该列集具有唯一约束。*如果您不使用代理键，则该约束通常声明为`primary key`. 如果您*确实*使用代理键，则通常声明该约束，该集合中的每一列`unique`都有单独的约束。`not null`

如果没有任何表具有*对该*表的外键引用，那么创建一个附加列作为代理键绝对没有意义。就个人而言，即使在那时我也不会为这张表使用代理键。我知道如何写一个连接。无论如何，大多数图形查询工具都会为您完成连接。

# c - C中的函数计算字符数组

> ID：14762897
> 
> 赞同：0
> 
> 时间：2013-02-07T23:13:14.140
> 
> 标签：c

我正在尝试编写一个小程序，我基本上计算函数中的字符串长度，但由于某种原因它没有向命令行输出任何内容。

```
#include <stdio.h>

int search (char* string, char* substring){
    int length = 0;
    while(substring){
        substring++;
        length++;
    }
    return length;

}

int main(int argc, const char * argv[])
{
    char string1[] = "hello world";
    char* string = string1;
    char substring1[] = "world";
    char* substring = substring1;

    int a = search(string,substring);

    printf("%d", a);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T23:14:53.843

您需要取消引用它，否则您将继续循环，因为没有明显的方法`substring`可以变为 0。

```
while (*substring)
       ^ 
```

那是因为您不是在寻找`NULL`指针，而是在寻找 NUL ( `\0`) 字符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T23:15:06.733

`substring`是一个指针，只要它指向某处内存，它就永远不会为空（假）。

替换`while(substring)`为`while(*substring)`查找`\0`字符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T23:38:28.383

搜索功能中的“字符串”有什么意义？您正在使用 substring 变量，而不是 string 变量。

# apache-flex - flex Datagrid itemRenderer 覆盖 getCurrentState

> ID：14762898
> 
> 赞同：0
> 
> 时间：2013-02-07T23:13:19.397
> 
> 标签：apache-flex

我做了`GridItemRenderer`一个错误状态，它在验证`data[column.dataField]`内容后显示一条红色边框线，除了滚动之外的所有内容......假设顶部项目处于错误状态，其他一切都很好，因为`data[column.dataField]`它在顶部单元格中只有 null，然后我将条向下滚动一行，当新行即将显示时，我重写的 getCurrentRendererState 被调用，并检查它是否为空，它应该更改为正常状态，但这是事情，在这一点上，`data[column.dataField]`仍然有顶部的行值，所以在进行验证后`data[column.dataField]`，即使当前单元格显示当前数据，它仍然为空......那么，我怎样才能获得当前单元格值？

```
<fx:Script>
    <![CDATA[
        import custom_events.DataGridValidationEvent;
        private function creationComplete():void{
            owner.parent.parent.addEventListener(DataGridValidationEvent.VALIDATE,doValidation);
        }
        private function doValidation(e:DataGridValidationEvent):void{
            currentState=data[column.dataField]?"normal":"error";
        }
        override public function get label():String{
            return lblCell.text;
        }
        override public function set label(value:String):void{
            currentState=data?data[column.dataField]?"normal":"error":"normal"
            lblCell.text=value;
        }
        override protected function getCurrentRendererState():String{
            return data?data[column.dataField]?"normal":"error":"normal";
        }
    ]]>
</fx:Script>
<s:states>
    <s:State name="normal"/>
    <s:State name="error"/>
</s:states>
<s:Rect left="1" right="0" top="1" bottom="0" includeIn="error">
    <s:stroke>
        <s:SolidColorStroke color="0xFF001A" weight="1"/>
    </s:stroke>
</s:Rect>
<s:Label id="lblCell" width="100%" height="100%" verticalAlign="middle"
         paddingLeft="5" paddingRight="5" paddingTop="3" maxDisplayedLines="1"
         showTruncationTip="true"/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T00:08:59.903

监听数据更改事件，并在那里进行验证，现在一切都很好。

```
<fx:Script>
    <![CDATA[
        import custom_events.DataGridValidationEvent;
        private function creationComplete():void{
                owner.parent.parent.addEventListener(DataGridValidationEvent.VALIDATE,doValidation);
                addEventListener(FlexEvent.DATA_CHANGE,setState);
            }
            private function doValidation(e:DataGridValidationEvent):void{
                currentState=data[column.dataField]?"normal":"error";
            }
            private function setState(e:FlexEvent):void{
                currentState=data[column.dataField]?"normal":"error";
            }
            override public function get label():String{
                return lblCell.text;
            }
            override public function set label(value:String):void{
                currentState=data?data[column.dataField]?"normal":"error":"normal"
                lblCell.text=value;
            }
            override protected function getCurrentRendererState():String{
                return currentState;
            }
    ]]>
</fx:Script>
<s:states>
    <s:State name="normal"/>
    <s:State name="error"/>
</s:states>
<s:Rect left="1" right="0" top="1" bottom="0" includeIn="error">
    <s:stroke>
        <s:SolidColorStroke color="0xFF001A" weight="1"/>
    </s:stroke>
</s:Rect>
<s:Label id="lblCell" width="100%" height="100%" verticalAlign="middle"
         paddingLeft="5" paddingRight="5" paddingTop="3" maxDisplayedLines="1"
         showTruncationTip="true"/> 
```

# spring - 如何使用spring 3 mvc来配置struts的方式

> ID：14762899
> 
> 赞同：0
> 
> 时间：2013-02-07T23:13:43.650
> 
> 标签：spring, redirect, spring-mvc, mapping, forward

我有一个控制器，它根据变体条件返回`ModelAndView("showpage")`、`ModelAndView("forwardToAAA")`或。`ModelAndView("rediretToBBB")`映射应该是这样的：

```
showpage: showpage.jsp
forwardToAAA: /AAAController.do
redirectToBBB: /BBBController.do 
```

我可以通过将其硬编码到控制器中来做到这一点，例如`forward:/AAAController.do`, 和`redirect:/BBBController.do`. 但我希望它在配置文件中定义，并让视图解析器解决。

在 Spring 3 MVC 中执行此操作的最佳方法是什么。它可以在struts中轻松完成。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T02:21:45.360

如果您在某处加载了 .properties 文件，则可以使用 Spring EL 从中读取值。

例如，如果您的属性文件中有一个名为*com.value.url1*的属性，则可以将其添加到您的类中以将该值拉入：

```
@Value("#{ systemProperties['com.value.url1'] }")
private String url1; 
```

我相信还有其他方法，例如您可以在表格中拥有属性并将它们读入或其他方式，但我认为 .properties 文件是最简单的。

# c# - 在 C# 中快速阅读的集合

> ID：14762901
> 
> 赞同：1
> 
> 时间：2013-02-07T23:14:05.900
> 
> 标签：c#

我正在为以下场景寻找一个集合类：

*   快速集合查找，一次一项。
*   该集合包含大约 300 K 项。
*   收集人口速度可能并不重要，但理想情况下也很快。
*   加载集合后无需更新/删除/插入

`Ip2Location`将填充到集合中的类型项目示例：

```
public class Ip2Location
{
   public long IpFrom {get; set;}
   public long IpTo {get; set;}
   public string Country {get; set;}  
}

IpFrom      IpTo        Country
16909056    16909311    AU
16909312    16941055    US 
```

针对集合的项目查找是通过指定的 IP 完成的，如下所示：

```
IpFrom < currentIp < IpTo 
```

任何想法，包括参考链接，将不胜感激！

比较：`HashSet, SortedSet`

有没有更好的收藏类？

参考：下面链接中的对照表：http: [//geekswithblogs.net/BlackRabbitCoder/archive/2011/06/16/c.net-fundamentals-choosing-the-right-collection-class.aspx](http://geekswithblogs.net/BlackRabbitCoder/archive/2011/06/16/c.net-fundamentals-choosing-the-right-collection-class.aspx)

**更新**：

使用 Array.BinarySearch 的问题：

```
var index = Array.BinarySearch(ipCountries, new IpCountry { IpFrom = 16909056}, new Ip2LocationComparer()); 
```

它适用于少量行，不适用于 300k 项（例如索引为 -(totalrow+1) ）。搜索项目加载在 300 K 项目集合中。

```
 public class Ip2LocationComparer: IComparer<IpCountry>
        {
            public int Compare(IpCountry x, IpCountry y)
            {
                if (x != null && y != null)
                    return (x.IpFrom <= y.IpFrom && y.IpFrom <= x.IpTo)? 0 : -1;

                return -1;

            }
        } 
```

**更新 2**

我把它改成下面

```
public class Ip2LocationComparer: IComparer<IpCountry>
            {
                public int Compare(IpCountry x, IpCountry y)
                {
       if (x != null && y != null)

            {
                if (x.IpFrom > y.IpFrom)
                    return 1;

                if (x.IpFrom < y.IpFrom)
                    return -1;

                if (x.IpFrom == y.IpFrom)
                {
                    if (y.IpFrom > x.IpTo)
                        return 1;

                    if (y.IpFrom < x.IpTo)
                        return -1;

                }

            }

            return 0;
} 
```

但是 BinarySearch 的索引返回仍然是负数，正好在匹配项和后续项之间。例如，如果我的搜索 IpFrom 为 3，则索引在 2 和 4 之间。为什么它不返回 2？我还没有测试 IpTo 场景。

任何想法将不胜感激！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T23:17:46.390

您可以将其存储在数组中。

如果您在填充后对数组进行排序，那么[BinarySearch](http://msdn.microsoft.com/en-us/library/2cy9f6wb.aspx)将是一种非常快速的方法来查找您的`currentIp`跌落位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T23:20:51.297

数据结构方面，您可以尝试使用字典或排序列表，尽管有 300000 个项目，您可能会遇到问题。不过，我很想知道结果。带有 BinarySearch 的普通数组也可能不是一个坏选择。

您还可以考虑利用机器上的所有内核进行快速查找。您可以在大多数集合上使用[.AsParallel() 扩展方法](http://msdn.microsoft.com/en-us/library/system.linq.parallelenumerable.asparallel.aspx)，这将为在多个核心上查询的集合做好准备。

# mysql - 不正确的整数值：第 1 行的列 'id' 的 ''

> ID：14762904
> 
> 赞同：35
> 
> 时间：2013-02-07T23:14:18.507
> 
> 标签：mysql, insert

我正在尝试插入我的 mySQL 数据库。第一列是“id”列，因为它是一个 auto_increment 字段，所以我将其留空。出于某种原因，我无法插入，并且收到下面提到的错误。我很感激这方面的任何帮助。

尝试插入时出现以下错误：

```
Incorrect integer value: '' for column 'id' at row 1 
```

我的查询

```
$insertQuery = "INSERT INTO workorders VALUES('', '$priority', '$requestType', '$purchaseOrder', '$nte', '$jobSiteNumber')"; 
```

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-02-07T23:15:44.410

这可能意味着您`id`是一个`AUTO_INCREMENT`整数，并且您正在尝试发送一个字符串。您应该指定一个列列表并将其从`INSERT`.

```
INSERT INTO workorders (column1, column2) VALUES ($column1, $column2) 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2013-02-07T23:24:57.820

要让 MySql 为`AUTO_INCREMENT`字段生成序列号，您有三个选项：

1.  按照 njk 的建议，指定列出一个列列表并从中省略您的 auto_incremented 列。**那将是最好的方法。**看评论。
2.  显式分配 NULL
3.  显式分配 0

[3.6.9。使用 AUTO_INCREMENT](http://dev.mysql.com/doc/refman/5.0/en/example-auto-increment.html)：

> ...**没有**为 AUTO_INCREMENT 列指定值，因此 MySQL 自动分配了序列号。您还可以将**NULL**或**0**显式分配给列以生成序列号。

这三个语句将产生相同的结果：

```
$insertQuery = "INSERT INTO workorders (`priority`, `request_type`) VALUES('$priority', '$requestType', ...)";
$insertQuery = "INSERT INTO workorders VALUES(NULL, '$priority', ...)";
$insertQuery = "INSERT INTO workorders VALUES(0, '$priority', ..."; 
```

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2018-11-05T12:45:19.667

尝试编辑您的**my.cf**并评论原始 sql_mode 并添加**sql_mode = ""**。

```
vi /etc/mysql/my.cnf 
```

> sql_mode = ""

保存并退出...

```
service mysql restart 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-11-28T07:06:11.643

这是因为您的数据发送列类型是整数，并且您正在向其发送字符串值。

因此，以下方式对我有用。试试这个。

```
$insertQuery = "INSERT INTO workorders VALUES (
                    null,
                    '$priority',
                    '$requestType',
                    '$purchaseOrder',
                    '$nte',
                    '$jobSiteNumber'
                )"; 
```

不要使用`'null'`. 使用它作为`null`没有单引号。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-05-06T07:50:45.350

对于相同的错误`wamp/phpmyadmin`，我已经编辑并`my.ini`评论了原文：

```
;sql-mode= "STRICT_ALL_TABLES,ERROR_FOR_DIVISION_BY_ZERO,NO_ZERO_DATE,NO_ZERO_IN_DATE,NO_AUTO_CREATE_USER" 
```

并补充道`sql_mode = ""`。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-08-26T15:18:16.440

如果有 phpMyAdmin，只需转到变量并查找 SQL 模式，变量，编辑它并删除变量的所有内容，然后保存。对于那些不想接触代码的人来说，这也应该可以解决这个问题。

# javascript - 使用无限滚动 jQuery 重新触发 masonry.js

> ID：14762905
> 
> 赞同：0
> 
> 时间：2013-02-07T23:14:18.910
> 
> 标签：javascript, jquery, tumblr

我正在为一个朋友开发一个 Tubmlr 网站，他们使用砖石以及无限滚动插件。

滚动插件是从第三方拉入的脚本，并在页面上触发砌体......

```
 $(document).ready(function () {
        $('.autopagerize_page_element').masonry();        
    }); 
```

当滚动重新加载更多帖子但砌体插件不起作用时，我猜这是因为它需要再次重新触发，只是我不确定如何？

我试过使用

```
setInterval(function(){
    // masonry
},100); 
```

继续检查我没有运气，有人能给我任何想法吗？

# c# - 如何使用 C# 从具有 Class 和 ClassnameNN 的控件中获取文本

> ID：14762907
> 
> 赞同：0
> 
> 时间：2013-02-07T23:14:33.670
> 
> 标签：c#, autoit-c#-wrapper

[我可以使用AutoIt](http://en.wikipedia.org/wiki/AutoIt)轻松地通过以下[`ControlGetText`](http://www.autoitscript.com/autoit3/docs/functions/ControlGetText.htm)功能从控件中检索文本：

```
ControlGetText ("title", "text", controlID) 
```

我需要对 C# 做同样的事情。一个包含要导入的类的完整示例正是我所需要的。

我在 AutoIt 窗口信息中显示了以下控件参数。

### 班级

“WindowsForms10.STATIC.app.0.33c0d9d”

### 类名NN

“WindowsForms10.STATIC.app.0.33c0d9d62”

... Instance , Name, ID , handle, **Text "7 - 18:50"**（这是我需要检索的文本）。

最好，我需要使用`Class`and来检索文本`ClassnameNN`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T09:44:47.163

这是如何在 C# 中使用 AutoIt 发送和获取文本的示例：

```
private void controlGetTextbutton_Click(object sender, EventArgs e)
{
    //Open Notepad
    autoit.Run("notepad.exe", "", 1);

    //Wait for Notepad to open with a timeout of 10 seconds
    autoit.WinWait("[CLASS:Notepad]", "", 10);

    //Send text example
    autoit.ControlSend("[CLASS:Notepad]", "", "Edit1", "autoitsourcode.blogspot.com", 0);

    //Get the texts
    string strReturnText = autoit.ControlGetText("[CLASS:Notepad]", "", "Edit1");

    returnGetTextLabel.Text = "Return text from text area notepad : \n" + strReturnText;
} 
```

*[此外，您可以在Autoit Control Get Text](http://autoitsourcecode.blogspot.com/2013/04/autoit-control-get-text.html)*中使用 C# 获取所有 AutoIt 功能。

# sql - 避免 SQL 查询中的冗余代码

> ID：14762911
> 
> 赞同：2
> 
> 时间：2013-02-07T23:14:49.593
> 
> 标签：sql, oracle, aggregate-functions

我有 Light Athletic 比赛结果的表格。玩家获得前三名的积分。我需要列出他们的点的田径运动员名称。我有这个：

```
SELECT NAME, SUM(many) as sum FROM
(
(SELECT NAME, count(*) * (SELECT points from "points for place" where place = 1)  as many
FROM RESULTS R1 WHERE
(SELECT count(*) FROM RESULTS R2 WHERE
    R1.result < R2.result
    AND R1.DISCIPLINE = R2.DISCIPLINE
    AND R1.CITY = R2.CITY) = 0
GROUP BY NAME)
UNION
(SELECT NAME, count(*) * (SELECT points from "points for place" where place = 2)  as many
FROM RESULTS R1 WHERE
(SELECT count(*) FROM RESULTS R2 WHERE
    R1.result < R2.result
    AND R1.DISCIPLINE = R2.DISCIPLINE
    AND R1.CITY = R2.CITY) = 1
GROUP BY NAME)
UNION
(SELECT NAME, count(*) * (SELECT points from "points for place" where place = 3)  as many
FROM RESULTS R1 WHERE
(SELECT count(*) FROM RESULTS R2 WHERE
    R1.result < R2.result
    AND R1.DISCIPLINE = R2.DISCIPLINE
    AND R1.CITY = R2.CITY) = 2
GROUP BY NAME)
)
GROUP BY NAME ORDER BY SUM; 
```

我有三倍几乎相同的冗余代码。如果这不取决于地方，我可以使用 View ...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T23:38:44.883

我认为您可以从根本上简化为：

```
SELECT name, sum(p.points) AS total_points
FROM  (
    SELECT r1.name
          ,sum((r1.result > r2.result)::int) + 1 AS place
    FROM   results r1
    LEFT   JOIN results r2 USING (discipline, city)
    GROUP  BY 1
    HAVING sum((r1.result > r2.result)::int) < 3
    ) r
JOIN   "points for place" p USING (place)
GROUP  BY r.name
ORDER  BY total_points; 
```

这是用**PostgreSQL**测试的。
由于 OP 后来宣布 Oracle，这是 Oracle 的另一个**版本**：

```
SELECT name, SUM(p.points) AS total_points
FROM  (
   SELECT r1.name
         ,SUM(CASE WHEN r1.result > r2.result THEN 1 ELSE 0 END) + 1 AS place
   FROM   results r1
   LEFT   JOIN results r2 USING (discipline, city)
   GROUP  BY r1.name
   HAVING SUM(CASE WHEN r1.result > r2.result THEN 1 ELSE 0 END) < 3
) r
JOIN   "points for place" p USING (place)
GROUP  BY r.name
ORDER  BY total_points; 
```

应该提供与问题中的查询相同的结果。只有更快更简单。
[-> **sqlfiddle 并排**](http://www.sqlfiddle.com/#!4/7c2d2/29)显示新查询和原始查询。

现在我知道这个查询是关于什么的：`dense_rank()`显然是更好的解决方案。

### 要点

*   对于 Postgres，计算低于`sum((r1.result < r2.result)::int)`的次数。转换为 TRUE 为 1，FALSE 为 0。 对于 Oracle，此表达式的作用相同：`r1.result``r2.result``boolean``integer`

    ```
     SUM(CASE WHEN r1.result < r2.result THEN 1 ELSE 0 END) 
    ```

*   我添加`1`到该计数并命名它以从表`place`中获取它。`points``"points for place"`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-08T01:55:02.900

您可以通过以下方式简化此操作：

```
select r.name, 
       sum(p.points) total_points
  from (select city, discipline, name, 
               row_number() over (partition by city, discipline order by result) place
         from results r) r
       inner join "points for place" p
               on p.place = r.place
 where p.place <= 3 
 group by r.name
 order by total_points desc; 
```

* 注意：如果有平局，并且您希望两者都算作那个地方，请使用`dense_rank()`而不是`row_number()`

考虑到您的测试数据，这也`where p.place <= 3`可能是多余的，因为您只有 3 个得分点……所以您可以省略它。我已经把它留在了。

但我感到困惑的是，在你原来的 SQL 和 Erwins 的回答中，你们都颠倒了这些地方。即跑得最长的人是第一名？！

即在你的小提琴中你有：

```
-- RESULTS --
INSERT INTO results VALUES
('9.87', 'Doha', '100m', 'Justin GATLIN');
...
INSERT INTO results VALUES
('10.28', 'Doha', '100m', 'Jimmy VICAUT'); 
```

现在我在 9.87 秒内读到贾斯汀赢了。但是你们都认为这是吉米的胜利。

如果是这样，那么分析应该是

```
partition by city, discipline order by result desc 
```

# c - 未创建线程的异常错误？

> ID：14762920
> 
> 赞同：0
> 
> 时间：2013-02-07T23:15:22.350
> 
> 标签：c, pthreads

我有以下主程序：

```
int main(int argc, char** argv) {

    /*checkParameters(argc,argv);*/

    if (pthread_create(&supplierid, NULL, &supplier, NULL) != 0);
        error("ERROR creating supply threads \n");

}

void *supplier () {

    printf("hello? \n"); 

    while (timeremaining >= 0) {

        printf("\n the stock is %d" , stock);
        printf("\n the supply ies %d", supply);

        timeremaining--;

        if (stock + supply > cap_max)
            stock = cap_max;
        else
            stock = stock + supply;

        sleep(0.1);
    }

    exit(EXIT_SUCCESS);
} 
```

好吧，95% 的时间我运行这个程序我得到错误创建供应线程。它从不打印你好。这是没有意义的。它只有 1 个线程。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T23:16:39.987

您的语句后有一个分号`if`：

```
if (pthread_create(&supplierid, NULL, &supplier, NULL) != 0); 
```

这意味着看起来嵌套在语句中的`if`语句实际上根本没有嵌套，并且无论条件如何都将始终执行。具体来说，C 将您的代码解释为

```
if (pthread_create(&supplierid, NULL, &supplier, NULL) != 0)
    ; /* Do nothing */

error("ERROR creating supply threads \n"); 
```

要解决此问题，请删除杂散分号。

希望这可以帮助！

# javascript - 如何检测音频已播放 30 秒？

> ID：14762923
> 
> 赞同：1
> 
> 时间：2013-02-07T23:15:27.677
> 
> 标签：javascript, html, windows-8, java-metro-framework

我有一个音频标签，可以从网页 url 流式传输音乐。一旦歌曲超过 30 秒，我想让它运行一段代码。实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T23:37:58.547

`timeupdate`向控件引发的事件添加处理程序`audio`。在处理程序内部，查看控件的`currentTime`属性。

```
var audioControl = document.getElementById('myaudio');
audioControl.ontimeupdate = function () {
    if (audioControl.currentTime >= 30) { 
        // do something
    }
} 
```

# javascript - 使用 jQuery 触摸打孔时如何防止移动设备中的文档滚动

> ID：14762928
> 
> 赞同：2
> 
> 时间：2013-02-07T23:15:42.307
> 
> 标签：javascript, jquery, jquery-ui, mobile

我有一个案例，我在图像上有一个可拖动的可调整大小的 div（裁剪器）。为了在移动设备上工作，我导入了 jQuery touch punch 插件。问题是在页面周围移动可拖动对象时想要滚动。我模拟了一个例子。以下代码将我的滚动修复到正确的位置。这适用于PC，但不适用于Android手机。

```
 $("#drag").draggable({
                containment : "parent"
        });

        $("#drag").resizable({
            handles: {
                'ne': '#negrip',
                'se': '#segrip',
                'sw': '#swgrip',
                'nw': '#nwgrip'
            }
        });

$("#noScroll").click(function (e) {
        $("body").addClass("stop-scrolling");
        $(document).scroll(function(e) { $(this).scrollTop(1000);});
        $(document).bind('touchstart', function(e){e.preventDefault()});
        $(document).bind('touchmove', function(e){e.preventDefault()});    
}); 
```

```
<body>

<div style="height: 500px; border : 1px solid;">big div</div>       
<a id="noScroll">STOP SCROLLING</a>
        <span id="holder">
                        <span id="drag">
                            <div class="ui-resizable-handle ui-resizable-nw" id="nwgrip"></div>
                            <div class="ui-resizable-handle ui-resizable-ne" id="negrip"></div>
                            <div class="ui-resizable-handle ui-resizable-sw" id="swgrip"></div>
                            <div class="ui-resizable-handle ui-resizable-se" id="segrip"></div>
                        </span>
                        <img id="img" src="http://halo.bungie.org/misc/assaultgodzilla_japanhalo2/lg/06_call_of_spartans.jpg" />
                </span>
</body> 
```

分隔符

```
 #holder { height:300px; width:300px; border:1px solid; display:block; position: relative; overflow:hidden; margin: 0 auto; }
        #img { height:1000px; width:1000px; display: block; background: no-repeat; overflow: hidden; }
        #drag { height:100px; width:100px; border: 1px solid #000000; background: #FFFFFF; display: block; position:absolute; top:0px; z-index:33; opacity:.6; }
  .stop-scrolling { height:100%; overflow:hidden; }

        #nwgrip, #negrip, #swgrip, #segrip, #ngrip, #egrip, #sgrip, #wgrip {
            width: 20px;
            height: 20px;
            background-color: #ffffff;
            border: 1px solid #000000;
        }

        #nwgrip { top: 0; left: 0; }
        #negrip { top: 0; right: 0; }
        #segrip { bottom: 0; right: 0; }
        #swgrip { bottom: 0; left: 0; } 
```

在手机上稍微放大，滚动到底部，然后单击停止滚动。现在拖动小框，您会注意到如果您将其快速拉到顶部，页面会尝试滚动。

指向小提琴和直接 js shell 链接的链接是：

[http://jsfiddle.net/jMtjC/3/](http://jsfiddle.net/jMtjC/3/) [http://fiddle.jshell.net/jMtjC/3/show/](http://fiddle.jshell.net/jMtjC/3/show/)

转到移动设备上的 js shell 链接。提前致谢！！

# c# - 为什么我尝试打开串口时得到“CreateFile Failed: 161”？

> ID：14762929
> 
> 赞同：4
> 
> 时间：2013-02-07T23:15:44.027
> 
> 标签：c#, serial-port, windows-ce, zebra-printers, opennetcf

我在 serialPort.Open() 行上得到“CreateFile Failed: 161”：

```
. . .
      MessageBox.Show(string.Format("Made it into PrintUtils.PrintBarcode()"));
using (SerialPort serialPort = new SerialPort())
{
    MessageBox.Show("Made it into using statement in PrintUtils.PrintBarcode()"); 
    serialPort.BaudRate = 19200;
    serialPort.Handshake = Handshake.XOnXOff;
    serialPort.DataBits = 8;
    serialPort.Parity = Parity.None;
    serialPort.StopBits = StopBits.One;
    serialPort.PortName = "COM1"; // Is this what it wants?
    MessageBox.Show("Made it beyond the protocol assignments in PrintUtils.PrintBarcode()"); 

    serialPort.Open(); // <-- This causes "CreateFile Failed: 161"
    MessageBox.Show("Opened the serial port in PrintUtils.PrintBarcode()"); 

    Thread.Sleep(2500); // I don't know why this is needed, or if it really is...

    // Try this first:
    serialPort.WriteLine("! 0 200 200 210 1");
    MessageBox.Show("Sent the first line in PrintUtils.PrintBarcode()"); 
    serialPort.WriteLine("TEXT 4 0 30 40 Bonjour la Monde"); //Hola el Mundo --- Hallo die Welt
    MessageBox.Show("Sent the TEXT line in PrintUtils.PrintBarcode()"); 
    serialPort.WriteLine("FORM");
    MessageBox.Show("Sent the FORM line in PrintUtils.PrintBarcode()"); 
    serialPort.WriteLine("PRINT");
    MessageBox.Show("Sent the PRINT line in PrintUtils.PrintBarcode()"); 
    // or (if WriteLine does not include a carriage return and line feed):
    //              serialPort.Write("! 0 200 200 210 1\r\n");
    //              serialPort.Write("TEXT 4 0 30 40 Bonjour la Monde\r\n"); //Hola el Mundo --- Hallo die Welt
    //              serialPort.Write("FORM\r\n");
    //              serialPort.Write("PRINT\r\n");

    serialPort.Close();
    MessageBox.Show("Closed the port in PrintUtils.PrintBarcode()"); 
} 
```

我知道，因为我看到的最后一个“调试消息”是“超出了 PrintUtils.PrintBarcode() 中的协议分配”

是因为其中一个协议是错误的还是格式不正确？还是我省略了所需的协议分配？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-08T00:04:09.360

错误 161 意味着`The specified path is invalid.`您得到它是因为您的端口名称无效。

Windows CE 要求端口名称（实际上是所有驱动程序名称）后缀为 ':' 字符，因此您的代码应为：

```
serialPort.PortName = "COM1:"; 
```

# java - 杰克逊 2.1.3 的 web.xml

> ID：14762934
> 
> 赞同：0
> 
> 时间：2013-02-07T23:15:52.717
> 
> 标签：java, jersey, jackson

我的 web.xml 中应该有什么才能使用 jackson 的 2.1.3 版？

使用 1.9 时，我必须：

```
<init-param>
  <param-name>com.sun.jersey.config.property.packages</param-name>
  <param-value>org.codehaus.jackson.jaxrs;com.rewardy.ws</param-value>
</init-param>
<init-param>
    <param-name>com.sun.jersey.api.json.POJOMappingFeature</param-name>
    <param-value>true</param-value>
</init-param> 
```

但这似乎已经过时了，我可以找到使其工作相同的文档。（或者也许我仍然缺少一些文件......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T19:50:53.243

只需添加 Jackson 2.x jar，包括 JAX-RS 提供程序（用于 JSON，可能还有 XML）。这将自动注册，您根本不需要设置 POJOMappingFeature。

# php - Android：如何使用 php 在 mysql 中上传图片

> ID：14762936
> 
> 赞同：2
> 
> 时间：2013-02-07T23:16:06.573
> 
> 标签：php, android, mysql, image

我在 ImageView 中有用户选择的图像...如何使用 php 将其插入到 mysql 数据库表中？

任何人都可以帮助我。

我希望图像保存在其上的列类型是 Blob。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-02T10:48:54.300

OK that i found a solution for my question

code in java assuming that the image is already converted to bitmap:

```
 ByteArrayOutputStream stream = new ByteArrayOutputStream();
        bmIcone.compress(Bitmap.CompressFormat.PNG, 90, stream);
        byte[] byte_arr = stream.toByteArray();
        String image_str = Base64.encodeBytes(byte_arr);
        namevaluepair.add(new BasicNameValuePair("image", image_str)); 
```

in server :

```
$base= $_REQUEST['image'];
    $buffer = base64_decode($base);

    $buffer = mysql_real_escape_string($buffer); 
```

then inserting the $buffer to table blob column type

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T23:37:28.713

首先，你必须在android中调用你的php。关于这个主题已经存在许多答案：

*   [从android调用PHP函数？](https://stackoverflow.com/questions/10312728/call-php-function-from-android)
*   [http://fahmirahman.wordpress.com/2011/04/21/connection-between-php-server-and-android-client-using-http-and-json/](http://fahmirahman.wordpress.com/2011/04/21/connection-between-php-server-and-android-client-using-http-and-json/)

为了回答您的问题，本教程教您如何编写 php 以在 MySQL 中存储图像：

*   [http://forum.codecall.net/topic/40286-tutorial-storing-images-in-mysql-with-php/](http://forum.codecall.net/topic/40286-tutorial-storing-images-in-mysql-with-php/)

# php - 如何根据键获取数组值？

> ID：14762937
> 
> 赞同：0
> 
> 时间：2013-02-07T23:16:18.200
> 
> 标签：php, arrays

我正在尝试根据键从数组中获取值。

我有

```
$array1{
 '0' =>'text1',
 '1' =>'text2',
 '2' =>'text3'
}

$array2{
 '0' =>'123',
 '1' =>'456',
 '2' =>'789'
}

 //$source could be text1,text2 or text3
 //I want to show 123, 456 or 789 based on the value passed in
       if(in_array($source, $array1)){
         $id=array_keys($array1,$source);
         echo $array2[$id];
       } 
```

`illegal offset type`由于`$array2[$id]`. _

有没有办法解决这个问题？非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T23:19:21.323

我认为您需要[array_search](http://php.net/manual/en/function.array-search.php)。尝试：

```
if($id = array_search($source, $array1))
     echo $array2[$id]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T23:40:39.647

```
$array1 = array('0' => 'text1', '1' => 'text2', '2' => 'text3');
$array2 = array('0' => '123', '1' => '456', '2' => '789');

$source = "text2";

foreach ($array1 as $key => $value) {

    if ($value === $source) {
        echo "value = " . $array2[$key];
    }

} 
```

output: value = 456

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T23:19:05.307

使用[`array_search`](http://php.net/array-search)而不是[`array_keys`](http://php.net/array-keys). 您想要第一个值为 的键`$source`，而不是包含所有具有该值的键的数组。

# sql - 没有短路评估的 CASE 表达式？

> ID：14762939
> 
> 赞同：1
> 
> 时间：2013-02-07T23:16:33.873
> 
> 标签：sql, sqlite, case, short-circuiting

我最近开始自学（糟糕的）SQLite。令我感到恼火的一件事是 CASE 表达式，即它采用短路评估这一事实。

有没有办法解决这个问题？我正在寻找不采用短路评估的 CASE 语句。

```
UPDATE [table]SET [counting_column] =

(
CASE
    when [column1] = NULL 
    then [counting_column] + 1

    ...

    when [column31] = NULL
    then [counting_column] + 1
end
) 
```

我希望数据库中的每个条目都由每个 case 语句进行测试，而不仅仅是第一个评估为 true 的条目。任何帮助将非常感激。

注意：如果有一些明显的错误，我深表歉意——我对此很陌生，所以请放轻松。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T03:35:21.853

如果您确实只是`counting_column`为满足的每个条件加 1，则可以使用*n* `CASE`语句链并将结果加在一起。每个人`CASE`提供一个`0`或`1`，所有这些加在一起并添加到 的当前值`counting_column`。

```
UPDATE [table] SET [counting_column] =
(
  [counting_column] + 
  (CASE when [column1] IS NULL then 1 ELSE 0 END) +
  (CASE when [column2] IS NULL then 1 ELSE 0 END) +
    ...
    ...
  (CASE when [column30] IS NULL then 1 ELSE 0 END) +
  (CASE when [column31] IS NULL then 1 ELSE 0 END)
) 
```

`= NULL`请注意，我已将`IS NULL`. `NULL`是一个特殊的非值，不能与等式进行比较`=`。

我还要指出，虽然`[]`封闭的标识符在 SQLite 中是可以的，但这主要是为了与 T-SQL 兼容。更标准的方法是使用双引号，如`UPDATE "table" SET "counting_column" = ...`

# android - 如何以特定间隔重复某些操作？

> ID：14762940
> 
> 赞同：0
> 
> 时间：2013-02-07T23:16:36.123
> 
> 标签：android, android-service, android-notifications

在我的应用程序中，我可以在`every day, every week`没有任何用户交互的情况下重复某些操作等。即，如果用户甚至不使用应用程序，则必须进行操作（将数据插入数据库）。搜索了很多，但对实现这一目标一无所知。我想过`Local Notification`，但不知道这是一个好主意还是有更好的方法来实现这一点。

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T23:27:04.760

你想调查一下[`AlarmManager`](http://developer.android.com/reference/android/app/AlarmManager.html)。把它想象成你的 android 应用程序的 unix cron。简而言之，您计划`Intent`在将来触发。然后你写一个`BroadcastReceiver`来处理意图，并在这里做任何你想做的事情。

当然，魔鬼在细节中。密切注意诸如将任何耗时的工作从广播接收器卸载到服务线程，并确保您事先获得唤醒锁。这些是 SO 答案中无法正确涵盖的高级主题。

# java - 创建 Bot 以玩通过 RESTful 接口定义的游戏

> ID：14762942
> 
> 赞同：0
> 
> 时间：2013-02-07T23:16:42.773
> 
> 标签：java, rest, artificial-intelligence, bots, restful-architecture

我想知道如何开始构建一个机器人来玩一个通过 RESTful 接口定义的棋盘游戏，该接口具有诸如……加入游戏、检索游戏状态、检查回合、检索玩家状态和做出动作等方法.

我的问题是，**我的机器人（用 java 编写）如何知道什么时候轮到播放？由于游戏是通过 RESTful 接口定义的，我的客户端是否应该一遍又一遍地调用“checking turn”REST 方法，直到轮到我的机器人玩？就像每半秒？**

我的客户如何优雅地跟上游戏的当前状态？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T04:38:50.977

REST 被万维网使用，因此它可以像 Web 一样扩展和处理冲突。

您的 TURN（或任何适当的操作）可以是 Resource，并且客户端可以经常使用或headers来获取`poll`此资源。这些标头使用非常少的带宽并且工作非常有效。`e-tag``If-Modified`

除非对手修改`state of TURN Resource`，否则其他对手将等待（客户端应用程序）。

如果`If-Modified-Since`（自对手 1 采取行动的时间）为正，则意味着资源状态`move`从对手 2 发生变化，因此控制权返回对手 1，对手将依次进行修改`move`，以便控制权转到对手 2，等等。

希望这可以澄清

# perl - perl 中的模式替换

> ID：14762946
> 
> 赞同：-1
> 
> 时间：2013-02-07T23:16:52.113
> 
> 标签：perl

我想用字符串 2 替换下面的 line(string1)。知道我应该如何在 perl 中做到这一点吗？

```
$string1=project/Import/files/mymux.v 
```

替换为 =>`project/micro/target_lib/MYMUX/functional/verilog.v`

在替换字符串中，micro、target_lib、verilog 和functional 是不变的东西。我只需要将mymux.v 分解为MYMUX 和verilog.v。任何帮助，将不胜感激！

问候，桑迪普

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T23:36:13.647

```
my ($n) = $string1 =~ m{/([^/]+)\.v\z}
   or die;

my $string2 = 'project/micro/target_lib/'.uc($n).'/functional/verilog.v'; 
```

# ruby - 使用机械化进行身份验证回调

> ID：14762947
> 
> 赞同：0
> 
> 时间：2013-02-07T23:16:58.037
> 
> 标签：ruby, ajax, mechanize, web-crawler

到目前为止，我已经得到了一些关于 Mechanize 的很好的答案，所以感谢 StackOverflow！

这是另一个：

即使是基于 Ajax 的登录，我也一直在使用 Mechanize，到目前为止，它对我来说运行良好。现在，我遇到了一个有点令人困惑的场景。

当我点击登录按钮时，有一个回调 url 的 GET 请求，如下所示：

```
https://www.gilt.com/login/auth?callback=jQuery1720030715713743120432_1360278619610&email=username%40gmail.com&password=password&remember_me=on&_=1360278631042 
```

以下查询词是什么意思？

```
callback=jQuery1720030715713743120432_1360278619610 
```

和

```
_=1360278631042 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T00:50:20.827

它看起来像一个 jquery 版本号和一个时间戳。可能没有什么你应该关心的。

# java - 初始化类和堆栈溢出错误的正确方法

> ID：14762949
> 
> 赞同：0
> 
> 时间：2013-02-07T23:17:22.973
> 
> 标签：java, class, nullpointerexception, stack-overflow

这可能是一个愚蠢的问题，但我已经厌倦了。如何正确初始化类对象，以便访问其中的方法和变量？这是我的代码：

```
public class GenChunk {

Chunk c;
VBO vbo;

int worldSize = 64;
int var1 = 16; //x
int var2 = 16; //z
int var3 = 16; //y

public GenChunk(){
    gen();
}

public void gen(){
    c = new Chunk();
    if(c.chunkChanged == false){
        for(int i = 0; i < worldSize; i++){
            newChunk();
        }
    }
} 
```

该行`c = new Chunk()`导致堆栈溢出错误。，我意识到原因（因为它创建了它的新实例并占用了越来越多的内存），但是一旦我在构造函数中初始化它或者只是做`Chunk c = new Chunk()`，在下面的顶部`public class GenChunk {`我得到另一个堆栈溢出错误！如果我不初始化类，我会得到一个空指针（显然）。我的代码有什么问题？我一定是忽略了什么，但我想不通！

这是我的 Chunk 类，它有一些空方法：

```
public class Chunk {

public boolean chunkChanged = false;
boolean enteredGame = true;

public int chunkID = 0;

Player player;

float var1;
float var2;
float var3;

public Chunk(){
    update();
}

private void update(){
    setUp();
}

private void setUp(){
    if(enteredGame){
        new GenChunk();
    }
}

private void checkChunkRebuild(int id){

}

private void rebuildOnPlayerChange(int id){
    if(enteredGame && chunkChanged == true){

    }
}

private float getPlayerX(){
    return player.var1;
}

private float getPlayerZ(){
    return player.var2;
}

private float getPlayerY(){
    return player.var3;
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T23:33:07.720

您的 Chunk 类正在创建 GenChunk 的新实例，而 GenChunk 又会创建 Chunk 类的新实例，创建一个无限循环，直到发生堆栈溢出。

```
private void setUp(){
if(enteredGame){
    new GenChunk();
    }
} 
```

是它开始的地方，它继续在

```
public void gen(){
    c = new Chunk();
if(c.chunkChanged == false){
    for(int i = 0; i < worldSize; i++){
        newChunk();
    }
  }
} 
```

在 GenChunk 构造函数中调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T23:29:22.087

在`GenChunk`的构造函数中，您调用`gen()`，它会创建一个`Chunk`.

在`Chunk`的构造函数中，您调用`update()`，它调用`setUp()`创建`GenChunk`.

这个过程无限重复。因此堆栈溢出错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T23:29:37.703

*   在您的`GenChuck`构造函数中，您创建一个新的`Chunk`（通过`gen`）方法。
*   在您的`Chunk`构造函数中，您创建一个新的`GenChunk`（通过`update`）方法，`enteredGame` 默认为 true

这是导致堆栈溢出的循环引用。

# c# - 在数据可视化图表lineseries中使用relativesource findancestor

> ID：14762950
> 
> 赞同：1
> 
> 时间：2013-02-07T23:17:23.610
> 
> 标签：c#, wpf, relativesource

我已经生成了一个数据可视化折线图，现在我正在尝试构建一个自定义工具提示并且很接近，但还没有完全实现。这是我与视图相关的 XAML（使用 MVVM）。

```
<charting:Chart x:Name="Chart1" Height="Auto" Width="Auto" Title="Profit and Loss"  
            DockPanel.Dock="Bottom"
            PlotAreaStyle="{StaticResource PlotAreaStyle}" 
            MinHeight="200" 
            MinWidth="200" 
            HorizontalAlignment="Stretch" 
            VerticalAlignment="Stretch">
    <charting:Chart.Resources>
        <ControlTemplate x:Key="LineDataPointTemplate" TargetType="charting:LineDataPoint">
            <Grid x:Name="Root" Opacity="1">
                <ToolTipService.ToolTip>
                    <StackPanel>
                        <ContentControl>
                            <ContentControl.Content>
                                <MultiBinding Converter="{StaticResource MultiFormattingConverter}">
                                    <MultiBinding.Bindings>
                                        <Binding  Path="Title" >
                                            <Binding.RelativeSource>
                                                <Binding RelativeSource="{RelativeSource FindAncestor, AncestorType={x:Type UserControl}}" />
                                            </Binding.RelativeSource>
                                        </Binding>
                                        <Binding RelativeSource="{RelativeSource TemplatedParent}"/>
                                    </MultiBinding.Bindings>
                                </MultiBinding>
                            </ContentControl.Content>
                        </ContentControl>
                    </StackPanel>
                </ToolTipService.ToolTip>
            </Grid>
        </ControlTemplate>
    </charting:Chart.Resources>
    <i:Interaction.Triggers>
        <i:EventTrigger EventName="Loaded">
            <ei:CallMethodAction TargetObject="{Binding}" MethodName="ChartLoadedMethod" />
        </i:EventTrigger>
    </i:Interaction.Triggers>
    <charting:Chart.Series>
      <charting:LineSeries x:Name="entrySeries" ItemsSource="{Binding EntryDataPointColl}" 
             Title="{Binding entryDateLegend}"
             d:DataContext="EntryDataPointColl.xml"
             IndependentValueBinding="{Binding Path=Xvalue}" 
             FlowDirection="LeftToRight" 
             DependentValueBinding="{Binding Path=Yvalue}" 
             >
        <charting:LineSeries.DataPointStyle>
            <Style TargetType="{x:Type charting:LineDataPoint}">
                <Setter Property="Visibility" Value="Collapsed" />
                <Setter Property="Opacity" Value="0" />
                <Setter Property="Background" Value="DarkGreen" />
                <Setter Property="Template" Value="{StaticResource LineDataPointTemplate}"/> 
```

好吧，我不知道如何输入代码……我缩进了 4 个空格，然后做了一个粘贴，但这似乎不起作用。

无论如何，我想使用相对源来引用 the`LineSeries`或 the`Chart`本身，以便在 my 中`MultiFormattingConverter`，我可以访问`DataContext`（我的 vm）和集合。然后我可以使用来自“点”的数据，这`TemplatedParent`让我可以查找所有 3 个的值，`LineSeries`并生成一个工具提示，该工具提示具有每个可观察集合的值。无论我在`FindAncestor, AncestorType=`代码中指定什么，我仍然以“未设置”作为值数组中的第一个对象。

上面的代码通过指定 my 来使用一种变体`UserControl`，但它不起作用。我试过`charting:Chart`, `charting:Chart1`, `charting:LineSeries`，`charting:entrySeries`但似乎没有什么对我有用。有人可以帮我弄清楚在 中指定什么`FindAncestor`吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T03:16:27.693

我没有尝试上面建议的 ElementName 方法。相反，我决定通过使用常规的 FormattingConverter 来简化，传递的值是 TemplatedParent - LineDataPoint。现在我使用 GetParent(ldp) 并且我有 Canvas，它有我的 vm 作为数据上下文。此时，我可以访问我的 observable 集合，并且可以提取我想要包含在我的自定义工具提示中的值。感谢所有的海报。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T23:44:47.407

这里的问题是`ToolTip`结构不是`Chart`可视树的子结构，因此它无法向上/向下走动并找到您要查找的内容 - 事实上，如果您要使用 Snoop 或其他一些 WPF 嗅探工具，您会看到`ToolTip`树有效地“结束”在您`StackPanel`（或非常接近它）

尝试使用`ElementName`绑定而不是`FindAncestor`，并指定图表/系列元素的名称。这有时可以用来解决这类问题。

另一种方法是创建一种“垫片”，可以`Chart`从该工具提示内部代理返回，但这有点超出我目前在手机中输入的意愿。:)

# xcode4.2 - Jailcoder 1.2.1 / XCode 4.2 for Snowleopard / iOS 5.1.1 - 构建失败将项目添加到 iPhone 4S

> ID：14762951
> 
> 赞同：0
> 
> 时间：2013-02-07T23:17:26.963
> 
> 标签：xcode4.2, ios5.1, iphone-4

寻求帮助。我是 Mac 和 XCode 的新手，我从朋友那里借了一台 Mac，因为我需要开发一个 iPhone 应用程序。该应用程序在模拟器中运行良好，所以我想在我的手机上尝试一下。由于我不是付费开发人员，而且我的手机已经越狱，所以我找到了 Jailcoder 程序。

我按照这些说明让 iOS 5.1 SDK 在 XCode 4.2 上运行： [Is it possible to get the iOS 5.1 SDK for Xcode 4.2 on Snow Leopard?](https://stackoverflow.com/questions/9613565/is-it-possible-to-get-the-ios-5-1-sdk-for-xcode-4-2-on-snow-leopard)

然后我安装了 Jailcoder 1.2.1 并运行了设置。我修补了 XCode 以及我的项目。

当我尝试构建到我的 iphone 时，它​​失败并出现以下错误：

/Users/Ryan/Library/Developer/Xcode/DerivedData/Wireless_Controller-amuortpwndtvqfdoyyamsuhsssbu/Build/Products/Debug-iphoneos/Wireless Controller.app/: CSSMERR_TP_CERT_NOT_VALID_YET 命令/bin/sh 失败，退出代码为 1

我看到“cert”和“not valid yet”这两个词，所以我认为这可能与安装的证书 Jailcoder 有关。

对此有什么想法吗？我需要尽快在我的手机上获得这个项目......任何帮助将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T19:10:41.463

我不是专业人士。我也是初学者。
但是，让我分享一下我所知道的。

1.  卸载您的 xcode 并重新安装 Xcode。安装后，不要打开它。（获取 untouch new Xcode）

2.  打开 JailCoder，修补您的 Xcode 和项目。（现在，你可以触摸你的 Xcode）

3.  将您的越狱设备与您的 Mac 连接。

4.  在 Xcode 中打开您的项目，选择您的设备并单击 Product > Build。

5.  构建后，单击运行。

这是我所知道的。

在我的 Mac OSX 10.8、Xcode 4.5、iPAD 2、iOS 5.1.1 上都可以。
它在 iPad 上安装了我的应用程序。
;)

谢谢。

# javascript - 在 jQuery 中的 find() 之后触发点击

> ID：14762952
> 
> 赞同：0
> 
> 时间：2013-02-07T23:17:27.180
> 
> 标签：javascript, jquery

以下代码遍历 DOM 并搜索先前附加了事件处理程序的特定 A 标记。当我找到一个标签（元素）时，我点击一下。此代码正确且有效。

```
$('#Content_' + elementid).parents('li').map(function () {
    var expanderId = $(this).find('a').attr('id');
    $('#' + expanderId).click();
}); 
```

但我想用这一行简化代码，但什么也没发生。

```
$(this).find('a').click(); 
```

我也试试这个

```
$(this).find('a').get(0).click(); 
```

而这没有任何成功。

问题出在哪里？我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T23:32:01.837

尝试将找到的元素包装为`jQuery`：

```
var l = $(this).find("a").get(0);
$(l).trigger("click"); 
```

你可以看到一个工作`**[example here](http://jsfiddle.net/amantur/3MGJz/)**`

# android - 带有可点击电话号码的 Android 文本视图

> ID：14762956
> 
> 赞同：-1
> 
> 时间：2013-02-07T23:17:32.943
> 
> 标签：android, hyperlink, textview, tel

我有一个 textview 显示电话：0900-1111，传真：0900-2222

有没有办法让手机可以点击，但传真不行。

使用

`Phone: <a href="tel:09001111">0900-1111</a>, Fax: 0900-2222`

将自动链接设置为电话，两者都是可点击的！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T23:33:32.753

你检查过 API 演示吗？

他们在 Views/Text/Linkify 下有一个示例。

该类位于 com.example.android.apis.text.Link.java

例如，其中一个 textView 使用的字符串是：

```
<string name="link_text_manual"><b>text2: Explicit links using &lt;a&gt; markup.</b>
  This has markup for a <a href="http://www.google.com">link</a> specified
  via an &lt;a&gt; tag.  Use a \"tel:\" URL
  to <a href="tel:4155551212">dial a phone number</a>.
</string> 
```

和 textView 是：

```
 <TextView android:id="@+id/text2"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:paddingTop="8dp"
            android:paddingBottom="8dp"
            android:textAppearance="?android:attr/textAppearanceMedium"
            android:text="@string/link_text_manual"
            /> 
```

# kendo-ui - 在剑道网格中手动维护脏单元格标记

> ID：14762959
> 
> 赞同：7
> 
> 时间：2013-02-07T23:17:49.707
> 
> 标签：kendo-ui, kendo-grid

我有一个可编辑的剑道网格，我可以在其中编辑一个单元格，网格将红色标记添加到单元格的左上角。

我转到另一个页面，然后返回进行编辑的页面，红色标记消失了，但单元格中新添加的值仍然存在。我在 Kendo 网站上看到了对此的回应，其中建议：“为了在每次重新启动网格时显示“脏标志”，它必须遍历所有模型，检查所有字段是否已更改且可见网格单元格。”

我假设这需要`DataBound()`在网格事件上完成（当我切换页面时似乎触发）我将手动将`k-dirty-cell`类应用于单元格，但我无法弄清楚如何在代码中使其工作。任何想法都非常感谢。

```
$(function () {
                     $("#grid").kendoGrid({
                         height: 550,
                         scrollable: true,
                         sortable: true,
                         filterable: true,
                         resizable: true,
                         reorderable: true,
                         groupable: false,
                         editable: true, // enable editing
                         columns: [
                                    //REMOVED TO SHORTEN EXAMPLE    
                                    ],
                         toolbar: [{name: "save", text: "Save All Records"}, "cancel"], 
                         dataSource: {
                             schema: {
                                 data: "d", 
                                 total: function(data) {
                                    return data.d.length;
                                 },
                                 model: { 
                                     //REMOVED TO SHORTEN EXAMPLE  
                                     }
                                 }
                             },
                             batch: true,
                             pageSize: 10,
                             transport: {
                                 read: {

                                 },
                                 parameterMap: function (data, operation) {
                                     if (operation == "read") {
                                      //WEB SERVICE CALLS REMOVED... YOU GET THE POINT
                                     }
                                     else if(operation == "update") {
                                       //WEB SERVICE CALLS REMOVED... YOU GET THE POINT 
                                     }
                                 }
                             },
                         },
                         selectable: true,
                         pageable: true,
                         dataBound: function () 
                         {
                              //THIS IS FIRED WHEN I CHANGE PAGEs BUT
                              //NOT SURE WHAT CODE GOES HERE TO 
                              //REAPPLY DIRTY CELL MARKER
                 }; 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-07-05T15:29:42.100

数据绑定事件是重新应用它的好地方，但我记住，在遍历网格的 dataItems 时，每一行都有一个脏标志，但不是每个字段。

很有可能我不知道有一种方法可以仅引用网格中的未决更改，但我编写了一个小系统，以便在更细粒度的级别上跟踪此类更改。

在我的系统中，我将网格的未决更改存储在一个名为 PendingChanges 的全局变量中。

然后我指定两个事件。第一个是网格数据源中的[更改事件。](http://docs.kendoui.com/api/framework/datasource#events-change)此代码存储您从刚刚发生的更改中需要的信息：

```
 var PendingChanges = [];
    function GridEdit(e) {
        var cellHeader = $("#grid").find("th[data-title='" + e.field + "']");
        if (cellHeader[0] != undefined) {
           var pendingChange = new Object();
           //Holds field name
           pendingChange.PropertyName = e.field;
           //Keeps track of which td element to select when re-adding the red triangle
           pendingChange.ColumnIndex = cellHeader[0].cellIndex;
           //used to pull row.  Better than the row's id because you could have
           //multiple rows that have been inserted but not saved (ie. all have
           //ID set to 0
           pendingChange.uid = e.items[0].uid;
           //Remember to clear this out after you save
           PendingChanges.push(pendingChange);
        }
    } 
```

然后，我使用[dataBound 事件](http://docs.kendoui.com/api/web/grid#events-dataBound)检查周围有哪些待定更改，并将相关单元格设置为显示红色三角形：

```
function GridDataBound(e) {
    for (var i = 0; i < PendingChanges.length; i++) {
        var row = this.tbody.find("tr[data-uid='" + PendingChanges[i].uid + "']");
        var cell = row.find("td:eq(" + PendingChanges[i].ColumnIndex + ")");

        if (!cell.hasClass("k-dirty-cell")) {
            cell.addClass("k-dirty-cell");
            cell.prepend("<span class='k-dirty'></span>");
        }
    }
} 
```

在上面的代码`this`中是指`The widget instance which fired the event.`. 这直接来自 Kendo UI Docs。

希望这至少可以为您指明正确的方向。如果您正在保存网格，请不要忘记在成功保存后清除 PendingChanges 数组。我建议为此使用 RequestEnd 事件。

# php - 多用户管理的数据库结构

> ID：14762963
> 
> 赞同：0
> 
> 时间：2013-02-07T23:18:06.960
> 
> 标签：php, database

我正在开发一个网站，它将有多个用户界面**admin**、**client**、**public**，我正在为这些用户创建一个表，并且只用一个字段的值将它们分开。

**用户**

```
------------------------------
id
username
password
level     Values (0=>admin, 1=>client, 2=>public) 
```

以这种方式开发表结构是否合适，或者我应该为不同级别的用户创建不同的表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T23:19:49.693

我建议您为用户级别创建一个单独的表。这将允许用户调整关系并允许无缝和高效的更新。

```
用户
----
ID
用户名
密码
level_id (fk)

用户级别
----
ID
等级
```

# batch-file - 使用批处理文件复制和重命名

> ID：14762977
> 
> 赞同：-2
> 
> 时间：2013-02-07T23:19:19.707
> 
> 标签：batch-file

您好我需要创建一个批处理文件，将批处理文件中的信息复制到一个新的 .txt 文件中。我还需要制作一个将重命名 .txt 文件的批处理文件

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T23:26:31.157

使用`ren`和`rename`重命名文件，以及`copy`复制文件。

```
rename oldname newname
copy oldfile newfile 
```

我假设您使用的是 MS-DOS。

# php - 使用 php 脚本将文本转换为图像

> ID：14762982
> 
> 赞同：0
> 
> 时间：2013-02-07T23:19:28.170
> 
> 标签：php, html, image

我正在处理非英语语言，我想将该文本显示为图像，以便即使在不支持该语言的平台上也能支持它。问题是我能够以文本格式正确显示文本，但是在图像方面。它根本不显示图像。

下载字体的链接：http: [//qfs.mobi/f394372](http://qfs.mobi/f394372)或在 Google 中搜索 Surya.ttf

这是我的代码：

文本到图像的代码：

```
<?php
// Set the content-type
//mb_internal_encoding("UTF-8");
header('Content-Type: image/png');
require_once('seven.php');
// Create the image
$im = imagecreatetruecolor(400, 30);

// Create some colors
$white = imagecolorallocate($im, 255, 255, 255);
$grey = imagecolorallocate($im, 128, 128, 128);
$black = imagecolorallocate($im, 0, 0, 0);
imagefilledrectangle($im, 0, 0, 399, 29, $white);

// The text to draw
$text = getData();//'કેમ છો ?';
//echo $text;
// Replace path by your own font path
$font = 'Surya.ttf';

// Add some shadow to the text
imagettftext($im, 20, 0, 11, 21, $grey, $font, $text);

// Add the text
imagettftext($im, 20, 0, 10, 20, $black, $font, $text);

// Using imagepng() results in clearer text compared with imagejpeg()
imagepng($im);
imagedestroy($im);
?> 
```

getData() 的代码：

```
<?php
function getData(){
$url = "http://www.sandesh.com/article.aspx?newsid=119068";
//$url = "http://www.sandesh.com/article.aspx?newsid=115627";
$curl = curl_init($url);
curl_setopt($curl, CURLOPT_RETURNTRANSFER, TRUE);
$output = curl_exec($curl);
curl_close($curl);
$DOM = new DOMDocument;
$output = mb_convert_encoding($output, 'HTML-ENTITIES', "UTF-8");
@$DOM->loadHTML($output);
$items = $DOM -> getElementById('lblNews');

echo "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'
'http://www.w3.org/TR/html4/loose.dtd'><html xmlns='http://www.w3.org/1999/xhtml'><head><meta http-equiv='Content-Type' content='text/html; charset=utf-8'></head><body><span>". $items -> nodeValue ."</span". "<br/></body></html>";
}
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T23:45:58.673

您的代码正在运行（您忘记了关闭跨度并且该函数不返回任何内容，但我想这是由于调试所致）。

发生的情况可能是您正在加载的文本包含空格或额外的换行符，然后在您的 PNG 之外呈现。

尝试使用更大的 PNG 或尝试使用`trim()`.

```
function getData()
{
    ...
    return trim($items->nodeValue);
} 
```

# 测试代码（工作）

...或者至少返回一张我看不懂的图片:-)

```
<?php

        function getData(){
                $url = "http://www.sandesh.com/article.aspx?newsid=119068";
                //$url = "http://www.sandesh.com/article.aspx?newsid=115627";
                $curl = curl_init($url);
                curl_setopt($curl, CURLOPT_RETURNTRANSFER, TRUE);
                $output = curl_exec($curl);
                curl_close($curl);
                $DOM = new DOMDocument;
                $output = mb_convert_encoding($output, 'HTML-ENTITIES', "UTF-8");
                @$DOM->loadHTML($output);
                $items = $DOM -> getElementById('lblNews');

                return trim($items -> nodeValue);
        }

// Set the content-type
//mb_internal_encoding("UTF-8");
// require_once('seven.php');
// Create the image
$im = imagecreatetruecolor(400, 400);

// Create some colors
$white = imagecolorallocate($im, 255, 255, 255);
$grey = imagecolorallocate($im, 128, 128, 128);
$black = imagecolorallocate($im, 0, 0, 0);
imagefilledrectangle($im, 0, 0, ImageSX($im), ImageSY($im), $white);

// The text to draw
$text = getData();//'કેમ છો ?';
//echo $text;
// Replace path by your own font path
$font = 'Surya.ttf';

// Add some shadow to the text
imagettftext($im, 20, 0, 11, 21, $grey, $font, $text);

// Add the text
imagettftext($im, 20, 0, 10, 20, $black, $font, $text);

// Using imagepng() results in clearer text compared with imagejpeg()
header('Content-Type: image/png');
imagepng($im);
imagedestroy($im);

?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-11-29T11:01:34.033

一些情况下我们需要在网页加载的时候动态创建图片，然后脑海中浮现一个问题——我可以在PHP中将文本转换为图片吗？答案是肯定的！为什么不。要进行此活动，您只需执行几个步骤。这些步骤如下：

检查您的 GD 库扩展是否在您当前的 PHP 版本中。如果它没有启用，只需取消注释即可。在您的项目中包含 phpTextToImage 类。创建这个类的一个对象。使用您的文本调用创建图像功能。使用您的文件名和位置调用保存函数。

```
function createImage($text, $textColor = '', $backgroundColor = '', $fontSize = 22, $imgWidth = 600, $imgHeight = 300) {

    //text font path
    $font = 'font/Pacifico-Regular.ttf';

    //create the image
    $this->image = imagecreatetruecolor($imgWidth, $imgHeight);

    $colorCode = array('#ffffff','#db3236', '#f4c20d', '#3cba54', '#4c53cc', '#56aad8', '#61c4a8');

    if ($backgroundColor == '') {
        /* select random color */
        $backgroundColor = $this->hexToRGB($colorCode[rand(0, count($colorCode) - 1)]);
    } else {
        /* select background color as provided */
        $backgroundColor = $this->hexToRGB($backgroundColor);
    }

    if ($textColor == '') {
        /* select random color */
        $textColor = $this->hexToRGB($colorCode[rand(0, count($colorCode) - 1)]);
    } else {
        /* select background color as provided */
        $textColor = $this->hexToRGB($colorCode[rand(0, count($textColor) - 1)]);
    }

    $textColor = imagecolorallocate($this->image, $textColor['r'], $textColor['g'], $textColor['b']);
    $backgroundColor = imagecolorallocate($this->image, $backgroundColor['r'], $backgroundColor['g'], $backgroundColor['b']);

    imagefilledrectangle($this->image, 0, 0, $imgWidth - 1, $imgHeight - 1, $backgroundColor);

    //break lines
    $splitText = explode("\\n", $text);
    $lines = count($splitText);
    $angle = 0;

    foreach ($splitText as $txt) {
        $textBox = imagettfbbox($fontSize, $angle, $font, $txt);
        $textWidth = abs(max($textBox[2], $textBox[4]));
        $textHeight = abs(max($textBox[5], $textBox[7]));
        $x = (imagesx($this->image) - $textWidth) / 2;
        $y = ((imagesy($this->image) + $textHeight) / 2) - ($lines - 2) * $textHeight;
        $lines = $lines - 1;
        //add the text
        imagettftext($this->image, $fontSize, $angle, $x, $y, $textColor, $font, $txt);
    }
    return true;
} 
```

现在，在您想要动态创建文本图像的地方创建项目文件，然后只包含类并创建一个像这样的对象：

```
//include phpTextToImage class
require_once 'phpTextToImage.php';

//create img object
$img = new phpTextToImage; 
```

[你可以在这里看到完整的类，例如 convert-text-to-image-in-php：](https://www.legendblogs.com/blog/convert-text-to-image-in-php/121766)

# wordpress - 无法访问我域上的子文件夹

> ID：14762988
> 
> 赞同：0
> 
> 时间：2013-02-07T23:19:51.560
> 
> 标签：wordpress, .htaccess, subdirectory

我有个问题。我在我的个人网站（纯 HTML）的子文件夹中安装了一个 wordpress 网站。当我尝试访问子文件夹时，出现内部服务器错误。目前我的网站根目录上没有任何 .htaccess，子文件夹上没有默认的 Wordpress 文件。我从来没有遇到过这样的问题。我能做些什么 ？

谢谢 ！

# php - 爆炸后在复选框中显示值的位置

> ID：14762993
> 
> 赞同：0
> 
> 时间：2013-02-07T23:20:04.043
> 
> 标签：php, html

下面我有一个文本输入：

```
'<input type=\"text\" name=\"indivoptions\" class=\"options\" id=\"answer".$option."\" name=\"answerName[$option]\" value=\"$option\" />' 
```

现在我想`$option`在文本输入中显示每个爆炸后，而不是一般的字符串输出，但是我应该将上面的代码放在下面的代码中的什么位置？

```
 $options = explode('-', $option);
  if(count($options) > 1) {
    $start = array_shift($options);
    $end = array_shift($options);
    do {
      $options[] = $start;
    }while(++$start <= $end);
  } 
```

当前代码：

```
function ExpandOptionType($option) { 
  $options = explode('-', $option);
  foreach($options as $answers) {
  $answers = '<p><input type=\"checkbox\" name=\"anstype\" class=\"answers\" id=\"answer".$option."\" name=\"answerName[$option]\" value=\"$option\" />$option</p>';
}
  if(count($options) > 1) {
    $start = array_shift($options);
    $end = array_shift($options);
    do {
      $options[] = $start;
    }while(++$start <= $end);
  }
  else{
    $options = explode(' or ', $option);
  }
  return implode(" ", $options);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T23:25:39.837

```
$options = explode('-', $option);
foreach($options as $indivOption) {
  // do something with each option ($indivOption)
} 
```

# xslt - XSLT：跨多个文档创建“密钥”？

> ID：14762995
> 
> 赞同：2
> 
> 时间：2013-02-07T23:20:16.863
> 
> 标签：xslt, xslt-2.0

继上一个问题' [xslt：通过中间参考节点选择唯一节点？](https://stackoverflow.com/questions/14515004/xslt-select-unique-node-via-intermediate-reference-node)'。

无论如何要使用引用多个 xml 文档的“密钥”。

就像是：

```
<xsl:key name="ChildByFIdAndMFId" 
    match="collection('file:///c:/temp/xslt?select=test*.xml')Child"
    use="concat(FathersID, '+', MothersFatherID)"/> 
```

这给出了一个错误“模式的头部不允许收集函数”。我试图在多个文档中通过 FathersID 和 MothersFatherID 引用所有匹配的“子”节点，以获得一些统计结果，如总和和计数。能够在 key 语句中使用集合看起来像是一个很好的竞争者，但要么我的语法错误，要么根本不可能？

详细说明（基于以前的xml和代码）...

XML 文件如下所示：

```
<t>
    <Children>
        <Child>
            <ID>1</ID>
            <FathersID>100</FathersID>
            <MothersFatherID>200</MothersFatherID>
            <Total>2</Total>
        </Child>
        <Child>
            <ID>2</ID>
            <FathersID>100</FathersID>
            <MothersFatherID>201</MothersFatherID>
            <Total>3</Total>
        </Child>
        <Child>
            <ID>3</ID>
            <FathersID>100</FathersID>
            <MothersFatherID>202</MothersFatherID>
            <Total>5</Total>
        </Child>
        <Child>
            <ID>4</ID>
            <FathersID>100</FathersID>
            <MothersFatherID>201</MothersFatherID>
            <Total>3</Total>
        </Child>
        <Child>
            <ID>5</ID>
            <FathersID>101</FathersID>
            <MothersFatherID>201</MothersFatherID>
            <Total>4</Total>
        </Child>
    </Children>
    <Fathers>
        <Father>
            <ID>100</ID>
        </Father>
        <Father>
            <ID>101</ID>
        </Father>
    </Fathers>
    <MothersFathers>
        <MothersFather>
            <ID>200</ID>
        </MothersFather>
        <MothersFather>
            <ID>201</ID>
        </MothersFather>
        <MothersFather>
            <ID>202</ID>
        </MothersFather>
    </MothersFathers>
</t> 
```

可能有多达 30 个这些文件可供参考，但我现在只对匹配子节点感兴趣（其中每个文件可能有 3000 个节点） - 文件之间很可能有重复的子节点，尽管统计数据（总计）会有所不同。

到目前为止的xslt：

```
 <xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="text"/>

    <xsl:key name="kMFByFId" match="MothersFatherID" use="../FathersID"/>
    <!--use="../FathersID"/>-->

    <xsl:key name="kMFById" match="MothersFather" use="ID"/>

    <xsl:key name="ChildByFIdAndMFId" match="Child"
        use="concat(FathersID, '+', MothersFatherID)"/>

    <xsl:template match="Children|MothersFathers|text()"/>

    <xsl:template match="Father">

        Father ID=<xsl:value-of select="ID"/>
        <xsl:variable name="Fid" select="ID"></xsl:variable>

        <xsl:apply-templates select=
            "key('kMFById',
            key('kMFByFId', ID)
            [generate-id(..)
            =
            generate-id(key('ChildByFIdAndMFId',
            concat(../FathersID,'+',.)
            )[1]
            )
            ]
            )">
            <xsl:sort select="ID" data-type="text"/>
            <xsl:with-param name="Fid" select="$Fid"></xsl:with-param>
        </xsl:apply-templates>

    </xsl:template>

    <xsl:template match="MothersFather">
        <xsl:param name="Fid"></xsl:param>
        <xsl:variable name="FidAndMid" select="concat($Fid,'+',ID)"></xsl:variable>
          MothersFather ID=<xsl:value-of select="ID"/>
            Sum of Total= <xsl:value-of 
            select="sum(key('ChildByFIdAndMFId', $FidAndMid)/Total)"/>
    </xsl:template>
</xsl:stylesheet> 
```

所以这适用于单个 xml 文档 - 上面的 xml 给出：

```
 Father ID=100
      MothersFather ID=200
        Sum of Total= 2
      MothersFather ID=201
        Sum of Total= 6
      MothersFather ID=202
        Sum of Total= 5

    Father ID=101
      MothersFather ID=201
        Sum of Total= 4 
```

但是，如果我不能在键中使用集合，我该如何引用与当前父亲 ID 和母亲父亲 ID 的子节点匹配的所有其他文档？

例如，如果上述 xml 被复制到另外两个需要从中提取数据的文件中，则输出将具有新的总和，例如：

```
 Father ID=100
      MothersFather ID=200
        Sum of Total= 6
      MothersFather ID=201
        Sum of Total= 18
      MothersFather ID=202
        Sum of Total= 15

    Father ID=101
      MothersFather ID=201
        Sum of Total= 12 
```

我可以看到我想使用“集合”，这样我就可以轻松地提取所有文件，但我看不到在哪里或如何。任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T08:10:23.057

正如 Dimitre 所说，`key()`只搜索一个文档。如果要搜索一组文档，这很简单：使用`$s/key(...)`$s 保存文档集的位置。一组文档可以通过调用 collection() 函数、通过调用提供一组 URI 的 document() 或通过组合多次调用 doc() 的结果来获得，例如`for $x in $uri-list return doc($x)`.

# iphone - 使用 UIKit 绘图应用程序中的撤消按钮

> ID：14762997
> 
> 赞同：4
> 
> 时间：2013-02-07T23:20:19.697
> 
> 标签：iphone, xcode, ios6

我正在尝试实现撤消按钮，一切正常，我能够缓存该动作，但不知何故，以前绘制的线条仍然存在，它们应该在每个 undoclick 动作上消失请帮助

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
    path = [[UIBezierPath alloc] init];
    mouseSwiped = NO;
    UITouch *touch = [touches anyObject];
    lastPoint = [touch locationInView:self.view];
    CGPoint p = [touch locationInView:self.view];
    [path moveToPoint:p];
    [pathArray addObject:path];
   // NSLog(@"%@",pathArray);
}

- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event {

    mouseSwiped = YES;
    UITouch *touch = [touches anyObject];
    CGPoint currentPoint = [touch locationInView:self.view];
    CGPoint p = [touch locationInView:self.view];
    [path addLineToPoint:p];

    UIGraphicsBeginImageContext(self.view.frame.size);
    [self.tempDrawImage.image drawInRect:CGRectMake(0, 0, self.view.frame.size.width, self.view.frame.size.height)];
    CGContextMoveToPoint(UIGraphicsGetCurrentContext(), lastPoint.x, lastPoint.y);
    CGContextAddLineToPoint(UIGraphicsGetCurrentContext(), currentPoint.x, currentPoint.y);
    CGContextSetLineCap(UIGraphicsGetCurrentContext(), kCGLineCapRound);
    CGContextSetLineWidth(UIGraphicsGetCurrentContext(), brush );
    CGContextSetRGBStrokeColor(UIGraphicsGetCurrentContext(), red, green, blue, 1.0);
    CGContextSetBlendMode(UIGraphicsGetCurrentContext(),kCGBlendModeNormal);

    CGContextStrokePath(UIGraphicsGetCurrentContext());
    self.tempDrawImage.image = UIGraphicsGetImageFromCurrentImageContext();
    [self.tempDrawImage setAlpha:opacity];
    UIGraphicsEndImageContext();

    lastPoint = currentPoint;
   [self.view setNeedsDisplay];
}

- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event {
    UITouch *touch = [touches anyObject];
    CGPoint p = [touch locationInView:self.view];
    [path addLineToPoint:p];

    if(!mouseSwiped) {
        UIGraphicsBeginImageContext(self.view.frame.size);
        [self.tempDrawImage.image drawInRect:CGRectMake(0, 0, self.view.frame.size.width, self.view.frame.size.height)];
        CGContextSetLineCap(UIGraphicsGetCurrentContext(), kCGLineCapRound);
        CGContextSetLineWidth(UIGraphicsGetCurrentContext(), brush);
        CGContextSetRGBStrokeColor(UIGraphicsGetCurrentContext(), red, green, blue, opacity);
        CGContextMoveToPoint(UIGraphicsGetCurrentContext(), lastPoint.x, lastPoint.y);
        CGContextAddLineToPoint(UIGraphicsGetCurrentContext(), lastPoint.x, lastPoint.y);
        CGContextStrokePath(UIGraphicsGetCurrentContext());
        CGContextFlush(UIGraphicsGetCurrentContext());
        self.tempDrawImage.image = UIGraphicsGetImageFromCurrentImageContext();
        UIGraphicsEndImageContext();
    }

    UIGraphicsBeginImageContext(self.mainImage.frame.size);
    [self.mainImage.image drawInRect:CGRectMake(0, 0, self.view.frame.size.width, self.view.frame.size.height) blendMode:kCGBlendModeNormal alpha:1.0];
    [self.tempDrawImage.image drawInRect:CGRectMake(0, 0, self.view.frame.size.width, self.view.frame.size.height) blendMode:kCGBlendModeNormal alpha:opacity];
    self.mainImage.image = UIGraphicsGetImageFromCurrentImageContext();
    self.tempDrawImage.image = nil;
    UIGraphicsEndImageContext();
    [self mainImage];
    [self.view setNeedsDisplay];
     [path removeAllPoints];
} 
```

使用以下撤消功能和路径数组计数在每次单击时减少，但绘制线仍然存在

```
-(IBAction)undoButtonClicked:(id)sender
{
    NSLog(@"%s", __FUNCTION__);
    NSLog(@"pathArray count is %i", [pathArray count]);
    if([pathArray count]>0){
        UIBezierPath *_path=[pathArray lastObject];
        [bufferArray addObject:_path];
        [pathArray removeLastObject];
        //self.tempDrawImage.image;
        [self.view  setNeedsDisplay];
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T00:54:20.350

看起来您正在使用`tempImage`ivar 来累积绘图的笔划，但是当您单击撤消时，您不会执行任何操作来擦除已经在那里绘制的线条。我不知道你的绘图要求有多复杂。`pathArray`如果它们很简单，您可以在`-drawRect`调用每个路径的视图中进行迭代`-stroke`（当然，每次绘制笔画时，您都需要在路径或视图中设置 lineWidth 等）。作为一个简单的优化，您可以计算新/删除笔划的边界，然后调用`setNeedsDisplayInRect:`视图的适当部分。`tempImage`因为每次触摸移动时你都会更新，我想这会有相当高的开销。

# entity-framework - MVC，Global.asax 中的实体框架 DBContext 连接

> ID：14762998
> 
> 赞同：2
> 
> 时间：2013-02-07T23:20:21.677
> 
> 标签：entity-framework, dependency-injection, dbcontext

我正在使用实体框架和依赖注入。为了在控制器中获取数据库结果，我正在做：-

```
 private IJobSeekerRepository repository;

    public JobseekersController(IJobSeekerRepository Repository)
    {
        repository = Repository;
    } 
```

然后做类似的事情......

```
 return View(repository.GetAllJobSeekers); 
```

我正在尝试遵循一个教程，您可以在其中从数据库中设置 Global.asax 文件中的 Thread.CurrentPrinciple。我已经尝试了几个小时将数据库中的记录放入全局文件中。

如何设置类似于上面的“public JobseekersController”的构造函数？

这就是我所拥有的，但它在“repository.GetJobSeekersRoles”上引发错误 - 对象引用未设置为对象的实例

```
 public IJobSeekerRepository repository;

    void Application_AuthenticateRequest(object sender, EventArgs e)
    {
        if (Request.IsAuthenticated)
        {
            var ctx = HttpContext.Current;

               string[] roles = repository.GetJobSeekersRoles(ctx.User.Identity.Name);
               var newUser = new GenericPrincipal(ctx.User.Identity, roles);
               ctx.User = Thread.CurrentPrincipal = newUser;
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T23:41:12.323

Just use the `DependencyResolver` object ([msdn](http://msdn.microsoft.com/en-us/library/system.web.mvc.dependencyresolver%28v=vs.98%29.aspx)), as it's built into MVC:

```
var repository = DependencyResolver.Current.GetService<IJobSeekerRepository>(); 
```

Assuming you are setting the `DependencyResolver` on your app start.