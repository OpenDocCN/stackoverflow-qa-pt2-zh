# StackOverflow 问答 12940000-12940999

# facebook - Facebook Open Graph Activity 显示空白标题和更高的缩略图

> ID：12940010
> 
> 赞同：0
> 
> 时间：2012-10-17T17:31:51.660
> 
> 标签：facebook, facebook-opengraph

我有一个 facebook 应用程序，只要用户通过一个级别，就会向他们发布 Open Graph。它会发布分数和其他有关他们如何通过关卡的信息。

我使用活动提要查看这些开放的图表帖子。我遇到了一个问题，对于一个用户，他们的活动不显示标题并且图像更大。

乱七八糟的活动截图：（[来源：][[stiqjoy.com](http://stiqjoy.com/wp-content/uploads/2012/10/ActivityBlank.png)][）][![乱七八糟的活动截图](../Images/8840e5be6d30f5a6eef41a6cc84f843a.png)](https://i.stack.imgur.com/vPpWz.png)

正确活动截图：（[来源：][[stiqjoy.com](http://stiqjoy.com/wp-content/uploads/2012/10/ActivityCorrect.png)][）][![正确活动的截图](../Images/e74f0a069e52e491e1ea311d91a55e5d.png)](https://i.stack.imgur.com/9Cav0.png)

这些活动对给定用户显示正确，但最近开始显示不正确。

我对可能是什么问题感到有些困惑。我一直在玩“节拍”动作并更改一些字幕。我还时不时更改了 Action 的属性。此外，我为打开的图表帖子提供了一个 200x200 的缩略图，而不是它在活动提要中显示的 90x90。

似乎一旦用户开始出现此问题，对于我为该用户创建的每个打开的该操作类型的图表帖子，它仍然是一个问题。

最奇怪的是，它对用户 A 继续正常工作，而对用户 B 继续被破坏。这就像某个特定用户的事情搞砸了，然后对他们来说仍然搞砸了。

我对任何想法持开放态度，并希望您能给予我任何帮助。

**编辑**

我只是发现它发生在“喜欢”动作中。除了这一次，一个 Activity 是错误的，而下一个 Activity 是正确的（两者都针对不同对象的相同操作）网址。我查看了对象 url 的元数据，除了对象的名称之外没有任何不同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-12T20:17:48.820

我相信您需要在图像上明确地将 user_generated 设置为 false。还要确保您的 og:description 和 og:title 字段都已设置。

下面是关于 user_generated 图像的更多信息：

[iOS - Facebook Open Graph Api - 确保照片是用户生成的](https://stackoverflow.com/questions/17538712/ios-facebook-open-graph-api-ensuring-that-photos-are-user-generated)

请查看上述问题中的链接：

[https://developers.facebook.com/docs/opengraph/howtos/adding-photos-to-stories/](https://developers.facebook.com/docs/opengraph/howtos/adding-photos-to-stories/)

# wso2 - 适用于 Carbon 4.0 产品的 SAML2 SSO 身份验证器

> ID：12940024
> 
> 赞同：0
> 
> 时间：2012-10-17T17:32:38.823
> 
> 标签：wso2, single-sign-on, wso2esb, saml, wso2carbon

我需要在 GREG 4.5.0、AS 5.0.0 和 ESB 4.5.0 中使用 SAML2 SSO Authenticator 插件进行 SSO 与 IS 4.0 M9 或如果它可能与 v3.2.3 一起使用。

我可以使用什么 P2 存储库？我有一个离线 P2 存储库，一个 zip 文件，适用于 4.0.0 版本，但我找不到这个插件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T02:07:44.093

您不能将 3.2.3 p2 repo 与基于 Carbon 4.0.0 的产品（Greg 4.50、ESB 4.5.0 等）一起使用。IS 功能尚未发布。如果您需要测试这些功能，您可以从这个夜间构建中获得一个[p2-repo](http://builder3.us1.wso2.org/builds/latest/p2-repo/)并试用它们。

编辑：

[随着 IS 4.0.0 的发布，您可以从此处](http://dist.wso2.org/p2/carbon/releases/4.0.3/)下载 p2-repo zip 文件，也可以从[此处](http://dist.wso2.org/products/carbon/4.0.3/p2-repo.zip)使用在线 p2 repo 。

可以从[这里](http://wso2.com/products/identity-server/)下载新的 IS 版本。

# entity-framework - IQueryable 没有实现 IDbAsyncEnumerable

> ID：12940042
> 
> 赞同：6
> 
> 时间：2012-10-17T17:33:41.750
> 
> 标签：entity-framework

该问题最初是在[http://entityframework.codeplex.com/discussions/399499#post928179](http://entityframework.codeplex.com/discussions/399499#post928179)提出的。

再会！请告诉我发布此问题的位置是否错误。

我有一个查询如下：

```
IQueryable<Card> cardsQuery =
  dataContext.Cards
  .Where(predicate)
  .OrderByDescending(kc => kc.SendDate)
  .AsQueryable(); 
```

然后我尝试：

`Task<Card[]> result = cardsQuery.ToArrayAsync();`

然后异常上升：

`The source IQueryable doesn't implement IDbAsyncEnumerable<Models.Card>`

我使用“EF 5.x DbCotext 生成器”的修改版本。

如何避免？

**更新**

重要的一点是我有`IQuerayble<Card>`如下方法生产：

```
class Repository {
  public IQueryable<Card> GetKudosCards(Func<Card, bool> predicate) {
    IEnumerable<KudosCard> kudosCards = kudosCardsQuery.Where(predicate);
     return kudosCards
            .OrderByDescending(kc => kc.SendDate)
            .AsQueryable();
  }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-18T22:03:25.480

调用 AsQueryable 有什么意义？如果您使用从 IQueryable 源集合（例如 DbSet、ObjectSet）开始的扩展方法编写查询，则查询也将是 IQueryable。

AsQueryable 的目的是用 IQueryable 代理/适配器包装 IEnumerable 集合，该代理/适配器使用能够将 IQueryable 查询编译为 Linq to Object 查询的 Linq 提供程序。这在您想使用内存数据查询的场景中很有用。

为什么需要 AsQueryable 调用？如果你只是简单地删除它怎么办？

**更新**

好的，现在看来我明白你的问题了。快速查看[ODataQueryOptions.ApplyTo](http://aspnetwebstack.codeplex.com/SourceControl/changeset/view/b11acf178a83#src/System.Web.Http.OData/OData/Query/ODataQueryOptions.cs)后，我意识到它只是扩展了查询的底层表达式树。您仍然可以使用它以您想要的方式运行查询，但是您需要一些小技巧来将查询转换回通用查询。

```
IQueryable<Card> cardsQuery =
   dataContext.Cards
    .Where(predicate)
    .OrderByDescending(kc => kc.SendDate);

IQueryable odataQuery = queryOptions.ApplyTo(cardsQuery);

// The OData query option applier creates a non generic query, transform it back to generic
cardsQuery = cardsQuery.Provider.CreateQuery<Card>(odataQuery.Expression);

Task<Card[]> result = cardsQuery.ToArrayAsync(); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-20T08:30:35.820

问题如下。

我有一个方法：

```
class Repository {
  public IQueryable<Card> GetKudosCards(Func<Card, bool> predicate) {
    IEnumerable<KudosCard> kudosCards = kudosCardsQuery.Where(predicate);
    return kudosCards
            .OrderByDescending(kc => kc.SendDate)
            .AsQueryable();
  }
} 
```

问题是 kudosCards 有 type `IEnumerable<KudosCard>`。这会引发异常。如果我将谓词类型更改为，`Expression<Func<Card, bool> predicate`那么一切正常。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-09-20T15:16:28.957

当我使用 LinqKit 库表达式构建器时，我遇到了同样的问题，最终，它正在生成`AsQueryable()`，非常令人惊讶的是，它发生在 XUnit 集成测试调用中。

当通过 Swagger 调用同一个 API 端点时，为什么没有发生同样的问题，我对此感到很疯狂。

原来我必须做一个基本的改变。我不得不更换：

```
using System.Data.Entity; 
```

和：

```
using Microsoft.EntityFrameworkCore; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-06-15T12:10:07.957

当我使用[LinqKit](https://www.nuget.org/packages/LinqKit.EntityFramework/)库表达式构建器时，我遇到了同样的问题，它最终生成了`AsQueryable()`.
非常令人惊讶的是，它发生在我的**XUnit**集成测试调用中。

当通过 Swagger 调用同一个 API 端点时，为什么没有发生同样的问题，我对此感到很疯狂。

* * *

原来我必须做一个基本的改变。
我不得不更换：

```
using System.Data.Entity; 
```

和：

```
using Microsoft.EntityFrameworkCore; 
```

在我调用[LinqKit](https://www.nuget.org/packages/LinqKit.EntityFramework/)表达式方法的地方。

# clojure - 在不影响其他用户的情况下扩展库提供的协议

> ID：12940052
> 
> 赞同：5
> 
> 时间：2012-10-17T17:34:16.690
> 
> 标签：clojure

我正在使用第 3 方库 ( [clj-msgpack](https://github.com/grammati/clj-msgpack) )，并希望为该库还为其提供处理程序的类型扩展协议。

就其本身而言，这很简单——但有什么方法可以做到这一点，不会影响在同一个 JVM 中运行的该库的其他用户？类似于动态 var 绑定的东西（仅在堆栈上的给定点下生效）将是理想的。

目前，我正在做一个无条件覆盖，但使用一个动态变量来启用我修改后的行为；然而，这让我觉得太像猴子补丁了。

出于好奇，我正在实施的（公认的可憎）如下：

```
(in-ns 'clj-msgpack.core)

(def ^:dynamic *keywordize-strings*
  "Assume that any string starting with a colon should be unpacked to a keyword"
  false)

(extend-protocol Unwrapable
  RawValue
  (unwrap [o]
    (let [v (.getString o)]
      (if (and *keywordize-strings* (.startsWith v ":"))
        (keyword (.substring v 1))
        v)))) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T21:20:48.307

经过一番思考，我看到了两种基本方法（其中一种是我从你那里得到的）：

动态绑定（就像您现在所做的那样）：

一些人抱怨动态绑定是最令人惊讶的。“什么？只有在从那里调用时才会这样？”。虽然我个人并不认为这是一件坏事（tm），但有些人会这样做。在这种情况下，它完全符合您的愿望，只要您有一点可以决定是否需要关键字字符串，这应该可以工作。如果您添加将它们更改回来的第二个点以及穿过这两个点的代码路径......您自己的。但是，嘿，工作代码有它的优点。

遗产：

good'ol java 风格或使用 clojure 的附加层次结构，您可以将您传递的对象类型扩展为扩展 widgewhatzit 的关键字化字符串widgewhatzit 并**为您的特定子类添加一个新的处理程序**。这仅在某些情况下有效，并在设计的其余部分强制使用不同的对象样式。一些聪明的人也会争辩说它仍然遵循最令人惊讶的原则，因为当通过另一个代码路径调用时，对象的类型会有所不同。

* * *

就个人而言，除非您可以将整个程序更改为使用关键字而不是字符串，否则我会使用您现有的解决方案（这当然是我的第一个（可能有争议的）选择）

# class - VBA 使用一个类作为另一个类的属性

> ID：12940053
> 
> 赞同：3
> 
> 时间：2012-10-17T17:34:16.503
> 
> 标签：class, vba, excel

我在使用作为另一个类中的属性创建的类时遇到问题。我有两个类，一个叫做 Vertex，另一个叫做 Edge。Edge 的两个属性 Parent 和 Child 是 Vertex 对象。这是我尝试使用它们的方法。

```
Option Explicit

Public Sub OrgChart()

Dim Vertices As Collection
Dim Edges As Collection
Dim vParent As Vertex
Dim vChild As Vertex
Dim eEdge As Edge
Dim rEdgeRow As Range

Set rEdgeRow = ActiveSheet.Range("A1:C1")

Do While Len(rEdgeRow(1, 1).Value) > 0

Set vChild = New Vertex
Set vParent = New Vertex
Set eEdge = New Edge

vChild.Name = rEdgeRow(1, 1).Value
vChild.Dummy = False

vParent.Name = rEdgeRow(2, 1).Value
vParent.Dummy = False

eEdge.Parent = vParent
eEdge.Child = vChild
eEdge.Percent = rEdgeRow(3, 1).Value

Set rEdgeRow = rEdgeRow.Offset(1, 0)

Loop

End Sub 
```

当我运行它时，我得到了错误，

“运行时错误'91'：对象变量或未设置块变量”

调试器表明它正在中断行

```
eEdge.Parent = vParent 
```

我认为问题与 eEdge.Parent 未初始化有关，但我尝试使用

```
Set eEdge.Parent = New Vertex 
```

我遇到了同样的问题。

如果有帮助，我也可以发布类代码，尽管它们相当简单，仅包含 Property Get 和 Property Let 函数。

如果我在发布此内容时做错了什么，我深表歉意；这是我第一次在 SO 上发布任何内容。

谢谢，埃里克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T21:00:31.087

我可能不理解这一点，但你尝试过：

```
Set eEdge.Parent = vParent
Set eEdge.Child = vChild 
```

如果它们是对象，则需要使用“Set”

...此外，如果这不能解决问题，您能否发布 Vertex 类的代码 - 您可能需要在其构造函数中以不同方式调暗 Parent 和 Child 对象...

# java - 如果 hashmap 没有可打印的内容，则无法打印“No Mail”

> ID：12940054
> 
> 赞同：0
> 
> 时间：2012-10-17T17:34:18.487
> 
> 标签：java, hashmap

当我试图打印出收件箱中没有任何邮件的用户并打印出“没有邮件”时，它不会打印出任何东西，但如果里面有东西，它就会起作用

代码在这里

```
for(String key : items.keySet()) {

    System.out.println("Mail for " + key);
    ArrayList<MailItem> mailBox = items.get(key);
    if(mailBox == null){
        System.out.println("No mail");
    } else {
        for(MailItem item : mailBox){
           System.out.println(item.toString());
        }
    }
} 
```

`items`是一个哈希图，我不想在打印后删除这些值

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T17:41:16.397

也许你的意思是

```
if(mailBox == null || mailBox.isEmpty()) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T17:41:27.470

更放松：

```
if(mailBox == null || mailBox.isEmpty()) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T17:42:07.767

您没有在第一个`if`条件下检查空列表。

改变

```
 if(mailBox == null){ 
```

至

```
 if(mailBox == null || mailBox.size()==0){ 
```

或者

```
 if(mailBox == null || mailBox.isEmpty()){ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-17T17:42:17.163

您还需要处理邮箱存在但其中没有项目的情况。

例如

```
if(mailBox == null || mailBox.isEmpty()){
        System.out.println("No mail"); 
```

# c# - 在大文本上使用 RegEx 的最佳方法

> ID：12940057
> 
> 赞同：1
> 
> 时间：2012-10-17T17:34:29.673
> 
> 标签：c#, sql-server, regex

我有一个文本列，其中包含来自 PDF、word、excel 等的纯文本。使用 SQL 搜索短语效果很好。

用户希望在打开文件之前查看包含搜索短语的文本摘录。由于 SQL 不会返回短语在列中的位置，因此我决定使用正则表达式来查找并显示它。

当文本很大时，**27 MB** CPU 会跳到接近 100% 并且执行速度很慢。正则表达式模式检索搜索词前后的 5 个单词。

这是代码：

```
 HashSet<string> str = new HashSet<string>();

            foreach (string sPhrase in searchArr)
            {
                string sPattern;
                if (sPhrase.Contains("*"))
                    sPattern = sPhrase.Replace("*", @"\w*");
                else
                    sPattern = sPhrase;

                string pattern = "(?:[a-zA-Z'-]+[^a-zA-Z'-]+){0,5}" + sPattern + "(?:[^a-zA-Z'-]+[a-zA-Z'-]+){0,5}";
                Debug.Write(string.Format("Pattern:{0}\n\r",pattern));

                Regex reg = new Regex(pattern, RegexOptions.IgnoreCase | RegexOptions.Compiled);
                Match match = reg.Match(Text);

                while (!String.IsNullOrEmpty(match.Value))
                {
                    string s = match.Value;
                    if (s.Contains("\n\r"))
                        s = s.Replace("\n\r", " ");

                    s = s.Replace("\n", " ");
                    s = s.Replace("\r", " ");

                    //Checks for dups
                    if (!str.Contains(s))
                    {
                        str.Add(s);
                        AttachmentSearchResult r = new AttachmentSearchResult(s);

                        yield return r;
                    }

                    match = match.NextMatch();
                }
            } 
```

我究竟做错了什么？除了检索内存中的所有文本并进行搜索之外，还有更好的方法吗？或者 SQL 2005 可以完成我想要做的事情吗？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-17T17:46:51.793

我能想到的唯一方法是使用专门的搜索引擎。我以前使用过[Lucene.NET](http://incubator.apache.org/projects/lucene.net.html)来做类似的事情，而且相对简单。您可能还想研究[SimpleLucene](http://simplelucene.codeplex.com/)以使您的生活更轻松。

但是，添加一个全新的搜索引擎将需要时间投资，这可能是不可行的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T17:47:25.663

我不确定您的要求是否可以通过此解决，但您可以创建一个 SQL 表达式列，其中包含正则表达式（[doc](http://msdn.microsoft.com/en-us/magazine/cc163473.aspx)）。这样您就可以将解析任务传递给 SQL Server。

# html - 图像映射标签在 chrome 和 firefox 中不起作用

> ID：12940058
> 
> 赞同：2
> 
> 时间：2012-10-17T17:34:37.427
> 
> 标签：html, image, map, imagemap, area

下一个代码被剪断是我遇到问题的地方，前 3 个标签运行良好，但后 2 个标签在 Chrome 和 Firefox 中不起作用，在 IExplorer 中运行良好。你有什么想法错了或如何解决？

```
<div id="caratula" align="center">
    <img src="images/forma_acceso_sin_nav.png" border="0" usemap="#Map"/>

  <map name="Map" id="Map">

      <area shape="rect" coords="348,332,439,417" href="http://201.144.101.36/cotizador/" target="_blank"/>
      <area shape="rect" coords="470,363,508,398" href="http://201.144.101.45/onepage/" target="_blank" />
      <area shape="rect" coords="549,369,633,395" href="http://201.144.101.36/portaliswstudio/" target="_blank"/>

    <area shape="rect" coords="740,522,852,601" href="index.html" target="_self" alt="Pagina Principal" />

    <area shape="rect" coords="9,614,94,648" href="index.html" alt="buscas chamba" target="_blank" style="border:medium;"/>
    <area shape="rect" coords="110,616,142,647" href="index.html" alt="mailto" target="_blank"  />
  </map> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T02:44:30.350

好吧，我一直在搜索有关它的信息，我找到了一个包含浏览器功能和兼容不同版本的表格，我认为这是真正的问题，参考是下一个，也许对你有用。

[http://haignet.co.uk/object-image-map.htm](http://haignet.co.uk/object-image-map.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-13T00:13:14.270

usemap 属性中不应有 #。

# php - 显示自定义帖子类型标题列表

> ID：12940070
> 
> 赞同：1
> 
> 时间：2012-10-17T17:35:44.693
> 
> 标签：php, javascript, jquery, ajax, wordpress

我正在使用以下代码显示自定义帖子类型的列表：

```
 <!-- List post types -->
    <?php $args = array(
        'post_type'=>'artworks_post',
        'title_li'=> __('')
    );
    wp_list_pages( $args ); 
    ?> 
```

问题是我无法控制该列表，是否有其他方法可以显示自定义帖子类型标题列表，我可以控制它如何制作标记？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T17:56:43.493

使用普通的 ol'[`WP_Query()`](http://codex.wordpress.org/Class_Reference/WP_Query)

```
// The Query
$the_query = new WP_Query( 'post_type=artworks_post' );

// The Loop
while ( $the_query->have_posts() ) : $the_query->the_post();
    echo '<a rel="' .the_permalink(). '" href="' .the_permalink(). ' ">'. the_title() .'</a>';
endwhile;

// Reset Post Data
wp_reset_postdata(); 
```

# php - 修复时间字符串

> ID：12940072
> 
> 赞同：0
> 
> 时间：2012-10-17T17:35:50.153
> 
> 标签：php, regex

这应该很容易，但我不明白。我希望收到小时：分钟，并以 00:00:00 格式返回小时：分钟：秒。以下内容太少了。有关执行此操作的最佳方法的建议？谢谢

```
<?php
    function fixTime($t)
    {
        $a = explode(':', trim($t));
        return ((count($a)==2) && ($h=$a[0]) && ($m=$a[1]) && ($h>=0) && ($m>=0) && ($h<=23) && ($m<=59))?$h.':'.$m.':00':'00:00:00';
    }

    echo(fixTime('23:33').'<br />');
    echo(fixTime('05:00').'<br />');
    echo(fixTime('5:00').'<br />');
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T17:39:38.330

[strtotime](http://php.net/strtotime)函数将在这里为您提供帮助：

```
function fixTime($t) {
    return date('H:i:s', strtotime($t));
}

echo fixTime('23:33'); // 23:33:00
echo fixTime('05:00'); // 05:00:00
echo fixTime('5:00'); // 05:00:00 
```

此外，请参阅[日期](http://php.net/date)函数以获取可用的格式选项列表。

要验证这样简单的输入，正则表达式可能会有所帮助：

```
function fixTime($t) {
    if (!preg_match('/^([01][0-9]|2[0-3]|[0-9]):[0-5][0-9]$/', $t)) {
        return false;
    }
    return date('H:i:s', strtotime($t));
}

echo fixTime('23:33'); // 23:33:00
echo fixTime('33:33'); // false

if (fixTime('33:33') === false) {
    // invalid date supplied
} 
```

# objective-c - 带有 NSMutableArray 对象的 Xcode 表视图

> ID：12940079
> 
> 赞同：1
> 
> 时间：2012-10-17T17:36:19.307
> 
> 标签：objective-c

我有一个带有视图控制器的表视图，我试图用 NSMutableArray 中的一些数据填充这个表。

我有一个名为 Lugar.m 和 Lugar.h 的类，具有一些属性（在 .m 文件中带有 @synthesize），如下所示：

```
@property (nonatomic, strong) NSString *nombre;
@property (nonatomic, strong) NSString *direccion;
@property (nonatomic, strong) NSString *descripcion;
@property (nonatomic, strong) NSString *precio; 
```

然后我有带有以下 viewDidLoad 方法的表视图的控制器

```
- (void)viewDidLoad
{
[super viewDidLoad];
self.title =@"Comer";
Lugar *lugar = [[Lugar alloc] init];
self.datosTabla = [[NSMutableArray alloc] initWithCapacity:6];
NSArray *nombres = [[NSArray alloc] initWithObjects:@"Masala",@"Italiano",@"Gaia",@"Pekaditos",@"Ojeda",@"Plan B", nil];
NSArray *direcciones = [[NSArray alloc] initWithObjects:@"C/San Roque, 5", @"C/ Moneda, 7 ",@"C/Nueva, 6", @"C/San Roque, 5", @"C/ Moneda, 7 ",@"C/Nueva, 6", nil];
NSArray *descripciones = [[NSArray alloc] initWithObjects:@"Bonito restaurante ecologico",@"Restaurante fino y caro", @"El mejor marisco de burgos",@"Calida recio mud", @"Calidad insuperable" , @"Calidad insuperable",nil];
NSArray *precios = [[NSArray alloc] initWithObjects:@"25€", @"15€", @"12€", @"6€", @"34€", @"34€",nil];
for (NSUInteger i = 0; i < 6; i++) {
lugar.nombre = [nombres objectAtIndex:i];
lugar.direccion = [direcciones objectAtIndex:i];
lugar.descripcion = [descripciones objectAtIndex:i];
lugar.precio = [precios objectAtIndex:i];
[self.datosTabla insertObject:lugar atIndex:i];
} 
```

在这个文件中，我还有 cellForRowAtIndex

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
    {
    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) 
    {
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    Lugar *tempName =[self.datosTabla objectAtIndex:indexPath.row];
    cell.textLabel.text = tempName.nombre;
    }
    return cell;
    } 
```

我也有返回行和部分的方法

该应用程序运行正常，但它只向我显示添加到 mutableArray 的最后一个对象的名称，在这种情况下，餐厅称为：Plan B。所以我刚刚得到一张包含相同餐厅信息的 6 行表。

我试图修复它，但我花了很多时间都没有结果。我会感谢任何帮助。在此先感谢路易斯

PD：数组的信息是西班牙语的，很抱歉

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T17:42:02.617

您将同一对象插入`datosTabla`数组 5 次。即使您`lugar`在 for 循环的每次迭代中更改对象的属性，指向`lugar`对象的指针也不会更改。

确保在 for 循环内分配`lugar`对象，以便有 5 个不同的对象。

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    self.title =@"Comer";
    self.datosTabla = [[NSMutableArray alloc] initWithCapacity:6];
    NSArray *nombres = [[NSArray alloc] initWithObjects:@"Masala",@"Italiano",@"Gaia",@"Pekaditos",@"Ojeda",@"Plan B", nil];
    NSArray *direcciones = [[NSArray alloc] initWithObjects:@"C/San Roque, 5", @"C/ Moneda, 7 ",@"C/Nueva, 6", @"C/San Roque, 5", @"C/ Moneda, 7 ",@"C/Nueva, 6", nil];
    NSArray *descripciones = [[NSArray alloc] initWithObjects:@"Bonito restaurante ecologico",@"Restaurante fino y caro", @"El mejor marisco de burgos",@"Calida recio mud", @"Calidad insuperable" , @"Calidad insuperable",nil];
    NSArray *precios = [[NSArray alloc] initWithObjects:@"25€", @"15€", @"12€", @"6€", @"34€", @"34€",nil];
    for (NSUInteger i = 0; i < 6; i++) {
        Lugar *lugar = [[Lugar alloc] init];
        lugar.nombre = [nombres objectAtIndex:i];
        lugar.direccion = [direcciones objectAtIndex:i];
        lugar.descripcion = [descripciones objectAtIndex:i];
        lugar.precio = [precios objectAtIndex:i];
        [self.datosTabla insertObject:lugar atIndex:i];
    }
} 
```

每次调用该方法时，您都需要填充单元格的文本字段，而不仅仅是在 cell == nil 时。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) 
    {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }

    Lugar *tempName =[self.datosTabla objectAtIndex:indexPath.row];
    cell.textLabel.text = tempName.nombre;
} 
```

# java - 如何将我的缓存目录中的文件放在 Android 上的 ImageView 中？

> ID：12940080
> 
> 赞同：0
> 
> 时间：2012-10-17T17:36:24.583
> 
> 标签：java, android, android-imageview, android-file

我有以下代码可以从我的 Android 设备上的目录中获取我的 JPG 文件：

```
File f = new File(cacheDir, fn); 
```

如何`f`将其放入 ImageView 中？

```
ImageView imgView = (ImageView)header.findViewById(R.id.imvCover);

// what call do I make here?
// this obviously is not correct and just for example.
imgView.setToFile(f); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T17:40:08.490

试试这个。由于您有一个文件对象，请使用以下代码。

这可能会帮助你

```
Bitmap bmp = BitmapFactory.decodeFile(f.getAbsolutePath());
imgView.setImageBitmap(bmp); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T17:39:39.090

我认为这是正确的，不是吗？

```
Bitmap b = decodeFile(f);
imgView.setImageBitmap(b); 
```

# javascript - 删除不必要的空白

> ID：12940082
> 
> 赞同：0
> 
> 时间：2012-10-17T17:36:28.353
> 
> 标签：javascript, html, css, whitespace

我有这个片段类，它用红色标记了一个区域。我的系统分为两类：类别和规则。当规则碎片化时，它们会很好地接收新的 css 类并且看起来正确，但与类别不同，它们在类别顶部有不必要的空白。

这是我的意思的屏幕截图：

![不必要的空格](../Images/5806a01e8db145ed9a401567de985993.png)

这是一个现场演示，您可以查看源代码以获取更多信息，因为我不是该样式的原始作者，因此无法提供正确的代码：

[http://zirotec-uka.com/dugi/phpBB3/rules.php#rule1](http://zirotec-uka.com/dugi/phpBB3/rules.php#rule1)

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T17:39:39.810

您有一条规则指定`h3 { margin-top: 20px; }`. 这就是造成空间的原因。

你可以用 覆盖它`#main h3 { margin-top: 0; }`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T17:39:58.827

你需要设置

`#main ul h3, #main ol h3 { margin-top: 0;}`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T17:41:01.420

您只需要删除“填充”CSS 元素。

您可以按如下方式静态执行此操作：

```
$("#rule1").css("padding-top", "0px"); 
```

看看它现在的样子：

[http://imgur.com/erWTH](http://imgur.com/erWTH)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-17T17:42:53.553

这是由 .fragment (style.php:4007) 中的填充引起的

```
.fragment {
    padding: 5px 5px 0 5px;
    background-color: #ECD5D8;
    color: #BC2A4D;
    font-weight: bold;
} 
```

您需要更改或覆盖它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-17T17:47:37.060

该问题是由于浏览器设置的默认填充，可以通过以下规则解决

`#rules li{ padding:0px;}`

# mysql - MySQL 正则表达式匹配

> ID：12940084
> 
> 赞同：0
> 
> 时间：2012-10-17T17:36:29.650
> 
> 标签：mysql, regex, concat

我正在尝试更新我的产品数据库并在更改某些产品编号后查找重复项。

在过去，更改的项目编号只是在末尾有一个额外的破折号和数字或字母，我使用了这个 where 子句：

```
where a.ProdNum REGEXP CONCAT('^', b.ProdNum, '(\-|\s)[a-zA-Z0-9]+') 
```

现在 REGEXP 在我头上。

旧产品编号：BRB-0325

新产品编号：0325-15（破折号后的数字可以是任意1位或2位数字）

所以基本上我需要一个 where 子句，它会从旧编号中删除“BRB-”，并在新项目编号之后删除任何 1 或 2 位数字。

我可以删除“BRB-”，但不知道如何处理 1-2 位数字，我真的不知道如何同时做这两个。

```
where b.ProdNum = CONCAT('BRB-', c.ProdNum) 
```

这是我尝试使用 2 位数字但没有奏效的方法。

```
where c.ProdNum REGEXP CONCAT('^', b.ProdNum, '(\-)[0-9]{1,2}+') 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T17:47:09.627

假设`c.ProdNum`是新号码并且`b.ProdNum`是旧号码：

```
WHERE CONCAT('BRB-', c.ProdNum) REGEXP CONCAT('^', b.ProdNum, '-[0-9]{1,2}$') 
```

这会将“BRB-”添加到新数字并将其与旧数字进行比较。因此，您将基本上将“BRB-0325-15”与“BRB-0325-nn”进行比较。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-17T17:53:30.680

你为什么用`REGEXP`？使用简单的比较：

```
where a.ProdNum like concat(substring(b.ProdNum, 4), '-??') 
```

这将匹配`0325-ab`，但您肯定没有这样的新产品编号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T17:56:20.293

这应该适合你：

```
SELECT
old.*
FROM
products old,
products new
WHERE new.ProdNum REGEXP CONCAT('^', SUBSTRING(old.ProdNum, 5), '-[0-9]{1,2}$')
AND   old.ProdNum LIKE 'BRB-%' 
```

这应该使用一个索引`ProdNum`是否可用。

# html - 如何让 HTML 表格单元格内容占据所有单元格行？

> ID：12940087
> 
> 赞同：-2
> 
> 时间：2012-10-17T17:36:32.477
> 
> 标签：html, css

我有这张桌子 - [http://jsfiddle.net/mark69_fnd/cgwyJ/](http://jsfiddle.net/mark69_fnd/cgwyJ/)

注意，最后一列 - 注释，它跨越所有行。

如何使其内容占据所有行，而不是使表格成为页面的宽度？

我正在寻找类似[http://jsfiddle.net/mark69_fnd/cgwyJ/4/](http://jsfiddle.net/mark69_fnd/cgwyJ/4/)的东西，**只是不使用宽度 css 参数**。

**编辑**

展品 A：

![在此处输入图像描述](../Images/b91a28723914f81c37eb970380a8053e.png)

展品 B：

![在此处输入图像描述](../Images/f462ef359ae40eef743650cafc9e5a88.png)

**编辑 2**

1.  我不是在寻找固定宽度的桌子。我只希望跨行单元格有效地利用垂直空间。
2.  请不要提供涉及宽度的答案。如果您认为需要 width 或 <br/> ，那么您可以回答“不，那是不可能的”。

**编辑 3**

好的，围绕我的问题有很多困惑。可能是因为没有明确表述。

当然，在下面的某个地方存在宽度限制，但它不是一个常数。它不能被烘焙到 CSS 中。这是因为它是以下参数的函数：

*   可用垂直空间的高度 ( `N`)
*   **给定字体**中字符的平均高度( `A`)
*   给定文本的长度，当显示在单行时，再次**以给定字体**( `B`)

给定这些参数，所需的宽度为`A * B / N`。所以，有一种明确定义的方式来表达我想要的东西，但你不能用恒定的宽度来表达它。所以，我的问题是——有没有办法使用其他一些属性/属性以声明方式（即在 HTML/CSS 中）实现这一点？

希望这能澄清一下情况。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T17:42:42.700

要么`<br/>`是段落，要么只是诉诸`width: ;`CSS 参数，你为什么不想这样做？

但是换行（`<br/>`）这一切都是我能想到的唯一其他选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T17:48:32.200

老实说，如果您问我，CSS 方式是最好的，但您始终可以为该段落单元格设置宽度，问题是如果文本太多，它会使底行比其他行高。

[http://jsfiddle.net/calder12/cgwyJ/6/](http://jsfiddle.net/calder12/cgwyJ/6/)

```
<html>
<body>
<table>
<thead>
<tr>
  <th>Browser</th>
  <th>http --&gt; http</th>
  <th>http --&gt; https</th>
  <th>Notes</th>  
</tr>
</thead>
<tbody>
<tr>
  <td>Chrome</td>
  <td>CORS</td>
  <td>CORS (*)</td>
  <td rowspan="3" width="280">If the SSL certificate validation fails, neither CORS nor JSONP will work. However, there is a workaround. The respective request .
 </td>
 </tr>
 <tr>
  <td>Firefox</td>
  <td>CORS</td>
  <td>CORS (*)</td>
  </tr> 
```

# android - 需要帮助使用 ZXing 在 android 中将文本编码为 QR 码

> ID：12940089
> 
> 赞同：2
> 
> 时间：2012-10-17T17:36:48.717
> 
> 标签：android, zxing

我正在尝试使用 ZXing 将文本编码为 QR 码。我已经下载了ZXing 2.0。现在我不知道如何做剩下的事情。请告诉我接下来我需要做什么。我想要做的就是在edittext中输入一个文本，并在我按下按钮时根据这个文本生成二维码。我看过很多与这个主题相关的问题，但我找不到合适的答案。

请解释我要遵循的步骤。我还需要知道我必须在清单中进行哪些更改才能实现这一点，以及如何在我的活动中将 QR 码显示为位图

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T19:40:51.597

使用提供的`android-integration`库（not `core/`, not `android/`）调用 Barcode Scanner`Intent`以显示您喜欢的任何文本的 QR 码。它只是几行代码：[http ://code.google.com/p/zxing/wiki/ScanningViaIntent](http://code.google.com/p/zxing/wiki/ScanningViaIntent)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T22:19:30.287

您需要`core.jar`从最新的 ZXing 源代码版本添加到您的项目中，并在您的包中添加另外两个类。

本方案使用ZXing核心库，*无需*安装第三方应用（Barcode Scanner）。

您只需要按照此[分步指南](https://stackoverflow.com/a/15510698/1181911)进行操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T17:55:39.623

要通过 Zxing 将编辑文本显示为二维码，您可以：

```
Intent intent = new Intent("com.google.zxing.client.android.ENCODE");
String data = edittext.getText().toString();
intent.putExtra("ENCODE_DATA", to_display);
intent.putExtra("ENCODE_TYPE", "TEXT_TYPE");
startActivity(intent); 
```

要使用它，您需要在清单中声明 ZXing EncodeActivity，添加意图过滤器等。

一般来说，他们的代码有很好的文档记录。[他们的项目页面](http://code.google.com/p/zxing/w/list)将是开始的最佳场所。

# mysql - 如何从具有公共复合主键的多个mysql表中获取数据

> ID：12940090
> 
> 赞同：1
> 
> 时间：2012-10-17T17:36:52.707
> 
> 标签：mysql, database, database-design, normalization

我在 mysql 中有 15 个具有不同列数的表。列数范围从 225 到 250。我每天从 15 个不同的 CSV 文件中导入数据。

所有表都有 19 个公共列，在特定日期具有相同的值，并且 3 个公共列的组合可以充当主键。

我需要从 15 个表中获取数据而不重复以将其显示为报告。这该怎么做？

参考样本表结构如下：

```
<html>
<table cellpadding="0" cellspacing="auto" border="1" class="display" id="example" width="100%">
            <thead>
                <tr>
                        <th>Start time </th>
                        <th>End time </th>
                        <th>Query Granularity</th>
                        <th>RNC ID</th>
                        <th>Cell</th>
                        <th>Cellname</th>
                        <th>Access Success Rate Signalling (%)</th>
                        <th>Access Success Rate Speech (%)</th> 
                        <th>Access Success Rate PS (%)</th>
                        <th>Access Success Rate HS (%)</th>
                        <th>Call Drop Rate Speech (%)</th>
                        <th>Call Drop Rate PS (%)</th>
                        <th>Call Drop Rate HS (%)</th>
                        <th>HOSR Speech (%)</th>
                        <th>iRAT HOSR out Speech (%)</th>
                        <th>iRAT HOSR out PS R99 (%)</th>
                        <th>number of rab establishment success for speech</th> 
                        <th>number of rab establishment success for PS</th>
                        <th>number of rab establishment success for HS  </th>
                        <th>number of CS call drop  </th>

                </tr>
            </thead>

            <tbody>
</table>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T14:31:29.050

如前所述，您需要有一个共同的列数才能进行 UNION 查询。要删除 UNION 语句周围的重复项，请使用 SELECT DISTINCT <columna columnb > 语句。

```
select distinct columna columnb from    
(   
    select subcol0a columna, subcol0b columnb, '', '' from table0    
        union
    select subcol1a columna, subcol1b columnb, '', '' from table1 
 )  as query0
where <some condition> 
```

只需为子查询中的各个列设置别名，以便它们在外部 SELECT 中收集时匹配。

# php - 停止发送基于 PHP 的电子邮件

> ID：12940091
> 
> 赞同：1
> 
> 时间：2012-10-17T17:36:59.553
> 
> 标签：php, forms, email, post

我正在构建一个使用 PHP 通过 POST 方法发送的电子邮件联系表单。表单位于 ../register.shtml，操作重定向到 ../register.php

问题是，当 register.php 直接打开时（如不是通过表单），一封空白电子邮件会发送到我的收件箱。有没有办法阻止这种情况发生？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T17:42:39.017

`../register.shtml`在页面上的表单中创建一个隐藏的输入字段。然后，在 上`register.php`，检查是否设置了隐藏输入值。如果是，则处理该表单。如果未设置（用户不是来自表单），则重定向回原始页面。

这是一些代码：

在`../register.shtml`

```
<form action="register.php" method="POST">

... your form fields

<input type="hidden" name="cameFromForm" value="Yes" />
</form> 
```

然后，在顶部`../register.php`

```
if(!isset($_POST['cameFromForm'])) {
    header('location: http://www.example.com/register.shtml');
    exit();
} else {

   .... your send mail code (or whatever register.php does)

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T17:38:56.270

```
if ($_SERVER['REQUEST_METHOD'] == "POST") {
    .....
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-17T17:44:05.010

在您的 register.php 脚本中，您应该检查帖子数据中是否有任何电子邮件消息，如果没有则重定向回表单：

```
<?php

if (!isset($_POST['message']) || $_POST['message'] == '') {
  header('Location: register.shtml');
  exit;
}

// the rest of your php code here 
```

显然将“消息”更改为表单中的实际字段之一。

您可能还想检查每个字段，或者只检查所有必填字段。您可能希望更改重定向 URL 以告诉用户他们需要填写哪个字段。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-17T17:40:47.897

您正在寻找的是...

```
if(!empty($_POST)){
  // send email logic
} 
```

这样，只有在页面上发布了某些内容时才会发送电子邮件。

# web - 如何在网页中嵌入固定位置当前时间的基本天气报告？

> ID：12940094
> 
> 赞同：1
> 
> 时间：2012-10-17T17:37:12.033
> 
> 标签：web, embed, weather

# 我需要的：

我需要根据当前时间和固定位置（爱尔兰共和国的一个县）输出基本天气报告。

# 输出要求：

1.  理想情况下是带有单个图形图标的纯文本（例如，云后的太阳等）。
2.  样式输出的选项。
3.  没有广告；没有徽标。
4.  免费。
5.  数字摄氏温度和简短的文字描述。

我很感激我的期望很高，因此将清单更多地解释为“愿望清单”而不是妄想要求。

# 我试过的：

[http://www.weather-forecast.com](http://www.weather-forecast.com) - iframe 的参数配置不够。输出太臃肿。

谷歌天气 API - 我玩过 PHP 解决方案无济于事，但显然 API 已经死了： http: [//thenextweb.com/google/2012/08/28/did-google-just-quietly-kill -私人天气API/](http://thenextweb.com/google/2012/08/28/did-google-just-quietly-kill-private-weather-api/)

# 我的问题：

任何人都可以提供有关如何嵌入基于固定位置的简单每日天气报告且最小膨胀的建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-17T17:43:57.863

看看[http://www.zazar.net/developers/jquery/zweatherfeed/](http://www.zazar.net/developers/jquery/zweatherfeed/)

它非常可配置，尽管我不确定是否还有太多信息可以满足您的需求。我只在美国地点尝试过；您只需要一个邮政编码。这些示例显示使用来自其他国家/地区的位置。我假设这是为爱尔兰添加位置的类似设置。

# c# - 为什么这个简单的 RESTful WCF 服务会失败并出现 404 错误？

> ID：12940098
> 
> 赞同：2
> 
> 时间：2012-10-17T17:37:25.753
> 
> 标签：c#, visual-studio-2010, wcf, internet-explorer, rest

使用本教程：

[http://www.codeproject.com/Articles/105273/Create-RESTful-WCF-Service-API-Step-By-Step-Guide](http://www.codeproject.com/Articles/105273/Create-RESTful-WCF-Service-API-Step-By-Step-Guide)

当我从 VS 2010 运行应用程序时，我可以获得要显示的目录列表。

我可以将 VS 调用的 IE 浏览器中显示的 URL (http://localhost:4841/) 粘贴到 IE 的外部 VS 实例中，然后看到相同的内容。但是，如果我按照教程中所示附加“/xml/123”或“/json/123”，则 URI 为“http://localhost:4841/xml/123”或“http://localhost: 4841/json/123”，我得到：

## *“/”应用程序中的服务器错误。

无法找到该资源。说明：HTTP 404。您要查找的资源（或其依赖项之一）可能已被删除、名称已更改或暂时不可用。请查看以下 URL 并确保其拼写正确。

## 请求的网址：/json/123/

版本信息：Microsoft .NET Framework 版本：4.0.30319；ASP.NET 版本：4.0.30319.272*

如果我将“RestServiceImpl.svc”附加到 URI，使其为“http://localhost:4841/RestServiceImpl.svc”，我将获得“服务”页面（“这是 Windows© 通信基础服务。元数据发布此服务当前已禁用。"); 但附加“/xml/123”或“/json/123”会导致相同的 404。

最相关的代码（直接取自 5 星教程）是：

```
[ServiceContract]
public interface IRestServiceImpl
{
    [OperationContract]
    [WebInvoke(Method = "GET",
        ResponseFormat = WebMessageFormat.Xml,
        BodyStyle = WebMessageBodyStyle.Wrapped,
        UriTemplate = "xml/{id}")]
    string XMLData(string id);

    [OperationContract]
    [WebInvoke(Method = "GET",
        ResponseFormat = WebMessageFormat.Json,
        BodyStyle = WebMessageBodyStyle.Wrapped,
        UriTemplate = "json/{id}")]
    string JSONData(string id);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T17:41:56.953

我认为您缺少实际的服务，例如。**RestServiceImpl.svc**

所以它会是这样的：

`http://localhost:35798/`**RestServiceImpl.svc**`/xml/123`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T18:09:42.257

好的，我通过在 Web.config 中替换这个来解决这个难题：

```
<service name="RestService.RestServiceImpl" 
```

...有了这个：

```
<service name="REST_JSON_POC.RestServiceImpl" 
```

（以及“RestService”与“REST_JSON_POC”一起出现的其他地方）

（“RestService”是本教程的内容，但 REST_JSON_POC 是我的项目名称）

但现在我有另一个问题，我将为此创建一个新问题（“xml/123”现在可以正常工作，但“json/123”提示下载一个名为“123”的文件，其中包含预期的字符串） .

# android - 运行 hprof-conv.exe 时出错

> ID：12940101
> 
> 赞同：5
> 
> 时间：2012-10-17T17:37:32.157
> 
> 标签：android, memoryanalyzer

`ERROR: read 46402 of 4259932 bytes`运行时出现错误，`hprof-conv.exe`它创建的文件无法使用 MemoryAnalyzer.exe 打开并出现错误`Illegal record length 0 at byte 5,408,931 for record type 1`。

我曾经`android.os.Debug.dumpHprofData("/data/misc/dump.hprof");`创建转储文件并用于`C:\>adb pull /data/misc/dump.hprof`从模拟器中获取转储文件。

有谁知道这里有什么问题？它曾经在我重新启动计算机后的前几次工作。

# php - 并行运行进程时的 session_start 问题

> ID：12940104
> 
> 赞同：0
> 
> 时间：2012-10-17T17:37:48.570
> 
> 标签：php, session, iframe, asynchronous, locked

我需要两个 iframe 表单独立工作（异步），但是当我同时提交两个表单时，第二个 iframe 报告“致命错误：第 2 行的 C:\wamp\www\iframe2.php 中超过 30 秒的最大执行时间"（当 iframe1 查询是一个长进程时）或第二个 iframe 在第一个进程完成后返回数据（当 iframe1 查询是一个短进程时）。现在，我需要保留会话以验证用户登录。我需要你的帮助，我的朋友们！谢谢

**索引.php**

```
<html>
<head>
<title></title>
</head>
<body>
<iframe src="iframe1.php" width="300" height="400"></iframe>
<iframe src="iframe2.php" width="300" height="400"></iframe>
</body>
</html> 
```

**iframe1.php（返回查询结果）**

```
<?php
session_start();

if($_SESSION['user'])
  $data="Valid user";
else
  header("location: login.php");

set_time_limit(120);
require_once("config.php"); //db conections
if($_POST)
{
  //query (long process)
  $data.= ""; // concatenated string with query results
}

?>
<html>
<head>
<title></title>
</head>
<body>
<?php echo session_id();?>
<form method="post">
ini:<input type="text" name="var1" value="" /><br />
fin:<input type="text" name="var2" value="" /><br />
<input type="submit" value="Send" />
</form>
Result:<br />
<?php
if(isset($data))
  echo session_id()."<hr>".$data;
?>
</body>
</html> 
```

**iframe2.php（只返回 123456）**

```
<?php 
session_start();

if($_SESSION['user'])
  $data="Valid user";
else
  header("location: login.php");

if($_POST)
{
  $data =  "123456";
}
?>
<html>
<head>
<title></title>
</head>
<body>
<?php echo session_id();?>
<form method="post">
<input type="text" name="inpt" />
<input type="submit" value="frame2" />
</form>

Result:<br />
<?php
if(isset($data))
  echo session_id()."<hr>".$data;
?>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T17:42:21.140

默认 PHP 会话具有阻止文件访问。这意味着只要在您的第一个脚本中会话仍然*处于活动状态*，第二个脚本对会话的访问就会被阻止。PHP 将等到会话再次可访问。

解决方案通常是保持活跃期的时间跨度较短。通常会话不需要一直处于活动状态。

您使用 激活会话`session_start()`。

您使用 停用会话`session_commit()`。

找到您实际需要活动会话的脚本部分。尽可能晚地打开它（开始）并尽快关闭（提交）它。

# c# - 除非 AutoPostBack 在 DDL 上为真，否则 UpdatePanel 不起作用

> ID：12940108
> 
> 赞同：-2
> 
> 时间：2012-10-17T17:38:09.920
> 
> 标签：c#, drop-down-menu, updatepanel, autopostback

我在不更新整个页面的情况下使用 DDL 更新更新面板中的网格视图时遇到问题。`AutoPostBack`如果在 DDL 上设置为 false 并且当我将其设置为 true 时我相信它正在更新，它根本不起作用。

```
if (page.ispostback)
{
    label.text="posted back"
}
else
{
    label1.text="not posted back"
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T17:42:03.833

如果是 ajax 调用，您将进入 page_load 事件。如果 AutoPostBack 为 false，它不应该发送 ajax 调用，这就是下拉菜单的行为方式。

# google-maps - kml 阻止高程服务

> ID：12940109
> 
> 赞同：4
> 
> 时间：2012-10-17T17:38:16.460
> 
> 标签：google-maps, kml, infowindow, elevation

我有一个谷歌地图高程服务（适用于我的宾夕法尼亚州地理学生），在谷歌的底图上点击可以正常工作。我想添加一个显示 PA 县的 kml 图层。当我添加它时，海拔信息窗口不再显示。有没有办法添加 kml 但抑制其点击响应以显示高程响应？

当前代码（部分）：

```
function initialize() {
var mapOptions = {
    zoom: 7,
    center: centerOfPA,
    mapTypeId: 'roadmap'
}

map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);

var paCounties = new google.maps.KmlLayer('http://mapmaker.millersville.edu/arcgis/services/PAcounties/MapServer/KmlServer', {suppressInfoWindows: true});
paCounties.setMap(map);

  // Create an ElevationService
elevator = new google.maps.ElevationService();

  // Add a listener for the click event and call getElevation on that location
google.maps.event.addListener(map, 'click', getElevation);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T18:52:51.077

抑制[KmlLayer](https://developers.google.com/maps/documentation/javascript/reference#KmlLayer)上的点击事件（可点击：false）或处理点击事件并调用高程服务（使用来自该[点击事件](https://developers.google.com/maps/documentation/javascript/reference#KmlMouseEvent)的 latLng ）。

[这是一个工作示例](http://www.geocodezip.com/v3_GoogleEx_layer-kml_elevation_linkto.html?filename=http://www.geocodezip.com/geoxml3_test/PAcounties_kmz.zip)

# c# - 无法确定数据库实体的必要类型

> ID：12940111
> 
> 赞同：-2
> 
> 时间：2012-10-17T17:38:31.513
> 
> 标签：c#, entity-framework

我的目标是创建一个删除函数，该函数使用 LINQ 通过查找与记录的主键匹配的用户输入的 id 从数据库表中删除记录。

*   **MyDBEntitiesClass**是函数需要传递的参数，它告诉它要搜索的 DataTable。

*   **IDontKnowWhatType**是我在确定时寻求帮助的类型。

*   **MyPrimaryKey**需要替换为引用 MyDBEntitiesClass 的主键的内容。

*   **TestDatabaseEntities**是通过从我现有的 SQL 服务器数据库生成实体模型而创建的连接字符串的名称。

```
public static void DeleteFrom(IDontKnowWhatType MyDBEntitiesClass)
{

var dbEntities = new TestDatabaseEntities(); 

    //Prompt the user for an ID
    Console.WriteLine("Select ID for deletion.");

    // save the ID to IDtoMark
    int IDtoMark = int.Parse(Console.ReadLine());
    try
    {
        // return a single record that matches IDtoMark 
        MyDbEntitiesClass x = dbEntities.MyDbEntitiesClass.Single(x => x.myPrimaryKey == IDtoMark);
        //Remove the marked record, and save changes
        dbEntities.MyDbEntitiesClass.Remove(x);
        dbEntities.SaveChanges();
    }
    catch(Exception ex)
    {
        Console.WriteLine(ex.Message);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T17:53:30.383

您可以通过实现存储库模式来实现这一点。

我猜你正在使用实体框架。为此，您有通用类。

```
public class Repository<T> where T : class
{
    private DbContext dbContext;
    private DbSet<T> DbSet { get; set }
    public Repository(dbContext)
    {
       this.dbContext = dbContext;
       this.DbSet = this.dbContext.DbSet<T>();
    }

    public void Delete(int id)
    {
         T entity = DbSet.Find(id);
         DbSet.Remove(entity);
         dbContext.Save();
    }

} 
```

# android - Android iframe 错误

> ID：12940114
> 
> 赞同：0
> 
> 时间：2012-10-17T17:38:54.463
> 
> 标签：android, iframe

我在运行 Android 4.0.4 的手机上遇到问题。

我有一个带有文本字段和几个下拉列表的 iframe，但是在纵向模式下 iframe 太宽而无法放入手机窗口，所以我得到了一个水平滚动条，因此我可以滚动查看所有字段。

问题是，如果我向右滚动 iframe，我将无法再选择文本框或下拉菜单。

看起来设备没有意识到 iframe 已向右滚动，因此例如，当 iframe 第一次渲染时，内容定位为左对齐。此时，在 iframe 的最右侧可以看到其中一个下拉菜单。如果我将 iframe 一直滚动到右侧并点击下拉菜单所在的屏幕，我会得到下拉菜单***的***选择屏幕，即使我实际点击的屏幕区域根本没有任何元素。

如果我点击下拉菜单实际所在的屏幕，我根本没有得到任何响应。

我在这里有一个测试页面：http: [//snow.x10.mx/damian/page.html](http://snow.x10.mx/damian/page.html)

在桌面上的 Firefox 上一切正常，所以看起来它可能只是一个 Android 错误。

任何人都可以建议一个解决方法（除了确保 iframe 不比屏幕宽），因为我看不到 Android 修复程序很快就会出现！

如果有人有 iPhone 可以测试它，如果你有同样的问题，你能告诉我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T17:55:41.873

我在使用 Android 4.0.4 时遇到了同样的问题

垂直滚动也会发生同样的事情，并适用于输入字段、链接......任何应该对触摸/点击事件做出反应的东西。如果元素在滚动之前可见，则滚动后它仍在对触摸事件做出反应的位置。如果它在滚动之前不可见，则您无法与该元素进行交互。

我不确定是什么原因造成的，但是使用滚动条插件（[jScrollPane](http://jscrollpane.kelvinluck.com/index.html)）已经为我解决了。

祝你好运！

# mysql - MySQL更改汇总的最后一行

> ID：12940119
> 
> 赞同：2
> 
> 时间：2012-10-17T17:39:22.573
> 
> 标签：mysql, sql, group-by, rollup

我正在查询报告并使用汇总来获取总数。我的一个专栏有一个在末尾重复的文本字段。例如：

```
SELECT * FROM transactions;

  transNum | itemid | description | qty
 ---------------------------------------
        01 |     01 |    DESC1    |  14
        02 |     01 |    DESC1    |  05
        03 |     01 |    DESC1    |  01
        04 |     02 |    DESC2    |  02
        05 |     02 |    DESC2    |  01
        06 |     02 |    DESC2    |  02
        07 |     03 |    DESC3    |  05
        08 |     03 |    DESC3    |  06
        09 |     03 |    DESC3    |  01

SELECT itemid,description,qty FROM transactions GROUP BY id WITH ROLLUP;

    itemid | description | qty
   ----------------------------
        01 |    DESC1    |  20
        02 |    DESC2    |  05
        03 |    DESC3    |  12
           |    DESC3    |  37 
```

这是一个粗略的例子，我的实际数据由多个表组成。

现在，我知道 DESC3 被重复了，因为我没有按描述字段分组，但是有什么函数可以解决这个问题吗？

其他数据库引擎有一个 GROUPING 功能，这基本上是我需要的，但在 MySQL 中。

感谢您的任何帮助

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-17T18:12:36.407

好的，然后试试这个：

```
SELECT a.itemid, b.description, a.total
FROM
    (
        SELECT itemid, sum(qty) as total
        FROM transactions
        GROUP BY itemid WITH ROLLUP
    ) as a
    LEFT JOIN item b ON a.itemid=b.itemid 
```

假设您有一个以`item`项目描述为键的表命名`itemid`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-17T18:01:30.853

从[docs](http://dev.mysql.com/doc/refman/5.0/en/group-by-modifiers.html)来看，无法更改最后一行的内容。

结果集在行的中带有一个`NULL`值，以便您可以在应用程序中识别它。`1st column``rollup`

这是一个可以使用它的 SQL Fiddle：[http ://sqlfiddle.com/#!8/d611d/8](http://sqlfiddle.com/#!8/d611d/8)

`rollup`如您所见，它确实重复了该行中的先前描述。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-25T21:30:47.687

采用：`case when itemid is null then Total`

# php - 在 IE 和 Safari 中提交表单时，Iframed 页面会导致会话过期

> ID：12940120
> 
> 赞同：1
> 
> 时间：2012-10-17T17:39:22.940
> 
> 标签：php, javascript, html, iframe, fancybox

嗨，我在我的网站上使用了第三方订单，该订单由 iframe 显示。在使用 IE 或 Safari 时，iframe 拒绝接受表单提交，并显示错误框“会话已过期”

该页面是： http: [//prepaidnuller.nl/gratisprepaid.php](http://prepaidnuller.nl/gratisprepaid.php)

如果您点击 bestel 按钮，您只需点击页面下方的“volgende”，您将收到一个错误框，提示会话已过期（IE 和 Safari）其他浏览器可以正常工作。

当关闭 iframe 然后手动刷新上面的页面然后重试提交表单时，整个事情都被接受了。

关于 IE 和 Safari 如何接受表单提交的任何解决方案？并且不显示会话已过期。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T07:33:24.147

我的赌注？

[在本文档中找不到或识别出任何 DOCTYPE 声明。这通常意味着文档没有在顶部声明其文档类型。这也可能意味着 DOCTYPE 声明包含拼写错误，或者它没有使用正确的语法。](http://validator.w3.org/check?uri=http://prepaidnuller.nl/gratisprepaid.php)

Fancybox（像大多数 jQuery 插件一样）需要在标准模式下运行，这意味着`DOCTYPE`必须设置正确的声明。

查看[这篇好文章](http://www.alistapart.com/articles/doctype/)以获取更多信息或简单地将其设置为文档的第一行：

```
<!DOCTYPE html> 
```

顺便说一句，由于您使用的是带有***内联***内容的 fancybox v1.3.4，因此请注意[此 BUG](https://groups.google.com/forum/?fromgroups=#!topic/fancybox/-re22BoXOzM)及其解决方法。

# c# - SalesForce 查询方法不返回可用数据

> ID：12940122
> 
> 赞同：4
> 
> 时间：2012-10-17T17:39:24.890
> 
> 标签：c#, .net, mono, salesforce

我正在尝试与 SalesForce 的 SOAP Web 服务集成。我的目标是简单地从 SalesForce 中提取用户数据，以便我们可以将其集成到我们的系统中。我能够使用从 SalesForce 网站上的合作伙伴 WSDL 生成的代理类 (C#) 成功登录。我要做的下一件事是查询用户，下拉名字、姓氏等...

重要的是要知道我被迫修改生成的代理代码，因为它生成不正确。它填充了 xml 序列化字段以匹配在进行 Web 服务调用时引发异常的私有字段。它还为我删除的 sObject 类的“Any”属性生成了一个空白命名空间。如果您想了解我做出这些选择的原因，我从[这个 StackOverflow 主题中获得了建议。](https://stackoverflow.com/questions/2567466/mono-wsdl-tool-fails-to-parse-salesforce-enterprise-wsdl)

这是我的查询的样子： ![在此处输入图像描述](../Images/a11cc6a8776226be90212d825f0336cc.png)

qResult 正好包含 3 条记录（这是准确的，因为我只有 3 个用户）。问题是 sObject 上的每个属性除了“类型”之外总是为空。

我不知道是在尝试查询时犯了一个简单的错误，还是我必须修改代理类并删除 Any 字段上的命名空间这一事实导致了这个问题。我现在不知道该怎么做。开发人员控制台（SalesForce.com）中的相同查询返回正确的数据。还值得一提的是，我的查询结果返回了适量的元素，它们只是没有任何数据。它一定很简单......就像添加命名空间绑定但弄清楚它应该是什么或向属性添加 xmlbinding。

我只是想知道是否有人知道该怎么做。也许有人也有同样的事情发生在他们身上？

编辑：所以我花时间执行一些令人难以置信的黑客技术来拦截来自生成的 Web 服务客户端的请求，最后我得到了从 SalesForce 发送来响应我的请求的原始数据。这里是：

```
<?xml version="1.0" encoding="UTF-8"?>
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns="urn:partner.soap.sforce.com" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:sf="urn:sobject.partner.soap.sforce.com">
    <soapenv:Body>
        <queryResponse>
            <result xsi:type="QueryResult">
            <done>true</done>
            <queryLocator xsi:nil="true"/>
            <records xsi:type="sf:sObject">
                <sf:type>User</sf:type>
                <sf:Id xsi:nil="true"/>
                <sf:FirstName>Bob</sf:FirstName>
                <sf:LastName>Dyllan</sf:LastName>
                <sf:Email>bob@bob.com</sf:Email>
                <sf:CompanyName xsi:nil="true"/>
                <sf:Phone xsi:nil="true"/>
                <sf:Title xsi:nil="true"/>
            </records>
            <records xsi:type="sf:sObject">
                <sf:type>User</sf:type>
                <sf:Id xsi:nil="true"/>
                <sf:FirstName>Zachary</sf:FirstName>
                <sf:LastName>Sheppard</sf:LastName>
                <sf:Email>some_guy@yahoo.com</sf:Email>
                <sf:CompanyName>Yahoo</sf:CompanyName>
                <sf:Phone xsi:nil="true"/>  
                <sf:Title xsi:nil="true"/>
            </records>
            <records xsi:type="sf:sObject"> 
                <sf:type>User</sf:type>
                <sf:Id xsi:nil="true"/>
                <sf:FirstName xsi:nil="true"/>
                <sf:LastName>Chatter Expert</sf:LastName>   
                <sf:Email>noreply@chatter.salesforce.com</sf:Email>
                <sf:CompanyName xsi:nil="true"/>        
                <sf:Phone xsi:nil="true"/>
                <sf:Title xsi:nil="true"/>
            </records>
            <size>3</size>
            </result>
        </queryResponse>
    </soapenv:Body>
    </soapenv:Envelope> 
```

这些 sObjects 上的“sf”属性似乎确实存在序列化问题......但我如何使它与我的 C# 匹配？这是当前用于 sObject 类的 C#：

```
[System.CodeDom.Compiler.GeneratedCodeAttribute("System.Xml", "4.0.30319.1")]
[System.SerializableAttribute()]
[System.Diagnostics.DebuggerStepThroughAttribute()]
[System.ComponentModel.DesignerCategoryAttribute("code")]
[System.Xml.Serialization.XmlTypeAttribute(Namespace="urn:sobject.partner.soap.sforce.com")]
public partial class sObject
{

    /// <remarks/>
    public string type;

    /// <remarks/>
    [System.Xml.Serialization.XmlElementAttribute("fieldsToNull", IsNullable=true)]
    public string[]
        fieldsToNull;

    /// <remarks/>
    [System.Xml.Serialization.XmlElementAttribute(IsNullable=true)]
    public string
        Id;

    /// <remarks/>
    public System.Xml.XmlElement[]
        Any;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:24:41.613

经过一整天的研究和挫折，我终于找到了 SalesForce 的 sObject 类的“任何”属性的正确属性。SalesForce 试图将相关的 xml 元素收集到这个 sObject 类中，这允许他们将 sObject 类保留为动态类型。因此，为了强制 C# 类将所有 xml 标记刮入“Any”属性中，我们只需应用以下代码：

```
[System.Xml.Serialization.XmlAnyElement] 
```

需要明确的是，当您从您的 SalesForce 帐户生成 WSDL 时，它可能不正确。您需要重命名传递给属性的一些字符串参数，并将 sObject 类的“Any”属性上的空命名空间替换为 XmlAnyElement 属性，以便从 API 的查询调用中获得成功的结果。可以在[此 StackOverflow 主题](https://stackoverflow.com/questions/2567466/mono-wsdl-tool-fails-to-parse-salesforce-enterprise-wsdl)主题中找到使客户端功能所需的更改。

我现在能够成功调用 SalesForce API 的查询函数并取回我查询的字段......我感觉好多了！

# ruby-on-rails - 在 Rails 中，如何获取 GET 字符串并将其解析为对象？

> ID：12940124
> 
> 赞同：2
> 
> 时间：2012-10-17T17:39:29.923
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我很肯定这是一个骗局，但我找不到原件。

给定一个 GET 样式的字符串，如`foo=bar&x[0]=baz`，我如何`params`在 Rails 应用程序中将其解码为 -like 数组？

* * *

**更新添加**：请注意，这`CGI.parse`似乎比 Rails 所做的任何事情都要少得多：

```
1.9.3p194 :006 > CGI::parse 'foo=bar&x[foo][bar]=baz'
 => {"foo"=>["bar"], "x[foo][bar]"=>["baz"]} 
```

CGI.parse 没有将嵌套对象解包到多级哈希中。在 Rails 中，在某种程度上，这实际上是经过检查的。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-17T17:48:50.780

对于嵌套查询，Rails 使用 Racks 的参数解析器`Rack::Utils.parse_nested_query`：

```
Rack::Utils.parse_nested_query 'foo=bar&x[foo][bar]=baz'
 => {"foo"=>"bar", "x"=>{"foo"=>{"bar"=>"baz"}}} 
```

# javascript - 第一次刷卡后禁用刷卡，然后在完成后重置？

> ID：12940139
> 
> 赞同：0
> 
> 时间：2012-10-17T17:40:10.117
> 
> 标签：javascript, jquery, ios

我有下面的代码，它允许我滑动一个元素，元素会移动，露出下面的元素。我希望能够滑动一次，让函数运行，让 div 重置它的位置，然后让我再次滑动。基本上，在功能运行时禁用滑动，然后在功能结束后启用它。

这是我的代码：

```
var threshold = {
    x: 30,
    y: 10
}
var originalCoord = {
    x: 0,
    y: 0
}
var finalCoord = {
    x: 0,
    y: 0
}

    function touchMove(event) {
        finalCoord.x = event.targetTouches[0].pageX
        changeX = originalCoord.x - finalCoord.x
        var changeY = originalCoord.y - finalCoord.y
        if (changeY < threshold.y && changeY > (threshold.y * -1)) {
            changeX = originalCoord.x - finalCoord.x
            if (changeX > threshold.x) {
                // My function which runs when you swipe left
            }
        }
    }

    function touchEnd(event) {
    }

    function touchStart(event) {
        originalCoord.x = event.targetTouches[0].pageX
        finalCoord.x = originalCoord.x
    }

window.addEventListener("touchstart", touchStart, false);
window.addEventListener("touchmove", touchMove, false);
window.addEventListener("touchend", touchEnd, false); 
```

我想我可以在功能运行后使用`event.preventDefault()`或`return false`禁用拖动，但它最终仍然允许我在此期间拖动。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T18:01:37.373

很难弄清楚你想要什么，但要禁用刷卡只需添加辅助变量：

```
var _swipeDisabled = false; 
```

然后在 touchmove 中检查滑动是否被禁用，如果是这样`return false`：

```
function touchMove(event) {
    if (_swipeDisabled) return false; // this line is crucial
    finalCoord.x = event.targetTouches[0].pageX
    changeX = originalCoord.x - finalCoord.x
    var changeY = originalCoord.y - finalCoord.y
    if (changeY < threshold.y && changeY > (threshold.y * -1)) {
        changeX = originalCoord.x - finalCoord.x
        if (changeX > threshold.x) {
            _swipeDisabled = true; // add this before calling your function
            // My function which runs when you swipe left
        }
    }
} 
```

在您的功能中，您必须再次启用滑动，所以只需执行以下操作：

```
_swipeDisabled = false; 
```

在你在那里调用的函数中。最简单的解决方案通常是最好的，记住！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T18:11:20.350

我能够通过删除然后重新添加来解决这个问题`EventListener`：

```
if (changeX > threshold.x) {
    window.removeEventListener('touchmove', touchMove, false);
    // Function
    setTimeout(function () {
        window.addEventListener('touchmove', touchMove, false);
    }, 800)
} 
```

# rubygems - 为什么运行'bundle package'时出现错误“找不到rubygems-bundler”

> ID：12940140
> 
> 赞同：3
> 
> 时间：2012-10-17T17:40:12.640
> 
> 标签：rubygems, ruby-on-rails-3.2, bundler

我遇到了与[Gem::LoadError: Could not find ruby​​gems-bundler (>= 0)](https://stackoverflow.com/questions/10658028/gemloaderror-could-not-find-rubygems-bundler-0-amongst)类似的问题，我假设提到的错误已经修复。

我习惯`bundle package`将我的 gem 放在 /vendor/ruby 中，这在 Ryan McCreary 的出色工作流程[“Vendor Everything Still Applys”中有详细说明。](http://ryan.mcgeary.org/2011/02/09/vendor-everything-still-applies/)

我运行时的错误`bundle package`是：

```
Error loading RubyGems plugin "/Users/brad/.rvm/gems/ruby-1.9.3-p194@global/gems/rubygems-bundler-1.1.0/lib/rubygems_plugin.rb":
Could not find rubygems-bundler (>= 0) amongst
[actionmailer-3.2.8, actionpack-3.2.8, activemodel-3.2.8, activerecord-3.2.8, activeresource-3.2.8, activesupport-3.2.8, addressable-2.3.2, arel-3.0.2, bcrypt-ruby-3.0.1, bootstrap-sass-2.1.0.1, builder-3.0.4, cancan-1.6.8, capybara-1.1.2, childprocess-0.3.6, coffee-rails-3.2.2, coffee-script-2.2.0, coffee-script-source-1.3.3, cucumber-1.2.1, cucumber-rails-1.3.0, daemons-1.1.9, database_cleaner-0.9.1, devise-2.1.2, diff-lcs-1.1.3, email_spec-1.2.1, erubis-2.7.0, eventmachine-1.0.0, execjs-1.4.0, factory_girl-4.1.0, factory_girl_rails-4.1.0, ffi-1.1.5, gherkin-2.11.5, haml-3.1.7, haml-rails-0.3.5, hike-1.2.1, hpricot-0.8.6, i18n-0.6.1, journey-1.0.4, jquery-rails-2.1.3, json-1.7.5, launchy-2.1.2, libwebsocket-0.1.5, mail-2.4.4, mime-types-1.19, multi_json-1.3.6, nokogiri-1.5.5, orm_adapter-0.4.0, polyglot-0.3.3, quiet_assets-1.0.1, rack-1.4.1, rack-cache-1.2, rack-ssl-1.3.2, rack-test-0.6.2, rails-3.2.8, railties-3.2.8, rake-0.9.2.2, rdoc-3.12, rolify-3.2.0, rspec-2.11.0, rspec-core-2.11.1, rspec-expectations-2.11.3, rspec-mocks-2.11.3, rspec-rails-2.11.4, ruby_parser-2.3.1, rubyzip-0.9.9, sass-3.2.1, sass-rails-3.2.5, selenium-webdriver-2.25.0, sexp_processor-3.2.0, simple_form-2.0.4, sprockets-2.1.3, sqlite3-1.3.6, thin-1.5.0, thor-0.16.0, tilt-1.3.3, treetop-1.4.11, tzinfo-0.3.33, uglifier-1.3.0, warden-1.2.1, xpath-0.1.4] (Gem::LoadError) 
```

任何想法我做错了什么或如何解决它；也就是说，*为什么*bundler 在我运行时会寻找 ruby​​gems-bundler `bundle package`？尽管这显示为“错误”（不是警告），但我的捆绑包似乎打包得很好。

当我包含`gem 'rubygems-bundler'`在我的 Gemfile 中时，错误就消失了，但我不确定我为什么需要这样做。

（顺便说一句，这个应用程序最初是使用 Rails3-bootstrap-devise-cancan 选项为[Daniel Kehoe](https://github.com/RailsApps/rails-composer/)的出色 RailsComposer 创建的。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-18T08:14:14.770

也许尝试： `gem install rails -v 'your version'`

# java - 为什么我的 Service 的 AsyncTask 会阻止主 Activity 的 AsyncTasks？

> ID：12940142
> 
> 赞同：3
> 
> 时间：2012-10-17T17:40:17.430
> 
> 标签：java, android, multithreading, blocking

我正在尝试编写一个简单的服务，每隔几秒钟就会做一些事情。但是当我尝试在主 Activity 中运行其他 AsyncTasks 时运行服务时，我注意到其他 AsyncTasks 卡在 onPreExecute 上。当我禁用该服务时，一切都按预期工作。服务的 AsynTask 阻塞其他 AsyncTask 是否有原因？

**服务**

```
public class SVC_SyncData extends Service {

    private final String TAG = "SVC_SyncData";

    private AT_SyncData m_SyncPoll = null;

    public static boolean isRunning = false;

    public SVC_SyncData() {
    }

    @Override
    public IBinder onBind(Intent intent) {
        return null;
    }

    @Override
    public void onCreate() {
        super.onCreate();
        Log.i(TAG, "onCreate");
        m_SyncPoll = new AT_SyncData(this);
    }

    @Override
    public int onStartCommand(Intent intent, int flags, int startId) {
        Log.i(TAG, "onStartCommand");
        m_SyncPoll.execute();
        isRunning = true;
        return START_STICKY;
    }

    @Override
    public void onDestroy() {
        super.onDestroy();
        Log.i(TAG, "onDestroy");
        m_SyncPoll.cancel(false);
        isRunning = false;
    }
} 
```

**AT_SyncData 的 doInBackground**

```
@Override
protected Void doInBackground(Void... params) {
    Log.i(TAG, "doInBackground");

    try {
        while (!isCancelled()) {
            Log.i(TAG, "syncData");

            // Sleep until next cycle
            Thread.sleep(5000);
        }
    }
    catch (Exception ex) {
        ex.printStackTrace();
    }

    return null;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-17T17:52:17.347

AsyncTask[文档](http://developer.android.com/reference/android/os/AsyncTask.html)指出：

> **执行顺序**
> 
> 首次引入时，AsyncTask 在单个后台线程上串行执行。从 DONUT 开始，这被更改为允许多个任务并行运行的线程池。从 HONEYCOMB 开始，任务在单个线程上执行，以避免并行执行导致的常见应用程序错误。
> 
> 如果你真的想要并行执行，你可以使用 THREAD_POOL_EXECUTOR 调用 executeOnExecutor(java.util.concurrent.Executor, Object[])。

因此，较新版本的 android 会有你描述的这个问题。您需要使用 executeOnExecutor 来确保您在单独的线程上运行。

此外，如果您有要在单独的线程中运行的服务，我建议：

1.  使用[IntentService](http://developer.android.com/reference/android/app/IntentService.html)
2.  有时，您希望对服务的生命周期进行比 IntentService 提供的更多的控制，在这种情况下，您可以在服务中创建一个线程并在其中运行您的后台代码。实际上，更具体地说，创建一个包含 Looper的[HandlerThread ，以便您可以使用标准的 android 方法在主线程和后台线程之间进行通信（消息）。](http://developer.android.com/reference/android/os/HandlerThread.html)就个人而言，我通常为我的服务选择此选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T17:55:14.083

如果它在服务中，只需使用 Thread 或 Callable。AsyncTask 用于 UI 线程。服务不是 UI 线程。

API 是这样说的：“AsyncTasks 应该理想地用于短时间的操作（最多几秒钟。）**如果您需要保持线程长时间运行，**强烈建议您使用 java 提供的各种 API Executor、ThreadPoolExecutor、FutureTask等.util.concurrent包"

[异步任务](http://developer.android.com/reference/android/os/AsyncTask.html)

# xml - 如何捕获 DataStage 中使用的数据源的元数据信息

> ID：12940143
> 
> 赞同：1
> 
> 时间：2012-10-17T17:40:19.140
> 
> 标签：xml, metadata, workbench, datastage

该平台是 IBM datastage 8.1。我们无权访问 DataStage。我们只能获取 .dsx/xml 导出的文件。

现在我们需要捕获哪些数据库/表（源）转换为另一个数据库/表（目标）的元数据信息。

一旦我们有了 DS 作业中使用的数据库/表的列表，我们将把这些信息放在元数据工作台中，以用于数据沿袭。

还有其他方法可以获取此类信息吗？任何想法或想法都会对我有很大帮助。

提前谢谢你....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T14:15:27.747

您应该向您的 datastage 团队请求他们使用与 datastage 捆绑的元数据数据库，即有一个脚本应该将 xml 文件中的数据插入该数据库，据我所知，您可以将同一个数据库与 metadate 工作台一起使用出色地。

# android - View 在被移动后仍然捕获触摸事件

> ID：12940154
> 
> 赞同：0
> 
> 时间：2012-10-17T17:41:18.810
> 
> 标签：android

在我的 android 应用程序中，我有一个位于另一个视图之上的视图。当我点击一个按钮时，这个顶视图会变成动画并离开屏幕。问题是视图仍然“存在”，因为它捕获所有触摸事件并且它们不会传递给后面的视图。

这是动画视图的代码：

```
TranslateAnimation animation = new TranslateAnimation (0, 0, 0, height);
animation.setDuration(1000);
animation.setFillAfter(true);
topView.startAnimation(animation); 
```

我能做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T17:51:05.720

创建一个动画监听器并在动画结束时从其父级移除视图。

```
Animation animation = new AlphaAnimation(0 ,0);
        animation.setAnimationListener(new AnimationListener() {

            public void onAnimationStart(Animation animation) {
                // TODO Auto-generated method stub

            }

            public void onAnimationRepeat(Animation animation) {
                // TODO Auto-generated method stub

            }

            public void onAnimationEnd(Animation animation) {
                parentView.removeView(topView)
            }
        }); 
```

# android - 同一行中的两个按钮 > 线性布局内的相对布局

> ID：12940156
> 
> 赞同：0
> 
> 时间：2012-10-17T17:41:21.323
> 
> 标签：android, android-layout

所以我需要将两个按钮放在同一行，所以我尝试在线性布局中使用相对布局，但它们只能在下方移动，而不能向侧面移动。

应该如何：

`TextView`

`TextView`

`TextView`

`TextView`

`Button1` `Button2`

编码：

`<?xml version="1.0" encoding="utf-8"?> <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" xmlns:tools="http://schemas.android.com/tools" android:layout_width="match_parent" android:layout_height="match_parent" android:orientation="vertical" tools:ignore="HardcodedText" >`

```
<TextView
    android:id="@+id/textView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="TextView" />

<TextView
    android:id="@+id/textView2"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="TextView" />

<TextView
    android:id="@+id/textView3"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="TextView" />

<TextView
    android:id="@+id/textView4"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="TextView" /> 
```

`<RelativeLayout android:layout_width="wrap_content" android:layout_height="match_parent" >`

```
<Button
    android:id="@+id/button1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Button" />

<Button
    android:id="@+id/button2"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Button" /> 
```

`</RelativeLayout>`

`</LinearLayout>`

他们应该彼此靠近（按钮），但它似乎不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-17T17:44:10.267

看一看

```
<TextView
    android:id="@+id/textView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="TextView" />

<TextView
    android:id="@+id/textView2"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="TextView" />

<TextView
    android:id="@+id/textView3"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="TextView" />

<TextView
    android:id="@+id/textView4"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="TextView" />
<LinearLayout android:layout_width="fill_parent" android:layout_height="wrap_content" >

<Button
    android:id="@+id/button1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_weight="1"
    android:text="Button" />

<Button
    android:id="@+id/button2"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
   android:layout_weight="1"
    android:text="Button" />
</LinearLayout>

</LinearLayout> 
```

这是你需要的吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-17T17:48:12.303

您只能使用现有代码来执行此操作。在第二个按钮中使用第一个按钮的 id。

```
<RelativeLayout 
      android:layout_width="wrap_content" 
      android:layout_height="match_parent" >

<Button
    android:id="@+id/button1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Button" />

<Button
    android:id="@+id/button2"
    android:layout_toRightOf="@id/button1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Button" />

</RelativeLayout> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-17T17:43:37.640

那这个呢：

仔细看看相对布局，它现在使用`wrap_content`它的高度和`match_parent`宽度。还要注意`alignParent`按钮 xml 中的部分。使用 a`RelativeLayout`不是执行此操作的唯一方法，但如果您希望按钮浮动在右侧和左侧可能会更好。您也可以使用 a `LinearLayout`，它的方向设置为`horizontal`。

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    tools:ignore="HardcodedText" >

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="TextView" />

    <TextView
        android:id="@+id/textView2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="TextView" />

    <TextView
        android:id="@+id/textView3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="TextView" />

    <TextView
        android:id="@+id/textView4"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="TextView" />

    <RelativeLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content" >

        <Button
            android:id="@+id/button2"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentRight="true"
            android:layout_alignParentTop="true"
            android:text="Button" />

        <Button
            android:id="@+id/button1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentLeft="true"
            android:layout_alignParentTop="true"
            android:text="Button" />
    </RelativeLayout>

</LinearLayout> 
```

罗尔夫

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-12T12:18:01.343

我知道这个线程很旧，但我有一个我想要的案例：

```
 [     Button1     ]
    [Button2] [Button3] 
```

当我尝试在线性布局中嵌入线性布局时，格式正确，但按钮没有响应。

我解决它的方法是将按钮 2 和 3 放在一个表格中，如果您想将此解决方案应用于您的示例，它看起来像：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

<TextView
    android:id="@+id/textView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="TextView" />

<TextView
    android:id="@+id/textView2"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="TextView" />

<TextView
    android:id="@+id/textView3"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="TextView" />

<TextView
    android:id="@+id/textView4"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="TextView" />
<TableRow
    android:id="@+id/tableRowForButtons"
    android:layout_width="match_parent"
    android:layout_height="wrap_content" >
    <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Button" />

    <Button
        android:id="@+id/button2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Button" />
</TableRow>
</LinearLayout> 
```

# asp.net-mvc-4 - OAuthWebSecurity.VerifyAuthentication IsSuccessful 返回 false 我如何确定原因？

> ID：12940162
> 
> 赞同：7
> 
> 时间：2012-10-17T17:41:45.633
> 
> 标签：asp.net-mvc-4, dotnetopenauth

我将 DotNetOpenAuth 与 MVC 4 应用程序一起使用。突然谷歌身份验证失败（MS正在工作）。股票代码这样做：

```
[AllowAnonymous]
public ActionResult ExternalLoginCallback(string returnUrl)
{
    var result = OAuthWebSecurity.VerifyAuthentication(Url.Action("ExternalLoginCallback", new { ReturnUrl = returnUrl }));
    if (!result.IsSuccessful)
    {
        return RedirectToAction("ExternalLoginFailure");
    } 
```

我知道那`result.IsSuccessful`是假的，但我怎么知道原因呢？`result.Error`一片空白。

我还查看了[此页面](http://www.dotnetopenauth.net/developers/help/loggingdebugging-dotnetopenauth-with-log4net/)以使用 log4net。我确实在本地开发箱上获得了日志，但在将其部署到远程服务器时却没有。

log4net 网络配置：

```
<log4net>
    <appender name="RollingFileAppender" type="log4net.Appender.RollingFileAppender">
      <file value="RelyingParty.log" />
      <appendToFile value="true" />
      <rollingStyle value="Size" />
      <maxSizeRollBackups value="10" />
      <maximumFileSize value="100KB" />
      <staticLogFileName value="true" />
      <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%date (GMT%date{%z}) [%thread] %-5level %logger - %message%newline" />
      </layout>
    </appender>
    <!-- Setup the root category, add the appenders and set the default level -->
    <root>
      <level value="INFO" />
      <appender-ref ref="RollingFileAppender" />
    </root>
    <!-- Specify the level for some specific categories -->
    <logger name="DotNetOpenAuth">
      <level value="ALL" />
    </logger>
  </log4net> 
```

**编辑**我也试过 log4net 到一个 sql 数据库，但它仍然没有记录任何东西

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T20:02:44.370

我终于想通了。我收到的实际错误消息：

```
Protocol error: This message has a timestamp of 10/23/2012 12:19:33 PM, 
which is beyond the allowable clock skew for in the future. 
```

在服务器崩溃后发现时区设置不正确。这导致验证/令牌从谷歌端失败。

这`AdoNetAppender`是“不工作”，因为`bufferSize`设置为 100。将其设置为 1 后，它开始获取日志。这是我正在使用的 adonetappender

```
 <log4net>
        <appender name="AdoNetAppender" type="log4net.Appender.AdoNetAppender">
      <bufferSize value="1" />
      <connectionType value="System.Data.SqlClient.SqlConnection, System.Data, Version=1.0.3300.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" />
      <connectionStringName value="CONNECTIONSTRINGNAME" />
      <commandText value="INSERT INTO Log4Net ([Date],[Thread],[Level],[Logger],[Message],[Exception]) VALUES (@log_date, @thread, @log_level, @logger, @message, @exception)" />
      <parameter>
        <parameterName value="@log_date" />
        <dbType value="DateTime" />
        <layout type="log4net.Layout.RawTimeStampLayout" />
      </parameter>
      <parameter>
        <parameterName value="@thread" />
        <dbType value="String" />
        <size value="255" />
        <layout type="log4net.Layout.PatternLayout">
          <conversionPattern value="%thread" />
        </layout>
      </parameter>
      <parameter>
        <parameterName value="@log_level" />
        <dbType value="String" />
        <size value="50" />
        <layout type="log4net.Layout.PatternLayout">
          <conversionPattern value="%level" />
        </layout>
      </parameter>
      <parameter>
        <parameterName value="@logger" />
        <dbType value="String" />
        <size value="255" />
        <layout type="log4net.Layout.PatternLayout">
          <conversionPattern value="%logger" />
        </layout>
      </parameter>
      <parameter>
        <parameterName value="@message" />
        <dbType value="String" />
        <size value="4000" />
        <layout type="log4net.Layout.PatternLayout">
          <conversionPattern value="%message" />
        </layout>
      </parameter>
      <parameter>
        <parameterName value="@exception" />
        <dbType value="String" />
        <size value="2000" />
        <layout type="log4net.Layout.ExceptionLayout" />
      </parameter>
    </appender>
    <root>
      <level value="Debug" />
      <appender-ref ref="AdoNetAppender" />
    </root>
    <logger name="DotNetOpenAuth">
      <level value="ALL" />
    </logger>
  </log4net> 
```

`bufferSize`当您解决问题时，您应该将back 设置为 100。

# sql - 处理多维数据集时出现 TFS 和 SQL Analysis Services 错误

> ID：12940163
> 
> 赞同：1
> 
> 时间：2012-10-17T17:41:48.067
> 
> 标签：sql, tfs, ssas

我目前对 TFS 有疑问。我们在同一台机器上运行 TFS 和 SSAS。几天前，TFS 报告工作正常，但报告突然中断，并且由于某种原因无法重新处理 TFS 分析多维数据集。查看处理状态时，出现以下错误：

> 上次运行结果消息：[Full Analysis Database Sync]：---> AnalysisDatabaseProcessingType=Full，needCubeSchemaUpdate=True。---> Microsoft.TeamFoundation.Server.WarehouseException：TF221122：为团队项目集合或 Team Foundation 服务器 TEAM FOUNDATION 运行作业完整分析数据库同步时发生错误。---> Microsoft.TeamFoundation.Server.WarehouseException：无法处理分析数据库“Tfs_Analysis”。---> Microsoft.TeamFoundation.Server.WarehouseException：内部错误：操作未成功终止。OLE DB 错误：OLE DB 或 ODBC 错误：建立与 SQL Server 的连接时发生网络相关或特定于实例的错误。服务器未找到或无法访问。检查实例名称是否正确以及 SQL Server 是否配置为允许远程连接。有关详细信息，请参阅 SQL Server 联机丛书。08001; 客户端无法建立连接；08001; 客户端不支持加密。08001。

我尝试重新处理多维数据集，重建 TFS_Analysis 和 TFS_Warehouse（从 TFS 管理控制台和命令行），并创建新数据库；这些似乎都不起作用。有谁知道这个问题的原因以及如何解决它？

TFS 在账户下运行，`domain1\tfsserver`而所有 sql 都在一个`domain2\tfsserver`账户下运行。我相信这可能是问题的一部分。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-18T10:42:53.903

您可以在此博客文章中找到非常相似问题的一种解决方法：[修复多维数据集处理 ODBC 错误](http://blogs.msdn.com/b/jsocha/archive/2011/05/27/fixing-cube-processing-odbc-errors.aspx)

有趣的部分：

> 解决方案
> 
> 这是我所做的：
> 
> 将 Analysis Services 的服务帐户从域帐户更改为本地系统。重新启动 SSAS 之后，一切都开始正常工作了。
> 
> 然后，我使用更新的密码将服务帐户设置回域帐户，并且一切都继续正常运行。我没有尝试并且可能工作得很好的方法是简单地重新启动 Analysis Services 服务。

# java - 我应该如何将时间/文件驱动的弹簧批处理过程转换为 jms 驱动的过程

> ID：12940164
> 
> 赞同：0
> 
> 时间：2012-10-17T17:41:48.087
> 
> 标签：java, transactions, jms, spring-batch

我有一个执行以下操作的 Spring-Batch 流程：

1.  步：
    1.  将 XML 抓取到临时表中（JibX 到 Hibernate）。
    2.  验证暂存数据的初始状态
    3.  犯罪
2.  步：
    1.  将登台表转换为登台（全部在 SQL 中）。
    2.  验证暂存数据的最终状态。
    3.  犯罪。
3.  步
    1.  将 staging 转换为仓库（全部在 SQL 中）。
    2.  证实
    3.  犯罪

因为我的数据是一大块，所以没有更多的数据出现并填满我的舞台表。这让我可以奢侈地改变步骤并在此过程中放弃交易。（也允许我分块步骤 1-1）

我对 JMS 版本的总体想法是接受 JMS 消息并使用它将数据放入暂存表中，然后触发 Job 执行我们现在所做的验证，然后转换为仓库。然后使用工作的成功/失败来推动我对项目发件人的响应。

不幸的是，Spring Batch 不（直接）支持作业级事务的想法，那么有没有比将所有小任务填充到事务性 ur-tasklet 中更好的接受方式呢？

# javascript - 用 JavaScript 可以做哪些 JQuery 做不到的事情？

> ID：12940172
> 
> 赞同：-4
> 
> 时间：2012-10-17T17:42:19.293
> 
> 标签：javascript, jquery

我正在学习 Web 开发，我有 1 年的 PHP 或编程经验，我应该从 JS 还是 JQuery 开始？有什么只能用 JavaScript 完成的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T17:43:33.410

jQuery 只是一个 JavaScript 库。所以，jQuery 就是 javascript——它不是另一种语言。JQuery 本身是用 javascript 编写的。如果不了解 javascript，就无法使用 jQuery。

您需要做的第一件事就是学习 javascript。然后，一旦您了解了该语言的基础知识，您就可以决定 jQuery 库提供的额外功能是否对您尝试解决的问题有用。所以，你不要选择其中一个。您从 javascript 和提供的所有功能开始，然后决定是否要添加 jQuery 库提供的功能。

就个人而言，如果我正在编写跨浏览器网页脚本，我绝对会使用流行的 javascript 库之一，例如 jQuery 或 YUI，因为它们都使网页脚本更容易，并且更容易以跨浏览器的方式做事（这些库他们自己为你处理了一堆浏览器的差异）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-17T17:43:56.210

jQuery 是一个 JavaScript 库；如果没有 JavaScript，你将无法在 jQuery 中做任何事情。因此，您可能应该开始学习 JavaScript 语法，因为它是学习 jQuery 的先决条件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-17T17:43:56.820

jQuery 是用 javascript 编写的。jQuery 只是一个库，而 javascript 本身就是一种语言。jQuery 所做的任何事情都在 javascript 中。

> jQuery 是一个快速而简洁的**JavaScript 库**，它简化了 HTML 文档遍历、事件处理、动画和 Ajax 交互，以实现快速的 Web 开发。jQuery 旨在改变您编写 JavaScript 的方式。~ 来自 jQuery 主页

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-17T17:44:04.320

jQuery 是 JavaScript。它不是另一种语言，而是一个使某些（跨浏览器）任务比使用 vanilla JavaScript 时更容易的库。

# c# - 将选定文件提升到 IIS7 站点

> ID：12940174
> 
> 赞同：3
> 
> 时间：2012-10-17T17:42:23.857
> 
> 标签：c#, asp.net, visual-studio, iis-7, tfs

假设我在部署到开发服务器 (IIS7) 的 TFS 团队解决方案中有 ac# Web 应用程序项目。我希望能够仅将某些代码更改推广到测试服务器，然后仅将这些更改推广到生产服务器。

因此，例如应该提升对 Web 用户控件和 javascript 文件的更改，但不应该提升对 Web 表单的更改。

在 Visual Studio 中使用部署功能似乎是一个孤注一掷的命题。

没有手动选择要复制/粘贴的文件，或者编写某种应用程序来比较目标和源目录中的文件，列出不同的文件，并让您选择要推广的源文件，团队在这种情况下通常会做什么？

简而言之：我怎样才能可靠地从一个环境到另一个环境提升选择的文件/代码，而不包括其他不应该提升的更改？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T17:48:33.240

在 TFS 中创建两个分支，一个用于开发，一个用于生产。合并 dev->production 只更改您需要的更改。从生产分支创建部署包。

# ios - iOS从自己的服务器优化图像下载速度

> ID：12940176
> 
> 赞同：0
> 
> 时间：2012-10-17T17:42:24.277
> 
> 标签：ios, performance, optimization, uiimage, nsurlconnection

我的应用程序中有一个画廊和详细视图控制器，当用户点击画廊中的缩略图时，我将它们重定向到详细控制器并开始异步下载原始大小的图像，即 640x640 像素，大约需要 5-6 秒去下载。有没有办法优化图片下载速度？

例如，Instagram 在大约 0.2-1.0 秒内完成此操作，速度非常快。我的想法是他们在服务器端使用了一些kickass压缩，然后取消归档他们在应用程序中获得的图像。有没有办法做这样的事情？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T14:07:00.910

解决了，我只好把图片格式从.png改成.jpeg，压缩率40%，质量还不错，图片大小从600kb改成45kb，提高了速度。

# objective-c - 检查用户输入后的 webview

> ID：12940177
> 
> 赞同：1
> 
> 时间：2012-10-17T17:42:25.243
> 
> 标签：objective-c, xcode4.4

我是一个 xcode 菜鸟，但这是我正在寻找的内容，然后是我所做的事情。我创建了一个登录名，并使用该登录名 usernameField 我正在尝试验证用户并仅打开一个特定于该人的网页。登录工作在这里是我的所有代码

```
//LoginViewController.h

    #import <UIKit/UIKit.h>
    @interface LoginViewController : UIViewController
    {
    IBOutlet UITextField *usernameField;
    IBOutlet UITextField *passwordField;
    IBOutlet UIButton *loginButton;   
    IBOutlet UIActivityIndicatorView *loginIndicator;
    }

    @property(nonatomic, strong) UITextField *usernameField;
    @property(nonatomic, strong) UITextField *passwordField;
    @property(nonatomic, strong) UIButton    *loginButton;
    @property(nonatomic, strong) UIActivityIndicatorView *loginIndicator;

    -(IBAction) login: (id) sender;
    @end

//LoginViewController.m

    #import "LoginViewController.h"
    @implementation LoginViewController
    @synthesize usernameField, passwordField, loginButton, loginIndicator;

    -(IBAction) login: (id) sender
    {
    if ([usernameField.text isEqualToString: @"userOne"] && [passwordField.text
    isEqualToString: @"passwordOne"])
    {
    printf("Success")
    //here is where I would like to pass usernameField.text to WebViews
    }
    else if (([usernameField.text isEqualToString: @"userTwo"] && [passwordField.text 
    isEqualToString: @"passwordTwo"])
    {
    printf("Success")
    //here is where I would like to pass usernameField.text to WebViews
    }
    else
    {
    printf("Login Failed")
    UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Login Failed"
                 message:@"Wrong username and password" delegate:self
                 cancelButtonTitle:@"Done"
                 otherButtonTitles:nil];
    [alert show];
    }
    loginIndicator.hidden=False;
    [loginIndicator startAnimating];
    }
    -(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
    {
    if([[segue identifier] isEqualToString:@"fromLogin"])
    {
        WebViews *wvc = [segue destinationViewController];
        wvc.usernamerField = self.usernameField.text;
    }
    }
    @end

//WebViews.h

    @interface WebViews : UIViewController
    {
    IBOutlet UIWebView *webView;
    NSString *usernameField;
    }
    @property (nonatomic, strong) NSString*usernameField;

    @end

//WebViews.m

 #import "WebViews.h"
    @interface WebViews ()//To be honest I'm not sure what this is for
    @end
    @implementation WebViews
    @synthesize usernameField;

    -(void)viewDidLoad
    {
    [super viewDidLoad];
    NSLog(@"username is = %@", self.usernameField);
    if([T.usernameField.text isEqualToString: @"userOne"])
    {
    [webView loadRequest: [NSURLRequest requestWithURL: [NSURL 
    URLWithString:@"http://www.google.com"]]];
    }
    else if([T.usernameField.text isEqualToString: @"userTwo"])
    {
    [webView loadRequest: [NSURLRequest requestWithURL: [NSURL URLWithString:@"http://www.yahoo.com"]]];
    }
    else
    {
    [webView loadRequest: [NSURLRequest requestWithURL: [NSURL URLWithString:@"http://www.wikipedia.com"]]];
    }

    @end 
```

任何帮助是极大的赞赏

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T22:45:55.357

你的问题是你从来没有分配任何东西，`T`所以它`nil`在你的方法中。

在 LoginViewController 的代码中，您需要将用户名传递给 WebViewController。您可以通过实现该`prepareForSegue`方法来做到这一点。

这是一个示例，取自[How to pass prepareForSegue: an object](https://stackoverflow.com/questions/7864371/ios5-how-to-pass-prepareforsegue-an-object)

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    // Make sure your segue name in storyboard is the same as this line
    if ([[segue identifier] isEqualToString:@"YOUR_SEGUE_NAME_HERE"])
    {
        // Get reference to the destination view controller
        WebViewController *wvc = [segue destinationViewController];

        // Pass any objects to the view controller here, like...
        wvc.username = self.usernameField.text;
    }
} 
```

# sql - Perl DBI：返回唯一的时间戳

> ID：12940179
> 
> 赞同：-2
> 
> 时间：2012-10-17T17:42:29.627
> 
> 标签：sql, perl, dbi

我需要一种方法让数据库返回一个唯一的时间戳（格式 YYYYMMDD.HH:MM:SS）或我可以解析的东西。我的程序有文件名进入并被重命名，我试图找到一种方法来确保我在文件上没有重复的时间戳并有覆盖文件的风险。数据库将仅跟踪 YYYYMMDD.HH:MM:SS 格式的时间记录。如果一个文件进来并且有一个与数据库匹配的时间，我需要数据库返回一个新的时间戳并更新数据库。

```
if( $fileName =~ m/^[a-z0-9]{3}[0-9]{5}\.[0-9]{5}\.([0-9]{8}\.[0-9]{2}:[0-9]{2}:[0-9]{2})\.(.)*/ )
{
    $dttmstmp = $1;
}
else
{
    $current_time = Date->getDateTime();
    $dttmstmp = $current_time;
}

    my $databaseHandle = getDbConnection();
    my $tstamp_present = getDbTime ( $databaseHandle , $dttmstmp );

    if ($tstamp_present == 1)
    {
            sleep(1);   # sleep to change timestamp
            $dttmstmp = Date->getDateTime(); # Get new timestamp
            updateTimestamp ( $databaseHandle , $dttmstmp ); # Update database with new timestamp
    }
    else
    {
            updateTimestamp ( $databaseHandle , $dttmstmp ); # Update database with new timestamp
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-17T19:09:54.797

使用数据库生成唯一值听起来不是一件好事。更好的方法是使用 UUID。CPAN 上有几个模块可用于此目的，例如[`Data::UUID`](http://search.cpan.org/perldoc?Data%3a%3aUUID).

# objective-c - iPad Kiosk 睡眠唤醒

> ID：12940193
> 
> 赞同：2
> 
> 时间：2012-10-17T17:43:47.127
> 
> 标签：objective-c, ios, ipad, sleep, kiosk

我有一个运行单个应用程序的 iPad 信息亭，我想通过在固定时间（工作时间以外）或空闲时让它休眠/锁定或进入低功耗状态（使屏幕变暗）来节省电量指定的时间段。如果它更简单，那么预定间隔的低功耗状态将足够好，因为它们通常在白天非常一致地使用。

那里有任何教程展示了如何在 Objective-C 中实现这一点，或者可能是一些片段让我开始？

售货亭物理上禁止使用任何按钮。我查看了 iOS 6 Guided Access，但我看不到用户如何在不访问按钮的情况下解锁/唤醒屏幕。另一个解决方案可能是 Kiosk Pro Plus - 但 40 美元一盒只是为了睡觉似乎不值得，如果可行，我想自己编程。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-20T18:03:53.953

MokiTouch 是 KioskPro 的免费替代品，并具有睡眠功能。您可以付费添加远程管理，但这是可选的。

MokiTouch.com 了解更多信息。

# c - Unix shell：如何检查用户输入以查看它是否是有效的 unix 命令？

> ID：12940198
> 
> 赞同：1
> 
> 时间：2012-10-17T17:44:00.220
> 
> 标签：c, shell, unix

我有一个任务，我需要使用 fork() 创建一个 unix shell。我已经让这个工作正常了。现在我需要检查用户输入以查看它是否是有效的 unix 命令。如果它无效（即它的“1035813”），我需要告诉用户输入一个有效的命令。

有没有一种方法可以获得每个可能的 unix 命令的列表，以便我可以将用户输入与该列表中的每个字符串进行比较？或者有没有更简单的方法来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-17T17:49:14.130

执行此操作的适当方法是：

1.  检查它是否是 shell 中的内置命令。例如，`cd`应该可能是一个内置命令。
2.  `fork`并尝试`exec`它。（`execvp`实际上可能是您真正想要的）。如果失败，请检查`errno`以确定原因。

例子：

```
#include <stdlib.h>
#include <stdio.h>
#include <unistd.h>
#include <sys/types.h>

int main(int argc, char* argv[])
{
  if (argc != 2) {
    printf("usage: %s <program-to-run>\n", argv[0]);
    return -1;
  }

  char* program      = argv[1];
  /* in this case we aren't passing any arguments to the program */
  char* const args[] = { program, NULL };

  printf("trying to run %s...\n", program);

  pid_t pid = fork();

  if (pid == -1) {
    perror("failed to fork");
    return -1;
  }

  if (pid == 0) {
    /* child */
    if (execvp(program, args) == -1) {
      /* here errno is set.  You can retrieve a message with either
       * perror() or strerror()
       */
      perror(program);
      return -1;
    }
  } else {
    /* parent */
    int status;
    waitpid(pid, &status, 0);
    printf("%s exited with status %d\n", program, WEXITSTATUS(status));
  }

} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-17T17:47:49.497

您可以检查`which`. 如果它没有开始，`which: no <1035813> in blah/blah`那么它可能不是该系统上的命令。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T17:46:20.073

试试看。

```
if which $COMMAND
    then echo "Valid Unix Command"
else
    echo "Non valid Unix Command"
fi 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-17T18:22:01.070

如果您想知道它是否是内置命令，您可以滥用帮助：

```
if help $COMMAND >/dev/null || which $COMMAND >/dev/null
   then echo "Valid Unix Command"
else
   echo "Not a valid command"
fi 
```

# java - Selenium Webdriver/Java- 等待函数和错误处理

> ID：12940202
> 
> 赞同：2
> 
> 时间：2012-10-17T17:44:04.527
> 
> 标签：java, selenium-webdriver, automated-tests, wait

我正在使用 Selenium WebDriver 和 Java 编写自动化测试，这些测试需要在其中进行大量等待，以确保在采取下一个操作之前已经加载了适当的元素。

我试过这个：

```
driver.manage().timeouts().implicitlyWait(20, TimeUnit.SECONDS); 
```

它将等待指定的时间间隔，然后如果找不到元素则失败，

和这个：

```
WebDriverWait wait = new WebDriverWait(driver, 100);
wait.until(new ExpectedCondition<Boolean>() {
  public Boolean apply(WebDriver webDriver) {
    System.out.println("Searching for the Companies dropdown");
    return webDriver.findElement(By.id("ctl00_PageContent_vpccompanies_Input")) != null;
  }
}); 
```

如果找不到元素，它将无限期挂起，

我想要的是可以搜索该元素几次尝试然后失败并显示错误消息的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T17:48:19.107

将您的代码包装到一个循环中并循环，直到找到条件匹配或退出循环的额外条件。用于`isElementPresent(element)`检查查找条件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T17:47:52.570

我会说，放入`your element access code` 一个 while 循环，它会在`success`或上中断`number of attempts`。

例如**（伪代码）**

```
 int numAttemps = 0;
    int specifiedAttempts = 5;
    boolean success = false;
    do{
       numAttemps++;
       try{
         //access the element
          WebElement element = driver.findElement(By.id(..));
          success  = true; //<--If it reaches here means success
       }catch(NoSuchElementException nse)
           //one attempt failed
       }
     }while(!success || numAttemps <specifiedAttempts);

     if(!success){
        System.out.println("Couldn't load after " +specifiedAttempts+ " attempts");
     } 
```

# firefox - Firefox“滑动”悬停过渡

> ID：12940206
> 
> 赞同：5
> 
> 时间：2012-10-17T17:44:19.683
> 
> 标签：firefox, css, hover, transition

首先，对于大多数人来说，我想对社区说“你好”。我是一名刚从职业学校毕业的入门级初级网页设计师。我在 CSS 中的大部分样式都是我自学的，所以这给我带来了一些问题。比如下面这张。

这是我用于我的网站的导航栏示例。每个 div 框都应该在 2 秒内滑出到相应的位置。然而，除了 chrome 之外的所有浏览器，它们都会快速弹出，而不是平滑过渡。

[http://jsfiddle.net/kwh71787/cxBxL/](http://jsfiddle.net/kwh71787/cxBxL/)

如果有人有任何见解，请帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T18:11:23.893

尝试改用这种风格：

```
#navbuttons div {
    position: absolute;
    left: 0px;
} 
```

[演示](http://jsfiddle.net/SO_AMK/hHWZw/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-17T18:08:11.553

欢迎来到堆栈溢出！

这似乎可以解决它。我所做的是我已经添加`top: 0px; and left: 0px;`到每个 div 中。

这是一个更新的[jsfiddle](http://jsfiddle.net/cxBxL/4/)

希望有帮助！

# jquery - 使用 jquery 切换和过滤类别

> ID：12940209
> 
> 赞同：0
> 
> 时间：2012-10-17T17:44:27.740
> 
> 标签：jquery, filter, toggle

所以我试图过滤不同的类别，但我不知道如何在第二次点击时显示类别。.not(design) 不允许我在过滤后带回设计（在第二次点击时）。我不想使用按钮来显示所有内容，我只想能够像单选按钮一样打开和关闭按钮。

我希望这是有道理的，这对我来说有点难以用语言表达。

.web-buttons li 及以上部分功能运行良好

JS FIDDLE 的链接[http://jsfiddle.net/mWran/1/](http://jsfiddle.net/mWran/1/)

$('.design-button').click(function () {

```
 $('.web-buttons li').not(this).removeClass('up')  
 $(this).toggleClass("up")
 $('#webul li').removeClass('clicked')   
 $('#webul li').not('.design').toggleClass('clicked') 
```

});

$('.branding-button').click(function () {

```
 $('.web-buttons li').not(this).removeClass('up') 
 $(this).toggleClass("up")  
 $('#webul li').removeClass('clicked')   
 $('#webul li').not('.branding').toggleClass('clicked') 
```

});

```
 <div id="web-design-content">
        <ul id="webul">

            <li class="view view-first coding design branding drupal">
            <img src="images/epic-electro.jpg" width="297" height="203" />
            <div class="mask"> 
                     <h2 class="bebas">Epic Electro Music Blog</h2> 
                     <p>Introducing Epic Electro: an electronic music blog showcasing electronic dance music from around the world</p> 

                     <a class="fancybox fancybox.iframe info ostrich" href="epicelectro.html">Read More</a>
                 </div>     
            </li>

            <li class="view view-first coding branding">
            <img src="images/soul-of-athens.jpg" width="297" height="203" />
            <div class="mask"> 
                     <h2 class="bebas">2012 Soul Of Athens</h2> 
                     <p>Ohio University multimedia sequence class of 2012 presents Swing State: Ohio's role in the outcome of the presidential election</p> 
                     <a class="fancybox fancybox.iframe info ostrich" href="soa.html">Read More</a>
                 </div>     
            </li>

        </ul>

  </div><!-- Endb Web Design content --> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T18:33:00.850

CSS 类不匹配。

你有一个

```
.not('.design') 
```

在您的 JS 代码中，但 HTML 属性中的类名是

```
<li class="design-button even"> 
```

只需将`.not()`-calls 更改为

```
.not('.design-button') 
```

你也可以使用

```
$('#webul li:not(.design-button)').toggleClass('clicked'); 
```

作为选择器。

# c++ - 包含位域 C++ 的数组 + 联合 + 结构

> ID：12940211
> 
> 赞同：3
> 
> 时间：2012-10-17T17:44:33.893
> 
> 标签：c++, arduino, avr-gcc

我只是在玩比特场，遇到了一些我无法弄清楚如何解决的问题。

（关于平台的注意事项：int 的大小 = 2bytes，long = 4bytes，long long = 8bytes - 值得一提，因为我知道它可能会有所不同。“byte”类型也被定义为“unsigned char”）

我希望能够创建一个包含两个 36 位变量的数组，并将它们放入一个具有 9 个字节数组的联合中。这就是我想出的：

```
typedef union {
  byte bytes[9];
  struct {
    unsigned long long data:36;
  } integers[2];
} Colour; 
```

我正在研究编译器会意识到应该有两个位域作为匿名结构的一部分并将它们放在一起进入 9 个字节的空间的理论。然而事实证明，它们在字节边界处对齐，因此联合占用 10 个字节而不是 9 个字节，这非常有意义。

**那么问题来了，有没有办法像这样创建一个由两个位字段组成的数组？**我考虑了“打包”属性，但编译器只是忽略了它。

虽然这按预期工作（sizeof() 返回 9）：

```
typedef union {
  byte bytes[9];
  struct {
    unsigned long long data0:36;
    unsigned long long data1:36;
  } integers;
} Colour; 
```

最好将其作为数组访问。

* * *

编辑：感谢 cdhowie 解释了为什么这不起作用。

幸运的是，我想到了一种方法来实现我想要的：

```
typedef union {
  byte bytes[9];
  struct {
    unsigned long long data0:36;
    unsigned long long data1:36;
    unsigned long long data(byte which){
      return (which?data1:data0);
    }
    void data(byte which, unsigned long long _data){
      if(which){
        data1 = _data;
      } else {
        data0 = _data;
      }
    }
  } integers; 

} Colour; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-17T17:49:02.543

如果您希望每个位域正好是 36 位宽，则不能使用数组直接执行此操作。

指针必须与字节边界对齐，这就是指针的方式。由于在大多数情况下（除了例外）数组的功能类似于指针，因此对于包含不能被 8 整除的多个位的位域，这是不可能的。（`&(((Colour *) 0)->integers[1])`如果位域被打包，您期望返回什么？什么值才有意义？ ?)

在您的第二个示例中，位域可以紧密排列，因为引擎盖下没有指针数学运算。对于可以通过指针寻址的事物，它们必须落在字节边界上，因为字节是用于“测量”指针的单位。

您会注意到，如果您尝试在第二个示例中获取`(((Colour *) 0)->integers.data0)`or的地址`data1`，编译器将发出错误，正是这个原因。

# mysql - 优化Mysql：获取最新的销售状态

> ID：12940216
> 
> 赞同：0
> 
> 时间：2012-10-17T17:45:04.303
> 
> 标签：mysql, optimization, subquery, exists

在以下查询中，我显示了销售的最新状态（按阶段，在本例中为数字 3）。该查询基于销售状态历史记录中的子查询：

```
SELECT v.id_sale, 
IFNULL((
    SELECT (CASE WHEN IFNULL( vec.description, '' ) = ''
                    THEN ve.name
                    ELSE vec.description
                    END)
    FROM t_record veh
    INNER JOIN t_state_campaign vec ON vec.id_state_campaign = veh.id_state_campaign
    INNER JOIN t_state ve ON ve.id_state = vec.id_state
    WHERE veh.id_sale = v.id_sale
    AND vec.id_stage = 3
    ORDER BY veh.id_record DESC
    LIMIT 1
), 'x') sale_state_3
FROM t_sale v
INNER JOIN t_quarters sd ON v.id_quarters = sd.id_quarters
WHERE 1 =1
AND v.flag =1
AND v.id_quarters =4
AND EXISTS (
    SELECT '1'
    FROM t_record
    WHERE id_sale = v.id_sale
    LIMIT 1
) 
```

查询延迟**0.0057seg**并显示**1011 条记录**。

因为我必须按州的名称过滤销售，因为它必须在 where 子句中重复子查询，所以我决定使用连接来更改相同的查询。在这种情况下，我使用 MAX 函数来获取最新状态：

```
SELECT
v.id_sale,
IFNULL(veh3.State3,'x') AS sale_state_3
FROM t_sale v
INNER JOIN t_quarters sd ON v.id_quarters = sd.id_quarters
LEFT JOIN (
    SELECT veh.id_sale, 
    (CASE WHEN IFNULL(vec.description,'') = '' 
        THEN ve.name
        ELSE vec.description END) AS State3
    FROM t_record veh
    INNER JOIN (
        SELECT id_sale, MAX(id_record) AS max_rating
                FROM(
                    SELECT veh.id_sale, id_record
                    FROM t_record veh
                    INNER JOIN t_state_campaign vec ON vec.id_state_campaign = veh.id_state_campaign AND vec.id_stage = 3
                ) m
            GROUP BY id_sale    
    ) x ON x.max_rating = veh.id_record
    INNER JOIN t_state_campaign vec ON vec.id_state_campaign = veh.id_state_campaign
    INNER JOIN t_state ve ON ve.id_state = vec.id_state
) veh3 ON veh3.id_sale = v.id_sale
WHERE v.flag = 1
AND v.id_quarters = 4 
```

此查询显示相同的结果 (1011)。但问题是它需要**0.0753 秒**

回顾一下可能性，我发现了导致查询速度不同的因素：

```
AND EXISTS (
    SELECT '1'
    FROM t_record
    WHERE id_sale = v.id_sale
    LIMIT 1
) 
```

如果我删除此子句，则两个查询的时间延迟相同...为什么效果更好？有没有办法在连接中使用这个子句？我希望你的帮助。

**编辑**

我将分别显示每个查询的 EXPLAIN 结果：

**q1：** ![在此处输入图像描述](../Images/8a18f56c138e4ef3bb39db4456969b03.png)

**q2：** ![在此处输入图像描述](../Images/0d179c610922a112e99bd931f7b65b93.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T18:59:09.583

有趣的是，这个小语句基本上确定了 t_record.id_sale 和 t_sale.id_sale 之间是否匹配。

为什么这会使您的查询运行得更快？因为 where 语句在 select 语句中的 subSelects 之前应用，所以如果没有记录要与 sale 一起去，那么它不会打扰处理 subSelect。这让你有一些时间。所以这就是它工作得更好的原因。

它会在您的联接语法中起作用吗？如果没有要测试的表格，我真的不知道，但是您始终可以将其应用到最后并找出答案。将关键字 EXPLAIN 添加到查询的开头，您将获得一个执行计划，这将帮助您优化事物。在连接语法中获得更好结果的最佳方法可能是向表中添加一些索引。

但我问你，这还有必要吗？您有一个查询在 <8% 秒内返回。除非这个查询每小时运行数千次，否则这根本不会对您的数据库造成负担，您的时间可能最好花在改进应用程序的其他地方。

# c++ - 构建类时提升 asio 错误

> ID：12940220
> 
> 赞同：3
> 
> 时间：2012-10-17T17:45:25.147
> 
> 标签：c++, boost, boost-asio

我试图通过使用 Boost:asio 库进行一些网络编程来感受我的方式。我一直在使用异步处理程序从给定地址传输数据，当我利用 asio 作为函数时它工作正常：

```
boost::asio::io_service io_service;
boost::asio::ip::tcp::resolver resolver( io_service);
boost::asio::ip::tcp::socket sock( io_service);
boost::array < char, 4096 > buffer;

void read_handler( const boost:: system:: error_code &ec,
        std:: size_t bytes_transferred)
{
    if (! ec)
        {
            if (std::string(buffer.data(), bytes_transferred) == "$")
            {
                    myss.str(std::string());
            }
            myss << std::string(buffer.data(), bytes_transferred);
            if (int(buffer.data()[0]) == 10)
                {
                    ....

                }
            std::cout << std::string(buffer.data(), bytes_transferred) ;//<< std::endl;
            sock.async_read_some( boost::asio::buffer( buffer), read_handler);
        }
}

void connect_handler( const boost::system::error_code &ec)
{
    if (! ec)
        {
            boost::asio::write( sock, boost::asio::buffer(
                    "GET / HTTP 1.1\r\nHost: www.google.com\r\n\r\n"));
            sock.async_read_some( boost::asio::buffer( buffer), read_handler);
        }
}

void resolve_handler( const boost::system::error_code &ec,
        boost:: asio::ip::tcp::resolver::iterator it)
{
    if (! ec)
        {
            sock.async_connect(* it, connect_handler);
        }
} 
```

现在，我试图将这些函数集成到一个类中，但 Visual Studio 一直抱怨我在类中实现这些函数的方式。

```
void
MyClass::connect_handler( const boost::system::error_code &ec)
{
    if (! ec)
        {
            //boost::asio::write( sock, boost::asio::buffer(
            //        "GET / HTTP 1.1\r\nHost: www.highscore.de\r\n\r\n"));
            m_sock.async_read_some( boost::asio::buffer( m_buffer), read_handler);
        }
}

    : error C3867: 'MyClass::read_handler': function call missing argument list; use '&MyClass::read_handler' to create a pointer to member: 
    error C3867: 'MyClass::read_handler': function call missing argument list; use '&MyClass::read_handler' to create a pointer to member
    2>'MyClass::connect_handler': function call missing argument list; use 

'&MyClass::connect_handler' to create a pointer to member
2>
2>Build FAILED. 
```

任何人都对我在将这些移入类中做错了什么有任何指示？

我已经尝试在错误消息中实施建议的更改，但它会导致 boost 库本身出现错误。

```
2>C:\installs\Boost\include\boost-1_49\boost/asio/basic_stream_socket.hpp(785): error C2338: ReadHandler type requirements not met
2>          : see reference to function template instantiation 'void boost::asio::basic_stream_socket<Protocol>::async_read_some<boost::asio::mutable_buffers_1,void(__thiscall MyClass::Sensor::* )(const boost::system::error_code &,size_t)>(const MutableBufferSequence &,const ReadHandler &)' being compiled
2>          with
2>          [
2>              Protocol=boost::asio::ip::tcp,
2>              MutableBufferSequence=boost::asio::mutable_buffers_1,
2>              ReadHandler=void (__thiscall MyClass::Sensor::* )(const boost::system::error_code &,size_t)
2>          ]
2>C:\installs\Boost\include\boost-1_49\boost/asio/basic_stream_socket.hpp(785): error C2064: term does not evaluate to a function taking 2 arguments
2>C:\installs\Boost\include\boost-1_49\boost/asio/basic_socket.hpp(706): error C2338: ConnectHandler type requirements not met
2>           : see reference to function template instantiation 'void boost::asio::basic_socket<Protocol,SocketService>::async_connect<void(__thiscall MyClass::Sensor::* )(const boost::system::error_code &)>(const boost::asio::ip::basic_endpoint<InternetProtocol> &,const ConnectHandler &)' being compiled
2>          with
2>          [
2>              Protocol=boost::asio::ip::tcp,
2>              SocketService=boost::asio::stream_socket_service<boost::asio::ip::tcp>,
2>              InternetProtocol=boost::asio::ip::tcp,
2>              ConnectHandler=void (__thiscall MyClass::Sensor::* )(const boost::system::error_code &)
2>          ]
2>C:\installs\Boost\include\boost-1_49\boost/asio/basic_socket.hpp(706): error C2064: term does not evaluate to a function taking 1 arguments
2> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-17T21:26:06.687

> m_sock.async_read_some(boost::asio::buffer(m_buffer), read_handler);

假设`read_handler`是一个接受 2 个参数的成员函数，它应该是：`m_sock.async_read_some(boost::asio::buffer( m_buffer), boost::bind(&MyClass::read_handler, this, _1, _2));`

如果你想使用`shared_from_this`成语（即你的类继承自`enable_shared_from_this`），那么使用`shared_from_this()`代替`this`in`bind`表达式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T17:49:08.857

您不能仅通过命名成员来创建指向成员的指针，您需要使用类限定显式请求它：

```
&MyClass::connect_handler 
```

（正如错误消息非常清楚地指出......）

# sql - 在 sqlite / JOIN 中使用 OR 术语进行有效的变体记录选择

> ID：12940221
> 
> 赞同：2
> 
> 时间：2012-10-17T17:45:29.003
> 
> 标签：sql, join, sqlite

我有一个使用 sqlite3 的数据记录应用程序来存储共享一个公共标头的不同类型的记录。

我将标题放在一个表中，并为每个变体的详细信息创建了单独的表。

明细表中的rowid就是表头的rowid。标题 rowid 仅显示在其中一个详细信息表中（对于该变体）。

我想在单个查询中获取多种类型的记录。**也就是说，我希望 Sqlite 对 headers 表进行索引搜索以找到一组工作记录，然后使用该组 id 通过 rowid 快速二进制获取变体详细信息。**所以：

```
SELECT * FROM headers JOIN headers 
ON headers.id = variant1.id OR headers.id = variant2.id
WHERE some_header_condition 
```

或者

```
SELECT * FROM headers JOIN headers
ON headers.id IN (variant1.id, revariant2.id )
WHERE some_header_condition 
```

这可行，但是当遇到 JOIN 谓词中的 OR 项时，sqlite3 会对详细信息表 variant1 和 variant2 进行全表扫描，而不是仅通过 rowid 外键获取适当的记录。

就像是：

```
0     0              2     SCAN TABLE variant2 (~5900 rows)
0     1              1     SCAN TABLE variant1 (~26588 rows)
0     2              0     SEARCH TABLE headers USING INTEGER PRIMARY KEY (rowid=?) (~2 rows)
0     0              0     EXECUTE LIST SUBQUERY 1 
```

我可以通过以下技巧强制二进制搜索：

```
SELECT header.f1, variant1.f, NULL FROM header JOIN header.id = variant1.id ...
UNION ALL
SELECT header.f1, NULL, variant2.f FROM header JOIN header.id = variant2.id ... 
```

但随后头表被访问了两次。

我还可以想象将 header.id(s) 选择到一个临时表并使用它来使用其中的 id 获取详细信息。

或者......我可以将整个混乱状态反规范化。

但是所有这些变通方法都非常不方便。所以我的问题是，是否有一个不错的 JOIN 查询可以一次性获取这些变体而无需表扫描？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T18:04:00.513

尝试使用外连接：

```
SELECT *
FROM headers
  LEFT JOIN variant1 ON headers.id = variant1.id
  LEFT JOIN variant2 ON headers.id = variant2.id
WHERE headers... 
```

导致这样的计划：

```
sele  order  from  deta
----  -----  ----  ----
0     0      0     SEARCH TABLE headers USING INTEGER PRIMARY KEY (rowid>? AND rowid<?) (~31250 rows)
0     1      1     SEARCH TABLE variant1 USING INTEGER PRIMARY KEY (rowid=?) (~1 rows)
0     2      2     SEARCH TABLE variant2 USING INTEGER PRIMARY KEY (rowid=?) (~1 rows) 
```

# python - 从 URL 下载过去 30 分钟内修改的文件

> ID：12940223
> 
> 赞同：0
> 
> 时间：2012-10-17T17:45:32.850
> 
> 标签：python, bash, shell

我正在尝试仅从 URL 下载过去 30 分钟内修改过的文件。您能否指导我如何进行此操作。请让我知道我是否应该为此使用 shell 脚本或 python 脚本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T17:52:20.310

如果服务器支持 if-modified-since，您可以使用 If-Modified-Since: (T-30 分钟) 发送请求并忽略 304 响应。

# javascript - Jqgrid自定义edittype custom_element事件未触发

> ID：12940228
> 
> 赞同：2
> 
> 时间：2012-10-17T17:46:03.650
> 
> 标签：javascript, jquery, jqgrid

```
<script src="jquery-1.8.0.min.js" type="text/javascript"></script>
    <script src="grid.locale-en.js" type="text/javascript"></script>
    <script src="jquery.jqGrid.min.js" type="text/javascript"></script>
   <script type="text/javascript">    
    function myelem(value, options) {
            alert('1'); 
            var el = document.createElement("input");
            el.type = "radio";
            if (value == "0")
                el.checked = false;
            else
                e1.checked = true;
            return el;
        }

        function myvalue(elem, operation, value) {
            if(operation === 'get') {
               return $(elem).find("input").val();
            } else if(operation === 'set') {
               $('input',elem).val(value);
            }
       }

       function FailGrdTranHistory() {
           alert('Function Execution Failed...');
       }
       function successSubGridFunction(jsondata) {
           HideCommentHeader();
           var thegrid = jQuery("#" + SubGridTableName)[0];
           var jdata = jsondata.d; //.split("~");
           thegrid.addJSONData(JSON.parse(jdata));
           unblockPage();
       }

        jQuery(document).ready(function () {
            jQuery("#jqGrid1").jqGrid({
                datatype: "local",
                height: 250,
                colNames: ['Inv No', 'From','Date', 'Client', 'Amount', 'Tax', 'Total', 'Notes'],
                colModel: [
                    { name: 'id', index: 'id', width: 60, sorttype: "int" },
                    {name: 'from',width:60,editable: true,edittype: 'custom',editoptions: {custom_element: myelem, custom_value:myvalue}},
                    { name: 'invdate', index: 'invdate', width: 90, sorttype: "date" },
                    { name: 'name', index: 'name', width: 100 },
                    { name: 'amount', index: 'amount', width: 80, align: "right", sorttype: "float" },
                    { name: 'tax', index: 'tax', width: 80, align: "right", sorttype: "float" },
                    { name: 'total', index: 'total', width: 80, align: "right", sorttype: "float" },
                    { name: 'note', index: 'note', width: 150, sortable: false }
                ],
                pager: '#pager',
                rowNum: 10,
                rowList: [10, 20, 30],
                sortname: 'id',
                sortorder: 'desc',
                viewrecords: true,
                imgpath: "lib/basic/images",
                caption: "Manipulating Array Data"
            });

        var mydata = [
            { id: "1",from: "0" , invdate: "2007-10-01", name: "test", note: "note", amount: "200.00", tax: "10.00", total: "210.00" },
            { id: "2",from: "1", invdate: "2007-10-02", name: "test2", note: "note2", amount: "300.00", tax: "20.00", total: "320.00" },
            { id: "3",from: "0", invdate: "2007-09-01", name: "test3", note: "note3", amount: "400.00", tax: "30.00", total: "430.00" },
            { id: "4",from: "1", invdate: "2007-10-04", name: "test", note: "note", amount: "200.00", tax: "10.00", total: "210.00" },
            { id: "5",from: "1", invdate: "2007-10-05", name: "test2", note: "note2", amount: "300.00", tax: "20.00", total: "320.00" },
            { id: "6",from: "1", invdate: "2007-09-06", name: "test3", note: "note3", amount: "400.00", tax: "30.00", total: "430.00" },
            { id: "7",from: "1", invdate: "2007-10-04", name: "test", note: "note", amount: "200.00", tax: "10.00", total: "210.00" },
            { id: "8",from: "1", invdate: "2007-10-03", name: "test2", note: "note2", amount: "300.00", tax: "20.00", total: "320.00" },
            { id: "9",from: "0", invdate: "2007-09-01", name: "test3", note: "note3", amount: "400.00", tax: "30.00", total: "430.00" }
        ];
        for (var i = 0; i <= mydata.length; i++) {
                jQuery("#jqGrid1").jqGrid('addRowData', i + 1, mydata[i]);
            }
        });
     </script> 
```

我正在尝试做的是在 jqgrid 中名为“来自”的列中显示一个单选按钮。

'from' 列具有 edittype = 'custom' 但仍显示文本而不是预期的单选按钮。

我也知道绑定到 custom_element 属性的 myelem 函数没有触发，因为当我运行包含 jqgrid 的页面时，我没有看到弹出警报。

我使用的脚本文件位于此网址[https://docs.google.com/folder/d/0BxqMgWIbBHEFVnJDUmtUYUxKeWc/edit](https://docs.google.com/folder/d/0BxqMgWIbBHEFVnJDUmtUYUxKeWc/edit)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T17:58:21.490

只是为了让这个问题看起来没有答案，我正在添加我的解决方案。对于专栏，我使用了以下代码：

```
{
    name: 'Test',
    index: 'Test',
    width: '63px',
    sortable: false,
    edittype: 'custom',
    formatter: function (cellvalue, options, rowObject) {
        return '<input type="radio" name="selectedCall" value="' + cellvalue + '"' + '/>'
    }
} 
```

# javascript - Flowplayer (3.1.4) 不适用于便携式 Firefox (1.7.3.0)

> ID：12940232
> 
> 赞同：0
> 
> 时间：2012-10-17T17:46:35.300
> 
> 标签：javascript, html, firefox, flowplayer, portable-applications

[我的问题与this](https://stackoverflow.com/questions/1873215/flowplayer-not-working-on-firefox)和[this](http://support.mozilla.org/en-US/questions/775766)非常相似

不同的是我试图让它在[便携式火狐上工作](http://portableapps.com/apps/internet/firefox_portable)

以下是相关的 js/html 代码：

```
<table id="videoBox" border="0" width="541px" height="350px" cellspacing="10" cellpadding="0" >
  <tr>
    <td width="521px" valign="middle" align="center">
      <div id="video" style="width:521px; height:324px;"></div>   
      <script language="JavaScript">
      var bgImg = 'url(../theme/img/video-overlay-en.jpg)';  

      flowplayer('video', '../theme/flowplayer-3.1.4.swf', {

        onLoad: function() {
          this.setVolume(100);    // set volume to 100% 
        },

        onBeforeFullscreen: function() { return false; },
        buffering: false,
        debug: false,

        canvas: {
          backgroundColor: "transparent",
          backgroundGradient: 'none'
        },

        plugins: {
          content: {
            url: '../theme/flowplayer.content-3.1.0.swf',
            backgroundImage: bgImg,
            height: 95,
            width: 521,
            padding: 0,
            bottom: 0,
            opacity: 1.0
          },
          controls: null
          },
          clip: {
            url: '../media/44/01.flv',
            autoPlay: true,
            autoBuffering: true,
          },
          play: {
          opacity: 0,
          label: null, 
          replayLabel: null
        }
      });
      </script>
    </td>
  </tr>
</table> 
```

问题是，即使一开始似乎有“缓冲符​​号”，视频也无法播放。我显然已经尝试过适用于上述链接的解决方案（即修改 div 标签中的代码），但这对我不起作用。任何帮助将不胜感激。

PS 如您所见，这是一个旧版本的 flowplayer，但这不应该有任何区别恕我直言

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T02:31:17.680

这对我有用：

当您尝试从本地硬盘驱动器查看 Flash 视频（在我的情况下为 .flv）时，flowplayer 需要一些安全设置，这基本上是为了允许包含 Flash 内容的目录中的内容。这是解释详细信息的链接：

[FlowPlayer基础知识](http://flash.flowplayer.org/documentation/installation/index.html)

向下滚动到页面底部，然后单击提供的链接以编辑您的 Flash 播放器安全设置。

# vb.net - Visual Basic Rnd 每次返回 5

> ID：12940233
> 
> 赞同：1
> 
> 时间：2012-10-17T17:46:42.543
> 
> 标签：vb.net, random

***已解决*** 这个随机函数的目标是返回一个值，该值将用于将对应的行与该数字大写，我的问题是它每次都返回 5，所以一定有问题。谁能解释我在这个随机化功能上做错了什么？

编辑：我现在收到错误“随机化是一种类型，不能用作表达式”。

这里的代码：randomize 是一种类型，不能用作表达式。

```
 Module randomize
   Sub Main()

     Dim line As String = ""
     Dim linenum As Integer = 1
         Randomize()
     Dim random as Integer 
         random = CInt(Int((7 * Rnd()) + 1))

             'If linenum=random the line is capitalized. 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-17T17:48:28.153

根据[MSDN 文档](http://msdn.microsoft.com/en-us/library/f7s023d2%28v=vs.71%29.aspx)，`Rnd`您需要先调用`Randomize`以创建新种子。

另外，我不确定在你需要调用的函数之后命名你的模块是否是个好主意。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T17:50:29.157

尝试这个：-

```
 Dim x As Integer
 Randomize()
 x = CInt(Int((7 * Rnd()) + 1)) 
```

# jar - Hadoop HADOOP_CLASSPATH 问题

> ID：12940239
> 
> 赞同：8
> 
> 时间：2012-10-17T17:46:54.663
> 
> 标签：jar, hadoop, classpath

这个问题并不是指在整个集群中分发 jar 以供工作人员使用。

它指的是在客户端机器上指定一些附加库。更具体地说：我正在尝试运行以下命令以检索 SequenceFile 的内容：

```
 /path/to/hadoop/script fs -text /path/in/HDFS/to/my/file 
```

它向我抛出了这个错误：`text: java.io.IOException: WritableName can't load class: util.io.DoubleArrayWritable`

我有一个名为 DoubleArrayWritable 的可写类。事实上，在另一台计算机上一切正常。

我尝试将 设置`HADOOP_CLASSPATH`为包含包含该类但没有结果的 jar。实际上，运行时：

```
 /path/to/hadoop/script classpath 
```

结果不包含我添加到 HADOOP_CLASSPATH 的 jar。

问题是：在运行 hadoop 时如何指定额外的库（额外的意思是除了 hadoop 脚本在类路径中自动包含的库之外的其他库）

更多信息可能会有所帮助：

*   我不能修改 hadoop.sh 脚本（也不能修改任何相关的脚本）
*   无法将我的库复制到hadoop安装目录下的/lib目录下
*   在从 hadoop.sh 运行的 hadoop-env.sh 中有这一行：`export HADOOP_CLASSPATH=$HADOOP_HOME/lib`这可能解释了为什么我的 HADOOP_CLASSPATH env var 被忽略了。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-17T21:20:00.250

如果你被允许设置`HADOOP_CLASSPATH`那么

```
export HADOOP_CLASSPATH=/path/to/jar/myjar.jar:$HADOOP_CLASSPATH; \
    hadoop fs -text /path/in/HDFS/to/my/file 
```

将完成这项工作。由于在您的情况下，此变量被*覆盖*，`hadoop-env.sh`因此请考虑使用该`-libjars`选项：

```
hadoop fs -libjars /path/to/jar/myjar.jar -text /path/in/HDFS/to/my/file 
```

`FsShell`或者手动调用：

```
java -cp $HADOOP_HOME/lib/*:/path/to/jar/myjar.jar:$CLASSPATH \
org.apache.hadoop.fs.FsShell -conf $HADOOP_HOME/conf/core-site.xml \
-text /path/in/HDFS/to/my/file 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2019-03-08T11:23:35.097

如果有人想检查 hadoop 类路径，请`hadoop classpath`在终端中输入。
要编译它，请使用：`javac -cp $(hadoop classpath):path/to/jars/* java_file.java`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-18T05:51:17.470

尝试将您的 jar 文件添加到默认的 CLASSPATH 变量中，并将 HADOOP_CLASSPATH 附加到它。然后执行你的命令。

`export CLASSPATH=/your/jar/file/myjar.jar:$CLASSPATH:$HADOOP_CLASSPATH /path/to/hadoop/script fs -text /path/in/HDFS/to/my/file`

# objective-c - 为嵌套属性添加观察者

> ID：12940241
> 
> 赞同：2
> 
> 时间：2012-10-17T17:47:08.283
> 
> 标签：objective-c, observers

当使用类似...

```
[_queueController addObserver:self forKeyPath:@"currentPlayer.currentTrack" options:0 context:nil]; 
```

...，那么`currentTrack`只要 currentPlayer 没有变化，就只会观察到的变化。

我解决这个问题的第一个想法是`currentPlayer`在每次更改时观察并重新添加观察者。但是对于这个问题有更好的解决方案吗？

# git - 我应该使用 .gitignore，还是在暂存时自动检测不同服务器的配置？

> ID：12940243
> 
> 赞同：6
> 
> 时间：2012-10-17T17:47:12.057
> 
> 标签：git, cakephp, configuration

我在一家公司工作，我们目前没有任何暂存工作流程，而且事情越来越紧张。我正在尝试建立一个适当的工作流程，并阅读了一些针对不同方法的优秀教程和资源。我将使用的工作流程是开发人员提交并将他们的代码推送到 dev repo，然后将其复制到 prod repo。然后在产品服务器上进行简单的拉取。

我们正在使用 CakePHP。有 2 台服务器（prod 和 dev），当然还有 localhost。但是，每个环境的配置（数据库、付款、身份验证等）都不同。我的主要问题是以下哪个选项更好（也欢迎其他建议）？

## 选项1：

*   使用适当的配置设置所有 3 个环境
*   使用 .gitignore 忽略配置和特定于环境的文件
*   使用简单的推/拉

## 选项 2：

*   使用PHP机制检测环境并选择合适的配置
*   无需使用 .gitignore （除了可能只是忽略 tmp 文件等）
*   使用简单的推/拉

我想知道这样做的最佳方法是什么。此外，推荐一个易于部署的 Git 工作流会很棒。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T18:10:07.153

这正是您的`.gitignore`文件的用途，请使用选项 1。

# python - 如何将+1添加到列表中的每个第n个数字，python

> ID：12940244
> 
> 赞同：-4
> 
> 时间：2012-10-17T17:47:21.580
> 
> 标签：python

我生成了零列表。

```
num=raw_input

list=[0]*int(num) 
```

我希望 list2 中的每个第一个和第二个数字都添加 +1。

对于 list3 中的每个第三个数字，我想在其中添加 +1。

我期望以下输出。

> 清单2
> 
> 10101010101010
> 
> 清单3
> 
> 10010010010010

我尝试使用以下代码：

```
list=raw_input 
list=[0]*int(num) 
num2=list(num)/2 
num3=int(num)/3 
```

但是如果用在除 12 之外的任何数字上，那它就会中断，例如：

```
list1 = [1,0]*int(num2) 
list2 = [1,0,0]*int(num3) 
```

先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T17:57:10.633

这个怎么样：

```
for i in xrange(0, len(list)):
    if i % 2 == 0:
        list[i] += 1 
```

这会修改 list 的每个第二个元素，以便添加 1。**您可以通过将i % 2**更改为**i % 3**轻松修改此设置以更改每三分之一。

一个简短的旁注：此页面并非用于为您解决问题。正如 Abhinav Sarkar 所问：你尝试过什么？学习编程与其说是关于实际解决方案，不如说是关于到达那里的道路。

我看到你是新来的，但是，从一开始就做好这件事是件好事。在提出问题时——尤其是当它们像你的问题一样简单时——列出**你**尝试过的问题。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-17T17:57:23.650

最简单的方法是：

```
num=raw_input

list=[0]*int(num)
list2 = []
list3 = []

for x in xrange(len(list)):
    if x % 2 == 0:
        list2.append(list[x] + 1)
    else:
        list2.append(list[x])

for x in xrange(len(list)):
    if x % 3 == 0:
        list3.append(list[x] + 1)
    else:
        list3.append(list[x]) 
```

# php - 用于清理 Web 表单数据的 php 函数

> ID：12940251
> 
> 赞同：0
> 
> 时间：2012-10-17T17:47:58.077
> 
> 标签：php, mysql, webforms, sanitization

> **可能重复：**
> [在 PHP 中防止 SQL 注入的最佳方法？](https://stackoverflow.com/questions/60174/best-way-to-prevent-sql-injection-in-php)

我在 php 站点中的 html web 表单从客户端获取数据并将其放入 mysql 数据库。我想知道在将数据存储到 mysql 之前清理数据所需的步骤。

假设需要使用 PHP 执行此清理，然后将其插入 Mysql，您能否告诉我所有需要注意的事项？

作为一种特殊情况，除了一般的清理之外，我还想删除所有特殊字符、空格，并将所有字符转换为小写，然后再放入数据库。为此，我需要查看哪些功能？

我对php很陌生。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-17T17:51:48.250

1.mysqli_real_escape_string() 或mysql_real_escape_string() 转义引号

2.其他表单数据使用php filter_input

```
$search_html = filter_input(INPUT_GET, 'search', FILTER_SANITIZE_SPECIAL_CHARS);
$search_url = filter_input(INPUT_GET, 'search', FILTER_SANITIZE_ENCODED); 
```

php手册中还有其他选项是链接

[http://php.net/manual/en/function.filter-input.php](http://php.net/manual/en/function.filter-input.php)

[http://www.php.net/manual/en/filter.filters.sanitize.php](http://www.php.net/manual/en/filter.filters.sanitize.php)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-17T17:52:27.753

首先使用`mysqli_real_escape_string()`它将转义字符串中的引号来清理输入。

您可以`strtolower()`用于将字符转换为小写。

用于`htmlspeiclachars()`将特殊字符转换为 HTML 实体

使用正则表达式删除空格`preg_replace( '/\s+/', ' ', $whatever );`

如果要删除特殊字符，可以使用`preg_replace('#[^\w()/.%\-&]#',"",$whatever);`正则表达式。（[来源](https://stackoverflow.com/questions/6073221/php-remove-special-character-from-string)）

其他消毒过滤器参考[这里](http://www.php.net/manual/en/filter.filters.sanitize.php)

最后但并非最不重要的一点是，由于您是初学者，我建议您参考[文档](http://www.php.net/)

# css - 在 div 中滚动

> ID：12940258
> 
> 赞同：1
> 
> 时间：2012-10-17T17:48:25.413
> 
> 标签：css, html, scroll

正如您在下图中看到的，我有一个“屏幕”大小的红色 div，我想要的是使内容仅在该区域中可滚动。有没有办法做到这一点？

![在此处输入图像描述](../Images/357a7452c5ddb04d067599c5b6cdbf97.png)

整个pad的css：

```
#mainWindow{
    margin-left:auto;
    margin-right:auto;
    background-image:url("../images/mainWindow.png");
    background-size:100% 100%;
    height:100%;
    width:80%;
    padding:55px 60px 95px 65px;
    box-sizing:border-box;
    position: relative;
} 
```

屏幕的CSS：

```
#screen{
    border:1px solid red;
    width:100%;
    height:100%;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T17:49:27.793

尝试添加`overflow-y: scroll`到您的`#mainWindow`CSS 声明中。

（或者替代您的`#screen`CSS 声明。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-17T17:50:01.357

设置该 div 的溢出属性。

```
overflow:scroll; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-17T17:51:44.437

```
#divID {
    overflow: scroll;
} 
```

...可能会成功。如果您需要父元素不滚动，您可以将其设置为：

```
#divID {
    overflow: hidden;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-17T17:50:36.110

您要查找的 CSS 标记是“溢出”

# memory-management - 内核在高内存负载下的行为

> ID：12940262
> 
> 赞同：1
> 
> 时间：2012-10-17T17:48:31.680
> 
> 标签：memory-management, linux-kernel, scheduling, resource-scheduling

我在 Ubuntu 12.04 下观察到以下行为：

在具有 24GB RAM 和 24 个 CPU 的系统上，如果单个进程获得 ~12GB 的 RAM，则属于高内存进程所有者的所有其他进程都会在没有警告的情况下被杀死，使用看似 SIGKILL 的方法，并且高内存进程允许运行直到终止。此外，所有者尝试启动新进程将失败。

这有点麻烦，但我更好奇它为什么会发生。大概这是内核中资源调度决策的结果。有没有地方可以找到这方面的文档？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T08:51:54.227

很抱歉回答我自己的问题，但我喜欢记录解决方案。锯末链接的文章包含我需要的内容。

*   当内核耗尽可分配内存时，内核会激活内存不足管理器（Linux 内核中的 mm/oom_kill.c）。
*   OOM 管理器使用一些启发式方法来确定应该杀死哪个进程。一个进程的总运行时间减少了死亡的机会，而分配的内存增加了它。还有其他因素，但对我来说并不重要。
*   选择一个进程后，OOM 向它发送 SIGTERM。

就我而言，有两个原因导致除了占用内存的进程*之外的所有进程都被杀死。*

1.  我的进程在分配内存的区域期间忽略 SIGTERM。这可能是因为该进程在这段时间内正在积极接收许多其他信号，和/或因为该进程在剩余的大部分时间里都在阻塞 I/O。在任何情况下，它都会忽略 SIGTERM。

2.  占用所有内存的进程通常已经运行了很长时间，积累了几个小时的 RAM。尽管它的运行时间大约是其他任何进程的 4 倍，但它的运行时间很长（比其他进程长数百倍）可能会导致 OOM 管理器选择其他进程首先终止。

解决方案：

1.  跑步：

    ulimit -v memamount

对于特定用户，将用户可以使用单个进程分配的最大内存量更改为 memamount。这可以防止 OOM 管理器激活。相反， malloc 调用将失败，我可以检测到。

2：为 SIGTERM 编写一个优雅地清理的处理程序可能会有所帮助，但前提是 OOM 实际上正在向进程发送 SIGTERM，并且进程忽略或无法接收 SIGTERM。

3：从您的代码（C）中设置内存限制：

```
//resource limit structure with both hard and soft max set to 2GB.
struct rlimit memmax; memmax.rlim_max=0x7FFFFFFF; memmax.rlim_cur = 0x7FFFFFFF;
setrlimit(RLIMIT_MEMLOCK,&memmax); //set maximum virtual memory space to 2GB. 
```

# python - 从给定集合中出现的列表列表中删除所有单词

> ID：12940263
> 
> 赞同：0
> 
> 时间：2012-10-17T17:48:31.483
> 
> 标签：python, list, set

我正在尝试在 Python 中有效地执行三个简单的步骤。

我有一个列表列表（字符串）。让我们称之为`L`。

> 1.  我想将列表列表展平为单个列表 LL。（我知道如何有效地做到这一点）
>     
>     
> 2.  从步骤 1 的列表 LL 中构造频率为 1 的单词集合。让我们称这个集合为 S。（我也知道如何有效地做到这一点）
>     
>     
> 3.  从列表 L 的列表中删除所有出现在 S 中的单词。

如果您能建议一种有效的方法来执行第 3 步，那将是一个很大的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T18:05:02.613

使用简单`list comprehension`的第三步：

```
>>> from collections import Counter
>>> from itertools import chain
>>> L=[['a','b'],['foo','bar'],['spam','eggs'],['b','c'],['spam','bar']]
>>> S=Counter(chain(*L))
>>> S
Counter({'b': 2, 'bar': 2, 'spam': 2, 'a': 1, 'c': 1, 'eggs': 1, 'foo': 1})

>>> [[y for y in x if S[y]!=1] for x in L]
[['b'], ['bar'], ['spam'], ['b'], ['spam', 'bar']] 
```

如果你有一套`R`：

```
>>> L=[['a','b'],['foo','bar'],['spam','eggs'],['b','c'],['spam','bar']]
>>> R={'a','foo'}
>>> [[y for y in x if y not in R] for x in L]
[['b'], ['bar'], ['spam', 'eggs'], ['b', 'c'], ['spam', 'bar']] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T17:50:51.163

```
import collections
import operator

LL = reduce(operator.add, L)
counted_L = collections.Counter(LL)
def filter_singles(sublist):
  return [value for value in sublist if counted_L[value] != 1]
no_single_freq_L = [filter_singles(sublist) for sublist in L] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T18:42:29.443

您已经提到在步骤 2 中创建一个集合。内置类型[`set`](http://docs.python.org/library/stdtypes.html#set)可以使您的步骤 3 非常易于阅读和理解。

```
# if you are already working with sets:
LL - S

# or convert to sets
set(LL) - set(S) 
```

快速示例

```
>>> all_ten = set(range(0,10))
>>> evens = set(range(0,10,2))
>>> odds = all_ten - evens
>>> odds
set([0, 8, 2, 4, 6,]) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-17T18:58:23.300

```
>>> #Tools Needed
>>> import collections
>>> import itertools
>>> #Just for this example
>>> import keyword
>>> import random
>>> #Now create your example data
>>> L = [random.sample(keyword.kwlist,5) for _ in xrange(5)]
>>> #Flatten the List (Step 1)
>>> LL = itertools.chain(*L)
>>> #Create Word Freq (Step 2)
>>> freq = collections.Counter(LL)
>>> #Remove all words with unit frequency (Step 3)
>>> LL = itertools.takewhile(lambda e:freq[e] > 1,freq)
>>> #Display Your result
>>> list(LL)
['and']
>>> L
[['in', 'del', 'if', 'while', 'print'], ['exec', 'try', 'for', 'if', 'finally'], ['and', 'for', 'if', 'print', 'lambda'], ['as', 'for', 'or', 'return', 'else'], ['and', 'global', 'or', 'while', 'lambda']]
>>> 
```

# jquery - jquery按id还是按类选择？

> ID：12940266
> 
> 赞同：0
> 
> 时间：2012-10-17T17:48:37.327
> 
> 标签：jquery

我在一个页面上有五个不同的输入控件，每个控件都有不同的 id 和名称，还有一个类。

```
<input id="txtName1" name="txtName1" class="jName" type="text" />
<br />
<input id="txtName2" name="txtName2" class="jName" type="text" />
<br />
<input id="txtName3" name="txtName3" class="jName" type="text" />
<br />
<input id="txtName4" name="txtName4" class="jName" type="text" />
<br />
<input id="txtName5" name="txtName5" class="jName" type="text" /> 
```

使用 jquery 选择一组输入来注册模糊事件时，哪种方式更有效？我问的原因是因为我实际上在页面上有 20 个这样的输入控件，我希望 jquery select 尽可能快。

**1）按标签ID选择：**

```
$(document).on("blur", "input[id*='_txtName']", function ($e) {
  alert("blur event successful");
}) 
```

或者

**2) 按类别选择：**

```
$(document).on("blur", ".jName", function ($e) {
  alert("blur event successful");
}) 
```

**编辑：** 我的意图是将模糊事件连接到上面代码中的所有输入元素。抱歉，这里的混乱，伙计们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T17:51:18.197

尝试使用 JSPerf 对您的代码进行基准测试，您将得到答案。:)

[http://jsperf.com/](http://jsperf.com/)

不过说真的，效率并不是唯一需要担心的事情，性能还会受到许多其他考虑因素的影响，包括页面上的元素和结构。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T17:54:39.187

几件事：

1.  您在所有这些元素上使用相同的 id 值。不要那样做，它们应该是独一无二的。
2.  在这种情况下，按类查找要快得多，因为类选择器比属性选择器快。

性能测试：http: [//jsperf.com/id-regex-vs-class](http://jsperf.com/id-regex-vs-class)

在`HTML`那个测试中，我确实将您的 id 值更改为唯一的。我也在使用属性以选择器开头而不是以结尾。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T18:03:11.527

考虑到它一次只会查看一个元素（触发事件的元素），您的子选择器性能并没有太大区别。如果您真的想提高性能，请选择比文档更好的上下文元素。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-17T18:05:48.090

如果你看看这个小提琴：[jsFiddle Demo](http://jsfiddle.net/eLWE7/)

您会看到带有 ID 的*****选择器肯定会使它变慢一点。（另请注意，我选择了 50,000 次元素，这可能永远不会发生）。在这种情况下，类选择器肯定更快，但差别不大。

来自 jQuery 网站：[http ://api.jquery.com/attribute-contains-selector/](http://api.jquery.com/attribute-contains-selector/)

> 这是匹配值的最慷慨的 jQuery 属性选择器。如果选择器的字符串出现在元素属性值中的任何位置，它将选择一个元素。将此选择器与 Attribute Contains Word 选择器（例如 [attr~="word"]）进行比较，后者在许多情况下更合适。

# c# - 从在线视频流中捕获屏幕截图

> ID：12940268
> 
> 赞同：5
> 
> 时间：2012-10-17T17:48:38.327
> 
> 标签：c#, video-streaming, video-capture, rtmp, image-capture

我需要从 rtmp 或 http 视频流中捕获屏幕截图。我想每 10 秒捕获一次屏幕截图并将其保存为 png 或 jpg 文件。

我找不到任何可以为我执行此操作的程序，因此我正在考虑使用以下库中的 C# 编写应用程序： [http ://www.broccoliproducts.com/softnotebook/rtmpclient/rtmpclient.php](http://www.broccoliproducts.com/softnotebook/rtmpclient/rtmpclient.php)

不幸的是，rtmpClient 库似乎只捕获 rtmp 流并将其保存到 flv 文件中，这不是我想要的。任何知道可以帮助我的更好的库的人吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-17T18:39:34.670

我现在找到了解决问题的方法。如果有人想知道，我写了一个小程序，使用 rtmpdump 和 ffmpeg 来捕获图像。

```
 static void Main(string[] args)
    {
        const string rtmpDump = "rtmpdump.exe";
        const string rtmpDumpArguments = "-v -r rtmp://{stream} -o 1.flv -B 1";
        sRunExternalExe(rtmpDump, rtmpDumpArguments);

        const string ffmpeg = "ffmpeg.exe";
        const string ffmpegArguments = "-i 1.flv -ss 00:00:01 -an -r 1 -vframes 1 -s 400x300 -y 1.jpg";
        RunExternalExe(ffmpeg, ffmpegArguments);

        var theFile = new FileInfo("1.flv");
        if (theFile.Exists)
        {
            File.Delete("1.flv");
        }
    }

    public static string RunExternalExe(string filename, string arguments = null)
    {
        var process = new Process();

        process.StartInfo.FileName = filename;
        if (!string.IsNullOrEmpty(arguments))
        {
            process.StartInfo.Arguments = arguments;
        }

        process.StartInfo.CreateNoWindow = true;
        process.StartInfo.WindowStyle = ProcessWindowStyle.Hidden;
        process.StartInfo.UseShellExecute = false;

        process.StartInfo.RedirectStandardError = true;
        process.StartInfo.RedirectStandardOutput = true;
        var stdOutput = new StringBuilder();
        process.OutputDataReceived += (sender, args) => stdOutput.Append(args.Data);

        string stdError = null;
        try
        {
            process.Start();
            process.BeginOutputReadLine();
            stdError = process.StandardError.ReadToEnd();
            process.WaitForExit();
        }
        catch (Exception e)
        {
            throw new Exception("OS error while executing " + Format(filename, arguments) + ": " + e.Message, e);
        }

        if (process.ExitCode == 0 || process.ExitCode == 2)
        {
            return stdOutput.ToString();
        }
        else
        {
            var message = new StringBuilder();

            if (!string.IsNullOrEmpty(stdError))
            {
                message.AppendLine(stdError);
            }

            if (stdOutput.Length != 0)
            {
                message.AppendLine("Std output:");
                message.AppendLine(stdOutput.ToString());
            }

            throw new Exception(Format(filename, arguments) + " finished with exit code = " + process.ExitCode + ": " + message);
        }
    }

    private static string Format(string filename, string arguments)
    {
        return "'" + filename +
            ((string.IsNullOrEmpty(arguments)) ? string.Empty : " " + arguments) +
            "'";
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T11:00:02.390

如果你在 Linux 上，你可以使用 bash（这可能不适用于你，但希望能帮助任何人用谷歌搜索），这就是我使用 'rtmpdump' （apt-get install rtmpdump）将它用于我们的流媒体产品的方式：

**/脚本/rtmpsnapshot**

```
#!/bin/bash
rtmpdump --live --timeout=9 -r $1 -a $2 -y $3  --stop 1 -o - | avconv -i - -s 720x404 -vframes 1 $4 
```

这样称呼：

```
/scripts/rtmpsnapshot rtmp://myserver.com/applicationname/ applicationname streamname /tmp/mysnapshot.jpg 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T17:51:27.267

你看过[SnagIt吗！v11.1](http://www.techsmith.com/snagit-gslp.html?gclid=CLPVxOTOiLMCFROe4Aod2zkA5w) ? 我刚刚升级了我的副本，它将捕获视频流和相关的音频。

我不知道每 10 秒的屏幕截图，但我知道它具有内置的计时器功能，以及隔离单个帧的能力。

也许值得一瞧。我认为它带有 30 天的试用期。

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2012-10-17T17:59:56.000

如果您使用的是 Windows 7，它带有一个片段工具，可以捕获您的屏幕。

# flash - Flash 在 Chrome Safari Firefox 中有效，但在 IE9 中无效

> ID：12940269
> 
> 赞同：1
> 
> 时间：2012-10-17T17:48:41.603
> 
> 标签：flash, internet-explorer, internet-explorer-9

[我在这个网站http://cbcking.org/](http://cbcking.org/)的主页上有一个 Flash 电影。

它在我测试的任何浏览器中都能正常显示，除了 ie9。

已经搜索了我知道要搜索的任何内容，并且被难住了。知道为什么会这样吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T18:30:57.017

偷看你的网页源代码，你有这个：

```
 if(document.getElementById('myFlashContent')){
        swfobject.registerObject("myFlashContent", "8.0.0", "/_swf/expressInstall.swf");
    } 
```

如果我没记错的话，那段代码是在加载“myFlashContent”元素之前加载的，尝试将该代码更改为：

```
$( function() {
   swfobject.registerObject("myFlashContent", "8.0.0", "/_swf/expressInstall.swf");
} ); 
```

# mongodb - 如何根据属性条件忽略 MongoDB 索引中的记录

> ID：12940270
> 
> 赞同：0
> 
> 时间：2012-10-17T17:48:42.227
> 
> 标签：mongodb, indexing

我想根据大于 0 的计数值查询集合。例如，我想优化一个查询，在该查询中我得到所有“car_count”大于 0 的“经销商”。我的第一直觉是索引根据汽车数量降序排列。由于我们永远不会显示超过 100 家经销商或一些合理的数量，因此这将表现良好。但是，我认为可以优化该索引，因为“car_count”= 0 的经销商首先没有理由进入该索引。我们在浪费内存。仅供参考-实际上并不是为经销商这样做，因此完全有可能存在“car_count”= 0的大量“经销商”。如何更改以下索引以忽略带有“car_count”的“经销商” "

```
db.dealerships.ensureIndex({"car_count":-1}) 
```

该解决方案是否会使写入效率比我现有的索引低得多？

# java - 如何在java中将字符串拆分为int数组

> ID：12940274
> 
> 赞同：-2
> 
> 时间：2012-10-17T17:49:02.777
> 
> 标签：java, android

在这里，我有这种类型的字符串，我想将此字符串拆分为每个元素，并希望为数字创建一个数组列表（整数）或一个整数数组。

我有这样的字符串作为示例：`123|00,124|01,125|00,126|01`

我想首先分离一个列表中的所有元素，其中包含

```
123|00
124|01
125|00
126|01 
```

在我想制作一个整数数组列表或整数数组之后

```
123
124
125
126 
```

请任何人都可以建议我如何做到这一点

谢谢

代码：

```
 List<Integer> numberList = new ArrayList<Integer>();
        HashMap<Integer, Integer> statusMap = new HashMap<Integer, Integer>();
        for (String tripnumber : tripNumbers) {

            int number = Integer.parseInt(tripnumber.split("[|]")[0]);
            Logger.d(TAG, "Trip number in Status Message = "+number);

            int flag = Integer.parseInt(tripnumber.split("[|]")[1]);
            Logger.d(TAG, "TM flag = "+flag);

            if (number > 0) {
                statusMap.put(number, flag);
                numberList.add(number);
            }
        } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-17T17:51:43.173

```
String str = "123|00,124|01,125|00,126|01";

// Split on `|` or `,` and then take every alternate element.
String[] tokens = str.split("[|,]");

List<Integer> intList = new ArrayList<Integer>();    
for (int i = 0; i < tokens.length; i = i + 2) {
    intList.add(Integer.parseInt(tokens[i]));
} 
```

**更新**： -

如果用`|`and分隔的值不一致`,`，则需要分别对它们进行拆分：-

```
String str = "123|00,125|,126|01,|,";
String[] tokens = str.split(",");
Map<Integer, String> flagMap = new HashMap<Integer, String>();

    for (String token: tokens) {
        String[] arr = token.split("[|]");

        if (arr.length == 0) {
            continue;
        }
        if (arr[0].length() > 1) {
            if (arr.length == 2) {
                flagMap.put(Integer.parseInt(arr[0]), arr[1]);
            } else {
                flagMap.put(Integer.parseInt(arr[0]), "");
            }
        }
    }

    System.out.println(flagMap); 
```

**输出**： -

```
{126=01, 125=, 123=00} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T17:55:22.493

这个怎么样：

```
import java.util.ArrayList;
import java.util.List;

public class Test {

    public static void main(String [] args) throws Exception
    {

        String input = "123|00,124|01,125|00,126|01";

        List<Integer> out = new ArrayList<Integer>();

        String [] s = input.split(",");     

        for(String i : s) {
            int x = i.indexOf("|");
            out.add(Integer.parseInt(i.substring(0,x)));
        }

    }

} 
```

String.split() 函数中有很多处理，尤其是在单个字符的“快速路径”之外。这是一个简单的比较来说明“本土”方法和“String.split”之间的性能差异。

```
import java.util.ArrayList;
import java.util.Date;
import java.util.List;

public class Main
{
    public static void main(String [] args) throws Exception
    {

        String str = "123|00,124|01,125|00,126|01";

        Date before = new Date();

        for(int x=0;x<10000000;++x) {

            /*

            // Split on `|` or `,` and then take every alternate element.
            String[] tokens = str.split("[|,]");

            List<Integer> intList = new ArrayList<Integer>();    
            for (int i = 0; i < tokens.length; i = i + 2) {
                intList.add(Integer.parseInt(tokens[i]));
            }

            */

            List<Integer> out = new ArrayList<Integer>();

                String [] s = str.split(",");     

            for(String i : s) {
                int y = i.indexOf("|");
                out.add(Integer.parseInt(i.substring(0,y)));
            }

        }

        Date after = new Date();

        System.out.println(after.getTime() - before.getTime());

    }

} 
```

在我的电脑上，“拆分”测试需要 6354 毫秒，而“本土”测试需要 2341 毫秒。“拆分”更容易编码、理解和维护。但“本土”的速度要快 37%。

开发人员应该意识到 split 是为复杂表达式设计的正则表达式处理器。对于简单的情况，您可能会选择更快的解决方案。了解权衡是很重要的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T17:57:11.837

或者尝试捕获，以及更多检查....

```
 String s = "123|00,124|01,125|00,126|01";
    String[] parts = s.split(",");

    //The list of Strings the guy wanted
    ArrayList<String> listParst = new ArrayList<String>(Arrays.asList(parts));

    //The list of ints the guy wanted       
    ArrayList<Integer> listInt = new ArrayList<Integer>();

    for(String is: listParst){
        try {
            String[] t = is.split("|");
            if(t.length > 0){
                int i = Integer.parseInt(t[0]);
                listInt.add(i);
            }
        } catch(NumberFormatException e){

        }
    } 
```

# php - 即使我将其设置为非阻塞，fopen 也会阻止 wordpress。是我服务器的问题吗？

> ID：12940275
> 
> 赞同：0
> 
> 时间：2012-10-17T17:49:04.087
> 
> 标签：php, wordpress, fopen

我在禁用 cUrl 的服务器上遇到 wordpress WP_Cron 问题，基本上调用 cron 会阻止服务器，我想知道为什么会发生这种情况，以及它是否与我的网络服务器的某些配置有关。

这是代码

```
 $arrContext = array('http' =>
        array(
            'method' => strtoupper($r['method']),
            'user_agent' => $r['user-agent'],
            'max_redirects' => $r['redirection'] + 1, // See #11557
            'protocol_version' => (float) $r['httpversion'],
            'header' => $strHeaders,
            'ignore_errors' => true, // Return non-200 requests.
            'timeout' => $r['timeout'],// here i have 10
            'ssl' => array(
                    'verify_peer' => $ssl_verify,
                    'verify_host' => $ssl_verify
            )
        )
    );

    $proxy = new WP_HTTP_Proxy();

    if ( $proxy->is_enabled() && $proxy->send_through_proxy( $url ) ) {
        $arrContext['http']['proxy'] = 'tcp://' . $proxy->host() . ':' . $proxy->port();
        $arrContext['http']['request_fulluri'] = true;

        // We only support Basic authentication so this will only work if that is what your proxy supports.
        if ( $proxy->use_authentication() )
            $arrContext['http']['header'] .= $proxy->authentication_header() . "\r\n";
    }

    if ( ! empty($r['body'] ) )
        $arrContext['http']['content'] = $r['body'];

    $context = stream_context_create($arrContext);

    if ( !WP_DEBUG )
        $handle = @fopen($url, 'r', false, $context);
    else
        $handle = fopen($url, 'r', false, $context);
            error_log('after');
    if ( ! $handle )
        return new WP_Error('http_request_failed', sprintf(__('Could not open handle for fopen() to %s'), $url));

    $timeout = (int) floor( $r['timeout'] );
    $utimeout = $timeout == $r['timeout'] ? 0 : 1000000 * $r['timeout'] % 1000000;
    stream_set_timeout( $handle, $timeout, $utimeout );

    if ( ! $r['blocking'] ) {
        stream_set_blocking($handle, 0);
        fclose($handle);
        return array( 'headers' => array(), 'body' => '', 'response' => array('code' => false, 'message' => false), 'cookies' => array() );
    } 
```

如果我将超时设置为 10，则永远不会为调用 wp_cron 打印错误日志，而是会收到此错误

> PHP警告：fopen（http://localhost/wordpress/wp-cron.php?doing_wp_cron=1350494198.1313750743865966796875）[function.fopen]：打开流失败：HTTP请求失败！在第 925 行的 C:\Program Files (x86)\Zend\Apache2\htdocs\wordpress\wp-includes\class-http.php

是不是我的服务器上的某些配置导致了这种情况？我认为调用`fopen()`并不意味着等待资源响应对吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T20:52:58.963

默认情况下，超时非常短（大约 0.01 秒），因为有时请求会失败，基本上，wp_cron 下次可以再试一次。您似乎已将其更改为很长的间隔，因此很明显。看看[这个 Trac 线程](http://core.trac.wordpress.org/ticket/11831)。如果你有`define('WP_DEBUG',true);`，你会一直看到这个。我想你可能会担心没有什么重要的事情。真的会惹麻烦吗？就我自己而言，我从来没有因为它而注意到问题。

# mysql - 每月显示mysql日历

> ID：12940276
> 
> 赞同：0
> 
> 时间：2012-10-17T17:49:06.627
> 
> 标签：mysql, sql, pivot

我正在开发一个网站，其中包含一个连接到数据库的空缺日历。我设法创建了一个表格，列出了从 2012 年 10 月 1 日到 2030 年的每一天，其中包含以下字段：

```
MyTable
-----------                 
 -dt date                       
 -mid smallint (ID for each month)  
 -y smallint (year)         
 -m tinyint (month)         
 -d tinyint (day)                   
 -dw tinyint (day of week)          
 -monthName varchar             
 -isVacant binary   
 -isWeekday  binary 
```

我想在网站上显示这些数据，连续显示每个月（中），显示每一天以及它们是空的还是被占用的。我需要基本上将数据从行转换为列。

我一直在寻找一个查询来做到这一点，但到目前为止没有任何效果。我试图重写数据透视查询的示例，但我似乎没有得到正确的语法。谁能帮我解决这个问题？

这是东西的样子： [mysql calendar table](http://www.mathieuleguet.com/display/db-view.html) - [html table](http://www.mathieuleguet.com/display/final-table.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T18:53:48.977

我不确定，但我认为这是你想要得到的。如果您提供表格数据和结果示例，可能会更好：

```
select m, (case d when 1 then isVacant),  (case d when 2 then isVacant), 
 (case d when 3 then isVacant), ..... 
from MyTable
group by m
order by m 
```

**编辑：** 看看[sqlfiddle](http://sqlfiddle.com/#!2/0ce37/1) 请注意，我将 isVacant 列创建为整数类型字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T18:23:07.237

为什么要在 mysql 查询中将数据放入单行？我只需将数据拉入 php，每天一行，然后使用 php 来安排我想要的数据。可能有一个 mysql 解决方案，但我认为这不值得。只需遍历这些日子，随时填充您的数组。

# objective-c - 在 Objective-C 中读取文件时处理换行符

> ID：12940278
> 
> 赞同：0
> 
> 时间：2012-10-17T17:49:09.470
> 
> 标签：objective-c, ios, csv

朋友们，我有一个问题，希望你们能帮助我。所以..这是我的代码：

```
NSString* filePath = [[NSBundle mainBundle] pathForResource:@"convidados" ofType:@"csv"];
NSString* fileContents = [NSString stringWithContentsOfFile:filePath encoding:NSUTF8StringEncoding error:nil];
NSMutableArray* pointStrings = [[NSMutableArray alloc] initWithArray:[fileContents componentsSeparatedByCharactersInSet:[NSCharacterSet newlineCharacterSet]]];

for(int idx = 0; idx < [pointStrings count]; idx++)
{

    NSString* currentPointString = [pointStrings objectAtIndex:idx];
    NSMutableArray* arr = [[NSMutableArray alloc] initWithArray:[currentPointString componentsSeparatedByCharactersInSet:[NSCharacterSet characterSetWithCharactersInString:@"#"]]];

    NSString *nome = [[NSString alloc] initWithFormat:@"%@", [arr objectAtIndex:0]];
    NSString *email = [[NSString alloc] initWithFormat:@"%@", [arr objectAtIndex:1]];
    NSString *website = [[NSString alloc] initWithFormat:@"%@", [arr objectAtIndex:2]];
    NSString *telefone = [[NSString alloc] initWithFormat:@"%@", [arr objectAtIndex:3]];
    NSString *empresa = [[NSString alloc] initWithFormat:@"%@", [arr objectAtIndex:4]];
    NSString *cidade = [[NSString alloc] initWithFormat:@"%@", [arr objectAtIndex:5]];

    NSDictionary *registro = [[NSDictionary alloc] initWithObjects:[NSArray arrayWithObjects: nome, email , telefone, empresa, website, cidade, nil] forKeys:[NSArray arrayWithObjects:@"nome", @"email", @"telefone", @"empresa", @"website", @"cidade", nil]];

    [PessoaDAO adicionar:registro];

    [arr removeAllObjects];
    [arr release];

} 
```

我的 csv 文件：

```
Usuario1# Usuario1@gmail.com# http://facebook.com/Usuario1# 99999999#Company# Cidade
Usuario2# Usuario2@gmail.com# http://Usuario2.com# 737373773# Company# Fortaleza
Usuario3# Usuario3@gmail.com# http://Usuario3.com.br# 83838484# Company Solutions# City 
```

问题是当执行下面的行时，当右边只有 3 个对象时识别出 7 个对象。我相信那是因为“newlineCharacterSet”它们添加了一个“,”并混淆了执行。

```
NSMutableArray* pointStrings = [[NSMutableArray alloc] initWithArray:[fileContents componentsSeparatedByCharactersInSet:[NSCharacterSet newlineCharacterSet]]]; 
```

NSMutableArray pointStrings 执行：

```
<__NSArrayM 0x1c586990>(
Usuario1# Usuario1@gmail.com# http://facebook.com/Usuario1# 99999999#Company# City,
,
Usuario2# Usuario2@gmail.com# http://Usuario2.com# 737373773# Company# City,
,
Usuario3# Usuario3@gmail.com# http://Usuario3.com.br# 83838484# Company# City,
,

) 
```

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T17:53:09.913

这可能是因为您使用的文件是在 Windows 中创建的，该文件在行尾[使用两个字符](http://en.wikipedia.org/wiki/Newline)( )。`CR+LF`您的代码将您的行`CR`拆分然后再次拆分，`LF`从而创建一个空行。

只需检查计数`arr`是否小于 6，或者长度`currentPointString`是否为 0，如果是，则继续：

```
for(int idx = 0; idx < [pointStrings count]; idx++) {

    NSString *currentPointString = [pointStrings objectAtIndex:idx];
    if ([currentPointString length] == 0) {
        continue;
    }
    NSMutableArray *arr = [currentPointString componentsSeparatedByCharactersInSet:[NSCharacterSet characterSetWithCharactersInString:@"#"]];
    if ([arr count] < 6) {
        continue;
    }
    ...
} 
```

这也将处理文件中以空行开头的情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T17:53:30.903

“csv”是“逗号分隔值”的首字母缩写词，您的数据（如图所示）由空格而不是逗号分隔。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T18:11:11.573

大部分与您的错误无关（无论是什么）-

```
NSArray* arr = [currentPointString componentsSeparatedByString:@"#"];
NSDictionary *registro = [[NSDictionary alloc] initWithObjects:arr forKeys:[NSArray arrayWithObjects:@"nome", @"email", @"website", @"telefonee", @"empresa", @"cidade", nil]]; 
```

这两行之间的代码是不必要的，[arr removeAllObjects] 也是如此。以上消除了对[arr release]的需要。

（如果您不删除虚假`[[NSString alloc] initWithFormat:@"%@", ...`呼叫，您将泄漏大量存储空间。）

（请注意，我提供这主要是因为（通过在不知道自己在做什么的情况下进行复制/粘贴）您的代码太复杂而无法理解。通过简化您可以更好地解决问题。）

# vb.net - 遍历 Windows 窗体并关闭它们？

> ID：12940279
> 
> 赞同：0
> 
> 时间：2012-10-17T17:49:11.307
> 
> 标签：vb.net, winforms, foreach

我正在尝试使用以下代码遍历我的应用程序中所有当前打开的表单并关闭它们，除了主表单作为清理的一部分。

```
 Dim openForms As Windows.Forms.FormCollection = Application.OpenForms

    For Each frm As Windows.Forms.Form In openForms
        If frm.Name.ToString() <> "FrmMainNew" Then
            frm.Close()
        End If
    Next 
```

但是，我得到了一个，`InvalidOperationException`因为当`frm.Close()`执行时，`openForms`删除了其中的条目，从而改变了集合的大小。我显然做错了什么，所以如果有人能在这里指出我的问题，那就太棒了。否则，还有其他方法可以做这样的事情吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-17T18:09:24.493

向后迭代，以便修改集合不字节：

```
 For ix As Integer = Application.OpenForms.Count - 1 To 0 Step -1
        Dim frm = Application.OpenForms(ix)
        '' etc..
    Next 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T18:27:33.443

使用“while”循环而不是“For”，检查 Application.OpenForms.Count > 1 当您使用 while 循环时，您会在“其他事情”发生时执行“某事”。你不迭代槽收集，它不会对你发生变异。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-04-16T19:31:33.927

另一种方法：

```
For Each OFORM in Application.Openforms
    With OFORM
        'Methods and conditions here
    End With
Next OFORM 
```

# jena - Jena ARQ 查询本地 N3 数据存储不返回任何结果。ARQ 命令行工作

> ID：12940282
> 
> 赞同：2
> 
> 时间：2012-10-17T17:49:23.090
> 
> 标签：jena

我对 Jena ARQ 有疑问，也许你可以帮我解决。我有一个本地 N3 文件，我想使用 Java 中的 ARQ 对其进行选择。问题是我得到了 0 个结果。

这是我使用的代码：

```
FileManager.get().addLocatorClassLoader(SomeClass.class.getClassLoader());
Model model = FileManager.get().loadModel("props/temp.n3");
QueryExecution qexec = QueryExecutionFactory.create(query, model);
queryResultSet = qexec.execSelect(); 
```

...

我打开了完整的日志记录（上面没有显示），但它没有报告任何错误。

现在，有趣的是，如果我尝试 arq 的命令行版本，我会得到结果。所以查询没有问题。我尝试过创建 FileManagers、Datasets 和 LocationMappings 但无济于事。我什至调试了 arq 命令行实用程序以查看所有参数放在一起以创建查询执行对象的位置，但我没有走多远。我没主意了。有什么线索吗？我知道它一定是在创建查询执行对象时发生的。我正在使用最新版本的 ARQ (2.9.3)。

```
model.size() 
```

报告 173。

询问：

```
SELECT *

WHERE {
    ?Node ?property ?object .  

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T19:39:22.717

两条信息会有所帮助：记录 的结果`model.size()`，并向我们展示您的查询。基本上，您的代码看起来不错，因此模型中的数据不是您所期望的，或者查询存在问题，尽管它是从命令行运行的。

# android-service - 加载列表视图时如何实现后台服务？

> ID：12940284
> 
> 赞同：0
> 
> 时间：2012-10-17T17:49:27.893
> 
> 标签：android-service

一个应用程序中存在 2 个屏幕，在第一个屏幕中只有一个按钮，在第 2 个屏幕中，在单个列表中列出 1000 个项目，如果用户单击第一个屏幕中的按钮，他将定向到第 2 个屏幕，但在第 2 个屏幕 1000列表项用于加载这 1000 个列表项需要很长时间，因此用户单击菜单按钮并转到其他应用程序，一段时间后用户返回主应用程序然后列表视图处于先前状态，即仍在加载，我想通过在后台使用服务实现来解决这个问题，在android中可以吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T15:39:22.783

**您可以使用线程、异步任务、服务运行后台进程，但对于 UIupdating UIthread 是最好的进程，因为

```
When your app performs intensive work in response to user interaction, this single thread model can yield poor performance unless you implement your application properly. Specifically, if everything is happening in the UI thread, performing long operations such as network access or database queries will block the whole UI. When the thread is blocked, no events can be dispatched, including drawing events. From the user's perspective, the application appears to hang. Even worse, if the UI thread is blocked for more than a few seconds (about 5 seconds currently) the user is presented with the infamous "application not responding" (ANR) dialog. The user might then decide to quit your application and uninstall it if they are unhappy.

Additionally, the Andoid UI toolkit is not thread-safe. So, you must not manipulate your UI from a worker thread—you must do all manipulation to your user interface from the UI thread. Thus, there are simply two rules to Android's single thread model:

Do not block the UI thread Do not access the Android UI toolkit from outside the UI thread** 
```

# c - 通过管道写入结构数组

> ID：12940285
> 
> 赞同：2
> 
> 时间：2012-10-17T17:49:31.170
> 
> 标签：c, process, struct, pipe

我正在学习 Linux 中的流程管理，我需要让孩子和父母通过管道进行交流。我已经声明了两个结构：

```
typedef struct
{
    double min, max, avg;   /*Number stats*/
} Stats;

typedef struct {
    pid_t pid;      /*Process ID*/
    int first;      /*First number to process*/
    int last;       /*Last number to process*/
    int fd[2];      /*Pipe descriptor*/
    Stats stats;    /*Stats computed by process*/
}Process_list; 
```

我需要 M 个子进程从一组数字中计算一些统计数据（划分工作）。然后，子进程将读取 Process_list 结构，从头到尾处理数组中的数字（在此处指定）并将计算的统计信息保存到 stats 结构中。

与我的代码问题最相关的部分如下（我正在添加注释而不是其他代码来解释可以完成的操作）：

```
int main(int argc, char *argv[])
{
    pList=(Process_list *)malloc((M+1)*sizeof(Process_list));
    /*Correct allocation is checked*/

    int i;
    pid_t pid;
    for (i=0 ; i<M ; i++)       /*M clones*/
    {
        /*Fork and pipe creation*/
        pid = fork ();
        pipe(pList[i].fd);

        /*If it's the child*/
        if ( pid == 0 ) 
        {
            pList[i].pid=pid; 
            printf("CHILD %d: %d a %d\n",i, pList[i].first,pList[i].last);

            /*A function here computes stats and saves them OK in the struct*/
            /*(e.g. min is saved in pList[i].stats.max, when printed it's a reasonable value)*/

            /*Now I need to send the info to the parent*/
            ret1=close(pList[i].fd[0]);
            /*ret1=0 => OK */

            ret2=write(pList[i].fd[1], &(pList[i].stats), sizeof(Stats));
            printf("return write: %d\n",ret2);
            /*TROUBLE HERE! This isn't even printed. sizeof(Stats)=24 which I think is OK*/

            exit(EXIT_SUCCESS);
        }

        /*Parent*/
        else if ( pid > 0 )
        {
            wait(NULL); /*Is this really neccesary?*/

            ret1=close(pList[i].fd[1]);
            ret2=read(pList[i].fd[0], &(pList[i].stats), sizeof(Stats));
            /*Both ret1 and ret2 = 0*/

            printf("[p]Mín: %lf\n Max: %lf\nAverage: %lf\n",pList[i].stats.min,pList[i].stats.max,pList[i].stats.avg);
            /*Everything printed here  = 0.0000000000*/

        }

        else /*fork error*/
                return -1;
    } 
```

所以我的问题是孩子们完美地计算了他们的统计数据，但父母没有收到他们。write() 函数什么也不做。这发生在 M 的每一个值上（包括 M=1 - 只有一个进程）。

另外我不知道是否需要等待（NULL），因为我已经看到了一些不使用它的工作示例。但是，如果我不在那里写，则父母的 printfs 将出现在孩子的之前，所以我认为它只是不等待孩子在管道中写入。无论如何，它没有它是行不通的。

或者也许结构方法不是一个好方法？

非常感谢您！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T17:59:49.683

您必须在分叉之前创建管道。否则，您将创建两个管道。一个在您的父母身上，一个在您的孩子身上，它们没有连接。

并且对于获得所有数据后的孩子，如果孩子阻塞管道缓冲区清除`wait`，您可能最终会永远等待。释放与死去的孩子相关的资源。如果您的孩子没有死，这将等到它死了。`write``wait`

另一件事：`fwrite`用于将数据块（结构数组）写入文件描述符。`fread`阅读。您可以将文件描述符转换为`FILE*`with `fdopen`。

```
int main(int argc, char *argv[])
{
pList=(Process_list *)malloc((M+1)*sizeof(Process_list));
/*Correct allocation is checked*/

int i;
pid_t pid;
for (i=0 ; i<M ; i++)       /*M clones*/
{
    /*Fork and pipe creation*/
    if(pipe(pList[i].fd)) {
        perror("pipe");
        return -1;
    }
    pid = fork ();

    /*If it's the child*/
    if ( pid == 0 ) 
    {
        pList[i].pid=pid; 
        printf("CHILD %d: %d a %d\n",i, pList[i].first,pList[i].last);

        /*A function here computes stats and saves them OK in the struct*/
        /*(e.g. min is saved in pList[i].stats.max, when printed it's a reasonable value)*/

        /*this just closes your read end of the pipe*/
        close(pList[i].fd[0]);
        /*ret1=0 => OK */

        FILE* fp = fdopen(pList[i].fd[1], "w");
        while (!fwrite(&(pList[i].stats), sizeof(Stats), 1, fp) && !feof(fp));
        if (feof(fp)) {
            fclose(fp);
            fprintf(stderr, "reader closed his end of the pipe\n");
            return -1;
        }

        // sends eof to reader
        fclose(fp);

        printf("%d bytes written successfully",sizeof(Stats));
        /*TROUBLE HERE! This isn't even printed. sizeof(Stats)=24 which I think is OK*/

        exit(EXIT_SUCCESS);
    }

    /*Parent*/
    else if ( pid > 0 )
    {

        // this is actually nessesary to ensure that the pipe properly closes
        close(pList[i].fd[1]);
        FILE* fp = fdopen(pList[i].fd[0], "r");

        if (!fread(&(pList[i].stats), sizeof(Stats), 1, fp)) {
            fprintf(stderr, "writer sent eof, but not enough data\n");
            return -1;
        }

        fclose(fp);

        printf("[p]Mín: %lf\n Max: %lf\nAverage: %lf\n",pList[i].stats.min,pList[i].stats.max,pList[i].stats.avg);
        /*Everything printed here  = 0.0000000000*/

        wait(0);

    }

    else /*fork error*/
            return -1;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T18:55:48.370

在终止子的情况下，执行 a`wait()`允许系统释放与子关联的资源；如果 a`wait()`没有被执行，那么被终止的孩子保持在“僵尸”状态。这是一种安全的做法，而且总是很好用。参考：`man -s2 wait`

系统`wait(NULL)`调用意味着，父进程将等待任何子进程（在您的情况下，它将等待刚刚分叉的子进程）并且不会存储您的子进程返回的状态。如果您想更好地控制等待，请查看：`man -s2 waitpid`. 基本上，`wait()`是`waitpid()`.

现在，管道部分。您正在子进程内创建一个管道。父进程如何访问它？实际上它是这样工作`if a pipe is created in a parent process, the pipe fd's will be copied to the child process.`的：不是相反。参考：`man -s2 pipe`

所以，在父进程中创建管道，然后发出a `fork()`，然后在子进程中使用管道fd发送给父进程。子进程现在可以`write()`将数据写入管道的 write fd，父代码现在可以写入`read()`子进程所写的内容。

您编写了一个从子到父的单向 IPC 通信。因此，您正在关闭子级中的读取 fd，并且您也正在关闭父级中的写入 fd。所以，这样你只能在孩子中写作，而只能在父母中阅读。逻辑正确执行。没有错误。

一旦解决了 pipe() 的逻辑问题（在父级中创建管道然后分叉），您的代码应该可以按预期工作。管道没有理由不适用于您编写的任何数据类型或结构。

# php - xdebug 永远不会在单行语句上停止

> ID：12940286
> 
> 赞同：3
> 
> 时间：2012-10-17T17:49:34.947
> 
> 标签：php, intellij-idea, xdebug, phpstorm

你们能告诉我为什么 xdebug 永远不会在单行语句上停止吗？我是 C++ 人，所以请原谅我的蹩脚问题。

我使用 PhpStorm 5.0.2 作为 IDE。我也在 Intellij IDEA Leda EAP 中尝试过。

考虑以下php代码

```
<?php
$d=date("D");
if ($d=="Fri")
{
    echo "Have a nice weekend!";
}
else
    echo "Have a nice day!";
?> 
```

如果我在第二个调试器上设置断点`echo`将永远不会停在那里。但是如果我用花括号括起来（比如 first 的情况`echo`），它会的。

这是非常不幸的行为，使调试复杂化。有可能以某种方式改变它吗？也许有一些秘密的 xdebug 设置？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-18T17:20:32.543

看起来这是xdebug中的一个错误。我在他们的错误跟踪系统中提交了它（[0000895 ）。](http://bugs.xdebug.org/view.php?id=895)如果您有任何意见，请添加您的意见。

xdebug 开发人员用注释*“这是 0000842 的副本 - 遗憾的是我无法修复它，因为它与 PHP 解释器如何将行号分配给生成的执行单元有关。”*

# java - 通过填充 html 页面字段在运行时创建 apk 文件

> ID：12940287
> 
> 赞同：2
> 
> 时间：2012-10-17T17:49:35.693
> 
> 标签：java, android, servlets, android-sdk-2.3

我想使用用户在 html 页面中填写的详细信息（如应用程序名称、应用程序背景图标和其他可绘制对象）在运行时创建一个 apk 文件。用户只需要填写所有详细信息并单击创建按钮将生成包含我已填写的所有数据的 apk 文件。

我有一个想法，将 Android SDK 保留在服务器上并在后端编译代码，当它完成后，我们会在页面上提供下载应用程序的选项。

但不知道如何实现它请帮助我。

他们正在做同样的[http://www.appsgeyser.com/create/start/](http://www.appsgeyser.com/create/start/)检查它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T18:02:40.867

**基础设施**

1.  VPS 或云托管服务器。有几个提供商，例如 Go Daddy 和 Rackspace。做你的研究，找到最适合你需求的。
2.  在您的 VPS / 云服务器上安装 Java、Android SDK 和您的应用服务器。

**代码**

1.  您需要有一个要构建的 Android 项目的模板。
2.  根据用户特定信息创建自定义源代码。
3.  运行一个 Ant 构建脚本来生成 APK，您还需要使用有效期为 50 年的密钥对其进行签名。这可以在 Ant 任务本身中进行配置。
4.  将 APK 复制到您的公共 HTML 文件夹，并向用户显示链接。

**以编程方式运行 Ant Build** [http://www.ibm.com/developerworks/websphere/library/techarticles/0502_gawor/0502_gawor.html](http://www.ibm.com/developerworks/websphere/library/techarticles/0502_gawor/0502_gawor.html)

[通过 Java 以编程方式运行 ANT](https://stackoverflow.com/questions/10035188/running-ant-programmatically-through-java)

**更新**

使用 Gradle，它更容易。

# css - 如何通过标签标识在 HTML 中制作出色的代码缩进

> ID：12940291
> 
> 赞同：0
> 
> 时间：2012-10-17T17:49:56.600
> 
> 标签：css, html, optimization

我有一个 Visual Basic 代码，我想把它放到我的网站上，但是当我在 WYSIWYG 编辑器中通过它时，我的标识消失了......那么将代码标识转换为 HTML 的正确方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T18:17:20.537

您应该使用一些语法高亮库进行网页显示。有很多，仅举一个例子：

[http://alexgorbatchev.com/SyntaxHighlighter/](http://alexgorbatchev.com/SyntaxHighlighter/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T18:56:35.907

快速而肮脏的方法是使用`<pre>`标签。您也可以应用于`white-space: pre`包含代码块的元素。这将保留您的空白（换行符、制表符、空格等）。

[http://css-tricks.com/almanac/properties/w/whitespace/](http://css-tricks.com/almanac/properties/w/whitespace/)

# java - executeQuery 仅适用于 mySQL 命令为大写时的查询？

> ID：12940292
> 
> 赞同：0
> 
> 时间：2012-10-17T17:49:59.430
> 
> 标签：java, mysql

我正在开发一个两层 java 应用程序，它基本上在 GUI 中的 JTable 中显示 mySQL 数据库结果。用户在 textArea 中键入 mySQL 查询，然后按下“执行命令”按钮，对应于该命令的 mySQL 结果简单地出现在 JTable 中。

我遇到的问题是当我尝试输入诸如“SELECT * FROM bikes WHERE COST=10000;”之类的查询时 一切都按预期工作并返回结果。但是，如果我输入“select * from bikes where cost=10000;”，则不会返回任何结果，并且基本上没有任何反应，甚至不会出现错误。我尝试在查询上运行“toUpperCase()”，但没有解决问题。

我想知道是什么导致了这个问题？我知道 mySQL 不区分大小写，所以即使我的 SELECT 是小写的，它也应该可以工作......下面的代码是可能导致问题的区域的片段。

```
public void setQuery(String query) throws SQLException, IllegalStateException{
        if(!connectedToDatabase)
            throw new IllegalStateException("Not Connected to Database");

        String firstWord = query.substring(0, 6);
        if(firstWord.toUpperCase().equals("SELECT")){           
            resultSet = statement.executeQuery(query);
        }
        else if(firstWord.toUpperCase().equals("INSERT") || firstWord.toUpperCase().equals("DELETE") || firstWord.toUpperCase().equals("UPDATE")){
            statement2.executeUpdate(query);
        }

        metaData = resultSet.getMetaData();

        resultSet.last();
        numberOfRows = resultSet.getRow();
        fireTableStructureChanged();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T17:57:35.457

*   尝试使用[equalsIgnoreCase](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#equalsIgnoreCase%28java.lang.String%29)而不是 straight `equals`。
*   如果您不知道代码是否进入了一个`if`块，请尝试在该块中添加一些日志记录。
*   假设它正在进入块，则查询可能会导致问题。

# php - 如何使用 preg_match() 使用 PHP 提取特定数据

> ID：12940298
> 
> 赞同：-2
> 
> 时间：2012-10-17T17:50:25.630
> 
> 标签：php, arrays, string, preg-match, file-get-contents

> **可能重复：**
> [如何使用 PHP 解析和处理 HTML？](https://stackoverflow.com/questions/3577641/how-to-parse-and-process-html-with-php)

**问题：**

仅使用 preg_match 从网页中提取第一个 <ul class="list"></ul> 并将其转储到数组中。

**代码：**

```
$str = file_get_contents('http://www.domain.com');
preg_match('#<ul class="list">(.*)</ul>#i', $str, $matches); 
```

**期望的目标：**

获取第一个 <ul> 并将其全部转储到一个数组中。< ul> 应该是父元素，里面的每个元素都应该是子元素。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T18:03:06.840

`preg_match`是一个字符串操作函数，对“子元素”一无所知，因此永远无法返回您希望的数组。

您需要使用能够为您解析 HTML 的库，例如[Simple HTML DOM](http://simplehtmldom.sourceforge.net/)或内置 DOM 库的[loadHTML 方法](http://uk1.php.net/manual/en/domdocument.loadhtml.php)。

[**编辑**- 上面的“从不”有点夸张：您可以稍加努力，编写自己的迷你解析器`preg_match`，但与使用 HTML 解析库相比，它不灵活且不可维护。]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T18:04:24.990

```
$str = file_get_contents('http://www.domain.com');
preg_match('~<ul class="list">(.*?)</ul>~si', $str, $matches); 
```

利用 。*? 匹配第一个和最接近的结束标签。如果你使用 .* 它会首先在页面上找到。我假设你的 UL 标签是正确的。

您还需要**si** *标志*，如**s = single-line**和**i = insensitive**。
否则，您的模式会在第一个 \n 上中断。

**PS**：*如果您的 UL 包含 UL 子项，您应该考虑使用**DOMDocument**和**DOMXPath**查询进行解析。对于更复杂的 HTML，它更安全。*

*希望能帮助到你。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T18:05:26.170

你想使用.+？或者，如果有多个，您可以获取的不仅仅是第一个 ul。

```
preg_match( '/<ul class="list">(.+?)<\/ul>/mis', $str, $match );

preg_match_all( '/<li>(.+?)<\/li>/mis', $match[1], $lis );

$answer = array ( 'ul' => $lis[1] ); 
```

我想这就是你要找的

# php - PHPCurl - 输出到 XML？

> ID：12940299
> 
> 赞同：0
> 
> 时间：2012-10-17T17:50:27.393
> 
> 标签：php, xml, curl, sitemap, web-crawler

我正在使用 PHPCurl 和 example.php 来自：[http ://phpcrawl.cuab.de/example.html](http://phpcrawl.cuab.de/example.html)

我想将生成的站点地图链接输出到 XML 文件。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-20T00:13:18.383

[您可以使用PHPCrawl](http://sourceforge.net/projects/phpcrawl/forums/forum/307696/topic/6037903/index/page/1)生成 sitemap.xml 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T14:11:49.330

如果你从 PHPcrawl 执行脚本得到的已经是 XML 代码，并且是你喜欢的格式，你只需将它写入一个文件，`fwrite`或者你喜欢的任何其他选项。

如果您获得的 XML 不是您想要的，您可以使用 wit`preg_replace`或任何其他类似工具对其进行处理。

您也可以使用 XSL 来处理 XML，生成另一个 XML，然后使用`fwrite`它来保存它。

# php - 对 CURDATE() 使用 DATETIME 的 SUM 查询

> ID：12940302
> 
> 赞同：0
> 
> 时间：2012-10-17T17:50:29.960
> 
> 标签：php, mysql

我无法做到这一点，而且我仍在使用连接，所以它可能是错误的。我有 3 个数据表和 1 个“汇总”表，其中充满了我提交的值 id。

我想总结 2 个不同表中的值 ID 列并将它们与当前日期和用户相关联。确实如此，但仅限于昨天？我需要它将查询更改为当天。我尝试将 CURDATE() 放在那里，但显然我做得不对。

```
SELECT U.user_name, SUM(T.cut_timetotal) AS sum_time, SUM(C.cuts_total) AS sum_cuts, DATE(S.submit_date ) AS date
FROM summary S
JOIN cut_info C ON S.cuts_id = C.cuts_id
JOIN users U ON U.user_id = S.user_id
JOIN timeT ON T.time_id = S.time_id
GROUP BY U.user_name 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T18:03:16.107

这应该提供您寻求的答案：

```
SELECT U.user_name, SUM(T.cut_timetotal) AS sum_time, SUM(C.cuts_total) AS sum_cuts, DATE(S.submit_date ) AS date
FROM summary S
JOIN cut_info C ON S.cuts_id = C.cuts_id
JOIN users U ON U.user_id = S.user_id
JOIN timeT ON T.time_id = S.time_id
WHERE S.submit_date BETWEEN CURDATE() AND CURDATE() + INTERVAL 1 DAY
GROUP BY U.user_name 
```

使用

```
S.submit_date BETWEEN CURDATE() AND CURDATE() + INTERVAL 1 DAY 
```

好于

```
DATE(S.submit_date) = CURDATE() 
```

因为前者将使用索引（如果找到），而后者则不会。

# javascript - 表单验证实际上并没有为整个表单的一个输入字段返回 false

> ID：12940304
> 
> 赞同：0
> 
> 时间：2012-10-17T17:50:33.853
> 
> 标签：javascript, regex, html, validation

所以我正在做一个表单验证项目。我们得到了一组输入必须满足的标准，我们必须使用正则表达式来检查所有内容。我已经把所有的东西都编码了，除了第一个输入之外，一切都很完美。它检查正则表达式，但如果匹配有任何问题，它将返回 true 而不是 false，并将窗口带到“接受表单”页面。

```
function validate_registration(){
    var RegExpName = /^[A-Z a-z]+$/;
    var RegExpCourseId = /^WEB*([1-9]{1})*[0-9]{2}$/;

    var studentName = document.reg_page.student_name.value;
    var courseID = document.reg_page.course_id.value;

    if (!RegExpName.test(studentName))
    {
        alert("Please enter the name on your Student ID");
        document.reg_page.s.focus();
        document.reg_page.s.select();
        return false;
    }

    else if (!RegExpCourseId.test(courseID))
    {
        alert("Please enter a valid Course ID");
        document.reg_page.c.focus();
        document.reg_page.c.select();
        return false;
    }
}

<div id="container">
<div id="page">
    <form name="reg_page" method="post" onSubmit="return validate_registration();"   action="thanks.htm" >
    <table id="form">
        <tr>
            <td colspan="2"><div id="table_title">Web Registration Form</div></td>
        </tr>
        <tr>
            <td class="label">Student Name:</td><td><input name="student_name" id="s" size="15" /></td>
        </tr>
        <tr>
            <td class="label">Course ID:</td><td><input name="course_id" id="c" size="10" /></td>
        </tr> 
```

这是 javascript 和表单的相关部分。课程 ID 区域完美运行。如果为空，则返回 false，并突出显示文本输入字段。为什么它不会对学生姓名做同样的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T20:02:19.827

我对此没有任何问题。我必须添加一个提交按钮，我显然没有thanks.htm 页面，但这里是JSFiddle：http: [//jsfiddle.net/BmLYD/3/](http://jsfiddle.net/BmLYD/3/)。我做了什么不同于你正在尝试的事情/你将代码放在哪里？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T20:02:24.143

本身并不是真正的答案，但由于 SO 在我有 50 个代表之前不允许我发表评论，这就是我必须处理的。

无论如何，您的代码在 Linux 上 Chromium 上的[JSFiddle中对我来说很好。](http://jsfiddle.net/BBtPP/4/)您能否发布有关您的目标系统的信息？你用的是什么浏览器和操作系统？您还可以澄清什么应该和不应该通过您的验证。我尝试遵循正则表达式（我对正则表达式的经验并不多），它看起来像它应该通过的一切，在这种情况下似乎是任何没有数字或符号的东西。

您可以尝试的另一件事是在尝试使用脚本后发布控制台日志，以查看是否有一些有用的信息来说明问题实际出在哪里。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T18:02:26.843

这是整个代码吗？！

此代码适用于我（FireFox）：

```
<!DOCTYPE html>
<html>
<head>
<script language="JavaScript">
<!--
function validate_registration(){
var RegExpName = /^[A-Z a-z]+$/;
var RegExpCourseId = /^WEB*([1-9]{1})*[0-9]{2}$/;

var studentName = document.reg_page.student_name.value;
var courseID = document.reg_page.course_id.value;

if (!RegExpName.test(studentName))
    {
        alert("Please enter the name on your Student ID");
        document.reg_page.s.focus();
        document.reg_page.s.select();
        return false;
    }

else if (!RegExpCourseId.test(courseID))
    {
        alert("Please enter a valid Course ID");
        document.reg_page.c.focus();
        document.reg_page.c.select();
        return false;
    }
}
//-->
</script>
</head>
<body>

    <form name="reg_page" method="post" onSubmit="return validate_registration();">
    <table id="form">
        <tr>
            <td colspan="2"><div id="table_title">Web Registration Form</div></td>
        </tr>
        <tr>
            <td class="label">Student Name:</td><td><input name="student_name" id="s" size="15" /></td>
        </tr>
        <tr>
            <td class="label">Course ID:</td><td><input name="course_id" id="c" size="10" /></td>
        </tr>
        <input type="submit" value="submit">
     </table>
     </form>
     </body>
     </html> 
```

您可能只是忘记关闭该功能吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-17T21:43:20.957

如果可以选择使用 jQuery，也许可以查看 jQuery 验证插件？ [http://docs.jquery.com/Plugins/Validation](http://docs.jquery.com/Plugins/Validation)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-10-17T19:01:47.717

我建议只使用两个 if 语句而不是 else if 语句，看看它的作用。

# html - 用于生成 HTML5 代码的框架/库

> ID：12940306
> 
> 赞同：0
> 
> 时间：2012-10-17T17:50:45.210
> 
> 标签：html

我有一个项目，我需要在其中创建一个支持 HTML5 内容的 WYSIWYG 编辑的应用程序。也就是说，一个工具，使您可以通过拖放对象（如文本、图像、编辑框、视频等）来直观地编辑页面，之后可以将该页面保存为 HTML5/javaScript 网页。

市场上当然有商业和免费工具可以做到这一点，但我需要创建自己的工具。

对从视觉布局到 HTML5 代码的整个转换进行编码显然是一项艰巨的任务。

我想知道是否有一个框架或类似的框架可以用来实际创建 HTML5 代码。也就是说，我的应用程序将处理编辑的视觉方面，调用此框架将生成 HTML5 代码。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T17:55:28.187

### 推特引导

这是我们在实验室中使用的应用程序，因为它是免费和开源的。你可以试试[**Twitter Bootstrap**](http://twitter.github.com/bootstrap/)、Sleek、直观且功能强大的前端框架，以更快、更轻松地进行 Web 开发。

### 从他们的网站：

> **Bootstrap**使用[LESS CSS](http://lesscss.org/)，通过[Node](http://nodejs.org/)编译，并通过[GitHub](http://github.com/)进行管理，以帮助书呆子在网络上做一些很棒的事情。Bootstrap 不仅在最新的桌面浏览器（以及 IE7！）中看起来和表现出色，而且通过[响应式 CSS](http://twitter.github.com/bootstrap/scaffolding.html#responsive)在平板电脑和智能手机浏览器中也表现出色。
> 
> 一个 12 列的响应式[网格](http://twitter.github.com/bootstrap/scaffolding.html#grid)、几十个组件、[javascript 插件](http://twitter.github.com/bootstrap/javascript.html)、排版、表单控件，甚至是一个[基于 Web 的定制](http://twitter.github.com/bootstrap/customize.html)器，让 Bootstrap 成为你自己的。

# android - 预加载 CursorAdapter 视图

> ID：12940307
> 
> 赞同：1
> 
> 时间：2012-10-17T17:50:50.717
> 
> 标签：android, simplecursoradapter

我正在使用 a`SimpleCursorAdapter`来填写列表。我正在回收我的视图并使用 a`ViewHolder`来快速加载，但问题是每个视图中都有一个需要下载的图像。该视图很像典型的 facebook 提要。即使我只需要一个非常低分辨率的图像，加载它仍然需要一段时间，显然......而且在此期间，显示回收视图的图像，我真的不喜欢。

我的问题是，有没有办法以任何方式预加载视图？该列表非常大，所以我真的不想下载和缓存所有图像。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-07T15:32:46.927

使用[ImageLoader](http://github.com/novoda/ImageLoader)！它使下载、显示和缓存远程图像变得容易。

# c# - 替换“\”的奇怪行为

> ID：12940313
> 
> 赞同：5
> 
> 时间：2012-10-17T17:51:25.533
> 
> 标签：c#

我有这个问题，其中我有一个字符串，除其他外，文字表达式`"\\"`多次出现，我想用 替换它`"\"`，当我尝试用 string.replace 替换它时，只替换第一次出现，如果我这样做使用正则表达式它根本不会替换它

我在网上咨询了一些 RegEx 测试人员，据说我的代码没问题，返回了我的意思，但我的代码根本不起作用

和`string.replace`

```
example = "\\\\url.com\\place\\anotherplace\\extraplace\\";

example = example.replace("\\\\","\\");

returns example == "\\url.com\\place\\anotherplace\\extraplace\\"; 
```

使用正则表达式

```
example = Regex.Replace(example,"\\\\","\\");

returns example = "\\\\url.com\\place\\anotherplace\\extraplace\\"; 
```

如果我使用文字也是同样的情况（在替换函数参数上使用`(@"\\", @"\")`给出与上面相同的结果）。

谢谢！

**编辑：**

我认为我的最终目标令人困惑，所以我会在这里更新它，我想做的是：

*输入：* 保存字符串的变量：`"\\\\url.com\\place\\anotherplace\\extraplace\\"`

*过程*

*保存字符串的输出* 变量`"\\url.com\place\anotherplace\extraplace\"` （因此我可以将其发送到 ffmpeg 并将其识别为有效路由）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-17T17:57:18.060

改变这个：

```
example = "\\\\url.com\\place\\anotherplace\\extraplace\\"; 
```

对此

```
example = @"\\\\url.com\\place\\anotherplace\\extraplace\\"; 
```

问题不在于`Regex.Replace`参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T18:01:38.640

您应该将其更改为以下

```
example = example.replace(@"\\", @"\"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-17T18:09:06.950

这似乎是预期的行为。

在 String.Replace 案例中：最初，示例包含一个以两个反斜杠开头的字符串，并在字符串的其他位置包含几个单个反斜杠。然后，您尝试用单个反斜杠替换所有出现的双反斜杠，这有效并生成了一个以单个反斜杠开头并在字符串的其他位置包含几个单反斜杠的字符串。

在 Regex.Replace 案例中：example 的原始内容在这种情况下无关紧要。您的正则表达式模式是双反斜杠，当解释为正则表达式模式时，表示“查找单个反斜杠”。然后用一个反斜杠替换此模式，这不会导致字符串发生任何变化。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-17T17:56:02.070

`\\\\`您的字符串中只有一次出现。所以它正在做你要求它做的事情。

不转义（即不添加额外的 /）

*   你的实际输入是什么？
*   你想要的输出是什么？

# c# - TPL 任务 + 动态 == OutOfMemoryException？

> ID：12940314
> 
> 赞同：4
> 
> 时间：2012-10-17T17:51:25.833
> 
> 标签：c#, dynamic, memory-leaks, task-parallel-library, expandoobject

我正在开发一个流式 Twitter 客户端 - 经过 1-2 天的持续运行后，我的内存使用量超过了 1.4gigs（32 位进程），并且在达到这个数量后不久，我就会内存不足本质上是这样的代码异常（此代码将在我的机器上的 <30 秒内出错）：

```
while (true)
{
  Task.Factory.StartNew(() =>
  {
    dynamic dyn2 = new ExpandoObject();

    //get a ton of text, make the string random 
    //enough to be be interned, for the most part
    dyn2.text = Get500kOfText() + Get500kOfText() + DateTime.Now.ToString() + 
      DateTime.Now.Millisecond.ToString(); 
  });
} 
```

我已经对其进行了分析，这绝对是由于 DLR 中的课程下降（从内存中 - 我在这里没有我的详细信息）xxRuntimeBinderxx 和 xxAggregatexx。

[这个来自 Eric Lippert (microsoft) 的回答](https://stackoverflow.com/questions/5212064/whats-the-memory-footprint-of-the-dlr)似乎表明我在幕后制作表达式解析对象，即使在我的代码中没有保留对任何内容的引用，也不会得到 GC。

如果是这种情况，上面的代码中是否有某种方法可以防止或减轻它？

我的后备是消除动态使用，但我不想这样做。

## 谢谢

**更新：**

**2012 年 12 月 14 日：**

*答案*：

让**这个特定示例**释放其任务的方法是 yield (Thread.Sleep(0))，这将允许 GC 处理释放的任务。我猜在这种特殊情况下不允许处理消息/事件循环。

*在我使用的实际代码*（TPL 数据流）中，***我没有***在块上调用 Complete()，因为它们是一个永无止境的数据流——只要 twitter 发送它们，该任务就会接收 Twitter 消息。在这个模型中，从来没有任何理由告诉任何块它们已经完成，因为只要应用程序正在运行，它们就永远**不会被完成。**

不幸的是，看起来 Dataflow 块从未被设计为长时间运行或处理无数项目，因为它们实际上保留了对发送到其中的所有内容的引用。如果我错了，请告诉我。

因此，解决方法是定期（根据您的内存使用情况——我的是每 10 万条推特消息）释放块并重新设置它们。

在这个方案下，我的内存消耗永远不会超过 80megs，并且在回收块并强制 GC 进行良好测量之后，gen2 堆又回到了 6megs，一切都恢复正常了。

**2012 年 10 月 17 日：**

*   *“这并没有做任何有用的事情”*：这个例子只是为了让你快速生成问题。它是从与问题无关的几百行代码中总结出来的。
*   “*创建任务并反过来创建对象的无限循环*”：请记住 - 这只是快速演示了问题 - 实际代码正坐在那里等待更多流数据。另外——查看代码——所有对象都是在任务中的 Action<> lambda 中创建的。为什么在超出范围后（最终）不对其进行清理？这个问题也不是因为做得太快——实际的代码需要一天多的时间才能到达内存不足的异常——这只是让它足够快地尝试一下。
*   *“任务能保证被释放吗？”* 对象就是对象，不是吗？我的理解是调度程序只是在池中使用线程，并且它正在执行的 lambda 在它完成运行后无论如何都会被丢弃。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T18:54:58.880

这与生产者远远领先于消费者有关，而不是 DLR。循环尽可能快地创建任务 - 并且任务不会“立即”启动。很容易弄清楚它可能落后多少：

```
 int count = 0;

        new Timer(_ => Console.WriteLine(count), 0, 0, 500);

        while (true)
        {
            Interlocked.Increment(ref count);

            Task.Factory.StartNew(() =>
            {
                dynamic dyn2 = new ExpandoObject();
                dyn2.text = Get500kOfText() + Get500kOfText() + DateTime.Now.ToString() +
                  DateTime.Now.Millisecond.ToString();

                Interlocked.Decrement(ref count);
            });
        } 
```

输出：

```
324080
751802
1074713
1620403
1997559
2431238 
```

这对于 3 秒的调度来说是很多的。删除`Task.Factory.StartNew`（单线程执行）会产生稳定的内存。

不过，您给出的复制品似乎有点做作。如果太多并发任务确实是您的问题，您可以尝试使用[限制并发调度的自定义任务调度程序](http://msdn.microsoft.com/en-us/library/ee789351.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T20:28:24.417

这里的问题不在于您正在创建的任务没有被清理。 [Asti](https://stackoverflow.com/a/12941321/1159478)已经证明您的代码创建任务的速度比处理它们的速度要快，因此当您清理已完成任务的内存时，您最终仍然会用完。

你说过：

> 在这个例子中放置战略睡眠仍然会产生内存不足异常——它只需要更长的时间

您没有显示此代码或任何其他限制并发任务数量的示例。我的猜测是，你在某种程度上限制了创造，但创造的速度仍然快于消费的速度。这是我自己的有限示例：

```
int numConcurrentActions = 100000;
BlockingCollection<Task> tasks = new BlockingCollection<Task>();

Action someAction = () =>
{
    dynamic dyn = new System.Dynamic.ExpandoObject();

    dyn.text = Get500kOfText() + Get500kOfText() 
        + DateTime.Now.ToString() + DateTime.Now.Millisecond.ToString();
};

//add a fixed number of tasks
for (int i = 0; i < numConcurrentActions; i++)
{
    tasks.Add(new Task(someAction));
}

//take a task out, set a continuation to add a new one when it finishes, 
//and then start the task.
foreach (Task t in tasks.GetConsumingEnumerable())
{
    t.ContinueWith(_ =>
    {
        tasks.Add(new Task(someAction));
    });
    t.Start();
} 
```

此代码将确保任何时候运行的任务不超过 100,000 个。当我运行它时，内存是稳定的（当平均数秒时）。它通过创建一个固定数量来限制任务，然后设置一个延续以在现有任务完成时安排新任务。

因此，这告诉我们的是，由于您的*真实*数据基于来自某个外部来源的提要，因此您从该提要获取数据的速度比您处理它的速度要快得多。您在这里有几个选择。您可以在项目进入时对其进行排队，确保当前只能运行有限数量，并在超出容量时丢弃请求（或找到其他过滤输入的方法，以免全部处理） ，或者您可以只获得更好的硬件（或优化您拥有的处理方法），以便您能够比创建请求更快地处理请求。

虽然通常我会说人们倾向于在代码已经“足够快”运行时尝试优化代码，但这显然不是你的情况。您需要达到一个相当严格的基准；你需要比它们进来的速度更快地处理项目。目前你没有达到那个基准（但是因为它在失败之前运行了一段时间，你不应该*那么*远）。

# ios - 除了 Crittercism 之外，以自己的方式处理 iOS 异常

> ID：12940316
> 
> 赞同：3
> 
> 时间：2012-10-17T17:51:32.943
> 
> 标签：ios, exception-handling, crittercism

我有一个已经在使用 Crittercism 的 ios 应用程序。它完美地报告了异常。

我的问题是我还希望将这些异常记录到我的后端服务器。

我已经尝试了很多事情来实现它，但无济于事。以下是我尝试过的事情的清单：

*   称呼 `NSSetUncaughtExceptionHandler(&myExceptionHandler);`

如果我这样做，Crittercism 中不会报告异常。

*   称呼 `NSSetUncaughtExceptionHandler(&myExceptionHandler);`

将异常发送到我的服务器。然后在function中调用Crittercism的构造`myExceptionHandler`函数，重新抛出异常。不工作。

*   `NSSetUncaughtExceptionHandler(&myExceptionHandler);`在`myExceptionHandler`call之后调用 Crittercism 的构造函数`[Crittercism logHandledException:exception];`。也不行。

*   在我的异常处理程序中，序列化异常对象并将其存储在用户首选项中。当用户重新启动应用程序时，调用`[Crittercism logHandledException:exception];`然后将异常发送到我的后端服务器。问题是，我无法将字符串反序列化为异常对象。我无法将堆栈跟踪以`NSString`形式放入我的异常对象中。

我本可以尝试的一些事情：

*   让 crittercism 处理异常，然后在下次重新启动时，`crittercismDidCrashOnLastLoad`将被调用 - 但是我是否有异常信息，或者我可以从某个地方访问它。

*   我可能不需要将字符串反序列化为异常对象。我相信 Crittercism 还将异常更改为 json 对象并将此 json 对象发送到其服务器。但我无法找出用于将自定义 json 对象发送到 crittercism 的函数。

有人可以指导我如何进行吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T07:09:18.650

我已经找到了解决方案。首先使用初始化 crittercism 对象

```
[Crittercism initWithAppID:crittercismAppID andKey:crittercismKey andSecret:crittercismSecret]; 
```

现在定义

```
NSUncaughtExceptionHandler* crittercismHandler = NSGetUncaughtExceptionHandler();//You have stored the reference to the crittercism function that was going to get called in the event of an exception 
```

然后，

```
NSSetUncaughtExceptionHandler(&myHandledException);//Set the handler to your custom function 
```

在您的自定义函数中，对异常执行任何操作，然后调用

```
NSSetUncaughtExceptionHandler(crittercismHandler);//this will re-set the exception handler to the one of crittercism 
```

称呼

```
crittercismHandler(exception);//This will send the exception to crittercism servers. 
```

你可以对信号做类似的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-18T01:16:46.743

您可以像我们一样管理自己的异常处理。此页面有一个示例项目的链接 [http://www.cocoawithlove.com/2010/05/handling-unhandled-exceptions-and.html](http://www.cocoawithlove.com/2010/05/handling-unhandled-exceptions-and.html)

这也很有帮助 [从另一个线程打印堆栈跟踪](https://stackoverflow.com/questions/4765158/printing-a-stack-trace-from-another-thread)

# validation - 在 express/connect 中重新填充表单值

> ID：12940317
> 
> 赞同：0
> 
> 时间：2012-10-17T17:51:33.070
> 
> 标签：validation, node.js, express, connect, pug

我刚刚启动了一个新的 nodejs 应用程序，其中将包含大量用于创建和编辑/更新数据库值的表单。我的问题是：如果给定的数据无效，我该如何重新填充表单条目？

示例：有人尝试登录。如果凭据错误，我将使用以下内容再次显示登录页面：

```
res.render('sessions/new') 
```

问题是，用户名没有填充请求数据。我想知道如何既简单又干净地做到这一点。由于没有`form_for`类似的rails，我想我必须手动实现，对吧？我的第一种方法是绕过请求正文/参数作为`render`函数的本地变量，并在我的翡翠模板中设置值，如下所示：

```
// In controller/route
res.render('sessions/new', req.body)

// In template
input(type='text', name='username', value=locals.username) 
```

有没有更好或更不显眼的解决方案？我的意思是上面的例子很有效并且很容易实现，只是想知道我是否遗漏了什么。这对于向无效表单字段添加错误类等内容也很有趣。在网上真的找不到任何东西。

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-12-16T11:46:08.217

我使用[连接闪存](https://www.npmjs.com/package/connect-flash)中间件。通常，此模块用于提供信息性消息（成功、错误等），但它也适用于跨请求持久化表单数据。

POST 表单数据时：

```
router.post('/create-user', function(res, req, next) {
  // Do stuff
  if (invalid) {
    req.flash('form', req.body);
    res.redirect('/create-user');
  }
}); 
```

然后在 GET 方面：

```
router.get('/create-user', function(res, req, next) {
  // Render the template with form data
  res.render('my_template', {
    form: req.flash('form')[0] || null
  });
}); 
```

然后在`my_template.hbs`（我使用把手）：

```
<form>
  <input type="email" name="email" value="{{form.email}}">
  <input type="name" name="name" value="{{form.name}}">
  ...
</form> 
```

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T18:41:12.180

我在客户端使用 jQuery 进行操作。

我使用 express-validator 生成错误映射，其中包含字段名称、原始值和错误消息。

然后我只是在页面底部的布局模板上打印内部脚本标签，然后在 jQuery 中检查它是否为空并循环遍历错误堆栈。将字段标记为错误并显示原始值和错误消息。

这是快速验证器代码：

路线：

```
 req.assert('username', 'Enter username').notEmpty();
  req.assert('password', 'Enter password').notEmpty();
  res.locals.errors = req.validationErrors(true);
  res.render('/login'); 
```

看法：

```
<p>
 <label>Username</label>
 <input name="username" />
</p>

<script>var errors = <%= errors %>;</script> 
```

客户端javascript（jQuery）：

```
 for ( var e in errors ) {
        var $field = $('[name='+e+']'),
        $el = $field.parents('p');

        $el.addClass('err');
        $el.append('<span class="msg">'+errors[e].msg+'</span>');
    } 
```

另一种方法是在你的视图中做一堆 if/else 和 echo 语句，这会变得非常丑陋，非常快。

# c# - 与可选参数值的一致性

> ID：12940319
> 
> 赞同：5
> 
> 时间：2012-10-17T17:51:41.967
> 
> 标签：c#, .net, coding-style, optional-parameters

一段时间以来，我一直在使用 .NET 4 以有限的方式使用可选参数。我最近思考了可选参数是如何实现的，我突然想到了一些东西。

举个例子：

```
public interface ITest
{
    void Go(string val = "Interface");
} 
```

实现这一点的唯一要求是实现最大形式的签名`void Go (string val)`，实际上我们不需要实现可选参数，因为编译器会处理该连接（尽管使用可选参数的选项在使用时不可用直接的具体类）。

话虽如此，为了在两个地方都提供功能，并使其在实现中可发现，可以在接口和实现中实现可选声明。事实上，生产力工具 ReSharper 会在实现接口时自动将此可选声明拉到具体类型。这似乎是合乎逻辑的事情。然而...

是什么阻止我们在具体类型和接口中使用不同的值？这在今天早上敲响了我的警钟，好像有人进去更改该值，却忘记将其保留在覆盖/接口的继​​承中，行为将完全不同，具体取决于您访问对象的方式。调试起来可能非常令人沮丧。

试试这个 LINQpad 脚本：

```
void Main()
{
    IA iface = new A();
    A cls = new A();

    iface.Go();
    cls.Go();
}

interface IA
{
    void Go(string val = "Interface");
}

class A : IA
{
    public void Go(string val = "Class") { val.Dump(); }
} 
```

输出将是：

```
Interface
Class 
```

这让我想到了我的实际问题：

## 问题：

我们可以用什么（如果有的话？）方法来保护它，而不会失去使用具体类中的可选参数变体的能力，因此它对编码器来说是可发现/可读的？

有没有人遇到过这个问题？你是怎么解决的？是否有任何最佳实践可以帮助防止这个问题在多开发人员大规模代码库中变得普遍？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T18:30:23.797

没有什么能阻止你这样做。使用可选参数将值烘焙到方法调用中。因此，正如您所看到的，调用`IA.Go()`并`A.Go()`为您提供不同的值，因为它们被编译为`IA.Go("Interface")`和`A.Go("Class")`.

绕过它的方法（意味着在实现中只提供“默认”参数）是有一个*重载*而不是可选参数：

```
interface IA
{
    void Go();
    void Go(string val);
}

public class A : IA
{
    public void Go()
    {
        Go("Class");
    }
    public void Go(string val) { val.Dump(); }
} 
```

其他一些选项：

*   添加一个检查该条件的单元测试。但是，您必须为每个实现都这样做。
*   研究创建[自定义代码分析规则](http://blogs.msdn.com/b/codeanalysis/archive/2010/03/26/how-to-write-custom-static-code-analysis-rules-and-integrate-them-into-visual-studio-2010.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T18:24:41.113

我认为这是 C# 的本质，你必须忍受它。看下面的例子。在没有可选参数的情况下是否相同，即行为因您访问对象的方式而异。

```
class Program
{
    static void Main(string[] args)
    {
        IA iface = new A();
        A cls = new A();

        iface.Test();
        cls.Test();

        Console.ReadKey();
    }
}

interface IA
{
    void Test();
}

class A : IA
{
    public void Test()
    {
        Console.WriteLine("Class");
    }

    void IA.Test()
    {
        Console.WriteLine("Interface");
    }
} 
```

# xml - 由于 XML 请求无效，Magento 中的支付交易失败

> ID：12940328
> 
> 赞同：0
> 
> 时间：2012-10-17T17:52:23.863
> 
> 标签：xml, magento, request, payment

当用户尝试在我的网站上下订单时，我收到此错误。它偶尔会发生一次。

付款交易失败。原因 您提交了无效的 XML 请求。请验证您的请求并重试交易。结帐类型 onepage

```
> exception 'Mage_Core_Exception' with message 'You submitted an invalid
> XML request. Please verify your request and retry the transaction.' in
> /var/www/vhosts/domain.ca/httpdocs/app/Mage.php:594 Stack trace:
> #0 /var/www/vhosts/domain.ca/httpdocs/app/code/local/Mage/Optimalpayments/Model/PaymentMethod.php(161):
> Mage::throwException('You submitted a...')
> #1 /var/www/vhosts/domain.ca/httpdocs/app/code/core/Mage/Sales/Model/Order/Payment.php(408):
> Mage_Optimalpayments_Model_PaymentMethod->capture(Object(Mage_Sales_Model_Order_Payment),
> '175.14')
> #2 /var/www/vhosts/domain.ca/httpdocs/app/code/core/Mage/Sales/Model/Order/Invoice.php(385):
> Mage_Sales_Model_Order_Payment->capture(Object(Mage_Sales_Model_Order_Invoice))
> #3 /var/www/vhosts/domain.ca/httpdocs/app/code/core/Mage/Sales/Model/Order/Payment.php(569):
> Mage_Sales_Model_Order_Invoice->capture()
> #4 /var/www/vhosts/domain.ca/httpdocs/app/code/core/Mage/Sales/Model/Order/Payment.php(375):
> Mage_Sales_Model_Order_Payment->_invoice()
> #5 /var/www/vhosts/domain.ca/httpdocs/app/code/core/Mage/Sales/Model/Order/Payment.php(317):
> Mage_Sales_Model_Order_Payment->capture(NULL)
> #6 /var/www/vhosts/domain.ca/httpdocs/app/code/core/Mage/Sales/Model/Order.php(877):
> Mage_Sales_Model_Order_Payment->place()
> #7 /var/www/vhosts/domain.ca/httpdocs/app/code/core/Mage/Sales/Model/Order.php(1095):
> Mage_Sales_Model_Order->_placePayment()
> #8 [internal function]: Mage_Sales_Model_Order->place()
> #9 /var/www/vhosts/domain.ca/httpdocs/app/code/core/Mage/Core/Model/Resource/Transaction.php(105):
> call_user_func(Array)
> #10 /var/www/vhosts/domain.ca/httpdocs/app/code/core/Mage/Core/Model/Resource/Transaction.php(159):
> Mage_Core_Model_Resource_Transaction->_runCallbacks()
> #11 /var/www/vhosts/domain.ca/httpdocs/app/code/core/Mage/Sales/Model/Service/Quote.php(189):
> Mage_Core_Model_Resource_Transaction->save()
> #12 /var/www/vhosts/domain.ca/httpdocs/app/code/core/Mage/Sales/Model/Service/Quote.php(249):
> Mage_Sales_Model_Service_Quote->submitOrder()
> #13 /var/www/vhosts/domain.ca/httpdocs/app/code/core/Mage/Checkout/Model/Type/Onepage.php(774):
> Mage_Sales_Model_Service_Quote->submitAll()
> #14 /var/www/vhosts/domain.ca/httpdocs/app/code/core/Mage/Checkout/controllers/OnepageController.php(511):
> Mage_Checkout_Model_Type_Onepage->saveOrder()
> #15 /var/www/vhosts/domain.ca/httpdocs/app/code/core/Mage/Core/Controller/Varien/Action.php(419):
> Mage_Checkout_OnepageController->saveOrderAction()
> #16 /var/www/vhosts/domain.ca/httpdocs/app/code/core/Mage/Core/Controller/Varien/Router/Standard.php(250):
> Mage_Core_Controller_Varien_Action->dispatch('saveOrder')
> #17 /var/www/vhosts/domain.ca/httpdocs/app/code/core/Mage/Core/Controller/Varien/Front.php(176):
> Mage_Core_Controller_Varien_Router_Standard->match(Object(Mage_Core_Controller_Request_Http))
> #18 /var/www/vhosts/domain.ca/httpdocs/app/code/core/Mage/Core/Model/App.php(354):
> Mage_Core_Controller_Varien_Front->dispatch()
> #19 /var/www/vhosts/domain.ca/httpdocs/app/Mage.php(683): Mage_Core_Model_App->run(Array)
> #20 /var/www/vhosts/domain.ca/httpdocs/index.php(71): Mage::run('', 'store')
> #21 {main} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T18:17:23.277

看起来您用于最优支付的第 3 方支付处理模块`Mage_Optimalpayments`（看看行`161`中的代码

```
app/code/local/Mage/Optimalpayments/Model/PaymentMethod.php 
```

这将告诉您为什么 Magento 模块认为它收到了无效的 XML。您可以从那里进一步调试。我会联系模块开发人员寻求支持。

# android - Android推送通知-如何获取设备ID

> ID：12940333
> 
> 赞同：6
> 
> 时间：2012-10-17T17:52:37.773
> 
> 标签：android, google-cloud-messaging

我被困在使用 Google 的云通知创建推送通知的过程中。

我正在处理的是我应该获取设备的设备 ID 的部分，以便我以后可以在需要发送推送通知时使用该设备 ID。

所以我有这个代码：

```
 GCMRegistrar.checkDevice(this);
    GCMRegistrar.checkManifest(this);

    final String regId = GCMRegistrar.getRegistrationId(this);
    if (regId.equals("")) 
    {
        GCMRegistrar.register(this, SENDER_ID);
    } 
    else 
    {
        //Log.v(TAG, "Already registered");
    } 
```

我认为这条线

```
final String regId = GCMRegistrar.getRegistrationId(this); 
```

打算给我设备ID，以便我可以将其存储在某个地方。但我认为我在这实际上是如何工作的方面偏离了轨道。有人可以向我解释如何获取设备的唯一 ID，以便我可以将其存储以用于进一步的推送通知吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-17T17:56:03.037

设备的“唯一 ID”实际上是基于设备和应用安装的唯一 ID。将为您提供该`GCMRegistrar.getRegistrationId(context)`唯一 ID。如果您希望在注册后获取它，它会被传递到 GCMIntentService 的 onRegistered 方法中，您必须覆盖该方法才能使其工作。

# jquery - JQuery.Ajax() 成功 json

> ID：12940335
> 
> 赞同：0
> 
> 时间：2012-10-17T17:52:48.320
> 
> 标签：jquery, ajax, json

我对我的 jquery 函数的成功有疑问。

这是js中的脚本

```
$.ajax({
    type: "POST",
    url: "filtra.php",
    dataType: 'json', 
    data: "livello:"+ liv+"&materia:"+mat,
    success: function (data) {
        for ( var x = 0; x < data.length; x++ ) {
            content = data[x].ID;
    alert(content);
    }
    }
}); 
```

这是php页面。

```
<?php
    if (isset($_POST['livello']) && isset($_POST['materia']) && isset($_POST['keyword'])) {
        $liv=$_POST['livello'];
        $mat=$_POST['materia'];
        $keyw=$_POST['keyword'];
        $dsn = "mysql:host=localhost;dbname=db";
        $username = "root";
        $password = "";
        $rows=array();
        try{
            $pdo = new PDO($dsn, $username,'');}
        catch(PDOException $e) {
            echo 'Attenzione: '.$e->getMessage();}
        $str="SELECT * FROM quesito";
        if($liv!="Tutte"){$str.=" WHERE '$liv'=Livello ";}
        if($mat!="Tutte" && $liv!="Tutte"){$str.="AND '$mat'=Materia ";}
        else if($mat!="Tutte" && $liv=="Tutte") {$str.=" WHERE'$mat'=Materia ";}
        $sql = $pdo->prepare($str);
        $sql->execute(); 
        $res = $sql->fetchAll();    
        echo json_encode($res);
        }
?> 
```

没有任何回报..感谢您的回复。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T17:53:59.377

你错过了`echo`

```
echo json_encode($res); 
```

编辑：和拼写错误`encode`

# autohotkey - Autohotkey，如何不消耗被按下的键？

> ID：12940337
> 
> 赞同：19
> 
> 时间：2012-10-17T17:52:49.623
> 
> 标签：autohotkey

在 Autohotkey 中，我希望按下的键能够达到其原始目的，同时执行一些附加功能。

例如，在按下“^a”时，我希望“^a”能够正常工作（例如全选），然后是`send`另一个“单词”。

我试图重复按下的键，即以下内容：

```
^a::
send, ^a
send, word
return 
```

但是，如果我再次发送触发键 (^a)，该函数将变为“递归”并且永远不会结束。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-10-17T18:44:59.017

```
$~^a:: 
```

~ 将在代码执行时传递 ^a 代码，因此您甚至不需要重复发送，^a。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-17T18:14:09.503

我是 Autohotkey 初学者，但我认为您使用“$”符号。

```
$^a::
send, ^a
send, word
return 
```

> 这通常仅在脚本使用发送命令发送组成热键本身的键时才需要，否则可能会导致它自己触发。

热键（鼠标、操纵杆和键盘快捷键） > 介绍和简单示例 > 您可以使用以下 > 通常只有

[http://www.autohotkey.com/docs/Hotkeys.htm](http://www.autohotkey.com/docs/Hotkeys.htm)

# php - 数组转换以存储在数据库中的数组中

> ID：12940340
> 
> 赞同：-3
> 
> 时间：2012-10-17T17:52:58.733
> 
> 标签：php, mysql

> **可能重复：**
> [如何将数组存储到 mysql 中？](https://stackoverflow.com/questions/3413291/how-to-store-an-array-into-mysql)

这是我需要存储在数据库中的数组：-

```
$v=array(
"Image"=> array (
                 0=> array (
                                "id"=> 150,
                                "Tags"=> array(
                                                0=> array ( "id"=> 200, "text"=>"John Doe", "left"=> 250, "top"=> 50, "url"=> "person.php?id=200" ,"isDeleteEnable"=> true ),
                                                1=> array ( "id"=> 400, "text"=> "Michael Smith", "left"=> 420, "top"=> 45, "width"=> 120, "height"=> 120, "isDeleteEnable"=> true ),
                                                2=> array ( "id"=> 500, "text"=> "Peter Parker" ,"left"=> 55 ,"top"=> 40, "url"=> "person.php?id=500" ,"isDeleteEnable"=> false )
                                                )
                            )

                   )       

    ) ; 
```

是否有任何功能可以做到这一点，以便整个数组可以存储在数据库中。我正在 LAMP 上开发。我还需要从数据库中再次检索这个数组。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T17:56:21.103

看一下[`serialize()`](http://php.net/manual/en/function.serialize.php)

```
$db = serialize($v); 
```

而且，当然，[`unserialize()`](http://php.net/manual/en/function.serialize.php)要恢复它。

[工作演示](http://ideone.com/MMYoR)（使用您提供的数据）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T17:56:26.033

你有几个选择。最值得注意的是，您可以对其进行[序列化](http://php.net/manual/en/function.serialize.php)并将序列化的字符串存储在数据库中，然后用于`unserialize`将字符串转回数组。这是最直接的答案。

另一种选择是设置您的数据库以准确支持您正在执行的操作，方法是拥有一个`image`带有字段“id”的表，以及`imagetag` 带有字段`imageid`和字段的表，以及带有字段和字段的`tagid`表。`tag``id``text`

此选项更加模块化，并且由您的数据库管理系统更好地管理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T18:02:17.627

```
$string = serialize($v);
$v = unserialize($string); 
```

# database - 以 root 以外的其他用户身份运行 Linux 应用程序

> ID：12940341
> 
> 赞同：0
> 
> 时间：2012-10-17T17:52:58.507
> 
> 标签：database, linux, linux-kernel, embedded

我想以另一个用户身份运行 linux 应用程序（Other 然后是 root ）。在我的应用程序中，我们编写了套接字程序，并且我正在使用原始套接字来 ping 数据库服务器。当我们以 root 身份运行应用程序时，它可以 ping 服务器。但是当它以除 root 以外的普通用户身份运行时，它无法 ping 数据库服务器。

你能告诉我如何用普通用户运行这个过程吗？我们如何检查进程与哪个用户一起运行？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T17:57:19.933

采用：

```
sudo -u <username> <command ...> 
```

您可以通过以下方式查看有关您的流程的信息（其中包括所有者的用户名）：

```
ps -Af | grep <process name> 
```

此外，非 root 程序不能使用原始套接字。这表明您的程序设计存在缺陷。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T18:04:22.273

正如 Wug 已经回答的那样，使用“sudo”以不同的用户身份运行（如果在 sudoers 中允许）。如果您想查看哪个用户拥有该进程，您可以使用不同的工具：如“top”或“ps aux”等

# r - 我可以在 R 中写入和访问内存中的文件吗？

> ID：12940343
> 
> 赞同：4
> 
> 时间：2012-10-17T17:53:00.280
> 
> 标签：r

我正在为导入 xml 文件的 R 函数编写测试，`settings.xml`.

目前，当我为依赖于内容的函数编写测试时`foo.xml`，包括`read.settings`以下示例中的函数：

```
writeLines("<fee><fi><\fi>\fee>", con = "/tmp/foo.xml")
settings <- read.settings("/tmp/foo.xml")
file.remove("/tmp/foo.xml") 
```

但是出现了一些与使测试系统独立相关的问题。例如，`/tmp/`可能无法写入或`read.settings()`在测试目录中留下孤立文件时出错等。这是一个简单的例子，我可以想办法解决这些问题，但我记得在回答上一个问题时有这样的解决方案，我现在找不到，其中`con`不是文件而是内存中的对象。我确信在很多情况下不实际写入文件会很有用。

*   有没有办法写入和访问只存在于内存中的伪文件？
*   该功能记录在哪里？
    `?connections`似乎是一个很好的线索，但我不清楚如何使用提供的信息

作为跟进（但不要太开放）

*   除了我上面描述的之外，这种功能的主要用途是什么？
*   在哪些情况下不应该使用此功能？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-17T18:16:20.997

这是一个可能有用的构造。`tempfile()`为任何操作系统上的临时文件返回一个有效名称，并且调用`on.exit(unlink())`确保临时文件被删除，无论发生什么其他情况。

```
test1 <- function() {
    temp <- tempfile()
    on.exit(unlink(temp))
    writeLines("<fee><fi><\fi>\fee>", con = temp)
    settings <- readLines(temp)
    settings
}

test1()
# [1] "<fee><fi><\fi>\fee>" 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-17T18:07:20.133

您可以使用 将任何字符串转换为连接`textConnection`。

```
xml.txt <- '<fee><fi><\fi>\fee>'
con <- textConnection(xml.txt)
settings <- read.settings(con) 
```

我发现字符串连接在连接函数对您正在做的事情很方便的情况下很有用，但是所涉及的任务将导致磁盘上的文件长时间处于打开状态。您可以将文本连接用作缓冲区。

请注意，`seek`在读取文本连接的内容后，您不能使用文件连接的方式重置文本连接的位置。

# java - HashMap 的两个实例之间的区别 和 HashMap 的一个实例 其中 Object 包含两个字符串

> ID：12940344
> 
> 赞同：2
> 
> 时间：2012-10-17T17:53:01.327
> 
> 标签：java, hashmap

为简单起见，假设我有两个实例`HashMap<String, String>`，它们共享相同的键。我想知道的是，这与将这两个`String`值表示为 an`Object`并将它们存储在`HashMap<String, Object>`.

我的实际问题使用了一个实例`HashMap<String, HashSet<String>>`和两个实例，`HashMap<String, Double>`我希望通过整合它们，我会以某种方式节省内存，但我不确定使用自定义`Object`对象与本机对象是否会对性能产生影响喜欢`HashSet`或`Double`作为价值观。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-17T17:56:12.133

哈希是根据字符串计算的，因此不会影响速度。从长远来看，空间影响（非常轻微的增加）将可以忽略不计。如果它使代码更清晰，那就去做并提高性能（只要我们不是在谈论巨大的性能瓶颈，没关系）。

**速度**

对于速度影响，请记住在 a`HashMap<String, ?>`中，`String`是被散列的内容。实际上，您可能会看到速度略有提高，因为与 3 次查找相比，您只需进行一次查找即可找到您的自定义对象。

**空间**

对于空间影响，请记住`HashMap`使用大小为 2 次方的内部数组。如果您只`HashMap`使用没有特殊设置（如自定义负载因子）的 vanilla，那么您可能会看到空间略有增加，因为现在您有（粗略，当然，这只是简化了）：

```
HashSet<String>[]
Double[]
Double[] 
```

组合起来之后，你将拥有

```
CustomObject[]
    HashSet<String>
    Double
    Double 
```

这是忽略不随地图增长的恒定大小信息。对象占用的空间不仅仅是对其字段的引用，但不是很多。

**易读性**

自定义对象选项赢得了这一点。它更干净而且非常面向对象编程，非常非常适合 Java。无论性能如何，您都应该这样做。从长远来看，它会看起来更好并且更易于维护。

例如，如果您想向自定义对象添加字段，这很容易。但是拥有单独的地图意味着为更多的变量创建更多的地图，这是肮脏的。我说走 OOP 方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T17:58:12.133

如果要组合它们，请创建一个类来表示它们并拥有它们的映射：

```
public class Stuff {
    String a;
    String b;
    // other fields - maybe the double you mentioned
}

HashMap<String, MyStuff> map; 
```

这肯定会节省内存，因为您将拥有更少的地图条目。

但是，无论如何，这是正确的方法。设计时间不是担心微小的性能和内存影响的时候。让你的代码易于阅读和使用，你的生活（和代码）会更好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T17:58:57.857

除非您要处理大量条目，否则差异（如果有）可能并不重要。它还将与平台密切相关（JVM 版本、Java 库版本等），因此您唯一有用的答案将来自针对每种不同方式运行的分析器。

您可能会考虑查看[Guava Multimap](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Multimap.html)。这可能是解决您问题的更清洁的方法。如果做不到这一点，我会使用自定义对象。代码清晰每次都会战胜过早的优化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-17T18:00:34.447

通过组合表格，您可能会在很多方面做得更好。Speedwise，您只需要计算哈希并遍历哈希链一次而不是两次。对于空间，您只需要一个哈希表而不是两个（如果您的负载因子约为 50%，则每个条目节省大约 8 个字节）和一个哈希链而不是两个（每个条目保存一个哈希链对象大约 16 个字节）。您支付了 pair 对象的成本，但最多 16 个字节。

# button - Excel VBA滚动条向左或向右移动工作表

> ID：12940348
> 
> 赞同：1
> 
> 时间：2012-10-17T17:53:13.553
> 
> 标签：button, excel, activex, scrollbar, vba

请求：使用 VBA 或 ActiveX 滚动条向左或向右移动工作表的迷你滚动条的 VBA 代码？

我创建了一个培训师技能矩阵，其中列出了培训师姓名（在单元格“B7”到“B86”中）和技能学科列在顶部（在单元格 E6 到“AJ6”中）。在培训师姓名和技能相交的地方，我有一个下拉列表，其中“Y”表示有技能，“N”没有技能，“n\a”。如果该技能不适合该培训师。我已经冻结了标题行（在单元格 E6 到“AJ6”中）和培训师姓名（在单元格“B7”到“B86”中）以便于交叉引用

我想添加一个“迷你”水平滚动条（位于单元格 A4:B4 中），其行为与主 excel 工作表滚动条完全相同（即向左或向右移动工作表）。我已经尝试了超过 4 小时的 ActiveX 滚动条和“谷歌搜索”解决方案，但没有成功。专家 VBA 程序员或 Excel 大师能否提出解决方案或发布一些示例代码？干杯！！

[我的培训师技能矩阵的屏幕截图](http://i.stack.imgur.com/jVPkM.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T18:17:49.953

请在工作表选择更改上输入以下代码

```
Me.ScrollBar1.Value = ActiveWindow.ScrollColumn - 4 
```

请调整要滚动的列以适应活动窗口，然后调整滚动条1的最大滚动值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T20:01:52.027

对于 ActiveX 滚动条：

```
'in the sheet code module
Private Sub ScrollBar1_Change()
    ActiveWindow.ScrollColumn = 4 + Me.ScrollBar1.Value
End Sub

Private Sub ScrollBar1_Scroll()
    ActiveWindow.ScrollColumn = 4 + Me.ScrollBar1.Value
End Sub 
```

将滚动条最小值设置为 1，将最大值设置为您拥有的列数...

编辑：如果您希望滚动条与列一起移动，那么您可以在`Change`事件中执行类似的操作（但如果将其添加到`Scroll`事件中，它将产生一些奇怪的结果：

```
Private Sub ScrollBar1_Change()
    Dim sc As Long
    sc = 4 + Me.ScrollBar1.Value
    ActiveWindow.ScrollColumn = sc
    Me.ScrollBar1.Left = Me.Cells(1, sc).Left
End Sub 
```

但是 - 如果您随后手动移动工作表（通过箭头键等），那么滚动条将移出视图，并且没有 sheet_scroll 事件可用于重新定位滚动条。

# vb.net - Excel 文件上的 conn.GetSchema("Tables") 不返回工作表

> ID：12940349
> 
> 赞同：0
> 
> 时间：2012-10-17T17:53:14.253
> 
> 标签：vb.net, excel, ado.net, oledb, getschematable

我正在将我的应用程序从 Windows 窗体更改为 Windows 服务。

conn.GetSchema("Tables") 在两个代码库中的工作方式不同。

在新的代码库中，我无法返回 Excel 工作表。conn.GetSchema("Tables").Rows.Count 是 0。我已经仔细检查了所有的引用，没有什么不同。我在我的代码中找不到我认为会产生这种效果的任何其他差异。有什么想法，我还能寻找什么？

这是我的全部功能（是的，我知道我应该使用 For Each）：

```
Private Function GetWorksheets(FileName As String) As String()

    Dim rv As List(Of String)
    Dim conn = New OleDb.OleDbConnection("provider=Microsoft.Jet.OLEDB.4.0;data source=" & FileName & ";Extended Properties=Excel 8.0;")

    conn.Open()
    For x As Integer = 0 To conn.GetSchema("Tables").Rows.Count - 1
        rv.Add(conn.GetSchema("Tables").Rows(x)("TABLE_NAME"))
    Next x
    conn.Close()
    Return rv.ToArray

End Function 
```

谢谢，布拉德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T18:08:09.883

您需要包含 Web 服务器的路径 (System.Web.HttpContext.Current.Server.MapPath)，因此请尝试将“conn”分配替换为以下内容：

```
Dim conn = New OleDb.OleDbConnection("provider=Microsoft.Jet.OLEDB.4.0;data source=" &  System.Web.HttpContext.Current.Server.MapPath(FileName) & ";Extended Properties=Excel 8.0;") 
```

# sql - PLSQL：如何将动态 SQL 查询结果保存到二维数组中？

> ID：12940351
> 
> 赞同：0
> 
> 时间：2012-10-17T17:53:27.593
> 
> 标签：sql, arrays, oracle, dynamic, plsql

```
CREATE TYPE VarArray AS VARRAY(50) OF VARCHAR2(50);

CREATE TYPE VarAArray AS VARRAY(50) OF VarArray;

Declare
   myTable VarAArray VarAArray();
   tableName Varchar2(50);
Begin
  -- I want to save the data in the table of 'tableName' 
  -- into the myTable array, all the field values are 
  -- saved as varchar2 type
End; 
```

这样做的关键要求是通过行号和列 id 获取任何字段值。请随时提供更好的设计选择。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T18:56:23.333

如果您想获得表中数据的 XML 表示，请查看[dbms_xmlgen](http://docs.oracle.com/cd/E11882_01/appdev.112/e25788/d_xmlgen.htm#i1012053)包。例如，您可以编写一个像这样的简单函数：

```
SQL> create or replace function GenXML(p_query in varchar2, p_RSetTag in varchar2)
  2  return clob
  3  is
  4    l_xmlcntx dbms_xmlgen.ctxHandle;
  5    l_resxml clob;
  6  begin
  7    l_xmlcntx := dbms_xmlgen.newContext(p_query);
  8    dbms_xmlgen.setRowSetTag(l_xmlcntx,  p_RSetTag);
  9    l_resxml := dbms_xmlgen.getXML(l_xmlcntx);
 10    dbms_xmlgen.closeContext(l_xmlcntx);
 11    return l_resxml;
 12  end;
 13  /

Function created 
```

然后通过将查询传递给表和行集标记作为参数来使用它，如下所示。

```
SQL> select genxml('select * from employees where rownum = 1','EMPLOYEES') as XmlData
  2    from dual
  3  ;

XMLDATA
--------------------------------------------------------------------------------
<?xml version="1.0"?>
<EMPLOYEES>
 <ROW>
  <EMPLOYEE_ID>100</EMPLOYEE_ID>
  <FIRST_NAME>100</FIRST_NAME>
  <LAST_NAME>King</LAST_NAME>
  <EMAIL>SKING</EMAIL>
  <PHONE_NUMBER>515.123.4567</PHONE_NUMBER>
  <HIRE_DATE>17-JUN-03</HIRE_DATE>
  <JOB_ID>AD_PRES</JOB_ID>
  <SALARY>24000</SALARY>
  <DEPARTMENT_ID>90</DEPARTMENT_ID>
 </ROW>
</EMPLOYEES>

SQL> 
```

* * *

**对评论的回应**

要显示主从类型的数据结构，您可以使用`cursor`. 例如：

```
SQL> select genxml('select department_id
  2       , department_name
  3       , cursor(
  4                 select first_name
  5                   from employees t
  6                  where t.department_id = d.department_id
  7           ) employees
  8    from departments d
  9    where rownum = 1','DEPARTMENTS') xmldata
 10    from dual
 11  ;

XMLDATA
--------------------------------------------------------------------------------
<?xml version="1.0"?>
<DEPARTMENTS>
 <ROW>
  <DEPARTMENT_ID>10</DEPARTMENT_ID>
  <DEPARTMENT_NAME>Administration</DEPARTMENT_NAME>
  <EMPLOYEES>
   <EMPLOYEES_ROW>
    <FIRST_NAME>Jennifer</FIRST_NAME>
   </EMPLOYEES_ROW>
  </EMPLOYEES>
 </ROW>
</DEPARTMENTS> 
```

**更新**#2 回应评论：

为了在“detail”（光标）为空的情况下消除剩余的开始和结束标签，让我们重写我们的查询如下，例如：

```
SELECT XMLElement("DEPARTMENTS"
                 , XMLAgg( XMLElement( "ROW"
                                     , XMLForest( t.department_id
                                                , t.department_name
                                                )
                                     , (
                                         SELECT XMLAgg(XMLElement("EMPLOYEES"
                                                                 , XMLForest (q.first_name)
                                                                  )
                                                        )
                                           FROM employees q
                                          WHERE q.department_id = t.department_id
                                            --and 100=101
                                        )
                                     )
                          )
                 ) 
```

为了更好地控制标签。并将上述查询的结果存储在一个文件中，如下所示：在运行以下代码之前，必须创建一个目录：`Create directory <name> as <path>`. 如果您的目录而不是`XMLDIR`.

```
declare
  l_xml clob;

begin
  SELECT XMLElement("DEPARTMENTS"
                 , XMLAgg( XMLElement( "ROW"
                                     , XMLForest( t.department_id
                                                , t.department_name
                                                )
                                     , (
                                         SELECT XMLAgg(XMLElement("EMPLOYEES"
                                                                 , XMLForest (q.first_name)
                                                                  )
                                                        )
                                           FROM employees q
                                          WHERE q.department_id = t.department_id
                                            --and 100=101
                                        )
                                     )
                          )
                 ).getclobval() into l_xml
  FROM departments t
  where rownum < 3;

  dbms_xslprocessor.clob2file(l_xml, 'XMLDIR', 'XmlFile.xml');

end; 
```

**结果#1**：当子查询返回数据时

```
 <DEPARTMENTS>
  <ROW>
    <DEPARTMENT_ID>10</DEPARTMENT_ID> 
    <DEPARTMENT_NAME>Administration</DEPARTMENT_NAME> 
    <EMPLOYEES>
      <FIRST_NAME>Jennifer</FIRST_NAME> 
    </EMPLOYEES>
  </ROW>
  <ROW>
    <DEPARTMENT_ID>20</DEPARTMENT_ID> 
    <DEPARTMENT_NAME>Marketing</DEPARTMENT_NAME> 
    <EMPLOYEES>
      <FIRST_NAME>Michael</FIRST_NAME> 
    </EMPLOYEES>
    <EMPLOYEES>
      <FIRST_NAME>Pat</FIRST_NAME> 
    </EMPLOYEES>
  </ROW>
 </DEPARTMENTS> 
```

**结果#2**：当子查询没有返回数据时

```
<DEPARTMENTS>
  <ROW>
    <DEPARTMENT_ID>10</DEPARTMENT_ID> 
    <DEPARTMENT_NAME>Administration</DEPARTMENT_NAME> 
  </ROW>
  <ROW>
    <DEPARTMENT_ID>20</DEPARTMENT_ID> 
    <DEPARTMENT_NAME>Marketing</DEPARTMENT_NAME> 
  </ROW>
  </DEPARTMENTS> 
```

# jquery - 多子菜单在jquery中无法正常工作

> ID：12940355
> 
> 赞同：0
> 
> 时间：2012-10-17T17:53:31.060
> 
> 标签：jquery, css

创建了一个带有多子菜单的菜单，但现在子菜单和子多菜单没有正确隐藏，任何人都可以帮助解决这个问题。当我将鼠标悬停在一个显示子菜单的列表上时，但是当我将鼠标悬停在该一个或子多菜单上时，它必须隐藏。

现在我的逻辑是需要创建子菜单

[小提琴链接在这里](http://jsfiddle.net/RHVDT/19/)

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T19:30:30.247

我有点糊涂了，根据我过去所做的，这就是我想出的

[http://jsfiddle.net/Mutmatt/RHVDT/31/](http://jsfiddle.net/Mutmatt/RHVDT/31/)

:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T18:13:59.557

如果您愿意使用插件，请考虑使用 jdMenu 或类似的 jQuery 插件：http: [//jdsharp.us/jQuery/plugins/jdMenu/](http://jdsharp.us/jQuery/plugins/jdMenu/)

`.submenu2`如果没有，请调整您的代码以在鼠标移出相关联时隐藏`.submenu`：

```
$('.submenu').mouseout(function () {
  $('.submenu2').hide(); 
  $('.submenu').hide(); 
}); 
```

如果你这样做，还要调整你的 CSS 以便用户可以导航到`.submenu2`而不触发`mouseout`事件 on `.submenu`，这将隐藏`.submenu2`他们试图导航到的。

可以在此处找到对您的小提琴的小幅编辑（添加`$('.submenu2').hide()`并调整 CSS ）：http: [//jsfiddle.net/Palpatim/RHVDT/21/](http://jsfiddle.net/Palpatim/RHVDT/21/)`.submenu2`

# javascript - AutoSuggest field2 基于 field1 选择

> ID：12940356
> 
> 赞同：0
> 
> 时间：2012-10-17T17:53:32.830
> 
> 标签：javascript, jquery, jquery-ui, autocomplete

JS 对我来说还是有点不自然。我可以阅读它*，*但写它是我很少有机会做的事情。

我有这个表格（简体）

```
<form>
    <div class="form_element">
        <label for="co">Cust Company:</label>    
        <input type="text" name="co" value="" id="co" />
    </div>
    <div class="form_element">
        <label for="contact">Cust Name:</label>
        <input type="text" name="contact" value="" id="contact" />
    </div>
</form> 
```

我的自动完成功能对于`#co`输入来说工作得很好，但我可以使用一些指导来让下一步工作。
我需要根据选择自动建议`#contact`输入的名称`#co`。

我的 JS 目前看起来像这样

```
<script type="text/javascript">
    $('input#co').autocomplete({
        minLength: 2,
        source: function( request, response1 ) {
            url_1 = 'company/get_names/'+ request.term +'/name/json'
            $.getJSON(url_1, function(companies) {
                response1(companies);
            });
        },
        select: function(event, company){
            $('input#co' ).val( company.item.value );

            //alert(company.item.id);   // For testing
            url_2 = 'contact/persons_list/'+ company.item.id +'/json'

            $('input#contact').autocomplete({
                source: function( request, response2 ) {
                    $.getJSON(url_2, function(people) {  
                        response2(people);
                    });
                }
            })
        }    
    });
</script> 
```

`#contact`一旦为输入选择了值/建议，如何获取人员/联系人的建议列表以显示`#co`输入？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T20:24:31.603

嗯......我最终采取了完全不同的方法，我认为这比我的第一个思路要好得多***。***

```
<script type="text/javascript">      

    var co_id;

    $('input#co').autocomplete({
        minLength: 2,
        source: function( request, response ) {
            url = 'company/get_names/'+ request.term +'/name/json',
            $.getJSON(url, function(companies) {
                response(companies);
            });
        },
        select: function(event, company){
            $('input#co' ).val( company.item.value );
            co_id = company.item.id;
        }
    });

    $('input#contact').autocomplete({
        //minLength: 2,
        source: function( request, response ) {
            url = 'contact/persons_list/'+co_id+'/json',
            $.getJSON(url, function(companies) {
                response(companies);
            });
        }
    });

</script> 
```

效果很好！

# javascript - Rails 关于控制器/视图特定 javascript 的最佳实践

> ID：12940359
> 
> 赞同：4
> 
> 时间：2012-10-17T17:53:38.890
> 
> 标签：javascript, ruby-on-rails, asset-pipeline

对于 Rails 3+ 和资产管道，我的理解是 assets/javascripts 下的所有 javascript 文件都会自动包含并编译到一个 js 文件中，如果您指定

```
require_tree . 
```

在 application.js 中。

处理特定于控制器/视图的 javascript 的最佳实践是什么？例如，假设我有一个控制器/视图“房屋”，并且我想使用 jquery 表单验证插件来验证房屋表单，为此我将以下代码放在了我的 house.js 文件中

```
$(document).ready(function(){
  $("#new_house_form").validate();
}); 
```

这很好，但问题是当我访问另一个页面（比如 /owners）时，它会尝试验证房屋表格，并且我在 javascript 控制台中收到一条错误消息。当然，我可以检查表单是否存在于当前页面上，然后才调用验证器，但这对我来说似乎有点不干净，尤其是如果我在 .ready 中有很多控制器特定的代码。

我的解决方案是在 application.js 中创建一个文件夹 assets/javascripts/global

```
 require_tree ./global //instead of require_tree . 
```

并移动除其中的houses.js 之外的所有其他js 文件。然后，每当用户访问 /houses/new 或 /houses/edit 时，我都会手动包含 house.js

这种做法是否可以接受？如果不是，那么处理这些情况的最佳做法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T18:48:12.227

通常我只是让所有的js都被加载并在调用任何方法之前检查元素是否存在。

```
$(document).ready(function(){
  if($("#new_house_form").length > 0){
    $("#new_house_form").validate();
  }
}); 
```

# objective-c - 异常断点捕获的 UIDocumentInteractionController 崩溃

> ID：12940361
> 
> 赞同：0
> 
> 时间：2012-10-17T17:53:55.677
> 
> 标签：objective-c, ios, exception, breakpoints, uidocumentinteraction

我正在使用 UIDocumentInteractionController 来预览 pdf 文件。我显示控制器如下：

```
self.docInteractionController = [UIDocumentInteractionController interactionControllerWithURL:pdfUrl];
    self.docInteractionController.delegate = self;
    self.docInteractionController.name = literature.title;
    [self.docInteractionController presentPreviewAnimated:YES]; 
```

这一切都是一种享受。但是，如果我向 Xcode 添加一个 Exception Breakpoint catch-all 并调试应用程序，那么我会注意到在我与 pdf 文档交互时发生了很多崩溃。该应用程序并没有完全崩溃，但是每当我点击文档时都会触发异常断点。

我需要担心这种行为吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T18:18:41.850

如果您没有保留 UIDocumentInteractionController 对象，那么您将看到崩溃。尽量保留 self.docInteractionController。我也遇到了同样的问题，这解决了它。

# iphone - TestFlight 反馈页面在 iPhone 5 上没有一直延伸

> ID：12940366
> 
> 赞同：1
> 
> 时间：2012-10-17T17:54:16.767
> 
> 标签：iphone, objective-c, ios, feedback, testflight

我们使用的是最新的 TestFligth SDK (1.1)，但反馈页面在 iPhone 5 屏幕上并没有一直延伸，并且与在 iPhone 4 屏幕上的大小保持一致。任何人都知道为什么会发生这种情况以及如何解决它？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-18T18:56:30.517

我收到了 TestFlight 团队的回复，他们还没有修复 iPhone 5 屏幕尺寸的反馈页面，以防有人需要知道。您可以创建自己的表单并使用 submitCustomFeedback。

# mongodb - MongoDB 中的 100 万个文档 1.4 GB 内存

> ID：12940369
> 
> 赞同：0
> 
> 时间：2012-10-17T17:54:32.600
> 
> 标签：mongodb, database

> **可能重复：**
> [是否可以减少 MongoDB 内存使用量？](https://stackoverflow.com/questions/5018200/is-it-possible-to-reduce-the-mongodb-memory-usage)

我的 DB .bson 大小 - 1.53 Gb（约 100 万份文档）；我的记忆 - 1.4 Gb

```
mongorestore --db database --collection doc /doc.bson 
```

它被添加到数据库中，225,358 个文档开始出现错误：file /var/lib/mongodb/database.3 open/create failed in createPrivateMap（查看日志以获取更多信息）代码：13636 3ms

是否有可能以某种方式启动具有这么多内存的数据库大小？可以以某种方式逐片插入（.bson）吗？

# c# - 我应该使用工厂模式吗？

> ID：12940375
> 
> 赞同：1
> 
> 时间：2012-10-17T17:54:56.093
> 
> 标签：c#, design-patterns

我目前有一个名为 ConfigProfile 工厂的类，它包含用于说默认配置文件、当前设置等的方法。我的个人资料服务在内部使用此类。我在想最好把它变成一个真正的工厂，然后为我们正在配置的每个产品创建适当的 Profile Service。

```
 public string GetDefaultProfile(string product)
    {
        if (string.IsNullOrEmpty(product))
        {
            throw new ArgumentNullException("product");
        }

        string profile = null;

        if (product.Contains("Product 1", StringComparison.CurrentCultureIgnoreCase) ||
            product.Contains("product1", StringComparison.CurrentCultureIgnoreCase))
        {
            profile = Resources.product1DefaultProfile;
        }

        return profile;
    } 
```

那只是一种产品，但我们还有更多产品，这意味着我必须为每个产品添加更多 if 语句。配置文件服务已经有一个接口，并且是我的大部分程序使用的。还有几种方法使用这种相同的做事方式。那么根据产品名称返回适当配置文件服务的工厂会是更好的解决方案，还是我可以做其他事情？

编辑：这是此类中较简单的方法之一。更复杂的一种是从所需位置检索当前系统设置的一种。像所有产品一样都有 IIS 设置，但有些产品支持主题，而另一些产品则需要数据库配置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-18T07:24:43.393

工厂是一个很好的解决方案。它允许您将配置复杂性隐藏在一个简单的界面后面。

如果您需要能够在运行时/启动时对其进行配置，请结合 Strategy。

两种解决方案——静态工厂或策略——都可以与原型相结合。如果您经常使用相同的配置文件并且它是只读的，那么原型作为优化将很有用。

编辑：您可能已经在使用原型。您的示例代码看起来像是在复制/引用配置文件，而不是将其构建为复杂的产品。

# python - python中的坏字符正则表达式

> ID：12940389
> 
> 赞同：0
> 
> 时间：2012-10-17T17:55:59.937
> 
> 标签：python, regex

我有一个字符串

```
1563:37say: 0 kl4|us: !!alias kl4 
```

我需要提取一些信息。我正在尝试使用此 Python 代码：

```
 import re
 x = "1563:37say: 0 kl4us: !!alias kl4"
 res = re.search( r"(?P<say>say(team)?): (?P<id>\d+) (?P<name>\w+): (?P<text>.*)",x)

 slot= res.group("id")
 text = res.group("text")
 say = res.group("say")
 name = res.group("name") 
```

这段代码工作正常。为什么如果我有一个字符`|`或`*`在我的字符串中，这个正则表达式不起作用？

例如：

```
 import re
 x = "1563:37say: 0 kl4|us: !!alias kl4"
 res = re.search( r"(?P<say>say(team)?): (?P<id>\d+) (?P<name>\w+): (?P<text>.*)",x)

 slot= res.group("id")
 text = res.group("text")
 say = res.group("say")
 name = res.group("name") 
```

任何人都可以帮助我吗？

非常感谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-17T17:58:55.490

根据您添加“|”的位置，看起来您期望“|” 和“*”匹配`\w`，但`\w`只匹配字母、数字和“_”。要匹配这些字符，请将其更改`\w`为`[\w|*]`：

```
res = re.search( r"(?P<say>say(team)?): (?P<id>\d+) (?P<name>[\w|*]+): (?P<text>.*)",x) 
```

# solr - Solr 架构策略

> ID：12940392
> 
> 赞同：2
> 
> 时间：2012-10-17T17:56:04.253
> 
> 标签：solr

我们正在创建一个娱乐网站，我们希望能够搜索活动、餐厅和酒吧、电影、艺术和戏剧以及电视/广播。

所有这些显然都有与之相关的不同领域。

餐厅将具有以下字段：名称、地址、类别、描述

一部电影将具有以下字段：名称、剧院名称、剧院地址、时间、描述

艺术与戏剧：名称、地址、场地名称

我应该将所有这些存储在同一个索引中吗？您如何建议共享公共字段并为每种内容类型创建唯一字段？

有时这会被单独搜索，而其他时候它们可能会一起搜索。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T18:14:25.000

这是关于单个索引和多个索引之间的一些权衡的帖子。

*   [Solr 组合索引与单一索引](http://khaidoan.wikidot.com/solr-combined-versus-single-index)
*   [多个索引](http://wiki.apache.org/solr/MultipleIndexes)
*   [多种文档类型](http://searchhub.org/dev/2011/02/12/solr-powered-isfdb-part-4/)

根据您为字段显示的内容，我建议您使用通用字段`name, address, description`，然后根据需要为每种类型使用其他特定字段。关于附加字段，如果您不想预先定义所有附加字段，则可以利用[动态字段的强大功能。](http://wiki.apache.org/solr/SchemaXml#Dynamic_fields)

```
 <dynamicField name="theater_*" type="string" indexed="true" stored="true" /> 
```

# php - 最后在 php yii 中插入 Id

> ID：12940393
> 
> 赞同：1
> 
> 时间：2012-10-17T17:56:10.620
> 
> 标签：php, pdo, yii

我想澄清我对以下命令的理解：

```
Yii::app()->db->getLastInsertId() ; 
```

它是否检索此特定用户或连接的最后插入？在 Yii 中，如果我使用 Yii::app()->db 进行数据库连接，它不会干扰其他用户吗？

此命令是检索特定用户的最后插入 id 还是检索与用户无关的最新插入。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-17T18:15:24.900

`Yii::app()->db->getLastInsertId()`使用函数`last_insert_id`。这是指使用当前数据库连接创建的最后一个 ID。生成的 ID 依赖于连接在服务器中维护。这意味着返回值将是该请求的最新语句。该值不会受到其他请求的影响。

# python - 将修改后的 Beautiful Soup 树写入文件，同时保持原始 XML 格式

> ID：12940395
> 
> 赞同：4
> 
> 时间：2012-10-17T17:56:12.570
> 
> 标签：python, xml, xml-parsing, beautifulsoup

我们有一个 XML 文档，其中包含我们希望更改的标签：

`...<version>1.0</version>...`

它深埋在 XML 文件中，但我们成功地使用 Beautiful Soup 将其内容替换为命令行参数。

问题是在修改树之后，我们需要写回我们从中读取它的文件。*但是*，我们希望保持文档的原始格式。当我使用：

```
fileForWriting = open(myXmlFile, 'w')
fileForWriting.write(soup.prettify()) 
```

该`prettify()`调用破坏了格式，我最终得到：

```
<version>
 1.0
</version> 
```

有没有办法在替换单个标记文本的同时保持 XML 文档的原始格式？

**注意：**简单地使用：

`fileForWriting.write(str(soup))`

将文本和标签保持在同一行，但消除了为便于阅读而人工添加的缩进和额外换行符。关闭，但没有雪茄。

**根据要求，整个脚本：**

```
from BeautifulSoup import BeautifulSoup as bs

import sys

xmlFile = sys.argv[1:][0]
version = sys.argv[1:][1]

fileForReading = open(xmlFile, 'r')
xmlString = fileForReading.read()
fileForReading.close()

soup = bs(xmlString)

soup.findAll('version')[1].contents[0].replaceWith(version)

fileForWriting = open(xmlFile, 'w')
fileForWriting.write(str(soup))
fileForWriting.close() 
```

然后使用以下命令运行该脚本：

`python myscript.py someFile.xml 1.2`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T18:47:20.503

如果您使用`xml.elementtree`，则该方法仅将**CRLF**`tree.write(file)`替换为LF **，**这在尝试将 XML 文件导入 ie **PyXB**时也会产生问题。

 ******我找到的解决方案是使用**ElementTree**来查找我必须替换的内容。然后我做`source_XML = 'new value'.join(source_XML.split('what you need to replace))`最后一个`file.write(source_XML)`

这不好，但它解决了问题。但是，我不介意压痕，所以我真的不能说。我只会`pprint.pprint()`在需要打印时使用。******

# javascript - javascript 未定义的变量/数组

> ID：12940401
> 
> 赞同：1
> 
> 时间：2012-10-17T17:56:26.333
> 
> 标签：javascript, jquery, arrays

我有一个小函数，它采用带有 url 的文本框的动态列表并将其发送到服务器。我正在尝试将 url 加载到数组中，然后将它们传递到 JSON 对象中。问题是，当我到达代码中的那一点时，我不断收到错误：

```
TypeError: url_data[this_url] is undefined
http://localhost/2011/admin/public/assets/js/tssol.ui.js
Line 196 
```

这是返回该错误的块：

```
$("#dialogEditor").dialog('option', 'buttons', {'Save' : function() {
    /* Define variables */
    var url_data = new Array();
    var this_url = 0;

    /* I've tried this with and without explicitly passing the vars... */
    $("#website_editor input").each(function(url_data, this_url) {
        var id =$(this).attr('name').match(/\d+/);
        var url=$(this).val();

        /* Test the varible each iteration */
        console.log("this_url: " + this_url + " id: " + id + " url: " + url);

    /* Line 196 */ url_data[this_url].id = id;
        url_data[this_url].url = url;

        this_url++;
});

data = JSON.stringify(url_data);
//data = url_data;
//console.log(data);

$.ajax({
    url: 'ajax.websites.php',
    dataType: 'json',
    data: {
        action: "update_resort",
        ResortId: resort,
        data: data
    }
});

$(this).dialog("close");
},
'Cancel': function(){$(this).dialog("close");
}});
}, 
```

抱歉格式化

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T18:00:28.530

我会这样做：

```
url_data[this_url] = {
    id: id,
    url: url
} 
```

# java - Android - onTouchListener ClassCastException

> ID：12940404
> 
> 赞同：0
> 
> 时间：2012-10-17T17:56:49.483
> 
> 标签：java, android, classcastexception, ontouchlistener, viewswitcher

我想使用 viewSwitcher 在两种布局之间切换。它可以使用按钮，但我想通过触摸屏幕进行切换。我找到了一个 onTouchListener 示例，我试图实现某种类似的，但我没能做到。

在我的 main.xml 中，我得到了一个包含 ViewSwitcher 和另外两个 LinearLayout 的线性布局。这些是我想要切换的布局。

这里是：

```
<ViewSwitcher
    android:id="@+id/viewSwitcher"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:inAnimation="@android:anim/slide_in_left"
    android:outAnimation="@android:anim/slide_out_right" >

    <LinearLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/firstlayout"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:background="@drawable/bg"
        android:orientation="vertical" >

        <ImageView
            android:id="@+id/title"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:src="@drawable/titlebar" />

        <Button
            android:id="@+id/somebut"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center"
            android:layout_marginTop="30px"
            android:background="@drawable/but" />
    </LinearLayout>

    <LinearLayout
        android:id="@+id/secondlayout"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" >

        <TextView
            android:id="@+id/text"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Second layout" >
        </TextView>
    </LinearLayout>
</ViewSwitcher> 
```

和我的代码：

```
import android.app.Activity;
import android.os.Bundle;
import android.view.MotionEvent;
import android.view.View;
import android.view.View.OnTouchListener;
import android.widget.LinearLayout;
import android.widget.ViewSwitcher;

public class SwitcherActivity extends Activity {
private float downXValue;
private View firstView;
private View SecondView;
private ViewSwitcher vs;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    vs =   (ViewSwitcher)findViewById(R.id.viewSwitcher);
    firstView= findViewById(R.id.firstlayout);
    secondView = findViewById(R.id.secondlayout);
    LinearLayout first = (LinearLayout) findViewById(R.id.firstlayout);
    first.setOnTouchListener((OnTouchListener) this);

}
public boolean onTouch(View arg0, MotionEvent arg1) {

    switch (arg1.getAction()){
        case MotionEvent.ACTION_DOWN:{
            // store the X value when the user's finger was pressed down
            downXValue = arg1.getX();
            break;
        }
        case MotionEvent.ACTION_UP:{
            // Get the X value when the user released his/her finger
            float currentX = arg1.getX();            
            // going backwards: pushing stuff to the right
            if (downXValue < currentX)
            {
                if (vs.getCurrentView() != myFirstView)vs.showPrevious();      
            }
            // going forwards: pushing stuff to the left
            if (downXValue > currentX)
            {
                if (vs.getCurrentView() != mySecondView)
                      vs.showNext();
            }
            break;
        }
    }
    return true;
}
} 
```

我的问题是，我在包含以下内容的行中得到了 ClassCastException：

```
 first.setOnTouchListener((OnTouchListener) this); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T18:06:28.123

您的活动必须实现 OnTouchListener 以便“this”可以用作侦听器。现在它正试图将一个 Activity 投射到一个 OnTouchListener 上，这就是抛出 ClassCastException 的原因。

您还需要重写 OnTouchListener 方法来自定义处理触摸的方式。

# javascript - 在 JavaScript 中同步模糊和点击事件

> ID：12940405
> 
> 赞同：4
> 
> 时间：2012-10-17T17:56:55.860
> 
> 标签：javascript, events, onclick, synchronization, onblur

我发现很难同步模糊和点击事件。场景如下：我有一个页面，其中有一个文本框和一个按钮。现在我有一个文本框的模糊事件处理程序，它基本上发出 AJAX 请求并更新页面的某些部分。此外，我还有一个用于执行其他工作的按钮的单击处理程序。

现在这里的问题是，由于我在文本框中有一个模糊事件处理程序，当我在文本框中输入内容并直接单击按钮时，它会触发模糊和单击事件（如预期的那样）。问题在于同步两者，因为单击处理程序仅应在模糊处理程序返回后执行（如果有任何模糊事件）。

示例代码如下：

```
 $('#textbox').on('blur', function(){
//make an ajax request
});

$('#btn').on('click',function(){
//wait for the blur event to finish(if any) 
// then execute the code
}) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T18:44:27.217

ianpgall 的代码有所改进：

```
var functionsToCall = [];
var ajaxRunning = false;

$(document).ready(function(){
    $('#textbox').on('blur', function(){
        ajaxRunning = true;
        console.log("START AJAX REQUEST");
        $.ajax({
            url: "/echo/json/",
            complete: function () {
                setTimeout(function () {    // Simulate AJAX request taking 2 seconds
                    console.log("AJAX REQUEST COMPLETE");
                    ajaxRunning = false;
                    fireStackedCalls();
                }, 5000);
            }
        });
    })

    $('#btn').on('click',function(){
        if(ajaxRunning === true) {
            functionsToCall.push('clickFunction()');
        } else {
            clickFunction();
        }
    });

    function fireStackedCalls() {
        while(functionsToCall.length > 0) {
            toCall = functionsToCall.pop();
            eval(toCall);
        }
    }

    function clickFunction() {
        console.log("EXECUTING CLICK FUNCTION");

        // Put your actual click code here
    }
}); 
```

现在，如果 ajax 请求完成，clickFunction 的每次调用都会被记录并执行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-17T18:17:22.480

尝试这样的事情：

[http://jsfiddle.net/8m7j5/2/](http://jsfiddle.net/8m7j5/2/)

```
var blurring = [];
var expecting = false;

$(document).ready(function () {
    $('#textbox').on('blur', function () {
        // make an ajax request

        console.log("TEXTBOX BLURRED");

        blurring.push(1);    // Flag a new blur event

        $.ajax({
            url: "/echo/json/",
            complete: function () {
                setTimeout(function () {    // Simulate AJAX request taking 2 seconds
                    console.log("AJAX REQUEST COMPLETE");
                    blurring.pop();    // Flag completed blur event
                    checkClick();
                }, 2000);
            }
        });
    });

    $('#btn').on('click', function () {
        // wait for the blur event to finish(if any)
        // then execute the code

        console.log("ACTUALLY CLICKED BUTTON");

        expecting = true;
        checkClick();
    });
});

function checkClick() {
    if (expecting && blurring.length < 1) {
        console.log("CHECKING: EXPECTING CLICK AND NO MORE BLUR EVENTS");
        expecting = false;
        clickFunction();
    } else {
        console.log("CHECKING: EITHER NOT EXPECTING OR BLUR EVENT(S) STILL OCCURRING");
    }
}

function clickFunction() {
    console.log("EXECUTING CLICK FUNCTION");

    // Put your actual click code here
} 
```

单击按钮时您实际想要发生的事情，放入`clickFunction`.

# c# - 应用程序配置文件清理

> ID：12940406
> 
> 赞同：0
> 
> 时间：2012-10-17T17:56:59.330
> 
> 标签：c#, .net, configuration-files

我过去工作的 ac# 应用程序经历了几次命名空间更改和程序集名称更改。

因此，我在构建时生成的应用程序配置文件充满了对我不再有用的旧东西。

我试过删除这些部分。我尝试删除整个配置文件并强制 VS 为我构建一个新配置文件，但它一直在为我构建一个很久以前的副本。

我怎样才能强制我的应用程序在我想要的时候给我一个新的配置文件？

编辑：问题不清楚。我会尝试添加更多。

例如，假设我的应用程序被称为“mytools”。然后我更改了程序的程序集和命名空间设置，现在它被称为“mytoolsPLUS”。当我构建我的应用程序并查看我在`<configsections>`节点中看到的 mytoolsPLUS.exe.config 文件时，我有两个`<sectiongroup>`节点，usersettings 和 applicationsettings。在 usersettings`<sectiongroup>`节点中，我有一个条目，`<section name=mytools.properties.settings type=sys.config.clientsettingssection....>`但我也有一个条目`<section name=mytoolsPLUS.properties.settings type=sys.config.clientsettingssection...>`

这种重复发生在我的`<connectionstrings>`节点下，因此是我今天发布此线程的主要原因。我的一位最终用户对他们需要调整哪个连接字符串以指向备份测试服务器感到困惑。我仔细研究了一下，发现我的配置文件中有很多“旧片段”。我喜欢在像这样的小应用程序的完整 xml 文件中使用设置类，所以我想弄清楚我在这里做错了什么。我希望我的解释对正在阅读的人来说足够清楚。

感谢您阅读我的帖子！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T18:13:00.353

在您的项目中，直接在项目下树打开属性节点。

在那里你会看到一个“Settings.settings”和“Settings.Designer.cs”文件。右键单击每个文件并选择“打开方式..”并选择“源代码编辑器”。

你应该可以从这里清理任何旧的东西。

您还可以使用标准文本编辑器来编辑这些内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-23T15:34:51.520

在您的项目中，应该有一个名为 App.config 的文件。你可以删除多余的 sectionGroups 和其他无关的东西来清理你的配置文件。

# javascript - JavaScript/jQuery 实时验证

> ID：12940407
> 
> 赞同：4
> 
> 时间：2012-10-17T17:57:01.293
> 
> 标签：javascript, jquery, validation

我对输入进行了一些“实时”验证的简单实现。允许的字符包括小写和大写字母、0-9、连字符、句点、撇号和空格。该字段限制为 15 个字符。我在这里使用 jQuery 只是为了在我的示例中易于使用，它可能会或可能不会用于我的项目。

目前，当尝试使用箭头键在输入中放置/移动光标时，我总是被带到字符串的末尾。尝试使用键 (CTRL-A) 选择所有文本时也会发生同样的情况。有没有更好的方法来完成我正在寻找的东西来避免这种情况？对我来说，这似乎是糟糕的用户体验。

```
$( '#sample' ).on( 'keyup', function( event ) {
    var str = $( this ).val();
    str = str.replace(/[^A-Za-z-0-9.'\s]/g, "").substring(0,15);
    $( this ).val( str );
});​ 
```

我也在[这里设置了一个 jsFiddle](http://jsfiddle.net/sjTUw/1/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T18:02:03.473

仅当输入值实际发生变化时才更新输入值，就可以预防大多数问题。

```
$( '#sample' ).on( 'keyup', function( event ) {

   var str = $( this ).val();
   str = str.replace(/[^A-Za-z-0-9.'\s]/g, "").substring(0,15);

   if($( this ).val() != str) {
       $( this ).val( str );
   }
});​ 
```

要解决从文本中间删除字符的问题，您需要记住并重置插入符号的位置。为此，您可以使用以下功能：

```
$.fn.getCaretPosition = function() {
    var el = $(this).get(0);
    var pos = 0;
    if ('selectionStart' in el) {
        pos = el.selectionStart - 1;
    } else if ('selection' in document) {
        el.focus();
        var Sel = document.selection.createRange();
        var SelLength = document.selection.createRange().text.length;
        Sel.moveStart('character', -el.value.length);
        pos = Sel.text.length - SelLength;
    }
    return pos;
}

$.fn.setCaretPosition = function(pos) {
    if ($(this).get(0).setSelectionRange) {
        $(this).get(0).setSelectionRange(pos, pos);
    } else if ($(this).get(0).createTextRange) {
        var range = $(this).get(0).createTextRange();
        range.collapse(true);
        range.moveEnd('character', pos);
        range.moveStart('character', pos);
        range.select();
    }
}​ 
```

并扩展您的 keyup 处理程序：

```
$('#sample').on('keyup', function(event) {

    var str = $(this).val();
    str = str.replace(/[^A-Za-z-0-9.'\s]/g, "").substring(0, 15);

    if ($(this).val() != str) {
        var pos = $(this).getCaretPosition();
        $(this).val(str);
        $(this).setCaretPosition(pos);
    }
}); 
```

请参阅更新[的 FIDDLE](http://jsfiddle.net/sjTUw/32/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-17T18:16:05.803

由于您监听 keyup 事件，因此该函数将在任何键向上时执行，包括 CTRL+C、箭头。因此，您可以使用 .on('input', foo()) ，它仅在文本更改时才会执行。

```
$( '#sample' ).on('input',function( event ) {
    var str = $( this ).val();
    str = str.replace(/[^A-Za-z-0-9.'\s]/g, "").substring(0,15);
    $( this ).val( str );
});​ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-17T18:03:18.267

对像这样的特殊字符使用 prevent Default

```
$( '#sample' ).on( 'keypress', function( event ) {

    var ch = String.fromCharCode(event.keyCode);
    ch = ch.replace(/[^A-Za-z-0-9.'\s]/g, "");
    if(ch == "") {
       event.preventDefault();
   }
});​ 
```

[http://jsfiddle.net/sjTUw/34/](http://jsfiddle.net/sjTUw/34/)

# jquery - 如何为 Miva 快速查看按钮添加颜色框弹出窗口

> ID：12940414
> 
> 赞同：0
> 
> 时间：2012-10-17T17:57:17.017
> 
> 标签：jquery, colorbox, miva

我正在尝试复制 Nextopia 快速查看弹出窗口的外观。他们正在使用彩盒。我们网站上的一个例子是[http://www.hatsinthebelfry.com/category/womens-hats.html](http://www.hatsinthebelfry.com/category/womens-hats.html)

这是当前按钮的 Miva 代码（此处的测试页面：[http](http://www.hatsinthebelfry.com/category/NEXtest.html) ://www.hatsinthebelfry.com/category/NEXtest.html ）

当前按钮：

```
<input type="button" value="Quick View" onClick="divwin=dhtmlwindow.open('divbox&mvt:product:id;', 'div', 'somediv&mvt:product:id;', '&mvt:global:JSProdName;', 'width=600px,height=560px,top=20px,scrolling=1, center=1'); return false" style="cursor:hand;" class="nxt_moreinfo"> 
```

这是我从 Jack Moore（Colorbox 的开发者）那里得到的代码，但这是为了打开一个 html 页面。我需要打开一个div。

```
<button onclick='$.colorbox({href:"example.html"}); return false;'></button> 
```

谁能告诉我如何在颜色框语法中正确调用 miva 代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T19:11:59.003

```
$.colorbox({ 
rel:'mycontent',
inline:true,
href: function(){var url = $(this).attr('href'); return url;}
});

<a rel="mycontent" href="do-something.php?productid=somevalue">Do Something</a> 
```

以上允许单个颜色框参考。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T18:17:58.413

据我了解你问这个：

```
$.colorbox({ href: '#inline_content', inline:true }); 
```

和html：

```
<div style='display:none'>
     <div id='inline_content'>test</div>
</div> 
```

# c - 用 libzip 解压一个文件

> ID：12940418
> 
> 赞同：2
> 
> 时间：2012-10-17T17:57:25.973
> 
> 标签：c, eclipse, extract

我需要创建一个应用程序来从 zip 存档中提取一个文件，之后我想为 Android 编译它。

我使用的是 Ubuntu，预装了 libzip-0.10.1。我在 Eclipse 中创建了 C 项目，添加了包含路径并找到了用于提取文件的简单脚本。不幸的是，我无法构建以下内容，我可以使用一些建议。

```
// zip.c file
#include <stdio.h>
#include <stdlib.h>
#include <zip.h>

int main(int argc, char **argv) {
struct zip *zip_file;
struct zip_file *file_in_zip;
int err;
int files_total;
int file_number;
int r;
char buffer[10000];

if (argc < 3) {
    fprintf(stderr,"usage: %s <zipfile> <fileindex>\n",argv[0]);
    return -1;
};

zip_file = zip_open(argv[1], 0, &err);
if (!zip_file) {
    fprintf(stderr,"Error: can't open file %s\n",argv[1]);
    return -1;
};

file_number = atoi(argv[2]);
files_total = zip_get_num_files(zip_file);
if (file_number > files_total) {
    printf("Error: we have only %d files in ZIP\n",files_total);
    return -1;
};

file_in_zip = zip_fopen_index(zip_file, file_number, 0);
if (file_in_zip) {
    while ( (r = zip_fread(file_in_zip, buffer, sizeof(buffer))) > 0) {
        printf("%s",buffer);
    };
    zip_fclose(file_in_zip);
} else {
    fprintf(stderr,"Error: can't open file %d in zip\n",file_number);
};

zip_close(zip_file);

return 0;
}; 
```

我还添加了一些 .h 文件以在我的项目中包含目录，并将一些 .c 文件添加到带有 zip.c 文件的目录中。之后所有的依赖都很好，但我有一个错误：

```
‘struct zip’ has no member named ‘default_password’ in file zip_fopen_index.c 
```

该文件`zip_fopen_index.c`是：

```
#include <errno.h>
#include <stdio.h>
#include <stdlib.h>

#include "zipint.h"

ZIP_EXTERN struct zip_file *
zip_fopen_index(struct zip *za, zip_uint64_t fileno, int flags)
{
    return zip_fopen_index_encrypted(za, fileno, flags, za->default_password); // error here
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-18T07:02:00.090

首先请允许我发表一些评论：

您的程序不是由 Eclipse**编译和链接的。**

编译由编译器完成（`gcc`使用选项`-c`）：

```
make all 
Building file: ../zip.c
Invoking: GCC C Compiler
gcc -O0 -g3 -Wall -c -fmessage-length=0 -MMD -MP -MF"zip.d" -MT"zip.d" -o "zip.o" "../zip.c"
Finished building: ../zip.c 
```

链接由链接器完成（通过使用 option 的编译器`-o`）：

```
Invoking: GCC C Linker
gcc  -o "unzipper"  ./zip.o   
./main.o: In function `zip':
/home/alk/workspace/unzipper/Debug/../zip.c:20: undefined reference to `zip_open'
/home/alk/workspace/unzipper/Debug/../zip.c:27: undefined reference to `zip_get_num_files'
/home/alk/workspace/unzipper/Debug/../zip.c:33: undefined reference to `zip_fopen_index'
/home/alk/workspace/unzipper/Debug/../zip.c:35: undefined reference to `zip_fread'
/home/alk/workspace/unzipper/Debug/../zip.c:38: undefined reference to `zip_fclose'
/home/alk/workspace/unzipper/Debug/../zip.c:43: undefined reference to `zip_close'
collect2: ld returned 1 exit status 
```

Eclipse 提供了一个框架，帮助您管理所有源代码及其引用，同时生成编译器和链接器任务并设置它们的选项。

当链接器在构建程序期间告诉您函数`undefined reference`的`zip_*`位置时，原因是您没有告诉链接器（通过编译器，通过 Eclipse）`zip_*`可以在哪里找到这些函数。

这些`zip_*`函数位于库中，即`libzip`.

因此，作为程序员，您需要告诉链接器（通过编译器，通过 Eclipse）将这些函数与编译器从您的源代码编译的内容链接起来。

结果，链接器能够从您编译的源代码以及所需的所有库中创建一个可运行的程序。默认情况下，Eclipse（以及链接器）知道某些库，例如包含 C 标准函数的库，即`libc`.

为了让事情顺利进行：

1 从项目中删除从`libzip`库的源中提取的源文件。这些源代码已编译到库`libzip`中，您将在项目中使用它。

2 告诉链接器（通过 Eclipse）`libzip`用于您的项目。

请按照以下步骤执行此操作：

打开项目的属性

单击“C/C++ 常规”

单击“路径和符号”，在左侧选择“库”选项卡，单击“添加”并输入`zip`

最后点击“确定”

3 然后尝试构建您的程序：

```
Building target: unzipper
Invoking: GCC C Linker
gcc  -o "unzipper"  ./zip.o   -lzip
Finished building target: unzipper 
```

（请注意附加选项`-lzip`！）

如果'libzip'的开发版本之前已经正确安装，你应该没问题。

* * *

PS：`unzipper`是我用于 Eclispe 项目以生成示例的名称。

PSS：我用的是 Eclipse Juno SR1

# java - 构造函数是静态的还是非静态的

> ID：12940421
> 
> 赞同：12
> 
> 时间：2012-10-17T17:57:44.067
> 
> 标签：java

根据标准书，构造函数是一种特殊类型的函数，用于初始化对象。由于构造函数被定义为函数，内部类函数只能有两种类型，静态或非静态。我怀疑构造函数是什么？

```
1.)As constructor is called without object so it must be static

  Test test =new  Test();//Test() is being called without object
   so must be static 
```

我的疑问是构造函数是否是静态方法，那么我们如何在构造函数中频繁使用它

```
Test(){
    System.out.println(this);
} 
```

输出是否`Test@12aw212`意味着构造函数是非静态的？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-17T17:59:18.497

你的第二个例子恰到好处。`this`引用在构造函数中可用，这意味着构造函数是针对某个对象执行的 - 当前正在创建的对象。

原则上，当您创建一个新对象（通过使用`new`运算符）时，JVM 将为它分配一些内存，然后在该新创建的对象上调用构造函数。JVM 还确保在构造函数之前没有调用其他方法（这就是它的特别之处）。

实际上，在机器级别上，构造函数是一个带有一个特殊的隐式`this`参数的函数。这个特殊参数（由运行时传递）使对象方法和静态方法有所不同。换句话说：

```
foo.bar(42); 
```

被翻译成：

```
bar(foo, 42); 
```

其中第一个参数名为`this`。另一方面，`static`方法按原样调用：

```
Foo.bar(42); 
```

翻译为：

```
bar(42); 
```

`Foo`这里只是一个几乎不存在于源代码中的命名空间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T18:00:03.837

构造函数是非静态的。每个方法的第一个参数都是隐式的`this`（静态除外），构造函数就是其中之一。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T18:00:13.257

构造函数不是静态函数。当您创建`Test test =new Test();`一个新`Test`对象时，然后在该对象上调用构造函数（我的意思是`this`指向新创建的对象）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-17T18:00:31.740

这里的`new`关键词是诀窍。您正确地注意到，一般来说，如果您在没有对象的情况下调用它，则方法是静态的。然而，在这种特殊情况下（即，以`new`关键字开头）编译器知道调用构造函数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-17T18:03:48.027

`new`运算符返回对其创建的对象的引用。

```
new Test(); // creates an instance. 
```

在操作员实例化对象`System.out.println(this);`后调用`new`

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-10-17T19:00:56.830

两者都不。

方法可以分为两种类型：静态/非静态方法，也就是类/实例方法。

但是构造函数不是方法。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-10-17T18:01:41.603

不是静态的。阅读构造函数[http://www.javaworld.com/jw-10-2000/jw-1013-constructors.html](http://www.javaworld.com/jw-10-2000/jw-1013-constructors.html)。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2020-01-03T10:48:16.053

构造函数既不是静态的（使用类名调用）也不是在创建对象时执行的非静态的。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2019-09-20T10:35:58.433

当我们谈论静态类时，我们会想到用类名调用方法，但是在构造函数的情况下，构造函数在创建对象时被初始化所以这证明是非静态的。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2013-09-17T19:16:26.633

静态：Temp t= new Temp();

运算符在堆区域中创建内存并将其隐式`new`传递给构造函数。然后它初始化一个在调用局部参数变量`Temp(this)`的类中定义的非静态实例变量。`this``this`

```
class Temp{
    int a;
    Temp this; //inserted by compiler.
    Temp(Temp this){ //passed by compiler
        this.this=this; // initialise this instance variable here. 
        this.a=10;//when we write only a=10; and all the non-static member access by this implicitly.
        return this; // so that we can't return any value from constructor.
    }
} 
```

构造函数是静态的，因为：

1.  它有助于创建对象。
2.  它被称为没有对象。

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2014-06-22T12:37:08.350

构造函数用于初始化对象，具有非静态方法的行为，因为非静态方法属于对象，所以构造函数也是JVM调用的对象的引用初始化对象，由new操作符创建

# macos - 将 gtk 程序移植到 mac

> ID：12940422
> 
> 赞同：0
> 
> 时间：2012-10-17T17:57:50.633
> 
> 标签：macos, user-interface, gtk, x11, porting

在 mac 上运行 X11/GTK 程序对我来说相当痛苦。它看起来很丑，而且它时不时地以奇怪的方式行事。所以我想知道使用 Cocoa 等原生 GUI 框架将 GTK 程序移植到 Mac 的自然选择是什么。顺便说一句，是否有任何现有的努力来管理统一存储库中的此类移植？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T18:20:25.437

GTK+ 的许多部分已经移植到 OS X，请参阅[GTK+ - OS X 的主页](http://www.gtk.org/download/macos.php)。因此，理论上，您只需在带有 Quartz 后端的 OS X 上重新编译您最喜欢的 GTK+ 应用程序即可使其在本地运行。你的里程当然会有所不同。

# android - 活动标签出现在主屏幕上，而不是应用名称

> ID：12940423
> 
> 赞同：6
> 
> 时间：2012-10-17T17:57:50.417
> 
> 标签：android

在 AndroidManifest.xml 中，应用程序标签具有：

android:label="@string/app_name"

res/values/strings.xml 中的 app_name 读取“我的应用程序”。

但是在模拟器和附加设备上运行或调试后，主屏幕上的应用程序图标显示主活动的标签而不是应用程序标签。这是预期的行为，如果不是，为什么会发生？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T18:01:14.207

是的，这是预期的行为。应用程序名称将显示在设置中的应用程序选项卡中。主屏幕显示启动器活动的标签。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T12:49:36.683

如果您想将 app_name 属性显示为启动器图标下方的应用程序标签，您可以在 android 清单文件的应用程序标记中指定 android:label 属性。

例如：

```
<application
    android:name=".MyApp"
    android:icon="@drawable/myIcon"
    android:label="@string/app_name"> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-05-18T17:32:26.847

此行为的解决方法：

在**清单**中：

```
<application
    android:icon="@mipmap/ic_launcher"
    android:label="@string/app_name"
    android:roundIcon="@mipmap/ic_launcher_round"
    android:supportsRtl="true"
    android:theme="@style/AppTheme">

<activity
       android:name=".MainActivity">
       <intent-filter>
           <action android:name="android.intent.action.MAIN" />

           <category android:name="android.intent.category.LAUNCHER" />
       </intent-filter>
</activity> 
```

在**MainActivity 的** **onCreate**中：

```
getSupportActionBar().setTitle(R.string.activity_name); 
```

通过这样做，应用程序名称将出现在主屏幕上，您仍然可以为启动器活动设置不同的标题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-05-03T18:54:49.833

人们看到这里，我遇到了同样的问题，终于解决了。

Launcher 仅显示 mainActivity，因为 Phone Launcher 首选活动标签。

因此，想要显示 Application lab 而不是 MainActivity，他应该删除以下行：

```
 <activity
        android:name=".MainActivity"
        android:label="@string/title_activity_main"
        android:theme="@style/AppTheme.NoActionBar">

        <intent-filter android:label="@string/app_name" >
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity> 
```

删除这个：

```
 android:label="@string/title_activity_main" 
```

# wordpress - 在 wordpress .htaccess 中将特定页面从 http 重定向到 https

> ID：12940424
> 
> 赞同：2
> 
> 时间：2012-10-17T17:58:01.070
> 
> 标签：wordpress, .htaccess, http, redirect, https

我只需要将我的 wordpress 网站中的一页从 http 重定向到 https。我在网上搜索，但似乎没有一个解决方案有效。这是我的 .htaccess 文件中的代码：

```
# Redirect to force SSL on test page
RewriteCond %{HTTPS} off
RewriteRule ^test/$ https://www.example.com/test/ [R=301,L] 
```

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T18:19:39.060

有一个插件叫做“页面链接”

它在帖子/页面的底部添加了一个元框，您可以告诉它“指向其他 URL”而不是“指向现有 url”。然后，它会为您提供一个框，可以在其中放置您想要的任何 URL。我想，您可以重定向到 https://，因为我们多年来一直使用它来重定向到许多不同的地方（尽管不是专门的 https 版本的页面）。虽然它是一个免费插件，但我不明白为什么它不起作用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T18:21:05.410

那这个呢？

```
RewriteEngine On
RewriteRule ^my-test-page\.html$ https://www.domain.com/my-test-page.html [R=301,L] 
```

干杯。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-11-12T05:56:47.030

编辑`.htaccess`：

```
RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301] 
```

# objective-c - Objective-c：查找 NSArray 中元素的最后一个索引

> ID：12940431
> 
> 赞同：4
> 
> 时间：2012-10-17T17:58:41.960
> 
> 标签：objective-c, find, nsarray

我有一个 NSArray，我想找到一个元素的最后一次出现。例如：

```
[apple, oranges, pears, apple, bananas];
int i = lastIndexOf("apple");
out: i == 3; 
```

我正在努力寻找一个简单的解决方案来查看 APIS，但没有示例，因此很难理解我应该使用哪个函数。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-17T18:13:16.047

```
NSUInteger index = [array indexOfObjectWithOptions:NSEnumerationReverse
    passingTest:^(id obj, NSUInteger i, BOOL *stop) {
        return [@"apples" isEqualToString:obj];
    }]; 
```

如果数组不包含`@"apples"`，`index`则为`NSNotFound`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-17T18:01:41.320

`NSArray`has `indexOfObjectWithOptions:passingTest:`，这将允许您反向搜索。

例如：

```
NSArray *myArr = @[@"apple", @"oranges", @"pears", @"apple", @"bananas"];
NSString *target = @"apple";

NSUInteger index = [myArr indexOfObjectWithOptions:NSEnumerationReverse
                                      passingTest:^BOOL(NSString *obj, NSUInteger idx, BOOL *stop) {
                                          return [target isEqualToString:obj];
                                      }]; 
```

[您可以在Apple](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSArray_Class/NSArray.html)的文档中找到有关此方法的更多详细信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-10T06:00:32.617

如果有人想要一个可重用的分类方法，我已经为 lastIndexOf 编写了一个。

可以从这里找到并免费使用代码 -

[http://www.tejasshirodkar.com/blog/2013/06/nsarray-lastindexof-nsmutablearray-lastindexof/](http://www.tejasshirodkar.com/blog/2013/06/nsarray-lastindexof-nsmutablearray-lastindexof/)

# ruby-on-rails - 无法让 MYSQL 在 Windows 上与 Ruby on Rails 一起运行

> ID：12940432
> 
> 赞同：-2
> 
> 时间：2012-10-17T17:58:42.760
> 
> 标签：ruby-on-rails, ruby

> **可能重复：**
> [为错误的 mysql 客户端库编译的 mysql2 gem](https://stackoverflow.com/questions/8740868/mysql2-gem-compiled-for-wrong-mysql-client-library)

这是我不断收到的错误：

```
C:\Sites\ProjectName>rails s
C:/Ruby193/lib/ruby/gems/1.9.1/gems/mysql2-0.3.11-x86-mingw32/lib/mysql2/mysql2.
rb:2:in `require': Incorrect MySQL client library version! This gem was compiled
 for 6.0.0 but the client library is 5.5.28\. (RuntimeError)
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/mysql2-0.3.11-x86-mingw32/lib/m
ysql2/mysql2.rb:2:in `<top (required)>'
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/mysql2-0.3.11-x86-mingw32/lib/m
ysql2.rb:9:in `require'
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/mysql2-0.3.11-x86-mingw32/lib/m
ysql2.rb:9:in `<top (required)>'
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.2.1/lib/bundler/runti
me.rb:68:in `require'
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.2.1/lib/bundler/runti
me.rb:68:in `block (2 levels) in require'
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.2.1/lib/bundler/runti
me.rb:66:in `each'
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.2.1/lib/bundler/runti
me.rb:66:in `block in require'
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.2.1/lib/bundler/runti
me.rb:55:in `each'
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.2.1/lib/bundler/runti
me.rb:55:in `require'
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/bundler-1.2.1/lib/bundler.rb:12
8:in `require'
        from C:/Sites/ProjectName/config/application.rb:7:in `<top (required)>'
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/comman
ds.rb:53:in `require'
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/comman
ds.rb:53:in `block in <top (required)>'
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/comman
ds.rb:50:in `tap'
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/comman
ds.rb:50:in `<top (required)>'
        from script/rails:6:in `require'
        from script/rails:6:in `<main>' 
```

我知道它说我脸上的错误不幸的是我不知道如何解决它，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T18:04:55.210

看看[为错误的 mysql 客户端库编译的 mysql2 gem](https://stackoverflow.com/questions/8740868/mysql2-gem-compiled-for-wrong-mysql-client-library)

对正在发生的事情进行了完整的解释，并提供了有关如何解决问题的建议。

# html - 用于跟踪库存数量的简单 JavaScript 程序

> ID：12940434
> 
> 赞同：0
> 
> 时间：2012-10-17T17:58:50.587
> 
> 标签：html, forms

我有这个 Javascript 数据存储，它是 TiddlyWiki (fyi) 的一部分，用于按 SKU 存储产品。但是我不确定如何制作表格来更新它。我希望表单检索 ID 中可用的产品数量`GetAmount`。用户可以选择添加、减去或更新该值，然后使用该`Update`函数将其保存。新金额也应显示在金额字段中。这看起来应该很简单，但我对 HTML 表单的了解还不够，不知道该怎么做。

这是我到目前为止所拥有的一个小提琴。[http://jsfiddle.net/Arlen22/pCDx3/](http://jsfiddle.net/Arlen22/pCDx3/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T18:43:47.233

忘记使用 html 表单提交数据。您的数据源直接连接到您的 javascript，因此您可以跳过回发和代码隐藏内容。为了简单起见，我会使用 jQuery，但您也可以使用原生 javascript 来实现。如果您决定学习和使用 jQuery，那么它的文档很完善，如果您问我，那么值得花时间学习。

此示例应该有助于您入门，请随时根据需要对其进行编辑和评论：

**html**

```
<fieldset class="stock-control">

    <legend>Edit Stock Amount</legend>

    <label>ID:</label>
    <input type="text" id="txt-id">

    <label>Amount:</label>
    <input type="text" id="txt-change"><br />

    <input type="button" id="btn-add" value="Add">
    <input type="button" id="btn-sub" value="Subtract">
    <input type="button" id="btn-set" value="Set">

    <br />
    <label>In stock: </label><span id="lbl-total"></span>

</fieldset>

<fieldset class="stock-control">

    <legend>Edit Stock Amount</legend>

    <label>ID:</label>
    <input type="text" class="txt-id">

    <label>Amount:</label>
    <input type="text" class="txt-change"><br />

    <input type="button" class="btn-add" value="Add">
    <input type="button" class="btn-sub" value="Subtract">
    <input type="button" class="btn-set" value="Set">

    <br />
    <label>In stock: </label><span class="lbl-total"></span>

</fieldset> 
```

**Javascript**

```
// Your code

$(function () {

    $('.stock-control').each(function () {

        var $control = $(this);
        var $id = $control.find('.txt-id');
        var $amount = $control.find('.txt-amount');
        var $total = $control.find('.lbl-total');

        function RenderAmount() {
            $total.text(StockRecorder.GetAmount($id.val()));
        };

        $('.btn-add').click(function () {
            var stock = parseInt($total.text()) + parseInt($amount.val());
            StockRecorder.Update($id.val(), stock);
            RenderAmount();
        });

        $('.btn-sub').click(function () {
            var stock = parseInt($total.text()) - parseInt($amount.val());
            StockRecorder.Update($id.val(), stock);
            RenderAmount();
        });

        $('.btn-set').click(function () {
            StockRecorder.Update($id.val(), parseInt($amount.val()));
            RenderAmount();
        });

        // Initialize
        RenderAmount();

    });

}); 
```

**注意：**当在 id 文本框中输入/更改了 id 时，您需要一个按钮或一个调用 RenderAmount() 函数的事件。在我的例子中，我假装它已经被填写了。

顺便说一句，这似乎是一个有趣的项目，你已经掌握了。好好享受！:) ​</p>

# php - 使用 session_start 两次

> ID：12940443
> 
> 赞同：15
> 
> 时间：2012-10-17T17:59:10.087
> 
> 标签：php, session

我有一个非常愚蠢的问题（我相信）：

如果我开始 2 个会话，调用`session_start()`两次会发生什么？例如，我有一个 class `User`，我在其中启动用户会话，还有一个 class `Error`，我在其中启动另一个会话，因此我可以在其中存储错误和通知并将它们传递给其他页面。

我会遇到问题吗，这是否有效？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-10-17T18:00:10.697

PHP 不支持多个同时会话。除非现有会话被销毁（通过） ，否则在请求中第二次调用`session_start()`不会做任何事情。`session_destroy()`

> `session_start()`根据通过 GET 或 POST 请求或通过 cookie 传递的会话标识符创建会话**或恢复当前会话。**

[http://php.net/session-start](http://php.net/session-start)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2017-05-10T20:07:52.830

如果您检查每个会话是否已经创建了会话，则可以使用不同的 session_start() ，以这种方式：

```
if (!isset($_SESSION)) {
    session_start();
} 
```

# c# - 将matlab的bwconncomp方法转换为c#

> ID：12940445
> 
> 赞同：2
> 
> 时间：2012-10-17T17:59:15.423
> 
> 标签：c#, matlab, converter

我需要将matlab的BwConnComp方法转换为c#，

任何人都可以帮助我获取此方法源代码或提供将此方法转换为 c# 语言的算法吗？

我需要获取 3d 图像的连接组件（例如立方体）

# regex - Sublime Text 2 RegEx 用 n+1 替换 n

> ID：12940450
> 
> 赞同：5
> 
> 时间：2012-10-17T17:59:30.853
> 
> 标签：regex, replace, sublimetext2

使用正则表达式搜索并替换为 Sublime Text 2，如何将我的模式匹配 (n) 替换为 n+1？如果没有办法通过搜索和替换来做到这一点，还有另一种简单的方法吗？

我的 RegEx 模式是`^(\d{1,4})\n`，我希望能够做到`$1+1`，目前它只输出带有文字“+1”的匹配项。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-17T18:25:59.590

正则表达式是该功能的错误工具。但是，有一个 Sublime Text 插件只是为了做你想做的事：[“Sublime Text 插件来增加/减少所有选定的数字”](https://gist.github.com/2788978)

# regex - 如何使用 R 解析 html 字符串？

> ID：12940451
> 
> 赞同：3
> 
> 时间：2012-10-17T17:59:33.223
> 
> 标签：regex, r

如何从此 html 字符串中 grep 数据项

```
a <- "<div class=\"tst-10\">100%</div>" 
```

所以结果是100％？主要思想是在> <之间获取数据。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-17T18:06:33.077

我会`gsub()`在这种情况下使用：

```
gsub("(<.*>)(.*)(<.*>)", "\\2", a)
[1] "100%" 
```

基本上，这会将字符串分成三个部分，每个部分由正则括号`(`和`)`. 然后我们可以使用这些作为反向引用。第一组反向引用匹配的内容可以称为`\1`（使用双斜杠转义特殊字符），第二组匹配的内容，`\2`依此类推。

所以，本质上，我们说的是解析这个字符串，找出符合我的条件的内容，然后只返回第二个反向引用。

一点一点：

*   `<.*>`表示查找“<”，后跟任意数量的任意字符“.*”，直到找到“>”
*   `.*`表示匹配任意数量的字符（直到下一个条件）

牢记这一点，您实际上可能会使用`gsub("(.*>)(.*)(<.*)", "\\2", a)`并获得相同的结果。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-17T18:18:45.063

我总是使用这个正则表达式来删除 HTML 标签：

```
gsub("<(.|\n)*?>","",a) 
```

给出：

```
[1] "100%" 
```

与 mrdwab 的不同之处在于我只是删除了每个 html 标记，而他从 html 标记中提取内容，这可能更适合本示例。请注意，如果有更多标签，两者都会给出不同的结果：

```
> gsub("(<.*>)(.*)(<.*>)", "\\2", paste(a,"<lalala>foo</lalala>"))
[1] "foo"

> gsub("<(.|\n)*?>","", paste(a,"<lalala>foo</lalala>"))
[1] "100% foo" 
```

我想我曾经在这里找到它，不确定哪个答案。

# android - 位图 ImageView，在 Horizo ntalScrollView 内。如何使 Horizo ntalScrollView 高度与位图相匹配？

> ID：12940452
> 
> 赞同：3
> 
> 时间：2012-10-17T17:59:33.583
> 
> 标签：android, android-layout, bitmap, imageview, horizontalscrollview

我有一个水平滚动视图，里面有一个 ImageView。这个图像视图有一个高宽低高的位图。

我希望位图填充水平滚动视图的高度，并且我想从左到右滚动位图。

我尝试使用此代码，但它不起作用。它在左右创建两个空间，这些空间是黑色的。这些空间来自 ImageView...所以...位图的宽度小于 ImageView

```
 HorizontalScrollView wvScroll = new HorizontalScrollView(this);
        wvScroll.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.FILL_PARENT)); 
        iv.setImageBitmap(Util.getRemoteImage("http://mywebsite.com/90.gif"));
        //iv.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.FILL_PARENT));
        iv.setScaleType(ScaleType.CENTER_INSIDE);
        iv.setBackgroundColor(Color.BLACK);
        wvScroll.addView(iv);
        wvScroll.setBackgroundColor(Color.GREEN);
        mainLayout.addView(wvScroll); 
```

我究竟做错了什么？我也尝试过，`iv.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.FILL_PARENT));`但它不起作用，同样的结果。

编辑：

我也试过了`ScaleType.CENTER_CROP`，效果不好。位图的高度比 ImageView 高，因为位图的顶部和底部丢失了一些像素。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-15T17:43:00.597

如果我不得不以最简单的方式解决这个问题。**我将滚动视图的宽度设置为与屏幕宽度相同**。高度并不重要，因为您假设高度适合屏幕（至少这是我从您的问题中收集到的）。

据我所知，滚动视图将滚动任何大于实际屏幕或大于指定滚动宽度或滚动高度的任何内容。

**这可能会帮助您开始获得可观的屏幕尺寸 -** [获取屏幕宽度和高度](https://stackoverflow.com/questions/4743116/get-screen-width-and-height)

当然，由于不同的设备具有不同的屏幕尺寸 - 你必须“以编程方式”执行此操作。

这种实施对你有用吗？

# c# - 指向 int 类型字符串的指针

> ID：12940464
> 
> 赞同：0
> 
> 时间：2012-10-17T18:00:14.817
> 
> 标签：c#, asp.net, string, pointers, unsafe

我正在尝试获取指向 a 的指针`string`，其中指针的类型为`int`。我不确定我是否做得正确。我昨天才发现[unsafe](http://msdn.microsoft.com/en-us/library/chfa2zb8%28v=vs.71%29.aspx)和[fixed](http://msdn.microsoft.com/en-us/library/f58wzh21%28v=vs.71%29.aspx)，所以我仍然对此有所质疑。我可以投到`char*`吗`int`？我没有收到任何错误，但这些方法不起作用，所以我不确定指针是否错误，或者我是否对第 3 方 OCX（不支持）做错了。

C++ 调用的第 3 方文档：

```
BlobToVariant(VARIANT *pV, long BlobPointer)
WriteVToFile(VARIANT *pV) 
```

什么 VS2010 C# Intellisense 说：

```
BlobToVariant(ref object v, int BlobPointer)
WriteVToFile(ref object v) 
```

这是我的代码：

```
string imageBlob = "superlongstring";

// 3rd Party ActiveX control for tiff image files
TIFFLib.TIFF tiff = new TIFFLib.TIFF();

// Variant object that will hold image
object blobVariant = new object();

unsafe
{
    fixed (char* p = imageBlob)
    {
        int blobPointer = (int)p;

        tiff.BlobToVariant(ref blobVariant, blobPointer);
        tiff.WriteVToFile(ref blobVariant);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T19:05:08.887

`BlobToVariant`可能需要一个指向 C 字符串的指针；一个`char*`。虽然`char`在 C 中是 1 字节数据类型，但在 C# 中是 2 字节数据类型。AC#`char*`和 C`char*`是不同的、不兼容的类型。

您需要首先使用合适的文本编码将字符串转换为字节序列。我将在这里使用 UTF-8，但如果此函数不接受 UTF-8 输入，您应该切换到其他内容。

```
// "using System.Text;" assumed.
byte[] imageBlobBytes = Encoding.UTF8.GetBytes(imageBlob); 
```

现在你做同样的事情，只是你使用 a `byte*`，它对应`char*`于 C 中的类型。（准确地说，它们可能在签名方面有所不同。C#`byte`类型是无符号的，而 C`char`类型通常是有符号的，但我们在这里并不真正关心这一点。）

```
// 3rd Party ActiveX control for tiff image files
TIFFLib.TIFF tiff = new TIFFLib.TIFF();

// Variant object that will hold image
object blobVariant = new object();

unsafe
{
    fixed (byte* p = imageBlobBytes)
    {
        int blobPointer = (int)p;

        tiff.BlobToVariant(ref blobVariant, blobPointer);
        tiff.WriteVToFile(ref blobVariant);
    }
} 
```

**请注意，这仅适用于 32 位主机，如果进程以 32 位执行，则仅适用于 64 位主机。** C#`int`类型始终为 32 位宽，而`byte*`在 32 位执行环境中为 32 位宽，在 64 位执行环境中为 64 位宽。如果在 64 位环境中执行，此代码将截断指针并且结果行为将是未定义的。

# sql - 根据 where 子句的结果创建别名

> ID：12940470
> 
> 赞同：1
> 
> 时间：2012-10-17T18:00:44.377
> 
> 标签：sql, oracle11g

我正在创建一个视图，其中几乎复制了原始用户的数据，但我还有一个属性，我想将用户在下载表中的出现次数放在其中。

```
CREATE VIEW customer_count_streams_vw(
sid_customer
systemuser_id
postcode
age
gender
num_streams) 
AS 
SELECT
user.sid_customer,
user.systemuser_id,
user.postcode,
user.age,
user.gender,
num_streams 
FROM md_customer 
INNER JOIN ods_streaming AS num_streams (
SELECT COUNT(ods_streaming.sid_customer) 
WHERE ods_streaming.sid_customer = md_customer.sid_customer) 
```

我想要的是放置零件的结果：

```
SELECT COUNT(ods_streaming.sid_customer) 
WHERE ods_streaming.sid_customer = md_customer.sid_customer 
```

进入`num_streams`领域。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T18:04:13.753

您的查询应该是

```
SELECT
user.sid_customer,
user.systemuser_id,
user.postcode,
user.age,
user.gender,
num_streams 
FROM md_customer 
INNER JOIN 
( 
        SELECT sid_customer, COUNT(ods_streaming.sid_customer) num_streams 
        FROM ods_streaming group by sid_customer
) AS ods_streaming  
ON ods_streaming.sid_customer = md_customer.sid_customer 
```

上面的查询将返回 md_customer 中的行以及 ods_streaming 中的行的客户行。如果您想要所有客户及其计数（包括 0），那么您的查询应该是

```
SELECT
cust.sid_customer,
cust.systemuser_id,
cust.postcode,
cust.age,
cust.gender,
COUNT(strm.sid_customer) num_streams 
FROM 
   md_customer cust
LEFT OUTER JOIN ods_streaming  strm   
   ON cust.sid_customer = strm.sid_customer
group by 
cust.sid_customer,
cust.systemuser_id,
cust.postcode,
cust.age,
cust.gender 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T18:08:59.243

也许您可以尝试使用 group by 进行计数，而不是子选择。

```
SELECT
md_customer.sid_customer,
md_customer.systemuser_id,
md_customer.postcode,
md_customer.age,
md_customer.gender,
count(ods_streaming.num_streams)
FROM md_customer 
INNER JOIN ods_streaming 
on ods_streaming.sid_customer = md_customer.sid_customer
group by 1,2,3,4,5; 
```

你应该避免做像这样的子选择......这个 group by 应该让事情变得更快一点

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T18:09:14.717

```
SELECT
    u.sid_customer,
    u.systemuser_id,
    u.postcode,
    u.age,
    u.gender,
    num_streams.amount
FROM 
    md_customer u INNER JOIN (
            SELECT 
                ods_streaming.sid_customer,
                COUNT(ods_streaming.sid_customer) as amount 
            FROM
                ods_streaming 
            GROUP BY ods_streaming.sid_customer

        ) num_streams  ON ( num_streams.sid_customer = u.sid_customer ) 
```

此外：用户是大多数（如果不是全部）数据库引擎中**的保留字**

# shell - Hudson 后期构建步骤安全问题

> ID：12940472
> 
> 赞同：1
> 
> 时间：2012-10-17T18:01:05.250
> 
> 标签：shell, hudson, post-build

Hudson 作业可以配置为具有可以执行 shell 命令作为选项的构建后步骤，意外或有意有人可以通过运行 rm 命令清除 hudson 主目录是否有一组特定的主目录权限可以防止此类设想

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T20:01:46.587

在 Linux 上，您可能会以“hudson”用户身份运行 Hudson 进程。使用 chown 和 chmod 的组合，您可以设置对 hudson 应用程序服务器目录的权限，以便 hudson 用户仅具有对 Hudson 应用程序服务器目录的读取权限。

Hudson 默认将其所有文件存储在 /var/lib/jenkins 中（如果您使用的是 .deb 包）。

所以基本上，确保 hudson 用户对该目录具有递归写访问权限，允许 hudson 只读访问其他 Hudson 安装文件，并且不能访问任何其他文件。

# c# - WPF 中使用 IDataErrorInfo 和 Validation.Errors 的验证摘要

> ID：12940483
> 
> 赞同：2
> 
> 时间：2012-10-17T18:01:41.133
> 
> 标签：c#, .net, wpf, validation, data-binding

我有一个 ViewModel，其中包含实现 IDataErrorInfo 的对象的 ObservableCollection：

```
public class ActivityCodesEditorViewModel : BaseViewModel
{
    public ObservableCollection<UIActivityCode> ActivityCodes
}
public class UIActivityCode : IActivityCode, INotifyPropertyChanged, IDataErrorInfo 
```

此集合绑定到数据网格（基础架构 XamDataGrid，但我认为这无关紧要）。验证在单元级别上效果很好，显示哪些对象有验证错误。

现在，我不仅想内联显示错误，而且还提供类似于我们在 asp.net 中的 ValidationSummary 的内容。我在网上看到过解决方案，所有这些解决方案都使用私有哈希集来跟踪错误。我不想要这种开销，而且我认为框架已经通过 Validation.Errors 处理了它。

我的用户界面看起来像这样：

```
<ListBox ItemSource="{Binding ElementName=ActivityCodesGrid, Path=(Validation.Errors)}" />
<igDP:XamDataGrid Name="ActivityCodesGrid"  DataSource="{Binding ActivityCodes}" /> 
```

你看，我想将 Validation.Errors 属性绑定到将显示它们的东西，但我无法正确绑定到它们或获取它的更新版本。 **这可以像这样直接绑定到 Validation.Errors**吗？

**编辑 1**

爆破！一旦我发布了这个问题，我发现了这个：

[在单个 WPF 控件中列出所有 Validation.Errors？](https://stackoverflow.com/questions/1615631/listing-all-validation-errors-in-a-single-wpf-control?rq=1)

看来 Validation.Errors 是一个数组，具有误导性。我将尝试第二个答案中列出的解决方案。如果您有与链接答案提供的不同的东西，请分享！

# haskell - 如何使用 Parsec 从文件中删除注释？

> ID：12940490
> 
> 赞同：3
> 
> 时间：2012-10-17T18:02:17.123
> 
> 标签：haskell, parsec

我有这么多：

```
comment :: GenParser Char st ()
comment =
    (string "--" >> manyTill anyChar newline >> spaces >> return ()) <|>
    (string "/*" >> manyTill anyChar (string "*/") >> spaces >> return ())

eatComments :: GenParser Char st String
eatComments = do
  xs <- many (do
          optional comment
          x <- manyTill anyChar (try comment)
          return x)
  return $ intercalate " " xs 
```

如果输入以注释结尾，则此方法有效，但如果以其他内容结尾，则失败。在这种情况下，错误消息就像

```
No match (line 13, column 1):
unexpected end of input
expecting "--" or "/*" 
```

因此，解析器正在寻找`eof`到达时的注释。我需要一些帮助来找到正确的组合器，我需要在所有可能的情况下吃掉所有的评论。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T18:21:48.010

也许使用类似[eof](http://hackage.haskell.org/packages/archive/parsec/3.0.0/doc/html/Text-ParserCombinators-Parsec-Combinator.html#v%3aeof)的东西？

```
comment :: GenParser Char st ()
comment =
    (string "--" >> manyTill anyChar newline >> spaces >> return ()) <|>
    (string "/*" >> manyTill anyChar ((try (string "*/") >> return ()) <|> eof) >> spaces >> return ()) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T19:09:09.623

我碰上了这似乎有效。但请随时批评：

```
comment :: GenParser Char st ()
comment =
    (string "--" >> manyTill anyChar newline >> spaces >> return ()) <|>
    (string "/*" >> manyTill anyChar (string "*/") >>  spaces >> return ())

notComment = manyTill anyChar (lookAhead (comment <|> eof))

eatComments :: GenParser Char st String
eatComments = do
  optional comment
  xs <- sepBy notComment comment
  optional comment
  return $ intercalate "" xs 
```

# html - 处理使用 DWT 文件及其索引的站点

> ID：12940491
> 
> 赞同：0
> 
> 时间：2012-10-17T18:02:18.903
> 
> 标签：html, dreamweaver, dwt

我负责更新的网站有一点小问题。

该站点的创建者使用 Dreamweaver 模板作为其基础，并有大约 10 个包含 DWT 代码的 html 文件。

我不再对 Dreamweaver 感兴趣，并且可以在没有 DWT 的情况下重写它，但它今天需要退出，所以这不是 atm 的选项。

我可以在 Dreamweaver 中轻松编辑模板，但是 html 文件的正文不可编辑。

据我所知，如果您编辑 DWT 文件，它引用的所有子文件都应该更新。

但是，本网站并非如此。

许多子 html 文件的正文包括以下标签：

```
 <!-- InstanceBeginEditable name="head" --><!-- InstanceEndEditable --> 
```

ETC...

有没有办法手动更新这些文件，还是有一个技巧来编辑 DWT 文件并让它指向更新的所有文件？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T19:47:27.820

看看你的菜单： `Modify > Library > Update Pages...`

从那里您应该能够选择您的整个站点（使用您当前正在编辑的模板的所有页面）。

然后，DW 将遍历使用所述模板构建的所有页面，并重写这些文件中的 HTML。

根据我对 DW 的经验，您最好将所有文件从中迁移出来...... :-) 使用模板很好，但是修改使用模板（在 DW 之外）的页面会占用该页面，它会很快变得丑陋——真的很快。一旦丑陋的人来参加聚会，就没有多少追索权了。

祝你好运

# objective-c - 无法在视图中设置标签

> ID：12940492
> 
> 赞同：0
> 
> 时间：2012-10-17T18:02:21.543
> 
> 标签：objective-c, ios, ipad, view, uilabel

我有以下情况。我有一个视图控制器（ContentController），顶部有 3 个按钮。下面我添加了第二个视图（contentView），这个视图应该显示这 3 个按钮后面的内容。因此，每次我按下按钮时，contentView 都会发生变化。所以我所做的是创建了三个加法控制器。

FirstController.m、FirstController.h、FirstController.xib

SecondController.m，SecondController.h，SecondController.xib，

ThirdController.m、ThirdController.h、ThirdController.xib、

在我的 ContentController.m 中，我添加了 3 个处理更改的 IBAction。

```
@interface ViewController ()

@property (nonatomic,strong) UIViewController *nextController;
@end

@implementation ViewController
@synthesize nextController = _nextController;

-(IBAction)chooseFirstController:(id)sender {
    _nextController = [[FirstController alloc] initWithNibName:@"FirstController" bundle:nil];
    [self.contentView addSubview:_nextController.view];

}
-(IBAction)chooseSecondController:(id)sender{
    _nextController = [[SecondController alloc] initWithNibName:@"SecondController" bundle:nil];
    [self.contentView addSubview:_nextController.view];
}
-(IBAction)chooseThirdController:(id)sender{
    _nextController = [[ThirdViewController alloc] initWithNibName:@"ThirdViewController" bundle:nil];
    [self.contentView addSubview:_nextController.view];
} 
```

我的第一个和第三个控制器只是在 contentController 的 contentView 中显示 tableviews。但在我的 secondController 中，我使用了 gridView 来显示项目。现在，当我按下一个单元格时，它应该转到一个 detailViewController，它会显示有关该单元格的更多信息。所以在我的 cellForRowAtIndex 中，我做了以下事情。

```
- (void)gridView:(NRGridView *)gridView didSelectCellAtIndexPath:(NSIndexPath *)indexPath
{
    NSLog(@"cell clicked");
    PlayerDetailController *playerController = [[PlayerDetailController alloc]initWithNibName:@"PlayerDetailController" bundle:nil];
    [playerController setLblTest:@"hooray this works"];
    [self.view addSubview:playerController.view];

} 
```

它正确执行 setLblTest 并在我的 ContentView 中显示 detailViewcontroller。但它不会改变标签。对我的@“hooray”来说，这是可行的。但是，尽管您可以在我的日志中看到它正确地传递了它。

```
@synthesize testLabel = _testLabel;
@synthesize lblTest = _lblTest;

-(void)setLblTest:(NSString *)lblTest{
    if(![_lblTest isEqual:lblTest]){
        _lblTest = lblTest;
    }
    NSLog(@"log komt %@",lblTest);
    [_testLabel setText:lblTest];
} 
```

**日志**

```
RacingGenk[567:c07] log komt hooray this works 
```

希望这能更多地澄清我的问题

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T19:40:41.787

要更新标签，您需要将代码更改为如下所示。

`self.testLabel.text = lblTest;`

# forms - 从谷歌电子表格发送电子邮件

> ID：12940499
> 
> 赞同：1
> 
> 时间：2012-10-17T18:03:06.047
> 
> 标签：forms, submit, google-apps-script

我发现以下脚本将表单提交值插入到谷歌电子表格中。

```
function doPost(e) { // change to doPost(e) if you are recieving POST data
  var ss = SpreadsheetApp.openById(ScriptProperties.getProperty('active'));
  var sheet = ss.getSheetByName("DATA");
  var headers = sheet.getRange(1, 1, 1, sheet.getLastColumn()).getValues()[0]; //read headers
  var headers2 = sheet.getRange(2, 1, 1, sheet.getLastColumn()).getValues()[0]; //read headers  
  var nextRow = sheet.getLastRow(); // get next row
  var cell = sheet.getRange('a1');
  var col = 0;
  for (i in headers2){ // loop through the headers and if a parameter name matches the header name insert the value
    if (headers2[i] == "Timestamp"){
      val = new Date();
    } else {
      val = e.parameter[headers2[i]]; 
    }
    cell.offset(nextRow, col).setValue(val);
    col++;
  }
  //http://www.google.com/support/forum/p/apps-script/thread?tid=04d9d3d4922b8bfb&hl=en
  var app = UiApp.createApplication(); // included this part for debugging so you can see what data is coming in
  var panel = app.createVerticalPanel();
  for( p in e.parameters){
    panel.add(app.createLabel(p +" "+e.parameters[p]));
  }
  app.add(panel);
  return app;
}
//http://www.google.sc/support/forum/p/apps-script/thread?tid=345591f349a25cb4&hl=en
function setUp() {
  ScriptProperties.setProperty('active', SpreadsheetApp.getActiveSpreadsheet().getId());
} 
```

现在，我想在每次插入一行时向我的两个同事发送一封格式化的电子邮件。我尝试使用：

```
 var emailAddress = "email@gmail.com";  // First column
    var message = "message";       // Second column
    var subject = "Sending emails from a Spreadsheet";
    MailApp.sendEmail(emailAddress, subject, message); 
```

但它没有发送任何东西..有人可以建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T00:49:52.820

我有同样的麻烦。

使用最新版本的 Google Apps，我必须保存脚本、创建新修订版并重新发布脚本，确保选择新修订版。在此之后，新代码生效。我浪费了几个小时，以为只要保存它就会更新脚本。

不知何故，新方法将脚本保存在其他地方。除非您完成保存修订并重新发布的过程，否则几乎不可能知道实际运行的是什么代码。

# gwt - 一种通过 ImageBundle 反转 sprite 合成过程并将生成的 sprite 拆分回图像片段的工具

> ID：12940504
> 
> 赞同：0
> 
> 时间：2012-10-17T18:03:23.447
> 
> 标签：gwt, sprite, clientbundle, gwt-compiler

是否有任何工具（也许*GWT 编译器本身*可以用作独立应用程序）用于从`*.cache.png`编译期间创建的文件生成单个图像？

或者，是否可以通过 API 获得映射信息（用于精灵几何图形）？

我查找了[GWT 存储库](http://code.google.com/p/google-web-toolkit/source/search?q=enableinlining&origq=enableinlining&btnG=Search+Trunk)、[文档](https://developers.google.com/web-toolkit/doc/2.4/DevGuideClientBundle)、StackOverflow 上的信息，可能还有关于该主题的每个 google 组，但无济于事。

### 动机

我的目标是通过指示 GWT 编译器避免内联捆绑图片（`<set-property name="ClientBundle.enableInlining" value="false" />`使用图形设计师只编辑打包 WAR 中的图像资产（希望通过提供这样的工具使他/她更容易一些）。

设计师将**使用提供的工具来拆卸和重新组装精灵图像**，以便于编辑。

### 插图

![精灵到片段](../Images/f35d34b4082a6868cf63ad642476ea19.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-18T16:26:24.657

嗯，这不是一件容易的事（真的，在设计师完成作业后重新编译应用程序要简单得多），但你没有理由做不到。

首先，您可以要求 GWT 编译器将生成的类输出到磁盘（使用`-gen`参数）。你会在那里找到你的实现`ClientBundle`，所有`ImageResource`方法都返回`ImageResourcePrototype`. IIRC，您应该能够编译这些类并使用它们来获取每个精灵的区域，从而从包中提取单个图像，并将它们重新打包回来。

# android - 无法在 Windows 7H 中安装 ADT 插件

> ID：12940505
> 
> 赞同：2
> 
> 时间：2012-10-17T18:03:26.110
> 
> 标签：android, eclipse, adt

虽然这是一个常见的问题。我搜索了几乎所有与此问题相关的主题。做了人们所说的一切，但它只是没有工作。我禁用我的防火墙，禁用防病毒。以管理员身份运行eclipse，但无法安装。甚至我尝试过离线安装。但我失败了。我已经尝试了所有可能的方法。我尝试使用两者：

[http://dl-ssl.google.com/android/eclipse/](http://dl-ssl.google.com/android/eclipse/)

[https://dl-ssl.google.com/android/eclipse/](https://dl-ssl.google.com/android/eclipse/)

不知道该怎么办。看来我永远无法在我的 PC 上尝试 android 编程。

我的 Eclipse 版本：Eclipse Classic 4.2.1

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T18:35:04.860

一些事情：

1.  你得到什么错误？
2.  其他人对 ADT / Eclipse Classic 有一些问题。阅读这篇文章[在 Eclipse Classic 3.6.1 上安装 Android ADT 插件 v9.0.0 失败](https://stackoverflow.com/questions/4934362/installing-android-adt-plugin-v9-0-0-on-eclipse-classic-3-6-1-failed)
3.  您是否有任何理由不能将 Eclipse IDE 用于 Java EE 开发人员。这将确保满足 java 相关的先决条件。
4.  重新安装 Eclipse。原始安装可能有问题或文件丢失。（只是说）

--编辑--您使用的是 JDK 7 吗？有人抱怨这是 JDK 7 的问题，降级到 JDK 6 解决了这个问题。如果没有其他方法，我会试一试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T21:31:57.960

你是通过代理吗？我最终遇到了同样的问题，我通过正确输入代理信息解决了这个问题。

# sql - tsql 与 float 和 varchar 合并

> ID：12940511
> 
> 赞同：1
> 
> 时间：2012-10-17T18:03:55.813
> 
> 标签：sql, sql-server-2008, tsql

我有一个浮点字段，它显示如下数据：

```
1
1.00
3.12
3.00 
```

我还有一个 varchar 字段，显示如下：

```
NA
ND 
I 
```

数据是这样的：Fld_N 是浮点数，Fld_S 是 varchar

```
Fld_N   Fld_S
-----   ------
1 
        ND
1.00    
3.12
3
       NA
       I 
```

请注意，一行可以具有 Fld_N 或 Fld_S 的值，但不能同时具有两者。

我正在做的是使用合并：

```
 COALESCE(STR(Fld_N,9,2), Fld_S)  Fld 
```

这不太好用，因为我的小数点总是最多 2 个小数点，而我需要它来支持显示 1 和 1.00。有没有办法在我的示例中不指定小数点并且仍然可以显示 1 和 1.00？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T18:09:22.317

尝试转换功能：

合并（转换（varchar，Fld_N），Fld_S）Fdl

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T18:07:33.740

`1`在浮点型列中，和之间绝对没有区别`1.00`。因此，您的建议实际上是不可能的。实际上，存储在数据库中的第 1 行和第 3 行的数据是相同的。

* * *

但是，您可以强制转换为 VARCHAR 而不是使用 STR，这将使用最少的小数位数：

```
COALESCE(CAST(fld_N AS VARCHAR(12)), Fld_S) AS Fld 
```

这应该产生：

```
弗尔德
-----
1
ND
1    
3.12
3
不适用
一世

```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T18:08:10.827

而不是`STR`，使用

```
CAST(fld_N AS VARCHAR(9)) 
```

将`VARCHAR`仅使用尽可能多的小数位来显示您提供的值。

将其放入您的遗嘱中`COALESCE`会产生：

```
COALESCE(CAST(fld_N AS VARCHAR(9)), Fld_S) AS Fld 
```

# vb.net - 为什么 FileSystemWatcher 会触发两次

> ID：12940516
> 
> 赞同：8
> 
> 时间：2012-10-17T18:04:16.393
> 
> 标签：vb.net, visual-studio-2010, filesystemwatcher

为什么 FileSystemWatcher 会触发两次？有没有简单的方法来修复它？当然，如果我更新或编辑文本文件，它应该只触发一次？

这个链接在这里[http://weblogs.asp.net/ashben/archive/2003/10/14/31773.aspx](http://weblogs.asp.net/ashben/archive/2003/10/14/31773.aspx)说

> 1.  引发两次的事件 - 如果显式指定事件处理程序（AddHander FSW.Created、AddressOf FSW_Created），则将引发两次事件。这是因为默认情况下，公共事件会自动调用相应的受保护方法（OnChanged、OnCreated、OnDeleted、OnRenamed）。要纠正此问题，只需删除显式事件处理程序 (AddHandler ...)。

“删除显式事件处理程序”是什么意思？

```
Imports System.IO

Public Class Form2

    Private Sub FileSystemWatcher1_Changed(ByVal sender As System.Object, ByVal e As System.IO.FileSystemEventArgs) Handles FileSystemWatcher1.Changed

        'this fires twice
        MessageBox.Show("test")

    End Sub

    Private Sub Form2_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load

        FileSystemWatcher1.Path = "C:\Users\c\Desktop\test\"
        FileSystemWatcher1.NotifyFilter = NotifyFilters.LastAccess Or NotifyFilters.LastWrite Or NotifyFilters.FileName Or NotifyFilters.DirectoryName Or NotifyFilters.CreationTime

        FileSystemWatcher1.IncludeSubdirectories = False
        FileSystemWatcher1.Filter = "text.txt"

    End Sub

End Class 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-17T18:20:07.617

更新：

我想出了2个解决方案。一个使用线程，另一个不使用。选择你的:-)。

*没有线程：*

```
Imports System.IO

Public Class Form1
    Private Sub FileSystemWatcher1_Changed(ByVal sender As System.Object, ByVal e As System.IO.FileSystemEventArgs) Handles FileSystemWatcher1.Changed
        Dim watcher As System.IO.FileSystemWatcher = sender
        watcher.EnableRaisingEvents = False

        'Do work here while new events are not being raised.
        MessageBox.Show("Test")

        watcher.EnableRaisingEvents = True 'Now we can begin watching for new events.

    End Sub

    Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load

        FileSystemWatcher1.Path = "C:\Users\c\Desktop\test"
        FileSystemWatcher1.NotifyFilter = NotifyFilters.LastWrite
        FileSystemWatcher1.IncludeSubdirectories = False
        FileSystemWatcher1.Filter = "test.txt"

    End Sub

    Private Sub FileSystemWatcher_OnChanged(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

End Class 
```

此解决方案（无线程）将 watcher.EnableRaisingEvents 设置为 False。在此之后，您通常会处理受影响（或更改）的任何文件。然后在您完成工作后将 EnableRaisingEvents 设置回 True。

*使用线程：*

```
Imports System.IO

Public Class Form1
    Private Sub FileSystemWatcher1_Changed(ByVal sender As System.Object, ByVal e As System.IO.FileSystemEventArgs) Handles FileSystemWatcher1.Changed
        FileSystemWatcher1.EnableRaisingEvents = False
        Threading.Thread.Sleep(250)
        FileSystemWatcher1.EnableRaisingEvents = True

        MessageBox.Show("test")

    End Sub

    Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load

        FileSystemWatcher1.Path = "C:\Users\c\Desktop\test"
        FileSystemWatcher1.NotifyFilter = NotifyFilters.LastWrite
        FileSystemWatcher1.IncludeSubdirectories = False
        FileSystemWatcher1.Filter = "test.txt"

    End Sub

    Private Sub FileSystemWatcher_OnChanged(ByVal sender As System.Object, ByVal e As System.EventArgs)

    End Sub

End Class 
```

这个解决方案虽然有点*老套*，但确实有效。它会在 250 毫秒内禁用检查新更改/事件，然后重新启用检查，前提是您不需要每 250 毫秒检查一次更改。我已经尝试了几乎所有我能想到的为您找到真正解决方案的方法，但这同时也会奏效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T18:19:17.580

检查 e.ChangeType。我想你会收到两个不同的通知。也许是 LastAccess 和 LastModified。在这种情况下，这是预期的行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-05-01T18:06:51.467

今天我在 FileSystemWatcher 中崩溃并找到了这个站点。建议的 Thread.Sleep 不能完全消除问题。用快速反整数测试。并且正在阻止用户界面。最有问题的是启动，它在 5 秒时滑入低谷。然后我立即在 TimerWatcherChanged.Tick 中设置 FileSystemWatcher1.EnableRaisingEvents = False 并且再也没有启用......但令人惊讶的是，计数器仍然可以捕获多达 4 个事件！我想与可调定时器分享我的解决方案，非阻塞。欢迎反馈。

```
Imports System.IO

Imports System.Diagnostics

Public Class Form1
  Dim fileName As String
  Dim Fsw_counter As Integer
  WithEvents TimerWatcherChanged As New Windows.Forms.Timer
  WithEvents TimerTest As New Windows.Forms.Timer

  Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load
    TimerWatcherChanged.Interval = 100
    TimerTest.Interval = 100 : TimerTest.Start()
    TextBox1.Text = "C:\Downloads\New Text Document.txt"
    TextBox1.SelectionStart = TextBox1.Text.Length
    WatcherSetup()
  End Sub

  Sub WatcherSetup()
    fileName = TextBox1.Text
    FileSystemWatcher1.IncludeSubdirectories = False
    FileSystemWatcher1.Path = Path.GetDirectoryName(fileName)
    FileSystemWatcher1.Filter = Path.GetFileName(fileName)
    FileSystemWatcher1.NotifyFilter = NotifyFilters.LastWrite
    FileSystemWatcher1.EnableRaisingEvents = True
  End Sub

  Private Sub TextBox1_TextChanged(sender As Object, e As EventArgs) Handles TextBox1.TextChanged
    WatcherSetup()
  End Sub

  Private Sub FileSystemWatcher1_Changed(sender As Object, e As FileSystemEventArgs) Handles FileSystemWatcher1.Changed
    If TimerWatcherChanged.Enabled = False Then
      TimerWatcherChanged.Enabled = True
      Fsw_counter += 1
      ' ***** Your WATCH Code put here... *****
    End If
  End Sub

  Private Sub TimerWatcherChanged_Tick(sender As Object, e As EventArgs) Handles TimerWatcherChanged.Tick
    TimerWatcherChanged.Enabled = False
  End Sub

  Private Sub TimerTest_Tick(ByVal sender As Object, ByVal e As System.EventArgs) Handles TimerTest.Tick
    TextBox2.Text = "Changed: " & Fsw_counter
    If TimerWatcherChanged.Enabled = True Then
      TextBox2.BackColor = Color.Red
    Else
      TextBox2.BackColor = Color.LawnGreen
    End If
  End Sub
End Class 
```

# javascript - jQuery(..).load(..) 不工作

> ID：12940518
> 
> 赞同：0
> 
> 时间：2012-10-17T18:04:21.480
> 
> 标签：javascript, jquery, html, css, ajax

我学习 jQuery ajax，但不工作。我点击 div，但没有任何反应。请帮我找出我犯错的地方。

js脚本：

```
$(document).ready(function(){
    $('#maindiv').click(function(){
        $(this).load('q.txt')
    });
}); 
```

带有一个 div 的 html 页面：

```
<!DOCTYPE html>
<html>
<head>
    <title>Ajax</title>
    <meta charset="UTF-8">
    <script type="text/javascript" src="js/aj.js"></script>
    <script type="text/javascript" src="js/jquery.js"></script>
</head>
<body>
    <div id="maindiv"></div>
</body>
</html> 
```

q.txt 有一个单词。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-17T18:05:46.967

您的 jQuery 文件需要首先加载。如果您查看控制台，我相信您会收到 $ 未定义错误。

```
<script type="text/javascript" src="js/jquery.js"></script>
<script type="text/javascript" src="js/aj.js"></script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T18:07:13.187

您需要更改包含脚本源文件的顺序。

```
<script type="text/javascript" src="js/aj.js"></script>
<script type="text/javascript" src="js/jquery.js"></script> 
```

应该改为

```
<script type="text/javascript" src="js/jquery.js"></script>
<script type="text/javascript" src="js/aj.js"></script> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-17T18:07:17.007

其他已经提到了导入的顺序。

另一个问题是你的 div`maindiv`是空的。所以你不能点击它。

在里面放点东西：

```
<div id="maindiv">CLICK ME</div> 
```

# c++ - 检查 STL 中的空交叉点

> ID：12940522
> 
> 赞同：9
> 
> 时间：2012-10-17T18:04:32.020
> 
> 标签：c++, stl, set

如何检查两个`std::set`s 的空交集？我可以使用`set_intersection`，但这太慢了，我只需要`bool`回答。

备注：`std::set`表示有序集合，它们属于同一类型等。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-17T18:07:59.947

自己编码有什么问题吗？

```
bool empty_intersection(const set<int>& x, const set<int>& y)
{
    std<int>::const_iterator i = x.begin();
    std<int>::const_iterator j = y.begin();
    while (i != x.end() && j != y.end())
    {
      if (*i == *j)
        return false;
      else if (*i < *j)
        ++i;
      else
        ++j;
    }
    return true;
} 
```

反正是这样的。完全未经测试的代码。

# hibernate - 未来如何为spring mvc3设计服务层用于Hibernate实现

> ID：12940524
> 
> 赞同：0
> 
> 时间：2012-10-17T18:04:38.823
> 
> 标签：hibernate, spring-mvc, jdbc, jdbctemplate

我们现在正在使用 Spring jdbcTemplate 来实现服务层，但在未来的某个时候我们想转向休眠。我担心当我们迁移到 Hibernate 时，我们当前服务层的设计方式是否有效。

目前我们有：为了清楚起见，我省略了细节

上下文 xml 中的数据源

```
<bean id="dataSource" destroy-method="close" class="...BasicDataSource">
    <property name="" value="" />
    <property name="" value="" />
    <property name="username" value="" />
    <property name="password" value=""/>      
</bean> 
```

服务等级

```
@Repository 
public class MyService {
   private JdbcTemplate jdbcTemplate;
        @Autowired
        public void setDataSource (DataSource ds) {
            this.jdbcTemplate = new JdbcTemplate(ds);
        } 
@Transactional 
public void myTransactions () {...}  
} 
```

控制器：

```
@Autowired
private MyService  myService; 
```

我在 spring mvc 中看到了很多 hibernate 服务层的实现，其中大多数使用`interface`. 添加接口有什么好处？我应该`interface`在我的设计中添加一个吗？过渡到休眠时，这会使事情变得更容易吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T18:35:44.500

我唯一的建议是使用接口并使用贫血的域模型。这样，您可以毫不费力地使用 spring 切换接口实现。

这就是您使用接口获得的好处。

假设你有这个包装和类：

```
org.company.samples.dao.Dao // Generic Dao Interface
org.company.samples.dao.DomainEntityDao // Domain Dao extends Generi Dao
org.company.samples.dao.jdbc.BaseDao // Generic implementation of Dao Interface
org.company.samples.dao.jdbc.DomainEntityDaoImpl // Domain Dao implementation extends BaseDao 
```

然后你想切换到休眠，这样你就可以做这个结构

```
org.company.samples.dao.Dao // Generic Dao Interface
org.company.samples.dao.DomainEntityDao // Domain Dao extends Generi Dao
org.company.samples.dao.hibernate.BaseDao // Generic Hibernate implementation of Dao Interface
org.company.samples.dao.hibernate.DomainEntityDaoImpl // Domain Dao implementation extends BaseDao 
```

如果你在你的 daos 中使用注解，那么在 spring 中从 jdbc 切换到 hibernate 是非常简单的：

而不是这个：

```
<context:component-scan base-package="org.company.samples.dao.jdbc" /> 
```

你为此改变它：

```
<context:component-scan base-package="org.company.samples.dao.hibernate" /> 
```

就是这样，您可以在不更改服务类型的情况下切换您的 daos 实现。

# java - 尝试打印排序数组时打印的意外值

> ID：12940525
> 
> 赞同：0
> 
> 时间：2012-10-17T18:04:44.750
> 
> 标签：java, sorting

这是我的代码。有人可以帮我解决这个错误吗？

```
public class ExcahngeSort {

    public double[] ExSort(double[] gangnam,int size)
    { double temp;

        for(int outrloop=1;outrloop<size;outrloop++)
        {

            for (int innrloop=0;innrloop<size-outrloop;innrloop++)
            {

                if(gangnam[innrloop]>gangnam[innrloop+1])
                {
                     temp=gangnam[innrloop];
                    gangnam[innrloop]=gangnam[innrloop+1];
                    gangnam[innrloop+1]=temp;
                }
            }
        }   
        return gangnam;
    }
} 
```

`[D@360be0`我打印了一个意外的值。我不知道这是什么意思。

这是我的主要方法：

```
public class BsortSimulate {
    public static void main (String args []){

        //BSort bs = new BSort();
        ExcahngeSort es = new ExcahngeSort();
        double gangnam [] = {12,24};

        System.out.println(es.ExSort(gangnam, 2));

        }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T18:05:49.183

您打印的数组不正确，请使用[`Arrays.toString()`](http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html#toString%28double%5b%5d%29)实用程序方法：

```
System.out.println(Arrays.toString(es.ExSort(gangnam, 2))); 
```

`toString()`与大多数`List`实现相反，Java 中的数组不会覆盖。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T18:05:40.147

```
System.out.println(Arrays.toString(es.ExSort(gangnam, 2))); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T18:05:54.397

这不是错误。您正在尝试打印数组对象。您不能在 Java 中为数组覆盖 toString()。

您的打印声明应如下所示：

例子：

```
System.out.println(Arrays.toString(es.ExSort(gangnam, 2))); 
```

# c++ - C++ 访问私有成员

> ID：12940526
> 
> 赞同：1
> 
> 时间：2012-10-17T18:04:46.830
> 
> 标签：c++

嗨，我正在阅读 Joshi 的 C++ Design Patterns and Derivatives Pricing 的第 4 章，但我不理解代码的某些部分。我们有一个 PayOff 类，我们想定义一个以 PayOff 作为成员的 VanillaOption 类。为了有效地做到这一点，他使用了一个虚拟复制构造函数。

```
#ifndef PAYOFF_H
#define PAYOFF_H

class PayOff
{
private:
public:
    PayOff(){}
    virtual double operator() (double Spot) const = 0;
    virtual PayOff* clone() = 0;
    virtual ~PayOff(){}
};

class PayOffCall : public PayOff
{
private:
    double Strike;
public:
    PayOffCall(double Strike_);
    virtual PayOff* clone(){return new PayOffCall(*this);}
    virtual ~PayOffCall(){}
};
#endif 

#ifndef VO_H
#define VO_H
#include "PayOff.h"

class VanillaOption
{
private:
PayOff* ThePayOffPtr;               
double Expiry;
public:
VanillaOption(PayOff&,double );     //constructor
VanillaOption(VanillaOption& original) {thePayOffPtr = original.thePayOffPtr->clone(); Expiry = original.Expiry;}       //copy constructor
VanillaOption& operator=(VanillaOption&);       

~VanillaOption();
 };

#endif 
```

我不明白 VanillaOption 的复制构造函数如何访问 original 的私有成员，即为什么我可以这样做 thePayOffPtr = original.thePayOffPtr->clone(); 和到期=原始。到期；。有人可以帮忙吗？提前谢谢了。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-17T18:07:22.870

访问控制适用于整个类，而不是实例。类的方法可以访问在该类中定义的私有成员，*甚至在该类的其他对象上*。即使构造函数在不同的对象 ( `this != &original`) 上运行，您仍然可以访问私有成员，`original`因为构造函数是定义私有成员的类的一部分。

请记住：方法和构造函数属于*类本身*，而不是实例！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T18:44:21.027

考虑它的方式是一个类可以访问它自己的私有部分。如果不能，那么您必须编写方法来公开实现以促进复制构造之类的事情，这会损害封装。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T18:17:38.107

在为一个类编码时，如果您需要访问某个其他类的成员（即时变量或方法），则它们必须是公共的。可以通过为该类创建一个对象从任何类访问该类的公共成员.getter 和 setter 方法是理解这一点的好例子。通常即时变量被声明为私有，而方法被声明为公共。所以我们只能使用这些方法来访问即时变量，而不能直接使用。

# javascript - jQueryMobile pagebeforechange 获取目标页面 id

> ID：12940527
> 
> 赞同：0
> 
> 时间：2012-10-17T18:04:53.440
> 
> 标签：javascript, jquery-mobile, jquery

我得到了一些在每个站点上可见的控件。要将这些控件移动到当前活动的页面，我正在使用该`pagebeforechange`事件。

```
$(document).bind('pagebeforechange',function(e,data) {
  var topageid=$(data.toPage).attr('id'); //MY QUESTION IS ON THIS LINE
  console.log("Changing page to "+topageid);
  $header = $('#myheader');
  $footer = $('#myfooter');
  $header.detach();
  $footer.detach();
  $header.prependTo(topageid);
  $footer.appendTo(topageid);
 }); 
```

上面显示的源代码有时有效，有时无效。那是因为有时`data.toPage`只包含一个像`...index.html#mypage`. `toPage`在任何情况下如何检测 id ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T18:36:39.880

您可以使用`pagebeforeshow`事件而不是`pagebeforechange`事件。不同之处在于前者在外部页面添加到 DOM 之后触发，而后者在此之前触发。

还有其他适合您的页面事件：http: [//jquerymobile.com/demos/1.2.0/docs/api/events.html](http://jquerymobile.com/demos/1.2.0/docs/api/events.html)

从文档（链接到上面）：

> **pagebeforechange**
> 
> 此事件在任何页面加载或转换之前触发。

.

> **显示前的页面**
> 
> 在实际过渡动画开始之前，在我们过渡到的“toPage”上触发。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-16T10:58:44.170

该`pagebeforechange`事件被触发两次，第一次是在目标页面加载之前触发，也就是当您`data.toPage`包含一个 URL 时。第二次触发事件时，目标页面被加载，在这种情况下，您将获得一个包含页面 DOM 的查询对象`data.toPage`。如果您想坚持参加该`pagebeforechange`活动，则可以执行以下操作：

```
if (typeof data.toPage != "string") {
    ... Do your stuff ...
} 
```

如果您对要使用的事件很灵活，请遵循 Jasper 的建议并使用 pagebeforeshow，这将允许您在页面转换到之前修改目标页面 DOM。

# java - 我的自定义事件应该在 GUI EDT 还是“本土”EDT 上触发

> ID：12940530
> 
> 赞同：2
> 
> 时间：2012-10-17T18:05:04.517
> 
> 标签：java, multithreading, swing, listeners, event-dispatch-thread

我正在开展一个项目，该项目会进行一些密集的数学计算（矩阵、向量等数组），所以我很自然地将工作分成工作，并将它们提交给 CompletionService 以并行执行工作。

每个作业对象都可以触发事件以在作业开始、结束、进行和/或失败时通知应用程序。

目前，每个作业都接收到整个事件侦听器列表的句柄，并简单地迭代，将事件对象传递给每个作业（在同一个线程中）。这对我来说并不好，所以我想获得其他人使用自定义事件/听众做这种事情的经验。

我应该将我的事件发送到 GUI 线程吗？一些侦听器可能与 GUI 相关，也可能不相关，我不想强​​迫我的代码用户必须手动将他们的事件发送到 GUI 线程，如下所示：

```
public class MyFooEventListener implements FooEventListener {
    public void notifyJobStarted(FooEvent evt) {
        // I want to avoid having users of my library write the following, right?
        SwingUtilities.invokeLater(new Runnable(){
            // update GUI here.
        });
    }
} 
```

我不介意编写自己的 EventQueue，因为这是针对学校的一个研究项目，我想这将是一个很好的并发练习。只是想弄清楚实现事件驱动系统的“正确”方式是什么，如何正确触发事件等。文章/教程和操作指南的链接也非常感谢。

谢谢！

**编辑：**

我的事件模型有多种事件类型，例如`JobStartedEvent`, `JobEndedEvent`,`JobProgressEvent`等。这是一种不好的方法吗？我应该有一个单一的事件类型，如果是这样，我如何将并非所有事件都通用的信息传递给侦听器？示例：我想为进度事件传递 [0-1] 范围内的双精度数，但这不适用于像 JobFailureEvent 这样的事件。处理此问题的最佳方法是什么？

我可以将额外的信息放在“源”对象本身中，但我的源对象本身就是 Job 对象，我不适合“泄漏”对 Job 对象的引用，尤其是在它运行时：

```
FooJob jobObject = (FooJob)event.getSource();
int progressPercent = jobObject.getCurrentProgress() * 100;
progressLabel.setText(progressPercent + "%"); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-17T18:11:26.247

不。在需要引发它们的任何线程上发出您的事件，并将其留给子系统的用户来决定他们希望如何处理它们。如果他们希望将结果发送到 GUI，那很好，如果没有，他们可以做任何他们想做的事情，例如。将它们排队到另一个线程。只需记录“在内部线程上引发事件并且事件处理程序不得阻塞”。

正如您所说，其他任何事情都会对他们可能不想要的用户施加限制。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-17T18:13:46.280

分发活动的方式有很多种，每种方式都有自己的优缺点。如果消费者不一定是 GUI，那么您绝对不应该将自己绑定到 awt EDT。除非您*确定*事件消费者将如何工作，否则我会从简单开始并从那里开始。简单的存在：同步通知每个消费者。如果这最终会延迟主要任务，那么您应该考虑异步通知。如果消费者最终是GUI，那么消费者的通知方法应该负责调用`SwingUtilities.invokeLater`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-17T18:14:15.097

只有直接影响 GUI 的线程才应该在 EDT 上。如果您有其他需要同步的线程，只需使用`synchronized`关键字（在方法或对象上）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-17T18:14:24.190

Spring 具有事件处理功能，您可以定义自定义事件[http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/beans.html#context-functionality-events](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/beans.html#context-functionality-events)。

# javascript - 通过链接将内部文件加载到 div 中而不刷新页面

> ID：12940531
> 
> 赞同：0
> 
> 时间：2012-10-17T18:05:10.277
> 
> 标签：javascript, jquery, ajax

我试图在点击页面一侧的链接时从我的站点中获取另一个页面，该页面位于同一目录中，并将其显示到名为 content 的 div 中。

::可选::如果我能想出一个简单的方法来做到这一点而无需刷新，否则刷新页面。

链接是

```
<a href="#" id="servicecall">Service Call</a> 
```

我的 jquery 是......不确定它是否会工作

```
$("#servicecall").click(function() {
  $("#content").load("servicecall.php");
}); 
```

内容是我在 servicecall.php 表单所在的右侧的 div。似乎发生的所有事情都是我的页面进行了刷新，但内容中没有显示任何内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T18:54:16.130

当您单击按钮时，它会返回错误或什么？例如这里： http: [//jsfiddle.net/9839Q/4/](http://jsfiddle.net/9839Q/4/) 当我点击服务调用链接时，它给了我一个错误，下面一行（Chrome）：

获取[http://fiddle.jshell.net/_display/index.php](http://fiddle.jshell.net/_display/index.php) 404（未找到）

确保您已将 jQuery 库添加到您的页面！也许你只是忘记了

```
<script src="http: //ajax.googleapis.com/ajax/libs/jquery/1.8/jquery. min .js"></script> //without spaces 
```

如果它们都没有，您可以尝试 $.ajax （希望它有效:)）：

```
 $.ajax({
    url: "servicecall.php",  
    type: "GET",            
    cache: false,
    success: function (html) {  
        //place servicecall.php's content to the content div
        $('#content').html(html);   
    }       
}); 
```

# jquery - 如何在 MVC 中上传文件

> ID：12940535
> 
> 赞同：0
> 
> 时间：2012-10-17T18:05:37.563
> 
> 标签：jquery, asp.net-mvc, vb.net, asp.net-mvc-3

> **可能重复：**
> [文件上传 ASP.NET MVC 3.0](https://stackoverflow.com/questions/5193842/file-upload-asp-net-mvc-3-0)

我试图在调试器中打印出文件的名称，以确保我得到它：

```
<EmployeeAuthorize()>
<HttpPost()>
Function SendNewMessage(ByVal file1 As HttpPostedFileBase) As JsonResult

    Dim fileName = Path.GetFileName(file1.FileName)
    Debug.Print(fileName)

    Return Nothing

End Function 
```

我用这个发送数据：

```
var file1 = $('#file1').val();

            $(this).parent('li').hide();
            $('#pleaseWait').show();

            $.ajax({
                url: '/Message/SendNewMessage',
                type: 'post',
                data: { file1: file1 },
                dataType: 'json',
                success: function (result) {
                    // update with results
                    //alert(JSON.stringify(result));
                    $.each(result, function (i, item) {
                        // do nothing
                    });
                    $('#myDiv').html(JSON.stringify(result));

                },
                error: function (result) {
                    alert('An error occurred when updating the database.  Please contact technical support.  ');

                }
            }); 
```

它不会在我的控制台中打印任何数据。它给出了一个`NullReferenceException`，所以我可以假设它根本没有得到文件名。我究竟做错了什么？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T18:48:21.083

文件不能直接通过ajax上传。取而代之的是，您应该使用 iframe 或 flash 或 jquery 特殊插件。

例如，您可以通过[jquery forms](http://www.malsup.com/jquery/form/#file-upload)插件完成 ajax 文件上传。

试试这个，它有效：

```
Public Class MessageController Inherits System.Web.Mvc.Controller

    Function SendNewMessage(ByVal file1 As HttpPostedFileBase) As JsonResult

        Dim fileName = Path.GetFileName(file1.FileName)
        Debug.Print(fileName)

        Return Nothing

    End Function

End Class 
```

在您看来，这是：

```
<script type="text/javascript" >
    $(function () {
        var options = {
            beforeSubmit: function (formData, jqForm, options) { },  // pre-submit callback 
            success: function (responseText, statusText, xhr, form) { }   // post-submit callback 
        };
        // bind form using 'ajaxForm' 
        $('#uploadForm').ajaxForm(options);
    });
</script>

<form action="/Message/SendNewMessage" enctype="multipart/form-data" method="post" id="uploadForm" >
    <input type="file" name="file1" />
    <input type="submit" value="send" /> 
</form> 
```

# c# - 查找以参数开始的进程

> ID：12940545
> 
> 赞同：2
> 
> 时间：2012-10-17T18:06:15.177
> 
> 标签：c#, process

我有一个可以通过参数运行的 C# 应用程序。例如

*   C:\MyApplication.exe
*   C:\MyApplication.exe -记录

这两个实例可以同时运行。在另一个应用程序中，我需要知道是否有任何以参数启动的实例运行，如果是，我想杀死它们。

我试图通过这样的代码得到它：

```
Process.GetProcesses().Where(x =>
               x.ProcessName.StartsWith("MyApplication") 
           && (x.StartInfo.Arguments == "-record")); 
```

但是 StartInfo.Arguments 是空的，即使我在使用参数启动进程时手动设置它也是如此。如何找到以参数开头的流程？

# php - 请求大量 Twitter API 数据、服务或操作方法？

> ID：12940550
> 
> 赞同：0
> 
> 时间：2012-10-17T18:06:38.760
> 
> 标签：php, mysql, api, rest, twitter

我正在编写一个需要从 Twitter请求*大量数据的数据分析服务。*我们尝试使用第三方解决方案，但成本很高，并且仍然存在限制。以下是我们的数据需求示例：

每天一次，我们有一个需要请求的实用程序：

用户信息，即@johndoe（有关所需数据，请参阅此 Twitter 响应：[https](https://dev.twitter.com/docs/api/1/get/users/lookup) ://dev.twitter.com/docs/api/1/get/users/lookup）@johndoe的每个关注者的用户信息。需要#tweets、#followers 等信息

我们还需要一种方法来找到@johndoe 的一个追随者提到/RT'd @johndoe 的提及/RT 的总数。

由于 Twitter 的速率限制/节流，我们可能无法使用 Twitter 的 API 来实现这一点。是否有任何其他服务或策略来获取如此多的数据？

该实用程序是用 PHP 编写的，并且还需要保存到 MySQL 数据库。不确定这是否是必要的信息，但只是确保。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T18:12:27.687

> 由于 Twitter 的速率限制/节流，我们可能无法使用 Twitter 的 API 来实现这一点。是否有任何其他服务或策略来获取如此多的数据？

直接联系 Twitter 了解您的批量需求，他们有理由限制免费 API。

# plone - diazo 忽略用于 Web 统计的 JavaScript

> ID：12940552
> 
> 赞同：4
> 
> 时间：2012-10-17T18:06:46.767
> 
> 标签：plone, diazo

我有一个 plone 4.2.1 站点，并且正在使用各种重氮主题。我还使用[Piwik](http://piwik.org/) 进行网络统计。不幸的是，当安装了重氮主题之一时，用于网络统计的 javascript 被完全忽略了。我已尝试按照[https://groups.google.com/forum/?fromgroups=#!topic/plone-users/VM4b51ergFA中的建议编辑](https://groups.google.com/forum/?fromgroups=#!topic/plone-users/VM4b51ergFA)**rules.xml**文件，但添加

```
<!-- Google Analytics JavaScript -->
<after theme-children="/html/body"
content="/html/body/div[@id='visual-portal-wrapper']/div/script" /> 
```

对我不起作用。

我可以使用其他任何选项来解决此问题吗？

谢谢，朱利安

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-18T07:15:04.907

viewlet plone.analytics 在页脚 viewlet 管理器中呈现：

```
<browser:viewlet
    name="plone.analytics"
    manager="plone.app.layout.viewlets.interfaces.IPortalFooter"
    class=".view.AnalyticsViewlet"
    permission="zope2.View"
    /> 
```

该片段按原样呈现，因此您可以按照您想要的方式识别您的脚本标签。

你应该试试

```
<script id="plone-analytics" ...>YOUR SCRIPT...</script> 
```

并修改 rules.xml 以将#plone-analytics 放在您的页脚中

在 Plone 4.2 中，至少 plone.analytics 不在可视门户包装器中，因此您尝试的规则将不起作用。

# windbg - 为什么 sosex!dlk 在 Windows 7 上永远运行？

> ID：12940556
> 
> 赞同：4
> 
> 时间：2012-10-17T18:06:58.137
> 
> 标签：windbg, sosex

我们最近从 Windows XP 迁移到了 Windows 7，自从迁移后，我发现我无法再在 WinDbg 中运行来自 Sosex 的 !dlk 命令，它只是永远运行。它曾经是一种在我们的代码中捕获死锁的便捷方法。

我应该知道的 Sosex 有什么变化吗？

我们在 Windows 7 64 位上调试运行在 Windows 7 64 位机器上的 x86 进程的故障转储。

与此同时，我可以尝试使用 !syncblk，但 !dlk 非常好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-18T13:02:25.707

正如 Rockstart 在评论中所说，最近几周对 SOSEX 的性能进行了重大改进。如果您在使用最新版本的 SOSEX 时仍有困难，请告诉我们。您还可以向 !sosex.help 中列出的地址发送电子邮件以获取支持。

# asp.net - Webmatrix - 格式化 MSSQL 数据库查询

> ID：12940557
> 
> 赞同：1
> 
> 时间：2012-10-17T18:07:00.247
> 
> 标签：asp.net, razor, webmatrix

我正在尝试在 WebMatrix 2 CSHTML 文件中格式化查询的输出。这是我正在使用的代码：

```
@foreach(var row in db.Query(selectQueryString))
{
   @row.Firstname; + " " + @row.lastname; + " " + @row.Entry;
} 
```

我收到此错误：

> 《CS0201：只有赋值、调用、递增、递减和新对象表达式可以作为语句使用》

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T18:36:17.527

第一个问题是分号可能会让 Razor 感到困惑，它们只是令人困惑的事情。所以将括号中的行更改为

```
<text>@row.Firstname @row.lastname @row.Entry</text> 
```

看看这是否有效。< text > 标签告诉 Razor 将其直接输出为 HTML，而不是将其用作代码。你不需要 + " " 因为一旦你输出 HTML，空格就会自动出现。

# iphone - 如何将 UITableViewController 中选定行的数量传递/发送到另一个类？

> ID：12940559
> 
> 赞同：1
> 
> 时间：2012-10-17T18:07:03.753
> 
> 标签：iphone, objective-c, ios, xcode, xcode4.5

伙计们，我在 XCODE4.5 中遇到了一些麻烦，希望您能帮助我！

如何使用方法 didSelectRowAtIndexPath 将 UITableViewController 中选定行的整数值传递或发送到另一个 ViewController？

这是我的代码：

```
SecondViewController.h
{
NSInteger myInteger;
}
@property(nonatomic) NSInteger myInteger;

SecondViewControl.m
-(void)viewDidLoad {
NSLog(@" the number is = %d",myInteger); //this is not working, I always get "the number is = 0 "
}

FirstViewController.h
#import "SecondViewController"
//...

FirstViewController.m
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath  *)indexPath {
if (indexPath) {
 NSIndexPath *path = indexPath;
    NSInteger theInteger = path.row;
 NSLog(@"selected row = %d", theInteger); //code OK

//THE PROBLEM STARTS HERE!!!!!!!!!!!!!!!!!!   

SecondViewController *second = [[SecondViewController alloc]init];
    [second setMyInteger:theInteger];
// i'm trying to use "second.myInteger = theInteger;" , but it's also not working

}
} 
```

谢谢你们！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T18:49:32.673

嗨，我认为您缺少合成 myInteger Veriable 修改您的 secondviewcontroller.m 文件

```
SecondViewControl.m

@synthesize myInteger;

-(void)viewDidLoad {
    NSLog(@" the number is = %d",myInteger); 
} 
```

希望这会帮助你:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T19:05:25.843

您的`myInteger`iVar 未使用编译器如何生成 iVar 并自动为属性合成 getter/setter。

编译器会在您声明属性时为您提供帮助，因此您无需声明自己的 iVar 或使用 @synthesize，除非您想要默认以外的行为。

该`@property(nonatomic) NSInteger myInteger;`行使编译器在您的实现中生成以下等效项。

```
@synthesize myInteger = _myInteger; 
```

因此，被默认设置器修改的 iVar 是`_myInteger`.

您可以在 SecondViewController 中执行以下操作之一。我更喜欢解决方案#1 b/c，它更简洁，代码更少，并利用了自动编译器行为。

1.  在 SecondViewController.h 中删除`myInteger`iVar 并在 SecondViewController.m 中将任何对 iVar 的引用更改为`_myInteger`或`self.myInteger`

或者

1.  在 SecondViewController.m 中，通过添加显式合成属性以使用您的 iVar`@synthesize myInteger;`

编辑：添加具体示例

```
// SecondViewController.h
@interface SecondViewContoller : UIViewController
@property(nonatomic) NSInteger myInteger;
@end

// SecondViewControl.m
-(void)viewDidLoad {
    NSLog(@" the number is = %d", self.myInteger);
}

// FirstViewController.h
#import "SecondViewController"
//...

// FirstViewController.m
//
// rest of implementation
//
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath  *)indexPath
{
    if (indexPath) {
        NSIndexPath *path = indexPath;
        NSInteger theInteger = path.row;
        NSLog(@"selected row = %d", theInteger);

        SecondViewController *second = [[SecondViewController alloc] init];
        second.myInteger = theInteger;
        // you need to present second somehow, viewDidLoad won't be called until then
        // example if using a navigationController
        [self.navigationController pushViewController:second animated:YES];
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T18:15:23.717

`prepareForSegue:sender:`假设您在 Xcode 4.5 中使用 Storyboard，则应该在方法中将参数传递给下一个参数。

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    // Make sure your segue name in storyboard is the same as this line
    if ([[segue identifier] isEqualToString:@"YOUR_SEGUE_NAME_HERE"])
    {
       SecondViewController *second = (SecondViewController *)segue.destinationViewController;
       second.selectedIndex = selectedIndex;
    }
} 
```

然后在您的 didSelectRowAtIndexPath: 方法中，您可以执行 segue：

```
[self performSegueWithIdentifier:@"YOUR_SEGUE_NAME_HERE"]; 
```

假设您在 SecondViewController 的头文件中有一个属性，它应该再次将参数传递给您的第二个视图，如下所示：

```
@property (nonatomic, assign) int *selectedIndex; 
```

**编辑：**

在您尝试执行的操作的上下文中，您可以轻松地在顶部的 FirstViewController 中创建一个私有属性，并将您的 selectedIndex 从您的 didSelectRowAtIndexPath: 存储在那里并在 prepareForSegue 中传递它：

```
@interface FirstViewController() {
    int selectedIndex;
} 
```

和

```
-(void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath  *)indexPath {
    selectedIndex = indexPath.row
} 
```

# php - jQuery Jcrop 和 PHP 实际上仅在 IE9 中不裁剪图像？

> ID：12940563
> 
> 赞同：0
> 
> 时间：2012-10-17T18:07:15.370
> 
> 标签：php, jquery, internet-explorer-9, jcrop

我的这个脚本有一个奇怪的错误，我不知道现在该去哪里。

用户上传图像，然后可以选择裁剪它。一旦他们裁剪它，PHP 应该调整图像大小并存储它。

此脚本在 IE8、IE7、Chrome、Safari、Firefox 等中运行良好。在 IE9 中，它失败了；它根本不会调整图像的大小。您上传一张 500x300 的图片，对其进行裁剪，但最终还是会得到一张 500x300 的图片，尽管没有触发任何错误消息。

"if(imagejpeg($dst_r,$src,$jpeg_quality)){" 检查返回 true 并且它正在重定向，即使在 IE9 中也是如此，但它实际上并没有编辑图像。

所有的帖子变量都通过了；如果我添加一个 print_r($_POST); 所有尺寸都很好。图片正在上传到 FTP，只是在 IE9 中没有调整大小。

任何帮助将不胜感激。

```
<?php

    //assign src
    $src = $uploadStoragePath.$_SESSION['USER']['user_id'].'/'.$_SESSION['crop_me'];

    if ($_SERVER['REQUEST_METHOD'] == 'POST'){

        //set width/height
        $targ_w = $targ_h = 125;

        //set jpeg quality
        $jpeg_quality = 90;

        //open the jpeg
        $img_r = imagecreatefromjpeg($src);
        $dst_r = ImageCreateTrueColor( $targ_w, $targ_h );

        //crop the jpeg
        imagecopyresampled($dst_r,$img_r,0,0,$_POST['x'],$_POST['y'],$targ_w,$targ_h,$_POST['w'],$_POST['h']);

        //header('Content-type: image/jpeg');

        //save the file
        if(imagejpeg($dst_r,$src,$jpeg_quality)){
            $_SESSION['GORB']['message'] = "Profile Picture Updated!";
            $_SESSION['GORB']['tone'] = "happy";
            header('Location: '.$siteConfigMainUrl.'db/?view=edit_profile_picture');
        }else{
            echo 'Image failed';
        }   
    }
?>
<html>
    <head>
        <script src="<?php echo $siteConfigUrl; ?>display/js/jquery.min.js"></script>
        <script src="<?php echo $siteConfigUrl; ?>display/js/jquery.Jcrop.min.js"></script>
        <link rel="stylesheet" href="css/jquery.Jcrop.css" type="text/css" />

        <script language="Javascript">

            function updateCoords(c)
            {
                $('#x').val(c.x);
                $('#y').val(c.y);
                $('#w').val(c.w);
                $('#h').val(c.h);
            };

            function checkCoords()
            {
                if (parseInt($('#w').val())) return true;
                alert('Please select a crop region then press submit.');
                return false;
            };

        </script>
        <script type="text/javascript">

            jQuery(function($){

            // create variables (in this scope) to hold the API and image size
            var jcrop_api, boundx, boundy;

                $('#target').Jcrop({
                    onChange: updatePreview,
                    onSelect: updatePreview,
                    aspectRatio: 1,
                    onSelect: updateCoords
                },function(){
                    // use the API to get the real image size
                    var bounds = this.getBounds();
                    boundx = bounds[0];
                    boundy = bounds[1];
                    // store the API in the jcrop_api variable
                    jcrop_api = this;
                });

                function updatePreview(c){

                    if (parseInt(c.w) > 0){
                        var rx = 125 / c.w;
                        var ry = 125 / c.h;

                        $('#preview').css({
                            width: Math.round(rx * boundx) + 'px',
                            height: Math.round(ry * boundy) + 'px',
                            marginLeft: '-' + Math.round(rx * c.x) + 'px',
                            marginTop: '-' + Math.round(ry * c.y) + 'px'
                        });
                    }
                };
            });
        </script>
    </head>
    <body>
        <div class="article">   
            <img src="<?php echo $uploadStoragePath.$_SESSION['USER']['user_id'].'/'.$_SESSION['crop_me'];?>" id="target" />
            <br/>
            <h1>Preview:</h1>
            <div style="width:125px;height:125px;overflow:hidden;">
                <img src="<?php echo $uploadStoragePath.$_SESSION['USER']['user_id'].'/'.$_SESSION['crop_me'];?>" id="preview" alt="Preview" />
            </div>

            <form action="<?php echo $siteConfigUrl.'?view=crop_profile_picture'; ?>" method="POST" onsubmit="return checkCoords();">
                <input type="hidden" id="x" name="x" />
                <input type="hidden" id="y" name="y" />
                <input type="hidden" id="w" name="w" />
                <input type="hidden" id="h" name="h" />
                <input type="submit" value="Crop Image" />
            </form>
        </div>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T17:34:32.120

最近几天我遇到了同样的问题。我用这个来解决。我希望这对你有用：

```
 if ($_SERVER['REQUEST_METHOD'] == 'POST')
     {
$targ_w = $_POST['w'];$targ_h = $_POST['h'];
$jpeg_quality = 100;
$image = $_POST['image'];
$dir = $_POST['rel'];
$imagen = $dir."/".$image;
$src = $imagen;
$img_r = imagecreatefromjpeg($src);
$dst_r = ImageCreateTrueColor( $targ_w, $targ_h );

imagecopyresampled($dst_r,$img_r,0,0,$_POST['x'],$_POST['y'],
$targ_w,$targ_h,$_POST['w'],$_POST['h']);

//header('Content-type: image/jpeg');
imagejpeg($dst_r, $dir.'/crop_'.$image.'', $jpeg_quality);

exit;
    } 
```

# smart-tv - 面向初学者的 SmartTV 开发

> ID：12940572
> 
> 赞同：45
> 
> 时间：2012-10-17T18:07:45.443
> 
> 标签：smart-tv

我现在正在做一些关于 SmartTV 开发的研究，这个话题似乎非常分散。

我的意思是：
如果你想开发一个 android 应用程序，你会得到 eclipse 和 android sdk。
如果你想为 iphone 开发，你会得到 xcode。

但是智能电视呢？
有三星 SDK、LG SDK、Google TV、SmartTV Alliance SDK……

那么我应该选择什么？
特别是如果我想

*   一次编写，到处运行
*   享受成熟的开发环境和工具

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-10-20T14:14:21.320

如果你想写一次......你应该选择“App Engine”，但它不是免费的，它的成本是 48.000 美元/年，最多开发 8 个应用程序。第二个选项是 SmartTV Alliance SDK。最成熟的SDK是三星的，LG的也不错，但是厂商支持不太好。

HTML 无疑是最有前途的技术，但我们应该考虑到现在市场非常分散。第一个获得重要角色的制造商/平台将拥有整个（和不断增长的）市场。

实际上最好的选择（在我看来）是： - PlayJam：他们拥有丰富的经验，并且是当今最先进的平台，他们也在与 Steam 合作 - Google TV：它可能成为电视的安卓系统......确实，这是一个基于 Android 的操作系统，而 LG、三星、索尼和 Vizio 已经拥有一个 GoogleTV 设备，飞利浦很快就会将自己添加到列表中。

到目前为止仅有的两个选项是 Adob​​e AIR 和 HTML，你要开发什么？我们正在开发一些休闲游戏，我们使用 Adob​​e AIR [http://www.youtube.com/watch?v=0e8cmy1Vmic](http://www.youtube.com/watch?v=0e8cmy1Vmic) [http://www.noriste.com/lg-smarttvs-adobe-air-3-0-and -应用测试/](http://www.noriste.com/lg-smarttvs-adobe-air-3-0-and-app-test/)

一些（可能很明显）链接：

三星 SDK - 支持 Java、HTML、Adobe AIR - samsungdforum.com

LG SDK - 支持 HTML、Adobe AIR、Unity - developer.lgappstv.com

Google TV SDK - 支持 Java、HTML、Adobe AIR、Unity -developers.google.com/tv/android

SmartTV Alliance SDK (LG, Sharp, Philips) - 支持 HTML - smarttv-alliance.org

NetTV SDK (Sharp, Philips) - 支持 HTML - yourappontv.com

Roku SDK - 支持 C++、Unity - roku.com/developer

PlayJam SDK - 支持 Adob​​e AIR，在 LG 和三星上运行（它们将支持 HTML） - playjam.com

TV App Engine - 支持 HTML 并将应用程序转换为原生应用程序 - tvappagency.com

Marmalade - 支持 C/C++ 并集成 PlayJam API - madewithmarmalade.com

Yahoo Connected TV - 支持 HTML - connectedtv.yahoo.com/developer

Opera TV - 支持 HTML - dev.opera.com/tv

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-01T07:06:55.877

我们正在开发跨平台。这都是关于经验的。完成 2 或 3 个应用程序后，您就会了解三星、LG、索尼、飞利浦和松下之间的差异，并且可以使用它。当然，QA 流程和电视测试是不同的章节——我们有 30 台电视仅用于测试。

另一方面，我们也有 30 部 Android 手机，所以比较 Android 和 SmartTV 的碎片化，我看不出有太大的差异，Symbian 上的情况相同，不同的网络浏览器版本甚至 iOS 版本都有类似的问题。

没有什么可以吓到或阻止您。BR彼得

[www.mautilus.com/blog](http://www.mautilus.com/blog)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-02-06T07:46:19.607

尝试 BBC Tal 框架，其开源并支持大多数智能电视

[http://fmtvp.github.io/tal/getting-started/introducing-tal.html](http://fmtvp.github.io/tal/getting-started/introducing-tal.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-12-04T11:11:05.943

# 构建 Android TV 应用

Android 提供了丰富的用户体验，针对在大屏幕设备（如高清电视）上运行的应用程序进行了优化。**电视上的应用程序**提供了新的机会，让您的用户在舒适的沙发上取悦他们。***[更多的...](http://developer.android.com/training/tv/start/index.html)***

**依赖项和先决条件**

1.  Android 5.0（API 级别 21）或更高版本
2.  [Android Studio 0.8 或更高版本和 Gradle 0.12 或更高版本](https://developer.android.com/sdk/installing/studio.html#download)

**[在这里为电视构建应用程序的更多详细信息..](http://developer.android.com/training/tv/index.html)**

# ruby-on-rails - 查找最近的捐款，不包括以 X 开头的资金

> ID：12940577
> 
> 赞同：0
> 
> 时间：2012-10-17T18:08:03.430
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, methods

我正在尝试获取最近一次捐赠的礼物日期（以美元计）给我的组织，该组织的基金 ID 不是以 X 开头（这些是加拿大捐赠）。这是我用来提取最近一次整体捐赠的礼物日期的代码（在控制器中），但它是加拿大的礼物（fund_id = XP05）。如何获得基金 ID 不以 X 开头的最新捐款？

```
@income_batch = Gift.between(Date.today - 2.weeks, Date.today, :field => :gift_date).order('gift_date DESC').first.gift_date 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T18:12:16.907

假设`fund_id`是表中的字符串字段`gifts`，您可以使用`not like`：

```
Gift.where("fund_id not like 'X%").between.... 
```

您还应该避免在字段上使用`_id`后缀，除非它们是外键，因为 Rails 约定`_id`专门用于此目的。

* * *

如果`fund_id` **是**外键，并且模型`belongs_to :fund`内部有一个`Gift`，则可以使用`joins`and `not like`：

```
Gift.joins(:fund).where("funds.name not like 'X%").between.... 
```

这假定`funds`表中的字段被调用`name`。

# iphone - 从 didExitRegion 获取准确坐标

> ID：12940579
> 
> 赞同：5
> 
> 时间：2012-10-17T18:08:09.987
> 
> 标签：iphone, objective-c, ios5, cllocationmanager

我正在实现一个应用程序，我需要通过以下方式跟踪用户的位置：

*   在应用程序处于后台或关闭时跟踪用户的位置
*   如果用户的位置改变了大约 2000 米，我应该执行 API 调用。

我解决这个问题的方法如下：

*   用户第一次启动应用程序时，我开始使用他当前的位置监视一个区域
*   如果触发了**didExitRegion**，我执行 API 调用并使用当前位置作为新区域中心的新区域替换当前监控区域。

当应用程序位于前台时，这可以正常工作，因为从位置管理器返回的位置是准确的。

但是如果应用程序在后台，那么位置管理器将不会返回准确的位置，因为它是第一次运行并且返回的第一个坐标不准确。

问题是如何在后台触发**didExitRegion**时获得用户的准确位置？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-03T23:59:20.160

我在`didExitRegion:`可靠射击方面运气不佳。它经常在比我所在地区的边缘更远的地方开火。

如果您只需要每 2 公里左右调用一次 API，我建议您使用`CLLocationManager`'s 。[`-startMonitoringSignificantLocationChanges`](http://developer.apple.com/library/ios/documentation/CoreLocation/Reference/CLLocationManager_Class/CLLocationManager/CLLocationManager.html#//apple_ref/occ/instm/CLLocationManager/startMonitoringSignificantLocationChanges)如果您的准确性/精度很重要，只需将位置服务注册为必要的后台状态（[`UIBackgroundModes`](http://developer.apple.com/library/ios/documentation/General/Reference/InfoPlistKeyReference/Articles/iPhoneOSKeys.html#//apple_ref/doc/uid/TP40009252-SW22)在您的应用程序列表中；您可能也需要这样做才能从后台使用重大更改 API），并使用 normal `-startUpdatingLocation`，适当[`distanceFilter`](http://developer.apple.com/library/ios/documentation/CoreLocation/Reference/CLLocationManager_Class/CLLocationManager/CLLocationManager.html#//apple_ref/occ/instp/CLLocationManager/distanceFilter)和实例[`desiredAccuracy`](http://developer.apple.com/library/ios/documentation/CoreLocation/Reference/CLLocationManager_Class/CLLocationManager/CLLocationManager.html#//apple_ref/occ/instp/CLLocationManager/desiredAccuracy)上的字段值。`CLLocationManager`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-31T11:08:41.933

这里发生了几件事。

您提到区域更改触发器有一点可变性。这是故意的；为避免在您沿着两个区域之间的边界走时触发大量触发器，在时间和位置上，触发器都会有一些粘性。

从文档（[http://developer.apple.com/library/ios/#documentation/UserExperience/Conceptual/LocationAwarenessPG/CoreLocation/CoreLocation.html#//apple_ref/doc/uid/TP40009497-CH2-SW1](http://developer.apple.com/library/ios/#documentation/UserExperience/Conceptual/LocationAwarenessPG/CoreLocation/CoreLocation.html#//apple_ref/doc/uid/TP40009497-CH2-SW1)）

```
The system does not report boundary crossings until the boundary plus a designated cushion distance is exceeded. You specify the desired cushion distance for a region when you register it using the startMonitoringForRegion:desiredAccuracy: method. This cushion value prevents the system from generating numerous entered and exited events in quick succession while the user is traveling close the edge of the boundary. 
```

获得准确的位置与正常情况没有什么不同。您启动位置管理器并等待，直到您获得所需精度的位置更新。关闭经理并使用该职位。

因为你在后台运行，你只有十分钟的时间来做这件事，你必须告诉操作系统你正在使用 UIApplication 的 startBackgroundTaskWithExceptionHandler 进行后台处理。其他地方的大量文档。

希望有帮助。

# ios - 用直接代码替换@selector

> ID：12940583
> 
> 赞同：4
> 
> 时间：2012-10-17T18:08:40.583
> 
> 标签：ios, cocoa-touch, selector

> **可能重复：**
> [我可以使用 Objective-C 将块作为 @selector 传递吗？](https://stackoverflow.com/questions/4581782/can-i-pass-a-block-as-a-selector-with-objective-c)

我有这个代码：

```
[myButton addTarget:self action:@selector(doSomething:) forControlEvents:UIControlEventTouchUpInside]; 
```

但是由于 doSomething 包含的代码太少，我想知道是否可以将代码直接放在这里而不是让它运行 doSomething。

我已经尝试过了：

```
[myButton addTarget:self action:^ { /* code here */ } forControlEvents:UIControlEventTouchUpInside]; 
```

但它只是给出了“将（void）^（void）发送到不兼容的类型SEL”的错误。

有没有办法做到这一点？如果是这样，正确的语法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-17T19:15:01.720

好吧，您所有的答案都使用了大量不必要的代码，这些代码已经过时并且不再有效。

我自己找到了一个答案，但我改编并得到了这个：

```
[myButton addTarget:[^{NSLog(@"Pressed the button");} copy] action:@selector(invoke) forControlEvents:UIControlEventTouchUpInside]; 
```

哪个工作正常。

# javascript - 如何使用 Require.js 优化项目以仅生成一个 Javascript 文件？

> ID：12940590
> 
> 赞同：3
> 
> 时间：2012-10-17T18:09:07.293
> 
> 标签：javascript, optimization, requirejs

我设法使用了 require.js，它是优化我的项目的优化器。但**它会生成 3 个 javascript 文件：**

**1.主文件**

require.js 配置文件（在 html 中作为*data-main*引用的那个）

**2.require.js库**

require.js 的代码。

**3.我的申请代码**

是否可以将这 3 个 javascript 文件合并到一个文件中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T18:23:41.260

看看 grunt js 项目，具体到：

```
 grunt concat 
```

和需要 js 的插件：

[https://github.com/asciidisco/grunt-requirejs](https://github.com/asciidisco/grunt-requirejs)

# java - 如何使用 Selenium WebDriver 和 java 从下拉列表中选择一个项目？

> ID：12940592
> 
> 赞同：42
> 
> 时间：2012-10-17T18:09:16.217
> 
> 标签：java, selenium, webdriver, selenium-webdriver

如何使用 Selenium WebDriver 和 Java 从下拉列表中选择一个项目，如性别（例如男性、女性）？

我试过这个

```
WebElement select = driver.findElement(By.id("gender"));
List<WebElement> options = select.findElements(By.tagName("Male"));
for (WebElement option : options) {
    if("Germany".equals(option.getText()))
        option.click();   
} 
```

我上面的代码不起作用。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-10-18T06:16:10.157

利用 -

```
new Select(driver.findElement(By.id("gender"))).selectByVisibleText("Germany"); 
```

当然，你需要 `import org.openqa.selenium.support.ui.Select;`

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2013-08-08T06:28:01.227

只需将您的 WebElement 包装到 Select Object 中，如下所示

```
Select dropdown = new Select(driver.findElement(By.id("identifier"))); 
```

完成此操作后，您可以通过 3 种方式选择所需的值。考虑一个这样的 HTML 文件

```
<html>
<body>
<select id = "designation">
<option value = "MD">MD</option>
<option value = "prog"> Programmer </option>
<option value = "CEO"> CEO </option>
</option>
</select>
<body>
</html> 
```

现在要识别下拉菜单

```
Select dropdown = new Select(driver.findElement(By.id("designation"))); 
```

要选择它的选项说'程序员'你可以做

```
dropdown.selectByVisibleText("Programmer "); 
```

或者

```
dropdown.selectByIndex(1); 
```

或者

```
dropdown.selectByValue("prog"); 
```

快乐编码:)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-11-20T14:23:41.317

您应该提到的标记名就像“选项”一样，如果文本带有空格，我们可以使用这种方法，它应该可以工作。

```
WebElement select = driver.findElement(By.id("gender"));
List<WebElement> options = select.findElements(By.tagName("option"));

for (WebElement option : options) {

if("Germany".equals(option.getText().trim()))

 option.click();   
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-28T11:23:09.463

您可以使用 Maitreya 发布的 Selenium WebDriver 的“选择”类。抱歉，但我有点困惑，从下拉菜单中选择性别，为什么要比较字符串与“德国”。这是代码片段，

```
Select gender = new Select(driver.findElement(By.id("gender")));
gender.selectByVisibleText("Male/Female"); 
```

`import org.openqa.selenium.support.ui.Select;`添加上述代码后导入。现在将选择您给出的性别（男/女）。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-11-26T15:45:23.360

```
WebElement selectgender = driver.findElement(By.id("gender"));
selectgender.sendKeys("Male"); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-10-17T18:16:36.983

谷歌“选择项目 selenium webdriver”显示[如何在 ruby​​ 中使用 Selenium WebDriver (selenium 2.0) 客户端设置选项](https://stackoverflow.com/questions/4672658/how-do-i-set-a-an-option-as-selected-using-selenium-webdriver-selenium-2-0-cli)作为第一个结果。这不是 Java，但您应该无需太多工作就可以翻译它。[https://sqa.stackexchange.com/questions/1355/what-is-the-correct-way-to-select-an-option-using-seleniums-python-webdriver](https://sqa.stackexchange.com/questions/1355/what-is-the-correct-way-to-select-an-option-using-seleniums-python-webdriver)在前 5 名，同样不是 Java，而是API 非常相似。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-04-03T11:17:38.950

要查找特定的下拉框元素：

```
Select gender = new Select(driver.findElement(By.id("gender"))); 
```

要获取下拉框中包含的所有元素的列表：

```
for(int j=1;j<3;j++)
    System.out.println(gender.getOptions().get(j).getText()); 
```

要通过单击它时显示的可见文本来选择它：

```
gender.selectByVisibleText("Male"); 
```

按索引选择它（从 0 开始）：

```
gender.selectByIndex(1); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-01-23T16:25:20.340

```
WebElement select = driver.findElement(By.id("gender"));
List<WebElement> options = select.findElements(By.tagName("option"));
for (WebElement option : options) {
   if("Germany".equals(option.getText()))
       option.click();   
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-01-23T10:49:22.073

```
public class checkBoxSel {

    public static void main(String[] args) {

         WebDriver driver = new FirefoxDriver();
         EventFiringWebDriver dr = null ;

         dr = new EventFiringWebDriver(driver);
         dr.get("http://www.google.co.in/");

         dr.manage().timeouts().implicitlyWait(30, TimeUnit.SECONDS);

         dr.findElement(By.linkText("Gmail")).click() ;

         Select sel = new Select(driver.findElement(By.tagName("select")));
         sel.selectByValue("fil");

    }

} 
```

我正在使用 GOOGLE LOGIN PAGE 来测试选择选项。上面的示例是从下拉列表中查找并选择语言“菲律宾语”。我相信这会解决问题。

# java - 谷歌吉斯。使用 Java EE5 时注入 EJB

> ID：12940593
> 
> 赞同：1
> 
> 时间：2012-10-17T18:09:18.387
> 
> 标签：java, dependency-injection, ejb-3.0, guice, java-ee-5

是否可以使用 Google Guice（任何其他 DI 框架）在 Java EE 5 中注入 EJB？默认情况下，Java EE 5 使用 JNDI 来注入 EJB。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T18:19:05.957

我没有使用 Guice 的直接经验——但是，可以使用其他框架在 JEE5 应用程序中注入 EJB。例如，[Seam](http://www.seamframework.org/)就是这样做的。所以原则上，它应该是可能的，因为可以注入的对象类型没有固有的限制，只要框架负责所有查找细节。

**更新：**

看看这篇[文章](https://web.archive.org/web/20110515231916/http://a-developer-life.blogspot.com/2010/11/injecting-into-ejb3-with-google-guice.html)，详细介绍如何使用 Guice 注入 EJB。

# xml - xsd 中的属性组及其在 xml 中的表示

> ID：12940600
> 
> 赞同：0
> 
> 时间：2012-10-17T18:09:40.910
> 
> 标签：xml, eclipse, spring, xsd, spring-security

鉴于[此文档中的此 XSD](http://www.springframework.org/schema/security/spring-security-3.1.xsd)

```
<xs:element name="jdbc-user-service" substitutionGroup="security:any-user-service">
    <xs:annotation> .. etc </xs:annotation>
    <xs:complexType>
        <xs:attribute name="id" type="xs:token"></xs:attribute>
        <xs:attributeGroup ref="security:jdbc-user-service.attlist"/>
    </xs:complexType>
</xs:element>

<xs:attributeGroup name="jdbc-user-service.attlist">
    <xs:attribute name="data-source-ref" use="required" type="xs:token">
    </xs:attribute>
    <xs:attribute name="cache-ref" type="xs:token">
    </xs:attribute>
    <xs:attribute name="users-by-username-query" type="xs:token">
    </xs:attribute>
    <xs:attribute name="authorities-by-username-query" type="xs:token">
    </xs:attribute>
    <xs:attribute name="group-authorities-by-username-query" type="xs:token">     
    </xs:attribute>
    <xs:attribute name="role-prefix" type="xs:token">
    </xs:attribute>
</xs:attributeGroup> 
```

那么为什么eclipse给我这个错误

> cvc-complex-type.2.4.a：发现以元素“jdbc-user-service”开头的无效内容。'{"http://www.springframework.org/schema/security":user}' 之一是预期的。

当我提供以下 XML 时？

```
<jdbc-user-service
    data-source-ref="dataSource"
    users-by-username-query="SELECT u.uname, u.upwd, u.enabled FROM ucsdb.users u WHERE u.uname = ?"/> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-18T03:12:54.877

我认为你把事情搞混了。您可能从**另一个**XML 中得到这个错误。根据 XSD ，您发布的 XML（假设命名空间是正确的，请参见下文以防万一）是**有效的。**

```
<jdbc-user-service xmlns="http://www.springframework.org/schema/security" data-source-ref="dataSource" users-by-username-query="SELECT u.uname, u.upwd, u.enabled FROM ucsdb.users u WHERE u.uname = ?"/> 
```

发布的 XSD 中唯一的“用户”元素来自此元素：

```
<xs:element name="user-service" substitutionGroup="security:any-user-service">
    <xs:annotation>
        <xs:documentation>Creates an in-memory UserDetailsService from a properties file or a list of "user" child elements. Usernames are converted to lower-case internally to allow for case-insensitive lookups, so this should not be used if case-sensitivity is required.</xs:documentation>
    </xs:annotation>
    <xs:complexType>
        <xs:sequence>
            <xs:element minOccurs="0" maxOccurs="unbounded" name="user">
                <xs:annotation>
                    <xs:documentation>Represents a user in the application.</xs:documentation>
                </xs:annotation>
                <xs:complexType>
                    <xs:attributeGroup ref="security:user.attlist"/>
                </xs:complexType>
            </xs:element>
        </xs:sequence>
        <xs:attribute name="id" type="xs:token">
            <xs:annotation>
                <xs:documentation>A bean identifier, used for referring to the bean elsewhere in the context.</xs:documentation>
            </xs:annotation>
        </xs:attribute>
        <xs:attributeGroup ref="security:properties-file"/>
    </xs:complexType>
</xs:element> 
```

因此，您**必须**验证使用“用户服务”标签的 XML。

# php - `dispatcher` 对象或 `request` 对象

> ID：12940602
> 
> 赞同：0
> 
> 时间：2012-10-17T18:09:41.960
> 
> 标签：php, phalcon

什么时候从object获取请求参数`dispatcher`，什么时候从object获取请求参数`request`？

```
public function saveAction(){
    $email = $this->request->getPost("user_email")
} 
```

或者

```
public function saveAction(){
    $email = $this->dispatcher->getParam("email") 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T02:12:17.617

当我需要获取查询字符串或发布参数时，我使用 Request，当我需要获取一些路由参数时，我使用 Dispatcher。谢谢，

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T18:31:17.493

Request 是 HTTP 请求的抽象，而 Dispatcher 是另外一回事，调度一个动作。使用更适合您的情况。

在更高级别的函数中，通常明智的做法是不依赖具体请求，而只依赖旨在与操作一起工作的调度程序。

# android - Android AudioTrack 播放慢

> ID：12940603
> 
> 赞同：1
> 
> 时间：2012-10-17T18:09:41.943
> 
> 标签：android, audiotrack

我正在尝试使用 AudioTrack 流式传输音乐。曲目播放，但音频以一半的速度播放。这首歌就像变成了慢动作。

```
try{
    AudioTrack track= new AudioTrack( AudioManager.STREAM_MUSIC,
        44100,
        android.media.AudioFormat.CHANNEL_CONFIGURATION_MONO,
        android.media.AudioFormat.ENCODING_PCM_16BIT,

        android.media.AudioTrack.getMinBufferSize( 44100,
                android.media.AudioFormat.CHANNEL_CONFIGURATION_STEREO,
                android.media.AudioFormat.ENCODING_PCM_16BIT ),
        AudioTrack.MODE_STREAM );

System.out.println("Min buffer: " + android.media.AudioTrack.getMinBufferSize( 44100,
                android.media.AudioFormat.CHANNEL_CONFIGURATION_STEREO,
                android.media.AudioFormat.ENCODING_PCM_16BIT ));

  int cnt;
  int totalWrite = 0;
  boolean play = true;
  byte buff[]=new byte[16384];
  while((cnt=CircularByteBuffer.getInstance().getInputStream().read(buff))>0){

      totalWrite += cnt;
      System.out.println("Writing: " + cnt);
      track.write(buff, 0, cnt);

      if ( totalWrite > 60000 && play ){

          track.play();
          play = false;
      }
  }

      }catch (Exception e)
      {
}//end catch 
```

在 CircularByteBuffer 中，字节被写入另一个线程并在这个线程上读取。这首歌持续播放，没有任何停顿，但播放速度很慢。我不知道它可能是什么。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T19:25:00.300

假设这实际上是一个立体声流，你为什么要创建`AudioTrack`with `CHANNEL_CONFIGURATION_MONO`？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-13T14:27:19.450

尝试

```
track.setPlaybackRate(88200);
track.play(); 
```

它应该以正常速度播放

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-18T16:56:48.880

事实证明，所有设置都很好。我最终使用了“CHANNEL_CONFIGURATION_STEREO”设置，但我尝试在实际设备上运行该应用程序。当我从设备流式传输它时，音乐非常好。但是模拟器导致了这首歌的所有问题。

我希望这就是原因，模拟器只是一个内存猪并且运行效率低下。

# ruby-on-rails - Ruby - 我如何在其自身中获取方法名称？

> ID：12940606
> 
> 赞同：16
> 
> 时间：2012-10-17T18:10:07.733
> 
> 标签：ruby-on-rails, ruby, metaprogramming

我正在尝试从自身获取方法名称：

```
def funky_method
  self.inspect
end 
```

它返回“主要”。

我怎样才能返回“funky_method”呢？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-10-17T18:17:57.190

这是代码：

对于 >= 1.9 的版本：

```
def funky_method

    return __callee__

end 
```

对于版本 < 1.9：

```
def funky_method

    return __method__

end 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2014-07-20T16:48:31.523

`__callee__`返回当前方法的“调用名称”，而`__method__`返回当前方法的“定义名称”。

因此，`__method__`与 alias_method 一起使用时不会返回预期结果。

```
class Foo
  def foo
     puts "__method__: #{__method__.to_s}   __callee__:#{__callee__.to_s} "
  end

  alias_method :baz, :foo
end

Foo.new.foo  # __method__: foo   __callee__:foo
Foo.new.baz  # __method__: foo   __callee__:baz 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-17T20:58:53.783

很简单：

```
 def foo
  puts __method__
end 

```

# html - Outlook 2007、2010 和 2013 中的响应式 2 列到 1 列电子邮件

> ID：12940607
> 
> 赞同：10
> 
> 时间：2012-10-17T18:10:22.770
> 
> 标签：html, mobile, outlook, html-email

我正在为移动设备优化 HTML 电子邮件。我的任务是寻找一个通用的解决方案来创建 2 列到 1 列的响应式布局。我发现了一篇由 Campaign Monitor 撰写的文章 - [http://www.campaignmonitor.com/guides/mobile/responsive/](http://www.campaignmonitor.com/guides/mobile/responsive/)。我已经尝试过他们的标记，它适用于大多数客户端和浏览器，但 Outlook 2007、2010 和 2013 除外。我提供了带有标记的 jsfiddle 链接以供参考。有没有办法在这些版本的 Outlook 中进行这项工作？

编辑：我不想让电子邮件的响应部分在 Outlook 中工作。我希望 2 个表（jsfiddle 示例中的 Left 和 Right）彼此相邻显示，而不是堆叠在一起。这适用于 Gmail（IE、FF、Chrome、Safari）、AOL（IE、FF、Chrome、Safari）、Yahoo（IE、FF、Chrome、Safari）、Hotmail（IE、FF、Chrome、Safari）、Apple Mail 4 & 5、Outlook 2003、Android 4.0、iOS 4、5 和 6。当渲染引擎发生变化时，我只关心 Outlook 2007 及更高版本。

```
<html>
<head>
  <style>
    @media all and (max-width: 590px){
      *[class].responsive{ width: 320px !important; }
    }
  </style>
</head>
<body>
  <table width="100%" style="background-color: #000;" align="center" cellpadding="0" cellspacing="0">
    <tbody>
      <tr>
        <td height="15"></td>
      </tr>
      <tr>
        <td width="100%">
          <table width="560" style="background-color: #fff;" align="center" cellpadding="0" cellspacing="0" class="responsive">
            <tbody>
              <tr>
                <td width="100%">
                  <table width="280" align="left" cellpadding="0" cellspacing="0" class="responsive">
                    <tbody>
                      <tr>
                        <td width="100%" height="40" style="background-color: #ececec;">
                          <div height="40" style="font-weight:bold; font-family:Helvetica,sans-serif; text-align:center;">Left (top)</div>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                  <table width="280" align="left" cellpadding="0" cellspacing="0" class="responsive">
                    <tbody>
                      <tr>
                        <td width="100%" height="40" style="background-color: #bcbcbc;">
                          <div height="40" style="font-weight:bold; font-family:Helvetica,sans-serif; text-align:center;">Right (bottom)</div>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </td>
              </tr>
            </tbody>
          </table>
        </td>
      </tr>
      <tr>
        <td height="15"></td>
      </tr>
    </tbody>
  </table>
</body>
</html> 
```

[http://jsfiddle.net/bxdUp/](http://jsfiddle.net/bxdUp/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-18T13:04:02.600

您是否尝试将`align="left"`和添加`align="right"`到堆叠表？

请参阅更新的小提琴：http: [//jsfiddle.net/bxdUp/1/](http://jsfiddle.net/bxdUp/1/)

您目前有正确的表格`align="left"`，但我在 Outlook 表格对齐操作`align`值方面取得了成功。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-10-15T22:04:13.750

对于遇到此 SO 并正在寻找上述问题的解决方案的任何人，其中响应式 2 列内容也以响应为中心，我发现使用条件来仅为 Outlook 定义列使我的世界变得更容易 1^300。当然，它在 Outlook 中不再是响应式的，但实际上... F Outlook。

```
<!-- define a 100% width table -->
<table cellpadding="0" cellspacing="0" border="0" width="100%">
<tbody>
<tr>
  <td width="100%" style="text-align:center; background-color:white">

    <!-- define a fixed width table using a class for responsive.  I found that defining an arbitary height seemed to be important ~ silly Outlook -->
    <!-- align center -->
    <table cellpadding="0" cellspacing="0" class="fixedWidthTable" border="0" height="300" align="center">
      <tbody>
      <tr>
        <td>

          <!-- align left (this renders as float:left in webkit).  Absolutely defined width. -->
          <table cellpadding="0" cellspacing="0" border="0" width="300" align="left" style="margin:0;padding:0;width:300px">
            <tr>
              <td>
                <!-- content -->
              </td>
            </tr>
          </table>

    <!-- > THIS BIT IS THE KICKER < whack in a column if Outlook -->
    <!--[if mso]></td><td><![endif]-->
    <!-- Brilliant. -->

          <!-- align right (this renders as float:right in webkit).  Absolutely defined width. -->
          <table cellpadding="0" cellspacing="0" border="0" width="300" align="right" style="margin:0;padding:0;width:300px">
            <tr>
              <td>
                <!-- content -->
              </td>
            </tr>
          </table>

        </td>
      </tr>
    </table>

    ... close outer tables etc. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T19:21:12.223

我认为它不适用于 Outlook 版本。因为首先 Outlook 不理解媒体查询。Outlook 2007 版本基于 IE 的渲染引擎，而 Outlook 2010 和 2013 版本使用 Word 作为渲染引擎来显示 html 电子邮件。所以我相信没有办法让他们在 Outlook 中工作。

还有一点是，当这段代码在 Outlook 中执行时，它将忽略样式标签内的所有内容。您应该将样式设置为 Outlook 电子邮件的内联样式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-19T02:07:44.840

我发现在 Outlook 的情况下，表格宽度减少了几个像素，我只能假设 Outlook 呈现的像素宽度与其他电子邮件客户端不同。

不理想，但它对我有用。

# javascript - 使用 YUI 的 JavaScript Ajax 调用

> ID：12940610
> 
> 赞同：0
> 
> 时间：2012-10-17T18:10:41.293
> 
> 标签：javascript, ajax, yui

有人知道链接的外部 JavaScript 文件的顺序是否重要吗？我从来不知道，但使用 YUI 时，链接库文件似乎就是这种情况。

我正在使用 YUI 发出 HTTP 获取 Ajax 请求，并且我有这个 HTML 文件和链接的这 4 个文件（最后一个是我的 Ajax 文件，前 3 个是从构建文件夹下载的框架中的库文件）...

```
<html>

  <head>

    <title>Ajax get page with YUI........</title>

    <script src="yahoo-min.js"></script>
    <script src="event-min.js"></script> 
    <script src="connection-min.js"></script>
    <script src="ajax.js"></script>  

  </head>

  <body>

  <h3>Mike's Wednesday Ajax get page........</h3>

      <div id="info">
    This text will be replaced by Ajax dynamically........
  </div>

   </body>
 </html> 
```

如果我以任何其他顺序链接库文件，则调用将失败并出现错误。我只是想知道 Ajax 和 YUI 的新手，正如我所说，我以前从未经历过这种情况。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T18:33:06.267

如果你坚持使用 YUI 2，我建议你使用依赖配置器：http: [//developer.yahoo.com/yui/articles/hosting/](http://developer.yahoo.com/yui/articles/hosting/)

它会告诉您要包​​含哪些文件以及按什么顺序。

# macos - 将复选框添加到 NSOpenPanel

> ID：12940613
> 
> 赞同：3
> 
> 时间：2012-10-17T18:11:06.380
> 
> 标签：macos, cocoa, nsopenpanel

我想在 中添加一个复选框`NSOpenPanel`，然后在接收到所选文件时查询其状态。我怎样才能做到这一点？

此外，希望能够根据当前文件选择启用或禁用复选框。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-19T13:21:12.483

基于 Joshua Nozzi 和 Mark Alldritt 答案的完整解决方案：

```
NSOpenPanel* openDlg = [NSOpenPanel openPanel];
NSButton *button = [[NSButton alloc] init];
[button setButtonType:NSSwitchButton];
button.title = NSLocalizedString(@"I am a checkbox", @"");
[button sizeToFit];
[openDlg setAccessoryView:button];
openDlg.delegate = self;
[openDlg beginSheetModalForWindow:self.window completionHandler:^(NSInteger result) 
{
    openDlg.delegate = nil; // TODO: Check if this is necessary
    if (result != NSFileHandlingPanelOKButton) return;
    BOOL checkboxOn = (((NSButton*)openDlg.accessoryView).state == NSOnState); 
    // Do something
}]; 
```

NSOpenSavePanelDelegate：

```
- (void)panelSelectionDidChange:(id)sender {
    NSOpenPanel *panel = sender;
    NSButton *button = (NSButton*)panel.accessoryView;
    // Update button based on panel selection
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-18T15:40:02.120

要根据所选文件验证您的复选框，您需要`panelSelectionDidChange:`从`NSOpenSavePanelDelegate`委托协议中实现。然后，您可以查询打开面板的当前选定文件并根据需要更新您的复选框状态。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-17T19:29:44.120

NSOpenPanel 是 NSSavePanel 的子类，它具有`-setAccessoryView:`.

# winforms - .NET 安全异常仅在外部代码中

> ID：12940615
> 
> 赞同：0
> 
> 时间：2012-10-17T18:11:09.827
> 
> 标签：winforms, exception, active-directory, code-access-security, user-roles

我将 VS2012 与 VB.NET 一起用于 winfowms 应用程序，使用 Active Directory 角色。以没有权限的用户身份运行程序，尝试启动此表单时出现（预期的）安全异常。

我有一个看起来像这样的表格：

```
<PrincipalPermission(SecurityAction.Demand, Role:=Security.Roles.ADMINISTRATORS)> _
<PrincipalPermission(SecurityAction.Demand, Role:=Security.Roles.CORRECTIVE_ACTION_EDITORS)> _
<PrincipalPermission(SecurityAction.Demand, Role:=Security.Roles.GRIEVANCE_EDITORS)> _
<PrincipalPermission(SecurityAction.Demand, Role:=Security.Roles.ABOLISHMENT_EDITORS)> _
Public Class EmployeeInformationForm
...
End Class 
```

对代码的调用如下所示：

```
 Private Sub SendEmployeeIDToEmployeeInformationForm(ByVal ID_in As String, ByVal employeeRecord_in As String)
    ...
        If Not formFound Then
            ' Create a new instance of the child form.
            Dim ChildForm As New EmployeeInformationForm(ID_in, employeeRecord_in) ' ** throws expected security exception here**
            Try
                ' Make it a child of this MDI form before showing it.
                ChildForm.MdiParent = Me.MdiParent
        ...
                ChildForm.Show()
            Catch ex As Exception
                ChildForm.Close()
                Throw
            End Try
        End If 
```

~~在 15 或 16 次尝试后（或者变量可能是“大约 1 分钟后”？）程序崩溃。~~ 更新：在任何类型的更多输入后，程序崩溃。我已经以没有权限[的用户身份调试了代码](https://stackoverflow.com/questions/1287099/runas-a-different-user-when-debugging-in-visual-studio/12923052#12923052)，并且能够捕获抛出的异常 - 显然是从无处获得的。说“调用堆栈仅包含外部代码”很奇怪，并显示以下内容：

```
This thread is stopped with only external code frames on the call stack. External code frames are typically from framework code but can also include other optimized modules which are loaded in the target process.

Call stack with external code

mscorlib.dll!System.Security.Permissions.PrincipalPermission.ThrowSecurityException()
mscorlib.dll!System.Security.Permissions.PrincipalPermission.Demand()
mscorlib.dll!System.Security.PermissionSet.DemandNonCAS()
[Native to Managed Transition]
[Managed to Native Transition]
OHRC Database.exe!OHRC_Database.EmployeeInformationForm.Dispose(Boolean disposing)
System.dll!System.ComponentModel.Component.Finalize() 
```

这似乎暗示它很难关闭表格？谁能告诉我为什么会抛出这个异常？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-18T01:35:25.720

异常是从终结线程抛出的（异常堆栈跟踪中的 Finalize() 调用是对此的提示），并且该线程上的用户身份也没有正确的权限。请参阅[http://msmvps.com/blogs/calinoiu/archive/2006/01/07/why-is-my-application-coughing-up-a-securityexception-after-my-code-stops-running.aspx](http://msmvps.com/blogs/calinoiu/archive/2006/01/07/why-is-my-application-coughing-up-a-securityexception-after-my-code-stops-running.aspx)了解更多信息细节和修复。

HTH，妮可

# excel - Apache POI excel单元格字符限制

> ID：12940617
> 
> 赞同：0
> 
> 时间：2012-10-17T18:11:11.323
> 
> 标签：excel, limit, apache-poi, cell, dataformat

首先，我是 POI 的新手。我正在从后端提取数据并将其保存到 excel 文件中。但我注意到一个单元格最多只能允许 10 个字符。这不会发生在其他细胞上。我可以更改单元格上字符的限制吗？dataFormat 会这样做吗？dataFormat 是否仅适用于整数？字符串呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T18:13:57.123

我相信这是您原始 Excel 文件中定义的一些格式。`POI`不强制执行`10`字符限制。您可以验证是否手动将大文本写入相关单元格。如果是这样，请更新excel的单元格格式样式并尝试。

您可能想使用

```
 HSSFCell.setCellStyle
  HSSFCell.setCellType(Cell.CELL_TYPE_STRING) 
```

通过代码更改单元格的类型/样式。

# javascript - 用于在部分之间导航的 Javascript 库，类似于 Udemy 的方法

> ID：12940621
> 
> 赞同：0
> 
> 时间：2012-10-17T18:11:41.117
> 
> 标签：javascript, frontend

有没有人知道一个类似于 Udemy 演讲方法的优秀 Javascript 库？

[http://www.udemy.com/mit-600-intro-to-computer-science-programming-fall-2008/#lecture/14053](http://www.udemy.com/mit-600-intro-to-computer-science-programming-fall-2008/#lecture/14053)

它沿着一条垂直线以缓慢的动画方式上下滑动，类似于时间线。我见过类似的东西，但不记得名字了。也许你们可以帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T18:21:50.930

我认为这将满足您的要求。

[印象.js](http://bartaz.github.com/impress.js/)

# css - 表格单元格 (TD) 动态调整为列中最长单词的宽度。这是什么风格导致的？

> ID：12940623
> 
> 赞同：3
> 
> 时间：2012-10-17T18:11:46.483
> 
> 标签：css, html, layout

Webkit 检查器无法告诉我为什么我的表格单元格不遵守`width`样式。我可以让它们拉伸以适应整行（通过设置`white-space: nowrap`或拉伸以适应最长的单词，但我只希望单元格具有一定数量的像素宽。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-17T18:16:52.580

尝试添加`table-layout: fixed;`到表的 CSS 声明中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-17T18:17:57.317

首先，检查一下：

[固定表格单元格宽度](https://stackoverflow.com/questions/4185814/fixed-table-cell-width)

现在，

对于固定单元格大小 ( `<td>`)，请使用：

```
<col width="50px"/> 
```

在你之前

```
<tr> 
```

或者，使用：

```
<table width = 100> 
```

或者

```
<table style="width:100px"> 
```

固定表大小。

在以下情况下，CSS 中“自动换行”属性的“中断词”值很有用：

```
word-wrap:break-word 
```

# ruby-on-rails - Gmail imap, smtp with oauth 2.0 in rails

> ID：12940624
> 
> 赞同：1
> 
> 时间：2012-10-17T18:11:49.683
> 
> 标签：ruby-on-rails, rubygems, ruby-on-rails-3.2, gmail-imap

我是 ROR 的新手。刚刚完成了 Michael Hurtle[的示例学习。](http://ruby.railstutorial.org/ruby-on-rails-tutorial-book)

我认为学习一门新语言的最好方法是从中开发一些东西。

所以，我想将我的 Asp.net 应用程序移植到 ROR 中。

我的应用程序使用 gmail 的 imap/stmp 来发送/接收电子邮件。我使用[XOAUTH 2.0](https://developers.google.com/google-apps/gmail/xoauth2_protocol)进行身份验证。

我在 ROR 中搜索了相同的内容并找到了[gmail](https://github.com/nu7hatch/gmail) gem。它具有强大的功能，但不支持 2.0。它支持到 1.0。

我是新手，无法更改此 gem 以支持 2.0

有人可以提供博客链接/ gem，以便我可以在带有 XOAUTH 2.0 的 rails 中使用 gmail smtp/imap 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T20:17:27.037

我正在使用[gmail_xoauth](https://github.com/nfo/gmail_xoauth) gem。

看起来很有希望。我认为它没有任何文档是错误的。

它使用 ruby​​ 的[Net::SMTP](http://stdlib.rubyonrails.org/libdoc/net/smtp/rdoc/classes/Net/SMTP.html)库来发送电子邮件。（我是 ROR 新手，所以不知道这一点）

我可以通过仅使用我的`email`和`access_token`即 XOAUTH2成功发送电子邮件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T18:43:28.763

如果您正在寻找 OAuth 身份验证，您应该查看[此 gem](https://github.com/intridea/omniauth)。

如果您只需要通过 smtp 通过 gmail 发送电子邮件，则只能使用[action mailer](http://guides.rubyonrails.org/action_mailer_basics.html#example-action-mailer-configuration)来完成。我已经使用它一段时间了，它有效。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-17T18:50:21.253

据我所知，GMail IMAP 不支持 OAuth2，只支持 OAuth。您可以使用 gmail_xoauth gem。

# c# - 使用数据库处理应用程序许可

> ID：12940625
> 
> 赞同：-1
> 
> 时间：2012-10-17T18:11:55.293
> 
> 标签：c#, sql, database

我想知道这是否可能，如果可以，有人如何有效地使用数据库向应用程序添加许可方面？例如，如果某人的客户有一个用 C# 开发的应用程序，该应用程序与数据库交互（发送查询并获取数据），是否有可能拥有它，以便如果该数据库没有“许可证”C# 应用程序不会起作用？理想情况下，我想做的是能够开发几个与同一个数据库交互的应用程序，而不是让每个应用程序管理它自己的许可证，我想使用数据库，因为所有管道都通向大海。

如果需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T18:34:40.787

我现在实际上正在处理这个问题。它仍处于开发阶段，所以我不知道在生产中会如何工作。（虽然我针对的是非常特定的客户群，所以我最终拥有数千名用户的机会很小）

我所做的是，我在我的 C# WPF 应用程序中添加了一个登录屏幕，您将在其中填写密码等。然后使用 SOAP Web 服务将这些信息发送到验证许可证的服务器。如果此函数返回 true，我允许用户登录，将客户的凭据存储在 RAM 中，并且对于我的应用程序发出的每个请求都会发送这些凭据，仅在许可证有效时才返回数据（以防止人们通过简单地“黑客攻击”从不关闭计算机（我有基于时间的许可证））。我这样做的方式完美无缺，几乎没有明显的延迟（然后它仍然处于测试阶段）。

我不知道您的应用程序是否单独获得许可或任何其他方式，因此您必须自己弄清楚这部分。

# git - GitHub 错误消息 - 权限被拒绝（公钥）

> ID：12940626
> 
> 赞同：891
> 
> 时间：2012-10-17T18:11:56.357
> 
> 标签：git, github

有人看到此错误并知道该怎么做吗？

我正在使用终端，我在根目录下，GitHub存储库存在，我现在不知道该怎么办。

```
> git push -u origin master
Permission denied (publickey).
fatal: Could not read from remote repository.

Please make sure you have the correct access rights
and the repository exists. 
```

* * *

## 回答 #1

> 赞同：798
> 
> 时间：2012-10-17T18:15:18.750

GitHub 无法对您进行身份验证。所以，要么你没有设置 SSH 密钥，因为你没有[在你的机器上设置一个](https://help.github.com/articles/generating-ssh-keys)，要么你的密钥没有与你的 GitHub 帐户相关联。

您还可以使用 HTTPS URL 而不是 SSH/git URL，以避免处理 SSH 密钥。这是[GitHub 推荐的方法](https://help.github.com/articles/set-up-git)。

此外，GitHub 有一个[专门针对该错误消息的帮助页面](https://help.github.com/articles/error-permission-denied-publickey)，并更详细地解释了您可以检查的所有内容。

* * *

## 回答 #2

> 赞同：157
> 
> 时间：2015-06-12T14:51:18.680

我知道这个问题。添加 ssh 密钥后，也将 ssh 密钥添加到 ssh 代理（来自官方[文档](https://help.github.com/articles/generating-ssh-keys/)）

```
ssh-agent -s
ssh-add ~/.ssh/id_rsa 
```

一切正常后，git可以查看正确的密钥，之前不能。

* * *

## 回答 #3

> 赞同：116
> 
> 时间：2014-02-21T15:43:31.940

您是否在 ~/.ssh 目录中创建了**配置**文件？它应该有如下内容：

```
Host github.com 
 IdentityFile ~/.ssh/github_rsa 
```

假设您创建了一个名为**github_rsa的 ssh 密钥**

并将其上传到 GitHub...

注意：如果您的 ~/.ssh/ 目录中有超过 1 个密钥（2 个或更多），则必须遵循这种显式配置方式。如果你不这样指定密钥，那么按顺序取第一个密钥并用于 github 身份验证，因此它取决于密钥文件名。

* * *

## 回答 #4

> 赞同：64
> 
> 时间：2012-10-17T18:13:32.383

您需要生成一个 SSH 密钥（如果您没有）并将公钥与您的 Github 帐户相关联。请参阅[Github 自己的文档](https://help.github.com/articles/generating-ssh-keys)。

* * *

## 回答 #5

> 赞同：59
> 
> 时间：2013-05-23T03:30:45.620

这发生在我身上。由于某种原因，我的起源在我没有意识到的情况下搞砸了：

检查您的设置是否仍然正确

```
git remote -v 
```

url 需要类似于 ssh://git@github.com/YourDirectory/YourProject.git；如果您没有看到 git@github.com，请使用

```
git remote set-url origin git://github.com/YourDirectory/YourProject.git 
```

正确设置。或者您可以使用 github 应用程序在特定存储库的设置面板中检查并设置主远程存储库 url。

* * *

## 回答 #6

> 赞同：29
> 
> 时间：2018-11-13T09:12:04.843

如果您将 ssh 访问更改为对远程存储库的 https 访问，则问题已解决：

```
git remote set-url origin https_link_to_repository

git push -u origin master 
```

* * *

## 回答 #7

> 赞同：28
> 
> 时间：2016-01-03T14:34:40.220

假设您通过 SSH 连接 GitHub，您可以运行以下命令来确认这一点。

```
$git config --get remote.origin.url 
```

如果您得到的结果具有以下格式 git@github.com:xxx/xxx.github.com.git，那么您应该执行以下操作。

生成一个 SSH 密钥（或使用现有的）。如果您有，您只需将您的密钥添加到 ssh-agent（步骤 2）和您的 GitHub 帐户（步骤 3）。

以下适用于那些没有 SSH 密钥的人。

**步骤 1**生成公钥/私钥 rsa 密钥对。

```
$ssh-keygen -t rsa -b 4096 -C "your_email@example.com" 
```

系统将要求您确认 SSH 密钥的保存位置以及要使用的密码。

**步骤 2**将您的密钥添加到 ssh-agent

*   确保 ssh-agent 已启用

    `$eval "$(ssh-agent -s)"`

*   将 SSH 密钥添加到 ssh-agent：

    `$ssh-add ~/.ssh/id_rsa`

**步骤 3**将您的 SSH 密钥添加到您的帐户

`$sudo apt-get install xclip`

`$xclip -sel clip < ~/.ssh/id_rsa.pub`

然后将复制的密钥添加到 GitHub

转到**设置**-> **SSH 密钥**（个人设置侧栏）->**添加 SSH 密钥**-> 填写表格（密钥在剪贴板上，只需使用 ctrl+v）->**添加密钥**

完成上述步骤后，您应该解决权限问题。

参考链接： [生成 SSH 密钥](https://help.github.com/articles/generating-ssh-keys/)。

* * *

## 回答 #8

> 赞同：20
> 
> 时间：2013-08-01T23:23:31.470

首先，我们需要检查您计算机上现有的 ssh 密钥。打开终端并运行：

```
ls -al ~/.ssh

#or

cd ~/.ssh
ls 
```

这将列出您的 .ssh 目录中的文件

最后取决于您所看到的（在我的情况下是）：

```
 github_rsa  github_rsa.pub known_hosts 
```

只需尝试设置您的 RSA，希望这将解决您的“git push origin”问题

`$ ssh-keygen -lf ~/.ssh/github_rsa.pub`

**注意：** RSA 证书是密钥配对的，因此您将拥有一个私有证书和一个公共证书，您将无法访问私有证书，因为它属于 github（在这种情况下），但是当发生此错误时，您可能会丢失公共证书（至少这是我的情况，我的 github 帐户或 repo 不知何故搞砸了，我不得不“链接”以前生成的公钥）

* * *

## 回答 #9

> 赞同：20
> 
> 时间：2017-08-21T10:09:02.317

**另一个解决方案：**

创建 SSH 密钥，键入`ssh-keygen -t rsa -C "your_email@example.com"`. 这将创建 id_rsa 和 id_rsa.pub 文件。

将 id_rsa 添加到本地计算机上的 ssh 列表中：`ssh-add ~/.ssh/id_rsa.`

生成密钥后，使用以下命令获取 pubkey：

```
cat ~/.ssh/id_rsa.pub 
```

你会得到类似的东西：

```
cat ~/.ssh/id_rsa.pub 

ssh-rsa AAAB3NzaC1yc2EAAAADAQABAAACAQCvMzmFEUPvaA1AFEBH6zGIF3N6pVE2SJv9V1MHgEwk4C7xovdk7Lr4LDoqEcqxgeJftwWQWWVrWWf7q9qCdHTAanH2Q5vx5nZjLB+B7saksehVOPWDR/MOSpVcr5bwIjf8dc8u5S8h24uBlguGkX+4lFJ+zwhiuwJlhykMvs5py1gD2hy+hvOs1Y17JPWhVVesGV3tlmtbfVolEiv9KShgkk3Hq56fyl+QmPzX1jya4TIC3k55FTzwRWBd+IpblbrGlrIBS6hvpHQpgUs47nSHLEHTn0Xmn6Q== user@email.com 
```

复制此密钥（值）并转到 github.com 并在设置（ssh 和 pgp 密钥）下添加您的公钥。

* * *

## 回答 #10

> 赞同：17
> 
> 时间：2017-12-20T07:22:07.720

这对我有用：

1-删除所有来源

```
git remote rm origin 
```

（参见[https://www.kernel.org/pub/software/scm/git/docs/git-remote.html](https://www.kernel.org/pub/software/scm/git/docs/git-remote.html)）

*remote ：“管理您跟踪其分支的存储库集（“远程”）。

*rm : "删除名为 . 的远程。远程的所有远程跟踪分支和配置设置都被删除。"

2-检查所有已被删除：

```
git remote -v 
```

3-添加新的原点主

```
git remote add origin git@github.com:YOUR-GIT/YOUR-REPO.git 
```

就是这样！

* * *

## 回答 #11

> 赞同：14
> 
> 时间：2017-02-10T23:27:57.990

我收到了这个错误。原来我刚刚将 OSX 升级到 Sierra，我的旧密钥不再注册。

起初我以为是[“升级到 macOS Sierra 会破坏您的 SSH 密钥并将您锁定在自己的服务器之外”](https://medium.freecodecamp.com/upgrading-to-macos-sierra-will-break-your-ssh-keys-and-lock-you-out-of-your-own-servers-f413ac96139a#.8ka8s1ecz)

但我回避了那个。原来我只需要重新注册我现有的密钥：

`ssh-add -K`

然后输入密码……完成！

* * *

## 回答 #12

> 赞同：10
> 
> 时间：2016-01-26T15:19:05.723

如果您没有访问自己的存储库，或者在克隆的存储库中进行克隆（使用一些“git submodule...”命令）：

在存储库的主目录中：

```
$ ls -a 
```

**1、打开“.gitmodules”，**你会发现这样的东西：

```
[submodule "XXX"]
    path = XXX
    url = git@github.com:YYY/XXX.git 
```

将最后一行更改为您需要拉取的存储库的**HTTPS ：**

```
[submodule "XXX"]
    path = XXX
    https://github.com/YYY/XXX.git 
```

**保存 ".gitmodules"**，然后**运行**子模块的命令，".git" 将被更新。

**2\. 打开“.git”，**进入“config”文件，你会发现如下内容：

```
[core]
    repositoryformatversion = 0
    filemode = true
    bare = false
    logallrefupdates = true
    ignorecase = true
    precomposeunicode = true
[remote "origin"]
    url = https://github.com/YYY/XXX.git
    fetch = +refs/heads/*:refs/remotes/origin/*
[branch "master"]
    remote = origin
    merge = refs/heads/master
[submodule "XXX"]
    url = git@github.com:YYY/XXX.git 
```

将最后一行更改为您需要拉取的存储库的**HTTPS ：**

```
 url = https://github.com/YYY/XXX.git 
```

因此，在这种情况下，主要问题只是 url。现在可以在存储库页面顶部找到任何存储库的 HTTPS。

* * *

## 回答 #13

> 赞同：9
> 
> 时间：2014-06-10T21:07:33.670

确保`ssh-add -l`显示您的 Github 帐户的 SSH 密钥列表中存在的 SSH 密钥的指纹。

如果输出为空，但您知道您有一个可与您的 github 帐户一起使用的私有 SSH 密钥，请`ssh-add`在此密钥上运行（在 中找到`~/.ssh`。它默认命名`id_rsa`，因此您可能会运行`ssh-add id_rsa`）。

否则，请按照[这些说明](https://help.github.com/articles/generating-ssh-keys)生成 SSH 密钥对。

* * *

## 回答 #14

> 赞同：9
> 
> 时间：2015-12-01T11:16:47.690

我想我有最好的答案给你，你的 git 应用程序在根用户目录中读取你的 id_rsa.pub

```
/home/root/.ssh/id_rsa.pub 
```

这就是为什么 git 无法读取 /home/your_username/.ssh/id_rsa.pub 中的密钥的原因。所以你需要在 /home/root/.ssh/ 中创建密钥

```
$ sudo su
$ ssh-keygen
$ cd ~/.ssh
$ cat id_rsa.pub 
```

然后将密钥复制到您的 github 帐户中。它对我有用。你可以试试。

* * *

## 回答 #15

> 赞同：8
> 
> 时间：2021-05-29T14:03:41.417

是的，我也有这个问题：/ 我打算以 HTTP 类型（不是 SSH 类型）将我的项目推送到 Github。我必须在每次推送中输入我的用户名和密码。所以首先我输入了与以下类型相关的代码

```
git remote add origin git@github.com:YOUR-GIT/YOUR-REPO.git 
```

我得到了

> git@github.com：权限被拒绝（公钥）。致命：无法从远程存储库中读取。

所以我通过以下方法解决了我的问题

1.  `git remote rm origin` 删除您的 git 远程存储库
2.  `git remote` 现在检查您的远程远程存储库是否已被删除

> 网址 =`https://github.com/<username>/<repository>.git`

3.  `git remote add origin URL` 再次添加您的 URL 以创建远程存储库
4.  `git push -u origin master`
    您可以将内容推送到远程存储库。在这里，当您使用“-u”命令创建一个跟踪分支并在远程存储库中跟踪分支的帮助下，您不会告诉 git 在接下来的步骤中您推送哪个分支:)
    如果您使用这里linux git 在推送内容之前会询问用户名和密码。并提供您的相关凭据。

> **为了防止在每次推送中提供用户名和密码，**您必须更改 git config

> 列出你的 git 配置 -`git config --global --list`
> 你会看到

```
user.name=<your_username>
user.email=<your_email> 
```

因此，您必须将*credential.helper*属性添加到您的 git 配置中

5.`git config --global --add credential.helper store`将其添加到您的终端 现在您可以将新项目添加到您的文件中，然后，`git add.`现在 git 也会请求您的用户名和密码，这将是最后一次。对于下一个 git pushes，git 不会向你请求用户名和密码 :)`git commit -m "<message>"` `git push`

* * *

## 回答 #16

> 赞同：8
> 
> 时间：2016-01-01T06:23:46.173

我之前在我的一个 php 项目中使用了 github。在使用 github 时，我使用的是 ssh 而不是 https。我的[机器是这样设置的](https://help.github.com/articles/generating-ssh-keys/)，每次我提交和推送代码时，它都会询问我的 rsa 密钥密码。

几天后，我停止了 php 项目的工作并忘记了我的 rsa 密码。最近，我开始从事一个 java 项目并转移到 bitbucket。因为，我忘记了密码并且我想[没有办法恢复它](https://help.github.com/articles/how-do-i-recover-my-ssh-key-passphrase/)，所以我决定为新项目使用 https（推荐）协议，并在问题中遇到了同样的错误。

**我是怎么解决的？**

1.  运行此命令来告诉我的 git 使用 https 而不是 ssh：

    ```
    git config --global url."https://".insteadOf git:// 
    ```

2.  删除任何遥控器（如果有）

    ```
    git remote rm origin 
    ```

3.  重做从**git init**到**git push**的所有操作，它就可以工作了！

PS：我还在调试过程中从我的机器上卸载了 ssh，认为删除它可以解决问题。是的，我知道！！:)

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2020-06-25T18:49:59.057

允许对密钥（身份）进行写访问，然后单击`**Add key**`

[![在此处输入图像描述](../Images/66de0b1ebd964d8dbce9084405759e1e.png)](https://i.stack.imgur.com/4LMTP.png)

^([如果在 Windows 上，请在通过 SSH 使用 Github](https://programming-review.com/github/using-github-via-ssh/)中查看更多详细信息。)

* * *

## 回答 #18

> 赞同：5
> 
> 时间：2019-03-26T20:16:59.583

好的，这个解决方案很少，其中一些可能已经被提及，但只是为了将它们放在一起：

*   确保您的密钥存在，默认情况下另一个 ~/.ssh/ 文件夹，即 id.rsa 和 id.rsa.pub

*   确保密钥具有正确的权限，您可以运行 chmod：

    **chmod 600 ~/.ssh/id_rsa**

    **chmod 644 ~/.ssh/id_rsa.pub**

*   确保您的公钥 (id_rsa.pub) 的内容与远程存储库配置中上传的内容相匹配

*   最后修复 ssh 代理的问题： **ssh-add**

更多信息：[https ://itcodehub.blogspot.com/2015/01/ssh-add-problems-with-ssh-agent-and.html](https://itcodehub.blogspot.com/2015/01/ssh-add-problems-with-ssh-agent-and.html)

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2016-09-08T19:52:57.883

如果您已经创建了 SSH 密钥并且仍然收到错误，那是因为您需要授予用户权限来读取和写入您要克隆到的文件夹。为此，`sudo chmod 777 <your_folder_name_here>"`. 当然，这是在您生成 SSH 密钥之后，您仍然会收到此错误。希望这对未来的用户有所帮助。

**编辑**

如果您使用的是 git bash，请在 Windows 中添加到此使用 admin

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2016-12-24T10:10:04.117

我想补充一些我的发现：

如果您正在使用`GitBash`，请确保 SSH 密钥存储在`~/.ssh/id_rsa`.

默认情况下`GitBash`搜索`~/.ssh/id_rsa`SSH 密钥的默认路径。

甚至文件名也`id_rsa`很重要。如果您将 SSH 密钥保存在另一个文件名或路径中，则会引发`Permission Denied(publickey)`错误。

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2017-02-02T15:28:54.470

我最近有同样的问题。如果您需要立即修复，这可能会有所帮助，但每次重新启动系统时都需要这样做

从终端运行：`ssh-add ~/.ssh/id_rsa`

输入您的系统密码，这应该可以工作。

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2022-01-05T03:16:13.297

TLDR：

1.  确保您可以`write`访问 repo（从 repo 配置它`settings`）。
2.  确保公钥在[`SSH and GPG keys`](https://github.com/settings/keys)您的 github 帐户中。

对我来说，当我尝试从新安装的机器克隆一些 repo 时，通常会发生此错误。github 收到请求时，首先会检查公钥哈希。如果公钥不匹配任何用户，github 将拒绝此请求。如果机器是新机器并且您的 ssh 密钥是新生成的，这种情况很常见。

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2016-12-08T10:52:18.990

对我来说，我试过这个 -

```
eval "$(ssh-agent -s)" 
```

然后我跑

```
ssh-add ~/.ssh/path-to-the-keyfile 
```

并生成您可以运行的密钥

```
ssh-keygen -t rsa -b 4096 -C "your_email@example.com" 
```

这将生成一对密钥（公共和私人）。

您可以将此密钥存储到 github 以获取更多信息，请阅读[将新的 SSH 密钥添加到您的 GitHub 帐户](https://help.github.com/articles/adding-a-new-ssh-key-to-your-github-account/)

我希望它会帮助别人:)

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2018-08-10T19:15:19.480

`git pull`我在远程主机上搜索类似错误消息的解决方案时找到了此页面：

```
$ git pull
Permission denied (publickey).
fatal: Could not read from remote repository.

Please make sure you have the correct access rights
and the repository exists. 
```

我通过 . 从本地机器连接到远程主机`ssh -AY remote_hostname`。这不是 OP 问题的解决方案，但对遇到此页面的其他人很有用，因此在此处发布。

请注意，在我的情况下，`git pull`在我的本地机器上工作正常（也就是说，已经设置了 ssh 密钥，并添加到 GitHub 帐户等）。`~/.ssh/config`我通过在我的笔记本电脑上添加这个来解决我的问题：

```
Host *
     ForwardAgent yes 
```

然后我用 重新连接到远程主机`ssh -AY remote_hostname`，`git pull`现在可以工作了。配置中的更改可以将我的 ssh 密钥对从本地机器转发到任何主机。在该 ssh 会话中实际转发它的`-A`选项。[在此处查看更多详细信息。](https://stackoverflow.com/questions/12257968/how-to-forward-local-keypair-in-a-ssh-session)`ssh`

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2021-12-15T11:01:12.373

[![在此处输入图像描述](../Images/4ee75ff807063230f200c76086891218.png)](https://i.stack.imgur.com/jLDVs.png)如果您使用的是 Widows-10，请按照此说明进行操作。这个对我有用。

1.  以管理员身份打开终端

2.  运行这个命令：“ssh-keygen”。它会生成一个 ssh 密钥，并将显示创建它的文件夹。检查我的图像[![在此处输入图像描述](../Images/a4a517bf80800aa093e465ee927d9bf3.png)](https://i.stack.imgur.com/378Ti.png)

3.  复制生成的“ssh key”

4.  转到您的 github 配置文件 ---> 设置 --> 单击 SSH 和 GPH --> 单击““新建 SSH 密钥按钮”并粘贴“ssh 密钥”，最后“单击添加按钮”

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2016-02-28T10:25:44.543

同样在 ubuntu 中，即使在 BitBucket 的设置中已经输入了 SSH 密钥，我也遇到了这个问题。原因是，我正在尝试以下操作：

```
sudo git push origin master 
```

不知道为什么，但它通过使用解决了

```
git push origin master 
```

**没有使用 sudo。**

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2015-02-17T06:19:19.793

如果您使用的是 GitHub for Mac UI，请检查首选项以确保您已登录。

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2015-05-28T16:37:35.923

在“git push”期间我遇到了同样的错误。在客户端，我有两个起源和主人。我删除了一个，然后它工作正常。

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2017-11-02T09:48:35.313

**tl;博士**

`~/.ssh/config`总而言之_

```
PubkeyAcceptedKeyTypes=+ssh-dss 
```

**场景** 如果您使用的是 openSSH > 7 的版本，例如在触控栏 MacBook Pro 上，它是`ssh -V
OpenSSH_7.4p1, LibreSSL 2.5.0`

您还拥有一台旧 Mac，它最初将您的密钥放在 Github 上，这可能是使用 id_dsa 密钥。默认情况下，OpenSSH v7 不使用这些 DSA 密钥（包括 this `ssh-dss`），但是您仍然可以通过将以下代码放入您的`~/.ssh/config`

```
PubkeyAcceptedKeyTypes=+ssh-dss 
```

对我有用的来源是这个[Gentoo 时事通讯](https://www.gentoo.org/support/news-items/2015-08-13-openssh-weak-keys.html)

现在您至少可以使用 GitHub，然后将您的密钥修复为 RSA。

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2015-07-30T03:24:32.243

您可以使用 Https url 登录

我猜您在说 git push 时尝试使用 ssh url 登录，如果它只询问密码，则认为您是通过 ssh 连接的。最好使用 http url。

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2017-02-24T01:28:29.400

我遇到了与@Batman 类似的问题。但是，因为我在 /usr/local/src/projectname 下运行它，所以不使用 sudo 运行不是一个选项。

只需添加**-E 标志**来保存环境（您的 ~/.ssh/ 路径）。

`$ sudo -E git clone git@your_repo`

从人须藤：

> -E, --preserve-env 向安全策略指示用户希望保留他们现有的环境变量。如果用户没有保护环境的权限，安全策略可能会返回错误。

* * *

## 回答 #32

> 赞同：1
> 
> 时间：2017-05-10T01:07:25.363

发生这种情况的一种情况是在创建存储库后按照 GitHub 说明进行操作。Git 将指示您使用类似的东西添加您的遥控器。

`git remote add origin git@github.com:<user>/<project>.git`

将 <> 中的内容替换为与您的帐户相关的值。

解决办法是去掉`.git`后缀。添加遥控器如下：

`git remote add origin git@github.com:<user>/<project>`

* * *

## 回答 #33

> 赞同：1
> 
> 时间：2021-11-19T21:44:51.773

## 解决这样的错误

> git@github.com：权限被拒绝（公钥）。致命：无法从远程存储库中读取。请确保您拥有正确的访问权限

## 解决方案 (OSX)

*   打开您的终端并按照以下命令进行操作

*   $**光盘~**

*   $**须藤苏**

*   $ **ssh-keygen**

    *   输入保存密钥的文件 (/var/root/.ssh/id_rsa)： $ **id_rsa**
    *   Enter passphrase (empty for no passphrase): $ **hit enter**
    *   再次输入相同的密码：$**回车**
*   $ **cd ~/.ssh**

*   $**猫id_rsa.pub**

*   复制显示内容。 [![在此处输入图像描述](../Images/83e80dba3172f95357cd889e39ec0521.png)](https://i.stack.imgur.com/SLdKC.png)

*   打开 GitHub 单击您的个人资料图标设置>SSH 和 GPC 密钥

*   单击新的 ssh 密钥按钮 [![在此处输入图像描述](../Images/9d4ec3af01254cccf67d92732f96f7af.png)](https://i.stack.imgur.com/wmQ2o.png)

*   输入您复制的任何标题和密钥 [![在此处输入图像描述](../Images/c07d62acdaf25a1dbcec8cf305a4c279.png)](https://i.stack.imgur.com/FrHhJ.png)

*   现在检查您的问题已解决

* * *

## 回答 #34

> 赞同：1
> 
> 时间：2020-12-26T05:46:51.997

**这对我有用**

`2 options`github上有——`HTTPS/SSH`

`I had selected SSH`错误导致错误发生-_-

**将其切换到 HTTPS**，然后再次复制 url 并尝试 :)

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2014-07-11T11:30:48.813

也许你的 ssh-agent 没有启用你可以试试

1.  下载 git

[http://git-scm.com/](http://git-scm.com/)

1.  安装它

2.  启用 ssh 代理

C:\Program Files\Git\cmd

启动 ssh 代理

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2017-02-07T16:21:50.543

转到您的 GitHub 帐户仪表板，找到您的项目存储库，单击**设置**选项卡 - 在**部署密钥**下，您必须添加您的 SSH 密钥。打开终端并输入：

```
cat ~/.ssh/id_rsa.pub | pbcopy 
```

这将从您的 id_rsa.pub 文件中复制密钥。所以只需返回 GitHub 仪表板，粘贴它，单击**Add Key**就可以了。

相同的解决方案适用于 Bitbucket 帐户。

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2017-04-22T17:32:31.340

我在 ssh 代理中加​​载了 2 个 Github 身份文件。我的个人密钥和另一个用于客户项目的密钥。

我删除了导致混乱的密钥：

`ssh-add -d id_rsa_github_somekey`

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2021-09-17T13:26:54.283

我试图用几个小时来解决类似的问题。最后，我删除了所有密钥并制作了没有密码的新密钥，最终解决了这个问题。

问题出在 SSH 密码短语上，需要删除！

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2021-04-08T16:26:32.737

我有同样的问题，但没有一个答案有效，但一个简单的解决方案有效。但请注意，我确实`ssh key`按照答案的建议添加了。不确定这是否真的有帮助。无论如何，这[最终奏效了：](https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=&cad=rja&uact=8&ved=2ahUKEwj1hquyhu_vAhUQ4zgGHXP-DJMQFjABegQIBRAD&url=https%3A%2F%2Fdocs.github.com%2Fen%2Fgithub%2Fgetting-started-with-github%2Fmanaging-remote-repositories&usg=AOvVaw3WetuJnAtfpKZHSHwcVNhX)

使用 git remote set-url 命令将远程的 URL 从 HTTPS 更改为 SSH。`$ git remote set-url origin git@github.com:USERNAME/REPOSITORY.git`. 验证远程 URL 是否已更改。

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2018-03-15T22:30:52.607

使用 Https 很好，运行`git config --global credential.helper wincred`创建一个 Github 凭证助手，为您存储您的凭证。如果这不起作用，那么您需要编辑目录`config`中的文件`.git`并将源更新为 https url。

有关 github 文档，请参阅[此链接](https://help.github.com/articles/caching-your-github-password-in-git/)。

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2019-11-20T19:58:29.627

我对 AWS CodeCommit 也有同样的问题。所有人都在一台笔记本电脑上工作，但在另一台笔记本电脑上却不行。解决方案是从 AWS 配置部分的 .ssh/config 中删除“PreferredAuthentications publickey”行。

* * *

## 回答 #42

> 赞同：0
> 
> 时间：2018-02-22T11:30:47.607

将 GitHub 添加为远程时使用此页面的 URL。它不会导致任何此类错误并推送代码

* * *

## 回答 #43

> 赞同：-1
> 
> 时间：2016-11-03T13:40:38.480

你可以试试这个方法...

[![在此处输入图像描述](../Images/931220804a5c6ccd492fd4cf0d7f8ce8.png)](https://i.stack.imgur.com/9L2kd.png)

[![在此处输入图像描述](../Images/8410ae2a6ea1f36c93511e1908797320.png)](https://i.stack.imgur.com/GKCUb.png)

选择另一个链接

# python - Python失去对子进程的控制？

> ID：12940628
> 
> 赞同：13
> 
> 时间：2012-10-17T18:12:01.367
> 
> 标签：python, linux, subprocess

我正在使用一个商业应用程序，它使用 Python 作为其脚本 API 的一部分。提供的功能之一是称为`App.run()`. 当这个函数被调用时，它会启动一个新的 Java 进程来完成其余的执行。（不幸的是，我真的不知道它在幕后做了什么，因为提供的 Python 模块是`.pyc`文件，并且许多 Python 函数是 SWIG 生成的）。

我遇到的麻烦是我正在将`App.run()`调用构建到一个更大的 Python 应用程序中，该应用程序需要执行一些有保证的清理代码（关闭数据库等）。不幸的是，如果子进程被`Ctrl`+中断`C`，它会中止并返回命令行，而不会将控制权返回给 Python 主程序。因此，我的清理代码永远不会执行。

到目前为止，我已经尝试过：

1.  用 atexit... 注册函数不起作用
2.  将清理放在类`__del__`析构函数中......不起作用。（`App.run()`在课堂内）
3.  `Ctrl`在主 Python 应用程序中为+创建信号处理`C`程序...不起作用
4.  放入`App.run()`线程...导致`Ctrl`+后出现内存错误`C`
5.  放入`App.run()`一个进程（来自多处理）......不起作用

任何想法可能会发生什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-17T18:33:45.643

这只是一个大纲-但是像这样？

```
import os

cpid = os.fork()
if not cpid:
    # change stdio handles etc
    os.setsid() # Probably not needed
    App.run()
    os._exit(0)

os.waitpid(cpid)
# clean up here 
```

（os.fork 仅适用于 *nix）

`subprocess`可以以与操作系统无关的方式实现相同的想法。思路是`App.run()`在子进程中运行，然后等待子进程退出；无论子进程如何死亡。在 posix 上，您还可以捕获 SIGCHLD（子进程死亡）。我不是 Windows 大师，所以如果适用并且`subprocess`不起作用，其他人将不得不在这里插话。

被调用后`App.run()`，我很好奇进程树是什么样的。它有可能运行`exec`并接管 python 进程空间。如果发生这种情况，创建一个子进程是我能想到的唯一方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-17T20:52:10.650

如果`try: App.run() finally: cleanup()`不起作用；您可以尝试在子进程中运行它：

```
import sys
from subprocess import call

rc = call([sys.executable, 'path/to/run_app.py'])
cleanup() 
```

或者，如果您在字符串中有代码，则可以使用`-c`选项，例如：

```
rc = call([sys.executable, '-c', '''import sys
print(sys.argv)
''']) 
```

`preexec_fn=os.setsid`您可以通过添加参数（注意： no ）使用 subprocess 来实现@tMC 的建议， `()`尽管我看不出在这里创建流程组可能有什么帮助。或者你可以试试`shell=True`使用参数在单独的 shell 中运行它。

您可能会再次尝试多处理：

```
import multiprocessing as mp

if __name__=="__main__":
   p = mp.Process(target=App.run)
   p.start()
   p.join()
   cleanup() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-17T18:34:53.707

您能否将 App.Run() 包装在 Try/Catch 中？

就像是：

```
try:
    App.Run()
except (KeyboardInterrupt, SystemExit):
    print "User requested an exit..."
cleanup() 
```

# ruby-on-rails - 用洗劫做一个 OR

> ID：12940629
> 
> 赞同：6
> 
> 时间：2012-10-17T18:12:09.880
> 
> 标签：ruby-on-rails, ransack

[一个基本问题，但我在项目页面](https://github.com/ernie/ransack)或[wiki](https://github.com/ernie/ransack/wiki)中找不到明确的内容。我有以下代码：

```
field = "secre"
Position.search( {:description_cont => field, :code_cont => field}).result(:distinct => true).to_sql
 => "SELECT DISTINCT `positions`.* FROM `positions`  WHERE ((`positions`.`description` LIKE '%secre%' AND `positions`.`code` LIKE 0))" 
```

但我的查询应该是这样的：

```
 => "SELECT DISTINCT `positions`.* FROM `positions`  WHERE ((`positions`.`description` LIKE '%secre%' OR `positions`.`code` LIKE 0))" 
```

任何帮助，将不胜感激。提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-04T17:52:45.770

尝试以下操作：

```
Position.search( {:description_or_code_cont => field}).result(:distinct => true).to_sql 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T15:46:29.503

这可能不是您问题的确切答案，但是因为我自己用谷歌搜索了在 Ransack 中进行 OR 搜索的正确方法，但没有找到好的答案，但我自己设法解决了问题，我想我d 分享解决方案。

在我正在处理的应用程序中，有一个搜索页面，它将模型的各个字段`Customer`（链接到 DB 表`customers`）作为参数，然后列出与搜索结果匹配的那些客户的表。客户拥有三个不同的电话号码字段，并且之前的搜索页面对每种类型的号码都有不同的搜索字段。我想将它们组合到一个字段中，以便在所有数字中方便地搜索。

数据库有这三个字段定义（在这些片段中，我只更改了一些标识符名称）：

```
mysql> desc customers;
+--------------------------+------------------+------+-----+---------+----------------+
| Field                    | Type             | Null | Key | Default | Extra          |
+--------------------------+------------------+------+-----+---------+----------------+
...
| customer_phone_a         | varchar(50)      | YES  |     | NULL    |                |
| customer_phone_b         | varchar(50)      | YES  |     | NULL    |                |
| customer_phone_c         | varchar(50)      | YES  |     | NULL    |                |
+--------------------------+------------------+------+-----+---------+----------------+ 
```

以前，搜索页面（文件`app/views/customers/index.html.erb`）包含以下内容：

```
<%= search_form_for @search do |f| %> <!-- this is a Ransack-provided form -->
  <div class="field">
...
    <%= f.label :customer_phone_a_spaces_match_anything, "Phone number A is or contains:" %>
    <%= f.text_field :customer_phone_a_spaces_match_anything %>

    <%= f.label :customer_phone_b_spaces_match_anything, "Phone number B is or contains:" %>
    <%= f.text_field :customer_phone_b_spaces_match_anything %>

    <%= f.label :customer_phone_c_spaces_match_anything, "Phone number C is or contains:" %>
    <%= f.text_field :customer_phone_c_spaces_match_anything %>
...
  </div>

  <div class="actions">
    <%= f.submit "Search", class: "btn btn-large btn-primary" %>
  </div>

<% end %> <!-- search_form_for --> 
```

（这与现在无关，但文件的内容`config/initializers/ransack.rb`是：

```
Ransack.configure do |config|

  config.add_predicate 'spaces_match_anything',
  :arel_predicate => 'matches', # so we can use the SQL wildcard "%"
  # Format the incoming value: add the SQL wildcard character "%" to the beginning and the end of
  # the string, replace spaces by "%", and replace multiple occurrences of "%" by a single "%".
  :formatter => proc {|v| ("%"+v.gsub(" ", "%")+"%").squeeze("%")}

end 
```

这意味着除了 Ransack 的默认`eq`,`cont`等之外，我还可以`spaces_match_anything`在搜索中使用我的自定义谓词。谓词做它所说的。）

无论如何，从您所做的同一个示例中获得灵感，我将以下 ransacker 添加到模型中`app/models/customer.rb`：

```
ransacker :all_phones do |parent|
  Arel::Nodes::InfixOperation.new('||',
    Arel::Nodes::InfixOperation.new('||',
      Arel::Nodes::InfixOperation.new('||', parent.table[:customer_phone_a]||"", ' '),
                                    parent.table[:customer_phone_b]||"", ' '),
                                  parent.table[:customer_phone_c]||"")
end 
```

最后，我将搜索页面中的三个电话号码搜索字段替换为：

```
<%= f.label :customer_phone_a_or_customer_phone_b_or_customer_phone_c_cont, "Phone number is or contains:" %>
<%= f.text_field :customer_phone_a_or_customer_phone_b_or_customer_phone_c_cont %> 
```

用户在此搜索字段中输入的数字现在将匹配客户的三个数字中的任何一个。（请注意在 ransacker 中对空数 , 的防范`||""`。）

这经过测试可与 Ruby v1.9.3 和 Rails v3.2.8 一起使用。输入参数将不匹配一个数字的结尾和下一个数字的开头，即使在正确的位置输入空格也不匹配，即使在搜索字段代码中，我替换`_cont`为`_spaces_match_anything`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-05T21:54:01.513

把它放在你的 search_form_for 标签下。这是假设您使用的是 f：

```
<%= f.combinator_select %> 
```

它将生成一个带有两个选项的选择。全部或任何。ANY 将使用 OR 子句。ALL 将使用 AND 子句。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-11-21T12:01:57.093

现在我们可以很简单地使用 or-query 和 ransack：

```
Position.ransack(description: 'secret').result.or(Position.ransack(code: 0).result) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-17T20:09:38.250

在深入研究了[Ransack 演示](https://github.com/ernie/ransack_demo)代码之后，我做了如下操作：

```
field = "secre"
q= {
  "m"=>"or", 
  "c"=>{
    "0"=>{
      "a"=>{
        "0"=>{
          "name"=>"description"
        }
      }, 
      "p"=>"cont", 
      "v"=>{
        "0"=>{
          "value"=>field
        }
      }
    }, 
    "1"=>{
      "a"=>{
        "0"=>{
          "name"=>"code"
        }
      }, 
      "p"=>"cont", 
      "v"=>{
        "0"=>{
          "value"=>field
        }
      }
    }
  }
}
Position.search(q).result(:distinct => true).to_sql
 => "SELECT DISTINCT `positions`.* FROM `positions`  WHERE ((`positions`.`description` LIKE '%secre%' OR `positions`.`code` LIKE 0))" 
```

是的，这很恶心，当然这不应该是最好的方法，但它暂时救了我。还有其他想法吗？

# c# - Unity 拦截器——TransparentProxyInterceptor

> ID：12940631
> 
> 赞同：2
> 
> 时间：2012-10-17T18:12:18.530
> 
> 标签：c#, unity-container, interceptor

我正在尝试拦截 WCF 客户端。但是 Unity 拦截器似乎不起作用。

1.  我没有接到代理的电话。
2.  我不知道如何将属性链接到容器
3.  在 AddPolicy 中，name 属性是什么 - 这里我使用了拦截函数 - GetXml。

```
[AttributeUsage(AttributeTargets.Class | AttributeTargets.Property | AttributeTargets.Method)]
public class GetXmlCallHandlerAttribute : HandlerAttribute
{
  public GetXmlCallHandlerAttribute(){}
  public override ICallHandler CreateHandler(IUnityContainer ignored)
  {
    return new GetXmlTestCallHandler();
  }
}
public class GetXmlTestCallHandler : ICallHandler
{
  public int Order { get; set; }  
  public IMethodReturn Invoke(IMethodInvocation input, GetNextHandlerDelegate getNext)
  {
    IMethodReturn msg;
    Object returnValue = XElement.Load("../../Resources/a1.xml");
    Object[] outputs = null;
    msg = input.CreateMethodReturn(returnValue, outputs);
    return msg;        
  }
} 
class SendDataTest
{
  public void GetXmlTest()
  {
    IUnityContainer container = new UnityContainer();
    ICallHandler myInterception = new GetXmlTestCallHandler();    
    container.AddNewExtension<Interception>();
    container.RegisterType<SendData>(new Interceptor(new TransparentProxyInterceptor()));
    container.Configure<Interception>().AddPolicy("GetXml").AddCallHandler(myInterception);
    SendData target = container.Resolve<SendData>();
    XElement expected = null; // TODO: Initialize to an appropriate value
    XElement actual;
    actual = target.GetXml();
    Assert.AreEqual(expected, actual);
    Assert.Inconclusive("Verify the correctness of this test method.");
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T10:05:54.003

您需要做几件事：-

您需要在注册 SendData 时添加 InterceptionBehaviour() 例如

```
 container.RegisterType<SendData>(new InterceptionBehaviour<PolicyInjectionBehaviour>(), new Interceptor(new TransparentProxyInterceptor())); 
```

这是为了让 Unity 知道参与您创建的任何策略。TransparentProxyInterceptor 只是说明如何实际执行拦截。

您还需要在要拦截的适当方法上应用属性 - 我假设您已经在 SendData 类的 GetXml 方法上完成了该操作。

# jquery - jQuery prepend - 防止自动滚动

> ID：12940635
> 
> 赞同：5
> 
> 时间：2012-10-17T18:12:33.863
> 
> 标签：jquery, scroll, prepend

我只是在使用 jQuery `prepend`，但无法按预期工作。

**我在做什么：**

> 每隔一秒添加一个`.content`div 到`#main`div

但是，当我向下滚动一点时[一旦页面充满了内容]，我会不断滚动回到`#main`'s top 或 latest 前面`.content`

**我如何能：**

> 防止`viewport`改变 - 比如在追加的情况下

相关[小提琴](http://jsfiddle.net/66RvC/)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-17T18:24:41.647

正如我在评论中解释的那样，滚动实际上并没有改变。窗口的滚动基于“与顶部的距离”（DfT）。也就是说，如果您没有滚动条，那么您的 DfT 为 0。一旦引入了滚动条，您现在就有一段距离可以使用了。

因为内容越来越长，所以视口只有这么多像素高，一些内容“从”页面底部“掉下来”（预先使 DfT 偏离新元素的高度）。

我能想到的最好方法是用新元素的高度来对抗它。这允许您滚动到一个位置，然后随着新元素的添加，您相应地修改滚动位置。

这是我的意思的一个例子：http: [//jsfiddle.net/bradchristie/66RvC/1/](http://jsfiddle.net/bradchristie/66RvC/1/)

和代码（供参考）：

```
var f = function(){
    var t = $(window).scrollTop(),      // Window's current scroll position
        $d = $(d()).prependTo('#main'), // store the new element
        h = $d.outerHeight();           // also get its height
    if (t){                             // Only adjust if they've scrolled
        $(window).scrollTop(t + h);     // add the delta to the scroll position
    }
    setTimeout( f, 1000 );
}; 
```

# java - 无法在 Eclipse 中运行 SWT 应用程序

> ID：12940652
> 
> 赞同：4
> 
> 时间：2012-10-17T18:13:42.957
> 
> 标签：java, eclipse, swt

我正在学习 Eclipse 编辑器中的教程（单击`Help -> Welcome -> Tutorials`）。我完成了以下所有步骤：

> 这份备忘单向您展示了如何创建一个使用标准小部件工具包 (SWT) 的“Hello World”应用程序。该应用程序将简单地向用户显示一个空窗口。如果您在任何步骤需要帮助，请单击右侧的 (?)。让我们开始吧！
> 
> 如果您尚未在 Java 透视图中，请在主菜单中选择 Window > Open Perspective > Java 或单击下面的“Click to Perform”链接。
> 
> 通过 File > Import... 从主菜单打开 Import 向导，然后选择 Plug-in Development > Plug-ins and Fragments。点击下一步。在 Import Plug-ins and Fragments 页面上，选择 Import from: The active target platform。要导入的插件和片段：从在指定位置找到的所有插件和片段中进行选择。导入为：带有源文件夹的项目。点击下一步。在 Selection 页面上，将 org.eclipse.swt.{platform}.{os}.{arch}（例如：org.eclipse.swt.win32.win32.x86 for win32）添加到 Plug-ins and Fragments to Import：列表。单击完成。这将创建 org.eclipse.swt.{platform}.{os}.{arch} 项目，我们将需要它来编译和运行应用程序。
> 
> 现在我们需要一个项目来存储我们自己的源代码。在主工具栏中，单击 New Java Project 按钮，或单击下面的链接。输入 HelloWorldSWT 作为项目名称，然后单击 Finish。
> 
> 由于我们的项目需要 SWT，我们需要在项目属性中指定它。右键单击项目并选择属性。在 Java Build Path 页面中打开 Projects 选项卡，添加 org.eclipse.swt.{platform}.{os}.{arch} 项目，然后单击 OK。
> 
> 下一步是创建一个新类。在主工具栏中，单击 New Java Class 按钮（或下面的链接）。如果尚未指定，请选择 HelloWorldSWT/src 作为源文件夹。输入 HelloWorldSWT 作为类名并选中复选框以创建 main() 方法，然后单击 Finish。Java 编辑器将自动打开并显示您的新类。
> 
> 在 Java 编辑器中，在 main() 方法中输入以下 Java 代码： Display display = new Display(); 壳壳 = 新壳（显示）；shell.setText("你好世界！"); shell.open(); while (!shell.isDisposed()) { if (!display.readAndDispatch()) display.sleep(); } display.dispose(); 你会得到编译错误。右键单击 Java 编辑器并选择 Source > Organize Imports，然后保存您的更改。
> 
> 要运行您的应用程序，请在 Package Explorer 中右键单击您的类并选择 Run As > Java Application。应出现一个新的空窗口，标题为“Hello world！”。恭喜！您已成功创建 Hello World SWT 应用程序！

这是一个屏幕截图：

![截屏](../Images/a9106530a55bd8777bf44d9e68d96f6f.png)

但是当我尝试运行程序时，它没有按预期显示空白屏幕，而是将其转储到终端中：

```
Exception in thread "main" java.lang.UnsatisfiedLinkError: Could not load SWT library. Reasons: 
no swt-cocoa-4233 in java.library.path
no swt-cocoa in java.library.path
Can't load library: /Users/devenkelling/.swt/lib/macosx/x86_64/libswt-cocoa-4233.jnilib
Can't load library: /Users/devenkelling/.swt/lib/macosx/x86_64/libswt-cocoa.jnilib

at org.eclipse.swt.internal.Library.loadLibrary(Library.java:331)
at org.eclipse.swt.internal.Library.loadLibrary(Library.java:240)
at org.eclipse.swt.internal.C.<clinit>(C.java:21)
at org.eclipse.swt.widgets.Display.<clinit>(Display.java:101)
at HelloWorldSWT.main(HelloWorldSWT.java:11 
```

我正在使用安装了 64 位 Eclipse 以及 32 位和 64 位版本的 Java（我认为）的 x64 系统。请帮忙。谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-17T18:13:42.957

> **资料来源：** [Eclipse 论坛](http://www.eclipse.org/forums/index.php/m/908129/)

这对我有用：

*   `Right-click`在您的项目文件夹中`HelloWorldSWT`；

*   转到`Properties`-> 左侧边栏`Java Build Path`-> 选项卡`Projects`；

*   `org.eclipse.swt.cocoa.macosx.x86_64`单击左侧的箭头展开文件夹；

*   选择`Native library location`并单击`Edit`；

*   单击`Workspace`按钮并选择`org.eclipse.swt.cocoa.macosx.x86_64`；

*   点击`OK`几次；

你完成了！希望这有帮助。

# xquery - 如何创建一个函数来检查字符串是否仅包含 AZ , 0-9

> ID：12940655
> 
> 赞同：0
> 
> 时间：2012-10-17T18:13:52.983
> 
> 标签：xquery

如果输入字符串只有字符 AZ 或数字 0-9 而没有其他字符，有什么方法可以检查 Xquery（一个 Xquery 函数）。例如，如果字符串是 ABZ10，则函数应返回 true，如果输入字符串为 5& 123x，则返回 false。我可以通过简单地使用以下方法在 java 中做到这一点。

```
inputstring.matches("^[0-9A-Z]+$")) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T19:21:53.903

**使用**：

```
matches($vYourString, '^[A-Z0-9]+$') 
```

# mysql - mysql.sock 和 rails

> ID：12940656
> 
> 赞同：0
> 
> 时间：2012-10-17T18:13:55.333
> 
> 标签：mysql, ruby-on-rails, mysql.sock

这不一定是一个编程问题，但这个问题肯定会阻碍开发（更不用说在 stackoverflow 上有数以千计的问题与此相关，但我看不到解决我正在处理的问题）。

我已经使用 rails 和 mysql 几个月了。在我进行安装时，一切都很好，直到大约一周前，我能够运行迁移、phpmyadmin 等，没有任何问题。

今天，我正在尝试创建一个新应用程序（遵循 railscast 323）。我还使用 Rubymine 作为 IDE。

我使用 IDE project.new 创建了项目，并创建了一个新的 Rails 应用程序。然后我继续创建脚手架以及迁移文件。然后我做了 rake db:create ，看起来好像创建了数据库。当我尝试执行 rake db:migrate 时，出现以下错误：

'无法通过套接字'/tmp/mysql.sock'（2）连接到本地MySQL服务器'

我检查了我的 config/database.yml （该文件是由 IDE 创建的），它确实有

套接字：/tmp/mysql.sock

附加信息：

有一个 /usr/local/var/mysql/store_development 目录，所以看起来好像创建了数据库。

我可以去/localhost/phpmyadmin，但是我的root密码不被接受（我没有更改root密码）

我还没有重新安装mysql 我还没有更新mysql

/tmp/mysql.sock 不再存在 /usr/var/mysql/mysql.sock 不存在

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-23T15:04:07.943

首先，确保 mysqld 正在运行。如果是，试试这个：

```
ln -sf $(locate mysql.sock) /tmp 
```

# c# - CustomError 页面中的错误信息

> ID：12940659
> 
> 赞同：0
> 
> 时间：2012-10-17T18:14:00.793
> 
> 标签：c#, .net, error-handling, webforms

我想要一个自定义错误页面，显示一些错误信息，但不显示堆栈跟踪。我希望它显示违规页面和行号的信息。

默认的 SERVER ERROR IN APPLICATION 页面显示 url/行号和周围的代码/堆栈跟踪。

我只希望 url/行号出现在更漂亮的自定义错误页面中的某处。这样我们的代码在抛出错误时不会暴露，但我仍然可以通过 url/行号快速找到错误。

我已经打开了自定义错误页面。我只想向他们添加其他信息。我正在使用 C#.NET 4.0 和网络表单。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T18:33:30.103

这是我有一段时间和最长的一个问题，虽然这是不可能的，所以我做了一些研究并找到了解决方案。您需要使用命名空间中的`StackFrame`对象`System.Diagnostics`。我只是整理了一个例子，它似乎奏效了。

```
try
{
    int a = 10;
    int b = 0;
    litDebug.Text = (a / b).ToString();
}
catch (Exception ex)
{
    StackTrace st = new StackTrace(ex, true);
    StackFrame sf = st.GetFrame(0);
    litDebug.Text = "" +
        "<br />File Name: " + sf.GetFileName() +
        "<br />Method Name: " + sf.GetMethod().Name +
        "<br />Error Line Number: " + sf.GetFileLineNumber() +
        "<br />Error Column Number: " + sf.GetFileColumnNumber();
} 
```

页面输出为：

```
File Name: c:\inetpub\www.website.com\dev\error.aspx.cs
Method Name: Page_Load
Error Line Number: 17
Error Column Number: 4 
```

唯一有问题的项目是错误列号 - 其他所有内容都完美匹配。

# c++ - 我真的这么愚蠢吗：this = 0x7ffffffe

> ID：12940661
> 
> 赞同：2
> 
> 时间：2012-10-17T18:14:11.413
> 
> 标签：c++, visual-c++

我有一个非常简单的类存根 - 我刚刚开始制作它：

```
class CJSScript
{
public:
    CJSScript(std::string scriptfile);
    ~CJSScript(void);
private:
    std::string scriptname;
};
CJSScript::CJSScript(std::string scriptfile)
{
    size_t found = scriptfile.find_last_of("/\\");
    scriptname = scriptfile.substr(found+1);
    printf("should load %s now...", scriptname);

} 
```

但是在那个构造函数中我得到一个异常，`this`显然设置为`0x7ffffffe`

主程序是

```
int _tmain(int argc, _TCHAR* argv[])
{
    CJSScript* test=new CJSScript("./script/test.js");
  system("pause");
    return 0;
} 
```

这到底是怎么回事。我以为我很久以前就有基础知识了，但这是一种妥协。我或编译器:)

调试器转储：

```
Win32Project3.exe!_output_l(_iobuf * stream, const char * format, localeinfo_struct * plocinfo, char * argptr) Line 1649    C++
Win32Project3.exe!printf(const char * format, ...) Line 62  C
Win32Project3.exe!CJSScript::CJSScript(std::basic_string<char,std::char_traits<char>,std::allocator<char> > scriptfile) Line 11 C++
Win32Project3.exe!wmain(int argc, wchar_t * * argv) Line 38 C++
Win32Project3.exe!__tmainCRTStartup() Line 240  C 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-17T18:18:35.073

`printf`不知道如何处理`string`对象。你需要通过一个`const char*`：

```
 printf("should load %s now...", scriptname.c_str()); 
```

这是类型安全的问题。出于这个原因，我更喜欢使用流。

```
cout << "should load " << scriptname << " now..."; 
```

# java - 向 HashSet/HashMap 添加重复值是否会替换先前的值

> ID：12940663
> 
> 赞同：149
> 
> 时间：2012-10-17T18:14:14.990
> 
> 标签：java, hashmap, duplicates, hashset

请考虑以下代码：

```
HashSet hs = new HashSet();
hs.add("hi"); -- (1)
hs.add("hi"); -- (2) 
```

`hs.size()`将给出 1 因为`HashSet`不允许重复，因此只会存储一个元素。

我想知道我们是否添加了重复元素，然后它会替换前一个元素还是根本不添加它？

另外，同样的情况会发生什么`HashMap`？

* * *

## 回答 #1

> 赞同：265
> 
> 时间：2012-10-17T18:14:55.927

在 的情况下[`HashMap`](http://docs.oracle.com/javase/7/docs/api/java/util/HashMap.html#put%28K,%20V%29)，它将旧值替换为新值。

在 的情况下[`HashSet`](http://docs.oracle.com/javase/7/docs/api/java/util/HashSet.html#add%28E%29)，不插入项目。

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2012-10-17T18:22:01.100

您需要知道的第一件事是它的`HashSet`行为类似于 a `Set`，这意味着您将对象直接添加到`HashSet`并且它不能包含重复项。您只需将您的价值直接添加到`HashSet`.

但是，`HashMap`是一种`Map`类型。这意味着每次添加条目时，都会添加一个键值对。

`HashMap`你可以有重复的值，但不能有重复的键。在`HashMap`新条目中将替换旧条目。最近的条目将在`HashMap`.

**理解 HashMap 和 HashSet 之间的联系：**

记住，`HashMap`不能有重复的键。幕后`HashSet`使用`HashMap`.

当您尝试将任何对象添加到 中`HashSet`时，此条目实际上作为键存储在中`HashMap`- 与`HashMap`在幕后使用的相同`HashSet`。由于这个底层`HashMap`需要一个键值对，因此为我们生成了一个虚拟值。

现在，当您尝试将另一个重复的对象插入同一个对象时`HashSet`，它会再次尝试将其作为键插入到`HashMap`下面。但是，`HashMap`不支持重复。因此，`HashSet`仍然会导致只有一个该类型的值。附带说明一下，对于每个重复的键，由于为我们在 HashSet 中的条目生成的值是一些随机/虚拟值，因此根本不会替换键。它将被忽略，因为删除密钥并添加回相同的密钥（虚拟值相同）根本没有任何意义。

**概括：**

`HashMap`允许重复`values`，但不允许`keys`。 `HashSet`不能包含重复项。

玩对象的添加是否成功完成，你可以检查`boolean`调用时返回的值`.add()` ，看看它是否返回`true`或`false`。如果它返回`true`，它被插入。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2012-10-17T18:15:55.977

[文档](http://docs.oracle.com/javase/6/docs/api/java/util/HashSet.html#add%28E%29)对此非常清楚：`HashSet.add` *不*取代：

> 如果指定的元素尚不存在，则将其添加到此集合中。更正式地说，如果此集合不包含元素 e2，则将指定的元素 e 添加到此集合中，使得 (e==null ? e2==null : e.equals(e2))。*如果该集合已包含该元素，则调用将保持该集合不变并返回 false。*

但*将*替换：[`HashMap.put`](http://docs.oracle.com/javase/6/docs/api/java/util/HashMap.html#put%28K,%20V%29)

 *> 如果映射先前包含键的映射，则替换旧值。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-10-17T18:18:00.030

在 HashSet 的情况下，它不会取代它。

从文档：

[http://docs.oracle.com/javase/6/docs/api/java/util/HashSet.html#add(E](http://docs.oracle.com/javase/6/docs/api/java/util/HashSet.html#add(E) )

“如果指定的元素不存在，则将其添加到此集合中。更正式地说，如果此集合不包含元素 e2，则将指定的元素 e 添加到此集合中，这样 (e==null ? e2==null : e.equals( e2))。如果该集合已经包含该元素，则调用保持该集合不变并返回 false。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-17T18:19:25.080

如果我错了，请纠正我，但你得到的是字符串，“Hi”==“Hi”并不总是正确的（因为它们不一定是同一个对象）。

您得到 1 答案的原因是 JVM 将在可能的情况下重用字符串对象。在这种情况下，JVM 正在重用字符串对象，从而覆盖 Hashmap/Hashset 中的项目。

但是您不能保证这种行为（因为它可能是具有相同值“Hi”的不同字符串对象）。您看到的行为仅仅是因为 JVM 的优化。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-12-03T16:49:11.320

`HashMap`基本上包含`Entry`随后包含`Key(Object)`和`Value(Object)`.Internally`HashSet`并且确实替换了一些您已经指出的值..但它真的替换了键吗？？？不..这就是这里的技巧`HashMap`。将其值保留为底层中的键，值只是一个虚拟对象。因此，如果您尝试在 HashMap 中重新插入相同的值（底层映射中的键）。它只是替换虚拟值而不是键（HashSet 的值）。`HashMap``HashMap``HashMap`

看下面的 HashSet 类代码：

```
public boolean  [More ...] add(E e) {

   return map.put(e, PRESENT)==null;
} 
```

这里 e 是 HashSet 的值，但底层 map.and 的键永远不会被替换。希望我能够消除混乱。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-09-09T15:57:42.353

您需要先检查 Hash map 中的 put 方法，因为 HashSet 由 HashMap 备份

1.  当您在 HashSet 中添加重复值时说一个字符串“One”，
2.  一个条目（“one”，PRESENT）将被插入到 Hashmap 中（对于添加到集合中的所有值，该值将是“PRESENT”，如果是 Object 类型）
3.  Hashmap 将条目添加到 Map 并返回值，在本例中为“PRESENT”，如果条目不存在，则返回 null。
4.  如果 Hashmap 的返回值等于 null，则 Hashset 的 add 方法返回 true，否则返回 false，这意味着条目已经存在......

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-08-24T09:04:24.857

换一种说法：当您将键值对插入到键已经存在的 HashMap 中时（从某种意义上说，hashvalue() 给出了相同的值，而 equal() 为真，但是这两个对象仍然可以在几个方面有所不同)，键不会被替换，但值会被覆盖。键仅用于获取 hashvalue() 并使用它在表中查找值。由于 HashSet 使用 HashMap 的键并设置（对用户而言）并不重要的任意值，因此 Set 的元素也不会被替换。*

# javascript - jqGrid 问题分组 - 每次更改排序时都会附加重复的行

> ID：12940664
> 
> 赞同：2
> 
> 时间：2012-10-17T18:14:19.293
> 
> 标签：javascript, jquery, jqgrid

我正在使用 jqGrid 并将分组添加到我的一个网格中。未启用分组时一切正常，但是一旦我添加：

```
grouping: true,
groupingView: { groupField: ['ProjName'], groupDataSorted: true } 
```

我开始遇到一些奇怪的行为。当我单击其中一个列标题来更改排序顺序时，不是清除网格中的现有行，而是将新行附加到网格的末尾，所有组都被复制。

换句话说，当页面第一次绘制时，我看到：

![在此处输入图像描述](../Images/f20fd67519655d0b6c31598605677e93.png)

然后，我点击一个排序标题，我得到了这个：

![在此处输入图像描述](../Images/5974a813e9e77a1a52161d14db407d0a.png)

我的初始化代码如下：

```
var gridMyTasks = $('#gridMyTasks').jqGrid({
    jsonReader: { root: 'rows', repeatitems: false, id: 'ID' },
    datatype: 'json',
    colNames: ['Task ID', 'Task Name', 'Project Name', 'Task Stage', 'Doc Type', 'Due Date'],
    colModel: [
        { name: 'ShortCode', width: 70, jsonmap: 'ShortCode' },
        { name: 'TaskName', width: 200, jsonmap: 'TaskName', formatter: 'fmtTaskName' },
        { name: 'ProjName', width: 200, jsonmap: 'ProjName', formatter: 'fmtName' },
        { name: 'TaskStage', width: 100, jsonmap: 'TaskStage' },
        { name: 'DocType', width: 130, jsonmap: 'DocType' },
        { name: 'DueDate', width: 70, jsonmap: 'DueDate' }
    ],
    rowNum: 0,
    height: 'auto',
    autowidth: true,
    forceFit: true,
    multiselect: false,
    caption: '',
    altclass: 'zebra',
    altRows: true,
    hoverrows: false,
    gridview: true,
    grouping: true,
    groupingView: { groupField: ['ProjName'], groupDataSorted: true }
}); 
```

我的加载程序代码（在排序时再次调用）如下所示：

```
loader(limit, curSort, curDir, function (results) {
    grid[0].addJSONData({ rows: results });
    $('body').hideLoading();
    link.html(expanded ? 'Show less...' : 'Show all...');
},
null); 
```

（`loader`是对服务器的 AJAX 调用） - 我在想也许我需要做一些事情来清除所有现有的行？但是，为什么在我启用分组之前它工作得非常好？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T20:09:19.327

我想到了。我有以下代码：

```
grid.setGridParam({
    onSortCol: function (index, iCol, sortorder) {
        wait();
        curSort = index;
        curDir = (sortorder == 'desc');
        loadGrid(expanded ? null : 15);
        return 'stop'; // <--- Problem
    }
}); 
```

当我发表评论时`return 'stop'`，问题就消失了。我不完全确定我为什么要这样做，我想我试图禁用任何类型的内置排序。

# c# - 遍历 Windows 目录树并检索每个文件夹的权限

> ID：12940671
> 
> 赞同：0
> 
> 时间：2012-10-17T18:14:30.597
> 
> 标签：c#, windows, acl

我需要一个程序来遍历 Windows 2003 Server（或兼容）上的给定目录树并返回有权访问每个文件夹的组和用户。我还需要每个有权访问该文件夹的用户的确切权限。输出应该是包含任何可用格式、csv、json 或 xml 等的文本文件。

如果这样的程序不是免费提供的，我需要一个关于使用哪些 Windows 函数来检索安全信息的说明。我在 Visual Studio 2012 上，我已经有了遍历树结构的算法。我需要知道如何从文件夹中检索安全信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T18:46:55.103

试试下面的链接。它不会将其导出到 csv 文件，尽管您可以修改 bat 文件来这样做。

[http://www.windowsitpro.com/article/tips/jsi-tip-0596-how-do-i-print-the-permissions-on-a-directory-tree-](http://www.windowsitpro.com/article/tips/jsi-tip-0596-how-do-i-print-the-permissions-on-a-directory-tree-)

我刚试了一下，输出看起来像这样

```
i:\MyDirectory\SomeDirectory BUILTIN\Administrators:F 
                         BUILTIN\Administrators:(OI)(CI)(IO)F 
                         NT AUTHORITY\SYSTEM:F 
                         NT AUTHORITY\SYSTEM:(OI)(CI)(IO)F 
                         NT AUTHORITY\Authenticated Users:C 
                         NT AUTHORITY\Authenticated Users:(OI)(CI)(IO)C 
                         BUILTIN\Users:R 
                         BUILTIN\Users:(OI)(CI)(IO)(special access:)

                                                   GENERIC_READ
                                                   GENERIC_EXECUTE 
```

# php - 如何避免重复数组中的几个项目之一（类别名称）

> ID：12940672
> 
> 赞同：1
> 
> 时间：2012-10-17T18:14:31.533
> 
> 标签：php, grouping

我知道这里有类似的问题，我已经阅读了一些帖子和答案，并尝试了其中的一些，但无论是我对 PHP 的了解有限还是我的案例的特殊性，我都需要问这个。

我正在构建字典（id、英语、保加利亚语、主题 ID）并希望根据主题 ID 对搜索结果进行分组。我`ORDER BY theme_id, id`在我的查询中使用，但我最终显示了每个结果的主题，而我想将它们分类如下：

主题 1 - 结果 1 - 结果 2 主题 2 - 结果 3 - 结果 4 .....

这是我的代码的相关部分：

```
while($row = mysql_fetch_array($result)) {
    //$id       = $row['id'];
    $english    = $row['english'];
    $bulgarian  = $row['bulgarian'];
    $theme_id   = $row['theme_id'];

    $theme_name = "theme_".$lang;
    $theme_query= mysql_query("SELECT theme_id,".$theme_name." FROM ".DICTIONARY_THEMES." WHERE theme_id = ".$theme_id."");
    $theme_row  = mysql_fetch_array($theme_query);
    $theme      = $theme_row[$theme_name];

    if($source == "english") {

        foreach($keywords as $keyword) {
            $english = preg_replace("|($keyword)|Ui", "<span style=\"color:#780223\">".$keyword."</span>", $english);
        }

        $print .= "<li class=\"results-row\">".$theme.": ".$english." = ".$bulgarian."</li>";
    }

    elseif($source == "bulgarian") {
        foreach($keywords as $keyword) {
            $bulgarian = preg_replace("|($keyword)|Ui", "<span style=\"color:#780223;\">".$keyword."</span>", $bulgarian);
        }

        $print .= "<li class=\"results-row\">".$theme.": ".$bulgarian." = ".$english."</li>";
    }
}//end while 
```

编辑：已解决，一位朋友帮助改进了我的代码。

```
while($row = mysql_fetch_array($result)) {
    $english    = $row['english'];
    $bulgarian  = $row['bulgarian'];
    $theme_id   = $row['theme_id'];

    $theme_name = "theme_".$lang;
    $theme_query= mysql_query("SELECT theme_id,".$theme_name." FROM ".DICTIONARY_THEMES." WHERE theme_id = ".$theme_id."");
    $theme_row  = mysql_fetch_array($theme_query);
    $theme      = $theme_row[$theme_name];

    // add all results to an array
    $results[] = array(
        'english'   => $english,
        'bulgarian' => $bulgarian,
        'theme'     => $theme
    );

}//end while

$theme = null;
foreach ($results as $result) {
    if ($theme != $result['theme']) {
        $theme = $result['theme'];
        $print .= "<h3>" . $result['theme'] . "</h3>";
    }

    if ($source == "english") {
        foreach ($keywords as $keyword) {
            $result['english'] = preg_replace("|($keyword)|Ui", "<span style=\"color:#780223\">" . $keyword . "</span>", $result['english']);
        }
        $print .= "<li class=\"results-row\">" . $result['english'] . " = " . $result['bulgarian'] . "</li>";
    } elseif ($source == "bulgarian") {
        foreach ($keywords as $keyword) {
            $result['bulgarian'] = preg_replace("|($keyword)|Ui", "<span style=\"color:#780223;\">" . $keyword . "</span>", $result['bulgarian']);
        }
        $print .= "<li class=\"results-row\">" . $result['bulgarian'] . " = " . $result['english'] . "</li>";
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T18:51:00.897

根据您的代码，您应该首先将所有项目添加到数组中，然后在单独的函数/块中打印该数组。

在你的第二个 MySQL 查询之后，输入类似

```
$output[$theme_id] = mysql_fetch_array( $theme_query ); 
```

并将以下所有代码移出外部 result-while-loop ( `while($row = mysql_fetch_array($result))`)。

但事实上，我会尝试将 MySQL 查询放在一起，以获得所有语言中所有选定主题的有序、分组结果，而无需在循环内查询数据库。

或者您使用现有的东西，例如这个[单例 Lexicon 类](https://static.thomas-heuer.eu/snippets/lexicon.example.php)。

# javascript - Facebook 发送按钮空弹出

> ID：12940673
> 
> 赞同：0
> 
> 时间：2012-10-17T18:14:37.173
> 
> 标签：javascript, facebook

我有一个 Facebook XFBML *Like*和*Send*按钮。
该代码是使用[Facebook 之类的插件](http://developers.facebook.com/docs/reference/plugins/like/)生成的。
*Like*似乎运作良好，但*Send*只显示一个空的弹出窗口。

**示例**
[http://jsfiddle.net/CVDLc/1/](http://jsfiddle.net/CVDLc/1/)
*单击“发送”按钮以查看空的弹出窗口*

有人知道为什么吗？

# html - 让两个子 DIV 匹配一个父 DIV 的高度？

> ID：12940675
> 
> 赞同：0
> 
> 时间：2012-10-17T18:14:42.410
> 
> 标签：html, css

我在一个主要用于教育目的的网站上工作。在设计某些东西时，我有点强迫症，喜欢它是完美的；）。我遇到了一个我似乎无法解决的问题，所以我希望你们中的一些人可以提供解决方案或了解涵盖此类事情的网站。

在那里我有父DIV和两个子DIV......

```
<div id="container">
    <div id="container-left"></div>
    <div id="container-right"></div>
</div> 
```

两个子 DIV 都有自己的内容，并且高度各不相同。我的网站设计方式`#container-right`的高度必须等于或大于`#container-left`设计看起来正确的高度。

这是该网站的链接：[www.lulzorg.com/?p=w7ws8](http://www.lulzorg.com/?p=w7ws8)

这是一个网站捕获显示我的意思：[skiroid.com/website_capture.jpg](http://skiroid.com/website_capture.jpg)

谢谢你的时间！:D 有什么问题吗？请问！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T18:16:14.973

几种方法：

```
#container { height: 100px; }
#container div { height: 100%; } 
```

或者

```
#container { display: table; }
#container div { display: table-cell; } 
```

[http://jsfiddle.net/](http://jsfiddle.net/)

# shell - 将日期和时间转换为一个数字 Bash 编程

> ID：12940676
> 
> 赞同：1
> 
> 时间：2012-10-17T18:14:52.427
> 
> 标签：shell

输入文件包含

```
2012-12-23 23:59:59 
```

我必须先将时间转换为秒，然后与日期结合（将日期作为小数添加到时间）

```
time (sec) = 23*3600 + 59*60 + 59 = 86400 
```

日期 .23（仅限日期）

输出应该是`86400.23`

请朋友们帮帮我。我无法让这个工作。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T18:28:46.507

请参阅以下`bash`代码：

```
d='2012-12-23 23:59:59'
IFS=: read h m s <<< "$d"
day=${d% *}; day=${day##*-}
echo $(( (${h#* } * 3600) + (m * 60) + s)).$day 
```

或与`awk`：

```
d='2012-12-23 23:59:59'
read day hour min sec < <(awk -F'[ :-]' '{print $3, $4, $5, $6}' <<< "$d")
echo $(( (hour * 3600) + (min * 60) + sec)).$day 
```

或者简单地说：

```
 echo '2012-12-23 23:59:59' | awk -F'[ :-]' '{print ($4*3600)+($5*60)+$6"."$3}' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T20:02:50.250

您可以使用`date`命令来验证/格式化输入：

```
#!/bin/bash
read datetime
date=$(date --date="$datetime" +%d)
time=$(date --date="$datetime" +"1970-01-01 %H:%M:%S UTC")
echo $(date --date="$time" +%s).$date
# -> 86399.23 
```

[演示](http://ideone.com/2L76G)

# mysql - MySQL 计算其他表上的 FK

> ID：12940678
> 
> 赞同：-1
> 
> 时间：2012-10-17T18:15:08.637
> 
> 标签：mysql, sql, count, foreign-keys

两个表：成员、组。

我想从 MEMBER 表中获取姓名和电子邮件，并且我想获取成员注册的 GROUPS 数量。

GROUP 有一个 memberId 作为 FK。所以 memberId = 1 可以有很多 groupID。

我想要一个 SQL 查询来收集所有成员的信息以及他们所在的组数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T18:22:02.153

```
SELECT name, email, count(`GROUP`.id)
FROM `MEMBER` INNER JOIN `GROUP` ON `GROUP`.memberId = MEMBER.memberId
GROUP BY MEMBER.memberId 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T18:35:42.723

我假设 MEMBER 的主键是 memberId。试试这个

```
SELECT m.name, m.email, count(g.memberId )
FROM `MEMBER` m 
LEFT JOIN `GROUP` g ON g.memberId = m.memberId
GROUP BY m.memberId 
```

# jquery - jQuery . $(' ') 是什么意思？

> ID：12940679
> 
> 赞同：1
> 
> 时间：2012-10-17T18:15:10.137
> 
> 标签：jquery, jquery-selectors, jquery-attributes

> **可能重复：**
> [$(“<div/>”).text(message) 中的选择器语法是什么意思](https://stackoverflow.com/questions/9127898/what-does-the-selector-syntax-mean-in-div-text-message)

我已经搜索但找不到任何关于此的信息...包括 jQuery 参考...

`$('<img/>')`在 jQuery中是什么意思？我`$('img')`只熟悉。

我在这篇文章中遇到过这段代码：http: [//tympanus.net/codrops/2010/11/16/hover-slide-effect/](http://tympanus.net/codrops/2010/11/16/hover-slide-effect/)

但是在代码中，当我用另一个替换一个时，它会停止工作，所以我猜它们不一样。

另外，最后一段代码：

```
.attr('src',$this.attr('src')); 
```

它是干什么用的？它似乎是多余的，但如果我删除它也会失败。谁能详细说明这一点？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T18:16:10.273

`$(anyHtmlCode)`构建一组由您提供的 HTML 构建的 jQuery 包装元素。

[从文档中：](http://api.jquery.com/jQuery/)

> 如果一个字符串作为参数传递给`$()`，jQuery 会检查该字符串以查看它是否看起来像 HTML（即，它`<tag ... >`在字符串中的某个位置）。如果不是，则字符串被解释为选择器表达式，如上所述。但是如果字符串看起来是一个 HTML 片段，jQuery 会尝试按照 HTML 的描述创建新的 DOM 元素。然后创建并返回一个引用这些元素的 jQuery 对象。你可以在这个对象上执行任何常用的 jQuery 方法

线

```
$someElement.attr('src',$this.attr('src')); 
```

将 $someElement 的 src 设置为与 $this 的相同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T18:18:56.470

`$('<img />')`实际上创建一个新`img`元素并将其包装在一个 jQuery 对象中，同时`$('img')`选择`img`页面上的所有元素。

`$('img').attr('src',$this.attr('src'))`设置第一个匹配`img`元素的`src`属性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-17T18:16:23.847

`$('<img/>')`正在创建一个新的图像标签。它类似于

```
document.createElement('img') 
```

# android - Android：大 mdpi/hdpi 屏幕上的可绘制对象的横向支持？

> ID：12940688
> 
> 赞同：2
> 
> 时间：2012-10-17T18:15:31.763
> 
> 标签：android

我有一个应用程序，它可以在手机和平​​板电脑上运行，而且我支持多种屏幕尺寸。

某些设备，如摩托罗拉 XOOM 和三星 Galaxy Tab 10.1，在以下配置下具有最受可绘制对象支持的屏幕尺寸：

```
drawable-large-mdpi
drawable-large-hdpi 
```

在纵向模式下，设备将自动在这些文件夹中拾取纵向可绘制对象。

但是，如果我尝试创建一个文件夹，例如：

```
drawable-land-large-mdpi 
```

Eclipse 会`Invalid resource directory name`报错。此外，尽管具有在其他设备上完美运行的特定于横向的布局，但在这些设备上，当您进入横向模式时，它会使用纵向图像，因为（我猜）它找不到等效的横向图像。

那么我应该怎么做才能在横向模式下正确支持这些设备呢？他们现在看起来很糟糕。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-10-17T18:25:50.060

我认为后缀的正确顺序是：

```
drawable-large-land-mdpi 
```

# c++ - 如何将函数指针传递给该函数

> ID：12940689
> 
> 赞同：0
> 
> 时间：2012-10-17T18:15:33.067
> 
> 标签：c++, function-pointers

我正在尝试使用一个线程库，它具有这样定义的线程启动函数：

```
int vg_thread_create(VGThreadFunction func, 
  void *arg, 
  VGThreadDescriptor *tid,
  void *stack, 
  size_t stack_size,
  long priority,
  int flags ); 
```

而 VGThreadFunction 是下面的 typedef：

```
typedef void* (*VGThreadFunction) ( void* ) 
```

为了论证，我有一个这样的函数：

```
void doit() {
  cout << "Woohoo printing stuff in new thread\n";
} 
```

此函数的签名不是 void* func(void*) - 我是否被迫使用这样的函数签名？

如果我尝试：

```
VGThreadFunction testfunc = &doit; 
```

我明白了

错误 C2440：“正在初始化”：无法从“void (__cdecl *)(void)”转换为“VGThreadFunction”

如何使用 vg_thread_create？

编辑

我试过这个：

```
void* doit(void* donothingvar) {
  cout << "printing stuff in new thread\n";
  return donothingvar;
} 
```

然后在一个函数中：

```
VGThreadFunction testfunc = (VGThreadFunction)doit;

int ret = vg_thread_create(testfunc, 0, 0, 0, 0, 0, 0); 
```

然后我在调用 vg_thread_create 时遇到访问冲突。

如果我进入该函数，它在调用 _beginthreadex 时实际上会崩溃

```
Unhandled exception at 0x0040f5d3 in threadtest.exe: 0xC0000005: Access violation  writing location 0x00000000. 
```

有任何想法吗？

通过进入函数，我发现我必须传入一个有效的指针 - 传递零会导致 null 取消引用。对不起，有点具体。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-17T18:17:51.443

是的，函数签名必须匹配。只需在您的函数上放置一个虚拟参数即可。

# python - 从python中的对象列表中获取对象属性列表

> ID：12940690
> 
> 赞同：0
> 
> 时间：2012-10-17T18:15:35.453
> 
> 标签：python

我会给你我的具体例子，但这是一个一般的 python 问题。

我有一个 apscheduler 作业对象列表[Link](http://packages.python.org/APScheduler/modules/job.html)我试图找出从我的 apscheduler 作业列表中获取 apscheduler 作业属性“kwargs”列表的最有效方法。

我知道我可以遍历整个列表并制作一个新的 kwargs 列表，但我想知道在 python 中是否有更有效/更清洁的方法来执行此操作，因为我是新手。谢谢！

```
from apscheduler.scheduler import Scheduler

schedule = Scheduler()
jobs = schedule.get_jobs() #jobs is a list of apscheduler jobs
jobs_kwargs = ??? 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T20:51:52.017

在同事的帮助下想通了。这可以通过使用地图来完成：

```
from apscheduler.scheduler import Scheduler

schedule = Scheduler()
jobs = schedule.get_jobs() #jobs is a list of apscheduler jobs
jobs_kwargs = map(lambda k: k.kwargs, jobs) 
```

这应该更有效，因为它并行处理任务（我仍然需要查看它以获取更多信息）。不过感谢您的建议！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T18:18:53.383

嗯，你说得差不多了：

```
jobs = schedule.get_jobs()
jobs_kwargs = [j.kwargs for j in jobs] 
```

据我所知，真的没有比这更“干净”的方法了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T18:40:16.263

我同意约翰的观点。

也许是一个建议：

如果您的作业对象都是 Schedule 类类型，则动态附加到类属性（不是 self 而是 cls）即**kwargs**每个作业对象 kwargs 每当一个被实例化时，以便在任何时候，您都可以从该类属性中读取。通过即一个名为 ie schedule.get_gwargs(cls) 的类方法。

但我不确定这会带来比简单的列表理解更好的东西。

# tfs - TFS - 有没有办法查看哪些 TestCase 工作项不在任何测试计划中？

> ID：12940697
> 
> 赞同：3
> 
> 时间：2012-10-17T18:15:55.523
> 
> 标签：tfs, visual-studio-2012, microsoft-test-manager

我们希望能够查看哪些新的测试用例工作项尚未与测试计划/测试套件相关联。
我想如果我们可以让这个查询在 Visual Studio 的 TFS 中工作，那么我们可以将其保存下来，测试人员可以在测试管理器中加载该查询并查看哪些项目仍需要添加到计划中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T06:47:25.943

**相关链接数=0**
我认为它可以帮助你。

# php - 在php中强制从服务器下载

> ID：12940699
> 
> 赞同：-1
> 
> 时间：2012-10-17T18:15:57.247
> 
> 标签：php, download, readfile

> **可能重复：**
> [使用 php](https://stackoverflow.com/questions/998885/forcing-a-file-download-with-php)
> [强制下载文件强制下载不同的文件](https://stackoverflow.com/questions/12874992/force-download-of-different-files)

我试图让用户从我的网站下载图片。我看过很多关于它的文章，我试图使用php 文档中的[readfile](http://php.net/manual/en/function.readfile.php)。但我似乎无法让它工作。

这是我尝试设置以开始下载的按钮的代码：

```
 <!-- download image button  -->
    <form class="grid_12" style="text-align: center;" action="../includes/download.php" method="post">
        <input type="hidden" name="id" value="<?php echo $photo->id; ?>" />
        <input type="hidden" name="img" value="<?php echo $photo->filename; ?>" />
        <?php if(isset($_GET['cat'])){?>
            <input type="hidden" name="cat" value="<?php echo $_GET['cat']; ?>" />
        <?php } ?>  
        <div id="download"><input type="submit" name="submit" value="Download Photo" /></div>
    </form> 
```

这是我在 download.php 文件中设置的代码（redirect_to 只是一个调用 header(Location: var) 的函数，其中 var 是您传入的内容。

```
<?php
require_once('initialize.php');
?>
 <?php
header("Content-type: application/force-download; filename=".$_POST['img']);

// Force download of image file specified in URL query string and which
// is in the same directory as this script:
if(!empty($_POST['img']))
{
   $file = $_POST['img'];
   if (file_exists($file)) {
        header('Content-Description: File Transfer');
        header('Content-Type: application/octet-stream');
        header('Content-Disposition: attachment; filename='.basename($file));
        header('Content-Transfer-Encoding: binary');
        header('Expires: 0');
        header('Cache-Control: must-revalidate');
        header('Pragma: public');
        header('Content-Length: ' . filesize($file));
        ob_clean();
        flush();
        readfile($file);
        exit;
    }

   $addy = "../public/photo.php?id=".$_POST['id'];
   if(isset($_POST['cat'])){
        $addy .= "&cat=".$_POST['cat'];
   }
   redirect_to($addy);
}
header("HTTP/1.0 404 Not Found");
?> 
```

我在帖子中发送的隐藏变量主要用于重定向，以便在下载开始后将用户带回他们下载的页面。在我的本地主机上，我被重定向到单击下载按钮的页面。在我的服务器上，我只是被发送到一个注册为 download.php 的空白页面。我认为这可能与输出缓冲有关，因为我得到一个空白页。这通常意味着在我调用 header() 函数之前有某种输出。

如果有人能给我一些关于我在这里做错了什么的见解，我将不胜感激，感谢您的阅读。

-艾伦

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T18:38:56.230

感谢您的洞察力，我相信这是 hakre 和 GBD 指出的结合。我调用了标题两次，因为我已经设置了一个我看到的示例设置它的方式。然后我也将 php doc 中的示例用于 readfile ......

然后我必须修复图像文件的绝对路径，因为我只发送文件名。再次感谢您的快速帮助，我非常感谢。

**更新

这在我的本地主机上为我解决了所有问题，但在服务器上，它现在将我带到一个充满乱码的页面，而不是开始下载......我会调查这个问题并在找到解决方案时重新发布。

**使固定

首先，我必须进入服务器上的 php.ini 文件并更改 allow_url_fopen = On 以便服务器可以使用 readfile、fopen 等文件方法。然后我还必须在文件上添加输出缓冲，因为有很多标头调用。没有输出缓冲，第一个在整个调用建立之前被调用。

再次感谢所有帮助，它现在可以在我的本地主机和服务器上运行。

# sap-erp - MB1A 事务背后的表？

> ID：12940704
> 
> 赞同：0
> 
> 时间：2012-10-17T18:16:16.183
> 
> 标签：sap-erp

我想访问（查看）MB1A 交易背后的表，任何有更多经验的人都可以知道表的*确切名称*是什么？

提前谢谢了！

最好的问候，阿迪

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T18:59:03.663

我不能，但我可以告诉您如何自己找出答案：启动事务 ST05 并激活 SQL 跟踪。然后做任何你想检查的事情，再次关闭跟踪并花时间检查它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T23:44:36.717

查找此数据的另一种便捷方法是使用“新”事务 SAT。这是 SE30 的增强版本，可从 Netweaver 7.0、EhP2 获得

*   运行事务 SAT - 输入所需事务并按执行 ![交易SAT](../Images/1488885c06e2a9692b5f41629baa1923.png)
*   照常执行事务，完成后退出
*   单击“DB Tables”，您将看到在跟踪期间访问的所有表 ![在此处输入图像描述](../Images/b7f8fc2b5788512de3c7336e64c8dcd3.png)

# javascript - 单击时选择第一组 div

> ID：12940710
> 
> 赞同：0
> 
> 时间：2012-10-17T18:16:36.387
> 
> 标签：javascript, jquery, html, jquery-selectors

我有一个像这样的html结构：

```
<h3>Attributes (<a class="on_test" href="#">show/hide all</a>)</h3>
<div class="reference_tborder">
<ul class="reference_table">
    <li>
      <p class="attribute_title"><a href="#" onClick="$(this).parent().nextAll('.attribute_description:first').slideToggle('slow'); return false;">style</a></p>
      <div class="attribute_description" style="display:none;">test1</div>
    </li>
    <li>
      <p class="attribute_title"><a href="#" onClick="$(this).parent().nextAll('.attribute_description:first').slideToggle('slow'); return false;">type</a></p>
      <div class="attribute_description" style="display:none;">test1</div>
    </li>
</ul></div>

<h3>Attributes (<a class="on_test" href="#">show/hide all</a>)</h3>
<div class="reference_tborder">
<ul class="reference_table">
    <li>
      <p class="attribute_title"><a href="#" onClick="$(this).parent().nextAll('.attribute_description:first').slideToggle('slow'); return false;">style</a></p>
      <div class="attribute_description" style="display:none;">test2</div>
    </li>
    <li>
      <p class="attribute_title"><a href="#" onClick="$(this).parent().nextAll('.attribute_description:first').slideToggle('slow'); return false;">type</a></p>
      <div class="attribute_description" style="display:none;">test2</div>
    </li>
</ul></div> 
```

还有更多像这些

和 javascript：

```
<script type="text/javascript">
$(document).ready(function() {
    $('a.on_test').click(function(event) {
        if ($('.attribute_description:first').css("display") == 'block') {
            $("div.attribute_description").css("display", "none");
        }
        else {
            $("div.attribute_description").css("display", "block");
        }
        return false;
    });
});​
</script> 
```

现在，当我单击“全部显示/隐藏”时，该操作将应用于所有 div。我只想在单击的“显示/隐藏全部”下选择第一个。任何有助于解决此问题的方法将不胜感激

这是一个 JSFiddle，所以你可以看到问题[http://jsfiddle.net/5mLys/](http://jsfiddle.net/5mLys/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T18:21:57.590

看起来你需要这样做：

```
$('a.on_test').on('click', function (e) {
    var _nextSection  = $(this).closest('h3').next().find('.reference_table'),
        _descriptions = _nextSection.find('.attribute_description');

    if (_descriptions.first().is(':visible')) {
        _descriptions.hide();
    }
    else {
        _descriptions.show();
    }
    return false;
}); 
```

您想从抓取最近的部分开始，这样您就不会切换多个部分。

旁注：您可能应该重新考虑您的一般 HTML 结构，看起来您在这里有 div-itis。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T18:28:37.780

您一直在搜索整个页面，请将您的搜索包含在`.reference_tborder`以下链接中。此外，您应该使用`$.toggle`, 而不是自己做。

[http://sfiddle.net/5mLys/3/](http://sfiddle.net/5mLys/3/)

```
$('a.on_test').click(function(event) {
    $('.attribute_description', $(this).parent().next()).toggle();
    return false;
}); 
```

**更新**

由于您想要更多的显示/隐藏按钮，我认为更好的体验是有一个复选框，指示您要将其设置为什么状态，而不是依赖第一项。以下应该这样做

**HTML**

```
<h3>Attributes (<label><input type='checkbox' class="show-hide"> show/hide all</label> )</h3> 
```

**JS**

```
$('input.show-hide').change(function() {
    var toShowHide =  $('.attribute_description', $(this).closest('h3').next());
    if (this.checked) {
        toShowHide.show(); 
    } else {
        toShowHide.hide();
    }
}); 
```

[http://jsfiddle.net/5mLys/6/](http://jsfiddle.net/5mLys/6/)

![样本](../Images/f6e01f04f206abf88cf71be8acef228a.png)

# c++ - `throw(...)` 语法从何而来？

> ID：12940712
> 
> 赞同：9
> 
> 时间：2012-10-17T18:16:39.923
> 
> 标签：c++, history

在我们的应用程序中，我们有一些（成员，但这无关紧要）函数声明为

```
void SomeFunction(Type argument) throw (...); 
```

使用编译得很好的 Microsoft Visual C++。但现在我正在尝试用 GCC 编译它，它拒绝`...`as 语法错误。我记得很久以前就听说过这个结构，但是看看 C++03 和 C++11 的规范似乎都不允许`...`，我不记得我从哪里得到它。有人知道这个（显然毫无意义）构造的起源吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-17T18:27:18.060

来自[http://msdn.microsoft.com/en-us/library/wfa0edys(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/wfa0edys(v=vs.80).aspx)上的文章：

> “Visual C++ 在异常规范的实现上背离了 ANSI 标准。”

# php - 您如何使用 pkcs12 (p12) 证书发送到 Transunion API？

> ID：12940713
> 
> 赞同：12
> 
> 时间：2012-10-17T18:16:49.217
> 
> 标签：php, api, curl, certificate

我无法使用 cURL 通过 php 连接到 TransUnion 的测试 API。请让我知道是否有人已经这样做了。我已经准备好要发送给他们的 XML 文件，我只是不知道问题出在哪里，因为我从他们那里收到了一个包含证书和密钥的 .p12 文件，但它仍然没有让我连接。我尝试了以下方法：

```
 $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_HEADER, 1);
    curl_setopt($ch, CURLOPT_VERBOSE, 1);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE);
    curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 0);
    curl_setopt($ch, CURLOPT_FAILONERROR, 1);
    curl_setopt($ch, CURLOPT_SSLCERT, getcwd().'/certs/cert.pem');
    curl_setopt($ch, CURLOPT_SSLCERTPASSWD, 'test_pass');
    curl_setopt($ch, CURLOPT_SSLKEYTYPE, 'PEM');
    curl_setopt($ch, CURLOPT_SSLKEY, getcwd().'/certs/key.pem');
    curl_setopt($ch, CURLOPT_SSLKEYPASSWD, 'test_pass'); 
```

然后我尝试通过我的mac上的终端连接：

```
curl -cert /Users/temp_user/cert.pem   -key /Users/temp_user/key.pem https://netaccess-test.transunion.com 
```

有人可以让我知道我做错了什么。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2020-01-19T23:46:14.497

我知道这是一篇较旧的帖子，但由于我在尝试找出与 TransUnion 的连接问题时遇到了它，我想我会发布我所做的以使其正常工作，以防其他人仍然需要帮助。

我与 TransUnion 支持团队合作，将我所拥有的和他们所拥有的信息结合起来，我能够得到一个可行的解决方案。

我发现的最大问题是到处都是关于如何转换证书的说明。

使用以下命令转换证书，以获得用于连接的所需部分。是的，你需要 3 个，大多数答案一直说只得到 2 个，但你需要全部 3 个：

将证书转换为客户端的三种不同证书，私钥和证书颁发机构证书。

openssl pkcs12 -in client_systemID.p12 -out ca.pem -cacerts -nokeys //将CA证书从.p12文件输出到ca.pem

openssl pkcs12 -in client_systemID.p12 -out client.pem -clcerts -nokeys //将客户端证书从.p12文件输出到client.pem

openssl pkcs12 -in client_systemID.p12 -out key.pem -nocerts -nodes //将私钥从.p12输出到key.pem

然后你可以开始设置你的代码：

```
$keyFile = "key.pem";
$caFile = "ca.pem";
$certFile = "client.pem";
$certPass = $_ENV['TUNASSLPass']; //I am storing the passphrase in an Env variable
$URL = "https://netaccess-test.transunion.com";
$data = "<tuna-request-data>"; //need to set this to append to the URL
$xml = "<?xml version='1.0' encoding='UTF-8'?><creditBureau xmlns='http://www.transunion.com/namespace' xsi:schemaLocation='http://www.transunion.com/namespace creditBureau.xsd' xmlns:xsi='http://www.w3.org/3001/XMLSchema-instance'>{The rest of your XML}</creditBureau>";

// Initialise cURL
$ch = curl_init($actualUrl);

// The -d option is equivalent to CURLOPT_POSTFIELDS. But...
// PHP's libcurl interface does not implement the -G flag - instead you would
// append $data to $url like this:
$actualUrl = $URL.'?'.$data;
curl_setopt($ch, CURLOPT_URL, $actualUrl);

// The -v flag only makes sense at the command line, but it can be enabled
// with CURLOPT_VERBOSE - in this case the information will be written to
// STDERR, or the file specified by CURLOPT_STDERR. I will ignore this for
// now, but if you would like a demonstration let me know.

// The --key option - If your key file has a password, you will need to set
// this with CURLOPT_SSLKEYPASSWD
curl_setopt($ch, CURLOPT_SSLKEY, $keyFile);

// The --cacert option
curl_setopt($ch, CURLOPT_CAINFO, $caFile);

// The --cert option
curl_setopt($ch, CURLOPT_SSLCERT, $certFile);
curl_setopt($ch, CURLOPT_SSLCERTPASSWD, $certPass);
curl_setopt($ch, CURLOPT_POST, true);
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 1);
curl_setopt($ch, CURLOPT_HTTPHEADER, array('Content-Type: application/x-www-form-urlencoded'));
curl_setopt($ch, CURLOPT_POSTFIELDS, "xml=" . $xml);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
try
{
    $result = curl_exec($ch);
}
catch (Exception $e) 
{
    echo 'There was an issue querying TransUnion.  Here is the returned exception info: ',  $e->getMessage(), "\n";
}

if (curl_errno($ch) > 0)
{
    $result = array('errocurl' => curl_errno($ch), 'msgcurl' => curl_error($ch));
    echo "There was an error calling Trans Union.  Here is the error info: <br>" . curl_error($ch);
}
curl_close($ch); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-25T16:12:03.107

确保从 p12 文件中正确提取证书，如下所示：

提取 CA 证书：

```
openssl pkcs12 -in NAME_OF_P12_FILE.p12 -cacerts -nokeys -out NAME_OF_PEM_FILE_TO_CREATE.pem 
```

提取个人证书：

```
openssl pkcs12 -in NAME_OF_P12_FILE.p12 -clcerts -nokeys -out NAME_OF_PEM_FILE_TO_CREATE.pem 
```

要提取私钥：

使用密码：`openssl pkcs12 -in NAME_OF_P12_FILE.p12 -clcerts -nocerts -out NAME_OF_PEM_FILE_TO_CREATE.pem`

没有密码：`openssl pkcs12 -in NAME_OF_P12_FILE.p12 -clcerts -nocerts -nodes -out NAME_OF_PEM_FILE_TO_CREATE.pem`

# java - 禁用 JSONObject 自动转义字符串

> ID：12940716
> 
> 赞同：2
> 
> 时间：2012-10-17T18:16:58.277
> 
> 标签：java, android, json

我`org.json.JSONObject`在一个Android应用程序中使用，显然该`toString()`方法自动转义了各种不需要转义的字符（即字符串“auto/vehicle”被转义为“auto\/vehicle”），这导致了各种各样的问题上游的。有没有办法覆盖这种行为？

# python - 在while循环中处理异常 - Python

> ID：12940717
> 
> 赞同：1
> 
> 时间：2012-10-17T18:17:03.370
> 
> 标签：python, exception, exception-handling, try-catch

这是我的代码（@cdhowie 的几乎完整版 :)）：

```
def getResult(method, argument=None):
  result = None

  while True:
    print('### loop')
    try:
      print ('### try hard...')
      if argument:
        result = method(argument)
      else:
        result = method()
      break
    except Exception as e:
      print('### GithubException')
      if 403 == e.status:
        print('Warning: ' + str(e.data))
        print('I will try again after 10 minutes...')
      else:
        raise e

  return result

def getUsernames(locations, gh):
  usernames = set()

  for location in locations:
    print location
    result = getResult(gh.legacy_search_users, location)
    for user in result:
      usernames.add(user.login)
      print user.login,

  return usernames

# "main.py"
gh = Github()
locations = ['Washington', 'Berlin']
# "main.py", line 12 is bellow
usernames = getUsernames(locations, gh) 
```

问题是，引发了异常，但我无法处理它。这是一个输出：

```
### loop
### try hard...
Traceback (most recent call last):
  File "main.py", line 12, in <module>
    usernames = getUsernames(locations, gh)
  File "/home/ciembor/projekty/github-rank/functions.py", line 39, in getUsernames
    for user in result:
  File "/usr/lib/python2.7/site-packages/PyGithub-1.8.0-py2.7.egg/github/PaginatedList.py", line 33, in __iter__
    newElements = self.__grow()
  File "/usr/lib/python2.7/site-packages/PyGithub-1.8.0-py2.7.egg/github/PaginatedList.py", line 45, in __grow
    newElements = self._fetchNextPage()
  File "/usr/lib/python2.7/site-packages/PyGithub-1.8.0-py2.7.egg/github/Legacy.py", line 37, in _fetchNextPage
    return self.get_page(page)
  File "/usr/lib/python2.7/site-packages/PyGithub-1.8.0-py2.7.egg/github/Legacy.py", line 48, in get_page
    None
  File "/usr/lib/python2.7/site-packages/PyGithub-1.8.0-py2.7.egg/github/Requester.py", line 69, in requestAndCheck
    raise GithubException.GithubException(status, output)
github.GithubException.GithubException: 403 {u'message': u'API Rate Limit Exceeded for 11.11.11.11'} 
```

为什么不打印`### handling exception`？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-17T18:56:08.657

仔细查看异常中的堆栈跟踪：

```
Traceback (most recent call last):
  File "main.py", line 12, in <module>
    usernames = getUsernames(locations, gh)
  File "/home/ciembor/projekty/github-rank/functions.py", line 39, in getUsernames
    for user in result:
  File "/usr/lib/python2.7/site-packages/PyGithub-1.8.0-py2.7.egg/github/PaginatedList.py", line 33, in __iter__
    newElements = self.__grow()
  ... 
```

`for user in result:` *执行完成后* ，该行调用的代码会引发异常`getResult`。这意味着您正在使用的 API 正在使用延迟评估，因此实际的 API 请求不会完全按照您的预期发生。

为了捕获和处理此异常，您需要`getUsernames`使用`try`/`except`处理程序将代码包装在函数内。

# mongodb - 关于 Mongo db Schema 的困惑。如何让它变得更好？

> ID：12940719
> 
> 赞同：0
> 
> 时间：2012-10-17T18:17:08.650
> 
> 标签：mongodb, mongoose

为此，我正在使用带有 node.js 的猫鼬。

我当前的架构是这样的：

```
var linkSchema = new Schema({

    text: String,
    tags: array,
    body: String,
    user: String
}) 
```

我的用例是这样的：有一个用户列表，每个用户都有一个与之关联的链接列表。用户和链接当然是不同的模式。因此，如何使用 mongo-db 完成这种一对一的关系。

我应该制作一个用户模式并将 linkSchema 嵌入其中吗？还是反过来？

对此的另一个疑问。标签总是一个字符串数组，我以后可以用它来浏览链接。它应该是数组数据类型还是有更好的方法来表示它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T23:40:08.487

如果是 1:1，则将一个文档嵌套在另一个文档中。哪种方式取决于查询，但如果需要，您可以轻松地同时执行这两种操作。

对于标签，您可以索引一个数组字段并将其用于搜索/过滤文档，并且根据您提供的信息，恕我直言。

如果您有一组固定的标签，则可能将它们表示为具有命名字段的嵌套对象，具体取决于查询。不要忘记您不仅可以在 Mongo 中创建嵌套文档，还可以搜索子字段，甚至可以将整个嵌套文档用作可搜索/可索引的字段。例如，您可以拥有这样的用户名；

```
email: "joe@somewhere.com" 
```

作为一个字符串，你也可以这样做；

```
 email: {
     user: "joe",
     domain: "somewhere.com"
 } 
```

您可以在这两种情况下为电子邮件编制索引并使用其中任何一种进行匹配。在后一种情况下，尽管您也可以仅搜索域或用户，而无需使用 RegEx 样式查询。您还可以存储这两种变体，因此 Mongo 中有很多灵活的选项。

回到标签，我认为考虑到您所描述的内容，您的字符串数组是一个很好的模型，但是如果您进行更复杂的批量聚合，那么为每个标签存储具有相同文档内容的文档就不会太疯狂了，因为这基本上是您在聚合期间对每个查询都必须做的事情。

# cassandra - Cassandra/Hector：在复合主键上添加计数器

> ID：12940721
> 
> 赞同：0
> 
> 时间：2012-10-17T18:17:15.867
> 
> 标签：cassandra, hector, cql

我在 CQL3 控制台中创建了一个表（没有一个主键成分是唯一的，它们将是唯一的）：

```
CREATE TABLE aggregate_logs (
    bpid varchar,
    jid int,
    month int,
    year int,
    value counter,
PRIMARY KEY (bpid, jid, month, year)); 
```

然后能够通过使用更新和查询：

```
UPDATE aggregate_logs SET value = value + 1 WHERE bpid='1' and jid=1 and month=1 and year=2000; 
```

这按预期工作。我想在 Hector（在 Scala 中）做同样的更新：

```
 val aggregateMutator:Mutator[Composite] = HFactory.createMutator(keyspace, compositeSerializer)

  val compKey = new Composite()
  compKey.addComponent(bpid, stringSerializer)
  compKey.addComponent(new Integer(jid), intSerializer)
  compKey.addComponent(new Integer(month), intSerializer)
  compKey.addComponent(new Integer(year), intSerializer)

  aggregateMutator.incrementCounter(compKey, LogsAggregateFamily, "value", 1) 
```

但我收到一条消息错误：

```
...HInvalidRequestException: InvalidRequestException(why:String didn't validate.) 
```

直接从赫克托运行查询：

```
val query = new me.prettyprint.cassandra.model.CqlQuery(keyspace, compositeSerializer, stringSerializer, new IntegerSerializer())
query.setQuery("UPDATE aggregate_logs SET value = value + 1 WHERE 'bpid'=1 and jid=1 and month=1 and year=2000")
query.execute() 
```

这给了我错误：

```
 InvalidRequestException(why:line 1:59 mismatched input 'and' expecting EOF) 
```

我似乎没有任何其他在复合主键下使用计数器的示例。甚至可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T06:09:59.700

直接使用 cql 绝对是可能的（至少通过 CQLSH 和 C++）：

> cqlsh:goh_master> 描述表 daily_caps;
> CREATE TABLE daily_caps (caps_type ascii, id ascii, value counter, PRIMARY KEY (caps_type, id) ) WITH COMPACT STORAGE AND comment='' AND
> caching='KEYS_ONLY' AND read_repair_chance=0.100000 AND
> gc_grace_seconds=864000 AND replicate_on_write='true' AND
> compaction_strategy_class='SizeTieredCompactionStrategy' AND
> compression_parameters:sstable_compression='SnappyCompressor';
> 
> cqlsh:goh_master> update daily_caps set value=value +1 where caps_type='xp' and id ='myid';
> 
> cqlsh:goh_master> select * from daily_caps;
> 
> 大写字母 | 编号 | 价值
> 
> ------------+------+------
> 
> 经验 | 我的 | 1

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-18T15:19:41.493

CQL3 和 thrift API 不兼容。因此，使用 CQL3 创建列族并使用 Hector 或其他基于节俭的客户端访问它是行不通的。有关更多信息，请参阅：

[https://issues.apache.org/jira/browse/CASSANDRA-4377](https://issues.apache.org/jira/browse/CASSANDRA-4377)

# backbone.js - 使用主干设置下拉选择值

> ID：12940723
> 
> 赞同：5
> 
> 时间：2012-10-17T18:17:17.747
> 
> 标签：backbone.js

我想从我的 js 设置我的下拉菜单。基本上，我希望能够从 js 设置更新的下拉值。

我的.html

```
 <div class="dropDownList">
                    <select id="ddpFilter" >
                        <option value="1">Show 1</option>
                        <option value="2">Show 2</option>
                        <option value="3">Show 3</option>
                    </select>
                </div> 
```

我的.js

```
 events : {
     'change #ddpFilter' : 'Filter'
  },

  Filter : function(e){
      // Set Selected Value of the dropdown 
  }
}); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-17T18:27:59.143

您应该以小写字母（[根据 Mr Crockford](http://javascript.crockford.com/code.html)）开始您的函数名称，并使用更具描述性的函数名称。

为了设置选择列表的值，请使用`option[value='x']`语法。假设您想设置第二个选项：

```
events : {
  'change #ddpFilter' : 'filterDdpSelect'
},

filterDdpSelect: function(e){
  var selectValue = 2;
  $("#ddpFilter option[value='" + selectValue + "']").attr("selected", "selected");
} 
```

# php - PHP 脚本内存优化——需要减少运行脚本所需的内存量

> ID：12940725
> 
> 赞同：-3
> 
> 时间：2012-10-17T18:17:20.413
> 
> 标签：php, optimization, memory

herp derp 和其他东西.. 看起来我根本不应该问这个问题.. 哦，好吧

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T18:29:28.357

看看像 XDebug 这样的分析工具。 [http://xdebug.org/](http://xdebug.org/) 它应该告诉你什么正在使用内存。

# apache-flex - 如何创建和管理嵌套的 TabbedViewNavigator？

> ID：12940728
> 
> 赞同：1
> 
> 时间：2012-10-17T18:17:31.407
> 
> 标签：apache-flex, mobile, nested, panel, tabbed

我正在尝试实现嵌套的 TabbedViewNavigator（在视图内）。我按照这篇文章中描述的方法 3 做到了这一点：

[Flex - 如何制作选项卡式面板](https://stackoverflow.com/questions/7603957/flex-how-to-make-a-tabbed-panel)

代码在这里：

```
<s:View xmlns:fx="http://ns.adobe.com/mxml/2009" 
    xmlns:s="library://ns.adobe.com/flex/spark" title="HomeView">

<s:TabbedViewNavigator width="100%" height="100%">
    <s:ViewNavigator label="1st Tab" width="100%" height="100%" 
                     firstView="views.FirstTabView"/>
    <s:ViewNavigator label="2nd Tab" width="100%" height="100%" 
                     firstView="views.SecondTabView"/>
    <s:ViewNavigator label="3rd Tab" width="100%" height="100%" 
                     firstView="views.ThirdTabView"/>
</s:TabbedViewNavigator> 
```

但是，如果我在其中一个子视图中调用“navigator.pushView(someView)” - 比如说 FirstTabView - 新视图将被推送到嵌套的 TabbedViewNavigator 而不是父视图导航器中。那不是我想要的。我想完全改变应用程序状态并显示一个新视图。我怎样才能做到这一点？我是否应该（在主视图中）监听嵌套 TabbedViewNavigator 中的更改，然后从那里推送新视图？还是我应该以其他方式做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T16:13:18.097

我通过使用自定义事件解决了它（它是自定义的，因为我需要从中获取数据）。

向 TabbedViewNavigator 添加了侦听器和处理程序。该事件是从活动的 ViewNavigator 视图内部调度的。该事件具有 bubbles=true 以便它上升到事件链的顶部。然后只需在事件处理程序中推送新视图。

**主视图：**

```
 <s:View xmlns:fx="http://ns.adobe.com/mxml/2009" 
       xmlns:s="library://ns.adobe.com/flex/spark" title="HomeView">

         (...)

         private function setup(){
              tabbed_panel.addEventListener(CustomEvent.BUTTON_PRESSED, eventHandler); 
         }

         private function eventHandler(ev:CustomEvent):void{
             navigator.pushView(MyNewView,ev.event_data);
         }

         (...)

         <s:TabbedViewNavigator id="tabbed_panel" width="100%" height="100%">
             <s:ViewNavigator label="1st Tab" width="100%" height="100%" 
                 firstView="views.FirstTabView"/>
             <s:ViewNavigator label="2nd Tab" width="100%" height="100%" 
                 firstView="views.SecondTabView"/>
         </s:TabbedViewNavigator>

        (...)
    </s:View> 
```

**第一个选项卡视图：**

```
 <View...>

         (...)

         private function buttonClickedHandler(event:Event):void{
             dispatchEvent(new CustomEvent(event_data,"BUTTON_PRESSED",true));
         }

         (...)

    </View> 
```

我不知道这是否是解决问题的正确方法，但它确实有效。

# jquery - jQuery链接中间步骤

> ID：12940730
> 
> 赞同：0
> 
> 时间：2012-10-17T18:17:41.757
> 
> 标签：jquery

在 jQuery 中是否有可能有一个链接，当点击时，会发生中间事件？例如，在转到链接的主要目标之前播放一个非常短的视频。我知道我很可能必须在第一个事件的链接上使用 .preventDefault() ，但是在中间步骤之后我将如何发生默认操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T18:19:36.593

您需要像这样绑定到窗口的 beforeunload 属性：

```
 $(window).bind("beforeunload", function () {
            <your code here>
        }); 
```

编辑：请务必在您的代码中捕获它是否来自该链接。

# oauth-2.0 - dotnetopenauth - 如何在刷新令牌中添加额外数据？

> ID：12940731
> 
> 赞同：1
> 
> 时间：2012-10-17T18:17:42.737
> 
> 标签：oauth-2.0, dotnetopenauth

我目前正在处理一个 iPad 应用程序需要访问现有 Web 应用程序的项目。iPad 应用程序是内部开发的，因此是值得信赖的应用程序。然而，Web 应用程序提供的数据是敏感的，因此我们不想将客户端凭据存储在 iPad 上。我们还希望能够在不影响常规用户访问的情况下撤销 iPad 访问。

鉴于上述情况，OAuth2 资源所有者密码凭证授权/流程非常适合我们的要求，自从 DotNetOpenAuth 已建立库以来，我们已经使用它实现了这一要求。

但是，我们现在需要将一些元数据添加到资源服务器的访问和刷新令牌中。授权服务器通过 AuthorizationServerAccessToken.ExtraData 属性在我们的 IAuthorizationServerHost.CreateAccessToken 方法的实现中添加元数据：

```
public AccessTokenResult CreateAccessToken(IAccessTokenRequest accessTokenRequestMessage)
{
    var accessToken = new AuthorizationServerAccessToken();

    // Add some extra data to access token
    accessToken.ExtraData.Add("server_parameter1", this.ServerValue1);
    accessToken.ExtraData.Add("server_parameter2", this.ServerValue2);

    // Set ResourceServerEncryptionKey properties etc

    return new AccessTokenResult(accessToken);
} 
```

这正是我们想要的访问令牌，但是刷新令牌中不包含相同的“ExtraData”，这会在访问令牌过期并需要刷新时导致问题，因为我们实际上丢失了额外的数据（因为旧的访问令牌被丢弃）。

任何人都可以建议是否可以在当前版本的 DotNetOpenAuth 中以与访问令牌类似的方式填充刷新令牌“ExtraData”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-18T15:31:26.080

不，我认为目前没有办法将额外数据嵌入到刷新令牌中。让我们谈谈为什么会这样。

首先，无论您是否开发，都没有可信赖的 iPad 应用程序。问题是您分发的应用程序（甚至在内部）无法保密。任何client_secret、证书等都可以破解。因此，您分发的应用程序无法对服务器进行身份验证。如果服务器无法验证客户端，则服务器无法信任客户端。

现在让我们再看看您的场景（如果您有更多反馈，最好继续在 dotnetopenid@googlegroups.com 上讨论）。客户端拥有希望最终到达资源服务器的数据。您目前正在尝试首先通过授权服务器将该数据传递，然后通过访问令牌传递给资源服务器。这是为什么？为什么不让客户端直接将数据连同访问令牌一起发送到资源服务器？如果答案是资源服务器不应该信任客户端，那么由于上一段中给出的原因，通过访问令牌发送它是一种错误的安全感。如果客户端可以向资源服务器提供虚假信息，它也可以向授权服务器提供虚假数据。

访问令牌中额外数据的一种有效用途是授权服务器自己知道的数据，而不是来自客户端的数据。在这种情况下，它可以在每次生成访问令牌时查找该数据，因此不必将其存储在刷新令牌中。

# jquery - 使用 jquery 设置布尔属性

> ID：12940733
> 
> 赞同：14
> 
> 时间：2012-10-17T18:17:55.093
> 
> 标签：jquery

我了解 jquery 将允许您使用 .attr() 方法修改属性。基本上有两种方法：

```
$('#element').attr('attribute', 'value') // sets the attribute
var attribute = $('#element').attr('attribute') // gets the attribute 
```

我的问题是，如何设置布尔属性，例如复选框上的“已选中”或选择标签上的“多个”？

我尝试执行以下操作但没有成功：

```
$('#element').attr('attribute', true)
$('#element').attr('attribute', '') 
```

所有这些都添加了属性，但通常是这样的`<tag attribute="attribute">`。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-10-17T18:19:11.140

尝试使用`.prop`来处理`boolean`支持的属性，例如`selected/disabled/checked`等

```
$('#element').prop('attribute', true); 
```

来自 jQuery 文档，（示例）

`elem.checked`返回`true`（布尔值）将随复选框状态而变化

`$(elem).prop("checked")`返回`true`（布尔值）将随复选框状态而变化

`elem.getAttribute("checked")`返回`"checked"`（字符串）复选框的初始状态；不变

`$(elem).attr("checked")(1.6)`返回`"checked"`（字符串）复选框的初始状态；不变

`$(elem).attr("checked")(1.6.1+)`返回`"checked"`（字符串）将随复选框状态而变化

`$(elem).attr("checked")(pre-1.6)`返回`true`（布尔值）已更改为复选框状态

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T18:20:17.560

HTML 属性始终是字符串值。如果您确实想设置字符串以外的内容，请考虑使用 jQuery.data()

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-12-03T12:19:27.987

我在 jQuery 中使用这个方法

```
jQuery('option').attr("selected", ""); 
```

或在 JavaScript 中：

```
document.querySelector("option").setAttribute("selected", ""); 
```

只是您需要传递一个空字符串来设置布尔属性。

# ruby-on-rails - Heroku 上的 Ruby 应用程序 - 为什么我的 caches_action 不刷新？

> ID：12940740
> 
> 赞同：1
> 
> 时间：2012-10-17T18:18:09.657
> 
> 标签：ruby-on-rails, ruby, heroku

我有一个在 Heroku 上运行的 RoR 应用程序。在我的控制器中，我运行了简单的 caches_action 语句，例如：

```
caches_action :index, :expires_in => 5.minutes

def index 
    @articles = Article.main.paginate(:page => params[:page], :per_page => 10)
    ....
end 
```

在文章模型中，项目是根据其发布日期使用范围声明检索的，如下所示：

```
scope :before, lambda{|timenow| {:conditions => ["time <= ?", timenow]}}
scope :published, where(:published => true).order("time DESC")
scope :main, before(Time.now).published 
```

即使我将 caches_action 设置为 5 分钟，我仍然必须进入并手动清除缓存，以便今天的文章显示在列表的顶部，在它们应该上线几个小时后。Heroku 或 Rails 上是否有全局缓存设置我在某处丢失？

**更多信息：**

今天，当一篇新文章没有出现时，我尝试进入控制台并输入：

```
Rails.cache.clear 
```

这没有效果。然后我尝试使用与索引控制器相同的 ActiveRecord 请求：

```
Article.main 
```

...它返回了正确的文章，包括没有出现在网站上的文章。

只有重新启动服务器才能完全重置缓存并显示文章。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T19:14:00.567

我刚刚在 heroku 上创建了一个使用动作缓存的 Rails 项目。它适当地将请求缓存 15 秒，然后刷新缓存。

有没有可能你没有使用 dalli gem？

heroku 插件：

```
heroku addons:add memcache:5mb 
```

编码：

配置/应用程序.rb

```
config.cache_store = :dalli_store 
```

应用程序/控制器/home_controller.rb

```
class HomeController < ApplicationController

  caches_action :index, :expires_in => 15.seconds
  def index
    @timestamp = Time.now
  end
end 
```

应用程序/views/home/index.html.erb

```
<h1>hi!</h1>
I was generated at <%= @timestamp %>. 
```

# java - 码头中断连接

> ID：12940741
> 
> 赞同：1
> 
> 时间：2012-10-17T18:18:15.393
> 
> 标签：java, stream, jetty, interrupt

我有一个应用程序返回一个返回流的长请求（一个巨大的 json） 该应用程序是用 Java 编写的，我使用 Jetty 作为服务器。

问题是有时在获取数据后，它会停止。我做了一些测试，有时我得到了 10%、15%、40% .. 没关系.. Jetty 有时会中断连接。我已经在没有其他请求的情况下仅隔离了一台机器，并且以同样的方式发生。

我不知道如何调试，因为我没有看到任何错误。它只会打断。

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T20:13:14.973

什么版本的码头？

这可能是连接速度慢吗？
如果是这样，您可能会遇到空闲超时。

它可以像这样发生......

*   服务器有大量数据要发送，它一直发送到客户端的 TCP 背压告诉它“哇！”。
*   所以服务器会等到 TCP 层说可以再次开始发送。
*   客户端很慢。
*   此等待时间长于为该连接器配置的空闲超时。
*   服务器关闭连接。

# algorithm - 设计一个散列函数以从不同的密码生成相同的散列

> ID：12940742
> 
> 赞同：0
> 
> 时间：2012-10-17T18:18:14.683
> 
> 标签：algorithm, hash

问题是这样的：假设您的算法将给定的字符串分成三个字符块并对它们进行异或。然后它通过现有的 MD5 哈希算法将结果传递给它。例如，该算法将为“FOO”和“FOOFOOFOO”提供相同的哈希值。

在他的示例中，我无法理解对块进行异或运算如何创建相同的哈希值。谁能解释这是如何工作的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T18:32:36.587

当你将一个值与自身进行异或时，你得到 0，如果你对某物进行异或 0，你会得到相同的东西。我们得到`"FOO" XOR "FOO" = "\0\0\0"`和`"\0\0\0" XOR "FOO" = "FOO"`。我把剩下的留给你。:-)

# php - 使用 html 选择框 jquery 和 php 异步检索行

> ID：12940751
> 
> 赞同：0
> 
> 时间：2012-10-17T18:18:44.537
> 
> 标签：php, jquery, ajax, drop-down-menu

所以我目前正在处理按州组织的商店列表。而不是只将它们全部列在页面上，我想使用一个选择框，您显然选择了一个状态，然后处于该状态的商店异步显示而无需点击提交按钮......我觉得我知道它背后的理论，我只是在寻找一个很好的例子/教程来工作

谢谢你的帮助

skv

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T18:33:58.090

我会为您的商店创建您选择的状态框和选择容器；

```
<select id="state">
    <option value="">Select State</option>
    <option value="AL">Alabama</option>
    ...
</select>
<select id="stores"></select> 
```

然后在jquery中设置一个change事件来监听你的状态选择框来改变

```
$('#state').change(function(){
    if($(this).val()==''){
        $('#stores').html('<option value=""></option>');
        return;
    }
    $.ajax({
        type:"POST",
        url:"PATH_TO_PHP",
        data:"state="+$(this).val(),
        success:function(x){
            $('#stores').html(x);
        }
    });
}); 
```

然后在您的 php 端检索状态，找到商店并返回选项

```
$state = $_POST['state'];

// $stores = SQL QUERY TO GET STORES

echo '<option value="">Choose a Store</option>';
foreach($stores as $s){
    echo '<option value="'.$s.'">'.$s.'</option>';
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T18:27:46.763

您可以尝试搜索 ajax php 下拉教程，作为快速指导，您需要做的就是使用选定状态向您的服务器运行 ajax 请求，并在下一个下拉列表中填写商店名称，我将粘贴示例代码在这里，但您仍然需要根据您的需要对其进行修改。

HTML 结构

```
<select name="state" id="state">
<option value="State1"> State 1 </option>
<option value="State2"> State 2 </option>
<option value="State3"> State 3 </option>
</select>

<div id="store_dropdown">
</div> 
```

jQuery Ajax 请求

```
 <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script type="text/javascript">
    $(function(){
        function getStores(){
            data = 'state=' + $('#state').val();
            $.post('getStores.php',data,function(response){
                $('#store_dropdown').val(response);
            })
        }

        $('#state').keyup(getStores);
        $('#state').keydown(getStores);
        $('#state').mouseup(getStores);
        $('#state').mousedown(getStores);
    })
</script> 
```

php代码

```
 $state = $_POST['state'];
// here goes your sql query to the database

// run a while loop with the fetched data

$output = '<select name="store_name">';
while($row = mysql_fetch_array($sql))
{
    $output .= '<option value="'.$row['store_name'].'">'.$row['state_name'].'</option>';
}
$output .= '</select>';
echo $output; 
```

# c++ - 为什么 C++ 不自动使用 operator== 而不是 operator!=

> ID：12940755
> 
> 赞同：7
> 
> 时间：2012-10-17T18:18:57.637
> 
> 标签：c++

我知道 C++ 不能`operator==`自动为一个类定义，但为什么它不能`!(a == b)`用于`a != b`什么时候`operator!=`不可用，但它是可用`operator==`的？

我知道，`std::rel_ops`虽然我在今天之前没有听说过。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-17T18:30:46.510

因为`operator==`并不一定意味着相反`operator!=`。

我想不出任何`operator==`不意味着的实例`!operator!=`，但它们是单独的运算符。关于 C++ 最自由，有时也是最令人沮丧的事情之一是 C++ 对如何编写代码应用了一组最小的限制。如果您有一个`operator==`与 不相反的实例`operator!=`，那么您应该能够在 C++ 中表达它。而且，事实上，你可以。

在 C++ 中，你把好与坏放在一起。您可能会认为这是在“坏”的集合中。

请记住，在绝大多数情况下，正确`operator!=`实施`operator==`.

```
bool Gizmo::operator!=(const Gizmo& rhs) const
{
  return !operator==(rhs);
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-17T18:28:58.353

C++ 作为一种语言不提供您没有明确要求的功能。我知道这种理念在默认构造函数之类的情况下有些破绽，但这是 Stroustrup 很早就做出的设计决定——*你不用为不用的东西买单*。所以编译器不会自动生成你没有要求的东西。

[ACCU 网站上](http://accu.org/index.php/journals/1356)提到了1993 年初 Bjarne 的电子邮件链，其中提到了这一点。如果我没记错的话，它也在 D&E 中；我没有方便参考的副本。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-17T19:14:47.680

语言不允许做你想做的事。`operator==`并且`operator!=`是两个不同的运算符。我想不出一个例子`!(x==y)`会`x!=y`产生不同的结果，但考虑`operator<=`vs `operator>`。为什么你需要这两个？可以写成`x<=y`，`!(x>y)`对吧？错误的。

```
#include<iostream>

int main () {
   double y = 0.0;
   double x = y/y;

   std::cout << " (x <= y) -> " << (x <= y) << "\n";
   std::cout << "!(x >  y) -> " << !(x > y) << "\n";
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-17T19:40:32.740

C++ 的第一个版本（更正后的 C++03）引入了默认构造函数、复制构造函数、复制赋值运算符和析构函数的自动定义，以便能够在 C++ 中编译 C。

事实证明，尽管它可能不是最佳选择，但许多为析构函数提供自定义定义的人忘记定义复制构造函数和赋值运算符，结果一团糟。

隐式方法，如隐藏的执行路径，似乎让开发人员感到困惑。我想我们都被咬了。

* * *

然而，C++11 有一个非常聪明的按需默认方法机制：

```
class Test { Test() = default; }; // a rather useless class... 
```

所以，吸取 C++03 自动生成构造函数的经验，我不赞成引入这种自动生成，但肯定会支持：

```
bool operator!=(Test const&, Test const&) = default; 
```

（`operator==`显然在范围内）

同样：

```
bool operator>(Test const&, Test const&) = default;
bool operator<=(Test const&, Test const&) = default;
bool operator>=(Test const&, Test const&) = default; 
```

（`operator<`显然在范围内）

* * *

然而，我们可能会问真正的问题：为什么不提供一个更通用的方法？

`operator==`一般不会搞砸，但我见过无数的`operator<`. 显然尊重弱顺序并不像看起来那么容易（*）。尽管如此，如果你认为元组，它只是两个元组的字典比较，真的！

(*)*你有`==`and`<`的实现不匹配（即通常`!(a < b) and !(b < a)`<=> `a == b`），但元组确实解决了这个问题！*

实际上：

```
std::tuple<int, std::string const&> to_tuple(Test const&); 
```

通常可用于生成初始运算符：

```
template <typename T>
auto operator==(T const& left, T const& right) -> decltype(to_tuple(left), bool{}) {
    return to_tuple(left) == to_tuple(right);
}

template <typename T>
auto operator<(T const& left, T const& right) -> delctype(to_tuple(right), bool{}) {
    return to_tuple(left) < to_tuple(right);
} 
```

那么，陷阱是什么？好吧，ADL。当这些模板与您实现的类位于不同的命名空间`to_tuple`中时，事情就会分崩离析，因为它们不会被 ADL 自动拾取（同样的原因，虽然`using std::swap`很常见......）。

因此，我们可以争辩说，如果在范围内，`bool operator==(Test const&, Test const&) = default;`应该做正确的事情（tm） 。`to_tuple(Test const&)`它甚至不会是疯狂的。没有太多。

但是，看看我离最初的提议有多远？想象一下委员会的决定最终会是什么......

* * *

与此同时？

好吧，就我个人而言，我实现：

```
#define MY_DEFINE_TUPLE_OPERATOR_IMPL(Type_, Op_)                       \
    inline bool operator Op_ (Type_ const& left, Type_ const& right) {  \
        return to_tuple(left) Op_ to_tuple(right);                      \
    }                                                                   \

#define MY_DEFINE_TUPLE_EQUAL(Type_)                                    \
    MY_DEFINE_TUPLE_OPERATOR_IMPL(Type_, ==)                            \
    MY_DEFINE_TUPLE_OPERATOR_IMPL(Type_, !=)

#define MY_DEFINE_TUPLE_COMP(Type_)                                     \
    MY_DEFINE_TUPLE_OPERATOR_IMPL(Type_,  <)                            \
    MY_DEFINE_TUPLE_OPERATOR_IMPL(Type_,  >)                            \
    MY_DEFINE_TUPLE_OPERATOR_IMPL(Type_, <=)                            \
    MY_DEFINE_TUPLE_OPERATOR_IMPL(Type_, >=) 
```

进而：

```
class Test;

std::tuple<int, std::string const&> to_tuple(Test const&); // or boost::tuple

MY_DEFINE_TUPLE_EQUAL(Test);
MY_DEFINE_TUPLE_COMP(Test); 
```

它与 ADL 一起使用，它生成内联代码`to_tuple`（可能是内联代码本身也可能不是内联代码），它生成正确且一致`==`的`<`实现，并且它比`= default`所有 6 种方法的输入更少。

甚至为编译器错误消息留下源位置！

那么......为什么确实使语言进一步复杂化？

# ruby-on-rails - Rails：无法使用 Nokogiri 解析 XML 响应

> ID：12940760
> 
> 赞同：0
> 
> 时间：2012-10-17T18:19:11.517
> 
> 标签：ruby-on-rails, xml, api, nokogiri

我基本上是想从我对 ChartLyrics API 的响应中获取 Lyric 标签。这是我写的代码：

```
require 'nokogiri'
require 'open-uri'

request = Net::HTTP.get(URI.parse('http://api.chartlyrics.com/apiv1.asmx/GetLyric?lyricId=1710&lyricCheckSum=a4a56a99ee00cd8e67872a7764d6f9c6'))
puts request
response = Nokogiri::XML(request)

puts response.xpath("//Lyric")[0].to_s 
```

我已阅读文档，但没有找到答案。我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T18:52:40.073

试试下面的代码

```
require 'open-uri'
require 'nokogiri'
xml_doc = Nokogiri::XML(open('http://api.chartlyrics.com/apiv1.asmx/GetLyric?lyricId=1710&lyricCheckSum=a4a56a99ee00cd8e67872a7764d6f9c6'))
#I always prefer css than xpath
lyrics = xml_doc.css('Lyric')
if lyrics.empty?
  puts "COuld not find any lyric in the XML document'
else
  puts lyrics[0].to_s
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T18:54:18.163

做 response.remove_namespaces！在 response.xpath 之前

# glassfish - 如何在 JNDI 查找中存储凭据？

> ID：12940763
> 
> 赞同：2
> 
> 时间：2012-10-17T18:19:25.273
> 
> 标签：glassfish, jndi

我有一个包含多个`properties`文件的应用程序，我很好奇将这些 // 组合存储在 JNDI 查找中而不是在 .jar 中存储`username`这个明文文件是否更容易`password`。`server-url-to-login-to`

有几个问题：

1.  您可以使用 JNDI 存储不是数据库的凭据吗？
2.  如何配置新的 JNDI 资源来存储这些属性？
3.  您将如何从资源中检索这些属性？

我阅读的大部分文档是如何为数据库连接设置 JNDI，对于我的使用，我没有连接到**任何**数据库，而是使用不同的身份验证方案（请求消息中的 SOAP 用户/密码， HTTP Basic、标头、SSL 等）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-18T10:35:02.627

您的问题的答案：

> 1.  您可以使用 JNDI 存储不是数据库的凭据吗？

是的。

> 1.  如何配置新的 JNDI 资源来存储这些属性？

如果您使用的是 Glassfish 2，则必须创建自定义`PropertiesObjectFactory`类来`JNDI`处理`java.util.Porperties`.

例如，`PropertiesObjectFactory`类可能如下所示：

```
public class PropertiesObjectFactory implements Serializable, ObjectFactory {

    public static final String FILE_PROPERTY_NAME = "org.glassfish.resources.custom.factory.PropertiesFactory.fileName";

    public Object getObjectInstance(Object obj, Name name, Context nameCtx, Hashtable<?, ?> environment)
            throws Exception {
        Reference ref = (Reference) obj;
        Enumeration<RefAddr> refAddrs = ref.getAll();

        String fileName = null;
        Properties fileProperties = new Properties();
        Properties properties = new Properties();

        while (refAddrs.hasMoreElements()) {
            RefAddr addr = refAddrs.nextElement();
            String type = addr.getType();
            String value = (String) addr.getContent();

            if (type.equalsIgnoreCase(FILE_PROPERTY_NAME)) {
                fileName = value;
            } else {
                properties.put(type, value);
            }
        }

        if (fileName != null) {
            File file = new File(fileName);
            if (!file.isAbsolute()) {
                file = new File(System.getProperty("com.sun.aas.installRoot") + File.separator + fileName);
            }
            try {
                if (file.exists()) {
                    try {
                        FileInputStream fis = new FileInputStream(file);
                        if (fileName.toUpperCase().endsWith("XML")) {
                            fileProperties.loadFromXML(fis);
                        } else {
                            fileProperties.load(fis);
                        }
                    } catch (IOException ioe) {
                        throw new IOException("IO Exception during properties load : " + file.getAbsolutePath());
                    }
                } else {
                    throw new FileNotFoundException("File not found : " + file.getAbsolutePath());
                }
            } catch (FileNotFoundException fnfe) {
                throw new FileNotFoundException("File not found : " + file.getAbsolutePath());
            }
        }
        fileProperties.putAll(properties);
        return fileProperties;
    }
} 
```

制作一个该类的罐子，将其添加到 glassfish 全局类路径中。它将是：`/glassfish/domains/domain1/lib`然后您可以在`JNDI`属性配置中将其指定为工厂类。

Glassfish 3 已经有属性工厂类。它设置为：`org.glassfish.resources.custom.factory.PropertiesFactory`。

打开 glassfish 管理控制台并导航到：资源 -> JNDI -> 自定义资源，单击“新建”，提供 JNDI 名称，例如：`jndi/credentials`，选择资源类型`java.util.Properties`，指定工厂类：`org.glassfish.resources.custom.factory.PropertiesFactory`，然后单击“添加属性”，指定名称例如：`testUsernameName`在值列`testUsernameValue`中。单击确定，就是这样，您已经配置了`JNDI`资源。您可以根据需要添加任意数量的属性：`jndi/credentials`资源。

完成资源创建后不要忘记重启应用服务器。

> 1.  您将如何从资源中检索这些属性？

```
public Properties getProperties(String jndiName) {
    Properties properties = null;
    try {
        InitialContext context = new InitialContext();
        properties = (Properties) context.lookup(jndiName);
        context.close();
    } catch (NamingException e) {
        LOGGER.error("Naming error occurred while initializing properties from JNDI.", e);
        return null;
    }
    return properties;
} 
```

示例如何获取属性：

```
String username = someInstance.getProperties("jndi/credentials").getProperty("testUsernameName"); 
```

你`username`会是：`testUsernameValue`。

当您在应用程序中调用此方法时，请提供`JNDI`您在应用程序服务器中配置的名称：`jndi/credentials`. 如果您在部署描述符中映射了资源，则必须使用：`java:comp/env/jndi/credentials`.

如果您想使用以下方法执行相同操作`Spring`：

```
<jee:jndi-lookup id="credentials"
                 jndi-name="jndi/credentials"/> 
```

好吧，我希望就是这样。希望这可以帮助。

# asp.net - 使用 outputcache 缓存页面时存储页面浏览量

> ID：12940765
> 
> 赞同：1
> 
> 时间：2012-10-17T18:19:31.623
> 
> 标签：asp.net, caching, outputcache, personalization, donut-caching

我有一个页面，我使用输出缓存缓存了几个小时。但是，我仍然想在我的数据库中记录每个页面浏览量。

访问我的代码隐藏非常重要，因为我将使用这些数据来显示个性化数据。

所以我的输出缓存参数是：

```
<%@ OutputCache duration="7200" VaryByParam="*" %> 
```

**解决思路...**

我想我基本上想要甜甜圈缓存，但我真的找不到太多关于它的信息。

替代控制是否适用于此？用户控件会被缓存吗？

即使我们使用输出缓存，访问数据库以存储页面浏览量的最佳解决方案是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T13:02:38.127

您基本上可以`HttpHandler`在 asp.net 中创建一个自定义，并在页面加载时使用 javascript 使用适当的参数调用该处理程序。该处理程序将完成其余的事情，例如在数据库中保存与页面访问相关的数据等。

如果您需要更多帮助，请告诉我。

# ios - 将 MKMapView 上的注释与创建它们的源数组中的注释匹配

> ID：12940768
> 
> 赞同：1
> 
> 时间：2012-10-17T18:19:40.387
> 
> 标签：ios, mkmapview, nspredicate, mkannotation, mkannotationview

我有一个`NSArray`称为`Proximity`. `ProximityAnnotation`我通过创建一个新的如下来将这些添加到地图中：

```
// Add the annotations to the map
if (self.proximityItems) {
    for (Proximity *proximity in self.proximityItems) {

        // Create a pin
        ProximityAnnotation *proximityAnnotation = [[ProximityAnnotation alloc] init];
        proximityAnnotation.coordinate = CLLocationCoordinate2DMake([proximity.latitude doubleValue], [proximity.longitude doubleValue]);
        proximityAnnotation.title = proximity.title;
        proximityAnnotation.subtitle = NSLocalizedString(@"Drag to change location", nil);
        [self.map addAnnotation:proximityAnnotation];

    }//end

    // Create the map rect
    MapUtility *util = [[MapUtility alloc] init];
    [util zoomMapViewToFitAnnotations:self.map animated:YES];
}//end 
```

这很好用。

现在，当我拖动注释时，我想更新数组`ProximityAnnotation`中包含的相应对象`proximityItems`。我正在尝试通过执行以下操作来做到这一点：

```
- (void)mapView:(MKMapView *)mapView annotationView:(MKAnnotationView *)annotationView didChangeDragState:(MKAnnotationViewDragState)newState fromOldState:(MKAnnotationViewDragState)oldState {

    // Get the coordiante
    if ([annotationView.annotation isKindOfClass:[ProximityAnnotation class]] && newState == MKAnnotationViewDragStateEnding) {
        ProximityAnnotation *annotation = (ProximityAnnotation *)annotationView.annotation;
        CLLocationCoordinate2D coordinate = annotation.coordinate;

        // Find the annotation that matches
        for (Proximity *proximity in self.proximityItems) {
            NSLog(@"%f == %f && %f == %f && %@ == %@", [proximity.latitude doubleValue], coordinate.latitude, [proximity.longitude doubleValue], coordinate.longitude, annotation.title, proximity.title);
            if ([proximity.latitude doubleValue] == coordinate.latitude && [proximity.longitude doubleValue] == coordinate.longitude && [annotation.title isEqualToString:proximity.title]) {

                // Update the proximity item
                proximity.longitude = [NSNumber numberWithDouble:coordinate.longitude];
                proximity.latitude = [NSNumber numberWithDouble:coordinate.latitude];

                break;
            }
        }//end

    }//end

}//end 
```

不幸的是，即使地图上只有 1 个注释，这似乎也没有匹配。以下是我的记录`NSLog`：

```
37.627946 == 37.622267 && -122.431599 == -122.435596 && Testlocation == Testlocation 
```

奇怪的是，双值似乎有点偏离，但我不知道为什么。

**有没有更好的方法将注释与我的数组中的对象相匹配，以便我可以更新该原始对象？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T18:37:50.550

坐标值很可能“关闭”，因为注释已被拖到新位置。

即使值相等，我也不建议将浮点数作为对象相等性的测试。

相反，我建议以下选项：

*   在类中添加对源`Proximity`对象的引用，`ProximityAnnotation`并在创建注释时设置它（例如。`proximityAnnotation.sourceProximity = proximity;`）。然后要更新原始`Proximity`对象，您可以直接从注解本身获取对它的引用。
*   消除`ProximityAnnotation`类并使`Proximity`类本身实现`MKAnnotation`协议，在这种情况下甚至可能不需要更新。

# python - python中带分隔符的输入

> ID：12940770
> 
> 赞同：0
> 
> 时间：2012-10-17T18:19:55.670
> 
> 标签：python, input, stdin

我对以下规范有疑问：

**输入：**

第一行包含一个整数 N ，即给定序列中的元素数。然后是 N 个整数 A1, A2.... An, Ai 是给定序列的第 i 个元素。这些数字可以是空格分隔或换行分隔。

我该如何处理这样的输入？我尝试了以下方法，但它仅适用于空格分隔的元素。当与换行符分隔的元素一起使用时，分级机抛出“超时”

```
import sys
counter=0
A=[]
for line in sys.stdin:
    if counter!=0:
        A+=[int(Ai) for Ai in line.split()]
    else:
        N=int(line)
        counter+=1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T18:30:21.850

假设您正在从文件中读取（`sys.stdin`也是一个文件）：

```
f = open('path/to/file')
N = int(f.readline().strip())
A = []
while len(A) < N:
    A.extend(int(i) for i in f.readline().strip().split()) 
```

希望这可以帮助

# filter - NSRegularExpressions - 在 Xcode 中过滤掉单词

> ID：12940775
> 
> 赞同：0
> 
> 时间：2012-10-17T18:20:09.140
> 
> 标签：filter, words, nsregularexpression, nsrange

我目前正在自学 NSRegularExpressions 以及如何从 RSS 提要中过滤某些内容。特别是，RSS 提要的格式为“some text ::（这里可以有一个 Re: 用于回复）some text :: some text”。我想删除那个 Re: 如果它存在的话。我知道应该有一种方法可以做到这一点，而无需在我目前拥有的一个中创建另一个 NSRegularExpression。我没有掌握所有的符号。我试图使用 ?: 从捕获中取消包含 Re: ，但我不太清楚如何。有人介意帮我看看这个并帮我一把吗？

```
NSRegularExpression *reg = [[NSRegularExpression alloc] initWithPattern:@".* :: ?:Re: (.*) :: .*" options:0 error:nil]; //The () creates a capture group and an array of ranges for reg

    //Loop through every title of the items in channel
    for (RSSItem *i in items) {
        NSString *itemTitle = [i title];
        //find mittts
        //Find matches in the title string. The range argument specifies how much of the title to search; in this case, all of it.
        NSArray *matches = [reg matchesInString:itemTitle options:0 range:NSMakeRange(0, [itemTitle length])];

        //If there was a match...
        if ([matches count] > 0) {
             //Print the location of the match in the string and the string
            NSTextCheckingResult *result = [matches objectAtIndex:0];

            NSRange r = [result range];

            NSLog(@"\nMatch at {%d, %d} for %@!\n", r.location, r.length, itemTitle);

            NSLog(@"Range : %d",[result numberOfRanges]);
            //One capture group, so two ranges, let's verify
            if ([result numberOfRanges] == 2) {
                //Pull out the 2nd range, which will be the capture group
                NSRange r = [result rangeAtIndex:1];

                //Set the title of the item to the string within the capture group
                [i setTitle:[itemTitle substringWithRange:r]];

                NSLog(@"%@", [itemTitle substringWithRange:r]);
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T23:03:58.630

没关系，找到了。我需要 (?:Re: )？以防止捕获它。

# mysql - 排序数据列以检索最大文本值

> ID：12940781
> 
> 赞同：2
> 
> 时间：2012-10-17T18:20:39.713
> 
> 标签：mysql, search, select

我有一列称为订单号 (orderNum) 的数据，可以如下所示：

`1124, 203, 5467, MANUAL1, MANUAL34, DEMO12, DEMO998, INTERNAL2312, INTERNAL232`

本质上，我需要编写一个 SQL 查询来检索某种类型的“最大”订单号。整数的实际顺序是微不足道的，但是 MySQL 对`VARCHAR`s 进行的排序有点古怪。因此，在上面的数据集中，如果我正在寻找下一个手动订单号，我需要能够知道这`MANUAL34`是最后使用的手动订单号，，`INTERNAL2312`（`DEMO12`数字将按顺序增加 1）。有没有一种方法可以实现这一点，而不必拉出整个列并在我的 Java Web 服务中对其进行排序？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-17T18:33:37.220

您可以执行以下操作：

```
select * from testing where value like 'MANUAL%' 
order by CAST(right(value, length(value)-length('MANUAL')) as UNSIGNED) desc 
LIMIT 1 
```

[链接到 SQL 小提琴](http://www.sqlfiddle.com/#!2/5831d/5)

# javascript - 单击时更改列表项中锚点的背景颜色

> ID：12940782
> 
> 赞同：0
> 
> 时间：2012-10-17T18:20:45.753
> 
> 标签：javascript, asp.net, web-applications

我有由 ul li 构建的菜单，每个菜单都有锚标签。Css 应用于锚点和锚点：悬停但是我希望选定的项目显示它被选中，将背景更改为不同的颜色。锚：活动不起作用。

我正在尝试 javascript 但尚未成功。这可以通过css单独完成吗？我看过很多例子，但实际上没有一个是正确的。

JAVASCRIPT

```
 <script type="text/javascript">
      function ChangeColor(obj) {
         var li = document.getElementById(obj.id);
         li.style.background = "#bfcbd6";
      }
 </script> 
```

HTML

```
 <div id="navigation">
      <ul>
          <li><a onclick="changecolor(this);" href="Default.aspx">Home</a></li>
          <li><a onclick="changecolor(this);" href="View.aspx">View</a></li>
          <li><a onclick="changecolor(this);" href="About.aspx">About</a></li>
      </ul>
  </div> 
```

CSS - 简化

```
#navigation ul {
  list-style-type: none;
}

#navigation li 
{
  float: left;
}

#navigation a
{
  background-color: #465c71;
}

#navigation a:hover
{
  background-color: #bfcbd6;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T18:22:31.927

您不需要再次获取 id 来处理元素。obj 引用实际元素。

```
 <script type="text/javascript">
      function ChangeColor(obj) {
         obj.style.backgroundColor = "#bfcbd6";
      }
 </script> 
```

**编辑：**而且`javaScript is case sensitive`，所以你应该检查你的函数名称。

[这是一个 jsFiddle 演示](http://jsfiddle.net/ocanal/Wjtgx/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-18T18:45:52.473

我找到了一种使用 JavaScript 来解决这种情况的方法。这适用于拥有 MasterPage。更改选定选项卡的 id 将仅引用该选定选项卡的 css，同时将其他选项卡 id 设置为 null。

HTML

```
<div id="navbar">
    <div id="holder">
        <ul id="menulist">
            <li><a onclick="SelectedTab(this);" href="#" id="onlink" >Home</a></li>
            <li><a onclick="SelectedTab(this);" href="#" id="" >Products</a></li>
            <li><a onclick="SelectedTab(this);" href="#" id="">Services</a></li>
            <li><a onclick="SelectedTab(this);" href="#" id="">Gallery</a></li>
            <li><a onclick="SelectedTab(this);" href="#" id="" >Contact</a></li>
        </ul>
    </div>
</div> 
```

JavaScript

```
 function SelectedTab(sender) {
        var aElements = sender.parentNode.parentNode.getElementsByTagName("a");     
        var aElementsLength = aElements.length;      
        var index;     
        for (var i = 0; i < aElementsLength; i++)     
        {
            if (aElements[i] == sender) //this condition is never true         
            {
                index = i;
                aElements[i].id="onlink"
            } else {
                aElements[i].id=""
            }   
        } 
    } 
```

选择选项卡后更改背景颜色的CSS

```
#holder ul li a#onlink
{
   background: #FFF;
   color: #000;
   border-bottom: 1px solid #FFF;
} 
```

# c# - 关闭和财产

> ID：12940783
> 
> 赞同：0
> 
> 时间：2012-10-17T18:20:56.000
> 
> 标签：c#, .net, lambda, closures

```
var a = "test";
var @delegate = () => a;

Assert.AreEqual(@delegate(),"test"); //true

a = "12345678"

Assert.AreEqual(@delegate(),"test"); //still true, due to closure. 
```

但是，如果变量 a 是类级别的属性，那么第二个断言会返回什么 - 真还是假？

例如，如果 a 是

```
string _a;
string a {get {return _a;} set{_a = value;}} 
```

如果 a 是方法而不是属性，我知道第二个断言将是错误的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-17T18:22:25.253

闭包捕获变量，而不是值。第二个断言是错误的。

此外，值得注意的是属性*是*方法。像这样的属性的一`get` `set`对访问器

```
private string _a;

public string a
{
    get { return _a; }
    set { _a = value; }
} 
```

实际上产生这样的代码

```
private string _a;

public string get_a()
{
    return _a;
}

public void set_a(string value)
{
    _a = value;
} 
```

像变量这样的属性的使用只是语法糖

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-17T18:39:21.457

它们的行为完全相同。

```
public void ClosureOverVariable()
{
    var a = "x";

    Func<string> d = () => a;

    Console.WriteLine(d()); // print "x"

    a = "y";

    Console.WriteLine(d()); // print "y"
}

class Foo
{
    public string X { get; set; }
}

public void ClosureOverProperty()
{
    var a = new Foo
        {
            X = "a"
        };

    Func<string> d = () => a.X;

    Console.WriteLine(d()); // prints "a"

    a.X = "y";

    Console.WriteLine(d()); // print "y"
} 
```

# xml - 如何防止 JSON Web 服务响应下载到文件？

> ID：12940785
> 
> 赞同：1
> 
> 时间：2012-10-17T18:21:31.757
> 
> 标签：xml, json, wcf, web-services, rest

我有一些几乎相同的 WCF 服务代码，除了一个方法应该返回一个 xml 结果，另一个是一个 json 结果：

```
[ServiceContract]
public interface IRestServiceImpl
{
    [OperationContract]
    [WebInvoke(Method = "GET",
        ResponseFormat = WebMessageFormat.Xml,
        BodyStyle = WebMessageBodyStyle.Wrapped,
        UriTemplate = "xml/{id}")]
    string XMLData(string id);

    [OperationContract]
    [WebInvoke(Method = "GET",
        ResponseFormat = WebMessageFormat.Json,
        BodyStyle = WebMessageBodyStyle.Wrapped,
        UriTemplate = "json/{id}")]
    string JSONData(string id);
} 
```

xml 工作正常（例如，当我在浏览器中输入“ *http://localhost:4841/RestServiceImpl.svc/xml/2468* ”时）。

但是，当我输入“ *http://localhost:4841/RestServiceImpl.svc/json/2468* ”时，我会看到一个“*文件下载 - 安全警告*”对话框，它允许我保存一个文件（在这种情况下名为“2468”） ，在记事本中打开时包含以下内容：

*{"JSONDataResult":"您请求的产品 2468"}*

这是“按设计”（将 json 结果保存到文件），还是为什么它的行为方式与 xml-o-rama 不同？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-17T18:29:32.737

由您的浏览器决定如何处理任何特定的 Content-Type，听起来您的浏览器不知道如何处理 JSON。

要检查这一点，在使用 Chrome 开发控制台或 Firebug（或您使用的任何浏览器中的任何等效项）时，请在加载该资源时查看网络请求。在标题中，您应该会看到类似

```
Content-type: application/json 
```

如果你这样做，问题是你的浏览器。如果您没有看到，那么您的服务器或服务代码是错误的（特别是如果它`application/octet-stream`是相当于“我不知道”的 mime 类型）。

至于浏览器，我个人推荐 Chrome + 这个用于显示格式化 JSON 输出的优秀插件：[https ://github.com/callumlocke/json-formatter](https://github.com/callumlocke/json-formatter)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T18:29:43.080

这取决于您使用哪个浏览器与服务通信。IE（最高 IE9）知道如何显示 XML，但不知道 JSON，这就是为什么它显示一个但要求您保存另一个（就像您浏览某些二进制文件时一样）。Chrome 知道如何显示两者，因此您可以浏览到 .../json/2468 和 .../xml/2468 ，它会显示响应。服务中没有什么可以做的¹。

* * *

¹实际上，如果您感兴趣的是在浏览器中显示输出（而不是某些需要理解 JSON 或 XML 的客户端使用服务），您也可以返回 HTML 格式的数据。一种简单的方法是将 HTML 作为流返回，如下所示。

```
public class StackOverflow_12940785
{
    [ServiceContract]
    public interface IRestServiceImpl
    {
        [OperationContract]
        [WebGet(
            ResponseFormat = WebMessageFormat.Xml,
            BodyStyle = WebMessageBodyStyle.Wrapped,
            UriTemplate = "xml/{id}")]
        string XMLData(string id);

        [OperationContract]
        [WebGet(
            ResponseFormat = WebMessageFormat.Json,
            BodyStyle = WebMessageBodyStyle.Wrapped,
            UriTemplate = "json/{id}")]
        string JSONData(string id);

        [OperationContract]
        [WebGet(
            ResponseFormat = WebMessageFormat.Json,
            BodyStyle = WebMessageBodyStyle.Wrapped,
            UriTemplate = "html/{id}")]
        Stream HTMLData(string id);
    }
    public class Service : IRestServiceImpl
    {
        public string XMLData(string id)
        {
            return "You requested product " + id;
        }

        public string JSONData(string id)
        {
            return "You requested product " + id;
        }

        public Stream HTMLData(string id)
        {
            WebOperationContext.Current.OutgoingResponse.ContentType = "text/html";
            string response = @"<html>
                <head><title>My service</title></head>
                <body>
                    <p>You requested <b>product " + id + @"</b></p>
                </body>
            </html>";
            return new MemoryStream(Encoding.UTF8.GetBytes(response));
        }
    }
    public static void Test()
    {
        string baseAddress = "http://" + Environment.MachineName + ":8000/Service";
        WebServiceHost host = new WebServiceHost(typeof(Service), new Uri(baseAddress));
        host.Open();
        Console.WriteLine("Host opened");

        Console.Write("Press ENTER to close the host");
        Console.ReadLine();
        host.Close();
    }
} 
```

# sql - 清除 SQL Reporting Services 中的重复列值

> ID：12940805
> 
> 赞同：17
> 
> 时间：2012-10-17T18:22:38.157
> 
> 标签：sql, reporting-services, sql-server-2008-r2

这必须是愚蠢的容易做到，但我没有看到它。

我有一个 SQL Reporting Services (SQL 1008 R2) 报告。

我正在使用 tablix 基本上显示：

```
COL 1 |  COL 2 |  COL 3 |  COL 4
----------------------------------
100   |  100   |  100   |  Item 1
100   |  100   |  101   |  Item 2
100   |  100   |  102   |  Item 3
100   |  110   |  110   |  Item 4
100   |  110   |  110   |  Item 4
100   |  110   |  111   |  Item 5
100   |  110   |  112   |  Item 6 
```

但我想抑制前两列中的重复值，所以它看起来像这样：

```
COL 1 |  COL 2 |  COL 3 |  COL 4
----------------------------------
100   |  100   |  100   |  Item 1
      |        |  101   |  Item 2
      |        |  102   |  Item 3
      |  110   |  110   |  Item 4
      |        |  110   |  Item 4
      |        |  111   |  Item 5
      |        |  112   |  Item 6 
```

我认为这可能就像右键单击该列并选择“隐藏重复值”一样简单，但我没有看到。我现在道歉，因为当有人指出它是多么容易做或找到时，我会感到愚蠢。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-10-17T18:38:54.403

最好简单地使用组，但如果您想保持这种方式，请尝试：

```
=IIf(Previous(Fields!Col1.Value) = Fields!Col1.Value, Nothing, Fields!Col1.Value) 
```

或者您可以将文本框的`HideDuplicates`属性设置为包含的组名（在您的情况下，大概是`Tablix1_Details`）

# objective-c - 文字语法与 mutableCopy 和 Objective-C 编译器警告

> ID：12940806
> 
> 赞同：0
> 
> 时间：2012-10-17T18:22:39.383
> 
> 标签：objective-c, compiler-warnings, nsmutablecopying

我对 Python 的经验比其他任何东西都多，所以使用可变数组和不可变数组和字典有点奇怪。我真的很喜欢 Xcode 4.5 添加的文字语法，但是在做一些简单的事情时，我遇到了这样的情况：

```
NSArray *myArray = [@[/*array objects here*/] mutableCopy];
[myArray addObject: @/*an object goes here*/]; 
```

并且编译器给了我一个警告，指出“myArray 可能无法响应 addObject”。

代码编译并且 addObject 工作得很好，我可以 NSLog 对象并验证它是否存在于 myArray - 但我不完全理解这个警告的性质。在这种情况下 mutableCopy 不会返回 NSMutableArray 吗？简单地使用 NSMutableArray 而不是尝试（过度）使用文字语法是否更合适？

另外，既然这只是一个愚蠢的警告，我可以忽略它并继续吗？这似乎……在最坏的情况下是懒惰的，也许只是为将来的恶作剧打开了大门。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T18:24:09.203

您需要将变量声明为`NSMutableArray`，而不是`NSArray`。`addObject:`是一种仅在 上可用的方法`NSMutableArray`。

**编辑：**你似乎也有一个不必要`@`的在那里。您的代码应该是：

```
NSMutableArray *mutable = [@[a, b, c] mutableCopy];
[mutable addObject:d]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T18:24:46.330

> 在这种情况下 mutableCopy 不会返回 NSMutableArray 吗？

确实如此。这就是为什么您必须将返回值分配给 NSMutableArray，而不是 NSArray。

```
NSMutableArray *myArray = [@[/*array objects here*/] mutableCopy]; 
```

应该让编译器闭嘴。

# jms - 在 websphere 8.5 中使用 jmx 创建和删除 jms 队列

> ID：12940807
> 
> 赞同：1
> 
> 时间：2012-10-17T18:22:38.983
> 
> 标签：jms, websphere, jmx

我正在寻找一种通过 java 客户端使用 jmx 创建和删除 jms 队列的方法。

我知道我们确实为 jmx 管理获得了 AdminClient。但我无法获得我们可以使用哪个 mbean 来创建和删除 jms 队列。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T04:55:17.857

您可以使用 ConfigService 处理 WAS 配置（尤其是创建/删除 JMS 队列）。本文介绍如何获取和使用 ConfigService：

[http://www.ibm.com/developerworks/websphere/techjournal/0307_wang/wang.html](http://www.ibm.com/developerworks/websphere/techjournal/0307_wang/wang.html)

尽管它是为 WAS 5.1 编写的，但它仍然是最新的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-18T19:12:29.303

Marcin 提到的 ConfigService 是一个允许直接操作配置对象的低级 API。那我很棘手。例如，如果您需要创建一个 SIB 目标，那么您需要操作至少两种不同类型的配置对象，即 SIB 目标（在单元范围内定义的总线的子代）和队列点（服务器上消息传递引擎的子代）或集群范围），您需要确保正确链接它们。

[使用本文所述的](http://www.ibm.com/developerworks/forums/thread.jspa?threadID=265050)CommandMgr API 可能会更容易。该 API 直接等效于 wsadmin 中的 AdminTask 对象。

# jquery - jQuery验证提交按钮类

> ID：12940808
> 
> 赞同：0
> 
> 时间：2012-10-17T18:22:51.163
> 
> 标签：jquery, validation

如果表单无效，我正在尝试验证表单并为提交按钮提供一个类。默认情况下， [jQuery validate](http://docs.jquery.com/Plugins/Validation)只会为`.error`除提交按钮之外的所有输入提供一个类。`#submit`如果表单无效，是否可以向我的提交按钮 () 添加错误类？如果表单有效，则删除课程？

我的html：

```
<form id="sub" action="index.html"  method="post">
    <input class="required" name="email" placeholder="Your mail here" type="text">
    <input id="submit" name="submit" value="SEND" type="submit">
</form> 
```

JS：

```
 <script>
  $(document).ready(function(){
    $("#sub").validate();
  });

</script> 
```

PS 如果更容易，该类也可以附加到 form#sub 元素。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T18:26:02.460

您应该能够执行以下操作（来自[文档](http://docs.jquery.com/Plugins/Validation/validate#toptions)）：

```
<script>
    $(document).ready(function(){
        $("#sub").validate({
            submitHandler: function(form) {
                $(form).find("input:submit").removeClass("error");
                form.submit();
            },
            invalidHandler: function(form) {
                $(form).find("input:submit").addClass("error");
            }
        });
    });
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T18:30:28.780

当表单有效或无效时有两种处理方法 invalidHandler 和 submitHandler 。

您可以在其中的提交按钮上放置 jQuery 代码来添加或删除错误类。

**例子：**

```
$("#sub").validate({
   invalidHandler: function(){
      $("#sub input:submit").addClass("error");
   },
   submitHandler: function(){
      $("#sub input:submit").removeClass("error");
   }
}); 
```

希望这会有所帮助！

# ruby - 使用 Watir 验证 html 中是否存在罢工标签

> ID：12940811
> 
> 赞同：3
> 
> 时间：2012-10-17T18:23:02.893
> 
> 标签：ruby, xpath, watir

我在下面有以下 html 代码，我正在使用 watir 尝试验证 3 月没有罢工标签，而 4 月、6 月和 7 月确实有罢工标签。我很确定 xpath 是我回答的关键，但未能提出正确的解决方案。任何帮助是极大的赞赏。

```
<div class="availability">
Available:
    <ul>
     <li><span class="month available">March</span></li>
     <li><span class="month unavailable"><strike>April</strike></span></li>
     <li><span class="month unavailable"><strike>May</strike></span></li>
     <li><span class="month unavailable"><strike>June</strike></span></li>
    </ul>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T20:44:33.070

如果您使用的是 watir-webdriver，您可以执行以下操作：

```
#Create an array of the strike elements
months_with_strike = browser.elements(:tag_name, 'strike').collect(&:text)

#Determine if the specified month is in the array
months_with_strike.include?('March')
#=> false
months_with_strike.include?('April')
#=> true 
```

或者，如果您只想检查单个元素：

```
browser.element(:tag_name => 'strike', :text => 'March').exists?
#=> false
browser.element(:tag_name => 'strike', :text => 'April').exists?
#=> true 
```

重要的部分是您可以通过使用`:tag_name`作为定位器来获取自定义元素。

注意：我认为这也应该适用于 watir-classic，但由于某种原因，我遇到了例外。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T19:12:22.937

**使用（假设初始上下文节点是`div`元素的父级）**：

```
div/ul/li/span[not(strike)] 
```

这将选择任何`span`没有`strike`子元素的元素（并且是 a 的子元素，它是`li`a的子元素，是 a 的子元素，`ul`是`div`初始上下文节点的子元素）

**并使用**：

```
div/ul/li/span[strike] 
```

这将选择任何`span`具有`strike`孩子的元素（并且是 a 的孩子`li`，是 a 的孩子`ul`，是`div`a 的孩子，是初始上下文节点的孩子）

**基于 XSLT 的验证**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="/">
     <xsl:copy-of select="div/ul/li/span[not(strike)]"/>
==============  
     <xsl:copy-of select="div/ul/li/span[strike]"/>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时：**

```
<div class="availability">
Available:
    <ul>
     <li><span class="month available">March</span></li>
     <li><span class="month unavailable"><strike>April</strike></span></li>
     <li><span class="month unavailable"><strike>May</strike></span></li>
     <li><span class="month unavailable"><strike>June</strike></span></li>
    </ul>
</div> 
```

**计算两个 XPath 表达式并将结果（选定节点）复制到输出，由视觉上独特的分隔符字符串分隔：**

```
<span class="month available">March</span>
==============  
<span class="month unavailable">
   <strike>April</strike>
</span>
<span class="month unavailable">
   <strike>May</strike>
</span>
<span class="month unavailable">
   <strike>June</strike>
</span> 
```

# recursion - 有人可以解释递归在这些过程中是如何工作的吗

> ID：12940812
> 
> 赞同：1
> 
> 时间：2012-10-17T18:23:04.150
> 
> 标签：recursion, lisp, scheme, sicp, mit-scheme

这是使用来自臭名昭著的 SICP 的 MIT 方案。我只是无法理解正在发生的事情。这是计算的过程`N!`。

```
(define (factorial n)
     (if (= n 0)
          1
          (* n (factorial (- n 1))))) 
```

这是计算斐波那契的过程

```
(define (fib n)
   (cond ((= n 0) 0)
         ((= n 1) 1)
   (else (+ (fib (- n 1))
            (fib (- n 2)))))) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T18:34:31.837

[在 SICP 书中，有一个关于线性递归](http://mitpress.mit.edu/sicp/full-text/book/book-Z-H-11.html#%_sec_1.2.1)如何工作的清晰、逐步的解释（对于阶乘示例），并且还有一个很好的解释，其中包含一个很好的树形图，详细说明了[树递归](http://mitpress.mit.edu/sicp/full-text/book/book-Z-H-11.html#%_sec_1.2.2)（对​​于斐波那契示例）。

如果您需要更容易理解的关于递归在 Scheme 程序中的一般工作原理的解释，我建议您看一下[The Little Schemer](https://rads.stackoverflow.com/amzn/click/com/0262560992)或[How to Design Programs](http://www.ccs.neu.edu/home/matthias/HtDP2e/)，这两本书都会教您如何深入了解递归过程一般来说。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T20:13:50.003

递归需要一些时间来理解，所以对自己要有耐心。

我建议假设您是计算机，并逐步了解您将如何计算`(factorial 4)`. `(factorial 4)`通过将和`(factorial 3)`（等）视为完全不同的实体，允许自己同时多次“进入”一个函数。

# ios - CoreData 和 NSManagedObjectContext

> ID：12940815
> 
> 赞同：0
> 
> 时间：2012-10-17T18:23:10.663
> 
> 标签：ios, core-data, nsmanagedobject, nsmanagedobjectcontext

我有这个功能，可以将对象从“fallbackstore”移动到 iCloud 商店，fallbackstore 是当 iCloud 不可用时保存对象的商店。

底线，我需要将对象（及其关系）从一个上下文移动到另一个上下文。

但我收到了这个错误：

*** 由于未捕获的异常“NSInternalInconsistencyException”而终止应用程序，原因：“上下文已经有一个协调器；无法替代。***首先抛出调用栈：

上：

foodSuccess = [moc save:&localError];

任何人都知道我在哪里出错（以及为什么）？提前致谢！

```
 - (BOOL)seedStore:(NSPersistentStore *)store withPersistentStoreAtURL:(NSURL *)seedStoreURL error:(NSError * __autoreleasing *)error {
    BOOL success = YES;

    NSLog(@"%s", __func__);

    BOOL foodSuccess = YES;
    BOOL sportSuccess = YES;
    BOOL dailySuccess = YES;
    BOOL activitySuccess = YES;
    BOOL reportSuccess = YES;
    BOOL userSuccess = YES;
    BOOL ingredientSuccess = YES;

    NSUInteger batchSize = 5000;

    NSError *localError = nil;

    NSManagedObjectModel *model = [NSManagedObjectModel mergedModelFromBundles:nil];
    NSPersistentStoreCoordinator *seedPSC = [[NSPersistentStoreCoordinator alloc] initWithManagedObjectModel:model];
    NSDictionary *seedStoreOptions = @{ NSReadOnlyPersistentStoreOption : [NSNumber numberWithBool:YES] };
    NSPersistentStore *seedStore = [seedPSC addPersistentStoreWithType:NSSQLiteStoreType
                                                         configuration:nil
                                                                   URL:seedStoreURL
                                                               options:seedStoreOptions
                                                                 error:&localError];
    if (seedStore) {
        NSManagedObjectContext *seedMOC = [[NSManagedObjectContext alloc] init];
        [seedMOC setPersistentStoreCoordinator:seedPSC];

        // Food
        NSFetchRequest *fr = [NSFetchRequest fetchRequestWithEntityName:@"Food"];
        fr.relationshipKeyPathsForPrefetching = @[@"daily", @"ingredient", @"ingredients"];
        [fr setFetchBatchSize:batchSize];

        NSArray *foods = [seedMOC executeFetchRequest:fr error:&localError];
        NSManagedObjectContext *moc = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSPrivateQueueConcurrencyType];
        [moc setPersistentStoreCoordinator:_psc];
        NSUInteger i = 1;
        for (Food *f in foods) {
            [self addFood:f toStore:store withContext:moc];
            if (0 == (i % batchSize)) {
                foodSuccess = [moc save:&localError];
                if (foodSuccess) {
                    [moc reset];
                } else {
                    NSLog(@"Error saving during seed (Food): %@", localError);
                    break;
                }
            }

            i++;
        }

        if ([moc hasChanges]) {
            foodSuccess = [moc save:&localError];
            [moc reset];
        }

        // Sport
        NSFetchRequest *fetchSports = [NSFetchRequest fetchRequestWithEntityName:@"Sport"];
        fetchSports.relationshipKeyPathsForPrefetching = @[@"activity"];
        fetchSports.fetchBatchSize = batchSize;

        NSArray *sports = [seedMOC executeFetchRequest:fetchSports error:&localError];
        NSManagedObjectContext *sportContext = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSPrivateQueueConcurrencyType];
        sportContext.persistentStoreCoordinator = _psc;
        NSUInteger iSports = 1;
        for (Sport *s in sports) {
            [self addSport:s toStore:store withContext:sportContext];
            if (0 == (iSports % batchSize)) {
                sportSuccess = [moc save:&localError];
                if (sportSuccess) {
                    [moc reset];
                } else {
                    NSLog(@"Error saving during seed (Sport): %@", localError);
                    break;
                }
            }

            iSports++;
        }

        if ([sportContext hasChanges]) {
            sportSuccess = [sportContext save:&localError];
            [sportContext reset];
        }

        // Daily
        NSFetchRequest *fetchDailies = [NSFetchRequest fetchRequestWithEntityName:@"Daily"];
        fetchDailies.relationshipKeyPathsForPrefetching = @[@"food", @"user"];
        fetchDailies.fetchBatchSize = batchSize;

        NSArray *dailies = [seedMOC executeFetchRequest:fetchDailies error:&localError];
        NSManagedObjectContext *dailiesContext = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSPrivateQueueConcurrencyType];
        dailiesContext.persistentStoreCoordinator = _psc;
        NSUInteger iDailies = 1;
        for(Daily *d in dailies) {
            [self addDaily:d toStore:store withContext:dailiesContext];
            if(0 == (iDailies % batchSize)) {
                dailySuccess = [dailiesContext save:&localError];
                if (dailySuccess) {
                    [dailiesContext reset];
                }
                else {
                    NSLog(@"Error saving during seed (Daily): %@", localError);
                    break;
                }
            }

            iDailies++;
        }

        if ([dailiesContext hasChanges]) {
            dailySuccess = [dailiesContext save:&localError];
            [dailiesContext reset];
        }

        // Ingredient
        NSFetchRequest *fetchIngredients = [NSFetchRequest fetchRequestWithEntityName:@"Ingredient"];
        fetchIngredients.relationshipKeyPathsForPrefetching = @[@"food", @"foods"];
        fetchIngredients.fetchBatchSize = batchSize;

        NSArray *ingredients = [seedMOC executeFetchRequest:fetchIngredients error:&localError];
        NSManagedObjectContext *ingredientsContext = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSPrivateQueueConcurrencyType];
        ingredientsContext.persistentStoreCoordinator = _psc;
        NSUInteger iIngredients = 1;
        for(Ingredient *i in ingredients) {
            [self addIngredient:i toStore:store withContext:ingredientsContext];
            if(0 == (iIngredients % batchSize)) {
                ingredientSuccess = [ingredientsContext save:&localError];
                if (ingredientSuccess) {
                    [ingredientsContext reset];
                }
                else {
                    NSLog(@"Error saving during seed (Ingredient): %@", localError);
                    break;
                }
            }

            iIngredients++;
        }

        if ([ingredientsContext hasChanges]) {
            ingredientSuccess = [ingredientsContext save:&localError];
            [ingredientsContext reset];
        }

        // Activity
        NSFetchRequest *fetchActivities = [NSFetchRequest fetchRequestWithEntityName:@"Activity"];
        fetchActivities.relationshipKeyPathsForPrefetching = @[@"sport", @"user"];
        fetchActivities.fetchBatchSize = batchSize;

        NSArray *activities = [seedMOC executeFetchRequest:fetchActivities error:&localError];
        NSManagedObjectContext *activitiesContext = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSPrivateQueueConcurrencyType];
        dailiesContext.persistentStoreCoordinator = _psc;
        NSUInteger iActivities = 1;
        for(Activity *a in activities) {
            [self addActivity:a toStore:store withContext:activitiesContext];
            if(0 == (iActivities % batchSize)) {
                activitySuccess = [activitiesContext save:&localError];
                if (activitySuccess) {
                    [activitiesContext reset];
                }
                else {
                    NSLog(@"Error saving during seed (Activity): %@", localError);
                    break;
                }
            }

            iActivities++;
        }

        if ([activitiesContext hasChanges]) {
            activitySuccess = [activitiesContext save:&localError];
            [activitiesContext reset];
        }

        // Report
        NSFetchRequest *fetchReports = [NSFetchRequest fetchRequestWithEntityName:@"Report"];
        fetchReports.relationshipKeyPathsForPrefetching = @[@"user"];
        fetchReports.fetchBatchSize = batchSize;

        NSArray *reports = [seedMOC executeFetchRequest:fetchReports error:&localError];
        NSManagedObjectContext *reportsContext = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSPrivateQueueConcurrencyType];
        reportsContext.persistentStoreCoordinator = _psc;
        NSUInteger iReports = 1;
        for(Report *r in reports) {
            [self addReport:r toStore:store withContext:reportsContext];
            if(0 == (iReports % batchSize)) {
                reportSuccess = [reportsContext save:&localError];
                if (reportSuccess) {
                    [reportsContext reset];
                }
                else {
                    NSLog(@"Error saving during seed (Report): %@", localError);
                    break;
                }
            }

            iReports++;
        }

        if ([reportsContext hasChanges]) {
            reportSuccess = [reportsContext save:&localError];
            [reportsContext reset];
        }

        // User
        NSFetchRequest *fetchUsers = [NSFetchRequest fetchRequestWithEntityName:@"User"];
        fetchUsers.relationshipKeyPathsForPrefetching = @[@"activities", @"dailies", @"reports"];
        fetchUsers.fetchBatchSize = batchSize;

        NSArray *users = [seedMOC executeFetchRequest:fetchUsers error:&localError];
        NSManagedObjectContext *usersContext = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSPrivateQueueConcurrencyType];
        usersContext.persistentStoreCoordinator = _psc;
        NSUInteger iUsers = 1;
        for(User *u in users) {
            [self addUser:u toStore:store withContext:usersContext];
            if(0 == (iUsers % batchSize)) {
                userSuccess = [usersContext save:&localError];
                if (userSuccess) {
                    [usersContext reset];
                }
                else {
                    NSLog(@"Error saving during seed (User): %@", localError);
                    break;
                }
            }

            iUsers++;
        }

        if ([usersContext hasChanges]) {
            userSuccess = [usersContext save:&localError];
            [usersContext reset];
        }

        // Result

        success = foodSuccess && sportSuccess && dailySuccess && ingredientSuccess && activitySuccess && reportSuccess && userSuccess;

    } else {
        success = NO;
        NSLog(@"Error adding seed store: %@", localError);
    }

    if (NO == success) {
        if (localError  && (error != NULL)) {
            *error = localError;
        }
    }

    return success;
}

    - (void)addFood:(Food *)food toStore:(NSPersistentStore *)store withContext:(NSManagedObjectContext *)moc
{
    NSEntityDescription *entity = [food entity];
    Food *newFood = [[Food alloc] initWithEntity:entity insertIntoManagedObjectContext:moc];

    newFood.alcol = food.alcol;
    newFood.amid = food.amid;
    newFood.bookmark = food.bookmark;
    newFood.calcium = food.calcium;
    newFood.cho = food.cho;
    newFood.cholesterol = food.cholesterol;
    newFood.complex = food.complex;
    newFood.copper = food.copper;
    newFood.dirty = food.dirty;
    newFood.edible = food.edible;
    newFood.fat = food.fat;
    newFood.fatMono = food.fatMono;
    newFood.fatPoli = food.fatPoli;
    newFood.fatSat = food.fatSat;
    newFood.fibre = food.fibre;
    newFood.iron = food.iron;
    newFood.kcal = food.kcal;
    newFood.lookback = food.lookback;
    newFood.magnesium = food.magnesium;
    newFood.name = food.name;
    newFood.note = food.note;
    newFood.phosphorus = food.phosphorus;
    newFood.potassium = food.potassium;
    newFood.pro = food.pro;
    newFood.recipe = food.recipe;
    newFood.recordUUID = (food.recordUUID == nil) ? [[[NSUUID alloc] init] UUIDString] : food.recordUUID;
    newFood.serving = food.serving;
    newFood.servingDesc = food.servingDesc;
    newFood.sodium = food.sodium;
    newFood.userAdd = food.userAdd;
    newFood.vitA = food.vitA;
    newFood.vitC = food.vitC;
    newFood.vitE = food.vitE;
    newFood.water = food.water;
    newFood.zinc = food.zinc;
    newFood.dosePeople = food.dosePeople;
    newFood.daily = food.daily;

    for(Ingredient *i in food.ingredients) {
        NSEntityDescription *entityIngredient = [i entity];
        Ingredient *newIngredient = [[Ingredient alloc] initWithEntity:entityIngredient insertIntoManagedObjectContext:moc];
        [newFood addIngredientsObject:newIngredient];
    }

    NSMutableSet *ing = [food mutableSetValueForKey:@"ingredient"];
    for(Ingredient *i in ing) {
        NSLog(@"%s Name: %@", __func__, i.food.name);

        NSEntityDescription *entityIngredient = [i entity];
        Ingredient *newIngredient = [[Ingredient alloc] initWithEntity:entityIngredient insertIntoManagedObjectContext:moc];
        [newFood addIngredientsObject:newIngredient];
    }

    [moc assignObject:newFood toPersistentStore:store];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T15:01:25.140

它可能是也可能不是您遇到错误的原因，但如果您使用它初始化 MOC，`NSPrivateQueueConcurrencyType`则应严格通过`-performBlock:`and访问它`-performBlockAndWait:`。请参阅此相关[问题](https://stackoverflow.com/questions/8637921/core-datas-nsprivatequeueconcurrencytype-and-sharing-objects-between-threads)。

# javascript - jQuery-ui 效果/动画延迟启动

> ID：12940816
> 
> 赞同：0
> 
> 时间：2012-10-17T18:23:16.077
> 
> 标签：javascript, jquery, css, jquery-ui

```
$div.hide("slide", {direction: "right"}, 1000, function() {

 }) 
```

代码很简单，但是 $div 里面有很多东西（表格、div 的负载、图像、SVG），之后开始动画需要一些时间（我的 PC 上大约 0.5 秒，iPad3 上大约 1 秒）它被触发了，但是一旦触发它就会很好地流动。

任何人都知道有什么方法可以改善这一点吗？也许某种方式来设置我的 div 的样式以改善动画？现在我的 div 使用：

```
postion: absolute;
top: 0;
right: 0;
left: 0;
bottom: 0; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T18:45:36.203

尝试这个：

```
{position:absolute;
top:0px;
left:0px;
min-width:100px;
min-height:100px;
} 
```

# windows - Windows Azure sdk 1.7，CloudTableClient 缺少 GetTableReference 函数

> ID：12940819
> 
> 赞同：6
> 
> 时间：2012-10-17T18:23:23.010
> 
> 标签：windows, azure

把我的头撞在墙上试图弄清楚为什么我错过了这个功能。

`CloudTableClient`不见了_`GetTableReference`

```
var tableClient = new CloudTableClient(baseAddress, credentials) {Timeout = new TimeSpan(0, 0, 0, 30)};
tableClient.GetTableReference("table1"); 
```

不会出现在 IntelliSense 或对象浏览器中。

:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T19:12:13.000

GetTableRefenrece 是 Azure SDK **1.7.1**的一部分，目前仅在[GitHub](https://github.com/WindowsAzure/azure-sdk-for-net/blob/sdk_1.7.1/microsoft-azure-api/StorageClient/CloudTableClient.cs)中可用。只有 v. 1.7.0 可通过 NuGET / WebPI 安装程序获得。此方法返回[CloudTable](https://github.com/WindowsAzure/azure-sdk-for-net/blob/sdk_1.7.1/microsoft-azure-api/StorageClient/CloudTable.cs)的一个实例，它也是 Azure SDK **1.7.1**的一部分。

如果您想使用它，您必须下载源代码并自行构建。下载和构建 Azure SDK 的官方源代码并不可怕。我个人是为一个项目做的，因为我需要一些旧 SDK 中不存在的功能。

# gxt - 如何向 Gxt HtmlEditor 添加按钮

> ID：12940823
> 
> 赞同：0
> 
> 时间：2012-10-17T18:23:51.897
> 
> 标签：gxt, html-editor

有人知道在不使用的情况下添加按钮的`Toolbar`方法`HtmlEditor`吗`JSNI`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T07:11:15.093

在您的字符串中使用简单的 html 输入代码并设置为内部 html

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-18T13:38:44.730

尝试这个

```
htmlEditor.setValue("<br/><button type='button'>Click Me!</button>"); 
```

# iphone - 我可以访问我自己的 iPhone 的实时位置信息吗？

> ID：12940824
> 
> 赞同：1
> 
> 时间：2012-10-17T18:24:00.833
> 
> 标签：iphone, ios, location

Apple 的“查找我的朋友”和“查找我的手机”应用程序可以持续访问我手机的位置。我可以以某种方式访问​​它吗？

我知道有一些方法可以获得我去过的地方的历史，但我正在寻找关于我**现在**在哪里的实时信息。“查找我的手机”在 Web 应用程序中有位置数据，那么某处是否存在手机到 Web 类型的提要？

# android - 如何杀死Android应用程序启动的logcat进程？

> ID：12940827
> 
> 赞同：4
> 
> 时间：2012-10-17T18:24:07.237
> 
> 标签：android, process

我有 Android 应用程序，它在服务启动时实现了以下代码：

```
...
Process process = Runtime.getRuntime().exec("logcat -v time -s " + arg);
BufferedReader bufferedReader = new BufferedReader(
                new InputStreamReader(process.getInputStream()));
... 
```

如您所见，我启动 logcat 进程以侦听日志。不幸的是，停止服务不会停止 logcat 并且在几次启动后我得到：

```
app_125   4782  144   137124 30584 ffffffff 00000000 S com.wefi.agnt.ui
app_125   4796  4782  1028   592   ffffffff 00000000 S logcat
app_125   4839  4782  1076   640   ffffffff 00000000 S logcat
app_125   4842  4782  952    516   ffffffff 00000000 S logcat
app_125   4845  4782  896    460   ffffffff 00000000 S logcat
app_125   4848  4782  900    464   ffffffff 00000000 S logcat
app_125   4851  4782  876    440   ffffffff 00000000 S logcat
shell     4852  171   788    336   c00cc7e4 afd0c78c S /system/bin/sh
shell     4853  4852  944    332   00000000 afd0b83c R ps
app_123   11189 144   114484 18908 ffffffff 00000000 S com.mspot.android.moviesClub.att 
```

... logcat 进程列表。我怎么能杀了他们？

有任何想法吗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T18:54:43.337

由于您拥有`Process`实例的句柄，因此您应该可以`process.destroy()`在停止服务时使用。Logcat 进程独立于您的应用程序运行，因此它们将在您的应用程序`Service`停止运行后继续运行，除非您终止它们。

如果您只是想在测试应用程序时清理设备上的进程，您可以运行`adb shell`以在设备上获取 shell 提示，然后使用`kill <PID>`来终止进程。

**编辑**：

该`Process`文档还指定您应该使用它`ProcessBuilder`来设置和运行该过程：

```
ProcessBuilder pb = new ProcessBuilder("logcat", "-v", "time", "-s", arg);
pb.redirectErrorStream(true);
Process process = pb.start();
... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-04-12T08:51:22.327

首先要启动 adb logging，创建一个进程：

```
 String cmd1 = "logcat -v time -f" + filename.getAbsolutePath();
 Process logcat = Runtime.getRuntime().exec(cmd1); 
```

在此之后，每当您想停止 adb 更新以写入文件时，只需调用：

```
 String cmd = "logcat -c";
    try {
        logcat.destroy();
        logcat = Runtime.getRuntime().exec(cmd);
    } catch (IOException e) {
        e.printStackTrace();
    } 
```

这将破坏之前的构建过程，并清除之前记录的所有 adb 日志。因此，当您再次启动 adb 日志记录时，它将从同一时间开始，而不会添加先前日志中的重复值。

# java - 用于 JavaScript 的类 Java 库/框架

> ID：12940829
> 
> 赞同：0
> 
> 时间：2012-10-17T18:24:09.623
> 
> 标签：java, javascript, oop, frameworks

我喜欢 Java 的工作方式，特别是关键字的隐式作用域`this`（对 JavaScript 的绝对讨厌）、命名空间、非原型继​​承，以及 JavaScript 几乎没有的所有功能。

是否有任何框架可以减轻对诸如`Function.prototype.x.call`, `function.bind`,之类的冗长语句的需求`var that = this;`，即使它只是实现它们但将其隐藏。最好是可以与 jQuery 集成的东西，因为它具有彻底的跨浏览器、rubust 抽象接口。允许以主流 OOP 风格编写的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T18:32:43.257

试试[Haxe](http://www.haxe.org)，它很像 Java，可以编译 JavaScript 代码。“编译”是指它获取您的 Haxe 源代码并将其转换为 JavaScript 程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T18:25:33.623

那么你可以使用[ExtJS 框架](http://docs.sencha.com/ext-js/4-1/)。ExtJS 提供 MVC 模型来构建 UI。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-17T18:29:25.780

Google Web Toolkit 可让您编写 Java 并编译为 JavaScript。请参阅[https://developers.google.com/web-toolkit/](https://developers.google.com/web-toolkit/)

# ios - 推荐的替代 webkit 用于 iOS 上的服务器发送事件

> ID：12940831
> 
> 赞同：6
> 
> 时间：2012-10-17T18:24:20.460
> 
> 标签：ios, webkit, nsurlconnection, long-polling, server-sent-events

我想在我的原生 iOS 应用程序中接收服务器发送的事件，但我没有使用 webkit/Safari。根据我的发现， NSURLConnection 不适合，因为它会[分块 response](https://stackoverflow.com/questions/1120606/long-polling-with-nsurlconnectio%20n)。我还查看了[ZTWebSocket](https://github.com/esad/zimt/blob/master/src/ZTWebSocket.m)库（显然很好，但我正在寻找 SSE，而不是 Web 套接字）。CocoaAsyncSocket[合适](https://github.com/robbiehanson/CocoaAsyncSocket)吗？还是仅限于纯 TCP Socket 通信？

我偷偷怀疑我遗漏了一些明显的东西，或者已经有一个图书馆或样本。提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T19:40:07.373

SSE 是一种 HTTP 技术，因为它绑定到一个开放的 HTTP 连接。CocoaAsyncSocket 是原始 TCP/UDP 套接字，对 HTTP 一无所知。所以不，正如您所怀疑的那样，CocoaAsyncSocket 不会给您 SSE。

我不知道 SSE 的任何独立实现（本着独立 Websocket 实现的精神），这可能是您正在寻找的。但我也不知道这是否有意义，因为据我所知，SSE 以 DOM 事件的形式发送消息，这在 HTML 的上下文中是最明智的。

如果您想要实现的只是向您的 iOS 应用程序发送消息，并且您可以自由选择技术，那么原始套接字就可以了。但是 Websockets 更有可能满足您的需求，这取决于您想要什么。看看[SocketRocket](https://github.com/square/SocketRocket)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-24T23:17:25.203

在对此进行了更多研究之后，我认为在没有 WebKit 的情况下在 iOS 上实现服务器发送事件的最佳方法是使用自定义的 NSConnection/NSRequest 工具集。我选择了[ASIHTTPRequest](https://github.com/pokeb/asi-http-request)。该库允许您显式控制连接对象上的持久性属性（基本），控制通过流接收的数据，存储响应（例如在本地文件中）等。

更不用说它在网络领域包含许多其他方便的扩展/自定义（改进的可达性观察器，用于异步的简化 API，排队功能，甚至能够加载整个网页（CSS、js 和所有）。

在服务器端，我使用 cyclone-sse (tornado) 和 nginx (作为反向代理)。非常令人兴奋，现在我可以看到我的 SSE 同时推送到我的 iOS 模拟器和浏览器订阅者。Cyclone 甚至可以处理所有连接，并为我提供了一个 API，它支持简单的 POST 消息推送（也支持 AMQP 和 Redit）......

长话短说，ASIHTTPRequest 对我来说是一个完美的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-28T13:53:10.913

试试这个用 Swift 编写的简单库： [https ://github.com/hamin/eventsource.swift](https://github.com/hamin/eventsource.swift)

API 超级简单。它现在使用 NSURLConnection。

# php - MongoDB 中的 $ 或运算符 (PHP)

> ID：12940833
> 
> 赞同：2
> 
> 时间：2012-10-17T18:24:28.890
> 
> 标签：php, mongodb, mongodb-query, nosql

嘿伙计们，我想通过**$or** -Operator 搜索文档...起初我要插入 3 个文档：

```
$aDocument = array(
    'id' => 1,
    'name' => 'WinZIP',
    'shorttext' => 'ZIP / UNZIP Programm' );

$oCollection->insert( $aDocument );

$aDocument = array(
    'id' => 2,
    'name' => 'WinRar',
    'shorttext' => 'ZIP / UNZIP Programm mit RAR-Unterstützung' );

$oCollection->insert( $aDocument );

$aDocument = array(
    'id' => 3,
    'name' => '7zip',
    'shorttext' => 'ZIP / UNZIP Programm mit RAR- und 7z-Unterstützung' );

$oCollection->insert( $aDocument ); 
```

然后我为我的查询创建一个正则表达式：

```
$oSearchRegex = new MongoRegex( "/zip/i" ); 
```

现在我想在 'name' 或 'shorttext' 中搜索字符串 'zip'... 应该是这样的：

```
$oCursor = $oCollection->find( array( '$or' => array( array( 'name' => $oSearchRegex ), array( 'shorttext' => $oSearchRegex ) ) ) ); 
```

但这不起作用......当我只在一个索引中搜索时，它工作得非常好......示例：

```
$oCursor = $oCollection->find( array( 'name' => $oSearchRegex ) ); 
```

有什么解决办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T19:01:51.307

正如你所说，你有`1.4.4 MongoDB`版本但`"or" operator was included only from version 1.7.x`更高版本

# jquery - Jquery hide 不适用于持续时间

> ID：12940834
> 
> 赞同：0
> 
> 时间：2012-10-17T18:24:33.080
> 
> 标签：jquery, hide

我在 svg 元素上使用 jquery 的隐藏功能，除非我尝试指定持续时间，否则它工作正常：

```
// Hide the object: works fine
$('#id').hide()

// Doesn't work with time specified in any of these attempts including fadeout
$('#id').hide('slow')
$('#id').hide(400)
$('#id').hide(400, function() {console.log('done')})
$('#id').fadeOut()
$('#id').fadeOut(400) 
```

编辑：这是控制台显示的内容：

```
// Works
$('#HTI2010').hide()
[
<circle cx=​"50" cy=​"450" id=​"HTI2010" r=​"10" class=​"c2010" title style=​"display:​ none;​ ">​&lt;/circle>​
]

// Doesn't work: display is set to in-line instead of none:  is there an argument I can alter to change this?

$('#HTI2010').hide(400)
[
<circle cx=​"50" cy=​"450" id=​"HTI2010" r=​"10" class=​"c2010" title style=​"display:​ inline;​ ">​&lt;/circle>​
] 
```

对于这些，对象保留在屏幕上。我错过了什么吗？谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-09-21T06:00:11.047

试试这个：

```
var duration = 400;

$('#id').hide(duration); 
```

# objective-c - 使用iOS api从北方获取角度

> ID：12940836
> 
> 赞同：0
> 
> 时间：2012-10-17T18:24:40.023
> 
> 标签：objective-c, ios, math, geolocation, gps

这是我想要的：

[http://postimage.org/image/9pq8m79hx/](http://postimage.org/image/9pq8m79hx/)

我知道 O 点和 X 点的坐标。是否有可能使用 iOS 方法找到 V 角（从北方向的角度）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T18:28:07.463

是的。

```
#import <math.h>

float a = -1 * atan2(y1 - y0, x1 - x0);
if (a >= 0) {
    a += M_PI / 2;
} else if (a < 0 && a >= -M_PI / 2) {
    a += M_PI / 2;
} else {
    a += 2 * M_PI + M_PI / 2;
}
if (a > 2 * M_PI) a -= 2 * M_PI; 
```

现在`a`将在区间中包含以弧度为单位的角度`0...2 PI`。

甚至不需要任何 iOS 特定的 API。请记住：iOS 仍然具有 libc 的所有功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-05-30T13:22:14.933

不确定user529758的回答是否解决了这个问题，我读到的是将东更改为0度，将北更改为0度。下面的代码有效 - 关键线是第 4 行，从东到北变化 0 度

```
-(CGFloat) bearingFromNorthBetweenStartPoint: (CGPoint)startPoint andEndPoint:(CGPoint) endPoint {

// get origin point of the Vector
CGPoint origin = CGPointMake(endPoint.x - startPoint.x, endPoint.y - startPoint.y);

// get bearing in radians
CGFloat bearingInRadians = atan2f(origin.y, origin.x);

// convert to bearing in radians to degrees
CGFloat bearingInDegrees = bearingInRadians * (180.0 / M_PI);

// convert the bearing so that it takes from North as 0 / 360 degrees, rather than from East as 0 degrees
bearingInDegrees = 90 + bearingInDegrees;

// debug comments:
if (bearingInDegrees >= 0)
{
    NSLog(@"Bearing >=0 in Degrees %.1f degrees", bearingInDegrees );
}

else
{
    bearingInDegrees = 360 + bearingInDegrees;
    NSLog(@"Bearing in Degrees %.1f degrees", bearingInDegrees );
}

return bearingInDegrees;

} 
```

# javascript - Google Maps v3：无法获取属性“setMap”的值

> ID：12940841
> 
> 赞同：0
> 
> 时间：2012-10-17T18:24:52.913
> 
> 标签：javascript, google-maps, google-maps-api-3

我是谷歌地图的新手。我将 Google Maps v3 地图添加到 ASP.NET 4.0 项目中的 aspx 文件中，并尝试为地图上的四个 KML 图层添加切换复选框。

但是，当我单击复选框时，我收到此错误：“Microsoft JScript 运行时错误：无法获取属性 'setMap' 的值：对象为空或未定义”。谢谢！

这是HTML：

```
<body onload="initialize()">    
        <div id="map-canvas" style="width:100%; height:90%;"></div>
        <div id="legend">
            <div class="column">
                <input type="checkbox" id="landmarksLayer" onclick="toggleKMLLayer(this,'Notable Locations');" checked="checked" />Notable Locations (<img alt="yellow dot" src="Images/GoogleMaps/yellow-dot.png" />)
            </div>
        </div>
    </body> 
```

这是Javascript：

```
 <%--Javascript--%>
    <script type="text/JavaScript" src="http://maps.googleapis.com/maps/api/js?key=[I_Removed_My_Key]&sensor=false"></script>

    <script type="text/javascript">

        var infowindow = new google.maps.InfoWindow({ "maxWidth": 100 });

        var map;

        var landmarksLayer;
        var publicArtLayer;
        var blueEmergencyPhonesLayer;
        var buildingsLayer;

        //toggle
        function toggleKMLLayer(chkbox, kmlLayerID) {

            //window.alert(kmlLayerID);

            if (chkbox.checked) {
                //window.alert("checked");
                landmarksLayer.setMap(map);
            }
            else {
                //window.alert("unchecked");
                landmarksLayer.setMap(null);
            }
        }

        function initialize() {

            var mapOptions = {
                center: new google.maps.LatLng(33.585737, -101.884804),
                zoom: 15,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };

            map = new google.maps.Map(document.getElementById("map-canvas"), mapOptions);

            var kmlLayerOptions = {
                preserveViewport: true,
                suppressInfoWindows: true
            };

            var landmarksLayer = new google.maps.KmlLayer('http://www.ttu.edu/map/points/landmarks.xml', kmlLayerOptions);
            landmarksLayer.setMap(map);

            var publicArtLayer = new google.maps.KmlLayer('http://www.ttu.edu/map/points/art.xml', kmlLayerOptions);
            publicArtLayer.setMap(map);

            var blueEmergencyPhonesLayer = new google.maps.KmlLayer('http://www.ttu.edu/map/points/emergency.xml', kmlLayerOptions);
            blueEmergencyPhonesLayer.setMap(map);

            var buildingsLayer = new google.maps.KmlLayer('http://www.ttu.edu/map/points/bldgs.xml', kmlLayerOptions);
            buildingsLayer.setMap(map);

            addKmlClickHandler(landmarksLayer);
            addKmlClickHandler(publicArtLayer);
            addKmlClickHandler(blueEmergencyPhonesLayer);
            addKmlClickHandler(buildingsLayer);
        }

        // create a new info window for the KML (outage) layer and the geo-coded house marker
        function addKmlClickHandler(KmlLayer) {
            google.maps.event.addListener(KmlLayer, "click", function (event) {
                infowindow.close();
                infowindow.setOptions({
                    pixelOffset: event.pixelOffset,
                    content: event.featureData.infoWindowHtml,
                    position: event.latLng
                });
                infowindow.open(map);
            });
        }

    </script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T18:49:03.890

您正在为图层创建全局变量：

```
 var landmarksLayer;
    var publicArtLayer;
    var blueEmergencyPhonesLayer;
    var buildingsLayer; 
```

但你没有使用它们（在你的初始化函数中）：

```
 var landmarksLayer = new google.maps.KmlLayer('http://www.ttu.edu/map/points/landmarks.xml', kmlLayerOptions);
    landmarksLayer.setMap(map);

    var publicArtLayer = new google.maps.KmlLayer('http://www.ttu.edu/map/points/art.xml', kmlLayerOptions);
    publicArtLayer.setMap(map);

    var blueEmergencyPhonesLayer = new google.maps.KmlLayer('http://www.ttu.edu/map/points/emergency.xml', kmlLayerOptions);
    blueEmergencyPhonesLayer.setMap(map);

    var buildingsLayer = new google.maps.KmlLayer('http://www.ttu.edu/map/points/bldgs.xml', kmlLayerOptions);
    buildingsLayer.setMap(map); 
```

变量前面的“var”创建了一个新版本的变量，它是初始化函数的本地变量，而全局版本未初始化。您需要初始化全局版本，以便可以在 HTML 单击侦听器（在全局上下文中执行）中使用它。

# sql - SQL 连接和连接行

> ID：12940843
> 
> 赞同：1
> 
> 时间：2012-10-17T18:24:59.640
> 
> 标签：sql, sql-server

我有两个表之间的多对多关系。

表`God_Restaurants`包含我的餐厅。

表`God_RestaurantKat`包含不同的类别。

表`God_RestKatReference`包含两列，每列包含两个表的 id。

以下语句是我能想到的，但没有给我想要的输出。

```
DECLARE @Names VARCHAR(8000) 
SELECT DISTINCT R.RestaurantID as Restaurantid, 
                R.RestaurantName as Restaurantname, 
                K.RestaurantKatName as RestKatName 
FROM God_Restaurants R 
LEFT JOIN God_RestKatReference as GodR ON R.RestaurantId = Godr.RestaurantId 
LEFT JOIN God_RestaurantKat as K ON GodR.RestaurantKatId = K.RestaurantKatId 
WHERE R.RestaurantPostal = 7800 
```

我希望输出是有关餐厅的信息，并在最后一列中是串联的类别行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T18:32:54.313

要连接值，您可以使用`for xml path('')`. 有错误的 xml 路径解决方案，您应该使用`value`and`type`用于特殊字符。

```
declare @Temp table (id int, Name nvarchar(max))
declare @date datetime
declare @i int

insert into @Temp
select 1, 'asasd' union all
select 1, 'sdsdf' union all
select 2, 'asdad' union all
select 3, 'asd<a?>&sdasasd' union all
select 3, 'fdgdfg'

select @i = 1
while @i < 9
begin
    insert into @Temp
    select id, Name from @Temp

    select @i = @i + 1
end

select count(*) from @Temp

select @date = getdate()

select
    A.id,
    stuff((select ', ' + TT.Name from @Temp as TT where TT.id = A.id for xml path(''), type).value('.', 'nvarchar(max)'), 1, 2, '') as Names
from @Temp as A
group by A.id

select datediff(ms, @date, getdate())

select @date = getdate()

select distinct
    A.id,
    stuff((select ', ' + TT.Name from @Temp as TT where TT.id = A.id for xml path(''), type).value('.', 'nvarchar(max)'), 1, 2, '') as Names
from @Temp as A

select datediff(ms, @date, getdate()) 
```

您也可以使用可变解决方案

```
declare @temp nvarchar(max)

select @temp = isnull(@temp + ', ', '') + str
from (select '1' as str union select '2' as str union select '3' as str) as A

select @temp 
```

# macos - 相同的代码，相同的 SDK，相同的 LIBSDL 版本，相同的 GCC 版本具有不同的结果（PPC 与 Intel）

> ID：12940844
> 
> 赞同：1
> 
> 时间：2012-10-17T18:25:15.093
> 
> 标签：macos, cocoa, sdl, 32bit-64bit

我已经使用 Leopard 为 Powerbook G4 编译了 BlueMSX，使用 10.5 和 10.4 SDK 就好了。然后，我使用了相同的源代码和 makefile，并在运行 Lion 的 Intel Mac 上进行了尝试。只调整了生成文件以指向新的 SDK，一切都恢复正常了。但是，当运行模拟器时，所有颜色都完全错误，声音也被破坏了。

我唯一怀疑的是，SDL 上的某些数据类型大小可能会有所不同，从 32 位到 64 位。有没有类似的东西？

# c++ - 获取 GDB 便利变量中保存的值的符号信息

> ID：12940845
> 
> 赞同：7
> 
> 时间：2012-10-17T18:25:15.503
> 
> 标签：c++, c, debugging, gdb

我经常发现在调试程序并获取遇到的任何正确对齐的指针大小的值的符号时，遍历堆栈很有用。我已经厌倦了手动执行此操作，因此我尝试编写一个为我执行此操作的命令。问题是“信息符号”似乎不喜欢在通过指针取消引用设置其参数时使用便利变量作为其参数。IE：

```
(gdb) info symbol 0xb6ca4d28
[Useful Symbol Information]
(gdb) set $pointer = $esp
(gdb) while ( *(int*)$pointer != 0xb6ca4d28)
 >set $pointer += 4
 >end
(gdb) x/x $pointer
0x6ebee064:     0xb6ca4d28
(gdb) set $dereferencePointer = *(int *)$pointer
(gdb) p/x $dereferencePointer
$103 = 0xb6ca4d28
(gdb) info symbol $dereferencePointer
No symbol matches $dereferencePointer.
(gdb) set $dereferencePointer = 0xb6ca4d28
(gdb) p/x $dereferencePointer
$104 = 0xb6ca4d28
(gdb) info symbol $dereferencePointer
[Useful symbol information]
(gdb) 
```

为什么是这样？这是一个错误吗？有不同的方法可以做到这一点吗？

谢谢！

卢克

PS：使用香草 GDB 7.5

**从列表更新：**

这很可能是一个错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T18:44:27.553

不管有没有错误，我建议将 /a 格式说明符与 p 和 x 命令一起使用。这总是对我有用，而且打字也更快。

# java - 如何在java中随机打开迷宫线

> ID：12940846
> 
> 赞同：0
> 
> 时间：2012-10-17T18:25:18.513
> 
> 标签：java, recursion, maze

我正在做一个迷宫，我想使用[这里](http://en.wikipedia.org/wiki/Maze_generation_algorithm#Recursive_division_method "迷宫递归除法")定义的递归方法。但是，我需要一些关于如何在随机绘制线条后随机打开线条的帮助。现在我正在创建线条（迷宫的墙壁），只需用它们的开始和结束 x 和 y 坐标绘制它们。我似乎无法找到一种简单的方法来“擦除”（或“打开”）部分线条。

编辑：好的，我需要稍微具体一点。我怎么能随机选择*每条*线上的地方“打开”？

编辑2：这是我正在尝试做的一些代码：

```
public static void draw() {
    // picks a random spot in the rectangle
    Random r = new Random();
    int x0 = r.nextInt(w)
    int y0 = r.nextInt(h)

    // draws the 4 lines that are perpendicular to each other and meet
    // at the selected point
    StdDraw.line(x0, 0, x0, y0);
    StdDraw.line(0, y0, x0, y0);
    StdDraw.line(x0, h, x0, y0);
    StdDraw.line(w, y0, x0, y0);
}

public static void main(String[] args) {   
    // set up the walls of the maze
    // given w = width and h = height
    StdDraw.setXscale(0, w);
    StdDraw.setYscale(0, h);

    StdDraw.line(0, 0, 0, h);
    StdDraw.line(0, h, w, h);
    StdDraw.line(w, h, w, 0);
    StdDraw.line(w, 0, 0, 0);

    draw();
} 
```

现在我只需要弄清楚如何随机选择其中 3 行，并为每行随机擦除一部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T18:31:31.553

假设您正在使用`swing`和`paintComponent`方法，您可以将`Graphic`' 颜色设置为背景颜色并再次绘制线条。这是一个例子：

```
public class DrawTest extends JPanel{
    public static void main(String[] args)
    {

        final JFrame frame = new JFrame();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.add(new DrawTest());
        frame.pack();
        frame.setLocationRelativeTo(null);
        frame.setVisible(true);
    }

    public Dimension getPreferredSize(){
        return new Dimension(400,300);
    }

    public void paintComponent(Graphics g){
        super.paintComponent(g);
        g.setColor(Color.black);
        g.drawLine(10, 10, 100, 10);
        g.setColor(getBackground());
        g.drawLine(50, 10, 60, 10);
    }
} 
```

**编辑**

我想你没有在`paintComponent`方法中创建迷宫（或者每次重新绘制时你都会得到一个新的迷宫）。因此，我建议创建一个类似于下面的子类并将其实例存储在`ArrayList`主类的字段中。`ArrayList`然后你可以在你喘气的时候遍历你的。

```
public static class MazeWall{
    public static final int OpeningWidth = 10;

    Point start;
    Point end;
    Point opening;

    public MazeWall(Point start, Point end, boolean hasOpening){
        this.start = start;
        this.end = end;

        if(hasOpening){
            int range;
            if(start.x == end.x){
                range = end.x - start.x - OpeningWidth;
                int location = (int)(Math.random() * range + start.x);
                opening = new Point(location, start.y);
            } else{
                range = end.y - start.y - OpeningWidth;
                int location = (int)(Math.random() * range + start.y);
                opening = new Point(location, start.x);
            }
        }   
    }
} 
```

# javascript - 如何获取下一个 span 元素的文本？

> ID：12940847
> 
> 赞同：1
> 
> 时间：2012-10-17T18:25:21.463
> 
> 标签：javascript, jquery

下面是我的 HTML。我在`<select>`元素处，如何从页面上的下一个 span 元素中获取文本？我已经尝试了几件事，包括我的选择元素`$( this ).nextAll( 'span:first' ).text();`在哪里`$( this )`，但我没有得到想要的结果。

```
<ul id="questions">
   <div>What do you want information about?</div>
   <li>
      <p>
         <select><!-- This is where I'm at. -->
            <option>Click to select...</option>
            <option data-next_select_name="foos">
               a foo
            </option>
            <option data-next_select_name="bars">
               a bar
            </option>
         </select>
      </p>
      <div>
         <a>
            <span>a foo</span><!-- I want the text out of this span. -->
            <div><b></b></div>
         </a>
         <div>
            <div><input type="text" /></div>
            <ul>
               <li>Click to select...</li>
               <li>
                  a foo
               </li>
               <li>
                  a bar
               </li>
            </ul>
         </div>
      </div>
      <p></p>
   </li>
</ul> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T18:27:56.187

`nextAll`选择元素的下一个兄弟元素， span 元素不是您的选择元素的兄弟元素之一：

```
$(this).parent().next().find('span:first').text() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-17T18:30:58.137

只是以防你的 html 结构发生变化并且`.next()`不是一个选项，我总是更喜欢去确定的父级（在这种情况下是列表项）

```
$(this).closest('li')
       .find('span').first().text(); 
```

随机旁注：`.first()`比`:first`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T18:29:08.417

```
$( this ).parent().next().find('span:first').text() 
```

# java - 让 Spring MVC 应用程序在 Apache 下运行

> ID：12940850
> 
> 赞同：2
> 
> 时间：2012-10-17T18:25:40.947
> 
> 标签：java, apache, tomcat, spring-mvc

我在 Microsoft 堆栈中工作了很多年，我的公司被一家 Java 商店收购，在接下来的一年里，当我维护旧代码而公司将人们转移到他们的系统时，我将学习 Java，但我需要一点指导：

该公司使用 SpringSource 进行基于 MVC 的开发。我喜欢了解事物的基础结构，帮助我了解大局，了解一切到底是如何真正相关的。多年来，我在 Apache 上做了很多工作（但不是在 Java 上），所以我试图弄清楚在 Apache 上运行 Spring MVC Web 应用程序需要什么？

只是用 Tomcat 设置 Apache，然后将应用程序安装到 Tomcat 中吗？或者还有更多？我看了一点 SpringSource 的信息，但这一切都假设我还没有知识水平，所以我只是想弄清楚要开始。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T19:40:50.017

您将 Tomcat 配置为运行 Spring 应用程序（通过配置 web.xml），然后将 Tomcat 配置为使用 mod-jk 与 Apache 连接。您必须设置 apache 配置文件以了解 mod-jk，并配置 mod-jk.conf（参见：http: [//tomcat.apache.org/connectors-doc/webserver_howto/apache.html](http://tomcat.apache.org/connectors-doc/webserver_howto/apache.html)）

# regex - 在正则表达式中转义管道（“|”）

> ID：12940851
> 
> 赞同：14
> 
> 时间：2012-10-17T18:25:42.010
> 
> 标签：regex, r

我需要拆分单词和结束标记（某些类型的标点符号）。奇怪的管道（“|”）可以算作结束标记。在我尝试添加管道之前，我已经在结束标记上编写了代码。添加管道使`strsplit`每个字符。逃避它会导致错误。如何在正则表达式中包含管道？

```
x <- "I like the dog|."

strsplit(x, "[[:space:]]|(?=[.!?*-])", perl=TRUE)
#[[1]]
#[1] "I"    "like" "the"  "dog|" "."   

strsplit(x, "[[:space:]]|(?=[.!?*-\|])", perl=TRUE)
#Error: '\|' is an unrecognized escape in character string starting "[[:space:]]|(?=[.!?*-\|" 
```

我想要的结果：

```
#[[1]]
#[1] "I"    "like" "the"  "dog"  "|"  "."  #pipe is an element 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-10-17T18:44:59.137

解决此问题的一种方法是使用`\Q...\E`符号来删除`...`. 正如它所说`?regex`：

> 如果要从字符序列中删除特殊含义，可以将它们放在“\Q”和“\E”之间。这与 Perl 的不同之处在于 '$' 和 '@' 在 PCRE 中的 '\Q...\E' 序列中作为文字处理，而在 Perl 中，'$' 和 '@' 会导致变量插值。

例如：

```
> strsplit(x, "[[:space:]]|(?=[\\Q.!?*-|\\E])", perl=TRUE)
[[1]]
[1] "I"    "like" "the"  "dog"  "|"    "." 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-10-17T18:35:20.343

问题实际上是您的连字符，它应该出现在[第一个或最后一个](https://stackoverflow.com/questions/9589074/regex-should-hyphens-be-escaped)：

```
strsplit(x, "[[:space:]]|(?=[|.!?*-])", perl=TRUE)
strsplit(x, "[[:space:]]|(?=[.|!?*-])", perl=TRUE)
strsplit(x, "[[:space:]]|(?=[.!|?*-])", perl=TRUE)
strsplit(x, "[[:space:]]|(?=[-|.!?*])", perl=TRUE) 
```

等等都应该给你你正在寻找的输出。

如果您愿意，也可以转义连字符，但请记住使用两个反斜杠！

```
strsplit(x, "[[:space:]]|(?=[.!?*\\-|])", perl=TRUE) 
```

# javascript - 在 IE9 中设置 currentTime

> ID：12940852
> 
> 赞同：0
> 
> 时间：2012-10-17T18:25:45.567
> 
> 标签：javascript, html, audio

我试图在从服务器流式传输音频 src 时设置 currentTime。在所有其他浏览器上，这都可以正常工作，但是在 IE9 上，当我设置 currentTime 并调用 play 时，它会跳回到开头。

```
this.playAtTime = function(aTime) {
    Debug("play at time audio: " + aTime);
    Debug("this.mAudioPlayer.currentTime: " + this.mAudioPlayer.currentTime);

     this.startTime = aTime;

    if (this.mAudioPlayer.src != this.mAudioSrc) {
        this.mAudioPlayer = new Audio();
        this.mAudioPlayer.src = this.mAudioSrc;
        this.mAudioPlayer.load();
        this.mAudioPlayer.play();
        this.mAudioPlayer.addEventListener('loadedmetadata', function(){ this.currentTime = aTime / 1000.0; }, false );
    }
    else if ((isChrome() || isMobileSafari()) && aTime == 0) {
        this.mAudioPlayer.load();
        this.mAudioPlayer.currentTime = aTime / 1000.0;
        this.mAudioPlayer.play();
        Debug("Reloading audio");
    }else{

        this.mAudioPlayer.currentTime = aTime / 1000.0;
        this.mAudioPlayer.play();
    }       
}; 
```

这不是缓冲问题，因为无论等待多长时间，它都不会在设置时间成功。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T18:33:17.827

尝试交换以下两行的位置：

```
this.mAudioPlayer.play();
this.mAudioPlayer.currentTime = aTime / 1000.0; 
```

# netbeans - 避免在 NetBeans 中覆盖文件

> ID：12940858
> 
> 赞同：0
> 
> 时间：2012-10-17T18:26:19.760
> 
> 标签：netbeans, ide

我喜欢 Netbeans，但有一个我不喜欢的“错误”或“做事方式”，我想知道是否可以做一些事情来纠正它：

设想

1.  我在 Netbeans 中编辑了一个 example.css 并保存。
2.  我在 Netbeans 之外编辑 example.css 并保存。
3.  我再次在 Netbeans 中编辑 example.css。

问题：#2 中的更改被覆盖。

你知道如何配置 Netbeans 在保存之前检查文件的更新吗？

你知道一个类似的 PHP IDE，它适用于类似于 Netbeans 的远程项目吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T18:32:14.097

在 NetBeans 中：我认为您应该`Source -> Scan for external`在保存之前执行。

我相信新版本`Auto Refresh`支持此功能（） 。`Eclipse`如果你想切换你的IDE，请从这里下载--> [**Eclipse for PHP Developers**](http://www.eclipse.org/downloads/packages/eclipse-php-developers/heliosr)。

您可能会找到配置`Eclipse`远程文件系统的步骤，请参阅[**远程系统资源管理器入门**](http://help.eclipse.org/indigo/index.jsp?topic=%2Forg.eclipse.rse.doc.user%2Fgettingstarted%2Fg_start.html)。

# javascript - JavaScript 推特不工作

> ID：12940859
> 
> 赞同：1
> 
> 时间：2012-10-17T18:26:22.490
> 
> 标签：javascript, jquery, twitter

我目前有一个计算器，可以生成输出。我目前正在尝试生成一个动态 twitter 按钮以及输出。我已经多次尝试让 twitter 按钮工作，但它要么显示为文本链接，要么根本不显示。下面的代码是我用过的。

**方法一**

```
 $.getScript("http://platform.twitter.com/widgets.js");
  var twit_link = $('<a/>', {
    href : 'https://www.twitter.com/share',
    'class' : 'twitter-share-button',
    url : 'http://www.twitter.com/obamamakes',
    'data-count' : 'none',
    'data-via' : 'ObamaMakes',
    'data-text' : 'In the time it takes me to ' + activity + ', Barack Obama makes $' + i.toFixed(1)
  }).text('Tweet');
 $("#CalcOutput").html( twit_link ); 
```

**方法二**

```
$("#CalcOutput-twitter").html("<a href=\"https://twitter.com/intent/tweet?source=webclient&text=\"" + encodeURIComponent(result) + "\" class=\"twitter-share-button-activity\" url=\"http://www.twitter.com/obamamakes\" data-count=\"none\" data-via=\"ObamaMakes\" data-text=\"In the time it takes me to " + activity + ", Barack Obama makes $" + i.toFixed(1) + "> <img src=\"IMAGES/twitter.jpg\" id=\"imgTweet\" alt=\"Tweet This\" width=\"50px\" height=\"30px\"></a>"); 
```

**方法三**

```
$("#CalcOutput-twitter").html("<a href=\"https://twitter.com/intent/tweet?source=webclient&text=\"" + encodeURIComponent(result) + "\" ><img src=\"IMAGES/twitter.jpg\" id=\"imgTweet\" alt=\"Tweet This\" width=\"50px\" height=\"30px\"></a>"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T18:29:34.613

因为您必须在页面上出现链接后加载 twitter 脚本。因此，请确保您编写的这段代码首先运行，其他明智的 twitters 脚本不会选择它。

含义：首先使用您的任何方法，然后运行此代码

```
$.getScript("http://platform.twitter.com/widgets.js"); 
```

**示例**：

```
var twit_link = $('<a/>', {
    href : 'https://www.twitter.com/share',
    'class' : 'twitter-share-button',
    url : 'http://www.twitter.com/obamamakes',
    'data-count' : 'none',
    'data-via' : 'ObamaMakes',
    'data-text' : 'In the time it takes me to ' + activity + ', Barack Obama makes $' + i.toFixed(1)
}).text('Tweet');
$("#CalcOutput").html( twit_link );
$.getScript("http://platform.twitter.com/widgets.js"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T18:42:15.003

如果您想在拉取 widgets.js 文件后加载脚本，那么您可能需要挂钩成功回调。

请参阅：[http](http://api.jquery.com/jQuery.getScript/) ://api.jquery.com/jQuery.getScript/了解更多信息

```
$.getScript("http://platform.twitter.com/widgets.js", function(script, textStatus, jqXHR) {
    var activity, i;
    activity = 0;
    i = 4.56;
    var twit_link = $('<a/>', {
        href: 'https://www.twitter.com/share',
        'class': 'twitter-share-button',
        url: 'http://www.twitter.com/obamamakes',
        'data-count': 'none',
        'data-via': 'ObamaMakes',
        'data-text': 'In the time it takes me to ' + activity + ', Barack Obama makes $' + i.toFixed(1)
    }).text('Tweet');
    $("#CalcOutput").html(twit_link);
});​ 
```

# sql - Doctrine2 dbal 缓存子查询

> ID：12940862
> 
> 赞同：2
> 
> 时间：2012-10-17T18:26:45.063
> 
> 标签：sql, symfony, doctrine-orm, dbal

我有一个非常昂贵的子查询，用于我的存储库中的多个查询。

我想找到一种方法来缓存该子查询并将其结果用于其他本机 sql 查询。

1.  我在 symfony2 项目中使用 Doctrine2 DBAL。
2.  由于子查询的复杂性，需要使用本机 SQL。

```
例子：

从（昂贵的子查询）中选择总和（体积）；

```

我一直在查看 Google 和 Doctrine2 文档，但在这里没有找到好的解决方案。

欢迎使用其他方法，保持在 Doctrine2、Symfony2、SQL 框架的范围内。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T05:41:58.923

你有很多选择。我的第一行是对 select 语句进行哈希处理以充当键并将结果存储在 memcached 或类似的东西中。然后在您的经理中运行查询之前。检查键/缓存是否存在。如果存在，请使用缓存结果。如果缓存不存在，请在长查询运行后创建它。此外，您可能希望集成缓存过期。

# javascript - JavaScript 上下碰撞

> ID：12940864
> 
> 赞同：1
> 
> 时间：2012-10-17T18:27:12.753
> 
> 标签：javascript, collision

我现在只需要你的帮助。我制作了一些碰撞系统，在左右碰撞时效果很好。但！我不知道如何制作顶部和底部。我很感激你在这里的帮助。

```
function collided(a, b) {
  if((((a['y'] + a['height']) >= b['y']) && ((a['y'] + a['height']) <= b['y'] + b['height'])) && (((a['x'] + a['width']) >= b['x']) && ((a['x'] + a['width']) <= (b['x'] + b['width']))))
    return 1;
  else if(((a['y'] + a['height']) >= (b['y'])) && ((a['y'] + a['height']) <= (b['y'] + b['height'])) && ((a['x'] == (b['x'] + b['width']))))
    return 2;
// i need help with this (top collision) and need some bottom collision
  else if((b['y'] < (a['y'] + a['height'] + 5)) && ((b['x']) < (a['x'] + a['width'])) && ((a['x']) < (b['x'] + b['width'])))
    return 3;
} 
```

所以**return 1**是从左边的碰撞（从**b**对象左边，就像停留的那个），2 是右边，3 是顶部，4 是底部。

# web-services - Microsoft Web 服务扩展 3：如果 SOAP 请求中缺少密码，自定义 UsernameTokenManager 不会引发错误

> ID：12940866
> 
> 赞同：1
> 
> 时间：2012-10-17T18:27:14.287
> 
> 标签：web-services, authentication, wse, wse3.0

我对自定义的`UsernameTokenManager`工作原理相当熟悉。如果客户端在 SOAP 请求中提供了用户名和密码，这一切都很好。如果客户端明确排除密码（`<wsse:Password>`标签），我希望框架会抛出相应的异常。不幸的是，网络服务调用照常进行。调试时，我可以看到我的自定义`UsernameTokenManager`正在被调用（方法`AuthenticateToken`）并返回正确的密码；但在那之后有些东西不起作用。有什么线索吗？

# hibernate - 内部连接条件 Hibernate

> ID：12940867
> 
> 赞同：2
> 
> 时间：2012-10-17T18:27:15.873
> 
> 标签：hibernate

我想要这个sql：

```
SELECT COUNT(*) FROM table1 t1, table2 t2 
WHERE t1.id > 0  
AND (( t1.name = 'foo') 
    OR ( t1.id2 = t2.id AND t1.name = 'det')) 
```

如果我为 table2 使用别名：

```
detachedCriteria.createAlias("table2", "t2"); 
```

并设置如下：

```
detachedCriteria.add(Restrictions.eqProperty("t1.id2", "t2.id")); 
```

Hibernate 总是在 SELECT 查询中生成我不想要的 INNER JOIN，这给了我错误的结果。

```
select count(*) as y0_ 
from
    table1 this_ 
inner join
    table2 table2_ 
        on this_.id2=table2_.id 
where 
... 
```

如何在 WHERE 子句（t1.id2 = t2.id）中实现“INNER JOIN”而不是在 SELECT 中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T18:32:25.137

使用 Criteria API，您不能。您只能从根实体查询并创建别名或子条件，以通过它们的关联导航到其他实体。使用此 API 无法同时从两个实体中进行选择。不过，可以使用 HQL。

# c++ - 有效地从数据文件中加载数字

> ID：12940869
> 
> 赞同：0
> 
> 时间：2012-10-17T18:27:18.750
> 
> 标签：c++, ifstream

我有以下最小的工作示例，它说明了我当前如何从数据文件“info.txt”中加载一组数字：

```
#include <iostream>
#include <fstream>
#include <vector>

using namespace std;

int main() {

double temp_var;
vector<double> container_var;

ifstream test("info.txt");

while(test>>temp_var)
{
    container_var.push_back(temp_var);
}

cout << container_var[0] << endl;
return 0;
} 
```

文件“info.txt”包含以下形式的整数

```
1.0
2.1
3.6
... 
```

我可能要加载 50.000-100.000 个数字（甚至更多），所以我有兴趣有效地做到这一点。在我的示例中是否有一些基本的东西可能会减慢加载过程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T18:31:21.510

如果您提前知道数字的数量，您可以告诉`std::vector`预分配空间。这将使`push_back`函数更有效。

其他优化技术包括*内存映射文件*和*双缓冲*。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T18:31:42.410

当您要向 std::vector 添加大量元素时，该向量将在您向其添加元素时增长。当向量增长时，通常需要将所有数据复制到新缓冲区，您可以告诉向量在添加大量元素之前保留大量空间，以降低增长和复制操作的数量：

```
std::vector<int> v(5000); 
```

以上将创建一个已包含 5000 个元素的向量（默认初始化）。您可以在构造后通过调用 std::vector::reserve() 保留更多空间：

```
std::vector<int> v;
v.reserve(10000); // ensure the vector has a capacity of at least 10k elements 
```

虽然我认为这是实际问题，但问题也可能出在一线`cout << container[0] << endl`。std::endl 刷新文件缓冲区，因此通常很慢。第三个原因可能是`std::cout`流与 C-stdio 文件 api 同步。在写入每个字符后，同步会强制 iostreams 库刷新。您可以通过以下方式禁用此同步：

```
std::cout.sync_with_stdio(false); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-17T21:35:47.747

首先，您需要读取您可以读取的数据..

一种。打开文件并从中读取

湾。分配内存 复制其中文件的内容

C。内存映射文件

根据文件的大小，我会说 c 是最好的选择，因为你避免了分配和复制数据的成本，而且它比从文件中读取要快得多。

其次，您需要明显地解析内容，最好的方法是手动循环，请参阅[http://tinodidriksen.com/2011/05/28/cpp-convert-string-to-double-speed/](http://tinodidriksen.com/2011/05/28/cpp-convert-string-to-double-speed/)了解更多详细信息。我自己确实尝试过，这是处理大文件的方法。

第三..您需要预先分配存储结果的缓冲区，以最大限度地减少分配。

当然，您需要测量性能..找到热点..消除它们...冲洗并重复。

# macos - 以编程方式将 OS X Dock 移动到其他显示器

> ID：12940870
> 
> 赞同：3
> 
> 时间：2012-10-17T18:27:19.480
> 
> 标签：macos, shell, applescript

我在 rMBP 上使用了 2 台外接显示器（一台通过 Thunderbolt/DVI，一台通过 HDMI）。笔记本电脑的盖子是合上的。**是否可以以编程**方式将 Dock 和菜单栏从一个显示器移动到另一个显示器（即使其成为主显示器）？

我使用[ControlPlane](http://www.controlplaneapp.com/)来检测某些情况，如果脚本（如 bash 或 AppleScript）发生情况，我想交换主监视器。

我查看了`com.apple.dock.plist`但没有找到任何我可以使用的密钥。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T20:17:04.147

[是的，您可以使用我在此处](http://www.hamsoftengineering.com/codeSharing/hmscreens/hmscreens.html)编写的命令行工具来做到这一点。有一个示例 applescript 向您展示如何使用它。

# java - Android getCacheDir() 中的文件何时被删除？什么是长期存储的更好选择？

> ID：12940871
> 
> 赞同：2
> 
> 时间：2012-10-17T18:27:22.333
> 
> 标签：java, android, eclipse, android-image, android-file

我正在使用以下代码在 Android 上保存和检索图像文件 (JPG)：

```
File cacheDir = context.getCacheDir(); 
```

这些文件什么时候被删除？从我读过的内容来看，这个目录并不可靠，因为设备可以随时删除它们以为其他东西腾出空间。本地存储我的应用所需的图像文件有什么更好的选择？如果可能的话，我想依靠永久存储，而不是 SD 可移动卡。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T18:45:14.340

您可以使用应用程序包空间来保存您的文件。我在我的应用程序中使用： [openFileOutput()](http://developer.android.com/reference/android/content/Context.html#openFileOutput%28java.lang.String,%20int%29) 您可以在那里看到还有`openFileInput()`读取您的文件，以保持文件的私密性，确保您使用`MODE_PRIVATE`标志与`openFileOutput()`方法。祝你好运！

# objective-c - NSString 的问题：使用控制器设置 NSTextField？

> ID：12940873
> 
> 赞同：0
> 
> 时间：2012-10-17T18:27:28.427
> 
> 标签：objective-c, nsstring, nstextfield

我正在使用 Xcode 4 编写一个简单的程序来根据用户输入生成文本。我成功读取了两个文本字段，但无法将结果发送到单独的 NSTextField。我确信我已经在 IB 中建立了所有正确的连接，并且我正在向 NSTextField 发送 setStringValue 方法。我创建了一个 ScaleGenerator 对象，我认为它可能不正确地创建了字符串本身。我的控制器标头如下所示：

```
#import <Cocoa/Cocoa.h>

@interface Controller : NSObject
{
    IBOutlet NSTextField * notesField;
    IBOutlet NSTextField * midiField;
    IBOutlet NSTextField * resultField;
    IBOutlet id scalegenerator;
}    
- (IBAction) generate: (id) sender;
@end // Controller 
```

控制器实现如下所示：

```
#import "Controller.h"
#import "ScaleGenerator.h"
#import <Foundation/foundation.h>

@implementation Controller

- (IBAction) generate: (id) sender
{
    int midinote;
    int notes;
    NSString * scale;

    midinote = [midiField intValue];
    if(midinote < 0 || midinote > 127) {
        NSRunAlertPanel(@"Bad MIDI", @"That MIDI note is out of range! (0 - 127)", @"OK", nil, nil);
        return;
    }

    notes = [notesField intValue];
    if(notes < 2 || notes > 24) {
        NSRunAlertPanel(@"Bad Scale Size", @"You must have at least two notes in your scale, and no more than 25 notes!", @"OK", nil, nil);
        return;
    }

    scale = [scalegenerator generateScale: midinote and: notes];

    [resultField setStringValue:scale];   
}  
@end 
```

我的 ScaleGenerator 代码如下所示：

```
#import "ScaleGenerator.h"
#import <math.h>

@implementation ScaleGenerator

- (NSMutableString *) generateScale: (int) midinote and: (int) numberOfNotes
{
    double frequency, ratio;
    double c0, c5;
    double intervals[24];
    int i;
    NSMutableString * result;

    /* calculate standard semitone ratio in order to map the midinotes */
    ratio = pow(2.0, 1/12.0);       // Frequency Mulitplier for one half-step
    c5 = 220.0 * pow(ratio, 3);     // Middle C is three semitones above A220
    c0 = c5 * pow(0.5, 5);          // Lowest MIDI note is 5 octaves below middle C
    frequency = c0 * pow(ratio, midinote); // the first frequency is based off of my midinote

    /* calculate ratio from notes and fill the frequency array */
    ratio = pow(2.0, 1/numberOfNotes);
    for(i = 0; i < numberOfNotes; i++) {
        intervals[i] = frequency;
        frequency *= ratio;
    }

    for(i = 0; i < n; i++){
        [result appendFormat: @"#%d: %f", numberOfNotes + 1, intervals[i]];
    }

    return (result);
}
@end // ScaleGenerator 
```

我的 ScaleGenerator 对象有一个功能，我认为我可能会在这个功能上搞砸了。我可以迭代地将格式化文本附加到哪种字符串？我叫什么方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T18:39:20.240

您尚未分配/初始化您的`NSMutableString`. 因此消息`appendFormat:`转到`nil`。换行

```
NSMutableString * result; 
```

和

```
NSMutableString * result = [[NSMutableString alloc] init]; 
```

# javascript - 使用从网页获取 innerHTML 的 javascript 函数从字符串中获取特定的 html 内容

> ID：12940875
> 
> 赞同：0
> 
> 时间：2012-10-17T18:27:40.633
> 
> 标签：javascript, html, vb.net, web

所以我有这个函数可以从我所在的网站获取 innerHTML：

```
document.getElementById('go').onclick = function(){ 
  alert(document.getElementById('hourbyhour_details').innerHTML);
};​ 
```

但这不是我需要的，我想获取我不在的另一个站点的 innerHTML。我可以使用 WebRequest 和 StreamReader 来读取我想要的页面的源代码并将其存储在字符串中，是否有如何将此字符串发送到函数？或者是否有另一种方法可以从远程站点获取特定内容，而不是我所在的站点？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T18:30:09.570

您将不得不绕过同源策略才能在 Javascript 中执行此操作。你可以在这里看到更多：

[同源政策](http://en.wikipedia.org/wiki/Same_origin_policy)

解决此问题的一种方法是 JSONP，另一种方法是让服务器端脚本从您的域返回您想要的信息。祝你好运。

# mysql - 在缺少表的 mamp 安装之间移动了 mysql DB

> ID：12940876
> 
> 赞同：0
> 
> 时间：2012-10-17T18:27:44.580
> 
> 标签：mysql, mamp

出于方便，我一直在使用 MAMP，但在错误地更改 root 权限后遇到了重大问题。我无法解决这些问题，并选择全新安装 MAMP 并移动 db 文件夹，我认为这是可能的。在这样做时，我有许多具有 MIA 表的数据库。

```
SHOW GRANTS FOR 'root'@'localhost'
response:
GRANT ALL PRIVILEGES ON *.* TO 'root'@'localhost' IDENTIFIED BY PASSWORD '*81F5E21E35407D884A6CD4A731AEBFB6AF209E1B' WITH GRANT OPTION 
GRANT PROXY ON ''@'' TO 'root'@'localhost' WITH GRANT OPTION 
```

*   我可以看到 db 文件夹中的所有表，但并非所有表都没有显示在 phpmyadmin 中。
*   我相信 phpmyadmin 作为套接字连接“服务器：通过 UNIX 套接字的本地主机”
*   当我以 root/localhost 身份登录控制台时，我可以看到所有表。
*   以 root/127.0.0.1 身份登录控制台我根本看不到数据库。

我真的被困在这里，因此几乎失去了一天的工作。

更新：当我运行 mysql_update 命令时，我得到以下响应。

```
→ /Applications/MAMP/Library/bin/mysql_upgrade -p
Enter password: 
Looking for 'mysql' as: /Applications/MAMP/Library/bin/mysql
Looking for 'mysqlcheck' as: /Applications/MAMP/Library/bin/mysqlcheck
Running 'mysqlcheck with default connection arguments
Running 'mysqlcheck with default connection arguments
ipbnew.ipb_admin_login_logs
Error    : Table 'ipbnew.ipb_admin_login_logs' doesn't exist
status   : Operation failed
ipbnew.ipb_admin_logs
Error    : Table 'ipbnew.ipb_admin_logs' doesn't exist
status   : Operation failed 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T23:08:12.237

我已经在单独的 SO 主题中发布了对我的问题的解决方案的完整说明。

[MAMP mysql损坏的root用户](https://stackoverflow.com/questions/12929722/mamp-mysql-broken-root-user/12965003#12965003)

# javascript - 查找渲染/可见文本的高度

> ID：12940881
> 
> 赞同：3
> 
> 时间：2012-10-17T18:27:57.937
> 
> 标签：javascript, jquery

我知道如何获得字体的这个高度： ![在此处输入图像描述](../Images/4cfb871da88f425ed5739884331ba109.png)

通过将文本放在 div 中并获取 div 的偏移高度。

但我想得到这个实际高度（这取决于字体系列）： ![在此处输入图像描述](../Images/54c231111430ca274c044fe9265dfff7.png)

使用基于网络的编程是否有可能？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-17T18:39:37.647

有简单的解决方案吗？我认为答案是否定的。

如果您对更多参与（和处理器密集型）的解决方案感到满意，您可以试试这个：

将文本渲染到画布上，然后用于`canvasCtx.getImageData(..)`检索像素信息。接下来，您将执行类似于此伪代码描述的操作：

```
first_y : null
last_y : null
for each y:
    for each x:
        if imageData[x][y] is black:
            if first_y is null:
                first_y = y
            last_y = y
height = last_y - first_y 
```

这基本上会查找字母（黑色像素）的顶部（最低 y 索引）和底部（最高 y 索引），然后减去以检索高度。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-17T19:05:15.063

Jason 回答时我正在编写代码，但我还是决定将其发布：http: [//jsfiddle.net/adtn8/2/](http://jsfiddle.net/adtn8/2/) 如果您关注评论，您应该知道发生了什么以及为什么。它的工作速度非常快，而且并不像听起来那么复杂。用 GIMP 检查，它是准确的。

（确保它不会丢失的代码）：

```
// setup variables
var c = document.createElement('canvas'),
    div = document.getElementsByTagName('div')[0],
    out = document.getElementsByTagName('output')[0];

// set canvas's size to be equal with div
c.width = div.offsetWidth;
c.height = div.offsetHeight;

var ctx = c.getContext('2d');
// get div's font from computed style and apply it to context
ctx.font = window.getComputedStyle(div).font;
// use color other than black because all pixels are 0 when black and transparent
ctx.fillStyle = '#bbb';
// draw the text near the bottom of the canvas
ctx.fillText(div.innerText, 0, div.offsetHeight);

// loop trough the canvas' data to find first colored pixel
var data = ctx.getImageData(0, 0, c.width, c.height).data,
    minY = 0, len = data.length;
for (var i = 0; i < len; i += 4) {
    // when you found it
    if (data[i] != 0) {
        // get pixel's y position
        minY = Math.floor(i / 4 / c.width);
        break;
    }
}

// and print out the results
out.innerText = c.height - minY + 'px'; 
```

# 编辑：

我什至为此制作了 jQuery 插件：[https ://github.com/maciek134/jquery-textHeight](https://github.com/maciek134/jquery-textHeight)

享受。

# python - 如何获取子进程的打开文件？

> ID：12940883
> 
> 赞同：1
> 
> 时间：2012-10-17T18:28:05.317
> 
> 标签：python, linux, posix, fsync

如何获取子进程的打开文件？

我打开了一个生成文件的子进程，我想获取这些文件的文件描述符以对它们进行 fsync

所以如果我有这样的代码：

```
p = subprocess.Popen([
            'some_program'
]) 
```

进程 p 生成一些文件，我可以使用以下方法获取子进程的进程 ID：

```
p.pid 
```

但是我怎样才能让这些文件的 fd 对它们调用 flush 和 fsync() 呢？

实际上我找到了一个名为“lsof”（列出打开的文件）的实用程序，但我的系统上没有安装或支持它，所以我没有对它做进一步的调查，因为我真的需要一个标准的方法

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T22:03:30.040

每个进程都有自己的文件描述符表。如果您知道子进程使用 FD 8 打开了某个文件（这很容易，只需列出`/proc/<pid>/fd`），那么当您同步时，*您*`fsync(8)`正在同步进程的文件，而不是子进程的文件。

 *这同样适用于所有使用文件描述符的函数：`fread`, `fwrite`, `dup`, `close`...

要获得 的效果`fsync`，您可以`sync`改为调用。

您可以做的是实现某种 RPC 机制。例如，您可以添加一个信号处理程序，使子`fsync`进程在收到 SIGUSR1 时在所有打开的 FD 上运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T19:04:45.510

如果你想使用打包的解决方案，而不是去 /proc/pid/fd，一个选项是使用[psutils的 lsof](http://code.google.com/p/psutil/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-17T22:29:04.157

您不能代表另一个进程进行 fsync。此外，您可能想要刷新，而不是 fsync。您也不能代表另一个进程刷新。重新考虑您的要求。*

# objective-c - 使用 Obj-C 插件和 AVAssetWriterInput 向视频添加音频

> ID：12940888
> 
> 赞同：3
> 
> 时间：2012-10-17T18:28:24.080
> 
> 标签：objective-c, audio, video, avfoundation, avassetwriter

我正在尝试拍摄使用 iVidCap 插件创建的视频并向其添加音频。基本上与这个问题完全相同：[Writing video + generated audio to AVAssetWriterInput, audio stuttering](https://stackoverflow.com/questions/12187124/writing-video-generated-audio-to-avassetwriterinput-audio-stuttering?answertab=votes#tab-top)。我已经使用这篇文章中的代码作为基础来尝试自己修改 iVidCap.mm 文件，但应用程序总是在 endRecordingSession 中崩溃。

我不确定我需要如何修改 endRecordingSession 以适应音频（原始插件只是创建一个视频文件）。这是功能：

```
- (int) endRecordingSession: (VideoDisposition) action {

NSLog(@"Start endRecordingSession");
NSAutoreleasePool* pool = [[NSAutoreleasePool alloc] init];

NSLog(@"Auto released pool");

NSString *filePath;
BOOL success = false;

[videoWriterInput markAsFinished];
NSLog(@"Mark video writer input as finished");
//[audioWriterInput markAsFinished];

// Wait for the video status to become known.
// Is this really doing anything?
int status = videoWriter.status;
while (status == AVAssetWriterStatusUnknown) {
    NSLog(@"Waiting for video to complete...");
    [NSThread sleepForTimeInterval:0.5f];
    status = videoWriter.status;
}

NSLog(@"Video completed");

@synchronized(self) {
    success = [videoWriter finishWriting];
    NSLog(@"Success: %@", success);
    if (!success) {
        // We failed to successfully finalize the video file.
        NSLog(@"finishWriting returned NO");

    } else {
        // The video file was successfully written to the Documents folder.
        filePath = [[self getDocumentsFileURL:videoFileName] path];
        if (action == Save_Video_To_Album) {

            // Move the video to an accessible location on the device.
            NSLog(@"Temporary video filePath=%@", filePath);
            if (UIVideoAtPathIsCompatibleWithSavedPhotosAlbum(filePath)) {
                NSLog(@"Video IS compatible. Adding it to photo album.");
                UISaveVideoAtPathToSavedPhotosAlbum(filePath, self, @selector(copyToPhotoAlbumCompleteFromVideo: didFinishSavingWithError: contextInfo:), nil);
            } else {
                NSLog(@"Video IS NOT compatible. Could not be added to the photo album.");
                success = NO;
            }
        } else if (action == Discard_Video) {
            NSLog(@"Video cancelled. Removing temporary video file: %@", filePath);
            [self removeFile:filePath];  
        }
    }

    [self cleanupWriter];
}

isRecording = false;

[pool drain];

return success; } 
```

现在它在 [videoWriter finishWriting] 上崩溃。我尝试添加 [audioWriterInput markAsFinished]，但随后它崩溃了。我会联系原始海报，因为他们似乎可以正常工作，但似乎没有办法发送私人消息。

有没有人对我如何让它工作或为什么它崩溃有任何建议？我已经尽力解决这个问题，但我对 Obj-C 还是很陌生。如果需要，我可以发布其余代码（其中很多都在前面引用的原始帖子中）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T09:06:14.237

问题实际上可能出在 writeAudioBuffer 函数中。

如果您从该帖子中复制了代码但没有更改它，那么您肯定会遇到一些问题。

你需要做这样的事情：

```
if ( ![self waitForAudioWriterReadiness]) {
    NSLog(@"WARNING: writeAudioBuffer dropped frame after wait limit reached.");
    return 0;
}

OSStatus status;
CMBlockBufferRef bbuf = NULL;
CMSampleBufferRef sbuf = NULL;

size_t buflen = n * nchans * sizeof(float);

CMBlockBufferRef tmp_bbuf = NULL;
status = CMBlockBufferCreateWithMemoryBlock(
                                            kCFAllocatorDefault, 
                                            samples, 
                                            buflen, 
                                            kCFAllocatorDefault, 
                                            NULL, 
                                            0, 
                                            buflen, 
                                            0, 
                                            &tmp_bbuf);

if (status != noErr || !tmp_bbuf) {
    NSLog(@"CMBlockBufferCreateWithMemoryBlock error");
    return -1;
}
// Copy the buffer so that we get a copy of the samples in memory.
// CMBlockBufferCreateWithMemoryBlock does not actually copy the data!
// 
status = CMBlockBufferCreateContiguous(kCFAllocatorDefault, tmp_bbuf, kCFAllocatorDefault, NULL, 0, buflen, kCMBlockBufferAlwaysCopyDataFlag, &bbuf);
//CFRelease(tmp_bbuf); // causes abort?!
if (status != noErr) {
    NSLog(@"CMBlockBufferCreateContiguous error");
    //CFRelease(bbuf);
    return -1;
}

CMTime timestamp = CMTimeMake(sample_position_, 44100);

status = CMAudioSampleBufferCreateWithPacketDescriptions(
    kCFAllocatorDefault, bbuf, TRUE, 0, NULL, audio_fmt_desc_, 1, timestamp, NULL, &sbuf);

sample_position_ += n;
if (status != noErr) {
    NSLog(@"CMSampleBufferCreate error");
    return -1;
}
BOOL r = [audioWriterInput appendSampleBuffer:sbuf];
if (!r) {
    NSLog(@"appendSampleBuffer error");
}
//CFRelease(bbuf); // crashes, don't know why..  Is there a leak here?
//CFRelease(sbuf);

return 0; 
```

我不确定这里有一些与内存管理有关的事情。

另外一定要使用：

```
audioWriterInput.expectsMediaDataInRealTime = YES; 
```

# node.js - 在 Ubuntu 12.04 上使用大量 cpu 的 grunt watch

> ID：12940889
> 
> 赞同：5
> 
> 时间：2012-10-17T18:28:34.893
> 
> 标签：node.js, coffeescript, gruntjs, towerjs

我正在使用 grunt 在 towerjs 项目中查看我的咖啡脚本文件，并在它们更改时重新编译它们。这个配置是由 towerjs 生成的，看起来相当理智。问题是，一旦我开始这个过程，我会看到它与一个 cpu 核心挂钩（实际上，只有一个超线程）。如果我删除了很多被监视的路径，我可以将它降低到 CPU 的 25% 左右，但这仍然非常糟糕。

我发现了一些对一些已知问题的引用以及与 Node 的 fs API 甚至 fs.watch 的跨平台不一致，[尤其是](https://github.com/isaacs/node-supervisor/issues/71). 尝试了[grunt-simple-watch](https://github.com/unbalanced/grunt-simple-watch)但它并没有做得更好。

我可以设置 Guard，但让它正常工作可能会很麻烦，而且功能上的 grunt 似乎也很好 - 我很好奇如果其他人有任何其他建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-18T04:10:49.107

尝试新的监视任务：`npm install grunt-contrib-watch`并添加`grunt.loadNpmTasks('grunt-contrib-watch');`到您的 gruntfile.xml 中。Grunt v0.3 监视任务遍历和统计文件，其中包含大量文件可能会变慢，但对于系统兼容性是必要的。新的只有在节点内正常工作时才会使用 inotify。

# objective-c - iOS6 NSHTTPCookieStorage deleteCookie 问题

> ID：12940890
> 
> 赞同：0
> 
> 时间：2012-10-17T18:28:36.843
> 
> 标签：objective-c, xcode, cookies, uiwebview, ios6

我有一个浏览器应用程序，用于输入特定站点。

这个站点（我不拥有）有一个仅在 iOS6 中相关的错误。登录该站点后，如果您尝试运行该应用程序并再次登录，则会失败。

在 safari 中，如果我在第二次尝试之前删除了 cookie，它会起作用。但是当我使用 UIWebView 时，当我尝试打印 cookie 时，它​​们看起来好像被删除了，但登录仍然失败。

我使用此代码删除 cookie：

 **```
 NSHTTPCookie *cookie;
 NSHTTPCookieStorage *cookieStorage = [NSHTTPCookieStorage sharedHTTPCookieStorage];
 for (cookie in [cookieStorage cookies]) {
     [cookieStorage deleteCookie:cookie];
     NSLog(@"delete Cookie. Name: %@ : , domain: %@", cookie.name, cookie.domain);
 } 
```* 

*它不会发生在 iOS5 上。*

 *有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T07:16:47.973

可能是......你不应该删除“for”中的对象。我想有时你会崩溃。您应该在“for”中标记一些对象并删除对象示例：

NSMutableArray *arrayObject = [NSMutableArray 数组];

NSMutableArray *deleteArray = [NSMutableArray 数组];

```
for (Someobject *object in arrayObject) {
    [deleteArray addObject:object];
}
[arrayObject removeObjectsInArray:deleteArray]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T11:37:04.943

```
NSArray *newCookie = [NSArray arrayWithArray:[[NSHTTPCookieStorage sharedHTTPCookieStorage] cookies]];

for (NSHTTPCookie *cookie in [[NSHTTPCookieStorage sharedHTTPCookieStorage] cookies]) {
    [[NSHTTPCookieStorage sharedHTTPCookieStorage] deleteCookie:cookie];
}
for (NSHTTPCookie *cookie in newCookie) {
    NSMutableDictionary *properties = [NSMutableDictionary dictionaryWithDictionary:cookie.properties];
    [properties removeObjectForKey:NSHTTPCookieExpires];
     NSHTTPCookie *changeCookie = [NSHTTPCookie cookieWithProperties:properties];
    [[NSHTTPCookieStorage sharedHTTPCookieStorage] setCookie:changeCookie]; 
```

此代码适用于 iOS5 和 iOS6。我检查了。我认为问题在于：**NSLog**在最后一个对象中会显示什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-01-18T10:35:56.277

我用这个：

```
NSHTTPCookieStorage *storage = NSHTTPCookieStorage.sharedHTTPCookieStorage;
while (storage.cookies.count > 0) {
    [storage deleteCookie:storage.cookies.lastObject];
} 
```**

# c# - 如何获得过去 10 年的夏令时边界

> ID：12940893
> 
> 赞同：3
> 
> 时间：2012-10-17T18:28:37.643
> 
> 标签：c#, .net, windows

如何使用 C# 获取每个时区的夏令时边界？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-17T18:34:08.343

~~看一下[TimeZone.GetDaylightChanges](http://msdn.microsoft.com/en-us/library/system.timezone.getdaylightchanges.aspx)方法。~~

编辑：

查看 TimeZone 类，它似乎只支持本地时区，并且只支持当前年份。看一下[TimeZoneInfo.GetAdjustmentRules](http://msdn.microsoft.com/en-us/library/system.timezoneinfo.getadjustmentrules.aspx)，它可以让您获得任意时区的调整规则。该页面上的示例甚至看起来与您在此处的任务非常相似。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-17T18:39:09.070

免责声明：我是下面引用的 Noda Time 库的主要作者 :)

仅使用vanilla .NET 代码*相对比较*棘手：

*   `TimeZone`不使用历史数据
*   `TimeZoneInfo`不容易找到过渡；基本上，您必须自己解释规则数据。*确实*为您提供了所有信息，但根据经验，我建议您避免尝试针对它进行编码，除非您确实必须这样做。[`TimeZoneInfo.GetAdjustmentRules`](http://msdn.microsoft.com/en-us/library/system.timezoneinfo.getadjustmentrules.aspx)

 *但是，使用[Noda Time](http://noda-time.googlecode.com)，您可以相当轻松地做到这一点。下面的代码使用 BCL 时区的包装器；更改`Bcl`为`Tzdb`使用 TZDB 时区（“欧洲/伦敦”等）。

```
using System;
using NodaTime;

class Test
{
    static readonly Instant Start = Instant.FromUtc(2002, 10, 17, 0, 0);
    static readonly Instant End = Instant.FromUtc(2012, 10, 17, 0, 0);

    static void Main()
    {
        var provider = DateTimeZoneProviders.Bcl;
        foreach (var id in provider.Ids)
        {
            var zone = provider[id];
            ShowTransitions(zone);
        }        
    }

    static void ShowTransitions(DateTimeZone zone)
    {
        Console.WriteLine("{0}:", zone.Id);
        var zoneInterval = zone.GetZoneInterval(Start);
        while (zoneInterval.End < End)
        {
            Console.WriteLine("{0} - {1}: {2}",
                              zoneInterval.Start,
                              zoneInterval.End,
                              zoneInterval.WallOffset);
            zoneInterval = zone.GetZoneInterval(zoneInterval.End);
        }
    }
} 
```*

# iphone - iPhone4 UI 设计对比 iPhone5

> ID：12940894
> 
> 赞同：0
> 
> 时间：2012-10-17T18:28:43.240
> 
> 标签：iphone, ios, user-interface, uiimage

我有下一个问题。我在谷歌和这里搜索，但仍然没有找到正确和正确的解决方案。我的应用程序必须在 iPhone 4 和 iPhone 5 上运行。我们知道 iPhone 5 的屏幕尺寸与第四个不同。让我们看一个简单的案例，我有一个带有背景图像的视图控制器。图像对尺寸很敏感，如果我拉伸它，它看起来会很丑。所以我有两张不同的图像，一张是旧的第四分辨率，另一张是新的第五张。问题是什么是最好的，让我们说在两个设备上实现正确图像显示的“原生”方式。

我看到最简单的方法是在运行时检查当前使用的设备并将正确的图像名称设置为 UIImageView。但是我觉得很丑。有人知道正确的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T20:06:16.613

您可以使用：

```
#define IS_IPHONE5 (([[UIScreen mainScreen] bounds].size.height-568)?NO:YES) 
```

然后，

```
if (IS_IPHONE5) {
//iPhone5
} else {
/older devices
} 
```

资料来源：[如何获得实际的 [UIScreen mainScreen] 帧大小？](https://stackoverflow.com/questions/5150794/how-to-get-the-actual-uiscreen-mainscreen-frame-size)

# c# - 我已经使用 CrmSvcUtil 为 Dynamics CRM 2011 生成了早期绑定实体类 - 现在怎么办？

> ID：12940895
> 
> 赞同：3
> 
> 时间：2012-10-17T18:28:42.930
> 
> 标签：c#, sdk, dynamics-crm, dynamics-crm-2011

我已经设置了一个测试 Dynamics CRM 2011 服务器。

我使用 SDK 的 CrmSvcUtil 实用程序来生成早期绑定的实体类（例如 mycrm.cs）。

我在 Visual Studio 中创建了一个新项目，并添加了对 Microsoft.CRM.SDK.Proxy、Microsoft.Xrm.Sdk 和 System.Runtime.Serialization 的引用。

我还将 mycrm.cs 文件作为现有文件添加到我的项目中。

怎么办？

我知道，我知道……阅读 SDK。我试过了：

[在代码中使用早期绑定的实体类](http://technet.microsoft.com/en-us/library/gg328210.aspx)

[使用早期绑定实体类进行创建、更新、删除](http://technet.microsoft.com/en-us/library/gg328499.aspx)

[使用代码生成工具 (CrmSvcUtil.exe) 创建早期绑定实体类](http://technet.microsoft.com/en-us/library/gg327844.aspx)

如果必须的话，请叫我白痴——我相信这些文章可能包含这些信息。我需要，但我没有看到它。帮助！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-17T21:44:07.290

首先，您需要连接到 CRM 网络服务：

```
OrganizationServiceProxy orgserv;
ClientCredentials clientCreds = new ClientCredentials();
ClientCredentials devCreds = new ClientCredentials();

clientCreds.Windows.ClientCredential.UserName = "user";
clientCreds.Windows.ClientCredential.Password = "P@$$w0rd";
clientCreds.Windows.ClientCredential.Domain = "myDomain";
IServiceConfiguration<IOrganizationService> orgConfigInfo =
            ServiceConfigurationFactory.CreateConfiguration<IOrganizationService>(new Uri("https://myCRMServer/myOrg/XRMServices/2011/Organization.svc"));

orgserv = new OrganizationServiceProxy(orgConfigInfo, clientCreds);
orgserv.ServiceConfiguration.CurrentServiceEndpoint.Behaviors.Add(new ProxyTypesBehavior()); 
```

之后，您将使用您的 XrmServiceContext，或者在这里如何命名它：

> CrmSvcUtil.exe /url: [http://servername/organizationname/XRMServices/2011/Organization.svc](http://servername/organizationname/XRMServices/2011/Organization.svc) /out:.cs /username: /password: /domain: /namespace: /serviceContextName: **XrmServiceContext**

然后您可以从[您发布的链接](http://technet.microsoft.com/en-us/library/gg328499.aspx)中的 CRUD 示例开始:)

更新联系人示例：

```
using(var context = new XrmServiceContext(orgserv))
{
    Contact con = context.contactSet.FirstOrDefault(c => c.Name == "Test Contact");
    if(con != null)
    {
        con.City = "NY";

        context.UpdateObject(con);
        context.SaveChanges();
    }
} 
```

希望能帮助到你 ：）

# youtube - Youtube API 2.0 检查视频是否有年龄限制

> ID：12940901
> 
> 赞同：1
> 
> 时间：2012-10-17T18:29:10.013
> 
> 标签：youtube, youtube-api

我想检查一下 youtube 视频是否有年龄限制。有的视频不多，但有一些。我一直在 youtube api 文档和互联网上进行挖掘，但似乎无法找到一种方法来检测这一点。

我正在使用 Youtube API V2，一次只寻找一个视频。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-18T03:36:16.717

要检查视频在给定区域中是否（年龄）受到限制，您可以查看`media:rating`视频条目的属性，该属性记录在

[https://developers.google.com/youtube/2.0/reference#youtube_data_api_tag_media:rating](https://developers.google.com/youtube/2.0/reference#youtube_data_api_tag_media:rating)

如果要搜索并过滤掉有年龄限制的视频，可以使用`safeSearch=strict`参数：

[https://developers.google.com/youtube/2.0/reference#safeSearchsp](https://developers.google.com/youtube/2.0/reference#safeSearchsp)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-07T05:32:29.927

我同意格雷格·谢克特。实际的问题是，如果我们有一个视频 id（例如：在链接[http://www.youtube.com/watch?v=RyDY0hiMZy8](http://www.youtube.com/watch?v=RyDY0hiMZy8)中，视频 id 是 RyDY0hiMZy8），我们如何获得基于此的年龄限制详细信息?

Youtube 提供了一个 API，可以根据视频 ID 获取详细信息。对于上面的示例，API 链接是： [http](http://gdata.youtube.com/feeds/api/videos/RyDY0hiMZy8?v=2&alt=json) ://gdata.youtube.com/feeds/api/videos/RyDY0hiMZy8?v=2&alt=json 但是响应中没有关于年龄限制的信息。

上述帖子的更新：在来自[http://gdata.youtube.com/feeds/api/videos/tA4wytG3uh0?v=2&alt=json](http://gdata.youtube.com/feeds/api/videos/tA4wytG3uh0?v=2&alt=json)的 API 响应中， 我们有一个 media$rating 内容来了，可以比较那里的数据使用链接[https://developers.google.com/youtube/2.0/reference#youtube_data_api_tag_media:rating](https://developers.google.com/youtube/2.0/reference#youtube_data_api_tag_media:rating)中提到的规则

对于不受限制的视频，media$rating 值不会出现在响应中。例如：在链接[http://gdata.youtube.com/feeds/api/videos/RyDY0hiMZy8?v=2&alt=json](http://gdata.youtube.com/feeds/api/videos/RyDY0hiMZy8?v=2&alt=json)

欢迎任何更新。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T19:27:20.610

嵌入式播放不支持年龄门控；所以它不是在 YouTube 数据 api 中返回的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-10-12T23:34:58.350

您可以通过以下链接取消限制这些视频： [https ://www.quora.com/How-do-you-change-the-settings-of-the-the-age-restrictrincts-on-my-YouTube-视频/答案/Doyle-Lorraine](https://www.quora.com/How-do-you-change-the-settings-of-the-the-age-restrictrincts-on-my-YouTube-videos/answer/Doyle-Lorraine) 那么你`iframes`应该恢复正常。 [![在此处输入图像描述](../Images/135ec1e24bda965d5ccff5dc349eb588.png)](https://i.stack.imgur.com/HIKjZ.png)

# .net - MVC：添加一个时创建相关实体

> ID：12940909
> 
> 赞同：0
> 
> 时间：2012-10-17T18:30:06.823
> 
> 标签：.net, asp.net-mvc, entity-framework

所以，我的数据库现在看起来像：

```
Comment -> Commentable 

Commentable -> News
Commentable -> Files
Commentable -> Photo 
```

这意味着，当我添加新实体（文件或照片）时，我必须添加新的 Commentable 并将此值插入实体。

这方面的最佳做法是什么？我应该覆盖实体的创建功能，还是将其放入存储库添加功能？

表的结构看起来像这样，因为我不需要为每个实体创建自己的评论表。

**编辑：**我的表架构如下：Branko Dimitrijevic 帖子中的[一张表与多张表](https://stackoverflow.com/questions/10602562/one-table-vs-multiple-tables)

当我想添加新文件或事件时——首先，我必须生成新的“可评论”行，然后才添加关联我的实体。

所以，我的问题是，我必须把这个逻辑放在哪里，或者如何在最正确的实践中做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T19:36:05.860

仔细考虑照片、新闻和文件表的设计。当我发布我的第一个 Stackoverflow 问题时，我正在考虑一个类似的问题：[数据库设计 - 文章、博客文章、照片、故事](https://stackoverflow.com/questions/4969133/database-design-problem)。

我意识到文章、照片、视频、文档和博客帖子都共享一些公共字段，如作者、发布日期、标题、描述、关键字等。所以我创建了一个表的超类型/子类型层次结构，使用 EF 的类型继承特性对其进行建模。然后评论只有一个超类型表（我命名为出版物）的外键。在大多数情况下，这对我来说效果很好。

请注意，如果您使用 EF 的继承：有 2 个变体：每个类型的表 (TPT) 和每个层次结构的表 (TPH)，每个都有问题：

**TPT**：为公共字段提供一个超级表，为每个子类型的属性提供一个单独的数据库表。当您查询超类型时，这会出现性能问题（有时很严重）。一种解决方法是创建一个视图以将超类型表引用为不同的实体（这就是我所做的），但这比您想要的要复杂一些

**TPH**：没有性能问题，但该解决方案本质上将层次结构扁平化为一张表。我发现，DBA 和 DB 纯粹主义者*真的*不喜欢你这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T18:59:35.123

你不需要这样做。如果您有正确的模型结构，EF 会这样做。

```
public class Comment
{
  public int ID { set;get;}  
  public string Author { set;get;}
  public IEnumrable<CommentContent> CommentContents
}
public class CommentContent
{
  public int ID { set;get;}  
  public string Photo { set;get;}
  public string News{ set;get;}
  public int CommentID { set;get;}
} 
```

现在为您的模型设置属性（包括子表）并执行 SaveChanges，EF 将负责在子表上设置父 ID。

```
var model=new Comment();
model.Author="Scott";
model.CommentContents.Add(new CommentContent
                                 { Photo="abc.jpg", News="Some content"});
model.CommentContents.Add(new CommentContent
                                 { Photo="abc3.jpg", News="Some content2"});
yourDbContext.Comments.Add(model);
yourDbContext.SaveChanges(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-18T08:25:54.643

了解您要实现的目标的“官方”术语可能会有所帮助，因此您可以进行进一步的研究。它是*多态关联*。请注意，它通常被认为是一种[反模式](http://pragprog.com/book/bksqla/sql-antipatterns)。我曾经在 StackOverflow 上问过一个关于它们的[问题](https://stackoverflow.com/q/8895806/861716)，其中的第一张图片可能是您实现它的方式：

![在此处输入图像描述](../Images/7f54b2a936466672cb3c3a0684c8f493.png)

这是根据 Bill Karwin 关于如何实现这个[反模式](http://pragprog.com/book/bksqla/sql-antipatterns)的建议，如果你仍然使用它（就像我自己做的那样，对我来说，这只是一个模式）。

事实上，这就像 Faust 的 TPT 解决方案（如果它适合您，您应该接受它作为答案），特别是如果您使用三个类共有的所有属性扩展基表。

在这种情况下，我更愿意在存储库`Add`函数中处理它，其中每个函数都会为您添加的实体创建评论对象。

# jquery - jQuery $.ajax 使用字符串数组调用 Web Api

> ID：12940912
> 
> 赞同：5
> 
> 时间：2012-10-17T18:30:19.297
> 
> 标签：jquery, asp.net, ajax, asp.net-mvc-4, asp.net-web-api

我正在尝试通过 jquery 的 $.ajax 调用 .net Web Api 方法。当我通过

var process = "第一个进程", var nameArray = ["first", "second"], var valueArray = ["val1", "val2"]

进而：

```
 $.ajax({
url: jsonFeed,
data: {process: process, nameArray: nameArray, valueArray: valueArray},
    etc... 
```

我有一个 ASP.NET Web Api 方法：

```
 public string GetResponseToken(string process, string[] nameArray, string[] valueArray) 
```

当我运行所有内容时，我收到一条错误消息：

“无法将多个参数（'nameArray' 和 'valueArray'）绑定到请求的内容。”

有谁知道这是为什么，或者我如何修复它以接受我的数组？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-17T19:20:06.650

Web.API 参数/模型绑定器的工作方式与 MVC 不同。您需要告诉它您不想将查询字符串中的所有参数与`[FromUri]`属性绑定：

```
public string GetResponseToken(
      [FromUri]string process, 
      [FromUri]string[] nameArray, 
      [FromUri]string[] valueArray)
{
    //... 
} 
```

从长远来看（例如，如果您的请求类型是 POST，上述方法将不起作用）您应该考虑使用参数对象而不是具有多个参数。

```
public string GetResponseToken([FromUri]ResponseTokenRequest request)
{
    //...
}

public class ResponseTokenRequest
{
    public string Process { get; set; }
    public string[] NameArray { get; set; }
    public string[] ValueArray { get; set; }
} 
```

您可以在以下文章中了解 Wep.API 参数绑定：

*   [WebAPI如何做参数绑定](http://blogs.msdn.com/b/jmstall/archive/2012/04/16/how-webapi-does-parameter-binding.aspx)
*   [将多个 POST 参数传递给 Web API 控制器方法](http://www.west-wind.com/weblog/posts/2012/May/08/Passing-multiple-POST-parameters-to-Web-API-Controller-Methods)

# java - GUI 程序无法更新

> ID：12940918
> 
> 赞同：-1
> 
> 时间：2012-10-17T18:30:31.180
> 
> 标签：java, swing, user-interface, jlabel, event-dispatch-thread

我对硬币计划的作业有疑问。

我们需要编写一个小 GUI 程序，它可以翻转硬币并显示当前货币。

我写了几乎所有的东西，但是更新两个`JLabel`状态仍然有一些问题，似乎两个下注按钮和重置按钮工作正常，经过我`System.out.println`的测试，但是当我们单击时标签不会同时更新按钮。

这是我的代码，其中包含四个类：`coin.java`、`player.java`和。`coinpanel.java``coinPanelMain.java`

1.  播放器.java：

    公共类播放器{

    ```
    /**
     * @param ownMoney is currently the player own money
     * @param coin is new Coin object;
     */
    private int currMoney;
    private Coin coin; 

    /**
     * no-args parameter
     * default constructor 
     */
    public Player(){
        currMoney = 10;
        coin = new Coin();
    }
    /**
     * a bet method that takes in a bet and the side of coin
     * it will filp the coin and change the player's money 
     * depend on whether the player won or lost the bet 
     */
    public void bet(){
        coin.flip();
        System.out.println("filp over");
        if(coin.getFace().equals ("Heads")){
            currMoney ++;
        }
        else if(coin.getFace().equals("Tails")){
            currMoney --;
        }
        System.out.println("filp over2");
    }
    /**
     * a getter for getting current money
     * @return currMoney 
     */
    public int getCurrMon(){
        System.out.println("money is" + currMoney);
        return currMoney;
    }
    /**
     * a reset method make current money return to 10;
     * @return currMoney to 10
     */
    public void reset(){

        currMoney = 10;
    } 
    ```

    }

2.  coinPanel.java

    导入 javax.swing。*; 导入 java.awt.event。*; 导入 java.awt。*; /* *

    *   硬币面板类显示硬币游戏的结果。
    *   它包含三个按钮，当前货币和当前翻转
    *   一旦用户点击重置按钮，当前货币将返回到 10。 * * */

公共类 CoinPanel 扩展 JPanel {

```
private Player player = new Player();
private Coin coin = new Coin();
private JLabel label3 = new JLabel("Enter a bet");
private JTextField text;
private  int value = 0;

public  int getVal(){
    return value;
}
public CoinPanel(){

    JLabel label= new JLabel("Current Money:"+player.getCurrMon());
    JLabel label2 = new JLabel("Current Flip:" + coin.getFace());

    JLabel label4 = new JLabel("");

    text = new JTextField(30);
    //JTextField text = new JTextField(30);
    //String betNum = text.getText();
    //int betNumber = Integer.parseInt(betNum);

    JButton headsBt = new JButton("Bet Heads");
    JButton tailsBt = new JButton("Bet Tails");
    JButton reset = new JButton("Reset");

    setLayout(new GridLayout(5,1,10,10));
    add(label);
    add(label2);

    add(headsBt);
    add(tailsBt);
    add(text);

    add(reset);
    add(label3);

    headsBt.addActionListener(new BetButtonListener());
    tailsBt.addActionListener(new BetButtonListener());
    reset.addActionListener(new RESETButtonListener());

}

public class RESETButtonListener implements ActionListener{
    public void actionPerformed(ActionEvent e){
        player.reset();
        System.out.println("reset button");
    }
}

public class BetButtonListener implements ActionListener{
    public void actionPerformed(ActionEvent e){
        //value = Integer.parseInt(text.getText());
        player.bet();

        int value = Integer.parseInt(text.getText());

    //catch (NumberFormatException e){
        if(value > player.getCurrMon()){
            label3.setText("You are out of money");
            repaint();
        }
            }

}

} 
```

非常感谢你。我真的很感谢你的帮助！

**重新编辑代码后跟** 这里的指令是一些错误显示如下，应用程序无法运行。我不知道为什么。错误是：

"

```
money is10
face isTails
Exception in thread "main" java.lang.NullPointerException
    at java.awt.Container.addImpl(Unknown Source)
    at java.awt.Container.add(Unknown Source)
    at CoinPanel.<init>(CoinPanel.java:48)
    at CoinPanelMain.main(CoinPanelMain.java:17) 
```

" 上面的问题已经解决了。我忘记在课堂上初始化 label3 了..

**很抱歉给您带来太多问题......无论用户在文本字段中输入什么（我的意思是数字），当前的货币标签总是增加 2 或减少 2。我认为它应该随着用户输入而改变？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-17T19:10:13.687

Swing 在重绘方面非常聪明，但有时，它可能有点太聪明了。

我的期望是，在调用诸如`Label#setText`重绘请求之类的东西之后，会提出并更新标签，但这并不总是发生。

您可能需要提示 Swing 重新绘制...

```
if(value > player.getCurrMon()) {
    label3.setText("You are out of money");
    repaint();
} 
```

在您的情况下不太可能，但您可能需要通过`repaint`调用来继续请求`invalidate()`以鼓励容器层次结构更新其布局。

还...

```
int value = Integer.parseInt(text.getText()); 
```

应该包裹在 a`NumberFormatException`中以确保用户实际输入了一个数字。否则将导致您的程序无法按照您的预期进行更新

**扩展答案**

因此，在您的休息方法中，您需要更新所有各种 ui 元素...

```
public void actionPerformed(ActionEvent e){
    player.reset();
    System.out.println("reset button");

    label3.setText(""); // assuming no new messages..
    label.setText("Current Money:"+player.getCurrMon());
    text.setEnabled(true);

    invalidate();
    repaint();

} 
```

在你的下注按钮中，你有很多问题......

用户输入的内容与被扣除的内容之间没有联系，也没有检查玩家是否可以支付赌注......

```
 try {
        int value = Integer.parseInt(text.getText());

        if (value > player.getCurrMon()) {
            label3.setText("You don't have enough money to cover the bet");
        } else {
            player.bet();

            label.setText("Current Money:"+player.getCurrMon());

            if(player.getCurrMon() == 0){
                label3.setText("You are out of money");
                text.setEnabled(false);
            } else if (player.getCurrMon() < 0) {
                label3.setText("We'll be sending the boys around shortly");
                text.setEnabled(false);
            }
       }
    } catch (NumberFormatException exp) {
        label3.setText(text.getText() + " is an invalid bet");
    }
    invalidate();
    repaint(); 
```

**更新**

首先...`label`需要被定义为一个实例字段，就像`label3`在你的`CoinPanel`

```
private JLabel label3 = new JLabel("Enter a bet");
private JLabel label; 
```

然后在构造函数中，你只需要初始化它...

```
public CoinPanel(){

    label= new JLabel("Current Money:"+player.getCurrMon()); 
```

**更新**

基本上，我们需要检查按下了哪个按钮并相应地更改“面”赌注

```
public class BetButtonListener implements ActionListener {

    public void actionPerformed(ActionEvent e) {
        try {
            int value = Integer.parseInt(text.getText());

            if (value > player.getCurrMon()) {
                label3.setText("You don't have enough money to cover the bet");
            } else {
                String face = "Heads";
                if (e.getSource().equals(tailsBt)) {
                    face = "Tails"
                }
                player.bet(face, value);

                label.setText("Current Money:" + player.getCurrMon());

                if (player.getCurrMon() == 0) {
                    label3.setText("You are out of money");
                    text.setEnabled(false);
                } else if (player.getCurrMon() < 0) {
                    label3.setText("We'll be sending the boys around shortly");
                    text.setEnabled(false);
                }
            }
        } catch (NumberFormatException exp) {
            label3.setText(text.getText() + " is an invalid bet");
        }
        invalidate();
        repaint();
    }

} 
```

请注意，我可能已将参数切换到`bet`方法。顺序仅对您声明方法的方式很重要，因此您可能需要切换我的参数

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-17T19:05:47.540

*   这是一个问题：

    ```
    if(coin.getFace() == "Heads"){
        currMoney ++;
     }
    else if(coin.getFace() == "Tails"){
        currMoney --;
    } 
    ```

不要比较`String`使用`==`. 比较的使用`equals(..)`方法`String`：

```
if(coin.getFace().equals("Heads")){
    currMoney ++;
}
else if(coin.getFace().equals("Tails")){
     currMoney --;
} 
```

我还建议`Switch`在比较多个 s 时使用 block ，`String`从而降低比较 String 使用的风险`==`（仅限 Java 7，尽管感谢 Mad）：

```
switch(coin.getFace()) {

    case "Heads": 
          currMoney ++;
      break;
    case "Tails":  
           currMoney --;
      break;
} 
```

*   你添加一个`ActionListener`到你的`JTextField`这肯定不好（删除这一行）：

    ```
    text.addActionListener(new BetButtonListener()); 
    ```

*   只要`JPanel`实例是在 上创建的，我也看不到它不会更新`Event-Dispatch-Thread`，但正如@Mad 所说（对他和*try catch*加 1 ）调用`invalidate()`将确保它更新。

**更新：**

根据评论：

*try catch*块将围绕一个可能抛出的方法调用`Exception`：

```
int i=...;
try {
//call a method that can throw NumberFormatExecption
i=...;
}catch(NumberFormatException nfe) {
System.err.println(nfe.getMessage());
} 
```

阅读这些以获取有关[**TRY**](http://docs.oracle.com/javase/tutorial/essential/exceptions/try.html)和[**CATCH**](http://docs.oracle.com/javase/tutorial/essential/exceptions/catch.html)块的更多信息

# java - 通过 Windows 任务计划程序运行的 Java 应用程序的安全/正常关闭

> ID：12940921
> 
> 赞同：2
> 
> 时间：2012-10-17T18:30:47.610
> 
> 标签：java

我正在尝试为我的社区运行的一些服务器用 Java 编写一个简单的服务管理器。一般的想法是，服务器端应用程序启动服务器并通过 Process 类连接到其控制台的流，将其中继到可以通过 RDP 甚至远程在用户会话上运行的客户端应用程序。

现在，我的网络和中继工作正常；那东西相对简单。我遇到的问题是在服务器（或只是任务）重新启动时让服务器安全关闭。

我的印象是运行时的关闭钩子是处理这个问题的正确方法，但它们似乎不起作用。

我的控制台包装类的完整代码：http: [//pastebin.com/vM3PQ9zE](http://pastebin.com/vM3PQ9zE)

这是启动服务的方法，为清楚起见添加了类字段：

```
private final ProcessBuilder builder;
private Process process;
private boolean stopped = false;
private HashSet<ConsoleListener> listeners;
private PrintStream commandStream;
private InputHandler handler;
private Thread shutdownTask;

public void start() throws IOException {
    if (this.hasStarted())
        throw new IllegalStateException(
                "This process has already been started once.");

    this.process = this.builder.start();

    for (ConsoleListener l : this.listeners) {
        l.onStart(new ConsoleEvent(this));
    }

    this.handler = new InputHandler(this.process.getInputStream());
    new Thread(this.handler).start();

    this.commandStream = new PrintStream(this.process.getOutputStream());

    Runtime.getRuntime().addShutdownHook(
            this.shutdownTask = new Thread(new ShutdownListener()));
} 
```

类 ShutdownListener 内联定义为：

```
private class ShutdownListener implements Runnable {
    @Override
    public void run() {
        ConsoleApplication.this.nuke();
    }
} 
```

nuke方法定义为：

```
public void nuke() {
    this.process.destroy();
} 
```

现在我最终希望包装器能够发送正确的命令以安全关闭，但似乎它甚至无法强制关闭进程。我试过移动我的关闭挂钩，测试似乎表明 nuke() 从未被调用过。

任何帮助将不胜感激。

笔记：

我没有附加到任务计划程序。这似乎是处理服务器启动时最简单的方法。如果有不涉及任务计划程序的解决方案，我很想听听。

# asp.net-mvc - 为什么 FederatedAuthentication.WSFederationAuthenticationModule 在 MVC Azure ACS 联合身份验证中为空？

> ID：12940929
> 
> 赞同：4
> 
> 时间：2012-10-17T18:31:18.713
> 
> 标签：asp.net-mvc, wif, .net-4.5, federated-identity

我正在尝试将 FederatedAuthentication 与 .NET 4.5、MVC 4 和使用自定义服务器端登录页面的主动重定向结合在一起，使用[本](http://garvincasimir.wordpress.com/2012/04/16/tutorial-mvc-application-using-azure-acs-and-forms-authentication-part-2/)教程中的代码和[此](http://msdn.microsoft.com/en-us/library/windowsazure/hh127794.aspx)代码示例中的代码。

重定向到我的 AccountController 的 LogOn 方法可以正常工作，该方法如下所示：

```
public ActionResult LogOn()
{
    HrdClient hrdClient = new HrdClient();
    WSFederationAuthenticationModule fam = FederatedAuthentication.WSFederationAuthenticationModule; /*** Fails here because this is null **/
    HrdRequest request = new HrdRequest(fam.Issuer, fam.Realm, context: Request.QueryString["ReturnUrl"]);
    IEnumerable<HrdIdentityProvider> hrdIdentityProviders = hrdClient.GetHrdResponse(request);
    ViewData["Providers"] = hrdIdentityProviders;
    return View();
} 
```

这失败了，因为`FederatedAuthentication.WSFederationAuthenticationModule`它是空的。

使用 VS 2012，我运行了新的身份和访问向导（它似乎取代了旧的 STS 对话框）。这为我提供了一个显示正确的 FederationMetadata 文件夹，并对我的 Web.Config 进行了一些修改。特别是，模块部分如下所示：

```
<system.webServer>
<validation validateIntegratedModeConfiguration="false" />
<modules runAllManagedModulesForAllRequests="true">
  <add name="WSFederationAuthenticationModule" type="System.IdentityModel.Services.WSFederationAuthenticationModule, System.IdentityModel.Services, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" preCondition="managedHandler" />
  <add name="SessionAuthenticationModule" type="System.IdentityModel.Services.SessionAuthenticationModule, System.IdentityModel.Services, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" preCondition="managedHandler" />
</modules> 
```

在看到 SO 答案[8937123](https://stackoverflow.com/questions/8937123/federatedauthentication-wsfederationauthenticationmodule-is-null-at-runtime)和[8926099 之后](https://stackoverflow.com/questions/8926099/wsfederationauthenticationmodule-redirectingtoidentityprovider-event-is-not-call)，我还添加了以下内容：

```
 <httpModules>
  <add name="WSFederationAuthenticationModule" type="Microsoft.IdentityModel.Web.WSFederationAuthenticationModule, Microsoft.IdentityModel, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
</httpModules> 
```

最后，我的 nuget 包配置显示 Microsoft.IdentityModel，MVC 应用程序正确引用了它：

```
<packages>
  <package id="Microsoft.IdentityModel" version="6.1.7600.16394" targetFramework="net45" />
</packages> 
```

我还在 social.msdn 上看到[了这个问题](http://social.msdn.microsoft.com/Forums/en/windowsazuresecurity/thread/ba44f757-945c-4622-9b2d-feb9a56fe71e)，这似乎表明确实需要运行 STS 对话框。

谁能解释为什么`FederatedAuthentication.WSFederationAuthenticationModule`会为空，以及我能做些什么来阻止这种情况发生？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-18T08:47:13.073

我自己设法解决了这个问题，由于在 SO 上有一些类似的未回答的问题，我将把问题留在上面并发布我自己的答案。

问题在于将 MVC 应用程序升级到 .NET 4.5。WIF 的大部分功能保持不变（至少表面上如此），但这些类都已移至不同的程序集。我按照这里的迁移指南解决了我的问题：http: [//msdn.microsoft.com/en-us/library/jj157089.aspx](http://msdn.microsoft.com/en-us/library/jj157089.aspx)

最重要的是删除对包的旧引用（v 3.5.0），并`Microsoft.IdentityModel`确保它们被对4.0 版和来自 GAC 而不是外部包的类似引用替换。`System.IdentityModel``System.IdentityModel.Services`

我的修复步骤是：

*   清除我添加到 Web.Config 中的所有垃圾，然后使用默认的 MVC 配置文件重新开始。
*   删除`Microsoft.IdentityModel`包并取消引用 dll
*   在 VS 2012 中运行访问和身份向导
*   从in复制`System.IdentityModel.Services.WSFederationAuthenticationModule`参考`<system.webServer><modules>``<system.web><httpModules>`
*   添加`<authentication mode="Forms"><forms loginUrl="~/Account/LogOn" /></authentication>`
*   编译、测试、跳起欢乐的小舞步……

这使原始 WIF3.5 / MVC3[代码示例](http://msdn.microsoft.com/en-us/library/windowsazure/hh127794.aspx)在 .NET 4.5 下工作

# java-3d - 多边形奇怪的行为

> ID：12940935
> 
> 赞同：0
> 
> 时间：2012-10-17T18:31:47.437
> 
> 标签：java-3d

我正在用 java3d 开始我的冒险。

创建自己的 Shape3D 时，我得到了意想不到的结果。我用以下几点设置几何（完全按照这个顺序）：

```
1 - (0.0, 0.5, 0.0), 
2 - (0.0, 0.25, 0.4330127018922193), 
3 - (0.0, -0.25, 0.43301270189221935), 
4 - (0.0, -0.5, 0.0), 
5 - (0.411819551773166, -0.25, 0.13380828366490874), 
6 - (0.4118195517731659, 0.25, 0.13380828366490874) 
```

还有更多，但足以说明情况。如果您绘制/想象它，您将在一条 Y 线上有点 1 和 4，而 2、3、5、6 将创建一个矩形。

我需要实现的是有一架飞机连接：

*   第 1 点
*   2号线到6号线
*   3号线到5号线
*   第 4 点

**差不多**了，很难解释，所以我会附上一张图片：

## ![全图](../Images/6fdfdfe4e9595eac349a94d0b0d6b64c.png)

如您所见，飞机通过连接 4-2 和 5-2 而不是 5-3 的线。

有人知道如何解决吗？如有必要，我可以提供更多代码，但我不想把所有内容都放好，也不知道你可能对哪一部分感兴趣。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T16:09:22.217

这不是我想要的，但我找到了解决方法。我按以下顺序排列积分（数字取自问题）：

```
1,2,6,6,2,3,5,5,3,4 
```

我设置 stripCounts 填充如下：

```
3,4,3 
```

它产生更多更小的粒子，但它正在工作，并且经过额外的工作可以是通用的。

如果没有更好的答案出现，我会接受我自己的。

# jquery - 使用 jquery 访问 Telerik 网格中的选定行元素

> ID：12940937
> 
> 赞同：0
> 
> 时间：2012-10-17T18:31:56.157
> 
> 标签：jquery, asp.net-mvc, telerik-grid

如何使用 jquery 访问 Telerik Grid 的选定成员？我对此一无所知，我尝试了以下方法，但在选择一行时不会提醒 innerText 。

这是我的网格：

```
 <td><%= Html.MyCustomGridFor("gridName", "refreshAction", "refreshController", GridOptions.EnableSelecting, Model).Columns(column =>
                    {
                        column.Bound(o => o.Code).Title("Code").Width("40px");
                        column.Bound(o => o.Description).Title("Description");
                    }).HtmlAttributes(new { @id = "gridName" , @style = "width: 200px;" })%>
            </td> 
```

jQuery：

```
$("#gridName").focusin(function(e){
   alert(e.innerText);

}); 
```

# php - 集成 Zend Framework 和 WordPress，委派页面加载

> ID：12940939
> 
> 赞同：0
> 
> 时间：2012-10-17T18:32:02.440
> 
> 标签：php, wordpress, zend-framework, content-management-system

我希望在**Zend Framework**和**WordPress**之间进行完全集成。澄清一下，这并不意味着我想在**WordPress中使用****Zend 库**，而是将页面加载委托给两个系统之间的单个站点。

 **我做了相当多的研究，我遇到了几个项目，但与我正在寻找的东西完全不同。如果页面存在且可用，我希望能够从**MVC加载页面，否则从****WordPress**加载，反之亦然。

**现在，我想我可以通过结合WordPress**和**Zend Framework**`index`文件的方式来解决这个问题。这样做，我需要对传入的请求进行一种“检查”，以决定要访问哪个系统。我想我会在缓存中有一个东西，包含所有要检查的**Wordpress**（将通过/更新），如果没有，则从**Zend Framework**提供。 ******`uri's``cron job``daemon``bootstrap`******

 ******任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T18:39:03.677

我可以想象的一件事是您预先测试任何请求。因此，您使用 apache 向 wordpress 发送子请求，如果状态为 404，则将请求委托给 zend。

然后，所有非 404 请求都需要（再次）委托给 wordpress。

但要小心处理。我不认为这真的是你想要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-18T10:30:47.253

如果您只想在 ZF 网站上拥有一个 Wordpress 博客，那么只需将该博客放在子域中或使用 mod_rewrite 将所有请求重写`blog/`到 Wordpress。

如果您尝试做一些需要两个系统之间交互的更复杂的事情，我建议您将所有请求路由到 ZF（使用标准重写规则）。然后让 ZF 决定它是否可以处理请求，如果不能，则包含 Wordpress index.php 并让 Wordpress 完成。有关更多详细信息，请参见此处的答案：[将 Brownfield PHP Webapp 转换为 Zend Framework](https://stackoverflow.com/questions/10451651/converting-a-brownfield-php-webapp-to-zend-framework)。

如果可能的话，您希望避免对 Wordpress 本身进行任何更改，否则升级 WP 将成为一个痛苦的过程。********

# postgresql - 通过 YUM repo 作为默认守护程序用户安装时如何在 centos 上运行 postgres

> ID：12940943
> 
> 赞同：3
> 
> 时间：2012-10-17T18:32:21.213
> 
> 标签：postgresql, centos

通过 Centos 6 上的 yum 存储库新安装的 Postgres 9.2 版本，当它被配置为开箱即用的 'postgres:postgres' (u:g) 运行时，如何以不同的用户身份运行 postgres？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-17T22:14:24.337

除了 AndrewPK 的解释之外，我还想指出，您还可以通过停止和禁用系统 Pg 服务来以任何用户身份启动新的 PostgreSQL 实例，然后使用：

```
initdb -D /path/to/data/directory
pg_ctl start -D /path/to/data/directory 
```

但是，这不会在启动时自动启动服务器。为此，您必须集成到您的初始化系统中。在 CentOS 6 上，/etc/init.d/ 中的简单 System V 风格的初始化脚本和 /etc/rc3.d/ 或 /etc/rc3.d/ 的合适符号链接（取决于默认运行级别）就足够了。

如果一次运行多个实例，它们必须位于不同的端口上。更改 datadir 中的`port`指令`postgresql.conf`或在启动时使用`pg_ctl -o "-p 5433" ...`. `unix_socket_directories`如果您的用户没有对默认套接字目录的写入权限，您可能还需要覆盖。

*   [pg_ctl](http://www.postgresql.org/docs/current/static/app-pg-ctl.html)
*   [初始化数据库](http://www.postgresql.org/docs/current/static/app-initdb.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T18:32:21.213

这仅适用于全新安装（与我的情况有关），因为它涉及删除数据目录。

在使用打包的启动脚本进行全新安装时，我为解决此问题所采取的步骤：

1.  `/var/lib/pgsql/9.2/data`如果您已经通过 initdb 进程并将 postgres user:group 配置为默认值，请删除 postgres 数据目录。
2.  修改启动脚本 ( ) 以替换with`/etc/init.d/postgresql-9.2`的所有实例。`postgres:postgres``NEWUSER:NEWGROUP`
3.  修改启动脚本以将`postgres`任何`$SU -l postgres`行中的所有实例替换为`NEWUSER`.
4.  运行`/etc/init.d/postgres initdb`以使用新用户名重新生成集群
5.  确保创建的所有日志都归新用户所有，或者如果 initdb 上出现错误，则删除旧日志（在我的案例中，配置文件位于 中`/var/lib/pgsql/9.2/data/postgresql.conf`）。
6.  启动 postgres，它现在应该在新用户/组下运行。

我知道这可能不是其他人正在寻找的，如果他们有现有的 postgres 数据库并且想要重新启动服务器以作为不同的用户/组组合运行 - 这不是我的情况，我没有看到任何地方发布的答案使用预打包的启动脚本进行“全新”安装。

# java - 为我的所有 Jlabels JTextArea 等设置通用字体大小

> ID：12940949
> 
> 赞同：2
> 
> 时间：2012-10-17T18:32:44.580
> 
> 标签：java, swing, fonts, jpanel, font-size

你好我有一个奇怪的问题。

我想知道是否以及如何为我的 Jlabels 、TextAreas 以及基本上可以在面板上显示的任何文本进行通用设置。我一直在每个标签上写下字体大小以使其保持一致。但是面板正在增长，我不想在每个标签上硬编码字体大小。

以下是我正在使用并希望在我的所有标签和 textarea 上使用的尺寸。

```
titlelb.getFont().deriveFont( Font.BOLD, (float) 20.); 
lb1.getFont().deriveFont( Font.PLAIN, (float) 11.);
lb2.getFont().deriveFont( Font.BOLD, (float) 11.);
textArea.setFont( Font.decode( "Arial-PLAIN-11")); 
```

我只是想知道有没有一种方法可以通用地设置它，如果可能的话，每个面板都会继承这些特定的大小，我真的不知道如何处理标签的大小，这就是我在这里的原因问。先感谢您。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-17T18:48:30.660

[您可以通过调用在UIManager](http://docs.oracle.com/javase/6/docs/api/javax/swing/UIManager.html)中为您需要的每个组件更改字体属性`UIManager.put("nameOfFontProperty", new Font(Font.DIALOG, FONT.PLAIN, sizeInPixel));`。[您可以在此处](http://www.rgagnon.com/javadetails/JavaUIDefaults.txt)找到包含默认属性的列表。

使所有标签的字体大小为 20px 的一个示例是：

```
UIManager.put("Label.font", UIManager.getFont("Label.font").deriveFont(20.0));
SwingUtilities.updateComponentTreeUI(yourJFrame); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-17T18:42:28.467

为您希望在面板中具有固定字体的任何 JComponent 子类编写自定义包装器类，并在构造函数中添加字体代码。例如：

```
public class JLabelCustom extends JLabel {

    public JLabelCustom(...) {
        super();

        // Font setting code here
        .getFont().deriveFont( Font.BOLD, (float) 20.); 
        .getFont().deriveFont( Font.PLAIN, (float) 11.);
        .getFont().deriveFont( Font.BOLD, (float) 11.);
        this.setFont( Font.decode( "Arial-PLAIN-11"));
    }
} 
```

在您想要标准化字体的任何地方使用自定义 JComponent。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-17T18:42:36.790

您可以创建一个自动设置所有内容的子类。就像是'

```
class UniversalJPanel extends JPanel{
    public UniversalJPanel(){
        super();
        this.setFont(...);
        }
    } 
```

然后你可以使用它而不是常规的 JPanel。JLabel、JTextArea 等也是如此

# java - Java 预处理器 - 将代码插入到每个函数中

> ID：12940953
> 
> 赞同：2
> 
> 时间：2012-10-17T18:32:54.517
> 
> 标签：java, preprocessor, aspectj

我正在寻找一个实用程序，它允许我将大量 .java 文件（我不允许修改）作为输入，并输出使用这些更改修改的相同文件：

1.  在文件顶部添加导入语句
2.  在匹配某个正则表达式（即`* com.foo.*.draw*(*)`）的每个函数中......
    1.  `Func.begin([function name])`在函数开头插入，其中 [function name] 是完全限定的函数名 ( `void com.foo.circle.drawLine(int,int)`)
    2.  `Func.end([function name])`在函数底部插入

但是，我不想将 AspectJ 用于此任务，因为它适用于 .class 文件并且可能会减慢速度。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T20:07:21.590

我可能会使用 Gradle。您不需要制作任何项目 gradle 项目，而只需定义一个用户定义的任务来完成工作。对于现有文件的替换（保留这些文件），我发现 ant 任务支持比 gradle“复制”任务更容易使用。如果您需要保持原始文件不变，您应该使用它！

您可以使用替换插入“导入”：

```
task addImportStatement << {
    ant.replace(dir: 'yourSrcDirHere', token: 'existing value', value:'<![CDATA[existing value
    new import statement here]]>')
}

task regExpressionSub << {
    ant.replaceRegExp(...)
}
regExpressionSub.dependsOn addImportStatement 
```

ant 任务的详细信息[可在在线 ant 手册中找到](http://ant.apache.org/manual/index.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T10:07:36.237

试试我的 Java 注释预处理器，它具有形成前缀和后缀部分的特殊功能（我将它用于导入部分） [http://code.google.com/p/java-comment-preprocessor/](http://code.google.com/p/java-comment-preprocessor/)

# c# - 在 DDD 中将创建日期和创建者放在哪里？

> ID：12940954
> 
> 赞同：9
> 
> 时间：2012-10-17T18:32:55.497
> 
> 标签：c#, entity-framework, design-patterns, ef-code-first, domain-driven-design

我使用实体框架并想使用 DDD 原则。但是，有一些关于实体的信息位于什么是日志记录/持久性信息和什么是关于域对象的信息之间。

我的情况是这些被放在一个抽象基类中，所有实体都继承自：

```
 public abstract class BaseEntity: IBaseEntity
{

    /// <summary>
    /// The unique identifier
    /// </summary>
    public int Id { get; set; }

    /// <summary>
    /// The user that created this instance
    /// </summary>
    public User CreatedBy { get; set; }

    /// <summary>
    /// The date and time the object was created
    /// </summary>
    public DateTime CreatedDate { get; set; }

    /// <summary>
    /// Which user was the last one to change this object
    /// </summary>
    public User LastChangedBy { get; set; }

    /// <summary>
    /// When was the object last changed
    /// </summary>
    public DateTime LastChangedDate { get; set; }

    /// <summary>
    /// This is the status of the entity. See EntityStatus documentation for more information.
    /// </summary>
    public EntityStatus EntityStatus { get; set; }

    /// <summary>
    /// Sets the default value for a new object
    /// </summary>
    protected BaseEntity()
    {
        CreatedDate = DateTime.Now;
        EntityStatus = EntityStatus.Active;
        LastChangedDate = DateTime.Now;
    }

} 
```

现在，如果不提供日期和时间，就无法实例化域对象。但是，我觉得这是放置它的错误位置。我真的可以为两者争辩。也许它根本不应该与域混合？

由于我使用的是 EF Code First，因此将其放在那里是有意义的，否则我还需要创建从 DAL 中的基类继承的新类，复制代码并需要映射到域对象和 MVC 模型看起来确实比上面的方法更混乱。

**问题：**

可以在域模型中使用 DateTime.Now 吗？您使用 DDD 和 EF Code First 将此类信息放在哪里？应该在域对象中设置用户还是在业务层中要求它？

**更新**

我认为 jgauffin 在这里是正确的答案——但这确实是一个非常根本的变化。然而，在我寻找替代解决方案时，我几乎已经解决了这个问题。我使用 ChangeTracker.Entries 来查找是否添加或修改了实体并相应地设置字段。这是在我的 UnitOfWork Save() 方法中完成的。

问题是加载导航属性，如用户（日期时间设置正确）。这可能是因为用户是实体继承的抽象基类的属性。我也不喜欢在里面放字符串，但是它可能会为某人解决一些简单的场景，所以我在这里发布解决方案：

```
 public void SaveChanges(User changedBy)
    {
        foreach (var entry in _context.ChangeTracker.Entries<BaseEntity>())
        {
            if (entry.State == EntityState.Added)
            {
                entry.Entity.CreatedDate = DateTime.Now;
                entry.Entity.LastChangedDate = DateTime.Now;
                entry.Entity.CreatedBy = changedBy;
                entry.Entity.LastChangedBy = changedBy;
            }
            if (entry.State == EntityState.Modified)
            {
                entry.Entity.CreatedDate = entry.OriginalValues.GetValue<DateTime("CreatedDate");
                entry.Entity.CreatedBy = entry.OriginalValues.GetValue<User>("CreatedBy");
                entry.Entity.LastChangedDate = DateTime.Now;
                entry.Entity.LastChangedBy = changedBy;
            }
        }

        _context.SaveChanges();
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-18T08:55:46.183

> 可以在域模型中使用 DateTime.Now 吗？

是的。

> 您使用 DDD 和 EF Code First 将此类信息放在哪里？应该在域对象中设置用户还是在业务层中要求它？

好。首先：DDD 模型始终处于有效状态。这对于公共二传手是不可能的。在 DDD 中，您使用方法来处理模型，因为方法可以确保所有必需的信息都已指定且有效。

例如，如果您可以将某个项目标记为已完成，则`UpdatedAt`日期可能也应该更改。如果您让调用代码确保它很可能会在某个地方被遗忘。相反，你应该有类似的东西：

```
public class MyDomainModel
{
    public void MarkAsCompleted(User completedBy)
    {
        if (completedBy == null) throw new ArgumentNullException("completedBy");
        State = MyState.Completed;
        UpdatedAt = DateTime.Now;
        CompletedAt = DateTime.Now;
        CompletedBy = completedBy;
    }
} 
```

阅读我关于这种方法的博客文章：http: [//blog.gauffin.org/2012/06/protect-your-data/](http://blog.gauffin.org/2012/06/protect-your-data/)

**更新**

> 如何确保以后没有人更改“CreatedBy”和“CreatedDate”

我通常有两个模型的构造函数也适合数据库。一个受保护的可以由我的持久层使用，一个需要必填字段。将 createdby 放入该构造函数并在其中设置 createdate：

```
public class YourModel
{
    public YourModel(User createdBy)
    {
        CreatedDate = DateTime.Now;
        CreatedBy = createdby;
    }

    // for persistance
    protected YourModel()
    {}
} 
```

然后有这些领域的私人二传手。

> 我收到很多 R# 警告“构造函数中的虚拟成员调用”，我以前读过它，这不应该是一个好习惯。

这通常不是问题。在这里阅读：[构造函数中的虚拟成员调用](https://stackoverflow.com/questions/119506/virtual-member-call-in-a-constructor)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-17T19:24:15.277

> 可以在域模型中使用 DateTime.Now 吗？

这并不可怕，但问题是您最终将不得不复制代码，并且更难以实现一致性。

> 您使用 DDD 和 EF Code First 将此类信息放在哪里？

您断言此类信息不属于您的域是正确的。它通常称为审计日志或跟踪。有几种方法可以使用 EF 实施审计。例如，查看[AuditDbContext - 实体框架审计上下文](http://auditdbcontext.codeplex.com/)，或者只是搜索 EF 审计实现。这个想法是，在 EF 对实体进行更改之前，它会引发一个事件，您可以收听并分配所需的审计值。

> 应该在域对象中设置用户还是在业务层中要求它？

最好在基础架构/存储库级别使用上述审计实施来处理此问题。这是数据持久化之前的最后一站，因此是处理此问题的理想场所。

# redirect - phonegap：打开外部页面，然后返回应用程序

> ID：12940955
> 
> 赞同：7
> 
> 时间：2012-10-17T18:32:55.953
> 
> 标签：redirect, cordova, external-links

好的，浏览问题我找到了将外部页面加载到 phonegap 视图中的正确方法（即不丢失会话或打开设备浏览器），如下所述：[如何在 phonegap webview 中加载网页？](https://stackoverflow.com/questions/8596772/how-can-i-load-a-webpage-inside-the-phonegap-webview) 在这里：[iPhone 的 PhoneGap：加载外部 URL 时出现问题](https://stackoverflow.com/questions/5911255/phonegap-for-iphone-problem-loading-external-url)

下一步是：在我打开一个外部页面（它归我所有，我可以修改它）之后，我怎样才能回到我的本地应用程序？假设我在外部页面中有一个链接，我希望用户在点击时被重定向回 phonegap 应用程序内的本地 html 页面 (mypage.html)。

链接的 href 属性应该有什么 url？我尝试将其设置为“file:///android_asset/www/mypage.html”但没有用

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T20:08:29.780

您想使用[ChildBrowser](https://github.com/phonegap/phonegap-plugins/tree/master/iOS/ChildBrowser)插件打开外部网页。然后您想将 ChildBrowser.onLocationChange 属性设置为您自己的函数。然后，当此人离开远程页面时，您将收到位置更改通知，以便您可以关闭 ChildBrowser 并导航到新的本地页面。您甚至不需要触摸远程 html 页面。

因此，当用户离开远程页面时关闭浏览器：

```
cb.onLocationChange = function(loc){
    console.log("location = " + loc);
    if (loc != "http://example.com") {
        cb.close();
    }
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-05T09:12:27.477

您需要的是 MainViewController.m 中的这个迷人者 它在科尔多瓦 1.7.0 科尔多瓦 1.9.0 和科尔多瓦 2.1.0 中对我有用

```
- (BOOL)webView:(UIWebView *)theWebView shouldStartLoadWithRequest:(NSURLRequest *)request         navigationType:(UIWebViewNavigationType)navigationType
{
NSURL *url = [request URL];

// Intercept the external http requests and forward to Safari.app
// Otherwise forward to the PhoneGap WebView
if ([[url scheme] isEqualToString:@"http"] || [[url scheme] isEqualToString:@"https"]) {
[[UIApplication sharedApplication] openURL:url];
return NO;
}
else {
return [ super webView:theWebView shouldStartLoadWithRequest:request navigationType:navigationType ];
}
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-06T15:19:35.850

这是使用 PhoneGap/Cordova 2.7。在您的外部应用程序中，添加一个指向“app://index”的链接。

在 onCreate 里面添加：

```
this.appView.setWebViewClient(new CordovaWebViewClient(this, this.appView) {

    @Override
    public boolean shouldOverrideUrlLoading(WebView view, String url) {
        if(url.equalsIgnoreCase("app://index")) {
            Log.d("DEBUG", url);

            loadUrl(Config.getStartUrl());

            return true;
        } else {
            return super.shouldOverrideUrlLoading(view, url);
        }
    }
}); 
```

这将拦截呼叫并将用户重定向到配置的起始 url。

# map - 带有链接到网站的表格中的文本的可排序表格

> ID：12940962
> 
> 赞同：2
> 
> 时间：2012-10-17T18:33:30.383
> 
> 标签：map, filter, xhtml, google-api, google-visualization

这是我发现的创建可排序表的代码。我想让表格中的文字链接到列出的文章。我怎样才能做到这一点？

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<title>Sortable Table</title>
<script type="text/javascript" src="http://www.google.com/jsapi"></script>
<script type="text/javascript">
  google.load('visualization', '1.1', {packages: ['controls']});
</script>
<script type="text/javascript">

  function drawVisualization() {
    // Prepare the data.
    var data = google.visualization.arrayToDataTable([
      ['Article', 'Year'],
      ['Article 1 link', 2012],
      ['Article 2 link', 2006],
      ['Article 3 link', 2010],
      ['Article 4 link', 1996],
      ['Article 5 link', 2002],
      ['Article 6 link', 1999],
      ['Article 7 link', 1942],
      ['Article 8 link', 2012]
    ]);

    // Define a StringFilter control for the 'Article' column
    var stringFilter = new google.visualization.ControlWrapper({
      'controlType': 'StringFilter',
      'containerId': 'control1',
      'options': {
        'filterColumnLabel': 'Article'
      }
    });

    // Define a table visualization
    var table = new google.visualization.ChartWrapper({
      'chartType': 'Table',
      'containerId': 'chart1',
      'options': {'height': '13em', 'width': '20em'}
    });

    // Create the dashboard.
    var dashboard = new google.visualization.Dashboard(document.getElementById('dashboard')).
      // Configure the string filter to affect the table contents
      bind(stringFilter, table).
      // Draw the dashboard
      draw(data);
  }

  google.setOnLoadCallback(drawVisualization);
    </script>
  </head>
  <body style="font-family: Arial;border: 0 none;">
    <div id="dashboard">
      <table>
        <tr style='vertical-align: top'>
          <td height="200" style='width: 300px; font-size: 0.9em;'>
        <div id="control1"></div>
        <div id="control2"></div>
        <div id="control3"></div>
      </td>
      <td style='width: 600px'>
        <div style="float: left;" id="chart1"></div>
        <div style="float: left;" id="chart2"></div>
            <div style="float: left;" id="chart3"></div>
          </td>
        </tr>
      </table>
    </div>
  </body>
</html> 
```

​</p>

# java - 是否可以使用字符串作为切换值将 if-else 替换为 switch 语句？

> ID：12940969
> 
> 赞同：0
> 
> 时间：2012-10-17T18:34:03.300
> 
> 标签：java, action, switch-statement

我想知道在这种情况下是否可以使用 switch 语句而不是 if-else 语句。变量取自 JComboBoxes 并在此处由 ActionEvent 处理：

```
public void actionPerformed(ActionEvent event) {

    Object source = event.getSource();

     if (source == comboUnit) {

        String unit = comboUnit.getSelectedItem().toString();

            if (unit.equals("Unit 1")) {
            unitValue = Double.parseDouble(tfUnit.getText());
            valMeter = unitValue * defined1;
            labelDesc.setText("Unit 1");
            convert();
        }

        else if (unit.equals("Unit 2")) {
            unitValue = Double.parseDouble(tfUnit.getText());
            valMeter = unitValue * defined2;
            labelDesc.setText("Unit 2");
            convert();
        }
(...) 
```

我试图将纯字符串作为值传递，但没有成功。您对应该如何完成（以及是否可能）有任何提示吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T18:35:03.240

Java 7 允许您`switch`在`String`s.

但是他们说如果有人饿了，最好教他们如何钓鱼，而不是给他们一条鱼。从长远来看。我的意思是你的代码需要重构，是使用枚举还是[映射](http://docs.oracle.com/javase/6/docs/api/java/lang/Enum.html)`switch`是[第二](http://docs.oracle.com/javase/6/docs/api/java/util/Map.html)个问题。

你有太多重复的代码在做同样的事情。我指的是：

```
unitValue = Double.parseDouble(tfUnit.getText());
valMeter = unitValue * defined1;
labelDesc.setText("Unit 1");
convert(); 
```

显然，因为您根据使用的单位使用不同的因子进行乘法运算，所以您需要一个对要使用的因子进行单位评估的函数。用较少的数学术语来说，您需要一些能够产生`defined1`或者`defined2`取决于提供的字符串的值的东西。您已经有了相关`unit`单位的“名称”，您可以使用它。我调用返回因子的方法`factor`，接受单位名称并返回a `Number`（因为无论您是乘以整数还是某种实数，它都没有遵循您的示例）。我还假设您的`defined1`等`defined2`是变量或文字。

```
unitValue = Double.parseDouble(tfUnit.getText());
valMeter = unitValue * factor(unit);
labelDesc.setText(unit);
convert();

Number factor(String unitName)
{
     switch(unitName)
     {
         case "Unit 1": return defined1;
         case "Unit 2": return defined2;
         default: throw new Exception("Unknown unit");
     }
} 
```

该方法本身就是您的“切换或不切换”问题蔓延的地方。如果您愿意，您可以自由使用[地图](http://docs.oracle.com/javase/6/docs/api/java/util/Map.html)：

```
Map<String, Number> unitNameValueMap = new HashMap<String, Number>();

unitNameValueMap.put("Unit 1", defined1);
unitNameValueMap.put("Unit 2", defined2);

Number factor(String unitName)
{
    Number result = unitNameValueMap.get(unitName);

    if(result == null)
    {
        throw new Exception("Unknown unit");
    }

    return result;
} 
```

或者您可以使用枚举：

```
enum UnitValue
{
    UNIT1(defined1), UNIT2(defined2);

    final Number value;

    private UnitValue(Number value)
    {
        this.value = value;
    }
}

Number factor(String unitName)
{
    return Enum.valueOf(UnitValue.class, "UNIT" + Integer.parseInt(unitName.substring(5)).value;
} 
```

您甚至可以`switch`或在枚举中使用映射，这也将为您提供良好的代码可读性。

您需要分析您的程序以查看您是否需要`switch`基于 - 的解决方案或基于枚举的解决方案或基于地图的解决方案。它当前的方式以及您自己可以看到的方式，`enum`基于 - 的解决方案有点混乱，因为您的单位名称、枚举常量和它们的值之间的关系。如果有人可以用枚举做得更好，那么自然而然地取而代之的是他们的代码。

通常，最短的代码是最好的，因为它更容易阅读并且最容易理解。但是要小心使用地图——它们比其他解决方案产生更多的开销，所以我更喜欢在地图较少且每个有很多键的情况下使用它们，而不是相反。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T18:34:59.897

您可以使用`Enum`枚举值替换字符串

```
public static void main(String[] args) {
    Units unit = Units.Unit1;
    switch (unit) {
    case Unit1:
        break;
    case Unit2:
        break;
    }
}

enum Units {
    Unit1, Unit2,
} 
```

Java 7 允许您[在 switch 语句中使用字符串](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/switch.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-17T18:35:19.280

你的意思是喜欢

```
switch (unit) {
case "Unit 1":
  // do something
  break;

case "Unit 2":

} 
```

?

是的，你可以，从 Java7 开始。

但就您而言，您似乎既不需要 switch 也不需要 if/else。在这两种情况下你都做同样的事情：

```
 String unit = comboUnit.getSelectedItem().toString();
 unitValue = Double.parseDouble(tfUnit.getText());
 valMeter = unitValue * defined1;
 labelDesc.setText(unit);
 convert(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-17T18:36:52.820

只有在 Java 7 及更高版本中才能在 switch-case 语句中使用字符串。这是文档的链接，您需要向下滚动到字符串部分。

[http://docs.oracle.com/javase/tutorial/java/nutsandbolts/switch.html](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/switch.html)

# javascript - 在AngularJS中的视图之间更改时保持范围模型

> ID：12940974
> 
> 赞同：152
> 
> 时间：2012-10-17T18:34:33.113
> 
> 标签：javascript, angularjs

我正在学习 AngularJS。假设我有*/view1*使用*My1Ctrl*和*/view2*使用*My2Ctrl*；可以使用选项卡导航到每个视图都有自己简单但不同的形式。

当用户离开然后返回*view1*时，我如何确保以*view1*的形式输入的值不会被重置？

 **我的意思是，对view1*的第二次访问如何保持与我离开时完全相同的模型状态？

* * *

## 回答 #1

> 赞同：175
> 
> 时间：2013-05-15T08:08:18.420

我花了一些时间来弄清楚这样做的最佳方法是什么。我还想保持状态，当用户离开页面然后按下后退按钮时，回到旧页面；而不仅仅是将我所有的数据放入*rootscope*。

最终的结果是每个*控制器都有一个**服务*。在控制器中，您只拥有您不关心的函数和变量，如果它们被清除的话。

 *控制器的服务是通过依赖注入来注入的。由于服务是单例的，它们的数据不会像控制器中的数据那样被破坏。

在服务中，我有一个模型。该模型只有数据-没有功能-。这样它就可以从 JSON 来回转换以保持它。我使用 html5 localstorage 进行持久化。

最后我使用`window.onbeforeunload`and`$rootScope.$broadcast('saveState');`让所有服务知道他们应该保存他们的状态，并`$rootScope.$broadcast('restoreState')`让他们知道恢复他们的状态（用于当用户离开页面并按下后退按钮分别返回页面时）。

我的**userController的名为****userService**的示例服务：

 **```
app.factory('userService', ['$rootScope', function ($rootScope) {

    var service = {

        model: {
            name: '',
            email: ''
        },

        SaveState: function () {
            sessionStorage.userService = angular.toJson(service.model);
        },

        RestoreState: function () {
            service.model = angular.fromJson(sessionStorage.userService);
        }
    }

    $rootScope.$on("savestate", service.SaveState);
    $rootScope.$on("restorestate", service.RestoreState);

    return service;
}]); 
```

**用户控制器**示例

```
function userCtrl($scope, userService) {
    $scope.user = userService;
} 
```

然后视图使用这样的绑定

```
<h1>{{user.model.name}}</h1> 
```

在*app 模块*中，在 run 函数中，我处理*saveState*和*restoreState*的*广播*

 **```
$rootScope.$on("$routeChangeStart", function (event, next, current) {
    if (sessionStorage.restorestate == "true") {
        $rootScope.$broadcast('restorestate'); //let everything know we need to restore state
        sessionStorage.restorestate = false;
    }
});

//let everthing know that we need to save state now.
window.onbeforeunload = function (event) {
    $rootScope.$broadcast('savestate');
}; 
```

正如我所提到的，这需要一段时间才能达到这一点。这是一种非常干净的方式，但是做一些我怀疑在 Angular 中开发时很常见的问题是相当多的工程。

我希望看到更简单但更简洁的方式来处理跨控制器保持状态，包括用户离开和返回页面的时间。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2013-09-26T05:29:08.900

答案有点晚了，但刚刚更新了一些最佳实践

[jsfiddle](http://jsfiddle.net/BRWPM/340/)

```
var myApp = angular.module('myApp',[]);
myApp.factory('UserService', function() {
    var userService = {};

    userService.name = "HI Atul";

    userService.ChangeName = function (value) {

       userService.name = value;
    };

    return userService;
});

function MyCtrl($scope, UserService) {
    $scope.name = UserService.name;
    $scope.updatedname="";
    $scope.changeName=function(data){
        $scope.updateServiceName(data);
    }
    $scope.updateServiceName = function(name){
        UserService.ChangeName(name);
        $scope.name = UserService.name;
    }
} 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-10-18T18:23:23.577

$rootScope 是一个大的全局变量，它适用于一次性的东西或小型应用程序。如果您想封装您的模型和/或行为（并可能在其他地方重用它），请使用服务。除了提到的 OP 的 google 组帖子之外，另请参阅[https://groups.google.com/d/topic/angular/eegk_lB6kVs/discussion](https://groups.google.com/d/topic/angular/eegk_lB6kVs/discussion)。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2015-05-29T11:00:24.503

Angular 并没有真正提供你正在寻找的开箱即用的东西。我会做的是使用以下附加组件来完成您所追求的

[UI 路由器](https://github.com/angular-ui/ui-router)和[UI 路由器附加功能](http://christopherthielen.github.io/ui-router-extras/#/home)

这两个将为您提供基于状态的路由和粘性状态，您可以在状态之间进行选项卡，并且所有信息都将保存为可以说“保持活动状态”的范围。

检查两者的文档，因为它非常简单，ui router extras 也很好地[演示](http://christopherthielen.github.io/ui-router-extras/example/sticky/index.html#/)了粘性状态是如何工作的。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2014-06-27T20:37:16.740

我遇到了同样的问题，这就是我所做的：我有一个 SPA，在同一页面中有多个视图（没有 ajax），所以这是模块的代码：

```
var app = angular.module('otisApp', ['chieffancypants.loadingBar', 'ngRoute']);

app.config(['$routeProvider', function($routeProvider){
    $routeProvider.when('/:page', {
        templateUrl: function(page){return page.page + '.html';},
        controller:'otisCtrl'
    })
    .otherwise({redirectTo:'/otis'});
}]); 
```

我对所有视图只有一个控制器，但是，问题与问题相同，控制器总是刷新数据，为了避免这种行为，我做了上面人们建议的操作，为此目的创建了一个服务，然后通过它控制器如下：

```
app.factory('otisService', function($http){
    var service = {            
        answers:[],
        ...

    }        
    return service;
});

app.controller('otisCtrl', ['$scope', '$window', 'otisService', '$routeParams',  
function($scope, $window, otisService, $routeParams){        
    $scope.message = "Hello from page: " + $routeParams.page;
    $scope.update = function(answer){
        otisService.answers.push(answers);
    };
    ...
}]); 
```

现在我可以从我的任何视图中调用更新函数，传递值并更新我的模型，我不需要使用 html5 api 来获取持久性数据（在我的情况下，也许在其他情况下需要使用 html5 api 像 localstorage 和其他东西）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-01-23T17:08:34.027

服务的替代方案是使用价值存储。

在我的应用程序的基础上，我添加了这个

```
var agentApp = angular.module('rbAgent', ['ui.router', 'rbApp.tryGoal', 'rbApp.tryGoal.service', 'ui.bootstrap']);

agentApp.value('agentMemory',
    {
        contextId: '',
        sessionId: ''
    }
);
... 
```

然后在我的控制器中，我只引用值存储。如果用户关闭浏览器，我认为它不存在。

```
angular.module('rbAgent')
.controller('AgentGoalListController', ['agentMemory', '$scope', '$rootScope', 'config', '$state', function(agentMemory, $scope, $rootScope, config, $state){

$scope.config = config;
$scope.contextId = agentMemory.contextId;
... 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-08-26T22:19:53.877

**适用于多个范围和这些范围内的多个变量的解决方案**

该服务基于 Anton 的回答，但更具可扩展性，可以跨多个范围工作，并允许在同一范围内选择多个范围变量。它使用路由路径来索引每个范围，然后范围变量名称来索引更深一层。

**使用以下代码创建服务：**

```
angular.module('restoreScope', []).factory('restoreScope', ['$rootScope', '$route', function ($rootScope, $route) {

    var getOrRegisterScopeVariable = function (scope, name, defaultValue, storedScope) {
        if (storedScope[name] == null) {
            storedScope[name] = defaultValue;
        }
        scope[name] = storedScope[name];
    }

    var service = {

        GetOrRegisterScopeVariables: function (names, defaultValues) {
            var scope = $route.current.locals.$scope;
            var storedBaseScope = angular.fromJson(sessionStorage.restoreScope);
            if (storedBaseScope == null) {
                storedBaseScope = {};
            }
            // stored scope is indexed by route name
            var storedScope = storedBaseScope[$route.current.$$route.originalPath];
            if (storedScope == null) {
                storedScope = {};
            }
            if (typeof names === "string") {
                getOrRegisterScopeVariable(scope, names, defaultValues, storedScope);
            } else if (Array.isArray(names)) {
                angular.forEach(names, function (name, i) {
                    getOrRegisterScopeVariable(scope, name, defaultValues[i], storedScope);
                });
            } else {
                console.error("First argument to GetOrRegisterScopeVariables is not a string or array");
            }
            // save stored scope back off
            storedBaseScope[$route.current.$$route.originalPath] = storedScope;
            sessionStorage.restoreScope = angular.toJson(storedBaseScope);
        },

        SaveState: function () {
            // get current scope
            var scope = $route.current.locals.$scope;
            var storedBaseScope = angular.fromJson(sessionStorage.restoreScope);

            // save off scope based on registered indexes
            angular.forEach(storedBaseScope[$route.current.$$route.originalPath], function (item, i) {
                storedBaseScope[$route.current.$$route.originalPath][i] = scope[i];
            });

            sessionStorage.restoreScope = angular.toJson(storedBaseScope);
        }
    }

    $rootScope.$on("savestate", service.SaveState);

    return service;
}]); 
```

**将此代码添加到应用模块中的运行函数中：**

```
$rootScope.$on('$locationChangeStart', function (event, next, current) {
    $rootScope.$broadcast('savestate');
});

window.onbeforeunload = function (event) {
    $rootScope.$broadcast('savestate');
}; 
```

**将 restoreScope 服务注入您的控制器（如下示例）：**

```
function My1Ctrl($scope, restoreScope) {
    restoreScope.GetOrRegisterScopeVariables([
         // scope variable name(s)
        'user',
        'anotherUser'
    ],[
        // default value(s)
        { name: 'user name', email: 'user@website.com' },
        { name: 'another user name', email: 'anotherUser@website.com' }
    ]);
} 
```

上面的示例会将 $scope.user 初始化为存储的值，否则将默认为提供的值并将其保存。如果页面关闭、刷新或路由发生变化，所有注册的作用域变量的当前值将被保存，并在下次访问该路由/页面时恢复。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-07-07T10:58:49.737

您可以使用`$locationChangeStart`事件将先前的值存储在服务中`$rootScope`或服务中。当你回来时，只需初始化所有以前存储的值。这是一个使用`$rootScope`.

[![在此处输入图像描述](../Images/854752eb196f43feb082ecc63bdc861b.png)](https://i.stack.imgur.com/WdLSR.gif)

```
var app = angular.module("myApp", ["ngRoute"]);
app.controller("tab1Ctrl", function($scope, $rootScope) {
    if ($rootScope.savedScopes) {
        for (key in $rootScope.savedScopes) {
            $scope[key] = $rootScope.savedScopes[key];
        }
    }
    $scope.$on('$locationChangeStart', function(event, next, current) {
        $rootScope.savedScopes = {
            name: $scope.name,
            age: $scope.age
        };
    });
});
app.controller("tab2Ctrl", function($scope) {
    $scope.language = "English";
});
app.config(function($routeProvider) {
    $routeProvider
        .when("/", {
            template: "<h2>Tab1 content</h2>Name: <input ng-model='name'/><br/><br/>Age: <input type='number' ng-model='age' /><h4 style='color: red'>Fill the details and click on Tab2</h4>",
            controller: "tab1Ctrl"
        })
        .when("/tab2", {
            template: "<h2>Tab2 content</h2> My language: {{language}}<h4 style='color: red'>Now go back to Tab1</h4>",
            controller: "tab2Ctrl"
        });
});
```

```
<!DOCTYPE html>
<html>
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular-route.js"></script>
<body ng-app="myApp">
    <a href="#/!">Tab1</a>
    <a href="#!tab2">Tab2</a>
    <div ng-view></div>
</body>
</html>
```******

# javascript - 将类元素恢复为默认值

> ID：12940977
> 
> 赞同：0
> 
> 时间：2012-10-17T18:34:41.180
> 
> 标签：javascript, jquery, html

我有 4 个箭头，每个箭头都在移动片段元素，现在我想创建一个重置按钮，将片段返回到默认位置

```
//piece object
var piece = {};
piece.el = $('#piece');
piece.moveDelta = function(dx, dy){
    var pos = this.el.position();
    this.el.css('left', pos.left+dx);
    this.el.css('top', pos.top+dy);
};
$(document).ready(function(){
    //init deltas
    $('#btn-up').data('dx', 0).data('dy', -100);
    $('#btn-left').data('dx', -100).data('dy', 0);
    $('#btn-right').data('dx', 100).data('dy', 0);
    $('#btn-down').data('dx', 0).data('dy', 100);
    //assign click event
    $('.btn-arrow').click(function(){
        piece.moveDelta($(this).data('dx'), $(this).data('dy'));
    });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T18:40:20.083

```
 //piece object
var piece = {};

var defaultX = null;
var defaultY = null;

piece.el = $('#piece');
piece.moveDelta = function(dx, dy){
    var pos = this.el.position();
    if(defaultX === null && defaultY === null ){
         defaultX = pos.left;
         defaultY = pos.top;
    }
    this.el.css('left', pos.left+dx);
    this.el.css('top', pos.top+dy);
};
piece.reset = function () {
   this.el.css('left', defaultX);
   this.el.css('top', defaultY);
};
$(document).ready(function(){
    //init deltas
    $('#btn-up').data('dx', 0).data('dy', -100);
    $('#btn-left').data('dx', -100).data('dy', 0);
    $('#btn-right').data('dx', 100).data('dy', 0);
    $('#btn-down').data('dx', 0).data('dy', 100);

    //assign click event
    $('.btn-arrow').click(function(){
        piece.moveDelta($(this).data('dx'), $(this).data('dy'));
    });
    $("#btn-reset").click(function(){
       piece.reset();
    });

}); 
```

您可以使用`reset`上面定义的方法。[**小提琴**](http://jsfiddle.net/8gyFE/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T18:39:35.297

您可以将 CSS 属性设置为空字符串以重置它们：http: [//jsfiddle.net/myJCq/](http://jsfiddle.net/myJCq/)。

```
piece.reset = function() {
    this.el.css({ left: '', top: '' });
}; 
```

# android - 检测来自后台的应用程序并在 Android 中提示输入 PIN

> ID：12940978
> 
> 赞同：4
> 
> 时间：2012-10-17T18:34:41.567
> 
> 标签：android

我有一个应用程序，每次应用程序来自后台时，我都需要提示用户输入 PIN。

我从@hackbod 和@commonsware 的stackoverflow 中查看了几个答案，我从@commonsware 实现了超时方法，它运行良好，但我的用户对此并不满意。当应用程序来自后台时，他们希望每次都提示输入 PIN。

现在我通过让每个活动增加 onStart 中的计数器并减少 onStop 中的计数来实现来自@hackbod 的解决方案。 [Android检测应用程序是否进入后台](https://stackoverflow.com/questions/5836843/android-detecting-if-an-application-entered-the-background)

但问题是当用户更改当前活动的方向时，计数器设置回 0 并且我的应用程序认为用户来自后台。我的 onStart() 递增计数器，而 onStop 递减计数器。我希望 android 来处理方向变化，因为我有不同的布局用于不同的方向。

我现在不想使用 GET_TASKS 方法。所有建议表示赞赏..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T18:43:40.697

看一下[活动生命周期](http://developer.android.com/reference/android/app/Activity.html#ActivityLifecycle)。如果我要完成这样的事情，我会让每个活动都请求一个 pin，除非他们的活动是从一个意图开始的，并且当前 pin 的 Extra 值。

**启动活动：**

```
Intent intent = new Intent(getBaseContext(), NewActivity.class);
intent.putExtra("PIN", storedPIN);
startActivity(intent); 
```

**活动开始：**

```
@Override
public void onResume() {
    super.onResume();

    Bundle extras = getIntent().getExtras();
    if (extras != null) {
        String value = extras.getString("PIN");
    }

    //Check pin to make sure it matches stored pin
    //Else prompt for pin
} 
```

在这种方法下，当应用程序第一次启动时，它会提示输入密码。在主活动启动其他活动时输入 pin 后，它将传递存储的 PIN，并且不会再次提示输入 pin。

当它开始另一个活动时，您可能还必须清除当前活动的额外内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T18:50:32.580

在某个时刻，我正在寻找非常相似的行为。这是我提出的赏金问题：

[如何始终从 Android 上的启动活动开始？](https://stackoverflow.com/questions/10451171/how-to-always-start-from-a-startup-activity-on-android)

它有很多不同的方法。然而，他们每个人都有一些缺点。

# java - 在 Java 中使用反射递归查找 PropertyDescriptor

> ID：12940979
> 
> 赞同：1
> 
> 时间：2012-10-17T18:34:47.510
> 
> 标签：java, reflection, introspection

无论如何使用Java反射递归地找到属性描述符？

想象这样一个场景，其中一个 User 类有一个名为 profile 的字段，它本身就是另一个具有 email 属性的类。

通过拥有用户对象，我需要能够访问 profile.email，因此理想的方法签名应该类似于以下内容：

```
public PropertyDescriptor findPropertyDescriptor(Class<?> clazz, String path)
{
    // Code!
} 
```

电话将类似于：

```
findPropertyDescriptor(User.class, "profile.email") 
```

我也认为像下面这样的调用也应该是可能的：

```
findPropertyDescriptor(User.class, "addresses[2].postCode") 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T10:49:22.430

由于没有人提出解决方案，我必须在这里回答我的问题。

感谢 Spring，这已经实现：

```
public static <T> PropertyDescriptor getPropertyDescriptor(T rootObject, String path)
{
    BeanWrapperImpl wrapper = new BeanWrapperImpl(rootObject);
    return wrapper.getPropertyDescriptor(path);
} 
```

除了问题中提到的要求外，它还支持地图。

# ssis - 刷新具有索引和约束的表

> ID：12940988
> 
> 赞同：0
> 
> 时间：2012-10-17T18:35:12.567
> 
> 标签：ssis, sql-server-2008-r2, constraints, database-indexes

我有以下场景，我需要在 SQL Server 2008 R2 中使用位于另一台服务器上的数据重新加载表。目标表具有索引（集群和非集群）和约束（多个表的外键），而主键也是另一个单独表的外键。目标表上的主键也是一个身份。

我会说，在处理这种情况时，最合适的“最佳实践”是什么？

以下是否合理：

*   删除目标表上的索引 - （SQL 脚本任务）
    *   首先删除非聚集索引
    *   二、drop聚集索引
*   从源表到目标表的数据流点。
    *   在目标编辑器中，选中 Keep Identity、Keep nulls，并取消选中 Check constraint
*   在目标表上创建索引 -（SQL 脚本任务）

请注意，源表和目标表中的表结构和约束应相同。换句话说，从 QA 到开发，每件事都只是重新加载数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T18:53:23.657

看起来不错，但`Don't drop clustered index` 如果你愿意，你可以禁用所有外键约束，加载后如果你的数据不是关系一致性，你可以使用 NOCHECK 启用

# django - Django - 如何将消息用于内置视图

> ID：12940993
> 
> 赞同：0
> 
> 时间：2012-10-17T18:35:19.540
> 
> 标签：django, django-views, django-urls

我将登录视图从基于类的视图转移到内置视图，即：`django.contrib.auth.views.login`

在那之前 ; 我一直在我的views.py 中使用django 消息。

但我不知道如何在内置视图下做到这一点。

这是我的 urls.py：

```
urlpatterns = patterns('',
    url(r'^', include('blog.urls')),
    url(r'^login/$', 'django.contrib.auth.views.login', {'template_name': 'login.html'}, name='login'),
    url(r'^admin/logout', 'django.contrib.auth.views.logout_then_login', name='logout'),
) 
```

以及我在 login.html 中想要的内容：

```
{% for message in messages %}
    <div id="notice" align="center">
        {{ message }}
    </div>
    {% ifequal message.tags 'ERROR' %}
        <div id="notice" align="center">{{ message }}</div>
    {% endifequal %}
{% endfor %} 
```

我在哪里以及如何定义消息？

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T18:49:53.813

只要您正确设置消息，它就应该在您的模板中可用。

[https://docs.djangoproject.com/en/dev/ref/contrib/messages/#enabling-messages](https://docs.djangoproject.com/en/dev/ref/contrib/messages/#enabling-messages)

# java - 为二十一点创建人工智能

> ID：12940994
> 
> 赞同：3
> 
> 时间：2012-10-17T18:35:24.250
> 
> 标签：java, artificial-intelligence, blackjack

我正在尝试制作二十一点游戏！我在玩家互动方面很成功！然而，我决定加强它，做一些人工智能，这样我就可以和人工智能对战，可以说有更多的战斗。

不过，我的主要问题是，我已经在这里坐了大约一个小时左右，思考人工智能是如何工作的以及我如何使用它，但我一直无法想到任何可行的方法。所以我想知道是否有人有任何想法，或者能够指导我一个方向。

我没有任何启动 AI 的代码，因为我想不出如何启动或使用它。这就是为什么我希望有某种方向。

现在我将发布我认为所有相关的课程。我确实遗漏了游戏课程。游戏类只是用于验证和检查卡片和所有令人惊奇的东西。

班级卡：

```
public class Card{
private int rank, suit;

private String[] suitNames = new String[]{ "H", "C", "S", "D" };
private String[] rankNumber = new String[]{ "A", "2", "3", "4", "5", "6", "7", "8", "9", "10", "J", "Q", "K" };
private int[] points = new int[]{1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 10, 10, 10};

Card(int suitIndex, int rankIndex){
    rank = rankIndex;
    suit = suitIndex;
}

public @Override String toString(){
    return rankNumber[rank]+suitNames[suit]; 
}

public int getRank(){
    return rank;
}

public int getSuit(){
    return suit;
}

public String getSuitName(){
    return suitNames[suit];
}

public String getRankName(){
    return rankNumber[rank];
}

public int getPoints(){
     return points[rank];
}

public ImageIcon ImageOfCard() throws Exception{
    ImageIcon icon = new ImageIcon("/StandardDeck/GameCards/"+getRankName() + getSuitName()+".png");
    return icon;
}
} 
```

类 BlackJack（包含所有东西的游戏）是的，我确实使用 Java GUI 来处理它。

```
public class BlackJack extends JFrame {
Game game;
Deck deck;
Card cards;
Player player;
Dealer dealer;
JLabel[] playerCardSlots;
JLabel[] dealerCardSlots;

public BlackJack() {
    String name = JOptionPane.showInputDialog(null, "Enter your name");
    deck = new Deck(4);
    game = new Game();
    player = new Player(name);
    dealer = new Dealer(deck);

    initComponents();
    SetButtons(false);
    playerCardSlots = new JLabel[]{Player1Card1, Player1Card2, Player1Card3, Player1Card4, Player1Card5};
    dealerCardSlots = new JLabel[]{DealerCard1, DealerCard2, DealerCard3, DealerCard4, DealerCard5};
}

@SuppressWarnings("unchecked")
// <editor-fold defaultstate="collapsed" desc="Generated Code">                          
private void initComponents() {

    Player1Card1 = new javax.swing.JLabel();
    Player1Card2 = new javax.swing.JLabel();
    Player1Card3 = new javax.swing.JLabel();
    Player1Card4 = new javax.swing.JLabel();
    Player1Card5 = new javax.swing.JLabel();
    Player1Name = new javax.swing.JLabel();
    HitButton = new javax.swing.JButton();
    StandButton = new javax.swing.JButton();
    PointsLabel = new javax.swing.JLabel();
    DealButton = new javax.swing.JButton();
    DealerCard1 = new javax.swing.JLabel();
    DealerCard2 = new javax.swing.JLabel();
    DealerCard3 = new javax.swing.JLabel();
    DealerCard4 = new javax.swing.JLabel();
    DealerCard5 = new javax.swing.JLabel();
    DealerPointsLabel = new javax.swing.JLabel();
    DealerLabel = new javax.swing.JLabel();

    setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

    Player1Name.setText("Player 1 Name");

    HitButton.setText("Hit");
    HitButton.addActionListener(new java.awt.event.ActionListener() {
        public void actionPerformed(java.awt.event.ActionEvent evt) {
            HitButtonActionPerformed(evt);
        }
    });

    StandButton.setText("Stand");
    StandButton.addActionListener(new java.awt.event.ActionListener() {
        public void actionPerformed(java.awt.event.ActionEvent evt) {
            StandButtonActionPerformed(evt);
        }
    });

    PointsLabel.setText("points");

    DealButton.setText("Deal");
    DealButton.addActionListener(new java.awt.event.ActionListener() {
        public void actionPerformed(java.awt.event.ActionEvent evt) {
            DealButtonActionPerformed(evt);
        }
    });

    DealerPointsLabel.setText("points");

    DealerLabel.setText("Dealer");

    org.jdesktop.layout.GroupLayout layout = new org.jdesktop.layout.GroupLayout(getContentPane());
    getContentPane().setLayout(layout);
    layout.setHorizontalGroup(
        layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
        .add(layout.createSequentialGroup()
            .add(54, 54, 54)
            .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
                .add(layout.createSequentialGroup()
                    .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
                        .add(layout.createSequentialGroup()
                            .add(76, 76, 76)
                            .add(Player1Name)
                            .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                        .add(org.jdesktop.layout.GroupLayout.TRAILING, layout.createSequentialGroup()
                            .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 104, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                            .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
                                .add(DealerPointsLabel)
                                .add(PointsLabel))
                            .add(128, 128, 128)))
                    .add(DealButton))
                .add(layout.createSequentialGroup()
                    .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.TRAILING)
                        .add(org.jdesktop.layout.GroupLayout.LEADING, layout.createSequentialGroup()
                            .add(Player1Card1, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 40, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                            .addPreferredGap(org.jdesktop.layout.LayoutStyle.UNRELATED)
                            .add(Player1Card2, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 40, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                            .addPreferredGap(org.jdesktop.layout.LayoutStyle.UNRELATED)
                            .add(Player1Card3, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 40, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                            .addPreferredGap(org.jdesktop.layout.LayoutStyle.UNRELATED)
                            .add(Player1Card4, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 40, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                            .add(12, 12, 12)
                            .add(Player1Card5, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 40, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
                        .add(org.jdesktop.layout.GroupLayout.LEADING, layout.createSequentialGroup()
                            .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.TRAILING)
                                .add(DealerLabel)
                                .add(layout.createSequentialGroup()
                                    .add(DealerCard1, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 40, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                                    .addPreferredGap(org.jdesktop.layout.LayoutStyle.UNRELATED)
                                    .add(DealerCard2, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 40, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                                    .add(12, 12, 12)
                                    .add(DealerCard3, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 40, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)))
                            .addPreferredGap(org.jdesktop.layout.LayoutStyle.UNRELATED)
                            .add(DealerCard4, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 40, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                            .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .add(DealerCard5, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 40, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)))
                    .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING, false)
                        .add(HitButton, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .add(StandButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 75, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))))
            .addContainerGap())
    );
    layout.setVerticalGroup(
        layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
        .add(layout.createSequentialGroup()
            .add(13, 13, 13)
            .add(DealerLabel)
            .addPreferredGap(org.jdesktop.layout.LayoutStyle.UNRELATED)
            .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.TRAILING)
                .add(HitButton)
                .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
                    .add(DealerCard1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 60, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                    .add(DealerCard2, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 60, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                    .add(DealerCard3, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 60, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                    .add(DealerCard4, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 60, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                    .add(DealerCard5, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 60, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)))
            .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
            .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
                .add(StandButton)
                .add(DealerPointsLabel))
            .add(4, 4, 4)
            .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
                .add(PointsLabel)
                .add(DealButton))
            .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
            .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
                .add(Player1Card1, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 60, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                .add(Player1Card2, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 60, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                .add(Player1Card3, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 60, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                .add(Player1Card4, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 60, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                .add(Player1Card5, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 60, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
            .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
            .add(Player1Name)
            .addContainerGap(29, Short.MAX_VALUE))
    );

    pack();
}// </editor-fold>                        

private void HitButtonActionPerformed(java.awt.event.ActionEvent evt) {                                          
    PlayerHit();
}                                         

private void StandButtonActionPerformed(java.awt.event.ActionEvent evt) {                                            
    PlayerStand();
}                                           

private void DealButtonActionPerformed(java.awt.event.ActionEvent evt) {                                           
    ResetGame();
}                                          

public void SetName(){
    Player1Name.setText(player.getName());
}

public void DealCards(){
    player.AddCard(deck.DrawCard());
    dealer.AddCard(deck.DrawCard());
    player.AddCard(deck.DrawCard());
    dealer.AddCard(deck.DrawCard());
    ShowCards(player, player.CountCards());
    ShowCards(dealer, 1);

    SetButtons(true);
}

public void DealerHit(){
    dealer.AddCard(deck.DrawCard());
}

public void DealerStand(){
    dealer.PlayerStand();
}

public void PlayerHit(){
    player.AddCard(deck.DrawCard());
    ShowCards(player, player.CountCards());
}
public void PlayerStand(){
    player.PlayerStand();
    SetButtons(false);
    dealer.PlayerTurn();
}

public void ShowCards(Player person, int cards){
    if(!person.getName().equals("Dealer")){
        for(int i = 0; i < cards; i++){
            playerCardSlots[i].setText(person.getCard(i).toString());
        }

        int points = game.CardTotal(person);
        if(game.PlayerBust(points)){
            PointsLabel.setText("BUST!");
            SetButtons(false);
        }
        else{
            PointsLabel.setText(points+"");
        }

        if(game.CardDraw(person)){
            PointsLabel.setText("5 Card Draw!");
            SetButtons(false);
        }
    }
    else{
        for(int i = 0; i < cards; i++){
            dealerCardSlots[i].setText(person.getCard(i).toString());
        }

        int points = game.CardTotal(person, cards);

        if(game.PlayerBust(points)){
            DealerPointsLabel.setText("BUST!");
            SetButtons(false);
        }
        else{
            DealerPointsLabel.setText(points+"");
        }

        if(game.CardDraw(person)){
            DealerPointsLabel.setText("5 Card Draw!");
            SetButtons(false);
        }

        if(points >= 17){

        }
    }
}

public void SetButtons(boolean enabled){
        HitButton.setEnabled(enabled);
        StandButton.setEnabled(enabled);
}

public void ResetGame(){
    for(JLabel label : playerCardSlots){
        label.setText("");
    }
    for(JLabel label : dealerCardSlots){
        label.setText("");
    }

    player.ClearCards();
    dealer.ClearCards();

    deck = new Deck(4);
    DealCards();
    SetName();

    player.PlayerTurn();
    dealer.PlayerStand();
}

// <editor-fold defaultstate="collapsed" desc="Variables">
// Variables declaration - do not modify                     
private javax.swing.JButton DealButton;
private javax.swing.JLabel DealerCard1;
private javax.swing.JLabel DealerCard2;
private javax.swing.JLabel DealerCard3;
private javax.swing.JLabel DealerCard4;
private javax.swing.JLabel DealerCard5;
private javax.swing.JLabel DealerLabel;
private javax.swing.JLabel DealerPointsLabel;
private javax.swing.JButton HitButton;
private javax.swing.JLabel Player1Card1;
private javax.swing.JLabel Player1Card2;
private javax.swing.JLabel Player1Card3;
private javax.swing.JLabel Player1Card4;
private javax.swing.JLabel Player1Card5;
private javax.swing.JLabel Player1Name;
private javax.swing.JLabel PointsLabel;
private javax.swing.JButton StandButton;
// End of variables declaration                   
//</editor-fold>
} 
```

班级球员：

```
 public class Player{
 private String playerName;
 private ArrayList<Card> playerCards = new ArrayList<Card>();
 private boolean turn = false;

Player(String name){
    playerName = name;
}

public Card getCard(int index){
    return playerCards.get(index);
}

public void AddCard(Card card){
    playerCards.add(card);
}

public void ClearCards(){
    playerCards.clear();
}

public int CountCards(){
    return playerCards.size();
}

public String getName(){
    return playerName;
}

public void PlayerStand(){
    turn = false;
}

public void PlayerTurn(){
    turn = true;
}

public boolean getTurn(){
    return turn;
}

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-18T11:25:16.900

首先：从极客的角度来看，二十一点确实很有趣。

正如有人评论的那样：银行对其所有操作都使用固定算法。这些行动（通常？或总是？找出你自己。）仅取决于银行的手。首先实施。

对于玩家，您应该明确实施二十一点玩家所说的“基本策略”。我想谷歌搜索会给你很多点击。

**现在这是我要研究**的内容：
在银行固定策略和玩家“基本策略”实施后，您可以开始进行蒙特卡洛模拟以找到游戏的期望。尝试尽可能快地获取 MC 模拟代码，因为您可能想做很多 MC 模拟。

现在尝试稍微修改套牌。例如，尝试从牌组中删除所有 5。然后进行相同的 MC 模拟，看看这是否会改变预期。你想用没有 5s 的牌组来玩 BJ 吗？

现在，再次修改甲板。尝试移除牌组中所有 10 的一半（即*所有*值为 10 的卡片的一半）。这如何改变玩家的期望？

现在再次修改甲板。尝试删除一半的非 10 值卡。这对预期有何影响？

继续稍微修改套牌，并尝试了解剩余卡片分布中的小偏差如何影响预期。您应该使用这种理解来调整游戏的赌注。因此，该策略不是击中/站立动作，而是基于鞋子中剩余牌组的分配偏差的资金管理。继续根据“基本策略”做出决定！

**现在进一步的步骤：**
也许你可以训练一个神经网络（或其他一些估计算法）来根据牌组中已知的剩余牌来估计游戏的期望？（您必须跟踪牌盒中剩余的牌。）也许您甚至可以将 MC 模拟工具连接到训练算法，为您提供一种强化学习算法。这实际上开始听起来像真正的极客乐趣！或者，也许您可​​以让 MC 模拟器变得如此之快，以便在运行中获得预期的良好答案。

**更进一步：**
当你找到了一个很好的方法来估计游戏的期望时，给定鞋柜中的剩余牌（和“基本“策略”），它足够快，你也许可以实现强化学习算法用于资金管理。

... 或者您可以坚持简单的计划：积极预期 => 高风险。负面预期 => 低风险。

祝你学习顺利，
-Øystein

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T18:40:55.597

您将需要创建一个启发式函数，对 AI 玩家可以做出的所有可能动作进行评分。这个启发式函数会获取玩家可以访问的所有可用数据，分数越高，移动越好。它应该考虑获得所需特定牌的概率，与庄家爆牌等。然后人工智能应该简单地选择最好的移动，即具有最大启发式分数的移动。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T18:47:48.123

有一些用于二十一点的系统（获胜率约为 49%）。例如： http: [//www.docstoc.com/docs/79054261/Basic-Strategy-Chart---Easy-Money-Blackjack-System](http://www.docstoc.com/docs/79054261/Basic-Strategy-Chart---Easy-Money-Blackjack-System)

所以这很简单 if {cards} then {action} 算法

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T10:47:22.593

一般来说，您不应该（主要）依赖命令式语言来创建您的二十一点播放器，除非您只是将搜索作为主要（可能是唯一的）策略。相反，请查看 Clips（生产规则）或 Drools，以便快速创建原型。那里有一个初始学习曲线。基本上，生产规则、逻辑编程、神经网络和遗传算法是在执行或学习阶段结合搜索的通用方法。那么为什么要使用这些而不是搜索呢？毕竟搜索算法非常强大。因为生产规则、逻辑编程、神经网络和遗传算法比仅仅应用搜索算法更强大，使您能够专注于您的问题表示。

另一件要考虑的事情是，在二十一点中，您还需要加入概率（也许还有算牌！）。

# jquery - 摇晃效果 jQuery UI

> ID：12940996
> 
> 赞同：2
> 
> 时间：2012-10-17T18:35:32.050
> 
> 标签：jquery, user-interface

我有一段非常简单的代码直接取自： [http ://api.jqueryui.com/shake-effect/](http://api.jqueryui.com/shake-effect/)

我想改变它，使距离为 60 而不是默认的 20。

这不起作用：

```
$( "#toggle" ).effect( {distance:60} ); 
```

什么是正确的代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T18:38:09.823

您需要定义效果的类型以及`effect`功能。像这样的东西：

```
$( "#toggle" ).effect('shake', {distance:60} ); 
```

检查工作的[jsFiddle](http://jsfiddle.net/cL79S/) - [cL79S](http://jsfiddle.net/cL79S/)。