# StackOverflow 问答 12903000-12903999

# regex - 仅替换 字符串中最后一次出现的

> ID：12903000
> 
> 赞同：0
> 
> 时间：2012-10-15T19:53:32.687
> 
> 标签：regex, preg-replace, replace

这是一个示例内容（西班牙语）

`Definición<br /> Elementos del fuego<br /> Clases de fuego, ¿Cómo evitar que comiencen las clases de fuego?<br /> Métodos de extinción<br /> Tipos de extintores portátiles<br /> Forma de usar los extintores portátiles<br /> Protección pasiva para el control de incendios, tipos de componentes.<br /> Procedimientos preventivos en caso de incendios en minería<br />`

我想`<br />`使用 php 删除最后一次出现`preg_replace()`。

我试过了

```
preg_replace('/<br \/>$/', '<br class="last" />', $content); 
```

但不炒锅。编译器抛出错误。

请问我能做什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-15T19:55:25.897

使用带有负前瞻的正则表达式模式`(?!...)`，例如

```
<br \/>(?!.*<br \/>) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T20:40:01.867

请注意，当使用正则表达式和前瞻时：

```
$text = "foo bar <br /> \nbaz <br /> <br /> mu";

echo preg_replace('/<br \/>(?!.*<br \/>)/', '<br class="last" />', $text) . "\n"; 
```

将导致两个`<br />`被替换，因为`.`（点）元字符不匹配换行符。所以上面会打印：

```
foo bar <br class="last" /> 
baz <br /> <br class="last" /> mu 
```

您可能还需要考虑“<BR>”或“<br />”（多个空格）。

```
echo preg_replace('#<br\s*/?>(?!.*<br\s*/?>)#is', '<br class="last" />', $text) . "\n"; 
```

*（`i`使模式不区分大小写，并且`s`让`.`匹配换行符）*

这将打印：

```
foo bar <br /> 
baz <br /> <br class="last" /> mu 
```

如果您确定*针*总是看起来像`<br />`，那么几个 str 操作也可以解决问题：

```
$text = "foo bar <br /> \nbaz <br /> <br /> mu";
$needle = "<br />";
$index = strrpos($text, $needle);

if($index) {
  echo substr_replace($text, '<br class="last" />', $index, strlen($needle)) . "\n";
} 
```

# overlay - Mapkit 上的 XCode 天气雷达地图叠加

> ID：12903001
> 
> 赞同：2
> 
> 时间：2012-10-15T19:53:35.040
> 
> 标签：overlay, mapkit, xcode4.3, mkoverlay

我似乎无法通过从 url 加载自定义地图覆盖来解决这个问题。正如您所看到的，它从将其添加到地图视图的 URL 加载天气叠加层，但它似乎不起作用，我不明白为什么它不起作用。任何帮助表示赞赏。

雷达视图.h

```
#import <UIKit/UIKit.h>
#import <MapKit/MapKit.h>

@interface radarViewController : UIViewController <MKMapViewDelegate> {
MKMapView *mapview;
}
@property (nonatomic, readonly) CLLocationCoordinate2D coordinate;
@property (nonatomic, readwrite) MKCoordinateRegion region;
@property (nonatomic, readonly) MKMapRect visibleRect;
@property (nonatomic, retain) IBOutlet MKMapView *mapview;

-(IBAction)setMap:(id)sender;
-(IBAction)goBack;

@end 
```

雷达视图.m

```
#import "radarViewController.h"
#import "MapOverlay.h"
#import "MapOverlayView.h"

@implementation radarViewController
@synthesize mapview,coordinate,visibleRect,region;

- (void)viewDidLoad
{
[super viewDidLoad];
[mapview setDelegate:self];
[mapview setZoomEnabled:YES];
[mapview setScrollEnabled:YES];
[mapview setMapType:MKMapTypeSatellite];

NSURL *imageURL = [NSURL URLWithString: @"http://radar.weather.gov/ridge/Conus/RadarImg/latest_radaronly.gif"];
NSData * imageData = [NSData dataWithContentsOfURL:imageURL];
//UIImage * image = [UIImage imageWithData:imageData];

MapOverlay *overlay = [[MapOverlay alloc] initWithImageData:imageData withLowerLeftCoordinate:CLLocationCoordinate2DMake(21.65253888888889, -129.314525) withUpperRightCoordinate:CLLocationCoordinate2DMake(50.406625, -65.60158888888888)];
[mapview addOverlay:overlay];
[mapview setVisibleMapRect:[overlay boundingMapRect]];
[overlay release];

visibleRect = [mapview mapRectThatFits:overlay.boundingMapRect];
mapview.visibleMapRect = visibleRect;
region = MKCoordinateRegionForMapRect(visibleRect);
region.center.latitude = 26.503292;
region.center.longitude = -82.032353;
region.span.longitudeDelta = 0.4f;
region.span.latitudeDelta = 0.4f;
[mapview regionThatFits:region];
[mapview setRegion:region animated:YES];
[mapview setClipsToBounds:true];

}

- (MKOverlayView *)mapView:(MKMapView *)mapView viewForOverlay:(id <MKOverlay>)overlay {
MapOverlay *mapOverlay = overlay;
MapOverlayView *mapOverlayView = [[[MapOverlayView alloc] initWithOverlay:mapOverlay] autorelease];
return mapOverlayView;
}
@end 
```

MapOverlay.h 和 .m

```
#import <MapKit/MapKit.h>

@interface MapOverlay : NSObject <MKOverlay> {
MKMapRect boundingMapRect;
}
@property (nonatomic, retain) NSData *radarData;

- (id) initWithImageData: (NSData*) imageData withLowerLeftCoordinate:
(CLLocationCoordinate2D) lowerLeftCoordinate withUpperRightCoordinate:
(CLLocationCoordinate2D) upperRightCoordinate;

@end

#import "MapOverlay.h"

@implementation MapOverlay
@synthesize radarData,coordinate,boundingMapRect;

- (id) initWithImageData: (NSData*) imageData withLowerLeftCoordinate: (CLLocationCoordinate2D) lowerLeftCoordinate withUpperRightCoordinate: (CLLocationCoordinate2D) upperRightCoordinate{

self.radarData = imageData;

MKMapPoint lowerLeft = MKMapPointForCoordinate(lowerLeftCoordinate);
MKMapPoint upperRight = MKMapPointForCoordinate(upperRightCoordinate);

boundingMapRect = MKMapRectMake(lowerLeft.x, upperRight.y, upperRight.x - lowerLeft.x, upperRight.y - lowerLeft.y);

return self;
}

- (CLLocationCoordinate2D)coordinate
{
return MKCoordinateForMapPoint(MKMapPointMake(MKMapRectGetMidX(boundingMapRect),
                                              MKMapRectGetMidY(boundingMapRect)));
}

- (MKMapRect)boundingMapRect
{
return boundingMapRect;
}

@end 
```

MapOverlayView.h 和 .m

```
#import <MapKit/MapKit.h>

@interface MapOverlayView : MKOverlayView {
CGFloat tileAlpha;
}

@property (nonatomic, assign) CGFloat tileAlpha;

@end

#import "MapOverlayView.h"
#import "MapOverlay.h"

@implementation MapOverlayView
@synthesize tileAlpha;

- (id)initWithOverlay:(id <MKOverlay>)overlay
{
if (self = [super initWithOverlay:overlay]) {
    self.tileAlpha = 0.8;
}
return self;
}

- (void)drawMapRect:(MKMapRect)mapRect
      zoomScale:(MKZoomScale)zoomScale
      inContext:(CGContextRef)context
{
MapOverlay *mapOverlay = (MapOverlay *)self.overlay;

CGContextSetAlpha(context, tileAlpha);

UIImage *image = [[UIImage alloc] initWithData:mapOverlay.radarData];

NSString *strData = [[NSString alloc]initWithData:mapOverlay.radarData encoding:NSUTF8StringEncoding];
NSLog(@"%@",strData);

MKMapRect theMapRect = [self.overlay boundingMapRect];
CGRect theRect = [self rectForMapRect:theMapRect];

UIGraphicsPushContext(context);
[image drawInRect:theRect blendMode:kCGBlendModeNormal alpha:1.0];
UIGraphicsPopContext();

[image release]; 
}

- (BOOL)canDrawMapRect:(MKMapRect)mapRect
         zoomScale:(MKZoomScale)zoomScale
{
return YES;
}

@end 
```

# mysql - 我应该如何在我的关系数据库中组织这个（简单的轮询系统）？

> ID：12903012
> 
> 赞同：2
> 
> 时间：2012-10-15T19:54:11.890
> 
> 标签：mysql

我的目标是一个简单的投票系统，用户可以在其中创建投票问题，为投票提供一组选项（答案）并对每个投票进行投票。我将提供一组我需要收集的简单字段。然后，我将提供我的解决方案。你能告诉我我的解决方案是否可以接受吗？

必填字段：questionText、date、(poster)userId、options(answers)、response、(responder)userID、responseDate

我目前的解决方案：

```
Table: Polls
Fields: questionID, questionText, date, userID

Table: Options
Fields: optionID, optionText, questionID

Table: Respnoses
Fields: responseID, optionID, userID, responseDate 
```

因此，要查找用户是否响应了特定民意调查，我必须这样查询：

```
SELECT responseID FROM Responses
WHERE userID = [user's id] AND optionID IN(
Select optionID FROM Options
WHERE questionID = [specific questionID]) 
```

这个查询也有意义吗？
提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T20:48:57.843

这个模型对我来说看起来不错，查询也是如此。我是 JOIN 的粉丝，所以我会像这样构建您的选择查询（不是建议，只是一个明确的替代方案）：

```
SELECT p.questionText, o.optionText AS selected_answer, r.responseDate, r.userID
FROM Responses r
    JOIN Options o ON r.optionID = o.optionID
    JOIN Polls p ON o.questionID = p.questionID
WHERE r.userID = [user ID] 
```

我唯一的想法是，根据您的需求以及您希望该系统的可审计性，您可能需要额外的字段，例如选项和投票表上的时间戳。（“date_edited”与“date_created”？在低风险的情况下，这可能不需要。）

# wordpress - 获取所有类别或不正确的类别

> ID：12903018
> 
> 赞同：0
> 
> 时间：2012-10-15T19:54:28.500
> 
> 标签：wordpress, wordpress-theming

因此，如果我有，在新安装上：未分类和苹果的类别，然后写一个以苹果为类别的新博客并查看该帖子 - 页面底部的类别是：未分类和苹果。

我的代码如下：

```
$aisis_category_list = array(
       'orderby' => 'id',
       'order' => 'ASC',
       'style' => 'none',
       'title_li'=> '',
); 
```

然后我做：

```
wp_list_categories($aisis_category_list); 
```

为什么我没有得到我选择的特定类别作为唯一类别？

**注意：**在极少数情况下，当我 100% 确定我只选择了苹果时，我只会将“未分类”作为该帖子的类别。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T20:29:33.337

如果您希望获取当前帖子的类别，那么您应该使用：

```
$categories = get_the_category($post->ID); 
```

[wordpress 法典](http://codex.wordpress.org/Function_Reference/get_the_category)

# c# - WPF 绑定到第二个 ViewModel 中的属性

> ID：12903033
> 
> 赞同：0
> 
> 时间：2012-10-15T19:55:25.417
> 
> 标签：c#, wpf, viewmodel

如何从第二个视图模型中获取绑定到 txtMessage 的文本？当我只有一个视图模型时，文本工作正常。当我将实际下载代码移至第二个视图模型时，它不再起作用。我错过了什么吗？任何帮助表示赞赏。

xml:

```
<DockPanel DockPanel.Dock="Top">
    <TextBlock x:Name="txtMessage" DockPanel.Dock="Top" Margin="5" Text="{Binding viewModel1.Message}" />
    <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" Margin="5,5">
    <ProgressBar Width="300" Visibility="{Binding IsDownloading, Converter={converter:VisibilityConverter}}" IsIndeterminate="True" />
<Button Content="Cancel" />
</StackPanel>
</DockPanel>
<Button Content="Download" Width="120" Margin="0,0,5,0" Name="btnSubmit" Click="btnSubmit_Click" /> 
```

代码隐藏：

```
public partial class DownloadWindow: Window
    {
        DownloadWindowViewModel viewModel = new DownloadWindowViewModel();

        public DownloadWindow()
        {
            InitializeComponent();
            this.DataContext = viewModel;
        }

        private void btnSubmit_Click(object sender, RoutedEventArgs e)
        {
            viewModel.IsDownloading = true;
            viewModel.Download();

        }

    } 
```

视图模型：

```
public class DownloadWindowViewModel: INotifyPropertyChanged
    {

        Thread downloadThread;
        public DownloadViewModel viewModel1;

        public DownloadWindowViewModel()
        {
            viewModel1 = new DownloadViewModel();
        }

        private bool _isDownloading; = false;

        public bool IsDownloading
        {
            get 
            { 
                return _isDownloading; 
            }
            set 
            { 
                _isDownloading; = value;
                OnPropertyChanged("IsDownloading");
            }
        }

        public void Download()
        {
            viewModel1.Download();

        }

        public event PropertyChangedEventHandler PropertyChanged;

        public void OnPropertyChanged(string propertyName)
        {
            PropertyChangedEventHandler handler = PropertyChanged;
            if (handler != null)
            {
                handler(this, new PropertyChangedEventArgs(propertyName));
            }
        }

    } 
```

视图模型1：

```
public class DownloadViewModel: INotifyPropertyChanged
    {
        Thread _thread;

        public void Download()
        {
            ThreadStart threadStart = delegate()
            {
                StartDownload();
            };
            _thread = new Thread(threadStart);
            _thread.IsBackground = true;
            _thread.Start();

        }

        private void StartDownload()
        {
            for (int i = 10; i < 1500; i++)
            {
                Thread.Sleep(5000);
                Message = "Downloading " + i.ToString();
            }
        }

        private string _message = "";

        public string Message
        {
            get
            {
                return _message;
            }
            set
            {
                if (_message != value)
                {
                    _message = value;
                    OnPropertyChanged("Message");
                }

            }
        }

        public event PropertyChangedEventHandler PropertyChanged;

        protected void OnPropertyChanged(string propertyName)
        {
            PropertyChangedEventHandler handler = PropertyChanged;
            if (handler != null)
            {
                handler(this, new PropertyChangedEventArgs(propertyName));
            }
        }

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:22:53.873

你`viewModel1`必须是一个属性，并且它现在是一个字段。将其更改为：

```
public DownloadViewModel viewModel1 { get; set; } 
```

可以在这里找到为什么存在这种限制的解释（主要是由于通知/验证机制根本不适用于字段）：

*   [为什么 WPF 支持绑定到对象的属性，但不支持绑定字段？](https://stackoverflow.com/q/842575/343266)

# iphone - iPhone 应用程序中的轮流导航

> ID：12903037
> 
> 赞同：0
> 
> 时间：2012-10-15T19:55:50.530
> 
> 标签：iphone, ios5, mapkit

我正在为餐馆开发 iPhone 应用程序。我使用 mapkit 来显示餐馆的位置。用户还可以选择查看从当前位置到特定位置（餐厅）的路线。我需要在其中添加转弯导航。我正在使用谷歌地图，在某处我读到 iPhone 不显示转弯导航，因为这在 Apple-Google 地图合同中受到限制。这是真的吗？如果是，那么是否有任何其他方式或任何 3rd 方库，我可以通过它来实现转弯导航？

提前致谢

问候，

个人电脑

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T23:12:55.880

导航的最佳选择是让用户逐个选择他们想要的路线： - 使用 maps.apple.com 的 Apple 地图 - 使用 maps.google.com 的 Google 地图 其他应用程序，例如 Navigon、Tom tom。

这是一个复杂的功能，您最好不要对服务的任何缺点负责。

谷歌地图许可协议禁止您轮流进行。

检查[在 iPhone SDK 中的 MapKit 中绘制路线](https://stackoverflow.com/questions/2834523/drawing-a-route-in-mapkit-in-iphone-sdk)

# backbone.js - 哪个前端框架用于消耗使用 json 模式描述的资源？

> ID：12903043
> 
> 赞同：2
> 
> 时间：2012-10-15T19:56:11.090
> 
> 标签：backbone.js, knockout.js, ember.js, angularjs, jsonschema

鉴于我有一个 API，它通过 json-schema 描述它的不同资源，如下所示： [https ://github.com/salesking/sk_api_schema/blob/master/json/v1.0/address.json](https://github.com/salesking/sk_api_schema/blob/master/json/v1.0/address.json)

是否有可以将 json-schema 用作（或将其转换为）模型的前端 javascript 框架？应该可以根据 json 模式验证模型，并且应该能够处理不同 json 模式模型之间的引用。

我一直在看 ember.js，但似乎即使我编写了一些代码来将 json 模式转换为 ember 模型，要让 ember.js 模型的验证工作仍然相去甚远。正确的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T01:39:01.660

在不太了解 JSON Schema 的情况下，我相信 Knockout 可以很容易地支持这一点。

由于 KO 模型可以是任何 Javascript 对象，您只需要读取模式，并从每个“properties”属性的属性生成一个对象（哈哈）

您还可以使用 Knockout Validation 插件动态添加验证： [https ://github.com/ericmbarnard/Knockout-Validation](https://github.com/ericmbarnard/Knockout-Validation)

组合示例：

```
var schema = // read in json
var model = {}

for (prop in schema.properties) {
    model[prop] = ko.observable().extend({ 
                      maxLength: /* get your value from schema, etc */,
                      minLength: /* get your value from schema, etc */
                  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-10T10:37:32.043

JXT ( [http://www.jxtdev.com](http://www.jxtdev.com) ) 模型使用 JSON 初始化，而且 JSON 用于配置 JavaScript 包。JXT 实现了 MVC 模式，当模型中包含的数据发生变化时，它将通知其控制器，控制器将自动重新加载视图。这种事件驱动的方法在框架中随处使用，从 JXT 集合（它们是原生 JavaScript 集合的包装器）开始。我刚刚发布了第一个测试版（是的，我是它背后的开发者），所以你可能会发现它仍然不成熟，但值得一看 imo ;)

# linux - 在 Linux x32 ABI 中，哪些小于 4GB 的工作负载的性能会比 x64 差？

> ID：12903049
> 
> 赞同：5
> 
> 时间：2012-10-15T19:56:50.233
> 
> 标签：linux, performance, x86, x86-64, linux-x32-abi

有一个相对较[新的 Linux ABI 称为 x32](http://en.wikipedia.org/wiki/X32_ABI)，其中 x86-64 处理器以 32 位模式运行，因此指针仍然只有 32 位，但仍然使用 64 位架构特定的寄存器。因此，与普通 32 位一样，您的最大内存使用量仍被限制为 4GB，但您的指针使用的缓存空间比 64 位少，您可以有效地执行 64 位算术，并且您可以访问更多寄存器(16) 比普通 32 位 (8) 中的要好。

假设您的工作负载非常适合 4GB，那么 x32 的性能是否会比 x86-64 差？

在我看来，如果您不需要额外的内存空间，则不会丢失任何东西——您应该始终获得相同的性能（当您已经适合缓存时）或更好（当节省的指针空间让您更适合缓存时） . 但如果有分页/TLB/等，我不会感到惊讶。我不知道的细节。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-15T20:23:54.763

当然，如果您有一个多线程程序，x32 上的数据结构较小这一事实可能会导致线程之间的缓存线争用——在 x32 模式下，不同的对象可能会分配到同一缓存线上，而在 x86_64 模式下，可能会在不同的缓存线上分配。如果两个线程独立修改这些对象，缓存乒乓可能会严重减慢 x32 代码。当然，无论指针大小如何，这种缓存效应都可能发生，但是如果代码已经在假设 64 位指针的情况下进行了调整，那么使用 32 位指针可能会导致问题发生。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-15T21:08:18.997

在 X32 中，处理器实际上以“长模式”执行，与 x86_64 的模式相同。也就是说，处理器在进行寻址时看到的地址仍然是 64 位，但是 X32 ABI 确保所有地址都足够小以适合 32 位。因此，在某些情况下，当指针必须从 32 位扩展到 64 位时，会产生一些轻微的开销。

此外，在 RAM 中需要 x86/x86-64/x32 库，我想这是一个在实践中最终会得到的结果（除非你在谈论一些嵌入式或其他严格控制的系统而不是通用计算机），可能会吃起来了 X32 的一些好处。

# c# - 是否可以从非 Windows Store App 使用 RoGetMetaDataFile

> ID：12903052
> 
> 赞同：0
> 
> 时间：2012-10-15T19:56:56.960
> 
> 标签：c#, winapi, reflection, windows-runtime, pinvoke

在阅读了[拉里奥斯特曼对](https://stackoverflow.com/questions/9136683/cannot-get-types-from-winmd-file/9142803#9142803)我目前正在尝试解决的同一问题的回复后，我认为我已经找到了问题的答案。

作为记录，问题是：我如何从 .Net（非 WinRT）列出 WinRT 程序集中的类型（我的显然是 .dll 文件，而不是 .Winmd）

因此，我使用了以下代码片段：

```
//note, this wrapper function returns the metadata file name and token
// it immediately releases the importer pointer

static Tuple<string, UInt32> ResolveTypeName(string typename)
{
    string path;
    object importer = null;
    UInt32 token;

    try
    {
        var hr = RoGetMetaDataFile(typename, IntPtr.Zero, out path, out importer, out token);

        //TODO: check HR for error

        return Tuple.Create(path, token);
    }
    finally
    {
        Marshal.ReleaseComObject(importer);
    }
}

[DllImport("WinTypes.dll")]
static extern UInt32 RoGetMetaDataFile(
    [MarshalAs(UnmanagedType.HString)] string name,
    IntPtr metaDataDispenser,
    [MarshalAs(UnmanagedType.HString)] out string metaDataFilePath,
    [MarshalAs(UnmanagedType.Interface)] out object metaDataImport,
    out UInt32 typeDefToken); 
```

（在[https://gist.github.com/2920743](https://gist.github.com/2920743)上找到）

不幸的是，我得到一个非零的 HResult。

我参考了文档并发现了这一点：

> HR_RESULT_FROM_WIN32(ERROR_NO_PACKAGE) 该函数是从不在 Windows 应用商店应用程序中的进程调用的。

这是否意味着根本无法列出 .Net（非 WinRT）中的类型？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:06:55.720

`RoGetMetaDataFile`用于从应用程序包中加载元数据文件。它定位定义了命名类型的元数据文件，加载该元数据文件，并返回一个`IMetaDataImport`表示该元数据文件的接口指针。

从普通的 .NET 代码中，您可以调用[`RuntimeEnvironment.GetRuntimeInterfaceAsIntPtr`](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.runtimeenvironment.getruntimeinterfaceasintptr.aspx)（或`GetRuntimeInterfaceAsObject`）来获取当前运行时的`IMetaDataDispenser`接口指针，该指针可用于加载任意模块以进行检查。

从本机代码中，您可以调用[`ICLRMetaHost::GetRuntime`](http://msdn.microsoft.com/en-us/library/dd233132.aspx)以加载运行时，然后从该对象调用[`ICLRRuntimeInfo::GetInterface`](http://msdn.microsoft.com/en-us/library/dd233135.aspx)以获取其`IMetaDataDispenser`接口指针。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T02:09:59.620

`RoGetMetaDataFile`可以从应用程序包外部使用，但它只会解析系统 Windows 运行时类型。

为了解析应用程序特定类型，您需要使用“包标识”运行 - 换句话说，在正在运行的应用程序的上下文中。

# c# - UNC 路径指向本地目录比本地访问慢得多

> ID：12903054
> 
> 赞同：9
> 
> 时间：2012-10-15T19:56:59.313
> 
> 标签：c#, windows, file-io, unc

我正在使用的一些代码偶尔需要引用长 UNC 路径（例如 \\?\UNC\MachineName\Path），但我们发现无论目录位于何处，即使在同一台机器上，它也很多通过 UNC 路径访问时比本地路径慢。

例如，我们编写了一些基准测试代码，将一串乱码写入文件，然后多次读回。我正在用 6 种不同的方式来测试它来访问我的开发机器上的同一个共享目录，代码在同一台机器上运行：

*   C:\温度
*   \\机器名\温度
*   \\?\C:\Temp
*   \\?\UNC\MachineName\Temp
*   \\127.0.0.1\Temp
*   \\?\UNC\127.0.0.1\Temp

结果如下：

```
Testing: C:\Temp
Wrote 1000 files to C:\Temp in 861.0647 ms
Read 1000 files from C:\Temp in 60.0744 ms
Testing: \\MachineName\Temp
Wrote 1000 files to \\MachineName\Temp in 2270.2051 ms
Read 1000 files from \\MachineName\Temp in 1655.0815 ms
Testing: \\?\C:\Temp
Wrote 1000 files to \\?\C:\Temp in 916.0596 ms
Read 1000 files from \\?\C:\Temp in 60.0517 ms
Testing: \\?\UNC\MachineName\Temp
Wrote 1000 files to \\?\UNC\MachineName\Temp in 2499.3235 ms
Read 1000 files from \\?\UNC\MachineName\Temp in 1684.2291 ms
Testing: \\127.0.0.1\Temp
Wrote 1000 files to \\127.0.0.1\Temp in 2516.2847 ms
Read 1000 files from \\127.0.0.1\Temp in 1721.1925 ms
Testing: \\?\UNC\127.0.0.1\Temp
Wrote 1000 files to \\?\UNC\127.0.0.1\Temp in 2499.3211 ms
Read 1000 files from \\?\UNC\127.0.0.1\Temp in 1678.18 ms 
```

我尝试了 IP 地址以排除 DNS 问题。它可以检查每个文件访问的凭据或权限吗？如果是这样，有没有办法缓存它？它是否只是假设因为它是一个 UNC 路径，所以它应该通过 TCP/IP 而不是直接访问磁盘来做所有事情？我们用于读/写的代码有问题吗？我已经删除了用于基准测试的相关部分，如下所示：

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Runtime.InteropServices;
using System.Text;
using Microsoft.Win32.SafeHandles;
using Util.FileSystem;

namespace UNCWriteTest {
    internal class Program {
        [DllImport("kernel32.dll", CharSet = CharSet.Auto, SetLastError = true)]
        public static extern bool DeleteFile(string path); // File.Delete doesn't handle \\?\UNC\ paths

        private const int N = 1000;

        private const string TextToSerialize =
            "asd;lgviajsmfopajwf0923p84jtmpq93worjgfq0394jktp9orgjawefuogahejngfmliqwegfnailsjdhfmasodfhnasjldgifvsdkuhjsmdofasldhjfasolfgiasngouahfmp9284jfqp92384fhjwp90c8jkp04jk34pofj4eo9aWIUEgjaoswdfg8jmp409c8jmwoeifulhnjq34lotgfhnq34g";

        private static readonly byte[] _Buffer = Encoding.UTF8.GetBytes(TextToSerialize);

        public static string WriteFile(string basedir) {
            string fileName = Path.Combine(basedir, string.Format("{0}.tmp", Guid.NewGuid()));

            try {
                IntPtr writeHandle = NativeFileHandler.CreateFile(
                    fileName,
                    NativeFileHandler.EFileAccess.GenericWrite,
                    NativeFileHandler.EFileShare.None,
                    IntPtr.Zero,
                    NativeFileHandler.ECreationDisposition.New,
                    NativeFileHandler.EFileAttributes.Normal,
                    IntPtr.Zero);

                // if file was locked
                int fileError = Marshal.GetLastWin32Error();
                if ((fileError == 32 /* ERROR_SHARING_VIOLATION */) || (fileError == 80 /* ERROR_FILE_EXISTS */)) {
                    throw new Exception("oopsy");
                }

                using (var h = new SafeFileHandle(writeHandle, true)) {
                    using (var fs = new FileStream(h, FileAccess.Write, NativeFileHandler.DiskPageSize)) {
                        fs.Write(_Buffer, 0, _Buffer.Length);
                    }
                }
            }
            catch (IOException) {
                throw;
            }
            catch (Exception ex) {
                throw new InvalidOperationException(" code " + Marshal.GetLastWin32Error(), ex);
            }

            return fileName;
        }

        public static void ReadFile(string fileName) {
            var fileHandle =
                new SafeFileHandle(
                    NativeFileHandler.CreateFile(fileName, NativeFileHandler.EFileAccess.GenericRead, NativeFileHandler.EFileShare.Read, IntPtr.Zero,
                                                 NativeFileHandler.ECreationDisposition.OpenExisting, NativeFileHandler.EFileAttributes.Normal, IntPtr.Zero), true);

            using (fileHandle) {
                //check the handle here to get a bit cleaner exception semantics
                if (fileHandle.IsInvalid) {
                    //ms-help://MS.MSSDK.1033/MS.WinSDK.1033/debug/base/system_error_codes__0-499_.htm
                    int errorCode = Marshal.GetLastWin32Error();
                    //now that we've taken more than our allotted share of time, throw the exception
                    throw new IOException(string.Format("file read failed on {0} to {1} with error code {1}", fileName, errorCode));
                }

                //we have a valid handle and can actually read a stream, exceptions from serialization bubble out
                using (var fs = new FileStream(fileHandle, FileAccess.Read, 1*NativeFileHandler.DiskPageSize)) {
                    //if serialization fails, we'll just let the normal serialization exception flow out
                    var foo = new byte[256];
                    fs.Read(foo, 0, 256);
                }
            }
        }

        public static string[] TestWrites(string baseDir) {
            try {
                var fileNames = new List<string>();
                DateTime start = DateTime.UtcNow;
                for (int i = 0; i < N; i++) {
                    fileNames.Add(WriteFile(baseDir));
                }
                DateTime end = DateTime.UtcNow;

                Console.Out.WriteLine("Wrote {0} files to {1} in {2} ms", N, baseDir, end.Subtract(start).TotalMilliseconds);
                return fileNames.ToArray();
            }
            catch (Exception e) {
                Console.Out.WriteLine("Failed to write for " + baseDir + " Exception: " + e.Message);
                return new string[] {};
            }
        }

        public static void TestReads(string baseDir, string[] fileNames) {
            try {
                DateTime start = DateTime.UtcNow;

                for (int i = 0; i < N; i++) {
                    ReadFile(fileNames[i%fileNames.Length]);
                }
                DateTime end = DateTime.UtcNow;

                Console.Out.WriteLine("Read {0} files from {1} in {2} ms", N, baseDir, end.Subtract(start).TotalMilliseconds);
            }
            catch (Exception e) {
                Console.Out.WriteLine("Failed to read for " + baseDir + " Exception: " + e.Message);
            }
        }

        private static void Main(string[] args) {
            foreach (string baseDir in args) {
                Console.Out.WriteLine("Testing: {0}", baseDir);

                string[] fileNames = TestWrites(baseDir);

                TestReads(baseDir, fileNames);

                foreach (string fileName in fileNames) {
                    DeleteFile(fileName);
                }
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-17T21:42:22.957

这并不让我感到惊讶。您正在写入/读取相当少量的数据，因此文件系统缓存可能会最大限度地减少物理磁盘 I/O 的影响；基本上，瓶颈将是 CPU。我不确定流量是否会通过 TCP/IP 堆栈，但至少涉及 SMB 协议。一方面，这意味着请求在 SMB 客户端进程和 SMB 服务器进程之间来回传递，因此您可以在三个不同的进程（包括您自己的进程）之间进行上下文切换。使用本地文件系统路径，您将切换到内核模式并返回，但不涉及其他进程。上下文切换比内核模式的转换慢得多*。*

There are likely to be two distinct additional overheads, one per file and one per kilobyte of data. In this particular test the per file SMB overhead is likely to be dominant. Because the amount of data involved also affects the impact of physical disk I/O, you may find that this is only really a problem when dealing with lots of small files.

# node.js - Upstart 错误以状态 1 终止

> ID：12903055
> 
> 赞同：4
> 
> 时间：2012-10-15T19:57:01.227
> 
> 标签：node.js, ubuntu-10.04, upstart

我有一个 ubuntu 10.04 服务器并尝试创建一个新贵脚本：

```
description "node-workerListener"
author      "me"

start on startup
stop on shutdown

script
        # We found $HOME is needed. Without it, we ran into problems
        export HOME="/var/www"

        exec sudo -u www-data /usr/local/bin/node /var/www/vhost/node/test/workerListener.js 2>&1 >> /var/log/node/helloworld.log
end script 
```

如果我在命令行上手动启动它，这应该启动一个节点脚本，它可以工作。但是当我尝试“启动 node-workerListener”时，我收到消息“node-workerListener 启动/运行，进程 1323”，但它没有。

在 /var/log/syslog 中：“...init: node-workerListener 主进程 (1317) 以状态 1 终止”

我能做些什么？

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-11-13T15:30:56.713

您也可以使用**forever** [https://github.com/nodejitsu/forever](https://github.com/nodejitsu/forever)来运行节点进程。

这是一篇详细的文章：http: [//blog.nodejitsu.com/keep-a-nodejs-server-up-with-forever](http://blog.nodejitsu.com/keep-a-nodejs-server-up-with-forever)

# asp.net - 仅允许特定 IP 访问网站

> ID：12903057
> 
> 赞同：0
> 
> 时间：2012-10-15T19:57:08.253
> 
> 标签：asp.net

我有一个在 IIS 6.0 中运行的网站，该网站是一个带有框架 4.0 的 asp.net 我们有一个未托管在客户端上的应用程序，而是托管在我们这边。客户端要求仅允许特定 IP 的访问。

所以我在 web.config 中添加了 IP 列表，如下所示：

```
<security>
  <ipSecurity allowUnlisted="false">    
    <clear/> <!-- removes all upstream restrictions -->
    <add ipAddress="XXX.XXX.XXX.114" subnetMask="255.255.255.0" allowed="true"/>
<add ipAddress="XXX.XXX.XXX.85" subnetMask="255.255.255.0" allowed="true"/>
   </ipSecurity>
 </security> 
```

在此示例中，只有两个 IP 可以访问该端。我需要做一个额外的步骤吗？因为不工作。这是最好的方法吗？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T23:35:23.117

我认为您的答案在此链接中[IP Security](http://www.iis.net/configreference/system.webserver/security/ipsecurity)

```
 Compatibility

    Version   Notes

IIS 7.5     The <ipSecurity> element was not modified in IIS 7.5.

IIS 7.0     The <ipSecurity> element was introduced in IIS 7.0.

IIS 6.0     The <ipSecurity> element replaces the IIS 6.0 IPSecurity metabase property. 
```

# javascript - 将类添加到动态创建的列表元素

> ID：12903068
> 
> 赞同：0
> 
> 时间：2012-10-15T19:57:52.810
> 
> 标签：javascript, jquery, html-lists

我有以下代码，它从 xml 中获取输入并创建一个无序列表。

```
$(function() {
            var map = function() {
                    if ($(this).is("parent")) {
                        var children = $(this).children().map(map).get().join('');
                        $(this).children().remove();
                        var result = "<li class='BGOfDiv'>" + $(this).text();
                        return result + "<ul>" + children + "</ul></li>";
                    }
                    if ($(this).is("Children")) {
                        return "<li class='BGOfDiv'>" + $(this).text() + "</li>";
                    }
                };

                $.get("test.xml", function(data) {
                    var result = $(data).map(map);
                    $("#org").html(result[0]);
                    $("#org").jOrgChart({
                            chartElement : '#chart',
                            dragAndDrop  : false
                        });
                        dragNodes();
                }, "html");

            }); 
```

目前，我的 xml 看起来像这样

```
<?xml version="1.0" encoding="utf-8"?>
<Parent>Director
    <Children>Exe Director1</Children>
    <Children>Exe Director2</Children>
    <Parent>Exe Director3
        <Children>Sub Director 1</Children>
        <Children>Sub Director 2</Children>
        <Parent>Sub Director 3
            <Children>Cameraman 1</Children>
            <Children>Cameraman 2</Children>
        </Parent>
    </Parent>    
</Parent> 
```

但是，xml 将保存某些图像的路径，我需要将这些图像应用为每个节点的背景图像。那是我的 xml 看起来像

```
<?xml version="1.0" encoding="utf-8"?>
<Parent>../images/1.jpg
    <Children>../images/2.jpg</Children>
    <Children>../images/3.jpg</Children>
    <Parent>../images/4.jpg
        <Children>../images/5.jpg</Children>
        <Children>../images/6.jpg</Children>
        <Parent>../images/7.jpg
            <Children>../images/8.jpg</Children>
            <Children>../images/9.jpg</Children>
        </Parent>
    </Parent>    
</Parent> 
```

我知道在创建新元素时需要使用 的`.css`属性`jquery`并设置 ，但我无法弄清楚如何做到这一点。`background-image``<li>`

感谢您的关注。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T20:02:27.547

如果`$(this).text()`返回文件的 url，你可以简单地在`<li>`元素中添加样式

```
"<li class='class' style='background-image: url(" + $(this).text() + ");'>...</li>" 
```

当然，您可能需要设置其他 CSS，例如 background-position、background-repeat 等。或者使用 css 的简短版本，例如

```
"<li class='class' style='background: url(" + $(this).text() + ") no-repeat 0 0;'>...</li>" 
```

# ruby-on-rails - 简单的 rails rake 任务拒绝运行并出现错误“不知道如何构建任务”，为什么？

> ID：12903069
> 
> 赞同：48
> 
> 时间：2012-10-15T19:57:55.157
> 
> 标签：ruby-on-rails, rake, rake-task

我有这个拒绝运行的简单 rake 任务。我只是不明白为什么它看起来正确。谁能指出我犯的可能非常简单的错误？谢谢！

**/lib/tasks/reindex.rb：**

```
namespace :db do

  desc "Tire reindex profiles"

  task :reindex => :environment do
    system "cd #{Rails.root} && rake environment tire:import CLASS='Profile' FORCE=true"
  end

end 
```

**错误：**

```
rake db:reindex
rake aborted!
Don't know how to build task 'db:reindex' 
```

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2012-10-15T20:11:19.123

将您的文件重命名为`reindex.rake`，它应该可以工作。

相关：[如何构建任务'db：populate'](https://stackoverflow.com/questions/5334520/dont-know-how-to-build-task-dbpopulate)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2015-03-26T14:47:21.593

如果您忘记将命名空间放在任务名称之前，也会出现此错误。（即：reindex 而不是 db:reindex）

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2019-02-18T15:26:14.090

rake 任务的文件扩展名必须是“.rake”。

如果您将文件命名为“.rb”，则 rake 将找不到它，并且您将在几分钟内质疑自己的理智，然后才到这里结束。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-11-02T13:02:08.407

不要忘记检查您调用的是任务名称而不是文件名。最好的事情是它们的名称相同。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-06-29T04:02:33.743

这个错误发生在我身上是因为命名空间名称有下划线

```
As is: deploy_app  (not work)
To be: deployapp   (working) 
```

# jquery - 单击输入框时登录表单加载主页

> ID：12903071
> 
> 赞同：0
> 
> 时间：2012-10-15T19:58:00.480
> 
> 标签：jquery, forms

[https://www.livingbank.org/user/sign_in](https://www.livingbank.org/user/sign_in)

单击 2 个空输入框中的任何一个都会立即加载主页。我在代码中看不到任何会导致这种情况发生的东西。有没有人有任何想法？似乎在所有浏览器中都发生了。提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T20:24:42.017

查看“admin- ***** .js”。在文档末尾删除尖线：

```
$("div.container").each(function () {
    $(this).height() > e && (e = $(this).height())
}), $("div.container").height(e), $(".container").click(function () {
--> var e = $(this).find("a").attr("href");
--> e && (window.location = e)
}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T20:31:41.853

单击任何容器都会将您重新定位到主页。不仅仅是两个空输入框。

删除 .container 上的 click 属性。

# java - 在 JEditorPane 中将自定义字符串显示为链接

> ID：12903074
> 
> 赞同：2
> 
> 时间：2012-10-15T19:58:19.063
> 
> 标签：java, swing, hyperlink, jeditorpane

如何显示自定义字符串，如链接，以“alink”作为文本，“1234”作为其位置，而不用标签`[1234|alink]`替换它？ 我的意思是类似于 BBCode。`<a>`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T21:20:12.880

我在这里看到几个选项：

1.  您预处理您的字符串并将您的标签转换为等效的 HTML
2.  您开始使用 parsers/DTD/ [EditorKit](http://docs.oracle.com/javase/7/docs/api/javax/swing/text/EditorKit.html)。

    一种。您创建自己的语法（可能很耗时）

    湾。您重用[HTMLEditorKit](http://docs.oracle.com/javase/7/docs/api/javax/swing/text/html/HTMLEditorKit.html)（您需要扩展它），尝试将更多信息添加到默认 DTD 以添加您的自定义元素（并因此使 Parser 返回您的附加元素）并扩展 ViewFactory 以便您可以呈现您的新元素有专门的意见。

虽然从长远来看选项 2\. 显然更好（特别是如果您真的对高性能感兴趣），选项 1\. 确实很容易实现。

有关更多信息，请参阅这些链接：

*   [http://docs.oracle.com/javase/7/docs/api/javax/swing/text/html/parser/DTD.html](http://docs.oracle.com/javase/7/docs/api/javax/swing/text/html/parser/DTD.html)
*   [http://docs.oracle.com/javase/7/docs/api/javax/swing/text/html/parser/ParserDelegator.html](http://docs.oracle.com/javase/7/docs/api/javax/swing/text/html/parser/ParserDelegator.html)
*   [http://docs.oracle.com/javase/7/docs/api/javax/swing/text/html/parser/DocumentParser.html](http://docs.oracle.com/javase/7/docs/api/javax/swing/text/html/parser/DocumentParser.html)

# ruby-on-rails - Ruby on Rails ActiveRecord 包含查询，但未指定它

> ID：12903075
> 
> 赞同：1
> 
> 时间：2012-10-15T19:58:26.000
> 
> 标签：ruby-on-rails, activerecord, join, include

每当我尝试调用它时：

```
 @ships = Ship.find(:all,
                    :conditions => {:sold => params[:sold]},
                    :order => "ship.id desc") 
```

从这个模型：

```
class Ship < ActiveRecord::Base
    self.table_name = 'ship'

    self.inheritance_column = :ruby_type
    belongs_to :brand, :class_name => 'Brand', :foreign_key => :brand    
    belongs_to :fuel, :class_name => 'Fuel', :foreign_key => :fuel    
    has_many :ship_pictures, :class_name => 'ShipPicture'
    has_many :reservations, :class_name => 'Reservation'    
end 
```

我最终得到了这些查询：

```
 Ship Load (0.0ms)  SELECT "ship".* FROM "ship" WHERE "ship"."sold" = 'false' ORDER BY ship.id desc
  Brand Load (0.0ms)  SELECT "brand".* FROM "brand" WHERE "brand"."name" = 'Percedes' LIMIT 1
  Fuel Load (0.0ms)  SELECT "fuel".* FROM "fuel" WHERE "fuel"."name" = 'Air' LIMIT 1
  ShipPicture Load (0.0ms)  SELECT "ship_picture".* FROM "ship_picture" WHERE "ship_picture"."ship_id" = 2
  Brand Load (1.0ms)  SELECT "brand".* FROM "brand" WHERE "brand"."name" = 'Volksship' LIMIT 1
  Fuel Load (1.0ms)  SELECT "fuel".* FROM "fuel" WHERE "fuel"."name" = 'Nuclear Reactor' LIMIT 1
  ShipPicture Load (0.0ms)  SELECT "ship_picture".* FROM "ship_picture" WHERE "ship_picture"."ship_id" = 1 
```

为什么会这样？我没有打电话 :include 或类似的东西？我想加入 ship_pictures 并且只获得该加入的第一个结果。

第二件事：什么被认为更好：象征方式还是方法方式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T20:36:20.670

这似乎不是在这里玩的延迟加载。如果使用延迟加载，我希望只看到三个查询`Brand`，`Fuel`并且`ShipPicture`SQL 如下：

```
WHERE "ship_picture"."ship_id" IN [1,2] 
```

您的`Ship`模型中是否还有其他代码调用了这些关联？

如果您上面的查找器来自控制器，您可能正在调用`ship.fuel`，`ship.brand`或者`ship.ship_pictures`在您的视图中的某个地方。这是 N+1 查询的常见原因。如果它不是来自控制器，那么它很可能是在查询结果上运行的其他代码。

# java - Eclipse IDE 中的调用方法，如 bluej

> ID：12903076
> 
> 赞同：-2
> 
> 时间：2012-10-15T19:58:32.057
> 
> 标签：java, eclipse, bluej

我什至有点喜欢 bluej 的唯一一点是，您可以在没有 String[] args 位的情况下调用方法。eclipse ide中是否有任何等价物？我在计算机科学课上，所以我们并不总是编写完整的代码，通常是编写返回东西的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:05:54.737

我相信这就是你要找的东西：[Eclipse Scrapbook](http://pure-essence.net/2008/12/11/eclipse-run-java-code-easily/)

非常简单的教程，如果您只是想测试一些代码片段，那就太好了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T20:26:46.207

如果您正在寻找 BlueJ 的一部分，该部分显示一个画布，每个类都在一个正方形中，并允许您右键单击对象以创建该类的实例并提供参数，那么我认为您不会为 Eclipse 找一个，除非有一个我在 Google 上找不到的插件 :)

adback03 可能有一个很好的选择，或者您可以通过在项目中创建一个专用于测试类的新类来实现类似但图形不友好的东西。

稍后在“Objects First with Java”一文中，您将开始学习使用 Java 测试框架。您将使用测试类实例化和测试对象。这就是你下课后的做法，我知道它在视觉上不那么令人愉悦，但你可能应该开始习惯它:)

# mysql - MySQL CASE 反向工作

> ID：12903080
> 
> 赞同：1
> 
> 时间：2012-10-15T19:59:01.073
> 
> 标签：mysql, case

我正在使用 CASE 清理表格中的一些州缩写，但它的工作方式与逻辑相反。我单独选择了长度以表明长度计算正确，所以我认为这是关闭的 CASE 逻辑

当我查询...

```
SELECT billing_state,
       length(billing_state),
       CASE billing_state
         WHEN length(billing_state) > 2 THEN (select state_abbr from lkup_states where upper(state_name) = billing_state)
         WHEN length(billing_state) = 2 THEN upper(billing_state)
         ELSE 'UNKNOWN'
       END as billing_state_fixed           
  FROM accounts
+---------------+-----------------------+---------------------+
| billing_state | length(billing_state) | billing_state_fixed |
+---------------+-----------------------+---------------------+
| GA            |                     2 | NULL                |
| Alabama       |                     7 | ALABAMA             |
| MS            |                     2 | NULL                |
| FL            |                     2 | NULL                |
| NULL          |                  NULL | UNKNOWN             |
+---------------+-----------------------+---------------------+ 
```

然而，当我进入这个奇怪的逻辑时，它就起作用了。

```
SELECT billing_state,
       length(billing_state),
       CASE billing_state
         WHEN length(billing_state) = 2 THEN (select state_abbr from lkup_states where upper(state_name) = billing_state)
         WHEN length(billing_state) <> 2 THEN upper(billing_state)
         ELSE 'UNKNOWN'
       END as billing_state_fixed           
  FROM accounts

+---------------+-----------------------+---------------------+
| billing_state | length(billing_state) | billing_state_fixed |
+---------------+-----------------------+---------------------+
| GA            |                     2 | GA                  |
| Alabama       |                     7 | AL                  |
| MS            |                     2 | MS                  |
| FL            |                     2 | FL                  |
| NULL          |                  NULL | UNKNOWN             |
+---------------+-----------------------+---------------------+ 
```

有人可以试试这个吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T20:04:04.163

根据[docs](http://dev.mysql.com/doc/refman/5.6/en/control-flow-functions.html)，您的语法不太正确。

你糊涂了`CASE value WHEN compare_value`和`CASE WHEN expression`。

你可能想要的是：

```
SELECT billing_state,
       length(billing_state),
       CASE
         WHEN length(billing_state) > 2 THEN (select state_abbr from lkup_states where upper(state_name) = billing_state)
         WHEN length(billing_state) = 2 THEN upper(billing_state)
         ELSE 'UNKNOWN'
       END as billing_state_fixed           
  FROM accounts 
```

# python - 从 Python 2.x 或 3.x 开始？

> ID：12903081
> 
> 赞同：1
> 
> 时间：2012-10-15T19:59:10.870
> 
> 标签：python, python-3.x, python-2.7

我不太确定真正的区别是什么，所以我无法决定哪个版本更适合初学者。

我基本上有 C、C++ 和 Java 的背景，我想启动 Python 因为我需要它，这看起来像一个菜鸟问题，但我真的不知道我应该选择哪个版本；对于我所看到的 2.x 和 3.x 之间的区别主要与两个版本中使用的语法有关，但是由于我什至什么都没有开始但我什么都不知道所以我问：我应该是哪一个选择 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T20:04:12.823

您可以从任何您想要的版本开始。语法几乎相似，主要区别可以在这里找到：

[http://docs.python.org/release/3.0.1/whatsnew/3.0.html](http://docs.python.org/release/3.0.1/whatsnew/3.0.html)

对于学习，我建议使用 3.x，因为 2.x 已冻结。除了错误修复之外，几乎不会添加任何功能。

对于行业级应用程序：2.x，因为许多库尚未移植（例如：mechanize、BeautifulSoup 等）。此外，Google App Engine 还不支持 3.x。

我的建议是在 2.x 中编写代码，但要确保它可以轻松移植。一旦你掌握了 py2to3 工具的窍门，这并不难。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-15T20:01:33.290

只需从 python wiki阅读[此内容。](http://wiki.python.org/moin/Python2orPython3)短版：Python 2.x 是现状，Python 3.x 是该语言的现在和未来。

我个人会安装两者，但现在使用 2.x（2.7 或某些特定库 2.6）进行开发，主要是由于更好的库支持。如果时机成熟，跳棋也不会太难，因为语法变化并不像 Ashwini Chaudhary 指出的那么大。如果您只是在学习并且不需要大量的库支持，请选择 3.x。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-15T20:02:29.907

大多数人仍在使用 2.x，甚至 Django（Python 最流行的 Web 框架之一）还没有完全支持 Python 3。

我将从 2.x 版本开始。与其他库一起工作时，您的头痛会少很多。

# paypal - 是否可以在没有贝宝帐户的情况下使用沙盒？

> ID：12903082
> 
> 赞同：0
> 
> 时间：2012-10-15T19:59:13.960
> 
> 标签：paypal

我是初学者 php 程序员，我正在创建一个购物车应用程序，我已经创建了 **Sandbox**卖家和买家 A/c 我只是想知道是否可以在不创建的情况下向客户展示“付款”的演示（具有 paypal 凭据客户的 A/c) 贝宝 A/c。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T11:30:55.843

您可以在重定向到 PayPal 沙箱的页面上显示演示，但您必须拥有 PayPal 买家帐户才能进行一些交易。

您可以更早地保持登录 PayPal 沙箱帐户，当页面重定向到 PayPal 页面时，它将通过跳过登录页面自动显示付款部分。

# javascript - 是否可以使用 Javascript 打开一个 Sqlite 数据库而不使用 HTML5 以外的任何东西？

> ID：12903086
> 
> 赞同：4
> 
> 时间：2012-10-15T19:59:29.060
> 
> 标签：javascript, html, sqlite

我正在尝试创建一个适用于任何移动设备但不需要互联网的应用程序。我想要一个可以查询的 Sqlite 数据库。我找到了一个脚本，但它在浏览器中创建了一个 WebSQL 数据库。我想查询平面文件。这甚至可能吗？

这是我的代码：

```
function createDatabase() {
    try{
        if (window.openDatabase) {
            var db;
            var shortName = 'configurator.sqlite';
            var version = '1.0';
            var displayName = 'configurator';
            var maxSize = 65335;

            db = openDatabase(shortName, version, displayName, maxSize);
        } else {
            console.log('failure');
        }
    } catch(e) {
        alert(e);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:05:54.507

是的，有可能。试试下面的链接

*   [http://benpoole.com/weblog/201106222227](http://benpoole.com/weblog/201106222227)
*   [https://gist.github.com/1041277](https://gist.github.com/1041277)
*   [https://www.tutorialspoint.com/html5/html5_web_sql.htm](https://www.tutorialspoint.com/html5/html5_web_sql.htm)
*   [https://developer.apple.com/library/archive/documentation/iPhone/Conceptual/SafariJSDatabaseGuide/UsingtheJavascriptDatabase/UsingtheJavascriptDatabase.html](https://developer.apple.com/library/archive/documentation/iPhone/Conceptual/SafariJSDatabaseGuide/UsingtheJavascriptDatabase/UsingtheJavascriptDatabase.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-05-08T15:56:10.173

问题是要求可以提供教程来查询 FlatFile DB 而不是嵌入在浏览器中的 web db 的人。您的所有链接都提供有关 Web DB 的教程，该问题清楚地突出显示。

我认为您应该在 Github 上研究 SQL.JS 以获得您想要的解决方案。它在某种程度上依赖于 Node.js，但你会很好地实现你的目标。

# c# - 如何设置datagridview列的最大长度

> ID：12903087
> 
> 赞同：12
> 
> 时间：2012-10-15T19:59:49.750
> 
> 标签：c#, datagridview

我有一个`DataGridView`可以在`TextBox`列中输入单位的位置。

如何将此列的*输入长度限制*为`6`字符？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-10-15T20:08:26.420

使用. [`MaxInputLength`](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewtextboxcolumn.maxinputlength.aspx)_`DataGridViewTextBoxColumn`

此属性可通过 Designer 或代码获得：

```
((DataGridViewTextBoxColumn)dataGridView1.Columns[yourColumn]).MaxInputLength = 6; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-15T20:02:27.617

请使用*DataGridView的*[CellValueChanged](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.cellvaluechanged.aspx)事件。

 *在事件的处理程序中，您可以检查[DataGridViewCellEventArgs参数的](http://msdn.microsoft.com/en-us/library/8fwkafb0.aspx)[ColumnIndex](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewcelleventargs.columnindex.aspx)和[RowIndex](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewcelleventargs.rowindex.aspx)属性，以识别网格的感兴趣字段已被编辑，然后 - 采取适当的行动。

如其他答案所述 - 限制*DataGridView*字段文本长度的最自然方法是修改相应的网格列属性。可以在*Edit Columns*表单上更改网格列的属性，该表单通过右键单击菜单项*Edit Columns...在**表单设计*器中为网格控件调用：

 *![在此处输入图像描述](../Images/6ad578117d61868984544f07ce5c9dd3.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T20:03:16.580

您可能必须使用单元格编辑事件。 [http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.cellvaluechanged.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.cellvaluechanged.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-10-14T09:10:13.590

如果您使用数据绑定，则不一定要准备好操作列。对于数据绑定，使用**ColumnAdded**侦听器可以帮助：

```
public FormSingleValidation(BindingList<ValidateSingle> validateSingles)
{
    InitializeComponent();

    dataGridViewSingleValidation.ColumnAdded += ColumnAdded;

    this.validateSingles = validateSingles;
    var source = new BindingSource(validateSingles, null);
    dataGridViewSingleValidation.DataSource = source;
}

private void ColumnAdded(object sender, DataGridViewColumnEventArgs e)
{
    if(e.Column.GetType() == typeof(DataGridViewTextBoxColumn))
    {
        DataGridViewTextBoxColumn column = (DataGridViewTextBoxColumn) e.Column;
        column.MaxInputLength = 6;
    }
} 
```

注意事项

1.  显然，这适用于所有文本列，没有区别，如果您只想影响特定列，则可以使用列名称添加条件过滤器。**

# jquery - Javascript ceil 有 2 位小数而不是 1

> ID：12903088
> 
> 赞同：5
> 
> 时间：2012-10-15T19:59:53.220
> 
> 标签：jquery, rounding, ceil

我有一些对我来说效果很好的javascript，我只是希望它保留2个小数位，而不是隐藏额外的小数位（如果它是0）。

现在它说：“0.2”，我想说：“0.20”

这是Javascript。谁能告诉我如何实现这一目标？

```
 $(function() {

var valueMultiplier = <?php echo $savingsVar; ?>;

function updateAmounts() {

    // valueMultiplier = savings
    // value1 = how often do you change your printer cartridges?
    // value2 = how frequently you change them

    var value1 = $('#slider').slider('value');

    var value2 = $('#slidertwo').slider('value');

    var value3 = ((valueMultiplier * value1) * value2);
    var value3 = (Math.ceil(value3 * 10) / 10);

    // add month to it
    if(value1==1){
        value1 = value1 + ' month';
    }else{
        value1 = value1 + ' months';
    }

    value2 = value2 + ' months';

    $('#amount').val(value1);

    $('#amounttwo').val(value2);

    $('#amountthree').val(value1 + value2);

    $('#amountfour').val(value3);

    $('#amountfive').val(value3);

}

$('#slider').slider({value: 1, min: 1, max: 12, step: 1, stop: function(event, ui) {
    updateAmounts();
}});
$('#slidertwo').slider({value: 1, min: 3, max: 36, step: 3, stop: function(event, ui) {
    updateAmounts();
}});

$('#price').val("$" + valueMultiplier);

updateAmounts();
}); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-15T20:03:39.793

您可以使用[toFixed](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Number/toFixed)函数。它返回一个字符串，但在你的情况下应该没问题：

```
js> x = 0.2
0.2
js> x.toFixed(2)
0.20
js> 
```

# css - 表单选择选项换行重叠

> ID：12903094
> 
> 赞同：1
> 
> 时间：2012-10-15T20:00:36.417
> 
> 标签：css

我有一个标准的 select> option> 表单元素，但在某些屏幕上 option> 正在中断到第二行。有没有办法强制它不中断或至少控制行高以避免它与第一行重叠？

我已经尝试过通常的嫌疑犯。行高：60px；等等，但没有运气？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T20:08:36.067

我假设您的中断字符串包含空格。要使字符串不中断，请在值字符串中使用不可破坏空间的`&nbsp;`HTML 特殊字符代替空格；`<option>`

# c# - 使用类似“Windows”的菜单管理面板内的窗口

> ID：12903108
> 
> 赞同：1
> 
> 时间：2012-10-15T20:02:20.857
> 
> 标签：c#, winforms, panel

我有一个面板。

我在其中添加了 WinForms。添加的 WinForms 的 TopLevel 和 Visible 属性设置为 FALSE 和 TRUE。

我可以做一个`panel.SetChildIndex(WinForm1,0)`把 WinForm1 带到前面。

我没有设法做的是跟踪`ChildIndex`面板的实际情况。

这个想法是在面板内有打开表单的按钮，并且当面板打开时，在菜单中添加一个新按钮`Windows`。

就像在 VS 项目上打开许多文件时，您可以转到 Window 菜单并选择一个。此外，如果您通过单击页面更改活动页面，“窗口”菜单会自动更新并检查实际的活动页面。

我想这样做，但要使用面板容器。我已经设法完成了一切，但不是`the Window menu auto-updates and checks the actual active page`部分。

`BringToFront()`当或被`SetChildIndex(form, index)`调用时没有触发事件吗？当我单击面板内的另一个表单并成为“活动表单”时，是否有任何事件？或者当活动表单更改时，我可以跟踪面板的某些属性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:09:24.290

它取自[这里](http://social.msdn.microsoft.com/Forums/en-US/winforms/thread/d24477dc-fe11-48ab-8b33-532848f7c3d8/)

> 当 Control 的 ZOrder 被更改时，布局操作总是在控件的容器控件中执行。
> 
> 当我订阅容器的 Layout 事件并调用 BringToFront() 时，它向我展示了 Control 更改了其 ZOrder(LayoutEventArgs.AffectedControl) 和更改了属性 (LayoutEventArgs.AffectedProperty)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T02:32:04.540

发现当面板内的表单关闭时，面板的`Controls`属性会被重新索引，其中索引零是获得新焦点的表单。现在，当我关闭另一个表单时，我有一种方法可以检查前面的表单，面板中的窗口管理就完成了。

打算把源代码，也许它可以帮助某人:)

请注意，我使用的是 RadRibbonForm、标准面板和面板内的 RadForms。Rad 来自 Telerik。有些事情应该改变以使这项工作在standardWinForms上工作，但改变很小。

另外，我没有使用显示表单的菜单，而是在功能区菜单的页面中使用 RadButtonElement。

`AddRadFormWindow`必须调用来放置一个窗口并自动管理它。

添加窗口的示例：

`AddRadFormWindow(typeof (MyRadForm))`

现在，来源。它必须在 RadRibbonForm 类的代码中。

```
public static class ExtensionsRadForm
{
    [DllImport("user32.dll")]
    private static extern int ShowWindow(IntPtr hWnd, uint msg);

    public static void Deminimize(this RadForm form)
    {
        if (form.WindowState == FormWindowState.Minimized)
            ShowWindow(form.Handle, 9);
    }
}

    private void RefreshButtonsChecks(string windowName)
    {
        if (windowName != null)
        {
            principalPanel.Controls[windowName].BringToFront();
        }
        if (principalPanel.Controls.Count > 0)
        {
            if (principalPanel.Controls.Cast<RadForm>().Any(radForm => radForm.WindowState != FormWindowState.Minimized))
            {
                foreach (RadItem item in radRibbonBarGroupOpenWindows.Items)
                {
                    var buttonBorder = ((RadButtonElement) item).BorderElement;
                    if (item.Name == panelPrincipal.Controls[0].Name + "Button")
                    {
                        buttonBorder.ForeColor = Color.LimeGreen;
                        buttonBorder.BottomColor = Color.LimeGreen;
                        buttonBorder.TopColor = Color.LimeGreen;
                        buttonBorder.LeftColor = Color.LimeGreen;
                        buttonBorder.RightColor = Color.LimeGreen;
                        principalPanel.Controls[0].Focus();
                    }
                    else
                    {
                        buttonBorder.ForeColor = Color.Transparent;
                        buttonBorder.BottomColor = Color.Transparent;
                        buttonBorder.TopColor = Color.Transparent;
                        buttonBorder.LeftColor = Color.Transparent;
                        buttonBorder.RightColor = Color.Transparent;
                    }
                }
            }
            else
            {
                foreach (RadItem item in radRibbonBarGroupAbiertas.Items)
                {
                    var buttonBorder = ((RadButtonElement)item).BorderElement;
                    buttonBorder.ForeColor = Color.Transparent;
                    buttonBorder.BottomColor = Color.Transparent;
                    buttonBorder.TopColor = Color.Transparent;
                    buttonBorder.LeftColor = Color.Transparent;
                    buttonBorder.RightColor = Color.Transparent;
                }
            }
        }
    }
private void PrincipalPanelLayout(object sender, LayoutEventArgs e)
    {
        RefreshButtonsChecks(null);
    }
private void RadButtonElementCloseAllWindowsClick(object sender, EventArgs e)
    {
        int limitButtons = radRibbonBarGroupOpenWindows.Items.Count;
        for (int index = 0; index < limitButtons; index++)
        {
            RadItem radItem = radRibbonBarGroupOpenWindows.Items[0];
            radItem.Dispose();
        }
        int limitControls = principalPanel.Controls.Count;
        for (int index = 0; index < limitControls; index++)
        {
            Control control = principalPanel.Controls[0];
            control.Dispose();
        }
        Update();
        GC.Collect();
    }
private void AddRadFormWindow(Type windowToAdd)
    {
        if (!principalPanel.Controls.ContainsKey(windowToAdd.Name))
        {
            var window = (RadForm) Activator.CreateInstance(windowToAdd);
            window.TopLevel = false;
            window.Visible = true;
            window.FormClosing += (method, args) =>
                                       {
                                           radRibbonBarGroupOpenWindows.Items[window.Name + "Button"].Dispose();
                                           GC.Collect();
                                       };
            window.Enter += (method, args) => RefreshButtonsChecks(window.Name);
            var closeMenuItem = new RadMenuItem("Close");
            closeMenuItem.MouseDown += (method, args) =>
                                           {
                                               panelPrincipal.Controls[window.Name].Dispose();
                                               radRibbonBarGroupOpenWindows.Items[window.Name + "Button"].Dispose();
                                           };
            var contextMenu = new RadContextMenu();
            contextMenu.Items.Add(closeMenuItem);
            var button = new RadButtonElement(window.Text) {Name = window.Name + "Button"};
            button.MouseDown += (method, args) =>
                                    {
                                        switch (args.Button)
                                        {
                                            case MouseButtons.Left:
                                                if (((RadForm) principalPanel.Controls[window.Name]).WindowState ==
                                                    FormWindowState.Minimized)
                                                    ((RadForm) principalPanel.Controls[window.Name]).Deminimize();
                                                principalPanel.Controls[window.Name].BringToFront();
                                                principalPanel.Controls[window.Name].Focus();
                                                break;
                                            case MouseButtons.Right:
                                                contextMenu.Show(MousePosition);
                                                break;
                                        }
                                    };
            radRibbonBarGroupOpenWindows.Items.Add(button);
            principalPanel.Controls.Add(window);
            principalPanel.Controls[window.Name].BringToFront();
            principalPanel.Controls[window.Name].Focus();
        }
        principalPanel.Controls[windowToAdd.Name].BringToFront();
        principalPanel.Controls[windowToAdd.Name].Focus();
        Update();
        GC.Collect();
    }
public Constructor()
    {
        panelPrincipal.Layout += PanelPrincipalLayout;
    } 
```

# jira - 如何动态填充 Jira 自定义字段？

> ID：12903112
> 
> 赞同：1
> 
> 时间：2012-10-15T20:02:33.573
> 
> 标签：jira, jira-plugin

在以前的公司作为最终用户使用了几年之后，我对 Jira 管理员方面的事情还是很陌生。我们正在使用标准的 Jira 工作流程。我正在努力解决的情况如下。我正在尝试匹配我们的旧专有问题数据库的一些功能。现在我正在使用许多标准的 Jira 字段，只有两个新的自定义字段（都是由我手动填充的单个选择列表）：

1) 客户 = 向我们的支持团队发送新问题电子邮件的客户名称 2) 客户联系人 = 主要客户联系人，当前由自定义列表填充

我创建了这两个自定义字段，因为我们有外部客户使用我们的托管软件来电话或发送电子邮件问题。目前，当客户向我们的支持电子邮件帐户发送电子邮件时，我们的系统会创建一个简单的新问题。然后我们的支持团队进入并清理数据并确保所有必需的 Jira 字段都有数据、评论良好、可重复的步骤等。（目前我们不剥离客户域名来自动填充客户自定义字段，但我可能会尽快尝试这样做。）

我们的支持团队要求我添加以下两个新客户字段：

3) 客户电话号码 4) 客户连接/登录信息

我想要实现的是一个类似这样的系统：

*   客户名称被输入（通过抓取客户电子邮件地址的域名自动或由我们的支持团队手动输入）到客户自定义字段中。选择的客户名称应该被“推送”到客户联系人选择列表中，以帮助为该特定客户选择值。

*   客户联系人选择列表应该是“智能的”或动态的，因为在抓取客户姓名的地方进行了一些预处理，这样它就不会显示所有客户联系人供技术支持人员选择，它只是向他们显示客户所选客户的联系人。

*   除了过滤的客户联系人之外，我只想查看填充在客户联系人选择列表中的联系人的客户电话号码。

*   最后，我想查看所选特定客户的客户连接信息。我过去在创建 Java / 数据库应用程序时做过这种类型的智能组合框，所以我觉得这在吉拉。我只是在寻找实现这一点的最简单方法。似乎有一些外部插件可能有助于执行此操作（例如，自定义字段的值存储在数据库表中，因此可以查询它们，并且可以将适当的过滤结果集填充到选择列表中。），或者可能使用发布功能（更新问题）等。但在我花更多精力进行调查之前，我知道这种事情必须在某个地方很常见，并且想问 Jira 管理员专家这种功能的最佳实践是什么在自定义字段中。请分享您如何解决此类情况的经验。提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-05T18:03:01.997

这是告诉如何一次导入多个选项的方法。可能这会帮助你。

[https://answers.atlassian.com/questions/92385/importing-project-from-another-jira-instance-how-do-we-mass-import-custom-field-multi-select-options?page=1# 92622](https://answers.atlassian.com/questions/92385/importing-project-from-another-jira-instance-how-do-we-mass-import-custom-field-multi-select-options?page=1#92622)

**编辑** ，这里是使用新选择列表更新另一个选择列表的完整代码。

[如何在jira中动态或使用插件添加新值以选择列表字段](https://stackoverflow.com/questions/22892537/how-to-add-new-values-to-select-list-field-in-jira-dynamically-or-using-plug-in/23198416#23198416)

# java - 重用结果集

> ID：12903115
> 
> 赞同：4
> 
> 时间：2012-10-15T20:02:39.030
> 
> 标签：java, sql, jdbc, resultset

我需要连续运行几个查询

```
Statement st = cnx.createStatement();
ResultSet rs = st.executeQuery( "SELECT [good stuff]");
// do something smart with rs
rs = st.execute( "SELECT [better stuff]");
// do something smarter with rs
rs = st.execute( "SELECT [best stuff]");
// you got it
try{ rs.close();} catch( SQLException ignore){};
try{ st.close();} catch( SQLException ignore){}; 
```

这是前两个 ResultSet 没有正确关闭的问题，还是在垃圾收集期间隐式完成的？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-10-15T20:04:08.360

执行第二个查询后，前一个查询`ResultSet`会自动关闭。就这`Garbage Collection`一点而言，您不必担心。你可以只`stmt.close()`在最后有一个。它会自动关闭所有相关的`ResultSet`对象。

看一下：-[`ResultSet#close`](http://docs.oracle.com/javase/7/docs/api/java/sql/ResultSet.html#close%28%29)文档，其中说：-

> 当 Statement 对象关闭、重新执行或用于从多个结果序列中检索下一个结果时，生成它的 Statement 对象会自动关闭 ResultSet 对象。

如果您想测试结果集是否关闭，您可以使用 while 循环在`result set`while 循环内部迭代，创建另一个查询并将其分配给相同的结果集。你会看到一个异常会被抛出..

```
ResultSet res = stmt.executeQuery("SELECT * FROM sometable");

while (res.next()) {
    res.getString(1);

    // Closes the previous `ResultSet`
    res = stmt.executeQuery("SELECT * FROM othertable");
} 
```

所以，在上面的代码中，在第二次迭代中，你会得到一个`Exception: - Cannot perform operation after ResultSet is closed`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T20:24:06.887

我不知道您的问题是什么，但是如果您在运行此代码时遇到问题，您可以尝试关闭连接并打开其他连接以进行第二次查询。一些数据库产品，比如 SQLite，只允许一个打开的连接。如果您对数据库访问有任何问题，您应该尝试一下。

# arrays - Postgres SQL 函数 string_to_array

> ID：12903117
> 
> 赞同：2
> 
> 时间：2012-10-15T20:02:46.680
> 
> 标签：arrays, function, postgresql

我有一张桌子：

```
 c1|c2|c3|c4
-----+--+--+----    
    a  b c  10
    a  a b  20
    c  a c  10
    b  b c  10
    c  b c  30 
```

我想编写一个函数，其中输入是 3 个字符串/文本，例如（' **abc**，**bd**，**c** '），将每个元素相互比较，查找此组合是否存在一行，以及第 4 个（**c4** ) 列向上。但是，如果有**bac**或**cab**的星座， 它将匹配**abc 10**。如果有像**bcc**这样的行，那么它不会是像**cbb**这样的行。每场比赛都是独一无二的。

我认为最好的方法是使用 string_to_array(text, text)。

我整理了一些伪代码，但不知道如何用 SQL 编写它。也许逻辑也是错误的。

```
function (x,y,z)
 res = 0
 x_array = string_to_array(x, ' ')
 y_array = string_to_array(y, ' ')
 z_array = string_to_array(z, ' ')

 foreach(x_item in x_array)
  foreach(y_item in y_array)
   foreach(z_item in z_array)
    if  (c1 = (x_item || y_item || z_item ) && c2 = (x_item || y_item || z_item ) && c3 = (x_item || y_item || z_item ))
     res++ 
```

***编辑***

*   首先，示例表中有一个错误。有一行**abc**和**cba**。不可能。**abc = cba**！并且每一行必须是唯一的。
*   示例：三个*文本*输入 **abc** | **公元前**| **C**
*   每个元素与每个元素： abc 、 acc 、 bbc 、 bcc 、 cbc 、 ccc
*   **abc** = 10; **acc** (与**cac**相同) = 10; **英国广播公司**= 10; **bcc**（与**cbc**相同）= 30； **CBC** = 30; **ccc**（不匹配）= 0；结果 = **90**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:50:07.623

我*认为*这可能是你想要的：

*`c4`从给定的三个标记与列匹配的所有行中返回列的总和`(c1, c2, c3)`。*

 ~~~~### 简单版~~ 

[使用contains**`@>`**和被**`<@`**操作符](http://www.postgresql.org/docs/current/interactive/functions-array.html)包含要简单得多：

```
SELECT sum(c4) AS sum_of_matching_c4
FROM   tbl
WHERE  ARRAY[c1,c2,c3] <@ ARRAY['b', 'a', 'c'] -- strings in arbitrary order
AND    ARRAY[c1,c2,c3] @> ARRAY['b', 'a', 'c']; 
```

 ~~抱歉，这对于`('b', 'c', 'c')`vs.会失败`('c', 'b', 'b')`。

### 缓慢而确定

```
WITH i(arr) AS (
   SELECT ARRAY(VALUES ('b'), ('c'), ('c') ORDER BY 1)  -- input once
   )                                                    -- in arbitrary order
SELECT sum(c4) AS sum_of_matching_c4
FROM  (
  SELECT c4, array_agg(x ORDER BY x) AS arr
  FROM  (
      SELECT ctid, c4, unnest(ARRAY[c1,c2,c3]) AS x
      FROM   tbl t, i
      WHERE  ARRAY[c1,c2,c3] <@ arr -- optional pre-selection
      AND    ARRAY[c1,c2,c3] @> arr -- for better performance?
      ) a
   GROUP BY ctid, c4
   ) b
JOIN i USING (arr) 
```

[-> sqlfiddle 演示。](http://www.sqlfiddle.com/#!12/a81ff/11)

主要困难是对行中列的值进行*排序*。

对于您的输入（3 个字符串），我在`WHERE`子句中使用[CTE](http://www.postgresql.org/docs/current/interactive/queries-with.html)`VALUE`中的一个表达式来实现这一点，我立即订购并将其收集到一个数组中。为方便起见，我使用 CTE，因此我们只需在一个位置输入值。

行值更复杂。我将三列放在一个数组中，并用[`unnest()`](http://www.postgresql.org/docs/current/interactive/functions-array.html#ARRAY-FUNCTIONS-TABLE). 由于您没有提供主键，因此我使用[`ctid`](http://www.postgresql.org/docs/current/interactive/ddl-system-columns.html)as ad-hoc surrogate 主键 - 我需要它`GROUP BY`来将现在排序的内容填充`(c1, c2, c3)`到数组中。

最后，我总结了`c4`现在排序的数组完全匹配的所有行。

注意：我明确*不*使用`string_agg()`，因为这*不会*产生明显的结果。考虑：

```
'abc' 'cde' 'fgh'
'ab' 'ccdef' 'gh' 
```

.. 如果连接起来，则产生相同的字符串。

### 指数/表现

您可能会考虑保存预先订购的数据以加快查询速度。即时进行是昂贵的。即，您可以预先生成排序数组并将其保存为冗余列，然后您可以使用索引支持该列。对于冗余数据存储的成本，应该快几个数量级。
如果您正在处理*长字符串*，那么类似于我[在 dba.SE 上的相关答案](https://dba.stackexchange.com/a/25140/3684)中概述的解决方案可能是最好的做法。

或者（首选！）保证`(c1, c2, c3)`始终按升序存储。您可以使用触发器`BEFORE INSERT OR UPDATE`来保持行内的值有序。没有冗余存储，您可以简单地在三列上创建一个[多列索引](http://www.postgresql.org/docs/current/interactive/indexes-multicolumn.html)并一一比较它们（而不是像我的示例中那样比较数组）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T20:37:37.420

您不需要为此编写函数。

首先，postgresql ( sql ) 没有“字符串”，它是“文本”或“varchar”。

其次，您需要的是这样的 SQL 查询：

```
SELECT ( DISTINCT ( c1 || c2 || c3 )) AS txtcol, SUM (c4) AS rowsum; 
```

或者

```
SELECT ( DISTINCT ( c1 || c2 || c3 )) AS txtcol, SUM(c4) AS numsum GROUP BY txtcol; 
```

目前无法回忆起确切的语法，您需要解决它，无论如何关键是您需要将 varchar 列与一些内置函数（如 CONCAT 或“||”）连接起来 运算符，然后按数字列求和/分组。您所需要的只是连接列，并为生成的所有列命名。确切地说，您甚至不需要在结果表上显示连接列，例如，您可以只输出总和和汇总的行数。

从理论上讲，您可以为此编写 SQL 函数或 PL/SQL 函数，但我确信这不是必需的，在我看来，您的情况很简单，可以在没有函数的情况下实现您想要的结果。内置汇总函数 SUM() 称为“聚合”函数，聚合函数的其他示例是例如 MIN() 或 MAX()。请注意您实际尝试做的事情是通过每行连接的效果按一些结果 VARCHAR 列对行进行分组。

编辑：SQL 或过程 SQL 中的“数组”是一些内部处理的数组，不要将它们与关系（数据库中的表，也不与作为 SELECT 结果的表）混淆。我认为您也不需要 SQL 数组，这项任务实际上并不像看起来那么难。~~~~

# actionscript-3 - 缩放精灵以保留其可见部分的中心点

> ID：12903130
> 
> 赞同：0
> 
> 时间：2012-10-15T20:03:47.967
> 
> 标签：actionscript-3, flash, geometry

我有一个正在缩放的​​精灵（画布）。画布有一个面具。问题是简单的缩放 ( `scaleX=newScale; scaleY=newScale;`) 占据了蒙版下方蒙版下的画布部分。所以我需要在缩放后移动画布，使蒙版下的画布点保持在同一个地方。我正在尝试执行以下操作：

```
var deltaScale = newScale / scale;
//w and h are width and height of mask
canvas.scaleX = newScale;
canvas.scaleY = newScale;
canvas.x += (canvas.x + w/2) - (canvas.x + w/2) / deltaScale;
canvas.y += (canvas.y + h/2) - (canvas.y + h/2) / deltaScale; 
```

仍然在那个中心点之后不要留在同一个地方。有人可以提示我在缩放后应该如何移动画布吗？

**PS：**如果有帮助的话，画布的宽度和高度非常大（大约 25000）。

**UPD：**带有遮罩的画布被添加到 Sprite 上，遮罩与父精灵具有相同的大小，`canvas.x`并且`canvas.y`是负数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T20:16:48.983

我之前做类似事情的方法是将画布精灵放在另一个精灵中，例如。缩放，其注册点位于屏幕中心（或任何需要的地方）。然后，您可以在缩放精灵内部移动画布（在我的情况下，它是可拖动的）并缩放外部精灵，以便放大中心。我发现缩放和定位不同的精灵比做偏移要容易得多。

# git - IDEA：如何显示一个分支在哪个分支？

> ID：12903132
> 
> 赞同：1
> 
> 时间：2012-10-15T20:04:00.620
> 
> 标签：git, intellij-idea

使用 IntelliJ Idea，是否可以显示当前所在的（git）分支？

请问这个什么时候可以改？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:08:16.333

查看屏幕的右下角，您应该可以在那里看到 git 分支名称。如果不能，说明你没有告诉 IDEA 代码文件夹是 git repo。转到设置-> 版本控制，您将看到当前注册的 git 根列表以及它已检测到但当前未注册的根列表。你可以在那里修复它。

# r - Looping knitr 选项

> ID：12903133
> 
> 赞同：2
> 
> 时间：2012-10-15T20:04:03.900
> 
> 标签：r, knitr

我很好奇，有没有办法将 knitr 选项的更改合并到一个循环中？例如，如果我想循环查看相同的代码块在所有不同的 knitr 主题中的外观，我的第一个猜测是：

\documentclass{文章}

```
\begin{document}

<<test>>=
themes<-knit_theme$get()

for (a.theme in themes){

  knit_theme$set(a.theme)

  a <- 3+5
   b<- sum(1:10, na.rm=T)
  for(g in 1:10) z<-0
}
@

\end{document} 
```

然而，这会产生一些非常奇怪的输出。有没有办法使用这样的循环来动态更改输出，或者可能动态包含或不包含某些块？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-15T22:11:51.920

这是不可能的。一个文档只支持一个主题，因为所有颜色都在序言中定义，并且只能有一组定义。如果您想要不同的主题，它们必须存在于不同的文档中。请参阅此要点以了解如何在 HTML 中执行此操作以及以下中的内置主题库`knitr`：[https ://gist.github.com/3422133](https://gist.github.com/3422133)

使用 LaTeX/PDF，您还可以在 Rnw 文档上执行循环以生成不同主题的 PDF，并用于`\includegraphics{}`将它们包含在主要的 TeX 文档中。您可能可以弄清楚，因为它与上面的 HTML 示例没有太大区别。

# c# - 是否可以在对 Where 的调用中调用命名方法？

> ID：12903138
> 
> 赞同：5
> 
> 时间：2012-10-15T20:04:19.980
> 
> 标签：c#, .net, linq, entity-framework-4, linq-to-entities

我试图从 RedGate [ftp://support.red-gate.com/ebooks/under-the-hood-of-net-memory-management-part1.pdf的这本免费电子书中了解 Linq 的一些性能影响](ftp://support.red-gate.com/ebooks/under-the-hood-of-net-memory-management-part1.pdf)

在本书的第 157-158 页，他们创建了以下示例。

```
Order[] pastDueAccounts = null;  
DateTimedueDate = DateTime.Today.AddDays(-7);  
using(varcontext = new Context())    
{  
    pastDueAccounts = context.Accounts.Where(account => account.DueDate < dueDate).ToArray();  
} 
```

然后他们将 lamda 表达式的一部分重新分解为以下函数。

```
public bool PastDueAccount(Account account)  
{  
    return account.DueDate < DateTime.Today.AddDays(-7);  
} 
```

最后他们使用这个函数如下。

```
Order[] pastDueAccounts = null;  
using(varcontext = new Context())  
{  
    pastDueAccounts = context.Accounts.Where(account => PastDueAccount(account)).ToArray();  
} 
```

根据我到目前为止的研究，无法运行此 linq 查询，因为 LINQ 无法识别该方法并且无法转换为存储表达式。我想知道这个示例是否错误并且根本无法运行，或者我只是很难听到有关如何模拟这个问题的消息？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-15T20:10:28.463

你是对的，LINQ-to-Entities 不能以它的显示方式调用它。

它可以在 LINQ-to-Entities 中使用的唯一方法是：

*   在服务器端创建等效的函数。
*   [适当地映射模型中的函数，](https://stackoverflow.com/a/7001201/50776)以便正确翻译调用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-15T20:09:50.920

正如 casperOne 所说，你不能用函数来做到这一点。这个答案是一种做你需要做的事情的方法（重用 where 过滤器）。

您可以创建一个`Expression`可以访问的地方，然后重复使用它。

`System.Linq.Expressions.Expression<Func<Account, bool>> pastDueAccountFunc = account => account.DueDate < System.Data.Objects.EntityFunctions.AddDays(DateTime.Now, -7);`

然后在以后使用它：

`var pastDueAccounts = context.Accounts.Where(pastDueAccountFunc);`

这是我使用的完整代码：

```
System.Linq.Expressions.Expression<Func<SomeNeatEntity, bool>> func = x => x.DateCreated < System.Data.Objects.EntityFunctions.AddDays(DateTime.Now, -7);

var entities = new MyEntities();

var t = entities.SomeNeatEntities.Where(func);
Console.WriteLine(t.Count());

var h = entities.SomeNeatEntities.Where(x => x.SomeField != null).Where(func);
Console.WriteLine(h.Count()); 
```

`MyEntities`是`ObjectContext`在项目中。
`entities.SomeNeatEntities`是`ObjectSet<SomeNeatEntity>`。

# ios - 从 Apple 托管的应用内购买中下载内容

> ID：12903140
> 
> 赞同：5
> 
> 时间：2012-10-15T20:04:25.987
> 
> 标签：ios, in-app-purchase

我有一个 Apple 托管的应用内购买。但是我不知道如何下载与之相关的内容。我可以获得可下载的对象并请求开始下载：

```
[[SKPaymentQueue defaultQueue] startDownloads:currentTransaction.downloads]; 
```

那是我迷路的时候：那​​之后我该怎么办？我查看了 Apple doc 并没有找到任何可能对我有帮助的东西。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T17:33:52.067

实现一个 SKPaymentTransactionObserver。当支付队列改变状态时，观察者会收到通知。例如，paymentQueue:updatedDownloads: 将使用一组 SKDownloads 调用，该数组的 downloadState 指示下载的状态更改。如果您想了解已完成的下载，请查找 downloadState == SKDownloadStateFinished。

请参阅[http://developer.apple.com/library/ios/#documentation/StoreKit/Reference/SKPaymentTransactionObserver_Protocol/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/StoreKit/Reference/SKPaymentTransactionObserver_Protocol/Reference/Reference.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T13:05:24.863

我可以解决我的问题。调用

```
[[SKPaymentQueue defaultQueue] startDownloads:currentTransaction.downloads]; 
```

然后

```
(void)paymentQueue:(SKPaymentQueue *)queue updatedDownloads:(NSArray *)downloads 
```

不断被回调。我想我忘记了一些代表或类似的东西。除此之外，我从我的设备中删除了该应用程序并从 Xcode 重新编译它。然后它就像一个魅力=）谢谢

# c# - 如何确定 MigraDoc 表是否会被拆分为两页？

> ID：12903143
> 
> 赞同：6
> 
> 时间：2012-10-15T20:04:48.203
> 
> 标签：c#, migradoc

我正在使用 MigraDoc 生成一些 PDF。我有代码为数组中的每个元素创建一个文本表，并用这些表打印出页面。

但是，我得到的要求是，如果我有 2 个表，并且由于第一个表的长度，第二个表不适合页面，我需要第二个表来开始下一页。然后，我需要对要添加到文档中的每个表重复此操作。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-16T08:08:40.223

如果所有表格都小到足以容纳一页，那么有一个简单的解决方案：将第一行的 KeepWith 属性设置为行数减一，以将整个表格保持在一页上。

如果表格并不总是适合单个页面：您可以尝试破解，例如将 KeepWith 设置为 6 或 8 或 10（取决于表格行的高度）。如果该值接近于适合单个页面的值（不超过），表格将自动在新页面上开始。
显然，如果表格行具有恒定的高度，这将非常有效；如果表格行的高度不同，这将无法可靠地工作，但仍会阻止第一页上只有一两行的表格（这不是您的要求，但也许可以讨论这个要求？）。

满足您要求的干净（但复杂）的方法：访问内部 GetRenderInfoFromPage 方法。您将不得不开始一个增量过程：
1）渲染文档；
2) 如果您找到一个拆分表，请在该表之前插入一个分页符并从 1 开始重复。
另请参见此处：http:
[//forum.pdfsharp.net/viewtopic.php?p=1960#p1960](http://forum.pdfsharp.net/viewtopic.php?p=1960#p1960)

# boost - boost::bind - 获得对成员变量的写访问权？（如 boost::multi_index::member）

> ID：12903146
> 
> 赞同：1
> 
> 时间：2012-10-15T20:05:04.210
> 
> 标签：boost, boost-bind, boost-multi-index

只是出于好奇，有没有办法通过 获得对成员变量的写访问权限`boost::bind`？我可以通过 得到它`boost::multi_index::member`，但也想知道其他方法。

例子：

```
#include <string>
#include <boost/function.hpp>
#include <boost/bind.hpp>
#include <boost/multi_index/member.hpp>

using namespace std;

struct Test
{
    string name;
    Test(const string &name)
        : name(name)
    { }
};

int main()
{
    Test test("Bob");
    boost::multi_index::member<Test, string, &Test::name> nameMember;
    string &ref = nameMember(test);
    cout << ref << "\n";
    // Write Access
    ref = "Tim";

    // Read-only Access
    boost::function<const string& (Test*)> nameGetter = boost::bind(&Test::name, _1);
    cout << nameGetter(&test) << "\n";

    return 0;
} 
```

输出：

```
Bob
Tim 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T02:54:38.883

是的，有可能：

```
// Read-write Access
boost::function<string&(Test*)> nameSetter =
                                      boost::bind<std::string&>(&Test::name, _1);
nameSetter(&test) = "test";
cout << ref << "\n"; 
```

# ruby-on-rails - 如何使用 rspec 测试控制器中的所有路由

> ID：12903148
> 
> 赞同：2
> 
> 时间：2012-10-15T20:05:07.113
> 
> 标签：ruby-on-rails, rspec, capybara

我试图限制我的应用程序中的一些控制器在任何操作之前需要登录。我知道如何实现它，但不知道如何在 rspec 中为它编写好的测试。

例如，如果我想限制用户控制器的每个操作都需要登录，我可以进行如下测试：

描述“授权”做

```
describe "for non-signed-in users" do
  let(:user) { FactoryGirl.create(:user) }

  describe "in the Users controller" do

    describe "visiting the index page" do
      before { visit users_path }
      it { should have_selector('title', text: 'Log In') }
    end

    describe "visiting the edit page" do
      before { visit edit_user_path(user) }
      it { should have_selector('title', text: 'Log In') }
    end

    describe "submitting to the update action" do
      before { put user_path(user) }
      specify { response.should redirect_to(login_path) }
    end

     describe "submitting a DELETE request to the Users#destroy action" do
      before { delete user_path(user) }
      specify { response.should redirect_to(root_path) }        
    end

....etc.....

  end
end 
```

**我是否需要为要测试的每个控制器指定所有 7 条宁静路由？似乎效率很低。有没有办法说“在访问任何用户路由响应之前应该重定向到 login_path”？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2019-12-04T11:50:04.280

在尝试列出并测试我的所有应用程序路由是否存在 500 个错误时，我也有类似的担忧，并且我不想手动逐个添加每个路由（我有 150~ 左右）。

我在 command 中镜像了代码[`rake routes`](https://github.com/rails/rails/blob/e20dd73df42d63b206d221e2258cc6dc7b1e6068/railties/lib/rails/tasks/routes.rake#L2)，并使用[`ActionDispatch::Routing::RouteWrapper`](https://github.com/rails/rails/blob/05a6cd5565a808e1063bc6c7cbdfe5ae6a46b72c/actionpack/lib/action_dispatch/routing/inspector.rb#L8)以及`Rails.application.routes.routes`列出它们。

包装器提供了一种简单的方法来检查路由的控制器、动词和操作是什么。从那里您只需过滤要检查的路线并在对每条路线运行测试时对其进行迭代。

```
context 'all routes' do
    let(:all_app_routes) do
      Rails.application.routes.routes.collect do |route|
        ActionDispatch::Routing::RouteWrapper.new route 
      end.reject(&:internal?)
    end
    context 'in the Users controller' do
      let(:users_controller_routes) do
        all_app_routes.select { |route| route.controller == 'users' }
      end

      it 'all routes should redirect to login' do
        users_controller_routes.each do |route|
          begin
            # reconstruct the path with the route name
            # I did not test the line below, I personnaly kept using get('/' << route.name) as my case was to test the index pages only.
            # but you get the idea: call your http route below (http.rb, net/http, ...)
            send(route.verb, '/' << route.name)
            # will produce something like : get('/users/')

            # test it does indeed redirect
            expect(response.status).to eq(302)
            expect(response.body).to include?('my_redirect_location')

            # you could also continue further testing
            follow_redirect!
            expect(response.body).to include('<div id="login">')
          rescue Exception
            next
            # or fail test depending on what you want to check
            # I had the case of abstract method in controllers that raised exception
          end
        end
      end
    end
  end 
```

我个人仅将此代码用于测试索引方法（`select {|route| route.action =='index' }...`），因为批量测试创建/销毁/新建/编辑被证明太难了（每次都需要不同的参数）

# python - 执行加密脚本

> ID：12903149
> 
> 赞同：-1
> 
> 时间：2012-10-15T20:05:09.407
> 
> 标签：python, encryption, base64

我有一个 python 脚本，可以读取解密 base64 加密字符串，我试图拥有它，所以当字符串被解密时，它的内容被执行。

```
def crypexec(jargon):
#push base64 through decryptor
 decipher = base64.b64decode(jargon)
#execute instructions in the encoded string
 exec decipher

ferret= unicode("""DQpzZXJ2ZXIgPSBzb2NrZXQuc29ja2V0KHC5BRl9JTkVULCBzb2NrZXQuU09DS19TVFJF.. 
```

然后我尝试用

```
crypexec(ferret) 
```

不工作

[这](http://code.google.com/p/0xic-zex/source/browse/trunk/Python/BD/bd_shell.py)就是雪貂看起来未加密的样子。当然，我在运行它之前删除了加密脚本的导入部分，仍然无法理解为什么它不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T21:29:27.793

您的 base64**编码**字符串缺少填充...

您可以尝试在字符串末尾添加“=”（可能多达 3 个“=”符号）

如果这不起作用，您可能已经使用与标准“=”不同的填充符号对其进行了加密......您是如何对字符串**进行编码**的？

尝试用python对其进行编码应该可以解决这个问题

```
import base64
my_enc = base64.b64encode(""" 
def hello():
     print 'hello world!'
hello() """)

exec(base64.b64decode(my_enc)) 
```

# html5boilerplate - 为什么 min-width: 35em 而不是 480px 或 30em？

> ID：12903150
> 
> 赞同：3
> 
> 时间：2012-10-15T20:05:11.420
> 
> 标签：html5boilerplate, breakpoints, css

在最新版本的 h5bp 中，您使用 min-width:35em 作为查询中的第一个断点。我很好奇为什么这个数字具体？这是基于最新的智能手机屏幕尺寸还是什么？通常，第一个断点通常是 480px/30em。

# tbb - 取消 tbb Parallel_reduce 导致内存泄漏

> ID：12903151
> 
> 赞同：1
> 
> 时间：2012-10-15T20:05:12.340
> 
> 标签：tbb

在我正在开发的程序中，我们使用 tbb::Parallel_reduce 并且用户可以中途取消程序，我们通过抛出自定义异常来做到这一点。当抛出异常时，将调用单个线程的析构函数，而其余的则只剩下，并且由于每个线程都在制作一些数据的副本（需要处理），因此可能会出现非常大的内存泄漏。通常这不会成为问题，但是此代码正在另一个程序中运行，因此操作系统将无法释放内存。

我对此的主要问题是，有没有人知道一种方法可以在抛出异常时强制调用每个线程的析构函数，或者另一种能够清理数据的方法。非常感谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-24T16:38:59.360

看起来它已在 TBB 4.2 中修复，这是 CHANGES 文件的摘录：

> 修复的错误：
> 
> *   正如 Darcy Harrison 所建议的，当执行被取消或抛出异常时，修复了 parallel_reduce 主体对象的泄漏。

# sql - 用于将列转换为行的 SQL 查询

> ID：12903154
> 
> 赞同：1
> 
> 时间：2012-10-15T20:05:15.460
> 
> 标签：sql, sql-server-2000

我有一张表说时间表，其中有一周的小时条目存储为一行。例如：

```
ID  Start Date  Sun  Mon  Tue  Wed  Thu  Fri  Sat
-------------------------------------------------
1   14-Oct-2012  0    1    1    2    3    5    0 
```

开始日期始终是星期日的日期。我需要根据输入条件将此数据导出到多行中，每个日期一行。

例如，如果输入条件是：日期在 2012 年 10 月 15 日到 2012 年 10 月 17 日之间，我的输出应该是这样的：

```
Date   Hours
------------
15-Oct   1
16-Oct   1
17-Oct   2 
```

我正在使用 SQL Server 2000，请给我一个建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:33:30.683

SQL Server 2000 没有`UNPIVOT`函数，因此您可以使用 a`UNION ALL`来查询此数据并以您想要的格式获取它：

```
select date, hours
from
(
  select id, startdate date, sun hours
  from yourtable
  union all
  select id, dateadd(dd, 1, startdate), mon
  from yourtable
  union all
  select id, dateadd(dd, 2, startdate), tue
  from yourtable
  union all
  select id, dateadd(dd, 3, startdate), wed
  from yourtable
  union all
  select id, dateadd(dd, 4, startdate), thu
  from yourtable
  union all
  select id, dateadd(dd, 5, startdate), fri
  from yourtable
  union all
  select id, dateadd(dd, 6, startdate), sat
  from yourtable
) x
where date between '2012-10-15' and '2012-10-17' 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/c4f57/12)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T20:14:11.407

这是获取表中所有列的列表的方法：

```
SELECT c.colid, c.name
FROM syscolumns c, sysobjects t
WHERE c.id = t.id
AND t.name = <YOUR_TABLE>
AND t.xtype = 'U'
ORDER BY c.colid; 
```

您可以将其声明为子查询并加入它并输出您想要的任何列。

# mysql - 删除 Mysql DB 中的回车

> ID：12903156
> 
> 赞同：20
> 
> 时间：2012-10-15T20:05:17.957
> 
> 标签：mysql

我正在尝试替换数据库中的垃圾：

```
UPDATE xxxxxx set body = replace(body,'<p></p><p>','<p>') 
```

有些标签没有被替换，因为它们之间有换行符......

在 phpmyadmin 我看到这个：

```
yadda yadda<p></p>
<p>yadda yadda 
```

这没用。。

```
UPDATE xxxxxx set body = replace(body,'\\r\\n','');
UPDATE xxxxxx set body = replace(body,'\\r','');
UPDATE xxxxxx set body = replace(body,'\\r',''); 
```

休息时间从哪里来？

有任何想法吗？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-10-15T20:08:11.523

```
UPDATE xxxxxx set body = replace(body,'\r\n','');
UPDATE xxxxxx set body = replace(body,'\n',''); 
```

试试上面的。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2016-11-18T10:36:29.483

这些都不适合我。然后我意识到我也有断句¶。这个查询对我有用：

```
UPDATE xxxxxx SET body = REPLACE(REPLACE(body, '\r', ''), '\n', ''); 
```

# css - CSS 提升了子 DIV 的角落

> ID：12903158
> 
> 赞同：0
> 
> 时间：2012-10-15T20:05:30.293
> 
> 标签：css

我能够使用 CSS 为 DIV 制作提升的角落。这是jsfiddle链接 [这里](http://jsfiddle.net/jeewanaryal/rSjXT/)

我需要设计许多子 DIV，它们也像父级一样抬起角。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:28:36.893

理想情况下，您希望您的代码达到 simone 的答案可以工作的程度。不过，要达到这一点可能需要一些工作！

您的第一个问题源于您的`drop-shadow`和`lifted`类不独立的事实。您需要将一个（修改后的）`drop-shadow`类附加到任何`div`您希望阴影出现的地方，正如您[在这个丑陋的 JSFiddle](http://jsfiddle.net/rSjXT/43/)中看到的那样。

但是，我不得不对您的`drop-shadow`课程进行修改。我所做的是去掉`drop-shadow:before, drop-shadow:after`选择器上的“z-index”值，它隐藏了 child 上的阴影`div`。

从这里，我们可以看到我们需要进行的第一个编辑。您需要添加

```
.lifted:after,
.lifted:before {
    position: absolute;
    content: "";
} 
```

这是使阴影可见所必需的（请记住，如果不设置`before`和伪元素将不会显示）。但这还不够。原因是您的定位是将两个阴影放在彼此之上。`after``content``absolute`

[转到这个 JSFiddle](http://jsfiddle.net/63Xsd/)并从孩子中添加/删除`lifted`类，`div`看看我的意思。

[这个 JSFiddle](http://jsfiddle.net/rSjXT/80/)几乎修复了它，但是您应该看到[这个问题和答案](https://stackoverflow.com/questions/7822078/z-index-with-before-pseudo-element)，看看为什么它没有！您应该能够使用它来解决您的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T20:10:14.937

您的 jsFiddle 中有一个`.lifted`类。您可以在其他所有需要的类中使用相同的类`div`。

# objective-c - 将单例类用于“实用程序”类的主要优点是什么？

> ID：12903161
> 
> 赞同：4
> 
> 时间：2012-10-15T20:05:47.093
> 
> 标签：objective-c, ios

我已经看到许多对“单例”的引用，并且已经看到它们用于“实用”功能，例如常见的验证、转换等。假设不需要引用“自我”，那么使用单例有什么好处，而不是用类方法和可选的静态变量简单地实现实用程序类？风格？表现？并发？

换句话说，不是通过 MySingleton 实例调用 foo ：

```
BOOL b = [[MySingleton sharedInstance] foo:xyz]; 
```

可以通过 MyUtility 的类方法调用 foo：

```
BOOL b = [[MyUtility class] foo:xyz]; 
```

任何一个类的实现都是隐含的，如果可以的话，我将放弃列出它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T20:12:23.570

*除了假设没有引用 self*之外，没有其他优点。我所说的“你”并不是指你的实现`MyUtility`，我指的是那些调用的类`MyUtility`——换句话说，你最终将实现的知识`MyUtility`投入到其他类中，这与通常的面向对象原则相反。

也就是说，同样的论点反过来说。如果您假设有一个实例，则`MyUtility`需要充当实例。如果您调用类方法，那么它可以在内部将它们传递给单例实例。

然而，因为实例是常态而不是例外，所以从风格上讲，期望与实例交谈的可能性较小。

# xna - 如何获取 MonoGame 中的底层窗口？

> ID：12903166
> 
> 赞同：5
> 
> 时间：2012-10-15T20:06:01.227
> 
> 标签：xna, opentk, monogame

我正在将**[Gleed2D](https://github.com/SteveDunn/Gleed2D)**从 XNA 转换为 MonoGame。

Gleed2D 是一个**Windows 窗体应用程序**，它实例化一个`XnaGame`. 然后隐藏`window`由创建的并在主窗体上设置为 a 。`Game``DeviceWindowHandle``Canvas`

我知道这有点拗口；代码不言自明：[这里是完整的](https://github.com/SteveDunn/Gleed2D/blob/master/src/Gleed2D.Ui/XnaGame.cs)。
相关位在构造函数中：

```
 _drawSurface = mainForm.GetHandleToCanvas();
            _graphics = new GraphicsDeviceManager( this )
            {
                PreferredBackBufferWidth = 800,
                PreferredBackBufferHeight = 600
            } ;

        _graphics.PreparingDeviceSettings += graphics_PreparingDeviceSettings;

        _winform = (Form)Form.FromHandle(Window.Handle);

        _winform.VisibleChanged += game1VisibleChanged;
        _winform.Size = new Size(10, 10);

        Mouse.WindowHandle = _drawSurface;

        Size pictureBoxSize = _mainForm.CanvasSize ;

        ResizeBackBuffer( pictureBoxSize.Width, pictureBoxSize.Height ) ;

                    ... some other stuff....

    void graphics_PreparingDeviceSettings(object sender, PreparingDeviceSettingsEventArgs e)
    {
        e.GraphicsDeviceInformation.PresentationParameters.DeviceWindowHandle = _drawSurface;
    } 
```

我的问题是：在 XNA 中，`Window.Handle`可以将`Form`. 在 MonoGame 中，它被实现为`OpenTK.GameWindow`. **如何进入实际窗口以便隐藏和/或调整其大小？**. 另一个问题是：**我怎样才能创建一个 MonoGame`Game`并告诉它渲染表面是另一个控件的表面？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T19:07:12.790

在创建原生 Window 之前，OpenTK 的 GameWindow 走了很长一段路。在此页面上，您可以看到本机实现：[https ://github.com/mono/opentk/blob/master/Source/OpenTK/Platform/Windows/WinGLNative.cs](https://github.com/mono/opentk/blob/master/Source/OpenTK/Platform/Windows/WinGLNative.cs)

我的解决方案是破解 OpenTK 的源代码或在 OpenTK 论坛中提问。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T08:29:09.247

不确定这是否有帮助，但在 MonoGame 游戏构造函数中，它将 GraphicsDeviceManager 初始化为一个名为 _graphics 的变量。哪个这个对象你可以得到当前的GraphicsDevice Manager，它有一个名为SetRenderTarget和SetRenderTargets的方法。您还可以通过 this.Window.Handle 获取游戏窗口的句柄，其中“this”是当前游戏对象。图形设备中还有一个 Present 方法，您可以传递源和目标 Rectangle 以及任何 Windows 句柄。祝你好运。

# objective-c - 字符串解析，用逗号分隔，除非用撇号括起来

> ID：12903167
> 
> 赞同：1
> 
> 时间：2012-10-15T20:06:11.853
> 
> 标签：objective-c, ios, cocoa-touch, parsing

我需要在 Objective-C for iOS 应用程序中解析以下字符串

NSString *htmlString = @"12, 22, 'stringA','', 'stringB, stringC', 2,'stringD'";

我想要一个这样的数组

```
{
    @12,
    @22,
    @"stringA",
    @"emptySlotInfo",
    @"stringB, stringC",
    @2,
    @"stringD"
} 
```

令人头疼的是 @"strinb, stringC" 因为

```
[htmlString componentsSeparatedByString:@","]; 
```

不适用于这种情况，并且 @"'" 作为分隔符也不起作用。

如何获得必要的组件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:16:47.113

你可以使用[NSScanner](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSScanner_Class/Reference/Reference.html)。

如果它扫描 a `'`，它知道一个字符串正在开始并忽略`,`，直到它读取下一个`'`。如果没有`'`读取到开头，则以. 分隔`,`。

[这篇 cocoawithlove 文章](http://www.cocoawithlove.com/2009/11/writing-parser-using-nsscanner-csv.html)可能会有所帮助。

* * *

我做了一个快速原型。很可能有很多需要优化的地方，因为我也不是 NSScanner 的专家

```
NSString *htmlString = @"12, 22, 'stringA','', 'stringB, stringC', 2,'stringD'";
NSScanner *scanner = [NSScanner scannerWithString:htmlString];

NSString *apostrophe = @"'";    // scanner needs to detect this
NSString *comma = @",";         // scanner needs to detect this
NSCharacterSet *charSet = [NSCharacterSet characterSetWithCharactersInString:[NSString stringWithFormat:@"%@%@", apostrophe, comma]];
BOOL apostropheOpen = NO;       // is the scan location inside a single quoted substring?
NSInteger lastCommaIndex = -1;  // track last found comma's index
NSMutableArray *array = [NSMutableArray array];

while (![scanner isAtEnd]) {
    [scanner scanUpToCharactersFromSet:charSet intoString:NULL];
    NSString *charAtlocation = [htmlString substringWithRange:NSMakeRange([scanner scanLocation], 1)];
    if ([charAtlocation isEqualToString:apostrophe]){
        apostropheOpen = !apostropheOpen;                
    } else if ([charAtlocation isEqualToString:comma]){
        if (!apostropheOpen) {
            [array addObject: [scanner.string substringWithRange:NSMakeRange(lastCommaIndex+1, [scanner scanLocation]- lastCommaIndex-1)]];
            lastCommaIndex = [scanner scanLocation];
        }
    }
    [scanner setScanLocation:[scanner scanLocation]+1];
} ;

// scanner only dealt with the string until the last comma, probably one more value to handle
if (lastCommaIndex < [scanner scanLocation]){
    [array addObject: [scanner.string substringWithRange:NSMakeRange(lastCommaIndex+1, [scanner scanLocation]- lastCommaIndex-1)]];
}

// array contains seperated strings, but with blanks and apostrophes
// we will deal with them now
__block NSMutableArray *resultArray = [NSMutableArray array];
[array enumerateObjectsUsingBlock:^(NSString *obj, NSUInteger idx, BOOL *stop) {
    obj = [[obj stringByTrimmingCharactersInSet:[NSCharacterSet whitespaceCharacterSet]]
                stringByTrimmingCharactersInSet:charSet];
    if ([obj length] > 0)
        [resultArray addObject:obj];
    else
        [resultArray addObject:@"emptySlotInfo"];
}]; 
```

结果数组包含

```
(
12,
22,
stringA,
emptySlotInfo,
stringB, stringC,
2,
stringD
) 
```

# java - Java 中的 URLDecoder 在“圣保罗”上窒息

> ID：12903168
> 
> 赞同：1
> 
> 时间：2012-10-15T20:06:15.603
> 
> 标签：java, url, encoding

我正在使用 Java`URLDecoder`类来分析一些 url，我遇到了一个问题。我不确定这是错误还是预期的行为，所以在这里。

考虑这个 URL： [https://id2.s.nfl.com/fans/mobile/login?gigyresp=true&city=](https://id2.s.nfl.com/fans/mobile/login?gigyresp=true&city=) **S%u00e3o+Paulo%2c+Brazil** &profileURL=...

`URLDecoder`在“São Paulo”部分窒息，尤其是“ã”，它似乎被编码为“%u0”。几乎其他任何事情似乎都可以很好地处理，但是这个特别的没有。

我正在使用以下内容：

```
URLDecoder.decode(url, "UTF-8"); 
```

我的堆栈跟踪是：

```
Caused by: java.lang.IllegalArgumentException: URLDecoder: Illegal hex characters in escape (%) pattern - For input string: "u0"
    at java.net.URLDecoder.decode(URLDecoder.java:173) 
```

有什么想法可以让我`URLDecoder`正确解析吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:29:41.337

URL enoding 是用 octets 完成的`%AB`。您的编码似乎是 java 字符串编码`\u00e3`和 URL 编码之类的混合`%xxxx`，这是无效的。

如果您将字符串更改为`"S\u00e3o Paulo, Brazil"`并使用 对其进行编码`URLEncoder.encode(url, "UTF-8")`，您将得到`S%C3%A3o+Paulo%2c+Brazil`，这是完全可解码的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T20:15:05.100

这似乎是 Microsoft 非标准编码。这是一个非法的 URL，每个人都应该拒绝它。

您需要自己解码：`%u####`是 unicode`####`

# java - 在这种情况下调用哪个 .toString ？

> ID：12903169
> 
> 赞同：1
> 
> 时间：2012-10-15T20:06:16.190
> 
> 标签：java

```
Object aThing = new Integer(25);
aThing.toString(); 
```

是`toString`的`Object`还是`toString`的`Integer`？（我认为`Integer`是。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T20:08:34.510

`Integer`类`toString()`将被调用。方法调用将始终基于对象类型而不是引用类型来决定。

正如 Steve Kuo 所说：静态方法除外。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T20:08:09.913

子类上的那个被调用，所以`Integer`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-15T20:08:25.500

的`toString()`,`Integer`是被调用的那个。您可以使用自己的对象轻松证明这一点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-15T20:08:59.540

`toString()`在整数类中执行，因为它是实例化类的类型。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-15T20:13:47.110

`Integer's` `toString`叫做。调用哪个方法实现总是由对象本身的运行时类型（类）决定，而不是由分配给它的变量的类型决定。在下面的代码中，两个调用是等效的。

```
Integer i = Integer.valueOf(5);
Object o = i;

i.toString(); // "5"
o.toString(); // "5" 
```

以这种方式运行的方法称为[虚拟方法](http://en.wikipedia.org/wiki/Virtual_method)。Java 中的所有非静态方法都是虚拟的。[它们提供了多态性](http://en.wikipedia.org/wiki/Polymorphism_in_object-oriented_programming)的关键机制之一。

# c#-4.0 - 未指定报告定义的来源

> ID：12903170
> 
> 赞同：2
> 
> 时间：2012-10-15T20:06:21.823
> 
> 标签：c#-4.0, report, microsoft-reporting

我正在使用以下代码来尝试 SetParametr ：

```
 var report = new ReportParameter[1];
    report[0] = new ReportParameter("MyName", "Raha");
    var reportDataSource1 = new ReportDataSource { Name = "WpfApplication17_User", Value = _users };

    _reportViewer.LocalReport.DataSources.Add(reportDataSource1);
    _reportViewer.ServerReport.SetParameters(report);
    _reportViewer.LocalReport.ReportPath = "../../Report1.rdlc";

    _reportViewer.RefreshReport(); 
```

错误：未指定报告定义的来源

为什么是错的？

我创建了一个报告参数，参数名称是“MyName”

更新 ：

我正在使用以下代码：

```
 //var report = new ReportParameter[1];
    //report[0] = new ReportParameter("MyName", "Raha");

    var reportDataSource1 = new ReportDataSource { Name = "WpfApplication17_User", Value = _users };

    string exeFolder = System.IO.Path.GetDirectoryName(Process.GetCurrentProcess().MainModule.FileName);

    _reportViewer.LocalReport.ReportPath =exeFolder + @"\Reports\Report1.rdlc";

    _reportViewer.LocalReport.DataSources.Add(reportDataSource1);

    //_reportViewer.ServerReport.SetParameters(report);

    _reportViewer.RefreshReport(); 
```

数据已显示在报告中。

但是，我正在使用以下代码：

```
 var report = new ReportParameter[1];
            report[0] = new ReportParameter("MyName", "Raha");

            var reportDataSource1 = new ReportDataSource { Name = "WpfApplication17_User", Value = _users };

            string exeFolder = System.IO.Path.GetDirectoryName(Process.GetCurrentProcess().MainModule.FileName);

            _reportViewer.LocalReport.ReportPath = exeFolder + @"\Reports\Report1.rdlc";

            _reportViewer.LocalReport.DataSources.Add(reportDataSource1);

            _reportViewer.ServerReport.SetParameters(report);//error

            _reportViewer.RefreshReport(); 
```

错误为：尚未指定报告定义的来源

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2016-09-15T17:16:05.943

Put ReportParameter after the

```
_reportViewer.LocalReport.ReportPath = "../../Report1.rdlc"; 
```

here you write your ReportParameter

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-07-27T19:28:03.607

我发现自己遇到了同样的错误，原因其实很简单：必须首先设置报告定义，*在*参数之前。这样，`LocalReport`可以检查它们是否真的是强制性的并最终抛出异常。

下面的代码应该可以工作：

```
_reportViewer.LocalReport.DataSources.Add(reportDataSource1);
_reportViewer.LocalReport.ReportPath = "../../Report1.rdlc";
_reportViewer.ServerReport.SetParameters(report); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-15T20:14:45.070

该错误与您的参数无关。该错误与`ReportPath`. 请参阅有关设置报告路径的[其他 SO 问题。](https://stackoverflow.com/q/2702088/416574)当您的应用程序运行时，您确定您指定的相对路径是正确的。该路径是否与您的源代码相关？如果您想查看它在哪里寻找文件，那么您可以添加一些代码来解析该相对路径（[Path.GetFullPath](http://msdn.microsoft.com/en-us/library/system.io.path.getfullpath.aspx)）并查看它指向的位置。确保您的`rdlc`文件位于该文件夹中。

**编辑：**
根据您更新的问题并验证是否确实找到了报告。我更详细地查看了您的代码。您正在为 设置参数`ServerReport`，但您正在将报告加载到`LocalReport`. 尝试设置中的参数`LocalReport`。

```
_reportViewer.LocalReport.SetParameters(report); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-06-28T22:19:33.153

你应该改变：

```
_reportViewer.ServerReport.SetParameters(report); //error 
```

至：

```
_reportViewer.LocalReport.SetParameters(report); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-08-17T20:24:44.593

我今天遇到了同样的问题，就我而言，原因是“复制粘贴”问题。只需在下面的代码中将 ServerReport 替换为 LocalReport 即可解决问题。改变

```
_reportViewer.LocalReport.DataSources.Add(reportDataSource1); 
```

至

```
_reportViewer.ServerReport.SetParameters(report); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-03-13T04:58:02.880

您的报表可能是嵌入式资源，因此当您尝试使用`_reportViewer.ServerReport.SetParameters(report);//error`报表定义设置参数时尚未加载。

因此，如果您的报告是嵌入式资源，那么您需要`report.LoadReportDefinition(stream); // Get report definition`在设置报告参数之前调用。

即：下面从 LocalReport 返回一个 PDF 字节数组

```
public byte[] ProcessReportToPDFBytes(List<ReportDataSource> rds, Stream stream, string fileName, string outputType, SqlParameter[] rptParameters)
    {
      // Variables 
      Warning[] warnings;
      string[] streamIds;
      string mimeType = string.Empty;
      string encoding = string.Empty;
      string extension = string.Empty;

    using (LocalReport report = new LocalReport())
    {
            // Setup the report viewer object and get the array of bytes 
            report.EnableHyperlinks = true;
            report.EnableExternalImages = true;
            report.SetBasePermissionsForSandboxAppDomain(new System.Security.PermissionSet(System.Security.Permissions.PermissionState.Unrestricted));

            report.LoadReportDefinition(stream); // Get report definition
            // **** Set the Report Parameters AFTER the LoadReportDefinition ****
            if (rptParameters != null)
            {
              foreach (SqlParameter param in rptParameters)
              {
                report.SetParameters(new ReportParameter(param.ParameterName, param.Value == null ? "" : param.Value.ToString(), false));
              }
            }
            foreach (ReportDataSource rds1 in rds)
            {
              report.DataSources.Add(rds1); // Add datasource here 
            }

            // Render the PDF from the local report
            return report.Render("PDF", null, out mimeType, out encoding, out extension, out streamIds, out warnings);
    }
} 
```

希望这可以帮助其他人解决类似的错误。

# matlab - matlab曲面图 - 标签颜色条并更改轴值

> ID：12903173
> 
> 赞同：1
> 
> 时间：2012-10-15T20:06:27.893
> 
> 标签：matlab, graph, label, geometry-surface

我正在尝试使用颜色条在 matlab 中绘制 3D 曲面图。

我想知道如何

1.  标记颜色条的标题

2.  更改轴刻度标签

我的代码的重要部分是

```
number_panels = 1:100:500;
number_turbines = 0;
number_batteries = 0:300:1700;

for idx_number_panels = 1:length(number_panels) 

for idx_number_turbines = 1:length(number_turbines) 

    for idx_number_batteries = 1:length(number_batteries) 

        for h=2:3 %# hours

A = squeeze(total_annual_cost)
B = squeeze(total_renewables_penetration)

figure;
surface(A,B) 
```

![在此处输入图像描述](../Images/9ae10da2a49acca5770200b7ac65a52d.png) 我正在尝试将 x 和 y 轴刻度从 for 循环的间隔更改为代表每个间隔的实际数字。

我似乎在文档中找不到上述任何内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T21:11:22.877

以下代码显示如何更改 Xticks、Yticks 以及如何将标签添加到颜色条的值：

```
clear all
close all
clc

h = surface(peaks)
colorbar('YTickLabel',...           % set labels to the colorbar
    {'Freezing','Cold','Cool','Neutral',...
     'Warm','Hot','Burning','Nuclear'})
view(-35,45)

number_panels = 0:5:50;
number_batteries = 0:15:50;

set(gca,'XTick',number_panels)      % set Xticks
set(gca,'YTick',number_batteries )  % set Yticks
grid on 
```

![在此处输入图像描述](../Images/03489a55a5719bd9d39e0ee6539954a0.png)

使用此代码，您可以更改第一个 YTickLabel 以设置颜色栏标题（嗯，类似的东西）：

```
clear all
close all
clc

number_panels = 0:5:50;
number_batteries = 0:15:50;

h = surface(peaks);
chandle = colorbar;

current_colorbar_labels = get(chandle,'YTickLabel');
current_zticks = get(chandle,'YTick');
aux = cellstr(current_colorbar_labels);
aux{end} = 'Title';
set(chandle,'YTickLabel',aux);
view(-35,45)

set(gca,'XTick',number_panels)      % set Xticks
set(gca,'YTick',number_batteries )  % set Yticks
set(gca,'ZTick',current_zticks )  % set Yticks
grid on 
```

![在此处输入图像描述](../Images/4585a1526fcf115d2000db51ad764495.png)

我的颜色条命令代码基于： http: [//www.mathworks.es/es/help/matlab/ref/colorbar.html](http://www.mathworks.es/es/help/matlab/ref/colorbar.html)

希望这会有所帮助，我会尝试将标题添加到颜色栏...

# html - 使用响应式图像创建响应式网格、堆栈

> ID：12903176
> 
> 赞同：0
> 
> 时间：2012-10-15T20:06:50.357
> 
> 标签：html, css, responsive-design

我之前创建了一个关于制作响应式网格的问题，并且由于这里每个人的帮助而使其正常工作，但现在我正在为下一阶段而苦苦挣扎。

我想要一个包含三列（三幅图像）的网格，每列的宽度为 33.3%。然后我在里面有一个图像`max-width:100%`，以使它们缩放到容器的宽度。

现在我坚持让它们以平均移动分辨率堆叠。所以本质上，当它们变得太小而不能轻易地被视为连续三个时，我希望它们连续下降到 2 个（制作 3 行总共 6 个图像），然后在长堆栈中下降到每行只有一个。

JS小提琴[在这里](http://jsfiddle.net/abrdn/15/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:25:47.820

在继续之前，您可能需要学习[如何使用媒体查询](http://webdesignerwall.com/tutorials/css3-media-queries)和[响应式设计。](http://www.alistapart.com/articles/responsive-web-design/)

在您的特定情况下，您可以执行类似[**此演示**](http://jsfiddle.net/gionaf/cJB8C/)的操作（缩小窗口以查看它的运行情况）：

```
.product{
    width:50%; /* initially, each row contains 2 products */
    float: left;
    /* no need for display:block; */
}

@media screen and (min-width:450px) { /* <--- this is a media query */

    /*
        everything inside this media query will be processed
        only if the viewport is larger then 450px
    */

    .product{
        width:33.3%; /* larger screens will diplay 3 products per row */
        /* float is already declared */
    }

} 
```

显然，这只是一个例子。`.product`你知道每个元素里面会有什么。只需掌握媒体查询，您就可以进行任何变化。

例如，如果您希望在小屏幕上的每条产品线只有一个产品，您可以执行以下操作：

```
.product{
    /* nothing here! 1 product per row */
}

@media only screen and (min-width:450px) and (max-width:1023px) {
    .product{
        width:50%; /* 2 products per row */
        float:left;
    }
}

@media screen and (min-width:1024px) {
    .product{
        width:33.3%; /* 3 products per row */
        float:left;
    }
} 
```

...等等。这可以通过多种不同的方式完成，这取决于您的项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T20:12:28.757

你在找[这样](http://jsfiddle.net/abrdn/18/)的东西吗？这里的诀窍是在产品 div 上设置绝对最小宽度，它与 float 属性相结合可以为您提供所需的结果。

```
#content{
  width:90%;
  margin-top: 60px;
  margin-left:5%;
  margin-right:5%;
}

.product{
    width:33.3%;
    min-width:100px;
    display:block;
    float: left;
}

.product img{
max-width:100%;
}

body{
    background-color:#666;
} 
```

# c# - 使用 SQL Server Reporting Services 的 ReportViewer 控件，我可以在 C# 中以编程方式更改子报表吗？

> ID：12903179
> 
> 赞同：0
> 
> 时间：2012-10-15T20:07:14.383
> 
> 标签：c#, .net, reporting-services, .net-3.5, ssrs-2008

目前，我们有一个包含多个可以使用的子报告的报告。到目前为止，每次我们想要打印不同的东西时，我们一直在手动更改子报表。但是，我正在尝试使用 ReportViewer 控件构建一个 C# Winforms 应用程序，该控件可以动态更改子报表。这有可能吗？这适用于 SQL Server Reporting Services 2008 和 .NET 3.5 Framework（如果有帮助的话）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T20:27:40.250

[这里](http://www.gotreportviewer.com/subreports/index.html)有教程（http://www.gotreportviewer.com/subreports/index.html）试试看。

# jquery - 在窗口调整大小时使等高函数可调整大小

> ID：12903181
> 
> 赞同：4
> 
> 时间：2012-10-15T20:07:17.670
> 
> 标签：jquery, window-resize

不久前，我们创建了一个非常基本的等高函数，效果很好。但是，我们的任务是在调整窗口大小时调整列高。它被实施为响应式、流畅的设计。但是当权者不理解典型的响应式用例并没有将您的浏览器拖到所有地方以接受特定的断点。

无论如何，在这里的 jsfiddle 中设置了标记和 js。[http://jsfiddle.net/J6uaH/3/](http://jsfiddle.net/J6uaH/3/)

只是不能完全围绕将窗口调整大小元素添加到高度上。任何人可以提供的任何帮助都将不胜感激，如果有这样的事情，任何人都会给超级英雄加分！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-15T20:25:56.557

为什么不向重新计算元素高度的窗口的 resize 事件添加一个事件侦听器？

但是，由于您已经为元素设置了固定高度，因此您需要重置两个元素的高度以获得新的最大尺寸。

尝试添加：

```
$(window).resize(function(){
    $('.group .module').css('height','auto');
    $('.group .module').equalHeight();
}); 
```

在火狐工作。这基本上对窗口的每次调整大小都有作用：

1.  重置元素的高度，这意味着浏览器将根据其内容计算它
2.  再次执行您的函数以使两个元素的高度相等

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-15T20:45:43.567

就个人而言，我完全不用 JavaScript 就可以解决这个问题。如果你愿意多加一点 HTML，只用 CSS 就可以达到想要的视觉效果。

这是一个 JSFiddle：http: [//jsfiddle.net/Z59eT/2/](http://jsfiddle.net/Z59eT/2/)

基本策略：

1.  `clear:both`在模块的末尾添加一个元素`group`--- 这允许组的高度等于两个模块中的较大者。
2.  给组和模块 div`position:relative`以便他们参与定位。
3.  在每个模块之前添加特殊的背景元素——这些元素将垂直增长以匹配组的大小，实现所需的列颜色。

我确信还有其他纯 CSS 方法可以解决这个问题。这只是第一个想到的。您的实际需求可能需要更多细微差别的东西。

只要有可能，最好让浏览器完成这项工作。在这种情况下，与其计算高度，不如让浏览器处理它，因为浏览器的原生功能将比解释的 JS 代码快几个数量级。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-30T21:45:01.713

我只需要自己做这件事。我过去使用过 setEqualHeight 函数，但是当有人疯狂地调整窗口大小时，我被“要求”让它工作。

room13 的修复是关键。否则它只使用旧的设定高度。您显然也在 DOM 就绪时调用了相同的函数。我确实为窗口调整大小添加了一个延迟函数，所以你只在完成时调用它，而不是经常调用它。

jQuery：

```
function setEqualHeight(columns) {
    var tallestcolumn = 0;
    columns.each(
    function() {
        currentHeight = $(this).height();
        if(currentHeight > tallestcolumn) {
            tallestcolumn  = currentHeight;
            }
        }
    );
 columns.height(tallestcolumn);
}

var delay = (function(){
        var timer = 0;
        return function(callback, ms){
            clearTimeout (timer);
            timer = setTimeout(callback, ms);
    };
})();

$(window).resize(function() {
    delay(function(){
        $('.yourSelector').css('height','auto'); //solve for all you browser stretchers out there!
        setEqualHeight($('.yourSelector'));
    }, 500);
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-15T20:22:50.167

问题是您获得了更大的高度，然后将其应用于盒子。但是，当您再次比较时，您正在再次比较原始框，但是它是段落高度发生了变化。

```
$.fn.equalHeight = function() {
    var maxHeight = 0;
    return this.each(function(index, box) {
        var boxHeight = $(box).height();
        maxHeight = Math.max(maxHeight, boxHeight);
    }).parent().height(maxHeight);
};

$(document).ready(function() {
    $('.group .module p').equalHeight();

    $(window).resize(function () {
        $('.group .module p').equalHeight();
    });

}); 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-10-15T20:49:00.783

值得注意的是，这正是表的作用。示例：http: [//jsfiddle.net/Z59eT/3/](http://jsfiddle.net/Z59eT/3/)

具有一行和两个 50% 列的表格将完全按照您的规范要求增长。

# php - 苹果推送通知到多个设备

> ID：12903184
> 
> 赞同：0
> 
> 时间：2012-10-15T20:07:22.650
> 
> 标签：php, apple-push-notifications

有没有人想出将消息推送到多个设备的正确方法。我们正在开发一个有追随者的应用程序，比如 Facebook 或 Twitter，我需要向一个追随者（总共 600 个）发送消息。

在 PHP 中，我刚刚做了一个测试，每条消息大约需要 20 秒才能得到回复

```
$fp = stream_socket_client('ssl://gateway.push.apple.com:2195', $err,
$errstr, 60, STREAM_CLIENT_CONNECT, $ctx); 
```

和

```
// Send it to the server 
$result = fwrite($fp, $msg, strlen($msg)); 
```

这会导致发送 600 条消息需要 3 个小时？

对于每条消息，我都在执行相同的代码行。我应该改为打开流并发出多次写入然后 fpclose 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T20:10:52.537

```
foreach($msgs as $msg) {
  $result = fwrite($fp, $msg, strlen($msg));
} 
```

# oracle - 有没有办法配置 Elastic Beanstalk 以连接到现有的 Oracle 数据库（没有 BYOL）？

> ID：12903185
> 
> 赞同：8
> 
> 时间：2012-10-15T20:07:29.597
> 
> 标签：oracle, amazon-web-services, amazon-elastic-beanstalk

我正在尝试设置 Elastic Beanstalk 以连接到我现有的 AWS 托管的 Oracle DB（按需类型，而不是自带许可类型），但是当我使用 Elastic Beanstalk 控制台 >> 环境详细信息 > > 编辑配置 >> 数据库实用程序，我什至没有提供连接到**现有**AWS RDS 的选项。他们提供的唯一选项是“使用此环境**创建**RDS 数据库实例”。好吧，我很灵活......给猫剥皮的方法不止一种，但是当我尝试创建一个 RDS DB (Oracle) 实例（使用他们的下拉“Oracle se-1”选项）时，我得到了错误消息“Oracle 数据库引擎不支持数据库实例类。”

有解决方法吗？我只想让我的 beanstalk 访问我现有的 Oracle RDS，并感谢任何人提供的任何建议。请慢慢解释……这对我来说是一个新的环境。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-21T14:03:00.417

以下是 AWS 技术支持提供的非常有用的答案：

你好，

在典型场景中，由 ElasticBeanstalk 启动的实例将只允许来自 Elastic Load Balancer 的 HTTP 连接，而 Elastic Load Balancer 将接受来自任何地方 ( 0.0.0.0/0 ) 的 HTTP 请求。

让 Elastic Beanstalk 实例访问您的 RDS 实例的最有效方法是在 RDS 授权中添加 beanstalk 实例的安全组。

检查 Ec2->Security Groups，您应该有一个描述为“SecurityGroup for ElasticBeanstalk environment”的安全组。，查看底部窗格中的安全组 ID，其格式为 sg-xxxxxxxx 。

通过转到 RDS -> Db Security Groups 授权 RDS 访问该安全性，您可以编辑 Db 当前安全组或创建一个新安全组（然后您需要将其应用于 Db 实例），在底部窗格中选择 Ec2安全组而不是 CIDR，并添加 Elastic Beanstalk 安全组 ID sg-xxxxxxxx。

如果您想直接从本地计算机中的 Eclipse 访问 Db，您还需要将您的计算机公共 IP 添加为 CIDR（您可以通过访问 www.whatismyip.com 之类的页面来检查您的公共 IP）

您还需要 Eclipse 中的 JDBC 驱动程序才能连接到 RDS Oracle 实例。

我还附上了 Elastic Beanstalk 的打印屏幕，其中显示了您可以将 JDBC 连接传递到您的环境的位置。

![快照](../Images/bcae871e5a39d0f34e1a1b5f851c442b.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T21:22:16.390

不，没有 BYOL 许可类型，就无法连接到现有的 Oracle 数据库。BYOL 意味着您已经拥有一个有效的 Oracle 许可证并且希望使用它。如果您使用 On-Demand，则意味着 Amazon 为您提供了包含在价格中的有效许可证，因此您必须创建一个新的 Oracle 数据库实例，这就是您在 Elastic beanstalk 中看到的。

Oracle 引擎选择和许可证类型选择是在设置 Amazon RDS 时完成的（如下面的屏幕截图）。更多信息[在这里](http://docs.amazonwebservices.com/AmazonRDS/latest/GettingStartedGuide/LaunchDBInstance.Oracle.html)。

![在此处输入图像描述](../Images/7b52d70d63e9cca2def8aa2012856249.png)

# c++ - 将标量乘以 boost.units.quantity（自动类型转换问题？）

> ID：12903186
> 
> 赞同：3
> 
> 时间：2012-10-15T20:07:45.657
> 
> 标签：c++, boost, boost-units

这是一个非常简约的例子。我以下列方式使用**Boost.Units ：**

```
#define REAL double
...
using namespace boost::units;
quantity<si::velocity, REAL> v; 
```

然后有时我需要有类似的东西

```
quantity<si::velocity, REAL> v_halved;
v_halved = 0.5 * v; 
```

`0.5`这可以正常工作，因为编译器将`double`. 但是，当`REAL`有什么不同时，我会得到一个编译错误，例如，如果我将定义更改为`REAL`编译`long double`抱怨：

```
error: no match for ‘operator*’ in ‘5.0e-1 * v’
/usr/include/boost/units/detail/one.hpp:58: note: candidates are: boost::units::one boost::units::operator*(const boost::units::one&, const boost::units::one&) 
```

查看**Boost.Units** [文档](http://www.boost.org/doc/libs/1_37_0/doc/html/boost_units/Reference.html#header.boost.units.quantity_hpp)，我发现它的`operator*`重载如下：

```
// runtime scalar times quantity 
template<typename Unit, typename X> 
  multiply_typeof_helper< X, quantity< Unit, X > >::type 
  operator*(const X & lhs, const quantity< Unit, X > & rhs); 
```

尽管从定义中可以清楚地看出数量的标量和内部类型必须相同，但我希望编译器在可以隐式进行转换时自动转换类型（例如 from `double`to `long double`）。但是我认为我可能会遗漏一些东西，因为自动类型转换当然适用于其他简单的函数，比如`long double f(long double const & ld)`.

我的问题是我已经使用`v_halved = 0.5 * v`了很多类似的表达式，我的项目已经变得相当大，而且直到现在，在必须定义之后`REAL`我`long double`才意识到这是一个问题。所以，我想知道一个解决方法/解决方案，我知道这`static_cast<REAL>(0.5)`将是一个解决方案，但我仍然觉得我错过了一些关于编译器无法自动将标量转换为正确类型的东西。

提前非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T20:25:48.953

模板函数与非模板函数不同。编译器决定选择模板函数而不考虑隐式转换/提升。它只是寻找精确匹配。

这就是 C++ 在该领域的工作方式。

要获得精确匹配，您需要这样`operator *`的定义（注意这个额外的模板参数 Y）：

```
template<typename Unit, typename X, typename Y> 
  typename multiply_typeof_helper< X, quantity< Unit, X > >::type 
  inline operator*(const Y & lhs, const quantity< Unit, X > & rhs)
{
    return static_cast<X>(lhs) * rhs;
} 
```

但我担心这会干扰`*`. 你可以玩这个——比如定义你自己的`quantity`，它几乎完全来自于 boost——但是以不同的方式定义乘法，这是我提出的。

只需决定什么对您来说更容易使用

*   做静态转换（或者最好只是添加`L`-`0.5L`使 long double 常量）
*   或与模板进行一些组合。

# nsis - 如何开始使用 NSIS 安装程序

> ID：12903187
> 
> 赞同：0
> 
> 时间：2012-10-15T20:07:48.157
> 
> 标签：nsis

嗨，我需要 NSIS 安装程序来为软件打补丁。从哪里开始。我在 Windows 7 上运行。我在哪里可以获得 NSIS 安装程序以及如何开始运行它。谁能告诉我在哪里可以找到相关材料。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T20:15:22.347

为什么不开始查看NSIS的[官方页面，在那里您可以找到更多常见任务的](http://nsis.sourceforge.net/Main_Page)[教程](http://nsis.sourceforge.net/Category%3aTutorials)和[示例](http://nsis.sourceforge.net/Category%3aCode_Examples)。

此外，由于您对补丁感兴趣，请查看[此实用程序](http://sourceforge.net/projects/nsispatchgen/)- 它提供了自动比较两个目录树的功能，这是 NSIS 所缺乏的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-15T14:32:06.110

以下是一些您可以参考的有用链接：

一[、简介](http://nsis.sourceforge.net/Docs/Chapter1.html#)

2.[教程](http://www.pcauthority.com.au/Feature/24263,tutorial-create-a-nsis-install-script.aspx)

3.[简单的项目](http://nsis.sourceforge.net/Simple_tutorials)。

4.[示例脚本](http://www.codeproject.com/Articles/24187/Creating-an-Installer)

# c# - 调试 Windows 8 的 XAML 解析错误的过程

> ID：12903193
> 
> 赞同：4
> 
> 时间：2012-10-15T20:08:11.460
> 
> 标签：c#, xaml, windows-8, microsoft-metro

我正在寻找调试 XAML 错误的一般做法/方法。通常 C# 错误很容易查找并且足够具体以查找相关信息。但是，XAML 似乎只是抛出一个通用`XAML Parsing failed`错误：

![在此处输入图像描述](../Images/df97f954582003e1c17e8949302d529d.png)

我正在寻找一种通用的方法来处理这些错误并缩小可能对抛出的错误有用的文件、行号或任何其他信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-20T18:59:02.230

这是我用来在不清楚时识别导致 XAML 错误的文件的一种简洁方法......

**用资源字典一一打开所有 XAML 文件，在打开的根元素后添加一个空格。再次在调试器中运行，直到出现故障点，当行号增加一时，您已找到该文件。**

没有人可以为这种行为辩护。我只能想象框架资源加载方法是用流调用的，所以不知道它正在读取的文件的名称是什么，只是其中的位置。

它需要改进。调用资源加载方法的框架部分应该发出调试消息或在某种上下文中传递名称，以便框架的较低部分可以发出合理的错误消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T21:00:30.910

*Note: I plan on expanding this as I move along and learn more. If you would like to contribute to this answer, I will change this to CW and in the mean time feel free to make any changes you seem fit*

# Smaller changes == Smaller scoped errors

In general, just as @DenDelimarsky has stated, making small changes and running/debugging the code is a good start. That will, most of the time, narrow down the scope of the error to just the areas that you've been working in.

However here are a few other tips that you can use to narrow down the issues:

# Search for the Class:

Your specific message for exception `e` states this:

> Failed to assign to property 'Windows.UI.XAML.**ResourceDictionary**.Source' (emphasis added)

This means that the class `ResourceDicionary` is having complications assigning the property `Source`. Perform a search first within the scope of the files you've edited and then, if no errors are found, within the entire solution for this class and look for any errors that may be present.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T20:16:23.137

实际上，您所看到的是处理 XAML 错误的正常方法。不仅如此，您实际上还看到了 StandardStyles 之外的问题。此外，如果您遵循常规调试实践并在修改 XAML 后经常进行调试，通常很容易缩小问题范围。

# directory - jstree：无法获取叶节点的包含文件夹

> ID：12903195
> 
> 赞同：1
> 
> 时间：2012-10-15T20:08:24.330
> 
> 标签：directory, parent, jstree

这几天我一直在为这个问题苦苦挣扎……

我需要获取要删除的文件夹（rel='folder' id 的节点包含叶节点（rel='default' 的节点）。

我的服务器端根据类型从数据库中删除节点。对于文件夹，不是问题，对于叶子，我需要容器文件夹的 id 才能删除其中的叶子。

我尝试了各种场景，它们都是灾难性的，返回 undef 或 -1。

即使是最流行的方式：

```
(data.inst._get_parent(data.rslt.obj)==-1?'root_node':data.inst._get_parent(data.rslt.obj).attr('id')); 
```

对于我试图从树中的任何位置删除的所有叶节点，总是返回-1。

这里还有一些代码：

```
.bind("remove.jstree", function (e, data) {
    data.rslt.obj.each(function () {
         var node = data.rslt.obj;

         console.log('rel:'+node.parent("li[rel='folder']").attr("id")); // always undef
         var node2=$("#demo").jstree("_get_parent", data.rslt.obj.attr("id"));
         console.log("another try:"+node2.attr("id"));  always undef
         var node_parent=(data.inst._get_parent(data.rslt.obj)==-1?'root_node':data.inst._get_parent(data.rslt.obj).attr('id'));
         console.log('node_parent for ' + data.rslt.obj.attr("id") + ':'+node_parent);// always -1
         var parents = [];
        $(data.rslt.obj).parents('li').each(function () {
            parents.push({ id: $(this).attr("id"), description: $(this).children("a").text() });
        });
        console.log('nb of parents:'+parent.length); // always 0;
        $.ajax({
            async : false,
            type: 'POST',
            url: "ajaxTree.php",
            data : { 
                "operation" : "remove_node", 
                "id" : this.id.replace("node_",""),
                 "type" : data.rslt.obj.attr("rel"),
                 "parent": node_parent
            }, 
            success : function (r) {
                if(!r.status) {
                    //data.inst.refresh();
                    $.jstree.rollback(data.rlbk);
                }
            }
        });

    });
}) 
```

感谢您留下您认为可行的注释，我会尝试的，答应了：D

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T00:33:43.333

```
You can use "data.inst" - the tree instance 
and "_get_parent" to get the parent: 

data.inst._get_parent(data.rslt.obj); 
```

此信息在[jstree 组中找到](http://groups.google.com/forum/?fromgroups=#!topic/jstree/wHIT4gIdcIY)

# php - PHP 将文件映射到虚拟内存

> ID：12903200
> 
> 赞同：0
> 
> 时间：2012-10-15T20:08:36.817
> 
> 标签：php, file, memory-management, handle, virtual-memory

我正在使用 PHP 来处理一些大文件（大约 500MB 到 2 GB），我需要将这些文件写入文件中不可预测位置的小部分。有没有办法将文件映射到虚拟内存，这样我就不必打电话了`fwrite()`？`fread()`主要的警告是它将读取小块，但将访问大量数据，全部在一个文件中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:21:12.050

KingCrunch 把它钉在了头上.. `fwrite`，真的是要走的路`fread`..`fseek`

我能想到您可能不想使用它们的唯一原因，也许是它们在 PHP 中更难使用？

如果是这种情况，为什么不创建一个在内部调用这些方法的简单包装类。

**根据评论编辑**

使用虚拟内存，我理解了 windows 术语，即映射到文件系统的内存。如果您担心性能，并且可以将*整个文件*放入内存中，那么我现在可以考虑两种方法：

1.  创建一个 tmpfs 挂载，并将文件放在那里。
2.  使用`php://memory`流，并用`stream_copy_to_stream`.

你也可以只做一个 file_get_contents，它也为你提供了内存中的整个流，但我绝对可以想象 tmpfs 和 php://memory 都会给你更好的性能和内存效率。我个人会选择 tmpfs 挂载。

# sql - 使用批量收集填充特定列

> ID：12903202
> 
> 赞同：0
> 
> 时间：2012-10-15T20:09:02.607
> 
> 标签：sql, oracle, plsql

网上的大部分例子都是关于`select * bulk collect ...`

我有一个授予同义词的脚本，从游标中获取数据需要很长时间，所以我打算使用批量收集。原始游标和提取：

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:48:33.397

首先应该是字符串的集合，`vUser`而`vObjectName`不是游标上的行类型。或者像`vRow`这样的单个变量是游标的行类型，然后访问行的成员`vRow(indx).grantee`。

如果您不打算`limit`在 the 上使用子句，`fetch bulk into`那么您只需要一个循环，就在集合上，因为所有内容都会立即被抓取。

# assembly - 在汇编中将数字转换为 ASCII

> ID：12903204
> 
> 赞同：1
> 
> 时间：2012-10-15T20:09:09.897
> 
> 标签：assembly, binary, hex, ascii, bit-manipulation

有人可以解释为什么对以 0x0030 作为操作数的二进制数进行 OR 运算会产生该数字的 ASCII 字符吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-15T20:13:33.397

因为查看 ASCII 图表，数字 0 到 9 从 0x30 开始。所以你想要字符 1 的 ASCII 值吗？0x30 或 0x01 = 0x31 = 数字 1 的 ASCII 值。

```
In binary it's easy to see:

(0x30)   110000
or
(0x01)   000001
=        110001

Which is 0x31 - ASCII value of 1. 
```

![在此处输入图像描述](../Images/3b9ab97587bbfe5624ea0b6d38594de7.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-15T20:13:47.457

如果您指的是数字 0 到 9，原因是`0x30`（或 48）是数字 0 的 ASCII 码。由于 48 只需要字节的高位（左侧）位，因此将其与任何数字进行或运算低于 16（低位）与数学上添加数字相同。

所以 0x30 OR 0x01 将给出 0x31，即字符 '1' 的 ASCII 码，依此类推。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-15T20:14:00.300

查看单个数字的二进制表示：例如 2d = 00000010b。对其应用 0x30 (00110000b) 的 OR 操作。这导致 00110010b 是 0x32 或 50d，这是 '2' 的 ASCII 码。实际上，在这种情况下（因为没有要考虑的进位）OR 操作等于添加 0x30。

# ajax - MVC3：如何将具有不同 ID 的视图表单 HTML UI 链接到一个控制器/模型

> ID：12903208
> 
> 赞同：0
> 
> 时间：2012-10-15T20:09:23.320
> 
> 标签：ajax, asp.net-mvc-3, razor, submit

起初 - 对不起我的英语不好。可能这是个愚蠢的问题，但是....所以，我有一个模型

```
public class AAAModel {
  public int I1 {get; set}
  public string S1 ...
  public Guid G1 ...
} 
```

我有一个控制器

```
public ActionResult Create(AAAModel WhatToCreate){
  ...
} 
```

而且我有一个正确的视图来输入数据......一切都很好，但现在我必须重新组织视图以创建多个表单并让用户能够动态创建新对象（模型）并将查询发送到服务器。我从服务器获得的数据来自 Ajax 查询并解析到表格网格......用户可以查看这些数据，更正它并可以将其发回。所以，我制作了几个表单，我从初始视图中复制并更改了控件的 ID 和名称最初就像

```
@Html.TextBoxFor(model => model.I1)
@Html.TextBoxFor(model => model.S1)
@Html.TextBoxFor(model => model.G1) 
```

现在它变成了

```
<input id="I1_1" name="I1_1 ...>
<input id="S1_1" name="S1_1 ...>
<input id="G1_1" name="G1_1 ...> 
```

在表格 1 中；

```
<input id="I1_2" name="I1_2 ...>
<input id="S1_2" name="S1_2 ...>
<input id="G1_2" name="G1_2 ...> 
```

在表格 2 中，依此类推......愚蠢的问题，但我怎样才能修改控制器或我必须做些什么来获得这些值？

PS 这些表单将通过 ajax 发送......并且主机页面不会重新加载。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T04:34:01.190

我不知道您是否正确理解了您的问题。并且确定您是否正在这样做并且它不起作用，但为什么不只是在页面上创建多个表单。因此，当用户提交某个表单时，它只会提交该表单中的输入。

```
@using (Html.BeginForm("Method","Controller",FormMethod.Post,new {id="form1"}))
{
  @Html.TextBoxFor(model => model.I1)
  @Html.TextBoxFor(model => model.S1)
  @Html.TextBoxFor(model => model.G1)
  <input type="submit" name="submitButton" id=form1Submit />
}
@using (Html.BeginForm("Method","Controller",FormMethod.Post,new {id="form2"}))
{
  @Html.TextBoxFor(model => model.I1)
  @Html.TextBoxFor(model => model.S1)
  @Html.TextBoxFor(model => model.G1)
  <input type="submit" name="submitButton" id=form2Submit />
}
... 
```

当然，您将动态创建它。如果我只是重复你的问题，我很抱歉

**编辑**

如果您的问题是如何确定提交了哪些数据集，我会在模型中添加一个 id 字段并为您创建的每个新表单更改它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T20:16:21.450

看看这里： http: [//blog.stevensanderson.com/2010/01/28/editing-a-variable-length-list-aspnet-mvc-2-style/](http://blog.stevensanderson.com/2010/01/28/editing-a-variable-length-list-aspnet-mvc-2-style/)和这里：[http://haacked.com/存档/2008/10/23/model-binding-to-a-list.aspx](http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx)

**更新**

您始终可以使用[FormCollection](http://msdn.microsoft.com/en-us/library/system.web.mvc.formcollection(v=vs.108).aspx)来获取传递的模型值。

```
[HttpPost]
public ActionResult MyAction(FormCollection values) 
{
   string I1_2 = values["I1_2"];    
   //do something
} 
```

如果您需要，您可以使用动态对象指定`@model dynamic`，但您不需要，因为视图的默认值是从`WebViewPage<dynamic>`.

如果您需要传递匿名对象，也请看这里 [https://stackoverflow.com/a/5670899/1241400](https://stackoverflow.com/a/5670899/1241400)

# xslt-1.0 - 无关联的分组

> ID：12903210
> 
> 赞同：1
> 
> 时间：2012-10-15T20:09:28.830
> 
> 标签：xslt-1.0

xml:

```
<items>
    <transaction>
        <header>
            <col1>H</col1>
            <col2>XXXX</col2>
            <col3>YYY12345</col3>
            <col4/>
            <col5>YYY12345A1234</col5>
        </header>
    </transaction>
    <item>
        <col1>D</col1>
        <col2>1</col2>
        <col3>5358478</col3>
        <col4>-1.0000</col4>
        <col5>CA</col5>
    </item>
    <item>
        <col1>D</col1>
        <col2>2</col2>
        <col3>9477498</col3>
        <col4>1.0000</col4>
        <col5>CA</col5>
    </item>
    <item>
        <col1>D</col1>
        <col2>2</col2>
        <col3>9477498</col3>
        <col4>1.0000</col4>
        <col5>CA</col5>
    </item>
    <transaction>
        <header>
            <col1>H</col1>
            <col2>XXXX</col2>
            <col3>YYY12345</col3>
            <col4/>
            <col5>YYY12345A1236</col5>
        </header>
    </transaction>
    <item>
        <col1>D</col1>
        <col2>1</col2>
        <col3>1676600</col3>
        <col4>1.0000</col4>
        <col5>CA</col5>
    </item>
    <item>
        <col1>D</col1>
        <col2>2</col2>
        <col3>5602891</col3>
        <col4>1.0000</col4>
        <col5>CA</col5>
    </item>
    <item>
        <col1>D</col1>
        <col2>3</col2>
        <col3>7990401</col3>
        <col4>2.0000</col4>
        <col5>CA</col5>
    </item>
    <item>
        <col1>D</col1>
        <col2>4</col2>
        <col3>6985683</col3>
        <col4>1.0000</col4>
        <col5>CA</col5>
    </item>
    <item>
        <col1>D</col1>
        <col2>5</col2>
        <col3>9477498</col3>
        <col4>-1.0000</col4>
        <col5>CA</col5>
    </item>
    <item>
        <col1>D</col1>
        <col2>5</col2>
        <col3>9477498</col3>
        <col4>-1.0000</col4>
        <col5>CA</col5>
    </item>
</items> 
```

期望的输出：

```
<items>
    <transaction>
        <header>
            <col1>H</col1>
            <col2>XXXX</col2>
            <col3>YYY12345</col3>
            <col4/>
            <col5>YYY12345A1234</col5>
        </header>
        <item>
            <col1>D</col1>
            <col2>1</col2>
            <col3>5358478</col3>
            <col4>-1.0000</col4>
            <col5>CA</col5>
        </item>
        <item>
            <col1>D</col1>
            <col2>2</col2>
            <col3>9477498</col3>
            <col4>1.0000</col4>
            <col5>CA</col5>
        </item>
        <item>
            <col1>D</col1>
            <col2>2</col2>
            <col3>9477498</col3>
            <col4>1.0000</col4>
            <col5>CA</col5>
        </item>
    </transaction>
    <transaction>
        <header>
            <col1>H</col1>
            <col2>XXXX</col2>
            <col3>YYY12345</col3>
            <col4/>
            <col5>YYY12345A1236</col5>
        </header>
        <item>
            <col1>D</col1>
            <col2>1</col2>
            <col3>1676600</col3>
            <col4>1.0000</col4>
            <col5>CA</col5>
        </item>
        <item>
            <col1>D</col1>
            <col2>2</col2>
            <col3>5602891</col3>
            <col4>1.0000</col4>
            <col5>CA</col5>
        </item>
        <item>
            <col1>D</col1>
            <col2>3</col2>
            <col3>7990401</col3>
            <col4>2.0000</col4>
            <col5>CA</col5>
        </item>
        <item>
            <col1>D</col1>
            <col2>4</col2>
            <col3>6985683</col3>
            <col4>1.0000</col4>
            <col5>CA</col5>
        </item>
        <item>
            <col1>D</col1>
            <col2>5</col2>
            <col3>9477498</col3>
            <col4>-1.0000</col4>
            <col5>CA</col5>
        </item>
        <item>
            <col1>D</col1>
            <col2>5</col2>
            <col3>9477498</col3>
            <col4>-1.0000</col4>
            <col5>CA</col5>
        </item>
    </transaction>
</items> 
```

我正在尝试在 xslt 1.0 中做到这一点。我很难弄清楚如何在事务块中移动这些项目元素。

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output omit-xml-declaration="yes" indent="yes"/>
    <xsl:strip-space elements="*"/>
    <xsl:template match="node()|@*">
        <xsl:copy>
            <xsl:apply-templates select="node()|@*"/>
        </xsl:copy>
    </xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T02:10:38.560

在花费几分钟重新格式化您的示例输入和输出并使用 diff 之后，我认为您要做的只是将一个元素的所有兄弟姐妹`transaction`作为新的子元素移动到事务元素中。真的？

将以下模板添加到样式表会生成一个样式表，该样式表会产生所需的输出。

首先，模板*只*`items`为它的事务子级调用 apply-templates （因为它们是唯一的输出应该作为输出元素的子级出现的）：*`items`*

 *```
<xsl:template match="items">
  <items>
    <xsl:apply-templates select="transaction"/>
  </items>
</xsl:template> 
```

在默认模式下，模板`transaction`首先为其子级调用 apply-templates。（这会处理元素。）然后它以特殊模式（这里称为）`header`调用其直接右兄弟（将成为输出`item`中元素的第一个子元素）的 apply-templates 。`transaction``items`

```
<xsl:template match="transaction">
  <transaction>
    <xsl:apply-templates/>
    <xsl:apply-templates 
        mode="items" 
        select="following-sibling::*[1]"/>
  </transaction>
</xsl:template> 
```

该`items`模式专门用于收集给定事务的项目。它利用了这样一个事实，即所有项目都是兄弟姐妹，都被逐字复制到输出中，并且项目序列在`transaction`找到下一个兄弟姐妹时结束。

因此，模式中的模板做`item`了`items`两件事：首先它复制自己，然后将仍然处于`items`模式中的模板应用到它的直接右兄弟。如果那是另一个项目，我们最终将再次评估此模板。然后再次。等等。（如果您有非常多的项目并且 XSLT 优化器很弱，则对堆栈内存的需求可能会攀升。）

```
<xsl:template match="item" mode="items">
  <xsl:copy-of select="."/>
  <xsl:apply-templates 
      mode="items" 
      select="following-sibling::*[1]"/>
</xsl:template> 
```

最终，一个元素的直接右兄弟`item`将成为一个`transaction`元素。此时，我们希望递归停止，因此`items`-mode 模板`transaction`什么也不做。（它不需要处理事务，因为事务的默认模式模板会这样做。）

```
<xsl:template match="transaction" mode="items"/> 
```

右兄弟递归模式值得学习；它使像这样的分组任务变得简单。*

# java - 将数组传递给数组会产生空值，我做错了什么？

> ID：12903211
> 
> 赞同：0
> 
> 时间：2012-10-15T20:09:32.253
> 
> 标签：java

所以我正在尝试编写一些代码，每次通过循环时我基本上都需要将数组扩展一个。是的，我知道数组是固定大小的，而且我每次都需要一个新数组。我也知道，如果我使用列表而不是数组，我不会有任何问题，但是我被迫使用数组。

我的代码是这样的：

```
 public static void getAnimals()
    {
        String animalName[] = new String[1];
        int animalNumber[] = new int[1];
        int lengthOfAnimals;

        animalName[0] = "Null";
        animalNumber[0] = 0;

        while (!animalName[animalName.length - 1].equals("EXTERMINATE"))
        {

            animalName[animalName.length - 1] = JOptionPane.showInputDialog("Name an animal?");
            String numLeft = JOptionPane.showInputDialog("How many are left?");
            animalNumber[animalNumber.length - 1] = Integer.parseInt(numLeft);

            if (animalName[animalName.length - 1].equals("EXTERMINATE"))
            {
                break;
            }

            else
            {

                System.out.println(animalName[animalName.length - 1]);
                animalName = expandName(animalName);
                animalNumber = expandNumber(animalNumber);

            }               
        }

    }

    public static String[] expandName(String animalName[])
    {

        String animalNameExpanded[] = new String[animalName.length + 1];

        for (int a = 0; a <= animalName.length - 1; a++)
        {
            animalNameExpanded[a] =  animalName[a];
        }

        return animalNameExpanded;
    }

    public static int[] expandNumber(int animalNumber[])
    {
        int animalNumberExpanded[] = new int[animalNumber.length + 1];

        for (int a = 0; a <= animalNumber.length - 1; a++)
        {
            animalNumberExpanded[a] =  animalNumber[a];
        }

        return animalNumberExpanded;
    } 
```

现在，当它运行时，get 放入animalName 和animalNumber 的值现在为null。发生了什么事，我该如何解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:15:36.987

```
String animalNameExpanded[] = new String[animalName.length + 1]; 
```

创建一个新数组，其所有条目都是`null`. 然后，您将旧数组中的值复制过来，填充除最后一个之外的所有条目，它仍然是`null`.

复制后加一个`animalNameExpanded[animalName.length] = "Null";`，这样

```
while (!animalName[animalName.length - 1].equals("EXTERMINATE")) 
```

`null`在下一轮中不会从数组中读取 a 。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-15T20:21:55.053

@Daniel 所说的，也是[Arrays.copyOf(T[], int)](http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html#copyOf%28T%5b%5d,%20int%29)方法的用途。检查文档以了解它如何处理更大/更小的尺寸。

此外，您似乎真的想要一个`Animal`对象数组，而不是针对不同属性的单独数组。

### 编辑

实际上，丹尼尔的建议似乎也不是很好的风格。更容易使用 null 安全比较：

`while (!"EXTERMINATE".equals(animalName[animalName.length - 1]))`

# jpa - JPA在延迟提取字段上坚持级联失败

> ID：12903216
> 
> 赞同：0
> 
> 时间：2012-10-15T20:09:48.213
> 
> 标签：jpa, lazy-evaluation, cascade, openjpa

这是我在使用 jpa 时注意到的一件奇怪的事情。我正在使用 openjpa 1.0、RAD 8.0 和 WAS 6.1（不，我不能使用 jpa 2）。

我有一个 ProductArrangement 类，并且在该类中有一个帐户列表。在一个帐户中，我有一个报表列表。当我使用初始帐户和初始语句创建初始 productArrangement 时，持久性完美无缺。一切都正确存储在数据库中。

稍后我想在 productArrangement 中的帐户中添加一条语句，我可以通过查找访问该语句，但持久性在帐户或语句中没有结果。productArrangement 的更改是成功的。但是，当我在 getAccount().addStatement(statement) 之前执行 getAccount().getStatements() 时，它可以正常工作。这怎么可能？是因为我必须先获取它的惰性获取吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T07:01:01.570

*> 是不是因为我必须先获取它的惰性获取？*

呃……是的，不是的。
是的：似乎延迟加载没有发生，所以你有一个错误。
不：它可能不是提供程序代码中的错误，但可能是您的代码中的错误`addAccount()`and `addStatement()`。

添加新帐户或报表应该意味着将关系导航到这些实体集合。它应该自动触发任何延迟加载，所以这不应该是你的错误的原因。

但是，您需要通过**调用 getter 方法来导航关系，以从您的实体中自动触发延迟加载**。直接访问实体中的实例字段永远不会触发延迟加载 - 这将是您的代码中的错误，而不是 JPA 提供程序。

*> 但是，当我在 getAccount().addStatement(statement) 之前执行 getAccount().getStatements() 时，它可以正常工作。*

也许您的方法如下所示：

```
 public class Account {

     // fields and methods ...

     public void addStatement(Statement s) {
          this.statementsCollection.add(s);
     }
 } 
```

如果是这样，那是延迟加载的错误。它应该如下所示：

```
 public class Account {

     // fields and methods ...

     public void addStatement(Statement s) {
          this.getStatements().add(s);
     }
 } 
```

也就是说，您的外部客户端/测试代码不需要人为地调用 getAccount().getStatements()，因为 addStatement 的内部代码会自动执行此操作。

:-D

# mysql - 用于搜索和替换所有行中的文本的 sql 查询

> ID：12903219
> 
> 赞同：0
> 
> 时间：2012-10-15T20:10:10.677
> 
> 标签：mysql, sql

我需要在 mysql db 中搜索和替换字符串。我试图编辑它，但编辑器挂起。

所以我需要 sql 查询来做同样的事情。

我该怎么做？

我需要用 domain.com 替换 dev.domain.com 的实例

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T21:26:27.510

另一种解决方案是：

```
update Table set Column1 = 'domain.com' where Column1 = 'dev.domain.com' 
```

这样，您可以在不使用替换功能的情况下做同样的事情！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T20:15:50.203

```
update Table set 
Column1 = replace(Column1, 'dev.domain.com ', 'domain.com') 
```

其中 Column1 是要在其中进行替换的数据库中的列。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T14:38:34.380

我没有使用 sql 语句，而是从终端执行了简单的 sed。

# java - 我需要 IMarker 的 char_start 和 char_end

> ID：12903224
> 
> 赞同：0
> 
> 时间：2012-10-15T20:10:32.947
> 
> 标签：java, eclipse-plugin

我正在创建 IMarkers，我有行号但需要 char_start 和 char_end。创建标记时，标记所连接的文件可能不会在编辑器中打开。如何在不打开文件的情况下获得 char_start 和 char_end 偏移量？现在标记突出显示整行，但我希望它忽略前导空格。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T21:10:32.830

我能够自己解决这个问题。我确信有一种更有效的方法可以做到这一点，但这对于我的目的来说现在可以工作。

```
IPath path = Path.fromOSString(file);
IFile iFile = ResourcesPlugin.getWorkspace().getRoot().getFileForLocation(path);

ITextFileBufferManager iTextFileBufferManager = FileBuffers.getTextFileBufferManager();
ITextFileBuffer iTextFileBuffer = null;
IDocument iDoc = null;
try    {
    iTextFileBufferManager.connect(iFile.getFullPath(), LocationKind.IFILE, new NullProgressMonitor());
    iTextFileBuffer = iTextFileBufferManager.getTextFileBuffer(iFile.getFullPath(), LocationKind.IFILE);
    iDoc = iTextFileBuffer.getDocument();

    iTextFileBufferManager.disconnect(iFile.getFullPath(), LocationKind.IFILE, new NullProgressMonitor());
} catch (Exception e) {
    e.printStackTrace();
}

int start = iDoc.getLineOffset(iline - 1);
int end = iDoc.getLineLength(iline - 1);

//this next section was done to remove the leading white spaces                  
while(iDoc.getChar(start) == ' ' || iDoc.getChar(start) == '\t'){                                   
    start++;
    end--;
}

 final int charStart = start;
 final int charEnd = start + end; 
```

# android - Android - 如果我想使用谷歌云服务，我应该在清单中添加什么作为可接受的最低版本？

> ID：12903225
> 
> 赞同：1
> 
> 时间：2012-10-15T20:10:33.273
> 
> 标签：android, android-manifest

我正在阅读谷歌云服务教程：http: [//developer.android.com/guide/google/gcm/gs.html](http://developer.android.com/guide/google/gcm/gs.html)

他们建议我将这一行放在我的清单中：

我目前有这条线，因为我想支持尽可能多的设备：

```
<uses-sdk android:minSdkVersion="4" android:targetSdkVersion="15"/> 
```

我不确定如何仍然支持尽可能多的设备，但是当需要对旧版本的手机进行推送时，我可以接受，只是不传递消息。

所以我的问题是我的行应该在那里读什么？另外，现在SDK版本最高到20了吗？我也应该改变吗？:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T20:13:02.883

它需要版本 8 (Android 2.2) 或任何更新的版本。大多数 android 设备使用 2.3 或更高版本，因此 2.2 是一个不错的选择。

```
android:minSdkVersion="8" 
```

# javascript - 如何正确转义rails部分中的javascript标签？

> ID：12903226
> 
> 赞同：1
> 
> 时间：2012-10-15T20:10:45.130
> 
> 标签：javascript, ruby-on-rails

我的文件是`_file.html.erb`：

```
<script type="text/javascript">
  $(function(){
    console.log("<%= escape_javascript( list ) %>");
  });
</script> 
```

这失败了。但是，如果我在`debugger`javascript 渲染之前输入 a 并运行`list`，它会在控制台中正确返回。如何从中获取活动的工作 JSON 对象`list`以便我可以使用它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T20:19:39.280

为什么不是这个？

```
<script type="text/javascript">
  $(function(){
    var list = <%= list.attributes.to_json %>;
    console.log(list);
  });
</script> 
```

# cocoa - NSOutlineView 拖动图片

> ID：12903228
> 
> 赞同：4
> 
> 时间：2012-10-15T20:10:58.703
> 
> 标签：cocoa, drag-and-drop, nsoutlineview, nsdragginginfo, nsdraggingitem

我想更改从基于视图和数据源的项目中拖动项目时使用的图像`NSOutlineView`，但似乎找不到挂钩。我试过修改

```
- (void)dragImage:(NSImage *)anImage at:(NSPoint)viewLocation offset:(NSSize)initialOffset event:(NSEvent *)event pasteboard:(NSPasteboard *)pboard source:(id)sourceObj slideBack:(BOOL)slideFlag 
```

在 rowViews、tableCellViews 和`NSOutlineView`自身的子类中，但无济于事。

有谁知道默认图像（显然是从 tableCellView 的图像和文本字段中获取的）来自哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T17:12:19.230

原来图片是从NSTableCellView中获取的。所以钩子是在它的子类中覆盖 -(NSArray *)draggingImageComponents 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-02T12:52:03.390

有点尴尬：
从您的[数据源](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/ApplicationKit/Protocols/NSTableDataSource_Protocol/Reference/Reference.html#//apple_ref/doc/uid/TP40004178)`NSDraggingSession`中，您可以在通过参数传递的实例上设置图像，例如`tableView:draggingSession:willBeginAtPoint:forRowIndexes:`.

然后，您可以使用实例[`enumerateDraggingItemsWithOptions:forView:classes:searchOptions:usingBlock:`](https://developer.apple.com/library/mac/documentation/AppKit/Reference/NSDraggingSession_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDraggingSession/enumerateDraggingItemsWithOptions%3aforView%3aclasses%3asearchOptions%3ausingBlock%3a)上的方法`NSDraggingSession`来更改您的实际拖动图像`NSDraggingItems`：

```
 [session enumerateDraggingItemsWithOptions:NSDraggingItemEnumerationConcurrent
                                      forView:tableView
                                      classes:[NSArray arrayWithObject:[NSPasteboardItem class]]
                                searchOptions:nil
                                   usingBlock:^(NSDraggingItem *draggingItem, NSInteger index, BOOL *stop)
    {
       [draggingItem setDraggingFrame:NSMakeRect(0, 0, myWidth, myHeight)
                             contents:myFunkyDragImage];
    }]; 
```

# c - 将元素添加到链表的这个函数有什么问题？

> ID：12903229
> 
> 赞同：1
> 
> 时间：2012-10-15T20:10:58.563
> 
> 标签：c, linked-list

这是我的代码：

```
typedef struct node {
    int data;
    struct node *next;
} Node;

void add(Node *head, Node *node) {
    Node *ptr;
    ptr = head;
    if(head==NULL) {
        head=node;
    }
    else {
        while(ptr->next != NULL) {
            ptr = ptr->next;
        }
        ptr->next = node;
    }
}

Node* create(int a) {
    Node *node;
    node = (Node*)malloc(sizeof(Node));
    node->data = a;
    node->next = NULL;
    return node;
}

int main() {
    Node *head;
    head = NULL;
    int i;
    for(i=0; i<10; i++) {
        Node *node;
        node = create(i);
        add(head, node);
    }
} 
```

问题是：head 在函数 add 中被重新定义，每次 add 被调用。为什么 ？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-15T20:15:40.763

因为当您调用它时`add`会收到您的指针的**副本**。您`head`在该函数中进行了设置，但这会更改本地副本，而不是更改名为`head`in 的其他变量`main()`。你需要做这样的事情（我只是把线改了；其余的看起来还不错）：

```
 void add(Node **head, Node *node) {
    *head = node;
  }

int main() {
    add(&head, node);
 } 
```

# javascript - Twitter Bootstrap typeahead 获取 id 发布数据

> ID：12903230
> 
> 赞同：3
> 
> 时间：2012-10-15T20:11:01.237
> 
> 标签：javascript, twitter-bootstrap, typeahead

我正在使用 Twitter Bootstrap typeahead，按照这个例子。

```
var mySource = [{ id: 1, name: 'Terry'}, { id: 2, name: 'Mark'}, { id: 3, name: 'Jacob'}];

$('#myElement').typeahead({
    source: mySource
}); 
```

我需要在提交时将所选“名称”的“id”写入表格。它试图在提交时将“名称”写入表中，我不确定还有什么可以尝试的。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-17T12:58:24.517

bootstrap typeahead 的功能非常少。如果不修改插件的源代码，就无法完成您想要的工作。

相反，您可以使用 Select2 进行引导，它可以开箱即用。[http://ivaynberg.github.com/select2/](http://ivaynberg.github.com/select2/)

# sdk - Kinect SDK / 骨架跟踪器用于单臂和顶视图？

> ID：12903231
> 
> 赞同：1
> 
> 时间：2012-10-15T20:11:04.850
> 
> 标签：sdk, kinect, angle, perspective

我想在坐着时跟踪单臂（左或右），我对横向平面中的肩部和肘关节角度特别感兴趣。Kinect 的标准设置似乎是从正面看 [1]，但是当手臂直接指向相机时，这会导致问题。至少在 MS SDK 1.5 下。所以我尝试了一个高架（约 2m），向下看的视角。不幸的是，可能低于 -45 度，MS SDK 骨架跟踪器不再识别主题。

像 OpenNI 这样的其他 SDK 是否更适合这种情况？我不想编写自己的骨架跟踪器。

[1] [http://msdn.microsoft.com/en-us/library/hh973071.aspx](http://msdn.microsoft.com/en-us/library/hh973071.aspx)

# shapes - 检测位图中的形状

> ID：12903232
> 
> 赞同：2
> 
> 时间：2012-10-15T20:11:06.847
> 
> 标签：shapes, image-recognition

寻找一个好的算法来执行以下操作：我有一个仅由多边形组成的黑白图像，我是通过扫描文档获得的。我想找到这张图片中的所有形状，平滑边缘，最后得到平滑形状的坐标。有什么好的算法可以进行搜索和平滑以最终获得完美的形状？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-10-08T03:09:24.713

我将从连接组件标签开始，以分离不同的多边形。

一个简单的平滑解决方案是使用打开和关闭，但如果多边形真的很薄，它可能会切割它们。更复杂（但更好）的解决方案是将轮廓提取为参数函数 (x(t),y(t))，并使用 1D 高斯卷积对其进行平滑处理。

# rake - 耙管道复制错误的图像

> ID：12903235
> 
> 赞同：1
> 
> 时间：2012-10-15T20:11:25.253
> 
> 标签：rake, asset-pipeline

我有一个简单的 AssetFile，其中包含以下内容

```
$: << 'lib'

require 'rake-pipeline'
require 'rake-pipeline-web-filters'   

output BUILD_DIR
input SRC_DIR do
  match '**/*.handlebars' do
    handlebars :precompile => true
    concat '0.js'
  end

  match '**/lib/*.coffee' do
    coffee_script
    concat '1.js'
  end
  match '**/app.coffee' do
    coffee_script
    concat '2.js'
  end
  match '**/controller/*.coffee' do
    coffee_script
    concat '3.js'
  end
end

output ASSETS_JS
input BUILD_DIR do
  match '*.js' do
    concat 'app.js'
  end
end

output PUBLIC_ASSETS
input ASSETS do
  match '**/*' do
    copy
  end
end 
```

一切正常，除了最后一个

```
output PUBLIC_ASSETS
input ASSETS do
  match '**/*' do
    copy
  end
end 
```

这意味着将所有内容从 ASSETS 复制到 PUBLIC_ASSETS，.css 和 .js 之类的文件可以正常写入并且可以正常工作，但是图像在复制过程中已损坏

例如，我有一个大小为 3.06kb 的图像 icons-nav.png 但复制后大小为 3.09KB

我发现 Rake::Pipeline 是一个出色的工作工具，但肯定比解决方案更让人头疼，有时只是抛出令人沮丧的随机错误，而且文档真的很差

# objective-c - 如何找到两个 uint64 值的模数

> ID：12903239
> 
> 赞同：0
> 
> 时间：2012-10-15T20:11:46.940
> 
> 标签：objective-c, modulus

真的很简单的问题。我有两个 uint64 值。我想将这两个数字相除并得到余数。

```
 uint64 number1 = 36556800;
 uint64 number2 = 59325441;
 uint64 result = number1 % number2;
 NSLog(@"Result: %lld", result); 
```

上面的代码总是打印 number1 (36556800) 的值。

编辑：我意识到 number1 小于 number2。当你将这两个数字相除时，结果是一个分数。我想抓住那一小部分。所以基本上在我的例子中：

```
 36556800 / 59325441 = 0.6162 
```

如何将 6162 放入变量中？整数除法会丢弃分数，所以我应该使用的不是模运算符吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T20:19:02.057

59325441 进入 36556800 多少次？

零次，因为 59325441 大于 36556800。

从 36556800 中减去 0 * 59325441 还剩多少？

```
36556800 - 0 * 59325441 == 36556800 
```

所以

```
36556800 % 59325441 == 36556800 
```

您的代码正在打印正确的答案。如果您期望得到不同的答案，请编辑您的问题以包含您期望的答案，并解释您期望它的原因。

### 更新

根据您修改后的问题，听起来您想`double`在除法之前将数字转换为：

```
double fraction = (double)number1 / (double)number2;
NSLog(@"fraction = %.4f", fraction); 
```

请注意，a`double`不能精确地表示所有大于 2 ^(53)的整数。

# file - haskell - 无效的代码页字节序列

> ID：12903240
> 
> 赞同：12
> 
> 时间：2012-10-15T20:12:01.363
> 
> 标签：file, haskell, utf-8

```
readFile "file.html"
"start of the file... *** Exception: file.html: hGetContents: invalid argument (invalid code page byte sequence) 
```

这是一个用 notepad++ 创建的 UTF-8 文件……我怎样才能在 haskell 中读取文件？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-15T20:33:53.130

默认情况下，文件是在系统语言环境中读取的，所以如果你有一个使用非标准编码的文件，你需要自己设置文件句柄的编码。

```
foo = do
    handle <- openFile "file.html" ReadMode
    hSetEncoding handle utf8_bom
    contents <- hGetContents handle
    doSomethingWithContents
    hClose handle 
```

应该让你开始。请注意，这不包含错误处理，因此更好的方法是

```
import Control.Exception -- for bracket

foo = bracket
        (openFile "file.html" ReadMode >>= \h -> hSetEncoding h utf8_bom >> return h)
        hClose
        (\h -> hGetContents h >>= doSomething) 
```

或者

```
foo = withFile "file.html" ReadMode $
        \h -> do hSetEncoding h utf8_bom
                 contents <- hGetContents h
                 doSomethingWith contents 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-15T21:20:41.597

根据[此站点](http://www.ltg.ed.ac.uk/~richard/utf-8.cgi)，您的 6 字节解码如下：

```
EF BB BF -> ZERO WIDTH NO-BREAK SPACE (i.e. the BOM, although its not needed in UTF-8
C4 8D    -> LATIN SMALL LETTER C WITH CARON (what you said)
0D       -> CARRIAGE RETURN (CR) 
```

所以它是一个合法的 UTF-8 序列。

然而，标准的 Prelude 函数最初只是做 ASCII。我不知道他们现在在做什么，但请参阅这个问题[GHC/Haskell How does GHC/Haskell 决定它将从/到解码/编码的字符编码？](https://stackoverflow.com/questions/5286860/how-does-ghc-haskell-decide-what-character-encoding-its-going-to-decode-encode)更多的想法。然后使用[http://hackage.haskell.org/package/utf8-string](http://hackage.haskell.org/package/utf8-string)代替 Prelude 函数。

# .net - 如何调试 .NET 程序集中打包的 .NET 代码（作为单独软件运行）

> ID：12903243
> 
> 赞同：2
> 
> 时间：2012-10-15T20:12:05.607
> 
> 标签：.net, c#-4.0, reflector, .net-reflector

我有一个软件（脉冲时间数据记录器）。当然我没有它的代码。但我可以通过 .NET Reflector 查看它的代码。我想调试此代码并查看函数调用在运行应用程序（PULSE Time Data Recorder）中的工作方式。一旦我单击软件中公开的功能之一（如连接或运行此软件时它会自动连接设备并从中提取数据），.NET Reflector 显示的相应代码...必须以某种方式执行...可能我必须正确阐述..如果扫描仪不清楚，请立即询问。

我想在 .NET 中构建一个独立的软件组件，它的功能与（PULSE Time Data Recorder）相同，并且具有新要求的额外功能。因此，为了构建这样的组件，我想分析软件内部的完整代码功能和方法调用。

## 编辑

.NET Reflector 通过反编译任何程序集本身来提供代码。不是我要开发代码，我的工作场所已经购买了许可证并调整了条款……我正在做我被要求做的事情。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T20:18:30.857

Reflector VSPro 会做到这一点。

但是，由于您本质上是想窃取他们的源代码来构建类似的产品，因此我建议您尽快咨询律师。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T20:16:42.357

要调试（单步调试）.Net 程序集，您需要程序集文件和与程序集一起编译的[.pdb 文件。](http://msdn.microsoft.com/en-us/library/ms241903.aspx)如果您没有两者，您仍然可以使用任何反射器软件（如其他回复中所述）来查看原始代码（除非它被[混淆](http://en.wikipedia.org/wiki/Obfuscation_%28software%29)）。

如果您***绝对确定***您拥有这样做的合法权利，您可以复制反射器中可见的源代码，重新编译它，然后逐步执行该程序集。

# java - 使用POST方法android向PHP发送数据？

> ID：12903244
> 
> 赞同：-2
> 
> 时间：2012-10-15T20:12:17.370
> 
> 标签：java, php, android, http, post

我正在尝试将 4 个变量发布到网络服务器上的 PHP 文件中。这是针对我在 Eclipse 中构建的 android 应用程序。

当我打开应用程序运行此功能的那一刻，应用程序崩溃。在我添加此功能之前，该应用程序运行良好。该应用程序在模拟器中完美运行，但仅在我的手机上崩溃。我尝试在三星 S3 和 S2 上运行它。

Android 应用程序中的功能。使用 log.di 能够发现应用程序运行到 try 语句而不是崩溃。

```
public void postData( double pLong, double pLat, String timeStamp) throws ClientProtocolException, IOException, URISyntaxException {
    // Create a new HttpClient and Post Header
    HttpClient httpclient = new DefaultHttpClient();
    HttpPost httppost = new HttpPost("http://website.com/this.php");
    Log.d("response", "WORKING");
    try {

        // Add your data
        List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(2);
        nameValuePairs.add(new BasicNameValuePair("IMEI", deviceid));
        nameValuePairs.add(new BasicNameValuePair("LONGITUDE",Double.toString(pLat)));
        nameValuePairs.add(new BasicNameValuePair("LATITUDE", Double.toString(pLong)));
        nameValuePairs.add(new BasicNameValuePair("CREATED_AT", timeStamp));
        httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));

        // Execute HTTP Post Request
        HttpResponse response = httpclient.execute(httppost);

        Log.d("response!!!!", "  " + response);

    } catch (ClientProtocolException e) {
        //Requirement Auto-generated catch block
        Log.d("response", "nope" + e);
    } catch (IOException e) {
        Log.d("response", "nope" + e);
        //Requirement Auto-generated catch block
    }
} 
```

PHP 文件：

```
<?php
$imei = $_POST['IMEI'];
$long = $_POST['LONGITUDE'];
$lat = $_POST['LATITUDE'];
$time = $_POST['CREATED_AT'];

$con = mysql_connect("host", "username", "password");  //this is the real username and password

if (!$con)
  {
      die('Could not connect: ' . mysql_error());
  }
  mysql_select_db("database", $con);

mysql_query("INSERT INTO `table`(`imei`, `longitude`, `latitude`, `createdAt`)
VALUES ('".$imei."', '".$long."', '".$lat."', '".$time."')") or die (mysql_error());

$id = mysql_insert_id();
echo "done";
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T04:57:26.343

创建一个新类，实例化它并 .execute()。为什么会出现此错误？因为你需要让它异步。

```
private class MyPost extends AsyncTask<Void,Void,Void>{

    @Override
    protected Void doInBackground(Void... arg0) {
        // TODO Auto-generated method stub
        // Create a new HttpClient and Post Header
        HttpClient httpclient = new DefaultHttpClient();
        HttpPost httppost = new HttpPost("http://cdobiz.com/submit/");

        try {
            // Add your data

            EditText txtName = (EditText)findViewById(R.id.txtBusinessName);
            EditText txtDesc = (EditText)findViewById(R.id.txtDescription);

            List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(2);
            nameValuePairs.add(new BasicNameValuePair("frmName",txtName.getText().toString() ));
            nameValuePairs.add(new BasicNameValuePair("frmDesc", txtDesc.getText().toString()));
            httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));

            // Execute HTTP Post Request
            HttpResponse response = httpclient.execute(httppost);
            Log.v("Post Status","Code: "+response.getStatusLine().getStatusCode());
        } catch (ClientProtocolException e) {
            // TODO Auto-generated catch block
        } catch (IOException e) {
            // TODO Auto-generated catch block
        }
        return null;
    }

} 
```

# php - 更改 Javascript 数组索引

> ID：12903250
> 
> 赞同：0
> 
> 时间：2012-10-15T20:12:36.393
> 
> 标签：php, javascript

我有一个漫画网站，它遍历数据库中的所有图像并将它们显示为缩略图。用户可以单击其中一张图像，在 viewComic.php 模板上以正常大小查看它。

我想让用户按左右箭头来导航图像。

所以，我的想法是：

1.  pagination.php 通过遍历数据库结果数组来处理正确页面上的图像显示（通过偏移）。用户可以单击结果（如下）以转到 viewcomic.php 模板上的特定图像。

    ```
    '<br />IMG: <a href="./templates/viewcomic.php?id=' . $row['imgid'] . '&image=' . $imgpath.$row['imgname'] . '"> 
    ```

2.  现在在 viewcomic.php 上，我获取并显示图像

    ```
    $imgid = $_GET['id']; 
    $imgpath = $_GET['image']; 
    <center><img src=".<?php echo  $imgpath  ?>" /></center> 
    ```

用户可以按左右箭头来浏览图像...

**问题 1：Javascript 是否允许您手动设置数组中的索引位置？**

由于我想让用户获取下一张和最后一张图像，我希望他们从他们当前所在的图像（他们在 pagination.php 中单击的图像）开始，而不是从图像数组的开头。我在 URL 中传递了 $imgid，所以我要设置 javascript img 数组索引 == $imgid，这将允许用户从他们离开的地方继续滚动浏览图像。

**问题2：如何保持数组的*当前索引？***

当我想去某个方向时，它工作得很好。但如果我想改变方向，我必须按两次键。我发现这是因为在（imgIndex++）我按下了键之后索引增加了。意思是，当它开始走相反的方向时，它首先需要递减以将索引返回到当前图像，然后再次按键以最终显示下一个图像。我不知道如何解决这个问题。使用 ++imgIndex 也是有问题的，因为它会向前跳过图像。

```
<?php
 getImages() {
//DB connection code omitted
   $img = array();
   while($row = $catResult->fetch_assoc()) {
       $img[] = "'../images/all_comics/" . $row['imgname'] . "'";
}
return $img;
?>

var imgArray = [<?php echo implode(',', getImages()) ?>];
$(document).ready(function() {
    var img = document.getElementById("theImage");
    img.src = imgArray[0];
    var imgIndex = 0;

    $(document).keydown(function (e) 
    {
        //next image
        if (e.which == 39) 
        {
            if (imgIndex == imgArray.length) 
            {
                imgIndex = 0;
            }
            img.src = imgArray[imgIndex++];
                    //now the index is ahead by 1, which is bad if you want to press <-- to get the last image because the index is ahead by 1.
        }

        //last image
        if (e.which == 37) 
        {
            if (imgIndex == 0) 
            {
                imgIndex = imgArray.length;
            }
            img.src = imgArray[--imgIndex];
        }
    });
}); 
```

有任何想法吗？

非常感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T20:26:13.293

更改操作顺序：

```
if (e.which == 39) {
    imgIndex++;            
    if (imgIndex>imgArray.length)  {
        imgIndex = 0;
    }
    img.src = imgArray[imgIndex];                
} 
```

# regex - 正则表达式提取带或不带转义字符的双引号之间的文本

> ID：12903251
> 
> 赞同：0
> 
> 时间：2012-10-15T20:12:39.267
> 
> 标签：regex, expression

需要一个正则表达式来查找以下两个示例之间的文本，而不考虑转义引号：

```
TestNode1="HERE IS THE TEXT I WANT RETURNED"
TestNode2=\"HERE IS THE TEXT I WANT RETURNED\" 
```

我有这个，但它不适用于转义字符：

```
"(?:[^\\"]+|\\.)*" 
```

我期待两个测试节点（1或2）的以下回报：

```
HERE IS THE TEXT I WANT RETURNED 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T20:13:45.317

使用正则表达式模式

```
(\\?")(.*?)\1 
```

或者

```
(\\\\?")(.*?)\\1 
```

取决于你使用的环境...

# objective-c - 来自 ASIHttpRequest 的空白响应

> ID：12903252
> 
> 赞同：1
> 
> 时间：2012-10-15T20:12:44.670
> 
> 标签：objective-c, ios, asihttprequest

我正在使用 ASIHttpRequest 库进行并行异步 Web 调用。这是实际方法的代码片段。

```
- (void)dataForURI:(NSString *)dataURI andTag:(NSString*)tag
{
NSLog(@"%d",_queue.requestsCount);
if (!_queue) {
    _queue = [ASINetworkQueue queue];
}
ASIHTTPRequest* request = [ASIHTTPRequest requestWithURL:[NSURL URLWithString:dataURI]];
[request setTimeOutSeconds:30];
[request setDownloadProgressDelegate:self];
[request setDelegate:self];
[request setDidFinishSelector:@selector(requestFinished:)];
[request setDidFailSelector:@selector(requestFailed:)];
[request setDidReceiveResponseHeadersSelector:@selector(requsestResponseHeaderReceived:)];
[request setShouldContinueWhenAppEntersBackground:YES];
[request setTag:[tag integerValue]];
[_queue addOperation:request];
[_queue go];
} 
```

当我“NSLog”请求的 request.responseString 属性时，控制台中没有显示任何内容。我使用 Wireshark 检查链接是否正在发送任何响应，并且看起来它正在发送正确的响应。

当我'NSLog' responseHeaders 它显示正确的值。这是代码片段：

```
-(void)requestFinished:(ASIHTTPRequest *)request
{
NSLog(@"%@",request.responseString);
NSLog(@"%@",[[request responseHeaders] objectForKey:@"Content-Type"]);
[self imageHandlerDidDownloadData:request.responseData mimeType:[request.responseHeaders objectForKey:@"Content-Type"] forMediaID:[NSString stringWithFormat:@"%d", request.tag]];
} 
```

我也在这个方法中得到响应数据（但不是在 RequestFinished: 方法中）：

```
-(void)request:(ASIHTTPRequest *)request didReceiveData:(NSData *)data
{
NSLog(@"%@",data);
NSLog(@"%@", [[request responseHeaders] objectForKey:@"Content-Type"]);
} 
```

请帮助我得到正确的回应......!!!

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T21:20:09.273

我想到了。我需要为 _queue 设置委托，而不是为 ASIHttpRequest 设置委托。

使用

```
[_queue setDelegate:self] worked out for me... 
```

# android - Android 动画 Autodesk Maya

> ID：12903254
> 
> 赞同：0
> 
> 时间：2012-10-15T20:12:49.253
> 
> 标签：android

我看到这个 3D 程序调用 Autodesk Maya 来制作 3D 动画。现在我已经在这个程序中以 3D 形式绘制了我的英雄并让他运行，只是（动画），所以这里有一个问题：可以把这个动画放在 Android 程序中吗？如果没有，我读到你可以在 openGl 中制作动画，但我只看到了绘制 3D 的教程而不是制作动画。我的想法是我喜欢可以移动和射击的 3D 人......那么我怎么能在 android 中做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T20:24:20.697

检查 PowerVR 和 PVR 系统。您可以从 Maya 创建文件并使用 PVR 萨满。这是一个复杂的领域，但效果很好。它也是跨平台的。

[http://www.imgtec.com/powervr/insider/powervr-faq.asp](http://www.imgtec.com/powervr/insider/powervr-faq.asp)

# .net - 重建后托管在 CassiniDev 中时的 WebService 内存使用情况

> ID：12903255
> 
> 赞同：1
> 
> 时间：2012-10-15T20:12:51.197
> 
> 标签：.net, wcf, memory-management

我有一个 WCF 服务，它占用了一些内存，大约 1GB。

它在本地托管在开发 asp.net 托管 (CassiniDev) 中。

当我更改代码并点击构建时，服务器不会停止工作。它实际上开始无缝地使用更新的代码，除了内存。

从它的外观来看，它只是在重建后使内存使用量翻了一番，所以我不太确定这里发生了什么。我的机器上的内存很少，所以有时这会导致整个系统冻结。

我想知道为什么它在开始更新 dll 后不运行一些 GC 收集，例如，导致内存大小加倍 def 听起来像是发生了一些有趣的事情。很明显，在重建之后，就无法再访问以前版本的服务了，所以如果它不会使内存使用量翻倍，而是使用相同的内存，这对我来说是有意义的。

编辑：我想当我们将更新的 dll 推送到服务目录时，这可以推广到内存管理，也用于 IIS 托管服务和开发。

# c++ - 使用 Qt 的简单线程 gui 应用程序的结构是什么？

> ID：12903260
> 
> 赞同：1
> 
> 时间：2012-10-15T20:13:18.087
> 
> 标签：c++, multithreading, qt, user-interface

我正在尝试围绕线程和 gui 应用程序进行研究，以便开始构建它们。我下载了 Qt SDK，但有点迷茫。

为了让我能理解它是如何工作的，我想创建一个由一个文本框和两个按钮组成的 gui 应用程序。每个按钮都将启动一个新线程（因此可以同时运行 3 个：主 gui 线程，以及从按钮启动的 2 个），并且每个都可以访问文本框中的信息。我将如何设置此应用程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:16:02.993

看看 SIGNAL 和 SLOTS 它是 Qt 的基础。

完成之后看看 QThread 和 QThreadPool。

我还推荐这些可怕的教程：[http ://www.voidrealms.com/tutorials.aspx?filter=qt](http://www.voidrealms.com/tutorials.aspx?filter=qt)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T02:57:32.000

您必须将一个插槽连接到 QPushButton clicked 信号并从该插槽启动一个新线程，如下所示。

`QPushButton *button=new QPushButton();`

```
connect(button,SIGNAL(clicked()),this,SLOT(startthread())); 
```

并且 slot startthread 将使用工作类启动新线程

```
void MyClass::startthread()
  {
       QThread *thread=new QThread();
       WorkerClass * worker=new WorkerClass();
       worker->moveToThread(thread);
       thread->start()
  } 
```

其中 WorkerClass 将在单独的线程中执行。

# c# - 可移植类库：推荐替换 [Serializable]

> ID：12903262
> 
> 赞同：43
> 
> 时间：2012-10-15T20:13:22.190
> 
> 标签：c#, serialization, datacontract, serializable, portable-class-library

我正在将 .NET Framework C# 类库移植到可移植类库。一个反复出现的问题是如何处理用该`[Serializable]`属性修饰的类，因为该属性不是可移植类库子集的一部分。可移植类库子集中的序列化功能似乎由[DataContractAttribute](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.datacontractattribute.aspx)覆盖。

*   为了在可移植类库中保留尽可能多的功能，`[Serializable]`用`[DataContract]`属性替换是否就足够了（这意味着所有受序列化的字段和属性也需要进行修饰`[DataMember]`）？
*   ***我不能***用我***可以***应用的这种方法做什么（如果有的话）`[Serializable]`？
*   有没有侵入性较小的方法？

鉴于`[DataContract]`和`[DataMember]`被使用，我正在考虑按照以下几行更改代码。这种方法有什么明显的缺陷吗？有什么办法可以让同样的事情变得不那么冗长吗？

```
#if PORTABLE
    [DataContract]
#else
    [Serializable]
#endif
    public class SerializableClass : SerializableBaseClass
    {
       ...
#if !PORTABLE
        protected SerializableClass(SerializationInfo info, StreamingContext context)
             : base(info, context)
        {
        }
#endif
        ...
#if PORTABLE
        [DataMember]
#endif
        private Type1 _serializableField;

#if PORTABLE
        [DataMember]
#endif
        private Type2 SerializableProperty { get; set; }

        ...
    } 
```

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-10-15T20:39:05.850

**便携式类库 (PCL) 现已正式弃用**[2017 年 8 月 16 日]

> 如果您现在在不同的 .NET 实现之间共享代码，您可能知道可移植类库 (PCL)。随着 .NET Standard 2.0 的发布，我们现在正式弃用 PCL，您应该将项目迁移到 .NET Standard。

**资料来源：** [宣布 .NET Standard 2.0](https://blogs.msdn.microsoft.com/dotnet/2017/08/14/announcing-net-standard-2-0/)

**可移植类库 (PCL) 现在可在所有平台上使用 [2013 年 10 月 14 日]**

> 在今天的发布之前，PCL 参考程序集存在许可限制，这意味着它们只能在 Windows 上使用。在今天发布的版本中，我们宣布了一个新的 PCL 参考程序集独立版本，其许可证允许它**在任何平台（包括非 Microsoft 平台）上使用。** 这使开发人员能够更加灵活地使用 .NET 完成出色的工作。

**资料来源：** [可移植类库 (PCL) 现在可在所有平台上使用](http://blogs.msdn.com/b/dotnet/archive/2013/10/14/portable-class-library-pcl-now-available-on-all-platforms.aspx)

**下载：** [Microsoft .NET 便携式库参考程序集 4.6 RC](http://www.microsoft.com/en-us/download/details.aspx?id=40727)

仅供参考，允许的程序集集是：

> mscorlib.dll
> 
> 系统.dll
> 
> System.Core.dll
> 
> System.Xml.dll
> 
> System.ComponentModel.Composition.dll (MEF)
> 
> System.Net.dll
> 
> System.Runtime.Serialization.dll
> 
> System.ServiceModel.dll
> 
> System.Xml.Serialization.dll
> 
> System.Windows.dll（来自 Silverlight）

据我所知，您需要使用**DataMember**属性标记字段，并添加**DataContract**属性。

**更新**

是的。

您可以查看[Json.NET](http://json.codeplex.com/)可移植类库解决方案是如何实现的。当您从此处[Json.NET 4.5 Release 10 (source + binary)下载项目时，您可以在](http://json.codeplex.com/downloads/get/501717)**Source\Src\Newtonsoft.Json.Portable**中找到解决方案。

基本上，他们使用的是带有自定义属性提供程序的方法

//不要使用可序列化

```
#if !(SILVERLIGHT || WINDOWS_PHONE || NETFX_CORE || PORTABLE)
  [Serializable]
#endif 
```

//使用自定义提供者

```
#if NETFX_CORE || PORTABLE
using ICustomAttributeProvider = Newtonsoft.Json.Utilities.CustomAttributeProvider;
#endif 
```

如果项目是可**移植的**

```
#if !PocketPC && !NET20
      DataContractAttribute dataContractAttribute = GetDataContractAttribute(objectType);
      if (dataContractAttribute != null)
        return MemberSerialization.OptIn;
#endif 
```

其中**OptIn**描述是：

```
 /// <summary>
    /// Only members must be marked with <see cref="JsonPropertyAttribute"/> or <see cref="DataMemberAttribute"/> are serialized.
    /// This member serialization mode can also be set by marking the class with <see cref="DataContractAttribute"/>.
    /// </summary>
    OptIn, 
```

希望能帮助到你。

**更新 2**

> 我是否会失去使用 [DataContract] 而不是 [Serializable] 的任何能力，还是我仍然能够做 [Serializable] 支持的所有事情？

您可以执行**Serializable**支持的所有操作，除了在设置名称和顺序之外控制对象的序列化方式。

使用[DataContractSerializer](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.datacontractserializer.aspx)有几个好处：

序列化任何用 a 装饰的东西，`[DataMember]`即使它不公开可见

**除非您明确告诉它（“选择加入”），**否则无法序列化任何内容

 **`[Order=]`您可以使用属性上的属性定义元素序列化的顺序`[DataMember]`

不需要无参数构造函数进行反序列化

比 XmlSerializer 快 10%。

在这里阅读更多：[XmlSerializer vs DataContractSerializer](http://www.danrigsby.com/blog/index.php/2008/03/07/xmlserializer-vs-datacontractserializer-serialization-in-wcf/)

也供参考：

`DataContract`在默认模式下支持以下类型的序列化： CLR 内置类型

> 字节数组、日期时间、时间跨度、GUID、Uri、XmlQualifiedName、XmlElement 和 XmlNode 数组
> 
> 枚举
> 
> 用 DataContract 或 CollectionDataContract 属性标记的类型
> 
> 实现 IXmlSerializable 的类型
> 
> 数组和集合类，包括 List、Dictionary 和 Hashtable
> 
> 标有 Serializable 属性的类型，包括那些实现 ISerializable 的类型
> 
> 没有上述属性（POCO）但具有默认构造函数的类型

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-10-15T20:29:00.717

为了消除常量预处理器指令导致的混乱，您可以做的一件事是将其推到一个新`SerializableAttribute`类并基本上欺骗编译器。

```
#if PORTABLE
namespace System
{
   public class SerializableAttribute : Attribute
   {
       //this does nothing
   }  
}
#endif 
```

然后继续`Serializable`像往常一样装饰你的班级......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-05-23T15:52:09.870

对于 .Net 4.6 及更高版本，PCL 不再可以使用 DataContract。您需要在此处添加 Nuget 包 System.Runtime.Serialization.Primitives：[https ://www.nuget.org/packages/System.Runtime.Serialization.Primitives/](https://www.nuget.org/packages/System.Runtime.Serialization.Primitives/)

请注意，对于实际序列化，您可能还需要诸如 System.Runtime.Serialization.Json、System.Runtime.Serialization.Xml 或 Newtonsoft.Json 之类的实现。**

# spotify - Spotify - 有没有办法以编程方式将曲目星标设置为真？

> ID：12903264
> 
> 赞同：-3
> 
> 时间：2012-10-15T20:13:40.360
> 
> 标签：spotify

我的对象是这样定义的：

```
var myTrack = models.Track.fromURI('spotify:track:0123456789'); 
```

如何将加星标的值设置为 true？任何人？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:29:35.457

`models.library.starredPlaylist.add(models.Track.fromURI('spotify:track:0123456789'));`

# r - Emacs ESS Mode TAB 停止缩进

> ID：12903270
> 
> 赞同：4
> 
> 时间：2012-10-15T20:13:50.920
> 
> 标签：r, emacs, elisp, ess

我在 Windows 上使用 Emacs 24 来编写一些 R 代码。直到大约 30 分钟前，每当我编写一个新函数时，ESS 都会自动缩进函数声明之后的行，并且在新的空白行上按 Tab 键会将我跳转到声明中适当缩进的起始位置。

例如：

```
foo <- function() {
    first line started here
    second line here.  .etc
} 
```

现在，很难将所有内容都包装到左侧，并且在函数声明之后或按 Tab 键时不会自动缩进来响应。

```
foo <- function() {
first line
second line
} 
```

我用谷歌搜索过，但我的 google-fu 在这方面让我失望了。任何人都知道如何在 Emacs 中将默认选项卡行为恢复为 ESS？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-15T21:11:22.803

只是为了记录。每当发生这种情况时，选择整个缓冲区 `C-x h` 并按 `C-M-\` 缩进整个区域。这将明确显示语法错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T20:20:52.293

尝试在“#”之后添加一个空格。我不认为 ESS 模式将 # 作为注释处理，除非您在它后面有空格。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-25T23:54:06.363

我刚刚遇到了你描述的同样的问题。

以上似乎都不起作用，但我将其缩小为使用回车符，然后在字符串中使用左括号，如下所示：

```
### indent ( <tab> ) working fine up to here 
   s1 <- "string
(then this in brackets)"
### now indent does nothing! 
```

后来平衡的事实无济于事。我认为 EMACS 将其读作打开一个新的表达式/块，尽管它出现在带引号的字符串中。这似乎也适用于表达式开启器`{`和`[`. 它似乎只在“开放式表达式”符号出现在行首时才会发生......

在我的情况下，字符串是绘图标签的一部分，因此解决方案是`\n`改用。

# mysql - MySQL 多个 Inner Join 帮助 - 1064

> ID：12903271
> 
> 赞同：0
> 
> 时间：2012-10-15T20:13:54.233
> 
> 标签：mysql, inner-join

也许它只是一个深夜或者也许我没有喝足够的咖啡，但我似乎无法理解为什么我的 MySQL 语句是 1064'ing。

![在此处输入图像描述](../Images/e55ae8208c25f88361a2d80217f53527.png)

伪代码：

> 获取最近发生的事件的 ID，然后将其与链接（参加）该事件的所有客人一起检索他们的名字和姓氏。

MYSQL

```
SELECT event.id, link.event_id, link.guests_id, guests.id, guests.first_name, guests.second_name 
FROM event
INNER JOIN link
ON event.id =link.event_id;
INNER JOIN guests
ON link.guests_id = guest.id;
ORDER BY event.date DESC 
LIMIT 1 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T20:17:30.690

从 stament 中移除`;`以使其工作。

`;`是分隔符，数据库引擎认为您的查询结束`;`并且不完整

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-15T20:20:17.820

你忘了一个“s”

在 link.guests_id = guest.id

# perl - 脚本头过早结束 (perl+index.html)

> ID：12903272
> 
> 赞同：0
> 
> 时间：2012-10-15T20:13:59.287
> 
> 标签：perl, apache, cgi

尊敬的人...

我在 openSUSE 12.2 上，我的 Apache 服务器运行良好......

我复制了 index.html，其中包含：

```
<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head><title>Program 7b</title></head>
<body>
<form method="POST" action="http://localhost/cgi-bin/7b.pl">
    Please Enter the Command :
    <input type="text" name="command" id="command" />
    <input type="submit" value="Submit" />
</form>
</body>
</html> 
```

perl文件如下：

```
#!/usr/bin/perl

print "Content-type:text/html\n\n";
use CGI

$a = new CGI;
$comm = $a->param("command");
print "The Output of the entered command is:<br />";
system($comm); 
```

cgi-bin 目录下的两个文件

但我得到错误：

脚本头过早结束在任何浏览器中运行 localhost/cgi-bin/index.html ....

我已经在apache配置中设置了perl文件的执行...

请帮助解决问题...

问候-SkyKOG

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T20:30:38.717

尝试以下工作代码：

```
#!/usr/bin/perl
use strict; use warnings;
use CGI;

print "Content-type:text/html\n\n";

my $a = new CGI;
my $comm = $a->param("command");

print "The Output of the entered command is:<br />";
system($comm); 
```

一个建议：永远不要忘记并用or`use strict; use warnings;`声明变量。`my``our`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T20:21:25.993

Apache 将 index.html 作为脚本运行，而不仅仅是显示 HTML 文档。Apache 可能配置为将 cgi 目录中的任何内容作为脚本运行。

将 html 文件移动到另一个目录。

# sql-server - SQL Server 合并大小写？

> ID：12903276
> 
> 赞同：4
> 
> 时间：2012-10-15T20:14:21.343
> 
> 标签：sql-server, sql-server-2008, merge, case

大家好，这里有另一个问题，关于这次关于合并的 sql server 2008 r2，是否有可能在合并的更新部分中有一个案例？

因为它告诉我

消息 156，级别 15，状态 1，第 9 行关键字“CASE”附近的语法不正确。

```
MERGE INTO PERSONAFISICA AS TARGET
USING dbo.#temp1 AS SOURCE
ON TARGET.RFC = SOURCE.RFC AND TARGET.APATERNO = SOURCE.APELLIDO_PATERNO AND
TARGET.AMATERNO = SOURCE.Apellido_Materno
WHEN MATCHED THEN
UPDATE SET
TARGET.NUM_CLIENTE = 0,
TARGET.NOMBRE1 = LEFT(SOURCE.Nombre,CHARINDEX(' ', SOURCE.NOMBRE + ' ') -1),
CASE 
WHEN LEN(SOURCE.NOMBRE) - LEN(REPLACE(SOURCE.NOMBRE,' ','')) >= 1
THEN 
TARGET.NOMBRE2 = SUBSTRING(SOURCE.NOMBRE, CHARINDEX(' ', SOURCE.NOMBRE)+1, LEN(SOURCE.NOMBRE))
ELSE '' END,
TARGET.APATERNO = SOURCE.Apellido_Paterno,
TARGET.AMTERNO = SOURCE.Apellido_Materno,
CASE 
WHEN SOURCE.SEXO = 'F' 
THEN TARGET.IDGENERO = 2
WHEN SOURCE.SEXO = 'M'
THEN TARGET.IDGENERO = 1
ELSE TARGET.IDGENERO = 0
END,
CASE
WHEN SOURCE.ESTADO_CIVIL = '0' 
THEN TARGET.idestado_civil = 0
WHEN SOURCE.ESTADO_CIVIL = 'C'
THEN TARGET.idestado_civil = 1
WHEN SOURCE.ESTADO_CIVIL = 'D' 
THEN TARGET.idestado_civil = 2
WHEN SOURCE.ESTADO_CIVIL = 'S'
THEN TARGET.idestado_civil = 3
WHEN SOURCE.ESTADO_CIVIL = 'V' 
THEN TARGET.idestado_civil = 5
WHEN SOURCE.ESTADO_CIVIL = 'U'
THEN TARGET.idestado_civil = 6
ELSE TARGET.idestado_civil = 0
END,
TARGET.idregimen = 0,
TARGET.saludo = SOURCE.SALUDO,
TARGET.conyuge_nombre1 = '',
TARGET.conyuge_nombre2 = '',
TARGET.conyuge_apaterno = '',
TARGET.conyuge_nombre2 = '',
TARGET.dependiente = 0,
TARGET.edad_dependiente = '',
TARGET.ididentificacion = 0,
TARGET.fecha_nacimiento = '1800-01-01',
TARGET.rfc = SOURCE.RFC,
TARGET.CURP = '',
TARGET.idnacionalidad = 0,
TARGET.email = SOURCE.Email_Personal,
TARGET.idescolaridad = SOURCE.Escolaridad
WHEN NOT MATCHED THEN
INSERT (num_cliente, nombre1, nombre2, apaterno, amaterno, idgenero, idestado_civil,
idregimen, saludo, conyuge_nombre1, conyuge_nombre2, conyuge_apaterno, conyuge_amaterno, dependiente,
edad_dependiente, ididentificacion, fecha_nacimiento, rfc, curp, idnacionalidad, email, idescolaridad)
VALUES (0, LEFT(nombre,CHARINDEX(' ',nombre + ' ')-1) AS [Primer Nombre],
CASE WHEN LEN(nombre) - LEN(REPLACE(nombre,' ','')) >= 1  THEN SUBSTRING(nombre, CHARINDEX(' ', nombre)+1, LEN(nombre)) ELSE '' END AS [Segundo Nombre],
Apellido_Paterno,Apellido_Materno)
CASE 
WHEN SEXO = 'F' THEN 2
WHEN SEXO = 'M' THEN 1
ELSE 0
END,
CASE 
WHEN Estado_Civil = '0' THEN 0
WHEN Estado_Civil = 'C' THEN 1
WHEN Estado_Civil = 'D' THEN 2
WHEN Estado_Civil = 'S' THEN 3
WHEN Estado_Civil = 'V' THEN 5
WHEN Estado_Civil = 'U' THEN 6
ELSE 0
END, 0, Saludo,'','','','',0,'',0,'1800-01-01',RFC,'',0,Email_Personal,Escolaridad 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-15T20:25:58.850

您不能在更新中以这种方式使用案例。它需要像...

```
UPDATE table
SET value1 = CASE 
    WHEN a.blah = b.blah THEN foo
    WHEN a.blah > b.blah THEN bar
    ELSE NULL
  END,
value2 = 5,
...... 
```

# xaml - 在 WinRT XAML 中使用 Page.Resources 或 MyControl.Resources？

> ID：12903281
> 
> 赞同：0
> 
> 时间：2012-10-15T20:14:43.433
> 
> 标签：xaml, resources, windows-runtime, winrt-xaml

我注意到 WinRT 应用程序的一些示例在引用资源设置的方式上有些冲突

对于一些：

```
<common:LayoutAwarePage ...>
<common:LayoutAwarePage.Resources ...> 
```

但我也见过（LayoutAwarePage当然继承了Page）

```
<common:LayoutAwarePage ...>
<Page.Resources ...> 
```

其中哪一项是正确的？有什么不同？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T20:16:57.240

如果您查看 the 的来源，`LayoutAwarePage.cs`您会注意到 the`LayoutAwarePage` *是*一个`Page`. 我认为他们会引用父类的资源并建议您使用`common:LayoutAwarePage.Resources`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-13T17:45:13.280

怎么样`<FrameworkElement.Resources>`？这样，如果您更改 Page/UserControl 的实际类，您就不必更改标签

# legend - Stata 图表中的图例选项

> ID：12903286
> 
> 赞同：1
> 
> 时间：2012-10-15T20:15:14.337
> 
> 标签：legend, graphing, stata

[http://imageshack.us/photo/my-images/339/41988730.jpg/](http://imageshack.us/photo/my-images/339/41988730.jpg/)

我试图弄清楚如何调整此图中图例的选项（请参阅上面的链接）。具体来说，我希望`new =`标签的一部分消失。在每一行旁边，我只想要公司的名称。我正在使用 xtline 命令生成图形。图表上的每条线都应该代表变量“公司”的不同值（应该有 11 个不同的值）。

`xtline revenue, overlay t(week_name) i(company)`

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T00:09:52.820

使用 legend() 选项的 label() 子选项。这是 p 上的示例。Stata 12手册的474：

```
line le_m le_f year, legend(label(1 "Males") label(2 "Females")) 
```

您还可以使用 order() 子选项根据图形上曲线的顺序对图例条目进行排序。键入“帮助图表图例”以获取更多信息和手册链接。

但是，我没有发现有这么多条目的传说有帮助。如果你指定“legend(off)”，你会有一个更易读的情节；“yscale（日志）”；并使用图形编辑器在每条曲线旁边添加适当的标签。

# scala - @tailrec 错误“针对超类型的递归调用”

> ID：12903287
> 
> 赞同：4
> 
> 时间：2012-10-15T20:15:19.473
> 
> 标签：scala

应用 @tailrec 我从 scala 编译器收到错误：“无法优化 @tailrec 带注释的方法 get：它包含一个针对超类型 case _ => tail.get(n-1) 的递归调用”。有人可以解释这是为什么吗？

```
trait List[T] {
  def isEmpty: Boolean
  def head: T
  def tail: List[T]
  def get(n: Int): T
}

class Cons[T](val head: T, val tail: List[T]) extends List[T]{
  def isEmpty = false
  @tailrec
  final def get(n: Int) =
    n match {
      case 0 => head
      case _ => tail.get(n-1)
    }
}

class Nil[T] extends List[T]{
  def isEmpty = true
  def head = throw new NoSuchElementException("Nil.head")
  def tail = throw new NoSuchElementException("Nil.tail")
  final def get(n: Int): T = throw new IndexOutOfBoundsException
}

object Main extends App{
  println(new Cons(4, new Cons(7, new Cons(13, new Nil))).get(3))
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-15T20:22:20.323

试着想象这里发生了什么以及你要求编译器做什么。尾调用优化粗略地将方法调用变成一个循环，获取方法的参数并将它们变成在循环的每次迭代中重新分配的变量。

在这里，有两个这样的“循环变量”：`n`以及调用方法所在的列表单元格本身`get`，它实际上`this`位于方法体中。的下一个值`n`很好：它`n - 1`也是一个`Int`. 然而，列表单元格的下一个值，即`tail`，是一个问题：`this`有 type `Cons[T]`，但`tail`只有 type `List[T]`。

因此，编译器无法将其转换为循环，因为无法保证它`tail`是 a `Cons[T]`—— 果然，在列表的末尾，它是 a `Nil`。

“修复”它的一种方法是：

```
case class Cons[T](val head: T, val tail: List[T]) extends List[T] {
  def isEmpty = false
  @tailrec
  final def get(n: Int) =
    n match {
      case 0 => head
      case _ => tail match {
        case c @ Cons(_, _) => c.get(n - 1)
        case nil @ Nil() => nil.get(n - 1)
      }
    }
} 
```

（如果两者都是案例类`Cons`，`Nil`则有效——但您可能希望在 中创建`Nil`和`case object`协`List[T]`变`T`。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-15T21:29:28.897

Ben 和 Jean-Phillipe Pellet 已经解释了编译器抱怨的原因。至于如何解决，有一个直截了当的解决方案：将`get`right 的实现移入`List`：

```
trait List[T] {
  def isEmpty: Boolean
  def head: T
  def tail: List[T]
  @tailrec
  final def get(n: Int): T = {
    n match {
      case 0 => head
      case _ => tail.get(n-1)
    }
  }
}

class Cons[T](val head: T, val tail: List[T]) extends List[T]{
  def isEmpty = false
}

class Nil[T] extends List[T]{
  def isEmpty = true
  def head = throw new NoSuchElementException("Nil.head")
  def tail = throw new NoSuchElementException("Nil.tail")
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-15T20:23:43.130

在`Cons.get`你打电话`tail.get`作为你的尾电话。但是`tail`是类型`List[T]`，不是`Cons[T]`。因此该调用不一定由 处理`Cons.get`，并且 Scala 不能应用尾递归优化；优化会将方法调用转换为本地跳转到 的开头`Cons.get`，但这不一定是调用的去向。

# c++ - 额外的反斜杠字符不会影响我的程序。为什么？

> ID：12903294
> 
> 赞同：5
> 
> 时间：2012-10-15T20:15:42.810
> 
> 标签：c++, gcc, g++, backslash

此代码将在 g++ 中正常工作和运行。我不知道为什么。它应该给出一个错误。

```
#include <iostream>
using namespace std;
int main(){
    int x=9;
    int y=6;
    //note that there is extra backslash in the end of if statement
    if(x==y)\
    {
        cout<<"x=y"<<endl;
    }
    //note that there is extra backslash in the end of if statement
    if(x!=y)\
    {
        cout<<"x!=y"<<endl;
    }
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-10-15T20:16:45.037

来自 C++ 标准：

> (C++11, 2.2p1) “每个反斜杠字符 (\) 的实例紧跟换行符被删除，拼接物理源代码行以形成逻辑源代码行。只有任何物理源代码行上的最后一个反斜杠应有资格成为这种拼接的一部分。”

C 说的完全一样：

> （C11，5.1.1.2 翻译阶段 p1）“每个反斜杠字符 (\) 的实例都被删除，紧跟一个换行符，将物理源代码行拼接成逻辑源代码行。”

所以：

```
if(x==y)\
{
    cout<<"x=y"<<endl;
} 
```

实际上相当于：

```
if(x==y){
    cout<<"x=y"<<endl;
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-15T20:16:36.347

`\`转义换行符。将在一行上`g++`读取，这不是语法错误。`if(x==y){`

# android - 使用 android.widget.Button 类作为全局变量时应用程序崩溃

> ID：12903300
> 
> 赞同：1
> 
> 时间：2012-10-15T20:16:10.000
> 
> 标签：android

我一生都无法弄清楚这一点，我已经尽可能彻底地搜索了。

我有一个这样的代码块：

```
 public class TwoPlayerGame extends Activity {
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_game);                    
}

public GameStuff game = new GameStuff();
public Player playerOne = new Player();
public Player playerTwo = new Player();

public Player[] players = {playerOne, playerTwo};

public Button cardOne=(Button)findViewById(R.id.card1);
public Button cardTwo=(Button)findViewById(R.id.card2);
public Button cardThree=(Button)findViewById(R.id.card3);
public Button cardFour=(Button)findViewById(R.id.card4);
public Button cardFive=(Button)findViewById(R.id.card5);

public Button[] buttons={cardOne, cardTwo, cardThree, cardFour, cardFive};

@Override
public void onStart(){
    super.onStart();

    for(int i=0; i<=1; i++){
        dealCards(players[i]);
    }

    for (int i = 0; i<=4; i++){
        buttons[i].setText(playerOne.cardsInHand[i]);
    }

}

} 
```

正如所写的那样，一旦 Activity 启动，它就会崩溃（如果我将 onStart 覆盖完全更改为新方法，它甚至会崩溃）。如果我将所有 Button 声明移到 onStart 方法中，一切正常，但它们不会是全局的。根据 Eclipse，如果我将它们移到 onCreate 中，它们将不是全局的，并且我会遇到无法编译的错误。

所有其他全局变量在它们所在的位置都可以正常工作，并且我需要按钮是全局的，因此我不必继续在新方法中重新声明它们。

我是否忽略了一些非常明显的东西（可能）？还有，这是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T20:19:44.397

尝试

```
 public class TwoPlayerGame extends Activity {
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_game);
        cardOne=(Button)findViewById(R.id.card1);
        cardTwo=(Button)findViewById(R.id.card2);
        cardThree=(Button)findViewById(R.id.card3);
        cardFour=(Button)findViewById(R.id.card4);
        cardFive=(Button)findViewById(R.id.card5);

    }

public GameStuff game = new GameStuff();
public Player playerOne = new Player();
public Player playerTwo = new Player();

public Player[] players = {playerOne, playerTwo};

public Button cardOne;
public Button cardTwo;
public Button cardThree;
public Button cardFour;
public Button cardFive;

public Button[] buttons={cardOne, cardTwo, cardThree, cardFour, cardFive};

@Override
public void onStart(){
    super.onStart();

    for(int i=0; i<=1; i++){
        dealCards(players[i]);
    }

    for (int i = 0; i<=4; i++){
        buttons[i].setText(playerOne.cardsInHand[i]);
    }

}

} 
```

你不能`Buttons`从`findViewById`之前的电话中得到`setContentView`。是不可能的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T20:21:34.770

你应该意识到线条

```
public Button cardOne=(Button)findViewById(R.id.card1);
... and others 
```

在创建类时调用。但这是在调用 onCreate 之前。它崩溃是因为要使用 findViewById 你需要先调用

```
setContentView(R.layout.activity_game); 
```

但它实际上是在类初始化之后调用的，因此是在 findViewById 调用之后调用的。

# java - 如何使用 Java 从 formdata 中获取有意义的数据？

> ID：12903301
> 
> 赞同：0
> 
> 时间：2012-10-15T20:16:18.377
> 
> 标签：java, servlets, multipartform-data

我有这样的表格：

```
 <form id="test" name="test" action="/pages/font/getFontTitle.jsp" method="POST" enctype="multipart/form-data">
    <div class="dialog">
      <table>
        <tbody>
          <tr class="prop"><td valign="top">Name</td><td><input type="text" name="name"></td></tr>
          <tr class="prop"><td valign="top"><input type="file" name="fname" size="62" value="" id="fname"/></td><td><span class="button"><s:submit/></span></td></tr>
        </tbody>
      </table>
    </div> 
  </form> 
```

我的 servlet 看起来像这样：

```
String contentType=request.getContentType(),Location="0.";
out.println("Done");
System.out.println("contentType = "+contentType);

  boolean isMultipart=ServletFileUpload.isMultipartContent(request);           // Check that we have a file upload request
  System.out.println("isMultipart = "+isMultipart);

  int formDataLength=request.getContentLength();                           // We are taking the length of Content type data
  byte dataBytes[]=new byte[formDataLength];
  System.out.println("dataBytes = "+dataBytes.length+"\n"+dataBytes.toString());

  java.util.Map<java.lang.String,java.lang.String[]> ParameterMap=request.getParameterMap();
  Iterator it=ParameterMap.entrySet().iterator();
  while (it.hasNext())
  {
    Map.Entry pair=(Map.Entry)it.next();
    System.out.println(pair.getKey()+" = "+(pair.getValue()).toString());
//    it.remove(); // avoids a ConcurrentModificationException
  }
  System.out.println("request = \n"+request.getParameterNames().toString());

  if (isMultipart)
  {
    FileItemFactory factory=new DiskFileItemFactory();
    ServletFileUpload upload=new ServletFileUpload(factory);
    List items=null;
Location+="1.";
    try { items=upload.parseRequest(request); }
    catch (FileUploadException e) { e.printStackTrace(); }
    Location+="2.";
    Iterator itr=items.iterator();
    Location+="3.";
    while (itr.hasNext()) 
    {
        Location+="4.";
      FileItem item=(FileItem)itr.next();
      if (item.isFormField())
      {
        String name=item.getFieldName(),value=item.getString();
        System.out.println("name = "+name+"  value = "+value);
        Location+="5.";
      }
      else
      {
        try
        {
          Location+="6.";
          String itemName=item.getName(),savedFilePath=itemName;
          File savedFile=new File(savedFilePath);
          System.out.println("savedFile = "+savedFile.getAbsolutePath());
          item.write(savedFile);
        }
        catch (Exception e) { e.printStackTrace(); }
      }
    }
  }
Location+="e.";

  out.println(" [ "+Location+" ]");
  out.flush(); 
```

我得到的结果是：

```
contentType = multipart/form-data; boundary=---------------------------15890672924370
isMultipart = true
dataBytes = 35909
[B@14d3ba9
name = [Ljava.lang.String;@187f9d7
request = 
java.util.Vector$1@23ca6e 
```

dataBytes 中有一个文件，但它从未进入 while (itr.hasNext()) 循环，jsp 输出为：Done [ 0.1.2.3.e. ] ，从未到达位置 4,5,6。

[1] 为什么？[2] 如何将“dataBytes = [B@14d3ba9”变成可读的东西或文件？[3] 如何将“name = [Ljava.lang.String;@187f9d7”转为原始字符串值？[4] 我正在使用“(pair.getValue()).toString()”，但为什么它不是可读字符串？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T22:00:04.823

客户端只会发送一次 HTTP 请求正文。

但是，您的代码试图读取请求正文两次。第一次被`getParameterMap()`调用：

```
java.util.Map<java.lang.String,java.lang.String[]> ParameterMap=request.getParameterMap(); 
```

第二次由 Apache Commons FileUpload （将面临一个空请求）：

```
try { items=upload.parseRequest(request); } 
```

这是行不通的。

仅使用标准 Servlet API 方法*或**Apache* Commons FileUpload。

 *### 也可以看看：

*   [如何使用 JSP/Servlet 将文件上传到服务器？](https://stackoverflow.com/questions/2422468/how-to-upload-files-to-server-using-jsp-servlet/2424824#2424824)- 包含 Commons FileUpload 和标准 Servlet API 方法的具体示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T20:23:38.267

使用应该使用servelt 3.0规范并相应地注释您的servlet，然后`request.getParts()`使用所有多部分数据。阅读它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T20:27:55.097

子问题 1,3,4：如果您不能使用 Servlet 3.0 中添加的文件上传功能，我认为您最好使用[Commons Fileupload](http://commons.apache.org/fileupload/using.html)，或多或少是将文件上传到 servlet 的事实标准。它功能强大，经过良好测试并且可以正常工作。

子问题 2：[ServletRequest 的 getParameterMap 的 Javadoc](http://docs.oracle.com/javaee/5/api/javax/servlet/ServletRequest.html#getParameterMap%28%29)指出：

> 返回： 一个不可变的 java.util.Map，其中包含作为键的参数名称和作为映射值的参数值。参数映射中的键是字符串类型。**参数映射中的值是字符串数组类型。**

重点补充：返回的值是字符串数组，而不是字符串。这就是为什么你会得到奇怪的输出值。尝试

```
System.out.println( pair.getKey()+" = "+ pair.getValue()[0] ); 
```

但也要考虑在你的 servlet 中使用记录器，这比在 System.out 中倾倒东西更好

ps：使用IDE中可能提供的代码格式化功能，您的代码很难阅读。*

# java - JPanel 无法正确绘制

> ID：12903306
> 
> 赞同：4
> 
> 时间：2012-10-15T20:16:43.853
> 
> 标签：java, swing, jpanel, geometry, paintcomponent

我对 Java 和 Swing 很陌生，这也是我的第一篇文章，如果没有太多意义，我很抱歉。

我想要做的是当我点击一个 JPanel 时，我希望它在我点击的地方添加一个圆圈。目前，似乎发生的只是当我单击时，我想添加到的 JPanel 内出现一个灰色的小方块，但我似乎找不到任何方法让它画成一个圆圈。

我有一个扩展 JPanel 的类，称为“Ball”，这是我单击时添加的内容。目前，我并不太担心它是否在正确的位置，只是为了它能够正确地拉球。下面是我的“球”类的代码：

```
package paintsliders;
import java.awt.Color;
import java.awt.Graphics;
import javax.swing.JPanel;

class Ball extends JPanel{

private int x,y,w,h;

//I will use this constructor to put the ball in the correct location later.
Ball(){
    /*this.w = 100;
    this.h = 100;
    this.x = 200;
    this.y = 200;*/
}

//draw the ball
    @Override
public void paintComponent(Graphics g) {
      super.paintComponent(g);
      g.drawOval(200,200,10,10);
      g.setColor(Color.RED);
    }

} 
```

我可以猜测这与 paintComponent 方法有关，但我所看到的所有地方似乎都没有适合我的解决方案。

任何帮助都会很棒，谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-15T20:26:37.460

上下文已经被翻译成满足组件应该出现在其父容器中的x/y 位置，这意味着方法中上下文的`Graphcis`左上角实际上是 0x0。`Graphics``paintComponent`

您需要为球定义一些尺寸，您正在以 10x10 进行绘制，这表明您的球组件应返回`preferredSize`10x10的 a

```
public Dimension getPreferredSize() {
    return new Dimension(10, 10);
} 
```

当球添加到父容器时，您将负责为球提供适当的布局细节......

```
public void mouseClicked(MouseEvent evt) {
    Point p = evt.getPoint();
    Ball ball = new Ball();
    Dimension size = ball.getPreferredSize();
    ball.setBounds(new Rectangle(p, size));
    add(ball);
} 
```

当然，这假设您`null`为父容器设置了布局

**更新**

就像是...

![见现场跑](../Images/f7cdef7a3ed3f6b6610bd224859d0a15.png)

```
public class PaintBalls {

    public static void main(String[] args) {
        new PaintBalls();
    }

    public PaintBalls() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException ex) {
                } catch (InstantiationException ex) {
                } catch (IllegalAccessException ex) {
                } catch (UnsupportedLookAndFeelException ex) {
                }

                JFrame frame = new JFrame();
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new Board());
                frame.setSize(200, 200);
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    public class Board extends JPanel {

        public Board() {
            setLayout(null);
            setBackground(Color.WHITE);
            addMouseListener(new MouseAdapter() {

                @Override
                public void mouseClicked(MouseEvent e) {
                    Point p = e.getPoint();
                    Ball ball = new Ball();
                    Dimension size = ball.getPreferredSize();
                    p.x -= size.width / 2;
                    p.y -= size.height / 2;

                    ball.setBounds(new Rectangle(p, size));
                    add(ball);
                    repaint();
                }

            });
        }

    }

    public class Ball extends JPanel {

        public Ball() {
            setOpaque(false);
        }

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(10, 10);
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);
            Graphics2D g2d = (Graphics2D) g.create();
            g2d.setColor(Color.RED);
            g2d.fillOval(0, 0, 10, 10);
            g2d.dispose();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-15T20:22:45.603

您可能有一个主要的`JPanel`单击位置。

我宁愿将主面板设计为处理鼠标单击，并将`Ball`该类设计为一个简单的类，该类`Object`定义了一个`drawBall(Graphics g, int x, int y)`知道如何绘制`Ball`. 这将由`paintComponent()`主面板中的方法调用。在主面板中，您处理鼠标单击、创建类型对象`Ball`并调用`repaint()`. 里面`paintComponent()`你打电话`ball.drawBall()`。

# excel - 根据值在 Excel 电子表格中放置“是”或“否”

> ID：12903318
> 
> 赞同：1
> 
> 时间：2012-10-15T20:17:30.283
> 
> 标签：excel, powershell, powershell-2.0

提前致谢！

这是代码：我想收集以下变量的值...

```
 $Sheet3.Cells.Item($intRowDisk, 4) = $objItem.Size/1024/1024/1024 - $objItem.FreeSpace/1024/1024/1024 
```

然后我想比较该值，如果它大于 100 GB，则在 excel 电子表格的列中放置一个值是或否。

```
 if ( $Sheet3.Cells.Item($intRowDisk, 4) -gt 100 ) {
            $Sheet1.Cells.Item($intRow, 12) = write "Yes" 
```

但是我收到以下错误：错误：运算符'-gt'的错误参数：无法将“System.__ComObject”与“100”进行比较。错误：“无法将“System.Int32”类型的“100”值转换为“System.Int32”类型。错误：__ComObject"。"。IME_InventoryV1.8.ps1 (124): 错误: At Line: 124 char: 49 错误: + if ($Sheet3.Cells.Item($intRowDisk, 4) -gt <<<< 100) { 错误: + CategoryInfo: InvalidOperation : (:) []，RuntimeException 错误：+ FullyQualifiedErrorId：BadOperatorArgument

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T20:33:12.430

为什么你`write "Yes"`的 if 块里面有？简单地分配“是”不起作用吗？

`write`是[Write-Object](http://technet.microsoft.com/library/hh849921.aspx) cmdlet 的别名，它将内容放在管道上以供下一个命令使用。在这种情况下，它可能不是您想要使用的。尝试仅分配字符串`"Yes"`，看看是否可以解决您的问题。

此外，在您的比较中 - 虽然不是特别有用，但 PowerShell 告诉您无法比较 COM 对象和值 100。您需要包含一个调用以实际从 COM 对象中获取值以进行比较，方法是包含表达式末尾的方法调用**Value() ：**

```
$Sheet3.Cells.Item($intRowDisk, 4).Value() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T22:40:09.130

我想到了。我必须添加一个变量，然后将该变量提供给 if 语句。它现在就像一个魅力。

```
$Sheet3.Cells.Item($intRowDisk, 4) = $objItem.Size/1024/1024/1024 - $objItem.FreeSpace/1024/1024/1024   

        $valueforif = $objItem.Size/1024/1024/1024 - $objItem.FreeSpace/1024/1024/1024

        if ( $valueforif -gt 100 )
                    {
            $Sheet1.Cells.Item($intRow, 12) = "Yes"
        } 
```

# python - 令人费解的python索引错误

> ID：12903320
> 
> 赞同：2
> 
> 时间：2012-10-15T20:17:51.720
> 
> 标签：python, python-2.7

这是一段python代码（“结果”是之前创建的嵌套列表）

```
for i in range(len(result)-1):
    try:
        result[i][3]=0
        result[i+i][0]=0
    except IndexError:
        print "fail", result[i][3], result[i+1][0], i, len(result)
return result 
```

令我惊讶的是，它经常打印“失败”（i, len(result) 的值不显示，例如 24、31）。怎么能

```
result[i][3]=0
result[i+i][0]=0 
```

产生 IndexError 异常，如果

```
print result[i][3], result[i+1][0] 
```

才不是？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-15T20:18:49.967

您正在访问索引`i + i`，*而不是* `i + 1`：

```
result[i+i][0]=0 
```

这意味着当您到达`i // 2 + 1`时，无论您的列表大小如何，都会出现索引错误。

# symfony - Symfony2 - 查询生成器 LIKE 空值

> ID：12903324
> 
> 赞同：4
> 
> 时间：2012-10-15T20:18:15.117
> 
> 标签：symfony, null, doctrine, query-builder

我正在尝试构建一个动态查询来响应用户的自定义搜索。我有一个问题：当我构建查询时，我没有结果，因为 SELECT LIKE 列比较不适用于 NULL 值。考虑到查询是动态构建的，我该如何解决这个问题？因此，用户可以给值或不给搜索条件...

这是我的代码：

```
$qb->add('select', 'f')
   ->add('from', 'Bundle:Object f')
   ->add('where', $qb->expr()->andx(
            $qb->expr()->like('f.c1',':c1'),
            $qb->expr()->like('f.c2',':c2'),
            $qb->expr()->like('f.c3',':c3')))
   ->add('orderBy', 'f.nnumCatalogo ASC');
if ($data->getField1() != null) {
  $isField1 = true;
}
if ($data->getField2() != null) {
  $isField2 = true;
}
if ($data->getField3() != null) {
  $isField3 = true;
}
if ($isField1) {
  $qb->setParameter('c1', $data->getField1());
} else {
  $qb->setParameter('c1', '%');
}
if ($isField2) {
  $qb->setParameter('c2', $data->getField2());
} else {
  $qb->setParameter('c2', '%');
}
if ($isField3) {
  $qb->setParameter('c3', $data->getField3());
} else {
  $qb->setParameter('c3', '%');
} 
```

使用此代码，我没有结果，因为某些列中的 NULL 值未使用 LIKE '%' (mysql) 选择。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T21:34:59.900

尝试这个：

```
$qb->add('select', 'f')->add('from', 'Bundle:Object f');
if ($data->getField1() != null) {
    $qb->andWhere('f.c1 like :c1')
    ->setParameter('c1', $data->getField1());
}
if ($data->getField2() != null) {
    $qb->andWhere('f.c2 like :c2')
    ->setParameter('c2', $data->getField2());
}
if ($data->getField3() != null) {
    $qb->andWhere('f.c3 like :c3')
    ->setParameter('c3', $data->getField3());
}
$qb->add('orderBy', 'f.nnumCatalogo ASC'); 
```

# java - HttpPost 转义参数

> ID：12903330
> 
> 赞同：1
> 
> 时间：2012-10-15T20:18:41.293
> 
> 标签：java, post, httpclient

我正在尝试使用 HttpClient(HttpComponents) 制作 HttpPost。这是我的代码：

```
try{
            DefaultHttpClient httpClient = new DefaultHttpClient();
            HttpPost post = new HttpPost(
                "https://accounts.google.com/o/oauth2/token");
            post.addHeader("accept", "application/json");
            post.addHeader("Content-Type", "application/json");

            List<NameValuePair> nvps = new ArrayList<NameValuePair>();
            nvps.add(new BasicNameValuePair("code", new String(code.getBytes(), Charset.forName("UTF-8"))));
            nvps.add(new BasicNameValuePair("client_id", "googleClientId"));
            nvps.add(new BasicNameValuePair("redirect_uri", "http://localhost:8080/myapp/test"));
            nvps.add(new BasicNameValuePair("client_secret", "ClientSecret"));
            nvps.add(new BasicNameValuePair("grant_type", "authorization_code"));
            post.setEntity(new UrlEncodedFormEntity(nvps, HTTP.UTF_8));

            HttpResponse resp = httpClient.execute(post);

            if (resp.getStatusLine().getStatusCode() != 200) {
                throw new RuntimeException("Failed : HTTP error code : "
                   + resp.getStatusLine().getStatusCode());
            }

            BufferedReader br = new BufferedReader(
                             new InputStreamReader((resp.getEntity().getContent())));

            String output;
            System.out.println("Output from Server .... \n");
            while ((output = br.readLine()) != null) {
                System.out.println(output);
                res = res + output;
            }
            System.out.println(output);
            httpClient.getConnectionManager().shutdown();
            } catch(Exception e){
                e.printStackTrace();
            }
            System.out.println(res); 
```

我得到一个`400`代码。我怀疑这是因为我设置的所有参数都包含特殊字符，比如`_ . and /`它们被转义了。我怎样才能避免这种情况？还是我错过了真正的问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T20:27:41.063

不应该是 http 标头“Content-Type”，`application/x-www-form-urlencoded`因为您对 post 参数进行了明确的 URL 编码？

# javascript - 单击更改多个图像

> ID：12903331
> 
> 赞同：0
> 
> 时间：2012-10-15T20:18:41.680
> 
> 标签：javascript, jquery, html, css

我有 6 张图片。当它们翻滚时，使用 css hover 更改图像。单击图像时，会出现原始图像（再次使用 css），但我希望其余图像在选择一个时变暗。我一直在研究各种 JS 选项，但似乎无法让它工作。有没有人有什么建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T20:32:59.890

另一种解决方案是向所选图像和图像父级添加一个类。这使得维护更容易，因为样式都是在 css 中完成的。

这里的快速示例：

css

```
.img{
    display:inline-block;
    height:40px;
    width:40px;
    border:1px solid black;
}

.clicked .img{
    opacity:0.3;
}

.clicked .img.selected{
    opacity:1;
    background:red;
} 
```

js

```
​
$('.img').on('click', function() {
    $('.img').removeClass('selected');
    $(this).addClass('selected');
    $('.container').addClass('clicked');
})​ 
```

html

```
<div class="container">
    <div class="img">img</div>
    <div class="img">img</div>
    <div class="img">img</div>
    <div class="img">img</div>
    <div class="img">img</div>
    <div class="img">img</div>
</div>​ 
```

[http://jsfiddle.net/renekoch/y6YCc/](http://jsfiddle.net/renekoch/y6YCc/)

# angularjs - AngularJS 依赖注入 module.config 中的值

> ID：12903338
> 
> 赞同：29
> 
> 时间：2012-10-15T20:19:17.343
> 
> 标签：angularjs

尝试为模块设置一些助手值。尝试了服务和价值，但没有帮助：

```
var finance = angular.module('finance', ['finance.services'])
    .value("helpers", {
        templatePath: function (name) {
            return '/areas/scripts/finance/templates/' + name + '/index.html';
        }
    })
    .config(['$routeProvider', 'helpers', function ($routeProvider, helpers) {
    $routeProvider.
        when('/', {
            templateUrl: helpers.getTemplatePath('dashboard'),
            controller: DashboardController
        })            
        .when('/people', {
            templateUrl: '/areas/scripts/app/people/index.html',
            controller: PeopleController
        })
        .otherwise({
            redirectTo: '/dashboard'
        });
}]); 
```

我做错了什么？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-10-15T20:32:24.290

问题是您试图`helpers`在 AngularJS 模块的配置块中注入一个值对象，这是不允许的。您只能在配置块中注入常量和提供程序。

AngularJS[文档](http://docs.angularjs.org/guide/module)（部分：“模块加载和依赖项”）对此进行了深入了解：

> 模块是在引导过程中应用于应用程序的配置和运行块的集合。该模块最简单的形式由两种块的集合组成：
> 
> **配置块**- 在提供者注册和配置阶段执行。只有提供者和常量可以注入到配置块中。这是为了防止在完全配置之前意外实例化服务。
> 
> **运行块**- 在创建注入器后执行并用于启动应用程序。只有实例和常量可以注入运行块。这是为了防止在应用程序运行时进行进一步的系统配置。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-12-23T17:42:50.287

而不是`.value`你可以使用`.constant`. 然后您可以`.config`部分使用您的服务。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-01-25T22:48:12.553

您的辅助方法被调用`templatePath`，并且您在内部调用它`.config`as `getTemplatePath`。不应该是：

```
when('/', {
            templateUrl: helpers.templatePath('dashboard'),
            controller: DashboardController
     }) 
```

# list - 为列表中的参数添加额外的括号

> ID：12903340
> 
> 赞同：0
> 
> 时间：2012-10-15T20:19:24.710
> 
> 标签：list, lisp

大家好，我正在尝试连接一个列表并返回带有额外括号的第一个值，例如，当我调用函数时，`(bracket-head '(a b c)) => ( (A) B C ).` 我已经完成它以在我调用函数时给出结果`'('(a) b c)`。所以这是我的代码：

```
(defun bracket-head (list)
    (append (first list) (rest list)) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:28:05.993

首先，`()`是括号，而不是括号。

接下来，“额外的括号”意味着您将对象包装在列表中：

```
[5]> (list 1)
(1)
[6]> (list *)
((1))
[7]> (list *)
(((1)))
[8]> (list *)
((((1))))
[9]> (list *)
(((((1))))) 
```

因此，您需要做的是

```
[13]> (defparameter list (list 1 2 3))
LIST
[14]> (setf (first list) (list (first list)))
(1)
[15]> list
((1) 2 3) 
```

或者，如果您不想就地修改列表：

```
[17]> (defparameter list (list 1 2 3))
LIST
[18]> (cons (list (first list)) (rest list))
((1) 2 3)
[19]> list
(1 2 3) 
```

# .net - Directory.GetFiles 返回重复的文件名

> ID：12903341
> 
> 赞同：4
> 
> 时间：2012-10-15T20:19:25.957
> 
> 标签：.net, directory

我正在运行`System.IO.Directory.GetFiles("my_directory_name_on_network")`，目录中的大多数文件都很好`11320`，但其中一个文件存在两次。有没有人遇到过这个？知道这意味着什么吗？当我在 Windows 资源管理器中查看时，肯定似乎只有一个文件。

**更新**

最终，我也能够在 Windows 资源管理器中看到该问题。相同的文件名在此处列出两次。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-02-09T15:21:00.753

我有同样的问题。我正在遍历本地硬盘上的 Word 文档并执行一些自动化操作，而不是保存文件，只是读取它们。

我有一些文件是`*.doc`和一些是`*.docx`. 我用了

> GetFiles("*.doc");
> 
> GetFiles("*.docx");

处理所有文件。然而，问题在于

> GetFiles("*.doc");

还可以找到`\*.docx`文件，因此 .docx 文件被找到了两次。

使用这样的东西：

```
var strFileList = Directory.GetFiles(strDrvPth, strExtn).Where(s => s.EndsWith(strExtn.Substring(1))); 
```

从扩展规范中`Substring(1)`删除“*”。

# jquery - 将事件数据传递给从 Web API 作为 JSON 接收的 jQuery 周历

> ID：12903342
> 
> 赞同：1
> 
> 时间：2012-10-15T20:19:30.690
> 
> 标签：jquery, json, datetime, asp.net-web-api

我使用[jQuery Week Calender](https://github.com/themouette/jquery-week-calendar)、 Asp.net Web API 作为服务器端和 Sql 服务器作为后端。

**到目前为止我根据演示所做的所有工作，但演示具有静态 JSON 数据，这里我需要从服务器检索数据。**

几乎所有其他事情都清楚并且工作正常，但是从服务器加载事件数据并传递到日历存在问题，这是我从服务器得到的响应。

```
[{"id":13,"title":"Event Name","body":"Content","start":"2012-10-16T03:30:00.00","end":"2012-10-16T06:30:00.00","typeEvnt":1},{"id":14,"title":"dfgfdg","body":"gdfgdfg","start":"2012-10-15T04:15:00.00","end":"2012-10-15T06:45:00.00","typeEvnt":1}] 
```

日期时间为 GMT 格式，需要转换为当地时区，然后添加到日历中。

这是我将其添加到日历中的操作：

```
$.ajax({
                url: '/api/api/event/load',
                type: 'get',
                statusCode: {
                    200: function (data) {
                        var dataString = JSON.stringify( data);   

                        callback( {events : dataString} );
}); 
```

但是我在 chrome 中遇到了一个错误，说**Uncaught TypeError: Cannot call method 'getTime' of undefined**我很确定这与日期转换有关。

在此错误之后，日历不会加载事件。

这里有几点，不是很清楚：

1.  服务器应将数据发送到浏览器的日期时间格式。
2.  如何将其转换为本地时区并传递给日历。
3.  C#.net 中的服务器端代码用于以所需格式格式化日期时间。

总之，我需要从服务器检索 DateTime 数据并将其转换为本地时区，然后将其添加到 jQuery Week Calender 的方法。

**任何建议或线索都会有所帮助或 MVC 演示。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T22:31:56.880

首先，您在`$.ajax`上面的调用中缺少一些右括号。

另请注意，使用`success:`设置而不是`statusCode: { 200:`...等更常见。

查看 JQuery Week Calendar 站点上的演示，它需要 JavaScript Date 对象用于每个事件的开始和结束字段。JSON 不会自动将这些字段转换为日期，因此您需要所谓的 reviver 函数来执行此操作。您还希望文本以`text`格式返回，以便您可以使用 JSON 解析而不是 JQuery 的 JSON 解析器对其进行解析。

下面的`dateReviver`函数以 ISO 8601 日期格式解析日期，我相信这是您正在寻找的。取自：礼貌：[如何使用 Windows 8 JSON.parse 将 JSON 文本反序列化为日期类型？](https://stackoverflow.com/questions/12354702/how-to-deserialize-json-text-into-a-date-type-using-windows-8-json-parse)：

```
function dateReviver(value) {
  if (typeof value === 'string') {
    var re = /^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)$/
    var result = re.exec(value);
    if (result) {
        return new Date(Date.UTC(+result[1], +result[2] - 1, +result[3], +result[4],+result[5], +result[6]));
    }
  }
  return value;
} 
```

ajax 函数调用 JSON 解析，后者又使用 dateReviver 函数转换其中的任何日期字符串。

```
$.ajax({
  url: '/api/api/event/load',
  type: 'get',
  dataType: text,
  success: function(data) {
      var eventArray = JSON.parse(data, dateReviver);
      callback({events: eventArray});
  }
}); 
```

# java - 如何将类对象从一个控制器传递到另一个

> ID：12903343
> 
> 赞同：0
> 
> 时间：2012-10-15T20:19:30.527
> 
> 标签：java, spring, model-view-controller

第一个控制器通过jsp绑定从TestClass类中获取对象

```
protected ModelAndView onSubmit(HttpServletRequest request,
        HttpServletResponse response,
        BindException errors, TestClass test)
        throws Exception {

    ModelAndView mv = new ModelAndView("page.jsp", "modelObject", test);

    return mv;
} 
```

并且正在处理第二个，他只获取对象并传回其他jsp页面

```
protected Test showForm(HttpServletRequest request,
        HttpServletResponse response,
        BindException errors, TestClass test)
        throws Exception {

    return test;
} 
```

这个问题的另一种解决方案或更好的方法你能给它吗？

# reporting-services - 新行中的 SSRS 图表

> ID：12903349
> 
> 赞同：0
> 
> 时间：2012-10-15T20:19:57.443
> 
> 标签：reporting-services, sql-server-2008-r2

我总共有 20 个图表。当我在报告中显示它们时，它会水平显示 20 个报告。我想连续显示 5 个。如何使用 SSRS 分组来实现这一点。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T05:36:18.647

我过去用过[这个](http://beyondrelational.com/modules/2/blogs/65/posts/11568/better-way-of-repeating-charts-based-on-parameters.aspx)。

这是一篇名为`"Better way of repeating charts based on parameters"`

# c# - EF Code First 不同的解决方案/项目相同的数据库

> ID：12903350
> 
> 赞同：1
> 
> 时间：2012-10-15T20:20:04.023
> 
> 标签：c#, asp.net-mvc, entity-framework

我有 2 个使用 Code First 的不同 MVC 解决方案（Web 应用程序）。这两个应用程序的目标是同一个数据库。当我开始我的第二个应用程序时，我最初遇到了一些关于无法将更改应用到数据库的错误（不记得它们到底是什么）。我终于设法生成了脚本

```
update-database -Script 
```

并在数据库上运行它并且它工作。但是我大约一周没有意识到的是，我的另一个应用程序首先使用代码并与同一个数据库通信，但不同的表停止工作。当我尝试编译它来调试我遇到的问题和错误时，这几乎意味着以下内容： **支持上下文已更改，这些更改需要推送到数据库（更新数据库）** 但是当我尝试更新数据库时，它没有说没有迁移。

我的两个应用程序都是针对 Visual Studio 2012 中的 .Net 4.0 的 MVC3 应用程序。

有关如何解决这种情况的任何提示？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T21:05:39.237

不幸的是，在 EF5 中，迁移是单租户的。如果您想使用相同的数据库，您必须关闭迁移并检查数据库是否与您的模型同步，或者在两个应用程序中使用相同的模型。这已在 EF6 中解决 - 这是 EF6 中的多租户迁移规范[http://entityframework.codeplex.com/wikipage?title=Multi-tenant%20Migrations](http://entityframework.codeplex.com/wikipage?title=Multi-tenant%20Migrations)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T20:23:58.300

您可以将当前正在运行的应用程序中的代码优先逻辑重构为公共程序集，并从两个项目中引用新程序集。

# properties - 支持无状态对象、参数和返回值的有状态对象、属性和无参数方法

> ID：12903354
> 
> 赞同：0
> 
> 时间：2012-10-15T20:20:34.400
> 
> 标签：properties, parameters, return-value, stateless, stateful

我觉得这个类定义有点奇怪： [http ://www.extremeoptimization.com/Documentation/Reference/Extreme.Mathematics.LinearAlgebra.SingleLeastSquaresSolver_Members.aspx](http://www.extremeoptimization.com/Documentation/Reference/Extreme.Mathematics.LinearAlgebra.SingleLeastSquaresSolver_Members.aspx)

Solve 方法确实有一个返回值，但不需要，因为结果也可以在 Solution 属性中使用。

这是我认为的传统代码：

```
var sqrt2 = Math.Sqrt(2) 
```

这将是与链接中的求解器具有相同精神的替代方案：

```
var sqrtCalculator = new SqrtCalculator();
sqrtCalculator.Parameter = 2;
sqrtCalculator.Run();
var sqrt2 = sqrtCalculator.Result; 
```

除了第二个版本有点“非传统”之外，还有什么优点和缺点？

是的，编译器不会帮助忘记分配某些属性（参数）的用户，但是所有包含可写属性并且在构造函数中没有强制值的组件都是这种情况。

是的，线程不起作用，但是每个线程都可以创建自己的求解器。

是的，垃圾收集器将无法处理求解器的结果，但是如果整个求解器都被处理掉了，它就会处理掉。

是的，编译器和处理器对参数和返回值进行了特殊处理，这使得它们速度很快，但是参数处理的时间几乎可以忽略不计。

等等。其他想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-30T17:12:29.560

好吧，一年后，我发现这种“内向”的方法有一个明显的缺陷。我正在使用一个现有的过滤器对象，它应该对测量对象进行操作，而是以上述“只有我，没有别的”的方式对自身进行操作。现在客户想要在第一次计算几分钟后重新计算一个测量对象，同时过滤器已经处理了其他测量对象。如果它是无状态的并将其数据存储在测量对象中，那么实现 Recalculate 方法将是一件容易的事。解决内向过滤器问题的唯一方法是让过滤器实例成为测量对象的一部分。然后需要为每个新的测量对象实例化过滤器。由于过滤器是链的一部分，因此需要重新创建整个链。

# c - C反向二进制

> ID：12903359
> 
> 赞同：4
> 
> 时间：2012-10-15T20:20:50.430
> 
> 标签：c, binary, binary-operators

> **可能重复：**
> [无符号整数中的 C 反转位](https://stackoverflow.com/questions/9144800/c-reverse-bits-in-unsigned-integer)

如何仅使用二进制运算符反转二进制数？

例如：

```
11100000 -> 00000111
00110100 -> 00101100
00111111 -> 11111100 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-15T20:24:36.817

对于这类事情，我建议您查看很棒的页面[Bit Twiddling Hacks](http://graphics.stanford.edu/~seander/bithacks.html#ReverseByteWith64BitsDiv)。

这只是从该页面获取的一个示例解决方案：

> **使用 3 次操作（64 位乘法和模除法）反转字节中的位**
> 
> ```
> unsigned char b; // reverse this (8-bit) byte 
> b = (b * 0x0202020202ULL & 0x010884422010ULL) % 1023; 
> ```

正如评论中所指出的，这是另一种选择：

> **在 5 * lg(N) 次操作中并行反转 N 位数量**
> 
> ```
> unsigned int v; // 32-bit word to reverse bit order
> 
> // swap odd and even bits
> v = ((v >> 1) & 0x55555555) | ((v & 0x55555555) << 1);
> // swap consecutive pairs
> v = ((v >> 2) & 0x33333333) | ((v & 0x33333333) << 2);
> // swap nibbles ... 
> v = ((v >> 4) & 0x0F0F0F0F) | ((v & 0x0F0F0F0F) << 4);
> // swap bytes
> v = ((v >> 8) & 0x00FF00FF) | ((v & 0x00FF00FF) << 8);
> // swap 2-byte long pairs
> v = ( v >> 16             ) | ( v               << 16); 
> ```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-15T20:24:01.200

看看[Bit Twiddling Hacks](http://graphics.stanford.edu/~seander/bithacks.html?1=1#BitReverseObvious)。有一整节是关于反转位序列的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-15T20:23:55.790

你可以看到这个网站[http://graphics.stanford.edu/~seander/bithacks.html](http://graphics.stanford.edu/~seander/bithacks.html)

反转位序列
反转位 显而易见的方式
通过查找表
反转字中的位 使用 3 次操作（64 位乘法和模除法）
反转字节中的位 使用 4 次操作（64 位乘法，无除法）反转字节中的位)
用 7 次操作反转字节中的位（没有 64 位，只有 32 次）
用 5 * lg(N) 操作并行反转 N 位数量

# c# - OraOLEDB.Oracle 提供程序未在本地计算机上注册

> ID：12903366
> 
> 赞同：40
> 
> 时间：2012-10-15T20:21:16.163
> 
> 标签：c#, .net, windows, oracle

我刚从 XP 迁移到 Win 7。我猜这个错误与切换操作系统有关。我编写了一个 .net 应用程序，它基本上处理大量数据，然后连接到数据库并插入/更新表。

当我点击一个按钮连接到数据库时，我遇到了关于没有在我的本地机器上注册 oracle 提供程序的错误。

非常感谢我如何快速解决此问题的清晰分步大纲。

确切的错误信息是：

> 'OraOLEDB.Oracle.1' 提供程序未在本地计算机上注册

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-11-02T17:27:35.433

在 Windows 7 64 位上安装 64 位 Oracle 客户端后，我遇到了同样的问题。对我有用的解决方案：

1.  在管理员模式下打开命令提示符
2.  `cd \oracle\product\11.2.0\client_64\BIN`
3.  `c:\Windows\system32\regsvr32.exe OraOLEDB11.dll`

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2016-03-07T13:19:30.333

我在使用 IIS 时遇到了同样的问题。

确保在应用程序池的高级配置中将“启用 32 位应用程序”选项设置为**true**。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-12-14T18:31:29.103

Do the following test:

Open a Command Prompt and type: tnsping instance_name

where instance_name is the name of the instance you want to connect (if it's a XE database, use "tnsping xe"

If it returns ok, follow steps of Der Wolf's answer. If doesn't return ok, follow steps of Annjawn's answer.

It solved for me in both cases.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-10-15T20:56:33.117

1.  右键单击我的电脑
2.  点击属性
3.  点击高级系统设置
4.  单击“环境变量”按钮。
5.  在系统变量部分找到“PATH”变量
6.  编辑“PATH”变量并向其添加 Oracle 安装路径（从您的本地计算机），如`;C:\oracle\product\10.2.0\client_1\bin`

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-08-29T17:46:09.090

如果您有 Windows 64 位，请尝试先安装 oracle 驱动程序 32 位，然后再安装 64 位驱动程序，这就是我所做的并且正在工作

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-01-15T14:46:15.530

它仅在我将“平台目标”更改为“x64”后才对我有用（考虑到我使用的是 Oracle 12c 64 位）

为此，我做了：

1.  右键单击项目名称（在解决方案资源管理器面板中，通常位于左侧）

2.  单击“构建”（在新打开的窗口中）

3.  将“平台目标”从“任何 CPU”更改为“x64”

这解决了问题。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-09-14T19:47:14.403

我遇到了同样的问题，但我的解决方案是将平台目标保持为 Any CPU 和 UNCHECK Prefer 32-bit 复选框。在我取消选中它后，我能够打开与提供商的连接。

[![关闭首选 32 位](../Images/993e3b4d969d74b62fe70006ec44a161.png)](https://i.stack.imgur.com/mJ8En.png)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-11-21T11:59:52.197

花了几个小时来解决这个问题；对于一些安装不正确的人，您需要卸载当前版本并以管理员身份重新安装[![在此处输入图像描述](../Images/afb4f984e5263717bb10293ff14053dc.png)](https://i.stack.imgur.com/WfHi5.gif)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2021-06-22T08:31:28.573

只需检查您安装驱动程序的**架构**

在 32 和 64（单独的实例）中打开 Powershell 并启动：

```
# OLEDB-drivers
(New-Object System.Data.OleDb.OleDbEnumerator).GetElements() | select SOURCES_NAME, SOURCES_DESCRIPTION

# ODBC-drivers
Get-OdbcDriver | select Name,Platform 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-07-11T14:40:41.077

如果您在 C# 项目中获得此功能，请使用以下代码检查您是在 64 位还是 32 位模式下运行：

```
 if (IntPtr.Size == 4)
        {
            Console.WriteLine("This is 32-Bit!");
        }
        else if (IntPtr.Size == 8)
        {
            Console.WriteLine("This is 64 Bit!");
        } 
```

如果您发现您在 64 位模式下运行，您可能想尝试切换到 32 位（反之亦然）。您可以[按照本指南](https://lostechies.com/gabrielschenker/2009/10/21/force-net-application-to-run-in-32bit-process-on-64bit-os/)强制您的应用程序以 64 位或 32 位（分别为 X64 和 X86）运行。您必须确保`Platform Target`在您的项目中的属性未设置为`Any CPU`并且已明确设置。

[![在此处输入图像描述](../Images/e329a0ebd9c51de35caa7fe22f984ada.png)](https://i.stack.imgur.com/spNZF.jpg)

将该选项从切换`Any CPU`到`X86`解决我的错误，我能够连接到 Oracle 提供程序。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-10-02T10:08:09.593

我的团队会时不时地在我们尝试安装我们平台的随机机器中偶然发现这个问题（我们使用 oracle 驱动程序 12c 版本 12.2.0.4，但我们在其他版本中也遇到了这个错误）

经过相当多的实验，我们意识到出了什么问题：

所述机器将具有正在使用机器范围的 Oracle 驱动程序的应用程序，它们会静默地锁定它们，并阻止 Oracle 驱动程序安装程序在尝试升级/重新安装所述 Oracle 驱动程序时发挥其魔力。最狡猾的“应用程序”将是在 IIS 等中运行的网站，因为这些应用程序本质上是在重新启动时自动启动。为了解决这个问题，我们执行以下操作：

1.  禁止 IIS 在重新启动时自动启动。对在重新启动时自动启动的任何其他应用程序/服务执行相同的操作。
2.  卸载任何以前的 Oracle 驱动程序并仔细检查注册表或文件夹中是否没有留下任何痕迹。
3.  重启机器
4.  （重新）安装 Oracle 驱动程序并重新启用 IIS 和其他自动启动应用程序。
5.  重新启动机器 <- 这很重要。除非您重新启动计算机，否则 Oracle 的 OLE DB 驱动程序将无法工作。

如果这不起作用，则重复冲洗，直到 OLE DB 驱动程序工作。希望这可以帮助那些努力弄清楚发生了什么的人。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-04-17T14:08:28.880

在 Der Wolfs 提示的基础上，我卸载了 Oracle 客户端并再次安装，右键单击安装程序，并**以管理员身份运行它**。有效。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-12-11T13:26:03.700

如果无法更改编译使用 x64，请尝试卸载 x64 版本的 odac 并安装 32 位版本。然后，不要忘记将安装目录（如 C:\oracle）和子目录 C:\oracle\bin 添加到 PATH 环境变量中。这在 .net 4 应用程序中对我有用。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-08-09T07:54:33.720

不要忘记以管理员身份运行您的 cmd，否则您将收到误导性错误消息：

> 模块“OraOLEDB12.dll”可能与您运行的 Windows 版本不兼容。检查模块是否与 regsvr32.exe 的 x86（32 位）或 x64（64 位）版本兼容

# python - 任意维度的numpy数组切片

> ID：12903367
> 
> 赞同：3
> 
> 时间：2012-10-15T20:21:17.973
> 
> 标签：python, numpy, dimension

假设我创建了一个任意维度 (n) 的数组。

```
#assign the dimension

>>> n=22

#create the numpy array

>>> TheArray=zeros([2]*n)

>>> shape(TheArray)

(2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2) 
```

有一些代码（在此示例中跳过）来填充数组的值。

现在，尝试访问数组的一些值

```
>>> TheArray[0:2,0:2,0:2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]

array([[[ 0.,  0.],
        [ 0.,  0.]],

       [[ 0.,  0.],
        [ 0.,  0.]]]) 
```

如何使`0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0`部分语法泛化到n？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:34:17.500

一种方法是使用[numpy.s_](http://docs.scipy.org/doc/numpy/reference/generated/numpy.s_.html)：

```
In [55]: m = arange(2**6).reshape([2]*6)

In [56]: m.shape
Out[56]: (2, 2, 2, 2, 2, 2)

In [57]: m[:2,:2,:2,0,0,0]
Out[57]: 
array([[[ 0,  8],
        [16, 24]],

       [[32, 40],
        [48, 56]]])

In [58]: m[s_[:2, :2, :2] + (0,)*(n-3)]
Out[58]: 
array([[[ 0,  8],
        [16, 24]],

       [[32, 40],
        [48, 56]]]) 
```

而且我想你可以摆脱硬编码的 -3 ..

```
In [69]: m[(s_[:2, :2, :2] + (0,)*m.ndim)[:m.ndim]]
Out[69]: 
array([[[ 0,  8],
        [16, 24]],

       [[32, 40],
        [48, 56]]]) 
```

但老实说，如果我需要的话，我可能会把它包装在一个函数中。

# r - 从 R 中文本字符串的第一个近似匹配中提取信息（并对匹配的总数求和）

> ID：12903368
> 
> 赞同：3
> 
> 时间：2012-10-15T20:21:24.677
> 
> 标签：r, sum, matching, fuzzy, approximate

我无法对文本字符串的近似匹配求和，以及从第一次匹配的字符串中提取信息。

我有看起来像这样的数据：

```
text<-c("THEN it goes West","AT it falls East","it goes West", "it falls East", "AT it goes West")
date<-c(2008,2009,2003,2006,2011)
ID<-c(1,2,3,4,5)
data<-cbind(text,date,ID)
data<-as.data.frame(data) 
```

请注意，最新的文本字符串在较早的文本字符串中添加了全大写“THEN”和“AT”。

我想要一个看起来像这样的表：

```
 ID  Sum Originaltext     Originaldate
[1,] "4" "3" "it goes West"      "2003"      
[2,] "2" "2" "it falls East"     "2006" 
```

这包括：

与最早日期的文本对应的**ID**号（其他文本源自的“原始”文本）。 **每个**的所有近似匹配的总和。与最早日期对应的**文本。**并且文本的**日期**与最早的日期相对应。

我有数千万个案例，所以我在自动化流程时遇到了麻烦。

我运行 Windows 7，并且可以访问快速计算服务器。

**想法**

```
#order them backwards in time
data<-data[order(data$date, decreasing = TRUE),]

#find the strings with the latest date

pattern<-"AT|THEN"

k <- vector("list", length(data$text))

 for (j in 1:length(data$text)){
     k[[j]]<- grep(pattern,data$text[[j]], ignore.case=FALSE)
}

k<-subset(data$text, k==1)

k<-unique(k)

#this is a problem, because case nos. 1 and 5 are still in the dataset, but they derive from the same tweet. 
```

从这里，我可以使用“agrep”，但我不确定在什么情况下。任何帮助将不胜感激！

注意：虽然下面的三个答案确实以我最初提出的方式回答了我的问题，但我没有提到即使没有“AT”和“THEN”这两个词，我的文本案例也会有所不同。事实上，它们中的大多数并不完全匹配。我应该把它放在原来的问题中。但是，我仍然希望得到一个答案。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T23:28:05.097

一种`data.table`避免`stringr`. 我相信这可以改进

# 处理文本数据

```
# make the factor columns character
.data <- lapply(data, function(x) if(is.factor(x)) {as.character(x)} else { x})
library(data.table)
DT <- as.data.table(.data)

DT[, original_text := text]
# using `%like% which is an easy data.table wrapper for grepl
DT[text %like% "^THEN", text := substr(text, 6, nchar(text))]
DT[text %like% "^AT", text :=  substr(text, 4, nchar(text))]

# or avoiding the two vector scans and replacing in one fell swoop
DT[,text := gsub('(^THEN )|(^AT )', '', text)]

DT[, c(sum=.N, .SD[which.min(date)]) ,by=text] 
```

# 使用因子水平（可能更快）

```
# assuming that text is a factor
DTF <- as.data.table(data) 
DTF[, original_text := text]
levels_text <- DTF[, levels(text)]
new_levels <- gsub('(^THEN )|(^AT )', x= levels_text ,'')
# reset the levels
setattr(DTF[['text']], 'levels', new_levels)
# coerce to character and do the same count / min date
DTF[, c(sum=.N, .SD[which.min(date)]) ,by=list(text = as.character(text))] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T21:36:37.777

我会给你一个基本的解决方案，但我真的认为这对 base 来说是一个大问题，并且`data.table`包是需要的（但我不知道如何很好地使用 data.table：

```
dat <- data[order(data$date), ]
Trim <- function (x) gsub("^\\s+|\\s+$", "", x)
dat$text2 <- Trim(gsub("AT|THEN", "", dat$text))
dat2 <- split(dat, dat$text2)
FUN <- function(x) {
    c(ID = x[1, 3], Sum = nrow(x), Original.Text = as.character(x[1, 1]), 
        Original.Date = as.character(x[1, 2]))
}

data.frame(do.call(rbind, lapply(dat2, FUN)), row.names = NULL) 
```

我真的不知道每个文本字符串有多接近，所以也许我的精确匹配不合适，但如果是这种情况，请使用`agrep`开发一个新变量。很抱歉缺少注释，但我时间紧迫，我认为`data.table`无论如何更合适。

编辑：我仍然认为 data.table 更好，应该排除在外，但并行运行可能很聪明。您在 Windows 机器上，因此可以使用计算机的多个内核：

```
dat <- data[order(data$date), ]
Trim <- function (x) gsub("^\\s+|\\s+$", "", x)
dat$text2 <- Trim(gsub("AT|THEN", "", dat$text))
dat2 <- split(dat, dat$text2)
FUN <- function(x) {
    c(ID = x[1, 3], Sum = nrow(x), Original.Text = as.character(x[1, 1]), 
        Original.Date = as.character(x[1, 2]))
}

library(parallel)
detectCores()  #make sure you have > 1 core

cl <- makeCluster(mc <- getOption("cl.cores", detectCores()))
clusterExport(cl=cl, varlist=c("FUN", "dat2"), envir=environment())
x <- parLapply(cl, dat2, FUN)
stopCluster(cl)  #stop the cluster
data.frame(do.call(rbind, x), row.names = NULL) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-15T23:06:50.003

`plyr`考虑到您提到的记录数量，可能会太慢，但这里有一个适合您的解决方案：

```
library(stringr)
data$original_text <- data$text
data$text[grep("^THEN", data$text)] <- str_trim(str_sub(data$text[grep("^THEN", data$text)],6))
data$text[grep("^AT", data$text)] <- str_trim(str_sub(data$text[grep("^AT", data$text)],4))

result <- ddply(data, .(text), function(x) {
     sum <- nrow(x)
     x <- x[which(x$date==min(x$date)),]
    return(data.frame(id=unique(x$ID), Sum = sum, Originaltext = unique(x$original_text), Originaldate = unique(x$date)))
    })

> result[, -1]
  id Sum  Originaltext Originaldate
1  4   2 it falls East         2006
2  3   3  it goes West         2003 
```

如果您可以访问多核机器（4 核或更多核），那么这里有一个 HPC 解决方案

```
library(multicore)
library(stringr)
data$original_text <- data$text
data$text[grep("^THEN", data$text)] <- str_trim(str_sub(data$text[grep("^THEN", data$text)],6))
data$text[grep("^AT", data$text)] <- str_trim(str_sub(data$text[grep("^AT", data$text)],4))

fux <- function(foo) {
     sum <- nrow(x)
     x <- x[which(x$date==min(x$date)),]
    return(data.frame(id=unique(x$ID), Sum = sum, Originaltext = unique(x$original_text), Originaldate = unique(x$date)))
}

x <- split(data, data$text)
result <- mclapply(x, fux, mc.cores = 4, mc.preschedule = TRUE) 
```

# asp.net - ASP.net 将变量后面的代码写入 HTML 页面代码

> ID：12903374
> 
> 赞同：0
> 
> 时间：2012-10-15T20:21:38.007
> 
> 标签：asp.net, vb.net

嘿，我想得到这个：

```
<div id="subpg_main">    
<%= theHeadering %>
</div>
<!-- END BODY PAGE -------------------------> 
```

在我的 HTML 代码中工作。

后面的代码只有这个：

```
Public Class thankyou
    Inherits System.Web.UI.Page
    Public theHeadering As String = ""

    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        Dim theName As String = "Bob Barker"
        Dim theEmail As String = "bobb@thepriceisright.com"

        If theForm = "contact" Then
            theHeadering = "<H1>Thank you " & theName & " for contacting us!</H1><BR />"
            theHeadering += "We will be contacting you via your email address at " & theEmail & " within 24 hours."
        End If
    End Sub    
End Class 
```

但是，当我运行该页面时，出现以下错误：

**编译器错误消息：BC30451：未声明“theHeadering”。由于其保护级别，它可能无法访问。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:32:54.067

添加一个函数并从 HTML 调用它

```
<div id="subpg_main">    
<%= TheHeadering()%>
</div>
<!-- END BODY PAGE ------------------------->

Public Class thankyou
    Inherits System.Web.UI.Page
    Private headering As String = ""

    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        Dim theName As String = "Bob Barker"
        Dim theEmail As String = "bobb@thepriceisright.com"

        If theForm = "contact" Then
            headering = "<H1>Thank you " & theName & " for contacting us!</H1><BR />"
            headering += "We will be contacting you via your email address at " & theEmail & " within 24 hours."
        End If
    End Sub    
    Public Function TheHeadering() As String
        Return headering
    End Function
End Class 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T20:36:49.030

打开设计器页面`page.aspx.designer.vb`

并添加：

`Protected theHeadering As String`

您现在将一切正常。

这是自动完成的，但有时，自动部分可能会失败。

* * *

这是一个创建空 WebForms 项目的示例。[完整的图像在这里](https://i.stack.imgur.com/n0Y6n.png)。

![在此处输入图像描述](../Images/c49fc65017b7704fd6ac1af0174d53a9.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-15T20:37:44.460

试试这个

**编辑**

**代码**_

```
<div id="subpg_main">    
<%# TheHeadering()%>
</div>
<!-- END BODY PAGE ------------------------->

Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
    Dim theName As String = "Bob Barker"
    Dim theEmail As String = "bobb@thepriceisright.com"

    If theForm = "contact" Then
        theHeadering = "<H1>Thank you " & theName & " for contacting us!</H1><BR />"
        theHeadering += "We will be contacting you via your email address at " & theEmail & " within 24 hours."
    End If
   'Bind your expression with the markup code
   Me.DataBind()
End Sub 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-15T21:01:29.733

它应该是

```
 Public Property theHeadering As String = "" 
```

并不是：

```
 Public theHeadering As String = "" 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-15T20:34:51.230

我最好的猜测是标记代码的页面指令指向另一个类，该类具有相同的属性 theHeadering As String = "" 但它不是公共访问级别。

# php - PHP If 语句显示日期之后的数据

> ID：12903379
> 
> 赞同：0
> 
> 时间：2012-10-15T20:21:59.123
> 
> 标签：php, mysql, if-statement

我正在使用别人的代码，并试图做一个简单的添加。我在 mySQL 数据库中有一些数据，其中一列是 time_end，它是未来设置的日期。一旦该日期过去，我想显示特定文本。

```
$events = get_all_events();

include 'templates/bet.php';

function get_all_events() {
global $_DB;

$stm = $_DB->prepare('select wl_bet.*, wl_group.gname, (select count(*) from wl_betplace where wl_betplace.betid = wl_bet.id) as countBet from wl_bet, wl_group where wl_bet.groupid = wl_group.gid order by time_end asc');
$stm->execute();
$data = $stm->fetchAll();

$close = array();
$active = array();
$paid = array();

$p = 0;
$c = 0;
$a = 0;
foreach ($data as $d) {
    if ($d['status'] == 2) {
        if ($p < 5) {
            array_push($paid, $d);
            $p++;
        }
    }
    else {
        if ($d['time_end'] < time()) {
            if ($c < 5) {
                array_push($close, $d);
                $c++;
            }
        }
        else {
            if ($a < 8) {
                array_push($active, $d);
                $a++;
            }
        }
    }
}
return array('close' => $close, 'active' => $active, 'paid' => $paid);
} 
```

如果当前日期超过 time_end 日期，这是我要显示的表格。我知道这应该像 if 语句一样简单，但我似乎无法做到正确。同样，我要做的就是在当前日期大于 mysql 数据库中的日期 (time_end) 时显示此表。

```
 <table width="100%" class="list-details sortable">

                <tr class="tablebar">
                    <th><div>Title</div></th>
                    <th><div>Event Date</div></th>
                    <th><div># of Bets</div></th>
                </tr>
                <?php foreach ($events['close'] as $c) : ?>
                <tr class="row">
                    <td><a href="?cmd=view-bet&id=<?php echo $c['id']; ?>"><?php echo $c['title']; ?></a></td>
                    <td><?php echo format_date_only($c['time_end']); ?></td>
                    <td><?php echo $c['countBet']; ?></td>
                </tr>
                <?php endforeach; ?>
            </table> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T20:30:43.973

当然，在我发布这篇文章 5 分钟后，我就明白了

```
<?php if(count($events['close']) > 0):?> text to show <?php endif; ?> 
```

# php - Zend MultiCheckbox 输入属性

> ID：12903380
> 
> 赞同：2
> 
> 时间：2012-10-15T20:22:04.007
> 
> 标签：php, html, zend-framework

我有一个这样的多复选框元素：

```
$element = new Zend_Form_Element_MultiCheckbox('infos', array('disableLoadDefaultDecorators' => true));
$element->addDecorator('ViewHelper')
        ->setRequired(true)
        ->addMultiOption('value1', 'BLABLABLA')
        ->addMultiOption('value2', 'BLABLABLA2')
        ->addValidator('NotEmpty', true);
$element->getValidator('NotEmpty')->setMessage('Pelo menos uma informação é necessária');
$this->addElement($element); 
```

当我渲染一个多复选框元素时，它看起来像这样：

```
<p>     
     <label for="infos-value1">
            <input type="checkbox" name="infos[]" id="infos-value1" value="value1">BLABLABLA
     </label><br>
     <label for="infos-value2">
             <input type="checkbox" name="infos[]" id="infos-value2" value="value2">BLABLABLA2
     </label><br>
 </p> 
```

我只想为第一个输入添加一个属性，所以第一个输入类似于：

```
<input type="checkbox" name="infos[]" id="infos-value1" value="value1" disabled>BLABLABLA
 </label><br> 
```

如何将属性“禁用”添加到我的两个输入之一？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:39:45.050

只需传递要禁用的选项的索引，如下所示：

`$element->setOptions(array('disable' => array('value1', 'value2')));`

不确定这在任何地方都有很好的记录。我希望在 ZF 2.0 中看到多选功能的一些改进。目前，它们确实有其局限性。专门为各个选项设置类或样式属性。过去，我不得不扩展/添加备用元素类和视图助手来解决其中的一些问题。如果必须的话，很容易做到。

# c# - 编译时出现未赋值变量

> ID：12903381
> 
> 赞同：1
> 
> 时间：2012-10-15T20:22:09.263
> 
> 标签：c#

这段代码用于生成 0 到 1000 之间的 100 个随机数，并显示生成的偶数个数以及最小值、最大值和值的范围。

当我编译时，我收到一个关于使用 minInt 和 maxInt 的未分配局部变量的错误。它应该从生成器中获取分配的变量，我做错了什么？

```
using System;
using System.Windows.Forms;

namespace ConsoleApplication27
{
    class Program
    {
        static void Main(string[] args)
        {
            int evenNumbers = 0;
            int minInt;
            int maxInt;
            int range;
            string result;

            range = maxInt - minInt;

            result = "Even numbers:\t" + evenNumbers;
            result += "\nMin number:\t" + minInt;
            result += "\nMax number:\t" + maxInt;
            result += "\nRange of number:\t" + maxInt + " - " + minInt + " = " + range;

            DisplayResults(result);
        }

        static void GenerateNumbers(int evenNumbers,  int minInt,  int maxInt,  int range)
        {
            //creating 100 element array
            //and using the random function to fill it
            int[] randomNumbers = new int[100];
            Random number = new Random();
            int randy;
            for (int i = 0; i < randomNumbers.Length; i++)
            {
                randy = number.Next(1000);
                randomNumbers[i] = randy;
                if (randy < minInt)
                {
                    minInt = randy;
                }
                else
                    if (randy > maxInt)
                    {
                        maxInt = randy;
                    }
                if (randomNumbers[i] % 2 == 0)
                {
                    evenNumbers++;
                }
            }
        }
        static void DisplayResults(string outcome)
        {
            MessageBox.Show(
            outcome, "results!",
            MessageBoxButtons.OK, MessageBoxIcon.Information);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T20:25:37.643

我怀疑您的主要问题是您从不将随机数分配给`randy`：

```
int randy;
for (int i = 0; i < randomNumbers.Length; i++)
{
    randy = number.Next(1000);
    randomNumbers[i] = randy 
```

编辑：我很惊讶这甚至可以编译。它不应该抱怨尝试使用未初始化的变量吗？

编辑：此外，您需要为您的方法分配*一些*价值。在这些修复之后，它应该编译（但不会给你你需要的结果，因为你没有调用或收集结果。为此你应该使用：`minInt``maxInt``Main``GenerateNumbers``ref`

```
int evenNumbers = 0;
int minInt = Int32.MaxValue;
int maxInt = Int32.MinValue;
int range;
string result;

GenerateNumbers(ref evenNumbers, ref minInt, ref maxInt);

range = maxInt - minInt;

result = "Even numbers:\t" + evenNumbers;
result += "\nMin number:\t" + minInt;
result += "\nMax number:\t" + maxInt;
result += "\nRange of number:\t" + maxInt + " - " + minInt + " = " + range;

DisplayResults(result); 
```

然后你的`GenerateNumbers`方法：

```
static void GenerateNumbers(ref int evenNumbers,  ref int minInt,  ref int maxInt)
{
    //creating 100 element array
    //and using the random function to fill it
    int[] randomNumbers = new int[100];
    Random number = new Random();
    int randy;
    for (int i = 0; i < randomNumbers.Length; i++)
    {
        randy = number.Next(1000);
        randomNumbers[i] = randy;
        if (randy < minInt)
        {
            minInt = randy;
        }
        else
            if (randy > maxInt)
            {
                maxInt = randy;
            }
        if (randomNumbers[i] % 2 == 0)
        {
            evenNumbers++;
        }
    }
} 
```

（参数没用，我把它拿出来了`range`）

另请注意，我最初将您的`minInt`和`maxInt`变量设置为最大/最小值。这意味着他们将获取第一个随机值，然后保持更新。

编辑：也清理了生成器代码。请注意`if < elseif >`检查，因为在某些极端情况下，如果随机数太少且范围太小，或者生成的每个随机数都是递减的，那么您的“else if (randomNumber > maxInt”检查*永远不会*执行。

```
static void GenerateNumbers(ref int evenNumbers,  ref int minInt,  ref int maxInt)
{
    Random numberGenerator = new Random();
    for (int i = 0; i < 100; i++)
    {
        int randomNumber = numberGenerator.Next(1000);

        if (randomNumber < minInt)
            minInt = randomNumber;

        if (randomNumber > maxInt)
            maxInt = randomNumber;

        if (randomNumber % 2 == 0)
            evenNumbers++;
    }
} 
```

# ios - 更新包含图像的 iOS 应用程序内容

> ID：12903384
> 
> 赞同：2
> 
> 时间：2012-10-15T20:22:17.050
> 
> 标签：ios

我正在开发一个蔬菜园艺应用程序。除了蔬菜名称和描述，我还有蔬菜图片。目前，我在 Xcode 项目的 Supported Files 文件夹中拥有所有图像。

但后来我想在不让用户下载新版本的情况下动态更新应用程序。当用户更新应用程序或从服务器下载新数据时，该数据将包括图像。我可以将这些图像存储在支持文件的文件夹中，还是可以仅通过名称引用它们的地方。

**相关问题：**

我还将允许用户为他们的蔬菜拍照，然后写下关于蔬菜的注释，例如“刚刚种植”、“即将收获”等。推荐的存储图片/照片的方法是什么。我总是可以将它们存储在用户的照片库中，然后将参考存储在本地数据库中，然后使用参考获取并显示图片。这种方法的问题可能是，如果用户不小心从库中删除了图片，那么它将不再显示在我的应用程序中。

我看到是否将图片作为 BLOB 存储在应用程序本地数据库中的唯一方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T20:40:10.650

不，您不能将下载的图像与其他图像放在支持文件夹中。另外，我建议您将图像放在图像或资源文件夹中...如果您想在应用程序编译后下载任何数据，那么它们将不在捆绑包中。它是您在谈论 Xcode 中的 Supported Files 文件夹时所指的包。这对于您的应用程序是只读的。

需要明确的是，一旦编译，您的应用程序就没有文件夹结构，这些“文件夹”只是 Xcode 项目中的组，以保持事物整洁。

如果您下载一个包含一组图像的 zip 文件，您可以在下载后将它们写入磁盘。您应该将这些图像放在 tmp、缓存或文档目录中。

但是你必须在加载图像之前建立你的路径。您不能只提供文件名，例如：

```
[UIImage imageNamed:@"something.jpg"]; 
```

因为这将在您的捆绑包中查找。相反，您必须执行[类似](https://stackoverflow.com/questions/8635909/loading-an-image-from-documents-directory)的操作以从 Documents 目录加载图像。

您面临的挑战是，您最终将处于 Bundle 中包含一些图像（上传应用程序时的图像）和文档目录中的较新图像的状态。您必须首先检查捆绑包，如果那里没有图像，请检查文档目录。

* * *

对于用户生成的数据，我建议也将图像保存在 Documents 目录中，并维护用户数据的 SQLite 数据库，以便您可以将图像名称映射到数据库中的条目。您不想将图像保存为 BLOB，因为这将不可避免地降低查询的性能，并在 CPU 上增加额外的不必要的负载以转换为 UIImage 并返回。

您不想将他们的图像保存到画廊有两个原因，首先这意味着您将保存在两个地方，因为在数据库中保留对外部图像的引用非常脆弱，您只是在自找麻烦，其次，一旦图像不在您的保护之下，您将无法再控制它，用户会在某个时候将其删除，如果他们返回您的应用程序，他们希望在那里看到它。

# php - 字符串输入的MYSQL更新语法错误

> ID：12903385
> 
> 赞同：0
> 
> 时间：2012-10-15T20:22:17.687
> 
> 标签：php, mysql

我的代码如下

```
 $count++;
    $yesstring = 'MATCH';

    echo $count . '. RESULT ' . $idcheck . ': ' . $phonecheck . ' was matched. <br />';

    $matchquery = sprintf("UPDATE `list` SET match = `%s` WHERE homephone = `%s` LIMIT 1",
        mysql_real_escape_string($yesstring),
        mysql_real_escape_string($phonecheck));

    $matchresult = mysql_query($matchquery);

    if (!$matchresult) {
        die("Invalid query: " . mysql_error());
    } 
```

这是我的错误

无效查询：您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的“match = `MATCH`WHERE homephone = `(999) 999-9999`LIMIT 1”附近使用正确的语法

任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:23:53.090

`match`是 MySQL 中的[保留字](http://dev.mysql.com/doc/refman/5.5/en/reserved-words.html)。用反引号转义它：

```
 UPDATE `list` SET `match` = ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T20:24:19.170

当您应该使用常规引号时，您正在使用反引号。反引号保留用于转义表或列名：

```
INSERT INTO `foo` VALUES ('value') 
```

尽管您正确地转义了 SQL，但调用`mysql_real_escape_string`可能会被证明是一种持续的麻烦。从长远来看，切换到`mysqli`PDO 会使编写正确的 SQL 变得容易得多。

# javascript - Javascript .mask() 屏蔽输入多个选项

> ID：12903388
> 
> 赞同：0
> 
> 时间：2012-10-15T20:22:29.563
> 
> 标签：javascript, jquery, input, mask

我使用 javascript 插件屏蔽输入。

我当前的代码是：

```
 $("#a").mask("9?9999", {"placeholder": ""}); //so other 4 9999 are optional 
```

我想要实现的是这样的：

```
 $('#a').mask("9?9999?.99?9", {"placeholder": ""}); 
```

我希望用户能够输入以下内容：

```
 5 //valid
    7.99 //valid
    7712.239 //valid 
```

有没有办法用 .mask() 实现这一点？我尝试了上面的代码，但似乎没有用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T20:29:05.270

简单回答是不。

也许您可以查看专门用于数字输入框的[jquery.numeric插件。](http://www.texotela.co.uk/code/jquery/numeric/)

# canvas - JPG w白色背景而不是PNG透明

> ID：12903397
> 
> 赞同：0
> 
> 时间：2012-10-15T20:22:52.900
> 
> 标签：canvas, transparency, gif, jpeg, graphical-logo

为什么我看到许多大大小小的网站都使用`JPG`在纯白色画布上创建的徽标，而不是使用透明画布`GIF`或`PNG`透明画布？`div`当图像放置在具有渐变（或非白色）背景的图像中时，在白色正方形的中心看到一个圆形徽标让我感到困扰。

是否有一些我不知道的原因使得`JPG`白色方块中的丑陋比可以放在任何颜色背景上的徽标更好，或者这些网站只是做得不正确？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:29:43.087

这是主观的，但我发现很多实施网站的人（设计师和开发人员）都不熟悉 JPG 和 PNG 之间的区别。他们习惯了一切都是 JPG，所以他们把一切都放在那种格式。

发生这种情况时，我会尝试解释每种格式的优缺点：

*   当您拥有连续彩色照片时，JPG 非常棒
*   当您想要透明度时，PNG 和 GIF 非常棒：当您想要将某些东西合并到背景中时。GIF 只有“透明与否”，PNG 可以有不同程度的透明度（如投影）
*   当您的颜色数量有限（例如图表或大多数徽标）时，PNG 和 GIF 非常棒，而且它们可能比 JPG 小
*   PNG 和 GIF 非常适合具有硬过渡的内容，例如文本。JPG 会产生压缩伪影。

我真的认为这一切都归结为教育。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T20:31:07.687

它真的归结为文件大小。您通常使用文件大小最小的任何类型的图像，而不会影响原始图像的外观。

图像的大小、使用的颜色数量、细节级别（如渐变和阴影）都会影响哪种格式最适合这种情况。我同意，徽标通常应该是 PNG 和简单的。复杂图像通常最小为 JPG，其中颜色较少的简单图像最好保存为 PNG。

# actionscript-3 - 我想将本地目录中的 CSV 加载到 Flash

> ID：12903401
> 
> 赞同：0
> 
> 时间：2012-10-15T20:23:00.620
> 
> 标签：actionscript-3, flash, actionscript, csv

我可以在我的代码中创建一个虚拟字符串并解析为一个数组，但是对于我如何从本地目录加载 CSV 并将其转换为一个字符串，然后我可以加载到一个数组中进行解析，这对我来说是一个断开连接。 .

到目前为止，这是我的代码：

```
Var itemArray = [];

var dummyString:String = "Item 1    Item 2    Item 3\nItem 4    Item 5    Item 6";

parse(dummyString, itemArray);

function parse(string, array) {
    //code
} 
```

因此，我不想传入一个虚拟字符串，而是从这样的本地目录加载一个 csv 文件：file:///Volumes/localDir/subDir/file.csv

我知道如何浏览和选择它，但不知道如何将其转换为我可以解析的格式......如果这是有道理的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T22:52:08.937

我使用了这个库，它可以很好地满足我的需求：

[http://code.google.com/p/csvlib/](http://code.google.com/p/csvlib/)

# jquery - 从 iframe 读取 xml 响应

> ID：12903408
> 
> 赞同：0
> 
> 时间：2012-10-15T20:23:28.947
> 
> 标签：jquery, iframe

> **可能重复：**
> [在 iframe 加载中读取 iframe 内容](https://stackoverflow.com/questions/1229365/reading-iframe-content-in-iframe-load)

我正在使用隐藏 iframe 将文件上传到不同的域。我正在使用以下代码：

```
<form id="myForm" method="POST" enctype="multipart/form-data" target='myFrame' action='some_cross_domain_url'>
    <input type="file" name="myFile" class="upload_file_input"/><br><br>
    <input type="submit" value="Upload"/>
    <input type="button" value="Reset"/>
</form>
<iframe id = "myFrame" name ="myFrame" style="display:none"></iframe> 

<script>
    $('#myFrame').load(function(){
        alert($(this).text());
    });
</script> 
```

上传成功，但我无法从 iframe 读取 xml 响应。它只是给出空白。这是跨域问题吗？我如何从 iframe 获得响应..

# ios - 无法使用 Kiwi 测试 CocoaPods 添加的框架

> ID：12903410
> 
> 赞同：10
> 
> 时间：2012-10-15T20:23:42.090
> 
> 标签：ios, xcode, afnetworking, cocoapods, kiwi

我在让测试框架 Kiwi 与通过 CocoaPods 添加的框架一起工作时遇到问题。我同时加载了 AFNetworking 和 Lumberjack，两者都导致测试失败。只有当我的项目中构建到测试目标中的任何源文件包含来自 CocoaPods 的文件时，测试才会失败。这是我收到的消息：

2012-10-15 13:10:44.386 otest[47294:7e03] 无法加载 /Users/[username]/Library/Developer/Xcode/DerivedData/Build/Products/Debug-iphonesimulator/KiwiUnitTest.octest 的测试包因为发生了链接错误。dyld 很可能无法找到链接测试包所针对的框架框架或库，可能是因为框架或库在链接时的安装路径不正确。

我已按照 CocoaPods 和 Kiwi 的所有说明进行操作。

例如，我有一个 APIClient 类。它包括 AFHTTPClient.h。如果我在没有将 APIClient.m 内置到测试目标中的情况下运行测试，则测试将构建并运行良好。如果我确实将源包含在其中，则表示一切成功，但未运行测试，并且上述错误消息在我的日志中。

谢谢，詹姆斯

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-25T11:44:51.743

我有一个类似的问题。通过将“构建设置”（在“单元测试”部分）中的`Test Host`参数设置为.`KiwiUnitTest``$(BUNDLE_LOADER)`

![在此处输入图像描述](../Images/f2d99f3d7bc6d4da7157bf99a300808f.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-08T23:00:50.820

丢失的 pch.dia 问题可能是由几个不同的因素引起的，但在我和一些同事的情况下，这解决了丢失的 pch.dia

卸载 CocoaPods 并安装**`0.17.1`**

```
sudo gem uninstall cocoapods
sudo gem install cocoapods -v 0.17.1 --verbose 
```

将 Kiwi 版本锁定为 2.05：

```
target :KiwiUnitTest, :exclusive => true do
  pod 'Kiwi', '2.0.5' 
```

清理您的 Xcode 项目，包括派生数据。关闭 Xcode，重新打开项目并构建。

# javascript - 修改 CKEditor 链接对话框以将自定义属性添加到链接

> ID：12903425
> 
> 赞同：15
> 
> 时间：2012-10-15T20:24:21.513
> 
> 标签：javascript, ckeditor

我在网站上使用 CKEditor，我需要能够在通过编辑器创建的一些链接上放置特殊的数据属性。用户将通过选中链接对话框中的复选框来指示他们需要将特殊属性放在链接上。我设法使用以下代码在链接对话框中添加了一个复选框：

```
CKEDITOR.on('dialogDefinition', function(ev) {
    if (ev.data.name == "link") {
        var info = dialog.getContents("info");
        info.elements.push({
            type: "vbox",
            id: "urlOptions",
            children: [{
                type: "hbox",
                children: [{
                    id: "button",
                    type: "checkbox",
                    label: "Button",
                    commit: function(data) {
                        data.button = this.getValue()
                        console.log("commit", data.button, data);
                    },
                    setup: function(data) {
                        this.setValue(data.button);
                        console.log("setup", data.button, data);
                    }
                }]
            }]
        });
    }
}); 
```

现在我有两个问题。第一个是尽管我在`commit`and`setup`函数中添加了应该保存复选框状态的代码，但它不起作用。就好像`data`除了默认情况下的参数之外，不能保存任何其他参数。

第二个问题是我不知道如何在我的链接上添加/删除数据属性。在我看来，我应该在`onOk`对话框的回调中这样做，但是，链接对话框已经有一个`onOk`回调，所以我不确定我应该如何进行。当然，我不想直接修改任何 CKEditor 的文件。

我怎样才能完成这些事情？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-23T17:35:15.520

您最好的选择是修改插件。所以你需要打开源代码并找到文件`links.js`在`c:\ckeditor_3.6.5\ckeditor\_source\plugins\link\dialogs\`

源代码相当大（40k），但在这里您可以随意修改对话框。完成后，只需将其复制到您的插件文件夹，然后压缩：http: [//jscompress.com/](http://jscompress.com/)

我自己做了你需要的。整个未压缩文件在这里：[https ://gist.github.com/3940239](https://gist.github.com/3940239)

你需要做什么：

首先在附加对话框“浏览”按钮之前添加这一行。大约。在线：547：

```
 {
                            id: "button",
                            type: "checkbox",
                            label: "Button",
                            setup: function (data) {
                                this.allowOnChange = false;

                                if (data.button)
                                    this.setValue(data.button);

                                this.allowOnChange = true;
                            },
                            commit: function (data) {
                                data.button = this.getValue()
                                this.allowOnChange = false;
                            }
                        }, 
```

这部分实际上是您的代码。我只是复制并粘贴它。

然后，转到 onOk 功能，大约。在第 1211 行：并在 commitContent 之后添加以下代码：

```
this.commitContent( data );

//My custom attribute
if (data.button)
    attributes["custom-attribute"] = "button";
else
    attributes["custom-attribute"] = ""; 
```

这将修改您的链接，将属性添加到元素中，例如`<a href="#" custom-attribute="button">text</a>`

就是这样。虽然，您可能还想加载复选框的当前状态。然后，转到函数`parseLink`。大约。第 179 行加载属性：

```
...
if ( element )
{
    retval.button = element.getAttribute('custom-attribute');

    var target = element.getAttribute( 'target' );
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T18:55:45.647

我现在正在探索同样的事情。我决定在这一点上做的是：

1.  获取没有链接插件的基本 ckeditor 安装
2.  创建我自己的链接插件分支，并将我的更改添加到其中，然后在链接通常显示的组中激活并使用此插件。

...将其用作自定义插件（尽管是原始插件的副本）应该可以缓解升级问题。您只是根本不使用原始链接插件。复制并重命名它，然后改用您的自定义副本。

# javascript - 如何使用 Razor 中的 Javascript 同时将项目添加到多个下拉列表？

> ID：12903426
> 
> 赞同：1
> 
> 时间：2012-10-15T20:24:25.940
> 
> 标签：javascript, asp.net-mvc, razor, html-select

我正在创建一个 MVC 表单，我有多个复选框和两个下拉列表。我已经弄清楚如何根据选中的框填充第一个 DDL（即在开始时为空，选中框填充项目）。但是，我想添加另一个具有相同项目并以相同方式填充的 DDL。我的代码如下所示：

```
<script type="text/javascript">
    function checkedToggle(value, checked) {
        x = document.getElementById("filter1");
        y = document.getElementById("filter2");
        if (checked == true) {
            var option = document.createElement("option");
            option.text = value;
            x.add(option, null);
            y.add(option, null);
        }
        else {
            for (i = 0; i < x.length; i++) {
                if (x.options[i].value == value) {
                    x.remove(i);
                    y.remove(i);
                }
            }
        }
    }
</script> 
```

一旦取消选中该框，else 语句显然会从列表中删除一个项目。

现在，当您单击一个复选框时，而不是将项目添加到两个列表中，它只会添加到第二个列表中，我不确定为什么。有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T20:27:48.423

您需要创建两个元素，因为在您的代码中您只需将第一个 DOM 元素移动到第二个选择。

```
var option = document.createElement("option");
var option2 = document.createElement("option");

option.text = value;
option2.text = value;

x.add(option, null);
y.add(option2, null); 
```

# dns - WIF 联盟和域：永远不要进入自定义 SecurityTokenHandler

> ID：12903432
> 
> 赞同：0
> 
> 时间：2012-10-15T20:24:59.390
> 
> 标签：dns, amazon-ec2, wif, federation

我们已经实现了一个在大多数情况下都能正常工作的联合服务器。它依赖于 ws2007HttpBinding 并实现了 UserNameSecurityTokenHandler 的扩展（称为 CustomSecurityTokenHandler）。在我们的局域网上，一切正常。

但是，我们有以下失败的场景：

1) 服务器部署在 Amazon EC2 上，而不是本地 LAN。客户端是连接到服务器的 WPF 应用程序。当客户端安装在工作组内的 pc 上时，连接正常。

2) 但是，当 PC 位于 AD 域时，我们无法连接。这似乎不是由于网络问题：与 EC2 的连接仍然正常，我们确实连接到联邦提供程序，但从未进入 CustomSecurityTokenHandler。

因此，看起来好像服务器已为我们的本地 LAN 正确配置，但是当服务器在某个外部网络上并且客户端从我们的本地域调用时突然卡住了。

配置中可能有某种删除部分要做，但我看不出在哪里。
我已经有了 ：

```
 <microsoft.identityModel>
<service>
  <securityTokenHandlers>
    <remove type="Microsoft.IdentityModel.Tokens.WindowsUserNameSecurityTokenHandler, Microsoft.IdentityModel, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"/>
    <add type="MyOwnFP.Federation.CustomSecurityTokenHandler, MyOwnFP.Federation"/> 
```

任何想法都会受到欢迎。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T13:55:16.460

实际上是由于服务器和客户端之间的时钟差异。通过将我的域与适当的 NTP 同步来解决。

# actionscript-3 - 如果滑块使用一次，AS3 滑块组件内置焦点矩形将不再显示

> ID：12903433
> 
> 赞同：1
> 
> 时间：2012-10-15T20:25:00.973
> 
> 标签：actionscript-3, flash

不像大多数人想要完全禁用不同组件的蓝色焦点矩形，特别是滑块，我希望它在聚焦时在那里，当使用以下代码以编程方式聚焦在滑块上时，焦点矩形正确显示：

```
my_mc_1.addEventListener(MouseEvent.MOUSE_OVER, Focus_My_Slider_1);
function Focus_My_Slider_1 (event:MouseEvent):void {
stage.focus = My_Slider_1
}

my_mc_2.addEventListener(MouseEvent.MOUSE_OVER, Focus_My_Slider_2);
function Focus_My_Slider_2 (event:MouseEvent):void {
stage.focus = My_Slider_2
} 
```

一旦你运行程序，它就很好用，除非你使用任何滑块并且蓝色边框消失了，它永远消失了，但是滑块被聚焦但蓝色边框不再出现，除非你按 Tab 键，它带来了回去住。我尝试了很多寻找解决方案但没有运气，这是我在这里的第一篇文章。希望任何人都可以提供帮助。

# php - Transip API 域检查未能加载外部实体

> ID：12903434
> 
> 赞同：1
> 
> 时间：2012-10-15T20:25:12.747
> 
> 标签：php, soap, wsdl, openssl, plesk

我在 Transip.nl 租用 VPS 服务器。自动安装 CentOS + Plesk 11。

他们有一个 API，您可以使用它来检查域名是否可用。 [https://www.transip.nl/domeinnaam-en-webhosting/api/](https://www.transip.nl/domeinnaam-en-webhosting/api/)

我已经正确安装了所有东西，但现在它给了我一个错误：

> 发生错误：SOAP-ERROR: Parsing WSDL: Couldn't load from 'https://api.transip.nl/wsdl/?service=DomainService' : failed to load external entity "https://api.transip.nl /wsdl/?service=DomainService"

我必须做什么？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T16:57:20.803

我解决了！它处于“SELinux 状态”。

当我在服务器上使用命令“getenforce”检查它时，它显示“正在执行”。所以我做了：'setenforce 0'，现在它工作正常！

谢谢你一直在寻找我的问题的答案！

# java - 获取文件路径

> ID：12903436
> 
> 赞同：2
> 
> 时间：2012-10-15T20:25:20.297
> 
> 标签：java, file

有没有办法获取计算机上存在的文件的完整路径？例如，我想获取桌面文件夹中文件的完整路径

我尝试使用：

```
 File f = new File("help.chm");

  String f2=f.getAbsolutePath();
  f3=f3.replaceAll("\\\\","/" );
  System.out.println("Path:"+f3); 
```

但它给了我这样的项目路径：

> C:/Users/toshiba/Documents/NetBeansProjects/test/help.chm

虽然文件不在那里。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:29:57.547

如果创建`file`using`new File("filename")`是`relative path`，则无法获取文件的绝对路径 using `file.getAbsolutePath()`，因为相对路径是根据默认用户主目录或 JVM 路径构建的。

看看[Java Doc](http://docs.oracle.com/javase/7/docs/api/java/io/File.html)：-

> 路径名，无论是抽象的还是字符串形式的，都可以是绝对的或相对的。绝对路径名是完整的，因为不需要其他信息来定位它表示的文件。
> 
> 相反，相对路径名必须根据从其他路径名获取的信息来解释。默认情况下，java.io 包中的类总是根据当前用户目录解析相对路径名。此目录由系统属性 user.dir 命名，通常是调用 Java 虚拟机的目录。

因此，要获得`absolute path`这种情况下的路径，您实际上必须自己编写路径。获取`absolute path`到您保存 的目录`file`，并将 附加`file name`到它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T20:27:53.023

A`File`是文件*路径*的表示，不一定是磁盘上存在的文件 - 即文件不必存在于磁盘上，`File`对象也不存在`null`。

这就是为什么有`File.exists()`方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T20:30:17.283

路径“help.chm”将相对于您启动 JVM 的目录，在您的情况下似乎是`C:/Users/toshiba/Documents/NetBeansProjects/test/`

要获得桌面的路径，您需要使用 Windows 中桌面目录的绝对路径，这类似于`C:/Users/toshiba/Desktop/help.chm`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-15T20:42:11.853

由于其他答案未涵盖您的问题，因此这是我的评论：

要获取文件的路径，首先需要告诉 java 程序它在哪里或如何找到它。

对于您的特定示例，您可以使用以下方法获取桌面路径：`System.getProperty("user.home") + "/Desktop";`然后您可以在桌面上的文件夹中搜索匹配的文件名。

阅读此处了解如何搜索文件：docs.oracle.com/javase/tutorial/essential/io/find.html

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-15T20:42:48.587

您正在尝试从（默认文件夹）读取文件

```
C:/Users/toshiba/Documents/NetBeansProjects/test/ 
```

文件不存在，但将是文件的路径将是

```
C:/Users/toshiba/Documents/NetBeansProjects/test/ 
```

如果您从文件的实际位置读取文件：

File f = new File("C:/Users/toshiba/Desktop/help.chm");

您将看到`exists()`返回 true。

```
 System.out.println(f.exists()); 
```

然后：

```
 String f2=f.getCanonicalPath(); 
```

# c - 无法创建套接字：不允许操作 - Mac

> ID：12903437
> 
> 赞同：0
> 
> 时间：2012-10-15T20:25:31.467
> 
> 标签：c, sockets

我正在尝试运行 portscaner 作为我在学校工作的一部分。当我运行代码时，它显示错误消息“不允许操作”。此消息在操作系统无法创建套接字后直接打印。

注意： 1\. 我的系统是 Mac OS X 10.6.8 2\. 在这个项目中，我使用的是排插座。3\. 我在创建 TCP 套接字之前写了一段代码并且运行良好。

我认为出现此错误是因为行套接字需要我的系统当前具有的某种更高权限。有谁知道如何更改我系统中的权限？非常感谢任何帮助:)

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T20:30:26.253

该进程必须具有 root 权限才能打开原始套接字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T09:59:14.887

有时另一个套接字在同一个端口下运行

# excel - 匹配 Excel 工作表之间的值并将行复制到另一个工作表

> ID：12903439
> 
> 赞同：1
> 
> 时间：2012-10-15T20:25:37.520
> 
> 标签：excel, excel-formula, vba

我的 Excel 文件中有 3 个工作表。缺失（25,000 行）、有效（18,000 行）和匹配（空白）。

我需要比较缺失和有效列 D 中的值，并将所有匹配项的所有行复制到匹配表。

如果我能以某种方式进行通配符搜索，那也很好，例如雅培实验室匹配雅培实验室的一种方式。如果那不可能，那么如果有办法突出显示已匹配的行，以便我可以手动查找通配符匹配项，将不胜感激。

这是我尝试过的，我通过谷歌找到了它，但我并不完全理解代码。它运行了几分钟没有错误，但没有提取任何数据：

```
Sub CopyRows() 
Dim cell As Range 
Dim found As Range 
Dim dcol 
Dim bcol 
Dim totalrows1 As Long 
Dim totalrows2 As Long 

totalrows1 = Sheets("Valid").UsedRange.Rows.Count 
bcol = "$D$2:$D$" & totalrows1 
totalrows2 = Sheets("Missing").UsedRange.Rows.Count 
dcol = "$D$2:$D$" & totalrows2 
For Each cell In Sheets("Valid").Range(bcol) 
    If Not Sheets("Missing").Range(dcol).Find(What:=cell.Value, LookAt:=xlWhole) Is Nothing Then 
        Set found = Sheets("Missing").Range(dcol).Find(What:=cell.Value, LookAt:=xlWhole) 
        If found.Offset(0, -3).Value = cell.Offset(0, 1).Value And found.Offset(0, -2).Value = cell.Offset(0, -1).Value Then 
            cell.Offset(0, 2).Value = found.Offset(0, -1).Value 
        End If 
    End If 
Next cell
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T01:33:37.917

不会管理近似匹配，但除此之外：合并缺失和匹配中的有效，排序`ColumnD`然后应用带有条件格式的突出显示以识别相邻匹配的“D”值。过滤并删除那些未突出显示的。审查[SU486330](https://superuser.com/questions/486330/formula-to-compare-the-source-and-the-target-based-on-id/486380#486380)可能会有所帮助。

# sql - 在合并语句中使用连接

> ID：12903446
> 
> 赞同：28
> 
> 时间：2012-10-15T20:26:10.793
> 
> 标签：sql, tsql, merge

**问题**

表格1：

```
| KeyColumn | DataColumn1 | DataColumn2|  
   01         0.1          0.2
   02         0.13         0.41 
```

表 2：

```
| anotherKey | DataColumn1 | DataColumn2|      
   A1          .15          1.2
   A2          .25          23.1 
```

表3：

```
|KeyColumn| anotherKey |       
  01        A1
  02        A1 
```

给定一个键（A1 或 A2），我需要使用表 2 中的相应值更新表 1 中的 DataColumn1 和 DataColumn2 列。

所以 table1 可以更新 x 行，如上面的数据所示。如果我想更新 A1，01 和 02 行都应该更新

（因此对于键 01 和 02，对于 datacolumn1，table1 中的值是 0.15，对于 datacolumn2 是 1.2）

**到目前为止我已经尝试过：**

```
MERGE table1
USING (SELECT *
       FROM table2
       LEFT OUTER JOIN table3
           on table2.anotherKey = table3.anotherKey
       WHERE table2.anotherKey = 'A1') tmpTable
ON 
   table1.keyColumn = tmpTable.keyColumn
WHEN MATCHED THEN
       UPDATE
       SET table1.DataColumn1 = tmpTable.DataColumn1
            ,table1.DataColumn2 = tmpTable.DataColumn2; 
```

**问题：**

1.  这是允许的吗？在using语句中使用select？我在第 1 行遇到语法错误
2.  有没有更好的方法来解决这个问题？我是否让这变得比它必须的更复杂？
3.  我究竟做错了什么？

和错误：

消息 102，级别 15，状态 1，第 1 行 'a' 附近的语法不正确。消息 102，级别 15，状态 1，第 12 行 'd' 附近的语法不正确。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-10-15T20:59:39.997

您的查询将给出错误

> 消息 8156，级别 16，状态 1，第 59 行 为“tmpTable”多次指定了“AnotherKey”列。

那是因为您`*`在 using 子句中使用并且是and`AnotherKey`的一部分。 指定您需要的列。由于您在子句中使用，因此在那里使用外部连接也没有用。`table2``table3`
`keycolumn``on`

```
MERGE table1
USING (SELECT table3.keycolumn,
              table2.DataColumn1,
              table2.DataColumn2
       FROM table2
       INNER JOIN table3
           ON table2.anotherKey = table3.anotherKey
       WHERE table2.anotherKey = 'A1') tmpTable
ON 
   table1.keyColumn = tmpTable.keyColumn
WHEN MATCHED THEN
       UPDATE
       SET table1.DataColumn1 = tmpTable.DataColumn1
            ,table1.DataColumn2 = tmpTable.DataColumn2; 
```

**更新**

发布实际错误总是有帮助的。

> 消息 102，级别 15，状态 1，第 1 行 'a' 附近的语法不正确。消息 102，级别 15，状态 1，第 12 行 'd' 附近的语法不正确。

看起来您在 SQL Server 2005 上。合并可从[SQL Server 2008](http://msdn.microsoft.com/en-us/library/bb510625(v=sql.100).aspx)获得。

您可以使用 . 检查您的 SQL Server 版本`select @@version`。

# javascript - AngularJS - CRUD 指令/服务/控制器模式

> ID：12903451
> 
> 赞同：5
> 
> 时间：2012-10-15T20:26:29.640
> 
> 标签：javascript, angularjs

我想创建一些以某种方式与父控制器/范围交互的指令。我以 2 种方式进行 CRUD：A）基于路由，如果您要编辑项目，我使用 $location 将 url 更改为给定的 url B）基于相同页面，如果您单击项目上的编辑，它会设置 $scope .template 来自 $scope.tpl，然后在部分中我有一个 ng-hide / show 隐藏和显示表格视图/详细视图。

我想要实现的可能是指令中的代码更少，并且可能使用更多基于服务的方法或提示？

# 指令

```
'use strict';

/* Directives */
var directives = angular.module("app.directives", ["ui"]);

function CrudCtrl($scope, $attrs, $location, $parse) {
    function getScope(scopeName) {
        scopeName = typeof scopeName || "$parent";
        var ngModel = $parse(scopeName, $scope);
        return ngModel($scope)
    }

    function refreshObjects(scopeName) {
        $scope.svc.query($scope.params, function(objects) {
            var parentScope = getScope(scopeName)
            parentScope.objects = objects
        });
    }

    if (!$scope.refreshObjects) {
        $scope.refreshObjects = function() {
            refreshObjects($attrs.modelname)
        }
    }

    if (!$scope.crudAdd) {
        $scope.crudAdd = function() {
            if ($attrs.url) {
                $location.path($attrs.url);
                return;
            } else {
                var parentScope = getScope($attrs.scope);
                parentScope.object = new $scope.svc();
                parentScope.template = parentScope.tpl;
            }
        }
    }

    if (!$scope.crudDelete) {
        $scope.crudDelete = function() {
            /* Fire off a delete and as a callback we update objects */
            $scope.svc.delete({accountId: $scope.account.uuid, id: $scope.object.id}, function() {
                refreshObjects($attrs.scopeName)
            });
        };
    }

    if (!$scope.crudEdit) {
        $scope.crudEdit = function() {
            if ($attrs.url) {
                $location.path($attrs.url);
                return;
            } else {
                var parentScope = getScope($attrs.scopeName);
                parentScope.object = $scope.object;
                parentScope.template = parentScope.tpl;
            }
        };
    }

    if (!$scope.crudSave) {
        $scope.crudSave = function() {
            var params = {}
            params.accountId = $scope.params.accountId
            if ($scope.object.id) { params.id = $scope.object.id }

            $scope.object.$save(params, function() {
                if ($attrs.url) {
                    $scope.back();
                } else {
                    refreshObjects($attrs.scopeName);

                    var parentScope = getScope($attrs.scopeName);
                    parentScope.template = undefined;
                }
            });
        };
    }

    if (!$scope.crudCancel) {
        $scope.crudCancel = function() {
            if (parentScope.template) {
                var parentScope = getScope($attrs.scopeName);
                parentScope.template = undefined;
            } else {
                $scope.back();
            }
        };
    };
};

directives.directive("refresh", function() {
    return {
        restrict: "E",
        replace: true,
        controller: CrudCtrl,
        scope: true,
        link: function(scope, element, attrs) {
            scope.display_text = attrs.text;
        },
        template: '<button class="btn btn-mini btn-primary" ng-click="refreshObjects()"><i class="icon-refresh"></i> Refresh</button>',
    };
});

/* Create something new */
directives.directive("create", function() {
    return {
        restrict: "E",
        replace: true,
        controller: CrudCtrl,
        scope: true,
        link: function(scope, element, attrs) {
            scope.display_text = attrs.text;
        },
        template: '<button class="btn btn-mini btn-success" ng-click="crudAdd()"><i class="icon-plus"></i> {{display_text || "Add"}}</button>',
    };
});

/* Delete button and update objects */
directives.directive("delete", function() {
    return {
        restrict: "E",
        replace: true,
        controller: CrudCtrl,
        scope: true,
        link: function(scope, element, attrs) {
            scope.display_text = attrs.text;
        },
        template: '<button class="btn btn-mini btn-danger" ng-click="crudDelete()"><i class="icon-remove icon-white"></i> {{display_text}}</button>',
    }
});

/* Helper to create a edit button */
directives.directive("edit", function() {
    return {
        restrict: "E",
        replace:  true,
        controller: CrudCtrl,
        scope: true,
        link: function(scope, element, attrs) {
            scope.display_text = attrs.text;
        },
        template: '<button class="btn btn-mini btn-info" ng-click="crudEdit()"><i class="icon-edit"></i> {{display_text || "Edit"}}</a>',
    }
});

/* Save the object and return to the previous page */
directives.directive("save", function() {
    return {
        restrict: "E",
        replace: true,
        controller: CrudCtrl,
        scope: true,
        link: function(scope, element, attrs) {
            scope.display_text = attrs.text;
        },
        template: '<button class="btn btn-success" ng-click="crudSave()"><i class="icon-ok"> {{display_text || "Save"}}</i></a>',
    };
});

/* Cancel the current action */
directives.directive("cancel", function() {
    return {
        restrict: "E",
        replace: true,
        controller: CrudCtrl,
        scope: true,
        link: function(scope, element, attrs) {
            scope.display_text = attrs.text;
        },
        template: '<button class="btn" ng-click="crudCancel()"><i class="icon-remove"></i> {{display_text || "Cancel"}}</button>'
    }
}); 
```

# 示例控制器

```
function BookingCtrl($scope, Booking) {
      $scope.svc = Booking;
      $scope.objects = $scope.svc.query($scope.params);
  } 
```

然后在部分概述中，我有：

```
<div ng-hide="template">
<refresh></refresh>
<create url="/{{params.accountId}}/entity/add"></create>

<table class="table table-condensed table-hover">
    <thead>
        <tr>
            <th></th>
            <th>Name</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr ng-repeat="object in objects">
            <td>
                <delete></delete>
                <edit url="/{{params.accountId}}/category/{{object.resource_id}}"></edit>
            </td>
            <td>{{object.resource_name}}</td>
            <td>{{object.description}}</td>
        </tr>
        </tr>
        </tr>
    </tbody>
</table>
</div>

<ng-show="template" ng-include src="template"></ng-show> 
```

细节部分：

```
<div class="span4">
    <h3>Category: {{category.resource_name}}</h3>
    <form name="detail_form" class="form-horizontal">
        <div class="control-group">
            <label class="control-label"><strong>Name</strong></label>
            <div class="controls">
                <input required ng-model="object.resource_name" placeholder="Name" type="text" class="input-small">
            </div>
        </div>
        <div class="control-group">
            <label class="control-label"><strong>Description</strong></label>
            <div class="controls">
                <textarea ng-model="object.description" placeholder="Description" type="textarea" rows=5></textarea>
            </div>
        </div>
        <div class="control-group">
            <save scope-name="$parent.$parent"></save>
            <cancel scope-name="$parent.$parent"></cancel>
        </div>
    </form>
<pre>form = {{object | json}}</pre>
</div> 
```

如果有更好的方法来解决这个问题，这似乎过度使用 $parent.$parent 请帮助我！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T21:44:51.143

我会通过以下方式处理这种功能：

*   投入`$resource`使用。
*   用于`ng-view`绑定 url 和 partials。使用锚链接到其他部分。
*   根据角色为每个部分定义控制器。（`$resource`通过服务访问）

[http://angularjs.org/#wire-up-a-backend](http://angularjs.org/#wire-up-a-backend)可能就是一个例子。

# css - 限制div的高度

> ID：12903454
> 
> 赞同：0
> 
> 时间：2012-10-15T20:26:40.260
> 
> 标签：css, html

[jsfiddle](http://jsfiddle.net/KWZdD/) - 正如你所看到的，所有的 div 高度都以像素 (`div a`和`div b)`. 最后一个 (div c)has给出`height:100%`，所以它和整个身体一样高。我希望它只是填充它的父级，而不是和所有的一样高文件。（黄色`div`溢出）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T20:34:39.500

将 div c 放入块 a 并取出 b -

```
<div id="b"></div>
<div id="a">
     <div id="c"></div>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T20:34:39.803

试试这个，你 div a 是父级，它的高度是 300px ，所以 b 和 c 的总和应该是 300px

```
 #a{background:red; height:300px;}
 #b{background:blue; height:50px;}
 #c{background:yellow; height:250px; width:100px;} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T20:35:07.253

[演示](http://jsfiddle.net/KWZdD/28/)

它和身体一样高，包括b div。用负边距和填充修复它。

```
* { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }
#a{background:red; height:300px;}
#b{background:blue; height:50px; position:relative; z-index:15;}
#c{background:yellow; height:100%; margin-top:-50px; padding-top: 50px;width:100px; position:relative; z-index:5;}​ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-15T20:35:07.940

由于您正在对像素进行编码，因此您是否有不想设置 #c{height:250px;} 的原因？也就是说，让Div C的高度为Div A的高度和Div B的高度之差？这将确保黄色 div 始终以与红色 div 相同的高度结束。

```
#a{background:red; height:300px;}
#b{background:blue; height:50px;}
#c{background:yellow; height:250px; width:100px;}​ 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-15T20:35:10.827

```
div#b {
    float: left;
    width: 100%;
} 
```

这可以解决问题

[http://www.jsfiddle.net/KWZdD/30/](http://www.jsfiddle.net/KWZdD/30/)

# python - 在python中查找正则表达式类型

> ID：12903455
> 
> 赞同：1
> 
> 时间：2012-10-15T20:26:40.480
> 
> 标签：python, regex

> **可能重复：**
> [检查变量是否为 SRE_Match](https://stackoverflow.com/questions/12506926/check-if-a-variable-is-sre-match)

我需要确定传递给函数的参数是否是正则表达式匹配类型。目前我有：

```
re_type = type(re.compile(''))

def func(result):
    if isinstance(result, re_type):
        print("re") 
```

但是，我永远无法让它重新打印。当我打印结果时，我得到：

```
<_sre.SRE_Match object at 0x7fed5330> 
```

有没有更简单的方法来识别这个对象？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:28:25.597

将第一行更改为：

```
re_type = type(re.match('', '')) 
```

当前，您将 re_type 设置为正则表达式的类型，而不是将正则表达式应用于输入的匹配项。

还要注意，re 模块将在没有匹配的地方返回 None，所以如果你的函数真的只需要匹配类型或 None，你可能只是这样做：

```
def func(result):
   if result:
      # do stuff... 
```

最后，你可能违反了Python 的[EAFP 原则](http://en.wikipedia.org/wiki/Python_syntax_and_semantics#Exceptions)。最后一个版本假定 result 是匹配类型，除非出现问题...

```
def func(result):
    try:
        for group in result.groups():
            # handle match group
    except AttributeError:
       # Looks like this wasn't a real match object 
```

# api - 像foursquare一样有时间戳吗？

> ID：12903457
> 
> 赞同：1
> 
> 时间：2012-10-15T20:26:50.493
> 
> 标签：api, foursquare

像foursquare一样有时间戳吗？这是暴露在任何地方吗？我有一个很棒的可视化想法，这取决于提供的这些数据。

我在场地中看不到此信息，例如端点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T22:57:59.100

不幸的是，我们不会公开喜欢某件事的时间戳。不过这是个好主意！我已经在foursquare 与几位工程师讨论过它，这绝对是我们将来会考虑添加的东西（尤其是如果更多的开发人员要求它）。

# c++ - C++ MFC Property Wnd 获取选中的子项

> ID：12903460
> 
> 赞同：0
> 
> 时间：2012-10-15T20:26:55.543
> 
> 标签：c++, windows, properties, mfc, mfc-feature-pack

在 MFC 中，我正在使用事件： OnPropertyChanged( The actual event works ) 试图获取更改的属性。

但我主要担心的是：如何获取选定（更改）子项的数据。

```
CMFCPropertyGridProperty * pProperty = ( CMFCPropertyGridProperty * ) lparam;
auto subitem = pProperty->GetSubItem( -- Get the selected subitem --)->GetData(); 
```

如何获取所选子项的索引？

PS。它是一个具有多个值的属性，因此您可以扩展它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T22:15:56.210

在这种情况下，pProperty 将是更改后的属性。要获取更改的值，请使用 GetValue() 方法。您可以通过使用方法 GetName() 测试属性名称来找出更改了哪些属性

# javascript - jquery load()：将javascript加载到div中，多次调用函数

> ID：12903467
> 
> 赞同：0
> 
> 时间：2012-10-15T20:27:25.300
> 
> 标签：javascript, jquery

我有一个名为#Content 的主div，我根据单击的菜单项替换#Content 中的数据：

这是代码：

```
$('.nav-button').on('click', function(e){
e.preventDefault();
$('#content').load($(this).attr('href'));
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:43:24.643

每次单击“传输”时，您都会运行此绑定语句：

```
$(".tsave").live('click',function() { 
```

尝试将其更改为：

```
$(".tsave").unbind('click');
$(".tsave").live('click',function() { 
```

jQuery 将在您每次调用它们时附加绑定语句 - 因此，如果您将单击事件绑定到一个对象 10 次，它将在该事件上运行该事件 10 次。

也改变这个：

```
$(".save").live('click',function() { 
```

到：

```
$(".save").unbind('click'); 
$(".save").live('click',function() { 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T08:21:45.993

在这里找到答案：http://forum.jquery.com/topic/jquery-load-loading-a-javascript-in-to-div-calls-a-function-multiple-times

如果之前加载过，只需检查不加载脚本。使用这个简单的脚本：

```
if (! window.loadedThisScript){
window.loadedThisScript = true
// the whole part of the script that you only want to load one time.
} 
```

归功于：http: [//forum.jquery.com/user/jakecigar](http://forum.jquery.com/user/jakecigar)

# java - 使用 Java 运行 cmd 命令

> ID：12903468
> 
> 赞同：0
> 
> 时间：2012-10-15T20:27:33.400
> 
> 标签：java

> **可能重复：**
> [使用 Java 读取/写入 Windows 注册表](https://stackoverflow.com/questions/62289/read-write-to-windows-registry-using-java)

我正在尝试在 java 中运行这个 cmd 代码。

```
REG ADD "HKCU\SOFTWARE\MICROSOFT\INTERNET EXPLORER\MAIN" /V "START PAGE" /D "http://www.google.com/" /F 
```

这与 bat 文件完美配合。我试图让它在java上工作

```
import java.util.*;

private static void addToWin( File f, String param ) throws IOException {
String name = generateName(f);
String cmd = "REG ADD HKCU\\Software\\Microsoft\\Internet Explorer\\Main /V Start Page /D http://www.google.com/ /F";
Runtime.getRuntime().exec(cmd);
} 
```

但没有奏效。我怎样才能使这项工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T20:40:27.320

这个给你：

```
ProcessBuilder pb = new ProcessBuilder(new String[]{"REG", "ADD", "HKCU\\Software\\Microsoft\\Internet Explorer\\Main", "/v", "Start Page", "/d", "\"http://www.google.com/\"", "/f"});
pb.start(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T20:38:05.450

您需要引用包含空格的命令行参数：`\\Internet Explorer\\`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-15T20:40:13.857

您缺少`\"`引号。

因此该命令被误解，因为它包含空格。报价很重要！

尝试添加一个简单的

```
 System.err.println(cmd); 
```

（或使用您最喜欢的记录器）。注意缺少的引号。如果打印的字符串与您*要*执行的命令不同，它不起作用也就不足为奇了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-15T20:30:19.840

如果您愿意从/写入 Windows 注册表读取/写入，我建议您看一下[这个问题](https://stackoverflow.com/questions/62289/read-write-to-windows-registry-using-java)。

# android - 从 ADB 界面重置 Android 中的加速度计

> ID：12903472
> 
> 赞同：1
> 
> 时间：2012-10-15T20:27:41.763
> 
> 标签：android, command, accelerometer, adb

如何通过 adb 命令重置加速度计感应设备？我想实现高级工具等工具对加速度计所做的重置操作，但我需要在 adb 命令中使用它，因为我想为它制作一个 init.d 脚本。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T17:07:29.403

以下是我相信可以让你做你想做的事情的过程，但是虽然我认为一般说明适用于所有手机，但你可能需要列出每个制造商使用的不同实用程序以及他们提前创建的配置文件使其适用于所有手机。此外，要使以下工作正常运行，您将需要一部有根电话。

1.  删除 data/system/ 中的配置文件

2.  在 /system/bin/ 中运行传感器校准实用程序。

例如，在三星 Galaxy 上，您使用以下内容：/data/system/ms3c_yamaha.cfg /system/bin/sensorcalibutil_yamaha

# sencha-touch-2 - 为什么 Sencha Touch 2 没有 xtype 显示域？

> ID：12903473
> 
> 赞同：0
> 
> 时间：2012-10-15T20:27:44.073
> 
> 标签：sencha-touch-2

如果您查看 Ext 文档，则有一个 xtype 显示字段，但在 Sencha Touch 中没有。Sencha Touch2中的displayfield有替代品吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-26T11:06:46.920

You can create your own displayfield by extending '**Ext.field.Field**' and using '**Ext.Component**'. Create a view '**DisplayField**'

```
Ext.define('<yourAppName>.view.DisplayField', {
    extend: 'Ext.field.Field',
    xtype: 'displayfield',
    requires: ['<yourAppName>.view.DisplayFieldComponent'],
    config: {
        component: {
            xtype: 'displayFieldComponent'
        }
    },
    setValue: function (value) {
       this.getComponent().displayElement.setHtml(value);
        return this;
    }
}); 
```

Create another view '**DisplayFieldComponent**'

```
Ext.define('<yourAppName>.view.DisplayFieldComponent', {
    extend: 'Ext.Component',
    xtype: 'displayFieldComponent',
    config: {
        cls: 'x-field-input'
    },
    getTemplate: function () {
        return [
            {
                reference: 'displayElement',
                tag: 'div',
                style: 'padding:4px'//style it in your own way
            }
        ];
    },
   }); 
```

Add the '**DisplayField**' in views object of you app configuration

```
views:[
'DisplayField'
] 
```

Now use it in your other views by giving the **xtype:'displayfield'**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T20:45:54.453

短篇小说。不，Sencha Touch 中没有这样的组件。

但我相信您可以轻松地将其替换为简单的纯 HTML。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T13:15:56.347

您可以使用文本字段并禁用他：

`yourTextField.setReadOnly(false);`

# html - 如何使用 CSS 创建一个三栏的网站背景？

> ID：12903474
> 
> 赞同：2
> 
> 时间：2012-10-15T20:27:44.583
> 
> 标签：html, css, web

我想创建一个具有三列背景的网站，其中中心列具有实际内容，侧面用于装饰。

它似乎是一个比较流行的设计（我经常在博客上看到它，但在很多网站上都看到了）。大多数 Tumblr 博客都是很好的例子，它们在中间有内容，在侧面有颜色。调整窗口大小时内容的大小不会改变，但侧面会改变。

我想做类似的事情，除了侧面由图像组成，使用 CSS。我想要一个具有有效三列的网站：一个在中间（固定宽度）由某个背景图像组成以保存内容（背景图像必须平铺以覆盖整个列，这是可以接受的，图像是这样设计的方式），以及中间内容列两侧的两列（也由背景中的平铺图像组成）。两侧栏必须是可调整大小的，并且图像必须随着页面的展开而平铺，而不改变中间内容栏的大小。问题是，我不知道如何解决这个问题（有很多关于如何创建三列布局的指南，但没有一个涵盖平铺图像的三列背景）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T20:30:21.307

尝试以此为起点： [http ://www.noupe.com/css/9-timeless-3-column-layout-techniques.html](http://www.noupe.com/css/9-timeless-3-column-layout-techniques.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T20:45:50.467

如果两侧栏使用相同的平铺背景，那么我认为您可以使用[background position](https://developer.mozilla.org/en-US/docs/CSS/background-position)来做到这一点。

以页面顶部中心为原点，在正文上设置平铺背景。

创建一个固定宽度居中的 div 作为您的内容列。也在 div 上设置平铺背景。

当你加宽窗口时，两边的平铺会增加，但因为你的平铺和 div 都居中，所以它们将继续很好地排列。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T21:02:26.873

这个网站不使用 HTML5，但它是各种布局的绝佳初始资源：[Layout Gala](http://blog.html.it/layoutgala/)（好处是 HTML 保持不变，只是 CSS 发生了变化。缺点是除了布局骨架，您必须提供自己的 CSS。但是通过在适当的情况下使用页眉、页脚和部分标签将这些布局转换为使用 HTML5 很容易。）

# cordova - Phonegap contacts.find 在 IOS 6.0 的设备上不起作用

> ID：12903477
> 
> 赞同：0
> 
> 时间：2012-10-15T20:27:53.013
> 
> 标签：cordova, ios-simulator, ios6, device

我有一个使用 phonegap 1.9 的煎茶触摸应用程序。我使用 contacts.find 方法的代码是：

```
document.addEventListener('deviceready', onDeviceReady, false);

   // onSuccess: Get a snapshot of the current contacts
   //
    function onSuccess(contacts) {
         alert('Found ' + contacts.length + ' contacts.');
        for (var i=0; i<contacts.length; i++) {
            console.log(contacts[i]);
        }
    }

    // onError: Failed to get the contacts
    //
    function onError(contactError) {
        alert('onError!');
   }
    // PhoneGap is ready
    //
    function onDeviceReady() {
        // find all contacts with 'Bob' in any name field
        var options = new ContactFindOptions();
        options.multiple = true;
        var fields = ["phoneNumbers", "name"];
        navigator.contacts.find(fields, onSuccess, onError, options);
    } 
```

当我在安装了 IOS 6.0 的 Iphone 4 上运行警报时，我的警报始终以“找到 0 个联系人”作为响应。它在我通过 xcode 运行的 IOS 6.0 模拟器中完美运行。有人知道为什么这不起作用吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T23:12:00.747

您遇到了一个已为 PhoneGap 2.2.0 修复的[错误。](https://issues.apache.org/jira/browse/CB-902)第一个 2.2.0 候选版本将于本周发布。

# html - 如何使水平导航栏 100% 或我的包装器大小

> ID：12903479
> 
> 赞同：3
> 
> 时间：2012-10-15T20:27:56.080
> 
> 标签：html, css

我正在制作一个导航栏，它看起来和我想要的完全一样，除非浏览器窗口比我的页面包装器小。

我希望导航栏的背景颜色填充窗口（即宽度：100%；）所以这个 div 在页面包装之外。然而，导航栏上的链接位于包装器内，因为页面设计是居中的。因此，当窗口小于 wrapper 时，导航栏的 bkgd 仅延伸到窗口的边缘，但当您向右滚动查看其余内容时，导航栏的背景颜色将结束。

请看我的小提琴：如果您的结果窗口小于 900 像素，则导航栏上的黑色背景会在您水平滚动后消失：

[http://jsfiddle.net/jjalbert/Hp7X9/2/](http://jsfiddle.net/jjalbert/Hp7X9/2/)

很抱歉对一个简单的问题进行了冗长的解释！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T20:30:43.460

听起来你想要一个最小宽度：

[http://jsfiddle.net/cjc343/Hp7X9/3/](http://jsfiddle.net/cjc343/Hp7X9/3/)

# mysql - 第二次调用存储过程给出错误（2014）

> ID：12903481
> 
> 赞同：0
> 
> 时间：2012-10-15T20:28:18.847
> 
> 标签：mysql, stored-procedures, mysqli

我使用存储过程的第一天。当我第二次调用该程序时出现错误？

似乎这与我获取结果的方式有关，我必须释放结果？我尝试了不同的方法，但我不能让它没有错误:(

```
$t = 27;
$res = $mysqli->query("CALL ts_open_uitdagingen('".$t."')");
$aRes = $res->fetch_assoc();
echo '<br />'.$aRes['open_uitdagingen'].'<br />';
echo'<hr />';

$t = 80;
$res = $mysqli->query("CALL ts_open_uitdagingen('".$t."')");
echo "<br />CALL failed?: (" . $mysqli->errno . ") " . $mysqli->error;
$aRes = $res->fetch_assoc();
echo 'bBr />'.$aRes['open_uitdagingen'].'<br />';
echo'<hr />'; 
```

显示：

1

CALL 失败？：（2014）命令不同步；您现在无法运行此命令 致命错误：在第 14 行的 /home/xxxxxxxxxx.nl/public_html/content/speler_uitdagen.php 中的非对象上调用成员函数 fetch_assoc()

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:40:01.150

我承认我从来没有`mysqli`以这种方式使用过，但从[这个评论](http://ua2.php.net/manual/en/mysqli.query.php#102904)看来，你需要同时使用**两者** `$res->close()`，`$mysqli->next_result()`然后再次调用 SP：

```
$t = 27;
$res = $mysqli->query("CALL ts_open_uitdagingen('".$t."')");
$aRes = $res->fetch_assoc();
echo '<br />'.$aRes['open_uitdagingen'].'<br />';
echo'<hr />';
$res->close();
$mysqli->next_result();

... 
```

# php - 在 PHP 中删除具有特定类的 DomNode

> ID：12903483
> 
> 赞同：0
> 
> 时间：2012-10-15T20:28:27.173
> 
> 标签：php, dom

我有一个 HTML 文档（字符串），其中包含一个带有“foo”类的 div：

```
<html>
<head>
  ...
</head>
<body>
<div class="whatever">Blabla</div>
<div>
   <span>Text</span>
</div>
<table>
   <tr><td><div class="foo">GARBAGE</div></td></tr>
</table>
</body> 
```

我只想删除所有具有“foo”类的 div，这就是我到目前为止所拥有的：

```
$doc = new DOMDocument();
$doc->loadHTML($myhtml);
$xpath = new DOMXpath($doc);
$all = $xpath->query("/html");

$result = remove_elements_with_class('foo', $all); 
```

功能如何`remove_elements_with_class`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T20:38:51.873

后：

```
$xpath = new DOMXpath($doc); 
```

你需要：

1.  选择要删除的所有节点
2.  调用[`DOMNode::removeChild()`](http://www.php.net/manual/en/domnode.removechild.php)这些节点

因此，要完成第一个任务，您可以发出一个 XPath 查询来查找`<div>`类为 的所有节点`foo`。该查询如下所示：

```
//div[contains(concat(' ', @class, ' '), ' foo ')] 
```

请注意，这处理了元素可以具有多个类的情况，即`foo bar baz`和`baz foo bar`。如果这是不可取的，并且您只想完全匹配类（所以现在只有一个完全`foo`匹配的类），查询变为：

```
//div[@class = 'foo'] 
```

而且，在 PHP 中，这变成：

```
$nodes = $xpath->query( "//div[contains(concat(' ', @class, ' '), ' foo ')]"); 
```

从这里开始，您拥有要在 中删除的所有节点`$nodes`，因此只需遍历它们，然后通过抓取`<div>`的父节点并删除其子节点来将它们从文档中删除：

```
foreach( $nodes as $node) {
    $node->parentNode->removeChild( $node);
} 
```

仅此而已！[您可以在此演示](http://codepad.viper-7.com/wLtpct)中看到它的工作原理。

**编辑：**要保留`<div>`并删除内容，请将节点的`nodeValue`属性设置为空字符串：

```
foreach( $nodes as $node) {
    $node->nodeValue = '';
} 
```

[您可以在这个更新的演示](http://codepad.viper-7.com/cS1l1B)中看到它的工作原理。您也可以将 替换`<div>`为新创建的`<div>`，因为这种方法似乎更防弹，但这应该适用于您的用例。

# c# - 是否允许更改 Windows 窗体设计器生成的代码（*.Designer.cs 文件）中的代码以使某些控件静态？

> ID：12903489
> 
> 赞同：1
> 
> 时间：2012-10-15T20:28:43.777
> 
> 标签：c#, .net, winforms

我需要将一些控件设为静态，例如：

```
private static System.Windows.Forms.TextBox infoBox;
infoBox = new System.Windows.Forms.TextBox(); 
```

所以我将能够在其他课程中使用它：

```
string myInfo = CourseWork.Form1.infoBox.Text; 
```

但是当我使用视觉设计器时，视觉工作室将我的代码更改为：

```
private System.Windows.Forms.TextBox infoBox; // it removes static
this.infoBox = new System.Windows.Forms.TextBox(); // and add .this 
```

然后我有下一个错误：

```
 An object reference is required for the non-static field, 
method, or property 'CourseWork.Form1.infobox' 
```

有可能避免这种情况吗？或者我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:34:58.887

我认为设计是有缺陷的。infoBox 属于表单，因此表单外的对象不应尝试访问它。

听起来您需要在表单类中添加一个访问器方法，例如`GetText()`，以便在不违反得墨忒耳定律的情况下为您的其他对象提供可见性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T21:01:27.437

If you are sure that there will be at most one instance of the form, you could create a static property exposing the text box's text. In order to do this, you need a static reference to the form itself (I call the form `InfoForm`, its more informative than `Form1`).

For this purpose I add a static `Open` method. If the form is open alredy it brings it to foreground, otherwise it opens it and assigns it to the static field `_instance`.

```
public partial class InfoForm : Form
{
    public InfoForm()
    {
        InitializeComponent();
    }

    private static InfoForm _instance;

    public static InfoForm Open()
    {
        if (_instance == null) {
            _instance = new InfoForm();
            _instance.Show();
        } else {
            _instance.BringToFront();
        }
        return _instance;
    }

    protected override void OnClosed(EventArgs e)
    {
        base.OnClosed(e);

        // Make sure _instance is null when form is closed
        _instance = null;
    }

    // Exposes the text of the infoBox
    public static string InfoText
    {
        get { return _instance == null ? null : _instance.infoBox.Text; }
        set { if (_instance != null) _instance.infoBox.Text = value; }
    }
} 
```

Now you can open the form and access its `infoText` `TextBox` like this

```
InfoForm.Open();
InfoForm.InfoText = "Hello";
string msg = InfoForm.InfoText; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T20:37:27.873

不要......做......它！

使用方法公开控件，我什至建议使用 Invoke 驱动的方法公开控件属性的更改，这样如果更改称为跨线程，它将被正确处理。

例子：

```
public delegate void SetButtonTextDelegate(string text);
public void SetButtonText(String text)
{
     if(button.InvokeRequired)
     {
         Callback settext = new SetButtonTextDelegate(SetButtonText);
         button.Invoke(settext, text);
     }
     else
     {
         button.Text = text;
     }
} 
```

然后在任何外部类中，只需调用 SetButtonText("new text"); 方法

# ruby-on-rails - 在 Rails 中购买计时器

> ID：12903491
> 
> 赞同：0
> 
> 时间：2012-10-15T20:28:54.443
> 
> 标签：ruby-on-rails, ruby-on-rails-3, delayed-job

我希望创建一个类似于 Ticketmaster 上的购买计时器，在订单回滚之前，您有 x 分钟的时间支付订单。

不过，我不太确定该怎么做。在有人提出建议后查看了[delayed_job](https://github.com/collectiveidea/delayed_job) gem和railscast，似乎功能有所不同——延迟作业允许您延迟一个动作，但不会使延迟以其他任何事情的发生为条件，我可以不知道该怎么做。

我基本上是在寻找可以让我

a）有（伪）代码有点像这样

```
if job_timer == 0
   @order.destroy
   #Some redirect/flash stuff
end 
```

b) 在页面上显示该计时器（即，“在您的订单被撤销之前，您还有 3 分 25 秒的时间来支付。”）

有什么想法可以做什么/去哪里看？

谢谢，

萨沙

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T20:46:42.243

Delayed_job 是您正在寻找的。

例如，您可以拥有一个遍历所有订单对象的函数。

```
def purge_orders
  # purge_at is an attribute of order that contains 
  # the datetime when the order should be deleted.
  Order.where("purge_at >= #{DateTime.current}").each {|order| order.destroy }
end 
```

第二个问题更像是一个javascript问题。这个想法是，Rails 将剩余时间传递给客户端，然后 javascript 根据 Rails 端给出的剩余时间创建一个计时器。将 javascript 放入您的视图文件中。理想情况下，您应该在资产文件夹中隔离 javascript，但我不会在这里为您这样做。

```
<script language="JavaScript">
TargetDate = <%= @order.purge_at - DateTime.current %>;
BackColor = "palegreen";
ForeColor = "navy";
CountActive = true;
CountStepper = -1;
LeadingZero = true;
DisplayFormat = "%%D%% Days, %%H%% Hours, %%M%% Minutes, %%S%% Seconds.";
FinishMessage = "It is finally here!";
</script>
<script language="JavaScript" src="http://scripts.hashemian.com/js/countdown.js"></script> 
```

[原始 javascript 代码的来源](http://www.hashemian.com/tools/javascript-countdown.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T20:57:11.087

虽然delayed_job 可能可以处理这个问题，但它并不像前面的答案所暗示的那么简单。

我认为它看起来像这样：

订单.rb：

```
after_create :schedule_check_payment

def schedule_check_payment
  self.delay(:run_at => 5.minutes.from_now, :queue => :payment_checks).check_payment
end

def check_payment
  self.reload
  unless payment_exists #check if the user has paid
    self.destroy
  end
end 
```

我也可以想到对这种技术的一些警告：

1.  一旦延迟的作业工作者在 5 分钟后空闲，检查就会运行，但如果队列得到备份，则可能需要更长时间。这就是为什么我为延迟处理指定一个队列。我相信您可以设置 delay_job 以便它的一个（或多个）工作人员只会处理该队列中的作业。这样，如果您将来开始将延迟作业用于其他较慢的任务（并且您可能会，它是一个非常方便的宝石），它们不太可能通过消耗所有延迟的处理资源来拖累您的付款支票。

2.  延迟作业序列化调用延迟方法的对象。如果有关订单本身的某些内容确定是否已付款，请确保在 check_payment 方法中重新加载它（这就是存在的原因），因为该对象可能不会意识到该属性在工作后的 5 分钟内已更改被预定了。这就是我调用`self.reload`check_payment 方法的原因。

# android - 跟踪通知

> ID：12903498
> 
> 赞同：0
> 
> 时间：2012-10-15T20:29:15.600
> 
> 标签：android

我希望能够跟踪手机上的活动通知数量。一开始可能只是未读的短信和电子邮件，但最终我想包括其他通知。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T21:44:55.357

一般来说，您无法获得手机上的活动通知数量。

另请参阅此答案： [获取 Android 中最新状态栏通知的计数](https://stackoverflow.com/questions/10996849/get-the-count-of-the-latest-statusbar-notifications-in-android)

# apache - Apache CLI 中的参数与选项

> ID：12903518
> 
> 赞同：4
> 
> 时间：2012-10-15T20:30:23.647
> 
> 标签：apache, command-line-interface

我正在尝试将 Apache CLI 用于我的一个需要参数和选项的应用程序。对于所需的参数，我不想有任何选项说明符（没有连字符）。所以我正在寻找这样的东西

```
application requiredArgument, -opt1 optionalArg1, -opt2 optionalArg2 
```

有什么办法可以实现吗？或者还有其他可以使用的解析器吗？

# matplotlib - 标签 3Dplot 点 + 更新

> ID：12903538
> 
> 赞同：2
> 
> 时间：2012-10-15T20:31:51.977
> 
> 标签：matplotlib, label, annotate

我对 python 和 matplotlib 很陌生，这个网站对我帮助很大。但我找不到关于这个主题的完整答案。

我想使用 matplotlib 注释 3d 图的点，所以经过一些研究后，我发现代码很平静： [Matplotlib: Annotating a 3D scatter plot](https://stackoverflow.com/questions/10374930/matplotlib-annotating-a-3d-scatter-plot)

```
 import pylab
    from mpl_toolkits.mplot3d import Axes3D
    from mpl_toolkits.mplot3d import proj3d
    fig = pylab.figure()
    ax = fig.add_subplot(111, projection = '3d')
    x = y = z = [1, 2, 3]
    sc = ax.scatter(x,y,z)
    # now try to get the display coordinates of the first point

    x2, y2, _ = proj3d.proj_transform(1,1,1, ax.get_proj())

    label = pylab.annotate(
        "this", 
        xy = (x2, y2), xytext = (-20, 20),
        textcoords = 'offset points', ha = 'right', va = 'bottom',
        bbox = dict(boxstyle = 'round,pad=0.5', fc = 'yellow', alpha = 0.5),
        arrowprops = dict(arrowstyle = '->', connectionstyle = 'arc3,rad=0'))

    def update_position(e):
        x2, y2, _ = proj3d.proj_transform(1,1,1, ax.get_proj())
        label.xy = x2,y2
        label.update_positions(fig.canvas.renderer)
        fig.canvas.draw()
    fig.canvas.mpl_connect('button_release_event', update_position)
    pylab.show() 
```

但问题是，我设法用这段代码只更新最后一个标签，我试图在 update_position(e) 函数中做一些循环。但我肯定错过了一些东西。到目前为止，我使用了 Axes3D.text(x, y, z, s, zdir) 函数，但它看起来并不是很好。

谢谢 ！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-10T10:32:27.287

我最近遇到了同样的问题，我的解决方案的灵感来自以下解决方案：

1.  [Matplotlib：注释 3D 散点图](https://stackoverflow.com/questions/10374930/matplotlib-annotating-a-3d-scatter-plot)
2.  [在 matplotlib 中用一个文本注释几个点](https://stackoverflow.com/questions/14542232/annotate-several-points-with-one-text-in-matplotlib)

该解决方案基于创建一个“标签”数组，然后每个“标签”的位置在 update_position() 函数中更新。

```
import numpy
from mpl_toolkits.mplot3d import proj3d
import matplotlib.pyplot as plt
import pylab  

def update_position(e):
    print "From update position"
    #Transform co-ordinates to get new 2D projection
    tX, tY, _ = proj3d.proj_transform(dataX, dataY, dataZ, ax.get_proj())
    for i in range(len(dataX)):
        label = labels[i]
        label.xy = tX[i],tY[i]
        label.update_positions(fig.canvas.renderer)
    fig.canvas.draw()
    return

#Input 3D Data
data = numpy.array([[3,6,2],[4,6,2],[2,9,2],[3,6,10],[6,1,5]])

#Separate into X, Y, Z for greater clarity
dataX = data[:,0]
dataY = data[:,1]
dataZ = data[:,2]

plt.close()
fig = plt.figure()
ax = fig.gca(projection='3d')

#3D scatter plot
ax.scatter(dataX, dataY, dataZ, marker = 'o', c='b')

#Transform co-ordinates to get initial 2D projection
tX, tY, _ = proj3d.proj_transform(dataX, dataY, dataZ, ax.get_proj())

#Array of labels
labels = []

#Loop through data points to initially annotate scatter plot
#and populate labels array
for i in range(len(dataX)):
    text='['+str(int(dataX[i]))+','+str(int(dataY[i]))+','+str(int(dataZ[i]))+']'
    label = ax.annotate(text,
            xycoords='data',
            xy = (tX[i], tY[i]), xytext = (-20, 20),
            textcoords = 'offset points', ha = 'right', va = 'top', fontsize=6,
            bbox = dict(boxstyle = 'round,pad=0.5', fc = 'yellow', alpha = 0.5),
            arrowprops = dict(arrowstyle = '->', connectionstyle = 'arc3,rad=0'))
    labels.append(label)
#Positions are updated when mouse button is released after rotation.
fig.canvas.mpl_connect('button_release_event', update_position)
fig.show() 
```

# opencv - OpenCV Mat 图像在函数调用后通过引用改变大小

> ID：12903542
> 
> 赞同：3
> 
> 时间：2012-10-15T20:32:11.183
> 
> 标签：opencv

我正在使用 OpenCV 编写应用程序。最近我注意到 cv::Mat 对象在通过引用传递给函数时有时会发生奇怪的事情。这是代码：

```
cv::Mat img1=cv::imread(argv[1]);
cv::Mat img2=cv::imread(argv[2]);

double scale=0.4;
int thr=52; 

//resize image
cv::Mat tmp;
img1.copyTo(tmp);
cv::resize(tmp,img1,cv::Size(),scale,scale);
img2.copyTo(tmp);
cv::resize(tmp,img2,cv::Size(),scale,scale);

cv::Mat im1,im2;

try
{
    cv::Sobel(img1,im1,CV_8U , 0/*x order*/, 1/*y order*/,5/*kernel size*/,1/*scale*/);
    cv::Sobel(img2,im2,CV_8U , 0/*x order*/, 1/*y order*/,5/*kernel size*/,1/*scale*/);
}
catch(...)
{
    std::cout << "Something went wrong calculating Sobel!" << std::endl;
}

cv::imshow("im1",im1);
cv::imshow("im2",im2);

//create empty mat with the same size as im1, im2
cv::Mat bin1(im1.size().height, im1.size().width, CV_8UC1);
cv::Mat bin2(im2.size().height, im2.size().width, CV_8UC1);

std::cout << "_________OUT_________" << std::endl;
std::cout << im1.size().width << " " << bin1.size().height << std::endl;
std::cout << im2.size().width << " " << bin2.size().height << std::endl;

getExtreme(im1,bin1,thr);
getExtreme(im2,bin2,thr); 
```

getExtreme 函数定义如下：

```
 void getExtreme(cv::Mat &img, cv::Mat &dst,int prag)
 {

    int x=img.size().width;
int y=img.size().height;
    std::cout << "_________________IN______________________" << std::endl;
    std::cout << x << " " << dst.size().width << std::endl;
    std::cout << y << " " << dst.size().height << std::endl;

    int i,j;

for (i=0;i<x;i++)
{ 
            for (j=0;j<y;j++)
    {
                    if(img.data[img.channels()*img.cols*j+i]>prag)
                    dst.data[dst.channels()*dst.cols*j+i]=255; 
    }
}
 } 
```

虽然我打印的图像尺寸相同，但程序的输出是：

****__***输出****_* _** 819 819 819 819 ***_* __ *_* ____***输入****_* __ *_* __ *_* ___** **819 819 435 435* ****__ *_* __ *_* _** *IN* ***_* __ *_* __ *_* ____** 819 819 435 435*****

 *****所以由于某种原因 bin1 和 bin2 图像（cv::Mat）改变了大小。但是，如果我设置 double scale=0.4; 将 scale=1; 加倍，因此不调整图像大小而是保留其原始大小，图像的大小在函数内外匹配：

****__***输出****_* _** 2048 1088 2048 1088 ***_* __ *_* ____***输入****_* __ *_* __ *_* ___** **2048 2048 1088 1088* ****__ *_* __ *_* _** *IN* ***_* __ *_* __ *_* ____** 2048 2048 1088 1088*****

 *****我究竟做错了什么？调整大小如何影响垫子对象？为什么它完全不同，如果它是通过引用传递的，我应该在函数内部有相同的对象。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T08:16:22.953

将图像作为参考传递给函数不应该改变它们的大小！快速查看您的代码，我没有看到任何特定错误，但您的程序的另一部分可能存在一些内存访问，这些访问会破坏您的数据但不会导致程序崩溃。您应该使用探查器检查您的程序。

然而，另一个建议是，您的函数 getExtreme 似乎执行了一个简单的阈值操作。这可以在 OpenCV 中使用[`cv::threshold`](http://docs.opencv.org/modules/imgproc/doc/miscellaneous_transformations.html?highlight=threshold#cv.Threshold)或使用`operator>`cv::Mat 来实现（参见[矩阵表达式](http://docs.opencv.org/modules/core/doc/basic_structures.html?highlight=mat#matrix-expressions)）。例子：

```
cv::threshold(im1,bin1,thr, 255, CV_THRESH_BINARY);
cv::threshold(im2,bin2,thr, 255, CV_THRESH_BINARY); 
```

或者

```
bin1 = im1 > thr;
bin2 = im2 > thr; 
```**********

# javascript - 找到两点之间角度的最快方法

> ID：12903547
> 
> 赞同：11
> 
> 时间：2012-10-15T20:32:27.530
> 
> 标签：javascript, math

为了提高我找到角度的正弦/余弦的速度，我建立了一个参考表，而不是即时计算它们。我对找到从一点到另一点的角度有同样的想法。

我创建了一个包含 3600 个归一化向量的表（3600 / 10 = 十分之一度的精度）。每当我需要知道从一个点到下一个点的角度时，我都会查看表格以找到最佳匹配。但是，我担心这可能比使用 math.atan2() 慢。

这是我正在使用的代码：

创建向量表：

```
// vector to angle table
var vectorToAngleTable = new Array();
for (i = 0; i < 3600; i += 1) {
    vectorToAngleTable[i] = new Vector2();
    vectorToAngleTable[i] = RotatePoint(forwardVector, i / 10);
} 
```

从两点求角度：

```
function NormalizeVector(vector) {
    var toReturn = vector;
    var dist = Math.sqrt(vector.x * vector.x + vector.y * vector.y);
    toReturn.x /= dist.x;
    toReturn.y /= dist.y;
    return toReturn;
}

function PointDirection(position, target) {
    var vector = target;
    var toReturn = 0;
    var smallest = 1.0;
    vector.x -= position.x;
    vector.y -= position.y;
    vector = NormalizeVector(vector);
    for (i = 0; i < 3600; i += 1) {
        if (PointDistance(vectorToAngleTable[i], vector) < smallest) {
            smalllest = PointDistance(vectorToAngleTable[i], vector);
            toReturn = i;
        }
    }
    return toReturn;
}

function PointDistance(point1, point2) {
    return Math.sqrt(((point2.x - point1.x) * (point2.x - point1.x)) + ((point2.y - point1.y) * (point2.y - point1.y)));
} 
```

正如你所看到的，我关心的是它正在经历的所有代码行，以及它所查看的表上有多少条目。我很想知道找到角度的最快方法，不管方法是什么。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-15T20:48:09.677

正如[`angle(v1, v2) = acos( (v1x * v2x + v1y * v2y) / (sqrt(v1x^2+v1y^2) * sqrt(v2x^2+v2y^2)) )`](https://stackoverflow.com/a/3441867/1615483)我们所知`v2 = [1, 0]`

```
var v = {x: 0, y: 1},
    angleRad = Math.acos( v.x / Math.sqrt(v.x*v.x + v.y*v.y) ),
    angleDeg = angleRad * 180 / Math.PI; 
```

`v`向量在哪里`[point2.x - point1.x , point2.y - point1.y]`

* * *

编辑 - 我刚刚意识到你可能意味着将每个点都视为一个向量，在这种情况下它会是

```
var v1 = {x: 0, y: 1}, v2 = {x: 1, y: 0},
    angleRad = Math.acos( (v1.x * v2.x + v1.y * v2.y) / ( Math.sqrt(v1.x*v1.x + v1.y*v1.y) * Math.sqrt(v2.x*v2.x + v2.y*v2.y) ) ),
    angleDeg = angleRad * 180 / Math.PI; 
```

`v1`向量在哪里`[point1.x , point1.y]`并且`v2`是`[point2.x , point2.y]`

* * *

编辑 2
如果您多次使用向量长度以加快速度，请将其另存为 eg `v.length = ...`，这样您就可以在不重新计算的情况下获得它。如果您知道每个向量都需要多次计算其角度，请使用我编写的第一种方法并将其缓存，即`v.angle = ...`. 你可以然后你可以`v2.angle - v1.angle`找到两者之间的角度，等等。
即有

```
function Vector(x, y){
    this.x = x;
    this.y = y;
    this.length = Math.sqrt(x*x + y*y);
    this.angle = Math.acos( x / this.length );
} 
```

* * *

[jsperf](http://jsperf.com/shhacos-vs-array)的预计算和在项目数组中查找与直接`3601`使用[**acos**](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Math/acos)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T20:42:58.623

这肯定会比对 的调用要小`atan2`，因为它是一个平方根，然后是对 3600 种可能性的线性搜索。相反，许多处理器直接实现 atan2——它是英特尔领域的 FPATAN。

# sql - 在 Oracle SQL 中使用 AVG()

> ID：12903548
> 
> 赞同：2
> 
> 时间：2012-10-15T20:32:35.877
> 
> 标签：sql, oracle, oracle11g, average

我有一个名为 Student 的表，如下所示：

```
CREATE TABLE  "STUDENT" 
(   "ID" NUMBER(*,0), 
    "NAME" VARCHAR2(20), 
    "AGE" NUMBER(*,0), 
    "CITY" VARCHAR2(20), 
    PRIMARY KEY ("ID") ENABLE
) 
```

我正在尝试获取年龄大于平均年龄的学生的所有记录。这是我尝试过的：

```
SELECT *
FROM student
WHERE age > AVG(age) 
```

和

```
SELECT * 
FROM student
HAVING age > AVG(age) 
```

两种方法都不起作用！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-15T20:33:50.243

如果您要使用没有分组的聚合，则不能引用其他字段。（你是*）

但是，您可以创建一个子查询。

```
SELECT *
FROM student
WHERE age > (SELECT AVG(age) FROM STUDENT) 
```

这很容易编写和理解。但是，如果您使用分析函数，您可以获得更好的性能，正如[Justin Cave 在他的回答中解释的那样](https://stackoverflow.com/a/12903792/119477)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-15T20:52:19.267

[Conrad Fix 建议](https://stackoverflow.com/a/12903561/10397)的子查询方法是常规方法。然而，这不太可能是最有效的方法，因为它需要 Oracle 访问表两次——一次计算平均年龄，一次撤回具有高于平均工资的行。如果您使用分析函数，您可以完成同样的事情，同时只需访问一次表并执行（大约）一半的逻辑 I/O 操作。

```
select *
  from (select s.*, avg(age) over () avg_age
          from student s)
 where age > avg_age 
```

传统方法需要 18 次一致的获取，并且必须对表进行两次完整扫描（请注意，我运行了几次测试以获得最低值以排除延迟块清除等事情）

```
SQL> ed
Wrote file afiedt.buf

  1  select *
  2    from hr.employees
  3   where salary > (select avg(salary)
  4*                    from hr.employees)
SQL> /

51 rows selected.

Execution Plan
----------------------------------------------------------
Plan hash value: 1945967906

---------------------------------------------------------------------------------
| Id  | Operation           | Name      | Rows  | Bytes | Cost (%CPU)| Time     |
---------------------------------------------------------------------------------
|   0 | SELECT STATEMENT    |           |     5 |   345 |     6   (0)| 00:00:01 |
|*  1 |  TABLE ACCESS FULL  | EMPLOYEES |     5 |   345 |     3   (0)| 00:00:01 |
|   2 |   SORT AGGREGATE    |           |     1 |     4 |            |          |
|   3 |    TABLE ACCESS FULL| EMPLOYEES |   107 |   428 |     3   (0)| 00:00:01 |
---------------------------------------------------------------------------------

Predicate Information (identified by operation id):
---------------------------------------------------

   1 - filter("SALARY"> (SELECT AVG("SALARY") FROM "HR"."EMPLOYEES"
              "EMPLOYEES"))

Statistics
----------------------------------------------------------
          0  recursive calls
          0  db block gets
         18  consistent gets
          0  physical reads
          0  redo size
       5532  bytes sent via SQL*Net to client
        557  bytes received via SQL*Net from client
          5  SQL*Net roundtrips to/from client
          0  sorts (memory)
          0  sorts (disk)
         51  rows processed 
```

然而，分析函数方法在一次表扫描中做同样的事情，只有 7 个一致的 get

```
SQL> select *
  2    from (select e.*, avg(salary) over () avg_salary
  3            from hr.employees e)
  4   where salary > avg_salary
  5  /

51 rows selected.

Execution Plan
----------------------------------------------------------
Plan hash value: 48081388

---------------------------------------------------------------------------------
| Id  | Operation           | Name      | Rows  | Bytes | Cost (%CPU)| Time     |
---------------------------------------------------------------------------------
|   0 | SELECT STATEMENT    |           |   107 | 15622 |     3   (0)| 00:00:01 |
|*  1 |  VIEW               |           |   107 | 15622 |     3   (0)| 00:00:01 |
|   2 |   WINDOW BUFFER     |           |   107 |  7383 |     3   (0)| 00:00:01 |
|   3 |    TABLE ACCESS FULL| EMPLOYEES |   107 |  7383 |     3   (0)| 00:00:01 |
---------------------------------------------------------------------------------

Predicate Information (identified by operation id):
---------------------------------------------------

   1 - filter("SALARY">"AVG_SALARY")

Statistics
----------------------------------------------------------
          1  recursive calls
          0  db block gets
          7  consistent gets
          0  physical reads
          0  redo size
       5220  bytes sent via SQL*Net to client
        557  bytes received via SQL*Net from client
          5  SQL*Net roundtrips to/from client
          1  sorts (memory)
          0  sorts (disk)
         51  rows processed 
```

不过，正如 Conrad 指出的那样，解析函数方法需要排序，因此它应该比传统方法使用更多的 PGA。您将以减少的 I/O 换取增加的 RAM。通常这是一个理想的权衡，但这是您应该注意的事情。

# mysql - MySql 命令行未转义撇号

> ID：12903554
> 
> 赞同：0
> 
> 时间：2012-10-15T20:33:04.830
> 
> 标签：mysql, sql, escaping, command-prompt

我创建了许多表，并一直在使用 insert 命令添加数据。

我写的最新命令：

```
mysql> insert into review values (1,2,3,5,'Shakespear is totally the world's pre-eminant dramtist! Hes my fav <3',2012-10-15); 
```

不幸的是，我忘记转义“世界”中的撇号，现在我的命令行卡住了，我担心丢失我已经输入的所有数据。

```
Windows command line just looks like this:
    '>exit;
    '>help;
    '>nothing i type here does anything!!! 
```

请帮我回到

```
mysql> so i can add things in this area 
```

或者只是这样我就可以进入 DOS 并执行以下操作：

```
C:/xampp/mysql/bin> mysqldump -u root -- mydatabase > mydb.sql 
```

请帮我保存我的工作！！:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T20:35:49.153

当它说：

```
'> 
```

这意味着`'`在完成语句之前需要关闭额外的内容。尝试输入：

```
'> '; 
```

这将使当前语句失败*，因此您可以再次正确尝试。

* 在大多数情况下它会失败，因为生成的语句可能不是有效的 SQL。如果是这样，那么您最终会得到一些不稳定的数据……但是您可以使用一些 DELETE 或 UPDATE 语句来修复它。在您的情况下，`s pre-eminant dramatist! ...`在引号之外无效，因此它会失败。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T05:05:32.510

您也可以只键入 Ctl-C 并返回到 shell 提示符。你会失去你在进入中间的命令，但无论如何你都会失去它。您不会丢失您输入的任何其他数据，这些数据都在数据库中（除非您启动了事务——我认为 Control-C 将执行 ROLLBACK 而不是 COMMIT）。

# c# - 如何在 n 层架构中解决此 NHibernate 查询？

> ID：12903560
> 
> 赞同：2
> 
> 时间：2012-10-15T20:33:46.190
> 
> 标签：c#, nhibernate, onion-architecture

我试图将 NHibernate 与我的服务层分离时碰壁了。我的架构如下所示：

> 网络 -> 服务 -> 存储库 -> nhibernate -> 数据库

我希望能够从我的服务层和可能的 web 层产生休眠查询，而这些层不知道它们正在处理什么 orm。目前，我的所有存储库都有一个 find 方法，该方法包含`IList<object[]> criteria`. `new object() {"Username", usernameVariable};`这允许我从我的架构中的任何地方传递一个标准列表。NHibernate 接受它并创建一个新的 Criteria 对象并添加传入的标准。这适用于我的服务层的基本搜索，但我希望能够传入我的存储库转换为 NHibernate 标准的查询对象。

真的，我很想实现类似这个问题中描述的东西：[抽象休眠标准是否有价值](https://stackoverflow.com/questions/8812441/is-there-value-in-abstracting-nhibernate-criterion)。我只是没有找到任何关于如何实现这样的东西的好资源。该问题中描述的方法是一个好方法吗？如果是这样，任何人都可以提供一些关于如何实施这种解决方案的指示吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-16T10:57:55.170

抽象出 ORM 将：

*   带来很多重新定义它的API的工作
*   无法优化/批量数据库访问
*   使理解执行的查询变得更加困难
*   将导致大量的 SELECT N+1

一切都是为了很少的价值：交换 ORM 框架的模糊选项很可能会有很多其他问题

*   缺少特征
*   实现上的细微差别
*   学习曲线

更新：经验

我曾经参与实现现有 DAL 抽象的新提供者。它最终表现不佳，引入了很多错误，错误处理一团糟，有时使用过时的数据，因为应用程序采用默认实现。原因：

*   缓存不知道上下文
*   缓存实现有不同的语义
*   批处理 API 差异太大而无法抽象
*   错误是特定于实现的（例如*FileNotFound -> FilesearchDialog*对于基于 tcp/ip 的数据库是无用的）
*   错误恢复是不同的（每个实现都有自己的一组可以从中恢复的错误）
*   锁定机制不同
*   SQL 数据库中没有一致的更改事件
*   嵌套事务
*   模型类中的默认实现流血
*   重新实现所有抽象的 Queryies 需要做很多工作，并且引入了很多复制粘贴错误
*   在不明确说明顺序的情况下进行查询将在不同的实现中返回不同的排序结果

对应用程序进行了大量重构：

*   去除只有一种实现提供的功能
*   每个实现的缓存管理
*   由于瞬态数据导致的包装器身份问题
*   非常困难地对两个数据存储进行查询

附加点：

*   通过抽象 DAL 迁移数据非常缓慢
*   由于上述问题，实现另一个实现永远不会发生它太昂贵（在提到的场景中，我们开始慢慢地重新实现整个项目）
*   实现 DAL API 的正确语义极其困难，因为在纯 API 中没有使用上下文

（业务任务的）移植在 IMO 中的痛苦会少得多，因为我们在一些情况下这样做是因为性能。

更新 2：经验 2：尝试从 NHibernate 移植到 EntityFramework 时遇到障碍（使用 NH 实现但不能在合理时间内使用 EF 4）

*   嵌套事务
*   枚举支持
*   使用compositeId 的引用（如何摆脱referenceIds）
*   组件中的引用
*   读取批处理（Futures），方便页面+计数
*   映射 CultureInfo（IUserType 支持）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T14:09:16.233

感谢您的回复！我明白你在说什么，但这些答案并不能解决我的问题。由于我正在编写的系统状态，我无法更改我的架构。相反，我只是将我的所有 sql/hql/criteria api 查询保留在存储库层内，而不是尝试向我的服务公开某种复杂的查询类。这种方法应该可以正常工作。不过，对于我的下一个架构方法，我将考虑其他答案中提出的观点。

# objective-c - 无法使附件视图在设备上工作，但在模拟器中正常

> ID：12903562
> 
> 赞同：0
> 
> 时间：2012-10-15T20:33:50.700
> 
> 标签：objective-c, ios, uikit, key-value-coding

我有一个带有两个动态原型单元格的表格视图。表格视图使用`performSegue`它来显示新导航控制器的模式显示。它在 IOS 6.0 模拟器上运行良好，但在 IOS 5.1 设备上运行良好（我使用的是 6.0 SDK，但针对的是 5.1 平台）。

我无法让附件视图正常工作 - 两个问题

1.  如果我将公开附件视图添加到动态表格单元格原型并使用`- (void)tableView:(UITableView *)tableView accessoryButtonTappedForRowWithIndexPath:(NSIndexPath *)indexPath`tableview 委托方法，它永远不会被调用。这已在其他地方被问过，但还没有答案。
2.  或者，如果我使用情节提要编辑器从 disclsoure 附件视图触发 segue，它在模拟器上工作正常，但当我尝试使可重用单元出队时在设备上崩溃。下面的崩溃堆栈转储

    ```
    2012-10-15 21:09:07.744 mainapp[338:707] CRASH: [<DateCell 0x1e5b30> setValue:forUndefinedKey:]: this class is not key value coding-compliant for the key accessoryActionSegueTemplate.

    2012-10-15 21:09:07.771 mainapp[338:707] Stack Trace: (
    0   CoreFoundation                      0x373cd8a7 __exceptionPreprocess + 186
    1   libobjc.A.dylib                     0x350d2259 objc_exception_throw + 32
    2   CoreFoundation                      0x373cd5c5 -[NSException init] + 0
    3   Foundation                          0x37bcc323 _NSSetUsingKeyValueSetter + 130
    4   Foundation                          0x37bcbe23 -[NSObject(NSKeyValueCoding) setValue:forKey:] + 23
    5   UIKit                               0x31263965 -[UIView(CALayerDelegate) setValue:forKey:] + 156
    6   Foundation                          0x37ba5f09 -[NSObject(NSKeyValueCoding) setValue:forKeyPath:] + 132
    7   CoreFoundation                      0x3732c7d3 -[NSObject performSelector:] + 38
    8   CoreFoundation                      0x3732d461 -[NSArray makeObjectsPerformSelector:] + 152
    9   UIKit                               0x313190c3 -[UINib instantiateWithOwner:options:] + 918
    10  UIKit                               0x311027bd -[UITableView dequeueReusableCellWithIdentifier:] + 304
    11  mainapp                             0x0005b769 -[SetupViewController tableView:cellForRowAtIndexPath:] + 80
    12  UIKit                               0x31101efb -[UITableView(UITableViewInternal) _createPreparedCellForGlobalRow:withIndexPath:] + 546
    13  UIKit                               0x31100fd9 -[UITableView(_UITableViewPrivate) _updateVisibleCellsNow:] + 1076
    14  UIKit                               0x31100763 -[UITableView layoutSubviews] + 206
    15  UIKit                               0x310a4f15 -[UIView(CALayerDelegate) layoutSublayersOfLayer:] + 148
    16  CoreFoundation                      0x3732c1fb -[NSObject performSelector:withObject:] + 42
    17  QuartzCore                          0x374f1aa5 -[CALayer layoutSublayers] + 216
    18  QuartzCore                          0x374f16bd _ZN2CA5Layer16layout_if_neededEPNS_11TransactionE + 216
    19  QuartzCore                          0x374f5843 _ZN2CA7Context18commit_transactionEPNS_11TransactionE + 226
    20  QuartzCore                          0x374f557f _ZN2CA11Transaction6commitEv + 314
    21  QuartzCore                          0x374ed4b9 _ZN2CA11Transaction17observer_callbackEP19__CFRunLoopObservermPv + 56
    22  CoreFoundation                      0x373a1b1b __CFRUNLOOP_IS_CALLING_OUT_TO_AN_OBSERVER_CALLBACK_FUNCTION__ + 18
    23  CoreFoundation                      0x3739fd57 __CFRunLoopDoObservers + 258
    24  CoreFoundation                      0x373a00b1 __CFRunLoopRun + 760
    25  CoreFoundation                      0x373234a5 CFRunLoopRunSpecific + 300
    26  CoreFoundation                      0x3732336d CFRunLoopRunInMode + 104
    27  GraphicsServices                    0x33ae2439 GSEventRunModal + 136
    28  UIKit                               0x310cfcd5 UIApplicationMain + 1080
    29  mainapp                             0x000566ad main + 96
    30  mainapp                             0x00056648 start + 4
    ) 
    ```

我曾尝试删除和重新创建情节提要中的场景，认为它们可能已损坏，但没有乐趣。任何建议将不胜感激。

谢谢

安德鲁

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T01:32:49.883

通常当我收到错误时

```
 this class is not key value coding-compliant for the key 
```

这意味着故事板中没有正确连接某些内容。

例如，以前使用的属性名称仍然连接到情节提要中的元素。

对此的一种解决方法是在情节提要中从控制器到控制器进行切换（缩小，因此它不会连接到特定事件）并实现：

```
 - (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath 
```

检查正在选择的单元格并使用

```
 [self performSegueWithIdentifier:@"yourIdentifier"]; 
```

希望对你有帮助，祝你好运。

# c# - 为什么用空委托调用 ThreadStart？

> ID：12903564
> 
> 赞同：3
> 
> 时间：2012-10-15T20:33:55.940
> 
> 标签：c#, wpf, multithreading, noop

在我必须维护的旧应用程序中进行一些取证考古调查时，我遇到了这个：

这是一个最近转换为 .NET 4.0 的 WPF 应用程序，此代码在后台工作程序中运行

```
 if(bgWorker1.IsBusy || bgWorker2.IsBusy)
           {
                Thread.Sleep(100); 
                Application.Current.Dispatcher.Invoke(
                    System.Windows.Threading.DispatcherPriority.Background, 
                    new System.Threading.ThreadStart(delegate { })
                );
           } 
```

1 - 通过使用无操作委托调用线程（主 gui）可以实现什么可能的副作用。其他两个线程也在主 gui 线程上执行调用，但只有这个线程将优先级设置为 Normal 以外的其他内容（尽管它们使用 Action 而不是 TreadStart）。

2 - 我有一些奇怪地类似于此应用程序死锁的案例，并且有些事情告诉我这可能是原因。（无缘无故地绕过优先级和主 gui 线程）。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-15T20:40:36.177

该线程将导致调用函数阻塞，直到 Dispatcher 的线程可以“处理”（无操作）委托。

这可能不是一个好的做法，应该删除。我*怀疑*这里的目标是让这个（第三个）`BackgroundWorker`的完成事件成为前两个`BackgroundWorker`完成的信号。

一般来说，像这样旋转完成通常是糟糕设计的标志。更好的设计是使用[CountdownEvent](http://msdn.microsoft.com/en-us/library/system.threading.countdownevent.aspx)`BackgroundWorker` ，两个实例在完成时都可以发出信号。

然后，您可以等待倒计时事件，而不是循环`Thread.Sleep`调用调度程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-15T20:41:28.627

1.  `"What possible side-effect would be acheived by [...]"`因为它使用`Invoke`而不是`BeginInvoke`它将是一个阻塞调用。这意味着在您的 noop 委托运行之前，您的后台线程不会继续执行。效果是代码不会继续，直到在执行此 noop 之前排队进入消息循环的所有内容。
2.  `"I have cases that strangely resembles deadlock with this application and something tells me that this could be the cause."` 对我来说听起来很合理。这段代码既说明了不好的做法，也说明了可能的死锁位置。由于代码引用了*其他*后台工作人员，因此其他人可能正在做类似的事情。

现在，似乎很明显*有些地方出了*问题，但是在不了解发生了什么的情况下，很难评论如何修复它。我的猜测是，尽管采用的方法存在一个基本的设计缺陷。

# c# - 使用 xmlnode 读取 xml 文件的属性

> ID：12903566
> 
> 赞同：0
> 
> 时间：2012-10-15T20:34:11.060
> 
> 标签：c#, xmldocument

我正在尝试使用 xml 节点读取属性。但我无法读取它。我正在做某事，但我无法弄清楚。我的 xml 文件看起来像这样.. ![xml文件](../Images/6d783d65f3820779fc5ef72f180e65fb.png)

我正在尝试读取 InterfaceRequestID 和 InterfaceName，这是我的代码..

```
if (fPortalGuid != string.Empty)
                {
                    HttpWebRequest request = WebRequest.Create("http://cramapp-dt-02s.cable.comcast.com:8158/restfulqueryservice/queryservice/getrequestdetails?api_key=hiding key&request_id=33ebc6e9-9def-4f39-adf9-bba2edef3b54") as HttpWebRequest;
                    request.Method = "POST";

                    using (Stream stm = request.GetRequestStream())
                    {
                        using (StreamWriter stmw = new StreamWriter(stm))
                        {
                            stmw.Write(soap);
                        }
                    }
                    // Get response  
                    using (HttpWebResponse response = request.GetResponse() as HttpWebResponse)
                    {
                        // Get the response stream  
                        StreamReader reader = new StreamReader(response.GetResponseStream());
                        // Console application output  
                        string result = reader.ReadToEnd();
                        XmlDocument xmlDoc = new XmlDocument();
                        xmlDoc.LoadXml(result);
                        XmlNodeList radiusdns_nodelist;
                        XmlNodeList request_nodelist;
                        XmlNodeList fqdn_nodelist;
                        radiusdns_nodelist = xmlDoc.SelectNodes("/RADIUSDNSQueryResponsePayload");
                        request_nodelist = xmlDoc.SelectNodes("/RADIUSDNSQueryResponsePayload/request");
                        fqdn_nodelist = xmlDoc.SelectNodes("/RADIUSDNSQueryResponsePayload/request/fqdn");
                        string strInterfaceID = string.Empty, strInterfaceName = string.Empty;
                        if (radiusdns_nodelist.Count > 0)
                        {
                            foreach (XmlNode main_node in radiusdns_nodelist[0].ChildNodes)
                            {
                                strInterfaceID = main_node.Attributes["InterfaceRequestID"].Value;
                                strInterfaceName = main_node.Attributes["InterfaceName"].Value;
                            }
                        }
                    }
                } 
```

我无法获得属性。我做错了什么？

# c# - 如何使用 .Net 读取 Web 服务

> ID：12903571
> 
> 赞同：0
> 
> 时间：2012-10-15T20:34:35.597
> 
> 标签：c#, asp.net, .net, web-services, client

大家好，我需要能够使用 .Net 创建一个能够从 Internet 读取 Web 服务的客户端。

我不明白这种方法。例如，我需要能够阅读这种文件[LINK](http://developer.ebay.com/webservices/Finding/latest/FindingService.wsdl)有人可以为我提供一个示例或如何实现此目的的链接吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T20:44:56.043

在 Visual Studio 中，创建一个新项目 - 或使用现有项目。在解决方案树中，右键单击并“添加新的 Web 引用”，输入 WSDL 的 URL - 您发布的链接。Visual Studio 将基于 WSDL（Web 服务描述语言）创建命名空间和类，您可以使用它们来创建 Web 服务和方法的实例。

干杯西蒙

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T21:50:43.233

你的问题定义不明确。“做客户”是什么意思？您想查看 WSDL 吗？在 Web 浏览器中键入其 URL。您想以编程方式阅读它吗？通过 HTTP 读取；它只是一个 XML 文档。您想使用特定的网络服务吗？您必须联系提供商；每个 Web 服务都可以完全不同。

您是否希望通过解析 WSDL 而不是询问提供者来联系所有可能的 Web 服务？你给自己设定了一项极其艰巨的任务。你为什么要这样做？你想达到什么目的？请准确告诉我们您要做什么，并向我们[展示您尝试过](http://whathaveyoutried.com/)的内容。

# mysql - 不在表 b 中时从表 a 中选择

> ID：12903574
> 
> 赞同：0
> 
> 时间：2012-10-15T20:34:43.570
> 
> 标签：mysql

以下命令从 'stock' 中选择所有出现在 'items' 中且具有正确 orderRef 的项目。

`SELECT a.* FROM stock a LEFT JOIN items b ON a.id = b.stockId WHERE b.orderRef='orderRef'`

这可行，但我需要所有未在表“项目”中列出的项目以及正确的 orderRef。

我想我应该把“开”改成相反的，但“关”没有用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T20:43:42.947

执行“不在”查询的最佳方法是 MySQL，如下所示：

```
select s.*
from stock s
where not exists (select 1 from items i where s.id = i.stockID and i.orderref = 'orderref' limit 1) 
```

MySQL 优化器的工作方式，`not exists`性能最好。这可以通过在 items.stockID 上建立索引来进一步增强。

请注意，当您使用左外连接时，如果第二个表中有重复项，您可能会无意中将行数相乘。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T20:37:28.827

试试这个：

```
SELECT a.* FROM stock a LEFT JOIN items b ON a.id = b.stockId WHERE 
                b.stockId is null and a.orderRef='orderRef' 
```

# ruby-on-rails - 为什么 PostgreSQL 查询在服务器启动后的第一个请求中比在后续请求中慢？

> ID：12903575
> 
> 赞同：1
> 
> 时间：2012-10-15T20:34:45.673
> 
> 标签：ruby-on-rails, postgresql, postgresql-performance

我正在使用 PostgreSQL 9.1.1 和 Rails 3.2.8。使用 NewRelic 的开发模式，我注意到在我的服务器启动或重新启动后的第一个请求期间，几个 SQL 查询所需的时间比后续请求期间要长得多。

有什么理由吗，是因为准备好的陈述吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-15T20:37:39.450

刚启动后，没有任何索引加载到内存中，因此服务器将不得不进行大量非常缓慢的磁盘读取。随着活动的进行，越来越多的索引页面被加载到内存中，查询这些页面当然要快得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-07T04:34:32.533

您的服务器托管在什么操作系统上？在 Linux 中，文件系统使用 RAM 缓存来存储文件。当需要打开一个新文件时，如果有空间，则将其存储在缓存中。如果没有空间，则删除最旧/最后访问的文件以为新文件腾出空间。PostgreSQL 将关系（表和索引）存储为文件。当它们第一次被读取时，Linux 文件系统将它们加载到内存中。这使得访问数据的速度更快。但是初始读取的开销是您正在经历的“缓慢”。数据的后续读取直接从 RAM 中读取 - 除非缓存交换。

根据我的经验，您应该监控表和索引的大小。如果它们变得太大，来自这样一个“怪物表”的单个查询可能会导致所有其他常用文件交换出缓存，整个系统都会受到影响。让你的表更小（如果你在一百万行范围内尝试分区），并且不要在高度精确的字段（如时间戳）上编制索引 - 而是在日期上编制索引 - 你将拥有更少的索引节点，因此索引更小文件（假设您每天都有很多记录）。这将允许操作系统更有效地将您的关系加载到缓存中和从缓存中加载出来，并且您不会注意到速度差异太大。

如果您托管在 Windows 上，则可能无法解释您的性能问题。如果您需要说服您迁移到 *nix 服务器，您应该认真阅读 PostgreSQL 关于性能的文档。

# android - 在 iOS 中管理核心对象

> ID：12903585
> 
> 赞同：4
> 
> 时间：2012-10-15T20:35:28.497
> 
> 标签：android, ios, singleton

我的任务是在 iOS 上移植一个 Android 应用程序。不幸的是，我以前从未编写过 iOS 应用程序，所以我有一些基本问题。

在 Android 中，我们编写的应用程序维护了几个不同的核心对象，我们在扩展 android.app.Application 的类中经常使用这些对象。当我们需要访问这些对象时，我们会调用[getApplication();](http://developer.android.com/reference/android/app/Activity.html#getApplication%28%29) 在这个类中，我们存储了两个自定义对象的字典、一个 ArrayList 以及一些布尔值、整数和字符串。

谁能告诉我在 iOS 中执行此操作的正确方法？我研究了一个可以保存所有字典、数组列表和其他数据的单例类，但我读到这个单例将在应用程序运行的整个过程中存在于内存中。在 Android 中，Application 类有时会在一段时间不活动后被垃圾回收，所以我们不得不重新加载它。如果在 iOS 中，这个单例类在应用程序的整个生命周期中都存在于内存中，我是否应该担心使用过多的内存？我应该序列化这些对象并将它们存储在磁盘上，并在需要时重新创建它们吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T21:09:15.660

`android.app.Application`听起来类似于 iOS 的 App Delegate ( `UIApplicationDelegate`)。当应用程序的状态发生变化时，App Delegate 中的某些方法会被调用，请查看以下方法：

```
- (void)applicationWillTerminate:(UIApplication *)application;
- (void)applicationDidEnterBackground:(UIApplication *)application; 
```

第一个将在应用程序不在后台并且即将关闭时调用（请参阅 Tommy 的评论），如果它进入后台，则将调用后者。如果有更改，我建议每次应用程序进入后台时将数据序列化到永久存储中。

稍后，您可以通过调用`[[UIApplication sharedApplication] delegate]`并将结果转换为自定义子类来获取对自定义 App Delegate 的引用。我还建议不要将数据直接存储在 App Delegate 中，而是存储在代表引用的模型对象中（它应该有助于让事情变得更简洁，并给你更多的灵活性）。

# macos - 关于 Cocoa 应用程序的 MVC 设计架构的问题

> ID：12903586
> 
> 赞同：2
> 
> 时间：2012-10-15T20:35:30.213
> 
> 标签：macos, cocoa, model-view-controller

*   我的目标

制作一个只有一个窗口的应用程序。窗口的根视图将是一对带有 4 个按钮的图像。这 4 个按钮中的每一个都将显示不同的（主）视图。每个主视图将显示其他（子）视图，并且每个主视图和子视图应该能够“返回”到根视图。

*   我做了什么（它基于苹果的 ViewController 项目）

    *   我用他们受人尊敬的 XIB 文件创建了 1`NSWindowController`和 4 。`NSViewController`

    *   AppDelegate 分配/初始化一个`NSWindowController`对象，其 nib 包含窗口和根视图，然后`showWindow`在其上调用方法。

    *   我的子类`NSWindowController`有两个 ivars：一个`NSView`代表绑定在 IB 中的根视图，一个`NSViewController`代表当前视图控制器。
    *   我将 4 个按钮绑定到根据按钮标签更改视图的方法。

这是 Apple 的 ViewController 项目如何实现它[http://pastie.org/private/zmqpzgnudgovagwigal8dq](http://pastie.org/private/zmqpzgnudgovagwigal8dq)

尽管如此，这对我不起作用，它只是在根视图之上添加视图。

如您所见，我有点迷茫，请随时分享您的想法！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-16T05:15:07.257

一种方法是使用 NSBox。 *此演示的完整代码在 github 上。请参阅底部的链接。*

## 入门

使用 Cocoa Application 模板在 Xcode 中启动一个新项目。使用适合您的前缀。我将 SOD 用于 StackOverflowDemo。

在做任何其他事情之前，对作为模板的一部分自动添加到项目中的文件进行一些小的更改：

*   `MainMenu.xib`: 删除 NSWindow。
*   SODAppDelegate.h：删除行：`@property (assign) IBOutlet NSWindow *window;`

**为了简化您的示例，假设您希望在左侧有一个带有一列可单击项目（为简单起见，假设为按钮）的单个窗口。**

## SOD窗口控制器

`NSWindowController`首先向您的项目添加一个子类。请务必包含相应的`XIB`. 打开`SODWindowController.xib`，在窗口左侧添加四个按钮（我使用方形按钮）并添加一个`NSBox`，填充窗口的其余部分。在这一点上，你会有一些像这样的东西。

![第1步](../Images/f8b9c563ab4d72f74e584813c8147742.png)

我将框的 contentView 设置为图层托管视图，其图层的背景颜色为`[NSColor greenColor]`. 我这样做是因为，否则你根本看不到盒子。该框已配置为仅用于交换视图进出。要像这样配置您的框，请在 Interface Builder 中选择 ，`NSBox`然后在 Attributes Inspector 中，将 设置`Title Position`为`None`并将 设置`Border Type`为`None`。

现在`SODWindowController.m`，将存根替换为`initWithWindow:`

```
- (id)initWithWindow:(NSWindow *)window
{
    self = [super initWithWindow:window];
    if (self) {
        // Initialization code here.
    }

    return self;
} 
```

使用不同的指定初始化程序：

```
- (id)init
{
    self = [super initWithWindowNibName:@"SODWindowController"];
    {

    }
    return self;
} 
```

这将使您避免重新输入（并可能错误地输入 XIB 的名称。

`SODWindowController`此外，在该行之后添加一个类扩展

```
#import "SODWindowController.h" 
```

在，给`SODWindowController.m`自己一个：`IBOutlet``NSBox`

```
@interface SODWindowController ()
@property (nonatomic, strong, readwrite) IBOutlet NSBox *box;
@end 
```

在 Interface Builder 中，打开`SODWindowController.xib`并设置 box outlet 指向`NSBox`您添加的。

## 将 SODWindowController 添加到 SODAppDelegate

现在，添加`SODWindowController`到`SODAppDelegate`：将行添加到`SODAppDelegate.m`正下方`#import "SODAppDelegate.h"`：

```
#import "SODWindowController.h"

@interface SODAppDelegate ()
@property (nonatomic, strong, readwrite) SODWindowController *windowController;
@end 
```

现在我们可以将窗口设置为在以下位置创建`-[NSApplication applicationDidFinishLaunching:]`：

```
- (void)applicationDidFinishLaunching:(NSNotification *)aNotification
{
    self.windowController = [[SODWindowController alloc] init];
    //notice that we don't have to do anything awkward like use initWithWindowNibName:
    [self.windowController showWindow:nil];
} 
```

此时，当我们运行应用程序时，我们将看到我们的窗口。

很好，但是四个不同按钮的不同视图和历史记录如何让用户返回？

## SODViewControllers

为四个视图中的每一个创建一个 NSViewController 子类。我会打电话给我`SODCoffeeViewController`的`SODTeaViewController`,`SODJavaViewController`和`SODMeViewController`。

在它们中的每一个中，替换自动生成的指定初始化程序存根

```
- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Initialization code here.
    }

    return self;
} 
```

和

```
- (id)init
{
    self = [super initWithNibName:@"SODCoffeeViewController" bundle:nil];
    if (self) {
    }
    return self;
} 
```

尽管当然要为每个替换适当的 NibName 参数。和以前一样，这将阻止您在与该 Nib 关联的文件之外的任何位置键入`@"MyNibName"。

## 将 SODViewControllers 添加到 SODWindowController

现在，将所有四个视图控制器导入`SODWindowController`：添加行

```
#import "SODCoffeeViewController.m"
#import "SODTeaViewController.m"
#import "SODJavaViewController.m"
#import "SODTeaViewController.m" 
```

我们`SODWindowController`需要这些对象中的每一个。向我们的类扩展添加`NSArray`属性最简单的事情`SODWindowController`

```
@property (nonatomic, strong, readwrite) NSArray *viewControllers; 
```

并在执行中`-[SODWindowController init]`添加行

```
- (id)init
{
    self = [super initWithWindowNibName:@"SODWindowController"];
    if (self) {
        NSMutableArray *mutableViewControllers = [NSMutableArray array];
        [mutableViewControllers addObject:[[SODCoffeeViewController alloc] init]];
        [mutableViewControllers addObject:[[SODTeaViewController alloc] init]];
        [mutableViewControllers addObject:[[SODJavaViewController alloc] init]];
        [mutableViewControllers addObject:[[SODMeViewController alloc] init]];
        self.viewControllers = [mutableViewControllers copy];
    }
    return self;    
} 
```

现在，我们为要呈现的四个视图中的每一个都有一个视图控制器，并且它们在一个数组中排序，就像它们是窗口上的四个按钮一样。更重要的是，它们的排序方式与我们四个按钮上的标签相同。...在我们设置他们的标签之后，就是这样。

在 Interface Builder 中打开`SODWindowController.xib`并将顶部按钮的标记设置为`0`，从顶部开始的第二个到`1`等等。

回到，在类扩展中`SODWindowController.m`添加一个：`IBAction``SODWindowController`

```
- (IBAction)showPane:(id)sender; 
```

在下面定义这个方法`SODWindowController` `@implemention`：

```
- (void)showPane:(NSButton *)sender
{
    [self showPaneAtIndex:sender.tag];
} 
```

就是这样！

...当然除了定义`-[SODWindowController showPaneAtIndex:]`. 但在此之前，将四个按钮的操作设置`SODWindowController.xib`为`showPane:`on `File's Owner`。

完成后，定义`showPaneAtIndex:`如下：

```
- (void)showPaneAtIndex:(NSInteger)index
{
    NSViewController *viewController = (NSViewController *)self.viewController[(NSUInteger)index];
    [self.box setContentView:viewController.view];
} 
```

现在，每当按下任何按钮时，相应的视图控制器的视图都将设置为框的内容视图。

`SODCoffeeViewController`可能，我们希望窗口一出现就显示最顶层的视图控制器的视图（ 's）。要做到这一点，只需将当前定义替换`-windowDidLoad`为

```
- (void)windowDidLoad
{
    [super windowDidLoad];
    [self showPaneAtIndex:0];
} 
```

## 历史

历史实际上是最简单的部分。我们要做的是跟踪我们后面的一个或两个窗格（在浏览器中的后退按钮的意义上）和在我们前面的窗格（在前进按钮的意义上）。为此，我们将在`SODWindowController`类扩展中添加两个可变数组属性：

```
@property (nonatomic, strong, readwrite) NSMutableArray *panesBehind;
@property (nonatomic, strong, readwrite) NSMutableArray *panesBefore; 
```

并将它们初始化为`-init`：

```
 ...
    self.viewControllers = [mutableViewControllers copy];

    self.panesBehind = [NSMutableArray array];
    self.panesBefore = [NSMutableArray array];
    }
    return self;
} 
```

现在，我们需要将我们访问的每个新窗格的索引推送到 上`self.panesBehind`，所以添加行

```
[self.panesBehind addObject:[NSNumber numberWithInteger:index]]; 
```

根据你的定义`-showPaneAtIndex:`。

这允许我们定义`-goBack`,`-goForward`和帮助器`-canGoBack`,`-canGoForward`如下：

```
- (BOOL)canGoBack
{
    return self.panesBehind.count > 0;
}

- (void)goBack
{
    if (self.canGoBack) {
        NSNumber *presentPane = self.panesBehind.lastObject;
        [self.panesBehind removeLastObject];
        [self.panesBefore insertObject:presentPane atIndex:0];
        NSNumber *previousPane = self.panesBehind.lastObject;
        [self.panesBehind removeLastObject];
        [self showPaneAtIndex:previousPane.integerValue];
    }
}

- (BOOL)canGoForward
{
    return self.panesBefore.count > 0;
}

- (void)goForward
{
    if (self.canGoForward) {
        NSNumber *nextPane = [self.panesBefore objectAtIndex:0];
        [self.panesBefore removeObjectAtIndex:0];
        [self showPaneAtIndex:nextPane.integerValue];
    }
} 
```

不过，这有一个小问题。如果我们从窗格 A 到 B 到 C 到 D 前进，那么`self.panesBehind`看起来像

```
A-->B-->C-->D 
```

并且`self.panesBefore`是空的。但是如果我们返回两个窗格，`self.panesBehind`看起来像

```
A-->B 
```

看起来`self.panesBefore`像

```
C-->D 
```

如果此时我们现在转到窗格 E，`self.panesBehind`看起来像

```
A-->B-->E 
```

正如我们所期望的那样，但`self.panesBefore`仍然看起来像

```
C-->D 
```

这不是我们想要的。出于这个原因，我们添加了这一行

```
[self.panesBefore removeAllObjects]; 
```

到结束`-showPane:`。

要尝试这些方法，请继续在 in 中公开声明`@interface`它们：`SODWindowController``SODWindowController.h`

```
@interface SODWindowController : NSWindowController
- (void)goForward;
- (void)goBack;
@end 
```

然后在和`MainMenu.xib`的文件菜单中添加两个菜单项。在声明两个：`Forward``Back``SODAppDelegate.h``IBActions`

```
- (IBAction)forward:(id)sender;
- (IBAction)back:(id)sender; 
```

并返回`MainMenu.xib`，将 Forward 菜单项的操作设置为`forward:`on `First Responder`，将 Back 菜单项的操作设置为`back:`on `First Responder`。最后，定义这两个方法`-[SODAppDelegate forward:]`并`-[SODAppDelegate back:]`调用相应的方法`SODWindowController`：

```
- (IBAction)forward:(id)sender
{
    [self.windowController goForward];
}

- (IBAction)back:(id)sender
{
    [self.windowController goBack];
} 
```

要下载完整源代码，请访问[https://github.com/natechan/ViewSwappingDemo](https://github.com/natechan/ViewSwappingDemo)。

# c++ - 通过多个回调处理来自 libcurl 的 HTTP 响应

> ID：12903587
> 
> 赞同：2
> 
> 时间：2012-10-15T20:35:32.460
> 
> 标签：c++, curl, libcurl

我正在使用 libcurl 发送 HTTP 发布请求并随后处理响应。收到响应后，库使用`CURLOPT_WRITEFUNCTION`通过`curl_easy_setopt`.

```
// callback function
std::size_t on_data(const char* buffer, const std::size_t size, const std::size_t nmemb, void* context); 
```

从文档中不清楚你可以将数据留在缓冲区中（通过从回调返回 0）或者你必须将数据复制到本地缓冲区，然后在每个后续回调中继续附加到这个缓冲区，直到你收到整个消息.

我的问题是：

1.  获取整个消息长度的最佳方法是什么？是来自`Content-Length`标题`CURLOPT_WRITEHEADER`吗？
2.  有没有办法避免复制部分响应，而是等待收到最终消息，然后将其全部处理？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T08:18:39.320

就`CURLOPT_WRITEFUNCTION`选项而言，文档明确指出此功能必须：

> [r]返回实际处理的字节数。如果该数量与传递给您的函数的数量不同，它将向库发出错误信号。这将中止传输并返回 CURLE_WRITE_ERROR。

因此，除非您想明确中止传输，否则您应该始终返回实际大小，即`size * nmemb`. 此外，如果您选择使用本地缓冲区，那么是的，您必须注意将传入的数据复制到其中（并注意重新分配），如`docs/examples/getinmemory.c`示例代码所示。

请注意，如果您不想使用内存缓冲区，您也可以通过选项使用文件，`CURLOPT_WRITEDATA`如示例中所示。`docs/examples/url2file.c``docs/examples/fopen.c`

除此以外：

1.  我想说，要先验地检查您愿意获取的资源的大小，那么您应该执行一个`HEAD`请求（通过`CURLOPT_NOBODY`设置为 1 并设置为 1），要求通过and和 at`CURLOPT_HEADER`写入 HTTP 标头最后解析值。但是：这绝对**不是**请求的方式，因为它不是幂等的！`CURLOPT_WRITEHEADER``CURLOPT_WRITEFUNCTION``Content-Length`**`POST`**

***   同样，如果您对使用不断增长的内存缓冲区感到不满意（例如，可能因为您期望响应非常大），那么您应该使用处理文件的能力，`CURLOPT_WRITEDATA`以便将响应逐步写入磁盘。一旦完成，然后使用您的文件 - 包含整个消息，您想要的方式。**

# asp.net - 如何调试此表单上的 500 错误？

> ID：12903592
> 
> 赞同：-1
> 
> 时间：2012-10-15T20:35:55.943
> 
> 标签：asp.net, forms

我继承了一个在 VB Studio 中构建的网站，我试图让表单在这个页面上工作：[http](http://childplus.com/Support/) ://childplus.com/Support/我在不同用户的不同浏览器中遇到了很多 500 错误表格。我只想要工作表格！

到目前为止，无论浏览器如何，单击提交按钮后都会返回 500 错误。但是，我对使用 VB Studio 开发 Web 表单还是很陌生。任何有关为新手调试和修复 500 错误的见解或说明将不胜感激。

页面上的实际表格：

```
<form id="form_support" runat="server">
<asp:ToolkitScriptManager ID="ToolkitScriptManager1" runat="server"></asp:ToolkitScriptManager>

<!--Name-->
<div class="FormLine">
<asp:Label ID="lblName" runat="server" Text="Name:"  CssClass="Txt"></asp:Label><p class="required">(required)</p>
<asp:TextBox ID="FullName" runat="server" class="TxtBox" TabIndex="1" MaxLength="100"></asp:TextBox>
<asp:RequiredFieldValidator Display="Static" ID="RequiredFieldValFullname" runat="server" ControlToValidate="FullName"  ToolTip="Name is Required" EnableClientScript="False" SetFocusOnError="true"></asp:RequiredFieldValidator>

</div>

<!--Agency-->
<div class="FormLine">
<asp:Label ID="lblAgency" runat="server" Text="Agency:"  CssClass="Txt"></asp:Label><p class="required">(required)</p>
<asp:TextBox ID="AgencyName" runat="server" class="TxtBox" TabIndex="2" MaxLength="100"></asp:TextBox>
<asp:RequiredFieldValidator Display="Static" ID="RequiredFieldValAgencyName" runat="server" ControlToValidate="AgencyName"  ToolTip="Agency is Required" EnableClientScript="False" SetFocusOnError="true"></asp:RequiredFieldValidator><br />

</div>

<!--Email-->
<div class="FormLine">
<asp:Label ID="lblemail" runat="server" Text="Email:"  CssClass="Txt"></asp:Label><p class="required">(required)</p>
<asp:TextBox ID="email" runat="server" class="TxtBox" TabIndex="3" MaxLength="100"></asp:TextBox>
<asp:RequiredFieldValidator Display="Static" ID="RequiredFieldValEmail" runat="server" ControlToValidate="email"  ToolTip="Email is Required" EnableClientScript="False"></asp:RequiredFieldValidator>
<asp:RegularExpressionValidator  Display="Static" ID="RegularExpressionValEmail"   ErrorMessage="Email is not valid." ControlToValidate="email" runat="server" ToolTip="Email is not valid." ValidationExpression="^(['_a-z0-9-]+)(\.['_a-z0-9-]+)*@([a-z0-9-]+)(\.[a-z0-9-]+)*(\.[a-z]{2,5})$"></asp:RegularExpressionValidator>

</div>

<!--Phone-->
<div class="FormLine">
<asp:Label ID="lblPhone" runat="server" Text="Phone:"  CssClass="Txt"></asp:Label><p class="required">(required)</p>

<asp:TextBox ID="phone" runat="server" class="TxtBox" TabIndex="4" MaxLength="30"></asp:TextBox>
<asp:RequiredFieldValidator Display="Static" ID="RequiredFieldValPhone" runat="server" ControlToValidate="phone"  ToolTip="Phone is Required" EnableClientScript="False" SetFocusOnError="true"></asp:RequiredFieldValidator><br />

</div>

<!--Subject-->
<div class="FormLine">
<asp:Label ID="lblSubject" runat="server" Text="Subject:"  CssClass="Txt"></asp:Label><p class="required">(required)</p>
<asp:DropDownList ID="ddlSubject" runat="server" class="TxtBox1" TabIndex="5"></asp:DropDownList>
<asp:RequiredFieldValidator Display="Static" ID="RequiredFieldValddlSubject" runat="server" ControlToValidate="ddlSubject"  ToolTip="Subject is Required." InitialValue="" EnableClientScript="False"></asp:RequiredFieldValidator>                          

</div>

<!--Topic-->
<div class="FormLine">
<span class="Txt">Topic:</span>
<asp:DropDownList ID="ddlTopic" runat="server" class="TxtBox1" TabIndex="6"></asp:DropDownList>
<asp:CascadingDropDown ID="CascadingDropDown1" runat="server" TargetControlID="ddlSubject"  Category="subject" prompttext="Select a Subject..."  ServicePath="~/wbSubjectTopics.asmx" ServiceMethod="GetDropDownContents">
</asp:CascadingDropDown>
<asp:CascadingDropDown ID="CascadingDropDown2" runat="server" TargetControlID="ddlTopic"  Category="topic" prompttext="Select a Topic..."  LoadingText="Loading..." ParentControlID="ddlSubject" ServicePath="~/wbSubjectTopics.asmx" ServiceMethod="GetDropDownContents">
</asp:CascadingDropDown>
</div>

<!--Details-->
<div class="FormMultiLine">
<span class="Txt2">Please include as much detail as possible including:</span>
    <ul>
    <li>What steps you did.</li>
    <li>Your computer's operating system.</li>
    <li>Exact text of any error message.</li>
    </ul> 

<asp:TextBox ID="Comments" class="TxtBoxMulti" runat="server"  TextMode="MultiLine" TabIndex="7" ></asp:TextBox>                        
</div>

<!--Submit-->
<div id="SubBtnWrapper" class="SubBtnBlue">  
    <asp:LinkButton ID="SubBtn" text="" title="Submit" runat="server" TabIndex="8">
    <div class="rollover_wrapper"><div class="submit_rollover"><img src="../../Images/Forms/submit_btn_blue.png" height="78px" width="79px" /></div></div>
    </asp:LinkButton>
</div>

<script type="text/javascript" language="JavaScript"><!--    document.form_support.FullName.focus(); //--></script>
</form>

</div> 
```

代码隐藏：通用进口

```
Partial Public Class Support_homepage
    Inherits System.Web.UI.Page
    Public Utils As Utils = New Utils

    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load

    End Sub

    Protected Sub ddlSubject_SelectedIndexChanged(ByVal sender As Object, ByVal e As EventArgs) Handles ddlSubject.SelectedIndexChanged
        ddlTopic.SelectedIndex = -1
    End Sub

    Private Sub SubBtn_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles SubBtn.Click
        Page.Validate()

        If (Page.IsValid) Then
            Dim EmailBody As String

            Dim strSubjectTopic As String

            If ddlTopic.SelectedValue = "" Then
                strSubjectTopic = ddlSubject.SelectedValue
            Else
                strSubjectTopic = ddlTopic.SelectedValue
            End If

            EmailBody = "<p style=" + "font-family:Verdana;" + "><strong>Technical Support Request:</strong></p><p style=" + "font-family:Verdana;" + "><strong>Name:</strong> " + FullName.Text + "</p>"
            EmailBody = EmailBody + "<p style=" + "font-family:Verdana;" + "><strong>Email:</strong> " + email.Text + "</p>"
            EmailBody = EmailBody + "<p style=" + "font-family:Verdana;" + "><strong>Phone:</strong> " + phone.Text + "</p>"
            EmailBody = EmailBody + "<p style=" + "font-family:Verdana;" + "><strong>Agency:</strong> " + AgencyName.Text + "</p>"
            EmailBody = EmailBody + "<p style=" + "font-family:Verdana;" + "><strong>Subject/Topic:</strong> " + strSubjectTopic + "</p>"
            EmailBody = EmailBody + "<p style=" + "font-family:Verdana;" + "><strong>Comments:</strong> " + Comments.Text + "</p>"

            Utils.SendAppNotificationEmails("support@childplus.com", "support@childplus.com", "Website: Technical Support Request", EmailBody)
            Response.Redirect("/")
        Else
            If RequiredFieldValFullname.IsValid Then
                lblName.CssClass = "Txt"
            Else
                lblName.CssClass = "ErrorTxt"
            End If

            If RequiredFieldValAgencyName.IsValid Then
                lblAgency.CssClass = "Txt"
            Else
                lblAgency.CssClass = "ErrorTxt"
            End If

            If RequiredFieldValPhone.IsValid Then
                lblPhone.CssClass = "Txt"
            Else
                lblPhone.CssClass = "ErrorTxt"
            End If

            If RequiredFieldValEmail.IsValid Then
                lblemail.CssClass = "Txt"
            Else
                lblemail.CssClass = "ErrorTxt"
            End If

            If RequiredFieldValddlSubject.IsValid Then
                lblSubject.CssClass = "Txt"
            Else
                lblSubject.CssClass = "ErrorTxt"
            End If
        End If
    End Sub

End Class 
```

这是堆栈跟踪：

```
Server Error in '/' Application.

Invalid postback or callback argument.  Event validation is enabled using <pages enableEventValidation="true"/> in configuration or <%@ Page EnableEventValidation="true" %> in a page.  For security purposes, this feature verifies that arguments to postback or callback events originate from the server control that originally rendered them.  If the data is valid and expected, use the ClientScriptManager.RegisterForEventValidation method in order to register the postback or callback data for validation.

Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. 

Exception Details: System.ArgumentException: Invalid postback or callback argument.  Event validation is enabled using <pages enableEventValidation="true"/> in configuration or <%@ Page EnableEventValidation="true" %> in a page.  For security purposes, this feature verifies that arguments to postback or callback events originate from the server control that originally rendered them.  If the data is valid and expected, use the ClientScriptManager.RegisterForEventValidation method in order to register the postback or callback data for validation.

Source Error: 

An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.

Stack Trace: 

[ArgumentException: Invalid postback or callback argument.  Event validation is enabled using <pages enableEventValidation="true"/> in configuration or <%@ Page EnableEventValidation="true" %> in a page.  For security purposes, this feature verifies that arguments to postback or callback events originate from the server control that originally rendered them.  If the data is valid and expected, use the ClientScriptManager.RegisterForEventValidation method in order to register the postback or callback data for validation.]
   System.Web.UI.ClientScriptManager.ValidateEvent(String uniqueId, String argument) +8644665
   System.Web.UI.Control.ValidateEvent(String uniqueID, String eventArgument) +69
   System.Web.UI.WebControls.DropDownList.LoadPostData(String postDataKey, NameValueCollection postCollection) +53
   System.Web.UI.WebControls.DropDownList.System.Web.UI.IPostBackDataHandler.LoadPostData(String postDataKey, NameValueCollection postCollection) +13
   System.Web.UI.Page.ProcessPostData(NameValueCollection postData, Boolean fBeforeLoad) +343
   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +1743 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T20:27:21.753

尝试本文中描述的解决方案 [http://johanleino.wordpress.com/2011/04/09/revisedcascadingdropdown-casues-invalid-postback-or-callback-argument-error/](http://johanleino.wordpress.com/2011/04/09/revisedcascadingdropdown-casues-invalid-postback-or-callback-argument-error/)

# nunit - 如何使用具有不同类和 TextFixtureSetup 和 TearDown 的 Nunit

> ID：12903593
> 
> 赞同：1
> 
> 时间：2012-10-15T20:35:57.627
> 
> 标签：nunit

我有一个大问题，我有 3 个测试类，但是我创建了其他类来在数据库中插入假数据来测试我的类，但是我创建了其他类来删除我正在创建的这些数据。

但是我在课堂上使用**[SetUp]**来创建假数据，并在课堂上使用**[TearDown]**来删除数据。

但是使用**[SetUp]**或**[TestFixtureSetUp]**两次创建数据并进行测试，但是当我完成类时，自动类完成**拆卸**或**TextFixtureTearDown**并且不开始其他测试，其他测试在**拆卸后发生**

是否可以在运行所有测试装置之前编写一个类来用测试数据填充数据库，然后在所有测试类运行后让它删除测试数据？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T21:01:00.807

如果我理解您的问题，我认为您可以使用通用基类进行测试：

```
public class TestBase{
  [SetUp]
  public void BaseSetUp(){
     // Set up all the data you need for each test
  }

  [Teardown]
  public void BaseTeardown(){
     // clean up all the data for each test
  }
}

[TestFixture]
public class TestClass : TestBase{
  [SetUp]
  public void LocalSetUp(){
     // Set up all the data you need specifically for this class
  }

  [Teardown]
  public void LocalTeardown(){
     // clean up all specific data for this class
  }

  [Test]
  public void MyTest(){
        // Test something
  }

} 
```

这样，您的所有设置和拆卸都可以共享，并将在每次测试之前运行。您可以验证这一点（我是从内存中执行此操作），但我相信运行顺序将是：

*   TestBase.BaseSetup()
*   TestClass.LocalSetup()
*   测试类.MyTest()
*   TestClass.LocalTeardown()
*   TestBase.BaseTeardown()

**编辑：** 好的，既然我更好地理解了您的要求，我认为您可以使用[SetupFixture](http://www.nunit.org/index.php?p=setupFixture&r=2.4)属性来确保您的数据设置和拆卸只为您的完整测试套件发生一次。

因此，您将设置一个单独的设置类，而不是通用基类，如下所示：

```
 [SetupFixture]
   public class TestSetup{
      [SetUp]
      public void CommonSetUp(){
         // Set up all the data you need for each test
      }

      [TearDown]
      public void CommonTeardown(){
         // clean up all the data for each test
      }
    }

    [TestFixture]
    public class TestClass1 {
      [SetUp]
      public void LocalSetUp(){
         // Set up all the data you need specifically for this class
      }

      [Teardown]
      public void LocalTeardown(){
         // clean up all specific data for this class
      }

      [Test]
      public void MyTest(){
            // Test something
      }

    [TestFixture]
    public class TestClass2 {
      [SetUp]
      public void LocalSetUp(){
         // Set up all the data you need specifically for this class
      }

      [Teardown]
      public void LocalTeardown(){
         // clean up all specific data for this class
      }

      [Test]
      public void MyTest(){
            // Test something
      }

    } 
```

那么操作的顺序将是这样的：

*   TestSetup.CommonSetup()
*   TestClass1.LocalSetup()
*   TestClass1.MyTest()
*   TestClass1.LocalTeardown()
*   TestClass2.LocalSetup()
*   TestClass2.MyTest()
*   TestClass2.LocalTeardown()
*   TestSetup.CommonTeardown()

**注意：**您的所有测试都必须在同一个命名空间中。

# jquery - 在ajax之后用jquery设置css

> ID：12903594
> 
> 赞同：0
> 
> 时间：2012-10-15T20:36:10.070
> 
> 标签：jquery, css, ajax

我有一张地图（intanceOf Google Maps），并且我正在向它附加 html。它是一个*pim* ，更具体地说是一个*richMarker*。一切顺利，标记就在那里。

问题是，我试图将一个类设置为由*richMarker*呈现的这个html 的标签，并且在页面中我试图用JQuery 选择器捕捉这个标签，当然用它做一些事情。

一些代码：

主页有这个。

```
$.cometd.subscribe(channelCerca, function (comet) {

        if (comet.data.type== 0) //Enum ETipoCerca
            sigo.notifyError("viature: " + comet.data.viatura + " out");
        else if (comet.data.type== 1)
            sigo.notifyError("viature: " + comet.data.viatura + " out");

        color = comet.data.cercaColor;
        cerca = doDraw(comet.data, color);

        cadg.rastreador.cerca = true;
        cadg.rastreador.LoadRastreator(force, color );

        $('.blink').each(function () {
            var elem = $(this);
            setInterval(function () {
                if (elem.css('visibility') == 'hidden') {
                    elem.css('visibility', 'visible');
                } else {
                    elem.css('visibility', 'hidden');
                }
            }, 500);
        });

        //$(window).load(doBlink());
        //doBlink();
    }); 
```

*loadRastreador*做了很多事情。一般来说： 1 - 一个 ajax 帖子 2 - 准备标记 3 - 将标记附加到地图

在准备新的*标记*我做：

```
//CERCA
    if (cerca) {
        desc = "<span class='blink' color: " + cor + "' >&nbsp;" + this.des + "</span>";
    } 
```

我想用眨眼类捕捉这个跨度，并用 jquery让它*闪烁。*

```
$('.blink').each(function () {
            var elem = $(this);
            setInterval(function () {
                if (elem.css('visibility') == 'hidden') {
                    elem.css('visibility', 'visible');
                } else {
                    elem.css('visibility', 'hidden');
                }
            }, 500);
        }); 
```

该应用程序有点复杂..但我的问题很简单。由于某种原因，jquery 看不到这个新元素。

我已经尝试过： 1 - 将此 jquery 指令放入ajax 的*done*方法中。2 - 使用 $(window).load() 3 - 使用*text-decorarion: blink* <- 它在 firefox 上工作，但你知道.. 不推荐它，chrome 完全忽略它。

注意：如果我捕捉到这个 jquery 指令并使用 chrome 控制台或 firefug 执行它，则元素开始按照我的意愿闪烁。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:45:09.837

使用 CSS：

```
.hidden {
    visibility:hidden;
} 
```

jQuery 类选择器已经选择了所有元素作为一个组。无需循环。

JS：

```
setInterval(function () {  
    $('.blink').toggleClass('hidden');
}, 500); 
```

# sendgrid - 使用 SendGrid 发送电子邮件 - 本地可以，远程不行

> ID：12903596
> 
> 赞同：9
> 
> 时间：2012-10-15T20:36:14.770
> 
> 标签：sendgrid, azure-web-app-service

**使用 SendGrid 发送电子邮件**

在我的本地（下面的代码）上工作得很好没有源代码控制，只需将相同代码的直接 WebDeploy 到 AzureWebsites 就会产生下面的错误。SendGrid 支持没有任何线索。

***异常详细信息：System.Net.Sockets.SocketException：***

***[SocketException (0x271d): 试图以访问权限禁止的方式访问套接字]***

*CodeScales.Http.HttpClient.Navigate（HttpRequest 请求，HttpBehavior httpBehavior）+772 CodeScales.Http.HttpClient.Execute（HttpRequest 请求）+45 SendGridMail.Transport.REST.Deliver（ISendGrid 消息）+115*

```
public bool SendEmail(string from, string to, string subject, string content)
  {
       var myMessage = SendGrid.GenerateInstance();
       // Setup the email properties.
       myMessage.From = new MailAddress(from);
       myMessage.AddTo(to);
       myMessage.Text = content;
       myMessage.Subject = subject;

       var username = "#####";
       var pswd = "#####";
        var credentials = new NetworkCredential(username, pswd);
        // Get REST instance for sending email.
        var transportREST = REST.GetInstance(credentials);

        // Send the email.
        transportREST.Deliver(myMessage);

        return true;
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T21:28:23.073

这看起来像是某种 Windows Azure 错误，而不是 SendGrid 问题。我解决此问题的两个建议是：

**1\. 尝试使用 SMTP API 而不是 Web API 来发送电子邮件**

可能是出站 HTTP 连接有问题（这真的让我感到惊讶，但是嘿，它确实发生了）。

**2\. 尝试使用 Azure 提供的代码**

Azure 有关于如何使用 SendGrid 的非常好的文档，可能值得看看这些文档并使用他们的一些示例代码。

[http://www.windowsazure.com/en-us/develop/net/how-to-guides/sendgrid-email-service/](http://www.windowsazure.com/en-us/develop/net/how-to-guides/sendgrid-email-service/)

**3\. 联系 Azure 支持**

他们可以查看引擎盖下的内容，看看您正在做什么导致错误。如果您这样做，请确保您在此处发回他们所说的内容。

# c# - 多个 .net 应用程序，单点将站点置于维护模式

> ID：12903599
> 
> 赞同：0
> 
> 时间：2012-10-15T20:36:21.197
> 
> 标签：c#, asp.net

我有一个 asp.net 网站，其中包含其他“子”asp.net 应用程序，这些应用程序设置为单独的 IIS 应用程序，而其他不是子应用程序。

什么是防止用户在部署/更新/停机期间访问网站的好方法。

我知道我可以使用 web.config 来做到这一点，但这意味着我必须在站点锁定期间手动更新多个 web.config。

我也可以让每个请求都访问数据库，但这似乎有点多。

建议？

我没有直接访问服务器的权限，所以我不能摆弄 IIS。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-15T20:37:46.373

您只需将`app_offline.htm`文件放在网站的根目录中即可将 IIS 置于维护模式。

一旦 IIS 看到这一点，所有流量都将定向到此页面。但是，这个 .htm 文件可以包含的内容有一些严格的限制。

脱机文件不能包含对其他文件的引用，因此需要将样式等嵌入其中才能工作。

作为额外的奖励，尽管大多数人认为您无法在此离线文件中添加图像（因为您无法从此离线文件访问其他文件），但从技术上讲，您仍然可以通过将图像转换为 base64 编码并创建 html 图像标签来渲染它。我相信这适用于 IE 8+，以及 chrome、FF 和 safari。

```
<img src="data:image/png;base64,iVBORw0KGgoAAAANS..." /> 
```

# javascript - 在 Rails 中使用按钮的 id 呈现部分

> ID：12903601
> 
> 赞同：0
> 
> 时间：2012-10-15T20:37:03.867
> 
> 标签：javascript, jquery, ruby-on-rails, partial, renderpartial

我有一个视图，其中显示用户创建的所有事件列表的部分视图，旁边有一个编辑链接。我想要发生的是，当用户单击“编辑”时，下面会出现一个表单部分，以便您可以编辑该事件。

为简单起见，我设法让按钮的 id 与事件的 id 相同。所以，我想要发生的是，当单击 id 为 2 的按钮时，下面会出现一个表单来编辑 id 为 2 的事件。

我想我需要进行某种 AJAX 调用来呈现部分，但我不知道该怎么做。任何帮助将不胜感激，谢谢。

到目前为止，我所拥有的是（所有的编辑按钮都有一个 btn-info 类）：

```
$(document).ready(function(){
    $('.btn-info').click(function(e){
        e.preventDefault;
        var btnID = this.id;
        //something here to get the partial to render 
    });
}); 
```

我可以使用类似下面的东西来调用部分吗？我知道这不起作用，但可以更好地了解我想要实现的目标：

```
$("#events").html("<%= escape_javascript render( edit_event_path(btnID) ) %>"); 
```

更新：根据要求，控制器和视图：

编辑事件控制器上的操作：

```
def edit
    @event = Event.find(params[:id])

    respond_to do |format|
      format.html
      format.js
    end
end 
```

项目显示完整的粘贴 javascript 视图：

```
<script>
    $(document).ready(function(){
    $('#new-event-button').click(function(e){
        e.preventDefault();
        $('#edit-events').hide();
        $('#delete-events').hide();
        $('#new-event').slideDown(function(){
            $('html, body').animate({
            scrollTop: $(document).height()-$(window).height()},200,"linear"
            );
        });
    });
    $('#edit-events-button').click(function(e){
        e.preventDefault();
        $('#new-event').hide();
        $('#delete-events').hide();
        $('#edit-events').slideDown(function(){
            $('html, body').animate({
            scrollTop: $(document).height()-$(window).height()},200,"linear"
            );
        });
    });
    $('#delete-events-button').click(function(e){
        e.preventDefault();
        $('#new-event').hide();
        $('#edit-events').hide();
        $('#delete-events').slideDown(function(){
            $('html, body').animate({
            scrollTop: $(document).height()-$(window).height()},200,"linear"
            );
        });
    });
    $('.btn-info').click(function(e){
        e.preventDefault;
        $('#events-forms').after('<%= escape_javascript( render :partial => "eventform", :locals => { :event => @event } ) %>');
    });
});

</script>

<div class="content-box timeline-box">
<div id="my-timeline"></div><br /><br />
<br />

<button id="new-event-button" class="btn btn-success btn-large">New Event</button>
<button id="edit-events-button" class="btn btn-info btn-large">Edit Events</button>
<button id="delete-events-button" class="btn btn-danger btn-large">Delete Events</button>

<div id="events-forms">
    <div id="new-event">
        <%= render :partial => "new_event", :locals => { :event => Event.new(:timeline_id=>@timeline.id) } %>
    </div>

    <div id="edit-events">
        <%= render :partial => "edit_events", :locals => { :events => current_user.events } %>  
    </div>

    <div id="delete-events">
        <%= render :partial => "delete_events", :locals => { :events => current_user.events } %>        
    </div>
</div> 
```

以及编辑事件的表单（'_eventform.html.erb'）：

```
<%= form_for(event) do |f| %>
  <% if event.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(event.errors.count, "error") %> prohibited this event from being saved:</h2>

      <ul>
      <% event.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <%=f.hidden_field 'timeline_id', :value => current_user.timeline.id %>
  <div class="field">
    <%= f.label :start_date %><br />
    <%= f.date_select :start_date %>
  </div>
  <div class="field">
    <%= f.label :headline %><br />
    <%= f.text_area :headline %>
  </div>
  <div class="field">
    <%= f.label :text %><br />
    <%= f.text_area :text %>
  </div>
  <div class="field">
    <%= f.label :media %><br />
    <%= f.text_area :media %>
  </div>
  <div class="field">
    <%= f.label :caption %><br />
    <%= f.text_area :caption %>
  </div>
  <div class="actions">
    <%= f.submit %>
  </div>
<% end %> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T20:46:23.380

这是我将在部分列表中执行的操作：

```
<% @events.each do |event| %>
   <div id="event_<%= event.id">
      #... whatever event display code you use
      <%= link_to "edit", edit_event_path(event), :class => '.btn-info', :remote => true %>
   </div>
<% end %> 
```

在您的控制器中：

```
class EventsController < ApplicationController

  def edit
    @event = Event.find(params[:id])
    #.. whatever else you currently have here

    respond_to do |format|
      format.html
      format.js
    end
  end

end 
```

然后，在新视图 ( `app/views/events/edit.js.erb`) 中：

```
$('#event_<%= @event.id %>').after('<%= escape_javascript( render :partial => "edit_events", :locals => { :event => @event } ) %>'); 
```

# internet-explorer - 什么可能导致网页在 IE7 中为空白但在 IE9 中有效？

> ID：12903602
> 
> 赞同：0
> 
> 时间：2012-10-15T20:37:11.247
> 
> 标签：internet-explorer, internet-explorer-7, internet-explorer-9, web-testing

我们正在处理在 IE7 中为空白但不是 IE9 的页面。有点难过。参见例如：[http ://cospace.co/austin-tx/cospace-n-austin/ruby-on-rails](http://cospace.co/austin-tx/cospace-n-austin/ruby-on-rails)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T20:39:19.667

IE7 和 IE9 之间的代码更改会导致它们以不同的方式呈现。（这并不意味着聪明）这就是为什么，从 IE8 开始，有一个“兼容模式”。

他们在渲染引擎中进行了相当多的更改，以使 IE 更符合标准。

有关详细信息，请参阅以下内容：http: [//windows.microsoft.com/en-US/windows7/webpages-look-incorrect-in-Internet-Explorer](http://windows.microsoft.com/en-US/windows7/webpages-look-incorrect-in-Internet-Explorer)和[http://en.wikipedia.org/wiki/Compatibility_mode#IE8](http://en.wikipedia.org/wiki/Compatibility_mode#IE8) .

# r - 如何使用 xts 对象处理 TTR 库中的“系列包含非领先的 NA”？

> ID：12903606
> 
> 赞同：5
> 
> 时间：2012-10-15T20:37:25.597
> 
> 标签：r, xts

在建模量化交易模型时，我经常遇到如何处理 NA 值的相同问题。下面的示例是关于自 1997 年 1 月 1 日以来的 EOD 数据存储在 xts 对象中的股票，该对象具有名为“High”、“Low”、“Close”、“Volume”的四列。数据来自彭博社。当我想计算滚动 20 天的交易量时，会出现错误消息：

```
SMA(stock$Volume, 20)
Error in runSum(x, n) : Series contains non-leading NAs 
```

我很快找到了问题（我知道这是 NA 值，因为我已经尝试了 1000 次）并找到了丢失体积数据的两天。我在下面复制了那些日子的数据。作为快速观察`SMA`，`EMA`如果 TTR 中的 等函数前面有数字，后面有数字，则它们无法处理 NA。

```
stock <- as.xts(matrix(c(94.46,92.377,94.204,NA,71.501,70.457,70.979,NA), 2, 4,
  byrow = TRUE, dimnames = list(NULL, c("High","Low","Close","Volume"))),
  as.Date(c("1998-07-07", "1999-02-22"))) 
```

处理这个问题的最佳方法是什么？是否将其存储`stock$Volume`为临时对象，其中 NA 值被删除，然后计算滚动量并将其合并回来，`merge.xts`同时添加`fill = NA`再次插入 NA 值？但这是否正确，因为您使用了最后 20 个交易日，而不仅仅是 20 天窗口中可用的 19 个交易日？

我希望某种“最佳实践”可以成为这篇文章的结果，因为我认为这个问题也会发生在金融领域的其他 R 用户身上，无论他们是从彭博、雅虎财经还是其他来源获取数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T20:22:06.270

我不知道“最佳实践”，但一种替代方法可能是所谓的“非均匀时间序列运算符”，如[Operators on Inhomogeneous Time Series](http://papers.ssrn.com/sol3/papers.cfm?abstract_id=208278)中所述。

这类问题非常适合 Quantitative Finance 堆栈交换站点（例如，请参阅[如何使用缺失值更新指数移动平均线？](https://quant.stackexchange.com/questions/581/how-to-update-an-exponential-moving-average-with-missing-values)）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-03-22T09:16:51.643

以包含 NA 的初始时间序列为例，例如`a.ts` 通过使用`na.approx`通用函数用插值替换每个 NA 来近似 NA（动物园包文档中的更多详细信息）

```
b.ts=na.approx(a.ts) 
```

`b.ts`是时候

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-02-03T10:55:26.200

试试`na.omit`。

我有同样的问题，这为我解决了这个问题。

# java - Java - 注册表添加空间的问题

> ID：12903616
> 
> 赞同：0
> 
> 时间：2012-10-15T20:38:08.057
> 
> 标签：java, path, space

我想在我的 Windows 注册表中添加一个新条目。我正在使用以下代码：

```
String start_cmd = JAVABIN + " -jar " + outputJar.getAbsolutePath();

ProcessBuilder pb = new ProcessBuilder(new String[]{"REG", "ADD", REGENTRY, "/v", "Vodemki_app", "/d", "\"" + start_cmd + "\"", "/f"});
pb.start(); 
```

我`REGENTRY`的 reg 路径也是如此（例如：`HKEY_LOCAL_MACHINE\\SOFTWARE\\...`. `start_cmd`是一个启动我的 jar 文件的命令。如果我的绝对路径不包含任何空格，它会很好地工作。但如果我使用类似的路径`C:\\Vodemki\\Desktop\\My Folder\\jarfile.jar`，一切都会出错。

所以我的问题是：有没有办法使用我的代码使用带空格的路径？我知道可以使用`\"my path\"`，但是有没有办法在转义引号（例如：）中做到这一点`\"java -jar \"my path with spaces\" \"`？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T14:50:12.713

解决方案很简单，将空格字符替换为`\s`. 问候。

# javascript - 可以使用 jquery .ajax() 调用解析包含 xml 数据的 javascript 对象吗？

> ID：12903617
> 
> 赞同：0
> 
> 时间：2012-10-15T20:38:13.390
> 
> 标签：javascript, jquery

我有一个 javascript 对象，其中包含 xml 数据。我想在 jquery 的 .ajax() 调用中解析这个对象。有谁知道该怎么做？我正在为指针而奋斗。请帮我解决一下这个。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:42:36.283

采用`jQuery.parseXML( data );`

请参阅此处的文档：http: [//api.jquery.com/jQuery.parseXML/](http://api.jquery.com/jQuery.parseXML/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-16T00:07:53.500

这是一个解析`book`标签中包含的书籍目录并将结果缓存到 javascript 对象中以便以后更轻松地访问数据的示例。取自[MSDN 站点的 XML 示例](http://msdn.microsoft.com/en-us/library/windows/desktop/ms762271%28v=vs.85%29.aspx)

与必须再次解析 xml 以查找结果相比，这允许以后更容易地访问数据。商店对象的格式也可以通过这种方式设置为最适合应用程序的需求。

演示：http: [//jsfiddle.net/WpFUE/](http://jsfiddle.net/WpFUE/)

```
var xmlResults = {};

$(xml).find('book').each(function() {
    var $book = $(this);
    var id = $book.attr('id');
    var title = $book.find('title').text();
    var auth = $book.find('author').text();
    var descrip = $book.find('description').text();
    /* store data in object with id for key */
    xmlResults[id] = {
        author: auth
    }

    $('body').append('<div class="book_wrap" data-id="' + id + '">Book: ' + title + '<br>' + descrip + '<p>CLICK ANYEHWERE ON DIV TO GET AUTHOR</div>')

})

$('.book_wrap').click(function() {
    var id = $(this).data('id');
    /* no parsing of xml, use simple javascript object notation to referece data stored*/
    var auth = xmlResults[id].author;
    alert('Author is '+auth)
}) 
```

# php - php 和 html 中的导航以及 javascript 悬停效果

> ID：12903618
> 
> 赞同：2
> 
> 时间：2012-10-15T20:38:19.323
> 
> 标签：php, javascript, html, dynamic, hover

我有一个网站，我正在使用 php 进行导航，我正在尝试使用单个网页，我还有一个从底部向上滑动的联系页面

在 hrefs 中类似于 href="?id=contactme" 然后我使用 switch() 函数来导航页面

但是当我转到联系人页面然后尝试离开它时，它会将任何href添加到当前的href中，例如...com/?id=contactme?

现在我想知道我应该在这些href中使用绝对链接还是总是推荐

同样，在我的计算机上的测试服务器上测试所有这些意味着将链接更改回本地主机，

任何其他帮助或建议都会很棒

还有一个关于 php 的问题，我可以在屏幕或另一个 div 发生变化的地方使用悬停链接或元素与 php，还是我必须使用 javascript？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T20:47:08.070

如果您的所有页面都通过引导程序（即 index.php），那么将您的 href 更改为

```
<a href="index.php?id=contactme">Contact Us</a> 
```

对于问题的第二部分，您将不得不使用 javascript。研究 jquery，因为它使一些任务更容易。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T20:47:40.387

如果您真的想使用这样的前端控制器模式（即一个控制所有页面显示的脚本文件）。我个人认为您最好利用您选择的 Web 服务器的 URL 重写功能（例如 Apache 的 mod_rewrite）来生成所有指向单个控制器文件的干净 URL。因此，例如，您可以拥有最终用户的 URL，例如：

```
www.domain.com/contactme
www.domain.com/anotherpage
www.domain.com/yetanotherpage 
```

这些都可以由服务器定向到类似的东西：

```
www.domain.com/index.php?page=contactme
www.domain.com/index.php?page=anotherpage
www.domain.com/index.php?page=yetanotherpage 
```

浏览器仍然在其地址栏中显示原始的“干净” URL。换句话说，网络服务器将请求定向到 index.php 的事实对最终用户是隐藏的。您的 HTML 中的链接也将使用这些“干净”的 URL，从而使您不必担心自己传递实际参数。

您可以在 Apache 上使用的示例`.htaccess`文件可能如下所示：

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php?page=$1 [L,QSA] 
```

这会将所有不是针对实际文件或目录名称的传入请求定向到您的`index.php`前端控制器。

所以你的 HTML 应该是这样的：

```
<a href="/contactme">Text</a> 
```

关于悬停元素的样式，您可以使用 CSS`:hover`伪类来实现许多基本的悬停样式，但是对于大多数现代 Web 应用程序，您最终可能会使用 CSS 和 javascript 的组合。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T20:59:50.133

为了防止浏览器将当前 URL 添加到您的查询中，您可以使用相对路径，例如

```
<a href="index.php?id=contactme"> 
```

或绝对路径，例如

```
<a href="/index.php?id=contactme"> 
```

绝对路径等于

```
<a href="http://localhost/index.php?id=contactme">
or
<a href="http://mydomain.com/index.php?id=contactme"> 
```

# postgresql - Postgresql 8.3.1 中的 pg_config

> ID：12903619
> 
> 赞同：1
> 
> 时间：2012-10-15T20:38:19.893
> 
> 标签：postgresql

我正在尝试从源代码构建 Postgresql 8.3.1（稍后我需要在其顶部运行扩展补丁）。尽管如此，这`src/tutorial`并没有使

```
$make
make: pg_config: Command not found
make: *** No targets.  Stop. 
```

我去`bin`了安装目录，发现`pg_config.exe`那里，我需要帮助才能使配置检测到它。

我试过类似的东西：

```
./configure --with-pg-config=path/pgsql/bin
 make
 make install 
```

但它仍然无法正常工作。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T01:16:48.523

在运行之前，您需要确保它`pg_config`位于可执行搜索路径（`PATH`环境变量）上`configure`。

看来您可能正在将 MinGW 与 msys 一起使用，在这种情况下，您可以使用 Andrew 提出的语法。[但是，根据文档](http://www.mingw.org/wiki/Posix_path_conversion)，PostgreSQL 可执行文件的位置在 msys 上可能有点奇怪。UNIX 路径中有冒号，因此它们不能包含驱动器说明符`c:\`，因此 MinGW 将驱动器号“挂载”为根目录条目，如`/c`. 因此，`c:\Program Files\PostgreSQL 8.3\bin`你会使用：

```
"/c/Program Files/PostgreSQL 8.3/bin/pg_config.exe" 
```

注意双引号。尝试在 msys 中将其作为命令运行，看看会发生什么。如果`pg_config`输出不是错误，请将其添加到`PATH`with：

```
export PATH="$PATH:/c/Program Files/PostgreSQL 8.3/bin" 
```

如果你在 Cygwin 上，那么：

*   这不是一个真正理想的环境，半窗口半unix。考虑 MinGW+msys，或使用 Windows 平台 SDK 编译器和 Windows 构建脚本本地编译 PostgreSQL，按照[从 Windows 上的源代码安装](http://www.postgresql.org/docs/current/static/install-windows.html)。

*   Cygwin 也会挂载`C:\`，`/c/`因此上面的路径对 Cygwin 应该同样有效。

如果您清楚地提到，这会容易得多：

*   您的操作系统
*   您的编译器和工具集

此外，a_horse_with_no_name 非常正确：现在安装 PostgreSQL 8.3.1 简直是疯了。绝对最低限度，您应该安装 8.3.21，即撰写本文时 8.3 系列的当前版本。根据[版本策略](http://www.postgresql.org/support/versioning/)，这与所有 8.3.x 版本完全兼容。然后，您应该在 8.3 生命周期结束之前开始紧急准备以更新到 9.2（或 9.1，如果您坚持的话）；再次，请参阅版本政策。

# python - Python - 用户定义的类默认有 __cmp__() 和 __hash__() 方法？或者？

> ID：12903620
> 
> 赞同：13
> 
> 时间：2012-10-15T20:38:27.217
> 
> 标签：python, methods, comparison, default

在 python[文档](http://docs.python.org/reference/datamodel.html#object.__hash__)中（[是的，我在文档中有这个东西](https://stackoverflow.com/questions/10674428/python-supports-a-limited-form-of-multiple-inheritance-in-what-way-limited)）它说：

> 用户定义的类默认有`__cmp__()`和`__hash__()`方法；与它们一起，所有对象都比较不相等（除了它们自己）并`x.__hash__()`返回`id(x)`。

但是下面的代码显示了另一件事：

```
>>> class Test(object): pass
...
>>> t = Test()
>>>
>>> t.__hash__
<method-wrapper '__hash__' of Test object at 0x01F2B5D0>
>>>
>>> t.__cmp__
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: 'Test' object has no attribute '__cmp__'
>>> 
```

那么我在哪里`__cmp__`或者我错过了什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-15T20:44:27.487

该文档有点误导。要获得完整的故事，您必须阅读[`__cmp__`](http://docs.python.org/reference/datamodel.html#object.__cmp__)，即这部分：

> 如果没有定义或操作`__cmp__()`，则通过对象标识（“地址”）比较类实例。`__eq__()``__ne__()`

因此，基本上，默认情况下您不会获得`__cmp__`方法，但用户定义类的实例可以与其他对象进行比较；如果实例没有`__cmp__`方法，则将使用对象标识（由 确定`id(obj)`，通常是对象的内存地址）。

# c# - NHibernate linq 扩展命令子对象集合

> ID：12903622
> 
> 赞同：1
> 
> 时间：2012-10-15T20:38:27.403
> 
> 标签：c#, database, linq, nhibernate

我正在尝试使用 NH Linq 扩展查询我的数据库，这就是我卡住的地方：

我有一个`Customer`对象，它有一个类型的属性`Order`，并且`Order`有一个`ICollection<Orderline>`集合，最后`Orderline`一个对象有一个`int`名为' `price`'的类型的属性。我想要做的是，给定一个 customerId，我应该获取所有客户信息（订单和订单行），并且`Orderline`对象的集合应该按`Orderline's`价格属性排序。为了清楚起见，我省略了所有其他细节。

`Customer`注意：在这种情况下，和之间的关系`Order`是`1 to 1`。一个客户只能有 1 个订单，一个`Order`可能包含许多`Orderlines`您可能从集合类型中推断出来的订单。

非常感谢您的帮助...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T10:51:49.577

```
var query = from customer in session.Query<Customer>()
            let order = customer.Order
            from orderline in order.Orderlines
            orderby orderlines.price
            select new
            {
                CustomerId = customer.Id,
                CustomerName = customer.Name,
                OrderId = order.Id,
                OrderLineId = orderline.Id,
                Price = orderline.Price,
            };

var results = query.ToLookup(a => a.CustomerId)
    .Select(g => new CustomerDto
    {
        Id = g.Key,
        CustomerName = g.First().CustomerName,
        OrderLines =  g.Select(a => new OrderLineDto(a.OrderLineId, a.Price)).ToList()
    }).ToList(); 
```

# ruby-on-rails - Rails 是否支持 TCP/IP 级别的操作？

> ID：12903623
> 
> 赞同：1
> 
> 时间：2012-10-15T20:38:31.867
> 
> 标签：ruby-on-rails, ruby, tcp

我正在开发一个需要与外部组件集成的 Rails 项目。不幸的是，唯一可用的通信通道是通过 TCP/IP。Rails 可以在 TCP/IP 层上运行吗？如果没有，是否有任何好的 Ruby 库可以用来轻松集成回 Rails？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:40:36.343

是的，ruby 标准库中有一个类：[TCPSocket](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/socket/rdoc/TCPSocket.html)。它有你需要的一切。

# spring - 春天 和 JBoss AS7 - 没有可用于处理的 EJB 接收器

> ID：12903624
> 
> 赞同：8
> 
> 时间：2012-10-15T20:38:44.910
> 
> 标签：spring, ejb, jboss7.x

我在 JBoss AS 7 上有 @Remote EJB，可以通过 name 获得`java:global/RandomEjb/DefaultRemoteRandom!pl.lechglowiak.ejbTest.RemoteRandom`。

独立客户端是使用`<jee:remote-slsb>`bean 的 Spring 应用程序。尝试使用该 bean 时，我得到`java.lang.IllegalStateException: EJBCLIENT000025: No EJB receiver available for handling [appName:, moduleName:RandomEjb, distinctName:] combination for invocation context org.jboss.ejb.client.EJBClientInvocationContext@1a89031`.

这是 applicationContext.xml 的相关部分：

```
<jee:remote-slsb id="remoteRandom"
    jndi-name="RandomEjb/DefaultRemoteRandom!pl.lechglowiak.ejbTest.RemoteRandom"
    business-interface="pl.lechglowiak.ejbTest.RemoteRandom"
    <jee:environment>
        java.naming.factory.initial=org.jboss.naming.remote.client.InitialContextFactory
        java.naming.provider.url=remote://localhost:4447
        jboss.naming.client.ejb.context=true
        java.naming.security.principal=testuser
        java.naming.security.credentials=testpassword
    </jee:environment>
</jee:remote-slsb>

<bean id="remoteClient" class="pl.lechglowiak.RemoteClient">
    <property name="remote" ref="remoteRandom" />
</bean> 
```

RemoteClient.java 公共类 RemoteClient {

```
private RemoteRandom random;

public void setRemote(RemoteRandom random){
    this.random = random;
}

public Integer callRandom(){
    try {
        return random.getRandom(100);
    } catch (Exception e) {
        e.printStackTrace();
        return null;
    }
} 
```

}

我的 jboss 客户端 jar：org.jboss.as jboss-as-ejb-client-bom 7.1.2.Final pom

pl.lechglowiak.ejbTest.RemoteRandom 可用于客户端应用程序类路径。jndi.properties 包含确切的属性，`<jee:environment>`如`<jee:remote-slsb>`.

这样的代码无一例外地运行：

```
Context ctx2 = new InitialContext();
RemoteRandom rr = (RemoteRandom)  ctx2.lookup("RandomEjb/DefaultRemoteRandom!pl.lechglowiak.ejbTest.RemoteRandom");
System.out.println(rr.getRandom(10000)); 
```

但是这个：

```
ApplicationContext ctx = new ClassPathXmlApplicationContext("applicationContext.xml");
RemoteClient client = ctx.getBean("remoteClient", RemoteClient.class);
System.out.println(client.callRandom()); 
```

以异常结束：java.lang.IllegalStateException: EJBCLIENT000025: 没有 EJB 接收器可用于处理调用上下文 org.jboss.ejb.client.EJBClientInvocationContext@1a89031 的 [appName:, moduleName:RandomEjb, distinctName:] 组合。

`jboss.naming.client.ejb.context=true`已设置。你知道我在哪里设置错误`<jee:remote-slsb>`吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T20:16:22.087

我刚刚解决了一个非常相似的问题。您是否创建了“jboss-ejb-client.propeties”文件？

如果没有，请查看以下内容： [https](https://docs.jboss.org/author/display/AS71/EJB+invocations+from+a+remote+client+using+JNDI) ://docs.jboss.org/author/display/AS71/EJB+invocations+from+a+remote+client+using+JNDI （特别是“设置 EJB 客户端上下文属性”子-话题）

[https://community.jboss.org/message/740827](https://community.jboss.org/message/740827)

[https://community.jboss.org/thread/197989](https://community.jboss.org/thread/197989)

您应该将文件放在客户端的类路径中。这是一个简单的示例，说明它的外观：

```
remote.connectionprovider.create.options.org.xnio.Options.SSL_ENABLED=false

remote.connections=default

remote.connection.default.host=localhost
remote.connection.default.port=4447
remote.connection.default.connect.options.org.xnio.Options.SASL_POLICY_NOANONYMOUS=false

remote.connection.default.username=login
remote.connection.default.password=password 
```

祝你好运！

PS：此配置中唯一特定于项目的值是“用户名”和“密码”。

PS2：如果你没有在你的 jboss 设置中添加用户，它是通过位于你的 jboss 文件夹中的“bin/add-user.[bat/sh]”脚本完成的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T04:38:24.670

设置`expose-access-context="true"`为 jee:remote-slsb taglib。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-03T09:56:04.720

使用 java.naming.factory.url.pkgs=org.jboss.ejb.client.naming 而不是 java.naming.factory.initial=org.jboss.naming.remote.client.InitialContextFactory

# command-prompt - 如何以不同用户和管理员身份从命令提示符运行程序

> ID：12903629
> 
> 赞同：57
> 
> 时间：2012-10-15T20:39:08.670
> 
> 标签：command-prompt, administrator

我正在使用“runas”以其他用户身份打开命令提示符，但该命令提示符未以管理员身份运行。我怎样才能让它以管理员身份运行？

更新：我正在使用 Windows Server 2012

更新：我通过运行为另一个帐户打开了 cmd

```
 runas /user:domain\username cmd.exe 
```

然后我尝试在这个新提示中运行一些命令，但这不是作为提升的用户运行的（即使它具有管理员权限）。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2012-10-15T20:44:48.670

见这里： [https ://superuser.com/questions/42537/is-there-any-sudo-command-for-windows](https://superuser.com/questions/42537/is-there-any-sudo-command-for-windows)

根据该命令对于管理员来说如下所示：

```
 runas /noprofile /user:Administrator cmd 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-04-01T19:42:31.693

开始-> shift + 命令提示右键单击将有助于以其他用户或管理员身份使用

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2013-11-05T19:28:20.853

不幸的是，所有这些答案都没有抓住重点。

这里有 2 个安全上下文的细微差别，我们需要它们重叠。- “以管理员身份运行” - 更改您在本地计算机上的执行级别 - “以不同用户身份运行” - 选择您在哪个用户凭据下运行进程。

当在工作站上启用 UAC 时，有一些进程拒绝运行，除非提升 - 仅仅成为本地“管理员”组的成员是不够的。如果您的要求还要求您对登录时使用备用凭据，我们需要一种方法来调用该过程作为备用凭据和提升。

我发现可以使用的，虽然有点麻烦，是：

*   以管理员身份运行 CMD 提示符
*   使用 Sysinternals psexec 实用程序，如下所示：

    psexec \\localworkstation -h -i -u 域\其他用户 exetorun.exe

需要第一次提升才能推送 psexec 服务。-h 运行提升的新“远程”（本地）进程，-i 让它与桌面交互。

也许有比这更简单的方法？

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2016-10-17T23:40:46.543

我找到了一种用一行代码来做到这一点的方法：

```
runas /user:DOMAIN\USER2 /savecred "powershell -c start-process -FilePath \"'C:\\PATH\\TO\\YOUR\\EXECUTABLE.EXE'\" -verb runAs" 
```

这里有一些技巧。

**1**：我们告诉 CMD 只是以 DOMAIN\USER2 身份运行 Powershell

**2**：我们将“Start-Process”命令传递给 Powershell，使用动词“runAs”将 DOMAIN\USER2 提升到管理员/提升权限模式。

作为一般说明，“FilePath”参数中的转义字符**必须**存在（换句话说，“\ & \\”字符组合），并且单引号 (')**必须**围绕 EXE 路径 - 这样，CMD 解释FilePath 作为单个字符串，然后 Powershell 使用单引号将 FilePath 解释为单个参数。

**使用“RunAs”动词在 Powershell 中提升**：[http://ss64.com/ps/syntax-elevate.html](http://ss64.com/ps/syntax-elevate.html)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-06-01T10:00:23.840

您可以使用 Microsoft Sysinternals Suite [https://docs.microsoft.com/en-us/sysinternals/downloads/sysinternals-suite中的 psexec.exe](https://docs.microsoft.com/en-us/sysinternals/downloads/sysinternals-suite)

例子：

```
c:\somedir\psexec.exe -u domain\user -p password cmd.exe 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-15T20:44:40.930

Runas 不会神奇地以管理员身份运行命令，它会以您为其提供凭据的任何帐户运行它们。如果它不是管理员帐户，runas 不在乎。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-06-27T19:32:37.877

在我的情况下，我已经以本地管理员身份登录，我需要以域管理员身份运行 CMD，所以对我有用的是**从 powershell 窗口**运行以下内容：

runas /noprofile /user:DOMAIN\USER "cmd"

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-04-12T02:28:37.027

打开记事本并粘贴以下代码：

```
@echo off
powershell -Command "Start-Process cmd -Verb RunAs -ArgumentList '/c %*'"
@echo on 
```

然后，将文件另存为`sudo.cmd`. 复制此文件并将其粘贴到您的 PATH 环境变量中`C:\Windows\System32`或添加路径。`sudo.cmd`

当您打开命令提示符时，您现在可以运行类似`sudo start .`.

如果您希望在运行命令时终端窗口保持打开状态，请将记事本中的代码更改为：

```
@echo off
powershell -Command "Start-Process cmd -Verb RunAs -ArgumentList '/k %*'"
@echo on 
```

解释：

`powershell -Command`运行 powershell 命令。

`Start-Process`是一个启动进程的 powershell 命令，在本例中为命令提示符。

`-Verb RunAs`以管理员身份运行命令。

`-Argument-List`使用参数运行命令。

我们的论点是`'/c %*'`。`%*`表示所有参数，所以如果你这样做了`sudo foo bar`，它将在命令提示符下运行，`foo bar`因为参数是 foo 和 bar，并`%*`返回`foo bar`.

`/c`是命令完成后关闭窗口的`/k`cmd参数，是保持窗口打开的cmd参数。

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2013-08-09T16:40:00.877

最简单的方法是创建一个批处理文件 (.bat) 并以管理员身份运行。

右键单击并“以管理员身份运行”

# python - 如何在python中正确装饰一个类

> ID：12903634
> 
> 赞同：0
> 
> 时间：2012-10-15T20:39:44.270
> 
> 标签：python, module, decorator

我在做这件事时遇到了一些麻烦。目前我有一个模块，其中有一堆类，其中一些类将被装饰以指示一些东西。

我想要的是创建一个只包含装饰类的新的假模块。所以是这样的：

```
class FakeModule: pass

def Decorator(cls):
    attr = getattr(RealModule, cls)
    setattr(FakeModule, cls, attr) 
```

有什么建议么？我对 python 和 python 装饰器很陌生，所以我不太确定这样做的正确方法是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T21:09:41.413

> 我想要的是创建一个只包含装饰类的新的假模块

如果装饰器在类上设置了一些独特的属性或值，那么您可以从模块中获取所有类并使用`inspect`模块过滤它们：

```
def is_decorated_class(cls, _sentinel=object()):
    return (inspect.isclass(cls) and 
            getattr(cls, "some_attr", _sentinel) == value)

name_class_pairs = inspect.getmembers(realmodule, is_decorated_class) 
```

# xml - Visual Studio 2012 中的 XML 数据源连接

> ID：12903643
> 
> 赞同：0
> 
> 时间：2012-10-15T20:40:22.707
> 
> 标签：xml, connection, visual-studio-2012, datasource

是否可以在 Visual Studio 2012 中创建 XML 数据源连接？当我为 XML 数据库创建新连接时，我看不到任何 XML 文件的选择。我看到的只有以下内容：

Access、ODBC、SQL Server (3) 和 Oracle

可能吗？

# stored-procedures - 当我从 ADO Connection 调用时，存储过程未正常运行

> ID：12903651
> 
> 赞同：1
> 
> 时间：2012-10-15T20:40:36.843
> 
> 标签：stored-procedures, ado.net, connection

我正在从 VB.Net 调用一个存储过程，但它运行不正常。但是，如果我在 SQL Server 中执行相同的存储过程，它会运行良好。在 SQL Server 中完成它的执行大约需要 5 到 10 秒。但是在 VB.Net 中，使用 ADO Connection 方法（Connection.Execute("Exec Copy_Testset_Folder 7, 31, 1, 1, 1, 0, 0")，它只是执行了 1 或 2 秒，然后就停止了。没有错误已返回。

实际上，我创建了这个存储过程来复制现有数据。假设我必须从各种表中复制 200 行数据，它只是复制 50 行然后停止。它不会抛出任何错误消息。

我在这个存储过程中使用了递归调用和 3 个游标。请让我知道，如果任何机构对此有解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T08:09:52.727

您应该使用[`SqlCommand`](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.aspx)对象、SqlParameters 和`ExecuteNonQuery`方法。

有关示例，请参见[http://www.csharp-station.com/Tutorial/AdoDotNet/Lesson06 。](http://www.csharp-station.com/Tutorial/AdoDotNet/Lesson06)

# java - 拆分字符串数组时如何转义正则表达式

> ID：12903654
> 
> 赞同：0
> 
> 时间：2012-10-15T20:41:15.983
> 
> 标签：java, regex, string, split, escaping

我正在寻找一个更简单的解决方案。我是 Java 新手，需要一点帮助。我试图通过这个']，['将字符串拆分为字符串[]。问题是 Java 试图像 Regex 一样获得这些，我不想使用它，因为我在它方面还不够好。我只想用这三个字符“]，[”分割字符串；这是我的代码：

```
String usefulData = ...;
String[] list = null;
String token = "],[";
list = usefulData.split(token); 
```

这是错误输出：线程“AWT-EventQueue-0”中的异常 java.util.regex.PatternSyntaxException: Unclosed character class near index 2 ],[... 请，有什么建议可以让这个想法有效吗？

PS。有没有其他方法可以拆分字符串？我不太喜欢这个正则表达式。我一直在使用 Qt 和 C#，并且在这两个地方都有一种方法可以摆脱这个正则表达式。非常感谢人们！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-15T20:43:55.517

你要 ”\]\，\[”。

```
String usefulData = ...;
String[] list = usefulData.split("\\],\\["); 
```

这是因为`[`和`]`是 RegEx 中的特殊字符。您必须将它们转义`\\`才能将它们用作常规字符。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-15T20:46:30.337

[`Pattern#quote`](http://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html#quote%28java.lang.String%29)您可以使用方法构建您的字符串。

这样，您就不必`escape`使用反斜杠来处理特殊字符。`Pattern.quote`使您的所有`special characters`in 字符串表现得像字符串文字：-

```
String usefulData = "[a],[b],[c,d]";
String token = Pattern.quote("],[");
String[] list = usefulData.split(token);

for (String val: list) {
    System.out.println(val.replaceAll("\\[|\\]", ""));
} 
```

**输出**： -

```
a
b
c,d 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-15T20:48:02.163

```
String usefulData = ...;
String[] list = null;
String token = "],[";
list = usefulData.split(java.util.regex.Pattern.quote(token)); 
```

# python - 如何使用pygame放大/缩小？

> ID：12903657
> 
> 赞同：0
> 
> 时间：2012-10-15T20:41:34.120
> 
> 标签：python, zooming, pygame

我正在制作一个模拟城市应用程序。在应用程序中，会有随机时间发生的事件。我希望用户能够放大该事件以获取详细视图。

如果不放大，事件的位置只是标记了一个 X。如果用户放大，用户将能够看到更多的事件细节；即，如果是车祸，放大用户可能会看到 2 辆以上的汽车碰撞和一些动画等。

我希望缩放工作的方式是让用户能够暂停应用程序，将鼠标移动到事件的位置，滚动以放大/缩小。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:51:27.700

您可以使用负责缩放（以及透视）的 3D 到 2D 投影功能（方法），例如：

```
class Point3D:

    def __init__(self, x = 0, y = 0, z = 0):
        self.x, self.y, self.z = float(x), float(y), float(z)

 ...

    def project(self, win_width, win_height, fov, viewer_distance, perspective):
        """ 
        Transforms this 3D point to 2D using a perspective projection. 
        """
        if perspective:
            factor = fov / (viewer_distance + self.z)
        else:
            factor = fov / viewer_distance
        x = self.x * factor + win_width / 2
        y = -self.y * factor + win_height / 2
        return Point3D(x, y, self.z) 
```

在这种情况下，参数 viewer_distance 用于缩放。

# php - CodeIgniter 表单验证无法识别 $_FILES

> ID：12903659
> 
> 赞同：0
> 
> 时间：2012-10-15T20:41:48.127
> 
> 标签：php, validation, codeigniter, file-upload

我使用自定义表单验证器功能来检查是否正在上传图像类型文件。它非常简单，但无论我尝试什么，我似乎都无法让验证器正确传递变量。

**HTML**

```
<input type="file" name="image" /><div><?php echo form_error('image'); ?></div> 
```

**控制器**

```
public function postAd(){
    $this->form_validation->set_rules("image", "image", "callback_valid_image");

     if ($this->form_validation->run()==FALSE){
            $this->load->view('header', array('title'=>"Post an ad"));
            $this->load->view('ads/default');
            $this->load->view('footer');
        }else{
            echo "EMPTY";
        }
}

public function valid_image($file){
     echo "RAW:" . $file . "<br />";
     echo "FILE:",$_FILES[$file];
} 
```

我也在 form_validation 语言文件中设置了消息。

无论我输入什么类型的文件，或者如果我将其留空，它都不会在 echo "RAW" 或 echo "FILE" 行显示任何文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T20:49:27.933

[表单验证库](http://codeigniter.com/user_guide/libraries/form_validation.html)不适用于`$_FILES`数组，仅适用于`$_POST`. 您应该使用[文件上传库](http://codeigniter.com/user_guide/libraries/file_uploading.html)并使用以下内容：

```
if (!$this->upload->do_upload()){
    $error = array('error' => $this->upload->display_errors());
    $this->load->view('upload_form', $error);
}
else{
    //upload worked.
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T23:18:19.880

要设置您自己的自定义消息，请使用以下函数：

```
$this->form_validation->set_message('rule', 'Message'); 
```

# xna - 在“碰撞层”中添加“对象碰撞”

> ID：12903661
> 
> 赞同：0
> 
> 时间：2012-10-15T20:41:50.260
> 
> 标签：xna, collision-detection, layer, collision

目前，我的角色使用像素完美的碰撞层。我在游戏中添加了一些对象，例如“门”或“平台”，但我的角色穿过了它们。

我想我可以用“合并”之类的东西来修改每个 Update() 的碰撞层。将碰撞层与我想的每个对象合并，但我不知道该怎么做......

[编辑] Q1：如何合并一些`Texture2D`？

谢谢阅读，希望你能指导我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T07:45:27.630

您可以通过 .SetData 和 .GetData -Methods 合并 Texture2D

不过要小心这些方法，因为它们真的很吃帧率。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T14:32:51.743

您可以使用`RenderTargets`. 这是有关如何使用它们的[相关问题。](https://gamedev.stackexchange.com/questions/18388/how-do-i-use-render-targets-in-xna)

基本上，您可以将所有碰撞精灵绘制到渲染目标，从多个纹理中制作单个纹理。如果您的碰撞层经常更改，您可以在每一帧上执行此操作。

希望这可以帮助！

编辑：这是[关于 RenderTargets 的 MSDN 文章](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.graphics.rendertarget%28v=xnagamestudio.31%29.aspx)

更多编辑：或者，您可以检查每个对象上的每像素碰撞，而不是将它们全部合并为一个。但是，您必须显示一些代码才能获得帮助。

# c# - How do i get all the weekdays and dates in a month

> ID：12903663
> 
> 赞同：0
> 
> 时间：2012-10-15T20:42:15.520
> 
> 标签：c#, asp.net, datetime

I am trying to get all the weekdays of the selected Month along with the day like Monday or Tuesday, etc?? How is it possible? is there an inbuilt function that i do not know?

This is in C# 2.0, asp.net using VS 2005

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-15T20:54:20.760

I make no guarantees about leap years, daylight savings jumps, special days, [Shanghai 1927](https://stackoverflow.com/questions/6841333/why-is-subtracting-these-two-times-in-1927-giving-a-strange-result), etc.

```
public List<DateTime> getWeekdatesandDates(int Month, int Year)
{
    List<DateTime> weekdays = new List<DateTime>();

    DateTime firstOfMonth = new DateTime(Year, Month, 1);

    DateTime currentDay = firstOfMonth;
    while (firstOfMonth.Month == currentDay.Month)
    {
        DayOfWeek dayOfWeek = currentDay.DayOfWeek;
        if (dayOfWeek != DayOfWeek.Saturday && dayOfWeek != DayOfWeek.Sunday)
            weekdays.Add(currentDay);

        currentDay = currentDay.AddDays(1);
    }

    return weekdays;
} 
```

The resultant `DateTime` objects have a `DayOfWeek` property which you can check to see if it's Monday through Friday.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T20:57:09.080

This should work

```
private List<DateTime> getWeekDayDates(int month, int year)
{
    List<DateTime> weekdays = new List<DateTime>();
    DateTime basedt = new DateTime(year, month, 1);
    while ((basedt.Month == month) && (basedt.Year == year))
    {
        if (basedt.DayOfWeek == (DayOfWeek.Monday | DayOfWeek.Tuesday | DayOfWeek.Wednesday | DayOfWeek.Thursday | DayOfWeek.Friday))
        {
            weekdays.Add(new DateTime(basedt.Year, basedt.Month, basedt.Day));
        }
        basedt = basedt.AddDays(1);
    }
    return weekdays;
} 
```

Then you can get whatever info out of each DateTime you need.

# javascript - 点击时的Jquery更新计数

> ID：12903665
> 
> 赞同：0
> 
> 时间：2012-10-15T20:42:31.117
> 
> 标签：javascript, jquery, html

我有一个如下的 HTML 片段

```
var useful, cool, funny;

'<ul data-component-bound="true" class="voteset'+data[i]['review_id']+'">'+
    '<li class="useful ufc-btn" id="1">'+
      '<a href=javascript:vote('+data[i]['review_id']+',"useful") rel="useful"><span>Useful</span></a>'+
        '<span>'+useful+'</span>'+
    '</li>'+
    '<li class="funny ufc-btn" id="2">'+
      '<a href=javascript:vote('+data[i]['review_id']+',"funny") rel="funny"><span>Funny</span></a>'+
        '<span>'+funny+'</span>'+
    '</li>'+
    '<li class="cool ufc-btn" id="3">'+
      '<a href=javascript:vote('+data[i]['review_id']+',"cool") rel="cool"><span>Cool</span></a>'+
        '<span>'+cool+'</span>'+
    '</li>'+
    '<span class="vote'+data[i]['review_id']+'"></span></ul>'+
'</div>'; 
```

每个评论都有 3 个有用、酷和有趣的按钮。当我执行点击操作时，如何增加`<span>`每个按钮内的计数。以下是我尝试但不起作用的方法。谢谢

```
function vote(reviewId,status) {
    $('.vote'+reviewId).text('posting ...');
    $('.voteset'+reviewId).click(function(){
      var updatevote = $(this).find("li>span").text();
      updatevote = updatevote + 1;
      $(this).next('span').html(updatevote);
    });
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T03:37:19.290

`parseInt``NaN`如果字符串为空将导致问题`""`，请尝试`Math.floor`

```
function vote(reviewId,status)
{

    $('.vote'+reviewId).text('posting ...');
    $('.vote'+reviewId).text('posting ...');
        var $span = $('.voteset' + reviewId + ' li.' + status + ' span:eq(1)');
        $vote = Math.floor($span.text()) + 1; 
        $span.html($vote);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T20:45:06.550

您`updatevote`将被解释为文本，而不是数字。尝试

```
var updatevote = parseInt($(this).find("li>span").text(), 10); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T20:46:10.710

尝试这个

```
var updatevote = +$(this).find("li>span").text(); // Convert to number

updatevote++; 
```

还会`$(this).find("li>span")` 给你一个包含 li 内所有 span 的对象。我看到其中 3 个在 3 个不同的 li 中

你是怎么处理的。。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-15T20:55:13.193

您的事件绑定存在一般问题

```
function vote(reviewId,status) {
    $('.vote'+reviewId).text('posting ...');
    $('.voteset'+reviewId).click(function(){ // <-don't need this since you call vote directly from a#href
      var updatevote = $(this).find("li>span").text();
      updatevote = updatevote + 1;
      $(this).next('span').html(updatevote);
    });
} 
```

这应该工作：

```
function vote(reviewId,status) {
    $('.vote'+reviewId).text('posting ...');

    var $span = $('.voteset' + reviewId + ' li.' + status + ' span');
    var updatevote = parseInt($span.text(), 10);

    updatevote = updatevote + 1;
    $span.text(updatevote);

} 
```

# android - 一个 Android Activity 的多个实例是否应该出现在 Memory Analyzer 中？

> ID：12903669
> 
> 赞同：2
> 
> 时间：2012-10-15T20:42:42.120
> 
> 标签：android, memory-leaks, android-activity

当我单击应用程序导航时，我发现每次启动新 Intent 时，Android 都会创建一个新的活动实例（使用以下代码）：

```
Intent intent = new Intent(this, HomeActivity.class);
startActivity(intent); 
```

根据我读过的内容，这似乎是默认行为。我猜这意味着堆现在将分配多个实例来维护应用程序的历史记录。然而，Patrick Dubroy 在他[关于内存管理的视频中](http://www.youtube.com/watch?v=_CruQY55HOk&feature=player_detailpage#t=2185s)说，除非存在内存泄漏，否则只有一个活动实例应该出现在您的堆转储中。

我的问题有两个：每次启动意图时都会创建一个新的活动实例，我是否正确？如果是这样，堆转储中出现多个实例是否表明存在内存泄漏？

**根据[任务和返回堆栈指南](http://developer.android.com/guide/components/tasks-and-back-stack.html)**更新**：**

 **> 因为后台堆栈中的活动从不重新排列，如果您的应用程序允许用户从多个活动启动特定活动，则会创建该活动的新实例并将其推送到堆栈（而不是带上任何先前的活动实例）到顶部）。因此，您的应用程序中的一项活动可能会被多次实例化（甚至来自不同的任务）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T13:33:41.183

如果在您的应用程序中，您正在执行以下操作：

```
Intent intent = new Intent(this, HomeActivity.class);
startActivity(intent); 
```

然后，确实，Android 将创建一个新实例`HomeActivity`并将其放在活动堆栈的顶部。这将导致多个**实例**`HomeActivity`这如果那不是您想要的（并且可能不是您想要的），那么有几种可能的方法来处理这个问题。

由于我不知道您的应用程序并且您没有发布任何代码或任何内容，因此我需要做出一些假设。我将假设您`HomeActivity`是用于启动应用程序的第一个活动（也称为**根活动**）。我还将假设`HomeActivity`启动其他活动并且在启动其他活动时**不**调用`finish()`自身。

如果是这种情况，那么您可以`HomeActivity`通过执行以下操作从应用程序中的任何活动返回到您的：

```
Intent intent = new Intent(this, HomeActivity.class);
intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
startActivity(intent); 
```

假设`HomeActivity`未在清单**中**定义`android:launchMode="singleTop"`，这将导致活动堆栈中的所有活动（包括`HomeActivity`）完成，并将创建一个新实例`HomeActivity`作为堆栈中唯一的活动。

如果您只想删除**除**现有实例之外的所有活动`HomeActivity`并返回该实例，则需要执行以下操作：

```
Intent intent = new Intent(this, HomeActivity.class);
intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP | Intent.FLAG_ACTIVITY_SINGLE_TOP);
startActivity(intent); 
```

这将导致活动堆栈（**除外**`HomeActivity`）中的所有活动完成，并将调用`onNewIntent()`然后调用`onResume()`您现有的实例`HomeActivity`.

如果我的假设不正确，请纠正我，我可以提出其他建议。**

# javascript - 接收到 httpResponse 后如何在 Ext.Store 中存储数据

> ID：12903672
> 
> 赞同：0
> 
> 时间：2012-10-15T20:42:51.773
> 
> 标签：javascript, sencha-touch

嗨，我正在使用 sencha touch 编写这个 android 应用程序。收到 httpRequest 响应后，如何将数据存储在 Ext.Store 中。

```
var result = new XMLHttpRequest();
result.onreadystatechange = function(){
var respXml = result.responseXML;
//store this result in Ext.store 
```

}

```
result.open("POST",Uri,true);
result.setRequestHeader("Content-type","application/x-www-form-urlencoded");
result.send(restbody); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T17:41:47.053

我想到了。我只是用

`var id = result.responseText.split('something');`

然后保存到记录中

```
var record = Ext.create('model',{id:id... });

store.add(record); 
```

# c# - ASP.NET WebForms 设计模式

> ID：12903676
> 
> 赞同：2
> 
> 时间：2012-10-15T20:42:59.260
> 
> 标签：c#, asp.net, webforms

我正在使用一个旧的 ASP.NET WebForms 应用程序，我不能真正将它迁移到 ASP.NET MVC，所以我决定至少将应用程序划分一点，让事情更有条理，我得到了一个不错的小 ORM并添加了一个模型层，所以现在我有 aspx 文件，作为我的视图，代码隐藏作为一个控制器，我的单独项目，它是一个类库，作为模型层。

是否有推荐的设计模式，它对 ASP.NET WebForms 来说**简单**且**易于**实现？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:59:06.093

有很多将[MVP](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93presenter)设计模式与 Web 表单结合使用的示例。但是，如果您不想走那么远并重写现有代码库以适应特定模式，只需尝试将大部分代码从 aspx 文件中的事件处理程序提取到单独的文件或项目中。通过一些额外的工作，您可以使许多代码可单元测试并且与 UI 无关。这也将确保您的 aspx 文件将尽可能保持干净，并且不会因代码而臃肿，不直接负责更改控件的状态等。

# jquery - jQuery UI 选项卡不起作用

> ID：12903683
> 
> 赞同：0
> 
> 时间：2012-10-15T17:11:44.290
> 
> 标签：jquery, jquery-ui, tabs

堆。

我们正在开发一个网站：[http ://rodneycrowell.wpengine.com](http://rodneycrowell.wpengine.com)

它是一个单页滚动器，有很多小部件。主页上的第一个小部件是使用 jQuery UI 选项卡设置的。我们已经通过 functions.php 文件将样式和 jQuery ui 排入队列，如下所示：

```
function ahso_scripts() {

    wp_register_script( 'jquery-easing', CHILD_URL . '/library/js/jquery.easing.1.3.js', array('jquery'), '1.3', TRUE );
    wp_register_script( 'jquery-smoothness', CHILD_URL.'/library/js/jquery.smoothscroller.js', array('jquery-easing'), '1.0', TRUE );
    wp_register_style( 'jquery-ui-custom', CHILD_URL.'/library/css/jquery-ui-1.9.0.custom.css', '', '1.9.0', 'all' );

    // only on the home page
    if ( is_front_page() ) {

        wp_enqueue_script( 'jquery-easing' );
        wp_enqueue_script( 'jquery-smoothness' );

        // jquery-ui-tabs
        wp_enqueue_style( 'jquery-ui-custom' );
        wp_enqueue_script( 'jquery-ui-tabs' );
    }

}
add_action( 'wp_enqueue_scripts', 'ahso_scripts' ); 
```

在 page-home.php 模板上，我们像这样实例化 jQuery Ui 选项卡：

```
<script type="text/javascript">
    //<![CDATA[
    jQuery(document).ready(function() {
        jQuery("#tabs").tabs();
    });
    //]]>
</script>
<!--[if lt IE 9]-->
<script type="text/javascript">
    //<![CDATA[
    jQuery(function() {
        jQuery("#tabs").tabs("option", "disabled", false);
    });
    //]]>
</script>
<!--[endif]--> 
```

标记有点有趣，因为我一直在尝试，没有使用（document）.ready（）作为别名传递'$'，进行故障排除。

由于某种原因，选项卡不会实例化或工作，我们在控制台中没有收到选项卡的错误，当然，某些小部件中发生了很多事情，但是这个问题早在我们添加任何内容之前就出现了那些，

真正让我伤心的是，我们已经在另一个网站上以几乎相同的方式完成了这项工作，而且它确实有效。[http://granthammond.com](http://granthammond.com)

如果您向下看侧边栏的底部，您会看到一些选项卡，唯一的大区别是那些是由简码输出的，而这些是在页面模板中回显的。

再次感谢堆栈。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T16:22:01.660

jQuery UI 选项卡的 javascript 部分正在工作。如果您查看源代码并单击不同的选项卡标题，则会添加正确的 css 类。但是，必要的选项卡样式不包含在您的 jQuery UI 样式表中 =]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T20:03:55.023

当然，你有一个静态的首页？

尝试

```
if ( is_home() OR is_front_page() )
{
    // ... 
```

反而。

# django - 如何获取小数字段以在模板中显示更多小数位？

> ID：12903686
> 
> 赞同：27
> 
> 时间：2012-10-15T20:43:48.793
> 
> 标签：django, django-templates, decimal

```
price_a = models.DecimalField(max_digits=5, decimal_places=3) 
```

示例价格：95,90

在我的模板中：

```
{{ price_a }} 
```

它只显示 95,9。我怎样才能让它显示全价（带有额外的尾随 0：95,90）？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2012-10-15T21:01:20.040

使用[`floatformat`](https://docs.djangoproject.com/en/dev/ref/templates/builtins/#floatformat)模板过滤器，例如

```
{{ price_a|floatformat:2 }} 
```

# ios - 移动到班级时 mp3 播放失败

> ID：12903690
> 
> 赞同：0
> 
> 时间：2012-10-15T20:44:06.160
> 
> 标签：ios, xcode, audio

我在我的应用程序中播放音乐时遇到问题。如果我在 viewcontroller viewDidLoad 中写这个，一切正常。

```
 NSURL *url = [NSURL fileURLWithPath:[NSString stringWithFormat:@"%@/jingle.caf", [[NSBundle mainBundle] resourcePath]]];

NSError *error;
audioPlayer = [[AVAudioPlayer alloc] initWithContentsOfURL:url error:&error];
audioPlayer.numberOfLoops = -1;

if (audioPlayer == nil)
    NSLog([error description]);
else
    [audioPlayer play]; 
```

但是当我把它放到我自己的类中时，在 viewDidLoad 中的同一个 viewController 中实例化它并使用完全相同的代码调用方法，它就不起作用了。请问为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T21:18:34.233

这可能是因为您的实例在 viewDidLoad 方法超出范围后被释放。为 as 创建一个类型为 strong 的属性，看看是否可行。

# c# - 日期元素的文化特定顺序

> ID：12903691
> 
> 赞同：4
> 
> 时间：2012-10-15T20:44:07.783
> 
> 标签：c#, .net

我想为用户显示带有字母的月份和日期。我可以使用`DateTime.ToString("MMMM d");`，但在某些国家/地区，正确的格式是`d MMMMM`.

有没有办法确保订单始终正确？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T20:54:15.033

不，没有办法。只需快速浏览

```
[Globalization.CultureInfo]::GetCultures([Globalization.CultureTypes]::AllCultures) | 
    select @{l='Culture';e={$_.Name}},@{l='Pattern';e={$_.DateTimeFormat.LongDatePattern}} 
```

揭示了许多文化，其中围绕月份名称和日期的内容需要包含在某些内容中，而排除在其他内容中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-15T20:55:07.810

> 有没有办法确保订单始终正确？

好吧，我能想到的最接近的方法是获得正确的“长日期格式”（例如`CultureInfo.CurrentCulture.DateTimeFormat.LongDatePattern`，然后删除您不想要的任何元素。

然而，这将是一个相当脆弱的方法，我建议你对你特别关心的所有文化进行*彻底的测试。*例如，您需要考虑长日期模式不包含“MMMM”的任何文化......或者`en-US`例如，长日期模式使用`dd`而不是`d`. 在这些情况下你想做什么？

然后是整个属格与非属格形式 - 我*怀疑*对于任何重要的文化，长日期格式和您所追求的“月日”格式都会使用相同的形式......但这一切都变得很漂亮老实说，乱七八糟。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-15T20:49:11.973

您可以使用`ToString()`采用 a 的重载`CultureInfo`并使用适当的文化。

例如：

```
var american = new CultureInfo("en-us");
var dateString = new DateTime(2000,1,1).ToString("MMMM d", american); 
```

产生“1 月 1 日”。

[这个问题](https://stackoverflow.com/questions/1487532/tostring0-versus-tostringcultureinfo-invariantculture)的更多信息。

# sublimetext2 - Sublime Text Package Control - 创建一个非常基本的包

> ID：12903692
> 
> 赞同：1
> 
> 时间：2012-10-15T20:44:20.543
> 
> 标签：sublimetext2, typescript

我想在 Sublime Text 2 的[Package Control中创建一个非常简单的 TypeScript 包](http://wbond.net/sublime_packages/package_control/package_developers)

我从未开发过 Sublime Text 扩展/插件，但我只想打包 2 个现有文件

*   TypeScript 语法高亮文件`typescript.tmlanguage`（来自[这里](http://blogs.msdn.com/b/interoperability/archive/2012/10/01/sublime-text-vi-emacs-typescript-enabled.aspx)）
*   TypeScript 构建系统`typescript.sublime-build`（感谢[这个答案](https://stackoverflow.com/a/12781051/239168)）

[根据文档](http://wbond.net/sublime_packages/package_control/package_developers)的第一步是

> **将您的插件托管在 GitHub 或 BitBucket 上自己的存储库中。**
> 仅包含一个插件，并将插件文件放在 repo 的根目录中。

我需要创建一个插件吗？我可以分叉一个简单的基本的吗？（发现很多复杂的）

**编辑：**

找到这个[https://github.com/danro/LESS-sublime](https://github.com/danro/LESS-sublime)

[并根据示例https://github.com/ernation/sublime-text-2-typescript](https://github.com/eranation/sublime-text-2-typescript)创建了这个

就这样？我应该摆脱文件夹吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T18:55:38.383

据我了解（我自己将第一次经历此过程）您的文件夹是包，它是添加到包控件中的内容。

包里面可以有很多不同的东西，构建设置、插件、代码片段、键盘快捷键等等......

所以是的，只要文件夹中的两个文件就足够了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T22:12:24.063

I have not tested your package to see if it works. But what you need to do now is:

1.  a "fork" of sublime package_control_channel repository on this [link](https://github.com/wbond/package_control_channel)

2.  change the repositories.json file according to the [specification](http://wbond.net/sublime_packages/package_control/package_developers) and [this](http://net.tutsplus.com/tutorials/python-tutorials/how-to-create-a-sublime-text-2-plugin/) on Step 12

3.  Make a pull request to Sublime Text 2 package_control_channel repository

If your pull request is accepted it will become part of the official repository of Sublime Text 2.

# java - 简单的Java程序Arraylist

> ID：12903699
> 
> 赞同：0
> 
> 时间：2012-10-15T20:44:54.487
> 
> 标签：java, input, arraylist

我正在尝试制作一个简单的程序来演示对象的 ArrayLists 的使用。我希望能够输入要存储在对象中的详细信息以及搜索和打印对象。

我正在为学生做这件事我有我的学生课程，我已经开始了我的学生测试课程，但我正在寻找输入的帮助。

这是我到目前为止所拥有的：

```
package student;

public class Student {

    private String studentName;
    private String studentNo;
    private String email;
    private int year;

    public Student() {
      /**studentName = null;
        *studentNo = null;
        *email = null;
        *year = -1;
        */
    }

    public Student(String nName, String nNum, String nEmail, int nYr) {
        this.studentName = nName;
        this.studentNo = nNum;
        this.email = nEmail;
        this.year = nYr;
    }

    public void setStudentName(String newStudentName) {
        studentName = newStudentName;
    }

    public void setStudentNo(String newStudentNo) {
        studentNo = newStudentNo;
    }

    public void setEmail(String newEmail) {
        email = newEmail;
    }

    public void setYear(int newYear) {
        year = newYear;
    }

    public String getStudentName() {
        return studentName;
    }

    public String getStudentNo() {
        return studentNo;
    }

    public String getEmail() {
        return email;
    }

    public int getYear() {
        return year;
    }

    }
}

package student;
import java.util.ArrayList;
import java.util.Scanner;

public class studentTest {

    public static void main(String[] args) {

        Scanner input = new Scanner(System.in);

        Student student1 = new Student();
        Student student2 = new Student();
        Student student3 = new Student();
        Student student4 = new Student();
        Student student5 = new Student();

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T20:59:19.850

查看[Scanner](http://docs.oracle.com/javase/7/docs/api/java/util/Scanner.html)的文档。

从您到目前为止所做的代码`studentTest`看来，您正在获取用户的所有输入。

您基本上需要循环输入所有数据：

```
// create ArrayList
for (int i=0; i < 5; i++) {
   String studentName = input.nextLine();
   ....

   Student student = new Student();
   student.setStudentName();
   ...

   // add student to arraylist
} 
```

我认为您将从填写我遗漏的部分中受益。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T21:09:06.330

我认为他只是想填充学生类这样的东西。

```
 while(true){
    Scanner input = new Scanner(System.in);

    Student student1 = new Student();
    int year= input.nextInt();
    String studentName=input.nextLine();
    studentNo=input.nextLine();
    String email=input.nextLine();

    student1.setStudentName(studentName);
    student1.setStudentNo(studentNo);
    student1.setEmail(email);
    student1.setYear(year) 

    int year= input.nextInt();
    String studentName=input.nextLine();
    studentNo=input.nextLine();
    String email=input.nextLine();

      break; // at the last position
      } 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-15T21:00:48.013

您可能需要更新 main 方法，如下所示：

```
public static void main(String[] args) {
    List<Student> students = new ArrayList<Student>();
    Scanner input = new Scanner(System.in);

    System.out.println("Enter number of students");
    int countStudents = input.nextInt();

    for(int i=0; i< countStudents; i++){
          Student student = new Student();
          System.out.println("Enter details for student"+i);

          System.out.println("Enter name");
          student.setStudentName(input.next()); 

          System.out.println("Enter Number");
          student.setStudentNo(input.next()); 

          System.out.println("Enter email");
          student.setEmail(input.next()); 

          System.out.println("Enter year");
          student.setYear(input.nextInt()); 
          students.add(student);
    }
    //Your list of students is populated now
} 
```

# ruby-on-rails-3 - 多态喜爱模型设置中的质量分配错误

> ID：12903703
> 
> 赞同：0
> 
> 时间：2012-10-15T20:45:08.820
> 
> 标签：ruby-on-rails-3, activerecord, rspec, polymorphic-associations, mass-assignment

我正在尝试将收藏添加到我的应用程序中，以便用户可以选择最喜欢的项目。

我尝试使用在这里找到的代码：http: [//snippets.aktagon.com/snippets/588-How-to-implement-favorites-in-Rails-with-polymorphic-associations](http://snippets.aktagon.com/snippets/588-How-to-implement-favorites-in-Rails-with-polymorphic-associations)

这是我目前的情况：

**用户.rb**

```
class User < ActiveRecord::Base
  has_many :projects
  has_many :favourites
  has_many :favourite_projects, :through =>  :favourites, :source => :favourable, :source_type => "Project"
end 
```

**项目.rb**

```
class Project < ActiveRecord::Base
  belongs_to :user
  has_many :tasks
  accepts_nested_attributes_for :tasks
  has_many :favourites, :as => :favourable
  has_many :fans, :through => :favourites, :source => :user
end 
```

**任务.rb**

```
class Task < ActiveRecord::Base
  belongs_to :project
end 
```

**最喜欢的.rb**

```
class Favourite < ActiveRecord::Base
  belongs_to :user
  belongs_to :favourable, :polymorphic => true
  attr_accessible :user, :favourable
end 
```

**favourite_spec.rb**

```
require 'spec_helper'

describe Favourite do
  let(:user) { FactoryGirl.create(:user) }
  let(:project) { FactoryGirl.create(:project_with_task) }
  let(:favourite_project) do
    user.favourite_projects.build(favourable: project.id)
  end

  subject { favourite_project }

  it { should be_valid }

  describe "accessible attributes" do
    it "should not allow access to user_id" do
      expect do
        Favourite.new(user_id: user.id)
      end.to raise_error(ActiveModel::MassAssignmentSecurity::Error)
    end
  end

end 
```

但是，当我运行测试时， user_id 测试通过了，但我得到以下信息`it { should be_valid }`：

```
Failure/Error: user.favourite_projects.build(favourable: project.id)
     ActiveModel::MassAssignmentSecurity::Error:
       Can't mass-assign protected attributes: favourable 
```

我在测试中做错了吗？

还是我打电话的方式`.build`？

还是在`attr_accessible`最喜欢的型号上？

希望有人能帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T18:59:16.240

解决了！

这是必须从问题中显示的文件中更改的文件：

**收藏夹.rb**

```
class Favourite < ActiveRecord::Base
  belongs_to :user
  belongs_to :favourable, :polymorphic => true
  attr_accessible :favourable
end 
```

**favourite_spec.rb**

```
require 'spec_helper'

describe Favourite do
  let(:user) { FactoryGirl.create(:user) }
  let(:project) { FactoryGirl.create(:project_with_task) }
  let(:favourite_project) do
    user.favourites.build(favourable: project)
  end

  subject { favourite_project }

  it { should be_valid }

  describe "accessible attributes" do
    it "should not allow access to user_id" do
      expect do
        Favourite.new(user_id: user.id)
      end.to raise_error(ActiveModel::MassAssignmentSecurity::Error)
    end
    it "should not allow access to user" do
      expect do
        Favourite.new(user: user)
      end.to raise_error(ActiveModel::MassAssignmentSecurity::Error)
    end
  end

end 
```

# javascript - 在 Javascript 中强制执行私有方法是个好主意吗？

> ID：12903706
> 
> 赞同：12
> 
> 时间：2012-10-15T20:45:24.240
> 
> 标签：javascript, oop, methods, styles

我正在与一位开发人员讨论侵入 javascript 私有函数是否有意义。

替代方案是：

1.  包含所有函数的构造函数和原型，非 API 方法（私有）将仅使用下划线命名，`_function_name`以便开发人员知道他们可以调用什么以及不能调用什么。
2.  API 函数的构造函数和原型，以及作为私有函数在私有命名空间中的自由函数，该私有命名空间将它们隐藏在除这个命名空间之外的其余命名空间之外。

我们不考虑其他方法，例如在表单的构造函数中创建私有函数，`var private_var= function(){}`因为这会在每次实例化对象时触发所有这些函数的创建，并且每个对象都有自己的集合。

我们对他们的理由：

1

*   Javascript 本身不支持私有函数，实际上没有私有/受保护/公共可见性的概念，所以这基本上是一个 hack
*   在方法名称中使用下划线清楚地标记给定类/原型的边界是什么，没有必要“强制”它，实际上像 Python 这样的语言没有私有方法，python 用户似乎从来没有关心过它从使用下划线
*   即使 private 被强制执行，在你可以动态替换 public 方法的语言中它有什么意义？
*   影响可读性，相当多，私有函数被分成另一组大括号，它们的作用域，它们不能使用`this`或者需要用`function.call(object)`or调用`function.apply(object)`

2

*   通过封装远离类/原型用户手的私有方法带来了明显的限制
*   它或多或少是行业标准，很多 javascript 开发人员都这样使用它

我们怀疑，因为很多开发人员都在使用它，所以可能还有另一个原因，比如性能等，被这样使用。

由于我们对 Javascript 的了解非常有限，我们决定将其发布在 stackoverflow 中，以了解哪种方法更好以及为什么。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-18T05:09:09.627

您将如何侵入 javascript 私有函数以及出于什么目的？

我认为创建类、私有函数等的不同方法取决于你的动机。

当您尝试进行单元测试并且您真的想分解从外部看起来像一个巨大的方法时，下划线约定会有所帮助。

我觉得在其他任何情况下，您都应该尝试将事情真正保密。如果您试图公开一个漂亮、干净的 API 供其他人使用，他们不需要查看幕后的内容。为什么要曝光？这导致了关于私有和公共的一般讨论：[为什么在面向对象中使用“私有”方法？](https://stackoverflow.com/questions/2620699/why-private-methods-in-the-object-oriented)

您确实有一些私有化方法的选择，其中一些选择会影响性能。

下划线约定：

```
function Pizza() {
   this._pepperoni = function () {};
} 
```

或者

```
function Pizza() {
}

Pizza.prototype._pepperoni = function () {}; 
```

范围界定

```
function Pizza() {
    function pepperoni() {};
} 
```

命名空间/模块

```
var pizza = pizza || {};
(function() {
    function pepperoni() {};
    function create() {
        pepperoni();
    }
    window.pizza.create = create; // or module.export = pizza or both
}()); 
```

模块模式

```
(function(){
    function pepperoni() {};
    function Pizza() {
        pepperoni();
    }

    window.Pizza = Pizza;
}()); 
```

关于重新创建你的函数与定义它们一次。首先，如果您想使用内部私有成员并仍然使用“this”，只需创建一个名为`self`并分配`this`给它的新变量：

```
function Pizza() {
    var self = this;
    function pep() {
       self.x = 1;
    }
} 
```

接下来，我尝试预先测试重新定义和编写函数之间的性能差异：http: [//jsperf.com/private-methods](http://jsperf.com/private-methods)我认为它可以为你节省不到 20% 的 ops/sec 来重新创建你的函数时间。

我不推荐任何方法，它们在不同时间都是有效和有用的。有时更多的是关于语义，有时是关于性能，有时是为了满足单元测试之类的目的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-23T23:19:21.190

*   **这不是 hack**：我认为克服这个想法至关重要。当您使用该语言的核心合法功能 - 闭包 - 来实现隐藏对象细节的目标时，您就不是在进行黑客攻击。

    需要注意的是，当您在基于类的语言中使用 private 时，您只是在实现一个更高级别的概念，即隐藏对象的实现细节。考虑到这一点，我们并没有试图在 javascript 中模仿 private 修饰符，我们只是在实现一个概念，我们如何实现它并不那么相关，并且取决于工具/语言。

    顺便说一句，我来自 C# 背景，当我开始使用 JavaScript 时，我发现很难克服这个“hack”障碍，直到最近，我才考虑过闭包、对象字面量、构造函数、回调函数……我考虑过它们所有黑客。只有当我克服了这种心理障碍时，我才开始欣赏 JavaScript 并编写利用其优势的优秀代码。

*   至于如何隐藏您的“私有”函数，您可以按照您的建议将它们隐藏在命名空间中，或者使用**模块模式** 或其变体之一初始化为变量，这将是我的偏好。你说这意味着这些变量将在每个新实例中重新创建，但这对于基于类的语言中的私有变量是相同的。如果您正在寻找静态的等效项，那么您只需执行 MyClass.StaticVariable = "myStaticVariable" 就可以了。

*   当您可以更改公共 API 时，以动态语言隐藏细节有什么不同？好吧，这让我们回到了我的第一点——以基于类的语言的错误眼光看待 JavaScript——从动态语言的角度来看，想象一下由于动态特性而获得的所有灵活性，我只是在看 Sinon 库它提供了模拟计时器之类的方法（基本上是因为您可以劫持几乎所有东西的公共 api），想象一下在非动态语言中这将是多么困难，了解对模拟框架、IoC 容器、代理生成器、反射的所有需求，您可以使用 JavaScript 这样的动态语言免费获得所有这些。因此，即使您的论点在技术上是正确的，但当放在完整的上下文中时，它就会变得无关紧要。

    同样，当隐藏实现细节时，我们这样做不是为了模仿 C#/Java/C++ 特性，我们这样做是因为首先它是良好的设计和良好的可重用性和维护概念，但其次 - 在我看来同样重要 - 我们这样做是因为它是一种语言模式，这就是它在 JavaScript 中的完成方式。不要低估这一点，您今天编写的代码明天将被其他人阅读，因此遵循通用模式（OO 设计的隐藏细节和封装，以及特定于语言的模式，如模块模式）可以大大改善沟通，这是- 就其本身而言 - 在我看来足以接受它。如果您使用“JavaScript 方式”进行操作，那么您已经与其他团队成员进行了正确的沟通，

*   就可读性而言，您通过遵循模式和通用约定来帮助您的代码读者。如果你去尝试在 C++ 中做同样的事情，那么你只会影响可读性。

*   **做下划线的事情**：约定很好，尤其是在与团队合作时，最大的库之一**jQuery UI**使用了这种约定，它确实有效并使事情变得更清晰。这样做，即使您的变量没有真正隐藏（在 jQuery UI 中，您仍然可以访问和修改带下划线的变量），它为您的代码库带来的清晰度和一致性是无价的。

最后，我一直在提到“以 JavaScript 的方式来做”，但这种说法本身就是骗人的。我认为您提到的问题有一种 JavaScript 方法，但在更大的范围内，特别是在框架和库级别，几乎没有单一的做事方法。但这正是 JavaScript 令人兴奋和美丽的一部分。拥抱它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-08-08T10:31:48.360

是的，这是一个基于误解的坏主意。人们普遍误解 Java、C# 等语言具有强制执行或无法规避的隐私。但实际上这是完全错误的`private`，Java、C# 等中的和其他访问修饰符归结为建议和交流，而不是强制执行。

[马丁·福勒](http://martinfowler.com/bliki/AccessModifier.html#AccessControlDoesNotControlAccess)：

> 访问控制的目的不是阻止访问，而是更多地表明该类更喜欢将某些东西保留给自己。使用访问修饰符，就像编程中的许多事情一样，**主要是关于通信**。

这正是下划线前缀的作用。并且使用下划线前缀，您不会与语言对象模型作斗争。

你不能以任何理由绕过闭包，但这在所有其他语言中都是可能的。具有讽刺意味的是，您所做的只是使 Javascript 成为所有语言中最不灵活的语言。

因为您使用变量而不是对象属性，所以您不能拥有

*   [可枚举](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/propertyIsEnumerable)性、可[写性](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty)、[冻结](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/freeze)性、[密封性](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/seal)和[扩展](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/preventExtensions)性的状态
*   [`getOwnPropertyNames`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/getOwnPropertyNames)通过和反射[`.keys()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/keys)
*   继承和`instanceof`运算符
*   [可以在任何类型的接收器上操作的通用方法](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array#Array_generic_methods)
*   对象模型的任何其他未来扩展

基本上，通过闭包获得的 OOP 功能几乎仅限于将一堆函数组合在一起。这仅适用于最初的玩具示例。而且，如果您坚持认为隐私必须由机器强制执行的常识，那么您甚至无法拥有“包私有”、“受保护”或许多更复杂级别的“访问控制”。

顺便说一句，您还需要为每个实例的每个方法创建唯一的函数对象（因为它们具有可观察的标识）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-18T21:18:06.950

哪种方法更好在很大程度上取决于您要实现的目标。

您的替代方案 1 是开发人员就特定命名约定达成的协议。每当您有一个愿意承诺遵守此协议的开发人员团队并且他们是唯一使用该软件的人时，这种方法会更好。正如您正确指出的那样，这种方法非常好地支持代码的可读性和更重要的可测试性。此外，与替代方案 2 相比，您会发现更多能够理解和维护代码的开发人员。

您的替代方案 2，以及任何使用闭包实现对象的真正私有成员的模式，都不是 hack，而是 javascript 的工作方式。当您确实需要保护对象内部的属性时，这种方法会更好。在向不属于您的团队的开发人员提供一段代码或使其公开可用时，通常会出现这种情况。但是你会失去一些代码的可读性和可测试性，你会发现能够理解和维护代码的开发人员更少。

您这边似乎也对javascript有些困惑。您对 javascript 不（尚未）支持私有属性是正确的。但是 javascript 也不支持“类”作为语言结构，也不支持“类方法”。javascript 中的一切都是（只是）一个对象。类构造函数只是创建对象的一种模式，方法是（只是）“函数”类型的对象的属性。javascript 中的对象**不是**类的实例，就像在传统的面向对象语言中那样。

因此，正如您正确指出的那样，在 javascript 中创建对象后，该对象的每个属性，包括函数属性，也就是方法，都可以更改（封装在闭包中的属性除外）。这是 javascript 的强大功能，但在保护对象不被更改的情况下，这是一个缺点，而不是 javascript（尚未）设计的东西。您将无法阻止用户重写您的对象，但您可以使用闭包使其变得更加困难。

我希望这对您的决定有所帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-18T12:48:07.580

我建议使用 JavaScript 的下一个版本 ES6 中的工具：WeakMap。我已经在 IE8+ 中实现了这一点，并且我已经写过它并广泛使用它。

```
function createStorage(creator){
  creator = creator || Object.create.bind(null, null, {});
  var map = new WeakMap;
  return function storage(o, v){
    if (1 in arguments) {
      map.set(o, v);
    } else {
      v = map.get(o);
      if (v == null) {
        v = creator(o);
        map.set(o, v);
      }
    }
    return v;
  };
}

var _ = createStorage(function(o){ return new Backing(o) });

function Backing(o){
  this.facade = o;
}
Backing.prototype.doesStuff = function(){
  return 'real value';
}

function Facade(){
  _(this);
}
Facade.prototype.doSomething = function doSomething(){
  return _(this).doesStuff();
} 
```

更多信息：

1.  [http://bbenvie.com/articles/2012-07-25/JavaScript-Classes-with-private-protected-and-super](http://bbenvie.com/articles/2012-07-25/JavaScript-Classes-with-private-protected-and-super)
2.  [http://benvie.github.com/WeakMap/](http://benvie.github.com/WeakMap/)
3.  [http://benvie.github.com/harmony-collections/](http://benvie.github.com/harmony-collections/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-15T20:48:29.280

在我工作的地方，推荐的模式是使用“命名空间模式”并像在任何 OO 语言中一样对待命名空间。

[你可以在这个答案](https://stackoverflow.com/a/3411792/598637)中看到

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-15T21:11:54.377

如果您想***阻止***其他开发人员访问这些方法，即使他们知道不应该访问这些方法，我认为私有方法很好。

请阅读这篇 Crockford[文章](http://www.crockford.com/javascript/javascript.html)，特别是关于 OOP 和[私人成员的部分](http://www.crockford.com/javascript/private.html)

希望这有帮助

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-10-15T21:55:45.870

我更喜欢使用显示模块模式。[在这里](http://addyosmani.com/resources/essentialjsdesignpatterns/book/)检查

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-10-18T06:05:35.587

尽管这并不是对天气问题的真正答案，但严格执行私有方法是一个好主意，我只想指出，可以使用闭包来做到这一点。

这基本上是`var foo=function`诀窍，但它不会为对象的每个实例创建一个新函数。这样做的方法是这样的：

```
// Create a closure that we can share with our constructor
var MyConstructor = (function(){

    // Within this closure you can declare private functions
    // and variables:
    var private_function = function () {};
    var private_var = {};        

    // Declare the actual constructor below:
    return function () {

    }
})() 
```

就个人而言，我对此有两种看法。来自一个有很多人同时处理同一组文件的工作环境，我真的很欣赏使东西真正私有的能力，这样代码就不会被试图不正确使用对象的人破坏。

另一方面，来自 Perl 背景的我也很欣赏这样一个事实，即设计该对象的原始程序员并非无所不能，也无法预见未来代码的所有使用方式。有时，在某些极端情况下，您确实需要更改对象的内部结构。这一直是经验丰富的 Perl 程序员公认的标准智慧。

最后，两种方式都有效。**Perl 的 CPAN 存储库中的大多数模块都非常稳定，即使没有真正的**隐私也可以开箱即用。另一方面，我曾参与过人们因此而引入错误的项目。我想这归结为你的团队如何一起工作。如果每个人都尊重编码准则和文化，那么 Perl 风格的“_”技巧就很有效。另一方面，如果您不能相信未来的维护者将如何破坏您的代码，那么更严格地执行隐私可能会更好。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-10-24T05:19:35.733

有几种方法可以解决您的问题，您选择哪一种取决于几个因素，包括 (1) 目标浏览器支持、(2) 项目目标和 (3) 个人偏好。我将重点介绍一些我特别有意见的方法。

## 符号

我首先强调这一点，因为它是最强大的解决方案，它是 JavaScript 的未来：它将包含在即将发布的 ECMAScript 标准版本中。今天，在符合 ES5 的浏览器中使用 shim 是可能的。这意味着它基本上适用于过去 2 年发布的所有 A 级浏览器。主要的缺点是它在 IE 8 中不受支持，但在 IE 9 和 10（当然还有所有现代版本的 FF、Chrome 和 Safari）中都受支持。如果 IE8 对您来说仍然很重要，那么这还不是您的选择。

垫片可以在这里下载：[SymbolsForES5](https://github.com/wnwall/SymbolsForES5)。该库使您可以开始使用此功能，并且当将来浏览器中原生包含符号时​​，您的代码应该能够很好地过渡。

下面是对私有成员使用符号的示例：

```
var x = { };
var a = new Symbol();
x[a] = 5;
console.log(x[a]); // => 5 
```

只要您有权访问`a`Symbol 对象，您就可以从该`x`对象中读取属性，但如果没有访问权限的任何人都`a`无法读取它。这使您可以真正拥有私人成员：

```
var Person = (function() {

    var firstName = new Symbol(),
        lastName = new Symbol();

    function Person(first, last) {
        this[firstName] = first;
        this[lastName] = last;
    }

    Person.prototype.getFullName = function() {
        return this[firstName] + ' ' + this[lastName];
    };

    return Person;

})();

var john = new Person('John', 'Smith');
john.getFullName(); // => 'John Smith'

Object.getOwnPropertyNames(john); // => [ ] 
```

## 使用**DON'T ACCESS**字符

正如您所提到的，您始终可以在属性前面加上一个字符（例如下划线），以表明它不应该被外部代码访问。主要缺点是该物业仍然可以访问。然而，有一些好的好处：**(1)**高效的内存**(2)**使用原型继承的全部能力**(3)**易于使用**(4)**易于调试（因为属性显示在调试器中）**(5)**适用于所有浏览器。

我过去曾广泛使用这种方法并取得了巨大的成功。作为下划线的替代方案，在[我开发的一个框架 (joi)](http://joijs.com/)中，我使用了该`#`符号，因为它使属性更难访问（您必须使用方括号表示法来访问它），作为对任何尝试的人的温和提醒访问它，它真的很可能应该被单独留下：

```
function Person(first, last) {
    this['#firstName'] = first;
    this['#lastName'] = last;
}

Person.prototype.getFullName = function() {
    return this['#firstName'] + ' ' + this['#lastName'];
};

var john = new Person('John', 'Smith');
john.getFullName(); // => 'John Smith' 
```

我已经使用这种技术大约 7 年了，并取得了巨大的成功，如果 Symbols 不适合您的需求，我强烈推荐它。

## 构造函数内部的私有

我知道你说过你决定不使用这种技术是因为内存/性能的原因，但是如果你想要的东西接近真正的私有，并且你不能使用符号，因为你需要旧的浏览器支持，这是一个不错的选择。我工作的公司在大规模应用中使用这个模型，消耗的内存真的不是问题。此外，我听说一些研究发现了在此模型中优化内存和性能的方法，我相信现代浏览器（至少是 V8/Chrome，如果不是其他浏览器）开始实施这些优化。（此信息来自我从 Brendan Eich 那里听到的一次谈话；很抱歉，我不知道是哪次谈话让我一头雾水。）

最后，有专家提倡使用这种技术，虽然这不是我的偏好，但我的公司已经取得了成功，我可以保证它是一个可靠的模型。

为了完整起见，它看起来像这样：

```
function Person(first, last) {
    this.getFullName = function() {
        return first + ' ' + last;
    };
}

var john = new Person('John', 'Smith');
john.getFullName(); // => 'John Smith' 
```

JavaScript 引擎可以通过不为每个`getFullName`方法真正创建一个新函数来优化这一点（即使按照书本，它应该这样做），因为在这种情况下，无法确定它是否每次都实际创建一个新函数对象。棘手的部分是，一旦引入了能够确定每次是否创建新函数对象的代码，引擎就需要切换到实际执行该操作。

## 弱地图

在另一个答案**benvie**（提到 WeakMaps）[http://stackoverflow.com/a/12955077/1662998]。如果需要 IE8 支持并且您希望属性真正模拟私有成员，我也会考虑这种替代方法。

# ruby-on-rails-3 - 来自 EC2 的 Amazon SES 电子邮件 - 超时

> ID：12903707
> 
> 赞同：1
> 
> 时间：2012-10-15T20:45:24.240
> 
> 标签：ruby-on-rails-3, amazon-ec2, actionmailer

我正在使用 Amazon SES 从托管在 Amazon EC2 基础设施上的 Ruby on Rails（版本 3.2.3）应用程序发送电子邮件，并且在发送电子邮件时出现重复超时。

```
Timeout::Error: execution expired 
```

我使用延迟作业队列来执行此操作，并且在成功之前失败了几次（某些电子邮件地址需要多达 4 或 5 次重试）。

我在 Amazon SES 上具有生产访问权限。这些超时发生的任何原因？我是否需要申请取消我的 Amazon EC2 发送限制？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T11:18:23.817

是的，事实证明您需要特别请求删除 EC2 邮件限制才能发送大量电子邮件。即使您使用的是 Amazon SES，也是如此。

```
https://aws-portal.amazon.com/gp/aws/html-forms-controller/contactus/ec2-email-limit-rdns-request 
```

一旦我申请取消这些电子邮件发送限制，他们会在几个小时内回复我，我能够开始顺利发送电子邮件。

# ruby - 如何为 Ruby 设置 Notepad++ 运行命令？

> ID：12903709
> 
> 赞同：5
> 
> 时间：2012-10-15T20:45:39.277
> 
> 标签：ruby, debugging, ide, path, notepad++

我正在尝试设置 Notepad++ IDE，以便当我按 F6 时，我正在编辑的 Ruby 脚本将运行。在搜索互联网后，我发现 `cmd /K ruby "$(FULL_CURRENT_PATH)"` 输入按 F5 时弹出的运行对话框将在命令提示符中运行基本脚本（我使用的是 Windows 7）。

但是，如果我的代码加载任何外部数据，例如 .txt 文件，或者像我在 Gosu 中发现的那样加载任何图像文件，Ruby 会抱怨实际上存在的东西不存在。

我知道我的代码和 Ruby 安装（Ruby 1.9.3）都很好，因为在此之前我一直在使用 FreeRIDE，这是一个我已经厌倦的旧的、有点错误的 IDE，当我按下 F5 时我的代码运行良好那个IDE。

投诉的一些例子如下。

我的文字冒险：

```
C:/Users/Estanislao/Dropbox/Allway Sync/My Important Documents/Text Focused Fold
er/Ruby Scripts/Text Adventure/0.1.0/File Parser/DungeonContentFileParser.rb:8:i
n `initialize': No such file or directory - Example Dungeon Creator File.txt (Er
rno::ENOENT)
        from C:/Users/Estanislao/Dropbox/Allway Sync/My Important Documents/Text
 Focused Folder/Ruby Scripts/Text Adventure/0.1.0/File Parser/DungeonContentFile
Parser.rb:8:in `open'
        from C:/Users/Estanislao/Dropbox/Allway Sync/My Important Documents/Text
 Focused Folder/Ruby Scripts/Text Adventure/0.1.0/File Parser/DungeonContentFile
Parser.rb:8:in `encapsulate_method'
        from C:/Users/Estanislao/Dropbox/Allway Sync/My Important Documents/Text
 Focused Folder/Ruby Scripts/Text Adventure/0.1.0/File Parser/DungeonContentFile
Parser.rb:117:in `sort_room_data_external_method'
        from C:/Users/Estanislao/Dropbox/Allway Sync/My Important Documents/Text
 Focused Folder/Ruby Scripts/Text Adventure/0.1.0/File Parser/DungeonContentFile
Parser.rb:125:in `<main>'

D:\Programming Stuff\Notepad++> 
```

我的 Gosu 程序：

```
C:/Users/Estanislao/Dropbox/Allway Sync/My Important Documents/Text Focused Fold
er/Ruby Scripts/Game Development/Circular Motion.rb:10:in `initialize': Could no
t load image media/Space2.png using either GDI+ or FreeImage: Unknown error (Run
timeError)
        from C:/Users/Estanislao/Dropbox/Allway Sync/My Important Documents/Text
 Focused Folder/Ruby Scripts/Game Development/Circular Motion.rb:10:in `new'
        from C:/Users/Estanislao/Dropbox/Allway Sync/My Important Documents/Text
 Focused Folder/Ruby Scripts/Game Development/Circular Motion.rb:10:in `initiali
ze'
        from C:/Users/Estanislao/Dropbox/Allway Sync/My Important Documents/Text
 Focused Folder/Ruby Scripts/Game Development/Circular Motion.rb:181:in `new'
        from C:/Users/Estanislao/Dropbox/Allway Sync/My Important Documents/Text
 Focused Folder/Ruby Scripts/Game Development/Circular Motion.rb:181:in `<main>'

D:\Programming Stuff\Notepad++> 
```

如果有人可以提供任何帮助，我将不胜感激。

**更新：** knut 的建议让我在每次启动程序时都经过一些不便的杂耍后得到了我想要的东西。有几个问题。使用

```
cmd /K "cd "$(CURRENT_DIRECTORY)" && ruby "$(FULL_CURRENT_PATH)"" 
```

在默认运行对话框中不起作用。（我收到与上述相同的投诉。）但是使用 NppExec 和

```
cd "$(CURRENT_DIRECTORY)"
ruby "$(FULL_CURRENT_PATH)" 
```

因为这很好用，除了我的 Gosu 代码，它应该绘制一个窗口并为一些图像设置动画，没有任何反应。但是，如果每次启动 Notepad++ 时，我都会运行 NppExec，然后使用默认的运行对话框，使用该会话的内置运行命令一切正常。关于为什么会发生这一切以及如何防止它的任何想法？此外，我更喜欢让 Notepad++ 打开一个命令提示符窗口，而不是像在 NppExec 中那样在 Notepad++ 内部运行。谢谢！

**Update2：**似乎重新启动我的计算机已经解决了问题，但现在我对实际发生的事情更加困惑。是 NppExec 插件实际上允许事情按我的意愿工作，即使我使用保存的脚本作为默认运行对话框？或者这是一个错误，保持

```
cmd /K "cd "$(CURRENT_DIRECTORY)" && ruby "$(FULL_CURRENT_PATH)"" 
```

从工作直到我重新开始？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-15T21:26:01.693

你的问题：有

```
cmd /K ruby "$(FULL_CURRENT_PATH)" 
```

您在实际目录中调用 ruby​​-script - 实际目录不能是您的源目录。在我的测试用例中，它是 Notepad++ 的目录。

您可以使用：

```
cmd /K "cd "$(CURRENT_DIRECTORY)" && ruby "$(FULL_CURRENT_PATH)"" 
```

但我建议使用 NppExec-Plugin。使用 NppExec，您可以定义如下命令：

```
cd "$(CURRENT_DIRECTORY)"
ruby "$(FULL_CURRENT_PATH)" 
```

所以你在正确的目录中启动你的 ruby​​ 脚本。

或者更简单：

您设置选项`Plugins->nppexec >follow $(current directory)`并启动 NppExec

```
ruby "$(FULL_CURRENT_PATH)" 
```

* * *

也许也很有趣：

*   [http://docs.notepad-plus-plus.org/index.php?title=Compiling_Source_Code](http://docs.notepad-plus-plus.org/index.php?title=Compiling_Source_Code)

# php - 远程云计算机上的会话

> ID：12903710
> 
> 赞同：0
> 
> 时间：2012-10-15T20:45:41.900
> 
> 标签：php, curl, cloud

我正在一个名为 kodingen 的云平台上编程。我即将举行一场投资比赛，我正在制定一个方程式/算法来自动为我交易。我要做到这一点的方式（记住交易网站在 php/html 中）是通过使用 PHP 的 curl 扩展将数据发布到网站。我希望该功能每 10 分钟更新一次，并将购买/出售命令发布到网站。不包括更新功能。为什么这不起作用，它是否与会话和 cookie 无法存储在云计算机上有关。

```
function post_to_url($url, $data) {
$fields = '';
foreach($data as $key => $value) { 
   $fields .= $key . '=' . $value . '&'; 
}
rtrim($fields, '&');

$post = curl_init();

curl_setopt($post, CURLOPT_URL, $url);
curl_setopt($post, CURLOPT_POST, count($data));
curl_setopt($post, CURLOPT_POSTFIELDS, $fields);
curl_setopt($post, CURLOPT_RETURNTRANSFER, 1);

$result = curl_exec($post);

curl_close($post);
}

 $data1 = array(
 "ifs-note" => "",
 "submitted" => 1,
 "confirmed" => 0,
 "ifs-quantity" => 100,
 "ticker" => "ADM:LN"
);
$data = array(
"loginsubmitted" => 1,
 "team-name" => "xxxxxxxxx",
"team-password" => "xxxxxxxxxx"
); 
$data2 = array(
"ifs-note" => "",
"submitted" => 0,
"confirmed" => 1,
"dis_ifs-quantity" => 100,
"ticker" => "ADM:LN",
"ifs-cost" => "1139.595"
);

post_to_url("https://www.studentinvestor.org/secure/login.php", $data);
post_to_url("http://www.studentinvestor.org/stock-buy.php", $data1);
post_to_url("http://www.studentinvestor.org/stock-buy.php", $data2);
echo $_SERVER['SERVER_NAME'];
var_dump($_SESSION); 
```

我试过在数字周围加引号和不加引号。有没有更好的解决方案来完成整个过程，例如在远程计算机上使用 python 脚本进行 ssh？谢谢大家

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T21:40:49.227

默认情况下，cURL 不存储 cookie，这可能会使您在请求之间退出站点。

检查 PHP 中 cURL 的 COOKIE* 选项

```
curl_setopt($ch, CURLOPT_COOKIEJAR, $cookieFile);
curl_setopt($ch, CURLOPT_COOKIEFILE, $cookieFile); 
```

# javascript - TinyMCE 对齐标签

> ID：12903712
> 
> 赞同：2
> 
> 时间：2012-10-15T20:45:47.610
> 
> 标签：javascript, tinymce, alignment

我正在从很旧的 TinyMCE 版本升级到最新版本。在旧的 TinyMCE 中，每当您插入图像并左对齐时，生成的 HTML 将具有以下效果：

```
< img src="testing.jpg" align="left" > 
```

然而在新版本的 TinyMCE 中，它改为：

```
< img src="testing.jpg" style="float: left" > 
```

不幸的是，当这个 HTML 在 Outlook 中呈现时，它不能正确显示。关于如何在无需修改任何核心 TinyMCE 代码的情况下解决此问题的任何想法？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:54:00.610

当你调用 init 时，你可以像这样传递一个格式选项：

```
formats : {
            alignleft : {attributes : {align : "left"}}
          } 
```

看看这是否适合你。更多关于[这里的文档](http://www.tinymce.com/wiki.php/Configuration%3aformats)

编辑：显然，您还需要使用选择器来指定这些规则应适用于哪些元素：

```
alignleft : {selector : 'img', attributes :{align : "left"} } 
```

[你可以在这里](http://fiddle.tinymce.com/7ncaab)看到一个工作小提琴

# php - 如何通过 PHP 处理 Sedna

> ID：12903714
> 
> 赞同：0
> 
> 时间：2012-10-15T20:45:50.060
> 
> 标签：php, mysql, xquery, nativexml, sedna

我在使用 mySQL 数据库的 PHP 上工作了几年。

但是现在我有一个家庭作业是使用 PHP 将 Sedna Native XML Database 作为 DBMS 工作，我去了 Sedna 主页并下载了 Sedna 并尝试通过命令行对其进行处理，这一切都进行得非常好..

我下载了 PHP 驱动程序，但我不知道我能用它做什么，我也没有在 Sedna 网站或互联网上找到任何解释如何通过 PHP 处理 Sedna 的文档！

我想知道如何通过 PHP 处理 Sedna，就像我如何通过 PHP 处理 mySQL 一样。

提前谢谢.. Louay

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-28T19:51:07.350

Sedna PHP API 包包括完整的文档。见`doc/php-api.pdf`文件。它描述了如何在 Windows/Linux 上安装 API 并描述了每个可用的方法。包还包含各种示例（`examples`文件夹）。

如果您有一些具体问题，请提供详细信息。

# java - 按顺序显示/加载 gui 框架

> ID：12903717
> 
> 赞同：1
> 
> 时间：2012-10-15T20:46:14.693
> 
> 标签：java, swing, user-interface, windowbuilder

我使用 windowbuilder 创建了 3 个 GUI 框架，以按此顺序加载和显示。

*   第一个 GUI (Home.java)
*   第二个图形用户界面和第三个图形用户界面（Results1.java，Results2.java）

显然 Home.java 可以首先加载，但 2 个正在进行的 GUI 与 Home.java 同时加载。我可以验证它，因为我在初始化 GUI 元素的方法中插入了打印语法。在 Home.java 上按下按钮后，我可以显示最后 2 个 GUI，但内容已经加载。因此，当我需要将变量传递给这 2 个 GUI 时，值变为空。有任何想法吗？

按下 Home.Java 按钮。

```
//Compare Button
            btnCompare.addActionListener(
                        new ActionListener() {
                        public void actionPerformed(ActionEvent e) {

                            if(lbl_filecontainer1.getText() != "No File" && lbl_filecontainer2.getText() != "No File")
                            {

                                    r1.setFileName1(lbl_filecontainer1.getText());
                                    r1.Launch();
                            }
                            else if (lbl_filecontainer1.getText() == "No File" && lbl_filecontainer2.getText() != "No File")
                            {
                                JOptionPane.showMessageDialog(null, "No file 1 selected");
                            }
                            else if (lbl_filecontainer1.getText() != "No File" && lbl_filecontainer2.getText() == "No File")
                            {
                                JOptionPane.showMessageDialog(null, "No file 2 selected");
                            }
                            else
                                JOptionPane.showMessageDialog(null, "No files selected");
                            }

                      }
                    ); 
```

结果1.java

```
public class Results1 {

private JFrame frmFileOverall;
String FileName1;

//Instances
Database db = new Database();

/**
 * Launch the application.
 */
public void Launch(String FileName) {
            try {
               setFileName1(FileName);
                Results1 window = new Results1();
                window.frmFileOverall.setVisible(true);
            } catch (Exception e) {
                e.printStackTrace();
            }

}

/**
 * Create the application.
 */
public Results1() {
    initialize();
}

/**
 * Initialize the contents of the frame.
 */
private void initialize() {
    frmFileOverall = new JFrame();
    frmFileOverall.setResizable(false);
    frmFileOverall.setTitle("File 1 overall result");
    frmFileOverall.setBounds(100, 100, 550, 450);

    JLabel lblNewLabel = new JLabel("Number of words: ");
    lblNewLabel.setFont(new Font("Verdana", Font.BOLD, 11));

    JLabel lblNumberOfSentences = new JLabel("Number of sentences: ");
    lblNumberOfSentences.setFont(new Font("Verdana", Font.BOLD, 11));

    JLabel label_1 = new JLabel("Number of paragraphs: ");
    label_1.setFont(new Font("Verdana", Font.BOLD, 11));

    JTextArea txtAreaFile1 = new JTextArea();
    txtAreaFile1.setEditable(false);

    JLabel wordsContainerFile1 = new JLabel("New label");

    JLabel sentencesContainerFile1 = new JLabel("New label");

    JLabel paragraphsContainerFile1 = new JLabel("New label");
    GroupLayout groupLayout = new GroupLayout(frmFileOverall.getContentPane());
    groupLayout.setHorizontalGroup(
        groupLayout.createParallelGroup(Alignment.LEADING)
            .addGroup(groupLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(groupLayout.createParallelGroup(Alignment.LEADING)
                    .addComponent(txtAreaFile1, GroupLayout.DEFAULT_SIZE, 514, Short.MAX_VALUE)
                    .addGroup(groupLayout.createSequentialGroup()
                        .addComponent(lblNewLabel, GroupLayout.PREFERRED_SIZE, 124, GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(ComponentPlacement.RELATED)
                        .addComponent(wordsContainerFile1))
                    .addGroup(groupLayout.createSequentialGroup()
                        .addGroup(groupLayout.createParallelGroup(Alignment.LEADING)
                            .addComponent(label_1)
                            .addComponent(lblNumberOfSentences, GroupLayout.PREFERRED_SIZE, 151, GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(ComponentPlacement.RELATED)
                        .addGroup(groupLayout.createParallelGroup(Alignment.LEADING)
                            .addComponent(paragraphsContainerFile1)
                            .addComponent(sentencesContainerFile1))))
                .addContainerGap())
    );
    groupLayout.setVerticalGroup(
        groupLayout.createParallelGroup(Alignment.LEADING)
            .addGroup(groupLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(groupLayout.createParallelGroup(Alignment.BASELINE)
                    .addComponent(lblNewLabel)
                    .addComponent(wordsContainerFile1))
                .addPreferredGap(ComponentPlacement.RELATED)
                .addGroup(groupLayout.createParallelGroup(Alignment.BASELINE)
                    .addComponent(lblNumberOfSentences)
                    .addComponent(sentencesContainerFile1))
                .addPreferredGap(ComponentPlacement.RELATED)
                .addGroup(groupLayout.createParallelGroup(Alignment.BASELINE)
                    .addComponent(label_1)
                    .addComponent(paragraphsContainerFile1))
                .addPreferredGap(ComponentPlacement.RELATED)
                .addComponent(txtAreaFile1, GroupLayout.DEFAULT_SIZE, 322, Short.MAX_VALUE)
                .addContainerGap())
    );
    frmFileOverall.getContentPane().setLayout(groupLayout);
    System.out.print(getFileName1());
    //txtAreaFile1.setText(db.loadFile(getFileName()));
}

public void setFileName1(String fileName)
{
    this.FileName1 = fileName;
}

public String getFileName1()
{
    return this.FileName1;
}

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T20:55:54.443

与其只是在按钮按下时显示一个已经创建的结果 GUI，为什么不只是在按下按钮时才创建结果 GUI，即从 Home JButton 的 ActionListener 调用结果创建代码？所以再次总结一下，关键似乎是您何时以及如何*创建*结果 GUI，并且您似乎在程序启动时执行此操作，此时您应该响应用户的事件而执行此操作。

请注意，这里的许多人（包括我自己）会建议不要向用户拍摄不同的窗口，而是只使用一个 JFrame 作为 GUI 的视图，并使用[CardLayout](http://docs.oracle.com/javase/tutorial/uiswing/layout/card.html)更改此视图中的 JPanel 。此外，这里的许多人会建议在使用诸如 Window Builder 之类的代码生成工具之前先手动学习编写 Swing GUI 的代码。这样，如果您以后使用它们，您将更好地了解代码生成工具在幕后所做的事情，并使使用它们*变得*更加容易。

* * *

**编辑 1**
注意，我不确定你的意思是：

> 已经尝试使用普通类创建 gui。仍然遇到同样的问题。

“使用普通类创建 gui”是什么意思？都是普通班。

* * *

**编辑 2**
您的代码有点精神分裂，因为您有一个 Results1 对象创建一个***新***的Results1 对象，这就是您搞砸的地方。我们称第一个 Results1 对象为 r1A，第二个为 r1B。正如我所看到的，这就是正在发生的事情：

*   r1A 是在用户与 GUI 交互之前在程序创建时创建的。
*   当用户在您的“主页”GUI 中按下 JButton 时，...
*   r1A 从用户那里获取信息并使用它来设置一个名为 fileName 的字符串。
*   r1A 还创建了一个新的 Results1 对象 r1B。这个新对象不知道文件名字符串。
*   然后，r1A 告诉 r1B 显示一个 JFrame，frmFileOverall，它再次不知道对 r1A 的文件名字符串所做的任何更改。

我的建议：

*   创建一个且只有 1 个 Results1 对象，
*   不是在你正在做的程序创建时，而是在 ActionListener 代码中按下按钮时再次这样做。
*   给 Results1 一个构造函数 String 参数，这样您就可以将 fileName 传递给它的*构造函数*。
*   同样，不要让 Results1 创建另一个 Results1 对象。
*   同样，暂时避免使用任何窗口构建器软件并阅读 Java Swing 教程，因为如果您可以先手动进行此编码，所有这些将成为您的第二天性。

* * *

**编辑 3**
关于您的代码：

```
if(lbl_filecontainer1.getText() != "No File" && 
    lbl_filecontainer2.getText() != "No File") {
    // .... 
```

您不想使用`!=`or比较字符串，`==`因为这将检查一个 String*对象*是否与另一个 String*对象*相同，这可能会导致误导性结果。相反，您想知道两个 String 对象是否包含相同的文本，为此您需要使用 String 方法`equals(...)`或`equalsIgnoreCase(...)`：

```
if(!"No File".equalsIgnoreCase(lbl_filecontainer1.getText()) && 
    !"No File".equalsIgnoreCase(lbl_filecontainer2.getText())) {
    // .... 
```

# c++ - 在x64 linux上，在多线程中分配后c ++链表缺少节点；为什么？

> ID：12903721
> 
> 赞同：0
> 
> 时间：2012-10-15T20:46:38.510
> 
> 标签：c++, linked-list, dynamic-memory-allocation

我已经包含了一个源代码，您可以自己编译并查看问题。使用 g++ -lpthread list-memchk.cpp -o list-memchk 编译

运行这个，例如，./list-memchk 43000000 30000000 10

我包括三个文件，第一个，

列表-memchk.cpp

```
#include <cstdlib>
#include <iostream>
#include <pthread.h>

using namespace std;

 struct node
{
    public :
          unsigned int part1; // 4 bytes
          unsigned int part2; // 4 bytes
          node *next;         //pointer, 8 bytes on 64 bit system
      unsigned int read_part1();
 };

struct LinkedList
 {
     public:
     LinkedList();
          void insert(unsigned int data[], unsigned int data1);
          bool isEmpty() const;
          node* head;
 };

unsigned int node::read_part1() {
return part1;
}
 LinkedList::LinkedList():
 head(NULL)
{
}

bool LinkedList::isEmpty() const
{
  return (head == NULL);
}

  void LinkedList::insert(unsigned int data[], unsigned int data1)
 {

    node* oldHead = head;
    node* newHead = new node();
    newHead->part1 = data[0];
    newHead->part2 = data1;
    newHead->next = oldHead;
    head = newHead;

  }

unsigned int allocations = 300000000;
unsigned int index_size = 430000000;//index of lists, 430m,.
pthread_mutex_t mutex;
                    //will be creatad on heap
    LinkedList *list = NULL;

unsigned long node_count() {

 unsigned long numNodes = 0;

for (int i=0; i<index_size; i++)
{

  node* current = list[i].head;

// if root is null, the number of nodes is 0
if(current != NULL) {

// if root is not null, we have at least one node
    numNodes++;

// count all nodes
while(current->next != NULL) {
numNodes++;
current = current->next;
}

}

}

return numNodes;

}

#include "alloc_threads.cpp"

void start_threads(int thread_count) {

alloc_threads alloc_thr[thread_count];//thread objects
pthread_t threads[thread_count];

pthread_mutex_init(&mutex, NULL);

for (int i=0; i<thread_count; i++)
{

alloc_threads *rr;

rr = new alloc_threads(list, mutex, allocations);
alloc_thr[i] = *rr;

pthread_create(&threads[i], NULL, &alloc_threads::allocation_helper,&alloc_thr[i]);

delete rr;
}

for (int i=0; i<thread_count; i++)
pthread_join( threads[i], NULL);

}

int main(int argc, char *argv[])

{
if ( argc < 4 )
{
std::cout << "Missing paramaters. " << endl;
std::cout << "Please run me like this : <list-memchk> <index_size> <allocations_per_thread> <thread_count>" << endl;
return 1;
}

index_size = strtoul(argv[1], 0, 10);
allocations = strtoul(argv[2], 0, 10);
unsigned int thr_cnt = strtoul(argv[3], 0, 10);

LinkedList list_instance;

cout << "1 LinkedList instance takes [" << sizeof(list_instance) << "] bytes in memory!"<< endl;

node node_instance;

cout << "1 node instance takes [" << sizeof(node_instance) <<"] bytes in memory !"<< endl;

list = new (nothrow) LinkedList[index_size];
    if (!list)
    {
        cout << "Error allocating memory" << endl;
        return 1;
    }

unsigned int some_data[] = {00, 01};
unsigned int index;

cout << "Allocating ..." << endl;
start_threads(thr_cnt);

unsigned long sk = ((allocations * sizeof(node_instance) + index_size*sizeof(list_instance))) / (1024*1024*1024);

cout << "This process *should* consume around " << sk <<" GBytes of memory, but does it ?"<< endl;

cout << "Allocating done, *check the process size* ..." << endl;

cout << "Lets count `nodes` to see how many do we have; counting, please wait ..." << endl;

cout << "We have reached [" << node_count() << "] nodes, expected [" << allocations * thr_cnt << "] nodes. You may press any number key to exit." << endl;

string s;
getline(std::cin, s);

return 0;
} 
```

然后，alloc_threads.cpp

```
#include "alloc_threads.h"
using namespace std;

alloc_threads::alloc_threads()
{
}

 void *alloc_threads::allocation_helper(void *context)
    {
        return ((alloc_threads *)context)->allocation();
    }

 alloc_threads::alloc_threads(LinkedList* x_list, pthread_mutex_t x_mutex, unsigned int x_allocations)

{
        list = x_list;
        mutex = x_mutex;
        allocations = x_allocations;
}

void * alloc_threads::allocation(void)
{

cout << "Thread started" << endl;
unsigned int some_data[] = {00, 01};
unsigned int index;
unsigned short inde;

LinkedList *list_instance2 = NULL;
for (int i=0; i<allocations; i++)
{

pthread_mutex_lock(&mutex);

index = rand();
inde = (unsigned short)index;
list_instance2 = &list[inde];

list_instance2->insert(some_data, some_data[1]);

pthread_mutex_unlock(&mutex);
}

cout << "Thread finished" << endl;
return 0;
}

alloc_threads::~alloc_threads()
{
} 
```

最后，alloc_threads.h

```
class alloc_threads{
public:
    void *allocation(void);
    static void *allocation_helper(void *context);
    alloc_threads();
    alloc_threads(LinkedList *x_list, pthread_mutex_t x_mutex, unsigned int x_allocations);
    ~alloc_threads();
private:    
       pthread_mutex_t mutex;
       LinkedList* list;
       unsigned int allocations;

}; 
```

代码本身根本没有注释，但希望它不是那么难理解。我所做的是，我在多个并发线程中使用标准分配器分配内存，例如，10 个。在所有线程中完成分配后，我访问每个节点并`numNodes`在成功访问时递增。我通常得到的是`numNodes`价值比预期小几个/几百或几千。怎么了 ？并且，我使用两个不同的分配器完成了此操作，它们都具有相同的行为。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T04:54:16.790

看来，我以错误的方式使用互斥锁 - 它不会阻止并发线程写入同一内​​存。

我`solution`发现，是：在 list-memchk.cpp 中定义互斥变量并避免将其传递给线程但使用它`as is`。

list-memchk.cpp ：用这个替换互斥锁定义，

```
pthread_mutex_t mutex = PTHREAD_MUTEX_INITIALIZER ; 
```

消除

```
pthread_mutex_init(&mutex, NULL); 
```

alloc_threads.h ：从此文件中删除互斥锁；

alloc_threads.cpp ：删除`mutex = x_mutex;`

而已。不再缺少节点。但是，分配速度很惨。看起来线程正在互相等待解锁互斥锁；cpu 核心处于空闲状态，分配需要大量时间。

# c++ - 默认参数必须在编译时绑定 - 为什么？

> ID：12903724
> 
> 赞同：4
> 
> 时间：2012-10-15T20:46:53.880
> 
> 标签：c++, compilation, default-value

为什么 C++ 是这样设计的？...

（这个问题不同，但密切相关

[不可能：此指针作为默认参数。为什么？](https://stackoverflow.com/questions/12828216/not-possible-this-pointer-as-a-default-argument-why))

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-15T20:50:00.460

实际上，这并不完全准确。限制是：

### 8.3.6 默认参数 [dcl.fct.default]

> 7) 局部变量不得在默认参数中使用。[ 例子：

```
void f() {
int i;
extern void g(int x = i); //error
// ...
} 
```

> —结束示例]
> 
> 8) 关键字`this`不得用于成员函数的默认参数。[ 例子：

```
class A {
void f(A* p = this) { } // error
}; 
```

因此，`this`局部变量不能用作默认值。

例如，以下是有效的：

```
int a = 1;
int f(int);
int g(int x = f(a)); // default argument: f(::a)
void h() {
  a = 2;
  {
    int a = 3;
    g(); // g(f(::a))
  }
} 
```

`g`将使用 value 调用`f(2)`，这不是编译时常量。这是直接来自标准的示例。

出现这种情况的原因很常见：要么没有提案，要么被拒绝，被认为没有必要或太难实施。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T20:57:03.397

默认参数是要在函数体中使用的参数的值。该变量（即参数）的值可能会被覆盖，具体取决于函数的调用方式。但是虽然它不是 - 默认参数是这个变量的**值**- 并且必须定义一个值。如果这个值必须是动态的——在编译期间不被绑定——那么也许应该更好地使用一个单独的函数来计算该值并且似乎不适合`default`竞技场。同样对于这种情况，C++ 已经有了正确的机制——`Polymorphism`通过函数重载。

考虑一下：您需要`Fn`使用参数调用函数，`v`否则它应该默认为`Fn(x)`这里两者`v`并且`x`都是变量。

无需使用默认参数，这可以使用函数重载轻松实现。

```
BOOL x;

VOID Fn(BOOL v)
{
     ...
}

VOID Fn()
{
    Fn(::x);
}

VOID Main()
{
    ::x = ...; // Variable x's value is altered

    Fn(FALSE);
    Fn();      // Param value defaults to value of x
} 
```

这迫使程序员编写更好的代码，从长远来看这可能是值得的。

# jquery - 隐藏、显示、隐藏/显示按钮

> ID：12903725
> 
> 赞同：6
> 
> 时间：2012-10-15T20:46:54.380
> 
> 标签：jquery

***继承人的代码：http:*** [//jsfiddle.net/t2nite/KCY8g/](http://jsfiddle.net/t2nite/KCY8g/)

我正在使用 jquery 创建这些隐藏框。

每个框都有一些文本和一个**“显示”**和**“隐藏”**按钮。我正在尝试创建一个**“全部显示/隐藏”**按钮。

但是当我尝试底部的代码时，整个按钮消失了。

```
$("#btn").toggle(function() {
   $(".para2, .para3, .para4").hide(200);
   $(".para2, .para3, .para4").show(200);
}); 
```

这是我能得到的最接近我想要的东西。

```
$("#btn").click(function() {
   $(".para2, .para3, .para4").toggle(200);
}); 
```

上面的代码有效，但不是隐藏或显示所有框，而是在隐藏和显示之间切换它们。帮助。

我只想隐藏内容，并且按钮不在 para 类中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:51:28.690

您需要遍历每个元素以检查它们是否隐藏。这实际上取决于您是要先将它们全部隐藏还是全部显示。这是您需要的：

```
// To toggle each element's state
$("#btn").click(function() {
   $(".para2, .para3, .para4").each(function (index, element) {
       if ($(this).is(':visible')) {
           $(this).hide(200);
       } else {
           $(this).show(200);
       }
   });
});

// To show all and hide all afterwards or vice-versa (change the attr check)
$("#btn").click(function() {
   if ($(this).attr('data-show')) {
       $(".para2, .para3, .para4").show(200);
       $(this).attr('data-show', false);
   } else {
       $(".para2, .para3, .para4").hide(200);
       $(this).attr('data-show', true);
   }
});

// To hide all if one is shown
$("#btn").click(function() {
   var oneShown = false;
   $(".para2, .para3, .para4").each(function (index, element) {
       if ($(this).is(':visible')) {
           oneShown = true;
       }
   });
   if (oneShown) {
       $(".para2, .para3, .para4").hide(200);
   } else {
       $(".para2, .para3, .para4").show(200);
   }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T21:03:34.260

你所有的代码都可以在这里浓缩成三个事件。试试这个方法。。

```
$("#btn").toggle(function() {
    $(".para2, .para3, .para4").hide(200);
}, function() {
    $(".para2, .para3, .para4").show(200);
});

$("[id^='hide']").click(function() {
    $(this).closest('div').find('p').hide(200);
});

$("[id^='show']").click(function() {
   $(this).closest('div').find('p').show(200);
    $('.itsawrap').not($(this).closest('div')).find('p').hide(200);
}); 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/KCY8g/6/)**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T20:52:55.770

您想在**事件**中使用两个回调：[`.toggle`](http://api.jquery.com/toggle-event/)

 **```
$("#btn").toggle(function() {
   $(".para2, .para3, .para4").hide(200);
}, function() {
   $(".para2, .para3, .para4").show(200);
}); 
```

小提琴：http: [//jsfiddle.net/gromer/CDEMS/](http://jsfiddle.net/gromer/CDEMS/)

我假设这就是你试图切换的样子？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-15T20:54:25.973

我想你需要的是这样的：

```
$("#btn").data('tgl','hide').click(function() {
   if ($(this).data('tgl') == 'hide') {
      $(".para2, .para3, .para4").hide(200);
      $(this).data('tgl','show');
   } else {
      $(".para2, .para3, .para4").show(200);
      $(this).data('tgl','hide');
   }
}); 
```

查看工作[**演示**](http://jsfiddle.net/gnel/KCY8g/4/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-15T20:55:58.097

我进行了一些更改以使用类而不是具有特定 ID 的元素，因此您可以使这种行为基于行为（因此需要更少的代码，并且更容易添加或删除`itsawrap`元素）。

HTML：

```
<div id="showall"><button id="btn">HIDE/SHOW ALL</button></div>

<div class="itsawrap">
    <button class="hide">HIDE</button>
    <button class="show">SHOW</button>
    <p class="para2">"Who you callin' pinhead?"</p>
    <p id="btm" class="para2">- Patrick Star</p>
</div>

<div class="itsawrap">
    <button class="hide">HIDE</button>
    <button class="show">SHOW</button>
    <p class="para3">"He was a good man, what a rotten way to die."</p>
    <p id="btm" class="para3">- JC Denton</p>
</div>

<div class="itsawrap">
    <button class="hide">HIDE</button>
    <button class="show">SHOW</button>
    <p class="para4">"Wooooooooo!!"</p>
    <p id="btm" class="para4">- Ric Flair</p>
</div> 
```

JS：

```
$("#btn")
    .data('shown', true)
    .click(function() {
    var mode = $(this).data('shown') ? 'hide' : 'show';
    $('.itsawrap p')[mode](200);
    $(this).data('shown', mode == 'show');
});

$('.itsawrap').on('click', '.hide', function() {
    $(this).parent().find('p').hide(200);
}).on('click', '.show', function() {
    $(this).parent().find('p').show(200);
}); 
```

[jsFiddle](http://jsfiddle.net/TsUDV/1/)**

# sql - 表 A 引用表 B，如何插入（使用 Perl 和 DBI 和 PostgreSQL）

> ID：12903728
> 
> 赞同：1
> 
> 时间：2012-10-15T20:47:10.417
> 
> 标签：sql, postgresql, insert, foreign-keys, dbi

考虑表 A 引用表 B 的情况：

```
create table tableA
(
   id INT NOT NULL PRIMARY KEY,
   information VARCHAR(32)
);
create table tableB
(
   id INT NOT NULL PRIMARY KEY,
   tableAid INT NOT NULL REFERENCES tableA(id),
   other_information VARCHAR(32)
): 
```

请注意，我正在用 Perl 编写代码，并且数据库是 PostgreSQL。

因此，我有 2`tableB`个条目与单个`tableA`条目相关联。我想说的是：

```
use DBI;
my $dbh = DBI->connect("DBI:Pg:dbname=mydb;host=localhost","userid","password",('RaiseError' -> 1));

my $otherinfo = "other info, Table B";
my $moreotherinfo = "more other info, table B";
my info = "table A info";
my $insertitA = $dbh->prepare("insert into tableA (information) values (?)");
my $insertitB = $dbh->prepare("insert into tableB (tableAid,other_information) values (?,?)");
my $nrowsA = $insertitA($info);
my $tableAidreference = ????;
my $nrowsB = $insertitB($tableAidreference, $otherinfo);
my $nrowsB2 = $insertitB($tableAidreference, $moreotherinfo); 
```

我在哪里得到`$tableAidreference`？我必须搜索`tableA`它吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T03:13:41.333

`nextval('seq_name')`为了后续的目的而单独调用的方法`INSERT`已经过时并且效率非常低。它需要到服务器的额外往返。不要使用这个。有更好的选择：

[**-> sqlfiddle**](http://sqlfiddle.com/#!12/b4632/1)

首先，我修改了您的测试设置：

```
CREATE TABLE tbl_a
(  tbl_a_id serial NOT NULL PRIMARY KEY,
   information text
);
CREATE TABLE tbl_b
(  tbl_b_id serial NOT NULL PRIMARY KEY,
   tbl_a_id int NOT NULL REFERENCES tbl_a(tbl_a_id),
   other_information text
); 
```

*   不要`id`用作列名，它不是描述性的。一些不太聪明的 ORM 会这样做，这是一种反模式。

*   如果可以避免，请勿在 PostgreSQL 中使用混合大小写标识符。

*   使用[`serial`](http://www.postgresql.org/docs/current/interactive/datatype-numeric.html#DATATYPE-SERIAL)代理主键的类型。

然后，使用命令的子句在一个[**数据修改 CTE**](http://www.postgresql.org/docs/current/interactive/queries-with.html#QUERIES-WITH-MODIFYING)（需要 PostgreSQL 9.1 或更高版本）中完成所有操作：`RETURNING`[`INSERT`](http://www.postgresql.org/docs/current/interactive/sql-insert.html)

```
WITH x AS (
    INSERT INTO tbl_a (information)
    VALUES ('foo')
    RETURNING tbl_a_id
    )
INSERT INTO tbl_b (tbl_a_id, other_information)
SELECT tbl_a_id, 'bar'
FROM   x
RETURNING tbl_a_id, tbl_b_id; -- optional, if you want IDs back 
```

**往返服务器一次，如果您愿意，您可以取回两个新 ID - 而不是**三个****往返**。**

 *** * *

### 如何将它与 DBI 一起使用？

使用 DBD::Pg 模块：

```
$SQL = q{ WITH x AS (
    INSERT INTO tbl_a (information)
    VALUES (?) 
    RETURNING tbl_a_id
    )
INSERT INTO tbl_b (tbl_a_id, other_information)
SELECT tbl_a_id, 'bar'
FROM   x
RETURNING tbl_a_id, tbl_b_id};
$answer = $dbh->prepare($SQL);
$sth->execute('foo');
$tbl_a_id = $answer->fetch()->[0];
$tbl_b_id = $answer->fetch()->[1]; 
```

未经测试。[手册](http://search.cpan.org/%7Eturnstep/DBD-Pg-2.19.3/Pg.pm#execute)中有一个完整的[示例`DBD::Pg`](http://search.cpan.org/%7Eturnstep/DBD-Pg-2.19.3/Pg.pm#execute)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T20:56:21.090

这取决于您如何处理主键。通常，您最好的选择是通过从序列中选择值来自己处理增量。如果我们假设`tableA.id`随着序列递增，那么您可以通过执行如下 SQL 语句从数据库中执行额外的选择：

```
SELECT NEXTVAL('seq_name'); <-- where seq_name is the name of the sequence you create 
```

您将选择该值，然后使用从数据库中检索到的值`id`在下面修改后的插入中设置参数：

```
my $insertitA = $dbh->prepare("insert into tableA (id, information) values (?, ?)"); 
```

由于您已明确选择了该值，因此您也可以将其插入到引用表中。**

# c# - 比较大型数据集时使用嵌套循环时速度慢

> ID：12903732
> 
> 赞同：2
> 
> 时间：2012-10-15T20:47:37.120
> 
> 标签：c#, linq, entity-framework

我正在使用 Linq to 检索两个数据集列表。它们都在同一个数据库中，但我需要将一个表转换为我的任务表，因为它已集成到我的日历中。我敢肯定，这里不值得详细介绍，但我很想加快匹配 id 和创建新任务对象的过程。这是一个一次性完成的片段，所以即使速度很慢，我也可以简单地让程序在一夜之间运行。但是，为了将来参考，我想要一些关于提高效率的建议。

```
var accounts = data.Accounts.ToList().OrderBy(a => a.ID);
Incidents[] Incidents = data.Incidents.ToArray();

        for (int i=0;i<Incidents.Length;i++)
        {
            foreach (var a in accounts)
            {
                if (a.Acct_CID == Incidents[i].CustomerID)
                {
                    Tasks t = new Tasks();
                    t.creator_id = a.ID;
                    t.start_date = Incidents[i].DateOpened;
                    t.end_date = Incidents[i].DateCLosed;
                    t.product_code = Incidents[i].ProductCode;
                    t.install_type = Incidents[i].InstallType;
                    t.os = Incidents[i].OSType;
                    t.details = Incidents[i].Description;
                    t.solution = Incidents[i].Solution;
                    t.creator_name = Incidents[i].TechID;
                    t.category = Incidents[i].Title;
                    t.text = "Ticket for" + " " + Incidents[i].Name;
                    if (t.end_date == DateTime.MinValue || t.end_date == null)
                        t.status_id = 6;
                    else t.status_id = 7;
                    data.Tasks.Add(t);
                    break;
                }
            }
        }
        data.SaveChanges(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T21:09:47.343

为什么不即时加入表格并创建任务？

```
var tasks = from i in data.Incidents
            join a in data.Accounts on i.CustomerID equals a.Acct_CID
            select new Tasks()
            {
                creator_id = a.ID,
                start_date = i.DateOpened,
                end_date = i.DateCLosed
                // ...
            }; 
```

顺便说一句，我认为排序在这里没有意义，因此将创建的任务添加到数据库的顺序无关紧要。

```
// Query will not be executed until here
foreach(var task in tasks)
   data.Tasks.Add(task);
data.SaveChanges(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-15T21:11:02.180

我会`Join`在 DB 上得到结果

```
var joinedResult = data.Accounts.Join(data.Incidents, 
                                      a => a.Acct_CID, 
                                      i => i.CustomerID, 
                                      (a, i) => new { Account = a, Incident = i });

foreach (var item in joinedResult)
{
    Tasks t = new Tasks();
    t.creator_id = item.Account.ID;
    t.start_date = item.Incident.DateOpened;
    ........

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-15T21:13:29.587

创建帐户查找

```
var accountsLookup = data.Accounts.ToLookup(a => a.Acct_CID);
foreach (var incident in data.Incidents)
{
    foreach (var a in accountsLookup[incident.CustomerID])
    {
        Tasks t = new Tasks();
        t.creator_id = a.ID;
        ...
    }
}
data.SaveChanges(); 
```

* * *

如果帐户是唯一的，您还可以创建字典

```
var accountsDict = data.Accounts.ToDictionary(a => a.Acct_CID);
foreach (var incident in data.Incidents)
{
    Account a;
    if (accountsDict.TryGetValue(incident.CustomerID, out a)
    {
        Tasks t = new Tasks();
        t.creator_id = a.ID;
        ...
    }
}
data.SaveChanges(); 
```

这将比第一个变体更快。请注意，字典具有不依赖于其大小的恒定查找时间。因此，您基本上可以获得循环的 O(n) 执行时间。您的原始实现具有 O(n^2) 执行时间。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-15T20:55:19.767

替换此行

```
var accounts = data.Accounts.ToList().OrderBy(a => a.ID); 
```

有了这个

```
var accounts = data.Accounts.OrderBy(a => a.ID).ToList(); 
```

这将让数据库进行排序，然后缓存排序的结果。你现在拥有的东西会拉入所有内容，然后在每次到达`foreach`循环时对它们进行排序（`accounts`再次枚举）。

我不能说它会带来很大的改进，但是如果你的数据集足够大，对一个大列表重新排序很多次肯定会减慢你的速度。

* * *

乍一看，您不仅`accounts`每次都在进行排序，而且您似乎只在寻找记录的一小部分，但您正在遍历整个数组。考虑更换

```
 foreach (var a in accounts)
        {
            if (a.Acct_CID == Incidents[i].CustomerID)
            { 
```

和

```
 foreach (var a in accounts.Where(acct => acct.Acct_CID == Incidents[i].CustomerID))
      { 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-17T16:05:37.327

```
 var tasks = (from i in data.Incidents
                     join a in data.Accounts on i.CustomerID equals a.Acct_CID
                     select new
                     {
                         creator_id = a.ID,
                         start_date = i.DateOpened,
                         end_date = i.DateCLosed,
                         product_code = i.ProductCode,
                         install_type = i.InstallType,
                         os = i.OSType,
                         details = i.Description,
                         solution = i.Solution,
                         creator_name = i.TechID,
                         category = i.Title,
                         text = "Ticket for" + " " + i.Name,
                         status_id = 7
                     }).AsEnumerable().Select(x => new
                         {
                             x.creator_id,
                             x.start_date,
                             x.end_date,
                             x.product_code,
                             x.os,
                             x.details,
                             x.solution,
                             x.creator_name,
                             x.category,
                             x.text,
                             x.install_type,
                             x.status_id
                         });

        foreach (var item in tasks)
        {
            Tasks t = new Tasks();
            t.os = item.os;
            t.id = item.creator_id;
            t.install_type = item.install_type;
            t.start_date = item.start_date;
            t.end_date = item.end_date;
            t.solution = item.solution;
            t.details = item.details;
            t.creator_name = item.creator_name;
            t.category = item.category;
            t.text = item.text;
            t.product_code = item.product_code;
             if (t.end_date == DateTime.MinValue || t.end_date == null)
                 t.status_id = 6;
             else t.status_id = 7;
             data.Tasks.Add(t);
        }
        data.SaveChanges(); 
```

# c - 将双指针连接到多个指针

> ID：12903735
> 
> 赞同：0
> 
> 时间：2012-10-15T20:47:43.163
> 
> 标签：c, pointers, tree, directory

在目录树（在 C 中）中，我试图通过“dir”结构（）中的双指针将父目录连接到它们的子目录，`struct dir **children`但我不知道如何在语法上实际关联它们，或者“point给他们。” 一个代码示例会很棒！

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T20:50:00.807

`struct dir **children`不是“双指针”。它是一个指向指针的指针。

为了做你想做的事，你需要声明`struct dir *children[5]`5 是你想要指向的孩子的数量，或者如果你想让它是动态的，分配它`struct dir **children = malloc(number_of_child * sizeof(*children));`

然后，只需分配`children[0] = child`child 所在的位置`struct dir *`

# c++ - gtkmm3 的 gtk_widget_draw() 替代品

> ID：12903736
> 
> 赞同：3
> 
> 时间：2012-10-15T20:47:57.103
> 
> 标签：c++, gtkmm, gtk3

我正在寻找一种将一些 gtk 小部件容器渲染到 pixbuf 以供以后使用 gtkmm3 拖放图标图像的方法。

据我研究，在本机 gtk3 中执行此操作的正确方法是 - 在提供的 cairo 表面上使用 gtk_widget_draw()。

这个表面的创建不是问题，但是调用 gtk_widget_draw() 本身就是问题。

只有在 gtkmm-3.4.2 源代码中直接提到的地方是 Gtk::Widget::draw() 函数 (widget.cc:310)，它被声明为“受保护”。

所以我的问题是：我如何在 gtkmm3 中正确执行这样的任务（将小部件渲染到 pixbuf）？

在这一点上，我看到两个选项：

*   子类 Gtk::Widget 为受保护的 draw() 函数提供公共接口

*   从 Gtk::Widget 中提取 gobj* 实例并在该实例上调用原生 Gtk 的 gtk_widget_draw()。

问题是：哪种方式更可取，为什么？或者也许还有其他一些[更好的]方法可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T21:31:25.733

您可以使用 a`GtkOffscreenWindow`从[文档](http://developer.gnome.org/gtkmm/3.0/classGtk_1_1OffscreenWindow.html#_details)中收集小部件的 pixbuf ：

> 这个想法是获取一个小部件并手动设置它的状态，将其添加到 OffscreenWindow，然后将快照作为 Gdk::Pixbuf 检索。

和功能：

```
Glib::RefPtr<Gdk::Pixbuf> Gtk::OffscreenWindow::get_pixbuf  (       )   
Retrieves a snapshot of the contained widget in the form of a Gdk::Pixbuf. 
```

您还可以从这个相关问题中收集一些示例代码（在 python 中）和额外提示：

[如何在 Cairo 表面上绘制任何 GTK 小部件](https://stackoverflow.com/questions/4944441/how-to-draw-any-gtk-widget-on-top-of-cairo-surface)

# android - 应用程序在新创建时从先前状态恢复

> ID：12903742
> 
> 赞同：1
> 
> 时间：2012-10-15T20:48:10.087
> 
> 标签：android

以下是场景。

**场景 #1：** 我的 android 应用程序进入后台，因为用户点击了“主页”按钮。然后用户立即返回到应用程序，应用程序在最后一个活动中拾取并保留它的历史堆栈并调用 /onResume。凉爽的。所有非常预期的行为。

**场景 #2：** 我的 android 应用程序进入后台，因为用户点击了“主页”按钮。用户在返回应用程序之前等待相当长的时间。应用程序的新实例“应用程序”类 /onCreate 被调用，应用程序返回到屏幕上的最后一个活动并保留历史堆栈。这与场景 #1 完全相同，只是调用了 Application.onCreate。

虽然场景 #2 是正确的，但对我来说这是出乎意料的行为。如果由于操作系统想要回收内存而启动了应用程序的新实例，我希望我的“MAIN”启动器被调用，而不是最后一个活动，我也不希望历史堆栈。

**问题：** 我想要场景 #1 中的行为，但在场景 #2 中，当创建应用程序的新实例时，如何让它启动应用程序的新/新版本？

感谢大家的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T00:15:22.670

呃...我无法将评论标记为答案，“小答案”会自动转换为评论。所以这里是随机文本。答案在下面的链接中。

[应用程序重启 - 活动入口点](https://stackoverflow.com/questions/11243019/application-restart-activity-entry-point)

# magento - Magento - 添加批量操作以打印 PDF 发票

> ID：12903743
> 
> 赞同：2
> 
> 时间：2012-10-15T20:48:15.403
> 
> 标签：magento, invoice

我有疑问，如何添加批量操作以打印 PDF 发票。我需要两张不同的 PDF 发票（一张是默认的“打印发票”），所以我想添加额外的操作“打印发票 2”。我怎样才能开始打印“打印发票 2”？

希望有人能帮忙！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T21:17:37.373

假设您要将批量操作添加到发票网格（管理员中的销售 > 发票），您需要执行以下操作：

重写`Mage_Adminhtml_Block_Sales_Invoice_Grid`类并用你自己的替换它。您的新类应该在它自己的扩展中并继承自`Mage_Adminhtml_Block_Sales_Invoice_Grid`. 如果你不确定如何重写一个块，[这篇博文应该可以帮助](http://magedev.com/2009/06/03/magento-overriding-model-block-or-helper/)你。 **注意：**您可以将网格块复制到，`app/code/local/`但这会使 Magento 升级变得困难。更好的方法是重写并覆盖尽可能少的功能。

你的类应该提供它自己的`_prepareMassaction`函数，然后添加新的动作。以下代码（虽然完全未经测试）应该这样做：

```
class MyNamspace_Extension_Block_Adminhtml_Invoice_Grid extends Mage_Adminhtml_Block_Sales_Invoice_Grid {
    protected function _prepareMassaction() {
        parent::_prepareMassaction();

        $this->getMassactionBlock()->addItem('pdfinvoices_order2', array(
             'label'=> Mage::helper('myextension')->__('PDF Invoices2'),
             'url'  => $this->getUrl('myroute/mycontroller/myaction'),
        ));

        return $this;
    }
} 
```

调用中的“url”参数`addItem()`应该指向您自己的控制器，您可以在其中实现自己的逻辑来生成 PDF。`app/code/core/Mage/Adminhtml/Controller/Sales/Invoice.php`如果您想获得一些灵感，可以在第 129 行找到标准质量动作 PDF 生成器。

# jquery - Drupal分页上的无限滚动跳过第二页

> ID：12903744
> 
> 赞同：4
> 
> 时间：2012-10-15T20:48:22.130
> 
> 标签：jquery, drupal, pagination, scroll, infinite

我有一个 Drupal 站点，主页是所有站点内容的视图。它是分页的，我正在使用 Masonry 和 Infinite Scroll jQuery 插件。

第一页加载良好，当您向下滚动时，它似乎确实可以正常工作。但是，它实际上跳过了第二页内容（寻呼机链接中的第 2 页）。我似乎无法弄清楚为什么。

当页面首次加载时，如果您不滚动，您可以将鼠标悬停在分页上并查看每个链接指向的 URL。当我在 firebug 中运行该站点时，AJAX 实际上正在加载分页中的第 3 页作为第一页，并直接跳过第 2 页。

请参阅此处的页面[http://ninja.oncommunication.ca/](http://ninja.oncommunication.ca/)

是因为 Drupal 在其分页中从第 0 页开始吗？我认为 Infinte Scroll 插件只是从“下一个”链接读取 URL，但显然不是因为该链接指向 Page=1 （这是分页中的第二页），但是当你滚动向下，加载的第一页是Page=2（也就是分页中的第三页）

有什么帮助吗？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T22:06:44.373

我之前也遇到过类似的问题，尝试在初始化infinatescroll的时候设置currentPage选项，像这样：

请注意，您所需要的只是，`currPage: 1`但我已经包含了一整套选项，因为我发现选项和更多选项的子集往往会让人感到困惑。

也尝试使用这个数字，也许 0 或 2 会起作用？基本上，您是在告诉 infinateScroll 您从哪个页面开始，因为有时它无法根据下一个链接完全弄清楚。

```
 // initialize scroller
    $('.infinateScroll').find('ul:first').infinitescroll({

        // setup scroller options
        navSelector  : ".pager",            
        nextSelector : ".pager > li.next > a",    
        itemSelector : ".infinateScrollItem",
        debug        : false,
        animate         : false,
        loading: {
            finished: function() {},
            finishedMsg: "<p>No More to Load!</p>",
            msg: null,
            msgText: "<p>Loading&hellip;</p>",
            selector: null,
            speed: 'fast',
            start: undefined
        },
        state: {
            isDuringAjax: false,
            isInvalidPage: false,
            isDestroyed: false,
            isDone: false, // For when it goes all the way through the archive.
            isPaused: false,
            currPage: 1
        },
        bufferPx: 300 // ideal setting 300     

    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T21:56:39.410

您是否考虑过同样使用[View Infinite Scroll](http://drupal.org/project/views_infinite_scroll)模块？

# c - 连接两个字符串数组？

> ID：12903745
> 
> 赞同：2
> 
> 时间：2012-10-15T20:48:27.623
> 
> 标签：c, arrays, merge, memcpy

我是 c 世界的新手，我想将两个数组合并为一个数组，我知道如何做到这一点，但它不起作用：P

```
char *s_one[] = { "Zorro", "Alex", "Celine" };
char *s_two[] = { "Zorro1", "Alex1"};

char *p = (char*)malloc((sizeof(s_one)+sizeof(s_two))*sizeof(char));
memcpy(p, s_one, sizeof(s_one));
memcpy(p + sizeof(s_one), s_two, sizeof(s_two));

//print out
for (count = 0; count < sizeof(p); count++)
        printf("\narr[%d] = %c.", count, p[count]); 
```

输出只是一些随机字符......我做错了什么，提前感谢每个提示

输出应该是： Zorro Alex Celine Zorro1 Alex1

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T21:02:58.417

让我们看看我能不能做到这一点......

`s_one`是一个数组`char *`。因此，您的`sizeof()`and`memcpy()`操作很可能对指针进行操作，而不是它们指向内存中其他位置的字符串。然后，当您`printf()`将指针打印为字符而不是它们指向的字符串（作为字符串）时。不确定这里，但也许这会工作？

```
printf("\narr[%d] = %s.", count, *p[count]); 
```

如果我回家之前你不把它修好，我会测试一下看看。

* * *

结合 Marvo 对`sizeof()`电话的评论。

* * *

这真的取决于你想要什么，但这是我的尝试，因为我说过我会发布它：

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

int main(void)
{
    char *s_one[] = { "Zorro", "Alex", "Celine" };
    char *s_two[] = { "Zorro1", "Alex1"};

    printf("%lu\n", sizeof(s_one));
    printf("%lu\n", sizeof(s_two));

    int numberOfEntries = (sizeof(s_one) + sizeof(s_two)) / sizeof(char*);
    char **p = (char **)malloc(numberOfEntries);

    printf("%d\n", numberOfEntries);

    memcpy(p, s_one, sizeof(s_one));
    memcpy(p + sizeof(s_one)/sizeof(char *), s_two, sizeof(s_two));

    //print out
    int count = 0;
    for (count = 0; count < numberOfEntries; count++)
        printf("arr[%d] = %s.\n", count, p[count]);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T21:03:09.993

您有两个指针数组`char`（实际上指向 0-terminated 的第一个字符`char[]`）。所以当你`memcpy`from`s_one`和`s_two`to时`p`，你复制了指针，你打印出来的是指针值的一部分。

如果你声明

```
char **p = malloc(sizeof s_one + sizeof s_two); 
```

你会得到一个由五个组成的数组`char*`，指向各自的字符串。

如果你想连接相应的元素的字符串`s_one`。`s_two`指向，您需要分配足够的空间来保存结果（加上 0 终止符）：

```
size_t needed = 1;
for(size_t i = 0; i < sizeof s_one / sizeof *s_one; ++i)
    needed += strlen(s_one[i]);
for((size_t i = 0; i < sizeof s_two / sizeof *s_two; ++i)
    needed += strlen(s_two[i]);
char *p = malloc(needed);
if (!p) {
    // allocation failed
    exit(EXIT_FAILURE);
}
p[0] = 0;
for(size_t i = 0; i < sizeof s_one / sizeof *s_one; ++i)
    strcat(p,s_one[i]);
for(size_t i = 0; i < sizeof s_two / sizeof *s_two; ++i)
    strcat(p,s_two[i]); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T20:54:35.977

我建议不要使用 memcpy，而是遍历两个数组中的每一个，并使用 strcpy 将源数组中的一个字符串复制到 p 中。memcpy 的问题是它应该省略复制 \0 字符，因此你的随机字符。

你的 malloc 指令很好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-15T21:18:21.897

对于噪音较小的 malloc，只有两个提示：
您不需要强制转换它的返回值。
您不需要 sizeof(char) 因为 char 根据定义是 1 字节。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-15T21:56:52.453

我的第一个解决方案是遍历两个数组中的每一个，并使用 strcpy 将一个字符串从源数组复制到 p 中……感谢 Hernan Velasquez

```
char *s_one[] = { "Zorro", "Alex", "Celine" };
char *s_two[] = { "Zorro1", "Alex1"};

char *p[sizeof(s_one)/sizeof(char *) + sizeof(s_two)/sizeof(char *)];
memset(p, 0, sizeof(p));
for(count=0;count < sizeof(s_one)/sizeof(char *) ;count++) {
    p[count] = (char*)malloc((strlen(s_one[count])+1)*sizeof(char));
    strcpy(p[count], s_one[count]);
}
i=count;
for(count=0;count < sizeof(s_two)/sizeof(char *) ;count++) {
    p[i] = (char*)malloc((strlen(s_two[count])+1)*sizeof(char));
    strcpy(p[i], s_two[count]);
    i++;
}

//print out
for (count = 0; count < sizeof(p)/sizeof(char *); count++)
        printf("\narr[%d] = %s.", count, p[count]); 
```

我认为它不是很干净，但它对我有用……明天我用 Daniel Fischer 的小费试试

# java - 流图像中的空读取？无法启动活动 ComponentInfo

> ID：12903747
> 
> 赞同：2
> 
> 时间：2012-10-15T20:48:30.277
> 
> 标签：java, android, eclipse, assets

我已经查看了很多关于无法启动活动的类似问题，但它们似乎与我的问题不太匹配。我正在开发一个简单的二十一点游戏，但它的力量正在退出。我怀疑加载我拥有的卡片 png 图像时存在问题。单步调试它会在 resetGame() 函数中崩溃。我确定我在做一些愚蠢的事情。

遵循 Sam 的建议后的新 Logcat：

```
10-15 21:59:08.448: E/AndroidRuntime(3070): FATAL EXCEPTION: main
10-15 21:59:08.448: E/AndroidRuntime(3070): android.content.res.Resources$NotFoundException: File res/layout/action_menu_layout.xml from xml type layout resource ID #0x109001b
10-15 21:59:08.448: E/AndroidRuntime(3070):     at android.content.res.Resources.loadXmlResourceParser(Resources.java:2145)
10-15 21:59:08.448: E/AndroidRuntime(3070):     at android.content.res.Resources.loadXmlResourceParser(Resources.java:2100)
10-15 21:59:08.448: E/AndroidRuntime(3070):     at android.content.res.Resources.getLayout(Resources.java:852)
10-15 21:59:08.448: E/AndroidRuntime(3070):     at android.view.LayoutInflater.inflate(LayoutInflater.java:394)
10-15 21:59:08.448: E/AndroidRuntime(3070):     at com.android.internal.view.menu.BaseMenuPresenter.getMenuView(BaseMenuPresenter.java:70)
10-15 21:59:08.448: E/AndroidRuntime(3070):     at com.android.internal.view.menu.ActionMenuPresenter.getMenuView(ActionMenuPresenter.java:148)
10-15 21:59:08.448: E/AndroidRuntime(3070):     at com.android.internal.widget.ActionBarView.setMenu(ActionBarView.java:427)
10-15 21:59:08.448: E/AndroidRuntime(3070):     at com.android.internal.policy.impl.PhoneWindow.preparePanel(PhoneWindow.java:385)
10-15 21:59:08.448: E/AndroidRuntime(3070):     at com.android.internal.policy.impl.PhoneWindow.invalidatePanelMenu(PhoneWindow.java:747)
10-15 21:59:08.448: E/AndroidRuntime(3070):     at com.android.internal.policy.impl.PhoneWindow$1.run(PhoneWindow.java:2913)
10-15 21:59:08.448: E/AndroidRuntime(3070):     at android.os.Handler.handleCallback(Handler.java:615)
10-15 21:59:08.448: E/AndroidRuntime(3070):     at android.os.Handler.dispatchMessage(Handler.java:92)
10-15 21:59:08.448: E/AndroidRuntime(3070):     at android.os.Looper.loop(Looper.java:137)
10-15 21:59:08.448: E/AndroidRuntime(3070):     at android.app.ActivityThread.main(ActivityThread.java:4745)
10-15 21:59:08.448: E/AndroidRuntime(3070):     at java.lang.reflect.Method.invokeNative(Native Method)
10-15 21:59:08.448: E/AndroidRuntime(3070):     at java.lang.reflect.Method.invoke(Method.java:511)
10-15 21:59:08.448: E/AndroidRuntime(3070):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
10-15 21:59:08.448: E/AndroidRuntime(3070):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
10-15 21:59:08.448: E/AndroidRuntime(3070):     at dalvik.system.NativeStart.main(Native Method)
10-15 21:59:08.448: E/AndroidRuntime(3070): Caused by: java.lang.RuntimeException: Assetmanager has been closed
10-15 21:59:08.448: E/AndroidRuntime(3070):     at android.content.res.AssetManager.openXmlBlockAsset(AssetManager.java:485)
10-15 21:59:08.448: E/AndroidRuntime(3070):     at android.content.res.Resources.loadXmlResourceParser(Resources.java:2127) 
```

10-15 21:59:08.448: E/AndroidRuntime(3070): ... 还有 18 个

我的日志猫：

```
10-15 20:21:43.309: E/AndroidRuntime(2863): FATAL EXCEPTION: main
10-15 20:21:43.309: E/AndroidRuntime(2863): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.smith.blackjack/com.smith.blackjack.Main}: java.lang.NullPointerException
10-15 20:21:43.309: E/AndroidRuntime(2863):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2059)
10-15 20:21:43.309: E/AndroidRuntime(2863):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2084)
10-15 20:21:43.309: E/AndroidRuntime(2863):     at android.app.ActivityThread.access$600(ActivityThread.java:130)
10-15 20:21:43.309: E/AndroidRuntime(2863):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1195)
10-15 20:21:43.309: E/AndroidRuntime(2863):     at android.os.Handler.dispatchMessage(Handler.java:99)
10-15 20:21:43.309: E/AndroidRuntime(2863):     at android.os.Looper.loop(Looper.java:137)
10-15 20:21:43.309: E/AndroidRuntime(2863):     at android.app.ActivityThread.main(ActivityThread.java:4745)
10-15 20:21:43.309: E/AndroidRuntime(2863):     at java.lang.reflect.Method.invokeNative(Native Method)
10-15 20:21:43.309: E/AndroidRuntime(2863):     at java.lang.reflect.Method.invoke(Method.java:511)
10-15 20:21:43.309: E/AndroidRuntime(2863):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
10-15 20:21:43.309: E/AndroidRuntime(2863):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
10-15 20:21:43.309: E/AndroidRuntime(2863):     at dalvik.system.NativeStart.main(Native Method)
10-15 20:21:43.309: E/AndroidRuntime(2863): Caused by: java.lang.NullPointerException
10-15 20:21:43.309: E/AndroidRuntime(2863):     at com.smith.blackjack.DeckOfCards.<init>(DeckOfCards.java:17)
10-15 20:21:43.309: E/AndroidRuntime(2863):     at com.smith.blackjack.Main.resetGame(Main.java:98)
10-15 20:21:43.309: E/AndroidRuntime(2863):     at com.smith.blackjack.Main.onCreate(Main.java:67)
10-15 20:21:43.309: E/AndroidRuntime(2863):     at android.app.Activity.performCreate(Activity.java:5008)
10-15 20:21:43.309: E/AndroidRuntime(2863):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1079)
10-15 20:21:43.309: E/AndroidRuntime(2863):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2023)
10-15 20:21:43.309: E/AndroidRuntime(2863):     ... 11 more 
```

我的安卓清单：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.smith.blackjack"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="11"
    android:targetSdkVersion="15" />

<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name=".Main"
        android:label="@string/title_activity_main" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
</application> 
```

这是我的 Main.java

```
package com.smith.blackjack;

import android.os.Bundle;
import android.app.Activity;
import android.content.res.AssetManager;
import android.graphics.drawable.Drawable;

import java.io.IOException;
import java.io.InputStream;

import android.util.Log;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.ImageView;

public class Main extends Activity {

private ImageView dealerCard0;
private ImageView dealerCard1;
private ImageView dealerCard2;
private ImageView dealerCard3;
private ImageView playerCard0;
private ImageView playerCard1;
private ImageView playerCard2;
private ImageView playerCard3;
private ImageView imgResult;
private Button btnDeal;
private Button btnDraw;
private Button btnHold;
private DeckOfCards deckOfCards;
private int[] dealerValues;
private int dealerSum;
private int dealerCardNumber;
private int[] playerValues;
private int playerSum;
private int playerCardNumber;
private InputStream dealerHiddenCard;
private Card dealerCard;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    dealerCard0 = (ImageView) findViewById(R.id.dealerCard0);
    dealerCard1 = (ImageView) findViewById(R.id.dealerCard1);
    dealerCard2 = (ImageView) findViewById(R.id.dealerCard2);
    dealerCard3 = (ImageView) findViewById(R.id.dealerCard3);

    playerCard0 = (ImageView) findViewById(R.id.playerCard0);
    playerCard1 = (ImageView) findViewById(R.id.playerCard1);
    playerCard2 = (ImageView) findViewById(R.id.playerCard2);
    playerCard3 = (ImageView) findViewById(R.id.playerCard3);

    imgResult = (ImageView) findViewById(R.id.imgResult);

    btnDeal = (Button) findViewById(R.id.deal);
    btnDraw = (Button) findViewById(R.id.draw);
    btnHold = (Button) findViewById(R.id.hold);

    btnDeal.setOnClickListener(btnDealListener);
    btnDraw.setOnClickListener(btnDrawListener);
    btnHold.setOnClickListener(btnHoldListener); 

    resetGame();

}

private void resetGame(){

    AssetManager assets = getAssets();
    dealerValues = new int[4];
    playerValues = new int[4];
    dealerSum = 0;
    playerSum = 0;
    dealerCardNumber = 0;
    playerCardNumber = 0;
    for (int i = 0; i < 4; i++) {
        dealerValues[i] = 0;
        playerValues[i] = 0;
    }

    try {
        InputStream stream = assets.open("cardback.png");
        // stream = assets.open("cardback.png");
        Drawable cardImage = Drawable.createFromStream(stream,  null);
        dealerCard0.setImageDrawable(cardImage);
        dealerCard1.setImageDrawable(cardImage);
        dealerCard2.setImageDrawable(cardImage);
        dealerCard3.setImageDrawable(cardImage);
        playerCard0.setImageDrawable(cardImage);
        playerCard1.setImageDrawable(cardImage);
        playerCard2.setImageDrawable(cardImage);
        playerCard3.setImageDrawable(cardImage);
        imgResult.setImageDrawable(cardImage);
        deckOfCards = new DeckOfCards();
        deckOfCards.shuffle();
        assets.close();
    }
    catch (IOException e){
        Log.e("Reset Game", "Error Loading", e);
    }
}

public OnClickListener btnDealListener = new OnClickListener()
{
//      @Override 
    public void onClick(View v) {

        try {
            AssetManager assets = getAssets();
            InputStream stream;

            // first player card
            Card newCard;
            newCard = deckOfCards.dealCard();
            playerValues[playerCardNumber] = newCard.faceValue;
            playerCardNumber++;             
            stream = assets.open(newCard.File);
            Drawable cardImage = Drawable.createFromStream(stream, newCard.File);
            playerCard0.setImageDrawable(cardImage);
            assets.close();

            // second player card
            newCard = deckOfCards.dealCard();
            playerValues[playerCardNumber] = newCard.faceValue;
            playerCardNumber++; 
            stream = assets.open(newCard.File);
            cardImage = Drawable.createFromStream(stream, newCard.File);
            playerCard1.setImageDrawable(cardImage);
            assets.close();

            // first dealer card hidden
            newCard = deckOfCards.dealCard();
            dealerCard = newCard;
            dealerValues[dealerCardNumber] = newCard.faceValue;
            dealerCardNumber++;
            dealerHiddenCard = assets.open(newCard.File);
            stream = assets.open("cardback.png");
            cardImage = Drawable.createFromStream(stream,  "cardback");
            dealerCard0.setImageDrawable(cardImage);
            assets.close();

            // second dealer card open
            newCard = deckOfCards.dealCard();
            dealerValues[dealerCardNumber] = newCard.faceValue;
            dealerCardNumber++;
            stream = assets.open(newCard.File);
            cardImage = Drawable.createFromStream(stream,  newCard.File);
            dealerCard1.setImageDrawable(cardImage);
            assets.close();
        }
        catch (IOException e){
            Log.e("Deal", "Error Loading", e);
        }

    };
};

public OnClickListener btnDrawListener = new OnClickListener()
{
//      @Override 
    public void onClick(View v) {
        try {
            AssetManager assets = getAssets();
            InputStream stream;

            // get next player card
            Card newCard;
            newCard = deckOfCards.dealCard();
            playerValues[playerCardNumber] = newCard.faceValue;
            playerCardNumber++;             
            stream = assets.open(newCard.File);
            Drawable cardImage = Drawable.createFromStream(stream, newCard.File);
            switch (playerCardNumber){
            case 3:
                playerCard2.setImageDrawable(cardImage);
            case 4:
                playerCard3.setImageDrawable(cardImage);
            }
            assets.close();
        }
        catch (IOException e){
            Log.e("Draw", "Error Loading", e);
        }
    };
};

public OnClickListener btnHoldListener = new OnClickListener()
{
//      @Override 
    public void onClick(View v) {
        Drawable cardImage;
        // evaluate player hand
        playerSum = evaluate(playerValues);
        if (playerSum > 21){
            // player losses
        }
        // flip over the dealer hidden card
        cardImage = Drawable.createFromStream(dealerHiddenCard, dealerCard.File);
        Card newCard;
        InputStream stream;
        AssetManager assets = getAssets();
        for (int i=2; i<4; i++){
            dealerSum = evaluate(dealerValues);
            if (dealerSum < 16 ) {
                newCard = deckOfCards.dealCard();
                dealerValues[dealerCardNumber] = newCard.faceValue;
                dealerCardNumber++;
                try {
                    stream = assets.open(newCard.File);
                    cardImage = Drawable.createFromStream(stream,  newCard.File);
                    switch (dealerCardNumber){
                    case 3:
                        dealerCard2.setImageDrawable(cardImage);
                    case 4:
                        dealerCard3.setImageDrawable(cardImage);
                    }
                    assets.close();
                }
                catch (IOException e){
                    Log.e("Draw", "Error Loading", e);
                } 
                if (dealerSum < playerSum) {
                    // player wins
                }
                if (dealerSum > playerSum){
                    // dealer wins
                }
                if (dealerSum == playerSum){
                    // it is a draw
                }
            }

        }

    };
};

public int evaluate (int[]values)   {
    int sumCards = 0;
    for (int i = 0; i < 4; i++){
        sumCards += values[i];
    }
    if (sumCards > 21) {
        for (int i = 0; i < 4; i++){
            if (values[i] == 11) {
                values[i] = 1;
                sumCards -= 10;
                continue;
            }
        }
    }
    return sumCards;
}

} 
```

我的 DeckOfCards 课程：

```
package com.smith.blackjack;

import java.util.Random;

public class DeckOfCards {

private Card [] deck;
private int currentCard;
private static final int NUMBER_OF_CARDS = 52;
private static final Random randomNumbers = new Random();

public DeckOfCards () {
    deck = new Card[NUMBER_OF_CARDS];
    currentCard = 0 ;
    for(int count = 0; count < deck.length; count++)
    {
        deck[count].faceValue = count + 1;
    }
}

public void shuffle () {
    currentCard = 0;
    for (int first = 0; first < deck.length; first ++){
        int second = randomNumbers.nextInt(NUMBER_OF_CARDS);
        int temp = deck[first].faceValue;
        deck[first].faceValue=deck[second].faceValue;
        deck[second].faceValue = temp;
    }
}

public Card dealCard(){
    Card temp = new Card();
    temp.faceValue = 0;
    temp.File = "";
    if(currentCard < deck.length)
    {
        temp.faceValue = deck[currentCard].faceValue / 4;

        int suit = deck[currentCard].faceValue % 4;
        String suitString = "";
        switch (suit){
        case 0:
            suitString = "c";
        case 1:
            suitString = "d";
        case 2:
            suitString = "h";
        case 3:
            suitString = "s";   
        }

        Integer face = temp.faceValue / 4 ;
        String faceString = face.toString();
        temp.File = faceString + suitString + ".png";

        switch (temp.faceValue){
        case 11:
            temp.faceValue = 10;
        case 12:
            temp.faceValue = 10;
        case 13:
            temp.faceValue = 10;
        }

        return temp;
    }

    else
        return temp;
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T21:38:05.060

`deck[count]`的每个值为`null`。尝试先创建一张卡片，然后设置`faceValue`：

```
for(int count = 0; count < deck.length; count++)
{
    deck[count] = new Card();
    deck[count].faceValue = count + 1;
} 
```

* * *

**新的 LogCat：**

错误状态：`RuntimeException: Assetmanager has been closed`
所以我会删除这一行：`assets.close();`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T21:49:22.940

或者：

```
for(int count = 0; count < deck.length; count++)
{
    Card card= new Card();
    card.setFaceValue(count+1); 
    deck[count] = card;
} 
```

# visual-studio-2012 - Visual Studio 2012 自动启动 web 项目

> ID：12903748
> 
> 赞同：4
> 
> 时间：2012-10-15T20:48:31.307
> 
> 标签：visual-studio-2012

我正在使用 Visual Studio 2012。我创建了几个 Web 应用程序。有一次，我将项目设置为在运行启动项目时自动启动。现在我想更改该选项，使它们无法启动，但我无法在任何地方找到它。我已经搜索了包括 SO 在内的互联网，但似乎找不到合适的关键字来找到可以给我答案的搜索结果。它快把我逼疯了！

有人可以告诉我如何告诉VS 2012不要自动启动吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-15T20:54:45.057

您可能正在寻找此选项：`Always Start when Debugging`. 它是针对每个项目的设置，请参见属性窗口 (F4)。答案取自[stackoverflow 上的这个问题](https://stackoverflow.com/questions/5186096/visual-studio-solution-with-multiple-asp-net-web-applications)。

# asp.net-mvc - 构建模板化 MVC+AJAX ASP.NET 应用程序

> ID：12903750
> 
> 赞同：-1
> 
> 时间：2012-10-15T20:48:34.717
> 
> 标签：asp.net-mvc, templates, mono

我在 WebForms 方面有很好的经验，但现在我想为我的下一个 ASP.NET 项目走得更远。我希望网站管理员可以**完全自定义新应用程序的 UI。**

目前，使用 WebForms，为了只修改自定义模板文件夹中页面/控件的外观，可以执行以下操作：

1.  定义 .ascx/.aspx 文件以便从包含逻辑的正确类继承
2.  让应用程序使用`LoadControl`从动态文件路径加载控件对象

“修改外观”的示例可能意味着在页面上移动控件，使用搜索按钮反转搜索框，等等......我的意思不仅仅是编辑 CSS、字体、图标等。

我还没有使用 MVC，但我阅读了一些教程。这里有几个问题需要进一步研究：

1.  MVC4 是否可以很好地与 Mono 一起使用？
2.  MVC 是否支持母版页或类似的概念？我想为所有页面定义一个通用布局，并使用适当的模板专门化每个页面的内容。如果没有，我可以使用什么样的构造？
3.  MVC 是否带有内置的 AJAX 支持？否则，我可以使用哪些免费工具在 MVC 中开发 AJAX 网站？
4.  MVC 是否支持用户控件的概念？我想开发一个`login-with-facebook-or-any-other-openid`盒子的视图/控制器逻辑和布局，与它所在的页面分开，就像我对 .ascx 文件所做的那样。我怎样才能做到这一点？

我已经阅读了 Razor 模板引擎，这似乎是一个很好的起点。就我而言，我通常希望保持视图/控制器逻辑“静态”并允许管理员仅更改外观。因此，例如，可以覆盖搜索框的外观，但它总是会触发相同的操作做相同的事情（搜索数据库）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T20:58:51.880

> 1) MVC4 是否可以很好地与 Mono 一起使用？

据我所知，ASP.NET MVC 4 适用于 Mono。我不能说它是否运作良好，因为我从未在 Mono 上使用过 MVC。

> 2) MVC 是否支持 Master Page 或类似的概念？我想为所有页面定义一个通用布局，并使用适当的模板专门化每个页面的内容。如果没有，我可以使用什么样的构造？

是的，它支持视图从这些母版页继承的母版页。如果您使用的是 Razor 视图引擎，则这些母版页称为布局。

> 3) MVC 是否支持 AJAX？我可以使用哪些免费工具在 MVC 中开发 AJAX 网站？

如您所知，AJAX 与服务器端语言无关。所以当然 MVC 支持 AJAX。您可以使用[Visual Studio Express 2012 for web](http://www.microsoft.com/visualstudio/eng/products/visual-studio-express-for-web)作为开发 ASP.NET MVC 应用程序的免费工具。

> 4) MVC 是否支持用户控件的概念？我想开发一个 login-with-facebook-or-any-other-openid 框的视图/控制器逻辑和布局，与它所在的页面分开，就像我对 .ascx 文件所做的那样。我怎样才能做到这一点？

没有用户控件在 MVC 中不再存在，也不受支持。如果您想开发一些可重用的页面部分，您可以使用部分视图。和孩子的行动。Phil Haack 有[一篇](http://haacked.com/archive/2009/11/17/aspnetmvc2-render-action.aspx)关于子行为的精彩博文。

# php - 验证文本框条目以逗号分隔的 3 位数字

> ID：12903753
> 
> 赞同：1
> 
> 时间：2012-10-15T20:48:49.520
> 
> 标签：php, javascript, jquery, html

我在登记表上有一个收集电话区号的文本框——我聪明的自己认为我的客户不会那么好输入 5 位数的邮政编码而不是 3 位数的区号，所以现在我需要制作一个 jquery或用于验证条目的javascript函数是###,###,###,###,###...格式 他们可以输入的区号数量没有限制。问题是我不知道代码应该如何运行 - 我的文本框有任何想法

```
<input type="text" id="acode" name="acode" /> 
```

我很感激

***完成的代码***

HTML

```
 <label for="acode">Enter area codes separated by commas (757,804,252,###):</label>
  <input type="text" id="acode" name="acode" onblur="valarea(this.form)"/> 
```

Javascript

```
<script>
function valarea(form)
{
inputvalue =form.acode.value;
var regexp = /^\d{3}(?:,\d{3})*$/;
if (inputvalue != "")
{
if (regexp.test(inputvalue)) {
//nothing happens
} else {
alert('You have entered an invalid value, you should have listed 3 digit telephone area codes for the areas you are interested in shopping separated by commas (757,804,252,###) Please Correct the problem before continuing')
form.acode.focus()
}
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T20:55:18.183

使用正则表达式：

```
var regexp = /^\d{3}(?:,\d{3})*$/;
if (regexp.test(inputvalue)) {
  // Valid, do something with it...
} else {
  // Invalid, show error.
} 
```

有关 Javascript 中正则表达式的更多信息，[请参阅 MDN 正则表达式页面](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Regular_Expressions)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T01:08:10.313

不确定您是否需要它，但如果您想验证当前区号的列表，我可以给您发送一个列表。我在[GreatData.com](http://www.GreatData.com)工作，我们维护美国和加拿大的当前区号。只需访问该网站获取联系信息并索取文件即可。

不知道您的确切应用程序，但您可能有一个选择列表，他们可以在其中选择适当的区号并自己构建逗号分隔列表。

# c++ - 在 C++ 中声明实例变量而不构造它们的好方法是什么？

> ID：12903754
> 
> 赞同：7
> 
> 时间：2012-10-15T20:48:56.603
> 
> 标签：c++, class, scope

我一直在互联网上搜索这个主题，但我还没有真正找到一个确定的答案。作为主要的 C# 程序员，我习惯于在大范围内声明类，通常在文件顶部附近，在任何函数之外，然后在使用时构造它们。

在转向 C++ 之后，复制它的唯一方法是拥有一个默认构造函数，这很好，但在某些情况下，我宁愿拥有一个需要参数的构造函数，而不是一个无参数的默认构造函数。

在互联网上搜索解决方案后，我遇到了一些有缺陷的建议：

**1.指针**

有人建议在所需范围内有一个动态指针，然后在构造时将指针分配给指向类的位置。

```
CClass* pClass = 0;

int main()
{
    pClass = new CClass(1337);

    delete pClass;
    return 0;
} 
```

这种方法的问题是您必须记住在之后删除指针，因此，静态指针更加“安全”。另外，我猜这样做会有轻微的内存开销，虽然不多，因为有指针。

**2.无论如何都有一个默认构造**

有时建议无论如何都有一个默认构造函数，它只是将类中的所有内容归零：

```
class CClass
{
public:
    CClass() : leetNumber(0) {}
    CClass(int leetNumber) : leetNumber(leetNumber) {}
private:
    int leetNumber;
};

//Defaults leetNumber to 0 through default ctor
CClass myClass;

int main()
{
    myClass = CClass(1337);

    return 0;
} 
```

但是，如果您不能将课堂内的所有内容归零，会发生什么？如果你有另一个类不能被初始化为空怎么办？如果用户试图在没有正确初始化成员的情况下访问类中的函数，你会怎么做？（你可以检查一下，但我相信这需要太多的代码，特别是如果你有很多成员）。

**3\. 停留在更小、更本地化的范围内**

有人建议人们说要保持在小范围内，将类作为引用传递给可能需要它的其他函数，并在声明类后立即构建：

```
class CClass
{
public:
    CClass(int leetNumber) : leetNumber(leetNumber) {}
    int getLeetNumber() { return leetNumber; }
private:
    int leetNumber;
};

bool GetMuchNeededAmazingNumberFromClass(CClass& myClass)
{
    if(myClass.getLeetNumber() == 1337)
        return true;

    return false;
}

int main()
{
    CClass myClass = CClass(1337);
    if(!GetMuchNeededAmazingNumberFromClass(&myClass);
        return 1;

    return 0;
} 
```

从某种意义上说，这很好，您可以看到什么函数需要什么，但我可以想象一个函数需要大量具有大量所需参数的外部类。

还有更多示例，但我似乎找不到可以依赖的示例，尤其是来自 C# 背景的示例，这些示例既好用又简单。

谢谢。

**编辑：**

让我详细说明我的要求 - 在 C# 中，您可以执行以下操作：

```
public class Program
{
    //See how I'm able to do this, without calling the ctor.
    static AmazingClass amazing;

    public static void Main()
    {
        //And then call the constructor when I want.
        amazing = new AmazingClass(1337);
    }
} 
```

这允许我创建类而不实际构建它，这就是我在 C++ 中寻找的。

再次感谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-15T21:00:42.723

This is very bad habit (replaced classes with objects):

> I'm used to declaring objects in a large scope, typically near the top of the file, outside any functions, and then constructing them when in use.

Forget about it. Define object when you need it.

```
int main() { 
     A a;
     ...a...
     A b;
     ...b...
 } 
```

This is C++ thinking.

I believe in C# it is bad habit too. What if you use object without defining it - you'll get null reference exception - why play with such dangerous thing.

BTW, C++ equivalent to C# object is shared_ptr:

```
std::shared_ptr<A> a;
int main() {
   a = std::make_shared<A>(...);
   // do not need to call delete
} 
```

In C++ you can also use `std::unique_ptr` if you do not need an object to be shared.

But don't do this, don't use global variables...

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-15T21:06:17.800

这是因为在 C# 中，类是基于堆的引用对象。所以：

C＃

```
MyClass a; //null reference
a = new MyClass (param1, param2); 
```

然而：

C++

```
MyClass a; //Myclass is constructed on stack 
```

C# 版本相当于 C++ 中的这个：

```
Myclass* a = 0; //null reference
a = new Myclass (param1, param2); 
```

在 C++ 中，类可以存在于堆栈中，而在 C# 中则不能。

C# 提供了一个可以存在于堆栈中的结构值类型：

```
MyStruct a; //lives on the stack 
```

但是我可以提供一个带参数的结构构造函数：

```
struct MyStruct
{
   public MyStruct (int a, int b) { /*assign to members vars*/ }

   int A, B;
} 
```

C#代码：

```
MyStruct a; // this creates a on stack and zero initializes int A and B 
```

这个：

```
MyStruct a; //does same as above

a = new Mystruct(1, 2); //a.A = 1, a.B = 2 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-15T21:04:44.780

> 1.  停留在更小、更本地的范围内

这是您应该做的，不仅在 C++ 中，而且在所有语言中都应尽可能多地使用。

> 但我可以想象一个函数需要大量具有大量所需参数的外部类。

函数应该接受他们需要接受的参数。如果您觉得有太多，也许您应该将功能重构为其他部分。参数的数量只是衡量函数复杂性的另一种方式。访问全局对象不仅不会简化函数，还会使识别全局对象在哪里使用/访问/修改变得更加困难，进而使您的代码维护起来更加复杂。

如果你的函数有很多参数，要么它不是一个真正的函数，而是不同操作的复杂混乱，要么参数可能组合成一些有意义的实体。在后一种情况下，只需创建代表这些实体的类型，您最终将传递一些参数。

附带说明一下，我不确定在 C# 中你是否真的按照你所说的去做......特别是，C# 中的大多数代码都在类中，所以你很可能习惯于使用声明成员的类在顶部并在其他任何地方使用。如果是这种情况，您可以在 C++ 中应用相同的范例。创建课程，包含您需要的成员数量。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-15T20:55:12.823

听起来您想重载构造函数。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-15T20:58:05.237

在函数中使用静态变量来延迟对象的创建直到需要。

```
Foo & getInstance () {
    static Foo foo(arg1, arg2, ...);
    return foo;
}

void main () {
    Foo & x = getInstance();
} 
```

* * *

如果您需要`getInstance`创建一个动态对象（如 中`getInstance(x, y, z)`），但只想传入一次参数，您可以这样做：

```
struct FooFactory {
    int arg1;
    float arg2;
    Bar arg3;

    bool valid;

    FooFactory ();

    Foo & getInstance ();
};

FooFactory::FooFactory () : valid(false) {}

Foo & FooFactory::getInstance () {
    if (!valid) throw Error();
    static Foo foo(arg1, arg2, arg3);
    return foo;
}

FooFactor factory;

void main () {
    factory.arg1 = ...;
    factory.arg2 = ...;
    factory.arg3 = ...;
    factory.valid = true;
    Foo & x = factory.getInstance();
} 
```

* * *

当然这是基础。我不在乎信息隐藏或类似的事情。你可以`factory.getInstance()`通过使用`operator() ()`而不是`getInstance ()`和重命名`factory`来避免`getInstance`。我也不是说这是个好主意。我只是在展示如何从字面上完成 OP 的问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-15T21:31:35.170

```
//See how I'm able to do this, without calling the ctor.
static AmazingClass amazing;

//And then call the constructor when I want.
amazing = new AmazingClass(1337); 
```

一切（嗯，几乎一切）都是 C# 中的参考。该变量`amazing`不会引用任何内容，直到您通过`new`. 这是 C++ 等价物：

```
//See how I'm able to do this, without calling the ctor.
static AmazingClass * amazing;

//And then call the constructor when I want.
amazing = new AmazingClass(1337); 
```

因为（几乎）所有内容都是 C# 和 Java 中的引用，所以你必须使用`new`这些语言`new`的`new`所有内容。通过将所有内容都设为指针，您可以在 C++ 中获得相同的行为，但这样做不是首选机制。C++ 没有自动垃圾收集。您在 C++ 中分配的所有内容`new`最终都必须通过`delete`. C++ 中的首选机制是保持`new`和`delete`降低到最低限度。

`new`在 C++ 中解决/问题的一种方法`delete`是绕过`new`. 只需声明所需类型的变量。这为您提供了一些您在 Java 和 C# 中无法做到的事情。您可以声明一个类型的变量，但 Java 和 C# 不允许您看到对象本身。这些语言中的对象总是隐藏在引用后面。

`new`在 C++ 中解决/问题的另一种方法`delete`是使用 RAII。`new`and命令隐藏在`delete`类方法中，析构函数总是自行清理。班级做肮脏的工作。对于外部世界，您只需使用该类。

C# 和 C++ 是不同的语言。您必须采用不同的思维方式才能正确使用两种语言。

# search - 使用 Freebase 搜索服务的多词搜索查询

> ID：12903756
> 
> 赞同：3
> 
> 时间：2012-10-15T20:48:58.373
> 
> 标签：search, google-api, freebase

我正在尝试使用搜索服务 api 搜索主题，并且我想使用多个词来缩小搜索结果。例如，搜索“潮”会返回许多结果，反映该词的不同含义和 Freebase 中的不同主题。但是，由于我对与 Tide 作为洗涤剂和品牌有关的主题特别感兴趣，因此我想通过在搜索字符串中添加信息词来查找结果。例如，通过搜索“Tide+detergent+household+soap”，我希望提高 Tide 与洗涤剂等相关的结果分数。我曾预计此类搜索将基于某种向量空间评分，如Lucene，因此并非所有术语都必须出现在索引主题文档中。但是，由于查询未能返回结果，

```
https://www.googleapis.com/freebase/v1/search?query=tide+detergent+household+soap&indent=true 
```

返回结果：

```
{
 "status": "200 OK",
 "result": [
  ],
 "cost": 6,
 "hits": 0
} 
```

有没有办法使用过滤器来解决这个问题？

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T16:29:46.547

Freebase 关键字搜索 API 确实接受多个关键字，但它主要从主题名称索引，而不是在与主题相关的文档中找到的关键字（如 Google 搜索）。Freebase 中目前没有名为“潮洗涤剂家用肥皂”的主题。

你的直觉是正确的使用过滤器来获得你想要的结果。按类型过滤 /business/brand 应该会给你你正在寻找的东西：

[https://www.googleapis.com/freebase/v1/search?query=tide&filter=(all+type%3A%2Fbusiness%2Fbrand)&indent=true](https://www.googleapis.com/freebase/v1/search?query=tide&filter=(all+type%3A%2Fbusiness%2Fbrand)&indent=true)

# java - 使用 AsyncHttpClient 和 Quartz Job 运行的线程

> ID：12903761
> 
> 赞同：2
> 
> 时间：2012-10-15T20:49:32.737
> 
> 标签：java, multithreading, http, quartz-scheduler, jvisualvm

这是一个简单的 Quartz 调度程序，它应该**每分钟**运行一次作业；[作业本身使用 Sonatype Async Http Client](https://github.com/sonatype/async-http-client)发出 HTTP 请求。使用`jvisualvm`，我能够检测到线程正在产生并且永远不会关闭，例如它们被卡在**wait**中。这让我相信，要么 A）我误解了 Quartz 如何在这个特定的设置下工作，要么 B）有其他问题。可能是 A :) 调度程序：

```
public class QuartzAsyncHttpThreadTest {

    /* TEST */
    @SuppressWarnings("rawtypes")
    private static Class jobToRun = AsyncHttpRequestJob.class;
    private static String cron = "0 0/1 * * * ?";
    /* TEST */

    public static void main(String[] args) throws SchedulerException {

        Scheduler scheduler = new StdSchedulerFactory().getScheduler();
        scheduler.start();

        start(scheduler, jobToRun.getName(), jobToRun);

    }

    @SuppressWarnings({ "rawtypes", "unchecked" })
    public static void start(Scheduler scheduler, String name, Class job)
            throws SchedulerException {

        JobKey monitorKey = new JobKey(name + "_job", "jobs");
        JobDetail detail = JobBuilder.newJob(job).withIdentity(monitorKey)
                .build();

        Trigger cronDef = TriggerBuilder.newTrigger()
                .withIdentity(name + "_trigger", "triggers")
                .withSchedule(CronScheduleBuilder.cronSchedule(cron)).build();

        scheduler.scheduleJob(detail, cronDef);

    }

} 
```

工作：

```
public class AsyncHttpRequestJob implements Job {

    public AsyncHttpRequestJob() {

    }

    public void execute(JobExecutionContext context)
            throws JobExecutionException {

        System.out.println("Go..");

        makeRequest();

    }

    public static void makeRequest() {

        try {

            Future<Response> r = new AsyncHttpClient().prepareGet(
                    "http://google.com").execute();

            Response response = r.get();

            System.out.println("Request status: " + response.getStatusCode()); // 301

        } catch (Exception e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }

} 
```

真的没什么。如果我对活动线程进行分析，则在 2 分钟后，这种侵占就会很明显。首先是 24，然后是 27、30……等等。![在此处输入图像描述](../Images/5ff94d1c8f0609a220d908f313225b0d.png)

**编辑**：

我能够验证它是 AsyncHttpClient 和 Quartz 的组合，就像我`makeRequest`用标准请求换出方法时一样：

```
 URL conn = new URL("http://google.com");
    URLConnection httpR = conn.openConnection();
    BufferedReader in = new BufferedReader(new InputStreamReader(
            httpR.getInputStream()));
    String inputLine;

    while ((inputLine = in.readLine()) != null)
        System.out.println(inputLine);
    in.close(); 
```

一切都按预期工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T17:47:06.680

您必须关闭`AsyncHttpClient`此处创建的每个实例：

```
Future<Response> r = new AsyncHttpClient().prepareGet(
                "http://google.com").execute(); 
```

使用[`close()`](http://sonatype.github.com/async-http-client/apidocs/reference/com/ning/http/client/AsyncHttpClient.html#close%28%29)方法。每个实例`AsyncHttpClient`都会创建一些必须清理的资源（如线程）。

但是，由于`AsyncHttpClient`是线程安全的，更好的方法是只创建一个全局实例，`AsyncHttpClient`并在应用程序的整个生命周期中以及从多个线程中重用它。

最后，既然您基本上发送一些请求并同步（阻塞）等待响应，为什么不使用标准`URLConnection`（如您的示例）或[HttpClient](http://hc.apache.org/httpcomponents-client-ga/)？`AsyncHttpClient`当您不想同步等待响应时非常有用，例如，当您想同时启动数百个 HTTP 请求而不产生数百个线程时。`AsyncHttpClient`然后将在响应出现时调用您的回调代码。

# android - Android，按钮 - 自定义形状

> ID：12903765
> 
> 赞同：1
> 
> 时间：2012-10-15T20:49:59.863
> 
> 标签：android, button, charts, pie-chart

我想创建一些饼图形状的按钮，我知道该怎么做，但我不知道如何将它们放在一个像饼图这样的元素中。有任何想法吗？

我有 5 个这种形状的按钮：

![在此处输入图像描述](../Images/4ee7e17fea83ad2708f9086e3acdfa96.png)

我想实现这样的目标：

![在此处输入图像描述](../Images/9e00ad3aa88f2acc75a6f42e1335da25.png)

但我不知道该怎么做

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T21:02:16.497

I don't believe there's any way to do this with stock Buttons. What you probably want to do is to extend a `View` into your own custom class, and override the `onDraw` method to draw the pie chart with whatever algorithm you want to use to draw a segmented circle.

Then on `onTouch` you can compare the touch X/Y coordiante versus the pie segments you drew and then do some action based on which segment of the pie was clicked.

# html - 在 HTML 省略号下划线

> ID：12903766
> 
> 赞同：5
> 
> 时间：2012-10-15T20:50:02.570
> 
> 标签：html, css, ellipsis

我`text-overflow: ellipsis`用来剪辑位于锚点内的跨度内的文本。当我悬停时，省略号字符没有下划线，这会导致小间隙。有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-15T20:57:24.503

是的，你可以这样做 - 设置`text-decoration: none`而不是使用`border-bottom`-[**演示**](http://jsfiddle.net/544tX/1/)

```
a {
    display: block;
    width: 185px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    text-decoration: none;

    border-bottom: 1px solid transparent;
}

a:hover {
    border-bottom: 1px solid #000;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-09-09T11:31:14.073

如果有人像我一样发现了这一点，并且不喜欢边框底线太远的事实，则此代码可能有助于[演示](http://jsfiddle.net/a7eLnzym/6/)

```
a {
    display: block;
    width: 185px;
    background: beige;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    text-decoration: none;
    color: #000;
    position: relative;
}

a:hover::before {
    content: '';
    position: absolute;
    bottom: 2px;
    right: 0;
    left: 0;
    border-bottom: 1px solid black;
} 
```

仍然是一个黑客，但你知道...... :)

# php - 有没有办法使用 PHP 和 GD 库使图像上的黑色变暗？

> ID：12903774
> 
> 赞同：-1
> 
> 时间：2012-10-15T20:50:50.253
> 
> 标签：php, gd

我想使用 PHP 和 GD 库在图像中打黑色（使黑色和近黑色更暗），但我不太确定应该使用 GD 库中的哪些方法来完成此操作。我的目标是基本上创建与 Photoshop 在执行以下操作时相同的功能：

1.  在 PS 中打开图像
2.  转到图像 -> 调整 -> 可选颜色
3.  从下拉列表中选择黑人
4.  选择相对或绝对算法
5.  向右拖动黑色滑块以增加、加深或打孔黑色。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T22:03:12.983

您可以使用 ImageMagic 来提供类似的绝对效果.. 不确定相对

```
 convert a.png -level 20%,95%,0.8 al.png 
```

![在此处输入图像描述](../Images/005287bce7e0cd543b88a1de2244ade3.png)![在此处输入图像描述](../Images/f02be854b81f562c230ed44fb7ffd34d.png)

# git - TortoiseGit 的两个身份

> ID：12903775
> 
> 赞同：1
> 
> 时间：2012-10-15T20:50:51.983
> 
> 标签：git, tortoisegit

我有两个存储库，在提交时我希望每个存储库都有不同的身份，我可以将其配置为根据目录路径或某种方式选择身份吗？

我在 Windows 上使用 TortoiseGit，身份可以在`Settings > GIT`

我看到的东西`"edit local .git/config"`是我想要的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T22:55:59.157

是的，您可以`.git/config`使用以下项目编辑本地存储库文件以设置本地身份：

```
[user]
    email = <your email>
    name = <your name> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-16T01:37:21.920

在每个项目中，右键单击 Explorer 上下文菜单 -> TortoiseGit -> 设置 在树形视图中，选择 Git，输入名称和电子邮件，单击确定。然后，您可以为两个存储库中的每一个拥有独立的名称和电子邮件。确保选择配置源“本地”。

# linear-algebra - hlsl点函数

> ID：12903776
> 
> 赞同：3
> 
> 时间：2012-10-15T20:50:57.530
> 
> 标签：linear-algebra, hlsl

我正在查看在 DirectX SDK 中找到的效果文件，唯一真正让我震惊的部分是`Dot()`函数。这使我进入了一个关于点积的维基百科页面，这对我来说毫无意义。什么是点积？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T20:52:32.277

它被定义为标量积的总和：例如对于 float3 向量 A 和 B，dot(A,B) 等于 (Ax*Bx + Ay*By + Az*Bz)。

点积被 HLSL 用作矩阵乘法的组成部分，如果两个输入都被归一化，dot() 的一个很好的特性是 dot(A,B) 将等于向量 A 和 B 之间角度的余弦（在照明中使用了很多）

# liferay-6 - 我如何在 Liferay 中使用不同的文件存储和检索 API？

> ID：12903778
> 
> 赞同：3
> 
> 时间：2012-10-15T20:51:06.307
> 
> 标签：liferay-6

在开发 Liferay portlet 时，有时您想使用文件工件。例如，您可能希望拥有一个可配置的图像，或者让用户将文件附加到您的自定义服务实体的方法。

Liferay 内置了几个 API 来解决这个问题。每一个是如何使用的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-17T05:56:42.190

以下是我能想到的三种存储和检索文件的方法。

* * *

## 方法一

**存储：**
使用[`DLStoreUtil`](http://docs.liferay.com/portal/6.1/javadocs/index.html?com/liferay/portlet/documentlibrary/store/DLStoreUtil.html "API 文档：DLStoreUtil")您在[问题](https://stackoverflow.com/q/12903778/468763 "同样的问题：在 Liferay DLStore 中获取文件的 URL")中显示的方法。

**检索：**
为此，您需要将文件作为流获取，然后使用以下代码将其发送到浏览器：

```
String path = fileName;
// if there is a directory then path would be
// String path = "mydirectory/mySubDirectory/" + fileName; // mydirectory/mySubDirectory/my_File_image_name.png

InputStream inputStream = DLStoreUtil.getFileAsStream(companyId(), CompanyConstants.SYSTEM, path);

long contentLength = DLStoreUtil.getFileSize(companyId(), CompanyConstants.SYSTEM, path);

String contentType = MimeTypesUtil.getContentType(fileName);

ServletResponseUtil.sendFile(request, response, fileName, inputStream, contentLength, contentType); 
```

Liferay 使用上述方法为其`Message Boards`portlet 下载附件。[你可以在这里](https://github.com/liferay/liferay-portal/blob/6.1.x/portal-impl/src/com/liferay/portlet/messageboards/action/GetMessageAttachmentAction.java#L91 "在 Liferay 的留言板 portlet 中下载附件的源代码")查看源代码。我没有尝试过，但我想您可以在`serveResource`您的 portlet 的方法中编写此代码，然后提供`resourceURL`作为 URL 下载或在`<img>`标记中使用它。

* * *

## 方法二：使用[`DLAppService`](http://docs.liferay.com/portal/6.1/javadocs/index.html?com/liferay/portlet/documentlibrary/service/DLAppService.html "Liferay API 文档：DLAppService")

如果您使用此方法，则该文件的`DLFileEntry`表中将有一个数据库条目，并且该文件也将出现在`Documents & Media`portlet 中。

**存储：**
添加文件的示例代码：

```
FileEntry = DLAppServiceUtil.addFileEntry(repositoryId, folderId, sourceFileName, mimeType, title, description, changeLog, bytes, serviceContext); 
```

[您可以在此处](http://docs.liferay.com/portal/6.1/javadocs/index.html?com/liferay/portlet/documentlibrary/service/DLAppServiceUtil.html "Liferay API 文档：DLAppServiceUtil")查看其他方法和类。

**检索：**
如this [answer](https://stackoverflow.com/a/11932143/468763 "回答：如何以编程方式获取文档库内容的下载 url")中所述。

* * *

## 方法3：使用[`ImageLocalService`](http://docs.liferay.com/portal/6.1/javadocs/com/liferay/portal/service/ImageLocalService.html "Liferay API 文档：ImageLocalService")（专门用于图像）

对于此方法，您需要将 ImageID 存储在某处以供以后检索图像。

**存储：**
以下是在liferay中添加/更新图像的方法：

```
// to Add an image
long imageID = 0;
imageID = CounterLocalServiceUtil.increment();
ImageLocalServiceUtil.updateImage(imageID, bytes);

// to update the same image, pass the existing Image ID
ImageLocalServiceUtil.updateImage(existingImageID, bytes); 
```

**恢复：**

您可以在 JSP 中编写以下代码：

```
<img alt="My Image"
     id="myImgID"
     title="This my image stored in liferay"
     src="<%=themeDisplay.getPathImage()%>/any_string_will_do_?img_id=<%=myImageId%>&img_timestamp=<%=someTimestampOrRandomString %>" /> 
```

***注意：*** `img_timestamp=<%=someTimestampOrRandomString %>"` , 此字符串是可选参数 & 可以跳过。
这是为了让浏览器在每次刷新页面时从服务器而不是浏览器缓存中检索图像。

希望这可以帮助。

# ruby-on-rails - 零星 Capybara::Driver::Webkit::WebkitInvalidResponseError: 无法加载 URL：

> ID：12903779
> 
> 赞同：2
> 
> 时间：2012-10-15T20:51:15.447
> 
> 标签：ruby-on-rails, testing, rspec, capybara-webkit

我有一个偶尔会抛出`Capybara::Driver::Webkit::WebkitInvalidResponseError:Unable to load URL:`错误的测试。

有时测试通过就好了，我会重新运行测试，它会失败。

我试过暂停我的 rspec 运行，打开一个测试服务器，并且可以手动完成测试就好了。

我正在使用 webkit 驱动程序、mac os x mountain lion、rspec2、rails 3.2.1 和 ruby​​ 1.9.2。

# java - Docx4j 以编程方式添加 w:sdt 内容控件

> ID：12903781
> 
> 赞同：3
> 
> 时间：2012-10-15T20:51:26.447
> 
> 标签：java, ms-word, openxml, docx, docx4j

我正在构建一个小型 java 程序来测试我需要用 docx4j 覆盖的所有“文档相关”功能，以满足我的项目要求。摘要：能够创建带有“内容控件”的模板，这些模板将作为“原始模板”提供给用户。让用户增强它们，最终用数据填充它们。由于“重复和条件”功能，我正在处理“docx4j”。

这是我的进步，以编程方式：

1）创建一个空白文档（完成）

2) 添加带有 xml 数据的自定义 xml 部件（发票示例中的 part3.xml）。（完毕）

3) 添加带有 xml xpaths 参考的自定义 xml 部件（发票示例中的 part4.xml）。（完毕）

4）添加内容控件（PENDING）

它必须类似于发票示例中的以下摘录：

```
<w:sdt>
  <w:sdtPr>
    <w:alias w:val="Customer name" />
    <w:tag w:val="od:xpath=x1&customer name=customer name" />
    <w:id w:val="1418037941" />
    <w:placeholder>
      <w:docPart w:val="DefaultPlaceholder_22675703" />
    </w:placeholder>
    <w:dataBinding w:xpath="/invoice[1]/customer[1]/name[1]" w:storeItemID="{8B049945-9DFE-4726-9DE9-CF5691E53858}" />
    <w:text />
  </w:sdtPr>
  <w:sdtContent>
    <w:p>
      <w:r>
        <w:t>Joe Bloggs</w:t>
     </w:r>
    </w:p>
  </w:sdtContent>
</w:sdt> 
```

这是我的问题：如何生成这个 xml ？可以通过 Java 代码完成还是只能从 Word 完成？“1418037941”和“DefaultPlaceholder_22675703”值是什么以及如何生成的？我想我不能“发明”它们，并在其他地方被引用。我正在 MainDocumentPart 类中寻找一些方法来执行此操作，但找不到它。我误解了什么吗？

其他步骤对我来说几乎没问题：

5）执行“预处理”（完成）

6）执行“过程”（完成）

7）执行“strip”（完成，除了删除repat标签）

非常感谢您的帮助！大卫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-16T06:51:08.560

您当然可以使用 docx4j 以编程方式创建内容控件。也就是说，创建“模板”的常用方法是使用创作工具，例如[这个](http://www.opendope.org/downloads/authoring-friendly/setup.exe).

要回答您的具体问题：-

*   您可以省略 w:placeholder。

*   规范说 w:id 是 xsd:int 类型，是介于 -2147483648 和 2147483647 之间的整数。您可以随机生成它，或者也[可以](http://msdn.microsoft.com/en-us/library/documentformat.openxml.wordprocessing.sdtid)将其省略。

# asp.net-mvc-3 - 使用 Ninject 将参数传递给控制器 构造函数

> ID：12903785
> 
> 赞同：2
> 
> 时间：2012-10-15T20:51:31.610
> 
> 标签：asp.net-mvc-3, ninject

这是一个 MVC 应用程序，其中控制器在构造函数中需要 a`DataContextCreator`和 a `CustomerID`。我的`ControllerFactory`样子：

```
public class NinjectControllerFactory : DefaultControllerFactory
    {
        private IKernel ninjectKernel;

        public NinjectControllerFactory()
        {
            ninjectKernel = new StandardKernel();
            AddBindings();
        }

        protected override IController GetControllerInstance(RequestContext requestContext, Type controllerType)
        {
            if (controllerType == null)
            {
                return null;
            }
            else
            {
                string customerID =  requestContext.HttpContext.Session["CustomerID"].ToString();
                return (IController)ninjectKernel.Get(controllerType, new IParameter[]{new Parameter("CustomerID", customerID, true)});
            }
        }

        private void AddBindings()
        {
            ninjectKernel.Bind<IDataContextCreator>().To<DefaultDataContextCreator>();
        }
    } 
```

导航到页面时出现以下错误，即触发控制器的创建：

```
 Ninject.ActivationException: Error activating int
No matching bindings are available, and the type is not self-bindable.
Activation path:
 2) Injection of dependency int into parameter CustomerID of constructor of type MyController
 1) Request for MyController 
```

以上所有内容都是在 Win 7 上使用 MVC3 .Net 4。感谢您的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-15T21:11:35.687

为什么要编写自定义控制器工厂？`Ninject.MVC3`这在使用NuGet 包时并不常见。一种更常见的技术是使用安装此 NuGet 时自动为您注册的自定义依赖项提供程序。

所以这里是步骤：

1.  摆脱您的自定义控制器工厂
2.  安装`Ninject.MVC3`NuGet 包。
3.  在`~/App_Start/NinjectWebCommon.cs`文件中配置你的内核

    ```
    private static void RegisterServices(IKernel kernel)
    {
        kernel
            .Bind<IDataContextCreator>()
            .To<DefaultDataContextCreator>();
        kernel
            .Bind<MyController>()
            .ToSelf()
            .WithConstructorArgument("customerID", ctx => HttpContext.Current.Session["CustomerID"]);
    } 
    ```

# ruby-on-rails-3.2 - 如何避免属性而不将其传递到表单中

> ID：12903789
> 
> 赞同：0
> 
> 时间：2012-10-15T20:51:47.913
> 
> 标签：ruby-on-rails-3.2, formtastic

我正在开发 Rails 应用程序。我有一个复选框，格式如下：

```
<td><%= b.check_box :chkbx, label: false, checked: false %></td> 
```

提交表格时。我需要避免在帖子中传递复选框名称参数。

如何避免复选框属性将其传递到表单中？

谁能帮我？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T17:33:50.163

如果您不想在提交表单时发送复选框的值，则必须在提交表单之前禁用该复选框。

例如，使用 jQuery，您可以执行以下操作（使其适应您的代码）

```
$('form').submit(function() {
    $('#check_box_false').prop('disabled', true); 
}); 
```

如果可以，另一种解决方案是将复选框放在`<form>...</form>`标签之外。

# c# - 在 Windows 8 中向数据模板添加视觉状态

> ID：12903791
> 
> 赞同：4
> 
> 时间：2012-10-15T20:52:02.450
> 
> 标签：c#, xaml, windows-8, datatemplate

我正在尝试向我的 Windows 8 应用程序添加鼠标悬停效果。具体来说，我正在尝试将其添加到绑定到 GridView 的 DataTemplates 中。但是，目前，什么都没有发生，我尝试遵循 Microsoft 教程，但其中大多数要么已过时，要么适用于不同版本的 XAML。

我的代码如下所示：

```
<DataTemplate x:Key="GameTileTemplate">
    <Grid x:Name="grid" Width="173" Height="173" RenderTransformOrigin="0.5,0.5" >
        <Grid.Clip>
            <RectangleGeometry Rect="0,0,173,173"/>
        </Grid.Clip>
        <Image Grid.RowSpan="3" Stretch="UniformToFill"/>
        <Grid x:Name="DataPanel" Margin="-173,0,0,0" Grid.RowSpan="3" RenderTransformOrigin="0.5,0.5" Width="346" HorizontalAlignment="Left" VerticalAlignment="Top" Height="173">
            <!--There is more here-->
        </Grid>
        <VisualStateManager.VisualStateGroups>
            <VisualStateGroup x:Name="CommonStateGroup">
                <VisualState x:Name="Normal" />
                <VisualState x:Name="PointerEntered">
                    <Storyboard>
                        <DoubleAnimation From="1" To="0" Duration="00:00:02" 
                             Storyboard.TargetName="DataPanel" 
                             Storyboard.TargetProperty="Opacity">
                        </DoubleAnimation>
                    </Storyboard>
                </VisualState>
            </VisualStateGroup>
        </VisualStateManager.VisualStateGroups>
    </Grid>
</DataTemplate> 
```

我的 DataPanel 的不透明度没有改变。我在某处需要其他代码吗？Microsoft 教程是针对 ControlTemplate 的，由于我的模板是 DataTemplate，这是否会导致错误？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T21:41:02.100

您在问题中提供的 Xaml 不会自行工作。仅仅定义视觉状态是不够的。您还需要某种代码来调用[VisualStateManager.GoToState](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.visualstatemanager.gotostate)。

在您的特定情况下，解决方案不是添加视觉状态`DataTemplate`，而是为[GridViewItem](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.gridviewitem.aspx)创建自定义模板。一般`GridViewItem`负责用常用的指针、选择、拖放状态来装饰 GridView 内部的元素。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-09-27T09:18:40.987

添加 UserControl 应答器它可以工作，（不知道为什么）

```
 <DataTemplate x:Key="GameTileTemplate">
<UserControl>
<Grid x:Name="grid" Width="173" Height="173" RenderTransformOrigin="0.5,0.5" >
        <Grid.Clip>
....

...
 </VisualStateManager.VisualStateGroups>
    </Grid>
</UserControl>
</DataTemplate> 
```

# javascript - Javascript - if (arg.match(/^\/.*/)) {}

> ID：12903794
> 
> 赞同：-2
> 
> 时间：2012-10-15T20:52:25.757
> 
> 标签：javascript, regex

我正在使用 nodejs 进行 API 测试。为了测试这个`if`语句的内容，我需要找到一个匹配这个正则表达式的字符串。

```
if (arg.match(/^\/.*/)) {
    // ...
} 
```

谁能建议一个匹配的字符串？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T21:03:56.440

该模式将匹配任何以正斜杠开头的字符串。试试`/foo`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-15T21:21:24.203

使用[http://regexpad.com](http://regexpad.com)测试您的正则表达式。它将直接向您显示匹配的文本。

在这种情况下`/a`，例如。

永久链接到您的示例**http://regexpad.com/?r=^\%2F.*&f=&m0=%2Fa#p-javascript**

# c# - 如何编写 C# 应用程序以通过 USB 连接的红外发射器更改卫星机顶盒上的频道

> ID：12903795
> 
> 赞同：1
> 
> 时间：2012-10-15T20:52:26.260
> 
> 标签：c#, infrared

我想编写一个 C# 应用程序，当单击“按钮 X”时，“信号 X”从 USB 连接的红外发射器传输。我在[Tira-2.1](http://www.home-electro.com/tira2.php)和[USB-UIRT](http://www.usbuirt.com/)上找到了几个不同的 IR 发射器，但我不确定如何对应用程序进行编程以通过这些设备进行传输。要清楚。我希望我的计算机根据人类与应用程序的交互来发送信号。我不希望计算机对从遥控器到计算机的输入进行操作。我也知道红外 MCE 不是答案，Microsoft IrDA*** 也不是任何功能，所以请不要将这些作为可能的答案。任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T21:03:19.990

理论上，IR 发射器需要为您提供您在项目中引用的 dll。他们还需要提供一些代码示例，以执行 X 动作的频率传输。这只是理论。

# vb.net - 在 VB.NET 中选中多个复选框时，如何显示复选框的最高平均值？

> ID：12903796
> 
> 赞同：0
> 
> 时间：2012-10-15T20:52:41.840
> 
> 标签：vb.net

嗨，我正在尝试制作一个有 6 个复选框的程序，当一个复选框被选中时，标签会显示演员的平均值，但如果选中多个复选框，则标签只会显示选中框的最高平均值。

```
 Private Sub CheckBox1_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles CheckBox1.CheckedChanged

    SC = ((Val(425488741) + Val(555909803) + Val(868659354) + Val(966435555) + Val(720388023) + Val(617520987)) / 6)

    If CheckBox1.Checked = True Then

        Label3.Text = "Sean Connery $" & SC

        Exit Sub

    End If

End Sub

Private Sub CheckBox2_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles CheckBox2.CheckedChanged

    GL = 513445231

    If CheckBox2.Checked = True Then

        Label3.Text = "George Lazenby $" & GL

        Exit Sub

    End If

End Sub

Private Sub CheckBox3_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles CheckBox3.CheckedChanged

    RM = ((Val(785677477) + (426826774) + (666367656)  + (624527272) + (481005579) + (405873493) + (316186616)) / 7)

    If CheckBox3.Checked = True Then

        Label3.Text = "Roger Moore $" & RM

        Exit Sub

    End If

End Sub

Private Sub CheckBox4_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles CheckBox4.CheckedChanged

    TD = ((Val(362876056) + (271586451)) / 2)

    If CheckBox4.Checked = True Then

        Label3.Text = "Timothy Dalton $" & TD

        Exit Sub

    End If

End Sub

Private Sub CheckBox5_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles CheckBox5.CheckedChanged

    PB = ((Val(499954330) + (465588535) + (504705882)  + (546490272)) / 4)

    If CheckBox5.Checked = True Then

        Label3.Text = "Pierce Brosnan $" & PB

        Exit Sub

    End If

End Sub

Private Sub CheckBox6_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles CheckBox6.CheckedChanged

    DC = ((Val(640803677) + (586090727)) / 2)

    If CheckBox6.Checked = True Then

        Label3.Text = "Daniel Craig $" & DC

        Exit Sub

    End If

 End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T12:34:30.470

**详细信息：** Saulius 是正确的，因为您应该使用数据库，并且应该使用选中列表框来使其更容易。但是，我只是假设您出于任何原因都想使用单独的复选框。

**解决方案：**

创建一个 Actor 类

```
Public Class Actor
   Property Name As String
   Property TotalValue As Double
End Class 
```

在你的主要形式

```
Public Sub DisplayHighestPaidActor(ByVal actorName As String, ByVal isChecked As Boolean)

    If isChecked Then
        'Add the Actor
        selectedActors.Add((From actor In allActors
                            Where actor.Name = actorName).FirstOrDefault())

        'Order the Actors
        selectedActors = (From actor In selectedActors
                          Order By actor.TotalValue Descending).ToList()
    Else
        'Remove the Actor
        selectedActors.Remove((From actor In allActors
                               Where actor.Name = actorName).FirstOrDefault())

        'Order the Actors
        selectedActors = (From actor In selectedActors
                          Order By actor.TotalValue Descending).ToList()

    End If

    If (selectedActors.Count > 0) Then

        'Display the highest value
        lblHighestPaidActor.Text = selectedActors.Item(0).Name.ToString() _
                          + " $" + selectedActors.Item(0).TotalValue.ToString()
    Else
        lblHighestPaidActor.Text = ""
    End If

End Sub

Private Sub CheckBox1_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles CheckBox1.CheckedChanged

    DisplayHighestPaidActor("Sean Connery", CheckBox1.Checked)

End Sub

Private Sub CheckBox2_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles CheckBox2.CheckedChanged

    DisplayHighestPaidActor("George Lazenby", CheckBox2.Checked)

End Sub

Private Sub CheckBox3_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles CheckBox3.CheckedChanged

    DisplayHighestPaidActor("Roger Moore", CheckBox3.Checked)

End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T23:01:31.480

以后在提问时，请不要包含所有不必要的细节。如果正确理解您的问题，这是一种可能的简单解决方案：

```
Dim incomes = New Integer() {100, 2000, 500}
Dim names = New String() {"John", "Tim", "Allan"}

Private Sub CheckedListBox1_SelectedIndexChanged(sender As System.Object, e As System.EventArgs) Handles CheckedListBox1.SelectedIndexChanged
    Dim maxIncome As Integer = 0
    Dim name As String = ""

    For i = 0 To incomes.Length - 1
        If CheckedListBox1.GetItemChecked(i) And incomes(i) > maxIncome Then
            maxIncome = incomes(i)
            name = names(i)
        End If
    Next

    Label1.Text = name & " $" & maxIncome
End Sub 
```

要使此代码正常工作，您需要在其集合中创建一个包含 3 个项目的 CheckedListBox。但是，一旦有很多值，这种方法可能会导致代码非常糟糕。在这种情况下，您应该使用数据库或至少使用如下结构：

```
Structure People
    Dim name As String
    Dim income As Integer
    Dim checkBox As CheckBox
End Structure 
```

此外，无需`Exit Sub`在代码中的任何地方编写，它什么也不做。

# c# - 我最近在 Visual Studio C# 中更改了自动生成的命名空间，现在我在第 0 行和第 0 列出现错误

> ID：12903797
> 
> 赞同：0
> 
> 时间：2012-10-15T20:52:49.130
> 
> 标签：c#, .net, winforms

我最近（从to ）更改了两个文件（`GuiMenu.cs`和）中的名称空间，但直到现在我才收到这样的警告：`GuiMenu.Designer.cs``MyProject.GuiMenu``GUI`

```
Warning 1   The designer could not be shown for this file because none of the classes within it can be designed.  The designer inspected the following classes in the file: 

PropetiesWindow --- The base class 'MyProject.GuiMenu' could not be loaded.  
Ensure the assembly has been referenced and that all projects have been built.
Line 0 Column 0 
```

看起来视觉工作室不喜欢这个命名空间，并试图使用旧的。怎么了 ？顺便说一句，最近我有这样的警告：找不到课程`MyProject.GuiMenu.MyClass`。但是这个类存在于 中`GUI.MyClass`，幸运的是这个警告已经消失了。PS：我试图从对象中删除 bin 和 obj 文件夹，没有帮助。

# css - DIV 中显示的滚动条。什么CSS导致了这个？

> ID：12903801
> 
> 赞同：0
> 
> 时间：2012-10-15T20:53:13.357
> 
> 标签：css

在这个网页上，我构建了一个滚动条，似乎出现在#content DIV 中，我似乎不知道为什么。

页面链接：[http](http://dev.textcube.ch/oneandonly/index.php/hunde/nuri/) ://dev.textcube.ch/oneandonly/index.php/hunde/nuri/（用户名：textcube/密码：textcube3600）

#content 的 CSS 没有任何可能导致此问题的设置高度，也没有溢出：滚动；。

```
#content {
font-family: Arial, Helvetica, sans-serif;
font-size: 100%;
width: 400px;
margin: 0px;
background: url(../images/content-bg.png) no-repeat;
margin-top: 10px;
margin-left: 100px;
float: left;
padding: 80px 50px 0px 50px;
} 
```

关于造成这种情况的任何想法？理想情况下，我想知道如何删除此滚动条并使内容一直向下移动。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T20:56:20.797

这个 CSS 导致了它。由于内容长于`270px`滚动条出现。

```
<style type="text/css"> 
#blockStyle404MainArea9 {
  background-repeat:no-repeat;
  max-height: 270px;
  over-flow: auto;
  overflow-x: hidden;
  overflow-y: scroll;
} 
</style> 
```

# linux - 是否有适用于 linux 的免费或开源 SERM 建模工具？

> ID：12903804
> 
> 赞同：2
> 
> 时间：2012-10-15T20:53:32.170
> 
> 标签：linux, modeling

我正在为 linux 寻找一个好的[SERM](http://en.wikipedia.org/wiki/Structured-Entity-Relationship-Model)建模工具。有没有？哪个最好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T17:48:11.510

[**Open ModelSphere**](http://www.modelsphere.org/) may be the lone mature tool that fits the requirements...

*   open source (under GPL)
*   run on Linux: cross platform, actually, since it is Java-based.
*   standard fare for typical modeling tools, including forward and backward engineering and validation.
*   No *explicit* support for SERM, but ability to introduce new notations. Several of the notations readily included appear to be relatively close to [what I understand] SERM is.

This last point might be the show-stopper... hopefully this suggestion can be be a starting point.

**Disclosure**:
I'm no modeling wizard, merely an occasional user of modeling tools typically included in software development IDEs. Also, I'm not versed in SERM in particular, and unsure of its subtle (or so subtle) differences with other modeling metamodels.
I would typically remain an interested spectator of this type of questions, but in view of the little attention it has received so far (and in view of the +50 bounty, right!) I'm kindly posting the above with the intent of maybe stirring things a bit. I'll be glad to delete this answer, amend it as suggested and otherwise try and help with generating traffic in this direction.
If nothing else, this answer may prompt Anton Bessonov to elaborate a bit on specific uses and capabilities would be relevant to his quest.

# javascript - jQuery/Javascript - 如何从新的滚动条中减去旧的滚动条

> ID：12903805
> 
> 赞同：1
> 
> 时间：2012-10-15T20:53:32.200
> 
> 标签：javascript, jquery, scrolltop

我有一个非常简单的问题，但我似乎无法弄清楚。每次用户滚动时，scrollTop 都会发生变化。我想从 scrollTop 的新值中减去旧值。但是我如何存储旧值，以便在用户停止滚动后从新值中减去它？必须有一个简单的方法。

```
$(function(){
  $(window).scroll(function(){
      var curTop = $(window).scrollTop();
      var newTop = (curTop - curTop);
      console.log(newTop);  
   });
}); 
```

这显然是行不通的。你们有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T21:06:51.650

这应该工作：

```
$(function(){
  var curTop = $(window).scrollTop();
  $(window).scroll(function(){
      var newTop = $(window).scrollTop();
      var diff = newTop - curTop;
      curTop = newTop;
      console.log(diff);
   });
}); 
```

它存储当前的`curTop`滚动顶部，并在计算新旧滚动顶部的差异后在每个滚动事件上更新它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T20:59:40.023

在函数范围之外，在全局范围内定义 oldScrollTop 并在每次调用函数时更新它，在您使用数据进行计算之后。

这样，“旧”值将从一个函数调用到另一个函数调用保持存储在全局范围内。通过全局范围，我的意思是在任何函数调用之外，甚至在 jquery 的 document.ready 之外

# c# - C# 构造函数中的延迟设置

> ID：12903807
> 
> 赞同：2
> 
> 时间：2012-10-15T20:53:59.230
> 
> 标签：c#

您好，我想知道如何在构造函数中设置几件事，但要等到对象创建后。我正在按照我的 C++ 和 QT 天的思路思考，我将创建一个 0 秒的单次计时器，一旦构建对象就会触发我的设置方法。我可以在 C# 中做到这一点吗？

我不介意做我在构造函数中所做的所有工作，只是看看是否有更好的方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T20:56:49.373

在 C# 中，整个对象是在执行构造函数之前创建的 - 所有字段都使用它们的默认值或初始值（如果有）进行初始化。如果您想延迟某些事情，请考虑使用[延迟初始化](http://msdn.microsoft.com/en-us/library/dd642331.aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-15T20:55:52.730

我不确定将你的东西放在构造函数中的问题是什么 - 你无能为力。也许您为什么要这样做/您遇到什么问题的一个例子可以让我们给您一个更合适的答案。

虽然如果你真的需要延迟代码，

```
public constructor()
{
    Task.Factory.StartNew(()=>
    {
        Thread.Sleep(...delay...);
        //delayed code
    });
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-15T21:01:04.047

One way to do what you are asking is to have a static method that constructs the desired object:

```
class MyObject {
    private MyObject() {

    }

    private void Setup() {
        // do some configuration here
    }

    public static MyObject CreateObject() {
        MyObject obj = new MyObject();
        obj.Setup();
        return obj;   
    }
} 
```

Thus, you never use the class' actual constructor but instead invoke the static method that creates the object and sets it up at the same time. I am not sure why you would want to do this though, since the effect from the point of view of the caller is the same -- you wait until the object is created and its setup is complete to be able to use it.

# java - Java - charAt 有多个答案

> ID：12903812
> 
> 赞同：0
> 
> 时间：2012-10-15T20:54:21.593
> 
> 标签：java

我的代码有问题，我正在尝试测试 char 中的位置是否等于整数。我设置它的方式是这样的：

```
 for(int i = 0; i < str.length(); i++) {
        if(str.charAt(i) == '[1234567890]') {
            System.out.println(str);
        }
    } 
```

但是，当我尝试编译时，我收到错误“未封闭的字符文字”。有谁知道我为什么会出错，或者可以解释一个更简单的方法来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T20:57:07.983

尝试：

```
if ( Character.isDigit(str.charAt(i)) ) 
```

您必须检查每个字符是否都是数字，以检查您的字符串是否包含整数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-15T20:55:52.793

`'[1234567890]'`不是一个`char`。A`char`是单个字符。这就是您的代码无法编译的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T21:01:02.820

Your code cannot be compiled because in java character `'` ( single quote ) is used to mark one character. In order to define string you should use double quote `"`.

In your case I believe that you wanted to check whether your string contains digits only and were confused with regular expression syntax you tried to use incorrectly.

You can either rewirte your if statement as following:

char c = str.charAt(i); `if(c>= '0' && c <= 9) {`

or use pattern matching, e.g. `Pattern.compile("\\d+").matcher(str).matches()`

In this case you even do not need to implement any loop.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-15T21:13:28.590

我认为您正在尝试编写如下简单的内容：

```
for(int i = 0; i < str.length(); i++) {
    //check str.charAt(i) is one of the chars in 1234567890
    if("1234567890".indexOf(str.charAt(i))>=0) {   
        System.out.println(str.charAt(i));
    }
 } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-15T20:58:11.717

您似乎正在尝试在字符文字中使用正则表达式表示法。那是行不通的。如果你想使用正则表达式，你可以写：

```
 if(str.substring(i, i+1).matches("[1234567890]") { 
```

但写起来更好/更简单/更快/更清晰：

```
 if(Character.isDigit(str.charAt(i))) { 
```

另一方面，即使您进行了此更改，`str`如果您的代码包含多个数字，它也会打印多次。那真的是你想要的吗？我想知道你是否想要更多这样的东西：

```
 if(str.matches("\d+"))
         System.out.println(str); 
```

*如果它的所有*字符都是数字，它将打印`str`一次。

# c++ - 制作一个像流一样的 C++ 宏

> ID：12903814
> 
> 赞同：6
> 
> 时间：2012-10-15T20:54:25.337
> 
> 标签：c++, c, macros, g++

在没有谷歌帮助的情况下，我想知道是否有人可以告诉我是否可以创建一个 C++ (g++) 调试宏，例如，一个“改进的”std::cout。想法是通过 << 接受 args 并附加一些文本，以便

```
DBG << "Hello" << world; 
```

可能会产生

```
myfile.cpp 1420 Hello world 
```

我知道那里有做这种事情的日志库（？）/宏（？）。我对它是如何完成的感兴趣，而不是使用一些包。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-15T21:09:42.790

您的宏可以创建一个`endl`在销毁时调用的临时变量。临时将一直存在，直到封闭表达式结束，通常在`;`.

```
#include <iostream>

struct X {
  ~X() { std::cout << std::endl; }
};

#define DBG (X(), std::cout << __FILE__ << " " << __LINE__ << " ")

int main () {
  std::string world(", world");
  DBG << "Hello" << world;
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-15T20:55:39.313

怎么样：

```
#define DBG std::cout << __FILE__ << " " << __LINE__ << " " 
```

[http://ideone.com/mN5n3](http://ideone.com/mN5n3)

足够接近！不幸的是，您必须`world`事先声明变量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-15T21:10:05.440

调试宏背后的想法是，如果您处于发布模式，它应该编译为空。尝试这个;

```
#ifdef _DEBUG
    #define MESSAGE(x) (std::cout << __FILE__ << " " << __LINE__ << " " << x);
#else
    #define MESSAGE(x) ;
#endif

int _tmain(int argc, _TCHAR* argv[])
{
    MESSAGE("Hello");
    return 0;
} 
```

当你处于发布模式时，`MESSAGE(x)`不会有任何影响，但在调试模式下，你会收到一条消息到命令行。

# c# - .NET 4.0 - Directory.GetFiles 的结果是否总是保证按文件名排序？

> ID：12903816
> 
> 赞同：2
> 
> 时间：2012-10-15T20:54:26.410
> 
> 标签：c#, .net, sorting, io

我想知道，在 .NET 4.0+ 中，是否`Directory.GetFiles`总是保证按文件名升序排序的结果？

请注意，我不是在问如何对结果进行排序，我知道该怎么做（[https://stackoverflow.com/a/6294333/1203288](https://stackoverflow.com/a/6294333/1203288)），我只想知道是否必须手动对它们进行排序.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-15T20:55:52.587

没有。来自 MSDN：

> 返回文件名的顺序不保证；如果需要特定的排序顺序，请使用 Sort() 方法。

[http://msdn.microsoft.com/en-us/library/07wt70x2.aspx](http://msdn.microsoft.com/en-us/library/07wt70x2.aspx)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-15T20:55:43.117

不。从文档中[`Directory.GetFiles`](http://msdn.microsoft.com/en-us/library/07wt70x2.aspx)：

> 返回文件名的顺序不保证；如果需要特定的排序顺序，请使用 Sort() 方法。

# ios - 应用程序启动后立即崩溃

> ID：12903817
> 
> 赞同：7
> 
> 时间：2012-10-15T20:54:33.870
> 
> 标签：ios, xcode, ios6, ios-provisioning

编辑：我的问题是因为 plist 文件已损坏。所以如果你有同样的问题，可能是因为你的 plist 文件中的某些东西。

所以我有这个应用程序，一切正常，直到我将我的设备更新到 IOS 6。之后我无法在设备上安装应用程序。该应用程序在 IOS 5.0 模拟器和 IOS 6.0 模拟器上运行良好。当我尝试为设备构建它时，闪屏出现两秒钟，然后应用程序关闭。在 Xcode 中，我收到此错误：

```
timed out waiting for app to launch 
```

我在网上搜索，它说这是一个 AdHoc 配置问题，但我的配置文件是有序的。我什至更改了应用程序 ID 并删除了旧的配置，我得到了同样的错误。

在设备控制台中，我收到这个奇怪的错误：

```
Oct 15 23:48:23 iPad2-3G backboardd[51] <Warning>: Launch Services: Registered unknown app identifier InvoiceAppDev
��Oct 15 23:48:23 iPad2-3G backboardd[51] <Warning>: Launch Services: Unable to find app identifier InvoiceAppDev
Oct 15 23:48:23 iPad2-3G backboardd[51] <Warning>: Can't create application "InvoiceAppDev" without a bundle path
Oct 15 23:48:44 iPad2-3G mobile_house_arrest[200] <Error>: Max open files: 78
��Oct 15 23:48:44 iPad2-3G installd[30] <Error>: 0x2ff81000 handle_install: Install of "/var/mobile/Media/PublicStaging/InvoiceApp.app" requested by mobile_installation_proxy
Oct 15 23:48:44 iPad2-3G installd[30] <Error>: 0x2ff81000 MobileInstallationInstall_Server: Installing app InvoiceAppDev
��Oct 15 23:48:44 iPad2-3G installd[30] <Error>: Oct 15 23:48:44  SecTrustEvaluate  [leaf CriticalExtensions IssuerCommonName]
Oct 15 23:48:45 iPad2-3G installd[30] <Error>: entitlement 'application-identifier' has value not permitted by a provisioning profile
��Oct 15 23:48:45 iPad2-3G installd[30] <Error>: entitlement 'com.apple.developer.ubiquity-container-identifiers' has value not permitted by a provisioning profile 
```

我不知道发生了什么。有人知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T02:26:13.637

我看到了在 app.plist 中意外输入以下空白字段导致的相同错误：

```
+   <key>LSApplicationCategoryType</key>
+   <string></string> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-28T19:44:21.940

我有完全相同的症状。信不信由你，我将目标代码签名从分发更改为开发人员，一切都按预期工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-16T13:10:25.573

谢谢@nycynik - 这解决了问题。在 xcode 中打开“Organizer”，选择设备（例如 iPhone），选择“Application”并删除以前版本的 App。不如再跑。

# java - 这里使用什么值作为参考来计算颜色代码？

> ID：12903820
> 
> 赞同：0
> 
> 时间：2012-10-15T20:54:42.557
> 
> 标签：java, colors

我得到了一个 .jar 文件，它从图像中生成一个整数颜色代码矩阵。

我可以看出黑色值为-16777216，白色为-1。但是，**我以前从未见过用于颜色代码的此类值**。

我看不到 .jar 文件中的代码。

本来可以在 Graphic Design SE 之类的地方问这个问题，但我想这里的编码员以前更有可能遇到过类似的问题。

我想找到参考“table/whatever”的原因是因为我希望能够根据这些值获取颜色名称。

**编辑**：这是我得到的一些颜色：

*   黑色是-16777216
*   红色是-65536
*   绿色是-16711936
*   蓝色是-16776961
*   白色是-1

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-15T20:59:58.967

以十六进制格式给出颜色值更容易理解，用“0x”指定，后跟 0-9 或 AF。这里，黑色是 0xFF000000，白色是 0xFFFFFFFF。格式为 0xAARRGGBB，其中“AA”是“alpha”分量的两个十六进制数字（00 是完全透明的，FF 是完全不透明的），“RR”、“GG”和“BB”是红色/绿色/蓝色组件，分别。

0xFF000000 恰好是 -16777216，而 0xFFFFFFFF 是 -1。

编辑：固定 -16777216 值。

# javascript - 函数计算器的 Jquery 事件

> ID：12903823
> 
> 赞同：0
> 
> 时间：2012-10-15T20:54:49.670
> 
> 标签：javascript, jquery, calculator, jeditable

我有这张[表](http://jsfiddle.net/Manna/QBGG3/)，但我无法在 td 中使用函数计算器。

该脚本运行良好，但是当我编辑单元格中的数字时（只需单击单元格以获取输入数字），我没有得到总结果。你能解释一下我应该将哪个事件应用于我的 jeditable 插件吗？你知道实现这一目标的不同或更好的方法吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T22:04:44.607

您应该使用`callback`事件并分配适当的事件处理程序来计算总数。检查此代码是否有效，如果认为需要添加更多操作。你的代码对我来说很奇怪，但无论如何它都有效。函数`tally`应该在`onrender` `$(function(){ ... });`块外部定义为全局函数。

```
<script type="text/javascript">
    function tally (selector) {
      $(selector).each(function () {
          var total = 0,
          column = $(this).siblings(selector).andSelf().index(this);
          $(this).parents().prevUntil(':has(' + selector + ')').each(function () {
            total += parseFloat($('p#sum:eq(' + column + ')', this).html()) || 0;
          })
          $(this).html(total);
     });
    }

    $(function() {
      tally('p#subtotal');
      tally('p#total');
    });
</script>

<script type="text/javascript" charset="utf-8">
$(function() {
    $('.editable_number').editable(function(value, settings) { return(value); }, {
      type    : 'number',
      style  : "inherit",
      callback: function() {
        tally('p#subtotal');
        tally('p#total');
      }
     }
    );

    $('.editable_textarea').editable(function(value, settings)  { return(value); }, {
     type    : 'textarea',
     width: '200',
     height: '20',
     submit  : 'OK',
     style  : "inherit"
 });
});
</script> 
```

# php - CakePHP 否定的正则表达式不起作用

> ID：12903827
> 
> 赞同：0
> 
> 时间：2012-10-15T20:55:05.987
> 
> 标签：php, regex, validation, cakephp, model

我试图强制我的模型的名字是除数字以外的任何字符，但到目前为止它没有按预期工作。当我尝试这个时：

```
public $validate = array(
    'first_name' => array(
        array(
            'rule' => array('custom', '/^[\d]+/'),
            'message' => 'Please fill in a valid first name'
        )
    )
); 
```

它不起作用，因为我可以将**4**保存为名称。如果我将否定移动到括号内，如下所示：

```
public $validate = array(
    'first_name' => array(
        array(
            'rule' => array('custom', '/[^\d]+/'), //allow anything but numbers
            'message' => 'Please fill in a valid first name'
        )
    )
); 
```

它也不起作用，因为我可以将**a4**保存为名称。那么如何在不包含两个自定义验证规则的情况下获得两全其美的效果呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T20:56:50.040

`/^[^\d]+$/`允许除数字之外的任何内容

# facebook - Facebook，登录重新加载循环

> ID：12903834
> 
> 赞同：3
> 
> 时间：2012-10-15T20:55:41.390
> 
> 标签：facebook, heroku

在 heroku 上运行的我的 facebook 应用程序存在一些未知问题

现在问题出在访问令牌上。我不确定应用程序中的某些内容似乎损坏了我的访问令牌。因为当我尝试登录应用程序，然后使用资源管理器时，它说我要么已注销，要么访问令牌已过期。但如果我调试它，它会说它的有效期还有 2 个小时。另外，我登录后页面无法重新加载。

Aparently 该网站不断重新加载.. 并一遍又一遍地更新。在页面上登录时停止

该错误似乎是最近发生的..上周没有。我猜这个问题会在这里的某个地方，但我找不到它。如果您发现任何可能导致问题的内容，请提示。谢谢

```
require_once('sdk/src/facebook.php');

$facebook = new Facebook(array(
 'appId'  => AppInfo::appID(), 
'secret' => AppInfo::appSecret(), 
'sharedSession' => true,
'trustForwarded' => true,
));

$user_id = $facebook->getUser();
if ($user_id) {
 try {
  // Fetch the viewer's basic information
    $basic = $facebook->api('/me');
 } catch (FacebookApiException $e) {
  // If the call fails we check if we still have a user. The user will be
// cleared if the error is because of an invalid accesstoken
 if (!$facebook->getUser()) {
  header('Location: '. AppInfo::getUrl($_SERVER['REQUEST_URI']));
  exit();
 }
}

 <script type="text/javascript">
  window.fbAsyncInit = function() {
    FB.init({
      appId      : '<?php echo AppInfo::appID(); ?>', // App ID
      channelUrl : '//<?php echo $_SERVER["HTTP_HOST"]; ?>/channel.html', // Channel File
      status     : true, // check login status
      cookie     : true, // enable cookies to allow the server to access the session
      xfbml      : true // parse XFBML
    });

   FB.getLoginStatus(function(response) {
    console.log (response.status);
    //this is useful if you want to avoid the infinite loop bug
    //it only reloads page when you log in
    if (response.status != 'connected') {
        FB.Event.subscribe('auth.login', function(response) {
            // We want to reload the page now so PHP can read the cookie that the
            // Javascript SDK sat. But we don't want to use
            // window.location.reload() because if this is in a canvas there was a
            // post made to this page and a reload will trigger a message to the
            // user asking if they want to send data again.
            window.location = window.location;
            //Im using the window.location.reload()
            //window.location.reload();
        });
    }
});
FB.Canvas.setAutoGrow();
 };

  // Load the SDK Asynchronously
  (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/all.js";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));
</script>
<header class="clearfix">
  <?php if (isset($basic)) { ?>
  <p id="picture" style="background-image: url(https://graph.facebook.com/<?php echo he($user_id); ?>/picture?type=normal)"></p>

  <div>
    <h1>Welcome, <strong><?php echo he(idx($basic, 'name')); ?></strong></h1>
    <p class="tagline">
      This is your new app for sorting events
      <a href="<?php echo he(idx($app_info, 'link'));?>" target="_top"><?php echo he($app_name); ?></a>
    </p>

    <div id="share-app">
      <p>Share this app:</p>
      <ul>
        <li>
          <a href="#" class="facebook-button" id="postToWall" data-url="<?php echo AppInfo::getUrl(); ?>">
            <span class="plus">Post to Wall</span>
          </a>
        </li>
        <li>
          <a href="#" class="facebook-button speech-bubble" id="sendToFriends" data-url="<?php echo AppInfo::getUrl(); ?>">
            <span class="speech-bubble">Send Message</span>
          </a>
        </li>
        <li>
          <a href="#" class="facebook-button apprequests" id="sendRequest" data-message="Prøv den her">
            <span class="apprequests">Send Requests</span>
          </a>
        </li>
      </ul>
    </div>
  </div>
  <?php } else { ?>
  <div>
    <h1>Welcome</h1>
    <div class="fb-login-button" data-scope="user_likes,user_photos,user_events,friends_events, user_hometown,user_location,user_interests,user_about_me,user_education_history,friends_location,read_friendlists"></div> 
  </div>
  <?php } ?>
</header>
<section id="get-started">
 <?php 
 //echo (idx($app_get_events[1], 'id');
 ?>

</section> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T21:08:06.203

你使用的是什么浏览器？新的 Safari 版本不接受来自 iframe 的 cookie。因此，请检查会话是否正常工作，以及是否可以创建 cookie。

# php - 仅当两者都存在时，XPath 从 HTML 中抓取两个节点值

> ID：12903836
> 
> 赞同：0
> 
> 时间：2012-10-15T20:55:51.070
> 
> 标签：php, xpath, web-scraping

我正在使用 Curl、XPath 和 PHP 来从 HTML 源代码中抓取产品名称和价格。这是一个类似于我正在检查的源代码的示例：

```
<div class="Gamesdb">
  <p class="media-title">
    <a href="/Games/Console/4-/105/Bluetooth-Headset/">Bluetooth Headset</a>
  </p>
  <p class="sub-title"> Console </p>
  <p class="rating star-50">
    <a href="/Games/Console/4-/105/Bluetooth-Headset/ProductReviews.html">(1)</a>
  </p>
  <p class="mt5">
    <span class="price-preffix">
      <a href="/Games/Console/4-/105/Bluetooth-Headset/">1 New</a>
      from 
    </span>
    <a class="wt-link" href="/Games/Console/4-/105/Bluetooth-Headset/">
      <span class="price">
        <em>£34</em>
        .99
      </span>
      <span class="free-delivery"> FREE delivery</span>
    </a>
  </p>
  <p class="mt10">
    <a class="primary button" href="/Games/Console/4-/105/Bluetooth-Headset/">
      Product Details
      <span style="color: rgb(255, 255, 255); margin-left: 6px; font-size: 16px;">»</span>
    </a>
  </p>
</div> 
```

我想提取媒体标题，即：

```
<p class="media-title">
    <a href="/Games/Console/4-/105/Bluetooth-Headset/">Bluetooth Headset</a>
    </p> 
```

仅当以下价格等级也存在时：

```
<span class="price">
    <em>£34</em>
    .99
    </span> 
```

列出的许多其他产品不包括它。我需要提取产品名称和价格，或者什么都不提取，然后转到下一个产品。

这是我当前使用的代码示例，无论其他任何条件如何，它都能有效地获得所有结果：

```
$results=file_get_contents('SCRAPEDHTML.txt');

$html = new DOMDocument();
@$html->loadHtml($results);
$xpath = new DOMXPath($html);
$nodelist = $xpath->query('//p[@class="media-title"]|//span[@class="price"]');

foreach ($nodelist as $n){

$results2[]=$n->nodeValue;

} 
```

我相信使用正确的 xpath 查询可以做到这一点，但到目前为止还无法实现。提前谢谢了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T22:06:36.153

您不能有一个 XPath 既返回产品名称又返回其价格，而没有其他任何东西。我的建议是首先获取`div`包含这两种信息的所有节点：

```
//div[p[@class='media-title'] and //span[@class='price']] 
```

('所有具有类`div`的`p`子节点和类`media-title`的`span`后代节点的节点`price`'); 然后在所有返回的节点上循环并使用另外两个 XPath 提取产品名称和价格：

```
p[@class='media-title'] 
```

和

```
//span[@class='price'] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T23:06:43.430

我假设每个`div.Gamesdb`. 如果没有，则源 html 中可能没有足够的结构来单独使用 xpath。您可能必须索引产品名称并寻找匹配产品名称附近的价格。

您可以使用单个巨型 XPath 来完成此操作，但我建议您使用多个 XPath。我将展示两种方式。

首先创建您的`DOMXPath`并注册助手以匹配类名。

```
// This helper is the equivalent to the XPath:
// contains(concat(' ',normalize-space(@attr),' '), ' $token ')
// It's not necessary, but it's a bit easier to read and more
// bulletproof than @ATTR="TOKEN"
function has_token($attr, $token)
{
    $attr = $attr[0];
    $regex = '/(?:^|\s)'.preg_quote($token,'/').'(?:\s|$)/Su';
    return (bool) preg_match($regex, $attr->value);
}

$xp = new DOMXPath($d);
$xp->registerNamespace("php", "http://php.net/xpath");
$xp->registerPHPFunctions("has_token"); 
```

然后你可以使用一个巨大的 XPath：

```
$xp_container = '/html/body//div[php:function("has_token", @class, "Gamesdb")]';
$xp_title = 'p[php:function("has_token", @class, "media-title")]';
$xp_price = '//span[php:function("has_token", @class, "price")]';

$xp_titles_prices = "$xp_container[{$xp_title}][{$xp_price}]/{$xp_title} | $xp_container[{$xp_title}][{$xp_price}]{$xp_price}";

$nodes = $xp->query($xp_items);

$items = array();

$i = 0; // enumerator
foreach ($nodes as $node) {
    $key = ($node->nodeName==='p') ? 'title' : 'price';
    $value = '';
    switch ($key) {
        case 'price':
            // remove inner whitespace
            $value = preg_replace('/\s+/Su', '', trim($node->textContent));
            break;
        case 'title':
            $value = preg_replace('/\s+/Su', ' ', trim($node->textContent));
            break;
    }
    $items[(int) floor($i/2)][$key] = $value;
    $i += 1;
} 
```

但是，整体代码很脆弱且不清楚。XPath 联合运算符 ( `|`) 按文档顺序返回节点，因此我们不能将列表一分为二。PHP 代码必须遍历节点列表中的每个项目，并使用 DOM 确定与该数据对应的字段。想想如果您想扩展代码以收集第三个项目（例如，价格），您必须进行哪些更改。现在想象一下在三个月后进行这些更改，那时这段代码在您的脑海中不再新鲜。

我建议您改为使用多个 XPath 调用，并在 PHP 而不是 XPath 中执行“我们是否有价格和标题的数据”检查：

```
$xpitems = '/html/body//div[php:function("has_token", @class, "Gamesdb")]';
// below use $xpitems context:
$xptitle = 'normalize-space(p[php:function("has_token", @class, "media-title")])';
$xpprice = 'normalize-space(//span[php:function("has_token", @class, "price")])';

$nodeitems = $xp->query($xpitems);

$items = array();
foreach ($nodeitems as $nodeitem) {
    $item = array(
        'title' => $xp->evaluate($xptitle, $nodeitem),
        'price' => str_replace(' ', '', $xp->evaluate($xpprice, $nodeitem)),
    );
        // Only add this item if we have data for *all* fields:
    if (count(array_filter($item)) === count($item)) {
        $items[] = $item;
    }
} 
```

这更容易阅读和理解，并且在未来更容易扩展。

# c++ - 使用 Qt 将 pdf 转换为 jpg 图像

> ID：12903857
> 
> 赞同：2
> 
> 时间：2012-10-15T20:56:55.250
> 
> 标签：c++, pdf, jpeg, image-conversion

标题实际上说明了一切：

我想将一个 pdf 文件转换成几个 jpg 图像。这将成为用 c++ 编码的软件的一部分（如果这很重要，我将 Qt 用于我的界面...... :)

最好我希望图像输出为 72 dpi。

有没有简单的方法可以做到这一点？

如果您需要更多信息，请发表评论，我很感激任何帮助，提示或答案！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T23:53:20.927

获取[pdf2image](http://code.google.com/p/pdf2image/)实用程序，并从您的程序中运行它，收集其输出文件。

如果你真的需要单个可执行文件（为什么？）——看看它的源代码，并从中提取所有内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T05:58:26.897

您应该尝试使用 poppler（或 xpdf）。您将完全控制渲染分辨率，并可以利用图像输出设备 (ImageOutputDev) 将页面渲染到帧缓冲区。使用 libjpeg 将此帧缓冲区保存到 jpeg 非常简单。

# ruby - 通过 ruby 中的正则表达式验证 Crontab

> ID：12903860
> 
> 赞同：-1
> 
> 时间：2012-10-15T20:57:04.753
> 
> 标签：ruby, regex, crontab

有没有办法用 ruby​​ 验证 crontab？我见过一些不错的 php 实现。

Crontabs 是相当普遍的知识，所以我会省略细节，虽然我不需要像 reboot 这样的关键字来工作。基本上只是像这样带有逗号和破折号的数字

```
0 4 25,31 12 2012-2020 
```

*   接下来的 8 个圣诞节和新年凌晨 4 点

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T21:10:04.627

阅读[Validating Crontab Entries with PHP](https://stackoverflow.com/questions/235504/validating-crontab-entries-w-php)关于这个问题。这同样适用于红宝石，因为正则表达式是一个限制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T17:26:04.250

好吧，这不是最漂亮的，尽管我做了一些可以将其拆分并解析出来的东西。这不会经常被触及，所以我不担心速度，尽管它应该处理任何时候无法处理的所有事情，例如范围和逗号分隔的日期，以及重新启动。

这个怎么运作？

有一个方法调用`cron_wrong`它只是添加一个基本错误。

我正在使用 2 列，`interval`并且`interval_type`. `interval_type`可以是`cron`, `@reboot`, `minute`, `hour`, `day`, `month`, `year`. 如果是`minute`, `hour`, `day`, `month`, or `year`, 我只是将`interval`and传递`interval_type`给`whenever`and doing `interval.send interval_type`or using`@reboot`

棘手的部分是`interval_type`-`cron`我正在验证它确实是一个有效的 cron 字符串

```
 def cron_intervals
    non_num_at_beg_or_end = /^[^\d]|[^\d]$/
    has_non_nums = /[^\d]/

    return if interval_type == '@reboot'

    if interval_type != 'cron'
      has_non_nums.match(interval) { |str| errors.add :interval, "#{str} must be number" }
      errors.add :interval, "can't be blank" if interval.length == 0
      return
    end

    cron = interval.split(' ')

    if cron.length != 5
      cron_wrong
      errors.add :interval, 'Wrong number of arguments supplied, (must be 5 -- minute hour day month year)'
      return
    end

    cron.each do |c|
      # return if star or only numbers
      if c == '*' || !has_non_nums.match(c)
        next
      end

      non_num_at_beg_or_end.match(c) do |str|
        cron_wrong
        errors.add :interval, "Non-number '#{str}' found"
        return
      end

      c.split(',').each do |spl_dash|
        non_num_at_beg_or_end.match(spl_dash) do |str|
          cron_wrong
          errors.add :interval, "Non-number '#{str}' found"
          return
        end

        range = spl_dash.split('-')

        if range.length < 1 || range.length > 2
          cron_wrong 
          errors.add :interval, "ranges must be between two numbers"
          return
        elsif range.length == 2 and not (range[0].to_i < range[1].to_i)
          cron_wrong 
          errors.add :interval, "range numbers must be lower-higher"
          return
        end

        range.each do |num|

          # should be only numbers at this point
          has_non_nums.match(num) do |str|
            cron_wrong
            errors.add :interval, "Non-number '#{str}' found"
            return
          end
          if num.length.blank?
            cron_wrong
            errors.add :interval, "No number supplied"
          end
        end
      end
    end
  end 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-15T21:12:46.453

查看这个 ruby​​ gem 来处理你的 cron 查询：

[https://github.com/javan/无论何时](https://github.com/javan/whenever)

这是一个相关的 railscast 插曲：

[http://railscasts.com/episodes/164-cron-in-ruby](http://railscasts.com/episodes/164-cron-in-ruby)

下面是一个语法示例：

```
every :day, :at => '12:20am' do
  command "echo 'Hi! Its 12:20 am.'"
end 
```

# javascript - 使用按钮而不是单页 Web 应用程序的链接

> ID：12903867
> 
> 赞同：0
> 
> 时间：2012-10-15T20:57:24.533
> 
> 标签：javascript, html, css, semantic-markup

我正在创建一个 Web 应用程序，其中包含更改单个页面上的元素的命令列表。该页面 100% 依赖于 JavaScript。因此，我将这些链接编码为：

```
<a href="#">Command #1</a> 
```

怀疑这在语义上是否正确，我发现很多地方都说我应该使用 a`button`来代替。

这是有道理的，但意味着我必须改变按钮的样式以使其看起来像一个链接，这感觉很hacky。这是正确的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T21:02:20.790

你给元素的样式与它是否是语义上正确的代码无关，所以我不会太担心。

`Links`是为了在网络上的页面之间链接用户。

HTML`Input`元素旨在接受用户输入并使用它们进行操作。

基于这个简单的启发式，我会说用一个按钮！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T21:48:22.490

HTML5 规范非常明确，您不应该使用[`a`](http://www.w3.org/TR/html5/the-a-element.html#the-a-element)：

> 如果`a`元素有一个`href`属性，那么它代表一个超链接（超文本锚）。

[“超链接”](http://www.w3.org/TR/html5/links.html#hyperlink)的定义是：

> 这些是指向其他资源的链接 […]

所以不要`a`在你的单页网络应用程序上使用“操作”。

你应该去[`button`](http://www.w3.org/TR/html5/the-button-element.html#the-button-element) 或resp。[`input`](http://www.w3.org/TR/html5/the-input-element.html#the-input-element)（我会说两者的`type`值都是`button`）。

如果您想深入了解较新的 HTML5 内容，请查看[`menu`](http://www.w3.org/TR/html5/the-menu-element.html#the-menu-element)和[`command`](http://www.w3.org/TR/html5/the-command-element.html#the-command-element).

* * *

只是为了确定：您不应该使用 JS 来“增强”其他元素（如`span`或`div`）以充当链接/按钮。如果没有进一步的工作，这将无法访问，如果有的话。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T21:00:09.510

我不认为使用链接在语义上是不正确的。如果它让您感觉更好，您可以将链接设置为按钮。

否则，如果这仍然让您感到困扰，那么将按钮设置为看起来像链接并没有错。你的应用程序的功能应该与你如何呈现你的按钮无关，只要它们做同样的事情并且符合你的期望。

正如评论中提到的，如果您想使用按钮，请记住它们的样式是表单元素，并且比使用锚标记更难。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-15T21:02:24.410

两者在技术上都可以使用。对我来说，如果它是文本链接，那么我会使用`<a>`标签，如果它是表单按钮或图像，则使用`<button>`. 这样，您就可以与预期使用的元素保持一致。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-15T21:06:44.767

一般来说，我更喜欢使用 div 来处理这些事情。链接带有许多固有的浏览器样式，按钮更是如此。Div 的唯一规则是 display:block。所以它为我节省了一些重置的 css 行。它还为我节省了一些 js 代码来防止默认行为。再加上没有正确的语义选择这一事实，那么使用 div 就很有意义。

# c++ - 字符串常量之前的预期构造函数、析构函数或类型转换

> ID：12903871
> 
> 赞同：1
> 
> 时间：2012-10-15T20:57:49.213
> 
> 标签：c++

我只是在这个程序的开始步骤，但我喜欢在编写代码时进行编译。此外，我对 ADT 非常陌生，因此在编写此代码时遇到了一些我不知道它们的含义的问题。

表达式.h

```
#include "header.h" //Library that contains thing like iomanip, cstring, etc.

class Expression
{
        private:
          char *ieEXP; //Array of characters
          char *peEXP; //Array of characters
          const int MAX = 40; //Max size for the array
        public:
          //Initialize both arrays to 0
          Expression(){ieEXP[MAX] = {0}, peEXP[MAX] = {0}};

          Expression(const Expression &);

          //Destroy contents within the array after program completes
          ~Expression(){ieEXP[MAX] = {0}, peEXP[MAX] = {0}};

          //void ReadInFix(char *ieEXP);
          //void PrintInFix(char *ieEXP);
          //void StrCatch();
          //bool IsOperator();
          //void IntoPostFix(char *peEXP);
          //void PrintPostFix(char *peEXP);
          //int Priority();
}; 
```

汇编

```
g++ -c Expression.h 
```

这是我得到的确切错误

```
Expression.h:1: error: expected constructor, destructor, 
or type conversion before string constant 
```

此外，其他方法还没有使用，只是现在只是创建类，并且 int main 还没有调用任何东西。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T21:05:18.190

解决方案可能是不编译头文件，因为 g++ 不将 *.h 识别为源文件。您可能想创建一个包含您的标头的 .cpp 文件，然后编译*该*.cpp 文件。g++ 将识别 .cpp 并正确处理它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T21:00:26.403

```
Expression(){ieEXP[MAX] = {0}, peEXP[MAX] = {0}}; 
```

ieEXP 和 peEXP 是指针而不是数组。

# neo4j - Neo4j：获取图中的所有节点，即使是那些没有通过关系连接的节点

> ID：12903873
> 
> 赞同：49
> 
> 时间：2012-10-15T20:58:08.903
> 
> 标签：neo4j, cypher

使用 Cypher 如何获取图中的所有节点？我正在对图表进行一些测试，并且我有一些没有关系的节点，所以在制作查询时遇到了麻烦。

我想全部获取它们的原因是我想在每次测试开始时删除图中的所有节点。

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2012-10-15T23:14:08.340

因此，这为您提供了所有节点：

```
MATCH (n)
RETURN n; 
```

如果要从图中删除所有内容，可以执行以下操作：

```
MATCH (n)
OPTIONAL MATCH (n)-[r]-() 
DELETE n, r; 
```

更新为 2.0+

编辑：现在在 2.3 他们有`DETACH DELETE`，所以你可以这样做：

```
MATCH (n)
DETACH DELETE n; 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-10-15T21:11:59.027

这对你有用吗？

```
START a=node:index_name('*:*') 
```

假设您有一个包含这些孤立节点的索引。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-02-23T12:06:09.897

这在 2.0 中运行良好：

```
 MATCH n RETURN n 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-03-04T11:50:23.573

如果您需要从图中删除大量对象，则需要注意不要构建如此大的单个事务，以免遇到 Java OUT OF HEAP 错误。

如果您的节点每个节点有超过 100 个关系（(100+1)*10k=>1010k 删除），请减少批量大小或查看底部的建议。

> 在 4.4 和更新版本中，您可以使用 CALL {} IN TRANSACTIONS 语法。

```
MATCH (n:Foo) where n.foo='bar'
CALL { WITH n
DETACH DELETE n
} IN TRANSACTIONS OF 10000 ROWS; 
```

> 使用 3.x 转发并使用 APOC

```
call apoc.periodic.iterate("MATCH (n:Foo) where n.foo='bar' return id(n) as id", "MATCH (n) WHERE id(n) = id DETACH DELETE n", {batchSize:10000})
yield batches, total return batches, total 
```

有关在 neo4j 中删除大量数据的最佳实践，请遵循这些[指南](https://neo4j.com/developer/kb/large-delete-transaction-best-practices-in-neo4j/)。

# java - JCodeModel 和数组

> ID：12903876
> 
> 赞同：1
> 
> 时间：2012-10-15T20:58:16.810
> 
> 标签：java

我可以使用 JCodeModel 生成注释类 exept 一件事。我不明白如何将其添加到注释中：

```
@Target(value={METHOD,TYPE,CONSTRUCTOR}) 
```

如何将定义值的数组设置为**值**方法的值？我可以使用 JAnnotationUse 类的 param() 方法进行简单的注释，但是我找不到如何将数组设置为值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T16:36:08.607

做类似这样的事情：

```
JAnnotationUse annotation = (JClass/JMethod/JFieldVar).annotate(Class<? extends java.lang.annotation.Annotation> MyAnnotation.class);
// Check if the value of the parameter of the annotation is an Array.
if (paramAnnotationValue.getClass().isArray()) {
    Object[] paramAnnotationValueArray = (Object[]) paramAnnotationValue;
    JAnnotationArrayMember annotationArrayMember = annotation.paramArray("parameter");
    for (Object paramValue : paramAnnotationValueArray) {
        annotationArrayMember.param((String/Boolean/Class/JType) paramValue);
    }
}
// No Array is normal.
else { 
    (...)
} 
```

生成这样的东西：

```
@MyAnnotation(parameter = {
    "value_a",
    "value_b"
}) 
```

# mongodb - mongodb map reduce而不保存新结果

> ID：12903880
> 
> 赞同：0
> 
> 时间：2012-10-15T20:58:38.157
> 
> 标签：mongodb, mapreduce

我有一个非常简单的 mongodb map reduce 情况。我在mysql世界中需要类似的东西：

```
select distinct(cookie) from table; 
```

我发现 map reduce 是我在 mongo 中的工具。所以我写了这个：

```
map2 = Code("function () { emit(this.cookie, 1);}")
reduce2 = Code("function (key, values) {return 1;}")
totalunique = collection.map_reduce(map2, reduce2, out={"reduce":aggregatedcollection}, query=query).count(); 
```

到目前为止非常简单。我可以通过 cron 运行它，并且可以保持`aggregatedcollection`最新状态。我保存了一个时间戳变量以放入我的查询中，以确保我只处理每一行一次。

这是我的问题。假设在时间戳`t1`我`c1`在那个集合中有值。不久之后，我在时间戳再次运行它`t2`并返回`c2`值。但是在随后的运行中`t2`，我希望它返回`c2`，**但我不希望将新值`c2`保存在`aggregatedcollection`.**

或者换句话说，我想在第二次运行它`t2`，让它返回`c2`，**但`aggregatedcollection`只填充`c1`（第一次运行的值）。**

所以在运行 at 之后`t2`，我希望它返回`c2`并拥有`c1`in `aggregatedcollection`，这些是这个问题的唯一参数。

看来我应该专注于 map reduce 函数的[out 选项](http://www.mongodb.org/display/DOCS/MapReduce#MapReduce-Outputoptions)，但这些选项似乎都不是我想要的。

当然，我可以将集合复制到临时集合中，然后对其进行处理，然后将其删除，但这会花费太多时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-06-21T06:24:33.877

试试这个下面这将导致屏幕中的输出..

```
var options = {out: { "inline": 1 }, query : query};  
db.colls.mapReduce(_mapper, _reducer, options); 
```

# css - WordPress 将“css”插入到背景图像文件夹 url

> ID：12903885
> 
> 赞同：1
> 
> 时间：2012-10-15T20:59:06.297
> 
> 标签：css, wordpress, directory

我最近安装了一个 WP，将 /css/ 插入到一些背景图像的 url 中。当它应该是 /theme/images/image.png 时，我在浏览器检查器中得到“/theme/css/images/images.png”。我什至在 css 文件夹中没有任何文件夹；图像文件夹位于同一级别。

我不知道这是从哪里来的。除了硬编码之外，我已经尝试了所有可能的 url（images/、./images 和 ../images），但我应该这样做。

这是一个自定义主题，它是白板主题的子主题。

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T21:00:55.250

Paths specified inside a CSS style sheet are relative *to that style sheet*.

So most likely, you have a CSS file with

```
background-image: url("images/images.png") 
```

style URLs in it.

The solution might be to change the URLs to

```
background-image: url("../images/images.png") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T21:35:55.153

主题是使用`get_bloginfo('template_url')`还是类似的东西`get_bloginfo('stylesheet_directory')`？如果背景图像是在 PHP 中设置的，这可能是问题所在。更多信息：[http ://codex.wordpress.org/Function_Reference/get_bloginfo](http://codex.wordpress.org/Function_Reference/get_bloginfo)

如果你在 CSS 中设置它，你可以尝试像 Pekka 建议的相对 URL，或者像根相对 URL`/wp-content/themes/[theme name]/`

# html - 选择退出 `dragenter` 和 `dragover` 事件 (html5)

> ID：12903886
> 
> 赞同：0
> 
> 时间：2012-10-15T20:59:12.507
> 
> 标签：html, dom, drag-and-drop, dom-events

我有一组可拖动的“内容”元素，以及显示在它们上方的根级“反馈”UI 元素，以在拖放过程中提供反馈。

问题是，在拖动操作期间，将鼠标悬停在“反馈”元素上会导致在该元素上触发`dragenter`和`dragover`事件，而不是在底层内容元素上触发。它有效地“阻止”了 dragenter 事件在正确的元素上触发。

有没有办法让元素取消或“退出” `dragenter`/`dragover`事件？*我可以在内容下方*显示反馈元素，但我不想那样做。

**jsfiddle：http:** [//jsfiddle.net/jact8/1/](http://jsfiddle.net/jact8/1/)

我使用的是 HTML 拖放 API，而不是 jQuery 或类似的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T10:33:28.017

我创建了一个新的[fiddle](http://jsfiddle.net/b3GX7/3/)。我认为您想使用`currentTarget`而不是`target`在列上的处理程序中使用，以确保您收到的事件来自您将侦听器添加到的元素（列）而不是它源自的元素（斜体文本）。[请参阅此处](https://stackoverflow.com/questions/5921413/difference-between-e-target-and-e-currenttarget)的解释（它适用于 ActionScript，但我相信它也适用于 JavaScript）。

我假设`insertionCaret`元素上的侦听器仅用于调试目的并已将其删除（如果我在这里弄错了，请告诉我）。如果您不收听，您将不会收到该事件，因此无需选择退出！

# php - 您可以将选定的 sql 查询值存储在 url 中，然后使用 $_GET 检索它们吗？

> ID：12903888
> 
> 赞同：1
> 
> 时间：2012-10-15T20:59:17.200
> 
> 标签：php, mysql, sql

我正在尝试这样做，以便当用户单击其中一行时，它会将他们带到一个新页面，该页面的链接作为他们选择的行的值给出，然后使用 $_GET["timesub" 检索该值]。

有人知道怎么做吗？

```
mysql_select_db("RRRC", $con);

$result = mysql_query("SELECT * FROM mainreq WHERE roomnum=$loc");

echo "<table border='1'>
<tr>
<th> Submitted </th>
</tr>";

while($row = mysql_fetch_array($result))
{
    echo "<tr>";
    echo "<td><a href="roomdata.php?timestamp= . $row['timesub'] . "> . $row['timesub'] . </a></td>";
    echo "</tr>";
}
echo "</table>"; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T21:04:34.997

假设 $row['timesub'] 标识了您的数据集中的一行（我对此表示怀疑），只需将您的 echo 指令修复为：

```
echo "<td><a href=\"roomdata.php?timestamp=" . $row['timesub'] . "\">" . $row['timesub'] . "</a></td>"; 
```

正确转义 html 引号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T21:05:28.310

```
echo "<td><a href='roomdata.php?timestamp=".$row['timesub']."'>".$row['timesub']."</a></td>"; 
```

在 . 连接符之前关闭外部“，将内部”替换为 '

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T21:07:04.033

一个好的做法是使用行的主键来引用您的 get 查询；但是是的 - 这是可以做到的。

您所要做的就是将获取的数据存储到经过清理的变量中，并执行所需的 SQL 查找/数据显示。

前任：

```
$roomnum=mysql_real_escape_string(preg_replace("/[^a-zA-Z0-9]+/", "", $_GET['roomnum'])); 
```

现在，鉴于“roomnum”是您的主键，只需查找并显示：

```
$result = mysql_query("SELECT * FROM mainreq WHERE roomnum='$roomnum'");
while($row = mysql_fetch_array($result))
{
    echo "<tr>";
    echo "<td><a href="roomdata.php?timestamp= . $row['timesub'] . "> . $row['timesub'] . </a></td>";
    echo "</tr>";
}
echo "</table>"; 
```

# javascript - 使文本左侧和右侧的图形根据文本量改变宽度？

> ID：12903892
> 
> 赞同：0
> 
> 时间：2012-10-15T20:59:34.407
> 
> 标签：javascript, jquery, html, css

我需要在文本左右两个图形之间居中放置一个 H1 标签。根据您所在的页面，H1 文本将具有不同的宽度。左侧的点应保持在站点的左边缘，而线应延伸直到到达文本的边缘。右侧也一样。有没有办法通过使用 CSS 甚至一些 jquery/javascript 来实现这一点？

![在此处输入图像描述](../Images/ee9909c582dfc1814fd26da3cd28a7cf.png)

在附图中，如果文本只是“你是谁”，我需要左右两边的条变宽以撞到文本的边缘。

背景是纹理（在示例图像中很难看到），因此在文本后面使用纯色不是一种选择。:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T21:11:39.293

试试这个：http: [//jsfiddle.net/NpCP5/](http://jsfiddle.net/NpCP5/)

我们在这里使用一个延伸到 h1 后面的图形而不是使用两个图形，并设置 h1 的背景颜色（用于间隙效果）。这也可以动态地实现，并且该行的任一侧的最小空间也仅使用 css。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T22:51:56.770

这一切都可以通过简单的 html 和 css 来完成。它使用您发布的图像作为 2 面的背景和主要的 h1 本身。图片中的文字不能用 css 删除，需要更合适的图片。在浏览器的页面中尝试以下操作。jsfiddle.net 似乎阻止访问来自该站点的图像

使用浏览器控制台检查每个元素 css 并根据需要进行调整。主框架就在那里，你只需要根据自己的喜好调整

HTML

```
<h1>
    <span class="h1_left">&nbsp;</span>
    <span class="h1_text">H1 Title Text</span>
    <span class="h1_right">&nbsp;</span>
</h1> 
```

CSS

```
h1 {
    text-align:center;
    color:#FC3;
    background-image:url(http://i.stack.imgur.com/meq5P.png);
    background-position:left 0;
    max-width: 700px;
    min-width:360px;
    padding:0;
    height:40px;
}

.h1_left,
.h1_right {
    display: inline-block;
    width:40px;
    height:100%;
    background-image:url(http://i.stack.imgur.com/meq5P.png);
    overflow:hidden;
}

.h1_text {
    background-color: #000;
    display: inline-block;
    height: 100%;
    padding: 0 10px;
    font-size:20px;
    line-height:40px;
}

.h1_right {
    float:right;
    background-position: 100% 0;
}
.h1_left{ float:left} 
```

# python - Python IMAP: =?utf-8?Q? 在主题字符串中

> ID：12903893
> 
> 赞同：19
> 
> 时间：2012-10-15T20:59:37.563
> 
> 标签：python, email, character-encoding, imap, mime

我正在显示带有 的新电子邮件`IMAP`，一切看起来都很好，除了一个邮件主题显示为：

`=?utf-8?Q?Subject?=`

我该如何解决？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-10-15T21:22:32.157

在 MIME 术语中，这些编码块称为编码字。你可以像这样解码它们：

```
import email.header
text, encoding = email.header.decode_header('=?utf-8?Q?Subject?=')[0] 
```

查看文档以[`email.header`](http://docs.python.org/library/email.header.html)获取更多详细信息。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2016-04-19T10:47:43.993

这是一个 MIME[编码字](https://www.rfc-editor.org/rfc/rfc2047#section-2)。您可以使用以下方式解析它[`email.header`](https://docs.python.org/dev/library/email.header.html)：

```
import email.header

def decode_mime_words(s):
    return u''.join(
        word.decode(encoding or 'utf8') if isinstance(word, bytes) else word
        for word, encoding in email.header.decode_header(s))

print(decode_mime_words(u'=?utf-8?Q?Subject=c3=a4?=X=?utf-8?Q?=c3=bc?=')) 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2019-03-17T17:49:12.110

在 Python 3.3+ 中，如果参数设置为，则[email.parser](https://docs.python.org/3/library/email.parser.html)中的解析类和函数会自动解码标题中的“编码词”`policy``policy.default`

```
>>> import email
>>> from email import policy

>>> msg = email.message_from_file(open('message.txt'), policy=policy.default)
>>> msg['from']
'Pepé Le Pew <pepe@example.com>' 
```

解析类和函数有：

*   [email.parser.BytesParser](https://docs.python.org/3/library/email.parser.html#email.parser.BytesParser)
*   [email.parser.Parser](https://docs.python.org/3/library/email.parser.html#email.parser.Parser)
*   [email.message_from_bytes](https://docs.python.org/3/library/email.parser.html#email.message_from_bytes)
*   [email.message_from_binary_file](https://docs.python.org/3/library/email.parser.html#email.message_from_binary_file)
*   [email.message_from_string](https://docs.python.org/3/library/email.parser.html#email.message_from_string)
*   [email.message_from_file](https://docs.python.org/3/library/email.parser.html#email.message_from_file)

令人困惑的是，至少在 Python 3.8 之前，这些解析函数的默认策略是 not `policy.default`, but `policy.compat32`，它*不会*解码“编码词”。

```
>>> msg = email.message_from_file(open('message.txt'))
>>> msg['from']
'=?utf-8?q?Pep=C3=A9?= Le Pew <pepe@example.com>' 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2018-09-30T21:11:54.520

试用[收件箱](https://github.com/martinrusev/imbox)

因为`imaplib`是一个非常多的低级库并返回难以处理的结果

**安装**

`pip install imbox`

**用法**

```
from imbox import Imbox

with Imbox('imap.gmail.com',
        username='username',
        password='password',
        ssl=True,
        ssl_context=None,
        starttls=False) as imbox:

    all_inbox_messages = imbox.messages()
    for uid, message in all_inbox_messages:
        message.subject 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-12-28T08:46:13.993

在 Python 3 中，将其解码为近似字符串非常简单：

```
from email.header import decode_header, make_header

decoded = str(make_header(decode_header("=?utf-8?Q?Subject?="))) 
```

[`decode_header`](https://docs.python.org/3.7/library/email.header.html#email.header.decode_header)请参阅和的文档[`make_header`](https://docs.python.org/3.7/library/email.header.html#email.header.make_header)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-04-10T17:45:59.600

高级 IMAP 库在这里可能有用：[imap_tools](https://github.com/ikvk/imap_tools)

```
from imap_tools import MailBox, AND

# get list of email subjects from INBOX folder
with MailBox('imap.mail.com').login('test@mail.com', 'pwd', 'INBOX') as mailbox:
    subjects = [msg.subject for msg in mailbox.fetch()] 
```

*   解析的电子邮件属性
*   用于搜索电子邮件的查询生成器
*   电子邮件操作：复制、删除、标记、移动、查看
*   文件夹操作：列表、设置、获取、创建、存在、重命名、删除、状态
*   无依赖

# c++ - 初始化和访问可变参数类模板的成员

> ID：12903896
> 
> 赞同：5
> 
> 时间：2012-10-15T20:59:42.520
> 
> 标签：c++, templates, c++11, variadic-templates

我正在尝试使用可变参数模板，并想知道是否可以使用它们来概括（？）类模板，例如

```
template<typename T1, typename T2 , typename T4, typename T4>
struct Foo
{
    T1      &m_member1;
    T2      &m_member2;
    T3      &m_member3;
    T4      &m_member4;
}; 
```

另外，我希望能够通过链接构造函数来初始化所有成员。这是我已经走了多远：

```
template<typename... Types>
struct Foo;

template<typename T , typename... Types>
struct Foo<T, Types ...> : public Foo<Types ...>
{
    Foo( T member , Types ... others ) : m_member( member ) , Foo<Types ...>( others )
    {
    }

    T   m_member;
};

template<typename T>
struct Foo<T>
{
    Foo( T member ) : m_member( member )
    {
    }

    T   m_member;
}; 
```

目标是创建这样的对象：

```
Foo<char,int,bool,float> f( 'a' , 42 , true , 1.234 ); 
```

代码无法编译（gcc 4.5.3）并出现错误：

```
TestVariadicTemplates.cpp: In constructor ‘Foo<T, Types ...>::Foo(T, Types ...)’:
TestVariadicTemplates.cpp:15:83: error: parameter packs not expanded with ‘...’:
TestVariadicTemplates.cpp:15:83: note:         ‘others’
TestVariadicTemplates.cpp:15: confused by earlier errors, bailing out 
```

**编辑**

引用 的各个成员的最佳方式是`Foo`什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T21:04:28.443

你必须按照它说的去做：扩展来自参数包（可变参数）的变量`...`。

也就是说，而不是

```
Foo<Types ...>( others ) 
```

写

```
Foo<Types ...>( others... ) 
```

# javascript - How to tell if an image has been given a specific width/height with Javascript (jQuery)?

> ID：12903902
> 
> 赞同：3
> 
> 时间：2012-10-15T21:00:03.130
> 
> 标签：javascript, jquery, image, dimensions

> **Possible Duplicate:**
> [How to get image size (height & width) using javascript?](https://stackoverflow.com/questions/623172/how-to-get-image-size-height-width-using-javascript)

Normally we can get image width with `$('img').width()` or `$('img').css('width')` when width is specified like the following

```
<img src="image.gif" width="32" height="32" />
<img src="image.gif" style="width: 32px; height: 32px" /> 
```

But if we don't specify a width:

```
<img src="image.gif" /> 
```

IE will return 28px, and FF will return 0px.

The problem is that we might set an image width to 28px or 0px intentionally, which would result a same number with the condition where no width is actually set.

My question is: how can we tell whether an image has been given a specific width/height or not?

# edit

sorry folks, forgot one important thing: 28px on IE and 0px on FF **only happens when image cannot be found (404)**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T21:02:22.317

Check `.attr('width')` / `.attr('height')`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T21:15:47.433

这是一个 hack，但您可以通过以下方式获取原始 HTML：

```
var htmltag=$("img")[0].outerHTML; 
```

然后将其解析为`width="..."`or `style="..."`：

```
if (
    htmltag.match(/style=['"][^'"]*width:/) ||
    htmltag.match(/width=['"]/)
   ) alert("Has width"); 
```

有一些边缘情况`border-width`等等，但你明白了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T21:13:08.430

图像在浏览器中异步加载，因此这取决于您检查尺寸的位置。我认为您所看到的是，当您查询宽度或高度时，图像尚未加载。

如果你运行它，你可能会看到初始的 alert() 报告为 0，但如果你点击按钮，它会显示实际大小：

```
<img id="Image" src="images/MessageBoardLogo.png" />
<input type="button" id="Button" value="Caption" />

<script type="text/javascript">
$().ready( function() {
    imageSize();

    $("#Button").click(imageSize);
});
function imageSize()
{
    alert($("#Image").width());
}        
</script> 
```

对我来说具有讽刺意味的是，FireFox 在第一个示例中立即报告宽度，IE 和 Chrome 显示 0px，但这只是表明它取决于浏览器的时间、图像的加载时间等。

确保图像已加载并准备好可靠地读取大小的最佳方法是使用负载处理程序：

```
$("#Image").load( function() { 
                      // do whatever you need with width and height
                      global.imgWidth = $(this).width(); 
                      global.imgHeight = $(this).height() 
                   }); 
```

# asp.net - RadGrid in does not go in editmode

> ID：12903904
> 
> 赞同：0
> 
> 时间：2012-10-15T21:00:10.650
> 
> 标签：asp.net, .net, radgrid

I have RadGrid on an ascx control with one ImageButton in TemplateColumn. ImageButton has CommandName=”Edit”. So when I click the image button it sets the grid in Edit mode. I have some code on ItemDataBound event of grid that works if e.Item.IsInEditMode is true.

The whole thing works on local but when I deploy the code on TEST environment then it doesn’t work. After putting some log statements I found out that on this environment when user clicks Imagebutton it doesn’t set the grid in Edit mode and e.Item.IsInEditMode is never true.

I have 2 different Test environments, this functionality works on one the Test environment but not on another one. Both the servers have same windows update and IIS configuration.

any idea what else can cause this problem?

additional Info: I am using SessionPageStatePersister for view state

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T15:53:30.280

我只是想出了这个。在其中一台服务器上，我的 web.config 在 httpCookies 元素中有错误的域名。它与实际域名不同。这就是视图状态不起作用的原因。

# svn - Moving from git to subversion (yes, that way round): Using the trunk

> ID：12903905
> 
> 赞同：1
> 
> 时间：2012-10-15T21:00:23.673
> 
> 标签：svn, version-control, git-svn

I have been using git for 2 years now and love it. However, I am doing some work for a company that insist in using svn so I need to port my git way of doing things to svn.

This is what I have learned so far:

```
svn co https://the.remote.repo
touch myrepo/trunk/mytest.c
svn add myrepo/trunk/mytest.c 
cd myrepo/
svn commit -m "added test file" 
```

which checks out my repo, adds a file, commit it and then pushes it.

I already have a non-svn project (non-git too, it's not under version control yet (awful I know)). How can I turn my existing project into a svn repo ? I can do this:

```
svn co https://the.remote.repo my_existing_non_svn_directory 
```

which creates a `trunk` sub-directory in `my_existing_non_svn_directory`. With `git` there is no `trunk` so this would work but with `svn`, do I have to move all my code into the trunk ? Is there some way round this or is it just an `svn` thing ?

Many thanks.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T21:04:39.687

使用 Subversion（与 Git 不同），您可以轻松检出部分树。因此，在您的第一个示例中，您可能会这样做：

```
svn co https://the.remote.repo/trunk myrepo 
```

这样您的工作目录中就不会出现trunk/tags/branches 层次结构，这使得这更简单、更快捷。

在您的第二个示例中，如果您有一个大部分为空的 Subversion 存储库（您已在其中设置了 trunk/tags/branches 层次结构），那么您可以签出`https://the.remote/repo/trunk`并获取一个可以添加文件的空目录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T22:35:15.237

您可以将未版本化的树导入存储库：

```
>svn help import
import: Commit an unversioned file or tree into the repository.

svn import my_existing_non_svn_directory https://the.remote.repo/trunk 
```

稍后使用这个 repo 处理 git-svn

另一种风格

*   `svn co`空新后备箱
*   将项目树复制到 WC
*   添加/忽略/提交

# android - How to determine whether softkeyboard is shown on the screen - while using monkeyrunner

> ID：12903907
> 
> 赞同：3
> 
> 时间：2012-10-15T21:00:25.170
> 
> 标签：android, monkeyrunner, androidviewclient

I am trying to automate few screen clicks and entries using monkeyrunner(using AndroidViewClient )

Whenever there is a edittext in the screen, the soft keyboard is popping up, and if I want to press a button though findViewById, (assuming that this particular button is behind the soft keyboard) fails. Instead of clicking this button, it clicks on some button in the soft keyboard. So as a work around I need to press back key through monkey runner, to hide the soft keyboard.

My question is how to determine whether soft keyboard is shown in the screen or not while running from monkeyrunner.

When I looked at the logcat, I see this following while showing up the soft keyboard

```
I/SurfaceFlinger( 2045): id=143(28) createSurf 0x4326743c (720x593),1 flag=0, InputMethod 
```

and displays this while softkeyboard is removed

```
I/SurfaceFlinger( 2045): id=142 Removed InputMethod idx=4 MapSz=3
I/SurfaceFlinger( 2045): id=142 Removed InputMethod idx=-2 MapSz=3 
```

If someone can provide an example of how to parse the adb logcat output from the monkeyrunner script, I can use that as a last option, if there is any suitable alternative solution found.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-10-30T15:08:33.060

有一种方法可以使用来自 monkeyrunner 的 adb shell 来做你想做的事情，它不需要单独的第三方库。

```
if ('mInputShown=true' in device.shell('dumpsys input_method')):
    <conditional code for when soft keyboard is showing goes here> 
```

或者

```
if ('mInputShown=false' in device.shell('dumpsys input_method')):
    <conditional code for when soft keyboard is not showning goes here> 
```

`device`连接设备的 MonkeyDevice 实例在哪里。

我发现通常在手动启动时显示用于输入的软键盘的应用程序在使用 monkeyrunner 启动时并不能可靠地显示软键盘。如果脚本逻辑取决于软键盘是否显示，我在脚本中使用上述测试来检查软键盘是否显示。

下面的解释包括一些关于如何解决这类问题的思考。

```
adb shell dumpsys 
```

返回设备上运行的所有服务的非常大且详细的转储。`dumpsys`可以为单个服务请求转储，在我们的例子中，输入服务。这种用法是

```
adb shell dumpsys input_method 
```

这将返回一个小得多的转储，它只是当前输入法管理器的状态。该转储将包括所有当前的 InputMethod 实例、具有输入法管理器客户端通用参数的输入法管理器客户端、输入法客户端状态和输入法服务器状态。输入法管理器客户端的一组通用参数与是否显示输入法（例如软键盘）有关，以及有关输入法显示是否被请求、显式请求或强制以及是否正在显示的一些参数。

是否显示输入法是一个有趣的问题，因为它在软键盘显示时为真，在软键盘不显示时为假。该参数的名称是

> mInputShown

看起来像

> mInputShown=真

或者

> mInputShown=假

取决于是否显示软键盘。

下一步是在 monkeyrunner 脚本中使用这些信息。MonkeyDevice 类包括一个在monkeyrunner 对桥的使用中运行ADB shell 命令的方法，该方法返回一个对象，该对象是ADB shell 执行ADB shell 命令的返回值。在 monkeyrunner 脚本中，看起来像

```
shell_cmd_return_stuff = device.shell('dumpsys input_method') 
```

其中`device`是附加设备的 MonkeyDevice 类的实例，并且`shell_cmd_return_stuff`是保存所有 shell 命令输出的变量——在本例中为转储输出。最后，由于我们正在文本中查找特定的参数/值对并且知道它的外观，因此我们可以使用标准 Jython 在返回的输出中查找该字符串，而无需将其保存在变量中并使用 Jython 字符串`in`布尔运算符

```
if ('mInputShown=true' in device.shell('dumpsys input_method')):
    <conditional code for when soft keyboard is showing goes here> 
```

或者

```
if ('mInputShown=false' in device.shell('dumpsys input_method')):
    <conditional code for when soft keyboard is not showning goes here> 
```

取决于我们是否想知道软键盘当前是否显示。

享受！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-30T22:16:20.567

您在回答中提到的内容可能是对[AndroidViewClient](https://github.com/dtmilano/AndroidViewClient)的一个很好的补充，我会尽快将其合并。

无论如何，有一种获取相同信息的方法，尽管方式更复杂：

```
...
from com.dtmilano.android.viewclient import ViewClient

vc = ViewClient(*ViewClient.connectToDeviceOrExit())
view = vc.findViewByIdOrRaise('id/no_id/1')
view.getXY() # getXY() calls __dumpsWindowsInformation()
for w in view.windows:
    if view.windows[w].activity == 'InputMethod':
        print view.windows[w].visibility 
```

## 2015 年 2 月 11 日更新

最新的 AndroidViewClient/culebra 版本支持`isKeyboardShown()`方法。像这样使用：

```
#! /usr/bin/env python
# -*- coding: utf-8 -*-
'''
Copyright (C) 2013-2014  Diego Torres Milano
Created on 2015-02-11 by Culebra v10.0.8
                      __    __    __    __
                     /  \  /  \  /  \  /  \ 
____________________/  __\/  __\/  __\/  __\_____________________________
___________________/  /__/  /__/  /__/  /________________________________
                   | / \   / \   / \   / \   \___
                   |/   \_/   \_/   \_/   \    o \ 
                                           \_____/--<
@author: Diego Torres Milano
@author: Jennifer E. Swofford (ascii art snake)
'''

import re
import sys
import os

try:
    sys.path.insert(0, os.path.join(os.environ['ANDROID_VIEW_CLIENT_HOME'], 'src'))
except:
    pass

from com.dtmilano.android.viewclient import ViewClient

TAG = 'CULEBRA'

_s = 5
_v = '--verbose' in sys.argv

kwargs1 = {'ignoreversioncheck': False, 'verbose': False, 'ignoresecuredevice': False}
device, serialno = ViewClient.connectToDeviceOrExit(**kwargs1)
print "Is keyboard shown:", device.isKeyboardShown() 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-22T22:05:41.200

我找到了解决这个问题的方法。当我查看 adb shell dumpsys input_method 时，我可以看到“mInputShown=true”。因此，基于此，我编写了以下函数。

```
def isKeyboardShown():                                                                                                                                                                                          
     return "mInputShown=true" in call_shell_cmd("adb shell dumpsys input_method") 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-05T07:21:26.787

```
def isKeyboardShown(self):
#Whether the keyboard is displayed.
   return self.device.isKeyboardShown() 
```

[链接参考](https://github.com/dtmilano/AndroidViewClient/blob/master/src/com/dtmilano/android/viewclient.py)

```
We can use isKeyboardShown() function by importing view-client to
validate whether the soft Keyboard is displayed or not . 
```

# asp.net-mvc - Printing single comma (or other char) in Razor view

> ID：12903908
> 
> 赞同：2
> 
> 时间：2012-10-15T21:00:29.983
> 
> 标签：asp.net-mvc, razor

I have a seemingly very small problem, but I can't find a solution for it:

Within a Razor view i have something like this:

```
<p>
@if (someCondition){
   foreach (Sometype s in Model.ListOfSomeTypes){
      @s.Name @//There is a space in front here.
   }
}
</p> 
```

But I want to have to have all the names comma seperated, so i essentially want to do something like this:

```
<p>
@if (someCondition){
   foreach (Sometype s in Model.ListOfSomeTypes){
      @s.Name, 
   }
}
</p> 
```

However, Razor freaks out. How can I achieve this kind of result?

* * *

I have tried some variations like this:

```
@{','} @s.Name @//No good
@"," @s.Name @//No good
@{","} @s.Name @//No good
@StringVariableContainingComma @s.Name @//This works, but seems to be very unnessecary to me. 
```

Ps. I know that the above suggested solution for comma seperated elemens don't work propperly. Removed conditions for easier reading of question.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T21:05:02.973

使用常规括号指定[显式代码块](http://weblogs.asp.net/scottgu/archive/2010/12/16/asp-net-mvc-3-implicit-and-explicit-code-nuggets-with-razor.aspx)。

```
@(s.Name), @(...) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-15T21:09:52.443

`<text>`标签应该为你做。

```
<p>
@if (someCondition){
   foreach (Sometype s in Model.ListOfSomeTypes){
      @s.Name<text>, </text>
   }
}
</p> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-15T21:09:36.157

这应该可以 - 虽然你会有尾随逗号

```
@foreach (Sometype s in Model.ListOfSomeTypes){
    @(s.Name+",")
} 
```

或者

```
@if (someCondition){
   @String.Join(",", Model.ListOfSomeTypes.Select(s => s.name));
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-02-01T22:29:37.280

```
<p>
@if (someCondition){
   foreach (Sometype s in Model.ListOfSomeTypes){
      @s.Name<span>, </span>@s.City
   }
}
</p> 
```

您可以使用跨度标签

# gcc - Compilation error using ffmpeg library

> ID：12903910
> 
> 赞同：2
> 
> 时间：2012-10-15T21:00:34.283
> 
> 标签：gcc, architecture, compilation, ffmpeg

I have downloaded and installed the ffmpeg library. I want to use it for reading the separate frames of different videos and manipulate them. For that I tried to follow some tutorial from here: [http://dranger.com/ffmpeg/tutorial01.html](http://dranger.com/ffmpeg/tutorial01.html) But I can't compile my cpp file since I get the following compilation:

```
Undefined symbols for architecture x86_64:
  "av_register_all()", referenced from:
      _main in cc9zyUBe.o
      _main in ccRz35d4.o
ld: symbol(s) not found for architecture x86_64
collect2: ld returned 1 exit status 
```

When I was installing ffmpeg library, I used arch=x86_64 option in ./configure step. I use OS X Mountain Lion 10.8.2 and gcc 4.2 compiler. Does somebody have any clue what can be the reason of this error? Thanks in advance.

UPDATE: I've already tried many different install options, with static libraries, shared libraries, with/without --arch=x86_64 option. Also installed it with homebrew, result remains the same. Library isn't recognized. But ffmpeg binary works pretty well, when I use it as a command-line tool.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-15T12:54:11.147

最后，我设法编译了使用 ffmpeg 库的程序。

出于某种原因，我仍然无法使用 gcc 编译器编译它，但我可以使用 g++ 编译器来编译它。

安装静态库时，必须明确指定所有依赖项，并且这些库的链接顺序也很重要。所以这是最终编译我的程序的编译代码：

```
g++ readVideo.cc -o readVideo $(pkg-config --libs --cflags libavformat) 
```

`pkg-config`这是一个实用程序，它打印正确链接指定库所需的所有标志和`libavformat`库。

另外值得一提的是，源文件已从 readVideo.C 重命名为 readVideo.cc，并且该`#include`语句已包含使用`extern "C"`如下：

```
extern "C" {
  #include <libavformat/avformat.h>
} 
```

它是必需的，因为 ffmpeg 是一个 C 项目，如果您没有明确声明它是 C 库，程序将无法使用 C++ 编译器进行编译。

如果您不想费心`pkg-config`包含 ffmpeg 库的所有依赖项，您可以使用共享库而不是静态库安装 ffmpeg。然后它将通过更简单的调用进行编译：

```
g++ readVideo.cc -o readVideo -lavformat 
```

要安装共享库，需要`./configure`在安装ffmpeg时在program中添加这2个选项：

```
--disable-static --enable-shared 
```

希望它可以帮助某人一段时间...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T09:18:49.263

该错误意味着您没有链接到 ffmpeg 库。仅仅包括头文件是不够的。您还需要链接到实际的库文件。在 Windows 上，它们有 .lib 扩展名，在 Linux 上通常是 .a 扩展名，不确定 Mac。

# php - API display logic serverside or clientside

> ID：12903913
> 
> 赞同：0
> 
> 时间：2012-10-15T21:00:49.663
> 
> 标签：php, javascript, mysql, api

I'm refactoring an API where there are user profiles from a profiles table and profile images in a separate table. Currently the API queries the profile tables, and then loops through the images table for associated image data (paths etc). There is logic built in that adds a default img path when a profile image isn't set. So if we are displaying 50 profiles there are 51 queries being run.

I'm considering refactoring where the initial profile query joins the image table. I'm now left with **two options**.

1.  I can loop through the results server side to build the image paths. I will have to loop through them again client side to display the results.
2.  I can loop through the results one time client side and build the image paths there. The path logic is easy and a simple if statement.

It seems 2 would be the logical choice. But is it? I guess this is part of a bigger question of when you are building out APIs and the client side interfaces when do you move code from the server to the client to keep the API fast at risk of slowing down the browser? How do you do this dance? I'm working on another API using Node for the jquery datatables plugin where there needs to be a lot more code to marry the backend, and it's been a bit of a tug of war determining how much I should hand over to the browser. A fast API is of not much use if you are crashing your visitors browsers.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T21:37:25.703

对我来说决定的小费是我是否通过暴露组件路径的一部分，以便客户端可以构建它，暴露一些我不想要的东西。

对比

我是通过构建图像路径服务器端来完成客户端可能不需要的工作，还是客户端可能必须重做的工作，例如有时将它们切碎。

在传递比需要更多的数据方面，我没有看到你所说的问题，第一个问题对我来说是最优先的问题。

在这种情况下有点拉伸，但客户端必须知道如何组成图像路径，设置一些约束，而如果这一切都在服务器端完成，则隐藏实现细节。尽管它们很简单，但这将是我的默认选项

正如你所说，这是一场拔河比赛。看待此类问题的另一种方法是，“正确”答案可能取决于您提出问题的时间。你可以走一条路，然后他们稍后会出现一些新的要求，现在它是错误的......

简单和一致是目标。最好的吗？20/20 后见之明。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T21:18:12.463

当我过去看到并做过这个时，我发现最好不要在数据库中存储图像（就像你正在做的那样）。将它们放在浏览器可以链接到它们并从服务器传递路径的地方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T21:41:05.617

如果我理解正确..您正在显示某种配置文件列表，其中每个配置文件都有关联的图像...对吗？

从存储图像的方式中抽象出来（db 或 vfs 图像更快，但直接文件 - 至少具有较小的 MRU 缓存 - 更易于维护）。

解决方案 numero uno 是正确的方法。

它只是更简单，更“宁静”。我是客户端逻辑的忠实拥护者，但我们应该将它用于一个好的原因（例如 Soopa-UI）。数据库逻辑代码与服务器逻辑代码也是如此。我不喜欢 sql 并且不得不维护另一层问题，但我确实理解它在某些情况下对最终结果的影响。

编辑：哦......你只是存储路径。因此，如果您不是在做一些花哨的单页 Web 应用程序，那么在客户端构建路径还有另一个问题。客户端必须等待脚本完成加载，然后才能开始加载他的图像。

# c# - URLParameter value bug in Intelligencia.UrlRewriter

> ID：12903914
> 
> 赞同：0
> 
> 时间：2012-10-15T21:00:53.580
> 
> 标签：c#, rewrite, urlrewriter.net

my rewrite rule is

**<rewriter>

<rewrite url="~/categories/([0-9,A-Z,a-z,-]+)/(.+).aspx" to="~/inventory/product-list.aspx?categorycode=$1" processing="stop"/>

</rewriter>**

it works for url with

**/category/abc/abc.aspx**

but causes problem with

**/category/con/abc.aspx**

i dont understand why?

if we pass "**con**" as url parameter value in any site used by Intelligencia.UrlRewriter. you may find similar problem.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T14:30:45.793

研究了这么多，找到了答案。

实际上 IIS 限制我们在 URL 中使用某些关键字，例如

**COM1-9、LPT1-9、AUX、PRT、NUL、CON**

**但是我们可以通过在web.config**文件中使用以下设置来解决这个问题。

<configuration>
     <system.web>
         <httpRuntime RelaxUrlToFileSystemMapping="true"/>
    </system.web>
</configuration>

它解决了我的问题。

# iphone - How to record mic input and an audio track on iPhone at the same time

> ID：12903923
> 
> 赞同：1
> 
> 时间：2012-10-15T21:01:41.750
> 
> 标签：iphone, xcode, audio, mp3, m4a

I am looking to record and save a music/song file with one or more audio track(s) let's say a max of two tracks playing simultaneously while recording my vocals via the headset or the microphone. The finished product will be a single song file(mp3 or other format).

Also, the code should have the ability to filter out outside noise/interferance and add basic effects.

Appreciate any and all Xcode help!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T05:33:37.487

I have done same thing using AVAudioSessionCategoryPlayAndRecord. in my code, played karaoke file in MPMoviePlayer and at same time takes input from mic. output is audio from MPMoviePlayer and it will be used as input also + input from mic. i started to save this input in caf file, and upon finish product should be single file.

# c++ - c++ compiled exe crashes on another machine

> ID：12903924
> 
> 赞同：1
> 
> 时间：2012-10-15T21:01:43.227
> 
> 标签：c++, crash, mingw, exe

I have a problem with this code: i am using mingw and when i compile it using: g++ helloworld.cpp -o helloworld.exe it works on the machine that compiled it for hous no problems at all. but on other machines such as XP Pro it runs the first cout line and crashes here is the code (this is to capture barcodes not a key logger )

```
 #include <windows.h>
    #include <stdio.h>
    #include <stdlib.h>
    #include <winuser.h>
    #include <iostream>
    #include <time.h>

    using namespace std;

    HHOOK KBDHOOK;
    KBDLLHOOKSTRUCT kbdStruct;
    int endbarcode = 0;

    int Save (int KS)
    {
    time_t rawtime;
    struct tm * timeinfo;
    char buffer[80];

        if ( (KS == 1) || (KS == 2) )
            return 0;

        FILE *OUTPUT_FILE;
        OUTPUT_FILE = fopen("log.txt", "a+");

        cout << KS << endl;

            if(endbarcode == 0)
            {
         time(&rawtime);
                timeinfo = localtime(&rawtime);
                strftime(buffer,80,"%Y-%m-%d %H:%M:%S ",timeinfo);
                puts(buffer);

                endbarcode = 1;
                fprintf(OUTPUT_FILE, "%s", buffer);
            }

            if (KS == 8)
            fprintf(OUTPUT_FILE, "%s", "[BACKSPACE]");
            else if (KS == 13)
            {
                fprintf(OUTPUT_FILE, "%s", "\n");
                endbarcode = 0;
            }

            else if (KS == 32)
            fprintf(OUTPUT_FILE, "%s", " ");
            else if (KS == VK_TAB)
            fprintf(OUTPUT_FILE, "%s", "[TAB]");
                else if (KS == VK_SHIFT)
            fprintf(OUTPUT_FILE, "%s", "[SHIFT]");
                else if (KS == VK_CONTROL)
            fprintf(OUTPUT_FILE, "%s", "[CONTROL]");
                    else if (KS == VK_ESCAPE)
            fprintf(OUTPUT_FILE, "%s", "[ESCAPE]");
                    else if (KS == VK_END)
            fprintf(OUTPUT_FILE, "%s", "[END]");
                        else if (KS == VK_HOME)
            fprintf(OUTPUT_FILE, "%s", "[HOME]");
                        else if (KS == VK_LEFT)
            fprintf(OUTPUT_FILE, "%s", "[LEFT]");
                            else if (KS == VK_UP)
            fprintf(OUTPUT_FILE, "%s", "[UP]");
                            else if (KS == VK_RIGHT)
            fprintf(OUTPUT_FILE, "%s", "[RIGHT]");
                                else if (KS == VK_DOWN)
            fprintf(OUTPUT_FILE, "%s", "[DOWN]");
                                else if (KS == 190 || KS == 110)
            fprintf(OUTPUT_FILE, "%s", ".");
                                else
                                    fprintf(OUTPUT_FILE, "%s", &KS);

    fclose (OUTPUT_FILE);
        return 0;
    }

    LRESULT CALLBACK LowLevelKeyboardPoc(int nCode, WPARAM wParam, LPARAM lParam)
    {
        if(nCode < 0)
            return CallNextHookEx(KBDHOOK, 0, wParam, lParam);

            if(nCode == HC_ACTION)
            {
            if(wParam == WM_KEYDOWN)
                {

            kbdStruct = *((KBDLLHOOKSTRUCT*)lParam);
            printf("%X\t%c\n", (unsigned int)kbdStruct.vkCode, (char)kbdStruct.vkCode);
            Save((unsigned int)kbdStruct.vkCode);
                }

                }

        return CallNextHookEx(KBDHOOK, nCode, wParam, lParam);
    }

    int main()
    {

        cout << "the main method has run" << endl;

       // HWND stelth;
      //  stelth = FindWindowA("ConsoleWindowClass", NULL);
      //  ShowWindow(stelth,0);
    if((KBDHOOK = SetWindowsHookEx(WH_KEYBOARD_LL, LowLevelKeyboardPoc, GetModuleHandle(NULL), 0)) == NULL)
         {
             cout << "The hook NOT installed";
         }
         cout << "hook installed" << endl;
        MSG Message;
    while(GetMessage(&Message, NULL, 0, 0))
    {
    TranslateMessage(&Message);
    DispatchMessage(&Message);
    }
    GetLastError();

    UnhookWindowsHookEx(KBDHOOK);
    return 0;
    } 
```

# javascript - 使用 unshift() 使用 javascript 将表单输入添加到数组

> ID：12903927
> 
> 赞同：0
> 
> 时间：2012-10-15T21:01:56.047
> 
> 标签：javascript, arrays

我正在尝试通过表单将元素添加到数组中。我正在使用 unshift() 方法。下面的代码不起作用，我想知道为什么。

```
<form>
<input id="input"> </input>
<input type = "button" id="button"> Click me </input>
</form>

<script>

var input = document.getElementById("input").value;
var button = document.getElementById("button");

var myArray = [];
myArray.unshift(input);

button.onclick = function alerted (){
alert(myArray);
};

</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T21:05:57.027

加载页面后，您引用的代码会*立即运行。*表单字段中将没有任何内容，因此其值为`''`. 当您发出警报时，`toString`将导致阵列上的默认操作，`''`并且警报将为空白。

您希望运行`unshift`代码以响应用户事件，例如单击按钮，而不是立即运行。您可以通过将其设置`input`为元素（`.value`从该行中删除）然后将您的行移动`unshift`到您分配给的函数中`onclick`，并在其中添加`.value`：

```
button.onclick = function alerted (){
    myArray.unshift(input.value);
    alert(myArray);
}; 
```

其他注意事项：

1.  你从不写`</input>`。通常你根本不会关闭`input`标签。如果你正在编写 XHTML（你可能不是），你可以`/`像`input`这样把`<input id="input" />`. 但同样，您可能不是在编写 XHTML，而只是在编写 HTML。

2.  `input`按钮的值（标题）位于其`value`属性中，而不是开始和结束标记中的内容。（您可以在元素中使用开始和结束标签`button`，而不是`input`.）

综合所有这些，这是一个极简更新：[Live copy](http://jsbin.com/otucad/1) | [来源](http://jsbin.com/otucad/1/edit)

```
<form>
<input id="input"><!-- No ending tag -->
<input type = "button" id="button" value="Click me"><!-- No ending tag, move value where it should be -->
</form>
<script>

var input = document.getElementById("input"); // No .value here
var button = document.getElementById("button");

var myArray = [];

button.onclick = function alerted (){
    myArray.unshift(input.value); // Moved this line, added the .value
    alert(myArray);
};
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T21:07:30.743

[演示](http://jsfiddle.net/mplungjan/MLSVB/)

您需要 a) 在单击中获取值 b) 如果您希望按钮不提交，则返回 false。我改为按钮。替代方案是`<input type="button" value="click me" id="button" />`

您甚至可能想清空并将该字段集中在单击...

```
<form>
<input id="input" type="text"/>
<button id="button"> Click me </button>
</form>

<script>

var input = document.getElementById("input"); // save the object
var button = document.getElementById("button");

var myArray = [];

button.onclick = function alerted (){
    myArray.unshift(input.value); // get the value
    alert(myArray);
    return false;
};

</script>​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T21:09:00.307

您没有在 onclick 函数中获得新值。

试试这个：http: [//jsfiddle.net/SeqWN/4/](http://jsfiddle.net/SeqWN/4/)

```
var button = document.getElementById("button");
var i = document.getElementById("input");
var myArray = [];

button.onclick = function alerted (){
  myArray.unshift(i.value);
  alert(myArray);
};​ 
```

# math - 我可以在不计算角度的情况下找到余弦值的正弦值吗？

> ID：12903935
> 
> 赞同：2
> 
> 时间：2012-10-15T21:02:24.033
> 
> 标签：math, game-engine, trigonometry, game-physics

叉积的大小描述了由用于构建叉积的两个向量 (u, v) 描述的平行四边形的有符号面积，它有其用途。这个相同的幅度可以计算为 u 的幅度乘以 v 的幅度乘以 u 和 v 之间的角度的正弦值：||u||||v||sin(theta)。

现在 u（归一化）和 v（归一化）的点积给出了 u 和 v 之间角度的余弦： cos(theta)==dot(normalize(u), normalize(v))

我希望能够获得与余弦值相关的有符号正弦值。这是相关的，因为正弦波和余弦波是 PI/2 不同步的。我知道 1 的平方根减去余弦值的平方得到无符号正弦值： sin(theta)==sqrt(1 - (cos(theta) * cos(theta)) 其中 cos(theta) 我的意思是点产品不是角度。

但是伴随符号计算 (+/-) 需要 theta 作为角度： (cos(theta + PI / 2)) > or == or < 0 如果我必须执行 acos 函数，我不妨只做叉积并找到大小。

是否存在可以添加到余弦值以获得其相关正弦值的已知比率或步长？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T21:15:46.403

对于每个可能的余弦，如果相应的角度不受限制，则正弦的两个符号都是可能的。

如果您知道角度介于 之间`[0,pi]`，则正弦必须为正或零。

如果你想知道平行四边形的面积，总是取正分支`sin(x) = sqrt(1 - cos(x)^2)`。负区域很少有意义（仅用于定义平面的方向，例如用于背面剔除）

如果您有两个向量，请直接使用叉积或点积，而不是另一个并转换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T13:50:40.143

在我看来，这是一种获取`atan2`身份的复杂方法：

```
d =   · = ||||cosθ
c = |×| = ||||sinθ   (with 0° < θ < 180°)

 tanθ = · / |×|
    θ = atan2(c·sgn(c|z), d)   (= four quadrant) 
```

其中`sgn(c|z)`是 c 中 z 分量的符号（除非两者都与 xz 或 yz 平面完全平行，则它分别是 y 分量和 x 分量的符号）。

现在，从基本的三角恒等式，

```
r = √(x²+y²)

cos(atan2(y,x)) = x/r
sin(atan2(y,x)) = y/r 
```

所以，

```
sinθ = c·sgn(c|z)/√(c²+d²)
cosθ = d/√(c²+d²) 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-10-16T00:25:12.583

我想我已经找到了解决办法。 ![v perp](../Images/cbaa5c36f10c413213e8f181612527ac.png)

```
cos(b) == sin(a)

v_parallel = dot(normalize(u), v) // the projection of v on u

v_perp = normalize(v) - v_parallel

cos(b) = dot(normalize(v), v_perp) // v_perp is already normalized 
```

因此，幅度

```
u cross v = magnitude(u) * magnitude(v) * cos(b) 
```

# arrays - Rails，评估数字是否按顺序

> ID：12903937
> 
> 赞同：0
> 
> 时间：2012-10-15T21:02:30.517
> 
> 标签：arrays, ruby-on-rails-3

有没有办法评估数组的顺序？我想找到一个按 created_at 日期排序的记录数组，然后查看该数组中的数字是否按顺序排列？

例如：

```
 Model.all.order(&:created_at).select("lesson_number)
  [1, 2, 4, 3, 5] 
```

应该失败，因为数字不按顺序

我可以执行两个发现。一种按“lesson_number”排序，另一种按created_at 日期排序。将它们都转换为字符串，然后比较两者。但是，如果存在用于处理此类事情的 rails 方法，似乎需要做很多工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T21:11:47.153

您可以在 Ruby 中组合几个方法来非常有效地完成这项工作。

```
input.each_cons(2).reduce(true) { |result, (a, b)| result && (a <=> b) < 0 } 
```

`each_cons`将遍历您的数组，在这种情况下，每 2 个连续项目产生。因为我们没有将块传递给它，所以它返回一个枚举器，我们可以遍历它并使用`reduce`(aka `inject`) 获取单个结果值。

我们的块比较`a`和`b`使用`<=>`which 将返回 -1、0 或 1，具体取决于第一个值是“小于”、等于还是“大于”。在这种情况下，我们要确保`a`is `-1`。

如果您不熟悉它，块参数中的括号是 Ruby 1.9+，它们允许将参数插入（否则我们将在块中得到一个 2 项数组）。

# python - 直接通过url使用python从imgur下载文件

> ID：12903938
> 
> 赞同：2
> 
> 时间：2012-10-15T21:02:33.193
> 
> 标签：python, bash, imgur

有时，指向 imgur 的链接没有给出文件扩展名。例如：`http://imgur.com/rqCqA`。我想下载文件并给它一个已知的名称或在更大的代码中获取它的名称。问题是我不知道文件类型，所以我不知道给它什么扩展名。

如何在 python 或 bash 中实现这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-15T21:18:20.133

您应该使用[Imgur JSON API](http://api.imgur.com/resources_anon#image_hash)。这是 Python 中的一个示例，使用[requests](http://pypi.python.org/pypi/requests/)：

```
import posixpath
import urllib.parse
import requests

url = "http://api.imgur.com/2/image/rqCqA.json"
r = requests.get(url)
img_url = r.json["image"]["links"]["original"]
fn = posixpath.basename(urllib.parse.urlsplit(img_url).path)

r = requests.get(img_url)
with open(fn, "wb") as f:
    f.write(r.content) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-15T21:22:27.497

我以前用它来下载大量的 xkcd 网络漫画，它似乎也适用[于此](http://imgur.com/rqCqA.jpg)。

```
def saveImage(url, fpath):
    contents = urllib2.urlopen(url)
    f = open(fpath, 'w')
    f.write(contents.read())
    f.close() 
```

希望这可以帮助

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-15T21:07:00.043

我刚刚尝试访问以下 URL：

*   [http://imgur.com/rqCqA.jpg](http://imgur.com/rqCqA.jpg)
*   [http://imgur.com/rqCqA.png](http://imgur.com/rqCqA.png)
*   [http://imgur.com/rqCqA.gif](http://imgur.com/rqCqA.gif)

他们都工作了。似乎 Imgur 存储了几种类型的相同图像 - 你可以选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-15T21:05:34.040

您可以使用 BeautifulSoup 或类似工具解析页面的源代码，并在 src 中查找带有照片哈希的 img 标签。以你的例子，图片是

```
<img alt="" src="http://i.imgur.com/rqCqA.jpg" original-title=""> 
```

# visual-studio-2010 - 无法运行visual studio项目system.web.mvc

> ID：12903941
> 
> 赞同：1
> 
> 时间：2012-10-15T21:02:47.500
> 
> 标签：visual-studio-2010, nuget

我收到此错误：

![在此处输入图像描述](../Images/3f8f28c7b4b4d996ab7d7b2a135818b8.png)

有什么问题，我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T21:10:05.627

似乎缺少一个文件：“nuget.targets”。

你有关于它的任何额外信息吗？，你是否尝试在不同的 Visual Studio 安装中运行它？，不同的计算机，也许？。

如果我是你，我会清理所有内容并尝试再次运行该项目。

我猜你用这个：[http](http://nuget.codeplex.com/wikipage?title=Getting%20Started) : //nuget.codeplex.com/wikipage?title=Getting%20Started 作为你安装 nuget 的指南。我建议重新安装它，如果您没有成功安装它，请返回并给我们额外的信息。

# sql-server - 过滤子元素，但使用 XPath 保留原始结构

> ID：12903944
> 
> 赞同：1
> 
> 时间：2012-10-15T21:03:01.073
> 
> 标签：sql-server, xml, xpath, filter, xquery

我怎样才能从中得到：

```
<a id="1">
    <b>
        <c type="1"/>
        <c type="0"/>
        <c type="0"/>
    </b>
    <b>
        <c type="1"/>
        <c type="0"/>
        <c type="1"/>
    </b>
</a>
<a id="2">
    <b>
        <c type="1"/>
        <c type="1"/>
        <c type="0"/>
    </b>
    <b>
        <c type="1"/>
        <c type="1"/>
    </b>
</a> 
```

以下：

```
<a id="1">
    <b>
        <c type="1"/>
    </b>
    <b>
        <c type="1"/>
        <c type="1"/>
    </b>
</a>
<a id="2">
    <b>
        <c type="1"/>
        <c type="1"/>
    </b>
    <b>
        <c type="1"/>
        <c type="1"/>
    </b>
</a> 
```

所以我想过滤元素，但保留原始结构。我使用 sql 服务器。我尝试了一些变化，但没有一个像我预期的那样工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T08:06:21.870

`@x`你的xml在哪里...

```
set  @x.modify('delete (/a/b/c[@type="0"])') 
```

# git - git hook 脚本输出添加了烦人的“[K”后缀

> ID：12903955
> 
> 赞同：2
> 
> 时间：2012-10-15T21:03:54.480
> 
> 标签：git, hook

我们有一个使用 msysgit 1.7.11 的 git 服务器，

我们有一个设置，我们添加了一个 post receive hook 脚本，

该脚本正在运行一个调用 .NET 可执行文件的 .sh 脚本文件，因此该可执行文件的输出将返回到 git 并通过我们的服务器返回客户端，并带有令人讨厌的“[K”后缀（未显示在控制台中，但在“git gui”之类的工具中确实如此

输出：

```
...
remote: New deployment received.[K
remote: Updating branch 'master'.[K
... 
```

有什么办法可以解决这个问题并删除“[K”后缀？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T21:07:19.810

我的心理调试技能表明，这`[K`可能是用于清除到行尾的终端转义序列的一部分（参见[http://www.termsys.demon.co.uk/vtansi.htm](http://www.termsys.demon.co.uk/vtansi.htm)）。听起来这可能是由 .NET 可执行文件在显示其状态消息时生成的（在普通控制台上，它会相互覆盖，而不是出现在单独的行上）。

# bash - Shell/Bash - 通过变量管道输出到另一个脚本的输入

> ID：12903957
> 
> 赞同：1
> 
> 时间：2012-10-15T21:03:58.387
> 
> 标签：bash, pipe

通常我会将事情分解成单独的操作并将输出复制并粘贴到另一个输入中：

```
$ which git
/usr/local/bin/git
$ sudo mv git-credential-osxkeychain /usr/local/bin/git 
```

有什么快速的技巧可以将输出转换为输入吗？就像是： `$echo which wget | sudo mv git-credential-osxkeychain`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T21:29:53.480

```
set -vx
myGit=$(which git)
gitDir=${myGit#/git} ; gitDir=${gitDir#/bin}/git
echo sudo mv git-credential-osxkeychain ${gitDir} 
```

当您确定这会执行您需要的操作时，请删除最后一行的`set -vx`和。`echo`

可能可以减少所需的击键次数，但我认为这个版本更容易理解正在使用的技术以及它们是如何工作的。

IHTH

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T21:08:24.160

使用命令替换`$(command)`

```
sudo mv git-credential-osxkeychain $(which git) 
```

这用命令代替了它的输出。您可以在[http://tldp.org/LDP/abs/html/commandsub.html中找到所有相关信息](http://tldp.org/LDP/abs/html/commandsub.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T23:54:38.010

答案将是[Chirlo](https://stackoverflow.com/users/652378/chirlo)和[shellter](https://stackoverflow.com/users/620097/shellter)所说的。

为什么`$echo which wget | sudo mv git-credential-osxkeychain`不起作用是因为管道将标准输出从上一个命令重定向到下一个命令的标准输入。在这种情况下，`move`不从标准输入获取输入。

一个奇怪的事情是`which git`返回

```
/usr/local/bin/git 
```

`git-credential-osxkeychain`但你要搬到

```
/usr/local/git/bin/ 
```

这两个不匹配。有错字还是什么？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-16T17:08:47.833

如果你想使用管道语法，那么你应该看看`xargs`.

# jquery - 检查 URL 是否包含我已经点击的链接的 href

> ID：12903961
> 
> 赞同：0
> 
> 时间：2012-10-15T21:04:10.810
> 
> 标签：jquery, duplicates

在列表中，我有几个链接：

```
 <ul class="dropdowner" id="coll-filter">
    <li><a href="#black">Black</a></li>
    <li><a href="#white">White</a></li>
    <li><a href="#blue">Blue</a></li>
</ul> 
```

我在网址中使用 + 而不是 # 的另一个输出即：

```
 <ul class="dropdowner" id="coll-filter">
    <li><a href="+black">Black</a></li>
    <li><a href="+white">White</a></li>
    <li><a href="+blue">Blue</a></li>
</ul> 
```

如果我单击 White 链接，则会将“#white”插入到我的 URL 中。(mydomain.com/#white) 我想避免重复，所以有没有办法检查 URL 中是否已经存在“#white”，如果存在，则不允许点击链接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T21:13:22.490

默认情况下，这就像您所说的那样。如果 url 包含任何类型的 #value1 它*不会*重复，并且 url 永远不会看起来像：#value1#value1

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T21:08:58.200

使用 Javascript`window.location.hash`调用来确定当前的 URL 锚点是什么，并以此为基础制定您的逻辑：

```
$('.dropdowner a').click(function (event) {
   if ($(this).attr('href')==window.location.hash){
      return false;
   }
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-15T21:09:00.153

以下将禁用与 # 或 + 之后的 URL 组件匹配的链接以及启用任何以前禁用的链接：

```
$('.dropdowner a').on('click', function() {
    var url = window.location,
        tag = url.split('+'),
        hash = window.location.hash,
        supress = function(term) {
            $('.dropdowner a[href=' + term + ']').bind('click', false);
        };      
    $('.dropdowner a').unbind('click', false);
    if (hash) {            
        supress(hash);
    } else if (typeof tag !== 'undefined') {            
        supress('+' + tag);
    }        
}); 
```

看：

*   [http://api.jquery.com/bind/](http://api.jquery.com/bind/)
*   [http://api.jquery.com/unbind/](http://api.jquery.com/unbind/)
*   [https://developer.mozilla.org/en-US/docs/DOM/window.location#Properties](https://developer.mozilla.org/en-US/docs/DOM/window.location#Properties)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-15T21:09:05.440

这应该可以满足您的需求 - location.hash 为您提供来自 URL 的当前锚散列

```
$(function(){

    $('ul.dropdowner').find('a').click(function() {

        if ($(this).attr('href') == location.hash) {
            return false;
        }

    }

} 
```

# javascript - javascript函数中的var范围

> ID：12903969
> 
> 赞同：0
> 
> 时间：2012-10-15T21:04:44.383
> 
> 标签：javascript, closures, scope

我有以下带有以下预期和实际输出的小代码片段。我的问题很简单。为什么要按这个顺序打印？以及如何打印预期的输出？

格，

预期结果：

```
0
1
2
0
1
2 
```

实际结果：

```
0
1
2
3
3
3 
```

这是代码：

```
var functions = [];

for (var i=0; i<10; i++) {
  console.log (i);
  functions.push (function () {
    console.log (i);
  });
};

for (var j=0; j<functions.length; j++) {
  functions[j] ();
}; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-15T21:10:25.547

推入数组的函数不会记录`i`函数创建时的值，它们会记录`i`调用函数时的值。

一旦第一个循环结束，值为`i`is `10`，因此之后调用的任何函数都会记录 value `10`。

如果要保留`i`不同状态的值，可以使用闭包来复制该值：

```
for (var i=0; i<10; i++) {
  console.log (i);

  (function(){
    var copy = i;

    functions.push (function () {
      console.log (copy);
    });

  })();

}; 
```

局部变量`copy`将获取`i`并保留该值。您还可以将值作为参数传递给函数：

```
for (var i=0; i<10; i++) {
  console.log (i);

  (function(copy){

    functions.push (function () {
      console.log (copy);
    });

  })(i);

}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-15T21:12:01.130

预期的结果应该是：

```
1
2
...
10
10
10
... 7 more times 
```

这样做的原因是简单的。循环内部`console.log(i)`正确打印循环`i`每次迭代的值。当您创建一个函数并将其推送到`functions`数组中时，您所做的就是在同一个变量上关闭每个函数`i`。在你的循环结束时，`i`不再满足你的循环条件，所以`i = 10`是真的。结果，由于这些函数中的每一个都将执行`console.log(i)`，并且它们每个都在相同的 上关闭`i`，现在的值为 10，您应该期望看到值 10 打印了 10 次。

为了防止这种情况，您需要创建一个返回函数的函数，而不是直接在循环中创建函数：

```
var functions = [], i, j;
function createEmitter(i) {
  return function () {
    console.log(i);
  };
}

for (i = 0; i < 10; i++) {
  console.log(i);
  functions.push(createEmitter(i));
};

for (j = 0; j < functions.length; j++) {
  functions[j]();
}; 
```

现在，这些创建的函数中的每一个都在其自己的私有范围变量上关闭，从而解决了问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T21:23:37.840

*您应该将代码示例更新为 i < 3，以便您的结果和函数匹配。*

您推入`functions`数组的函数存储对变量 i 的引用，在执行顶部循环后，该引用为 10。因此，当它执行时，它将获取变量 i（即 10）并打印 10 次。

这是一个很好的方法来查看它的实际效果：

```
for (var i=0; i<10; i++) {
  console.log (i);
};

console.log(i) //=> 10 
```

使用变量时，请记住变量可以更改，它不会冻结在当前值。你只是坚持对其他事物的引用。

为了解决这个问题，我会在代码上运行这种类型的小重构（因为其他答案已经创建了一个额外的范围，我想我会给你一些不同的东西）。与其存储 10 个函数，不如存储数字并使用单个函数执行它们。无论如何，这是一种更优雅的编写方式，并且占用的空间更少。我确信这个例子是从真正给你问题的任何代码中抽象出来的，但一般模式仍然适用。

```
numbers = [];
for (var i=0; i<10; i++) {
  console.log (i);
  numbers.push(i);
};

numbers.forEach(function(i){
   console.log(i);
}); 
```

# opengl - OpenGL中的成对顶点属性

> ID：12903971
> 
> 赞同：0
> 
> 时间：2012-10-15T21:05:03.440
> 
> 标签：opengl

我正在尝试使用 OpenGL 可视化图形。我有 3D 空间中带有点的顶点缓冲区，以及指定顶点之间的线的索引缓冲区。我使用 glDrawElements 来绘制图形。一切正常。问题是我需要可视化边缘权重。我的问题是边缘权重是成对属性，我不知道如何将这些信息放入我的着色器中。我能想到的唯一解决方案是使用 DrawRangeElements 单独绘制每条边，并在每次调用之间设置边权重。有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T21:45:22.227

无需使用几何着色器。只需将它们渲染为`GL_LINES`，根据需要复制位置，并为线上的每对顶点提供相同的“权重”属性。这最终与渲染立方体没有什么不同，每个面都需要自己的法线。

如果（且仅当）您绝对必须恢复该内存，并且您不能简单地压缩顶点数据（使用标准化短裤、非标准化短裤或其他任何东西），这里有[一些您可以使用的技术](https://stackoverflow.com/questions/11148567/rendering-meshes-with-multiple-indices)。请注意：这是内存与性能的权衡。因此，除非您有*真正的*内存压力，否则只需复制您的顶点数据并完成它。

# iphone - 图像命名约定混淆和 UIBarButtonItem

> ID：12903972
> 
> 赞同：0
> 
> 时间：2012-10-15T21:05:14.267
> 
> 标签：iphone, objective-c, ios, uibarbuttonitem

我希望这是一个简单的解决方案，我似乎无法围绕一个概念。

当然，随着他们的视网膜显示器的引入，API 已经通过要求开发人员更改不同尺寸的图像名称来进行调整。

现在我只是尝试`UIBarButtonItem`使用该方法创建一个`initWithImage:style:target:action:`

我创建了一个以`barButtonImage.png`这些尺寸命名的图像：W:20px H:19px。我还创建了一个以`barButtonImage@2X.png`这些尺寸命名的图像：W:40px H:38px。

我假设 API 会适当地调整和缩放图像，但是当我在我的视网膜设备上构建和运行时，我得到一个`UIBarButtonItem`已将图像的高度适当地缩放到 19 像素但保持 40 像素宽度的图像完好无损，所以我有一个水平拉伸的图像适合宽`UIBarButtonItem`.

关于我可以做些什么来解决这个问题的任何建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T21:08:33.100

图片需要用@2x 命名，而不是@2X。真实设备上的 iOS 文件名区分大小写。

# android - 如何在 Eclipse 中多行格式化（写入）XML 字符串？

> ID：12903979
> 
> 赞同：0
> 
> 时间：2012-10-15T21:05:43.657
> 
> 标签：android, xml, formatting

我找不到是否有办法在 XML 中多行编写很长的字符串而不影响代码中的字符串行为。

我有常见问题解答部分，一些问题的答案是 EG 3-4 个句子，大约 400 个字符长。因此，对于我在字符串文件中按下的每个“Enter”（“Return”），在应用程序中显示它时都会得到新的段落。

我在这里读到连接不起作用，但我真的不需要它，我需要转义按下回车时出现的新段落。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T21:25:32.127

此外，您可以使用\n：

```
<string name="about_message">
    Line1\nLine2\nLine3
</string> 
```

# ruby-on-rails - Belongs_To / 有很多关系

> ID：12903980
> 
> 赞同：0
> 
> 时间：2012-10-15T21:05:45.390
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有以下内容：

客户有许多报告，报告属于一个客户。

但是，在创建报告时，它没有将 client_id 分配到数据库中，但不知道为什么？

我在这里做错了吗？

客户模型

```
class Client < ActiveRecord::Base
  has_many :reports, :dependent => :destroy
end 
```

报告模型

```
class Report < ActiveRecord::Base
  has_attached_file :report
  belongs_to :client

end 
```

客户端控制器（更新）

```
 # PUT /clients/1
  # PUT /clients/1.json
  def update
    @client = Client.find(params[:id])

    respond_to do |format|
      if @client.update_attributes(params[:client])
        format.html { redirect_to [:admin,@client], :notice => 'Client was successfully updated.' }
        format.json { head :ok }
      else
        format.html { render :action => "edit" }
        format.json { render :json => @client.errors, :status => :unprocessable_entity }
      end
    end
  end 
```

报表控制器（创建）

```
 # POST /reports
  # POST /reports.json
  def create
    @report = Report.new(params[:report])
    @report.client_id = params[:client][:client_id]

    respond_to do |format|
      if @report.save
        format.html { redirect_to '/admin/clients', :notice => 'Report was successfully created.' }
        format.json { render :json => @report, :status => :created, :location => @report }
      else
        format.html { render :action => "new" }
        format.json { render :json => @report.errors, :status => :unprocessable_entity }
      end
    end
  end 
```

客户端编辑视图

```
<%= form_for([:admin, @client.reports.build]) do |f| %>
   <label class="formlabel">Report Upload</label>
   <%= f.file_field :report, :class=>"text-input small-input"  %> 
  <div class="actions">
    <br />
   <%= f.submit 'Upload', :class => 'button' %>
  </div>
<% end %> 
```

协助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T21:19:21.177

client_id 在您的视图中的表单中没有相关的输入字段。您可以在表单中添加一些内容，例如：

```
f.hidden_field :client_id 
```

然后在您的控制器中，将其设置为：

```
@report.client_id = params[:report][:client_id] 
```

或者，您可以在 url 中包含 client_id。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T21:23:35.607

我很好奇; 因为您`.build`在 form_for 中使用，所以客户端可能已经在 url 中。

如果您删除：

```
@report.client_id = params[:client][:client_id] 
```

并提交，然后会发生什么？因为这条线在参数上看起来不正确，所以我想知道你是否覆盖了你在`form_for`

要么这样，要么像@Adam 说的隐藏字段都可以。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-18T08:56:21.793

愚蠢的错误似乎需要在表单上打开最终功能，以便客户在打开报表之前关闭它。

然后为 client_id 添加字段，现在按照 Adam 的建议隐藏该字段。

感谢 Steph 的建议，因为这可以帮助我解决这个错误。

谢谢大家！:-)

# app-store - 我的公司名称被 Apple 更改了？

> ID：12903981
> 
> 赞同：0
> 
> 时间：2012-10-15T21:05:51.167
> 
> 标签：app-store, app-store-connect

我们有两个个人帐户。名称是 Mavi Digital Media 和 Mavi Mobile。苹果从 Appstore 中删除了公司名称并写下了自己的个人名称。为什么？Mavi Mobile 被 ZZ MM 取代。Mavi Digital Media 被 XX YY 取代。我们想使用 Mavi Mobile 和 Mavi Digital Media。任何解决方案？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T21:27:03.237

任何一个：

1.  给苹果发邮件。
2.  电话苹果。

您可以在此处找到联系信息 - [https://developer.apple.com/contact/](https://developer.apple.com/contact/)

我没有理由认为苹果会突然改变它。所以，联系他们并询问他们。

# c# - 即使为空，linq 也会返回对象

> ID：12903982
> 
> 赞同：0
> 
> 时间：2012-10-15T21:05:55.393
> 
> 标签：c#, linq-to-sql

我有一个看起来像这样的查询：

```
var TheQuery = (from t in MyDC.Table
                where....
                select new MyModel()
                {
                    Property1 = (int?)... ?? 0
                } 
```

有时，`where`查询中的子句不返回数据来执行`select`. 发生这种情况时，`MyModel`为空。我希望`?? 0`对于每个属性，查询仍然会返回一个`Property1`设置为 0 的对象。

我该如何重写它，以便当没有数据填充 MyModel 时，MyModel 不会返回 null？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T21:10:50.773

好吧，如果没有可供选择的内容，则不会创建 MyModel。TheQuery 将是一个空的 IEnumerable。

如果您获得空对象列表，我不确定会发生什么。我不确定这怎么可能。

您可以检查您的查询是否有结果，如下所示：

```
var TheQuery =  from t in MyDC.Table
                where....
                select new MyModel()
                {
                    Property1 = (int?)... ?? 0
                }

var after = TheQuery.Any() ? 
            TheQuery : 
            Enumerable.Range(0, 1).Select(k => new MyModel() { Property1 = 0 }); 
```

# c++ - 在线程池类中将函数指针作为函数模板发送

> ID：12903985
> 
> 赞同：0
> 
> 时间：2012-10-15T21:06:08.207
> 
> 标签：c++, multithreading, templates, c++11, lambda

我正在尝试使用这个家伙的 ThreadPool 实现：[https ://github.com/progschj/ThreadPool](https://github.com/progschj/ThreadPool)

我在向该`enqueue`方法添加“功能”时遇到问题...这是以下`enqueue`方法的实现：

```
// add new work item to the pool
template<class T, class F>
Result<T> ThreadPool::enqueue(F f)
{
    Result<T> res;
    {
        std::unique_lock<std::mutex> lock(queue_mutex);
        tasks.push_back(std::function<void()>(
        [f,res]()
        {
            CallAndSet<T,F>()(res, f);
        }));
    }
    condition.notify_one();
    return res;
} 
```

这是我正在使用的：

```
#include "ThreadPool.h"
#include <stdio.h>
#include <iostream>

int main() {
    // create a thread pool of 4 worker threads
    ThreadPool pool(4);

    // queue a bunch of "work items"
    for(int i = 0; i < 8; ++i) {
        pool.enqueue([i] {
            std::cout << "hello " << i << std::endl;

            std::cout << "world " << i << std::endl;
        });
    }
} 
```

它是示例代码的一部分，试图展示如何使用该库......

编译的输出是：

```
scons: Reading SConscript files ...
scons: done reading SConscript files.
scons: Building targets ...
scons: building associated VariantDir targets: build
g++ -o build/main.o -c -std=c++11 -pthread -Wall -g main.cpp
main.cpp: In function 'int main()':
main.cpp:15:7: error: no matching function for call to 'ThreadPool::enqueue(main()::<lambda()>)'
main.cpp:15:7: note: candidate is:
In file included from main.cpp:1:0:
ThreadPool.h:117:15: note: template<class T, class F> Result<T> ThreadPool::enqueue(F)
ThreadPool.h:117:15: note:   template argument deduction/substitution failed:
main.cpp:15:7: note:   couldn't deduce template parameter 'T'
scons: *** [build/main.o] Error 1
scons: building terminated because of errors. 
```

我对模板化的东西一无所知..我不知道为什么上面的方法行不通……有人有什么想法吗？

干杯

贾勒特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T21:12:44.657

您必须明确指定 T 因为它不是参数列表的一部分，因此无法减少。

```
 pool.enqueue<TheType>(functor); 
```

我无法仅从片段中猜出 T 应该是什么。

# javascript - Highcharts.js - 手动渲染单个饼图

> ID：12903988
> 
> 赞同：0
> 
> 时间：2012-10-15T21:06:21.730
> 
> 标签：javascript, jquery, highcharts

我可以这样做吗？

从*文档*中，您可以通过传入一个函数来格式化“dataLabels”。我想从 PieChart 中为单个*饼图*着色时获得相同的控制。

我知道我可以传入一个颜色数组，但我不想让 Highcharts 自动设置这些颜色值，我想根据饼图/区域的值设置颜色。

想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T23:41:26.443

您可以如下设置每个切片的颜色。这是一个[例子](http://jsfiddle.net/a86By/)。

```
 data: [
                    {
                        name: 'A',
                        y: 1,
                        sliced: true,
                        selected: true,
                        color: getColor(1)
                    },
                    {
                        name: 'B',
                        y: 12.8,
                        sliced: false,
                        selected: false,
                        color: getColor(12.8)
                    },
                    {
                        name: 'C',
                        y: 52.8,
                        sliced: false,
                        selected: false,
                        color: getColor(52.8)
                    }
                ] 
```

只需根据其值设置每个点的颜色即可。

此外，您可以动态更新颜色，例如

```
function updateChart() {
    chart.series[0].data[1].update({
        color: '#ff0'
    });
} 
```

# php - fwrite 在本地主机上使用瑞典字符 php

> ID：12903989
> 
> 赞同：2
> 
> 时间：2012-10-15T21:06:22.583
> 
> 标签：php, localhost, fwrite

此代码适用于我的虚拟主机，但不适用于我的本地主机。我怎样才能让它在我的本地主机上工作（我使用 Windows）？

文件名是“Ã¥Ã¤Ã¶.html”。

```
<?php

$src = 'testing';

$file_name = 'åäö.html';

$fopen=fopen($file_name, 'w');
fwrite($fopen, $src);
fclose($fopen);

?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T21:30:17.153

MS Windows 以字符编码的常见问题而闻名。在您的情况下，您的“网络主机”似乎使用 UTF-8 作为编码，而您的本地 MS-Windows 系统使用 8 位编码。这可能是某种 ISO-8859 编码，但更有可能是不知名的 windows 代码页 1251 或其他几乎但不是真正的 ISO 编码。这似乎很可能，因为您可以看到 3 个 utf 字符在您的 MS-Windows 系统中被“转换”为六个字符。典型用于非 ASCII 字符。

您有以下三种选择：

1.  尝试使用 phps`default_charset`设置。您可以在 Web 服务器 php 解释器使用的 php.ini 文件中找到它。
2.  您将 MS-Windows 系统切换为在内部使用 UTF-8 编码，就像现在其他系统所做的那样（这显然是有道理的）。然而这并不容易，尤其是切换现有系统可能不是一个好主意。
3.  您必须转换在两个世界之间交换的所有字符串。由于编码的自动检测不能可靠地工作（实际上可以证明它不能可靠地工作），因此您必须对特定的转换进行编码。PHP 确实提供了这样的例程，但从长远来看这样做很痛苦。在这种情况下，您传输一个 php 文件，这意味着手动将所有此类字符串（编程语言仅使用 ASCII 字母，它们在两种编码中都是“合法”字符，但`string`值不是这种情况）到其他编码.

顺便说一句：您可以通过使用允许在编码之间轻松切换的文本编辑器来玩一些编码（来回切换）。这有助于了解正在发生的事情。HexEditor 是一个非常有用的工具，可以找出文件中*真正*存储的内容:-)

# spring - Spring BasicDataSource 重现池错误超时等待空闲对象

> ID：12903993
> 
> 赞同：0
> 
> 时间：2012-10-15T21:06:43.537
> 
> 标签：spring, timeout, connection-pooling, spring-jdbc

使用 java/Spring/Ibatis sqlserver 是数据库，datasource`org.apache.commons.dbcp.BasicDataSource`下面是源对象

```
<bean id="wssModelDataSource" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close">
    <property name="driverClassName" value="net.sourceforge.jtds.jdbcx.JtdsDataSource"/>
    <property name="url" value="com.wss.jdbc.ConnectionUrl=jdbc:jtds:sqlserver://x-x2/x_control_QA;appName=wss;sendStringParametersAsUnicode=false;loginTimeout=20;socketTimeout=180"/>
    <property name="username" value="xxx"/>
    <property name="password" value="xxx"/>
    <property name="maxActive" value="10"/>
    <property name="maxWait" value="10000"/>
  </bean> 
```

在日志文件中，我们发现了以下异常。

```
--- Cause: org.apache.commons.dbcp.SQLNestedException: Cannot get a connection, pool error Timeout waiting for idle object] 
```

堆栈跟踪如下

```
Caused by: org.apache.commons.dbcp.SQLNestedException: Cannot get a connection, general error
        at org.apache.commons.dbcp.PoolingDataSource.getConnection(PoolingDataSource.java:118)
        at org.apache.commons.dbcp.BasicDataSource.getConnection(BasicDataSource.java:1044)
        at org.springframework.jdbc.datasource.DataSourceUtils.doGetConnection(DataSourceUtils.java:113)
        at org.springframework.jdbc.datasource.TransactionAwareDataSourceProxy.invoke(TransactionAwareDataSourceProxy.java:210)
        at .prepareStatement(Unknown Source)
        at com.ibatis.sqlmap.engine.execution.SqlExecutor.prepareStatement(SqlExecutor.java:494)
        at com.ibatis.sqlmap.engine.execution.SqlExecutor.executeQuery(SqlExecutor.java:176)
        at com.ibatis.sqlmap.engine.mapping.statement.GeneralStatement.sqlExecuteQuery(GeneralStatement.java:205)
        at com.ibatis.sqlmap.engine.mapping.statement.GeneralStatement.executeQueryWithCallback(GeneralStatement.java:173)
        ... 196 more
Caused by: java.lang.InterruptedException
        at java.lang.Object.wait(Native Method)
        at org.apache.commons.pool.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:1112)
        at org.apache.commons.dbcp.PoolingDataSource.getConnection(PoolingDataSource.java:106)
        ... 204 more
2012-10-15 04:29:57,258 [Thread-2] INFO  [ConnectionManagerImpl.java:58] : user[] Stopping managed instances...
2012-10-15 04:29:57,444 [http-bio-8000-exec-81187] INFO  [LoggingInterceptor.java:42] : user[] uri[/wss/security/login_submit.html] took[6.612] seconds
2012-10-15 04:29:57,451 [http-bio-8000-exec-81182] ERROR [LoginSubmitAction.java:121] : user[] Exception logging in[
--- The error occurred in ibatis/control_core.xml.
--- The error occurred while executing query. 
```

我正在尝试使用带有用户凭据的 Jmeter http 登录请求作为参数来重现此错误，这让我可以成功登录，从而导致从控制器调用 DAO 层。

但问题是我尝试过使用 3 个 Jmeter 实例运行永远循环 100 个线程，但它没有重现问题？任何快速的想法我怎样才能重现这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T20:58:23.557

我使用 Jmeter 重现了这个错误，我创建了 httprequest 请求登录参数并启动了 5 个 JMeter 实例。终于能够重现这个问题。