# StackOverflow 问答 13850000-13850999

# perl - 如何设置 MojoX::Sessions 的 cookie 过期时间？

> ID：13850004
> 
> 赞同：1
> 
> 时间：2012-12-12T22:45:09.340
> 
> 标签：perl, session-cookies, mojolicious, mojolicious-lite

无论我给`expires()`or`expires_delta()`的过期值是什么，cookie 的过期时间总是一小时。如何更改它以使会话和 cookie 过期时间匹配？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T00:02:07.693

尽管我喜欢 vti 的工作，但该发行版看起来已经过时并且在过去已被替换。[今天，在Mojolicious::Sessions](http://mojolicio.us/perldoc/Mojolicious/Sessions#default_expiration)中解释了设置会话过期日期的标准方法：

> ## default_expiration
> 
> ```
> my $time  = $sessions->default_expiration;
> $sessions = $sessions->default_expiration(3600); 
> ```
> 
> 会话从现在开始以秒为单位过期的默认时间，默认为 `3600`. 每次请求都会刷新过期超时。将该值设置为 0 将允许会话持续到浏览器窗口关闭，但这可能会产生安全隐患。要获得更多控制，您还可以使用`expiration`和`expires`session 值。
> 
> ```
> # Expiration date in epoch seconds from now (persists between requests)
> $c->session(expiration => 604800);
> 
> # Expiration date as absolute epoch time (only valid for one request)
> $c->session(expires => time + 604800);
> 
> # Delete whole session by setting an expiration date in the past
> $c->session(expires => 1); 
> ```

我写了一个小测试脚本来确保它工作：

```
#!/usr/bin/env perl

use Mojolicious::Lite;
use Time::Local 'timegm';

# set some session variable
get '/test' => sub {
    my $self = shift;
    $self->session(
        expires => timegm(0, 0, 0, 4, 4, 142), # star wars day '42
        foo     => 42,
    );
    $self->render_text('foo is set');
};

use Test::More;
use Test::Mojo;
use Mojo::Cookie::Response;
my $t = Test::Mojo->new;

$t->get_ok('/test')->status_is(200)->content_is('foo is set');
my $cookies = Mojo::Cookie::Response->parse($t->tx->res->headers->set_cookie);
is $cookies->[0]->expires, 'Sun, 04 May 2042 00:00:00 GMT', 'right expire time';

done_testing; 
```

输出：

```
ok 1 - get /test
ok 2 - 200 OK
ok 3 - exact match for content
ok 4 - right expire time
1..4 
```

# wso2 - WSO2 SOAP API/WSDL 在哪里？

> ID：13850007
> 
> 赞同：0
> 
> 时间：2012-12-12T22:45:17.620
> 
> 标签：wso2, wso2esb, wso2carbon, wso2dss

我一直在到处阅读，包括[这里](http://web.archiveorange.com/archive/v/XWiKoM1gYKACJzbS6Fij)和[这里](https://stackoverflow.com/questions/8345934/xacml-java-api-recommendation)，WSO2 为其服务提供了 SOAP API。我的问题是他们在哪里？我怎样才能找到它们？例如，如果有 WSO2 提供的 XACML API，我该如何找到它。

我对WSO2平台的理解是，ESB、STS、DSS、IS都是服务。要公开它们的功能，您必须编写标准 XML，然后将其导入 WSO2 后端。在此之后，生成可供客户端使用的 WSDL。我对吗？如果没有，那么我有简单的问题；

所有 IS 服务的端点或服务 url 是什么？所有 ESB 服务的端点或服务 url 是什么？所有 STS 服务的端点或服务 url 是什么？所有 DSS 服务的端点或服务 url 是什么？

谢谢你的解释。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T02:21:37.130

WSO2 使用管理服务，默认情况下它们不会暴露在外部并通过 https 暴露。

您可以通过引用此[线程](https://stackoverflow.com/questions/12368079/wso2-admin-service)来查看可用服务列表。

[此处](http://xacmlinfo.com/2012/06/13/pdp-pep-communication-wso2is/)提供了有关使用管理服务的另一个示例。

[此处](http://blog.shelan.org/2012/09/create-proxy-in-wso2-esb-using-admin.html)提供使用代理管理服务创建代理服务的示例

# sql-server - 您可以在参数化查询中两次使用相同的变量吗？这样做会带来速度优势吗？

> ID：13850009
> 
> 赞同：1
> 
> 时间：2012-12-12T22:45:27.727
> 
> 标签：sql-server, vb.net

我可以有一个像这样的查询吗

```
"INSERT INTO Table1 VALUES (@val1, @val2, @val3); INSERT INTO Table2 VALUES (@val2, @val3)" 
```

第一，在 VB.NET 中进行参数化查询是否接受重复变量，第二，这样做会提供任何形式的速度提升吗？我想使用它而不是做两个不同的参数化插入。是的，在你提到它之前，存储过程不是一个选项。我不会去解释为什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-12T22:48:38.537

是的你可以。较小的变量将是一个加号，但如果它们的数量很少，则性能/内存使用情况不会有**太大差异（明显）**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T22:55:56.870

是的，你可以，看看这可能会有所帮助[http://www.databasejournal.com/features/mssql/article.php/3834501/Parameterized-Queries.htm](http://www.databasejournal.com/features/mssql/article.php/3834501/Parameterized-Queries.htm)

:)

# javascript - 我堆叠的 svg 图像在显示时闪烁

> ID：13850011
> 
> 赞同：0
> 
> 时间：2012-12-12T22:45:32.600
> 
> 标签：javascript, image, html, flicker

我最多堆叠 6 个 svg 图像，以为用户创建交互式图像。（使用 div 中的嵌入标签堆叠）。

目前，每个图像都在绘制自己，导致在绘制底部图像然后绘制顶部图像时闪烁。

我已经在 CSS 中预加载了图像

```
#element_01 {
    background: url(img/model/model.png) no-repeat;
    display: none;
    } 
```

我已经尝试并成功隐藏了 div 元素，然后显示它。

```
 '<div class="modelImage" style="visibility:hidden">'+
    '<embed id="myTop"  src="img/model/top.svg"     onload="this.getSVGDocument().onclick = function(event){control.colorClothes(0);};"     title="top"     type="image/svg+xml" width="325" height="500">'+ 
```

其次是

```
 $(document).ready(function(){
        $(".modelImage")[0].style.visibility = "visible";
    }); 
```

警报确认这是可行的，但没有警报，图像仍会按顺序写入，从而导致闪烁。令人沮丧的是，当我收到警报时，图像打印得很好！

# android - Android HttpPut 没有正文，尽管设置了实体

> ID：13850012
> 
> 赞同：0
> 
> 时间：2012-12-12T22:45:36.703
> 
> 标签：android, android-4.2-jelly-bean, http-put

我正在尝试将一些 XML 放入服务器，但其要点是无论我做什么，HttpPut 都不会在 Http 正文中放入任何内容。服务器总是回来说尸体不见了，通过Wireshark查看，什么都没有！这是我用来设置和运行请求的代码：

```
HttpPut putRequest = new HttpPut(urlString]);

StringEntity stringEntity = new StringEntity(xmlString, HTTP.ISO_8859_1);
stringEntity.setContentType("text/xml");
putRequest.setEntity(stringEntity);

putRequest.addHeader("Host", formatUrlForHostHeader(broadsoftUrl));
putRequest.addHeader("Authorization", authorizationString);
putRequest.addHeader("Content-Type", "text/xml");
putRequest.addHeader("Accept", "text/xml");

response = httpClient.execute(putRequest); 
```

我不确定这里还包括什么。我在 4.2 和 4.0.3 上试过。此代码在 AsyncTask 的 doInBackground 中运行。我得到的响应代码是 409 冲突，正文是服务器的特定于应用程序的消息，告诉我正文丢失。我确认 Wireshark 缺少它。

**编辑：**

一个有趣的提示是，我在桌面上独立运行了相同的代码，并且它有效。那么，Android 版本的 HttpClient 或系统有什么问题吗？我也尝试了几个不同的 API 级别，只是为了检查。

有什么想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T01:50:32.217

好的，所以解决方案是放弃 HttpPut 和所有这些，并使用 HttpURLConnection。以下是我们最终如何做到的：

```
URL url = new URL(theUrl);
HttpURLConnection httpCon = (HttpURLConnection) url.openConnection();
httpCon.setRequestProperty("Host", formatUrlForHostHeader(broadsoftUrl));
httpCon.setRequestProperty("Authorization", authorizationString);
httpCon.setRequestProperty("Content-Type", "text/xml; charset=ISO_8859_1");
httpCon.setRequestProperty("Accept", "text/xml");
httpCon.setDoInput(true);
httpCon.setDoOutput(true);
httpCon.setRequestMethod("PUT");
OutputStreamWriter out = new OutputStreamWriter(httpCon.getOutputStream(), "ISO_8859_1");
out.write(xmlData);
out.close();

if(httpCon.getErrorStream() == null) {
    return "";
} else {
    return "ERROR";
} 
```

我们不需要从 PUT 请求中获取响应，但是您可以通过查看错误流是否存在来检查它是否失败。如果你想得到回应，你会做这样的事情：

```
StringWriter writer = new StringWriter();
IOUtils.copy(httpCon.getInputStream(), writer, encoding);
String responseString = writer.toString(); 
```

当然，您必须在您的应用程序中包含 Apache 的 IOTools。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-13T00:02:41.993

409 Conflict*通常是*一个[编辑冲突](http://en.wikipedia.org/wiki/Edit_conflict)错误，通常与 wiki 相关联，但它可能是与请求的任何类型的冲突。

[http://en.wikipedia.org/wiki/List_of_HTTP_status_codes](http://en.wikipedia.org/wiki/List_of_HTTP_status_codes)

[http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)

您要发布什么类型的数据，主机是否有无法更改的现有数据？

# ios - Safari iOS 中带有视频的“完成”按钮的回调

> ID：13850016
> 
> 赞同：2
> 
> 时间：2012-12-12T22:45:51.557
> 
> 标签：ios, video, safari, callback

我想知道，当用户在 iPhone 上的 Safari 中观看视频后，点击“完成”按钮时是否有回调？

当视频播放完毕时，有一些方法可以在视频元素上获得回调，但如果视频设置为循环播放则不行。在尝试检测用户是否已完成观看视频时，循环会带来问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T10:24:05.597

有点晚了抱歉:)但这是解决方案：

```
player = document.getElementById('videoplayer');

//when a user press DONE or PAUSE the first time is triggered the paused event so you can control with:
player.addEventListener("pause", function() {
   //desired "done or puase button" behavior defined here
}, false);

//this is triggered when exit the fullscreen, or for example whrn the user First press PAUSE and THen press DONE

player.addEventListener('webkitendfullscreen', function() {
   //desired "done button" behavior defined here
}, false); 
```

# objective-c - ARC 迁移器在其他目标中返回错误

> ID：13850018
> 
> 赞同：3
> 
> 时间：2012-12-12T22:46:12.820
> 
> 标签：objective-c, ios, cocoa, automatic-ref-counting, refcounting

我正在尝试将旧项目转换为 ARC。我的项目依赖于 Cocos2D，它是一个第三方非 ARC 库。所有 Cocos2D 源文件都是单独目标的一部分，并被编译为静态库。

但是，ARC 迁移`ARC semantic issue`器在 Cocos2D 源文件中返回错误，即使它们不是我要转换的主要目标的一部分。

这可能是什么原因？那个源代码应该没关系，对吧？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T22:51:49.537

一般来说，最安全的做法是不对不属于您的代码执行 ARC 转换。因此，您可以告诉编译器不要将 ARC 与 Cocos2D 代码一起使用，方法是进入目标设置中的“构建阶段”，按照[Transitioning to ARC Release Notes](http://developer.apple.com/library/ios/releasenotes/ObjectiveC/RN-TransitioningToARC/Introduction/Introduction.html#//apple_ref/doc/uid/TP40011226-CH1-SW15)`-fno-objc-arc`中的说明添加标志。您只需展开“Build Phases”的“Compile Sources”部分，双击Cocos2D 源文件，然后在弹出框中输入。`-fno-objc-arc`

话虽如此，我很欣赏可能涉及很多 .m 文件。因此，有一些消息来源提出了处理 Cocos2D 和 ARC 的不同方法，例如[在 Cocos2D 项目中启用 ARC](http://www.learn-cocos2d.com/2012/04/enabling-arc-cocos2d-project-howto-stepbystep-tutorialguide/)。

# java - 在 ActionListener 中调用对象不起作用，但在对象类 main 中起作用

> ID：13850031
> 
> 赞同：1
> 
> 时间：2012-12-12T22:47:18.583
> 
> 标签：java, swing

我正在写一个java图像面板，用java中的图像制作一些东西。这是第一次尝试，看看我怎样才能做得更好。

所以我写了这三个类，问题是当我在类中使用类`Diaporama`（你可以看到下面的代码）时，`MainWindow`我什么也没显示。但是，如果我`public static void main (String [] args)`在 Diaporama 类中使用，一切正常。

```
/**RechercheFichier.java*/
//this class while return an ArrayList of String which contain all file path selected

public class RechercheFichier {

    private JFileChooser myFileChooser;
    private ArrayList<String> FileList;

    public RechercheFichier() {
        myFileChooser = new JFileChooser();
        myFileChooser.setCurrentDirectory(new File("."));
        myFileChooser.setFileSelectionMode(JFileChooser.FILES_AND_DIRECTORIES);
        try {
            int value = myFileChooser.showOpenDialog(null);
            if (value == JFileChooser.APPROVE_OPTION) {
                File SelectedFile = myFileChooser.getSelectedFile();
                String Filename = SelectedFile.getPath();
                FileList = new ArrayList<String>();
                if (SelectedFile.isDirectory()) {
                    String[] myFile = SelectedFile.list();
                    for (int i = 0; i < myFile.length; i++) {
                        if (myFile[i].endsWith(".png") == true
                                || myFile[i].endsWith(".jpg") == true
                                || myFile[i].endsWith(".jpeg") == true) {
                            FileList.add(Filename + "/" + myFile[i]);
                        }
                    }
                } else
                    FileList.add(Filename);
            } else
                JOptionPane.showMessageDialog(null,
                        "User did not choose a file.");
        } catch (Exception e) {
            JOptionPane.showMessageDialog(null, e.getMessage(), "Error",
                    JOptionPane.ERROR_MESSAGE);
        }
    }

    //getter and setter
    public ArrayList<String> getFileList() {
        return FileList;
    }

    public void setFileList(ArrayList<String> fileList) {
        FileList = fileList;
    } 
```

透视类：

```
/**Diaporama.java*/ 
public class Diaporama extends JFrame {

    private JFrame frame;
    private JPanel panel;
    private JLabel lab;

    public Diaporama() {
        frame =  new JFrame();
        panel = new JPanel();
        lab = null;
        frame.setTitle("Diaporama");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        RechercheFichier file = new RechercheFichier();
        ArrayList<String> toto = file.getFileList(); //toto contain all file path
        //Collections.sort(toto);
        for (int i = 0; i < toto.size(); i++) {
            panel = new JPanel();
            frame.setLayout(new GridLayout(1,1));
            frame.setVisible(true);
            frame.setSize(600, 500);
            frame.setLocation(200, 200);
            // this.image = getToolkit().getImage(toto.get(i));
            System.out.println(toto.get(i));
            this.lab = new JLabel(new ImageIcon(toto.get(i)));
            panel.add(lab);
            frame.setContentPane(panel);
            try {
                Thread.sleep(2000L);
            } catch (InterruptedException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

            // imagePanel.remove(imagePanel);
            panel.remove(lab);
            panel.revalidate();
            frame.pack();

            frame.repaint();
            panel = null;
        }
        frame.dispose();
    }

    //public static void main(String [] args)
    //{
    //  new Diaporama();
    //} 
```

主窗口类：

```
/** MainWindow.java**/
public class MainWindow extends JFrame implements ActionListener{

    private JFrame frame;
    private JButton buttonDiapo, buttonOpen, buttonSearch, buttonTag, buttonAlbum, buttonQuit;
    private JPanel panel;

    public JFrame getFrame()
    {
        return frame;
    }

    public MainWindow()
    {
            frame = new JFrame("The best Jphoto");
            frame.setSize(300, 400);
            frame.setLocation(200, 200);
            buttonDiapo = new JButton("Diaporama");
            buttonOpen = new JButton("Ouvrir Photo");
            buttonQuit = new JButton ("Quitter");
            buttonSearch = new JButton("Recherche par tag");
            buttonTag = new JButton("Add tag");
            buttonAlbum = new JButton("Creer un album");
            panel = new JPanel();
            panel.setLayout(new FlowLayout());
            panel.add(buttonOpen);
            panel.add(buttonDiapo);
            panel.add(buttonAlbum);
            panel.add(buttonSearch);
            panel.add(buttonTag);
            panel.add(buttonQuit);
            frame.getContentPane().add(panel, BorderLayout.CENTER);
            frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
            frame.pack();
            frame.setVisible(true);
            //ajout du action Listener pour le bouton Open
            buttonOpen.addActionListener(new ActionListener() {
                public void actionPerformed(ActionEvent e) {
                    // new OpenImg();
                }
            });
            //ajout du action Listener pour le bouton Diapo
            buttonDiapo.addActionListener(new ActionListener() {
                @Override
                public void actionPerformed(ActionEvent e) {
                              //the problem is here
                     new Diaporama();

                }
            });
            buttonQuit.addActionListener(new ActionListener() {
                public void actionPerformed(ActionEvent e) {
                    System.exit(0);
                }
            });

            buttonAlbum.addActionListener(new ActionListener() {
                public void actionPerformed(ActionEvent e) {
                    // new Album();
                }
            });

            buttonSearch.addActionListener(new ActionListener() {
                public void actionPerformed(ActionEvent e) {
                    // new Search();
                }
            });

            buttonTag.addActionListener(new ActionListener() {
                public void actionPerformed(ActionEvent e) {
                    // new Tag();
                }
            });
        }

        public static void main(String[] args) {
            // Set the look and feel to Java Swing Look
            new MainWindow();
        }

        @Override
        public void actionPerformed(ActionEvent e) {
            // TODO Auto-generated method stub

        }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T22:54:24.490

```
 public static void main (String [] args) 
```

提供程序的入口点。没有它，任何东西都无法运行。

在 Java 语言中，当您使用 Java 解释器执行一个类时，运行时系统首先调用该类的 main() 方法。然后 main() 方法调用运行应用程序所需的所有其他方法。

有关更多信息，请点击此链接[http://wiki.answers.com/Q/What_is_the_use_of_main_method_in_java](http://wiki.answers.com/Q/What_is_the_use_of_main_method_in_java)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-12T22:57:46.293

`JFrame`每次点击按钮都弹出s，效率有点低。您是否考虑过使用[JDialogs](http://www.java2s.com/Tutorial/Java/0240__Swing/1220__JDialog.htm)？

但是，如果您真的想要解决您的问题，您可以尝试：

```
 Diaporama diaporamaFrame = new Diaporama();
 diaporamaFrame.setVisible(true); 
```

把它贴在你的听众身上。祝你好运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-16T00:27:05.047

我终于改变了 Diaporama 类，我将它实现为

```
线程实例
```

. 奇怪的是，

```
将 Diaporama 实现为 Runnable 并将其作为线程午餐，使其工作
```

. 但是，我仍然不明白为什么第一个版本不起作用。我的一些老师告诉我关于java图形线程，不会刷新框架，或者类似的东西。

谢谢您的帮助

我在这里粘贴我的新代码。

```
import java.util.ArrayList;
@SuppressWarnings("serial")
public class DiapoThread implements Runnable {

    Thread thread;
    ArrayList<String> toto = null;

    public void init() {
        RechercheFichier file = new RechercheFichier();
        file.RechercheFichierFileOrDirectory();
        toto = file.getFileList();
    }

    public void start() {
        (thread = new Thread(this)).start();
    }

    public void stop() {
        thread = null;
    }

    public void run() {
        this.init();
        new DiaporamaView(toto);
        this.stop();
    }
} 
```

```
DiaporamaView.java
```

```
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.GridLayout;
import java.awt.Image;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.io.File;
import java.util.ArrayList;
import javax.imageio.ImageIO;
import javax.swing.ImageIcon;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;

@SuppressWarnings("serial")
public class DiaporamaView extends JFrame{

    private int iframe = 0;
    private JFrame frame = null;
    private JPanel panel = null;
    private JLabel lab = null;
    private ArrayList<String> toto = null;

    public DiaporamaView(ArrayList<String> list)
    {
        ArrayList<String> toto = list;
        long delay = 2500L;
        frame = new JFrame();
        panel = new JPanel();
        JPanel panBoutton = new JPanel();
        frame.setTitle("Diaporama");
        frame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
        frame.setLayout(new BorderLayout());
        frame.add(panel, BorderLayout.CENTER);
        panBoutton.setLayout(new GridLayout(1,1));
        JButton fermer = new JButton("fermer fenetre");
        fermer.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e) {
                frame.dispose();
            }
        });
        panBoutton.add(fermer);
        this.frame.setVisible(true);
        this.panel.setBackground(Color.GRAY);
        frame.setLocation(100, 200);
        try {
            while (iframe < toto.size()) {
                if (iframe == 0)
                frame.setSize(400, 450);
                else if (iframe % 2 == 0)
                    frame.setSize(401, 451);
                else
                    frame.setSize(399, 449);
                Image img = ImageIO.read(new File(toto.get(iframe)));
//              redimensionner les images, 
                int width = img.getWidth(null);
                int height = img.getHeight(null);
                int new_height = 448;
                int new_width = (width / height) * new_height; 
                ImageIcon ii = new ImageIcon(img.getScaledInstance(new_width, new_height, img.SCALE_FAST));
                this.lab = new JLabel(ii);
                panel.add(lab);
                frame.add(panBoutton, BorderLayout.SOUTH);
                //repaint();
                Thread.sleep(delay);
                panel.remove(lab);
                panel.revalidate();
                iframe++;
//              frame.pack();
                 frame.repaint();
            }

        } catch (Exception e) {
            e.printStackTrace();
        }
    } 
```

# iphone - IOSlinkedin 集成（发送连接请求，搜索人）

> ID：13850034
> 
> 赞同：1
> 
> 时间：2012-12-12T22:47:41.873
> 
> 标签：iphone, ios, oauth, linkedin

我正在使用linkedin OAuth sdk。

我的 oauth 功能正常工作，我的 iPhone 应用程序能够成功登录到 LinkedIn。

我想实现这两件事。

1.  我想使用 JSON 协议搜索人。
2.  我想发送从搜索中获得的连接请求人。

请尽快为我提供帮助。建议我示例代码（如果有）。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T02:21:26.530

我无法为您的问题提供具体答案，但您应该查看这个开源项目。

[适用于 iOS 的 LinkedIn Share](http://www.cocoacontrols.com/platforms/ios/controls/linkedin-share)

# ruby-on-rails - 在 Rails 的同一页面上添加和编辑表单

> ID：13850035
> 
> 赞同：1
> 
> 时间：2012-12-12T22:47:52.403
> 
> 标签：ruby-on-rails, multiple-forms

我想在同一页面上为模型添加和编辑表单。您可以在此屏幕截图中看到我正在使用 JS 显示和隐藏 2 个表单：

![添加和编辑表单](../Images/6776c9b8e054460ccca3256063b6eec2.png)

在编辑表单中，用户选择一个 Aircraft ID 并使用一些 Ajax 填充其他数据。

目前，我正在从这样的部分渲染这两种形式：

```
<!-- Add Aircraft -->
<div id="aircraftmodal-add-content">
  <%= render 'aircrafts/new' %>
</div>
<!-- Edit Aircraft -->
<div id="aircraftmodal-edit-content">
  <%= render 'aircrafts/edit' %>
</div> 
```

我的表单呈现几乎相同的内容，我通过为 Edit 表单提供不同的 ID 来绕过它：

```
<!-- Add Partial --->
<%= form_for @aircraft, validate: true, remote:true do |air| %>

<!-- Edit Partial -->
<%= form_for @aircraft, :html => { id:'edit_aircraft'}, validate: true, remote:true do |air| %> 
```

当我像这样将 2 个表单放在同一页面上时，我能以某种方式使用内置的 Rails 优点来处理编辑吗？我是否必须将编辑表单指向**不同的操作**，或者通常的代码可以同时处理两者？

```
def create
  @aircraft = current_user.aircrafts.build(params[:aircraft])
  @aircraft.save
end 
```

欢迎您的指导。:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-12T23:03:46.663

如果你关于 DRY，那么使用本地人呢？

```
<div id="aircraftmodal-add-content">
  <%= render 'aircrafts/form', :dom_id => "new_aircraft" %>
</div>
<!-- Edit Aircraft -->
<div id="aircraftmodal-edit-content">
  <%= render 'aircrafts/form', :dom_id => "edit_aircraft" %>
</div>

<!-- Form Partial -->
<%= form_for @aircraft, :html => { id: dom_id }, validate: true, remote:true do |air| %>
   <% if dom_id == "edit_aircraft" %>
     <%= ... select aircraft id ... %>
   <% elsif dom_id == "new_aircraft" %>
     <%= ... input aircraft id ... %>
   <% end %>
etc... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-12T23:22:47.830

您可以使用`@aircraft.persisted?`来了解飞机是新注册（新/创建操作）还是已经持久化（编辑/更新操作）。

使用相同的形式，您不需要指定 id，Rails 已经分配了不同的 id 'new_aircraft' 和 'edit_aircraft_X'，其中 X 是飞机 id：

要更改 select/input_text 您可以使用：

```
<% if @aircraft.persisted? %>
  <%= select... %>
<% else %>
  <%= input... %>
<% end %> 
```

# javascript - 将自定义 HTML 属性用于 JavaScript 目的？

> ID：13850036
> 
> 赞同：2
> 
> 时间：2012-12-12T22:47:52.780
> 
> 标签：javascript, html, styling

我的一位同事不喜欢将 HTML 类和 id 用于 javascript/jQuery 目的。因此，我看到他创建了自定义 html 属性，例如

```
<div id="myid" class="cssClasses ..." [some-purpose-id]="mycustomId">...</div> 
```

我问他这是否真的是个好主意，他回答说他认为应该为样式保留类和 Id。

就个人而言，我会使用类。一些类将用于样式设置，而其他一些类将用于编程（jQuery 选择器）。这个想法也是为了让事情变得分开。当然，jQuery 可以设置样式类，但如果可能的话，不要使用它们进行选择。当然，我也会在适当的时候使用 id，但由于 id 在页面上是唯一的，所以我喜欢使用类来做通用的事情。

我想知道您对更好方法的看法（如果有的话）。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-12T22:51:40.583

我建议不要这样做，而是使用 HTML5 数据属性。[在这里](http://webdesign.tutsplus.com/tutorials/htmlcss-tutorials/all-you-need-to-know-about-the-html5-data-attribute/)阅读。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-12T23:01:32.790

不，在大多数情况下，您不应该使用虚构的属性。这些不是有效的 HTML，如果您尝试验证代码，它们将显示为错误。

但是在 HTML5 中，您可以使用以 . 开头的自定义属性`data-`。[您可以在 html5doctor 网站](http://html5doctor.com/html5-custom-data-attributes/)上阅读有关它们的更多信息。`data-`然而，属性更常被提倡用于存储*信息*，而不是标签。例如，对于您可能会说的产品`data-brand="gucci"`。或者其他的东西。

对样式*或*javascript 使用属性会产生误导，因为这不是二分法。通常，您需要添加一个 id 或类来设置您的标记样式。如果可能，您可以在不添加属性的情况下重用这些属性来选择 javascript 中的元素。它使您的代码保持干净，但这显然只是一种偏好。

如果您需要选择一个还没有可用于选择的唯一 id 或类的元素，您可以使用 data 属性。然而，使用 ids 和 classes 仍然是标准做法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-12T23:10:51.243

您应该为 javascript 和 CSS 使用类和 ID。你的同事错了。

它有助于记住您希望保持数据 (html)、表示 (css 样式) 和行为 (javascript) 之间的分离。类和 ID 的存在是有原因的，它不是用于样式（也不是用于 javascript！）。它们可以让您对**文档进行语义标记**。

在编写正确的 HTML 时，您的类和 ID 应该反映这些节点包含的数据的实际内容和用途。然后，当您需要为它们设置样式时，您可以为`.zip_code`类指定正确的样式。当您需要特殊行为时，您可以使用 javascript 将所需行为应用于`.deletable`列表项。

当然，有时在现实世界中，有些人对事物有强烈的反感，你最终不得不顺其自然。在这种情况下，您可能不得不与您的同事妥协并使用 HTML5 的 data-* 属性，正如其他人所建议的那样。然而，虽然这是一个会产生有效 HTML 的解决方案，但它不是 data-* 属性的设计目的，因此它在技术上不是正确的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-12T23:05:24.137

如果您想为多种目的在属性中提供其他数据，这可能会很有用，请查看以下示例：

```
<script>
    function getIt(){
   ob = document.getElementById('myid') 
    alert(ob.getAttributeNode('anotherTitle').value)

    }
</script>
<div id="myid" class="cssClasses" anotherTitle="new Title">The div</div>
<a href="javascript:getIt()">Test</a> 
```

我使用 anotherTitle 属性来保存或存储另一组数据——它可以用于其他用途。这是一个工作示例[http://jsfiddle.net/vxknh/](http://jsfiddle.net/vxknh/)

> 参考：http : [//www.w3schools.com/jsref/prop_attr_value.asp](http://www.w3schools.com/jsref/prop_attr_value.asp)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-12T23:45:13.973

[也许您的同事受到dojo 工具包](http://dojotoolkit.org/documentation/tutorials/1.8/themes_buttons_textboxes/)中使用的声明式风格示例的启发。

data- 是一种为特定目的“标记”属性的好方法（例如，所有 dojo 特定属性的格式为 data-dojo-whatever）。这降低了与其他脚本或 css 冲突的风险。

所以是的，这可能是一个好主意，但没有任何类和 ID 不是为样式保留的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-13T00:48:32.860

类和 ID 各有优缺点（这也很大程度上取决于您如何使用它们）。

**课程**- 它们旨在传达样式信息，但随着 jQuery 的出现，它们现在具有双重用途，有时表示动作（或数据），有时表示样式。这非常令人困惑，尤其是在大型项目中。想象一下，一个设计师试图“重构”CSS，并在连接了 javascript/jQuery 的元素上更改这些类名——坏事接踵而至。您可以使用“.donttouchthis-jqueryclass”之类的“名称空间”来减轻为非样式类名称添加前缀的情况，这将逻辑与表示区分开来是一种非常原始的方式。使用类的优点是它可以“堆叠”，因此它可以传达比 ID 更复杂的“逻辑”。

**ID** - 顾名思义，旨在唯一标识元素。从编程的角度来看，ID 提供了访问 DOM 中元素的最快方法 (getElementById)。它们也可以设置样式，但是在重构时删除 ID 的可能性较低（因为您始终可以删除 ID 样式并为其赋予一个类）。ID 是唯一的，因此广泛使用它们来存储任何复杂的数据是非常非常有限的。但是它们非常适合绑定单击处理程序或唯一标识 DOM 的块，只要您只需要它们标识的元素之一。

**类和 ID 都有一个重要规则，限制了它们作为传达任何业务逻辑的手段的有用性**——它们不能以数字开头（通常你只需要方便地将数据库 id 分配给一个元素）

**自定义属性**（不是数据）——它们可以是任何很酷的东西，但是如果您关心 HTML 的“有效性”，您将被限制为某些 DTD 类型，并且您需要在 DTD 中指定它们。实际上，它们不会损害您的 HTML，因为浏览器有义务（根据 W3C 约定）忽略未知属性。唯一的问题是与潜在的未来发展发生冲突。如果您使用的是纯 javascript，那么使用它们也会有点痛苦（但这是一个主观的选择——正如上面的答案之一所建议的那样，这是将它们用作数据存储的一个很好的补充选项）。重构 CSS 时发生混淆的可能性很小。

**自定义数据属性**- 如果您使用 jQuery，这些非常棒，因为您可以针对它存储非常复杂的数据（对象等），如果使用得当，它们真的很不错，并为您提供了一个很好的词汇表来描述您的 DOM 元素的功能。“data-”命名空间很好地保护它免受任何未来与非命名空间属性的冲突。

说了这么多，最好的解决方案不是公开依赖其中任何一个，而是实现 javascript 模式，允许您传递父 DOM 元素，然后基于标记向其应用功能（如标准 jQuery 插件模式）。通过这种方式，您可以消除对作为静态 HTML 源的一部分的特定属性/类/id 的大量依赖。

# git - Git：修改推送请求后丢失文件

> ID：13850037
> 
> 赞同：0
> 
> 时间：2012-12-12T22:47:53.913
> 
> 标签：git, github

我从 github 分叉了一个存储库，做了一些更改并将它们推送回我的 github 存储库。我做了一个拉取请求，并被告知要更改一些内容。所以我改变了一些东西，提交它们并做了一个 git push。

问题是，文件没有添加到我的存储库中，而是我的存储库的状态被撤销到我最后一次更改之前的状态。我也找不到我在历史上的变化。我有没有机会保存我的工作，还是我必须再做一次？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T01:49:42.473

你在 Github 上看到你的新提交了吗？你在当地看到他们吗？您是否推送到另一个仓库而不是您的 Github 的仓库？不同的分支？

尝试查看[http://github.com/your_user/your_repo/network](http://github.com/your_user/your_repo/network)按时间顺序查看提交。也许他们在另一个分支。

# jquery - asp.net 内容页面和 jquery 插件

> ID：13850042
> 
> 赞同：1
> 
> 时间：2012-12-12T22:48:21.207
> 
> 标签：jquery, asp.net

我在内容页面中使用 jQuery 屏蔽输入插件时遇到问题。它在正常的 Web 表单中工作正常，但无法识别内容页面中的插件。这是插件：[http ://digitalbush.com/projects/masked-input-plugin/](http://digitalbush.com/projects/masked-input-plugin/)

这是一个基本的示例内容页面：

```
<%@ Page Title="" Language="C#" MasterPageFile="~/site.Master" AutoEventWireup="true" CodeBehind="masterContent.aspx.cs" Inherits="Dating.TEST.masterContent" %>
<asp:Content ID="Content1" ContentPlaceHolderID="HeadContent" runat="server">
    <script src="../js/jquery-1.8.2.min.js" type="text/javascript"></script>
    <script src="../js/jquery.maskedinput-1.3.js" type="text/javascript"></script>
    <script type="text/javascript">

        $(document).ready(function () {
            //$('#<%= TextBox3.ClientID %>').mask("(999) 9999-9999");
            $("#TextBox3").mask("(999) 9999-9999");
        });

    </script>  

</asp:Content>
<asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="server">
           <asp:TextBox ID="TextBox3" runat="server" ClientIDMode="Static"></asp:TextBox>             
</asp:Content> 
```

当我调试这个我得到这个错误：“Uncaught TypeError: Object [object Object] has no method 'mask'”

我已经尝试了我能想到的一切，但它似乎只适用于网络表单。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T11:35:37.890

您看到的错误正在发生，因为 jquery.maskedinput-1.3.js 和/或 jquery-1.8.2.min.js 没有成功加载。

检查这些文件的位置相对于您正在加载的页面是否正确。

# hibernate - 休眠映射：合并两列

> ID：13850046
> 
> 赞同：2
> 
> 时间：2012-12-12T22:48:45.903
> 
> 标签：hibernate, hibernate-mapping

我想知道休眠中是否有一种方法可以将我的应用程序中的一个属性映射到非空列或合并我正在映射的表中的两列。

例如，MyTable 包含列 TypeA 和 TypeB。表上有一个约束，其中这两列之一必须为非空。我想将名为 MyType 的休眠属性映射到非空列。这样做的原因是我想在休眠级别管理它，而不是在我的应用程序中添加检查来决定我想使用 TypeA 还是 TypeB 作为 MyType。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T09:38:10.470

有两种方法可以做到这一点：

**1.使用自定义属性**

```
@Entity
public class MyTable {
    @Column
    private String typeA;

    @Column
    private String typeB;

    public getType() {
        return (null == typeA) ? typeB : typeA;
    }

    //typeA, typeB getter setters
} 
```

然后您可以`type`在整个应用程序中使用 (getType) 来根据空标准获取 typeA 或 typeB

**2\. 使用`@Formula`or`<formula>`** 或者您可以使用 @Formula ( [5.1.4.1.5\. Formula](http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html/mapping.html#d0e6481) ) 根据 typeA 和 typeB 的值定义一个新的派生列：

```
@Entity
public class MyTable {
    @Column
    private String typeA;

    @Column
    private String typeB;

    @Formula(case typeA when null then typeB else typeA) //Oracle only
    private String type;
} 
```

第二种方法是依赖于数据库的。所以请谨慎使用。

# python - 在 Python 中注释代码的正确方法是什么？

> ID：13850049
> 
> 赞同：5
> 
> 时间：2012-12-12T22:48:58.697
> 
> 标签：python, comments

我正在阅读 PEP8 和 Stack Overflow 上的一些问题，但我想知道评论之间的空格：

假设我有这个代码：

```
class MyBrowser(QWebPage):
    ''' Settings for the browser.'''

    def __init__(self):
        QWebPage.__init__(self)
        # Specifies whether images are automatically loaded in web pages.
        self.settings().setAttribute(QWebSettings.AutoLoadImages, True)

    def userAgentForUrl(self, url):
        ''' Returns a User Agent that will be seen by the website. '''
        return "Mozilla/5.0 (Windows NT 6.2; WOW64) AppleWebKit/537.15 (KHTML, like Gecko) Chrome/24.0.1295.0 Safari/537.15" 
```

在注释和实际代码之间放置空行的最 Pythonic 方式是什么？我想向一些专家展示我的程序。并希望我的代码看起来更专业。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-12T22:58:49.300

我不知道这是否代表“社区标准”，但这里是[Google 的 Python 风格指南](https://google.github.io/styleguide/pyguide.html?showone=Comments#Comments)（因为它们与评论有关）。具体类：

```
class SampleClass(object):
    """Summary of class here.

    Longer class information....
    Longer class information....

    Attributes:
        likes_spam: A boolean indicating if we like SPAM or not.
        eggs: An integer count of the eggs we have laid.
    """

    def __init__(self, likes_spam=False):
        """Inits SampleClass with blah."""
        self.likes_spam = likes_spam
        self.eggs = 0

    def public_method(self):
        """Performs operation blah.""" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-12T22:57:48.427

如有疑问，请查看模型的标准库。

*以下是timeit*模块的摘录（由 Guido van Rossum 本人编写）：

```
def print_exc(self, file=None):
    """Helper to print a traceback from the timed code.

    Typical use:

        t = Timer(...)       # outside the try/except
        try:
            t.timeit(...)    # or t.repeat(...)
        except:
            t.print_exc()

    The advantage over the standard traceback is that source lines
    in the compiled template will be displayed.

    The optional file argument directs where the traceback is
    sent; it defaults to sys.stderr.
    """
    import linecache, traceback
    if self.src is not None:
        linecache.cache[dummy_src_name] = (len(self.src),
                                           None,
                                           self.src.split("\n"),
                                           dummy_src_name)
    # else the source is already stored somewhere else

    traceback.print_exc(file=file) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-12T22:54:35.863

来自 Python 之禅：“可读性很重要。” 无论**您的团队**发现什么最易读，我都会这样做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-10-25T10:55:54.560

不要给出片段，而是查看使用 sphinx 的最常用的[CPython](https://en.wikipedia.org/wiki/CPython)，并将文档与代码进行比较。

*   *[difflib — 计算增量的助手](https://docs.python.org/3/library/difflib.html)*
*   *[CPython，文件 difflib.py](https://github.com/python/cpython/blob/3.7/Lib/difflib.py)*

文档永远不会不同步，因为注释就在代码中。

# php - php - 合并数组

> ID：13850051
> 
> 赞同：-1
> 
> 时间：2012-12-12T22:49:24.830
> 
> 标签：php, arrays, algorithm, merge

我有两个数组，我想在 php 中以特定方式合并它们。因此，当我尝试并失败时，我需要您的帮助来帮助我。

所以说我有两个数组：

```
$array1= array(
    "foo"        => 3,
    "bar"        => 2,
    "random1"    => 4,
);

$array2= array(
    "random2"    => 3,
    "random3"    => 4,
    "foo"        => 6,
); 
```

现在，在合并期间，我希望**添加公共键的值**。所以像**foo**存在于**array1** 和**array2**中，所以当将 array1 与 array 2 合并时，我应该得到`"foo" => "9"`

我更好的说明是看起来像这样的最终数组：

```
$array1= array(
    "foo"        => 9,
    "bar"        => 2,
    "random1"    => 4,
    "random2"    => 3,
    "random3"    => 4,
); 
```

所以我再次希望将公共键的值添加在一起，并将非公共键添加到数组或新数组中

我希望我足够清楚

谢谢， 维杜

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T22:58:11.580

像这样的东西：

```
function mergeValues() {
    $result = array();
    $arraysToMerge = func_get_args();
    foreach ($arraysToMerge as $array) {
       foreach($array as $key => $value) {
           $result[$key] += $value;
       }
    }

    return $result;
}

$res = mergeValues($array1, $array2, $array3); // Can pass any ammount of arrays to a function. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-12T22:55:04.317

```
 foreach($array1 as $k => $v)
 {
     If (isset($array2[$k]))
         $array1[$k] += $array2[$k];
 }
 foreach($array2 as $k => $v)
 {
     If (!isset($array1[$k]))
         $array1[$k] = $array2[$k];
 } 
```

# sencha-touch - Sencha 命令 - 不是一个有效的 sdk 目录，请 cd 进入一个有效的目录

> ID：13850054
> 
> 赞同：1
> 
> 时间：2012-12-12T22:49:27.890
> 
> 标签：sencha-touch, sencha-command

我在使用 sencha 命令时遇到问题。我已经 cd'd 进入包含 SDK 的路径，然后指向我的应用程序的路径，但出现上述错误。这是一个测试错误还是我错过了什么？不知道还有什么可以尝试的......

我的命令提示符：

```
C:\Program Files (x86)\SenchaSDKTools-2.0.0-beta3>sencha app create MyApp C:\Development\MyNewApp 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T23:24:44.403

您需要转到 SDK 文件夹而不是 SDK Tools 文件夹才能执行 sencha 命令

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-12T23:25:44.963

如果您使用的是最新版本的 Sencha Touch，那么您不应该使用[Sencha SDK Tools](http://www.sencha.com/forum/showthread.php?196001-quot-Not-a-recognized-Sencha-SDK-or-application-folder-quot-on-OSX-w-2.0.0-Beta-2-2.0.1-rc&p=908627&viewfull=1#post908627)。相反，下载并使用[Sencha Cmd](http://www.sencha.com/products/sencha-cmd/download)（这是一个同名的不同程序；是的，令人困惑）。

否则，[这里有一个](http://www.sencha.com/forum/showthread.php?196001-quot-Not-a-recognized-Sencha-SDK-or-application-folder-quot-on-OSX-w-2.0.0-Beta-2-2.0.1-rc)讨论这个问题的线程。有许多解决方案，其中之一是下载 Sencha Touch 并`.senchasdk`在其中创建一个文件。

# asp.net-mvc - 信号组添加

> ID：13850055
> 
> 赞同：-2
> 
> 时间：2012-12-12T22:49:28.913
> 
> 标签：asp.net-mvc, signalr

我可以添加例如用户名而不是*connection.id 吗*？它有效吗？我问这个是因为通过 ConnectionId 我无法向用户发送通知，因为 ConnectionId 总是在变化？

Groups.Add("my_username", "mygroup1);

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T23:47:09.360

不，您不能，您必须使用 ConnectionID。但是，您可以执行以下操作。

在您的集线器上存储映射到连接 ID 的用户列表：

```
static ConcurrentDictionary<string, User> _users = new ConcurrentDictionary<string, User>(); 
```

然后在启动客户端连接后，您可以调用如下方法：

```
myHub.server.createUser("MyUsername"); 
```

当然，在您拥有的服务器上：

```
public void createUser(string userName) 
{
    // You'd create a User class that had both of the following properties
    var user = new User
    {
        UserName = userName,
        ConnectionID = Context.ConnectionId
    };
    _users.TryAdd(user.ConnectionID, user);        
} 
```

因此，每当您想通过连接 ID 查找用户时，您仍然可以通过 _users 字典获得他/她的用户名的上下文。

注意：此代码通过 signalr 1.0 alpha + 工作

# css - 如何在 Google Closure Library 富文本编辑器中设置默认字体

> ID：13850067
> 
> 赞同：1
> 
> 时间：2012-12-12T22:50:21.023
> 
> 标签：css, iframe, google-closure, google-closure-library

Google Closure 库编辑器：[演示](http://closure-library.googlecode.com/svn/trunk/closure/goog/demos/editor/editor.html)、[文档](http://closure-library.googlecode.com/svn/docs/namespace_goog_editor.html)。

可编辑区域是 iframe。如何设置可编辑区域的默认字体？现在它是浏览器的默认字体。我不想在可编辑区域的内容周围放置字体标签**。这样，我以后可以更改我网站的字体，而无需修改编辑器中编写的每个 HTML 内容。

** 我的意思是这样的：

```
<font size="2" face="georgia, serif"><b>content</b></font> 
```

我宁愿这样：

```
<b>content</b> 
```

...然后使用 CSS 使用 georgia 字体为编辑器的可编辑区域设置样式。这样，我数据库中的 HTML 内容（由编辑器生成）将不包含硬编码字体，因此我可以在将来更改字体。

编辑：也许我应该使用 a`SeamlessField`而不是 a`Field`作为可编辑区域？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T18:06:26.363

一旦你调用`makeEditable()`了`goog.editor.Field`创建你引用的 iFrame 的 ，Field 就会触发一个类型为 的事件`goog.editor.Field.EventType.LOAD`。如果您收听该事件，您可以拉出 iFrame 并将链接元素放入 CSS 样式表，以便您可以轻松地修改编辑器中的内容。

这相当于我的一位听众，应该让你走上正轨。（我没有检查是否`goog.editor.Field`是事件的目标，但我认为它是）。

```
some.namespace.Page.prototype.onEditorLoad_ = function(event) {
  var editor = /** @type {goog.editor.Field} */ (event.target);
  var iFrame = editor.getEditableIframe();
  if (iFrame) {
    var fieldDomHelper = editor.getEditableDomHelper();
    var documentNode =
      fieldDomHelper.getFrameContentDocument(iFrame).documentElement;

    var head = documentNode.getElementsByTagName(goog.dom.TagName.HEAD)[0];
    if (!head) {
      head = fieldDomHelper.createDom(goog.dom.TagName.HEAD);
      goog.dom.insertChildAt(documentNode, head, 0);
    }

    fieldDomHelper.appendChild(
      head,
      fieldDomHelper.createDom(
        goog.dom.TagName.LINK,
        { 'href': '/css/myCSS.css', 'rel': 'stylesheet', 'type': 'text/css' }
      )
    );
  }
} 
```

最后，在那个 CSS 文件中，你可以添加任何你想要的样式。比如你的字体改变。

# jquery - jQuery UI 中的选定选项卡被 v1.9 破坏

> ID：13850069
> 
> 赞同：0
> 
> 时间：2012-12-12T22:50:26.740
> 
> 标签：jquery, jquery-ui

我从 jQuery 1.7 / UI 1.8.11 升级到 jQuery 1.8.2 / UI 1.9.1，我获取所选选项卡索引的代码不再有效：

```
$('#tabContainer').tabs('option', 'selected') 
```

如果第一个选项卡被选中，这曾经返回`0`，但现在它只是返回`tabContainer`元素（一个 div）。我在 UI 1.9 发行说明中阅读了`selected`已弃用的内容，但`active`（替换）给出了相同的结果。

是否有其他方法可以从 tabs() 函数外部获取选定的选项卡索引？

谢谢！

# r - 条形图 - 频率应基于列中的模式和比率（x 轴）

> ID：13850071
> 
> 赞同：0
> 
> 时间：2012-12-12T22:50:54.403
> 
> 标签：r

让我快速解释一下这个问题。像这样画一个数据集

```
data<- data.frame("Amino.acid" = c("TRPPS;PNSTED", "ERDDS", "PSRND", "SDEEN", "GSRTN"), 
                   "log2.ratio"=c(2.4,0,-1,-2,-1)) 
```

实际上，我的列表要长得多，比如说 12000 行。我真正想做的是获得特定氨基酸模式的频率，然后绘制密度与 log2ratio 的关系。因此，例如应该在氨基酸列中检测到模式 RXXS，有时序列用“;”分隔。并且应该对两者进行模式分析。

对于很多 log2 比率，我可以考虑一些丑陋的东西，比如 gsub 和子集函数，但应该有一个优雅的解决方案。（也许与密度函数？？）

最后，我想为特定模式和除此特定氨基酸序列模式之外的所有其他模式的密度 (y) 与 log2raito (x) 绘制图表。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T23:53:16.203

我讨厌将数据框命名为“数据”，因此将其命名为“pdat”：

```
 barplot( table(pdat[ grep("R[A-Z]{2}S", pdat$Amino.acid), "log2.ratio"] )) 
```

这与我能用那个小数据集得到的一样具体。grepping 模式不会向“AARP;SNORE”注册：

```
> grep("R[A-Z]{2}S","AARP;SNORE")
integer(0) 
```

这是互补行的图（就像减号一样）：

```
barplot( table(pdat[ -grep("R[A-Z]{2}S", pdat$Amino.acid), "log2.ratio"] )) 
```

这不是一个密度，所以达到 hte 密度函数将注定你的努力。

# php - 使用什么正则表达式来查找备份文件？

> ID：13850073
> 
> 赞同：0
> 
> 时间：2012-12-12T22:51:08.070
> 
> 标签：php, regex, preg-match

这是我将在 preg_match 中查找的示例备份文件。我试图找到最好的正则表达式来只抓取这些类型的文件。它需要检查“备份”，然后是日期（任何日期），然后是时间（任何时间）用户名并以 .tar.gz 结尾

> 备份-12.9.2012_00-00-06_username.tar.gz

截至目前，我有以下工作，但我正在寻找更具体的，所以我不会错误地拉别的东西。

```
preg_match('/backup-[0-9].*_username/', $file) 
```

当然，完成后“用户名”将是一个 php 变量

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T00:07:38.113

前段时间我遇到了类似的问题，这是我为完成这项工作而编写的函数（针对您使用的格式稍作修改）：

```
function is_backup($filename, $hour24 = TRUE)
{
    // If the filename is not a compressed tarball then it is not a backup
    if (strcasecmp('.tar.gz', substr($filename, -7)) !== 0)
        return FALSE;

    // The various formats
    $day    = '(?:[1-9]|[12]\d|3[01])';
    $month  = '(?:[1-9]|1[012])';
    $year   = '2\d{3}';
    $hour   = ($hour24 ? '(?:0?\d|1\d|2[0-4])' : '(?:0?\d|1[0-2])(?:am|pm)?');
    $minute = $second = '(?:0?\d|[1-5]\d|60)';
    $user   = '[^\.]+';

    // Construct the regular expression
    $regex = "/^backup-{$month}\.{$day}\.{$year}_{$hour}-{$minute}-{$second}_{$user}\.tar\.gz$/i";

    // preg_match returns "1" if it matches
    return preg_match($regex, $filename) === 1;
} 
```

如果您的文件名总是使用前导零（在适用的情况下），那么您也可以只使用它`fnmatch()`来进行近似匹配。它使用 shell 模式而不是正则表达式。

```
$pattern = 'backup-??.??.????_??-??-??_*.tar.gz';
$filename = 'backup-12.09.2012_00-00-06_username.tar.gz';
var_dump(fnmatch($pattern, $filename)); 
```

如果您已经在文件系统周围翻找，那么该`glob()`功能可能会更方便。它基本上和 . 一样`fnmatch()`，但是它不是一个接一个地给它提供文件名，而是使用你当前所在的目录。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-12T22:55:42.950

我会选择简单的[glob](http://php.net/glob) s - 这里不需要一个成熟的正则表达式。

你需要的是这两个（感谢一位数的月份，它本身就是一个 WTF，应该固定为始终使用两位数的值）：

*   `backup-??.?.????_??-??-??_username.tar.gz`
*   `backup-??.??.????_??-??-??_username.tar.gz`

可能您还需要为个位数的天数添加两个案例。或者，如前所述，始终使用正确的 dd.mm.yyyy 日期。

无论如何，如果您真的想使用正则表达式：

```
^backup-\d{1,2}.\d{1,2}.\d{4}_\d{2}-\d{2}-\d{2}_username\.tar\.gz$ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-12T22:55:57.180

`[0-9]`是一位数。

`.*`是任何字符序列。

所以`/backup-[0-9].*_username/`也会匹配，例如，`backup-1ABCD EFGH_username`

你可能的意思是

```
backup-[0-9]{1,2}\.[0-9]{1,2}\.[0-9]{4}_[0-9]{2}-[0-9]{2}-[0-9]{2}_username 
```

或者，更宽松一点，

```
backup-[0-9.-_]+username 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-12T22:55:59.773

如果所有文件中的位数相同，则以下表达式有效。

```
preg_match('/backup-[0-9]{2}\.[0-9]\.[0-9]{4}_[0-9]{2}-[0-9]{2}-[0-9]{2}_username\.tar\.gz/') 
```

或者`\d`用来表示一个数字：

```
preg_match('/backup-\d\d\.\d\.\d\d\d\d_\d\d-\d\d-\d\d_username\.tar\.gz/') 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-12T22:58:01.373

如果 'backup' 和 '_username' 之间的所有内容都与日期/时间相关，建议保持简单，并且在更改日期格式时不需要更改正则表达式。只需允许数字和标点符号：

```
/backup-[0-9.:-_]+_[a-zA-Z_-]+\.tar\.gz/ 
```

该`[0-9.:-_]+`位将抓取任何数字日期部分。然后`[a-zA-Z_-]+`将获取用户名。

# c++ - 在 Ragel 中暂停和恢复解析

> ID：13850080
> 
> 赞同：0
> 
> 时间：2012-12-12T22:51:52.860
> 
> 标签：c++, ragel

我正在使用 Ragel 解析 C++ 中的字符串。我需要能够无限期地暂停解析，然后从中断的地方继续解析。

现在我正试图通过`fbreak`在完成动作的末尾放置一个来做到这一点。这似乎工作正常，将控制权交还给父程序。但是，我不确定如何恢复解析。我以为只调用 生成的代码`%write exec`就足够了，但似乎并非如此。当它重新解析时，对原始字符串的引用似乎是错误的/丢失了。

不确定我是否在 C++ 中做错了（这不是我的母语），或者我对 Ragel 采取了错误的方法。

这是我的开始和恢复代码：

```
const char *p;
const char *pe;

void start()
{
    int len = theString.length();
    char chars[len+1];
    theString.toCharArray(chars, len+1);
    p = chars;
    pe = chars + len;
    resume();
}

void resume() {
    %% write exec;
} 
```

我第一次调用时`start()`，我的状态机最终`fbreak`退出，然后我调用`resume()`（希望）继续解析。

关于我可能做错了什么的任何指示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T00:51:30.827

看起来这是某种悬空指针问题。移动其他地方的初始化`theString`似乎已经解决了这个问题。所以基本上，我仍然不擅长 C。

# signalr.client - 如何捕获 SignalR 本机客户端失去与服务器的连接

> ID：13850081
> 
> 赞同：2
> 
> 时间：2012-12-12T22:51:58.980
> 
> 标签：signalr.client

我正在开发一个使用 SignalR 的 .net 客户端应用程序。如果由于某种原因连接断开，我想通知用户。如何使用本机客户端捕获断开连接事件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T23:51:03.463

当连接终止时，客户端将进入重新连接。

因此，您可以绑定到 Reconnecting 事件以查看连接何时断开：

```
var connection = new Connection("http://myEndPointURL");

connection.Reconnecting += () =>
{
    Console.WriteLine("The connection has gone down, shifting into reconnecting state");
}; 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T19:18:33.263

我能够捕获 StateChanged 以检测连接中的更改并通知用户。

```
 connection.StateChanged += (statechange) =>
            {
                Console.WriteLine("Changing from " + statechange.OldState + " to " + statechange.NewState);
            }; 
```

这为我提供了一种机制，可以在连接断开或成功重新连接时通知用户。

# c++ - gcc 编译（有时）导致 cpu 欠载

> ID：13850082
> 
> 赞同：2
> 
> 时间：2012-12-12T22:52:02.333
> 
> 标签：c++, linux, gcc, cpu-usage

我有一个更大的 C++ 程序，它首先将数千个小文本文件读入内存并将数据存储在 stl 容器中。这大约需要一分钟。定期地，编译会表现出程序的初始部分将以大约 22-23% 的 CPU 负载运行的行为。一旦该步骤结束，它会回到 ~100% CPU。O2 标志打开但不一致时更有可能发生这种情况。使用 -p 标志的情况更少发生，这使得几乎不可能进行分析。我确实捕获了一次，但 gprof 输出没有帮助 - 一切都以相同的相对速度运行，只是在 cpu 使用率低的情况下。

我很确定这与多核无关。我确实有一个四核 cpu，并且大部分代码都是多线程的，但我在运行单线程时测试了这个问题。此外，当我在多个线程中运行有问题的步骤时，每个线程仅以约 20% 的 CPU 运行。

对于这个问题的含糊之处，我提前道歉，但我已经没有关于如何进一步解决它的想法，所以任何提示都可能会有所帮助。

更新：为了确保清楚，代码的有问题的部分有时（大约 30-40% 的编译）运行在 100% 的 CPU 上，所以很难相信 I/O 是瓶颈

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-12T23:01:33.617

### 这是*缓冲区缓存*

* * *

我的猜测是，您看到的是[**Linux** ***缓冲区高速缓存***](http://www.linuxtutorial.info/modules.php?name=MContent&pageid=286)运行的结果。

这数千个文件将需要很长时间才能从磁盘读取，并且 CPU 将主要等待旋转和寻道延迟。报告的 CPU 时间使用率将较低，以百分比表示。（但总体上可能更大。）

但是一旦读取，这些小文件就会完全缓存在内存中，并且访问每个文件（在后续运行中）成为纯粹的 CPU 绑定活动。

块是否保留在缓存中取决于干预活动，例如重新编译。当新程序运行并读取其他文件时，程序和文件将被缓存，旧块将被丢弃，显然，内存密集型工作负载也会清除缓冲区缓存。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-12T22:58:43.927

由于您正在读取大量小文件，因此您的程序大部分时间都在等待磁盘 I/O 时被阻塞。由于 CPU 在等待磁盘向其发送数据时并不忙，因此您会看到负载明显低于 100%。一旦结束，现在你的 CPU 受限，你的程序将占用所有可用的 CPU 时间。

它有时工作得更快的事实是因为（正如 Jarryd 和 DigitalRoss 所提到的）一旦你将它们读入系统内存，它们就在操作系统的缓存中，所以后续的加载速度会快一个数量级，除非它们已经被其他磁盘 I/O 驱逐。因此，如果您背靠背运行程序，第二次运行可能会快得多。如果您等待一段时间（同时做其他事情），可能已经有足够的其他磁盘 I/O 将这些文件从缓存中逐出，在这种情况下，再次读取它们需要很长时间。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-13T06:24:13.073

除了提到缓冲区缓存的其他答案之外，如果您想了解编译过程中发生了什么，您可以将以下一些[标志](http://gcc.gnu.org/onlinedocs/gcc/Invoking-GCC.html)传递给 GCC（即到`g++`，可能作为`CXXFLAGS`您的设置`Makefile`）：

*   `-v`要求`g++`显示涉及的子进程（例如`cc1plus`，对于正确的 C++ 编译器）
*   `-time`要求`g++`报告每个子流程的时间
*   `-ftime-report`要求`g++`（实际上`cc1plus`）报告编译器内部阶段或传递的时间。

# perl - 如果符号链接错误，如何检查 Perl？

> ID：13850085
> 
> 赞同：1
> 
> 时间：2012-12-12T22:52:27.807
> 
> 标签：perl

输出以下位错误：

```
# Only Execute on Prod Stagesif ($stage eq 'Prod') {
if ($stage eq "Prod") {
    # If /mysql symlink exists, exit0 immediately    
    if ( -l "/mysql" ) {
        exit(0);
        }
    elsif {
        die "Did not meet expected system disk configuration";
    }
}
exit (0); 
```

和：

```
syntax error at ./010MySQLDataDirectoryCheck.pl line 16, near "elsif {"
syntax error at ./010MySQLDataDirectoryCheck.pl line 19, near "}"
Execution of ./010MySQLDataDirectoryCheck.pl aborted due to compilation errors. 
```

我到底错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-12T22:54:13.370

...一个`elsif`==>`else`有机会吗？

# objective-c - Ooyala 播放器 (iOS)：如何全屏启动？

> ID：13850087
> 
> 赞同：3
> 
> 时间：2012-12-12T22:52:36.640
> 
> 标签：objective-c, ios, ooyala

我在我的项目中使用 Ooyala 播放器，该项目曾经使用 MPMoviePlayer，我们只是更改视图的大小以使其全屏或不全屏，但 Ooyala 播放器似乎通过使用另一个模态视图控制器来保持自己的全屏/内联模式切换到全屏，这给当前视图控制器带来了很多问题，`viewWillDisappear`并且`viewDidDisappear`会在模态 VC 出现时被调用，那么有没有办法直接从全屏开始？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T23:44:06.563

尝试具有 controlType 参数的 OOOoyalaPlayerViewController 的构造函数之一。

# git - git mergetool --follow?

> ID：13850089
> 
> 赞同：4
> 
> 时间：2012-12-12T22:52:50.043
> 
> 标签：git, merge, git-merge, git-log

有没有`git-mergetool`表现得像`--follow`from的标志`git-log`？

```
 --follow
       Continue listing the history of a file beyond renames (works only
       for a single file). 
```

基本上我希望它合并重命名的文件，而不是认为它们被删除。

`git-mergetool`提供以下内容：

```
 When git mergetool is invoked with this tool (either through the -t
       or --tool option or the merge.tool configuration variable) the
       configured command line will be invoked with $BASE set to the name
       of a temporary file containing the common base for the merge, if
       available; $LOCAL set to the name of a temporary file containing
       the contents of the file on the current branch; $REMOTE set to the
       name of a temporary file containing the contents of the file to be
       merged, and $MERGED set to the name of the file to which the merge
       tool should write the result of the merge resolution. 
```

因此，对于重命名/移动的文件，我想要的是 BASE/LOCAL/REMOTE 仍然可以工作。我想`git-mergetool`“关注”将 BASE 重命名为 LOCAL 或 REMOTE，视情况而定。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T23:06:33.240

`git mergetool`本身不执行合并，仅有助于清理由于已经在进行中的合并而引起的冲突。因此，将该选项应用于 mergetool 命令是没有意义的。

为`git merge`. 合并将始终考虑文件移动。仅当命令覆盖不同的行为`--follow`时才需要该选项。`git log`正如您引用的位表明该选项仅在获取单个文件的日志时适用，在这种情况下，您表示您只对该特定文件感兴趣。该`--follow`选项可用于指示您还需要有关该文件以前名称的信息。

# eclipse - ExceptionInInitializerError 与 PowerMock 和 Robolectric

> ID：13850094
> 
> 赞同：5
> 
> 时间：2012-12-12T22:53:22.567
> 
> 标签：eclipse, junit, powermock, robolectric

我想将 Robolectric 与 PowerMock 一起使用，但在让它们运行时遇到了一些麻烦。我认为这是一个依赖问题——现在我的 jar 只是在 Eclipse 中管理。

我以两种方式收到 ExceptionInInitializerError。第一个是这样的：

```
@RunWith(RobolectricTestRunner.class)
@PrepareForTest(Logger.class)
public class Logger_Test {
    @Mock Config config;

    @Before
    public void setUp() {
        MockitoAnnotations.initMocks(this);
    } 
```

失败：

```
java.lang.ExceptionInInitializerError
at org.mockito.internal.exceptions.stacktrace.ConditionalStackTraceFilter.<init>(ConditionalStackTraceFilter.java:17)
at org.mockito.exceptions.base.MockitoException.filterStackTrace(MockitoException.java:30)
at org.mockito.exceptions.base.MockitoException.<init>(MockitoException.java:19)
at org.mockito.exceptions.misusing.MockitoConfigurationException.<init>(MockitoConfigurationException.java:18)
at org.mockito.internal.configuration.ClassPathLoader.loadImplementations(ClassPathLoader.java:145)
at org.mockito.internal.configuration.ClassPathLoader.findPluginImplementation(ClassPathLoader.java:110)
at org.mockito.internal.configuration.ClassPathLoader.findPlatformMockMaker(ClassPathLoader.java:106)
at org.mockito.internal.configuration.ClassPathLoader.<clinit>(ClassPathLoader.java:59)
at org.mockito.internal.util.MockUtil.<clinit>(MockUtil.java:21)
at org.mockito.internal.MockitoCore.<init>(MockitoCore.java:40)
at org.mockito.internal.stubbing.defaultanswers.ReturnsMocks.<init>(ReturnsMocks.java:18)
at org.mockito.Answers.<clinit>(Answers.java:52)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at java.lang.Class.getEnumConstantsShared(Class.java:2942)
at java.lang.Class.enumConstantDirectory(Class.java:2963)
at java.lang.Enum.valueOf(Enum.java:191)
at sun.reflect.annotation.AnnotationParser.parseEnumValue(AnnotationParser.java:413)
at sun.reflect.annotation.AnnotationParser.parseMemberValue(AnnotationParser.java:278)
at java.lang.reflect.Method.getDefaultValue(Method.java:720)
at sun.reflect.annotation.AnnotationType.<init>(AnnotationType.java:99)
at sun.reflect.annotation.AnnotationType.getInstance(AnnotationType.java:66)
at sun.reflect.annotation.AnnotationParser.parseAnnotation(AnnotationParser.java:202)
at sun.reflect.annotation.AnnotationParser.parseAnnotations2(AnnotationParser.java:69)
at sun.reflect.annotation.AnnotationParser.parseAnnotations(AnnotationParser.java:52)
at java.lang.reflect.Field.declaredAnnotations(Field.java:1014)
at java.lang.reflect.Field.getDeclaredAnnotations(Field.java:1007)
at java.lang.reflect.AccessibleObject.getAnnotations(AccessibleObject.java:175)
at org.junit.runners.model.FrameworkField.getAnnotations(FrameworkField.java:21)
at org.junit.runners.model.TestClass.addToAnnotationLists(TestClass.java:50)
at org.junit.runners.model.TestClass.<init>(TestClass.java:43)
at org.junit.runners.ParentRunner.<init>(ParentRunner.java:65)
at org.junit.runners.BlockJUnit4ClassRunner.<init>(BlockJUnit4ClassRunner.java:58)
at com.xtremelabs.robolectric.RobolectricTestRunner.<init>(RobolectricTestRunner.java:213)
at com.xtremelabs.robolectric.RobolectricTestRunner.<init>(RobolectricTestRunner.java:110)
at com.xtremelabs.robolectric.RobolectricTestRunner.<init>(RobolectricTestRunner.java:97)
at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
at org.junit.internal.builders.AnnotatedBuilder.buildRunner(AnnotatedBuilder.java:31)
at org.junit.internal.builders.AnnotatedBuilder.runnerForClass(AnnotatedBuilder.java:24)
at org.junit.runners.model.RunnerBuilder.safeRunnerForClass(RunnerBuilder.java:57)
at org.junit.internal.builders.AllDefaultPossibilitiesBuilder.runnerForClass(AllDefaultPossibilitiesBuilder.java:29)
at org.junit.runners.model.RunnerBuilder.safeRunnerForClass(RunnerBuilder.java:57)
at org.junit.internal.requests.ClassRequest.getRunner(ClassRequest.java:24)
at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.<init>(JUnit4TestReference.java:33)
at org.eclipse.jdt.internal.junit4.runner.JUnit4TestClassReference.<init>(JUnit4TestClassReference.java:25)
at org.eclipse.jdt.internal.junit4.runner.JUnit4TestLoader.createTest(JUnit4TestLoader.java:48)
at org.eclipse.jdt.internal.junit4.runner.JUnit4TestLoader.loadTests(JUnit4TestLoader.java:38)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:452)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)
Caused by: java.lang.NullPointerException
at org.mockito.internal.exceptions.stacktrace.StackTraceFilter.<clinit>(StackTraceFilter.java:21)
... 56 more 
```

它与 PowerMockRunner 一起工作得很好，但会抛出与规则相同的异常。

```
@PrepareForTest(Logger.class)
    public class Logger_Test {
    @Rule public PowerMockRule rule = new PowerMockRule();
    @Mock Config config;

    @Before
    public void setUp() {
        MockitoAnnotations.initMocks(this);
    } 
```

失败：

```
java.lang.ExceptionInInitializerError
at org.mockito.internal.exceptions.stacktrace.ConditionalStackTraceFilter.<init>(ConditionalStackTraceFilter.java:17)
at org.mockito.exceptions.base.MockitoException.filterStackTrace(MockitoException.java:30)
at org.mockito.exceptions.base.MockitoException.<init>(MockitoException.java:19)
at org.mockito.exceptions.misusing.MockitoConfigurationException.<init>(MockitoConfigurationException.java:18)
at org.mockito.internal.configuration.ClassPathLoader.loadImplementations(ClassPathLoader.java:145)
at org.mockito.internal.configuration.ClassPathLoader.findPluginImplementation(ClassPathLoader.java:110)
at org.mockito.internal.configuration.ClassPathLoader.findPlatformMockMaker(ClassPathLoader.java:106)
at org.mockito.internal.configuration.ClassPathLoader.<clinit>(ClassPathLoader.java:59)
at org.mockito.internal.util.MockUtil.<clinit>(MockUtil.java:21)
at org.mockito.internal.MockitoCore.<init>(MockitoCore.java:40)
at org.mockito.internal.stubbing.defaultanswers.ReturnsMocks.<init>(ReturnsMocks.java:18)
at org.mockito.Answers.<clinit>(Answers.java:52)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at java.lang.Class.getEnumConstantsShared(Class.java:2942)
at java.lang.Class.enumConstantDirectory(Class.java:2963)
at java.lang.Enum.valueOf(Enum.java:191)
at sun.reflect.annotation.AnnotationParser.parseEnumValue(AnnotationParser.java:413)
at sun.reflect.annotation.AnnotationParser.parseMemberValue(AnnotationParser.java:278)
at java.lang.reflect.Method.getDefaultValue(Method.java:720)
at sun.reflect.annotation.AnnotationType.<init>(AnnotationType.java:99)
at sun.reflect.annotation.AnnotationType.getInstance(AnnotationType.java:66)
at sun.reflect.annotation.AnnotationParser.parseAnnotation(AnnotationParser.java:202)
at sun.reflect.annotation.AnnotationParser.parseAnnotations2(AnnotationParser.java:69)
at sun.reflect.annotation.AnnotationParser.parseAnnotations(AnnotationParser.java:52)
at java.lang.reflect.Field.declaredAnnotations(Field.java:1014)
at java.lang.reflect.Field.getAnnotation(Field.java:1000)
at org.powermock.classloading.DeepCloner.cloneFields(DeepCloner.java:222)
at org.powermock.classloading.DeepCloner.performClone(DeepCloner.java:128)
at org.powermock.classloading.DeepCloner.cloneFields(DeepCloner.java:248)
at org.powermock.classloading.DeepCloner.performClone(DeepCloner.java:128)
at org.powermock.classloading.DeepCloner.cloneFields(DeepCloner.java:248)
at org.powermock.classloading.DeepCloner.performClone(DeepCloner.java:128)
at org.powermock.classloading.DeepCloner.cloneFields(DeepCloner.java:248)
at org.powermock.classloading.DeepCloner.performClone(DeepCloner.java:128)
at org.powermock.classloading.DeepCloner.cloneFields(DeepCloner.java:248)
at org.powermock.classloading.DeepCloner.performClone(DeepCloner.java:128)
at org.powermock.classloading.DeepCloner.clone(DeepCloner.java:82)
at org.powermock.classloading.DeepCloner.clone(DeepCloner.java:69)
at org.powermock.classloading.ClassloaderExecutor.execute(ClassloaderExecutor.java:89)
at org.powermock.classloading.ClassloaderExecutor.execute(ClassloaderExecutor.java:78)
at org.powermock.modules.junit4.rule.PowerMockStatement.evaluate(PowerMockRule.java:49)
at org.junit.runners.BlockJUnit4ClassRunner.runNotIgnored(BlockJUnit4ClassRunner.java:79)
at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:71)
at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:49)
at org.junit.runners.ParentRunner$3.run(ParentRunner.java:193)
at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:52)
at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:191)
at org.junit.runners.ParentRunner.access$000(ParentRunner.java:42)
at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:184)
at org.junit.runners.ParentRunner.run(ParentRunner.java:236)
at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)
at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)
Caused by: java.lang.NullPointerException
at org.mockito.internal.exceptions.stacktrace.StackTraceFilter.<clinit>(StackTraceFilter.java:21)
... 59 more 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2018-07-16T02:35:46.063

添加`@PowerMockIgnore({ "org.mockito.*", "org.robolectric.*", "android.*" })`为文档：[https ://github.com/robolectric/robolectric/wiki/Using-PowerMock](https://github.com/robolectric/robolectric/wiki/Using-PowerMock)

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2014-02-19T08:44:09.300

代替`@RunWith(RobolectricTestRunner.class)`使用`@RunWith(PowerMockRunner.class)`

# java - 删除链接的 MySQL 表中的行并减少另一个表中的计数

> ID：13850095
> 
> 赞同：1
> 
> 时间：2012-12-12T22:53:46.363
> 
> 标签：java, mysql, prepared-statement, sql-delete

我正在尝试创建（基于 java 的）消息传递 webapp。消息使用 MySQL 使用三个表存储：

*   **'messages'**：有两列，一个 id 主键（'idmessage'）和消息（'message'）。
*   **'tags'**：用户还输入与他们的消息相关联的标签。这有两列 - 标签（也是主键）和计数（'count'）。
*   **'message_tag_link'**：由于消息和标签之间存在多对一的关系，因此我有第三个链接表。这有两列，消息的外键（'fk_idmessage'）和标签表的 ID（'fk_tag'）。

将消息插入数据库工作正常。我在 Java 中使用以下几行：

```
pst1 = connection.prepareStatement("INSERT INTO messages(message) VALUES (?)");
pst2 = connection.prepareStatement("INSERT INTO tags(tag,count) VALUES (?,1) ON     DUPLICATE KEY UPDATE count = count + 1");
pst3 = connection.prepareStatement("INSERT INTO message_tag_link(fk_idmessage,fk_tag) VALUES (? , ?)"); 
```

可以看出，每次创建重复的标签条目时，pst2 中的“计数”都会增加。我正在尝试弄清楚如何完全删除一条消息。我`on delete cascade`在链接表的列中对我的外键进行了描述，但不确定下一步该做什么。对于给定*的“messageid”，*我需要：

1.  删除“消息”表中的一行
2.  删除“message_tag_link”表中的关联行
3.  当消息删除成功时减少'tags'表中的计数值，或者如果计数变为零则完全删除该行。

是否可以使用 Java 在 MySQL 中完成所有这些操作`PreparedStatement`？任何指针都非常感谢。我是一个完全的 MySQL 新手，所以请善待！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T03:39:01.767

这些查询应该满足您的需求。? 在每个查询中应该是要删除的消息 ID

```
//Update count
UPDATE tags SET `count` = `count` - 1 WHERE tag_id IN (SELECT fk_tag FROM message_tag_link WHERE fk_idMessage = ?);
//Remove link
DELETE FROM message_tag_link WHERE fk_idmessage = ?;
DELETE FROM messages WHERE id = ?;
//Remove unused tags
DELETE FROM tags WHERE `count` = 0; 
```

正如您所发现的那样，保持计数可能很烦人。更好的是使用链接本身。

```
SELECT COUNT(fk_idmessage) AS msgcount FROM message_tag_link WHERE fk_tag = ?; 
```

您还可以添加一个 CASCADE，以便在删除消息时标签链接也会被删除（请参见[此处](http://dev.mysql.com/doc/refman/5.5/en/innodb-foreign-key-constraints.html)）。但是要小心这种行为）。

此解决方案仍然会留下没有消息的标签，但您可以使用以下查询删除这些标签：

```
DELETE FROM tags t WHERE NOT EXISTS (SELECT 1 FROM nessage_tag_link WHERE t.tag_id = fk_tag) 
```

# wpf - 防止点击通过 XAML/WPF 中的按钮

> ID：13850099
> 
> 赞同：5
> 
> 时间：2012-12-12T22:54:08.030
> 
> 标签：wpf, windows, events, xaml, event-bubbling

在我的项目中，我有一个带有水龙头处理程序的大容器。在这个容器内，我还有一个按钮。我的目标是处理后台容器上的所有点击，除非用户点击按钮。不幸的是，当我单击按钮时，它会触发按钮上的单击处理程序和容器的点击处理程序。

这是一些示例 XAML：

```
<Grid Width="250" Height="250" Fill="Red" Tapped="Container_Tapped">
    <Button Click="Button_Clicked">
        <Rectangle Width="20" Height="20" Fill="Blue" />
    </Button>
</Grid> 
```

有没有办法处理按钮上的点击事件以防止它冒泡到容器中？还有其他想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-12T23:31:08.457

在您的`Container_Tapped`事件处理程序中，您可以检查[RoutedEventArgs.OriginalSource 属性](http://msdn.microsoft.com/en-us/library/system.windows.routedeventargs.originalsource.aspx)。如果`e.OriginalSource`是按钮的后代，则什么也不做。

对于那个[Visual.IsDescendantOf 方法](http://msdn.microsoft.com/en-us/library/system.windows.media.visual.isdescendantof.aspx)可能会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-30T23:18:41.987

这是在 Win RT 中执行此操作的一种动态方法，无需知道按钮的确切名称（如果您有一堆按钮要使用，例如数据绑定时，这很有用！）

```
 ' Verify that the sender is not a button (or one of its children)
    If Not e.OriginalSource.Equals(sender) Then
        Dim parentObj = VisualTreeHelper.GetParent(e.OriginalSource)
        Do While Not parentObj.Equals(sender)
            If TypeOf parentObj Is Button Then Return
            parentObj = VisualTreeHelper.GetParent(parentObj)
        Loop
    End If 
```

# html - 居中对齐表格

> ID：13850100
> 
> 赞同：0
> 
> 时间：2012-12-12T22:54:10.500
> 
> 标签：html, css

如何使用 css 在页面中间居中对齐表格。这就是我所拥有的[http://jsfiddle.net/m5uEr/](http://jsfiddle.net/m5uEr/)

```
<div style="text-align: center; border-style:solid;">
    <table style="border-style:solid;">
        <tr>
            <td>test</td>
        </tr>
    </table>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-12T22:56:47.743

```
table.center {
    margin-left:auto; 
    margin-right:auto;
  }

<table style="border-style:solid;" class="center">
    <tr>
        <td>test</td>
    </tr>
</table> 
```

[你更新的小提琴](http://jsfiddle.net/m5uEr/1/)

[谷歌](https://www.google.com/search?q=center%20align%20table%20css&oq=center%20align%20table%20css&aqs=chrome.0.57j60j62l2j59.5013&sugexp=chrome,mod=4&sourceid=chrome&ie=UTF-8)通过以下文字为我找到了它：*“center align table css”*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-12T23:04:05.383

css 不工作，所以我做了一个`<table align="center">`

这是在 IE8 上

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-12T22:57:17.963

在桌子上设置宽度并设置

```
margin:auto 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-13T04:24:24.977

您是否将 margin-left:auto, margin-right:auto 放在 div 的属性中？

这很容易做到。

这些属性应该属于表

```
<div style="text-align: center; border-style:solid;">
    <table style="border-style:solid; margin-left:auto; margin-right:auto; ">
        <tr>
            <td>tdddest</td>
        </tr>
    </table>
</div>​ 
```

# jquery - 允许固定的垂直菜单在达到一定长度后滚动

> ID：13850104
> 
> 赞同：2
> 
> 时间：2012-12-12T22:54:18.300
> 
> 标签：jquery, menu

我有一个页面内导航菜单，当您通过我从其他地方挪用的以下代码向下滚动时，它会切换到固定位置：

```
 $(document).ready(function () {
          var top = $('#toc2').offset().top - parseFloat($('#toc2').css('marginTop').replace(/auto/, 0));

$(window).scroll(function (event) {
// what the y position of the scroll is
var y = $(this).scrollTop();

// whether that's below the form
if (y >= top) {
  // if so, add the fixed class
  $('#toc2').addClass('fixed');

} 

else {
  // otherwise remove it
  $('#toc2').removeClass('fixed');
}
 });
}); 
```

CSS 样式：

```
#toc2Wrapper { 
 left: 960px;
 position: absolute;
 width: 200px;
font-size:11px;

}

#toc2 {
 position: absolute;
 top: 0;
 background: #FFF;
 padding:3px;
 width: 200px;
 border: 1px solid #E0E0E0;
}

#toc2.fixed {
 position: fixed;
 top: 0;
 } 
```

我的问题是，如果在菜单中切换多个项目，则根据页面内容的性质，页面内导航可能会变得非常大。这意味着菜单的长度可以超出窗口底部并且由于固定位置脚本而变得无法到达（除非其他部分再次折叠）。

与其依赖一次一个部分的手风琴菜单，我希望能够让菜单在自身内部滚动，或者如果底部超出窗户。

Android 的网站有很好的例子来说明我正在努力实现的目标。在一个相对较短的窗口中展开“App Components”，菜单会出现一个滚动条：

[https://developer.android.com/guide/components/index.html](https://developer.android.com/guide/components/index.html)

如何修改现有脚本以允许这样的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T20:35:38.223

您可以在添加固定 div 类之前测量和比较函数中的窗口高度和#toc2 高度

```
$(window).scroll(function (event) {
  // what the y position of the scroll is
  var y = $(this).scrollTop();

  // get your window and toc heights
  var windowheight = $(this).height();
  var tocheight = $('#toc2').height();

  // compare heights
  if(windowheight > tocheight) {
    // only runs add/remove fixed if window height is greater than #toc2
    if (y >= top) {
      // if so, add the fixed class
      $('#toc2').addClass('fixed');
      } 
  else {
    // otherwise remove it
    $('#toc2').removeClass('fixed');
    }
   }
 }); 
```

# jquery - jquery 组合框更改：函数（事件，用户界面）

> ID：13850110
> 
> 赞同：0
> 
> 时间：2012-12-12T22:54:43.357
> 
> 标签：jquery, jquery-plugins

在 jquery 组合框更改事件中，如何获取触发此事件的控件？

我可以从 $(this).val(); 中看到更改后的文本，但没有关于更改了哪个组合框的信息。

以下都不起作用： $(this).attr('id');

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T23:17:57.957

回调带有一个`event`参数。

要获取源，请使用[e.target](http://api.jquery.com/event.target/)

# python - 动态添加有或没有元类的方法

> ID：13850114
> 
> 赞同：11
> 
> 时间：2012-12-12T22:55:05.993
> 
> 标签：python, metaclass

**更新 - 2012/12/13**

只是为了澄清一下-我对如何向类添加方法的方式不太感兴趣-正如您在下面我的问题和人们的回答中所看到的那样，有不止一种方法可以做到这一点（面颊上的舌头和帽子提示我的 Perl 自我）。

我感兴趣的是了解使用不同方法向类添加方法的根本区别是什么，而真正的大问题是为什么我需要使用元类。例如[A Primer on Python Metaclass Programming](http://onlamp.com/pub/a/python/2003/04/17/metaclasses.html)指出：

> 元类最常见的用法可能是 [...]：为生成的类中定义的方法添加、删除、重命名或替换方法。

而且由于有更多方法可以做到这一点，我很困惑并寻找解释。

谢谢！

**原创 - 2012/12/12**

我需要动态地将方法添加到一个类（以及基于该类的新生成的类）。我想出了两种方法，一种涉及元类，另一种不涉及元类。除了后者不涉及“黑魔法”元类之外，我看不出这两种方法给我的任何区别；）

**使用**元类的方法*#1* ：

 **```
class Meta(type):
        def __init__(cls, *args, **kwargs):
                setattr(cls, "foo", lambda self: "foo@%s(class %s)" % (self,
                        cls.__name__))

class Y(object):
        __metaclass__ = Meta

y = Y()
y.foo() # Gives 'foo@<__main__.Y object at 0x10e4afd10>(class Y)' 
```

**没有**元类的方法*#2* ：

 **```
class Z(object):
        def __init__(self):
                setattr(self.__class__, "foo",
                        lambda self: "foo@%s(class %s)" %
                        (self, self.__class__.__name__))

z = Z()
z.foo() # Gives 'foo@<__main__.Z object at 0x10c865dd0>(class Z)' 
```

据我所知，这两种方法都给了我相同的结果和“表现力”。即使我尝试使用创建新类，`type("NewClassY", (Y, ), {})`或者`type("NewClassZ", (Z, ), {})`我得到相同的预期结果，这两种方法之间没有区别。

所以，我想知道这些方法是否真的存在任何“潜在”差异，或者如果我使用*#1*或*#2*或者它只是一种语法糖，以后是否有任何东西会“咬”我？

PS：*是的，我确实在这里阅读了其他关于 Python 和 pythonic 数据模型中的元类的线程。*

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-13T13:17:23.100

使用元类的一个明显原因是，一旦知道类，它们就真正提供关于类的元数据，与对象的存在与否无关。微不足道的，对吧？好吧，让我们展示一些我在您的原始`Z`和`Y`类上执行的命令，看看这意味着什么：

```
In [287]: hasattr(Y,'foo')
Out[287]: True

In [288]: hasattr(Z,'foo')
Out[288]: False

In [289]: Y.__dict__
Out[289]:
<dictproxy {..., 'foo': <function __main__.<lambda>>}>

In [290]: Z.__dict__
Out[290]:
<dictproxy {...}>

In [291]: z= Z()

In [292]: hasattr(Z,'foo')
Out[292]: True

In [293]: Z.__dict__
Out[293]:
<dictproxy {..., 'foo': <function __main__.<lambda>>}>

In [294]: y = Y()

In [295]: hasattr(Y,'foo')
Out[295]: True

In [296]: Y.__dict__
Out[296]:
<dictproxy {..., 'foo': <function __main__.<lambda>>}> 
```

正如您所看到的，第二个版本实际上在声明 Z 类之后显着改变了它，这是您经常想要避免的。对于 python 来说，对“类型”（类对象）进行操作肯定不是什么罕见的操作，您可能希望它们尽可能一致，当然对于这种情况（该方法在运行时不是真正动态的，只是在声明时）时间）。

一个让我想到的应用程序是文档。如果您要添加一个文档字符串来`foo`使用元类，文档可能会通过`__init__`方法获取它，这是不太可能的。

它还可能导致难以发现的错误。考虑一段使用类元信息的代码。可能在 99.99% 的情况下，这是在一个实例之后执行的`Z`已经创建实例之后执行的，但 0.01% 可能会导致奇怪的行为，如果不是崩溃的话。

它也可能在层次链中变得棘手，您必须小心在哪里调用父级的构造函数。例如，像这样的类可能会出现问题：

```
class Zd(Z):
    def __init__(self):
        self.foo()
        Z.__init__(self)
a = Zd()
...
AttributeError: 'Zd' object has no attribute 'foo' 
```

虽然这很好用：

```
class Yd(Y):
    def __init__(self):
        self.foo()
        Y.__init__(self)
a = Yd() 
```

在没有使用相关的情况下调用方法可能看起来很愚蠢，`__init__`但是当你不小心时可能会发生这种情况，当然在 MRO 不是立即显而易见的更复杂的层次结构中。并且很难发现这个错误，因为大多数情况下 Zd() 会`Z.__init__`在之前的某个地方被调用时成功。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-12T23:24:16.187

如果问题是动态添加方法，python 确实以非常简单的方式处理它。它是这样的：

```
#!/usr/bin/python
class Alpha():

    def __init__(self):
        self.a = 10
        self.b = 100

alpha = Alpha()
print alpha.a
print alpha.b

def foo(self):
    print self.a * self.b * self.c

Alpha.c = 1000
Alpha.d = foo

beta = Alpha()
beta.d() 
```

输出：

```
$ python script.py 
10
100
1000000 
```

问候！

PS：我在这里看不到黑魔法的相似之处（：

**编辑：**

考虑到 martineau 的评论，我要添加`data attributes`，而不是`method function attributes`。我真的看不出做`Alpha.d = foo`and之间没有区别`Alpha.d = lambda self: foo(self)`，除了我将使用 lambda 函数作为`foo`添加函数的包装器。

添加的方法是一样的，python本身对这两个添加的命名都是一样的：

```
#!/usr/bin/python
class Alpha():

    def __init__(self):
        self.a = 10
        self.b = 100

alpha = Alpha()
print alpha.a
print alpha.b

def foo(self):
    print self.a * self.b * self.c

Alpha.c = 1000

Alpha.d = lambda self: foo(self)
Alpha.e = foo

print Alpha.d
print Alpha.e

a = Alpha()
a.d()
a.e() 
```

输出：

```
10
100
<unbound method Alpha.<lambda>>
<unbound method Alpha.foo>
1000000
1000000 
```

如图所示，python 本身将两个结果添加都命名为方法——唯一的区别是一个是对 function 的引用，另一个是对在其定义主体`foo`中使用该函数的 lambda 函数的引用。`foo`

如果我说错了，请纠正我。

问候！****

# javascript - 图像加载循环 IE7 Stack Overflow 在第 0 行

> ID：13850120
> 
> 赞同：2
> 
> 时间：2012-12-12T22:55:44.690
> 
> 标签：javascript, internet-explorer, stack-overflow

我试图逐帧加载 jpeg 图像以创建 jpeg 图像的序列动画。我正在尝试使用 javascript 在递归循环中加载它们。**我需要线性加载图像以实现动画的渐进式播放。（在加载所有帧之前开始播放）**`Stack overflow at line: 0`由于函数的自然递归，我从 IE 收到错误。（我的真实代码加载超过 60 多帧）

这是我如何执行此操作的基本示例：

```
var paths = ['image1.jpg', 'image2.jpg', 'image3.jpg']; //real code has 60+ frames
var images = [];
var load_index = 0;

var load = function(){
    var img = new Image();
    img.onload = function(){
        if(load_index<=paths.length){
            load_index++;
            load();
        }else{
            alert('done loading');
        }
    }
    img.src = paths[load_index];
    images.push(img);
} 
```

在调用加载的下一步时，我似乎可以通过使用间隔为 1 的 setTimeout 来避免此错误。这似乎让 IE 在加载下一个图像之前“呼吸”，但会显着降低图像加载的速度。

有谁知道如何避免这个堆栈溢出错误？

[http://cappuccino.org/discuss/2010/03/01/internet-explorer-global-variables-and-stack-overflows/](http://cappuccino.org/discuss/2010/03/01/internet-explorer-global-variables-and-stack-overflows/)

上面的链接建议包装函数以将其从窗口对象中删除将有助于避免堆栈溢出错误。但随后我看到了奇怪之处，它在整个序列中只获得了大约 15 帧然后就死了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T23:06:16.770

简而言之，在这种情况下不要使用递归函数，没有任何必要：

```
var paths = ['image1.jpg', 'image2.jpg', 'image3.jpg'];
var images = [];
var loads = [];

/// all complete function, probably should be renamed to something with a 
/// unique namespace unless you are working within your own function scope.
var done = function(){
  alert('all loaded');
}

var loaded = function(e,t){
  /// fallbacks for old IE
  e = e||Event; t = e.target||e.srcElement;
  /// keep a list of the loaded images, you can delete this later if wanted
  loads.push( t.src );
  if ( loads.length >= paths.length ) {
    done();
  }
}

var load = function(){
  var i, l = paths.length, img;
  for( i=0; i<l; i++ ){
    images.push(img = new Image());
    img.onload = loaded;
    img.src = paths[i];
  }
} 
```

事实上，正如您所发现的，您当前使用的方法非常密集。相反，上述版本不会为每个`onload`侦听器创建新函数*（节省内存）*，并且会触发浏览器允许的尽可能多的并发加载*（而不是等待每个图像加载）*。

*（以上内容为手动输入，尚未测试）*

### 更新

啊，那么你为什么这样做更有意义:) 在这种情况下，那么你使用的第一种方法`setTimeout`可能是最好的解决方案（你应该能够使用超时`0`）。仍然有重新安排事情的空间，看看你是否可以避免这种情况。以下可能会解决问题...

```
var paths  = ['image1.jpg', 'image2.jpg', 'image3.jpg'];
var images = []; /// will contain the image objects
var loads  = []; /// will contain loaded paths
var buffer = []; /// temporary buffer
var done   = function(){ alert('all loaded'); }

var loaded = function(e,t){
  e = e||Event; t = e.target||e.srcElement; loads.push( t.src );
  /// you can do your "timing/start animation" calculation here...
  /// check to see if we are complete
  if ( loads.length >= paths.length ) { done(); }
  /// if not fire off the next image load
  else { next(); }
}

var next = function(){
  /// current will be the next image
  var current = buffer.shift();
  /// set the load going for the current image
  if ( current ) { current.img.src = current.path; }
}

var load = function(){
  var i, l = paths.length, img;
  for( i=0; i<l; i++ ){
    img = new Image();
    img.onload = loaded;
    /// build up a list of images and paths to load
    buffer.push({ img: img, path: paths[i] });
  }
  /// set everything going
  next();
} 
```

如果上述方法没有做到这一点，另一种解决问题的方法是单步执行您的路径列表，一次一个，然后将一串图像标记（将在屏幕外渲染）附加到 DOM它是自己的`onload="next()"`处理程序......`next()`将负责插入下一张图片。通过这样做，它将触发加载和随后的加载事件到您的代码之外，并且应该绕过堆栈调用。

# jquery - 如何在 node express 网络服务器中使用 requirejs、jquery 和 d3

> ID：13850130
> 
> 赞同：2
> 
> 时间：2012-12-12T22:56:14.060
> 
> 标签：jquery, node.js, express, d3.js, requirejs

我已经为此苦苦挣扎了一段时间，但我没有取得任何进展。我总是遇到一些意想不到的事情。

我想支持 node.js (express) 中的浏览器代码，它使用 require.js、jquery 和 d3.js 根据 http 请求输入参数构建图形 (svg)

我遇到的问题是，一旦 requirejs 被初始化，它总是会返回相同的 jquery 和 d3.v2 模块，并且这些模块（对于每个客户端 http 请求）都将开始在同一个 DOM（jsdom）实例上做他们的事情。最终结果是图表混合在一起。

一旦 require.js 不在图片中就很容易了，但这会让我更新所有大量使用 require.js 模块和依赖项 mgmt 的现有浏览器代码

所有有关如何处理此问题的提示或指向演示此设置的代码的指针将不胜感激！

谢谢

彼得

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T21:37:00.987

最终对我有用的技巧是明确区分设置“浏览器”环境的 node.js 代码和也在浏览器中运行的实际模块。

因此，当一个 http 请求进来时，流程现在是

*   加载 jsdom node.js 模块并创建一个 html 文档和窗口

*   在该文档中确保添加一个加载 require.js 的脚本元素（浏览器版本，而不是 node.js r.js 脚本）

*   在窗口“加载”事件侦听器中拾取通过 jsdom 加载的 requirejs 模块。这我可以用 var requirejs = window.require

*   配置 requirejs 模块（requirejs.config 调用）

*   使用 node.js require 方法显式加载所有本机节点模块（不是 requirejs 之一）

*   最终调用“浏览器”代码

我认为有更好的方法（这肯定有点绕道），但至少现在可行。

也许其他人来到这里，发现这很有用

彼得

# database - 我们什么时候应该使用带有 EF Code First 的 DbSet

> ID：13850131
> 
> 赞同：3
> 
> 时间：2012-12-12T22:56:16.307
> 
> 标签：database, entity-framework-4, ef-code-first

正如标题所说，我们什么时候应该为实体声明一个 DbSet 类型的属性，General Guidelines ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T09:02:07.180

没有通用的指导方针。Instance of`DbSet<YourEntity>`是您加载和持久化给定类型实体的访问点。如果您不公开上下文类型的属性，您仍然可以使用`dbContext.Set<YourEntity>()`.

公开和不公开属性的唯一区别在于定义模型期间的实体发现。首次使用 EF 时，它会为已定义的实体构建“模型”。实体是通过以下方式发现的：

*   `DbModelBuilder`在实例上明确定义的映射
*   `DbModelBuilder`在实例中显式注册的配置类型
*   `DbSet<>`在上下文类型中定义的属性
*   已发现实体引用的类型

因此，如果您不使用`DbSet<>`属性，则必须使用其他方法告诉 EF 您的实体。

# sql-server - SQL Server / Web Server 语言独立的 DATE/CURRENCY/DECIMAL 查询与 ASP.NET

> ID：13850133
> 
> 赞同：1
> 
> 时间：2012-12-12T22:56:26.220
> 
> 标签：sql-server, date, locale, iso

我们将所有站点都托管在 Win 2003 服务器（意大利语）上，并将数据库托管在 SQL Server 2005（意大利语）上。

现在我们将所有内容转移到另一台拥有 Win 2008（英文版）和 SQL Server 2008（英文版）的主机上。

所有日期现在都不`mm/dd/yyyy`是`dd/mm/yyyy`.

`yyyymmdd`幸运的是，我使用一些函数开发了 asp 代码，这些函数在存储过程和动态查询（如）中都传递了日期的 ISO 格式。

并检索它们，我们在显示之前通过其他 asp 函数解析日期，所以一切正常。

现在我们正在切换到 asp.net，所以因为它似乎有很好的文化支持，我想知道它是否有一些为此目的的内置函数，用 SQL Server 读取/传递/格式化/插入日期，以便它们完全独立于Win 服务器语言环境和 SQL Server 语言，还是我们必须像使用经典 asp 那样自己编写这些函数？

小数和货币也可能存在问题，处理“，”或“。” 用于小数分隔。我不知道是否用“。”传递小数。到 SQL Server（并使用内部查询和存储过程）始终是正确的，或者可能存在一些问题，例如日期。

关于这些主题的任何提示？

# ruby - Selenium WebDriver/Ruby send_keys 字符限制

> ID：13850134
> 
> 赞同：0
> 
> 时间：2012-12-12T22:56:29.190
> 
> 标签：ruby, textarea, selenium-webdriver

我在 Ubuntu 12.04 桌面上的 Ruby 1.8.7 上使用 Selenium WebDriver。我有一个脚本，它将一堆数据文件的内容（作为字符串）一次一个文件转储到一个表单中。数据文件的大小范围从 44kB 到 92kB。我可以手动将内容复制并粘贴到 textarea 中而不会出错。但是，当我在元素上使用带有 send_keys 的 Ruby 脚本时，脚本会停止、失败并且从不报告错误。

我知道我有正确的元素并且 send_keys 通常可以工作，因为我已经将“hello world”发送到了 textarea。我也知道我正确地抓取了输入文件，因为我可以逐行分解它并将文件的全部内容一次一行发送到 textarea 而不会出错。

逐行 send_keys 是可行的，但相当慢。我假设问题是某种形式的 send_keys 对字节/字符/等数量的限制。并且我的输入文件已超出该限制。然而，我的谷歌搜索在这方面一无所获。

有谁知道这里的限制是什么（send_keys 或其他）？理想情况下，如果 send_keys 限制为 1000 个字符，我会一次将输入文件分解为 1000 个字符并循环遍历，直到使用 send_keys 发送整个文件。（这肯定比一次发送 1 行要快。）有没有我不知道的 send_keys 的替代方法可以发送这种大小的字符串？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T00:29:27.737

您可以使用[剪贴板 gem](http://rubygems.org/gems/clipboard)，然后只需使用键盘快捷键粘贴此元素。

```
Clipboard.copy(data)
$driver.find_element(:id, "elementFoo").send_keys [:control, 'v'] 
```

# windows - __asm .set 不能在 Visual C 2010 中编译？

> ID：13850137
> 
> 赞同：0
> 
> 时间：2012-12-12T22:57:02.050
> 
> 标签：windows, visual-c++, assembly

我正在使用 Visual C 2010，并且`__asm`使用大多数汇编指令编译代码没有问题，例如

```
__asm { 
mov eax, eax 
call L1
} 
```

但无论出于何种原因`.set`，或者`.long`不工作，例如

```
 __asm { 
    .set SOMETHING 0x000fff
   .long NUMBER

    } 
```

编译器说语法错误，需要操作码。你如何使用`.set`Visual C 的`__asm`？

# java - 从 repo 构建可部署的 maven 代码的常规工作流程

> ID：13850138
> 
> 赞同：2
> 
> 时间：2012-12-12T22:57:05.630
> 
> 标签：java, maven, deployment, build

我正在建立一个 Maven 存储库，目标是自动化我的大部分构建和部署过程。我当前的工作流程从启动服务器开始`git clone`，然后运行一系列`mvn install`命令来完成顶级应用程序。

据我了解，Maven 不是用于部署应用程序的工具，在这一点上，我认为不需要持续集成或持续部署服务器或正式流程。

但是，到目前为止，我还没有找到一种规范的方法来将完整的、可运行的程序与 Maven 放在一起。

该脚本甚至可以获取顶级 jar 并将其安装到本地 maven 存储库中：

```
mvn -DgroupId=me.company -DartifactId=Top-Level-Application -Dversion=1.0-SNAPSHOT   -DrepoUrl='http://theserver:8081/nexus/' dependency:get 
```

如果我手动安装所有东西，这个应用程序会在一个目录中找到它所有的依赖 jar `lib/`，就像 Maven 应该做的那样。然而，这个被拉取的 jar 是不可部署的——虽然依赖的 jar 安装到本地 repo，但它们没有在类路径期望的地方编译。

我想如果我可以操纵上面的脚本来拉动`pom.xml`jar 而不是仅仅拉动 jar 并在其`mvn install`上运行，一切都会顺利进行（尽管奇怪的是这似乎重复了构建过程的最后一步）。另一种选择是让应用程序将所有依赖的 jar 卷到一个巨大的 jar 中，并且没有外部依赖项。

这些（或其他）选项中的哪一个是完成 Maven 构建过程的正确方法？

这是我们的顶级 pom，缩小到我认为相关的范围内：

```
<project>
<modelVersion>4.0.0</modelVersion>
<groupId>me.company</groupId>
<artifactId>Top-Level-Application</artifactId>
<packaging>jar</packaging>
<version>1.0-SNAPSHOT</version>
<name>Top Level Application</name>
<url>http://company.me</url>

<properties>
    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
</properties>

<distributionManagement>
    <repository>
        <id>releases</id>
        <url>http://host:8081/nexus/content/repositories/releases</url>
    </repository>
    <snapshotRepository>
        <id>snapshots</id>
        <name>Internal Snapshots</name>
        <url>http://host:8081/nexus/content/repositories/snapshots</url>
    </snapshotRepository>
</distributionManagement>

<build>
    <sourceDirectory>src</sourceDirectory>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-compiler-plugin</artifactId>
            <version>2.5.1</version>
            <configuration>
                <source>1.7</source>
                <target>1.7</target>
            </configuration>
        </plugin>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-jar-plugin</artifactId>
            <version>2.4</version>
            <configuration>
                <archive>
                    <manifest>
                        <addClasspath>true</addClasspath>
                        <classpathPrefix>lib/</classpathPrefix>
                        <mainClass>me.company.application.MainClass</mainClass>
                    </manifest>
                </archive>
            </configuration>
        </plugin>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-dependency-plugin</artifactId>
            <version>2.4</version>
            <executions>
                <execution>
                    <id>copy</id>
                    <phase>compile</phase>
                    <goals>
                        <goal>copy-dependencies</goal>
                    </goals>
                    <configuration>
                        <outputDirectory>
                            ${project.build.directory}/lib
                        </outputDirectory>
                    </configuration>
                </execution>
            </executions>
        </plugin>
    </plugins>
</build>
<dependencies>
    <dependency>
        <groupId>me.company</groupId>
        <artifactId>First-Library</artifactId>
        <version>1.0-SNAPSHOT</version>
    </dependency>
    <!-- more in-house libraries -->
    <!-- third party libraries - Apache Commons, javamail, etc. -->
</dependencies>
</project> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T23:38:48.467

如果我错了，请纠正我——您想将源代码转换为已编译的 JAR，并为其依赖项设置适当的类路径？这根本不是`dependency:get`目的。您应该查看[Maven JAR 插件](http://maven.apache.org/plugins/maven-jar-plugin/)和/或[Maven AppAssembler](http://mojo.codehaus.org/appassembler/appassembler-maven-plugin/)插件。

# java - 初始化 jFrame 的问题

> ID：13850139
> 
> 赞同：0
> 
> 时间：2012-12-12T22:57:10.397
> 
> 标签：java, swing, jframe

我正在创建一个从 javaSpace 检索的客户端窗口，这是我正在使用的代码。

```
/**
 * Create the frame.
 */
public Client() 
{
    space = SpaceUtils.getSpace();
    if (space == null) 
    {
        System.err.println("Failed to find the javaspace");
        System.exit(1);
    }

    initFrame();
    setVisible(true);
    processPrintJobs();
} 
```

窗口在 initFrame() 内部生成；然后 processPrintJobs 检查是否有任何新消息。如果我注释掉 processPrintJobs() 方法调用，那么窗口会正确绘制，但如果方法调用存在，则窗口只会显示一个空白方块。

就像由于多次检查进程而没有正确创建窗口一样，这没有意义，因为在运行 while 循环之前创建了窗口。

```
public void processPrintJobs() 
{

    while (true) 
    {
        try 
        {
            Message template = new Message();

            if (channel == null) 
            {
                System.out.println("No channel given");
            } else 
            {
                template.Channel = channel;
                // System.out.println(channel);
                template.position = new Integer(getNumber() + 1);

                Message msg = (Message) space.read(template, null,
                        Long.MAX_VALUE);

                messageList.append(msg.execute());
            }
        } catch (Exception e) 
        {
            e.printStackTrace();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-12T23:04:30.157

这个无限`while`循环会阻塞`EDT`.

```
while (true) 
```

只需调用

```
setVisible(true); 
```

不保证`JFrame`会立即上漆。任何长期存在的进程都应该由[SwingWorker](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/worker.html)处理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-12T23:07:33.393

采用

```
java.awt.EventQueue.invokeLater(new Runnable() {
    @Override
    public void run() {
        processPrintJobs();
    }
} 
```

但总的来说，您的应用程序的架构缺少某些方面。

比如一根线什么的。

* * *

***更多的：***

例如，您可以使用摆动计时器，每滴答作一项工作。

```
import javax.swing.Timer; 
```

在客户端构造函数结束时调用。

```
 Timer printJobsTimer = new Timer(100, new ActionListener() {

        public void actionPerformed(ActionEvent e) {

            // Process a print job:

            if (channel != null) {
                Message template = new Message();
                template.Channel = channel;
                template.position = new Integer(getNumber() + 1);

                Message msg = (Message) space.read(template, null,
                        Long.MAX_VALUE);

                messageList.append(msg.execute());
            }
        }
    });
    printJobsTimer.setInitialDelay(100);
    printJobsTimer.start(); 
```

其余的，组合命名就可以了：只是类名以大写字母开头，其他名称以小写字母开头。

# c++ - Thrift TNonblockingServer.cpp 未声明的标识符 - Windows

> ID：13850142
> 
> 赞同：0
> 
> 时间：2012-12-12T22:57:18.780
> 
> 标签：c++, visual-studio-2008, build, compiler-errors, thrift

在尝试使用 TNonblockingServer 构建[Thrift](http://thrift.apache.org/)时（我以前没有，因为它具有[libevent](http://libevent.org/)依赖项），我遇到了这个错误：

> 错误 C2065：“EWOULDBLOCK”：未声明的标识符

在 TNonblockingServer 中找到。EWOULDBLOCK 在名为 force_inc.h 的文件中定义，但该文件似乎不包含在 TNonblockingServer.h 或 TNonblockingServer.cpp 文件中。

我意识到我可以只`#include`处理文件并完成它，但我想知道是否有任何对 Thrift 有更多经验的人之前遇到过这个问题/知道是否有更优雅的方法来解决这个问题。

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T17:42:10.647

这似乎是因为我将它移植到 VS2008，其中 force_inc.h 标头不会自动包含在内。在 VS2010 和 VS2012 中，情况并非如此。

# listview - 尝试通过单击按钮过滤 Grouped GridLayout Listview

> ID：13850143
> 
> 赞同：2
> 
> 时间：2012-12-12T22:57:21.707
> 
> 标签：listview, windows-8, filter, winjs

我正在学习 WinJs，但我的应用程序有问题。我有一个在 Gridlayout 中显示的 Grouped ListView。我使用模板，在模板的标题中，有三个按钮。在我的 Javascript 中，我有一个按重要性过滤列表然后对其进行分组的函数。当我单击按钮时，我传递了临界值，然后在过滤器中使用它。我遇到的问题是，当单击按钮但显示没有改变时，会调用执行过滤和分组的函数。

我搜索了该站点并发现了一些我认为可能会有所帮助的主题，但它们都是针对 Android 应用程序的。

谁能告诉我我做错了什么？

代码片段：

[数据.js]

```
(function () {
  "use strict";

  var groupedItemsList;
  var jobStatusCriticality = "";
  var groupedJobs, filteredDataList;

  var dataList = new WinJS.Binding.List();

  function listData() { //removed for web}

  WinJS.Namespace.define("JobGroup.Functions", {
    setupJobGroup: function setupGroup(jsc) {
        if (jsc != "") {
          filteredDataList = dataList.createFiltered(
                function (dataItem) {
                    if (dataItem.jobCriticality == jsc) {
                        return true;
                    }
                    else {
                        return false;
                    }
                }
          );
          filteredDataList.notifyReload();
        }
        else {
            filteredDataList = dataList;
        }

        groupedJobs = filteredDataList.createGrouped(
            function (dataItem) {
                return dataItem.jobStatus;
            },
            function (dataItem) {
                return { status: dataItem.jobStatus };
            },
            function (first, second) {
                return first.charCodeAt(0) - second.charCodeAt(0);
            }
        );
    }
});

JobGroup.Functions.setupJobGroup(jobStatusCriticality);
WinJS.Namespace.define("DataExample", { myList: groupedJobs });
WinJS.UI.processAll().then(listData); 
```

[默认.html]

```
<div id="mediumListIconTextTemplate" data-win-control="WinJS.Binding.Template">
  //remove for web
</div>

<div id="headerTemplate" data-win-control="WinJS.Binding.Template">
  <div id="sortType"> 
    <div id="sortAll"><span><button id="viewAllBtn" type="button" onclick="JobGroup.Functions.setupJobGroup('')">View All</button></span></div>
    <div id="sortCritical"><span><button id="viewCriticalBtn" type="button" onclick="JobGroup.Functions.setupJobGroup('CRITICAL')">Critical</button></span></div>
    <div id="sortWarning"><span><button id="viewWarningBtn" type="button" onclick="JobGroup.Functions.setupJobGroup('WARNING')">Warning</button></span></div>
  </div>
</div>

<div id="groupedListView"
  data-win-control="WinJS.UI.ListView" 
  data-win-options="{itemDataSource: DataExample.myList.dataSource, 
    itemTemplate: select('#mediumListIconTextTemplate'),
    groupDataSource: DataExample.myList.groups.dataSource,
    groupHeaderTemplate: select('#headerTemplate'),
    layout: {type: WinJS.UI.GridLayout}}">
</div> 
```

[default.js] //包含标准默认代码

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T14:58:13.863

快速扫描，所以你可能不得不玩这个，但我认为这是在球场上......

您需要使用新的**dataSource更新****ListView**。您现在连接的方式是将**List**绑定到**myList.dataSource**，这实际上是**groupedJobs**。当您单击一个按钮时，您会创建一个新的数据排序，但**createGrouped**会创建一个全新的对象，因此不会通知**ListView**发生了某些变化 - **ListView**仍绑定到旧对象。打电话

 ******```
groupedListView.winControl.itemDataSource = groupedJobs.dataSource;
groupedListView.winControl.groupDataSource = groudedJobs.groups.dataSource; 
```

在你的**listData**函数的末尾会做我认为的伎俩。******

# jsf - 在 JSF 中调用另一个页面

> ID：13850158
> 
> 赞同：2
> 
> 时间：2012-12-12T22:58:19.953
> 
> 标签：jsf

我有一个带有 2 个 .xhtml 文件的简单 JSF 应用程序。当我运行应用程序时，显示的第一页是welcome.xhtml：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
xmlns:f="http://java.sun.com/jsf/core"
xmlns:h="http://java.sun.com/jsf/html">
<h:head>
<title>Final Project</title>
</h:head>
<h:body bgcolor="white">
<div align="center" style="border:5px outset blue;">Welcome to the Product         Inventory     Application</div>
<br></br>
<br></br>
    <h:commandButton value="View All Products" action="allProducts"/>
</h:body> 
```

它显示得很好，但是当我按下查看所有产品按钮时，我希望它显示 allProducts.xhtml facelet。但是当我单击按钮时，什么都没有发生，没有异常或任何事情。allProducts.xhtml 页面只是：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
xmlns:f="http://java.sun.com/jsf/core"
xmlns:h="http://java.sun.com/jsf/html">
<h:head>
<title>All Products</title>
</h:head>
<h:body bgcolor="white">
<h3>Test</h3>
</h:body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T00:16:07.570

问题是`UICommand`(`<h:commandButton>`和类似的`<h:commandLink>`) 必须在表单内，即`<h:form>`。*将您的welcome.xhtml*页面更改为：

```
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html">
<h:head>
<title>Final Project</title>
</h:head>
<h:body bgcolor="white">
<div align="center" style="border:5px outset blue;">Welcome to the Product         Inventory     Application</div>
<br></br>
<br></br>
    <h:form>
        <h:commandButton value="View All Products" action="allProducts"/>
    </h:form>
</h:body> 
```

更多信息：

*   [h:commandLink / h:commandButton 没有被调用](https://stackoverflow.com/q/2118656/1065197)，原因 1\. IMO，如果您要大量使用 JSF，我建议您将此问题标记为收藏夹:)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-12T23:22:21.643

我不知道确切的细节，但这是大致的想法。欢迎页面上按钮的 action 属性是指支持 bean 的“allProducts”方法。该方法必须返回字符串“allProducts.xhtml”才能让 JSF 显示产品页面。因此，您必须为欢迎页面引入一个支持 bean，并赋予该类一个方法“allProducts”。

# java - 使用 Nutch 从网页中提取文本

> ID：13850164
> 
> 赞同：2
> 
> 时间：2012-12-12T22:59:20.487
> 
> 标签：java, web-scraping, nutch

我是 Nutch 的新手，所以请多多包涵。

我的目标是简单地从网页中提取一些内容并能够检索结果信息。例如，假设我在电子商务网站上抓取了一些页面并打算存储产品信息（即名称、类别、价格等）。

重申一下，假设我的 seed.txt 文件包含 www.site.com 并且我初始化了一个爬虫。假设我的 HtmlParseFilters 设置为正确解析来自 www.site.com 的产品信息，并且此爬网将解析 www.site.com 和 www.site.com/link。如果 www.site.com 包含 ID 为 1 的产品 A，而 www.site.com/link 包含 ID 为 2 的产品 B，我希望我能够使用某种预定义的实用程序单独为我提供这些结果：

`A 1`

`B 2`

目前，我发现自己正在修改 org.apache.nutch.segment.SegmentReader 和 org.apache.nutch.parse.ParseResult AND org.apache.nutch.metadata.MetaData 的 toString() 方法来隔离我提取的结果，这让我觉得我错过了一些东西……我不想看到外链、recno、URL、解析元数据、播放或任何其他抓取元数据；如上所述，我只想要我的 HTML 过滤结果。

简而言之，我真的很想了解如何使用 nutch 来抓取一组网站，并只给我提取的内容。

如果您需要任何澄清，请随时告诉我。

# .net - SqlConnection.Dispose() 是否对所有挂起的事务执行回滚？

> ID：13850165
> 
> 赞同：5
> 
> 时间：2012-12-12T22:59:33.540
> 
> 标签：.net, sql-server, ado.net

> **可能重复：**
> [当连接关闭时，未提交的事务会发生什么？](https://stackoverflow.com/questions/1539564/what-happens-to-an-uncommitted-transaction-when-the-connection-is-closed)

我知道 a`SqlTransaction`将自行回滚`Dispose()`（请参阅[如果发生错误，使用语句将回滚数据库事务吗？](https://stackoverflow.com/questions/641660/will-a-using-statement-rollback-a-database-transaction-if-an-error-occurs)），但是当它的父对象被释放时它会被回滚`SqlConnection`吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T18:21:14.573

是的，但我不认为它是由 SqlConnection 类处理的。

我认为是 SQL Server 在连接关闭时自动回滚所有未提交的事务。

还要考虑 SqlConnection 默认有一个连接池。因此，当您关闭/处置 SqlConnection 时，“真实”数据库连接可能仍然处于活动状态。

# php - 为什么无法访问注销操作？

> ID：13850166
> 
> 赞同：0
> 
> 时间：2012-12-12T22:59:35.620
> 
> 标签：php, authentication, cakephp-2.0, logout

我想让我的 users 控制器`Auth`访问`login()`,`logout()`和`add()`action ，但我是否使用并不重要，`$this->Auth->allow('logout');`我会收到消息：`You are not authorized to access that location.` `login()`并且`add()`工作正常。

这是我的 AppContoller.php：

```
class AppController extends Controller {

    public $components = array(

        'Auth' => array(
            'authenticate' => array(
                'Form' => array(
                    'userModel' => 'User',
                    'fields' => array(
                    'username' => 'email', 'password' => 'password')
                    )

            ), 

            'loginRedirect' => array('controller' => 'users', 'action' => 'index'),
            'logoutRedirect' => array('controller' => 'pages', 'action' => 'display', 'landing')
        ), 'Session'
    );

    public function beforeFilter() {
        $this->Auth->allow('add', 'login');
    }

} 
```

这是我的 UsersController.php 的相关部分：

```
 public $helpers = array('Html', 'Form', 'Session');
    public $components = array('Session');

    public function beforeFilter() {

        parent::beforeFilter();
        $this->Auth->allow('logout');

    }
    public function logout() {
        $this->set('title_for_layout', 'Logout');
        $this->redirect($this->Auth->logout());
    } 
```

有人看到这里的问题吗？我感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T10:51:33.467

您似乎可以毫无问题地访问注销操作，但注销重定向会破坏您的会话并将您重定向到`page`视图。

您似乎无法在未登录的情况下访问该页面。（您可以尝试在不登录的情况下访问该 URL）

在您的添加`beforeFilter`功能`PagesController`：

```
public function beforeFilter(){
    parent::beforeFilter();

    $this->Auth->allow();
} 
```

PagesController comes by default with CakePHP 2.2, if you don't have it, just copy and paste any other controller and add this function deleting all the rest.

EDITED: If the PagesController was already there, just add the beforeFilter function.

# javascript - 根据值更改 html 5 输出对象的颜色

> ID：13850169
> 
> 赞同：1
> 
> 时间：2012-12-12T22:59:59.780
> 
> 标签：javascript, css, html

如果计算结果为负，我想将计算结果的颜色更改为红色。我尝试了一个样式表，并将输出放入 javascript 调用中，但它似乎不起作用。有没有办法将下面示例代码中的 html 5 输出“o”的颜色更改为红色（如果它是负数）和绿色（如果它是正数）？

表单 oninput="o.value = a.valueAsNumber + b.valueAsNumber"
输入名称="a" id="a" type="number" step="any" +
输入名称="b" id="b" 类型="number" step="any" =
输出名称="o" for="a b">

/形式

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T23:56:28.587

当用户没有展示他们首先尝试过的内容时，我不喜欢仅仅给出答案，但这实际上有点有趣，我以前从未见过这种类型的表单。

就像@feeela 所说，您可以使用 JS 来监视输入更改并相应地验证输出字段。我正在使用 jQuery 来执行此操作：

```
$(document).ready(function() {
    $('input').change(
        function()
        {
            $('output').removeAttr('class');
            var sum = parseInt($('output').first().html());
            if (isNaN(sum))
            {
                $('output').addClass('error');
            }
            else if (sum < 0)
            {
                $('output').addClass('negative');
            }
            else if (sum > 0)
            {
                $('output').addClass('positive');
            }
        }
    );
}); 
```

然后，您可以使用样式表根据其类为输出字段赋予颜色。​ 你可以在这里查看演示：http: [//jsfiddle.net/S7cVP/](http://jsfiddle.net/S7cVP/)

# javascript - JSON.stringfy 函数在 IE8 中序列化空 DOM 元素时返回“null”

> ID：13850170
> 
> 赞同：2
> 
> 时间：2012-12-12T23:00:04.790
> 
> 标签：javascript, json, internet-explorer-8

我的页面中有一个弹出对话框，其中包含 20 个字段。可以修改 20 个字段，对对话框的任何更改都将更新到服务器。

`null`只有在 IE8 中，当用户尝试清除字段并保存内容时，字段值才会设置为。

似乎使用 IE8 的本机函数序列化**空**`JSON.stringfy`DOM 元素的值是返回`"null"`（字符串）而不是`""`

**演示： http:** [//jsfiddle.net/6VKzy/2/](http://jsfiddle.net/6VKzy/2/) [在 IE8 中打开]

博客中有关该问题的更多详细信息，

> 在 IE8 中启用原生 JSON 支持后，用户现在可以利用内置的 JSON.stringify 和 JSON.parse 方法将 JScript 值序列化和反序列化为 JSON 文本，反之亦然。***但是，在 IE8 的原生 JSON 实现中存在一个已知问题，其中如果用户尝试读取空 DOM 元素的值，并使用原生 JSON 对其进行序列化，则结果与用户在序列化时所期望的不同“ ”***。

[http://blogs.msdn.com/b/jscript/archive/2009/06/23/serializing-the-value-of-empty-dom-elements-using-native-json-in-ie8.aspx](http://blogs.msdn.com/b/jscript/archive/2009/06/23/serializing-the-value-of-empty-dom-elements-using-native-json-in-ie8.aspx)

**注意：**这个问题是自我回答的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-12T23:00:04.790

解决方法是使用下面的审查函数来返回`""`而不是`"null"`.

```
function(k, v) { return v === "" ? "" : v } 
```

**修复DEMO： http:** [//jsfiddle.net/6VKzy/3/](http://jsfiddle.net/6VKzy/3/) [在IE8中打开验证修复]

博客中的更多详细信息和不同的修复方法，

> 这是 IE8 生产版本中的一个错误。这里的问题是在 DOM 中使用特殊编码来表示缺失的字符串值。尽管这个特殊值与 JScript 文字 "" 的编码不同，但在整个 JScript 实现中，该值被视为 === 到 ""，但 JSON.stringify 中的特定情况除外。
> 
> 由于此特殊值仅源自对 DOM 对象的访问，因此一种解决方法是在每个可能返回的 DOM 访问中显式地审查它们。

[http://blogs.msdn.com/b/jscript/archive/2009/06/23/serializing-the-value-of-empty-dom-elements-using-native-json-in-ie8.aspx](http://blogs.msdn.com/b/jscript/archive/2009/06/23/serializing-the-value-of-empty-dom-elements-using-native-json-in-ie8.aspx)

# python - matplotlib和python多线程/多处理文件处理

> ID：13850179
> 
> 赞同：2
> 
> 时间：2012-12-12T23:01:22.137
> 
> 标签：python, multithreading, matplotlib, multiprocessing, python-multithreading

我有大量文件要处理。我编写了一个脚本来获取、排序和绘制我想要的数据。到现在为止还挺好。我已经对其进行了测试，它给出了预期的结果。

然后我想使用多线程来做到这一点。我查看了互联网上的文档和示例，并且在我的程序中使用一个线程可以正常工作。但是当我使用更多时，在某些时候我得到随机的 matplotlib 错误，并且我怀疑那里有一些冲突，即使我使用了一个带有绘图名称的函数，而且我看不出问题可能出在哪里。

如果您需要更多评论，这是整个脚本，我会添加它们。谢谢你。

```
#!/usr/bin/python
import matplotlib
matplotlib.use('GTKAgg')
import numpy as np
from scipy.interpolate import griddata

import matplotlib.pyplot as plt
import matplotlib.colors as mcl
from matplotlib import rc #for latex

import time as tm
import sys
import threading
import Queue #queue in 3.2 and Queue in 2.7 !

import pdb #the debugger

rc('text', usetex=True)#for latex

map=0 #initialize the map index. It will be use to index the array like     this: array[map,[x,y]]
time=np.zeros(1) #an array to store the time
middle_h=np.zeros((0,3)) #x phi c

#for the middle of the box
current_file=open("single_void_cyl_periodic_phi_c_middle_h_out",'r')
for line in current_file:
    if line.startswith('# ===  time'):
        map+=1
        np.append(time,[float(line.strip('# ===  time  '))])
    elif line.startswith('#'):
        pass
    else:
        v=np.fromstring(line,dtype=float,sep=' ')
        middle_h=np.vstack( (middle_h,v[[1,3,4]]) ) 
current_file.close()
middle_h=middle_h.reshape((map,-1,3)) #3d array: map, x, phi,c 

#####
def load_and_plot(): #will load a map file, and plot it along with the     corresponding profile loaded before
    while not exit_flag:
        print("fecthing work ...")
        #try:
        if not tasks_queue.empty():
            map_index=tasks_queue.get()
            print("----> working on map: %s" %map_index)
            x,y,zp=np.loadtxt("single_void_cyl_growth_periodic_post_map_"+str(map_index),unpack=True, usecols=[1, 2,3])
            for i,el in enumerate(zp):
                if el<0.:
                    zp[i]=0.
            xv=np.unique(x)
            yv=np.unique(y)
            X,Y= np.meshgrid(xv,yv)
            Z = griddata((x, y), zp, (X, Y),method='nearest')

            figure=plt.figure(num=map_index,figsize=(14, 8))
            ax1=plt.subplot2grid((2,2),(0,0))
            ax1.plot(middle_h[map_index,:,0],middle_h[map_index,:,1],'*b')
            ax1.grid(True)
            ax1.axis([-15, 15, 0, 1])
            ax1.set_title('Profiles')
            ax1.set_ylabel(r'$\phi$')
            ax1.set_xlabel('x')

            ax2=plt.subplot2grid((2,2),(1,0))
            ax2.plot(middle_h[map_index,:,0],middle_h[map_index,:,2],'*r')
            ax2.grid(True)
            ax2.axis([-15, 15, 0, 1])
            ax2.set_ylabel('c')
            ax2.set_xlabel('x')

            ax3=plt.subplot2grid((2,2),(0,1),rowspan=2,aspect='equal')
            sub_contour=ax3.contourf(X,Y,Z,np.linspace(0,1,11),vmin=0.)
            figure.colorbar(sub_contour,ax=ax3)
            figure.savefig('single_void_cyl_'+str(map_index)+'.png')
            plt.close(map_index)
            tasks_queue.task_done()
        else:
            print("nothing left to do, other threads finishing,sleeping 2 seconds...")
            tm.sleep(2)
   # except:
   #     print("failed this time: %s" %map_index+". Sleeping 2 seconds")
   #     tm.sleep(2)
#####
exit_flag=0
nb_threads=2
tasks_queue=Queue.Queue()
threads_list=[]

jobs=list(range(map)) #each job is composed of a map
print("inserting jobs in the queue...")
for job in jobs:
    tasks_queue.put(job)
print("done")

#launch the threads
for i in range(nb_threads):
    working_bee=threading.Thread(target=load_and_plot)
    working_bee.daemon=True
    print("starting thread "+str(i)+' ...')
    threads_list.append(working_bee)
working_bee.start()

#wait for all tasks to be treated
tasks_queue.join()

#flip the flag, so the threads know it's time to stop
exit_flag=1

for t in threads_list:
    print("waiting for threads %s to stop..."%t)
    t.join()

print("all threads stopped") 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T16:23:44.220

按照大卫的建议，我在多处理中做到了。使用 8 个处理器，我的速度提高了 5 倍。我相信剩下的就是在我的脚本开始时对单进程工作进行处理。编辑：但是有时脚本会在最后一张地图上“挂起”，即使它生成了正确的地图，也会出现以下错误：

文件“single_void_cyl_plot_mprocess.py”，第 90 行，在 tasks_queue.join()

文件“/usr/local/epd-7.0-2-rh5-x86_64/lib/python2.7/multiprocessing/queues.py”，第 316 行，加入 self._cond.wait()

文件“/usr/local/epd-7.0-2-rh5-x86_64/lib/python2.7/multiprocessing/synchronize.py”，第 220 行，等待 self._wait_semaphore.acquire（真，超时）

```
import numpy as np
from scipy.interpolate import griddata

import matplotlib.pyplot as plt
from matplotlib import rc #for latex

from multiprocessing import Process, JoinableQueue

import pdb #the debugger

rc('text', usetex=True)#for latex

map=0 #initialize the map index. It will be use to index the array     like this: array[map,x,y,...]
time=np.zeros(1) #an array to store the time
middle_h=np.zeros((0,3)) #x phi c

#for the middle of the box
current_file=open("single_void_cyl_periodic_phi_c_middle_h_out",'r')
for line in current_file.readlines():
    if line.startswith('# ===  time'):
        map+=1
        np.append(time,[float(line.strip('# ===  time  '))])
    elif line.startswith('#'):
        pass
    else:
        v=np.fromstring(line,dtype=float,sep=' ')
        middle_h=np.vstack( (middle_h,v[[1,3,4]]) ) 
current_file.close()
middle_h=middle_h.reshape((map,-1,3)) #3d array: map, x, phi,c 

#######
def load_and_plot(): #will load a map file, and plot it along with     the corresponding profile loaded before
    while tasks_queue.empty()==False:
        print("fecthing work ...")
        try:
            map_index=tasks_queue.get() #get some work to do from     the queue
            print("----> working on map: %s" %map_index)
                 x,y,zp=np.loadtxt("single_void_cyl_growth_periodic_post_map_"+str(map_index),\
                unpack=True, usecols=[1, 2,3])
            for i,el in enumerate(zp):
                if el<0.:
                    zp[i]=0.
            xv=np.unique(x)
            yv=np.unique(y)
            X,Y= np.meshgrid(xv,yv)
            Z = griddata((x, y), zp, (X, Y),method='nearest')

            figure=plt.figure(num=map_index,figsize=(14, 8))
            ax1=plt.subplot2grid((2,2),(0,0))
                ax1.plot(middle_h[map_index,:,0],middle_h[map_index,:,1],'*b')
            ax1.grid(True)
            ax1.axis([-15, 15, 0, 1])
            ax1.set_title('Profiles')
            ax1.set_ylabel(r'$\phi$')
            ax1.set_xlabel('x')

            ax2=plt.subplot2grid((2,2),(1,0))
                ax2.plot(middle_h[map_index,:,0],middle_h[map_index,:,2],'*r')
            ax2.grid(True)
            ax2.axis([-15, 15, 0, 1])
            ax2.set_ylabel('c')
            ax2.set_xlabel('x')

            ax3=plt.subplot2grid((2,2),    (0,1),rowspan=2,aspect='equal')
                sub_contour=ax3.contourf(X,Y,Z,np.linspace(0,1,11),vmin=0.)
            figure.colorbar(sub_contour,ax=ax3)
                figure.savefig('single_void_cyl_'+str(map_index)+'.png')
            plt.close(map_index)
            tasks_queue.task_done() #work for this item finished
        except:
            print("failed this time: %s" %map_index)
#######

nb_proc=8 #number of processes
tasks_queue=JoinableQueue() #a queue to pile up the work to do

jobs=list(range(map)) #each job is composed of a map
print("inserting jobs in the queue...")
for job in jobs:
    tasks_queue.put(job)
print("done")

#launch the processes
for i in range(nb_proc):
    current_process=Process(target=load_and_plot)
    current_process.start()

#wait for all tasks to be treated
tasks_queue.join() 
```

# sql - 在实体框架中使用 SQL dB 列作为并发操作的锁

> ID：13850180
> 
> 赞同：0
> 
> 时间：2012-12-12T23:01:28.270
> 
> 标签：sql, entity-framework, locking, azure-sql-database, mutual-exclusion

我们有一个长期运行的用户操作，由工作进程池处理。数据输入和输出来自 Azure SQL。

主 Azure SQL 表结构列近似为

```
[UserId, col1, col2, ... , col N, beingProcessed, lastTimeProcessed ] 
```

`beingProcessed`是布尔值并且`lastTimeProcessed`是日期时间。每个工人角色的逻辑如下所示，并且有多个工人处理（每个工人都有自己的实体框架层），本质上`beingProcessed`是用于互斥目的的锁

**问题**：如何`beingProcessed`根据上述负载处理“锁”本身的并发问题？我认为 `read-modify-write`对`beingProcessed`需求的操作必须是原子的，但我对其他策略持开放态度。也对其他代码改进开放。

[更新]：我想知道`TransactionScope`这里是否需要... [http://msdn.microsoft.com/en-US/library/system.transactions.transactionscope(v=vs.110).aspx](http://msdn.microsoft.com/en-US/library/system.transactions.transactionscope(v=vs.110).aspx)

代码：

```
public void WorkerRoleMain()
{
    while(true)
    {
        try
        {
            dbContext db = new dbContext();

            // Read
            foreach (UserProfile user in db.UserProfile
                    .Where(u => DateTime.UtcNow.Subtract(u.lastTimeProcessed) 
                            > TimeSpan.FromHours(24) & 
                            u.beingProcessed == false))
            {
                user.beingProcessed = true; // Modify
                db.SaveChanges();           // Write
                // Do some long drawn processing here
                ...
                ...
                ...
                user.lastTimeProcessed = DateTime.UtcNow;
                user.beingProcessed = false;
                db.SaveChanges();
            }
        }
        catch(Exception ex)
        {
            LogException(ex);
            Sleep(TimeSpan.FromMinutes(5));
        }
    } // while ()
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T00:19:26.227

我们通常做的是这样的：

在长操作开始时，我们开始一个事务：

```
BEGIN TRANSACTION 
```

然后我们使用这些提示从表中选择我们要更新/删除的行：

```
SELECT * FROM Table WITH (ROWLOCK, NOWAIT) Where ID = 123; 
```

然后我们检查我们是否有该行。如果该行被另一个进程锁定，则会出现 SQL 错误。在这种情况下，我们回滚事务并通知用户。如果记录被锁定，我们处理记录，并使用我们用来锁定记录的相同事务对象进行所需的更新：

```
UPDATE Table SET Col1='value' WHERE ID = 123; 
```

然后我们提交事务。

```
COMMIT; 
```

这只是该过程的伪代码。你必须在你的程序中实现它。

关于上述过程的一点小提示。在 SQL Server（或 Azure）中锁定记录时，请在 WHERE 子句中使用主键，否则 SQL Server 将决定使用页锁或表锁

# javascript - extjs4 在按钮单击而不是鼠标悬停时显示工具提示

> ID：13850184
> 
> 赞同：4
> 
> 时间：2012-12-12T23:01:56.273
> 
> 标签：javascript, extjs, tooltip, extjs4.1

我正在尝试在下面的工具提示中添加一个点击监听器。我不希望在鼠标悬停时显示工具提示。相反，它需要在按钮单击时显示。我必须在侦听器中添加处理函数吗？

```
{
                    xtype: 'button',
                    cls:'my-btn',
                    iconCls:'question',                     
                    src:'../www/css/slate/btn/question.png',
                    padding: '5 0 0 0',

                    listeners: {

                        render: function(cmp) {
                            Ext.create('Ext.tip.ToolTip', {
                                closable:true,
                                hideDelay : 3000,
                                padding: '0 0 0 0',
                                maxWidth:400,
                                width:800,

                                target: cmp.el,
                                html: "<b>read-only</b>:Users will have read only access to all pages",
                                getTargetXY: function() {
                                    return [810, 340];
                                }
                            });
                        }

                    }

                }, 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-12T23:24:50.300

是的，`click`您可以以编程方式显示工具提示，跳过`target`并添加`showAt()`：

```
...

listeners: {
    click: function(cmp) {
        Ext.create('Ext.tip.ToolTip', {
            closable:true,
            hideDelay : 3000,
            padding: '0 0 0 0',
            maxWidth:400,
            width:800,
            html: "<b>read-only</b>:Users will have read only access to all pages",
        }).showAt([810, 340]);

    }
} 
```

如果您不需要自动隐藏（您的工具提示无论如何都是可关闭的），您可以将其设为`Ext.tip.Tip`：

```
 Ext.create('Ext.tip.Tip', {
            closable:true,
            padding: '0 0 0 0',
            maxWidth:400,
            width:800,
            html: "<b>read-only</b>:Users will have read only access to all pages",
        }).showAt([810, 340]); 
```

# rest - 在模拟已获得 glasfish 服务器授权的用户时调用 REST 服务

> ID：13850186
> 
> 赞同：0
> 
> 时间：2012-12-12T23:02:14.833
> 
> 标签：rest, authentication, glassfish, client, impersonation

*   glassfish 服务器上部署了两个 Web 应用程序。
*   两个 Web 应用程序都提供 REST Web 服务。
*   通过 glassfish 安全约束（目前是 BASIC Auth 和 file-realm）来保护对这两个 Web 服务的访问。

假设用户正在访问 Web 应用程序 A 的服务。在他被授权后，服务 A 想通过 REST 客户端调用服务 B。

有没有办法让服务冒充已获得 glasfish 服务器授权的用户？也许像转发安全上下文或编辑标题之类的东西？有没有其他过滤器？

```
@Context
private SecurityContext securityContext;

username = securityContext.getUserPrincipal().getName();
password = ???    

client.addFilter(new com.sun.jersey.api.client.filter.HTTPBasicAuthFilter(username, password)); 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T10:33:55.563

这将取决于身份验证方案，但在某些情况下，您可以考虑提取服务 A 收到的授权标头并将其传递给服务 B。这将适用于基本身份验证。

您应该能够使用 @HeaderParam 来执行此操作，如以下代码段所示：

```
@GET
@Path("/resourceA")
public void doSomething(@HeaderParam("Authorization") String authorization) {
  // now I can call resourceB and use 'authorization'
} 
```

# php - 无法在 php 中开始新的 mongo()

> ID：13850187
> 
> 赞同：0
> 
> 时间：2012-12-12T23:02:52.870
> 
> 标签：php, mongodb

我是初学者尝试MongoDB。我安装了 Mongodb 并且 localhost:28017/ 正在工作。当我通过终端“/etc/init.d/mongodb start”启动服务时，它可以工作。

但我在 /var/www/ 中添加了 test.php 文件

```
<?php
$connection = new Mongo();
?> 
```

但我收到服务器错误“服务器错误网站在检索 localhost/test.php 时遇到错误。它可能因维护而关闭或配置不正确。”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T02:44:05.360

MongoDB 有两个部分：服务器部分和客户端部分。服务器部分完成所有实际工作，但您需要能够与之交谈。客户端库填补了这一空白。它们抽象了底层网络通信并向`new Mongo()`用户提供了一个很好的 API（例如，）。你已经让服务器运行了；那太棒了。但是，您还没有为 PHP 安装客户端库，因此 PHP 不知道如何处理`new Mongo()`.

# javascript - xui 是否支持 iOS Safari 设备的隐私浏览？

> ID：13850188
> 
> 赞同：2
> 
> 时间：2012-12-12T23:02:58.970
> 
> 标签：javascript, ios, private, xui

我有一个使用 xui.js 的网站

在 iPhone iOS5+ 上打开隐私浏览模式时，不会调用 xui.ready 函数。有解决办法吗？

```
<script>   
  alert('test');   
  xui.ready(function (e) {
    alert('test2');
  });
</script> 
```

没有私人模式，您会看到“test”和“test2”
在私人模式下，您只会看到“test”

当使用 safari 桌面浏览时，它可以在私人模式下正常工作，似乎只发生在 iOS 设备上，例如 iphone 和 ipods。

# mongodb - MongoDB：设置用户/密码以访问数据库

> ID：13850191
> 
> 赞同：13
> 
> 时间：2012-12-12T23:03:26.953
> 
> 标签：mongodb, authentication, passwords

我正在尝试为 mongodb 设置密码，以防止使用空登录名和 pass 访问数据库（默认设置）。

我正在使用 mongo 服务器：

```
sudo ./mongod 
```

启动客户端：

```
./mongo 
```

设置密码：

```
use admin
db.addUser("root", "root")
exit 
```

输出是：

```
MongoDB shell version: 2.2.0
connecting to: test
> use admin
switched to db admin
> db.addUser("root", "root")
{
    "user" : "root",
    "readOnly" : false,
    "pwd" : "2a8025f0885adad5a8ce0044070032b3",
    "_id" : ObjectId("50c90b94e28c41a388104f64")
}
> exit 
```

但是，当我尝试使用空凭据进行身份验证时（我使用 mViever 管理 UI），它仍然有效。否则，无法使用 root/root 访问。我做错了什么？

还尝试使用 -auth 参数启动 mongo 服务器，结果相同：

```
./mongod -auth 
```

UPD：使用 -auth 参数启动后，无法使用任何密码登录。得到：

```
Thu Dec 13 03:27:38 uncaught exception: error {
    "$err" : "unauthorized db:admin ns:admin.system.users lock type:1 client:127.0.0.1",
    "code" : 10057
} 
```

**更新：**我不知道发生了什么...

```
> db.auth("root","root");
1
> ^C
bye 
```

它可以登录。让我们重新启动`./mongod --auth`并`./mongo`：

```
MacBook-Pro-Ilya:bin ilyarusanen$ ./mongo
MongoDB shell version: 2.2.2
connecting to: test
> db.auth("root","root")
Error: { errmsg: "auth fails", ok: 0.0 }
0
> db.test.insert({"yeah":"2342"})
Fri Dec 14 08:52:05 uncaught exception: getlasterror failed: { "errmsg" : "need to login", "ok" : 0 }
> use admin
switched to db admin
> db.addUser("root","root")
Fri Dec 14 08:52:14 uncaught exception: error {
    "$err" : "unauthorized db:admin ns:admin.system.users lock type:1 client:127.0.0.1",
    "code" : 10057
}
> db.auth("root","root")
1 
```

为什么一开始可以登录？为什么重新启动mongo后无法登录？为什么在尝试添加用户失败后，它变得能够登录？谢谢。

**UPDATE2**：MongoHub 似乎验证正常。但是，从 NodeJS 我仍然无法登录：我使用这样的代码：

```
mongo_db.open(function(err,data){
  if(data){
    data.authenticate("root", "root",function(err2,data2){
         if(data2){
             console.log("Database opened");
         }
         else{
             console.log(err2);
         }
    });
  } else {
       console.log(err);
  }
}); 
```

我得到：

```
{ [MongoError: auth fails] name: 'MongoError', errmsg: 'auth fails', ok: 0 } 
```

但是要提一下，具有相同凭据的 MongoHub 可以正常工作。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-14T04:08:52.877

从您的评论中，您提到您正在使用 mViewer。mViewer 0.9.1 版不支持身份验证。根据mViewer GitHub 上的[这个问题，这个问题在 0.9.2 版本中得到了解决，该版本的目标是在 10 月发布。](https://github.com/Imaginea/mViewer/issues/75)

在使用身份验证启动节点之前，请登录到节点并添加用户。`--auth`然后使用mViewer 启动节点并连接到 shell。

此时您可以连接到管理员数据库并验证您的管理员用户：

```
use admin
db.auth('root', 'root') 
```

由于您设置了一个可以访问所有数据库的管理员用户，因此您需要针对 admin 数据库进行身份验证。完成此操作后，您将可以访问所有数据库。您还可以在任何数据库上创建新用户，或为所有数据库创建新的只读用户。

如果您创建一个只能访问一个数据库的新用户，该用户将需要`use`该数据库并`db.auth(name, pass)`针对它。

如果您创建一个对所有数据库具有只读访问权限的新用户，他们将`use admin`获得`db.auth(name, pass)`对所有数据库的只读访问权限

您可以在此处找到有关设置身份验证的更多信息，并[在](http://docs.mongodb.org/manual/tutorial/control-access-to-mongodb-with-authentication/)[此处](http://docs.mongodb.org/manual/tutorial/control-access-to-mongodb-with-authentication/)找到有关设置用户的更多信息

注意：当您启动节点*时没有* `--auth`启用任何身份验证。这意味着您可以与 shell 连接，`db.auth('root','root')`但就访问而言，它不会做任何事情。MongoDB 不会拒绝对没有`--auth`命令行选项的数据库的访问（`--keyFile`在分片设置或副本集中）

# android - 如何通过 ADB 锁定 Android 屏幕？

> ID：13850192
> 
> 赞同：53
> 
> 时间：2012-12-12T23:03:27.323
> 
> 标签：android, adb, screen-lock

有没有办法通过 ADB 锁定 Android 屏幕？

我找到了将显示锁定在 apk 中的方法，但我想通过 ADB 从 PC 锁定屏幕，以模拟显示超时，而无需等待超时。

是否有可能做到这一点？

谢谢，黛安

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2012-12-12T23:44:14.860

太棒了，我刚刚发现`KEYCODE_POWER`是26。

所以它通过发送来工作：

```
adb shell input keyevent 26 
```

如果屏幕解锁，它会锁定屏幕。如果屏幕已经锁定，它会唤醒设备。

我的猜测是，确保屏幕被锁定（关闭）的唯一方法是解锁（我们使用 keyevent 82（菜单），然后使用电源按钮 keyevent 锁定它。有人知道这是否属实吗？

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2014-07-20T14:58:47.717

Michael R. Hines 给出了可以说是最简单的解决方案。但是，以下行在更高版本的 Android 中没有用。

```
adb shell input keyevent 82 # unlock 
```

我已经使用我想要唤醒的单个设备（平板电脑）的坐标更新了 shell 脚本。我的平板电脑不支持锁屏事件的方向更改，因此这些值始终有效，因为锁屏始终处于横向状态。如果您需要方向变化检测，一个简单的 if/then/else 就足以选择正确的坐标用于方向。

```
#!/bin/bash
if [ "$(adb shell dumpsys power | grep mScreenOn= | grep -oE '(true|false)')" == false ] ; then
    echo "Screen is off. Turning on."
    adb shell input keyevent 26 # wakeup
    adb shell input touchscreen swipe 930 380 1080 380 # unlock
    echo "OK, should be on now."
else 
    echo "Screen is already on."
    echo "Turning off."
    adb shell input keyevent 26 # sleep
fi 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2014-06-07T05:00:37.683

这是一个 bash 脚本中的全部内容，它检查屏幕是否实际打开，然后唤醒*并*一次性解锁屏幕：

```
if [ "$(adb shell dumpsys power | grep mScreenOn= | grep -oE '(true|false)')" == false ] ; then
    echo "Screen is off. Turning on."
    adb shell input keyevent 26 # wakeup
    adb shell input keyevent 82 # unlock
    echo "OK, should be on now."
else 
    echo "Screen is already on."
fi 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-03-13T13:50:52.690

您已经找到了解决方案，但无论如何我都会将此代码放在这里以供参考。

您可以做的是注入事件以“按下”电源按钮两次。如果您不知道设备的状态（显示打开/关闭），请检查屏幕当前是打开还是关闭，然后相应地按下电源按钮。

这是一个简单的monkeyrunner脚本：

```
import re
from java.util import *
from com.android.monkeyrunner import MonkeyRunner, MonkeyDevice
device = MonkeyRunner.waitForConnection()       # connect to a device
device.shell("input keyevent KEYCODE_POWER")    # turn screen off (or on?)
res = device.shell("dumpsys power")             # fetch power state
m = re.search(r'.*mPowerState=([0-9]+).*', res) # parse the string
if m and int(m.group(1)) == 0:                  # screen is off
  device.shell("input keyevent KEYCODE_POWER")  # turn the screen on 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2016-11-26T02:24:19.480

除了之前的答案，这是我使用 adb 锁定/解锁屏幕的方法：

`adb shell input keyevent 26`将锁定屏幕。
因此，如果您再次执行该命令，当屏幕关闭/锁定时，它将被打开/解锁。
`adb shell input keyevent 26`还将解锁屏幕（如果屏幕已锁定）。

此外，我还测试了所有命令，例如`adb shell input keyevent number`, 并发现`adb shell input keyevent 3`也可以解锁设备。

我还发现（通过测试）键 3 是主页按钮。因此，如果您有一个物理主页按钮（不是屏幕上的软主页按钮），您也可以使用它来解锁您的设备。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-04-02T11:41:30.320

对于那些使用早期版本的 android *（至少 4.2+）*的人来说，`dumpsys power`有不同的输出。[我没有使用@Jakub Czaplicki](https://stackoverflow.com/a/15387248/1192479)给出的答案，
而是使用.`mPowerState=``mScreenOn=`

```
p = Runtime.getRuntime().exec("su", null, null);
OutputStream o = p.getOutputStream();
o.write(("dumpsys power").getBytes("ASCII"));
o.flush();
o.close();
p.waitFor();

boolean screenState;
BufferedReader in = new BufferedReader(new InputStreamReader(p.getInputStream()));
while ((res = in.readLine()) != null) dump += res;
screenState = dump.charAt( dump.indexOf("mScreenOn=") + 10 ) == 't'; 
```

`screenState`是`true` *（屏幕**开启**）*或`false` *（屏幕**关闭**）*。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-02-01T07:15:25.673

您可以使用以下命令触发显示开启。 **adb shell 输入 keyevent POWER**

我尝试并在我的项目中使用，希望它对你有用。

这是我使用的红宝石代码：

```
def ScreenCheck()
system("adb shell dumpsys power > c:/interact.log")

File.open("C:\\interact.log").each do |line|
    if line[/mScreenOn/]
        if line.strip == "mScreenOn=true"
            p "Screen is On, Starting execution.."
        else
            p "Screen is Off, starting screen.."
            system("adb shell input keyevent = POWER")
            p "Starting execution.."
        end
    end
end
end 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-06-24T21:58:51.027

这是一个脚本，用于为每个连接的设备（包括任何棒棒糖前设备）打开/关闭屏幕。在运行任何连接的 Android 测试之前，我在我的 Jenkins 服务器上使用它，以确保设备准备就绪。希望有人觉得这很有用！

```
#!/bin/sh

# Returns the power state of the screen 1 = on, 0 = off
getDisplayState() {
    state=$(adb -s $1 shell dumpsys power | grep mScreenOn= | grep -oE '(true|false)')

    # If we didn't get anything it might be a pre-lollipop device
    if [ "$state" = "" ]; then
        state=$(adb -s $1 shell dumpsys power | grep 'Display Power' | grep -oE '(ON|OFF)')
    fi

    if [ "$state" = "ON" ] || [ "$state" = "true" ]; then
        return 1;
    else
        return 0;
    fi
}

echo "Turning on screen on all connected devices..."

for device in `adb devices | grep device$ | cut -f1`
do
    echo -n "Found device: $device ... "

    getDisplayState $device
    state=$?

    # If the display is off, turn it on
    if [ $state -eq 0 ]; then
        echo "display was off, turning on"
        adb -s $device shell input keyevent 26
    else
        echo "display was on"
    fi

done 
```

# forms - 如何在共享点网页上嵌入贝宝捐赠按钮

> ID：13850198
> 
> 赞同：0
> 
> 时间：2012-12-12T23:03:49.137
> 
> 标签：forms, sharepoint-2010, paypal, web-parts

我正在尝试将捐赠按钮添加到共享点站点，但共享点站点已经有自己的表单。

贝宝捐赠按钮是从贝宝自动生成的代码，如下所示：

```
<form action="https://www.paypal.com/cgi-bin/webscr" method="post">...</form> 
```

当我将此代码添加到 sharepoint 中的 Web 部件时，表单标签被删除。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T23:11:32.210

[这份文件](http://office.microsoft.com/en-us/office365-sharepoint-online-enterprise-help/insert-a-paypal-button-in-a-public-facing-webpage-HA101848175.aspx)有帮助吗？当我做一些一般的谷歌搜索时，有很多关于 Sharepoint 和 PayPal 按钮的信息。不过，我自己并没有使用过 Sharepoint，所以很遗憾，我无能为力。

# jquery - Jquery - .val 并添加自定义属性值

> ID：13850200
> 
> 赞同：0
> 
> 时间：2012-12-12T23:03:55.697
> 
> 标签：jquery, attributes

在 Jquery 中，我可以像这样追加和添加 attr：为此：

```
 <li class="test" ln="7" > 
```

如何获得 r 的值：

```
$('#box input[name= _def]').val( JUNK) + "VALUE OF ln"; 
```

我可以获取在 val 之后附加的自定义属性 'ln' 的值吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-12T23:06:21.727

使用`data-`属性来保存您的数据：

```
<li class="test" data-ln="7" > 
```

您可以使用 jQuery 添加属性`.data()`：

```
$li.data('ln', 7); 
```

您可以使用`.data()`它来提取它（并自动转换常见的数据类型）：

```
var ln = $li.data('ln'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-12T23:06:46.957

最好将**HTML-5 数据属性**用于`validated HTML`..

这是`supported by all the browsers.`

```
<li class="test" data-ln="7" >

var val = $('li.test').data('ln'); 
```

对于这种情况，您可以使用`.data()`方法来提取值。

如果您仍想遵循**不推荐使用的相同语法，则**可以使用该`getAttribute`方法

```
 var val = document.getElementsByClassName('test').getAttribute('ln'); 
```

# asp.net-mvc - Simple Membership WebSecurity.CreateUserAndAccount 给出重复的 UserId 错误

> ID：13850203
> 
> 赞同：2
> 
> 时间：2012-12-12T23:04:20.500
> 
> 标签：asp.net-mvc, simplemembership

使用 MVC 4，Simplemembership

我正在构建一个供企业使用的 Web 应用程序，因此不希望开箱即用的 MVC 4 模板功能允许用户注册。相反，我想要一个只允许管理员访问然后创建用户的创建用户视图。我希望我可以更改注册控制器上的安全性，然后让当前登录的用户使用现有的注册视图创建用户......没有骰子。

这是控制器中的代码。我没有从模板中更改它：

```
// POST: /Account/Register

        [HttpPost]
        //[AllowAnonymous]
        [ValidateAntiForgeryToken]
        public ActionResult Register(RegisterModel model)
        {
            if (ModelState.IsValid)
            {
                // Attempt to register the user
                try
                {
                    WebSecurity.CreateUserAndAccount(
                        model.UserName,
                        model.Password,
                        new { FirstName = model.FirstName, LastName = model.LastName, Email = model.Email },
                        false
                    );
                    WebSecurity.Login(model.UserName, model.Password);
                    return RedirectToAction("Index", "Home");
                }
                catch (MembershipCreateUserException e)
                {
                    ModelState.AddModelError("", ErrorCodeToString(e.StatusCode));
                }
            }

            // If we got this far, something failed, redisplay form
            return View(model);
        } 
```

当当前登录的用户尝试通过此创建新用户时，您会收到错误消息（@ 第 86 行）：

```
The INSERT statement conflicted with the FOREIGN KEY constraint "FK_UserProfile_webpages_Membership". The conflict occurred in database "OTIS", table "dbo.webpages_Membership", column 'UserId'.
The statement has been terminated.

Line 84:                 try
Line 85:                 {
Line 86:                     WebSecurity.CreateUserAndAccount(
Line 87:                         model.UserName,
Line 88:                         model.Password, 
```

Hwre 是 UserProfile 类

```
[Table("UserProfile")]
    public class UserProfile
    {
        [Key]
        [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
        public int UserId { get; set; }

        [Required]
        [Display(Name = "User name")]
        public string UserName { get; set; }

        [Required]
        [Display(Name = "First Name")]
        public string FirstName { get; set; }

        [Required]
        [Display(Name = "Last Name")]
        public string LastName { get; set; }

        [Display(Name = "Email")]
        public string Email { get; set; }
    } 
```

WebSecurity.CurrentUserID 填充了当前登录的用户，我认为这是导致问题的原因。使用 simplemembership 提供程序实现此目的的正确方法是什么？

编辑：我尝试将其移回允许匿名用户注册，因此当我调试它时 WebSecurity.CurrentUserID 为-1，但我仍然遇到相同的错误。如果类中的 UserId 字段用属性​​ [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)] 修饰，如何生成重复键？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T08:06:14.573

我遇到了同样的问题，但我使用提供程序中的 CreateUserAndAccount 方法而不是 WebSecurity 解决了它。

```
var membership = (SimpleMembershipProvider)Membership.Provider;
membership.CreateUserAndAccount(
    model.UserName,
    model.Password,
    new Dictionary<string, object>{
        { "FirstName", model.FirstName}, 
        { "LastName", model.LastName},
        { "Email", model.Email }
    }
); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T19:29:21.267

Finally got back to this issue. The problem for me was that my database relationships were corrupted. The UserProfile table to Membership table foreign key constraints were set such that the UserId column was noted as the primary key in BOTH tables. As such, when it tried to add a row in UserProfile, it's newly generated ID did not exist in Membership, which caused the error. Simply deleting the relationship and recreating correctly such that UserProfile.UserId was the primary fixed it.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-16T02:23:45.743

This was all I needed to do. I wouldn't think there is anything wrong with UserProfile or Membership tables.

```
 WebSecurity.CreateUserAndAccount(model.UserName, model.Password,
                                  new { Email=model.Email}); 
```

# ruby - Ruby Mechanize - 无法获取特定的选择列表

> ID：13850204
> 
> 赞同：2
> 
> 时间：2012-12-12T23:04:27.833
> 
> 标签：ruby, forms, mechanize

我知道这适用于我尝试过的其他表单/选择列表。这个特定的似乎不是ajax。任何人都可以阐明这一点吗？

```
# encoding: UTF-8
require 'rubygems'
require 'mechanize'
require 'open-uri'

agent = Mechanize.new
page = agent.get('http://espn.go.com/nba/team/transactions/_/name/bos/boston-celtics')

form = page.form_with(:class => "js-goto")
fields = form.field_with(:class => "tablesm")

puts fields 
```

它应该返回类似`#<Mechanize::Form::SelectList:0x007ffdd3930138>`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-12T23:25:18.350

该选择列表没有 name 属性，这使得它无法用作表单字段。您仍然可以获得导航 nokogiri 样式所需的数据：

```
page.at('select.tablesm option[text()="2008"]')[:value]
#=> "http://espn.go.com/nba/team/transactions/_/name/bos/year/2008/boston-celtics" 
```

# ios - 解析 Facebook 对话框：andParams 导致登录屏幕

> ID：13850207
> 
> 赞同：1
> 
> 时间：2012-12-12T23:04:42.770
> 
> 标签：ios, facebook, parse-platform

我使用 Parse Facebook 实现已经有一段时间了，现在更新后出现了一些奇怪的行为。

我正在使用成功登录用户

```
NSArray *permissions = [NSArray arrayWithObjects:@"user_about_me",
                   @"user_relationships",@"user_birthday",@"user_location",
                   @"email", nil];

[PFFacebookUtils logInWithPermissions:permissions
                                    block:^(PFUser *user, NSError *error) {
                                            if (!user) {
                                                if (!error) { // The user cancelled the login
                                                    NSLog(@"Uh oh. The user cancelled the Facebook login.");
                                                } else { // An error occurred
                                                    NSLog(@"Uh oh. An error occurred: %@", error);
                                                }
                                            }
                                            else if (user.isNew) { // Success - a new user was created
                                                NSLog(@"Is New");
                                            }
                                            else { // Success - an existing user logged in
                                                NSLog(@"Existing");
                                            }
                                      }]; 
```

哪个工作正常。现在，当我想向我使用的用户显示帖子对话框时

```
NSMutableDictionary* params = [NSMutableDictionary dictionaryWithObjectsAndKeys:
                                       @"MY_APP_ID", @"app_id",
                                       caption, @"name",
                                       link, @"link",
                                       description, @"description",
                                       name, @"caption",
                                       picture, @"picture",
                                       nil];
[[PFFacebookUtils facebook] dialog:@"feed" andParams:params andDelegate:self]; 
```

即使用户已经登录并且正在使用配置了 facebook 设置的 ios6.0，它也会弹出 facebook 登录弹出窗口。

谁能帮我解释发生了什么，这样我就可以避免用户基本上必须多次登录才能发布？

# c# - 使用 WPF 和 EF CodeFirst 构建企业 CRUD 应用程序

> ID：13850209
> 
> 赞同：2
> 
> 时间：2012-12-12T23:05:06.583
> 
> 标签：c#, wpf, entity-framework, ef-code-first, prism

我正在构建一个 WPF CRUD 应用程序，大多数应用程序功能都以数据库操作为中心，我发现自己一遍又一遍地做同样的事情。定义一个带有输入字段的视图，然后选择视图模型，然后实现验证、异常处理、存储库等，但最令人生畏和浪费时间的操作是构建用户界面及其视图模型。对于加快此类应用程序、任何建议的工具、框架、控件等的开发，您的最佳建议或经验是什么？！
**注意：**我喜欢域驱动开发和代码优先方法的想法，所以我喜欢解决这些问题的解决方案，我的主要兴趣是桌面 WPF 应用程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-27T10:48:37.180

使用 Scaffolding 或 LightSwitch 时，您将很快遇到严重的限制和死胡同。从长远来看，使用 MVVM 构建一个组织良好的 WPF 应用程序可能会更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T02:35:22.690

您可能对[脚手架](http://en.wikipedia.org/wiki/Scaffold_%28programming%29)感兴趣。

这是关于[WPF 脚手架](http://www.codeproject.com/Articles/36975/WPF-CRUD-Generator-Scaffolding)的教程。

# asp.net - 如何防止外部文档文件被复制到 ASP.NET 应用程序中的 bin 文件夹

> ID：13850211
> 
> 赞同：1
> 
> 时间：2012-12-12T23:05:08.693
> 
> 标签：asp.net, visual-studio-2008, publish, web-application-project

我（仍在）使用 Visual Studio 2008。我有一个 ASP.NET Web 应用程序，其中一些文件位于我的项目根级别的文件夹中，称为“资源”。该文件夹包括 jQuery 包含等，以及作为应用程序用户文档的 PDF 文件。目录结构如下所示：

```
Project
  |__ Properties
  |__ References
  |__ (etc.)
  |__ bin
  |__ (etc.)
  |__ resources
        |__ (etc.)
        |__ docs
              |__ DocumentationFile.pdf 
```

我遇到的问题是在我发布应用程序时`resources/docs/`正在创建（空文件夹） 。`/bin`该文件夹及其内容也被复制到根级别的适当位置，因此一切正常。

但是我的强迫症倾向迫使我试图弄清楚为什么我要在`/bin`. 谁能解释这种现象？

我`DocumentationFile.pdf`在解决方案资源管理器中的“属性”下将该文件标记为“内容”，在我这样做之前它根本没有被复制。而且我曾经将“复制到输出目录”属性设置为“如果较新则复制”，但发现似乎没有必要，所以我将其改回“不复制”（虽然我不知道如果我更新文档会发生什么，新版本会发布吗？）

感谢您提供的任何见解。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T23:11:36.733

我只是想通了-该`bin/resources/docs`文件夹是一个剩余的空文件夹，它弄乱了我的项目目录，当我将文档文件上的“复制到输出目录”属性设置为“如果更新则复制”时留下的。

# java - 休眠多个模式映射

> ID：13850213
> 
> 赞同：1
> 
> 时间：2012-12-12T23:05:13.507
> 
> 标签：java, hibernate, jpa, mapping, ejb

我有一个 Hibernate 项目和多个实体。每个实体都需要连接几个数据库。(table1, table2, table3, table4) 相同的模式。

这可以实现吗？还是我需要为每个实体创建一个单独的实体？

我的实体看起来像这样

```
@Entity
public class table1{
     @Id
     @Column(name="name")
     private String name;

     @Column(name="age")
     private String age;

     //getters setters
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T06:58:25.103

您可以将相同的实体用于具有相似架构的不同数据库，但必须创建`EntityManager`指向特定数据库的指向。

*   为每个数据库创建持久性单元。

下面是 persistence.xml 的示例代码

```
<persistence-unit name="DB_X"> 
<jta-data-source>java:/OracleDS</jta-data-source>  
... 
</persistence-unit>
<!-- Other Persistence Units --> 
```

为特定单元创建 EntityManager

```
@PersistenceContext(unitName="DB_X")
private EntityManager xEM;

@PersistenceContext(unitName="DB_Y")
private EntityManager yEM; 
```

*   否则，也可以在运行时创建它，如下所示。

> EntityManagerFactory emf = Persistence.createEntityManagerFactory(persistenceUnitName); EntityManager em = emf.createEntityManager();

之后，您可以使用具有相似架构的不同数据库的相同实体，具有适当的表结构`EntityManager`。

* * *

**编辑**：根据您的评论，这与您发布的问题不同，您似乎正在尝试对多个表使用相同的实体。下面是它的示例代码。

```
@MappedSuperClass
public class abstract BaseEntity {
     @Id
     @Column(name="name")
     private String name;

     @Column(name="age")
     private String age;

     //-- accessor methods
}

@Entity
@Table(name = "XTable")
public class XEntity extends BaseEntity {
    public XEntity(){}
}

@Entity
@Table(name = "YTable")
public class YEntity extends BaseEntity {

    public YEntity(){}
} 
```

在这里，`XEntity`&`YEntity`是相似的，但指向它们各自的表。

# c++ - 原型设计

> ID：13850214
> 
> 赞同：1
> 
> 时间：2012-12-12T23:05:16.500
> 
> 标签：c++, protocol-buffers

我有一条消息 Image ，其中包含很多东西，还有一条消息 ImageSet ，它存储了多个图像。

```
message Image {
    ...
}
message ImageSet {
    repeated Image images = 1;
} 
```

我也有多个 ImageSet，因为我不想将所有内容都保存在一个文件中。我遇到的问题是每个 ImageSet 都变得非常大，因此我收到警告/错误。有没有更好的设计方法？

请注意，我像这样解析文件。

```
ImageSet image_set;
image_set.ParseFromIstream(stream); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T05:46:51.273

您不必使用 protobuf-messages 来发送您的图像数据对象。你可以设计这样的东西来描述图像：

```
message Image {
    required int64 bytes_size = 1;
}

message ImageSet {
    repeated Image images = 1;
} 
```

指定您发送的每个图像数据的计数和大小。不仅仅是通过套接字在您的消息之后发送图像日期并以相同的顺序在另一侧阅读。

在发件人方面：

```
socket.write(protobuf_message_size); // for example 8 bytes    
socket.write(protobuf_message);
socket.write(binary_images_data); 
```

# php - 使用 PHP 时出现 FancyBox 错误。有任何想法吗？

> ID：13850218
> 
> 赞同：0
> 
> 时间：2012-12-12T23:05:45.957
> 
> 标签：php, jquery, css, fancybox

只是要分享我的代码，看看是否有人能发现导致这种情况的原因。

错误显示：“无法加载请求的内容。请稍后再试。”

**ShowAll.PHP：**

```
 <?
include_once "db.php";
session_start();
$gid=$_SESSION['gid'];
$result = mysql_query("SELECT id,groupid FROM images where gid='".$gid."' and imagetype='1' ORDER BY id");
print(" <div id='wrapper'>  
        <!--start: Container -->
        <div class='container'>
        ");
        $j=0;
        print("     
        <div class='row'>
            <div class='span6'>
                <h1>My Gallery</h1>
                <br>
            </div>
            <div class='span6'>
            </div>
        </div>
        <!--start: Row -->
        <div class='row'>");
        while($row = mysql_fetch_array($result)){
            if ($j==6){
                $j=0;
                print("</div>");
                        print("         
                <!--start: Row -->
                <div class='row'>");
                print("<div class='span2'>");
                print("<p><div class='picture'><a rel='image' href='largeimage.php?groupid=".$row['groupid']."'><img src='showimage.php?id=".$row['id']."'><div class='image-overlay-zoom'></div></a></div>");
                print("</div>");
                $j++;
            }else{
                print("<div class='span2'>");
                print("<p><div class='picture'><a rel='image' href='largeimage.php?groupid=".$row['groupid']."'><img src='showimage.php?id=".$row['id']."'><div class='image-overlay-zoom'></div></a></div>");
                print("</div>");
                $j++;
            }
        }
print("</div>");?> 
```

**大图.php：**

```
<?php

$groupid=$_GET['groupid'];

print("             <img src='showimagelarge.php?groupid=".$groupid."'>");

?> 
```

**showimagelarge.php：**

```
include_once "db.php";

session_start();

$gid=$_SESSION['gid'];

header('Content-type: image/jpeg');

$query = "SELECT image from images where groupid=". intval($_GET["groupid"])." and gid='".$gid."' and imagetype='2'";

$rs = mysql_fetch_array(mysql_query($query));

echo base64_decode($rs["image"]);

?> 
```

**显示图像.php：**

```
include_once "db.php";

session_start();

$gid=$_SESSION['gid'];

header('Content-type: image/jpeg');

$query = "SELECT image from images where id=". intval($_GET["id"])." and gid='".$gid."'";

$rs = mysql_fetch_array(mysql_query($query));

echo base64_decode($rs["image"]);

?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T00:20:36.490

您正在以这种方式呈现图像的链接：

```
<div class='picture'><a rel='image' href='largeimage.php?groupid=".$row['groupid']."'>.... 
```

...因此您的链接`href`将没有任何图像扩展名（jpg、png、gif）。因为那个fancybox不知道`type`要处理什么内容，所以消息

```
The requested content cannot be loaded. Please try again later. 
```

您需要强制将`type`内容添加到`image`您的 fancybox 自定义脚本中。此处记录了[http://fancyapps.com/fancybox/#support](http://fancyapps.com/fancybox/#support)，FAQ 标签号 5

您可以执行以下任一操作：

```
<script type="text/javascript">
  $(document).ready(function(){
    $(".picture a").fancybox({
      "type": "image"
    });
  });
</script> 
```

... 或者

```
<script type="text/javascript">
  $(document).ready(function(){
    $('a[rel="image"]').fancybox({
      "type": "image"
    });
  });
</script> 
```

# android - 执行活动而不在屏幕上显示布局

> ID：13850219
> 
> 赞同：3
> 
> 时间：2012-12-12T23:06:06.860
> 
> 标签：android, android-activity

我不仅搜索了 stackoverflow，还搜索了其他网站，但我找不到问题的答案。我现在开始学习Android，我对活动有疑问。

我有一个 MainActivity，它创建一个带有两个按钮的通知。一个现在没用了，另一个（发送按钮）将打开一个带有 EditText 的警报和一个将文本发送到另一个应用程序的按钮。

这是代码：

```
Intent mainActivityIntent = new Intent(MainActivity.this, NotificationActivity.class);
            Intent shareActivityIntent = new Intent(MainActivity.this, ShareActivity.class);
            PendingIntent mainActivityPIntent = PendingIntent.getActivity(MainActivity.this, 0, mainActivityIntent, 0);
            PendingIntent shareActivityPIntent = PendingIntent.getActivity(MainActivity.this, 0, shareActivityIntent, 0);

            Notification n = new Notification.InboxStyle 
                    (new Notification.Builder(MainActivity.this)
                    .setContentTitle(getString(R.string.text_notification))
                    .setContentText(getString(R.string.text_notification))
                    .setSmallIcon(R.drawable.ic_launcher)
                    .setContentIntent(mainActivityPIntent)
                    .addAction(R.drawable.logo, "Botão", mainActivityPIntent)
                    .addAction(R.drawable.ic_launcher, "Share", shareActivityPIntent)
                            )
                    .build();

            n.flags |= Notification.FLAG_ONGOING_EVENT;

            NotificationManager nm = (NotificationManager) getSystemService(NOTIFICATION_SERVICE);
            nm.notify(0, n); 
```

如您所见，发送按钮将打开另一个 Activity，其代码如下：

```
AlertDialog.Builder alert = new AlertDialog.Builder(this);

    alert.setTitle("Mensagem");
    alert.setMessage("Digite a mensagem");

    final EditText input = new EditText(this);
    alert.setView(input);

    alert.setPositiveButton("Enviar", new DialogInterface.OnClickListener() {
    public void onClick(DialogInterface dialog, int whichButton) {
      String value = input.getText().toString();
      Intent i = new Intent(Intent.ACTION_SEND);
        i.setType("text/plain");
        i.putExtra(Intent.EXTRA_TEXT, value);
        startActivity(Intent.createChooser(i, "Enviar"));
        finishActivity(0);
      }
    });

    alert.setNegativeButton("Cancel", new DialogInterface.OnClickListener() {
      public void onClick(DialogInterface dialog, int whichButton) {
        return;
      }
    });

    alert.show(); 
```

此活动负责打开警报，用户将在其中输入文本并发送到另一个应用程序。

情况是，当我调用活动时，它不仅会显示警报，还会打开一个新的“屏幕”。示例：通知是持久的，因此它将始终显示在通知抽屉上。如果我在另一个应用程序上并单击通知上的按钮，我只想打开警报，但现在它正在打开警报和带有我活动布局的屏幕。

有没有办法只显示警报而不显示活动？还是我必须使用另一种方法来做到这一点？

非常感谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T23:22:54.633

如果没有绝对需要警报对话框，您可以使警报成为自己的活动，而只是不使用警报构建器。随意放置按钮和文本视图或任何您需要的东西。然后在清单中使用

`<activity android:theme="@android:style/Theme.Dialog">`

**[这里](http://developer.android.com/guide/topics/ui/themes.html)**有更多关于主题的信息。希望这可以帮助

# language-agnostic - 复杂的multi-quines是如何写的？

> ID：13850221
> 
> 赞同：3
> 
> 时间：2012-12-12T23:06:10.357
> 
> 标签：language-agnostic, quine

我将 multi-quine 定义为：

> 一组*n种不同编程语言的程序，**使得*每个程序在没有输入时输出其确切的源代码，当给定*n*作为输入时，输出第 *n*th 程序的源代码。

不要与循环程序序列混淆，其中每个程序输出下一个程序的源代码，直到第一个程序输出。在这种情况下，每个程序都不是一个 quine，这就违背了这一点。这些循环集虽然对于*n*的高值来说是有趣的脑筋急转弯，但实现起来非常简单。

在这种情况下，复数表示“对于大于*或等于*2的*n值”。*我相信在这种情况下，解决方案足够复杂。*但是，目标是所有n*值的通用解决方案（阅读：策略）。*`n = 2`*

 **我了解“简单”的 quines 是如何编写的，但是我似乎无法理解复杂的 multiquines，这让我着迷。我的一部分希望除了程序员头脑中的聪明才智之外没有其他解决方案——尽管我认为这不太可能。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-14T00:33:58.180

quines、多语言 quines、multi-quines 没有什么特别之处，随你便便。它们几乎都可以自动编写。

例如，这是一个沼泽标准、冗长、不优雅、低效的 C++ quine。然而，尽管它有所有缺点，但很容易修改以做我们想要的。

```
#include <iostream>
#include <string>
#include <cstdlib>

std::string show (const std::string& in) {
    std::string res = "\"";
    for (std::string::const_iterator it = in.begin(); it < in.end(); ++it) {
        switch (*it) {
            case '"':
            case '\\':
                res += '\\';
            default:
                res += *it;
        }
    }
    res += "\"";
    return res;
}

int main (int argc, char* argv[])
{
    std::string arr[] = { // beginning ends here
"#include <iostream>",
"#include <string>",
"#include <cstdlib>",
"",
"std::string show (const std::string& in) {",
"    std::string res = \"\\\"\";",
"    for (std::string::const_iterator it = in.begin(); it < in.end(); ++it) {",
"        switch (*it) {",
"            case '\"':",
"            case '\\\\':",
"                res += '\\\\';",
"            default:",
"                res += *it;",
"        }",
"    }",
"    res += \"\\\"\";",
"    return res;",
"}",
"",
"int main (int argc, char* argv[])",
"{",
"    std::string arr[] = { // beginning ends here",
"======",
"    };",
"    int n = argc == 1 ? 0 : std::atoi(argv[1]);",
"    if (n == 0) {",
"        int i, j;",
"        for (i = 0; arr[i] != \"======\"; ++i) std::cout << arr[i] << std::endl;",
"        for (j = 0; j < sizeof(arr)/sizeof(arr[0]); ++j) std::cout << show(arr[j]) << ',' << std::endl;",
"        for (++i; i < sizeof(arr)/sizeof(arr[0]); ++i) std::cout << arr[i] << std::endl;",
"    } else {",
"    }",
"}",
    };
    int n = argc == 1 ? 0 : std::atoi(argv[1]);
    if (n == 0) {
        int i, j;
        for (i = 0; arr[i] != "======"; ++i) std::cout << arr[i] << std::endl;
        for (j = 0; j < sizeof(arr)/sizeof(arr[0]); ++j) std::cout << show(arr[j]) << ',' << std::endl;
        for (++i; i < sizeof(arr)/sizeof(arr[0]); ++i) std::cout << arr[i] << std::endl;
    } else {
    }
} 
```

如您所见，程序的核心是一个名为 的小函数`show`，它接受一个字符串并将其表示形式作为 C++ 文字返回。整体结构如下：打印字符串数组的开始部分；打印通过管道传输的整个数组`show`；打印数组的末尾部分。字符串数组是程序的副本，插入到程序的中间。初始部分与最后部分由一个特殊的`"====="`字符串分隔，该字符串不是从程序中复制的（它只打印一次，通过`show`）。

很容易插入任何额外的动作，比如用不同的语言打印另一个 quine。我为此类操作插入了一个占位符。

现在将它翻译成任何编程语言（例如 FORTRAN）是绝对简单的。假设我们已经完成了它，它由 L1、L2、...、LN 行组成。我们在占位符中插入这些语句：

```
std::cout << "L1" << std::endl;
std::cout << "L2" << std::endl;
...
std::cout << "LN" << std::endl; 
```

我们相应地修改字符串数组。瞧，我们有一个可以打印自己的 quine，在 FORTRAN 中也有一个 quine，这取决于命令行参数。

好的，FORTRAN quine 怎么样？它只能打印自己，不能打印 C++ quine。没问题，让我们将 C++ quine 复制回 FORTRAN quine。

但是 C++ quine 已经包含了整个 FORTRAN quine，*两次*？

没问题，因为*FORTRAN quine 已经可以自己打印了*。因此，我们只需将原始 C++ 行复制回 FORTRAN。无需再次（或两次）在其内部复制 FORTRAN。

我们只需要稍微修改 FORTRAN。当我们要求 FORTRAN quine 打印 C++ quine 时，它​​应该打印所有 C++ 行*以及*所有 FORTRAN 行，*两次*：一次 as`Li`和一次 as `std::cout << "Li" << std::endl;`，就像 C++ quine 一样。然后我们得到 C++ quine（包括 FORTRAN quine）。

我们还需要将这些 FORTRAN 修改带回 C++（即修改`std::cout << "Li" << std::endl;`行）。修改的浪潮到此为止。

就是这样，我们有两个程序可以打印自身或相互打印，具体取决于命令行参数。

我鼓励你真正做到这一切。**

# c# - WPF 工具包图表：如何将值标签添加到特定数据点

> ID：13850225
> 
> 赞同：2
> 
> 时间：2012-12-12T23:06:20.437
> 
> 标签：c#, wpf, windows-phone-7, charts, datapoint

是否有可能将标签添加到 WPF 工具包图表中的特定数据点？该标签应该只显示数据点的值。这在 iOS（核心情节）和 Android 上很容易实现，但我无法让它在 Windows Phone 上工作。鉴于似乎没有 WPF 工具包/图表的文档这一事实并没有让它变得容易得多。

**这就是数据点标签在 iOS 上的样子（5.1%、18.3%）** ![这就是数据点标签在 iOS 上的样子（5.1%、18.3%）](../Images/36c1df9939b4fa4295db15bc6acc4b12.png)

基本上，***对于 Windows Phone 上的 x 值 12 和 60，我需要与现在在 iOS 上相同的数据点标签。***

**这些数据点在此屏幕截图中显示为绿点（WP 7.1）：** ![这些数据点在此屏幕截图中显示为绿点（WP 7.1）](../Images/f06a0b15f250e02d87aa4aad11538209.png)

任何帮助将不胜感激。非常感谢您提前。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T19:58:39.423

最后我找到了实现显示点标签的类的时间。

这是我在博客中的帖子，我更详细地描述了这个类：[Silverlight and WP7 chart with data point labels](http://vortexwolf.wordpress.com/2013/01/01/silverlight-and-wp7-chart-with-data-point-labels/)

WP7 示例适用于我自己重新编译的图表库，因此它可能不适用于您的。[您可以在此处](https://dl.dropbox.com/u/8047386/WordPress/ChartPointLabelsSample.zip)下载示例工作应用程序。

![带有数据点标签的 WP7 图表](../Images/3a16008b564c3c33a60889601cbc80b5.png)

# python - 如何从main调用类中的函数

> ID：13850230
> 
> 赞同：0
> 
> 时间：2012-12-12T23:06:54.117
> 
> 标签：python

我正在尝试从 main 调用类中定义的函数。我该怎么做？

```
class file_process:
    def findb(self, id):
    ....  

def main():
  id = sys.argv[2]
 file_process.findb(id)//how to call findb function from main,this is giving an error 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-12T23:08:18.763

由于`finddb`是一种*方法，因此您需要在以下**实例*上调用它`file_process`：

```
file_process().finddb(id) 
```

我强烈建议您学习 Python 和课程，我可以推荐[Python 教程](http://docs.python.org/2/tutorial/)，然后再继续。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-12T23:08:25.000

您需要先创建一个类的实例：

```
process = file_process()
process.findb(id) 
```

# ajax - Grails Spring 安全插件 AJAX 身份验证

> ID：13850234
> 
> 赞同：1
> 
> 时间：2012-12-12T23:07:29.947
> 
> 标签：ajax, grails, curl, spring-security

我一直在寻找这个问题的答案。我希望能够使用将验证身份验证的 spring 安全核心插件在 Grails 应用程序中发送 JSON 数据。我似乎无法让它工作。

我正在尝试使用 cURL 和以下命令对此进行测试：

```
curl -v -H "Content-Type: application/json" -X POST --data @ajax_login.json http://localhost:8080/j_spring_security_check?ajax=true 
```

我的 ajax_login.json 看起来像这样：

```
{
    "j_username":"user@email.com",
    "j_password":"password"
} 
```

我的回复如下所示：

```
* About to connect() to localhost port 8080 (#0)
*   Trying 127.0.0.1... connected
* Connected to localhost (127.0.0.1) port 8080 (#0)
> POST /j_spring_security_check?ajax=true HTTP/1.1
> User-Agent: curl/7.21.4 (universal-apple-darwin11.0) libcurl/7.21.4 OpenSSL/0.9.8r zlib/1.2.5
> Host: localhost:8080
> Accept: */*
> Content-Type: application/json
> Content-Length: 63
> 
< HTTP/1.1 302 Moved Temporarily
< Server: Apache-Coyote/1.1
< Set-Cookie: JSESSIONID=974763464D383CD90962E8933DBB8335; Path=/
< Set-Cookie: grails_remember_me=""; Expires=Thu, 01-Jan-1970 00:00:10 GMT; Path=/
< Location: http://localhost:8080/login/authfail;jsessionid=974763464D383CD90962E8933DBB8335?ajax=true
< Content-Length: 0
< Date: Wed, 12 Dec 2012 22:53:27 GMT
< 
* Connection #0 to host localhost left intact
* Closing connection #0 
```

我希望根据 LoginController 的 ajaxSuccess 操作看到类似的内容：

```
{
    "success":true,
    "username":"user@email.com"
} 
```

或者至少每个 LoginController 的 ajaxfail 操作的失败 JSON：

```
{
    "error":"#yourdoingitwrong"
} 
```

仅供参考，我的 config.groovy 有这个：

```
grails.plugins.springsecurity.interceptUrlMap = [
  '/css/**':    ['IS_AUTHENTICATED_ANONYMOUSLY'],
  '/common.css':  ['IS_AUTHENTICATED_ANONYMOUSLY'],
  '/favicon.ico': ['IS_AUTHENTICATED_ANONYMOUSLY'],
  '/images/**': ['IS_AUTHENTICATED_ANONYMOUSLY'],
  '/js/**':   ['IS_AUTHENTICATED_ANONYMOUSLY'],
  '/login/**':  ['IS_AUTHENTICATED_ANONYMOUSLY'],
  '/logout/**': ['IS_AUTHENTICATED_ANONYMOUSLY'],
  '/register/**': ['IS_AUTHENTICATED_ANONYMOUSLY'],
  '/error/**':  ['IS_AUTHENTICATED_ANONYMOUSLY'],
  '/**':      ['IS_AUTHENTICATED_REMEMBERED']
] 
```

我已经将 GormUserDetailsS​​ervice 子类化并重写了 loadUserByUsername 来进行自己的查找，但是传入的用户名是空白的……空字符串。我知道这一点，因为我能够在该方法中设置断点，并且当我发送我的 cURL 命令时，执行确实会在那里结束。

我还缺少其他任何细节吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T04:48:33.327

我仍然想知道如何根据请求发出 cURL 命令，但我能够通过 jQuery.ajax 成功通信：

```
<html>
<head>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script type="text/javascript">
    $(function() {
        $('#btnPush').on('click', function() {
            $.ajax({
                url: 'http://localhost:8080/j_spring_security_check',
                type: 'POST',
                data: {
                    j_username: 'user@email.com',
                    j_password: 'password'
                },
                success: function(data, textStatus, jqXHR) {
                    alert('Success!!!');
                },
                error: function(jqXHR, textStatus, errorThrown) {
                    alert('Fail!');
                }
            });
        });
    });
    </script>
</head>
<body>
<button id='btnPush'>Push Me!</button>
</body>
</html> 
```

这个 HTML 文件必须包含在我的 Grails 应用程序 web-app 文件夹中。我猜这不是跨域请求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T06:23:58.673

将参数 -L 添加到 curl 命令应该会有所帮助

在您的服务器响应中包含以下部分：

```
HTTP/1.1 302 Moved Temporarily 
Location: http://localhost:8080/login/authfail;jsessionid=974763464D383CD90962E8933DBB8335?ajax=true 
```

tells curl/browser that the requested page has moved to new location (*login/authfail*). This way server redirects client to new URL. **Web browser** would immediately issue request to the new location, but default behavior of **curl** is not to follow redirects automaticaly.

Parameter **-L/--location** instructs curl to follow redirects. See **man curl** for more details.

# scala - scala fsc ant 任务在 scala v2.9.1-1 中根本不起作用吗？

> ID：13850238
> 
> 赞同：0
> 
> 时间：2012-12-12T23:07:34.340
> 
> 标签：scala, ant, fsc

我看过这个页面[https://issues.scala-lang.org/browse/SI-5196](https://issues.scala-lang.org/browse/SI-5196)。看起来它已在 v2.10.x 中修复。有没有人让 fsc ant 任务在 scala v2.9.1-1 中工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-12T23:16:26.387

我建议你升级到2.10。我认为没有解决方法。

# macos - 如何在文件 > 新建/Cmd+N 上显示应用程序模式的“新建文档”窗口？

> ID：13850239
> 
> 赞同：1
> 
> 时间：2012-12-12T23:07:36.893
> 
> 标签：macos, cocoa, nsdocument

当用户选择“文件”>“新建”或按 Cmd+N 时，是否有推荐/常用的方式来显示应用程序模式的“新建文档”窗口？

我说的是一个窗口，用户可以在其中设置初始文档属性，例如页面尺寸。应该有 OK 和 Cancel 按钮，这意味着关闭 New Document 窗口不一定会导致创建实际的文档窗口。

顺便说一句，我的应用程序是`NSDocument`基于 - 的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T05:17:15.883

你问的很简单。为新文档对话框创建一个窗口和窗口控制器。让您的应用委托在启动时或按需实例化它们。将 Cmd-N 设置为 File > New 项的等效键，并将其连接到应用程序委托中的操作，该操作为该窗口设置并运行模式会话 ( `[NSApp runModalForWindow:wc.window]`)。

窗口控制器应该结束或取消模态会话，决定是否创建文档（可能使用`[-NSDocumentController openUntitledDocumentAndDisplay:error:]`），并设置您需要设置的属性。

也就是说，我敦促您不要将其设为应用程序模式。打开一个新的文档窗口并显示一个文档模式表，该表要求并设置这些尺寸。没有理由阻止用户做任何他/她可能正在做的事情来回答这些问题。

# python - PyQt - 如何检查 QDialog 是否可见？

> ID：13850240
> 
> 赞同：2
> 
> 时间：2012-12-12T23:07:37.763
> 
> 标签：python, graphics, pyqt, qdialog

我有个问题。我有这个代码：

```
balls = [Ball() for i in range(1, 10)] 
```

所以，当我说 Ball() 时，这将在 QDialog 上绘制一个球。然后当这完成后，我`QDialog`在一个无限循环中移动球。我想说一些话，比如*让`QDialog.isVisible()`他们四处走动*。

我没有任何父对话框或表单或任何子对话框或表单。就是这样`QDialog`。我知道这样做很愚蠢`QDialog`，但我不允许使用任何其他东西`QDialog`。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-12T23:55:20.503

您可以使用 QWidget 中的 isVisible，因为 QDialog 基本上继承了 QWidget。所以你应该能够检查可见性。

```
myDialog = QtGui.QDialog()
isVis = myDialog.isVisible() 
```

更多详情[http://www.riverbankcomputing.co.uk/static/Docs/PyQt4/html/qwidget.html#isV​​isible](http://www.riverbankcomputing.co.uk/static/Docs/PyQt4/html/qwidget.html#isVisible)

# javascript - jQuery ReplaceWith 添加克隆节点的两个副本

> ID：13850241
> 
> 赞同：2
> 
> 时间：2012-12-12T23:07:48.377
> 
> 标签：javascript, jquery, html

**我正在使用 jquery 1.7.2**

我有一个 jQuery 对象`copyItem`，其中内容的子集包含以下 html

```
<tr>            
    <td class="command" style="" colspan="3">
        <input type="button" class="insertCommand" value="Add">
    </td>        
</tr> 
```

不太复杂。

我也有一些模板 html...

```
<table id="itemCommandTemplate">
    <tr>
        <td class="command" style="" colspan="3"><input type="button" class="editCommand" value="Edit"/>&nbsp;&nbsp;<a href="javascript:void(0);" class="deleteCommand">delete</a></td>
        <td class="command" style="display: none" colspan="3"><input type="button" class="saveCommand" value="Save"/>&nbsp;&nbsp;<a href="javascript:void(0);" class="cancelCommand">cancel</a></td>
    </tr>
</table> 
```

...我正在使用以下 jQuery 进行克隆

```
var command = $('#itemCommandTemplate tr').clone(true, true); 
```

如果我写出命令的html，一切都会按顺序出现。

然后我尝试使用这个克隆副本替换 copyItem 中的原始 html

```
copyItem.find('.command').parent('tr').replaceWith(command); 
```

在这个电话之后，结果是两个副本

```
<tr>
    <td class="command" style="" colspan="3"><input type="button" class="editCommand" value="Edit"/>&nbsp;&nbsp;<a href="javascript:void(0);" class="deleteCommand">delete</a></td>
    <td class="command" style="display: none" colspan="3"><input type="button" class="saveCommand" value="Save"/>&nbsp;&nbsp;<a href="javascript:void(0);" class="cancelCommand">cancel</a></td>
    <td class="command" style="" colspan="3"><input type="button" class="editCommand" value="Edit"/>&nbsp;&nbsp;<a href="javascript:void(0);" class="deleteCommand">delete</a></td>
    <td class="command" style="display: none" colspan="3"><input type="button" class="saveCommand" value="Save"/>&nbsp;&nbsp;<a href="javascript:void(0);" class="cancelCommand">cancel</a></td>
</tr> 
```

我想也许`.find`返回了两个对象，但是除了插入的两个节点之外，生成的 html 是正确的。似乎无法弄清楚。如果我只是替换 html，一切看起来都很好，但我也希望附加事件。

任何线索？

**编辑**

添加全部内容`copyItem`

```
<table>
    <tbody>
        <tr>
            <td style="width: 200px">company:</td>
            <td style="width: 100px">campaigns:</td>
            <td style="width: 300px"></td>
        </tr>
        <tr>
            <td class="companyName">$5 Dinners</td>
            <td>
                <select class="roleTypeList">
                    <option value="1000">All</option>
                    <option value="1001">Limited</option>
                </select>
            </td>
            <td rowspan="3" style="text-align: right">
                <input id="zzz" name="zzz" type="hidden" value="insert">
                <div id="zzz" style="">
                    <select size="4" name="zzz" multiple="multiple" id="zzz" class="campaignList" style="width:300px;">
                    </select>
                </div>            
            </td>        
        </tr>          
        <tr>
            <td colspan="2">reports:</td>
        </tr>
        <tr> 
            <td colspan="2">
                <input type="checkbox" value="1004" id="PinRptAdd">
                <label for="PinRptAdd">Pin Report</label>
                <input type="checkbox" value="1009" id="CpcAdd">
                <label for="CpcAdd">CPC</label>
                <input type="checkbox" value="1010" id="CpaAdd">
                <label for="CpaAdd">CPA</label>
                <input type="checkbox" value="1011" id="S2cAdd">
                <label for="S2cAdd">S2C</label>                                            
                <input type="checkbox" value="1003" id="LiveDetailsAdd" style="">
                <label for="LiveDetailsAdd" style="">Live Details</label>
            </td>
        </tr>
        <tr>
            <td class="command" style="" colspan="3">
                  <input type="button" class="insertCommand" value="Add">
            </td>        
         </tr>    
    </tbody>
</table> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T23:15:29.280

试试这个：

```
copyItem.find('.command').parent().html(command.html()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T23:16:20.217

代替

```
.replaceWith(command); 
```

你可以做

```
.html(command.html()); 
```

# c# - 多线程问题 - 线程完成后需要事件

> ID：13850247
> 
> 赞同：3
> 
> 时间：2012-12-12T23:08:20.493
> 
> 标签：c#, multithreading

我正在设计一个多线程进程，我在其中创建一个线程来进行一些处理，以免锁定 UI。但是，当这个线程完成时（如果它成功完成而没有错误），我需要一个事件，以便我可以在 UI 线程上执行一个方法，该方法将正确更新 UI。

我怎样才能正确地做到这一点？

我的线程简单代码：

```
Thread t = new Thread(new ThreadStart(GetAppUpdates));
t.Start(); 
```

现在我需要知道线程何时完成，但我觉得我不想实现会不断检查线程状态的代码，因为它会导致 UI 延迟。

（我知道使用 backgroundworker 会更容易，但我不希望这个进程使用 backgroundworker，因为这个线程不能是后台）。

有没有办法在线程对象完成时触发它们的事件？完成 ThreadFinished() 事件的最佳方法是什么？线程成功完成后，我有必须在主 UI 上执行的代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-12T23:10:28.910

传递新的匿名方法，该方法调用`GetAppUpdates()`和其他一些方法，通知您完成更新：

```
Thread t = new Thread(new ThreadStart(() => { GetAppUpdates(); Completed(); }));
t.Start(); 
```

`Completed`方法将在您的`GetAppUpdates()`方法执行后被调用：

```
private void Completed()
{
   if (InvokeRequired)
   {
      Invoke((MethodInvoker)delegate() { Completed(); });
      return;
   }

   // update UI
} 
```

**顺便说一句**，这将完成这项工作，但我最好使用 BackgroundWorker - 它专为此类任务而设计，它的 RunWorkerCompleted 事件处理程序将在 UI 线程上运行，这非常方便。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T23:13:55.833

我建议使用`Task`而不是线程来编写它。由于您在完成中更新 UI，因此您需要确保它在 UI 线程中运行。这可以通过*continuation*来完成：

```
Task task = Task.Factory.StartNew(() => GetAppUpdates());
task.ContinueWith(t => UpdateUserInterface(),
                     TaskScheduler.FromCurrentSynchronizationContext()); 
```

# c - 实现NTP服务器端

> ID：13850250
> 
> 赞同：1
> 
> 时间：2012-12-12T23:08:30.577
> 
> 标签：c, ntp

晚上好，我需要为我的学习编写一个 NTP 服务器。它应该有最基本的功能，它必须在 C 中。无论如何，这项工作我什至不知道从什么开始。有人会建议一些关于如何处理包和基本功能的文献。一个简单的 NTP 服务器源也可以为我服务。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T01:37:44.580

Google 搜索或 Wikipedia 上的搜索应该/可以很快为您回答这个问题。

请注意，在 RFC-5905 第 14 节（5905 是完整 NTPv4 协议的完整规范）中描述了字面意义上的“简单 NTP”或 SNTP。请注意，RFC-5905 甚至包含 C 语言服务器的框架代码。有许多可用的 SNTP 客户端，包括官方[NTP 参考实现中的一个](http://www.ntp.org/)

# active-directory - 无法获取 Kerberos 服务票证：KrbException：在 Kerberos 数据库中找不到服务器 (7)

> ID：13850252
> 
> 赞同：23
> 
> 时间：2012-12-12T23:09:01.000
> 
> 标签：active-directory, kerberos

我正在使用 GSSAPI 进行开发，并且我的代码可以与 vanilla MIT Kerberos 5 服务器一起使用来完成一些客户端/服务器工作。我现在正在针对 Active Directory 验证它的功能，并且遇到了问题。

我的服务器已通过身份验证并正在侦听。我可以让客户端登录。作为记录，这是基于[http://thejavamonkey.blogspot.com/2008/04/clientserver-hello-world-in-kerberos.html](http://thejavamonkey.blogspot.com/2008/04/clientserver-hello-world-in-kerberos.html)的代码。但是，我无法让客户端从 AD 取回票证以获取它与服务器之间的会话。我得到 KrbException: Server not found in Kerberos 数据库 (7)，我无法确定添加它的正确位置。我尝试将带有 ip 的服务器名称放在主机文件中，更新 dns，放入服务器记录等，但没有成功。

如果有人知道更新 AD 以在 Kerberos 数据库中设置服务器的正确位置，那就太好了！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-12-13T13:32:28.283

这个异常来自客户端，对吧？请执行服务器主机名的正向和反向 DNS 查找。您的服务器的 DNS 条目不正确。它们对于 Kerberos 来说绝对是至关重要的。正确的位置是您的 DNS 服务器，在您的情况下：域控制器。找出您的 DNS 服务器的 IP 地址并联系您的管理员。另一个选项是缺少 SPN，请也检查一下。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-04-13T12:22:25.070

我希望这会有所帮助.. 我收到了同样的错误消息（在 Kerberos 数据库中找不到服务器 (7)），但这发生在成功使用 keytab 登录之后。

当我们尝试使用凭据对 AD 进行 LDAP 搜索时，会出现错误消息。

这只是从 java 1.6.0_34 开始发生 - 它与 1.6.0_31 一起工作，我认为这是以前的版本。发生该错误是因为 java 不相信它为 LDAP 与之通信的 KDC 实际上是 Kerberos 领域的一部分。在我们的例子中，我认为这是因为 LDAP 连接是使用通过循环解析查询找到的服务器名称建立的。也就是说，java 解析 realm.example.com，但获取 kdc1.example.com 或 kdc2.example .com ..etc 中的任何一个）。他们一定加强了这些版本之间的检查。

在我们的例子中，问题是通过直接设置 ldap 服务器名称而不是依赖 DNS 来解决的。

但调查仍在继续。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2015-07-01T11:25:21.403

就我而言，这是由于请求的服务器地址配置错误造成的。

服务器地址应该是 FQDN（完全限定的域名）。

Kerberos 始终需要 FQDN。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-12-15T19:56:01.623

这看起来像是缺少 SPN 问题。您指向的网站有

```
principal="webserver/bully@EXAMPLE.COM" 
```

这是获得票证的主体。您是否将其更改为相对于您的 AD 域的值？

您可以使用命令行 kerberos 工具来测试您是否定义了 SPN：

```
[root@gen-cs218 bin]# kinit Administrator
Administrator@SIGNING.TEST's Password:
[root@gen-cs218 bin]# kgetcred host/tcfe102@SIGNING.TEST
[root@gen-cs218 bin]# klist
Credentials cache: FILE:/tmp/krb5cc_0
        Principal: Administrator@SIGNING.TEST

  Issued                Expires               Principal <br>
Dec 15 11:42:34 2012  Dec 15 21:42:34 2012  krbtgt/SIGNING.TEST@SIGNING.TEST
Dec 15 11:42:48 2012  Dec 15 21:42:34 2012  host/tcfe102@SIGNING.TEST 
```

基于主机名的 SPN 是预定义的。如果要使用未预定义的 SPN，则必须使用 setspn.exe 工具在 AD 中明确定义它，并将其与计算机或用户帐户相关联，例如：

```
c:\> setspn.exe -A "webserver/bully@MYDOMAIN" myuser 
```

您可以使用以下命令检查 SPN 与哪个帐户关联。这不会显示预定义的 SPN。

```
c:\> setspn.exe -L "webserver/bully@MYDOMAIN" 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-05-14T09:38:14.920

sqlcmd 工作，System.Data.SqlClient 不工作 - 在 Kerberos 数据库中找不到服务器。您应该添加 RestrictedKrbHost SPN

[https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-kile/445e4499-7e49-4f2a-8d82-aaf2d1ee3c47](https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-kile/445e4499-7e49-4f2a-8d82-aaf2d1ee3c47)

5.1.2 服务类等于“RestrictedKrbHost”的 SPN

支持“RestrictedKrbHost”服务类允许客户端应用程序在没有服务标识但有服务器名称时使用 Kerberos 身份验证。这不提供客户端到服务的相互身份验证，而是提供客户端到服务器的计算机身份验证。不同权限级别的服务拥有相同的会话密钥，如果底层服务不保证数据不能被更高级别的服务访问，则可以相互解密对方的数据。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-12-06T18:14:52.883

如果您已将 SPN 注册到多个用户/计算机，则可能会发生“在 Kerberos 数据库中找不到服务器”错误。

您可以通过以下方式检查：

```
$ SetSPN -Q ServicePrincipalName
( SetSPN -Q HTTP/my.server.local@MYDOMAIN ) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-05-31T07:14:03.773

In my case, My principal was `kafka/kafka.niroshan.com@NIROSHAN.COM` I got below lines in the terminal:

```
>>> KrbKdcReq send: #bytes read=190
>>> KdcAccessibility: remove kerberos.niroshan.com
>>> KDCRep: init() encoding tag is 126 req type is 13
>>>KRBError:
         cTime is Thu Oct 05 03:42:15 UTC 1995 812864535000
         sTime is Fri May 31 06:43:38 UTC 2019 1559285018000
         suSec is 111309
         error code is 7
         error Message is Server not found in Kerberos database
         cname is kafka/kafka.niroshan.com@NIROSHAN.COM
         sname is kafka/kafka.com@NIROSHAN.COM
         msgType is 30 
```

After hours of checking, I just found the below line has a wrong value in `kafka_2.12-2.2.0/server.properties`

`listeners=SASL_PLAINTEXT://kafka.com:9092`

Also I got two entries of `kafka.niroshan.com` and `kafka.com` for same IP address.

I changed it to as `listeners=SASL_PLAINTEXT://kafka.niroshan.com:9092` Then it worked!

According to the below link, the principal should contain the Fully Qualified Domain Name (FQDN) of each host and it should be matched with the principal.

[https://docs.oracle.com/cd/E19253-01/816-4557/planning-25/index.html](https://docs.oracle.com/cd/E19253-01/816-4557/planning-25/index.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-09-14T13:55:52.273

只是如果有人有类似的设置......

1.  我在 Windows Server 19 下设置了一个 Windows 活动目录 (AD) 服务器，类似于[本教程](https://computingforgeeks.com/how-to-install-active-directory-domain-services-in-windows-server/)
2.  [并希望使用本](https://nerdonthestreet.com/wiki?find=Authenticate%20Ubuntu%2019.04%20against%20Active%20Directory)教程对 Debian 客户端进行身份验证（使用 sssd） 。

我收到错误消息...

> msktutil：GSSAPI 错误：未指定的 GSS 故障。次要代码可能会提供更多信息（在 Kerberos 数据库中找不到服务器）

...当我尝试将我的客户端计算机作为计算机添加到 AD 时：

```
msktutil -N -c -b 'CN=COMPUTERS' -s DEBIAN/debian.ad.local -k my-keytab.keytab --computer-name DEBIAN --upn DEBIAN$ --server winserv19.ad.local --user-creds-only 
```

可以通过以下方式修复错误：

1.  *当然，将 DNS 服务器 IP 添加到`/etc/resolv.conf`*
2.  在 DNS 服务器上添加反向查找区域（也在 Win Serv 19 上运行，在 AD DS 旁边） [![Windows Server 19 DNS 反向查找区域](../Images/ebb7555496fd686a441022686521fec8.png)](https://i.stack.imgur.com/VWsAr.png)
3.  在 win DNS 服务器上激活`Update associated pointer (PTR) record`正向查找条目中的选项 [![Windows Server 19 DNS A 记录 PTR 选项](../Images/3f5c532ac37cb2b1c8d06053586cbb80.png)](https://i.stack.imgur.com/9OWzE.png)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-09-13T22:47:47.417

如果我告诉您当 UPN 搜索未返回任何条目时收到此错误，您会感到惊讶，这意味着未找到用户，而不是明确指示查询未返回任何项目。

因此，我建议修改您的查询部分或使用 AdExplorer 以确保您正在查找的用户/组可以通过您正在使用的查询访问（取决于您用作搜索 sAMAccount、userPrincipalName、CN、DN 的属性） .

请注意，当您连接到的 AD 试图在另一个 AD 实例中查找该用户时，您的机器无法通过与该初始 AD 实例的连接设置来访问该用户时，也会发生这种情况。

```
params.put(Context.REFERRAL, "follow"); 
```

* * *

## 回答 #10

> 赞同：-5
> 
> 时间：2014-03-19T13:56:17.167

考虑添加

```
[appdefaults]
validate=false 
```

到您的 /etc/krb5.conf。这可以解决 DNS 不匹配的问题。

# linux - 在linux中找到哪个进程正在产生另一个进程的方法？

> ID：13850254
> 
> 赞同：2
> 
> 时间：2012-12-12T23:09:09.060
> 
> 标签：linux, bash

我注意到在我的一个开发服务器中，有一个测试脚本执行一个命令，该命令每 10 秒占用 CPU 10 秒。

我杀死了运行测试脚本的进程，但是在监视正在运行的进程时，我注意到测试脚本被一些未知进程定期启动。我在想它的一些 cron 工作开始了。有没有办法找出哪个进程定期执行这个测试脚本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T01:30:53.737

您可以使用以下命令查看进程 ID 及其父 ID `ps`：

```
$ ps -o pid,ppid 4708
  PID  PPID
 4708  4580 
```

或者您可以只获取它的父母 ID：

```
$ ps -o ppid= 4708
 4580 
```

# php - Google Calendar PHP API 无法创建日历

> ID：13850258
> 
> 赞同：1
> 
> 时间：2012-12-12T23:09:36.163
> 
> 标签：php, google-calendar-api

我在使用 PHP 客户端库使用 Google Calendar API 时遇到了一些问题。

下面是我的代码：

```
<?php
require_once 'google-api-php-client/src/Google_Client.php';
require_once 'google-api-php-client/src/contrib/Google_CalendarService.php';
define("CLIENT_ID", "blah blah blah");
define("SERVICE_ACCOUNT_NAME", "blah blahblah");   
define("KEY_FILE", "keykeykey.p12");

$client = new Google_Client();
$client->setApplicationName("Google Calendar Sample");
$client->setUseObjects(true);

session_start();
if (isset($_SESSION['token'])) 
{
   $client->setAccessToken($_SESSION['token']);
}

$key = file_get_contents(KEY_FILE);
$client->setAssertionCredentials(new Google_AssertionCredentials(
                                 SERVICE_ACCOUNT_NAME,
                                 array('https://www.googleapis.com/auth/calendar'),
                                 $key)
);

$client->setClientId(CLIENT_ID);
$service = new Google_CalendarService($client);
///////////////////////////////////////////////////////////////////
try
{
    $calendar = new Google_Calendar();
    $calendar->setSummary('test');

    $createdCalendar = $service->calendars->insert($calendar);
    var_dump($createdCalendar);
}
catch(Google_ServiceException $e)
{
    var_dump($e);
}

///////////////////////////////////////////////////////////////////
if ($client->getAccessToken()) 
{
    $_SESSION['token'] = $client->getAccessToken();
}
?> 
```

$createdCalendar 的转储如下：

```
object(Google_Calendar)[15]
public 'kind' => string 'calendar#calendar' (length=17)
public 'description' => null
public 'summary' => string 'test' (length=3)
public 'etag' => string '"wT71Iy7ZAyY0SAhLu4jxO8w9qqM/zHZjSmLgdGM-FmXSbf2H0YONYb0"' (length=57)
public 'location' => null
public 'timeZone' => null
public 'id' => string '8ejg8n6j1j9utuuh6954jm18lk@group.calendar.google.com' (length=52) 
```

这表明日历已成功创建，因为 google 提供了 ID。但是，当我在网络浏览器中打开谷歌日历时，此日历不会显示在日历列表中。

有任何想法吗？

顺便说一句，我确定我的 2 Legged OAuth2 的设置正在工作，因为如果我用以下内容替换 ///////////// 之间的代码块，它工作正常

```
$event = new Google_Event();
$event->setSummary('Appointment');
$event->setLocation('Somewhere');
$start = new Google_EventDateTime();
$start->setDateTime('2012-12-15T16:00:00.000-08:00');
$event->setStart($start);
$end = new Google_EventDateTime();
$end->setDateTime('2012-12-15T19:00:00.000-08:00');
$event->setEnd($end);
$attendee1 = new Google_EventAttendee();
$attendee1->setEmail('testEmail@gmail.com');

$attendees = array($attendee1);
$event->attendees = $attendees;
$createdEvent = $service->events->insert('primary', $event); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T18:07:22.097

我发现我的类似代码为 google api 用户（`NNNNNNNNNNNN@developer.gserviceaccount.com`）创建了日历，但不是我。查看第一个现有日历的“id”，您将看到`NNNNNNNNNNNN@developer.gserviceaccount.com`。

# android - 有没有办法只为 android 4.0.3 禁用硬件加速？

> ID：13850259
> 
> 赞同：18
> 
> 时间：2012-12-12T23:09:36.793
> 
> 标签：android, android-4.0-ice-cream-sandwich

我最近偶然发现了 android 4.0.3 的一个问题，一旦应用程序启动，我就会得到以下异常（在其他 android 版本上它工作正常）：

```
java.lang.NullPointerException
at android.view.GLES20RecordingCanvas.drawPatch(GLES20RecordingCanvas.java:97)
at android.graphics.NinePatch.draw(NinePatch.java:125)
at android.graphics.drawable.NinePatchDrawable.draw(NinePatchDrawable.java:189)
at android.widget.ImageView.onDraw(ImageView.java:892)
at android.view.View.draw(View.java:10978)
at android.view.ViewGroup.drawChild(ViewGroup.java:2887)
at android.view.ViewGroup.dispatchDraw(ViewGroup.java:2489)
at android.view.ViewGroup.drawChild(ViewGroup.java:2885)
at android.view.ViewGroup.dispatchDraw(ViewGroup.java:2489)
at android.view.View.getDisplayList(View.java:10415)
at android.view.ViewGroup.dispatchGetDisplayList(ViewGroup.java:2597)
at android.view.View.getDisplayList(View.java:10380)
at android.view.ViewGroup.dispatchGetDisplayList(ViewGroup.java:2597)
at android.view.View.getDisplayList(View.java:10380)
at android.view.ViewGroup.dispatchGetDisplayList(ViewGroup.java:2597)
at android.view.View.getDisplayList(View.java:10380)
at android.view.ViewGroup.dispatchGetDisplayList(ViewGroup.java:2597)
at android.view.View.getDisplayList(View.java:10380)
at android.view.HardwareRenderer$GlRenderer.draw(HardwareRenderer.java:842)
at android.view.ViewRootImpl.draw(ViewRootImpl.java:1910)
at android.view.ViewRootImpl.performTraversals(ViewRootImpl.java:1634)
at android.view.ViewRootImpl.handleMessage(ViewRootImpl.java:2442)
at android.os.Handler.dispatchMessage(Handler.java:99)
at android.os.Looper.loop(Looper.java:137)
at android.app.ActivityThread.main(ActivityThread.java:4424)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:511)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
at dalvik.system.NativeStart.main(Native Method) 
```

这与启用硬件加速有关，只要我在清单上禁用它，应用程序就会开始正常工作。

通过搜索，我在 Romain Guy 的一些对话中找到了一个[日志](http://logs.nslu2-linux.org/livelogs/android-dev/android-dev.20120316.txt)（在该文档中搜索“drawPatch”），在那里他讨论了一些可能导致这种情况的原因，尽管没有提出解决方法或修复建议，我想知道是否我应该只为这个版本的android禁用硬件加速，或者是否有解决方法？

谢谢你的时间。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-05-09T18:52:48.683

您目前无法通过代码在窗口级别禁用硬件加速。

只启用它。我建议您在清单中默认禁用它：

```
<application android:hardwareAccelerated="false">
    <activity ... />
    <activity android:hardwareAccelerated="false" />
</application> 
```

然后将其启用到所有其他版本：

```
if (Build.VERSION.SDK_INT != Build.VERSION_CODES.ICE_CREAM_SANDWICH_MR1) {
            getWindow().setFlags(
                    WindowManager.LayoutParams.FLAG_HARDWARE_ACCELERATED,
                    WindowManager.LayoutParams.FLAG_HARDWARE_ACCELERATED);
        } 
```

您可以使用以下代码在运行时为单个视图禁用硬件加速：

```
myView.setLayerType(View.LAYER_TYPE_SOFTWARE, null); 
```

**此信息在[Android 中可用 - 控制硬件加速](http://developer.android.com/guide/topics/graphics/hardware-accel.html#controlling)**

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2014-03-25T18:50:25.213

我喜欢@sgarman 链接的答案，因为它对代码的影响最小并且易于维护。只是为了扩展该链接，这是我为仅针对 Android v4.0.3 并且仅针对特定活动禁用硬件加速所做的，它对我有用（请记住将指定版本和编码的 xml 标头添加到各种 bool.xml 文件，因为 wiki 编辑器不允许我将其粘贴）：

AndroidManifest.xml：识别托管违规视图的活动，并将其插入该活动：

```
<activity
    android:hardwareAccelerated="@bool/isNotIceCreamSandwich"
    ...
</activity> 
```

文件路径：res/values/bool.xml：

```
<resources>
    <bool name="isNotIceCreamSandwich">true</bool>
</resources> 
```

文件路径：res/values-v14/bool.xml：

```
<resources>
    <bool name="isNotIceCreamSandwich">false</bool>
</resources> 
```

文件路径：res/values-v16/bool.xml：

```
<resources>
    <bool name="isNotIceCreamSandwich">true</bool>
</resources> 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-12-13T00:13:56.510

所以 AC 在他的评论中提到了这一点，但让我详细说明一下。

您可以在值文件中创建一个布尔值并将其粘贴在正确的版本文件夹中。在你的清单下

查看这篇文章： https: [//plus.google.com/+AndroidDevelopers/posts/DcsFABkyuYM](https://plus.google.com/+AndroidDevelopers/posts/DcsFABkyuYM)。

看起来你想要定位 values-v15/bools.xml

[http://developer.android.com/reference/android/os/Build.VERSION_CODES.html#ICE_CREAM_SANDWICH_MR1](http://developer.android.com/reference/android/os/Build.VERSION_CODES.html#ICE_CREAM_SANDWICH_MR1)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-06-08T17:23:27.487

这是一个有趣的错误，因为硬件加速正在工作（有时）。这两天我一直在寻找这个问题的答案。它记录在 ICS 中，但我在我的一部测试手机中注意到它，运行 4.1.2 的三星 Galaxy S3 大多数人建议关闭硬件加速。我不想这样做，因为硬件加速使我的动画非常流畅。所以我发现如果我重写 draw() 尝试捕获空指针异常，硬件加速功能（大部分时间）都可以工作，并且足以让你永远不会注意到它们没有工作或抛出异常。就我而言，我正在做一个自定义视图并且有一些自定义绘图要做。对 null 的简单检查不起作用（canvas==null），这就是为什么这个 bug 很痛苦。所以我做的是这样的：

```
 @Override
public void draw(Canvas canvas) {
    try{
        super.draw(canvas);
        mCanvas=canvas;
    }catch(java.lang.NullPointerException e){
        Log.e("mytag","MyCustomView::draw():"+e);
    }
    if(mCanvas==null)
        return;     
... 
```

然后默默地尝试在个人平局声明中捕获任何 NPE。我第一次看到这个错误时，我将整个 draw() 代码包围在一个 try and catch 中。这适用于大多数手机，但在运行 4.1.2 的三星 s3 上会导致闪烁。所以我使用了上述方法，并且在每次调用 someObject.draw(mCanvas) 时都进行了静默 try catch，这完全解决了问题，消除了所有闪烁（硬件加速视图缓存和新画布之间的差异）。希望这可以帮助！比关闭 HWA 好多了！

# wcf - Metro (Store) 应用程序中的 WCF 服务引用在更新后将不起作用

> ID：13850261
> 
> 赞同：1
> 
> 时间：2012-12-12T23:09:42.067
> 
> 标签：wcf, windows-store-apps, service-reference

这是场景：在服务器上有 WCF 服务，其中包含一些简单的方法和几个类。客户端是 Metro (Store) 应用程序。在服务类中进行更改时添加和更新服务引用后，两者之间的通信工作得很好。我可以完美地传递数据。然后，在 Wcf 服务中添加了一些新的方法和类之后，并且很少更新引用......它坏了。

Reference.cs 中只有一些注释，但没有代码。创建新的引用不起作用，它会一次又一次地生成空的引用类。更新参考也没有用。

当我将 Metro 页面移动到新的空解决方案并生成参考时，它会再次工作，过了一段时间......当我添加新的一堆方法等时，它会中断（它适用于少数更新，tho）。我不明白为什么会在一个解决方案中发生这种情况，而是在一个新的解决方案中工作，并在一段时间后再次发生。我看不出是什么触发了这个问题。

有人有同样的问题吗？我找不到专门针对 Metro 应用程序解决此问题的答案。

ps 对不起，我的英语缺乏解释问题的术语……请问您是否需要了解更多信息。:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T18:57:56.617

刷新服务参考后是否检查过警告列表？我经常在那里找到一些关于服务引用错误的有趣信息。

# mysql - 为什么这个 SQL 字符串不起作用？

> ID：13850263
> 
> 赞同：0
> 
> 时间：2012-12-12T23:09:48.503
> 
> 标签：mysql, sql, oracle, join

我必须得到一份所有工作职位的清单以及在那里工作的人的工资总和......

我用这个得到了：

```
SELECT j.job_title, SUM(e.salary)
FROM jobs j LEFT JOIN employees e ON e.job_id = j.job_id
GROUP BY j.job_title; 
```

好的，但现在我必须得到相同的清单，但还要考虑到城市......

它不起作用...：/

```
SELECT j.job_title, SUM(e.salary), d.department_id, l.city
FROM departments d LEFT JOIN employees e ON e.department_id = d.department_id LEFT JOIN locations l 
ON l.location_id = d.location_id LEFT JOIN jobs j ON e.job_id = j.job_id 
GROUP BY l.city; 
```

为什么会这样？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-12T23:12:09.063

您还需要在 group by 子句中添加这些列：`j.job_title`, `d.department_id`,`l.city`

```
SELECT..
FROM...
GROUP BY j.job_title, d.department_id, l.city 
```

*`GROUP BY`子句中必须包含*非聚合列。**

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T23:11:43.383

我认为你只需要按部门 ID 和工作标题分组：

```
GROUP BY j.job_title, d.department_id, l.city; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-12T23:12:07.327

您需要按非聚合列分组；

```
...
group by job_title, department_id, city 
```

您还可以通过以下方式使用组中的列位置：

```
group by 1, 3, 4 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-12T23:14:39.837

您仅按 l.city 分组，但在 select 语句中您使用的是 j.job_title, d.department_id 所以为了获取这些值，您必须使用

```
group by job_title, department_id, city 
```*

# objective-c - @synchronized 锁定 iVar 和/或属性？

> ID：13850264
> 
> 赞同：1
> 
> 时间：2012-12-12T23:09:53.810
> 
> 标签：objective-c, ios, thread-safety, synchronized, nslock

> **可能重复：**
> [@synchronized() 做什么？](https://stackoverflow.com/questions/6317889/what-does-synchronized-do)

我有一个关于什么`@synchronized`真正起作用以及什么最适合我的应用程序的问题。

我有一个`NSMutableArray`我将在后台线程中变异并在前台线程中访问。如果我在改变它的内容时访问数组，如果这意味着我可以从背景突变中获取更新的值，我希望对访问数组有一点控制。但是，我不能 100% 确定`NSLock`s 和 s 的`@synchronized`具体工作方式。

如果这是不可能的，是否可以改变数组的副本，完成后，在设置副本的内容时锁定属性/实例变量，以冻结任何访问器调用？

基本上，@synchronized(myArray) 会冻结任何访问器调用（让调用挂起，直到锁释放然后执行）？

此外，是否可以使用 NSLock 锁定实例变量或属性？从我所见，它似乎只锁定代码块。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T23:23:32.660

```
Basically, will the @synchronized(myArray) freeze any accessor calls (have the call hang 
until the lock lets up and then execute)? 
```

不，但是如果在调用任何访问器之前，您在数组实例上使用同步指令，它将冻结您的访问器。
如果线程 1 进入数组实例上的同步块，并且线程 2 尝试进入同一数组上的同步块，它必须等待线程 1 从块中退出。但是如果您使用同步指令不同的对象，那么多个线程可以进入同步块。

# dotnetnuke - dotnetnuke 跨门户共享内容

> ID：13850265
> 
> 赞同：3
> 
> 时间：2012-12-12T23:09:57.903
> 
> 标签：dotnetnuke, portal

我正在测试 DNN v 7.0 的社区版本

我们有 3 个门户。我需要跨门户共享内容，这可能吗？我需要有一个内容来源，所以当我更新它时，所有包含该内容的页面都会获得更新后的文本。我对这个解决方案的搜索要么让我陷入非常旧的页面，要么让我的答案不太清楚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T09:01:33.367

有几种第 3 方解决方案可让您在其他门户网站上共享内容。我们的大多数模块都具有此功能，包括 Live Wrapper、Live Tabs、Live Accordion、Live Content 等等。

您可能想尝试 Live Wrapper 试用版，看看它是否满足您的需求。谢谢

[http://www.mandeeps.com/products/dotnetnuke-modules/live-wrapper.aspx](http://www.mandeeps.com/products/dotnetnuke-modules/live-wrapper.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T03:06:38.720

DNN 7 在DotNetNuke[专业版](http://www.dotnetnuke.com/Products/Compare-Editions.aspx)中引入了跨站点内容共享。这是实现您正在尝试的唯一“支持”方式。

可以编写一个自定义扩展来显示来自另一个门户的模块的内容，但我不知道现在有任何支持此功能的最新解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-13T15:02:58.340

另一种选择是[Inventua 的 Shadow 模块](http://www.inventua.com/Default.aspx?tabid=64&AspxAutoDetectCookieSupport=1)。

# oracle - 定期运行分析 - Oracle 商业智能 (OBIEE)

> ID：13850266
> 
> 赞同：0
> 
> 时间：2012-12-12T23:10:19.120
> 
> 标签：oracle, analysis, business-intelligence, obiee

如何在 Oracle 商业智能 (OBIEE) 中定期运行分析？

假设我在存储库中有物理表（选择类型），它是可兑现的，并且兑现在 7 小时内有效。当用户运行分析时，它会等待大约 3 分钟。我需要每天早上 8 点 45 分运行分析，以便下次尝试在 7 小时内使用 Cashe。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T23:27:55.500

创建一个代理（New / Actionable Intelligence / Agent）并选中“目的地”选项卡中的 Oracle BI Server Cache 框。

在“交付内容”选项卡中选择您的分析（需要 3 分钟的分析），并在“计划”选项卡中设置频率。

[OBIEE 11g 用户指南：创建代理](http://docs.oracle.com/cd/E23943_01/bi.1111/e10544/delivers.htm#autoId7)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-04T09:16:22.650

`Victor HDC`

`How did that work out?`

好吧，它现在适用于另一种解决方案。我们使用 Oracle 程序在工作日结束时将数据插入到 Result 表中。然后用户只需打开 Analysis 并从 Result 表中返回数据。

顺便说一句，Oracle 程序不仅计算当前工作日的数据，而且计算上周的数据（以防源表中的某些内容发生变化）。

我们使用 dblink 将数据从事务服务器插入到报表服务器中，所有计算都在报表服务器上执行（这是为了更好的性能）。

更新：无法恢复我的 marchello 密码，所以回答为 marchelloUA。

# mysql - 为每列添加一行总计

> ID：13850268
> 
> 赞同：2
> 
> 时间：2012-12-12T23:10:41.070
> 
> 标签：mysql, sql, union, rollup

我正在尝试向包含总和（或任何其他操作，例如平均值）作为最后一行的 SQL 选择查询添加一行。在这方面，它类似于 GROUP BY ... WITH ROLLUP。

首先：假设我有一个表 t，其中包含字段 ID、A、B 和 C，所有这些都是数字。此外，ID 不是唯一的，而是一个类别。我的 SELECT 查询应该计算这些数字中有多少落在指定范围内。

因此，例如，最终结果将是

```
(SELECT t.ID, a.ac, b.bc, c.cc FROM t
LEFT JOIN (SELECT COUNT(*) cc,ID FROM t WHERE A BETWEEN 2 AND 4 GROUP BY ID) AS a ON a.ID=t.ID 
LEFT JOIN (SELECT AVG(B) cc,ID FROM t WHERE B BETWEEN 19 AND 40 GROUP BY ID) AS b ON b.ID=t.ID 
LEFT JOIN (SELECT COUNT(*) cc,ID FROM t WHERE C BETWEEN 12 AND 14 GROUP BY ID) AS c ON a.ID=t.ID GROUP BY t.ID) 

union 

(select 'Overall',
 (SELECT COUNT(*) cc FROM t WHERE A BETWEEN 2 AND 4),
 (SELECT AVG(B) cc FROM t WHERE B BETWEEN 19 AND 40),
 (SELECT COUNT(*) cc FROM t WHERE C BETWEEN 12 AND 14) ); 
```

但是，这个解决方案并不理想，因为我需要重新说明 A、B 和 C 的条件。我想知道是否有一种简单的方法可以只指定一次条件来完成相同的结果。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-12T23:21:57.143

我认为没有更简单的解决方案。但我会像这样重写你的查询：

```
SELECT
  t.ID,
  count(case when A between 2 and 4 then ID end),
  AVG(case when B between 19 and 40 then B end),
  COUNT(case when C between 12 and 14 then id end)
FROM t
GROUP BY ID
UNION
select
  'Overall',
  count(case when A between 2 and 4 then ID end),
  AVG(case when B between 19 and 40 then B end),
  COUNT(case when C between 12 and 14 then id end)
FROM t 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T02:41:23.763

好吧，没有平均值，您可以这样做：

```
SELECT t.ID,
       count(case when A between 2 and 4 then ID end),
       AVG(case when B between 19 and 40 then B end),
       COUNT(case when C between 12 and 14 then id end)
FROM t
GROUP BY ID with rollup 
```

我会写成：

```
SELECT t.ID,
       sum(case when A between 2 and 4 then 1 else 0 end),
       sum(case when B between 19 and 40 then B end)/sum((case when B between 19 and 40 then B end),
       sum(case when C between 12 and 14 then 1 else end)
FROM t
GROUP BY ID with rollup 
```

我不确定汇总如何与 avg 一起使用，因此最终版本是：

```
select coalesce(t.ID, 'Overall'), Acnt,
       (case when Bcnt > 0 then Bsum/Bcnt end),
       Ccnt
from (select t.ID,
             sum(case when A between 2 and 4 then 1 else 0 end) as Acnt,
             sum(case when B between 19 and 40 then B end) as Bsum,
             sum(case when B between 19 and 40 then B end) as Bcnt,
             sum(case when C between 12 and 14 then 1 else end) as Ccnt
      FROM t
      GROUP BY ID with rollup
     ) t 
```

# linux - SVN 日志没有给出正确的日期

> ID：13850270
> 
> 赞同：1
> 
> 时间：2012-12-12T23:10:45.033
> 
> 标签：linux, svn

我正在运行的命令（我正在使用 python）是：

`output = subprocess.Popen(['svn', 'log',<repo url>,'-r', '{2012-12-10}:{2012-12-12}'], stdout=subprocess.PIPE).communicate()[0]`

这转化为

`svn log <repo url> -r {2012-12-10}:{2012-12-12}`

但是，它偶尔会给我 11 月或 10 月的回复（可能还有其他时间；我想指定两天是有原因的）

这里发生了什么？

谢谢

# java - 数组列表 排序算法 Java

> ID：13850272
> 
> 赞同：3
> 
> 时间：2012-12-12T23:10:53.963
> 
> 标签：java, algorithm, sorting, arraylist

我想对 ArrayList 进行排序，使其从最小到最大。我有以下代码：

```
public static ArrayList<BigInteger> sortBigInteger(ArrayList<BigInteger> toSort){
    ArrayList<BigInteger> toReturn = new ArrayList<BigInteger>();
    toReturn.add(toSort.remove(0));
    for (int i = 0; i < toSort.size(); i++){
        BigInteger n = toSort.get(i);
        boolean eval = false;
        in: for (int a = 0; a < toReturn.size(); a++){
            if (n.compareTo(toReturn.get(a)) < 0){
                toReturn.add(a, toSort.remove(i));
                eval = true;
                break in;
            }
        }
        if (!eval) toReturn.add(toSort.remove(i));
    }
    toSort = toReturn;
    return toReturn;
} 
```

但是，我失去了元素。使用大小为 32 的 ArrayList，我得到大小为 15 的 ArrayList。额外的删除发生在哪里？
**主要问题：**如何对 ArrayList 进行排序？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-12T23:14:10.007

您始终可以使用¹。[`Collections.sort(toSort)`](http://docs.oracle.com/javase/6/docs/api/java/util/Collections.html#sort%28java.util.List%29)

它只会对 ArrayList 进行排序`toSort`。

* * *

注意 - 使用已经为您构建测试和优化的内置库通常要好得多，而不是重新发明轮子。在大多数情况下，结果可能是：

*   更高效
*   更正确（已经处理了一些你可能错过的讨厌的边缘情况）
*   开发速度更快
*   更好的维护

* * *

**PS**
您的算法失败的原因是您不断从中删除元素`toSort`，然后从更大的索引中读取。

举个简短​​的例子，看看 list `[5,2,9]`。
首先你有`toSort = [5,2,9] , toReturn = []`
When `i == 0`，你基本上会调用：`toReturn.add(toSort.remove(0));`
它将导致列表：`toSort = [2,9], toReturn = [5]`。

但是，在下一次迭代 -`i==1`中，您将检查索引为 1 的元素，现在是 9，而不是 2！你错过了一个元素！

（这实际上是一个很好的例子，为什么使用内置排序通常更好！）

* * *

（1）假设您只想对您的评论进行排序，而不是将其作为自我改进或任务。如果您对排序算法感兴趣，您可能会发现[排序算法的维基百科页面](http://en.wikipedia.org/wiki/Sorting_algorithm)很有帮助，尤其是在 java 中实际使用的那个 - [TimSort](http://en.wikipedia.org/wiki/Timsort)。

# php - htaccess - 斜杠 URL

> ID：13850273
> 
> 赞同：0
> 
> 时间：2012-12-12T23:10:57.780
> 
> 标签：php, .htaccess, mod-rewrite, url-rewriting

您好我有以下问题：我有一些页面（包括 php），我像这样加载它们

```
http://www.domain.com/news/ 
```

他们工作完美。但是如果我删除尾部斜杠

```
http://www.domain.com/news 
```

发生这种情况->`http://www.domain.com/news/?page=news&request=`

这是我的 htaccess 规则：

```
RewriteEngine on

<IfModule mod_gzip.c>
    mod_gzip_on       Yes
    mod_gzip_dechunk  Yes
    mod_gzip_item_include file      \.(html?|txt|css|js|php|pl|jpg|png|gif)$
    mod_gzip_item_include handler   ^cgi-script$
    mod_gzip_item_include mime      ^text/.*
    mod_gzip_item_include mime      ^application/x-javascript.*
    mod_gzip_item_exclude mime      ^image/.*
    mod_gzip_item_exclude rspheader ^Content-Encoding:.*gzip.*
</IfModule>

Options -Indexes
RewriteCond %{REQUEST_FILENAME} !-f
#RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([^/]*)(.*)$ /index.php?page=$1&request=$2 
```

PS。可能是因为我在根文档中也有一个新闻文件夹吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T23:13:54.320

是的，这是因为您`news/`在根目录中有一个文件夹。您的重写条件正在寻找任何不是文件（即`!-f`）或目录（`!-d`）的东西。尝试`news/`在根目录中重命名您的目录。

如果必须，您可以通过执行以下操作强制`domain.com/news`重写：`domain.com/news/`

```
RewriteCond %{REQUEST_URI} !(.*)/$
RewriteRule ^(.*)$ http://domain.com/$1/ [L,R=301] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T23:45:15.127

这是一个 mod_dir 问题。当它认为一个 URL 映射到一个目录时（即使它后来确定不映射），它会重定向浏览器，以确保在末尾附加一个斜杠。[请参阅我在另一个问题中发布的这个最近的解释](https://stackoverflow.com/a/13849773/851273)。

就像在另一个答案中一样，您可以关闭`DirectorySlash`或确保所有受影响的 URL 都通过 mod_rewrite 使用尾部斜杠重定向（以便重写**和**重定向发生在同一个模块中）：

1.  通过包含一个`DirectorySlash Off`. 这使得 mod_dir 不会重定向浏览器，但[请注意关闭它还有其他后果](http://httpd.apache.org/docs/2.2/mod/mod_dir.html#directoryslash)。您可以在 htaccess 文件中添加该指令。

2.  处理 mod_rewrite 中的尾部斜杠：

    ```
    RewriteEngine On
    Options -MultiViews

    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_URI} !/$
    RewriteRule ^(.*)$ /$1/ [L,R=301] 
    ```

# antlr - ANTLR4 访客子树检查

> ID：13850276
> 
> 赞同：3
> 
> 时间：2012-12-12T23:11:07.653
> 
> 标签：antlr, visitor-pattern, antlr4

我有一个 Antlr4 问题。鉴于下面的语法摘录。`actualParameters`测试访问者 中是否存在可选子树的正确方法是什么？

我已经尝试过 procedureCallStatement 上下文的 getChildCount 方法。我还测试了上下文中的 null actualParameters 参数。

如果实际参数子树不存在，我不想访问它。这样做会导致异常。

谢谢！

开尔文·约翰逊

```
program : statement (';' statement)* ';'?;

statement : CALLPREFIX('(' actualParameters? ')')?  #procedureCallStatement;

actualParameters : expressionStatement (';' expressionStatement)* ;

expressionStatement : '(' expressionStatement ')'  #parensExpression
| IDENT'[' expressionStatement ']' #subscript
... 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T03:59:14.560

自动生成的上下文方法`ProcedureCallStatementContext.actualParameters()`将返回`ActualParametersContext`if 已解析，否则将返回`null`。

您可以在这样的访问者中使用它：

```
public T VisitProcedureCallStatement(ProcedureCallStatementContext ctx) {
    if (ctx.actualParameters() != null) {
        // do something here
    }

    ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T01:36:49.377

调用 ctx.getActualParameters() 或标记它

```
statement : CALLPREFIX('(' args=actualParameters? ')')?  #procedureCallStatement; 
```

然后使用 ctx.getArgs()

# gpars - GPars - 提前终止并行收集的正确方法

> ID：13850284
> 
> 赞同：0
> 
> 时间：2012-12-12T23:12:07.707
> 
> 标签：gpars

终止并行收集的最佳方法是什么（在线程之一引发异常或用户发起中断的情况下）？

无论哪种情况，我都可以轻松设置一些标志，然后在循环顶部检查它。但是，如果我的集合中有 10,000 件物品，我宁愿告诉将它们送入 ForkJoinPool 的任何东西停止送入它们。让已经开始的 5 或 20 件左右完成，但不要再开始了。

这是一个示例，您可以插入以了解我的意思。如果我模拟其中一个线程抛出异常，则看起来集合停止处理，因为线程计数的第一次打印（在“A：”消息处）通常非常小（5 左右）。但是，通过在 GParsPool.withPool 之外打印计数（在“B:”处），我可以看到它们确实一直在运行（始终都是 100）：

```
void doIt() {
    AtomicInteger threadCounter = new AtomicInteger(0)
    AtomicInteger threadCounterEnd = new AtomicInteger(0)

    try {
        GParsPool.withPool { pool ->

            try {
                (1..100).eachParallel {
                    try {
                        if (threadCounter.incrementAndGet() == 1) {
                            throw new RuntimeException('planet blew up!')
                        }

                        // Do some long work
                        Integer counter=0
                        (1..1000000).each() {counter++}

                        // Flag if we went all the way through
                        threadCounterEnd.incrementAndGet()
                    } catch (Exception exc) {
                        //pool.shutdownNow()
                        throw new RuntimeException(exc)
                    }
                }
            } catch (Exception exc) {
                println 'caught exception'
                //pool.shutdownNow()
                println "A: threads launched was ${threadCounter}, ended was ${threadCounterEnd}"
                throw new RuntimeException(exc)
            }
        }
    } catch (Exception exc) {
        exc.printStackTrace()
    }

    println "B: threads launched was ${threadCounter}, ended was ${threadCounterEnd}"
} 
```

如果我在 eachParallel 中使用 pool.shutdown()，它没有影响。如果我使用 pool.shutdownNow()，它会像我想要的那样结束处理，但会抛出一个 CancellationException，这会掩盖我想要的真正异常。我可以将“真正的”异常存储在一个变量中以供以后访问，但我想知道是否没有更好的方法来告诉并行集合干净地停止。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T10:38:42.467

没有这种机制的ATM。由于池无法区分您的任务和其他潜在计算的任务，因此它没有阻止线程读取任务队列的机制。如果您知道您是线程池的唯一用户，则可以按照您的建议使用 shutdownNow()（具有上述后果）。

我觉得您也知道的另一个选项是直接正确捕获任务中的异常并设置共享原子标志以指示其他任务立即退出。

# c# - 无法将 DTE、项目或解决方案投射到 VCProject 和 VCCodeModel

> ID：13850291
> 
> 赞同：7
> 
> 时间：2012-12-12T23:13:02.227
> 
> 标签：c#, visual-studio-2010, add-in, envdte

我正在尝试通过代码获取有关 c+= 程序的一些信息。我在 EnvDTE 上取得了一些成功，现在我需要使用 VCProject 和 VCCodeModel 并且我遇到了铸造问题（希望就是这样......）

在工人阶级中，我有一个`"application"`从 Connect 传递的 DTE。

我有：

```
EnvDTE.Project project = application.SelectedItems.Item(1).Project;
EnvDTE.Solution sol = (EnvDTE.Solution)application.Solution; 
```

我想使用“项目”，而不是解决方案中的第一个项目作为我在网上找到的示例 - 如下所示 - 但大多数情况下，我想先有一些可行的东西。

对于 VCProject，我已经尝试过（关闭 Microsoft 的网站，以及所有其他网络示例）：

```
VCProject vcProject = (VCProject)application.Solution.Projects.Item(1).Object;
MessageBox.Show(vcProject.ProjectDirectory); 
```

要不就

```
VCProject vcProject = (VCProject)project.Object; 
```

对于 VCCodeModel，我翻译成 c# [http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.vccodemodel.vccodeinclude.aspx](http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.vccodemodel.vccodeinclude.aspx)：

```
public void GetAllIncludes()
{
  VCCodeModel vcCM = (VCCodeModel)application.Solution.Item(1).CodeModel;
  foreach (VCCodeInclude vcInclude in vcCM.Includes)
  {
    MessageBox.Show(vcInclude.DisplayName);
  }    
} 
```

两者都给出例外：

```
"unable to cast com object of type 'system.__comobject' to interface type Microsoft.VisualStudio.VCCodeModel"
"unable to cast com object of type 'Microsoft.VisualStudio.Project.VisualC.VCProjectEngine.VCProjectShim' to type Microsoft.VisualStudio.Project.VisualC.VCProjectEngine.VCProject" 
```

我该如何设置？最好使用“项目”......或者`application.SelectedItems`......有可能吗？

有人可以给我一个想法吗？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-12T12:32:48.213

当您尝试将 CodeModel 转换为不同的 VCCodeModel 版本时，会出现此问题。每个 VS 版本都有一个 VCCodeModel.dll。

# eclipse - 带有表单的 Eclipse RCP 视图不刷新

> ID：13850292
> 
> 赞同：2
> 
> 时间：2012-12-12T23:13:03.670
> 
> 标签：eclipse, eclipse-rcp, rcp

我正在学习如何创建一个带有表单的 Eclipse RCP 应用程序，并且我正在构建一个我需要做的简单原型。我在 Windows x64 平台上使用 64 位 Eclipse 3.7 和 Java 1.7。

我正在尝试做的是相当标准的：应用程序左侧的视图包含一棵树 ( `ViewTree`)，右侧的视图 ( `ViewDetail`) 使用 Eclipse 表单来呈现有关树选择的详细信息。我设置`ViewTree`为选择提供者，并`ViewDetail`设置为收听`ViewTree`. 我想`ViewDetail`用每一个新的树选择来刷新自己。

以下是相关代码`ViewTree`：

```
public class ViewTree extends ViewPart
{
    private TreeViewer treeViewer;

    public ViewTree() {
        super();
    }

    @Override
    public void createPartControl(Composite parent) {
        treeViewer = new TreeViewer(parent, SWT.BORDER | SWT.MULTI | SWT.V_SCROLL);
        getSite().setSelectionProvider(treeViewer);
        treeViewer.setLabelProvider(new TreeObjLabelProvider());
        treeViewer.setContentProvider(new TreeObjContentProvider());
    } 
```

以下是相关代码`ViewDetail`：

```
public class ViewDetail extends ViewPart implements ISelectionListener 
{
    private FormToolkit toolkit;
    private ScrolledForm form;
    private Composite compParent;

    public ViewDetail() {}

    @Override
    public void createPartControl(Composite parent) {
        toolkit = new FormToolkit(parent.getDisplay());
        form = toolkit.createScrolledForm(parent);
        compParent = parent;
        // register as a selection listener with the workbench
        getSite().getPage().addSelectionListener(ViewTree.ID, (ISelectionListener) this);
    } 
```

因为我希望表单`ViewDetail`擦除自身并为每个新选择重新绘制新信息，所以在`selectionChanged(IWorkbenchPart part, ISelection selection)`ViewDetail 的函数中，我调用 `form.dispose();` 擦除它，然后使用以下方法重新创建表单： `form = toolkit.createScrolledForm(compParent);` 然后确定已选择的对象类型并构建相应的形式。

问题是，一旦我在树中选择了一个对象，我的表单就会被处理掉并且`ViewDetail`变成空白。在调整窗口大小之前，视图中不会显示任何内容。构建表单后，我尝试通过调用来刷新它： `form.getBody().layout();` 但这似乎没有帮助。关于接下来要尝试什么的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T22:10:58.507

通过调用，我能够在不调整大小的情况下重绘表单：

```
compParent.layout(); 
```

所以我在布局命令的正确轨道上，我只需要在顶层调用它 - 父复合体，而不是表单，它是父复合体的子级。感谢@GGeorge 的帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T23:19:01.490

直接做`form.layout(true)`。

或者

你甚至可以试试`form.reflow()`。

**编辑：**

[有关该主题的进一步阅读，请点击此处](http://www.ibm.com/developerworks/opensource/library/os-ecgui1/)。阅读“监听事件”部分。

# jquery - 最新的 Web API + Cors 失败

> ID：13850294
> 
> 赞同：1
> 
> 时间：2012-12-12T23:13:06.643
> 
> 标签：jquery, asp.net-web-api, cors

我对 jsonp 或 cors 等感到非常沮丧。

jquery 上的 jsonp 结果认为，如果它只是返回的状态码而没有正文，则它是一个错误。它还认为返回的错误代码应该有状态为 200 的错误，因此您甚至无法确定哪个是哪个。

所以然后我尝试使用 cors，WebAPI 以某种方式在任何选项请求上拦截我的 DelegatingHandler，并且结果被触发，所有主要浏览器都不会超过选项请求。

所以然后我在我的 web.config 中放了很多东西来强制标题：

```
 <customHeaders>
    <add name="Access-Control-Allow-Origin" value="https://beta.mobilemone.com" />
    <add name="Access-Control-Allow-Headers" value="content-type, accept, authorization, origin, referer, user-agent" />
    <add name="Access-Control-Allow-Methods" value="GET, POST, PUT, DELETE, OPTIONS" />
    <add name="Access-Control-Allow-Credentials" value="true"/>
    <add name="Access-Control-Max-Age" value="1728000"/>
  </customHeaders> 
```

这更进一步，但仍然在最终被调用的 jquery ajax 请求上获得“取消”结果。

如何让 cors 与 web api 一起正常工作？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T02:54:25.720

尝试删除`<add name="Access-Control-Allow-Credentials" value="true"/>`设置。如果您的客户端也没有设置，这将导致问题`.withCredentials = true`。

还尝试将 Access-Control-Allow-Origin 标头更改为：

```
<add name="Access-Control-Allow-Origin" value="*" /> 
```

如果这两个提示不起作用，您能否将您的 JavaScript 代码与请求/响应标头的跟踪一起包含在内？

# ios - Facebook 图形 API 最后已知位置

> ID：13850295
> 
> 赞同：1
> 
> 时间：2012-12-12T23:13:15.923
> 
> 标签：ios, xcode, facebook, facebook-graph-api

如何使用 Facebook API 获取最后一个已知位置？我试过

```
 NSLog(@"%@", user.location); 
```

但我收到，null。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T23:23:01.917

需要更多信息。你用什么方法调用这个？

您应该从 FBRequest 获取此信息，该信息将在成功时返回 NSDictionary。然后你可以做...

```
[[dict objectForKey:@"location"] objectForKey:@"name"]; 
```

这将返回其位置的名称。

# javascript - 将base64位图插入rtf

> ID：13850299
> 
> 赞同：1
> 
> 时间：2012-12-12T23:13:33.723
> 
> 标签：javascript, image, base64, rtf

我有一张从签名捕获中捕获的图像。sig cap 返回图像的 base64 字符串。

我想从 javascript 创建一个包含此图像的 rtf 文档字符串。

这是我所拥有的：

```
var datapair = $sigdiv.jSignature("getData"); 
```

哪个返回（缩短，因为要在 SO 上发布）：

```
 ["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABNMAAAE2CAYAAABLINTeAAAgAElEQVR4Xu3dCbQtVXkgYPMYRVBAxTi0PkQDmCCgxiESeaBtCK0IGqKJEUzAuUFNtF1Jx/CcVnezYhSMtigYwJjYTgyRaFqNF+chYdBoVEQejgFRURNh4UD/v55qy/Lce88595w6tau+Wutf9wxVe//72/XOved/NfzCLSwECBAgQIAAAQIE2hO4W3S1edTdrvFzn4grI/599NqB8XOPWjor66R2SLy/LeI/phjCA2Ldjy5w/arpW43G+oE1+lptvONsLo92rp8ib6sSIECAAAECCxD4hQW0qUkCQIECBAgQIAAAQIECBBoWUAxrWVw3REgQIAAAQIECBAgQIAAAQIECJQroJhW7tzJnAABAgQIECBAgAABAgQIECBAoGUBxbSWwXVHgAABAgQIECBAgAABAgQIECBQroBiWrlzJ3MCBAgQIECAAAECBAgQIECAAIGWBRTTWgbXHQECBAgQIECAAAECBAgQIECAQLkCimnlzp3MCRAgQIAAAQIECBAgQIAAAQIEWhZQTGsZXHcECBAgQIAAAQIECBAgQIAAAQLlCiimlTt3MidAgAABAgQIECBAgAABAgQIEGhZQDGtZXDdESBAgAABAgQIECBAgAABAgQIlCugmFbu3MmcAAECBAgQIECAAAECBAgQIECgZQHFtJbBdUeAAAECBAgQIECAAAECBAgQIFCugGJauXMncwIECBAgQIAAAQIECBAgQIAAgZYFFNNaBtcdAQIECBAgQIAAAQIECBAgQIBAuQKKaeXOncwJECBAgAABAgQIECBAgAABAgRaFlBMaxlcdwQIECBAgAABAgQIECBAgAABAuUKKKaVO3cyJ0CAAAECBAgQIECAAAECBAgQaFlAMa1lcN0RIECAAAECBAgQIECAAAECBAiUK6CYVu7cyZwAAQIECBAgQIAAAQIECBAgQKBlAcW0lsF1R4AAAQIECBAgQIAAAQIECBAgUK6AYlq5cydzAgQIECBAgAABAgQIECBAgACBlgX+H9F/EpGfbmFGAAAAAElFTkSuQmCC"] 
```

然后我试图用以下字符串形成一个 rtf 文档。

```
string rtf = @"{\rtf1\ansi{\fonttbl\f0\fswiss Helvetica;}\f0\pard ";
            rtf += picture;
            rtf += " }";
            return rtf; 
```

图片在哪里（缩短，因为要在 SO 上发布）：

```
var imageData = "iVBORw0KGgoAAAANSUhEUgAABNMAAAE2CAYAAABLINTeAAAgAElEQVR4Xu3dC9A1ZX0YcMOHYlEI0GhMk9EPiLU6NULEptUqL0irphb5IB0ZIxeVljEtl6ixM5kAH5dMR8dLwMY28cIltdgIcnHUdtTwUmsTdUCZxNRqlA9jvTSZfp/FCyKX/v961i7Led93z3nP2bPP7u/M/OfsOWd3n//ze5b3fOfPs7s/8QgPAgQIECBAgAABAgQIECBAgAABAgRaCfxEq7WsRIAAAQIECBAgQIAAAQIECBAgQIDAIxTTHAQECBAgQIAAAQIECBAgQIAAAQIEWgooprWEshoBAgQIECBAgAABAgQIECBAgAABxTTHAAECBAgQIECAAAECBAgQIECAAIGWAoppLaGsRoAAAQIECBAgQIAAAQIECBAgQEAxzTFAgAABAgQIECBAgAABAgQIECBAoKWAYlpLKKsRIECAAAECBAgQIECAAAECBAgQUExzDBAgQIAAAQIECBAgQIAAAQIECBBoKaCY1hLKagQIECBAgAABAgQIECBAgAABAgQU0xwDBAgQIECAAAECBAgQIECAAAECBFoKKKa1hLIaAQIECBAgQIAAAQIECBAgQIAAAcU0xwABoJjWMbjmCBAgQIAAAQIECBAgQIAAAQIEyhVQTCt37GROgAABAgQIECBAgAABAgQIECDQsYBiWsfgmiNAgAABAgQIECBAgAABAgQIEChXQDGt3LGTOQECBAgQIECAAAECBAgQIECAQMcCimkdg2uOAAECBAgQIECAAAECBAgQIECgXAHFtHLHTuYECBAgQIAAAQIECBAgQIAAAQIdCyimdQyuOQIECBAgQIAAAQIECBAgQIAAgXIFFNPKHTuZEyBAgAABAgQIECBAgAABAgQIdCygmNYxuOYIECBAgAABAgQIECBAgAABAgTKFVBMK3fsZE6AAAECBAgQIECAAAECBAgQINCxgGJax+CaI0CAAAECBAgQIECAAAECBAgQKFdAMa3csZM5AQIECBAgQIAAAQIECBAgQIBAxwKKaR2Da44AAQIECBAgQIAAAQIECBAgQKBcAcW0csdO5gQIECBAgAABAgQIECBAgAABAh0L/D9S+8lzAOsdUQAAAABJRU5ErkJggg==";
var picture = "{\pict\pngblip\picw1693\pich1693\picwgoal960\pichgoal960" + imagedata; 
```

然后我将字符串分配给富文本框（我只是想证明 rtf 文件有效的示例 winforms 应用程序）。

```
this.richTextBox1.Rtf = rtf; 
```

什么都没有显示 =(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-01T14:20:49.703

我发现您正在尝试做的事情有两个主要问题。首先，RTF 要求媒体进行十六进制编码，而不是 Base64。因此，首先将您的图像数据转换为十六进制字符串。然后您需要更改在 RTF 中创建图片的方式。一个微小的变化，但它应该有所作为。将您的 var 图片更改为：

```
var picture = "{\pict\picw1693\pich1693\picwgoal960\pichgoal960\pngblip" + imagedata; 
```

\pngblip 是告诉 RTF 阅读器接下来是图片数据的内容。

# capybara - Capybara：如何使用 xpath 和 css 检查元素的 TEXT 值？

> ID：13850303
> 
> 赞同：19
> 
> 时间：2012-12-12T23:13:57.407
> 
> 标签：capybara

试图让这个测试失败而没有成功。

我有这个 HTML：

```
<div id="navigation">
 <ul>
  <li>
   <a href="/url">TV</a> 
```

然后我试图识别 A 元素的文本并使其暂时失败。

我已经在 Xpath 中使用了以下所有表达式，但即使我使用不同的文本进行比较，它们也会继续传递：S

```
page.should have_xpath("//div[@id='navigation']//a", :content => 'Radio')
page.should have_xpath("//div[@id='navigation']//a", :text => 'Radio')
page.should have_xpath("//div[@id='navigation']//a[contains(string(),'Radio')]")
page.should have_xpath("//div[@id='navigation']//a[contains(text(),'Radio')]")
page.should have_xpath("//div[@id='navigation']//a[contains(.,'Radio')]") 
```

知道如何使用 capybara 识别特定 HTML 元素的文本吗？并且...是否可以使用 CSS 实现相同的效果？

干杯!

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2015-12-05T12:27:08.280

从 RSpec 2.11（2012 年 7 月）开始，首选方法是使用以下`expect`语法：

```
expect(page).to have_css("#navigation a", text: "Radio") 
```

您可以[将 RSpec 配置](http://betterspecs.org/#expect)为仅接受这种新语法以保持代码库的一致性。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-12-15T15:18:43.947

事实证明，“导航”DIV 中有另一个带有文本“Radio”的元素，因此导致测试失败。

以供将来参考，识别第一个元素显式地按预期运行并且未通过测试：

```
page.first('div#navigation a').text.should == 'Radio')
page.first('div#navigation a').text.should eq('Radio')
page.first('div#navigation a').text.should match('Radio')
page.first('div#navigation a').text.should be('Radio') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T13:39:36.750

它会帮助你：

> page.should have_css('div#navigation a', :text == 'Radio')

尝试这个。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-02-28T18:37:30.130

使用 `have_selector`

`expect(page).to have_selector("#navigation a", text: "Radio")`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-10-16T08:29:52.650

也许你可以使用这个：

```
expect(page).to have_xpath("//*[@href='']", text: 'TV') 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-02-10T11:45:16.700

把它放在这里，以便下次遇到它时可以找到它。:P

我的 html 看起来像这样：

```
<a href="https://foo.com" id="foo-link">@foo</a> 
```

我想找到文本和 url 值并断言它们是正确的。使用 Capybary 2.16、Rails 5.1 和 minitest 我是这样做的：

```
assert_selector 'a#foo-link[href="https://foo.com"]', text: '@foo' 
```

如果 ID、文本或 href 值更改，测试将失败。

# ios - jQuery mobile 和 phoneGap 中的原生 IOS select(UITableview) 自动打开

> ID：13850310
> 
> 赞同：1
> 
> 时间：2012-12-12T23:14:45.173
> 
> 标签：ios, cordova, jquery-mobile, select

我正在IOS上使用jQuery mobile开发phoneGap，其中一个页面包括JQM native select menue'我的问题是当页面加载时选择加载打开并且它没有数据，因为它在页面之前初始化并且我尝试滚动时出现异常，问题是我可以阻止它打开吗，我正在处理这个问题 2 天'有人知道吗

# image - 如何在 Wordpress 中添加特色图片标题

> ID：13850313
> 
> 赞同：5
> 
> 时间：2012-12-12T23:15:21.460
> 
> 标签：image, wordpress, featured, captions

我希望有人可以帮助我解决问题。我正在为我的一个朋友建立一个新闻网站。该网站开始合并，但我不知道如何为特色图片添加标题。我今天一直在网上寻找，有很多方法可以通过向 php 表中添加代码来做到这一点，但我不确定我在做什么。

我已经在 functions.php 代码中添加了这样的代码，但一切都是成对的。

我一直在祈祷，有人可以通过键入我的操作来帮助我。

预先感谢您的帮助。

亲切的问候

约翰

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-13T00:08:07.407

首先，您需要在 functions.php 文件中删除以下代码：

```
function the_post_thumbnail_caption() {
  global $post;

  $thumbnail_id    = get_post_thumbnail_id($post->ID);
  $thumbnail_image = get_posts(array('p' => $thumbnail_id, 'post_type' => 'attachment'));

  if ($thumbnail_image && isset($thumbnail_image[0])) {
    echo '<span>'.$thumbnail_image[0]->post_excerpt.'</span>';
  }
} 
```

将其粘贴在该文件中的结束 PHP 标记之前，如果没有结束 PHP 标记，请确保您粘贴的代码下方没有空行，因为这可能会导致问题。

然后，您希望在哪里显示标题，您需要使用以下命令调用它：

`<?php the_post_thumbnail_caption(); ?>`

如果您不确定将调用放在模板文件中的哪个位置，`<?php the_post_thumbnail(); ?>`则需要找到调用位置。只需在模板文件中查找该行，然后将函数调用放在它附近，即您希望显示标题的位置。该函数自动将标题包装在 span 标签中，因此您可以使用 CSS 定位它，但您也可以将函数调用包装在您想要的任何标签中。

因此，例如，如果您的模板文件使用此或非常类似的方式调用特色图像：

```
<?php 
    if ( has_post_thumbnail() ) {
        the_post_thumbnail();
} ?> 
```

您想像这样添加标题调用：

```
<?php 
    if ( has_post_thumbnail() ) {
        the_post_thumbnail();
} ?>
<?php the_post_thumbnail_caption(); ?> 
```

如果您需要任何其他说明，请告诉我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-17T18:51:44.990

我知道这是一个老问题，但我想提供其他人可能更喜欢的另一种解决方案，如果您希望在使用 WordPress 中已经可用的字段时处理已经可用的数据（更少的数据库调用）。

由于输出`get_the_post_thumbnail()`将整个 img 标记作为字符串返回，其中 alt 标记从标题字段中预先填充，因此您可以使用 xml 解析器或正则表达式简单地提取图像标记的 alt 标记。

我这样做了：

```
 <?php 
    if ( $featured = get_the_post_thumbnail( get_the_ID() ) ):

        echo $featured; 
        preg_match('/alt="(.*)"/i', $featured, $caption);

        if ($caption) {
            echo wpautop(array_pop($caption));
        }
    endif;
    ?> 
```

如果您希望它在最初接受的答案之类的函数中，则将 img 标签直接传递给您的函数：

```
 function get_the_post_thumbnail_caption($img_tag) {
        preg_match('/alt="(.*)"/i', $img_tag, $caption);
        return array_pop($caption);
    } 
```

在模板中：

```
 $img = get_the_post_thumbnail( get_the_ID() ); // or any id
    echo wpautop( get_the_post_thumbnail_caption( $img ) ); 
```

请注意，如果您填充 'alt text' 字段，它将在输出 img 标签时覆盖标题字段数据。如有必要，您可以使用过滤器覆盖该行为。

# visual-studio-2010 - 在 VS2010 中打开 rc 文件时出现“指南必须指定类型”错误

> ID：13850314
> 
> 赞同：2
> 
> 时间：2012-12-12T23:15:27.873
> 
> 标签：visual-studio-2010, visual-studio, mfc

我有一个 MFC 项目，其中一切工作正常，我在源代码控制 (perforce) 中签入了我的代码。突然之间，.rc 文件无法打开。当我尝试打开时，它给出了一个错误`Guideline must specify type`@ line# 410 这是这样的：

```
#ifdef APSTUDIO_INVOKED
GUIDELINES DESIGNINFO
BEGIN
    IDD_ABOUTBOX, DIALOG
    BEGIN
        , 50
    END 
```

现在，当我将它与其他项目进行比较时，它似乎确实缺少一个条目，但我没有手动更改 rc 文件中的任何内容，VS2010 一直在专门处理它。我不知道这些条目何时更改。我得到了从 perforce 到新文件夹的所有内容，但 rc 文件仍然无法打开！有没有更好的解决方案，还是我必须手动更改条目以希望它能修复它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T19:07:29.827

原来 rc 文件在某些​​时候被 VS2010 损坏了。我在源代码管理中拥有原始版本并手动重新合并它们以修复它。更正后的代码如下所示：

```
GUIDELINES DESIGNINFO
BEGIN
    IDD_ABOUTBOX, DIALOG
    BEGIN
        LEFTMARGIN, 7
        RIGHTMARGIN, 163
        TOPMARGIN, 7
        BOTTOMMARGIN, 55
    END
END 
```

当您复制/粘贴对话框以创建新对话框时，VS2010 似乎随机损坏了 rc 文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-29T09:48:53.003

经常被这个问题困扰后，我找到了VS2010有时会炸毁资源文件的设计信息的原因：在我的情况下，一个对话框的剩余设计信息条目不再存在，甚至IDD_常数已经消失了。VS2010 不会对此抛出错误，而是加载垃圾。

仅用于谷歌索引：德语错误消息是“Führungslinie muss Typangabe enthalten”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-02-15T07:19:35.427

我发现如果之前创建了一个对话框，但在 .rc 文件中手动更改了对话框的 ID，那么 .rc 文件中的对话框定义会导致损坏。因此，我查看了 .rc 文件的先前工作版本，发现在 resource.h 文件中不再定义的对话框 ID 并将其从 .rc 文件中删除。我还发现对话框的 GUIDELINES DESIGNINFO 部分可以是空的，即完全没有任何边距信息的对话框定义是可以的。GUIDELINES DESIGNINFO 块中的未知对话框定义将导致 VS2010 生成条目“,50”，这将使其他对话框出现额外的虚线框或紫色背景。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-03T21:52:51.277

Guidline 的“类型”必须在值之前指定。它应该是以下之一：

`LEFTMARGIN, RIGHTMARGIN, TOPMARGIN, BOTTOMMARGIN, VERTGUIDE, HORZGUIDE`

您的代码将是这样的：

```
IDD_INSTRUMENT_DIALOG, DIALOG
BEGIN
    BOTTOMMARGIN, 50
END 
```

# html - 表单标签不应该存在于头部标签中是否有充分的理由？

> ID：13850317
> 
> 赞同：0
> 
> 时间：2012-12-12T23:15:46.017
> 
> 标签：html

表单标签不应该存在于头部标签中是否有充分的理由？

我正在查看此[http://www.w3.org/html/wg/drafts/html/master/forms.html#the-form-element](http://www.w3.org/html/wg/drafts/html/master/forms.html#the-form-element) 但我找不到与此问题相关的任何内容。

这对我有用：

```
<head runat="server">
<title></title>
<form id="form1" runat="server">
   <asp:ScriptManager ID="ScriptManager1" runat="server"></asp:ScriptManager>
</form>
    <link rel="stylesheet" href="http://ajax.aspnetcdn.com/ajax/jquery.mobile/1.2.0/jquery.mobile-1.2.0.min.css" />

    <script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.8.2.min.js"></script>
    <script src="http://ajax.aspnetcdn.com/ajax/jquery.mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>

</head> 
```

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T01:22:56.103

如果您在 IE 以外的浏览器中查看[http://software.hixie.ch/utilities/js/live-dom-viewer/saved/2014](http://software.hixie.ch/utilities/js/live-dom-viewer/saved/2014)（这里有一个非常奇怪的错误），您会看到您的表单元素实际上不在 head 元素内。当解析器看到`<form>`标签时，它会自动关闭`<head>`元素，创建`<body>`元素并将`<form>`元素和所有后续元素放入该`<body>`元素中。

因为这种行为是向后兼容现有网页所必需的，所以不能更改规范以允许`<form>`head 中的元素，即使这样做有很好的用例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-12T23:29:45.003

用于显示的 HTML 属于`<body>`标记。

有些浏览器仍然会显示一些放在标签中的`<head>`标签，但这不是它所属的地方，如果你把它放在那里，你会要求互操作性问题。

在您引用的规范链接中，它说`<form>`标签去`flow content`预期的地方。如果单击`flow content`，它指的是文档正文中使用的元素。正文是`<body>`标签中的内容。

# r - R中“查找和删除”完整字符串而不是子字符串的代码？

> ID：13850318
> 
> 赞同：0
> 
> 时间：2012-12-12T23:15:50.710
> 
> 标签：r, data-cleaning

我试图找到一种基于某些字符串的出现快速清理大型数据集的方法。我有一个如下所示的 data.frame：

```
created_at  actor_attributes_email      type
3/11/12 7:28    jeremy@asynk.ch         Event
3/11/12 7:28    jeremy@asynk.ch         PushEvent
3/11/12 7:28    jeremy@asynk.ch         PushEvent
3/11/12 7:42    jeremy@asynk.ch         IssueCommentEvent
3/11/12 11:06   d.bussink@gmail.com     PushEvent
3/11/12 11:06   d.bussink@gmail.com     PushEvent 
```

[您可以在此处](https://github.com/aronlindberg/VOSS-Sequencing-Toolkit/blob/master/rubinius_rubinius_sequencing/input.csv)找到完整的 CSV 。

我正在为“在 R 中查找和删除”编写命令：

```
# Load CSV file
events.raw <- read.csv(file = "input.csv", header = TRUE)

# Delete events called "Event"
events.raw.new <- events.raw[!grepl("Event", events.raw$type, fixed = TRUE),] 
```

我的代码现在删除了每一行，我不太确定，因为我使用的是 fixed = TRUE 参数。我想要的是删除“Event”是完整字符串的所有行，因为它是每一行中的子字符串。如何限制我的代码以完成字符串？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T00:53:51.253

这个问题的一个答案是：

```
events.raw <- subset(events.raw, type!="Event") 
```

但是，这并不能解决问题

```
events.raw.new <- events.raw[!grepl("Event", events.raw$type, fixed = TRUE),] 
```

没有达到同样的目的。

# python - 更改 GnuplotPy 直方图中的条形颜色？

> ID：13850320
> 
> 赞同：2
> 
> 时间：2012-12-12T23:16:05.873
> 
> 标签：python, gnuplot, data-visualization

我正在用 GnuplotPy 绘制一些直方图，我想更改直方图条的颜色。（默认情况下，条形图是红色的。）[这个 StackOverflow 帖子](https://stackoverflow.com/questions/12224545/gnuplot-change-color-of-bars-in-histogram)中的答案提供了几个关于如何在普通 Gnuplot 中更改直方图条形图颜色的选项，但我无法让这些解决方案在 GnuplotPy 中工作。

这是我正在使用的基本设置：

```
import Gnuplot

gp = Gnuplot.Gnuplot(persist = 1)
gp('set ylabel "Accuracy"')
gp('set format x " "') #remove the auto-generated xtics labels 
gp('set xtics scale 0') #remove xtic marks. 
gp(r'set xtics add ("Method 1" 0.15) ("Method 2" 1.15)')
dataToPlot = [6.9, 47.6]

gp('set style data histograms')
gp('set style fill solid 1.0 border -1')
plot1 = Gnuplot.PlotItems.Data(dataToPlot)

gp.plot(plot1)
gp.hardcopy('hist_example.eps',terminal = 'postscript', enhanced=1, color=1) #must come after plot() function
gp.reset() #must be placed after hardcopy() 
```

上面的代码没有尝试设置直方图条的颜色，而是生成了一个带有红色条的直方图：

![在此处输入图像描述](../Images/3ed7d92b4b0bf6bd810d0034d45c736a.png)

* * *

我尝试了几件事来将直方图条的颜色更改为蓝色，但都没有成功。

首先，按照 mgilson 在[此线程](https://stackoverflow.com/questions/12224545/gnuplot-change-color-of-bars-in-histogram)中的建议，我尝试添加以下行，但它会引发错误并且条形仍然呈红色：

```
gp('set style lc rgb "blue"') #throws this error: line 0: expecting 'data', 'function', 'line', 'fill' or 'arrow' 
```

我还尝试了对代码进行以下修改，但它在没有生成绘图的情况下引发了错误：

```
plot1 = Gnuplot.PlotItems.Data(dataToPlot, with_="linecolor rgb 'blue'")  #throws this error: plot "/var/folders/98/st7ct15n227g1p92mljkx93m0000gq/T/tmp875mRk.gnuplot/fifo" notitle with linecolor rgb 'blue' ^ line 0: expecting 'lines', 'points', 'linespoints', 'dots', 'impulses',    'yerrorbars', 'xerrorbars', 'xyerrorbars', 'steps', 'fsteps',   'histeps', 'filledcurves', 'boxes', 'boxerrorbars', 'boxxyerrorbars',   'vectors', 'financebars', 'candlesticks', 'errorlines', 'xerrorlines',  'yerrorlines', 'xyerrorlines', 'pm3d', 'labels', 'histograms',   'image', 'rgbimage' 
```

* * *

**那么，如何更改 GnuplotPy 中的直方图条颜色？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T13:37:55.310

另一种可能会起作用的黑客方法是：

```
plot1 = Gnuplot.PlotItems.Data(dataToPlot, with_="histograms linecolor rgb 'blue'") 
```

在我看来，`gnuplot-py`应该允许一些语法，如：

```
plot1 = Gnuplot.PlotItems.Data(dataToPlot, with_="histograms",linecolor="rgb 'blue'") 
```

或类似的东西。我现在没有一个好的测试用例可以试验......

# java - 从文件名中截断字符串

> ID：13850322
> 
> 赞同：1
> 
> 时间：2012-12-12T23:16:17.447
> 
> 标签：java, string

我之前写过一个代码，一旦文件保存在目录中，我就会在其中添加时间戳。现在我希望能够从扩展名 .txt 之后的文件中截断时间戳，注意我的时间戳格式是：_yyyy-mm-dd。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-12T23:20:53.400

如果您在表格中有延期后的日期，则`_yyyy-mm-dd`可以使用

```
String strippedFileName = fileName.substring(0, fileName.length() - 11); 
```

或者更好一点

```
String dateFormatString = "_yyyy-mm-dd";
String strippedFileName = fileName.substring(0, fileName.length() - dateFormatString.length()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T23:31:48.533

You could also do this:

```
String trimmed = filename.replaceAll(".{11}$", ""); 
```

# r - 自定义图形的 x 轴

> ID：13850329
> 
> 赞同：1
> 
> 时间：2012-12-12T23:02:10.153
> 
> 标签：r, ggplot2

我正在使用`scale_x_discrete()`自定义 x 轴的刻度和标签。

但是，如图所示，这些线切割了右侧的 y 轴，这对我来说看起来不太好。你能帮我解决这个问题吗？数据（温度）也如下所示。

```
> a = ggplot(data = temp, aes(b, c, group=a,shape=a,colour=a), ordered=TRUE) + geom_line() + geom_point() 
> a
> b = a + scale_x_discrete(breaks = c("2","4","8","16","32","64","128"), labels=c("2","4","8","16","32","64","128"))

> temp
       a   b    c
1    One   2  5.1
2    One   4  6.6
3    One   8  7.7
4    One  16  8.4
5    One  32 16.1
6    One  64 38.0
7    One 128 49.2
8    Two   2  5.9
9    Two   4  7.7
10   Two   8  9.2
11   Two  16 10.3
12   Two  32 16.8
13   Two  64 32.4
14   Two 128 45.7
15 Three   2  4.7
16 Three   4  7.0
17 Three   8  8.5
18 Three  16  9.6
19 Three  32 14.8
20 Three  64 31.0
21 Three 128 34.5
22  Four   2  4.3
23  Four   4  6.9
24  Four   8  8.3
25  Four  16  9.1
26  Four  32 14.0
27  Four  64 23.8 
```

![在此处输入图像描述](../Images/fe8ce9908840940dfe764914a2c45835.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-12T23:15:25.713

你为什么要使用离散比例来表示似乎是连续的。

如果您替换`scale_x_discrete`为`scale_x_continuous`then 这应该可以按您的意愿工作。

```
b <- a + scale_x_continuous(breaks = 2^(1:7))
b 
```

![在此处输入图像描述](../Images/8ab7a93ec27935478be2efff6f035c84.png) 您可能对以 2 为底的转换感兴趣，因为您的数据`b`似乎只是 2 的整数幂。

```
a + scale_x_continuous(breaks = 2^(1:7), trans = 'log2') 
```

![在此处输入图像描述](../Images/4958b663a9cc8f0aec6cf5a18f6cc61b.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-12T23:20:40.417

ggplot 网站也有“扩展”参数。将数字调整为您想要达到的任何外观

```
a + scale_x_discrete(breaks = c("2","4","8","16","32","64","128"),
                     labels=c("2","4","8","16","32","64","128"),
                     expand = c(.1,.1)) 
```

# c# - ArrayList 变为空

> ID：13850332
> 
> 赞同：1
> 
> 时间：2012-12-12T23:17:04.860
> 
> 标签：c#, asp.net, arraylist, nullreferenceexception

我正在使用 ASP.NET 开发一个 Web 应用程序。我有一个名为“Sistema”的类，它使用单例模式。

创建 Sistema 实例时，会打开数据库连接并运行一个进程，将一些静态信息加载到多个 ArrayList 中以供以后使用。

```
private ArrayList list1;
private ArrayList list2;
private static Sistema instance;
private Sistema()
{
    OpenDataBase();
    list1 = LoadStaticInformationFromDataBase();
    list2 = LoadOtherStaticInformationFromDataBase();
}

public static Sistema GetInstance()
{
    if (instance == null)
    {
        instance = new Sistema();
    }
    return instance;
} 
```

在一天中，新对象被添加到每个 ArrayList。在过去的几天里，突然其中一个 ArrayList 变为 null，因此整个站点停止工作。

我无法确定为什么这变为空。

是不是 ArrayList 达到了最大数量？例如，现在它有超过 150.000 个对象。

在 Global.asax 文件的 Application_Error 方法中，我添加了一段代码，该代码将每个错误作为日志存储在 txt 文件中。但是，当时没有错误。

关于为什么会发生这种情况的任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-12T23:20:42.393

只要 ASP.NET 工作进程存在，类的静态字段就存在。一旦 ASP.NET 工作进程被回收，您将丢失所有静态数据。

# jquery - 点击后Jquery .dialog禁用提交按钮

> ID：13850333
> 
> 赞同：0
> 
> 时间：2012-12-12T23:17:12.917
> 
> 标签：jquery, jquery-ui, wordpress

我正在定制一个 wordpress 主题。当用户单击提交按钮时，它应该被禁用。

我不知道该怎么做。这是代码。有人可以告诉我如何做到这一点。

```
jQuery('.modal-content').dialog({
                autoOpen: false, 
                title: 'Confirm your Res', 
                resizable: false,
                height: 175,
                width: 300, 
                modal: true, 
                buttons: {
                    Submit: function() {                                    

                        jQuery('form[name="booking-form"]').get(0).submit();
                    }, 
                    Cancel: function() {
                        jQuery(this).dialog("close");

                    }
                }
            }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-07T16:32:51.767

我在我的网站上使用此代码。

```
$("#dialog-alert").dialog({
    autoOpen: false,
    width: 320,
    modal: true,
    buttons: {
        Submit: function (e) {
            // Disable button
            $(e.target).attr("disabled", true);

            // Write your code here

            // Enable button
            $(e.target).removeAttr("disabled");
        }
    },
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-12T23:18:58.930

```
$('.submit').click(function(event) {
 event.preventDefault();
}); 
```

或见

[禁用表单提交上的提交按钮](https://stackoverflow.com/questions/5691054/disable-submit-button-on-form-submit)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-01T19:19:32.893

一旦用户单击“确定”按钮，这将禁用弹出窗口上的所有按钮。

```
 $(popupHtml).dialog({
    title: "Add an Absence",
    width: 750,
    height: 300,
    buttons: {
        "Ok": function () {
            $(this).parent().find('button[role=button]').attr('disabled', 'disabled');
} 
```

}

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-02T07:57:19.783

您还可以包含禁用的样式以使它们看起来已禁用

```
buttons: {
    "Ok": function () {
        $(this).parent().find('button[role=button]').attr('disabled', 'disabled').addClass('ui-state-disabled'); 
```

或者，您可以使用例如背景“加载”动画创建自己的类。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-12T23:21:53.177

提交表单后，这将“禁用”按钮：

```
jQuery('.modal-content').dialog({
            autoOpen: false, 
            title: 'Confirm your Res', 
            resizable: false,
            height: 175,
            width: 300, 
            modal: true, 
            buttons: {
                Submit: function() {                                    
                    jQuery('form[name="booking-form"]').get(0).submit($("form[name='booking-form'] input[type=submit]").attr("disabled", "disabled"));
                }, 
                Cancel: function() {
                    jQuery(this).dialog("close");

                }
            }
        }); 
```

# c# - 从一个主字符串中获取不同的子字符串

> ID：13850334
> 
> 赞同：3
> 
> 时间：2012-12-12T23:17:16.067
> 
> 标签：c#, regex, string, substring

我有以下包含链接名称和链接 URL 的主字符串。名称和 url 与`#;`. 我想获取每个链接的字符串（名称和 url 即`My web#?http://www.google.com`），请参见下面的示例

```
string teststring = "My web#;http://www.google.com My Web2#;http://www.bing.se Handbooks#;http://www.books.se/"; 
```

我想使用任何字符串函数获得三个不同的字符串：

*   我的网站#?http://www.google.com
*   我的 Web2#?http://www.bing.se
*   手册#?http://www.books.de

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-12T23:25:47.680

所以这看起来你想在 a 之后的空间上`#;`拆分，而不是在`#;`自身上拆分。C# 提供了任意长度的lookbehinds，这很容易。实际上，您可能应该先替换`#;`with `#?`：

```
string teststring = "My web#;http://www.google.com My Web2#;http://www.bing.se Handbooks#;http://www.books.se/";
teststring = Regex.Replace(teststring, @"#;", "#?");
string[] substrings = Regex.Split(teststring, @"(?<=#\?\S*)\s+"); 
```

而已：

```
foreach(var s in substrings)
    Console.WriteLine(s);

Output:
My web#?http://www.google.com
My Web2#?http://www.bing.se
Handbooks#?http://www.books.se/ 
```

如果您担心您的输入可能已经包含`#?`您不想拆分的其他内容，您当然可以先进行拆分（`#;`在模式中使用），然后循环`substrings`并在循环内进行替换调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T00:10:54.820

如果您对输入格式有任何控制，您可能希望将其更改为易于解析，例如通过在项目之间使用另一个分隔符，而不是空格。

如果这种格式不能改变，为什么不直接在代码中实现拆分呢？它不像使用正则表达式那么短，但实际上它可能更容易让读者理解，因为逻辑很简单。

就内存使用而言，这几乎肯定会更快、更便宜。

解决此问题的代码示例如下：

```
static void Main(string[] args)
{
    var testString = "My web#;http://www.google.com My Web2#;http://www.bing.se Handbooks#;http://www.books.se/";

    foreach(var x in SplitAndFormatUrls(testString))
    {
        Console.WriteLine(x);
    }
}

private static IEnumerable<string> SplitAndFormatUrls(string input)
{
    var length = input.Length;
    var last = 0;
    var seenSeparator = false;
    var previousChar = ' ';

    for (var index = 0; index < length; index++)
    {
        var currentChar = input[index];

        if ((currentChar == ' ' || index == length - 1) && seenSeparator)
        {
            var currentUrl = input.Substring(last, index - last);
            yield return currentUrl.Replace("#;", "#?");

            last = index + 1;
            seenSeparator = false;
            previousChar = ' ';
            continue;
        }

        if (currentChar == ';' && previousChar == '#')
        {
            seenSeparator = true;
        }

        previousChar = currentChar;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-12T23:24:41.460

如果这些是常量字符串，您可以使用`String.Substring`. 这将要求您计算字母，这是一件很麻烦的事情，以便提供正确的参数，但它会起作用。

```
string string1 = teststring.Substring(0, 26).Replace(";","?"); 
```

如果不是，事情就会变得复杂。您几乎可以使用“”作为分隔符进行拆分，除了您的站点名称有一个空格。您的数据中的任何子字符串是否具有不变的特征，例如域结尾（即首先是 .com，然后是 .de 等）或类似的东西？

# android - 将textivew动态添加到android中的listview仅显示参考

> ID：13850339
> 
> 赞同：0
> 
> 时间：2012-12-12T23:17:44.833
> 
> 标签：android

我正在尝试将文本视图动态添加到列表视图，如下所示。我看到列表视图中出现了项目，但它们显示如下

```
android.widget.TextView@44f076d0
android.widget.TextView@44f07b58
android.widget.TextView@44f07f50
etc...

   ArrayList<TextView> tv = new ArrayList<TextView>();
        for(int i=0; i < 10; i++){
            TextView t = new TextView(this);
            t.setText("hi there");
            tv.add(t);

        }
        ArrayAdapter<TextView> wordAdapter = new ArrayAdapter<TextView>(this,
                android.R.layout.simple_list_item_1, android.R.id.text1,
                tv);

        this.articleListView.setAdapter(wordAdapter); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T23:23:27.050

那是因为您在参数中传递了 TextView 对象的 ArrayList 以获取 Adapter 应**显示**的内容。因此，您的`tv`列表对象正在`toString()`调用它们的方法。`toString()`对于 TextViews 会给你`TextView@number`所以这是预期的。将您的 ArrayList 更改`tv`为 的 ArrayList `String`，不要创建任何新的 TextView，只需传递新的 String ArrayList 而不是`tv`. 您的文本将显示正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T04:39:23.320

你可以对你的数组列表进行排序

```
Collections.sort(list, String.CASE_INSENSITIVE_ORDER); 
```

# knockout.js - css绑定'0 1 2 3 4'而不是'video'的问题

> ID：13850340
> 
> 赞同：0
> 
> 时间：2012-12-12T23:17:48.730
> 
> 标签：knockout.js

css 绑定的问题，它在应用程序中很深，但我会尝试提取错误来摆弄，除非.....（手指交叉）你知道或可以从下面猜到发生了什么，看起来你可以在下面看到我已经得到它呈现我要添加的类字符串的字符索引，显然不是我们想要的：

**模板：**

```
<section data-bind="css: type" class="toolbox-tool">
<span data-bind="text: type"></span>
<label data-bind="attr: {for: id}"/>
<img data-bind="attr: {src: imageSource}"/>
</section> 
```

渲染的标记

```
<section data-bind="css: type" class="toolbox-tool 0 1 2 3 4 5 6 7 8 9 10 ui-draggable">
<span data-bind="text: type">text-ticker</span>
<label data-bind="attr: {for: id}" for="2"></label>
<img data-bind="attr: {src: imageSource}" src="#">
</section> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T23:25:43.857

需要淘汰赛版本 2.2 或更高版本。

可以发誓我有最新版本的淘汰赛。哎呀，猜不到。

# javascript - 通过 HTML 用于移动应用程序的高性能 JavaScript 图表 API

> ID：13850343
> 
> 赞同：28
> 
> 时间：2012-12-12T23:17:54.283
> 
> 标签：javascript, html, mobile, charts

我正在通过 MoSync 开发跨平台移动应用程序。关于显示数据的 JavaScript 图表来自移动设备中的蓝牙，我需要一个具有非常高的渲染速度和性能的 JavaScript 图表 API。它应该足够快来绘制/重绘/更新图表，因为数据将被注入 Webview。AFAIK 测试了几个 API，数据注入降低了移动应用程序的速度。FFI，以下几点可能有助于显示图表应该多快才能在应用程序中顺利运行。

1.  **更新：**每 500 毫秒或可能 250 毫秒
2.  **每次更新的新数据：**三个系列的大小为 50 的三个数组
3.  **数据遍历**（从蓝牙到图表API）：c++ >> UI (HTML) >> WebView >> chart API

请注意，我知道大量可用的 JavaScript 图表 API，但是我需要一条考虑到解释情况的建议。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-12-19T01:25:29.280

下面你会发现我的研究。希望这可以帮助您找到解决方案。

1.  [JavaScript 数据可视化库的比较](http://kraskniga.blogspot.com/2012/06/comparison-of-javascript-data.html)特别指出，[flotr2](http://www.humblesoftware.com/flotr2/index)是为性能而构建的。它于 2012 年 6 月发布。

    > **移动友好：**是的，专为性能而设计，包括触控事件/多点触控
    > 
    > **有趣的功能：**可扩展的插件框架，针对性能进行了调整。JSON api，可编程的交互性

2.  [RGraph](http://www.rgraph.net/javascript-charts)：专门解决性能和移动问题的显着解决方案。[他们有一整页分解了他们如何实现卓越的性能。](http://www.rgraph.net/docs/improving-performance.html)

3.  [JSXGraph](http://jsxgraph.uni-bayreuth.de/wp/)：比较文章[13 Chart and Graph plotting javascript plugins](http://www.queness.com/post/10781/13-chart-and-graph-plotting-javascript-plugins)指出“已特别注意优化性能”。但是，我在网站上没有看到任何有关移动支持的信息。

4.  > 你可能想看看这些：
    > 
    > [http://jsperf.com/search?q=chart](http://jsperf.com/search?q=chart)
    > 
    > 不过，我在那里看到的唯一对你有用的是弗洛特与拉斐尔。当然，您总是可以尝试在此基础上构建并为您感兴趣的其他库编写自己的测试。

    通过[https://stackoverflow.com/a/9900526/1085891](https://stackoverflow.com/a/9900526/1085891)

5.  不幸的是，[Javascript 图形和图表库](http://socialcompare.com/en/comparison/javascript-graphs-and-charts-libraries)比较没有性能标准，但我认为可能仍然有帮助。

6.  另一个通过 r/programming：[https ://canvasjs.com](https://canvasjs.com)

**额外：** [移动设备上的 JavaScript 性能](http://www.kendoui.com/blogs/teamblog/posts/11-10-07/javascript_performance_on_mobile_devices.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-31T06:58:05.853

[这是另一个名为CanvasJS](http://canvasjs.com)的高性能图表库

[它在100-200 毫秒](http://canvasjs.com/docs/charts/intro/high-performance-javascript-charts/)内呈现超过 100,000 个数据点。因为它基于 Canvas，所以它适用于大多数现代设备。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-17T15:44:26.507

我在具有大型数据集（最多 10000 个点）的[Highcharts图表库方面拥有出色的经验。](http://www.highcharts.com/)它使用 SVG 和 VML 进行渲染，这比基于画布的解决方案要快得多。另外，因为它不使用闪存，所以它可以在大多数移动设备上运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-19T13:33:20.043

查看[dygraphs](http://dygraphs.com/)，它有一个令人印象深刻的演示。在手机上简单测试了一下，感觉不错。

另见[相关项目的比较](https://www.openhub.net/p/compare?project_0=Flotr2&project_1=Flot&project_2=dygraphs&submit_2=Go)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-01-23T08:13:51.927

[LightningChart JS](https://www.arction.com/lightningchart-js/)具有 WebGL 渲染，并针对实时流数据进行了优化。对于 web，它提供了出色的性能，可以在保持高 FPS 速率的同时将数百万个数据点/秒添加到图表中。

*   [性能测试仪](https://www.arction.com/lightningchart-js-performance/)
*   [实时滚动数据](https://arction.github.io/lcjs-showcase-streamingData)
*   [波形和频谱计算示例](https://arction.github.io/lcjs-showcase-audio)

[我是 LightningChart 组件的技术负责人]

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-10-13T14:41:07.720

到目前为止，我已经找到了两个图表库，它们能够顺利处理 100k 点的数据集。（即使平移和缩放）

### PlotlyJS

我惊讶地发现[Plotly.js](https://github.com/plotly/plotly.js)在 SVG 模式下能够轻松处理 100k 点，实时平移和缩放：[https ://codepen.io/Venryx/pen/eYzpEzN](https://codepen.io/Venryx/pen/eYzpEzN)

Demo的核心代码如下：

```
const line = {
    x: [],
    y: [],

    // uncomment this line to disable the data simplify/decimate optimization
    //line: {simplify: false},

    // use 'scattergl' for WebGL renderer; though this seems to break updates to data
    type: 'scatter',
};

updateData(1000);
function updateData(yRange) {
    line.x = [];
    line.y = [];
    for (var i = 0; i < 100000; i++) {
      line.x.push(i);
      line.y.push(Math.sin(i / 500) * yRange);
    }

    // if calling a second time, add code here to update the chart (see demo)
}

Plotly.newPlot('graph', [line]); 
```

有一些基于 WebGL 的图表库具有更好的原始性能（即预数据抽取），例如[webgl-plot](https://github.com/danchitnis/webgl-plot)和[TimeChart](https://github.com/huww98/TimeChart)；然而，因为 Plotly.js 带有一个花哨的数据[抽取/简化选项](https://community.plotly.com/t/polyline-simplification/1600)，它最终提供了相当的性能。（并且比那些 WebGL 库的限制更少——例如，svg-mode Plotly 允许您在初始渲染后添加和编辑数据条目）

### uPlot

[uPlot](https://github.com/leeoniya/uPlot)是我发现的第二个图表库，可以轻松绘制 100k+ 数据集。

随着点数超过 100 万大关，它实际上甚至开始超过 Plotly 的响应能力。（尤其适用于使用“扩展数据”按钮进行缩放和添加/修改数据）

演示（旨在与上面的 Plotly 相匹配）：[https ://codepen.io/Venryx/pen/qBNOoYO](https://codepen.io/Venryx/pen/qBNOoYO)

（uPlot 现在是我为具有超大数据集（即 100 万+）的图表选择的库。）

# php - 关于数组使用 PHP json_encode

> ID：13850346
> 
> 赞同：-1
> 
> 时间：2012-12-12T23:18:04.953
> 
> 标签：php, ajax, arrays, json

```
$cnt = 0;
while ($row = $result->fetch_assoc()) 
{
    $arre[$cnt]['id'] = $row['idevents'];
    $arre[$cnt]['title'] = $row['title'];
    $arre[$cnt]['start'] = "new Date(" . $row['start'] . "*1000)";
    $arre[$cnt]['end'] = "new Date(" . $row['end'] . "*1000)";
    $arre[$cnt]['allDay'] = $row['allday'];
    $arre[$cnt]['url'] = $row['url'];
    $cnt++;
}

$year = date('Y');
$month = date('m');

echo json_encode(array(

array(
    'id' => 111,
    'title' => "Event1",
    'start' => "$year-$month-10",
    'url' => "http://yahoo.com/"
),

array(
    'id' => 222,
    'title' => "Event2",
    'start' => "$year-$month-20",
    'end' => "$year-$month-22",
    'url' => "http://yahoo.com/"
)

));

?> 
```

脚本底部的 json_encode 是一个示例。我需要获取 $arre 和 json_encode 中的数据。json_encode 的格式需要保持几乎完全相同，否则程序可能会觉得它不好吃，我的程序将无法运行。有谁知道正确的代码技术在这里是什么样的？

谢谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T23:26:16.930

如果您正在寻找正确的格式来使用 json_encode() 将数组返回给您的函数，这里有一个示例。使用键值对访问不同的成员：

此外，使用关联数组，以便您可以通过列名而不是整数值来迭代客户端上的元素。

```
while ($row = $result->fetch_assoc()) 
{
    $thisRow = array(
                     'id'     => $row['idevents'],
                     'title'  => $row['title'],
                     'start'  => date("F j, Y, g:i a", strtotime($row['start'])),
                     'end'    => date("F j, Y, g:i a", strtotime($row['end'])),
                     'allDay' => $row['allday'],
                     'url'    => $row['url']
    );
    array_push($arre, $thisRow);
}

return json_encode(
    array(
        "result" => "success", 
        "data" => $arre
    )
); 
```

然后在你的 javascript/jquery 中：

```
$.post("myPost.php", post_data,
    function(data) {
        // store data.result;
        // store data.data;
    }, 
"json"); 
```

# font-face - IE7 中的@font-face 问题

> ID：13850347
> 
> 赞同：0
> 
> 时间：2012-12-12T23:18:16.163
> 
> 标签：font-face, internet-explorer-7, webfonts

我迷上了一种名为“Kimberly”的字体，我正试图在网站的标题/座右铭上使用它。
应用`@font-face`css 规则适用于除 IE7 之外的所有浏览器，其中根本不显示标题，即使使用后备字体也不显示。

最令人讨厌的是，其他页面 [将 .ttf 字体转换为 .eot 后从 fontsquirrel.com 下载的示例页面] 在所有浏览器版本上都能完美运行。

有没有人经历过类似的事情？

[请看一下。](http://pelerinaje.tapet-online.ro)

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T23:24:34.607

尝试添加`zoom: 1`到使用您的自定义字体的元素。例如：

```
#motto {
    position: relative;
    top: 20px;
    color: #000;
    font-family: "kimberleyregular", Arial, sans-serif;
    font-style: normal;
    font-weight: normal;
    zoom: 1;
} 
```

# mysql - 运行 DELETE 语句时，为什么会收到 MySQL 警告 ER_BINLOG_UNSAFE_WRITE_AUTOINC_SELECT？

> ID：13850348
> 
> 赞同：1
> 
> 时间：2012-12-12T23:18:16.730
> 
> 标签：mysql, sql, warnings, auto-increment, sql-delete

我得到的确切警告是：

> 注意 | 第1592章 使用语句格式写入二进制日志的不安全语句，因为 BINLOG_FORMAT = STATEMENT。从另一个表中选择后写入具有自动增量列的表的语句是不安全的，因为检索行的顺序决定了将写入哪些（如果有）行。此顺序无法预测，并且可能在主从服务器上有所不同。

这个警告似乎是有道理的......没有意义的是我在运行 DELETE 语句时得到它，即类似于：

```
# Let's get extinct!
DELETE FROM dinosaurs
USING dinosaurs, eras
WHERE dinosaurs.id_era = eras.ida_era AND
    eras.era_name = "cretaceous" 
```

当我删除行时，为什么要从选择中订购？

所涉及的表都没有任何触发器......这可能只是一个 MySQL 错误吗？我的版本是：5.5.28-29.1-log

# android - 如何以字母模式对我的微调器进行排序？

> ID：13850349
> 
> 赞同：0
> 
> 时间：2012-12-12T23:18:18.077
> 
> 标签：android, eclipse, spinner, sorting, alphabetical

我已创建此代码以在我的微调器中创建一个列表。现在我想要按字母顺序排列的列表（例如 xxx、yyy、aaa 必须是 aaa、xxx、yyy）。我该怎么办？

```
public class MyAndroidAppActivity extends Activity {

      private Spinner spinner;
      private EditText Text;
      private ArrayAdapter<String> adapter;
      private Button addButton;

      public void onCreate(Bundle savedInstanceState)
      {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        Text = (EditText) findViewById(R.id.et);
        List<String> planets = new ArrayList<String>(Arrays.asList(getResources().getStringArray(R.array.clienti_arrays)));
        adapter = new ArrayAdapter<String>(this, android.R.layout.simple_spinner_item, planets);
        adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
        spinner = (Spinner) findViewById(R.id.spinner1);
        spinner.setAdapter(adapter);
        Collections.sort(planets);
        addButton = (Button) findViewById(R.id.add_new);
        addButton.setOnClickListener(new OnClickListener()
        {
          public void onClick(View v)
          {
            addNewSpinnerItem();
          }
        });
      }

      protected void addNewSpinnerItem()
      {
        String textHolder = "" + Text.getText().toString();
        adapter.add(textHolder);

      }
    } 
```

请帮帮我！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T23:39:27.547

你检查过文档吗？[ArrayAdapter 中](http://developer.android.com/reference/android/widget/ArrayAdapter.html#sort%28java.util.Comparator%3C?%20super%20T%3E%29)有sort 方法。

您只需要实现自己的比较器。我想这只是：

`int compare(String s1, String s2) { return s1.compareTo(s2); }`

:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T23:27:38.517

```
 addButton.setOnClickListener(new OnClickListener()
 {
      public void onClick(View v)
      {
        addNewSpinnerItem();
        Collections.sort(adapter);
      }
 }); 
```

也许？

# java - 有没有办法制作一个 bean 线程范围？

> ID：13850353
> 
> 赞同：2
> 
> 时间：2012-12-12T23:18:40.067
> 
> 标签：java, spring, singleton

我希望将一个对象绑定到一个单例范围的 Spring bean 中的当前线程。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-12T23:22:48.900

也许用 Spring 的[ThreadLocalTargetSource](http://static.springsource.org/spring/docs/3.1.3.RELEASE/javadoc-api/org/springframework/aop/target/ThreadLocalTargetSource.html)实现一个方面。[文档](http://static.springsource.org/spring/docs/3.1.3.RELEASE/spring-framework-reference/htmlsingle/spring-framework-reference.html#aop-ts-threadlocal)中对此进行了很好的解释：

> 如果您需要为每个传入请求（即每个线程）创建一个对象，则 ThreadLocal 目标源很有用。ThreadLocal 的概念提供了一个 JDK 范围的工具，可以在线程旁边透明地存储资源。设置 ThreadLocalTargetSource 与为其他类型的目标源解释的几乎相同：

```
<bean id="threadlocalTargetSource" class="org.springframework.aop.target.ThreadLocalTargetSource">
  <property name="targetBeanName" value="businessObjectTarget"/>
</bean> 
```

# c# - Solr：如何优先搜索特殊字符

> ID：13850356
> 
> 赞同：2
> 
> 时间：2012-12-12T23:18:50.387
> 
> 标签：c#, solr, solrnet

我是 Solr 的新手，并通过 SolrNet 使用它。当我发送 C# 的搜索查询时，它也匹配“C,C++”。

如何更优先考虑完全匹配 'C#' 的结果？或者请提出更好的解决方案来处理 Solr 查询中的此类特殊情况。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T06:49:21.997

您需要注意的几件事

1.  确保您转义特殊字符，如 +、-、、*
2.  确保将它们存储在没有分析器删除这些字符的字段中
3.  与完全分析的自由文本字段相比，为用于存储这些字符的字段提供更高的字段提升。

# xaml - 是否可以在 c++ cx Metro 应用程序中更改按钮文本颜色？

> ID：13850361
> 
> 赞同：0
> 
> 时间：2012-12-12T23:19:24.210
> 
> 标签：xaml, microsoft-metro, c++-cx

我有以下 XAML 代码

XAML：

```
<Button x:Name = "Btn1" Click = "Button_Click"> 
```

我可以在 Button_Click 方法或代码中的其他任何地方更改字体的颜色吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-12-19T02:38:48.617

您可以通过以下代码运行来实现它`directX 2013`：

```
void App2::DirectXPage::Button_Click(Platform::Object^ sender, Windows::UI::Xaml::RoutedEventArgs^ e) {
    bt->Foreground = ref new SolidColorBrush(Windows::UI::Colors::Blue);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T07:44:46.100

是的，您可以在代码中的任何位置更改按钮的颜色

这是一个示例按钮和一个示例代码，用于在其单击事件中更改颜色

这是在 btnChangeFontColor 的单击事件中更改颜色的代码

```
private void Button_Click_1(object sender, RoutedEventArgs e)
{
    btnChangeFontColor.Foreground = new SolidColorBrush(Colors.Red);
} 
```

# c++ - c++ new 运算符通过 libstdc++ 占用大量内存（67MB）

> ID：13850362
> 
> 赞同：6
> 
> 时间：2012-12-12T23:19:27.000
> 
> 标签：c++, gdb, malloc, new-operator, libstdc++

我`new`在`libstdc++`. 我用 C++ 编写了一个程序，但在内存管理方面遇到了一些问题。

在使用 gdb 进行调试以确定是什么占用了我的 ram 之后，我得到了以下信息`info proc mappings`

```
Mapped address spaces:

      Start Addr           End Addr       Size     Offset objfile
        0x400000           0x404000     0x4000          0                             /home/sebastian/Developement/powerserverplus-svn/psp-job-distributor/Release/psp-job-distributor
        0x604000           0x605000     0x1000     0x4000                             /home/sebastian/Developement/powerserverplus-svn/psp-job-distributor/Release/psp-job-distributor
        0x605000           0x626000    0x21000          0                                   [heap]
  0x7ffff0000000     0x7ffff0021000    0x21000          0        
  0x7ffff0021000     0x7ffff4000000  0x3fdf000          0       
  0x7ffff6c7f000     0x7ffff6c80000     0x1000          0        
  0x7ffff6c80000     0x7ffff6c83000     0x3000          0        
  0x7ffff6c83000     0x7ffff6c84000     0x1000          0        
  0x7ffff6c84000     0x7ffff6c87000     0x3000          0        
  0x7ffff6c87000     0x7ffff6c88000     0x1000          0        
  0x7ffff6c88000     0x7ffff6c8b000     0x3000          0        
  0x7ffff6c8b000     0x7ffff6c8c000     0x1000          0        
  0x7ffff6c8c000     0x7ffff6c8f000     0x3000          0        
  0x7ffff6c8f000     0x7ffff6e0f000   0x180000          0                     /lib/x86_64-linux-gnu/libc-2.13.so
  0x7ffff6e0f000     0x7ffff700f000   0x200000   0x180000                     /lib/x86_64-linux-gnu/libc-2.13.so
  0x7ffff700f000     0x7ffff7013000     0x4000   0x180000                     /lib/x86_64-linux-gnu/libc-2.13.so
  0x7ffff7013000     0x7ffff7014000     0x1000   0x184000                     /lib/x86_64-linux-gnu/libc-2.13.so 
```

那只是剪掉了它。不过，一切都很正常。其中一些属于标准库的代码，一些属于堆，还有一些是我创建的线程的堆栈部分。

但。有这一节我不知道为什么要分配它：

```
 0x7ffff0000000     0x7ffff0021000    0x21000          0        
  0x7ffff0021000     0x7ffff4000000  0x3fdf000          0 
```

这两个部分是在看似随机的时间创建的。有几个小时的调试时间没有相似性，也没有某个创建的线程左右。我设置了一个硬件观察点`awatch *0x7ffff0000000`并再次给了它几个`run`s。

这两个部分几乎同时在不可调试函数的同一代码部分中创建（gdb 在堆栈中将其显示为`in ?? () from /lib/x86_64-linux-gnu/libc.so.6`）。更准确地说，这是它发生的示例堆栈：

```
#0  0x00007ffff6d091d5 in ?? () from /lib/x86_64-linux-gnu/libc.so.6
#1  0x00007ffff6d0b2bd in calloc () from /lib/x86_64-linux-gnu/libc.so.6
#2  0x00007ffff7dee28f in _dl_allocate_tls () from /lib64/ld-linux-x86-64.so.2
#3  0x00007ffff77c0484 in pthread_create@@GLIBC_2.2.5 () from /lib/x86_64-linux-gnu/libpthread.so.0
#4  0x00007ffff79d670e in Thread::start (this=0x6077c0) at ../src/Thread.cpp:42
#5  0x000000000040193d in MultiThreadedServer<JobDistributionServer_Thread>::Main (this=0x7fffffffe170) at /home/sebastian/Developement/powerserverplus-svn/mtserversock/src/MultiThreadedServer.hpp:55
#6  0x0000000000401601 in main (argc=1, argv=0x7fffffffe298) at ../src/main.cpp:29 
```

另一个例子是here（来自不同的运行）：

```
#0  0x00007ffff6d091d5 in ?? () from /lib/x86_64-linux-gnu/libc.so.6
#1  0x00007ffff6d0bc2d in malloc () from /lib/x86_64-linux-gnu/libc.so.6
#2  0x00007ffff751607d in operator new(unsigned long) () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6
#3  0x000000000040191b in MultiThreadedServer<JobDistributionServer_Thread>::Main (this=0x7fffffffe170) at /home/sebastian/Developement/powerserverplus-svn/mtserversock/src/MultiThreadedServer.hpp:53
#4  0x0000000000401601 in main (argc=1, argv=0x7fffffffe298) at ../src/main.cpp:29 
```

整个事情说它发生在`calloc`从 pthread lib 调用或在另一种情况下它是从它调用`new operator`或`malloc`从它调用。它是哪个并不重要`new`- 在几次运行中，它几乎发生`new`在我的代码中的每一次或线程创建中。唯一“不变”的就是它每次都出现在`libc.so.6`.

**无论**在代码的哪一点，
**无论**是使用 malloc 还是 calloc，
**无论**程序运行了多少时间，
**无论**创建了多少线程，
它始终是那个部分：0x7ffff0000000 - 0x7ffff4000000。

每次程序运行。但每次在程序的另一个点。我真的很困惑，因为它分配了 67MB 的虚拟空间但**它不使用它**。当观察它在那里创建的变量时，特别是观察那些在 libc 时创建`malloc`或被`calloc`libc 调用的变量时，这些空间都没有被它们使用。它们是在远离该地址范围（0x7ffff0000000 - 0x7ffff4000000）的堆部分中创建的。

* * *

**编辑：**

我也检查了父进程的堆栈大小，得到了 8388608 字节的使用量，即 0x800000 (~8MB)。为了获得这些值，我做了：

```
pthread_attr_t attr;
size_t stacksize;
struct rlimit rlim;

pthread_attr_init(&attr);
pthread_attr_getstacksize(&attr, &stacksize);
getrlimit(RLIMIT_STACK, &rlim);
fit into a size_t variable. */
printf("Resource limit: %zd\n", (size_t) rlim.rlim_cur);
printf("Stacksize: %zd\n", stacksize);
pthread_attr_destroy(&attr); 
```

请帮帮我。我真的很困惑。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-12T23:27:04.643

看起来它正在为线程分配堆栈空间。
当您在线程中进行函数调用时，将使用该空间。

但实际上正在做的事情与您无关。它是内部实现的一部分，`pthread_create()`它可以在那里做任何它喜欢的事情。

# python - Python打印在长时间任务之前不起作用？

> ID：13850363
> 
> 赞同：0
> 
> 时间：2012-12-12T23:19:34.107
> 
> 标签：python

我有一个制作许多（数十万个）文件的脚本，我想要这样的东西：

```
from __future__ import print_function

print("Generating...", end = "")
doStuff()
print(" Done") 
```

由于`end = ""`，我希望`Generating...`在漫长的任务之前出现，并让它在完成时更改`Generating... Done`。但是，第一个`print()`在 after 完成之前不会出现`doStuff()`，就在第二个之前`print()`。a `time.sleep(1)`before`doStuff()`没有做任何事情，尽管它无论如何都不是永久的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-12T23:21:28.480

您需要`sys.stdout`定期刷新以显示字符：

```
import sys

print 'Working',

while working():
    work()

    print '.',

    sys.stdout.flush()

print 'Done' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T23:22:36.467

您的解释器可能会缓冲输出。运行“python -u yourfile.py”应该可以解决这个问题。

# jakarta-mail - 将 DispositionNotification 与 Javamail 一起使用

> ID：13850365
> 
> 赞同：1
> 
> 时间：2012-12-12T23:19:53.493
> 
> 标签：jakarta-mail, pop3

我正在使用一组专门的电子邮件服务器，这些服务器配置为在成功接收到消息后返回消息处置通知 (MDN)。我开发了一个 Javamail 客户端，用于向其中一个服务器发送消息，并从用户的 POP3 INBOX 文件夹中检索返回的 MDN。

如何从我从用户收件箱中检索到的返回的 MimeMessage 中获取处置通知正文部分？我找到了 com.sun.mail.dsn.DispositionNotification 类，但还没有看到如何使用构造函数正确创建 DispositionNotification 实例的示例：

```
DispositionNotification(InputStream) 
```

我应该能够从 MimeMessage 获取 InputStream 并使用它来创建 DispositionNotification，像这样吗？

```
Message[] msgs = getInboxMessages();    
DispositionNotification dn = new DispositionNotification(msgs[0].getInputStream(); 
```

或者还有其他方法应该这样做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T00:38:04.807

此类消息的 getContent 方法应返回 MultipartReport 对象（通常 MimeMultipart 对象的特殊子类），您可以从中访问报告的各个部分。MultipartReport.getReport() 方法将返回 DeliveryStatus 或 DispositionNotification 对象，具体取决于报告的类型。

# html - Joomla 中的索引页面

> ID：13850370
> 
> 赞同：-1
> 
> 时间：2012-12-12T23:20:00.973
> 
> 标签：html, joomla, ftp, indexing, joomla-extensions

我在 Joomla 2.5 中创建了一个主页，我需要我的首页与在 Joomla 中创建的页面不同。

那么我最好的解决方案是用纯 HMTL 制作首页，然后重定向到用 Joomla 制作的网站。这可能吗？或者有更简单的方法吗？例如使用插件或其他东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T06:50:16.783

创建一个自定义 html 页面并将其创建为一篇文章，然后将这篇文章分配给首页。通过这种方式，您可以将您的自定义 html 页面显示到 joomla 的希望页面。此外，如果您想删除主页的 joomla 页面的页眉和页脚，可以通过多种方式完成

1.  制作模块位置并在其中显示页眉和页脚，然后在管理员中不要为主页发布这些模块
2.  我们在模板 index.php 中有变量，它为我们提供标志天气这是主页，您可以使用此标志并设置一个条件，例如如果这是主页不显示页眉和页脚。

希望它会帮助你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T04:53:55.207

你想达到什么目的？不知道更多，我有两个想法。

一个。Joomla 使用 index.php。很多时候，Web 服务器首先查找 index.html。因此，如果您创建一个 index.html 文件并将其上传到您的根文件夹，它将首先显示该文件，而不是读取您的 Joomla！地点。如果这不起作用，请检查您的 Web 服务器以查看它查找起始页的顺序。这是可以更改的设置。（取决于您的托管情况）

或 b。您可以为单个 Joomla! 设置不同的模板！地点。与网站的其他部分相比，您可以为主页设置不同的模板。（我只需要更多地了解您要完成的工作）

有一个伟大的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T04:45:40.300

我真的无法理解你的问题。如果您只想加载 HTML，请使用主页中呈现的自定义 HTML 模块

# ruby-on-rails - delay_job：如何根据触发的方法检查特定作业的存在

> ID：13850373
> 
> 赞同：0
> 
> 时间：2012-12-12T23:20:21.340
> 
> 标签：ruby-on-rails, delayed-job

我有一个像这样的方法，它通过一个数组来查找不同的 API，并`delayed_job`为每个像这样找到的 API 启动一个实例。

```
def refresh_users_list
  apis_array.each do |api| 
    api.myclass.new.delay.get_and_create_or_update_users
  end
end 
```

我有一个`after_filter`on`users#index`控制器来触发此方法。这创造了许多要触发的工作，最终会导致`too many connections`Heroku 出现问题。

我想知道是否有一种方法可以通过数组迭代的每个 API 检查数据库中是否存在作业。这将非常有帮助，因此如果该 api 在给定时间没有更新，我只能触发特定的刷新。

知道怎么做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T00:05:18.717

1.  在`config/application.rb`中，添加以下内容

    ```
    config.autoload_paths += Dir["#{config.root}/app/jobs/**/"] 
    ```

2.  在 处创建一个新目录`app/jobs/`。

3.  创建一个`app/jobs/api_job.rb`看起来像的文件

    ```
    class ApiJob < Struct.new(:attr1, :attr2, :attr3)

      attr_accessor :token

      def initialize(*attrs)

        self.token = self.class.token(attr1, attr2, attr3)
      end

      def display_name
        self.class.token(attr1, attr2, attr3)
      end

      #
      # Class methods
      #
      def self.token(attr1, attr2, attr3)
        [name.parameterize, attr1.id, attr2.id, attr3.id].join("/")
      end

      def self.find_by_token(token)
        Delayed::Job.where("handler like ?", "%token: #{token}%")
      end
    end 
    ```

    ***注意：**您将替换`attr1`, `attr2`, 和`attr3`您需要的任意数量的属性（如果有）传递给`ApiJob`以执行排队的任务。稍后详细了解如何调用它*

4.  对于您排队的每个 API，`get_and_create_or_update_users`您将创建另一个`Job`. 例如，如果我有一些`Facebook`api 模型，我可能有一个`app/jobs/facebook_api_job.rb`看起来像的类

    ```
    class FacebookApiJob < ApiJob
      def perform
        FacebookApi.new.get_and_create_or_update_users(attr1, attr2, attr3)
      end
    end 
    ```

    ***注意：**在您的问题中，您没有将任何属性传递给`get_and_create_or_update_users`. 我只是向您展示如果您需要将属性传递给它的作业，您将在哪里执行此操作。*

**最后**，无论你在哪里`refresh_users_list`定义，定义类似这个`job_exists?`方法的东西

```
def job_exists?(tokens)
  tokens = [tokens] if !tokens.is_a?(Array) # allows a String or Array of tokens to be passed

  tokens.each do |token|
    return true unless ApiJob.find_by_token(token).empty?
  end

  false
end 
```

现在，在您的`refresh_users_list`and 循环中，您可以构建新的令牌并调用`job_exists?`以检查您是否为 API 排队作业。例如

```
# Build a token

def refresh_users_list
  apis_array.each do |api| 
    token = ApiJob.token(attr1, attr2, attr3)
    next if job_exists?(token)

    api.myclass.new.delay.get_and_create_or_update_users
  end
end 
```

***注意：**我想再次指出，你不能只输入上面的代码并让它工作。您**必须**根据您的应用程序和您正在运行的工作对其进行定制。*

* * *

**为什么这么复杂？**

根据我的研究，没有办法通过`delayed_job`提供的内容来“标记”或唯一标识排队的工作。当然，每个工作都有一个独特的`:id`属性。您*可以*将每个创建的作业的 ID 值存储在某个散列中

```
{
  "FacebookApi": [1, 4, 12],
  "TwitterApi": [3, 193, 44],
  # ...
} 
```

然后检查相应的哈希键的 ID，但我发现这个限制，并不总是足够的问题当您需要通过多个属性识别特定作业时，我们必须创建一种方法来查找这些作业*（**无需**加载每个将作业放入内存并循环遍历它们以查看是否符合我们的标准）*。

**这是如何工作的？**

extends 有一个`Struct`属性。此标记基于传递的属性*(* *,* *,* *)* ，并在实例化新扩展类时构建。`ApiJob``:token`*`attr1``attr2``attr3`*`ApiJob`

类方法只是根据使用相同类方法构建的令牌`find_by_token`在队列中搜索作业的字符串表示以查找匹配项。`delayed_job``token`

# android - 使用 layout_weight 时出现奇怪的 ListView 行行为

> ID：13850374
> 
> 赞同：0
> 
> 时间：2012-12-12T23:20:21.923
> 
> 标签：android, android-layout, listview

我正在使用每行有 3 个 TextViews 的 ListView。很简单，对吧？

我想使用重量而不是固定宽度，但这似乎真的因为某种原因搞砸了。

这是我的行的布局：

```
 <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="horizontal"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:background="#f0f0f0"
android:weightSum="7">
<TextView
    android:id="@+id/listCaseName"
    android:gravity="left"
    android:layout_weight="3"
    android:width="0dp"
    android:textSize="18dp"
    android:textStyle="bold"
    android:layout_width="0dp"
    android:layout_height="wrap_content"
    android:lines="1"
    android:ellipsize="end" />
<TextView
    android:id="@+id/listCaseStatus"
    android:layout_weight="2"
    android:textSize="20dp"
    android:gravity="center"
    android:width="0dp"
    android:layout_width="0dp"
    android:layout_height="wrap_content" />
<TextView
    android:id="@+id/listPDF"
    android:layout_weight="2"
    android:gravity="center"
    android:textSize="20dp"
    android:width="0dp"
    android:layout_width="0dp"
    android:layout_height="wrap_content" />

</LinearLayout> 
```

一切看起来都很好，直到我向下滚动，选择一个项目并向上滚动。（我有一些特殊的代码来突出显示选定的行，但我很确定这不是问题）

这是列表视图最初的样子（非常好）： ![listviewWeightsInitial](../Images/14afe11b486b651042d2667fcf35c935.png)

这是我在单击一个项目后向上滚动时的样子：

![滚动备份](../Images/852d6563ced0493d6afa464e997b67ab.png)

有一堆额外的空间（大的灰色块）

当我进一步向上滚动时，它看起来像这样：

![scrollingUpFurther](../Images/e171e4ae0ed7aad813d108a076442a48.png)

一些文字也被弄乱了。

我可以通过固定文本视图的宽度而不是使用权重来缓解这个问题。

我一无所知。我对列表视图有一点经验，但直到现在我一直使用固定大小的东西，从来没有遇到过任何麻烦。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T23:36:08.507

您是否尝试`myView.invalidate()`点击点击？

# drupal - 将字段内容作为变量从块预处理器传递到块 tpl

> ID：13850375
> 
> 赞同：0
> 
> 时间：2012-12-12T23:20:24.750
> 
> 标签：drupal, preprocessor, field

我有一个预处理功能：

```
[MYTHEMENAME]_theme_preprocess_views_view_fields__random_quote__block(&$vars) 
```

然后是一个模板文件来呈现变量：

```
views-view--random_quote--block.tpl.php 
```

我可以像这样轻松地设置一个变量：

```
$vars['bam'] = 'whatever'; 
```

并将其显示在我的模板文件中。现在我的问题是，如何将字段的内容传递给我的模板？就像是：

```
$vars['customer_name'] = 'field_customer_name'; 
```

其中“field_customer_name”是内容类型中的一个字段。我曾尝试使用字段 api，但我无处可去。我的视图正在获取该字段，我可以在视图内容的预览中看到数据

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T18:38:28.530

好的，我想出了怎么做！

```
$entity = $vars['view']->result[0]->_field_data['nid']['entity'];
$vars['customer_name'] = '$entity->field_customer_name[$entity->language][0]['value']; 
```

希望这可以帮助某人

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T17:52:20.667

我还没有弄清楚如何做到这一点，但我最终使用了一个字段 tpl（在这种情况下：views-view-fields--random_quote.tpl.php）所以我可以像这样格式化每个字段

```
<cite><b><?php print strip_tags($fields['field_customer_name']->content); ?></b> 
```

# c# - 在 DataGridView 控件中被吞下/未执行的 Keydown 事件

> ID：13850379
> 
> 赞同：0
> 
> 时间：2012-12-12T23:20:43.490
> 
> 标签：c#, datagridview, keydown

我根据文章[DataGridView keydown event not working in C#](https://stackoverflow.com/questions/4284370/datagridview-keydown-event-not-working-in-c-sharp)开发的一些代码有问题。

我想允许用户向 Dataviewgrid 控件添加一行，但发现启用`AllowUserToAddRows`此功能会导致在新行的新单元格中键入第一个字符后立即显示额外的行。这会让我可怜的用户感到困惑，所以为了防止这种情况，我使用上面文章中的代码`AllowUserToAddRows`在每次击键时立即禁用（尽管我希望只在输入第一个字符后才这样做）。但是，这似乎吞下了第一个输入的字符，即 它不会传递给基类进行处理。这是完整的代码：

```
public sealed class XDataGridView : DataGridView
{
    private bool _singleUpdateOnly = true;

    public bool SingleUpdateOnly
    {
        get { return _singleUpdateOnly; }
        set { _singleUpdateOnly = value; }
    }

    [Description("Disallows user adding rows as soon as a key is struck to ensure no blank row at bottom of grid")]
    protected override bool ProcessCmdKey(ref System.Windows.Forms.Message msg, System.Windows.Forms.Keys keyData)
    {
        if (SingleUpdateOnly)
        {
            AllowUserToAddRows = false;
        }

        return base.ProcessCmdKey(ref msg, keyData);
    }
} 
```

为什么我输入的第一个字符被吞下？我怎样才能防止这种情况发生？有没有比我编码的更好的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T22:04:55.077

我在这个论坛和其他论坛上对这个问题几乎没有回应。这一定是一个非常棘手的问题，或者我只是对**DataGridView**控件期望过高。经过数小时的反复试验，我确定了一个不需要子类化的解决方案。该解决方案并不完全是我想要的，即一旦用户开始在新添加的行中输入内容，即防止另一行被附加到网格的底部，但它接近了。我使用`CellLeave`事件来关闭`AllowUserToAddRows`. 当用户按 Tab 或 Enter 键将数据输入到第一个单元格时，这有效地从网格中删除了新添加的行，将用户留在网格的新添加（最后）行的下一个单元格中（下面没有空行）。不优雅，但至少大部分是功能性的。这是代码：

```
private void uxContactEmailAddressesGrd_CellLeave(object sender, DataGridViewCellEventArgs e)
{
    uxContactEmailAddressesGrd.AllowUserToAddRows = false;
} 
```

也许有一天其他人会遇到这个问题并找到比我更优雅的解决方案。那简直太好了。确保将您的解决方案发布到此站点以供其他人使用。

# functional-programming - 我应该如何理解 OCaml 中的 `let _ as s = "abc" in s ^ "def"`？

> ID：13850380
> 
> 赞同：1
> 
> 时间：2012-12-12T23:20:43.860
> 
> 标签：functional-programming, ocaml

`let _ as s = "abc" in s ^ "def"`

**那么这个应该怎么理解呢？**

* * *

我想这是某种`let pattern = expression`东西？

**首先**， 的含义/目的/逻辑是`let pattern = expression`什么？

**另外**，在`pattern matching`，我知道有`pattern as identifier`用法，在`let _ as s = "abc" in s ^ "def"`，`_`是模式，但在后面`as`，它是一个表达式`s = "abc" in s ^ "def"`，而不是一个`identifier`，对吧？

*编辑*：

**最后**，这个怎么样：`(fun (1 | 2) as i -> i + 1) 2`，这是正确的吗？

我知道这是错的，但为什么呢？`fun pattern -> expression`是允许的，对吧？

* * *

我真的在这里迷路了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-12T23:27:59.780

分组是`let (_ as s) = "abc"`- 这只是一种令人费解的说法`let s = "abc"`，因为前面`as`的通配符模式`_`几乎没有用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-12T23:38:15.247

这个表达式`let pattern = expr1 in expr2`是 OCaml 的核心。如果模式只是一个名称，它可以让您命名一个表达式。这就像其他语言中的局部变量。如果模式更复杂，它可以让您解构`expr1`，即，它可以让您为其组件命名。

在你的表达中，后面`as`只是一个标识符：`s`。我怀疑你的困惑都归结为这一件事。表达式可以用括号括起来：

```
let (_ as s) = "abc" in s ^ "def" 
```

正如安德烈亚斯罗斯伯格所展示的那样。

如果您添加一些括号，您的最后一个示例是正确的。编译器/顶层正确地抱怨你的函数是部分的；即，它不知道如何处理大多数整数，只知道 1 和 2。

**编辑**：这是一个展示如何将括号添加到最后一个示例的会话：

```
$ ocaml
        OCaml version 4.00.0

# (fun (1 | 2) as i -> i + 1) 2;;
Error: Syntax error
# (fun ((1 | 2) as i) -> i + 1) 2;;
Warning 8: this pattern-matching is not exhaustive.
Here is an example of a value that is not matched:
0
- : int = 3
# 
```

**编辑 2**：这是一个会话，展示了如何通过指定一组详尽的模式来删除警告。

```
$ ocaml
        OCaml version 4.00.0

# (function ((1|2) as i) -> i + 1 | _ -> -1) 2;;
- : int = 3
# (function ((1|2) as i) -> i + 1 | _ -> -1) 3;;
- : int = -1
# 
```

# php - 如何删除仅属于博客数据库中当前用户的博客？

> ID：13850381
> 
> 赞同：-1
> 
> 时间：2012-12-12T23:20:44.317
> 
> 标签：php, codeigniter, phpmyadmin, blogs

我想在仅由当前配置文件的所有者输入的博客下方有一个删除按钮，我已经尝试实现 deleteMyBlog 功能，但到目前为止没有任何乐趣。最好的方法是什么？

这是我的看法。我知道我需要一些删除按钮，但我不确定如何适应我当前的 foreach 循环：

```
 <?foreach($blogs AS $viewData):
  $delete = $viewData['id'];
 {
$id = $viewData->id;
$title = $viewData->title;
$body = $viewData->body;
$username = $viewData->username;
$date = $viewData->date;

?>

   <b> <?=$title?></b>
    <p><?=$body?></p>

      <p>posted by:<?=$username?></p>
      <p>date: <?=$date?></p>
   <?=anchor("blog/deleteMyBlog/$delete", 'delete')?>
<hr>

<?
}
?> 
```

我的模型：

```
class Blogmodel extends CI_Model
{
  public function __construct()
   {
    parent::__construct();
    } 

   function deleteMyBlog($id)
   {

    $this->db->where(array('id' => $id));
    $this->db->delete('blogs');

}

public function get_last_ten_entries()
{
    $query = $this->db->get('blogs', 10);
    return $query->result();

   }
public function insert_entry()
{
    $this->title = $this->input->post('title');
    $this->body = $this->input->post('text');
    $this->username = $this->session->userdata('username'); 
    $this->date = date("Y-m-d");

    $this->db->insert('blogs', $this);

   }
  } 
```

控制器：

```
 class Blog extends CI_Controller {

public function _construct()
{
    parent::__construct();
    $this->load->model('Blogmodel','Blog'); 
    $this->load->model("profiles");

}

function deleteMyBlog($id) {

    $this->blogs->deleteBlog($id);

    redirect('blog');

}

public function index()
{

    $username = $this->session->userdata('username'); 

    $viewData['username'] = $username;

    $this->load->model('Blogmodel');

    if($this->input->post('act') =='create_post')
    {
        $this->Blogmodel->insert_entry();

    }

    $viewData['blogs'] = $this->Blogmodel->get_last_ten_entries();

    $this->load->view('shared/header');  
    $this->load->view('blog/blogtitle', $viewData);
    $this->load->view('shared/nav');
    $this->load->helper('form');// Load the form helper.

    // Lets set the stuff that will be getting pushed forward...
    $data = array();
    $data['form_open']=form_open();
    $data['form_title'] = form_input(array('name' => 'title'));
    $data['form_text'] = form_textarea(array('name' => 'text'));
    $data['form_hidden'] = form_hidden('act','create_post');
    $data['form_submit'] = form_submit('submit','Make Post');

    $this->load->view('blog/blogview');
    $this->load->view('blog/post', $data);

       $this->load->view('shared/footer');
    }

  } 
```

再次感谢各位

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T02:38:46.390

由于这一点，您会收到错误消息：

```
<?foreach($blogs AS $viewData):
   $delete = $viewData['id']; 
```

应该是这样的：

```
$delete = $viewData->id; 
```

您稍后正确地使用了完全相同的数据，为什么您要尝试使用 $viewData ，它是这里的一个对象作为数组，但在 2 行之后是一个对象。除此之外，您在那里所做的其他事情应该可以正常工作，但在实践中这是相当危险的。如果我访问您的站点并在该博客消失的末尾键入带有 blogId 的控制器函数的 url，那么您在任何时候都没有检查是否应该允许用户删除该博客。默默无闻！=安全。这意味着仅仅因为您认为人们不会找到链接并不意味着他们不会。

我个人将登录用户的 userId 保存到会话中，并将会话保存到数据库中。然后，当我对用户记录进行任何操作时，我会检查以确保进行更改的用户有权进行更改。

所以你的删除功能是这样的：

```
function deleteMyBlog($id)
{
    $this->db->where('username',$this->session->userdata('username');
    $this->db->where('id',$id);
    $this->db->delete('blogs');
} 
```

此外，您应该使用 userId 而不是用户名来保存到其他表，据我所知，索引在数字 ID 上效果更好，而且表中的整体数据较少。将 userId 342 保存到您的 blogs 表比保存用户名 bobsyouruncle3421 占用的空间更少。

作为记录，我知道这不是问题的一部分，但实际上从数据库中删除东西有缺点。从长远来看，其中最重要的是搞砸了索引并减慢了查询速度。更好的解决方案是将状态或活动列添加到您可能要从中删除的任何表中，并为它们赋予值 1 表示活动和 0 表示已删除。然后，不是实际删除项目，而是将其活动列更改为 0。显示项目时，您将检查活动 = 1 添加到显示查询。

这有两个目的，首先你不要弄乱索引，记录永远不会被删除，只是被修改所以索引保持不变。其次，几乎重要的是，您永远不可能意外删除您不想删除的内容，它永远不会真正消失。因此，您可以随时“取消删除”任何内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T23:57:36.967

最简单的方法是将用户名分配给变量，然后使用 SQL 语句。

`Delete from tbl where colname='$username'`

这就是我会做的方式，其他人可能有不同的方法。所以所有尊重那些会使用不同的东西的人

# php - T_SL 错误，购物篮系统

> ID：13850387
> 
> 赞同：1
> 
> 时间：2012-12-12T23:20:56.443
> 
> 标签：php

运行下面显示的代码时，出现此错误：（！）

```
Parse error: syntax error, unexpected T_SL in D:\Program Files\wamp\www\Fatz\Fatz Shopping Cart.php on line 13 
```

代码：

```
<?php
$_Session['Basket'] = '';

$User = 'Username';
$Pass = 'Password';
$Database = 'database';

mysql_connect(localhost, $User, $Pass);
@mysql_select_db($Database) or die('Unable to select database');

$sql = <<<MySQL_Query; <!-- Error Line-->

CREATE TABLE IF NOT EXISTS Test
{
    ItemID int(3) unsigned NOT NULL auto_increment,
    Title varchar(128) NOT NULL default '',
    Price decimal(3,2) NOT NULL default '',
    PRIMARY KEY (ItemID)
} MySQL_Query;

mysql_query($sql);

INSERT INTO Test VALUES (1, 'What are we selling!', '10.00');

function ShoppingBaskItems()
{
    $basket = $_Session['Basket'];
    If(!isset($basket) || null($basket)) return '0 Items';
    $Items = explode(',', $basket);
    $Count = (count($Items) > 1) ? 'Count': '';
    return '<p><a href="Basket.php">'.count($Items).' items'.$Count.' </a></p>';
}

echo ShoppingBaskItems(); 
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T20:58:07.063

使用[HEREDOCs](http://www.php.net/manual/en/language.types.string.php#language.types.string.syntax.heredoc)时，token 需要单独一行，也不要*在*该`$sql =`行的 token 后面加分号。

```
$sql = <<<MySQL_Query

CREATE TABLE IF NOT EXISTS Test
{
    ItemID int(3) unsigned NOT NULL auto_increment,
    Title varchar(128) NOT NULL default '',
    Price decimal(3,2) NOT NULL default '',
    PRIMARY KEY (ItemID)
}
MySQL_Query; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T23:23:35.433

`< !-- ... -->`是 HTML 注释标签。在 php 中你必须使用`//`,`#`或`/** */`.

编辑：

```
$sql = "CREATE TABLE IF NOT EXISTS Test
{
ItemID int(3) unsigned NOT NULL auto_increment,
Title varchar(128) NOT NULL default '',
Price decimal(3,2) NOT NULL default '',
PRIMARY KEY (ItemID)
}";

mysql_query($sql); 
```

# javascript - 通过 Javascript 将数据传递给 Bootstrap Typeahead

> ID：13850388
> 
> 赞同：1
> 
> 时间：2012-12-12T23:21:04.380
> 
> 标签：javascript, twitter-bootstrap, typeahead

伙计们，我正在尝试将一些数据传递给我的预输入表单，但由于某种原因，我的代码无法正常工作：

这是我的 HTML 代码：

```
<input type="text" class="span3" id="getsourCe" data-provide="typeahead" data-items="4" /> 
```

这是我的 Javascript 代码：

```
<script>  
var programLang = ['PHP', 'MySQL', 'SQL', 'PostgreSQL', 'HTML', 'CSS', 'HTML5', 'CSS3', 'JSON'];   
$('#getsourCe').typeahead({source: programLang})  
</script> 
```

我得到的唯一错误是 Uncaught SyntaxError: Unexpected token。我什至不确定它与问题有关。我的html代码根本没有改变！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T23:37:11.967

只需将您的 JS 代码包装在`$(document).ready`. 你可以看到它在这里工作：http: [//jsfiddle.net/EkFQP/](http://jsfiddle.net/EkFQP/)

这是代码：

```
$(document).ready(function() {
     var programLang = ['PHP', 'MySQL', 'SQL', 'PostgreSQL', 'HTML', 'CSS', 'HTML5', 'CSS3', 'JSON'];   
     $('#getsourCe').typeahead({source: programLang})  
});​ 
```

# objective-c - 一元表达式的参数类型“NSString”无效

> ID：13850392
> 
> 赞同：0
> 
> 时间：2012-12-12T23:21:33.927
> 
> 标签：objective-c

即使我从 Apple 文档中复制了该方法，我也遇到了返回错误（已注释掉）的问题。

你能告诉我有什么问题吗？

提前致谢。

```
#import "BIDDependentComponentViewController.h"

@implementation BIDDependentComponentViewController

- (IBAction)buttonPressed
{
    NSInteger stateRow = [self.dependentPicker selectedRowInComponent:kStateComponent];
    NSInteger zipRow = [self.dependentPicker selectedRowInComponent:kZipComponent];

    NSString *state = self.states[stateRow];
    NSString *zip = self.zips[zipRow];

    NSString *title = [[NSString alloc] initWithFormat:@"You selected zip code %@", zip];
    NSString *message = [[NSString alloc] initWithFormat:@"%@ is in %@", zip, state];

    UIAlertView *alert = [[UIAlertView alloc]initWithTitle:title
                                                   message:message
                                                  delegate:nil
                                         cancelButtonTitle:@"OK"
                                         otherButtonTitles:nil];
    [alert show];   
}

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view from its nib.
    NSBundle *bundle = [NSBundle mainBundle];
    NSURL *plistURL = [bundle URLForResource:@"statedictionary" withExtension:@"plist"];

    self.stateZips = [NSDictionary dictionaryWithContentsOfURL:plistURL];
    NSArray *allStates = [self.stateZips allKeys];
    NSArray *sortedStates = [allStates sortedArrayUsingSelector:@selector(compare:)];
    self.states = sortedStates;

    NSString *selectedState = self.states[0];
    self.zips = self.stateZips[selectedState];
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

#pragma mark-
#pragma mark Picker Data Source Methods

- (NSInteger)numberOfComponentsInPickerView:(UIPickerView *)pickerView
{
    return 2;
}

- (NSInteger)pickerView:(UIPickerView *)pickerView numberOfRowsInComponent:(NSInteger)component
{
    if(component == kStateComponent)
    {
        return[self.states count];
    } else {
        return[self.zips count];
    }
}

- (void)pickerView:(UIPickerView *)pickerView didSelectRow:(NSInteger)row inComponent:(NSInteger)component
{
    if(component == kStateComponent)
    {
        NSString *selectedState = self.states[row];
        self.zips = self.stateZips[selectedState];
        [self.dependentPicker reloadComponent:kZipComponent];
        [self.dependentPicker selectRow:0 inComponent:kZipComponent animated:YES];
    }

#pragma mark Picker Delegate Methods

-(NSString *)pickerView:(UIPickerView *)pickerView titleForRow:(NSInteger)row forComponent:(NSInteger)component //Invalid argument type 'NSString' to unary expression
{
    if(component == kStateComponent)
    {
        return self.states[row];
    } else {
        return self.states[row];
    }
}

- (void)pickerView:(UIPickerView *)pickerView didSelectRow:(NSInteger)row inComponent:(NSInteger)component
{
    if(component == kStateComponent)
    {NSString *selectedState = self.states[row];
    self.zips = self.stateZips[selectedState];
    [self dependentPicker selectRow:0
    inComponent:kZipComponent
    animated:YES];
}

@end // Missing @end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T23:24:26.527

您缺少`}`此方法的右括号：

```
- (void)pickerView:(UIPickerView *)pickerView didSelectRow:(NSInteger)row inComponent:(NSInteger)component 
```

将支架放在正确的位置（就在上面`#pragma mark Picker Delegate Methods` ）将解决您的两个错误。

# open-source - 有传言说 Google+ 模仿的是哪个平台？

> ID：13850393
> 
> 赞同：-1
> 
> 时间：2012-12-12T23:21:40.460
> 
> 标签：open-source, google-plus, social-networking

我记得读过一篇博文或某处说 Google+ 要么是流行的社交网络软件的修改版本，要么是仿照类似的东西。然而，我再也找不到这篇文章或类似的东西了。

至少让我知道是否有人看到该平台与另一个开源平台之间有很强的相似之处。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T23:28:54.643

[Diaspora](https://github.com/diaspora/diaspora)似乎为[Google+](http://plus.google.com)提供了灵感，但不确定它是否超出了单纯的启发。

# php - gdb核心文件用php截断httpd

> ID：13850397
> 
> 赞同：1
> 
> 时间：2012-12-12T23:22:20.623
> 
> 标签：php, debugging, gdb, apache

我正在尝试分析 LAMP 设置中的核心转储。它说核心被截断，唯一的信息是它有一个段错误，这已经在 httpd 错误日志中报告了。我无法获得完整的回溯或单步执行。

我为 httpd 和 freetds（sql server 驱动程序）安装了符号，php 没有我能找到的调试头文件。我什至需要所有 httpd 模块的所有符号，还是只需要 httpd 本身？

我怎样才能得到一个包含一些信息的好核心？

```
BFD: Warning: /tmp/core.10242 is truncated: expected core file size >= 576610304, found: 11689984.
BFD: Warning: /tmp/core.10242 is truncated: expected core file size >= 576610304, found: 11689984.
[New Thread 10242]
[New Thread 10753]
Core was generated by `/usr/sbin/httpd'.
Program terminated with signal 11, Segmentation fault.
#0  0x00002aaaac7f8b60 in ?? ()
"/tmp/core.10242" is a core file.
Please specify an executable to debug. 
```

# visual-studio - 在调试中运行 Allegro 项目时缺少 MSVCR100D.dll

> ID：13850401
> 
> 赞同：1
> 
> 时间：2012-12-12T23:22:26.933
> 
> 标签：visual-studio, visual-studio-2012, allegro, allegro5

我在 Windows 8 上使用 VS2012 设置了 Allegro 5，并尝试从 Allegro wiki 编译示例代码。我已经安装了 VC++ 2010 Redist。（x86 和 x64）并且我能够在发布中构建/运行项目就好了。

问题是，当尝试在调试中运行它时，它会崩溃并抱怨 MSVCR100D.dll 丢失。我的理解是这个 dll 的非调试和调试版本应该包含在 VC++ 2010 中吗？除了从某个地方下载 dll 并手动将其放入之外，关于如何解决此问题的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T02:41:23.897

我猜您正在使用为 VC++ 2010 (v10) 构建的 Allegro 二进制包。您应该使用 2012 (v11) 的版本或自己从源代码编译。不建议混合运行时。

Allegro 5.0.8 是第一个具有 v11 二进制文件的版本，虽然通常它们会在[http://www.allegro.cc/files](http://www.allegro.cc/files)上提供，但它们目前仅在[发布公告线程](https://www.allegro.cc/forums/thread/611458/970499#target)中可用。

# objective-c - 无法移动我的 UIScrollView

> ID：13850403
> 
> 赞同：2
> 
> 时间：2012-12-12T23:22:36.993
> 
> 标签：objective-c, ios, uiscrollview

我的内容大小为 1000x10000，它的中心位于视图控制器的中心。我想按下一个按钮让它翻页。在接下来的代码中，我尝试了 origin.x 中的几乎任何数字，但没有任何改变滚动视图。我不明白它的数学，但是当我设置 origin.x=300 和 origin.y=100 时，视图会向上移动一点，但就是这样。

```
CGRect frame=scroller.frame;
frame.origin.x=ANY NUMBER HERE;
frame.origin.y=0;
[scroller scrollRectToVisible:frame animated:YES]; 
```

如何设置它以将视图从右向左移动

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T23:48:22.007

尝试这个，

```
[scroller setContentOffset:CGPointMake(300, 0) animated:YES]; 
```

**[setContentOffset:animated：](http://developer.apple.com/library/ios/documentation/uikit/reference/UIScrollView_Class/Reference/UIScrollView.html#//apple_ref/occ/instp/UIScrollView/contentOffset)** *设置与接收者原点相对应的内容视图原点的偏移量。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T23:26:17.027

您应该将 UIScrollView 的框架创建为 UIViewController 的大小，如下所示：

```
UIScrollView *scroller = [[UIScrollView alloc] initWithFrame:self.view.frame]; 
```

然后将滚动条内容视图设置为 1000x10000 大小，如下所示：

```
scroller.contentSize = CGSizeMake(1000, 10000); 
```

只要 contentsize 大于滚动框，contentSize 就是使 UIScrollview 能够滚动的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-12T23:27:47.597

如果要使其可滚动，则 contentSize 必须大于 frame.size，否则没有滚动空间。
然后确保将 scrollEnabled 设置为 YES（默认情况下是，所以除非您更改它，否则它已经设置为 YES）。

# c# - 如何在 WP8 的主屏幕上通知用户？

> ID：13850406
> 
> 赞同：1
> 
> 时间：2012-12-12T23:22:49.943
> 
> 标签：c#, android, windows-phone-8

我需要将具有小部件的 Android 应用程序移植到 WP8。

在 Android 中，小部件会显示一个倒计时，该倒计时会在后台自动更新 - 即使用户退出了应用程序。倒计时从某个预先编程的时间开始并且只是倒计时 - 所有这些都不需要用户启动应用程序安卓。

WP8 上是否有类似的功能与瓷砖？该应用程序不与互联网交互，也不会收到任何可以使倒计时工作的外部消息，例如电子邮件。这一切都需要自动发生。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T01:02:47.253

这在 WP8（或 WP7）中是不可能的。

充其量您可以每半小时更新一次主屏幕上的应用程序磁贴（最好的情况！）。听起来您想要更频繁地更新。

# android - MonoForAndroid：android-support-v4.jar 编译问题

> ID：13850409
> 
> 赞同：2
> 
> 时间：2012-12-12T23:23:01.817
> 
> 标签：android, mono, xamarin.android

我刚刚更新到 Mono 4.4.41，我收到了与包含 android-support-v4.jar 文件相关的编译错误。我得到的编译错误：

```
You have Jar libraries, android-support-v4.jar, that have the identical name with inconsistent file contents. Please make sure to remove any conflicting libraries in EmbeddedJar, InputJar and AndroidJavaLibrary. 
```

该错误发生在 Novell.MonoDroid.Common.targets（MonoDroid 的一部分，不是我的项目的一部分）的第 344 行，它在其中检查重复的 jar 文件。

在上次更新之前，我已经使用支持库数周了，没有任何问题。我根据这些说明将它添加到我的项目中：http: [//docs.xamarin.com/Android/Guides/Platform_Features/Fragments/Part_4_-_Providing_Backwards_Compatibility_with_the_Android_Support_Package](http://docs.xamarin.com/Android/Guides/Platform_Features/Fragments/Part_4_-_Providing_Backwards_Compatibility_with_the_Android_Support_Package)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T15:59:58.557

从项目中删除支持库 jar 可以解决此问题。现在看来，Android 的 Mono 现在会自动将支持库绑定到构建中，这会导致构建中出现重复的 jar 文件。我查看了最近的发行说明，这就是我能找到的所有相关内容：

```
"Binding Projects now embed the bound .jar into the binding assembly." 
```

来自： [http ://docs.xamarin.com/android/releases/Mono_For_Android_4/Mono_for_Android_4.2.8](http://docs.xamarin.com/android/releases/Mono_For_Android_4/Mono_for_Android_4.2.8)

# mysql - NON Equi Join 超过 2 个表

> ID：13850411
> 
> 赞同：0
> 
> 时间：2012-12-12T23:23:15.607
> 
> 标签：mysql, sql, sql-server

我试图只从左表中取出那些不在右表中的记录。我在左表中有近 5000 条记录。同样，需要在超过 3-4 个表上进行相同的操作。我必须从第一个表中找出不在我的 3-4 个表中的记录。相同的主键或外键概念正在起作用。

我第一次尝试使用两张表从原始 5k 记录中提取 5,70,000 条记录。重复记录。

```
SELECT m.* FROM members m, pinnumber p where p.pinmemberid != m.memberid 
```

我的第二次尝试也使 my-sql 浏览器挂起。

```
SELECT m.* FROM members m
LEFT JOIN pinnumber p ON p.pinmemberid != m.memberid
LEFT JOIN customer c ON m.memberid != c.memberid 
```

我的第三次尝试也赚了很多时间

```
SELECT * FROM members m
         WHERE 1=1 AND AND not exists ( select 1 from pinnumber p where 1=1 And
         p.pinmemberid = m.memberid AND p.pinproductid LIKE '%Remit%')
         AND not exists ( select 1 from customer c where 1=1 and c.card_name is not null AND m.memberid = c.memberid ) 
```

请建议我该怎么做。如果我需要对此进行非平等加入。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T23:25:41.110

此查询将尝试将第一个表`members`与表`pinnumber`和`customer`：

```
SELECT m.*
FROM
  members m
  LEFT JOIN pinnumber p ON p.pinmemberid = m.memberid
  LEFT JOIN customer c ON m.memberid = c.memberid
WHERE p.pinmemberid is null and c.memberid is null 
```

由于我们使用的是 a `left join`，因此查询将返回所有成员行，但如果连接不成功`pinmemberid`，`memberid`则会返回`null`。这些值所在的行是`null`正确表中不存在的行。您可能想要使用 OR 而不是 AND。

如果您使用带`!=`条件的连接，您将获得第一个表的所有行乘以第二个表的所有行，但具有相同 id 的行除外。

获得相同结果的另一种方法是：

```
SELECT members.*
FROM members
WHERE
  memberid not in (select pinmembedid from pinnumber)
  and memberid not in (select memberid from customer) 
```

（如果你愿意，用 OR 代替 AND）。NOT IN 子句可能会慢一些，但更容易理解。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T02:48:12.990

顺便说一句，你想做的是：

```
SELECT m.* FROM members m
LEFT JOIN pinnumber p ON p.pinmemberid = m.memberid
LEFT JOIN customer c ON m.memberid = c.memberid
where p.pinmemberid is null and c.pinmemberid is null 
```

当`left join`右表中没有记录时，会产生 NULL 值。您可以在加入后过滤这些。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-04T16:14:33.133

我希望这个命令会产生你想要的输出..

```
SELECT m.* FROM members m LEFT JOIN pinnumber p ON p.pinmemberid = m.memberid where m.memberid is null; 
```

# mysql - MySQL外键不会导致子表填充

> ID：13850412
> 
> 赞同：0
> 
> 时间：2012-12-12T23:23:19.770
> 
> 标签：mysql, sql, database, innodb, relational

我正在尝试使用外键在 MySQL 中创建关系。每次我成功创建了 forien 键，但是当我描述表时，键被认为是“MUL”。在父表中插入一些记录后，我在子表中得到空值。我已经研究了好几个小时，却空手而归。我什至检查了 innodb 状态并且没有外键错误报告。我不完全确定为什么我得到空值，但我假设它是因为“MUL”键值。有人可以确认这一点并尝试帮助我吗？

```
create table employee
( id int
, first varchar(128)
, last varchar(128)
, primary key(id)
) engine=innodb; 

create table borrow
(ref auto_increment
, empID int
, book varchar(128)
, primary key(ref) 
) engine=innodb; 

alter table borrow add constraint fk_borrow
  foreign key (empID) references employee(id);

insert into borrow (empID, book) values (1,'mike'); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-12T23:34:57.037

'MUL' 只是意味着它不是唯一索引（即，KEY 允许重复值）。（如果它是唯一索引，则 Key 列将显示“UNI”）。FOREIGN KEY 约束与外键列的唯一性没有任何关系……它通常是非唯一的……父母通常可以有零个、一个或多个孩子。

FOREIGN KEY 约束不允许在子表中使用 NULL 值。只有 NOT NULL 约束（或触发器）会为您执行此操作。子表中的一行是孤儿，与父表无关是完全合理的。

对子表执行 INSERT 时，如果希望该行引用父表中的行，则需要为外键列提供非 NULL 值。

* * *

可以使用`ON DELETE SET NULL`子句定义外键，但这仅在您稍后删除具有与其相关的子行的父行时才有效。在这种情况下，当删除父行时，子行的外键列值将设置为 NULL。

* * *

**迈克说：我担心孩子的外键没有被父母填充。**

父级不负责填充子级的外键列。当父项的 id 值更改时，可以选择让子项的外键值自动更新……保留关系：ON UPDATE CASCADE。`ON UPDATE`但除了or子句执行的操作之外`ON DELETE`，父表没有责任维护子表中的值。

**迈克问：那么我如何让孩子的列从父母那里填充？**

你不会的。您将首先定位（或插入）该行到父表。然后，您将保留`id`列的值（或构成主键的任何列的值），然后在插入子行时将相同的值用于子行上的外键列。

当您将外键设置为任意值（与父表中现有的 PRIMARY KEY 值不匹配的值。这是预期的行为时，将返回错误。

如果在父行之前插入子行，则需要将外键列保留为 NULL，然后在知道`id`父行的值后，您将更新子行以设置外键列。

* * *

```
create table employee
( id int
, first varchar(128)
, last varchar(128)
, primary key(id) ) engine=innodb; 

create table borrow 
(ref auto_increment
, empID int
, book varchar(128)
, primary key(ref) ) engine=innodb;

alter table borrow add constraint fk_borrow
  foreign key (empID) references employee(id);

insert into employee (id, first, last) values (1, 'foo', 'bar');

insert into borrow (empID, book) values (1,'mike');

insert into borrow (empID, book) values (1,'mulligan'); 
```

添加到`borrow`表中的两行与employee 中的行相关，因为外键列(empID) 中的值设置为与`id`employee 表中的值匹配的值。

# android - Android SSO 登录对话框立即消失，没有错误

> ID：13850419
> 
> 赞同：0
> 
> 时间：2012-12-12T23:23:51.530
> 
> 标签：android, facebook, facebook-android-sdk

[我使用此处](https://developers.facebook.com/docs/tutorials/androidsdk/3.0/scrumptious/authenticate/)的教程在我的 android 应用程序上设置了 SSO ，但是每当我单击登录按钮时，它都会尝试打开 facebook 应用程序，facebook 应用程序显示“正在加载”，但立即失败且没有错误消息，并关闭了我的应用程序. 当我过滤 logcat 以显示与 facebook 相关的内容时，没有显示任何感兴趣的内容。

我完全从教程中复制了代码，我不确定为什么它会立即关闭。我试图在 LoginButton 上设置一个错误侦听器，但它永远不会被调用。

根据[这篇博客文章](http://sean.lyn.ch/2011/07/android-the-facebook-sdk-sso-and-you/)，问题应该出在密钥散列上，但我已经在 facebook 开发人员门户中获得了密钥散列。我什至创建了一个新的密钥库，对其进行哈希处理，然后再次尝试。

我可能做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-15T06:46:07.033

在我的办公桌上撞了几天之后，我刚刚重新启动了我的整个应用程序，从一个 facebook 示例应用程序开始，并重新构建了我的应用程序。我意识到在我的活动的 android 清单中，我设置了`no:history="true"`. 由于 Facebook SSO 启动 Facebook 应用程序，然后返回到我的启动活动，它只是退出了我的应用程序。

感谢您的评论！

# uitableview - TableView.DeselectRow 未触发自定义元素的取消选择事件

> ID：13850420
> 
> 赞同：1
> 
> 时间：2012-12-12T23:24:02.970
> 
> 标签：uitableview, xamarin.ios, monotouch.dialog

我可能在这里遗漏了一些东西，但是，当我手动取消选择一行时，我无法`Deselect`在我的自定义类上触发事件。`Element`我正在覆盖单元格以进行一些自定义绘图，并且我想在选择/取消选择单元格时更改字体的颜色。

下面详细介绍了实际问题的工作示例。

```
public class TestViewController : DialogViewController
{
    public TestViewController () : base(UITableViewStyle.Plain, null, true)
    {
        Root = new RootElement(null);
        var section = new Section();
        for (int i = 0; i <= 10; i++)
        {
            var element = new MyCustomElement();
            element.Tapped += (dvc, tableView, indexPath) => {
                var sheet = new UIActionSheet("", null, "Cancel", null, null);
                sheet.Dismissed += delegate(object sender, UIButtonEventArgs e) {                   
                    tableView.DeselectRow(indexPath, false);
                };
                sheet.ShowInView(View);
            };
            section.Add (element);
        }
        Root.Add (section);
    }
}

public class MyCustomElement : Element, IElementSizing {
    static NSString mKey = new NSString ("MyCustomElement");

    public MyCustomElement () : base ("")
    {
    }

    public MyCustomElement (Action<DialogViewController,UITableView,NSIndexPath> tapped) : base ("")
    {
        Tapped += tapped;
    }

    public override UITableViewCell GetCell (UITableView tv)
    {
        var cell = tv.DequeueReusableCell (mKey);
        if (cell == null)
            cell = new UITableViewCell (UITableViewCellStyle.Default, mKey);
        return cell;
    }

    public float GetHeight (UITableView tableView, NSIndexPath indexPath)
    {
        return 65;
    }

    public event Action<DialogViewController, UITableView, NSIndexPath> Tapped;

    public override void Selected (DialogViewController dvc, UITableView tableView, NSIndexPath path)
    {
        Console.WriteLine("Selected!");
        if (Tapped != null)
            Tapped (dvc, tableView, path);
    }

    public override void Deselected (DialogViewController dvc, UITableView tableView, NSIndexPath path)
    {
        // does not trigger when deselect manually invoked
        Console.WriteLine("Deselected!");
        base.Deselected (dvc, tableView, path);
    }
} 
```

我也尝试过覆盖`Deselected`事件`DialogViewController`本身，甚至创建一个自定义`Source`并覆盖其中的`RowDeselected`事件，但它仍然没有被触发。触发它的唯一方法是删除`Tapped`处理程序并选择不同的单元格。

为了解决这个问题，我目前正在做的是手动强制元素在我调用后自行更新`DeselectRow`，但是，我想知道*为什么*它没有触发。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T14:19:35.537

您不会收到 Deselected 事件，因为 deselectRowAtIndexPath:animated: 方法不会导致委托接收 tableView:didDeselectRowAtIndexPath: 消息，也不会向观察者发送 UITableViewSelectionDidChangeNotification 通知，并且调用此方法不会导致任何滚动到取消选择的行。

# python - Python文本加密：rot13

> ID：13850421
> 
> 赞同：-1
> 
> 时间：2012-12-12T23:24:03.620
> 
> 标签：python, string, encryption, rot13

我目前正在做一个使用 rot 13 加密文本的作业，但我的一些文本不会注册。

```
# cgi is to escape html
# import cgi

def rot13(s):
    #string encrypted
    scrypt=''
    alph='abcdefghijklmonpqrstuvwxyz'
    for c in s:
        # check if char is in alphabet
        if c.lower() in alph:
            #find c in alph and return its place
            i = alph.find(c.lower())

            #encrypt char = c incremented by 13
            ccrypt = alph[ i+13 : i+14 ]

            #add encrypted char to string
            if c==c.lower():
                scrypt+=ccrypt
            if c==c.upper():
                scrypt+=ccrypt.upper()

        #dont encrypt special chars or spaces
        else:
            scrypt+=c

    return scrypt
    # return cgi.escape(scrypt, quote = True)

given_string = 'Rot13 Test'
print rot13(given_string) 
```

### 输出：

```
13 r
[Finished in 0.0s] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-12T23:43:32.507

嗯，似乎一堆东西都不起作用。主要问题应该在于：如果，例如，等于，那么您将`ccrypt = alph[ i+13 : i+14 ]`丢失 a ，那么您将超出列表边界。实际上，在您的输出中， only被编码为，因为它是测试字符串中唯一一个移动 13 并不会超出边界的字母。`% len(alph)``i``18``e``r`

这个答案的其余部分只是稍微清理代码的提示：

*   而不是`alph='abc..`你可以`import string`在脚本的开头声明一个并使用`string.lowercase`
*   而不是使用字符串切片，最好只使用一个字符`string[i]`，完成工作
*   而不是`c == c.upper()`，您可以使用内置函数`if c.isupper() ...`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-12T23:44:00.087

你遇到的麻烦是你的切片。如果您的角色在字母表的后半部分，它将是空的，因为`i+13`将不在末尾。有几种方法可以解决它。

最简单的可能是简单地将您的字母字符串加倍（字面意思是：）`alph = alph * 2`。这意味着您可以访问最多 52 个值，而不仅仅是最多 26 个。不过，这是一个非常粗略的解决方案，最好只修复索引。

更好的选择是从索引中减去 13，而不是添加 13。Rot13 是对称的，因此两者将具有相同的效果，并且它会起作用，因为负索引在 Python 中是合法的（它们指的是从末尾倒数的位置）。

在任何一种情况下，实际上都没有必要进行切片。您可以简单地获取单个值（与 C 不同，`char`Python 中没有类型，因此单个字符也是字符串）。如果您只进行此更改，它可能会说明您当前代码失败的原因，因为尝试访问字符串末尾的单个值会引发异常。

**编辑：**实际上，在考虑了真正最好的解决方案之后，我倾向于建议完全避免基于索引数学的解决方案。更好的方法是使用 Python 出色的字典来进行从原始字符到加密字符的映射。您可以像这样构建和使用 Rot13 字典：

```
alph="abcdefghijklmnopqrstuvwxyz"
rot13_table = dict(zip(alph, alph[13:]+alph[:13])) # lowercase character mappings
rot13_table.update((c.upper(),rot13_table[c].upper()) for c in alph) # upppercase

def rot13(s):
    return "".join(rot13_table.get(c, c) for c in s) # non-letters are ignored 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-12T23:43:49.357

这条线

```
ccrypt = alph[ i+13 : i+14 ] 
```

不会做你认为它做的事 - 它从`i+13`to返回一个字符串切片`i+14`，但如果这些索引大于字符串的长度，切片将为空：

```
"abc"[5:6] #returns '' 
```

这意味着您的解决方案将所有内容从`n`开始转换为空字符串，从而产生您观察到的输出。

实现这一点的正确方法是 (1.) 使用模运算将索引限制为有效数字和 (2.) 使用简单的字符访问而不是字符串切片，这更容易阅读、更快并抛出一个`IndexError`for无效索引，这意味着您的错误很明显。

```
ccrypt = alph[(i+13) % 26] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-12T23:44:10.163

可能给你带来一些问题的第一件事 - 你的字符串列表有`n`和`o`切换，所以你需要调整它:) 至于算法，当你运行时：

```
ccrypt = alph[ i+13 : i+14 ] 
```

想想当你`25`从第一次迭代（for `z`）中返回时会发生什么。您现在正在寻找索引位置`alph[38:39]`（旁注：您实际上可以说`alph[38]`），它远远超出了 26 个字符的字符串的边界，它将返回`''`：

```
In [1]: s = 'abcde'

In [2]: s[2]
Out[2]: 'c'

In [3]: s[2:3]
Out[3]: 'c'

In [4]: s[49:50]
Out[4]: '' 
```

至于如何修复它，有许多有趣的方法。您的代码只需稍作修改即可正常运行。您可以做的一件事是创建一个已经“旋转”了 13 个位置的字符映射：

```
alph = 'abcdefghijklmnopqrstuvwxyz'
coded = 'nopqrstuvwxyzabcdefghijklm' 
```

All we did here is split the original list into halves of 13 and then swap them - we now know that if we take a letter like `a` and get its position (`0`), the same position in the coded list will be the `rot13` value. As this is for an assignment I won't spell out how to do it, but see if that gets you on the right track (and @Makoto's suggestion is a perfect way to check your results).

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2017-09-17T00:43:27.553

If you're doing this as an exercise for a course in Python, ignore this, but just saying...

```
>>> import codecs
>>> codecs.encode('Some text', 'rot13')
'Fbzr grkg'
>>> 
```

# c# - 使用 datetimepicker 中的值更新数据库

> ID：13850424
> 
> 赞同：1
> 
> 时间：2012-12-12T23:24:09.023
> 
> 标签：c#, datetime, data-binding, picker

使用 Visual Studio 2010 和 c#，我创建了一个 windows 窗体并将文本字段从数据源树拖到窗体。

这些字段显示正常，当我更改其中一个文本并按下保存按钮时，它会保存到数据库中。

我在表单上放了一个 datetimepicker，在 properties->databindings->value 下我从数据库中选择了该字段。

当我打开表单时，日期时间选择器会从数据库中加载正确的日期。但是当我使用日期时间选择器更改日期然后按保存按钮时，数据库中的日期不会更改。

我错过了什么吗？

# .net - Interlocked.Xxx 方法是否保证在所有数据缓存中更新值？

> ID：13850432
> 
> 赞同：5
> 
> 时间：2012-12-12T23:24:44.577
> 
> 标签：.net, multithreading

例子：

```
Thread a:  Interlocked.Increment(ref x);

Thread b:  int currentValue = x; 
```

假设线程 b 在线程 a 之后执行，线程 b 中的“currentValue”是否保证为增量值？或者，线程 b 是否需要执行 Thread.VolatileRead(ref x)？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-12T23:39:46.427

从技术上讲，这取决于运行 .NET 的 CPU，但对于任何常见的 CPU，答案都是肯定的，Interlocked.Increment 保证缓存一致性。它[充当](https://stackoverflow.com/a/1034116/141172)MESI 要求的内存屏障。

> CPU 可以在其缓存中包含无效的行，但它还不知道该行是无效的 - 无效队列包含尚未被执行的无效。（失效队列位于缓存的另一“边”；CPU 无法扫描它，因为它可以扫描存储缓冲区）。因此，需要内存屏障。

[http://en.wikipedia.org/wiki/MESI_protocol](http://en.wikipedia.org/wiki/MESI_protocol) (x86)

MOESI（用于 AMD64 芯片）非常相似：

[http://en.wikipedia.org/wiki/MOESI_protocol](http://en.wikipedia.org/wiki/MOESI_protocol) (AMD64)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-12T23:54:46.513

据我了解，只有在其他 Interlocked 方法访问时才能保证 Interlocked。在 x86 系统上谈论 64 位值时，这可能尤其重要，因为它不能保证是原子的，因此撕裂值是一个问题。稳健地读取可由 Interlocked 更改的值的一个好技巧是 CompareExchange：

```
int val = Interlocked.CompareExchange(ref field, 0, 0); 
```

这会将 的值`field`变为 0，但前提是旧值为 0 - 否则它什么也不做。无论哪种方式，都会返回旧值。所以基本上：它读取值而不更改它，并且与其他互锁方法相比是安全的。

# django - Django：在实例化期间为模型类中的字段赋值

> ID：13850434
> 
> 赞同：1
> 
> 时间：2012-12-12T23:24:50.253
> 
> 标签：django, django-models, initialization

我可以做这个：

```
counter = 0

class A(models.Model):
  code = models.IntegerField(max_length=30, default=generate_code)

def generate_code():
  counter += 1
  return counter 
```

但似乎是，分配是在模型类的初始化（加载）期间完成的，而不是在创建实例时完成，所以“代码”总是“1”。

在创建模型类的实例期间，如何自动为某个字段分配动态值？

如果我在覆盖`__init__`函数中设置值，如下所示：

```
class A(models.Model):

    def __init__(self, *args, **kwargs):
        models.Model.__init__(self, *args, **kwargs)
        self.code = self.generate_code() 
```

代码在每次更新时都会更改。正如调试器向我展示的那样 `__init__`，当我删除对象时，也会调用该函数。我真的不明白这个！

如果没有设置，我只能在`__init__`函数中设置代码，但这似乎不合逻辑，所以我想避免它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T23:32:13.150

您是否只是在寻找一种方法来确保数据库中的每个 A 对象都具有唯一的计数器值？然后你可以使用`AutoField`而不是`IntegerField`： [https ://docs.djangoproject.com/en/dev/ref/models/fields/#django.db.models.AutoField](https://docs.djangoproject.com/en/dev/ref/models/fields/#django.db.models.AutoField)

当您创建一个新`A`对象时，它的`counter`值将自动设置为比先前创建的值高一个。

为了解释您看到的一些行为，每次加载您的 models.py 时，它确实会将一个新`counter`变量初始化为 0，正如您所想的那样。至于为什么`A`在你不期望的时候调用构造函数，`A`只是一个代表数据库中一些数据的类。因此，每次 Django 从数据库中获取数据并将其呈现给您时，它都会创建一个新`A`对象来封装该数据。

# android - DrawText 仅在 Jelly Bean 4.2 上绘制字符串的一个字符

> ID：13850435
> 
> 赞同：4
> 
> 时间：2012-12-12T23:24:52.127
> 
> 标签：android, android-canvas, android-4.2-jelly-bean

好吧，这让我发疯了。我正在使用画布在我的应用程序中绘制仪表。它还在哈希标记上绘制数字，并在仪表上绘制一些水平文本。这一切都适用于所有版本的 Android 到 4.2。在 4.2 中，它只从它应该写的文本中绘制一个字符（看起来是中间字符）。例如，如果我的文本显示为 12345，它只写 3。如果它是一个两位数，它只绘制第一个数字。我在 4.2 模拟器和带有 4.2.1 的 Nexus 4 上看到了这种行为。我阅读了有关默认情况下打开硬件加速的所有信息，并且它会导致某些 Paint 和 Canvas 功能出现问题。我已插入代码以关闭 drawText 调用的硬件加速，但它没有帮助。

这是我的油漆代码：

```
titlePaint1 = new Paint();
titlePaint1.setColor(Color.WHITE);
titlePaint1.setAntiAlias(true);
titlePaint1.setTypeface(Typeface.DEFAULT_BOLD);
titlePaint1.setTextAlign(Paint.Align.CENTER);
titlePaint1.setTextSize(0.085f); 
```

这是绘制文本所调用的方法：

```
@SuppressLint("NewApi")
private void drawTitle1(Canvas canvas) {
    if(Build.VERSION.SDK_INT >= Build.VERSION_CODES.HONEYCOMB)
        setLayerType(View.LAYER_TYPE_SOFTWARE, titlePaint1);

    canvas.drawText(title1, 0.5f, 0.72f, titlePaint1);
} 
```

我将有效的画布传递给它，并且宽度和高度都很完美。在该画布上绘制的其他所有内容都显示正常，并且在绘制仪表组件之前还有其他三个函数调用，如上面的那个。这只是drawText的问题。我知道这与 4.2 的变化有关，我认为这个 drawText 问题与硬件加速无关。我只能在 Google 上找到一些关于 4.2 版 Canvas 问题的结果，但没有什么能帮助我解决我的问题。有什么想法可以解决这个问题并使文本正确显示吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-27T17:10:23.917

感谢“塞拉芬的主人”在他们的帖子中对此的回答。对于在 4.2.1 中遇到此问题的任何其他人，答案是在您的文本绘制中包含 setLinearText(true)。此方法显示为已弃用，但它是文本正确显示的唯一解决方案。

这是带有答案的帖子：[https](https://stackoverflow.com/a/13971632/1017328) ://stackoverflow.com/a/13971632/1017328 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T19:10:19.930

我强烈怀疑您遇到了我在这里报告的错误：[http](http://code.google.com/p/android/issues/detail?id=40965) ://code.google.com/p/android/issues/detail?id=40965 。

# regex - 正则表达式查找主题标签

> ID：13850436
> 
> 赞同：1
> 
> 时间：2012-12-12T23:25:00.923
> 
> 标签：regex, matlab

这是给 Matlab 的。我有一条推文，我需要找到主题标签所说的内容。我知道我可以使用正则表达式隔离并保存以“#”开头并以“”结尾的所有内容。但是，当我使用

```
 tweet = 'it is fun to post on #stackoverflow, really #itis';
    regexp(tweet,'#(\w+)','tokens','once')
    ans = 
        'stackoverflow' 
```

我只得到第一个#。我将如何做到这一点，以便我也可以获得“itis”＃？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-12T23:28:45.430

[`once`](http://www.mathworks.nl/help/matlab/ref/regexp.html#inputarg_options)仅返回第一个匹配项.... 如果您不想要，请删除它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T23:31:01.480

根据 matlab 文档，您需要删除“一次”。资料来源： http: [//www.mathworks.com/help/matlab/ref/regexp.html](http://www.mathworks.com/help/matlab/ref/regexp.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T09:41:16.130

我想这就是你要找的：

```
regexp(tweet,'#(\w+)','match')
ans = 
'#stackoverflow'    '#itis' 
```

但是，似乎您对 Regex 的了解比我多，所以我猜您知道如何摆脱`#`字符串中的 's。

# python - 为什么实例变量需要“self”才能访问，而全局变量却没有前缀？

> ID：13850437
> 
> 赞同：0
> 
> 时间：2012-12-12T23:25:10.457
> 
> 标签：python

> **可能重复：**
> [为什么需要在 Python 方法中显式添加“self”参数？](https://stackoverflow.com/questions/68282/why-do-you-need-explicitly-have-the-self-argument-into-a-python-method)

在 Python 中，实例变量必须通过 来访问`self.x`，但全局变量可以通过写入来读取`x`。怎么会？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T23:30:00.243

这是一个经常被问到的问题，但本质上是：这是为了避免名称冲突或混淆正在访问哪些实例或全局变量。

哲学是“显式胜于隐式”。

# html - 使用自定义渲染器的本地 HTML 到 PDF 仅添加最近查看的图像

> ID：13850440
> 
> 赞同：4
> 
> 时间：2012-12-12T23:25:18.323
> 
> 标签：html, objective-c, ios, pdf

这对大家来说有点问题。我在设备上本地存储了一个 html 文档，其中包含本地存储的图像（不在捆绑包中，在磁盘上）。我在 UIWebView 中显示 html 页面，用户可以选择将页面转换为 PDF 并通过电子邮件发送页面。pdf 是使用 UIMarkupTextFormatter 和自定义 UIPrintPageRenderer 生成的，而不是通过将网页制作成图像并将图像呈现为 PDF 来生成的。这是因为 PDF 需要可搜索。

无论如何，这工作得很好。然而，客户现在要求在 uiwebview 中不再只是一个页面，而是将大页面分解成分页的片段。导出功能仍然需要整个网页不分解为要导出的页面。

现在出现了问题，导出的 PDF 仅包含当前显示页面的图像。因此，例如，如果我将整个 html 页面分成 4 个较小的页面，并且用户在按下导出时正在查看第 3 页，那么 pdf 将正确包含所有网页信息，但仅包含第 3 页上的图像。 pdf 不包含空白图像或格式错误的图像，它们只是不存在。如果我然后更改到其他页面之一并再次导出，我将获得该阶段的图像。HTML 是在开始时生成的，因此唯一的区别是是否显示图像。

现在，我的猜测是 UIMarkupTextPrintFormatter 只显示缓存中的图像。这是有道理的，因为用户通常希望打印他们看到的页面，因此渲染器不必在缓存之外寻找资源。html 文档中的图像的路径指向磁盘上文件的位置，例如 'file:///var/mobile/Applications/C409BDBD-1254-4ADA-BAD8-F9BE5C171C93/Documents/Export/SoMeJobN/Images/ 915F0470-785D-40BF-A3E7-9945646843A7.jpg' 并且我已验证所有图像都存在于该位置。

我还覆盖了 NSURLCache 并设置了自定义缓存。我发现标记格式化程序正在调用

```
 -(NSCachedURLResponse *) cachedResponseForRequest:(NSURLRequest *)request 
```

网页中不在当前页面上的每个图像的方法，因此它正在从缓存中请求不在当前网页上的资产！

我尝试使用以下代码返回从磁盘加载的图像。

```
NSString *pathString = [[request URL] absoluteString];

    // Load the data
    NSData *data = [NSData dataWithContentsOfURL:[NSURL URLWithString:pathString]];
            // Create the cacheable response
    UIImage *img  = [UIImage imageWithData:data];
    NSLog(@"%@",img);

    NSURLResponse *response =
    [[[NSURLResponse alloc]
      initWithURL:[request URL]
      MIMEType:@"image/jpeg"
      expectedContentLength:-1
      textEncodingName:nil]
     autorelease];
    NSCachedURLResponse *cachedResponse =
    [[[NSCachedURLResponse alloc] initWithResponse:response data:data] autorelease];

    return cachedResponse; 
```

并且我已经验证 UIImage 已正确加载，因此数据是正确的。但它没有显示在 PDF 中。那么，有没有人知道为什么会发生这种情况，之前遇到过这个问题，或者可以想到其他任何事情让我尝试。我可以重构代码以连续加载所有页面并为每个页面导出 PDF 的各个部分，但这似乎是一个不优雅的问题解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-08T03:07:47.407

建议：在创建 pdf 之前，请先`jquery.get(...)`调用其他页面。以正确的顺序将它们组装成一个 html 对象，然后通过 ajax 或通过 javascript 将 html 发送到您的 html-pdf 转换器`form.submit()`

# jquery - jplayer控制框自动隐藏到div中

> ID：13850446
> 
> 赞同：2
> 
> 时间：2012-12-12T23:25:57.260
> 
> 标签：jquery, css, jplayer

我使用[Jplayer](http://jplayer.org/)（jquery 视频播放器插件）。我自定义控制框（播放/暂停...），以便在鼠标悬停时显示`jp-jplayer div`：

```
autohide: {
    restored: true, fadeIn:500,
}, 
```

这有效，当我将鼠标悬停在`jp-jplayer div`该 div（底部）之外时，控制框会显示。现在我需要将控制框显示到`jp-jplayer div`，而不是在这个 div 之外。如何将控制箱显示进去`div`？

在线示例[HERE](http://jsfiddle.net/BBKING/JEEqj/) ( `in example control box is hide and after mouseover u see panel outside div`)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T12:28:58.413

`margin-top`你可以通过在类中添加一个否定来简单地使用 CSS 来实现这一点`.jp-interface`

例如

```
div.jp-interface {
   margin-top:-88px;
} 
```

# python - numpy.delete flattens my array

> ID：13850451
> 
> 赞同：0
> 
> 时间：2012-12-12T23:26:23.250
> 
> 标签：python, multidimensional-array, numpy

Say I do the following:

```
my_array = np.array([[1,2,3]])
my_new_array = np.delete(my_array, []) 
```

The last line will convert `my_array` to:

```
my_new_array = np.array([1,2,3]) # It flattens the array one level 
```

which is not what I expected.

If instead I had had:

```
my_array = np.array([[1,2,3], [4,5,6]])
my_new_array = np.delete(my_array, []) 
```

I would get:

```
my_new_array = np.array([[1,2,3], [4,5,6]]) 
```

which is what I expect. How can I make sure a call to `np.delete(my_array, [])` does not flattens my array?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-12T23:43:47.793

From the [documentation](http://docs.scipy.org/doc/numpy/reference/generated/numpy.delete.html):

> numpy.delete(arr, obj, axis=None)
> 
> axis : int, optional
> 
> The axis along which to delete the subarray defined by obj. If axis is None, obj is applied to the **flattened array**

Because you are not supplying anything to `axis`, it is flattening the array. You could do the following:

```
>>> print np.delete(my_array, [], axis=0)
array([[1, 2, 3],
       [4, 5, 6]]) 
```

Which seems to be the result that you want. However, it is unclear why you want to apply a transformation that gives you the same array.

# cookies - 域范围的 Cookie

> ID：13850455
> 
> 赞同：2
> 
> 时间：2012-12-12T23:26:32.813
> 
> 标签：cookies, httpwebrequest, cross-domain, session-cookies

我有`a.example.com`，它为`.example.com`. 稍后`a.example.com`发送一个 ajax 请求到`b.example.com`. 我希望将`.example.com`cookie 发送到`b.example.com`. 但事实并非如此。

我确保 cookie 设置在正确的域上，但由于某种原因，它似乎没有在 ajax 请求中发送 cookie。

```
# server A
res.cookie('images', tokens.images, { expires: config.pageExpiration(), secure: secure, domain: domain })

# server B
req.cookies.image 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-12T23:37:45.183

这是有道理的，因为您不会期望 *.com cookie 混合在一起。如果你真的需要，我建议你通过服务器请求传递你的 cookie。

# c# - 从单独的工具编辑 App.Config 名称-值对

> ID：13850456
> 
> 赞同：1
> 
> 时间：2012-12-12T23:26:35.437
> 
> 标签：c#, wpf, winforms, app-config

我正在尝试为服务人员创建一个简单的工具来更新不同程序的 App.Config 中的一些条目。App.Config 文件包含在我们的程序初始化时使用的自定义参数。

由于 App.Config 包含许多敏感项目，因此需要一个工具来确保仅更改某些参数。因此，不允许他们直接编辑 App.Config 的原因。

我的问题：

1.  如何从单独的程序中访问 App.config 的配置部分的名称-值对？
2.  哪个更适合 UI：Winforms 还是 WPF？他们的控件是否可以在将来轻松添加更多条目？
3.  该工具应允许用户设置 String、int、double 或 Boolean。

这是 App.Config 的结构：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>

  <configSections>
    <sectionGroup name="Settings">
      <section name="Section1" type="System.Configuration.NameValueSectionHandler"/>
      <section name="Section2" type="System.Configuration.NameValueSectionHandler"/>
      <section name="Section3" type="System.Configuration.NameValueSectionHandler"/>
      <section name="Section4" type="System.Configuration.NameValueSectionHandler"/>
    </sectionGroup>
  </configSections>

  <Settings>
    <Section1>
      <add key="NAME_STRING" value="Some String"/>
    </Section1>

    <Section2>
      <add key="NAME_INTEGER" value="10"/>
    </Section2>

    <Section3>
      <add key="NAME_DOUBLE" value="10.5"/>
    </Section3>

    <Section4>
      <add key="NAME_BOOLEAN" value="true"/>
    </Section4>
  </Settings>

  ... Omitted ...

</configuration> 
```

在使用 App.Config 本身的程序中，我可以轻松地更改值，如下所示：

```
NameValueCollection nvc = (NameValueCollection)ConfigurationManager.GetSection("Settings/Section1"); 
```

加载 App.Config 后，是否有类似的方法可以从单独的程序中执行此操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-12T23:30:45.113

问题 1 的答案：app.config 文件是一个 XML 文件。将其作为 XML 文档加载并以编程方式对其进行修改，然后保存，这可能比使用`System.Configuration`类更容易。

ETA：我相信它可以用`ConfigurationManager`. 查看[OpenMappedExeConfiguration](http://msdn.microsoft.com/en-us/library/ms134269.aspx)方法。那里有一个很好的例子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T23:31:35.570

您可以将 app.config 文件视为普通的 XML 文件。使用 XDocument 或 XmlDocument 加载文件。

然后使用 XPath 或 Linq to XML 查找名称-值对。

至于 Windows.Forms 与 WPF，这是一个设计决定。两者都有优点和缺点。

**[更新]**

如果您仍想使用 System.Configuration，您可以使用`ConfigurationManager.OpenExeConfiguration`来访问其他程序的 app.config 文件。这将返回一个`Configuration`具有`GetSection`方法的对象。

# javascript - JavaScript：如何停止以 $(function(){}) 开头的函数

> ID：13850457
> 
> 赞同：0
> 
> 时间：2012-12-12T23:26:34.263
> 
> 标签：javascript, jquery

我创建了一个函数，然后在页面加载时调用了这个函数，我也需要调用相同的函数，但没有它存在两次。我希望它从 $(function(){}) 停止并在单击元素时再次调用。

```
function myfunction(){
    console.log('message');
}

$(function(){
    myFunction();

    $('#id').click(function(){

     ...some code here ...
     myFunction();

});
}) 
```

加载页面时，控制台给我：“消息”-没关系，但是当单击#id 时，我会收到此消息两次，如果再次收到 3 次；

* * *

这是我的代码

```
function select_cta(){
    $('.cta-id').click(function(){
        console.log('-');
        $('.cta-id').removeClass('active');
        $(this).addClass('active');

        var cta_arr = parseInt($(this).attr('id').replace('cta-button-', ''))-1;

        $('.cta-image').fadeOut(300).removeClass('active');
        $('#'+$(this).attr('id').replace('cta-button', 'cta-image')).fadeIn(300).addClass('active');
        if(cta_data[cta_arr]){
            $('.cta-actions #cta_id').val(cta_data[cta_arr].id);    
        }
        else{
            $('.cta-actions #cta_id').val('');
        };

        if(cta_data[cta_arr]){          
            $('.cta-actions #cta_link').val(cta_data[cta_arr].link);
        }
        else{
            $('.cta-actions #cta_link').val('');
        };

    });

}

$(function(){

    select_cta();

    $('.add-new-cta').click(function(){
        var new_tab = parseInt($(this).prev().attr('id').replace('cta-button-',''))+1;
        $(this).before('<div id="cta-button-'+new_tab+'" class="cta-btn cta-id empty" style="display:none;"><span>'+new_tab+'</span><span class="onair">ON</span></div>');
        $('#cta-button-'+new_tab).fadeIn(300);
        $('.cta-images').append('<div id="cta-image-'+new_tab+'" class="cta-image " style="display:none"><img src="/assets/images/page/placeholder_cta.gif"></div>');

        select_cta();   

    })
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T00:30:32.303

# r - R中的findInterval函数（设置结果）

> ID：13850461
> 
> 赞同：-1
> 
> 时间：2012-12-12T23:27:24.040
> 
> 标签：r

如何用我想要的数字替换 findinterval 函数的结果？下面是 dput() 输出：

```
a=c(113,113,113,113,111,111,115,116,117,118,220,220)
b=c(113,113,113,113,111,111,115,116,117,118,220,220)
c=c(2,2,1,1,5,1,1,2,1,1,1,4)
d=c(2,2,12,12,15,12,12,2,12,12,12,14)
e=c(1,1,1,1,1,2,2,2,2,2,2,3)
f=c(20,30,25,35,45,55,60,65,70,75,75,80)
h=c("1A","1A","2A","3A","1A","5A","4A","4A","7A","7A","9A","9A")
i=c(12,16,17,19,20,15,18,17,17,13,14,15)

m=data.frame(a=a,b=b,c=c,d=d,e=e,f=f,h=h,i=i)

dput(m)
structure(list(a = c(113, 113, 113, 113, 111, 111, 115, 116, 
117, 118, 220, 220), b = c(113, 113, 113, 113, 111, 111, 115, 
116, 117, 118, 220, 220), c = c(2, 2, 1, 1, 5, 1, 1, 2, 1, 1, 
1, 4), d = c(2, 2, 12, 12, 15, 12, 12, 2, 12, 12, 12, 14), e = c(1, 
1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 3), f = c(20, 30, 25, 35, 45, 55, 
60, 65, 70, 75, 75, 80), h = structure(c(1L, 1L, 2L, 3L, 1L, 
5L, 4L, 4L, 6L, 6L, 7L, 7L), .Label = c("1A", "2A", "3A", "4A", 
"5A", "7A", "9A"), class = "factor"), i = c(12, 16, 17, 19, 20, 
15, 18, 17, 17, 13, 14, 15)), .Names = c("a", "b", "c", "d", 
"e", "f", "h", "i"), row.names = c(NA, -12L), class = "data.frame")

set.seed(5)
m$rand <- runif(nrow(m))

m[a==113,"i"] <- c(10,11,12)[1+findInterval(unlist(m[m$a==113,"rand",with=F]),c(0.25,0.50))] 
```

是否有任何简单的方法可以从一个具有所有这些对应关系的值向量中提取。例如有 [for a==113 c(​​0.25,0.50),values=c(10,11,12)] [for a==111 c(0.25,0.50,0.75),values=c(1,2, 3,4)] [for a==115 c(0.25,0.50,0.75),values=c(1,2,3,4)] 都在一个表格或框架中，并在使用 findinterval 函数时从中绘制？i 列应该被相关的值替换。我想要做的是从另一个文件中读取值（例如 c(10,11,12)），并在需要时放入 findinterval 函数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T23:43:17.160

0 和 1 是返回的内容`findInterval`。该结果应该用于索引您感兴趣的值。尝试：

```
> k[a==113,"WWW"] <- c(10,11)[1+findInterval(unlist(k[k$a==113,"rand",with=F]),c(0.45))]
 # or draw from the values vector based on your comment 
# (which should instead be an edit rather than a comment.
values=c(10,11,12)
k[a==113,"WWW"] <- values[1+findInterval(unlist(k[k$a==113,"rand",with=F]),c(0.45))]
> k
     a b  c d  e WWW      rand
1: 113 2  2 1 20  10 0.2002145
2: 113 2  2 1 30  11 0.6852186
3: 112 1 12 1 25  17 0.9168758
4: 114 1 12 1 35  19 0.2843995 
```

由于向量是基于 1 而不是基于零，因此您需要将 1 添加到结果中。

# c++ - 强制非专用模板实例化的编译错误

> ID：13850465
> 
> 赞同：1
> 
> 时间：2012-12-12T23:27:43.887
> 
> 标签：c++, templates, template-specialization

好的，这是我第一次涉足模板，这可能是几个非常愚蠢、简单的问题中的第一个。

考虑：

```
template <class T>
void sendit(char *buffer, unsigned len)
{
   // force compile error
}

void sendit<first_valid>(char *buffer, unsigned len)
{
   // this is OK
}

void sendit<second_valid>(char *buffer, unsigned len)
{
   // this is OK
} 
```

基本上，我的想法是我有一组可以由 sendit() 过程合法操作的“事物”，我将为这些事物专门设计模板。如果用户尝试调用 sendit()，（好吧，从技术上讲，sendit()），我想在他的脸上抛出一个编译错误。

这是可行的吗？如果是这样，怎么做？

这是一个合理的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-12T23:33:49.950

保持未定义：

```
template <class T>
void sendit(char *buffer, unsigned len);

// C++11
template <class T>
void sendit(char *buffer, unsigned len) = delete; 
```

使用`= delete`是 IMO 的首选方法。

或者，做某种类型的静态断言（在 C++03 中使用 Boost）：

```
template <class T>
void sendit(char *buffer, unsigned len) {
    static_assert(sizeof(T) == 0, "must specialize"); // must use sizeof to make it dependant on T
} 
```

* * *

无论如何，你确定你真的*需要*这里的类型模板吗？我并不是说你不应该，只是要知道有一些涉及重载的替代方案，例如：

```
// This is only if you're using the types as tags
// Don't do this otherwise!!!

void sendit(first_valid, char *buffer, unsigned len)
{
   // this is OK
}

void sendit(second_valid, char *buffer, unsigned len)
{
   // this is OK
}

sendit(first_valid(), ...); // call first
sendit(second_valid(), ...); // call second 
```

或者使用枚举而不是类型作为模板参数：

```
enum foo { first, second }

template <foo Foo>
void sendit(char *buffer, unsigned len);

void sendit<first>(char *buffer, unsigned len)
{
   // this is OK
} 
```

# php - 如何在 PHP 中处理 application/octet-stream（未压缩的 gzip 文件）？

> ID：13850470
> 
> 赞同：0
> 
> 时间：2012-12-12T23:27:55.850
> 
> 标签：php, gzip, guzzle

我必须解析很多（10000+）远程压缩文件。每个压缩文件都应该在其中包含一个 CSV（可能在一个文件夹中）。现在我可以获取正文，检查内容类型并解压缩，获得`application/octet-stream`.

问题是：什么是八位字节流，如何检查其中的文件或文件夹？

```
 /** @var $guzzle \Guzzle\Http\Client */
    $guzzle  = $this->getContainer()->get('guzzle');
    $request = $guzzle->get($url);

    try {
        $body = $request->send()->getBody();

        // Check for body content-type
        if('application/z-gzip' === $body->getContentType()) {
            $body->uncompress(); 
            $body->getContentType(); // application/octet-stream
        }
        else {
            // Log and skip current remote file
        }
    }
    catch(\Exception $e) {
        $output->writeln("Failed: {$guzzle->getBaseUrl()}");
        throw $e;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T08:25:02.560

存储body的EntityBody对象只能猜测本地文件的content-type。使用响应的 content-length 标头来获得更准确的值。

像这样的东西：

```
$response = $request->send();
$type = $response->getContentType(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T23:37:03.820

像一些shell命令之类的东西对你有用

```
shell_exec('gzip -d your_file.gz'); 
```

您可以首先解压缩特定目录中的所有文件，然后可以读取每个文件或您必须执行的任何计算。

作为旁注：

注意从哪里运行命令（不要使用 swith 来告诉“解压缩到该目录”）您可能也想看看 escapeshellarg ;-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-12T23:43:39.280

您应该能够使用内置的 gzuncompress 功能。

见[http://php.net/manual/en/function.gzuncompress.php](http://php.net/manual/en/function.gzuncompress.php)

编辑：或其他 zlib 函数，具体取决于您使用的数据。[http://php.net/manual/en/ref.zlib.php](http://php.net/manual/en/ref.zlib.php)

# android - 只是分享：在 Eclipse 中使用 Android 开发工具的最小 KML 文件

> ID：13850472
> 
> 赞同：1
> 
> 时间：2012-12-12T23:28:14.533
> 
> 标签：android, kml

我正在与我的妻子合作开发一个使用 GPS 监听器的 Android 应用程序。像（几乎）其他所有人一样，我们在 Eclipse 中使用 ADT。也像很多人一样，我们认为我们可以使用 Google 地球，导出 KML 文件并将其弹出到 ADT 中。没有这样的运气。就像许多其他人发现的那样。好吧，经过少量尝试，我们创建了一个文件，该文件可能是该工具可以导入的最小 KML 文件。即使它不是最小的文件，它也已大大减少。所以事不宜迟：

```
<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://earth.google.com/kml/2.2">
<Document>
   <!-- name>Title</name -->
      <Placemark><!-- name>PointName</name><description>Desc</description--><Point><coordinates>-118.383097,33.836978,193</coordinates></Point></Placemark>
      <Placemark><!-- name>PointName</name><description>Desc</description--><Point><coordinates>-118.383197,33.836988,193</coordinates></Point></Placemark>
</Document>
</kml> 
```

该文件中的要点是： - 命名空间标识符 - 嵌套在 'tudes 周围的元素（经度、纬度、高度） - 我已注释掉的可选信息 为了真正做到最小化，编辑掉注释的元素 - 但这些元素变成了对我有用，我把它们留在里面。它们与 ADT 一起作为注释或元素工作。请注意，我似乎需要为每个位置使用完整的元素嵌套。我确实尝试了坐标元素中单个长列表的变体，但无济于事。另一个有用的点可能是我使用 Excel 来计算我想要使用的数据，因此我还使用 Excel 来构建我的位置列表，以便我可以快速将我的更改剪切并粘贴到文件中。我在 Excel 的单元格中使用了以下行：

```
=CONCATENATE("<Placemark><!-- name>",J3,"</name><description>",K3,"</description--><Point><coordinates>",C3,",",D3,",",E3,"</coordinates></Point></Placemark>") 
```

快乐发展！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-08T00:25:12.853

这对我有用：

```
 <?xml version="1.0" encoding="UTF-8"?>
    <kml xmlns="http://earth.google.com/kml/2.2">
       <Placemark>
          <Point>
             <coordinates>0.0,0.0,0</coordinates>
          </Point>
       </Placemark>
    </kml> 
```

# mod-rewrite - RewriteCond 查询字符串 .htaccess

> ID：13850474
> 
> 赞同：0
> 
> 时间：2012-12-12T23:28:21.173
> 
> 标签：mod-rewrite

编辑：我必须添加一些东西。首先，由于 SEO，我想更改 url 显示。如果我使用 www 访问我的网站，没有问题，第二个链接出现，一切正常。

但是，如果我从链接中删除“www”，它会更改为第一个 url，我不希望这样。

我想改变

[http://www.mysite.com/index.php? *路线*= epson-claria-uyumlu-yazici-kartus-dolum-murekkebi-500g.html](http://www.mysite.com/index.php?_route_=epson-claria-uyumlu-yazici-kartus-dolum-murekkebi-500g.html)

至

[http://www.mysite.com/epson-claria-uyumlu-yazici-kartus-dolum-murekkebi-500g.html](http://www.mysite.com/epson-claria-uyumlu-yazici-kartus-dolum-murekkebi-500g.html)

我该怎么做？

我试过了

```
RewriteCond %{QUERY_STRING} ^_route_=(.*)$
RewriteRule ^index\.php$ /%1 [R=301,L] 
```

但它不工作。

我的 .htaccess 是

```
RewriteBase /

RewriteRule ^sitemap.xml$ index.php?route=feed/google_sitemap [L]

RewriteRule ^googlebase.xml$ index.php?route=feed/google_base [L]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} !.*\.(ico|gif|jpg|jpeg|png|js|css)
RewriteRule ^([^?]*) index.php?_route_=$1 [L,QSA]

RewriteCond %{QUERY_STRING} ^route=common/home$
RewriteRule ^index\.php$ http://www.mysite.com? [R=301,L]

RewriteCond %{HTTP_HOST} !^www\.mysite\.com$
RewriteRule (.*) http://www.mysite.com/$1 [R=301,L] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T23:30:25.800

Maybe this is what you're looking for:

```
RewriteRule ^(.*)$ index.php?route=$1 [L] 
```

If you have to visually change the address bar, leave the RewriteRule in place as I described above, and put this in your `index.php` before any output:

```
if(isset($_REQUEST['route']))
{
    header('Location: '.urlencode($_REQUEST['route']));
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T01:24:39.613

**初始说明：**我不是 Apache 大师，所以不要盲目依赖我的答案。

`www.`如果需要，我会首先重定向到

```
RewriteCond %{HTTP_HOST} !^www\. [NC]
RewriteRule ^(.*)$ http://www.%{SERVER_NAME}/$1 [R=301,L] 
```

然后让它转到`_route_`查询变量指示的页面

```
# if it is the index page...
RewriteCond %{REQUEST_URI} ^/(index\..+)?$ [NC]
# and if the query string starts with _route_=
RewriteCond %{QUERY_STRING} ^_route_=(.*)$
# redirect
RewriteRule ^(.*)$ http://%{SERVER_NAME}/%1? [R=301,L] 
```

最后一行中的服务器变量`SERVER_NAME`可能需要用`HTTP_HOST`.

# internet-explorer - IE 8 javascript 现代化工具

> ID：13850478
> 
> 赞同：0
> 
> 时间：2012-12-12T23:28:47.390
> 
> 标签：internet-explorer, javascript

我的客户使用 IE 8，它没有较新的浏览器具有的几种数组方法。该应用程序也必须在其他浏览器中运行（chrome 和 FF）。

为了能够在 IE 8 中使用这些数组方法进行编程，我包含了非常适合我们的“数组原型扩展”库（ [js-methods 项目的一部分）。](https://code.google.com/p/js-methods/)

鉴于我真的不知道 IE 8 javascript 版本和 IE 9/10 版本之间的所有区别，我想知道我是否有更好的选择。我的意思是，其他库来“升级”javascript。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T23:32:12.147

如果您只需要 Array 方法，那么您明智地选择了。如果您需要更强大的功能，请查看 jquery 或 ExtJs。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T23:32:49.027

我不认为你现在的做法有什么问题。这正是[js-methods](https://code.google.com/p/js-methods/)项目的设计目的。

# c++ - 应该在游戏循环 C++ 中调用 std::async 吗？

> ID：13850481
> 
> 赞同：1
> 
> 时间：2012-12-12T23:29:30.947
> 
> 标签：c++, multithreading, c++11

调用 std::async 的效率如何？它可以用于在游戏循环中发出任务吗？

我希望我的所有输入检测都在一个单独的线程上，并在我的主线程的游戏循环中的某个点同步，以便我可以轮询输入。

我能想到的唯一方法是拆分我的输入检测任务，并`std::async`在实际游戏循环开始时使用它们调用它们，然后`wait()`在循环中稍后调用以同步数据，但我希望每次迭代都具有相同的行为循环，所以这个调用一定很昂贵......

是这样吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T04:48:57.843

至少在 IMO，您应该在轮询和异步操作之间下定决心。

如果您要进行投票，那么使用`std::async`是多余的。无论如何，您都会从主线程进行轮询，因此您不妨直接让它轮询它关心的内容并完成它。使用`std::async`启动其他东西只会增加将数据获取到主线程的延迟。

如果您要使用`std::async`，那么您应该采用一种完全不同的方法：获取输入的线程独立运行。当他们找到一些输入时，他们将其发送到主线程，并告诉它有一些输入要处理（例如，通过设置信号量）。然后主线程对该信号量做出反应，检索输入数据（例如，从队列中）并处理它。

在后一种情况下，轮询是没有意义的：如果输入线程没有告诉主线程一些输入数据，那么根本就没有。在这种情况下，轮询输入数据是没有意义的——你已经知道没有。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-13T14:00:14.527

假设它写得很好，那么`std::async(std::launch::async, ...)`应该不会比一个小的堆分配和构造一个`std::thread`. 如果创建一个新`std::thread`的来完成这项工作对您来说足够高效，那么`std::async`将足够高效，但会省去您编写同步以将结果返回到主线程的麻烦。

如果为每件作品创建一个新`std::thread`的不合适，那么`std::async`可能也不合适。

（请记住，除非您指定`std::launch::async`启动策略，否则不能保证任务异步执行，它可能会被推迟到您调用`get()`返回的未来。）

# c++-cli - 在托管代码中传递非托管数据？

> ID：13850482
> 
> 赞同：1
> 
> 时间：2012-12-12T23:29:31.763
> 
> 标签：c++-cli, windows-forms-designer, arrayfire

我正在构建一个 Windows 窗体应用程序，该应用程序使用 ArrayFire `array`对象控制 3D 体积渲染。是不受管理的`array`。在表单构造函数中，我加载并渲染了体积。

我有一个`Trackbar`控制音量的不透明度和一个相应的滚动事件处理程序。但是，我不知道如何将音量传递`array`给`Trackbar`滚动事件处理程序，以便重新渲染音量。

我不能将卷`array`作为表单的属性，因为显然托管类不能具有非托管属性。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T04:46:30.940

托管类不能具有非托管类型的字段，但它可以具有*指向*非托管类型的指针的字段。在非托管类型的末尾粘贴 a `*`，您应该能够将其传递给您想要的任何方法，并将其存储在您想要的任何地方。

# javascript - 选择隐藏元素并使用 jQuery 操作它们

> ID：13850485
> 
> 赞同：5
> 
> 时间：2012-12-12T23:29:56.890
> 
> 标签：javascript, jquery, jquery-selectors

在具有“section”类的 div 包装器中，我在页面上重复了几十个 HTML 元素，如下所示：

```
<div class="section">
  <div class="article"></div>
  <div class="article"></div>
  <div class="article"></div>
</div> 
```

而且每一个里面都包含一定的信息。现在，我要做的是一旦页面加载，只显示前 5 个，将其余部分隐藏在一个用 jQuery 插入的新 div 中，当点击这个新 div 时，它将显示下一个 5 ，然后是下一个五点再次点击，以此类推直到结束。这个想法是这个新的 div 将用作一个按钮，该按钮将始终位于页面的末尾，并将响应我刚才提到的这些命令。到目前为止，我已经解决了这个问题：

```
$('.section').each(function () {
    var $this = $(this),
        $allArticles = $this.find('.article');

    if ($allArticles.length > 5) {
        $('<div/>').addClass('hidden-articles').appendTo(this).append($allArticles.slice(5));
        $('.hidden-articles .article').hide();
    }
}); 
```

这隐藏了除前五个之外的所有内容。但是现在对于剩下的过程，我无法让它工作。我似乎无法正确选择那些带有“文章”类的隐藏 div 并操纵它们以按照我上面描述的方式运行。如果有更多 jQuery 经验的人可以指导我正确的方向并可能提供一个片段，我将不胜感激。提前谢谢了！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-12T23:37:22.517

您可以使用 :hidden 和 :lt 选择器来获得您正在寻找的功能。

```
$('.section').each(function() {
    var $this = $(this),
        $allArticles = $this.find('.article');

    if ($allArticles.length > 5) {
        $('<div/>').addClass('hidden-articles')
                   .appendTo(this).append($allArticles.slice(5));
        $this.find('.hidden-articles .article').hide();

    }
});

$('#show').on('click',function() {
    var $hidden = $('.hidden-articles .article:hidden:lt(5)');
    $hidden.show();
});​ 
```

**更新**

```
// If one one element to search 
var elem = '.section' ;
hideArticles(elem);

// If Multiple Elements on the page...
$('.section').each(function() {
    hideArticles(this);
});

$('#show').on('click', function() {
    var $hidden = $('.hidden-articles .article:hidden:lt(5)');
    $hidden.show();
});

function hideArticles(elem) {
    var $this = $(elem),
        $allArticles = $this.find('.article');

    if ($allArticles.length > 5) {
        $('<div/>').addClass('hidden-articles')
                   .appendTo(this).append($allArticles.slice(5));
        $this.find('.hidden-articles .article').hide();
    }
}​ 
```

**[检查小提琴](http://jsfiddle.net/jBkp6/2/)**

# php - PHP - 解析 UTF-8 XML

> ID：13850487
> 
> 赞同：1
> 
> 时间：2012-12-12T23:30:01.693
> 
> 标签：php, xml, utf-8

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T08:01:48.083

# jquery - how to make a div background continuously move using animate in jquery

> ID：13850488
> 
> 赞同：-4
> 
> 时间：2012-12-12T23:30:04.463
> 
> 标签：jquery

```
$("#marlin").animate({opacity:'0.4'});

   $("#marlin").animate({top:'550px',opacity:'0.4'},"slow");

    $("#marlin").animate({right:'430px'},"slow");

    $("#marlin").animate({top:'450px',opacity:'0.4'},"slow");

    $("#marlin").animate({top:'550px',opacity:'0.4'},"slow");

    $("#marlin").animate({right:'200px'},"slow");

    $("#marlin").animate({top:'350px',right:'210px',opacity:'0.4'},"slow");

    $("#marlin").animate({width:'50px',opacity:'0.4'},"slow");

   $("#marlin").animate({width:'50px',opacity:'0.6'},"slow"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T23:56:03.750

```
> you can go to this tutorial , 
> http://www.w3schools.com/jquery/jquery_animate.asp
> 
> hope it will help you. 
```

# rubymine - How can I insert Rdoc comments in RubyMine

> ID：13850490
> 
> 赞同：12
> 
> 时间：2012-12-12T23:30:09.870
> 
> 标签：rubymine, rdoc

When I used Visual Studio I was used to inserting XML comments with just a few key presses at the beginning of the method definition (I think /// but it's been a while). Is there a way to insert an RDoc comment before a method inside of RubyMine out of the box? If so what is the keyboard shortcut?

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2017-08-07T11:54:41.460

我也有类似的问题，默认的`alt enter`方式不是很好。您必须`alt enter`多次，并且生成的类型始终是`Object`.

所以我写了一个插件来做这个技巧，

![例子](../Images/349606521864386054674f93ceec5681.png)

并且我已经将插件上传到JetBrains（Plugin Repository），大家可以搜索`ruby-doc-adder`下载使用。

[https://plugins.jetbrains.com/plugin/9904-ruby-doc-adder](https://plugins.jetbrains.com/plugin/9904-ruby-doc-adder)。

另请参阅[自述文件](https://github.com/aristotll/RubyDocAdder)以了解用法。

# javascript - Regular Expression to find complex markers

> ID：13850492
> 
> 赞同：0
> 
> 时间：2012-12-12T23:30:31.910
> 
> 标签：javascript, regex

I want to use JavaScript's regular expression something like this

```
/marker\d+"?(\w+)"?\s/gi 
```

In a string like this:

```
IDoHaveMarker1"apple" IDoAlsoHaveAMarker352pear LastPointMakingmarker3134"foo" 
```

And I want it to return an array like this:

```
[ "apple", "pear", "foo" ] 
```

The quotes are to make clear they are strings. They shouldn't be in the result.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-12T23:35:41.000

如果您询问如何实际使用正则表达式：

要获取多个（全局）匹配的所有捕获，您必须使用循环并`exec`在 JavaScript 中：

```
var regex = /marker\d+"?(\w+)/gi;
var result = [];
var match;
while (match = regex.exec(input)) {
    result.push(match[1]);
} 
```

（请注意，`"?\s?`如果您只对捕获感兴趣，则可以省略尾随，因为它们无论如何都是可选的，因此它们不会影响匹配的结果。）

不，`g`不允许您在一个电话中完成所有这些。如果您省略了`g`then`exec`每次都会返回相同的匹配项。

正如 Blender 提到的，如果您想排除`Marker13"something Marker14bar`(unmatched `"`) 之类的事情，您需要使用另一个捕获组和反向引用。请注意，这会将您想要的捕获推送到 index `2`：

```
var regex = /marker\d+("?)(\w+)\1/gi;
var result = [];
var match;
while (match = regex.exec(input)) {
    result.push(match[2]);
} 
```

# h2 - Flyway 和 H2：为什么 schema_version 表和列是小写和区分大小写的？

> ID：13850499
> 
> 赞同：1
> 
> 时间：2012-12-12T23:31:32.633
> 
> 标签：h2, flyway

更多信息：

[http://www.h2database.com/javadoc/org/h2/constant/DbSettings.html#DATABASE_TO_UPPER](http://www.h2database.com/javadoc/org/h2/constant/DbSettings.html#DATABASE_TO_UPPER)

[https://groups.google.com/forum/?fromgroups=#!topic/h2-database/B1zEC0V6m34](https://groups.google.com/forum/?fromgroups=#!topic/h2-database/B1zEC0V6m34)

看起来所有大写字母都是 H2 的默认值。

![在此处输入图像描述](../Images/ac9620ed85983ca725338d362a935d1c.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T09:07:15.013

由于创建脚本中的引号，schema_version 表名区分大小写。这允许标识符中不支持的字符。如果您愿意，可以将 flyway.table 配置为大写值。

表中的列是 Flyway 内部的，并不意味着作为公共 API。它们是私有的，因此可以从一个 Flyway 版本更改为下一个版本。Flyway 将始终确保这些更改是自动进行的，无需您手动操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-22T00:22:19.047

您将表名括在“双引号”中，以确保创建的实际表不会受到 toUpperCase 转换的影响——某些 dbs 配置支持的功能。

将“表”括在引号中可确保创建的表完全符合要求。

# iphone - How can I set a boolean so that it is not necessarily true but not default to false in the ViewDidLoad?

> ID：13850501
> 
> 赞同：1
> 
> 时间：2012-12-12T23:31:36.303
> 
> 标签：iphone, objective-c, ios

I am making an iPhone app and want to use an 'if' statement and a boolean to set default values in some instances but not others... is this possible?

Are there alternative options if it is not possible?

EDIT: In the MainViewController.m I have:

```
@interface MainViewController (){
    BOOL moveOver;
}
[...]
- (void)viewDidLoad
{
    [super viewDidLoad];
    _label.text = [NSString stringWithFormat:@"%i", computerSpeed];
    }
}
[...]
- (void)flipsideViewControllerDidFinish:(FlipsideViewController *)controller
{
    [self dismissViewControllerAnimated:YES completion:nil];
    moveOver = true;    
} 
```

EDIT: The problem that it is redefined when the ViewDidLoad still persists... I need a statement that will not redefine when the ViewDidLoad runs (sorry for the unclarity)

EDIT: I have something that I feel like is much closer to working...

In the ViewDidLoad I have:

```
if (playToInt != 10  || computerMoveSpeed != 3) {   
    moveOver = TRUE;
} 
```

which connects to my created method, gameLoop. It has

```
if (moveOver == false) {
    computerMoveSpeed = 3;        
    playToInt = 10;    
} 
```

I have two UITextFields and typed 10 and 3 in them... does this not set it to the default? It seems to set the default to 0 for both, how do I change this?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-12T23:35:16.537

在构造函数中以一种或另一种方式初始化它。

听起来您想要两个以上的状态，在这种情况下，您可以使用枚举甚至整数 0-1-2 来表示错误、不完全正确和正确。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T00:17:17.660

考虑到前面的答案，您还可以创建一个`enum`来处理多个状态。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T00:49:18.850

您可以将布尔值存储在 NSNumber 中，该值可以是 nil、true 或 false（nil 表示未初始化）。

# android - Android Fragment, going back without recreating/reloading Fragment

> ID：13850506
> 
> 赞同：14
> 
> 时间：2012-12-12T23:32:08.387
> 
> 标签：android, android-fragments

I've seen quite a few questions on SO about Fragments and I still can't seem to figure out if what I want to do is possible, and more so if my design pattern is just flawed and I need to re-work the entire process. Basically, like most questions that have been asked, I have an ActionBar with NavigationTabs (using ActionBarSherlock), then within each Tab there is a FragementActivity and then the FragmentActivities push new Fragments when a row is selected (I'm trying to re-create an iOS Project in Android and it's just a basic Navigation based app with some tabs that can drill down into specific information). When I click the back button on the phone the previous Fragment is loaded but the Fragment re-creates itself (so the WebServices are called again for each view) and this isn't needed since the information won't change in a previous view when going backwards. So basically what I want to figure out is how do I setup my Fragments so that when I push the back button on the phone, the previous Fragment is just pulled up with the previous items already created. Below is my current code :

```
 //This is from my FragmentActivity Class that contains the ActionBar and Tab Selection Control
    @Override
public void onTabSelected(ActionBar.Tab tab, FragmentTransaction ft) {
    // TODO Auto-generated method stub
    int selectedTab = tab.getPosition();

    if (selectedTab == 0) {
        SalesMainScreen salesScreen = new SalesMainScreen();
        ft.replace(R.id.content, salesScreen);
    }
    else if (selectedTab == 1) {
        ClientMainScreen clientScreen = new ClientMainScreen();
        ft.replace(R.id.content, clientScreen);
    }.....

   //This is within the ClientMainScreen Fragment Class, which handles moving to the Detail Fragment
   row.setOnClickListener(new View.OnClickListener() {
                        @Override
                        public void onClick(View view) {
                            //Do something if Row is clicked
                            try{
                                String selectedClientName = clientObject.getString("ClientName");
                                String selectedClientID = clientObject.getString("ClientID");
                                String selectedValue = clientObject.getString("ClientValue");
                                transaction = getFragmentManager().beginTransaction();
                                ClientDetailScreen detailScreen = new ClientDetailScreen();
                                detailScreen.clientID = selectedClientID;
                                detailScreen.clientName = selectedClientName;
                                detailScreen.clientValue = selectedValue;
                                int currentID = ((ViewGroup)getView().getParent()).getId();
                                transaction.replace(currentID,detailScreen);
                                transaction.addToBackStack(null);
                                transaction.commit();

                            }
                            catch (Exception e) {
                                e.printStackTrace();
                            }
                        }
                    });....

     //And then this is the Client Detail Fragment, with the method being called to Call the Web Service and create thew (since what is displayed on this screen is dependent on what is found in the Web Service
          @Override
public View onCreateView(LayoutInflater inflater, ViewGroup group, Bundle saved) {
    return inflater.inflate(R.layout.clientdetailscreen, group, false);
}

@Override
public void onActivityCreated (Bundle savedInstanceState) {
    super.onActivityCreated(savedInstanceState);

    //Setup Preferences File Link
    this.preferences = PreferenceManager.getDefaultSharedPreferences(getActivity());

    //initialize the table object
    mainTable = (TableLayout)getActivity().findViewById(R.id.mainTable);

    //setup the detail table
    setupRelatedClientSection();

} 
```

The Client Detail Screen can then drill down one more time, using the same method as the Client Main Screen but when I go back from that new screen to the Detail Screen the seuptRelatedClientSection() method is called again and so the entire Fragment is rebuilt when really I just want to pull up a saved version of that screen. Is this possible with my current setup, or did I approach this the wrong way?

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2015-08-25T10:38:28.990

尝试使用 fagementTransaction.add 而不是替换

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-12T23:46:24.000

我相信你正在寻找`show()`和`hide()`。

我认为您仍然可以将它们添加到后台。

```
 transaction.hide(currentFragment);
 transaction.show(detailScreen);
 transaction.addToBackStack(null);
 transaction.commit(); 
```

我没有要查看的代码，但我相信这就是它的运行方式...尝试一下，除非其他人有更好的方法。我没有尝试过使用 show() hide() 的 backstack，但我相信它会接受在事务提交之前所做的更改，并且如果按下后退按钮将撤消它们。请就这个问题与我联系，因为我很想知道。

您还必须确保在调用它之前创建了详细信息片段。由于它是基于对某个项目的单击，因此您可能应该在每次单击时创建详细信息片段，以确保创建了正确的详细信息片段。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-05-19T04:35:29.390

我将这个答案发布给将来可能会提到这个问题的人。

以下代码将演示如何通过按返回按钮从 FragmentA 打开 FragmentB 并从 FragmentB 返回到 FragmentA（不刷新 FragmentA）。

```
public class FragmentA extends Fragment{

   ...

   void openFragmentB(){

       FragmentManager fragmentManager = 
           getActivity().getSupportFragmentManager();
       FragmentB fragmentB = FragmentB.newInstance();

       if (fragmentB.isAdded()) {

           return;
       } else {

           fragmentManager.
               beginTransaction().
               add(R.id.mainContainer,fragmentB).
               addToBackStack(FragmentB.TAG).
               commit();
      }
   }
}

public class FragmentB extends Fragment{

    public static final String TAG = 
        FragmentB.class.getSimpleName();

    ...

    public static FragmentB newInstance(){

        FragmentB fragmentB = new FragmentB();
        return fragmentB;
    }

    @Override
    public void onResume() {

        super.onResume();
        // add this piece of code in onResume method
        this.getView().setFocusableInTouchMode(true);
        this.getView().requestFocus();
    }
} 
```

在您的 MainActivity 覆盖 onBackPressed()

```
class MainActivity extends Activity{
    ...

    @Override
    public void onBackPressed() {

        if (getFragmentManager().getBackStackEntryCount() > 0) {

            getFragmentManager().popBackStack();
        } else {

            super.onBackPressed();
        }
    } 
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-12T23:52:42.640

你是对的，以前有很多关于这个主题的问题/文档；）

有关 Fragments 的文档，特别是有关事务和保存状态的部分，将引导您找到答案。

[http://developer.android.com/guide/components/fragments.html#Transactions](http://developer.android.com/guide/components/fragments.html#Transactions)

[http://developer.android.com/guide/components/activities.html#SavingActivityState](http://developer.android.com/guide/components/activities.html#SavingActivityState)

[Android - 片段 onActivityResult 避免重新加载](https://stackoverflow.com/questions/12054062/android-fragment-onactivityresult-avoid-reloading?rq=1)

Fragments 可以支持`onSaveInstanceState`但不支持`onRestoreInstanceState`，因此如果您想保存对表视图的引用，请将它们保存到 ，`Bundle`然后您可以在`onActivityCreated`方法中访问保存的视图。您也可以使用 Fragments 回栈。

[本指南/教程](http://marakana.com/s/post/1250/android_fragments_tutorial)在回栈和保留片段状态上有非常详细的说明/示例。

祝你好运

# android - Android layout measuring time doubles with each step up the hierarchy

> ID：13850509
> 
> 赞同：1
> 
> 时间：2012-12-12T23:32:19.933
> 
> 标签：android, android-layout, hierarchyviewer

I'm analyzing a tablet UI in hierarchyviewer and I noticed the following pattern in **measure** times (starting from the base of the tree and moving up):

... ~40 ms ... ~80 ms ... ~160 ms ... ~320 ms ... ~640 ms ... ~1280 ms ...

I assumed the problem was LinearLayouts with nested weights, so I removed ALL LinearLayouts and weights in the whole hierarchy. Now I have this:

... ~40 ms ... ~80 ms ... ~160 ms ... ~160 ms ... ~160 ms ... ~310 ms ...

Better, but it still doubles every few levels. **What could be causing this?**

Here is the full hierarchy for this path (pardon the length... feel free to throw your best optimization tips at me):

```
[generated layouts]
 *RelativeLayout [309 ms]
   FrameLayout [164 ms]
    NoSaveStateFrameLayout [160 ms]
    *RelativeLayout [151 ms]
     *RelativeLayout [77 ms]
       ListView [45 ms]
        GridLayout [46 ms]
         Spinner [4.4 ms]
          TextView [0.1 ms] 
```

*view time doubles

Any advice will be greatly appreciated! Thanks in advance.

# TL;DR

*Other than nested weights, what causes exponential increase in measure times?*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-07-05T14:45:29.533

西蒙以前的回答不太正确。确实有一个测量通道和一个布局通道，但仅凭这一事实并不会导致指数级爆炸。

如果您在层次结构中的各个 View 上的 onMeasure() 和 onLayout() 中放置跟踪，您会发现布局传递不是问题：onLayout() 仅在每个 View 上调用一次，使其成为线性时间遍历。测量传递是问题 - 对于ViewGroup的*某些子类，带有**一些*参数， onMeasure() 最终会调用每个孩子的 onMeasure() 两次，这当然会导致您所看到的行为。

RelativeLayout 是这些“坏公民”之一，它会测量每个孩子两次，这与您的观察结果一致。

当孩子拥有 MATCH_PARENT 和非零权重时，另一个坏公民（如您所知）是 LinearLayout。我已经查看了实现，我大致遵循它在做什么——首先它递归地测量孩子一次，看看他们想要多大，然后，如果有任何松弛（或收缩），它测量孩子再次使用非零权重以分配松弛。

请注意，RelativeLayout 经常被引用为指数爆炸的解决方案，即使它是导致它的坏公民之一。我相信原因是RelativeLayout 具有足够的表现力，可以将LinearLayouts 的深层层次结构重新表示为单个RelativeLayout。这是非常重要的一点——如果你只是用相对布局替换线性布局而不扁平化层次结构，你仍然会有指数测量时间。

我不清楚指数爆炸是否最终可以在核心库中简单地优化掉（也许通过将现有的度量传递分为聚集首选大小传递和分布松弛传递，每个都可以是在线性时间内完成并且不需要相互调用）或者LinearLayout和RelativeLayout的合同中是否有某些东西使得递归双重测量孩子本质上是必要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T23:49:32.160

Android 在 2 遍中构建布局。

第一个是测量通过，当所有孩子都被问到他们想要多大时。然后是布局传递，当父母告诉孩子他们有多大并要求他们画画时。

因此，添加一个额外的 ViewGroup 级别大约会使时间翻倍。这与您给出的示例一致。

# java - What could cause a java process to get gradually decreasing share of CPU?

> ID：13850510
> 
> 赞同：3
> 
> 时间：2012-12-12T23:32:26.133
> 
> 标签：java, linux, jvm

I have a very simple java program that prints out 1 million random numbers. In linux, I observed the %CPU that this program takes during its lifespan, it starts off at 98% then gradually decreases to 2%, thus causing the program to be very slow. What are some of the factors that might cause the program to gradually get less CPU time?

I've tried running it with `nice -20` but I still see the same results.

EDIT: running the program with `/usr/bin/time -v` I'm seeing an unusual amount of involuntary context switches (588 voluntary vs 16478 involuntary), which suggests that the OS is letting some other higher priority process run.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T23:38:33.307

它归结为两件事：

*   I/O 很昂贵，并且
*   根据您存储数字的方式，这也会对性能产生不利影响。

如果您主要`System.out.println(randInt)`在循环中执行一百万次，那么这可能会变得昂贵。I/O 不是免费提供的东西之一，写入任何输出流都会消耗资源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T23:36:39.107

我将首先通过 JConsole 或 VisualVM 进行分析，以查看它在 CPU 百分比较低时实际在做什么。正如评论中提到的，它很有可能被阻塞，例如等待 IO（用户输入、SQL 查询需要很长时间等）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-12T23:40:16.440

如果您的应用程序受 I/O 限制 - 例如等待网络调用的响应或磁盘读/写

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-12T23:59:28.830

如果你想尝试平衡一切，你应该创建一个队列来保存要打印的数字，然后让一个线程生成它们（生产者），另一个线程读取并打印它们（消费者）。这可以很容易地用[`LinkedBlockingQueue`](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/LinkedBlockingQueue.html).

```
public class PrintQueueExample {

    private BlockingQueue<Integer> printQueue = new LinkedBlockingQueue<Integer>();

    public static void main(String[] args) throws InterruptedException {
        PrinterThread thread = new PrinterThread();
        thread.start();
        for (int i = 0; i < 1000000; i++) {
            int toPrint = ...(i) ;
            printQueue.put(Integer.valueOf(toPrint));
        }
        thread.interrupt();
        thread.join();
        System.out.println("Complete");
    }

    private static class PrinterThread extends Thread {

        @Override
        public void run() {
            try {
                while (true) {
                    Integer toPrint = printQueue.take();
                    System.out.println(toPrint);
                }
            } catch (InterruptedException e) {
                // Interruption comes from main, means processing numbers has stopped
                // Finish remaining numbers and stop thread
                List<Integer> remainingNumbers = new ArrayList<Integer>();
                printQueue.drainTo(remainingNumbers);
                for (Integer toPrint : remainingNumbers)
                    System.out.println(toPrint);
            }
        }
    }
} 
```

这段代码可能有一些问题，但这是它的要点。

# python - Randomizing order of test execution with nosetests

> ID：13850512
> 
> 赞同：3
> 
> 时间：2012-12-12T23:32:28.830
> 
> 标签：python, nose

I have a suite of tests that I recently discovered had an (incorrect) ordering relationship. They are all supposed to be independent.

Nose appears to run tests in the same order each time, which will not per se uncover these dependencies unless the *magic* happens and I manage to inject something which causes a failure (not my favorite method of programming).

How do I instruct nose to randomize the order of tests it executes?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T02:13:23.023

没有内置的方法可以做到这一点。我环顾四周，有一个鼻子插件声称可以随机化测试顺序：

[https://github.com/my8bird/nose-randomize](https://github.com/my8bird/nose-randomize)

从源代码来看，它似乎只适用于从 unittest.TestCase 继承的测试。如果这对您不起作用，您当然可以将其用作编写自己的开始。

如果您只想一次性公开依赖项，则可以将测试列表传递给鼻子。一种惰性方法是获取测试列表，并一一通过所有排列：

```
nosetests /path/to/testA.py /path/to/testB.py /path/to/testC.py
nosetests /path/to/testA.py /path/to/testC.py /path/to/testB.py
nosetests /path/to/testB.py /path/to/testA.py /path/to/testC.py
nosetests /path/to/testB.py /path/to/testC.py /path/to/testA.py
nosetests /path/to/testC.py /path/to/testA.py /path/to/testB.py
nosetests /path/to/testC.py /path/to/testB.py /path/to/testA.py 
```

运行可能需要一整夜，但您至少会知道问题出在哪里。

希望这能让你开始。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-09-19T05:46:48.900

您可以通过使用类名指定测试用例的完全限定路径来按顺序运行

```
./nose <<testcasename>>:<<classname>>.testcase_name1 <<testcasename>>:<<classname>>.testcase_name2
        <<testcasename>>:<<classname>>.testcase_name4 
```

将这些路径复制到 bat.cfg 文件中并使用 ./nose -c bat.cfg 运行

# python - Python 与 OS X 交互 - 有可能吗？

> ID：13850513
> 
> 赞同：2
> 
> 时间：2012-12-12T23:32:42.443
> 
> 标签：python, macos

我将解释我的问题：是否可以编写一个以*高级*方式与 OS X 架构交互的 Python 脚本？例如，我可以通过 Python 脚本控制 Mac OS X 窗口的**大小吗？**有模块吗？我没有找到任何东西。

为了进一步推动事情，我也可以控制键盘快捷键吗？`cmd + Enter` *我的意思是，使用 Python，我是否可以编写一个脚本，每次我在任何地方输入时都会*打开一个终端窗口，就好像它是一个系统快捷方式（**Awesome WM**风格，如果你知道我在说什么的话）？

希望我已经清楚了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T23:48:29.773

第二个你不能确定，因为事件被其他进程抓取。您应该寻找一个特定于 osx 的库来执行此操作，然后围绕它编写一个 python 包装器。

# jsf - 如何使 facelets 符合 XHTML 1.0 Transitional？

> ID：13850515
> 
> 赞同：0
> 
> 时间：2012-12-12T23:32:47.100
> 
> 标签：jsf, xhtml, facelets, standards-compliance

为什么 facelets XHTML 文件不能成为有效的 XHTML 1.0 过渡文件？如果我在 xml 验证器（例如 w3c 验证器）中提交了一个 facelet 文件，它会在其中一个标记库中定义的第一个标记上显示错误。

示例 1：

如果我将以下文件提交给验证器，它没有显示错误，验证正常，因为文档中没有出现 taglib 标记（虽然定义了一个 jsf taglib）。

```
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html">
<head>
<title></title>
</head>
<body>
</body>
</html> 
```

示例 2：

现在我刚刚从 xmlns:h 命名空间中插入了 h:head 和 h:body 标签，但这会导致验证出错。

```
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html">
<h:head>
<title></title>
</h:head>
<h:body>
</h:body>
</html> 
```

当然，我在这里遗漏了一些基本的东西，但我仍然无法弄清楚是什么。

这是我在这里的第一个问题，所以请指出任何错误，谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-12T23:55:56.830

如果您检查[Facelets 应用程序的生命周期，](http://docs.oracle.com/javaee/6/tutorial/doc/giprr.html)您可以看到您的视图已呈现给客户端。这将转换标签，比如`<h:head>`用它们的 xhtml 等价物替换它们，例如`<head>`. 如果您想要 XHTML 有效的模板，您可能想尝试使用 jsfc 属性，但它有其[缺点。](https://stackoverflow.com/questions/2337908/should-i-use-facelets-jsfc-attribute)

# c# - 在 WP8 中创建自己的切换按钮？

> ID：13850517
> 
> 赞同：0
> 
> 时间：2012-12-12T23:32:53.353
> 
> 标签：c#, android, wpf, windows-phone-7, windows-phone-8

我需要将具有小部件的 Android 应用程序移植到 WP8。

为此，我需要创建自己的切换按钮（用户控件）。所以我刚刚创建了一个名为 MyToggleButton 的 Button 子类，并使用标准回调来更改按钮的图像和文本。

为了捕捉我使用`onMouseEnter`的点击，当点击完成时，我使用 moud 按钮再次上升`onMouseLeave`

虽然这可以毫无问题地工作 - 问题是当单击`onMouseEnter`似乎有一点延迟时，这个按钮会以最小的延迟更改 ButtonImage，而不是普通按钮（我使用 Visual Studio Express 2012 和模拟器，因为我这样做了还没有真正的手机进行测试）

虽然我发现了在 XAML 中创建用户控件的其他方法，但我发现所描述的仅使用标准方法的方法更容易。我只是不确定，这个最小的延迟是从哪里来的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T03:22:05.550

在第一种情况下，您可能不应该进行自定义切换。从 Android 移植应用程序并不意味着您还必须移植其图形。他们根本不共享相同的设计语言。您可能应该坚持使用原生 WP8 切换。

但是，如果你真的想创建一个自定义复选框/切换，你应该检查[这个](http://dotnetventures.wordpress.com/2011/07/21/custom-checkbox-template-for-windows-phone-7-image-checkbox/)。这是为 WP7 制作的，但也适用于 WP8。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T03:43:00.677

这是一个使用图像的简化“切换”按钮。基于`CheckBox`

```
<Style TargetType="{x:Type CheckBox}" >
            <Setter Property="Template" >
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type CheckBox}">
                        <Grid>
                            <ContentPresenter x:Name="Part_Content" />
                            <Image Name="image" Source="/WpfApplication4;component/Images/avatar63.jpg" />
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="true" >
                                <Setter TargetName="image" Property="Source" Value="/WpfApplication4;component/Images/imagesCA7JZMMY.jpg"/>
                            </Trigger>
                            <Trigger Property="IsChecked" Value="False" >
                                <Setter TargetName="image" Property="Source" Value="/WpfApplication4;component/Images/avatar63.jpg"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style> 
```

# html - 内联块元素的边距

> ID：13850519
> 
> 赞同：0
> 
> 时间：2012-12-12T23:33:32.263
> 
> 标签：html, margin, css

HTML：

```
hello there! <div class='badge'>give this a small margin.</div> Please!​ 
```

CSS：

```
.badge {
   display: inline-block;
   margin-top: -2px;
} 
```

在这里看小提琴：http: [//jsfiddle.net/ThySQ/2/](http://jsfiddle.net/ThySQ/2/)

如何给 div 中的文本留出边距？它似乎不像这样工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-12T23:39:13.837

为内联内容添加负边距不起作用（至少在大多数浏览器上）。如果要向上移动文本，可以相对定位元素并将顶部设置为负数。

```
.badge {
   display: inline-block;
   top: -2px;
   position: relative;
} 
```

[http://jsfiddle.net/ThySQ/4/](http://jsfiddle.net/ThySQ/4/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T23:45:42.507

您需要对 div 应用填充以在 div 中应用额外的空间。

```
.badge {
   display: inline-block;
   margin-top: -2px;
   padding: 4px;  /* sets up a 4px margin all around the inside edge of the div */

} 
```

这将影响 div 中的任何内容。

# android - Android DDMS 错误地标记了应用程序

> ID：13850521
> 
> 赞同：0
> 
> 时间：2012-12-12T23:33:33.517
> 
> 标签：android, ddms

我正在运行我的应用程序并查看 DDMS 中的日志。有时应用程序名称会更改为“system_process”。该应用程序似乎运行正常。有人看过这个吗？它有什么影响吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T23:37:46.630

系统进程**不是**您的应用程序，不会运行您的任何代码。

但是，您的代码所做的某些事情会导致在系统进程中完成工作。

# html - 如何有一个无法选择默认文本的下拉列表？

> ID：13850522
> 
> 赞同：3
> 
> 时间：2012-12-12T23:33:37.887
> 
> 标签：html, css

例如，具有选项 1,2 和 3 但具有默认文本“进行选择...”而不是可选选项的下拉列表。

如果这令人困惑，那[就是 fiddle](http://jsfiddle.net/66Tbz/)。基本上，当您单击下拉菜单时，我不希望您在该示例中看到“进行选择...”。只有 1,2 和 3。

我认为它可以用一些 javascript 来完成，但这似乎是 hackish。

代码：

```
<select>
    <option>make a selection...</option>
    <option>1</option>
    <option>2</option>
    <option>3</option>
</select> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-12T23:39:18.890

```
<select>
    <option selected="true" disabled="true" >make a selection...</option>
    <option>1</option>
    <option>2</option>
    <option>3</option>
</select>​ 
```

[http://jsfiddle.net/Et4VH/](http://jsfiddle.net/Et4VH/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-12T23:57:58.287

看起来您可以使用以下方法执行此操作`display:none`：

```
<select>
    <option style="display:none">make a selection...</option>
    <option>1</option>
    <option>2</option>
    <option>3</option>
</select> 
```

工作示例：http: [//jsfiddle.net/66Tbz/2/](http://jsfiddle.net/66Tbz/2/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-12T23:37:02.960

试试这个：

```
<select>
    <option disabled="true" >make a selection...</option>
    <option>1</option>
    <option>2</option>
    <option>3</option>
</select> 
```

如果这对您不起作用，您可能不得不求助于 Javascript，拦截点击并取消它们。

ETA：或者将它们组合起来：单击下拉菜单时，禁用“进行选择”选项，确保用户只能选择其他选项之一。挑战将是找到一个事件来触发再次启用“进行选择”。

ETA：嗯，以下内容可能处于“合理花费时间”的外部限制，但我将其包括在内是为了完整性：您可以构建一个由标签和隐藏列表框组成的“控件”，并带有图形标签的右侧触发列表框的可见性。您需要 javascript，并且使外观完全正确会很麻烦，但它可以完全按照您的描述进行。

但是，如果您达到了这一点，您不妨编写一些单击处理程序以用于常规下拉菜单，并调整其行为。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-12T23:38:54.537

您可以按照 Ann 的建议添加一个`disabled`属性，但是默认情况下默认值将不再可见。

使用 a`<label>`来推荐选择，不要使用无意义`<option>`的。

```
<label for="foo">Select something</label>
<select name="foo" id="foo">
    <option>1</option>
    <option>2</option>
    <option>3</option>
</select> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-12T23:40:29.080

试试这个：

```
<select>
    <option selected="selected" disabled="true" >make a selection...</option>
    <option>1</option>
    <option>2</option>
    <option>3</option>
</select> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-13T04:45:49.157

如果用户没有选择任何选项，您可以编写验证 javascript 函数并显示错误

```
<form onSubmit="validate()">
<select>
    <option>make a selection...</option>
    <option>1</option>
    <option>2</option>
    <option>3</option>
</select>
</form> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-12-02T20:16:23.927

而不是使用内联样式，（假设选择对象上的 id 为“selectid”）为什么不设置`#selectid > option:first-child{ display: none; }`？

我叉了你的小提琴。（嘿嘿嘿）

[http://jsfiddle.net/qV9kp/](http://jsfiddle.net/qV9kp/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-06-24T06:23:00.923

```
<select>
  <option value="" disabled="true">0</option>
  <option value="1">1</option>
  <option value="2">2</option>
  <option value="3">3</option>
</select> 
```

# python - 从列表中迭代删除（Python 2）

> ID：13850527
> 
> 赞同：6
> 
> 时间：2012-12-12T23:33:50.153
> 
> 标签：python, iteration, fibonacci

我刚刚开始编程，我正在用 Python 解决 Project Euler 问题以进行练习。（这是问题 #2，找到 400 万以内的偶数斐波那契数之和。）我的问题出现在底部的循环中，我试图在列表中找到奇数，然后删除它们。

`del fiblist[i]`给我以下错误信息：

> 回溯（最后一次调用）：文件“.../euler.py”，第 35 行，在 del fiblist[i] IndexError: list assignment index out of range

我看不出我在这里做错了什么，如果有人能帮我看看我在这里做错了什么，我将不胜感激。

```
#euler2

def fibonacciList(limit):
    '''generates a list of fib numbers up to N'''
    mylist = []
    a,b = 1,2
    while True:
        if a <= limit:
            mylist.append(a)
            a,b = b,a+b
        else:
            break

    return mylist

fiblist = fibonacciList(4000000)

for i in fiblist:
    if i%2 != 0:    #if not even, delete from list
        print i
        del fiblist[i]

print fiblist 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-12T23:38:05.630

这里的一个问题是`i`列表中的项目，而不是索引。因此，当您这样做时，`del fiblist[i]`您不是在删除`i`，而是在索引处的值`i`（不存在，因此会出现错误）。这可以通过使用`enumerate()`来修复索引来使用，但是这样做会带来一个新问题。

这里的主要问题是在迭代列表时不能修改列表的长度，因为它会与 Python 的迭代相混淆。一种解决方案是复制列表并处理副本，但更好的方法是使用[列表推导](http://www.youtube.com/watch?v=pShL9DCSIUw)来执行您想要的操作：

```
[i for i in fiblist if i%2 == 0] 
```

这会生成一个新列表，其中仅包含您想要的元素。列表推导是一个强大的工具，因此我建议您观看我链接的视频以获取更多信息。

# css - 背景位置切换到固定时背景大小的封面跳跃

> ID：13850528
> 
> 赞同：4
> 
> 时间：2012-12-12T23:34:14.480
> 
> 标签：css

我正在处理一个视差/滚动时间轴项目，我遇到了 CSS3 背景大小封面属性的问题。

div 具有以下属性：

```
background: url(../images/timeline/back-6.jpg) no-repeat top center black; 
background-size: cover;
padding-top: 90px;
height: 1855px;
position: relative; 
```

使用 jQuery，我将背景附件切换为固定。当我这样做时，背景图像会“进入”（意味着超过屏幕边缘的图像部分现在可见）。这不是预期的结果。

在测试中，我可以将 div 切换为使用 background-size: 100% 覆盖，但在滚动时会导致不同的垂直跳跃问题。

当我将背景切换为固定时如何防止它跳入的任何想法？（当我将背景设置为滚动时，它也会反过来发生）。

遗憾的是，我无法链接到此代码的演示，因为该页面尚未准备好部署。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-07-08T12:25:30.800

`background-size`设置为`cover`或时，我遇到了同样的问题`contain`

设置固定高度，例如对于较小的屏幕，通过`@media`防止背景图像跳跃。经过我的测试，我得出结论，跳跃是由于设置`background-attachment`为后元素的方向`fixed`

将其设置为`fixed`，`size`是由视口的大小计算的，而不是包含 的元素`background-image`。这就是跳跃的来源，以及为什么设置固定的高度或宽度来`background-size`解决这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-22T13:42:45.470

在创建要与 scrollTo-Plugin 等一起使用的单页布局时，我遇到了同样的问题。页面布局分为两部分：左侧为背景图像，应随内容更改/滚动在右侧。所以我曾经制作一种jquery插件来结合“背景位置：固定”和“背景尺寸：封面”。您只需要按类/ID 定义元素即可对齐背景图像。

不要抱怨代码。我对 javascript/jquery 比较陌生。但它的工作;）它是：

```
function fixedResize() {
    var targetEl = $('element where bg-images are in');
    var targetWidth = targetEl.width();
    var targetHeight = targetEl.height();
    var targetPosX = targetEl.offset().left;
    var targetPosY = targetEl.offset().top;
    var leftRatio = targetWidth / targetHeight;
    //console.log('TargetWidth', targetWidth, 'TargetHeight', targetHeight, 'Offset', targetPosX, targetPosY, 'leftRatio', leftRatio);
    targetEl.each(function(){

        var imgTarget = $(this);
        var url = $(this).css('background-image').replace('url(', '').replace(')', '').replace("'", '').replace('"', '');
        var bgImg = $('<img />'); // make background-image as image tag for getting width and height of the image
        imgTarget.css('background-attachment','fixed');
        bgImg.hide();
        bgImg.bind('load', function(){
            var imgHeight = $(this).height();
            var imgWidth = $(this).width();
            var imgRatio = imgWidth / imgHeight;
            $(this).remove(); // remove img Tags again

            // Calculate resize dimensions
            if (imgRatio > leftRatio) {
                var currentWidth = imgRatio * targetHeight; // image width after resize
                var currentHeight = (currentWidth/imgWidth)*imgHeight;
                var setToLeft = ((currentWidth - targetWidth)/2);
                var imgPosX = targetPosX - setToLeft;
                var imgPosY = (currentHeight - targetPosY - currentHeight/2 - targetHeight/2)* -1;
                var resizeImg = 'background-size: auto '+ targetHeight +'px;';                  

                } else if (imgRatio < leftRatio){
                    var currentWidth = targetWidth;
                    var currentHeight = (currentWidth/imgWidth)*imgHeight;
                    var imgPosX = targetPosX;
                    var imgPosY = (currentHeight - targetPosY - currentHeight/2 - targetHeight/2)* -1;
                    var resizeImg = 'background-size: '+ targetWidth +'px auto;'; // resize background
                }
            imgTarget.attr('style','background-attachment: fixed; background-position: '+ imgPosX +'px '+ imgPosY +'px;' + resizeImg);
            console.log('imgWidth', imgWidth, 'imgHeight', imgHeight, 'imgRatio', imgRatio, 'currentWidth', currentWidth, 'currentHeight', currentHeight, 'setToLeft', setToLeft);
            console.log('imgPos', imgPosX, imgPosY, 'setToLeft', setToLeft, targetPosX);

        });
        $(this).append(bgImg);
        bgImg.attr('src', url);

    });
}
fixedResize(); // initiate function

$(window).resize(function() {
    fixedResize(); // initiate function for window resize (Fluid behavior)
}); 
```

或 **jsfiddle.net/rowphant/eXb6e/14/**

# racket - 在 DrRacket、DrJava、DrPython 中，“Dr”代表什么？

> ID：13850529
> 
> 赞同：1
> 
> 时间：2012-12-12T23:34:17.707
> 
> 标签：racket, drjava

目前有一些适用于某些编程语言的 IDE，例如 DrRacket (DrScheme)、DrJava 和 DrPython。有谁知道前缀“Dr”代表什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T23:43:18.127

是博士的意思。这个想法是IDE是某种语言的医生/教授。

# javascript - 将浏览器名称动态添加到页面中

> ID：13850533
> 
> 赞同：0
> 
> 时间：2012-12-12T23:34:53.920
> 
> 标签：javascript, jquery

我有一个小脚本，它检测 userAgent 并基本上用用户正在使用的浏览器写一个小的“你好”消息。我将它用于一个小型演示，我将向人们展示，我知道特征检测更好，所以不用担心。主要是演示脚本。

但基本上，我想知道是否有更好的方法来写这个：

[http://jsfiddle.net/m5cVf/](http://jsfiddle.net/m5cVf/)

我需要显示一个快速有趣的小消息，但我不想为每个浏览器执行大量的“if”语句，我想将它们放入数组中，如果当前浏览器为真，则将浏览器名称添加到函数中，而不是调用`doAlert();`多个次。

就像是：

```
var browsers = chrome,safari,mozilla; 
```

那么如果正在使用的浏览器是“真”，这将被添加到函数中，而不是在每个“if”语句中手动添加它们。谢谢，非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-12T23:38:30.903

您可以将浏览器类型存储在一个数组中，遍历它们，然后针对找到的用户代理对其进行测试。像这样：

[http://jsfiddle.net/m5cVf/5/](http://jsfiddle.net/m5cVf/5/)

```
var browsers = [{"testWith": "chrome", "displayName": "Google Chrome"},
                {"testWith": "safari", "displayName": "Apple Safari"},
                {"testWith": "mozilla", "displayName": "Mozilla Browser"}];

function showBrowserName(browser) {
    $('.user').text(browser);
}

$(function () {
    var userAgent = navigator.userAgent.toLowerCase();

    for (var i = 0; i < browsers.length; i++) {
        var cur = browsers[i];
        if (userAgent.indexOf(cur.testWith) > -1) {
            showBrowserName(cur.displayName);
            break;
        }
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T23:46:06.120

只是另一种方法：http: [//jsfiddle.net/m5cVf/6/](http://jsfiddle.net/m5cVf/6/)

```
function browser(){
    var userAgent = navigator.userAgent.toLowerCase();
    var browsers = ['chrome', 'safari', 'mozilla'];
    for(n in browsers) {
        if(userAgent.indexOf(browsers[n]) > -1){
            browserName = browsers[n];
            doAlert();
            return;
        }            
    }
} 
```

# algorithm - 如何找到给定列表的分区？

> ID：13850536
> 
> 赞同：0
> 
> 时间：2012-12-12T23:35:03.563
> 
> 标签：algorithm, recursion, sml, ml, partition-problem

如何找到整数列表的所有分区？大多数情况下，我需要使用递归的算法，因为我将在 SML 中实现它。我只需要算法，我会自己做编码部分。我错误地编写了查找子集的代码，我没有太多时间来做这个

SML 有点类似于帕斯卡，所以你会掌握我要在阶乘中编写的格式，例如这个有趣的 fuc x = if x<0 then 0 else if x=1 then 1 else x*(fac x-1)

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T21:49:41.307

从您对 amit 的回复来看，您似乎在寻找：

```
fun partitions [] = []
  | partitions [x] = [[[x]]]
  | partitions (x::xs) =
    let
       val zsss = partitions xs
    in
       map (fn zss => [x]::zss) zsss @
       map (fn zs::zss => (x::zs)::zss) zsss
    end 
```

**编辑**：对不起，我将您之前的示例误读为`partition [1,2,3] = [[[1,2,3]],[[1],[2,3]],[[1,2],[3]],[[1],[2],[3]]]`，即有序分区。

这是您实际问题的解决方案（我认为）：

```
fun extensions x [] = []
  | extensions x (xs::xss) =
    ((x::xs)::xss) :: map (fn zss => xs::zss) (extensions x xss)

fun partitions [] = [[]]
  | partitions (x::xs) =
    List.concat (map (fn zss => ([x]::zss) :: extensions x zss) (partitions xs)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-12T23:40:21.307

[分区问题](http://en.wikipedia.org/wiki/Partition_problem)是一个已知的[NP-Hard](http://en.wikipedia.org/wiki/NP-hard)问题（因此没有已知的多项式解决方案），可以使用用递归很好地编写的穷举搜索来解决。

伪代码（尝试做类似ML的伪代码，希望对您有所帮助和清晰）：

```
partition([],A,B): #base clause
   if (sum(A) == sum(B)):
        print (A,B) # this is a partition
partition(list, A,B):
   e <- head(list)
   partition(tail(list),e :: A,B)
   partition(tail(list),A, e :: B) 
```

（如果我没记错`e :: A`是`A`在 ML 的开头添加一个元素，如果我记错了，请随时更正）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-13T19:14:46.160

如果你有一个集合的 k 分区，比如说，你可以生成的 k 分区：`S` `{S[1],...,S[n]}``{P[1],...,P[k]}``k``S ⋃ {S[n+1]}`

`{P[1],..., P[i-1], P[i] ⋃ {n+1}, P[i+1],... P[k]}`对于`i`{1...k}

加上 (k+1) 分区`P ⋃ {k+1}`

将这些称为从 生成的分区`P`。很容易证明，从 的两个不同分区生成的所有分区集`{1,...,n}`都是不相交的，并且 的每个分区`{1,...,n+1}`都是从 的某个分区生成的`{1,...,n}`。

我认为这足以使问题的递归解决方案显而易见。

`B(n)`为了验证，{1,...,n} 的分区数的计数`B`是贝尔数，（Sloane [A000110](http://oeis.org/A000110)）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-12T23:55:14.797

检查这个[找到所有的子集](https://stackoverflow.com/questions/728972/finding-all-the-subsets-of-a-set)。基本上在每次排列迭代中，您可以通过从当前子集的并集中减去整个集合来获得分区的另一部分。

# android - OpenCV Android 连续垫宽高

> ID：13850539
> 
> 赞同：1
> 
> 时间：2012-12-12T23:35:17.413
> 
> 标签：android, opencv

我在最新的 OpenCV 2.4.3 android 项目中使用相机，并将 Mat 转换为位图。我正在使用的实用程序方法（在 OpenCV 项目中提供）需要与 Mat 宽度和高度相同的位图来进行转换。当我访问垫子的高度时，它是 0。宽度是 640（正如预期的那样，我预计高度是 480）。

Mat 是连续的，虽然我可以理解这种影响 mat.rows()，但它不应该改变高度吗？

对于那些要求代码的人：如果您查看示例代码，相机活动具有以下方法：

```
public Mat onCameraFrame(Mat inputFrame) {
    inputFrame.copyTo(mRgba);
    DoSomething(mRgba.getNativeObjAddr());
    return mRgba;
} 
```

当我使用以下内容检查尺寸时：

```
Log.d(TAG, "Width: " + mRgba.width() + ", Height:" + mRgba.height()); 
```

我得到：

```
Width: 640, Height:0 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T17:34:11.763

答案是当我打电话时：

```
 mOpenCvCameraView.disableView(); 
```

间接称之为：

```
 mRgba.release(); 
```

这大概将高度更改为0。

# ruby - Thread#terminate 和处理 SIGTERM

> ID：13850554
> 
> 赞同：2
> 
> 时间：2012-12-12T23:36:59.380
> 
> 标签：ruby, multithreading, signals

这是我编写的一些代码的简化版本：

```
class InfiniteLoop
  def run
    trap('SIGTERM') do
      puts 'exiting'
      exit
    end
    loop {}
  end
end 
```

如果我运行：

```
InfiniteLoop.new.run 
```

我可以`ctrl+c`得到：

```
exiting 
```

但是，当我这样做时：

```
t = Thread.new { InfiniteLoop.new.run }
sleep 1
t.terminate 
```

我没有看到：

```
exiting 
```

有人可以在这里指出我正确的方向吗？我希望在终止线程时具有相同的行为。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-13T00:13:10.807

如果您没有发送 SIGTERM 信号（通过 ctrl+c），则不会执行陷阱块。另见内核方法：

```
at_exit { puts 'exiting' } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-13T00:53:51.367

`trap('SIGTERM')`只会响应从 OS Land 发送的信号。

`Thread#terminate`是会杀死线程的红宝石代码。

我不知道有一种方法可以指定线程在被杀死之前要采取的行为。那可能很有趣。但我认为它不存在，因为 的语义`Thread#kill/terminate/join`不会真正允许这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-04T11:14:03.420

试试`trap("EXIT")`。SIGTERM 由 ctrl-C 或 kill 命令发送。来自红宝石文档：

> 将在程序终止之前调用特殊信号名称“EXIT”或信号编号零。

# javascript - Pubnub Socket.io - 与频道断开连接

> ID：13850556
> 
> 赞同：0
> 
> 时间：2012-12-12T23:37:03.047
> 
> 标签：javascript, socket.io, pubnub

使用 Pubnub 的 Socket.io 实现，如何断开通道（或完全断开）？

我这样设置我的连接：

```
socket = io.connect "http://pubsub.pubnub.com",
  channel:       "some-channel"
  publish_key:   "..."
  subscribe_key: "..." 
```

但是当我尝试像这样断开连接时（使用普通 Socket.io 时的方式）：

```
socket.disconnect() 
```

我收到这样的错误消息：

```
Uncaught TypeError: Cannot read property 'channel' of undefined 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T18:33:31.543

这是 Pubnub 的 Socket.io 实现中的一个错误。请参阅[Github 上的问题](https://github.com/pubnub/pubnub-api/issues/158)。它已在 3.4 版中修复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T18:36:25.187

我认为正确的语法是：

```
socket.on( 'disconnect', function() {
    console.log('my connection dropped');
} ); 
```

[https://github.com/pubnub/pubnub-api/tree/master/socket.io](https://github.com/pubnub/pubnub-api/tree/master/socket.io)

# postgresql - 如何在 psql 命令行上更改默认公共架构

> ID：13850564
> 
> 赞同：4
> 
> 时间：2012-12-12T23:37:29.767
> 
> 标签：postgresql

为了将 MS Access mdb 文件加载到 PostgreSQL 中，我在 psql 命令行上键入以下命令。

```
mdb-schema xxx.mdb postgres | psql -h xxx -U xxx -W -d xxx 
```

但是，Postgres 表是在默认的公共模式下创建的。我想让它们在不同的架构（“网络”）下，而不是默认架构（“公共”）。您能告诉我在这种情况下如何从“公共”更改为“网络”吗？

我很感激任何建议。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-13T04:37:52.520

您需要设置 PGOPTIONS：

```
mdb-schema xxx.mdb postgres | PGOPTIONS='-c search_path=network' psql -h xxx -U xxx -W -d xxx 
```

这是证明（将架构设置为 test_schema）：

```
$ PGOPTIONS='-c search_path=test_schema' psql postgres -c 'show search_path'
 search_path 
-------------
 test_schema
(1 row) 
```

使用`PGOPTIONS`您可以设置（几乎）任何配置指令

# java - 使用 RoboGuice 2 使用带有参数的构造函数注入对象

> ID：13850567
> 
> 赞同：4
> 
> 时间：2012-12-12T23:37:42.313
> 
> 标签：java, android, guice, code-injection, roboguice

我正在第一次尝试适用于 Android 的 RoboGuice2（以及 Guice），现在我被卡住了。我一直无法找到一个如何做到这一点的例子，并且希望有人能向我展示正确的解释方法。我想@Inject 一个将字符串作为构造函数中的参数的对象。下面的例子：

```
public class MyActivity extends RoboFragmentActivity {

    @Inject MyObject obj;

    public void onCreate(Bundle savedInstanceState) {
       super.onCreate();
       obj.print();
    }
}

public class MyObject {

    private String name;

    @Inject
    public MyObject(String name) {
       this.name = name;
    }

    public void print() {
        Log.d("debug", this.name);
    }
} 
```

我会非常感谢一个例子和对此的解释。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T00:14:40.343

I'm not sure if it's possible to inject an object with RoboGuice while passing a parameter to its constructor ~~(and this is certainly not encouraged)~~. You might want to consider just changing whatever method you call on that object that writes to the file system to take in that `String` parameter. If you don't like that option, you can just have a public method to set that parameter before calling the write function.

Ex:

```
@Inject
private MyClass myClass;

public void onCreate(Bundle savedInstanceState) {

    super.onCreate();
    myClass.setFileName("somefile.txt");
    myClass.writeToFile();
} 
```

Or

```
@Inject
private MyClass myClass;

public void onCreate(Bundle savedInstanceState) {

    super.onCreate();
    myClass.writeToFile("somefile.txt");
} 
```

EDIT:

So after doing some research I'm taking back my statement about this not being encouraged. From the examples I've seen, your code looks to be be mostly correct. [This Link](http://stubbisms.wordpress.com/2008/07/26/google-guice-injecting-primitives-in-constructors/) provided the most complete example I could find. It seems that there are two options if you want to inject a String into the constructor. you can set it up in you app config bindings (which essentially creates a singleton that you probably don't want). The second option is to create a Provide (similar to Factory) and use that provider. Both of these options are outlined in the article above.

# perl - Perl - 每月增量循环

> ID：13850572
> 
> 赞同：1
> 
> 时间：2012-12-12T23:38:10.973
> 
> 标签：perl, loops, increment

在过去的几个月里，我一直在使用以下代码，它从预定义的日期开始循环几个月，直到它到达今天的日期。

```
use Date::Pcalc qw(:all);

$startDay = 1;
$startMonth = '4';
$startYear = '2009';

$dateToday = `date +%Y-%m-%d`;
($yt,$mt,$dt) = split(/\-/,$dateToday);

while ($endMonth <= $mt || $startYear < $yt ) {

if ($startMonth eq '12') {
    $endMonth = 1;
    $endYear = $startYear + 1;
  } else {
    $endMonth = $startMonth + 1;
    $endYear = $startYear;
  }

  if ($startMonth eq '12') {
    $endYear = $startYear + 1;
  }

  ($meYear,$meMonth,$meDay) = Add_Delta_Days($endYear,$endMonth,$startDay,-1);
  $endOfMonth = "$meYear-$meMonth-$meDay";
  $monthText = Month_to_Text($startMonth);

  $startDate = "$startYear-$startMonth-1";
  $endDate = "$endYear-$endMonth-1";

print "$startDate - $endDate\n";

if ($startMonth eq '12') {
    $startMonth = 1;
    $startYear++;
  } else {
    $startMonth++
  }

} 
```

在过去的几个月里，这一直很有效，但我意识到现在在 12 月，因为 $endmonth 永远不会大于 $mt (12)，这会导致无限循环。

我一直无法找出任何替代方法来做到这一点。我觉得我应该能够相对容易地解决这个问题，但我似乎有严重的“开发者障碍”

提前感谢任何可以提供帮助的人。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-13T01:03:57.273

```
my $date = DateTime->new(
   time_zone => 'local',
   year      => $startYear,
   month     => $startMonth,
   day       => 1,
);

my $today = DateTime->today(time_zone => 'local');

while ($date <= $today) {
   say $date->ymd('-');
   $date->add( months => 1 );
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T12:15:01.993

我认为您的代码存在一些问题。但是让我们来解决第一个问题，即第 12 个月的结束日期，这会导致此语句中出现循环：

```
 while ($endMonth <= $mt || $startYear < $yt ) { 
```

好的，一旦你有了当前日期、年份、月份和日期，你应该做的是这样的事情。你会注意到其他人提出了不同的方法来获取当前日期你应该接受这个建议。但是，一旦您有了日期，就应该采用以下代码：

```
 ($yt,$mt,$dt) = split(/\-/,$dateToday);
    # the line below will create a date like 201212 (yyyy mm) but if the month is a 1 digit month it will place a 0 in front of it to ensure your yymm variable always holds 6 characters in the format of yyyy mm - ok
    my $yymm = $yt . ${\(length($mt) == 1 ? '0' : '')} . $mt;
    # Now lets check the end date against the yymm
    # initialise end date as end_yymm - again it inserts a 0 for single digit month
    my $end_yymm = $startyear . ${\(length($startMonth) == 1 ? '0' : '')} . $startMonth;
    # the above should get the date as '200904' from your code provide
    # the while will check end_yymm like 200904 < 201212 - yes it is...
    ## the end_yymm will keep getting incremented each month and so will the year component at the end of each year until it reaches 201212
    ## then the question 201212 < 201212 will cause the while to end
    ## If you want it go into 201301 then say while ($end_yymm <= $yymm) {
    ## Hope you get the picture
    while ($end_yymm < $yymm) {

    if ($startMonth eq '12') {
        $endMonth = 1;
        $endYear = $startYear + 1;
    } else {
      $endMonth = $startMonth + 1;
      $endYear = $startYear;
    }

    ## Now this one seems to be repeating the endYear calculation as above - to me it seems redundant - maybe get rid of it
    if ($startMonth eq '12') {
       $endYear = $startYear + 1;
    }        

    ## Now that you have the end year and month incremented setup the end_yymm variable again to be picked up in the while statement:
    $end_yymm = $startyear . ${\(length($startMonth) == 1 ? '0' : '')} . $startMonth;

     # ...... carry on with the rest of your code

    } # end the while loop 
```

那应该这样做。

祝一切顺利

# c# - 我怎样才能允许一个类被声明为使用浮点数或双精度数？

> ID：13850575
> 
> 赞同：6
> 
> 时间：2012-12-12T23:38:21.440
> 
> 标签：c#, types

抱歉，如果标题措辞不当。假设我有一个光线追踪器，我希望能够使用浮点数或双精度数。我怎样才能声明一个选择浮点数或双精度类的新实例？我不想创建两个类并调用一个双类和另一个单类。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-12T23:48:20.283

在 .NET 中没有一种干净的方法来处理这个问题。泛型不直接支持算术运算。您可以通过诸如[MiscUtils](http://www.yoda.arachsys.com/csharp/genericoperators.html)之类的变通方法或通过[创建单独的计算器类并将数学委托给它](http://www.codeproject.com/Articles/33617/Arithmetic-in-Generic-Classes-in-C)来解决此问题，但这通常会使代码比拥有两个实现更复杂。

您可以`dynamic`在内部使用这里，这也可以。但是，这会增加（轻微的）开销，这可能会降低它的有用性。如果性能是您不想只支持双精度数学的主要原因，那么使用动态可能不是一种选择。

一种选择是使用[T4](http://msdn.microsoft.com/en-us/library/bb126445.aspx)创建一个模板，该模板从单个源文件构建代码的两个版本。这将为您提供完整的本机支持而无需开销（本质上只是为您编写两个类）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T23:40:42.587

您可以为此使用 C# 泛型：

```
using System;

class Test<T>
{
    T _value;

    public Test(T t)
    {
    // The field has the same type as the parameter.
    this._value = t;
    }

    public void Write()
    {
    Console.WriteLine(this._value);
    }
}

class Program
{
    static void Main()
    {
    // Use the generic type Test with an int type parameter.
    Test<int> test1 = new Test<int>(5);
    // Call the Write method.
    test1.Write();

    // Use the generic type Test with a string type parameter.
    Test<string> test2 = new Test<string>("cat");
    test2.Write();
    }
} 
```

该博客为您更详细地描述了它[http://www.dotnetperls.com/generic](http://www.dotnetperls.com/generic)

# visual-studio - 将 TypeScript 构建事件转换为外部工具命令

> ID：13850578
> 
> 赞同：1
> 
> 时间：2012-12-12T23:38:25.887
> 
> 标签：visual-studio, visual-studio-2012, typescript, build-events, external-tools

我正在使用 Visual Studio 2012 Express for Web 处理 TypeScript 文件。由于 Web Essentials 插件不适用于 Express 版本，并且每次更新脚本时重建整个项目开始花费太长时间，我希望将以下构建事件（来自 TypeScript 项目模板）转换为 '可以放置在工具栏上的外部工具命令。

```
<Target Name="BeforeBuild">
  <Message Text="Compiling TypeScript files" />
  <Message Text="Executing tsc$(TypeScriptSourceMap) @(TypeScriptCompile ->'&quot;%(fullpath)&quot;', ' ')" />
  <Exec Command="tsc$(TypeScriptSourceMap) @(TypeScriptCompile ->'&quot;%(fullpath)&quot;', ' ')" />
</Target> 
```

不幸的是......这有点失去了我。我找不到关于`$(TypeScriptSourceMap)`、`@()`和`%()`宏的任何文档。它似乎也不喜欢我直接复制命令。（即使在转换 HTML 实体之后。）

为了模仿这个构建事件，我可以在“外部工具”对话框中输入什么？

我将尝试编写一个 PS 脚本或一些诸如解决方法之类的方法，但这将缺乏仅使用“TypeScriptCompile”构建操作处理文件的功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T00:05:48.763

`$(TypeScriptSourceMap)`来自项目文件前面大约 4 行。它只是`" --sourcemap"`在调试配置和`""`其他情况下。

这里的`@()`语法基本上意味着“对于构建操作为 的每个项目项`TypeScriptCompile`，将其完整路径放在双引号中，并用空格连接这些结果项。

一个新兴的 TypeScript 项目最佳实践是拥有一个如下所示的“project.ts”文件：

**项目.ts**

```
/// <reference path="file1.ts" />
/// <reference path="file2.ts" />
/// ... and so on 
```

**文件1.ts**

```
/// <reference path="project.ts" />

class alpha { ... } 
```

**文件2.ts**

```
/// <reference path="project.ts" />

class beta { ... } 
```

通过该设置，您可以简单地运行`tsc project.ts`or`tsc project.ts --out app.ts`并且正确的事情将会发生。

# ios - 是否可以为存档临时构建启用僵尸和涂鸦？

> ID：13850579
> 
> 赞同：2
> 
> 时间：2012-12-12T23:38:30.707
> 
> 标签：ios, xcode

我想通过存档/临时构建将应用程序分发给测试人员，但是在“编辑方案”对话框中，启用 Zombies 和 Scribble 等的诊断标签对于存档构建步骤不可用，它仅在运行步骤中可用。

因此，是否可以在启用这些功能的情况下创建和分发构建？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T14:51:11.070

这些设置没有内置到应用程序中，这些只是应用程序启动时指定的选项。在 Mac OS X 上，这些可以通过在启动应用程序之前设置环境变量来指定。对于 iOS 应用程序，如果您不从 Xcode AFAIK 内部启动应用程序，则无法指定这些选项。

# actionscript-3 - 操作文件数据（字节数组）

> ID：13850583
> 
> 赞同：0
> 
> 时间：2012-12-12T23:38:40.717
> 
> 标签：actionscript-3, file-upload, filereference

尽管我是一名 OOP 编码员，但我对 ActionScript 3 完全陌生。

我已经看到这个片段可以轻松地逐个更改字节。

```
var j:int = myFile._fileRef.data.length;
while (j--)
{
    myfile._fileRef.data[j] += 128;
} 
```

当我在对每个字节应用更改后上传文件时，结果似乎很完美。但是当我试图直接将一个新的字节数组（一个编码的）分配给 _fileRef 的数据成员时，编译器会提醒我它是只读的。

有没有合适的方法在上传之前快速修改文件的字节数组？

[编辑]

可能是我用来分配字节数组的方法吗？我直接将编码数组分配给文件：

```
myfile._fileRef.data = DESencodedArray; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T06:00:15.373

所以你正在修改加载的副本`ByteArray`？您是否有理由不直接处理加载的数据，即修改`ByteArray`通过`data`属性提供的数据？

无论如何，“替换”`ByteArray`内容可以使用[ByteArray::clear()](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/utils/ByteArray.html#clear%28%29)和 [ByteArray::writeBytes()](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/utils/ByteArray.html#writeBytes%28%29)

```
data.clear();
data.writeBytes(DESencodedArray); 
```

# javascript - 当lazyFetching 设置为 false 时，FullCalendar jQuery 插件会为每个事件（悬停、鼠标悬停、调整大小等）触发 ajax 事件

> ID：13850585
> 
> 赞同：2
> 
> 时间：2012-12-12T23:38:47.473
> 
> 标签：javascript, jquery, ajax, events, fullcalendar

我正在使用 FullCalendar 显示事件，我通过一个进行 AJAX 调用的 javascript 函数来获取这些事件。这样做是为了发送一个限制器，限制在给定的一天传回多少事件，包括 ViewMore 选项。

通过关闭lazyFetching，结果似乎是FullCalendar 对页面上触发的每个事件进行重新渲染。这导致它每次都执行新的 AJAX 调用。

如何防止 FullCalendar 进行这些不必要的 AJAX 调用？

下面是初始化我的 fullCalendar 的代码。谢谢！

```
 $('#calendar').fullCalendar({
    defaultView: 'basicWeek',
    theme: true,
    isRTL: isRightToLeft,
    contentHeight: 800,
    weekends: true,
    header: {
        left: 'prev,next today',
        center: 'title',
        right: 'month,basicWeek,basicDay'
    },
    lazyFetching: false,
    columnFormat: {
        month: 'ddd',
        week: 'ddd ' + shortMonthDayPattern,
        day: 'dddd ' + shortMonthDayPattern
    },
    titleFormat: {
        month: yearMonthPattern,                             // September 2009
        week: "MMM d[ yyyy]{ '&#8212;'[ MMM] d yyyy}", // Sep 7 - 13 2009
        day: longDatePattern                  // Tuesday, Sep 8, 2009
    },
    dayClick: function (date, allDay, jsEvent, view) {
        if (view.name != 'basicDay') {
            $('#calendar').fullCalendar('changeView', 'basicDay');
            $('#calendar').fullCalendar('gotoDate', date);
        }
    },
    eventClick: function (event, jsEvent, view) {
        if (event.id === "viewMore") {
            $('#calendar').fullCalendar('changeView', 'basicDay');
            $('#calendar').fullCalendar('gotoDate', event.start);
        }
        else {
            navigateBackboneCal(event.id);
        }
    },
    editable: false,
    loading: function (isLoading) {
        if (isLoading) {
            $('.fc-content').block({
                message: null,
                css: { top: '10' }
            });
        }
        else {
            $('.fc-content').unblock();
        }
    },
    viewDisplay: function (view) {

    },
    events: function (startDt, endDt, callback) {
        var maxEvents = 0;
        var view = $('#calendar').fullCalendar('getView');
        if (view.name === 'month')
            maxEvents = 5;
        else if (view.name === 'basicWeek')
            maxEvents = 30;

        var events = [];
        $.ajax({
            url: '/GetCalendarEvents',
            type: 'POST',
            data: { start: Math.round(startDt.getTime() / 1000), end: Math.round(endDt.getTime() / 1000), maxEvents: maxEvents },
            error: function (error) {
                alert('There was an error while fetching events!');
                $('.fc-content').unblock();
            },
            success: function (result) {
                if (result.viewMoreEvents)
                    events = $.merge(result.events, result.viewMoreEvents);
                callback(events);
            }
        });

    }
}); 
```

# c - 如何为 C99 中隐式定义的多维数组分配内存？

> ID：13850587
> 
> 赞同：1
> 
> 时间：2012-12-12T23:39:01.340
> 
> 标签：c, arrays, memory-management, multidimensional-array, c99

我正在尝试编写一个 C99 程序，并且我有一个隐式定义的字符串数组：

```
char *stuff[] = {"hello","pie","deadbeef"}; 
```

由于未定义数组维度，那么为每个字符串分配多少内存？是否所有字符串都分配了与定义中最大字符串相同数量的元素？例如，下面的代码是否等同于上面的隐式定义：

```
char stuff[3][9];
strcpy(stuff[0], "hello");
strcpy(stuff[1], "pie");
strcpy(stuff[2], "deadbeef"); 
```

或者每个字符串是否只分配了它在定义时所需的内存量（即`stuff[0]`保存一个包含**6 个**元素`stuff[1]`的数组，保存一个包含**4 个**元素的数组，`stuff[2]`保存一个包含**9 个**元素的数组）？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-12T23:54:33.657

图片可以提供帮助 — ASCII 艺术很有趣（但很费力）。

```
char *stuff[] = {"hello","pie","deadbeef"};

+----------+          +---------+
| stuff[0] |--------->| hello\0 |
+----------+          +---------+      +-------+
| stuff[1] |-------------------------->| pie\0 |
+----------+          +------------+   +-------+
| stuff[2] |--------->| deadbeef\0 |
+----------+          +------------+ 
```

为一维指针数组分配的内存是连续的，但不能保证数组中保存的指针指向连续的内存部分（这就是指针行长度不同的原因）。

```
char stuff[3][9];
strcpy(stuff[0], "hello");
strcpy(stuff[1], "pie");
strcpy(stuff[2], "deadbeef");

+---+---+---+---+---+---+---+---+---+
| h | e | l | l | o | \0| x | x | x |
+---+---+---+---+---+---+---+---+---+
| p | i | e | \0| x | x | x | x | x |
+---+---+---+---+---+---+---+---+---+
| d | e | a | d | b | e | e | f | \0|
+---+---+---+---+---+---+---+---+---+ 
```

为二维数组分配的内存是连续的。x 表示未初始化的字节。请注意，它`stuff[0]`是指向 'hello' 的 'h' 的`stuff[1]`指针，是指向 'pie' 的 'p' 的指针，并且`stuff[2]`是指向 'deadbeef' 的第一个 'd' 的指针（并且`stuff[3]`是不可取消引用的指针到'deadbeef'之后的空字节之外的字节）。

图片很不一样，很不一样。

请注意，您可以编写以下任何一种：

```
char stuff[3][9] = { "hello", "pie", "deadbeef" };
char stuff[][9]  = { "hello", "pie", "deadbeef" }; 
```

并且您将拥有与 2D 数组图中所示相同的内存布局（除了 x 将被归零）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-12T23:43:14.180

```
char *stuff[] = {"hello","pie","deadbeef"}; 
```

不是*多维*数组！它只是一个指针数组。

> 为每个字符串分配多少内存？

字符数加上空终止符。与任何字符串文字相同。

我想你想要这个：

```
char foo[][10] = {"hello","pie","deadbeef"}; 
```

这里，10 是每个字符串的空间量，所有字符串都在连续的内存中。因此，小于 10 的字符串会有填充。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-12T23:41:46.877

在第一个示例中，我想它是一个**锯齿状数组。**

它声明了一个指向 char 的 const 指针数组。所以字符串文字可以是任意长的。字符串的长度与数组列**无关**。

在第二个中.. 每行 ( `string`) 长度的字符数必须为 9，由您的列大小指定，或者更少。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-12T23:42:43.147

> 是否所有字符串都分配了与定义中最大字符串相同数量的元素？

不，只分配了 3 个指针，它们指向 3 个字符串文字。

```
char *stuff[] = {"hello","pie","deadbeef"}; 
```

和

```
char stuff[3][9]; 
```

根本不等价。第一个是 3 个指针的数组，而第二个是 2D 数组。

对于第一个唯一的指针被分配并且它们指向的字符串文字可以存储在只读部分中。第二个分配在自动存储（通常是堆栈）上。

# javascript - 从本地计算机在浏览器中查看的网页与从服务器在浏览器中查看时的网页显示不同

> ID：13850589
> 
> 赞同：0
> 
> 时间：2012-12-12T23:39:14.650
> 
> 标签：javascript, web, html5-canvas

我有以下网页，当我从本地计算机在浏览器中查看时，它的显示完全符合我的预期。但是，将该页面复制到我在服务器上的文件存储（连同它所需的所有支持文件），并通过浏览到它所在的 URL 从服务器查看它后，我发现它没有显示在同一就像从我的本地计算机上查看它一样。

我的页面是：

```
<!DOCTYPE HTML>
<html>
<head>
<style>
  body {
    margin: 0px;
    padding: 0px;
  }
  canvas{
    border: 1px solid #9C9898;
    background:#F5F5F5;
  }
</style>
<div id="container"></div>
<script src="http://www.html5canvastutorials.com/libraries/kinetic-v4.1.2.js"></script>
<script src="drawDescriptionBoxes.js"></script>
<script>
/*Add the game elements' global variables */
var currentLevel = 1;
var totalLevels = 3;
var currentScore = 0;
var currentScorePositionX = 950;
var currentScorePositionY = 10;

/*Add code to draw images to random locations here */
    var imageX = Math.floor(Math.random()*950);
    var imageY = Math.floor(Math.random()*450);

    var stage = new Kinetic.Stage({
      container: "container",
      width: 1000,
      height: 500
    });
    var imagesLayer = new Kinetic.Layer();
    var canvas = imagesLayer.getCanvas();
    var context = canvas.getContext("2d");
    console.log("Foo ");

function loadImages(sources, callback){
    var imagesDir = "";
    var images = {};
    var loadedImages = 0;
    var numImages = 0;

    //console.log("length " + sources.length);
    for (var src in sources){
        numImages++;
    }
    //console.log("Num Images " + numImages);

    var index=0;
    console.log("length " + sources.length);
    for (index=0;index < numImages ;index++){
        console.log(index);
        images[index] = new Image();
        images[index].src = sources[index];
        console.log("Adding " + sources[index]);
        callback(images[index]);
        console.log("images array length = " + images.length);
    }

    stage.add(imagesLayer); // should only be added once!!
    }

    function isNearDescriptionBox(itemImage, descriptionBox){
        var ii = itemImage;
        var db = descriptionBox;
        if(ii.attrs.x > db.x - 20 && ii.attrs.x < db.x + 20 && ii.attrs.y > db.y - 20 && ii.attrs.y < db.y +20){
            return true;
        }else{
            return false;
        }
    }

    /* This function draws the game elements */
    function drawGameElements(){
        /* Draw a line for the 'score bar'. */
        context.moveTo(0, 25);
            context.lineTo(1000, 25);
        context.stroke();

        /* Draw current level/ total levels on the left, and current score on the right. */
        context.font = "11pt Calibri"; /* Text font & size */
        context.strokeStyle = "black"; /* Font colour */
        context.strokeText(currentLevel + "/" + totalLevels, 10, 15);
        context.strokeText(currentScore, 750, 15);
    }

    function initStage(images){
        var stage = new Kinetic.Stage({
            container: "container",
            width: 1000,
            height: 500
        });
        var descriptionLayer = new Kinetic.Layer();
        //var imagesLayer = new Kinetic.Layer();
        var allImages = [];
        var currentScore = 0;

        /*Draw the description boxes */

    }

  function drawImage(imageObj) {
    //var layer = new Kinetic.Layer();

    var canvasImage = new Kinetic.Image({
      image: imageObj,
      width: 50,
      height: 50,
          // puts the image in teh middle of the canvas
          x: stage.getWidth() / 2 - 50 / 2,
      y: stage.getHeight() / 2 - 50 / 2,
      draggable: true
    });

    // add cursor styling
    canvasImage.on('mouseover', function() {
      document.body.style.cursor = 'pointer';
    });
    canvasImage.on('mouseout', function() {
      document.body.style.cursor = 'default';
    });

    imagesLayer.add(canvasImage);
  }

    /*This code loads the images to the canvas when the browser window loads */
    window.onload = function(){
        var sources = {};
            sources[0] = document.getElementById("building").src,
            sources[1] = document.getElementById("chair").src,
            sources[2] = document.getElementById("drink").src,
            sources[3] = document.getElementById("food").src,
            sources[4] = document.getElementById("fridge").src,
            sources[5] = document.getElementById("land").src,
            sources[6] = document.getElementById("money").src,
            sources[7] = document.getElementById("oven").src,
            sources[8] = document.getElementById("table").src,
            sources[9] = document.getElementById("van").src,

            sources[10] = document.getElementById("burger").src,
            sources[11] = document.getElementById("chips").src,
            sources[12] = document.getElementById("drink").src,
            sources[13] = document.getElementById("franchiseFee").src,
            sources[14] = document.getElementById("wages").src,

            sources[15] = document.getElementById("admin").src,
            sources[16] = document.getElementById("cleaners").src,
            sources[17] = document.getElementById("electricity").src,
            sources[18] = document.getElementById("insurance").src,
            sources[19] = document.getElementById("manager").src,
            sources[20] = document.getElementById("rates").src,
            sources[21] = document.getElementById("training").src,
            sources[22] = document.getElementById("water").src,

            sources[23] = document.getElementById("burger").src,
            sources[24] = document.getElementById("chips").src,
            sources[25] = document.getElementById("drink").src,

            sources[26] = document.getElementById("creditors").src,
            sources[27] = document.getElementById("electricity").src,
            sources[28] = document.getElementById("food").src,
            sources[29] = document.getElementById("hirePurchase").src,
            sources[30] = document.getElementById("loan").src,
            sources[31] = document.getElementById("overdraft").src,
            sources[32] = document.getElementById("payeTax").src,
            sources[33] = document.getElementById("tax").src

        loadImages(sources, drawImage);
        drawGameElements();
        drawDescriptionBoxes();
    };

    </script>

</head>
<body>

<section hidden>
<img id="startButton" src="images/startButton.png" alt="Start Button" width="179" height="180" href="javascript:drawLevelOneElements();"/>
<img id="box" src="images/box.png" alt="box.png" alt="Description Box" width="100" height="50" />

<img id="building" src="images/assets/building.png" alt="Asset" />
<img id="chair" src="images/assets/chair.gif" alt="Asset" />
<img id="drink" src="images/assets/drink.jpg" alt="Asset" />
<img id="food" src = "images/assets/food.gif" alt="Asset"/>
<img id="fridge" src = "images/assets/fridge.png" alt="Asset"/>
<img id="land" src = "images/assets/land.jpg" alt="Asset"/>
<img id="money" src = "images/assets/money.jpg" alt="Asset"/>
<img id="oven" src = "images/assets/oven.jpg" alt="Asset"/>
<img id="table" src = "images/assets/table.gif" alt="Asset"/>
<img id="van" src = "images/assets/van.jpg" alt="Asset"/>

<img id="burger" src = "images/expenses/direct/burger.png" alt="Direct Expense"/>
<img id="chips" src = "images/expenses/direct/chips.png" alt="Direct Expense"/>
<img id="drink" src = "images/expenses/direct/drink.jpg" alt="Direct Expense"/>
<img id="franchiseFee" src = "images/expenses/direct/franchiseFee.jpg" alt="Direct Expense"/>
<img id="wages" src = "images/expenses/direct/wages.jpg" alt="Direct Expense"/>

<img id="admin" src = "images/expenses/indirect/admin.jpg" alt="Indirect Expense"/>
<img id="cleaners" src = "images/expenses/indirect/cleaners.gif" alt="Indirect Expense"/>
<img id="electricity" src = "images/expenses/indirect/electricity.gif" alt="Indirect Expense"/>
<img id="insurance" src = "images/expenses/indirect/insurance.jpg" alt="Indirect Expense"/>
<img id="manager" src = "images/expenses/indirect/manager.jpg" alt="Indirect Expense"/>
<img id="rates" src = "images/expenses/indirect/rates.jpg" alt="Indirect Expense"/>
<img id="training" src = "images/expenses/indirect/training.gif" alt="Indirect Expense"/>
<img id="water" src = "images/expenses/indirect/water.gif" alt="Indirect Expense"/>

<img id="burger" src = "images/income/burger.png" alt="Income"/>
<img id="chips" src = "images/income/chips.png" alt="Income"/>
<img id="drink" src = "images/income/drink.jpg" alt="Income"/>

<img id="creditors" src = "images/liabilities/creditors.gif" alt="Liability"/>
<img id="electricity" src = "images/liabilities/electricity.png" alt="Liability"/>
<img id="food" src = "images/liabilities/food.jpg" alt="Liability"/>
<img id="hirePurchase" src = "images/liabilities/hirePurchase.jpg" alt="Liability"/>
<img id="loan" src = "images/liabilities/loan.png" alt="Liability"/>
<img id="overdraft" src = "images/liabilities/overdraft.jpg" alt="Liability"/>
<img id="payeTax" src = "images/liabilities/payeTax.jpg" alt="Liability"/>
<img id="tax" src = "images/liabilities/tax.jpg" alt="Liability"/>

</section>
</body>
</html> 
```

当我在本地查看它时，它会显示一个画布，其中包含四个“描述框”，这些“描述框”由页面上的 JavaScript 调用的以下函数绘制（尽管该函数本身实际上位于单独的 JS 文件中）：

```
CanvasRenderingContext2D.prototype.drawDescriptionArea = function(x, y, width, height, radius, stroke){
        if(typeof stroke == "undefined" ){
            stroke = true;
        }
        if(typeof radius === "undefined"){
            radius = 5;
        }
        this.beginPath();
        this.moveTo(x + radius, y);
        this.lineTo(x + width - radius, y);
        this.quadraticCurveTo(x + width, y, x + width, y + radius);
        this.lineTo(x + width, y + height - radius);
        this.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);
        this.lineTo(x + radius, y + height);
        this.quadraticCurveTo(x, y + height, x, y + height - radius);
        this.lineTo(x, y + radius);
        this.quadraticCurveTo(x, y, x + radius, y);
        this.closePath();
        if(stroke){
            context.stroke();
        }
    }

    context.drawDescriptionArea(70, 400, 120, 70);
    context.font = '25pt Calibri';
    context.strokeText('Asset', 90, 440);

    context.drawDescriptionArea(300, 400, 120, 70);
    context.strokeText('Liability', 310, 440);

    context.drawDescriptionArea(540, 400, 120, 70);
    context.strokeText('Income', 550, 440);

    context.drawDescriptionArea(750, 400, 180, 70);
    context.strokeText('Expenditure', 760, 440); 
```

但是，当我使用它所在的 URL 从服务器查看它时，由于某种原因，描述框没有显示在画布上，我不明白为什么，因为我已将所有内容从本地计算机复制到服务器，所以它应该都在那里。

有人有想法么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T17:41:03.090

您在此处指定的 javascript 文件：

```
<script src="drawDescriptionBoxes.js"></script> 
```

没有加载。

根据上述评论中的讨论，这是因为文件名在源代码中存在大写问题。

# git - 我可以从它应该在的文件夹的子文件夹中移动一个 git repo

> ID：13850593
> 
> 赞同：1
> 
> 时间：2012-12-12T23:39:32.847
> 
> 标签：git, repository

对不起，新手的问题。我在我想要的一个子文件夹中创建了我的 git 存储库。存储库中只有一个空文件。还是我应该杀死它并将存储库从 github 克隆到适当的位置？

首先十分感谢。

最好的，迈克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-12T23:58:30.390

您可以按照您所说的再次克隆您的存储库，但请记住，您尚未推送到远程的任何本地更改都将丢失：如果您没有推送它们，当您再次克隆存储库时将无法取回它们。

您还可以移动文件。如果你的目录结构是这样的：

/IntendedName/子文件夹/

其中包含存储库的文件夹应该是“IntendedName”而不是“子文件夹”，您可以将“Sulfolder”中的所有文件移动到它的父级（包括隐藏目录.git），然后删除“子文件夹”。在这种情况下，任何本地更改都将被保留，即使您没有推送它们。

# android - 从 ZXing Source 运行 Barcode Scanner App？

> ID：13850597
> 
> 赞同：0
> 
> 时间：2012-12-12T23:39:55.707
> 
> 标签：android, zxing

我正在尝试制作一个受限版本的条形码扫描仪，它只能扫描二维数据矩阵。我认为最好的方法是从 ZXing svn 存储库获取最新源，构建 core.jar，将其包含在应用程序库中，然后从那里开始工作。

但是，为了了解应用程序中的各种组件如何工作，我尝试使用 ZXing 存储库中的 android 源代码运行条码扫描器应用程序。为此，我遵循了关于

[https://stackoverflow.com/a/4854637/1273954](https://stackoverflow.com/a/4854637/1273954)
[https://stackoverflow.com/a/4825803/1273954](https://stackoverflow.com/a/4825803/1273954)
以及[http://damianflannery.wordpress.com/2011/06/13/integrate-zxing-barcode-扫描仪进入你的 android-app-natively-using-eclipse/](http://damianflannery.wordpress.com/2011/06/13/integrate-zxing-barcode-scanner-into-your-android-app-natively-using-eclipse/)

所有这些帖子本质上都在谈论相同的事情和相同的方法。但是，每次我运行应用程序时，我的设备都会显示“不幸的是，条形码扫描仪已停止”

这是 logcat 显示的内容：

```
12-12 17:18:56.213: E/AndroidRuntime(15408): FATAL EXCEPTION: main
12-12 17:18:56.213: E/AndroidRuntime(15408): java.lang.ExceptionInInitializerError
12-12 17:18:56.213: E/AndroidRuntime(15408):    at java.lang.Class.newInstanceImpl(Native Method)
12-12 17:18:56.213: E/AndroidRuntime(15408):    at java.lang.Class.newInstance(Class.java:1319)
12-12 17:18:56.213: E/AndroidRuntime(15408):    at android.app.Instrumentation.newActivity(Instrumentation.java:1023)
12-12 17:18:56.213: E/AndroidRuntime(15408):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1964)
12-12 17:18:56.213: E/AndroidRuntime(15408):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2083)
12-12 17:18:56.213: E/AndroidRuntime(15408):    at android.app.ActivityThread.access$600(ActivityThread.java:134)
12-12 17:18:56.213: E/AndroidRuntime(15408):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1233)
12-12 17:18:56.213: E/AndroidRuntime(15408):    at android.os.Handler.dispatchMessage(Handler.java:99)
12-12 17:18:56.213: E/AndroidRuntime(15408):    at android.os.Looper.loop(Looper.java:137)
12-12 17:18:56.213: E/AndroidRuntime(15408):    at android.app.ActivityThread.main(ActivityThread.java:4697)
12-12 17:18:56.213: E/AndroidRuntime(15408):    at java.lang.reflect.Method.invokeNative(Native Method)
12-12 17:18:56.213: E/AndroidRuntime(15408):    at java.lang.reflect.Method.invoke(Method.java:511)
12-12 17:18:56.213: E/AndroidRuntime(15408):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:787)
12-12 17:18:56.213: E/AndroidRuntime(15408):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:554)
12-12 17:18:56.213: E/AndroidRuntime(15408):    at dalvik.system.NativeStart.main(Native Method)
12-12 17:18:56.213: E/AndroidRuntime(15408): Caused by: java.lang.NoClassDefFoundError: com.google.zxing.ResultMetadataType
12-12 17:18:56.213: E/AndroidRuntime(15408):    at com.google.zxing.client.android.CaptureActivity.<clinit>(CaptureActivity.java:96)
12-12 17:18:56.213: E/AndroidRuntime(15408):    ... 15 more 
```

帖子还谈到了对文件 androidManifest.xml 的修改。我不知道要在那里进行哪些修改。

任何帮助或重定向或资源参考将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T01:42:25.570

你得到一个`NoClassDefFoundError`. 这意味着您的 jar 文件在运行时不可用。为了让它在运行时可用，您必须在 java 构建路径中检查 jar 文件上的复选框，如下所示： ![在此处输入图像描述](../Images/91f321c449ae6cde410f06affabc44dd.png)

# php - 按类型迭代设置 $_POST 变量？

> ID：13850599
> 
> 赞同：1
> 
> 时间：2012-12-12T23:40:14.563
> 
> 标签：php

我的用户输入如下：

```
<form action="special.php" method="post">
    <input name="first1"> <input name="last1"> <input name="age1">
    <input name="first2"> <input name="last2"> <input name="age2">
    <input name="first3"> <input name="last3"> <input name="age3">
    <input name="first4"> <input name="last4"> <input name="age4">
    <input name="first5"> <input name="last5"> <input name="age5">
    <input name="first6"> <input name="last6"> <input name="age6">
    ...

    N
</form> 
```

用户在表单中输入的数量由用户决定；意思是，用户可以在上面的代码中添加 5,10,20 行，创建合适的新输入元素（按照上面的模式）。

我的问题是，一旦表单被提交，迭代和打印所有 SET POST 变量的简单方法是什么？

就像是：

```
for($i=0; $i < $numPostVars; $i++){
   if(isset($_POST['first".$i."'])){
       //echo all first names post variables that are set
    }
}

// do the same from last names & age in separate loops 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-12T23:44:03.520

我认为诀窍是将变量命名为略有不同，并利用 PHP 的特性将它们解压缩为数组。只需使用语法：`first[1]`. 然后在 PHP 中，您可以在 $_POST['first']['1'] 中找到它。然后，您可以使用迭代所有“第一个”输入

```
foreach($_POST['first'] as $first_input) {
  // ... 
} 
```

还要记住，如果用户提交时该字段为空，浏览器[可能不会发送该字段。](http://www.w3.org/TR/html401/interact/forms.html#h-17.13.2)

这是输入在 HTML 中的样子：

```
<input name="first[1]"> <input name="last[1]"> <input name="age[1]"> 
```

正如用户@DaveRandom 所指出的，还要考虑一个更分层的结构（想想你的数据库中的“行”）：

```
<input name="people[1][first]"> <input name="people[1][last]"> <input name="people[1][age]"> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T00:10:49.500

输入可以被视为数组，其语法与 PHP 中使用的语法非常相似：

```
<input name="name[1]" value="value 1">
<input name="name[2]" value="value 2"> 
```

这将导致`$_POST['name']`如下所示：

```
array(
  1 => "value 1",
  2 => "value 2"
); 
```

该原理可以扩展为包含多维和关联数组。因此，如果您要这样命名输入：

```
<input name="rows[1][first]"> <input name="rows[1][last]"> <input name="rows[1][age]">
<input name="rows[2][first]"> <input name="rows[2][last]"> <input name="rows[2][age]"> 
```

...您将能够轻松地`$_POST['rows']`使用`foreach`构造进行迭代。数据结构将非常类似于一组数据库结果。

```
foreach ($_POST['rows'] as $row) {
  // do stuff with $row['first'], $row['last'] and $row['age'] here
} 
```

有几点需要注意：

*   与 PHP 不同，HTML 中的关联数组键不需要引号，使用它们会产生您可能意想不到的结果。它会*起作用*，但不是你想象的那样。不过，您仍然需要在 PHP 中使用引号。
*   据我所知，这种语法不是 W3C 标准。然而，PHP 总是按预期处理它。

# javascript - KineticJS - 设置组/图像可拖动的部分

> ID：13850603
> 
> 赞同：0
> 
> 时间：2012-12-12T23:40:21.090
> 
> 标签：javascript, kineticjs

这就是我在 KineticJS 中需要的：

我有一个 300x300 的大图像，我希望能够拖动它，但前提是我在图像的上半部分单击拖动。如果我尝试拖动此图像的其余部分，我不希望它移动。这可能吗？

此外，如果我尝试拖动此图像，如何使其将组中的其余项目与它一起拖动？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T15:49:26.727

最简单的方法是创建一个自定义命中区域函数，该函数在图像的右上角定义一个矩形区域。这是一个例子：

[http://www.html5canvastutorials.com/kineticjs/html5-canvas-kineticjs-custom-hit-function-tutorial/](http://www.html5canvastutorials.com/kineticjs/html5-canvas-kineticjs-custom-hit-function-tutorial/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T00:03:53.593

See here: [http://jsfiddle.net/NnD5q/](http://jsfiddle.net/NnD5q/)

```
box.on('mousedown', function(e){
    var bX = box.attrs.x, bY = box.attrs.y;

    // set draggable false if they aren't in our click range 
    // (a 20x20 square in the top left)
    if (e.x > bX + 20 || e.y > bY + 20)
        box.setDraggable(false);          
});
window.onmouseup = function(e){
    box.setDraggable(true);  // set draggable true on **window** mouseup.
}; 
```

Another option would be to create a drag handle object, `group.setDraggable(true)` on mousedown for that drag handle, then `group.setDraggable(false)` on window mouseup. This second option is likely much cleaner.

# sql - 将 Excel 日期序列号转换为常规日期

> ID：13850605
> 
> 赞同：31
> 
> 时间：2012-12-12T23:40:29.560
> 
> 标签：sql, sql-server, tsql, ssis, etl

我的 csv 文件中有一个名为 DateOfBirth 的列，其中包含 Excel 日期序列号日期

例子：

```
 36464
  37104
  35412 
```

当我在excel中格式化单元格时，这些被转换为

```
 36464 => 1/11/1999
  37104 => 1/08/2001
  35412 => 13/12/1996 
```

我需要在 SSIS 或 SQL 中进行此转换。如何做到这一点？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-12-12T23:56:58.323

在 SQL 中：

```
select dateadd(d,36464,'1899-12-30')
-- or thanks to rcdmk
select CAST(36464 - 2 as SmallDateTime) 
```

在 SSIS 中，请参见此处

[http://msdn.microsoft.com/en-us/library/ms141719.aspx](http://msdn.microsoft.com/en-us/library/ms141719.aspx)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2014-10-01T20:16:28.327

标记的答案无法正常工作，请将日期更改为“1899-12-30”而不是“1899-12-31”。

```
select dateadd(d,36464,'1899-12-30') 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2015-01-08T22:01:01.213

您可以将其转换为 SQL `SMALLDATETIME`：

```
CAST(36464 - 2 as SMALLDATETIME) 
```

MS SQL Server 从 1900 年 1 月 1 日开始计算其日期，**而**Excel 从**1899**年 12 月 30 日开始计算其日期= 少了 2 天。

 *** * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-09-10T06:48:10.570

这实际上对我有用

```
dateadd(mi,CONVERT(numeric(17,5),41869.166666666664)*1440,'1899-12-30') 
```

（在日期中再减去 1 天）

指的是负面评论帖子

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2020-01-31T22:36:37.540

**tldr：**

```
select cast(@Input - 2e as datetime) 
```

**解释：**

[Excel 将日期时间存储为一个浮点数](https://stackoverflow.com/questions/981655/how-to-represent-a-datetime-in-excel/981865)，表示自 20 世纪初以来经过的时间，SQL Server 可以以相同的方式轻松地在[浮点数](https://docs.microsoft.com/en-us/sql/t-sql/data-types/float-and-real-transact-sql)和日期时间之间进行转换。Excel 和 SQL Server 将此数字转换为日期时间的时间差为 2 天（[即截至 1900 年](https://docs.microsoft.com/en-us/office/troubleshoot/excel/wrongly-assumes-1900-is-leap-year)3 月 1 日）。使用文字 of`2e`表示这种差异会通知 SQL Server 将其他数据类型隐式转换为浮点数，以实现非常易于输入和简单的查询：

```
select
    cast('43861.875433912' - 2e as datetime) as ExcelToSql, -- even varchar works!
    cast(cast('2020-01-31 21:00:37.490' as datetime) + 2e as float) as SqlToExcel

-- Results:
-- ExcelToSql                          SqlToExcel
-- 2020-01-31 21:00:37.490        43861.875433912 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-06-18T05:29:52.627

## SSIS 解决方案

> DT_DATE 数据类型使用 8 字节浮点数实现。天数以整数增量表示，从 1899 年 12 月 30 日开始，午夜作为时间零。小时值表示为数字小数部分的绝对值。然而，一个浮点值不能代表所有的实数值；因此，可以在 DT_DATE 中显示的日期范围存在限制。*[阅读更多](https://docs.microsoft.com/en-us/sql/integration-services/data-flow/integration-services-data-types)*

从上面的描述可以看出，在将这些值**转换为 8 字节浮点数后，将****它们映射到 Column 时，可以隐式转换这些值。`DT_DATE``DT_R8`**

使用派生列转换将此列转换为 8 字节浮点数：

```
(DT_R8)[dateColumn] 
```

然后将其映射到`DT_DATE`列

或者投两次：

```
(DT_DATE)(DT_R8)[dateColumn] 
```

你可以在这里查看我的完整答案：

*   [有没有更好的方法来解析 SSIS 中的 [Integer].[Integer] 样式日期？](https://stackoverflow.com/questions/44287850/is-there-a-better-way-to-parse-integer-integer-style-dates-in-ssis)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-12-08T16:46:32.903

发现这个主题非常有用，因此为它创建了一个快速的 SQL UDF。

```
CREATE FUNCTION dbo.ConvertExcelSerialDateToSQL
(
    @serial INT
)
RETURNS DATETIME
AS
BEGIN
    DECLARE @dt AS DATETIME
    SELECT @dt = 
        CASE
            WHEN @serial is not null THEN CAST(@serial - 2 AS DATETIME)
            ELSE NULL
        END
    RETURN @dt              
END
GO 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-03-06T17:14:54.677

我不得不把它提升到一个新的水平，因为我的 Excel 日期也有时间，所以我有这样的值：

```
42039.46406 --> 02/04/2015 11:08 AM
42002.37709 --> 12/29/2014 09:03 AM
42032.61869 --> 01/28/2015 02:50 PM 
```

（另外，为了更复杂一点，我的小数数值被保存为 NVARCHAR）

我用来进行这种转换的 SQL 是：

```
SELECT DATEADD(SECOND, (
                        CONVERT(FLOAT, t.ColumnName) - 
                        FLOOR(CONVERT(FLOAT, t.ColumnName))
                       ) * 86400,
               DATEADD(DAY, CONVERT(FLOAT, t.ColumnName), '1899-12-30')
              ) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-03-27T12:48:56.527

除了@Nick.McDermaid 的回答，我还想发布这个解决方案，它不仅可以转换日期，还可以转换小时、分钟和秒：

```
SELECT DATEADD(s, (42948.123 - FLOOR(42948.123))*3600*24, dateadd(d, FLOOR(42948.123),'1899-12-30')) 
```

例如

*   `42948.123`至`2017-08-01 02:57:07.000`
*   `42818.7166666667`至`2017-03-24 17:12:00.000`

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-08-10T16:56:23.063

如果您只需要在视图中显示日期，则可以这样做：

`CAST`会比`CONVERT`拥有大量数据时更快，还记得从 excel 日期中减去 (2)：

```
CAST(CAST(CAST([Column_With_Date]-2 AS INT)AS smalldatetime) AS DATE) 
```

如果您需要更新列以显示日期，您可以通过联接（必要时自行联接）进行更新，或者简单地尝试以下操作：

您可能不需要将 excel 日期转换为 INT，但由于我正在使用的表是 varchar，因此我必须先进行该操作。我也不想要“时间”元素，所以我需要删除该元素，并将最终转换为“日期”。

```
UPDATE [Table_with_Date]
SET [Column_With_Excel_Date] = CAST(CAST(CAST([Column_With_Excel_Date]-2 AS INT)AS smalldatetime) AS DATE) 
```

如果你不确定你想用这个测试做什么，然后重新测试！如果需要，请复制您的表格。您可以随时创建视图！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-07-01T00:39:28.090

在 postgresql 中，您可以使用以下语法：

```
SELECT ((DATE('1899-12-30') + INTERVAL '1 day' * FLOOR(38242.7711805556)) + (INTERVAL '1 sec' * (38242.7711805556 - FLOOR(38242.7711805556)) * 3600 * 24)) as date 
```

在这种情况下，以 excel 格式`38242.7711805556`表示`2004-09-12 18:30:30`

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-09-25T10:20:34.120

对于那些寻找如何在 excel 中执行此操作的人（在格式化日期字段之外），您可以使用文本函数[https://exceljet.net/excel-functions/excel-text-function来执行此操作](https://exceljet.net/excel-functions/excel-text-function)

IE

```
A1 = 132134
=Text(A1,"MM-DD-YYYY") will result in a date 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-08-03T13:41:42.690

谷歌 BigQuery 解决方案

标准 SQL

```
Select Date, DATETIME_ADD(DATETIME(xy, xm, xd, 0, 0, 0),  INTERVAL xonlyseconds SECOND) xaxsa
from (
  Select Date, EXTRACT(YEAR FROM xonlydate) xy, EXTRACT(MONTH FROM xonlydate) xm, EXTRACT(DAY FROM xonlydate) xd, xonlyseconds
  From (
     Select Date
        , DATE_ADD(DATE '1899-12-30', INTERVAL cast(FLOOR(cast(Date as FLOAT64)) as INT64) DAY )   xonlydate
        , cast(FLOOR( ( cast(Date as FLOAT64) - cast(FLOOR( cast(Date as FLOAT64)) as INT64)  ) * 86400 ) as INT64) xonlyseconds
     FROM (Select '43168.682974537034' Date) -- 09.03.2018  16:23:28
   ) xx1
 ) 
```

* * *

## 回答 #14

> 赞同：-3
> 
> 时间：2014-07-28T16:22:43.233

这对我有用，因为有时该字段是获取时间部分的数字。

命令：

```
 dateadd(mi,CONVERT(numeric(17,5),41869.166666666664)*1440,'1899-12-31') 
```**

# regex - 如何使用 AWK 将带逗号的字段括在引号中？

> ID：13850610
> 
> 赞同：3
> 
> 时间：2012-12-12T23:40:48.847
> 
> 标签：regex, unix, awk

假设我有这个文件由制表符分隔：

```
This    is    a    cat,dog
I    run    around    the    house,garage 
```

我想用逗号替换所有选项卡实例（我可以做那部分），但也将所有带逗号的单词用引号括起来。所以生成的文件看起来像：

```
This,is,a,"cat,dog"
I,run,around,the,"house,garage" 
```

我该怎么做呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-12T23:47:40.403

这是一种方法：

```
awk -v FS='\t' -v OFS=, '{$1=$1; for(i=1; i<=NF; i++) if($i ~ /,/) $i = "\"" $i "\"" } 1' 
```

输出：

```
This,is,a,"cat,dog"
I,run,around,the,"house,garage" 
```

### 解释：

*   `OFS=,`并使`$1=$1`awk 用 OFS 替换 FS。
*   for 循环检查每个字段，如果它包含逗号，则将其括在双引号中。
*   最后`1`调用默认规则`{ print $0 }`。

### 编辑

[*史蒂夫*](https://stackoverflow.com/a/13851031/1331399)是对的，在这种情况下 sed 更简短。您可以通过使用正则表达式（从 steve 借来）并附加 OFS 和 FS 的设置（用 GNU awk 测试）来缩短它：

```
awk '{ $0 = gensub(/[^\t]*,[^\t]*/, "\"&\"", "g"); $1=$1 } 1' FS='\t' OFS=, 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T00:10:51.887

使用 sed 和 tr，还可以处理单词之间的空格：

```
 sed 's/\([a-zA-Z]*[ ]*,[ ]*[a-zA-Z]*\)/"\1"/' input | tr '\t' ',' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-13T00:22:45.713

`awk`可能不是这项工作的正确工具。我认为`sed`会是一个更好的选择。这是我要做的：

```
sed 's/[^\t]*,[^\t]*/"&"/g;s/\t/,/g' file 
```

# android - DreamService 的锁定屏幕方向

> ID：13850611
> 
> 赞同：3
> 
> 时间：2012-12-12T23:40:51.370
> 
> 标签：android, android-4.2-jelly-bean, dreamservice

在过去的几个小时里，我一直在摆弄新的[`DreamService`API](http://developer.android.com/reference/android/service/dreams/DreamService.html)，它非常棒。不过，我确实有一个问题。

我想在显示时将屏幕方向锁定为横向`DreamService`。的目的`DreamService`是显示一些宽屏照片，我宁愿不要在屏幕的顶部和底部有黑条。

我已经尝试了很多东西，包括`setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE)`在 Java 代码和`android:screenOrientation="landscape"`清单文件中，但都没有奏效。

这让我想知道：是否可以锁定 a 的方向`DreamService`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T16:22:57.180

Android 开发者团队在前段时间的开发者现场环聊中证实，目前这是不可能的。

我相信谷歌想要`DreamServices`在两种屏幕方向上工作，所以这就是不可能的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-10-12T12:22:34.103

**解决方法：**使用此库[https://github.com/rongi/rotate-layout](https://github.com/rongi/rotate-layout)

*构建.gradle*

```
 dependencies {
        compile 'rongi.rotate-layout:rotate-layout:2.0.0'
    } 
```

*your_daydream_layout.xml*

```
<com.github.rongi.rotate_layout.layout.RotateLayout  
   xmlns:android="http://schemas.android.com/apk/res/android"
   xmlns:app="http://schemas.android.com/apk/res-auto"
   android:layout_width="wrap_content"
   android:layout_height="wrap_content"
   app:angle="-90">

<RelativeLayout
    android:layout_width="match_parent"
    android:layout_height="match_parent">
    <WebView
        android:id="@+id/daydream_webview"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:background="#2a2e31" />

    <TextView
        android:id="@+id/dream_text"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:fontFamily="sans-serif-light"
        android:text="..."
            android:textColor="#abc"
            android:textSize="20sp" />
    </RelativeLayout>
</com.github.rongi.rotate_layout.layout.RotateLayout> 
```

* * *

**顺便说一句：允许从**[https://code.google.com/p/android/issues/detail?id=40226](https://code.google.com/p/android/issues/detail?id=40226) 自动旋转你的白日梦

> “看起来已经解决了这个问题（没有人告诉我们）。不幸的是，它不能正常工作。在我的 Nexus 6p（6.0.1，Build #MHC19Q）上，如果我滑动到最左边的屏幕（Google Now？），点击左上角的汉堡菜单，选择设置，然后转到底部，主屏幕选项有一个“允许旋转”。启用该选项后，主屏幕将能够旋转到需要时横向显示。Daydream 可以继承该旋转并以横向模式显示。” -- 2016 年 5 月 18 日

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-06T22:40:31.263

很遗憾我也没有找到任何解决方案，我不得不使用一个讨厌的解决方法，它可能对你有用，也可能对你不起作用，就是在设置布局之前设置自动旋转设置：

在您的 DreamService 课程中：

```
import android.provider.Settings;
<...>

    @Override
public void onAttachedToWindow() {

    Settings.System.putInt(getContentResolver(),
            android.provider.Settings.System.ACCELEROMETER_ROTATION, 0);

    setContentView(R.layout.dream_main);
<...> 
```

在您的清单中：

```
<uses-permission android:name="android.permission.WRITE_SETTINGS" /> 
```

# c# - 将数组写入带有制表符分隔符的文本文件，一行

> ID：13850613
> 
> 赞同：1
> 
> 时间：2012-12-12T23:41:33.640
> 
> 标签：c#

我觉得这应该是一个简单的问题，但它完全困扰着我。我有一个大小为 64 的字符串数组，称为 items。我想将每一项项目写入一个文本文件，每个值由一个制表符分隔。但是，当我尝试以下代码时，它会写入每个项目 + 选项卡，然后是新行。如何将所有数组写入一行，而不是一行一行？

```
using (System.IO.StreamWriter file = new System.IO.StreamWriter(path1+custFile))
    for(int i=0; i<64; i++)
        file.WriteLine(items[i].ToString()+"\t"); 
```

结果：

```
1002H0025   
Sample test Customer    

Foo 
Mr  
123 FAKE STREET 

sAN JOSE 
```

依此类推，我从上面排除了标签本身。应该是 1002H0025 Sample test Customer Foo Mr 123 FAKE STREET sAN JOSE

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-12T23:44:41.630

您当前正在`WriteLine()`循环内使用。

尝试`Write()`改用。

`WriteLine``\n`在写入输出后输出一个换行符 ( )。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-12T23:45:09.920

好吧，是的，看 - 你反复调用这个：

```
file.WriteLine(items[i].ToString()+"\t"); 
```

顾名思义，这写了*一行*- 包括行终止符。您*可以*将其更改为`file.Write`... 但我建议完全摆脱您的循环：

```
file.WriteLine(string.Join("\t", items)); 
```

或者也摆脱作家：

```
string path = Path.Join(path1, custfile);
File.WriteAllText(path, string.Join("\t", items)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-08-18T10:31:17.377

我需要使用 savefiledialog 将值保存在文本文件中，一切正常，但我无法看到我的所有输出，只有一行可见。

```
 SaveFileDialog savefile = new SaveFileDialog();
   savefile.Filter = "Text files (*.txt)|*.txt|All files (*.*)|*.*";
   if (savefile.ShowDialog() == DialogResult.OK)
   {
       using (FileStream fs = new FileStream(savefile.FileName, FileMode.Append, FileAccess.Write))
       using (StreamWriter writer = new StreamWriter(fs))
       {
           writer.WriteLine("northing:{0},easting:{1}", AE, AF);
           writer.Close();

       } 
```

获得的 o/p 为北距：234567.89，东距：23456.89，其他线不可见

# html - 为什么表格宽度被忽略？

> ID：13850614
> 
> 赞同：12
> 
> 时间：2012-12-12T23:41:33.663
> 
> 标签：html, css, width, css-tables

我在以下编码样式：

```
table.gridtable {
    font-family: verdana,arial,sans-serif;
    font-size:14px;
    color:#333333;
    border-width: 1px;
    border-color: #666666;
    border-collapse: collapse;
        width: 400px;
} 
```

而且我在 Firebug 中看不到任何覆盖。然而，表格宽度计算为 812 像素；

为什么？

实际页面在这里（俄语）： http: [//garmonia-znakomstva.ru/service.html](http://garmonia-znakomstva.ru/service.html)

**更新**

我可以添加不可见的分词，如果空间不足会导致分词和连字符，如果空间足够则导致连续单词？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-12-13T03:55:00.160

宽度设置不被忽略；它只是被单元格内容的最低要求覆盖。在每一列中，最长的单词决定了可能的最小宽度。这符合 CSS 规范：对于表格，`width`默认情况下该属性只是建议的最小宽度。

不过，“尽可能小”是相对的。您可以通过不同的方式启用分词。但是要查看这会将您带到哪里，您可以通过将`<html>`标签更改为`<html lang=ru>`并将规则添加`* { -moz-hyphens: auto }`到您的 CSS 并在 Firefox 上测试页面来进行测试。您将看到表格的格式，以便单词带有连字符，并且宽度尽可能接近声明的宽度。它看起来相当可怕。声明的宽度对于内容来说太小了。

或者，尝试`table { table-layout: fixed }`在 CSS 中设置。无论如何，这将强制宽度。这将使单元格内容溢出单元格。我想你也不会喜欢这个。

因此，我建议您不要尝试强制执行如此窄的宽度，而是完全删除宽度设置并启用连字符。结果看起来比较好。对于连字符，我建议使用 Hyphenator.js，这是[一种](https://github.com/mnater/hyphenator)跨浏览器的基于 JavaScript 的方法；基于 CSS 的方法仍然有相当有限的浏览器支持。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-12T23:54:37.387

您的问题是由于表格的每个单元格中的单个单词太长而导致的，并且您没有指定应该如何处理。

尝试添加：

```
word-break: break-all; 
```

遵从你的`table.gridtable td`规则。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-12T23:55:15.890

这是因为表格中有单词，默认是不能换行的，所以表格不能收缩。会出现以下效果：

```
| verylongwordandsoon | anotherlongwordinrussian | justanotherword 
```

如果您尝试将 设置`font-size`为`1px`，您将看到宽度正好是 400 像素。

但是，在 CSS3 中，CSS 属性`word-break`可以处理它。

```
word-break: break-all; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-09-08T09:28:12.413

明确地应用它给了我正确的结果，宽度得到尊重，使用新行的长文本和高度（而不是宽度）相应地扩展。

```
td { white-space:normal} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-12T23:57:35.017

你不能让一张桌子太小而不能容纳它的内容。您可以尝试减小字体大小或尝试不同的布局（例如使用更少的列）。

关于您更新的问题：是的，您可以添加不可见的分词（这是一个示例：[How to Wrap unspaces word for Opera Browser](https://stackoverflow.com/questions/1899453/how-to-wrap-unspaces-word-for-opera-browser)），但这确实是最后的手段。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-03-24T14:02:49.830

您的 css 文件可能已经定义`white-space: nowrap;`了哪些会阻止自动换行。

# objective-c - 将 UIView 添加到 UIActionSheet 大小不正确

> ID：13850615
> 
> 赞同：1
> 
> 时间：2012-12-12T23:41:34.180
> 
> 标签：objective-c, ios, xcode, uiview, uiactionsheet

我正在尝试将视图添加到 ActionSheet 中，但尺寸都搞砸了。

视图出现了，但是当它没有以正确的大小显示时。我将视图宽度设置为 300，高度设置为 411。

当我使用代码将其添加到操作表时：

```
ContactCardViewController* myController = [[ContactCardViewController alloc] initWithNibAndEmployeeInfo:[self.request objectForKey:@"Requestor"]];

[self.actionSheet showInView:self.view];
[self.actionSheet setBounds:[myController.view frame]];
[self.actionSheet addSubview:myController.view]; 
```

View 只显示了一半左右，右边被稍微切掉了，看起来和 superview 的大小差不多，应该小很多。

我该如何解决？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T20:37:45.157

您不应**更改**边界、框架或中心以及添加或修改`UIActionSheet`.

这就是你可以解决这个问题的方法，因为没有人知道这个类的内部实现，而且它的行为肯定不正常`UIView`。

# google-chrome - 在另一个元素的变换期间不相关的 div 移动

> ID：13850616
> 
> 赞同：0
> 
> 时间：2012-12-12T23:41:37.860
> 
> 标签：google-chrome, css, webkit, css-transitions

在[此页面上](http://google.com)，当您将鼠标悬停在右上角的红色标记上时，css3 transform 会旋转图像。这可以按预期工作，但 div.last.half 会短暂地向右单击并返回其原始位置。

这仅出现在 Chrome 24.0.1312.35 beta-m 中。

我无法弄清楚是什么原因造成的。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T00:01:18.910

它看起来像 Chrome 中的一个错误。它可能与GPU合成有关。该问题在 Mac 上的 Chrome 23.0.1271.95（官方版本 169798）中为我重现，但在 Mac 上的 Chrome 25.0.1358.0（官方版本 172524）金丝雀中没有重现。如果这是 Chrome 中的错误，则该错误可能已被修复。

如果您需要立即解决方法，您可以尝试强制合成闪光区域。例如，通过更改`<div id="main" …&gt;`为具有这种内联样式`style="-webkit-transform: translate3d(0, 0, 0);"`，这种闪烁不再发生在我身上。

# git - 如何查找 git 存储库中的哪个标签包含特定的提交

> ID：13850618
> 
> 赞同：3
> 
> 时间：2012-12-12T23:41:55.253
> 
> 标签：git

使用如下命令，我确定某个函数何时首次出现在 git 存储库中。

```
git log -Sfoo 
```

我要确定的是，它首先出现在哪个标签中。

因此，例如在 node.js 存储库中，每个版本都有标签，所以我想确定哪个版本中有函数 foo 。

git log 会给我提交哈希，然后我想用它来查找它出现的第一个标签。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-12T23:44:48.633

您可以像以前那样使用镐来查找提交，然后使用...

```
git tag --contains <sha1> 
```

我不确定顺序，但如果是第一个，您可以通过`head -1`.

你可以用一个错误的命令找到它......

```
git tag --contains $(git log --format="%H" -1 -Sfoo) | head -1 
```

# javascript - FB.getLoginStatus 触发浏览器弹出阻止程序。我怎样才能阻止它？

> ID：13850622
> 
> 赞同：1
> 
> 时间：2012-12-12T23:42:41.217
> 
> 标签：javascript, jquery, facebook, facebook-javascript-sdk

我从按钮单击事件调用 Facebook JS SDK 的 FB.getLoginStatus。我的问题是，如果 status 参数设置为 true，则会触发浏览器弹出窗口阻止程序，从而阻止显示登录对话框。但是，当我的状态为 false 时，不会触发弹出窗口阻止程序。我需要将状态设为 true，因为我的网站需要知道用户是否已登录 Facebook，而无需刷新页面。False 参数值意味着 FB 只获取缓存的登录状态，如果用户在您的网站上退出 Facebook，这可能是错误的。

我怎样才能解决这个问题？

这是一些说明问题的代码

```
 $('.my-button').click(function () {

            FB.getLoginStatus(function (response) {

                if (response.status != 'connected') {

                    FB.login(function (r) {
                        if (r.status == 'connected') {
                            alert('logged in');
                        }
                    });
                }

            }, true);

        }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T18:16:39.033

这可能是因为当您将 forceCheck 传递给 getLoginStatus 时，回调被异步调用，从而切断了与“click”事件的连接。浏览器或弹出窗口阻止程序未能在调用堆栈上找到用户发起的单击事件，因此它会阻止弹出窗口。我目前正被同样的问题所困扰。

选项：

1）直接调用FB.login。

缺点：即使对于已登录的用户，也难看弹出式闪光灯。

2) 在使用 getLoginStatus 检测到用户未登录（或应用程序未授权）时，在 $('.my-button') 附近的某处插入一个单独的登录按钮，可能带有一条消息说用户必须单击登录按钮与 Facebook 连接。在第二个按钮的点击处理程序中直接调用 FB.login() 。

缺点：-50 转化率

我现在将尝试 2) 并报告结果。

# android - java.lang.NoClassDefFoundError: com.applibrary.R$layout

> ID：13850626
> 
> 赞同：1
> 
> 时间：2012-12-12T23:42:52.503
> 
> 标签：android

编辑：已解决。如何？当然可以，但是一位用户评论了我关于 res-folder 中的错误的问题可能会导致这种情况发生。此文件夹中没有错误，但有关于未使用图像的警告。删除了这个和其他可能导致警告的原因，重新编译并上传到 Play。有用...

--

我制作了一个可以在模拟器和设备上正常运行的应用程序。如果我导出然后应用程序并在我的设备上安装该应用程序，它就可以工作。但是当我在 Play 上发布并从那里安装它时，我收到了这个错误：

```
java.lang.NoClassDefFoundError: com.applibrary.R$layout
at com.applibrary.ANEivActivity.onCreate(ANEivActivity.java:179)
at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1069)
at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2751)
at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2803)
at android.app.ActivityThread.access$2300(ActivityThread.java:135)
at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2136)
at android.os.Handler.dispatchMessage(Handler.java:99)
at android.os.Looper.loop(Looper.java:144)
at android.app.ActivityThread.main(ActivityThread.java:4937)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:521)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:858)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:616)
at dalvik.system.NativeStart.main(Native Method) 
```

此错误仅在与 R 以外的其他内容或远程可以对项目设置进行任何操作的任何其他内容相关的错误修复期间发生。似乎 applibrary 在 Play(?) 上发布时丢失了。

我的应用程序使用了一个名为 applibrary 的库，大部分代码，包括 java、layout、string，都位于这个库中。

为什么这个错误只发生在从 Play 下载应用程序而不像模拟器和设备上提到的那样运行时？

我试过“修复项目属性”、“清理”。

# dpi - 如何在 Web 浏览器中以适当的比例显示 5mm 网格？

> ID：13850628
> 
> 赞同：6
> 
> 时间：2012-12-12T23:43:12.243
> 
> 标签：dpi, calibration

我正在创建一个用于显示心电图的 Web 应用程序，这些心电图通常以固定比例（10 毫米/mV 和 25 毫米/秒）在 5 毫米方形网格上绘制。使用正确的尺寸很重要，因为读者会将他们在屏幕上看到的内容与可能仅存在于纸上的其他心电图进行比较。

最推荐的解决方案是使用 CSS 设置 div 的样式，使其具有（例如）1" x 1" 的绝对尺寸，并使用 JavaScript 获取其高度和宽度（例如，参见[如何检测屏幕 DPI使用 PHP 或 JavaScript](https://stackoverflow.com/questions/9292156/how-to-detect-the-screen-dpi-using-php-or-javascript)）。显然，这只有在浏览器知道（或可以发现）答案并且可以被欺骗揭示它的情况下才有效。我在 Linux、Mac OS X 和 Windows 上使用 Chrome、Firefox、MSIE、Opera、Safari 和 Android 浏览器在智能手机 (217 dpi) 到 19" (108 dpi)、20" 的设备上测试了这种方法, 和 30" (101 dpi) 显示器，在所有情况下报告的分辨率都是 96 dpi。我的结论是，这种方法不如损坏的手表准确，除非你碰巧有一个 96 dpi 的显示器，我正在寻找为了更好的东西。

我正在考虑只显示一个可调整大小的矩形并要求用户将其调整为已知大小。是否有人已经这样做了（如果是，如何），或者是否有人有其他建议（例如在监视器数据库中查找屏幕尺寸）？

我在这里和其他地方阅读了相关讨论，这些讨论很快转向了为什么图形的绝对大小无关紧要，只有细节的数量。我理解为什么这通常是正确的，但在这种情况下并非如此。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-13T01:09:44.210

可悲的是，根据我自己在客户项目中的经验，您的建议是唯一可靠的选择。

唯一真正可靠的方法是要求用户根据固定尺寸的物体（例如尺子）校准尺寸。我们尝试了其他几种解决方案，但一直没有其他方法有效。

我让用户在注册时只做一次，所以这不是太大的麻烦（系统使用它的用户数量相对较少）。

至于如何，我有一个可调整大小的 div，用户必须将其校准为 1cm，我让用户以这种方式校准两个不同的 div，并验证它们之间的大小差异不大于 x（其中 x 被接受公差值）。校准是通过键盘键或拖动 div 角完成的，尽管键盘键通常可以提供更好的结果，但很多人对鼠标的使用并不好，我们收到了投诉，允许键盘输入（增加/减小大小）解决了大部分投诉。添加一个您指定像素数量（并查看结果）的文本框也可能有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-03T12:11:20.980

用于 Mac 的 Internet Explorer 5 带有一个滑块，用于在其首选项中调整 CSS 绝对单位的值，甚至还提供了将标尺放在屏幕上的建议。当然，我的 IE 总是完全校准的。

这是我所知道的唯一可以绝对显示绝对单位的浏览器。

# ruby-on-rails-3 - RSpec should_receive 正在执行 Mailer 中的原始方法，即使我没有告诉它

> ID：13850637
> 
> 赞同：0
> 
> 时间：2012-12-12T23:43:48.377
> 
> 标签：ruby-on-rails-3, rspec

我正在测试我的一个邮件程序，并且我有一个控制器测试，它只是断言邮件程序被调用（与[email_spec 中的示例](https://github.com/bmabey/email-spec#testing-in-isolation)非常相似）。

```
# spec/controllers/friendships_controller_spec.rb

it "sends an email when someone sends you a contact request" do
  NotificationMailer.any_instance.should_receive(:contact_request).with(default_user, user)
  xhr :post, :create, {:friendship => {:friend_id => user.id}}
end 
```

由于`nil`在contact_request 的模板中设置了一个变量，此规范失败。所以看起来......该`contact_request`方法实际上正在执行和呈现它的模板，即使我已经模拟了该方法。怎么会？

如果它有任何不同，模板在实际应用程序中渲染得很好——在这个特定的规范中，变量只设置为 nil。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T23:55:08.463

尝试`any_instance`从存根链中删除？它不是在您的代码中通过: 调用的 `NotificationMailer.contact_request`吗？ `any_instance`假设它是在类的实例上调用的，而不是在类本身上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T23:56:23.557

好的，我正在模拟NotificationMailer*实例*的方法，但当然您实际上是在*class*上调用它。看起来 ActionMailer::Base 正在做一些[method_missing 魔术](https://github.com/rails/rails/blob/master/actionmailer/lib/action_mailer/base.rb#L485)，让您将其称为类方法，即使它被定义为实例方法。

解决方案只是调用`should_receive`类，而不是实例。

```
 NotificationMailer.should_receive(:contact_request) 
```

# php - 获取选项名称php

> ID：13850639
> 
> 赞同：0
> 
> 时间：2012-12-12T23:43:57.207
> 
> 标签：php, html, mysql, forms

我是 PHP 新手，所以请耐心等待。我有一些这样的代码 -

```
echo ('<select name="fullname">');
while($row = mysql_fetch_array($dorequest)) {
  echo ('<option name="' . $row['ID'] . '">' . $row['firstname'] . " " . $row['lastname'] .  '</option>'); 
}
echo('</select>'); 
```

哪个工作正常。当我提交表单时，我想获取所选选项的 ID（ $row['ID'] ）。我只能获取选择框的内容。任何想法我可以如何做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-12T23:46:28.187

使用`value`属性而不是`name`：

```
echo ('<option name="' . $row['ID'] . '">' . $row['firstname'] ...
                ^-------HERE, use "value" instead of "name" 
```

由于发送变量的名称已在您的选择中设置，`<select name="fullname">`您需要在中指定的`<option>`是`value`您要发送的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T23:48:32.527

你应该使用：

```
echo ('<option value="' . $row['ID'] . '">' . $row['firstname'] . " " . $row['lastname'] .  '</option>'); 
```

注意我`name`改为`value`. 选项有值，而不是名称。输入名称由`select`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-12T23:50:27.180

如果您在选择表单中使用帖子，那么在 while 循环期间您可以添加

`$ShowID = $rows['ID'];`

然后在发布功能期间的查询中，您可以使用`$ShowID`查询或使用回显`echo $ShowID;`

# trigger.io - 使用 Trigger.io 和 Firebase

> ID：13850640
> 
> 赞同：1
> 
> 时间：2012-12-12T23:43:57.840
> 
> 标签：trigger.io, firebase

[我在 trigger.io 的网站上](http://trigger.io/cross-platform-application-development-blog/2012/06/19/easily-sync-data-between-your-mobile-and-web-apps-using-firebase-and-trigger-io/)看到了教程，所以我知道它应该适用于 Firebase，并且适用于 iOS 模拟器。但我无法让 Firebase 在实际 iOS 设备上的 Trigger.io 下工作。

无论我做什么，我的回调都不会被调用。

触发器是否以某种方式杀死了 websockets？我还需要做些什么才能让它在设备上运行吗？我将请求/权限设置为 allow `http://*/*`, `https://*/*`,`*`但这似乎没有什么区别。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T10:08:15.457

如果您的代码基于我的[Wine Box 应用示例](https://github.com/amirnathoo/Wine-Box/tree/firebase)，那么您的问题可能是由过时的 Firebase 库引起的。

我昨天用最新的库和使用 firebaseio.com 而不是 gamma.firebase.com 引用 Firebase 的新方法更新了 repos。

在那次更新之前，使用旧库在为 web 构建/运行 (forge run web) 时会在 JavaScript 控制台中导致如下错误：

```
Unexpected response code: 200 :3000:1
WebSocket is closed before the connection is established. :3000:1
Uncaught SyntaxError: Unexpected token < 
```

所以...首先要检查的是您使用的是最新的 Firebase 库。

# jquery - JQuery 不会将任何内容传递给 ASP.NET 控制器

> ID：13850649
> 
> 赞同：3
> 
> 时间：2012-12-12T23:44:22.600
> 
> 标签：jquery, ajax, json, asp.net-mvc-4, parameter-passing

我已经使用了两天了，搜索和尝试。但我仍然无法实现我的目标：

将 Jquery 对话框滑块值传递给控制器​​。

前端：

```
@model TheMoodApp.Models.tbl_user
@{
    ViewBag.Title = "ControlPanel";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>@Html.DisplayFor(u=>u.Forename)'s Control Panel</h2>
@* Adding header stuff for control panel *@
@section DialogControlPanel{
    <link rel="stylesheet" href="http://code.jquery.com/ui/1.9.2/themes/base/jquery-ui.css" />
    <script src="http://code.jquery.com/jquery-1.8.3.js"/>
    <script src="https://raw.github.com/brandonaaron/bgiframe/master/jquery.bgiframe.js"/>
    <script src="http://code.jquery.com/ui/1.9.2/jquery-ui.js"/>
    <script src="~/Scripts/MoodAppScripts.js"/>
    <link href="~/Content/MoodApp.css" rel="stylesheet" />
}
@*The dialog for set initial mood*@
<div id="dialog-modal" title="Hi @Html.DisplayFor(u=>u.Forename)<br/>How do U feel 2Day?">
    <header id="InitialMoodHeader">
        <p>Set UR Mood 
            <input type="text" id="DisplayMood" readonly="readonly"/>
        </p>
    </header>
    <section id="InitialMoodSlider">
        <div id="MoodSlider"></div>
    </section>
</div> 
```

Javascript文件：

```
$(document).ready(

function () {
    $("#dialog-modal").dialog({
        height: 140,
        modal: true,
        buttons: {
            "This is my Mood": function () {
                $.ajax({
                    url: '@Url.Action("User", "CheckInMood")',
                    data: JSON.stringify({ mood: $("#DisplayMood").val() }),
                    type: 'POST',
                    contentType: 'application/json; charset=utf-8',
                });
                $(this).dialog("close");
            }
        }

    });

    $("#MoodSlider").slider({
        //TODO: IMPLEMENT JSON TO GET MOOD; ATM FEATURE IS FIXED.
        range: "max",
        min: 0,//scales minimum
        max: 3,//scales maximum
        value: 2,//default value
        slide: function (event, ui) {
            $("#DisplayMood").val(ui.value);//get value from slider and display it
        } 
    });
    $("#DisplayMood").val(
        $("#MoodSlider").slider("value")
        );//set input value from slider
}); 
```

控制器：

```
[HttpPost]
    public JsonResult CheckInMood(string mood)
    {
        //current user checks in with current mood
        uint i = Convert.ToUInt16(mood);
        return Json(View());
    } 
```

有人可以帮助我，让它发挥作用，并向我解释我做错了什么吗？

提前致谢

//borb

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T00:01:25.557

It appears you are including Razor code: `@Url.Action("User", "CheckInMood")` in your JavaScript file.

Since this is a javascript file, Razor will not be used to render that value so it will treat it as a literal.

What you'll want to do is pass in the URL from your View into JavaScript.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T00:14:03.567

@Url.Action is only usable from within the razor file itself then, being it in the script tag and so, and now where else? (Just to clarify)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-12T23:55:09.977

改变：

```
data: JSON.stringify({ mood: $("#DisplayMood").val() }) 
```

至：

```
data: { mood: JSON.stringify($("#DisplayMood").val()) } 
```

您需要字符串化参数的值，而不是参数名称。

# c++ - C++：通过引用传递或使用私有实例变量

> ID：13850654
> 
> 赞同：0
> 
> 时间：2012-12-12T23:44:37.187
> 
> 标签：c++, recursion, parameter-passing, pass-by-reference, instance-variables

这样做的最佳方法是什么：我有一个大型集合类`ListCompletions(string digits, Lexicon & lex)`（lex）。我需要在`containsPrefix(string prefix)`方法中访问它。我可以选择在方法之间通过引用传递词典（在某些我不使用它的方法中），或者我可以复制它并将其`containsPrefix(string prefix)`保存为私有实例变量。

我的猜测是将其复制为私有实例变量将是迄今为止最好的选择，因为在参数中传递它只会使代码更加复杂，而且私有实例变量更难调试，因为它更难知道哪些方法正在使用它。但我要求绝对确定，所以我不会养成任何不好的编码习惯。

```
#include "CellPhoneMindReading.h"

void CellPhoneMindReading :: ListCompletions(string digits, Lexicon & lex)
{
    //cout << lex.contains("fedora") << endl;

    RecursiveMnemonics("", "72");
}

/*
 * Function: containsPrefix
 * Usage: containsPrefix(prefix);
 * ----------------------------------------
 * This function returns the given prefix passed as argument if it
 * is found in the Lexicon database. prefixes that are not found
 * is discarded and the return value is a empty string.
 */
string CellPhoneMindReading :: containsPrefix(string prefix)
{
    if (
    return "";
}

/*
 * Function: RecursiveMnemonics
 * Usage: RecursiveMnemonics(prefix, rest);
 * ----------------------------------------
 * This function does all of the real work for ListMnemonics and
 * implements a more general problem with a recursive solution
 * that is easier to see. The call to RecursiveMnemonics generates
 * all mnemonics for the digits in the string rest prefixed by the
 * mnemonic string in prefix. As the recursion proceeds, the rest
 * string gets shorter and the prefix string gets longer.
 */
void CellPhoneMindReading :: RecursiveMnemonics(string prefix, string rest)
{
    if (rest.length() == 0)
    {
        cout << prefix << endl;
        containsPrefix(prefix);
    }
    else {
        string options = DigitLetters(rest[0]);
        for (int i = 0; i < options.length(); i++)
        {
            RecursiveMnemonics(prefix + options[i], rest.substr(1));
        }
    }
}

/*
 * Function: DigitLetters
 * Usage: digits = DigitLetters(ch);
 * ---------------------------------
 * This function returns a string consisting of the legal
 * substitutions for a given digit character. Note that 0 and
 * 1 are handled just by leaving that digit in its position.
 */
string CellPhoneMindReading :: DigitLetters(char ch)
{
    switch (ch) {
        case '0': return ("0");
        case '1': return ("1");
        case '2': return ("ABC");
        case '3': return ("DEF");
        case '4': return ("GHI");
        case '5': return ("JKL");
        case '6': return ("MNO");
        case '7': return ("PRS");
        case '8': return ("TUV");
        case '9': return ("WXY");
        default: cout << "Illegal digit" << endl;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T01:28:28.170

这里有两条评论。

1.  确保 Lexicon 引用为 const。任何其他我认为似乎可疑的事情。
2.  您的直觉是正确的 - 最好将 Lexicon 作为参数传递，而不是使用将其存储在私有成员中。但是，如果传递的所有参数过多，则可以选择成员实例。只有您可以在那里选择最佳权衡。

额外评论：为什么要创建 DigitLetters 成员函数？它不引用任何成员数据 - 因此，作为免费功能会更好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T01:03:32.807

如果您只是存储传递给类的方法的参数以在方法调用期间访问它，我会说这是代码异味，即表明某些事情已关闭。

类上的成员变量定义了它的状态，在这种情况下，词典似乎不属于类的状态，因为它只是在单个函数调用期间使用（从外部角度来看），而不是由类使用然后。

因此，在您提供的 2 个选项中，我显然更喜欢传递论点。

第三种选择是将引用添加为构造函数参数。

第四种选择是创建一个包含“RecursiveMnemonics”、“DigitLetters”和“containsPrefix”的新类，并让该新类将对 Lexicon 的引用作为构造函数参数。然后由“ListCompletions”在堆栈上创建新类。

# c++ - 处理 tcp/udp 接收的最佳方式。

> ID：13850655
> 
> 赞同：0
> 
> 时间：2012-12-12T23:44:39.560
> 
> 标签：c++, sockets, boost, tcp, udp

我正在编写一个简单的程序，通过网络侦听传入的 tcp/udp 数据包并从中检索数据。我还需要解析数据包头以获取序列号等。我正在运行 windows7 和 VC++ 2010。

显然我需要一个数据包生成器，并且我想使用环回地址，以便发送方和接收方在同一台机器上。

由于我是 C++ 网络编程的初学者，我需要一些帮助来弄清楚如何进行。

我应该建立自己的 tcp/udp 生成器吗？如果是，我必须使用 RAW 套接字还是更高级别的 api 就足够了（获取 ip 标头的可能性）。如果不是，应该使用哪个生成器？

我应该为接收器使用什么技术？我在看 boost::asio 和 winsock2.h。但是由于我没有太多时间来发现它们，有人可以告诉我该怎么做。

在前面感谢您的帮助。

最好的祝福。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T00:25:47.460

如果您使用的是winsock，那么您根本不必担心解析IP 标头。Winsock（确实是操作系统）为您完成了所有这些工作。没有必要使用原始套接字（我已经做了 20 多年的网络编程，从未需要使用原始套接字！）。

所以对于一个客户，你想要的功能是`socket`/// `connect`。对于服务器，/ / / / / 。`send``recv``socket``bind``listen``accept``recv``send`

# android - 浏览器和初始活动问题

> ID：13850661
> 
> 赞同：0
> 
> 时间：2012-12-12T23:45:01.133
> 
> 标签：android

活动 A 调用浏览器活动时遇到问题。当用户按下时，浏览器将解析 url e，我希望第一个活动将重新启动并且不显示空白页。这是代码

```
 public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    Integer id =getIntent().getExtras().getInt("id");

    Intent browserIntent;

    switch (id) { 
    case 1: 
        browserIntent = new Intent(Intent.ACTION_VIEW,Uri.parse("http:example"));
        startActivity(browserIntent);
            break;
   etc etc 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T23:59:39.760

我不确定我是否完全理解你的目标，但我会尽力而为。

当您开始一个新的活动 B 然后完成它时，活动 A 将遵循活动[生命周期](http://developer.android.com/reference/android/app/Activity.html)。

听起来您希望 onCreate 中的代码在 B 完成后运行，但 onCreate 仅在活动初始​​化期间调用。或许如果你将你的 switch 逻辑移动到 onResume()，它将在 Activity B 完成后调用，你会得到你想要的结果。

# ruby-on-rails - 定义通过 belongs_to 和 has_many 关系的 CanCan 能力

> ID：13850667
> 
> 赞同：2
> 
> 时间：2012-12-12T23:45:23.470
> 
> 标签：ruby-on-rails, ruby-on-rails-3, cancan

我一直在为这个问题烦恼一段时间。我有这样的组成员身份：

```
class User < ActiveRecord::Base
  has_many :memberships
  has_many :groups, :through => :memberships
end

class Membership < ActiveRecord::Base
  attr_accessible :is_owner
  belongs_to :user
  belongs_to :group
end

class Group < ActiveRecord::Base
  has_many :memberships
  has_many :users, :through => :memberships
  has_many :locations
end 
```

组也有许多位置，如下所示：

```
class Location < ActiveRecord::Base
  belongs_to :group
end 
```

我正在尝试创建一种功能，允许用户仅查看属于其组的位置（组所有权通过成员身份上的 is_owner 字段完成）。这是我一直在尝试的：

`can :read, Location, :group => { :memberships => { :user_id => user.id, :is_owner => true } }`

这给了我以下错误：

`SQLite3::SQLException: no such column: group.memberships`

有没有办法创造这种能力？我已经尝试了很多关于这种能力的变化，但都没有奏效。我不能使用块，因为我希望它能够执行索引操作。作为一种变通方法，我正在遍历所有位置并`select!`用来挑选那些我`can :read`......显然这不太理想。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T23:50:48.633

尝试直接使用 AR:Relation。我没有提到 cancan 如何接受 SQL 连接。

```
can :read, Location, Location.includes(:group => {:memberships = {}}).where(:group => { :memberships => { :user_id => user.id, :is_owner => true } }) 
```

或者：

```
can :read, Location, Location.includes(:group => {:memberships = {}}).where(["memberships.user_id = ? AND memberships.is_owner is ?", user.id, true]) do |location|
  location.group.memberships.exists?(:user_id => user.id, :is_owner => true)
end 
```

# asp.net - Fancybox 可以使用 httphandler 吗？

> ID：13850669
> 
> 赞同：0
> 
> 时间：2012-12-12T23:45:39.107
> 
> 标签：asp.net, fancybox, httphandler

当我不通过 h​​ttphandler 提供图像而直接在 HTML 中添加图像 URL 时，下面的代码有效。
当我通过 httphandler 加载图像时，控件中的基本图像正确显示，但是当我单击该图像以将较大的图像加载到灯箱中时，我看到了乱码（奇怪的字符）看到这个图像：

![在此处输入图像描述](../Images/c55891f188dceda11640706b026613ea.png)

所以我假设 Fancybox 需要一个图像的直接 URL 来填充灯箱，但我不确定。
如何确保当用户单击超链接时，fancybox 显示由 pichandler.ashx 提供的较大图像？

**HTML**

```
<script type="text/javascript" language="javascript">

$(document).ready(function () {
    $(".fancylink").click(function () {
        var cuRRent = $("a.advance-link img").attr("src");
        cuRRent = cuRRent.replace('largethumbs/', '');
        $.fancybox({
            'href': cuRRent,
            // other API options etc 
            'overlayColor': '#000',
            'opacity': true,
            'transitionIn': 'elastic',
            'transitionOut': 'none'
        }); //fancybox 
    }); //click 

    $("a.freemediaimage").fancybox({
        'transitionIn': 'elastic',
        'overlayColor': '#000',
        'opacity': true,
        'transitionOut': 'elastic',
        'speedIn': 600,
        'speedOut': 200,
        'overlayShow': true
    });

}); // ready 

</script>

<asp:HyperLink ID="hlMediaImage" CssClass="freemediaimage" runat="server">    
    <asp:Image ID="MediaImage" runat="server" />
</asp:HyperLink> 
```

**代码隐藏**

```
hlMediaImage.NavigateUrl = "~/pichandler.ashx?i=2&t=freemediadetails&s=2"  
MediaImage.ImageUrl = "~/pichandler.ashx?i=2&t=freemediadetails&s=1" 
```

**pichandler.ashx**

```
Public Sub ProcessRequest(ByVal context As HttpContext) Implements IHttpHandler.ProcessRequest
    Dim data As Byte()

    Dim i As Integer = CInt(context.Request.QueryString("i"))

    Dim type As String = context.Request.QueryString("t")

    Dim fName As String = String.Empty

    If i = 0 Then
        data = My.Computer.FileSystem.ReadAllBytes(context.Server.MapPath(String.Format("~/images/noimage_{0}.jpg", Threading.Thread.CurrentThread.CurrentCulture.TwoLetterISOLanguageName)))
    Else

        Select Case type
            Case "freemedia"
                Using w As New generaltablesTableAdapters.freemediaTableAdapter
                    fName = w.GetDataById(i)(0).medialink.ToString                                               
                End Using
                If fName = "" Or fName.Contains("soundcloud.com") Or fName.Contains("youtube.com") Then
                    data = My.Computer.FileSystem.ReadAllBytes(context.Server.MapPath(String.Format("~/images/noimage_{0}.jpg", Threading.Thread.CurrentThread.CurrentCulture.TwoLetterISOLanguageName)))
                Else
                    data = My.Computer.FileSystem.ReadAllBytes(context.Server.MapPath("~/images/freemedia/thumbs/" & fName))
                End If
            Case "freemediadetails"

                Dim searchquery As New StringBuilder
                searchquery.Append(ConfigurationManager.AppSettings("freemedia_solrUrl"))
                searchquery.Append("select/?indent=on&facet=true")
                searchquery.Append("&fq=id:""" + i.ToString + """")
                searchquery.Append("&fl=id,medialink,copyrighttext&q=*:*")
                searchquery.Append("&facet.mincount=1") 'dont show facets which have no value
                searchquery.Append(searchquery.ToString)

                Dim req As HttpWebRequest
                Dim Resp As HttpWebResponse
                Dim reader As StreamReader
                Dim responseString As String
                Dim XPath As String = "response/result"

                req = HttpWebRequest.Create(searchquery.ToString)
                Resp = req.GetResponse()
                reader = New StreamReader(Resp.GetResponseStream)
                responseString = reader.ReadToEnd()

                Dim objXML As New XmlDocument

                objXML.LoadXml(responseString)
                XPath = "response/result"

                Dim root As XmlNode = objXML.DocumentElement
                Dim nodeList As XmlNodeList = root.SelectNodes("descendant::doc")

                fName = nodeList(0).SelectSingleNode("str[@name=""medialink""]").InnerText
                Dim watermarkText As String = nodeList(0).SelectSingleNode("str[@name=""copyrighttext""]").InnerText

                Dim size As String = context.Request.QueryString("s")

                ' Create image directly from the path

                dim fpath as string
                If size = "1" Then
                    fpath = "~/images/freemedia/largethumbs/"
                ElseIf size = "2" Then
                    fpath = "~/images/freemedia/"
                End If

                Dim image = Drawing.Image.FromFile(context.Server.MapPath(fpath & fName))
                Dim font As New Font("Tahoma", 16, FontStyle.Regular, GraphicsUnit.Pixel)

                'Adds a transparent watermark 
                Dim color As Color = color.White 
                Dim brush As New SolidBrush(color)
                Dim gr As Graphics = Graphics.FromImage(image)

                ' Measure the watermark text so we can offset it's width and height
                Dim watermarkSize = gr.MeasureString(watermarkText, font)

                ' Create the point where the watermark text should be printed
                Dim point As New Point(image.Width - watermarkSize.Width, image.Height - watermarkSize.Height)

                gr.DrawString(watermarkText, font, brush, point)
                gr.Dispose()

                image.Save(context.Response.OutputStream, ImageFormat.Jpeg)

            Case Else 'its a general object
                Using w As New genobjectsTableAdapters.genobjects_photosTableAdapter
                    fName = w.GetPhotoById(i)(0).locpath.ToString
                End Using
                data = My.Computer.FileSystem.ReadAllBytes(context.Server.MapPath("~/images/objphotos/thumbs/" & fName))

        End Select
    End If

    context.Response.ContentType = "image/jpeg"

    If type <> "freemediadetails" Then
        context.Response.BinaryWrite(data)
    End If
End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T19:33:10.157

我假设您使用的是 fancybox v1.3.4，因为您的代码中有 API 选项，不是吗？

如果您以这种方式链接到图像：

```
/pichandler.ashx?i=2&t=freemediadetails&s=2 
```

...您的链接`href`没有任何图像扩展名（jpg、png、gif）。因此，fancybox 不知道`type`要处理什么内容。您需要强制将`type`内容添加到`image`您的 fancybox 自定义脚本中。这是记录在这里[http://fancybox.net/faq](http://fancybox.net/faq) , No. 6

然后你可以这样做：

```
$("a.freemediaimage").fancybox({
  // other API options
  "type": "image"
}); 
```

# ios - 添加自定义控件后滚动视图不起作用

> ID：13850672
> 
> 赞同：0
> 
> 时间：2012-12-12T23:45:48.297
> 
> 标签：ios, uiscrollview, custom-view, disabled-control

我正在开发一个应用程序，我单击一个按钮并在屏幕底部添加一堆控件（自定义视图）。我可以根据需要多次单击该按钮。所以我最终在底部添加了控件。我想向上滚动并计算我添加了多少。假设我打算添加自定义视图 5 次。我添加了 4.Scroll up 数我添加了多少。我添加了 4，所以向下滚动，再添加 1，然后向上滚动并保存/进行一些计算。但是添加自定义控件后我无法向上滚动。屏幕显示最近添加的自定义视图并停留在那里。我无法向上滚动查看我添加了多少次。我在做什么错。有什么想法吗？所以我第一次点击添加自定义视图，这段代码执行

```
ITMCustomView *customView = [[ITMCustomView alloc] initWithFrame:
    CGRectMake(187, 560, 400, 400)];
customView.delegate = self;
[self.scrollView addSubview:customView]; 
```

自定义视图本身有一个“添加更多”按钮。如果我单击它，则应执行上述操作，再次添加自定义控件。所以我在“添加更多”上这样做

```
[self.delegate addNewSize:CGRectMake(187,self.y+ 400 , 400, 400)]; 
```

我正在做的是传递必须创建新自定义视图的新位置。所以那个委托启动这个方法

```
- (void)addNewSize:(CGRect)frame
{
    ITMCustomView *cView = [[ITMCustomView alloc] initWithFrame:frame];
    cView.delegate =self;
    CGPoint scrollPoint = CGPointMake(0.0, (frame.origin.y/500)*400);
    [self.scrollView setContentOffset:scrollPoint animated:YES];

    [self.scrollView addSubview:cView];
} 
```

这实际上是我的问题的延续[在 iOS 中动态添加一堆控件到屏幕](https://stackoverflow.com/questions/13846736/add-a-bunch-of-controls-dynamically-to-screen-in-ios) 但我接受了答案（这是该问题的真实答案）并且因为它的扩展想要开始一个新问题。如果您需要更多信息，请询问。谢谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T05:31:49.253

您需要`setContentSize`在添加`ITMCustomView`. 像

`[self.scrollView setContentSize:CGSizeMake(320, 800)];`

每次`scrollView` `contentSize`添加`custom view`.

# php - 用 php-jquery 替换图像时出现问题

> ID：13850673
> 
> 赞同：2
> 
> 时间：2012-12-12T23:45:55.523
> 
> 标签：php, jquery

我制作了一些代码行以在每次单击后递归更改图像但不起作用。当我单击第一个拇指时，该代码仅显示目录的最后一个图像......知道为什么吗？这是注释的代码：

```
<?php
//DB connection
include ("conn.inc");
// parameter for DB query   
$rif_pippo = "id_pippo"; 
// DB query
$query = mysql_query("SELECT * FROM pippo WHERE rif_pippo ='$rif_pippo'"); 
$result = mysql_num_rows($query);
$row = mysql_fetch_assoc($query);
// div in wich there's IMG SRC to recursively change
echo "<div><img id='change_this'src='images/medium/".$row['rif_pippo']."/".$row['rif_pippo]."_medium01.jpg' alt='' /></div>";
// thumbnails list
echo "<ul>";
// count how many images there are in directory
$images = glob('images/pippo/medium/'.$row[rif_pippo].'/*.jpg');
$images_number= count($images);
// cicle to show all directory's thumbnails
for ($i=1; $i<=$images_number; $i++) {
// I change the images prefix adding a 0 for images betweeen 0 and 9
if ($i<=9) {$v='0'.$i;}
else if ($i>=10) {$v=$i;};
// JQUERY script 
echo "<script type='text/javascript'>";
echo "$('#id_box_foto').click(function() {";
echo "$('#change_this').attr('src','images/medium/".$row['rif_pippo']."/".$row['rif_pippo']."_medium".$v.".jpg').stop(true,true).hide().fadeIn('slow');";
echo "return false";
echo "});";
echo "</script>";

// thumbnail to change IMG SRC
echo "<li><a href='#id_box_foto' id='id_box_foto'><img class='foto' style='border:0px;' src='images/thumbnails/".$row['rif_pippo']."/".$row['rif_pippo']."_thumb".$v.".jpg' alt='' /></a></li>";
}

echo "</ul>";

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T00:01:04.127

The issue is that you are writing a jquery script for every image. When #id_box_foto is clicked all of these scripts run, the one that runs last is the last image.

To fix this you will probably want to write only one script with a list of the ids. When this is called it sets the image to be the next id in the list.

# c++ - free()：向量的无效指针 C++

> ID：13850678
> 
> 赞同：2
> 
> 时间：2012-12-12T23:46:41.163
> 
> 标签：c++, opencv, vector, free, ros

我的问题是 a`std:vector<vec4i> ( p_lines and filt_lines)`是在函数中创建的，不能在函数末尾释放。所以我在运行代码时遇到`free(): invalid pointer`错误。在某些情况下，我会出现分段错误错误，但我无法使用 gdb 跟踪源。该函数的目的是找到图片上的边缘和交叉点，在大多数线条相交的区域中，它会淹没一个矩形。图片来自 ROS 视频源。

```
void Probabilistic_Hough( Mat src, Mat &result )
{
    result=src;
    cvtColor( src, src, CV_RGB2GRAY );
    Canny( src, src, 50, 200, 3 );
    HoughLinesP( src, p_lines, 1, CV_PI/180, 85, 40, 10 );  
vector<Vec4i> filt_lines;
        int fls=filt_lines.size();
        int pls=p_lines.size();
if (!p_lines.empty()){
    for(size_t i = 0; i < p_lines.size();i++)
    {
        Vec4i l = p_lines[i];
        if ((l[0]<l[2]-10 ||  l[0]>l[2]+10) &&  (l[1]<l[3]-10 || l[1]>l[3]+10))
        {
            line( result/*probabilistic_hough*/, Point(l[0], l[1]), Point(l[2], l[3]), Scalar(255,0,0), 2);
            filt_lines.push_back(l);

        }

    }

    fls=filt_lines.size();
    pls=p_lines.size();
    printf("f=%d p=%d",fls,pls);
    if (filt_lines.size()>1 && !filt_lines.empty()) 
    {
        int sizeX=src.rows/11, sizeY=src.cols/11;
        int imgGrid[11][11];

        for (int i=0;i<11;i++)
        {
            for (int j=0;j<11;j++) imgGrid[i][j]=0;
        }

        for (size_t i = 0;i<filt_lines.size()-1;i++)
        {           
            Point2f o1 (filt_lines[i][0], filt_lines[i][1]) ;
            Point2f p1 (filt_lines[i][2], filt_lines[i][3]) ; 
            for (size_t j=i+1;j<filt_lines.size();j++)
            {
                Point2f o2 (filt_lines[j][0], filt_lines[j][1]) ;
                Point2f p2 (filt_lines[j][2], filt_lines[j][3]) ;
                Point2f x = o2 - o1;
                Point2f d1 = p1 - o1;
                Point2f d2 = p2 - o2;
                float cross = d1.x*d2.y - d1.y*d2.x;
                if (abs(cross) > 1e-8)
                {
                    double t1 = (x.x * d2.y - x.y * d2.x)/cross;
                    Point2f crosP  = o1 + d1 * t1;
                    if (crosP.x>0.0 && crosP.y>0.0 && crosP.y< src.rows && crosP.x<src.cols)
                    imgGrid[int(crosP.x/sizeX)][int(crosP.y/sizeY)]++;
                }
            }
        }
        int countP=0,maxi=0, maxj=0;
        for (int i=0;i<11;i++)
        {
            for (int j=0;j<11;j++)
            {

            if (countP<imgGrid[i][j])
                {
                    countP=imgGrid[i][j];
                    maxi=i;
                    maxj=j;
                }
            }
        }
        printf("c=%d \n",countP);
        if (countP>0)
        {
            Point vanishP1 = cvPoint(maxi*sizeX,maxj*sizeY), vanishP2 = cvPoint((maxi+1)*sizeX,(maxj+1)*sizeY);
            CvScalar red= CV_RGB(220,0,0);
            if (vanishP1.x>=0 && vanishP1.y>=0 && vanishP2.x>0 && vanishP2.y>0)             
            rectangle(src,vanishP1,vanishP2,red,2,8,0);     
            result=src;
        } else {printf("only 1 intersection, out of img"); }
    } else 
    {
    printf("No filtered lines");
    }

} else 
    {       
    printf("no lines on image");
    }

} 
```

我厌倦了用 gdb 调试，无效的指针地址是`p_lines`向量的起始地址。gdb 框架指向函数的 las }。如何解决 free(): invalid pointer 错误以及导致分段错误的问题。来自 gdb 的错误消息：

```
 glibc detected *** /home/xyz: free(): invalid pointer: 0x080cc482 ***
    ======= Backtrace: =========
    /lib/tls/i686/cmov/libc.so.6(+0x6b591)[0x12fe591]
    /lib/tls/i686/cmov/libc.so.6(+0x6cde8)[0x12ffde8]
    /lib/tls/i686/cmov/libc.so.6(cfree+0x6d)[0x1302ecd]
    /usr/lib/libstdc++.so.6(_ZdlPv+0x21)[0x11fa741]
    /home/xyz(_Z19Probabilistic_HoughN2cv3MatERS0_+0x8c5)[0x804b3b5]
    /home/xyz(_Z13imageCallbackRKN5boost10shared_ptrIKN11sensor_msgs6Image_ISaIvEEEEE+0x5c8)[0x804b9a0][0x804b3b5]
/home/xyz(_Z13imageCallbackRKN5boost10shared_ptrIKN11sensor_msgs6Image_ISaIvEEEEE+0x5c8)[0x804b9a0] 
```

p_lines 的打印是(_M_start = 0x80cc482 等于 free(): ip :0x080cc482):

```
(gdb) p p_lines
$1 = {<std::_Vector_base<cv::Vec<int, 4>, std::allocator<cv::Vec<int, 4> > >> = {
    _M_impl = {<std::allocator<cv::Vec<int, 4> >> = {<__gnu_cxx::new_allocator<cv::Vec<int, 4> >> = {<No data fields>}, <No data fields>}, _M_start = 0x80cc482, _M_finish = 0x80cc540, 
      _M_end_of_storage = 0x80cc540}}, <No data fields>} 
```

在纠正我的错字后我重新做了一些测试并`if (countP>0)`在最后添加了一个。找到出现无效指针操作的帧，img有12个p_lines和2个filt_lines，但是countP=0（所以两条线相交超出了img大小）。gdb 显示，在调用**_M_start = 0x80d4e70**的`HoughLinesP()`起始地址后，崩溃后出现在**0x080d4e71**和我的函数 gdb 框架中 p_lines 的起始地址为**_M_start = 0x80d4e71**。什么鬼？向量的起始地址怎么可能随**1**位而变化？`p_lines`**`free(): i.p.`**

 ******最后我找到了发生位变化的确切时刻`p_lines`：

```
(gdb) next
    98                      imgGrid[int(crosP.x/sizeX)][int(crosP.y/sizeY)]++;
    (gdb) p p_lines 
    $68 = {<std::_Vector_base<cv::Vec<int, 4>, std::allocator<cv::Vec<int, 4> > >> = {
        _M_impl = {<std::allocator<cv::Vec<int, 4> >> = {<__gnu_cxx::new_allocator<cv::Vec<int, 4> >> = {<No data fields>}, <No data fields>}, 
          _M_start = 0x80d4c78, _M_finish = 0x80d4d38, _M_end_of_storage = 0x80d4d38}}, <No data fields>}
    (gdb) next
    84              for (size_t j=i+1;j<filt_lines.size();j++)
    (gdb) p p_lines 
    $69 = {<std::_Vector_base<cv::Vec<int, 4>, std::allocator<cv::Vec<int, 4> > >> = {
        _M_impl = {<std::allocator<cv::Vec<int, 4> >> = {<__gnu_cxx::new_allocator<cv::Vec<int, 4> >> = {<No data fields>}, <No data fields>}, 
          _M_start = 0x80d4c79, _M_finish = 0x80d4d38, _M_end_of_storage = 0x80d4d38}}, <No data fields>}
(gdb) p j
$71 = 1 
```

所以在这种情况下，大小`filt_lines`为 2。并且**在检查第一行和第二行之后出现位移**`for`，并且当 j=1 和 j<2 时跳回。为什么？：/请帮助我，解决这个错误。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T00:47:34.503

`filt_lines`您在最内层循环中的向量上有索引溢出。我想应该是

```
 for (size_t j = i + 1; j < filt_lines.size(); j++) 
```

代替

```
 for (size_t j=i+1;j<p_lines.size();j++) 
```******

# ruby-on-rails-3 - 如何在 Heroku 上插入 schema_migration 记录

> ID：13850681
> 
> 赞同：0
> 
> 时间：2012-12-12T23:46:57.450
> 
> 标签：ruby-on-rails-3, heroku, schema-migration

我在本地成功解决了这个问题：

[我缺少迁移文件](https://stackoverflow.com/questions/13653494/i-am-missing-a-migration-file)

但我现在试图在 Heroku 上复制这一壮举，但不知道如何访问那里的数据库。谁能指导我完成整个过程？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T00:23:44.303

您可以打开 PSQL 会话并使用您在本地使用的相同 SQL：

```
heroku pg:psql [DATABASE] 
```

# java - 当同一调用“预期一次，从未调用”时，JMock“意外调用”

> ID：13850687
> 
> 赞同：3
> 
> 时间：2012-12-12T23:47:25.973
> 
> 标签：java, jmock

我在代码中的某处更改了一些不应该导致任何奇怪的测试失败的方法，但 JMock 似乎不这么认为。

我将问题归结为最少量的垃圾，看起来像这样：

```
import java.util.Collection;
import java.util.Collections;
import java.util.List;

import org.jmock.Expectations;
import org.jmock.Mockery;
import org.jmock.lib.legacy.ClassImposteriser;
import org.junit.Test;

public class TestMocking {

    @Test
    public void test() {
        Mockery mockery = new Mockery() {{
            setImposteriser(ClassImposteriser.INSTANCE);
        }};
        final Owner owner = mockery.mock(Owner.class);
        final RealThing thing = mockery.mock(RealThing.class, "thing");

        mockery.checking(new Expectations() {{
            oneOf(owner).getThing(); will(returnValue(thing));
            oneOf(thing).method(); will(returnValue(Collections.emptyList()));
        }});

        owner.getThing().method();

        mockery.assertIsSatisfied();
    }

    public static interface Owner {
        BaseThing getThing();
    }

    public static interface BaseThing {
        Collection<?> method();
    }

    public static interface RealThing extends BaseThing {
        List<?> method();
    }
} 
```

（**编辑：**即使不再有类，这现在也使用 ClassImposteriser，因为我想证明您可以在没有该冒名顶替者的情况下运行完全相同的代码并且测试将通过。）

运行结果：

```
unexpected invocation: thing.method()
expectations:
  expected once, already invoked 1 time: owner.getThing(); returns <thing>
  expected once, never invoked: thing.method(); returns <[]>
what happened before this:
  owner.getThing() 
```

所以你去了，当预期的thing.method() 从未被调用时，“意外的”thing.method() 。我之前已经看到当多线程类针对模拟对象进行测试时会发生这种情况，但这次它全部发生在单个线程中。就像 JMock 以某种方式从第一个方法调用返回了一个不同的模拟对象，即使我没有模拟这样的对象。

如果我删除了返回更具体类型的重写方法，那么它就会消失，但我显然不能这样做。同样，如果我删除 ClassImposteriser 的使用，问题就会消失，但我在真实测试中模拟的对象之一是其他人的类。我想我可以尝试在一个测试中使用两个 Mockery 实例，但除此之外我没有想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T00:01:33.083

隐藏类（静态）方法与覆盖实例方法的工作方式不同。为了证明 JMock 不是这里的罪魁祸首，试试这个：

```
public class test3 {
public static void main(String[] args) {
    Owner owner = new Owner();
    owner.getThing().method(); //Like how you execute your test
    RealThing thing = new RealThing();
    thing.method(); //Similar to your mock.
}

private static class Owner {
    private BaseThing thing = new RealThing();

    public BaseThing getThing() {
        return thing;
    }
}

private static class BaseThing {
    public static void method() {
        System.out.println("Basething!");
    }
}

private static class RealThing extends BaseThing {
    public static void method() {
        System.out.println("Realthing!");
    }
}
} 
```

请注意，这两个调用`method()`打印不同的东西！两者都是 RealThing 的实例，但它们调用不同的方法。调用的静态方法取决于是从子类调用还是从超类调用。在上面的第一个调用中，方法被声明为 BaseClass，因此`BaseClass.method()`被调用，即使它是 RealClass 的实例。第二个调用`method()`被声明为 RealClass，因此`RealClass.method()`被调用。

因此，JMock 的结果是有效的。`method()`被叫与您设定的期望不同。

不要对我对此的解释感到满意。请在这里阅读：http: [//docs.oracle.com/javase/tutorial/java/IandI/override.html](http://docs.oracle.com/javase/tutorial/java/IandI/override.html)

* * *

修复（赞成`BaseThing.method()`），更改：

```
final RealThing thing = mockery.mock(RealThing.class, "thing"); 
```

到：

```
final BaseThing thing = mockery.mock(RealThing.class, "thing"); 
```

或者，如果您更喜欢使用`RealThing.method()`，请更改：

```
owner.getThing().method() 
```

到：

```
RealThing thing = (RealThing)owner.getThing();
thing.method(); 
```

# javascript - 在 TypeScript 中使用箭头函数：如何使它们成为类方法？

> ID：13850689
> 
> 赞同：7
> 
> 时间：2012-12-12T23:47:31.143
> 
> 标签：javascript, jquery, lambda, typescript, arrow-functions

我的编程经验相当丰富，但对 TypeScript 还是很陌生。

尝试将它与 jQuery 一起使用并立即遇到回调的“this”问题（例如 $(document).ready.

使用 $.proxy() 是一种方法，但使用 TypeScript 的箭头 (lambda) 函数似乎要好得多。但我只看到它们用作表达式——即整个函数是内联定义的。我希望能够设置可以作为我的类的方法调用的箭头函数，例如（在伪代码中）：

```
class Something {
    constructor() {
    $(' nav li').click(this.menuClick);
    }
 private menuClick (and this would be an arrow function to preserve 'this')()=>    
  // it would call this.anotherMethod()
  // plus lots of other things so it won't easily fit inline

 private anotherMethod():void {
        // do something on the menu click, several lines perhaps, 
  }

} 
```

我来自 AS3 的 OOP 背景，这就是我能够做到这一点的方式——“this”很容易访问，或者很清楚如何访问它。我热衷于使用 TypeScript 来克服我在使用纯 Javascript 时遇到的 OOP 障碍——但是（对我而言）必须代理所有 jQuery 调用似乎很麻烦（我知道那里有一些类可以做到这一点）我，但是有没有更简单的方法，带有箭头/lambda函数？）。

如果我不理解显而易见的事情，请耐心等待，但这对我来说并不明显！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-13T00:01:07.933

The reason there isn't a way to do this by default is that it's a tremendous runtime cost in terms of per-instance memory consumption if done automatically. Rather than having one base prototype object with all the functions in it and each class instance pointing to that prototype for its function definitions, you end up having a closure per function for *every* instance of the class.

There might be better type system support for this in the future, but for now, dealing with `this` binding issues is just a tax you have to pay when writing JavaScript of any flavor. Hopefully as things like TypeScript gain momentum, library authors will reduce their usage of `this`-stomping (though the DOM will never have that luxury).

The upside is that in TypeScript, it's not a huge amount more code when you do need to re-re-bind `this`:

`$(' nav li').click(() => this.menuClick());`

or

`$(' nav li').click(this.menuClick.bind(this));`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T09:32:04.617

简短的回答：

如果你改变：`$(' nav li').click(this.menuClick);`

进入 ：`$(' nav li').click(() => this.menuClick());`

然后`this`将是`menuClick`方法中的类“某事”。

# php - Doctrine - 为 NOW() 等实体添加默认时间戳

> ID：13850693
> 
> 赞同：16
> 
> 时间：2012-12-12T23:48:11.950
> 
> 标签：php, postgresql, symfony, doctrine-orm, entities

遵循 Doctrine 指南，我了解如何为实体设置默认值，但如果我想要日期/时间戳怎么办？

*   [http://docs.doctrine-project.org/projects/doctrine-orm/en/2.1/reference/faq.html](http://docs.doctrine-project.org/projects/doctrine-orm/en/2.1/reference/faq.html)

我的问题是我的数据库在字段上默认为 NOW() 但是当我使用 Doctrine 插入记录时，值是 null 或空白，但插入的其余部分发生了。

此外，由于 Doctrine 说要将默认值声明为 const，这也会产生问题。

建议？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-12-14T14:28:36.333

好的，我找到了解决方案：

*   [https://doctrine-orm.readthedocs.org/en/latest/reference/php-mapping.html?highlight=callback](https://doctrine-orm.readthedocs.org/en/latest/reference/php-mapping.html?highlight=callback)
*   [http://doctrine-orm.readthedocs.org/en/latest/reference/events.html#lifecycle-events](http://doctrine-orm.readthedocs.org/en/latest/reference/events.html#lifecycle-events)

`prePersist`选项就是我正在做的事情。

确保在注释中定义

```
<?php

/** @Entity 
 *  @HasLifecycleCallbacks 
 */
class User 
```

这是他们提供的功能示例

```
/** 
 *  @PrePersist 
 */
public function doStuffOnPrePersist()
{
    $this->createdAt = date('Y-m-d H:i:s');
} 
```

如果你像我一样使用 ORM

```
<?php

/** @ORM\Entity 
 *  @ORM\HasLifecycleCallbacks 
 */
class User 
```

这是他们提供的功能示例

```
/** 
 *  @ORM\PrePersist 
 */
public function doStuffOnPrePersist()
{
    $this->createdAt = date('Y-m-d H:i:s');
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-08-06T22:30:31.443

根据我的经验，最好将所有内容都放在您的实体中，而不是试图强迫您的数据库绕过 ORM。

```
<?php
namespace Phill\PaffordBundle\Entity;
use Doctrine\ORM\Mapping as ORM;
/**
 * Stack
 * @ORM\Table()
 */
class Stack
{
  /**
   * @var integer
   * @ORM\Column(type="integer")
   * @ORM\Id
   * @ORM\GeneratedValue(strategy="AUTO")
   */
  private $id;

  /**
   * @var \DateTime
   * @ORM\Column(type="datetime")
   */
  private $startDate;

  public function __construct()
  {
    $this->startDate = new \DateTime();
  }

} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-04-01T06:52:41.340

为了准确地拥有`NOW()`你可以扩展`Doctrine\DBAL\Types\DateTimeType`.

其他方法：

```
class DateTimeNow
{
    public function format() 
    {
        return 'NOW()';
    }
} 
```

然后你可以使用`$entity->setFieldDatetime(DateTimeNow())`而不是`$entity->setFieldDatetime(new Datetime())`.
注意：该方法`format()`由 Doctrine 自动调用。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-11-16T16:12:08.477

试试这个：

```
/**
 * @var \DateTime
 *
 * @Column(name="created", type="datetime", nullable=false)
 */
private $created;

function __construct()
{
    $this->created = new \DateTime();
} 
```

`$value`您分配给字段的任何内容`created`都必须能够处理此调用：

```
$value->format('Y-m-d H:i:s'); 
```

请参阅[相关的 Doctrine 代码行](http://www.doctrine-project.org/api/dbal/2.5/source-class-Doctrine.DBAL.Types.DateTimeType.html#44)

经测试可与 Doctrine 2.5.4 一起使用

注意：以上在创建时有效，但默认情况下不在更新时有效——您必须在进行更新或查看时手动设置`created`属性`new \DateTime()``doStuffOnPrePersist`

```
/** @PrePersist */
public function doStuffOnPrePersist()
{
    $this->created = date('Y-m-d H:i:s');
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-06-25T20:16:57.370

您可以使用 TimestampableEntity Trait 在您的实体中自动创建 created_at 和 updated_at 字段；

首先安装学说扩展；

```
composer require gedmo/doctrine-extensions 
```

其次将特征添加到您的实体类中；

```
use Gedmo\Timestampable\Traits\TimestampableEntity;

    /**
     * @ORM\Entity(repositoryClass="App\Repository\ProjectRepository")
     */
    class Project
    {
        use TimestampableEntity; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-12T23:53:16.637

对于 PostgreSQL，您应该只能够传递`now`字段的字符串值以获取时间戳以发挥作用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-12-27T08:20:45.070

```
#[ORM\Column(type: 'datetime_immutable', options: ['default' => 'CURRENT_TIMESTAMP'])]
    private $createdAt;

    #[ORM\Column(type: 'datetime_immutable', options: ['default' => 'CURRENT_TIMESTAMP'], columnDefinition: "DATETIME on update CURRENT_TIMESTAMP")]
    private $modifiedAt; 
```

这是我发现的，我能够获得“ON UPDATE CURRENT_TIMESTAMP()”，但是该列变为可为空，在我看来这是一个更好的权衡。

# java - 如何将现有的 java Maven 模块添加到 Grails Maven 模块？

> ID：13850694
> 
> 赞同：3
> 
> 时间：2012-12-12T23:48:13.620
> 
> 标签：java, maven, grails, groovy, multi-module

我正在为一些 java 项目开发原型，直到现在我使用多模块 Maven 项目，根 pom 是另外 6 个 Maven 模块的父级。最初我计划用基于 Swing 的经典 GUI 制作一个独立的解决方案。

现在我决定制作一个 Web 应用程序并尝试 Grails。我搜索了很多并研究了一段时间，但无法弄清楚组织我的 Maven 项目的最简单方法是什么。现在我知道如何创建空的 Grails Maven 项目。但是我应该如何向它介绍我的其他 Maven 模块呢？我目前想出的是：

1.  创建新的 Grails Maven 模块，将其他模块的所有源代码放入其中的 src/java 目录，并将其他模块 pom 文件中的所有依赖项和插件复制到 Grails 的 pom.xml 文件中。
2.  创建空的 Grails 插件（每个现有 java 模块一个）并将 java Maven 模块的代码和依赖项迁移到 Grails 插件 pom 文件。
3.  设置自己的本地 Nexus 存储库。将 java 模块的工件放入其中并在 Grails 项目中重用它们。这种方式使 Grails 开发与其他在纯 java 上完成的业务逻辑开发分开。

由于显而易见的原因，我不喜欢所有这三种解决方案：

1.  我将失去模块化和重用当前 java 项目的单独模块的可能性。
2.  首先，过多的重构。其次，最终我将既没有​​良好的可重用 Maven 模块，也没有 Grails 插件（它只会看起来像一个）。
3.  我仍处于项目的早期原型设计阶段，我将不得不经常在 Grails 模块开发的同时更改 Java 模块。显然，等到我的 java 模块在单行更改后进入 Nexus 后才能在 Grails 中查看整个结果并不是很方便。

那么，我应该选择什么选项？其他的可能性是什么？我有这种感觉，好像我的问题有一个非常简单的答案，之后我会很惭愧。

这里可能相关的另一件事是：我目前使用 Jenkins 为我的 java 模块运行单元测试以及 cucumber-jvm 验收测试，并希望继续这样做；我使用 IntelliJ Idea 12 作为我的 IDE。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-20T09:46:36.373

答案原来很简单。我所要做的就是遵循：

使用根 pom 进入文件夹运行“grails create-app my-app-name” 使用新 grails 项目进入创建的文件夹并运行“grails create-pom my.group.id” 将根 pom 添加到 grail 生成的 grails pom.xml ' last command as parent 将我的其他 6 个 maven 模块作为依赖项添加到 grails 的 pom.xml 中。在我的根 pom 上运行“mvn clean install”后，我检查了为我的 Grails 模块生成的 .war 文件是否包含来自其他模块的所有必要 jar。

好吧，一切都变得如此简单。Maven 真的很棒，也许出现了这么长的问题，因为我只是没想到它会那么好。

# ruby-on-rails - 是否有可以跟踪独特错误的 Rails 库？

> ID：13850706
> 
> 赞同：3
> 
> 时间：2012-12-12T23:49:15.187
> 
> 标签：ruby-on-rails, exception-handling, sentry

Rails 有什么类似于[Sentry for Django 的](https://github.com/getsentry/sentry)吗？

我追求的主要功能是自动重复数据删除异常，因此电子邮件不会因相同的错误而重复。

这是 Sentry 的屏幕截图，用于直观地解释该功能：

![哨兵截图](../Images/19af6cf403750ddae66b4799bf50aa3f.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-13T00:47:40.270

一位同事将我带到了 Sentry 的 Ruby 客户端。即使服务器是 Django 服务器，我们仍然可以使用 Rails 向它报告。

它被称为 Raven-Ruby：[https ://github.com/getsentry/raven-ruby](https://github.com/getsentry/raven-ruby)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-12T23:51:15.117

Errbit 可以做到并且是免费的（也是自托管的）——https: [//github.com/errbit/errbit](https://github.com/errbit/errbit)

有几种商业产品，包括 Airbrake、exception.io，我敢肯定还有一些……

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-12T23:51:40.160

你看过 Airbrake.io 吗？

# magento - 如何在 magento 中将可下载产品的“链接可以单独购买”的默认值设置为 NO

> ID：13850707
> 
> 赞同：-1
> 
> 时间：2012-12-12T23:49:22.000
> 
> 标签：magento

嗨，伙计，我有一个 magento 网站，我的产品是可下载的，在添加新产品时，有一个“可下载信息”选项卡，在“链接”的手风琴中有一个字段“链接可以单独购买”

如何将默认值设置为 NO？

谢谢...

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-13T05:57:17.117

**我认为您可以在此处的eav_attribute**表中找到属性代码“links_purchased_separately”，您可以尝试将默认值设置为 0（零）表示否。

# html - 如何将视频一次上传到服务器并让它编码高质量、低质量和移动

> ID：13850709
> 
> 赞同：4
> 
> 时间：2012-12-12T23:49:24.947
> 
> 标签：html, video, drupal-7, h.264, encode

我想上传一个非常高质量（高清）的视频，并让它以较低的质量（对于较慢的连接）和移动兼容的质量自动呈现。

我目前正在使用运行良好的 Sublime Video HTML5 播放器在 Drupal 上进行设置。我不想做的是对每个视频进行 3 次编码并分别上传。

我愿意接受任何可以解决*一次上传、多次编码*问题的解决方案。如果这不“存在”，您能否提供一些关于如何在服务器端实现这一点的见解？

网络上的一个示例是当您将视频上传到 YouTube 时。它负责为每个设备进行编码，我想效仿。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T23:58:39.113

我不确定是否有一个实际的实现库可以处理这个问题，但您需要在后台进程中处理编码，否则您将绑定 Web 响应（以及未来的 Web 响应），直到所有编码完成。

在您探索解决方案时请记住这一点 :)

# ios - 如何在 iOS 中加载图像的一部分，而不将整个内容加载到内存中？

> ID：13850715
> 
> 赞同：1
> 
> 时间：2012-12-12T23:50:35.060
> 
> 标签：ios, ios6, alassetslibrary, alasset

我正在使用具有不同单元格大小的表格视图来保存图像。由于它的大小不同，我有时使用 ALAsset fullScreenImage 来获得比缓存缩略图更高的分辨率。但是，由于它是从磁盘加载一个相当大的图像，因此存在明显的延迟（而缩略图几乎是瞬间加载的）。

有没有办法从磁盘加载特定分辨率的图像或图像的一部分（例如左半部分或右半部分）？我认为整个东西都需要加载到内存中，因为它通常是压缩的 jpeg，但我想我会问，以防有什么我没有考虑过。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T23:57:28.733

这对于某些图像格式是可能的，但对于 jpeg 或 png 文件来说并非如此。您还必须自己编写它，因为在 iOS 中没有用于此的 API，但是，如果您唯一关心的是短暂的延迟，您可以将加载包装到异步 GCD 队列中并在高分辨率图像时使用缩略图加载。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T12:23:37.990

您可以像这样从 ALAssetsLibrary 读取原始 jpeg 数据：

```
ALAssetRepresentation *rep = [self defaultRepresentation];
uint8_t *buffer = (uint8_t *) malloc(rep.size);
NSUInteger buffered = [rep getBytes:buffer fromOffset:0.0 length:rep.size error:nil]; 
```

然后，您可以`libjpeg`只使用和解码您需要的矩形（四舍五入为 8 个像素）。请参阅实用程序的源代码以`jpegtran`供参考。

在stackoverflow上有一些关于`libjpeg`为iOS编译的线程。

希望这可以帮助。

# css - 仅将 CSS 图像灰度属性应用于父级

> ID：13850723
> 
> 赞同：1
> 
> 时间：2012-12-12T23:51:06.710
> 
> 标签：css, image, hover, grayscale

我正在使用 Twitter 引导程序，用于图片库：

```
<ul class="listing">
    <li class="listing-box row-fluid">
        <div class="span4">
            <img class="thumb_zoom" src="/images/Kh.jpg">
        </div>
        <div class="article span8">
            Random text
        </div>
    </li>
</ul> 
```

我对所有图像都使用了灰度效果，并且我想让颜色在悬停时出现`<li>`，所以我使用以下 CSS：

```
.thumb_zoom {
   filter: grayscale(100%);
   -webkit-filter: grayscale(100%);
   -moz-filter: grayscale(100%);
   -ms-filter: grayscale(100%);
   -o-filter: grayscale(100%);
}

.listing:hover .thumb_zoom {
   filter: grayscale(0%);
   -webkit-filter: grayscale(0%);
   -moz-filter: grayscale(0%);
   -ms-filter: grayscale(0%);
   -o-filter: grayscale(0%);
} 
```

它工作正常，但是当我将第一个悬停时，所有图像都会变成彩色`li`！我希望颜色出现在我悬停的相应图像上，`li`我做了一些研究，发现：

```
.listing:hover > .thumb_zoom { 
```

但它不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-12T23:53:32.710

第二个选择器应该是：

```
.listing-box:hover .thumb_zoom 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-12T23:54:10.647

尝试

```
.listing-box:hover .thumb_zoom { 
```

您目前正在将其应用于 UL，这就是它们都改变颜色的原因。

# html - Google Map v3 InfoBox 和 closeBox

> ID：13850726
> 
> 赞同：1
> 
> 时间：2012-12-12T23:51:27.917
> 
> 标签：html, css, google-maps

我目前有一个自定义的信息框，我使用 JScript 设置属性

```
var infoBoxOptions =  {
    content: infoContent
    ,disableAutoPan: false
    ,maxWidth: 0
    ,pixelOffset: new google.maps.Size(-140, 0)
    ,zIndex: null
    ,boxStyle: {
      background: "url('/files/0/11/tipbox.gif') no-repeat"
      ,width: "255px"
      ,padding:"9px"
     }        
    ,closeBoxURL: "/files/0/11/icon-close.gif"
    ,infoBoxClearance: new google.maps.Size(1, 1)
    ,isHidden: false
    ,pane: "floatPane"
    ,enableEventPropagation: false
  }; 
```

当我检查 HTML 时，BoxClose 图像如下

```
<img align="right" style=" position: relative; cursor: pointer; margin: 2px;" src="/files/0/11/icon-close.gif"> 
```

如何将位置设置为绝对位置并将顶部和右侧属性赋予关闭按钮？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-19T16:43:31.937

在这篇文章中，closeBoxMargin 似乎没有做任何事情。我通过使用这个来解决这个问题......

```
.infoBox img {
    top:15px;
} 
```

边距似乎不再起作用。希望这可以帮助某人。

* * *

要仅执行关闭框，请添加 > 选择器。

```
.infoBox > img {
    margin: 36px 10px 2px 2px !important;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-12T23:58:35.523

有一个名为 Close Box Margin 的属性，它允许您使用 CSS 边距定位关闭框。我不认为它增加了绝对位置，但它可以让你自由移动关闭框。

```
//Setting the options for the information window
var infoBoxOptions = {
    closeBoxURL: "/Content/images/TempImages/close.png",
    closeBoxMargin: "-10px -60px 10px 10px"
} 
```

这帮助我将关闭的盒子准确定位在我需要的位置。

# c# - 在 Prism 中，如何允许模块填充控件？

> ID：13850727
> 
> 赞同：0
> 
> 时间：2012-12-12T23:51:38.967
> 
> 标签：c#, wpf, prism, modularity

我知道我必须构建一个区域适配器，但我不知道从哪里开始。我想要的是让模块动态填充网格的能力。

例如，将其视为填充桌面空间的小部件。如果添加一个，那一个会占据整个区域，但随着添加的更多，它们会以网格状的方式分散。

我知道您可以为控件创建区域适配器，那么是否可以为列表视图或类似的东西构建一个区域适配器来容纳这些小部件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T15:37:11.050

找到了一个很好的资源，向我展示了我需要做什么 - [MSDN Custom Region Adapters](http://msdn.microsoft.com/en-us/library/ff921129%28v=pandp.20%29.aspx)

# richtextbox - 富文本框，无法设置richtextbox1.RTF

> ID：13850730
> 
> 赞同：0
> 
> 时间：2012-12-12T23:51:51.877
> 
> 标签：richtextbox, rtf, richtext

我正在尝试将richTextBox 的 RTF 属性设置如下：

```
this.richTextBox1.Rtf = @"{\rtf1\ansi\ansicpg1252\deff0\deflang5129{\fonttbl{\f0\fnil\fcharset0 Calibri;}}{\*\generator Msftedit 5.41.21.2510;}\viewkind4\uc1\pard\sa200\sl240\slmult1\lang9\f0\fs22{\pict\pngblip\picw685\pich109\picwgoal685\pichgoal109" + imagestring + @"}\pard\sa200\sl276\slmult1\par}";
var rts = this.richTextBox1.Rtf; 
```

当您调试 rts var 时，其中有一些不同的东西。

```
"{\\rtf1\\ansi\\ansicpg1252\\deff0\\deflang5129{\\fonttbl{\\f0\\fnil\\fcharset0 Microsoft Sans Serif;}}\r\n\\viewkind4\\uc1\\pard\\sa200\\sl240\\slmult1\\f0\\fs17\\par\r\n}\r\n" 
```

我假设这是为 RTB 设置的默认值。为什么我似乎无法设置此属性？RTB 是否可能验证富文本字符串？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-13T01:29:50.597

您可能没有正确输入格式。我建议将图像粘贴到富文本框中，然后检查其 RTF 属性以查看它应该如何。

# dotcloud - 在分支名称中使用“/”推送到 dotcloud

> ID：13850731
> 
> 赞同：0
> 
> 时间：2012-12-12T23:51:55.167
> 
> 标签：dotcloud

我一直在尝试使用以下方式推送到 dotcloud：

```
dotcloud push --git -b tim/feature-name 
```

但是，它说它无法找到分支“功能名称”

我最终通过创建一个没有正斜杠的分支并同时部署它来为我的部署创建一个解决方法。

有没有人对此有解决方案，或者我应该避免在 dotcloud 的分支名称中使用正斜杠？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T13:08:34.613

这可能是 dotcloud-cli 的错误，您应该在此处提交票证：[https ://github.com/dotcloud/dotcloud-cli](https://github.com/dotcloud/dotcloud-cli)

# c# - C# 异步方法使用

> ID：13850735
> 
> 赞同：1
> 
> 时间：2012-12-12T23:52:28.077
> 
> 标签：c#, c#-4.0, async-await

我正在尝试使用 Aync 方法。它在某种程度上起作用。但它在其他情况下不起作用。

工作示例

```
dropBox.DownloadFileAsync(csvEntry.Path)
                    .ContinueWith(task =>
                    {
                        // Save file to "C:\Spring Social.txt"
                        using (FileStream fileStream = new FileStream(tempCsvPath, FileMode.Create))
                        {
                            fileStream.Write(task.Result.Content, 0, task.Result.Content.Length);
                        }
                    }); 
```

我没有保存文件，而是尝试按以下方式返回字节数组。但它不起作用。它返回空值。

```
 byte[] returnArray = null;
                dropbox.DownloadFileAsync(filePath)
                        .ContinueWith(task =>
                        {
                            returnArray = new byte[task.Result.Content.Length];
                            task.Result.Content.CopyTo(returnArray, 0);
                        });
                return returnArray; 
```

有人可以纠正我吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-12T23:57:28.397

在这段代码中：

```
 byte[] returnArray = null;
            dropbox.DownloadFileAsync(filePath)
                    .ContinueWith(task =>
                    {
                        returnArray = new byte[task.Result.Content.Length];
                        task.Result.Content.CopyTo(returnArray, 0);
                    });
            return returnArray; 
```

DownloadFileAsync() 在线程上执行。当 ContinueWith() 被执行时，调用 DowloadFileAsync() 的函数已经返回。

你需要做这样的事情：

```
 Task<T> Download(string filePath)
     {             
            return dropbox.DownloadFileAsync(filePath)
                    .ContinueWith(task =>
                    {
                        returnArray = new byte[task.Result.Content.Length];
                        task.Result.Content.CopyTo(returnArray, 0);

                        return returnArray;
                    });
      } 
```

像这样称呼它：

```
 var task = Download("myfile");

     task.ContinueWith(t => 
      { 
           var returnArray = t.Result;
           ...

      } 
```

# build - 常春藤冲突解决不起作用

> ID：13850739
> 
> 赞同：3
> 
> 时间：2012-12-12T23:52:50.387
> 
> 标签：build, ivy, dependency-management, conflicting-libraries

我的模块 A 依赖于模块 B 和 C，它们都依赖于不同版本的模块 D。我的 Ivy 依赖项如下所示：

```
<ivy-module>
<info organisation="com.a" module="A"/>
<configurations defaultconf="runtime">
    <conf name="runtime"/>
</configurations>
<dependencies>    
    <dependency org="org.b" name="B" rev="2.0" conf="runtime->default" />    
    <dependency org="org.c" name="C" rev="2.4" conf="runtime->default" />
    <conflict org="org.d" module="D" rev="2.4"/>
</dependencies>
</ivy-module> 
```

我正在使用严格的冲突解决管理器，它正确地指出了冲突：

```
[ivy:retrieve] :: Apache Ivy 2.3.0-rc2 - 20121105223351 :: http://ant.apache.org/ivy/ ::
...
...
[ivy:retrieve] :::: ERRORS
[ivy:retrieve]  org.d#D;2.3 (needed by [org.c#C;2.4]) conflicts with org.d#D;2.4 (needed by [org.b#B;2.0]) 
```

为什么冲突标签不告诉 Ivy 使用模块 D 的 2.4 版本？我想使用严格的冲突解决方案，然后一次覆盖一个冲突，以便清楚我们在哪里冒着不使用另一个项目的 pom/ivy 中提到的依赖版本的风险。将 org.d 的排除添加到 org.c 依赖项可以消除冲突，但在我看来，使用冲突标签对文件的未来读者来说更清楚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-12-21T16:14:53.980

您也可以尝试为模块 D 设置*force*属性。这将强制 Ivy 在此示例中采用 2.4：

```
<dependency org="org.d" module="D" rev="2.4" conf="runtime->default" force="true" /> 
```

# php - 从 header-function 加载 php 变量

> ID：13850742
> 
> 赞同：0
> 
> 时间：2012-12-12T23:53:19.473
> 
> 标签：php, html, variables, header

我想为自己的语言制作文件夹。

作为一个例子，我有文件`foo.php`。该文件有英文版和荷兰文版。

因此，我创建了目录`/english/foo.php`，并且该目录`/dutch/foo.php`中的两个文件将与根文件夹中的文件完全相同。

在根文件夹中，`root/foo.php`我加载了一个`$var`来自另一个文件和目录的变量`root/scripts/bar.php`

在文件中，`root/scripts/bar.php`我确实使用了标头函数：

```
if ($pref_language == 'zu'){
    $header = 'english'.$_SERVER['PHP_SELF']; 
    $var = "xyz";  
}

header ("location: $header"); 
```

问题是，当我打开`root/foo.php`标题功能时，它应该正常工作，但`$var`不会在那个标题方向上初始化。什么时候我会开放源代码

```
<?php echo $var;?> 
```

但是当查看源代码而不带标题时，将加载变量。

所以这对我来说有点奇怪。如果有人可以帮助我，我真的很感激。

多谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T23:58:11.173

使用`header("location: $header");`将浏览器重定向到`$header`，这不是您想要的。

您可以`include($header);`（[在此处](http://ca3.php.net/manual/en/function.include.php)记录或更可能[在此处](http://ca3.php.net/require)`require`记录）然后允许文件使用定义的变量。`$header`

看起来您真正想做的是国际化，并且在 PHP 中有很好的工具可以做到这一点，例如 Twig（[这里](http://twig.sensiolabs.org/)）或 Smarty（[这里](http://www.smarty.net/)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T00:05:31.297

最好的办法可能是利用网络服务器中的重写规则将某些语言的 URL 请求定向到 php 文件可以使用的参数。Apache 中的示例可能如下所示：

```
RewriteEngine On
RewriteRule ^/?(english|dutch)/(.*)$ /$2?lang=$1 [L,QSA] 
```

例如，这将导致请求`/english/foo.php`被传递给`/foo.php?lang=english`处理。

然后，您可以查看`$_GET['lang']`以确定要使用的本地化。

这消除了进行任何浏览器重定向的需要，并为您提供了一种很好的方法来动态地将`$_GET['lang']`值添加到站点内的所有链接中，从而使最终用户看起来它们完全位于英语站点 ( `/english/*`) 或荷兰站点 ( `/dutch/*`）。

# clojure - Clojure - 映射所有级别

> ID：13850747
> 
> 赞同：1
> 
> 时间：2012-12-12T23:54:28.137
> 
> 标签：clojure

我正在尝试创建一个遍历每个元素并应用操作的映射函数。它就像一个`map`函数，但更深入。

该函数需要两个参数；一个函数，一个用于参数。

这是我到目前为止所拥有的：

```
(defn go-through
 [op & args]
   (if-not (sequential? (first args))
     (apply op args)
     (apply (partial map go-through op) args))) 
```

而且我知道最后一行是行不通的，即使没有调用它。但我不知道还有什么办法。

建议？

* * *

也许我限制了这种功能的用途。

样本：

```
user=> (go-through + 1 2)
3
user=> (go-through + [1 2] [3 4])
IllegalArgumentException Don't know how to create ISeq from: clojure.core$_PLUS_     clojure.lang.RT.seqFrom (RT.java:494) 
```

我期待`[4 6]`

这个想法适用于任何对单个元素而不是顺序操作的函数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T01:00:15.233

可能这是您的解决方案：

```
(defn go-through [op & args]
   (if-not (sequential? (first args))
     (apply op args)
     (apply map op args)))

(go-through + 1 2 3)
-> 6

(go-through + [1 2] [3 4] [5 6])
-> (9 12) 
```

版本 2（固定原始示例）

```
(defn go-through [op & args]
   (if-not (sequential? (first args))
     (apply op args)
     (apply map (partial go-through op) args)))

(go-through + [[1 2] [3 4]] [[5 6] [7 8]])
-> ((6 8) (10 12)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T00:19:14.993

请注意，您的第一行都不起作用，因为“if”条件只是检查第一个参数是否是顺序的，然后调用 op 将所有参数。

我建议使用[http://richhickey.github.com/clojure/clojure.walk-api.html](http://richhickey.github.com/clojure/clojure.walk-api.html)或查看它的代码；）

# django - Django 反向查找具体示例

> ID：13850760
> 
> 赞同：0
> 
> 时间：2012-12-12T23:55:20.743
> 
> 标签：django, django-models, reverse-lookup

我有两个模型类，`Person`如下`Relationship`所示，为简洁起见省略了字段：

```
class Person(models.Model):
    first_name = models.CharField(max_length=32, null=True)
    .
    .
    .
    relationship = models.ManyToManyField('Relationship', related_name='relative')

class Relationship(models.Model):
    person = models.ForeignKey('Person', related_name='relative', null=True) 
```

假设 A 是父亲，B 是女儿。我会按如下方式创建它们：

```
personA = Person()
personA.first_name = "Father"
personA.save()

personB = Person()
personB.first_name = "Daughter"
personB.save() 
```

那么它们之间的关系：

```
daughterRelationship = Relationship()
daughterRelationship.person = personB
daughterRelationship.save()
personA.relationship.add(daughterRelationship)

fatherRelationship = Relationship()
fatherRelationship.person = personA
fatherRelationship.save()
personB.relationship.add(fatherRelationship) 
```

现在，根据我的模型（可能是 related_name='relative' 导致了问题），但我似乎无法弄清楚我的反向查找名称。

我已经尝试过这些，但无济于事：

```
relationship = Relationship.objects.get(id=1)
personA = relationship.person
personB = relationship.relative_set.all().get() # Relationship does not have attribute 'relative_set'
personB = relationship.person_set.all().get() # Relationship does not have attribute 'person_set'
personB = relationship.relationship_set.all().get() # Relationship does not have attribute 'relationship_set'
personB = relationship.personrelationship_set.all().get() # Relationship does not have attribute 'personrelationship_set'
personB = relationship.personrealtive_set.all().get() # Relationship does not have attribute 'personrelative_set' 
```

我似乎无法得到它，其他人可以看到发生了什么，或者有什么建议吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T00:12:43.180

明白了，`related_name='relative'`正在创建反向查找`relative`而不是`relative_set`.

```
relationship = Relationship.objects.get(id=1)
personA = relationship.person
personB = relationship.relative.all().get() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T00:13:16.353

我认为这种情况更适合Person 与自身的[递归关系](https://docs.djangoproject.com/en/dev/ref/models/fields/#recursive-relationships)`Relationship`through 。

# php - MongoDB ODM 如何使用 map/reduce 按某个字段分组？

> ID：13850762
> 
> 赞同：1
> 
> 时间：2012-12-12T23:55:31.240
> 
> 标签：php, mongodb, mapreduce, doctrine, doctrine-odm

我有一个文档集合，我想通过某个名为 的字段进行查询，按字段`location`对它们进行排序，并且只返回每个字段`pos`的最大值。`pos`

所以现在的查询看起来像这样：

```
$locations = array(1,2,3,4,5,6);

   $results = $this->dm->createQueryBuilder('\App\Document\Test')
        ->select('id', 'word', 'pos','change', 'title', 'coll_at', 'location')
        ->field('location')->in($locations)
        ->sort('location', 'asc')
        ->sort('pos', 'asc')
        ->getQuery()->execute(); 
```

`location`但是因为对于每个具有不同的特定条目可以有多个条目`pos`，所以我必须创建一个 foreach 循环以在之后操作数据。在这种情况下，我可以采用这种捷径，只是在数据返回后更改数据，但在其他情况下，这样做根本没有效率。所以我创建了这个较小的场景来尝试找出如何使用 Doctrine ODM 的`group`查询，甚至映射和减少它。不确定最好的方法。我看到很多获得运行总数的例子，等等。

`pos`那么我将如何创建一个查询来获取每个特定字段中的最高数值`location`？知道可以有多个文档具有相同`location`但不同的`pos`值。最重要的是，拥有我在上面列出的所选记录的所有字段`->select()`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-13T08:27:07.057

您可以使用以下方式进行分组，而不是使用 Map Reduce 进行分组：

*   group() 或在 Doctrine 案例中`distinct`：[如何使用 MongoDB “分组”](https://stackoverflow.com/questions/3214406/how-to-group-by-with-mongodb)
*   聚合框架使用`$group`：[http ://docs.mongodb.org/manual/reference/aggregation/group/](http://docs.mongodb.org/manual/reference/aggregation/group/)

请注意，我相信 Doctrines distinct 的默认实现实际上适用于`group()`MongoDB 的旧命令，它基本上是一个 MR 包装但是：

> 那么我将如何创建一个查询来获取每个特定位置的 pos 字段中的最高数值

这可能有效，但是如果没有，那么您将需要使用聚合框架，但是在 Doctrine 中，这有点困难，因为他们似乎没有真正的助手可以链接到其框架的其余部分：[https：/ /github.com/doctrine/DoctrineMongoDBBundle/issues/165](https://github.com/doctrine/DoctrineMongoDBBundle/issues/165)所以你必须`command`运行它的函数。

### 编辑

我自己有点学说菜鸟，所以这取自示例：

```
$connection = $this->get('doctrine_mongodb')->getConnection();
$mongo = $connection->getMongo();
if(!$mongo){
    $connection->connect();
    $mongo = $connection->getMongo();
}
$db = $mongo->selectDB('test_database');
$aggregate_results = $db ->command(array( 
            "aggregate" => "my_collection",
            "pipeline" => 
                array( 
                    array( '$group' => array( 'location' => '$location', 'pos' => array('$sum' => '$pos'))),
                    array( '$sort' => array( "pos" =>1 ) )
                )
        )); 
```

这将为您运行聚合，它不会完全是您想要的我不认为但可以玩弄它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-29T10:02:11.960

除了Sammaye的回答。Doctrine ODM 确实支持组查询：

[http://doctrine-mongodb-odm.readthedocs.org/en/latest/reference/query-builder-api.html#group-queries](http://doctrine-mongodb-odm.readthedocs.org/en/latest/reference/query-builder-api.html#group-queries)

# sql - 需要关于两个表之间的 Oracle SQL SUM 聚合函数的建议

> ID：13850766
> 
> 赞同：1
> 
> 时间：2012-12-12T23:56:05.377
> 
> 标签：sql, oracle, aggregate

我在一个 Oracle 数据库中有两个表，我试图从中形成一个 SELECT 语句。第一个表称为“捐赠”，包含以下属性：donation_id、donation_date、donor_id、donation_type（类型有 2 个选项：'Incoming' 或 'Outgoing'）

第二个表，一个交集表，称为“donation_item”，具有以下属性：item_id、donation_id、location_id、weight

donation_type、item_id 和 weight 列是我特别感兴趣的。我的目标是使用聚合函数 (SUM) 来添加特定donation_type ('Incoming') 的某个 item_id 的权重，然后从中添加答案，减去“Outgoing”donation_type 项目的相同 item_id 的重量。

我尝试了几个查询，但都产生了错误。鉴于表格的当前结构，我不确定目标是否可行。尝试过的代码示例如下：

```
SELECT SUM(i.weight) - SUM(o.weight) AS "Total"
FROM donation_item i JOIN donation_item o
ON i.item_id = o.item_id JOIN donations d
ON i.donation_id = d.donation_id 
WHERE i.donation_type <> o.donation_type
AND i.donation_type = 'Incoming'; 
```

任何意见是极大的赞赏。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T05:53:39.930

听起来你想要这样的东西：

```
SELECT
    DONATION_ITEMS.ITEM_ID,
    SUM
    (
        CASE DONATIONS.DONATION_TYPE
            WHEN 'Incoming' THEN 1
            WHEN 'Outgoing' THEN -1
        END
        *
        DONATION_ITEMS.WEIGHT
    )
FROM
    DONATIONS
    INNER JOIN
    DONATION_ITEMS
    ON
    DONATIONS.DONATION_ID = DONATION_ITEMS.DONATION_ID
GROUP BY
    DONATION_ITEMS.ITEM_ID 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T23:57:43.077

我想你想要

```
sum(i.weight - o.weight) 
```

# bash - 简单的 6 行 bash 脚本 while 循环...出了什么问题？

> ID：13850770
> 
> 赞同：2
> 
> 时间：2012-12-12T23:56:21.403
> 
> 标签：bash, unix, loops, while-loop

我有一个 TSV 文件，如下所示：

```
input.tsv
Apple       Give me an iPad. 
Apple       I love MacBookPro!
Google      Buy the Nexus.
Google      Chromebooks are easy to use.
Microsoft   Surface is awesome. 
```

第一列是一个单词，第二列是一个句子。我只希望我的输出看起来像

```
apple.txt
Give me an iPad.
I love the MacBook Pro!

google.txt
Buy the Nexus.
Chromebooks are easy to use. 
```

这是我的脚本：

```
while read -r company sentence
do
    for line in $sentence
    do
        printf "$line\n" >> $company.txt
    done
done < input.tsv 
```

但是输出是每行标记一个单词，例如：

```
apple.txt
Give
me
an
iPad 
```

我不知道怎么了！！！任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T00:06:09.530

循环已经完成了整`while read`行，所以我不确定`for`循环的意图是什么。您正在遍历单词并每行输出一个。

此外，`printf`如果该行中有百分号或反斜杠，则您的行也不安全。

```
while read -r company sentence; do
  printf '%s\n' "$sentence" >>"$company.txt"
done < input.tsv 
```

此外，大多数 Unixy 文件系统都区分大小写（OS X 上的默认设置是一个明显的例外）；如所写，这将创建文件`Apple.txt`and`Google.txt`而不是`apple.txt`and `google.txt`。如果您想要小写文件名，则需要稍微更改该附加重定向的目标。

如果您使用的是 bash 4，则只需替换`"$company.txt"`为`"${company,,}.txt"`. 在较旧的 bash 版本中，您可以执行`>>"$(tr A-Z a-z <<<"$company").txt"`或类似操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T00:02:33.090

Drop the `for line in $sentence`? (make it even smaller!)

```
while read -r company sentence
do
    printf '%s\n' "$sentence" >> $company.txt
done < input.tsv 
```

# html - 如何更改列表中单个订单项的样式？

> ID：13850771
> 
> 赞同：1
> 
> 时间：2012-12-12T23:56:21.883
> 
> 标签：html, css, list

我确定这是一个简单答案的简单问题，但我没有太多使用 CSS 的经验，谷歌搜索只是引导我回答不同的 CSS/列表问题。所以任何建议将不胜感激。

具体来说，我想更改`id="ttm_nav_header_sale"`无序列表中单个项目 ( ) 的字体颜色。但我在级联样式方面遇到了麻烦。

HTML如下：

```
<div id="ttm_nav_header">
<ul>
    {% for link in linklists.main-menu.links %}
        {% if link.title == "Drums" or link.title == "Accessories" %}
            <li rel="nav_{{ link.title }}"><a href="{{ link.url }}">{{ link.title }}</a>&nbsp;&nbsp;&nbsp;/</li>
        {% elsif link.title == "Sale" %} 
            <li id="tmm_nav_header_sale" ><a href="{{ link.url }}">{{ link.title }}</a></li>
        {% else %}
            <li><a href="{{ link.url }}">{{ link.title }}</a>&nbsp;&nbsp;&nbsp;/</li>
        {% endif %}
    {% endfor %}
</ul> 
```

CSS：

```
#ttm_nav_header ul li a:link, #ttm_nav_header ul li a:visited, #ttm_nav_sub ul li a:link, #ttm_nav_sub ul li a:visited {
    text-decoration:none;
    color:#000;
}

#ttm_nav_header ul li a:hover, #ttm_nav_sub ul li a:hover {
    text-decoration:none;
    color:#229fdb;
}

/* !!! HERE */
#tmm_nav_header_sale {
    font-weight:bold;
    color: red;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T00:11:59.500

This is actually a specificity problem, i.e. the css classes you've defined earlier in your style sheet have taken precedence over the link you want to target with a different style.

Here's a better structure:

```
#ttm_nav_header a {
    text-decoration:none;
    color:#000;
}

#ttm_nav_header a:hover, #ttm_nav_sub a:hover {
    text-decoration:none;
    color:#229fdb;
}

/* !!! HERE */
#ttm_nav_header #tmm_nav_header_sale a {
    font-weight:bold;
    color: red;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T00:02:18.680

I assume you want to change the link colour in which case, you'll need to target the `a`

```
#ttm_nav_header ul li#tmm_nav_header_sale a {
    font-weight:bold;
    color: red;
} 
```

EDIT:

The specificity of the link needs to be greater than the preceding definitions so the above should work

[http://jsfiddle.net/w7Qn9/](http://jsfiddle.net/w7Qn9/)

# java - jsoup 从表中提取数据

> ID：13850775
> 
> 赞同：0
> 
> 时间：2012-12-12T23:56:40.417
> 
> 标签：java, jsoup

我有一个 html 文件，我需要使用 jsoup 从中提取部门名称。

```
Document doc = Jsoup.connect("http://directory.binghamton.edu/directory/directory.deptlist").get();
System.out.println(doc);
Elements departments = doc.select("deptlist");

for (Element department : departments) {
    System.out.println(department.text());
} 
```

我做过类似的事情，但它不起作用。

查看源：http://directory.binghamton.edu/directory/directory.deptlist

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T20:34:40.080

开始了！

```
Document doc = Jsoup.connect("http://directory.binghamton.edu/directory/directory.deptlist").get();

Elements departments = doc.select("table#deptlist a"); // Select all 'a' in a 'table'-tag with id 'deptlist'
String name;

for( Element element : departments ) // Iterate over all Elements available
{
    name = element.text(); // Save the plaintext (no html) of the element
    System.out.println(name); // Simple output (as an example)
} 
```

* * *

在您的代码中，您选择标签“deptlist”而不是表格。
如果您想选择所有元素`id=deptlist`（在我的示例中，您只选择具有该 ID 的表），您可以使用此选择器：`doc.select("#deptlist")`。

在此处查看更多信息：[JSoup 选择器 API](http://jsoup.org/cookbook/extracting-data/selector-syntax)

# javascript - 在 Javascript 中单击图像时出现问题

> ID：13850778
> 
> 赞同：1
> 
> 时间：2012-12-12T23:56:59.053
> 
> 标签：javascript

我正在使用 javascript 制作一个图片库，当我单击图片放大它时，它不会放大到页面的中心，而是完全放大到页面之外。如何让图像在放大时移动到中心？我的画廊在午夜到期，我似乎无法让它工作！我的教授暗示我需要让图像在放大时向上和向左移动。如果有人可以提供帮助，我将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T00:02:12.767

Without seeing the code I can only explain the concepts. You have to use both JS and CSS. Here is an example:

This the JS:

```
 $(document).ready(function(){
            if($(".myImage img").width() > $(".myImage").width()) {
                var url = $(".myImage img").prop("src");
                $(".myImage").css("background","url("+url+") no-repeat center center").empty();                
            }else{
                $(".myImage img").width($(".myImage").width()).height($(".myImage").height());
            }
        }); 
```

This is the HTML:

```
<div class="myImage">
        <img src="http://cdn.walyou.com/wp-content/uploads//2010/12/facebook-profile-picture-no-pic-avatar.jpg" width="350"/>
    </div> 
```

and finally the code in the CSS:

```
.myImage { border:1px solid #000; width:300px; height:300px; overflow:hidden; } 
```

# php - 以编程方式在 Drupal 中插入带有图像字段的内容

> ID：13850779
> 
> 赞同：0
> 
> 时间：2012-12-12T23:57:21.173
> 
> 标签：php, drupal, drupal-6, cck

我正在尝试编写 PHP 将大量内容插入我网站的 drupal 6 数据库。内容类型有 3 个自定义字段：

field_theme_preview_demo_link - 文本字段

field_theme_preview_content_styl - 文本选择器

field_theme_preview_thumb - 带有“alt”的图像字段

我只是手动将图像复制到正确的目录。

我创建了内容类型（并手动插入了一些内容以确认一切正常）。

然后我找到了一些用于以编程方式插入内容的代码示例......

[以编程方式/通过 API 创建 Drupal CCK 内容](https://stackoverflow.com/questions/772880/creating-drupal-cck-content-programatically-via-api)

和 [http://drupal.org/node/458778#comment-1653696](http://drupal.org/node/458778#comment-1653696) （对于这个我无法理解为 D6 建议的 mod）。

我尝试对其进行修改，但无法使其正常工作 - 它确实创建了新内容，但图像字段为空白。（要运行此代码，我只需将其粘贴到“执行 PHP 代码”块中。）

```
global $user;
$newnode = new stdClass();
$newnode->title = 'New node title';
$newnode->body = "the body";
$newnode->uid = $user->uid;
$newnode->type = 'theme_preview';
$newnode->status = 1;
$newnode->promote = 0;
$newnode->active = 1;

$newnode->field_theme_preview_demo_link[0]['value'] = 'the link';
$newnode->field_theme_preview_content_styl[0]['value'] = 'Books';

$newnode->field_theme_preview_thumb = array(
    array(
      'fid' => 'upload',
      'alt' => 'the alt',
      'filename' =>  'sites/default/files/theme_preview_thumbs/41531.jpg',
      'filepath' => 'sites/default/files/theme_preview_thumbs',
      'filesize' => filesize('sites/default/files/theme_preview_thumbs/41531.jpg'),
    ),
  );

node_save($newnode); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T01:52:11.773

将`fid`字段设置为“上传”是在实际上传文件时由节点的表单完成的。如果您以编程方式生成内容，则需要`fid`从其他地方获取内容。

您可能需要手动使用[文件 api](http://api.drupal.org/api/drupal/includes!file.inc/group/file/6)将文件系统上某处的文件输入文件数据库，然后`fid`从生成的对象中提取您的文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T09:48:15.943

使用[http://drupal.org/project/node_export](http://drupal.org/project/node_export)这个模块将内容导入或导出到特定的内容类型，它真的很适合我，而且图像会自动上传。

使用此模块必须考虑的一件事是，在导入节点后，请确保图像与其内容匹配。

使用此模块，我已将 100 篇新闻文章从我的本地服务器站点上传到我的网站。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T15:11:42.477

@Seth Battin，@ Ayesh K，感谢您的提示，工作代码...

```
global $user;
$newnode = new stdClass();
$newnode->title = 'New node title';
$newnode->body = "this is a new node, created by import function";
$newnode->uid = $user->uid;
$newnode->type = 'theme_preview';
$newnode->status = 1;
$newnode->promote = 0;
$newnode->active = 1;

$newnode->field_theme_preview_demo_link[0]['value'] = 'test 1';
$newnode->field_theme_preview_content_styl[0]['value'] = 'Books';

$field = field_file_save_file(
    'sites/default/files/srcImage1.jpg', 
    array(),
    'sites/default/files/theme_preview_thumbs');

if( !isset($field['data']) )  $field['data'] = array();
$field['data']['title'] = "the image title";
$field['data']['alt'] = "the image alt";

$newnode->field_theme_preview_thumb = array(0 => $field);
$newnode = node_submit($newnode);
node_save($newnode); 
```

# ruby-on-rails - 在活动资源请求中设置标头

> ID：13850784
> 
> 赞同：7
> 
> 时间：2012-12-12T23:57:36.013
> 
> 标签：ruby-on-rails, rest, activeresource

我有一个 Active Resource 模型，需要在通过 save 和 update_attributes 发布/放置之前设置一个标题。问题是每个用户的标头值需要不同，因此不能在模型级别设置。我已经看到将标头设置为 、 或自定义方法的一部分的示例`find`，`get`但无法将其添加到`@myclass.save`. 除了标题之外的东西`prefix_options`是理想的（`@myclass.prefix_options[:myvar] = 'abcd'`），但我还没有找到类似的东西。任何见解将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-02-08T17:16:27.520

我刚刚遇到了类似的问题并覆盖`.headers`了我的 ActiveResource 类。`ActiveResource::Base.headers`默认情况下只是一个哈希，但您可以将其覆盖为一个方法！<3 U 红宝石。

[http://rmosolgo.github.io/blog/2014/02/05/dynamically-generated-headers-for-activeresource-requests/](http://rmosolgo.github.io/blog/2014/02/05/dynamically-generated-headers-for-activeresource-requests/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T01:05:37.310

我刚刚签入了 3.2.8 的代码，好像不支持。我也看不到猴子修补它的太多机会。

[https://github.com/rails/rails/blob/c2193c11ad215d3a2d7d35960630b3e1902a5082/activeresource/lib/active_resource/base.rb#L1359](https://github.com/rails/rails/blob/c2193c11ad215d3a2d7d35960630b3e1902a5082/activeresource/lib/active_resource/base.rb#L1359)

不过，这将是一个很棒的补丁，尤其是现在 activeresource 已被拆分为 4.0 的自己的 gem。

**更新**

实际上，您可以使用原始发布请求指定标头。你只是不能用更抽象的方法来指定它们，比如`create`：

[https://github.com/rails/rails/blob/c2193c11ad215d3a2d7d35960630b3e1902a5082/activeresource/lib/active_resource/connection.rb#L97](https://github.com/rails/rails/blob/c2193c11ad215d3a2d7d35960630b3e1902a5082/activeresource/lib/active_resource/connection.rb#L97)

# ios - setText 时不能使用 Frame.origin

> ID：13850786
> 
> 赞同：4
> 
> 时间：2012-12-12T23:57:37.477
> 
> 标签：ios, objective-c

我正在使用下一个代码来淡出并向上滚动我的文本字段，但我只是注意到，当我使用类似的东西时，`[textField setText:@"something"];`或者`[textField resignFirstResponder];` 我失去了向上滚动。任何人都想解释为什么我会出现这种行为以及可能的解决方法。

```
[UIView animateWithDuration:0.5
                          delay:0.0
                        options:UIViewAnimationCurveEaseInOut
                     animations:^ {
                         CGRect Frame = textField.frame;
                         Frame.origin.y=100;
                         textField.frame=Frame;
                        textField.alpha = 0.0;                        
                     }
                     completion:^(BOOL finished) {
                         textField.hidden = YES;
                     }];
    [textField resignFirstResponder];    
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T15:20:23.050

您应该将`[textField resignFirstResponder];`放入完成块中。

# java - 尝试运行独立的 Java 6 程序时遇到问题，该程序打包在 war 文件中并部署在 tomcat 7 下

> ID：13850788
> 
> 赞同：1
> 
> 时间：2012-12-12T23:57:43.460
> 
> 标签：java, tomcat, classpath, war

问题是，当我通过 Eclipse Juno 通过单击它并“作为 Java 应用程序运行”运行它时，它可以工作，但它需要在 Linux shell 脚本中运行，或者至少从 Linux shell 运行。

我需要它将 $CATALINA_HOME/webapps/myapp/WEB-INF/lib 中的所有 jar 文件附加到我的类路径中。

这是我的代码：

```
package com.myapp.client;

public class ClientApp {
    public static void main(String args[]) {
        System.out.println("Hi Client");
    }
} 
```

当我 cd 进入 $CATALINA_HOME/webapps/myapp/WEB-INF/classes/com/myapp/client 发出以下命令：

```
java -classpath "/home/devuser/DevTools/apache-tomcat-7.0.32/webapps/myapp/WEB-INF/lib/*:." ClientApp 
```

我收到此异常：

```
Exception in thread "main" java.lang.NoClassDefFoundError: ClientApp (wrong name: com/myapp/client/ClientApp)
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClassCond(ClassLoader.java:631)
    at java.lang.ClassLoader.defineClass(ClassLoader.java:615)
    at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:141)
    at java.net.URLClassLoader.defineClass(URLClassLoader.java:283)
    at java.net.URLClassLoader.access$000(URLClassLoader.java:58)
    at java.net.URLClassLoader$1.run(URLClassLoader.java:197)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:247)
Could not find the main class: ClientApp.  Program will exit 
```

当我去我的主目录（/home/devuser）并输入这个时，它仍然不起作用：

```
java -classpath "/home/devuser/DevTools/apache-tomcat-7.0.32/webapps/myapp/WEB-INF/lib/*:." $CATALINA_HOME/webapps/myapp/WEB-INF/classes/com.myapp.ClientApp

Exception in thread "main" java.lang.NoClassDefFoundError: /home/devuser/DevTools/apache-tomcat-7/0/32/webapps/myapp/WEB-INF/classes/com/myapp/ClientApp
Caused by: java.lang.ClassNotFoundException: .home.devuser.DevTools.apache-tomcat-7.0.32.webapps.myapp.WEB-INF.classes.com.myapp.ClientApp
    at java.net.URLClassLoader$1.run(URLClassLoader.java:202)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:247)
Could not find the main class: /home/devuser/DevTools/apache-tomcat-7.0.32/webapps/myapp/WEB-INF/classes/com.myapp.ClientApp.  Program will exit. 
```

感谢您花时间阅读本文...如果有人可以帮助我，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T00:13:35.263

你所有的库和类都需要在你的类路径中，然后下一个参数是你的类的路径。

```
java -cp '.:/path/to/libdir/*:/path/to/myapp.war' com.myapp.client.ClientApp 
```

# python - 逐行读取文件

> ID：13850789
> 
> 赞同：1
> 
> 时间：2012-12-12T23:57:47.653
> 
> 标签：python

我正在尝试读取输入文件并匹配包含“ToolVersionEdit”的行，然后根据“=”拆分并获取第二部分..我正在使用以下内容..没有得到所需的输出..我在哪里出错了？输入和预期输出如下

输入：

```
[BuildRequest]
BuildRequestVersion=4.4.21
BuildRequestType=Phone
BuildCommandComboBox=common/build/build.sh tz:A8064AAAAANAAT140029.1 tz_bid=AAAAANAA wcnss:A8064AAAAANAAW120072.1 wcnss_bid=SCAQBAF lpass:A8064AAAAANAZL140106.1 boot_9x15:M9615ACETRMAAB12171.1 boot_9x15_bid=ACEHRMAA rpm:A8064AAAAANAAR1100153.1 rpm_bid=AAAAANAAR modem_9x15:M9615ACEFWTAAM4010223.1 modem_9x15_bid=ACEFWTAA apps_9x15:M9615AFEHRMAA2745.1 apps_9x15_bid=AFEHRMAA rpm_9x15:M9615ACETRMAAR1100159.4 rpm_9x15_bid=AAAAANAAR boot:A8064AAAAANAAB12171.1 boot_bid=AAAAANAA lpass_9x15:M9615ACETRMAZL140105.3 apps:A8064AAAAANLGA2214074.1 dsps:A8064AAAAANAAS150007.1 dsps_bid=DSPSBLD
ToolVersionEdit=1.6.21
CheckSumCheckBox=0
PurposeEdit=
[BuildRequestComments]
LineCount=0 
```

预期输出：-1.6.21

```
import re
import sys
file = "C:\Dropbox\Reference.brf"

lines = open(file ,'r').readlines()

for line in lines:
    if 'ToolVersionEdit' in line:
        line = line.strip('=')[1]

print line 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T00:00:22.857

您的问题是您正在覆盖`line`变量。您使用的变量与您尝试缓存的循环变量相同。此外，一旦你找到了你要找的东西，你就不需要继续循环了。

我所做的另一项更改是删除对`readlines`. 您可以直接从文件对象遍历所有行。此外，（可能）`file`用变量覆盖模块是一种不好的形式，所以我也重命名了那个。

```
import re
import sys
filename = "C:\Dropbox\Reference.brf"
try:
    input_file = open(filename ,'r')
except IOError as exc:
    print exc
else:
    cached_line = ""
    for line in input_file:
        if 'ToolVersionEdit' in line:
            cached_line = line.split('=')[1]
            break

    print cached_line 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T00:41:31.260

使用配置解析器。您的文件的构造是 unix 配置文件，并且 ConfigParser（python3 中的 configparser）可以读取并解析它[http://docs.python.org/2/library/configparser.html](http://docs.python.org/2/library/configparser.html)。

```
from ConfigParser import RawConfigParser as Parser

filename = 'yourfile.conf'

config = Parser()
config.read(filename)
print config.get('BuildRequest', 'ToolVersionEdit') 
```

如果您愿意，可以通过以下代码获得所有选项：

```
for section in config.sections():
    for option, value in config.items(section):
        print value 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-13T00:03:49.137

You need actually two things.

1.  Change `strip` to `split`
2.  `break` after you split it.

Resultant code looks like this,

```
 7  for line in lines:
 8      if 'ToolVersionEdit' in line:
 9          line = line.split('=')[1]
10          break 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-13T00:04:04.420

Try this:

```
 import re
    import sys
    file = "/tmp/abc.txt"

    lines = open(file ,'r').readlines()

    for line in lines:
        if 'ToolVersionEdit' in line:
            desired_line = line.split('=')[1] 
```

print desired_line

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-13T00:00:12.537

你想使用`split`而不是`strip`

# scala - `Deadline`结束时的scala 2.10回调

> ID：13850794
> 
> 赞同：1
> 
> 时间：2012-12-12T23:58:20.440
> 
> 标签：scala, scala-2.10

在 Scala 2.10 中，与新的`Future`/ `Promise`API 一起，他们引入了 a`Duration`和`Deadline`实用程序（[如此处所述](http://docs.scala-lang.org/sips/pending/futures-promises.html#utilities)）。我环顾四周，但找不到 scala 标准库附带的任何东西，比如：

```
val deadline = 5 seconds fromNow
After(deadline){
  //do stuff
}

//or

val deadlineFuture: Future[Nothing] = (5 seconds fromNow).asFuture
deadlineFuture onComplete {
  //do stuff
} 
```

有没有类似的东西我错过了，还是我必须自己实施这种行为？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T03:02:20.150

不是很内置，但它们提供了足够的绳索。

要点是等待一个必须令人失望的空头承诺（即超时）。

```
import scala.concurrent._
import scala.concurrent.duration._
import scala.util._
import ExecutionContext.Implicits.global

object Test extends App {
  val v = new SyncVar[Boolean]()
  val deadline = 5 seconds fromNow
  future(Await.ready(Promise().future, deadline.timeLeft)) onComplete { _ =>
    println("Bye, now.")
    v.put(true)
  }
  v.take()
  // or
  val w = new SyncVar[Boolean]()
  val dropdeadline = 5 seconds fromNow
  val p = Promise[Boolean]()
  p.future onComplete {_ =>
    println("Bye, now.")
    w.put(true)
  }
  Try(Await.ready(Promise().future, dropdeadline.timeLeft))
  p trySuccess true
  w.take()
  // rolling it
  implicit class Expiry(val d: Deadline) extends AnyVal {
    def expiring(f: =>Unit) {
      future(Await.ready(Promise().future, d.timeLeft)) onComplete { _ =>
        f
      }
    }
  }
  val x = new SyncVar[Boolean]()
  5 seconds fromNow expiring {
    println("That's all, folks.")
    x.put(true)
  }
  x.take() // wait for it
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T01:44:35.330

它只是一个时间戳持有者。例如，您需要在 T 小时内分发 N 个顺序任务的执行。完成第一个任务后，您可以检查截止日期并根据（剩余时间）/（剩余任务）间隔安排下一个任务。在某个时间点`isOverdue()`发生，您只需并行执行剩下的任务。

或者您可以检查`isOverdue()`，如果仍然为假，则`timeLeft()`用于设置执行下一个任务的超时，例如。

`Date`这比使用和`Calendar`确定剩余时间要好得多。Duration 在 Akka 中也用于计时。

# java - 努力正确格式化字符串

> ID：13850795
> 
> 赞同：1
> 
> 时间：2012-12-12T23:58:27.633
> 
> 标签：java, string, api, format

```
for(Item i : itemArray){
System.out.format("%1s%50s%50s", "name = " + i.getName(), "color = " + i.getColor(), "quantity = " + i.getQuantity());
System.out.println(); 
```

我试图迭代一个项目数组，打印出格式化表格中的每个项目。每件商品都有名称、颜色、数量和价格。

以下是它目前的结果：

```
Name: bike       Color: black       Quantity: 1      Price: 6.00
Name: ladder       Color: blue       Quantity: 150      Price: 9.00
Name: dolphin       Color: orange       Quantity: 15      Price: 100000.00
Name: key       Color: red       Quantity: 12      Price: 510.00 
```

这是我需要的样子：

```
Name: bike       Color: black      Quantity: 1       Price: 6.00
Name: ladder     Color: blue       Quantity: 150     Price: 9.00
Name: dolphin    Color: orange     Quantity: 15      Price: 100000.00
Name: key        Color: red        Quantity: 12      Price: 510.00 
```

我已经阅读了格式api，但仍然无法弄清楚！请帮忙。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T00:05:28.710

`%1s`您的格式字符串应为 Name: 参数指定多个字符宽度 ( )：

```
System.out.format("%15s%50s%50s", "name = " + i.getName(), "color = " + i.getColor(), "quantity = " + i.getQuantity()); 
```

更具可读性的是仅将变量注入格式字符串：

```
System.out.format("Name: %-10s  Color: %-10s Quantity: %-10s Price: %s", ...) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T00:41:50.423

试试看

```
 String fmt = "Name: %-10s Color: %-10s Quantity: %d%n";
        System.out.printf(fmt, "bike", "black", 1);
        System.out.printf(fmt, "ladder", "blue", 1); 
```

输出

```
Name: bike       Color: black      Quantity: 1
Name: ladder     Color: blue       Quantity: 1 
```

# javascript - 取消绑定元素并在动画停止后重新添加

> ID：13850799
> 
> 赞同：0
> 
> 时间：2012-12-12T23:59:02.950
> 
> 标签：javascript, jquery

我正在尝试`unbind`一个元素，然后`bind`在页面滚动动画完成后返回：

```
$(".trigger").click(function(){
  $(".class1 a, .class2 a").unbind();
  $('html, body').stop().animate({scrollTop: $('#container').offset().top}, 1000);
  $(".class1 a, .class2 a").bind();
}); 
```

`.class1 a`然而，`.class2 a`永远不会被束缚？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T00:05:11.777

如果要在动画后绑定事件处理程序，则必须使用回调函数。您还必须传递事件类型和回调来重新绑定处理程序

```
$(".trigger").click(function(){
  $(".class1 a, .class2 a").unbind();
  $('html, body').stop().animate({scrollTop: $('#container').offset().top}, 1000, function(){
      $(".class1 a, .class2 a").bind('sometype', somefunction);          
  });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T00:00:23.487

当你`bind`解除绑定后的事件时，它没有任何信息`previous handler.`

所以你需要分配处理程序`every time you bind the event`。

```
$(".class1 a, .class2 a").bind(handler); 
```

* * *

```
$(".trigger").click(function(){
  $(".class1 a, .class2 a").unbind();
  $('html, body').stop()
                 .animate({scrollTop: $('#container')
                 .offset().top}, 1000);
  $(".class1 a, .class2 a").bind(handler);
});

function handler(e){
   alert('Hey !!');
} 
```

也使用`.on() /.off()` 代替，`.bind()/.unbind()`因为前者已被后者取代..

```
 $(".trigger").on('click', function(){
      $(".class1 a, .class2 a").off('click');
      $('html, body').stop()
                     .animate({scrollTop: $('#container')
                     .offset().top}, 1000);
      $(".class1 a, .class2 a").on('click' , handler);
    });

    function handler(e){
       alert('Hey !!');
    } 
```

# python - 如何将函数延迟 X 个刻度？

> ID：13850804
> 
> 赞同：2
> 
> 时间：2012-12-12T23:59:29.627
> 
> 标签：python, function, delay

好的，所以我有一个在按下键时调用的钩子，例如空格键。我想做的是，当这种情况发生时，我想调用一个函数。下一个刻度，我想调用一个不同的函数。

```
import pygame

def func1():
    do_things
def func2():
    do_other_things

while True:
    for event in pygame.event.get():
        if event.type == pygame.K_SPACE:
            func1()
            #wait(1, func2) 
```

显然 #wait 被替换为但是可能会延迟 1 个滴答声。

有没有办法做到这一点？我猜它要么是我错过的基本功能，要么是非常复杂的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-18T15:24:44.760

使用变量来标记是否`func2`在时机成熟时调用：

```
shouldDoFunc2 = false
while True:
    if shouldDoFunc2:
        func2()
        shouldDoFunc= false
    for event in pygame.event.get():
        if event.type == pygame.K_SPACE:
            func1()
            shouldDoFunc2() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T00:05:02.197

```
func2timer = -1
while True:
    if func2timer >= 0:
        func2timer -= 1
    if func2timer == 0:
        func2()
    for event in pygame.event.get():
        if event.type == pygame.K_SPACE:
            func1()
            func2timer = 1 
```

（如果您想等待更多滴答声，您可以将计时器调整为大于 1）

# php - jQuery 使用 Ajax 淡入和淡出图像

> ID：13850808
> 
> 赞同：1
> 
> 时间：2012-12-13T00:00:02.193
> 
> 标签：php, jquery, html

我有一个简单的工作要做。我有一系列缩略图和一张主要图片。

[http://activate5.info/index.php#portfolio](http://activate5.info/index.php#portfolio)

单击缩略图后，我需要执行 ajax 调用来查找一个数组，该数组返回一个新的图像和文本信息。然后我需要淡出主画面，并将其替换为来自 ajax 调用的新信息。

它正在工作，但它很生涩。正在发生的事情（我认为）是淡出是平滑的，但淡入是因为图像是页面的新内容，所以它以一种不平稳的方式显示，就像图片通常加载到页面上一样。

我希望它平滑 - 所以理想情况下，在图像完全加载之前，我需要某种警报/触发器，然后再将图像淡入。我相信这是一个简单的答案 - 但希望能得到帮助。

我已经把淡出/淡入淡出的东西放在ajax调用的“成功”部分......

```
$.ajax({
 url: 'resources/portfolio/ajax_portfolio_data.php',
 data: { client: clientCode,
          slide: slideNumber
       },
 success: function(data) {
      $('#slide'+slideNumber+'_portfolio').fadeOut('slow',function(){
         $('#slide'+slideNumber+'_portfolio').html($.parseJSON(data));
         $('#slide'+slideNumber+'_portfolio').fadeIn('slow');
      }); 
  }
}); 
```

我真的不想预加载所有可用的图像，因为这会使已经很大的页面更慢 - 任何人都有更好的方法来做到这一点？

（数据）的 PHP 文件返回的示例如下：

```
$html = "<div class='slideMainImage'><img src='" 
   . $portfolio[$slide][$client]['image'] . "' /></div>";
$html .= "<p>" . $portfolio[$slide][$client]['text'] . "</p>";
echo json_encode($html); 
```

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T00:04:50.527

您可以在 ajax 上添加图像`success`、隐藏它并附加一个[onload 事件处理程序](http://api.jquery.com/load-event/)。加载后，您将执行当前在`success`.

请注意，这样效果可能更平滑，但整体过程较慢，因为效果仅在图像完全加载时才开始。

# linux - 设置 /bin/sh 以外的 Linux shell 是否有问题？

> ID：13850812
> 
> 赞同：3
> 
> 时间：2012-12-13T00:00:56.343
> 
> 标签：linux, bash, shell, sh, dash-shell

我的公司开始增加对 Linux 的支持，并且我们的一些 shell 脚本开始变得更加复杂。今天我们使用shebang作为

```
#! /bin/sh 
```

但是我们遇到了一些发行版（例如 Ubuntu）的问题，例如其中 sh 指向 dash 和一些更奇特的。

我的问题是，例如将 shebang 更改为 bash 有什么风险？也许更好的问题是这些天是否可以有一个没有 bash 的发行版？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-13T00:07:17.533

最好更改它，如果您依赖 bash 特定语法，那么您的 shell 脚本需要声明它需要 bash 而不是通用 shell。

```
#! /usr/bin/env bash 
```

通常首选

```
#! /bin/bash 
```

因为它允许系统以非标准方式/位置安装 bash

回答您的第二个问题：“这些天是否可以有一个没有 bash 的发行版”。嗯，当然有*可能*，但可能性极小。来自 bash 维护者的[网站](http://tiswww.case.edu/php/chet/bash/bashtop.html#Availability)——bash 4.x 在 GNU/Linux 和 Mac OSX 上是标准的，在 Windows 上，Cygwin 和 MinGW 都附带 bash 3.x。有用于 BSD 的端口，并且 Solaris 自 8+ 以来就提供了 bash 版本，其中 10 个随 bash 4.x 一起提供。

这似乎表明你会非常不幸地找到没有 bash 的 GNU/Linux 操作系统。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-13T04:55:49.480

我想你问错问题了。更好的问题是：“`#!/bin/sh`用于使用非可移植 shell 语法（又名 bashisms）的脚本有多糟糕”。答案是：“真的很糟糕”。修复你的shebangs。如果你写`#!/bin/sh`但写一个`bash`脚本，你就是在自找麻烦。别再把`dash`它想象成异国情调了，你会写出更可移植的代码。简而言之，修复你的shebangs一点也不坏，不这样做是非常糟糕的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-13T00:02:40.547

没有比将其更改为 PHP 更大的风险。或者到 Perl。或者到 Python。使用任何你喜欢的口译员。

# java - android sqlite, close() was nevere explicitly called

> ID：13850813
> 
> 赞同：-2
> 
> 时间：2012-12-13T00:00:59.440
> 
> 标签：java, android, sqlite

/i am writing probgram that should take xml file and parse it to database. Database worked witohut crashes, but with close() error, before i tried to implement update function, after that program alwayes crashes.

i decided to use update to prevent dublication and update records ^_^ (is there better way?)

bedies i have only one activity, using clothing database onDestroy does not help. And appiared Fatal exeption ( full logcat in the bottom)

> Unable to start activity ComponentInfo{com.s1042512.electionvoter/com.s1042512.electionvoter.MainActivity}: android.database.CursorIndexOutOfBoundsException: Index 0 requested, with a size of 0

main class

```
import java.util.List;

import org.w3c.dom.Document;
import org.w3c.dom.Element;
import org.w3c.dom.NodeList;

import com.s1042512.electionvoter.ImageLoader;
import com.s1042512.electionvoter.XMLParser;
import com.s1042512.electionvoter.Candidate;
import com.s1042512.electionvoter.DatabaseHandler;
import com.s1042512.electionvoter.R;

import android.os.Bundle;
import android.app.Activity;
import android.util.Log;
import android.widget.ImageView;

public class MainActivity extends Activity {

    static final String URL = "http://www.inf.ed.ac.uk/teaching/courses/selp/elections/election.xml";
    // XML node keys
    static final String KEY_CANDIDATE = "candidate"; // parent node
    static final String KEY_PHOTO = "photograph";
    static final String KEY_NAME = "name";
    static final String KEY_OFFICE = "office";
    static final String KEY_PROMISES = "promise";
    static final String KEY_STAT = "statement";
    private DatabaseHandler db;
    public void onDestroy(){
            db.close();
        super.onDestroy();

    }
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        db = new DatabaseHandler(this);

        Candidate test = new Candidate("Test", "Test's office", "Test's photo", "Test's promises", "Test's statement", 1,5);
        db.addCandidate(test);

        XMLParser parser = new XMLParser();
        String xml = parser.getXmlFromUrl(URL); // getting XML
        Document doc = parser.getDomElement(xml); // getting DOM element

        NodeList nl = doc.getElementsByTagName(KEY_CANDIDATE);

        for (int i = 0; i < nl.getLength(); i++) {  
            Element e = (Element) nl.item(i);
            NodeList prm = null;
            String prom = "";
            prm = doc.getElementsByTagName("promise");

            if (db.getCandidatesCount() != 0) {
                List<Candidate> clist = db.getAllCandidates();

                boolean checkname = clist.contains(db.getCandidate(parser
                        .getValue(e, KEY_NAME)));

                for (int j = 0; j < prm.getLength(); j++) {
                    prom += parser.getValue(e, KEY_PROMISES, j) + "\n";
                }
                if (!checkname) {
                    Log.d("Insert: ", "Inserting ..");
                    db.addCandidate(new Candidate(parser.getValue(e, KEY_NAME),
                            parser.getValue(e, KEY_OFFICE), parser.getValue(e,
                                    KEY_PHOTO), prom, parser.getValue(e,
                                    KEY_STAT)));
                } else {
                    Log.d("Update: ", "Updating candidate ");
                    Candidate cand = db.getCandidate(parser.getValue(e,
                            KEY_NAME));
                    Candidate update_cand = new Candidate(parser.getValue(e,
                            KEY_NAME), parser.getValue(e, KEY_OFFICE),
                            parser.getValue(e, KEY_PHOTO), prom,
                            parser.getValue(e, KEY_STAT), cand.get_active(),
                            cand.get_ranking());
                    db.updateCandidate(update_cand);
                }
            }
            else{
                Log.d("Insert: ", "Inserting ..");
                db.addCandidate(new Candidate(parser.getValue(e, KEY_NAME),
                        parser.getValue(e, KEY_OFFICE), parser.getValue(e,
                                KEY_PHOTO), prom, parser.getValue(e,
                                KEY_STAT)));
            }

        }
        Log.d("Reading: ", "Reading all candidates..");
        List<Candidate> candidates = db.getAllCandidates();       

        for (Candidate cn : candidates) {
            String log = "Name: "+cn.get_name()+" ,Office: " + cn.get_office() + " , Photo: " + cn.get_photograph()
                    + " , Promisses: " + cn.get_promises()+ " , Statment: " + cn.get_statment();
                // Writing Candidates to log
        Log.d("Name: ", log);

        }

    }

} 
```

helper class

```
public class DatabaseHandler extends SQLiteOpenHelper {
    // All Static variables
    // Database Version
    private static final int DATABASE_VERSION = 1;

    // Database Name
    private static final String DATABASE_NAME = "ElectionCandidates";

    // Candidates table name
    private static final String TABLE_CANDIDATES = "candidates";

    // Candidates Table Columns names
    private static final String KEY_NAME = "name";
    private static final String KEY_OFFICE = "office";
    private static final String KEY_PHOTO = "photograph";
    private static final String KEY_PROMISSES = "promisses";
    private static final String KEY_STATMENT = "statment";
    private static final String KEY_ACTIVE = "active";
    private static final String KEY_RANKING = "ranking";
    private SQLiteDatabase db;
    private Cursor cursor;

    public DatabaseHandler(Context context) {
        super(context, DATABASE_NAME, null, DATABASE_VERSION);

    }

    @Override
    public void onCreate(SQLiteDatabase db) {
        String CREATE_CANDIDATES_TABLE = "CREATE TABLE " + TABLE_CANDIDATES
                + "(" + KEY_NAME + " TEXT," + KEY_OFFICE + " TEXT," + KEY_PHOTO
                + " TEXT," + KEY_PROMISSES + " TEXT," + KEY_STATMENT + " TEXT,"
                + KEY_ACTIVE + " TEXT," + KEY_RANKING + " TEXT" + ")";
        db.execSQL(CREATE_CANDIDATES_TABLE);
    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        // Drop older table if existed
        db.execSQL("DROP TABLE IF EXISTS " + TABLE_CANDIDATES);

        // Create tables again
        onCreate(db);
    }

    void addCandidate(Candidate candidate) {
        db = this.getWritableDatabase();

        ContentValues values = new ContentValues();
        values.put(KEY_NAME, candidate.get_name()); // Candidate Name
        values.put(KEY_OFFICE, candidate.get_office()); // Candidate Phone
        values.put(KEY_PHOTO, candidate.get_photograph());
        values.put(KEY_PROMISSES, candidate.get_promises());
        values.put(KEY_STATMENT, candidate.get_statment());
        values.put(KEY_ACTIVE, 1);
        values.put(KEY_RANKING, 0);

        // Inserting Row
        db.insert(TABLE_CANDIDATES, null, values);
        db.close(); // Closing database connection
    }

    Candidate getCandidate(String name) {
        db = this.getReadableDatabase();

        cursor = db.query(TABLE_CANDIDATES,
                new String[] { KEY_NAME, KEY_OFFICE, KEY_PHOTO, KEY_PROMISSES,
                        KEY_STATMENT, KEY_ACTIVE, KEY_RANKING }, KEY_NAME + "=?",
                new String[] { String.valueOf(name) }, null, null, null);
        if (cursor != null)
            cursor.moveToFirst();

        Candidate candidate = new Candidate(cursor.getString(0),
                cursor.getString(1), cursor.getString(2), cursor.getString(3),
                cursor.getString(4), Integer.parseInt(cursor.getString(5)), Integer.parseInt(cursor.getString(6)));
        // return candidate
        db.close();
        cursor.close();
        return candidate;
    }

    public List<Candidate> getAllCandidates() {
        List<Candidate> candidateList = new ArrayList<Candidate>();
        // Select All Query
        String selectQuery = "SELECT  * FROM " + TABLE_CANDIDATES;

        db = this.getReadableDatabase();
        cursor = db.rawQuery(selectQuery, null);

        // looping through all rows and adding to list
        if (cursor.moveToFirst()) {
            do {
                Candidate candidate = new Candidate();
                candidate.set_name(cursor.getString(0));
                candidate.set_office(cursor.getString(1));
                candidate.set_photograph(cursor.getString(2));
                candidate.set_promises(cursor.getString(3));
                candidate.set_statment(cursor.getString(4));
                candidate.set_active(Integer.parseInt(cursor.getString(5)));
                candidate.set_ranking(Integer.parseInt(cursor.getString(6)));

                // Adding candidate to list
                candidateList.add(candidate);
            } while (cursor.moveToNext());
        }

        // return candidate list
        db.close();
        cursor.close();
        return candidateList;
    }

    public int updateCandidate(Candidate candidate) {
        db = this.getWritableDatabase();

        ContentValues values = new ContentValues();
        values.put(KEY_NAME, candidate.get_name()); // Candidate Name
        values.put(KEY_OFFICE, candidate.get_office()); // Candidate Phone
        values.put(KEY_PHOTO, candidate.get_photograph());
        values.put(KEY_PROMISSES, candidate.get_promises());
        values.put(KEY_STATMENT, candidate.get_statment());
        values.put(KEY_ACTIVE, candidate.get_active());
        values.put(KEY_RANKING, candidate.get_active());

        // updating row
        return db.update(TABLE_CANDIDATES, values, KEY_NAME + " = ?",
                new String[] { String.valueOf(candidate.get_name()) });
    }

    // Deleting single candidate
    public void deleteCandidate(Candidate candidate) {
        db = this.getWritableDatabase();
        db.delete(TABLE_CANDIDATES, KEY_NAME + " = ?",
                new String[] { String.valueOf(candidate.get_name()) });
        db.close();
    }

    // Getting candidates Count
    public int getCandidatesCount() {
        String countQuery = "SELECT  * FROM " + TABLE_CANDIDATES;
        db = this.getReadableDatabase();
        cursor = db.rawQuery(countQuery, null);

        int count = cursor.getCount();
        cursor.close();
        db.close();
        // return count
        return count;
    }
} 
```

logcat output

```
12-13 01:36:25.359: D/I was there(338): parsing 
12-13 01:36:25.428: D/AndroidRuntime(338): Shutting down VM
12-13 01:36:25.428: W/dalvikvm(338): threadid=1: thread exiting with uncaught exception (group=0x4001d800)
12-13 01:36:25.479: D/dalvikvm(338): GC_FOR_MALLOC freed 3868 objects / 251528 bytes in 53ms
12-13 01:36:25.488: E/Cursor(338): Finalizing a Cursor that has not been deactivated or closed. database = /data/data/com.s1042512.electionvoter/databases/ElectionCandidates, table = candidates, query = SELECT name, office, photograph, promisses, statment, active, ranking FROM candidates WHERE name=?
12-13 01:36:25.488: E/Cursor(338): android.database.sqlite.DatabaseObjectNotClosedException: Application did not close the cursor or database object that was opened here
12-13 01:36:25.488: E/Cursor(338):  at android.database.sqlite.SQLiteCursor.<init>(SQLiteCursor.java:210)
12-13 01:36:25.488: E/Cursor(338):  at android.database.sqlite.SQLiteDirectCursorDriver.query(SQLiteDirectCursorDriver.java:53)
12-13 01:36:25.488: E/Cursor(338):  at android.database.sqlite.SQLiteDatabase.rawQueryWithFactory(SQLiteDatabase.java:1345)
12-13 01:36:25.488: E/Cursor(338):  at android.database.sqlite.SQLiteDatabase.queryWithFactory(SQLiteDatabase.java:1229)
12-13 01:36:25.488: E/Cursor(338):  at android.database.sqlite.SQLiteDatabase.query(SQLiteDatabase.java:1184)
12-13 01:36:25.488: E/Cursor(338):  at android.database.sqlite.SQLiteDatabase.query(SQLiteDatabase.java:1264)
12-13 01:36:25.488: E/Cursor(338):  at com.s1042512.electionvoter.DatabaseHandler.getCandidate(DatabaseHandler.java:80)
12-13 01:36:25.488: E/Cursor(338):  at com.s1042512.electionvoter.MainActivity.onCreate(MainActivity.java:58)
12-13 01:36:25.488: E/Cursor(338):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
12-13 01:36:25.488: E/Cursor(338):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
12-13 01:36:25.488: E/Cursor(338):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
12-13 01:36:25.488: E/Cursor(338):  at android.app.ActivityThread.access$2300(ActivityThread.java:125)
12-13 01:36:25.488: E/Cursor(338):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
12-13 01:36:25.488: E/Cursor(338):  at android.os.Handler.dispatchMessage(Handler.java:99)
12-13 01:36:25.488: E/Cursor(338):  at android.os.Looper.loop(Looper.java:123)
12-13 01:36:25.488: E/Cursor(338):  at android.app.ActivityThread.main(ActivityThread.java:4627)
12-13 01:36:25.488: E/Cursor(338):  at java.lang.reflect.Method.invokeNative(Native Method)
12-13 01:36:25.488: E/Cursor(338):  at java.lang.reflect.Method.invoke(Method.java:521)
12-13 01:36:25.488: E/Cursor(338):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
12-13 01:36:25.488: E/Cursor(338):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
12-13 01:36:25.488: E/Cursor(338):  at dalvik.system.NativeStart.main(Native Method)
12-13 01:36:25.508: W/SQLiteCompiledSql(338): Releasing statement in a finalizer. Please ensure that you explicitly call close() on your cursor: SELECT name, office, photograph, promisses, statment, active, ranking FROM candidates WHERE name=?
12-13 01:36:25.508: W/SQLiteCompiledSql(338): android.database.sqlite.DatabaseObjectNotClosedException: Application did not close the cursor or database object that was opened here
12-13 01:36:25.508: W/SQLiteCompiledSql(338):   at android.database.sqlite.SQLiteCompiledSql.<init>(SQLiteCompiledSql.java:62)
12-13 01:36:25.508: W/SQLiteCompiledSql(338):   at android.database.sqlite.SQLiteProgram.<init>(SQLiteProgram.java:80)
12-13 01:36:25.508: W/SQLiteCompiledSql(338):   at android.database.sqlite.SQLiteQuery.<init>(SQLiteQuery.java:46)
12-13 01:36:25.508: W/SQLiteCompiledSql(338):   at android.database.sqlite.SQLiteDirectCursorDriver.query(SQLiteDirectCursorDriver.java:42)
12-13 01:36:25.508: W/SQLiteCompiledSql(338):   at android.database.sqlite.SQLiteDatabase.rawQueryWithFactory(SQLiteDatabase.java:1345)
12-13 01:36:25.508: W/SQLiteCompiledSql(338):   at android.database.sqlite.SQLiteDatabase.queryWithFactory(SQLiteDatabase.java:1229)
12-13 01:36:25.508: W/SQLiteCompiledSql(338):   at android.database.sqlite.SQLiteDatabase.query(SQLiteDatabase.java:1184)
12-13 01:36:25.508: W/SQLiteCompiledSql(338):   at android.database.sqlite.SQLiteDatabase.query(SQLiteDatabase.java:1264)
12-13 01:36:25.508: W/SQLiteCompiledSql(338):   at com.s1042512.electionvoter.DatabaseHandler.getCandidate(DatabaseHandler.java:80)
12-13 01:36:25.508: W/SQLiteCompiledSql(338):   at com.s1042512.electionvoter.MainActivity.onCreate(MainActivity.java:58)
12-13 01:36:25.508: W/SQLiteCompiledSql(338):   at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
12-13 01:36:25.508: W/SQLiteCompiledSql(338):   at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
12-13 01:36:25.508: W/SQLiteCompiledSql(338):   at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
12-13 01:36:25.508: W/SQLiteCompiledSql(338):   at android.app.ActivityThread.access$2300(ActivityThread.java:125)
12-13 01:36:25.508: W/SQLiteCompiledSql(338):   at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
12-13 01:36:25.508: W/SQLiteCompiledSql(338):   at android.os.Handler.dispatchMessage(Handler.java:99)
12-13 01:36:25.508: W/SQLiteCompiledSql(338):   at android.os.Looper.loop(Looper.java:123)
12-13 01:36:25.508: W/SQLiteCompiledSql(338):   at android.app.ActivityThread.main(ActivityThread.java:4627)
12-13 01:36:25.508: W/SQLiteCompiledSql(338):   at java.lang.reflect.Method.invokeNative(Native Method)
12-13 01:36:25.508: W/SQLiteCompiledSql(338):   at java.lang.reflect.Method.invoke(Method.java:521)
12-13 01:36:25.508: W/SQLiteCompiledSql(338):   at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
12-13 01:36:25.508: W/SQLiteCompiledSql(338):   at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
12-13 01:36:25.508: W/SQLiteCompiledSql(338):   at dalvik.system.NativeStart.main(Native Method)
12-13 01:36:25.518: E/AndroidRuntime(338): FATAL EXCEPTION: main
12-13 01:36:25.518: E/AndroidRuntime(338): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.s1042512.electionvoter/com.s1042512.electionvoter.MainActivity}: android.database.CursorIndexOutOfBoundsException: Index 0 requested, with a size of 0
12-13 01:36:25.518: E/AndroidRuntime(338):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2663)
12-13 01:36:25.518: E/AndroidRuntime(338):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
12-13 01:36:25.518: E/AndroidRuntime(338):  at android.app.ActivityThread.access$2300(ActivityThread.java:125)
12-13 01:36:25.518: E/AndroidRuntime(338):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
12-13 01:36:25.518: E/AndroidRuntime(338):  at android.os.Handler.dispatchMessage(Handler.java:99)
12-13 01:36:25.518: E/AndroidRuntime(338):  at android.os.Looper.loop(Looper.java:123)
12-13 01:36:25.518: E/AndroidRuntime(338):  at android.app.ActivityThread.main(ActivityThread.java:4627)
12-13 01:36:25.518: E/AndroidRuntime(338):  at java.lang.reflect.Method.invokeNative(Native Method)
12-13 01:36:25.518: E/AndroidRuntime(338):  at java.lang.reflect.Method.invoke(Method.java:521)
12-13 01:36:25.518: E/AndroidRuntime(338):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
12-13 01:36:25.518: E/AndroidRuntime(338):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
12-13 01:36:25.518: E/AndroidRuntime(338):  at dalvik.system.NativeStart.main(Native Method)
12-13 01:36:25.518: E/AndroidRuntime(338): Caused by: android.database.CursorIndexOutOfBoundsException: Index 0 requested, with a size of 0
12-13 01:36:25.518: E/AndroidRuntime(338):  at android.database.AbstractCursor.checkPosition(AbstractCursor.java:580)
12-13 01:36:25.518: E/AndroidRuntime(338):  at android.database.AbstractWindowedCursor.checkPosition(AbstractWindowedCursor.java:214)
12-13 01:36:25.518: E/AndroidRuntime(338):  at android.database.AbstractWindowedCursor.getString(AbstractWindowedCursor.java:41)
12-13 01:36:25.518: E/AndroidRuntime(338):  at com.s1042512.electionvoter.DatabaseHandler.getCandidate(DatabaseHandler.java:87)
12-13 01:36:25.518: E/AndroidRuntime(338):  at com.s1042512.electionvoter.MainActivity.onCreate(MainActivity.java:58)
12-13 01:36:25.518: E/AndroidRuntime(338):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
12-13 01:36:25.518: E/AndroidRuntime(338):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
12-13 01:36:25.518: E/AndroidRuntime(338):  ... 11 more
12-13 01:36:25.529: E/Database(338): close() was never explicitly called on database '/data/data/com.s1042512.electionvoter/databases/ElectionCandidates' 
12-13 01:36:25.529: E/Database(338): android.database.sqlite.DatabaseObjectNotClosedException: Application did not close the cursor or database object that was opened here
12-13 01:36:25.529: E/Database(338):    at android.database.sqlite.SQLiteDatabase.<init>(SQLiteDatabase.java:1810)
12-13 01:36:25.529: E/Database(338):    at android.database.sqlite.SQLiteDatabase.openDatabase(SQLiteDatabase.java:817)
12-13 01:36:25.529: E/Database(338):    at android.database.sqlite.SQLiteDatabase.openOrCreateDatabase(SQLiteDatabase.java:851)
12-13 01:36:25.529: E/Database(338):    at android.database.sqlite.SQLiteDatabase.openOrCreateDatabase(SQLiteDatabase.java:844)
12-13 01:36:25.529: E/Database(338):    at android.app.ContextImpl.openOrCreateDatabase(ContextImpl.java:540)
12-13 01:36:25.529: E/Database(338):    at android.content.ContextWrapper.openOrCreateDatabase(ContextWrapper.java:203)
12-13 01:36:25.529: E/Database(338):    at android.database.sqlite.SQLiteOpenHelper.getWritableDatabase(SQLiteOpenHelper.java:98)
12-13 01:36:25.529: E/Database(338):    at android.database.sqlite.SQLiteOpenHelper.getReadableDatabase(SQLiteOpenHelper.java:158)
12-13 01:36:25.529: E/Database(338):    at com.s1042512.electionvoter.DatabaseHandler.getCandidate(DatabaseHandler.java:78)
12-13 01:36:25.529: E/Database(338):    at com.s1042512.electionvoter.MainActivity.onCreate(MainActivity.java:58)
12-13 01:36:25.529: E/Database(338):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
12-13 01:36:25.529: E/Database(338):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
12-13 01:36:25.529: E/Database(338):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
12-13 01:36:25.529: E/Database(338):    at android.app.ActivityThread.access$2300(ActivityThread.java:125)
12-13 01:36:25.529: E/Database(338):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
12-13 01:36:25.529: E/Database(338):    at android.os.Handler.dispatchMessage(Handler.java:99)
12-13 01:36:25.529: E/Database(338):    at android.os.Looper.loop(Looper.java:123)
12-13 01:36:25.529: E/Database(338):    at android.app.ActivityThread.main(ActivityThread.java:4627)
12-13 01:36:25.529: E/Database(338):    at java.lang.reflect.Method.invokeNative(Native Method)
12-13 01:36:25.529: E/Database(338):    at java.lang.reflect.Method.invoke(Method.java:521)
12-13 01:36:25.529: E/Database(338):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
12-13 01:36:25.529: E/Database(338):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
12-13 01:36:25.529: E/Database(338):    at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T01:22:14.383

我认为你的错误很简单。您在 DatabaseHandler 中的 153 是包含以下代码的行吗？

```
return cursor.getCount(); 
```

在这一行中，您正在访问在此之前已关闭的游标对象。根据[API](http://developer.android.com/reference/android/database/Cursor.html#close%28%29)，游标关闭后无效。

尝试将 getCandidatesCount()-Method 更改为：

```
public int getCandidatesCount() {
    String countQuery = "SELECT  * FROM " + TABLE_CANDIDATES;
    SQLiteDatabase db = this.getReadableDatabase();
    Cursor cursor = db.rawQuery(countQuery, null);
    int candidatesCount = cursor.getCount();
    cursor.close();

    // return count
    return candidatesCount;
} 
```

**PS：**是否有任何理由**不**关闭方法中的游标`getCandidate(..)`和`getAllCandidates()`？

# c# - 链接列表：显示项目

> ID：13850817
> 
> 赞同：-1
> 
> 时间：2012-12-13T00:01:12.017
> 
> 标签：c#

我正在使用包含 5 个项目的链接列表。我创建`fruit_trees[] ax`了包含项目列表的内容。我收到一个错误，`ListForTrees newlist = new ListForTrees(ax);`说它有无效的参数。我不确定这个错误。如何通过构造函数正确传递数组？

```
namespace treeFarm
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        public class fruit_trees
        {
            private string tree_type = " ";
            private int tree_height = 0;
            public double tree_price = 0;
            private int tree_instock = 0;

            public fruit_trees next_tree;

            public fruit_trees(string newtree, int newheight,  double newprice, int newinstock)
            {
                tree_type = newtree;
                tree_height = newheight;
                tree_price = newprice;
                tree_instock = newinstock;

                next_tree = null;
            }

            public override string ToString()
            {
                return tree_type + " " + tree_height + " " + tree_price + " " + tree_instock;

            }

        }

        public class ListForTrees
        {
            public fruit_trees first_tree;
            public fruit_trees last_tree;

            public int count = 0;

            public ListForTrees(fruit_trees new_tree)
            {
                first_tree = new_tree;
                last_tree = new_tree;
                count = 1;
            }

            public ListForTrees()
            {

            }

            public void AddTree(fruit_trees new_tree)
            {
                fruit_trees current = first_tree;

                if (count == 0)
                {
                    first_tree = new_tree;
                    last_tree = new_tree;
                    count = 1;
                }

                else if (count != 0)
                {
                    if (new_tree.tree_price <= first_tree.tree_price)
                    {
                        new_tree.next_tree = first_tree;
                        first_tree = new_tree;
                    }

                    else if (new_tree.tree_price >= last_tree.tree_price)
                    {
                        last_tree.next_tree = new_tree;
                        last_tree = new_tree;
                    }

                    else
                    {
                        while (new_tree.tree_price > current.next_tree.tree_price)
                        {
                            current = current.next_tree;
                        }

                        new_tree.next_tree = current.next_tree;
                        current.next_tree = new_tree;
                    }

                    count++;
                }
            }

            public void ClearTrees()
            {
                first_tree = null;
                count = 0;
            }
        }

        ListForTrees mainlist = new ListForTrees();

        private void ShowList_Click(object sender, EventArgs e)
        {
            fruit_trees current = mainlist.first_tree;

            while (current != null)
            {

                TxtOutput.AppendText(current.ToString() + Environment.NewLine);          
                current = current.next_tree;
            }

            TxtOutput.AppendText(Environment.NewLine);
        }

        private void BtnGo_Click(object sender, EventArgs e)
        {
            fruit_trees[] ax = {   new fruit_trees("item1", 2, 2.00, 3),
                                             new fruit_trees("item2", 2, 3.95, 6),
                                             new fruit_trees("item3", 5, 9.95, 2),
                                             new fruit_trees("item4", 54, 19.95, 3),
                                             new fruit_trees("item5", 36, 11.85, 2),
                                             new fruit_trees("item6", 62, 13.45, 5)
                                         };

            ListForTrees newlist = new ListForTrees(ax);
            fruit_trees current = newlist.first_tree;

            while (current != null)
            {
                TxtOutput.AppendText(current.ToString() + Environment.NewLine);
                current = current.next_tree;
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T00:05:43.527

您没有采用`fruit_trees`实例数组的构造函数。您可能希望从另一个集合初始化您的集合，因此您可以添加一个构造函数来添加每个元素：

```
public ListForTrees(IEnumerable<fruit_trees> trees)
{
    foreach(fruit_trees t in trees)
    {
        this.AddTree(t);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T00:05:34.583

看起来真的很简单。您的`ListForTrees`构造函数接受 type 的参数，`fruit_trees`但您传递的参数 type `fruit_trees[]`。

# r - Generate all possible permutations from four integer lists in R

> ID：13850818
> 
> 赞同：2
> 
> 时间：2012-12-13T00:01:11.377
> 
> 标签：r, list, permutation, probability, mean

(Very) amateur coder and statistician working on a problem in R.

I have four integer lists: A, B, C, D.

```
A <- [1:133]
B <- [1:266]
C <- [1:266]
D <- [1:133, 267-400] 
```

I want R to generate all of the permutations from picking 1 item from each of these lists (I know this code will take forever to run), and then take the mean of each of those permutations. So, for instance, [1, 100, 200, 400] -> 175.25.

Ideally what I would have at the end is a list of all of these means then.

Any ideas?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T00:44:09.437

对于一个较小但类似的问题，我会这样做：

```
A <- 1:13
B <- 1:26
C <- 1:26
D <- c(1:13, 27:40)

mymat <- expand.grid(A, B, C, D)
names(mymat) <- c("A", "B", "C", "D")
mymat <- as.matrix(mymat)
mymeans <- rowSums(mymat)/4 
```

如果你只设置所有索引，你可能会崩溃 R，但你可能会设置一个循环，像这样（未经测试）：

```
B <- 1:266
C <- 1:266
D <- c(1:133, 267:400)

for(A in 1:133) {
    mymat <- expand.grid(A, B, C, D)
    names(mymat) <- c("A", "B", "C", "D")
    mymat <- as.matrix(mymat)
    mymeans <- rowSums(mymat)/4
    write.table(mymat, file = paste("matrix", A, "txt", sep = "."))
    write.table(mymeans, file = paste("means", A, "txt", sep = "."))
    rm(mymat, mymeans)
} 
```

得到他们所有。那仍然可能太大，在这种情况下你可以做一个嵌套循环，或者循环`D`（因为它是最大的）

或者，

```
n <- 1e7
A <- sample(133, size = n, replace= TRUE)
B <- sample(266, size = n, replace= TRUE)
C <- sample(266, size = n, replace= TRUE)
D <- sample(x = c(1:133, 267:400), size = n, replace= TRUE)
mymeans <- (A+B+C+D)/4 
```

将为您提供大量的手段样本，并且完全不需要时间。

```
hist(mymeans) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T00:56:52.473

即使创建与排列一样大的均值向量也会耗尽所有内存。您将不得不将其拆分为较小的问题，查找将对象写入 excel，然后[在此处](https://stackoverflow.com/questions/1358003/tricks-to-manage-the-available-memory-in-an-r-session)从内存中删除对象（均在 SO 上）。

至于执行此操作的代码，我已尝试使其尽可能简单，以便轻松“增长”您的知识：

```
#this is how to create vectors of sequential integers integers in R
a <- c(1:33)
b <- c(1:33)
c <- c(1:33)
d <- c(1:33,267:300)

#this is how to create an empty vector
means <- rep(NA,length(a)*length(b)*length(c)*length(d))
#set up for a loop
i <- 1

#how you run a loop to perform this operation
for(j in 1:length(a)){
    for(k in 1:length(b)){
        for(l in 1:length(c)){
            for(m in 1:length(d)){
                y <- c(a[j],b[k],c[l],d[m])
                means[i] <- mean(y)
                i <- i+1
            }
        }
    }
}

#and to graph your output
hist(means, col='brown')
#lets put a mean line through the histogram
abline(v=mean(means), col='white', lwd=2) 
```

# javascript - Can I determine if a string is a MongoDB ObjectID?

> ID：13850819
> 
> 赞同：110
> 
> 时间：2012-12-13T00:01:13.787
> 
> 标签：javascript, node.js, mongodb, coffeescript, express

I am doing MongoDB lookups by converting a string to BSON. Is there a way for me to determine if the string I have is a valid ObjectID for Mongo before doing the conversion?

Here is the coffeescript for my current findByID function. It works great, but I'd like to lookup by a different attribute if I determine the string is not an ID.

```
db.collection "pages", (err, collection) ->
  collection.findOne
    _id: new BSON.ObjectID(id)
  , (err, item) ->
    if item
      res.send item
    else
      res.send 404 
```

* * *

## 回答 #1

> 赞同：195
> 
> 时间：2015-03-24T11:08:58.997

我发现 mongoose ObjectId 验证器可以验证有效的 objectId，但我发现在少数情况下无效的 id 被认为是有效的。（例如：任何 12 个字符的长字符串）

```
var ObjectId = require('mongoose').Types.ObjectId;
ObjectId.isValid('microsoft123'); //true
ObjectId.isValid('timtomtamted'); //true
ObjectId.isValid('551137c2f9e1fac808a5f572'); //true 
```

对我有用的是将字符串转换为 objectId，然后检查原始字符串是否与 objectId 的字符串值匹配。

```
new ObjectId('timtamtomted'); //616273656e6365576f726b73
new ObjectId('537eed02ed345b2e039652d2') //537eed02ed345b2e039652d2 
```

这是因为有效 id 在转换为 ObjectId 时不会改变，但如果字符串转换为 objectId 时会发生错误，则会发生变化。

* * *

## 回答 #2

> 赞同：95
> 
> 时间：2012-12-13T01:00:14.560

您可以使用正则表达式来测试：

咖啡脚本

```
if id.match /^[0-9a-fA-F]{24}$/
    # it's an ObjectID
else
    # nope 
```

JavaScript

```
if (id.match(/^[0-9a-fA-F]{24}$/)) {
    // it's an ObjectID    
} else {
    // nope    
} 
```

* * *

## 回答 #3

> 赞同：67
> 
> 时间：2020-08-31T08:13:08.327

## ✅ 内置解决方案`isValidObjectId()`> Mongoose 5.7.12

**如果您使用的是 Mongoose，我们可以使用 mongoose内置的** [isValidObjectId](https://mongoosejs.com/docs/api/mongoose.html#mongoose_Mongoose-isValidObjectId)来测试 String 是 12 字节还是 24 十六进制字符的字符串。

```
mongoose.isValidObjectId(string); /* will return true/false */ 
```

* * *

#### 请注意！

`isValidObjectId()`最常用于测试预期的 objectID，以避免 mongoose throwing invalid object ID 错误。

例子

```
if (mongoose.isValidObjectId("some 12 byte string")) {
     return collection.findOne({ _id: "some 12 byte string" })
     // returns null if no record found.
} 
```

如果您不有条件地测试预期的 objectID 是否有效，则需要捕获错误。

```
try {
  return collection.findOne({ _id: "abc" }) 
  //this will throw error
} catch(error) {
  console.log('invalid _id error', error)
} 
```

因为`findOne({ _id: null })`和`findOne({ _id: undefined })`是完全有效的查询（不会抛出错误），`isValidObjectId(undefined)`并且`isValidObjectId(null)`将返回 true。

#### 注意2！

**123456789012**可能看起来不像一个 bson 字符串，但它完全是一个有效的 ObjectID，因为以下查询**不会**引发错误。（如果没有找到记录，则返回 null）。

```
findOne({ _id: ObjectId('123456789012')}) // ✅ valid query 
```

**313233343536373839303132**可能看起来像一个 24 个字符的字符串（它是**123456789012**的十六进制值），但它也是一个有效的 ObjectId，因为以下查询**不会**引发错误。（如果没有找到记录，则返回 null）

```
findOne({ _id: ObjectId('313233343536373839303132')}) // ✅ valid query 
```

以下内容无效（比上述示例少 1 个字符串字符）

```
findOne({ _id: ObjectId('12345678901')}) // ❌ not 12 byte string
findOne({ _id: ObjectId('31323334353637383930313')}) // ❌ not 24 char hex 
```

## ObjectId 的格式

ObjectId 很小，可能是唯一的，生成速度快，并且是有序的。ObjectId 值的长度为 12 个字节，包括：

*   一个 4 字节的时间戳值，表示 ObjectId 的创建，以 Unix 纪元以来的秒数为单位
*   每个进程生成一次的 5 字节**随机值。**这个**随机值**对于机器和过程是唯一的。
*   一个 3 字节递增计数器，初始化为随机值

由于上述**随机值，****无法计算**ObjectId 。它只能显示为 12 字节字符串或 24 字符十六进制字符串。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2014-07-15T16:23:55.490

我过去曾使用本机节点 mongodb 驱动程序来执行此操作。isValid 方法检查该值是否为有效的 BSON ObjectId。[请参阅此处的文档。](http://mongodb.github.io/node-mongodb-native/api-bson-generated/objectid.html#objectid-isvalid)

```
var ObjectID = require('mongodb').ObjectID;
console.log( ObjectID.isValid(12345) ); 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2018-08-30T15:29:50.560

如果字符串包含 12 个字母，mongoose.Types.ObjectId.isValid(string) 总是返回 True

```
let firstUserID = '5b360fdea392d731829ded18';
let secondUserID = 'aaaaaaaaaaaa';

console.log(mongoose.Types.ObjectId.isValid(firstUserID)); // true
console.log(mongoose.Types.ObjectId.isValid(secondUserID)); // true

let checkForValidMongoDbID = new RegExp("^[0-9a-fA-F]{24}$");
console.log(checkForValidMongoDbID.test(firstUserID)); // true
console.log(checkForValidMongoDbID.test(secondUserID)); // false 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2016-03-30T19:21:26.070

这是我根据@andy-macleod 的回答编写的一些代码。

它可以采用 int、string 或 ObjectId，如果传递的值有效则返回有效的 ObjectId，如果传递的值无效则返回 null：

```
var ObjectId= require('mongoose').Types.ObjectId;

function toObjectId(id) {

    var stringId = id.toString().toLowerCase();

    if (!ObjectId.isValid(stringId)) {
        return null;
    }

    var result = new ObjectId(stringId);
    if (result.toString() != stringId) {
        return null;
    }

    return result;
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2020-07-17T17:39:22.397

检查字符串是否为有效的 Mongo ObjectId 的最简单方法是使用**mongodb**模块。

```
const ObjectID = require('mongodb').ObjectID;

if(ObjectID.isValid(777777777777777)){
   console.log("Valid ObjectID")
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-04-18T13:03:17.853

我发现的唯一方法是使用我要检查的值创建一个新的 ObjectId，如果输入等于输出，则 id 有效：

```
function validate(id) {
    var valid = false;
    try
    {
        if(id == new mongoose.Types.ObjectId(""+id))
           valid = true;

    }
    catch(e)
    {
       valid = false;
    }
    return valid;
}

> validate(null)
false
> validate(20)
false
> validate("abcdef")
false
> validate("5ad72b594c897c7c38b2bf71")
true 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-01-30T18:10:05.443

下面是一个函数，它既检查 ObjectId`isValid`方法，也检查是否`new ObjectId(id)`返回相同的值。`isValid`安迪·麦克劳德（Andy Macleod）在选择的答案中很好地描述了独自一人不够的原因。

```
const ObjectId = require('mongoose').Types.ObjectId;

/**
 * True if provided object ID valid
 * @param {string} id 
 */
function isObjectIdValid(id){ 
  return ObjectId.isValid(id) && new ObjectId(id) == id;
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-02-28T09:23:35.460

@ross-u 的回答真是太棒了。

我已经链接了方法来进行完整的内联验证：

```
documentId = id && isValid(id) && new ObjectId(id) == id ? id : null 
```

请注意双等号，这非常重要，因为`new ObjectId()`它不返回字符串，并且在与普通字符串（我的逻辑中已经出现）进行比较时，严格比较将返回 false。

这些方法已从`mongoose`require 公开的对象中解构：

```
const {
  Types: {
    ObjectId: { isValid },
    ObjectId
  }
} = require("mongoose"); 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-06-23T08:09:10.340

最简单的方法基本上是将您的 ObjectId 方法包装在 try and catch 服务中。然后您将使用此服务来处理 Objecet Id，而不是直接使用该方法：

```
var ObjectId = REQUIRE OR IMPORT ...

// service
function oid(str) {
 try {   
   return ObjectId(str);
 } catch(err) {
   return false;
 }
}

// usage
if (oid(USER_INPUT)) {
  // continue
} else {
  // throw error
} 
```

您还可以发送 null 或空 props 以获取新生成的 ID。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2021-07-02T13:14:28.163

这种方法可能会对某人有所帮助。它适用于 nodejs mongodb 驱动程序

```
if (ObjectId.isValid(stringId) && (ObjectId(stringId).toString() === stringId)){
  // your operation
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2022-01-21T12:40:15.393

[https://mongodb.github.io/node-mongodb-native/api-bson-generated/objectid.html#objectid-isvalid](https://mongodb.github.io/node-mongodb-native/api-bson-generated/objectid.html#objectid-isvalid)

来自 MongoDB 文档：

构造函数文档：

```
ObjectID()
Constructor
Create a new ObjectID instance

class ObjectID()
    Arguments:  
        id (string) – Can be a 24 byte hex string, 12 byte binary string or a Number.
    Returns:    
        object instance of ObjectID. 
```

ObjectId.isValid() 文档：

```
Checks if a value is a valid bson ObjectId

ObjectID.isValid()
    Returns:    boolean return true if the value is a valid bson ObjectId, return false otherwise. 
```

因此，`isValid(...)`如果参数是有效的 BSON ObjectId 对象，将返回 true，并且构造函数`ObjectId(...)`只接受有效的 BSON ObjectId 对象参数（基本上，`isValid(...)`如果构造函数抛出异常，将返回 false）。

知道这一点。我们可以首先检查参数是否有效`ObjectId`，然后`ObjectId`使用该值创建一个并比较 HEX 字符串。

```
const objectId = 'str_object_id';
const isValid = ObjectId.isValid(objectId) && new ObjectId(objectId).toHexString() == objectId; 
```

如果传递`objectId`的不是一个有效的`ObjectId`HEX 字符串（它没有被构造函数转换），这个方法将返回 false。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-09-15T18:14:51.663

我花了一段时间才得到一个有效的解决方案，因为@Andy Macleod 提出的将 objectId 值与其自己的字符串进行比较的解决方案正在使 Express.js 服务器崩溃：

```
var view_task_id_temp=new mongodb.ObjectID("invalid_id_string"); //this crashed 
```

我只是使用了一个简单的 try catch 来解决这个问题。

```
var mongodb = require('mongodb');
var id_error=false;
try{
    var x=new mongodb.ObjectID("57d9a8b310b45a383a74df93");
    console.log("x="+JSON.stringify(x));
}catch(err){
    console.log("error="+err);
    id_error=true;
}

if(id_error==false){
   // Do stuff here
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-02-27T22:57:02.737

除了Andy Macleod[接受的答案](https://stackoverflow.com/a/29231016/6375464)之外，我还创建了一个辅助函数，可用于检查字符串和 ObjectId。

### 实施：

```
var ObjectId = require("mongoose").Types.ObjectId;

function isValidObjectId(value) {
  // If value is an ObjectId cast it to a string to allow
  // passing string or ObjectId as an argument.
  var valueString = typeof value === "string" ? value : String(value); 

  // Cast the string to ObjectId
  var idInstance = new ObjectId(valueString); 

  return String(idInstance) === valueString;
} 
```

### 解释：

在接受的答案中，**安迪麦克劳德**说：

> 对我有用的是将字符串转换为 objectId，然后检查原始字符串是否与 objectId 的字符串值匹配。

**使用无效的 ObjectId 字符串**

将无效字符串（如`"microsoft"`）转换为 ObjectId，会给出完全不同的值：

```
 "microsoft"
            ↓
String( new ObjectId("microsoft")  );
            ↓
"6d6963726f736f6674313233"
            ↓
"microsoft" === "6d6963726f736f6674313233" // false 
```

**使用有效的 ObjectId 字符串**

将像 ( `"6d6963726f736f6674313233"`) 这样的有效字符串转换为 ObjectId 会给出相同的值：

```
"6d6963726f736f6674313233"
            ↓
String( new ObjectId("6d6963726f736f6674313233") )
            ↓
"6d6963726f736f6674313233"     
            ↓
"6d6963726f736f6674313233" === "6d6963726f736f6674313233"  // true 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-04-21T22:24:00.143

如果你有十六进制字符串，你可以使用这个：

```
ObjectId.isValid(ObjectId.createFromHexString(hexId)); 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2017-10-23T05:43:02.347

对于 mongoose ，使用 isValid() 函数检查 objectId 是否有效

例子 ：

```
var ObjectId = mongoose.Types.ObjectId;
if(ObjectId.isValid(req.params.documentId)){
   console.log('Object id is valid'); 
}else{
   console.log('Invalid Object id');
} 
```

* * *

## 回答 #18

> 赞同：-2
> 
> 时间：2014-12-23T23:09:30.267

警告：对于以有效十六进制数字开头的任意 12/24 长度字符串，**isValid**将返回**true 。**目前我认为这是一个更好的检查：

> `((thing.length === 24 || thing.length === 12) && isNaN(parseInt(thing,16)) !== true)`

# ruby-on-rails - No route matches {:action=>"bands", :controller=>"users"}

> ID：13850821
> 
> 赞同：0
> 
> 时间：2012-12-13T00:01:21.063
> 
> 标签：ruby-on-rails, routing, rails-routing

When a user signs up for my site, they are redirected to '/welcome', which includes these links:

```
<%= link_to "Create Band Page", bands_user_path %>
<%= link_to "Complete Profile", edit_user_path(current_user) %> 
```

The 'Complete Profile' link shows up and works fine. However, the page won't display with the 'Create Band Page' link, and results in this error:

```
No route matches {:action=>"bands", :controller=>"users"} 
```

I have that link on the user's page and it works fine tho.

My users_controller includes this bit:

```
def bands
  @band = current_user.bands.build
  @bands = current_user.bands.all
  @user = current_user
end 
```

And the relevant routes.rb parts look like this:

```
resources :users do
  member do
    get :following, :followers, :bands
  end
end
match '/welcome', to: 'static_pages#welcome' 
```

As I said before, when I use the link on a user's show page it works fine, and rake routes includes the appropriate link:

```
bands_user GET    /users/:id/bands(.:format)      users#bands 
```

What am I missing here?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T00:11:18.923

你没有将它传递给你想要显示乐队的用户。

您的路线匹配`/users/:id/bands(.:format)`。格式是一个可选段（这就是括号的含义），但`:id`它是必需的。它希望您传入一个有效的 user_id 或用户对象来影响 user_id。

尝试`<%= link_to "Create Band Page", bands_user_path(current_user) %>`，它应该工作。

# c++ - c++ 中使用哪个实现堆栈库？

> ID：13850825
> 
> 赞同：-3
> 
> 时间：2012-12-13T00:01:41.670
> 
> 标签：c++, stack

我读到 ADT 堆栈可以使用来实现

数组

一个链表

ADT 列表

但是当我使用堆栈时，我只是调用堆栈库。这些实现堆栈库中的哪个使用？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-13T00:04:36.660

`std::stack`是一个容器*适配器*，它使用一些其他容器作为数据的底层存储。默认为`std::deque`，但您可以指定另一个序列，例如`std::list`或`std::vector`如果您愿意。

对底层容器的要求非常低——如果有内存，它需要支持 a `back()`, `push_back()`, `pop_back()`, `size()`and `swap()`（最后两个并不是真正需要的，除非你使用`stack::size()`or `stack::swap()`，这可能并不常见）。

# capybara - Capybara：page_find 似乎没有使用双斜杠 (//)

> ID：13850828
> 
> 赞同：0
> 
> 时间：2012-12-13T00:02:13.260
> 
> 标签：capybara

尝试验证以下 HTML 中的第二个链接：

```
<div id="navigation">
 <ul>
  <li>
   <a href="/tv">TV</a>
  </li>
  <li>
   <a href="/radio">Radio</a>
  </li> 
```

使用以下表达式：

```
page.find(:xpath, "//div[@id='navigation']//a").should have_content('Radio') 
```

我收到以下错误：

```
expected there to be content "Radio" in "TV" 
```

当我使用双斜杠时，不应该对 DIV 节点内的所有 A 元素进行查找方法研究吗？这可能是一个错误还是我做错了什么？

还有其他方法可以验证第二个链接吗？

谢谢你们的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T21:28:19.450

在您的情况下， [find](http://rubydoc.info/github/jnicklas/capybara/master/Capybara/Node/Finders#find-instance_method)将首先`a`在 Capybara < 2.0 中找到，并且会在 Capybara 2.0 中引发歧义匹配异常，因为这样的定位器有多个元素。

我建议您执行以下操作：

```
page.should have_selector('#navigation a', text: 'Radio') 
```

# iphone - 可以在 AppDelegate 中创建自定义委托吗？

> ID：13850833
> 
> 赞同：1
> 
> 时间：2012-12-13T00:02:44.900
> 
> 标签：iphone, ios, appdelegate

我想知道是否可以在 AppDelegate 类中创建自定义委托，例如：

```
@protocol AppDelegateDelegate <NSObject>

- (void)finishSync:(BOOL)success;

@end

@interface AppDelegate : UIResponder <UIApplicationDelegate> {

@property (nonatomic, weak) id <AppDelegateDelegate> delegate;

@end 
```

有可能创造出这样的东西吗？通知为此委托注册的类？

**编辑** 我如何使用代表？例如，如果我这样做：

```
#import "AppDelegate.h"

@interface MasterViewController : UIViewController <AppDelegateDelegate>

@end 
```

.m

```
@implementation MasterViewController

...

- (void)viewDidLoad {
  AppDelegate *appController = (AppDelegate *)[[UIApplication sharedApplication] delegate];
  appController.customDelegate = self;

} 
```

在我只停留在该视图中有效，但例如，如果我切换到具有相同代码来实现委托的 SecondViewController，则委托在 MasterViewController 中也不再有效......我错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T00:20:14.983

是的，那很好。您可以在任何地方创建委托，并通过导入该类在任何地方使用它。没有限制。

# mongodb - How to return popped element in mongodb

> ID：13850838
> 
> 赞同：5
> 
> 时间：2012-12-13T00:03:06.350
> 
> 标签：mongodb, mongomapper

I would like to pop one item from the array, and get that element.

Is it possible in mongodb?

I didn't find such information at

[http://docs.mongodb.org/manual/reference/operator/pop/](http://docs.mongodb.org/manual/reference/operator/pop/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T08:18:52.653

这是不可能的。MongoDB 不会返回您以前使用正常更新获得的文档的任何部分，也就是说它可以返回完整的文档，而不仅仅是`findAndModify`（[http://docs.mongodb.org/manual/reference/command/上的弹出元素） findAndModify/](http://docs.mongodb.org/manual/reference/command/findAndModify/) )，然后您可以过滤掉该元素，无论是第一个还是最后一个。

注意：我应该警告 findAndModify 基本上就像选择查询中的每个文档并对其进行操作，这就是它能够返回它的方式，因此您可能会看到跨越大量查询的一些性能损失。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T08:18:03.947

MongoDB 操作返回[完整文档](http://docs.mongodb.org/manual/reference/glossary/#term-document)。

选项可能是：

*   使用[findAndModify](http://docs.mongodb.org/manual/reference/command/findAndModify/)命令，通过处理返回的文档得到数组程序端的弹出值。(1 个查询)
*   使用[find](http://docs.mongodb.org/manual/applications/read/#crud-read-find)获取文档，获取要在程序端弹出的值，然后发送[更新](http://docs.mongodb.org/manual/applications/update/#crud-update-update)。（2 个查询）

# c# - 为什么 Environment.SpecialFolder.Desktop 是空的

> ID：13850839
> 
> 赞同：1
> 
> 时间：2012-12-13T00:03:26.877
> 
> 标签：c#, asp.net, .net, path, windows-server-2008-r2

请参阅此线程：
[当前用户的桌面路径](https://stackoverflow.com/questions/634142/how-to-get-a-path-to-the-desktop-for-current-user-in-c)

我本地机器上的这段代码（平均路径）没问题，但发布后什么也没返回……
我的意思`Environment.GetFolderPath(Environment.SpecialFolder.Desktop)`是发布后是空的……

```
 string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
    Response.Write(path);
    Response.Write("<br />");
    Response.Write(Server.MapPath("/") + "myfile.htm");
    Response.Write("<br />");

    //string[] directory_list = Directory.GetDirectories(path);
    //foreach (string directory in directory_list)
    //{
    //    if (directory.Contains("blablabla"))
    //    {
    //        string sumfilePath = directory + @"\Sum.txt";
    //        Response.Write(sumfilePath);
    //    }
    //} 
```

发生了什么事，我该如何解决？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-13T00:06:30.587

如果站点没有以具有交互式登录权限的用户身份运行，则不会有与该用户关联的桌面。

这通常是 IIS 中的应用程序池的情况。

使用交互式登录运行应用程序池是不明智的，因为它会产生安全漏洞。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T00:06:26.803

应用程序池可能在服务帐户下运行，而不是您的个人 Windows 帐户。

# css - IE8 Not Recognising HTML5 (even with shiv)

> ID：13850845
> 
> 赞同：6
> 
> 时间：2012-12-13T00:03:50.730
> 
> 标签：css, html, internet-explorer, internet-explorer-8, html5shiv

I'm completely stuck on a really weird IE bug and non of the other posts about this issue seem to solve it. IE 8 isn't applying CSS styles to HTML5 tags on a site I've just launched. In the past I've always fixed this with a shiv and/or code like:

```
<!--[if lt IE 9]>
 <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
 <script>
    document.createElement('header');
    document.createElement('nav');
    document.createElement('section');
    document.createElement('article');
    document.createElement('aside');
    document.createElement('footer');
 </script>
<![endif]--> 
```

The website is [http://www.unyouth.org.au/](http://www.unyouth.org.au/).

IE8 seems to recognise the header but as soon as it gets to the row of ASIDEs stops working.

Does anyone have any ideas why this is happening? Any help would be amazing.

Thanks so much!

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-13T00:46:00.367

刚刚想通了，感谢@Sparky672 为我指明了正确的方向。

对于遇到此问题的其他人，彩色碎片下方的曲线是使用 SVG 创建的。我的印象是，如果 IE 不能渲染 SVG，它就会忽略它，但它似乎把它下面的所有东西都搞砸了。

我还没有弄清楚如何删除 IE 8 的 SVG，因为用 IE 条件注释掉它似乎不起作用——但这是另一个问题。删除它可以解决样式问题！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-01-27T06:04:04.103

我有一个修复，如果评论的话，将你的内联 SVG 包装在 IE9 中。

```
<!--[if gte IE 9]><!-->

    <svg id="svg-source" height="0" version="1.1" 
      xmlns="http://www.w3.org/2000/svg" style="position:absolute; margin-left: -100%" 
      xmlns:xlink="http://www.w3.org/1999/xlink">

    </svg>

<!--<![endif]--> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T00:13:41.327

Explorer absolutely hates invalid HTML.

[Your invalid HTML](http://validator.w3.org/check?uri=http://www.unyouth.org.au/&charset=%28detect%20automatically%29&doctype=Inline&group=0) contains duplicate `id`'s. Specifically, `#site` is used in both `<header>` and `<footer>`. Some browsers just take the first occurrence and ignore the rest.

> Line 440, Column 18: Duplicate ID site. `<footer id="site">`
> 
> Line 97, Column 19: The first occurrence of ID site was here. `<header id="site">`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-01-16T08:58:17.323

要解决您的 SVG 删除问题（在确保您拥有有效的 HTML 之后）- 将以下代码应用到页面顶部以替换标准的`<html>`.

```
<!--[if lt IE 9]> <html class="lt-ie9"> <![endif]-->
<!--[if gt IE 9]><!--> <html> <!--<![endif]--> 
```

这会将类“lt-ie9”应用于 IE 版本低于版本 9 的整个页面。任何版本，9 或更高版本，将显示没有类的普通 <html>。

此时，您有一个类，您可以在 CSS 中使用它来删除这些浏览器的任何元素。

```
.lt-ie9 svg {display: none;} /* this will remove all SVG elements with the class */ 
```

***免责声明**：我已经有一段时间没有在 IE8 上尝试过了。仅当您将 SVG 包装在***div.lt-ie9***中并将其应用于父级时，它才可能起作用 - 我不记得抛出了什么错误。我会测试它，但我在 Ubuntu 上，这台机器上没有虚拟机。*

**注意：**在父元素中使用条件 IE 注释的方法 - ***<html>***或***<body>*** - 很常见，有很多变体。您应该在该领域进行一些研究，并使用比此处提供的更一般的案例。这将为您提供这种技术的更广泛的好处，并专门解决这个问题。

# c++ - Reading binary returns rubbish

> ID：13850848
> 
> 赞同：1
> 
> 时间：2012-12-13T00:04:07.110
> 
> 标签：c++

I'm writing a function to save and load a linked list as a binary. When I try to load the function it stops; the program doesn't crash or freeze but it won't continue beyond the point indicated:

```
 void fLoad(char* fname)
{
    fstream fin;
    fin.open(fname, fstream::in|fstream::binary);

    if(fin.fail())
        {
            cerr<<"unable to open file";
            exit(0);
        }
    cout<<"File open";

    fin.read((char*) &N, sizeof(int));
    cout<<N;
    system("pause");
    for(int i=0;i<N;i++)
    {
        Clinked* current = new Clinked;

        fin.write(current->site_name,sizeof(char)*100);
        fin.write((char*) &current->cood_x,sizeof(double));
        fin.write((char*) &current->cood_y,sizeof(double)); 
        fin.write((char*) &current->dip,sizeof(double)); 
        fin.write((char*) &current->strike,sizeof(double)); 

        //fin.write((char*) current, sizeof(Clinked));

        current->next=start;
        start=current;
    } //at this point it stops

    cout<<"\n"<<fname<<" was read succesfully";
    fin.close();
    cout<<endl;
} 
```

It's not that N is ridiculously large either; I've checked

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T02:11:40.140

正如评论中所指出的，您正在使用`write`而不是`read`. 您的代码可能会引发异常，请在引发异常时在`Debug > Exceptions`菜单中检查`Break`。

我认为您的代码应如下所示：

```
void fLoad(char* fname)
{
    fstream fin;
    fin.open(fname, fstream::in|fstream::binary);

    if(fin.fail())
    {
        cerr<<"unable to open file";
        exit(0);
    }
    cout<<"File open";

    fin.read((char*) &N, sizeof(int));
    cout<<N;
    system("pause");
    for(int i=0;i<N;i++)
    {
        Clinked* current = new Clinked;

        fin.read(current->site_name,sizeof(char)*100);
        fin.read((char*) &current->cood_x,sizeof(double));
        fin.read((char*) &current->cood_y,sizeof(double)); 
        fin.read((char*) &current->dip,sizeof(double)); 
        fin.read((char*) &current->strike,sizeof(double)); 

        //fin.read((char*) current, sizeof(Clinked));

        current->next=start;
        start=current;
    } //at this point it stops

    cout<<"\n"<<fname<<" was read succesfully";
    fin.close();
    cout<<endl;
} 
```

# browser - 在 Chrome 和 Safari 中渲染路径上的文本时出现 SVG 字体渲染问题

> ID：13850849
> 
> 赞同：3
> 
> 时间：2012-12-13T00:04:16.807
> 
> 标签：browser, svg, webkit, webfonts

我尝试在 SVG 中沿着贝塞尔曲线路径渲染一些文本：

```
 <svg xmlns="http://www.w3.org/2000/svg" version="1.1">
            <path id='menu_path' d="M 80,40 Q 200,85 245,205" stroke="none" fill="none"/>
            <text fill="white">
                <textPath xlink:href="#menu_path">News Info Presse Musik</textPath>
            </text>             
        </svg> 
```

在 Firefox 中这工作正常，但在 Chrome 和 Safari 中，文本看起来很难看（查看“Musik”）。即使我使用等宽字体并将文本设置为大写，它也不会改变。

这里是截图：

*   [http://imageshack.us/a/img18/3195/svgrendering.png](http://imageshack.us/a/img18/3195/svgrendering.png)
*   [http://imageshack.us/a/img705/7334/svgrenderingwithpath.png](http://imageshack.us/a/img705/7334/svgrenderingwithpath.png)

有人知道如何避免这种情况吗？

我创建了一个显示问题的 jsfiddle：

[http://jsfiddle.net/v6esx/](http://jsfiddle.net/v6esx/)

谢谢！

# iphone - 使用 HTML 对 iPhone 进行 Retina 媒体查询

> ID：13850850
> 
> 赞同：-1
> 
> 时间：2012-12-13T00:04:25.223
> 
> 标签：iphone, html, css

我正在尝试让视网膜在 iPhone 应用程序（HTML、CSS3 和 JS）上工作。它适用于 iphone 应用程序。

我已经尝试如下，但它不适用于以下两个 .png 图像？

HTML：

```
 <div id='slider13' class='swipe; myImage; myImage2;'>
<ul>
<li style='display:block'><div><img style="vertical-align: bottom" src="**images/10a.png**" border="0" ></div></li>  
<li style='display:block'><div><img style="vertical-align: bottom" src="images/10b.svg" border="0" ></div></li>
<li style='display:block'><div><img style="vertical-align: bottom" src="**images/10c.png**" border="0" ></div></li>
<li style='display:block'><div><img style="vertical-align: bottom" src="images/7b.svg" border="0" ></div></li>
<!-- <li style='display:none'><div><img style="vertical-align: bottom" alt="" title="" border="0" class="shadow" /></div></li> -->
</ul> 
```

CSS3：

```
.myImage {
height: 100%;
width: auto;
-webkit-background-size: 100% auto.;
background: url("../images/10a.png");
}
@media screen and (-webkit-min-device-pixel-ratio: 2), 
screen and (max-moz-device-pixel-ratio: 2), 
and screen (max-device-width: 320px) {
.myImage {
    background: url("../images/10a@2x.png");
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T00:12:57.010

Looks like it's just a syntax issue, missing the 'only'. Try:

```
@media only screen and (-webkit-min-device-pixel-ratio: 2),
       only screen and (   min--moz-device-pixel-ratio: 1.5) {

} 
```

There are some more options at [http://css-tricks.com/snippets/css/retina-display-media-query/](http://css-tricks.com/snippets/css/retina-display-media-query/)

# asp.net-mvc - MVC 4 SimpleMembership - 为什么登录后 WebSecurity.CurrentUserId -1

> ID：13850861
> 
> 赞同：8
> 
> 时间：2012-12-13T00:05:23.717
> 
> 标签：asp.net-mvc, simplemembership

我正在尝试在登录时设置一个 cookie，并且在登录后获取当前用户 ID 时遇到问题。在下面，intUserId 为 -1，WebSecurity.IsAuthenticated 为 false。这不是放置此代码的正确位置吗？在此之后，它重定向到主页......所以不知道为什么这不是正确的地方。

```
// POST: /Account/Login

        [HttpPost]
        [AllowAnonymous]
        [ValidateAntiForgeryToken]
        public ActionResult Login(LoginModel model, string returnUrl)
        {
            if (ModelState.IsValid && WebSecurity.Login(model.UserName, model.Password, persistCookie: model.RememberMe))
            {
                //TODO: set current company and facility based on those this user has access to
                int intUserId = WebSecurity.GetUserId(User.Identity.Name);
                int intUserId2 = WebSecurity.GetUserId(model.UserName);
                UserSessionPreferences.CurrentCompanyId = 1;
                UserSessionPreferences.CurrentFacilityId = 1;

                return RedirectToLocal(returnUrl);
            }

            // If we got this far, something failed, redisplay form
            ModelState.AddModelError("", "The user name or password provided is incorrect.");
            return View(model);
        } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-13T00:11:04.683

登录仅设置表单身份验证 cookie。

asp.net 身份验证的工作方式是它必须读取 cookie 来设置对请求的身份验证，但是由于在登录页面启动时 cookie 不存在，因此框架对用户一无所知。

重新加载页面，您会发现信息可用。

仅供参考，这对于 SimpleMembership 或 WebSecurity 来说并不是什么新鲜事，这是表单身份验证一直以来的工作方式。

# javascript - jQuery/javascript - 加载前获取图像大小

> ID：13850867
> 
> 赞同：5
> 
> 时间：2012-12-13T00:05:33.763
> 
> 标签：javascript, jquery

我有一个图像列表，上传后呈现为缩略图。我遇到的问题是我需要完整上传图像的尺寸，这样如果尺寸不正确，我可以运行调整大小功能。

**构建图像列表的函数**

```
function buildEditList(json, galleryID)
{
    //Hide the list
    $sortable = $('#sortable');
    $sortable.hide();

    for(i = 0, j = json.revision_images.length; i < j; i++) {
        $sortable.append(
            "<li id='image_" + json.revision_images[i].id + "'><a class=\"ui-lightbox\" href=\"../data/gallery/"
            + galleryID
            + "/images/album/"
            + json.revision_images[i].OrgImageName
            + "\"><img id=\""
            + json.revision_images[i].id
            + "\" alt=\"\" src=\"../data/gallery/"
            + galleryID 
            + "/images/album/" 
            + json.revision_images[i].OrgImageName 
            + "\"/></a></li>"
        ).hide();
    }
    //Set first and last li to 50% so that it fits the format
    $('#sortable li img').first().css('width','50%');
    $('#sortable li img').last().css('width', '50%');

    //Fade images back in 
    $sortable.fadeIn("fast",function(){
        var img = $("#703504"); // Get my img elem -- hard coded at the moment
        var pic_real_width, pic_real_height;
        $("<img/>") // Make in memory copy of image to avoid css issues
            .attr("src", $(img).attr("src"))
            .load(function() {
                pic_real_width = this.width;   // Note: $(this).width() will not
                pic_real_height = this.height; // work for in memory images.
        });
        alert(pic_real_height);
    });

} 
```

我一直在尝试使用这个[stackoverflow](https://stackoverflow.com/questions/318630/get-real-image-width-and-height-with-javascript-in-safari-chrome)帖子中的解决方案，但还没有让它工作，或者它可能只是我的代码。如果您对此有任何想法，我可以使用帮助。目前，警报返回未定义。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T00:20:59.093

有一个较新的 js 方法称为 naturalHeight 或 naturalWidth 将返回您正在寻找的信息。不幸的是，它不适用于较旧的 IE 版本。这是我几个月前创建的一个可能对你有用的函数。我在下面添加了一些代码作为示例：

```
function getNatural($mainImage) {
    var mainImage = $mainImage[0],
        d = {};

    if (mainImage.naturalWidth === undefined) {
        var i = new Image();
        i.src = mainImage.src;
        d.oWidth = i.width;
        d.oHeight = i.height;
    } else {
        d.oWidth = mainImage.naturalWidth;
        d.oHeight = mainImage.naturalHeight;
    }
    return d;
}

var img = $("#703504");
var naturalDimension = getNatural(img);
alert(naturalDimension.oWidth, naturalDimension.oHeight)​ 
```

# security - 忘记密码过程的最佳做法是什么？

> ID：13850869
> 
> 赞同：2
> 
> 时间：2012-12-13T00:05:37.607
> 
> 标签：security, passwords, forgot-password

我目前正在开发允许用户使用密码登录的 ac# Web 应用程序。我需要包含的一个功能是忘记密码功能。

忘记密码的推荐流程是什么？

我正在考虑这个：

*   用户点击忘记密码，输入邮箱地址
*   邮件已发送
*   单击电子邮件中的链接（链接仅在时间段内有效一次）
*   被带到网站并要求输入新密码（他们是否也应该回答安全问题？）
*   密码已更改，已向此类用户发送电子邮件
*   用户现在可以使用新密码登录

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T01:46:51.127

您的想法看起来很可靠，但我会添加一些其他注意事项：

*   确保您在电子邮件中生成的令牌使用的是为随机化设计的 .Net Framework 加密类，而不是看似随机但并非为此目的而设计的东西。
*   发送重置电子邮件后不要对帐户采取任何操作（否则，如果他们知道他们的电子邮件，人们将能够锁定其他人的帐户）
*   为给定的电子邮件添加每小时可以生成多少次重置的速率限制器。否则，有人可以通过以下方式对用户进行 DOS：(a) 使用 x 个错误密码来锁定帐户，然后 (b) 为他们生成重置电子邮件，速度快于电子邮件系统的发送速度。
*   在可能的情况下，请遵循其他系统，例如 OpenID。当你自己滚动时，很容易出错。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-11-16T07:28:47.090

我们有两种找回忘记密码的方法： 1\. 通过注册的邮箱 2\. 通过注册的手机号码

**注册邮箱：**

一个。要求用户提供注册的电子邮件 ID

湾。系统检查提供的电子邮件 ID 在数据库中是否可用

C。如果数据库中存在电子邮件 ID，则系统发送电子邮件以重置密码，但如果数据库中不存在电子邮件 ID，则系统显示警报消息。

d。用户在重置忘记的密码时必须提供强密码。

e. 密码重置成功，并且数据库中的电子邮件 ID 也发生了变化。

**注册手机号：**

该过程几乎与电子邮件相同，但在这种情况下，OTP 将通过注册的手机号码发送。我们需要为此集成第 3 部分 SDK，或者我们可以在 IOS 中使用 imessage。

# mysql - MySQL在多个值上选择最大值？

> ID：13850872
> 
> 赞同：3
> 
> 时间：2012-12-13T00:05:46.257
> 
> 标签：mysql

我有一张像这样的桌子：

```
file   MajorVersion MinorVersion
a      0            1
b      0            1
a      0            2
a      0            3
b      1            0
a      1            0
b      1            1 
```

我想获取每个文件的最新版本（最高主要版本的最高次要版本）。在这种情况下：

```
a 1 0
b 1 1 
```

它似乎可以通过两个连接和按文件分组，但我认为可能有更好的方法。也许通过使用拥有？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T00:08:05.217

只需要一个连接：

```
SELECT   file, MajorVersion, MAX(MinorVersion) MinorVersion
FROM     my_table NATURAL JOIN (
  SELECT   file, MAX(MajorVersion) MajorVersion
  FROM     my_table
  GROUP BY file
) t
GROUP BY file 
```

在[sqlfiddle](http://sqlfiddle.com/#!2/3a6a2/1/0)上查看。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T03:57:33.933

两种join方法是：

```
select t1.* from `table` as t1
JOIN
(
  select `file` , max(`minor`) as `minor` from `table` 
  group by `file` , `major` 
) as t2
on t1.`file` = t2.`file` and t1.`minor` = t2.`minor` and t1.`major` = t2.`major`
JOIN
(
select `file` , max(`major`) as `major` , `minor` from `table` 
group by `file`
)  as t3
on t1.`file = t3.`file` and t1.`major` = t3.`major` 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-12-11T19:08:34.320

低于 10 的次要版本的 No-JOIN 版本：

```
SELECT file, MAX(CAST(CONCAT(Majorversion, '.', MinorVersion) AS DECIMAL(5,1))) as version
FROM my_table
group by file 
```

结果：

```
file    version
a       3.0
b       1.1 
```

次要版本 >= 10 需要一些额外的格式:-)

# css - 如何设置 gmaps4rails 侧边栏的样式，并在页面上移动它？

> ID：13850874
> 
> 赞同：0
> 
> 时间：2012-12-13T00:05:59.443
> 
> 标签：css, ruby-on-rails, gmaps4rails

我想将侧边栏 UL 移动到页面上的不同位置并使其看起来不同。我尝试使用 CSS 将其浮动到地图的左侧和右侧。我能做的最好的就是将 UL 移动到地图上方而不是下方。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T20:12:32.887

这实际上比我想象的要容易得多。我遇到了一个未关闭的 div 标签创建我遇到的问题的问题。

只需使用markers_list id 创建一个Div 并应用自由CSS。

# nginx - NGINX 定位问题

> ID：13850875
> 
> 赞同：0
> 
> 时间：2012-12-13T00:06:02.700
> 
> 标签：nginx

我通过不同的端口在同一台机器上运行 django 和 flask 应用程序：

Django 在服务器上运行：8088 Flask 在服务器上运行：666

在 NGINX.conf 我有以下代码：

```
 location / {
            proxy_pass          http://127.0.0.1:8088;

        }

 location ^/server2 {
            proxy_pass http://127.0.0.1:666;
        } 
```

Django 已经在这个设置下成功运行了一年多，而烧瓶是一个新添加的。每当我尝试访问其中一个 Flask url 时，我都会收到“此服务器上不存在此 url”错误，或者有时会出现 500 错误（当我一直在摆弄时）。

如果我为特定的烧瓶 url 编写位置信息，如下所示：

```
location /server2/splash {
                proxy_pass http://127.0.0.1:666/splash;
            } 
```

它有效，但我显然不想为烧瓶应用程序中的每个 URL 编写单独的位置信息。

我已经浏览了 stackoverflow 上的许多现有 Nginx 位置帖子，但我无法让它工作。有任何想法吗？

谢谢！

**编辑**

这是我想要实现的一个示例，但不是每个 URL 的单独映射，我想要一个涵盖所有 URL 的映射：

```
 location /server2{
            proxy_pass http://127.0.0.1:666/splash;
        }

        location /server2/split {
            proxy_pass http://127.0.0.1:666/split;
        }

        location /server2/export {
            proxy_pass http://127.0.0.1:666/export;
        }

        location /server2/import {
            proxy_pass http://127.0.0.1:666/import;
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T07:20:27.600

请注意，当您使用时`location /server2`，`server2`仍然会传递给您的烧瓶应用程序。

在这种情况下，Nginx 正在执行以下操作：

```
server.com/server2 => http://127.0.0.1:666/server2
server.com/server2/splash => http://127.0.0.1:666/server2/splash 
```

在这种情况下`location`不做重写。始终检查`/var/log/nginx`（或您的日志所在的任何位置）以检查浏览器完成的请求以及 Nginx 在处理您的站点规则后查找的内容。

您可能想要的是设置一个`upstream`指令：

```
upstream flask_server {
    server 127.0.0.1:666;
}

server {
    ...

    location /server2 {
        proxy_pass http://flask_server;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T03:58:11.953

你为什么使用这个`^`标志？只需将其删除，我认为它会起作用：

```
location /server2 {
        proxy_pass http://127.0.0.1:666;
    } 
```

# xml - 无重复的 XSLT 副本

> ID：13850877
> 
> 赞同：2
> 
> 时间：2012-12-13T00:06:24.737
> 
> 标签：xml, xslt

我对 XSLT 完全陌生，所以请多多包涵。

我有两个 xml 文件，我试图使用 XSLT 将它们连接在一起。我想组合这些文件，以便第二个文件中指定的任何值都覆盖第一个文件。例如

**第一文件.xml**

```
<person>
  <person-name>Sandy</person-name>
  <person-age>21</person-age>
</person>

<person>
  <person-name>Bob</person-name>
  <person-age>15</person-age>
</person> 
```

**覆盖.xml**

```
<person>
  <person-name>Bob</person-name>
  <person-age>21</person-age>
</person> 
```

**结果：**

```
<person>
  <person-name>Sandy</person-name>
  <person-age>21</person-age>
</person>
<person>
  <person-name>Bob</person-name>
  <person-age>21</person-age>
</person> 
```

我用于连接 2 个文件的模板如下：

```
 <xsl:template match="/">
     <!-- MainFile -->
     <xsl:copy-of select="/*"/>

      <!-- Overrides-->
      <xsl:copy-of select="document($overrideFile)/*"/>
  </xsl:template> 
```

我试图设置一个 for-each 循环，以便在复制 firstFile.xml 中的每个人之前检查 override.xml 中是否有相应的节点，但不成功。

任何提示将非常感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T03:16:15.693

**这种转变**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:param name="pDoc2Url" select="'file:///c:/temp/delete/override.xml'"/>
 <xsl:variable name="vDoc2" select="document($pDoc2Url)"/>

 <xsl:template match="node()|@*">
  <xsl:copy>
   <xsl:apply-templates select="node()|@*"/>
  </xsl:copy>
 </xsl:template>

 <xsl:template match="/*">
  <t>
    <xsl:apply-templates
       select="person[not(person-name = $vDoc2/*/person/person-name)]"/>
    <xsl:apply-templates select="$vDoc2/*/person"/>
  </t>
 </xsl:template>
</xsl:stylesheet> 
```

**当应用于第一个提供的 XML 文档时**（包装到单个顶部元素中 - 将成为格式良好的 XML 文档）：

```
<t>
    <person>
        <person-name>Sandy</person-name>
        <person-age>21</person-age>
    </person>
    <person>
        <person-name>Bob</person-name>
        <person-age>15</person-age>
    </person>
</t> 
```

**并作为参数传递第二个文档（再次包装到顶部元素）所在的文件名 - 这是更正后的第二个文档**：

**c:/temp/delete/override.xml**：

```
<t>
    <person>
        <person-name>Bob</person-name>
        <person-age>21</person-age>
    </person>
</t> 
```

**产生想要的正确结果：**

```
<t>
   <person>
      <person-name>Sandy</person-name>
      <person-age>21</person-age>
   </person>
   <person>
      <person-name>Bob</person-name>
      <person-age>21</person-age>
   </person>
</t> 
```

* * *

**二、一个更短但不太灵活的解决方案——没有身份规则，也没有`xsl:apply-templates`**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:param name="pDoc2Url" select="'file:///c:/temp/delete/override.xml'"/>
 <xsl:variable name="vDoc2" select="document($pDoc2Url)"/>

 <xsl:template match="/*">
  <t>
    <xsl:copy-of
       select="person[not(person-name = $vDoc2/*/person/person-name)]"/>
    <xsl:copy-of select="$vDoc2/*/person"/>
  </t>
 </xsl:template>
</xsl:stylesheet> 
```

# windows-phone - 如何让 Windows Phone 应用程序在前台运行

> ID：13850883
> 
> 赞同：4
> 
> 时间：2012-12-13T00:06:53.037
> 
> 标签：windows-phone, windows-phone-8

我正在为 Windows Phone 8 构建一个应用程序，该应用程序的性质要求它在没有用户交互的情况下一直在前​​台运行（类似于逐向导航应用程序）。虽然我可以找到大量关于如何让应用程序在后台运行（用于位置跟踪等）的信息，但我找不到任何说明如何让应用程序在不锁定的情况下在前台运行的信息。

有谁知道这是怎么做到的？提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T02:28:09.707

您在 Windows Phone 上寻找[IdleDetection](http://msdn.microsoft.com/en-us/library/windowsphone/develop/ff941090%28v=vs.105%29.aspx)吗？

简短的回答是，您需要将[PhoneApplicationService.UserIdleDetectionMode](http://msdn.microsoft.com/en-us/library/windowsphone/develop/microsoft.phone.shell.phoneapplicationservice.useridledetectionmode%28v=vs.105%29.aspx)属性更改为已禁用。（请注意，您使用的是 UserIdleDetection 而不是 ApplicationIdleDetection）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-31T17:39:06.240

更改 IdleDetection 是一种方法，但您的应用程序可能会被停用，并且在某些情况下会被墓碑化......但是有一种更好的方法可以增加您的应用程序继续运行的机会，特别是如果您正在进行位置跟踪，请查看[Running Windows Phone 8 的后台位置跟踪应用程序](http://msdn.microsoft.com/en-us/library/windowsphone/develop/jj681691%28v=vs.105%29.aspx)

# java - Java：新对象的分配和缓存一致性

> ID：13850887
> 
> 赞同：1
> 
> 时间：2012-12-13T00:07:04.887
> 
> 标签：java, multithreading, caching

在 Java 中，假设您有两个线程 T1 和 T2 同时在两个不同的处理器 P1 和 P2 上运行。

首先，线程 T2 使用`obj`在（例如）起始内存位置 0x1000 分配的某个对象。这会导致 P2 在该内存位置内部缓存该值。T2 然后将（唯一的）对对象的引用清空，并对其进行垃圾收集。

线程 T1 然后执行

```
 Foo fooRef = new Foo();
    fooRef.x = 10; 
```

恰好它`fooRef.x`的位置也在 0x1000，因为 Foo 的这个实例被分配了重新使用上面 T2 释放的内存。

T1 然后将 fooRef 引用传递给线程 T2（通过队列或其他一些共享内存机制）。

T2 会看到以前的旧缓存值，还是会看到新值 10？

假设没有硬件缓存一致性机制。Java 本身是否确保在为对象释放或分配内存时清除每个处理器的缓存？（即使有硬件缓存一致性机制，一致性传播也不是瞬时的，如果 Java 本身没有采取其他一致性措施，T2 可能仍然会读取过时的值）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-13T00:23:36.160

如果您没有正确同步，则 T2 原则上可能会看到以下三种情况之一（不一定具有相同的概率）：

*   (a) 一个看似正确形成的对象，但包含不正确的数据；

*   (b) 一开始就没有正确形成的对象（即，别管你的数据，属于该对象的实际内务元数据不正确可见，可能导致“坏事发生”）；

*   (c) 意外地，你“躲过了子弹”，而 T2 在 T1 离开时看到了该物体。

如果您正确同步（或换句话说，正确*发布*对象），那么 T2 将看到 T1 定义的对象。在[这篇关于最终关键字的](http://www.javamex.com/tutorials/synchronization_final.shtml)文章和底部链接的进一步文章中，我讨论了一些问题和解决方案。其中一些回答了上一个关于[什么是对象发布以及我们为什么需要它的问题？](https://stackoverflow.com/questions/8019695/what-is-object-publishing-and-why-do-we-need-it)也可能有帮助。

因此，实际上[*] 一直都需要正确同步。如果您没有正确同步，尝试猜测会发生 (a)、(b) 或 (c) 中的哪种情况是危险的。

[*] 有一些非常偶然的高级技术可以安全地避免同步，如果你能真正计算出由于缺乏同步而导致的所有可能的“路径”，例如一种称为[同步捎带](http://www.javamex.com/tutorials/synchronization_piggyback.shtml)的技术，你可以有效地知道同步将是在其他地方“及时”执行。我建议你不要走这条路！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T01:17:42.030

您不会看到第一个对象留下的“垃圾”。

对象中的每个原语都将包含其初始值（`0`、`false`等）或在某个时间点放置在那里的某个值——尽管重新排序可能会产生奇怪的值混合。此外，如果原语是两个字的值（`long`或`double`），您可能只会看到其中一个字被更新：这可能会产生一个没有线程曾经放在那里的值，但它与上述一致，因为您看到的是写入该对象的效果——你只是没有看到所有的写入。但是您仍然没有看到写入对一些完全其他的随机对象的影响。

对于参考值，您将看到初始值`null`(其他线程已放入，允许重新排序等）。

现在，我实际上无法在 JLS 中找到编写此内容的确切位置。但有几个部分强烈暗示了这一点。例如，[JLS 17.4.5](http://docs.oracle.com/javase/specs/jls/se7/html/jls-17.html#jls-17.4.5)举例说明：

> 由于没有同步，每次读取都可以看到初始值**的写入或****其他**线程的写入。

 **强调我的，但请注意它列出了读取可以看到的值；它并没有说“每次读取都可以看到任何东西，包括以前对象留下的垃圾字节。”

此外，在 17.4.8 中，另一个示例指出：

> 由于读取在每个线程中首先出现，因此执行顺序中的第一个操作必须是读取。如果该读取无法看到稍后发生的写入，则**它无法看到除了它读取的变量的初始值之外的任何值。**

（再次强调我的）。请注意，尽管它是在一个示例中而不是在“主体”主体中，但它明确表示不允许按照您的描述进行垃圾读取。

然后，[JLS 17.7](http://docs.oracle.com/javase/specs/jls/se7/html/jls-17.html#jls-17.7)完全是关于 64 位原语的非原子性（我上面提到的`long`和`double`值）。同样，如果绝对不能保证您看到的字节数，那么注意到您可以从一次写入中看到一个单词而从另一次写入中看到另一个单词是没有意义的。换句话说，JLS 说您可以看到仅由一个正在更新的单词产生的“损坏”值这一事实强烈暗示您*看*不到仅由完整的剩余垃圾产生的“损坏”值.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T00:08:53.470

Java 无法访问底层硬件缓存，因此它不能“确保清除每个处理器的缓存”。

大多数现代、真实的 CPU 都提供高速缓存一致性。在某些情况下，一些真正的 CPU[需要内存屏障](http://en.wikipedia.org/wiki/MESI_protocol)。在所描述的条件下，您假设的没有硬件机制的 CPU 可能会遭受过时缓存的影响。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-13T00:18:19.597

只要对`fooRef`和的访问`fooRef.x`正确同步，线程`T2`就会看到 的最新值`fooRef.x`，即 10。**

# c++ - 为什么 const T && (rvalue reference) 不是错误

> ID：13850891
> 
> 赞同：1
> 
> 时间：2012-12-13T00:07:37.503
> 
> 标签：c++, language-lawyer, move-semantics

> **可能重复：**
> [对 const 的右值引用有什么用吗？](https://stackoverflow.com/questions/4938875/do-rvalue-references-to-const-have-any-use)

我犯的一个常见错误是使用`const T &&`它应该在的地方`T &&`。

据我所知， const T && （或 const rvalue 引用）甚至没有意义。为什么不是编译错误？当我不小心使用 const T && 时，我的移动构造函数/分配器被默默地忽略，这让我感到很沮丧。

# merge - 如何抓取和虚拟合并 wiki 文章？

> ID：13850893
> 
> 赞同：2
> 
> 时间：2012-12-13T00:07:43.510
> 
> 标签：merge, wiki, scrape, article, mediawiki-extensions

所以我们公司有大量不同部门的内部wiki站点，我正在寻找一种方法来统一它们。我们一直试图让每个人都使用同一个 wiki，但它永远不会奏效，他们一直想创建新的。作为替代方案，我想做的是抓取每个 wiki 并创建一个新的 wiki，其中包含来自每个来源的信息的组合。

在实现方面，我查看了 Nutch ( [http://nutch.apache.org/](http://nutch.apache.org/) ) 和 ( [http://scrapy.org/](http://scrapy.org/) ) 来进行网络爬取并使用 MediaWiki 作为前端。基本上我会使用爬虫作为前端来抓取每个 wiki，在中间编写一些代码（我正在考虑使用 Python 或 Perl）来理解它并创建新文章，使用它的 API 写入 MediaWiki。

不确定是否有人有类似的经验和更好的方法来做这件事，在我深入这个项目之前尝试做一些研发。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T13:22:56.650

不久前我做了一些非常相似的事情。我写了一个小 Python 脚本，它在我们的 Confluence wiki 中抓取页面层次结构，将生成的 html 页面保存在本地，并将它们转换为 DITA XML 主题以供我们的文档团队处理。

Python 是一个不错的选择——我使用 mechanize 来满足我的浏览/抓取需求，并使用 lxml 模块来理解 xhtml（它有相当多的 xml 遍历/选择方法。效果很好！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-06T12:10:35.163

*请*不要做屏幕截图，你让我哭了。

如果您只想定期将所有 wiki 合并为一个并将它们放在“单个 wiki”下，请将每个 wiki 导出到 XML 并将每个 wiki 的 XML[导入](https://www.mediawiki.org/wiki/Manual:Importing_XML_dumps)到组合 wiki 的自己的命名空间中。

如果您想更紧密地实时集成 wiki，则需要在组合 wiki 上进行[跨](https://www.mediawiki.org/wiki/Manual:$wgEnableScaryTranscluding)wiki 转入，以从远程 wiki 加载 HTML 并将其显示为本地页面。您可以在现有解决方案的基础上构建：

*   DoubleWiki[扩展](https://www.mediawiki.org/wiki/Extension:DoubleWiki)，
*   [Wikisource 的跨wiki 嵌入小工具](https://wikisource.org/wiki/MediaWiki:InterWikiTransclusion.js)。

# c++ - ifstream 在读取文件 3 次后中断

> ID：13850895
> 
> 赞同：1
> 
> 时间：2012-12-13T00:07:52.420
> 
> 标签：c++, windows, opencv, vector

我使用 .txt 文件从 .txt 文件中获取值`ifstream`。我还使用`windows`库来读取文件夹中的所有文件，即循环直到到达文件夹末尾。在这个循环中，我从 txt 文件中读取值并将其添加到使用`push_back`.

这是有问题的代码部分：

```
Mat trainme(0, dictionarySize, CV_32FC1); 
Mat labels(0, 1, CV_32FC1); //1d matrix with 32fc1 is requirement of normalbayesclassifier class

hTrain = FindFirstFile(full_path, &TrainData);
if (hTrain != INVALID_HANDLE_VALUE)
{

    ifstream file("c:\\222\\labels.txt");
    string line;

    do {

        strcpy(loc,DirSpec);

        Mat img = imread(strcat(loc,TrainData.cFileName), 0);
        cout<<"Processing file:  "<<TrainData.cFileName<<endl;

        if (!img.data){
        cout << "Image data not loaded properly:  " <<TrainData.cFileName<< endl;
        cin.get();
        }
        vector<KeyPoint> keypoints;
        features->detect(img, keypoints);
        if(keypoints.empty()) cout<<"Cannot find keypoints in image:  "<<TrainData.cFileName<<endl;
        Mat bowDescriptor;
        bowDE.compute(img, keypoints, bowDescriptor);
        trainme.push_back(bowDescriptor);
        getline(file, line);

        labels.push_back(line);

        strcpy(loc,"");
        } while( FindNextFile(hTrain,&TrainData));
} 
```

问题出现在`labels.push_back(line);`3 次循环后的线路上。我的意思是文件被读取了 3 次，然后出现错误：`Access violation writing location`. 并指向这一行`memcpy.asm`：

> ```
>  mov     [edi],al        ;U - put byte in destination 
> ```

我无法弄清楚它为什么会失败。我认为这可能是传输`string`格式的问题，所以我使用`float value = atof(line)`了但它给出了一个错误，它无法从字符串格式转换并且它只能采用旧的 c 样式字符串。

这是labels.txt中包含的内容

```
1
2
2
2
1
2
2
2 
```

谢谢你的关注。

更新：我尝试将文件读取移出主循环并使用`while(file.good())`但我仍然在同一个地方遇到同样的错误。我不知道为什么。

```
string line;
ifstream file("c:\\222\\labels.txt");
if (file.is_open())
{
    while (file.good() )
    {
    getline (file,line);
    labels.push_back(line);
    }
    file.close();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T09:08:19.287

好吧，我设法解决了... =/

问题出在这里：`labels.push_back(line);`

我认为添加`std::string`到 Mat using`push_back`是不可能的。

我通过使用将字符串转换为浮点数来解决它`atof`。

```
getline (file,line);
float label = atof(line.c_str());
labels.push_back(label); 
```

# r - 带图的层次聚类标签

> ID：13850896
> 
> 赞同：2
> 
> 时间：2012-12-13T00:07:55.617
> 
> 标签：r, plot, label, cluster-analysis, hierarchical

我有一个大约 20 个元素的距离矩阵，我用它在 R 中进行层次聚类。有没有办法用绘图或图片来标记元素，而不仅仅是数字、字符等？

因此，叶节点不是有数字，而是有小图或图片。

这就是我对这个功能感兴趣的原因。我有像这样的二维散点图（颜色表示密度）

[http://www.pnas.org/content/108/51/20455/F2.large.jpg](http://www.pnas.org/content/108/51/20455/F2.large.jpg) （注意这不是我自己的数据）

我必须分析数百个这样的二维散点图，并尝试各种距离指标，这些距离指标是我提供给 hclust 的。这个想法是快速（尽管粗略地）对二维图进行聚类以找出更大的模式，这样我们就可以最大限度地减少耗时的后续实验的数量。因此，使用适当的二维图标记树状图叶子将是理想的选择。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T02:42:02.823

有一种选择：

1.  **使用as.dendrogram**转换您的hclust
***   使用**dendrapply**通过树应用函数。该功能自定义叶子。**

 **这里有一个例子，我给我的集群上色并改变节点的结构。

```
hc = hclust(dist(mtcars[1:10,]))
hcd <- as.dendrogram(hc)
mycols <- grDevices::rainbow(attr(hcd,"members"))
i <- 0 
colLab <- function(n) {
    if(is.leaf(n)) {
      i <<- i + 1
      a <- attributes(n)
      attr(n, "nodePar") <-
        c(a$nodePar, list(lab.col = mycols[i],lab.bg='grey50',pch=sample(19:25,1)))
      attr(n, "frame.plot") <- TRUE
    }
    n
  }
clusDendro = dendrapply(hcd, colLab)
# make plot
plot(clusDendro, main = "Customized Dendrogram", type = "triangle") 
```

![在此处输入图像描述](../Images/45abc65a555e8c0f5f6bc1428388bde8.png)

# 主意：

如果您尝试自定义节点标签以将其映射到 url 链接。因此，当您单击叶子名称时，您会导航到它的图像。我认为这并不难做到。**

# asp.net - ASP.NET 和 HTML 问题

> ID：13850900
> 
> 赞同：2
> 
> 时间：2012-12-13T00:08:11.937
> 
> 标签：asp.net, html, css, cross-browser

我在转发器（ItemTemplate）中有一个带有以下标记的 div

```
<div class="bottle listing"> 
```

现在由于某种原因，这被呈现为

```
<divclass="bottle listing"> 
```

这打破了页面。这只是很少发生，如果它只发生在某些浏览器中，我无法确定。请查看此网站：

[http://www.myerwine.com.au/whites/chardonnay/4/16.aspx?page=2](http://www.myerwine.com.au/whites/chardonnay/4/16.aspx?page=2)

我在 IE8 中查看它，但有人告诉我这个页面在 Firefox 和 Chrome 中有时会损坏。在 IE 中查看源代码时，请参见第 415 行“divclass="bottle listing"

这是我的中继器的一部分：

```
<asp:Repeater ID="repResults" runat="server" OnItemDataBound="repResults_DataBound">
    <ItemTemplate>
        <div class="row listing">
            <div class="bottle listing">
                ............
            </div>
        </div>
     </ItemTemplate>
 </asp:Repeater> 
```

有任何想法吗？？

![在此处输入图像描述](../Images/39c0676687378e063138a18fe84144e7.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T01:02:45.537

实际上，真正的答案是因为我使用了空白过滤器，而这反过来又删除了错误位置的空格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T00:45:39.673

我添加了第二个空格

```
<div  class="bottle listing"> 
```

它解决了问题，如果有人能解释为什么这解决了问题，我很想听听。

# python - Python 非特定写异常

> ID：13850904
> 
> 赞同：4
> 
> 时间：2012-12-13T00:08:26.147
> 
> 标签：python, file-io, python-2.7, ioerror

目前正在自学 Python，并通过编写脚本来读取现有文件并将文本添加到现有文件来学习文件 I/O。脚本一直运行，直到我调用 write() 方法，此时它抛出了一个非特定的异常——这是回溯：

```
 File "test.py", line 13, in <module>
                f.write(txt)
            IOError: [Errno 0] Error 
```

我的代码：

```
 from sys import argv

            script, filename = argv

            f = open(filename, 'a+')

            print("The contents of %s are:") % filename

            print f.read()

            txt = raw_input("What would you like to add? ")

            f.write(txt)

            print("The new contents are:")

            print f.read()

            f.close() 
```

我的环境是 Win7、PowerShell 和 Notepad++ 中的 Python 2.7.3。

这是什么原因造成的？我将如何解决它？据我了解，`a+`访问模式应该允许我读取和附加到文件。将访问模式更改为会`r+`产生相同的异常。

**说明：**

*   我有一个现有的文本文件 (a.txt)，其中包含一个单词，我将其作为参数传递给脚本，如下所示：

    ```
     python test.py a.txt 
    ```

*   我在 Windows 的管理员帐户下。

**结果：**

至少，添加两个`seek()`命令可以解决问题 - 答案帖子中有详细说明。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T00:15:18.120

当您以模式打开文件时，由于某种原因`print f.read()`在 OS X 上对我不起作用。`a+`

在 Max OS X 上，将打开模式更改为`r+`，然后在第二次读取之前添加`f.seek(0)`一行使其工作。可悲的是，这对 Windows 没有帮助。

这是 Mac OS 上的工作代码：

```
from sys import argv

script, filename = argv

f = open(filename, 'r+')

print("The contents of %s are:") % filename

print f.read()

txt = raw_input("What would you like to add? ")

f.write(txt)

print("The new contents are:")

f.seek(0)
print f.read()

f.close() 
```

这是我可以让它在 Windows 7 上工作的唯一方法：

```
from sys import argv

script, filename = argv

f = open(filename, 'r')

print("The contents of %s are:") % filename

print f.read()
f.close()

txt = raw_input("What would you like to add? ")

f = open(filename, 'a')
f.write(txt)
f.close()
f = open(filename, 'r')

print("The new contents are:")

print f.read()

f.close() 
```

这似乎超级hacky。这也应该适用于 Mac OS X。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T00:58:07.560

尝试添加小文本时的问题：它保留在缓冲区中，在接收到更多数据后，在真正写入完成之前保留文本。
所以，为了确保真正写，按照文档中关于`os.fsync()`和`flush()`

顺便说一句，最好使用`with`语句。

并且使用二进制模式会更好。在您的情况下，应该没有问题，因为您只需在阅读后添加文本并使用`seek(o,o)`. 但是当想要将文件的指针正确移动到文件的字节中时，绝对有必要使用二进制模式 [ `'b'`in `open(filename, 'rb+')` ]

我个人从不使用`'a+'`，我从来不明白它的作用是什么。

```
from sys import argv
from os import fsync

script, filename = argv

with open(filename, 'rb+') as f:
    print("The contents of %s are:") % filename
    print f.read()

    f.seek(0,2)
    txt = raw_input("What would you like to add? ")
    f.write(txt)
    f.flush()
    fsync(f.fileno())

    f.seek(0,0)
    print("The new contents are:")
    print f.read() 
```

# scala - 从 Java 中过滤 Scala 列表

> ID：13850905
> 
> 赞同：2
> 
> 时间：2012-12-13T00:08:41.003
> 
> 标签：scala

这编译得很好，但在运行时会爆炸：

> 线程“主”java.lang.NoSuchMethodError 中的异常：scala.collection.immutable.List.filter(Lscala/Function1;)Lscala/collection/immutable/List

```
import scala.Function1;
import scala.collection.immutable.List;
import scala.collection.immutable.Nil$;
import scala.runtime.AbstractFunction1;

public class FunProc {
    List nil = Nil$.MODULE$;                      // the empty list
    List<Integer> list1 = nil.$colon$colon(1);    // append 1 to the empty list
    List<Integer> list2 = list1.$colon$colon(2);  // append 2 to List(1)
    List<Integer> list3 = list2.$colon$colon(3).$colon$colon(14).$colon$colon(8); // List(8, 14, 3, 2, 1)

    Function1<Integer, Object> filterFn = new AbstractFunction1<Integer, Object>() {
        public Boolean apply(Integer value) { return value<10; }
    };

    List<Integer> list4 = list3.filter(filterFn); // List(8, 3, 2, 1)

    public void doIt() {
        System.out.println("Filtered List is " + list4);
    }
} 
```

## 编辑

在尝试了 idonnie 的答案后，我想出了这个：

```
List<Integer> list4 = list3.toTraversable().filter(filterFn).toList(); 
```

这与 idonnie 的答案基本相同，只是使用了转换而不是转换。我仍然想知道为什么 toTraversable() 是必要的，因为以下编译得很好：

```
List<Integer> list4 = list3.filter(filterFn); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-13T01:47:22.100

为了我，

```
$ javac -cp O\:/scala-2.10.0-RC2/lib/scala-library.jar  jfilter/FunProc.java 
jfilter\FunProc.java:19: error: incompatible types
    List<Integer> list4 = list3.filter(filterFn); // List(1, 2, 3, 8)
                                      ^
  required: List<Integer>
  found:    Traversable<Integer>
Note: jfilter\FunProc.java uses unchecked or unsafe operations.
Note: Recompile with -Xlint:unchecked for details.
1 error 
```

idonnie 的 Traversable 没问题。

FWIW，scaladoc 为我们这些厌恶 IDE 的人显示“定义类”。

这可能是[java 泛型签名不一致](https://issues.scala-lang.org/browse/SI-3452)的症状，[讨论](https://groups.google.com/forum/?fromgroups=#!topic/scala-user/NfoCEmWUv6Q)和[分析没完没了](https://groups.google.com/forum/#!msg/scala-internals/K2dELqajQbg/gV0tbjRHJ4UJ)。

但`scalac -Ycheck:jvm TraversableLike.scala`不抱怨过滤器。（我对该 ML 线程的评论是“编译器在发出警告后退出 addGenericSignature”。我的解决方法是在 Scala 中添加一个强制转换以支持互操作。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T22:01:43.617

我们可以使用`FunctionN`它们及其`AbstractFunctionN`子类来执行操作，例如`filter()`对 Java 中的 Scala 列表进行操作。这是创建 Scala 列表并对其进行过滤的方法。

```
// List(8, 3, 2, 1)
List<Integer> list4a = list3.toTraversable().filter(filterFn).toList(); 
```

这种技术可以访问 trait 提供的方法`TraversableLike`，以便在列表上调用`toTraversable()`，该列表返回一个`Traversable<Integer>`实例。`filter()`然后可以调用，它返回另一个`Traversable<Integer>`实例。`Traversable`有一个方法调用`toList()`，然后将`Traversable<Integer>`实例转换回`List<Integer>`.

我不明白 som-snytt 所指的 Scala 编译器错误如何通过以下方式缓解：

```
// this produces the same result: List(8, 3, 2, 1)
List<Integer> list4b = 
    (List<Integer>) ((scala.collection.TraversableLike) list3).filter(filterFn)); 
```

`filterFn()`是`Function1`子类的一个实例`AbstractFunction1`。此实例为 Java 定义为`Function1<Integer, Object>`，这意味着它接受一个`Integer`并返回一个`Object`。用 Scala 编写的`apply()`方法定义实际上返回 a `scala.Boolean`，但 Java 执行`not know about`scala.Boolean `. Instead, we define`apply() `to return a`java.lang.Boolean 并且返回值的类型参数声明为`java.Object`。**我想了解这是如何更正确地工作的。**

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-13T00:31:04.577

通过`javap`，终于在scala.collection.TraversableLike中找到了一个过滤方法

**编辑**

编译并运行：

```
 List<Integer> list4 = (List<Integer>)
(((scala.collection.TraversableLike) list3).filter(filterFn)); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-18T11:45:30.727

这一切对我来说听起来可能很可疑。

首先，让我声明，特征的使用不应该与它有任何关系。当您使用 trait 时，Scala 会为实现这些 trait 的静态方法创建转发器，因此调用由 trait 或类定义的方法根本不会有任何区别。

其次，我认为`filter`as 给出的定义没有问题`javap`：

```
 public scala.collection.immutable.List<A> filter(scala.Function1<A, java.lang.Object>);
    flags: ACC_PUBLIC
    Code:
      stack=2, locals=2, args_size=2
         0: aload_0       
         1: aload_1       
         2: invokestatic  #1103               // Method scala/collection/TraversableLike$class.filter:(Lscala/collection/TraversableLike;Lscala/Function1;)Ljava/lang/Object;
         5: areturn       
      LineNumberTable:
        line 76: 0
      LocalVariableTable:
        Start  Length  Slot  Name   Signature
               0       6     0  this   Lscala/collection/immutable/List;
               0       6     1     p   Lscala/Function1;
    Signature: #1104                        // (Lscala/Function1<TA;Ljava/lang/Object;>;)Lscala/collection/immutable/List<TA;>; 
```

所以方法就在那里，类型签名似乎是正确的。我会把这个问题带到 scala 邮件列表中，尽管我愿意打赌已经有一些问题已经解决了。

# .htaccess - 从 OpenCart 中删除 index.php?route=

> ID：13850907
> 
> 赞同：1
> 
> 时间：2012-12-13T00:08:57.927
> 
> 标签：.htaccess, seo, opencart

我是 .NET 开发人员，但我的朋友打电话给我寻求支持。我对 .htaccess 做了一些更改，但我的 SEO 已损坏。

一切都以 url 上的“www”标签开始。我看到当我们不使用“www”时会出现一些错误，我更改了 .htaccess。我添加了重写规则并将 mysite.com 重定向到 www.mysite.com。我们的问题解决了，但现在我们有另一个问题。

我们正在使用 Opencart - SEO 并且它已启用。我们的产品看起来像

```
http://www.mysite.com/epson-claria-uyumlu-yazici-kartus-dolum-murekkebi-500g.html 
```

当我们到达 www 时。

但是，如果我删除 url 上的“www”标签，看起来就像

```
http://www.mysite.com/index.php?_route_=epson-claria-uyumlu-yazici-kartus-dolum-murekkebi-500g.html 
```

它破坏了搜索引擎优化。

我想看到第二个 url 像第一个一样。

我试过玩 seo_url.php ， .htaccess 但它不会改变任何东西。

我也尝试[过从 OpenCart 中删除 index.php?route=common/home 的](https://stackoverflow.com/questions/10813809/remove-index-phproute-common-home-from-opencart)解决方案，但它对我不起作用。

现在我的 seo_url.php 是默认的，我取回我的更改。我的 .htaccess 是

```
# SEO URL Settings
RewriteEngine On
# If your opencart installation does not run on the main web folder make sure you folder it does run in ie. / becomes /shop/ 

RewriteBase /
RewriteRule ^sitemap.xml$ index.php?route=feed/google_sitemap [L]
RewriteRule ^googlebase.xml$ index.php?route=feed/google_base [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} !.*\.(ico|gif|jpg|jpeg|png|js|css)
RewriteRule ^([^?]*) index.php?_route_=$1 [L,QSA]
RewriteCond %{QUERY_STRING} ^route=common/home$
RewriteRule ^index\.php$ http://www.mysite.com? [R=301,L]
RewriteCond %{HTTP_HOST} !^www\.mysite\.com$
RewriteRule (.*) http://www.mysite.com/$1 [R=301,L] 

RewriteRule ^(.*)$ index.php?_route_=$1 [L] 
```

请在我发疯之前帮助我。我为此花了 3 个小时。

谢谢大家，问候

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-08-25T09:17:36.633

试试这个它使用.htaccess 对我有用。

```
RewriteCond %{THE_REQUEST} \ /index\.php\?_route_=?([^&\ ]*)
RewriteRule ^ /%1? [L,R] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-02-19T21:40:29.550

也有同样的问题，我发现任何问题都没有解决我的问题。但！我记得我也在使用 Laravel 并且在这个引擎中运行良好的 url 路径。不要问我为什么将 OpenCart 与 Laravel 联系起来。所以我在*系统 -> 设置 -> 服务器*中启用了 SEO 单选按钮，你也可以禁用它我看不出网站工作有什么不同。

该解决方案由几个部分组成：

**1.**在您的根文件夹中，将*.htaccess*文件内容替换为下一个 shapshot：

```
<IfModule mod_rewrite.c>
    <IfModule mod_negotiation.c>
        Options -MultiViews -Indexes
    </IfModule>

    RewriteEngine On

    # Handle Authorization Header
    RewriteCond %{HTTP:Authorization} .
    RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]

    # Redirect Trailing Slashes If Not A Folder...
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_URI} (.+)/$
    RewriteRule ^ %1 [L,R=301]

    # Handle Front Controller...
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteRule ^(.*)$ index.php?route=$1 [L]
</IfModule> 
```

**2.**到*/system/library/url.php*找到`link`method 替换为next：

```
public function link($route, $args = '', $secure = false) {
  if ($this->ssl && $secure) {
    $url = $this->ssl . 'index.php?route=' . $route;
  } else {
    $url = $this->url . 'index.php?route=' . $route;
  }

  if ($args) {
    if (is_array($args)) {
      $url .= '&amp;' . http_build_query($args);
    } else {
      $url .= str_replace('&', '&amp;', '&' . ltrim($args, '&'));
    }
  }

  foreach ($this->rewrite as $rewrite) {
    $url = $rewrite->rewrite($url);
  }

  $url = str_replace('index.php?route=', '', $url);

  return $url; 
} 
```

由于您更改了根文件夹中的*.htaccess并更改了 url 生成方法，您还需要记住管理部分。*如果您在 admin 中看到漂亮的 url，只需**将 .htaccess 从根文件夹复制到 /admin 文件夹**。

如果你想在管理端保存原始 url，你必须稍微改变`link`下一个方法：

```
public function link($route, $args = '', $secure = false) {
  if ($this->ssl && $secure) {
    $url = $this->ssl . 'index.php?route=' . $route;
  } else {
    $url = $this->url . 'index.php?route=' . $route;
  }

  if ($args) {
    if (is_array($args)) {
      $url .= '&amp;' . http_build_query($args);
    } else {
      $url .= str_replace('&', '&amp;', '&' . ltrim($args, '&'));
    }
  }

  foreach ($this->rewrite as $rewrite) {
    $url = $rewrite->rewrite($url);
  }

  //  Skip admin path
  if (strpos($_SERVER['REQUEST_URI'], '/admin') !== 0) {
    $url = str_replace('index.php?route=', '', $url);
  }

  return $url; 
} 
```

**结果：**

*前*

`http://YOUR_SITE/index.php?route=product/product&product_id=52`

*后*

`http://YOUR_SITE/product/product&product_id=52`

*前*

`http://YOUR_SITE/index.php?route=account/login`

*后*

`http://YOUR_SITE/account/login`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T07:52:53.397

试试这个。。

```
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule .* index.php/$0 [PT,L] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-02T17:52:50.260

我知道的老问题，但也许有人会觉得它有帮助：如果您更改 HTACCESS 规则，SEO url 中断的原因是它们依赖于`_route_`澄清“是的，这是对干净 url 的请求，不，它不是标准路线”。

如果您`index.php?_route_=`在 HTACCESS 中进行更改，您还必须更改 中的`_route_`IF 条件`/catalog/controller/common/seo_url.php`。它可能会被严重迷惑，但如果你这样做，请先在测试商店尝试。

`_route_`在日志或分析日志之类的内容中，除了您之外，什么都不应该看到，因为它是一个被屏蔽的实用程序 uri。如果你看到真人在问链接是什么，那么就采取行动。否则，最好离开它。

# ruby-on-rails - 工头以代码 0 退出？

> ID：13850909
> 
> 赞同：1
> 
> 时间：2012-12-13T00:09:01.393
> 
> 标签：ruby-on-rails, sunspot, foreman

我安装了 Foreman gem，以便在每次运行我的应用程序时启动 Sunspot：

**档案：**

```
search: bundle exec rake sunspot:solr:start 
```

这是输出：

```
alex@alex-K43U:~/rails/inkleak$ foreman start
08:05:09 search.1 | started with pid 5278
08:05:35 search.1 | java version "1.6.0_24"
08:05:35 search.1 | OpenJDK Runtime Environment (IcedTea6 1.11.5) (6b24-1.11.5-0ubuntu1~11.10.1)
08:05:35 search.1 | OpenJDK Client VM (build 20.0-b12, mixed mode, sharing)
08:05:35 search.1 | Removing stale PID file at /home/alex/rails/inkleak/solr/pids/development/sunspot-solr-development.pid
08:05:35 search.1 | Successfully started Solr ...
08:05:35 search.1 | exited with code 0
08:05:35 system   | sending SIGTERM to all processes
SIGTERM received 
```

可能是什么问题呢？

（顺便说一句，当我这样做时，太阳黑子运行得很好`rake sunspot:solr:start`）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-13T23:22:12.147

该`sunspot:solr:start`任务将 Solr 分叉到后台并立即退出。这不适用于 Foreman，它假设一个长期运行的前台进程。

你想要的是`sunspot:solr:run`在前台运行 Solr，允许 Foreman 管理进程。

或者，如果我这么大胆，您也可以考虑使用[云托管的 Solr 搜索](https://websolr.com/)，例如我自己不起眼的[websolr.com](https://websolr.com)。

# javascript - Javascript getUTCDate 在选择 2013/04/01 时返回“31”作为日期？

> ID：13850911
> 
> 赞同：3
> 
> 时间：2012-12-13T00:09:07.583
> 
> 标签：javascript, date

在 javascript 中，通过使用 getUTCDate() 方法出现错误。

使用日期选择器 a 选择了日期 2013/04/01，但 getUTCDate() 为同一月份和年份返回 31。通过使用 getDate() 方法，返回数为 1。对我来说似乎是一个错误，但是......

为什么会这样？

我的 UTC+00 -- 葡萄牙

```
<script>
   function myFunction() {
     var dataToData = new Date();
     dataToData = $("#datepicker").datepicker("getDate"); //ui-jquery datepicker

     var yearDpick = "";
     var monthDpick = "";
     var dayDpick = "";

     var monthaux = dataToData.getMonth() + 1;
     var dayaux2 = dataToData.getUTCDate();
     var dayaux = dataToData.getDate();
     yearDpick += dataToData.getFullYear().toString();

      if (monthaux > 9) {
           monthDpick += monthaux.toString();
           } else monthDpick += "0" + monthaux.toString();

       if (dayaux > 9) {
          dayDpick += dayaux.toString();
          } else dayDpick += "0" + dayaux.toString();

       alert(dayaux2.toString());

       alert(yearDpick+monthDpick+dayDpick);
   }
 </script> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T00:18:31.420

因为你不住在UTC。您可能生活在 UTC+xx。如果您使用 设置日期`setDate`，请不要`getUTCDate`稍后使用。请记住，`new Date()`如果您使用字符串作为参数，则将使用您的本地时间而不是 UTC。

# java - 如何使用 compareTo 降序排列航班

> ID：13850912
> 
> 赞同：1
> 
> 时间：2012-12-13T00:09:11.013
> 
> 标签：java, hashmap, compareto

我正在创建一个飞行控制器应用程序。我想要的一些功能是能够根据特定航空公司告诉用户下一班航班是什么。我有一个存储字符串和平面的哈希图。在我的飞机类中，我正在实现 Comparable 并且我有 compareTo 方法。谁能帮我实现使用 compareTo 方法按降序排列飞机以显示下一个航班。我想通过变量过期来安排航班。

**这是我必须在 MainApp 上使用 compareTo 的情况**

```
switch (nextChoice) 
                    {
                    case 1:
                        airlineMap.printAirline("Aer Lingus");
                        break;
                    case 2:
                        airlineMap.printAirline("Brittish Airways");
                        break;
                    case 3:
                        airlineMap.printAirline("Eithad");
                        break;
                    case 4:
                        airlineMap.printAirline("Iberia");
                        break;
                    case 5:
                        airlineMap.printAirline("Quantas");
                        break; 
```

我希望将降序添加到航空公司打印中：airlineMap.printAirline("Aer Lingus");

**这是我的飞机课：**

```
import java.util.LinkedList;

public class Plane implements Comparable
{   
    private String flightNumber;
    public String airlineName;
    private double fuelRemaining;
    private int overdue;
    private int passengerNumber;
    private AIRPLANETYPE planeType;

    public enum AIRPLANETYPE
    {
        AIRBUS("1"), CORPORATE("2"), PRIVATE("3");

        private String planeName;

        private AIRPLANETYPE(String planeName)
        {
            this.planeName = planeName;
        }

        public String getPlaneName()
        {
            return this.planeName;
        }
    }

    public Plane(String flightNumber, String airlineName, double fuelRemaining, int overdue, int passengerNumber, AIRPLANETYPE planeType) {
        this.flightNumber = flightNumber;
        this.airlineName = airlineName;
        this.fuelRemaining = fuelRemaining;
        this.passengerNumber = passengerNumber;
        this.overdue = overdue;
        this.planeType = planeType;
    }

    public String getAirlineName() {
        return airlineName;
    }

    public void setAirlineName(String airlineName) {
        this.airlineName = airlineName;
    }

    public void setOverdue(int overdue) {
        this.overdue = overdue;
    }

    public int getOverdue(){
        return overdue;
    }

    public String getFlightNumber() {
        return flightNumber;
    }

    public void setFlightNumber(String flightNumber) {
        this.flightNumber = flightNumber;
    }

    public double getFuelRemaining() {
        return fuelRemaining;
    }

    public void setFuelRemaining(double fuelRemaining) {
        this.fuelRemaining = fuelRemaining;
    }

    public int getPassengerNumber() {
        return passengerNumber;
    }

    public void setPassengerNumber(int passengerNumber) {
        this.passengerNumber = passengerNumber;
    }

    public AIRPLANETYPE getPlaneType() {
        return planeType;
    }

    public void setPlaneType(AIRPLANETYPE planeType) {
        this.planeType = planeType;
    }

    public int compareTo(Object arg0) {
        if((arg0 != null) && (arg0 instanceof Plane))
        {
            Plane p = (Plane) arg0;
            return (int)Math.ceil(this.overdue - p.getOverdue());
        }
        return 0;
    }
    public String toString() {
        return "Plane: flightNumber=" + flightNumber + "."
                + " airlineName=" + airlineName + "."
                + " fuelRemaining=" + fuelRemaining + " litres."
                + " overdue=" + overdue + " minutes."
                + " passengerNumber="+ passengerNumber + "."
                + " airplaneType=" + planeType + ".\n";
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T00:16:33.857

Since `HashMap` is unordered, you have two ways of going about sorting your planes:

*   Put them into a sorted container, or
*   Put them into an `ArrayList<Plane>` or an array `Plane[]`, and sort that list or array

The first approach can be achieved with a `TreeSet<Plane>`: put your planes into the set, and iterate them in the "natural" order (i.e. the order consistent with their `compareTo` method).

The second approach requires copying the planes into a separate container or an array, and then using the `sort` method (or the `Arrays.sort` static method if it is an array) to order your planes in accordance with the order set by their `compareTo` implementation.

**EDIT :** (based on a comment) One way to deal with a problem of storing planes in a specific order inside a hash map is to make a hash map of tree sets, like this:

```
Map<String,TreeSet<Plane>> airlineMap = new HashMap<String,TreeSet<Plane>>(); 
```

Once you add the planes to each airline, they would be maintained in the order based on your `compareTo` implementation. with a `TreeSet<Plane>` in hand, you can easily find the next or the prior `Plane` by calling `higher` or `lower`.

You should use `Math.signum` rather than `Math.ceil` in your `compareTo` method.

# r - 将数据框与动物园对象相结合

> ID：13850913
> 
> 赞同：0
> 
> 时间：2012-12-13T00:09:12.903
> 
> 标签：r, zoo

我在动物园对象中有一个数据集。我正在遍历行，从中提取变量，并通过一个为每行输出一个数据框的函数运行这些变量。然后，我将这些输出数据组合到一个数据框中，该数据框中的行与我的原始动物园对象相匹配。我想将它们组合起来，将新列添加到原始动物园中。

我的数据是testZ

```
> testZ
                    X107b_pH X107b_SP X107b_temp     Sal   TApred
(06/22/12 03:00:00)   8.5124     7.32   16.16140 29.5935 2061.212
(06/22/12 04:00:00)   8.5124     7.32   15.93407 30.0677 2083.886
(06/22/12 05:00:00)   8.5124     7.32   15.76140 30.1329 2087.003
(06/22/12 06:00:00)   8.5124     7.32   15.59807 29.9522 2078.363
(06/22/12 07:00:00)   8.5124     7.32   15.46307 29.9091 2076.303
(06/22/12 08:00:00)   8.5124     7.32   15.44640 29.8565 2073.788
(06/22/12 09:00:00)   8.5124     7.32   15.44640 29.8647 2074.180
(06/22/12 10:00:00)   8.5124     7.32   15.44640 29.8568 2073.802
(06/22/12 11:00:00)   8.5124     7.32   15.47640 29.8092 2071.526
(06/22/12 12:00:00)   8.5124     7.32   15.58640 29.7966 2070.923
(06/22/12 13:00:00)   8.5124     7.32   15.60712 29.8247 2072.267 
```

和 testS（从 seacarb 包中的 carb 函数输出）

```
> testS
    flag       S        T P     pH          CO2     pCO2     fCO2        HCO3          CO3         DIC         ALK OmegaAragonite OmegaCalcite
100    8 29.5935 16.16140 0 8.5124 3.640861e-06 98.00598 97.66177 0.001327675 0.0002942433 0.001625559 0.002061212       4.618012     7.265870
101    8 30.0677 15.93407 0 8.5124 3.676374e-06 98.55170 98.20457 0.001340472 0.0002981053 0.001642254 0.002083886       4.668223     7.337512
102    8 30.1329 15.76140 0 8.5124 3.700343e-06 98.71823 98.36976 0.001344778 0.0002975873 0.001646066 0.002087003       4.656435     7.320294
103    8 29.9522 15.59807 0 8.5124 3.720354e-06 98.66681 98.31780 0.001344355 0.0002942804 0.001642355 0.002078363       4.604700     7.245624
104    8 29.9091 15.46307 0 8.5124 3.738210e-06 98.71419 98.36442 0.001345958 0.0002927887 0.001642485 0.002076303       4.579875     7.209657
105    8 29.8565 15.44640 0 8.5124 3.739859e-06 98.67915 98.32943 0.001345269 0.0002920590 0.001641068 0.002073788       4.568917     7.193862
106    8 29.8647 15.44640 0 8.5124 3.739957e-06 98.68623 98.33648 0.001345423 0.0002921536 0.001641317 0.002074180       4.570287     7.195833
107    8 29.8568 15.44640 0 8.5124 3.739863e-06 98.67941 98.32969 0.001345275 0.0002920624 0.001641077 0.002073802       4.568967     7.193934
108    8 29.8092 15.47640 0 8.5124 3.735212e-06 98.61975 98.27037 0.001343849 0.0002917330 0.001639318 0.002071526       4.564912     7.188167
109    8 29.7966 15.58640 0 8.5124 3.720121e-06 98.54050 98.19189 0.001341659 0.0002923933 0.001637773 0.002070923       4.577113     7.205942
110    8 29.8247 15.60712 0 8.5124 3.717640e-06 98.55167 98.20311 0.001341816 0.0002928703 0.001638404 0.002072267       4.584520     7.216633 
```

我试过 cbind，但它给了我一个令人费解的结果。如果我使用

```
testM=cbind(testZ,testS$pCO2) 
```

它会做我所期望的并将 pCO2 列添加到动物园对象 testZ 中。但是，如果我调用以下命令，它将不起作用。

```
> testM=cbind(testZ,testS)
Warning message:
In cbind(testZ, testS) :
  number of rows of result is not a multiple of vector length (arg 2) 
```

感谢您的任何建议。我是动物园的新手，所以很可能我错过了一些东西。

dput() 输出：

```
> dput(testZ)
structure(c(8.5124, 8.5124, 8.5124, 8.5124, 8.5124, 8.5124, 8.5124, 
8.5124, 8.5124, 8.5124, 8.5124, 7.32, 7.32, 7.32, 7.32, 7.32, 
7.32, 7.32, 7.32, 7.32, 7.32, 7.32, 16.1614, 15.9340666666667, 
15.7614, 15.5980666666667, 15.4630666666667, 15.4464, 15.4464, 
15.4464, 15.4764, 15.5864, 15.6071216666667, 29.5935, 30.0677, 
30.1329, 29.9522, 29.9091, 29.8565, 29.8647, 29.8568, 29.8092, 
29.7966, 29.8247, 2061.2124, 2083.885921, 2087.00341, 2078.363374, 
2076.30258, 2073.78755, 2074.179627, 2073.801894, 2071.525935, 
2070.923476, 2072.267056), .Dim = c(11L, 5L), .Dimnames = list(
    NULL, c("X107b_pH", "X107b_SP", "X107b_temp", "Sal", "TApred"
    )), index = structure(c(15513.125, 15513.1666666667, 15513.2083333333, 
15513.25, 15513.2916666667, 15513.3333333333, 15513.375, 15513.4166666667, 
15513.4583333333, 15513.5, 15513.5416666667), format = structure(c("m/d/y", 
"h:m:s"), .Names = c("dates", "times")), origin = c(1, 1, 1970
), class = c("chron", "dates", "times")), class = "zoo")

> dput(testS)
structure(list(flag = c(8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8), S = c(29.5935, 
30.0677, 30.1329, 29.9522, 29.9091, 29.8565, 29.8647, 29.8568, 
29.8092, 29.7966, 29.8247), T = c(16.1614, 15.9340666666667, 
15.7614, 15.5980666666667, 15.4630666666667, 15.4464, 15.4464, 
15.4464, 15.4764, 15.5864, 15.6071216666667), P = c(0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0), pH = c(8.5124, 8.5124, 8.5124, 8.5124, 
8.5124, 8.5124, 8.5124, 8.5124, 8.5124, 8.5124, 8.5124), CO2 = c(3.64086135363789e-06, 
3.67637421195346e-06, 3.70034276494183e-06, 3.72035392339414e-06, 
3.73820956050126e-06, 3.73985945475865e-06, 3.73995661519692e-06, 
3.73986300857744e-06, 3.73521210447936e-06, 3.7201209120172e-06, 
3.71764026477019e-06), pCO2 = c(98.005982410781, 98.551699365364, 
98.7182334593185, 98.6668114430222, 98.7141900061466, 98.6791533613055, 
98.6862308435365, 98.6794122638734, 98.6197523510141, 98.5405045633332, 
98.5516674237132), fCO2 = c(97.6617674560379, 98.2045735556704, 
98.3697621203092, 98.3178020344274, 98.3644164625271, 98.3294302472383, 
98.3364826465715, 98.3296882322446, 98.270372350004, 98.1918905249818, 
98.2031052068924), HCO3 = c(0.00132767523331992, 0.00134047197543355, 
0.00134477847686806, 0.00134435458599512, 0.00134595801586938, 
0.00134526939095695, 0.00134542309836435, 0.00134527501465186, 
0.00134384946047717, 0.00134165916833029, 0.00134181561030948
), CO3 = c(0.0002942433395289, 0.000298105334561092, 0.000297587342867106, 
0.000294280388575961, 0.000292788714950415, 0.000292058968639722, 
0.000292153613334272, 0.000292062431011073, 0.000291732984210706, 
0.000292393341741146, 0.000292870295328662), DIC = c(0.00162555943420246, 
0.0016422536842066, 0.00164606616250011, 0.00164235532849448, 
0.0016424849403803, 0.00164106821905143, 0.00164131666831381, 
0.00164107730867151, 0.00163931765679236, 0.00163777263098345, 
0.00163840354590291), ALK = c(0.0020612124, 0.002083885921, 0.00208700341, 
0.002078363374, 0.00207630258, 0.00207378755, 0.002074179627, 
0.002073801894, 0.002071525935, 0.002070923476, 0.002072267056
), OmegaAragonite = c(4.61801172079652, 4.66822300723876, 4.6564345684589, 
4.60469962461282, 4.57987479287612, 4.56891702268792, 4.5702869874125, 
4.56896714300747, 4.56491213342598, 4.57711290054851, 4.58452034914768
), OmegaCalcite = c(7.2658700466138, 7.33751216404482, 7.32029446048522, 
7.2456237796818, 7.20965711830326, 7.1938623694745, 7.19583268801109, 
7.19393445299217, 7.18816712299541, 7.20594221223447, 7.21663254411275
)), .Names = c("flag", "S", "T", "P", "pH", "CO2", "pCO2", "fCO2", 
"HCO3", "CO3", "DIC", "ALK", "OmegaAragonite", "OmegaCalcite"
), row.names = 100:110, class = "data.frame") 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-15T09:37:18.177

我在尝试 cbind 数据框 (x) 和动物园对象 (y) 时遇到了同样的问题。coredata(y) 产生一个允许 cbind 工作的矩阵对象。因此

```
cbind(x, coredata(y)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T00:35:00.190

动物园对象是带有“coredata”的索引，它是一个矩阵。`dput()`除非您发布' 的输出而不是控制台输出，否则我们没有任何对象。如果行号匹配这应该工作：

```
# coredata(testM) <- cbind( coredata(testZ) , data.matrix(testS) )   Wrong! 
```

我不是动物园专家，因此发布`dput`输出将有助于测试稍微不那么笨重的选项，并了解您使用 cbind( , , , ) 方法看到的内容并不令人满意。（我猜想它也会起作用。）

我正在吃我的话。尽管认为这*应该*可行，但 cbind 调用还是被调度到了 merge.zoo，所以我猜你需要有一个公共索引来合并。这最终对我有用：

```
require( chron )
cbind( testZ ,zoo(testS, order.by=as.chron( index(testZ) ) ) ) 
```

也许@G.Grothendieck 会来教育我们……希望，希望。证明中添加的注释：

```
>  str( cbind( testZ ,zoo(testS, order.by=as.chron( index(testZ) ) ) ) )
‘zoo’ series from (06/22/12 03:00:00) to (06/22/12 13:00:00)
  Data: num [1:11, 1:19] 8.51 8.51 8.51 8.51 8.51 ...
 - attr(*, "dimnames")=List of 2
  ..$ : NULL
  ..$ : chr [1:19] "X107b_pH" "X107b_SP" "X107b_temp" "Sal" ...
  Index: Classes 'chron', 'dates', 'times'  atomic [1:11] 15513 15513 15513 15513 15513 ...
  ..- attr(*, "format")= Named chr [1:2] "m/d/y" "h:m:s"
  .. ..- attr(*, "names")= chr [1:2] "dates" "times"
  ..- attr(*, "origin")= num [1:3] 1 1 1970
> names(cbind( testZ ,zoo(testS, order.by=as.chron( index(testZ) ) ) ) )
 [1] "X107b_pH"       "X107b_SP"       "X107b_temp"     "Sal"            "TApred"         "flag"          
 [7] "S"              "T"              "P"              "pH"             "CO2"            "pCO2"          
[13] "fCO2"           "HCO3"           "CO3"            "DIC"            "ALK"            "OmegaAragonite"
[19] "OmegaCalcite" 
```

# vim - Vim：多种模式的重载映射

> ID：13850914
> 
> 赞同：12
> 
> 时间：2012-12-13T00:09:20.117
> 
> 标签：vim

我使用映射到我也想在插入模式下工作的正常模式命令。这可以通过添加`<C-o>`到插入模式映射来完成：

```
nmap <C-Up> 10<Up>
imap <C-Up> <C-o>10<Up> 
```

但这意味着重复每个映射两次。为避免重复，我尝试“重载”其他一些键，然后将其用于特定于模式的部分：

```
" F12 selects prefix suitable for current mode
nmap <F12> <Nop>
imap <F12> <C-o>
" single mapping relying on "overloaded" F12 
map <C-Up> <F12>10<Up> 
```

由于某种原因，它不起作用。插入模式下的 F2 仅`<F2>`作为文本插入。知道出了什么问题以及如何解决吗？如果您可以将解决方案扩展到可视模式，则可以加分。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-13T07:18:25.003

正如 ZyX 已经指出的那样，没有`:map`适用于所有模式的单一命令，因为它大多没有意义。如果您真的想为所有模式定义映射，请同时使用`:map`and `:map!`; 见`:help map-modes`。

由于您通常只在您的`.vimrc`.

```
function! MapBoth(keys, rhs)
    execute 'nmap' a:keys a:rhs
    execute 'imap' a:keys '<C-o>' . a:rhs
endfunction
call MapBoth('<C-Up>', '10<Up>') 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-12-13T00:37:45.373

**原来的**

* * *

```
nnoremap <F2> :w<CR>
inoremap <F2> <Esc>:w<CR>a 
```

`map`有时不会为所有模式设置它。我不知道确切的原因，所以要确定我喜欢在我的配置文件中明确设置所有映射。我建议你也这样做，因为在某些情况下，由于不同的模式，你会得到意想不到的东西。这就是为什么仔细考虑您为每种特定模式所做的每次重新映射很重要的原因。

此外，支持`*noremap`命令而不是`*map`随处可见，因为递归映射是已知的错误来源，尤其是对于初学者。

最后，我不知道你想通过在可视模式下绑定文件写入来实现什么。您是否针对部分缓冲区写入（当您在可视模式下选择某些内容，然后点击此文件写入快捷方式并且只写入选定的文本时）？或者您是否希望在可视模式下写入整个文件，无论您在点击文件写入快捷方式时是否选择了任何内容？提供更多相关信息。就个人而言，无论哪种情况，视觉模式的映射都很奇怪，因为它实际上并没有缩进。将这些东西保持在正常模式下会更好。

**更新**

* * *

由于其他人已经对您的问题给出了详尽的答案，我只是认为如果加上我的 2 美分会有所帮助，但方向略有不同。通过查看您正在尝试做的事情，即在插入模式下映射涉及箭头键的导航功能，我可以推断您对 Vim 非常陌生。您可能已经知道，Vim 背后的理念是在 Vim 中工作时永远不要**触摸**鼠标——称之为**黄金法则**。

我现在要指出的是，我称之为**银法则**，它基本上是这样的：

```
noremap <Up>    <Nop>
noremap <Down>  <Nop>
noremap <Left>  <Nop>
noremap <Right> <Nop>

inoremap <Up>    <Nop>
inoremap <Down>  <Nop>
inoremap <Left>  <Nop>
inoremap <Right> <Nop> 
```

换句话说，防止自己使用箭头键（命令行模式除外）。您的手指**应该始终只**在字符键区域。Vim 是关于模式的。插入模式不适用于导航 - 它适用于**大量输入**。当您使用代码或仅使用文本（没关系）时，您大部分时间都在正常模式下 -**导航**- 浏览文件，寻找下一个着陆的位置以便编辑某些内容，添加一些内容，即做你的下一个**输入突发**，您切换到插入模式，完成后切换回正常模式以寻找更多的肉 - 像**捕食者**。:)

那么这到底是怎么回事？我只是想从一开始就引导你走向正确的方向。这样你就可以很快成为中级 Vim 用户——只需几天。为了更好地了解上述所有内容，我建议您绝对应该观看Derek Wyatt 的[Vim 新手视频教程](http://www.derekwyatt.org/vim/vim-tutorial-videos/vim-novice-tutorial-videos/)，其中他更详细地讨论了所有这些内容，并在截屏视频中展示了这些内容。他还提供了[中级](http://www.derekwyatt.org/vim/vim-tutorial-videos/vim-intermediate-tutorial-videos/)和[高级](http://www.derekwyatt.org/vim/vim-tutorial-videos/vim-advanced-tutorial-videos/)教程，当您对基础知识感到满意时，您也可以查看这些教程。

祝你快乐vimming！:)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-12-13T04:07:22.367

没有命令来定义所有模式的映射：`:map`正常、操作员挂起和可视模式（真正可视并立即选择）的映射，这在文档中明确说明。为所有模式使用相同的映射没有任何意义，尽管与移动不同的是，保存可以在具有完全相同 rhs 的所有模式中完成：

```
function s:Save()
    update
    return ''
endfunction
noremap  <expr> <F2> <SID>Save()
noremap! <expr> <F2> <SID>Save() 
```

. `noremap!`是另一个多模式映射命令，它现在涵盖了插入和命令模式。您不能从`<SID>Save()`函数（textlock）中移动光标，因此此方法不适用于光标移动命令，但您可以使用变量以避免重复相同的事情两次：

```
let s:tendownlhs='10j'
execute ' noremap <C-Down>      '.s:tendownlhs
execute 'inoremap <C-Down> <C-o>'.s:tendownlhs 
```

. 现在没有命令模式，因为这很棘手并且可能没用。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-04-24T19:06:33.653

如果映射以正常模式结束是可以的，您可以将`for`循环与`<C-\><C-n>`映射结合起来。`<C-\><C-n>`从任何模式切换到正常模式。

例如，这允许使用 Alt-{h,j,k,l} 从任何模式切换窗格：

```
for map_command in ['noremap', 'noremap!', 'tnoremap']
  execute map_command . ' <silent> <M-h> <C-\><C-n><C-w>h'
  execute map_command . ' <silent> <M-j> <C-\><C-n><C-w>j'
  execute map_command . ' <silent> <M-k> <C-\><C-n><C-w>k'
  execute map_command . ' <silent> <M-l> <C-\><C-n><C-w>l'
endfor 
```

*   `noremap`正常、可视和操作员待定模式下的地图
*   `noremap!`插入和命令模式下的映射
*   `tnoremap`Neovim 终端模式下的地图

# objective-c - CoreData、瞬态属性和 EXC_BAD_ACCESS。

> ID：13850917
> 
> 赞同：0
> 
> 时间：2012-12-13T00:09:50.687
> 
> 标签：objective-c, core-data

我正在尝试构建简单的文件浏览器，但我被卡住了。我定义了类，构建窗口，添加控制器，视图..一切正常，但只有一次。在 NSTableView 中再次选择 Folder 或尝试从 Folder.files 获取数据，导致来自 main 的静默 EXC_BAD_ACCESS (code=13, address0x0)。

关于我保留在 CoreData 之外的文件的信息，在简单的类中，我不想保存它们：

```
#import <Foundation/Foundation.h>

@interface TPDrawersFileInfo : NSObject
@property (nonatomic, retain) NSString * filename;
@property (nonatomic, retain) NSString * extension;
@property (nonatomic, retain) NSDate * creation;
@property (nonatomic, retain) NSDate * modified;
@property (nonatomic, retain) NSNumber * isFile;
@property (nonatomic, retain) NSNumber * size;
@property (nonatomic, retain) NSNumber * label;

+(TPDrawersFileInfo *) initWithURL: (NSURL *) url;
@end

@implementation TPDrawersFileInfo
+(TPDrawersFileInfo *) initWithURL: (NSURL *) url {
    TPDrawersFileInfo * new = [[TPDrawersFileInfo alloc] init];
    if (new!=nil) {
        NSFileManager * fileManager = [NSFileManager defaultManager];

        NSError * error;
        NSDictionary * infoDict = [fileManager attributesOfItemAtPath: [url path]  error:&error];

        id labelValue = nil;
        [url getResourceValue:&labelValue forKey:NSURLLabelNumberKey error:&error];
        new.label = labelValue;

        new.size = [infoDict objectForKey: @"NSFileSize"];
        new.modified = [infoDict objectForKey: @"NSFileModificationDate"];
        new.creation = [infoDict objectForKey: @"NSFileCreationDate"];
        new.isFile = [NSNumber numberWithBool:[[infoDict objectForKey:@"NSFileType"] isEqualToString:@"NSFileTypeRegular"]];
        new.extension = [url pathExtension];
        new.filename = [[url lastPathComponent] stringByDeletingPathExtension];

    }
    return  new;
} 
```

接下来我有类文件夹，它是 NSManagesObject 子类

```
// Managed Object class to keep info about folder content

@interface Folder : NSManagedObject {
    NSArray * _files;
}
@property (nonatomic, retain) NSArray * files; // Array with TPDrawersFileInfo objects
@property (nonatomic, retain) NSString * url;  // url of folder

-(void) reload; //if url changed, load file info again.

@end
@implementation Folder

@synthesize  files = _files;
@dynamic url;

-(void)awakeFromInsert {
    [self addObserver:self forKeyPath:@"url" options:NSKeyValueObservingOptionNew context:@"url"];
}

-(void)awakeFromFetch {
    [self addObserver:self forKeyPath:@"url" options:NSKeyValueObservingOptionNew context:@"url"];
}
-(void)prepareForDeletion {
    [self removeObserver:self forKeyPath:@"url"];
}

-(void) observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary *)change context:(void *)context {
    if (context == @"url") {
        [self reload];
    }
}

-(void) reload {
    NSMutableArray * result = [NSMutableArray array];
    NSError * error = nil;
    NSFileManager * fileManager = [NSFileManager defaultManager];
    NSString * percented = [self.url stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding];
    NSArray * listDir = [fileManager contentsOfDirectoryAtURL: [NSURL URLWithString: percented]
                                   includingPropertiesForKeys: [NSArray arrayWithObject: NSURLCreationDateKey ]
                                                      options:NSDirectoryEnumerationSkipsHiddenFiles
                                                        error:&error];

    if (error!=nil) {NSLog(@"Error <%@> reading <%@> content", error, self.url);}

    for (id fileURL in listDir) {
        TPDrawersFileInfo * fi = [TPDrawersFileInfo initWithURL:fileURL];
        [result addObject: fi];
    }

    _files = [NSArray arrayWithArray:result];

}

@end 
```

在我定义的应用程序委托中

```
@interface TPAppDelegate : NSObject <NSApplicationDelegate> {
    IBOutlet NSArrayController * foldersController;
    Folder * currentFolder;
}
- (IBAction)chooseDirectory:(id)sender; // choose folder 
```

和

```
- (Folder * ) getFolderObjectForPath: path {
     //gives Folder object if already exist or nil if not
.....
}

- (IBAction)chooseDirectory:(id)sender {
    //Opens panel, asking for url
    NSOpenPanel * panel = [NSOpenPanel openPanel];
    [panel setCanChooseDirectories:YES];
    [panel setCanChooseFiles:NO];
    [panel setMessage:@"Choose folder to show:"];
    NSURL * currentDirectory;

    if ([panel runModal] == NSOKButton)
    {
        currentDirectory = [[panel URLs] objectAtIndex:0];
    }

    Folder * folderObject = [self getFolderObjectForPath:[currentDirectory path]];

    if (folderObject) {
        //if exist:
        currentFolder = folderObject;
    } else {
        // create new one
        Folder * newFolder = [NSEntityDescription
                              insertNewObjectForEntityForName:@"Folder"
                              inManagedObjectContext:self.managedObjectContext];
        [newFolder setValue:[currentDirectory path] forKey:@"url"];
        [foldersController addObject:newFolder];
        currentFolder = newFolder;
    }
    [foldersController setSelectedObjects:[NSArray arrayWithObject:currentFolder]];

} 
```

请帮忙 ;）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T11:00:04.983

哈！

```
_files = [NSArray arrayWithArray:result]; 
```

应该：

```
_files = [[NSArray arrayWithArray:result] retain]; 
```

# validation - 服务器端验证

> ID：13850919
> 
> 赞同：5
> 
> 时间：2012-12-13T00:09:57.203
> 
> 标签：validation, dbcontext, breeze

我无法弄清楚如何将服务器端`DbContext`验证错误返回给客户端。我知道 Breeze 有默认验证器，可以对一些属性做出反应，例如`Required`，但是所有其他属性呢？我可以为 Breeze 编写一个自定义 JavaScript 验证器，它将在客户端进行检查，但我还需要检查以确保实体在服务器端有效。

例如，应用程序需要`Person`一个有效的电子邮件地址。恶意用户出现并通过客户端获取电子邮件地址，并将无法通过`EmailAddress`验证器的数据发布到服务器。到目前为止，我对 Breeze 的体验是电子邮件地址将保存并且不会出现任何`DbContext`实体框架错误。

假设下面的模型，获得任何实体验证错误的最佳方法是什么？

```
public class PeopleContext : DbContext
{
    public PeopleContext()
        : base("name=ConnectionString"){ }

    public DbSet<Person> People { get; set; }
}

public class Person
{
    public int PersonId { get; set; }
    public string FirstName { get; set; }
    [Required]
    public string LastName { get; set; }
    [EmailAddress]
    [Required]
    public string Email { get; set; }
} 
```

更新 1：

以下是重新创建我遇到的问题的一些说明。

1.  按照说明创建“Todo”示例 ( [http://www.breezejs.com/documentation/start-nuget](http://www.breezejs.com/documentation/start-nuget) )
2.  在文件中添加一个新的自定义验证器`BreezeSampleTodoItem.cs`：

    ```
    [AttributeUsage(AttributeTargets.Property)]
    public class CustomValidator : ValidationAttribute
    {
        public override Boolean IsValid(Object value)
        {
            string val = (string)value;
            if (!string.IsNullOrEmpty(val) && val == "Error")
            {
                ErrorMessage = "{0} equal the word 'Error'";
                return false;
            }
            return true;
        }
    } 
    ```

3.  使用新的自定义验证器装饰该`Description`字段：

    ```
    [CustomValidator]
    public string Description { get; set; } 
    ```

4.  当然添加正确`using`的 s (`System`和`System.ComponentModel.DataAnnotations`)。

5.  运行项目。
6.  在描述字段之一中键入“错误”并保存。

这是我希望看到 Breeze 出现错误的地方，甚至`DbEntityValidationException`是 Entity Framework 抛出的错误。我已经在 2 台不同的计算机上尝试过，结果相同。实体保存到数据库中，就好像没有错误一样。事实上，如果你`IsValid`在自定义验证器的方法内的任何地方放置一个断点，你会看到它甚至没有被调用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-16T08:42:33.207

从 Breeze v 0.78.1 开始，所有已注册的 DbContext 服务器端验证现在都将在 EntityManager SaveChanges 调用期间执行。遇到的任何异常都会导致保存回滚，并且任何验证错误都会被序列化回 Breeze 客户端。

请注意，旧的基于 ObjectContext（相对于 DbContext）的 EF 模型尚不支持此功能。

并且...感谢 adamlj 发现此问题并提出解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T07:35:38.137

我不确定你的意思

> *将服务器端 DbContext 验证错误返回给客户端*

您可能意味着您希望将验证错误消息发送到客户端。但是您的问题的其余部分表明您想知道（a）如何在服务器上运行自定义验证，以及（b）如何在客户端获取和运行该验证的相应 JavaScript 版本。我将解决您的问题的这种解释。

***服务器***

实体框架（您在示例中使用）会自动为您运行*数据注释*验证规则......除非您手动禁用了该功能。如果您以正确的方式创建***自定义***验证规则，EF 也会运行这些规则。[Daniel Wertheim 的这篇文章](http://daniel.wertheim.se/2009/11/20/entity-validaton-using-custom-data-annotation-attributes/)描述了如何编写这样的规则。我不能保证那个帖子的每一个细节，但对我来说似乎是正确的。它甚至定义了一个自定义的电子邮件验证属性！

如果编写自定义数据注释验证规则对您来说太巴洛克（就像它对我经常做的那样），您可以使用“[服务器端拦截](http://www.breezejs.com/documentation/server-side-interception)`BeforeSave...`”中讨论的方法之一编写和调用自己的验证逻辑。

我认为这些是您最好的服务器选择。到客户端...

***客户***

Breeze 注册客户端 JavaScript 验证以匹配元数据中的某些服务器端*数据注释*（例如，`Required`和`MaxLength`）。正如我所写的那样，***自定义****数据注释*既不被识别也不包含在元数据中，并且它们在客户端上没有开箱即用的类似物。如果您希望客户端使用这些规则预先筛选您的实体，您必须编写自己的相应 JavaScript 验证器并将它们注册为相关的实体类型，如[验证](http://www.breezejs.com/documentation/validation)文档页面中所述。

如果您有建议或更好的选择，我们很乐意听到。

# c# - 2 次调用或一次调用 sql server

> ID：13850921
> 
> 赞同：6
> 
> 时间：2012-12-13T00:10:19.330
> 
> 标签：c#, sql-server, stored-procedures, transactions

我在我的 .net 应用程序中有一个操作，它在 2 个不同的 sql 服务器表中创建了一条记录。这里的最佳做法是什么？

一个存储过程应该创建两个记录吗？或者是否应该使用不同的存储过程在适用的数据库中创建每条记录并将两个调用包装在一个事务中，这样如果一个调用失败，那么两个调用都会失败？

哪个性能更高？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T01:00:27.350

存储过程肯定会更高效。它还将导致您必须在服务器端编写的代码更少。缺点是，您现在需要知道如何自己编写 SQL，或者让与您一起工作的 DBA 可以为您编写 SQL。

关于您的另一个问题，它将是 1 个存储在两个表中的过程。

另一件需要考虑的事情：如果你必须在整个代码中做很多这样的事情，那么学习一个好的 ORM 并在代码中完成这一切可能是值得的（选项 2）。但如果这是你只在少数几个地方做的一次性事情，那么存储过程将是一种更聪明的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T03:55:14.247

最好将您的逻辑放在 SQL Server 中的存储过程中并定义事务范围，当在 .net 应用程序中触发的此操作在存储过程中执行您的操作时，如果这两个操作成功完成，则提交事务，否则此事务将滚动-背部。因为通过这种方式，您可以获得更好的性能。根据 Microsoft 文档使用存储过程有一些好处，如下所示：

*   执行计划保留和重用
*   查询自动参数化
*   业务规则和策略的封装
*   应用模块化
*   在应用程序之间共享应用程序逻辑
*   访问既安全又统一的数据库对象
*   一致、安全的数据修改
*   网络带宽节约
*   支持系统启动时自动执行
*   增强的硬件和软件功能
*   提高安全性
*   降低开发成本并提高可靠性
*   用于常见例程的集中式安全、管理和维护

# javascript - 鼠标/键盘事件全屏html5视频（javascript/jquery）

> ID：13850924
> 
> 赞同：1
> 
> 时间：2012-12-13T00:10:46.737
> 
> 标签：javascript, jquery, html, video, fullscreen

是否可以使用 webkitRequestFullScreen 在全屏视频元素上设置 onmouseup、onmousedown、onclick 等功能？我在创建元素时为元素注册了它们，但是当视频全屏时，我似乎没有得到事件。

另外，当我移动鼠标时，是否可以在全屏模式下停止出现视频进度条？

欢迎任何答案，使用 jquery 或 javascript，或类似的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-21T08:12:18.130

终于找到了一种在 Chrome 中执行此操作的方法：使用并调用它而不是 for + 包装你的`video`元素将需要一些额外的魔法。HTML 代码片段：`div``webkitRequestFullScreen()``div``video`

```
<div id="video-container" style="background-color: #000000;" onclick=divClicked()>
    <video id="myvideo">Video not supported!</video>
</div> 
```

JavaScript 代码片段：

```
function doFullscreen() {
    var container = document.getElementById("video-container");

    if (container.requestFullscreen) {
        container.requestFullscreen();
    } else if (container.mozRequestFullScreen) {
        container.mozRequestFullScreen();
    } else if (container.webkitRequestFullscreen) {
        container.webkitRequestFullscreen();
    }

    var video = document.getElementById("myvideo");

    // have to resize the video to fill the whole screen
    video.width=window.screen.availWidth;
    video.height=window.screen.availHeight;
} 
```

这种方法允许处理鼠标/等。`div`元素中的事件- 参见`onclick`上面 HTML 示例中的声明。另请注意，这种方法不会强制视频控件以全屏或窗口模式显示。

对于关于进度条的第二个问题，您可以在 CSS 中添加以下内容：

```
video::-webkit-media-controls-enclosure {
  display:none;
} 
```

但再次注意，使用上述方法时不需要它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-28T14:57:43.537

我也找不到在全屏上收听鼠标事件的方法，但我找到了一种解决方法：

我没有将视频全屏显示，而是将视频 CSS 更改为：

```
position: fixed;
left: 0px;
top: 0px;
width: 100%;
height: 100%;
z-index: 999; 
```

然后视频的行为就像全屏显示一样，一切正常。

# wordpress - Wordpress 插件：如何添加自定义 SEO 友好的 URL 句柄

> ID：13850933
> 
> 赞同：5
> 
> 时间：2012-12-13T00:11:19.807
> 
> 标签：wordpress, permalinks, custom-url

我想知道是否可以在插件中使用永久链接设置，而不是使用默认的非永久链接 url。

例如我正在使用插件 flickr photostream 可以从这里下载[http://wordpress.org/extend/plugins/flickr-photostream](http://wordpress.org/extend/plugins/flickr-photostream)，它是由其他人编写的，但我想知道我自己的插件和补丁这个是为了创建更好的永久链接，而不是`http://www.domain.co.uk/?flickrps=2`在页面之间前进和后退。

有人向我建议了这个 url，我试图将它修补到上面的插件中，但没有任何运气来实现我所追求的。

Wordpress 插件：如何添加自定义 URL 句柄

我设法通过谷歌找到了这个，看起来很容易做到，但没有得到我期望的结果。[http://gabrielharper.com/blog/2012/09/wordpress-custom-urls-for-plugins/](http://gabrielharper.com/blog/2012/09/wordpress-custom-urls-for-plugins/)

而不是`http://www.domain.co.uk/?flickrps=2`我希望 url 类似于`http://www.domain.co.uk/page/2`.

遗憾的是，我想使用的上述链接不起作用并给出错误 404，但其中带有问号的链接确实有效，但我不想使用这些。

我知道这是由 WordPress 拍摄的，但在这样的事情之后，也许照片会更好。

```
add_action('parse_request', 'addFlickrPhotostreamURL');
function addFlickrPhotostreamURL() {
    global $flickrpsp;

    // Manually parse the URL request
    if (!empty($_SERVER['REQUEST_URI'])) {
        $urlvars = explode('/', $_SERVER['REQUEST_URI']);
    }

    // Check for querystring variables
    if ((!empty($urlvars[1])) && (!empty($urlvars[2]))) {
        $_REQUEST['page'] = $urlvars[1];
        $_REQUEST['flickrpsp'] = $urlvars[2];

        $flickrpsp = $urlvars[2];
    }

    // ... handle multiple types of URL by checking $urlvars[1] here
} 
```

您可以在此处查看整个文件的代码[http://pastebin.com/cPhzrJBF](http://pastebin.com/cPhzrJBF)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T10:19:14.330

`.htaccess`您可以通过在文件中创建规则轻松实现此目的。例如，可以使用将 URL 重定向`http://www.domain.co.uk/?flickrps=2`到`http://www.domain.co.uk/page/2`以下规则：

```
RewriteEngine on
RewriteRule ^page/([0-9]+)/$ ?flickrps=$1 
```

参考：[htaccess url 重写](http://viralpatel.net/blogs/21-very-useful-htaccess-tips-tricks/)

# ruby-on-rails - rails 是否创建了新的 params[:model] 哈希？

> ID：13850934
> 
> 赞同：2
> 
> 时间：2012-12-13T00:11:32.930
> 
> 标签：ruby-on-rails, backbone.js

我想检查我所看到的行为是否确实是我认为的那样。

我已经用谷歌搜索了答案，但找不到任何确认这是预期行为的文档。

我正在使用 Backbone 0.9.2.1 和 Rails 3.2.3

当我将模型保存在主干中时，我正在查看 HTTP 标头并看到它发送 JSON 表示，例如

```
{"title":"I think...","id":2,...} 
```

在控制器内部，我一直心不在焉地使用 params[:opinion] 奇怪的是工作正常，但现在我遇到了麻烦，我注意到我的 params 哈希实际上是

```
{"title" => "I think...",
"id" => 2
"opinion" => {"title" => "I think ..."},
... 
```

（我遇到问题的原因是 id 存在于 params[:id] 而不是 params[:opinion][:id]

在我看来，在调用控制器方法之前，任何与 attr_accessible 名称匹配的参数都会映射到这个 params[:opinion] 哈希中。

模型当然是 Opinion。控制器称为 opinion_controller 并通过以下路线到达：

```
 resources :stories, :controller => 'opinions' 
```

（在重命名一些东西的过程中）

这是预期的行为吗？有人可以指出我可以阅读的文档吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T08:13:43.857

是的，我遇到了同样的事情，想知道wtf。如您所见，Rails 会自动包装它。变化： [https ://github.com/rails/rails/pull/359](https://github.com/rails/rails/pull/359)

**编辑：** 来自 API 文档： [http ://api.rubyonrails.org/classes/ActionController/ParamsWrapper.html](http://api.rubyonrails.org/classes/ActionController/ParamsWrapper.html)

`By default, if you don’t specify the key in which the parameters would be wrapped to, ParamsWrapper will actually try to determine if there’s a model related to it or not.`

这个答案也很好地描述了它： [https ://stackoverflow.com/a/9134057/341692](https://stackoverflow.com/a/9134057/341692)

# php - best choice of database for php

> ID：13850937
> 
> 赞同：3
> 
> 时间：2012-12-13T00:12:01.883
> 
> 标签：php, mysql

My project is a **HTTP chat** using some **Jquery, PHP and Mysql**.

Jquery infact **polls the database every N seconds** to check if I have receieved new messages (polling form a mysql table).

Since chat has now >100 connections, mysql gets now 100 requests within N seconds.

What are **the best practices**, database choice to optimize it ? (it must remain an HTTP chat without using some server sockets)

regards

PS. Maybe MYSQL is not the good choice

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T00:46:49.433

MySQL 作为数据库很好，但您对它的轮询使用并不是最佳实践。
RDBMS 是该工作的错误工具。

查看**消息队列**解决方案。以下是一些资源：

*   [消息队列：入门 - 2012 年秋季国际 PHP 会议](http://www.slideshare.net/mwillbanks/message-queues-a-primer-international-php-conference-fall-2012)
*   [齿轮人](http://gearman.org/)
*   [豆茎D](http://kr.github.com/beanstalkd/)
*   [内存缓存Q](http://memcachedb.org/memcacheq/)
*   [兔MQ](http://www.rabbitmq.com/)
*   [阿帕奇 Qpid](http://qpid.apache.org/)
*   [Apache ActiveMQ](http://activemq.apache.org/)
*   [零MQ](http://www.zeromq.org/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T00:17:02.567

我会选择 MySql，因为它的重量很轻。PHP 和 MySql 相处得很好。由于您将对数据库进行多次更新和多次读取，因此 InnoDB 引擎将最适合这种情况。如果您选择 MyIsam，您可能会遇到问题，因为它一次只适合一项工作（更新或阅读）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-13T00:16:25.327

Look into in-memory databases. Chats are normally not something people persist; so a transient database might be just the ticket. For instance, [SQLite can do it](http://www.sqlite.org/inmemorydb.html).

However, I'd be much more worried about your web server, I think. :)

Any particular reason not to use sockets? This scenario is what they're created for. (Probably inflexible hosting service?)

# microsoft-metro - Draw a line in C# for metro app

> ID：13850940
> 
> 赞同：1
> 
> 时间：2012-12-13T00:12:42.713
> 
> 标签：microsoft-metro, drawing, line

I am trying to draw a line in a windows 8 app in c#. However, when I try to use

`Line myLine = new Line();` it does not work and tells me the namespace does not exist.

Using `LineGeometery myLine = new LineGeometery ();` does appear to create a new line and I can set the start and end points. However, as I cannot set the stroke, I really do not know if this is the correct approach. In fact, I am unsure on the difference between LineGeometery() and Line().

If anyone could help, that would be very appreciated.

```
<code>using System;

using System.Collections.Generic;

using System.IO;

using System.Linq;

using Windows.Foundation;

using Windows.Foundation.Collections;

using Windows.UI.Xaml;

using Windows.UI.Xaml.Controls;

using Windows.UI.Xaml.Controls.Primitives;

using Windows.UI.Xaml.Data;

using Windows.UI.Xaml.Input;

using Windows.UI.Xaml.Media;

using Windows.UI.Xaml.Navigation;</code> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-13T07:36:40.080

请在您的应用程序中添加以下使用。Windows.UI.Xaml.Shapes

Line 类位于 Windows.UI.Xaml.Shapes 命名空间中。

这是我用来向名为 LayoutRoot 的网格添加一条线的代码部分

```
Line line = new Line();
line.X1 = 10;
line.X2 = 200;
line.Y1 = 10;
line.Y2 = 200;
line.Stroke = new SolidColorBrush(Colors.Red);
LayoutRoot.Children.Add(line); 
```

# reporting-services - 显示在 SSRS 的矩阵报告中显示为列标题而非空白的总计

> ID：13850948
> 
> 赞同：0
> 
> 时间：2012-12-13T00:13:34.613
> 
> 标签：reporting-services, expression, sql-server-2012

好的，让我们来解决我遇到的问题，看看是否有人可以帮助我。我正在 SSRS 2012 (VS 2010) 中创建一个矩阵报告。我选择折叠列组并将列的默认“可见性”设置为“隐藏”，并且可以通过文本框进行切换。现在我有了包含状态的行和包含值字段的数据字段。现在 SSRS 的默认设置是在“列组”折叠时汇总数据字段。

第 1 部分问题：

太好了，但是我想说：“总计”而不是显示空白。当我将表达式应用于该字段时

```
=IIF(Fields!Code.Value = "", "Totals", Fields!Code.Value) 
```

然后它仅将其应用于我展开的列，而不是总计的父组标题。任何想法如何解决这个问题？

第 2 部分问题：

如果您的数据集的一部分没有您在集合中指定的列，SSRS 的默认设置是显示空白单元格和空白标题。您可以通过单击“列分组”属性轻松解决此问题。单击可见性并将“报告最初运行时：”更改为如下表达式：

```
=IIF(IsNothing(Fields!Code.Value), false, true) 
```

现在我已经摆脱了我的空白标题和单元格，但现在我在折叠时的主要分组现在已经消失了。

我想要的只是我的数据：

折叠

地点|总数

铝|2

AZ|1

或|

西澳|7

扩大

地点|A|B

铝| |2

AZ|1 |

或| |

西澳|5 |2

分组的默认设置是这样的：

地点|(空白)

铝|2

AZ|1

或|

西澳|7

扩大

地点|(空白栏)|A|B

铝| | |2

AZ| |1|

或| | |

西澳| |5|2

您可以为此示例制作一个简单的测试数据示例，使用您选择的任何数据源加载 SSRS，并为此示例填充一个表变量：

```
declare @Temp table ( Place char(2), Code char(1), Value int)

insert into @Temp values ('AZ', 'A', 1), ('AL', 'B', 2), ('WA', 'A', 5),('WA','B',2),('OR', null, null)

select *
from @Temp 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T17:34:07.960

好的，所以基本上我搜索了互联网，发现 SSRS 想要它不能等同于存在的东西。EG：具有空值的标题是问题所在，因为 SSRS 假定您不希望有值的空值，因此当您计算总计时，它希望显示未知数。不过，您可以在后端欺骗它，但这需要一些工作。

基本上用最简单的术语来说，您希望收集数据并将空值标识为零，以便可以识别它们。因此，我做了一个网格布局，将空值显示为 CTE 中的零，然后我采用该 CTE 并将其取消旋转以恢复我最初拥有的内容。然而，关键的区别是现在 null 的值被表示为零。你可能会说：“但是你的网格上会出现零，我为什么要这样呢？” 好吧，您也可以在 SSRS 中执行一些格式化原则来欺骗它。

让我们看一下上面的示例并更改一些内容以显示整个过程是如何工作的，我还将添加颜色背景表达式格式，因为这也是有人想要的。

_1。让我们使用我们的代码并展示我们数据集的前后对比。

SQL 代码

```
declare @Temp table ( Place char(2), Code char(1), Value int)

insert into @Temp values ('AZ', 'A', 1), ('AL', 'B', 2), ('WA', 'A', 5),('WA','B',2),('OR', null, null)

select *
from @Temp
order by Place
;

with a as 
    (
    Select 
        Place
    ,   sum(Case when Code = 'A' then Value else 0 end) as A
    ,   sum(Case when Code = 'B' then Value else 0 end) as B
    from @Temp
    group by Place
    )
select
    Place
,   Code
,   Value
from a
unpivot(Value for Code in (A, B)) as unpvt1
order by Place 
```

_2。忽略第一组，但在 SSRS 报告中使用第二组（从 @Temp order by Place 中删除 select *）作为您的数据集

_3。设置矩阵报表，其中 Place 为行，Code 为列，Value 为数据

_4。如果现在没有任何内容，则设置一个表达式以隐藏列，方法是右键单击“列组”（应该是代码显示示例）>单击组属性>单击可见性>单击第一部分下的功能选项卡：（您也可以切换如果你想要，就像我在另一个文本单元格上所做的那样）

=IIF（IsNothing（字段！Code.Value），假，真）

_5。单击“代码”列，然后单击其上方的灰色条。单击右侧的插入列，然后用“总计”填充标题，用“[Sum(Value)]”填充单元格，为您提供总计。如果汇总到位，我一生都无法得到一个表达式来显示总计标题不同。此方法仅显示折叠或未折叠的总数。

_6。现在，如果您预览可能会显示零，我们不希望在所有情况下都这样，所以让我们稍微操作一下文本值。右键单击“代码”下的“值”，然后选择“文本框属性”。单击左侧窗格中的“数字”。选中“将零显示为：”复选框并选择“”（无）。现在你的零已经消失了。

_7。现在我有了我最初想要的东西，但想根据标题显示的内容对单元格进行动态颜色编码。获取代码标题下单元格值的属性，然后选择“背景颜色”>点击下拉菜单并选择表达式。放入这个表达式：

=IIF（字段！Code.Value = “A”，“小麦”，IIF（字段！Code.Value = “B”，“LightBlue”，“White”））

我现在可以得到一些东西，由于某种原因，互联网上的大多数人听起来几乎不可能。我可以将我的列设置为一致的颜色，因为定位现在与一个值相关联，该值作为零存在但现在对最终用户隐藏。

但你可能会说：“很好，但我想要的是货币价值而不是简单的整数”。我也可以这样做。点击“代码”下的“值”单元格的属性，然后查看“格式”属性。它应该默认为：

0.00;(0.00);''

如果您想要钱，请改为：

$###,##0;0.00,''

我希望这对某人有所帮助，如果您说：“这对于小型数据集来说非常有用，但我有一百万或更多行我想做类似的事情。” 好吧，我会将我的 cte 替换为临时表或永久表，然后将您的数据转储到内存或永久表中以首先对其进行按摩。

# php - 设置的最大 cURL 连接数是多少？

> ID：13850951
> 
> 赞同：15
> 
> 时间：2012-12-13T00:13:45.280
> 
> 标签：php, apache, curl

我有一个脚本，它使用 PHP 中的 curl_multi_* 函数运行 1000 个 cURL 请求。

他们超时背后的瓶颈是什么？

会不会是CPU使用率？就服务器如何处理该数量的出站连接而言，是否有更有效的方法来执行此操作？

我无法更改功能，请求本身就是对远程 API 的简单调用。我只是想知道限制是什么——我需要增加服务器上的内存、Apache 连接还是 CPU？（或者我错过的其他东西）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-14T05:39:26.307

您的请求是在单个执行线程中发出的。瓶颈几乎肯定是 CPU，你有没有看过 curl 多代码运行？... 令人难以置信的 CPU 饥饿；因为您对处理请求没有足够的控制权。curl_multi 使您可以一次编排 1000 个请求，但这并不是一个好主意。您几乎没有机会有效地使用 curl_multi，因为您无法足够精细地控制执行流程，仅服务套接字并在它们上选择（）将导致您看到代码运行时看到的大量高 CPU 使用率命令行。

在此类任务期间CPU使用率很高的原因是这样的；PHP 被设计为运行几分之一秒，尽可能快地完成所有事情。CPU的使用方式通常并不重要，因为它的时间太短了。当你延长这样的任务时，问题变得更加明显，每个操作码所产生的开销对程序员来说都是可见的。

我知道你说过你不能改变实现，但仍然需要一个完整的答案。这样的任务比 curl multi 更适合 Threading，你应该开始阅读[http://php.net/pthreads](http://php.net/pthreads)，从[http://php.net/Thread开始](http://php.net/Thread)

在空闲 CPU 上留给自己的设备，即使 1000 个线程也会消耗与 curl_multi 一样多的 CPU，关键是您可以精确控制负责下载响应的每个字节并上传请求的每个字节的代码，如果 CPU 使用率是您可以通过显式调用 usleep 或以有意义的方式限制连接使用来实现“好”过程，此外，您的请求可以在单独的线程中提供服务。

我不建议 1000 个线程是要做的事情，*它很可能不是*。要做的事情是设计一个 Stackable（请参阅文档），其工作是以“良好”、有效的方式发出和服务请求，并设计工作人员池（请参阅 github/pecl 扩展源上的示例）来执行您的新设计的请求...

# regex - 正则表达式匹配大写短语与其中一些在其间有小写单词

> ID：13850952
> 
> 赞同：0
> 
> 时间：2012-12-13T00:13:46.547
> 
> 标签：regex

如何匹配（使用一个正则表达式）大写短语，其中一些在其间有小写单词？例子：

1）。“接下来的几个月是随意的 6 月、7 月和 8 月，而其他月份则不是。”

```
my match should be: "UPPERCASEWORD1, UPPERCASEWORD2, lowercaseword, UPPERCASEWORD3" (i.e.**JUNE, JULY, and AUGUST**) <=== uppercase words with lowercase in between 
```

2）“办公室周六到周一关门，谢谢。”

我的比赛应该是“**星期六到星期一**”（即“UPPERCASEWORD1 UPPERCASEWORD2 UPPERCASEWORD3”）<==全部大写

简单来说，我正在寻找一个正则表达式，它可以匹配一个以大写单词开头和结尾但中间也可以有小写单词的短语。

我需要一个可以两者兼得的正则表达式。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T00:20:18.030

**正则表达式无法识别英语**。所以它没有介词和标点符号的概念。但是您可以定义一个正则表达式可以理解的规则。

像这样*它应该匹配任意数量的大写字母和逗号，可以与`N`小写字符的数量*组合。假设小写字符的数量将容纳所有介词。

```
([A-Z]+[\sa-z,]{0,N})+[A-Z]+ 
```

另一种方法是，如果您有一个介词列表，您可以在正则表达式中使用它。

```
([A-Z]+((in|out|or|by|with|and)*[\s,]*)+)+[A-Z]+ 
```

但是这个列表并不可靠，因为你不知道哪个词会充当介词。在英语中，任何单词都可以充当介词。这取决于它在哪里使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T00:20:41.547

```
/(\b[A-Z]+\b[-,\s]+((and|or|is|on|at|to)\s+)*)*\b[A-Z]+\b/g
             ^^^^   ^^^^^^^^^^^^^^^^^^^^
              |              |
 list of delimiters    list of prepositions 
```

例如，将匹配它们。请注意，您的要求非常模糊，但您可以轻松地将介词列表替换为一般匹配，例如`[a-z]+`.

# html - How to align a link icon after the text via CSS?

> ID：13850955
> 
> 赞同：1
> 
> 时间：2012-12-13T00:14:05.523
> 
> 标签：html, css, icons

I have a navigation menu with links, before the text link I have an icon, I would like to put this icon after the text link. The website is here [http://www.labella.co.il/](http://www.labella.co.il/).

CSS of the link:

```
.sidebar ul.menu li a {background: url("1-default/bullet.png") no-repeat scroll 0 12px transparent;} 
```

Icon image is in `url("1-default/bullet.png")`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T00:19:35.533

这是更改后的代码以获取您想要的内容：

```
.sidebar ul.menu li a {
    background: url("1-default/bullet.png") no-repeat scroll 100% 12px transparent;
    padding: 10px 22px 10px 0;
} 
```

我将左侧填充交换到右侧，并将背景图像推到右侧。

请注意，我使用`100%`的不是“幻数”（就像其他答案一样）。这意味着即使宽度发生变化，图标仍会对齐，无需维护！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T00:17:52.627

更改背景图像的位置并添加一些填充，以便文本不会覆盖它：

```
.sidebar ul.menu li a {
    background: url("1-default/bullet.png") no-repeat scroll 100% 12px transparent;
}

.sidebar ul.menu li a {
    cursor: pointer;
    text-decoration: none;
    padding: 10px 23px 10px 22px;
    display: block;
    background: #CCC;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-13T00:17:49.197

`background-position`可以更改为：

```
.sidebar ul.menu li a {
  background: url("1-default/bullet.png") no-repeat scroll 202px 12px transparent;
} 
```

然后`padding`调整为图标腾出空间：

```
.sidebar ul.menu li a {
   cursor: pointer;
   text-decoration: none;
   padding: 10px 22px 10px 0;
   display: block;
   background: #CCC;
} 
```

# php - Get the current array key inside foreach

> ID：13850956
> 
> 赞同：4
> 
> 时间：2012-12-13T00:14:10.713
> 
> 标签：php, arrays, forms, foreach

Ok so, I am building something for my employer for them to input products, they have very specific requirements. I have a form with dynamically generated fields like so... (obviously not the exact code to follow but the examples are identical conceptually)

```
<input type="text" name="attribute[20]"> inputted value = height
<input type="text" name="attribute[27]"> inputted value = width 
```

the numbers are generated based on things in the database, so 20 would correlate to "width" 27 would correlate to "height" for example.

So once the user enters the values I need those values to go into a database...or in the test, echo out.

```
foreach ($_POST['attribute'] as $attributes){
echo key($attributes).' '.$attributes.'<br>';
} 
```

So that should output...

```
20 height value<br>
27 width value 
```

but instead it outputs

```
&nbsp;height value<br>
&nbsp;width value 
```

What is going on? I have something similar...but slightly different as the defined numbers can have more than one input....which works perfectly.

```
<input type="text" name="option[][20]"> inputted value = option 1
<input type="text" name="option[][20]"> inputted value = option 2
<input type="text" name="option[][27]"> inputted value = option 1

foreach ($_POST['option'] as $options){
echo key($options).' ';
foreach ($options as $option){
echo $option.'<br>';
} 
```

which outputs perfectly...

```
20 option 1<br>
20 option 2<br>
27 option 1 
```

I don't understand why the more complex one works and the simpler one doesn't, am I missing something obvious? I am aware I have a somewhat unorthodox method of coding in comparison to some, but it is what it is lol. Any help would be greatly appreciated.

EDIT: Var dump as requested

array(22) { ["pID"]=> string(12) "test product" ["pPrice"]=> string(0) "" ["pName"]=> string(0) "" ["pRRP"]=> string(0) "" ["pPostSize"]=> string(0) "" ["pOurPrice"]=> string(0) "" ["pEstDelivery"]=> string(0) "" ["pWeight"]=> string(0) "" ["pEAN"]=> string(0) "" ["pOrder"]=> string(0) "" ["pStock"]=> string(0) "" ["pManufacturer"]=> string(0) "" ["pType"]=> string(13) "Shower Valves" ["pRange"]=> string(0) "" ["cat"]=> array(2) { [0]=> string(2) "72" [1]=> string(2) "23" } ["attribute"]=> array(2) { [***0***]=> string(5) "***width***" [1]=> string(6) "height" } ["option"]=> array(3) { [0]=> array(1) { [**11**]=> string(6) "**works1**" } [1]=> array(1) { [**10**]=> string(6) "**works1**" } [2]=> array(1) { [**10**]=> string(6) "**works2**" } } ["pLongdescription"]=> string(0) "" ["meta_description"]=> string(0) "" ["meta_keyword"]=> string(0) "" ["meta_title"]=> string(0) "" ["action"]=> string(6) "create" }

the bold parts, are the parts that successfully come out in my second example. but the bold italic as you can see, returns 0 instead of the 20 that is actually in the form name value.

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-13T00:20:32.960

```
<input type="text" name="attribute[20]"> inputted value = height
<input type="text" name="attribute[27]"> inputted value = width

foreach ($_POST['attribute'] as $attributes){
    echo key($attributes).' '.$attributes.'<br>';
} 
```

请注意，您正在循环 post 中的属性数组。$attributes 是每个字段的值（因此不是数组。

而不是使用`key()`尝试：

```
foreach ($_POST['attribute'] as $attributeKey => $attributes){
    echo $attributeKey.' '.$attributes.'<br>';
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T01:28:39.987

好的，我已经修复了它，在你们的帮助下，我意识到我有点愚蠢，只编辑了表单的静态部分以合并动态键，而不是覆盖它的 ajax 生成部分。

```
foreach ($_POST['attribute'] as $key => $attributes){
echo $key.'+'.$attributes.'<br>';
} 
```

完美运行。谢谢提醒伙计。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-13T00:22:15.880

根据[key() 的 PHP 文档](http://nl3.php.net/manual/en/function.key.php)：

> **key()**函数只返回当前由内部指针指向的数组元素的键。它不会以任何方式移动指针。如果内部指针指向元素列表末尾之外或数组为空，则**key()**返回**NULL**。

文档（和示例）显示您需要提供实际数组作为参数，您在其中使用该值。

所以使用这样的东西：

```
$yourArray = $_POST['attribute'];
foreach ($yourArray as $attributes){
  echo key($yourArray).' '.$attributes.'<br>';
} 
```

即使您注意到您知道您有“与某些方法相比有些非正统的编码方法”，但`foreach`以这种方式使用 -loop 会更好：

```
foreach ($_POST['attribute'] as $attributeKey => $attributes){
    echo $attributeKey.' '.$attributes.'<br>';
} 
```

因为该`key()`方法对我来说似乎有点“狡猾”（依赖于内部指针）。

查看[foreach 文档](http://nl3.php.net/manual/en/control-structures.foreach.php)以获取有关此用途的更多信息。

# c++ - OpenMP construct to continue execution as soon as at least 1 thread is finished

> ID：13850959
> 
> 赞同：0
> 
> 时间：2012-12-13T00:14:59.400
> 
> 标签：c++, openmp

I have a need to continue execution as soon as one of the threads has finished execution. The logic inside the parallel section with ensure that everything has been completed satisfactorily. I have nested parallelisation therefore I put some of the top level threads to Sleep when data is not ready to be processed as not to consume computation power. So when one of the top level threads finishes I want to continue execution and not wait for the other threads to wake up and naturally return.

I use

```
#pragma omp parallel for num_threads(wanted_thread_no) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T00:20:50.610

你如何并行化？您使用任务、部分还是？

如果我理解正确并且如果您使用任务原语，您可以`#pragma omp parallel nowait`在最后一个任务之后使用。

在第 13 页检查此 pdf（pdf）。

[http://openmp.org/wp/presos/omp-in-action-SC05.pdf](http://openmp.org/wp/presos/omp-in-action-SC05.pdf)

它明确地说：

> 默认情况下，“omp for”末尾有一个障碍。使用“nowait”子句关闭屏障。 `#pragma omp for nowait`“nowait”在两个连续的、独立的 omp for 循环之间很有用。

这是你想要的吗？

也要看看这个，即使它说的是同样的事情。

[http://openmp.org/mp-documents/omp-hands-on-SC08.pdf](http://openmp.org/mp-documents/omp-hands-on-SC08.pdf)

# javascript - AngularJs: ng-View not updating

> ID：13850964
> 
> 赞同：2
> 
> 时间：2012-12-13T00:15:28.650
> 
> 标签：javascript, angularjs

my application view is split up in public and private questions.

users can see all public questions by clicking on "Show all public" questions, and the same for private questons.

i use ng-view in my main app.html, and use the show_all.html template which takes 2 arrays (private&public questions) and does ng-repeat to list all questions.

that all works fine.

the problem is, i have search which should basically take in the ng-model, run a search & update the view with the search results (search results returning data in the same format that the public questions and private questions JSON format is).

I'm not sure whether I'm using Ng-view the right way, or why this isn't even working.

Plunker URL: [http://plnkr.co/edit/Ol3h0CHYAeZwBfLtb9Pt?p=streamer](http://plnkr.co/edit/Ol3h0CHYAeZwBfLtb9Pt?p=streamer)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T01:36:30.027

您需要让 Angular 知道重新处理自己。在 Angular 之外发生的任何事情都需要您告诉 Angular 进行更新。因此，在您的情况下，在更新 searchQuestions 后直接添加一个 $apply() 调用

```
 $scope.searchQuestions()
 $scope.$apply(); 
```

以下是有关 $apply 方法的文档： [http ://docs.angularjs.org/api/ng.$ro​​otScope.Scope#$apply](http://docs.angularjs.org/api/ng.%24rootScope.Scope#%24apply)

# regex - Perl RegEx trouble with one or more of any char

> ID：13850966
> 
> 赞同：1
> 
> 时间：2012-12-13T00:15:47.360
> 
> 标签：regex, perl

This is my regex:

```
^.+\/.+\.sql.+$ 
```

it matches

```
/somedir/abc.sql.20121212 
```

but it doesn't match

```
/somedir/abc.sql20121212 
/somedir/abc.sql_20121212 
```

What am I doing wrong? Shouldn't `sql.+$` mean match 'sql' and at least one of any character after it?

**UPDATE**: The above regex does indeed work. I was getting unexpected results because I hadn't saved the config file in which the regex is stored (DUH !!) The previous value was `^.+\/.+\.sql\..+$` which means has to be 'sql.' and at least one of any character after it. Sorry for the false alarm.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T00:24:50.003

实际上，它们确实匹配：

```
print "$_: ", /^.+\/.+\.sql.+$/ ? 'match' : 'no match', "\n"
   for qw(
      /somedir/abc.sql.20121212
      /somedir/abc.sql20121212 
      /somedir/abc.sql_20121212
   ); 
```

输出

```
/somedir/abc.sql.20121212: match
/somedir/abc.sql20121212: match
/somedir/abc.sql_20121212: match 
```

# ruby - 为什么 Ruby 中的符号不 被视为一种变量？

> ID：13850971
> 
> 赞同：11
> 
> 时间：2012-12-13T00:16:11.320
> 
> 标签：ruby, variables, symbols, accessor

编程和 Ruby 新手，我希望这个关于符号的问题符合要求。我知道 Ruby 中的符号（例如 , `:book`）`:price`特别用作哈希键，并且可以全方位地做一个轻量级的、特定的字符串可以做的事情的子集。

但是，我在一方面对符号感到困惑。具体来说，当它们用于`attr_accessor`方法类型时，它们的行为似乎更像一个变量。例如，`attr_reader :book, :price`。

如果它们在该用法中是变量，这有点令人费解，因为当变量类型时，它们通常不会列在变量类型中（如 $global、@instance、local、@@class，有时还有 CONSTANT、变量类型）被描述。

如果以这种方式使用符号是变量，那么它们的作用域应该是什么？还是在这种情况下它们仍然以某种方式轻量级字符串？（或者在更广泛的意义上，符号、字符串和变量是否都具有基本的鸭式性质？）提前感谢您的见解和建议。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-13T00:22:01.090

符号不是变量，而是一种文字值，如数字和带引号的字符串。值得注意的是，符号用于*表示*Ruby 运行时中的变量和其他命名值。因此，当 Ruby 解释器看到名称`foo`用作变量或方法名称时，它在运行时值的 Hash 中查找的是符号`:foo`，而不是字符串`"foo"`。事实上，这是编程语言术语中“符号”一词的原始用法。变量、函数、常量、方法等被称为存储在编译器或解释器的“符号表”中。

几乎任何时候你在 Ruby 中传递一些东西的名字，你都会使用一个符号。如果您使用`method_missing`包罗万象的方式在您的对象类上实现任意方法，则符号是它作为参数接收的，告诉它实际调用的方法的名称。如果你用`.methods`or检查一个对象`.instance_variables`，你得到的是一个符号数组。等等。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-13T00:21:45.227

它们不是变量，因为它们不保存值，它们是不可变的。事情就是价值本身。它类似于数字。您无法设置 的值`1`。`1 = 2`不起作用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-13T01:14:34.707

访问器方法中使用的符号不是变量。它们只是代表变量的名称。变量持有一些引用，因此您不能在定义访问器方法时使用变量本身。例如，假设您想在变量`@foo`值为 的上下文中为变量定义一个访问器方法`"bar"`。如果 Ruby 的语法是这样的，会发生什么：

```
attr_accessor @foo 
```

这与写作没有什么不同：

```
attr_accessor "bar" 
```

您无法访问`@foo`您感兴趣的名称。因此，必须将此类构造设计为在元级别引用变量名称。符号就是因为这个原因。它们本身不是变量。它们代表变量的名称。

与访问器方法相关的变量是实例变量。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-13T00:25:52.943

`attr_accessor`这些都是属于类Class的所有方法。他们期望符号作为参数。如果需要，您可以编写自己的`attr_`使用字符串版本。它只是一个红宝石成语。这是一个`attr_acessor`存储`attr_accessor`我之前为家庭作业所做的所有值的示例。

```
class Class
  def attr_accessor_with_history(attr_name)
    attr_name = attr_name.to_s   # make sure it's a string
    attr_reader attr_name        # create the attribute's getter
    attr_reader attr_name+"_history" # create bar_history getter
    class_eval %Q"
      def #{attr_name}=(value)
        if !defined? @#{attr_name}_history 
          @#{attr_name}_history = [nil]
        end
        @#{attr_name} = value
        @#{attr_name}_history << value
      end
    "
  end
end 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-13T00:21:15.047

Ruby 的`attr_accessor`,`attr_reader`和`attr_writer`只是避免编写一些重复代码的简写方式。下面的问题扩展了它们是如何工作的：[为什么使用 Ruby 的 attr_accessor、attr_reader 和 attr_writer？](https://stackoverflow.com/questions/5046831/why-use-rubys-attr-accessor-attr-reader-and-attr-writer)

与其将其`attr_reader :book`视为*变量*，不如将其视为使用符号指定的属性的*名称。*

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-13T13:46:01.903

为了解决您的“如果它们是变量是真的”和“范围”问题，回答访问器符号与实例变量无关会更简单，即使这听起来是反传统的。它们不指向实例变量。访问器只定义 getter 和 setter**方法**。在 Object#instance_variables 下，Pickaxe(*) 表示：请注意，简单地定义访问器不会创建相应的实例变量。

在 Ruby 中，变量只有在您为其赋值时才会存在。下面的代码演示了这一点。

```
class MyClass
    attr_accessor :name
    attr_reader   :book
end

obj = MyClass.new # line 6
print '1) obj.instance_variables : '; p obj.instance_variables
print '2) obj.name : '; p obj.name

obj.name = 'xyz'
print '3) obj.instance_variables : '; p obj.instance_variables
print '4) obj.name : '; p obj.name
print '5) obj.book : '; p obj.book

class MyClass
    def initialize(p_book)
        @book = p_book
    end
end

obj = MyClass.new('The Pickaxe') # line 21
print '6) [new] obj.book : '; p obj.book

class MyClass
    method_name = 'title'
    attr_accessor method_name # line 26
end

obj.title = 'Programming Ruby'
print '7) obj.instance_variables : '; p obj.instance_variables
print '8) obj.title : '; p obj.title 
```

输出 ：

```
$ ruby -w t.rb 
1) obj.instance_variables : []
2) obj.name : nil
3) obj.instance_variables : ["@name"]
4) obj.name : "xyz"
5) obj.book : nil
6) [new] obj.book : "The Pickaxe"
7) obj.instance_variables : ["@title", "@book"]
8) obj.title : "Programming Ruby" 
```

1) 空数组：访问者没有定义实例变量
2) 询问实例变量 @name 回答 nil ：它不存在
3) 赋值已经创建了实例变量。
请注意，这`name =`是将 setter 用作带有参数的普通方法的语法糖：`obj.name=('xyz')`
4) getter 方法`name`回答 @name 的值
5) getter 方法`book`回答 nil 因为实例变量 @book 不存在。定义访问`attr_reader :book`器尚未定义相应的实例变量
6) getter 方法回答在 21 中调用的`book`赋值。实例变量 @book 已由`initialize``new``@book = p_book`
第 26 行）我一直认为访问器只接受符号。我发现变量是可能的，但兴趣有限。
7) setter 方法`title=`创建了@title。这也表明实例变量属于单个对象。我们经常相信它们属于类的所有实例，就像在其他语言中一样。在这种情况下，@name 只属于第 6 行创建的对象。
8) getter 方法`title`回答@title 的值

```
class MyClass
    def title # line 34
        @book + ' (cheating !)'
    end
end

print '9) obj.title : '; p obj.title 
```

输出 ：

```
t.rb:34: warning: method redefined; discarding old title  
9) obj.title : "The Pickaxe (cheating !)" 
```

9) 当然，访问器符号和相应的实例变量之间存在紧密的关联，因为在幕后，Ruby 创建了引用同名实例变量的方法。您可以定义自己的吸气剂和作弊方法。

请注意，除了类变量（@@var，有些人不喜欢它们和全局变量一样丑），类也可以有实例变量。我称它们为类实例变量:)。
`class MyClass`: Ruby 分配类 Class 的一个新实例，定义一个常量 MyClass，并将新实例分配给该常量。因此 MyClass 是一个普通对象（Class 的实例），因此可以具有实例变量。

```
if RUBY_VERSION[0..2] == '1.8'
    class Object
        def singleton_class
            class << self
                self
            end
        end
    end
end

class MyClass
    singleton_class.instance_eval do
        attr_accessor :counter
    end
    @counter = 0

    def initialize(p_book)
        @book = p_book
        self.class.counter += 1
    end
end

print '10) MyClass.singleton_methods  : '; p MyClass.singleton_methods
print '11) MyClass.instance_variables : '; p MyClass.instance_variables
obj = MyClass.new('Ruby')
print '12) [new] obj.book ', MyClass.counter, ': '; p obj.book
obj = MyClass.new('Metaprogramming')
print '13) [new] obj.book ', MyClass.counter, ': '; p obj.book 
```

输出 ：

```
t.rb:55: warning: method redefined; discarding old initialize
10) MyClass.singleton_methods  : ["counter", "counter="]
11) MyClass.instance_variables : ["@counter"]
12) [new] obj.book 1: "Ruby"
13) [new] obj.book 2: "Metaprogramming" 
```

更多关于单例方法的信息：[def `self.function` 名称是什么意思？](https://stackoverflow.com/questions/13706373/what-does-def-self-function-name-mean/13709911#13709911)

(*) [http://pragprog.com/book/ruby3/programming-ruby-1-9](http://pragprog.com/book/ruby3/programming-ruby-1-9)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-12-14T02:12:56.583

（回答您的评论）

`dog = 'dog'`或者`String.new("dog")`

在dog = String.new之后，实例dog的字段类指向String类。

```
class << dog
    puts "inside #{self}" #=> inside #<Class:#<String:0x007fb38a83a820>>
    def bark
        puts 'woof'
    end
end
dog.bark #=> "woof" 
p dog.singleton_methods #=> ["bark"] 
```

使用`class << dog`or `def dog.bark`，Ruby 创建了一个匿名类，实例 dog 的字段类现在指向这个匿名类，并从那里指向 String。在此上下文中使用 def 或 define_method 定义的方法进入匿名类的方法表。

Ruby 1.9.2 引入了 Object#singleton_class。[The Pickaxe] 返回 obj 的单例类，必要时创建一个。（我补充）它相当于`class << self; self end`。

Ruby 编程语言 (O'Reily) 简单地说：要打开对象 o 的 eigenclass [单例类]，请使用 class << o。

所以我不知道如何大声朗读。我读到有些人更喜欢`o >> class`. 直到最近我才发现如何弄清楚这个奇怪的表达是什么意思。我发音：从 o 到它的匿名类。

```
class << MyClass
    def dog
        puts 'dog as class method'
    end
end
MyClass.dog #=> dog as class method 
```

对于一个类也是如此。有了`class MyClass`，MyClass 作为 Class 的实例，是一个带有指向其类 Class 的指针的对象。使用`def MyClass.some_method`or `class << MyClass`，Ruby 创建一个匿名类，插入 MyClass 和 Class 之间，类方法进入其中。

> 可能是这样的：“从类中，实例化单例对象自身

是的“从类/对象”到匿名单例类/特征类/元类。但是我们不实例化 self. Self（在 Smaltalk 中，在 C++/Java 中为 this）是一种保留字，用于指定消息的接收者。`dog.bark`：在OO语言中，我们说消息吠叫发送给对象狗。在方法内部`bark`，self 将被设置为 dog，以便我们可以引用 dog。这更明显

```
o1 = MyClass.new; o2 = MyClass.new
o1.some_method; o2.some_method 
```

some_method 必须能够以通用方式引用接收器，它是 o1 还是 o2，这就是 self 的用途。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-09-04T00:30:22.047

很酷，我想你现在已经理解它们了。然而，为什么它们如此重要？

Ruby 中的符号是不可变的，而字符串是可变的。你觉得不错很酷，那又怎样？

假设您有一个字符串数组，如下所示：

```
 [ "a", "b", "a", "b", "a", "b", "c" ] 
```

对于您创建的每个新字符串，ruby 将创建一个包含“a”值的字符串/对象，并且因为字符串是可变的，ruby 为每个字符串分配不同的 id。如果您要改用符号：

```
[ :a, :b, :a, :b, :a, :b, :c ] 
```

Ruby 现在将指向这些符号，并且只会创建一次。

让我们做一些基准测试：

```
require 'benchmark'

Benchmark.bm do |x|
  x.report("Symbols") do
    a = :a
    1000_000.times do
      b = :a
    end
  end

  x.report("Strings") do
    a = "a"
    1000_000.times do
      b = "a"
    end
  end

end

ruby -w symbols.rb

Symbols  0.220000   0.000000   0.220000 (  0.215795)
Strings  0.460000   0.000000   0.460000 (  0.452653) 
```

如果您想查看您已经创建的所有符号，您可以执行以下操作：

```
Symbol.all_symbols 
```

您还可以向他们发送消息询问他们的身份：

```
:a.object_id #=> 123
:a.object_id #=> 123

"a".id #=> 23323232
"a".id #=> some_blob_number 
```

这又是因为 Ruby 中的字符串是可变的，而符号不是。Ruby 符号表示 Ruby 解释器中的名称。

这个视频真的帮助了我： [Ruby's Symbols Explained](http://www.youtube.com/watch?v=mBXGBbEbXZY)

希望对大家有帮助。

# tomcat - tomcat server not found

> ID：13850976
> 
> 赞同：1
> 
> 时间：2012-12-13T00:16:37.620
> 
> 标签：tomcat

I'm trying to configure a tomcat server to start developing servlet/jsp but I get server not found. Here is what I did so far:

Added CLASSPATH to .bash_profile and my servlet compiled successfully.

I typed which java which outputted /usr/bin/java

I then added export JAVA_HOME=/usr/bin/java to .bash_profile

Removed the comments around servlet-mapping as well as the Invoker.

Changed the permission of /usr/share/tomcat6/webapps to world access.

Logged out as root and then logged into my regular account to create WEB-INF/classes under /usr/share/tomcat6/webapps

I then moved the .class from the servlet I compiled to /usr/share/tomcat6/webappsWEB-INF/classes

started a terminal, su to service tomcat6 start then switched user to my normal account and type service tomcat6 status, the output was tomcat 6 running.

Finally, I started my web browser type localhost:8080/servlet/first
and I got server not found. Tried localhost:8080, server not found; however, if I type 127.0.0.1:8080/servlet/first or 127.0.0.1:8080, I get a white page with no error message.

The servlet first will only output Hello World.

I couldn't find the Context path="" docBase="" reloadable="true" line in server.xml

I also search in context.xml, web.xml, and tomcat-users.xml and couldn't find it.

Any suggestions please?

I created a web.xml file inside /usr/share/tomcat6/webapps/WEB-INF, which contains the following lines:

```
<?xml version="1.0" encoding="ISO-8859-1"?>

<!DOCTYPE web-app
PUBLIC "-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN"
"http://java.sun.com/dtd/web-app_2_3.dtd">

<web-app>

<servlet>
<servlet-name>first</servlet-name>
<servlet-class>first</servlet-class>
</servlet>

<servlet-mapping>
<servlet-name>first</servlet-name>
<url-pattern>*.html</url-pattern>
</servlet-mapping>
</web-app> 
```

Still I get server not found. Any thing else I should try?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-07T22:51:29.970

从您所说的来看，听起来您正试图从服务器的 ROOT webapp 运行 servlet。

如果是这样，那么问题将是：您是否有 /etc/tomcat6/Catalina/localhost/ROOT.xml 文件？

或者，更重要的是，就 *.xml 文件而言，**您**在 /etc/tomcat6/Catalina/localhost/ 下有什么？这是各个 webapp 配置文件的位置，只要将 Context 条目与 docBase 配置一起放入。

希望有帮助。让我们知道。

# jquery - Phonegap iOS6：删除表单助手栏的正确解决方案（上一个，下一个，完成）

> ID：13850985
> 
> 赞同：15
> 
> 时间：2012-12-13T00:17:40.690
> 
> 标签：jquery, iphone, c, cordova, keyboard

另一个“如何删除 pre、next、done 按钮”——*你可能会想到*的问题。其实不是。我对此进行了一些相当彻底的研究，并尝试了不同的方法，但**似乎没有任何方法或解决方案真正正确**。下面提到和显示的所有解决方法（就是它们）基本上是相同的方法，**替换 MainViewController.m**文件的内容。我很清楚，所有这些提议的解决方案或多或少都有些**老套**，但仍然应该**有人以一点优雅和深思熟虑解决了这个问题**，或者有人非常了解 C 并且可以提出建议更可靠的解决方案。

请允许我通过引用一些建议的解决方案来说明我的观点：

## [解决方案 1](https://stackoverflow.com/a/9276023/1899354)

在 iOS6 中，这会导致**表单助手栏边框仍然存在**，并且键盘的行为就像表单助手栏仍然存在一样。

## [解决方案 2](https://stackoverflow.com/questions/10746998/phonegap-completely-removing-the-black-bar-from-the-iphone-keyboard/10796550#10796550)

有人提出了上述解决方案，但我根本无法让它发挥作用。回答者对帖子进行了多次编辑和评论，这只会让您更难掌握在哪里做什么。我已经尝试了他解决方案的所有变体，但我总是会**遇到严重错误**，并且项目根本**无法编译**。

## [解决方案 3](https://stackoverflow.com/a/12734859/1899354)

不是 C 程序员（这就是我使用 phonegap 的原因）所以不能让它正常工作。不知道**在哪里添加什么**。

## [解决方案 4](https://stackoverflow.com/a/9054016/1899354)

**不知道在哪里以及如何实现这一点**，所以没有尝试过。我应该在哪里注册以接收keyboardDidShow 通知？我应该在哪里添加该功能？

## 结论

根据我的研究，如果你愿意的话，目前还没有人提出适当的解决方案。那么有没有人成功删除表单助手而没有任何上述副作用？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-09-07T07:35:28.757

对于仍在为此苦苦挣扎的任何人，Phonegap 现在有两个属性用于禁用表单附件栏问题和当输入和文本区域字段触发键盘时页面滚动问题。

只需在 config.xml 中设置以下内容即可。

```
<preference name="HideKeyboardFormAccessoryBar" value="true" />
<preference name="KeyboardShrinksView" value="true" /> 
```

链接到[Phonegap 文档](http://docs.phonegap.com/en/3.0.0/guide_platforms_ios_config.md.html#iOS%20Configuration)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-23T12:00:12.527

给你，我在我目前正在开发的应用程序中使用它。祈祷它可以进入应用商店，尽管通过其他“黑客”进入商店这并不比其他人差，所以应该有一个公平的机会。

这种方法没有烦人的副作用——它通过确保它从一开始就没有被创建来干净地删除了条。达达！

归功于[https://gist.github.com/2048571](https://gist.github.com/2048571)，这是他的代码，有一个小修复。

```
#import <objc/runtime.h>
#import <UIKit/UIKit.h>

@interface UIWebView (HackishAccessoryHiding)
@property (nonatomic, assign) BOOL hackishlyHidesInputAccessoryView;
@end

@implementation UIWebView (HackishAccessoryHiding)

static const char * const hackishFixClassName = "UIWebBrowserViewMinusAccessoryView";
static Class hackishFixClass = Nil;

- (UIView *)hackishlyFoundBrowserView {
    UIScrollView *scrollView = self.scrollView;

    UIView *browserView = nil;
    for (UIView *subview in scrollView.subviews) {
        if ([NSStringFromClass([subview class]) hasPrefix:@"UIWebBrowserView"]) {
            browserView = subview;
            break;
        }
    }
    return browserView;
}

- (id)methodReturningNil {
    return nil;
}

- (void)ensureHackishSubclassExistsOfBrowserViewClass:(Class)browserViewClass {
    if (!hackishFixClass) {
        Class newClass = objc_allocateClassPair(browserViewClass, hackishFixClassName, 0);
        IMP nilImp = [self methodForSelector:@selector(methodReturningNil)];
        class_addMethod(newClass, @selector(inputAccessoryView), nilImp, "@@:");
        objc_registerClassPair(newClass);

        hackishFixClass = newClass;
    }
}

- (BOOL) hackishlyHidesInputAccessoryView {
    UIView *browserView = [self hackishlyFoundBrowserView];
    return [browserView class] == hackishFixClass;
}

- (void) setHackishlyHidesInputAccessoryView:(BOOL)value {
    UIView *browserView = [self hackishlyFoundBrowserView];
    if (browserView == nil) {
        return;
    }
    [self ensureHackishSubclassExistsOfBrowserViewClass:[browserView class]];

    if (value) {
        object_setClass(browserView, hackishFixClass);
    }
    else {
        Class normalClass = objc_getClass("UIWebBrowserView");
        object_setClass(browserView, normalClass);
    }
    [browserView reloadInputViews];
}

@end 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-12T23:29:51.570

在任何版本的 iOS 中，都没有公共（因此，App Store 允许）方法来禁用 UIWebView（AFAIK 是 PhoneGap 使用的）表单元素的 Web 视图上的表单助手栏。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-01-15T14:20:38.377

如果您使用 phonegap/cordova 3 CLI，您现在需要一个插件来删除工具栏。通过终端安装它..

```
$ cordova plugin add org.apache.cordova.keyboard 
```

并在你的 javascript 中使用它

```
Keyboard.hideFormAccessoryBar(true); 
```

**但是……**它并不完美。首先，如果您打算使用 input.focus() 来调出键盘，则工具栏会在隐藏之前短暂显示。从此以后就好了。如果您允许用户直接在输入字段中单击，那就没问题了。

然后屏幕顶部可以移动，可以通过这个答案解决。 [如何在 iOS 上修复 Cordova 3.1 的键盘问题？](https://stackoverflow.com/questions/19416886/how-to-fix-keyboard-issues-with-cordova-3-1-on-ios?answertab=active#tab-top)

可能很难做到正确，所以我会问自己是否真的需要隐藏它，或者你可以让它对用户有用吗？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-01-23T11:28:13.050

这看起来像我们一直在等待的科尔多瓦插件...... [https://github.com/don/KeyboardToolbarRemover](https://github.com/don/KeyboardToolbarRemover)

这允许一个简单`toolbar.hide()`而`toolbar.show()`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-09T14:40:25.130

这对我有用：[https ://github.com/don/KeyboardToolbarRemover](https://github.com/don/KeyboardToolbarRemover)

不过，您必须知道，从 Phonegap 2.3.0 开始没有 Cordova.plist 文件 - 而是使用以下内容编辑您的配置 XML 文件：

```
<plugin name="KeyboardToolbarRemover" value="KeyboardToolbarRemover" /> 
```

在分行

# java - 如何设置一个java字符串变量等于“htp://website htp://website”

> ID：13850989
> 
> 赞同：0
> 
> 时间：2012-12-13T00:17:56.620
> 
> 标签：java, string

所以我有一个很大的网站列表，我想把它们都放在一个字符串变量中。我知道我不能单独访问所有链接并转义 //，但是有超过几百个链接。有没有办法进行“块转义”，所以“块”之间的所有东西都被转义了？这是我要保存在变量中的示例。

```
String links="http://website http://website http://website http://website http://website http://website" 
```

也有人能想到我在这样做时可能遇到的任何其他问题吗？

我把它做成了 htp 而不是 http，因为我不允许根据堆栈溢出发布“超链接”，因为我不在那个级别：p

非常感谢

编辑：我正在制作一个程序，因为我有大约 50 页的 word 文档，其中充满了电子邮件和其他文本。我只想过滤掉电子邮件。我编写了程序来执行此操作，这非常简单，我只需要将页面存储在程序将在其中运行的字符串变量中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T02:46:16.170

你的问题写得不好。请改进它。在其当前格式中，它将被关闭为“太模糊”。

您想过滤电子邮件或网站吗？你的例子是关于网站的，你发短信是关于电子邮件的。因为我不知道，我决定无论如何都要帮助你，所以我决定两者都做。

代码如下：

```
private static final Pattern EMAIL_REGEX =
        Pattern.compile("[A-Za-z0-9](:?(:?[_\\.\\-]?[a-zA-Z0-9]+)*)@(:?[A-Za-z0-9]+)(:?(:?[\\.\\-]?[a-zA-Z0-9]+)*)\\.(:?[A-Za-z]{2,})");

private static final Pattern WEBSITE_REGEX =
        Pattern.compile("http(:?s?)://[_#\\.\\-/\\?&=a-zA-Z0-9]*");

public static String readFileAsString(String fileName) throws IOException {
    File f = new File(fileName);
    byte[] b = new byte[(int) f.length()];
    InputStream is = null;
    try {
        is = new FileInputStream(f);
        is.read(b);
        return new String(b, "UTF-8");
    } finally {
        if (is != null) is.close();
    }
}

public static List<String> filterEmails(String everything) {
    List<String> list = new ArrayList<String>(8192);
    Matcher m = EMAIL_REGEX.matcher(everything);
    while (m.find()) {
        list.add(m.group());
    }
    return list;
}

public static List<String> filterWebsites(String everything) {
    List<String> list = new ArrayList<String>(8192);
    Matcher m = WEBSITE_REGEX.matcher(everything);
    while (m.find()) {
        list.add(m.group());
    }
    return list;
} 
```

为确保它正常工作，首先让我们测试 filterEmails 和 filterWebsites 方法：

```
public static void main(String[] args) {
    System.out.println(filterEmails("Orange, pizza whatever else joe@somewhere.com a lot of text here. Blahblah blah with Luke Skywalker (luke@starwars.com) hfkjdsh fhdsjf jdhf Paulo <aaa.aaa@bgf-ret.com.br>"));
    System.out.println(filterWebsites("Orange, pizza whatever else joe@somewhere.com a lot of text here. Blahblah blah with Luke Skywalker (http://luke.starwars.com/force) hfkjdsh fhdsjf jdhf Paulo <https://darth.vader/blackside?sith=true&midclorians> And the http://www.somewhere.com as x."));
} 
```

它输出：

```
[joe@somewhere.com, luke@starwars.com, aaa.aaa@bgf-ret.com.br]
[http://luke.starwars.com/force, https://darth.vader/blackside?sith=true&midclorians, http://www.somewhere.com] 
```

要测试 readFileAsString 方法：

```
public static void main(String[] args) {
    System.out.println(readFileAsString("C:\\The_Path_To_Your_File\\SomeFile.txt"));
} 
```

如果该文件存在，将打印其内容。

如果您不喜欢它返回`List<String>`而不是`String`用空格分隔的项目，这很容易解决：

```
public static String collapse(List<String> list) {
    StringBuilder sb = new StringBuilder(50 * list.size());
    for (String s : list) {
        sb.append(" ").append(s);
    }
    sb.delete(0, 1);
    return sb.toString();
} 
```

粘在一起：

```
String fileName = ...;
String webSites = collapse(filterWebsites(readFileAsString(fileName)));
String emails = collapse(filterEmails(readFileAsString(fileName))); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T03:08:16.930

对于您的第一个问题，从单词中取出所有文本，将其放入执行正则表达式的内容中，使用正则表达式引用每一行并以 . 结尾`+`。现在编辑最后一行并更改`+`为`;`. 在第一行上面写`String links =`. 将此新文件复制到您的 java 源代码中。这是[一个使用 regexr 的示例](http://regexr.com?334e1)。

要回答您的第二个问题（思考问题），如果我没记错 2^16 的长度，Java 字符串文字有一个上限。

哦，[`Perl`](http://pastebin.com/VEAmd36d)基本上是为了让你做这种事情而写的（拿 50 页文本，把什么是 url 和什么是电子邮件分开）......更不用说[`grep`](http://www.gnu.org/software/grep/manual/grep.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T01:16:36.690

我建议您将 Word 文档保存为纯文本。然后您可以使用`java.io`包中的类（例如`Scanner`阅读文本）。

要解决`String`每次读取一行时覆盖变量的问题，可以使用数组或`ArrayList`. 这比将所有网址保存在一个单一中要理想得多，`String`因为您可以随时轻松地单独访问每个地址。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-12-13T01:11:30.430

我不确定您指的是哪种“网站列表”，但例如。一个逗号分隔的网站文件，您可以读取整个文件并使用该`String` `split`函数获取一个数组，或者您可以使用 a`BufferedReader`逐行读取文件并添加到`ArrayList`.

从那里您可以简单地循环数组并附加到 a `String`，或者如果您需要：

> 做一个“块转义”，所以“块”之间的所有东西都被转义了

您可以使用正则表达式`String`根据模式提取每个部分：

```
String oldString = "<someTag>I only want this part</someTag>";
String regExp = "(?i)(<someTag.*?>)(.+?)(</someTag>)";
String newString = oldString.replaceAll(regExp, "$2"); 
```

上面的表达式将删除 xml 标签，因为`"$2"`这意味着您对表达式的第二组感兴趣，其中组由圆括号标识`( )`。使用`"$1$3"`instead 应该只给你周围的 xml 标签。

从 a 中删除某些“块”的另一种更简单的方法`String`是`String` `replace`函数，在哪里删除块你可以简单地传入一个空字符串作为新值。

我希望这对您有所帮助，否则您可以尝试提供一个完整的示例，输入“网站列表”和您想要的输出。

# opengl - OpenGL 中的曲面

> ID：13850990
> 
> 赞同：2
> 
> 时间：2012-12-13T00:18:04.477
> 
> 标签：opengl, matrix

我正在查看一些关于 OpenGL 表面的示例问题并遇到了这个问题，但我并不完全确定该怎么做。我知道它的矩阵乘法，但我不知道如何去做。

![在此处输入图像描述](../Images/b0df28a2c2c3de7f618a66601523acf8.png)

底线是：B(t) = Gb * Mb * T

# sendgrid - 仅针对特定类别触发 SendGrid webhook，

> ID：13850991
> 
> 赞同：1
> 
> 时间：2012-12-13T00:18:19.307
> 
> 标签：sendgrid, webhooks

SendGrid 的 webhook 一旦启用，就会随着每封电子邮件的发送而触发。或者这似乎是文档所暗示的。

我想知道是否只有在某些过滤器与预定义集匹配时才会触发 webhook。特别是我对匹配特定内容的类别过滤器感兴趣，并且仅在匹配时触发 webhook，并且默认情况下不会在所有发送的电子邮件上触发它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T17:29:08.307

没有办法按类别限制事件，但您可以设置一个简单的过滤器来检查特定类别的存在。

# php - 在对象的层次结构中获取特定值

> ID：13850998
> 
> 赞同：0
> 
> 时间：2012-12-13T00:19:14.807
> 
> 标签：php, amazon-web-services

我正在尝试从 AWS 响应中获取根类别名称。ECS PHP 类将其作为类返回。如果这是 XML，我可以做一个 xpath 搜索。我不知道搜索对象的等价物。

这是从 BrowseNode 元素开始的对象结构：

```
object(stdClass)#172 (1) {
  ["BrowseNode"]=>
  object(stdClass)#173 (3) {
    ["BrowseNodeId"]=>
    string(8) "11059391"
    ["Name"]=>
    string(22) "Makeup Brushes & Tools"
    ["Ancestors"]=>
    object(stdClass)#174 (1) {
      ["BrowseNode"]=>
      object(stdClass)#175 (3) {
        ["BrowseNodeId"]=>
        string(8) "11062741"
        ["Name"]=>
        string(19) "Tools & Accessories"
        ["Ancestors"]=>
        object(stdClass)#176 (1) {
          ["BrowseNode"]=>
          object(stdClass)#177 (4) {
            ["BrowseNodeId"]=>
            string(8) "11055981"
            ["Name"]=>
            string(8) "Products"
            ["IsCategoryRoot"]=>
            bool(true)
            ["Ancestors"]=>
            object(stdClass)#178 (1) {
              ["BrowseNode"]=>
              object(stdClass)#179 (2) {
                ["BrowseNodeId"]=>
                string(7) "3760911"
                ["Name"]=>
                string(6) "Beauty"
              }
            }
          }
        }
      }
    }
  }
} 
```

基本上，如果“IsCategoryRoot”为 TRUE，我需要在下一个“Ancestors”元素下获取“Name”中的值。在这种情况下，“美”就是价值。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T16:49:40.573

您可以轻松编写一个函数来递归到对象并查找节点：

```
function find_category_root_name (stdClass $node) {
    if(isset($node->IsCategoryRoot) && $node->IsCategoryRoot === true) {
        if(isset($node->Ancestors->BrowseNode->Name) && !empty($node->Ancestors->BrowseNode->Name)) {
            return $node->Ancestors->BrowseNode->Name;
        } else {
            // error IsCategoryRoot found but no name found for ancestor
            return false;
        }
    } else if (isset($node->Ancestors->BrowseNode) && $node->Ancestors->BrowseNode instanceof stdClass) {
        return find_category_root_name($node->Ancestors->BrowseNode);
    } else {
        // error no ancestor node found
        return false;
    }
}

find_category_root_name($outer_object->BrowseNode); 
```