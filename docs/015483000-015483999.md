# StackOverflow 问答 15483000-15483999

# ruby - 用不同的方法将 Jsonp 转换为 Json

> ID：15483003
> 
> 赞同：0
> 
> 时间：2013-03-18T17:22:57.883
> 
> 标签：ruby, json, jsonp

我一直在尝试在 ruby​​ 项目中使用 json 格式的 JSONP 数据。

根据您的经验，您是如何解决这个问题的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-03T21:14:32.363

JSONP 很容易处理。它只是一个小包装器中的 JSON，并且该包装器很容易剥离：

```
require 'open-uri'
require 'json'

URL = 'http://www.google.com/dictionary/json?callback=a&sl=en&tl=en&q=epitome'
jsonp = open(URL).read 
```

`jsonp`现在包含 JSONP 格式的结果：

```
jsonp[0, 3] # => "a({"
jsonp[-11 ... -1] # => "},200,null" 
```

那些无关的部分，`a{`也是`,200,null"`将数据传递给 JSON 进行解析时的麻烦点，因此我们将它们剥离。

只需要一个简单、贪婪的正则表达式。`/{.+}/`将找到由最外面的花括号包裹的所有内容并将其返回，这就是 JSON 所需的全部内容：

```
data = JSON.parse(jsonp[/{.+}/])

data['query'] # => "epitome"
data['primaries'].size # => 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T11:24:16.347

根据我的经验，一种方法是使用此正则表达式来过滤掉函数回调名称：

```
/(\{.*\})/m 
```

或者懒惰的方法是找到第一次出现 "(" 的索引，然后用最后一个字符作为子串，这将是 ")" 。

我一直在这里寻找答案，没有得到可靠的答案，希望这会有所帮助。

干杯

# c# - “类不包含采用 0 个参数的构造函数”

> ID：15483009
> 
> 赞同：-1
> 
> 时间：2013-03-18T17:23:12.497
> 
> 标签：c#, oop

我很困惑为什么这不会运行。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace ConsoleApplication3
{
    class Buyer : User
    {
        public void AuctionWon()
        {
        }
    }
} 
```

我得到“不包含带 0 个参数的构造函数”。我事先已经搜索过帮助，但没有任何有用的结果。

这是用户类

```
public class User
{

    private int accountNo;
    private int password;

    public User(int accountNo, int password)
    {
        this.accountNo = accountNo;
        this.password = password;

    }

    public bool Validatepassword(int userpassword)
    {
        if (password == userpassword)
        {
            return true;
        }
        else
        {
            return false;
        }
    }

    public int GetAccountNo()
    {
        return accountNo;
    }
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-18T17:24:27.820

看起来您的基类（`User`类）没有任何具有 0 个参数的构造函数。

您的用户类有一个构造函数，例如：

```
public class User
{
    public User(int accountNo, int password)
    {
        this.accountNo = accountNo;
        this.password = password;

    }
} 
```

并且买方必须像这样继承：

```
 public class Buyer : User
    {
        public Buyer(int accountNo, int password) : base(accountNo, password)
        {
        }

        public void AuctionWon()
        {
        }
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-18T17:36:38.463

如果基类 (User) 具有至少采用一个参数的构造函数，但没有不带参数的构造函数，则会发生此错误。

所以这没关系：

```
class User
{
}

class Buyer : User
{
    public void AuctionWon()
    {
    }
} 
```

因为用户没有任何构造函数，编译器会自动为你创建一个默认的带有 0 个参数的“隐藏”构造函数。

但这会导致您看到的错误（“'User' 不包含采用 '0' 参数的构造函数”）：

```
class User
{
    public User(string text)
    {
    }
}

class Buyer : User
{
    public void AuctionWon()
    {
    }
} 
```

因为 User 现在有一个显式构造函数，所以编译器不会创建任何参数为 0 的默认构造函数。您可以向 User 添加一个参数为 0 的构造函数，但通常在这种情况下，User 类的设计者希望您调用 User 构造函数并提供适当的参数，例如，

```
class User
{
    public User(string text)
    {
    }
}

class Buyer : User
{
    public Buyer() : base("Adam")
    {
    }

    public void AuctionWon() 
    {
    }
} 
```

现在，我们向 Buyer 添加了一个构造函数，它调用现有的 User 构造函数，并为其提供适当的参数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-18T17:25:01.727

当您运行程序时，这是您得到的错误

```
'ConsoleApplication3.User' does not contain a constructor that takes 0 arguments 
```

此消息不言自明，类中没有无参数构造函数`User`。

在 User 类中添加一个无参数的构造函数（如果它是可编辑的，而不是在某些 dll 中。否则不可能）类似

```
public User()
{} 
```

**或者**

如果用户包含带参数的构造函数，请像这样使用

```
public class Buyer : User
{
    public Buyer() : base(FooBar)
    {
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-18T17:25:42.963

我怀疑您的`User`类不包含没有参数的构造函数。所以在构造它的实例时`Buyer`不知道如何构造基类。

为了解决这个问题：在你的`Buyer`类中创建一个空的构造函数，并让它从基类（`User`）中调用一个构造函数。

# sql - 从表 a 中选择，其中记录不在表 b 和表 c 中

> ID：15483017
> 
> 赞同：0
> 
> 时间：2013-03-18T17:23:40.063
> 
> 标签：sql

从表 a 中选择，其中记录不在表 b 和表 c 中

我试过像这样

```
 select a.* from table a
left outer join b on b.index=a.index
left outer join c on c.index=a.index 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T17:27:08.210

Where`b.index`和`c.index`are 各个表中的列。

```
select a.* from table a
    left outer join b on b.index=a.index
    left outer join c on c.index=a.index
WHERE b.index IS NULL
AND c.index IS NULL 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T17:26:48.800

尝试

```
SELECT a.* 
FROM a 
WHERE a.`index` NOT IN (SELECT `index` FROM b) 
AND a.`index` NOT IN (SELECT `index` FROM c); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-18T17:27:04.400

尝试

```
select * 
from table_a a 
where a.index not in (select b.index from table_b b) 
and a.index not in (select c.index from table_c c) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-18T17:27:14.053

我假设您的查询为您提供了 a 中的所有记录。您现在需要做的就是添加一个`where`子句：

```
select a.* from table a
left outer join b on b.index=a.index
left outer join c on c.index=a.index
where b.index is null and c.index is null 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-18T17:27:19.970

尝试使用异常连接：

```
SELECT A.* FROM TABLE A
    LEFT EXCEPTION JOIN B ON B.INDEX=A.INDEX
    LEFT EXCEPTION JOIN C ON C.INDEX=A.INDEX 
```

# entity-framework - 实体框架代码优先：如何为“默认”值注释外键？

> ID：15483019
> 
> 赞同：31
> 
> 时间：2013-03-18T17:24:12.270
> 
> 标签：entity-framework, ef-code-first, data-annotations

我有 2 个课程：客户和调查。

每个客户可以有许多调查 - 但只有一个默认调查。

我已经定义了这样的类：

```
public class Client
{
    [DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    public int ID { get; set; }

    public string ClientName { get; set; }

    public Nullable<int> DefaultSurveyID { get; set; }

    [ForeignKey("DefaultSurveyID")]
    public virtual Survey DefaultSurvey { get; set; }

    public virtual ICollection<Survey> Surveys { get; set; }
}

public class Survey
{
    [DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    public int ID { get; set; }

    public string SurveyName { get; set; }

    [Required]
    public int ClientID { get; set; }

    [ForeignKey("ClientID")]
    public virtual Client Client { get; set; }
} 
```

正如我所料，这将创建 Client 表：

```
[dbo].[Clients]
(
[ID] [int] IDENTITY(1,1) NOT NULL,
[ClientName] [nvarchar](max) NULL,
[DefaultSurveyID] [int] NULL
) 
```

但是 Survey 表有一个额外的外键：

```
[dbo].[Surveys]
(
[ID] [int] IDENTITY(1,1) NOT NULL,
[SurveyName] [nvarchar](max) NULL,
[ClientID] [int] NOT NULL,
[Client_ID] [int] NULL
) 
```

为什么 Code First 会产生这种关系，我如何告诉它不要产生这种关系？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2013-03-18T19:22:05.987

问题是，当您在两个实体之间有多个关系时，EF Code First 无法找出哪些导航属性匹配，除非您告诉它如何匹配，这是代码：

```
public class Client
{
    [DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    public int ID { get; set; }

    public string ClientName { get; set; }

    /****Change Nullable<int> by int?, looks better****/
    public int? DefaultSurveyID { get; set; }

    /****You need to add this attribute****/
    [InverseProperty("ID")]
    [ForeignKey("DefaultSurveyID")]
    public virtual Survey DefaultSurvey { get; set; }

    public virtual ICollection<Survey> Surveys { get; set; }
} 
```

在您以前的版本中，EF 正在创建该额外关系，因为它不知道该`DefaultSurvey`属性正在引用该类`ID`的`Survey`，但您可以让它知道，添加参数是您需要的`InverseProperty`属性名称的属性匹配。`Survey``DefaultSurvey`

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-03-18T18:36:32.053

您可以使用代码优先来做到这一点，但不是我欺骗的代码优先专家:-)

1) 我使用 SMS 在数据库中创建了表和关系（如上所述，没有额外的 Client_ID）

2）我使用[逆向工程师代码优先](http://visualstudiogallery.msdn.microsoft.com/72a60b14-1581-4b9b-89f2-846072eff19d)创建所需的类和映射

3) 我删除了数据库并使用 context.Database.Create() 重新创建了它

原始表定义：

```
CREATE TABLE [dbo].[Client](
    [Id] [int] IDENTITY(1,1) NOT NULL,
    [Name] [nvarchar](50) NULL,
    [DefaultSurveyId] [int] NULL,
     CONSTRAINT [PK_dbo.Client] PRIMARY KEY NONCLUSTERED 
    (
        [Id] ASC
    )
)

CREATE TABLE [dbo].[Survey](
    [Id] [int] IDENTITY(1,1) NOT NULL,
    [Name] [nvarchar](50) NULL,
    [ClientId] [int] NULL,
     CONSTRAINT [PK_dbo.Survey] PRIMARY KEY NONCLUSTERED 
    (
        [Id] ASC
    )
) 
```

加上外键

```
ALTER TABLE [dbo].[Survey]  WITH CHECK 
    ADD CONSTRAINT [FK_dbo.Survey_dbo.Client_ClientId] FOREIGN KEY([ClientId])
    REFERENCES [dbo].[Client] ([Id])

ALTER TABLE [dbo].[Client]  WITH CHECK 
    ADD CONSTRAINT [FK_dbo.Client_dbo.Survey_DefaultSurveyId] 
    FOREIGN KEY([DefaultSurveyId]) REFERENCES [dbo].[Survey] ([Id]) 
```

逆向工程生成的代码：

```
public partial class Client
{
    public Client()
    {
        this.Surveys = new List<Survey>();
    }

    public int Id { get; set; }
    public string Name { get; set; }
    public int? DefaultSurveyId { get; set; }
    public virtual Survey DefaultSurvey { get; set; }
    public virtual ICollection<Survey> Surveys { get; set; }
}

public partial class Survey
{
    public Survey()
    {
        this.Clients = new List<Client>();
    }

    public int Id { get; set; }
    public string Name { get; set; }
    public int? ClientId { get; set; }
    public virtual ICollection<Client> Clients { get; set; }
    public virtual Client Client { get; set; }
}

public class ClientMap : EntityTypeConfiguration<Client>
{
    #region Constructors and Destructors

    public ClientMap()
    {
        // Primary Key
        this.HasKey(t => t.Id);

        // Properties
        this.Property(t => t.Name).HasMaxLength(50);

        // Table & Column Mappings
        this.ToTable("Client");
        this.Property(t => t.Id).HasColumnName("Id");
        this.Property(t => t.Name).HasColumnName("Name");
        this.Property(t => t.DefaultSurveyId).HasColumnName("DefaultSurveyId");

        // Relationships
        this.HasOptional(t => t.DefaultSurvey)
            .WithMany(t => t.Clients).HasForeignKey(d => d.DefaultSurveyId);
    }

    #endregion
}

public class SurveyMap : EntityTypeConfiguration<Survey>
{
    #region Constructors and Destructors

    public SurveyMap()
    {
        // Primary Key
        this.HasKey(t => t.Id);

        // Properties
        this.Property(t => t.Name).HasMaxLength(50);

        // Table & Column Mappings
        this.ToTable("Survey");
        this.Property(t => t.Id).HasColumnName("Id");
        this.Property(t => t.Name).HasColumnName("Name");
        this.Property(t => t.ClientId).HasColumnName("ClientId");

        // Relationships
        this.HasOptional(t => t.Client)
            .WithMany(t => t.Surveys).HasForeignKey(d => d.ClientId);
    }

    #endregion
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-18T17:42:14.540

实体框架完全按照它的指示去做。您所说的是，客户和调查之间既有一对多的关系，也有一对一的关系。它在调查表中生成了两个 FK，以便映射您请求的两个关系。它不知道你试图将这两种关系联系在一起，我认为它也没有能力处理这个问题。

作为替代方案，您可能需要考虑`IsDefaultSurvey`在调查对象上添加一个字段，以便您可以通过`Surveys`客户端对象上的集合查询默认调查。您甚至可以更进一步，将其作为`NotMapped`Client 对象的属性放入，以便您仍然可以使用它`Client.DefaultSurvey`来获取正确的调查，而不必更改任何其他代码，如下所示：

```
[NotMapped]
public Survey DefaultSurvey
{
  get { return this.Surveys.First(s => s.IsDefaultSurvey); }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-04-25T19:33:32.917

请注意，添加下面的代码将解决问题。

```
public class ApplicationDbContext : IdentityDbContext<ApplicationUser>
{
    public ApplicationDbContext() : base("DefaultConnection")
    {

    }
    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
          modelBuilder.Entity<Client>()
                      .HasOptional(x => x.DefaultSurvey)
                      .WithMany(x => x.Surveys);
                      .HasForeignKey(p => p.DefaultSurveyID);
    {
} 
```

# php - 拆分 PHP 脚本以避免超时

> ID：15483022
> 
> 赞同：0
> 
> 时间：2013-03-18T17:24:25.340
> 
> 标签：php

我有以下脚本，用于 PDF 网站上的某些页面：

```
<? 
    include_once('phpToPDF.php') ; 
    phptopdf_url( 'http://www.example.com/csb04-termination-box/?style=alt' ,'pdf/', 'csb04-termination-box.pdf'); 
    phptopdf_url( 'http://www.example.com/csb05-termination-box/?style=alt' ,'pdf/', 'csb05-termination-box.pdf');  
    phptopdf_url( 'http://www.example.com/csb06-compact-termination-box/?style=alt' ,'pdf/', 'csb06-compact-termination-box.pdf');
    echo 'Done';
?> 
```

我遇到的问题是，如果我在脚本完成运行之前添加更多页面服务器超时。我试过改变`set_time_limit(0);`，但没有帮助（在共享主机上）。

修改脚本以使其完成的最佳方法是什么？我考虑尝试将其拆分为多个脚本并通过 ajax 运行它，但不确定从哪里开始，因为之前没有使用它的经验。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-18T17:27:18.237

最简单的方法是：

```
include_once('phpToPDF.php') ; 
$i = isset($_GET['i']) ? intval($_GET['i']) : 0;

if ($i == 0) phptopdf_url( 'http://www.example.com/csb04-termination-box/?style=alt' ,'pdf/', 'csb04-termination-box.pdf'); 
if ($i == 1) phptopdf_url( 'http://www.example.com/csb05-termination-box/?style=alt' ,'pdf/', 'csb05-termination-box.pdf');  
if ($i == 2) phptopdf_url( 'http://www.example.com/csb06-compact-termination-box/?style=alt' ,'pdf/', 'csb06-compact-termination-box.pdf');

if ($i < 3) header('Location: ?i=' . ($i + 1));
echo 'Done'; 
```

基本上，这可以让您的网络浏览器进行计数，而无需使用 Ajax。当一个请求完成时，浏览器会自动加载下一页，直到计数器 ( `$i`) 为 3。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T17:38:24.900

使用以下脚本处理所有文件，一次一个：

```
include_once('phpToPDF.php') ; 

$urls = array();
$urls[] = array('http://www.example.com/csb04-termination-box/?style=alt', 'csb04-termination-box.pdf');
$urls[] = array('http://www.example.com/csb05-termination-box/?style=alt', 'csb05-termination-box.pdf');
$urls[] = array('http://www.example.com/csb06-termination-box/?style=alt', 'csb06-termination-box.pdf');
// add here more elements in $urls if needed

if(!isset($_GET['n']))
    $n = 0;
else
    $n = intval($_GET['n']);

if(isset($urls[$n]))
{
    phptopdf_url($urls[$n][0] ,'pdf/', $urls[$n][1]); 
    header('Location: ?n='.($n+1)); // calls the conversion of the next file in the $urls array
}
else
    echo 'Done'; 
```

# bash - zsh 中的自动补全反斜杠

> ID：15483026
> 
> 赞同：2
> 
> 时间：2013-03-18T17:24:32.390
> 
> 标签：bash, shell, zsh, zshrc

是否有一个 zsh 脚本可以让我用反斜杠自动完成空格？例如：

假设有一个名为“我的文件夹”的文件夹，中间有一个空格。如果我想进去，我

```
cd My\ folder 
```

但是，我想要一种输入方式

```
cd My folder 
```

zsh 会自动知道要放一个反斜杠，所以我不必这样做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-09-01T22:05:27.070

答案有点晚了，但这应该可以让你做你想做的事情，并保留命令的正常行为，如果没有给出目录`cd`，还可以带你到你的目录。`~`

添加到您的`~/.zshrc`文件中：

```
function cd() {
    new_directory="$*";
    if [ $# -eq 0 ]; then
        new_directory=${HOME};
    fi;
    builtin cd "${new_directory}"
} 
```

但是，您的 ZSH 应该内置自动完成功能，在这种情况下，您可以输入您尝试 cd 进入的目录的前几个字母，然后点击`tab`它应该完成目录名称或提供目录列表（如果有多个）火柴。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T14:33:05.073

You could Make an alias with "Myfolder" and run that in a zsh script.

```
alias -g "Myfolder"="My\ folder"    ---> cd Myfolder 
```

I don't know if there is a way to make it possible with having the space in between the words. If it has to be my "My folder" then I don't know that I can help you.

# qt - 如何在 QML 中的两个窗口之间切换回来

> ID：15483034
> 
> 赞同：1
> 
> 时间：2013-03-18T17:25:03.537
> 
> 标签：qt, qml

我像这样创建 qml 文件：

```
main.qml

Item {
     width: 200; height: 200

     Loader { id: pageLoader }

     MouseArea {
         anchors.fill: parent
         onClicked: pageLoader.source = "Page1.qml"
     }
 } 
```

我想从`Page1.qml`.

我怎么能做这个工作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-18T17:37:29.540

只需将`pageLoader`Page1 中的源设置为空：

主页 ：

```
import QtQuick 1.0

Rectangle {
    width: 360
    height: 360
    Text {
        anchors.centerIn: parent
        text: "Main Page"
    }
    MouseArea {
        anchors.fill: parent
        onClicked: {
            ld.source="Test.qml"
        }
    }
    Loader{
        id:ld;
        anchors.fill: parent;
    }
} 
```

测试.qml

```
Rectangle {
    width: 100
    height: 62
    color: "navy";
    Text {
        anchors.centerIn: parent
        text: "Page 1"
    }

    MouseArea{
        anchors.fill: parent;
        onClicked: ld.source="";
    }
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-03-07T11:43:51.000

您是否必须在 Test.qml 中再次实例化加载程序才能通过 var 访问它

# c# - 使用 OleDbConnection 在 c# 的 excel 文档中导出图像的问题

> ID：15483035
> 
> 赞同：0
> 
> 时间：2013-03-18T17:25:04.353
> 
> 标签：c#, image, excel, export, oledbcommand

我想在 C# 中将图像导出到 excel 文档

图片格式如下：System.Windows.Media.Imaging.BitmapImage

这些是连接详细信息：

```
private const string OleDbConnection = "provider=Microsoft.Jet.OLEDB.4.0;Data Source='{0}';Extended Properties=Excel 8.0;";
private const string OleDbInsert = "INSERT INTO [Report] ([Time], [Elapsed], [Description], [Picture]) values( @timestamp, @elapsed, @description, @pic);";
private const string OleDbCreate = "CREATE TABLE [Report] ([Time] varchar(255), [Elapsed] varchar(255), [Description] varchar(255), [pic] blob);"; 
```

我正在使用以下代码在 excel 中编写图像：

```
foreach (var e in Entries)
{

using(var command = new OleDbCommand { Connection = connection, CommandText = OleDbInsert })
{

    command.Parameters.Add(new OleDbParameter("@component", OleDbType.BSTR) { Value = e.val1 });
    command.Parameters.Add(new OleDbParameter("@result", OleDbType.BSTR) { Value = e.val2 });
    command.Parameters.Add(new OleDbParameter("@description", OleDbType.BSTR) { Value = e.val3});

    if (e.EncodedScreenshot != string.Empty)
                        {
                            byte[] imageContent = imageToByteArray(ImageWpfToGDI(e.Picture));
                            OleDbParameter ph = new OleDbParameter("@pic", OleDbType.Binary) { Value = imageContent}; 
                            ph.Size = imageContent.Length;
                            command.Parameters.Add(ph);
                        }
} 
```

这些是我正在使用的方法：

```
 public byte[] imageToByteArray(Image imageIn)
    {
        MemoryStream ms = new MemoryStream();
        imageIn.Save(ms, System.Drawing.Imaging.ImageFormat.Gif);
        return ms.ToArray();
    }

    private System.Drawing.Image ImageWpfToGDI(System.Windows.Media.Imaging.BitmapImage image)
    {
        MemoryStream ms = new MemoryStream();
        var encoder = new System.Windows.Media.Imaging.BmpBitmapEncoder();
        encoder.Frames.Add(System.Windows.Media.Imaging.BitmapFrame.Create(image as System.Windows.Media.Imaging.BitmapSource));
        encoder.Save(ms);
        ms.Flush();
        return System.Drawing.Image.FromStream(ms);
    } 
```

除图像外的所有数据都导出到 Excel 文件（并且肯定存在图像）。你能给我一些关于如何解决这个问题的建议吗？我一直在网上搜索很多，但我仍然找不到解决方案。

我根据这个链接做了一些修改：[Insert and retrieve Image in Access 2007 DB from C# App](https://stackoverflow.com/questions/7211367/insert-and-retrieve-image-in-access-2007-db-from-c-sharp-app)。我相信我的错误是由于图像数据类型。我应该为 DB 和 OleDbParameter 中的图像使用什么数据类型？

有人可以帮帮我吗？如有任何回应，我将不胜感激。

非常感谢！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T11:34:37.347

以防有人偶然发现同样的问题..

我找不到使用 OleDbParameter 将图像导出到 excel 文件的方法。如果有人知道如何做到这一点，请纠正我。

相反，我使用了这种方法：[http](http://csharp.net-informations.com/excel/csharp-insert-picture-excel.htm) ://csharp.net-informations.com/excel/csharp-insert-picture-excel.htm 在此帮助下：[如何从 C# 应用程序将图片插入 Excel？](https://stackoverflow.com/questions/11716873/how-to-insert-a-picture-in-to-excel-from-c-sharp-app) 而且效果很好。

# java - JAVA：生成子集长度在3到最大值之间的功率集

> ID：15483036
> 
> 赞同：4
> 
> 时间：2013-03-18T17:25:10.890
> 
> 标签：java, powerset

一切都在标题中.. =）

我想快速创建一个powerset，只有长度子集在3（最小恒定长度）和最大值之间。这个最大值在大多数情况下应该是 5，但我希望它是可变的（从 3 到 5,6）。原始集可能很大。我需要存储这些子集以供进一步处理。

我已经看到[了在 Java 中获取一个集合](https://stackoverflow.com/questions/1670862/obtaining-powerset-of-a-set-in-java)的幂集，但是在这里它们生成了幂集的每个子集。对于 C#，我还看到[了用于最小长度子集的有效 powerset 算法](https://stackoverflow.com/questions/9651987/efficient-powerset-algorithm-for-subsets-of-minimal-length)，但我认为，正如 Adam S 所说，我会遇到低运行时间性能和内存问题。

我想将这些想法组合成一个理想的实现我的目标。我最后的希望是快速生成每个子集（也许使用[Guava](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Sets.html#powerSet(java.util.Set))中的算法）并迭代以仅采用所需的长度......但即使阅读它也很丑;）

有人有想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-18T18:46:21.883

我从[st0le](https://stackoverflow.com/users/216517/st0le)的[回答](https://stackoverflow.com/a/3078491/300257)中大量借鉴。

基本上，当我遍历控制集合生成的位数组时，我检查以确保位数在最小值和最大值之间。

这是代码。

```
import java.util.BitSet;
import java.util.Iterator;
import java.util.Set;
import java.util.TreeSet;

public class PowerSet<E> implements Iterator<Set<E>>, Iterable<Set<E>> {
    private int     minSize;
    private int     maxSize;
    private E[]     arr     = null;
    private BitSet  bset    = null;

    @SuppressWarnings("unchecked")
    public PowerSet(Set<E> set, int minSize, int maxSize) {
        this.minSize = Math.min(minSize, set.size());
        this.maxSize = Math.min(maxSize, set.size());

        arr = (E[]) set.toArray();
        bset = new BitSet(arr.length + 1);

        for (int i = 0; i < minSize; i++) {
            bset.set(i);
        }
    }

    @Override
    public boolean hasNext() {
        return !bset.get(arr.length);
    }

    @Override
    public Set<E> next() {
        Set<E> returnSet = new TreeSet<E>();
        // System.out.println(printBitSet());
        for (int i = 0; i < arr.length; i++) {
            if (bset.get(i)) {
                returnSet.add(arr[i]);
            }
        }

        int count;
        do {
            incrementBitSet();
            count = countBitSet();
        } while ((count < minSize) || (count > maxSize));

        // System.out.println(returnSet);
        return returnSet;
    }

    protected void incrementBitSet() {
        for (int i = 0; i < bset.size(); i++) {
            if (!bset.get(i)) {
                bset.set(i);
                break;
            } else
                bset.clear(i);
        }
    }

    protected int countBitSet() {
        int count = 0;
        for (int i = 0; i < bset.size(); i++) {
            if (bset.get(i)) {
                count++;
            }
        }
        return count;

    }

    protected String printBitSet() {
        StringBuilder builder = new StringBuilder();
        for (int i = 0; i < bset.size(); i++) {
            if (bset.get(i)) {
                builder.append('1');
            } else {
                builder.append('0');
            }
        }
        return builder.toString();
    }

    @Override
    public void remove() {
        throw new UnsupportedOperationException("Not Supported!");
    }

    @Override
    public Iterator<Set<E>> iterator() {
        return this;
    }

    public static void main(String[] args) {
        Set<Character> set = new TreeSet<Character>();
        for (int i = 0; i < 7; i++)
            set.add((char) (i + 'A'));

        PowerSet<Character> pset = new PowerSet<Character>(set, 3, 5);
        int count = 1;
        for (Set<Character> s : pset) {
            System.out.println(count++ + ": " + s);
        }
    }

} 
```

以下是测试结果：

```
1: [A, B, C]
2: [A, B, D]
3: [A, C, D]
4: [B, C, D]
5: [A, B, C, D]
6: [A, B, E]
7: [A, C, E]
8: [B, C, E]
9: [A, B, C, E]
10: [A, D, E]
11: [B, D, E]
12: [A, B, D, E]
13: [C, D, E]
14: [A, C, D, E]
15: [B, C, D, E]
16: [A, B, C, D, E]
17: [A, B, F]
18: [A, C, F]
19: [B, C, F]
20: [A, B, C, F]
21: [A, D, F]
22: [B, D, F]
23: [A, B, D, F]
24: [C, D, F]
25: [A, C, D, F]
26: [B, C, D, F]
27: [A, B, C, D, F]
28: [A, E, F]
29: [B, E, F]
30: [A, B, E, F]
31: [C, E, F]
32: [A, C, E, F]
33: [B, C, E, F]
34: [A, B, C, E, F]
35: [D, E, F]
36: [A, D, E, F]
37: [B, D, E, F]
38: [A, B, D, E, F]
39: [C, D, E, F]
40: [A, C, D, E, F]
41: [B, C, D, E, F]
42: [A, B, G]
43: [A, C, G]
44: [B, C, G]
45: [A, B, C, G]
46: [A, D, G]
47: [B, D, G]
48: [A, B, D, G]
49: [C, D, G]
50: [A, C, D, G]
51: [B, C, D, G]
52: [A, B, C, D, G]
53: [A, E, G]
54: [B, E, G]
55: [A, B, E, G]
56: [C, E, G]
57: [A, C, E, G]
58: [B, C, E, G]
59: [A, B, C, E, G]
60: [D, E, G]
61: [A, D, E, G]
62: [B, D, E, G]
63: [A, B, D, E, G]
64: [C, D, E, G]
65: [A, C, D, E, G]
66: [B, C, D, E, G]
67: [A, F, G]
68: [B, F, G]
69: [A, B, F, G]
70: [C, F, G]
71: [A, C, F, G]
72: [B, C, F, G]
73: [A, B, C, F, G]
74: [D, F, G]
75: [A, D, F, G]
76: [B, D, F, G]
77: [A, B, D, F, G]
78: [C, D, F, G]
79: [A, C, D, F, G]
80: [B, C, D, F, G]
81: [E, F, G]
82: [A, E, F, G]
83: [B, E, F, G]
84: [A, B, E, F, G]
85: [C, E, F, G]
86: [A, C, E, F, G]
87: [B, C, E, F, G]
88: [D, E, F, G]
89: [A, D, E, F, G]
90: [B, D, E, F, G]
91: [C, D, E, F, G] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T17:59:46.963

请指定元素的数量是否有界。

对于 3 - 5,6 个元素，索引数组可能是可行的`short[6]`。

例如，最多 32 个元素`int`可以容纳该集合，并且可以：

```
// dumb:
for (int mask = 0; ; ;) {
    int cardinality = Integer.bitCount(mask);
    if (3 <= cardinality && cardinality <= 6) {
        ...
    }
} 
```

对于超过 64 个元素，BitSet 仍然可以提供紧凑性。

这里的决定受到简单统计的约束：有多少元素等等。对于 int/long/BitSet 解决方案，可以从 BitSet 开始，因为它具有更好的 API。例如，可以通过翻转两位来进入具有相同位数的下一个幂集。如果一个人有数学倾向，De Bruijn 循环可能会很有趣。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-08-21T12:08:40.243

对于大小不超过 63 个元素的集合，并且如果您的最小大小约束不低，则此实现可能更快：

```
import java.util.Iterator;
import java.util.LinkedList;
import java.util.List;
import java.util.Set;

import static com.google.common.base.Preconditions.checkArgument;
import static java.lang.Math.min;

public class PowerSet<E> implements Iterator<Iterable<E>>, Iterable<Iterable<E>> {

    private int minSize;
    private int maxSize;
    private E[] arr = null;
    private long bits = 0;
    private long count = 0;
    private long minMask = 0;

    /**
     * Build a PowerSet of the given {@link Set} to iterate over subsets whose size is between the given boundaries
     * @param set the set to create subsets from
     * @param minSize the minimal size of the subsets
     * @param maxSize the maximum size of the subsets
     */
    @SuppressWarnings("unchecked")
    public PowerSet(Set<E> set, int minSize, int maxSize) {
        checkArgument(maxSize < 63); // limited to 63 because we need one additional bit for hasNext
        this.minSize = min(minSize, set.size());
        this.maxSize = min(maxSize, set.size());
        arr = (E[]) set.toArray();
        for (int n = 0; n < minSize; n++) {
            bits |= (1L << n);
        }
        count = countBitSet(bits);
    }

    @Override
    public boolean hasNext() {
        return (bits & (1L << arr.length)) == 0;
    }

    @Override
    public Iterable<E> next() {
        // compute current subset
        final List<E> returnSet = new LinkedList<>();
        for (int i = 0; i < arr.length; i++) {
            if ((bits & (1L << i)) != 0) {
                returnSet.add(arr[i]);
            }
        }

        // compute next bit map for next subset
        do {
            if (count < minSize) {
                long maxFree = lowestIndex(bits) - 1;
                long missing = minSize - count;
                for (int n = 0; n < min(maxFree, missing); n++) {
                    bits |= (1L << n);
                }
            } else {
                bits++;
            }
            count = countBitSet(bits);
        } while ((count < minSize) || (count > maxSize));
        return returnSet;
    }

    /**
     * Lowest set bit in a long word
     * @param i the long word
     * @return lowest bit set
     */
    private static long lowestIndex(long i) {
        int n = 0;
        while (n < 64 && (i & 1L) == 0) {
            n++;
            i = i >>> 1;
        }
        return n;
    }

    /**
     * Compute the number of bit sets inside a word or a long word.<br/>
     * <a href="http://en.wikipedia.org/wiki/Hamming_weight">Hamming weight</a>
     * @param i the long word
     * @return number of set bits
     */
    private static long countBitSet(long i) {
        i = i - ((i >>> 1) & 0x5555555555555555L);
        i = (i & 0x3333333333333333L) + ((i >>> 2) & 0x3333333333333333L);
        i = ((i + (i >>> 4)) & 0x0F0F0F0F0F0F0F0FL);
        return (i * (0x0101010101010101L)) >>> 56;
    }

    @Override
    public void remove() {
        throw new UnsupportedOperationException("Not Supported!");
    }

    @Override
    public Iterator<Iterable<E>> iterator() {
        return this;
    }

} 
```

它由 long 而不是 BitSet 支持，并更快地计算下一个子集......对于低的最小约束，它也可能更快。

您可以删除对仅用于构造函数 checkArgument 的 Guava 的依赖...

# python - 正则表达式：完全匹配三行

> ID：15483038
> 
> 赞同：1
> 
> 时间：2013-03-18T17:25:21.330
> 
> 标签：python, regex

我想匹配以下输入。如何在不使用多行字符串的情况下匹配一个组一定次数？像 (^(\d+) (.+)$){3}) 之类的东西（但这不起作用）。

```
sample_string = """Breakpoint 12 reached 
         90  good morning
     91  this is cool
     92  this is bananas
     """
pattern_for_continue = re.compile("""Breakpoint \s (\d+) \s reached \s (.+)$
                                 ^(\d+)\s+  (.+)\n
                                 ^(\d+)\s+  (.+)\n
                                 ^(\d+)\s+  (.+)\n
                                  """, re.M|re.VERBOSE)
matchobj = pattern_for_continue.match(sample_string)
    print matchobj.group(0) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-18T17:55:33.357

您的表达和样本存在一系列问题：

*   您使用 VERBOSE 会使所有空格都不匹配，因此第一行数字周围的空格也会被忽略。`\s`用or替换空格`[ ]`（后者仅匹配文字空格，前者也匹配换行符和制表符）。

*   您的输入样本在每行的数字前都有空格，但您的示例模式要求数字位于行首。允许该空格或修复您的示例输入。

*   最大的问题是重复组内的捕获组（因此`(\d+)`在最后一个较大的组内`{3}`）仅捕获最后一个匹配项。你会得到`92`and `this is bananas`，而不是前两条匹配的行。

为了克服这一切，您*必须*明确地为三行重复该模式。您可以使用 Python 来实现该重复：

```
linepattern =  r'[ ]* (\d+) [ ]+ ([^\n]+)\n'

pattern_for_continue = re.compile(r"""
    Breakpoint [ ]+ (\d+) [ ]+ reached [ ]+ ([^\n]*?)\n
    {}
""".format(linepattern * 3), re.MULTILINE|re.VERBOSE) 
```

其中，对于您的示例输入，返回：

```
>>> pattern_for_continue.match(sample_string).groups()
('12', '', '90', 'hey this is a great line', '91', 'this is cool too', '92', 'this is bananas') 
```

如果您真的不想在 3 个额外行上的数字之前匹配空格，您可以`[ ]*`从`linepattern`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T17:43:28.890

# 代码

你需要更多这样的东西：

```
import re

sample_string = """Breakpoint 12 reached 
90  hey this is a great line
91  this is cool too
92  this is bananas
"""
pattern_for_continue = re.compile(r"""
    Breakpoint\s+(\d+)\s+reached\s+\n
    (\d+)  ([^\n]+?)\n
    (\d+)  ([^\n]+?)\n
    (\d+)  ([^\n]+?)\n
""", re.MULTILINE|re.VERBOSE)
matchobj = pattern_for_continue.match(sample_string)

for i in range(1, 8):
    print i, matchobj.group(i)
print "Entire match:"
print matchobj.group(0) 
```

# 结果

```
1 12
2 90
3   hey this is a great line
4 91
5   this is cool too
6 92
7   this is bananas
Entire match:
0 Breakpoint 12 reached 
90  hey this is a great line
91  this is cool too
92  this is bananas 
```

# 原因

*   re.VERBOSE 在您的正则表达式中需要明确的空格。我通过左对齐多行字符串中的数据来部分解决此问题。我认为这是合理的，因为您可能在实际代码中没有这个；它可能是在多行字符串中编辑的产物。

*   您需要替换`$`为`\n`.

*   你需要非贪婪匹配

# mongodb - 如何通过给定的标准（mongo聚合框架）简单地计算文档？

> ID：15483039
> 
> 赞同：0
> 
> 时间：2013-03-18T17:25:23.580
> 
> 标签：mongodb, aggregation-framework

我想简单地计算文件。执行以下操作的正确方法是什么：

```
db.my_collection.aggregate({
    $match: { // go by the indexed field
        date: {
            $gte: new Date(2013,1,20),
            $lte: new Date(2013,1,27)
        }
    }
},{
    $match: { // go by some other field
        someField: 'someValue'
    }
},{
    $count: { // $sum? $group? $anythingElse?
        // ???????
    }
}) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-18T17:27:47.767

你应该使用`$group`with `$sum`。像这样的东西：

```
$group: {
  _id: null,
  count: {$sum: 1}
} 
```

[SQL 到聚合框架的映射图](http://docs.mongodb.org/manual/reference/sql-aggregation-comparison/)。

# java - 在android中以编程方式删除特定号码的whatsapp消息

> ID：15483046
> 
> 赞同：-1
> 
> 时间：2013-03-18T17:25:38.803
> 
> 标签：java, android, whatsapp

我正在创建一个应用程序，用户可以在其中删除特定数字或数字组的所有历史记录。我能够删除电话和短信只是在想是否有办法在android中实用地从whatsapp中删除与特定号码相关的消息/聊天。由于whatsapp现在也是一个流行的来源。任何观点/方向都会有所帮助。提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-18T17:29:53.650

不，你不能这样做。

WhatsApp 是第三方应用程序，不提供 API 供您编辑其数据。在有根设备上，您可能能够访问他们的数据库，因为它们是 AES 加密的，而且您将很难在运行中编辑它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T17:31:02.820

您无法访问其他应用程序。但是如果您的设备是 root，您可以访问 Whatsapp 的数据库

# php - 如何使用 cURL 在远程服务器中下载文件？

> ID：15483051
> 
> 赞同：2
> 
> 时间：2013-03-18T17:25:53.780
> 
> 标签：php, curl, download, remote-access

我一直在搜索互联网以及 SO 的许多帖子，但没有运气。我有以下代码从远程服务器获取文件。

```
$url  = 'http://www.example.com/images/abc.png';
$path = '/home/axxxxxxx/public_html/images/abc.png';

$fp = fopen($path, 'w');

$ch = curl_init($url);
curl_setopt($ch, CURLOPT_FILE, $fp);

$data = curl_exec($ch);

curl_close($ch);
fclose($fp); 
```

`$url`并`$path`表示来自一台服务器的文件。**`‰PNG IHDRàw=ø IDATxÚ•yLWÇ¿3³3³ì² (VP)àUÓzDc«`**当我运行代码时，html页面会输出一个奇怪的代码，它以...开头。

当我使用文本编辑器打开 new.png 时，我得到的代码与上面 php cURL 脚本所在页面中的代码相同。（这似乎是脚本读取了正确的文件）

我也收到错误消息说，

*   `Warning: fopen(../axxxxxxx/public_html/images/new.png) [function.fopen]: failed to open stream: No such file or directory in /home/ayyyyyyy/public_html/test.php on line 5`
*   `Warning: curl_setopt(): supplied argument is not a valid File-Handle resource in /home/ayyyyyyy/public_html/test.php on line 8`

此处显示的 unicode 字符集 ( **`PNG IHDRàw=ø IDATxÚ•yLWÇ¿3³3³ì² (VP)àUÓzDc«`**)

*   `Warning: fclose(): supplied argument is not a valid stream resource in /home/ayyyyyyy/public_html/test.php on line 12`

如果重要的话，这两个站点都托管在 000webhost.com 上。

***如何将文件下载到用户的计算机？***

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T17:28:33.490

问题是（如果有的话）是您正在下载的文件是一个`PNG`文件，而您正试图将其作为文本文件读取 - 这是您看到的“奇怪代码”。

如果您在将文件输出到浏览器之前发送了`Content-Type`标题，您将看到实际图像：

```
header('Content-Type: image/png');
echo $data; 
```

通过`download the file to the user's computer`，我假设您的意思是要提示用户下载文件。为此，请将`Content-disposition`标头设置为`attachment`. 您也可以将其与上面的内容类型标头结合使用：

```
header("Content-Type: image/png");
header("Content-Transfer-Encoding: Binary"); 
header("Content-disposition: attachment; filename=\"some_image.png\""); 
```

# ruby-on-rails-3 - Rails 删除操作未运行，并呈现 200 OK

> ID：15483060
> 
> 赞同：0
> 
> 时间：2013-03-18T17:26:22.770
> 
> 标签：ruby-on-rails-3

我无法对我的应用程序拥有的**任何对象执行 DELETE 操作。**

向您展示我在组控制器中的删除操作的一般代码：

```
def destroy
    @group = Group.find(params[:id])
    respond_to do |format|
        if @group.delete
            format.html { redirect_to group_path }
            format.json { head :no_content }
        else
            format.html { redirect_to group_path }
            format.json { head :no_content }
        end
    end
end 
```

我的视图布局的代码：

```
<h1>My Groups</h1>

  <table>
    <tr>
      <th>Name</th>
      <th>Users</th>
      <th></th>
      <th></th>
    </tr>

  <% @groups.each do |group| %>
    <tr>
      <td><%= group.name %></td>
      <td>
        <% group.memberships.each do |membership| %>
          <%= User.find(membership.user_id).name %>
          <br/>
        <% end %>
      </td>
      <td><%= link_to 'Show', group %></td>
      <td><%= link_to 'Destroy', group, :confirm => 'Are you sure?', :method => :delete %></td>
    </tr>
  <% end %>
  </table>

  <br />

  <%= link_to 'New Group', new_group_path %> 
```

即使 rails 服务器日志返回 200 OK 响应，我也无法删除组对象。返回的页面是一个空白屏幕：

```
Started DELETE "/groups/2" for 127.0.0.1 at 2013-03-19 01:22:01 +0800
Processing by GroupsController#destroy as HTML
  Parameters: {"authenticity_token"=>"aH+z0DlL7NeoVlxda8Td76WdnrH7/G8UyWDqbJcTu9w=", "id"=>"2"}
Completed 200 OK in 0ms (ActiveRecord: 0.0ms) 
```

没有使用 ActiveRecord，也没有对数据库进行任何更改。过去没有这样的问题，但我最近才意识到我不能删除任何类型的对象。

我一直在尝试寻找解决在网上发现的类似问题的方法，但不幸的是，似乎还没有人遇到过这个问题。

**更新1：**

以下是我的应用程序布局：

```
<!DOCTYPE html>
<html>
    <head>
        <%= csrf_meta_tag %>
      <title>Home</title>

        <%= javascript_include_tag :application %>
        <%= stylesheet_link_tag :application, :media => "all" %>

        <%= javascript_include_tag "/javascripts/main.js" %>
        <%= stylesheet_link_tag "/css/main.css" %>
    </head>
    <body>

        <%= yield %>

    </body>
</html> 
```

但是当我使用控制台删除对象时。有用：

```
1.9.3-p194 :003 > Group.find(23).delete
  Group Load (0.5ms)  SELECT "groups".* FROM "groups" WHERE "groups"."id" = $1 LIMIT 1  [["id", 23]]
  SQL (3.0ms)  DELETE FROM "groups" WHERE "groups"."id" = 23
 => #<Group id: 23, name: "groupie", created_at: "2013-03-18 15:29:42", updated_at: "2013-03-18 15:29:42", user_id: nil> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T09:48:36.663

我刚刚找到了问题的解决方案。实际上，我为 around_filter 编写了一个代码，它弄乱了每个控制器的销毁会话：

```
 around_filter :clear_registration_id_on_destroy_session, only: :destroy

  def clear_registration_id_on_destroy_session
      is_filter_active = (controller_path == 'devise/sessions' && params[:action] == 'destroy')

      if is_filter_active && user_signed_in?
        if current_user.update_attribute(:device_platform, nil)
          logger.info "Updated device platform attributes to nil"
        end

        if current_user.update_attribute(:registration_id, nil)
          logger.info "Updated registration id attributes to nil"
        end

        yield 
      end
  end 
```

问题是除了devise:sessions#destroy之外，我没有为任何其他控制器产生任何东西。

所以和我一样健忘的朋友们，请记得在is_filter_active不为真时考虑其他条件。

```
 def clear_registration_id_on_destroy_session
      is_filter_active = (controller_path == 'devise/sessions' && params[:action] == 'destroy')

      if is_filter_active && user_signed_in?
        if current_user.update_attribute(:device_platform, nil)
          logger.info "Updated device platform attributes to nil"
        end

        if current_user.update_attribute(:registration_id, nil)
          logger.info "Updated registration id attributes to nil"
        end

        yield 
      else
        yield
      end
  end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T17:55:33.440

听起来您的删除链接只是作为`show`操作的链接，因为该`method`选项没有被选中。

您需要在应用程序布局中包含适当的 javascript，因为删除链接需要 JS 使用正确的 HTTP 方法。

如果您使用的是 Rails >= 3.1，请确保在用于呈现页面的布局文件的标题中包含以下内容：

```
<%= javascript_include_tag :application %> 
```

还要确保你的布局中有 csrf_meta_tag：

```
<%= csrf_meta_tag %> 
```

# linux - Linux：查找文件内文件路径的总文件大小

> ID：15483068
> 
> 赞同：0
> 
> 时间：2013-03-18T17:26:48.490
> 
> 标签：linux

我有一个包含一些文件路径的文件，例如：

```
./file1
./dir/file2
./dir3/dir4/fil3
etc 
```

我怎样才能找到所有这些的总文件大小？我知道“du”用于获取单个文件的文件大小，但不知道如何使用文件。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T17:31:15.197

您可以使用 du 给出多个文件的总大小

```
 cat file | tr "\n" "\0" | du -ch --files0-from=- | tail -n1 
```

使用 awk 获取文件大小

```
 cat file | awk  '{system("ls -l " $0)}' | awk '{ TOTAL += $5} END { print TOTAL}' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T17:34:40.030

## GNU coreutils du 唯一建议

编辑：命名选项`--files0-from`是 GNU 扩展，所以这个建议的解决方案不适用于任何非 GNU coreutils du 版本。由于您不想要它，因此`awk`您应该尝试使用 Vivek Goel 发布的版本。

你已经回答了你自己的问题。使用`du`是关键。您正在寻找的“缺失”选项可能是在手册页中找到的。(曼杜)

> --files0-from=F
> 总结文件 F 中指定的以 NUL 结尾的文件名的磁盘使用情况；如果 F 是 - 则从标准输入中读取名称

用法是这样的：

```
tr "\n" "\0" <file-list | du --files0-from=- 
```

# linux - 通过 ssh 隧道路由 RDP

> ID：15483073
> 
> 赞同：3
> 
> 时间：2013-03-18T17:27:01.193
> 
> 标签：linux, windows, ssh, rdp, tunnel

我以为我可以在这里轻松找到答案，但没有运气。也许这是不可能的：假设以下情况：我坐在星巴克，我的 win 8 笔记本电脑连接到他们的 WLAN。我打开了与我的 amazon ec2 micro ubuntu 实例的 ssh 连接。在我离开家之前的早上早些时候，我从我家的 win 8 机器上打开了另一个到同一实例的 ssh 连接。现在从我的腻子终端我可以看到连接 pts/0 和 pts/1 和 netstat -n 给我两个防火墙（星巴克和我的）的 IP 地址及其 10000+ 端口号以及我的 ubuntu 服务器地址和端口22\. 我在 ubuntu 机器上的 ssh 服务器开启了 TCPForwarding。

现在如何将 putty 配置为隧道 rdp 以便我可以访问我的家庭服务器？我是否必须在 ubuntu 实例上做额外的工作来转发 rdp 数据包？

win-laptop--->starbucks-firewall--->ec2-ubuntu-micro-instance<--my-firewall<--my-win-desktop

谢谢你的听众。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-18T18:11:19.460

如果您的台式机和笔记本电脑都运行 OS X / Linux / BSD，我建议在您的桌面上运行它：

```
autossh -R 127.0.0.1:3389:127.0.0.1:3389 your.ec2.instance 
```

这在你的笔记本电脑上：

```
ssh -L 127.0.0.1:3389:127.0.0.1:3389 your.ec2.instance 
```

然后，您就可以在笔记本电脑上打开到 localhost 的 rdp 连接，并将其转发到您的桌面。您不需要对您的 ec2 实例进行任何其他配置。我假设您的笔记本电脑上没有运行 RDP 服务器。

那么我们如何使用 Putty 做到这一点呢？（我在这里稍微猜测一下。）

*   在左侧窗格中选择“连接 → SSH → 隧道”类别
*   对于“源端口”输入“3389”
*   对于“目的地”输入“127.0.0.1:3389”
*   选择“本地”（用于从您的笔记本电脑连接）或“远程”（用于从您的桌面连接）
*   点击“添加”
*   然后，您将希望将这些详细信息保存在“会话”类别中

理想情况下，如果由于某种原因断开连接，您会希望重新启动桌面连接。（如果您的家庭互联网与我的一样，它会偶尔出现故障并断开连接。但也许您的家庭互联网比我的更可靠。）

# cakephp - cakephp 中的 requestAction 和 useTable

> ID：15483077
> 
> 赞同：0
> 
> 时间：2013-03-18T17:27:15.417
> 
> 标签：cakephp, behavior

我对 cakePHP 的 requestAction 对象有疑问。我想检索模型的最后 5 个结果，但我使用视图表。

所以在我的行动中，我把`$this->Model->useTable = 'models_view';`

但是当我调用我的操作时`$this->requestAction(array('controller'=>'models','action'=>'lastFive'));`，蛋糕使用默认表，而它应该使用我的视图表......

并且还给我一个错误，因为我在初始表中不存在的字段中使用了条件（但在我的视图中存在）。

如果有人有想法？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T20:28:24.740

在运行时更改`Model->useTable`不能正常工作，因为一旦模型被初始化，CakePHP 会缓存数据库表的模式。

要切换到另一个表并清除缓存模式，请使用

```
$this->MyModel->setSource('tablename'); 
```

这将使用“新”表的信息清除并刷新模型中缓存的模式信息。“表名”可以是“表”或数据库“视图”

文件；[http://api.cakephp.org/2.3/source-class-Model.html#1100-1125](http://api.cakephp.org/2.3/source-class-Model.html#1100-1125)

# c++ - 使用数组实现 C++ 装饰器模式

> ID：15483082
> 
> 赞同：0
> 
> 时间：2013-03-18T17:27:24.333
> 
> 标签：c++, design-patterns, implementation, decorator

我在 C++ 中实现了装饰器模式，如下所示：

```
#include <iostream>
#include <string>
#include <deque>
using namespace std;

// Abstract Component
template <class T>
class IArray 
{
public:
   virtual void insert(const T&) = 0;
   virtual ~IArray(){}

};

// Concrete Component
template <class T>
class Array : public IArray<T>
{
public:
   virtual void insert(const T& elem)
   {
      m_array.push_back(elem);
   }

private:
   deque<T>   m_array;
};

// Decorator 1
template <class T>
class PositiveArray : public IArray<T>
{
public:
   PositiveArray(IArray<T>* component):m_component(component)
   {

   }

   virtual void insert(const T& elem)
   {
      if (elem > 0)
      {
         m_component->insert(elem);
      }
      else
      {
         cerr << "You can't insert non-positive number." <<endl;
      }
   }
private:
   IArray<T>*   m_component;
};

// Decorator 2
template <class T>
class PrintArray : public IArray<T>
{
public:
   PrintArray(IArray<T>* component):m_component(component)
   {

   }

   virtual void insert(const T& elem)
   { 
      m_component->insert(elem);
      cout << "Element " << elem << " was inserted into the array." <<endl;
   }
private:
   IArray<T>*   m_component;
};

// Client
int main()
{
   typedef int MyType;

   PositiveArray<MyType> arr(new PrintArray<MyType>(new Array<MyType>));
   arr.insert(10);
   arr.insert(-10);

   int i;
   cin>>i;
   return 0;
} 
```

现在我想拥有所有数组`printArray`功能。我应该将它写为 IArray 中的纯虚函数并在 IArray 的每个子项中复制该函数的以下实现吗？

```
 void printArray()
   {
      for (int i = 0; i < m_array.size(); ++i)
      {
         cout << "elem " <<i << " is " << m_array[i] <<endl;
      }
   } 
```

有没有可以避免复制的解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T17:35:44.023

我会`for_each_element`在其中一个中实现`Array`，并在`IArray`. 它有 2 个需要`std::function< void(T const&) >`和的重载`std::function< void(T) >`（第二个是可选的）。现在`PrintArray`是一个单行 lambda 函数。

在 C++03 中你可以使用`boost::function`,`PrintArray`写起来更烦人。所以在这里它不那么诱人。

作为另一种方法，将`const_iterator`s 暴露给基础数据。

顺便说一句，`deque`性能出奇的差。到目前为止，您的代码中没有任何内容让我认为您不能使用`std::vector`. 如果您保证内存连续性，您甚至可以让您`const_iterator`的 s 成为`T const*`并直接从`IArray`（使用 中的实现`Array`）公开接口。 `for_each_element`在 C++11 中变成了两行，`PrintArray`即使没有 C++11 或者`for_each_element`是 2 行，并且要么内联实现，`IArray`要么作为自由函数实现。

哦，我会做`PrintArray`一个自由函数而不是成员函数。 `for_each_element`可能需要成为成员函数，但是`PrintArray`一旦公开迭代器和/或`for_each_element`.

# html - 是否有css文本重置？

> ID：15483083
> 
> 赞同：8
> 
> 时间：2013-03-18T17:27:26.113
> 
> 标签：html, css, text, padding

你好我有这个问题：

![问题](../Images/d3609426b0499a4b1d363e3f8e849517.png)

如您所见，左侧是chrome的屏幕截图，右侧是firefox。文字的高度不同。html的结构很简单。它只是一个 div，其中是一个放置 h1 标记的字段集。周围有1px的边框。该 h1 标签的高度为 20px，甚至行高为 20px。接下来是一个大小相同的 h2 标签。问题是文本高度。

![示例2](../Images/3d08f3d5df5e2811a134cc3d49e34a84.png)

在 Firefox 中，这似乎比 chrome 和 safari 低 1px。

我在其最新版本中使用来自 eric meyers 的 css 重置。所以它不应该由此引起。

如果有人有帮助我的提示，那就太好了。

多谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T17:53:25.953

默认行高在不同的浏览器和不同字体大小的不同字体系列中相差很大。设置一个显式的 line-height 可以解决这个问题。

这是由于浏览器处理亚像素文本定位的方式不同。如果你的 line-height 是 20 像素，而 font-size 是 15 像素，那么文本需要放置在距离行框顶部 2.5 像素的位置。Gecko 实际上是这样做的，而 WebKit 只是将位置四舍五入到整数像素。在某些情况下，这两种方法给出的答案相差一个像素。

在任何情况下，如果你真的需要，确保你的半前导是一个整数（即 line-height 减去 font-size 是偶数）将使渲染更加一致。

试试这个：

```
div h1 {
  -webkit-padding-before: 1px;
} 
```

* * *

另一种可能的解决方案：

```
@media screen and (-webkit-min-device-pixel-ratio:0) {
    div h1 {
        line-height:19px;
    }
} 
```

# php - php mysql .htaccess 错误

> ID：15483084
> 
> 赞同：1
> 
> 时间：2013-03-18T17:27:28.140
> 
> 标签：php, mysql, .htaccess

我正在为使用 PHP、MySQL 和`.htaccess`（这是我第一次使用`.htaccess`文件）的用户创建个人资料页面。

昨天它运行良好，我能够制作这样的 URL，`(http://localhost/Unnamed site 2/resources/*username*)`但今天我可以做到，浏览器给了我以下错误消息：

> **内部服务器错误**
> 
> 服务器遇到内部错误或配置错误，无法完成您的请求。请联系服务器管理员 admin@localhost 并告知他们错误发生的时间，以及您所做的任何可能导致错误的事情。服务器错误日志中可能提供有关此错误的更多信息。

我该如何解决这个问题？以下是相关代码：

**配置文件.php**

```
if (isset($_GET['u'])) {
    $username = mysql_real_escape_string($_GET['u']);

    if (ctype_alnum($username)) {
        // Check that the user exists
        $check = mysql_query("SELECT user_name, first_name FROM user WHERE user_name = '$username' ")or die(mysql_error());
        if (mysql_num_rows($check) == 1) {
            $get = mysql_fetch_assoc($check);
            $username = $get['user_name'];
            $fname = $get['first_name'];
        } else {
            // this line is to redirect the non-existent users to the index.php
            echo "<meta http-equiv=\"refresh\" content=\"0; url=http://localhost/Unnamed Site 2/resources/index.php\">";
            exit();  
        }
    }
}

// echo "$username"; 
```

**.htaccess**

```
RewriteEngine On
RewriteRule ^([a-zA-Z0-9_-]+)$ profile.php?u=$1 
```

# paypal - 贝宝快递选项

> ID：15483086
> 
> 赞同：0
> 
> 时间：2013-03-18T17:27:38.730
> 
> 标签：paypal

我正在考虑使用 Paypal express 作为新电子商务网站的选项。我已经搜索了这个问题的答案，但似乎找不到答案。例如，我的问题与您将如何在 Etsy 上使用 Paypal 结账有关。假设总售价为 20 美元，当买家在登录 Paypal 后被重定向回 Etsy 以便收集他们的信息时，Etsy 会在什么时候收取他们的佣金？Etsy 会不会只收取他们的佣金，而剩余的款项会直接支付给卖家，而 Etsy 不会触及卖家的部分？对于我的网站，20 美元（例如）需要直接转给卖家，同时我的公司收取我们的佣金，而卖家部分的任何销售部分在任何时间都不会在我的 Paypal Express 帐户中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T17:50:52.840

这取决于他们如何处理付款。他们可能会使用 Express Checkout 和并行付款。基本上，当执行 DoExpressCheckoutPayment API 调用时，交易将被拆分到不同的帐户中。

# java - 存储 Runtime.getRuntime().exec(command); 的 o/p

> ID：15483088
> 
> 赞同：0
> 
> 时间：2013-03-18T17:27:48.417
> 
> 标签：java, runtime.exec

我是 java 新手.....我在 zip 文件夹中有 3 个文件，我正在使用它来提取它

```
String command = "cmd /c start cmd.exe /K \"jar -xvf record.zip\"";
     Process ps= Runtime.getRuntime().exec(command); 
```

在使用 jar -xvf 提取这些文件后，我需要将 record.zip 中存在的所有三个文件存储到一个字符串中

```
BufferedReader br=new BufferedReader(new InputStreamReader(ps.getInputStream())); 
     String temp = br.readLine();
     while( temp != null ) { //!temp.equals(null)) {
         output.write(temp);
         temp = br.readLine();
         }
         output.close(); 
```

我试过这段代码，但它没有给我想要的结果....提前谢谢....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T17:43:19.813

您可以使用 JDK 中已有的功能来读取 zip 文件，例如，这会将 zip 中所有文件的内容逐行打印到控制台：

```
public static void main(String[] args) throws ZipException, IOException {
    final File file = new File("myZipFile.zip");
    final ZipFile zipFile = new ZipFile(file);
    final Enumeration<? extends ZipEntry> entries = zipFile.entries();
    while (entries.hasMoreElements()) {
        final ZipEntry entry = entries.nextElement();
        System.out.println(entry);
        if (!entry.isDirectory()) {
            final BufferedReader reader = new BufferedReader(new InputStreamReader(zipFile.getInputStream(entry)));
            for (String line = reader.readLine(); line != null; line = reader.readLine()) {
                System.out.println(line);
            }
        }
    }
    zipFile.close();
} 
```

# php - MySQL 查询中的 Strtotime [基本 PHP 页面]

> ID：15483090
> 
> 赞同：0
> 
> 时间：2013-03-18T17:27:55.093
> 
> 标签：php, mysql

在不使用模板引擎的情况下，我一直在给自己上一门 PHP 基础进修课程（虽然我最近学习了一些 Smarty 和 Twig，但我觉得我应该继续练习基础 PHP），这是我的基本页面，显示车辆列表以及何时他们已注册：

```
 <?php 
 // Connects to your Database 
 mysql_connect("localhost", "testing", "testingpass") or die(mysql_error()); 
 mysql_select_db("cars1") or die(mysql_error()); 
 $data = mysql_query("SELECT * FROM autos") 
 or die(mysql_error()); 
 echo "<table border cellpadding=3>"; 
 while($info = mysql_fetch_array( $data )) 
 { 
 "<tr>"; 
 //echo "<td>"date("d M Y",strtotime($info['registered']));"</td> "; 
 echo "<td><tr>".$info['make'] ." ".$info['model'] ."</td><tr> "; 
 } 
 echo "</table>"; 
 ?> 
```

如果日期时间被注释掉，它会起作用，但如果没有注释，页面会显示为空白 - 我使用 MAMP 作为我的网络服务器，最新的 PHP。

对于一个简单的页面，这很好用，但我应该如何格式化这个日期？[（我使用http://erikastokes.com/mysql-help/display-mysql-dates-in-other-formats.php](http://erikastokes.com/mysql-help/display-mysql-dates-in-other-formats.php)上的教程来尝试这个）。

我应该做些什么改变来解决这个日期和时间的问题，否则它可以很好地作为一个基本的 MySQL php 查询。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T17:30:31.310

it should be like this

```
echo "<td>".date("d M Y",strtotime($info['registered']))."</td> "; 
```

You have to use `.` for concantinate string.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T17:30:45.367

First off, the reason your screen is blank, is because most default PHP installs have error reporting turned off. You'll need to edit your php.ini file to fix that. Open and search for `display_errors` and change it.

Second, the first error you're missing is you just have `"<tr>"` with no `echo` before it.

The second error you're most likely not seeing is that you're missing a concatenating operator `.`

```
echo "<td>"date("d M Y",strtotime($info['registered']));"</td> " 
```

should be

```
echo "<td>" . date("d M Y",strtotime($info['registered'])) . "</td> " 
```

# jquery - 如果屏幕宽度小于 500 像素，Jquery 将启动

> ID：15483094
> 
> 赞同：2
> 
> 时间：2013-03-18T17:27:59.323
> 
> 标签：jquery, width, screen, show-hide

我有这个代码，如果点击就会显示内容。问题是这个功能只有在屏幕/设备宽度最大为 500 像素时才可用。我该怎么做呢？

```
$(function () {
    $('.row1').hide();
    $('#show').toggle(function () {
        $('.row1').slideDown("slow");
        $(this).attr("src", "bilder/cancel.png");
    }, function () {
        $('.row1').slideUp("slow");
        $(this).attr("src", "bilder/add.png");
    });
}); 
```

更新：我没有很好地解释我想要完成的事情：/我希望当屏幕宽度高于 500 像素时显示此图像。当宽度小于 500 像素时，我想要一条线，上面写着 click here to show image 并出现图像

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-18T17:30:43.867

You need to first get the screen width and then you can use an if statement to then run the code you posted above, if the screen width is above the certain width.

For example.

```
if($(window).width() > 500){
   $('.row1').hide();
   $('#show').toggle(function(){
      $('.row1').slideDown("slow");
      $(this).attr("src","bilder/cancel.png" );
   },function(){
      $('.row1').slideUp("slow");
      $(this).attr("src", "bilder/add.png" );
   });
}; 
```

**EDIT**

Looking at your comments you want to show an image else hide it. I would probably agree this would be nicer and easier to do with css media queries but please see the below edit which shows a JS solution.

```
if($(window).width() > 500){
   //show the image
   $('.row1').slideDown("slow");
   //etc...   
}else{
   //hide the image
   $('.row1').slideUp("slow");
   //etc...
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-18T17:30:23.307

Try tracking `screen.width` and `screen.height`.

Something like this:

```
 function doSomething(){
        if (screen.width < 500){
            //Do Something
       }
    } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-18T17:31:22.590

You can bind the event when the size of the window is less than 500, or use an if statement in your handler. Note that `toggle` event method is deprecated, you can use `slideToggle` method instead.

```
$(function () {
    var $row = $('.row1').hide();
    $('#show').click(function () {
        if ($(window).width() > 500) return;
        $row.stop().slideToggle("slow");
        $(this).prop("src", function(i, src){
            return src === "bilder/cancel.png" 
                   ? "bilder/add.png" 
                   : "bilder/cancel.png";
        });
    });
}); 
```

Or:

```
$(function () {
    if ($(window).width() > 500) {
       var $row = $('.row1').hide();
       $('#show').click(function () {
           $row.stop().slideToggle("slow");
           $(this).prop("src", function(i, src){
                return src === "bilder/cancel.png" 
                       ? "bilder/add.png" 
                       : "bilder/cancel.png";
           });
       });
    }
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-18T18:00:41.297

您还可以将函数绑定到`resize`事件。每当调整浏览器窗口大小时，这将调用您的函数。

```
function myFunction() {
    if($(window).width() > 500)
    {   
        //Code to run when greater than...
    }
    else
    {
        //Code to run when less than...
    }
}

//initialize
myFunction();

//call when the page resizes.
$(window).resize(function() {
    myFunction();
}); 
```

您可以在此处查看工作的可视化示例：http: [//jsfiddle.net/q6BpH/1/](http://jsfiddle.net/q6BpH/1/)

# api - wso2 api manager 配置 STORE 和 PUBLISHER 安全性

> ID：15483100
> 
> 赞同：0
> 
> 时间：2013-03-18T17:28:21.777
> 
> 标签：api, wso2

我正在运行 API Manager 1.3.0 版，并且已成功将管理控制台连接到我们的 Active Directory 域。我可以毫无问题地登录管理控制台，但无法登录发布者或商店。

文档听起来好像一旦 user-mgt.xml 的配置完成，它应该可以工作。我错过了什么？任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T17:55:40.307

尝试登录 Store/Publisher 时，UI 中显示并打印在终端中的错误消息是什么？[您是否按照http://dist2.wso2.org/products/api-manager/1.3.0/APIManager-GettingStarted-v1.3.0.pdf](http://dist2.wso2.org/products/api-manager/1.3.0/APIManager-GettingStarted-v1.3.0.pdf)中所述为尝试用户的角色添加了必要的权限

谢谢;

# jquery - 在 jquery ajax 请求中使用当前 URL（具有特定 ID）

> ID：15483102
> 
> 赞同：1
> 
> 时间：2013-03-18T17:28:35.280
> 
> 标签：jquery, ruby-on-rails, ajax, url

我已经在 SO 上查看了类似标题的问题，但还没有找到有同样问题的人。使用 jQuery，我试图发出一个 ajax 请求，而不必指定整个`url`参数。例如，如果我在页面上`www.foo.com/bar`并想向 发送 ajax 请求`www.foo.com/bar/woot`，我可以简单地设置导致请求的`url`参数- 听起来不错。`/bar/woot``www.foo.com/bar/woot`

但是，这适用于该页面`bar`位于站点根目录的情况。就我而言，我在页面上`www.foo.com/users/1`（我正在开发一个有多个用户的 RoR 应用程序），并且想向`www.foo.com/users/1/bar`. 我认为只需将`url`参数设置为`bar`（没有前面`/`从根开始）就可以了，而且它*有点像*. 将`url`参数设置为 时`bar`，发出了 ajax 请求（显然，我希望看到夹在and之间`www.foo.com/users/bar`的用户 ID 省略了）。`/1/``users``bar`

我还使用 ruby​​-on-rails 标签进行了搜索，但没有发现任何关于这是特定于 RoR 的问题。我显然可以通过将用户 id 传递给函数并将其简单地插入 url 来解决这个问题，即 `url:"/users/"+user_id+"/bar"，但这很蹩脚。

对我来说奇怪的是，`/1/`它绝对是 url 的一部分（如果我没记错的话），而不是像`#1`片段那样不会成为请求的一部分的东西 - 那么为什么它会被丢弃？

**更新**
有一些简单的方法可以在 jQuery 中完成我想要的，例如将`url`参数更改`window.location.href()+"/bar"`为`.href()`调用将`/1/`在当前 url 中包含 ，但是我想知道是否有解释为什么*只*指定参数不包括ajax 请求使用的构造 url 中的 。`bar``url``/1/`

有任何想法吗？提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T12:13:43.443

这将起作用。

```
var current_href = window.location.href()
window.location.replace(current_href + '/bar') 
```

这将加载网址`www.foo.com/users/1/bar`

# python - Python字典内存不足

> ID：15483107
> 
> 赞同：2
> 
> 时间：2013-03-18T17:28:55.267
> 
> 标签：python, dictionary

我正在尝试在hackerrank.com 上编写这个问题：

[https://www.hackerrank.com/challenges/find-strings](https://www.hackerrank.com/challenges/find-strings)

我的代码在小情况下运行良好，但在大情况下我的字典很快就会耗尽内存。我能做些什么来解决这个问题？我不想使用列表，因为那样检查条目是否已经存在需要很长时间......这是我的代码：

```
n = int(raw_input())
words = []
for x in range(n):
    words.append(raw_input())
test = int(raw_input())
queries = []
for x in range(test):
    queries.append(raw_input())

dict_of_subwords = {}
for x in words:
    len_of_x = len(x)
    for i in range(len_of_x):
        for j in range(i, len_of_x):
            dict_of_subwords[x[i:j+1]] = 1

list_of_subwords = dict_of_subwords.keys()
list_of_subwords.sort()
for x in queries:
    try:
        print list_of_subwords[int(x)-1]
    except:
        print "INVALID" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T02:48:43.173

由于许多关于制作更节省内存的版本的建议，这里有一个版本试图最小化存储量（同时仍然使用相同的算法方法）：

```
subwords = set()

num_words = int(raw_input())
for i in xrange(num_words):
    word = raw_input()
    for i in xrange(len(word)):
        for j in xrange(i, len(word)):
            subwords.add(word[i:j+1])

subwords = sorted(subwords)

num_queries = int(raw_input())
for x in range(num_queries):
    query = raw_input()
    try:
        print subwords[int(query)-1]
    except:
        print "INVALID" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-06T11:00:49.960

你必须使用后缀数组，[wiki](http://en.wikipedia.org/wiki/Suffix_array)

[python中的后缀数组实现：](https://code.google.com/p/pysuffix/)

**后缀数组与后缀树密切相关：**

*   可以通过执行后缀树的深度优先遍历来构造后缀数组。如果边按其第一个字符的字典顺序访问，则后缀数组对应于在遍历期间按访问顺序给出的叶标签。
*   通过使用后缀和 LCP 数组的组合，可以在线性时间内构建后缀树。有关算法的描述，请参阅 LCP 阵列文章中的相应部分。

# asp.net - ASP.NET 和 Web Tools 2012.2 引用 LESS 文件

> ID：15483109
> 
> 赞同：5
> 
> 时间：2013-03-18T17:28:59.853
> 
> 标签：asp.net, visual-studio, less, intellisense

我刚刚安装了[ASP.NET 和 Web Tools 2012.2](http://weblogs.asp.net/scottgu/archive/2013/02/18/announcing-release-of-asp-net-and-web-tools-2012-2-update.aspx)。

它最终为编辑 LESS 文件提供了一流的支持，包括语法突出显示、智能感知和验证。

我的问题是，我的 mixins 和变量文件位于单独的文件中，并且捆绑是动态完成的，因此 Intellisense 不会为它们提供帮助。如何在不使用的情况下在我的 LESS 文件中添加对这些文件的引用`@import`？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-18T17:28:59.853

您可以添加对 LESS 文件的引用，就像在 Visual Studio 中为 JavaScript 文件所做的那样：

```
/// <reference path="../../_variables.less" /> 
```

# c# - 在限制请求数量的同时从 REST 服务异步检索信息

> ID：15483114
> 
> 赞同：4
> 
> 时间：2013-03-18T17:29:14.240
> 
> 标签：c#, .net, async-await

我有一个程序需要从 Atom 提要中获取一些数据。我尝试了两种方法，但都没有奏效。

我已经使用 WebClient 同步下载了我需要的所有帖子，但是由于有几千个并且服务很慢，因此需要几个小时。

我已经（第一次）尝试了 async/await、新的 HttpClient 和 Task.WhenAll。不幸的是，这会导致成千上万的请求访问服务并将其关闭。

如何并行运行 100 个请求？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T18:24:24.467

您可以将 Parellel 与 ParallelOptions.MaxDegreeOfParallelism 一起使用

[ParallelOptions.MaxDegreeOfParallelism 属性](http://msdn.microsoft.com/en-us/library/system.threading.tasks.paralleloptions.maxdegreeofparallelism.aspx)

或具有有限集合大小的 BlockingCollection

[BlockingCollection 概述](http://msdn.microsoft.com/en-us/library/dd997371.aspx)

我会推荐 BlockingCollection

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T17:44:28.713

听起来您已经有了一个解决方案，您可以一次完成很多工作。我建议只在上面添加另一层，它只是循环遍历所有帖子，但一次只处理 100 个。

现在你可能有： DownloadAll(List ListofPosts) 在 DownloadAll 里面你可能在最后等待。

代替： For 循环从 1 到 ( ListofPosts Count / 100) DownloadAll(ListofPosts.Skip(xxx).Take(100));

显然那里不是真正的代码，但是你可以做 100 个块，而对你的 main 函数几乎没有改变。

# python - python中的正则表达式捕获第一个运算符

> ID：15483115
> 
> 赞同：1
> 
> 时间：2013-03-18T17:29:15.797
> 
> 标签：python, regex

我正在尝试解析以下模式：

> name1 操作员 name2

其中“运算符”是 &、^ 或 | 之一

组应该是`(name1 operator name2,name1,operator,name2)`

现在，任一名称也可以包含`&,| or ^`和空格，但只有第一次出现才会使运算符。进一步出现将被视为 name2 的一部分。

我已经为此苦苦挣扎了一段时间，而且我有

```
\s*(\w+\s*\w*)\s*([&|^])\s*(\w+\s*\&*\w+) 
```

看起来不是很锋利，也不起作用。此外，如果有一个类似的函数`str.partition()`可以与正则表达式一起使用并将结果限制为 1，那就太好了。我找不到一个。

关于正则表达式或函数的任何想法？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-18T17:32:01.480

```
In [163]: re.split(r'\s*([&|^])\s*', 'name1|name2', maxsplit=1)
Out[163]: ['name1', '|', 'name2'] 
```

`maxsplit=1``re.split`最多进行 1 次匹配的原因：

```
In [164]: re.split(r'\s*([&|^])\s*', 'name1|nam^e2', maxsplit=1)
Out[164]: ['name1', '|', 'nam^e2'] 
```

您还可以使用非贪婪搜索：

```
In [184]: re.search(r'\s*(.*?)\s*([&|^])\s*(.*?)\s*', 'name1 | nam^e2').groups()
Out[184]: ('name1', '|', 'nam^e2') 
```

This has the advantage of also tripping off the whitespace at the beginning and end of the string.

The non-greediness of the first group, `(.*?)` allows `([&|^])` to match the first occurrence of `&`, `|`, or `^`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T17:44:38.940

An option to remove extra spaces:

```
>>> re.search(r'^\s*(.+?)\s*([&|^])\s*(.+?)\s*$', ' foo | bar & lol ').groups()
('foo', '|', 'bar & lol') 
```

# django - Django cache.set() 在具有 GenericForeignKey 的类上失败，可能是什么原因？

> ID：15483116
> 
> 赞同：2
> 
> 时间：2013-03-18T17:29:27.763
> 
> 标签：django, memcached, picking, django-cache

我有一个带有`GenericForeignKey`. 调用`cache.set(key, trac_obj)`时，失败。我想知道`GenericForeignKey`是不是罪魁祸首？

```
# models.py
class Trac(models.Model):

    user = models.ForeignKey(User, related_name="%(class)s", null=False)
    content_type = models.ForeignKey(ContentType)
    object_id = models.PositiveIntegerField()
    content_object = generic.GenericForeignKey('content_type', 'object_id')

    class Meta:
        unique_together = (('user', 'content_type', 'object_id'),)

# views.py
obj = SomeUserProfile # Django UserProfile (or any other model object)
content_type = ContentType.objects.get_for_model(type(obj))
trac_obj = Trac(user=request.user, content_type=content_type, object_id=obj.pk,
                                   content_object=obj)
trac_obj.save()
cache_key = 'Trac-{0}-{1}-{2}'.format(user.id, content_type.id, obj.id)
cache.set(cache_key, trac_obj) 
```

这是错误消息：

```
File ".../python2.7/site-packages/memcache.py", line 751, in _val_to_store_info
pickler.dump(val)
File "/usr/lib/python2.7/copy_reg.py", line 70, in _reduce_ex
raise TypeError, "can't pickle %s objects" % base.__name__
TypeError: can't pickle instancemethod objects 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-06-18T12:37:19.633

该错误似乎是因为无法直接腌制该`.save()`方法的结果。在保存对象之前尝试设置缓存。

如果你必须腌制`.save()`，似乎有一些方法在这个OP的答案中详细说明：http: [//bytes.com/topic/python/answers/552476-why-cant-you-pickle-instancemethods](http://bytes.com/topic/python/answers/552476-why-cant-you-pickle-instancemethods)

# javascript - 在追加之前编辑 var 中的 DOM 元素

> ID：15483118
> 
> 赞同：0
> 
> 时间：2013-03-18T17:29:29.793
> 
> 标签：javascript, jquery, dom, append

我有一个函数将元素附加到使用模板调用它的页面，如下所示：

```
 var plantillaTemplate = '<div class="contenedor-oferta"><a class="link" href="${enlace}" target="_blank"><!-- Linia superior --><div class="titol">${titulo}</div><!-- Columna esquerra --><div class="left"><div class="foto"> <img class="imatge-oferta" src="${enlaceFoto}"> </div><div class="enlace"><span>Precio alojamiento desde</span><br><span id="test">${precio} $ </span></div></div><!-- Columna dreta --><div class="right"><span>${textoOferta}</span></div></a> </div>';      

    for (var i = 0; i < num_productos; i++) {
        var dataActual = data[i];               
        var valores = { "enlace"        : dataActual['enlace'][idioma],
                        "titulo"        : dataActual['titulo'][idioma],
                        "enlaceFoto"    : dataActual['imagen'][idioma],
                        "precio"        : dataActual['camping'],
                        "textoOferta"   : dataActual['descripcion'][idioma]};           

        var test = $.tmpl(plantillaTemplate, valores).appendTo("#divOfertas");  
    } 
```

我有一个函数参数，说明哪些附加元素部分可见，哪些不可见。所以我想要做的是访问测试变量中的一个元素，就像我对 jQuery 所做的那样并禁用它。

有没有办法做到这一点？

PD：我知道我可以在追加之后执行此操作，但我想在此之前执行此操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T17:44:43.463

调用之后`$.tmpl`，生成的 jQuery 对象应该能够支持禁用元素所需的所有常用 jQuery 方法，即使它们尚未添加到 DOM 中。例如：

```
var test = $.tmpl(plantillaTemplate, valores).find('.test').prop('disabled', true).end().appendTo("#divOfertas"); 
```

使用该`.find()`方法通过传递通常的选择器字符串来关注一组特定的元素。OP 提到了“禁用”元素，所以我认为该`.prop('disabled', true)`方法是您正在寻找的。最后，该`.end()`方法确保您将整批 HTML 附加到文档中，而不仅仅是`.find()`.

# php - Php myadmin - 我的代码不会创建表

> ID：15483120
> 
> 赞同：0
> 
> 时间：2013-03-18T17:29:34.440
> 
> 标签：php, mysql, phpmyadmin

尝试使用 PhpMyadmin 创建表时，我不断收到语法错误。

我做错了什么？

```
CREATE TABLE `cust`
(
    `cust5_id` Integer auto_increment primary key,
    `prog_id` Integer not null,
    `cust_no` Integer null,
    `balance` Integer  - accept negative and positive numbers
)

INSERT INTO `cust`
(`cust5_id`,`prog_id`,`cust_no`,`balance`)
VALUES
(1,217770,145094,-178.01),
(2,219885,145113,-390.86),
(3,219888,145164,-206.55),
(4,226227,145279,0),
(5,227700,145340,0),
(6,219911,145344,0),
(7,227795,145410,-44.1),
(8,227796,145472,0),
(9,219919,145481,0),
(10,225616,145604,0),
(11,219942,145668,0),
(12,219943,145682,0),
(13,219966,145694,0),
(14,219973,145731,-210.6),
(15,219977,145782,0) 
```

编辑：更改：

最后去掉逗号，没有区别。

错误代码总是#1064，或者如果我稍微编辑它，“-###”条目就会出现问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T17:31:49.293

最后有一个随机逗号。

去掉它。

* * *

此外，如果您将其作为一个查询集运行，那么您需要`;`在每个部分之后添加一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T17:34:14.643

您的评论需要两个尾随连字符：

```
CREATE TABLE `cust`
(
    `cust5_id` Integer auto_increment primary key,
    `prog_id` Integer not null,
    `cust_no` Integer null,
    `balance` Integer  -- accept negative and positive numbers
); 
```

![在 phpmyadmin 中创建表](../Images/5a34169a89f4bfe28d1b7c257559a5a8.png)

并且您需要在插入末尾使用分号而不是逗号：

```
INSERT INTO `cust`
(`cust5_id`,`prog_id`,`cust_no`,`balance`)
VALUES
(1,217770,145094,-178.01),
(2,219885,145113,-390.86),
(3,219888,145164,-206.55),
(4,226227,145279,0),
(5,227700,145340,0),
(6,219911,145344,0),
(7,227795,145410,-44.1),
(8,227796,145472,0),
(9,219919,145481,0),
(10,225616,145604,0),
(11,219942,145668,0),
(12,219943,145682,0),
(13,219966,145694,0),
(14,219973,145731,-210.6),
(15,219977,145782,0); 
```

![在 phpmyadmin 中插入](../Images/4bff40ab2aa81c4967aa3ef52a18f92f.png)

# django - 用于 POST 和 PUT 的 RESTful API 和外键处理

> ID：15483122
> 
> 赞同：2
> 
> 时间：2013-03-18T17:29:39.497
> 
> 标签：django, api, rest, python-2.7, django-rest-framework

我正在帮助为*现有*数据库开发新的 API。

我正在使用 Python 2.7.3、Django 1.5 和 django-rest-framework 2.2.4 和 PostgreSQL 9.1

我需要/想要好的 API 文档，但我人手不足，我讨厌编写/维护文档（我的许多缺陷之一）。

我需要允许 API 的消费者添加新的“POS”（销售点）位置。在 Postgres 数据库中，有一个从 pos 到 pos_location_type 的外键。所以，这是一个简化的表结构。

```
pos_location_type(
  id serial,
  description text not null
);

pos(
   id serial,
   pos_name text not null,
   pos_location_type_id int not null references pos_location_type(id)
); 
```

所以，为了让他们发布一个新的 pos，他们需要给我一个“pos_name”和一个有效的 pos_location_type。所以，我整个周末都在阅读这些东西。那里有很多争论。

我的 API 使用者如何知道 pos_location_type 是什么？或者在这里传递什么值？

看来我需要告诉他们在哪里可以获得有效的 pos_locations 列表。就像是：

```
GET /pos_location/ 
```

快速说明一下，pos_location_type 描述的示例可能是：('school', 'park', 'office')。

我真的很喜欢 Django REST 框架的“可浏览性”，但是，它似乎并没有解决这类问题，实际上我今天早些时候在 IRC 上与 Tom Christie 进行了非常愉快的交谈，他并没有真的有一个关于在这里做什么的答案（或者也许我从来没有明确我的问题）。

我看过 Swagger，这是一个非常酷/有趣的项目，但请在[此处的演示](http://petstore.swagger.wordnik.com/#!/pet)中查看他们的“宠物”资源。请注意，这与我需要做的非常相似。要添加新宠物，您需要传递一个类别，他们将其定义为类 Category(id: long, name: string)。消费者如何知道要在这里传递什么？什么是有效身份证？或名字？

在 Django rest 框架中，我可以定义/覆盖 OPTION 调用中返回的内容。我想我可以在这里提出我自己的小“系统”并返回一些信息，例如：

```
 pos-location-url: '/pos_location/' 
```

在通用形式中，它将是： {resource}-url: '/path/to/resource_list'

这对文档方面来说有点用，但我不确定这是否真的是一个很好的编程解决方案。如果我更改资源位置怎么办。这意味着我的消费者需要以编程方式制作和 OPTIONS 调用资源来找出所有关系。也许不是坏事，但感觉有点奇怪。

那么，人们如何处理这种事情呢？

最后的说明：我知道我真的不想要一个“泄漏”的抽象，并让我的数据库通过 API 层达到峰值，但事实仍然是这个*现有*数据库和任何插入都有一个 foreign_key 约束。 t 有一个有效的 pos_location_type_id 会引发错误。

另外，我并不是要展开 URI 与 ID 的辩论。*对于本次*讨论，用户是否必须使用 pos_location_type_id int 值或 URI 无关紧要。无论哪种情况，他们都不知道该给我寄什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T18:05:33.577

我过去曾使用过这种东西。我认为有两种方法可以解决这个问题，第一种你已经说过了，允许 API 用户的端点知道`pos_location_type`. 许多 API 这样做是因为从您的 API 开发的人必须阅读您的文档并且知道从哪里获取`pos_location_type`值。最终用户不必担心这一点，因为他们将有一个界面显示可能是文本值的下拉列表。

另一方面，我的工作方式也不是很像 RESTful。假设您在纽约有一个位置，POST 可能类似于：

```
POST /pos/new_york/ 
```

您可以通过规范化文本来处理 /pos/(location_name)/，然后只需在数据库中搜索值或某些相似性，如果位置不存在，则只需创建一个新位置。如果用户可以添加新地点，如果不能，那么用户必须知道存在哪些固定地点，这也是我们所处的第一种情况。

这样您就可以避免`pos_location_type`在请求数据中，您可以以编程方式将其映射到有效 ID。

# c# - Multitasking in windows form in c#

> ID：15483126
> 
> 赞同：-3
> 
> 时间：2013-03-18T17:29:51.210
> 
> 标签：c#, multithreading, winforms, asynchronous

Here in my code....

```
List<Task> t;

private void Form1_Load(object sender, EventArgs e)
{
    t = new List<Task>();
    t.Add(Task.Factory.StartNew(() => Download()));
    t.Add(Task.Factory.StartNew(() => Display()));
} 
```

Now in display method when I hide any control it gives me a "cross thread exception" and tell that it is used by main thread.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T17:38:56.433

很明显，`Display`方法运行在与创建它的线程不同的线程上。

您只能从主线程对 WinForm 控件进行更改。您需要检查控件上的 InvokeRequired 是否为 true，然后根据需要调用该方法。

更新任何有关控制的信息。

你可以试试这种方式：

```
if (this.InvokeRequired)
{
    this.Invoke((MethodInvoker)delegate { update the ui control here});
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T17:39:28.073

您必须在主线程上调用您的操作。您需要执行以下操作：

```
Invoke((Action)(() => updateProgressBar())); 
```

这将在主 UI 线程上运行更新。

# xamarin - Xamarin.iOS crash on 6.1 simulator

> ID：15483133
> 
> 赞同：2
> 
> 时间：2013-03-18T17:30:10.513
> 
> 标签：xamarin, xamarin.ios, xamarin-studio

i recently received my Macbook and wanted to start developing iOS apps with it. I Created a default Master-Detail App using the Templates in Xamarin.Studio and everything worked. Now today i wanted to actually do something in the app, but didn't change a single line of code, still the app doesn't show up anymore in the simulator as long as i want it to use the 6.1 sdk for ios. if i use any other (6.0 etc) it works fine.

I already tried clearing my Cache in /Users/MYNAME/Library/Xamarin/ but this didn't change anything.

What would you suggest me to do now? can i simply reinstall the 6.1 sdk?if so, how would i do this?

Thanks for your help

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-09T10:57:57.953

当我尝试在模拟器中调试（仅显示旋转的球）时，我遇到了类似的问题，环境挂起。我发现只有当我将手机连接到计算机时才会发生这种情况。在您的情况下可能无效，但它可能是您解决问题的线索。

我正在使用最新版本的一切。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-05T02:48:33.647

您需要在项目设置中填写应用程序名称、标识符、版本号。我有同样的问题并以这种方式解决了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-13T03:58:19.610

删除此文件夹：

`/Users/[username]/Library/Application Support/iPhone Simulator/6.1`

如果您的 Library 文件夹被隐藏：

`sudo chflags nohidden ~/Library/`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T22:51:52.470

在 Xamarin Studio（或 MonoDevelop）中：

`Project`->`Your.Application.Name Options`

`Build`-> `iOS Build`（`iPhone Build`在 MonoDevelop 中）

`SDK version`: -> `6.1`(它可能还在 6.0 上)

这为我修好了。此外，确保目标内置`info.plist`设置为`6.1`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-25T15:14:30.750

我已经多次遇到这个问题，我之前的回答并没有解决它。你知道什么吗？重新启动计算机。每次都有效。 *耸耸肩*

# apache-chainsaw - Is there a way to view logs from three different remote nodes on one tab on Chainsaw

> ID：15483134
> 
> 赞同：0
> 
> 时间：2013-03-18T17:30:17.350
> 
> 标签：apache-chainsaw

Is there a way to view logs from three different remote nodes on one tab? Right now I get three tabs open for three nodes. Here is my log4j config for the same app deployed on three different linux boxes

```
log4j.appender.HUB=org.apache.log4j.net.SocketHubAppender
log4j.appender.HUB.port=39867
log4j.appender.HUB.LocationInfo=true
log4j.appender.HUB.Threshold=INFO
log4j.appender.HUB.application=remotehost 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T19:05:39.547

是的。

您可以通过“查看，从表达式创建选项卡”菜单项从现有事件创建新选项卡 - 它会将匹配表达式的事件组合到新选项卡中。随着与表达式匹配的新事件到达，它们也将被添加到新选项卡中。

这不是持久的 - 重新启动电锯，你必须再次经历这个过程。

如果您想永久更改内容，您可以在 Chainsaw 首选项下修改“选项卡名称/事件路由表达式”。当事件进入时，“事件路由表达式”框中的表达式将使用当前事件的值解析。如果存在具有该选项卡名称的选项卡，则将事件添加到该选项卡。如果不存在选项卡，则会创建一个新选项卡。

您可以在“视图，从表达式创建选项卡”表达式框中使用的示例表达式（假设您感兴趣的事件都有一个“应用程序”列，其中“远程主机”作为该列中的值）：

PROP.application=remoteHost

第二个选项只是构建一个字符串 - 并不是真正的表达式，如搜索和过滤表达式语法......

一个示例选项卡名称/事件路由表达式，您可以使用“remoteHost”作为名为“remoteHost”的选项卡上的应用程序获取所有事件：

PROP.应用程序

顺便说一句，我建议查看 Chainsaw 的最新开发人员快照，可在此处获得：

[http://people.apache.org/~sdeboy](http://people.apache.org/~sdeboy)

# php - My php form will not submit through jQuery-Mobile

> ID：15483137
> 
> 赞同：3
> 
> 时间：2013-03-18T17:30:23.400
> 
> 标签：php, html, forms, jquery-mobile, submit-button

I have a fully working piece of PHP, HTML code but when I place it into my website that is styled using jQuery Mobile the submit button will not display the query. Does anybody know how to fix this or even why it is happening

SCRIPT

```
<!DOCTYPE html>
<html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>The School of Computing and Mathematics</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="themes/project1.css" />
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.0/jquery.mobile.structure-1.3.0.min.css" /> 
<script src="http://code.jquery.com/jquery-1.9.1.min.js"></script> 
<script src="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.js"></script> 
</head> 
```

PHP

```
<body>
<div data-role="page">
<?php

// Create connection
$con=mysqli_connect('localhost', '', '', 'timetabledb');

// Check connection
if (mysqli_connect_errno($con))
{
echo "Failed to connect to MySQL: " . mysqli_connect_error();
}
$course_dropdown ="";
$query_course = "SELECT * FROM course";
$result_course = mysqli_query($con,$query_course) or die(mysqli_error());

while($row = mysqli_fetch_assoc($result_course))
{
$course_dropdown .= "<option value='{$row['CourseName']}'>{$row['CourseName']}</option>";
} 

$module_dropdown ="";
$query_module = "SELECT * FROM module";
$result_module = mysqli_query($con,$query_module) or die(mysqli_error());

while($row = mysqli_fetch_assoc($result_module))
{
$module_dropdown .= "<option value='{$row['ModuleName']}'>{$row['ModuleName']}</option>";
} 

$day_dropdown ="";
$query_day = "SELECT * FROM days ";
$result_day = mysqli_query($con,$query_day) or die(mysqli_error());

while($row = mysqli_fetch_assoc($result_day))
{
$day_dropdown .= "<option value='{$row['Day']}'>{$row['Day']}</option>";
} 

echo "<table border='1'>
<tr>

<th>Course Name</th>
<th>Module Name</th>
<th>Type of Class</th>
<th>Lecturer</th>
<th>Time</th>
<th>Day</th>
<th>Room</th>

</tr>";

if (isset($_POST['button']) && $_POST['button'] == 'Submit') {
   $course = mysqli_real_escape_string($con, $_POST['Course']);
$module = mysqli_real_escape_string($con, $_POST['Module']);
$day = mysqli_real_escape_string($con, $_POST['Day']);

$query = "SELECT * FROM course_module WHERE CourseName = '$course' AND ModuleName = '$module' AND Day = '$day'"; 

$result = mysqli_query($con,$query);

 while($row1 = mysqli_fetch_assoc($result)){

 echo "<tr>";

    echo "<td>" . $row1['CourseName'] . "</td>";
    echo "<td>" . $row1['ModuleName'] . "</td>";
    echo "<td>" . $row1['ClassType'] . "</td>";
    echo "<td>" . $row1['Lecturer'] . "</td>";
    echo "<td>" . $row1['Time'] . "</td>";
    echo "<td>" . $row1['Day'] . "</td>";
    echo "<td>" . $row1['Room'] . "</td>";
    echo "</tr>";

}
}
?> 
```

HTML

```
<h1>School of Computing and Mathematics</h1>
<h2>Mobile website<h2>
<h2>Current students</h2>

<div data-role="collapsible-set" data-theme="c" data-content-theme="d">
<div data-role="collapsible">
    <h3>Section 1</h3>
    <p>I'm the collapsible content for section 1</p>
  </div>
  <div data-role="collapsible">
    <h3>Section 2</h3>
    <p>I'm the collapsible content for section 2</p>
  </div>
  <div data-role="collapsible">
    <h3>Timetabling</h3>
    <p>Select your Course</p>

    <form action="current.php" method="post" data-ajax="false">
    <select name="Course">
    <option>Select Course</option>
    <?php echo $course_dropdown; ?>
    </select>

    <select name="Module">
    <option>Select Module</option>
    <?php echo $module_dropdown; ?>
    </select>

    <select name="Day">
    <option>Select Day</option>
    <?php echo $day_dropdown; ?>
    </select>

    <input id ="button_timetable" name="button" value="Submit" type="submit">
    </form>

   </div>

<div data-role="footer" data-id="foo1" data-position="fixed">
<div data-role="navbar">
    <ul>
        <li><a href="homepage.html">Home</a></li>
        <li><a href="news.html">News</a></li>
        <li class="ui-btn-active ui-state-persist"><a href="current.html">Current students</a></li>
        <li><a href="prospective.html">Prospective students</a></li>
    </ul>
</div><!-- /navbar -->
  </div><!-- /footer -->
</div>
</body>
</html> 
```

Please keep in mind that this script is fully implemented on a plain HTML site. I am only having issues with the jQuery mobile library.

Thank You in advance

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T18:50:21.237

让我给你一个答案，我发现一切都通过你的代码。

在 index.php 中：

1.  **data-ajax="false"**应该作为表单属性添加，它可以防止 jQuery Mobile 使用 ajax 提交数据。

2.  在 HEAD 中初始化了不正确的 jQuery Mobile css

3.  **表格**标签未关闭

但是，通过和低谷这是构建良好的页面。

# r - 删除少于 1000 个观测值的数据框列

> ID：15483146
> 
> 赞同：1
> 
> 时间：2013-03-18T17:30:51.883
> 
> 标签：r

我有一个数据框，我想删除所有少于 1000 个观察值的列。下面的方法效果很好，但是有没有更优雅的解决方案？

```
vec <- numeric()

for(i in 1:ncol(dat))
{
    if(length(dat[,i][!is.na(dat[,i])]) >= 1000) 
        vec <- c(vec, i)
}

dat <- dat[,vec] 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-18T17:34:18.757

这应该有效：

```
dat[,colSums(!is.na(dat))>=1000] 
```

在这里，我们首先查看其中的哪些元素`dat`是 no `NA`，并计算这个新数据帧的列总和。对于我们得到的至少包含 1000 个观察值的列，对于其他`TRUE`列`FALSE`。所以我们可以把它作为一个索引变量来子集原始`dat`数据框。

# ant - 使用 ant 和 jython 进行 WebSphere 配置

> ID：15483153
> 
> 赞同：3
> 
> 时间：2013-03-18T17:31:15.990
> 
> 标签：ant, websphere, jython

我已经能够使用下面的 Jython 脚本成功配置资源环境条目。我使用本地应用服务器 bin 目录中的 ws_admin 程序调用 Jython 脚本。

我在一个团队工作，蚂蚁是我们构建过程中的首选技术。

我在网上浏览了有关使用 ant 配置 WebSphere 的文档，到目前为止，在我看来，主要是能够从 ant 调用像 ws_admin 这样的程序。

是否可以直接使用 ant 而不是使用 Jython 或 Jacl 脚本来配置资源环境条目？如果没有，我该如何设置 ant 任务以减少设置资源环境条目所需的 Jython 数量？

这是我当前设置资源环境条目的 Jython 脚本。最终寻找减少我们对 Jython 依赖的方法......

```
# Set up Variables used within this script
objServerAttrs  = AdminControl.completeObjectName('WebSphere:type=Server,*')
node            = AdminControl.getAttribute(objServerAttrs, 'nodeName')
server          = AdminControl.getAttribute(objServerAttrs, 'name')
provider        = "Test_ConfigurationProvider"
providerFactory = "com.DG_ConfigurationFactory"
providerClass   = "com.DG_Configuration"

# Function for creating resource custom properties
def createResourceCustomProperty(envEntry, propName, propValue):
    propSet = AdminConfig.showAttribute(envEntry, 'propertySet') 
    if propSet == None:
        propSet = AdminConfig.create('J2EEResourcePropertySet',envEntry,[])

    name = ['name', propName]
    value = ['value', propValue]
    propAttrs = [name, value]
    AdminConfig.create('J2EEResourceProperty', propSet, propAttrs)
    return

# Create the resource environment provider
AdminResources.createResourceEnvProvider(node, server, provider)
AdminResources.createResourceEnvProviderRef(node,server,provider, providerFactory, providerClass)

# Create the resource environment entries
## Context Configuration
envEntry = AdminResources.createResourceEnvEntries(node,server,provider, "Context Configuration", "test-config/context")
createResourceCustomProperty(envEntry, "deployment.environment", "IDE")
createResourceCustomProperty(envEntry, "server.context", "com.context.DG_WebSphereServerContext")
createResourceCustomProperty(envEntry, "user.context", "com.context.DG_WebSphereUserContext")
createResourceCustomProperty(envEntry, "log.directory", "C:/Development/WebSphere/Logs")
createResourceCustomProperty  (envEntry, "file.directory", "C:/Development/WebSphere/AppFiles")

## Mail Configuration
envEntry = AdminResources.createResourceEnvEntries(node,server,provider, "Mail  Configuration", "test-config/mail")
createResourceCustomProperty(envEntry, "enabled", "false")
createResourceCustomProperty(envEntry, "mailSessionJndiName", "mail/MailSession")

## User Repository Configuration
envEntry = AdminResources.createResourceEnvEntries(node, server, provider, "User Repository Configuration", "test-config/userRepository")
createResourceCustomProperty(envEntry, "ldap.provider.url", "ldap://test.com:389/cn=users,dc=com")
createResourceCustomProperty    (envEntry, "ldap.security.principal", "cn=was_user,cn=users,dc=com")

# Save changes to the configuration
AdminConfig.save() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-19T21:23:46.697

从 WAS 7 开始，除了管理控制台和 wsadmin 之外，还引入了第三种配置服务器的方式，即[基于属性文件的配置](http://pic.dhe.ibm.com/infocenter/wasinfo/v8r5/index.jsp?topic=/com.ibm.websphere.nd.multiplatform.doc/ae/txml_property_configuration.html)。这种新的管理模型据称“消除了编写复杂 wsadmin 脚本的需要”，正如[相关的 Education Assistant 演示文稿](http://publib.boulder.ibm.com/infocenter/ieduasst/v1r1m0/index.jsp?topic=/com.ibm.iea.was_v7/was/7.0/Administration/WASv7_PropertiesFileConfig/player.html)中所解释的那样。

基本上，您所做的是配置单个环境，将感兴趣的配置部分导出到可移植属性文件中，然后将此文件用作单行`wsadmin`脚本的输入，该脚本将应用属性文件中的配置到另一个目标服务器。因此，您摆脱了许多 Jython 行并使用了一个更简单的人工制品，它是一个具有简单而熟悉的语法的属性文件。

除了上述链接之外，Developerworks上还有[一篇关于此功能的精彩文章。](http://www.ibm.com/developerworks/websphere/techjournal/0904_chang/0904_chang.html)

# cygwin - cygwin startxwin.bat does not work

> ID：15483154
> 
> 赞同：3
> 
> 时间：2013-03-18T17:31:16.563
> 
> 标签：cygwin, x11

I tried to install x11 for cygwin. The installation appears to go well BUT there is no startxwin.bat file as described in the docs. I downloaded this file manually and put it in the right place. It runs and in taskmanager I see xwin.exe - BUT there is no "TERMINAL".

Can anyone help?

PS: I am trying to get x11 because I believe I need it to plot prettily in gnuplot - could some confirm that I do need x11 for that.

OUTPUT from calling startxwin in CYGWIN-terminal:

```
$ startxwin

Welcome to the XWin X Server
Vendor: The Cygwin/X Project
Release: 1.13.3.0
OS: CYGWIN_NT-6.1-WOW64 LskyHome2 1.7.17(0.262/5/3) 2012-10-19 14:39 i686
OS: Windows 7 Service Pack 1 [Windows NT 6.1 build 7601] (WoW64)
Package: version 1.13.3-1 built 2013-03-09

XWin was started with the following command line:

X :0 -multiwindow

Initializing built-in extension Generic Event Extension
Initializing built-in extension SHAPE
Initializing built-in extension MIT-SHM
Initializing built-in extension XInputExtension
Initializing built-in extension XTEST
Initializing built-in extension BIG-REQUESTS
Initializing built-in extension SYNC
Initializing built-in extension XKEYBOARD
Initializing built-in extension XC-MISC
Initializing built-in extension XINERAMA
Initializing built-in extension XFIXES
Initializing built-in extension XFree86-Bigfont
Initializing built-in extension RENDER
Initializing built-in extension RANDR
Initializing built-in extension COMPOSITE
Initializing built-in extension DAMAGE
Initializing built-in extension MIT-SCREEN-SAVER
Initializing built-in extension DOUBLE-BUFFER
Initializing built-in extension RECORD
Initializing built-in extension DPMS
Initializing built-in extension X-Resource
Initializing built-in extension GLX
(II) xorg.conf is not supported
(II) See http://x.cygwin.com/docs/faq/cygwin-x-faq.html for more information
LoadPreferences: /home/moon sky/.XWinrc not found
LoadPreferences: Loading /etc/X11/system.XWinrc
LoadPreferences: Done parsing the configuration file...
winDetectSupportedEngines - DirectDraw installed, allowing ShadowDD
winDetectSupportedEngines - Windows NT, allowing PrimaryDD
winDetectSupportedEngines - DirectDraw4 installed, allowing ShadowDDNL
winDetectSupportedEngines - Returning, supported engines 0000001f
winSetEngine - Multi Window or Rootless => ShadowGDI
winScreenInit - Using Windows display depth of 32 bits per pixel
winAllocateFBShadowGDI - Creating DIB with width: 1920 height: 1080 depth: 32
winFinishScreenInitFB - Masks: 00ff0000 0000ff00 000000ff
winInitVisualsShadowGDI - Masks 00ff0000 0000ff00 000000ff BPRGB 8 d 24 bpp 32
winInitMultiWindowWM - Calling pthread_mutex_lock ()
winMultiWindowXMsgProc - Calling pthread_mutex_lock ()
MIT-SHM extension disabled due to lack of kernel support
XFree86-Bigfont extension local-client optimization disabled due to lack of shared memory support in the kernel
GL_VERSION:     3.3.0
GL_VENDOR:      NVIDIA Corporation
GL_RENDERER:    GeForce GTX 260/PCI/SSE2
(II) AIGLX: enabled GLX_SGI_make_current_read
(II) AIGLX: enabled GLX_MESA_copy_sub_buffer
(II) AIGLX: enabled GLX_SGI_swap_control and GLX_MESA_swap_control
(II) AIGLX: enabled GLX_SGIX_pbuffer
(II) AIGLX: enabled GLX_ARB_multisample and GLX_SGIS_multisample
(II) 450 pixel formats reported by wglGetPixelFormatAttribivARB
(II) AIGLX: Set GLX version to 1.4
(II) 333 fbConfigs
(II) GLX: Initialized Win32 native WGL GL provider for screen 0
[dix] Could not init font path element /usr/share/fonts/TTF/, removing from list!
[dix] Could not init font path element /usr/share/fonts/OTF/, removing from list!
[dix] Could not init font path element /usr/share/fonts/Type1/, removing from list!
winPointerWarpCursor - Discarding first warp: 960 540
(--) 5 mouse buttons found
(--) Setting autorepeat to delay=500, rate=31
(--) Windows keyboard layout: "00000409" (00000409) "US", type 4
(--) Found matching XKB configuration "English (USA)"
(--) Model = "pc105" Layout = "us" Variant = "none" Options = "none"
Rules = "base" Model = "pc105" Layout = "us" Variant = "none" Options = "none"
winBlockHandler - pthread_mutex_unlock()
winInitMultiWindowWM - pthread_mutex_lock () returned.
winInitMultiWindowWM - pthread_mutex_unlock () returned.
winMultiWindowXMsgProc - pthread_mutex_lock () returned.
winInitMultiWindowWM - DISPLAY=:0.0
winMultiWindowXMsgProc - pthread_mutex_unlock () returned.
winProcEstablishConnection - winInitClipboard returned.
winMultiWindowXMsgProc - DISPLAY=:0.0
winClipboardProc - DISPLAY=:0.0
winInitMultiWindowWM - XOpenDisplay () returned and successfully opened the display.
winMultiWindowXMsgProc - XOpenDisplay () returned and successfully opened the display.
winClipboardProc - XOpenDisplay () returned and successfully opened the display.

moon sky@LskyHome2 ~
$ Warning: Cannot convert string "-adobe-helvetica-bold-r-normal--*-120-*-*-*-*-iso8859-*" to type FontStruct
Warning: Unable to load any usable ISO8859 font
Warning: Unable to load any usable ISO8859 font
Error: Aborting: no font found 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T18:48:27.927

`startxwin.bat`已被删除以支持`startxwin.exe`... [http://permalink.gmane.org/gmane.os.cygwin.xfree/20615](http://permalink.gmane.org/gmane.os.cygwin.xfree/20615)

在里面找`/bin`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T17:42:52.527

我认为 Windows 上的 gnuplot 不需要 X11。见： [http](http://www.gnuplot.info/) ://www.gnuplot.info/ ：

```
Gnuplot supports many different types of output
          interactive screen display:           cross-platform (Qt, wxWidgets, x11) or system-specific (MS Windows, OS/2)
          static screen display:                system-specific (OSX(aqua), svga, ...)
          direct output to file:                postscript (including eps), pdf, png, gif, jpeg, LaTeX, metafont, emf, svg, ...
          mouseable web display formats:        HTML5, svg 
```

但是，使用不同的预编译二进制文件可能更容易。见： http: [//www.maths.manchester.ac.uk/~pjohnson/Gnuplot/windows_gnuplot.html](http://www.maths.manchester.ac.uk/~pjohnson/Gnuplot/windows_gnuplot.html)

# python - 在numpy中推广矩阵转置

> ID：15483156
> 
> 赞同：6
> 
> 时间：2013-03-18T17:31:28.483
> 
> 标签：python, numpy

让我们`a`成为python中的一个列表。

```
a = [1,2,3] 
```

当矩阵转置应用于 时`a`，我们得到：

```
np.matrix(a).transpose()
matrix([[1],
        [2],
        [3]]) 
```

我希望概括此功能，接下来将借助示例说明我希望做什么。让我们`b`成为另一个列表。

```
b = [[1, 2], [2, 3], [3, 4]] 
```

在`a`中，列表项是 1、2 和 3。我想将 、 和 中的每一个`[1,2]`视为`[2,3]`中的`[3,4]`列表项`b`，仅用于执行转置。我希望输出如下：

```
array([[[1,2]],
       [[2,3]],
       [[3,4]]]) 
```

一般来说，我希望能够指定列表项的外观，并在此基础上执行矩阵转置。

我可以只写几行代码来完成上述工作，但我提出这个问题的目的是找出是否有内置的 numpy 功能或 pythonic 方式来做到这一点。

编辑：下面的 unutbu 输出与我上面的输出相匹配。但是，我想要一个适用于更一般情况的解决方案。我在下面发布了另一个输入/输出。我最初的示例描述性不够，无法传达我想说的内容。设, , , 和`b`中的项目。那么下面给出的输出将是对高维元素进行矩阵转置。更一般地说，一旦我描述了“项目”的外观，我想知道是否有办法做类似转置的事情。`[1,2]``[2,3]``[3,4]``[5,6]`

```
Input: b = [[[1, 2], [2, 3]], [[3, 4], [5,6]]]
Output: array([[[1,2], [3,4]],
               [[2,3], [5,6]]]) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-18T17:39:02.350

您想要的数组具有形状 (3,1,2)。`b`具有形状 (3,2)。要在中间添加一个额外的轴，请使用`b[:,None,:]`, 或 (等价地) `b[:, np.newaxis, :]`。[在 Basic Slicing 部分](http://docs.scipy.org/doc/numpy/reference/arrays.indexing.html#basic-slicing)中查找“newaxis” 。

```
In [178]: b = np.array([[1, 2], [2, 3], [3, 4]])

In [179]: b
Out[179]: 
array([[1, 2],
       [2, 3],
       [3, 4]])

In [202]: b[:,None,:]
Out[202]: 
array([[[1, 2]],

       [[2, 3]],

       [[3, 4]]]) 
```

* * *

另一个有用的工具是[np.swapaxes](http://docs.scipy.org/doc/numpy/reference/generated/numpy.swapaxes.html#numpy-swapaxes)：

```
In [222]: b = np.array([[[1, 2], [2, 3]], [[3, 4], [5,6]]])

In [223]: b.swapaxes(0,1)
Out[223]: 
array([[[1, 2],
        [3, 4]],

       [[2, 3],
        [5, 6]]]) 
```

转置`b.T`与交换第一个和最后一个轴相同`b.swapaxes(0,-1)`：

```
In [226]: b.T
Out[226]: 
array([[[1, 3],
        [2, 5]],

       [[2, 4],
        [3, 6]]])

In [227]: b.swapaxes(0,-1)
Out[227]: 
array([[[1, 3],
        [2, 5]],

       [[2, 4],
        [3, 6]]]) 
```

* * *

概括：

*   使用[np.newaxis](http://docs.scipy.org/doc/numpy/reference/arrays.indexing.html#basic-slicing)（或`None`）添加新轴。（因此，增加了数组的维度）
*   使用[np.swapaxes](http://docs.scipy.org/doc/numpy/reference/generated/numpy.swapaxes.html#numpy-swapaxes)交换任意两个轴。
*   使用[np.transpose](http://docs.scipy.org/doc/numpy/reference/generated/numpy.transpose.html#numpy-transpose)一次置换所有轴。（感谢@jorgeca 指出这一点。）
*   使用[np.rollaxis](http://docs.scipy.org/doc/numpy/reference/generated/numpy.rollaxis.html#numpy-rollaxis) “旋转”轴。

# php - PHP / 在查询中插入 foreach

> ID：15483157
> 
> 赞同：0
> 
> 时间：2013-03-18T17:31:35.120
> 
> 标签：php, mysql, arrays, foreach

我试图用数组填充查询。据我所知，我可以显示带有函数的数组，`foreach();`但我无法将它放在 mysql 查询中我试图做这样的事情：

```
<?php
$arr = array("arr_1", "arr_2", "arr_3", "arr_4");

$query = mysql_query("SELECT * FROM users WHERE user = '1'".
foreach($arr as $arr) {
    echo "AND user = '".$arr++."'";
}
." ORDER BY id";
?> 
```

脚本必须将其显示为：
`$query = mysql_query("SELECT * FROM users WHERE user = '1' AND user = 'arr_1' AND user = 'arr_2' AND user = 'arr_3' AND user = 'arr_4'");`

但这不起作用，因为您无法`foreach()`放入`mysql_query();`。
所以我需要的是做同样事情的脚本（在查询字符串中显示数组）

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T17:34:16.330

如果要从数组中添加多个条件，请进行连接而不是回显

```
<?php
$arr = array("arr_1", "arr_2", "arr_3", "arr_4");

$query = mysql_query("SELECT * FROM users WHERE user = '1'";
foreach($arr as $id) {
    $query .= "AND user = '".$id."'";
}
$query .= " ORDER BY id";
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T17:44:29.383

不是最好的解决方案，而是替代方案：

```
$arr = array("arr_1", "arr_2", "arr_3", "arr_4");

$arr_string="'".implode("','", $arr)."'"; // surround values in quotes

$query = mysql_query("SELECT * FROM users WHERE user IN (".$arr_string.") ORDER BY id"; 
```

# java - TDD: how to verify method calls made from a list of objects in Java?

> ID：15483161
> 
> 赞同：-2
> 
> 时间：2013-03-18T17:31:46.027
> 
> 标签：java, junit, tdd, mockito

I have a class FileGenerator, and I'm writing a test for the generateFile() method that should do the following:

1) it should call the static method getBlockImpl(FileTypeEnum) on BlockAbstractFactory

2) it should populate variable blockList from the subclass method getBlocks()

3) it should call a static method createFile from a final helper class FileHelper passing a String parameter

4) it should call the run method of each BlockController in the blockList

I'm trying to use TDD to test the last scenario of my method. I have a list of BlockController objects that implement Runnable, and I need to verify if each one calls the run() method.

Here's what I'm trying to do:

```
public class FileGenerator {
// private fields with Getters and Setters

    public void generateBlocks() {
        // 1,2 get the block manager that will return the BlockController list
        blockManager = BlockAbstractFactory.getManager(fileType);
        blockList = blockManager.getBlocks();
        // create a file using FileHelper
        FileHelper.createFile(path);

        // What I want to test:
        // for each BlockController in the blockList, call the run() method
    }
} 
```

I am using Junit and Mockito. In the Mockito's documentation, they only show how to mock a List and verify method calls on the List (such as add(T), remove(T) etc), not its objects.

Any idea how I can do this?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T17:31:46.027

I found the answer before I posted the question. It's actually quite simple.

First, you need to mock the object you'll have using Mockito:

```
final BlockController mockedBlock = mock(BlockController.class); 
```

Next, create the List using your mocked object (below I have create a list of 3 mocked objects of type BlockController):

```
List<BlockController> myBlockList = Arrays.asList(mockedBlock, mockedBlock, mockedBlock); 
```

Set the list in your tested class to the list of mocked objects before calling the method:

```
fileGenerator.setBlockList(myBlockList);
fileGenerator.generateBlocks(); 
```

Now, with Mockito, just verify if the number of calls to the bar method match the size of your List:

```
verify( myBlockList, times(myBlockList.size()) ).run(); 
```

This is what it looks like in the end (my FileGenerator object is created in a @Before method):

```
@Test
public testShouldCallRunForEachBlock() {
    final BlockController mockedBlock = mock(BlockController.class);
    List<BlockController> myBlockList = Arrays.asList(mockedBlock, mockedBlock, mockedBlock);

    fileGenerator.setBlockList(myBlockList);
    fileGenerator.generateBlocks();

    verify( myBlockList, times(myBlockList.size()) ).run();
} 
```

And that's it. Now the test will fail until the a loop is implemented.

# matlab - 'Symbolic Math Toolbox' functions exist in MATLAB but not in the documentation

> ID：15483166
> 
> 赞同：3
> 
> 时间：2013-03-18T17:32:10.247
> 
> 标签：matlab

This problem may seem a bit weird; please bear with me.

When I try to access any function in the 'Symbolic Math Toolbox' in MATLAB, such as `help ztrans` or `help laplace`, I get the following kind of message

```
ztrans not found.

Use the Help browser Search tab to search the documentation, or
type "help help" for help command options, such as help for methods. 
```

However, the toolbox seems to be installed when I try the `ver` or `pathtool` command.

Moreover, when I try some simple code such as:

```
>> syms k x
>> f = sin(k);
>> ztrans(f, k, x) 
```

the code works fine and on trying the `help` command again, they seem to work fine as well. However, the problem again arises when I close and reopen MATLAB.

I found a few instances of other users facing similar problems on the Mathworks portal, but none of them seemed to provide any concrete solutions. Some of them seem to blame it on MATLAB hashing the tollbox incorrectly, so I tried the `rehash toolbox` command as well, but had no luck.

I'm not sure if this problem is just for this particular toolbox or not, but the other toolboxes I use at least seem to work fine.

**EDIT-I**

I also realised that the documentation is always available when I take `Help --> Product Help` from the menu-bar, though it is not available in the function browser even after I try the sample code.

**EDIT-II**

```
>> license('checkout','Symbolic_Toolbox') 
```

gives me

```
ans =

     1 
```

I'm not working on a student license either.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T21:02:24.977

这可能是许可证问题。尝试通过以下方式获取更多信息：

```
license('inuse') 
```

如果您有学生版，则无法执行某些功能。

```
istudent 
```

如果您在办公室/大学，并且您有浮动许可证。请务必在运行代码之前签出所有许可证。

```
license('checkout','toolbox_name') 
```

# php - 查看父类的子类中是否存在静态属性（后期静态绑定）？

> ID：15483169
> 
> 赞同：6
> 
> 时间：2013-03-18T17:32:18.830
> 
> 标签：php, late-static-binding

父类中的代码：

```
foreach(static::$_aReadOnlyDatabaseTables AS $TableName => $aColumns){
  // Do something
} 
```

这在子类中定义了 $_aReadOnlyDatabaseTables 时有效，但在 $_aReadOnlyDatabaseTables 不存在时会引发错误。我需要先检查这个属性是否存在。

我认为它应该是这样的：

```
if(property_exists(static,$_aReadOnlyDatabaseTables)){
   foreach(static::$_aReadOnlyDatabaseTables AS $TableName => $aColumns){
      // Do something
   }
} 
```

但这会引发语法错误，`unexpected ',', expecting T_PAAMAYIM_NEKUDOTAYIM`. 使用`$this`代替`static`也不起作用，它总是评估为假。

什么是正确的语法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-18T17:36:15.187

你应该试试这个：

```
if(property_exists(get_called_class(), '_aReadOnlyDatabaseTables')) {
   foreach(static::$_aReadOnlyDatabaseTables AS $TableName => $aColumns){
      // Do something
   }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-18T17:35:43.943

正确的方法是在父类中使用合理的默认值（空数组）初始化值。这样您就可以确定该属性将存在。

当您单独使用该类时，通过正确定义它，您在一个类中访问的所有内容都应该可用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-18T17:35:57.437

您应该能够使用`get_class()`而不是`static`关键字来快速而肮脏地执行此操作：

```
if (property_exists(get_class($this), '_aReadOnlyDatabaseTables')) { ... } 
```

# asp.net - 以前填充的 HttpContext.Current.Session["courseNameAssociatedWithLoggedInUser"] 出现罕见的 System.NullReferenceException？

> ID：15483170
> 
> 赞同：0
> 
> 时间：2013-03-18T17:32:20.527
> 
> 标签：asp.net, silverlight, session, session-variables, nullreferenceexception

我们的 ASP.NET C# web 应用程序用于以下环境

*   .NET 框架 4
*   Silverlight 4 / PivotViewer
*   IIS 7
*   视窗 2008
*   Visual Studio 2010 .NET IDE
*   C＃
*   HTTPS ( SSL )

我们的 Silverlight 4 / PivotViewer 控件显然嵌入在 ASP.NET 页面中。

在极少数情况下，我们在带有 IIS 7 的独立 Windows 2008 服务器上浏览承载 Silverlight 4 / PivotViewer 模块的 ASP.NET 页面时，会收到“对象引用未设置为对象的实例。错误。

此外，关于该错误还有许多非常奇怪的事情。首先，它有时仅在某些用户计算机上发生。详细地说，它通常只发生在用户第一次使用访问我们的 ASP.NET Web 应用程序的计算机时。

此外，一旦我们清除浏览器缓存，在托管我们的 Silverlight 4 / PivotViewer 模块的 ASP.NET 页面中导航时不会发生错误。

关于该错误的另一个有趣方面是，当它实际上部署到带有 IIS 7 的独立 Windows 2008 服务器时，它指的是错误堆栈跟踪中我本地开发计算机上的绝对路径。这真的很奇怪，因为在我部署到带有 IIS 7 的独立 Windows 2008 服务器，我确保 web.config 等文件中的所有配置参数均参考独立服务器环境。换句话说，我删除了对与我的本地开发计算机关联的配置参数值的任何引用。

因此，我很困惑为什么它在错误堆栈跟踪中引用我本地开发计算机上的绝对路径。

用户在使用网站时获得“未将对象引用设置为对象的实例。”将是糟糕的体验。此外，如果我们必须告诉用户清除他/她的浏览器，这将是糟糕的用户体验每次出现错误时缓存。

> “/”应用程序中的服务器错误。你调用的对象是空的。说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。
> 
> 异常详细信息：System.NullReferenceException：对象引用未设置为对象的实例。
> 
> 源错误：在执行当前 Web 请求期间生成了未处理的异常。可以使用下面的异常堆栈跟踪来识别有关异常起源和位置的信息。
> 
> 堆栈跟踪：
> 
> [NullReferenceException: 对象引用未设置为对象的实例。] C:\VisualStudioWorkSpace\VisualCSharpProjects\PerlsPivot\PivotServer\SectionBasedRelatedModules\SectionBasedRelatedModules.aspx.cs:160 PivotServer.SectionBasedRelatedModules.SectionBasedPerlsViewer.tailorConfigurationDetailsOfPageElementsToFallInLineWithTutorialSelection() .Page_Load(Object sender, EventArgs e) in C:\VisualStudioWorkSpace\VisualCSharpProjects\PerlsPivot\PivotServer\SectionBasedRelatedModules\SectionBasedPerlsViewer.aspx.cs:146 System.Web.Util.CalliHelper.EventArgFunctionCaller(IntPtr fp, Object o, Object t, EventArgs e) +24 System.Web.UI.Control.LoadRecursive() +70 System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint,布尔型 includeStagesAfterAsyncPoint) +3063
> 
> 版本信息：Microsoft .NET Framework 版本：4.0.30319；ASP.NET 版本：4.0.30319.272

我查看了第 160 行，其中包含以下代码：

```
String coursename = HttpContext.Current.Session["courseNameAssociatedWithLoggedInUser"].ToString(); 
```

显然，这告诉我们在 HttpContext.Current.Session 中变量“courseNameAssociatedWithLoggedInUser”没有值。

但是，我在另一台计算机上采取了相同的步骤，但一切运行顺利。此外，我确信一旦用户登录，我就会为 HttpContext.Current.Session["courseNameAssociatedWithLoggedInUser"] 赋值。

HttpContext.Current.Session["courseNameAssociatedWithLoggedInUser"] 是否因某种原因损坏？如果是这样，为什么，我们如何防止它？

我应该使用 Page.Session 而不是 HttpContext.Current.Session 吗？那会有帮助吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T17:31:56.170

> “很明显，这告诉我们 HttpContext.Current.Session 中的变量“courseNameAssociatedWithLoggedInUser”没有值。”

不完全是...给定您的代码...

```
String coursename = HttpContext.Current.Session["courseNameAssociatedWithLoggedInUser"].ToString(); 
```

...以下项目可能会导致这种情况

*   HttpContext - 不太可能
*   HttpContext.Current - 比你想象的更频繁，但可以重现
*   HttpContext.Current.Session["courseNameAssociatedWithLoggedInUser"]

要找出该链中的特定项目，您可以执行以下操作（伪代码）

```
function string GetCourseNameThingie()
{
  if HttpContext is null
    throw new Exception("HttpContext is null")
  if HttpContext.Current is null
    throw new Exception("HttpContext.Current is null")
  if HttpContext.Current.Session["courseNameAssociatedWithLoggedInUser"] is null
    throw new Exception("HttpContext.Current.Session["courseNameAssociatedWithLoggedInUser"]is null")

   return HttpContext.Current.Session["courseNameAssociatedWithLoggedInUser"].ToString()
} 
```

这将具体告诉您缺少什么。正如我们所指出的，该值更有可能被另一个页面清除，或者发生了严重到足以破坏该用户会话的错误（您在 Global.asax 中有 Application_Error 或 Session_End 处理程序吗？）。

您还可以尝试将原始语句包装在 try/catch 中，如果发生异常，请立即检查您认为仍在工作的另一个会话变量。这也将明确告诉您其他变量是否正常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T10:40:59.077

首先，对不起我的语法-英语。

我的 .net 应用程序也有类似的问题，原因是空闲时间到期。

有四个时间到期设置“（是4）”和应用程序池的回收过程。我做了以下

A) 从应用程序池：打开高级设置并更改“**空闲超时**”。默认为 20 分钟。

此外，将“**常规时间间隔**”设置为 0。这样它就不会被回收。我不知道为什么微软决定将其默认为 1740 分钟。这不是超时设置，它是在一段时间后始终回收 appPool 的设置，因此如果您的用户处于某些事情的中间，他们将丢失所有内容或出现与您一样的异常。将其设置为 0 将禁用此功能。

B) 验证超时。如果您正在使用它，例如表单身份验证，则转到您的虚拟目录应用程序的身份验证功能，右键单击“表单身份验证”并选择“编辑”。更改**身份验证 cookie-time out**。

C) ASP.NET 会话状态。在 ISS 中，打开 .net 会话状态功能并更改**会话超时**。默认情况下也是 20 分钟。

D) asp.net 表单认证超时。一开始这让我很困惑，因为我已经在 IIS 中修改了表单身份验证的 cookie 时间（步骤 B）。所以我仍然有一些问题，当我意识到我还需要更改**web.config 表单身份验证标签**以添加**超时属性**以更改默认 20 分钟时。

我的标签看起来像这样： ...forms name=".ASPXFORMSAUTH" path="/" loginUrl="frmLogin.aspx" **timeout="1740"** protection="All" ...

我们开发了一种 javascript 机制来设置会话状态超时，因此我们提醒用户系统将由于不活动而自动注销。

现在效果很好，基本上我已经将所有超时设置设置为“1740”分钟，除了我们设置为 30 分钟的会话状态。因此，在不活动的第 29 分钟，我们向用户显示系统将在一分钟内自动注销，除非他们进行一些活动，因此空闲时间再次从 0 开始。太棒了，现在我们对会话没有任何问题。

无论如何，伙计们，我已经告诉你我们的经验以及我们如何解决你现在遇到的类似问题。但是，我之所以到此结束，是因为**我们也想**在出现任何异常时消除对我本地开发计算机上的绝对路径的引用。

我们还没有弄清楚为什么它显示的是绝对路径。我们已经在发布模式下编译了我们的 DLL 程序集，但这并没有改变任何东西。有大佬解决一下这个问题吗？？？？？？

多谢你们

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-03T13:56:37.283

**在 ViewModel 中引用会话**

您可能没有使用 ASP.net MVC，但如果有人正在寻找答案，这将很有用。

我的情况完全相同，只是每次都会收到空异常，而我的同事根本没有，即使我们运行的是完全相同的代码。

我们的错误是从 ViewModel 引用会话变量，这显然是不好的做法。代码已更改，以便 ViewModel 通过控制器接收会话内容，然后将其设置为 ViewModel 的属性。会话数据（我的示例称为 ProcessingWeek）将使用 this.ProcessingWeek，而不是直接查看 httpcontext.current.session["ProcessingWeek"]。

```
EventMatchResult Match = new EventMatchResult(
      (ImportedEventModel)SessionData.ImportedEventModel,
      ref db,
      SessionData.ProcessingWeek); 
```

...

```
public EventMatchResult(ImportedEventModel Event, ref CFModel db, 
                                                   int ProcessingWeek)
    {
        this.db = db;
        this.MatchedField = new List<PlayerMatchResult>();
        this.ImportedEvent = Event;
        this.ProcessingWeek = ProcessingWeek;
    } 
```

# sql - 关于列标题的 SQL 查询

> ID：15483171
> 
> 赞同：0
> 
> 时间：2013-03-18T17:32:21.697
> 
> 标签：sql

我目前正在 SQL 中创建一个查询，我需要在 Car For Sale 表中生成一个当前没有汽车销售的客户列表。到目前为止，我的代码如下：

```
SELECT 
  Customer.CustomerCode, CarForSale.CustomerCode
FROM 
  Customer LEFT JOIN CarForSale
  ON Customer.CustomerCode = CarForSale.CustomerCode
WHERE 
  CarForSale.CustomerCode IS NULL; 
```

我遇到的问题是显示的正确客户代码不在 Car for Sale 表中，但是我需要将列标题显示为“CustomerCode”。

有谁知道我可以添加什么来制作这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T17:34:56.627

```
SELECT Customer.CustomerCode As [CustomerCode], CarForSale.CustomerCode
FROM Customer 
LEFT JOIN CarForSale ON Customer.CustomerCode = CarForSale.CustomerCode 
WHERE CarForSale.CustomerCode IS NULL 
```

会工作。（如果使用 T-SQL）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T17:35:52.997

```
SELECT
  *
FROM
(
SELECT 
  Customer.CustomerCode CustomerCodeA, CarForSale.CustomerCode CustomerCodeB
FROM 
  Customer LEFT JOIN CarForSale
  ON Customer.CustomerCode = CarForSale.CustomerCode
)
WHERE 
  CustomerCodeB IS NULL; 
```

# css - 不同大小的浮动div

> ID：15483174
> 
> 赞同：0
> 
> 时间：2013-03-18T17:32:29.390
> 
> 标签：css, html

我编写了下面的代码以在 600x400 容器中显示 3 个 div，但遇到了以下问题。请帮忙。

```
<DIV A style="float:left;width:200px;;height:200px;"></DIV>
<DIV B style="float:left;width:400px;;height:400px;"></DIV>
<DIV C style="float:left;width:200px;;height:200px;"></DIV> 
```

![问题描述](../Images/0e106f213cf64d8c1d8b7b62fedb4f18.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-18T17:35:09.060

Instead you need to float a container that contains the two smaller divs, a-la:

```
<div style="float:left">
    <div style=";width:200px;;height:200px;"></DIV>
    <div style="float:left;width:200px;;height:200px;"></div>
</div> 
```

[http://jsfiddle.net/ExplosionPIlls/r7b7e/](http://jsfiddle.net/ExplosionPIlls/r7b7e/)

If A and C are both floated, they won't wrap anyway unless the width of the container is small enough to make them wrap. However, the container (of all three divs) also needs to include the larger div, which makes that impossible. Instead you need to wrap them in their own container.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T17:33:51.417

你的`div`B 应该是`float: right;`

# fortran - 并行 IO 和追加

> ID：15483178
> 
> 赞同：3
> 
> 时间：2013-03-18T17:32:53.227
> 
> 标签：fortran, fortran90

当我运行我的小规模并行代码时，我通常以处理器编号（使用）的形式输出 N 个文件（N 是`fileout.dat.xxx`处理器`xxx`的数量`I3.3`），然后在代码完成后将`cat`它们放入一个文件中。`fileout.dat`

我的问题是我可以在语句中使用`ACCESS='append'`or并让所有处理器写入同一个文件吗？`POSITION='append'``OPEN`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-18T20:23:27.263

在实践中，没有。POSITION='append' 仅表示执行 open 语句后文件指针将位于文件末尾。但是，可以更改文件位置，例如使用 BACKSPACE、REWIND 或此类语句。因此，Fortran POSITION='append' 不对应于 POSIX O_APPEND，因此 POSIX 操作系统不能确保所有写入仅附加到文件并且不会覆盖旧数据。

此外，如果您在集群上运行代码，请注意 O_APPEND 不适用于许多网络文件系统，例如 NFS。

为了在多个进程/线程写入单个文件的情况下进行并行 I/O，请使用 ACCESS='direct' 或 ACCESS='stream' 并让进程就要写入的记录/字节范围达成一致。

# bash - 如何grep文件每一行中特定字符的编号

> ID：15483179
> 
> 赞同：-2
> 
> 时间：2013-03-18T17:32:54.050
> 
> 标签：bash, grep

所以我希望在一个非常大的文件（50Gb）的每一行中查找给定字符的数量。我需要为包含 Character 的每一行获取输出？或者 。每行出现的次数以及行号。关于如何从bash简单地做到这一点的任何想法？我知道每个字符的最大数量是每行 10 个，最小值是 0。这是来自一个旧的、编写不佳的自定义数据库，我需要对其进行转换，并且原始开发人员使用句点和问号作为分隔符。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T18:32:19.833

这将在文件中以行号逐行输出`?`或字符数：`.`

```
line_no=1;
while read line
do
    echo $line_no $((`echo $line | sed 's/[^?.]//g' | wc -m`-1))
    line_no=$(($line_no+1));
done < "your_file.txt" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T17:58:49.550

以下`awk`命令将打印行号、`?`找到的 s 数以及包含 的行的内容`?`：

```
awk -F? '/?/{print NR,NF-1,$0}' file 
```

# tfsbuild - 试图让 TFS 2012 发布网站

> ID：15483183
> 
> 赞同：1
> 
> 时间：2013-03-18T17:32:58.313
> 
> 标签：tfsbuild

我试图让我的 TFS 服务器构建然后发布我的应用程序 - 构建它不是问题，但部署它不会产生结果。

快速查看我的构建配置：

*   工作区：活动 $/Path/to/solution 构建代理文件夹：$(SourceDir)
*   过程：构建任何 CPU | 分期
    *   Ms Build 参数：/p:DeployOnBuild=True /p:DeployTarget=MSDeployPublish /p:MsDeployServiceUrl=https://{host}:8172/msdeploy.axd /p:MsDeployPublishMethod=WMSVC /p:CreatePackageOnPublish=True /p:username = /p:AllowUntrustedCertificate=True

构建代理正在使用我在站点上定义为 IIS 管理器的服务帐户。在项目属性中，我在暂存配置中定义了站点名称（我一直在关注这个视频：[https](https://www.youtube.com/watch?v=oxJUhIQfzlA) ://www.youtube.com/watch?v=oxJUhIQfzlA ）

我在用户身份验证方面遇到的问题是我应该在 MsBuild Args 中指定用户名和密码吗？

在 MSBuild 日志中，无论如何都没有提到发布应用程序。我哪里错了？

编辑：为了解决我的问题，我提供了一些构建配置的屏幕截图 - 用户名和密码已在服务器上以管理员权限定义

![常规选项卡](../Images/783e479d528ef938c60f1859a2d6de93.png) ![扳机](../Images/9427833f88fcd1fac75e06928f17ba2a.png) ![工作区](../Images/ea81de986bf70a52248dcf8f85b96b97.png) ![构建默认值](../Images/d991f681c1176f25164cd17dcd300bb1.png) ![过程](../Images/04083a9b612b2dc651c126eef52709ef.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T15:42:19.117

想通了，需要安装[Web Deploy v3](http://www.microsoft.com/en-gb/download/details.aspx?id=30436)很高兴我明白了！如果您也偶然发现了这篇文章，您可能还会发现这篇[文章](https://stackoverflow.com/questions/2607428/msbuild-target-package-not-found/6413635#6413635)有些用处。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T17:37:42.670

尝试仅将服务器名称放入 MsDeployServiceUrl 参数中。这就是我的方式，他们工作得很好。其他一切都和你的一样。

```
/p:DeployOnBuild=True /p:DeployTarget=MSDeployPublish /p:MSDeployPublishMethod=WMSVC /p:AllowUntrustedCertificate=True /p:CreatePackageOnPublish=true /p:DeployIISAppPath="Default Web Site/xyz" /p:MsDeployServiceUrl="webservername"  /p:username="def" /p:password="ghi" 
```

# c# - 以程序方式为 Dapper 创建一个动态对象

> ID：15483184
> 
> 赞同：4
> 
> 时间：2013-03-18T17:33:00.123
> 
> 标签：c#, sql-server, tsql, ado.net, dapper

我看过很多关于创建`ExpandoObject`对象等的帖子，但在我的情况下它不起作用。我需要创建一个像

```
var someObj = new {
    term1 = "someValue",
    term2 = "other",
    ...
}; 
```

基本上，我们正在使用[`Dapper`](http://code.google.com/p/dapper-dot-net/)并且我们需要动态创建一个查询，其中`WHERE`子句是从给定的参数数组中制作的。我们**不是**泛化查询！这是一个接收可变数量参数的单一方法，我们需要检查`OR`单个列上的每个值。

目前，唯一可行的解​​决方案是恢复并直接使用`System.Data.SqlClient.SqlConnection`，或者有什么办法可以做到这一点？

**更新：**

这是最有可能*应该*起作用的，但不是：

```
string inWhere = null;
dynamic inTerms = new ExpandoObject();
IDictionary<string, object> inTermsDict = inTerms;

if (!(string.IsNullOrEmpty(filter.Term) || string.IsNullOrWhiteSpace(filter.Term))) {
    inWhere = "(" + string.Join(" OR ", filter.Terms.Select((t, i) => "{0} LIKE @p" + i)) + ")";
    int termIndex = 0;
    foreach (string term in filter.Terms) {
        inTermsDict.Add("p" + (termIndex++), term);
    }
}

// ...

var rows = db.Query("SELECT * FROM {table} WHERE {baseCondition}" +
     (string.IsNullOrEmpty(inWhere) ? "" : string.Format(" AND " + inWhere, "columnName")),
     inTerms as object); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-19T03:51:10.500

只是为了回答我自己的问题，因为我们今天早些时候找到了正确的解决方案。

简单地说，我们发现了[`IDynamicParameters`](https://code.google.com/p/dapper-dot-net/source/browse/Dapper/SqlMapper.cs#33)And 这个类简单地解决了所有问题，充当`Dictionary`.

```
var inTerms = new Dapper.DynamicParameters();

inTerms.Add("@p" + (termIndex++), somveValue); 
```

每个人都很高兴！

# ios - 核心数据替换多集

> ID：15483186
> 
> 赞同：0
> 
> 时间：2013-03-18T17:33:03.877
> 
> 标签：ios, core-data

快速提问，如果我想完全替换一对多关系。我需要删除所有以前的对象，还是自动完成

```
newVariable.hasRel = [NSSet setWithSet:newSet]; 
```

如果变量在该集合中有一些对象，只需用新集合替换它就可以摆脱旧实体？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T17:39:38.387

快速回答：分配一组新的相关对象不会删除以前相关的对象。您必须手动执行此操作。

# android - 应用程序仅在 android 4 上崩溃。*

> ID：15483188
> 
> 赞同：-3
> 
> 时间：2013-03-18T17:33:38.670
> 
> 标签：android

我的应用程序可以在模拟器和设备上完美运行。两者都运行 android 2.3.X。当我尝试在 android 4.0+ 上运行它时，它会在加载第二个活动时崩溃，`NullPointerException`结果是 a。

这是我的 logcat 输出：

```
03-18 20:01:59.133: E/AndroidRuntime(611): FATAL EXCEPTION: main
03-18 20:01:59.133: E/AndroidRuntime(611): java.lang.NullPointerException
03-18 20:01:59.133: E/AndroidRuntime(611):  at                           com.example.forsitefoodapp.lazyAdapter.getimage(lazyAdapter.java:106)
03-18 20:01:59.133: E/AndroidRuntime(611):  at com.example.forsitefoodapp.lazyAdapter.getView(lazyAdapter.java:81)
03-18 20:01:59.133: E/AndroidRuntime(611):  at android.widget.AbsListView.obtainView(AbsListView.java:2033)
03-18 20:01:59.133: E/AndroidRuntime(611):  at android.widget.ListView.makeAndAddView(ListView.java:1772)
03-18 20:01:59.133: E/AndroidRuntime(611):  at android.widget.ListView.fillDown(ListView.java:672)
03-18 20:01:59.133: E/AndroidRuntime(611):  at android.widget.ListView.fillFromTop(ListView.java:732)
03-18 20:01:59.133: E/AndroidRuntime(611):  at android.widget.ListView.layoutChildren(ListView.java:1625)
03-18 20:01:59.133: E/AndroidRuntime(611):  at android.widget.AbsListView.onLayout(AbsListView.java:1863)
03-18 20:01:59.133: E/AndroidRuntime(611):  at android.view.View.layout(View.java:11278)
03-18 20:01:59.133: E/AndroidRuntime(611):  at android.view.ViewGroup.layout(ViewGroup.java:4224)
03-18 20:01:59.133: E/AndroidRuntime(611):  at android.widget.RelativeLayout.onLayout(RelativeLayout.java:925)
03-18 20:01:59.133: E/AndroidRuntime(611):  at android.view.View.layout(View.java:11278)
03-18 20:01:59.133: E/AndroidRuntime(611):  at android.view.ViewGroup.layout(ViewGroup.java:4224)
03-18 20:01:59.133: E/AndroidRuntime(611):  at android.widget.FrameLayout.onLayout(FrameLayout.java:431)
03-18 20:01:59.133: E/AndroidRuntime(611):  at android.view.View.layout(View.java:11278)
03-18 20:01:59.133: E/AndroidRuntime(611):  at android.view.ViewGroup.layout(ViewGroup.java:4224)
03-18 20:01:59.133: E/AndroidRuntime(611):  at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1628)
03-18 20:01:59.133: E/AndroidRuntime(611):  at android.widget.LinearLayout.layoutVertical(LinearLayout.java:1486)
03-18 20:01:59.133: E/AndroidRuntime(611):  at android.widget.LinearLayout.onLayout(LinearLayout.java:1399)
03-18 20:01:59.133: E/AndroidRuntime(611):  at android.view.View.layout(View.java:11278)
03-18 20:01:59.133: E/AndroidRuntime(611):  at android.view.ViewGroup.layout(ViewGroup.java:4224)
03-18 20:01:59.133: E/AndroidRuntime(611):  at android.widget.FrameLayout.onLayout(FrameLayout.java:431)
03-18 20:01:59.133: E/AndroidRuntime(611):  at android.view.View.layout(View.java:11278)
03-18 20:01:59.133: E/AndroidRuntime(611):  at android.view.ViewGroup.layout(ViewGroup.java:4224)
03-18 20:01:59.133: E/AndroidRuntime(611):  at android.view.ViewRootImpl.performTraversals(ViewRootImpl.java:1489)
03-18 20:01:59.133: E/AndroidRuntime(611):  at android.view.ViewRootImpl.handleMessage(ViewRootImpl.java:2442)
03-18 20:01:59.133: E/AndroidRuntime(611):  at android.os.Handler.dispatchMessage(Handler.java:99)
03-18 20:01:59.133: E/AndroidRuntime(611):  at android.os.Looper.loop(Looper.java:137)
03-18 20:01:59.133: E/AndroidRuntime(611):  at android.app.ActivityThread.main(ActivityThread.java:4424)
03-18 20:01:59.133: E/AndroidRuntime(611):  at java.lang.reflect.Method.invokeNative(Native Method)
03-18 20:01:59.133: E/AndroidRuntime(611):  at java.lang.reflect.Method.invoke(Method.java:511)
03-18 20:01:59.133: E/AndroidRuntime(611):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
03-18 20:01:59.133: E/AndroidRuntime(611):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
03-18 20:01:59.133: E/AndroidRuntime(611):  at dalvik.system.NativeStart.main(Native Method) 
```

我正在使用 ActionBarSherlock。我不知道这是否与这个问题有关。

**编辑：**

`lazyAdapter`是一个扩展的类`BaseAdapter`。我用它将行添加到我的`ListView`.

这是代码：

```
public class lazyAdapter extends BaseAdapter {
    private Activity activity;

    List<HashMap<String,String>> data ;

    private static LayoutInflater inflater=null;

    public lazyAdapter(Activity a, List<HashMap<String,String>> d) {
        activity = a;
        data=d;
        inflater = (LayoutInflater)activity.getSystemService(activity.getApplicationContext().LAYOUT_INFLATER_SERVICE);
        //imageLoader=new ImageLoader(activity.getApplicationContext());
    }

    public int getCount() {
        return data.size();
    }

    public Object getItem(int position) {
        HashMap<String, String> vid = new HashMap<String,String>();
        vid = data.get(position);
        return vid;

    }

    public long getItemId(int position) {
        return position;
    }

    public View getView(int position, View convertView, ViewGroup parent) {
        View vi=convertView;
        if(convertView==null)
            vi = inflater.inflate(R.layout.list_row, null);

        TextView title = (TextView)vi.findViewById(R.id.title); // title
       // TextView artist = (TextView)vi.findViewById(R.id.artist); // artist name
       // TextView duration = (TextView)vi.findViewById(R.id.duration); // duration
        ImageView thumb_image=(ImageView)vi.findViewById(R.id.list_image); // thumb image

        HashMap<String, String> song = new HashMap<String,String>();
        song = data.get(position);

        // Setting all values in listview
        title.setText(song.get(MainActivity.KEY_tittle));
       // artist.setText(song.get(VideoPage.KEY_description));
      //  duration.setText(song.get(VideoPage.KEY_playTime));
      String imageUrl= song.get(MainActivity.KEY_image);
      if (imageUrl != null){
       URL imgURL;
       try {
            imgURL = new URL(imageUrl);
            thumb_image.setImageBitmap(getimage (imgURL));
        } catch (MalformedURLException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
      }
        //imageLoader.DisplayImage(song.get(VideoPage.KEY_THUMB_URL), thumb_image);
        return vi;
    }
    public Bitmap getimage (URL ImgURL){
        InputStream is = null;
        BufferedInputStream bis = null;
        Bitmap bmp = null;
        try {
           URLConnection conn = ImgURL.openConnection();
           conn.connect();
           is = conn.getInputStream();
           bis = new BufferedInputStream( is );
           bmp = BitmapFactory.decodeStream( bis );
        } catch (MalformedURLException e) {

        } catch (IOException e) {
    Log.i("error","io err");
        } finally {
           try {
              is.close();
              bis.close();
           } catch (IOException e) {

           }
        }

        return bmp;

    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T17:45:01.390

您必须在 Lazy 图像中创建另一个线程。下载在主线程上的 Android 3.0+ 中不起作用。

您应该在其中创建另一个线程`getImage()`以开始下载。

# vb.net - 无法删除文件。另一个进程正在使用的文件

> ID：15483190
> 
> 赞同：0
> 
> 时间：2013-03-18T17:33:44.180
> 
> 标签：vb.net

我有一个下载文件的程序（简单文件更新程序）。在此之前，此文件的旧版本会排队等待删除。但是如果我在文本编辑器中编辑这个文件（保存并关闭它），那么我的程序拒绝删除它。

我有这样的子

```
Private Sub delete_file(ByVal dir As String)
    Try
        If My.Computer.FileSystem.FileExists(dir) Then My.Computer.FileSystem.DeleteFile(dir)
    Catch ex As Exception
        Debug.WriteLine(ex.ToString())
        Sleep(1000)
        delete_file(dir)
    End Try
End Sub 
```

它永远不会退出递归。异常表示该文件正在被其他进程使用，等待不会改变任何事情。有什么线索吗？

[编辑] 稍微改变了 Sub，所以它在异常处理程序中不包含递归

```
Private Sub delete_file(ByVal dir As String)
    Dim ok As Boolean = True
    Try
        If My.Computer.FileSystem.FileExists(dir) Then My.Computer.FileSystem.DeleteFile(dir)
    Catch ex As Exception
        Debug.WriteLine(ex.ToString())
        ok = False
    End Try

    If ok = False Then
        Sleep(1000)
        delete_file(dir)
    End If

End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T10:46:25.643

“另一个过程”这个词非常模棱两可。

事实证明，我的程序中的其他功能是两次打开同一个文件，然后只关闭一次。解决删除它的已删除问题。

因此，当您遇到相同的错误时，请尝试在您的程序中搜索其他可能修改此文件的位置。

感谢您的评论，他们肯定给了我一些关于良好编程的提示。

# java - 错误：无法找到或加载主类 org.antlr.Tool

> ID：15483193
> 
> 赞同：5
> 
> 时间：2013-03-18T17:33:50.387
> 
> 标签：java, build, ubuntu-12.04, netbeans-7, antlr3

我是java和ANTLR的初学者。我正在尝试在 Netbeans IDE 中使用 ANTLR。我试图运行一个示例示例，并且确实遵循了设置环境变量等所需的所有重要步骤，包括 jar 文件和修改 built.xml。

但是当我尝试清理和构建我的应用程序时，我收到以下错误：

```
Error: Could not find or load main class org.antlr.Tool

Java Result: 1
Created dir: ../NetBeansProjects/AntlrTestApp/build/empty
Created dir: ../NetBeansProjects/AntlrTestApp/build/generated-sources/ap-source-output

Compiling 1 source file to ../NetBeansProjects/AntlrTestApp/build/classes
../NetBeansProjects/AntlrTestApp/src/antlrtestapp/AntlrTestApp.java:24: error: cannot find symbol
    grammarLexer lexer = new grammarLexer(input);
  symbol:   class grammarLexer
  location: class AntlrTestApp

../NetBeansProjects/AntlrTestApp/src/antlrtestapp/AntlrTestApp.java:24: error: cannot find symbol
    grammarLexer lexer = new grammarLexer(input);
  symbol:   class grammarLexer
  location: class AntlrTestApp

../NetBeansProjects/AntlrTestApp/src/antlrtestapp/AntlrTestApp.java:26: error: cannot find symbol
    grammarParser parser = new grammarParser(tokens);
  symbol:   class grammarParser
  location: class AntlrTestApp

../NetBeansProjects/AntlrTestApp/src/antlrtestapp/AntlrTestApp.java:26: error: cannot find symbol
    grammarParser parser = new grammarParser(tokens);
  symbol:   class grammarParser
  location: class AntlrTestApp

../NetBeansProjects/AntlrTestApp/src/antlrtestapp/AntlrTestApp.java:29: error: cannot find symbol
    Logger.getLogger(Main.class.getName()).log(Level.SEVERE, null, ex);
  symbol:   class Main
  location: class AntlrTestApp

../NetBeansProjects/AntlrTestApp/src/antlrtestapp/AntlrTestApp.java:31: error: cannot find symbol
    Logger.getLogger(Main.class.getName()).log(Level.SEVERE, null, ex);
  symbol:   class Main
  location: class AntlrTestApp

6 errors

../NetBeansProjects/AntlrTestApp/nbproject/build-impl.xml:603: The following error occurred while executing this line:

../NetBeansProjects/AntlrTestApp/nbproject/build-impl.xml:244: Compile failed; see the compiler error output for details.

BUILD FAILED (total time: 1 second) 
```

自过去 2-3 天以来，我一直在尝试此方法，并搜索了所有可能的解决方案，但对我没有任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T18:54:15.387

看起来您正在尝试在 Ant 构建期间从 ANTLR 3 语法自动生成解析器。以下 Ant 脚本显示了一个包含以下功能的示例：

*   必要时自动下载必要版本的 ANTLR 3 工具，因此您不必将文件包含在源代码控制中或手动设置构建机器。
*   自动定位`.g`指定源文件夹中的所有文件，因此您不必每次添加语法时都编辑构建。
*   完整处理最新检查以获得最大的增量构建性能。

[https://github.com/antlr/antlr4/blob/master/build.xml](https://github.com/antlr/antlr4/blob/master/build.xml)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-09T12:28:52.500

我有一个类似的错误。使用 antlr-x-complete.jar 分发解决了我的问题。

# java - 在 RSyntaxTextArea 中突出显示 ShorthandCompletion 的一部分

> ID：15483194
> 
> 赞同：2
> 
> 时间：2013-03-18T17:33:51.153
> 
> 标签：java, syntax-highlighting, rsyntaxtextarea

我编写了一个调用 RSyntaxTextArea 和自动完成的代码。当用户输入函数时，该单词将被替换为函数<>。我想在下面的代码中突出显示“标签”一词，以便用户知道他们必须输入一个名称。

```
provider.addCompletion(new ShorthandCompletion(provider, "function", "function<Label>","function<Label>")); 
```

该代码基本上用函数替换了函数并继续前进，而不是突出显示标签并等待用户输入内容。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T13:41:51.440

有一个`TemplateCompletion`类可以用来代替`ShorthandCompletion`. 不幸的是，这似乎对我不起作用（在[AutoCompleteDemo](http://fifesoft.com/rsyntaxtextarea/examples/example5.php)示例中尝试过）。

另一种方法是使用 a`CodeTemplateManager`并扩展`CodeTemplate`. 下面是一个示例（来自[CodeTemplateDemo](http://fifesoft.com/rsyntaxtextarea/examples/example2.php)）。

首先扩展`AbstractCodeTemplate`：

```
import java.io.IOException;
import java.io.ObjectInputStream;
import javax.swing.text.BadLocationException;
import javax.swing.text.Caret;
import javax.swing.text.Element;

import org.fife.ui.rsyntaxtextarea.RSyntaxDocument;
import org.fife.ui.rsyntaxtextarea.RSyntaxTextArea;
import org.fife.ui.rsyntaxtextarea.RSyntaxUtilities;

import org.fife.ui.rsyntaxtextarea.templates.*;

public class ArtemisCodeTemplate extends StaticCodeTemplate {

    private static final long serialVersionUID = 1;

    /**
     * The code inserted before the caret position.
     */
    private String beforeCaret;

    /**
     * The code inserted after the caret position.
     */
    private String afterCaret;

    /**
     * Cached value representing whether <code>beforeCaret</code> contains
     * one or more newlines.
     */
    private transient int firstBeforeNewline;

    /**
     * Cached value representing whether <code>afterCaret</code> contains
     * one or more newlines.
     */
    private transient int firstAfterNewline;

    private static final String EMPTY_STRING        = "";

    /**
    * Placeholder for the selected keyword
    */
    private String placeholder;

    /**
     * Constructor.  This constructor only exists to support persistance
     * through serialization.
     */
    public ArtemisCodeTemplate() {
    }

    /**
     * Constructor.
     *
     * @param id The ID of this code template.
     * @param beforeCaret The text to place before the caret.
     * @param afterCaret The text to place after the caret.
     */
    public ArtemisCodeTemplate(String id, String beforeCaret, String placeholder, String afterCaret){
        super(id, beforeCaret, afterCaret);
        setPlaceholder(placeholder);
    }

    public String getPlaceholder() {
        return placeholder;
    }

    public void setPlaceholder(String text) {
        this.placeholder = text;
    }

    private String getAfterTextIndented(String indent) {
        return getTextIndented(getAfterCaretText(), firstAfterNewline, indent);
    }

    private String getBeforeTextIndented(String indent) {
        return getTextIndented(getBeforeCaretText(),firstBeforeNewline,indent);
    }

    private String getTextIndented(String text,int firstNewline,String indent) {
        if (firstNewline==-1) {
            return text;
        }
        int pos = 0;
        int old = firstNewline+1;
        StringBuffer sb = new StringBuffer(text.substring(0, old));
        sb.append(indent);
        while ((pos=text.indexOf('\n', old))>-1) {
            sb.append(text.substring(old, pos+1));
            sb.append(indent);
            old = pos+1;
        }
        if (old<text.length()) {
            sb.append(text.substring(old));
        }
        return sb.toString();
    }

    public void invoke(RSyntaxTextArea textArea) throws BadLocationException {

        Caret c = textArea.getCaret();
        int dot = c.getDot();
        int mark = c.getMark();
        int p0 = Math.min(dot, mark);
        int p1 = Math.max(dot, mark);
        RSyntaxDocument doc = (RSyntaxDocument)textArea.getDocument();
        Element map = doc.getDefaultRootElement();

        int lineNum = map.getElementIndex(dot);
        Element line = map.getElement(lineNum);
        int start = line.getStartOffset();
        int end = line.getEndOffset()-1; // Why always "-1"?
        String s = textArea.getText(start,end-start);
        int len = s.length();

        // endWS is the end of the leading whitespace
        // of the current line.
        int endWS = 0;
        while (endWS<len && RSyntaxUtilities.isWhitespace(s.charAt(endWS))) {
            endWS++;
        }
        s = s.substring(0, endWS);
        p0 -= getID().length();
        String beforeText = getBeforeTextIndented(s);
        String afterText = getAfterTextIndented(s);
        doc.replace(p0,p1-p0, beforeText+ placeholder + afterText, null);
        textArea.setCaretPosition(p0+beforeText.length());
        textArea.moveCaretPosition(p0+beforeText.length() + placeholder.length());
    }

    private void readObject(ObjectInputStream in) throws ClassNotFoundException,
                                                IOException  {
            in.defaultReadObject();
            // "Resetting" before and after text to the same values will replace
            // nulls with empty srings, and set transient "first*Newline" values.
            setBeforeCaretText(this.beforeCaret);
            setAfterCaretText(this.afterCaret);
        }

    /**
     * Returns a string representation of this template for debugging
     * purposes.
     *
     * @return A string representation of this template.
     */
    public String toString() {
        return "[ArtemisCodeTemplate: id=" + getID() +
            ", text=" + getBeforeCaretText() + "|" +
                 getPlaceholder() + "|" + getAfterCaretText() + "]";
    }

} 
```

然后将其添加到`CodeTemplateManager`：

```
 RSyntaxTextArea.setTemplatesEnabled(true);
  CodeTemplateManager ctm = RSyntaxTextArea.getCodeTemplateManager();
  CodeTemplate ct = new ArtemisCodeTemplate("sout", "System.out.println(", "<replaceme>", ");");
  ctm.addTemplate(ct); 
```

如果您键入“sout”并按 ctrl+shift+space，它将展开`System.out.println(<replaceme>);`并选择该`<replaceme>`部分，以便您可以在上面输入。

# css - 浏览器扩展中标识符/类名称的最佳实践

> ID：15483196
> 
> 赞同：2
> 
> 时间：2013-03-18T17:34:11.553
> 
> 标签：css, google-chrome-extension

在扩展中（我主要关注 Chrome 的扩展），页面中注入的 css 标识符和类可能会与页面上的其他元素发生冲突。

我试图用扩展前缀来定义他们的名字，但这并不完全确定。那么，有没有办法准确地定义 css ids/classes 的名称？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T03:16:25.797

如果“完全确定”是您的要求，这是不可能的。有人总是可以下载您的扩展程序，查看您正在使用的类名，然后更改他们网站的 CSS 以与您的类名冲突（或更可能试图覆盖）您的类名。这是一个特性，而不是一个错误；扩展扩展了网页，因此它们应该能够与它们的 DOM 混合并改变它们。

如果您想发明一个其他人不会故意与您的系统发生冲突的系统，为什么不使用 Java 命名空间方案：取一个您拥有的域，并将其用作前缀，例如 com-example-myclassname？您的扩展程序的 ID 或随机生成的 SHA-1 十六进制编码散列的可读性稍差且不再安全：

*   abcdefghijklmnop-myclassname
*   da39a3ee5e6b4b0d3255bfef95601890afd80709-myclassname

我故意不在这里包含动态解决方案，因为 CSS 通常在 Chrome 扩展程序或应用程序中不是动态的。此外，CSP 可能会使这种方法变得简单（这是一件好事）。

# spring - 如何在春季批处理中使用单个作业/ JMSwriter 在多个队列上发布

> ID：15483197
> 
> 赞同：0
> 
> 时间：2013-03-18T17:34:12.803
> 
> 标签：spring, batch-processing, spring-batch, jmstemplate

我是 Spring Batch 的新手，最近开始使用它。

我有一个要求，我需要使用单个作业在不同队列上发布/写入从每个数据库记录读取的消息。因为我必须使用阅读器从数据库读取消息并使用处理器来决定我必须发布哪个队列。

所以我的问题是我可以使用单个 JMSwriter 将消息发布到不同的队列上，因为我必须使用单个 Job 和 DB Reader。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T21:14:36.143

据我所知`JMSwriter`不支持它（它写入默认目的地`jmsTemplate`）。

但是您可能只是实现自己的`ItemWriter`，将所有内容注入`jmsTemplates`其中并编写自定义决策逻辑以选择适当的目标并写入它。

另一种方法 - 使用[ClassifierCompositeItemWriter](http://static.springsource.org/spring-batch/apidocs/org/springframework/batch/item/support/ClassifierCompositeItemWriter.html)，为其添加一组`JmsWriters`并通过您的分类器选择一个

# scheme - Scheme中的绑定变量不知道你有多少变量

> ID：15483205
> 
> 赞同：2
> 
> 时间：2013-03-18T17:34:19.553
> 
> 标签：scheme

我正在寻找一种使用 Scheme 中的模式进行搜索的方法。就像，如果我有一个搜索模式

```
'((x likes  y) (y is a hard sport) (x is rich)) 
```

和输入

```
'((Mike likes rugby) (Rachel likes tennis) 
  (rugby is a hard sport ) ( tennis is easy)
  (Mike is rich) (Rachel is rich)) 
```

我应该只得到迈克，因为他是唯一符合所有限制条件的人。

我已经尝试了好几个小时。我一直试图先将 x 绑定到 Mike ，然后在任何地方使用 Mike 而不是 x 。问题是，我不知道我有多少变量，有没有办法做到这一点，或者我的想法完全错误？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-18T18:49:51.093

如果您需要未知数量的变量，请使用[关联列表](https://en.wikipedia.org/wiki/Association_list)或[哈希表](https://en.wikipedia.org/wiki/Hash_table)来存储名称-值绑定，Scheme 提供了处理这两种数据结构的内置过程。

问题描述和所需的匹配类型看起来很像[Prolog](https://en.wikipedia.org/wiki/Prolog)或类似[逻辑编程](https://en.wikipedia.org/wiki/Logic_programming)系统的工作。如果您在使用 Scheme 时遇到困难，请考虑实现[统一](https://en.wikipedia.org/wiki/Unification_%28computer_science%29#Unification_in_logic_programming)算法（如 SICP 所示[）](https://mitpress.mit.edu/sicp/full-text/sicp/book/node92.html)，或使用嵌入在 Scheme 中的逻辑编程系统，例如[KANREN](http://kanren.sourceforge.net/)或[miniKANREN](http://kanren.sourceforge.net/#mini)。在我们讨论的同时，您还应该查看[The Reasoned Schemer](https://rads.stackoverflow.com/amzn/click/com/0262562146)以供参考。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-18T17:58:33.780

您在这里尝试做的是相当经典的[逻辑编程](http://mitpress.mit.edu/sicp/full-text/sicp/book/node92.html)。我一直用于 Scheme 的方法是`amb`运算符的一些变体。

`amb`像这样工作：

```
(let ((x (amb 1 2 3 4))
      (y (amb 5 6 7 8))
   (rule (= 10 (+ x y))
   (list x y)) 
```

这将返回一些`x y`，因此它们的总和为 10。现在使用这个和其他一些巫术，我们可以制作你的系统。

首先，模式将成为我们的“规则”。所以假设我们像这样格式化我们的模式：

```
'((list-of-vars) (rule 1) (rule 2) (rule 3)) 
```

现在对于我们的输入数据，假设它的结构如下：

```
'((list-of-values) (fact 1) (fact 2) (fact 3)) 
```

现在我们的生活变得非常轻松，我们只想让我们的方案宏/程序/巫术做这样的事情：

```
(define-syntax resolve
  (syntax-rules ()
    [(_ ((v1 vs ...)
         r1 rs ...)
        ((ps ...)
     f1 fs ...))
     (let* ((v1 (amb ps ...))
           (vs (amb ps ...))
           ...
           (sym-table (list (cons (quote v1) v1)
                            (cons (quote vs) vs)
                        ...))
           (facts '(f1 fs ...))
           (rules '(r1 rs ...)))
       (map rule (map
                  (lambda (rule)
                    (member (substitute rule sym-table)
                            facts))
                  rules))
       sym-table)])) 
```

[要点中的完整代码](https://gist.github.com/jozefg/5190455)

希望这能给你一个起点，让我知道你有什么问题。

# d3.js - 调整分区图上的标题大小

> ID：15483206
> 
> 赞同：0
> 
> 时间：2013-03-18T17:34:20.543
> 
> 标签：d3.js

我在这里创建了分区图示例的修改版本：http: [//mbostock.github.com/d3/talk/20111018/partition.html](http://mbostock.github.com/d3/talk/20111018/partition.html)。其中两项修改是：

1.  在每个部分上添加列标题。这些只是我通过查找分区图部分的位置来附加和定位的元素。
2.  向 svg 添加了 viewbox 和 preserveAspectRatio 属性，以便图表可以优雅地调整大小。

最初，标题元素和图表位于不同的 SVG 中，因此它们的大小不协调。我已经将标题元素移动到与图表相同的 SVG 中。虽然我能够在图表第一次显示时正确呈现标题，但在调整大小时，分区图会增长到 100% 高度，忽略在初始呈现时将图表置于标题下方的 x/y 转换。这会导致标题被图表覆盖。

关于如何同时调整图表和标题矩形的大小，同时使分区图尊重 x/y 转换，以便标题子在调整大小期间不会被覆盖的任何建议？

谢谢

蒂姆·S。

# mysql - 如果我的行没有“名称”，我可以使用 MySQL LOAD XML LOCAL INFILE 吗？

> ID：15483207
> 
> 赞同：0
> 
> 时间：2013-03-18T17:34:25.253
> 
> 标签：mysql, xml

我有一些 XML 试图直接加载到 MySQL 表中。我对“ROWS IDENTIFIED BY”的想法相当满意，但我被困在我想保存元素的标签和元素的文本值的地方。我将尝试解释：

我创建了一个 MySQL 表：

```
CREATE TABLE stat (
  Type VARCHAR(40) NOT NULL,
  uID VARCHAR(40) NOT NULL,
  value VARCHAR(40),
  created TIMESTAMP,
  PRIMARY KEY (Type, uID)
); 
```

现在我想加载这种格式的 xml：

```
 <Employee uID="p17336">
    <Name>Joe Bloggs</Name>
    <Stat Type="first_name">Joe</Stat>
    <Stat Type="last_name">Bloggs</Stat>
    <Stat Type="birth_date">1985-07-26</Stat>
  </Employee> 
```

我想要的是每个 Stat 元素的“类型”填充 MySQL 中的“类型”列（这工作正常），然后元素的实际文本（例如“乔”）填充“值”列。我怎样才能做到这一点？目前我正在尝试：

```
 LOAD XML LOCAL INFILE 'C:/dev/Sample/employees.xml'
 INTO TABLE stat
 ROWS IDENTIFIED BY '<Stat>'; 
```

并且正在正确填充所有字段，但“值”除外，它是 NULL。任何想法都非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T17:49:41.160

如[`LOAD XML`语法](https://dev.mysql.com/doc/en/load-xml.html)中所述：

> 该语句支持三种不同的 XML 格式：
> 
> *   列名作为属性，列值作为属性值：
>     
>     
>     
>     ```
>     <***row column1***="***value1***" ***column2***="***value2***" .../>
>     ```
>     
>     
> *   列名作为标签，列值作为这些标签的内容：
>     
>     
>     
>     ```
>     <***row***>
>       <***column1***>***value1***</***column1***>
>       <***column2***>***value2***</***column2***>
>     </***row***>
>     ```
>     
>     
> *   列名是标签的`name`属性`<field>`，值是这些标签的内容：
>     
>     
>     
>     ```
>     <***row***>
>       <field name='***column1***'>***value1***</field>
>       <field name='***column2***'>***value2***</field>
>     </***row***>
>     ```
>     
>     
>     
>     这是其他 MySQL 工具使用的格式，例如[**mysqldump**](https://dev.mysql.com/doc/en/mysqldump.html)。

由于您的 XML 不是这些受支持的格式，因此您必须使用其他一些工具来解析它。

# paypal - 如何在退款电话中使用贝宝身份验证签名和时间戳

> ID：15483210
> 
> 赞同：0
> 
> 时间：2013-03-18T17:34:28.030
> 
> 标签：paypal, paypal-sandbox

我需要代表第三方将付款退还给客户。我研究了权限 API 如何获取访问令牌和验证码以在身份验证 API 中使用它来生成签名和时间戳。但在此之后，我仍然对如何在 Refund API 中使用它感到困惑。目前这是我的退款贝宝代码

```
CallerServices caller = new CallerServices();
APIProfile profile = ProfileFactory.createSignatureAPIProfile();
if(Configuration.getProperty("PaypalEnvironment").equals("sandbox"))
{
profile.setAPIUsername(Configuration.getProperty("PaypalAPIUsername"));
profile.setAPIPassword(Configuration.getProperty("PaypalAPIPassword"));
profile.setSignature(Configuration.getProperty("PaypalSignature"));
profile.setEnvironment(Configuration.getProperty("PaypalEnvironment"));
caller.setAPIProfile(profile);
}
RefundTransactionRequestType pprequest = new RefundTransactionRequestType();
if ((amount != null && amount.length() > 0)
        && (refundType.equals("Partial"))) {
    BasicAmountType amtType = new BasicAmountType();
    amtType.set_value(amount);
    amtType.setCurrencyID(CurrencyCodeType.fromString(currencyCode));
    pprequest.setAmount(amtType);
}
pprequest.setVersion("63.0");
pprequest.setTransactionID(transactionId);
pprequest.setMemo(note);
pprequest.setRefundType(RefundType.fromString(refundType));
RefundTransactionResponseType ppresponse = (RefundTransactionResponseType) caller
            .call("RefundTransaction", pprequest); 
```

在这段代码中，我如何嵌入签名？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T22:31:11.783

退款很简单。一旦您获得请求令牌和验证码，就可以了。您无需将其传递给退款 API。您所要做的就是添加这一行

```
 profile.setSubject(emailid); 
```

然后它会被退还。

# svg - 在 webkit 浏览器中使用标签时，带有嵌入位图的 SVG 不显示位图

> ID：15483215
> 
> 赞同：3
> 
> 时间：2013-03-18T17:34:46.877
> 
> 标签：svg, bitmap, webkit

我正在尝试使用带有嵌入式位图的 SVG 作为导航元素。这个想法是让它对移动设备更友好。我已经为 IE8 及更低版本准备了 PNG 后备。

不知何故，嵌入式位图不会显示在基于 webkit 的浏览器中。没有嵌入位图的 SVG 显示就好了。

我可以使用“对象”标签让背景在 webkit 中显示，但是我的链接不起作用，我无法控制宽度，并且我遇到了一个记录在案的 safari 错误，其中图像未缩放并且出现滑块。

请参阅此处的相关页面： [http](http://www.izbornareforma.rs/izbori-2012/) ://www.izbornareforma.rs/izbori-2012/ 所有图像都是 SVG，底部的四个图像中嵌入了位图。

有许多类似的问题，但没有一个可行的解决方案。

欢迎提出建议。

广东

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-18T18:31:35.307

这是 Webkit 中的一个错误。如果您保留当前背景**并**在标签中加载相同`object`的 SVG，您将看到 SVG 背景将正确加载嵌入数据。为了解决这个问题，我建议你创建一个不可见的`div`地方，在标签中加载你的 SVG `object`，例如......

```
<div id="svgfix">
  <object ... />
  <object ... />
  <object ... />
  <object ... />
</div> 
```

你的 CSS：

```
#svgfix {
  width: 0; 
  height: 0; 
  position: absolute;
  visibility: hidden;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-03-16T03:27:02.930

相应的[Webkit 错误](https://bugs.webkit.org/show_bug.cgi?id=99677)已在 Safari 9 中修复并推出。

# google-chrome - CSS 变换 Scale Hover Chrome

> ID：15483216
> 
> 赞同：1
> 
> 时间：2013-03-18T17:34:47.080
> 
> 标签：google-chrome, css, hover, transform

我正在使用 CSS 变换：缩放（2.0）；为图表中的点设置动画。该效果在 Safari 中按预期工作，但在 Chrome 和显然 IE 中，点在悬停时被剪裁。

这不会发生在一个空白的 HTML 文档中，就在这个图中，有人知道解决方案吗？或者没有一个像样的 jQuery 替代品。

这些点绝对位于图表内

该开发项目位于 www.craigscott.net/succeed

谢谢

一般地图链接样式

```
.link-box {width:20px; height:20px; position: absolute; cursor: pointer; background-color:  white; border-radius: 50%; 
-moz-transition: all 0.1s ease; -webkit-transition: all 0.1s ease; }

.link-box:hover { -webkit-transform:scale(2.0); 

-moz-transform:scale(2.0);
-o-transform:scale(2.0);
transform:scale(2.0);

transform-origin:50% 50%;

-ms-transform-origin:50% 50%; /* IE 9 */
-webkit-transform-origin:50% 50%; /* Safari and Chrome */
-moz-transform-origin:50% 50%; /* Firefox */
-o-transform-origin:50% 50%; /* Opera */

} 
```

所有点位置

```
.mobile-link {bottom:100px; right:135px;}
.mobile-link:hover {bottom:100px; right:135px;}
.visualization-link {bottom:270px; right:70px;}
.UEANDE-link {bottom: 165px; right:45px;}
.support-link {top:110px; left:170px;}
.tech-support-link {top:50px; left:265px;}
.data-govern-link {top:108px; right:175px;}
.payroll-link {left:135px; bottom:98px;}
.CRM-link {left:48px; bottom:165px;}
.HCMC-link {left:70px; top:252px;}
.semantic-link {right:82px; top:200px;}
.op-mod-link {right:30px; top:217px;}
.gameification-link {right:25px; top:270px;}
.jquery-link {right:85px; bottom:85px;}
.portal-link {right:40px; bottom:115px;}
.dashboard-link {right:0px; bottom:148px;}
.alerts-link {right:10px; bottom:200px;}
.support-pack-link {left:175px; top:57px;}
.psoft-link {left:128px; top:82px;}
.upgrades-link {left:130px; top:138px;}
.tech-services-link {left:220px; top:28px;}
.integration-link {left:265px; top:0px;}
.saas-link {left:310px; top:28px;}
.mdm-link {right:130px; top:83px;}
.data-quality-link {right:177px; top:60px;}
.screening-link {right:132px; top:136px;}
.PSGP-link {left:85px; bottom:82px;}
.RTI-link {left:125px; bottom:47px;}
.PAE-link {left:175px; bottom:67px;}
.CX-link {left:0px; bottom:147px;}
.HR-Help-link {left:10px; top:323px;}
.Event-link {left:62px; top:302px;}
.dynamic-link {left:22px; top:270px;}

.fusion-link {left:30px; top:220px;}
.PSHCM-link {left:80px; top:205px;} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T18:03:03.757

我只是找到一个简单的方法，删除所有的转换：规模头痛并写下这个

```
.link-box-child:hover {
   width:40px;
   height:40px;
   margin:-10px;
   position:absolute;
   padding:0px;
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T18:03:24.617

我会使用像**[jQuery Transit](http://ricostacruz.com/jquery.transit/)**这样的 jQuery CSS3 效果框架来处理您的缩放/转换。

此外，它还为您处理跨浏览器问题。恕我直言，它使事情更有条理，更容易维护。看起来你正在做的事情很酷，但如果你不小心，可能很快就会失控。

**例子：**

```
$(".box").hover( function () {

    $('.box').transition({ scale: 2.0 });
    $('.box').transition({ x: '40px' });
}, function () {
    $('.box').transition({ scale: 1.0 });
    $('.box').transition({ x: '-40px' });
}); 
```

[JS 小提琴示例](http://jsfiddle.net/GJJp4/1/)

我知道这不是您问题的确切解决方案，但是如果您坚持使用可靠的框架来处理 CSS3 动画/效果的混乱，您可能会发现走这条路会更容易。

编辑：更新小提琴更像你的示例树“点”：

[JS 小提琴示例 2](http://jsfiddle.net/GJJp4/8/)

**Javascript：**

```
$(".link-box").hover( function () {

    $('.link-box').transition({ scale: 2.0, x: '-40%' }, 'fast');
}, function () {
    $('.link-box').transition({ scale: 1.0, x: '0px' }, 'fast');
}); 
```

# java - 从 Java 创建一个数据库/执行一堆 mysql 语句

> ID：15483217
> 
> 赞同：0
> 
> 时间：2013-03-18T17:34:49.363
> 
> 标签：java, mysql, database, schema

我有一个库需要从 Java 在 MySQL 中创建模式。目前，我有一个模式转储，我只是通过管道输入`mysql`命令。这可以正常工作，但并不理想，因为：

*   它很脆弱：`mysql`命令需要在路径上：通常在没有额外配置的情况下在 OSX 或 Windows 上不起作用。
*   也很脆弱，因为模式存储为语句，而不是描述性的
*   Java 已经可以访问 mysql 数据库，所以依赖外部程序来做这件事似乎很愚蠢。

有谁知道更好的方法来做到这一点？也许...

*   我可以从文件中读取语句并直接从 Java 执行它们吗？有没有一种不涉及解析分号和手动划分语句的方法？
*   我可以以其他方式存储模式 - 作为配置文件或直接在 Java 中，而不是作为语句（以 rails'`db:schema`或的样式`database.yml`），并且有一个库可以根据该描述创建模式？

这是现有代码的片段，它可以工作（当`mysql`在命令行上时）：

```
if( db == null ) throw new Exception ("Need database name!");
String userStr = user == null ? "" : String.format("-u %s ", user);
String hostStr = host == null ? "" : String.format("-h %s ", host);
String pwStr = pw == null ? "" : String.format("-p%s ", pw);

String cmd = String.format("mysql %s %s %s %s", hostStr, userStr, pwStr, db);

System.out.println(cmd + " < schema.sql");      

final Process pr = Runtime.getRuntime().exec(cmd);

new Thread() {
    public void run() {              
        try (OutputStream stdin = pr.getOutputStream()) {
            Files.copy(f, stdin);
        } 
        catch (IOException e) { e.printStackTrace(); }                          
    }
}.start();

new Thread() {
    public void run() {             
        try (InputStream stdout = pr.getInputStream() ) {
            ByteStreams.copy(stdout, System.out);
        } 
        catch (IOException e) { e.printStackTrace(); }
    }
}.start();              

int exitVal = pr.waitFor();
if( exitVal == 0 )
    System.out.println("Create db succeeded!");
else    
    System.out.println("Exited with error code " + exitVal); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T15:24:24.680

简短的回答（据我所知）是否定的。您必须将文件解析为单独的语句。

我也遇到过同样的情况，你可以在 SO 上找到很多关于这个主题的问题。[像这里](https://stackoverflow.com/questions/2903556/a-mysql-schema-parser-in-java/2904327#2904327)的一些会显示一个解析器。其他人可以直接使用工具，例如 apache 的[这篇文章](https://stackoverflow.com/questions/11878034/how-to-copy-a-schema-in-mysql-using-java) ，它可以将架构转换为 xml 格式，然后可以将其读回。

我写这个答案的主要目的是告诉我最后选择使用命令行。

*   **额外配置**：也许这是一项额外的工作，但您可以通过配置或在运行时根据您正在运行的系统来完成。你努力一次，你就完成了
*   **取决于外部工具**：它并不像看起来那么糟糕。你也有一些好处。

    1-您不需要编写额外的代码或引入额外的库来解析模式命令。

    2- 该工具由供应商提供。它可能比将进行解析的任何其他代码都经过更多的调试和测试。

    3-从长远来看更安全。数据库版本附带的工具很可能支持“可能”破坏解析器的转储格式中的任何添加或更改。您无需对代码进行任何更改。

    4-您将要使用该工具的操作（创建模式）的性质不建议频繁使用，从而将其成为性能瓶颈的风险降至最低。

我希望您能找到满足您需求的最佳解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T17:38:34.320

查看[Yank](http://xeiam.com/yank.jsp)，更具体地说是链接到该页面的代码示例。它是构建在 DBUtils 之上的轻量级持久层，并隐藏了处理连接和结果集的所有细节。您还可以像您提到的那样轻松加载配置文件。您还可以从属性文件存储和加载 SQL 语句和/或在代码中硬编码 SQL 语句。

# java - 从 Java 调用 PostgreSQL 中的存储过程

> ID：15483219
> 
> 赞同：1
> 
> 时间：2013-03-18T17:35:04.507
> 
> 标签：java, sql, postgresql, stored-procedures, plpgsql

我已经编写了一个我想用 Java 调用的存储过程。但我认为它不能对我通过的查询做任何事情。以下是我的java代码：

```
String QUERY_LOCATION = "select (license_plate) as test from carInst( (select     category_name from reservation where rid = ?) , (select lname from reservation where rid =  ?))";  
        //PreparedStatement check_location = null;
        PreparedStatement check_location = connection.prepareStatement(QUERY_LOCATION);
        check_location.setInt(1, rid);
        check_location.setInt(2, rid);
        rs = check_location.executeQuery();
        if (rs.next()) {
            System.out.print("Car found: "+rs.getString("test")+"\n");
            license_plate = rs.getString("test");
            update_reservation.setString(5, license_plate);

            bool = false;
        } else {
            System.out
                    .print("There is no car available\n");
        } 
```

以下是我用 PL/pgSQL (PostgreSQL) 编写的存储过程：

```
CREATE OR REPLACE FUNCTION carInst(cname varchar(20), loc varchar(20) ) 
RETURNS TABLE (license_plate varchar(6) ) AS $$
BEGIN 
    DECLARE cur CURSOR 
        FOR SELECT carinstance.license_plate, carmodel.category_name, carinstance.lname FROM carinstance,carmodel 
            WHERE carinstance.mid = carmodel.mid ;                  
BEGIN 
    FOR rec IN cur LOOP
        RETURN QUERY SELECT distinct carinstance.license_plate FROM Carinstance 
            WHERE rec.category_name  = cname
                AND rec.lname = loc
                AND rec.license_plate=carinstance.license_plate;
        END LOOP;
    END; 
END;
$$ LANGUAGE plpgsql; 
```

当我在 Java 中运行代码时，print 语句为 Car found 打印一个空值。我真的很感激这里的一些帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-18T18:43:35.417

### 问题

*   最重要的是，里面的查询`LOOP`是无稽之谈。您从 中选择行`carinstance`，但所有条件都打开`rec`。这会多次选择*所有行。*

*   一个`END`太多了。`FOR`没有`END`，只有`LOOP`。

*   每当您想在 plpgsql 中使用显式游标时，请立即停止。很有可能，你做错了。无论如何，循环都有一个`FOR`隐式游标。

*   不要[混淆没有双引号的混合大小写标识符](http://www.postgresql.org/docs/current/interactive/sql-syntax-lexical.html#SQL-SYNTAX-IDENTIFIERS)。我将所有标识符转换为小写。

*   您使用一个简单的查询，分散在一个游标和另一个查询上。这一切都可以简单得多。

### 解决方案

试试这个简单的 SQL 函数：

```
CREATE OR REPLACE FUNCTION car_inst(_cname text, _loc text) 
  RETURNS TABLE (license_plate text) AS
$func$
   SELECT DISTINCT ci.license_plate
   FROM   carmodel    cm
   JOIN   carinstance ci USING (mid)
   WHERE  cm.category_name  = $1
   AND    ci.lname = $2
$func$ LANGUAGE sql; 
```

称呼：

```
"SELECT license_plate AS test FROM car_inst(
         (SELECT category_name FROM reservation WHERE rid = ?)
        ,(SELECT lname FROM reservation WHERE rid = ?))"; 
```

或者将其全部构建到您的函数中：

```
CREATE OR REPLACE FUNCTION car_inst(_cname text, _loc text) 
  RETURNS TABLE (license_plate text) AS
$func$
   SELECT DISTINCT ci.license_plate
   FROM   carmodel    cm
   JOIN   carinstance ci USING (mid)
   JOIN   reservation r1 ON r1.category_name = cm.category_name
   JOIN   reservation r2 ON r2.lname = ci.lname
   WHERE  r1.rid = $1
   AND    r2.rid = $2;
$func$ LANGUAGE sql; 
```

称呼：

```
"SELECT license_plate AS test FROM car_inst(? , ?)"; 
```

记住：`OUT`参数`license_plate`在函数体的任何地方都是可见的。因此，您必须始终对同名的列进行表限定，以防止命名冲突。

`DISTINCT`可能是也可能不是多余的。

# jquery - 将 livequery 表排序代码更新为 .on

> ID：15483225
> 
> 赞同：2
> 
> 时间：2013-03-18T17:35:31.243
> 
> 标签：jquery, tablesorter, livequery

我正在将我的网站更新到 jQuery 1.7，并计划在第 2 阶段更新到最新版本。下面是我现有的 livequery 代码，我需要更新到 .on() 以维护表格排序功能。

```
// EXISTING CODE - Applies table sorting to existing and future tables with class of tablesorter
$("table.tablesorter").livequery(function(){ // need to replace this .livequery code 
```

我可以使用此代码对加载 DOM 时存在的表启用表排序，但它不适用于加载 DOM 后创建的表。

```
// Only works on existing tables
$('table.tablesorter').tablesorter(); 
```

我用 .on 尝试了以下代码，但它不响应第一次点击

```
// Works on existing tables and tables created later, but it will not respond to initial click event
$(document).on('click', 'table.tablesorter', function(e){  $('table.tablesorter').tablesorter(); }); 
```

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T23:30:05.100

如果是使用ajax加载表格数据，只需在回调函数（或`done`如下所示的函数；[demo](http://jsfiddle.net/Mottie/abkNM/536/)）中初始化表格即可：

```
$.ajax({
  type: "GET",
  // should return raw html of the table
  url: "mysite.com/table"
}).done(function(data) {
  // add the table
  $(data).appendTo('body');
  // initialize it
  $('table').tablesorter({
    theme : 'blue'
  });
}); 
```

这只是众多例子之一。

# ios - 在哪里突出显示 UICollectionViewCell：委托还是单元格？

> ID：15483229
> 
> 赞同：35
> 
> 时间：2013-03-18T17:35:39.603
> 
> 标签：ios, ios6, uicollectionview, uicollectionviewcell

根据[集合视图编程指南](http://developer.apple.com/library/ios/#documentation/WindowsViews/Conceptual/CollectionViewPGforIOS/CreatingCellsandViews/CreatingCellsandViews.html#//apple_ref/doc/uid/TP40012334-CH7-SW8)，应该处理`UICollectionViewDelegate`. 像这样：

```
- (void)collectionView:(PSUICollectionView *)collectionView didHighlightItemAtIndexPath:(NSIndexPath *)indexPath
{
    MYCollectionViewCell *cell = (MYCollectionViewCell*)[collectionView cellForItemAtIndexPath:indexPath];
    [cell highlight];
}

- (void)collectionView:(UICollectionView *)collectionView didUnhighlightItemAtIndexPath:(NSIndexPath *)indexPath
{
    MYCollectionViewCell *cell = (MYCollectionViewCell*)[collectionView cellForItemAtIndexPath:indexPath];
    [cell unhighlight];
} 
```

我不喜欢这种方法的地方在于它向委托中添加了非常特定于单元格的逻辑。实际上，通过属性`UICollectionViewCell`独立管理其突出显示的状态。`highlighted`

那么，压倒一切不是`setHighlighted:`更清洁的解决方案吗？

```
- (void)setHighlighted:(BOOL)highlighted
{
    [super setHighlighted:highlighted];
    if (highlighted) {
        [self highlight];
    } else {
        [self unhighlight];
    }
} 
```

这种方法而不是委托方法有什么缺点吗？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2013-03-18T18:41:11.480

正如文档所说，您可以在单元格突出显示时依赖`highlighted`要更改的属性。例如，以下代码将在突出显示时使单元格变为红色（但不是它的子视图）：

```
- (void)setHighlighted:(BOOL)highlighted {
    [super setHighlighted:highlighted];
    [self setNeedsDisplay];
}

- (void)drawRect:(CGRect)rect {
    [super drawRect:rect];

    if (self.highlighted) {
        CGContextRef context = UIGraphicsGetCurrentContext();
        CGContextSetRGBFillColor(context, 1, 0, 0, 1);
        CGContextFillRect(context, self.bounds);
    } 
} 
```

如果你**添加**这样的东西，背景会变成紫色（红色+不透明的蓝色）：

```
- (void)collectionView:(UICollectionView *)colView didHighlightItemAtIndexPath:(NSIndexPath *)indexPath {
    UICollectionViewCell *cell = [colView cellForItemAtIndexPath:indexPath];
    cell.contentView.backgroundColor = [UIColor colorWithRed:0 green:0 blue:1 alpha:0.5];
}

- (void)collectionView:(UICollectionView *)colView didUnhighlightItemAtIndexPath:(NSIndexPath *)indexPath {
    UICollectionViewCell *cell = [colView cellForItemAtIndexPath:indexPath];
    cell.contentView.backgroundColor = nil;
} 
```

因此，您可以同时使用两者（不一定都更改单元格外观）。不同之处在于，使用委托方法您也有`indexPath`. 它可能用于创建多选（您将与选择委托方法一起使用此方法），在单元格突出显示时显示一些预览，在其他视图中显示一些动画......这个委托有很多设备我认为的方法。

作为结论，我将让单元格外观由单元格本身处理，并使用委托方法让控制器同时制作一些很酷的东西。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2016-01-13T22:15:53.547

下面概述了两种可能的方法。

**细胞子类化**

如果已经从`UICollectionViewCell`.

```
class CollectionViewCell: UICollectionViewCell {

    override var highlighted: Bool {
        didSet {
            self.contentView.backgroundColor = highlighted ? UIColor(white: 217.0/255.0, alpha: 1.0) : nil
        }
    }
} 
```

**UICollectionViewDelegate**

不太干净，需要集合视图委托了解单元格的表示逻辑。

```
func collectionView(collectionView: UICollectionView, didHighlightItemAtIndexPath indexPath: NSIndexPath) {

    if let cell = collectionView.cellForItemAtIndexPath(indexPath) {
        cell.contentView.backgroundColor = UIColor(white: 217.0/255.0, alpha: 1.0) // Apple default cell highlight color
    }
}

func collectionView(collectionView: UICollectionView, didUnhighlightItemAtIndexPath indexPath: NSIndexPath) {

    if let cell = collectionView.cellForItemAtIndexPath(indexPath) {
        cell.contentView.backgroundColor = nil
    }
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2016-01-16T04:34:10.693

注意`UICollectionViewCell`有一个`selectedBackgroundView`属性。默认情况下，它为零。只需为这个属性创建一个视图，当用户触摸单元格时它就会出现。

```
override func awakeFromNib() {
    super.awakeFromNib()

    let view = UIView(frame: contentView.bounds)
    view.isUserInteractionEnabled = false
    view.autoresizingMask = [.flexibleWidth, .flexibleHeight]
    view.backgroundColor = UIColor(white: 0.94, alpha: 1.0)
    selectedBackgroundView = view
} 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2018-12-20T10:42:16.203

突出显示单元格就足够了（Swift 4）

```
class MyCollectionViewCell: UICollectionViewCell {
...
    override var isHighlighted: Bool {
        didSet {
            if isHighlighted {
                self.contentView.alpha = 0.6
            }
            else {
                self.contentView.alpha = 1.0
            }
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2014-07-21T02:52:02.453

嗯……因为所有这些方法都是正确的。我找到了对我来说似乎最简单的方法。只需覆盖 setSelected: 方法（例如更改背景颜色）：

```
-(void)setSelected:(BOOL)selected{
    self.backgroundColor = selected?[UIColor greenColor]:[UIColor grayColor];
    [super setSelected:selected];
} 
```

...它“开箱即用”（即使使用 collectionView.allowsMultipleSelection）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-10-20T18:46:54.427

直接取自 UICollectionViewCell.h - 覆盖两者`setSelected`并且`setHighlighted`是正确的。根据您的情况，您可能会考虑将自定义视图分配给`backgroundView`并`selectedBackgroundView`在选择时自动交换。

```
// Cells become highlighted when the user touches them.
// The selected state is toggled when the user lifts up from a highlighted cell.
// Override these methods to provide custom UI for a selected or highlighted state.
// The collection view may call the setters inside an animation block.
@property (nonatomic, getter=isSelected) BOOL selected;
@property (nonatomic, getter=isHighlighted) BOOL highlighted;

// The background view is a subview behind all other views.
// If selectedBackgroundView is different than backgroundView, it will be placed above the background view and animated in on selection.
@property (nonatomic, retain) UIView *backgroundView;
@property (nonatomic, retain) UIView *selectedBackgroundView; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-07-30T07:10:19.333

Swift 3：（基于 A-Live 的回答）

```
import UIKit

class MyCollectionViewCell: UICollectionViewCell {

    override var highlighted: Bool {
        didSet {
            self.setNeedsDisplay()
        }
    }

    override func drawRect(rect: CGRect) {
        super.drawRect(rect)
        myImageView.highlighted = self.highlighted
    }
} 
```

斯威夫特 4

```
import UIKit

class MyCollectionViewCell: UICollectionViewCell {

    override var isHighlighted: Bool {
        didSet {
            self.setNeedsDisplay()
        }
    }

    override func draw(_ rect: CGRect) {
        super.draw(rect)
        myImageView.isHighlighted = self.isHighlighted
    }
} 
```

# javascript - 在 Python 中，您可以像在 JavaScript 中那样对字符串函数进行原型设计吗？

> ID：15483230
> 
> 赞同：5
> 
> 时间：2013-03-18T17:35:43.980
> 
> 标签：javascript, python, prototype

在 JavaScript 中，您可以这样做以将修剪函数添加到现有原型函数

```
String.prototype.trim = function() {
    return this.replace(/^\s+|\s+$/g,""); 
```

然后你可以做这样的事情来访问这些功能。

```
trimmed = myString.trim(); 
```

你有一个修剪过的字符串。

在python中，我知道如何通过这样做列出字符串的原型函数：

```
print dir(myString) 
```

但是如何在 Python 中添加原型函数呢？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-18T17:38:22.137

首先，Python 有一个基于类的对象系统，而不是像 JavaScript 这样的基于原型的系统。

为类或实例添加方法（或其他属性）非常简单：

```
FooClass.method = my_method
foo_instance.method = my_method 
```

但是，它不适用于许多“内置”类型（实际内置，以及在 C 扩展中定义的那些）。并且`str`是其中之一。

所以，你不能这样做。

* * *

但是，构建几乎任何类型的子类都非常容易：

```
class MyStringType(str):
    def trim(self):
        # your implementation here 
```

您可能需要一个自定义`__init__`方法，并且可能需要一个自定义`__new__`. 还要确保将所有返回 a 的方法更改`str`为返回 a `MyStringType`。

* * *

另一种方法是通过委托：

```
class MyStringType(object):
    def __init__(self, *args, **kwargs):
        self.s = str(*args, **kwargs)
    def trim(self):
        # your implementation here 
```

这样，您将被迫显式转发您想要的每个方法`str`，而不是自动获取它们。但通常这样会更好。特别是考虑到您可以通过实现自定义`__getattr__`或以编程方式构建转发方法（在`__init__`或类范围内）来实现它的简单程度。

* * *

但最简单的解决方案是……不要这样做。有一个`trim`带参数的函数有什么问题`str`？

这样做的好处是你的`trim`函数可以接受*任何类似字符串的对象*。例如，您的函数（在某些已编译的 regex 上`trim`编写为包装器）将同时使用和（其中一个是2.x 中的同义词，另一个是 3.x 中的同义词……但如果您可以同时处理这两者，那就不没关系），并使用 PyObjC包装器或 pywin32包装器，依此类推。A -type 方法甚至适用于区域。为什么将其限制为仅适用于？`r.replace``r``unicode``bytes``str``NSString``BSTR``find``mmap``str`

这种“鸭式打字”是 Python 做事方式的核心。如果您的代码没有理由关心对象的实际类型，那么您不应该特意去关心它。

# php - INSERT 查询不返回对象

> ID：15483236
> 
> 赞同：0
> 
> 时间：2013-03-18T17:35:56.253
> 
> 标签：php, mysql

我只是想检索插入行的唯一 ID。为什么这段代码不起作用？

```
include('lib_connection.php');
$con = dbconnect();
$res = $con->query("insert into schools(school,city) values('CyFair High School','houston') ");
echo $res->insert_id;
$con->close(); 
```

我只得到：

```
Notice: Trying to get property of non-object in C:\Program Files (x86)\wampserver\www\hwsource\do_test.php on line 5 
```

dbconnect() 工作正常。该查询也可以正常执行并将值插入数据库中，但我没有得到返回的对象。我只是得到一个布尔真值。如果 Insert 没有返回对象，那么我该如何检索插入的 ID？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T17:48:37.107

尝试

```
$mysqli = new mysqli("localhost", "my_user", "my_password", "world");  //use your data
$mysqli->query("insert into schools(school,city) values('CyFair High School','houston') ");
echo $mysqli->insert_id
$mysqli->close(); 
```

**更新：** 而不是 $con->close() 尝试 mysql_close($con);

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T17:47:34.013

如果我认为您的 dbconnection 使用简单明了的 mysql 函数是正确的，那么只需替换

```
echo $res->insert_id; 
```

和：

```
echo mysql_insert_id(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-18T17:48:00.490

如果您使用的是 PDO，您需要将获取模式设置为 PDO::FETCH_OBJECT...此外，如果您的代码返回一个数组，您可以简单地将其转换为像这样的对象（对象）$res。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-30T08:59:30.683

修正

`echo $res->insert_id;`

至

`echo $con->insert_id;`

在这个阶段这是一个老问题，但最好的答案仍然模棱两可，所以我想我会澄清一下，使用问题中的实际变量名称，以及通常当前实现的 PHP 版本。

`$con`如果是一个对象，我的答案是有效的`mysqli`，它可能是（而不是旧的`mysql`——“i”代表“改进”）。因此，当执行它的查询方法时，它

> 失败时返回 FALSE。对于成功的 SELECT、SHOW、DESCRIBE 或 EXPLAIN 查询，mysqli_query() 将返回一个 mysqli_result 对象。对于其他成功的查询，mysqli_query() 将返回 TRUE。[[资源]](http://php.net/manual/en/mysqli.query.php)

这解释了错误消息，因为查询是`INSERT`.

我来到这里是因为教科书指示我从结果中获取 insert_id 而不是 mysqli 对象本身，但我在过去或现在版本的 MySQL 的文档中找不到任何理由。

# c++ - c ++在给定类中创建函数指针向量，函数是不同类的成员

> ID：15483238
> 
> 赞同：0
> 
> 时间：2013-03-18T17:36:00.727
> 
> 标签：c++, vector, function-pointers, functor

我在一个类中有一个函数指针向量，我想向它传递其他类中的函数地址。以下实现给出了错误。正确的方法是什么？

```
class A
{
public:
 void func ()
 {
 }
};

class B
{
public:
 std::vector<void(*)()) myVec;
 void update_func()
 {
  myVec.push_back(&A::func);
 } 
};

int main()
{
 B* b = new B;
 b->update_func();
 return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-18T17:43:40.733

指向非静态成员函数的指针`A::func`没有 type `void(*)(void)`，它有 type `void(A::*)(void)`。因此，要么更改向量以匹配您希望它具有的元素，要么使用指向向量正确类型函数的指针。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T17:54:21.647

A 的 func() 必须是静态的以匹配函数指针的声明。同时，它必须`public`是 B 类可以访问的。B `update_func()`中也需要是公共的，否则`main`它是不可访问的。矢量声明有错字，必须是`vector<>`，不是`vector<)`。

//

```
class A
{
  public:
   static void func ()
   {
   }
};

class B
{
 std::vector<void(*)()> myVec;
 public void update_func()
 {
  myVec.push_back(&A::func);
 } 
};

int main()
{
 B* b = new B;
 b->update_func();
 return 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-18T17:40:28.580

这段代码有很多问题..如果你想调用那个函数，第一个 b->func 应该有 () ..第二个..什么是 void update func()..也是错误的代码..第三个你不能使用这些函数因为它们是私有的...但是您确实将其正确推入向量中...

# php - PHP 中的日历月份和以红色显示第 4 天（循环、日期、HTML 显示字体红色）

> ID：15483239
> 
> 赞同：1
> 
> 时间：2013-03-18T17:36:02.770
> 
> 标签：php

我正在尝试对该年月份中的日子进行简单的循环。所以我在 PHP 中使用了 for 循环。我指定了 2013 年 4 月的日期，$date = mktime(0, 0, 0, 4, 1, 2013)。我还确定了该月的天数，$days = date("t", $date)。然后我使用 for 循环进行循环，以便 for ($i = 1; $i <= $d1; $i++) 它将显示 2013 年 4 月的所有天数，即 30 天（输出：1 , 2, 3, **4** , 5....30)。我想以 HTML 格式显示它，使它看起来像 2013 年 4 月的日历月（我稍后可以弄清楚）。但是，我认为我本身就有这个“作家的块”（或编程块等等）。我想显示，以便当 $i = 4 时，用红色单独显示，表示这是一个特殊的日子。这是我的主要事情 我坚持。我的代码如下：

```
$date = mktime(0, 0, 0, 4, 1, 2013);
$days =  date("t", $date);

for ($i = 1; $i <= $days; $i++) { echo $i; } // except when $i = 4, echoes it as red/bold 
```

有任何想法吗？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T17:40:28.707

```
 $date = mktime(0, 0, 0, 4, 1, 2013);
    $days =  date("t", $date);

    for ($i = 1; $i <= $days; $i++) { 

         if(($i % 4))
          { 
            echo '<span style="color: #f00; font-weight: bold;">'.$i.'</span>';
           } else { echo $i; } 
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T17:42:43.857

未经测试，但应该是你所追求的......

```
$date = mktime(0, 0, 0, 4, 1, 2013);
$days =  date("t", $date);

for ($i = 1; $i <= $days; $i++) { 
if($i % 4 == 0){
    echo "<div style='color: red'>" . $i . "</div>";
}
else{
    echo $i;
}
} 
```

# visual-studio-2010 - Internet Explorer 8 在使用 Visual Studio 2010 进行调试时冻结

> ID：15483242
> 
> 赞同：1
> 
> 时间：2013-03-18T17:36:21.413
> 
> 标签：visual-studio-2010, internet-explorer, debugging, internet-explorer-8

我有一个过去几个月一直在开发的 ASP.NET Web 应用程序。最近我遇到了一个问题，当我开始调试并且 Internet Explorer 启动时它被锁定。我试过等待，但它会无限期地挂起。这发生在大约 75% 的时间里。我知道如果进度条没有出现在页脚中，它将被锁定。如果出现进度条，则一切正常。它变成了一种开始/停止调试直到它工作的仪式。如果我使用 Firefox，一切正常。但是我不能永远避免使用 IE，因为这个应用程序是在一个所有用户都只使用 IE8 的封闭环境中使用的。

我知道这与代码无关，因为在星期五一切都很好，然后没有进行任何更改，它在星期一开始以这种方式运行。我还打开了其他 Web 应用程序，它们也遇到了同样的问题。

我已确保 Windows 更新中的所有内容都是最新的。我一直在寻找 Visual Studio 2010 的任何更新/修复。我无法在任何地方找到任何描述此问题的帖子。我的日志中也没有显示任何内容。

我正在运行带有 VS2010 SP1 的 Windows 7 SP1 64 位。

编辑：我也尝试使用 IIS 而不是内置的开发服务器运行解决方案，但没有效果。

# symfony - 在 symfony2 的 where 子句中使用日期格式查询

> ID：15483243
> 
> 赞同：0
> 
> 时间：2013-03-18T17:36:29.523
> 
> 标签：symfony, symfony-2.1, symfony-2.2

当我在 where 子句中运行带有日期的查询时，会显示以下错误...

```
[Syntax Error] line 0, col 129: Error: Expected known function, got 'DATE_FORMAT' 
```

查询如下

```
$query = $this->getEntityManager()->createQuery(
  "SELECT a.id, a.amont, a.paymentDescrip, a.paymentType, a.paymentDate
   FROM RegalSmsBundle:DailyTransaction a 
   WHERE DATE_FORMAT(a.paymentDate,'%Y-%m-%d') = :paymentDate
        and a.students = :studentId" 

    )->setParameter('studentId', $studentId)
    ->setParameter('paymentDate','2013-03-11');

 return $query->getResult(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T17:54:43.153

Doctrine 默认没有`DATE_FORMAT`定义函数。可以[注册自定义 DQL 函数](http://symfony.com/doc/current/cookbook/doctrine/custom_dql_functions.html)。

但是您可以轻松比较日期（假设`a.paymentDate`是 type `date`）：

```
$query = $this->getEntityManager()->createQuery("
        SELECT a.id, a.amont, a.paymentDescrip, a.paymentType, a.paymentDate
        FROM RegalSmsBundle:DailyTransaction a 
        WHERE a.paymentDate = :paymentDate AND a.students = :studentId
    ")
    ->setParameter('studentId', $studentId)
    ->setParameter('paymentDate', new \DateTime('2013-03-11'))
;

return $query->getResult(); 
```

**编辑**：我更喜欢使用 querybuider 来编写 DQL。它看起来像这样：

```
$qb = $this->getEntityManager()->getRepository('RegalSmsBundle:DailyTransaction')->createQueryBuilder('a');
$qb
    ->select('a') // select whole entity
    ->where($qb->expr()->andX(
        $qb->expr()->eq('a.paymentDate', ':paymentDate')
        $qb->expr()->eq('a.students', ':studentId')
    ))
    ->setParameter('studentId', $studentId)
    ->setParameter('paymentDate', new \DateTime('2013-03-11'))
;

return $qb->getQuery()->getResult(); 
```

# ios - iOS 中特定字符串的 SHA1

> ID：15483246
> 
> 赞同：2
> 
> 时间：2013-03-18T17:36:41.480
> 
> 标签：ios, objective-c, sha1

根据我的要求：

1.  输入字符串必须转换为字节值。
2.  string 的每个字符（16 位值）都必须转换为低 8 位。
3.  然后在字节数组上计算 Sha1。
4.  生成的 SHA-1 将转换为 40 个字符的字符串。

我知道如何将字符串转换为 SHA1 ，但其余部分对我来说有点悲观。我已经能够完成最后两个步骤。

```
unsigned char digest[CC_SHA1_DIGEST_LENGTH];
NSData *dataString = [yourString dataUsingEncoding: NSUTF8StringEncoding]; 

if (CC_SHA1([dataString bytes], [dataString length], digest)) {
   //Sha1 is calculated & stored in digest.
} 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-18T19:08:08.767

我已经创建了这个功能，它可以根据您的要求正常工作。你只需要输入一个字符串。

```
#import <CommonCrypto/CommonDigest.h>

- (NSString *)calculateSHA:(NSString *)yourString
{
    const char *ptr = [yourString UTF8String];

    int i =0;
    int len = strlen(ptr);
    Byte byteArray[len];
    while (i!=len)
    {
        unsigned eachChar = *(ptr + i);
        unsigned low8Bits = eachChar & 0xFF;

        byteArray[i] = low8Bits;
        i++;
    }

    unsigned char digest[CC_SHA1_DIGEST_LENGTH];

    CC_SHA1(byteArray, len, digest);

    NSMutableString *hex = [NSMutableString string];
    for (int i=0; i<20; i++)
        [hex appendFormat:@"%02x", digest[i]];

    NSString *immutableHex = [NSString stringWithString:hex];

    return immutableHex;
} 
```

然后你只需要调用上面的方法。

```
[self calculateSHA:yourString]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T18:08:01.490

```
NSData *dataString = [yourString dataUsingEncoding: NSUTF8StringEncoding]; 
```

将字符串转换为 UTF-8 字节，例如 "é" = Unicode 00E9 转换为两个字节`C3 A9`，而 "€" = Unicode 20AC 转换为三个字节`E2 82 AC`。

如果您的要求是将 Unicode 字符“截断”为低 8 位，则必须“手动”执行此操作，我不知道可用于此的内置编码：

```
NSMutableData *dataString = [NSMutableData dataWithLength:[yourString length]];
uint8_t *dataBytes = [dataString mutableBytes];
for (NSUInteger i = 0; i < [yourString length]; i++) {
    // assigning the character to a uint_8 truncates to the lower 8 bit:
    dataBytes[i] = [yourString characterAtIndex:i];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-18T19:04:13.777

根据您的代码片段，您想要执行以下操作：

```
unsigned char digest[CC_SHA1_DIGEST_LENGTH];
NSData *dataString = [yourString dataUsingEncoding: NSUTF8StringEncoding];
NSMutableString *outString;

if (CC_SHA1([dataString bytes], [dataString length], digest)) {
    for (int i=0;i<CC_SHA1_DIGEST_LENGTH;i++) {
        [outString appendFormat:@"%02x", digest[i]];
    }
} 
```

其中 outString 将是您的 40 字符字符串。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-03-20T06:57:52.973

这是一个用于创建 NSString 的 SHA1 哈希的 [NSString 类别。](https://github.com/pm-dev/PMUtils/blob/master/Pod/Classes/Foundation%2BPMUtils/NSString%2BPMUtils.m#L47-52)[从 NSString 创建 SHA1 哈希](https://stackoverflow.com/questions/7570377/creating-sha1-hash-from-nsstring/29161055#29161055)

# java - 将旧的线程池代码升级到新的并发类

> ID：15483249
> 
> 赞同：1
> 
> 时间：2013-03-18T17:36:56.543
> 
> 标签：java, multithreading, concurrency, threadpool, daemon

我正在更新一些我很久没有接触过的旧 Java 代码。我的问题与现在做线程池的最佳方法是什么有关？

以前我使用了并发工具类的：

```
import EDU.oswego.cs.dl.util.concurrent.BoundedBuffer;
import EDU.oswego.cs.dl.util.concurrent.PooledExecutor; 
```

但是，我认为这不是最好的方式，因为我现在正在更新到 Java 7。

这是我的代码片段：

```
Static PooledExecuter pooledExecuter = null; 
```

……

```
private ThreadPoolExample(Int initialCapactiy, int initThreadPoolSize,
                   int maxThreadPoolSize, int minThreadPoolSize, 
                   int time) throws Exception 
{
  pooledExecuter = new PooledExecuter(new BoundedBuffer(initialCapactiy),     maxThreadPoolSize);
pooledExecuter.setMinimumPoolSize(minThreadPoolSize);
pooledExecuter.setKeepAliveTime(1000 * time);
pooledExecuter.waitWhenBlocked();
pooledExecuter.createThreads(initThreadPoolSize)

    //setup thread
 this.thread = new Thread(this);
 this.thread.setName("threadtest");
   try 
{
   this.thread.setDaemon(this)
} 
catch (Exception e)
{
}
} 
```

在我的运行方法中，我还调用了 pooledExecuter.execute(new TestClass)

基本上，我想知道我现在应该用哪种方式来做我的线程池？

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T17:43:59.960

我不确定它是如何`BoundedBuffer`发挥作用的，但我相信你只需要说：

```
threadPool = Executors.newFixedThreadPool(maxThreadPoolSize, new ThreadFactory() {
    public Thread newThread(Runnable r) {
        Thread thread = new Thread(r);
        thread.setDaemon(true);
        return thread;
    }
}); 
```

`BoundedBuffer`可以被替换为使用`BlockingQueue`内部创建的`LinkedBlockingQueue`。

如果您想对保持活动设置（等）进行更细粒度的控制，则可以直接调用[`ThreadPoolExecutor`构造函数](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ThreadPoolExecutor.html)。

```
public ThreadPoolExecutor(int corePoolSize,
    int maximumPoolSize,
    long keepAliveTime,
    TimeUnit unit,
    BlockingQueue<Runnable> workQueue,
    ThreadFactory threadFactory) 
```

就像是：

```
threadPool = new ThreadPoolExecutor(initialCapactiy, maxThreadPoolSize,
    time, TimeUnit.SECONDS, new LinkedBlockingQueue<Runnable>(),
    new ThreadFactory() {
        public Thread newThread(Runnable r) {
            Thread thread = new Thread(r);
            thread.setDaemon(true);
            return thread;
        }
    }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T17:44:27.183

您可能应该使用`ExecutorService`，您可以从 中的众多便捷方法之一构造它[`Executors`](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/Executors.html)，包括指定有界队列的方法等，用于插入项目。

我在您的代码中看到许多拼写错误，例如`Static`关键字（大写 S）无效并且`PooledExecutor`拼写不同。你确定编译？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-18T17:45:19.710

您可以使用 Java 并发实用程序。查看用于处理线程池的 Executor 框架。

[http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/Executor.html](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/Executor.html) [http://www.vogella.com/articles/JavaConcurrency/article.html#threadpools](http://www.vogella.com/articles/JavaConcurrency/article.html#threadpools)

或者，如果您使用的是 Spring，请查看 TaskExecutor。

[http://static.springsource.org/spring/docs/3.0.x/reference/scheduling.html](http://static.springsource.org/spring/docs/3.0.x/reference/scheduling.html)

如果您在 Java EE 应用程序服务器中运行您的代码，您可能需要查看服务器的文档以找出使用线程池的最佳方式。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-03-18T17:48:01.407

Java 7 引入了 ForkJoinPool。关于何时使用它的文章在[这里](http://www.javaworld.com/javaworld/jw-10-2011/111004-jtip-recursion-in-java-7.html)。

# matlab - 保龄球得分计算器 MATLAB

> ID：15483250
> 
> 赞同：1
> 
> 时间：2013-03-18T17:37:10.033
> 
> 标签：matlab

我的保龄球得分计算器有点问题。我只是有点偏离这里，我很确定它与最后一帧有关。不过我不知道。一点关于加载的变量。Bowling.xls 包含 50 场保龄球比赛的数据，因此 games 是一个 50x21 矩阵。21 列对应于每个投出的球。谢谢你们的帮助。如果您不了解 Matlab，欢迎您使用通用代码回复。

编辑：这是我的最新代码。正如您所看到的，“当前”变量现在被预设以显示我正在尝试计算的游戏，所以你们可以看到它以进行调试。我从这个程序得到的输出是 158。它应该是 194。

```
i = 1;
gamescore = 0;
current =  [10 0 6 0 9 1 10 0 10 0 8 2 8 2 8 0 10 0 10 10 10]
strikes = zeros(1,10);
spares = zeros(1,10);

% Check for strikes
for j=1:10
    if current(2*j-1) == 10
        strikes(j) = 1;
    end
end

% Check for spares
for j=1:10
    if (current(2*j-1) + current(2*j) == 10) && (current(2*j-1)~=10)
        spares(j) = 1;
    end
end

% Calculate score
for j=1:10
    if strikes(j) == 1
        gamescore = gamescore + 10 + current(2*j) + current(2*j+1);
    elseif spares(j) == 1
        gamescore = gamescore + 10 + current(2*j);
    else
        gamescore = gamescore + current(2*j-1) + current(2*j);
    end
end
fprintf('Game score: %d \n',gamescore) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T18:25:49.403

让我们考虑这段代码：

```
else
    score(1,j) = current(1,j) + current(1,j+1); 
```

如果第 5 局没有罢工或备用，`j=5`，比分是多少？从代码中它将是

```
= current(1,j) + current(1,j+1);
= 5th Ball + 6th Ball
= Score of frame 3 
```

从这里应该清楚代码需要更改为

```
else
    score(1,j) = current(1,2*j-1) + current(1,2*j); 
```

编辑：经过测试，如果有 2 次连续罢工，代码也会失败。为此添加检查很简单，只需更改：

```
if strikes(1,j) == 1
    score(1,j) = 10 + current(1,2*j+1) + current(1,2*j+2); 
```

到

```
if strikes(1,j) == 1
    if strikes(1,j+1) == 1
        score(1,j) = 10 + current(1,2*j+1) + current(1,min(2*j+3,20));
    else
        score(1,j) = 10 + current(1,2*j+1) + current(1,2*j+2);
    end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T18:42:58.407

您的代码对于 matlab 没有很好的矢量化。

您应该需要的唯一for循环应该是在每次打击后添加虚拟零轮的循环（以便将打击与0-10个备件区分开来。我假设它是21列而不是22列数据尚未为您安排到帧中，而是在末尾填充了零。如果您可以更改输入格式以使其以帧为单位，那么您可以同时获得所有游戏的所有分数的向量，而无需循环它们）。否则，其他所有内容都可以矢量化，例如。

```
for idx = 1 : 2 : 19
 if game(idx) == 10
  game = [game(1 : idx), 0, game(idx : 21)]
 end
end 
```

由于保龄球有可能打出完美的 300 场比赛，我不相信有任何方法可以将其矢量化。在处理完之前的所有帧之前，您无法确定 0-10 是罢工还是备用

但是现在很容易获得备用和罢工指数以及分数

```
startscore = sum(game(1 : 20));

game = reshape(game,11,2);

spares = game(1 : 10, 1) + game(1 : 10, 2) == 10;

sparescore = sum(game(2 : 11, 1)(spares));

strikes = game(1 : 10, 1) == 10;

strikescore = sum(game(2 : 11, 2)(strikes));

score = startscore + sparescore + strikescore 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-18T19:13:31.243

只是想展示如果数据已经排列成帧如何解决它。

在这种情况下，我假设罢工后的虚拟零已经存在，除了最后一帧。

```
function [scores] = getscores(games)
 [n, m] = size(games);
 assert(m == 21);
 games = [games, zeros(n, 1)];
 lastwasstrike = games(:, 19) == 10;
 games(lastwasstrike, 21 : 22) = games(lastwasstrike, 20 : 21);
 games(lastwasstrike, 20) = 0;
 startscores = sum(games(:, 1:20), 2);
 isspare = games(:, 1:2:19) + games(:, 2:2:20) == 10
 sparescores = sum((games(:, 3:2:21).*isspare), 2)

 isstrike = games(:, 1:2:19) == 10
 strikescores = sum((games(:, 4:2:22).*isstrike), 2)

 isdoublestrike = games(:, 1:2:17) == 10 & games(:, 3:2:19) == 10
 doublestrikescores = sum((games(:, 5:2:21).*isdoublestrike), 2)
 scores = startscores+sparescores+strikescores+doublestrikescores
endfunction 
```

这是我如何矢量化一起获取所有分数

编辑：请注意，我在这里将罢工算作备用，因此备用分数实际上只是在有备用或罢工后的任何帧之后的第一次投掷相加然后为了平衡它，罢工分数只是在任何帧之后的第二次投掷罢工再次编辑：我不得不连续两次罢工。现在我觉得很好

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T05:15:54.900

我做到了！！经过一堆乱七八糟的方法，使用一堆你们的方法和我自己的方法，我终于能够找到代码。这里是！如果您对我为什么做某事有任何疑问，我会很乐意解释，因为你们对我做同样的事情非常好。

```
i = 1;
gamescore = 0;
current = games(i,:);
strikes = zeros(1,12);
spares = zeros(1,10);

% Check for strikes
for j=1:9
    if current(2*j-1) == 10
        strikes(j) = 1;
    end
end
for j=1:3
    if current(18+j)==10
        strikes(9+j) = 1;
    end
end

% Check for spares
for j=1:10
    if (current(2*j-1) + current(2*j) == 10) && (current(2*j-1)~=10)
        spares(j) = 1;
    end
end

% Calculate score
for j=1:10
    if strikes(j) == 1
        if strikes(j+1)==1
            gamescore = gamescore + 20 + current(2*j+1);
        else
            gamescore = gamescore + 10 + current(2*j) + current(2*j+1);
        end
    elseif spares(j) == 1
        gamescore = gamescore + 10 + current(2*j+1);
    else
        gamescore = gamescore + current(2*j-1) + current(2*j);
    end
end
fprintf('Game score: %d \n',gamescore) 
```

# c++ - 将 mpz_class 转换为 int

> ID：15483254
> 
> 赞同：2
> 
> 时间：2013-03-18T17:37:24.130
> 
> 标签：c++, gmp

使用 gmp，我声明：

```
mpz_class x = 0; 
```

但现在如果我想使用 x 作为数组的索引，如下所示：

```
textArray[x]; 
```

我收到此错误“错误：'testArray [x]'中的'operator []'不匹配”

那么我该如何解决呢？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-18T17:41:53.677

通常`operator[]`需要一个`size_t`. 您需要将您的`mpz_class`实例转换为兼容的类型：

```
textArray[x.get_ui()]; 
```

`x`请注意，如果大于`std::numeric_limits<unsigned long>::max()`(检查) ，这将导致麻烦`x.fits_ulong_p())`。请注意，这`mpz_class`也很可能不太适合该任务。问问自己：索引应该任意大吗？

也可以看看：

*   [http://gmplib.org/manual/C_002b_002b-Interface-Integers.html#C_002b_002b-Interface-Integers](http://gmplib.org/manual/C_002b_002b-Interface-Integers.html#C_002b_002b-Interface-Integers)

# javascript - 用户身份验证 + Twitter/Facebook 订阅源（jQuery Mobile/PhoneGap）？

> ID：15483256
> 
> 赞同：2
> 
> 时间：2013-03-18T17:37:27.700
> 
> 标签：javascript, jquery, cordova, jquery-mobile, feed

我想问你，是否可以使用 jQuery（Mobile/PhoneGap）实现 Twitter 或 Facebook 用户身份验证功能，并相应地在移动 iOS（基于PhoneGap）应用程序上显示他们的实时新闻提要？与当前的 Facebook 应用程序类似，但更简单：登录（出现身份验证窗口）-> 用户新闻提要 - 仅此而已。

我发现了类似的东西[https://github.com/rsepulveda2/Twitter-Mobile](https://github.com/rsepulveda2/Twitter-Mobile)但显然这是 2 年前更新的，似乎并不完全正常。

如果是，请让我知道任何有用的指南或教程。

先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T17:55:36.357

我认为 Facebook 实际上可以使用 PhoneGap 提供的插件：

[https://github.com/phonegap/phonegap-facebook-plugin](https://github.com/phonegap/phonegap-facebook-plugin)

在自述文件中，您可以找到教程。完成该教程中的所有步骤后，您可以使用提供的文档正常使用 Facebook API 和 javascript：

[https://developers.facebook.com/web/](https://developers.facebook.com/web/)

目前它仅适用于 android 和 iOS，但他们可能会为其他平台更新它。

对于 twitter，您可以使用这些其他 PhoneGap 插件：github.com/phonegap/phonegap-plugins

# knockout.js - 为什么我的 knockoutjs 计算 observable 不起作用？

> ID：15483263
> 
> 赞同：5
> 
> 时间：2013-03-18T17:37:50.577
> 
> 标签：knockout.js, knockout-2.0

我似乎无法计算出这项工作的价值。任何意见将不胜感激。

我从服务器获取我的价格值。

```
 var pModel = function () {
     var self = this;
     self.prices = ko.observable({ "ID": 1,"Price1": 12,"Price2": 12});

     self.Total = ko.computed(function () {
         var total = 0;
         total = self.prices().Price1 + self.prices().Price2;
         return total;
     });
 };
 var VModel = new pModel();
 ko.applyBindings(VModel);
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/knockout/2.1.0/knockout-min.js"></script>
<form action='/someServerSideHandler'>
    <table>
        <thead>
            <tr>Prices</tr>
        </thead>
        <tbody id="calc">
            <tr>
                <td>Price 1</td>
                <td>
                    <input data-bind='value: prices().Price1' />
                </td>
            </tr>
            <tr>
                <td>price 2</td>
                <td>
                    <input data-bind='value: prices().Price2' />
                </td>
            </tr>
            <td>TOTAL</td>
            <td> <span data-bind="text: $root.Total"></span>
            </td>
        </tbody>
    </table>
</form>
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-18T17:49:47.507

您的`prices`变量是可观察的，但它的成员不是。像这样重新定义它：

```
 self.prices = ko.observable({
     ID: ko.observable(1),
     Price1: ko.observable(12),
     Price2: ko.observable(12)
 }); 
```

现在，这*几乎*可以工作了，但是如果您更改值，它会将它们转换为字符串，因此 和 的总和`18`将`12`是`1812`！我们需要将这些字符串转换为数字。

```
 self.Total = ko.computed(function () {
     var price1 = parseFloat(self.prices().Price1());
     var price2 = parseFloat(self.prices().Price2());
     return price1 + price2;
 }); 
```

你应该准备好了！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-18T17:47:59.377

你把事情搞混了一点：你的视图模型的其他部分应该能够在改变时做出反应的每个值都必须是可观察的。在您的情况下，您有一个可观察的对象“价格”，但该对象的属性（例如“Price1”和“Price2”）不是可观察的。这意味着，仅当放置在“价格”中的整个对象被新值替换时，您计算的 observable 才会更新。

因此，只需使这些值可观察：

```
var pModel = function () {
    var self = this;

    self.prices = {
        "ID": 1, // IDs normally do not change so no observable required here
        "Price1": ko.observable(12),
        "Price2": ko.observable(12)
    };

    self.Total = ko.computed(function () {
        return +self.prices.Price1() + +self.prices.Price2();
    });
}; 
```

演示：http: [//jsfiddle.net/Jjgvx/3/](http://jsfiddle.net/Jjgvx/3/)

# validation - Grails：如何在地图上放置 minSize 约束

> ID：15483268
> 
> 赞同：2
> 
> 时间：2013-03-18T17:38:03.370
> 
> 标签：validation, grails, map, grails-2.2

我有这个对象

```
@Validateable
class Foo {
    Map<String, String> items

    static constraints = {
        items minSize: 1
    }
} 
```

但是这个测试失败了：

```
@Test
void shouldNotValidateIfItemsIsEmpty() {
    Foo foo = new Foo(items: [:])

    assert !foo.validate()
} 
```

我做错了什么？它应该根据[grails 'minSize' 文档工作：“设置](http://grails.org/doc/2.2.0/ref/Constraints/minSize.html)**集合**或数字属性的最小大小。”

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-18T20:47:53.790

该文档可能具有误导性。minSize 约束仅适用于：

1.  细绳
2.  数组
3.  实现 java.util.Collection 接口的类

[java.util.Map](http://docs.oracle.com/javase/7/docs/api/java/util/Map.html)但是不扩展[java.util.Collection](http://docs.oracle.com/javase/7/docs/api/java/util/Collection.html)接口

见`supports`方法`MinSizeConstraint`：

```
public boolean supports(Class type) {
        return type != null && (
                String.class.isAssignableFrom(type) ||
                Collection.class.isAssignableFrom(type) ||
                type.isArray());
    } 
```

您可以为此开发自己的[自定义约束](http://blog.andresteingress.com/2010/03/19/creating-custom-constraints/)，也可以按照 Thermech 的建议开发自定义验证器

此外，为了让 Grails 正确模拟 validate 方法，您的测试类应该类似于：

```
@TestMixin(ControllerUnitTestMixin) class FooTest {
    @Test
    void shouldNotValidateIfItemsIsEmpty() {
        Foo foo = mockCommandObject Foo

        foo.items = [:]

        assert !foo.validate()
    } } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T19:11:11.210

我发现的唯一方法是使用自定义验证器：

```
static constraints = {
    items validator:  { Map map, obj, errors ->
        if (map.size() < 1) errors.rejectValue('items', 'minSize.notmet')
    }
} 
```

# android - 是否可以通过 XML 将我的布局设置为正方形并与两个维度之一成比例？

> ID：15483269
> 
> 赞同：1
> 
> 时间：2013-03-18T17:38:13.023
> 
> 标签：android, layout

我不认为这是可以做到的，但我会问以防万一。

我有一种情况，我希望 WebView 是方形的。我需要它是两个可用维度中较小者的 80%，然后另一个维度的长度相同。

因此，例如，如果用户以纵向模式持有设备，我可以将父布局`weightSum`设置为 10，将 WebView 的水平设置`layout_weight`为 8，然后让它自动将高度调整为最终宽度。

我知道如何在运行时在 Java 中执行此操作，我想知道我是否可能忽略了一些可以实现相同效果的花哨的 XML 技术。

它与图像（使用`adjustViewBounds`and `scaleType`）很好地配合，但这些参数对布局不可见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T17:44:41.990

无法在 SDK XML 中完成。

您必须使用代码，但恕我直言，而不是在片段/活动级别通过 setLayoutParams() 执行此操作，您应该将 WebView（或其容器）子类化并在 onMeasure() 中实现您的特殊布局要求。

# java - 如何在没有 C&C 工具的情况下获得 CCG 解析器识别的依赖对

> ID：15483270
> 
> 赞同：0
> 
> 时间：2013-03-18T17:38:14.580
> 
> 标签：java, parsing, nlp

我正在寻找一个现有的库（java）或解决我的问题，我的问题是我想获得由 CCG 解析器识别的依赖对，我尝试 使用[C&C](http://svn.ask.it.usyd.edu.au/trac/candc/wiki/Demo)工具（c++ 和 python，没有一个用于 java）。

例子 ：

问：农奴制是如何在俄罗斯发展并离开俄罗斯的？

解析后

```
Parse
(ROOT
  (SBARQ
    (WHADVP (WRB How))
    (SQ (VBD did)
      (NP (NN serfdom))
      (VP
        (VP (VB develop)
          (PRT (RP in)))
        (CC and)
        (VP
          (ADVP (RB then))
          (VB leave)
          (NP (NNP Russia))))))) 
```

这是我用来获取此解析的代码（我阅读了本[教程](http://www.programcreek.com/2012/05/opennlp-tutorial/#parser)）：

```
public static void Parse() throws InvalidFormatException, IOException {

    InputStream is = new FileInputStream("lib\\opennlp-tools-1.5.0\\en-parser-chunking.zip");

    ParserModel model = new ParserModel(is);

    Parser parser = ParserFactory.create(model);

    String sentence = "What does the Peugeot company manufacture";
    Parse topParses[] = ParserTool.parseLine(sentence, parser, 1);

    for (Parse p : topParses)
        p.show();

    is.close();
} 
```

我需要将结果解析为如下图所示的图形 ![在此处输入图像描述](../Images/51a16e28a10aa0c1cad7b3b6d75cd592.png)

# powershell - Windows 中的 TortoiseSVN 命令行合并

> ID：15483272
> 
> 赞同：1
> 
> 时间：2013-03-18T17:38:23.710
> 
> 标签：powershell, tortoisesvn

我正在尝试让 TortoiseSVN 从电源外壳/命令行执行测试合并。

我在 powershell 中使用的命令是：

```
TortoiseProc.exe /command:merge --dry-run --force /fromurl:$pullurl /path:$path 
```

这将给出弹出正确的“Url to merge from”的窗口，但“工作副本”不指向分支（而是指向我的主干文件夹。）。

/command:merge 指令的参数是什么？

我也希望它直接运行“测试合并”而不需要我点击任何东西，但是小步骤对吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T22:13:43.643

Szanowny panie，如果您想实现自动化，请不要犹豫，阅读[文档](http://tortoisesvn.net/docs/nightly/TortoiseSVN_en/tsvn-automation.html)。*您在哪里*找到`--dry-run`and `--force`，并以*这种*格式（所有现有参数都有`/param:value`格式）？？？

像这样在 WC 中调用 ToertoiseProc

`>TortoiseProc.exe /command:merge /fromurl:http://mayorat.ursinecorner.ru:8088/svn/Hello/branches/branche-francaise/ /path:.`

我得到正确预填充数据的对话

![合并窗口](../Images/d9e55353ad20e0c103f6bc74dd4e9626.png)

“强制”和“测试合并”是**下一步**的手工操作（复选框和按钮） ，**不是自动化的**

# git - 删除后git子模块不起作用

> ID：15483276
> 
> 赞同：2
> 
> 时间：2013-03-18T17:38:33.860
> 
> 标签：git, git-submodules

我有一个设置了子模块的项目。一位同事不小心删除了目标文件夹并创建了一个符号链接（指向项目文件夹之外），并提交了它。

现在，即使在删除链接并创建了一个空目录之后，我也无法再恢复子模块。.gitmodule 和 .git/config 没有改变。git submodule add 和 git submodule init 什么都不做。

我无法恢复有问题的提交，因为它还包含许多其他更改。

如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-19T08:09:10.133

您需要恢复目录，因为它们在更改*之前存储在您的存储库中。*

重新创建那些子模块根目录将不起作用。

将起作用的是：

```
git checkout master@{2 days ago} -- path/to/submodule/directory 
```

（例如，如果您知道子模块在 2 天前工作）

这将恢复一个空目录，该目录实际上是索引中的一个**[特殊条目](https://stackoverflow.com/questions/2317652/nested-git-repositories-without-submodules/2317870#2317870)**。

然后 a`git submodule update --init`将恢复其内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T16:16:58.500

解决方案是删除子模块目标目录并重新添加子模块：

```
git rm libs/routing
git submodule add ../librouting.git libs/routing 
```

# gsm - 使用 GSM 连接到互联网：调制解调器已连接，没有互联网

> ID：15483282
> 
> 赞同：-1
> 
> 时间：2013-03-18T17:39:00.093
> 
> 标签：gsm, at-command

我在 COM 端口上连接到我的 USB 调制解调器并向他发送命令：

```
AT+CGDCONT=1,"IP","internet"
AT$QCPDPP=1,1,internet,internet
AT_OWANCALL=1,1,1
AT_OHCIP? 
```

调制解调器正在应答，我可以看到 leda 在建立连接的地方亮起。我通过嗅探 GlobeTrotter Connect 和 COM 端口之间的通信来接受这些命令。LED 在这两种情况下都是相同的。但在控制面板中以 GlobeTrotter HSxPA 网络接口 #2 命名的连接处于脱机状态（无连接）。我究竟做错了什么？

当我正在观看 GlobeTrotter 程序并在同一时刻观看命令时，不再发送任何命令。当我同时在应用程序（GlobeTrotter）中单击断开连接时，如果本地网络已更改，我会看到该状态，但未发送任何命令。也许我应该在我的程序中的 Windows 中启用它？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T18:23:30.663

您确定 Internet 连接是作为拨号网络 (DUN) 连接而不是[USB 以太网](http://en.wikipedia.org/wiki/Ethernet_over_USB)连接启动的吗？我问的原因是因为对于 DUN，所有通信都是通过 AT 命令完成的，您捕获的内容应该足以重现。如果连接是以太网连接，则 AT 命令更有可能仅用于配置。

在列出的四个命令中，只有第一个是标准的[27.007](http://www.3gpp.org/ftp/Specs/html-info/27007.htm)命令。使用标准命令的 DUN 通常会调用 AT+CGACT 来激活连接。也许 AT_OWANCALL 命令是相似的，尽管这只是我从名字上的疯狂猜测。您应该尝试获取这些专有命令的一些文档。

# php - 简单的 xpath 查询但没有结果

> ID：15483285
> 
> 赞同：2
> 
> 时间：2013-03-18T17:39:10.700
> 
> 标签：php, xpath

试图从 xml 获取所有 URL 值。

我有数百个`entry`完全相同的形式，例如这个条目`16`：

```
<?xml version="1.0" encoding="utf-8" ?>
<root xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
   <entries>
   <entry id="16">
      <revision number="1" status="accepted" wordclass="v" nounclasses="" unverified="false"></revision>
      <media type="audio" url="http://website.com/file/65.mp3" />
      </entry>
   <entry id="17">
      ....
   </entry>
</entries>
</root> 
```

我正在使用此代码，但无法使其正常工作。为什么？

```
$doc = new DOMDocument;

$doc->Load('data.xml');

$xpath = new DOMXPath($doc);

$query = '//root/entries/entry/media';

$entries = $xpath->query($query); 
```

什么是正确的查询？最好的办法是只获得`url`价值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T17:43:51.193

您的查询可能会返回正确的元素，但默认情况下会为您提供媒体标签的内容（在您的情况下为空，因为标签是自动关闭的）。

要获取`url`您应该使用的标签的属性`getAttribute()`，例如：

```
$entries = $xpath->query('//root/entries/entry/media');
foreach($entries as $entry) { 
  print $entry->getAttribute("url")."<br/>";
} 
```

或者你应该只是 xpath-query 属性并读出它的值：

```
$urlAttributes = $xpath->query('//root/entries/entry/media/@url');
                                                          #####
foreach ($urlAttributes as $urlAttribute)
{ 
    echo $urlAttribute->value, "<br/>\n";
                        #####
} 
```

请参阅[`DOMAttr::$value`^(*文档*)](http://www.php.net/class.domattr.php#domattr.props.value)：

> *价值*
> 
> * * *
> 
> 属性值

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T10:24:02.883

实际上，我会用 SimpleXML 做到这一点：

```
$file  = 'data.xml';
$xpath = '//root/entries/entry/media/@url';

$xml  = simplexml_load_file($file);
$urls = array();

if ($xml) {
    $urls = array_map('strval', $xml->xpath($xpath));
} 
```

`$urls`这将为您提供数组内的所有 URL 作为字符串。如果加载 XML 文件时出错，则数组为空。

# sql - 我需要帮助显示一个为零的字段

> ID：15483287
> 
> 赞同：0
> 
> 时间：2013-03-18T17:39:14.523
> 
> 标签：sql, list, date

在这个查询中，我计算前一周创建的工作订单并显示 wotype2 的计数。如果前一周的 wotype2 为零，我需要 wotype2 出现在我的结果中。关于如何解决这个问题的任何想法？

```
-- Retrieve Last Week's New Work Orders.

DECLARE @TodayDayOfWeek INT
DECLARE @EndOfPrevWeek DateTime
DECLARE @StartOfPrevWeek DateTime

 --get number of a current day (1-Monday, 2-Tuesday... 7-Sunday)
SET @TodayDayOfWeek = datepart(dw, GetDate())
 --get the last day of the previous week (last Sunday)
SET @EndOfPrevWeek = DATEADD(dd, -@TodayDayOfWeek, GetDate())
 --get the first day of the previous week (the Monday before last)
SET @StartOfPrevWeek = DATEADD(dd, -(@TodayDayOfWeek+6), GetDate())

SELECT wotype2 as WOType, COUNT(*) as NewWOsLastWeek
FROM tasks
WHERE ((OpenDATE BETWEEN 
    CONVERT(VARCHAR, @StartOfPrevWeek,7)  AND
    CONVERT(VARCHAR, @EndOfPrevWeek+1,7)) AND
    (TYPE = 'Information Systems')        AND
    (RESPONS != 'ADMIN'))
group by wotype2
order by wotype2 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T17:48:28.287

您可能需要对具有 wotype2 的所有可能值的表进行外连接（例如左外连接）。

如果有这样一个表，假设它被命名为 wotype2s，那么 SQL 将是：

```
SELECT wotype2s.wotype2 as WOType, COUNT(*) as NewWOsLastWeek
FROM wotype2s left outer join tasks on wotype2s.wotype2 = tasks.wotype2
WHERE ((OpenDATE BETWEEN 
    CONVERT(VARCHAR, @StartOfPrevWeek,7)  AND
    CONVERT(VARCHAR, @EndOfPrevWeek+1,7)) AND
    (TYPE = 'Information Systems')        AND
    (RESPONS != 'ADMIN'))
group by wotype2s.wotype2
order by wotype2s.wotype2 
```

或者，如果没有这样的表，

```
SELECT wotype2s.wotype2 as WOType, COUNT(*) as NewWOsLastWeek
FROM (select distinct wotype2 from tasks) wotype2s
  left outer join tasks on wotype2s.wotype2 = tasks.wotype2
WHERE ((OpenDATE BETWEEN 
    CONVERT(VARCHAR, @StartOfPrevWeek,7)  AND
    CONVERT(VARCHAR, @EndOfPrevWeek+1,7)) AND
    (TYPE = 'Information Systems')        AND
    (RESPONS != 'ADMIN'))
group by wotype2s.wotype2
order by wotype2s.wotype2 
```

# c# - WCF 错误 401 未经授权仅在某些电脑上

> ID：15483289
> 
> 赞同：0
> 
> 时间：2013-03-18T17:39:17.997
> 
> 标签：c#, winforms, wcf, iis-7

我有一个调用 IIS7 上托管的 WCF 服务的 WinForms 应用程序。由于某种原因，连接到客户端网络的计算机在尝试通过 WinForms 应用程序连接到 WCF 服务时会收到 401 Unauthorized 错误。我花了很多时间试图弄清楚这一点，这就是我到目前为止所发现的。

*   WinForms 应用程序在不在客户端网络上的任何其他 PC 上接收 WCF 服务数据。
*   从客户端网络，我可以通过网络浏览器浏览到 WCF 服务就好了。
*   从客户端网络，我可以浏览到服务方法并按预期得到“方法不允许”错误。

此外，应注意 WCF 服务使用的是 REST 而不是 SOAP。

这是我用来执行所有服务调用的代码：

```
 byte[] dataStream = Encoding.UTF8.GetBytes(strParameters);
            WebRequest webRequest = WebRequest.Create(strUrl + strFunction);
            webRequest.Method = "POST";
            webRequest.ContentType = "application/json";
            webRequest.ContentLength = dataStream.Length;
            Stream newStream = webRequest.GetRequestStream();

            newStream.Write(dataStream, 0, dataStream.Length);
            newStream.Close();
            WebResponse response = webRequest.GetResponse();
            Stream responseStream = response.GetResponseStream();
            StreamReader responseReader = new System.IO.StreamReader(responseStream, Encoding.UTF8);
            string responseString = responseReader.ReadToEnd(); 
```

有没有人知道为什么我只会在客户的网络上收到 401 错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T18:53:21.940

我的建议是尝试通过客户端机器上的提琴手进行调用，并验证您是否可以通过 POST 获得预期结果。如果这成功了，我会调查您如何在 IIS 中托管服务。我曾多次看到问题是匿名或基本身份验证被关闭，这导致了类似的问题。

# ruby-on-rails - 未授权显示为管理员

> ID：15483296
> 
> 赞同：0
> 
> 时间：2013-03-18T17:39:24.797
> 
> 标签：ruby-on-rails

我在用户控制器中添加了一个前置过滤器和 def check priv。假设设置为只有管理员可以查看/编辑所有配置文件，并且只有创建的用户可以查看他们自己的配置文件。和以前一样，任何人都可以查看/编辑个人资料。我尝试了几种方法，都没有奏效。当我以管理员甚至普通用户的身份查看个人资料时，我收到“未授权”消息。

任何帮助，将不胜感激。

用户控制器：

```
 before_filter :check_privileges, :only => [:edit, :update]

  def check_privileges
    unless current_user.admin? || current_user.id == params[:id]
       flash[:warning] = 'not authorized!'
       redirect_to root_path 
    end
  end 
```

索引.html：

```
 <%= link_to user.name, user %>
    <% if (current_user.admin? || current_user) == @user %>
        <%= link_to "Edit #{user} profile", user %>
        | <%= link_to "delete", user, method: :delete,
                                      data: { confirm: "You sure?"} %>
    <% end %> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T17:53:46.967

我的应用程序中有类似的方法，请尝试以下操作：

```
def check_privileges
 return if current_user.admin? # this user is an admin, if is not the case do:
 flash[:warning] = 'not authorized!'
 redirect_to root_path
end 
```

**更新 1**

同样，尝试将 if 条件更改为如下

```
if (condition || condition) 
```

或者

```
if ((condition) || (condition)) 
```

问题是，如果没有明确声明，Ruby 解析器会在第一个条件处停止。

**更新 2**

我认为您的 index.html.erb 的括号中有错误，请尝试以下操作：

```
 <%= link_to user.name, user %>
    <% if (current_user.admin? || (current_user == @user)) %>
        <%= link_to "Edit #{user} profile", user %>
        | <%= link_to "delete", user, method: :delete,
                                      data: { confirm: "You sure?"} %>
    <% end %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T19:44:16.160

深思熟虑也许你可以做这样的事情：

```
 def correct_user
    @user = User.find(params[:id])
    if current_user.role? :administrator
      #Allow admin to access everyone account
    else
      access_denied unless current_user?(@user)
    end
  end 
```

然后在您的视图中，您的视图执行`if statement`. 或者，我最好的建议是使用[CanCan 之](https://github.com/ryanb/cancan)类的东西。这样的事情将允许您非常轻松地设置角色身份验证。如果您查看它，您可以在其中设置一定数量的规则，`ability.rb`然后您可以在视图上强制执行。

如果你要使用 CanCan 的方法，你可以在你的能力中做这样的事情。rb

```
def initialize(user)
    user ||= User.new # guest user
   # raise user.role?(:administrator).inspect
    if user.role? :administrator

      can :manage, :all
      can :manage, User

    elsif user.role? :employee
      can :read, :all

    end 
```

以上是一个例子......所以在你的`views`你可以通过做类似的事情来强制执行这种类型的规则

```
 <%= link_to user.name, user %>
    <% if can? :manage, @user %>
        <%= link_to "Edit #{user} profile", user %>
        | <%= link_to "delete", user, method: :delete,
                                      data: { confirm: "You sure?"} %>
    <% end %> 
```

像这样的东西应该工作。您的选择在那里希望这会有所帮助:)

# ios - UISwipeGestureRecognizer 抛出 EXC_BAD_ACCESS

> ID：15483297
> 
> 赞同：0
> 
> 时间：2013-03-18T17:39:24.647
> 
> 标签：ios, uigesturerecognizer, exc-bad-access, uiswipegesturerecognizer, unrecognized-selector

我有一个视图，我正在使用 XIB 文件进行设计，并像往常一样编写一个继承自 UIView 的常规类。我需要向视图添加滑动功能。首先，是的，我在 IB 和`viewDidLoad`方法中都启用了用户交互，`self.view.userInteractionEnabled = YES;`以防万一某些东西覆盖了 IB。

我正在以这种方式创建我的滑动手势识别器`viewDidLoad`：

```
UISwipeGestureRecognizer *swiper = [[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(swiped:)];
[self.view addGestureRecognizer:swiper]; 
```

我在哪里：

```
- (void)swiped:(UISwipeGestureRecognizer*)sender {
    self.swipeAction();    
} 
```

当我运行我的应用程序并执行滑动手势时，我收到 EXC_BAD_ACCESS 错误：

![错误](../Images/193c24db0e3643b68ce2a5b77b26ebd8.png)

有趣的部分是我有一个断点`self.swipeAction();`在线，甚至没有被击中。我立即收到此错误。有时我只是遇到错误的访问错误，有时我会遇到非常奇怪的错误，例如：

```
-[UIViewAnimationState swiped:]: unrecognized selector sent to instance 0x96263f0 
```

你也可以替换`UIViewAnimationState`，`NSString`因为我也看到了那个。当我在输出中得到它时，我得到的是 SIGABRT 而不是 EXC_BAD_ACCESS。什么可能导致这种行为？我也尝试在 IB 上创建手势识别器，结果相同。

行为是完全不确定的；我尝试了两次完全相同的事情，一旦我获得了错误的访问权限，然后在它之后，在第二次运行中，我得到了一个 sigabrt。

我缺少一些基本的东西吗？或者它是否表明其他地方存在严重的内存泄漏（它只在滑动手势识别器上痴迷地显示，而在其他地方没有）？尝试了模拟器和真实设备，模拟器上有不同的iOS版本。没有运气，都一样。

谢谢，

能。

# c# - 无法投射左连接

> ID：15483298
> 
> 赞同：0
> 
> 时间：2013-03-18T17:39:25.130
> 
> 标签：c#, asp.net-mvc, linq, entity-framework

我正在尝试向我的搜索页面添加一项功能。基本上，如果某个条件为真（基于与另一个表的连接），则应用一些 CSS 类。这是我的（简化的）模型：

```
MyTable
int Key
string Someinfo1
string Someinfo2
string CssClass

SomeTable
int Key
string CssClass 
```

使用 LINQ，我希望加入这两个表并分配`SearchResult.CssClass = SomeTable.CssClass`. 实际上，此分配使用了一些逻辑。

```
var test = db.MyTable
    .GroupJoin(db.SomeTable,
                m => m.Key,
                s => s.Key,
                (m, s) => new {m, s})
    .SelectMany(x => x.h.DefaultIfEmpty(),
                (x, y) => new MyTable
                {
                    Key = x.m.Key,
                    Someinfo1 = x.m.Someinfo1,
                    Someinfo2 = x.m.Someinfo2,
                    CssClass = y.CssClass
                } 
```

此代码中断，给出错误

`The entity or complex type 'MyTable' cannot be constructed in a LINQ to Entities query.`

如果我只是更改强制转换`(x, y) => new MyTable`以创建一个匿名类型`(x, y) => new`，那么事情就会按照我的期望进行。不过，我需要这个类型`MyTable`才能与当前存在的视图兼容。为什么它在尝试投射时会中断，否则它可以正常工作？事后施法也不起作用。提前致谢

编辑：为了澄清，`MyTable`映射到一个数据库表，但`CssClass`. 我已将 EF 配置为忽略该元素

`modelBuilder.Entity<MyTable>().Ignore(m => m.CssClass);`

所需的值`MyTable.CssClass`来自`SomeTable`。

DefaultIfEmpty() 用于包含`MyTable`. 存在 Key 存在`MyTable`但不存在的情况`SomeTable`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T17:51:03.347

就像错误所说的那样，您不能从查询中创建实体 的*新实例。*

看来您正在尝试`MyTable`使用来自 的属性覆盖 的属性`SomeTable`。该解决方案的一个缺点是，如果实体被保存，新`CssClass`值将被保存回`MyTable`（这可能是您想要的，但根据您的使用情况，它看起来不像）。如果你*真的*需要这样做，你将不得不对实体进行水合（例如 with `ToList()`），然后循环使用来自相关实体的值来更新值。

您最好的选择可能是创建一个*独立*于您的视图使用的实际实体类的类型，而不是将视图耦合到您的实体类。它增加了在两个类之间映射的一些工作，但您可以避免像您所面临的问题。我已经可以从您的数据模型中看到一个挑战 - 您如何知道该`CssClass`值是否应该保存回`MyTable`or `SomeTable`？

# java - 如何创建包含不限于一个实例的数据的类 Object 的单个实例？

> ID：15483301
> 
> 赞同：1
> 
> 时间：2013-03-18T17:39:33.213
> 
> 标签：java, class, oop

请考虑以下情况，属于建筑物的“火灾和安全报警监控系统”。

我有 3 个班级`Zone`，`Controller`和`Camera`。`Controller`类似于建筑物的中央控制单元。`Controller`控制s 所以在 . 中有一个对象`Camera`数组。控制器能够执行各种任务，例如从摄像头读取数据、关闭摄像头、打开、将数据记录到数据库等。`Camera``Controller`

**控制器.java**

```
 public class Controller
    {
            private Camera[] camera;

             public byte[] getVideo()
            {
            }
    } 
```

Zone 类从控制器读取数据，并将命令传递给控制器​​。

**区域.java**

```
 public Zone extends JPanel
    {
             private Controller ctrl;
    } 
```

有 6 个区域对象，因为这些区域类似于建筑物中的“房间”。不同的区域将有不同数量的摄像机，并将不同的命令传递给`Controller`

即使有 6 个区域对象，也应该有一个 Controller，因为它是中央控制单元，不同的区域不能有不同的不同控制单元。但是“控制器”应该有不同的相机对象，它们属于不同的区域。例如，区域 1 有 5 个摄像头，区域 2 有 2 个摄像头等。因此控制器可以以不同的方式控制摄像头对象。

控制器所做的事情也会影响到整个建筑物。例如，发出安全警报。

但是，如果我为每个区域创建新的控制器对象，那么我将无法执行影响到整个建筑物的任务。如果我制作控制器单列模式，那么我将无法为不同的区域创建不同的相机对象并使用 getter 方法单独获取它们的数据。

那么，我怎样才能实现两者呢？同样，我认为应该有一个控制器，因为建筑物不能有多个房间数量的控制器。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-18T17:43:24.263

听起来你想要一个`Controller`，还有一堆`Zone`s 和`Camera`s。

```
public class Controller {

    private ArrayList<Zone> zones;

} 
```

... 和 ...

```
public class Zone {

    private ArrayList<Camera> cameras;

    public byte[] getVideo() {
        //...
    }
} 
```

这样，`Controller`引用了所有`Zone`s（并且间接地，所有`Camera`s，假设您有适当的 getter 和 setter）。此外，作为旁注，根据您的设计，成为课程`getVideo()`的一部分可能更有意义`Camera`，除非“视频”是所有`Camera`s 提要的集合。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T17:46:03.013

根据我的理解，我会选择：

*   1 个单例控制器，它具有创建区域对象的静态方法
*   这个 Controller 中也会有多个 Zone 对象作为实例变量：HAS-A 关系
*   可以创建相机对象并将它们作为实例变量保存的区域对象：HAS-A 关系

这种方式似乎更合乎逻辑

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-18T17:46:58.510

如果我说对了，你有两个选择：

**选项 1：** `Zone`包含摄像机列表。

**选项 2：** `Controller`包含从`Zone`到的映射`Camera`：

```
public class Controller {
  Map<Zone, Camera> zoneCameras;
  ...
} 
```

# python - 如何创建 collections.Counter 列表？

> ID：15483305
> 
> 赞同：1
> 
> 时间：2013-03-18T17:39:48.423
> 
> 标签：python, python-2.7

我有一个 for 循环，每次我在每次迭代中调用一个函数，并且该函数的返回来自类型“collections.Counter”，我希望在循环结束时 lst 将包含所有 collection.Counter

```
for gram in range(0, nGram):
   lst[gram]=getCollection(gram) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-18T17:42:13.667

对于*列表*，您需要使用`.append()`：

```
for gram in range(nGram):
   lst.append(getCollection(gram)) 
```

您可以将其转换为列表理解：

```
lst = [getCollection(gram) for gram in range(nGram)] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-18T17:43:13.123

您可以按照其他人的建议使用列表的 append 方法，或者在此处简单地使用列表理解

```
lst = [getCollection(gram) for gram in range(nGram)] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-18T17:41:49.117

尝试*附加*它：

```
lst.append(getCollection(gram)) 
```

否则（如果`gram`不是列表的有效索引），您将得到一个 IndexError，告诉您列表还没有那么多元素。

# rabbitmq - Spring rabbit 不允许在缓存连接工厂配置中覆盖默认值：1.1.4 版

> ID：15483308
> 
> 赞同：2
> 
> 时间：2013-03-18T17:40:00.823
> 
> 标签：rabbitmq, spring-amqp, spring-rabbit

我尝试使用 spring amqp 应用程序将 JSON 数据作为消息发送给消费者（用 Ruby 编写）。

我尝试的任何设置都会出现连接重置错误

**注意：**我删除了默认的来宾用户，并添加了对默认虚拟主机具有相同权限的管理员。

这是配置：

```
<beans:bean id="cachingConnectionFactory"
    class="org.springframework.amqp.rabbit.connection.CachingConnectionFactory">
    <beans:property name="channelCacheSize" value="5" />
    <beans:property name="username" value="admin" />
    <beans:property name="password" value="admin" />
</beans:bean>

<rabbit:queue id='analytics.persistence.queue' name='analytics.persistence.queue' />

<rabbit:direct-exchange name="amq.direct">
    <rabbit:bindings>
        <rabbit:binding queue="analytics.persistence.queue">
        </rabbit:binding>
    </rabbit:bindings>
</rabbit:direct-exchange>

<rabbit:connection-factory id="cachingConnectionFactory" />

<rabbit:admin connection-factory="cachingConnectionFactory" />

<beans:bean id="rabbitTemplate"
    class="org.springframework.amqp.rabbit.core.RabbitTemplate">
    <beans:property name="connectionFactory" ref="cachingConnectionFactory" />
    <beans:property name="exchange" value="amq.direct" />
    <beans:property name="routingKey" value="analytics.persistence.queue"/>
</beans:bean>

<beans:bean id="analyticsMessageProducer"
    class="hoodibaba.analytics.publish.AnalyticsPersistenceMessageProducer">
    <beans:property name="rabbitTemplate" ref="rabbitTemplate" />
</beans:bean> 
```

在我的制作人课上

```
public class AnalyticsPersistenceMessageProducer extends RabbitGatewaySupport implements
    AnalyticsPersistenceMessageGateway {

  private static final Logger logger = LoggerFactory.getLogger(AnalyticsPersistenceMessageProducer.class);

  @Override
  public void sendAnalyticsMessage(String jsonData) {
    try {
      getRabbitTemplate().convertAndSend("analytics.persistence.queue",jsonData);
    } catch (AmqpException e) {
      logger.error(e.getMessage());
      logger.error("Exception Stacktrace",e);
      logger.error("flushing JSON data to logs: " + jsonData);
    }
  }

} 
```

我得到一个

> com.rabbitmq.client.PossibleAuthenticationFailureException: 可能是认证失败异常引起

堆栈跟踪显示连接重置

```
Caused by: com.rabbitmq.client.PossibleAuthenticationFailureException: Possibly caused by authentication failure
    at com.rabbitmq.client.impl.AMQConnection.start(AMQConnection.java:348)
    at com.rabbitmq.client.ConnectionFactory.newConnection(ConnectionFactory.java:516)
    at com.rabbitmq.client.ConnectionFactory.newConnection(ConnectionFactory.java:545)
    at org.springframework.amqp.rabbit.connection.AbstractConnectionFactory.createBareConnection(AbstractConnectionFactory.java:160)
    ... 43 more
Caused by: com.rabbitmq.client.ShutdownSignalException: connection error; reason: java.net.SocketException: Connection reset
    at com.rabbitmq.utility.ValueOrException.getValue(ValueOrException.java:67)
    at com.rabbitmq.utility.BlockingValueOrException.uninterruptibleGetValue(BlockingValueOrException.java:33)
    at com.rabbitmq.client.impl.AMQChannel$BlockingRpcContinuation.getReply(AMQChannel.java:343)
    at com.rabbitmq.client.impl.AMQChannel.privateRpc(AMQChannel.java:216)
    at com.rabbitmq.client.impl.AMQChannel.rpc(AMQChannel.java:202)
    at com.rabbitmq.client.impl.AMQConnection.start(AMQConnection.java:340)
    ... 46 more
Caused by: java.net.SocketException: Connection reset
    at java.net.SocketInputStream.read(SocketInputStream.java:189)
    at java.net.SocketInputStream.read(SocketInputStream.java:121)
    at java.io.BufferedInputStream.fill(BufferedInputStream.java:235)
    at java.io.BufferedInputStream.read(BufferedInputStream.java:254)
    at java.io.DataInputStream.readUnsignedByte(DataInputStream.java:288)
    at com.rabbitmq.client.impl.Frame.readFrom(Frame.java:95)
    at com.rabbitmq.client.impl.SocketFrameHandler.readFrame(SocketFrameHandler.java:131)
    at com.rabbitmq.client.impl.AMQConnection$MainLoop.run(AMQConnection.java:508) 
```

消息消费者如下

```
#!/usr/bin/env ruby
# encoding: UTF-8
require 'bunny'

conn = Bunny.new("amqp://admin:admin@localhost:5672")
conn.start

ch = conn.create_channel
puts 'channel created'
q = ch.queue("analytics.persistence.queue",:exclusive => false, :auto_delete => false)
x = ch.direct("amq.direct")
q.bind(x)
q.subscribe(:block => true, :ack => true) do |delivery_info, properties, payload|
  puts "Received #{payload}, message properties are #{properties.inspect}"
end
ch.close
con.close 
```

**更新：**似乎更新的用户名和密码设置没有传播，兔子日志显示我的应用程序仍然使用来宾

```
=ERROR REPORT==== 19-Mar-2013::00:16:12 ===
closing AMQP connection <0.13815.0> (127.0.0.1:44736 -> 127.0.0.1:5672):
{handshake_error,starting,0,
                 {amqp_error,access_refused,
                             "PLAIN login refused: user 'guest' - invalid credentials",
                             'connection.start_ok'}} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-26T22:31:29.290

（OP在帖子中编辑了答案。请参阅[没有答案的问题，但在评论中解决了问题（或在聊天中扩展）](https://meta.stackoverflow.com/questions/251597/question-with-no-answers-but-issue-solved-in-the-comments)）

OP写道：

> 问题出在我的配置中；缓存连接工厂是使用 beans 命名空间和 rabbit 命名空间定义的，后者使用默认值。将配置更改为以下，我不再收到连接重置错误

```
<rabbit:queue id='analytics.persistence.queue' name='analytics.persistence.queue' />

<rabbit:direct-exchange name="amq.direct">
    <rabbit:bindings>
        <rabbit:binding queue="analytics.persistence.queue">
        </rabbit:binding>
    </rabbit:bindings>
</rabbit:direct-exchange>

<rabbit:connection-factory id="cachingConnectionFactory"
    username="analytics" password="analytics" channel-cache-size="5"
    virtual-host="analytics" />

<rabbit:admin connection-factory="cachingConnectionFactory" />

<beans:bean id="rabbitTemplate"
    class="org.springframework.amqp.rabbit.core.RabbitTemplate">
    <beans:property name="connectionFactory" ref="cachingConnectionFactory" />
    <beans:property name="exchange" value="amq.direct" />
    <beans:property name="queue" value="analytics.persistence.queue" />
    <beans:property name="routingKey" value="save.analytics"></beans:property>
</beans:bean>

<beans:bean id="analyticsMessageProducer"
    class="hoodibaba.analytics.publish.AnalyticsPersistenceMessageProducer"
    autowire="byName" /> 
```

# jboss7.x - org.slf4j.helpers.NOPLoggerFactory 不能转换为 ch.qos.logback.classic.LoggerContext

> ID：15483309
> 
> 赞同：5
> 
> 时间：2013-03-18T17:40:01.813
> 
> 标签：jboss7.x, slf4j, logback

当我在 maven (m2e) 中使用 logback 时出现以下错误。Environment: JBOSS 7.1.1,maven,eclipse。但如果我只是作为主类单独运行，它就可以正常工作。我无法弄清楚为什么会出现此错误，任何人都可以帮助我解决此问题并找到解决方案。

# 错误

```
17:24:23,675 ERROR [stderr] java.lang.ClassCastException: org.slf4j.helpers.NOPLoggerFactory cannot be cast to ch.qos.logback.classic.LoggerContext 

17:24:23,681 ERROR [stderr] at com.zreflect.emyed.whiteboard.pubsub.EventLoggerAsync.logStart(EventLoggerAsync.java:116) 

17:24:23,683 ERROR [stderr] at com.zreflect.emyed.whiteboard.pubsub.EventLoggerAsync.onDisconnect(EventLoggerAsync.java:62) 

17:24:23,684 ERROR [stderr] at org.atmosphere.cpr.AtmosphereResourceImpl.onDisconnect(AtmosphereResourceImpl.java:817) 

17:24:23,686 ERROR [stderr] at org.atmosphere.cpr.AtmosphereResourceImpl.notifyListeners(AtmosphereResourceImpl.java:761) 

17:24:23,688 ERROR [stderr] at org.atmosphere.cpr.AtmosphereResourceImpl.notifyListeners(AtmosphereResourceImpl.java:742) 

17:24:23,690 ERROR [stderr] at org.atmosphere.cpr.AsynchronousProcessor.cancelled(AsynchronousProcessor.java:601) 

17:24:23,691 ERROR [stderr] at org.atmosphere.container.BlockingIOCometSupport.cancelled(BlockingIOCometSupport.java:172) 

17:24:23,693 ERROR [stderr] at org.atmosphere.cpr.AsynchronousProcessor$1.run(AsynchronousProcessor.java:119) 

17:24:23,694 ERROR [stderr] at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441) 

17:24:23,696 ERROR [stderr] at java.util.concurrent.FutureTask$Sync.innerRunAndReset(FutureTask.java:317) 

17:24:23,698 ERROR [stderr] at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:150) 

17:24:23,699 ERROR [stderr] at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$101(ScheduledThreadPoolExecutor.java:98) 

17:24:23,703 ERROR [stderr] at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.runPeriodic(ScheduledThreadPoolExecutor.java:180) 

17:24:23,707 ERROR [stderr] at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:204) 

17:24:23,715 ERROR [stderr] at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) 

17:24:23,716 ERROR [stderr] at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) 

17:24:23,718 ERROR [stderr] at java.lang.Thread.run(Thread.java:662) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T13:12:42.737

该错误表明`com.zreflect.emyed.whiteboard.pubsub.EventLoggerAsync`该类期望 a `ch.qos.logback.classic.LoggerContext`，而不是它获得 a `org.slf4j.helpers.NOPLoggerFactory`。这通常发生在某些代码尝试强制转换的返回值`org.slf4j.LoggerFactory.getILoggerFactory`并且 slf4j 绑定到 NOP 实现时，因为类路径上没有可用的 slf4j 绑定。这通常伴随着[一条错误消息](http://slf4j.org/codes.html#StaticLoggerBinder)。

# php - Mkdir 抛出警告，什么时候应该是布尔值？

> ID：15483310
> 
> 赞同：2
> 
> 时间：2013-03-18T17:40:01.887
> 
> 标签：php, mkdir

所以 php 中流行的 mkdir() 函数在以下代码中向我抛出了警告：

```
public function check_dir($dir, $create_dir = false) {
    if (is_dir ( $dir )) {
        return true;
    } elseif ($create_dir == true) {
        return mkdir ( $dir );
    }

    return false;
} 
```

很容易知道发生了什么。所以我就不解释了。但是在 mkdir() 行我得到：

> 警告：mkdir()：第 70 行 /var/www/wordpress/wp-content/themes/Aisis-Framework/AisisCore/FileHandling/File.php 中的权限被拒绝

因此，虽然它只是一个警告，仅此而已，但您永远不应该在现场打开警告，或者任何类型的错误。那么，当它明确指出它返回真或假而不是警告或致命时，我该如何处理呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T17:47:19.190

您可以建立一个自定义错误处理程序，这通常是一个很好的做法：[http ://www.php.net/set-error-handler](http://www.php.net/set-error-handler)

您可以使用它以您认为合适的任何方式处理任何 PHP 错误。除此之外，您将不得不关闭错误/警告日志记录（正如您所说，这不是一个好习惯），或者使用 @ 抑制（通常应该避免，但在这种情况下可能适合。）

就我个人而言，我同意返回 true/false 以指示失败的函数已经不需要在失败时发出警告。但是，这对你来说就是 PHP。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T18:08:59.763

您应该在生产服务器中关闭警告...但更好的是..您可以检查代码中的权限...

```
function checkDir($dir, $createDir = false) {
    if ($createDir === true) {
        if (is_dir($dir))
            return true;
        $baseDir = dirname($dir);
        if (! is_dir($baseDir) || ! is_writable($baseDir)) {
            return false;
        }
        return mkdir($dir);
    } else {
        return is_dir($dir);
    }
    return false;
} 
```

# jquery-mobile - 创建视图的单个实例时事件不会触发，但在创建多个实例时有效

> ID：15483311
> 
> 赞同：0
> 
> 时间：2013-03-18T17:40:02.333
> 
> 标签：jquery-mobile, backbone.js

我是 Backbone 的新手，我正在努力解决一些问题。我正在尝试使用 jQuery mobile 和 Backbone 构建一些东西。请在下面找到我的代码

```
var WelcomePage = Backbone.View.extend({
        initialize:function () {
            this.template = _.template($("#welcome_template").html());
        },

        render:function (eventName) {
            $(this.el).html(this.template());

            return this;
        },

        events:{
            "click .btn_continue"   : function(){
                appRouter.navigate('login',{trigger: true});
            }
        }
    });

var Login = Backbone.View.extend({
        initialize:function () {
            this.template = _.template($("#login_template").html());
        },

        render:function (eventName) {
            $(this.el).html(this.template());

            return this;
        },

        events:{
            "click .btn_login"  : function(){
                appRouter.navigate('dashboard',{trigger: true});            
            }
        }
    });

var Dashboard = Backbone.View.extend({
        initialize:function () {
            this.template = _.template($("#dashboard_template").html());
        },

        render:function (eventName) {
            $(this.el).html(this.template());

            return this;
        },

        events:{
            "click .btn_loadImages" : function(){
                console.log('load Images');
            }
        }
    });

var Router = Backbone.Router.extend({
        routes:{
            "":"welcome",
            "login":"login",
            "dashboard":"dashboard",
        },

        initialize:function () {
        },

        welcome:function () {
            this.changePage(new WelcomePage());
        },

        login:function () {
            this.changePage(new Login());
        },

        dashboard:function(){
            this.changePage(new Dashboard());
        },

        changePage:function (page) {
            $(page.el).attr('data-role', 'page');
            page.render();
            $('body').append($(page.el));

            $.mobile.changePage($(page.el), {changeHash:false, transition: 'slide'});
        }

    });

    var appRouter = new Router();
    Backbone.history.start(); 
```

现在，当我使用 BACK 键来回浏览屏幕时，使用上面的代码可以触发事件。然后我尝试用下面的代码替换路由器的代码

```
 var Router = Backbone.Router.extend({
            routes:{
                "":"welcome",
                "login":"login",
                "dashboard":"dashboard",
            },

            initialize:function () {
            },

            welcome:function () {
                this.changePage(v_WelcomePage);
            },

            login:function () {
                this.changePage(v_Login);
            },

            dashboard:function(){
                this.changePage(v_Dashboard);
            },

            changePage:function (page) {
                $(page.el).attr('data-role', 'page');
                page.render();
                $('body').append($(page.el));

                $.mobile.changePage($(page.el), {changeHash:false, transition: 'slide'});
            }

        });

        var v_WelcomePage = new WelcomePage();
        var v_Login = new Login();
        var v_Dashboard = new Dashboard();

var appRouter = new Router();
        Backbone.history.start(); 
```

我注意到当我返回之前的屏幕时，事件停止触发。我没有在路由器的操作中创建视图实例，而是在外部创建了它并每次都调用它。我希望我有一些意义。

非常感谢任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T17:58:52.357

当视图被实例化而不是渲染（在 Backbone View 构造函数中）时，使用 jQuery 连接事件。当从页面中删除 html（可能在 中`$.mobile.changePage`）时，jQuery 会断开这些事件。

因此，第二次渲染页面时，事件将不会重新连接。您可以尝试再次调用`page.delegateEvents()`手动连接事件，或者您可以每次都重新创建视图。

# c# - icsharpcode.sharpziplib 限制

> ID：15483312
> 
> 赞同：0
> 
> 时间：2013-03-18T17:40:05.360
> 
> 标签：c#, sharpziplib

我正在使用该库来读取 zip 文件。zip 包含大约 200,000 个文件。其中一半带有 .txt 扩展名，一半带有 .csv 扩展名。

但是，当我使用以下代码提取它们时，

```
var fs = File.OpenRead(_archiveName);
var _zipFile = new ZipFile(fs);

var csvs = (from ZipEntry zipEntry in _zipFile
                    where Path.GetExtension(zipEntry.Name) == ".csv"                    select zipEntry).ToDictionary(
                        z => GenerateBookName(extension, Path.GetFileNameWithoutExtension(z.Name)), z => z ); 
```

csvs 字典中的项目数只有大约 500 个键值对。

图书馆有限制吗？

谢谢

# vbscript - 使用 VBScript 移动项目时如何跳过打开的文件夹（并跳过打开的文件）？

> ID：15483313
> 
> 赞同：0
> 
> 时间：2013-03-18T17:40:16.557
> 
> 标签：vbscript

我制作了一个 VBscript 来移动 Windows 文件夹，当脚本到达用户打开的文件夹时，它会卡住。有没有办法可以更改我的脚本，使其跳过打开的文件夹并跳过打开的文件？

* * *

```
Dim fso, directory, item, group, dateStamp, NumberFilesDeleted, text, MoveFoldersErrorInfo, MoveFilesErrorInfo, objLogFile

On error resume Next 

Set fso = CreateObject("Scripting.FileSystemObject")

'Move folders in the temp folder to To_Be_Deleted folder and check for errors
fso.MoveFolder "E:\Projects\temp\*" , "E:\Projects\To_Be_Deleted"
If Err.Number <> 0 Then
   MoveFoldersErrorInfo =  "Error: " & Err.Number & " Error (Hex): " & Hex(Err.Number) & Err.Source & " Description: "  & Err.Description
   Err.Clear
End If

'Move files in the temp folder to To_Be_Deleted folder and check for errors
fso.MoveFile "E:\Projects\temp\*" , "E:\Projects\To_Be_Deleted"
If Err.Number <> 0 Then
    MoveFilesErrorInfo =  "Error: " & Err.Number & " Error (Hex): " & Hex(Err.Number)  & Err.Source & " Description: "  & Err.Description
    Err.Clear
End If 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-29T17:58:10.850

Vbscript 的文件操作非常慢，如果有可靠的方法来检查文件是否打开，它甚至会进一步减慢进程。您可以像在脚本示例中那样使用“on error resume next”来忽略打开的文件。

我只知道您想要检查的一个原因，那就是使用 systernals 中的 psfile.exe 之类的实用程序强制关闭文件，但我想您的用户不会对此感到满意。

作为外部程序 psfile 可以从您的脚本运行并检查并在需要时关闭打开的文件，因此您可以首先使用 /c 参数（强制关闭）在已处理的文件夹上运行它，然后从批处理脚本中移动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-29T17:38:32.497

VBScript 在文件的移动/删除操作中不是很可靠。改用 DOS 命令，它甚至会删除/移动**用户打开的**文件。

您必须自己创建文件夹，这是一个减号。但它可以保证工作并且不会给你错误信息。

您的代码可能与此类似：

```
Set wshShell = CreateObject( "WScript.Shell" )
wshShell.Run "cmd /c mkdir " & strNewDestination & "\" & strFolder, 0, True 
wshShell.Run "cmd /c copy /y " & strFolder & "\*.* " & strNewDestination & "\" & strFolder, 0, True
wshShell.Run "cmd /c del /y " & strFolder & "\*.*", 0, True 
```

# ember.js - Ember.js 反序列化实现

> ID：15483315
> 
> 赞同：3
> 
> 时间：2013-03-18T17:40:23.937
> 
> 标签：ember.js, ember-router

我正在试验最新的 Ember.js api，但我遇到了一个小问题。除了路由反序列化方法外，一切看起来和工作正常。要完全理解我的问题，请访问我的博客[http://eduardmoldovan.com/](http://eduardmoldovan.com/)，单击帖子，它会加载。然后刷新页面。所有的内容都会消失。我在这里做错了什么？显然有些事情实施得很糟糕，但我找不到问题所在。

这是处理这一切的死记硬背。

```
Ngin.ArticleRoute = Ember.Route.extend({
    serialize: function(model) {
        "use strict";
        if (model) {
            return {
                channel: model.get("channel"),
                url: model.get("url") + "/"
            };  
        }

    },
    setupController: function(controller, model) {
        "use strict";
        controller.set("channels", Ngin.Channel.find());
        controller.set("comments", Ngin.Comment.find({
                filter: "comments-by-url",
                url: model.get("url")
            })
        );
        controller.set("content", model);
    },
    model: function(parameters) {
        "use strict";
        var article = Ngin.Article.find({
                filter: "by-url",
                url: parameters.url
            });
        return article;
    },
    renderTemplate: function() {
        "use strict";
        this.render("header", {
            outlet: "header"
        });
        this.render("article", {
            outlet: "content"
        });
        this.render("footer", {
            outlet: "footer"
        });
        $("html, body").animate({scrollTop: 0}, "fast");
    }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T20:22:59.757

反序列化不再是公共 API 的一部分，您应该使用`model`钩子。这是[ember 指南文章的链接](http://emberjs.com/guides/routing/specifying-a-routes-model/)。

# jqgrid - jqGrid 与 multiselect:true 和 reloadGrid 双复选框列

> ID：15483325
> 
> 赞同：0
> 
> 时间：2013-03-18T17:40:59.603
> 
> 标签：jqgrid, multi-select

多选的列保存在网格参数中，当我使用保存的状态（`getGridParam`）重新加载网格时，我得到一个用于选择的双列，这弄乱了我的列顺序。

我加载参数之前的网格
![前](../Images/d78764f6f5ce5c383f4d10f94c0a6b3c.png)

后 ![后](../Images/06ef4fd5ead55657a9b926ad429ab613.png)

这是代码：

```
jQuery("#list2").jqGrid({
    url:'jqgrid/server.php?q=2',
    datatype: "json",
    colNames:['a','UID','Phone', 'Message', 'created','replyed'],
    colModel:[
          {name:'action',index:'action', width:55,search:false,'sortable':false},
        {name:'id',index:'uid', width:55},
        {name:'phone_number',index:'phone_number', width:90,'editable':true},
        {name:'message',index:'message', width:500,'editable':true},
        {name:'created',index:'created', width:80, align:"right",'editable':true,stype:'select',edittype:"select",editoptions: {value:"Yes:Yes;No:No"}},
        {name:'replyed',index:'replyed', width:80, align:"right",'editable':true,edittype:"checkbox",editoptions: {value:"Yes:No"}},        
    ],
    rowNum:50,
    toolbar: true,
    height: '100%',
    width: 800,
    rowList:[10,20,50,100,300,1000],
    pager: '#pager2',
    sortname: 'uid',
    sortable:true,
    viewrecords: true,
    sortorder: "desc",  
    caption:"Pilote",
    gridview : true,
    multiselect: true,
});

function saveStateGrid(){
     state = $('#list2').getGridParam();
     localStorage.setItem("gridState", JSON.stringify(state));
}
function loadStateGrid(){
    state = JSON.parse(localStorage.getItem('gridState'));
    jQuery("#list2").GridUnload("#list2");
    //state.multiselect = false;
    $('#list2').jqGrid(state);
    $('#list2').trigger('reloadGrid');
} 
```

# jsf - 为什么组件上的面消息是附加的？

> ID：15483328
> 
> 赞同：0
> 
> 时间：2013-03-18T17:41:25.907
> 
> 标签：jsf

我正在向我的组件添加验证消息。我有许多输入，然后我在附加到隐藏输入的验证器中一起验证它们，该隐藏输入在所有这些组件之上声明。我看到每次验证失败时，都会不断添加*相同的消息。*

像“*输入 x 大于输入 Y* ”这样的消息会显示两次，即使它应该显示一次。然后我更正错误值，它就消失了。接下来我故意再次插入相同的错误值。然后我会看到上面的错误信息*三遍*。

如何清除先前请求中的消息？

这是人为的相关代码：

```
if (all condition passes) {
    for(UIInput:components){
        input.setValid(true);
    }

} else {
      //Find out the first component that fails the validation and mark it red
      FacesContext context = FacesContext.getCurrentInstance();
      UIInput input= components.getInvalidComponent();
      input.setValid(false);
      context.addMessage(input.getClientId(context),message) ;                           
    } 
```

**PS：我正在使用JSF1.2**

# laravel - Laravel4 安装不正确

> ID：15483332
> 
> 赞同：0
> 
> 时间：2013-03-18T17:41:41.943
> 
> 标签：laravel, laravel-4

我正在尝试在 ubuntu 中安装 Laravel4。但是每次我尝试按照安装说明使其工作时，我都会在 php 页面中收到错误消息。我应该在哪里寻找任何想法？全新安装后，当我启动该站点时，我收到此错误：

`Parse error: syntax error, unexpected $end in /mnt/hgfs/www/......./vendor/patchwork/utf8/bootup.utf8.php on line 309`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T19:56:00.467

我也遇到了一些麻烦。我的问题来自整个项目文件没有正确的权限。

在您的根应用程序文件夹中尝试此操作：

> 查找 ./ -type d -exec chmod 775 {} + && 查找 ./ -type f -exec chmod 664 {} +

希望能帮助到你。

# java - 脸书页面API

> ID：15483335
> 
> 赞同：-4
> 
> 时间：2013-03-18T17:41:51.317
> 
> 标签：java, facebook

我为客户开发网站。现在我需要集成功能，允许用户在他的页面上发布文本。用户是公司，假设他们将拥有自己的页面。我对 facebook 应用程序和 facebook 页面有点困惑。

有人可以解释一下我的步骤。还有我可以使用的任何java库。我需要为此创建应用程序吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T02:55:43.363

是的，您需要创建一个应用程序。[RestFB](http://restfb.com/)可能是一个很好的库。

# python - NameError：未定义全局名称“当前”

> ID：15483339
> 
> 赞同：-3
> 
> 时间：2013-03-18T17:42:03.003
> 
> 标签：python, tkinter, wizard

以下是我为当前工作构建的应用程序中使用的部分代码。运行以下代码时，我收到本文标题中所述的错误。tkinter 向导的代码来自[http://mail.python.org/pipermail/tutor/2005-May/038686.html](http://mail.python.org/pipermail/tutor/2005-May/038686.html)。我已经在自己的窗口中运行了代码并且它可以工作，但是当我将代码放在我的应用程序中时，它会遇到上述错误。

所以，这是我的问题：发生了什么事，我该如何解决？

```
from tkinter import *

#Start Code for the Introduction Wizard
def wizIntro():
    wizIntro = tkinter.Tk()

    #Title:
    wizIntro.title('Welcome to Training')

    #Content:
    page1 = Frame(wizIntro)
    Label(page1, text='', width=110).pack()
    Label(page1, text='--Welcome to Training--', width=85).pack()
    Label(page1, text='', width=85).pack()
    Label(page1, text='This tutorial will help you familiarize yourself with the program.  Following it is key to understanding', width=85).pack()
    Label(page1, text='the proper operation of the Laser Cutter.', width=85).pack()
    Label(page1, text='', width=90).pack()
    Label(page1, text='It is also important to follow every insrtuction exactly as stated, to avoid or minimize damage to the Laser', width=85).pack()
    Label(page1, text='Cutter and reduce the risk of injury to the operator and those around him.', width=85).pack()
    Label(page1, text='Therefore, all safety notices must be followed with extreme care.', width=110).pack()
    Label(page1, text='--Failure to follow all safety notices poses a severe risk of damage to the equipment and to the operator, which can be fatal--', width=110, fg='red').pack()
    Label(page1, text='', width=110).pack()
    Label(page1, text='Click Next to Continue...', width=110).pack()
    page1.pack()

    page2 = Frame(wizIntro)
    Label(page2, text='', width=110).pack()

    #Commands:
    pages = [page1, page2]
    current = page1
    def move(dirn):
        global current
        idx = pages.index(current) + dirn
        if not 0 <= idx < len(pages):
            return
        current = pages[idx]
        current.pack_forget()
        current.pack(side = TOP)

    def nex():
        move(+1)

    def prev():
        move(-1)

    Button(wizIntro, text='Previous', command=prev).pack(side = LEFT)
    Button(wizIntro, text='Next', command=nex).pack(side = RIGHT)

#End Code for the Introduction Wizard 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T18:06:03.983

我不确定这是否是您的问题，但它肯定至少是一个相关的问题：

```
current = page1
def move(dirn):
    global current 
```

这两个`current`变量指的不是同一个东西。第一个是函数中的局部变量`wizintro`。第二个是全局变量。

与其他错误相反，此特定错误的原因是这一行：

```
idx = pages.index(current) + dirn 
```

您正在引用一个名为`current`. 您已经说过它是`global`，但您从未在全局范围内为它分配任何值。所以，它是未定义的。所以你得到一个例外。

如果您只是删除该`global current`行，那么它们会引用两个不同函数中的局部变量，这可能仍然不是您想要的。同一行实际上会给出相同的错误——现在它是一个*局部*变量，您正在使用它而没有在局部范围内为其分配任何值，但这并没有更好。

很明显，您想从外部范围`move`引用。`current`

如果您使用的是 Python 3.x，`nonlocal current`那可能就是您所追求的。

如果没有，有几个选择。

您可以使用“可变默认参数值”技巧。替换为一个元素 ( )`current`的 a ，然后作为额外参数传递给. 只要没有人覆盖默认值，就会有一个名为的局部变量，尽管它与外部范围内的*变量不同，但它是对相同**值*的引用，因此*也是*相同的变量。（有不同的技巧可以将局部变量绑定到闭包中，这对于来自 Scheme/Haskell/etc. 背景的人可能会感觉更友好，但效果是一样的。）`list``current=[page1]``current=current``move``move``current`**`current[0]`**

 ***或者您可以`current`在两个范围内都创建一个全局变量。

或者，走相反的方向：`wizintro`变成一个类，`move`朋友变成方法，`current`变成一个实例变量。这看起来真的像你在这里的目的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T18:08:01.723

您不能使用`global`从外部范围更改非全局变量，只能更改全局（模块级）变量。Python 3.x`nonlocal`可以做到这一点。考虑改变你的逻辑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-18T18:09:24.153

您遇到的麻烦是因为`current`不是全局变量，而是`wizIntro`函数中的局部变量。您的嵌套函数`move`尝试访问它，但它的`global`语句在全局命名空间中找不到该值。这意味着当您稍后尝试访问它时，您会得到一个`NameError`.

如果您使用的是 Python 2，则没有任何好方法可以从嵌套函数中访问外部函数命名空间的变量。我认为你能做的最好的事情就是声明`current`是全局的`wizIntro`（在你第一次分配给它之前）。Python 3 引入了`nonlocal`可以使用当前结构的关键字（只需替换您当前的`global`语句。***

# java - Java中的curl之类的东西

> ID：15483340
> 
> 赞同：0
> 
> 时间：2013-03-18T17:42:05.907
> 
> 标签：java, jsp, servlets

我正在尝试在 jsp 页面中执行类似 CURL 的操作。我需要检查网站中是否有一些字符串。我在 Java 方面非常糟糕，这就是为什么这可能是一个愚蠢的问题，但它也可能对其他人有用。

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T17:43:38.593

从 apache 检查 HttpClient ...

[http://hc.apache.org/httpclient-3.x/](http://hc.apache.org/httpclient-3.x/)

会做任何你可能需要的事情。

谢谢！

@leo。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T17:48:24.797

我想一次性你可以使用 Guava 的 Resources.readLines(URL url, Charset charset) 命令。如果这是您在每个页面上都在做的事情 (:shudder:)，那么您肯定会想要查看 apache commons 的 http 客户端并使用连接池。尽管如果您的问题集涉及在显示您自己的网页之前必须下载其他人的网页，那么您肯定会遇到缩放/性能问题。

请参阅：[http ://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/io/Resources.html](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/io/Resources.html)

# sql - Access 中的 SQL 查询以提示消息框要求更改表名

> ID：15483341
> 
> 赞同：2
> 
> 时间：2013-03-18T17:42:09.900
> 
> 标签：sql, ms-access, onclick, messagebox

在 Access 中运行 SQL 查询之前，是否有办法提示您输入要查询的表名？例如，假设列将始终保持不变。这些列可以称为“水果”和“日期”。但是，表名可能会根据批号而改变。IE。表名可以是“BatchNO_1”或“BatchNO_2”或“BatchNO_3”等。所以假设我有一个类似的 SQL：

```
select Fruit, Date from BatchNO_1 where Fruit = "Apples" 
```

有没有一种方法可以提示我输入表名并让 SQL 使用我输入的表名来执行查询？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-18T17:49:52.817

不可以。表名不能作为参数传递给查询。您必须自己构建查询。

```
Dim tableName as String, sql As String

tableName = InputBox("Please enter the table name")
If tableName <> "" Then
    sql = "SELECT Fruit, Date FROM [" & tableName & "] WHERE Fruit = 'Apples'"
    'TODO: execute the query here
End If 
```

例如，您可以像这样更改现有查询的查询文本：

```
CurrentDb.QueryDefs("myQuery").SQL = sql 
```

或者你可以像这样执行查询

```
Dim db As DAO.Database, rs As DAO.Recordset

Set db = CurrentDb
Set rs = db.OpenRecordset(sql)
Do Until rs.EOF
    Debug.Print rs!Fruit & " " & rs!Date
    rs.MoveNext
Loop
rs.Close: Set rs = Nothing
db.Close: set db = Nothing 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-18T18:02:43.730

通过将批号放在表名中而不是列中，您可以在**schema中编码****数据**。这不是最佳实践，所以在我看来，正确的答案是改变你的数据库设计。

 **`Batch`使用当前表中的所有列创建一个`BatchNo`表，但添加一个名`BatchNo`为主键的列。将 BatchNo 表中的所有数据加载到该表中，然后删除这些表。然后您的查询将直接如下所示：

```
SELECT Fruit, Date
FROM Batch
WHERE
   Fruit = "Apples"
   AND BatchNo = [Enter Batch No]; 
```

不要将数据放在表名中。这不是数据库应该采用的方式。

稍微解释一下，您当前的设计违反最佳实践的原因*正是由于您现在面临的问题*——您必须做的恶作剧和奇怪的事情才能使用这样的设计并尝试在一个合理的，数据驱动的，方式。

通过让用户输入表名，如果您不小心将用户提供的表名与允许的表名的白名单进行比较，也会产生 SQL 注入的危险。虽然这在 Access 中可能没什么大不了的，但它仍然走在错误的道路上，并且正在为专业数据库工作之外的其他内容进行培训。如果您想发展自己的事业，那么在您甚至可以从“白板”开始学习正确的做事方式之前，首先必须忘掉一堆东西，这将是令人遗憾的。**

# amazon-web-services - S3 的自定义用户权限

> ID：15483342
> 
> 赞同：0
> 
> 时间：2013-03-18T17:42:12.033
> 
> 标签：amazon-web-services, amazon-s3

我有一个 Django 应用程序，它将定期将内容上传到 S3。我认为将 S3 密钥和秘密存储在我的设置文件中很容易：

```
S3_KEY = "whateverkeything"
S3_SECRET = "mykeysecret" 
```

然后，考虑到安全性和在适用时限制权限的想法，重新考虑了这种方法。我的应用程序只需要 GET 和 PUT/POST 对象，从不删除对象，从不创建或删除存储桶等。另外，如果有人可以访问我的 AWS 密钥和秘密，他们可能会启动 100 个大型 EC2 实例，运行我负债累累。

有没有办法限制访问并为 S3 创建一个仅具有所述权限的新“用户”？还是我太偏执了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T01:37:44.657

您绝对应该创建一个只有必要权限的用户。使用 IAM（身份和访问管理）很容易做到。您可以在现有 AWS 账户上创建一个新用户（从 AWS 控制台最容易做到），然后为其提供所需的最低权限。这样，如果凭据以某种方式受到损害，损害的范围就会受到限制。

另一种选择是为您的服务器分配 IAM 角色，但我不知道 PHP 工具是否可以使用角色。

使用控制台的策略编辑器分配 S3 权限非常容易。您只需选择特定的操作（似乎是 GET 对象和 PUT 对象）并给出要应用它的资源的“ARN”。如果您的存储桶名为“mybucket”，则 ARN 将为`arn:aws:s3:::mybucket/*`. 如果您还需要列出存储桶中的资源，您可以为列表存储桶添加第二个策略，其 ARN 为`arn:aws:s3:::mybucket`（没有尾部斜杠或星号）。

[IAM 用户指南](http://docs.aws.amazon.com/IAM/latest/UserGuide/Welcome.html)中提供了有关 IAM 用户和角色的信息。

# python - SciPy 反卷积函数

> ID：15483346
> 
> 赞同：8
> 
> 时间：2013-03-18T17:42:19.087
> 
> 标签：python, scipy

我想使用 SciPy 的反卷积函数来查找给定两个高斯分布的未知分布。[SciPy中没有](http://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.deconvolve.html)与此函数相关的文档，因此我只是在寻找一个示例，说明如何在我的情况下使用此函数。例如，给定两个正态分布 N(100, 1)、N(300, 2)，我想了解如何找到反卷积 N(200, 1) 的分布。

```
>>> sample1 = np.round(scipy.around(scipy.stats.norm(100, 1).rvs(size=1000)))
>>> sample2 = np.round(scipy.stats.norm(300, 2).rvs(size=2000))
>>> signal.deconvolve(sample1, sample2) 
```

上面的代码给了我负值，这似乎是错误的。如何从此反卷积中恢复分布 N(200, 1)？特别是，我认为我的问题是我不明白如何获得除数。

**我真正想看到的是如何使用 SciPy 的反卷积从这些样本中恢复 ~ N(200, 1) 的示例。**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-18T19:26:52.993

我认为你对你的期望有点困惑......因为我们都知道两个正态分布的卷积**是**另一个正态分布，平均值是平均值之和，方差是方差之和，你似乎期望两个正态**随机样本**的卷积也将是一个正态随机样本。事实并非如此：

```
a = scipy.stats.norm(100, 1).rvs(size=1000)
b = scipy.stats.norm(200, 1).rvs(size=1000)
c = scipy.convolve(a, b)
plt.subplot(311)
plt.hist(a, bins=50)
plt.subplot(312)
plt.hist(a, bins=50)
plt.subplot(313)
plt.hist(a, bins=50) 
```

![在此处输入图像描述](../Images/ec3360f59ce30e3c286033b8e258b4d2.png)

您可能正在考虑以下内容：

```
a = scipy.stats.norm(100, 10).pdf(np.arange(500))
b = scipy.stats.norm(200, 20).pdf(np.arange(500))
c = scipy.convolve(a, b)
m_ = max(a.max(), b.max(), c.max())
plt.subplot(311)
plt.axis([0, 1000, 0, 1.25*m_])
plt.plot(a)
plt.subplot(312)
plt.axis([0, 1000, 0, 1.25*m_])
plt.plot(b)
plt.subplot(313)
plt.axis([0, 1000, 0, 1.25*m_])
plt.plot(c) 
```

![在此处输入图像描述](../Images/db92d822d95b1845b6ba142334ec9afc.png)

无论如何，回到`deconvolve`......如果你用两个长度为`m`and的数组调用它`n`，它将返回一个包含两个数组的元组：

*   length`m - n + 1`中的第一个是反卷积数组，即您应该将第二个数组与之卷积的数组，以获得第一个
*   长度的第二个`m`是用第二个与第一个返回的卷积替换第一个数组时的错误。

# c# - 构建第 3 方 API/SDK

> ID：15483347
> 
> 赞同：0
> 
> 时间：2013-03-18T17:42:23.473
> 
> 标签：c#, api, oop, architecture, sdk

**概述**

*   在过去的 3 年里，我们用 C# 构建了一个功能齐全的软件包
*   我们的软件以这样一种方式构建，它可以处理应用程序所需的大量低级管道，以便我们的开发人员可以专注于他们试图解决的特定问题，而不是所有细节。这显着缩短了开发和发布时间
*   因此，代码被分解成不同的项目以给我们逻辑分离（例如前端 MVC 应用程序、服务层、核心框架层等）
*   我们的核心框架项目内置了很多功能（应用程序的主要“胆量”），并且已经精心组织成所有人都熟悉的各种命名空间（例如数据访问、IO、日志记录、邮件等）
*   当我们最初构建这个时，我们的目标始终是让我们的团队成为目标受众，我们的开发人员对各种新功能进行编码并根据需要添加到框架中。

**挑战**

*   现在老板希望能够向我们公司以外的第三方开发人员和团队开放我们的代码库。这些第 3 方人员需要能够直接利用我们的核心库并构建他们自己的模块，这些模块将与我们的服务器一起部署在我们的服务器上。仅仅由于应用程序的性质，我们无法通过 REST 或 SOAP 或类似的方式向它们公开功能来解决问题，它们需要在类似于我们自己的环境中工作，在那里它们可以针对我们的核心库进行开发和编译他们自己的 DLL 用于发布
*   这在知识产权（我们必须能够保护我们代码的内部运作）、分发、部署、版本控制和测试和发布方面提出了许多担忧和挑战，也许最重要的是我们将如何塑造框架以最好地满足这些要求需要。

你会提供什么建议？你会如何处理这个问题？你希望改变什么样的事情，或者你希望转向什么样的设计方法？我意识到这些问题非常开放，甚至可能含糊不清，但我主要是从可能面临类似挑战的人那里寻找来自您自己背景的任何建议、资源/教程或故事。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T18:06:26.957

我不确定 MEF 的答案是否真的能解决您的问题。即使使用接口和 MEF 将实现与合同分开，您仍然需要交付实现（我理解您的问题），因此，MEF 不会阻止您交付带有 IP 的程序集。

底线是，如果您需要分发您的实现程序集，这些第 3 方将拥有您的 IP，并具有反编译它们的能力。.NET 无法解决这个问题，最后我检查了一下。您可以使用[混淆](https://stackoverflow.com/questions/1988451/net-obfuscation)来使其更加困难，但这不会阻止某人反编译您的实现，只会使其更难阅读和理解。

正如您所指出的，最好的方法是将实现置于 SaaS 类型的边界之后，但这听起来是不可能的。

我要补充的是，我强烈建议开发一个健壮的版本控制模型。这将影响您如何定义接口/API、如何随时间更改它们以及如何对程序集进行版本控制。如果您不小心，并且您没有在程序集中同时使用`AssemblyVersion`和`AssemblyFileVersion`处理这个权利，可悲的是）。 [阅读这些](https://stackoverflow.com/questions/64602/what-are-differences-between-assemblyversion-assemblyfileversion-and-assemblyin)，因为在我看来它们对 API/组件供应商非常重要。

NDA 和/或许可协议是另一种方式，正如@trailmax 所指出的，如果您认为您的用户会尊重此类协议（个人与公司可能会以不同的方式看待此类协议）。

哦，还要确保您使用强名称[签署您的程序集。](http://msdn.microsoft.com/en-us/library/xc31ft41.aspx)为此，您可能需要制定保护您的签名密钥的策略。乍一看这似乎很简单，但充分保护您的签名密钥并不像乍看起来那么容易。您通常必须为不同的环境拥有多组密钥，需要将密钥合并到 CI/CD 系统中，并且需要确保对发布密钥的访问受到严格控制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T17:50:57.183

正如@HighCore 已经说过的，为您想要公开的所有内容实现接口。将它们放入单独的项目/存储库中，并授予对项目/存储库的只读访问权限。但是你的接口必须有正确的文档记录，否则其他人可能会很痛苦。

这样你的代码对他们来说是不可见的，他们仍然可以处理它。

如果这不起作用，并且您被迫向他们展示您的代码，请让他们签署 NDA。NDA 应该声明您的代码是您的，他们不能以任何方式重新分发它。

我想我的回答和问题一样模糊，但给了你一些想法。

# mysql - 基于关联数的 SQL 条件

> ID：15483348
> 
> 赞同：1
> 
> 时间：2013-03-18T17:42:26.067
> 
> 标签：mysql, sql, associations, conditional-statements

我正在尝试对我的用户数据库运行查询，但遇到了一些麻烦。我想获取相关行的数量并以此为基础。我会让我的场景解释：

用户可以在我的应用中拥有_many 个视频。就我而言，我想返回所有没有视频的用户。还有其他一些条件，但这是我遇到麻烦的条件。理想情况下，我的查询类似于（有点 sudo 代码）：

```
SELECT count(*) FROM users 
JOIN videos ON users.id=videos.user_id
WHERE
  users.some_attribute = 1
  OR
  (users.last_login >= '03/18/2012' AND COUNT(videos) > 0) 
```

任何和所有的帮助表示赞赏。

谢谢！！- 杰夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T17:45:11.647

您可以使用具有 HAVING 属性的 GROUP BY

```
SELECT usercolumns, count(videos.user_id) 
FROM users 
    LEFT OUTER JOIN videos ON users.id=videos.user_id
WHERE users.some_attribute = 1
GROUP BY usercolumns HAVING users.last_login >= '03/18/2012' AND COUNT(videos.user_id) > 0 
```

如果你真的想要所有的列，你也可以使用 subQuery

```
SELECT *
FROM (
    SELECT userscolumns, count(videos.user_id) 
    FROM users 
        LEFT OUTER JOIN videos ON users.id=videos.user_id
    WHERE users.some_attribute = 1
    GROUP BY userscolumns
) A
WHERE users.last_login >= '03/18/2012' 
AND COUNT(videos.user_id) > 0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T17:46:14.040

您可以在 SQL 中使用 Have 语句：

```
SELECT count(*) FROM users 
JOIN videos ON users.id=videos.user_id
WHERE  users.some_attribute = 1   OR   users.last_login >= '03/18/2012'
HAVING COUNT(videos.<some_column>) > 0) 
```

添加编辑以响应以下评论：

```
SELECT count(*) FROM users 
WHERE  users.some_attribute = 1   
UNION 
SELECT count(*) FROM users 
JOIN videos ON users.id=videos.user_id
WHERE  users.last_login >= '03/18/2012'
HAVING COUNT(videos.<some_column>) > 0) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-18T17:50:08.050

我认为不存在最好

```
SELECT count(*) 
FROM users 
WHERE
users.some_attribute = 1
OR
(users.last_login >= '03/18/2012' 
and not exists 
 (
 select count(videos.videofield) 
 from videos 
 where users.id=videos.user_id
 )
) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-18T17:52:25.340

```
SELECT u.user FROM users u
LEFT JOIN videos v ON u.id=v_id
WHERE v_id IS NULL AND 
  (users.some_attribute = 1
  OR
  users.last_login >= STR_TO_DATE('03/18/2012', '%m/%d/%Y')) 
```

# java - JTextArea txt; txt.getText() 跳过“\n”

> ID：15483350
> 
> 赞同：1
> 
> 时间：2013-03-18T17:42:32.557
> 
> 标签：java, swing, io

我在 TextArea 中有一些文本，我想将其保存在文件中，我的代码在这里：

```
private void SaveFile() {
    try {

        String content = txt.getText();

        File file = new File(filename);

        if (!file.exists()) {
            file.createNewFile();
        }

        FileWriter fw = new FileWriter(file.getAbsoluteFile());
        BufferedWriter bw = new BufferedWriter(fw);
        bw.write(content);
        bw.close();

    } catch (IOException e) {
        e.printStackTrace();
    }

} 
```

但它在没有“\n”的情况下保存；在新文件中，一切都在一行上；我也能预见到那些“进入”吗？先感谢您

问题是因为记事本，所以这里是解决方案：

```
private void SaveFile() {
    try {

        String content = txt.getText();
        content = content.replaceAll("(?!\\r)\\n", "\r\n");

        File file = new File(filename);

        // if file doesnt exists, then create it
        if (!file.exists()) {
            file.createNewFile();
        }

        FileWriter fw = new FileWriter(file.getAbsoluteFile());
        BufferedWriter bw = new BufferedWriter(fw);
        bw.write(content);
        bw.close();

    } catch (IOException e) {
        e.printStackTrace();
    }

} 
```

感谢您的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-18T17:56:28.680

它应该工作。尝试使用显示行尾 \r 和 \n 的文本编辑器，看看会发生什么。

如果您想确保文本文件可以被 Windows 实用程序（如仅理解 的记事本）打开`\r\n`，您必须以这种方式自己对其进行规范化：

```
content = content.replaceAll("(?!\\r)\\n", "\r\n"); 
```

这将用序列替换所有`\n`前面没有 a的人。`\r``\r\n`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-18T18:38:25.650

您应该使用 Swing 文本组件提供的 read() 和 write() 方法。有关详细信息，请参阅[文本和换行符](http://tips4java.wordpress.com/2009/02/07/text-and-new-lines/)。

如果您希望输出包含特定的 EOL 字符串，则应在为文本组件创建 Document 后使用以下内容：

```
textComponent.getDocument().putProperty(DefaultEditorKit.EndOfLineStringProperty, "\r\n"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-18T17:51:28.363

\ 字符转义下一个字符，正如您所说的 \n 将创建一个换行符。如果你想输出一个实际的\，你需要写：

"\n"

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-18T17:55:07.280

您可以使用 a`PrintWriter`将新行打印到文件。在扫描 TextArea 的文本时，如果 TextArea 的文本包含“\\n”，则使用 PrintWriter 的`println`() 方法，否则使用简单的`print`() ！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-18T18:00:58.210

你的 TextArea 的内容在一个字符串中。现在你可以在换行符处拆分它，然后你会得到你的 String[]。然后您可以迭代 String[] 数组并将其写入您的文件中：

```
private void SaveFile() {
        try {
            String content = txt.getText();
            File file = new File(filename);
            if (!file.exists()) {
                file.createNewFile();
            }
            FileWriter fw = new FileWriter(file.getAbsoluteFile());
            BufferedWriter bw = new BufferedWriter(fw);
            for (String line : content.split("\\n")) {
                bw.write(content);
            }

            bw.close();

        } catch (IOException e) {
            e.printStackTrace();
        }

    } 
```

# c++ - 在 C++ 中使用迭代器围绕 stl 类编写包装器

> ID：15483351
> 
> 赞同：1
> 
> 时间：2013-03-18T17:42:37.347
> 
> 标签：c++, templates, stl, iterator

我正在尝试围绕它们自己的迭代器编写包装类`std::list`，`std::vector`以便我可以为这些类及其迭代器编写一个超类。我当前的代码看起来基本上是这样的：

```
template <class T>
class MyCollection
{
//Not sure how to write this class.
public:
    class iterator
    {
        //Not sure how to write this class either
        //I think MyVector::iterator and MyList::iterator
        //should inherit from this class
    };
};

template<class T>
class MyVector : public MyCollection<T>
{
private:
    vector<T> data;
public:
    MyVector(int * start, int * end) : data(start, end) {}
    class iterator : vector<T>::iterator
    {
        iterator(typename vector<T>::iterator i) : vector<T>::iterator(i) {}
    };
    iterator begin() { return iterator(data.begin()); }
};

template<class T>
class MyList : public MyCollection<T>
{
private:
    list<T> data;
public:
    Mylist(int * start, int * end) : data(start, end) {}
    class iterator : list<T>::iterator
    {
        iterator(typename list<T>::iterator i) : list<T>::iterator(i) {}
    };
    iterator begin() { return iterator(data.begin()); }
}; 
```

我希望能够有一些代码来做到这一点：

```
int ints[] = {1,2,3,4,5};
MyList<int> l(ints, ints+5);
MyCollection<int> * c = &l;
MyCollection<int>::iterator i = c->begin(); 
```

并且在该代码执行之后，我希望能够遍历`MyList l`using `i`。

我觉得需要有一个`virtual begin()`成员函数`MyCollection`，但我无法弄清楚正确的返回类型应该是什么。

我想要做的甚至可能吗？我的代码的当前组织完全有可能是完全错误的。这就是我尝试过的。我的目标只是得到它，以便上面的示例驱动程序代码可以工作，因此答案可能涉及代码的完全重组。我真的只是在寻找建议。我不需要完整的答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T13:01:35.163

`std::vector`在这种情况下，我不会为`std::list`统一使用 std::list 或 std::vector 编写包装器。你不需要。您想要的是以与您可以在[此处](http://thbecker.net/free_software_utilities/type_erasure_for_cpp_iterators/any_iterator.html)找到的类似的方式使用类型擦除。

您的整个想法是仅`MyCollection<T>`使用类型擦除迭代器来实现，并使用类型擦除迭代器来遍历任何集合。不需要`MyList<T>`or `MyVector<T>`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T13:17:48.457

`MyCollection::begin`按照惯例，应该返回 a `MyCollection::iterator`。因此`MyVector::begin()`也应该返回*至少*是 a的东西`MyCollection::iterator`。不过，它可能是更派生的类型。

在您的情况下，`MyVector::begin()`返回 a `MyVector::iterator`，它不是从`MyCollection::iterator`. 这就是它失败的原因。

# excel - asp gridview导出到excel隐藏列

> ID：15483352
> 
> 赞同：0
> 
> 时间：2013-03-18T17:42:37.637
> 
> 标签：excel, gridview

有人可以看看我的代码吗？此代码运行良好，但我想在数据导出到 Excel 时删除第一列和第二列。我尝试`GridView1.Columns[0].Visible = false;`但它不起作用。

这是我的 aspx

```
<%@ Page Title="VRQ" Language="C#" MasterPageFile="~/MasterPage.master" AutoEventWireup="true" CodeFile="EmployeePage.aspx.cs" Inherits="EmployeePage"%>

<asp:Content ID="Content1" ContentPlaceHolderID="head" Runat="Server">
</asp:Content>
<asp:Content ID="Content2" ContentPlaceHolderID="ContentPlaceHolder1" Runat="Server">

    <script language="javascript" type="text/javascript">
function Button1_onclick() {
//open new window set the height and width =0,set windows position at bottom
var a = window.open ('','','left =' + screen.width + ',top=' + screen.height + ',width=0,height=0,toolbar=0,scrollbars=0,status=0');
//write gridview data into newly open window
a.document.write(document.getElementById('innerdata').innerHTML);
a.document.close();
a.focus();
//call print
a.print();
a.close();
return false;
}
function OpenFile(KEYW) {
    window.open("ResumePage.aspx?bid=" + KEYW, "ResumeContext");

}    
</script>
        <asp:Button ID="btnbacksearch" runat="server" Text="Back to Search" 
        Width="127px" OnClick="btnbacksearch_Click" CssClass="plainbutton" />

        <asp:Button ID="btnExportToExcel" runat="server" OnClick="btnExportToExcel_Click"
            Text="Export Results to Excel" Width="174px" CssClass ="plainbutton" />
        <asp:Button 
        ID="btnGenerateSF" runat="server" OnClick="btnGenerateSF_Click"
            Text="Generate Resume" Width="137px" CssClass ="plainbutton" 
        Visible="False" />
        &nbsp; &nbsp;
        <asp:DropDownList ID="ddStatus" runat="server" 
        onselectedindexchanged="ddStatus_SelectedIndexChanged" AutoPostBack="True" 
        Visible="False" Width="150px">
            <asp:ListItem Selected="True" Value="Active">Active Personnel</asp:ListItem>
            <asp:ListItem Value="Inactive">Inactive Personnel</asp:ListItem>
        </asp:DropDownList>
        <div style="font-size: 11pt; font-family: Tahoma; text-align:center "><strong>
                SEARCH SUMMARY</strong></div>
         <div style="font-size: 10pt; font-family: Tahoma; text-align:center ">
        <asp:Label ID="LabelCaption" runat="server" Text="Label"></asp:Label>
        </div>
<div id = "innerdata" style="size: landscape;" >
    <asp:GridView ID="GridView1" runat="server"  
                    CellPadding="4" DataSourceID="SqlDataSource1" 
                    onrowcreated="GridView1_RowCreated" 
                    AllowPaging="True" onpageindexchanging="GridView1_PageIndexChanging" 
                            DataKeyNames="IDNo" AllowSorting="True" Width="100%" 
                    PageSize="30" EmptyDataText="No Existing Records." CssClass="GridView" 
                    onrowcommand="GridView1_RowCommand" 
        AutoGenerateColumns="False" 
        onsorted="GridView1_Sorted" >

                <Columns>

                      <asp:TemplateField>
                        <ItemTemplate>
                            <asp:LinkButton runat ="server" ID="lnkSelect" Text="View" CommandName ="Select" CommandArgument='<%# Eval("IDNo") %>' ></asp:LinkButton>
                        </ItemTemplate>
                        <ItemStyle Width="20px" HorizontalAlign="Center" />
                    </asp:TemplateField>
                    <asp:TemplateField>
                        <ItemTemplate>
                            <asp:LinkButton runat ="server" ID="lnkPrintRep1" Text="Project Selection" CommandName ="PrintSF330" CommandArgument='<%# Eval("IDNo") %>' ></asp:LinkButton>
                        </ItemTemplate>
                        <ItemStyle Width="70px" HorizontalAlign="Center" />
                    </asp:TemplateField>
                    <asp:BoundField DataField="fullname" HeaderText="Name" ReadOnly="True" 
                        SortExpression="fullname" >
                      <ItemStyle Width="200px" />
                      </asp:BoundField>
                    <asp:BoundField DataField="YearsExperience" HeaderText="Experience" 
                        SortExpression="YearsExperience" >
                      <ItemStyle Width="50px" HorizontalAlign="Center" />
                      </asp:BoundField>
                    <asp:BoundField DataField="Job" HeaderText="Position" SortExpression="Job" >
                      <ItemStyle Width="200px" />
                      </asp:BoundField>
                      <asp:TemplateField HeaderText="Search Results" SortExpression ="SearchDetails">
                        <ItemTemplate>
                            <%# HighlightText(Convert.ToString(Eval("SearchDetails"))) %>                        </ItemTemplate>
                         <ItemStyle Width="300px" />
                      </asp:TemplateField>

                </Columns>
                    <RowStyle CssClass="GridRowStyle"/>
                    <PagerStyle  HorizontalAlign="Center"  />
                    <SelectedRowStyle CssClass="GridSelected" />
                    <HeaderStyle CssClass="GridHeader" Height="10px" />
                    <PagerStyle CssClass="GridFooterStyle"/>
            </asp:GridView></div> 

            <asp:SqlDataSource ID="SqlDataSource1" runat="server" 
    ConnectionString="<%$ ConnectionStrings:HRIS_ConnectionString %>" 
    ProviderName="<%$ ConnectionStrings:HRIS_ConnectionString.ProviderName %>" 
    SelectCommand="select i.IDNo,concat(lastname,', ',firstname,' ',middlename) as fullname,e.tYrsExperience as YearsExperience,p.Description as Job,'' as SearchDetails FROM employeesinfo i inner join ecd e on e.empid=i.idno 
           left outer join Position p on p.idno = e.presentjob">
</asp:SqlDataSource>
    <vt:MessageBox ID="MessageBox1" runat="server"></vt:MessageBox>
</asp:Content> 
```

这是我的 aspx.cs

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Text.RegularExpressions;
using System.IO;
using System.Text;

public partial class EmployeePage : System.Web.UI.Page
{
    string sqry = ""; string scolumn = "";
    string origQry = String.Empty;
    public string keyword = "";
    public string curAlpha = "";
    public int iCtr = 0;
    protected void Page_Load(object sender, EventArgs e)
    {
        if (Session["QRY_CONDITIONS"] == null) Response.Redirect("Default.aspx");

        scolumn = Session["QRY_DETAIL"].ToString();
        sqry = Session["QRY_CONDITIONS"].ToString();

        clsUser user = (clsUser)Session["CurrentUser"];
        if (user == null) return;

        if (user.IsSuperAdmin && sqry == "ALL")
        {
            ddStatus.Visible = true;
            sqry = string.Format(" where ifnull(i.activestatus,0) = {0}", ddStatus.SelectedIndex == 0 ? "1" : "0") ;
        }
        else if(sqry == "ALL")
        {
            ddStatus.Visible = false;
            sqry = " where ifnull(i.activestatus,0) = 1 ";
        }

        origQry = sqry;
        if (Request.QueryString["keyword"] != null) keyword = Request.QueryString["keyword"].ToString().TrimEnd().TrimStart();
        if (!IsPostBack)
        {
            if (keyword == "")
            {
                sqry = sqry + " and  i.lastname like 'A%' ";
                Session["QRY_alpha"] = " and  i.lastname like 'A%' ";
                curAlpha = "A";
            }
            LoadStates();
            BindData();
        }
    }
    protected override void LoadViewState(object savedState)
    {
        base.LoadViewState(savedState);
        curAlpha = (string)ViewState["curAlpha"];
    }
    protected override object SaveViewState()
    {
        ViewState["curAlpha"] = curAlpha;

        return base.SaveViewState();
    }
    private void BindData()
    {
        modPublic myMod = new modPublic();

        SqlDataSource1.SelectCommand = "SELECT distinct i.idno,concat(i.lastname,', ',i.firstname,' ',i.middlename) as fullname,e.tYrsExperience as YearsExperience,e.Position as Job," + scolumn + " as SearchDetails FROM employeesinfo i left join ecd e on e.empid=i.idno " +
            "left join position p on p.idno = e.presentjob  left join firm_location loc on loc.idno = i.firmlocationid  " + sqry + " order by i.lastname,i.firstname";
        SqlDataSource1.Select(new DataSourceSelectArguments());
        object o = myMod.ExecuteScalar("select  count(distinct i.idno) as ctr  FROM employeesinfo i left join ecd e on e.empid=i.idno " +
            "left join position p on p.idno = e.presentjob  left join firm_location loc on loc.idno = i.firmlocationid  " + origQry + " ");
        LabelCaption.Text = o.ToString() + " Record(s) found";
        if (keyword == "")
        {
            GridView1.AllowPaging = false;
            GridView1.Columns[5].Visible = false;
        }
        else
        {
            GridView1.Columns[5].Visible = true;
        }
        GridView1.DataBind();
    }
    protected void GridView1_PageIndexChanging(object sender, GridViewPageEventArgs e)
    {
        BindData();
        GridView1.PageIndex = e.NewPageIndex;
    }

    protected void GridView1_RowCommand(object sender, GridViewCommandEventArgs e)
    {
        if (e.CommandName == "AlphaPaging")
        {
            curAlpha = e.CommandArgument.ToString();
            sqry = sqry + " and i.lastname like '" + e.CommandArgument + "%'";
            Session["QRY_alpha"] = " and i.lastname like '" + e.CommandArgument + "%'";
            GridView1.AllowPaging = false;
            BindData();
            SaveStates();
            //this.SqlDataSource1.SelectCommand = "Select * from [Table_1] WHERE theName LIKE '" + e.CommandArgument + "%'";
        }
        if (e.CommandName == "PrintSF330")
        {
            SaveStates();
            Response.Redirect("~/ReportViewer.aspx?EmpID=" + e.CommandArgument.ToString() + " ");
        }
        else if (e.CommandName == "Select")
        {

                SaveStates();
                loadECD(e.CommandArgument.ToString());
        }

    }
    //protected override object SaveViewState()
    //{
    //    ViewState["alphacond"] = alphacond;
    //    return base.SaveViewState();
    //}
    //protected override void LoadViewState(object savedState)
    //{
    //    if (Page.IsPostBack)
    //    {
    //        base.LoadViewState(savedState);
    //        alphacond = ViewState["alphacond"].ToString();
    //    }
    //}
    protected void GridView1_RowCreated(object sender, GridViewRowEventArgs e)
    {

        if (e.Row.RowIndex >= 0)
        {
            // e.Row.Attributes.Add("OnClick", "javascript:" + Page.GetPostBackClientEvent(GridView1, "Select$" + e.Row.RowIndex));
            e.Row.Attributes.Add("onmouseover", "this.style.cursor='pointer'");

        }
        if (keyword == "")
        {

            if (e.Row.RowType == DataControlRowType.Footer)
            {

                GridViewRow grv = new GridViewRow(0, 0, DataControlRowType.Pager, DataControlRowState.Normal);

                this.GridView1.Controls[0].Controls.Add(grv);

                TableCell cell = new TableCell();
                grv.Cells.Add(cell);

                if (keyword == "")
                    cell.ColumnSpan = 5;
                else
                    cell.ColumnSpan = 6;
                for (int i = 65; i <= (65 + 25); i++)
                {

                    string s = Char.ConvertFromUtf32(i);
                    if (s == curAlpha)
                    {
                        Label lt = new Label();
                        lt.Text = "[" + s + "]";
                        lt.Font.Bold = true;
                        lt.Font.Size = new FontUnit(12);
                        lt.Style["text-align"] = "middle";

                        cell.Controls.Add(lt);

                    }
                    else
                    {
                        LinkButton lb = new LinkButton();

                        lb.Text = s + " ";

                        lb.CommandArgument = s;

                        lb.CommandName = "AlphaPaging";
                        cell.Controls.Add(lb);
                    }

                }
            }
        }

    }
    protected void btnExportToExcel_Click(object sender, EventArgs e)
    {
        GridView1.Columns[0].Visible = false;
        GridView1.AllowPaging = false;

        BindData();

        GridView1.DataBind();

        GridViewExportUtil.Export("ReportResultsPage.xls", this.GridView1);

        GridView1.AllowPaging = true;

        BindData();
        GridView1.Columns[0].Visible = false;
    }
    private void SaveStates()
    {
        if (Session["QRY_alpha"] == null) Session["QRY_alpha"] = "";

        sqry = Session["QRY_CONDITIONS"].ToString();
        origQry = Session["QRY_CONDITIONS"].ToString();
        clsUser user = (clsUser)Session["CurrentUser"];

        if (user.IsSuperAdmin && sqry == "ALL")
        {
            sqry = string.Format(" where ifnull(i.activestatus,0) = {0}", ddStatus.SelectedIndex == 0 ? "1" : "0") + Session["QRY_alpha"].ToString();
            origQry = string.Format(" where ifnull(i.activestatus,0) = {0}", ddStatus.SelectedIndex == 0 ? "1" : "0");
        }
        else if (sqry == "ALL")
        {
            sqry = " where ifnull(i.activestatus,0) = 1 " + Session["QRY_alpha"].ToString();
            origQry = " where ifnull(i.activestatus,0) = 1 ";
        }
        else
        {
            sqry = Session["QRY_CONDITIONS"].ToString() + Session["QRY_alpha"].ToString();
            origQry = Session["QRY_CONDITIONS"].ToString();
        }

        string tmp = "";
        tmp = sqry + "|" +
              scolumn + "|" +
              keyword + "|" +
              GridView1.SelectedIndex.ToString() + "|" +
              GridView1.PageIndex.ToString() + "|" +
              ddStatus.SelectedIndex.ToString() + "|" +
              curAlpha  + "|" +
              origQry;

        Session["PrevState"] = tmp;
    }
    public void LoadStates()
    {

        string tmp = (string)Session["PrevState"];
        if (tmp == null)
        {
            return;
        }
        string[] arr = tmp.Split(new char[] { '|' });
        sqry = arr[0];
        scolumn = arr[1];
        keyword = arr[2];
        GridView1.SelectedIndex = Convert.ToInt32(arr[3]);
        GridView1.PageIndex = Convert.ToInt32(arr[4]);
        ddStatus.SelectedIndex = Convert.ToInt32(arr[5]);
        curAlpha = arr[6];
        origQry = arr[7];
    }
    void loadECD(string _idno)
    {
        SaveStates();
        Response.Redirect("~/ECDMain.aspx?i=" + _idno);
    }
    protected void btnbacksearch_Click(object sender, EventArgs e)
    {

        Response.Redirect("~/Default.aspx");
    }
    protected void btnGenerateSF_Click(object sender, EventArgs e)
    {
        SaveStates();
        Response.Redirect("~/ReportViewer.aspx?EmpID=ALL&EmpIDs=" + GetEmpID());
    }
    private string GetEmpID()
    {
        string temp = ""; string empIDs = "";
        foreach (GridViewRow gRow in GridView1.Rows)
        {
            temp = GridView1.DataKeys[gRow.RowIndex].Value.ToString();
            empIDs = (empIDs == "" ? empIDs : empIDs + ",") + temp;

        }
        return "(" + empIDs + ")";
    }
    protected void GridView1_RowDataBound(object sender, GridViewRowEventArgs e)
    {
        if  (e.Row.RowType == DataControlRowType.DataRow && keyword !="") 
            e.Row.Cells[5].Text = e.Row.Cells[5].ToString().Replace(keyword,"<span style=//background-color: #FFFF00;//>" + keyword + "</span>");
    }
     public string HighlightText(string InputTxt)
    {
    // This function is called whenever text is displayed in the FirstName and LastName
    // fields from our database. If we're not searching then just return the original
        // input, this speeds things up a bit
        if (string.IsNullOrEmpty(keyword))
        {
            return InputTxt;
        } 
        else 
        {
            // Otherwise create a new regular expression and evaluate the FirstName and
            // LastName fields against our search string.
            Regex ResultStr = default(Regex);
            ResultStr = new Regex(keyword.Replace(" ", "|"), RegexOptions.IgnoreCase);
            return ResultStr.Replace(InputTxt, new MatchEvaluator(ReplaceWords));
        }
    }
    public string ReplaceWords(Match m)
    {
        // This match evaluator returns the found string and adds it a CSS class I defined
        // as 'highlight'
        return "<span class=highlight>" + m.ToString() + "</span>";
    }

    //protected void GridView1_RowDataBound1(object sender, GridViewRowEventArgs e)
    //{

    //    if ((e.Row.RowType == DataControlRowType.DataRow))
    //    {
    //        //adding an attribut for onclick event on the check box in the hearder and passing the ClientID of the Select All checkbox
    //        ((LinkButton)e.Row.FindControl("lnkResume")).Attributes.Add("onclick", "javascript:OpenFile('" + GridView1.DataKeys[e.Row.RowIndex].Value + "-" + keyword + "')");
    //    }
    //}

    protected void btnGenWord_Click(object sender, EventArgs e)
    {
        GridView1.AllowPaging = false;
        GridViewExportUtil.ExportWord("ReportResultsPage.doc", this.GridView1);
        GridView1.AllowPaging = true;
    }
    protected void GridView1_Sorted(object sender, EventArgs e)
    {
        BindData();
    }
    protected void ddStatus_SelectedIndexChanged(object sender, EventArgs e)
    {
        sqry = sqry + " and i.lastname like '" + curAlpha + "%'";
        BindData();
    }
} 
```

请有人可以帮助我。提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T21:47:26.890

使用 RemoveAt() 后需要重新绑定 gridview

```
GridView1.Columns.RemoveAt(0);
GridView1.DataBind(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-03T16:15:45.527

当用户单击导出到 excel 时，您可以禁用删除按钮，将其导出并在导出后重新启用

```
 GridView1.AutoGenerateDeleteButton = false;
    GridView1.DataBind(); 
    GridView1.RenderControl(htmlWrite);
    Response.Write("<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" />"); 
```

# java - 无法将连接强制转换为 oracle.jdbc.OracleConnection

> ID：15483356
> 
> 赞同：17
> 
> 时间：2013-03-18T17:42:49.273
> 
> 标签：java, oracle, hibernate, jdbc, jndi

为什么 java.sql.Connection 不能在下面的代码中转换为 oracle.jdbc.OracleConnection？

我的主要目标是将新用户名传递给 Oracle 连接并将其保存在例如“osuser”列中的“SESSION”表中，因为我想跟踪 DB 用户更改并将其显示在表中。

```
@Repository
public class AuditLogDAOImpl implements AuditLogDAO {

    @PersistenceContext(unitName="myUnitName")
    EntityManager em;

    @Resource(name = "dataSource")
    DataSource dataSource;

    public void init() {

        try {
            Connection connection = DataSourceUtils.getConnection(dataSource);
            OracleConnection oracleConnection = (OracleConnection) connection; //Here I got cast exception!

            String metrics[] = new String[OracleConnection.END_TO_END_STATE_INDEX_MAX];
            metrics[OracleConnection.END_TO_END_CLIENTID_INDEX] = "my_new_username";

            oracleConnection.setEndToEndMetrics(metrics, (short) 0);

            java.util.Properties props = new java.util.Properties();
            props.put("osuser", "newValue");

            oracleConnection.setClientInfo(props);

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
} 
```

这是错误日志：

```
10:42:29,251 INFO  [STDOUT] org.jboss.resource.adapter.jdbc.jdk6.WrappedConnectionJDK6@bcc8cb
10:42:51,701 ERROR [STDERR] java.lang.ClassCastException: $Proxy286 cannot be cast to oracle.jdbc.OracleConnection 
```

通常在这种情况下我有两个问题：

*   为什么从 Connection 转换到 OracleConnection 失败和
*   实现我的意图的最佳方法是什么（我的意思是在 Oracle DB 中将新用户名设置为 v$session.osuser？

我使用 Oracle 11g、Hibernate（使用实体管理器）、通过 jndi 的数据源。

请帮忙，谢谢！

## 编辑：

经过一些改进后，铸造问题仍然存在。

改进：

```
Connection connection = DataSourceUtils.getConnection(dataSource);
connection = ((org.jboss.resource.adapter.jdbc.WrappedConnection)connection).getUnderlyingConnection();
OracleConnection oracleConnection = (OracleConnection) connection; 
```

错误：

```
java.lang.ClassCastException: $Proxy287 cannot be cast to org.jboss.resource.adapter.jdbc.WrappedConnection 
```

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-03-18T17:55:55.687

您正在检索的连接可能是一个包装的连接。

如果您*确实*需要获取底层 Oracle 连接，您应该使用：

```
if (connection.isWrapperFor(OracleConnection.class)){
   OracleConnection oracleConnection= connection.unwrap(OracleConnection.class);  
}else{
   // recover, not an oracle connection
} 
```

和方法从 Java 1.6 开始可用`isWrapperFor`，`unwrap`并且应该由 A/S 连接包装器有意义地实现。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-18T17:46:41.177

连接池通常有一个围绕真实连接实例的包装器，这就是你的转换失败的原因。

无论如何，您正在做的事情都行不通，因为仅在建立连接时才检查属性实例中的参数。由于您的连接已经处于活动状态，因此它不会改变任何内容。

您需要使用[`DBMS_APPLICATION_INFO.SET_CLIENT_INFO()`](http://docs.oracle.com/cd/B19306_01/appdev.102/b14258/d_appinf.htm#CHEJCFGG)才能更改现有连接。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-02-28T23:56:02.913

这仅适用于通过搜索如何在 OracleConnection 中设置指标来这里的人，我在这方面花费了大量时间，因此可能会对某人有所帮助。

获得“连接”后，这应该可以工作：

```
DatabaseMetaData dmd = connection.getMetaData();
Connection metaDataConnection = null;

if(dmd != null)
{
    metaDataConnection = dmd.getConnection();
}

if(!(metaDataConnection instanceof OracleConnection))
{
    log.error("Connection is not instance of OracleConnection, returning");
    return; /* Not connection u want */
}

OracleConnection oraConnection = (OracleConnection)metaDataConnection;

String[] metrics = new String[END_TO_END_STATE_INDEX_MAX]; // Do the rest below... 
```

它适用于 OracleConnection，但在设置指标时我遇到了差异问题：

```
short zero = 0;
oraConnection.setEndToEndMetrics(metrics, zero); 
```

通过我设置指标几次的方法代理连接后，我得到：

```
java.sql.SQLRecoverableException: No more data to read from socket 
```

但我认为这与一些 Spring 接线初始化或连接池有关。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-09-26T07:44:34.140

您可以访问 Wrapper 内部的 OracleObject，在这种情况下，包装器类型是 NewProxyConnection：

（我在我的项目中使用过它，它有效......没有谜团，只需使用反射）

```
Field[] fieldsConn= connection.getClass().getDeclaredFields();

Object innerConnObject = getFieldByName(fieldsConn,"inner").get(connection);

if(innerConnObject instanceof OracleConnection ){
  OracleConnection oracleConn = (OracleConnection)innerConnObject;
 //OracleConnection unwrap = ((OracleConnection)innerConnObject).unwrap();
  // now you have the OracleObject that the Wrapper 
}

//Method: Set properties of the ooject accessible.
 public static  Field getFieldByName(Field[] campos, String name) {
    Field f = null;
    for (Field campo : campos) {
        campo.setAccessible(true);
        if (campo.getName().equals(name)) {
            f = campo;
            break;
        }
    }
    return f;
 } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-18T17:49:38.367

我在使用 spring 获取连接时遇到了这个问题。通常，每一层都在基本类上添加一个包装器。我刚刚完成了 connection.getClass().getName() 以查看正在重新调整的连接的运行时类型。它将是一个包装器/代理，您可以通过它轻松找到获取基本 OracleConnection 类型的方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-10-16T04:24:30.730

尝试以下

我遇到了同样的问题。我们使用的是 spring，它有一个名为 NativeJdbcExtractor 的类。它有许多实现，以下一个适用于 TomCat。Jboss 有一个特定的实现，称为 JBossNativeJdbcExtractor

```
<bean id="jdbcExtractor" class="org.springframework.jdbc.support.nativejdbc.CommonsDbcpNativeJdbcExtractor"></bean> 
```

在您的 DAO 中，您可以注入 bean 并使用以下方法

```
protected NativeJdbcExtractor jdbcExtractor;
Connection conn=jdbcExtractor.getNativeConnection(oracleConnection); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-05-03T07:34:26.547

经过反复试验。这种方式有效：

```
 DelegatingConnection delConnection = new DelegatingConnection(dbcpConnection);
    oraConnection = (oracle.jdbc.OracleConnection)delConnection.getInnermostDelegate(); 
```

但是这种方式为 oraConnection 返回了一个空指针：

```
DelegatingConnection delConnection = (DelegatingConnection) dbcpConnection;
    oraConnection = (oracle.jdbc.OracleConnection)delConnection.getInnermostDelegate(); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-08-19T21:09:57.137

不确定我的情况是否相关，但对于我的项目，简单地更改数据库配置设置实际上会导致 unwrap 失败！

我正在使用带有 Scala 的 Play 框架；这**仅在[logSql=false](https://www.playframework.com/documentation/2.5.x/JavaDatabase)**时对我有用：

```
db.withConnection { implicit c  =>
  val oracleConnection = c.unwrap(classOf[OracleConnection])
} 
```

*（这只是展开 OracleConnection 的 Scala 版本）*

当我设置**logSql=true**时，我得到：

> com.sun.proxy.$Proxy17 无法转换为 oracle.jdbc.OracleConnection java.lang.ClassCastException: com.sun.proxy.$Proxy17 无法转换为 oracle.jdbc.OracleConnection

所以关于[logSql 配置](https://www.playframework.com/documentation/2.5.x/JavaDatabase)的一些东西实际上会导致 unwrap 失败。不知道为什么。

无论使用哪种配置，我的连接对象都是：

> HikariProxyConnection@1880261898 包装 oracle.jdbc.driver.T4CConnection@6b28f065

`isWrapperFor(OracleConnection)`在这两种情况下都是正确的

Hikari Connection Pool 和 Bone CP 会发生这种情况。也许这是 Oracle JDBC 中的一个错误？

根据*MA​​NIFEST.MF的 Oracle JDBC 驱动程序版本*

> 实现版本：11.2.0.3.0
> 存储库 ID：JAVAVM_11.2.0.4.0_LINUX.X64_130711

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2016-02-19T05:50:33.877

以下工作可以绕过 AQ 的 TopicConnection.getTopicSession => JMS-112

```
//DEBUG: Native DataSource : weblogic.jdbc.common.internal.RmiDataSource
con = DataSource.getConnection();
debug("Generic SQL Connection: " + con.toString());               
//DEBUG: Generic Connection: weblogic.jdbc.wrapper.PoolConnection_oracle_jdbc_driver_T4CConnection
if (con != null && con.isWrapperFor(OracleConnection.class)) {
  WebLogicNativeJdbcExtractor wlne = new WebLogicNativeJdbcExtractor();//org.springframework to the rescue!!
  java.sql.Connection nativeCon = wlne.getNativeConnection(con);
  this.oraConnection = (OracleConnection) nativeCon;
  debug("Unwrapp SQL Connection: " + this.oraConnection.toString());
}

//DEBUG: Native Connection: oracle.jdbc.driver.T4CConnection è 
```

现在我可以在没有 JMS-112 的 AQ-Factory 中使用它

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2014-12-04T04:39:07.903

尝试像下面一样投射

```
WrappedConnectionJDK6 wc = (WrappedConnectionJDK6) connection;
connection = wc.getUnderlyingConnection(); 
```

# arrays - MPI - 发送数组的段

> ID：15483360
> 
> 赞同：4
> 
> 时间：2013-03-18T17:43:09.557
> 
> 标签：arrays, mpi, send, stride

所以我有一个双打数组。我想发送，比如说每 5 个双倍，到接收过程。所以本质上，我需要一种发送特定双打的方法，它们之间有跨步。除了将双打存储到发送缓冲区之外，是否有执行此操作的功能？制作自己的派生类型会更好吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-18T18:24:56.427

您绝对应该创建一个 MPI 数据类型；它使 MPI 库有机会避免从数组中编组的额外副本，并且在这种情况下使用[MPI_Type_vector()](http://www.mcs.anl.gov/research/projects/mpi/www/www3/MPI_Type_vector.html)非常简单：

```
#include <stdio.h>
#include <stdlib.h>
#include <mpi.h>

int main(int argc, char** argv)
{
    int size, rank;
    const int bigsize=50;
    const int stride = 5;
    const int count = (bigsize + stride - 1)/stride;

    const int sender = 0;
    const int receiver = 1;
    const int mytag = 1;

    MPI_Init(&argc,&argv);
    MPI_Comm_size(MPI_COMM_WORLD,&size);
    MPI_Comm_rank(MPI_COMM_WORLD,&rank);

    if (size < 2) {
        fprintf(stderr,"%s: Require at least two processors.\n", argv[0]);
        MPI_Finalize();
        exit(-1);
    }

    if(rank == sender)
    {
        double bigarray[bigsize];
        for (int i=0; i<bigsize; i++)
            bigarray[i] = 0.;

        for (int i=0; i<bigsize; i+=stride)
            bigarray[i] = i/stride;

        printf("[%d]: ", rank);
        for (int i=0; i<bigsize; i++)
            printf("%lf ", bigarray[i]);
        printf("\n");

        MPI_Datatype everyfifth;

        MPI_Type_vector( count, 1, stride, MPI_DOUBLE, &everyfifth);
        MPI_Type_commit(&everyfifth);

        MPI_Send(bigarray, 1, everyfifth, receiver, mytag, MPI_COMM_WORLD);

        MPI_Type_free(&everyfifth);
    }
    else if( rank == receiver )
    {
        double littlearray[count];

        MPI_Status status;

        MPI_Recv(littlearray, count, MPI_DOUBLE, sender, mytag,
                    MPI_COMM_WORLD, &status);

        printf("[%d]: ", rank);
        for (int i=0; i<count; i++)
            printf("%lf ", littlearray[i]);
        printf("\n");
    }

    MPI_Finalize();

    return 0;
} 
```

编译和运行给出

```
$ mpicc -o vector vector.c -std=c99
$ mpirun -np 2 ./vector
[0]: 0.000000 0.000000 0.000000 0.000000 0.000000 1.000000 0.000000 0.000000 0.000000 0.000000 2.000000 0.000000 0.000000 0.000000 0.000000 3.000000 0.000000 0.000000 0.000000 0.000000 4.000000 0.000000 0.000000 0.000000 0.000000 5.000000 0.000000 0.000000 0.000000 0.000000 6.000000 0.000000 0.000000 0.000000 0.000000 7.000000 0.000000 0.000000 0.000000 0.000000 8.000000 0.000000 0.000000 0.000000 0.000000 9.000000 0.000000 0.000000 0.000000 0.000000 
[1]: 0.000000 1.000000 2.000000 3.000000 4.000000 5.000000 6.000000 7.000000 8.000000 9.000000 
```

# javascript - Javascript/JQuery 在我的 Rails 应用程序中不起作用

> ID：15483362
> 
> 赞同：1
> 
> 时间：2013-03-18T17:43:18.450
> 
> 标签：javascript, jquery, twitter-bootstrap, ruby-on-rails-3.2

我已经尝试了这么久，这是一个问题：

我有一个带有文本框的视图，为了检查我的 JQuery 是否正常工作，我要做的就是在该文本框的值长于 0 时显示一条警报消息。这就是我此刻得到：

**`registers/registration.html.erb`**

```
<script>
    $('input[name="Card_ID"]').keyup(function(){
        if (this.value.length > 0) {
            alert("TEST");}
    });
</script>

<table border="1">
  <%= text_field_tag 'Card_ID',nil,  :autofocus => true %>
  <tr><td>Present</td>
    <td>University ID</td>
    <td>First Name</td>
    <td>Last Name</td>
    <td>Time of Arrival</td>
  </tr>
  <tr>
  <% @studentregister.each do |t| %>
<%= simple_form_for t do |streg| %>
      <td><div class="present"><%= streg.check_box :present, :onChange => "submit()"%></div>
        <%= streg.submit :style => 'display: none' %></td>
            <td><%= streg.label Student.find(t.student_id).university_id %></td>
            <td><%= streg.label Student.find(t.student_id).first_name %></td>
            <td><%= streg.label Student.find(t.student_id).last_name %></td>
            <% if t.time_of_arrival %>
            <td><%= streg.label t.time_of_arrival.strftime('%H:%M:%S%P')%></td>
                <% else %>
            <td><%= streg.label " "%></td>
                <% end %>
             </tr>
    <% end %>
    <% end %>
</table> 
```

出于测试目的，我还将相同的代码（在 CoffeeScript 中）放入相关`JS.COFFEE`文件中以查看它是否有效：

**`registers.js.coffee`**

```
$("input[type=text]").keyup ->
  alert "TEST"  if @value.length > 0 
```

但是不，它仍然不起作用。只有这段代码不起作用，因为当我尝试显示`alert "Test"`或`alert("Test")`页面加载时，它起作用了。

有任何想法吗？

编辑：添加了一些 HTML 源代码以显示它的外观，并查看 HTML 元素：

```
 <div id="main" role="main">
      <div class="container">
        <div class="content">
           <div class="row">
            <div class="span12">

              <script>
    $('input[name="Card_ID"]').keyup(function(){
        if (this.value.length > 0) {
            alert("TEST");}
    });
</script>

<table border="1">
  <input autofocus="autofocus" id="Card_ID" name="Card_ID" type="text" />
      <tr><td>Present</td>
        <td>University ID</td>
        <td>First Name</td>
        <td>Last Name</td>
        <td>Time of Arrival</td>
      </tr>
  <tr>
<form accept-charset="UTF-8" action="/student_registers/9" class="simple_form edit_student_register" id="edit_student_register_9" method="post" novalidate="novalidate">
<div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="&#x2713;" />
<input name="_method" type="hidden" value="put" />
<input name="authenticity_token"   type="hidden" value="c8B0JGs4ZLVILa4a4r4PJJrD/zFcLCDhTLscBKHbFeE=" /></div>
      <td><div class="present">
<input name="student_register[present]" type="hidden" value="0" />
<input checked="checked" id="student_register_present" name="student_register[present]" onChange="submit()" type="checkbox" value="1" /></div>
        <input name="commit" style="display: none" type="submit" value="Update Student register" /></td>
            <td><label class="string optional control-label" for="student_register_w122344112">W122344112</label></td>
            <td><label class="string optional control-label" for="student_register_Daniel">Daniel</label></td>
            <td><label class="string optional control-label" for="student_register_Smith">Smith</label></td>
            <td><label class="string optional control-label" for="student_register_ "> </label></td>
             </tr> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T21:38:05.483

这看起来像是 jQuery[`ready()`](http://api.jquery.com/ready/)函数的工作。尝试将 JavaScript（来自您上面的代码）放在以下代码行中`$(function() { ... });`

*像这样：*

```
$(function() {
    $('input[name="Card_ID"]').keyup(function(){
        if (this.value.length > 0) {
            alert("TEST");
        }
    });
}); 
```

通过这样做，jQuery`ready()`函数*（至少）*让 DOM 有机会在页面上运行（或准备使用）JavaScript 之前加载并准备好。

# knockout.js - 不使用数据绑定时强制使用本机敲除模板引擎

> ID：15483364
> 
> 赞同：2
> 
> 时间：2013-03-18T17:43:22.043
> 
> 标签：knockout.js, datatables

我正在尝试将 KO 与[DataTables](http://www.datatables.net/)一起使用。我正在使用来自 Github 的[这个](https://github.com/CogShift/Knockout.Extensions)项目，它提供了 DataTables 和 KO 之间的集成。该库使用以下命令自己渲染模板行：

```
ko.renderTemplate(rowTemplate, bindingContext.createChildContext(data), null, row, "replaceChildren"); 
```

我希望能够使用 KO 的原生模板引擎来渲染数据，但是我使用的页面也需要使用 jQuery.Templates。当 KO 在页面上找到对 jQuery.Templates 的引用时，它会将其设为默认模板引擎，从而绕过 KO 的本机引擎的使用。

[此处](https://stackoverflow.com/questions/9750724/force-native-knockout-templating)的 StackOverflow 问题讨论了如何在使用“模板”数据绑定语法时指定要使用的模板引擎。但是不使用数据绑定时如何指定模板引擎呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-19T00:24:43.773

您可以`ko.setTemplateEngine(new ko.nativeTemplateEngine());`指定 Knockout 使用的整体模板引擎。这将绕过 Knockout 启用 jQuery 模板引擎的事实，因为它看到插件可用。

# c++ - Netbeans Code Completion 在 C++ 中经常弹出

> ID：15483367
> 
> 赞同：2
> 
> 时间：2013-03-18T17:43:32.020
> 
> 标签：c++, netbeans, drop-down-menu, code-completion

我在使用 netbeans 代码完成时遇到问题。

每当我在一行的末尾（“；”或“{”，取决于上下文），代码完成框就会弹出。这会导致问题，因为在键入后

```
else { 
```

或者

```
int testValue; 
```

等等，等等，我想按回车键转到下一行。但是由于代码完成，当我按下回车时，它会插入我之前声明的变量之一。

有没有办法让代码完成更智能，这样它就不会在这些情况下弹出？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-02-18T15:13:45.757

检查以下内容：“工具 -> 选项 -> 编辑器 -> 代码完成”。C/C++ 标识符的自动弹出触发器的默认值为：

```
.;->;.*;->*;::;new ; 
```

![C/C++ 标识符的自动弹出触发器的默认值](../Images/b9c87cfabc1889187640db3fb9e8d494.png) 检查配置中的值是否包含两个连续的分号

```
;; 
```

或闭合花括号

```
} 
```

并删除它们。如果您想要最多的代码完成而没有完成，请使用：

```
.;->;.*;->*;::;new ;a;b;c;d;e;f;g;h;i;j;k;l;m;n;o;p;q;r;s;t;u;v;w;x;y;z;A;B;C;D;E;F;G;H;I;J;K;L;M;N;O;P;Q;R;S;T;U;V;W;X;Y;Z; 
```

否则恢复到上面提到的默认值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T13:00:44.777

可能值得看一下“代码完成”选项，您可以在**“工具 -> 选项 -> 编辑器 -> 代码完成”**下找到它。

我不确定它是否可以选择为 C++ 代码完成设置计时器。但是，那里有多种选择可能会对您有所帮助。如果你愿意，你可以完全关闭它。

我希望这有帮助。

# c# - 数据导入 - Excel 到 SQL Azure？

> ID：15483369
> 
> 赞同：1
> 
> 时间：2013-03-18T17:43:35.473
> 
> 标签：c#, sql-server, excel, azure-sql-database

是否有任何可用的工具可以轻松地将数据从 Excel 工作表（甚至 Access）导入 SQL Azure？我可以编写一个 C# 脚本（我假设这是目前最好的），但我想我会检查以防万一还有其他工具。我有一个简单的 Excel 表要导入，但它有数万条记录，我宁愿用自动化工具来做。

帮助？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-01-29T18:17:37.760

您还可以使用 SQL Server 导入和导出数据（32 位）将数据从 excel 文件传输到 sql azure 上的表。它非常快。确保在选择目标时，它是 SqlServer 的 .Net Framework 数据提供程序。您还必须设置数据源、用户 ID、密码和初始目录属性。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-19T17:22:04.933

**选项 1，复制和粘贴**

这是一个非常粗略的解决方案，但我以前使用过它，诚然，数据量较小。只需在 Excel 中选择行和列，确保它们与您的数据库表架构相关。复制到剪贴板。在 Visual Studio 中打开与数据库的连接，选择最后一个空行并粘贴。

就像我说的那样，这是一个非常粗略的解决方案，但如果它有效并节省您的时间，那才是最重要的。首先尝试选择少量行，不要忘记排除任何自动递增的列。如果您首先转换为 CSV，您将取消任何可能无法导入表架构的 Excel 格式。老实说，我不知道这种方法将如何处理更大的数据集，显然它将取决于 Excel 文档中的数据、列数等。您可能需要分块移动数据，但很可能是比其他方法更快。

**选项 2，CSV 到 DataTable**

第二种方法需要一些编码，但可以让您更好地控制数据如何映射到数据表。它基本上涉及将文档从 Excel 转换为 CSV，读入循环行的 DataTable 对象并插入到 SQL 数据库表中。

```
Dim dt As DataTable = New DataTable("myData")
Dim DataFile As FileInfo = New FileInfo("c:\myspreadsheet.csv")

Dim MyConnection As New System.Data.OleDb.OleDbConnection("Provider=Microsoft.Jet.OLEDB.4.0;Data Source='" & DataFile.Directory.FullName & "';Extended Properties='text;HDR=NO';Jet OLEDB:Engine Type=96;")
Dim oledataAdapter As OleDbDataAdapter
oledataAdapter = New OleDbDataAdapter("SELECT * FROM [" & DataFile.Name & "]", MyConnection)

oledataAdapter.Fill(dt) 'Bind the csv to the data table

'LOOP AND INSERT HERE...
For Each DataRowObj As DataRow In dt.Rows

Next 
```

# ruby-on-rails - 在 Rails 中使用 PIE.htc

> ID：15483371
> 
> 赞同：2
> 
> 时间：2013-03-18T17:43:39.743
> 
> 标签：ruby-on-rails, css3pie

我正在尝试在我的 Rails 应用程序中使用 PIE，但它不起作用。我将我的 PIE.htc 文件放在我的资产文件夹中名为行为的文件夹中。

```
 -pie-background: linear-gradient(#2c2a2d, #1f1e20);
  behavior: url(assets/behaviours/PIE.htc); 
```

有谁知道这是否是 rails 和 pie 工作的正确路径。这也在 localhost:3000/ 上运行

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-14T16:35:50.873

你的说法几乎是正确的。它应该是：

```
behavior: url(/assets/PIE.htc); 
```

您需要有初始斜线并取出对行为文件夹的引用。

此外，如果您想完全确定 PIE.htc 文件正在加载，请打开它并添加警报，如下所示：

```
<script>alert("PIE works");</script> 
```

如果文件正在加载，应该会出现一个显示消息的弹出窗口。

# mongodb - Mongo 聚合框架与类似 javascript 的链接：性能

> ID：15483374
> 
> 赞同：0
> 
> 时间：2013-03-18T17:43:41.373
> 
> 标签：mongodb, aggregation-framework

我读过聚合框架依赖于“管道”架构，即

```
db.myCollection.aggregate({
  $op1: { ... }
},{
  $op2: { ... }
}) 
```

另一方面，“传统”的 mongo 命令行查询语法也类似于管道：

```
db.myCollection.find({
  field: 'value'
}).filter({
  ...
}).forEach({
  ...
}) 
```

1.  引擎盖下的实现有什么不同吗？
2.  “传统”语法也有点像管道 - 为什么存在替代语法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-18T18:46:31.967

> 引擎盖下的实现有什么不同吗？

很多。例如，第一个在其 C++ 代码中作为聚合框架“在”MongoDB 中运行，而另一个在捆绑的 JS 控制台内的 V8/spidermonkey（取决于您的版本）环境中运行。

值得一提的是，您展示的后一种语法不是在“内部”MongoDB 中运行，而是在 JS 控制台中运行，该控制台具有通过 JS 驱动程序与 MongoDB 交互的能力。

这适用于大多数数据库，例如 MySQL 控制台和许多其他数据库。它们只是捆绑的客户端程序。

> “传统”语法也有点像管道 - 为什么存在替代语法？

因为控制台不是 MongoDB。

# web-services - 适用于 Android 应用程序的 Web 服务。更重要的安全。SOAP 还是 REST？

> ID：15483375
> 
> 赞同：-3
> 
> 时间：2013-03-18T17:43:42.810
> 
> 标签：web-services, security, rest, soap

我需要为 Android 应用程序实现 Web 服务。安全比其他事情更重要。SOAP 或 REST 哪个更值得推荐？

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T17:47:49.177

在我看来，保护您的 API 与您在其下提供的服务无关。您可以使用 OAuth、您自己的两步身份验证、简单的 API 令牌来保护它 - 随心所欲。

我个人的偏好是理解 JSON 的 REST-ful API。XML，如果需要的话。SOAP 用途广泛，但我发现设置和使用起来非常麻烦。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T17:49:23.750

我认为这可能会有所帮助：[Secure Web Services: REST over HTTPS vs SOAP + WS-Security。哪个更好？](https://stackoverflow.com/questions/853620/secure-web-services-rest-over-https-vs-soap-ws-security-which-is-better)

附带说明一下，至少对我而言，REST 在编码和响应时间方面是一个更好的选择。

# java - Java 手动客户端证书身份验证

> ID：15483378
> 
> 赞同：2
> 
> 时间：2013-03-18T17:43:51.720
> 
> 标签：java, authentication, tomcat, client

作为 Java Web 应用程序的一部分，我希望通过浏览器证书实现客户端身份验证。我已经能够找到有关如何在客户端和服务器上生成和安装证书的信息。

在访问方面，我能找到的所有信息似乎都是关于配置对特定路径的访问，例如 www.mydomain.com/securearea 并让服务器处理访问。

但是，我想根据用户是否提供有效的客户端证书来实现自定义行为，而不是一揽子访问块。本质上，我希望能够创建一个像*hasValidClientCertificate()这样的方法*

不幸的是，我找不到任何关于如何以编程方式检查客户端是否在 Java 中具有有效证书的参考。我正在使用Tomcat。这不是我的强项，因此非常感谢任何提示或建议。

非常感谢您的时间

保罗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T19:26:45.553

您需要执行几个步骤

1）配置tomcat进行客户端证书认证（在server.xml中）：

```
<Connector port="8443" 
protocol="HTTP/1.1" 
SSLEnabled="true"          
maxThreads="150" 
minSpareThreads="25" 
maxSpareThreads="75"
enableLookups="false" 
disableUploadTimeout="true"
acceptCount="100" 
keyAlias="tomcat"
debug="0" 
scheme="https" 
secure="true"
clientAuth="want" 
sslProtocol="TLS" 
keystoreFile="server.keystore" keystorePass="changeit" 
truststoreFile="trust.keystore" truststorePass="changeit"/> 
```

[http://tomcat.apache.org/tomcat-7.0-doc/config/http.html](http://tomcat.apache.org/tomcat-7.0-doc/config/http.html)关于clientAuth属性的澄清：

*如果您希望 SSL 堆栈请求客户端证书，则设置为**需要**，但如果没有提供，则不会失败。*

请参阅 Tomcat 身份验证以更好地解释如何为 SSL 配置 Tomcat：http: [//tomcat.apache.org/tomcat-7.0-doc/ssl-howto.html](http://tomcat.apache.org/tomcat-7.0-doc/ssl-howto.html)

2) 使用以下代码实现您的 hasValidClientCertificate()：

```
X509Certificate[] crts = (X509Certificate[]) request.getAttribute("javax.servlet.request.X509Certificate");
if (crts!= null && crts.length > 0) {
    return true;        
} 
```

3）如果需要访问用户证书请访问

```
X509Certificate userCert = crts [0]; 
```

# javascript - 将两个相似的点击事件合并为一个

> ID：15483383
> 
> 赞同：0
> 
> 时间：2013-03-18T17:44:10.170
> 
> 标签：javascript, jquery

这是编写我的 javascript 时经常出现的问题：我有事件：

```
$(document).on('click','.mi_piace_brick',function(){ 
   $this = $(this).children(),
   $that = $(this),
   i = s.get_current_step_id(),
   j = $that.attr('data-class'),
   counter = parseInt($('.like_counter_'+i+'_'+j).first().find('p').text());

   if($this.hasClass('liked')){
      $this.removeClass('liked');
   $('.like_counter_'+i+'_'+j).find('p').text(--counter);
   }
   else{
     $this.addClass('liked');
   $('.like_counter_'+i+'_'+j).find('p').text(++counter);
   }
  }) 
```

和

```
 $(document).on('click','.pref_brick',function(){ 
    $this = $(this).children(),
    $that = $(this),
    i = s.get_current_step_id(),
    j = $that.attr('data-class'),
    counter = parseInt($('.fav_counter_'+i+'_'+j).first().find('p').text());

        if($this.hasClass('preferito')){
        $this.removeClass('preferito');

        $('.fav_counter_'+i+'_'+j).find('p').text(--counter);
    }
    else{
        $this.addClass('preferito');
            $('.fav_counter_'+i+'_'+j).find('p').text(++counter);
        }
        }) 
```

如您所见，这两个功能基本上非常相似。我经常遇到这种情况。在您看来，有一种方法可以只使用一个绑定来解决问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T17:46:58.557

为这些元素分配一个类，它们将共享并将单击事件附加到该共享类。如果需要区分两者，请使用元素的数据属性。

```
<input class="sharedClass" data-parameter="enabled" />

$(document).on('click', '.sharedClass', function(eventObject) {
    eventObject.preventDefault();
    if ($(eventObject.target).data('parameter') == 'enabled') {
        // your logic for "enabled" element
    }
}); 
```

# git - 如何使用 git 再次跟踪远程分支

> ID：15483384
> 
> 赞同：0
> 
> 时间：2013-03-18T17:44:11.723
> 
> 标签：git

我检查了远程分支 Design0.5：该分支上的最后一个远程提交与本地顶部提交相同，此处标记为（无分支）。所以在本地，Design0.5 比我希望的位置落后 5 次提交；而且远程分支 remotes/origin/Design0.5 也显示在它的实际位置后面。这真的让我很困惑。我在这里真正想做的就是跟踪对存储库的远程更改。我如何才能达到我真正在远程跟踪 Design0.5 的状态？我可以放弃并检查其他地方的分支，但是我的本地目录中有未跟踪的二进制文件，我不想移动它们；如果我可以在不求助于它的情况下修复我的本地，它也可能有助于我更好地理解 git。

我查看了相关的查询[Why did git set us on (no branch)?](https://stackoverflow.com/questions/2498458/why-did-git-set-us-on-no-branch) 并在那里尝试了各种建议（例如变基）但没有成功。

我的最后两个命令是

```
$ git pull --rebase origin Design0.5

$ git branch -av
* (no branch)              130bef1 Debugging Program.fs note point at which crash occurs
  Design0.3                f7f6179 Updated tests and comments
  Design0.5                578ff32 [behind 5] updated project to include new files
  master                   578ff32 [behind 5] updated project to include new files
  remotes/origin/Design0.1 f7f6179 Updated tests and comments
  remotes/origin/Design0.3 f7f6179 Updated tests and comments
  remotes/origin/Design0.5 f98e08e Added definition of FOO
  remotes/origin/master    578ff32 updated project to include new files 
```

毫无疑问，我没有正确理解 git 分支是如何工作的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-18T18:11:15.680

> 我如何才能达到我真正在远程跟踪 Design0.5 的状态？

您*正在*跟踪远程分支。这就是为什么您会获得有关本地分支机构过时程度的信息的原因。告诉你，你的`[behind 5]`本地分支比它正在跟踪的一个提交落后了 5 个提交，即远程分支。

跟踪分支不会自动更新到远程分支的状态；这样做会消除您对自己的本地分支机构的控制权。

那么什么是远程跟踪分支呢？远程跟踪分支实际上就像任何本地分支一样：它是一个（可移动的）指针，指向存储库历史中的提交。唯一的区别是远程跟踪分支还知道它跟踪哪个远程分支。这种跟踪实际上只是一个“噱头”，用于获取有关本地分支与远程分支有何不同的信息（后面/前面的信息），并快速了解它必须从哪个远程提取或推送到哪个远程。除此之外，没有额外的魔法。

现在，回到你的情况；您目前处于分离的 HEAD 上。很难说你到底为什么会到那个地方。我假设您启动了`pull --rebase`，这将重写您的本地提交，并且您遇到了冲突。在这种情况下，变基暂停并等待您解决冲突，然后继续变基。A`git status`应该有助于在这里确认这一点。如果你知道你不想保留你在分离的 HEAD 上所做的任何事情，那么你可以简单地检查一个分支并恢复到正常状态。

要实际更新您的远程跟踪分支（或任何真正的分支），您只需检查它们并运行 a`git merge origin/otherbranch`将其更新为您获取的远程分支的状态，或者您只需运行`git pull`以获取跟踪的远程并获取最新的更新版本拉进来。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T18:18:09.817

The 'commits behind' messages always used to confuse me because I'd always been taught that git pull is "the same as git fetch followed by git merge." As far as the current branch is concerned this may be true, however doing git pull doesn't actually update the local reference remotes/origin/your-branch. If you do git fetch, the references should jump back into line.

# c# - 如何将图片框的多个图像存储在数据库中？

> ID：15483386
> 
> 赞同：-1
> 
> 时间：2013-03-18T17:44:21.850
> 
> 标签：c#

我在我的 Windows 窗体应用程序 c# 中有动态生成的图片框。它可能有 3、4、5 或任何数量的图片框（取决于用户）现在我想将所有这些图片框图像保存在数据库中的单个字段中！如何？？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-18T17:56:01.413

“...我想将所有这些图片框图像保存在**单个字段的数据库中！** ...”

不要这样做。您将很难恢复单个图像。

仅出于此目的将每个图像存储在单独的表中（因为图像的实际数量会有所不同）并通过公共键连接到该表。

在 SQL Server 中存储图像很容易。请参阅[此](http://www.codeproject.com/Articles/354639/Storing-and-Retrieving-Images-from-SQL-Server-Usin)示例。

# java - 使用 ActionListener 交换网格中的两个图标

> ID：15483392
> 
> 赞同：0
> 
> 时间：2013-03-18T17:44:30.990
> 
> 标签：java, multidimensional-array, awt, actionlistener, chess

我试图通过首先单击该块然后单击该正方形以将其移动来将一块从网格中的一个正方形移动到另一个。

如何保存第一个图标的位置，然后与第二个交换？

目前我正在查看这段代码，它只是将棋子向左移动一格：

```
public void actionPerformed(ActionEvent e)  
{
for ( x=0; x<8; x++)
        for( y=0; y<8; y++) {
        if(e.getSource() == board[x][y])
        ((ChessSquare)e.getSource()).swap(board[x][y-1]);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T17:51:08.860

*   存储一个标志，指示这是“拖动”还是“拖放” ¹。
*   如果'drag'存储原始坐标并将标志更改为'drop'。
*   如果“drop”读取源的坐标，请随意使用它们并将标志设置回“drag”。

* * *

1.  我的意思是像声明 a`boolean drag`并根据需要设置它`true`/ `false`。

> ..存储坐标的最佳位置？

我会使用 2 个`int`属性，但如果你想滥用一个`Dimension`对象，只有一个可以同时存储 x 和 y 坐标。

..不，废弃它。使用 mKorbel 指示的客户端属性似乎更“整洁”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T17:52:54.863

*   我们需要一个布尔标志来跟踪“点击”
*   如果 flag = false 则为第一次单击，否则为第二次单击（这是我们将执行交换的地方）。

    ```
    public void actionPerformed(ActionEvent e)  
    {
        int xPos1,xPos2,yPos1,yPos2;
        if(!flag)
        {
          for ( x=0; x<8; x++)
          {
              for( y=0; y<8; y++) 
              {
                if(e.getSource() == board[x][y])
                {
                  xPos1 = x; // Source icon cordinates.
                  yPos2 = y;
                  break;
                }
              }
          }
          flag = true;
        }
        else
        {
          for ( x=0; x<8; x++)
          {
            for( y=0; y<8; y++) 
            {
              if(e.getSource() == board[x][y])
              {
                xPos2 = x;  // Target icon cordinates.
                yPos2 = y;
                break;
              }
            }
          }

          // Swapping code add your version of this swapping code here.
          // Swap source with target.
          Icon temp = board[xPos1][yPos1]
          board[xPos1][yPos1] = board[xPos2][yPos2];
          board[xPos2][yPos2] = temp;          
          // ----------------- End Swap----------------  

          flag = false; // ready for next swap operation.
      } 
    ```

    }

# ruby - ruby / watir webdriver - url encoding for spaces, etc

> ID：15483394
> 
> 赞同：0
> 
> 时间：2013-03-18T17:44:35.067
> 
> 标签：ruby, url, encoding, webdriver, watir

I'm trying to follow with Watir links with spaces and "http://"-s in them. Doing it manually I'm able to copy-paste something like that:

```
http://somewebsite.com/car%20navigation%20systems/products~NS-1~linkin_id-8016137~cid-3220953854?ef_id=test:@a-b 
```

into the browser address bar, and open the proper page. When I assign this string to a variable url_string in ruby code and do "puts url_string" I see that string in exactly this way (with %20-s in it). When I use it with watir webdriver's "b.goto url_string" it shows "car navigation systems" instead of "car%20navigation%20systems" in the browser, and obviously it doesn't work.

When I "require open-uri" and instead of doing "b.goto url_string" use "b.goto URI::encode(url_string)" I see in the browser that %20 was replaced with %2520 ("car%2520navigation%2520systems") – and again it's not working.

What should I do with the strings like that (which works OK with manual copy-pasting into a browser) to properly use them with b.goto?

```
http://somewebsite.com/car%20navigation%20systems/products~NS-1~linkin_id-8016137~cid-3220953854?ef_id=test:@a-b

http://somewebsite.com/somepage.cmp?bm=513&BEFID=1398&aon=%5E1&MerchantID=26574&crawler_id=1903439&dealId=U4KvhohLLfNITUSw9xH1PA%3D%3D&url=http%3A%2F%2Flink.mercent.com%2Fredirect.ashx%3Fmr%3AmerchantID%3DREI%26mr%3AtrackingCode%3D4B0E6F02-7411-E111-804A-A8C6AF702B72%26mr%3AtargetUrl%3Dhttp%3A%2F%2Fwww.rei.com%2FOM%2Fsku%2F8108320014%253fcm_mmc%253dcse_shopping-_-datafeed-_-product-_-na%26sdc_id%3D%7Bsdc_id%7D&linkin_id=8011139&Issdt=&searchID=On29U8JKSm&DealName=Garmin+Edge+800+Wireless+Bike+Computer+Color+BLACK&dlprc=449.95&AR=23&NG=29&NDP=40&PN=1&ST=7&FPT=DNSR&NDS=&NMS=&MRS=&PD=104443840&brnId=2455&IsFtr=0&IsSmart=0&op=&CM=&RR=23&IsLps=0&code=&acode=602&category=&HasLink=&ND=&MN=&GR=&lnkId=&SKU=8108320014&IsGtb=0&SPT=CROSSGV&MNID=22406&EF=TEST300%3A3&sig=e917ca16cfc85bedd51b2445ee2aa566f1ccc319&CT=14 
```

UPDATE: so far b.goto url_string.gsub("%20", "+") worked for most of the URLs.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T19:07:19.453

This turned out to be working:

```
url_string = "http://somewebsite.com/car%20navigation%20systems/products~NS-1~linkin_id-8016137~cid-3220953854?ef_id=test:@a-b"
b.goto url_string.gsub("%20", "+") 
```

# python - Python：如何拟合曲线

> ID：15483396
> 
> 赞同：1
> 
> 时间：2013-03-18T17:44:41.510
> 
> 标签：python, numpy, matplotlib, scipy

我有以下代码为三组不同的时间范围重叠绘制三组数据，计数率与时间：

```
#!/usr/bin/env python

from pylab import rc, array, subplot, zeros, savefig, ylim, xlabel, ylabel, errorbar, FormatStrFormatter, gca, axis
from scipy import optimize, stats
import numpy as np
import pyfits, os, re, glob, sys

rc('font',**{'family':'serif','serif':['Helvetica']})
rc('ps',usedistiller='xpdf')
rc('text', usetex=True)
#------------------------------------------------------

tmin=56200
tmax=56249

data=pyfits.open('http://heasarc.gsfc.nasa.gov/docs/swift/results/transients/weak/GX304-1.orbit.lc.fits')

time  = data[1].data.field(0)/86400\. + data[1].header['MJDREFF'] + data[1].header['MJDREFI']
rate  = data[1].data.field(1)
error = data[1].data.field(2)
data.close()

cond = ((time > tmin-5) & (time < tmax))
time=time[cond]
rate=rate[cond]
error=error[cond]

errorbar(time, rate, error, fmt='r.', capsize=0)
gca().xaxis.set_major_formatter(FormatStrFormatter('%5.1f'))

axis([tmin-10,tmax,-0.00,0.45])
xlabel('Time, MJD')
savefig("sync.eps",orientation='portrait',papertype='a4',format='eps') 
```

因为，这样，情节太混乱了，我想拟合曲线。我尝试使用 UnivariateSpline，但这完全弄乱了我的数据。请问有什么建议吗？我应该先定义一个函数来适应这些数据吗？我还寻找“最小二乘”：这是解决这个问题的最佳方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T14:21:46.683

我就是这样解决的：

```
#!/usr/bin/env python

import pyfits, os, re, glob, sys
from scipy.optimize import leastsq
from numpy import *
from pylab import *
from scipy import *
rc('font',**{'family':'serif','serif':['Helvetica']})
rc('ps',usedistiller='xpdf')
rc('text', usetex=True)
#------------------------------------------------------

tmin = 56200
tmax = 56249
pi = 3.14
data=pyfits.open('http://heasarc.gsfc.nasa.gov/docs/swift/results/transients/weak/GX304-1.orbit.lc.fits')

time  = data[1].data.field(0)/86400\. + data[1].header['MJDREFF'] + data[1].header['MJDREFI']
rate  = data[1].data.field(1)
error = data[1].data.field(2)
data.close()

cond = ((time > tmin-5) & (time < tmax))
time=time[cond]
rate=rate[cond]
error=error[cond]

gauss_fit = lambda p, x: p[0]*(1/(2*pi*(p[2]**2))**(1/2))*exp(-(x-p[1])**2/(2*p[2]**2))+p[3]*(1/sqrt(2*pi*(p[5]**2)))*exp(-(x-p[4])**2/(2*p[5]**2)) #1d Gaussian func
e_gauss_fit = lambda p, x, y: (gauss_fit(p, x) -y) #1d Gaussian fit
v0= [0.20, 56210.0, 1, 0.40, 56234.0, 1] #inital guesses for Gaussian Fit, just do it around the peaks
out = leastsq(e_gauss_fit, v0[:], args=(time, rate), maxfev=100000, full_output=1) #Gauss Fit
v = out[0] #fit parameters out
xxx = arange(min(time), max(time), time[1] - time[0])
ccc = gauss_fit(v, xxx) # this will only work if the units are pixel and not wavelength
fig = figure(figsize=(9, 9)) #make a plot
ax1 = fig.add_subplot(111)
ax1.plot(time, rate, 'g.') #spectrum
ax1.plot(xxx, ccc, 'b-') #fitted spectrum
savefig("plotfitting.png")

axis([tmin-10,tmax,-0.00,0.45]) 
```

从[这里](http://www.krioma.net/wp/blog/2011/12/multiple-gaussian-fitting-in-python.php)。

如果我想用不同的函数来拟合曲线的上升和衰减部分呢？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T05:52:23.783

我用这个来装。它是从互联网上的某个地方改编的，但我忘记了在哪里。

```
from __future__ import print_function
from __future__ import division
from __future__ import absolute_import

import numpy

from scipy.optimize.minpack import leastsq

### functions ###

def eq_cos(A, t):
    """
    4 parameters
    function: A[0] + A[1] * numpy.cos(2 * numpy.pi * A[2] * t + A[3])
    A[0]: offset
    A[1]: amplitude
    A[2]: frequency
    A[3]: phase
    """
    return A[0] + A[1] * numpy.cos(2 * numpy.pi * A[2] * t + numpy.pi*A[3])

def linear(A, t):
    """
    A[0]: y-offset
    A[1]: slope
    """
    return A[0] + A[1] * t  

### fitting routines ###

def minimize(A, t, y0, function):
    """
    Needed for fit
    """
    return y0 - function(A, t)

def fit(x_array, y_array, function, A_start):
    """
    Fit data

    20101209/RB: started
    20130131/RB: added example to doc-string

    INPUT:
    x_array: the array with time or something
    y-array: the array with the values that have to be fitted
    function: one of the functions, in the format as in the file "Equations"
    A_start: a starting point for the fitting

    OUTPUT:
    A_final: the final parameters of the fitting

    EXAMPLE:
    Fit some data to this function above
    def linear(A, t):
        return A[0] + A[1] * t  

    ### 
    x = x-axis
    y = some data
    A = [0,1] # initial guess
    A_final = fit(x, y, linear, A)
    ###

    WARNING:
    Always check the result, it might sometimes be sensitive to a good starting point.

    """
    param = (x_array, y_array, function)

    A_final, cov_x, infodict, mesg, ier = leastsq(minimize, A_start, args=param, full_output = True)

    return A_final

if __name__ == '__main__':

    # data
    x = numpy.arange(10)
    y = x + numpy.random.rand(10) # values between 0 and 1

    # initial guesss
    A = [0,0.5]

    # fit 
    A_final = fit(x, y, linear, A)

    # result is linear with a little offset
    print(A_final) 
```

# android - ActivityThread.performLaunchActivity(ActivityThread$ActivityClientRecord, Intent) 行：2100 找不到源

> ID：15483403
> 
> 赞同：0
> 
> 时间：2013-03-18T17:44:56.233
> 
> 标签：android, android-layout, android-activity

我已经开始开发一个应用程序，我没有更改类，也没有更改清单，只创建了 xml 布局：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:background="#111111"
android:paddingBottom="@dimen/activity_vertical_margin"
android:paddingLeft="@dimen/activity_horizontal_margin"
android:paddingRight="@dimen/activity_horizontal_margin"
android:paddingTop="@dimen/activity_vertical_margin"
tools:context=".Playing" >

<RelativeLayout
    android:id="@+id/rlcontrols"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true" >

    <Button
        android:id="@+id/bplay"
        android:layout_width="70dp"
        android:layout_height="70dp"
        android:layout_below="@+id/tvalbum"
        android:layout_centerHorizontal="true"
        android:background="@drawable/play"
        android:contentDescription="@+String/play" />

    <Button
        android:id="@+id/bprevious"
        android:layout_width="60dp"
        android:layout_height="60dp"
        android:layout_below="@id/tvalbum"
        android:layout_marginRight="10dp"
        android:layout_toLeftOf="@id/bplay"
        android:background="@drawable/previous"
        android:contentDescription="@+String/play" />

    <Button
        android:id="@+id/bnext"
        android:layout_width="60dp"
        android:layout_height="60dp"
        android:layout_below="@id/tvalbum"
        android:layout_marginLeft="10dp"
        android:layout_toRightOf="@id/bplay"
        android:background="@drawable/next"
        android:contentDescription="@+String/play" />

    <Button
        android:id="@+id/brepeat"
        android:layout_width="40dp"
        android:layout_height="40dp"
        android:layout_alignBottom="@id/bnext"
        android:layout_marginLeft="10dp"
        android:layout_toRightOf="@id/bnext"
        android:background="@drawable/repeat"
        android:contentDescription="@+String/play" />

    <Button
        android:id="@+id/bshuffle"
        android:layout_width="40dp"
        android:layout_height="40dp"
        android:layout_alignBottom="@id/bprevious"
        android:layout_marginRight="10dp"
        android:layout_toLeftOf="@id/bprevious"
        android:background="@drawable/shuffle"
        android:contentDescription="@+String/play" />

    <!-- <SeekBar
        android:id="@+id/songProgressBar"
        android:layout_width="fill_parent"
        android:layout_marginTop="10dp"
        android:layout_height="wrap_content"
        android:progressDrawable="@drawable/progress"
        android:thumb="@drawable/seeker"
        android:layout_below="@id/bplay" /> -->

</RelativeLayout>

<TextView
    android:id="@+id/tvalbum"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_above="@id/rlcontrols"
    android:gravity="center"
    android:text="@string/album"
    android:textSize="20sp" />

<TextView
    android:id="@+id/tvartist"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_above="@id/tvalbum"
    android:gravity="center"
    android:text="@string/artist"
    android:textSize="20sp" />

<TextView
    android:id="@+id/tvtitle"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_above="@id/tvartist"
    android:gravity="center"
    android:text="@string/title"
    android:textSize="25sp" />

<ImageView
    android:id="@+id/ivalbumart"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:layout_above="@id/tvtitle"
    android:contentDescription="@+String/albumart"
    android:src="@drawable/albumart" />
</RelativeLayout> 
```

调试堆栈：

```
Thread [<1> main] (Suspended (exception RuntimeException))  
ActivityThread.performLaunchActivity(ActivityThread$ActivityClientRecord, Intent) line: 2100    
ActivityThread.handleLaunchActivity(ActivityThread$ActivityClientRecord, Intent) line: 2125 
ActivityThread.access$600(ActivityThread, ActivityThread$ActivityClientRecord, Intent) line: 140    
ActivityThread$H.handleMessage(Message) line: 1227  
ActivityThread$H(Handler).dispatchMessage(Message) line: 99 
Looper.loop() line: 137 
ActivityThread.main(String[]) line: 4898    
Method.invokeNative(Object, Object[], Class, Class[], Class, int, boolean) line: not available [native method]  
Method.invoke(Object, Object...) line: 511  
ZygoteInit$MethodAndArgsCaller.run() line: 1006 
ZygoteInit.main(String[]) line: 773 
NativeStart.main(String[]) line: not available [native method] 
```

当我启动活动时说找不到来源

我不知道这意味着什么，所以任何帮助都会非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T13:43:22.387

你试图调试你的代码吗？我有一个类似的问题，看起来像您缺少 Android Vx.jar 文件的源代码。请参阅此链接，它可能会对您有所帮助。 [http://android.opensourceror.org/2010/01/18/android-source/](http://android.opensourceror.org/2010/01/18/android-source/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T18:45:21.087

如果没有您的项目，我只能猜测，但通常这是由于清单文件不正确造成的。确保您的包裹是正确的，然后您需要调用类似于

```
<activity
     android:label="@string/app_name"
     android:name=".MyLaunchActivity" >
     <intent-filter >
          <action android:name="android.intent.action.MAIN" />
          <category android:name="android.intent.category.LAUNCHER" />
     </intent-filter>
 </activity>
 <activity android:name=".My_Second_Activity" >
 </activity> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-04-05T07:34:20.067

我遇到了类似的问题，只是因为我错过了 appcompat_v7 库。就我而言，假设我的项目名称是 Prj_A。要了解 PrjA 需要哪些库，您必须阅读 project.properties 文件（请参阅项目的根目录）。

对于 project.properties 文件中提到的所有资源，您需要添加该库。假设 Lib_1, Lib_2 ... Lib_n 这意味着您必须将 project.properties 文件从 Prj_A 请求的每个 Lib_x 导入“作为 android 项目”，然后转到 Prj_A ，右键单击，Properties，Android。弹出一个窗口，请参见底部显示 Prj_A 库的框架。确保在提到的每个库前面都有一个绿色标记。

对于上面带有红色问号的所有库或每个缺少的库，您需要在显示库的框架中执行以下步骤：单击“添加”按钮，它将弹出一个包含所有候选库的窗口（即 IMPORTED 和 OPEN 在您的工作区）。如果您没有库，则您正在寻找需要先在工作区中导入并打开这些库。

然后需要删除每个带有红色问号的库。所以进入显示库的框架，单击带有红色“？”的库。并单击删除按钮。然后点击应用。

# resources - Tapestry：调用 eventLink 问题

> ID：15483409
> 
> 赞同：0
> 
> 时间：2013-03-18T17:45:24.993
> 
> 标签：resources, tapestry

我有一个表格，当我按下提交时，应该打开一个 PDF。当我第一次这样做时，它可以工作，但下次没有。

我的代码：

```
Object onDoPDF() {  

        return new PDFStreamResponse
                    (pdfGenerator.generatePDF("doPDF");
    }

    Object onSuccessFromMyForm() {
        return resources.createEventLink("doPDF");  
    } 
```

下一次，调用 onSuccess 而不是 onDoPDF() 方法

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T20:20:54.643

你试过这种方法吗？

```
Object onSuccessFromMyForm() {
    return new PDFStreamResponse
                (pdfGenerator.generatePDF("doPDF");
} 
```

# ios - 像 Radar Objective C 这样的动画

> ID：15483410
> 
> 赞同：5
> 
> 时间：2013-03-18T17:45:31.663
> 
> 标签：ios, objective-c, uiview, clock, uianimation

我怎样才能像雷达一样制作 UIView 动画？我已经有一个 UIView 和用 drawrect 创建的圆圈，但是我如何创建一条线，做一个时钟动画？

如下图所示： ![在此处输入图像描述](../Images/58285e928b5e697fc651f3ee52b6a711.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-18T18:01:41.597

如果您已经拥有所有这些图像，那么您只需要一个雷达线动画。

您可以使用以下代码旋转雷达线：

```
- (void) startAnimation {

CABasicAnimation *radarHand;

radarHand = [CABasicAnimation animationWithKeyPath:@"transform.rotation"];

radarHand.fromValue = [NSNumber numberWithFloat:fromAngle+M_PI];

radarHand.byValue = [NSNumber numberWithFloat:((360*M_PI)/180)];

radarHand.duration = 60.0f;

radarHand.repeatCount = HUGE_VALF;

} 
```

（猜猜雷达线 - 半透明图像也有你。）

希望这会帮助你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T18:12:05.017

你可以`UIView`用这个圆的大小和圆心创建，画线（从这个视图的中心开始）然后旋转这个视图。

# zend-framework2 - ZF2 自定义视图助手停止执行

> ID：15483415
> 
> 赞同：-1
> 
> 时间：2013-03-18T17:45:39.350
> 
> 标签：zend-framework2

我正在尝试在 zf2 中创建自定义视图助手，我按照这里的说明进行操作，这些说明非常简单： http: [//framework.zend.com/manual/2.0/en/modules/zend.view.helpers.advanced-usage .html](http://framework.zend.com/manual/2.0/en/modules/zend.view.helpers.advanced-usage.html)

但是当我调用`$this->SpecialPurpose()`执行停止时没有错误。

我运行调试器并收到以下错误：

```
Warning: Class 'Zend\Stdlib\ArrayObject\PhpReferenceCompatibility' not found in C:\Program Files (x86)\Zend\ZendServer\data\apps\http\__default__\0\MT5_0\1.0.0\vendor\zendframework\zendframework\library\Zend\Stdlib\ArrayObject.php on line 24

Fatal error: Class 'Zend\Stdlib\AbstractArrayObject' not found in C:\Program Files (x86)\Zend\ZendServer\data\apps\http\__default__\0\MT5_0\1.0.0\vendor\zendframework\zendframework\library\Zend\Stdlib\ArrayObject.php on line 33 
```

最终，我想要扩展 URL Helper 以对其生成的 URL 进行一些更改，但我什至无法让这个简单的示例工作。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T19:54:46.383

在您设置了帮助程序的 module.config 模块中，放置以下代码：

```
'view_helpers' => array(
        'invokables' => array(
            'SpecialPurpose' => 'your_module_name\View\Helper\SpecialPurpose',
        )
    ), 
```

或在 Module.php

```
public function getViewHelperConfig()
 {
    return array(
            'invokables' => array(
            'SpecialPurpose' => 'your_module_name\View\Helper\SpecialPurpose',
        )
    );
 } 
```

在参考文献中很难看到，但有:)

```
// From within a configuration file
return array(
   'view_helpers' => array(
      'invokables' => array(
         'lowercase' => 'My\Helper\LowerCase',
         'uppercase' => 'My\Helper\UpperCase',
      ),
   ),
); 
```

希望这可以帮助。

# highcharts - xAxis 的序列值排序

> ID：15483416
> 
> 赞同：1
> 
> 时间：2013-03-18T17:45:51.280
> 
> 标签：highcharts

我有两个不同的折线图。一个带有日期时间 xAxis，另一个带有线性 xAxis。

我注意到如果 xAxis 类型是日期时间，系列值的顺序无关紧要。Highcharts 自动匹配这些值。

```
 series: [{
        data: [[Date.UTC(2010, 0, 1), 29.9], 
               [Date.UTC(2010, 0, 2), 71.5]]
    },
    {
        data: [[Date.UTC(2010, 0, 2), 61.5],
               [Date.UTC(2010, 0, 1), 19.9]]
    }] 
```

结果：http: [//jsfiddle.net/c6hvu/](http://jsfiddle.net/c6hvu/)

但在第二个图表中，我有一个线性 xAxis 和两个序列，其中两个值的顺序不同。此外，我还为 xAxis 定义了类别。然而，这些值不会自动匹配。这会导致图表中的值错误。

```
 series: [{
        data: [{name: 'First', y: 20}, 
               {name: 'Second', y: 50}]
    },
    {
        data: [{name: 'Second', y: 40},
               {name: 'First', y: 10}]
    }] 
```

结果：http: [//jsfiddle.net/xXkPt/](http://jsfiddle.net/xXkPt/)

我的问题是：

1.  这种行为是有意的还是这是一个错误？
2.  为什么 Highcharts 匹配日期时间图表而不匹配线性图表与类别？
3.  有没有办法匹配线性图表的系列值？

谢谢

托本

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-18T19:52:07.887

Highcharts 需要 xAxis 升序的排序数据。打开控制台并查看：

```
Highcharts error #15: www.highcharts.com/errors/15 
```

Highcharts 本身不匹配类别 - 将要匹配的类别索引放在`{name: 'First', y: 10, x:0}`哪里。`x`如果不设置`x`值，则假定`data`数组中点的索引为`x`值。

# windows - 使用脚本/批处理文件在窗口中自动单击鼠标

> ID：15483420
> 
> 赞同：18
> 
> 时间：2013-03-18T17:45:58.713
> 
> 标签：windows, batch-file, console-application

首先我想指出这是一个相当奇怪的问题，而且我什至不知道stackoverflow是否适合这个......

无论如何，有没有办法编写一个批处理文件或其他一些脚本，可以在脚本运行时鼠标指针恰好位于的任何地方自动单击鼠标？我的主要目标是：

1.  运行脚本
2.  检查时间是否在上午 00:00 和上午 05:00 之间
3.  如果不是，则继续每 15 分钟检查一次。
4.  如果是，则检查当前机器上是否有互联网连接
5.  如果有互联网连接，则继续每 15 分钟运行一次脚本检查。
6.  如果没有互联网连接，则在鼠标指针恰好指向的地方自动单击鼠标左键。
7.  继续运行，每 15 分钟执行一次与上述相同的检查

再说一次，我不知道这是否可能，只是想我会试试运气。提前致谢！

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-03-19T07:48:20.617

以防万一有一天某个可怜的灵魂偶然发现了这一点，使用上面@rojo 建议的 AutoIt - 这是我编写的完成我需要的脚本：

```
; Initiate Script
Main()

Func Main()
    ; Infinite loop
    While 0 < 1
        If CheckTime() == true Then
            If CheckInternetConnection() == true Then
                ; Internet Connection is true
                ; So no worries
            Else
                ; Internet Connection is false
                ; Perform mouse click
                MouseClick("left")
            EndIf       
        EndIf
        ; Sleep for 15 minutes
        Sleep(60000 * 15)
    WEnd
EndFunc

; The function checks if the current time is between 00:00 and 05:00
Func CheckTime()
    If @Hour >= 00 AND @Hour <= 05 Then
        Return true
    Else
        Return false
    EndIf
EndFunc

; The function checks if currently is a internet connection
Func CheckInternetConnection()
    Local $Connected = false
    $ping = Ping("www.google.com")
    If $ping > 0 Then
        $Connected = true
    EndIf
    Return $Connected
EndFunc 
```

然后，只需将代码保存在具有 .au3 文件扩展名的文件中，双击即可享受。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-03-18T18:21:51.327

我会使用[AutoIt](http://www.autoitscript.com/site/autoit/)。恕我直言，autoit 更适合运行系统托盘图标可能比控制台窗口更可取的脚本。AutoIt 可以[检查时间](http://www.autoitscript.com/autoit3/docs/macros/TimeAndDate.htm)、[ping 某些东西](http://www.autoitscript.com/forum/topic/83348-check-internet-connection/)、[自动单击鼠标](http://www.autoitscript.com/autoit3/docs/functions/MouseClick.htm)，以及可能[您需要的其他任何东西](http://www.autoitscript.com/autoit3/docs/)。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2016-04-15T13:47:06.760

[nircmd](http://www.nirsoft.net/utils/nircmd.html)能够做一些基本的鼠标操作。检查[mouse.bat](https://github.com/npocmaka/batch.scripts/blob/master/hybrids/.net/c/mouse.bat) - 自编译的 C# 类（默认情况下从 vista 及更高版本的所有内容中安装 c# 编译器）能够从命令行命令鼠标（也非常基本，但可以比 nircmd 做更多的事情）。`mouse.bat -help`您可以看到帮助和一些示例操作。

这是示例用法：

例子：

```
::clicks at the current position
call mouse click

::double clicks at the current position
call mouse doubleClick

::right clicks at the current position
call mouse rightClick

::returns the position of the cursor
call mouse position

::scrolls up the mouse wheel with 1500 units
call mouse scrollUp 150

::scrolls down with 100 postitions
call mouse scrollDown 100

::relatively(from the current position) moves the mouse with 100 horizontal and 100 vertial postitions
call mouse moveBy 100x100

::absolute positioning
call mouse moveTo 100x100

::relative drag (lefclick and move)
call mouse dragBy 300x200

::absolute drag
call mouse dragTo 500x500 
```

# ruby-on-rails - 无法在 Windows 上使用 Rails Composer

> ID：15483424
> 
> 赞同：1
> 
> 时间：2013-03-18T17:46:07.103
> 
> 标签：ruby-on-rails, twitter-bootstrap, heroku, rvm, twitter-bootstrap-rails

[Rails Composer](http://railsapps.github.com/rails-composer/)是一个用于自动生成模板 rails 应用程序的工具。也许我很愚蠢，但我无法在 Windows 上启动并运行它。

我设法使用

```
rails new myapp -m https://raw.github.com/RailsApps/rails-composer/master/composer.rb 
```

但我不知道如何配置选项，所以我可以使用 MongoDB + Twiter Bootstrap (SASS) + OpenAuth。

使用本教程的 rvm 部分并不是一个真正的选择，因为我在 Windows 上。

顺便说一句，有没有人有使用 rails composer 创建应用程序并将它们部署到 Heroku 的自动化工作流程？

# ruby-on-rails - 有谁知道如何使用 best_in_place gem 更改编辑框中的字体大小？

> ID：15483425
> 
> 赞同：1
> 
> 时间：2013-03-18T17:46:13.393
> 
> 标签：ruby-on-rails, font-size, inline-editing, best-in-place

所以我使用 best_in_place gem 在页面上编辑我的表单。我的价格是：1234 美元。当我单击价格进行编辑时，与我在表单中使用的字体相比，字体变得非常小，看起来很奇怪。我希望他们是一样的。

这是我来自网络检查器的代码：2345.0

更改类或 id 上的字体只会更改大小预编辑。单击文本后，它会再次缩小。我想我真的需要知道点击编辑后如何选择页面上的框。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-07T12:19:48.337

您可以将类添加到输入字段本身，因此该类仅适用于输入，而不是标签，方法是使用：

```
<%= best_in_place @your_variable, :name, { :inner_class: => "your_class" } %> 
```

那么css就是一个简单的

```
.your_class { font-size: 14px; } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-11T08:25:20.067

这个想法是将类添加到 best_in_place 助手生成的跨度，然后将样式应用于嵌套在其中的输入。

首先将类添加到 best_in_place 字段：
`<%= best_in_place @your_variable, :name, { :classes => "input_field" } %>`

（我使用 best_in_place 2.1.0，对于旧版本，您需要依赖字段的 id，这似乎是唯一的）

然后将样式应用于 css 中类的**输入**子项：

`.input_field input { font-size: 12px; }`

# java - Java 中的 Cookie 解析

> ID：15483427
> 
> 赞同：4
> 
> 时间：2013-03-18T17:46:23.753
> 
> 标签：java, json, parsing, http, cookies

有谁知道一个开源 Java 库，它可以按照最新标准（[RFC 6265](https://www.rfc-editor.org/rfc/rfc6265)）完全处理客户端（浏览器）cookie，并且完全向后兼容[RFC 2109](https://www.rfc-editor.org/rfc/rfc2109)和[RFC 2965](https://www.rfc-editor.org/rfc/rfc2965)（RFC 6265 已经过时）？

[在 StackOverflow 中的一个类似问题](https://stackoverflow.com/questions/5574530/how-to-parse-a-cookie-string)中已经提出了一些方法（例如，使用 Apache HttpClient 库） [，Java](http://json.org/java/)中也有JSON ，它将 cookie 转换为 JSON。

然而，cookie“格式”有许多变化，从 Netscape 的原始规范到当代的“嵌套”键值对及其他（例如，Internet Explorer cookie 文件）。因此，除非您知道 cookie 的确切结构，否则上述解决方案似乎都不能完全处理所有事情。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-18T17:54:29.723

编辑：这个答案是不正确的。用于客户端解析服务器 set-cookie 的 API。

```
java.net.HttpCookie.parse() 
```

> 有 3 个 http cookie 规范：

```
Netscape draft
RFC 2109 - http://www.ietf.org/rfc/rfc2109.txt
RFC 2965 - http://www.ietf.org/rfc/rfc2965.txt 
```

> HttpCookie 类可以接受所有这 3 种语法形式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-06-14T20:43:36.053

对于任何感兴趣的人，我最近启动了[Java Cookie 项目](http://github.com/js-cookie/java-cookie)，它承诺与 RFC 6265 和 JSON/Java 数据绑定完全兼容。

# json - 合并 2 个 json 结果

> ID：15483429
> 
> 赞同：1
> 
> 时间：2013-03-18T17:46:29.980
> 
> 标签：json, asp-classic

我有 2 个用 aspextreme 插件解析的不同 json 结果；`{ "checkins": { "data": [ ] } }`和`{ "trips": { "data": [ ] } }`。

但这给我带来了很多麻烦。即使我从 2 个不同的数据库中获取数据，有没有办法只有一个 json 文件。

所以像这样；`{ "checkins": { "data": [ ] }, "trips": { "data": [ ] }`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T00:36:04.453

你的意思是不同的数据库还是同一个数据库中的不同表？如果是后者，那么这更像是一个 SQL 问题，而不是 asp 或 json。我认为您正在寻找的是内部联接或左联接查询。如果这对您来说是新事物，我建议您对该概念进行一些背景阅读。您的第二个记录集的内部联接查询看起来像

SELECT Trips.TripsID, Trips.MemberID, Trips.TripFrom, Trips.TripTo, Trips.TripDateStarted, Trips.TripDateEnded, Members.MemberId, Members.Firstname, Members.Lastname from Trips 内部加入成员 Trips.MemberId = Members.MemberId 哪里Trips.Trips.ID ...等

这将使您不必将一个记录集嵌套在另一个记录集中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T19:17:50.473

原来是这样的，
`Set Dataset = JSON.parse("{ ""checkins"": { ""data"": [] }, ""trips"": { ""data"": [] } }")`

我应该只是将数据推送到其中

# postgresql - 检查 IP 地址的整数值是否在 PostgreSQL 的私有范围内

> ID：15483430
> 
> 赞同：0
> 
> 时间：2013-03-18T17:46:37.700
> 
> 标签：postgresql, ip, postgresql-8.3

我正在使用 PostgreSQL 的 MPP 版本，它是从 8.3 版分叉出来的

我有一个大表，其中包含一个名为 ip_address 的列，它是 inet 和另一个名为 hash_ip_address 的列，它是 bigint。hash_ip_address 列中的每个值都是使用 hashnet 函数从 ip_address 列转换的值。我正在尝试使用整数值来确定地址是私有的还是公共的。我遇到的问题是我看不到检查 IP 地址的整数值是否为私有的通用方法，因为有些值是正数，有些是负数，如下例所示：

```
select hashinet('10.10.0.1'::inet);
  hashinet
-------------
 -1939051471
(1 row)

select hashinet('10.0.0.4'::inet);
  hashinet
------------
 1510004552
(1 row) 
```

有没有办法仅使用 hashnet 函数的转换整数值来确定 IP 地址是否是私有的？

[编辑：这是来自http://doxygen.postgresql.org/network_8c.html#a0baabf8b98dbbcc39c6c1c814f9d86f8](http://doxygen.postgresql.org/network_8c.html#a0baabf8b98dbbcc39c6c1c814f9d86f8)的 hashnet 函数的定义

基准哈希网 (PG_FUNCTION_ARGS)

在文件 network.c 的第 527 行定义。

参考 hash_any()、ip_addrsize()、PG_GETARG_INET_PP 和 VARDATA_ANY。

```
{
    inet       *addr = PG_GETARG_INET_PP(0);
    int         addrsize = ip_addrsize(addr);

    /* XXX this assumes there are no pad bytes in the data structure */
    return hash_any((unsigned char *) VARDATA_ANY(addr), addrsize + 2);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T01:38:27.287

哇。您正在使用文档中没有的内部 PostgreSQL 函数。

在我看来，hashinet 调用 hash_any() 是一个真正的哈希，所以没有办法做到这一点。

如果您需要 int 有意义且有用，而不仅仅是将任意 int 绑定到 IP 地址，更好的方法是通过创建一个新函数将您的 IP 地址创建为 int：

```
 CREATE FUNCTION inet_to_int(inet) RETURNS INT language sql immutable AS 
 $$
 SELECT $1 - '0.0.0.0'::inet;
 $$; 
```

然后使用它。从那里您的私有范围将对应于 int 范围，您可以更轻松地检查。

例如 10/8 地址是`BETWEEN 167772160 AND 184549375`....

# mvvm - 使用 Caliburn 在 Windows 应用商店中绑定组合框

> ID：15483431
> 
> 赞同：1
> 
> 时间：2013-03-18T17:46:38.103
> 
> 标签：mvvm, windows-8, windows-store-apps, winrt-xaml, caliburn.micro

我正在尝试使用 Caliburn 和以下代码绑定组合框：

***yyyView.xaml***

```
 <ComboBox x:Name="Filters"></ComboBox> 
```

***yyyViewModel.xaml***

```
private string selectedFilter;

public BindableCollection<string> Filters
{
    get
    {
        return new BindableCollection<string>(
                 new string[]{ "All", "Last Month", "Last Week", "Yesterday" });
    }
}

public string SelectedFilter
{
    get { return selectedFilter; }
    set
    {
        selectedFilter = value;
        NotifyOfPropertyChange(() => SelectedFilter);
    }
} 
```

使用此代码，我在***GetInstance***方法的***App.xaml.cs***上收到***ArgumentNullException 。***

 **我是 MVVM、Caliburn 和 XAML 的新手，但我在某处读过WinRT 开发中的某些行为（我相信**Blend Behaviors ）。**

那是问题吗？我该如何解决这个问题？

谢谢

编辑：

***应用程序.xaml.cs***

```
protected override void Configure()
{
    LogManager.GetLog = type => new DebugLogger(type);
    container = new WinRTContainer();
    container.RegisterWinRTServices();
    container.PerRequest<aaaViewModel>();
    container.PerRequest<xxxViewModel>();
    container.PerRequest<yyyViewModel>();
    container.PerRequest<zzzViewModel>();
} 
```

***应用程序.xaml***

```
<caliburn:CaliburnApplication
    x:Class="yyyStoreApp.App"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:yyyApp"
    xmlns:caliburn="using:Caliburn.Micro"
    xmlns:converters="using:yyyApp.Converters"
    RequestedTheme="Light">

    <Application.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="Resources/CustomStyles.xaml" />
                <ResourceDictionary Source="Resources/StandardStyles.xaml"/>
            </ResourceDictionary.MergedDictionaries>
            <converters:ImageFilePathConverter x:Key="ImageFilePath"/>
        </ResourceDictionary>
    </Application.Resources>
</caliburn:CaliburnApplication> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T17:57:32.987

您可能没有在实现的`Configure`方法重载中注册视图模型`App`。请查看[WinRT 文档](http://caliburnmicro.codeplex.com/wikipage?title=Working%20with%20WinRT&referringTitle=Documentation)中代码中的`// TODO`部分。`App`

这显然是预期的行为，但引起了一些混乱，如 CodePlex 上的讨论论坛和问题跟踪器所示，请参见[此处](http://caliburnmicro.codeplex.com/workitem/287)、[此处](https://caliburnmicro.codeplex.com/workitem/280)和[此处](http://caliburnmicro.codeplex.com/discussions/432882)。

基本上，只需将这一行添加到方法中，您就应该过得很好`Configure`：

```
container.PerRequest<yyyViewModel>(); 
```**

# c - 这组条件可以进一步简化吗？

> ID：15483432
> 
> 赞同：-2
> 
> 时间：2013-03-18T17:46:38.713
> 
> 标签：c, math, logic

我从这组条件开始：

```
if (old.tg.all && old.hg.all) {
    // reject
} 

if (new.tg.all && new.hg.all) {
    // reject
}

if (old.hg.all && new.tg.all) {
    // reject
}

if (old.tg.all && new.hg.all) {
    // reject
}

if (old.tg == new.tg) {
    if  ( (old.hg == new.hg) || (old.hg.all) || (new.hg.all) ) {
        // reject
    }
}

if (old.hg == new.hg) {
    if ( (old.tg == new.tg) || (old.tg.all) || (new.tg.all) ) {
        // reject
    }
} 
```

我设法将其减少到：

```
if (old.tg.all || new.tg.all) && (old.hg.all || new.hg.all) {
    // reject
}

if (old.tg == new.tg) {
    if  ( (old.hg == new.hg) || (old.hg.all) || (new.hg.all) ) {
        // reject
    }
}

if (old.hg == new.hg) {
    if ( (old.tg == new.tg) || (old.tg.all) || (new.tg.all) ) {
        // reject
    }
} 
```

是否可以进一步减少逻辑运算和/或布尔条件重复的数量？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T17:54:08.153

## 对于您关于逻辑表达式简化的原始问题

首先，“表达式简化”不是一个定义明确的操作。

其次，简化逻辑表达式*的*（或多或少）标准理解是[析取范式](http://en.wikipedia.org/wiki/Disjunctive_normal_form)（或者，或者，它的兄弟连[取范式](http://en.wikipedia.org/wiki/Conjunctive_normal_form)）。两者都可能比您的原始表达式和简化的表达式更简单。

至少，它们最小化了表达式的*深度*。

## 对于您完全重写的关于 C 代码的问题

主要问题*不是*简单性，而是意图的*清晰性以及由此产生的**可维护性*。您不应该担心您编写的字符数或代码行数，而应该担心理解和修改代码逻辑的难度。只要代码清晰，一点冗余和/或额外（廉价）检查就不会受到伤害。

# c++ - C++ - 自定义类型的交换功能不起作用

> ID：15483437
> 
> 赞同：0
> 
> 时间：2013-03-18T17:46:44.307
> 
> 标签：c++, class, function, swap

我目前正在用 C++ 编写 n-puzzle，尽管由于某种原因我无法交换板的元素。让我解释。我有一个“Piece”类（该类的一些方法）：

```
Piece::Piece(int l, int c, int n):
line(l), 
column(c), 
number(n)
{

}

int Piece::getLine()
{
  return line;
}

int Piece::getColumn() const
{
  return column;
}

int Piece::getNumber() const
{
  return number;
}

void Piece::setLine(const int new_line)
{
  this -> line = new_line;
}

void Piece::setColumn(const int new_column)
{
  this -> column = new_column;
}

void Piece::setNumber(const int new_number)
{
  this -> number = new_number;
} 
```

我还有一个执行游戏的棋盘类。Board 是“Piece”类型向量的向量。正在使用以下代码创建板：

```
for(size_t i = 0; i < this -> width; i++)
  {
    vector<Piece> row;

    for(size_t j = 0; j < this -> height; j++)
    {
      row.push_back(Piece(i, j, ((j == this -> width - 1) && (i == this -> height - 1) ? 0 : i * this -> width + j + 1)));
    }  
    board.push_back(row);
  } 
```

到这里为止没有任何问题。问题是当我想交换 Board 的两个元素时。想象一下，我们有一个 3x3 游戏。如果我运行以下代码，结果将是错误的

```
swapPieces(board[0][0], board[1][0]);
swapPieces(board[1][0], board[2][0]);
cout << board[0][0] << "\t" << board[0][0].getLine() << endl; 
```

谜底是正确的：

4 2 3

7 5 6

1 8 0

但是通过执行 board [0][0].getLine() 输出为 1，这是 Piece 的初始位置！我真的不知道我做错了什么。如果有人能帮帮我，我将不胜感激:)

编辑：swapPieces 添加：

```
void Board::swapPieces(Piece &p1, Piece &p2)
{
  Piece p = p1;
  p1 = p2;
  p2 = p;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-18T17:57:11.380

代码库确实有两种方式来表示 Piece 位置。一个是 Piece 对象中的“line”和“column”变量，另一个是 board 和 Vector 行容器中 Piece 对象的排序。编程的一个基本原则是 DRY（不要重复自己）。就像您现在遇到的那样，它会导致错误。swapPieces 可能正在交换容器内的对象，但不更新对象变量。您可以通过使两个表示一致（设置行和列变量）在 swapPieces 代码中修补此问题，但从长远来看，确定两者中的哪一个是多余的会更清晰。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T17:56:46.327

`swapPieces`似乎有效，但除非您也调用`setLine`并且这些`setColumn`碎片不会知道它们已被移动。现在，这些片段将包含它们在构造函数中设置的原始位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-18T18:10:39.567

首先确保您的副本 c'tor 实际被调用（我还没有看到实现）。其次，确保当您使用 board[0][0] 时，您使用的是实际对象而不是它的副本

# sql - 编译错误“找不到数据成员的方法” - DoCmd.Query 表单访问 SQL

> ID：15483440
> 
> 赞同：1
> 
> 时间：2013-03-18T17:46:51.537
> 
> 标签：sql, ms-access, compiler-errors, vba

我确信这很简单，但我仍处于学习如何在访问中使用 VBA 的早期阶段。我不确定我搞砸了什么，但这就是发生的事情：

我有一个包含列表和组合框的表单。我创建了一个命令，当在列表上双击时，它会以其原始表格形式返回 SQL 查询。当我最初编写代码时，它只有 2 个字段，一个数字和一个美元数字。编码：

`Private Sub List43_DblClick(Cancel As Integer)`

`DoCmd.Query ("BuyerPerfDetailPA2")`

`End Sub`

在那里工作 2 个字段，但我最近在第 3 列中添加了第三个，是/否响应。现在，当我运行此代码时，我收到标题中列出的“编译错误”。我的猜测是它无法匹配的添加列 - 因为查询有一个 WHERE 子句（`WHERE (((CombineTables.[PA#])=Forms![Buyer Performance Report]!List43)`。PA# 分配给列表中的第一列（美元金额为 2，是/否为 3）3。

出现错误后，当我按 OK 时，它确实显示查询已运行，​​因此它也可能只是 VBA 访问的问题。

有什么建议么？我希望这不是太模糊。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T18:10:31.700

*“未找到方法或数据成员”*`DoCmd`是由于没有名为 的方法而发生的编译错误`Query`。

如果要在数据表视图中打开*BuyerPerfDetailPA2*，请使用此...

```
DoCmd.OpenQuery "BuyerPerfDetailPA2" 
```

那里不需要括号。

如果*BuyerPerfDetailPA2*实际上是一个“操作查询”，并且您想执行它，请使用 ...

```
CurrentDb.Execute "BuyerPerfDetailPA2", dbFailOnError 
```

如果这些建议都不是您想要的，请更详细地告诉我们您想要什么并向我们展示*BuyerPerfDetailPA2*的 SQL 。

# css - css如何使背景图像向右填充

> ID：15483441
> 
> 赞同：0
> 
> 时间：2013-03-18T17:46:54.633
> 
> 标签：css

我有这个CSS

```
#div ul li:hover{
    background-image:  url(http://localhost/mywebsite/public/images/close.png);
    background-repeat: no-repeat;
    background-position: right;
    background-color: #ccccff;
} 
```

图像是`close.png`小图标，但我在边缘，我想让它向右打一点赌注，我的意思是如果 div 向右填充，我希望我能把我的问题说清楚，对不起，我很糟糕关于英语

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T18:13:51.050

你可以用

```
#div ul li:hover{
    background-position: top 95%;
} 
```

# powershell - 将托管路径从显式包含更改为通配符包含

> ID：15483442
> 
> 赞同：0
> 
> 时间：2013-03-18T17:46:54.937
> 
> 标签：powershell, sharepoint-2010, powershell-2.0

可以通过 powershell 脚本将 Web 应用程序中的托管路径从显式更改为通配符吗？我可以将站点移动到另一条路径并返回，但正在寻找更快的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T17:54:34.410

我发现这很有帮助。

[使用 Windows PowerShell 定义 Web 应用程序的托管路径](http://technet.microsoft.com/en-us/library/cc261845.aspx#section2)

# java - 计算在论坛中回复答案所需的时间

> ID：15483445
> 
> 赞同：0
> 
> 时间：2013-03-18T17:47:01.763
> 
> 标签：java

嗨，我在大学有一个小组项目。我和我的小组成员需要创建一个网站。我们已经这样做了，今年我们学习了 Java 编程语言。我的讲师给了我们另一项任务，即使用 Java 将我们的网站从静态升级到动态，尤其是使用 JSP（JavaServer Pages）。

我负责为我们的网站为这项新任务创建统计报告。到目前为止，我能够从互联网上找到如何计算平均值、总和和中位数，尤其是从这个论坛。但是**我无法找到如何计算管理员根据 String ArrayList 回答用户问题所花费的时间。**

那么有人可以帮我解决这个问题吗？我对这个 Java 很陌生，任何帮助将不胜感激。

我很抱歉我的语法，英语不是我的主要语言。提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T18:24:05.667

使用线程来保持时间：

```
public class KeepingTime
{
    private volatile int timeTaken;
    private Thread timekeeper;

    public KeepingTime()
    {
        timekeeper = new Thread(new Runnable(){
            public void run()
            {
                try
                {
                    while(true)
                    {
                        Thread.sleep(1000);
                        timeTaken++;
                        if(Thread.interrupted())
                            return;
                    }
                }
                catch(InterruptedException e)
                {
                    return;
                }
            }    //end run
        }); //end thread
        timekeeper.start();
    }    //end constructor

    public void stop()
    {
        timekeeper.interrupt();
    }

    public int timeTaken()
    {
        return timeTaken;
    }
} 
```

然后像这样使用它：

```
for(String question : questions)
{
    KeepingTime timer = new KeepingTime();
    //ask the question
    //wait until it is answered
    timer.stop();
    int timeTaken = timer.timeTaken();
} 
```

请注意，我没有使用 Thread.stop() 因为它已被弃用。如果您运行大量线程，这可能会不一致。

# iphone - 如何在 iOS 中按函数从同一类调用 ViewDidLoad 方法

> ID：15483449
> 
> 赞同：0
> 
> 时间：2013-03-18T17:47:11.047
> 
> 标签：iphone, ios

我的第一堂课是厨房类，从画廊类我将一些变量和对象传递给我的图像显示类，在我的图像显示类中有下一个图像按钮，当我按下该按钮时，我的图像显示类中存在的所有图像都是需要改变。

```
 MixViewController *mixVC = [[MixViewController alloc] init];
    mixVC.readOnlyMode = YES;
    mixVC.location = location;

    NSArray *tree = location.gallerySerialised;
    NSDictionary *galleryEntryTree = [tree objectAtIndex:tappedCoverIndex];
    NSArray *sliderStates = [galleryEntryTree objectForKey:@"state"];
    mixVC.infotext=[galleryEntryTree objectForKey:@"description"];
    mixVC.authortext=[galleryEntryTree objectForKey:@"author"];
    mixVC.tappedIndex=tappedCoverIndex;

    mixVC.initialSliderStates = [NSArray arrayWithObjects:
                                 [NSNumber numberWithInt:[[sliderStates objectAtIndex:0] intValue]],
                                 [NSNumber numberWithInt:[[sliderStates objectAtIndex:1] intValue]],
                                 [NSNumber numberWithInt:[[sliderStates objectAtIndex:2] intValue]],
                                 [NSNumber numberWithInt:[[sliderStates objectAtIndex:3] intValue]],
                                 [NSNumber numberWithInt:[[sliderStates objectAtIndex:4] intValue]],
                                 [NSNumber numberWithInt:[[sliderStates objectAtIndex:5] intValue]],
                                 nil];

    mixVC.modalTransitionStyle = UIModalTransitionStyleCrossDissolve;
    [self.parentViewController presentModalViewController:mixVC animated:YES]; 
```

这是我调用 mixviewcontroller 的代码。当我按下下一个按钮时，我想更改 Sliderstates 的值并重新加载视图以根据滑块和画廊索引显示新图像。

现在我在该类中的混合图像类中，当用户单击下一个而不是调用 nextGalleryview 函数并且我想更改图像但它不起作用

我编写这段代码通过传递相同的值来调用 self view-did-load 但它不会改变任何东西。

任何帮助表示感谢谢谢

```
 -(void)nextGalleryView
      {
     NSLog(@"tap index is %i",tappedIndex);
        [ScrollView removeFromSuperview];
    self.readOnlyMode = YES;
    self.location = location;
    NSArray *tree = location.gallerySerialised;
    NSDictionary *galleryEntryTree = [tree objectAtIndex:tappedIndex];
    NSArray *sliderStates = [galleryEntryTree objectForKey:@"state"];
    self.infotext=[galleryEntryTree objectForKey:@"description"];
    self.authortext=[galleryEntryTree objectForKey:@"author"];
    self.tappedIndex=tappedIndex;

    self.initialSliderStates = [NSArray arrayWithObjects:
                                 [NSNumber numberWithInt:[[sliderStates objectAtIndex:0] intValue]],
                                 [NSNumber numberWithInt:[[sliderStates objectAtIndex:1] intValue]],
                                 [NSNumber numberWithInt:[[sliderStates objectAtIndex:2] intValue]],
                                 [NSNumber numberWithInt:[[sliderStates objectAtIndex:3] intValue]],
                                 [NSNumber numberWithInt:[[sliderStates objectAtIndex:4] intValue]],
                                 [NSNumber numberWithInt:[[sliderStates objectAtIndex:5] intValue]],
                                nil];
    [self viewDidLoad];
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-18T17:50:10.087

You need to redesign your code.

If you want same code to be run from viewDidLoad and from other method, pull those codes out of viewDidLoad and put it in a method and call this method from viewDidLoad and from your method.

As calling viewDidLoad explicitly is not good.

# asp.net-mvc-4 - Asp.Net MVC：在生成出站 URL 时重用段变量的值

> ID：15483451
> 
> 赞同：1
> 
> 时间：2013-03-18T17:47:13.970
> 
> 标签：asp.net-mvc-4, asp.net-routing

当路由与*出站 URL*匹配时，路由系统将尝试通过查看*当前请求*中的值来查找*路由 URL 模式中每个**段变量*的值。如有必要，路由系统将重用来自*传入 URL的**段变量值*

 ***摘自*Pro Asp.Net MVC 4*书：

> 路由系统将仅重用在 URL 模式中出现早于提供给 Html.ActionLink 方法的任何参数的段变量的值。假设我们尝试创建这样的链接：
> 
> @Html.ActionLink("点击我", "列表", "目录", new {color="Aqua"}, null)
> 
> 我们为颜色提供了一个值，但没有为页面提供值。但是颜色出现在 URL 模式中的页面之前，因此路由系统不会重用来自传入 URL 的值，并且路由将不匹配。
> 
> ...我们强烈建议您不要依赖此行为，而是为 URL 模式中的所有段变量提供值。通过依赖这种行为，您最终会对用户发出请求的顺序做出假设

注意：摘录所指的路线定义为：

```
 routes.MapRoute("MyRoute", "{controller}/{action}/{color}/{page}"); 
```

一个）

> 路由系统将仅重用在 URL 模式中出现早于提供给 Html.ActionLink 方法的任何参数的段变量的值

如果路由系统还重用了在*URL 模式*中出现的*段变量*的值而不是提供给的参数，那么会出现什么问题？*`Html.ActionLink`*

 *b)

> 我们强烈建议您不要依赖此行为，而是为 URL 模式中的所有段变量提供值。通过依赖这种行为，您最终会对用户发出请求的顺序做出假设

我不明白不为所有*段变量*提供值如何转化为对用户提出*请求*的顺序进行假设？！

非常感激****

# ruby-on-rails - 如何从参数中获取数据

> ID：15483452
> 
> 赞同：-1
> 
> 时间：2013-03-18T17:47:14.483
> 
> 标签：ruby-on-rails, ruby, params

我想将从控制器中的视图检索到的文本值传递给数据库。从视图中检索的参数是

```
Parameters: {"utf8"=>"✓", "authenticity_token"=>"Bj5gJR1GKO7JSeJpdrV72T5FoX283rTH8L7NfIiyRFM=", "project"=>{"comments_attributes"=>{"9"=>{"text"=>"commenting", "user_id"=>"1", "category"=>"---"}}, "id"=>"9"}, "submit"=>"SUBMIT"} 
```

我正在尝试使用以下内容获取文本：

```
:data => params[:project][:comments_attributes][params[:id]][:text] 
```

但我收到一个错误

```
NoMethodError (undefined method `[]' for nil:NilClass): 
```

当我在其他方法上使用相同的表达式时，我得到的并不是禁止我这样做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T17:51:12.573

我相信你的参数有问题，但如果你忽略了这一点，我认为你可以做一个小的更正：

```
data => params[:project][:comments_attributes][params[:project][:id]][:text] 
```

# javascript - KineticJS中形状组的动画样式属性？

> ID：15483453
> 
> 赞同：0
> 
> 时间：2013-03-18T17:47:16.303
> 
> 标签：javascript, kineticjs

是否有一种快捷方式可以同时为一堆形状的样式（笔触、填充）设置动画，或者我是否需要循环遍历各个形状并一次更新它们？我尝试在组级别设置样式，但没有效果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T18:46:16.913

是的，没有组级别的`set`方法。

在每个动画帧上，遍历您组的孩子并使用`setFill()`and `setColor()`。

```
var myAnimation= new Kinetic.Animation( changeColors, myLayer );

myAnimation.start();

function changeColors(){

    var children = myKineticGroup.getChildren(); // get children of group

    for(var i=0;i<children.length;i++){
        children[i].setFill("blue");
        children[i].setStroke("red");
    }
} 
```

# jquery - jQuery Replacewith（替换 2 个元素）

> ID：15483454
> 
> 赞同：0
> 
> 时间：2013-03-18T17:47:18.443
> 
> 标签：jquery, replace

为什么这段代码不替换对象和嵌入？

```
$(".watch-on-mobile").click(function () {
$('object' && 'embed').replaceWith($('.video-js'));
$('.video-js').css("display", "block")
}); 
```

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T17:48:19.500

您不能发明一种语法并希望库猜测。

使用[多重选择器](http://api.jquery.com/multiple-selector/)：

```
$('object,embed').replaceWith($('.video-js')); 
```

# javascript - 收到消息时播放声音

> ID：15483455
> 
> 赞同：0
> 
> 时间：2013-03-18T17:47:18.727
> 
> 标签：javascript, jquery

我想在收到消息时播放声音，所以我搜索并找到了很多解决方案，但我找到的最简单的解决方案是

```
 <script>  
       $('body').append('<embed src="beep.mp3" autostart="true" hidden="true">');
  </script> 
```

但问题是它不能在 Godzilla/IE 中播放声音并在 Chrome 中播放。有没有办法在不添加任何额外插件（Mozilla/JQuery）的情况下解决这个问题。chrome 中还有一个问题，当声音播放时，主窗口的滚动条会从它的位置移动。我的主要问题是播放声音，所以它的优先级是第一位的。任何人都知道它的解决方案，然后请与我们分享，谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-19T11:49:34.260

试试这个，我认为这是任何人见过的最简单的解决方案......:)你只做一件事你应该将你的转换**`beep.mp3`**为**`beep.wav`** 因为有些浏览器不理解 mp3 所以你应该将它转换为 wav 然后只使用这个**3行代码**

```
 <script>  
     var aSound = document.createElement('audio');
     aSound.setAttribute('src', 'beep.wav');
     aSound.play();
 </script> 
```

**这将在页面打开/重新加载**时播放声音，您可以根据需要进行设置，并且还需要 js 1.6 或更高版本。希望这能解决你的两个问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-18T17:59:21.330

如果您不想创建多个音频元素，可以尝试将`currentTime`属性设置为 0，以便音频文件重新开始。

```
<script>
    function play() {
        var sound = document.getElementById("audio");
        sound.currentTime = 0;
        sound.play();
    }
</script>

<audio src="success.wav" autostart="false" width="0" height="0" id="audio" /> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-18T17:51:46.997

打开此链接：[Play Sound without browser plugin](http://www.misfitgeek.com/2011/08/play-sound-in-html5-and-cross-browser-support-with-backward-compatability/)。

在此链接中，您可以获得解决问题的代码。第二个问题可以通过删除来解决`$('body')`

```
$('body').append('<embed src="beep.mp3" autostart="true" hidden="true">'); 
```

并设置任何**div**。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-18T17:51:43.760

尝试以下（未测试）

将声音文件准备好嵌入代码中并使用javascript函数播放它...

```
<script>
    function PlaySound(soundObj) {
        var sound = document.getElementById(soundObj);
        sound.Play();
    }
</script>

<embed src="success.wav" autostart="false" width="0" height="0" id="sound1" enablejavascript="true"> 
```

# iphone - 来自手机的红外线

> ID：15483456
> 
> 赞同：-4
> 
> 时间：2013-03-18T17:47:18.743
> 
> 标签：iphone, galaxy, television

是否可以像电视控制器那样从手机生成红外信号？（假设电视控制器使用 IR 信号）。我的意思是他们是否有所需的硬件。我所说的手机是指像 Galaxy S3、Iphone 这样的手机。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T17:48:35.890

取决于手机。新的 Galaxy S4 应该。但是是否添加该硬件完全取决于制造商，因此如果没有特定型号，确实无法回答。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T17:49:07.673

绝大多数 Android 设备没有红外传感器或发射器，因此无法做到这一点。

另一方面，现在很多电视都允许通过蓝牙和 WiFi 进行遥控，因此您可能需要调查/联系制造商，看看他们是否提供 API。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-18T17:49:45.853

该设备必须有一个红外发射器，但目前很少有设备这样做。HTC One 是一款拥有一台的设备，即将推出的 Galaxy S4。所以是的，这当然是可能的，但它确实需要一个硬件组件。

# jquery - jquery mobile：内容位于带有命名锚的固定标头后面

> ID：15483462
> 
> 赞同：0
> 
> 时间：2013-03-18T17:47:29.113
> 
> 标签：jquery, mobile, anchor, named

我正在使用 jQuery Mobile（版本 1.1.1 和 1.3.0）作为固定标题的移动网站。单击指向命名锚点的链接时，它会将锚点带到页面顶部（固定标题后面）。我发现的大多数修复建议始终在目标内容的顶部添加边距或填充，或者使用伪类`:target`。

这不是一个可接受的解决方案，因为它在上下滚动内容时会留下空隙，无论是始终还是在单击链接之后。

任何其他建议将不胜感激。

HTML：

```
<head>
    <title>Page Title here</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-language" content="en" />
    <!-- CSS Start -->
    <link type="text/css" rel="stylesheet" media="all" href="/css/style.css" />
    <link type="text/css" rel="stylesheet" media="all" href="/css/system-menus.css" />
    <!-- CSS End -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, target-densityDpi=device-dpi" />
    <script type="text/javascript" src="/jquery/jquery.js"></script>
    <script type="text/javascript" src="/jquery/jquery.mobile-1.3.0.js"></script>
    <link type="text/css" rel="stylesheet" media="all" href="/jquery/jquery.mobile-1.3.0.css" />
    <script type="text/javascript">
        $(document).ready(function () {
            $("a").attr("data-ajax", "false"); 
        });
    </script>
    <meta name="description" content="Some description text." />
    <meta name="keywords" content="" />

</head>
<body>
<div id="global-wrapper">
    <div id="header" data-role="header" data-position="fixed">
        <a href="/index.html" data-ajax="false">
                    <img src="myimage.png" alt="my alt text" class="logo" />
        </a>
        <div id="top-utility-m">
            <ul>
                <li><a href="http://offsite.com/somefile.pdf" data-ajax="false">Link 1</a> |</li> 
                <li><a href="http://offsite.com/somefile2.pdf" data-ajax="false">Link 2</a></li>
            </ul>
        </div>
        <img src="/images/header_divider.png" alt="" /><br/>
    </div><!-- end fixed header -->

    <div id="wrapper">  
        <div id="content-wrapper" class="clear">
            <div id="main-content">
                <p class="scroll">Scroll Down for Menu &#8744;</p>
                <h1>This is a header on the page</h1>
                <p>Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text.</p>
                <p>Some more text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text.</p>
                <p>Still more text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text.</p>
                <p>Yep. Still more. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text.</p>
                <p>Last little bit of text.</p>
                <div id="top-info">
                    <h3>Important Information About Blah</h3>
                    <p class="indent"><strong>Again, with the text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text.  <a href="#ContH">CONTINUED BELOW</a></strong></p>
                </div>                    

        <img src="/images/divider.png" alt="" /><br/>
        <img src="/images/lg.png" alt="" /><br/>
        <img src="/images/divider.png" alt="" /><br/>
        <div><h2 class="centered">Some text with a suggested action.</h2></div>
        <a name="menu"></a>
        <div id="mainmenu-container" class="clear-block li-nav">
            <ul id="thismenu" class="links">
                <li><a href="/blah/index.html">Link 1</a></li>
                <li><a href="/moreblah/index.html">Link 2</a></li>
                <li><a href="/combined.html">Link 3</a></li>
                <li><a href="/coupons/index.html">Link 4</a></li>
                <li><a href="/how-to.html">Link 5</a></li>
            </ul>
        </div><!-- end mainmenu-container -->
        <p class="disclaimer">*Here is some text that is smaller than other text</p>
        <img src="/images/divider.png" alt="" /><br/>    

        <div id="info" class="clear">
            <h3 id="ContH">This is that important info linked to from above <em>(continued)</em></h3>
            <ul>
                <li><strong>This is a nested list of important stuff that is hiding behind the header when the link to the named anchor is clicked.</strong>
                <ul>
                  <li><strong>More important stuff that is hiding behind the header when the link to the named anchor is clicked.</strong></li>
                  <li><strong>There are lots of items in these nested lists, including:</strong>
                    <ul>
                        <li><strong>More important stuff that is hiding </strong></li>
                      <li><strong>behind the header when the link to the named anchor is clicked.</strong></li>
                    </ul>
                  </li>
                </ul>
              </li>
              <li><strong>Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text.</strong></li>
              <li><strong>Some more text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text.</strong></li>
              <li><strong>Still more text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text.</strong></li>
              <li>Yep. Still more. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text. Some text.</li>
            </ul>
            <p class="infoIndent">Last little bit of text that someone decided needed to line up with the bulleted list, but not be bulleted.</p>
        </div><!-- end info -->
        <div id="footer-base" class="clear">

            <p>Some text with a phone number for some additional info.</p>
            <div class="button full_btn"><a href="#mainmenu-container">Scroll Back to Menu</a></div>
            <p class="centered whitespace"><a href="http://www.fullwebsite.com/index.html?full=true">Full Web site</a></p>
            <div class="flinks">
                <center><a href="http://www.help4u.com"><img src="/images/help4u.png" alt="Help 4 U" /></a></center><br />
                <center><img src="/images/contact_us.png" alt="Contact Us" /></center><br />
                <center><a href="http://www.domain.com"><img src="/images/logo.png" alt="Corporation Web Site" /></a></center><br />
                <p class="centered">Blah text about website company<br />
                    Some more text about intended audience for the web site<br />
                    &#169; 1900 - 2013 Company Name. All Rights Reserved.<br />
                    <a href="/legal.html">Legal Notices</a> |
                    <a href="/privacy.html">Privacy Statement</a><br/>
                    <a href="http://www.help4u.com">Coupons</a> |
                    <a href="/contactus.html">Contact Us</a>
                </p>
                    <p>&nbsp;</p><p>&nbsp;</p>
            </div><!-- end flinks -->
         </div><!-- end footer-base -->            
       </div><!-- end main-content -->
     </div><!-- end content-wrapper -->
  </div><!-- end wrapper -->
</div><!--end global-wrapper -->
</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-24T18:23:33.767

这是我解决此问题的方法：

在我尝试链接的页面上的位置上方，我添加了

```
<div class="anchor-container"><div class="adjusted-anchor"></div></div> 
```

在 CSS

```
.anchor-container {position:relative;}
.adjusted-anchor {position:absolute;z-index: 10000;} 
```

还有这个 jQuery（它必须在窗口加载时才能加载标题中的任何图像）

```
$(window).load(function() {
   var h = $("#header-content");
   var headerHeight = h.outerHeight(true);
   headerHeight = Math.abs(headerHeight)*-1;
   $(".adjusted-isi-anchor").css( "top", headerHeight );
}); 
```

现在标题将加载，页面上的任何锚链接都将加载到标题的底部下方，而不是在它后面。

# jquery - jQuery，从最后一个孩子中删除文本

> ID：15483463
> 
> 赞同：3
> 
> 时间：2013-03-18T17:47:31.893
> 
> 标签：jquery

我设置了以下面包屑，我将如何删除列表项中的最后一个 »...

这是我要添加的代码，» 但我还想将其从列表中的最后一项中删除。

```
 $(".breadCrumbs li").append(" &raquo; "); 
```

[http://jsfiddle.net/RqWYq/](http://jsfiddle.net/RqWYq/)

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-18T17:49:06.630

不为最后一个 li 附加 >> 怎么样

```
$(".breadCrumbs li:not(:last)").append(" &raquo; "); 
```

[http://jsfiddle.net/RqWYq/1/](http://jsfiddle.net/RqWYq/1/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-18T17:50:07.260

我不会将它添加到最后一个 li。[http://jsfiddle.net/RqWYq/2/](http://jsfiddle.net/RqWYq/2/)

```
$(".breadCrumbs li").not(":last-child").append(" &raquo; "); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-18T17:49:53.717

你可以这样做：

```
$(".breadCrumbs li:not(:last-child)").append(" &raquo; "); 
```

# html - 按钮不同，每个框 css 保持相同的对齐方式

> ID：15483473
> 
> 赞同：-1
> 
> 时间：2013-03-18T17:48:01.170
> 
> 标签：html, css

他们无论如何都在这个页面上

[http://www.cmsni.net/portfolio/#!prettyPhoto](http://www.cmsni.net/portfollio/#!prettyPhoto)

将阅读按钮保持在同一高度，因为它看起来有点乱七八糟的地方谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T18:06:53.920

您需要重新考虑信息的布局以消除锯齿状内容，这是一种解决方案：

[http://jsfiddle.net/65UpU/](http://jsfiddle.net/65UpU/)

HTML

```
<div class="tbl">

    <div class="row">
        <div class="col">
            <img src="http://th02.deviantart.net/fs51/200H/f/2009/264/c/8/Cutie_Kitten_by_Littlemeteor.jpg" />
        </div>
        <div class="col">
            <img src="http://th02.deviantart.net/fs51/200H/f/2009/264/c/8/Cutie_Kitten_by_Littlemeteor.jpg" />            
        </div>
        <div class="col">
            <img src="http://th02.deviantart.net/fs51/200H/f/2009/264/c/8/Cutie_Kitten_by_Littlemeteor.jpg" />            
        </div>
        <div class="col">
            <img src="http://th02.deviantart.net/fs51/200H/f/2009/264/c/8/Cutie_Kitten_by_Littlemeteor.jpg" />           
        </div>
    </div> 

    <div class="row">
        <div class="col">
            <h2>This is a header</h2>
        </div>
        <div class="col">
            <h2>This is a jagged header</h2>
        </div>
        <div class="col">
            <h2>This is even more of a jagged header</h2>
        </div>
        <div class="col">
            <h2>Wow, I can't beleive how this is even more of a jagged header</h2>
        </div>
    </div>

    <div class="row">
        <div class="col">
            Lorem ipsum dolor sit amet, dictum libero aliquet non ac cras taciti, pede non lorem, ut nulla mauris tincidunt felis, id eleifend, netus ligula lobortis vestibulum interdum ipsam id
        </div>
        <div class="col">
            Lorem ipsum dolor sit amet, dictum libero aliquet non ac cras taciti, pede non lorem, ut nulla mauris tincidunt felis, id eleifend, netus ligula lobortis vestibulum interdum ipsam id. Ad gravida et hac sociosqu, libero in lacus in laoreet ac enim. Quam enim, venenatis pellentesque integer consequat mauris leo nibh, et nec ac libero odio lorem tristique. Ipsum pharetra nec nunc
        </div>
        <div class="col">
            Lorem ipsum dolor sit amet, dictum libero aliquet non ac cras taciti, pede non lorem, ut nulla mauris tincidunt felis, id eleifend, netus ligula lobortis vestibulum interdum ipsam id. Ad gravida et hac sociosqu, libero in lacus in laoreet ac enim. Quam enim, venenatis pellentesque integer consequat mauris leo nibh, et nec ac libero odio lorem tristique. Ipsum pharetra nec nunc ullamco, massa auctor adipiscing elit, etiam interdum nisl. Maecenas congue mauris dolor condimentum.
        </div>
        <div class="col">
Lorem ipsum dolor sit amet, dictum libero aliquet non ac cras taciti, pede non lorem, ut nulla mauris tincidunt felis, id eleifend, netus ligula lobortis vestibulum interdum ipsam id. Ad gravida et hac sociosqu, libero in lacus in laoreet ac enim. Quam enim, venenatis pellentesque integer consequat mauris leo nibh, et nec ac libero odio lorem tristique. Ipsum pharetra nec nunc ullamco, massa auctor adipiscing elit, etiam interdum nisl. Maecenas congue mauris dolor condimentum.
Proin convallis placerat est sed nullam consectetuer, eget ullamcorper arcu quam dignissim suscipit nunc. Nulla arcu ipsum tempor sit ut egestas, vitae fermentum praesent, nunc eu quam, eget porta dui et nunc. Cursus congue quam commodo, donec elit varius nullam amet nunc            
        </div>
    </div>    

    <div class="row_read_more">
        <div class="col">
            READ MORE
        </div>
        <div class="col">
            READ MORE
        </div>
        <div class="col">
            READ MORE
        </div>
        <div class="col">
            READ MORE
        </div>
    </div>    

</div> 
```

CSS

```
.tbl { width:1000px; }
.row { overflow:hidden;}
.row_read_more{ margin:20px 0 0 0; }
.col { width:230px; margin:0 20px 0 0; float:left; }
.col:last-child { margin:0; } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T17:59:10.613

我现在想到的唯一解决方案是将div设置为固定`height`并将`position`按钮`absolute`设置为底部。但我想，固定高度不是你想要的。

# javascript - 从 Rails 中的选择器动态添加关联

> ID：15483474
> 
> 赞同：0
> 
> 时间：2013-03-18T17:48:01.157
> 
> 标签：javascript, ruby-on-rails, dynamic, associations

我有点像铁轨菜鸟。我在一个名为 QuestionGroupQuestions 的表中存在 QuestionGroups 和 Questions 之间的多对多关系，该表属于 QuestionGroups 和 Questions。在我的 QuestionGroups 表单中，我有一个选择器来选择一个问题和一个“添加问题”按钮，该按钮动态存储一个隐藏的输入标签，该标签存储了每个选定的问题。像这样排序：

```
<input type="hidden" class="hidden_3" name="question_group_questions" value="3"> 
```

其中 value 存储问题 ID。我想将所有这些隐藏标签作为一个数组提交到 question_group_questions 表中。

如何使用 QuestionGroup_id 和隐藏标签的值作为 question_id 将这些隐藏输入作为关联提交到 QuestionGroupQuestions 表中？也许有更简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T19:38:46.207

当您为关系提供一组 ID 时，Rails 将创建必要的记录。要通过表单将数组传递给 Rails，请在属性名称后添加空方括号。在您的实例中，它看起来像这样：

```
<input type="hidden" class="hidden_3" name="question_group[question_ids][]" value="3" 
```

每个隐藏字段都将具有相同的名称，只有每个隐藏字段的值都是唯一的。

# jfreechart - XYItemRenderer::setSeriesPaint() 没有设置图表线的颜色

> ID：15483477
> 
> 赞同：2
> 
> 时间：2013-03-18T17:48:10.237
> 
> 标签：jfreechart

我正在尝试修改 PriceVolumeDemo1.java 中的 JFreeChart 示例代码以供我自己使用。（我敢肯定没有人记住所有的 JFreeChart 演示，我提到它只是为了完整。）它是一个图表，其中一条线代表价格，条形代表交易量。演示中的线条是红色的，条形是蓝色的。我正在尝试扭转这种情况（蓝线和红条）。我正在尝试使用 XYBarRenderer::setSeriesPaint() 和 XYItemRenderer::setSeriesPaint() 来执行此操作。请参阅下面的代码。

我在尝试更改颜色时修改的行遵循`/* */`块中的注释。

XYBarRenderer::setSeriesPaint() 按预期工作，将条设置为红色。但是 XYItemRenderer::setSeriesPaint() 不会将线设置为蓝色。有人可以看到我做错了什么吗？

```
private static JFreeChart createChart() {

    XYDataset priceData = createPriceDataset();
    String title = "Eurodollar Futures Contract (MAR03)";
    JFreeChart chart = ChartFactory.createTimeSeriesChart(
        title,
        "Date",
        "Price",
        priceData,
        true,
        true,
        false
    );
    XYPlot plot = (XYPlot) chart.getPlot();
    NumberAxis rangeAxis1 = (NumberAxis) plot.getRangeAxis();
    rangeAxis1.setLowerMargin(0.40);  // to leave room for volume bars
    DecimalFormat format = new DecimalFormat("00.00");
    rangeAxis1.setNumberFormatOverride(format);

    XYItemRenderer renderer1 = plot.getRenderer();
    /* This does NOT set the line graph to blue. */
    renderer1.setSeriesPaint(0, Color.BLUE);

    renderer1.setBaseToolTipGenerator(new StandardXYToolTipGenerator(
            StandardXYToolTipGenerator.DEFAULT_TOOL_TIP_FORMAT,
            new SimpleDateFormat("d-MMM-yyyy"), new DecimalFormat("0.00")));

    NumberAxis rangeAxis2 = new NumberAxis("Volume");
    rangeAxis2.setUpperMargin(1.00);  // to leave room for price line
    plot.setRangeAxis(1, rangeAxis2);
    plot.setDataset(1, createVolumeDataset());
    plot.setRangeAxis(1, rangeAxis2);
    plot.mapDatasetToRangeAxis(1, 1);
    XYBarRenderer renderer2 = new XYBarRenderer(0.20);
    renderer2.setBaseToolTipGenerator(
        new StandardXYToolTipGenerator(
            StandardXYToolTipGenerator.DEFAULT_TOOL_TIP_FORMAT,
            new SimpleDateFormat("d-MMM-yyyy"),
            new DecimalFormat("0,000.00")));
    plot.setRenderer(1, renderer2);
    ChartUtilities.applyCurrentTheme(chart);
    renderer2.setBarPainter(new StandardXYBarPainter());
    renderer2.setShadowVisible(false);
    /* This sets the bar colors to red. */
    renderer2.setSeriesPaint(0, Color.RED);
    return chart;

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-18T19:11:55.173

在创建图表后应用`ChartTheme`权利，然后再调用`setSeriesPaint()`.

```
JFreeChart chart = ChartFactory.createTimeSeriesChart(...);
ChartUtilities.applyCurrentTheme(chart);
XYPlot plot = (XYPlot) chart.getPlot(); 
```

# iphone - UITableView 从后台出现后消失

> ID：15483479
> 
> 赞同：0
> 
> 时间：2013-03-18T17:48:21.973
> 
> 标签：iphone, ios, objective-c, uitableview, uikit

我正在尝试创建一个顶部带有“正在播放”栏的音乐应用程序。我正在为 ui 使用标准故事板（UITabbarController->UINavigationController->UITableviewcontroller）

当有人点击 tableview 列表中的轨道时，一个小的 programmaticcaly 创建的 uiview 在导航栏下向下滚动，并且 tableview 向下移动。

这一切都很好。

但是，当通过点击主页按钮将应用程序发送到后台并再次重新打开时，表格视图会立即消失。这只发生在点击 homebutton 锁定 iPhone 并且解锁没有问题时。

这是我为 UIView 设置动画的代码

```
CGRect frame = self.tableView.frame;
frame.origin.y += 60;
frame.size.height -= 60;

if(!nowPlayingPopDown){
    //setup nowplaying view
    nowPlayingPopDown = [[UIView alloc] initWithFrame:CGRectMake(0, -60, 320, 60)];
    CGRect nowPlayingPopDownAnimatedLocation = CGRectMake(0, 0, 320, 60);

    nowPlayingPopDown.backgroundColor = [UIColor whiteColor];

    [self.view.superview addSubview:nowPlayingPopDown];

    //setup waveform background
    nowPlayingPopDownWaveformBackground = [[UIView alloc] initWithFrame:CGRectMake(60, 0, 0, 60)];
    nowPlayingPopDownWaveformBackground.backgroundColor = [UIColor orangeColor];
    [nowPlayingPopDown addSubview:nowPlayingPopDownWaveformBackground];

    //setup waveform imageview
    nowPlayingPopDownWaveform = [[UIImageView alloc] initWithFrame:CGRectMake(60, 0, 260, 60)];
    [nowPlayingPopDown addSubview:nowPlayingPopDownWaveform];

    //animate nowplaying bar in
    [UIView beginAnimations:nil context:nil];
    [UIView setAnimationDuration:0.5];
    [UIView setAnimationCurve:UIViewAnimationCurveEaseInOut];
    self.tableView.frame = frame;
    nowPlayingPopDown.frame = nowPlayingPopDownAnimatedLocation;
    [UIView commitAnimations];
} 
```

# python - python在函数之间传递变量

> ID：15483484
> 
> 赞同：0
> 
> 时间：2013-03-18T17:48:30.553
> 
> 标签：python, variables, parameter-passing

我正在尝试将整数传递给函数。我认为它可能不起作用，因为我多次调用它？例如，我在一个名为 Alist 的函数中创建了一个二维矩阵，然后将其返回。使用第二个函数，我通过 Alist 并为我想要从 Alist 中返回的值指定一个位置，然后返回。最后（到目前为止），第三个函数将要求返回值和 Alist。Alist 打印正常，但返回的值（节点）在应该为 4 时打印 0。我猜它正在使用代码顶部声明的 node = 0 变量，但我不知道为什么。

network.txt 的第一行是这样的：0,2,4,1,6,0,

```
Alist = []
node = 0

file = ("F:/media/KINGSTON/Networking/network.txt")

def create_matrix(file):
    with open('network.txt') as f:
        Alist = []
        for line in f:
            part = []
            for x in line.split(','):
                part.append(int(x))
            Alist.append(part)
    return Alist

def start_node(Alist):
        node = Alist[0][2]
        print (node)
        return node

#test neighbours to see if they can be used
def check_neighbours(node, Alist):
        print (Alist)
        print (node)
        #check for neighbours. if we start at [0][0] we must look for [0][1]
        #and [1][0]. Figure out how to add 1 to each cell to navigate across.

#running of code begins here
Alist = create_matrix(file)
start_node(Alist)
check_neighbours(node, Alist) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T17:55:39.147

这是您的问题，在“代码运行从这里开始”的第二行：

```
Alist = create_matrix(file) 
start_node(Alist) 
check_neighbours(node, Alist) 
```

当您调用 时`start_node(Alist)`，它会创建一个局部变量（恰好被调用`node`）并返回其值，您只需忽略该值。这意味着全局变量`node`（尽管名称巧合）没有被更改，所以它仍然是 0。

要完成这项工作，您需要执行与上面一行相同的操作：

```
node = start_node(Alist) 
```

* * *

然而，为了让你的代码不那么混乱，你真的应该做一些事情：

首先，删除顶部的`Alist = []`和。`node = 0`在函数之前定义它们会使您看起来希望它们在函数中用作全局变量，这是一种误导。（同样适用`file`——你确实需要定义，但不是在顶部。）

然后，如果您将所有顶级内容（包括这两个全局变量）抽象为一个函数，这将消除所有混淆的可能性。

所以，留下你的三个函数定义，然后：

```
def main():
    file = ("F:/media/KINGSTON/Networking/network.txt")
    Alist = create_matrix(file)
    node = start_node(Alist)
    check_neighbours(node, Alist)
main() 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-18T17:53:34.543

`create_matrix`在您编写函数时，您`Alist = []`正在创建一个新的局部变量`Alist`，它会影响全局变量`Alist`。尝试以下操作：

```
def create_matrix(file):
    global Alist  # Mark Alist as global variable
    with open('network.txt') as f:
        Alist = []
        for line in f:
            part = []
            for x in line.split(','):
                part.append(int(x))
            Alist.append(part)
    return Alist 
```

[`global`在关键字文档](http://docs.python.org/2/reference/simple_stmts.html#global)中查看更多信息。

# c# - YouTube 和验证码

> ID：15483494
> 
> 赞同：0
> 
> 时间：2013-03-18T17:48:47.643
> 
> 标签：c#, youtube, captcha

我使用以下内容创建了一个 YoutubeRequest：

```
settings = New YouTubeRequestSettings("appname", devkey", user, pass)
request = New YouTubeRequest(settings) 
```

但有时我有 CaptchaRequiredException。如何处理此异常并获取验证码 URL/IMG 等，谁能帮忙，我使用 c#？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T17:51:22.023

```
try
{
    settings = new YouTubeRequestSettings("appname", devkey", user, pass);
    request = new YouTubeRequest(settings);
}
catch (CaptchaRequiredException ex)
{
    //do something with ex.Url and ex.Token
} 
```

请参阅[Google 的文档](http://google-gdata.googlecode.com/svn/branches/NET2.0/clients/cs/docs/generated/html/AllMembers_T_Google_GData_Client_CaptchaRequiredException.htm)。

# ios - 在应用程序启动/恢复时检测在线状态 - 网络可能会延迟启动？

> ID：15483495
> 
> 赞同：2
> 
> 时间：2013-03-18T17:48:54.010
> 
> 标签：ios, reachability

我想在每次我的应用程序进入前台时执行可达性检查，以警告用户远程数据可能已过时。我可以相信 3G 或 Wi-Fi 在应用程序启动时已正确初始化的事实吗？或者我应该延迟可达性检查以避免“误报”。如果我应该延迟它，那么足够的延迟间隔是多少？

也许还有更推荐的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-18T18:10:14.840

始终尝试先进行连接。只有当它失败时，您才应该使用 Reachability 来确定您是否处于脱机状态，并确定何时应该自动重试。

尝试您的连接可能会重新激活网络，而检查它不会。

但是，完全适合收听 Reachability 的网络已上线的通知，然后再试一次（假设您尚未尝试）。

要清楚：

*   即使 Reachability 说它不可用，访问网络也可能会唤醒它，所以试试吧。
*   在尝试并失败后，Reachability 应该会告诉您网络是否可用。（不要完全相信它，但*一定*要用它来定制你的错误消息。）
*   Reachability 会检测到网络因其他原因而唤醒，因此当您收到 Reachability 的通知时再试一次。
*   不要忽视移动网络的复杂程度，并尽可能少做假设。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T17:57:15.063

> “我想在每次我的应用程序进入前台时执行可达性检查......”

将您的可达性检查 viewDidAppear：

```
-(void)viewDidAppear:(BOOL)animated {
    // reachability check
} 
```

iOS 开发者库的可达性：http: [//developer.apple.com/library/ios/#samplecode/Reachability/Introduction/Intro.html](http://developer.apple.com/library/ios/#samplecode/Reachability/Introduction/Intro.html)

# php - 如何通过引用动态设置多维数组中的值

> ID：15483496
> 
> 赞同：6
> 
> 时间：2013-03-18T17:48:57.137
> 
> 标签：php, multidimensional-array, pass-by-reference

这让我整个晚上都发疯了。基本上，我需要在清理值之后在多维数组中设置一个特定值，然后在验证值之后再次（可能取决于验证；如果验证失败，则需要将值设置为空字符串）。假设我有这个帖子数组：

```
$data['should']['be']['int'] = ' yjd'; 
```

在清理了值后，`filter_var( $value, FILTER_SANITIZE_NUMBER_INT );`我得到了一个空字符串。然后我需要以某种方式将值设置`$data['should']['be']['int']`为空字符串。

然后将该值传递给验证函数，该函数失败，因为空字符串不是整数。同样，该验证值需要设置`$data['should']['be']['int']`为空字符串。

在整个验证工作开始之前，我将所有相关键保存在一个数组中，所以当我需要清理或验证时，我已经有了这样的东西：

```
$keys = array(
    0 => 'should',
    1 => 'be',
    2 => 'int'
); 
```

然后，我尝试`$data`通过引用数组来设置新值，在 foreach 循环中使用上述键访问数组`&$data`，但无论我尝试什么，都无法访问。以上只是一个简化的例子。整个事情是验证类的一部分，所以我不知道传递`$data`数组的确切深度。

任何指针将不胜感激！谢谢你的帮助！

**编辑：** 以为我无法编辑帖子，但它最终只是我的互联网连接。请忽略我下面的评论。无论如何，这是我尝试递归调用的方法：

```
protected function set_value( &$data, $value ) {
    foreach( $data as &$val ) {
        if( is_array( $val ) ) {
            $this->set_value( $val, $value );
        } else {
            $val = $value;
        }
    }
} 
```

要开始循环，我这样做了：

```
$this->set_value( $data[$keys[0]], $value ); 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-18T18:15:30.100

你可以试试

```
$data = array();
$keys = array(
        0 => 'should',
        1 => 'be',
        2 => 'int'
);

$value = 'yjd';

echo "<pre>";
setValue($data,$keys,$value);
print_r($data); 
```

输出

```
Array
(
    [should] => Array
        (
            [be] => Array
                (
                    [int] => yjd
                )

        )

) 
```

使用的功能

```
function setValue(&$data, $path, $value) {
    $temp = &$data;
    foreach ( $path as $key ) {
        $temp = &$temp[$key];
    }
    $temp = $value;
    return $value ;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-01-09T14:42:38.580

你可以用[茴香酒](https://github.com/letsdrink/ouzo-goodies)来做：

```
Arrays::setNestedValue($array, array('should', 'be', 'int'), 'value'); 
```

请参阅[http://ouzo.readthedocs.org/en/latest/utils/arrays.html#setnestedvalue](http://ouzo.readthedocs.org/en/latest/utils/arrays.html#setnestedvalue)

# django - Heroku 上的 Django 应用程序

> ID：15483504
> 
> 赞同：0
> 
> 时间：2013-03-18T17:49:28.177
> 
> 标签：django, heroku

我一直在努力解决我认为我的帐户由于表太大而被关闭的问题？如我错了请纠正我。

```
=== HEROKU_POSTGRESQL_OL (DATABASE_URL)
Plan:        Dev
Status:      available
Connections: 0
PG Version:  9.1.8
Created:     2013-01-06 18:23 UTC
Data Size:   11.8 MB
Tables:      15
Rows:        24814/10000 (Write access revoked)
Fork/Follow: Unsupported 
```

我试着跑步

```
heroku pg:psql HEROKU_POSTGRESQL_OL 
```

查看表，但是如何确定哪个表有太多行并且在 psql 中淹没了我的数据库？

有一次，我确定这是哪张桌子。我可以去`heroku run manage.py shell`打电话`Model_with_too_many_rows.delete.all()`，我的帐户将不再被关闭吗？是否必须采取其他步骤才能将较小的 db 注册到 heroku，以便返回我的写访问权限？

对不起，如果这些问题是微不足道的，但我对 SQL 的理解是有限的。

编辑：我也相信曾经有一段时间我的数据库充满了条目，但我已经删除了它们。我可以运行任何命令来调整数据库大小以确认行数已减少？还是heroku会自动执行此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T18:47:28.153

可能有一种更智能的方法来按表检查行数，但我使用[pg-extras](https://github.com/heroku/heroku-pg-extras)插件并运行`pg:index_usage`.

您将在回到低于 10k 行限制后的约 5 分钟内重新获得对数据库的写入权限——Heroku 将检查这一点并自动更新限制。

# c++ - 有没有一种惯用的方法可以在 C++ 中创建委托集合？

> ID：15483505
> 
> 赞同：6
> 
> 时间：2013-03-18T17:49:31.457
> 
> 标签：c++, delegates, function-pointers, function-object

我想将具有相似签名的函数存储在集合中以执行以下操作：

```
f(vector<Order>& orders, vector<Function>& functions) {
    foreach(process_orders in functions) process_orders(orders);
} 
```

我想到了函数指针：

```
void GiveCoolOrdersToBob(Order);
void GiveStupidOrdersToJohn(Order);

typedef void (*Function)(Order);
vector<Function> functions;
functions.push_back(&GiveStupidOrdersToJohn);
functions.push_back(&GiveCoolOrdersToBob); 
```

或多态函数对象：

```
struct IOrderFunction {
    virtual void operator()(Order) = 0;
}

struct GiveCoolOrdersToBob : IOrderFunction {
    ...
}

struct GiveStupidOrdersToJohn : IOrderFunction {
    ...
}

vector<IOrderFunction*> functions;
functions.push_back(new GiveStupidOrdersToJohn());
functions.push_back(new GiveCoolOrdersToBob()); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-05T20:19:13.300

# 前提：

您提出的设计将起作用，但使用常规函数指针将大大限制您可以注册的回调类型，虽然更强大，但基于从固定接口继承的方法更冗长，需要客户端做更多工作才能定义回调。

在这个答案中，我将首先展示一些如何[**`std::function`**](http://en.cppreference.com/w/cpp/utility/functional/function)用于此目的的示例。这些示例几乎不言自明，展示了与`std::function`您概述的解决方案相比，使用如何以及为什么会带来优势。

但是，基于 的幼稚方法`std::function`也有其自身的局限性，我将列出这些。这就是为什么我最终建议你看看[**Boost.Signals2**](http://www.boost.org/doc/libs/1_53_0/doc/html/signals2.html)：它是一个非常强大且易于使用的库。我将在这个答案的最后提到 Boost.Signals2。希望了解基于`std::function`first 的简单设计将使您以后更容易掌握信号和插槽的更复杂方面。

* * *

# 基于 std::function<> 的解决方案

让我们介绍几个简单的类，并为一些具体示例打下基础。这里，an`order`是具有 an`id`并且包含多个`item`s 的东西。每个`item`都由 a 描述`type`（为简单起见，这里它可以是书或 dvd）和 a `name`：

```
#include <vector>
#include <memory>
#include <string>

struct item // A very simple data structure for modeling order items
{
    enum type { book, dvd };

    item(type t, std::string const& s) : itemType(t), name(s) { }

    type itemType; // The type of the item

    std::string name; // The name of the item
};

struct order // An order has an ID and contains a certain number of items
{
    order(int id) : id(id) { }

    int get_id() const { return id; }

    std::vector<item> const& get_items() const { return items; }

    void add_item(item::type t, std::string const& n)
    { items.emplace_back(t, n); }

private:

    int id;
    std::vector<item> items;
}; 
```

我要概述的解决方案的核心是下面的类`order_repository`，它的内部用法是`std::function`保存客户端注册的回调。

回调可以通过`register_callback()`函数注册，并且（非常直观地）通过`unregister_callback()`提供注册时返回的 cookie 通过函数取消`registered_callback()`注册：

该函数具有`place_order()`下订单的`process_order()`功能，以及触发处理所有订单的功能。这将导致按顺序调用所有已注册的处理程序。每个处理程序都会收到对同一已下订单向量的引用：

```
#include <functional>

using order_ptr = std::shared_ptr<order>; // Just a useful type alias

class order_repository // Collects orders and registers processing callbacks
{

public:

    typedef std::function<void(std::vector<order_ptr>&)> order_callback;

    template<typename F>
    size_t register_callback(F&& f)
    { return callbacks.push_back(std::forward<F>(f)); }

    void place_order(order_ptr o)
    { orders.push_back(o); }

    void process_all_orders()
    { for (auto const& cb : callbacks) { cb(orders); } }

private:

    std::vector<order_callback> callbacks;
    std::vector<order_ptr> orders;
}; 
```

该解决方案的优势在于使用`std::function`来实现*类型擦除*并[**允许封装任何类型的可调用对象**](https://stackoverflow.com/questions/15322058/is-there-a-use-case-for-stdfunction-that-is-not-covered-by-function-pointers/15322134#15322134)。

下面的帮助函数，我们将使用它来生成和放置一些订单，完成设置（它只是创建四个订单并为每个订单添加一些项目）：

```
void generate_and_place_orders(order_repository& r)
{
    order_ptr o = std::make_shared<order>(42);
    o->add_item(item::book, "TC++PL, 4th Edition");
    r.place_order(o);

    o = std::make_shared<order>(1729);
    o->add_item(item::book, "TC++PL, 4th Edition");
    o->add_item(item::book, "C++ Concurrency in Action");
    r.place_order(o);

    o = std::make_shared<order>(24);
    o->add_item(item::dvd, "2001: A Space Odyssey");
    r.place_order(o);

    o = std::make_shared<order>(9271);
    o->add_item(item::dvd, "The Big Lebowski");
    o->add_item(item::book, "C++ Concurrency in Action");
    o->add_item(item::book, "TC++PL, 4th Edition");
    r.place_order(o);
} 
```

* * *

现在让我们看看我们可以提供哪些类型的回调。首先，让我们有一个打印所有订单的常规回调函数：

```
void print_all_orders(std::vector<order_ptr>& orders)
{
    std::cout << "Printing all the orders:\n=========================\n";
    for (auto const& o : orders)
    {
        std::cout << "\torder #" << o->get_id() << ": " << std::endl;

        int cnt = 0;
        for (auto const& i : o->get_items())
        {
            std::cout << "\t\titem #" << ++cnt << ": ("
                      << ((i.itemType == item::book) ? "book" : "dvd")
                      << ", " << "\"" << i.name << "\")\n";
        }
    }

    std::cout << "=========================\n\n";
} 
```

还有一个使用它的简单程序：

```
int main()
{
    order_repository r;
    generate_and_place_orders(r);

    // Register a regular function as a callback...
    r.register_callback(print_all_orders);

    // Process the order! (Will invoke all the registered callbacks)
    r.process_all_orders();
} 
```

这是显示该程序输出的[实时示例。](http://liveworkspace.org/code/3SRz1U$80)

相当合理的是，您不仅限于注册常规函数：**任何可调用对象都可以注册为回调**，包括保存一些状态信息的*函子。*让我们将上面的函数重写为一个仿函数，它可以打印与上面函数相同的详细订单列表`print_all_orders()`，或者不包括订单项目的简短摘要：

```
struct print_all_orders
{
    print_all_orders(bool detailed) : printDetails(detailed) { }

    void operator () (std::vector<order_ptr>& orders)
    {
        std::cout << "Printing all the orders:\n=========================\n";
        for (auto const& o : orders)
        {
            std::cout << "\torder #" << o->get_id();
            if (printDetails)
            {
                std::cout << ": " << std::endl;
                int cnt = 0;
                for (auto const& i : o->get_items())
                {
                    std::cout << "\t\titem #" << ++cnt << ": ("
                              << ((i.itemType == item::book) ? "book" : "dvd")
                              << ", " << "\"" << i.name << "\")\n";
                }
            }
            else { std::cout << std::endl; }
        }

        std::cout << "=========================\n\n";
    }

private:

    bool printDetails;
}; 
```

以下是如何在小型测试程序中使用它：

```
int main()
{
    using namespace std::placeholders;

    order_repository r;
    generate_and_place_orders(r);

    // Register one particular instance of our functor...
    r.register_callback(print_all_orders(false));

    // Register another instance of the same functor...
    r.register_callback(print_all_orders(true));

    r.process_all_orders();
} 
```

这是[此实时示例](http://liveworkspace.org/code/3SRz1U$180)中显示的相应输出。

由于 提供的灵活性`std::function`，我们还可以将 的结果注册`std::bind()`为回调。为了用一个例子来证明这一点，让我们再介绍一个类`person`：

```
#include <iostream>

struct person
{
   person(std::string n) : name(n) { }

   void receive_order(order_ptr spOrder)
   { std::cout << name << " received order " << spOrder->get_id() << std::endl; }

private:

   std::string name;
}; 
```

类`person`有一个成员函数`receive_order()`。在某个对象上调用`receive_order()`一个特定对象已交付给该`person`对象的事实模型。`order``person`

我们可以使用上面的类定义来注册一个回调函数，将所有订单分派给一个人（*可以在运行时确定！*）：

```
void give_all_orders_to(std::vector<order_ptr>& orders, person& p)
{
    std::cout << "Dispatching orders:\n=========================\n";
    for (auto const& o : orders) { p.receive_order(o); }
    orders.clear();
    std::cout << "=========================\n\n";
} 
```

此时我们可以编写以下程序，注册*两个*回调：我们之前使用的打印订单的相同函数，以及将订单分派到特定实例的上述函数`Person`。以下是我们的做法：

```
int main()
{
    using namespace std::placeholders;

    order_repository r;
    generate_and_place_orders(r);

    person alice("alice");

    r.register_callback(print_all_orders);

    // Register the result of binding a function's argument...
    r.register_callback(std::bind(give_all_orders_to, _1, std::ref(alice)));

    r.process_all_orders();
} 
```

这个程序的输出显示在[这个活生生的例子](http://liveworkspace.org/code/3SRz1U$86)中。

当然，也可以使用*lambdas*作为回调。下面的程序建立在前面的程序的基础上，演示如何使用 lambda 回调将小订单分派给一个人，将大订单分派给另一个人：

```
int main()
{
    order_repository r;
    generate_and_place_orders(r);

    person alice("alice");
    person bob("bob");

    r.register_callback(print_all_orders);
    r.register_callback([&] (std::vector<order_ptr>& orders)
    {
        for (auto const& o : orders)
        {
            if (o->get_items().size() < 2) { bob.receive_order(o); }
            else { alice.receive_order(o); }
        }

        orders.clear();
    });

    r.process_all_orders();
} 
```

再一次，[这个活生生的例子](http://liveworkspace.org/code/3SRz1U$89)显示了相应的输出。

* * *

# 超越 std::function<> (Boost.Signals2)

上面的设计比较简单，比较灵活，使用方便。但是，它不允许做很多事情：

*   它不允许轻易冻结和恢复向特定回调分配事件；
*   它不会将相关回调集封装到*事件* 类中；
*   它不允许对回调进行分组和排序；
*   它不允许回调返回值；
*   它不允许*组合*这些返回值。

所有这些功能以及许多其他功能都由成熟的库提供，例如[**Boost.Signals2**](http://www.boost.org/doc/libs/1_53_0/doc/html/signals2.html)，您可能想看看。熟悉了上面的设计，你会更容易理解它是如何工作的。

例如，这是定义信号并注册两个简单回调的方式，并通过调用信号的调用运算符（来自链接的文档页面）来调用它们：

```
struct Hello
{
    void operator()() const
    {
        std::cout << "Hello";
    }
};

struct World
{
    void operator()() const
    {
        std::cout << ", World!" << std::endl;
    }
};

int main()
{
    boost::signals2::signal<void ()> sig;

    sig.connect(Hello());
    sig.connect(World());

    sig();
} 
```

像往常一样，这里是上述程序的一个[活生生的例子。](http://liveworkspace.org/code/3SRz1U$93)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T17:54:50.353

您可能想查看[`std::function`](http://en.cppreference.com/w/cpp/utility/functional/function)，您的向量将如下所示：

```
std::vector< std::function< void( Order ) > > functions; 
```

但请注意，`std::function`开销很小。对于实例，删除`new`：

```
function.push_back(GiveStupidOrdersToJohn()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T20:16:52.387

[Boost.Signal](http://www.boost.org/doc/libs/1_53_0/doc/html/signals/tutorial.html#idp160643312)正好解决您的问题。你应该看看那个。除非你有特殊要求。特别是 boost.signal 和 boost.function 和/或 std::function 使用类型擦除技术。因此，您可以拥有具有指定签名的可调用事物的向量。如果您的实体是普通的 C 函数（如您在示例中所使用的）或一般的函数对象或成员函数，这并不重要。你可以混合所有这些。

# java - JDBC 复制驱动程序总是在没有活动缓存的情况下返回相同的数据

> ID：15483506
> 
> 赞同：1
> 
> 时间：2013-03-18T17:49:35.477
> 
> 标签：java, mysql, hibernate, replication

我正在使用 MySQL JDBC 复制驱动程序`com.mysql.jdbc.ReplicationDriver`在 Master 和 Slave 之间转移负载。

我正在使用该连接 URL

```
jdbc.de.url=jdbc:mysql:replication://master:3306,slave1:3306,slave2:3306/myDatabase?zeroDateTimeBehavior=convertToNull&characterEncoding=UTF-8&roundRobinLoadBalance=true 
```

一旦我启动我的应用程序，我只会从它启动的地方获取数据，就像我正在处理数据库的锁定快照一样。如果我正在执行任何 CRUD 操作，则数据不可调用或不显示更新。mysql 的复制工作得很好，我可以从数据库中查询正确的数据。

没有二级缓存处于活动状态，我正在使用带有池连接的休眠

如果我使用的是普通的 JDBC 驱动程序，`com.mysql.jdbc.Driver`一切正常。那么为什么我总是得到相同的结果集，不管我在数据库中做了什么改变......

## 更新 1

好像和我的方面有关

```
@Aspect
public class ReadOnlyConnectionInterceptor implements Ordered {

private class ReadOnly implements ReturningWork<Object> {

    ProceedingJoinPoint pjp;

    public ReadOnly(ProceedingJoinPoint pjp) {
        this.pjp = pjp;
    }

    @Override
    public Object execute(Connection connection) throws SQLException {

        boolean autoCommit = connection.getAutoCommit();
        boolean readOnly = connection.isReadOnly();

        try {
            connection.setAutoCommit(false);
            connection.setReadOnly(true);
            return pjp.proceed();
        } catch (Throwable e) {
            //if an exception was raised, return it
            return e;
        } finally {
            // restore state
            connection.setReadOnly(readOnly);
            connection.setAutoCommit(autoCommit);
        }

    }

}

private int order;

private EntityManager entityManager;

public void setOrder(int order) {
    this.order = order;
}

@Override
public int getOrder() {
    return order;
}

@PersistenceContext
public void setEntityManager(EntityManager entityManager) {
    this.entityManager = entityManager;
}

@Around("@annotation(readOnlyConnection)")
public Object proceed(ProceedingJoinPoint pjp,
        ReadOnlyConnection readOnlyConnection) throws Throwable {
    Session hibernateSession = entityManager.unwrap(Session.class);
    Object result = hibernateSession.doReturningWork(new ReadOnly(pjp));
    if (result == null) {
        return result;
    }
    //If the returned object extends Throwable, throw it
    if (Throwable.class.isAssignableFrom(result.getClass())) {
        throw (Throwable) result;
    }
    return result;
}
} 
```

我用`@ReadOnlyConnection`. 在我对所有服务层方法进行注释之前，即使它们可能会相互调用。现在我只对请求方法进行注释，并且我处于状态，我在*第二次*调用时获取数据库更新。

1）进行初始调用=>按预期获取数据

2) 更改数据库中的数据

3) 再次进行相同的调用 => 从第一次调用中获取完全相同的数据

4）再次进行相同的调用=>获取更改的数据

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T14:43:14.700

问题`connection.setAutoCommit(false)`是它似乎在设置回`connection.setAutoCommit(true)`. 因此，将以下行添加到方面后，一切都按预期工作了

```
try {
    connection.setAutoCommit(false);
    connection.setReadOnly(true);
    return pjp.proceed();
} catch (Throwable e) {
    return e;
} finally {
    // restore state
    connection.commit(); // THIS LINE
    connection.setReadOnly(readOnly);
    connection.setAutoCommit(autoCommit);
} 
```

# sql - <> SARGable 与否？如果没有，我可以用什么代替？

> ID：15483508
> 
> 赞同：1
> 
> 时间：2013-03-18T17:49:41.073
> 
> 标签：sql

我想我会再尝试一次..

我见过有人说 <> 是可搜索的，<> 是不可搜索的，等等，抱歉，但我想澄清一下。我还想要一个似乎不可能得到的是一个使用 <> 的错误查询和一个使用不同运算符的更 SARGable 查询的示例。我已经看到有关如何进行大量查询 SARGable 的示例，但没有使用 <> 运算符的示例。

我已经尝试过一次，它一定是在人们头上，因为他们认为这不是一个真正的问题，但这是一个真正的问题，我想要一个真正的答案，如果我得到一个真正的答案，那么我可以看看我所有存储的过程，并就更改哪些过程做出更好的决定。

谢谢..

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-18T18:00:17.800

该运算符`<>`是 SARGable，但根据您要比较的内容，它可能无济于事。

参考： [http ://en.wikipedia.org/wiki/Sargable](http://en.wikipedia.org/wiki/Sargable)

> “很少提高性能的 Sargable 运算符：<>、IN、OR、NOT IN、NOT EXISTS、NOT LIKE”

像这样的运算符`=`更有可能提供良好的性能，因为数据库可以从索引中查找单个或有限数量的记录。使用`<>`算子时，数据库往往要扫描整个索引来获取相关记录。

数据库可以通过`<>`运算符使用索引的查询将是如果它是非唯一索引，并且列中几乎没有不同的值，因此可以使用索引消除许多记录，而不仅仅是单个或几条记录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T17:56:44.657

维基百科说它是一个 Sargable 运算符，很少提高性能

> Sargable 运算符：=,>,<,>=,<=,BETWEEN,LIKE 不带前导 %
> 
> 很少提高性能的 Sargable 运算符：<>、IN、OR、NOT IN、
> 
> NOT EXISTS, NOT LIKE Non-sargable 运算符：LIKE 带前导 %

[http://en.wikipedia.org/wiki/Sargable](http://en.wikipedia.org/wiki/Sargable)

# jquery - 使用 jquery nearest() 查找具有已知兄弟元素的最近元素

> ID：15483524
> 
> 赞同：4
> 
> 时间：2013-03-18T17:50:22.917
> 
> 标签：jquery, xpath, closest, siblings

我正在尝试使用 jquery 最接近命令来根据元素是否具有特定的兄弟元素来查找特定元素。我一直在使用不同的选择器，但还没有找到一个能满足我要求的选择器。

例如，如果结构类似于以下内容

```
<div>
    <table>
        <tr>
            <td>
                  <span a>cell 1</span>
                  <span>cell 2</span>
            </td>
            <td siblingmatch="true">
                  <span b>cell 1</span>
                  <span>cell 2</span>
            </td>
        </tr>
    </table>

    <span siblingmatch="true">test 1</span>
</div> 
```

如果我从标有 a 的跨度开始最近运行，我希望它返回它的父 td，因为它有一个标有兄弟匹配属性的兄弟。但是，如果我从标有 b 的跨度开始运行相同的命令，我希望它返回 table 标记，因为这是它找到的第一个父级，其兄弟级标记为 Siblingmatch 属性。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-18T18:04:21.340

你可以使用`parents`和`filter`方法。

```
$('span').click(function(){
    var matched = $(this).parents().filter(function(){
         return $(this).siblings('[siblingmatch]').length;
    }).first();
}); 
```

[http://jsfiddle.net/WW5qL/](http://jsfiddle.net/WW5qL/)

请注意，这`siblingmatch`不是一个有效的属性，您可以使用 HTML5`data-*`属性来代替。

# java - 单击按钮时从另一个类调用 JPanel 独立类以显示

> ID：15483525
> 
> 赞同：0
> 
> 时间：2013-03-18T17:50:23.477
> 
> 标签：java, swing, jpanel, layout-manager

问题是我要调用的另一个类（Clients.java）是一个独立的类，没有在 PosFrame.java 类中定义。我希望能够在 posFrame 类中单击按钮时将 Clients 类调用到 PosFrame 这是我的代码

```
public PosFrame(){

     gui();
}
public void gui(){
    frame.setSize(xSize,ySize);
    frame.setLayout(new BorderLayout());

    top_panel = new JPanel(new FlowLayout(FlowLayout.LEFT));
    top_panel.setMaximumSize(null);
    top_panel.setBackground(Color.LIGHT_GRAY);
    top_panel.setBorder(BorderFactory.createEtchedBorder());
    int top_height = (int)(Math.round(ySize * 0.05));
    top_panel.setPreferredSize(new Dimension(xSize,top_height));
    add(top_panel, BorderLayout.NORTH);

    center_panel = new JPanel(new BorderLayout());
    center_panel.setMaximumSize(null);
    add(center_panel, BorderLayout.CENTER);

    displayPanel();

    titlePanel = new JPanel();
    titleLabel = new JLabel("Order");
    titleLabel.setFont(tf);
    titleLabel.setForeground(Color.blue);
    //titlePanel.setBackground(Color.SILVER);
    titlePanel.add(titleLabel);
    titlePanel.setBorder(BorderFactory.createEtchedBorder());
    int title_height = (int)(Math.round(xSize * 0.03));
    titlePanel.setPreferredSize(new Dimension(xSize,title_height));
    center_panel.add(titlePanel,BorderLayout.NORTH);

    addTopButton();
} 
```

我的动作执行了代码

```
public void actionPerformed(ActionEvent evt){
    if(evt.getSource() == newOrder_btn){
        displayPanel.removeAll();
        buttonPanel.removeAll();
        titleLabel.setText("Order");
        displayPanel();
        displayPanel.revalidate();
    }
    if(evt.getSource() == order_btn){
        displayPanel.removeAll();
        titleLabel.setText("Orders");
        showOrderBottomButtons();
        displayPanel.revalidate();
    }
    if(evt.getSource() == client_btn){
        client = new Clients();
        displayPanel.removeAll();
        titleLabel.setText("Client");
        displayPanel.add(client);
        displayPanel.revalidate();
    }
       } 
```

显示 JPanel 的代码

```
 public void displayPanel(){
    tp = new JTabbedPane();
    String[] tablenumbers ={"1","2","3"};
    constraints = new GridBagConstraints();
    layout=  new GridBagLayout();
    displayPanel = new JPanel(new BorderLayout());

    topLeft.add(upPanel);
    topLeft.add(downPanel);

    tablePanel = showitemsOrdered();
    middleLeft.add(tablePanel);

    totalPanel = showTotalPanel();        
    bottomLeft.add(totalPanel);

    leftContent.add(topLeft,BorderLayout.NORTH);
    leftContent.add(middleLeft,BorderLayout.CENTER);
    leftContent.add(bottomLeft,BorderLayout.SOUTH);
    rightContent.add(new JPanel());
    tp.addTab("Order",leftContent);
    tp.addTab("Details",rightContent);

    leftPanel.add(tp,BorderLayout.WEST);
    leftPanel.add(panelToShowButtons,BorderLayout.EAST);

    displayPanel.add(leftPanel,BorderLayout.WEST);

    buttonPanel = new JPanel();
    buttonPanel.add(addOrderButtons());
    int button_height = (int)(Math.round(xSize * 0.04));
    buttonPanel.setPreferredSize(new Dimension(xSize,button_height));
    displayPanel.add(buttonPanel,BorderLayout.SOUTH);
    center_panel.add(displayPanel, BorderLayout.CENTER);
} 
```

我想用来替换 Jpanel 内容的类中的代码

```
public class Clients extends JPanel{
JPanel clientPanel,searchPanel,clientsDisplayPanel,clientsInputPanel;

JPanel cpanel = new JPanel();
   public Clients(){

   cpanel.add(showClientPanel());
    //setPreferredSize(new Dimension(xSize,ySize));
    cpanel.setVisible(true);
}
private JPanel showClientPanel(){
    clientPanel = new JPanel(new GridLayout(3,0));

    clientPanel.add(showSearchPanel());
    return clientPanel;
}
public JPanel showSearchPanel(){
    JPanel panel = new JPanel(new FlowLayout(FlowLayout.LEFT));
    panel.setPreferredSize(new Dimension(xSize,40));

    searchForClientsLabel = new JLabel("Search for clients");
    searchForClientsLabel.setPreferredSize(new Dimension(150,20));

    searchClientTextfield = new JTextField();

    findNowBtn = new JButton("Find now");
    clearBtn  = new JButton("Clear");
    panel.add(searchForClientsLabel);
    panel.add(searchClientTextfield);
    panel.add(findNowBtn);
    panel.add(clearBtn);

    return panel;
} 
```

}

当我单击客户端按钮时，第二类不显示任何人都可以帮助我提前谢谢，如果代码太长，请耐心等待。乔德虫

# android - Android 连接/网络配置

> ID：15483526
> 
> 赞同：1
> 
> 时间：2013-03-18T17:50:26.230
> 
> 标签：android, networking, connectivity

我有一个 WebService 在我公司网络内的远程 VM 中运行。

`http://VMaddress/servicename/`通过在地址栏 ( )中键入 url，我可以在笔记本电脑上使用 Chrome 来查看 JSON 响应。

但是，我无法使用 Android 模拟器执行此操作。我的公司使用代理，我已经在模拟器启动窗口和 Android 应用程序本身中定义了它。我可以连接到谷歌和其他东西，但我仍然无法连接到远程虚拟机。

所以我的问题是：

Android 模拟器中的网络是如何处理的？我知道它为 localhost 定义了一个不同的 ip，但是我是否应该至少能够在模拟器浏览器中看到 JSON 响应（因为我定义了允许我访问 Internet 的代理）？

模拟器不是在我的笔记本电脑的连接上运行吗？

我使用模拟器浏览器和 Android 应用程序都收到 403 禁止响应。

我还尝试了另一个 WebService URL ( `http://api.geonames.org/citiesJSON?north=44.1&south=-9.9&east=-22.4&west=55.2&lang=de&username=demo`)，我得到了 200 响应代码，因此我的应用程序可以正确访问 Internet）。

提前致谢

- -编辑 - -

我在笔记本电脑的连接设置中窥探并进入 Chrome 中的代理设置，我的服务器所在的虚拟机的代理出现异常。删除该异常会给我在模拟器中遇到的相同的 403 禁止错误。

如何将相同的例外应用于模拟器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T14:38:52.620

不知何故，我设法“解决”了这个问题。

我不完全确定这是原因，但我遵循了[这些步骤](https://stackoverflow.com/a/13590405/1756496)。模拟器必须在没有可用网络时启动。

我还使用以下选项在启动器菜单中设置了我公司的 DNS 服务器：（ `-dns-server server1,server2`从`ipconfig /all`命令提示符中获取值）。如果没有这些设置，它对我不起作用。

我在模拟器中手动配置了代理，按照[这些步骤](https://stackoverflow.com/a/5191876/1756496)创建了一个新的 APN 。

# html - 流体设计产生不均匀的柱子

> ID：15483531
> 
> 赞同：0
> 
> 时间：2013-03-18T17:50:38.987
> 
> 标签：html, css, twitter-bootstrap, sass, fluid-layout

我有一个用于显示视频的两列布局（不使用该特定任务的列，因为我已经在使用带有另一个侧边栏的列，并且这个内容部分导致我出现流体布局问题，特别是在第二列中，我目前让它显示为两列。

它通常渲染得很好，使用一些自定义 CSS 来修复对齐等 - 。

我的问题在于标题`<h4>{{video.title}}</h4>`的长度不同，因此当浏览器调整大小时，它会将其他内容向下推，导致直接父 div 的高度增加，从而导致顶级 div 的高度增加它包含在 ng-repeat 中（仅通过 JS 数组重复 div - 它是[AngularJS](http://angularjs.org)指令，与问题无关）。结果，它将其下方的任何 div 推到右侧，效果会导致一个比 div 略小的空白点，从而破坏了原本干净的列布局。

**HTML**

```
<div id="VideoContent" class="span9">
    <h3>Browse {{languageSelected}} Videos<span ng-hide="hasDifficulty(difficultySelected)"> ({{difficultySelected}})</span></h3>
    <div class="row-fluid">
        <div class="VideoSummary span4" ng-repeat="(videoIndex, video) in videos | filter: filterResults">
            <div class="VideoInfo">
                <div>
                    <div class="pull-left">
                        <img alt="Video Preview Image" src="./images/video1.png" />
                    </div>
                    <div>
                        <h4>{{video.title}}</h4>
                        <p>Language:  {{video.language}}</p>
                        <p>Difficulty Level:  {{video.difficulty}}</p>
                        <p>Topics:  <span ng-repeat="(topicIndex, topic) in video.topics">{{topic}}<span ng-hide="isLastTopic(topicIndex, video.topics)">, </span></span></p>
                        <p>Contributor:  {{video.origin.creator}}</p>
                    </div>
                </div>
                <p>{{video.description}}</p>
            </div>
            <div class="MiscInfo">
                <div>
                    <p class="pull-right label">{{video.views}} views</p>
                </div>
                <div>
                    <p class="pull-right label" ng-show="hasTranslation(video)">Translate</p>
                    <p class="pull-right label" ng-show="hasCaption(video)">Caption</p>
                </div>
            </div>
        </div>
    </div>
</div> 
```

**CSS (SASS)**

```
> div#VideoContent
  > div
    > div.VideoSummary
      display: inline-block
      margin-top: 20px
      &:first-child
        margin-left: 2.5%
      > div.VideoInfo
        > div
          > div
            display: inline-block
          > div:last-child
            margin-left: 30px
            > p
              line-height: 10px
        > p
          margin-top: 20px
      > div.MiscInfo
        border-top-width: 1px
        border-top-color: $Blue
        border-top-style: dotted
        padding-top: 10px
        > div
          display: inline
        > div:first-child
          margin-right: 10%
          > p
            float: left
        > div:last-child
          > p:last-child
            margin-right: 10px 
```

我知道 sass 不是最干净的 atm，我打算清理它（例如删除那些可怕的子选择器）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T20:37:56.740

哦，那是一些非常混乱的代码！

有问题的 h4 的容器（使用您糟糕的代码，我只能将其引用为“#VideoContent 的第五级子项的 div”）已`display`设置为`inline-block`.

内联块变得与其内容一样宽。

要使其宽度与内容尝试的宽度不同，您必须明确声明宽度：

```
...
          > div
            display: inline-block
            width:   15em
... 
```

如果你想保持你的布局流畅，那么你不应该`inline-block`首先使用。与`block`所有容器和儿童一起使用。明确设置容器的宽度。要创建两列，请浮动第一列并为第二列添加左边距。

你的代码完全是一个残骸，所以我为你写了一个干净的例子：http: [//jsfiddle.net/z6Gsh/2/](http://jsfiddle.net/z6Gsh/2/)

PS 你唯一的借口可能是 HTML 和 CSS 都是由 CMS 提供的，你不能修改它，你不得不重写很多 CSS。如果您自己编写了该 HTML，那么... ![你的代码很糟糕，你应该感觉很糟糕。](../Images/7ea8d04130d2ed83177dc8c6b6216b3e.png)

## 更新日期 2013-03-28

哦，所以你需要防止项目垂直增长？

来吧，维护你糟糕的代码结构：

```
$img-width: 200px
$Blue: blue

div#VideoContent
  width: 580px // You won't need this
  outline: 1px solid red
  > div
    > div.VideoSummary
      margin-top: 20px
      &:first-child
        margin-left: 2.5%
      > div.VideoInfo
        > div
          > div
            h4, p
              white-space: nowrap // Forcing the paragraphs be one line
              overflow-x: hidden // Trimming the lines 
              text-overflow: ellipsis // Adding three dots
              line-height: 1em // Fixing ridiculous line height
              margin: 0.5em // Fixing margins
          .pull-left
            float: left // The image is pulled to the left
          > div:last-child
            margin-left: $img-width + 30px // The text is pushed to the right
        > p
          margin-top: 20px
          clear: both // The text below the image should not start to the right of it
      > div.MiscInfo
        border-top-width: 1px
        border-top-color: $Blue
        border-top-style: dotted
        padding-top: 10px
        > div
          display: inline
        > div:first-child
          margin-right: 10%
          > p
            float: left
        > div:last-child
          > p:last-child
            margin-right: 10px

// This is for example
.pull-left
  width: $img-width
  height: 130px
  background-color: pink 
```

这个想法很简单。使用`white-space: nowrap`强制文本单行，使用`oveflow-x: hidden`修剪它并使用`text-overflow: ellipsis`添加三个点。

这些是要修复丑陋的两列对齐的更改：

1.  看在上帝的份上，删除所有`display: inline-block`声明，它们完全没有必要并且破坏了布局。
2.  应用于`float-left`图像 ( `.pull-left`)。
3.  应用于`margin-left: $img-width + 30px`描述 ( `> div:last-child`)，其中`$img-width`是图像的宽度。

耶！它具有魅力：

[http://d.pr/i/9Ma3+](http://d.pr/i/9Ma3+)

你可以在这里摆弄它：http: [//fiddlesalad.com/sass/example-for-stack/](http://fiddlesalad.com/sass/example-for-stack/)

不要忘记完全重写您的 HTML 并在语义上应用 CSS，而无需那些`>`层次结构。每次在浏览器中显示您当前的代码时，地球上的某个地方都会有一只小猫痛苦地死去。

# tomcat - 在 Tomcat 服务器上部署应用程序的问题

> ID：15483532
> 
> 赞同：0
> 
> 时间：2013-03-18T17:50:44.213
> 
> 标签：tomcat, netbeans, jsf-2, tomcat7

有一段时间我在学习 JSF/Java EE。从一开始，使用 Netbeans 将我的应用程序部署到 Tomcat7 服务器时，我就有一个烦人的问题。

该应用程序在每次保存时部署，但有时部署暂停，我需要停止调试，终止 java 进程并重新开始调试。这真的很烦人，但我不知道如何解决这个问题。有任何想法吗？

# tsql - 在 T-SQL 中计算日期范围

> ID：15483535
> 
> 赞同：1
> 
> 时间：2013-03-18T17:50:47.350
> 
> 标签：tsql

我有一个日期字段，我希望返回日期减去给定天数的结果。例如，WHERE @today - 30 会给我最近 30 天的数据。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T17:54:32.143

您可以使用 dateAdd。的语法`day`可能因您的 DBMS 而异

```
WHERE datecolumn BETWEEN dateAdd(day,-30,getDate()) AND getDate() 
```

或者

```
WHERE datecolumn > dateAdd(day,-30,getDate()) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T17:54:53.097

要计算日期范围，您可以使用：-

```
WHERE date_column BETWEEN date1 AND date2 
```

现在减去你可以使用： -

```
 DATEADD(DAY, -30, '9/1/2011') 
```

像：=

```
 WHERE datecolumn BETWEEN dateAdd(day,-30,date1) AND date2 
```

# arrays - 输出二维数组 - CodeIgniter

> ID：15483536
> 
> 赞同：0
> 
> 时间：2013-03-18T17:50:49.610
> 
> 标签：arrays, codeigniter, multidimensional-array

我正在尝试将子类别与其各自的父类别相匹配。现在我只是在视图的主要类别（书籍、衣服等）中进行硬编码，并具有获取所有子类别的功能，然后在视图中我可以创建一个 while 循环以将每个子类别与其主要类别匹配。

我已经设法将我想要的数据放入一个数组中，现在看起来像这样：

```
 array
  1 => 
    array 
      1 => string 'Medicine'
      2 => string 'Fairy tales' 
      3 => string 'Novels' 
    2 => 
    array
      44 => string 'Men's Clothing'
      45 => string 'Men's Accessories'
      49 => string 'Women's Swimwear' 
      50 => string 'Boys' 
      51 => string 'Girls' 
  3 => 
    array
      52 => string 'Perfume Sprays'
      53 => string 'Roll ons'
      54 => string 'Deodorants'
      64 => string 'Miscellaneous' 
```

其中1、2、3是主要类别ID，里面的数组对应subcat_id => subcat_name。

我在我的模型中通过以下方式获得了这个数组：

```
function getsub()
{
    $this->db->select('sub_id,sub_name,cat_id');
    $q = $this->db->get('subcategories');

    $subcats = array();

    foreach($q->result() as $row)
    {
        $subcats[$row->cat_id][$row->sub_id] = $row->sub_name;
    }

    return $subcats;
} 
```

然后在我看来，在我拥有的任何类别下，我都会创建一个 while 循环来显示与该 cat_id 匹配的所有子类别：

```
<ul class="dropdown-menu">
<?php while($subcats['cat_id'] == 1)?>

<?php{?>

  <li><a href="main/sub_prod/<?php echo $subcats['sub_id'];?>">
<?php echo $subcats['sub_name'];?></a></li>

<?php}?>

</ul> 
```

但是我在创建每个列表项的行上出现错误，说'未定义的索引：'subcat_name'。该列表项中的 subcat_id 也是如此。有人可以告诉我有什么问题吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T18:03:49.830

试试这个：

```
 <ul class="dropdown-menu">
<?php $i=0; 
 while($subcategories[$i]['cat_id'] == 1){?>

  <li><a href="customer/subcat_products/<?php echo $subcategories[$i]['subcat_id'];?>">
<?php echo $subcategories[$i]['subcat_name'];?></a></li>

<?php $i++;
 }?>

</ul> 
```

我添加了一个计数器，即 $i 变量。while 循环不迭代数组

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T18:33:09.430

它与您尝试访问数组元素的方式有关。您将其分配为

```
$subcategories[cat_id][subcat_id] 
```

但访问它作为

```
$subcategories['subcat_id/name'] 
```

这在两个方面是错误的：

1.  您缺少 cat_id。你需要类似 $subcategories[1][subcat_id]
2.  您没有定义字符串键。$subcategories[1]['subcat_id'] 不存在。现在，如果您有一个变量 $subcat_id，那么 $subcategories[1][$subcat_id] 将在下一行返回您要查找的 subcat_name，而不是 subcat_id...

您引入的另一个问题是您有一个无限循环。解决此问题的一个好方法是使用 foreach 循环，就像您的模型中的循环一样。

```
<?php foreach ($subcategories as $subcategory): ?>
<ul class="dropdown-menu">

  <?php foreach ($subcategory as $subcat_id => $subcat_name):
  <li><a href="customer/subcat_products/<?php echo $subcat_id; ?>">
  <?php echo $subcat_name; ?></a></li>
  <?php endforeach; ?>

</ul>
<?php endforeach; ?> 
```

这将遍历所有类别，打印出一个无序列表，其中每个子类别作为列表项。

# laravel - laravel-4 将需要配置的对象注入控制器的方法

> ID：15483542
> 
> 赞同：2
> 
> 时间：2013-03-18T17:51:16.893
> 
> 标签：laravel, laravel-4

我想找到一种将预配置对象传递给控制器​​的好方法。我知道我可以使用如下 IoC：

```
Mycontroller extends extends \Illuminate\Routing\Controllers\Controller {

    //i can only use one config uless i pass Request data
    $this->config = App::make('MyconfigObject');

} 
```

但这似乎有只能使用一个配置的限制。我宁愿做如下的事情：

```
Route::get('some-route', function()
{
    $config = Config::get('some.config');
    $object = new MyConfigObject($config);
    Route::dispatch(MyController($object));
}); 
```

我想这样做的原因是我想分派同一个控制器，但对多个路由具有不同的配置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T19:11:57.780

我对这种方法并不完全满意，但它是迄今为止我想出的最好的方法，使用 IoC 的自动分辨率。

引导/stat.php

```
/*
* bindings to the IoC container
*/
$app->singleton('MyNamespace\Transfer\TransferStategyInterface', function() {
    $config = Config::get('transfer-strategy');
    return new LocalTransferStrategy($config);
});

use MyNamespace\Transfer\TransferStategyInterface; 
```

TransferController.php

```
use MyNamespace\Transfer\TransferStategyInterface;

class TransferController extends BaseController {

    protected $transferStrategy;

    public function __construct(TransferStategyInterface $transferStrategy = null)
    {
        $this->transferStrategy = $transferStrategy;
    }
} 
```

# c# - RavenDB 2.x 异步中的 RegisterIdConvention

> ID：15483545
> 
> 赞同：1
> 
> 时间：2013-03-18T17:51:35.450
> 
> 标签：c#, asynchronous, ravendb

我正在尝试利用 RavenDB 的 DocumentConvention API 在我的域对象上自动设置增量 ID。

我在 IDocumentStore 上使用这行代码完美地工作：

```
DocumentStore.Conventions.RegisterIdConvention<User>
    ((dbname, commands, user) => "users/" + commands.NextIdentityFor("users")); 
```

每当我存储一个未设置 ID 的新用户对象时，这都会创建我的用户对象的顺序 ID，其中包含*"users/1"*、*"users/2"*等。

*但是，我想为异步文档会话执行此操作，但在调用RegisterAsyncIdConvention()*时无法找到有关如何从会话中获取“下一个身份”的任何文档...

```
docStore.Conventions.RegisterAsyncIdConvention<User>
    ((dbname, commands, user) => "users/" + commands.NextIdentityFor("users")); 
```

... 无法编译，因为*NextIdentityFor*在*IAsyncDatabaseCommands*接口上不可用。

任何人都可以给我任何提示吗？有没有人尝试过这样做？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-18T21:06:50.823

您使用顺序 ID 描述的行为已经是默认行为。您无需对约定进行任何特殊操作即可获得此行为。

它也适用于异步会话 - 但最初它在第一次存储时实际上并没有设置 id 属性的值。[这在此线程](https://groups.google.com/d/msg/ravendb/LXxhNiEhZTQ/EDz6i89wRa0J)的邮件列表中进行了讨论。我相信[拉取请求](https://github.com/ayende/ravendb/pull/247)使它成为最新的不稳定版本，但我尚未验证。

**更新** （来自评论）

默认情况下，约定是使用类型名称的复数形式。如果类型名称是单个单词，则以小写形式返回。如果它有多个单词，则保留大小写。

考虑：

```
var user = new User { Name = "Joe" };
session.Store(user);

var fooBar = new FooBar { Name = "Whatever" };
session.Store(fooBar);

Debug.WriteLine(user.Id);
Debug.WriteLine(fooBar.Id); 
```

在不更改约定的情况下，这将输出：

```
users/1
FooBars/1 
```

如果你想改变这个约定，你只需提供一个新的 lambda 函数：

```
documentStore.Conventions.FindTypeTagName = type => type.Name.ToLower(); 
```

运行与之前相同的代码，您现在将获得：

```
user/1
foobar/1 
```

但也许你想保持复数形式，只想要全部小写？

```
documentStore.Conventions.FindTypeTagName = type =>
              DocumentConvention.DefaultTypeTagName(type).ToLower(); 
```

输出：

```
users/1
foobars/1 
```

也许你总是想要 PascalCase？

```
documentStore.Conventions.FindTypeTagName = type =>
{
    var s = DocumentConvention.DefaultTypeTagName(type);
    return s.Substring(0, 1).ToUpper() + s.Substring(1);
}; 
```

输出：

```
Users/1
FooBars/1 
```

或者也许总是camelCase？

```
documentStore.Conventions.FindTypeTagName = type =>
{
    var s = DocumentConvention.DefaultTypeTagName(type);
    return s.Substring(0, 1).ToLower() + s.Substring(1);
}; 
```

输出：

```
users/1
fooBars/1 
```

# php - 使用模板和覆盖在 PHP/MySQL 中安排搜索

> ID：15483547
> 
> 赞同：6
> 
> 时间：2013-03-18T17:51:41.310
> 
> 标签：php, mysql, date, scheduling

我正在寻找一些关于相当复杂的搜索算法的建议/帮助。任何有关技术等的文章将不胜感激。

# 背景

我正在构建一个应用程序，简而言之，它允许用户为任何一天设置他们的“可用性”。用户首先设置一个通用可用性模板，允许他们说：

```
Monday - AM   
Tuesday - PM  
Wednesday - All Day  
Thursday - None  
Friday - All Day 
```

所以这个用户通常在周一上午、周二下午等可用。

架构：

```
id  
user_id  
day_of_week  (1-7)(Monday to Sunday)
availability 
```

然后，他们可以手动覆盖特定日期，例如：

```
2013-03-03 - am  
2013-03-04 - pm  
2013-03-05 - all_day 
```

架构：

```
id
user_id
date
availability 
```

这一切都很好 - 我正在生成一个日历，它结合了模板和覆盖，并允许用户修改他们的可用性等。

# 问题

我现在需要允许管理员用户搜索具有特定可用性的用户。因此管理员用户将使用日历来选择所需的日期和可用性并点击搜索。

例如，找到我可用的用户：

```
2013-03-03 - pm
2013-03-04 - pm
2013-03-05 - pm 
```

搜索过程必须使用模板化可用性和覆盖来搜索可用用户，然后返回最佳结果。理想情况下，它会返回始终可用的用户，但在没有单个用户可以匹配日期的情况下，我需要提供可以匹配的用户组合。

我知道这是一个相当复杂的问题，我不是在寻找完整的答案，也许只是一些指导或潜在相关技术的链接等。

# 我试过的

目前，我有一个半途而废的解决方案。我正在抓取所有可用的用户，遍历每个用户，并在该循环内，遍历所有必需的日期，并在用户不符合要求的日期时立即中断。这显然是非常不可扩展的，而且它也只返回“完美匹配”。

# 可能的解决方案

## 使用聚合表进行全文搜索

我考虑过创建一个具有以下架构的单独表：

```
user_id
body 
```

该`body`字段将填充用户模板天数和覆盖，因此示例记录可能如下所示：

```
user_id: 2
body: monday_am tuesday_pm wednesday_pm thursday_am friday_allday 2013-03-03_all_day 2013-03-03_pm 
```

然后，我会将用户搜索查询转换为类似的格式。因此，如果用户正在寻找在 2013 年 3 月 19 日 - 全天和 2013 年 3 月 20 日 - 下午有空的人，我会将其转换为字符串。

首先，由于 3 月 19 日是星期二，我会将其转换为 tuesday_allday，与 20 日相同。因此，我最终会得到：

```
tuesday_allday wednesday_pm 2013-03-19_allday 2013-03-20_pm 
```

然后我会对我们的聚合表进行全文搜索并返回一个“加权”结果集，然后我可以循环并进一步询问。

我不确定这在实践中是如何工作的，所以我问是否有人有任何我可以使用的技术或相关文章的链接。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-03-01T10:56:16.530

我相信这个问题可以通过定义更明确的数据库模式来解决。通过使用更详细的数据库模式，您将能够在任何给定的时间范围内（不仅仅是上午和下午）找到任何可用的用户，如果您应该选择的话。它还允许您保留模板数据，同时不会用模板信息污染您的可用性数据（相反，您可以从模板表中选择以编程方式填写给定日期的可用性，然后可以由用户修改）。

我花了一些时间绘制这个问题的图表，并提出了一个模式结构，我相信它可以解决您指定的问题，并允许您以最少的模式更改来扩展您的应用程序。（为了使这更容易阅读，我在此建议答案的末尾添加了 SQL）

我还包含了一个示例 select 语句，它允许您使用任意数量的参数提取可用性数据。为了清楚起见，SELECT 在我的解释性文本的结尾处位于架构的 SQL 之上。请不要被选择吓倒，乍一看它可能看起来很复杂，但实际上是整个模式的映射（保存模板表）。（顺便说一句，我并不是说因为我怀疑你能理解它，我相信你能理解，但我知道许多程序员忽略了更复杂的数据库结构而对自己不利，因为它看起来过于复杂但分析时实际上比他们在程序中为获得相似结果而必须做的杂技要简单......关系数据库基于[数学的一个分支](http://r937.com/relational.html)这很好@准确，一致，&（相对）简洁，关联数据）。

**一般使用：** （有关更多详细信息，请阅读 SQL CREATE TABLE 语句中的注释） - 填充 DaysOfWeek 表。- 使用您要跟踪的一些时间范围填充 TimeFrames 表（上午时间范围的开始时间可能为 00:00:00 和结束时间为 11:59:59，而下午可能有开始时间为 12:00:00 和结束时间23:59:59）-添加用户-添加要跟踪的日期（请参阅 SQL 中的注释以了解避免膨胀的想法以及此表的优点）-为每个用户填充模板表-生成默认可用性列表（与每个用户相关联的可用时间数据） - 向用户公开默认可用性，以便他们可以覆盖默认值注意：您还可以为参与添加一个可选表以与可用性相反（或者可能有一个更好的抽象可以包括这两个概念...） **免责声明：**我没有花额外的时间来完全填充我的本地数据库并验证所有内容，因此可能存在一些我在图表中没有看到的弱点/错误......（对不起，我在这方面花费的时间比预期的要长得多，必须开始工作在一个过期的项目上完成）。虽然我在数据库结构和其他人创建了 12 年以上的数据库方面进行了相当广泛的工作，但我确信我并非没有错，但我希望 StackOverflow 上的其他人能够完善我可能包含的错误。

对于没有包含更多示例数据，我深表歉意。如果我在不久的将来有时间，我会提供一些，（考虑将 George、Fred 和 Harry 添加到 users 表中，在 Dates 表中添加一些日期，然后详细说明 George 和 Fred 在上学期间与 Harry 相比有多忙可用性、可用时间和时间框架表）。

**SELECT 语句**（注意：我强烈建议将其放入[视图](https://stackoverflow.com/questions/4378068/when-to-use-a-view-instead-of-a-table)中……这样您就可以选择所需的任何列并在 WHERE 子句中添加所需的任何参数/条件，而不必每次都写出联接。 ..所以视图将不包括 WHERE 子句...只是为了说明这一点）：

```
SELECT *
FROM Users Us
JOIN Availabilities Av
ON Us.User_ID=Av.User_ID
JOIN Dates Da
ON Av.Date_ID=Da.Date_ID
JOIN AvailableTimes Avt
ON Av.Av_ID=Avt.Av_ID
WHERE Da.Date='2014-01-03' -- whatever date 
-- alternately: WHERE Da.DayOWeek_ID=3 -- which would be Wednesday
-- WHERE Da.Date BETWEEN() -- whatever date range...
-- etc... 
```

**DaysOfWeek 中的推荐数据**（实际上是一个查找表）：

```
INSERT INTO DaysOfWeek(DayOWeek_ID,Name,Description)
VALUES (1,'Sunday', 'First Day of the Week'),(1,'Monday', 'Second Day of the Week')...(7,'Saturday', 'Last Day of the Week'),(8,'AllWeek','The entire week'),(9,'Weekdays', 'Monday through Friday'),(10,'Weekends','Saturday & Sunday') 
```

**示例模板数据**：

```
INSERT INTO Templates(Time_ID,User_ID,DayOWeek_ID)
VALUES (1,1,9)-- this would show the first user is available for the first time frame every weekday as their default... 
,(1,2,2) -- this would show the first user available on Tuesdays for the second time frame 
```

**以下是推荐的架构结构**：

```
CREATE  TABLE `test`.`Users` ( 
```

`User_ID`INT NOT NULL AUTO_INCREMENT , `UserName`VARCHAR(45) NULL , PRIMARY KEY ( `User_ID`) );

```
CREATE  TABLE `test`.`Templates` (
  `Template_ID` INT NOT NULL AUTO_INCREMENT ,
  `Time_ID` INT NULL ,
  `User_ID` INT NULL ,
  `DayOWeek_ID` INT NULL ,
  PRIMARY KEY (`Template_ID`) )
`COMMENT = 'This table holds the template data for general expected availability of a user/agent/person (so the person would use this to set their general availability)'`;

CREATE  TABLE `test`.`Availabilities` (
  `Av_ID` INT NOT NULL AUTO_INCREMENT ,
  `User_ID` INT NULL ,
  `Date_ID` INT NULL ,
  PRIMARY KEY (`Av_ID`) )
COMMENT = 'This table holds a users actual availability for a particular date.\nIf the use is not available for a date then this table has no entry for that user for that date.\n(btw, this suggests the possiblity of an alternate table that could utilize all other structures except the templates called Engagements which would record when a user is actually busy... in order to use this table & the other table together would need to always join to AvailableTimes as a date would actually be in both tables but associated with different time frames).';

CREATE  TABLE `test`.`Dates` (
  `Date_ID` INT NOT NULL AUTO_INCREMENT ,
  `DayOWeek_ID` INT NULL ,
  `Date` DATE NULL ,
  PRIMARY KEY (`Date_ID`) )
COMMENT = 'This table is utilized to hold actual dates whith which users/agents can be associated.\nThe important thing to note here is: this may end up holding every day of every year... this suggests a need to archive this data (and everything associated with it for performance reasons as this database is utilized).\nOne more important detail... this is more efficient than associating actual dates directly with each user/agent with an availability on that date... this way the date is only recorded once, the other approach records this date with the user for each availability.';

 CREATE  TABLE `test`.`AvailableTimes` (
  `AvTime_ID` INT NOT NULL AUTO_INCREMENT ,
  `Av_ID` INT NULL ,
  `Time_ID` INT NULL ,
  PRIMARY KEY (`AvTime_ID`) )
COMMENT = 'This table records the time frames that a user is available on a particular date.\nThis allows the time frames to be flexible without affecting the structure of the DB.\n(e.g. if you only keep track of AM & PM at the beginning of the use of the DB but later decide to keep track on an hourly basis you simply add the hourly time frames & start populating them, no changes to the DB schema need to be made)';

CREATE  TABLE `test`.`TimeFrames` (
  `Time_ID` INT NOT NULL AUTO_INCREMENT ,
  `StartTime` TIME NOT NULL ,
  `EndTime` TIME NOT NULL ,
  `Name` VARCHAR(45) NOT NULL ,
  `Desc` VARCHAR(128) NULL ,
  PRIMARY KEY (`Time_ID`) ,
  UNIQUE INDEX `Name_UNIQUE` (`Name` ASC) )
COMMENT = 'Utilize this table to record the times that are being tracked.\nThis allows the flexibility of having multiple time frames on the same day.\nIt also provides the flexibility to change the time frames being tracked without changing the DB structure.';

CREATE  TABLE `test`.`DaysOfWeek` (
  `DaysOWeek_ID` INT NOT NULL AUTO_INCREMENT ,
  `Name` VARCHAR(45) NOT NULL ,
  `Description` VARCHAR(128) NULL ,
  PRIMARY KEY (`DaysOWeek_ID`) ,
  UNIQUE INDEX `Name_UNIQUE` (`Name` ASC) )
COMMENT = 'This table is a lookup table to hold the days of the week.\nI personally would recommend adding a row for:\nWeekends, All Week, & WeekDays \nThis will often be used in conjunction with the templates and will allow less entries in that table to be made with those 3 entries in this table.'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T18:22:15.030

好的，这是我会做的：

*   在用户表中为星期日、星期一...星期六创建字段。
*   使用`pm`,`am`或`both`表示这些字段中的值。
*   您还应该索引数据库中的每个字段以加快查询速度。
*   然后为用户/日期/子午线字段（子午线表示上午或下午）创建一个单独的表。再次，子午线字段值将是`pm`，`am`或`both`。
*   您将需要对[php 的 date 函数](http://php.net/manual/en/function.date.php)进行一些研究，以提取星期几，并可能使用 switch 语句来反对它。
*   使用请求的日期并提取星期几并查询用户表以了解其星期几的可用性。
*   然后使用请求的日期/子午线本身并查询新的用户/日期/子午线表以获取用户的个人可用日期/子午线。

我认为这里不会有太多算法，除非在日期请求中提取星期几。如果你正在做一个日期范围，那么你可以从算法中受益，但如果它只是一堆樱桃挑选的日期，那么你只需要一个一个地做。让我知道，也许我会给你一个算法。

# java - GWT：如何在 UiBinder 模板中使用常量

> ID：15483551
> 
> 赞同：4
> 
> 时间：2013-03-18T17:52:06.473
> 
> 标签：java, gwt, uibinder

我有一个关于 UiBinder 的问题。

我有以下 UiBinder 文件：

```
<!DOCTYPE ui:UiBinder SYSTEM "http://dl.google.com/gwt/DTD/xhtml.ent">
<ui:UiBinder xmlns:ui="urn:ui:com.google.gwt.uibinder"
             xmlns:g="urn:import:com.google.gwt.user.client.ui">
    <g:HTMLPanel>
        <div>
            <g:VerticalPanel>
                <g:Label>Please enter your password:</g:Label>
                <g:FlowPanel>
                    <g:PasswordTextBox ui:field="textbox"/>
                    <g:Button ui:field="button" text="Login" styleName="?????"/>
                </g:FlowPanel>
            </g:VerticalPanel>
        </div>
    </g:HTMLPanel>
</ui:UiBinder> 
```

如果我将样式名称放在???中，它可以正常工作。

但是，我们有一个常量文件（不是 i18n 常量），其中包含所有 css 名称作为常量。像：

```
public class CSSConstants {
    public static final String CSS_TITLE = "title";

    public static final String CSS_TEXT_NORMAL = "text_normal";
    public static final String CSS_TEXT_ERROR = "text_error";
    public static final String CSS_TEXT_ERROR = "button blue";
    .......
} 
```

我想知道如何在 UiBinder 模板中引用这个常量文件？

非常感谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-18T18:40:16.927

我希望这对您有用：1）在您的 Java 类中，为您的样式名称定义一个静态 getter：

```
public static String getSomeStyle(){} 
```

2) 访问您的样式名称，如下所示：

```
 <ui:with type="package.of.your.class.ClassName" field="yourClass"></ui:with>

<g:Button ui:field="button" text="Login" styleName="{yourClass.getSomeStyle}"/> 
```

这在访问 targetHistoryToken 值时可以正常工作，我希望它适用于您的情况。

当然，您可以使用扩展 ClientBundle 的接口轻松（且优雅地）做到这一点，但我认为这不是您想要的（如果我误解了您的需求，请纠正我，以便我提供更多提示）。

（抱歉，在发布我的答案之前我没有开发环境来测试它）

# jquery - jQuery：使用变量作为函数名

> ID：15483553
> 
> 赞同：5
> 
> 时间：2013-03-18T17:52:17.297
> 
> 标签：jquery, html

我正在尝试创建一个函数，该函数根据我正在与之交互的元素的类调用其他函数。

我希望能够使用元素的类来调用函数，而不是使用 if 语句。下面的例子：

```
function validate(thisInput){
    var thisClass = thisInput.attr("class").split(' ')[0];
    validate + class(thisInput); 
    /*This is what I would like to happen:
    the class is grabbed from above, then that class name (whatever it is)
    calls it's own function.  I will be creating a function for each class.
    */
}

function validateClassname(thisInput) {
    //do something
} 
```

如您所见，我试图找到类名，将其变成它自己的函数（不使用 if 语句来驱动它）然后让该函数执行它需要执行的任何操作。

我看错了吗？我应该以不同的方式去做吗？谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-18T17:57:13.877

> 我看错了吗？

是的。`foo`这是使用对象（并且`bar`是类名）的更明智的方法：

```
var validationRules = {
    foo: function( input ) { /* whatever */ },
    bar: function( input ) { /* whatever */ }
}

function validate(thisInput){
    var thisClass = thisInput.attr("class").split(' ')[0];

    validationRules[ thisClass ]( thisInput );
} 
```

此外，您可能需要重新考虑使用类名来存储信息。如果有多个班级，则不能保证您想要的班级就是第一个班级。而是查看[数据属性。](http://api.jquery.com/jQuery.data/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-18T17:58:58.977

您可以使用 eval() 函数来评估变量命名的函数：

```
var className = "OnName";
var classType = "OnType";

eval("validate" + className + "()")
// calls validateOnName()

eval("validate" + classType + "()")
// calls validateOnType()

var someInput = 234;
eval("validate" + classType + "(" + someInput + ")")
// calls validateOnType(234) 
```

并不是说这是一个理想的解决方案——也许您应该考虑使用一个通用函数或一组函数，而不是为多个类名使用多个函数。

# scala - 对特征的隐式转换

> ID：15483559
> 
> 赞同：3
> 
> 时间：2013-03-18T17:52:27.753
> 
> 标签：scala, generics, implicit-conversion

鉴于我具有以下特征

```
trait Foo[T]{
  ...
} 
```

我有使用此特征的案例类，我希望能够将 Foo[T] 隐式转换为 Foo[Z] （例如）。

例如，如果我有一个具体的实现

```
case class Blah[Model] extends Foo[Model] 
```

而且我有一个模型到视图的隐式转换......

我如何鼓励 Scala 转换`Blah[Model]`为`Blah[View]`?

```
trait Foo[T]{
  ...
  // not sure what to do here! 
  implicit def convertTtoZ .... (implicit converter: T=>Z) ...
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-18T18:00:08.083

您必须明确定义如何使用更改的参数构建特征：

```
scala> import language.implicitConversions

scala> class M
defined class M

scala> class N
defined class N

scala> implicit def m2n(m: M): N = new N
m2n: (m: M)N

scala> class X[A](val a: A) {}
defined class X

scala> implicit def xa2xb[A,B](x: X[A])(implicit ab: A => B) = new X(ab(x.a))
xa2xb: [A, B](x: X[A])(implicit ab: A => B)X[B]

scala> val xm = new X(new M)
xm: X[M] = X@21606a56

scala> def xnRequired(xn: X[N]) { println("Hi!") }
xnRequired: (xn: X[N])Unit

scala> xnRequired(xm)
Hi! 
```

# video-streaming - Flowplayer 广告和视频分辨率

> ID：15483561
> 
> 赞同：1
> 
> 时间：2013-03-18T17:52:39.717
> 
> 标签：video-streaming, flowplayer, ads

我正在开发一个在线流媒体和下载网站，并将使用 flowplayer (HTML 5) 在线流媒体视频。我的问题是如何在视频的开头/结尾显示广告？客户的另一个要求是在视频的中点显示广告？有可能这样做吗？

此外，是否可以提供更改视频分辨率的选项（就像 youtube 上的一样？）

# c++ - 通用成员函数指针作为另一个类中的模板参数

> ID：15483563
> 
> 赞同：4
> 
> 时间：2013-03-18T17:52:46.703
> 
> 标签：c++, function, templates, generics, member

我的问题与[此](https://stackoverflow.com/questions/9779105/generic-member-function-pointer-as-a-template-parameter)类似。而“Karrek SB”的回答实际上对我有所帮助。我有这些课程：

基数.h：

```
class Base{
public:
   Base(){}
   virtual ~Base(){}
   virtual void init() = 0;
}; 
```

A1.h：

```
#include <iostream>
#include "Base.h"

using namespace std;

class A1 : public Base{
public:
   A1(){}
   virtual ~A1(){};
   virtual void init(){
      cout << "A1::init() called" << endl;
   }
   void f1(){
      cout << "Im in A1::f1" << endl;
   }

   void f2(int val){
      cout << "Im in A1::f2 with val: " << val << endl;
   }
}; 
```

我有另一个类应该能够存储任何类型和数量的参数的任何通用成员函数。该类看起来像这样：

MFholder.h：

```
#include <functional>
#include <deque>

using namespace std;

class MFHolder{
    public:
       MFHolder(){};
       ~MFHolder(){};

       template<typename T, typename R, typename ... Args>
       R addMF(T & obj, R (T::*pf)(Args ...), Args&& ... args){
           mfp.push_back(function<void()>(bind(pf, &obj, forward<Args>(args) ...)));
       }

       void runTasks(){
           while(!mfp.empty()){
               auto task = mfp.front();
               mfp.pop_front();
               task();
           }
       }
    private:
       deque< function<void()> > mfp;
}; 
```

现在我想从 main 向 MFHolder 添加一些成员函数，如下所示：main.cpp：

```
#include "A1.h"
#include "MFHolder.h"

int main(){
   MFHolder mfh;
   A1 a1Obj;
   //A2 a2Obj; //this should also work

   int val = 42;
   //mfh.addMF(a1Obj, &A1::f1); //this should also work
   mfh.addMF(a1Obj, &A1::f2, val);
   //add some more function calls here...

   //run all the tasks
   mfh.runTasks();

   return 0;
} 
```

编译代码时出现以下错误。

> 没有匹配的调用函数`'MFHolder::addMF(A1&, void (A1::*)(int), int&)'`

候选人是：

```
template<class T, class R, class ... Args> R MFHolder::addMF(T&, R (T::*)(Args ...), Args&& ...) 
```

提前谢谢！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T02:28:22.213

在 addMF 的定义中将 Args&& 更改为 Args& 或在调用时将 val 更改为 move(val)。

# android - 有没有办法避免在移动应用程序中对服务端点进行硬编码？

> ID：15483565
> 
> 赞同：0
> 
> 时间：2013-03-18T17:52:47.547
> 
> 标签：android, rest

例如，我们正在并行开发移动解决方案和该解决方案的服务，因此可以在发布某些功能之前验证其有用性。在我们的场景中，我们使用签名的 android 包，但这可能适用于任何不希望手动更新服务端点的客户端应用程序。

所以在开发过程中，我们的 APK 指向`https://rest-dev.myapp.com/api`. 现在我们必须构建一个全新的 APK 指向它`https://rest-qa.myapp.com/api`，更糟糕的是我们的生产服务器在`https://rest.myapp.com/api`.

当我们测试一个包 (myapp-qa.apk) 时，它不是按位发布给客户的应用程序 (myapp-release.apk)，我们冒着巨大的风险（即使我们内部知道它“应该”是相同的代码，只是重新编译和打包）。

这个问题以前是怎么解决的？

**编辑**到目前为止有趣的解决方案。如果我添加了服务可以由客户托管并且我们在编译时不知道端点 URL 的约束怎么办？:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T18:00:25.320

如果您不介意最终用户看到终点是什么，那么您可以简单地使用共享首选项（或任何其他存储数据的方式）。我在上一个应用程序中使用了这种技术。

使用 a`PreferenceActivity`和 simle`EditTextPreference`作为终点。将默认值设置为您的生产端点。然后在测试时，将值更改为测试结束点。

当您实际需要连接时，请阅读共享首选项值（默认为您的生产值）并使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T18:01:37.540

有几种方法可以做到这一点，这取决于你想要什么。一种方法是检查 BuildConfig.DEBUG 和 .RELEASE 变量并基于这些以编程方式选择端点。另一种方法是在应用程序中提供一个选择器，允许您根据某些设置点击任何端点（共享首选项或文件的存在/不存在是这样做的好方法）。

# javascript - 基于名称映射 HTML 表单的 JavaScript 模板引擎

> ID：15483569
> 
> 赞同：0
> 
> 时间：2013-03-18T17:52:55.093
> 
> 标签：javascript, backbone.js, asp.net-mvc-4, template-engine

我正在使用主干 js 来处理我的视图和模型，但我希望在 ASP.NET MVC 中使用 Html.EditorFor 呈现模板。这是因为我的表单是基于 C# 类动态创建的。我只为 JavaScript 模板尝试过下划线，但它需要像这样在值字段中进行标记，这`<%=heading%>`对我来说不是一个选项。我需要一个模板引擎，它可以使用每个表单组件的名称映射我的表单，或者如果有其他视图引擎可以呈现适用于服务器和 js 模板引擎的相同标记。

**更新**

在我看来，我正在使用 Html.EditorFor 像这样：

```
@foreach (var type in Html.GetAvailablePageModels()) {
    var content = Activator.CreateInstance(type) as IContent;
    <script id="view-template-@type.Name" type="text/html">
        @using (Html.BeginForm()) {
            @Html.EditorFor(x => content)
            <input type="submit" value="Save"/>
        }
    </script>
} 
```

然后在我的主干视图中，我正在做这样的事情：

```
var PageModel = Backbone.Model.extend({
    urlRoot: '/api/page'
});
var page = new PageModel({ id: 'articles/85' });
page.fetch();

var EditView = Backbone.View.extend({

    el: $('div#main'),

    initialize: function () {
        this.template = _.template($('#view-template-Article').html());
        this.render();
    },

    render: function () {
        $(this.el).html(this.template(this.model.toJSON())); // <-- set the values correct in my pre rendered form
        return this;
    }

});

window.editView = new EditView({ model: page }); 
```

在上面我将模型绑定到模板的代码中，我需要确保名为 header 的字段绑定到 name="heading" 的正确表单字段。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T03:26:34.823

更改下划线模板的工作方式：

```
 _.templateSettings = {
  interpolate : /\{\{([\s\S]+?)\}\}/g
}; 
```

现在您可以编写如下 HTML 模板：

```
This is a message: {{message}} 
```

而不是老式的`<%= message %>`风格。这将允许您从服务器上的 Razor 视图生成所需的模板。我曾经在一个项目上这样做过，效果非常好。

# project - 将 Fgallery 添加到我的应用程序中

> ID：15483571
> 
> 赞同：-1
> 
> 时间：2013-03-18T17:53:03.343
> 
> 标签：project, add

如果有人可以向我展示（逐步）如何将外部项目添加到现有应用程序，我将不胜感激。我一直在自己尝试，但到目前为止我还没有成功。

那么如何将 Fgallery 添加到我的故事板应用程序中呢？

[https://github.com/gdavis/FGallery-iPhone](https://github.com/gdavis/FGallery-iPhone)

我这样做是为了学习，所以请不要在谈话中涉及技术，只要给我看，我会尝试自己理解每一步。我就是这样学习的:)

非常感谢您的宝贵时间！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T14:52:26.587

首先添加 fgalleryappdelegate.h/m、fgalleryphoto.h/m、fgalleryphotoview.h/m、fgalleryviewcontroller.h/m 和 rootviewcontroller.h/m。然后根据需要编辑 rootview 控制器，然后将导航控制器添加到情节提要并将其连接到 rootviewcontroller。

然后你在 rootview.m 中编辑这部分以获得你自己的图片

# pragma mark - 查看生命周期

```
- (void)loadView {
[super loadView];

self.title = @"FGallery";
self.navigationController.navigationBar.barStyle = UIBarStyleBlackTranslucent;

localCaptions = [[NSArray alloc] initWithObjects:@"Lava", @"Hawaii", @"Audi", @"Happy New Year!",@"Frosty Web",nil];
localImages = [[NSArray alloc] initWithObjects: @"lava.jpeg", @"hawaii.jpeg", @"audi.jpg",nil];

networkCaptions = [[NSArray alloc] initWithObjects:@"Happy New Year!",@"Frosty Web",nil];
networkImages = [[NSArray alloc] initWithObjects:@"http://farm6.static.flickr.com/5042/5323996646_9c11e1b2f6_b.jpg", @"http://farm6.static.flickr.com/5007/5311573633_3cae940638.jpg",nil]; 
```

}

# javascript - 找出何时通过 Javascript 在 EPUB FXL 中查看页面

> ID：15483574
> 
> 赞同：3
> 
> 时间：2013-03-18T17:53:15.883
> 
> 标签：javascript, epub, ibooks

是否可以查明何时使用 Javascript 查看 EPUB 固定布局的页面？

有 DOMContentLoaded 事件，但相邻页面在 iBooks 中预加载时也会触发此事件，导致动画或声音在页面可见之前开始...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-23T11:43:02.663

不，这不对。

这是 iBooks 的“功能”。它会预加载页面，我想以后可以更快地翻页。不幸的是，没有办法检测到页面正在预加载而不是实际查看。

只有一种方法可以解决这个问题——在每个页面上强制用户交互（点击某些东西）来启动动画或声音。您甚至可能需要构建您的 JS，以便在用户交互发生之前不加载 JS 本身。无论如何，如果没有用户交互，视频就不会开始播放。

# c# - 根据另一个下拉列表中的选定值动态填充下拉列表

> ID：15483576
> 
> 赞同：2
> 
> 时间：2013-03-18T17:53:20.673
> 
> 标签：c#, asp.net

我有两个下拉列表，其中一个在页面加载时填充，另一个应该仅在第一个中选择值时填充。第一个下拉列表定义为：

```
<asp:DropDownList ID = "base_ddl" runat="server" ToolTip="Base" OnSelectedIndexChanged = "BaseSelected">
//  snip...
</asp:DropDownList> 
```

然后，在方法`secondary_ddl`中填充第二个下拉列表 ( ) 。`OnSelectedIndexChanged``BaseSelected`

```
 public void BaseSelected(object sender, EventArgs e)
    {
        if (base_ddl.SelectedValue == "-1")
        {
            secondary_ddl.Visible = false;
        }
        else 
        {
            secondary_ddl.Items.Clear();

            // extract information to populate dropdown here
            // snip.
            IList<InfoContainer> info = getInfoBasedOnSelected(base_ddl.Value);

            foreach (InfoContainer i in info)
            {
                secondary_ddl.Items.Add(new ListItem(i.name, i.value));
            }
        }
    } 
```

这不起作用，这导致了这个问题：为什么？如何从`OnSelectedIndexChanged`另一个下拉列表的函数中动态更新该下拉列表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T18:01:57.667

第一组`AutoPostBack="True"`属性`base_ddl`

接着

```
secondary_ddl.Items.Clear();
IList<InfoContainer> info = getInfoBasedOnSelected(base_ddl.Value);
secondary_ddl.DataTextField = "name";
secondary_ddl.DataValueField = "value";
secondary_ddl.DataSource = info;
secondary_ddl.DataBind(); 
```

# visual-studio-2012 - 使用 Visual Studio 2012 构建失败

> ID：15483577
> 
> 赞同：1
> 
> 时间：2013-03-18T17:53:23.280
> 
> 标签：visual-studio-2012

我在尝试调试 Visual Studio 2012 中的代码时遇到了问题。我在一个解决方案文件中有一系列类文件和 Asp.Net 页面。Asp.Net 页面调用类库中的函数并获取所需的详细信息。

一切正常，直到我将许可证从 Visual Studio 2010 升级到 Visual Studio 2012。问题是对程序集的引用丢失并且构建失败。此外，单独的类文件项目编译后的 Dll 将被删除。

请让我知道是否有人遇到过类似的问题和解决方案。

谢谢，亚加

# linux - 在 Linux 中递归搜索父目录中的文件

> ID：15483578
> 
> 赞同：0
> 
> 时间：2013-03-18T17:53:24.703
> 
> 标签：linux

我正在尝试列出父目录及其子目录中的所有文件。但是，我正在从另一个位置运行此命令。所以，首先，我需要遍历目录（从我想运行这个命令的地方）。

请注意，我使用的是 find 命令而不是 ls，因为我还想列出它前面每个文件的绝对路径。ls 命令无法做到这一点。

这就是我正在做的事情：

```
cd ../../../;cd level1_dir1;find $(pwd) . -name *.* -printf "%TY-%Tm-%Td\t%p\n" 
```

此命令不显示任何输出。

这是目录结构：

```
level1_dir1 
```

这有多个子目录：

```
level2_dir1
level2_dir2

....

level2_dir10 
```

这些子目录中的每一个都再次在其中包含子目录和文件。

但是，现在如果我这样做：

```
cd ../../../;cd level1_dir1/level2_dir1;find $(pwd) . -name *.* -printf "%TY-%Tm-%Td\t%p\n" 
```

它将对 level2_dir1 中的所有子目录正确执行递归并显示如下输出：

```
date level1_dir1/level2_dir1/path/to/file/filename 
```

所以，我想以这种方式（通过使用通配符）打印出所有 level2 目录：

```
cd ../../../;cd level1_dir1/*;find $(pwd) . -name *.* -printf "%TY-%Tm-%Td\t%p\n" 
```

但它只打印level2中第一个目录的结果（即level2_dir1）

如何让它列出所有子目录的文件？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T18:09:24.450

这个怎么样？

```
find ../../../level1_dir1 -printf "%TY-%Tm-%Td\t%p\n" 
```

如果你想要所有文件，你甚至不需要 find 命令中的 -name 。如果您不想查看目录而只查看文件，只需在 -printf 之前添加“-type f”即可。

希望这可以帮助...

# angularjs - angularjs ckeditor 指令有时无法从服务加载数据

> ID：15483579
> 
> 赞同：12
> 
> 时间：2013-03-18T17:53:24.853
> 
> 标签：angularjs, ckeditor

我使用[了 Vojta 的 angularJS 指令](https://stackoverflow.com/questions/11997246/bind-ckeditor-value-to-model-text-in-angularjs-and-rails)，但有时 ckeditor 无法显示来自服务的数据。这几乎从未在刷新时发生，但在导航回页面时经常发生。我能够验证 $render 函数总是使用正确的数据调用 ck.setData，但有时它不会显示。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-18T17:53:24.853

似乎 $render 方法有时会在 ckeditor 准备好之前被调用。我能够通过向 instanceReady 事件添加一个侦听器来解决此问题，以确保在 ckeditor 准备好后至少调用它一次。

```
 ck.on('instanceReady', function() {
    ck.setData(ngModel.$viewValue);
  }); 
```

为了完整起见，这里是我使用的完整指令。

```
//Directive to work with the ckeditor
//See http://stackoverflow.com/questions/11997246/bind-ckeditor-value-to-model-text-in-angularjs-and-rails
app.directive('ckEditor', function() {
  return {
    require: '?ngModel',
    link: function(scope, elm, attr, ngModel) {
      var ck = CKEDITOR.replace(elm[0],
            {
                toolbar_Full:
                [
                { name: 'document', items : [] },
                { name: 'clipboard', items : [ 'Cut','Copy','Paste','PasteText','PasteFromWord','-','Undo','Redo' ] },
                { name: 'editing', items : [ 'Find','Replace','-','SpellChecker', 'Scayt' ] },
                { name: 'forms', items : [] },
                { name: 'basicstyles', items : [ 'Bold','Italic','Underline','Strike','Subscript','Superscript' ] },
                { name: 'paragraph', items : [
                'NumberedList','BulletedList','-','JustifyLeft','JustifyCenter','JustifyRight','JustifyBlock' ] },
                { name: 'links', items : [] },
                { name: 'insert', items : [ 'SpecialChar' ] },
                '/',
                { name: 'styles', items : [ 'Styles','Format','Font','FontSize' ] },
                { name: 'colors', items : [] },
                { name: 'tools', items : [ 'Maximize' ] }
                ]
                ,
                height: '290px',
                width: '99%'
            }
    );

      if (!ngModel) return;

      //loaded didn't seem to work, but instanceReady did
      //I added this because sometimes $render would call setData before the ckeditor was ready
      ck.on('instanceReady', function() {
        ck.setData(ngModel.$viewValue);
      });

      ck.on('pasteState', function() {
        scope.$apply(function() {
          ngModel.$setViewValue(ck.getData());
        });
      });

      ngModel.$render = function(value) {
        ck.setData(ngModel.$viewValue);
      };

    }
  };
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-07-02T22:02:19.650

```
 function updateModel() {
        scope.$apply(function() {
            if ( ck.getData().length ) {
                ngModel.$setViewValue(ck.getData());
            }
        });
    } 
```

# 查看完整代码：

```
return {
    require: '?ngModel',
    scope: true,
    link: function (scope, element, attr, ngModel) {
        if (!ngModel) return;

        var ck = CKEDITOR.replace(element[0]);

        ck.on('instanceReady', function() {
            ck.setData(ngModel.$viewValue);
        });

        function updateModel() {
            scope.$apply(function() {
                if ( ck.getData().length ) {
                    ngModel.$setViewValue(ck.getData());
                }
            });
        }

        ck.on('pasteState', updateModel);
        ck.on('change', updateModel);
        ck.on('key', updateModel);
        ck.on('dataReady', updateModel);

        ngModel.$render = function() {
            ck.setData(ngModel.$modelValue);
        };
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-11T03:05:00.563

我也遇到了这个问题当我找到一个新指令时。这对我来说很有效！！！

请试试这个：

```
return {
require: '?ngModel',
scope: true,
link: function (scope, element, attr, ngModel) {
    if (!ngModel) return;

    var ck = CKEDITOR.replace(element[0]);

    ck.on('instanceReady', function() {
        ck.setData(ngModel.$viewValue);
    });

    function updateModel() {
        scope.$apply(function() {
            if ( ck.getData().length ) {
                ngModel.$setViewValue(ck.getData());
            }
        });
    }

    ck.on('pasteState', updateModel);
    ck.on('change', updateModel);
    ck.on('key', updateModel);
    ck.on('dataReady', updateModel);

    ngModel.$render = function() {
        ck.setData(ngModel.$modelValue);
    };
} 
```

};

# javascript - 关闭 jQuery 弹出窗口

> ID：15483584
> 
> 赞同：0
> 
> 时间：2013-03-18T17:53:40.847
> 
> 标签：javascript, jquery, html

我有一个使用[codelifter.com](http://codelifter.com/)的一些脚本构建的[站点](http://asashopmedicalplan.org/maplocation.aspx?dest=medical.aspx)，它是一个非常古老的站点，我需要进行一点编辑。我没有创建该站点，我只是想知道为什么 JavaScript 弹出窗口不会关闭。如果您单击 CA，您很快就会收到一个，但如果您单击 TX，它会打开一个不会关闭的弹出窗口。

我的问题是我需要更改哪一行代码才能关闭它？

下面的代码有问题吗？

谢谢

```
var strGoToUrl = "";

        function ShowPopup(strUrl) {
            var str = '<table cellspacing="1" cellpadding="2" style="background:black"><tr>';
            str += '<td style="background:#ffeccc" width="460">';
            str += '<table cellspacing="0" cellpadding="2" width="100%"><tr>';
            str += '<td align="right"><a href="javascript:HidePopup();">Close</a></td>';
            str += '</tr><tr>';
            str += '<td align="center">';
            str += 'TODAY- ASA members can get medical insurance quotes and buy quality, affordable ';
            str += 'medical insurance group plans through Benefit Consultants Northwest (BCNW).<br/><br/>';
            str += '<a href=\"' + strUrl + '\">Click here for Quotes, Medical plan information and plan selections.</a><br/>';
            str += '<a href=\"' + strUrl + '\"><img src="images/bcnw_logo3.gif" width="186" height="60" border="0" /></a><br/>';
            str += 'Automotive Industry Health Insurance Trust (A-HIT) association medical plans ';
            str += 'are not currently available in this state.<br/><br/>';
            str += '</td></tr></table></td></tr></table>';

            strGoToUrl = strUrl;
            alert(strGoToUrl);

            if (document.getElementById) {
                var elem = document.getElementById("popupDiv");
                elem.innerHTML = str;
                elem.style.display = "block";
                ShowRectangularDynamicDropShadow(elem, "#333333", 5);
            }
        }

        function GoToUrl() {
            alert(strGoToUrl);
            window.location = strGoToUrl;
        }

        function HidePopup() {
            if (document.getElementById) {
                var elem = document.getElementById("popupDiv");
                HideRectangularDynamicDropShadow(elem);
                elem.style.display = "none";
                elem.innerhtml = "";
            }
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T18:13:09.180

试试这个......未经测试，但应该工作......

```
<div id="popupDiv">

//Rest of the code

<div id="shadow"></div>
</div>

function ShowPopup(strUrl) {
        //rest of the code
          shadowDiv = document.getElementById("shadow").style.display = 'block';
          ShowRectangularDynamicDropShadow(shadowDiv, "#333333", 5);
        //rest of the code
}

   function HidePopup() {
        if (document.getElementById) {
            var elem = document.getElementById("popupDiv");
            shadowDiv = document.getElementById("shadow");
            HideRectangularDynamicDropShadow(shadowDiv);
            elem.style.display = "none";
            shadowDiv.style.display = "none";
            elem.innerhtml = "";
        }
    } 
```

# asp.net-mvc - 文本字段不会在 HTML5 字段中填充默认日期

> ID：15483588
> 
> 赞同：1
> 
> 时间：2013-03-18T17:53:59.490
> 
> 标签：asp.net-mvc, html, google-chrome, validation

在 HTML5 日期输入类型中，Chrome 不会输入默认日期。该字段呈现为空。其他浏览器会有日期，但 Chrome 有一个默认的日期选择器，可能会导致一些问题。有任何想法吗？

`<input type="date" class="input-xlarge" id="date" name="date" pattern="(0?[1-9]|1[012])[- /.](0?[1-9]|[12][0-9]|3[01])[- /.](19|20)\d\d" value="@Model.Date.ToString("MM/dd/yyyy")" required />`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T23:08:35.337

HTML5 日期值格式是 yyyy-MM-dd，而不是 MM/dd/yyyy。

# excel - 循环遍历多选列表框值以创建和命名工作簿

> ID：15483591
> 
> 赞同：5
> 
> 时间：2013-03-18T17:54:08.103
> 
> 标签：excel, vba

列表框未将所选值分配给“n”。无论我是否从列表框中选择值，“n”值都是 0。我正在学习，所以我可能会错过一些简单的东西......建议？谢谢！

```
Private Sub UserForm_Initialize()

With cbomonth
    .AddItem "January"
    .AddItem "February"
End With
With cboyear
    .AddItem "2013"
    .AddItem "2014"
End With
With cboteam
    .AddItem "Team1"
    .AddItem "Team2"
End With
With cbodocument
    .AddItem "Task1"
    .AddItem "Task2"
End With
With ListBox1
.AddItem "Name"
.AddItem "Name"
End With
cboteam.ListIndex = 0
cboyear.ListIndex = 4
cbomonth.ListIndex = 6
cbodocument.ListIndex = 1

End Sub

Private Sub cmdSubmit_Click()

    Dim year As String
    Dim month As String
    Dim days As Integer
    Dim team As String
    Dim n as Long
    Dim tallboxynames As Variant
    Dim tallynewfile As String

    Unload Me

    year = cboyear.Value
    month = cbomonth.Value
    team = cboteam.Value
    document = cbodocument.Value

    TallyPath = "\\network path\Tally of orders\Master Template\"
    TallyPath1 = "\\network path\Tally of orders\" & year & "\"
    TallyPath2 = "\\network path\Tally of orders\" & year & "\" & month & "\"
    TallyTemplate = "Tally_Template_ver1.xls"

If document = "Tally Sheets" Then
    For n = 0 To ListBox1.ListCount - 1
        If ListBox1.Selected(n) Then
            tallynewfile = ListBox1.Selected(n) & ".xls"
        Else
            MsgBox "No data from listbox"
        End If
If Len(Dir(TallyPath1, vbDirectory)) = 0 Then
    MkDir TallyPath1
End If
If Len(Dir(TallyPath2, vbDirectory)) = 0 Then
    MkDir TallyPath2
    FileCopy TallyPath & TallyTemplate, TallyPath2 & tallynewfile
End If
    Next n
End If
Exit Sub
End Sub 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-18T20:16:48.267

将**Unload Me 移至程序的末尾**：

```
Private Sub cmdSubmit_Click()
    ' code here ...
    Unload Me
End Sub 
```

**如果 ListBox1.MultiSelect = 0** (fmMultiSelectSingle) ，则使用 Value获取选定项目：

```
Me.ListBox1.Value 
```

如果**MultiSelect > 0 则使用 Selected 属性**，例如：

```
Private Function GetSelectedItems() As String
    Dim text As String
    Dim i As Integer
    For i = 0 To Me.ListBox1.ListCount - 1
        If Me.ListBox1.Selected(i) Then
            text = text & Me.ListBox1.List(i) & vbNewLine
        End If
    Next i
    MsgBox "Selected items are: " & text
    GetSelectedItemsText = text
End Function 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T18:15:39.790

代替

```
Unload Me 
```

尝试使用

```
Me.Hide 
```

当您`unload`删除表单上的所有值时。如果您使用它们，它们将被保留`Hide`。

# ruby-on-rails - 命名路由破坏了 RSpec Michael Hartl 的 Ruby on Rails 教程第 5 章

> ID：15483595
> 
> 赞同：0
> 
> 时间：2013-03-18T17:54:21.070
> 
> 标签：ruby-on-rails, rspec, railstutorial.org, rails-routing

我正在阅读 Michael Hartl 的 Ruby on Rails 教程。在第 5 章测试命名路由之前，一切都很好，并且它们都破坏了 Rspec。我已经确认它们在浏览器和视图中都能正常工作。

例如，在布局中，以下工作：

```
<li><%= link_to "About", about_path %></li> 
```

但是，在我的 Rspec 文件中，以下会产生错误

```
visit about_path 
```

我得到的错误是：

```
Failure/Error: visit about_path 
 NameError:
undefined local variable or method 'about_path' for #<Rspec::Core::ExampleGroup..... 
```

每个命名路由都失败，包括 root_path，所以我的所有规范都失败了。

编辑：

这是我的`routes.rb`：

```
root to: 'static_pages#home'
match '/help', to:'static_pages#help'
match '/about', to: 'static_pages#about'
match '/contact', to: 'static_pages#contact' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T22:04:27.900

我认为该错误表明您忘记在 before 块中包含访问 about_path 这就是为什么它给您一个未定义的变量或方法。我认为答案是：

```
before { visit about_path } 
```

# jquery-isotope - IsotopeJS 可以在不向 Isotope 项目添加 position: absolute 的情况下工作吗？

> ID：15483604
> 
> 赞同：4
> 
> 时间：2013-03-18T17:54:42.413
> 
> 标签：jquery-isotope

Isotope 将此样式添加到项目中：

```
position: absolute; 
left: 0px; 
top: 0px; 
-webkit-transform: translate3d(0px, 0px, 0px); 
```

是否可以禁用此功能，但仍保持同位素功能？我已经读过[`transformsEnabled`](http://isotope.metafizzy.co/docs/options.html#transformsenabled)其中说禁用它会导致浏览器依赖于顶部/左侧定位。我可以反过来，让浏览器依赖 CSS 转换，还是同位素总是依赖位置：绝对？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-29T18:40:42.230

事实证明，Isotope 可以在不向 Isotope 项目添加 position: absolute 的情况下工作。这是通过使用[hiddenStyle](http://isotope.metafizzy.co/docs/options.html#hiddenstyle)和[visibleStyle](http://isotope.metafizzy.co/docs/options.html#visiblestyle)定义样式来实现的。一旦实施，这似乎确实需要一些额外的工作，如[http://codepen.io/betweenbrain/pen/bkwuF](http://codepen.io/betweenbrain/pen/bkwuF)所示。希望这可以帮助您走上正确的道路。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-10T06:54:12.267

这是因为未加载的图像导致项目相互重叠。
尝试在所有图像加载后通过`imagesLoaded`在 call 之前添加函数来初始化 Isotope `isotop`。代码应如下所示：

```
var $container = $('#container').imagesLoaded( function() {
   $container.isotope({
    // options
  });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-28T15:36:53.230

给容器宽度 100% 和相对位置。

# java - 在 postgreSQL 中搜索

> ID：15483607
> 
> 赞同：0
> 
> 时间：2013-03-18T17:54:46.267
> 
> 标签：java, postgresql, search

我已经能够将 postgresql 与 java 链接起来。我希望用户在 java 的文本框中输入一个名称，然后执行搜索并检查该名称是否存在于数据库中。

到目前为止我的代码：

```
String hostname=this.hostNameText.getText();
try
{
s = connection.createStatement();
String q="SELECT * FROM hostdetails WHERE \"HOSTNAME\" = "+hostname;

rs = s.executeQuery(q);
}catch(Exception e)
{
System.out.println("Problem in searching the database 1");
} 
```

我在链接到表 hostdetails 时遇到问题。请注意，hostdetails 包含一个名为 HOSTNAME（大写字母）的字段。当我运行上面的代码时，我得到显示“搜索数据库 1 时出现问题”。请帮助我:)

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-18T18:03:41.707

尝试使用参数化查询来防止 SQL 注入。使用如下：

```
String hostname=this.hostNameText.getText();
try
{
String q="SELECT * FROM hostdetails WHERE \"HOSTNAME\" = ?"; //notice change here

//and use params like this
PreparedStatement pStmnt = connection.prepareStatement(q);
pStmnt.setString(1, hostname);

rs = pStmnt.executeQuery(q);
}catch(Exception e)
{
//error handling here
} 
```

# php - 使用php发送邮件时如何摆脱服务器名称

> ID：15483608
> 
> 赞同：0
> 
> 时间：2013-03-18T17:54:47.960
> 
> 标签：php, email

每当我使用 php 发送邮件时，收件人都会收到类似“**来自：Website plc info@website.com via mirage.arandomserver.com** ”的信息

我怎样才能完全摆脱服务器名称？

这是我当前的脚本”

```
$to="$Email";
$subject="Message received";
$headers= 'From: Website plc <info@website.com>' . "\r\n" .
'Reply-To: $Email' . "\r\n" .
'X-Mailer: PHP/' . phpversion();

$contact_message="
Dear $FirstName $Surname,

message

Thanks
P&C Group Careers
http://www.career.pandcgroupng.com
 ";

 mail("$to", "$subject", $contact_message, $headers); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-18T17:58:31.253

使用“来自地址的信封”附加参数。

```
mail($to, $subject, $contact_message, $headers, '-f info@website.com'); 
```

该地址将在邮件系统内部用于路由目的。请注意，这也绕过了邮件过滤软件检测来自与实际始发服务器不匹配的地址的“坏”的一些问题。

编辑 - 我在 Windows 上完全没有这方面的经验。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T18:05:36.933

当 Gmail 无法验证“website.com”实际上是在发送电子邮件时，会出现“via mirage.arandomserver.com”。Gmail 会检查许多因素，包括来自发送 SMTP 服务器的反向 DNS、SPF 记录和/或 HELO，以验证服务器是否允许作为该域发送。与您的实际 PHP 脚本无关。

看看谷歌的文档：http: [//support.google.com/mail/answer/1311182](http://support.google.com/mail/answer/1311182)

检查您在“website.com”域上的 SPF 记录，并确保它们对于您发送的电子邮件服务器是正确的。您可能需要与托管公司或系统管理员联系，以获取您的托管设置所需的正确 SPF 记录。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-18T18:00:48.817

你不能。您的服务器参与了 SMTP 通信，并且始终在原始邮件消息中显示为类似于以下的标头：

```
Received: from example.com (example.com. [100.100.100.100])
        by mx.google.com with ESMTP id t8si14713688dfb.115.2013.03.18.10.01.59;
        Mon, 18 Mar 2013 10:01:59 -0700 (PDT) 
```

因此，像 GMail 这样的邮件客户端将显示您所看到的“通过”部分。

# security - 引用 ip 操作

> ID：15483615
> 
> 赞同：1
> 
> 时间：2013-03-18T17:55:22.937
> 
> 标签：security, request, httprequest, referrer

某些应用程序仅通过接受来自某些 IP 的请求来提供安全性。这是使该应用程序安全的好方法吗？有没有办法在请求期间操纵这个引荐来源 IP？

getRemoteAddr、getRemoteHost 和 getRemotePort

发出请求时有什么方法可以设置上述值吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T20:46:04.400

是的，可以“欺骗”数据包的源 IP，以使请求看起来来自与实际不同的 IP 地址。但是，这不是问题，因为如果 IP 地址被欺骗，TCP 的三次握手将无法完成，除了少数例外情况（例如攻击者嗅探数据包并在数据包通过线路时生成响应）。不过一般来说，很难做到。

然而，这不是好的安全实践，即使它通常是可靠的。原因是任何人都可以假设 IP 地址，并且由于 NAT 和防火墙等技术，它们在数据包中经常更改。

考虑一下，如果您有两个使用 NAT 的专用网络上的用户，并且他们都同时向您的服务器发出请求，那么您的服务器将看到 IP 地址相同，但源端口不同。允许路由正确发生的区别因素是源*端口*，而不是 IP 地址。为了降低可靠性，源端口将在每个新请求上发生变化，这可能在单个 HTTP 会话期间发生数十次。

话虽如此，IP过滤还是有一些好处的。您可以通过 IP 过滤使来自某个国家或地区的人更难连接。这不应该是您*唯一*的安全措施，但它可以提供帮助，因为从不同范围获取有效 IP 地址通常并非易事。例如，某些组织会默认阻止所有非美国 IP。这与用户帐户一起使用。这使得非本地攻击者更难到达服务器。

# sql - 位置排序,最小值和最大值

> ID：15483622
> 
> 赞同：-1
> 
> 时间：2013-03-18T17:55:39.260
> 
> 标签：sql, sql-server

我有一张这样的桌子。

表 A

> [作业批次] [作业 ID] [子作业 ID] [完成时间] [完成的作业顺序] [最小] [最大] [AVG]
> 
> 1 11 100 10 位置 1
> 
> 1 11 101 20 位置 2
> 
> 1 11 103 30 位置 3
> 
> 2 12 101 30 位置 1
> 
> 2 12 105 10 位置 3

每个子作业 ID 代表每周向特定站点（如纽约、华盛顿或洛杉矶）的交付。

所以我需要计算出孩子 ID 10 的平均位置是多少。我在作业 ID 11 中看到它在 POS 1 中有子作业 ID 10，在作业 ID 12 中它在 POS 2 中，所以最小值是 POS1，最大值是 POS3，平均值是 POS 2。

如何计算 sql 中所有 CHILD JOB ID 的最小值、最大值和平均值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T18:14:42.300

如果您只在字段中存储 POS 编号，那么 SQL 很简单。

```
Select CHILD_JOB_ID, MIN(POS), MAX(POS), AVG(POS)
from table-name
group by CHILD_JOB_ID 
```

如果 POS 字段有一个带有 'POS' 前缀的字符串，那么您可能会从

```
Select CHILD_JOB_ID,
       MIN(SUBSTRING(POS, 5, LEN(POS)),
       MAX(SUBSTRING(POS, 5, LEN(POS)),
       AVG(SUBSTRING(POS, 5, LEN(POS))
from table-name
group by CHILD_JOB_ID 
```

# javascript - 如何通过在其中输入特殊字符来验证用户名字段（它应该允许特殊字符）

> ID：15483624
> 
> 赞同：1
> 
> 时间：2013-03-18T17:55:48.027
> 
> 标签：javascript

我想通过输入特殊字符来验证用户名输入字段：

```
!`@#$%^&*()+=-[]\\\';,./{}|\":<>?~_ 
```

这是我的代码：

```
function specialcharecter()
{
    var iChars = "!`@#$%^&*()+=-[]\\\';,./{}|\":<>?~_";   
    var data = document.getElementById("txtCallSign").value;
    for (var i = 0; i < data.length; i++)
    {      
        if (iChars.indexOf(data.charAt(i)) != -1)
        {    
            alert ("Your string has special characters. \nThese are not allowed.");
            document.getElementById("txtCallSign").value = "";
            return false; 
        } 
    }
} 
```

# c# - 在c#中从mysql数据库中检索单词分数

> ID：15483628
> 
> 赞同：0
> 
> 时间：2013-03-18T17:56:09.893
> 
> 标签：c#, mysql, c#-4.0, mysql-workbench

我想从数据库中检索一些单词，然后我将判断段落是正段还是负段
。**数据库文件格式**是这样的。其中一些关键词有正负分

```
Word                Pos_Score           Neg_Score

Able                .324                .834
Country             .987                .213
Love                .378                .734 
agree               .546                .123
industry            .289                .714
guests              .874                .471 
```

**段落**将是这样的。

```
I agree with you.  It seems an intelligent tourist industry allows its guests to either immerse fully, in part, or not, depending upon the guest.  That is why the ugly American charges have always confused me. 
```

现在，如果在数据库文件中找到单词，我会将段落的每个单词与数据库文件进行比较，然后我将检索单词的 Pos_Scoe 和 Neg_Score 分数，当整个段落最后比较时，这些分数将存储在变量中 Pos_Score 将单独添加，Neg_Score 将单独添加。这将是结果。
**我尝试的代码**是这个

```
 private void button1_Click(object sender, EventArgs e)
            {
                string MyConString = "server=localhost;" +
                   "database=sentiwornet;" + "password=zia;" +
                   "User Id=root;";
                MySqlConnection connection = new MySqlConnection(MyConString);
                MySqlCommand command = connection.CreateCommand();
                MySqlDataReader Reader;
                StreamReader reader = new StreamReader("D:\\input.txt");
                string line;
                while ((line = reader.ReadLine()) != null)
                {
                    string[] parts = line.Split(' ');

                    foreach (string part in parts)
                    {
                        command.CommandText = "SELECT Pos_Score FROM score WHERE Word = 'part'";
                        command.CommandText = "SELECT Neg_Score FROM score WHERE Word = 'part'";
                        //var 
                        connection.Open();
                        Reader = command.ExecuteReader();

                    }
                }

            } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T18:20:42.017

首先，这个查询效率极低。相反，如果您的段落足够小，我将通过将参数作为 CSV 列表传递来执行数据库内的所有连接，然后转换为 SQL 中的表。以下函数将执行此操作（由[http://codebank.wordpress.com/2007/03/06/simple-sql-csv-to-table-2/](http://codebank.wordpress.com/2007/03/06/simple-sql-csv-to-table-2/)提供）：

**警告：**您将需要使用类似的东西去除所有标点符号`string.Replace(new[] { '.', ',' ... etc })`

此外，我的代码可能无法完全按照您的意愿执行——它甚至可能无法编译——但这就是编程的乐趣。这为您提供了我对如何解决相当复杂的问题的总体思路。

**编辑：** 我刚刚意识到您正在使用 MySql。这段代码适用于 MSSQL——我从未使用过 CLR 中的 MySql，所以我不知道所有类是否都是等价的。你可能需要回到你之前做的事情。

### CSV 到列表

```
Create Function dbo.fn_CSVToTable (@CSVList Varchar(MAX))
Returns @Table Table (ColumnData Varchar(50))
As
Begin
If right(@CSVList, 1) <> ','
Select @CSVList = @CSVList + ','

Declare @Pos    Smallint,
@OldPos Smallint
Select  @Pos    = 1,
@OldPos = 1

While   @Pos < Len(@CSVList)
Begin
Select  @Pos = CharIndex(',', @CSVList, @OldPos)
Insert into @Table
Select  LTrim(RTrim(SubString(@CSVList, @OldPos, @Pos - @OldPos))) Col001
Select  @OldPos = @Pos + 1
End

Return
End 
```

### SQL 过程

```
CREATE PROCEDURE dbo.spGetWordScores (@csv varchar(MAX))
AS
select POS_SCORE, NEG_SCORE, WORD from score
inner join dbo.fn_CSVToTable(@csv) input
    on input.ColumnData = score.WORD 
```

### 新的 C# 代码

```
var MyConString = "server=localhost;" +
               "database=sentiwornet;" + "password=zia;" +
               "User Id=root;";
var connection = new MySqlConnection(MyConString);

//Each line in the array will probably be one paragraph.
var fileLines = File.ReadAllLines("D:\\input.txt");
foreach (var line in fileLines)
{
        //Format your line into words by removing punctuation. I'm not going to bother
        //with that code because it is trivial.
        //var csv = line.Split(' ');

        var command = connection.CreateCommand();
                    command.CommandText = "exec spGetWordScores";
                    command.Parameters.AddWithValue("@csv", csv);
        var ds = command.ExecuteDataSet();

        //Now you have a DataSet with your word scores. do with them what you will.
} 
```

### 有用的扩展方法

```
public static class Extensions
{
    public static DataSet ExecuteDataSet(this SqlCommand command)
    {
        using (SqlDataAdapter da = new SqlDataAdapter(command)) {
        DataSet ds = new DataSet();

        // Fill the DataSet using default values for DataTable names, etc
        da.Fill(ds);

        return ds;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T18:05:03.337

来回访问数据库会影响您的性能。最好编写一个存储过程来接收您的输入字符串，将其拆分并计算分数 - 这样所有处理都将在一台机器上进行，并且您将通过不传达部分结果来节省大量时间。

# c# - 在后面的代码中将 CSS 添加到 GridView

> ID：15483636
> 
> 赞同：2
> 
> 时间：2013-03-18T17:56:34.657
> 
> 标签：c#, asp.net, css, gridview

我正在尝试设置我的 GridView 对象的样式，但我似乎无法让它使用 CSS 类。我正在动态创建 GridView，因此它们都是在代码隐藏中创建的。我尝试了以下方法，但似乎没有任何效果。

```
for (...)
{
 GridView gv = new GridView();
 gv.CssClass = "aclass";
 gv.Attributes.Add("class", "aclass");
} 
```

以及在 RowDataBound 事件中：

```
foreach (row in gv)
e.Row.Cells[i].CssClass = "aClass"; 
```

但我仍然无法设置我的数据样式。任何意见是极大的赞赏

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T19:07:03.373

```
 protected void GridView1_RowDataBound(object sender, GridViewRowEventArgs e)
    {
        if (e.Row.RowType == DataControlRowType.DataRow)
        {
            e.Row.Cells[1].CssClass = "controlbackcolor";
            e.Row.Cells[3].CssClass = "controlbackcolor";
        }
    } 
```

这应该可以，但是您需要确保将 css 类放在正确的位置或链接..否则您将无法应用样式

您的 Css 类声明在 head 标记或链接中应如下所示：

.controlbackcolor { 背景：绿色；字体粗细：粗体；白颜色; }

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-15T02:51:25.950

最好的方法是分配 CssClass，就像你正在做的那样。然后使用这样的选择器控制样式：

**代码隐藏**

```
MyGridView.CssClass = "aclass"; 
```

**CSS**

```
.aclass{Border: 1px solid lighgray;}
.aclass tr td {background:green; font-weight:bold; color: white} 
```

Gridview 在 HTML 中呈现为普通表格，因此您可以在 CSS 端执行此操作以减少代码负载。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-08-13T09:59:40.803

> Bootstrap 类也可以添加到后面的代码中，例如

```
protected void gvEmpContactsHistory_SelectedIndexChanged(object sender, EventArgs e)
    {
        string val = Convert.ToDateTime(gvEmpContactsHistory.SelectedDataKey.Value).ToString("dd-MM-yyyy hh:mm:ss", new System.Globalization.CultureInfo("en-US"));
        GetEmployeeDetail(val);

        foreach (GridViewRow row in gvEmpContactsHistory.Rows)
        {
            if (row.RowIndex == gvEmpContactsHistory.SelectedIndex)
            {
                row.ToolTip = string.Empty;
                row.Attributes.Add("class", "btn-success");
            }
            else
            {
                row.ToolTip = "Click to select this row.";
                row.Attributes.Add("class", "btn-outline-success");
            }
        }
    } 
```

# java - 如何使用 servlet 中的保存文件对话框？

> ID：15483637
> 
> 赞同：2
> 
> 时间：2013-03-18T17:56:34.947
> 
> 标签：java, swing, jsp, servlets, tomcat5.5

我试图让用户将我的 servlet 中的数据保存为 CSV 文件。最初我只是在他们的桌面上放置文件，但这条路线的权限会被拒绝，所以我想问用户他们想把它保存在哪里。

从我所见，我不能在 servlet 中使用 Swing API，因为 Tomcat 不知道如何绘制 GUI。我试过这段代码：

```
 String fileName = "ClassMonitor" + formatter.format(currentDate) + ".csv";

    File csvFile = new File(fileName);

    //Attempt to write as a CSV file 
    try{

        JFileChooser fileChooser = new JFileChooser();
        fileChooser.setSelectedFile(csvFile);
        int returnValue = fileChooser.showSaveDialog(null);

        if(returnValue == JFileChooser.APPROVE_OPTION)
        {
            BufferedWriter out = new BufferedWriter(new FileWriter(csvFile));

            //Iterates and writes to file
            for(ClassInfo classes : csvWrite)
            {
                //Check if the class has a comma. Currently, only section titles have a comma in them, so that's all we check for.
                classes.setSectionTitle(replaceComma(classes.getSectionTitle()));

                out.write(classes.toString());
            }

            //Close the connection
            out.close();
        }

        //Log the process as successful.
        logger.info("File was successfully written as a CSV file to the desktop at " + new Date() + "\nFilename" +
                "stored as " + fileName + ".");

    }
    catch(FileNotFoundException ex)
    {
        //Note the exception
        logger.error("ERROR: I/O exception has occurred when an attempt was made to write results as a CSV file at " + new Date());
    }
    catch(IOException ex)
    {
        //Note the exception
        logger.error("ERROR: Permission was denied to desktop. FileNotFoundException thrown.");
    }
    catch(Exception ex)
    {
        //Note the exception
        logger.error("ERROR: Save file was not successfull. Ex: " + ex.getMessage());
    }

} 
```

但这会抛出一个无头异常。

任何有关如何在 servlet 中实现诸如保存文件对话框之类的指导都将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T18:19:49.020

只需将其写入响应正文而不是本地（！！）磁盘文件系统。

```
response.setContentType("text/csv"); // Tell browser what content type the response body represents, so that it can associate it with e.g. MS Excel, if necessary.
response.setHeader("Content-Disposition", "attachment; filename=name.csv"); // Force "Save As" dialogue.
response.getWriter().write(csvAsString); // Write CSV file to response. This will be saved in the location specified by the user. 
```

标`Content-Disposition: attachment`头负责*保存为*魔术。

### 也可以看看：

*   [JSP生成Excel电子表格（XLS）下载](https://stackoverflow.com/questions/477886/jsp-generating-excel-spreadsheet-xls-to-download/2154226#2154226)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T18:07:55.027

您不能`JFileChooser`从 servlet 调用 ，因为 servlet 在服务器上运行，而不是在客户端上；您的所有 Java 代码都在服务器上执行。如果要将文件保存在服务器上，则需要已经知道要写入的路径。

如果要提示用户的浏览器保存文件，请使用 content-disposition 标头：[Uses of content-disposition in an HTTP response header](https://stackoverflow.com/questions/1012437/uses-of-content-disposition-in-an-http-response-header)

# ruby-on-rails - Rails Active Record，如何在查询结果中添加额外的字段参数？

> ID：15483639
> 
> 赞同：1
> 
> 时间：2013-03-18T17:56:40.210
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord, openwisp

我实际上有这个模型：

```
class Role < ActiveRecord::Base
  acts_as_authorization_role

  def self.all_join_wisp
    self.connection.select_all("SELECT roles.*, wisps.name AS wisp_name FROM roles LEFT JOIN wisps ON wisps.id = roles.authorizable_id")
  end
end 
```

all_join_wisp 方法几乎可以满足我的要求，它添加了 wisp_name 字段，除了它返回一个散列而不是一个活动记录对象。

有没有办法代替检索活动记录对象？

Role 模型没有 belongs_to 并且 wisp 模型没有 has_many :roles ，我猜这是为了灵活性或其他原因（我没有开发我正在开发的应用程序）。

## 编辑：解决方案已实施

此处实施的解决方案：[https](https://github.com/nemesisdesign/OpenWISP-Geographic-Monitoring/blob/287861d95fffde35d78b76ca1e529c21b0f3a54b/app/models/role.rb#L25) ://github.com/nemesisdesign/OpenWISP-Geographic-Monitoring/blob/287861d95fffde35d78b76ca1e529c21b0f3a54b/app/models/role.rb#L25 感谢@house9

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T18:17:39.017

你可以使用`find_by_sql`- 你得到一个看起来像 activerecord 对象但实际上不是的东西，它将具有来自你的查询的属性，但它们都将是字符串数据类型而不是真实类型，通常这没关系

```
def self.all_join_wisp
  self.find_by_sql("SELECT roles.*, wisps.name AS wisp_name FROM roles LEFT JOIN wisps ON wisps.id = roles.authorizable_id")
end 
```

然后

```
list = Role.all_join_wisp
list.each do |x|
  puts x
  puts x.inspect
  puts x.id # the role id 
  puts x.id.is_a?(Integer) # false
  puts x.id.is_a?(String) # true
  puts x.name # the role name
  puts x.wisp_name # wisp name, NOTE: Role does not really have this attribute, find_by_sql adds it
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T18:37:34.630

模型

```
class Role < ActiveRecord::Base

      def self.do

        joins("LEFT JOIN wisps w ON
                w.id = roles.id").select("roles.*,
                                          wisps.name AS wisp_name")    

      end

    end 
```

控制器

```
@roles = Role.do

@wisps = @roles.map {|i| i.wisp_name} 
```

看法

```
<%= @wisps %> 
```

# c++ - 创建类对象向量时，何时调用构造函数？

> ID：15483643
> 
> 赞同：5
> 
> 时间：2013-03-18T17:57:02.780
> 
> 标签：c++, class, vector

假设我有一个名为 Foo 的课程。Foo 没有默认构造函数。它有一个构造函数 Foo(int x, float y)。

Bar 是一个容器类。它包含一个包含 Foo 实例的向量。

```
Bar::Bar(int numberOfFoos, int x, float y) {

foovector.resize (numberOfFoos);
for(int i = 0; i < numberOfFoos; i++) {
   **read below**
} 
```

此时，我想调用 Foo 的构造函数并将参数 int x 和 float y 传递给它。Foo 的构造函数根据 x 和 y 的值做不同的事情。

假设 Foo 有一个默认构造函数，resize 向量函数到底是做什么的？它是否只是在不调用默认构造函数的情况下调整向量的大小？换句话说，是否为 Foo 类型的 n 个元素保留了空间，但它们没有被初始化为任何东西？

如果它没有一个怎么办，就像在这种情况下？

在 for 循环中，我想以这种方式初始化每个 Foo 元素：

```
foovector[i].Foo(int x, float y); 
```

但我不能以这种方式使用点访问运算符调用构造函数。此时我什至不知道构造函数是否已经被 resize 函数调用。

**问题是**，我该怎么做？

**关于类向量的另一个相关问题：**

在 Foo 中有一个包含浮点数的向量。float x 参数是它应该保持的浮点数。Foo 的构造函数有一行

```
arrayofFloats.resize (x); 
```

但这意味着计算机事先并不知道 Foo 的大小。每个 foo 可以有不同的大小。它不会对 Foo 的向量造成问题吗？如果每个 Foo 可以有不同的大小，如何声明特定大小的向量？

抱歉英语不好，我希望它已经足够清楚了。

谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-18T17:59:33.497

不要`resize`用来预留空间。相反，使用`reserve`：

```
foovector.reserve(n);                          // reserves memory only, no object
                                               // constructions take place
for (std::size_t i = 0; i != n; ++i)
{
    foovector.emplace_back(12 * i, i / 3.0);   // pushes a new Foo(12*i, i/3.0)
}                                              // at the back of the vector 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T18:34:35.717

如果我理解这一点，您希望 Bar 构造函数在一个向量中构造多个 Foo 实例，每次都使用与 Foo 构造函数相同的参数。**如果**Foo 构造函数的工作方式使得 Foo 对象在构造后都相同，则可以使用`std::vector::assign(size_type n, const value_type& val)`，在这种情况下 value_type 是 Foo。如果您调用，向量将构造一个临时 Foo 对象并用该对象的副本`foovector.assign( numberOfFoos, Foo(x, y) )`填充自己。还可以处理您所有的大小调整需求。`numberOfFoos``assign()`

但是，如果 Foo 构造函数涉及随机行为、静态计数器或其他导致对构造函数的连续调用产生不同对象的东西，则复制不是您想要的。

**你的另一个问题：**

In C++, every type has a fixed size. (This is why polymorphism only works with pointers or pass-by-reference semantics.) Many classes, such as `std::vector`, manage additional memory which can grow or shrink as needed. This is all done behind the scenes with pointers. Additional memory, such as the data contained by a vector, is off in some other memory location and does not affect the actual size of the object. The `vector` methods `size()`, `resize()`, and `reserve()` work with that managed memory. So a Foo object is the same size no matter how many items are in its vector.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-18T18:10:26.980

`resize` *确实*初始化了新元素；具体来说，它初始化一个临时对象（使用默认构造函数，如果它是类类型），然后使用它复制初始化每个元素。

如果它没有默认构造函数，或者不能复制初始化，那么你不能使用`resize`.

但是，您可以使用它`reserve`来保留内存而不初始化其中的任何对象；然后使用`push_back`or`insert`元素进入该空间。在 C++11 中，您还可以使用`emplace_back`来避免复制元素：

```
foovector.reserve (numberOfFoos);
for(int i = 0; i < numberOfFoos; i++) {
   foovector.push_back(Foo(42, 1.23));   // C++03, requires copy constructor
   foovector.emplace_back(42, 1.23);     // C++11, doesn't require copy constructor
} 
```

关于你的额外问题：

> 但这意味着计算机事先并不知道 Foo 的大小

是的，它确实。向量是一个小对象，其中包含指向某些动态分配的内存的指针；它的大小是固定的，并不取决于它分配了多少内存。

# ssl - 通过 Https 端点在两个 webrole 之间交换数据

> ID：15483649
> 
> 赞同：1
> 
> 时间：2013-03-18T17:57:16.400
> 
> 标签：ssl, azure, https, endpoint, restriction

我有两个 webrole，它们之间没有 WCF 通信（这是故意的）

沟通和认证是一方面。因此，一个 webrole 总是发送请求，另一个总是接受请求。

为确保所述控制器仅接受来自其他 webrole 的请求，我们希望使用 ssl 证书。

我安装了证书 - 我现在能够向所述控制器发出 https 请求。但是，这现在对整个 webrole 都有效。

在最终版本中，出于明显的安全原因，用户应该能够使用全局信任证书通过 https 连接到 webrole。这将需要一个 Azure https 端点。然后我们的内部通信需要另一个端点（使用我们的内部证书）。

但是：如何将仅用于内部通信的控制器限制为其指定的 https 请求？（基于内部证书）另一方面，我如何在客户端（发出请求的 webrole）验证所述证书有效？

有没有更好的方法来确保两个 webrole 之间的安全通信？也许使用内部端点？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T18:57:44.277

我认为您应该考虑为角色间通信定义内部端点。像这样的东西应该工作：

```
<NetworkTrafficRules>
  <OnlyAllowTrafficTo>
    <Destinations>
      <RoleEndpoint endpointName="InternalTCP2" roleName="WorkerRole1"/>
    </Destinations>
    <AllowAllTraffic/>
    <WhenSource matches="AnyRule">
      <FromRole roleName="WebRole1"/>
    </WhenSource>
  </OnlyAllowTrafficTo>
</NetworkTrafficRules> 
```

如果您通过内部端点在角色之间进行通信，则实际上不需要调用 HTTPS。

# jquery - 父元素在被子元素覆盖的部分变得透明。可能的？

> ID：15483651
> 
> 赞同：0
> 
> 时间：2013-03-18T17:57:34.530
> 
> 标签：jquery, css, background-image

我正在尝试制作悬停效果，其中父元素（例如导航元素）仅在子元素覆盖的部分变得透明。这样我就可以看到设置在网站主容器上的背景图像。是否有纯 css 解决方案或者我应该使用 javascript (jquery) 来实现这样的效果？或者，它甚至可能吗？

起点[http://jsfiddle.net/gBsEA/4/](http://jsfiddle.net/gBsEA/4/)

```
<div id="container">
<nav>
    <ul>
        <li><a href="#">Thank</a></li>
        <li><a href="#">You</a></li>
        <li><a href="#">Very</a></li>
        <li><a href="#">Much</a></li>
    </ul>
</nav>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T19:04:57.993

调整不透明度将不起作用。但是，您可以使用背景图像做一个技巧：

```
#container {
    width: 500px;
    height: 300px;
    background: url(http://www.dj-photo.com/files/2813/5912/7137/chilli-abstract_500px.jpg) no-repeat fixed 0 -40px;
    padding-top: 50px;
}
nav {
    width: 400px;
    background-color: #CCC;
}
nav ul {
    list-style: none;
    padding: 5px;
}
nav li {
    display: inline-block;
    padding: 10px;
    background: #e9e9e9;
    text-transform: uppercase;
    font-family: sans-serif;
}
nav li:hover {
    background: url(http://www.dj-photo.com/files/2813/5912/7137/chilli-abstract_500px.jpg) no-repeat fixed 0 -40px;
} 
```

`background`在这种情况下，您只需对悬停元素重复。如果您使用该`fixed`值，则不必在每个元素上重复它。

小提琴参考：http: [//jsfiddle.net/audetwebdesign/x5e2C/](http://jsfiddle.net/audetwebdesign/x5e2C/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T18:40:34.527

答案是否定的，您不能仅使用 CSS 对元素的一部分设置不透明度。此外，在这种情况下，您需要影响祖先元素，这也是不可能的。

一种可能的解决方案是在 LI:hover 上设置相同的背景图像，并适当地定位它，使其看起来好像您正在看到祖先元素的背景。

[http://jsfiddle.net/gBsEA/7](http://jsfiddle.net/gBsEA/7)

```
nav li.three:hover {
    background: url(myfile.jpg) no-repeat -280px -100px;
    color: #fff;
} 
```

# iphone - 如何选择和取消选择缩略图图像和选定的图像存储在 iphone 的数组中

> ID：15483655
> 
> 赞同：0
> 
> 时间：2013-03-18T17:57:39.197
> 
> 标签：iphone, ios

我是电话编程的新手。我在里面创建了自定义按钮，我正在为每个自定义按钮附加图像。现在自定义按钮图像显示在缩略图中。现在如果我选择任何缩略图图像或自定义按钮，我想要什么。在这里，我想选择和取消选择该缩略图图像，并且我想将所选图像标记值存储在数组中。如何在我的代码下方执行此操作。使用下面的代码，我正在创建自定义按钮并将图像附加到自定义按钮。

```
blaukypath =[[NSMutableArray alloc]init];
   for (NSString* path in array)
   {
 [blaukypath addObject:[UIImage imageWithContentsOfFile:path]];
 NSLog(@"%@",path);
   }
  myScrollView = [[UIScrollView alloc]initWithFrame:CGRectMake(0.0, 0.0, 320.0, 840.0)];
  myScrollView.delegate = self;
  myScrollView.contentSize = CGSizeMake(320.0, 840.0);
  myScrollView.backgroundColor = [UIColor whiteColor];
  [self.view addSubview:myScrollView];

  float horizontal = 8.0;
  float vertical = 8.0;
  for(int i=0; i<[blaukypath count]; i++)
  {
   if((i%4) == 0 && i!=0)
   {
   horizontal = 8.0;
   vertical = vertical + 70.0 + 8.0;
   }

                    buttonImage = [UIButton buttonWithType:UIButtonTypeCustom];
                    [buttonImage setFrame:CGRectMake(horizontal, vertical, 70.0, 70.0)];
                    [buttonImage setTag:i];

                    [buttonImage setImage:[blaukypath objectAtIndex:i] forState:UIControlStateNormal];
                    [buttonImage addTarget:self action:@selector(buttonImagePressed:) forControlEvents:UIControlEventTouchUpInside];
                    [myScrollView addSubview:buttonImage];

                    horizontal = horizontal + 70.0 + 8.0;
                }

                [myScrollView setContentSize:CGSizeMake(320.0, vertical + 78.0)];

                [self.myScrollView addSubview:buttonImage]; 
```

现在，如果选择任何缩略图图像，我想选择和取消选择缩略图图像和我想要存储在数组中的选定缩略图图像。

```
-(void)buttonImagePressed:(id)sender
{
UIButton *btn = (UIButton*)sender;

    if (btn.tag==0)
    {
        [btn setImage:[UIImage imageNamed:@"Default.png"] forState:UIControlStateNormal];
        btn.tag=1;
    }
    else{
        [btn setImage:nil forState:UIControlStateNormal];
        btn.tag=0;
    } 
```

有人告诉我，通过使用上面的代码，我可以工作，但我不能完全按照我想要的方式工作。我想选择和取消选择，还选择了我想存储在数组中的图像。谢谢阿斯拉姆

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-18T18:05:23.717

设置按钮的图像`UIControlState`

```
@property(nonatomic,retain)NSMutableArray *tapCollection;

[btn setImage:[UIImage imageNamed:@"buttonBackGround.png"] forState:UIControlStateNormal];
[btn setImage:[UIImage imageNamed:@"Button_Selected.jpg"] forState:UIControlStateSelected];

-(void)viewDidLoad{

   self.tapCollection = [[NSMutableArray alloc] init];
}

-(void)buttonImagePressed:(id)sender
{
   UIButton *selectedButton = (UIButton *)sender;

  //If checked, uncheck and visa versa
  [selectedButton setSelected:![selectedButton isSelected]];

  if([selectedButton isSelected])
  {
      [self.tapCollection addObject:[NSNumber numberWithInt:btn.tag]];
  }
  else
  {
     //remove btn.tag from self.tapCollection
  }
} 
```

# mysql - 如何找出哪个数据库链接到VB.NET中的某个ID

> ID：15483666
> 
> 赞同：0
> 
> 时间：2013-03-18T17:58:30.850
> 
> 标签：mysql, database, vb.net

基本上，我有一个连接到远程 MySQL 服务器的 VB.NET 项目。

我可以提供的凭据是“服务器 ip”、“端口”、“数据库 ID”、“用户名”和“密码”。

非常基本的东西，除了给出的是 DB ID 而不是实际的 DB 名称。如何检索链接到该 ID 的数据库的名称？

目前我使用这个连接字符串来连接它

`connection.ConnectionString = "Host=" & server & ";port=" & port & ";user=" & uname & ";password=" & pword & ";"`

注意：我需要能够在变量中包含这些的原因是因为我计划将此工具分发给我的一些朋友，他们有不同的 MySQL 服务器要连接，具有不同的数据库名称等。因为不是每个人都需要由于安全原因，知道数据库被称为什么。

编辑：我可以做的另一件事是让我的程序检查服务器上的每个数据库并返回哪个数据库中有某个表，然后将该输出用于我的程序的其余部分。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T19:56:37.893

我找到了一种解决方法，尽管这可能不适用于其他 MySQL 数据库。

我是这样做的：

```
Public Function sqlConnectTest(ByVal server, port, instance, uname, pword) As Boolean
    Dim connection As MySqlConnection
    connection = New MySqlConnection()
    connection.ConnectionString = "Host=" & server & ";port=" & port & _
";user=" & uname & ";password=" & pword & ";"
    Try
        connection.Open()
        MessageBox.Show("Connection Opened Successfully")
        **Dim stm As String = "SELECT TABLE_SCHEMA from information_schema.TABLES where TABLE_NAME like 'survivor'"**
        Dim cmd As MySqlCommand = New MySqlCommand(stm, connection)
        Dim reader As MySqlDataReader = cmd.ExecuteReader()

        While reader.Read()
            DBname = reader.GetString(0)
        End While
        reader.Close()
        connection.Close()
        Return True
    Catch mysql_error As MySqlException
        MessageBox.Show("Error Connecting to Database: " & mysql_error.Message)
        Return False
    Finally
        connection.Dispose()
    End Try
End Function 
```

显然，该解决方案仅在您拥有 information_schema 数据库时才有效，该数据库包含一个表，该表显示服务器上所有数据库中的所有表。

# c# - 反映注射目标

> ID：15483669
> 
> 赞同：1
> 
> 时间：2013-03-18T17:58:33.640
> 
> 标签：c#, dependency-injection, unity-container, ioc-container

我在各种项目中发现的一个非常常见的日志记录目标是，任何创建日志条目的类/对象都会将其自己的类/对象名称记录到该条目中。如果日志条目用于异常和堆栈跟踪，则免费包含该信息。但是如果日志条目不是异常的，那么通常会使用各种其他方法来获得这个结果：

1.  将 const 字段硬编码到每个类中，其中包含类的名称（或记录器本身！）。记录器在记录时被赋予该常量。
2.  记录器用反映调用堆栈的代码包装，以确定哪个类进行了记录调用。然后将该名称添加到日志条目中。
3.  每个类都注入了一个记录器实例，该实例已经知道注入它的类的名称。

#3 的一个简单示例如下所示：

```
ILogger logger = new MyLogger("AmazingClass");
IAmazingClass foo = new AmazingClass(logger); 
```

我想知道的是，是否有任何 IOC 容器，尤其是 Unity，能够优雅地帮助解决这个“场景 #3”？如果是，如何？

我觉得答案应该很简单：IOC 容器“知道”它将构建和注入哪个类，并在完成解析类型之前将“依赖者”信息提供给“依赖者”。

例如，也许 Unity 可以通过[委托注册](http://ithinksharp.blogspot.com/2010/02/unity-2-and-injectionfactory.html)和“反向反射”注册来实现这一点，如下所示：

```
var container = new UnityContainer();
container.RegisterType<ILogger, MyLogger>(new InjectionFactory(
    (Type targetOfInjection) => new MyLogger(targetOfInjection.Name)
); 
```

我编造了那个语法，但它是完全可信的。也就是说，Unity（或另一个 IOC 容器）实际上为提议的功能提供了什么？

*ps*我个人对我的记录器和日志记录“没问题”，不会尝试捕获非异常条目的类/对象名称。使代码更简单。但如果我被迫采用这种方法，我通常会采用堆栈反射选项（场景 #2）。当人们也需要在非异常日志记录语句中捕获类名时，了解人们喜欢哪些其他方法会很有趣。然而，最终，这个问题集中在使用 IOC 容器上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T18:26:16.943

> 也就是说，Unity（或另一个 IOC 容器）实际上为提议的功能提供了什么？

我无法回答 Unity 的问题，但使用[Simple Injector](http://simpleinjector.codeplex.com/)，您可以按如下方式注册：

```
container.RegisterWithContext<ILogger>(context =>
    new MyLogger(context.ImplementationType.Name)); 
```

您需要使用Simple Injector 文档中 Advanced Scenarios 部分中的此[代码](https://simpleinjector.codeplex.com/wikipage?title=Advanced-scenarios#Context-Based-Injection)[片段](https://simpleinjector.codeplex.com/wikipage?title=ContextDependentExtensions)`RegisterWithContext`添加扩展方法。最大的优点是使用 Simple Injector，即使是这种基于上下文的注册也能以极快的速度解决。

但请注意，基于上下文的注入通常是一种设计味道。您在现场随处可见这种模式的事实并不能说明它是正确的。因此，在您继续之前，请确保[您没有记录太多，并且您的应用程序设计遵循 SOLID 原则](https://stackoverflow.com/a/9915056/264697)。

# delphi - 正确格式化石头和磅？

> ID：15483676
> 
> 赞同：4
> 
> 时间：2013-03-18T17:58:53.280
> 
> 标签：delphi, math, delphi-xe, type-conversion

我有一个图表，用于以石头和磅（磅）显示重量。

该图表由记录中的数据填充，对于权重，数据类型为 Double。

记录数据是在运行时编辑的，我需要知道一种正确格式化输入数据的方法。

为了更好地理解，首先看一下这些样本值，它们表示为 Stones 和 lbs：

*   8.09（8 石头和 9 磅）
*   12.03（12 石头和 3 磅）
*   14.16（14 石头和 16 磅）
*   11.13（11 石头和 13 磅）
*   17.14（17 石头和 14 磅）

一块石头只有 14 磅，因此输入的任何超过 0.13 的值都应将石头值增加 1 并从 0.00 开始降低磅值 - 因此请记住，从上面的示例中，这些值中的两个不正确：

*   14.16
*   17.14

他们应该是：

*   15.02
*   18.00

是否有一个内置的数学函数可以正确格式化/圆形石头和磅？

如果不是，我真的很想看到一个显示解决这个问题的逻辑或方法的答案。

我想检查磅部分，如果值 > 0.13 然后我增加石头，但是我不确定如何最好地做到这一点，特别是如果值可能是 13.76 那么我不知道要改变什么石头和重击（这是我开始混淆自己的地方）。

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-18T18:12:31.293

对于磅，您得到小数部分，`Frac(weight)`然后乘以 100。然后使用`Round`以整数形式得到它：

```
pounds := Round(100*Frac(weight)); 
```

而对于石头来说，它只是`Trunc`：

```
stones := Trunc(weight); 
```

在另一个方向你做：

```
weight := stones + pounds/100.0; 
```

使用这些功能，您可以轻松完成剩下的工作。对大于 14 磅值的有效性检查很容易处理。例如：

```
stones := Trunc(weight);
pounds := Round(100*Frac(weight));
stones := stones + pounds div 14;
pounds := pounds mod 14; 
```

如果您在通用库中的任何地方找到此代码，我会感到非常惊讶。那是因为这是一种非常糟糕的体重储存方式。如果您要使用浮点格式，您应该这样做：

```
weight := stones + pounds/14.0; 
```

在另一个方向，你会这样做：

```
stones := Trunc(weight);
pounds := Round(14*Frac(weight));
stones := stones + pounds div 14;
pounds := pounds mod 14; 
```

不幸的是，你仍然需要做 div/mod shuffle。例如，想象一下当 时会发生什么`weight=9.99`。

这样做会使浮点值的算术更明智。例如，假设您测量了 10 个人的体重并想知道总数。用真正的浮点表示来做到这一点是有意义的，但不是用你的表示。

要看到这一点，假设这 10 个人，他们都重 0 石头，10 磅。我认识的人很小。但你会称之为 0.1。将其中的 10 批相加，您的权重为 1.0。但很明显，实际价值是 100 磅，即 7 石两磅。

但是，如果您将 10 磅的体重喂入：

```
weight := stones + pounds/14.0; 
```

然后你会发现权重值为 10/14。添加 10 批得到 100/14，好吧，我相信你明白我的意思！

存储此类数据的另一种明显方式是磅。整数或浮点数都有意义。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-18T19:47:20.750

或者你可以做这样的事情:-)

```
unit PoundsAndStones;

interface

uses
  SysUtils;

type
  TPoundStone = record
  private
    FWeight : double;
    function GetPounds: integer;
    procedure SetPounds(const Value: integer);
    function GetStones: integer;
    procedure SetStones(const Value: integer);
    procedure SetWeight(const Value: double);
    function GetString: string;
  public
    property Weight : double read FWeight write SetWeight;   //Weight in stones.pounds format
    property Stones : integer read GetStones write SetStones; //Weight in stones, fraction part ignored
    property Pounds : integer read GetPounds write SetPounds; //Weight in pounds
    property AsString : string read GetString;

    class operator Implicit(A : double) : TPoundStone;
    class operator Implicit(A : TPoundStone) : double;
    class operator Add(A, B: TPoundStone): TPoundStone;
  end;

implementation

class operator TPoundStone.Add(A, B: TPoundStone): TPoundStone;
begin
  Result.Weight := A.Weight + B.Weight;
end;

function TPoundStone.GetPounds: integer;
begin
  Result := round(frac(FWeight)*100);
end;

function TPoundStone.GetStones: integer;
begin
  Result := trunc(FWeight);
end;

function TPoundStone.GetString: string;
var
  P,S : string;
begin
  if Stones > 1 then
    S := inttostr(Stones)+' stones'
  else if Stones = 1 then
    S := '1 stone'
  else
    S := '';

  if Pounds > 1 then
    P := inttostr(Pounds)+' pounds'
  else if Pounds = 1 then
    P := '1 pound'
  else
    P := '';

  if (P > '') and (S > '') then
    Result := S + ' and ' + P
  else
    Result := S + P;
end;

class operator TPoundStone.Implicit(A: double): TPoundStone;
begin
  Result.FWeight := A;
end;

class operator TPoundStone.Implicit(A: TPoundStone): double;
begin
  Result := A.FWeight;
end;

procedure TPoundStone.SetWeight(const Value : double);
var
  P,S : integer;
begin
  S := trunc(Value);
  P := round(100*frac(Value));

  S := S + P div 14;
  P := P mod 14;

  FWeight := S + P/100.0;
end;

procedure TPoundStone.SetPounds(const Value: integer);
var
  P,S : integer;
begin
  S := Value div 14;
  P := Value mod 14;

  FWeight := S + P/100.0;
end;

procedure TPoundStone.SetStones(const Value: integer);
begin
  Weight := Value*14;
end;

end. 
```

这将允许你做这样的事情

```
program Project1;

{$APPTYPE CONSOLE}

{$R *.res}

uses
  System.SysUtils,
  PoundsAndStones in 'PoundsAndStones.pas';

var
  P0,P1,P2 : TPoundStone;

begin
  P0 := 1.05;
  P1 := 3.12;

  writeln(P0.AsString);
  writeln(P1.AsString);

  P2 := P0 + P1;
  writeln(P2.AsString);
end. 
```

这将输出：

```
1 stone and 5 pounds
3 stones and 12 pounds
5 stones and 3 pounds 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-18T18:46:23.390

```
function tostonesandpounds(p_value : double) : double;
var
  stone : integer;
  pounds : integer;
begin
  stone := trunc(p_value);
  pounds := trunc(100.0*(p_value + 0.009));
  pounds := pounds-(stone*100);
  inc(stone,(pounds div 14));
  pounds := pounds mod 14;
  result := stone + (pounds/100.0);
end; 
```

# java - 如果我不知道要传入多少个参数，如何使用准备好的语句？

> ID：15483679
> 
> 赞同：7
> 
> 时间：2013-03-18T17:59:07.867
> 
> 标签：java, mysql

所以我有一个简单的函数来从数据库中返回一些东西。**然后我可以通过在WHERE**子句中添加不同的参数来修改这个查询。处理这个问题的最优雅和最有效的方法是什么？

例子：

```
 public static getUsers(int id, string username, string email) {

        Connection conn = null;
        PreparedStatement stmt = null;
        String sql = "";

        sql = "SELECT * FROM users " ......... 
```

这就是我对 where 子句感到困惑的地方。如果我做类似的事情

```
"WHERE id = ? AND username = ? AND email = ?"; 
```

如果我只用一个 ID 调用该方法，而没有用户名或电子邮件，会发生什么？它会破裂，我不能让这种情况发生。

此外，管理我的索引变得很困难，因为如果我会做类似的事情`stmt.setInt(1, id)`，但如果我只想用用户名调用该方法，并且该 id 将作为 null 出现，不会抛出 NPE？

我对Java有点陌生，抱歉......但我想我应该使用覆盖？我应该在条件语句中构建 where 子句吗？任何帮助，将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T18:22:04.720

我将创建一个实现[Builder Pattern](http://en.wikipedia.org/wiki/Builder_pattern)的 SqlQuery 类。[这](https://stackoverflow.com/questions/328496/when-would-you-use-the-builder-pattern/1953567#1953567)是一篇很好的文章，解释了该模式的用法。

例子：

```
public class SqlQuery {
    private StringBuilder tableQuery = new StringBuilder();
    private StringBuilder whereQuery = new StringBuilder();

    public SqlQuery(String selection, String table) {
        tableQuery.append("SELECT ").append(selection).append(" FROM ").append(table);
    }

    public SqlQuery addWhereClause(String parameter, String value) {
        if (whereQuery.length() == 0) {
            whereQuery.append(" WHERE ");
        }
        else {
            whereQuery.append(" AND ");
        }
        whereQuery.append(parameter).append(" = ").append(value);
        return this;
    }

    public String toString() {
        return tableQuery.toString() + whereQuery.toString();
    }
}

SqlQuery sqlQ = new SqlQuery("*", "users")
                  .addWhereClause("id", "2")
                  .addWhereClause("email", "test");
System.out.println(sqlQ); 
```

这打印：

> SELECT * FROM users WHERE id = 2 AND email = test

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T08:43:04.620

@ghdalum 的绝妙想法实际上并不涉及 PreparedStatement。这是我对他的构建器想法的改编，以生成 PreparedStatement：

```
public class UserQueryBuilder {

    private Connection conn;
    private StringBuilder query = new StringBuilder("SELECT * FROM users");
    private List<ValueSetter> valueSetters = new ArrayList<ValueSetter>();

    // callback interface for setting the column values
    private interface ValueSetter {
        void setValue(PreparedStatement ps);
    }

    // the caller is responsible for closing the connection afterwards
    public QueryBuilder(Connection conn) {
        this.conn = conn;
    }           

    public QueryBuilder byId(final Integer id) {
        appendSeparator();
        query.append("id = ?");
        valueSetters.add(new ValueSetter() {
            public void setValue(PreparedStatement ps) {
                ps.setInt(id);
            }
        });
        return this;
    }   

    public QueryBuilder byEmail(String email) {
        appendSeparator();
        query.append("email = ?");
        valueSetters.add(new ValueSetter() {
            public void setValue(PreparedStatement ps) {
                ps.setString(email);
            }
        });
        return this;
    }   

    public QueryBuilder byUsername(String username) {
        appendSeparator();
        query.append("username= ?");
        valueSetters.add(new ValueSetter() {
            public void setValue(PreparedStatement ps) {
                ps.setString(username);
            }
        });
        return this;
    }

    private void appendSeparator() {
        if (filterValues.size() == 0) {
            query.append(" WHERE ")
        }
        else {
            query.append(" AND ")
        }
    }

    public PreparedStatment build() {
        PreparedStatement ps = conn.prepareStatement(query.toString());
        for(ValueSetter valueSetter : valueSetters) {
            valueSetter.setValue(ps);
        }
        return ps;
    }
} 
```

用法：

```
PreparedStatement userQuery = new UserQueryBuilder(conn)
                              .byId("2")
                              .byEmail("test")
                              .build();
userQuery.execute(); 
```

（顺便说一句，我没有测试这段代码，所以可能有错别字）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-18T18:03:57.260

写if else语句即

```
 if(username!=null)
 query=query+"username=?"; 
```

和

```
if(username!=null)
stmt.setInt(2, username) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-18T18:04:11.440

我会做这样的事情，创建一个接受的方法，`List<ColumnNames>`并在该方法中通过将占位符附加到列名来遍历所有列名。

```
public List<Something> method(List<Something> list){

String sql = "SELECT * FROM users WHERE "+ this.processPlaceHolders(list);

}

public String processPlaceHolders(List<Something> list) {
StringBuilder finalStr=new StringBuilder("");
for(int i=0;i<list.size(); i++){
if(i==list.size()-1){
finalStr.append(list.get(i)+"=" +"?"); 
}
else {
   finalStr.append(list.get(i)+"=" +"?,");
}
}
return finalStr.toString();
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-18T18:06:22.837

您将需要动态构建 SQL 查询以实现此目的。

```
public static getUsers(int id, string username, string email) {

    Connection conn = null;
    PreparedStatement stmt = null;
    String sql = "";

    sql = "SELECT * FROM users where id=? ";
    if (username != null)
      sql += " AND username=? ";
    if (email !=null)
      sql += " AND email=?";

    stmt = conn.prepareStatement(sql);
    stmt.setInt(1,id);
    if (username != null && email !=null)
    {
      stmt.setString(2,username);
      stmt.setString(3,email);
    }
    else if (username != null)
      stmt.setString(2,username);
    else if (email != null)
      stmt.setString(2,email); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-18T18:11:41.230

您的问题的解决方案是这样的：

```
public void getRecord(String id, String username, String email)
{
  String sql = " select * from users ";
  boolean isID , isUserName, isEmail;
  boolean isFirst = true;
  if (id!=null)
  {
     if ( isFirst)
     {
       sql = sql + " where";
       isFirst = false;
     }
     sql =  sql + " id = ?";
     isID = true;
  }
  if (username != null)
  {
     if ( isFirst)
     {
       sql = sql + " where";
       sql =  sql + " username = ?";
       isFirst = false;
     }
     else
     sql =  sql + " and username = ?";
     isUserName = true;
  }
  if (email != null)
  {
     if ( isFirst)
     {
       sql = sql + " where";
       sql = sql + " email = ?";
       isFirst = false;
     }
     else
     sql = sql + " and email = ?";
     isEmail = true;
  }
  PreparedStatement pst = con.prepareStatement(sql);
  int counter = 1;
  if (isID)
  pst.setString(counter++,id);
  if (isUserName)
  pst.setString(counter++,username);
  if (isEmail)
  pst.setString(counter++,email);
  //Then execute the query
  ResultSet rs = pst.executeQuery();
  .......
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-18T18:20:17.177

试试这个：

```
public static getUsers(int id, String username, String email) {
        Connection conn = null;
        PreparedStatement stmt = null;
        String sql = "SELECT * FROM users WHERE id=? ";

        if (username != null && username.trim().length() != 0) sql = sql + " AND username=? "; 
        if (email != null && email.trim().length() != 0) sql = sql + " AND username=? ";

        stmt = conn.prepareStatement(sql);
        stmt.setInt(1, id);

        if (username != null && username.trim().length() != 0) stmt.setString(2, username);
        if (email != null && email.trim().length() != 0) stmt.setString(3, email);
//.....
    } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-03-18T19:08:19.793

与其编写一个非常复杂的方法来动态构造 PreparedStatement，不如考虑为每个有效的输入组合编写一个单独的方法。然后每个人都可以轻松地验证其输入，并始终使用特定的 PreparedStatement。这不仅在未来更容易理解和维护，而且更容易测试。

如果您需要与现有 API 向后兼容，则可以编写一个`getUsers(int id, string username, string email)`方法来适当地委托给更简单的方法。

# android - 查看页面。在 SimpleCursorAdapter 中获取错误的光标

> ID：15483681
> 
> 赞同：0
> 
> 时间：2013-03-18T17:59:13.437
> 
> 标签：android, android-cursorloader

我收到一个非常奇怪的错误（情况）。我将 ViewPager 和 FragmentStatePagerAdapter 与许多 ListFragment 一起使用（sqlite 数据库中的每条记录一个）。每个 ListFragment 都实现了 LoaderManager.LoaderCallbacks。我将仅显示更重要部分的代码片段（据我所知）

```
class EnglishDictStatePagerAdapter extends FragmentStatePagerAdapter {

    private int records;
    private Cursor cursor;

    public EnglishDictStatePagerAdapter(FragmentManager fm) {
        super(fm);
        records = getCursor().getCount();
    }

    @Override
    public Fragment getItem(int position) {
        Fragment fragment = new EnglishDictDetailFragment();
        getCursor().moveToPosition(position);
        long wordId = cursor.getLong(1);
        Bundle args = new Bundle();
        args.putLong(WORD_ID, wordId);
        args.putInt(LANG_TYPE, getCurrentLangType());
        args.putInt(WORD_POSITION, position);
        fragment.setArguments(args);
        closeCursor();
        return fragment;
    }

    private Cursor getCursor() {
        if (cursor == null) {
            cursor = getContentResolver().query(getContentUri(), getProjection() ,null, null, null);
        }
        return cursor;
    }

    private void closeCursor() {
        if (cursor != null) {
            cursor.close();
        }
        cursor = null;
    }

    @Override
    public int getCount() {
        return records;
    }
} 
```

这是 ListFragment 类的一部分

```
class EnglishDictDetailFragment extends SherlockListFragment implements
        LoaderManager.LoaderCallbacks<Cursor> {

private int mLangType;
private int loaderId;
private long mId;

@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
                         Bundle savedInstanceState) {
    return inflater.inflate(R.layout.english_dict_list, container, false);
}

@Override
public void onActivityCreated(Bundle savedInstanceState) {
    super.onActivityCreated(savedInstanceState);
    registerForContextMenu(getListView());
    SimpleCursorAdapter mAdapter = new SimpleCursorAdapter(
        getSherlockActivity(),
        R.layout.english_dict_list_item,
        null,
        null,
        new int[] { R.id.english_dict_word },
        0
    );
    setListAdapter(mAdapter);
    getLoaderManager().initLoader(loaderId, null, this);
}

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    mId = getArguments().getLong(WORD_ID);
    mLangType = getArguments().getInt(LANG_TYPE);
    loaderId = getArguments().getInt(WORD_POSITION);
}

@Override
public Loader<Cursor> onCreateLoader(int id, Bundle args) {
    return new CursorLoader(getSherlockActivity(), getContentUri(), null, null, null, null)

@Override
public void onLoadFinished(Loader<Cursor> loader, Cursor cursor) {
    if (loader.getId() == loaderId) {
        ((SimpleCursorAdapter)getListAdapter()).swapCursor(cursor);
    }
}

@Override
public void onLoaderReset(Loader<Cursor> loader) {
    ((SimpleCursorAdapter)getListAdapter()).swapCursor(null);
} 
```

它允许滚动加载正确内容的 ListFragments。但是，如果我尝试使用代码在代码中的某个位置（例如 onContextItemSelected 中的示例）获取光标

```
cursor = (Cursor)getListAdapter().getItem(info.position); 
```

我经常从 ViewPager 中的上一个或下一个 ListFragment 获取光标。我不知道是什么原因，但我在 onLoadFinished 中看到该方法被调用了 3 次，并且最后一次有来自其他 ListFragment 的游标参数。我可以假设它首先使用右光标显示内容，但后来加载了屏幕外 ListFragment 项目（邻居）的内容，并且以某种方式来自邻居 ListFragment 的光标被分配给当前（可见）ListFragment 的 SimpleCursorAdapter。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T06:51:35.633

我想我已经找到了解决方案。它是在多片段活动中的 onContextItemSelected 处理中发出的。

[如何在多片段活动中处理 onContextItemSelected？](https://stackoverflow.com/questions/5297842/how-to-handle-oncontextitemselected-in-a-multi-fragment-activity)

# ios - 在哪里设置 CGAffineTransformMakeScale(2, 2);

> ID：15483682
> 
> 赞同：0
> 
> 时间：2013-03-18T17:59:15.947
> 
> 标签：ios, objective-c, calayer

我正在使用最新的 SDK 开发一个 iOS 应用程序。

我这样创建`AVCaptureVideoPreviewLayer`：

```
// Create the preview layer
_videoPreviewLayer = [[AVCaptureVideoPreviewLayer alloc] initWithSession:_captureSession];
[_videoPreviewLayer setFrame:self.view.bounds];
_videoPreviewLayer.videoGravity = AVLayerVideoGravityResizeAspectFill;
[self.view.layer insertSublayer:_videoPreviewLayer atIndex:0]; 
```

现在我想这样做：

```
_videoPreviewLayer.affineTransform = CGAffineTransformMakeScale(2, 2); 
```

但是，如果我把它放在`[_videoPreviewLayer setFrame:self.view.bounds];`我得到不同的结果之前，而不是我把它放在后面。

**我必须在哪里应用规模？**

而且，如果我想设置`CGAffineTransformMakeRotation(-M_PI_2); // -90 degrees`，我必须在哪里做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T18:55:27.573

您不应该在其变换不是身份的视图上使用 setFrame。根据 Apple 关于 UIView 的 frame 属性的文档：

> 如果变换属性不是恒等变换，则此属性 [frame] 的值未定义，因此应被忽略。

在 UIView.h 中，在 frame 属性之上

> 如果视图被转换，请不要使用框架，因为它不会正确反映视图的实际位置。改用边界+中心。

因此，如果您在此代码中切换到使用 setBounds 和 setCenter 而不是 setFrame，您可能会得到您正在寻找的一致结果。

直接回答这个问题：如果您还使用 setFrame，则没有放置这些变换（缩放或旋转）的正确位置。如果您使用 setBounds 和 setCenter，那么无论您在 setBounds/setCenter 之前还是在 setBounds/setCenter 之后应用变换，都将获得相同的结果。

**编辑：VansFannel 指出这是一个 CALayer，而不是 UIView，所以上述评论并不真正适用。我离开他们是为了不剥夺 VansFannel 对上下文的评论，也因为它仍然是对 UIViews 的一个很好的警告**

现在，对于 CALayers，如果您设置的帧（如 [_videoPreviewLayer setFrame:self.view.bounds]）将导致 _videoPreviewLayer 的实际渲染帧为 self.view.bounds，即使 _videoPreviewLayer 具有非身份变换。重要的是要记住 CALayer 的框架实际上是一个派生属性。它派生自层的边界、位置、锚点和变换。当您使用 setFrame 时，QuartzCore 会计算出一个边界和位置，该边界和位置会产生您在现有锚点和变换下传递给 setFrame 的帧。

因此，如果您希望这些转换产生任何效果，您应该在调用 setFrame*之后将它们放置。*如果您先设置变换，那么 setFrame 将有效地否定它们。如果您绝对需要首先设置变换，那么您必须避免使用 setFrame 并直接使用图层的边界和位置。

# android - 为一个应用发送推送通知

> ID：15483685
> 
> 赞同：1
> 
> 时间：2013-03-18T17:59:24.483
> 
> 标签：android, push-notification, google-cloud-messaging, api-key

我在android上有很多应用程序。并且一些用户共享相同的注册ID。如何指定推送通知并将其发送到特定应用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T18:07:49.743

不同的应用程序在同一设备上具有不同的注册 ID，因此您应该没有任何问题。你是什​​么意思`users are share the same register ID`？您是指同一设备上同一应用程序的用户吗？这是他们可以共享注册 ID 的唯一情况。

即使您在为 Google Cloud Messaging 注册不同的应用程序时使用相同的 Google API 项目 ID，您仍然会为每个应用程序获得不同的注册 ID。我测试了它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T18:08:23.337

如果您无法更改注册 ID 流程以唯一标识您的应用程序（最佳解决方案），您可以使用 GCM 消息发送[有效负载](http://developer.android.com/google/gcm/adv.html#payload)，并让您的应用程序忽略没有特定有效负载的 GCM 消息。

# android - 使用 EnumTypeAdapter 时，将 proguard 与 GSON 和 RoboGuice 一起使用会失败

> ID：15483686
> 
> 赞同：2
> 
> 时间：2013-03-18T17:59:24.857
> 
> 标签：android, gson, proguard

当尝试将 EnumTypeAdapter 与 Proguard 一起使用时，会导致 Gson.getAdapter() 中出现 AssertionError。这个错误似乎是由于类型信息丢失......下面是所有相关的源代码：

例外：

```
03-18 13:27:12.905: ERROR/roboguice(12139): Throwable caught during background processing
    java.lang.AssertionError
    at com.google.gson.internal.bind.TypeAdapters$EnumTypeAdapter.<init>(Unknown Source)
    at com.google.gson.internal.bind.TypeAdapters$24.create(Unknown Source)
    at com.google.gson.Gson.getAdapter(Unknown Source) 
```

正在使用的 EnumTypeAdapter：

```
public class OperationResultSerializer implements JsonDeserializer<OperationResult>, JsonSerializer<OperationResult> {

@Override
public OperationResult deserialize(JsonElement json, Type typeOfT, JsonDeserializationContext context) throws JsonParseException {
    int value = json.getAsJsonPrimitive().getAsInt();
    return OperationResult.values()[value];
}

@Override
public JsonElement serialize(OperationResult src, Type typeOfSrc, JsonSerializationContext context) {
    return new JsonPrimitive(src.ordinal());
}
} 
```

我如何构建我的 GSON 对象：

```
 gson = new GsonBuilder()
                .registerTypeAdapter(Calendar.class, new WcfCalendarSerializer())
                .registerTypeAdapter(OperationResult.class, new OperationResultSerializer())
                .registerTypeAdapter(FieldName.class, new FieldNameSerializer())
                .registerTypeAdapter(MealType.class, new MealTypeSerializer())
                .create(); 
```

我的 ProGuard 配置：

```
#-dontusemixedcaseclassnames: Necessary when building on windows where x.class and X.class is the same file
-dontusemixedcaseclassnames

-keepattributes *Annotation*
-keepattributes Signature

# Preserve the special static methods that are required in all enumeration classes.
-keepclassmembers enum * {
    public static **[] values();
    public static ** valueOf(java.lang.String);
}

-keep public class * extends android.app.Application
-keep public class * extends android.app.Activity
-keep public class * extends android.app.Service
-keep public class * extends android.content.BroadcastReceiver
-keep public class * extends android.content.ContentProvider
-keep class * extends android.view.View { 
  public <init>(android.content.Context); 
  public <init>(android.content.Context, android.util.AttributeSet); 
  public <init>(android.content.Context, android.util.AttributeSet, int); 
  public void set*(...); 
}
-keep class com.google.inject.** { *; } 
-keep class javax.inject.** { *; } 
-keep class javax.annotation.** { *; } 
-keep class roboguice.** { *; } 

-keep class * extends android.preference.Preference { 
  public <init>(android.content.Context); 
  public <init>(android.content.Context, android.util.AttributeSet); 
  public <init>(android.content.Context, android.util.AttributeSet, int); 
  public void set*(...); 
}   

# Gson specific classes
-keep class sun.misc.Unsafe { *; }
#-keep class com.google.gson.stream.** { *; }

###Action bar sherlock 
-keep class android.support.v4.app.** { *; } 
-keep interface android.support.v4.app.** { *; } 
-keep class com.actionbarsherlock.** { *; } 
-keep interface com.actionbarsherlock.** { *; } 

###RoboGuice 
-keepclassmembers class * { 
    @com.google.inject.Inject <init>(...); 
} 
-keepclassmembers class * { 
    void *(**On*Event); 
} 
-keep public class roboguice.** 
-keep class com.google.inject.** 
-keep class com.google.gson.** {*;}

#datacontract
-keep public class com.ordering.datacontract.*
-keepclassmembers class com.ordering.datacontract.*

# LVL License binder class
-keep class com.android.vending.licensing.ILicensingService    

-dontwarn
-ignorewarnings 
```

如前所述，我怀疑由于类型信息丢失而导致某些事情失败 - 在深入研究 GSON 源代码后，这是为解析 EnumTypeAdapter 而调用的代码......显然 getEnumConstants 返回的名称不存在classOfT 类型的字段。但我不确定这怎么可能。

```
private static final class EnumTypeAdapter<T extends Enum<T>> extends TypeAdapter<T> {
private final Map<String, T> nameToConstant = new HashMap<String, T>();
private final Map<T, String> constantToName = new HashMap<T, String>();

public EnumTypeAdapter(Class<T> classOfT) {
  try {
    for (T constant : classOfT.getEnumConstants()) {
      String name = constant.name();
      SerializedName annotation = classOfT.getField(name).getAnnotation(SerializedName.class);
      if (annotation != null) {
        name = annotation.value();
      }
      nameToConstant.put(name, constant);
      constantToName.put(constant, name);
    }
  } catch (NoSuchFieldException e) {
    throw new AssertionError();
  }
}
public T read(JsonReader in) throws IOException {
  if (in.peek() == JsonToken.NULL) {
    in.nextNull();
    return null;
  }
  return nameToConstant.get(in.nextString());
}

public void write(JsonWriter out, T value) throws IOException {
  out.value(value == null ? null : constantToName.get(value));
}
  } 
```

我已经到处寻找可能的解决方案，但没有找到太多帮助。也许有人以前遇到过这种情况并可以指出我正确的方向？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T15:06:50.380

我通过并检查了反编译的结果 APK。我相信这个问题与某些枚举类型在混淆过程中丢失其成员有关。

一定要保留枚举类成员：

```
-keepclassmembers enum * {
 public static **[] values();
 public static ** valueOf(java.lang.String);
 } 
```

另外 - 确保保留 GSON 中使用的所有类：

```
 -keep public class com.company.ordering.datacontract.** {
 public protected *;
 }

 -keep public class com.company.ordering.service.request.** {
 public protected *;
 }
 -keep public class com.company.ordering.service.response.** {
 public protected *;
 } 
```

查看完整配置@pastebin.com/r5Jg3yY2

# hadoop - 从 tarball 安装 CDH4 和 MRv1

> ID：15483687
> 
> 赞同：0
> 
> 时间：2013-03-18T17:59:29.037
> 
> 标签：hadoop

需要一些关于从 tarball 安装 CDH4 的指导

我从“ [https://ccp.cloudera.com/display/SUPPORT/CDH4+Downloadable+Tarballs](https://ccp.cloudera.com/display/SUPPORT/CDH4+Downloadable+Tarballs) ”下载了两个文件

1) hadoop-0.20-mapreduce-0.20.2+1341 (只有 MRv1) 2) hadoop-2.0.0+922 (有 HDFS+ Yarn)

我能够从第一个文件“1) hadoop-0.20-mapreduce-0.20.2+1341”安装 MRv1 我已经编辑了 hadoop-env.sh、core-site.xml、hdfs-site.xml 和 mapred-site。 xml 存在于 untared 文件的 conf 目录中。我的 JobTracker 和 TaskTracker 工作正常。

我可以在 hadoop-env.sh 中看到一些新变量，它们是：HADOOP_NAMENODE_OPTS HADOOP_SECONDARYNAMENODE_OPTS HADOOP_DATANODE_OPTS HADOOP_BALANCER_OPTS HADOOP_JOBTRACKER_OPTS

这些是什么 ？我应该设置这些吗？

解压后 "2) hadoop-2.0.0+922" 。我可以在 /etc/hadoop/ 看到另外一组配置文件 我需要使用这些配置文件吗？

我无法从此启动 NAMENODE 和 DATANODE 服务。需要进行哪些配置更改？任何人都可以指导我找到包含所有安装步骤的正确链接吗？请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T07:46:01.043

不知道现在回答是否为时已晚，但

您需要先转到计算机上的“hadoop-2.0.0-mr1-cdh4.2.0”文件夹，然后运行以下命令

启动数据节点和名称节点的命令是：

for x in /"你机器上 hadoop 目录的路径"/hadoop-2.0.0-mr1-cdh4.2.0/bin/hadoop-* ; 做 $x 启动数据节点；完毕 ;

for x in /"你机器上 hadoop 目录的路径"/hadoop-2.0.0-mr1-cdh4.2.0/bin/hadoop-* ; 做 $x 启动名称节点；完毕 ;

# android - 浏览所有网站和所有链接在同一个网页视图中打开

> ID：15483690
> 
> 赞同：2
> 
> 时间：2013-03-18T17:59:39.883
> 
> 标签：android, android-webview

当我创建 webview 应用程序以在同一 webview 上查看任何网站而不是浏览器时，它工作正常，但是当我单击该网站中的任何链接时，它会在浏览器中打开？当用户在同一个 webview 上单击它们时，如何加载所有内部链接/页面/部分？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-18T18:05:06.433

Java版本：您只需要`WebViewClient`为您设置一个`WebView`，然后所有链接都将打开它`WebView`：

```
webView.setWebViewClient(new WebViewClient()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T18:05:09.600

```
private class myCustomWebViewClient extends WebViewClient {
    @Override
    public boolean shouldOverrideUrlLoading(WebView view, String url) {
    //here load the url in your webview
    webview.loadUrl(url);

    return true;
    } 
```

这在你的网络视图中设置

```
webView.setWebViewClient(new myCustomWebViewClient()); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-01-22T11:13:55.803

科特林版本。

```
webView.webViewClient = WebViewClient() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-18T11:58:34.870

您应该添加自己的 webViewClient。

```
WebView myWebView = (WebView) findViewById(R.id.webview);
myWebView.setWebViewClient(new MyWebViewClient()); 
```

在 webViewClient 中，您可以覆盖 shouldOverrideUrlLoading() 方法，如下所示：

```
 @Override
    public boolean shouldOverrideUrlLoading(WebView view, String url) {
        if (Uri.parse(url).getHost().equals("www.example.com")) {
            // This is my web site, so do not override; let my WebView load the page
            return false;
        }
        // Otherwise, the link is not for a page on my site, so launch another Activity that handles URLs
        Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse(url));
        startActivity(intent);
        return true;
    } 
```

我希望你觉得这对你有帮助。

# ios6 - ios6 EXC_BAD_ACCESS（代码=1，地址=0x0）错误

> ID：15483694
> 
> 赞同：0
> 
> 时间：2013-03-18T17:59:46.100
> 
> 标签：ios6, uiviewcontroller, uinavigationcontroller, exc-bad-access, back

我收到 EXC_BAD_ACCESS(code=1, address=0x0) 错误（地址等于另一个不是 0x0，但我假设一个与我的项目相关的数字）。

在导航控制器系统中“返回”到主 VC 时会发生此错误。设置如下：

![在此处输入图像描述](../Images/9f69961eb84ff74db1fee77d67917271.png)

**View Controller - MyConnection 是主要的 ViewController**。这个VC上有tableviewcells和一个标签栏。tableviewcells 将带您到**Choose Server VC**或**Choose Test Type VC**。标签栏上的一个按钮将您带到**Preferences VC**。

这一切都很好，您可以毫无问题地往返。

Preferences VC 也有表格单元，它们也将用户带到选择服务器和选择测试类型 VC。从选择服务器或选择测试类型返回首选项，然后返回主 VC 时，会出现我的错误。**它在返回主 VC 时崩溃**并给出上述错误。遗憾的是，调试器没有提供更多信息。我推断正在调用主 VC 中的 viewWillAppear 代码，并且在重新加载表数据时它会崩溃。

知道可能出了什么问题吗？

更新：

更多地使用调试器，返回时似乎没有调用 cellForRowAtIndexPath。知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T18:23:25.717

在阅读了一些其他与 cellForRowAtIndexPath 相关的帖子后，我尝试添加：

```
self.navigationController.delegate= self;
    self.tableView.delegate = self; 
```

到我的 viewWillAppear 在主 ViewController 中。这解决了问题。

# ios - 将点击事件添加到 IOS NSMutableAttributedString

> ID：15483697
> 
> 赞同：2
> 
> 时间：2013-03-18T17:59:59.507
> 
> 标签：ios, nsattributedstring

我有一个 NSMutableAttributedString，例如“Bob 喜欢你的照片”。

我想知道是否可以将两个不同的点击事件添加到“鲍勃”和“图片”。理想情况下，点击“Bob”会显示一个带有 Bob 个人资料的新视图控制器，点击“picture”会显示一个带有图片的新视图控制器。我可以用 NSMutableAttributedString 做到这一点吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-18T18:48:04.833

您可以通过使用 CoreText 实现一个方法来实现这一点，该方法将检索用户选择/触摸的字符的索引。`UIView`首先，使用 CoreText，在自定义子类中绘制属性字符串。一个示例重写`drawRect:`方法：

```
- (void) drawRect:(CGRect)rect
{
    // Flip the coordinate system as CoreText's origin starts in the lower left corner
    CGContextRef context = UIGraphicsGetCurrentContext();

    CGContextTranslateCTM(context, 0.0f, self.bounds.size.height);
    CGContextScaleCTM(context, 1.0f, -1.0f);

    UIBezierPath *path = [UIBezierPath bezierPathWithRect:self.bounds];
    CTFramesetterRef frameSetter = CTFramesetterCreateWithAttributedString((__bridge   CFAttributedStringRef)(_attributedString));

    if(textFrame != nil) {
        CFRelease(textFrame);
    }

    // Keep the text frame around.
    textFrame = CTFramesetterCreateFrame(frameSetter, CFRangeMake(0, 0), path.CGPath, NULL);
    CFRetain(textFrame);

    CTFrameDraw(textFrame, context);
} 
```

其次，创建一个查询文本以查找给定点的字符索引的方法：

```
- (int) indexAtPoint:(CGPoint)point
{
    // Flip the point because the coordinate system is flipped.
    point = CGPointMake(point.x, CGRectGetMaxY(self.bounds) - point.y);
    NSArray *lines = (__bridge NSArray *) (CTFrameGetLines(textFrame));

    CGPoint origins[lines.count];
    CTFrameGetLineOrigins(textFrame, CFRangeMake(0, lines.count), origins);

    for(int i = 0; i < lines.count; i++) {
        if(point.y > origins[i].y) {
            CTLineRef line = (__bridge CTLineRef)([lines objectAtIndex:i]);
            return CTLineGetStringIndexForPosition(line, point);
        }
    }

    return 0;
} 
```

最后，您可以重写该`touchesBegan:withEvent:`方法以获取用户触摸的位置并将其转换为字符索引或范围：

```
- (void) touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{
    UITouch *t = [touches anyObject];
    CGPoint tp = [t locationInView:self];
    int index = [self indexAtPoint:tp];

    NSLog(@"Character touched : %d", index);
} 
```

确保将 CoreText 包含到您的项目中并清理您保留的所有资源（如文本框架），因为该内存不是由 ARC 管理的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T18:12:41.820

我处理它的方式是`NSString`在`UITextView`. 然后利用`UITextInput`协议方法`firstRectForRange:`。然后，您可以轻松地在该矩形中覆盖一个不可见`UIButton`的内容并处理您想要采取的行动。

# biztalk - 从自定义代码修改 Biztalk 消息

> ID：15483699
> 
> 赞同：1
> 
> 时间：2013-03-18T18:00:06.993
> 
> 标签：biztalk

免责声明：我是一个完整的 biztalk 新手。

我需要能够阅读并可能编辑 biztalk 消息中的 4 个节点；最好这需要从 ac# helper 类中完成，因为我正在进行服务调用并且还为此编写了单元测试。

我已经连接了这个类，它可以与 XLANGMessage 类一起使用，我遇到的问题是在编排中的这一点，消息是基于模式的类型，我似乎没有任何方法可以修改它。

我做了一些阅读并找到了一些想法，但无法确认其中任何一个是否可以从自定义代码中工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T19:09:46.073

1 编写一个映射来将传入的消息转换为所需的类型

或者

2 在你的帮助组件中写这样的东西来转换消息

公共 XmlDocument TransformMessage（XLANGMessage 消息）

然后将结果文档传递给[消息分配](http://msdn.microsoft.com/en-us/library/aa561718.aspx)形状中的 biztalk 消息。

响应消息 = xmlDocument;

如果您[传递流而不是消息，](http://blogs.msdn.com/b/paolos/archive/2010/04/08/how-to-boost-message-transformations-using-the-xslcompiledtransform-class-extended.aspx)您可能会获得更好的性能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T22:12:09.240

您可以轻松地将消息传入和传出 C# 助手类。最简单的方法是将输入参数和返回值视为 System.Xml.XmlDocument 类型。XLANG/s 引擎将安全地从 XLANGMessage 类型来回转换为 XmlDocument。

由于您实际上是在创建消息的“新”实例（消息在 BizTalk 中是不可变的），因此需要在消息分配形状中执行对帮助程序类的调用，外部构造形状构造原始消息的副本。

```
public static XmlDocument UpdateMyMessage(XmlDocument sourceMessage)
{
  /* Do stuff to your Message here */

  return sourceMessage;
} 
```

要考虑的最佳实践是将所有 C# 辅助方法声明为静态。这将避免在脱水期间对助手类进行反序列化/序列化的任何问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-22T17:39:33.503

BizTalk 消息是不可变的吗？

然而，一般来说，通过创建“纠正”编排并在传入消息参数上使用按引用传递选项，可以修改现有消息。

# excel - 将值合并到聚合列中

> ID：15483703
> 
> 赞同：0
> 
> 时间：2013-03-18T18:00:33.573
> 
> 标签：excel, if-statement, excel-formula, worksheet-function, countif

我有一个包含 5 列的电子表格

```
+----+----+----+----+--------------+
| C1 | C2 | C3 | C4 | C-骨料 |
+----+----+----+----+--------------+
|是 | | | | 是 |
| |是 | | | 是 |
| | |是 | | 是 |
| | | |是 | 是 |
|是 |是 | | | 是 |
|是 | |没有 | | 也许 |
|是 |是 |否 | | 也许 |
|是 |是 |否 |否 | 也许 |
|没有 | | | | 否 |
| |没有 | | | 否 |
| | |没有 | | 否 |
| | | |没有 | 否 |
+----+----+----+----+--------------+

```

C1 - C4 列是来自其他来源的静态数据。C-Aggrogate 旨在聚合其他列并在可能存在差异时突出显示。

给定行的规则是：

1.  如果所有列都为空白，则 C-Aggrogate 为空白
2.  如果至少一列是**Yes**而没有一列是**NO**那么 C-Aggrogate 是**YES**
3.  如果至少一列为“**否**”且没有任何**列为**“是” ，则 C-Aggrogate 为**“否”**
***   如果至少一列是**Yes**并且至少一列是**NO**那么 C-Aggrogate 是**MAYBE****

 **我从哪里开始为 C-Aggregate 创建正确的公式？YES，NO，MAYBE 只是样本值，它们可以是任何人类可读的值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T03:40:19.553

不漂亮，但似乎满足您的要求：

```
=IF(AND(COUNTIF(A1:D1,"YES")>0,COUNTIF(A1:D1,"NO")=0),"YES",
 IF(AND(COUNTIF(A1:D1,"NO")>0,COUNTIF(A1:D1,"YES")=0),"NO",
 IF(AND(COUNTIF(A1:D1,"YES")=0,COUNTIF(A1:D1,"NO")=0),"","MAYBE"))) 
```**

# unix - 将 shell 脚本输出到日志文件

> ID：15483704
> 
> 赞同：2
> 
> 时间：2013-03-18T18:00:36.913
> 
> 标签：unix, logging

我有一个预定的 unix 脚本，我想记录它的输出。由于用户界面限制，我无法编辑 cron 文件，也无法将 >> logfile 添加到命令中。我可以在脚本本身中添加一些东西来将输出发送到日志吗？

```
{

printf poo

 #Do not change
PRINTF=/usr/bin/printf
MSMTP=/usr/local/bin/msmtp
MSMTPCONF=/var/etc/msmtp.conf

 #Can be changed
FROM="nas4free@usinfosec.com"
TO="dpatino@usinfosec.com"
MDIR="CaseData"
SUBJECT="$MDIR Backup Report"

} > /mnt/support/logs/$SUBJECT.log
#BODY="$(cat /mnt/support/logs/test.log)"
#$PRINTF "From:$FROM\nTo:$TO\nSubject:$SUBJECT\n\n$BODY" | $MSMTP --file=$MSMTPCONF -t 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-06-05T09:52:15.513

尝试

```
#!/bin/bash
exec > /tmp/myLog.log 2>&1
set -x 
```

日志显示：

```
+ echo 'Hello World!'
Hello World! 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-18T18:20:18.030

一种方法是将脚本包装在大括号中并重定向输出，如下所示：

```
#!/bin/bash
{
# script contents here
echo running script
} > logfile 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-18T18:03:58.157

在脚本的开头附加以下行

```
log_file_path="/tmp/output.log"
log() { while IFS='' read -r line; do echo "$line" >> "$log_file_path"; done; };
exec > >(tee >(log)) 2>&1 
```

修改后的脚本

```
PRINTF=/usr/bin/printf
MSMTP=/usr/local/bin/msmtp
MSMTPCONF=/var/etc/msmtp.conf
FROM="nas4free@usinfosec.com"
TO="dpatino@usinfosec.com"
MDIR="CaseData"
SUBJECT="$MDIR Backup Report"

{

printf poo  

} > /mnt/support/logs/$SUBJECT.log
#BODY="$(cat /mnt/support/logs/test.log)"
#$PRINTF "From:$FROM\nTo:$TO\nSubject:$SUBJECT\n\n$BODY" | $MSMTP --file=$MSMTPCONF -t 
```

# c# - 将 DataType varchar 转换为 Numeric 时出错

> ID：15483712
> 
> 赞同：0
> 
> 时间：2013-03-18T18:00:59.957
> 
> 标签：c#, stored-procedures

在我的存储过程中，我从三个表中获取数据，但出现此错误：

> *将数据类型 varchar 转换为数值时出错。*

我认为问题出在：-

```
'NULL' AS DATE (in 1st query of this SP)------(1)
CONVERT(VARCHAR, tbl_IPD.ipd_doa, 103) AS DATE (in 2nd query of this SP)-----(2) 
```

我的问题是：如何将 (1) 行转换为 varchar

```
SELECT 
   tbl_CompanyProfile.Company_Name, tbl_CompanyProfile.Company_Address, 
   tbl_CompanyProfile.Company_ContactNo, tbl_CompanyProfile.Company_Email, 
   tbl_CompanyProfile.Company_Website, 
   'NULL' AS NAME, 'NULL' AS DATE,
   'NULL' AS AMOUNT, 'NULL' AS DEPARTMENT, 
   0 AS Age, @from AS StartDate, @to AS EndDate
FROM 
   tbl_CompanyProfile

UNION ALL

SELECT   
   '--', '--',
   '--', '--', '--', 
   tbl_IPD.ipd_pfname + ' ' + tbl_IPD.ipd_plname AS NAME, 
   CONVERT(VARCHAR, tbl_IPD.ipd_doa, 103) AS DATE, 
   ISNULL(SUM(tbl_fee.fee_amount), 0) AS AMOUNT, 
   tblDepartment.DeptName AS DEPARTMENT, tbl_IPD.ipd_age AS Age,  
   @from AS StartDate, @to AS EndDate
FROM            
   tbl_fee 
LEFT OUTER JOIN
   tbl_IPD ON tbl_fee.ipd_id = tbl_IPD.ipd_id 
LEFT OUTER JOIN
   tblDepartment ON tbl_IPD.ipd_dpt = tblDepartment.DeptId 
WHERE        
   (tbl_IPD.ipd_doa BETWEEN @from AND @to)
GROUP BY 
    tbl_IPD.ipd_pfname, tbl_IPD.ipd_plname, tbl_IPD.ipd_doa, tblDepartment.DeptName, tbl_IPD.ipd_age 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T18:03:40.170

如果您尝试返回一个`NULL`值，则应删除 上的引号`'NULL'`，否则您将返回 a`varchar`而这可能不是您想要做的。

如果我的假设是正确的，那么您的查询应该是这样的。

```
...NULL AS NAME, NULL AS DATE, NULL AS AMOUNT, NULL AS DEPARTMENT,... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T18:09:51.047

我认为问题实际上出在`AMOUNT`列中 - 您`NULL`在第一个查询中选择（字符串）并尝试将其连接到第二个查询中的数字结果。如果您想`NULL`在联合中使用实际值，只需从`NULL`引用中去掉撇号即可。

# elasticsearch - 在 elasticsearch 中搜索列表的一部分

> ID：15483714
> 
> 赞同：0
> 
> 时间：2013-03-18T18:01:02.217
> 
> 标签：elasticsearch

假设我有一个书名列表，我想查找其中哪些存在于我的索引中。

映射是：

```
"book": {
    "properties": {
                  "title":{"type":"string"}, 
                  "author":{"type":"string"}}} 
```

我可以迭代并检查每一个

```
curl -XPOST 'localhost:9200/myindex/book/_search' 
-d '{"query":{"match":{"title":"my title"}}} 
```

但是假设我的标题列表很长，我怎样才能批量执行此操作并获取哪些标题列表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T18:57:17.733

`match`针对您的标题字段运行多个查询，将它们与`bool`查询结合起来：

```
curl -XGET 'http://127.0.0.1:9200/myindex/book/_search?pretty=1'  -d '
{
   "query" : {
      "bool" : {
         "should" : [
            {
               "match" : {
                  "title" : "Title one"
               }
            },
            {
               "match" : {
                  "title" : "Title two"
               }
            },
            {
               "match" : {
                  "title" : "Title three"
               }
            }
         ]
      }
   }
}
' 
```

当然，`match`查询将匹配其字段包含查询字符串中的一个单词的任何书籍`title`，因此您可能希望使用`match_phrase`：

```
curl -XGET 'http://127.0.0.1:9200/myindex/book/_search?pretty=1'  -d '
{
   "query" : {
      "bool" : {
         "should" : [
            {
               "match_phrase" : {
                  "title" : "Title one"
               }
            },
            {
               "match_phrase" : {
                  "title" : "Title two"
               }
            },
            {
               "match_phrase" : {
                  "title" : "Title three"
               }
            }
         ]
      }
   }
}
' 
```

这将搜索确切的短语：相同顺序的相同单词。

# video - 播放 Youtube 视频后状态栏高度发生变化

> ID：15483717
> 
> 赞同：0
> 
> 时间：2013-03-18T18:01:08.740
> 
> 标签：video, ios6, statusbar

我有这个在 youtube 中加载视频列表的 Web 视图。在我选择并播放这些视频后，Web 视图向上移动了 20 像素。我在播放视频之前和之后打印了状态栏的值，并且高度从 20 变为 0，并且这仍然存在于所有应用程序中。这只发生在 iOS 6 上，在 iOS 5 中测试并且看起来不错

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T16:37:46.870

解决了这个问题，非常类似于这个[Modal dismissals do not account for status bar (new iOS 6 issue?)](https://stackoverflow.com/questions/12567233/modal-dismissals-do-not-account-for-status-bar-new-ios-6-issue)。我使用的 VC 没有返回正确支持的界面方向。更改此设置后，Web 视图始终位于正确的位置。

# exception - Excel - 窗体/ActiveX 控件属性不可用

> ID：15483719
> 
> 赞同：0
> 
> 时间：2013-03-18T18:01:13.237
> 
> 标签：exception, excel, vba

在 Excel 2010 中，是否存在阻止用户访问表单或 ActiveX 控件属性的设置？

我正在与一个可以打开 Excel 文件并在工作表上插入控件（表单和 ActiveX）的用户一起工作。但是，当该用户单击任何对象并转到它的属性时，将显示工作表的属性而不是所选对象的属性。

此外，任何尝试通过工作表访问控件的宏都会引发“对象不支持此属性或方法”错误，因为控件为空。请参阅下面的示例，该示例尝试在名为“AddParts”的工作表上引用名为“CommonDialog1”的对话框控件：

```
Worksheets("AddParts").CommonDialog1.ShowOpen 
```

我可以在同一工作簿的其他计算机上运行这个完全相同的宏，而不会出现任何问题。Excel 中是否有一些用户设置阻止用户访问对象？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-22T23:10:19.200

有这个确切的问题并找到了这个解决方案

关闭 Excel。

启动 Windows 资源管理器。

选择您的系统驱动器（通常是 C:)

使用搜索框搜索 *.exd

删除它找到的所有文件。

再次启动 Excel。

[将 Microsoft DataGrid 等 ActiveX 控件添加到 Excel 工作表时出现“无法插入对象”错误](https://stackoverflow.com/questions/16893446/cannot-insert-object-error-when-adding-activex-control-like-microsoft-datagrid)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T17:10:44.930

要回答上述问题： 1) 工作簿未受保护 2)选中*无限制启用所有 ActiveXControls 。*但是，我能够通过使用内置的*Application.GetOpenFilename* VBA 函数来获取文件对话框而不是使用 ActiveX 对话框控件来解决此问题。

我仍然不确定为什么 ActiveX 控件对用户不可用，但这种解决方法能够允许用户使用 Excel 工作簿。

# linux - Debian 软件包创建 - 如何安装配置文件？

> ID：15483725
> 
> 赞同：7
> 
> 时间：2013-03-18T18:01:50.490
> 
> 标签：linux, ubuntu, debian, package

我真的被这个小问题（我敢肯定）困住了，所以任何帮助都将不胜感激。我用 dh_make 创建了一个标准的 ubuntu 包。这个包的目的是创建一个包，它将设置系统需要的所有 ldap 相关包，包括它的配置。我正在尝试执行的步骤之一是在备份现有文件的同时复制 /etc/ldap.conf 文件。我该怎么做呢？我试图创建一个基本上如下所示的 postinst 脚本，但我不清楚包如何存储文件，并且我收到一条错误消息，提示缺少 etc/ldap.conf 文件。最好的方法是什么？这是我的 postinst 脚本：

`#!/bin/bash -xv`

```
install -v -b etc/ldap.conf /etc/ldap.conf  > /tmp/tst 2>&1 
```

这是我的骨架结构：

```
    root@hqd-clientb-16:~/navldapubuntu-0.1/debian# 树

     ├── 更新日志
     ├── 兼容
     ├── 控制
     ├── 版权
     ├── 文档
     ├──等
        └── ldap.conf
     ├── 安装
     ├── 后勤
     ├── 自述文件.Debian
     ├── README.source
     ├── 规则
     ├── 来源
       └── 格式
     ├── navldapubuntu
       └──等
     ├── navldapubuntu.debhelper.log
     ├── navldapubuntu.dirs
     └── navldapubuntu.doc-base.EX

```

这是我创建的包的一些附加信息。

```
    dpkg --contents tnoldapubuntu_0.1-1_all.deb（截断输出）
    ./usr/
    ./usr/share/
    ./usr/share/doc

    ./usr/share/doc/navldapubuntu/
    ./usr/share/doc/navldapubuntu/版权
    ./usr/share/doc/navldapubuntu/README.Debian
    ./usr/share/doc/navldapubuntu/changelog.Debian.gz
    ./etc/ldap.conf

```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-09-26T13:43:17.247

有一个专门用于创建配置包的工具：http: [//debathena.mit.edu/config-packages](http://debathena.mit.edu/config-packages)

这是一个简单的模板，可能有助于快速入门。

文件列表

*   模板（目录）
*   模板/debian（目录）
*   模板/debian/控制
*   模板/debian/changelog
*   模板/debian/置换
*   模板/debian/规则
*   模板/debian/postinst
*   模板/debian/安装
*   模板/debian/文档
*   模板/debian/compat
*   模板/自述文件
*   模板/构建
*   模板/文件（目录）
*   模板/文件/etc/ldap.conf.mycompanyname

内容

模板/debian/控制：

```
Source: PACKAGE_NAME
Section: morpho/misc
Priority: optional
Maintainer: MAINTAINER
Build-Depends: debhelper, config-package-dev (>= 5.0~)

Package: PACKAGE_NAME
Architecture: all
Depends: ${misc:Depends}, DEPENDENCY [, DEPENDENCY ...]
Provides: ${diverted-files}
Conflicts: ${diverted-files}
Description: PACKAGE_DESCRIPTION_SHORT
PACKAGE_DESCRIPTION_LONG. 
```

模板/debian/置换

```
/etc/ldap/ldap.conf.mycompanyname 
```

模板/debian/安装

```
files/* / 
```

模板/debian/postinst

```
#!/bin/sh
set -e
#DEBHELPER#

POSTINST_SCRIPT 
```

模板/debian/规则

```
#!/usr/bin/make -f

# Exclude *.svn* from building 
# you probably don't need this if don't use SVN
export DH_ALWAYS_EXCLUDE=.svn

# Core (check http://debathena.mit.edu/config-packages for more information)
%:
        dh $@ --with=config-package

# Prevent dh_installdeb of treating files in /etc as configuration files
# you need this if need configuration files been always rewritten
# even if changed
override_dh_installdeb:
        dh_installdeb
        rm debian/*/DEBIAN/conffiles 
```

模板/debian/文档

```
README
BUILD 
```

最后，您可以使用以下命令构建此包：

```
dpkg-buildpackage -us -uc -I.svn 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-18T21:15:29.240

您需要在 DEBIAN 目录中，在“控制”文件旁边创建一个“conffiles”文件，并在其中声明 /etc/ldap.conf。所以这个文件会自动被认为是一个配置文件，修改它会提示一个“新的配置文件，你想覆盖吗，yadda yadda”。

# shell - 将列中的值赋给变量并进行算术计算

> ID：15483730
> 
> 赞同：0
> 
> 时间：2013-03-18T18:02:10.640
> 
> 标签：shell

我有一个 out.txt 文件，其值如下：

```
39
45
44
55
50 
```

我想计算第一个值的百分比增加（例如：（45-39）*100/39 = 15.38%）。所以输出将是这样的：

```
0%
15.38%
12.8%
41.03%
28.21% 
```

所以我写了一个这样的bash脚本：

```
 *#!/bin/bash
    a=( `cat "out.txt"`)
    length=${#a[*]}
    echo $length
    x=${a[0]}
    echo $x
     for (( i = 1; i <= $length; i++))
  do
y=${a[$i]}
echo $y
diff= `echo "scale=2; ($y-$x)*100/$x" | bc`
    echo $diff 
```

完毕

但是这个脚本正在创建这样的错误：

(standard_in) 1：非法字符：^M (standard_in) 1：非法字符：^M (standard_in) 1：非法字符：^M

请帮我解决这个问题。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T18:06:58.430

您的`out.txt`文件中有不正确的行尾。`^M`字符是回车符。

运行`dos2unix`以将其更改为使用 Unix 行尾。

`=`另请注意，分配变量时，符号两侧不应有空格。你这里有一个：

```
diff= `echo "scale=2; ($y-$x)*100/$x" | bc` 
```

`=`删除标志右侧的空间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T18:35:58.163

```
{
    read first
    echo "0%"
    while read value; do
        printf "%.2f%%\n" $(bc <<< "100*($value-$first)/$first")
    done
} << END
39
45
44
55
50
END 
```

结果是

```
0%
15.38%
12.82%
41.03%
28.21% 
```

# cakephp - 如何为模型编写关联链接？

> ID：15483733
> 
> 赞同：0
> 
> 时间：2013-03-18T18:02:32.137
> 
> 标签：cakephp, cakephp-2.1, cakephp-model

假设我有一个“users”表，其中包含一个名为“user_type”的字段，为了简单说明，如果 user_type 为“C”，则该用户是诊所的所有者，如果 user_type 为“D”，则该用户是牙医。

我希望这个系统中的牙医属于他/她关联的诊所。

我的问题是...

1.  我需要诊所和牙医数据库表吗？？？

2.  如果我不需要那两张表，那么我需要多少个模型，只需要一个用户模型或诊所和牙医模型？？？

3.  如果我只需要一个用户模型，请提示我如何编写用户模型和相关链接（$belongsTo，$hasMany）？？？

PS Clinic 的所有者和牙医是该系统的用户。

请给我提意见。谢谢。

* * *

## 更多关于系统

该系统适用于作为系统付费客户的诊所所有者。该系统将允许他们宣传牙医和助理的工作机会。

牙医和助理在被诊所老板聘用后可以在系统中注册，诊所老板将成为他们的雇主并记录他们在系统中的工作方式。如果他们退出诊所，也会更新他/她的就业状况。

每个诊所保存的记录可以被其他诊所看到。

它实际上就像雇主和雇员模型，但是因为在线系统所以我想到了用户模型。

我是否应该像这样决定系统，任何用户只需先注册，所以他/她成为系统的用户，然后他们需要填写更多信息，无论他们是雇主（诊所所有者）还是雇员（牙医或助理） ，这些信息分别保存在诊所、牙医、助理等单独的表格中，最后还有 CakePHP 中的模型？？？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T08:34:14.373

我会试着回答这个问题。

### “诊所”的单独模型

如果您想在系统中存储有关诊所的信息（例如地址、名称等），那么您应该有一个用于存储该信息的数据库表和一个用于使用该信息的模型。

### “牙医”和“诊所老板”的单独模型

关于“牙医”和“诊所所有者”的单独数据库表您提到“牙医”和“诊所所有者”都是系统的用户（并且可能都应该能够登录）。此外，“诊所老板”很可能也是“牙医”。

因此，我认为您可以安全地使用“用户类型”来指示一个人是否（也是）诊所所有者。

### 数据库表的命名

关于数据库表的命名。

尽管牙医和诊所所有者都是系统的“用户”，但您可能会问自己，“用户”是否是描述两者的最佳名称。

如果*诊所所有者*也是*牙医*，我建议为您的表格命名`'dentists'`，因为它可以更好地描述“里面”的内容。为您的“用户”表使用不同的名称*不是问题。*只要您通过`userModel`选项在 Auth 组件中指定正确的模型，仍然可以使用该表登录。例如：

```
public $components = array(
    'Auth' => array(
        'authenticate' => array(
            'Form' => array(
                'userModel' => 'Dentist',
                // other settings for 'Form' authentication
            )
        )
    )
); 
```

请参阅文档的这一部分：[配置身份验证处理程序](http://book.cakephp.org/2.0/en/core-libraries/components/authentication.html#configuring-authentication-handlers)

## 数据库表和模型的示例

总结一下你的情况，你的数据库应该是这样的；

```
CREATE TABLE dentists
(
  id            int(4)      NOT NULL AUTO_INCREMENT,
  username      varchar(50) NOT NULL,
  password      char(128)   NOT NULL, -- SHA512 hash (128 characters)
  user_type     char(1)     NOT NULL DEFAULT 'D',
  name          varchar(75),
  address       varchar(75),
  email         varchar(75) NOT NULL,

  -- etc..

  -- primary key for CakePHP
  PRIMARY KEY (id),

  -- make sure usernames are unique
  UNIQUE KEY unique_username (username)
);

CREATE TABLE clinics
(
  id            int(4)      NOT NULL AUTO_INCREMENT,

  -- Note: NOT named according to 'CakePHP' conventions
  --       as 'owner_id' is probably clearer than 'dentist_id'
  owner_id      int(4)      NOT NULL,
  name          varchar(75),
  address       varchar(75),

  -- etc..

  PRIMARY KEY (id)
); 
```

**模型；**

```
class Dentist extends AppModel {
    public $hasOne = array(
        'Clinic' => array(
            'className'    => 'Clinic',

            /**
             * because we're not following CakePHP
             * conventions here.
             *
             * This should be 'dentist_id' according to CakePHP conventions
             * but 'owner_id' is probably clearer in this case
             */
            'foreignKey'   => 'owner_id',
            'dependent'    => true
        ),
    );
}

class Clinic extends AppModel {
    public $belongsTo = array(
        'Dentist' => array(
            'className'    => 'Dentist',
            'foreignKey'   => 'owner_id',

            /**
             * Optionally
             */
            'conditions'   => array('Dentist.user_type' => 'C'),
        ),
    );
} 
```

**note** 在我的设计中，诊所只能有一个*所有者*，但牙医可以拥有多个诊所。如果诊所可以有多个所有者，则应使用 HasAndBelongsToMany 关系

## “牙医”和“诊所老板”的更多分离

如果需要，您始终可以为“诊所所有者”（ ）设置*另一个模型*`ClinicOwners`，连接到与“牙医”相同的数据库表，默认条件为（`user_type = 'C'`）。如果您需要有关此的更多信息，我将添加一个示例

**更新** 一些附加提示，基于提供的附加信息。

决定是否`Dentists`，应该`Assistants`有`ClinicOwners`自己的数据库表应该基于他们的使用情况。如果除了它们之外，所有“基本上”都相同，`permissions`那么可以将它们存储在同一个数据库表中。

即使它们在同一个数据库表中，也可以（为了方便）创建使用相同数据库表的不同模型，例如：

```
class Assistants extends AppModel {

    public $useTable = 'dentists'; // or 'users' if you decide on that

    /**
     * This model automatically filters results
     * to show only records with user_type 'A' (assistant)
     *
     * {@inheritdoc}
     *
     * @param array $queryData
     *
     * @return mixed
     */
    public function beforeFind(array $queryData)
    {
        if (!empty($queryData['conditions'])) {
            $queryData['conditions'] = array(
                'AND' => array(
                    $this->alias . '.user_type' => 'A',
                    $queryData['conditions'],
                )
            );
        } else {
            $queryData['conditions'] = array(
                $this->alias . '.user_type' => 'A'
            );
        }

        return $queryData;
    }
} 
```

## 权限

因为权限将基于 user_type，所以值得考虑将“user_type”重命名为“role”（或类似名称）。您可能需要 ACL（访问控制列表）来定义每个“用户类型”的确切权限，即用户*“角色”*。您可能还想为此创建一个“角色”数据库表（和一个`Role`模型）

用几行代码完全解释 ACL 相当困难，所以我建议阅读有关此主题的文档；

[访问控制列表](http://book.cakephp.org/2.0/en/core-libraries/components/access-control-lists.html)

和例子：

[简单 Acl 控制的应用程序](http://book.cakephp.org/2.0/en/tutorials-and-examples/simple-acl-controlled-application/simple-acl-controlled-application.html)

[简单 Acl 控制的应用程序 - 第 2 部分](http://book.cakephp.org/2.0/en/tutorials-and-examples/simple-acl-controlled-application/part-two.html)

# c# - Scintilla Control 将书签保存到文件

> ID：15483734
> 
> 赞同：1
> 
> 时间：2013-03-18T18:02:34.240
> 
> 标签：c#, windows, forms, scintilla

我正在尝试在 scintilla 中保存正在编辑的文件的指示器（书签），以便下次打开文件时重新加载它们。

这是我的代码片段：

```
List<int> bookmarks = new List<int>();
for (int i = 0; i < scintilla1.Lines.Count; i++)
{
    if (!bookmarks.Contains(scintilla1.Markers.FindNextMarker(i).Number))
        bookmarks.Add(scintilla1.Markers.FindNextMarker(i).Number);
}

for (int j=0;j<bookmarks.Count;j++)
    MessageBox.Show(bookmarks[j].ToString()); 
```

但是，索引似乎超出了其范围，有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T18:13:32.210

你可以试试这个：

```
HashMap<int> bookmarks = new HashMap<int>();
for (int i = 0; i < scintilla1.Lines.Count; i++)
{
    bookmarks.Add(scintilla1.Markers.FindNextMarker(i).Number);
}

foreach (var bookmark in bookmarks)
{
    MessageBox.Show(bookmark.ToString());
} 
```

此外，应该注意的是，这`FindNextMarker`将返回具有标记的下一行（请参阅[此处](https://scintillanet.svn.codeplex.com/svn/Trunk/ScintillaNET/MarkerCollection.cs)的实现）。所以我认为你的方法是错误的。它可能应该更像这样：

```
HashMap<int> bookmarks = new HashMap<int>();
int nextBookmark = 0;

while (nextBookmark != UInt32.MaxValue)
{
    nextBookmark = scintilla1.Markers.FindNextMarker(nextBookmark).Line;
    if (nextBookmark != UInt32.MaxValue)
    {
        bookmarks.Add(nextBookmark);
    }
}

foreach (var bookmark in bookmarks)
{
    MessageBox.Show(bookmark.ToString());
} 
```

更好的是，您可以使用以下方法获取所有标记`public List<Marker> GetMarkers(int line)`：

```
foreach (var bookmark in scintilla1.Markers.GetMarkers(0))
{
    MessageBox.Show(bookmark.Line.ToString());
} 
```

**需要注意**的是，每个文件似乎最多有 32 个标记。请参阅[Scintilla 网站上的标记文档](http://www.scintilla.org/ScintillaDoc.html#Markers)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T19:21:25.257

我用下面的代码解决了这个问题，但是，我想将书签内容添加到文件的末尾，这样当我打开一个新文件时，我就可以知道在哪里加载书签。如何编辑 scintilla1.Lines[scintilla1.Lines.Count]？

```
List<int> bookmarks = new List<int>();

while(true)
{
    try
    {
        Line next = scintilla1.Markers.FindNextMarker();
        scintilla1.Caret.Position = next.StartPosition;
        scintilla1.Caret.Goto(next.EndPosition);
        scintilla1.Scrolling.ScrollToCaret();
        scintilla1.Focus();
        bookmarks.Add(next.Number);
    }
    catch(Exception ex)
    {
        break;
    }
}

string Marks="";
for(int i =0;i<bookmarks.Count;i++)
    Marks += bookmarks[i]+ ","; 
```

# node.js - “致命错误：无法找到本地咕噜声。” 运行“咕噜”命令时

> ID：15483735
> 
> 赞同：73
> 
> 时间：2013-03-18T18:02:35.373
> 
> 标签：node.js, gruntjs

我使用以下命令卸载了 grunt。

```
npm uninstall -g grunt 
```

然后我再次使用以下命令安装了 grunt。

```
npm install -g grunt-cli 
```

访问以下链接： [https ://npmjs.org/package/grunt-html](https://npmjs.org/package/grunt-html)

我想使用上面的 grunt 插件

但是当我运行 grunt 命令时，它给了我以下错误：

```
D:\nodeJS\node_modules\grunt-html>grunt
grunt-cli: The grunt command line interface. (v0.1.6)

Fatal error: Unable to find local grunt.

If you're seeing this message, either a Gruntfile wasn't found or grunt
hasn't been installed locally to your project. For more information about
installing and configuring grunt, please see the Getting Started guide:
http://gruntjs.com/getting-started 
```

* * *

## 回答 #1

> 赞同：177
> 
> 时间：2013-03-19T18:42:46.930

[一切都在gruntjs.com](http://gruntjs.com/getting-started)上得到了很好的解释。

> 请注意，安装 grunt-cli 不会安装 grunt 任务运行器！grunt CLI 的工作很简单：运行已安装在 Gruntfile 旁边的 grunt 版本。这允许在同一台机器上同时安装多个版本的 grunt。

因此，在您的项目文件夹中，您需要安装（最好）**最新的 grunt 版本**：

```
npm install grunt --save-dev 
```

选项`--save-dev`将`grunt`作为**开发依赖**项添加到您的**package.json**中。这使得重新安装依赖项变得容易。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-11-29T02:22:52.547

您必须在项目文件夹中安装 grunt

1.  创建你的 package.json

    ```
    $ npm init 
    ```

2.  为此项目安装 grunt，它将安装在`node_modules/`. --save-dev 将把这个模块添加到你的 package.json 中的 devDependency

    ```
    $ npm install grunt --save-dev 
    ```

3.  然后创建 gruntfile.js 并运行

    ```
    $ grunt 
    ```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-09-26T17:24:06.013

我的 Windows grunt 遇到了这个问题，因为我在 64 位 Windows 操作系统上安装了 32 位版本的 Node。当我专门安装了 64 位版本时，它就开始工作了。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-03-18T18:07:10.520

我认为您必须将 grunt 添加到您的`package.json`文件中。请参阅[此链接](https://github.com/gruntjs/grunt/wiki/Getting-started#packagejson)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-04-04T08:37:42.590

I had the same issue today on windows 32 bit,with node 0.10.25, and grunt 0.4.5.

I followed [dongho's answer](https://stackoverflow.com/a/20277420/3556874), with just few extra steps. here are the steps I used to solve the error:

1) create your package.json

```
$ npm init 
```

2) install grunt for this project, this will be installed under node_modules/. --save-dev will add this module to devDependency in your package.json

```
$ npm install grunt --save-dev 
```

3) then create `gruntfile.js` , with a sample code like this:

```
module.exports = function(grunt) {

  grunt.initConfig({
    jshint: {
      files: ['Gruntfile.js', 'src/**/*.js', 'test/**/*.js'],
      options: {
        globals: {
          jQuery: true
        }
      }
    },
    watch: {
      files: ['<%= jshint.files %>'],
      tasks: ['jshint']
    }
  });

  grunt.loadNpmTasks('grunt-contrib-jshint');
  grunt.loadNpmTasks('grunt-contrib-watch');

  grunt.registerTask('default', ['jshint']);

}; 
```

here, `src/**/*.js` and `test/**/*.js` should be the paths to actual JS files you are using in your project

4) run `npm install grunt-contrib-jshint --save-dev`

5) run `npm install grunt-contrib-watch --save-dev`

6) run `$ grunt`

**Note:** when you require common package like concat, uglify etc, you need to add those modules via `npm install`, just the way we installed jshint and watch in step 4 & 5

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-09-17T15:25:35.107

这为我解决了这个问题。我错误地使用以下命令安装了 grunt：

```
sudo npm install -g grunt --save-dev 
```

然后在项目文件夹中运行以下命令：

```
npm install 
```

这导致了问题作者看到的错误。然后我使用以下命令卸载了 grunt：

```
sudo npm uninstall -g grunt 
```

删除了 node_modules 文件夹。并使用以下命令重新安装 grunt：

```
npm install grunt --save-dev 
```

并在项目文件夹中运行以下命令：

```
npm install 
```

由于某些奇怪的原因，当您使用 -g 全局安装 grunt 然后卸载它时，node_modules 文件夹保留了阻止 grunt 本地安装到项目文件夹的内容。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-11-10T08:36:47.237

如果你是一个存在的项目，也许应该执行 npm install。

[guntjs 入门](http://gruntjs.com/getting-started#working-with-an-existing-grunt-project)第 2 步。

# java - Diffie-Hellman 私钥

> ID：15483736
> 
> 赞同：4
> 
> 时间：2013-03-18T18:02:39.707
> 
> 标签：java, diffie-hellman

我有下面的代码行来生成一个私钥：

```
int Xa = randomNo.nextInt(10000);
int Ya = (int) Math.pow(G, Xa) % P; 
```

`G`并且`P`是静态数字。而`Xa`随机生成。每次我运行程序时，它都会给我相同的结果`Ya`。这对 Diffie-Hellman 是否正确？我认为每次运行算法时都必须更改私钥。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-18T18:08:29.273

问题是`Random`Java 中的类有一个带有一个`long`参数（称为*种子*）的构造函数，它允许您以特定方式启动伪随机数序列。

如果始终使用相同的种子，您将始终获得相同的序列。

要解决此问题，请尝试以下操作：

```
Random randomNo = new Random(System.nanoTime());
int Xa = randomNo.nextInt(10000); 
```

这样一来，种子总是不同的，每次调用上述行时，顺序都会发生变化。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-18T18:24:14.950

其他人似乎对您生成随机数的问题给出了很好的答案，所以我将回答您的问题“这对 Diffie-Hellman 是否正确？”

我认为您对 Diffie-Helman 的理解有点偏离。一方面，您继续使用术语“私钥”，就好像还有一个“公钥”一样。Diffie-Hellman 密钥交换是一种用于交换一个对称密钥的技术。没有私钥和公钥，只有双方将使用的密钥来加密他们的消息。此外，您说这是“生成”密钥的代码。使用 Diffie-Hellman，探戈需要两个人。此代码不足以生成密钥的最终产品。您需要发送`Ya`给第二方并从第二方取回一些东西以完成该过程。有关更多信息，请参见下文。

您的生成公式`Ya`是正确的，假设`Xa`这是应该的。我有点担心你对你应该做什么的理解，`Xa`因为你在生成`Ya`. 您需要坚持`Xa`以创建密钥的最终版本。

生成后`Ya`，您应该将其发送给另一方。作为回报，对方会给你发回一些号码（我们称之为`R`）。为了让您创建对称密钥的最终版本（我们称之为`SK`），您需要将其计算为

```
SK = (int)Math.pow(R, Xa) % P; 
```

`Xa`所以简而言之，计算完后不要重新计算`Ya`，否则将无法生成密钥。过程如下：

1.  生成`Ya`（我只是使用这个变量名，因为它是你使用的）。
2.  送给`Ya`某个人。
3.  从您发送给的人那里收到一些号码`Ya`（在上面的示例中称为此号码`R`）。
4.  `R`使用、`Xa`和计算您将用于加密的对称密钥应该是什么`P`。（见上面的公式`SK`）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-18T18:14:15.497

我认为问题可能是你的指数溢出双倍，导致无穷大，每次都产生相同的值（除非你足够幸运最终为你的指数返回一个非常低的数字）。

另外，请务必使用安全随机来获取您的随机值：

```
Random random = new SecureRandom();

// If you use more than 100 here, then
// with your value of 486 for G you will
// end up with infinity when doing Math.pow(G,Xa).
// Of course, this does not provide enough possible
// values to be cryptographically secure.
int Xa = random.nextInt(100);
int Ya = (int) (Math.pow(G, Xa) % P); 
```

编辑：带调试的代码（以下对我有用）：

```
double G = 42;
int P = 26;

Random random = new SecureRandom();
int Xa = random.nextInt(100);
double val = Math.pow(G, Xa);
System.out.println("Xa: " + Xa);
System.out.println("(double) Math.pow: " + val + " (int): " + (int) val);
int Ya = (int) (val % P);
System.out.println("Ya: " + Ya); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-18T18:11:23.210

如果不同，这只能给出不同的结果`Xa`。你是如何产生的价值的`Xa`？您可能使用了通常需要播种的伪随机生成器。如果您每次都采用默认种子（每次相同的种子），它将始终返回相同的随机数序列。

尝试播种你的发电机`System.currentTimeMillis();`

# ios - 如何制作我自己的 UIPickerView？

> ID：15483738
> 
> 赞同：1
> 
> 时间：2013-03-18T18:02:49.550
> 
> 标签：ios, objective-c, uitableview, uipickerview

由于 UIPickerView 无法自定义到我想要的级别（不冒隐藏特定子视图的风险），我需要自己选择一个时间。

我想我可以使用两个 UITableViews 来做到这一点，但我不确定如何做两件事：

1）如何确定哪个单元格位于视图中间（即用户选择了哪个单元格）？

2）一旦用户停止滚动，如何使表格捕捉到最靠近视图中间的单元格？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T18:11:11.020

为什么说 UIPickerView 不能自定义？它有一堆委托方法，允许进行大量自定义，例如行的视图、行的高度等。

[http://developer.apple.com/library/ios/#documentation/uikit/reference/UIPickerViewDelegate_Protocol/Reference/UIPickerViewDelegate.html](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIPickerViewDelegate_Protocol/Reference/UIPickerViewDelegate.html)

在您的 ViewController 中实现委托并根据需要对其进行自定义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T18:10:29.773

根据您想要的自定义类型，您可能不需要制作自己的 UIPickerView。您可以使用 UIPickerViewDelegate 为每个组件返回您自己的视图。检查[pickerView：viewForRow：forComponent：reusingView：](http://developer.apple.com/library/ios/documentation/UIKit/Reference/UIPickerViewDelegate_Protocol/Reference/UIPickerViewDelegate.html#//apple_ref/occ/intfm/UIPickerViewDelegate/pickerView%3aviewForRow%3aforComponent%3areusingView%3a)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-19T03:20:19.537

免费的 Sensible TableView 框架有一个基于 UITableView 的日期选择器，您可以开箱即用。应该可以为您节省大量时间，因为它可以处理所有滚动和表格视图大小调整。希望这可以帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-18T18:07:38.627

你只是想选择一个时间？然后使用 UIDatePicker。这是时间/日期的选择器视图。

# nlp - Arduino的自然语言解析，从哪里开始

> ID：15483745
> 
> 赞同：2
> 
> 时间：2013-03-18T18:03:35.970
> 
> 标签：nlp, arduino

对于一个学校项目，我正在研究自然语言编程并思考如何将这个概念应用于 Arduino。

想想一个可以将句子翻译成 Arduino 代码的`If the analog sensor on pin 9 reads more than 2 Volts, set the duty cycle of the the servo on pin 10 to 70%.`软件`If the digital sensor on pin 4 reads high, light the onboard LED for 5 seconds.`。我怀疑与更通用的应用程序相比，为基本的 Arduino 用例执行此操作应该很简单。

Arduino存在这样的事情吗？它是否适用于任何其他流行的高级语言，例如 Python 或 MATLAB？任何人都可以为绝对初学者推荐有关自然语言处理主题的资源（更具体地说，是一个了解 Python、C#、MATLAB 以及显然是 Arduino 的非 CS、非 CS 背景研究生）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T02:02:47.033

您可以签[出 nltk](http://nltk.org/)，它是 Python 的一个库。

使用上述库将句子翻译成命令，然后使用命令生成 Arduino 代码。

另一种方法是使用firmdata，它允许您通过串行端口向Arduino发送命令。

# ruby-on-rails - 我们是否需要为我们在 ruby on rails 中执行的每个 ajax 请求编写单独的 .js.erb 文件？

> ID：15483746
> 
> 赞同：2
> 
> 时间：2013-03-18T18:03:38.290
> 
> 标签：ruby-on-rails, ajax

我是 ruby​​ on rails 的新手，我想学习在其中使用 ajax。我已经完成了一些教程。我的问题是，如果我们有许多表单、使用 ajax 请求的按钮，我们应该为每个请求编写 .js.erb 文件，还是我们可以有一个文件为不同的请求呈现不同的响应？我们可以从控制器本身获得这些响应吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T18:10:23.440

你不必提供 js.erb 文件，但如果你想对页面做一些动态的事情，你将不得不渲染一些东西。

显然，如果您所做的只是将某些东西放入闪存中并返回它，则不需要视图。

# c# - 一次获取2个字符的子字符串

> ID：15483747
> 
> 赞同：-1
> 
> 时间：2013-03-18T18:03:39.430
> 
> 标签：c#, asp.net, .net

我有一个看起来像这样的字符串：

```
0122031203 
```

我希望能够解析它并将以下内容添加到列表中：

```
01
22
03
12
03 
```

所以，我需要获取每 2 个字符并提取它们。

我试过这个：

```
 List<string> mList = new List<string>();
 for (int i = 0; i < _CAUSE.Length; i=i+2) {
     mList.Add(_CAUSE.Substring(i, _CAUSE.Length));
 }
 return mList; 
```

但是这里有些不对劲，我不断收到以下信息：

> 索引和长度必须引用字符串中的位置。参数名称：长度

我弄错了吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T18:11:29.180

使用 Linq 怎么样？

```
string s = "0122031203";
int i = 0;
var mList = s.GroupBy(_ => i++ / 2).Select(g => String.Join("", g)).ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T18:07:40.663

我相信您可能在 Substring 函数中错误地指定了长度。

尝试以下操作：

```
List<string> mList = new List<string>();

for (int i = 0; i < _CAUSE.Length; i = i + 2)
{
    mList.Add(_CAUSE.Substring(i, 2));
}

return mList; 
```

如果您希望将其拆分为每个 2 个字符的块，则长度应为 2。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-18T18:08:04.020

当您执行子字符串时，请尝试 _CAUSE.SubString(i, 2)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-18T18:24:13.353

2points: 1) as previously mentioned, it should be substring(i,2); 2) U should consider the case when the length of ur string is odd. For example 01234: do u want it 01 23 and u'll discard the 4 or do u want it to be 01 23 4 ??

# jsf - ManagedBean 继承和通用名称

> ID：15483749
> 
> 赞同：1
> 
> 时间：2013-03-18T18:03:40.223
> 
> 标签：jsf, inheritance, session-scope

在我们的一个应用程序中，我们有两类用户，

1.  内部用户 ( `class InternalUser extends User`)
2.  外部用户 ( `class ExternalUser extends User`)

我们将它们用作会话范围的托管 bean（基本上是为了注入登录用户的详细信息，在`class User`上述 2 个类中的每个类中都有一些常见的细节和一些特定的细节）。

我可以为两个托管 bean 使用相同的名称（此处为“ `loggedInUser`”）吗？

Faces 抛出异常“*名为‘loggedInUser’的托管 bean 已注册。替换现有托管 bean 类...* ”

我们如何管理这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T18:44:15.447

一种方法是不让它成为 JSF 托管 bean。使与登录表单关联的 bean 成为请求/视图范围的 bean，并将`User`实例放入您自己的会话范围中。

例如

```
User user = service.find(username, password);

if (user != null) {
    externalContext.getSessionMap().put("user", user);
} 
```

它将像`#{user}`在 EL 范围内一样可用（因此也可以通过`@ManagedProperty`该表达式的其他 bean 中注入）。在该`find()`方法中，您可以只返回一个`InternalUser`或`ExternalUser`相应地返回。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T18:11:16.907

`CurrentUser`也许一个以成员命名的托管bean `Internal/ExternalUser`？在我自己的应用程序中，我不确定是否会`User`按照您尝试的方式将子类作为业务对象和托管 bean 来注入这些所需的数据。

# haskell - 如何清除ghci的函数结果缓存？

> ID：15483752
> 
> 赞同：17
> 
> 时间：2013-03-18T18:03:48.583
> 
> 标签：haskell, ghci

GHCI 似乎在交互式会话期间缓存函数的结果。很容易注意到，只需调用两次耗时的函数。第二次，结果将立即出现。

有没有办法从 GHCI 中清除这个缓存，所以我不必重新启动它？我正在做一些快速'n'dirty非详细的性能比较，所以使用 System.CPUTime 来代替会是矫枉过正。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-18T20:39:14.767

您始终可以通过命令重新加载您正在使用的模块`:r`。这将丢弃您所做的任何交互式绑定，如果您只是四处寻找，这可能并不总是实用的。如果您实际上没有使用模块，这也适用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-18T19:15:38.190

正如评论所指出的，您用于将*名称*`let`绑定到一个*值*，该值是*应用*函数的结果。如果您想保留该值，请不要在 let 中命名它！（或者只是不要引用您已经在 let 中计算的值）。

 **** * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-20T22:33:28.220

GHCi 有一个`+r`选项，[根据手册](http://www.haskell.org/ghc/docs/latest/html/users_guide/ghci-set.html#id489786)，它应该做你想做的事：

> 通常，加载模块中顶级表达式（也称为 CAF 或常量应用形式）的任何求值都会在求值之间保留。打开`+r`会导致在每次评估后丢弃对顶级表达式的所有评估（在单次评估期间仍会保留它们）。
> 
> 如果评估的顶级表达式占用大量空间，或者您需要可重复的性能测量，此选项可能会有所帮助。

请注意，它讨论的是[常量应用形式](http://www.haskell.org/haskellwiki/Constant_applicative_form)，而不是函数。但是，我无法让它适用于您的示例：

```
Prelude> :set +r
Prelude> :set +s
Prelude> let f = 1 : map (2*) f
(0.01 secs, 1222216 bytes)
Prelude> last $ show $ f !! 100000
'6'
(3.54 secs, 641914476 bytes)
Prelude> last $ show $ f !! 100000
'6'
(0.04 secs, 1634552 bytes)
Prelude> last $ show $ f !! 100000
'6'
(0.04 secs, 1603568 bytes) 
```

显然，[`+r`仅适用于已编译代码](https://ghc.haskell.org/trac/ghc/ticket/1400)，尽管文档没有提及这一点。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-21T01:23:28.553

总结一下，

```
>>> :set +s  -- activate performance 
>>> :r       -- reset all interactive binding
Ok, modules loaded: none.
>>> :show bindings -- check the binding state 
```

让我们开始测试，

```
>>> let f = 1 : map (2*) f
(0.01 secs, 1543272 bytes)
>>> :show bindings 
f :: [Integer] = _
>>> last $ show $ f !! 50000
'6'
(0.55 secs, 170011128 bytes)
>>> :show bindings 
f :: [Integer] = 1 : 2 : 4 : 8 : 16 : ....
it :: Char = '6'
>>> last $ show $ f !! 50000
'6'
(0.02 secs, 1562456 bytes) 
```

使用未定义，

```
>>> let f = undefined 
(0.01 secs, 565912 bytes)
>>> :show bindings 
it :: Char = '6'
f :: a = _
>>> let f = 1 : map (2*) f
(0.01 secs, 513304 bytes)
>>> last $ show $ f !! 50000
'6'
(0.94 secs, 170517840 bytes)
>>> :show bindings 
f :: [Integer] = 1 : 2 : 4 : 8 : 16 : ....
it :: Char = '6' 
```

重置绑定，

```
>>> :r
>>> :show bindings 
Ok, modules loaded: none. 
```

* * *

另一个研究案例，

```
>>> let h = (2*)
(0.01 secs, 590232 bytes)
>>> let f = 1 : map h f
(0.01 secs, 1138792 bytes)
>>> :show bindings 
it :: Char = '6'
h :: Integer -> Integer = _
f :: [Integer] = _
>>> last $ show $ f !! 60000
'6'
(1.69 secs, 241802432 bytes)
>>> last $ show $ f !! 60000
'6'
(0.03 secs, 2002432 bytes) 
```

还是缓存了，改一下h的绑定看看，

```
>>> let h = (3*)
(0.01 secs, 547208 bytes)
>>> last $ show $ f !! 60000
'6'
(0.03 secs, 2029592 bytes)
>>> :show bindings 
f :: [Integer] = 1 : 2 : 4 : 8 : 16 : ....
h :: Integer -> Integer = _
it :: Char = '6' 
```

不管了，也需要重新定义f，

```
>>> let f = 1 : map h f
(0.01 secs, 552048 bytes)
>>> last $ show $ f !! 60000
'1'
(4.36 secs, 374064760 bytes) 
```

* * *

使用 Let .. in ... 绑定，

```
>>> let f = let h = (2*) in 1 : map h f
(0.02 secs, 1068272 bytes)
>>> last $ show $ f !! 60000
'6'
(3.90 secs, 242190168 bytes)
>>> last $ show $ f !! 60000
'6'
(4.89 secs, 242271560 bytes)
>>> last $ show $ f !! 60000
'6'
(5.71 secs, 242196976 bytes)
>>> :show bindings 
h :: Integer -> Integer = _
f :: Num a => [a] = _
it :: Char = '6' 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-10-29T00:24:55.970

2019 年的答案：不可能……***

# asp.net - 客户端还是服务器端？

> ID：15483756
> 
> 赞同：1
> 
> 时间：2013-03-18T18:04:02.407
> 
> 标签：asp.net, visual-studio-2010

我是 Web 开发的新手，正在制作一个基本上显示文档列表框的应用程序。当用户单击文档时，该文档 (pdf) 将显示在 iFrame 中。所有文档都位于服务器和客户端可用的网络共享上。这只会在内部（内部网）使用。

我的问题是：

我应该在服务器还是客户端更改 iFrame 源？甚至可以在客户端做吗？

我正在尝试在服务器上执行此操作。我将列表框设置为自动回发，但我无法读取 selectedindex，因为页面加载首先发生（并重新加载列表框）并清除所选项目。如果我关闭 lsitbox 的自动回发，则 SelectedIndexchange 事件永远不会触发。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T18:08:06.833

> 我应该在服务器还是客户端更改 iFrame 源？甚至可以在客户端做吗？

在服务器端和客户端都可以做到这一点。在客户端是这样完成的：

```
document.getElementById('frameID').src = "new_src.html";//or whatever 
```

在服务器端，您可能做得正确，但您忘记添加`if(!IsPostBack)`，`Page_Load`以便列表框中的数据不会在每次回发时反弹。

就像是：

```
protected void Page_Load(object sender, EventArgs e)
{
    if(!IsPostBack)
    {
       //populate list box
    }
} 
```

# phpmyadmin - 在远程连接的本地计算机上使用 phpMyAdmin 上传 mySQL 数据库时遇到问题

> ID：15483757
> 
> 赞同：0
> 
> 时间：2013-03-18T18:04:03.917
> 
> 标签：phpmyadmin

我可以毫无问题地远程连接到我的服务器上的 .sql 数据库，我可以很好地查询和截断表。但是，我不能上传（通过导入）数据库文件。

我在 php.ini 文件中设置了以下内容：

```
upload_max_filesize = 40M
post_max_size = 40M 
```

我还将 php.ini 文件上传到我的服务器

但是，当我在本地主机上登录 phpMyAdmin 并连接到服务器数据库时，在导入选项卡上时，它说文件大小限制为 8,192KiB

我不知道问题可能是什么。我尝试上传的最大数据库大小不到 30M。我也尝试使用`.htaccess`没有成功的文件。

对我来说，本地人似乎`phpMyAdmin`没有查看正确的`php.ini`文件。有没有办法查看在`phpMyAdmin`本地机器上查找 php.ini 文件的位置。我试过运行`phpinfo()`，但由于某种原因，它不想在那台计算机上打开。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T18:15:19.647

> 我可以毫无问题地远程连接到我的服务器上的 .sql 数据库*

如果您可以毫无问题地远程连接，则不要使用 phpmyadmin 进行恢复。使用另一个不使用 php 的远程工具。

试着去`my.cnf in /etc/mysql`它说的地方

`bind-address = 127.0.0.1`

将其更改为您的服务器的 IP 地址。重新启动 mySQL。这样，您应该能够使用诸如 mySQL Workbench（在他们的网站上）之类的东西进行远程连接，并上传 .sql

我建议之后将其更改回来以避免其他问题。

还要确保您创建的用户可以从任何地方`%`（（尽管如果您创建一个具有 % 访问权限的 root 用户，有时您将无法再使用 phpMyAdmin。）

将文件加载到您的服务器`FTP/SSH`并使用.`SSH``mysql commands`

# c# - 序列化 ViewModel、ObservableCollection

> ID：15483758
> 
> 赞同：1
> 
> 时间：2013-03-18T18:04:09.240
> 
> 标签：c#, windows-phone-7, mvvm, windows-phone-8

我有带有 2 个 ObservableColection 的 ViewModel，当我的应用程序关闭时，我序列化了我的 ViewModel。

我的代码：

```
private void Application_Closing(object sender, ClosingEventArgs e)
    {
        using (var store = IsolatedStorageFile.GetUserStoreForApplication())
        {
            using (var stream = new IsolatedStorageFileStream("data.txt", FileMode.Create, FileAccess.Write, store))
            {
                var serializer = new XmlSerializer(typeof(AppViewModel.NewsViewModel));
                serializer.Serialize(stream, ViewModel);
            }
        }
    } 
```

AppViewModel.NewsViewModel 包含

```
 public ObservableCollection<NewsItemViewModel> EpsItems
            {
                get { return _epsItems; }
            }

            public ObservableCollection<NewsItemViewModel> OthItems
            {
                get { return _othItems; }
            } 
```

以及填充集合的方法。

NewsItemViewModel：

```
public class NewsItemViewModel
        {
            public NewsItemViewModel()
            {
            }

            public int Id { get; set; }
            public DateTime Date { get; set; }
            public string Title { get; set; }
            public string Text { get; set; }
            public string FullText { get; set; }
            public string ImageUrl { get; set; }
            public string NewsUrl { get; set; }
        } 
```

一切正常，但我不明白如何采取，例如，每个集合有六条记录，然后序列化 ViewModel ......我该怎么做？例如，如果 EpsItems 和 OthItems 包含 20 个条目。

提前致谢。对不起我的英语不好^^

**UPD：**这是一个示例，我将描述我想要的内容，但不知道如何...例如：当用户关闭序列化的应用程序视图模型时，用户下载了 30 个 EpsItems 条目和 25 个 OthItems 条目。我分别保存了 30 个和 25 个条目。我想在集合中保存比用户下载更少的条目......例如，每个集合的 10 条记录。问题：如何进行此实现？请帮助实现和代码...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T07:52:26.743

看起来很容易实现：

1.  `ClearUnnecessaryData`在您的`ViewModel`类中创建一个名为 eg 的方法并在那里进行清理。

2.  在序列化之前调用该方法。

方法应该如下所示：

```
for(int i = MAX_SERIALIZATION_ITEMS; i < EpsItems.Count; )
{
    EpsItems.RemoveAt(MAX_SERIALIZATION_ITEMS);
}

for(int i = MAX_SERIALIZATION_ITEMS; i < OthItems.Count; )
{
    OthItems.RemoveAt(MAX_SERIALIZATION_ITEMS);
} 
```

你的`ApplicationClosing`事件处理程序应该是：

```
private void Application_Closing(object sender, ClosingEventArgs e)
{
    ViewModel.ClearUnnecessaryData();

    using (var store = IsolatedStorageFile.GetUserStoreForApplication())
    {
        using (var stream = new IsolatedStorageFileStream("data.txt", FileMode.Create, FileAccess.Write, store))
        {
            var serializer = new XmlSerializer(typeof(AppViewModel.NewsViewModel));
            serializer.Serialize(stream, ViewModel);
        }
    }
} 
```

# jquery - Zebra tablesorter 不会在初始排序时进行条带化

> ID：15483762
> 
> 赞同：2
> 
> 时间：2013-03-18T18:04:14.853
> 
> 标签：jquery, row, background-color, tablesorter, zebra-striping

我对 tablesorter 插件和 zebra 小部件有疑问，它们为偶数/奇数行启用了不同的样式。

我的页面从一个空表开始；然后，用户编译一个表单，然后我的表被加载......所以问题是：在初始加载（也对列进行排序）时，斑马条纹不起作用；我的行具有所有相同的背景颜色.. 但是当用户开始对列进行排序或转到其他页面结果（在同一张表上使用“寻呼机”插件）时，斑马小部件可以工作。

怎么了？

jQuery版本：1.9.0

表格排序器版本：2.7.12

这是我的javascript代码：

```
$("table").tablesorter({
    widthFixed: true,
    sortList: [[3,0]],
    widgets: ["zebra"],
    widgetOptions:{
        zebra: ["even","odd"]
    }
}); 
```

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T18:29:01.703

您可以使用仅 css 的解决方案并使用 jQuery 为 ie8 及更低版本进行备份

看看这里的小提琴：http: [//jsfiddle.net/GZPqE/](http://jsfiddle.net/GZPqE/)

```
<table class="zebra">
    <tr>
        <td>col 1</td>
        <td>col 2</td>
        <td>col 3</td>
        <td>col 4</td>
    </tr>
    <tr>
        <td>col 1</td>
        <td>col 2</td>
        <td>col 3</td>
        <td>col 4</td>
    </tr>
    <tr>
        <td>col 1</td>
        <td>col 2</td>
        <td>col 3</td>
        <td>col 4</td>
    </tr>
    <tr>
        <td>col 1</td>
        <td>col 2</td>
        <td>col 3</td>
        <td>col 4</td>
    </tr>
    <tr>
        <td>col 1</td>
        <td>col 2</td>
        <td>col 3</td>
        <td>col 4</td>
    </tr>
</table>

/*CSS*/
.zebra tr:nth-child(even) {
  background-color: #333;
  color: #fff;
}

/*
 * uncomment this to see the jQuery solution
 $("tr:nth-child(even)").css({"background-color":"blue", "color":"#fff"});
 */ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T18:12:44.687

使用 CSS 为偶数行和奇数行着色：

```
$("table")
  .tablesorter({
    widthFixed: true,
    sortList: [[3,0]],
    widgets: ["zebra"],
    widgetOptions:{
      zebra: ["even","odd"]
    }
  })
  .find('tr:nth-child(even)')
    .css('background-color', 'white')
    .end()
  .find('tr:nth-child(odd)')
    .css('background-color', 'lightgray')
    .end(); 
```

# android - 按下中性按钮时避免关闭我的对话框

> ID：15483770
> 
> 赞同：0
> 
> 时间：2013-03-18T18:04:38.657
> 
> 标签：android, dialog, dismiss

在`onCreateDialog()`我的自定义对话框的方法中，我使用构建器设置了肯定、取消和中性按钮侦听器。

我想使用中性按钮来重置对话框界面控件，并且不希望它在用户按下它时关闭对话框。

我怎样才能做到这一点？

附言。我的自定义对话框基于 Android 开发人员指南的 FireMissilesDialogFragment 示例。我设置中性按钮的方式与设置确定和取消按钮的方式相同。但我不知道如何在按下中性按钮时防止对话框关闭。

# xcode - 使用 Instruments 中的 TimeProfiler 针对 Xcode 4.6 中的 ios5.1 设备

> ID：15483773
> 
> 赞同：0
> 
> 时间：2013-03-18T18:04:47.953
> 
> 标签：xcode, instruments

我刚刚升级到 Mountain Lion 和 Xcode 4.6，但我的手机一直使用 iOS 5.1，以确保我可以测试我的应用程序是否向后兼容。我想使用 Instruments 的 TIme Profiler 对它们进行分析，但在附加到设备上运行的应用程序时我没有得到任何详细信息。使用模拟器的想法执行相同的程序可以正常工作。我选择我的设备作为目标，“Build for Profiling”然后“Profile”，选择“Time Profiler”，应用程序在设备上启动，但我没有得到任何数据，只有几个小黑旗显示低内存警告。如果我针对模拟器做同样的事情，我会在“调用树”面板中获得大量数据。不能在设备上对应用程序进行时间配置文件吗？我想我以前有过。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T20:42:44.403

可以在设备上对应用程序进行时间分析，但您可能发现了 Xcode 4.6 /iOS5.1 / 设备的问题

```
 instument:          Leaks           Time profiler

  device:
  iPad mini/iOS6.1     YES              YES
  iPhone4S/iOS5.1      YES              IT DEPENDS...
  iPhone3GS/iOS6.1     YES              YES
  simulator/iOS5.1     YES              YES 
```

“这取决于...”

...关于您是否希望您的个人资料数据实时：数据似乎已被记录，但在分析器运行时您不会看到它。当您停止时，将出现调用树和样本列表。有时您必须这样做两次才能获得完整的样本列表（第一次只获得一个样本）

这似乎不是你想要依赖的东西......

*更新*

在 OSX 10.7/XCode4.4 和 OSX 10.6.8/XCode4.2 下表现出相同的行为，因此似乎没有任何改变。事实上，在设备上*实时*使用 Time Profiler 似乎是 iOS6+ 的一项新功能

# c# - 从 WebService 填充 AutoComplete

> ID：15483775
> 
> 赞同：0
> 
> 时间：2013-03-18T18:04:59.313
> 
> 标签：c#, javascript, asp.net, json, web-services

我已经设法使用 Web 服务在 C#.net 中获得 JQuery 自动完成功能。

这是asp代码：

```
 <div class="row">
    <div class="span4">
        <h3>
            Manage Season</h3>
    </div>
</div>
<div class="row">
    <div class="span2">
        <p>
            <label class="control-label" for="TeamName">
                Team Name:</label></p>
    </div>
    <div class="span3">
        <asp:TextBox ID="TeamNameTextBox" runat="server" CssClass="searchinput"></asp:TextBox>
        <asp:Button ID="AddTeamButton" CssClass="btn btn-primary" runat="server" Text="Add"
            OnClick="AddTeamButton_Click" />
    </div>
<script type="text/javascript">
    $(document).ready(function () {
        $(".searchinput").autocomplete({
            source: function (request, response) {
                $.ajax({
                    type: "POST",
                    contentType: "application/json; charset=utf-8",
                    url: "PredictiveSearch.asmx/GetAllPredictions",
                    data: "{'keywordStartsWith':'" + request.term + "'}",
                    dataType: "json",
                    async: true,
                    success: function (data) {
                        response(data.d);

                    },
                    error: function (result) {
                        alert("Due to unexpected errors we were unable to load data");
                    }
                });
            },
            minLength: 1
        });
    });
</script> 
```

和 c# 网络服务：

```
 [System.Web.Script.Services.ScriptService]
public class PredictiveSearch : System.Web.Services.WebService
{

    [WebMethod]
    public IList<string> GetAllPredictions(string keywordStartsWith)
    {
        //TODO: implement real search here!

        SqlConnection conn = new SqlConnection(WebConfigurationManager.ConnectionStrings["RaiseFantasyLeagueConnectionString"].ConnectionString);
        SqlCommand cmd = new SqlCommand("[dbo].[findEnglishTeams]", conn);
        cmd.CommandType = CommandType.StoredProcedure;

        string searchTerm = keywordStartsWith;
        SqlParameter searchTermParam = new SqlParameter("@searchterm", searchTerm);

        cmd.Parameters.Add(searchTermParam);

        IList<string> output = new List<string>();

        conn.Open();
        SqlDataReader dReader = cmd.ExecuteReader(CommandBehavior.CloseConnection);
        if (dReader.HasRows)
        {
            while (dReader.Read())
            {
                output.Add(dReader["englishTeamName"].ToString());
            }
            return output;
        }
        else
        {
            return output; 
        }
    }
} 
```

我需要获取填充下拉列表的值的 ID，这怎么可能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T18:15:42.590

由于您使用 Ajax 请求在客户端填充此内容，因此您将不得不：

1.  通过将所选值写入 html 输入 type=hidden 元素并在表单回发时在服务器端读取它来获取所选值。只是不要忘记`input type=hidden`通过添加使元素成为服务器端控件`runat="server"`
2.  通过另一个 Ajax 请求提交选定的值。
3.  使用 Request.Params 集合读取选定的值，使用列表框的名称作为键。就像是：

    ```
    var selectedValues = Request.Params["select_box_name"]; 
    ```

您将无法简单地使用，因为在您通过 Ajax 填充它时`ListBox.SelectedValue`找不到值。`ViewState`

我会选择选项3 ...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T18:53:07.600

希望这样的东西能[更好](http://www.aspdotnet-suresh.com/2011/03/how-to-implement-auto-complete-textbox.html)地满足您的需求

# c++ - 为什么我的 fscanf 不工作？

> ID：15483777
> 
> 赞同：-1
> 
> 时间：2013-03-18T18:05:02.360
> 
> 标签：c++

出于某种原因，我不知道为什么，我的 fscanf 代码不起作用。我的朋友有相同的任务和相同的代码为他工作。

```
ISBNPrefix::ISBNPrefix(const char * filename) {
    FILE * prefixFile = NULL;

    if (filename != NULL)
    prefixFile = fopen(filename, "r");
}

bool ISBNPrefix::isRegistered (int area) const {
    int areaDigit = 0;
    bool check = false;

    //rewind(prefixFile);

    while(fscanf(prefixFile, "%d %*[^ ] %*[^\n]", &areaDigit) != EOF) {
        if (areaDigit == area) {
            check = true;
            break;
        }
    }

    return check;
} 
```

它没有正确地 fscanf，它应该在某些测试中返回 true，但它返回 false；我认为它没有正确扫描。任何人都可以看到有什么问题吗？

我的文本文件的前四行是：

```
0 00 19
0 200 699
0 7000 8499
0 85000 89999 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T18:22:28.887

这一行：

```
while(fscanf(prefixFile, "%d %*[^ ] %*[^\n]", &areaDigit) != EOF) { 
```

将要

*   将一个数字读入 areaDigit，然后
*   跳过输入中的空格，然后
*   读取一个或多个非空格字符，然后
*   再次跳过空格，然后
*   读取并丢弃所有字符直到下一个换行符。

如果在读取 for 数字之前到达文件末尾`areaDigit`，则循环将结束。例如，输入如下：

```
123 456 789
555 xxx yyy 
```

它将循环两次，分别`areaDigit`为 123 和 555

输入如下：

```
1 2 3 4 5 6 7 8 9
a b c d e f g h i 
```

它将读取`1`然后进入无限循环，无法读取第二行（`areaDigit == 1`整个时间。）

输入如下：

```
1
2
3
4
5
6
7 
```

它将循环 3 次，分别`areaDigit`为 1、4 和 7

# javascript - javascript css调用变量在Android浏览器中不起作用

> ID：15483782
> 
> 赞同：1
> 
> 时间：2013-03-18T18:05:12.217
> 
> 标签：javascript, jquery, android-browser

我正在循环浏览一组图像，然后设置它们的高度以匹配一个变量。以下代码在 Firefox 上运行良好，但在 Android 浏览器中无响应。想法？

```
var x = 100;
count_li = 5;

for (var i = count_li - 1; i >= 0; i -= 1) {
    var carousel_img = '#carousel_img_' + [i];
    $(carousel_img).css('height', x);
} 
```

我有一组 5 张可能看起来像这样的图像：

```
<img id="carousel_img_0" src="img_0.jpg"/>
<img id="carousel_img_1" src="img_1.jpg"/>
etc... 
```

[这](https://stackoverflow.com/questions/6144182/javascript-pass-variable-to-style)是一个类似的帖子供参考，但我没有找到我需要的内容。

第二个直接相关的问题是此代码存在确切问题：

```
var img_w = $(carousel_img).width(); 
```

大概它也需要一个“px”引用，但我不知道语法。

解决方案------------------------------------------------ ---------

正如马特所说，这

```
$(carousel_img).css('height', x); 
```

需要在末尾添加一个“px”，如下所示：

```
$(carousel_img).css('height', x + 'px'); 
```

# php - 动态元素中的jquery样式内容

> ID：15483785
> 
> 赞同：0
> 
> 时间：2013-03-18T18:05:17.840
> 
> 标签：php, jquery, css, flexslider

我正在使用 jquery 插件 flexslider 来显示一些图像和标题。我正在使用下面的代码将标题从 flexslider 内容中取出并放入外部元素中。

字幕使用跨度设置样式，但是当它们被放置到名为“.captions”的新元素中时，它们没有设置样式并且所有文本都一起运行。

如何将样式和格式应用于“.captions” div 中的文本？

```
 <script type="text/javascript" charset="utf-8">
    $(window).load(function() {

    $captions = $('.captions');

    $('.flexslider').flexslider({
        animation: "fade",
        controlNav: "thumbnails",
        directionNav: true,
        slideshow: false,
        useCSS: true,
        touch: true,
        start: function() {
            $activecaption = $('.flex-active-slide .flex-caption');
            $captions.html($activecaption.text());        
        },
        after: function() {
            $activecaption = $('.flex-active-slide .flex-caption');
            $captions.html($activecaption.text());
        }
    }); 
    });
</script> 
```

例如，我正在呼应这个：

```
echo "<span class='artwork-title'>$page->title</span>,<span class='artwork-year'>     $artwork->date</span><span class='artwork-year'>$artwork->dimensions</span>"; 
```

我的 jquery 似乎正在摆脱 span 标签。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T18:56:26.540

重新阅读问题后，您似乎需要`.captions`元素中的活动标题。您所要做的就是切换`.text()`到`.html()`所有元素都应该随之而来。

```
$(window).load(function() {
    $captions = $('.captions');

    $('.flexslider').flexslider({
        animation: "fade",
        controlNav: "thumbnails",
        directionNav: true,
        slideshow: false,
        useCSS: true,
        touch: true,
        start: function() {
            $activecaption = $('.flex-active-slide .flex-caption');
            $captions.html($activecaption.html());        
        },
        after: function() {
            $activecaption = $('.flex-active-slide .flex-caption');
            $captions.html($activecaption.html());
        }
    }); 
}); 
```

参考：[http ://www.woothemes.com/flexslider/](http://www.woothemes.com/flexslider/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T18:10:13.877

您可以使用 .addClass 应用 css 类

```
<style>
    .capStyle
    {
        color: red;
    }
</style>

$(".captions").addClass("capStyle"); 
```

# knockout.js - 比较具有不同元素的可观察数组

> ID：15483787
> 
> 赞同：3
> 
> 时间：2013-03-18T18:05:24.460
> 
> 标签：knockout.js

我想比较 2 个可观察的数组。我已经定义了 2 个可观察的数组，如下所示

```
var data1 = [{name1: "one"}, {name1: "two"}, {name1: "three"}];
var data2 = [{name2: "one"}, {name2: "two"}, {name2: "three"}];

dataOne: ko.observableArray(data1),
dataTwo: ko.observableArray(data2) 
```

您可以看到 data1 的元素名称与 data2 不同。我希望比较 2 个可观察数组并返回相互匹配的数据。所以在我们的例子中，它将是“二”和“三”

完成此操作后，我会将其绑定到复选框，该复选框会将复选框设置为具有匹配数据的复选框。我在[这里放了小提琴](http://jsfiddle.net/Jq3ru/15/)

我想将复选框与可观察数组 dataTwo 中的值绑定。如何做到这一点？

忘了提一下，在我的小提琴中，我只有一个复选框，但在我的实际场景中，它将是多个复选框，它们将绑定到数据。

* * *

我现在已经更新了小提琴。您可以看到我正在将复选框绑定到 dataOne，但希望根据 datatwo 中的元素进行检查。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T22:26:54.920

我必须承认，我仍然对你在这里想要达到的目标感到困惑。我建议您对这两个数组进行预处理以生成一个包含两个数组中的值的数组。然后，当您遍历每个数组时，您可以查看当前值是否在重复项列表中，如果是，请选中该框。

首先，在 viewModel 中添加一个 observable 数组：

```
duplicates: ko.observableArray() 
```

您可以使用以下方法展平每个阵列：

```
var flattenedOne = ko.utils.arrayMap(this.dataOne(), function(item) {
    return item.name1;
});
flattenedOne = flattenedOne.sort();

var flattenedTwo = ko.utils.arrayMap(this.dataTwo(), function(item) {
    return item.name2;
});
flattenedTwo = flattenedTwo.sort(); 
```

然后使用比较来获取两个数组中的那些：

```
var differences = ko.utils.compareArrays(viewModel.flattenedOne, viewModel.flattenedTwo);
//return a flat list of differences
ko.utils.arrayForEach(differences, function(difference) {
    if (difference.status === 'retained') {
        viewModel.duplicates.push(difference.value);
    }
}); 
```

然后你使用数据绑定：

```
<input type="checkbox" data-bind="checked: duplicates.indexOf(name1) !== -1" /> 
```

工作[小提琴](http://jsfiddle.net/Jq3ru/42/)。

# cocoa - 从 web 视图查看/下载文件

> ID：15483789
> 
> 赞同：0
> 
> 时间：2013-03-18T18:05:35.813
> 
> 标签：cocoa

伙计们，我有一个基本上包含附件的 webview。所以我的问题是，我如何从该网络视图查看/下载该特定文件可能是 .pdf/.docx/.xls 等。

# php - SWFUpload 没有显示错误，但不上传大型视频文件

> ID：15483790
> 
> 赞同：1
> 
> 时间：2013-03-18T18:05:36.027
> 
> 标签：php, file-upload, swfupload

我有一个继承的项目，它使用代码点火器、prototype.js 和 swfUpload 来管理大型视频文件。我遇到了上传大型视频文件时窒息的问题。

我已成功上传较小的文件（~198mb mpg 文件和 3mb mov 文件），但在调试上传 1.57 GB mov 文件时遇到问题。

在我的本地机器上，上传在约 1 分钟内完成上传，成功返回。但是，当我转到文件应该存在的上传文件夹（以及成功上传较小文件的位置）时，它就丢失了。

我的错误日志中没有错误。

在我的 .htaccess 文件中，我正在设置：

```
php_value upload_max_filesize 6143M  
php_value post_max_size 6143M 
```

我通过调用 ini_get() 确认这是有效的

这是我的 SWFUpload 对象：

```
swfu = new SWFUpload({
   debug: true,
   upload_url: '" . BASE_URL . "/content_management/ajax_asset_upload_files',
   flash_url: '" . BASE_URL . "/js/swfupload/Flash/swfupload.swf',

   post_params: {'PHPSESSID' : '" . $this->session->userdata('session_id') . "'},
   file_size_limit : '10000 MB',
   file_types : '*.*',
   file_types_description : 'All Files',
   file_upload_limit : 100,
   file_queue_limit : 0,
   custom_settings : {
      progressTarget : 'fsUploadProgress'
   },

   // Button settings
   button_image_url: '" . BASE_URL . "/images/buttons/btn_select_file.gif',
   button_width: '105',
   button_window_mode: 'transparent',
   button_height: '20',
   button_placeholder_id: 'spanButtonPlaceHolder',
   button_disabled: true,
   button_cursor: SWFUpload.CURSOR.HAND,
   button_action: SWFUpload.BUTTON_ACTION.SELECT_FILE,

   // The event handler functions are defined in handlers.js
   file_queued_handler : fileQueued,
   file_queue_error_handler : fileQueueError,
   file_dialog_complete_handler : fileDialogComplete,
   upload_start_handler : uploadStart,
   upload_progress_handler : uploadProgress,
   upload_error_handler : uploadError,
   upload_success_handler : assetUploadSuccess,
   upload_complete_handler : uploadComplete,
   queue_complete_handler : queueComplete // Queue plugin event
}); 
```

和调试输出：

```
---SWFUpload Instance Info---
Version: 2.2.0 2009-03-25
Movie Name: SWFUpload_0
Settings:
   upload_url:               [function location]
   flash_url:                [js_folder]/swfupload.swf?preventswfcaching=1363621116581
   use_query_string:         false
   requeue_on_error:         false
   http_success:             
   assume_success_timeout:   0
   file_post_name:           Filedata
   post_params:              [object Object]
   file_types:               *.*
   file_types_description:   All Files
   file_size_limit:          10000 MB
   file_upload_limit:        100
   file_queue_limit:         0
   debug:                    true
   prevent_swf_caching:      true
   button_placeholder_id:    spanButtonPlaceHolder
   ...
Event Handlers:
   swfupload_loaded_handler assigned:  false
   file_dialog_start_handler assigned: false
   file_queued_handler assigned:       true
   file_queue_error_handler assigned:  true
   upload_start_handler assigned:      true
   upload_progress_handler assigned:   true
   upload_error_handler assigned:      true
   upload_success_handler assigned:    true
   upload_complete_handler assigned:   true
   debug_handler assigned:             true

SWF DEBUG: SWFUpload Init Complete
SWF DEBUG: 
SWF DEBUG: ----- SWF DEBUG OUTPUT ----
SWF DEBUG: Build Number:           SWFUPLOAD 2.2.0
SWF DEBUG: movieName:              SWFUpload_0
SWF DEBUG: Upload URL:             [function location]
SWF DEBUG: File Types String:      *.*
SWF DEBUG: Parsed File Types:      
SWF DEBUG: HTTP Success:           0
SWF DEBUG: File Types Description: All Files (*.*)
SWF DEBUG: File Size Limit:        10485760000 bytes
SWF DEBUG: File Upload Limit:      100
SWF DEBUG: File Queue Limit:       100
SWF DEBUG: Post Params:
SWF DEBUG:                         PHPSESSID=ki7kne5j6co95il6f6hqt8pje4
SWF DEBUG: ----- END SWF DEBUG OUTPUT ----
SWF DEBUG: 
SWF DEBUG: Event: fileDialogStart : Browsing files. Single Select. Allowed file types: *.*
SWF DEBUG: Select Handler: Received the files selected from the dialog. Processing the file list...
SWF DEBUG: Event: fileQueued : File ID: SWFUpload_0_0
SWF DEBUG: Event: fileDialogComplete : Finished processing selected files. Files selected: 1\. Files Queued: 1
EXCEPTION: 
SWF DEBUG: StartUpload: First file in queue
SWF DEBUG: Event: uploadStart : File ID: SWFUpload_0_0
SWF DEBUG: Global Post Item: PHPSESSID=ki7kne5j6co95il6f6hqt8pje4
SWF DEBUG: File Post Item: asset_id=131
SWF DEBUG: File Post Item: document_type_id=4
SWF DEBUG: File Post Item: title_id=-1
SWF DEBUG: File Post Item: title=test3
SWF DEBUG: ReturnUploadStart(): File accepted by startUpload event and readied for upload.  Starting upload to [upload function] for File ID: SWFUpload_0_0
SWF DEBUG: Event: uploadProgress (OPEN): File ID: SWFUpload_0_0
SWF DEBUG: Event: uploadProgress: File ID: SWFUpload_0_0\. Bytes: 1409024\. Total: 1692228612
SWF DEBUG: Event: uploadProgress: File ID: SWFUpload_0_0\. Bytes: 5308416\. Total: 1692228612
...
...
SWF DEBUG: Event: uploadProgress: File ID: SWFUpload_0_0\. Bytes: 1692228612\. Total: 1692228612
SWF DEBUG: Event: uploadSuccess: File ID: SWFUpload_0_0 Response Received: true Data: 
SWF DEBUG: Event: uploadComplete : Upload cycle complete. 
```

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T17:18:49.023

您的主机可能已禁用您对 set_time_limit(0) 等 php 变量进行 ini_set 以增加最大执行时间的功能，在这种情况下，它将使用 Apache 在 httpd.conf 中的“超时”，默认为 60 秒。还设置FcgidMaxRequestLen，即最大请求长度（以字节为单位）。

在 php 中，还要检查：memory_limit

为了帮助您调试，还可以尝试： ini_set('display_errors','On'); 错误报告（E_ALL）；

也从您的代码中删除任何 at 符号。例如：@$varname 或 @functionName() @ 告诉 PHP 隐藏正在发生的任何错误。

可能是您的 error_reporting 级别设置得太低，因此实际上存在错误，但您没有看到它。以上应该解决这个问题。

# c - 结构类型的数组，C错误

> ID：15483792
> 
> 赞同：1
> 
> 时间：2013-03-18T18:05:37.780
> 
> 标签：c, arrays, pointers, struct

所以，我有这个结构：

```
typedef struct {
    int day;
    int amount;
    char type[4],desc[20];
 }transaction; 
```

这个函数用于填充类型为*transaction*的向量，在 main 中声明：

```
void transact(transaction t[],int &n)
 {
    for(int i=0;i<n;i++)
    {
        t[i].day=GetNumber("Give the day:");
        t[i].amount=GetNumber("Give the amount of money:");
        t[i].type=GetNumber("Give the transaction type:");
        t[i].desc=GetNumber("Give the descripition:");
    }
 } 
```

我在函数标题处得到的错误`transact()`：

> `Multiple markers at this line`
> `- Syntax error`
> `- expected ';', ',' or ')' before '&' token`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-18T18:08:38.850

您正在尝试将`n`参数声明为引用 ( `int &n`)。但是引用是 C++ 的特性，在 C 中不存在。

由于该函数不会修改 的值`n`，因此只需将其设为普通参数即可：

```
void transact(transaction t[],int n) 
```

稍后您在尝试分配数组时也会遇到错误：

```
t[i].type=GetNumber("Give the transaction type:");
t[i].desc=GetNumber("Give the descripition:"); 
```

由于`GetNumber`可能返回一个数字，因此不清楚您要在那里做什么。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-18T18:09:01.667

C++ 有诸如`int &n`;之类的引用。C 没有。

删除`&`.

然后，您将在为 和 分配数字时遇到`t[i].type`问题`t[i].desc`。它们是字符串，你不能像那样分配字符串，你可能应该使用类似的东西`void GetString(const char *prompt, char *buffer, size_t buflen);`来进行读取和分配：

```
GetString("Give the transaction type:", t[i].type, sizeof(t[i].type)); 
```

# jquery - 带有foreach php变量的Jquery Ajax表单

> ID：15483799
> 
> 赞同：0
> 
> 时间：2013-03-18T18:06:09.797
> 
> 标签：jquery, ajax

我有一组具有相同名称和 ID 的复选框，但有不同的变量，我想用我的 jquery ajax 表单提交。复选框如下所示：

```
<input class="checkbox" name="<? echo"description_list[$i]";?>" id="<? echo"description_list[$i]";?>" type="checkbox" value="<? echo $row['description'];?>" />&nbsp;<? echo $row['description'];?><br /> 
```

对 jquery 的调用看起来像这样。

```
<script type="text/javascript" >
$(document).ready(function() {
$('.formSub').live('click',function() {                     

var store = $("#store").val();
var type = $("#type").val();
var business_name=$("#business_name").val();
var first_name=$("#first_name").val();
var last_name=$("#last_name").val();
var phone = $("#phone").val();
var email = $("#email").val();
var make = $("#make").val();
var model = $("#model").val();
var esn = $("#esn").val();
var lock = $("#lock").val();
var description = $("#description").val();

var <? echo"description_list[$i]";?> = $("#<? echo"description_list[$i]";?>").val();

var dataString = 'store='+store+'&type='+type+'&business_name='+business_name+'&phone='+phone+'&email='+email+'&make='+make+'&model='+model+'&esn='+esn+'&lock='+lock+'&description='+description+'&<? echo"description_list[$i]";?>='+<? echo"description_list[$i]";?>;

if(esn=='')
{
$('.error').show().fadeOut(3000);
}
else
{
$.ajax({
type: "POST",
url: "somefile.php",
data: dataString,
success: function(response){

$('#customerInfo').slideUp(500);
$('#repairResult').delay(500).slideDown(500);

}
});
}
return false;
});
});
</script> 
```

不知道如何让它在 foreach 描述 [$i] 上循环...如果有人可以提供帮助将不胜感激。

谢谢安德伦......这就是我最终得到的......完美无缺。

```
<script type="text/javascript">
     $(document).ready(function(){
         $("#input_form").submit(function(){
             var querystring = $(this).serialize();     
         $.post("submit.php", $(this).serialize());     
    $('#customerInfo').slideUp(500);
            $('#repairResult').delay(500).slideDown(500);
             return false;
             });
    });
</script> 
```

# c# - 正则表达式 - 从 HTML 中提取 img src

> ID：15483804
> 
> 赞同：-2
> 
> 时间：2013-03-18T18:06:40.043
> 
> 标签：c#, html, regex, image, extract

我知道我不应该在 HTML 中使用正则表达式。我想从 HTML 文件中提取图像源，示例如下：

它可能看起来像这样：

```
<img src = cid:header width="700" height="93" alt="Logo" />
<img src= cid:header width="700" height="93" alt="Logo" />
<img src =cid:header width="700" height="93" alt="Logo" />
<img src=cid:header width="700" height="93" alt="Logo" /> 
```

**在每种情况下，我都希望得到“cid:header”作为结果。**

由于我的正则表达式知识基本上为零，所以我求助于你们。我需要一个在“src”之后或“=”字符之后接受空格的模式。

**src[mightBeSpace]=[mightBeSpace]cid:[mustNotBeSpace]**

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T18:09:14.037

```
^<img src\s?=\s?([^\s]+).*/>$ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-18T18:09:29.513

正则表达式中的“可能是空格” is `\s*`，并且“必须没有空格”转换为`\S+`

使用此信息，您应该能够构建正则表达式。如果你不能，请展示你的尝试。

# matlab - 无法访问 MCR 组件缓存

> ID：15483807
> 
> 赞同：0
> 
> 时间：2013-03-18T18:06:48.660
> 
> 标签：matlab, webserver, cgi

我想使用 CGI 和 Apache Web 服务器让用户访问运行我编译的 Matlab 应用程序（一个 exe 文件）。我按照[本指南](http://www.mathworks.com/support/solutions/en/data/1-30REEY/)中的说明进行操作。

但是，我在 Web 服务器日志中收到错误消息：

**[错误] [客户端 127.0.0.1] 无法访问 MCR 组件缓存。，引用者：.../standalone.html**

我正在使用 Matlab 2012a。是否有任何方法可以控制使用 Matlab 2012a 编译的应用程序的 MCR 缓存？这个 Matlab 版本的编译没有更多的 CTF 文件。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T10:46:44.503

我相信在最新版本的 MATLAB Compiler 中，CTF 存档默认嵌入在 .exe 中，但是您可以通过从`deploytool`设置中选择一个选项或使用`-C`带有.exe 的参数来更改它`mcc`。

CTF 存档通常会在您第一次运行组件时自动展开，但如果您需要手动展开它（我相信从 CGI 调用它时需要这样做，尽管我自己从未做过）有一个实用程序调用，您的操作系统类型`extractCTF.exe`在`matlabroot\toolbox\compiler\arch`哪里`arch`，例如`win32`等。

有关更多信息，请参见[此处](http://www.mathworks.com/help/compiler/deploying-to-end-users.html?searchHighlight=extractctf)和[此处](http://www.mathworks.com/help/compiler/mcr-component-cache-and-ctf-archive-embedding.html)。

希望有帮助！

# sql - SQL JOIN 在哪里放置 WHERE 条件？

> ID：15483808
> 
> 赞同：43
> 
> 时间：2013-03-18T18:06:48.897
> 
> 标签：sql, join, where

我有以下两个例子。

**1\. 示例（WHERE）**

```
SELECT 1
  FROM table1 t1
  JOIN table2 t2 ON t1.id = t2.id
 WHERE t2.field = true 
```

**2\. 示例（JOIN AND）**

```
SELECT 1
  FROM table1 t1
  JOIN table2 t2 ON t1.id = t2.id AND t2.field = true 
```

就性能而言，更快的方法是什么？你喜欢哪个？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-03-18T18:11:39.450

如果一个过滤器在功能上进入一个`JOIN`条件（即它是一个实际的连接条件，而不仅仅是一个过滤器），它必须出现在`ON`那个连接的子句中。

值得注意：

*   如果将其放在`WHERE`子句中，则连接为 时的性能相同`INNER`，否则性能不同。正如评论中提到的那样，这并不重要，因为无论如何结果都是不同的。

*   `WHERE`当它确实是一个条件时，将过滤器放在子句中会`OUTER JOIN`隐式地取消条件的`OUTER`性质（“即使没有记录也加入”），因为这些过滤器意味着首先必须存在现有记录。例子：

`... table1 t LEFT JOIN table2 u ON ... AND t2.column = 5`是正确的

```
... table1 t LEFT JOIN table2 u ON ... 
WHERE t2.column = 5 
```

是不正确的，因为它`t2.column = 5`告诉引擎来自 t2 的记录是预期的，这与外部连接背道而驰。例外情况是`IS NULL`过滤器，例如`WHERE t2.column IS (NOT) NULL`（这实际上是构建条件外连接的便捷方式）

*   `LEFT`并且`RIGHT`连接是隐式`OUTER`连接。

希望它有所帮助。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-18T18:10:24.903

`JOIN`条件通常应独立于过滤条件。您使用 定义您的加入规则（**如何**）`ON`。你过滤**你**想要的`WHERE`。就性能而言，所有发动机和设计都没有通用规则，因此您的行驶里程会有很大差异。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-24T20:28:46.957

I think the faster way is to put the filter in the where clause, because it will procees that filter in the where first , and then the join clause, so there will be no need of permutation of filters.

# c# - 将形状转换为多边形

> ID：15483813
> 
> 赞同：0
> 
> 时间：2013-03-18T18:06:59.397
> 
> 标签：c#, opengl, polygon, shape

是否有任何简单（或没有）能够从封闭路径创建多边形的算法？

假设 w 具有以下路径：

```
0,0; 2,0, 2,1; 1,1;
1,2; 2,2; 2,3; 0,3; 
```

我需要能够为 OpenGL 顶点缓冲区创建多边形索引。我使用的语言是 C#。

有人建议我使用 Convex Hull，但这不是我要找的东西，因为我已经有了形状。我知道这可能是一个微不足道的问题，但说真的，我找不到任何描述或任何东西可以将 mi 指向正确的方向。

编辑：

答案 1 建议选择一个点并将其连接到其他未连接的点，这适用于答案形状，但不适用于我发布的形状，上面的形状如下所示：

![形状](../Images/4af8b4e55bd3060d45aea8d10839dde8.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T20:26:39.527

转换为三角形是容易还是困难，这取决于您的要求以及您想要做到的程度。

如果你的多边形是凸的，最简单的方法是使用`GL_TRIANGLES`索引

```
0, 1, 2,   0, 2, 3,  0, 3, 4, ... 
```

它看起来像这样：

![扇形三角测量](../Images/25b1068025f6b89be771894dbe3dfc1b.png)

凹的情况是更多的工作。一种也适用于凹多边形（不是带有孔的多边形！）的算法是耳朵剪裁方法，在[维基百科](http://en.wikipedia.org/wiki/Polygon_triangulation)上有所描述（该页面上有更多内容。）

当你想要一个“好的”三角测量时，事情会变得非常有趣：避免细小的三角形，减少三角形的数量等，然后你可以用质量换取速度。我不会在这里讨论任何高级算法；在谷歌上搜索多边形三角剖分会得到很多信息。

至于法线，如果您的多边形是平面的（很可能“应该”是），则取两条不重合的边并将它们交叉乘积（有两条法线，您可能只需要一条：您需要选择您根据[右手](http://en.wikipedia.org/wiki/Polygon_triangulation)定则交叉乘积（顺时针或逆时针） 。

# raspberry-pi - 连接外部硬盘时在 Raspberry Pi 上运行命令

> ID：15483818
> 
> 赞同：1
> 
> 时间：2013-03-18T18:07:16.000
> 
> 标签：raspberry-pi

我正在使用 Raspberry Pi 为没有网络接口的 Western Digital 媒体播放器提供网络访问。播放器如果只是一个外部硬盘驱动器并在连接时自动安装。

问题是它是 HFS 格式的，所以为了能够读取和写入它，我必须卸载然后使用以下命令重新安装它：

```
sudo umount /dev/sda2
sudo mount -o force -t hfsplus /dev/sda2 /media/wdhdd/ 
```

哪个工作正常，但我不想每次重新连接硬盘时都必须通过终端通过 SSH 手动运行这些。

安装外部 USB 设备时是否有自动运行脚本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T23:48:38.650

因为每次插入此 USB 设备时都必须执行此操作，所以您应该编辑插入时完成的程序。您可以通过访问[此说明了解更多信息](http://ubuntuforums.org/archive/index.php/t-502864.html)

# thunderbird - Thunderbird 中 RSS 源的“文件夹视图”在哪里？

> ID：15483824
> 
> 赞同：5
> 
> 时间：2013-03-18T18:07:52.333
> 
> 标签：thunderbird, rss-reader

全部，

我已经从 Google Reader 切换到 Thunderbird 来阅读/管理 RSS 提要。

出于某种原因，我导入的提要的文件夹视图没有显示在 Thunderbird 中，但是在“管理订阅”面板中，文件夹层次结构被保留了。

请参阅随附的屏幕截图。

有什么想法吗？

谢谢！

![Thunderbird RSS 文件夹问题](../Images/6759b3448043b3726a7d5226c811deb9.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-22T13:14:15.043

我认为 Thunderbird 中没有 rss 的文件夹视图。您可以安装 Bamboo 插件，但也可以在 Firefox 中安装。

这是一个解决方法：

1.  右键单击您的 rss 文件夹
2.  搜索消息...
3.  将下拉框从“包含”更改为“不包含”
4.  在文本字段中输入一个疯狂的词（我输入了“zigloo”，假设它永远不会在 rss 提要中弹出，但你可以更疯狂）
5.  点击“另存为搜索文件夹”

然后，您可以为其命名并将其放在您想要的位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-11-08T21:42:23.240

带有提要的 .opml 文件是 Xml 格式，因此您可以将每个叶子（没有子元素的*大纲*元素）放在一个人工包装元素中，这将在 Thunderbird 中获得一个可见的文件夹。因此，您的初始 .opml 文件：

```
<opml version="1.0">
  <body>
    <outline text="Birds">
      <outline title="ParrotBlog" xmlUrl="http://parrot.com/feed"/>
    </outline>
  </body>
</opml> 
```

应转换为：

```
<opml version="1.0">
  <body>
    <outline text="Birds">
      <outline text="ParrotBlog">
        <outline title="ParrotBlog" xmlUrl="http://parrot.com/feed"/>
      </outline>
    </outline>
  </body>
</opml> 
```

您可以使用在线 Xslt 转换器（[此处](http://www.freeformatter.com/xsl-transformer.html)，[此处](http://xslttest.appspot.com/)）来执行 (xml+xslt)->xml。使用 Xsl 转换：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:template match="outline[not(child::*)]">
  <xsl:element name="outline">
      <xsl:attribute name="text"><xsl:value-of select="@title"/></xsl:attribute>
      <xsl:copy>
        <xsl:apply-templates select="@* | node()"/>  
      </xsl:copy>
  </xsl:element>
</xsl:template>
    <xsl:template match="/ | @* | node()">
  <xsl:copy>
    <xsl:apply-templates select="@* | node()"/>  
  </xsl:copy>
</xsl:template>
</xsl:stylesheet> 
```

这种解决方法可能对您有用，直到您找到一个不错的 Feed 聚合器。

# sql - 检查 - 比较 > 更新 SQL 表

> ID：15483825
> 
> 赞同：5
> 
> 时间：2013-03-18T18:07:54.437
> 
> 标签：sql, sql-server, sql-server-2008, tsql

我想编写一个存储过程，我可以根据以下条件更新表。

```
Table 
EmployeeID  GroupID Group#
123     G123        3
456     G456        3
789     G789        3
101     G101        3

View
GroupID_Granular    GroupID_Middle  GroupID_Executive
G123            M123            E123
G789            M789            E789 
```

如果在 View 的 GroupID_Granular 列中找到 GroupID，则更新表，设置 GroupID = GroupID_Executive 并将 Group# 设置为 1。

我不确定如何检查/比较然后运行更新 cmd。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-18T18:09:50.030

这可以通过以下方式轻松完成`JOIN`：

```
UPDATE t
SET 
    t.GroupID = v.GroupID_Executive, 
    t.[Group#] = 1
FROM YourTable t
JOIN YourView v ON v.GroupID_Granular = t.GroupID 
```

## [Sql 小提琴在这里](http://sqlfiddle.com/#!3/26761/2)

# javascript - 打开 PDF 并打印预览 jquery

> ID：15483827
> 
> 赞同：1
> 
> 时间：2013-03-18T18:07:55.030
> 
> 标签：javascript, jquery, pdf, printing, reportviewer

我目前正在 MVC3 环境中使用 ReportViewer 控件。我已经让它与导航和导出一起工作，我的问题是我的老板希望我通过打开 PDF 到打印预览来“自动化”打印或报告。

我目前有一种方法可以将报告导出为 Javascript 中的 PDF。

```
$find('1_ReportViewer').exportReport("PDF") 
```

这会将报告下载为 PDF。我想知道 Javascript/JQuery 中是否有一种方法可以自动打开 PDF 并显示打印预览。

我一直在阅读，我只是在寻找解决方案来做这个服务器端或插件。插件是我唯一的解决方案吗？

我尝试过类似的东西，

```
window.open($find('1_ReportViewer').exportReport("PDF")); 
```

但未能成功。

# jquery - jquery .on 意外触发子元素

> ID：15483833
> 
> 赞同：0
> 
> 时间：2013-03-18T18:08:05.017
> 
> 标签：jquery, jquery-plugins

我从 JSON 调用创建元素以构建如下列表。注意msg.id是用来设置li的id的。

```
 // create variations on somecharacter_id for id so that clicking upon any element reveals associated message id - see clickedId in .on(....)
                for (i = 0; i < messages.length; i++) {
                    var msg = messages[i];
                    var msgString = '<li id="' + msg.id + '" class="msgbox todo-content"><div class="todo-icon fui-bubble-16"></div><div class="todo-content"><h4 class="todo-name">';
                    msgString += msg.sendfrom;
                    msgString += '</h4>' + msg.subject;
                    msgString += '<div style="font-size:x-small;color:#bdc3c7;">' + parseTime(msg.timestamp_string) + '</div></div></li>';
                    $('#message-list').append(msgString);
                } 
```

我希望为单击的相关行检索 msg.id，因此 li 被赋予类名 .msgbox，并且我使用 .msgbox 创建了一个 .on() 事件。但是，在 li 中有各种 div。当我点击 li 中的任何东西时，.on 事件会触发（我认为这是预期的行为）。由于 li 内没有 id，因此 alert(event.target.id) 显示为 null。我应该向 li 中的每个子元素添加 id 以捕获相关 id 吗？肯定有更好的办法。

```
 $('.msgbox').on('click', function (event) {                               // example 

                // get id
                var clickedId = event.target.id;

                alert(clickedId);
            }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-18T18:09:59.903

代替

```
var clickedId = event.target.id; 
```

和

```
var clickedId = this.id; 
```

您对单击的最精确元素不感兴趣，但对`li`绑定事件处理程序并单击的元素不感兴趣。此元素`this`在事件处理程序中。

# arm - Atmel Studio 6 中的未定义引用

> ID：15483842
> 
> 赞同：1
> 
> 时间：2013-03-18T18:08:40.753
> 
> 标签：arm, atmel

我正在创建一个简单的程序来熟悉 Atmel Studio 6（在 Win 7 X64 上运行），使用 ASF 提供的用于 SAM4S 微控制器的库/驱动程序。在编译过程中，我在 startup_sam4s.c 文件中得到了几个 (19) 未定义的参考错误。我听说这通常意味着项目中缺少一个文件/缺少链接器文件，但我（有理由）确信我已将所有必需的文件添加到我的解决方案中。

[这些错误都是“对 _szero 的未定义引用”排序，并且与此](http://asf.atmel.com/bugzilla/show_bug.cgi?id=3010)错误报告中提到的完全相同（尽管使用不同的微控制器系列）。我已按照修复说明进行操作，但无济于事。我还尝试过重新安装、升级到 v6.1（这应该修复上述错误），并更改链接器脚本文件夹的权限（它似乎无法找到链接器脚本位置），并将所有内容注释掉确保不是我的程序导致了问题。

如果有人可以就可能导致此问题的原因提出一些建议，我将不胜感激。提前致谢。

编辑：嗯。重新启动机器并再次启动 Atmel Studio，然后再次进行错误修复过程，现在我只收到三个错误：未定义的 Writer.c 中的 _write 引用，未定义的 Readr.c 中的 _read 引用，以及我之前遇到的错误， ld 返回 1 个退出状态。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T15:43:56.397

奇怪的是，在另一台计算机上重新安装 6.1 并使用我现有的 main.c 文件创建新解决方案后，它运行良好：然后在以前的计算机上重新安装并将解决方案传输到它永久修复它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-20T22:20:18.243

通过不调用，我能够使以下错误消息消失**`printf()`**：

```
对`_write` writer.c 的未定义引用
对`_read`readr.c 的未定义引用
ld 返回 1 退出状态 collect2.exe

```

# java - 获取引荐来源网址的最后一部分

> ID：15483844
> 
> 赞同：1
> 
> 时间：2013-03-18T18:08:58.040
> 
> 标签：java, jsp, servlets

我想获取引荐来源网址的最后一部分。获取这些信息的最佳方式是什么？

```
String referrer = request.getHeader("referer"); 
```

目前，这就是我获取引荐来源网址的方式。这给了我整个 URL，但我只想要部分 URL。

**例如：**请求的 URL：`http://localhost:8080/TEST/ABC.html`
如果这是引荐来源网址，我只想要`ABC.html`.

感谢您的帮助，如果对我的问题有任何误解，请告诉我。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-18T18:14:52.147

这将为您提供 XYZ.html ：

```
String url = "http://localhost:8080/TEST/XYZ.html";
url = url.substring(url.lastIndexOf("/") + 1, url.length()); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-18T18:12:20.160

使用[java.net.URL.getFile()](http://docs.oracle.com/javase/7/docs/api/java/net/URL.html#getFile%28%29)

```
String path = new URL( request.getHeader( "referer" )).getPath();
int sep = path.lastIndexOf( '/' );
return ( sep < 0 ) ? path : path.substring( sep + 1 ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-18T18:11:30.087

这是基本的字符串操作，像对待任何其他字符串一样对待它。你可以使用`String.indexOf/String.lastIndexOf`and `String.substring`，或者你可以使用`String.split`，或者你可以使用`StringTokenizer`，或者你可以使用正则表达式（最灵活的选项，但是需要学习正则表达式）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-18T18:12:39.260

只需在最后一次出现后获取子字符串`/`。

# c++ - 火灾模拟程序不知道如何初始化它

> ID：15483852
> 
> 赞同：0
> 
> 时间：2013-03-18T18:09:31.860
> 
> 标签：c++

程序应该输出一个 12x24 的矩阵，它以 0 为边界，中间有 1，在 (1,1) 的位置有一个 2 我不知道在哪个部分初始化 M[row][col] =2; 因为我把它放在任何地方，它都不会将 2 输出到第一个位置，有什么建议吗？

```
int main()
{
    int M[N/2][N];
    int ROWS, COLS, row, col;
    int r, c;
    ROWS = sizeof(M) / sizeof(M[0]);
    COLS = sizeof(M[0]) / sizeof(M[0][0]);
    fill(M, ROWS, COLS, 1, 1);
    row=1;
    col=1;
    for(r=0; r< ROWS; r++)
    {
        for(c=0; c < COLS; c++)
        { 
            if (r==0||r ==ROWS-1)
            {
                M[ROWS][COLS]=0;
            }
            else if(c==0||c==COLS-1)
            {
                M[ROWS][COLS]=0;
            }
            else {
                M[ROWS][COLS]=1;    
            }

            cout<< M[ROWS][COLS];
        }

        cout << endl;

    }

    print(M, ROWS, COLS);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T18:22:30.230

我注意到您在循环中使用`ROWS`and`COLS`作为数组索引`for`...您可能打算使用循环变量`r`和`c`.

此外，对常规变量使用大写名称被认为是一种不好的形式……C 中的约定是仅对宏使用大写标识符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-31T02:55:16.903

我敢打赌，如果你写 M[1][1]=2; 就在 cout<<M[ROWS][COLS] 行之前，您将看到所需的输出。这样做很愚蠢，因为这样您将重复地将单个位置 (M[1][1]) 分配给相同的值——确切地说，是 288 次——但是你不能为 M 打印错误的值[1][1] 如果您在每次打印任何内容时都将其设置为正确的值。当然，还有更好的方法来做到这一点。

将程序执行的操作完全分开会更好。它必须做两件事：

1.  初始化数组。
2.  打印数组的内容。

这些操作中的每一个都应由不同的功能执行。即调用一个函数一次初始化整个数组，然后调用另一个函数一次打印整个数组。这样，在打印任何单元格之前，数组中的每个单元格都被设置为正确的值。

如果你这样做，你应该很容易在你的代码中找到一个合适的地方来设置 M[1][1]=2 以便你看到正确的打印输出。

我假设这是一个练习，稍后将扩展为对数组做更多的事情，因此首先使用数组是有意义的。如果是这样，很有可能您必须在某个时候再次打印该数组，然后您会很高兴您编写了一个打印该数组*并且什么都不做*的函数。

# java - HTTPClient StringEntity PUT 问题

> ID：15483860
> 
> 赞同：1
> 
> 时间：2013-03-18T18:10:02.737
> 
> 标签：java, json, http, apache-commons

我正在努力通过 HTTP PUT 在服务器上创建纯文本文件。我正在使用 apache commons httpClient。我的凭据有效，但我的请求中没有正文内容。我必须怎么做才能创建这样的文件？当我尝试通过 hurl.it（即设置我的凭据和设置正文）时，它按预期工作。我想要的是在文件正文中显示的字符串“hej”。让它工作后，我打算使用 JSONString。以下代码在服务器上生成一个空文件（204 响应）：

```
 HttpClient httpClient = new DefaultHttpClient();

        String encoding = http_username + ":" + http_password;
        encoding = Base64.encodeBase64String(encoding.getBytes());
        HttpPut httpput = new HttpPut(http_path);

        HttpEntity content=null;
        try{
         content = new StringEntity("hej");
        }
        catch(UnsupportedEncodingException e){
            logger.error("Failed to Encode result");
        }

        logger.info("executing request " + httpput.getRequestLine());
        try {
            httpput.setHeader("Authorization", "Basic " + encoding);
            //httpput.setHeader("Content-Type", "application/json; charset=utf-8");
            httpput.setEntity(content);
            HttpResponse response = httpClient.execute(httpput);
            Header[] allHeaders = response.getAllHeaders();
            for (Header h : allHeaders) {
                logger.info(h.getName() + ": " + h.getValue());
            }

        } catch (Exception e) {
            logger.error(e.getMessage());
        } 
```

我已经尝试过设置内容类型和不这样做，没有区别。我做错了什么基本的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T17:27:21.570

结果是 Base64.encodeBase64String 在字符串的末尾附加了一个换行符，这会把所有东西都扔掉！

```
String encoding = http_username + ":" + http_password;
encoding = Base64.encodeBase64String(encoding.getBytes());
encoding= encoding.replace("\r\n", ""); //This fixes everything 
```

哇，这才花了我几天的时间才弄清楚！

# android - Webview 上传发送通知

> ID：15483861
> 
> 赞同：0
> 
> 时间：2013-03-18T18:10:09.060
> 
> 标签：android, upload, webview, contact-form

我有一个 android 应用程序，它指向一个网页，其中包含一个带有文件上传的联系表单。用户点击上传，选择一张图片，填写表格，最后点击发送......应用程序会根据上传文件大小和互联网速度占用几秒钟（或几分钟）。

我打算做的是显示一个带有运行条的对话框（我不知道正确的术语）说“发送......”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T20:49:13.330

最简单的方法是编辑网页本身并简单地显示一个 HTML 对话框或使用 WebView JavaScript 接口（请参阅[此处](http://developer.android.com/guide/webapps/webview.html#BindingJavaScript)）。
如果您无法编辑网页，您可能会使用如下所示的内容，仅针对特定 URI 显示对话框。（未测试）

```
webview.setWebChromeClient(new WebChromeClient() {
   public void onProgressChanged(WebView view, int progress) {
     //called if progress changed => page is loading
     if (uri == "http://example.org") {
         //show dialog
     }         
   }
 }); 
```

# c# - 完成服务并停止线程

> ID：15483866
> 
> 赞同：0
> 
> 时间：2013-03-18T18:10:20.100
> 
> 标签：c#

我有几个服务并使用线程来实现每一个。服务按顺序执行。让我拿起一个用于演示目的。

```
 services[1] = new RProcessing() { ConsoleInfoColor = ConsoleColor.Cyan };
            success = services[1].Start();
            if (success)
            {
                OutputUtils.WriteLogInfo("Service " + services[1].Name + " started...");
            }
            else
            {
                OutputUtils.WriteLogInfo("Service " + services[1].Name + " failed to start...");
                previousStartup = false;
                services[0].Stop();
            } 
```

内部 RProcessing。

```
 public RProcessing()
    {
        worker = new Thread[1]; // Only one thread
        for (int i = 0; i < 1; i++)
        {
            worker[i] = new Thread(new ThreadStart(ServiceLoop));
            worker[i].Name = "R Thread_" + i.ToString();
        }
        // processing
    }
    public bool Start()
    {
        foreach (Thread t in worker)
            t.Start();
        return (true);
    }

    public bool Stop()
    {
        if (_isRunning)
        {
            _isRunning = false;
        }
        _isRunning = false;
        base.Dispose();
        WriteLogInfo("Shutdown of R Processor complete");
        return (true);
    }

    public void ServiceLoop()
    {
        _isRunning = true;
        WriteLogInfo("Starting ServiceLoop() for: " + Assembly.GetAssembly(typeof(RProcessing)).FullName);
        string s;
        while (_isRunning)
        {
            Thread.Sleep(500);
            s = null;
            try
            { 
                WriteLogInfo(" processing "+s);
                Thread.Sleep(864);// 24 hours.
            }
            catch (Exception ex)
            {
                WriteLogError("Thread " + Thread.CurrentThread.Name + "     " + ex.ToString());
            }

        }
        if (this._isRunning)
        {
            WriteLogInfo("Restarting thread due to failure...");
            try
            {
                Thread.CurrentThread.Start();
            }
            catch (Exception ex)
            {
                WriteLogError("Error restarting thread... " + ex.ToString());
            }
        }
    } 
```

只有一个线程，我想完成它然后返回下一个服务。但是它总是在 ServiceLoop 中。怎么能破呢？只需调用 Stop()？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T18:15:12.670

好吧，评论具有误导性。线程将休眠 864 毫秒，而不是 24 小时。

```
Thread.Sleep(864);// 24 hours. 
```

如果您真的打算在循环中睡那么长时间，请使用 ManualResetEvent 以便您可以随时中止等待。

```
ManualResetEvent cancelEvent;

in loop:
 if(cancelEvent.WaitOne(TimeSpan.FromHours(24))){
    break;
 }

and, in Stop method:
 cancelEvent.Set(); 
```

同时删除：

```
if (this._isRunning)
{
    WriteLogInfo("Restarting thread due to failure...");
    try
    {
        Thread.CurrentThread.Start();
    }
    catch (Exception ex)
    {
        WriteLogError("Error restarting thread... " + ex.ToString());
    }
} 
```

并确保 _isRunning 是 volatile 的，否则它可能会被缓存而不会在另一个线程中更新。当您调用 Stop() 时，您的服务将和平退出。

# javascript - Javascript检查字符串中的每个字符并在相应位置返回数组元素

> ID：15483873
> 
> 赞同：1
> 
> 时间：2013-03-18T18:10:33.457
> 
> 标签：javascript, arrays, string, loops

得到一个字符串，它是一系列 0 或 1 位和一个值数组，如果字符串中有设置为 1 的字符，我需要从数组中返回相应的值。例如：mystring = "0101"; myarray =["A","B","C","D"]; 那么 result = "B,D" 我怎样才能得到这个结果呢？

```
 for(var i=0;i<mystring.length;i++){
    if(mystring[i] != 0)
 {
 result = myarray[i];
 }
  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T18:13:47.437

您的代码似乎工作得很好，所以您可以添加另一个数组并将值推送到该数组：

```
var result = [];
for (var i = 0 ...
    result.push(myarray[i]); 
```

[http://jsfiddle.net/ExplosionPIlls/syA2c/](http://jsfiddle.net/ExplosionPIlls/syA2c/)

* * *

一个更聪明的方法是应用一个过滤器来`myarray`检查相应的`mystring`索引。

```
myarray.filter(function (_, idx) {
    return +mystring[idx];
}) 
```

[http://jsfiddle.net/ExplosionPIlls/syA2c/1/](http://jsfiddle.net/ExplosionPIlls/syA2c/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T18:14:58.227

遍历二进制字符串中的字符，如果遇到 1，则将数组中对应索引处的值添加到临时数组中。通过逗号加入临时数组以获取输出字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-18T18:15:08.437

我不确定这是否是您要查找的内容，但这会返回匹配数组。

```
 var result = [];
   for(var i=0;i<mystring.length;i++){
       if(parseInt(mystring[i]) !== 0 ) {
          result.push(myarray[i]);
       }
   }
   return result; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-18T18:33:45.547

结果 = 新数组（）；for(var i=0;i

# vhdl - 使用 VHDL 和 Xilinx 的按钮开关设计计数器

> ID：15483875
> 
> 赞同：0
> 
> 时间：2013-03-18T18:10:34.080
> 
> 标签：vhdl, fpga, xilinx, spartan

我对 VHDL 和 XILINX ISE 非常陌生。我将 13.2 版用于 Xilinx ISE。

我想用以下输入设计一个非常简单的计数器：

*   方向
*   数数

计数输入将分配给一个按钮，我希望计数器在按下按钮时根据方向输入向上或向下计数。在此之前，我已经编写了一个示例 VHDL。它有一个时钟输入，它根据时钟输入进行计数。现在我希望它在我按下按钮时计数，而不是同步计数。

这是我的 VHDL 代码（请告诉我我的代码是否存在逻辑缺陷或任何其他缺陷）：

```
entity counter is
    Port ( COUNT_EN : in  STD_LOGIC;
           DIRECTION : in  STD_LOGIC;
           COUNT_OUT : out  STD_LOGIC_VECTOR (3 downto 0));
end counter;

architecture Behavioral of counter is

signal count_int : std_logic_vector(3 downto 0) := "0000";
begin
process 
begin
    if COUNT_EN='1' then
        if DIRECTION='1' then   
            count_int <= count_int + 1;
        else
            count_int <= count_int - 1;
        end if;
    end if;
end process;
COUNT_OUT <= count_int;
end Behavioral; 
```

我使用 Spartan xc3s500e 并相应地放置了输入。下面是我的 .ucf 文件：

```
#Created by Constraints Editor (xc3s500e-fg320-5) - 2013/03/18
NET "COUNT_EN" LOC = K17;
NET "COUNT_OUT[0]" LOC = F12;
NET "COUNT_OUT[1]" LOC = E12;
NET "COUNT_OUT[2]" LOC = E11;
NET "COUNT_OUT[3]" LOC = F11;
NET "DIRECTION" LOC = L13;
#Created by Constraints Editor (xc3s500e-fg320-5) - 2013/03/18
NET "COUNT_EN" CLOCK_DEDICATED_ROUTE = FALSE; 
```

我需要更改最后一行，因为我收到了错误：

```
This will not allow the use of the fast path between the IO and the Clock... 
```

消除此错误后，我对设备进行了编程。但是输出（LED）表现得很疯狂。它们有时静止几秒钟，有时只是快速闪烁。我无法弄清楚我的错误在哪里。我将不胜感激，非常感谢一些初学者教程（我找到的链接将我定向到 xilinx 的文档，对于初学者来说它们似乎相当复杂）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T12:47:13.993

根据您的描述，我了解到您**不是**在寻找[Asynchronous Counter](http://en.wikipedia.org/wiki/Counter#Asynchronous_.28ripple.29_counter)。

您需要的是依靠按钮开关触发的计数器。下面的 RTL 应该可以工作：

![在此处输入图像描述](../Images/edba52186f447309c50dbda5bd670888.png)

如果 HDL 编码有任何困难，请告诉我。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T19:51:36.547

你没有时钟。一旦满足**COUNT_EN**和**DIRECTION**条件，**count_int**变量将尽可能快地增加……事实上，各个位更改的时间可能会使整个事情变得完全不稳定和不正确。

您应该始终使用时钟……只是为了让 FPGA 获得正确的时序。

在这种情况下，将时钟放回去......然后添加一个新信号**COUNT_EN_LAST**。每次通过时钟进程保存旧的**COUNT_EN 。**仅在**COUNT_EN = '1'**和**COUNT_EN_LAST = '0'**时增加。

事实上，接下来您会发现您需要对输入进行“去抖动”。物理按钮/开关“弹跳”，每次按下按钮即可为您提供多个关闭事件。为此，您只需将**COUNT_EN_LAST 设为**向量（例如 5 长），每次将新值移入其中（**"COUNT_EN_LAST <= COUNT_EN_LAST(3 downto 0) & COUNT_EN;"**），并且仅在**COUNT_EN_LAST = "01111"**时增加，或者就在它们全为 1 之前。您需要的向量长度将根据您的时钟速度以及开关在稳定到新状态之前可以反弹多长时间而改变。

# java - java.io.StreamCorruptedException：无效的流标头：4C756E69

> ID：15483877
> 
> 赞同：2
> 
> 时间：2013-03-18T18:10:41.887
> 
> 标签：java, udp, objectinputstream

如果这个问题被问了很多次，但经过数小时的谷歌搜索/实验后，我还没有解决我的问题，我深表歉意。

我正在尝试通过 UDP 套接字从我的服务器发送一个对象（ServerPlayer）到我的客户端，当客户端接收到数据包时，我得到一个无效的流标头。我不确定什么可能会修改数据以导致标头损坏/不存在。

发件人线程：

```
//Thread loop
@Override
public void run()
{
    System.out.println("Thread " + threadCount + " running");
    //Test object transmission code.
    data = new byte[2048];
//  -----------------------------------------------------------------------------------
//  TRANSMISSION SETUP/OBJECT TRANSFER
    try 
    {
        //In case of delay
        socket.setSoTimeout(1000);

        //Object Transmission setup
        ByteArrayOutputStream bStream = new ByteArrayOutputStream();
        ObjectOutputStream oo = new ObjectOutputStream(bStream);
        oo.writeObject(p);
        oo.close();

        //Transmit object
        data = bStream.toByteArray();
        packet = new DatagramPacket(data, data.length, address, 4415);
        socket.send(packet);
//  -----------------------------------------------------------------------------------
//  GAME LOOP
        while(socket.getSoTimeout() > 0)
        {

        }
// -----------------------------------------------------------------------------------
//  GET TO THE CHOPPA CODE BELOW
    } 
    catch (SocketException e) 
    {
        System.out.println("Player " + username + " timed out");
    } 
    catch (IOException e) 
    {
        System.out.println("Server: ");
        e.printStackTrace();
    }
} 
```

客户/接收者：

```
public MultiplayerGameStart() throws IOException
{
    address = InetAddress.getByName("127.0.0.1");
    serverip = InetAddress.getByName(NetSettingsManager.ipAdd);

}

@Override
public void run() 
{
    //Packet byte array
    data = new byte[2048];
    try 
    {

        //Send connection REQ
        socket = new DatagramSocket(4415, address);
        data = PacketUtil.intTobyte(NetSettingsManager.NET_FUNCTION.REQ.getFunctionCode(), data.length);
        packet = new DatagramPacket(data, data.length, serverip, serverport);
        socket.send(packet);

        //Wait for ACK
        packet = new DatagramPacket(data, data.length);
        socket.receive(packet);

        //Converts ACK bytes to int to be read. If ACK code is correct, continue.
        if(PacketUtil.byteToint(packet.getData()) == NetSettingsManager.NET_FUNCTION.ACK.getFunctionCode())
        {
            //Returns username to be checked on playerlist.
            System.out.println("Logging into server..."); //DEBUG output
            data = NetSettingsManager.username.getBytes();
            packet = new DatagramPacket(data, data.length, serverip, serverport);
            socket.send(packet);

            //Stub code below. Will receive player object generated by server.
            packet = new DatagramPacket(data, data.length);
            socket.receive(packet);

            ObjectInputStream iStream = new ObjectInputStream(new ByteArrayInputStream(packet.getData(), packet.getOffset(), packet.getLength()));
            //iStream.reset();
            ServerPlayer messageClass = (ServerPlayer) iStream.readObject();
            iStream.close();

            space = new PlayState();
            space.addEntity(new ClientPlayer(received));

        }

    } 
    catch (IOException e)
    {
        System.out.println("Client: ");
        e.printStackTrace();
    }
    catch(ClassNotFoundException e)
    {
        System.out.println("Client: ");
        e.printStackTrace();
    }
} 
```

ServerPlayer（注意，我在这个示例中省略了我的函数，但如果需要我可以提供它们）。

```
public class ServerPlayer extends ServerEntity implements Serializable 
{
    int[] material = new int[4];
    Chunk pChunk;

public ServerPlayer(String username, float posX, float posY)
{
    super(username, posX, posY);
    //Material table.
    material[0] = 25;    //metal
    material[1] = 33;    //energy
    material[2] = 43;    //ion
    material[3] = 131;   //gas
}
} 
```

堆栈跟踪：

```
 java.io.StreamCorruptedException: invalid stream header: 4C756E69
at java.io.ObjectInputStream.readStreamHeader(Unknown Source)
at java.io.ObjectInputStream.<init>(Unknown Source)
at client.multiplayer.MultiplayerGameStart.run(MultiplayerGameStart.java:80)
at java.lang.Thread.run(Unknown Source) 
```

感谢您的时间 ：）。

**更新**

所以事实证明在线程中运行我的发件人代码会导致问题。现在我的数据包输出是

```
server:sent 243 bytes: -84,-19,0,5 | client: received 8 bytes -84, -19, 0, 5 
```

但遗憾的是我现在得到

```
java.io.EOFException
at java.io.ObjectInputStream$PeekInputStream.readFully(Unknown Source)
at java.io.ObjectInputStream$BlockDataInputStream.readUTFBody(Unknown Source)
at java.io.ObjectInputStream$BlockDataInputStream.readUTF(Unknown Source)
at java.io.ObjectInputStream.readUTF(Unknown Source)
at java.io.ObjectStreamClass.readNonProxy(Unknown Source)
at java.io.ObjectInputStream.readClassDescriptor(Unknown Source)
at java.io.ObjectInputStream.readNonProxyDesc(Unknown Source)
at java.io.ObjectInputStream.readClassDesc(Unknown Source)
at java.io.ObjectInputStream.readOrdinaryObject(Unknown Source)
at java.io.ObjectInputStream.readObject0(Unknown Source)
at java.io.ObjectInputStream.readObject(Unknown Source)
at client.multiplayer.MultiplayerGameStart.run(MultiplayerGameStart.java:80)
at java.lang.Thread.run(Unknown Source)` 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T19:06:55.477

摆脱对`reset()`. 他们没有添加任何东西，我相信服务器端调用`bStream.reset();`正在删除创建`ObjectOutputStream`.

此外，当您构造 时`ByteArrayInputStream`，您应该使用三参数变体，从数据报包中传递`getOffset()`和传递。`getLength()`

将来，当问这样的问题时，请发布异常的实际堆栈跟踪，以及足够的代码来验证异常是否发生在您认为的位置（在这种情况下，完整的接收方法）。

* * *

编辑：似乎客户端和服务器都在同一个端口（4415）发送和接收。根据您提供的其他调试信息，我相信客户端正在获取它尝试发送到服务器的初始数据报。尝试为每个端口使用不同的端口（并使用常量，例如`CLIENT_PORT`and`SERVER_PORT`来指定它们）。

# c# - 尽管有 PK，但 Context.SubmitChanges() 没有更新

> ID：15483878
> 
> 赞同：4
> 
> 时间：2013-03-18T18:10:49.653
> 
> 标签：c#, linq, linq-to-sql

我对 C# 中的 linq to DB 实现提供的 SubmitChanges 函数有疑问。当我运行命令时，没有任何错误，但记录永远不会更新。我查了这个问题，几乎每个人都说表没有主键有问题。但是，我的表分配了一个主键，但 SubmitChanges 没有发生。为了让您大致了解我正在执行的操作，我这里是一个示例：

```
public void setApproval(string approvalCode, int ID)
{
    using (DatabaseDataContext context = new DatabaseDataContext(DBConnection().getConnectionString()))
    {
        myRecord con = getRecord(ID); //Gets the record succesfully, PK field in tact
        con.ApprovalStatus = approvalCode;

        context.SubmitChanges();
    }
} 
```

如上所述，成功获取了记录，所有数据都完整无缺，包括用于识别它的 PK 字段。数据库连接用户被授予更新表的权限，尽管在这里我希望它会中断并抱怨。

有任何想法吗？如果我没有提供足够的信息，请告诉我。任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-18T18:16:36.917

您应该通过上下文获取对象

```
public void setApproval(string approvalCode, int ID)
{
    using (DatabaseDataContext context = new DatabaseDataContext(DBConnection().getConnectionString()))
    {
        myRecord con = context.TableName.First(item => item.ID == ID); //Gets the record succesfully, PK field in tact
        con.ApprovalStatus = approvalCode;

        context.SubmitChanges();
    }
} 
```

当您通过 Context 获取对象时，它会跟踪您所做的更改，然后将这些更改保存在 SubmitChanges

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-18T18:14:22.583

getRecord(ID) 在哪里获取它的上下文以返回记录？它没有被传递给方法，所以我假设它使用了不同的上下文。SubmitChanges() 只会看到当前上下文的更改，而不是 getRecord(ID) 使用的上下文。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-18T18:38:17.783

您是在检查数据是使用代码还是使用独立的数据库工具更新的？

如果在代码中，您的读取代码与写入代码一样可疑：当两个没有通用 API 的应用程序通过数据库进行通信时，我遇到了类似的问题。上下文并不能反映数据库中现在的内容，再多的告诉它刷新也不能完全解决问题。如果您需要检查数据库是否有其他程序或线程输入的内容，则必须创建一个新的数据库上下文对象来检查数据库。旧的数据库上下文对象可能仍具有最近更新之前的旧数据。

您的`getRecord`函数需要创建一个新上下文或将您刚刚编辑的当前上下文作为参数。如果它使用静态或类级别的上下文，它将没有最新的数据。

# eclipse - Eclipse 没有找到 Valgrind

> ID：15483881
> 
> 赞同：2
> 
> 时间：2013-03-18T18:11:04.393
> 
> 标签：eclipse, valgrind

我在我的主目录下的 SUSE Linux SLES 11SP2 上安装了 Valgrind，并将其添加到路径中。然后我为 C/C++ Service Release 2 Build id: 20130225-0426 安装了 eclipse Juno 并安装了 Valgrind 插件。

当我尝试使用 Valgrind 创建配置文件配置时，我收到一条错误消息：“[Valgrind 选项]：无法确定 Valgrind 的版本”，尽管它允许我进行配置，但它阻止我通过灰显所有按钮来继续除了关闭按钮。

我知道我错过了一些琐碎的事情，比如在 eclipse 中定义 Valgrind 可执行文件的位置，但我无法找到它，不是在项目属性中，也不是在窗口首选项中。

我会感谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T12:15:44.820

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-04T05:42:09.787

我得到了同样的错误，但它不是由你给出的解释引起的。

如果你在 mac os x 上使用 valgrind，你会得到这个错误，因为 valgrind 通常没有安装在 eclipse 正在寻找的目录中。为了解决 mac 上的问题，您需要通过键入 ln -s valgrind_location /usr/bin/valgrind 来创建指向 valgrind 位置的符号链接。请注意，这与 eclipse 网站[http://wiki.eclipse.org/Linux_Tools_Project/Valgrind/User_Guide](http://wiki.eclipse.org/Linux_Tools_Project/Valgrind/User_Guide)上的说明不同。出于某种原因，他们在他们的网站上向后调用。一旦我做了这个更正，valgrind 就可以在 Eclipse 中正常工作。

因此，在 Mac 上，至少它无法确定 valgrind 版本的错误至少与 eclipse 无法找到该文件相匹配。

# javascript - JavaScript 中的类

> ID：15483884
> 
> 赞同：0
> 
> 时间：2013-03-18T18:11:13.477
> 
> 标签：javascript, class

我在 JavaScript 中定义一个类

```
function Pen(parent){
    this.color = "#0000ff";
    this.stroke = 3;
    this.oldPt;
    this.oldMidPt;
    this.isActive = false;
    this.parent = parent; //app that owns this pen
    this.points = [];
    this.curShape;
        console.log(this);
    return(this);
} 
```

在console.log 语句中，我得到*的*不仅仅是这个类，我得到了关于基本上所有其他事情的各种信息。这是为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-18T18:14:35.627

关键字`this`取决于调用者，因此如果您在没有“new”关键字的情况下初始化函数，“this”很可能是在引用窗口而不是对象。

尝试：

```
function Pen(parent){
    var context = this;
    this.color = "#0000ff";
    this.stroke = 3;
    this.oldPt;
    this.oldMidPt;
    this.isActive = false;
    this.parent = parent; //app that owns this pen
    this.points = [];
    this.curShape;
        console.log(context);
    return(this);
}
 var pen = new Pen(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T18:16:14.940

因为您的“类”从其他javascript基类继承（在您的情况下是透明的）。如果您只想内省您在对象上创建的属性，请使用`hasOwnProperty(keyName)`过滤掉这些属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-18T18:30:39.857

```
Javascript is prototype based and not class based. Every new custom object as default
has pre built functionlity provided by the base object called Object.
So everytime you ask if a property or method belongs to a given object, in the worst
case it will fall until the Object object, and if that property/method is not there
then it will throw an error. Therefore when you are using the log function it is
printing all the object structure including properties and method of its "base" class. 
```

# mysql - MySQL 搜索文本和链接表

> ID：15483892
> 
> 赞同：0
> 
> 时间：2013-03-18T18:11:30.527
> 
> 标签：mysql, string, select, join, sql-like

我的数据库中有 3 个表，tbl_user、tbl_games 和 tbl_usergames。

tbl_user 有 id 和 name。

tbl_games 有 id 和 name。

tbl_usergames 具有 id_user 和 id_game 并将 tbl_user 链接到 tbl_games

我想进行搜索以返回具有名称与搜索字符串匹配的任何游戏的用户。

```
SELECT tbl_user.*
FROM tbl_user, tbl_usergames 
WHERE tbl_user.id IN (
 **SELECT id
 FROM tbl_games
 WHERE name LIKE '%Mario%'**
) 
```

我试过了，但它返回 0 个结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T18:45:50.087

```
SELECT u.*
FROM tbl_user u
JOIN tbl_usergames ug ON (u.id = ug.id_user)
JOIN tbl_games g ON (ug.id_game = g.id)
WHERE
    g.name LIKE '%Mario%' 
```

您需要加入*两个*表。

# python - 从python脚本调用scrapy而不创建JSON输出文件

> ID：15483898
> 
> 赞同：3
> 
> 时间：2013-03-18T18:11:47.627
> 
> 标签：python, json, web-crawler, scrapy

这是我用来调用scrapy的python脚本，答案是

[从脚本抓取抓取总是在抓取后阻止脚本执行](https://stackoverflow.com/questions/14777910/scrapy-crawl-from-script-always-blocks-script-execution-after-scraping)

```
def stop_reactor():
    reactor.stop()
dispatcher.connect(stop_reactor, signal=signals.spider_closed)
spider = MySpider(start_url='abc')
crawler = Crawler(Settings())
crawler.configure()
crawler.crawl(spider)
crawler.start()
log.start()
log.msg('Running reactor...')
reactor.run()  # the script will block here until the spider is closed
log.msg('Reactor stopped.') 
```

这是我的 pipelines.py 代码

```
from scrapy import log,signals
from scrapy.contrib.exporter import JsonItemExporter
from scrapy.xlib.pydispatch import dispatcher

class scrapermar11Pipeline(object):

    def __init__(self):
        self.files = {}
        dispatcher.connect(self.spider_opened , signals.spider_opened)
        dispatcher.connect(self.spider_closed , signals.spider_closed)

    def spider_opened(self,spider):
        file = open('links_pipelines.json' ,'wb')
        self.files[spider] = file
        self.exporter = JsonItemExporter(file)
        self.exporter.start_exporting()

    def spider_closed(self,spider):
       self.exporter.finish_exporting()
       file = self.files.pop(spider)
       file.close()

    def process_item(self, item, spider):
        self.exporter.export_item(item)
        log.msg('It reached here')
        return item 
```

这段代码取自这里

[Scrapy :: JSON导出问题](https://stackoverflow.com/questions/7839559/scrapy-issues-with-json-export)

当我像这样运行爬虫时

```
scrapy crawl MySpider -a start_url='abc' 
```

创建了一个具有预期输出的链接文件。但是当我执行 python 脚本时，它不会创建任何文件，尽管爬虫运行，因为转储的scrapy stats 类似于之前运行的那些。我认为python脚本中有一个错误，因为文件是在第一种方法中创建的。我如何让脚本输出文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-30T07:09:56.097

这段代码对我有用：

```
from scrapy import signals, log
from scrapy.xlib.pydispatch import dispatcher
from scrapy.conf import settings
from scrapy.http import Request
from multiprocessing.queues import Queue
from scrapy.crawler import CrawlerProcess
from multiprocessing import Process
# import your spider here
def handleSpiderIdle(spider):
        reactor.stop()
mySettings = {'LOG_ENABLED': True, 'ITEM_PIPELINES': '<name of your project>.pipelines.scrapermar11Pipeline'} 

settings.overrides.update(mySettings)

crawlerProcess = CrawlerProcess(settings)
crawlerProcess.install()
crawlerProcess.configure()

spider = <nameofyourspider>(domain="") # create a spider ourselves
crawlerProcess.crawl(spider) # add it to spiders pool

dispatcher.connect(handleSpiderIdle, signals.spider_idle) # use this if you need to handle idle event (restart spider?)

log.start() # depends on LOG_ENABLED
print "Starting crawler."
crawlerProcess.start()
print "Crawler stopped." 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-04-03T00:23:54.320

一个对我有用的解决方案是放弃运行脚本和使用内部 API，而是使用命令行和 GNU Parallel 来并行化。

要运行所有已知的蜘蛛，每个核心一个：

```
scrapy list | parallel --line-buffer scrapy crawl 
```

`scrapy list`每行列出所有蜘蛛，允许我们将它们作为参数附加到`scrapy crawl`传递给 GNU Parallel 的命令 () 中。`--line-buffer`意味着从进程接收到的输出将被混合打印到标准输出，但在逐行的基础上，而不是 quater/half 行一起乱码（对于其他选项，请查看`--group`and `--ungroup`）。

注意：显然这在具有多个 CPU 内核的机器上效果最好，因为默认情况下，GNU Parallel 将每个内核运行一个作业。请注意，与许多现代开发机器不同，廉价的 AWS EC2 和 DigitalOcean 层只有一个虚拟 CPU 内核。因此，如果您希望在一个内核上同时运行作业，您将不得不使用`--jobs`GNU Parellel 的参数。例如，每个核心运行 2 个 scrapy 爬虫：

```
scrapy list | parallel --jobs 200% --line-buffer scrapy crawl 
```

# cuda - 如何在 CUDA 中以更少的线程调用 __device__ 函数

> ID：15483903
> 
> 赞同：4
> 
> 时间：2013-03-18T18:12:04.723
> 
> 标签：cuda

我想从执行基数排序的内核内部调用一个独占扫描函数。但是独占扫描只需要一半的线程来完成它的工作。

独占扫描算法需要几个 __syncthreads() 。如果我一开始有一个声明，比如

> 如果（threadIdx.x > NTHREADS/2）返回；

这些线程不会参与独占扫描同步线程，这是不允许的。有没有办法解决这个问题。我确实调用了由 __syncthread()s 包围的独占扫描。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-18T18:25:55.307

像这样的东西应该可以工作（不要使用提前返回）：

```
__syncthreads(); // at entry to exclusive scan region
// begin exclusive scan function
if (threadIdx.x < NTHREADS/2) {
  // do first phase of exclusive scan up to first syncthreads
  }
__syncthreads(); // first syncthreads in exclusive scan function
if (threadIdx.x < NTHREADS/2) {
  // do second phase of exclusive scan up to second syncthreads
  }
__syncthreads(); // second syncthreads in exclusive scan function
(... etc.)
__syncthreads(); // at exit from exclusive scan region 
```

这有点乏味，但这是我所知道的遵守`__syncthreads()` [使用](http://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#synchronization-functions)法条文的唯一方法。您也可以尝试按照您指示的方式保留代码，使不工作的线程提前返回/退出。它可能会起作用，也可能会起作用。但不能保证它适用于未来的架构或更新的工具链。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-19T03:17:39.007

只是指出一个替代方案：
您还可以使用 的内联汇编等效项`__syncthreads()`，它允许使用可选参数来表示从计算能力 2.0 开始可用的参与线程数。像这样的东西应该工作：

```
#define __syncthreads_active(active_threads) asm volatile("bar.sync 0, %0;" :: "r"(active_threads));

if(threadIdx.x >= NTHREADS/2) return;

int active_warps = (NTHREADS/2 + warpSize) / warpSize;
int active_threads = active_warps * warpSize; // hopefully the compiler will optimize this to a simple active_threads = (NTHREADS/2 + warpSize) & ~32

__syncthreads_active(active_threads);
// do some work...
__syncthreads_active(active_threads);
// do some more work...
__syncthreads_active(active_threads); 
```

免责声明：写在浏览器中，完全未经测试！

不过，是否值得麻烦是另一个问题。

# html - 如何在没有超时的情况下使用 Firefox 在页面上查找元素？

> ID：15483905
> 
> 赞同：1
> 
> 时间：2013-03-18T18:12:07.863
> 
> 标签：html, ruby, firefox, cucumber, capybara

当我试图找到一个元素时，一个在 chrome 中很容易（相对）fornd 的元素在 Firefox 中超时。

这是一个例子

```
within('tr#blah') do
  fill_in('frm_blah', :with=>'foo')
end 
```

这会得到类似...的响应

```
 When I do the thing
# features/step_definitions/blah_steps.rb:13
  Timeout::Error (Timeout::Error)
  C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/net/protocol.rb:146:in `rescue
  in rbuf_fill'
  C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/net/protocol.rb:140:in `rbuf_fi
  ll'
  C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/net/protocol.rb:122:in `readunt
  il'
  C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/net/protocol.rb:132:in `readlin
  e'
  C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/net/http.rb:2562:in `read_statu
  s_line'
  C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/net/http.rb:2551:in `read_new'
  C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/net/http.rb:1319:in `block in t
  ransport_request'
  C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/net/http.rb:1316:in `catch'
  C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/net/http.rb:1316:in `transport_
  request'
  C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/net/http.rb:1293:in `request'
  C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/net/http.rb:1286:in `block in r
  equest'
  C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/net/http.rb:745:in `start'
  C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/net/http.rb:1284:in `request'
  ./features/step_definitions/blah_steps.rb:21:in `block (2 levels) in <to
  p (required)>'
  ./features/step_definitions/blah_steps.rb:20:in `/^I select "(.*?)"$/'
  features\blah.feature:17:in `When I fill in blah' 
```

让 Firefox 不那么生气的任何想法？

# fluent-nhibernate - 编写查询以查找没有孩子的父母

> ID：15483908
> 
> 赞同：1
> 
> 时间：2013-03-18T18:12:23.563
> 
> 标签：fluent-nhibernate

我有一种情况，患者记录将/不会有设备历史记录。我需要查找所有没有设备记录的患者记录或所有具有设备记录且字段不为空的患者。我在下面查询的方式不起作用。我找不到任何没有设备历史的患者。有什么建议么？映射是正确的，因为我可以直接访问记录、更新等。由于我有一个包含超过 40,000 条记录的数据库，因此我无法撤回所有患者并进行儿童计数。它会很慢并且使用太多内存。

任何帮助将不胜感激。提前致谢。

```
public IList<Patients> GetAllPatientsWithoutDevice(int facilityID, string search)
    {
        ICriteria query = FluentSessionManager.GetSession()
            .CreateCriteria<Patients>()
            .Add(Expression.Eq("IsDeleted", false))
            .CreateAlias("Facilities", "f")
            .Add(Expression.Eq("f.ID", facilityID))
            .CreateAlias("EquipmentHistory", "eh") // Tried, inner, left and right joins...
            .Add(Expression.Or(
                Expression.IsNull("EquipmentHistory"),
                Expression.IsNotNull("eh.DateOffPatient")
            ));

        query.AddOrder(new Order("FirstName", true))
            .AddOrder(new Order("LastName", true));

        return query.List<Patients>();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T18:24:53.373

我想通了......我不得不使用“IsEmpty”而不是“IsNull”。

```
 ICriteria query = FluentSessionManager.GetSession()
            .CreateCriteria<Patients>()
            .Add(Expression.Eq("IsDeleted", false))
            .CreateAlias("Facilities", "f")
            .Add(Expression.Eq("f.ID", facilityID))
            .CreateAlias("EquipmentHistory", "eh", NHibernate.SqlCommand.JoinType.LeftOuterJoin)
            .Add(Expression.Or(
                Expression.IsEmpty("EquipmentHistory"),
                Expression.IsNotNull("eh.DateOffPatient")
            )); 
```

# ios - 将 NSData 发送到 WCF

> ID：15483914
> 
> 赞同：0
> 
> 时间：2013-03-18T18:12:43.170
> 
> 标签：ios, wcf, bytearray, nsdata

我有一个 WCF 服务，目前期望 byte[] 作为输入参数，但我想从 iOS 发送 NSData。这些类型似乎不兼容。

我已经阅读了很多关于此的内容，并且大多数人建议我将 NSData 转换为 base64 字符串。

这适用于模糊数据吗？即我的 NSData 由通过 AES256 加密算法传递的 NSData 组成。我不认为这些数据可以成功转换回字符串。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T12:19:01.853

谢谢你汤姆

我认为发送原始字节很可能会奏效，但最后我选择将 NSData 转换为 base64 NSString 并发送它。

效果很好！

**PS>**有人可以给我一些代表吗？我想参与更多，但没有人对我发布的任何内容进行投票。

这是我的个人资料以及我的 2 或 3 个其他问题：[https ://stackoverflow.com/users/1014983/matthys-du-toit](https://stackoverflow.com/users/1014983/matthys-du-toit)

# android - 在不安装的情况下向启动器添加图标

> ID：15483916
> 
> 赞同：0
> 
> 时间：2013-03-18T18:12:48.273
> 
> 标签：android, android-launcher

我有一些我想在启动器上显示的应用程序。当我点击它时，它应该说应用程序未安装。那可能吗 ？我检查`AllAppsList.java`了 ICS 。我认为我们需要为此提供`ApplicationInfo`对象。有没有替代品？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T18:26:59.510

如果我错了，请纠正我。

据我了解，除非**您控制启动器**本身，否则这是不可能的。启动器会将清单中包含“android.intent.action.MAIN”和“android.intent.category.LAUNCHER”的应用添加到应用抽屉。

如果有一种向启动器应用程序抽屉添加快捷方式的好方法，我很确定广告网络会使用它在那里注入广告。

我想您最可行的选择是在主屏幕上创建快捷方式。

如果您设法找到解决方案，尽管它会很棒。

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T18:32:24.877

这*是*不可能的。除非我误解了这个问题。也许制作一个完全独立的应用程序，具有相同的名称和相同的图标，但不是其中的任何内容，而是将其链接到*整个*应用程序所在的市场；或类似的规定。

# wcf - 如何使服务运行具有所有必要的代码？

> ID：15483921
> 
> 赞同：0
> 
> 时间：2013-03-18T18:13:04.320
> 
> 标签：wcf, web-services

我继承了一些包含服务引用的代码。我意识到引用指向的服务器已被删除。我仍然有包含 .svc 文件的代码。我想这一定是一种 WCF 服务，我需要在另一台服务器上恢复它，但我不知道该怎么做。

正如我所说，代码包括一个 svc 文件，还有`Web.config`, `Web.Debug.config`, `Web.Release.config`, 一个项目文件和一些源文件。

*使用 web.config 更新问题*

```
 <serviceHostingEnvironment multipleSiteBindingsEnabled="true" >

  <serviceActivations>
    <add relativeAddress="ExcelConversionService.svc" 

         service="MyDomain.FileServices.ExcelConversionService"/>
  </serviceActivations>

</serviceHostingEnvironment> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T18:37:30.530

您可以在 IIS 中托管此服务。请查看以下 MSDN 参考资料

[http://msdn.microsoft.com/en-us/library/aa751792.aspx](http://msdn.microsoft.com/en-us/library/aa751792.aspx)

[http://msdn.microsoft.com/en-us/library/ms734710.aspx](http://msdn.microsoft.com/en-us/library/ms734710.aspx)

更实用的示例可在

[http://www.codeproject.com/Articles/150066/Create-Host-Self-Hosting-IIS-hosting-and-Consume-W](http://www.codeproject.com/Articles/150066/Create-Host-Self-Hosting-IIS-hosting-and-Consume-W)

# android - 使用 android youtube 播放器时出错

> ID：15483926
> 
> 赞同：0
> 
> 时间：2013-03-18T18:13:11.690
> 
> 标签：android, youtube

我正在尝试在我的应用程序中使用 android youtube 播放器： [https](https://code.google.com/p/android-youtube-player/) ://code.google.com/p/android-youtube-player/ 但在手机上运行时出现错误：

```
java.lang.NoClassDefFoundError: com.keyes.youtube.OpenYouTubePlayerActivity 
```

这是我写的：

```
String urlStr= "http://www.youtube.com/user/armadamusic ";
Uri uri = Uri.parse(urlStr);
Intent lVideoIntent = new Intent(null, Uri.parse("ytpl://"+uri), this, OpenYouTubePlayerActivity.class);
startActivity(lVideoIntent); 
```

问题是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T18:16:20.360

对于 OpenYouTubePlayerActivity，您需要将 Activity 添加到您的 AndroidManifest.xml：

```
<activity android:name="com.keyes.youtube.OpenYouTubePlayerActivity" /> 
```

# java - 调试由 AVL 树支持的地图？

> ID：15483927
> 
> 赞同：0
> 
> 时间：2013-03-18T18:13:16.110
> 
> 标签：java, data-structures, tree, maps, avl-tree

这是我用来解析文本并打印出每个唯一单词、它出现的行号以及它出现的次数的三棵树之一。我已经使用了哈希和树图，并且它们都可以正常工作。我的导师说我们需要为第三张地图使用 AVL 树并给了我们代码。这是我不确定去哪里的地方。我将包括创建/填充 AVL 地图以及 AVL 地图类的方法。如果需要更多代码，我很乐意将其包含在内。

```
 public void avlMap(String fileName){

    //try/catch block to check for invalid file name
    try{
        //creates new bufferedreader object for input file
        BufferedReader inFile = new BufferedReader(new FileReader(fileName));

        //creates new treeMap object named avlMap
        Map avlMap = new AvlMap();
        String oneLine;

        //Read the words and add them to the avlMap
        for (int lineNum = 1; (oneLine = inFile.readLine()) != null; lineNum++){
            String delims = " !@#$%{}[]/^&*,.()-;:\'\"\t";
            StringTokenizer st = new StringTokenizer(oneLine, delims);
            while (st.hasMoreTokens()){
                String word = st.nextToken();
                WordStats stats = (WordStats) avlMap.get(word);

                //if WordStats is empty/doesnt exist,
                //if exists, adds line numbers into a WordStats in the value
                //...field for the int's respective key
                if (stats == null){
                    stats = new WordStats();
                    avlMap.put(word, stats);
                }
                //WordStats already exists for the word
                //calls addOccurrence method and adds the line number
                stats.addOccurrence(new Integer(lineNum));  
            }
        }

        //creates a new iterator object to iterate entries
        Iterator itr = avlMap.entrySet().iterator();

        //runs printEntry for each key in the treeMap
        while (itr.hasNext()){
            printEntry((Map.Entry) itr.next());
        }
    }
        //the file name used wasn't able to be reached
        catch(IOException e){
            e.printStackTrace();
        }
} 
```

AvlMap 类。我知道这很长，但这些方法似乎与我一直在使用的其他地图类几乎相同。

```
 public class AvlMap <AnyType extends Comparable<? super AnyType>> implements Map 
    {
    //construct the tree
    public AvlMap( ){
        root = null;
    }

    //inserts object into the map
    public void insert( AnyType x, AnyType y ){
        root = insert( x, y, root );
    }

    //removes the key from the map
    public void remove( AnyType x ){
        root = remove( x, root );
    }

    //internal method to remove from a subtree
    private AvlNode<AnyType> remove( AnyType x, AvlNode<AnyType> t ){
        if( t == null )
            return t;   // Item not found; do nothing

        int compareResult = x.compareTo( t.key );

        if( compareResult < 0 )
            t.left = remove( x, t.left );
        else if( compareResult > 0 )
            t.right = remove( x, t.right );
        else if( t.left != null && t.right != null ) // Two children
        {
            t.key = findMin( t.right ).key;
            t.right = remove( t.key, t.right );
        }
        else
            t = ( t.left != null ) ? t.left : t.right;
        return balance( t );
    }

    //returns the smallest item in the tree
    public AnyType findMin( ){
        if( isEmpty( ) )
            throw new UnderflowException("Error" );
        return findMin( root ).key;
    }

    //returns the largest item in the tree
    public AnyType findMax( ){
        if( isEmpty( ) )
            throw new UnderflowException("Error" );
        return findMax( root ).key;
    }

    //finds the provided item in the tree
    public boolean contains( AnyType key ){
        return contains( key, root );
    }

    //make the tree empty
    public void makeEmpty( ){
        root = null;
    }

    //tests if the tree is empty
    public boolean isEmpty( ){
        return root == null;
    }

    //prints the tree in sorted order
    public void printTree( ){
        if( isEmpty( ) )
            System.out.println( "Empty tree" );
        else
            printTree( root );
    }

    private static final int ALLOWED_IMBALANCE = 1;

    // Assume t is either balanced or within one of being balanced
    private AvlNode<AnyType> balance( AvlNode<AnyType> t )
    {
        if( t == null )
            return t;

        if( height( t.left ) - height( t.right ) > ALLOWED_IMBALANCE )
            if( height( t.left.left ) >= height( t.left.right ) )
                t = rotateWithLeftChild( t );
            else
                t = doubleWithLeftChild( t );
        else
        if( height( t.right ) - height( t.left ) > ALLOWED_IMBALANCE )
            if( height( t.right.right ) >= height( t.right.left ) )
                t = rotateWithRightChild( t );
            else
                t = doubleWithRightChild( t );

        t.height = Math.max( height( t.left ), height( t.right ) ) + 1;
        return t;
    }

    //checks the trees balance
    public void checkBalance( ){
        checkBalance( root );
    }

    //driver for checking the trees balance
    private int checkBalance( AvlNode<AnyType> t ){
        if( t == null )
            return -1;

        if( t != null )
        {
            int hl = checkBalance( t.left );
            int hr = checkBalance( t.right );
            if( Math.abs( height( t.left ) - height( t.right ) ) > 1 ||
                    height( t.left ) != hl || height( t.right ) != hr )
                System.out.println( "OOPS!!" );
        }

        return height( t );
    }

    //method to insert into a subtree
    private AvlNode<AnyType> insert( AnyType key, AnyType value, AvlNode<AnyType> t ){
        if( t == null )
            return new AvlNode<>( key, value, null, null );

        int compareResult = key.compareTo( t.key );

        if( compareResult < 0 )
            t.left = insert( key, value,t.left );
        else if( compareResult > 0 )
            t.right = insert( key, value, t.right );
        else
            ;  // Duplicate; do nothing
        return balance( t );
    }

    //returns the smallest item in a subtree
    private AvlNode<AnyType> findMin( AvlNode<AnyType> t )
    {
        if( t == null )
            return t;

        while( t.left != null )
            t = t.left;
        return t;
    }

    //finds the largest item in a subtree
    private AvlNode<AnyType> findMax( AvlNode<AnyType> t ){
        if( t == null )
            return t;

        while( t.right != null )
            t = t.right;
        return t;
    }

    //finds an item in a subtree
    private boolean contains( AnyType x, AvlNode<AnyType> t ){
        while( t != null ){
            int compareResult = x.compareTo( t.key );

            if( compareResult < 0 )
                t = t.left;
            else if( compareResult > 0 )
                t = t.right;
            else
                return true;    // Match
        }
        return false;   // No match
    }

    //prints the subtree in sorted order
    private void printTree( AvlNode<AnyType> t ){
        if( t != null ){
            printTree( t.left );
            System.out.println( t.key + " " + t.value );
            printTree( t.right );
        }    
    }

    //returns the height of node t or -1 if null
    private int height( AvlNode<AnyType> t ){
        return t == null ? -1 : t.height;
    }

    //rotates tree node with left child
    private AvlNode<AnyType> rotateWithLeftChild( AvlNode<AnyType> k2 ){
        AvlNode<AnyType> k1 = k2.left;
        k2.left = k1.right;
        k1.right = k2;
        k2.height = Math.max( height( k2.left ), height( k2.right ) ) + 1;
        k1.height = Math.max( height( k1.left ), k2.height ) + 1;
        return k1;
    }

    //rotates tree node with right child
    private AvlNode<AnyType> rotateWithRightChild( AvlNode<AnyType> k1 ){
        AvlNode<AnyType> k2 = k1.right;
        k1.right = k2.left;
        k2.left = k1;
        k1.height = Math.max( height( k1.left ), height( k1.right ) ) + 1;
        k2.height = Math.max( height( k2.right ), k1.height ) + 1;
        return k2;
    }

    //double rotates tree node.  first left child with its right child, then 
    //...node k3 with new left child.
    private AvlNode<AnyType> doubleWithLeftChild( AvlNode<AnyType> k3 ){
        k3.left = rotateWithRightChild( k3.left );
        return rotateWithLeftChild( k3 );
    }

    //double rotates tree node.  first right child with its left child, then
    //...node k1 with new right child
    private AvlNode<AnyType> doubleWithRightChild( AvlNode<AnyType> k1 ){
        k1.right = rotateWithLeftChild( k1.right );
        return rotateWithRightChild( k1 );
    }

    private static class AvlNode<AnyType>{
            // Constructors
        @SuppressWarnings("unused")
        AvlNode( AnyType theKey, AnyType theValue ){
            this( theKey, theValue, null, null );
        }

        AvlNode( AnyType theKey, AnyType theValue, AvlNode<AnyType> lt, AvlNode<AnyType> rt ){
            key  = theKey;
            value = theValue;
            left     = lt;
            right    = rt;
            height   = 0;
        }

        AnyType           key;      // The data in the node
        AnyType           value;
        AvlNode<AnyType>  left;         // Left child
        AvlNode<AnyType>  right;        // Right child
        int               height;       // Height
    }

    //trees root
    private AvlNode<AnyType> root;

    //implemented methods for AvlTreeMap
    @Override
    public void clear() {
        makeEmpty();    
    }

    @SuppressWarnings("unchecked")
    @Override
    public boolean containsKey(Object key) {
        contains ((AnyType)key);

        return false;
    }

    @SuppressWarnings("unchecked")
    @Override
    public boolean containsValue(Object value) {
        contains ((AnyType)value);
        return false;
    }

    @Override
    public Set entrySet() {
        return null;
    }

    @Override
    public Object get(Object key) {
        return key;
    }

    @Override
    public Set keySet() {
        return null;
    }

    @SuppressWarnings("unchecked")
    @Override
    public Object put(Object key, Object value) {
        insert ((AnyType)key, (AnyType) value);

        return true;
    }

    @Override
    public void putAll(Map m) {
    }

    @SuppressWarnings("unchecked")
    @Override
    public Object remove(Object key) {
        remove ((AnyType)key);
        return null;
    }

    @Override
    public int size() {
        return 0;
    }

    @Override
    public Collection values() {
        return null;
    }
    } 
```

这是我的 WordStats 类，它将所有内容保存到一个集合中并保持发生。

```
 import java.util.SortedSet;
    import java.util.TreeSet;

    public class WordStats {
private int occurrences;
private SortedSet<Integer> lineNumbers = new TreeSet<Integer>();

public void addOccurrence(int lineNumber){
    occurrences++;
    lineNumbers.add(lineNumber);
}

public int getOccurrences(){
    return occurrences;
}

public SortedSet<Integer> getLines(){
    return lineNumbers;
}
    } 
```

当我运行程序时，我收到错误：

> 线程“main”中的异常`java.lang.ClassCastException`：
> 
> `java.lang.String`不能转换为`WordStats`
> 
> 在`driver1.avlMap(driver1.java:182)`
> 
> 在`driver1.main(driver1.java:36)`

提前感谢您提供的任何见解。也没有任何编译器错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T19:41:19.567

如堆栈跟踪中所述，此问题的根本原因是您试图将 type 对象强制`String`转换为 type `WordStats`。我认为这发生在这一行：

```
WordStats stats = (WordStats) avlMap.get(word); 
```

那么让我们来看看`avlMap.get(word)`。这看起来如下：

```
@Override
public Object get(Object key) {
    return key;
} 
```

所以这是有问题的 - 看起来每次您尝试查找时，您只是返回您试图在地图中查找的键！这可以解释转换错误 - 你传入 a `String`into `avlMap.get()`，然后返回它。当您尝试将其转换为 a`WordStats`时，您会收到一个错误，因为 a`String`不是 a `WordStats`。

要解决此问题，我认为您需要您的`get`方法来实际在 AVL 树中进行搜索并进行查找。我会把这个留给你自己完成。我**强烈**建议不要尝试将您的地图集成到更大的程序中，直到您对其进行更彻底的测试 - 将处理单词的所有逻辑都放在有缺陷的 AVL 树之上，这将使调试变得非常困难，如果不是不可能的话。尝试为您的 AVL 树编写一些单元测试，看看它是否有效。您还可以考虑在此期间将您的 AVL 树图换成正常`TreeMap`的，以查看驱动程序代码是否有效。

另请注意 - 您应该**强烈**考虑不实现原始类型`Map`，而是`Map`通过键和值类型实现参数化。这使界面方式更易于使用，并有助于捕获您遇到的错误。

希望这可以帮助！

# flash - clickTAG - 如此简单 - 但不起作用

> ID：15483928
> 
> 赞同：0
> 
> 时间：2013-03-18T18:13:17.190
> 
> 标签：flash, embed, clicktag

好的 - 这让我发疯了！我的一个客户要求使用 Adob​​e 自己共享的旧解决方案将快速 clickTAG 添加到横幅中。

[http://www.adobe.com/resources/richmedia/tracking/designers_guide/](http://www.adobe.com/resources/richmedia/tracking/designers_guide/)

很容易。我将 AS 应用于按钮符号：

```
on (release) {
if (clickTAG.substr(0,5) == "http:") {
getURL(clickTAG);
}
} 
```

然后做了一个简单的 EMBED src 来测试它：

```
<EMBED src="ad_banner_example.swf?clickTAG=http://www.destinationURL.com"> 
```

没事了。我进行了跟踪以确保按钮符号有效 - 一切都很好。这又让我发疯了。

发表：

播放器 7 AS 2.0

* * *

任何帮助，将不胜感激

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-13T09:53:47.677

只能通过广告服务平台检查 clickTag 是否正常工作。每个广告服务器都使用特定格式的 clickTag 代码，因此确保您的代码正确的唯一真正方法是通过他们使用的广告服务器对横幅进行投放和测试。恐怕您可以从 Flash 本身做的最多的事情是运行跟踪以确保 clickTag 按钮正在触发

# android - HTML5 FileSystem API Android Chrome 访问 sdcard

> ID：15483936
> 
> 赞同：4
> 
> 时间：2013-03-18T18:13:49.747
> 
> 标签：android, html, google-chrome, filesystems, html5-filesystem

我正在尝试创建一个能够访问大量文件的 HTML5 应用程序。因此，我查看了 FileSystem API 以便能够从本地文件系统读取文件。

我使用 phonegap File API 做了一个 PoC，一切都按预期工作，我能够使用 Chrome 桌面上的 FileSystem API 产生类似的结果......

但是我面临一个严重的问题，虽然我可以在 Desktop 中访问我的文件系统，但我无法从 Android Chrome 访问 sdcard。我尝试使用这个演示：

[http://html5-demos.appspot.com/static/filesystem/filer.js/demos/index.html](http://html5-demos.appspot.com/static/filesystem/filer.js/demos/index.html)

我可以在桌面上从本地系统中选择文件：我的图片等...但我不能用 Android Chrome 做同样的事情

如何在 Android Chrome 中访问设备文件系统 /sdcard？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-18T20:17:54.707

从[这篇关于 HTML5 Rocks 的文章](http://www.html5rocks.com/en/tutorials/file/filesystem/)：

*重要的是要记住这个文件系统是沙盒的，这意味着一个 Web 应用程序无法访问另一个应用程序的文件。这也意味着您无法将文件读/写到用户硬盘上的任意文件夹（例如我的图片、我的文档等）。*

FileSystem API 旨在允许您的应用程序创建和操作将在您的应用程序使用之间持续存在的文件。它不能用于从其沙箱外部公开任意文件。

或者，[文件 API](http://www.html5rocks.com/en/tutorials/file/dndfiles/)可用于从整个系统读取文件，但不能修改文件。但是，File API 不能用于读取系统上的任意文件。它的使用基于 HTMLs`<input type=file>`标签，用户必须明确输入要读取的文件。

以上适用于在 Android Chrome 中运行的应用程序与在桌面 Chrome 中运行的应用程序相同，因此除非用户愿意使用输入来授予对所需文件的访问权限，否则您就不走运了。但是，您提到您还尝试了使用 PhoneGap 的 PoC。[PhoneGap File API](http://docs.phonegap.com/en/2.5.0/cordova_file_file.md.html)虽然主要充当 HTML5 实现的包装器，但有一些细微的差别，主要是它允许访问 SD 卡上的任意文件。使用 API 调用`window.requestFileSystem()`时，您的成功回调将有一个参数，即[FileSystem](http://docs.phonegap.com/en/2.5.0/cordova_file_file.md.html#FileSystem)对象，其中`root`属性是对 /sdcard 文件夹的引用。这可用于遍历您的 sdcard 并在其中的任何位置创建 FileReaders 和 FileWriters。

# c# - 单选按钮：我如何从数据库中检索数据

> ID：15483939
> 
> 赞同：0
> 
> 时间：2013-03-18T18:14:02.740
> 
> 标签：c#, ms-access

访问 2003 分贝

```
Field Name          Data Type  
CriminalOffence     Text 
```

VS 2010 C#

使用组框，我可以将单选按钮中的数据存储到我的数据库中。我已将组框和单选按钮数据绑定到我的数据库。当我使用我的导航按钮时，我会看到已存储在组框文本所在的位置的数据。所以问题是我不知道如何正确检索单选按钮的数据。从文本框和组合框检索数据显示为应有的状态。此外，当我想插入新数据时，单选按钮不会被清除。所以...

我有两个名为的单选按钮，1) rBYes 2) rBNo

我有以下插入记录的方法...

```
private void btnInsert_Click(object sender, EventArgs e)
    {
        OleDbCommand cmd = new OleDbCommand(@"INSERT INTO Table1
                                    (ID, AgeGroup, Gender, CriminalOffence)   
                              VALUES(@txtID, @AcBAG, @cBGender, @CriminalOffence)", myCon);
        cmd.CommandType = CommandType.Text;

        cmd.Parameters.AddWithValue("@ID", txtID.Text);
        cmd.Parameters.AddWithValue("@AgeGroup", cBAG.Text);
        cmd.Parameters.AddWithValue("@Gender", cBGender.Text);

        string str = "";
        if (rBYes.Checked)
        {
            str = "Yes";
        }
        if (rBNo.Checked)
        {
            str = "No";
        }
        cmd.Parameters.AddWithValue("@CriminalOffence", SqlDbType.NVarChar).Value =   
        str;
    } 
```

以及创建新记录的方法

```
 private void btnNew_Click(object sender, EventArgs e)
    {
        txtID.Text = "";
        cBAG.Text = "";
        cBGender.Text = "";
        rBYes.Text = "";
        rBNo.Text = "";
    } 
```

导航按钮的示例..

```
 private void btnNextRec_Click(object sender, EventArgs e)
    {
        this.table1BindingSource.MoveNext();
    } 
```

连接字符串...

```
 myCon = new OleDbConnection(@"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:\..
    \Database1.mdb"); 
```

请有人可以在这里帮助我，在此先感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T20:36:28.733

参数名称必须与 SQL 插入语句中的参数匹配。

```
private void btnInsert_Click(object sender, EventArgs e)
{
  OleDbCommand cmd = new OleDbCommand(@"INSERT INTO Table1
                                        (ID, AgeGroup, Gender, CriminalOffence)   
                                  VALUES(@ID, @AgeGroup, @Gender, @CriminalOffence)", myCon);
  cmd.CommandType = CommandType.Text;

  cmd.Parameters.AddWithValue("@ID", txtID.Text);
  cmd.Parameters.AddWithValue("@AgeGroup", cbAG.Text);
  cmd.Parameters.AddWithValue("@Gender", cbGender.Text);
  cmd.Parameters.AddWithValue("@CriminalOffence", ((rBYes.Checked)? "Yes":"No"));

  myCon.Open();
  cmd.ExecuteNonQuery();
  myCon.Close(); 
} 
```

# jquery - IE fake text-shadow 与其文本分开流动

> ID：15483944
> 
> 赞同：0
> 
> 时间：2013-03-18T18:14:25.950
> 
> 标签：jquery, html, css, internet-explorer, polyfills

我一直在使用 jQuery 和 IE 过滤器在 IE<=9 中创建阴影，以弥补缺失的`text-shadow`属性。这可以[在此站点](http://area11aa.ie)`h2`的页面顶部标题中看到，它在不支持 text-shadow 属性（由 检测）的浏览器上使用 jQuery 来复制元素内的文本...`modernizr``h2`

```
jQuery(".no-textshadow h1, .no-textshadow h2").each(function(){
  var text_shadow_markup = jQuery(this).html();
  jQuery(this).append("<span class='shadow'>"+text_shadow_markup+"</span>");
}); 
```

...使用此 CSS 进行样式设置的位置（由此[IE 投影技术](http://kilianvalkhof.com/2008/design/almost-cross-browser-text-shadow/)提供）：

```
@media only screen and (min-width: 768px) {
  h2 {
    text-shadow: #000000 0px 5px 5px;
    position: relative;
    zoom: 1;
    z-index: 1;
  }
  h2 span.shadow {
    color: #000000;
    position: absolute;
    left: -7px;
    top: -2px;
    z-index: -1;
    zoom: 1;
    filter: progid:DXImageTransform.Microsoft.Glow(Color=#000000,Strength=2) progid:DXImageTransform.Microsoft.blur(pixelradius=5,enabled='true');
    -ms-filter: "progid:DXImageTransform.Microsoft.Glow(Color=#000000,Strength=2) progid:DXImageTransform.Microsoft.blur(pixelradius=5,enabled='true')";
  }
} 
```

***问题是：***阴影的流动独立于它们背后的文字。在 IE8 和 IE9 中，您始终可以通过缓慢更改窗口宽度直到其中一个阴影从其文本中弹出来看到这一点。

我不明白如果阴影`span`绝对定位在`h2`元素的包含框中会发生这种情况。然而，它们能够像没有附着一样流动。我意识到这可能是一个浏览器错误，因此我会很高兴支持 IE8 和 IE9 的解决方法，如果有人可以指出我上面的应用程序的任何问题，我会很高兴。

ps，我听说[CSS Sandpaper text-shadow](http://www.useragentman.com/blog/2011/06/29/full-css3-text-shadows-even-in-ie)实现了类似的技术，如果这是处理上述问题的公认最佳实践方式，我会接受某人的认可。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T22:11:09.250

这个问题已[在 SitePoint 上的这个线程中](http://www.sitepoint.com/forums/showthread.php?1019054-IE-simulated-text-shadow-flows-separately-from-its-text)重新表述和讨论。现在通过以下两个更改在上面列出的实时站点上解决了该问题：

1) To keep the line length the same, a right padding must be added to the superimposed (shadow) element that matches the left positioning offset, as in:

```
h2 span.shadow { ...
  left: -7px;
  padding-right: 7px; ... 
```

2) The superimposed (shadow) `<span>` must be moved inside the `<a>` and given a new stacking context, by changing the jQuery selector above to:

```
jQuery(".no-textshadow h1 a, .no-textshadow h2 a").each(function(){ 
```

and adding this CSS:

```
h2 a {
  display: block;
  zoom: 1.0;
  position: relative;
} 
```

I am still uncertain why (2) is necessary (or sufficient). There are some clues on the design page for [jQuery Textshadow](http://heygrady.com/blog/2011/03/10/css-text-shadows-in-internet-explorer) (this plugin was agreed to be a best-practice solution, to answer part of the original question). The two sections for [Glow](http://heygrady.com/blog/2011/03/10/css-text-shadows-in-internet-explorer#glow) and [Blur](http://heygrady.com/blog/2011/03/10/css-text-shadows-in-internet-explorer#blur) describe adjustments that must be made to element positioning, as well as nested `<span>` elements each creating a new stacking context.

I would be open to other solutions & explanations and hope this helps anyone having the same problem.

# android - 为什么在渲染器线程以外的线程上实例化后不绘制线条？

> ID：15483945
> 
> 赞同：-1
> 
> 时间：2013-03-18T18:14:26.793
> 
> 标签：android, opengl-es-2.0

我正在 Android 上使用 OpenGL ES 2.0 制作 2D 游戏，以此作为学习很多东西的借口。我画了很多线来制作一个网格，但是设置一切都需要时间，我想在设置稍后绘制的对象时渲染一个加载屏幕。

在尝试解决这个问题时，我遇到了一个我无法理解的问题，所以我的问题是为什么我会看到这种行为。

**编码：**

这是其实例将代表每一行的类：

这只是我在网上找到的一个稍作修改的示例。对 Thread.sleep 的调用只是为了增加创建它所需的时间，以便我可以显示我面临的问题。

```
import java.nio.ByteBuffer;
import java.nio.ByteOrder;
import java.nio.FloatBuffer;

import android.opengl.GLES20;

public class LineExample {

    private final String vertexShaderCode =
                "attribute vec4 vPosition;" +
                "void main() {" +
                "   gl_Position = vPosition;" +
                "}";

    private final String fragmentShaderCode =
                "precision mediump float;" +
                "void main() {" +
                "  gl_FragColor = vec4(0.0, 0.0, 1.0, 1.0);" +
                "}";

    private int mProgram;
    private FloatBuffer vertexBuffer;
    private ByteBuffer bb;

    // number of coordinates per vertex in this array
    static final int COORDS_PER_VERTEX = 2;
    private final int vertexStride = COORDS_PER_VERTEX * 4; // bytes per vertex
    private float lineCoords[] = new float[2*COORDS_PER_VERTEX];
    private int vertexCount = lineCoords.length / COORDS_PER_VERTEX;

    public LineExample(float[] lineCoords) {

        try {
            Thread.sleep(5000);
        } catch (InterruptedException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

        this.lineCoords = lineCoords;

        // initialize vertex byte buffer for shape coordinates
        bb = ByteBuffer.allocateDirect(
        // (# of coordinate values * 4 bytes per float)
                lineCoords.length * 4);
        bb.order(ByteOrder.nativeOrder());
        vertexBuffer = bb.asFloatBuffer();
        vertexBuffer.put(lineCoords);
        vertexBuffer.position(0);

        // prepare shaders and OpenGL program
        int vertexShader = loadShader(GLES20.GL_VERTEX_SHADER,
                                                   vertexShaderCode);
        int fragmentShader = loadShader(GLES20.GL_FRAGMENT_SHADER,
                                                     fragmentShaderCode);

        mProgram = GLES20.glCreateProgram();             // create empty OpenGL Program
        GLES20.glAttachShader(mProgram, vertexShader);   // add the vertex shader to program
        GLES20.glAttachShader(mProgram, fragmentShader); // add the fragment shader to program
        GLES20.glLinkProgram(mProgram);                  // create OpenGL program executables

    }

    public void draw() {

        // Add program to OpenGL environment
        GLES20.glUseProgram(mProgram);

        // get handle to vertex shader's vPosition member
        int mPositionHandle = GLES20.glGetAttribLocation(mProgram, "vPosition");

        // Enable a handle to the triangle vertices
        GLES20.glEnableVertexAttribArray(mPositionHandle);

        // Prepare the triangle coordinate data
        GLES20.glVertexAttribPointer(mPositionHandle, COORDS_PER_VERTEX,
                                     GLES20.GL_FLOAT, false,
                                     vertexStride, vertexBuffer);

        // Draw
        GLES20.glDrawArrays(GLES20.GL_LINES, 0, vertexCount);

        // Disable vertex array
        GLES20.glDisableVertexAttribArray(mPositionHandle);
    }

    private static int loadShader(int type, String shaderCode){

        // create a vertex shader type (GLES20.GL_VERTEX_SHADER)
        // or a fragment shader type (GLES20.GL_FRAGMENT_SHADER)
        int shader = GLES20.glCreateShader(type);

        // add the source code to the shader and compile it
        GLES20.glShaderSource(shader, shaderCode);
        GLES20.glCompileShader(shader);

        return shader;
    }

} 
```

这是渲染器：

```
public class MyRenderer2 implements Renderer {

    LineExample currentLineToRender = null;

    @Override
    public void onDrawFrame(GL10 unused) {
        GLES20.glClear(GLES20.GL_COLOR_BUFFER_BIT);
        if (currentLineToRender!=null){
            currentLineToRender.draw();
        }
    }

    @Override
    public void onSurfaceCreated(GL10 gl, EGLConfig config) {
        //initializeLines();
        initializeLinesSameThread();
    }

    @Override
    public void onSurfaceChanged(GL10 gl, int width, int height) {
        GLES20.glViewport(0, 0, width, height);
        GLES20.glClearColor(0.0f, 0.0f, 0.0f, 1.0f);
    }

    private void initializeLines(){
        float[] waitingLineVerts = {-0.5f,0.0f , 0.5f,0.0f};
        currentLineToRender = new LineExample(waitingLineVerts);
        new Thread(){
            public void run() {
                float[] doneLineVerts = {0.0f,-0.5f , 0.0f,0.5f};
                currentLineToRender = new LineExample(doneLineVerts);
            }
        }.start();
    }

    private void initializeLinesSameThread(){
        float[] waitingLineVerts = {-0.5f,0.0f , 0.5f,0.0f};
        currentLineToRender = new LineExample(waitingLineVerts);
        float[] doneLineVerts = {0.0f,-0.5f , 0.0f,0.5f};
        currentLineToRender = new LineExample(doneLineVerts);
    }

} 
```

目标是在 5 秒内看到一条水平线（类似于加载屏幕），然后看到一条垂直线（类似于实际游戏网格）。但是，使用此代码，我会得到一个黑屏约 10 秒，然后绘制第二条线。

我认为线程正忙于初始化代码，所以它没有绘制第一行，所以为了让它到达**onDrawFrame**方法并绘制第一行，我决定在另一个线程上调用第二行的初始化（通过在**onSurfaceCreated**上调用**initializeLines()**而不是**initializeLinesSameThread()**），但这样做，我只看到第一行，而我永远看不到第二行。

 **我的猜测是，当调用 line 的 draw 方法时，渲染器线程无法访问其他线程中完成的某些事情。

我的问题是为什么会这样？

（如果你能给我一个关于如何实现我想做的事情的建议，我将不胜感激）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T07:43:49.557

通常，您应该在同一个线程中执行所有 OpenGL 调用。否则你会得到意想不到的行为。**

# java - 从套接字逐行读取

> ID：15483948
> 
> 赞同：0
> 
> 时间：2013-03-18T18:14:37.930
> 
> 标签：java, c, sockets

我从 C 中的客户端通过套接字发送线路，并在 Java 中的服务器上读取。我能做到的最好的办法是客户端发送多行，当我关闭客户端时，服务器将所有数据打印在一行中。或者让它先发送然后接收，等等。我的愿望是 C 应用程序在循环中发送“Hi”，Java 文件首先捕获 hi，打印，然后捕获第二个并打印。现在它打印“HiHiHiHi...”，但仅在连接终止时。

我使用[oracle 套接字示例](http://docs.oracle.com/javase/tutorial/networking/sockets/readingWriting.html)作为指南，并使用C 客户端的另一个 [指南](http://www.linuxhowtos.org/C_C++/socket.htm)

所以在Java中读取套接字是：

```
try {
        ServerSocket serverSocket = null;
        try {
            serverSocket = new ServerSocket(port);
        } catch (IOException e) {
            System.err.println("Could not listen on port: 4444.");
            System.exit(1);
        }
        Socket clientSocket = null;
        try {
            clientSocket = serverSocket.accept();
            System.out.println("Connected with client");
        } catch (IOException e) {
            System.err.println("Accept failed.");
            System.exit(1);
        }
        out = new PrintWriter(clientSocket.getOutputStream(), true);
        BufferedReader in = new BufferedReader(new InputStreamReader(clientSocket.getInputStream()));
        String inputLine;

        while ((inputLine = in.readLine()) != null) {
            System.out.println("RECEIVING " + inputLine);
        }
        out.close();
        in.close();
        clientSocket.close();
        serverSocket.close();
    } catch (IOException ex) {
        Logger.getLogger(Connection.class.getName()).log(Level.SEVERE, null, ex);
    } finally {
        out.close();
    } 
```

尝试在 while 循环中将 C 中的相同字符串写入套接字：

```
void connection(void) {
    int sockfd, portno;
    struct sockaddr_in serv_addr;
    struct hostent *server;

    /* Set time limit. */
    timeout.tv_sec = 0;
    timeout.tv_usec = 10;

    portno = 4444;
    sockfd = socket(AF_INET, SOCK_STREAM, 0);

    if (sockfd < 0) 
        error("ERROR opening socket");
    server = gethostbyname("Localhost");
    if (server == NULL) {
        fprintf(stderr,"ERROR, no such host\n");
        exit(0);
    }
    bzero((char *) &serv_addr, sizeof(serv_addr));
    serv_addr.sin_family = AF_INET;
    bcopy((char *)server->h_addr, 
         (char *)&serv_addr.sin_addr.s_addr,
         server->h_length);
    serv_addr.sin_port = htons(portno);
    if (connect(sockfd,(struct sockaddr *)&serv_addr,sizeof(serv_addr)) < 0) 
        error("ERROR connecting");
    while(1)    {
        /* Create a descriptor set containing our two sockets.  */
        FD_ZERO(&fds);
        FD_SET(sockfd, &fds);
        rc = select(sizeof(fds)*8, &fds, NULL, NULL, &timeout);
        if (rc==-1) {
            perror("select failed");
        }
            bzero(buffer,256);
            char *buffer2 = "here";

            n = write(sockfd,buffer2,strlen(buffer2));
            if (n < 0) 
                 error("ERROR writing to socket");

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T18:26:36.113

您的服务器在打印任何内容之前正在等待 \n。

您的客户端没有发送任何 \n 字符。

你可以试试：

```
char *buffer2 = "here"\n; 
```

# plugins - MSCRM 2011 CloseQuoteRequest 离线

> ID：15483951
> 
> 赞同：1
> 
> 时间：2013-03-18T18:14:51.833
> 
> 标签：plugins, outlook, dynamics-crm-2011, offline

我想关闭插件的报价。一切正常在线，但如果我的插件在 Outlook 中离线运行，我会收到一个错误：

**必须填充主键才能在离线模式下在富客户端上调用平台**

我这样关闭引用：

```
CloseQuoteRequest req = new CloseQuoteRequest();
req.QuoteClose = myQuote;
req.Value = new OptionSetValue(6);
service.Execute(req); 
```

我在离线时跟踪了我的插件，并且我的报价 ID 等属性都可以。

有人有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-23T17:27:01.903

解决方案是使用后期绑定的quoteclose实体并提供activityid guid：

```
var item = service.retrieve("quote",quoteid, new columnset(true);
var quoteclose = new Entity("quoteclose");

quoteclose.Attributes.Add("quoteid", item.ToEntityReference());
quoteclose.Attributes.Add("subject", "Quote Closed");
quoteclose.Attributes.Add("description", "Quote Closed");
quoteclose.Attributes.Add("quotenumber", item.Attributes["quotenumber"]);
quoteclose.Attributes.Add("ownerid", item.Attributes["ownerid"]);
quoteclose.Attributes.Add("revision", 0);
quoteclose.Attributes.Add("activityid", Guid.NewGuid());
quoteclose.Attributes.Add("actualend", DateTime.Now);

// Close the quote
CloseQuoteRequest closeQuoteRequest = new CloseQuoteRequest()
{
     QuoteClose = quoteclose,
      Status = new OptionSetValue(5)
};
contextBag.Service.Execute(closeQuoteRequest); 
```

# ruby - Ruby / Rails 与 Delphi 后端一起使用

> ID：15483961
> 
> 赞同：3
> 
> 时间：2013-03-18T18:15:14.067
> 
> 标签：ruby, delphi, firebird

任何人都可以向我指出一些可以帮助我使用 Rails 连接/查询 Delphi 后端（使用 Firebird 数据库）的资源或教程。

另外，关于此设置的一些问题。
Delphi 后端是否比 Rails 后端快？与 ruby​​ 驱动程序相比，Delphi 似乎对连接到 firebird 的支持要好得多。

当前提出请求的最佳选择方法是什么？REST 的东西，还是某种 RPC？或者是其他东西？

由于我们目前是一家 Delphi 商店，我认为使用 delphi 的后端将帮助我们更好地利用现有技能。

任何帮助表示赞赏。

编辑：关于设置的一点点。

所以为了让这个更容易解释，让我们说它本质上是一个 todo 组织者。所以前端将是一个显示每天到期的日历。或者可能列出该信息的视图等。我所说的“后端”将是存储到 Firebird 数据库的东西。然后，RoR 日历站点将请求有关待办事项的信息，或在给定日期或日期范围内的待办事项，也许是有关某些联系人的信息。所有这些都存储在 Firebird 中。

我确实意识到您也可以在 delphi 中做前端部分，但我正试图逐步淘汰 Delphi 以支持更新的语言。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-18T19:04:31.197

AFAIK 运行 RoR 应用程序需要的不仅仅是 RESTful API。

大部分工作都在服务器端完成：MVC 模型、数据持久化、路由等……

使用 Delphi 作为后端将需要大量的工作。

看看一些项目，如果你需要一个在 Delphi 中构建的 RESTful 服务器：

*   Delphi on rails [https://code.google.com/p/delphionrails](https://code.google.com/p/delphionrails)
*   Delphi Web 脚本[https://code.google.com/p/dwscript](https://code.google.com/p/dwscript)
*   德尔福放松[http://code.marcocantu.com/p/delphirelax](http://code.marcocantu.com/p/delphirelax)
*   DataSnap（直接在 Delphi 中）
*   我们的 mORMot 框架[http://mormot.net](http://mormot.net)

都实现了直接连接Firebird，DoR+mORMot+DWS声音有更好的表现。

基于 Delphi 的服务器在所有情况下都将更具响应性。

DoR 更接近 RoR - 正如其名称所示！Delphi Relax 似乎也很接近它（即使我想知道 Marco 是否仍会维护它 - 5 个月没有提交）。DataSnap 更 RAD，并集成在 IDE 中。DWS 有一个新的 DB 后端，以及与 mORMot 相同的高性能 HTTP 服务器。mORMot 具有完整的客户端-服务器 ORM，但 Web 客户端将在 AJAX 中构建 - 首选 SmartMobileStudio。

# symfony - 自定义资产过滤器

> ID：15483963
> 
> 赞同：2
> 
> 时间：2013-03-18T18:15:21.547
> 
> 标签：symfony, assetic

是否可以将具有资产过滤器定义的服务文件作为 YML 文件包含在 config.yml 中？Assetic 期望 XML 结构...

捆绑/资源/config/services.yml：

```
 assetic.filter.csslint:
    class: IOKI\CommonBundle\Assetic\Filter\CssLintFilter
    tags:
        - { name: assetic.filter, alias: csslint} 
```

配置.yml

```
assetic:
    filters:
        csslint:
            resource: %kernel.root_dir%/../src/Project/CommonBundle/Resources/config/services.yml 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-07-30T12:07:13.417

[针对 Assetic的相关问题](https://github.com/symfony/AsseticBundle/issues/50)中的讨论意味着您可以将`resource`密钥指向任意 XML 文件（那里使用的示例`'assetic.xml'`，然后可以正常指定您的过滤器`services.yml`。

（我发现这只有在我清除 Symfony 缓存并在我的浏览器中进行“硬刷新”时才有效——直到我尝试这对我真正有效。）

此外，如果您只想直接从模板而不是 in 引用您的过滤器`config.yml`，则根本不需要在 in 中提及它`config.yml`。你可以像你一样指定你的过滤器`services.yml`，然后在 Twig 中引用它。例如：

```
{% stylesheets
   'bundles/boardworksapp/less/custom.less' filter='csslint'
%}
   <link rel="stylesheet" href="{{ asset_url }}" />
{% endstylesheets %} 
```

# scala - 如何将自定义包导入 Scala Play！框架 2.0

> ID：15483966
> 
> 赞同：1
> 
> 时间：2013-03-18T18:15:28.370
> 
> 标签：scala, playframework-2.0

我正在玩游戏！在 sublime 文本编辑器上使用 Scala 的 Framework 2.0。我想创建一些自定义助手，它们只是与控制器或目标相关的一些方法。所以我在“app”目录中创建了一个名为“helpers”的文件夹，例如我有一个名为 SiteHelper.scala 的助手

在 /app/helpers/SiteHelper.scala 我开始

```
package helpers

class SiteHelper {

   def method() = {}

} 
```

现在在我的控制器中，我希望能够做到这一点：`import helpers.SiteHelper`

然后在我的控制器中使用该方法：`SiteHelper.method()`

当我尝试这个时，我得到一个编译错误：“未找到：值 SiteHelper”

如何在我的控制器中使用我的助手类？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-18T21:22:16.117

看来您想使用对象而不是类

```
package helpers

object SiteHelper {

 def method() = {}
} 
```

然后在你的控制器中：

```
import helpers.SiteHelper

object MyConstroller {
  SiteHelper.method()
} 
```

# vb.net - 显示剩余时间 TimeSpan

> ID：15483978
> 
> 赞同：0
> 
> 时间：2013-03-18T18:16:18.977
> 
> 标签：vb.net, visual-studio, datetime, timer, timespan

我在尝试显示操作的剩余时间时遇到问题

问题仅在于剩余的计时器，我得到一个负值......

这是一个 10000 毫秒（10 秒）的操作示例：

![在此处输入图像描述](../Images/2d2bb45d417d33e0175ab047fcbd0f49.png)

所以无论如何，如果我从时间跨度中删除“-”字符，小时和分钟仍然不正确的值......

```
 Dim time_out as integer = 60000 ' 'Milisegundos

   Dim StartTime As DateTime ' Tiempo inicio
   Dim EndTime As DateTime ' Tiempo final

   Dim ElapsedTime As TimeSpan ' Tiempo transcurrido
   Dim RemainingTime As TimeSpan ' Tiempo restante

    ' Elapsed Time
#Region " Elapsed Time Function "

    Public Function Print_Elapsed_Time()
        If StartTime.ToString = "01/01/0001 0:00:00" Then
            StartTime = Now
            StartTime = StartTime.AddSeconds(-1)
        End If
        ElapsedTime = Now().Subtract(StartTime)
        Return String.Format("{0:00}:{1:00}:{2:00}", CInt(Math.Floor(ElapsedTime.TotalHours)) Mod 60, CInt(Math.Floor(ElapsedTime.TotalMinutes)) Mod 60, CInt(Math.Floor(ElapsedTime.TotalSeconds)) Mod 60)
    End Function
#End Region

#Region " Remaining Time Function "

    Public Function Print_Remaining_Time()
        If EndTime.ToString = "01/01/0001 0:00:00" Then
            EndTime = Now
            EndTime = EndTime.AddMilliseconds(Time_Out - 1000)
        End If
        RemainingTime = Now().Subtract(EndTime)
        Return String.Format("{0:00}:{1:00}:{2:00}", CInt(Math.Floor(RemainingTime.TotalHours)) Mod 60, CInt(Math.Floor(RemainingTime.TotalMinutes)) Mod 60, CInt(Math.Floor(RemainingTime.TotalSeconds)) Mod 60).Replace("-", "")
    End Function

#End Region 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T18:35:03.563

这是使用计时器和两个标签从 10 秒开始倒计时的示例

```
'example - countdown from 10 secs
Dim countdown As New TimeSpan(0, 0, 10)
Dim stpw As New Stopwatch

Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
    If stpw.IsRunning Then
        stpw.Stop()
        Timer1.Stop()
    Else
        stpw.Stop()
        stpw.Reset()
        stpw.Start()
        Timer1.Interval = 100
        Timer1.Start()
    End If
End Sub

Private Sub Timer1_Tick(sender As Object, e As EventArgs) Handles Timer1.Tick
    'label1 - elapsed time
    'label2 - time remaining
    If stpw.Elapsed <= countdown Then
        Label1.Text = stpw.Elapsed.ToString
        Label2.Text = (countdown - stpw.Elapsed).ToString
    Else
        stpw.Stop()
        Label1.Text = countdown.ToString
        Label2.Text = "00:00:00"
    End If
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T18:38:21.967

我认为你想要的结束时间：

```
RemainingTime = EndTime.Subtract(Now) 
```

否则，我不确定你是如何初始化这些的，但我做了这个改变：

```
Dim StartTime As DateTime = DateTime.MinValue ' Tiempo inicio
Dim EndTime As DateTime = DateTime.MinValue ' Tiempo final 
```

并且 ：

```
If StartTime = DateTime.MinValue Then  ' ... etc   ' 
```

但也许一个标志或其他东西完全是一种更好的方式来发出复位信号。

# javascript - 如何获取json返回值

> ID：15483980
> 
> 赞同：2
> 
> 时间：2013-03-18T18:16:30.037
> 
> 标签：javascript, jquery, ajax, json

如果我能得到以下字符串

```
([{"data":{"id":"1","user_name":"tutor","book":"123","role":"Tutor"}}]); 
```

我该如何提醒它？`data.user_name`显示**未定义**。

```
 $.getJSON('http://mydomain.com/getmyDetail.php?jsoncallback=?', function(data) {   
        alert(data.user_name);    
    });
    } 
```

另一个问题，如果我想为 URL 赋予一些价值，例如

> [http://mydomain.com/getmyDetail.php?username=XXX&role=XXX](http://mydomain.com/getmyDetail.php?username=XXX&role=XXX)

，如何放入getJSON函数，直接

`$.getJSON('http://mydomain.com/getmyDetail.php?username='+username'+'&role='+role+'&'jsoncallback=?'`?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-18T18:18:24.827

这`[{`意味着它嵌套在单个元素数组中。最重要的是，元素的最高级别键是`data`. 采用：

```
alert(data[0].data.user_name); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-18T18:18:32.263

在您的示例中，`data`是整个响应的变量名称，并且您需要`user_name`元素内的`data`元素，因此您可能应该尝试类似

```
alert(data[0].data.user_name); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-18T18:24:12.333

```
$.getJSON('http://mydomain.com/getmyDetail.php?jsoncallback=?', { username: 'a', role: 'b' }, function(data) {   
    alert(data[0].data.user_name);    
}); 
```

# html - 验证 HTML5 DOCTYPE。在 Localhost 上验证源

> ID：15483983
> 
> 赞同：1
> 
> 时间：2013-03-18T18:16:37.233
> 
> 标签：html, doctype, validation

我一直在考虑是否应该全力以赴支持 HTML5 和 CSS3 以及支持所有浏览器。那就是说……

在我的开发环境中验证 HTML5 的最佳方法是什么？（我家 WindowsXP 电脑上的本地主机）

我主要将 Firefox 用于开发，有时我会弹出谷歌浏览器...我不使用或不关心使用 IE8

我曾经喜欢 Firefox 附加组件“HTML Validator version 0.9.5.2”。在 HTML5 之前验证 DOCTYPES 非常棒。但那些日子已经结束了:(

所以。人们使用什么来验证 HTML5？特别是本地主机

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-18T18:19:45.503

The [Web Developer Extension for Google Chrome and Firefox](http://chrispederick.com/work/web-developer/) supports local HTML5 validation, it's always worked great for me.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-18T18:19:01.897

The official W3C HTML validator: [http://validator.w3.org/](http://validator.w3.org/)

They also have a CSS validator: [http://jigsaw.w3.org/css-validator/](http://jigsaw.w3.org/css-validator/)

These can be installed locally using the Download links at the bottom of each validator, for example: [http://code.w3.org/unicorn/wiki/Documentation/Install](http://code.w3.org/unicorn/wiki/Documentation/Install)

# tfs - 如何删除从 TFS 中删除的成员完成的锁定

> ID：15483985
> 
> 赞同：2
> 
> 时间：2013-03-18T18:16:45.360
> 
> 标签：tfs, tfs-2010

我们正在使用 TFS 2010。一个人离开了组织，他的成员用户从 TFS 团队成员中删除。现在有文件被锁定在他身上。使用 TFS Team Explorer 2010 GUI，我们可以右键单击团队成员并撤消已签出和锁定的任何文件。但是如何对现在不再是 TFS 一部分的团队成员做同样的事情，即如何撤消由 TFS 成员完成的文件的挂起更改和锁定，现在从 TFS 团队成员中删除？如果有人遇到过类似的问题，请帮忙，因为这个原因，我们无法从一个分支合并到另一个分支。

我也试过**tf lock /lock:none /workspace:< workspace name >; <用户名> /recursive $/**

我目前是 TFS 项目管理员组的一员，但仍然无法使用此命令。我收到**TF30063**错误。任何帮助或指针表示赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-18T19:41:13.257

使用[TFS Sidekick](http://www.attrice.info/cm/tfs/) - 状态助手。找到您要解锁的文件，单击该特定文件，然后单击撤消。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-17T04:43:19.677

只需安装 tfs 电动工具，然后从团队资源管理器转到团队项目，其中代码或其他文件正在为前用户检出。然后从源代码管理资源管理器中右键单击团队项目。从上下文菜单中选择选项“ `Find in source Control`”并单击状态选项。将打开一个小窗口。在输入框中选择`Display all checked out`“ ”选项或选择“ ”选项`Display files checked out to :`提供前用户的完整用户名，如域名\用户名，然后单击查找。从结果屏幕撤消由特定用户签出的文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T06:56:14.680

TF LOCK "full fileToUnlock path" /LOCK:NONE /workspace:"the workSpaceName";"username"

例如

TF LOCK c:\tfs\ngcs_main\Development/XX.* /LOCK:NONE /workspace:development;jeremykk

您可以从以下位置运行它：“C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\”

# c++ - C hack 用于存储占用 1 位空间的位？

> ID：15483986
> 
> 赞同：12
> 
> 时间：2013-03-18T18:16:45.420
> 
> 标签：c++, c, arrays, binary, bit-manipulation

我有一长串介于 0 和 67600 之间的数字。现在我想使用一个长度为 67600 个元素的数组来存储它们。如果数字在集合中，则元素设置为 1，如果数字不在集合中，则元素设置为 0。IE。每次我只需要 1 位信息来存储数字的存在。C/C++ 中是否有任何 hack 可以帮助我实现这一目标？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-18T18:18:51.100

In C++ you can use `std::vector<bool>` if the size is dynamic (it's a special case of `std::vector`, see [this](http://www.cplusplus.com/reference/vector/vector-bool/)) otherwise there is `std::bitset` (prefer `std::bitset` if possible.) There is also `boost::dynamic_bitset` if you need to set/change the size at runtime. You can find info on it [here](http://www.boost.org/doc/libs/1_36_0/libs/dynamic_bitset/dynamic_bitset.html), it is pretty cool!

In C (and C++) you can manually implement this with bitwise operators. A good summary of common operations is [here](http://en.wikipedia.org/wiki/Bit_manipulation#Bit_manipulation_in_the_C_programming_language). One thing I want to mention is its a good idea to use unsigned integers when you are doing bit operations. `<<` and `>>` are undefined when shifting negative integers. You will need to allocate arrays of some integral type like `uint32_t`. If you want to store `N` bits, it will take `N/32` of these `uint32_t`s. Bit `i` is stored in the `i % 32`'th bit of the `i / 32`'th `uint32_t`. You may want to use a differently sized integral type depending on your architecture and other constraints. **Note**: prefer using an existing implementation (e.g. as described in the first paragraph for C++, search Google for C solutions) over rolling your own (unless you specifically want to, in which case I suggest learning more about binary/bit manipulation from elsewhere before tackling this.) This kind of thing has been done to death and there are "good" solutions.

There are a number of tricks that will *maybe* only consume one bit: e.g. arrays of bitfields (applicable in C as well), but whether less space gets used is up to compiler. See [this link](http://msdn.microsoft.com/en-us/library/yszfawxh%28v=vs.80%29.aspx).

Please note that whatever you do, you will almost surely never be able to use **exactly** N bits to store N bits of information - your computer very likely can't allocate less than 8 bits: if you want 7 bits you'll have to waste 1 bit, and if you want 9 you will have to take 16 bits and waste 7 of them. Even if your computer (CPU + RAM etc.) could "operate" on single bits, if you're running in an OS with `malloc`/`new` it would not be sane for your allocator to track data to such a small precision due to overhead. That last qualification was pretty silly - you won't find an architecture in use that allows you to operate on less than 8 bits at a time I imagine :)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-03-18T18:19:49.040

You should use [`std::bitset`](http://en.cppreference.com/w/cpp/utility/bitset).

`std::bitset` functions like an array of `bool` (actually like `std::array`, since it copies by value), but only uses 1 bit of storage for each element.

Another option is `vector<bool>`, which I don't recommend because:

*   It uses slower pointer indirection and heap memory to enable resizing, which you don't need.
*   That type is often maligned by standards-purists because it claims to be a standard container, but fails to adhere to the definition of a standard container*.

*For example, a standard-conforming function could expect `&container.front()` to produce a pointer to the first element of any container type, which fails with `std::vector<bool>`. *Perhaps a nitpick for your usage case, but still worth knowing about.*

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-03-18T18:19:15.087

There is in fact! `std::vector<bool>` has a specialization for this: [http://en.cppreference.com/w/cpp/container/vector_bool](http://en.cppreference.com/w/cpp/container/vector_bool)

See the doc, it stores it as efficiently as possible.

Edit: as somebody else said, `std::bitset` is also available: [http://en.cppreference.com/w/cpp/utility/bitset](http://en.cppreference.com/w/cpp/utility/bitset)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-03-18T18:23:06.590

如果你想用 C 语言编写它，有一个长度为 67601 位（67601/8 = 8451）的 char 数组，然后为每个值打开/关闭相应的位。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-07-04T22:35:44.610

其他人给出了正确的想法。这是我自己`bitsarr`的位或“数组”的实现。无符号字符是一个字节，因此它本质上是一个无符号字符数组，将信息存储在各个位中。除了一位值之外，我还添加了存储两位或四位值的选项，因为它们都除以 8（一个字节的大小），如果你想存储大量从 0 开始的整数，这将很有用-3 或 0-15。

设置和获取时，数学是在函数中完成的，所以你可以给它一个索引，就好像它是一个普通的数组一样——它知道去哪里找。

此外，用户有责任不要传递一个太大的值来设置，否则会搞砸其他值。可以对其进行修改，使溢出循环回到 0，但这只会使它更加复杂，所以我决定相信自己。

```
#include<stdio.h>
#include <stdlib.h>
#define BYTE 8

typedef enum {ONE=1, TWO=2, FOUR=4} numbits;

typedef struct bitsarr{
    unsigned char* buckets;
    numbits n;
} bitsarr;

bitsarr new_bitsarr(int size, numbits n)
{
    int b = sizeof(unsigned char)*BYTE;
    int numbuckets = (size*n + b - 1)/b;
    bitsarr ret;  
    ret.buckets = malloc(sizeof(ret.buckets)*numbuckets);
    ret.n = n;
    return ret;
}
void bitsarr_delete(bitsarr xp)
{
    free(xp.buckets);
}

void bitsarr_set(bitsarr *xp, int index, int value)
{
    int buckdex, innerdex;
    buckdex = index/(BYTE/xp->n);
    innerdex = index%(BYTE/xp->n);
    xp->buckets[buckdex] = (value << innerdex*xp->n) | ((~(((1 << xp->n) - 1) << innerdex*xp->n)) & xp->buckets[buckdex]);

    //longer version

    /*unsigned int width, width_in_place, zeros, old, newbits, new;
    width = (1 << xp->n) - 1; 
    width_in_place = width << innerdex*xp->n;
    zeros = ~width_in_place;
    old = xp->buckets[buckdex];
    old = old & zeros;
    newbits = value << innerdex*xp->n;
    new = newbits | old;
    xp->buckets[buckdex] = new; */

}

int bitsarr_get(bitsarr *xp, int index)
{
    int buckdex, innerdex;
    buckdex = index/(BYTE/xp->n);
    innerdex = index%(BYTE/xp->n);
    return ((((1 << xp->n) - 1) << innerdex*xp->n) & (xp->buckets[buckdex])) >> innerdex*xp->n;

    //longer version

    /*unsigned int width = (1 << xp->n) - 1; 
    unsigned int width_in_place = width << innerdex*xp->n;
    unsigned int val = xp->buckets[buckdex];
    unsigned int retshifted = width_in_place & val;
    unsigned int ret = retshifted >> innerdex*xp->n;
    return ret; */
}

int main()
{
    bitsarr x = new_bitsarr(100, FOUR);
    for(int i = 0; i<16; i++)
        bitsarr_set(&x, i, i);
    for(int i = 0; i<16; i++)
        printf("%d\n", bitsarr_get(&x, i));
    for(int i = 0; i<16; i++)
        bitsarr_set(&x, i, 15-i);
    for(int i = 0; i<16; i++)
        printf("%d\n", bitsarr_get(&x, i));
    bitsarr_delete(x);
} 
```

# jquery - CSS3 PIE.js，用于多个项目

> ID：15483990
> 
> 赞同：0
> 
> 时间：2013-03-18T18:16:58.757
> 
> 标签：jquery, css

按照这个文档，[http://css3pie.com/documentation/pie-js/](http://css3pie.com/documentation/pie-js/)我能够成功地将插件应用到一个元素并使 CSS3 样式工作，但是它不能用于多个项目。

```
//THIS WORK ON THE WRAPPER

 $(function() {
  if (window.PIE) {
     $('#wrapper').each(function() {
        PIE.attach(this);
     });   

  }
});

//SECOND FUNCTION FOR ANOTHER ID, DOES NOT WORK

$(function() {
  if (window.PIE) {
     $('#menu').each(function() {
        PIE.attach(this);
     });   

  }
}); 
```

任何人都有使用 CSS3 PIE 并使其与多个元素一起工作的经验吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T18:21:07.407

`$('#wrapper')`表示您正在选择一个 ID。由于 ID 应该是唯一的，因此您只返回一个元素是有道理的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T18:31:03.630

问题是具有 CSS3 样式的元素没有应用 z-index。为这两个元素添加 z-index 后，PIE.js 就起作用了。

# google-app-engine - 在 App Engine Map-Reduce 中获取“应用程序错误：10”

> ID：15483991
> 
> 赞同：2
> 
> 时间：2013-03-18T18:17:04.640
> 
> 标签：google-app-engine

在减少步骤中我遇到了这样的错误。MapReduce 概述页面报告所有作业都已成功完成，但我试图写出的一半记录没有写入。是什么导致了这个错误，我该如何解决？：

```
 ApplicationError: 10 
Traceback (most recent call last):
  File "/python27_runtime/python27_lib/versions/third_party/webapp2-2.3/webapp2.py", line 1511, in __call__
    rv = self.handle_exception(request, response, e)
  File "/python27_runtime/python27_lib/versions/third_party/webapp2-2.3/webapp2.py", line 1505, in __call__
    rv = self.router.dispatch(request, response)
  File "/python27_runtime/python27_lib/versions/third_party/webapp2-2.3/webapp2.py", line 1253, in default_dispatcher
    return route.handler_adapter(request, response)
  File "/python27_runtime/python27_lib/versions/third_party/webapp2-2.3/webapp2.py", line 1077, in __call__
    return handler.dispatch()
  File "/python27_runtime/python27_lib/versions/third_party/webapp2-2.3/webapp2.py", line 547, in dispatch
    return self.handle_exception(e, self.app.debug)
  File "/python27_runtime/python27_lib/versions/third_party/webapp2-2.3/webapp2.py", line 545, in dispatch
    return method(*args, **kwargs)
  File "/base/data/home/apps/s~getaround3/dont-make-this-default-export-mr.366029363091232181/mapreduce/base_handler.py", line 65, in post
    self.handle()
  File "/base/data/home/apps/s~getaround3/dont-make-this-default-export-mr.366029363091232181/mapreduce/handlers.py", line 181, in handle
    entity, input_reader, ctx, tstate)
  File "/base/data/home/apps/s~getaround3/dont-make-this-default-export-mr.366029363091232181/mapreduce/handlers.py", line 298, in process_data
    output_writer.write(output, ctx)
  File "/base/data/home/apps/s~getaround3/dont-make-this-default-export-mr.366029363091232181/mapreduce/output_writers.py", line 693, in write
    ctx.get_pool("records_pool").append(str(data))
  File "/base/data/home/apps/s~getaround3/dont-make-this-default-export-mr.366029363091232181/mapreduce/output_writers.py", line 336, in append
    self.flush()
  File "/base/data/home/apps/s~getaround3/dont-make-this-default-export-mr.366029363091232181/mapreduce/output_writers.py", line 371, in flush
    COUNTER_IO_WRITE_BYTES, len(str_buf))(self._ctx)
  File "/base/data/home/apps/s~getaround3/dont-make-this-default-export-mr.366029363091232181/mapreduce/lib/files/file.py", line 297, in __exit__
    self.close()
  File "/base/data/home/apps/s~getaround3/dont-make-this-default-export-mr.366029363091232181/mapreduce/lib/files/file.py", line 291, in close
    self._make_rpc_call_with_retry('Close', request, response)
  File "/base/data/home/apps/s~getaround3/dont-make-this-default-export-mr.366029363091232181/mapreduce/lib/files/file.py", line 427, in _make_rpc_call_with_retry
    _make_call(method, request, response)
  File "/base/data/home/apps/s~getaround3/dont-make-this-default-export-mr.366029363091232181/mapreduce/lib/files/file.py", line 252, in _make_call
    _raise_app_error(e)
  File "/base/data/home/apps/s~getaround3/dont-make-this-default-export-mr.366029363091232181/mapreduce/lib/files/file.py", line 195, in _raise_app_error
    raise FileNotOpenedError(e)
FileNotOpenedError: ApplicationError: 10

Traceback (most recent call last):
  File "/base/data/home/apps/s~getaround3/dont-make-this-default-export-mr.366029363091232181/mapreduce/main.py", line 105, in main
    util.run_wsgi_app(APP)
  File "/python27_runtime/python27_lib/versions/1/google/appengine/ext/webapp/util.py", line 98, in run_wsgi_app
    run_bare_wsgi_app(add_wsgi_middleware(application))
  File "/python27_runtime/python27_lib/versions/1/google/appengine/ext/webapp/util.py", line 116, in run_bare_wsgi_app
    result = application(env, _start_response)
  File "/python27_runtime/python27_lib/versions/third_party/webapp2-2.3/webapp2.py", line 1519, in __call__
    response = self._internal_error(e)
  File "/python27_runtime/python27_lib/versions/third_party/webapp2-2.3/webapp2.py", line 1511, in __call__
    rv = self.handle_exception(request, response, e)
  File "/python27_runtime/python27_lib/versions/third_party/webapp2-2.3/webapp2.py", line 1505, in __call__
    rv = self.router.dispatch(request, response)
  File "/python27_runtime/python27_lib/versions/third_party/webapp2-2.3/webapp2.py", line 1253, in default_dispatcher
    return route.handler_adapter(request, response)
  File "/python27_runtime/python27_lib/versions/third_party/webapp2-2.3/webapp2.py", line 1077, in __call__
    return handler.dispatch()
  File "/python27_runtime/python27_lib/versions/third_party/webapp2-2.3/webapp2.py", line 547, in dispatch
    return self.handle_exception(e, self.app.debug)
  File "/python27_runtime/python27_lib/versions/third_party/webapp2-2.3/webapp2.py", line 545, in dispatch
    return method(*args, **kwargs)
  File "/base/data/home/apps/s~getaround3/dont-make-this-default-export-mr.366029363091232181/mapreduce/base_handler.py", line 65, in post
    self.handle()
  File "/base/data/home/apps/s~getaround3/dont-make-this-default-export-mr.366029363091232181/mapreduce/handlers.py", line 181, in handle
    entity, input_reader, ctx, tstate)
  File "/base/data/home/apps/s~getaround3/dont-make-this-default-export-mr.366029363091232181/mapreduce/handlers.py", line 298, in process_data
    output_writer.write(output, ctx)
  File "/base/data/home/apps/s~getaround3/dont-make-this-default-export-mr.366029363091232181/mapreduce/output_writers.py", line 693, in write
    ctx.get_pool("records_pool").append(str(data))
  File "/base/data/home/apps/s~getaround3/dont-make-this-default-export-mr.366029363091232181/mapreduce/output_writers.py", line 336, in append
    self.flush()
  File "/base/data/home/apps/s~getaround3/dont-make-this-default-export-mr.366029363091232181/mapreduce/output_writers.py", line 371, in flush
    COUNTER_IO_WRITE_BYTES, len(str_buf))(self._ctx)
  File "/base/data/home/apps/s~getaround3/dont-make-this-default-export-mr.366029363091232181/mapreduce/lib/files/file.py", line 297, in __exit__
    self.close()
  File "/base/data/home/apps/s~getaround3/dont-make-this-default-export-mr.366029363091232181/mapreduce/lib/files/file.py", line 291, in close
    self._make_rpc_call_with_retry('Close', request, response)
  File "/base/data/home/apps/s~getaround3/dont-make-this-default-export-mr.366029363091232181/mapreduce/lib/files/file.py", line 427, in _make_rpc_call_with_retry
    _make_call(method, request, response)
  File "/base/data/home/apps/s~getaround3/dont-make-this-default-export-mr.366029363091232181/mapreduce/lib/files/file.py", line 252, in _make_call
    _raise_app_error(e)
  File "/base/data/home/apps/s~getaround3/dont-make-this-default-export-mr.366029363091232181/mapreduce/lib/files/file.py", line 195, in _raise_app_error
    raise FileNotOpenedError(e)
FileNotOpenedError: ApplicationError: 10 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T00:24:43.703

我增加了似乎解决了问题的分片数量。增加分片的数量可以减少每个切片必须保持打开文件的时间，这可能是我遇到问题的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-19T06:57:28.173

保持文件打开超过 30 秒也会导致此错误。尝试将写入分成多个写入。

[参考链接](https://groups.google.com/forum/#!topic/google-appengine-java/5XBVaVDKvvs)[https://groups.google.com/forum/#!topic/google-appengine-java/5XBVaVDKvvs](https://groups.google.com/forum/#!topic/google-appengine-java/5XBVaVDKvvs)

# c# - 如何为来自 System.Data 的 DataRow 的绑定设置 DisplayMemberPath 和 SelectedValuePath？

> ID：15483995
> 
> 赞同：0
> 
> 时间：2013-03-18T18:17:32.820
> 
> 标签：c#, .net, wpf

如何为来自 System.Data 的 DataRow 的绑定设置 DisplayMemberPath 和 SelectedValuePath？

这就是我正在做的，有错吗？

```
DataSet ds = new DataSet();
DataTable dt = new DataTable("tb1");
dt.Columns.Add("ID");
dt.Columns.Add("Name");
ds.Tables.Add(dt);

DataRow dr1 = ds.Tables[0].NewRow();
dr1["ID"] = 1;
dr1["Name"] = "Edwin";

DataRow dr2 = ds.Tables[0].NewRow();
dr2["ID"] = 2;
dr2["Name"] = "John";

DataRow dr3 = ds.Tables[0].NewRow();
dr3["ID"] = 3;
dr3["Name"] = "Dave";

ds.Tables[0].Rows.Add(dr1);
ds.Tables[0].Rows.Add(dr2);
ds.Tables[0].Rows.Add(dr3);

comboBox1.DisplayMemberPath = "Name";
comboBox1.SelectedValuePath = "ID";

foreach (DataRow item in ds.Tables[0].Rows)
{
    comboBox1.Items.Add(item);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T18:27:50.170

您正在将`DataRow`对象添加到您的`ComboBox`, 并且`DataRow`没有标题为`ID`and的属性`Name`（从技术上讲，它们确实有一个`Name`属性，但它不是您想要的那个）

一个容易记住的方法是使用`DisplayMemberPath`and `SelectedValuePath`，您需要能够使用 的语法访问该属性`DataItem.PropertyName`，因此在您的情况下，它试图访问`DataRow.ID`and`DataRow.Name`

例如，`DisplayMemberPath`它只是一个数据模板的快捷方式，看起来像

```
<TextBlock Text="{Binding DisplayMemberPathValue}" /> 
```

你最好只添加一些简单的东西，比如一个`KeyValuePair<int,string>`或一个自定义类，甚至只是一个`ComboBoxItem`

```
comboBox1.SelectedValuePath = "Key";
comboBox1.DisplayMemberPath = "Value";

foreach (DataRow item in ds.Tables[0].Rows)
{
    comboBox1.Items.Add(
        new KeyValuePair<int,string>((int)item["ID"], row["Name"] as string));
} 
```

# php - functions.php 中的投票系统

> ID：15483997
> 
> 赞同：0
> 
> 时间：2013-03-18T18:17:47.543
> 
> 标签：php, wordpress, wordpress-theming

我制作了一个生成投票系统和您的网站的代码。他的样子如下图：

![例子](../Images/b03552b53a9345f98c4765bca6efa1a7.png)

我制作了以下代码JavaScipt：

```
jQuery(document).ready(function() {

jQuery("a#up").click(function() {
    jQuery('.rating').html('');
    jQuery('#loading').show();

    post_id = jQuery(this).data("post_id");

    jQuery.ajax({
        type: "post",
        url: ajax_var.url,
        data: "action=post_id&nonce=" + ajax_var.nonce + "&post_rating=up&post_id=" + post_id,
        success: function(data) {
            jQuery('#loading').hide();

            jQuery('.rating').html(data);

        }
    });

    return false;
});

jQuery("a#down").click(function() {

    post_id = jQuery(this).data("post_id");

    jQuery.ajax({
        type: "post",
        url: ajax_var.url,
        data: "action=post_id&nonce=" + ajax_var.nonce + "&post_rating=down&post_id=" + post_id,
        success: function(data) {
            jQuery('.rating').html(data);

        }
    });

    return false;
});

}); 
```

以下PHP代码在我的functions.php中

```
 <?php

function add_rating_script() {
    wp_enqueue_script('rating', get_stylesheet_directory_uri() . '/js/rating.js', array('jquery'), '', true);
    wp_localize_script('rating', 'ajax_var', array('url' => admin_url('admin-ajax.php'), 'nonce' => wp_create_nonce('ajax-nonce')));
}

function update_rating() {

    // Check for nonce security
    $nonce = $_POST['nonce'];

    if (!wp_verify_nonce($nonce, 'ajax-nonce'))
        die('Busted!');

    if (isset($_POST['post_rating'])) {
        // Retrieve user IP address
        $ip = $_SERVER['REMOTE_ADDR'];
        $post_id = $_POST['post_id'];

        // Get voters'IPs for the current post
        $meta_IP = get_post_meta($post_id, "voted_IP");
        $voted_IP = $meta_IP[0];

        if (!is_array($voted_IP))
            $voted_IP = array();

        // Get votes count for the current post
        $meta_count_up = get_post_meta($post_id, "votes_up", true);
        $meta_count_down = get_post_meta($post_id, "votes_down", true);

        // Use has already voted ?
        if (!hasAlreadyVoted($post_id)) {
            $voted_IP[$ip] = time();
            if ($_POST['post_rating']  == 'up') {

                // Save IP and increase votes count
                update_post_meta($post_id, "voted_IP", $voted_IP);
                update_post_meta($post_id, "votes_up", ++$meta_count_up);

                echo '<p class=\'message\'>Esse artigo já ajudou <span class=\'count\'>' . $meta_count_up . '</span> pessoas </p>';
            }elseif($_POST['post_rating'] == 'down'){
                update_post_meta($post_id, "voted_IP", $voted_IP);
                update_post_meta($post_id, "votes_down", ++$meta_count_down);

                echo '<p class=\'message\'>Obrigado pelo seu voto.</p>';
            }

        }
        else
              echo '<p class=\'message\'>Você já enviou o seu voto.</p>';
    }
    exit;
    }

    function hasAlreadyVoted($post_id) {
    $timebeforerevote = 120;

    $meta_IP = get_post_meta($post_id, "voted_IP");
    $voted_IP = $meta_IP[0];
    if (!is_array($voted_IP))
        $voted_IP = array();
    $ip = $_SERVER['REMOTE_ADDR'];

    if (in_array($ip, array_keys($voted_IP))) {
        $time = $voted_IP[$ip];
        $now = time();

        if (round(($now - $time) / 60) > $timebeforerevote)
            return false;

        return true;
    }

    return false;
}

wp_localize_script('rating', 'ajax_var', array(
    'url' => admin_url('admin-ajax.php'),
    'nonce' => wp_create_nonce('ajax-nonce')
));

add_action('wp_enqueue_scripts', 'add_rating_script');
add_action('wp_ajax_post_id', 'update_rating');
add_action('wp_ajax_nopriv_post_id', 'update_rating'); 
```

问题是为了防止用户在同一篇文章中多次投票，我把它保存了 IP 并做一个比较，但我相信随着时间的推移，WordPress 会收费并且超级慢。有谁知道我优化这段代码的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T18:28:01.560

优化的一个技巧可能是在他们投票后设置一个 cookie，并将其作为第一道防线。在大量用例中，这将停止对数据库的相当多的调用。如果未设置 cookie，则只有在您的表中检查 IP 地址以确定他们是否已经投票。

仅使用 cookie 的方法显然行不通，因为用户可以切换浏览器、清除 cookie 等 - 对于这些用户，您将像当前一样查找他们的 IP（尽管仍然有办法规避这一点，并且如果合法用户共享互联网连接/IP 地址，您可能会阻止他们投票 - 即从同一个星巴克 Wifi 连接投票）。

至少通过首先检查 cookie，您可以主动阻止大量可能不必要的数据库事务。