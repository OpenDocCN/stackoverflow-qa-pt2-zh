# StackOverflow 问答 14707000-14707999

# c++ - Returning an allocated local variable

> ID：14707001
> 
> 赞同：0
> 
> 时间：2013-02-05T11:57:43.620
> 
> 标签：c++, visual-c++, memory, c++11

How do I do this thing.

```
char* ToString(int num) {

    char* str = new char[len(num)];

    //conversion

    return str; 
```

}

And by calling this.

```
string someStr = ToString(someInt); 
```

Should I free the `someStr` here?

I know I always need to `delete` whenever I use `new`.

And what if I call this function multiple times, do I allocate memory and just leaving them behind not using it?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T12:00:12.197

你应该完全避免这种做法。要么返回一个`std::unique_ptr`，要么`std::string`直接处理。从您的代码中不清楚您到底想做什么，所以我无法提供具体的解决方案。

请注意，此初始化：

```
string someStr = ToString(someInt); 
```

仅当您返回一个以空字符结尾的字符串时才能正常工作，但无论如何它都会泄漏资源。

请参阅[此相关帖子](https://stackoverflow.com/questions/10553091/what-is-the-best-way-to-return-string-in-c/10553140#10553140)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T12:00:02.680

每次调用 都需要调用`delete`一次`ToString`。您也不能按照您的问题提示的方式`std::string`使用分配的`char`数组初始化 a - 这会泄漏返回的内存，而您的`someStr`变量已经复制了它。

最简单/最简洁的做法是改为`ToString`返回`std::string`。在这种情况下，当调用者的变量超出范围时，字符串使用的内存将被自动删除。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T12:08:32.817

我在 valgrind 下运行了你的代码`--leak-check=full`，它报告`num`了内存泄漏的大小。

成对调用`new/delete`是`new [] /delete []`保持内存循环的唯一方法。

我不确定你想做什么，如果你想将整数类型转换为字符串，C++ 有几个选项：

```
// std::to_string(C++11) e.g:
{
    std::string str = std::to_string(num)
}
// std::stringstream     e.g:
{
    std::string str;
    std::stringstream ss;
    ss << num;
    ss >> str;
}
// boost::lexical_cast   e.g:
{
    std::string str = boost::lexical_cast<std::string>(num);
}
// itoa(c function)
{
    char buf[MAX_INT_DIGITS]; // MAX_INT_DIGITS == 12 ("-2147483648\0")
    itoa(num, buf, 10);
    std::string str(buf);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T11:59:56.813

你的`ToString`函数应该返回一个std::string，如果你只是将值分配给一个std::string。没有理由在这里处理动态分配的内存。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-05T12:00:47.170

`someStr`是副本。你已经泄漏了。您需要暂时保存返回指针的值，并在构造字符串后删除它。这通常是智能指针的工作。

编辑：不，

```
char* temp =  strs; delete [] str; return temp; 
```

会有一些未定义的东西。但：

```
char* temp =ToString(someInt);  string someStr(temp);delete []temp; 
```

将工作。但这只是为了让你理解这个想法。如果您返回一个 unique_ptr，这可以为您制作。而且我假设这是一个一般性问题，即返回一个必须在那之后必须空闲的内存，以防万一`unique_ptr`，并且`shared_ptr`是一个解决方案。在这种特殊情况下，您可以创建一个字符串，修改它并简单地返回它。所有内存管理都将由字符串类为您完成。如果你真的只需要在字符串中分配“空间”，你可以这样做：

```
String Str; Str.reserve(len(num)); 
```

# c# - PostgreSQL中的锁表

> ID：14707002
> 
> 赞同：1
> 
> 时间：2013-02-05T11:57:47.943
> 
> 标签：c#, .net, multithreading, postgresql

我有一个带有一些下载链接的“链接”表。

我的 .NET 应用程序读取此表、获取链接、创建 Web 客户端并下载相关文件。我想创建几个线程来执行此操作，但每个线程都应该读取不同的记录，否则两个线程会尝试下载同一个文件。怎么能做到这一点？

我已经尝试过了，但它不起作用：

```
 public static Boolean Get_NextProcessingVideo(ref Int32 idVideo, ref String youtubeId, ref String title)
    {
        Boolean result = false;

        using (NpgsqlConnection conn = new NpgsqlConnection(ConfigurationDB.GetInstance().ConnectionString))
        {
            conn.Open();
            NpgsqlTransaction transaction = conn.BeginTransaction();

            String query = "BEGIN WORK; LOCK TABLE links IN ACCESS EXCLUSIVE MODE; SELECT v.idlink,  v.title " +
                " FROM video v  WHERE v.schedulingflag IS FALSE AND v.errorflag IS FALSE ORDER BY v.idvideo  LIMIT 1; " + 
                " COMMIT WORK;";
            NpgsqlCommand cmd = new NpgsqlCommand(query, conn, transaction);

            NpgsqlDataReader dr = cmd.ExecuteReader();

            if (dr.HasRows)
            {
                dr.Read();

                idVideo = Convert.ToInt32(dr["idvideo"]);
                title = dr["title"].ToString();

                Validate_Scheduling(idVideo); // 
                result = true;
            }

            transaction.Commit();
            conn.Close();

        }
        return result;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T01:44:41.513

您在这里有几个选择。正如您所指出的，您不想做的一件事是锁定桌子。

1.  咨询锁。优点是这些是额外的事务。缺点是它们不会在事务中关闭，必须专门关闭，并且泄漏最终会导致问题（本质上是后端的共享内存泄漏）。一般来说，我不喜欢这样的额外事务锁，虽然在数据库会话结束时清除了咨询锁，但仍然可能存在陈旧锁的问题。

2.  您可以让一个专用线程首先拉取待处理的文件，然后将特定的检索委托给子线程。就数据库往返和操作简单性而言，这可能是最好的方法。我希望这将在任何解决方案中表现最好。

3.  您可以在可以处理异常处理的存储过程中 SELECT FOR UPDATE NOWAIT。有关示例，请参阅[在 Postgresql 中选择未锁定的行。](https://stackoverflow.com/questions/389541/select-unlocked-row-in-postgresql)

# sql - Database structure issue

> ID：14707007
> 
> 赞同：2
> 
> 时间：2013-02-05T11:57:59.847
> 
> 标签：sql, database, database-design, relational-database

Here is the scenario: There are teachers who teaches various subjects. Subjects comprises of chapters. There may be more than one teacher teaching the same subjects but have different chapters assigned to them. There are topics, subtopics (hierarchical) inside chapters.

I am concerned with the entities: chapters, topics only. Chapters have properties like teacher_id, subject_id,title, designated_hours. Topics (also has subtopics and subtopics may contain subtopics inside them i.e to say hierarchical). Topic properties are title, teaching_methodology, hours, periods, completion_date.

My proposed structure:

```
chapters                  topics
 -id                       -id
 -subject_id (fk)          -chapter_id (fk) references chapters
 -teacher_id (fk)          -parent_id (fk) references topics itself
 -title                    -title
 -designated_hours         -hours
                           -periods
                           -completion_date
                           -teaching_methodology 
```

My question is whether my structure is normalized ? In case when topics have subtopics, the fields like hours, periods, completion_date, teaching_methodology will be null. Should I create separate table for these properties like

```
 topic_properties
   -id
   -topic_id (fk) references topic
   -hours
   -periods 
```

You can also propose other database structure. I just want to make sure i get the structure right before i start this module

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T13:27:29.570

我认为你在这里是正确的，你不需要额外的桌子。我只是做一个小的调整，以确保父子主题不能属于不同的章节：

```
CREATE TABLE chapters (
    chapter_id INT PRIMARY KEY
    -- (other fields)
);

CREATE TABLE topics (
    chapter_id INT,
    topic_no INT,
    parent_topic_no INT,
    -- (other fields)
    PRIMARY KEY (chapter_id, topic_no),
    FOREIGN KEY (chapter_id)
        REFERENCES chapters (chapter_id),
    FOREIGN KEY (chapter_id, parent_topic_no)
        REFERENCES topics (chapter_id, topic_no)
); 
```

请注意第二个 FK 如何强制子行与`chapter_id`父行相同。

[[SQL 小提琴]](http://sqlfiddle.com/#!4/993db/10)

# jquery - 类方法中的Jquery隐藏函数失败IE

> ID：14707009
> 
> 赞同：2
> 
> 时间：2013-02-05T11:58:00.893
> 
> 标签：jquery, user-interface, internet-explorer-8, hide, show

我编写了一个 javascript 模块（div 对象），如果您使用 Jquery UI 显示和隐藏功能在输入元素内单击，它会从右侧滑入文档。这在除 IE 8 之外的大多数浏览器中都能正常工作。

问题是当模块隐藏自己时，IE 8 将不再打开它。

经过大量工作，我设法找出了一些奇怪之处。当我将以下代码作为按钮元素的 onclick 函数运行以隐藏模块时，我可以再次打开它。

```
$('#segitseg').hide('drop', { direction: 'right' }, 600); 
```

但是，如果我从一个名为 Segitseg 的对象（在英语中表示帮助）调用同一行，如下所示：

```
var Segitseg = new function () {
    ...
    this.bezar = function() {
        $('#segitseg').hide('drop', { direction: 'right' }, 600);
    }
    ...
} 
```

然后我无法再次重新打开模块。

但我应该使用第二种变体，因为方法 bezar 也应该做其他事情。

有没有人遇到过这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T14:03:24.457

尝试使用：`$(document).ready(function() {});`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T15:44:32.807

**我发现问题了！**

好吧，当你在一个元素上调用 hide() 时，它会改变它的不透明度，或者更重要的是它的 alpha 不透明度，它被 IE8 使用。所以元素将是不可见的。

**解决方案：（**在 hide() 函数结束后改回不透明度）

```
$('#segitseg').hide('drop', { direction: 'right' }, 600, function(){
    $('#segitseg').css('filter', 'alpha(opacity=100)');
}); 
```

# c# - RangeControlValidator Misbehaving

> ID：14707016
> 
> 赞同：1
> 
> 时间：2013-02-05T11:58:34.860
> 
> 标签：c#, asp.net, validation

I am sure that this will be my fault, as I can't believe that the RangeControlValidator is incorrect, but I can't see why this is not working.

```
 <ItemTemplate>
        <div class="reportItem">
        <div class="l1" >New</div>
        <div class="l2"><asp:Textbox runat="server" name="numberOnly" ID="tbNew" CssClass="compliance" onblur="calculateCompliance(this);"/>
            <asp:RequiredFieldValidator ID="RequiredFieldValidator1" runat="server" ErrorMessage="Required Value"  ControlToValidate="tbNew" Display="Dynamic" Text="*" />
            <asp:RangeValidator ID="RangeValidator3" runat="server" ErrorMessage="Must be a Positive Number" ControlToValidate="tbNew" Display="Dynamic" Text="*" MinimumValue="0" MaximumValue="1000" Type="Integer" />
        </div> 
```

The Range validator is in a repeater. I am trying to limit the value in the text box to between 1 and 1000.

If I allow IE autocomplete to fill the box it works fine, but if I manually enter the value, then I get the red star and an Invalid result.

Initially I thought that this was because it was in a repeater, and it was getting confused over names, but the Required Field Validator works, so I no longer believe that this is the case.

So, can anyone see anything wrong with the code sample?, is somethign very odd going on?

(the onblur does nt affect the value in that cell, but it does read it to do a sum elsewhere)

# ldap - LDAP User are not put automatically into LDAP group in jira

> ID：14707019
> 
> 赞同：5
> 
> 时间：2013-02-05T11:58:42.040
> 
> 标签：ldap, settings, jira, openldap

I have Jira 5.x locally installed and an OpenLDAP Server with Users and Groups. The Syncronisation in Jira get all users and groups perfectly, but the users do not belong to any group. I've set the default groups to enable LDAP users to login to Jira.

What am I doing wrong?

This is the LDAP Schema:

```
dn: uid=demo.user@domain.com,ou=intern,ou=people,dc=company,dc=local
objectClass: posixAccount
objectClass: account
objectClass: ldapPublicKey
homeDirectory: /home/demouser
loginShell: /bin/bash
cn: Demo User
uidNumber: 10001
gidNumber: 10001
userPassword: {SSHA}xxxxxxxxxxx
uid: demo.user@domain.com

dn: cn=groupname,ou=project,ou=group,dc=company,dc=local
objectClass: posixGroup
description: a funny group for a project
gidNumber: 10018
cn: groupname
memberUid: demo.user@domain.com
memberUid: xyz
memberUid: ... 
```

If I run the Test in Jira, I'm getting the following error Message:

> Test get user's memberships with 0 groups retrieved. : Failed

And these are the Settings in Jira: ![Jira Settings](../Images/86ba1b943b99ebbf61f81b7767a84f72.png)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-07T10:27:14.927

我们遇到了类似的问题。JIRA 似乎坚持包含来自用户模式的用户成员属性，例如“memberOf”，无论您是否已经拥有组成员属性。然而，它应该是一个非此即彼的选项——组成员属性（例如，组架构中的 memberUid）或用户成员属性（例如，用户架构中的 memberOf），因为它们或多或少地实现了相同的功能。

当我们注意到目录类型实际上有两个密切相关的选项时，问题就解决了：“OpenLDAP”和“OpenLDAP（只读 Posix Schema）”。当我们使用 posixGroup 架构（如您的示例中）时，选择只读 Posix 架构解决了这个问题。如果您转到顶部的服务器设置部分，您应该会在下拉列表中看到这两个选项。

此外，您应该能够在 LDAP 权限部分（如果您愿意的话）从“只读，本地组”切换到“只读”。需要注意的是，我们将 inetOrgPerson 和 shadowAccount 模式（而不是您的示例中的帐户）与用户模式的 posixAccount 结合使用。

# visual-studio-2010 - Visual Studio 2010 throws exception on running unit tests

> ID：14707023
> 
> 赞同：2
> 
> 时间：2013-02-05T11:58:46.870
> 
> 标签：visual-studio-2010, visual-studio, unit-testing, mstest

When I run the unit tests, Visual Studio throws following exception

> Exception of type 'System.Exception' was thrown.

Even it's not possible to run any of the tests, which means it's a setup issue with Visual Studio. Any workaround/solution for this?

![enter image description here](../Images/8d937e43f858878f5d77b4205daea135.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-21T12:09:23.917

Check if your UnitTest project has an invalid reference to another project (e.g. a project which has been deleted, or project type has changed from "library" to "utility").

# css - CSS网格系统偏移列等

> ID：14707029
> 
> 赞同：0
> 
> 时间：2013-02-05T11:59:02.533
> 
> 标签：css

我知道你们中的大多数人可能都知道所有这些东西，但也许还有像我这样的人刚刚开始学习这些关于 CSS 网格的东西。也许这些问题也会对他们有所帮助。

1.  什么是网格系统？
2.  如何以像素和百分比计算网格系统？
3.  什么是偏移量？如何计算偏移量？
4.  使用网格系统更好吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T12:12:28.003

正如您可能已经遇到的那样，有很多不同的网格和 css 框架可能会有点令人困惑，所以我会尽力提供帮助。

网格只不过是一个屏幕区域，被分割成多个部分。大多数网格通常分成 12 个组（或 12 个的倍数）。因此，对于一个 960 像素宽的容器和 12 个组（我现在将其称为列），每列的宽度为 80 像素。

计算网格可能很复杂，当与添加排水沟、偏移量、边距、嵌套、容器等结合使用时，您的 css 很快就会变得相当混乱。

有许多基于网格的 css 框架，其中最流行的两个是[Twitter 的 Bootstrap](http://twitter.github.com/bootstrap/scaffolding.html#gridSystem)和[Zurb 的 Foundation](http://foundation.zurb.com/)。我相信这两个已经比 Blueprint CSS 和 960 grid + 其他更受欢迎，因为它们提供了广泛的插件以及脚手架层来帮助构建非常漂亮的响应式网站。

希望这可以帮助。

# php - 设置不同的会话数据 - 两个不同的会话

> ID：14707034
> 
> 赞同：0
> 
> 时间：2013-02-05T11:59:13.087
> 
> 标签：php, session

```
<?php
session_start();

$session_new_name_1 = session_name("user1");
$session_new_name_2 = session_name("user2");

$_SESSION['user_name'] = "John";  //set to $session_new_name_1
$_SESSION['user_name'] = "Frank"; //set to $session_new_name_2

?> 
```

问题基本上是，如何将名称 John 设置为会话 user1 并将名称 Frank 设置为会话 user2？

这两个会话应该并存。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T12:08:55.500

我不认为这是可能的。PHPSESSID 只能包含一个 ID。此外，需要在 session_start() 之前调用 session_name()。从[手册](http://php.net/manual/en/function.session-name.php)。

> 会话名称在请求启动时重置为存储在 session.name 中的默认值。因此，您需要为每个请求调用 session_name()（并且在 session_start() 或 session_register() 被调用之前）。

但是，如果您不是真的在寻找真正的双会话系统，@ripa 和@phpalix 提供的答案可能会对您有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T12:13:13.770

如果你想要更多数据，你可以这样做：

```
$_SESSION['username'] = array('name' => 'John', 'last_name' => 'Doe', 'email' => 'some@mail.com'); 
```

等等...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T12:04:16.953

在您的示例中，将会话设为数组：

```
$_SESSION['user_name']['user1'] = "John";
$_SESSION['user_name']['user1'] = "Frank"; 
```

[数组](http://php.net/manual/en/language.types.array.php)功能强大，如果使用得当，可以帮助您克服许多问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T12:05:44.100

```
$_SESSION['user1'] = "John"; 
$_SESSION['user2'] = "Frank"; 
```

试试这个。可以帮助你。

# c# - 将 SQL-Server 2005 上的数据同时保存为硬拷贝和软拷贝时出错

> ID：14707041
> 
> 赞同：0
> 
> 时间：2013-02-05T11:59:32.187
> 
> 标签：c#, sql-server-2005

我正在使用 VS 2008 和 SQL-Server 2005 开发一个项目。我使用`varchar(150)`-field 来保存一个普通的字符串，它必须保存

1.  电子版
2.  硬拷贝
3.  两者（软拷贝和硬拷贝）

它在保存为软拷贝或硬拷贝时有效，但对于两者（软拷贝和硬拷贝），它都会引发以下错误：

> 字符串或二进制数据将被截断。该语句已终止。

当我在发生此错误后重新启动应用程序时，一切正常。

我尝试使用`Nvarchar(Max)`相同的字段，但错误都是一样的。

请给我建议以避免此错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T12:04:43.500

该错误表示您正在更新比它可以容纳的更大尺寸的列。检查列值中的空格

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T12:05:18.923

*当您的数据类型、大小与数据库字段属性不匹配时，会发生此异常。*

这可能是因为您的列长度小于插入数据。

因此，如果您将列长度增加到可以占用您输入的数据的长度，那么问题将得到解决。

如果您使用`Nvarchar`（Unicode 字符数据）数据类型，则需要将数据插入`N'`为前缀，如下所示：

```
Set @var = N'Hello World' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T12:05:34.137

`string or binary data would be truncate. The statement has been terminated`超出大小时会出现错误。尝试从 更新您的尺寸`varchar(150) to varchar(500)`。

或者检查您的查询或存储过程中的数据长度，您将在其中为保存在 db 中的文件分配值（参考：当您将其更改为`nvarchar(max)`但它不起作用时）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T12:05:57.533

如果您尝试将太多数据插入到大小有限的字段中，则会发生这种情况，在您的情况下为 150。

# session - WebMatrix WebSecurity：保持随机注销用户

> ID：14707042
> 
> 赞同：2
> 
> 时间：2013-02-05T11:59:33.860
> 
> 标签：session, authentication, security, webmatrix

我正在使用 WebMatrix 并在我的网站上应用了登录系统。我遇到了一个奇怪的问题。我的网站不断随机注销用户。意外发生。不仅在我的代码上，而且在 WebMatrix 示例项目中也发生了。

我的 Web.Config 文件是：

```
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
  <appSettings>
    <add key="loginUrl" value="~/login" />
  </appSettings>
  <system.web>
    <compilation debug="true" targetFramework="4.0" />
    <sessionState timeout="20" />
    <!-- This is for links with incorrect file extensions -->
    <!-- This only handles .NET based errors, not classic web like HTML or ASP based extensions -->
    <customErrors mode="Off">
      <error statusCode="403" redirect="/Shared/Error404.cshtml" />
      <error statusCode="404" redirect="/Shared/Error404.cshtml" />
      <error statusCode="500" redirect="/Shared/Error500.cshtml" />
    </customErrors>
  </system.web>
  <system.webServer>
    <!-- This handles all other types of link errors -->
    <httpErrors errorMode="Custom">
      <remove statusCode="404" subStatusCode="-1" />
      <error statusCode="404" path="/Shared/Error404.cshtml" responseMode="ExecuteURL" />
    </httpErrors>
  </system.webServer>
  <system.data>
    <DbProviderFactories>
      <remove invariant="System.Data.SqlServerCe.4.0" />
            <add invariant="System.Data.SqlServerCe.4.0" name="Microsoft® SQL Server® Compact 4.0" description=".NET Framework Data Provider for Microsoft SQL Server Compact" type="System.Data.SqlServerCe.SqlCeProviderFactory, System.Data.SqlServerCe, Version=4.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91" />
    </DbProviderFactories>
  </system.data>
</configuration> 
```

我已将会话超时定义为 20 分钟。我使用相同的简单方式登录用户。

```
 if (WebSecurity.Login(email, password, rememberMe)) {
        Context.RedirectLocal(returnUrl);
        return;
    } else {
        ModelState.AddFormError("The user name or password provided is incorrect.");
    } 
```

这就是我检查我的用户是否在安全页面中登录的方式：

```
if (!WebSecurity.IsAuthenticated) {
    Response.Redirect("~/login", true);
} 
```

我在谷歌上搜索了一下，也很少有人抱怨 WebMatrix WebSecurity 随机注销用户。有时在执行活动时，例如表单提交或有时是简单的 url 点击。

有什么想法或建议吗？甚至有人建议我放弃 Razor 并转移到 MVC，它没有这个问题。我不确定那是否属实。

**更新**

我的所有安全页面顶部都有以下代码（需要用户登录）。有人认为这会导致问题吗？

```
// Ensure this page is not cached    
Response.Expires = -1;
Response.Cache.SetNoServerCaching();
Response.Cache.SetAllowResponseInBrowserHistory(false);
Response.CacheControl = "no-cache";
Response.Cache.SetNoStore(); 
```

谢谢-法拉兹·阿扎尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T18:02:29.340

I will have to check further, i remember some weirdo setting to increase the cookie stay-logged-in time. Here's what's in my config and i don't see anything else that has a time:

```
 <system.web>
    <customErrors mode="RemoteOnly" defaultRedirect="~/error/"></customErrors>
    <compilation debug="true" targetFramework="4.0" />
    <authentication>
      <forms timeout="10080" />
    </authentication> 
```

# c# - Telerik Openaccess ORM 更新对象和自动映射器

> ID：14707045
> 
> 赞同：0
> 
> 时间：2013-02-05T11:59:39.640
> 
> 标签：c#, orm, automapper, telerik-open-access, openaccess

我正在尝试使用 Telerik openaccess orm 和 automapper 更新对象，它适用于将对象添加到范围但不更新。

我在他们的网站上看到有人遇到同样的问题，但[答案](http://www.telerik.com/community/forums/orm/general-discussions/using-automapper-when-updating-an-object-and-all-of-its-children.aspx)并没有真正帮助我。这是我的代码，它不会更新我的对象：

```
try
            {
                if (!scope.Transaction.IsActive)
                    scope.Transaction.Begin();

                ObjQ objq = get_Q(scope, Id);
                bool isNew = false;

                if (objq == null)
                {
                    objq = new ObjQ();
                    isNew = true;
                }

                AutoMapper.Mapper.CreateMap<ObjQ , ObjQ >();

                objq = AutoMapper.Mapper.Map<ObjQ , ObjQ>(srcQ);

                if (isNew)
                {
                    scope.Add(objq);
                }

                scope.Transaction.Commit();

                success = true;
            } 
```

在这一行之后，我可以看到我的属性反映了新的变化，但它在数据库中不一样

```
objq = AutoMapper.Mapper.Map<ObjQ , ObjQ>(srcQ); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T14:01:28.740

对于其他想要做同样事情的人，设法这样做：

```
AutoMapper.Mapper.Map<ObjQ , ObjQ >(srcQ, objq); 
```

# c# - 实体框架执行时间

> ID：14707046
> 
> 赞同：1
> 
> 时间：2013-02-05T11:59:39.903
> 
> 标签：c#, .net, linq, frameworks, entity

我注意到今天使用 Entity Framework 的执行时间存在巨大差异。我想知道为什么第一个语句有这么多开销。对于这个查询，我正在从数据库中检索 5500 个趋势数据值（这应该没什么大不了的）。

这是我之前使用的语句：

```
TrendDataValues = new ObservableCollection<TrendDataValue>(_trendDataContext.TrendDatas.First(td => td.Id == argument.TrendDataId)
                                                                            .TrendDataValues
                                                                            .Where(tdv => tdv.ValueStartTimestamp >= argument.MinValue
                                                                                       && tdv.ValueStartTimestamp <= argument.MaxValue)); 
```

但是，此语句需要**10**多秒才能运行。

我已将第一个语句重写为以下语句。这将检索完全相同的数据。但是，此语句在**0.2**秒内返回值。

```
 TrendDataValues = new ObservableCollection<TrendDataValue>(from td in _trendDataContext.TrendDatas.Where(d => d.Id == trendDataId)
                                                            from tdv in td.TrendDataValues
                                                            where tdv.ValueStartTimestamp >= argument.MinValue
                                                               && tdv.ValueEndTimestamp <= argument.MaxValue
                                                            select tdv); 
```

有人可以澄清这两个陈述之间的区别吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T12:05:21.633

建议：下载[http://www.linqpad.net/](http://www.linqpad.net/)

将 LINQ-pad 连接到您的数据库。

运行这两个查询并查看 SQL 选项卡以查看查询生成的 SQL 是否存在差异。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T12:11:27.187

如果链式方法或查询语法相同，则生成的 sql 将是相同的，乍一看，在第二个示例中，您隐式创建了一个连接，即两个 from / where 语句的行为类似于内部连接，而首先，您没有并且可能正在创建链接方法必须搜索的某种形式的笛卡尔积。

正如另一个dood建议去使用LinqPad并检查生成的sql，我敢打赌它不一样。

PS 实际上，第二个示例实际上需要更长的时间来编译！但是如果两个示例在逻辑上是相同的，那么方法和查询语法将是相同的执行速度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T12:34:30.020

正如上面答案中的建议，我已经在 linqpad 中测试了这两个查询。

第一个运行以下查询：

```
SELECT TOP (1) [t0].[Id], [t0].[Tag], [t0].[Description], [t0].[PollingInterval], [t0].[Compression], [t0].[PlcLogDataTypeValue]
FROM [TrendDatas] AS [t0]
WHERE [t0].[Id] = @p0 
```

第二个运行以下查询：

```
SELECT [t1].[Id], [t1].[ValueStartTimestamp], [t1].[ValueEndTimestamp], [t1].[Value], [t1].[SerieNumber], [t1].[TrendData_Id]
FROM [TrendDatas] AS [t0], [TrendDataValues] AS [t1]
WHERE ([t1].[ValueStartTimestamp] >= @p0) AND ([t1].[ValueStartTimestamp] <= @p1) AND ([t0].[Id] = @p2) AND ([t1].[TrendData_Id] = [t0].[Id]) 
```

显然第一条语句只返回trenddata-parent 对象。我猜它是如何迭代它的值（子元素）的，因为我没有看到引用 TrendDataValues 表的查询或连接，但我猜这不会很漂亮。

第二个查询返回一个更好的结果，它完全符合我的要求。

感谢您的支持和+1的答案！

# python - 允许 Ctrl-C 中断 python C 扩展

> ID：14707049
> 
> 赞同：19
> 
> 时间：2013-02-05T11:59:52.190
> 
> 标签：python, linux, python-c-api

我正在（自制）基于 C 的 python 扩展中运行一些计算量很大的模拟。有时我会出错并想终止模拟。但是，Ctrl-C 似乎没有任何效果（除了打印`^C`到屏幕上），所以我必须使用`kill`或系统监视器终止进程。

据我所见，python 只是等待 C 扩展完成，并且在此期间并没有真正与它通信。

有没有办法使这项工作？

*更新*：主要答案（针对我的具体问题）结果是：1.重写代码以定期将控制权传递回调用者（回答[Allowing Ctrl-C to interrupt a python C-extension](https://stackoverflow.com/questions/14707049/allowing-ctrl-c-to-interrupt-a-python-c-extension/14707300#14707300)下面），或2.使用`PyErr_CheckSignals()`（在下面回答[https://stackoverflow.com/a/33652496/423420](https://stackoverflow.com/a/33652496/423420)）

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2015-11-11T14:18:59.697

> 但是，Ctrl-C 似乎没有任何效果

[`Ctrl-C`在 shell 中发送`SIGINT`到前台进程组](https://unix.stackexchange.com/q/149741/1321)。`python`在接收到信号时在 C 代码中设置一个标志。如果您的 C 扩展在主线程中运行，则不会运行 Python 信号处理程序（因此您不会`KeyboardInterrupt`在 上看到异常`Ctrl-C`），除非您调用[`PyErr_CheckSignals()`](https://docs.python.org/3/c-api/exceptions.html#c.PyErr_CheckSignals)它检查标志（这意味着：它不应该减慢您的速度）并运行 Python如有必要，或者您的模拟允许 Python 代码执行（例如，如果模拟使用 Python 回调），则使用信号处理程序。这是[使用 @Matt 建议的 pybind11 创建的 CPython 扩展模块的代码示例](https://pybind11.readthedocs.io/en/stable/faq.html#how-can-i-properly-handle-ctrl-c-in-long-running-functions)：

```
PYBIND11_MODULE(example, m)
{
    m.def("long running_func", []()
    {
        for (;;) {
            if (PyErr_CheckSignals() != 0)
                throw py::error_already_set();
            // Long running iteration
        }
    });
} 
```

如果扩展在后台线程中运行，那么释放 GIL 就足够了（允许 Python 代码在使信号处理程序运行的主线程中运行）。`PyErr_CheckSignals()` 总是`0`在后台线程中返回。

相关：[Cython、Python 和 KeybordInterrupt](https://stackoverflow.com/q/16769870/4279)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-05T13:21:46.857

Python 安装了一个信号处理程序，`SIGINT`它简单地设置一个由主解释器循环检查的标志。为了让这个处理程序正常工作，Python 解释器必须运行 Python 代码。

您有几个可用的选项：

1.  使用`Py_BEGIN_ALLOW_THREADS`/`Py_END_ALLOW_THREADS`释放您的 C 扩展代码周围的 GIL。不持有 GIL 时，您不能使用任何 Python 函数，但 Python 代码（和其他 C 代码）可能会与您的 C 线程（真正的多线程）同时运行。一个单独的 Python 线程可以与 C 扩展一起执行并捕获 Ctrl+C 信号。
2.  设置您自己的`SIGINT`处理程序并调用原始 (Python) 信号处理程序。然后，您的`SIGINT`处理程序可以执行它需要执行的任何操作来取消 C 扩展代码并将控制权返回给 Python 解释器。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-11-03T18:25:45.893

如果您不希望您的 C 扩展（或 ctypes DLL）与 Python 绑定，则有另一种方法可以解决此问题，例如您想要创建一个具有多种语言绑定的 C 库的情况，您必须允许您的C 扩展运行长时间，您可以修改 C 扩展：

在 C 扩展中包含信号头。

```
#include <signal.h> 
```

在 C 扩展中创建信号处理程序 typedef。

```
typedef void (*sighandler_t)(int); 
```

在 C 扩展中添加信号处理程序，以执行中断任何长时间运行的代码所需的操作（设置停止标志等），并保存现有的 Python 信号处理程序。

```
sighandler_t old_sig_int_handler = signal(SIGINT, your_sig_handler);
sighandler_t old_sig_term_handler = signal(SIGTERM, your_sig_handler); 
```

每当 C 扩展返回时，恢复现有的信号处理程序。此步骤可确保重新应用 Python 信号处理程序。

```
signal(SIGINT, old_sig_int_handler);
signal(SIGTERM, old_sig_term_handler); 
```

如果长时间运行的代码被中断（标志等），则将控制权返回给 Python，返回代码指示信号编号。

```
return SIGINT; 
```

在 Python 中，发送在 C 扩展中接收到的信号。

```
import os
import signal

status = c_extension.run()

if status in [signal.SIGINT, signal.SIGTERM]:
    os.kill(os.getpid(), status) 
```

Python 将执行您期望的操作，例如为 SIGINT 引发 KeyboardInterrupt。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T12:13:23.720

我会重新设计 C 扩展，使它们不会运行很长时间。

因此，将它们分成更基本的步骤（每个步骤运行时间很短，例如 10 到 50 毫秒），并让这些更基本的步骤由 Python 代码调用。

[延续传递风格](http://en.wikipedia.org/wiki/Continuation-passing_style)可能与理解相关，作为一种编程风格......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-12-29T15:41:14.043

不优雅，但我发现的唯一方法也中断了 C++ 中的外部库调用并杀死任何正在运行的子进程。

```
#include <csignal>
#include <pybind11/pybind11.h>

void catch_signals() {
  auto handler = [](int code) { throw std::runtime_error("SIGNAL " + std::to_string(code)); };
  signal(SIGINT, handler);
  signal(SIGTERM, handler);
  signal(SIGKILL, handler);
}

PYBIND11_MODULE(example, m)
{
    m.def("some_func", []()
    {
        catch_signals();
        // ...
    });
} 
```

```
import sys

from example import some_func

try:
    some_func()
except RuntimeError as e:
    if "SIGNAL" in str(e):
        code = int(str(e).rsplit(" ", 1)[1])
        sys.exit(128 + code)
    raise 
```

# asp.net-mvc - 果园分类按 displayType 改变形状

> ID：14707053
> 
> 赞同：2
> 
> 时间：2013-02-05T12:00:01.713
> 
> 标签：asp.net-mvc, orchardcms, orchardcms-1.6

我正在使用形状跟踪器，以便使用我的一个分类字段的替代视图，称为位置。然而，与其他形状不同，在这种情况下，替代品不提供不同显示类型的选项摘要或详细信息。因此，通过更改 1，您可以更改另一个。我需要能够独立完成它们。

我创建了一个视图，请参见**Fields.Contrib.TaxonomyField-Location.cshtml**，但正如我所说，如果显示类型是详细信息或摘要，则呈现相同的视图。

请问我该如何克服这个问题。

谢谢乔恩

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T12:58:28.340

[不久前我遇到了同样的问题](http://kobowi.co.uk/blog/2012/11/content-display-type-alternates-for-content-parts-in-orchard/)。`ShapeDisplayEvents`你可以通过实现一个类来提供你自己的替代品。

这是一个实现，它根据内容类型、显示类型或两者为您提供替代方案：

```
public class PartContentTypeAlternateFactory : ShapeDisplayEvents {
    public override void Displaying(ShapeDisplayingContext context) {
        context.ShapeMetadata.OnDisplaying(displayedContext => {
            var shapeType = displayedContext.ShapeMetadata.Type;
            var contentItem = displayedContext.Shape.ContentItem;
            var displayType = displayedContext.ShapeMetadata.DisplayType;
            var contentType = contentItem.ContentType;
            displayedContext.ShapeMetadata.Alternates.Add(
                String.Format("{0}__{1}", shapeType, displayType));
            displayedContext.ShapeMetadata.Alternates.Add(
                String.Format("{0}__{1}__{2}", shapeType, (string)contentType, displayType));
            });
    }
} 
```

您最终会在形状跟踪器中出现一些额外的替代项，如下所示：

![在此处输入图像描述](../Images/c8c9017e6a8231f8ac6bca209bd9518f.png)

你现在可以使用一个名为`Fields.Contrib.TaxonomyField-Location-Summary`or的替代品`Fields.Contrib.TaxonomyField-Location-Detail`。你可以扩展这个类来添加你想要的任何替代品。

**编辑**

我没有意识到你不能轻易地获得字段名称，所以尝试这样的事情 - 它做的事情类似于所做的事情`UrlAlternatesFactory`，即它循环现有的替代品并将 displayType 添加到它们。这应该为您提供一个包含字段名称和显示类型的替代项。

```
public class PartContentTypeAlternateFactory : ShapeDisplayEvents {
    public override void Displaying(ShapeDisplayingContext context) {
        context.ShapeMetadata.OnDisplaying(displayedContext => {
            var alternates = displayedContext.ShapeMetadata.Alternates.Select(a => a + "__" + displayedContext.ShapeMetadata.DisplayType);
            displayedContext.ShapeMetadata.Alternates = displayedContext.ShapeMetadata.Alternates.Union(alternates).ToList();
        });
    }
} 
```

# java - Java 可重用性

> ID：14707062
> 
> 赞同：0
> 
> 时间：2013-02-05T12:00:24.130
> 
> 标签：java, reusability

制作能够在各种应用程序中使用的 java 可重用组件的正确方法是什么。我的意思是，例如，我正在做一个有自己的用户界面和数据库等的应用程序。如果我想让这个应用程序作为其他应用程序的一个组件可用于许多其他应用程序。例如，我的第一个应用程序的一个功能可能需要其他应用程序。那么如何让其他应用程序可以在不更改我的原始代码的情况下使用我的应用程序的此功能。实现这种可重用性的正确方法是什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T12:02:13.020

写一些简单的东西，它做得很好。记录它并对其进行单元测试并使其开源。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T12:01:38.223

在另一个项目中拥有可重用的组件（例如“common”）并将它们打包为.jar。然后将该 jar 包含在需要的项目中。

不过，提取一个单独的项目可能会很棘手。您应该观察以下内容：

*   公共组件不应依赖于更高抽象级别的任何内容（即您的服务不得具有任何与 UI 相关的依赖项）
*   使用它们的应用程序不能看到组件的内部结构。即你的jar 应该暴露一个最小的API。

对于包装机制，您有两种选择：

*   简单的 IDE 依赖打包 - 声明项目间依赖。在构建时导出 jar 并放在客户端应用程序的类路径中
*   Maven/Ivy - 在存储库（本地或远程）中安装依赖项并使用 maven/ivy 的依赖项解析机制

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T14:01:01.067

这是一个*相当*广泛的问题。因此，我提出了广泛的建议：

*   了解您的 OO 基础知识。继承、封装、多态。从那里开始变得更加疯狂。
*   了解设计模式，开始在您已经使用的应用程序中观察它们。
*   查看流行的开放库，了解它们如何实现模式和模块。
*   在沙盒项目中尝试。在清洁的环境中增长您的知识。
*   既然您提到了 Java，请查看 Spring Framework。

希望有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T12:36:13.327

Java 语言的创建者 Sun Microsystems 终于意识到了这种需求，并发布了 Java Beans 组件体系结构。Java Bean 很简单，是用 Java 编写的可重用控件，用于 Java 应用程序开发。

Bean 是代码的“胶囊”，每一个都是为特定目的而设计的。Java Beans 相对于标准编程控件的优势在于 Beans 是独立的。它们并不特定于操作系统或开发环境。在一个开发环境中创建的 Bean 可以很容易地被另一个环境复制和修改。这使得 Java Beans 在企业计算中具有更大的灵活性，因为组件很容易在开发人员之间共享。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-05T12:06:04.710

您需要以使组件松散耦合的方式编写代码。然后可重用性非常高。看看[这个](http://www.javaworld.com/javatips/jw-javatip107.html)和[这个](http://edn.embarcadero.com/article/30372)。

# awk - 使用 awk 计算字符并相应地修改文件

> ID：14707063
> 
> 赞同：1
> 
> 时间：2013-02-05T12:00:24.867
> 
> 标签：awk, counting

我有一个看起来像这样的文件

```
@FCD17BKACXX:8:1101:2703:2197#0/1
CAGCTTTACTCGTCATTTCCCCCAAGGGTAAAATGCGTCCGTCCATTAAGTTCACAGTCATCGTCT
+FCD17BKACXX:8:1101:2703:2197#0/1
^`^\eggcghheJ`dffhhhffhe`ecd^a^_ceacecfhf\beZegfhh_fghhgfZbdg]c^a`
@FCD17BKACXX:8:1101:4434:2244#0/1
CTGCGTTCATCGCGTTGTTGGGAGGAATCTCTACCCCAGGTTCTCGCTGTGAA
+FCD17BKACXX:8:1101:4434:2244#0/1
eeecgeceeffhhihi_fhhiicdgfghiiihiiihiiihVbcdgfhge`cee
@FCD17BKACXX:8:1101:6394:2107#0/1
CAGCAGGACTAGGGCCTGCAGACGTACTG
+FCD17BKACXX:8:1101:6394:2107#0/1
eeeccggeghhiihiihihihhhhcfghf 
```

我想去每一行计算字符数。如果该行包含少于例如 66 个字符，则使用 'A' 将其填充到 66 并打印到新文件。如果它包含 66 个字符，则按原样打印该行。

输出文件如下所示；

```
@FCD17BKACXX:8:1101:2703:2197#0/1
CAGCTTTACTCGTCATTTCCCCCAAGGGTAAAATGCGTCCGTCCATTAAGTTCACAGTCATCGTCT
+FCD17BKACXX:8:1101:2703:2197#0/1
^`^\eggcghheJ`dffhhhffhe`ecd^a^_ceacecfhf\beZegfhh_fghhgfZbdg]c^a`
@FCD17BKACXX:8:1101:4434:2244#0/1
CTGCGTTCATCGCGTTGTTGGGAGGAATCTCTACCCCAGGTTCTCGCTGTGAAAAAAAAAAAAAAA
+FCD17BKACXX:8:1101:4434:2244#0/1
eeecgeceeffhhihi_fhhiicdgfghiiihiiihiiihVbcdgfhge`ceeAAAAAAAAAAAAA
@FCD17BKACXX:8:1101:6394:2107#0/1
CAGCAGGACTAGGGCCTGCAGACGTACTGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
+FCD17BKACXX:8:1101:6394:2107#0/1
eeeccggeghhiihiihihihhhhcfghfAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA 
```

我对 awk 有非常基本的了解，所以从学习的角度来看，我想使用 awk 来解决问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T12:09:28.370

单程：

```
awk '!(NR%2) && length<66{for(i=length;i<66;i++)$0=$0 "A"}1' file 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T12:07:19.577

```
awk 'NR%2 == 0{
    printf("%s", $0)
    for(i=length($0); i<66; i++)printf("A")
    print "";next }
    {print}' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T12:23:48.930

我会粘贴另一个**奇怪**的（也许）oneliner：

```
 awk 'BEGIN{while(++i<66)t=t"A"}!(NR%2){$0=$0substr(t,length)}1' file 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-06T07:53:42.487

这应该比公认的方法更快：

```
awk 'NR%2==0 { x = sprintf("%-66s", $0); gsub(/ /,"A",x); $0 = x }1' file 
```

结果：

```
@FCD17BKACXX:8:1101:2703:2197#0/1
CAGCTTTACTCGTCATTTCCCCCAAGGGTAAAATGCGTCCGTCCATTAAGTTCACAGTCATCGTCT
+FCD17BKACXX:8:1101:2703:2197#0/1
^`^\eggcghheJ`dffhhhffhe`ecd^a^_ceacecfhf\beZegfhh_fghhgfZbdg]c^a`
@FCD17BKACXX:8:1101:4434:2244#0/1
CTGCGTTCATCGCGTTGTTGGGAGGAATCTCTACCCCAGGTTCTCGCTGTGAAAAAAAAAAAAAAA
+FCD17BKACXX:8:1101:4434:2244#0/1
eeecgeceeffhhihi_fhhiicdgfghiiihiiihiiihVbcdgfhge`ceeAAAAAAAAAAAAA
@FCD17BKACXX:8:1101:6394:2107#0/1
CAGCAGGACTAGGGCCTGCAGACGTACTGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
+FCD17BKACXX:8:1101:6394:2107#0/1
eeeccggeghhiihiihihihhhhcfghfAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-05T13:48:17.127

```
awk -v FS= '{printf "%s",$0} !(NR%2){for (i=NF+1;i<=66;i++) printf "A"} {print ""}' 
```

或者如果你不喜欢循环：

```
awk -v FS= '{sfx=(NR%2 ? "" : sprintf("%*s",66-NF,"")); gsub(/ /,"A",sfx); print $0 sfx}' 
```

# iphone - iPhone开发中ARC和语义问题的错误

> ID：14707068
> 
> 赞同：0
> 
> 时间：2013-02-05T12:00:50.547
> 
> 标签：iphone, ios, ios6

当尝试从远程 Web 服务器解析 XML 文件时，我可以成功解析 XML 文件中的数据。我试图从 XML 文件中检索图像 URL 并将其分配给`UIImageView`视图控制器。这里出现以下错误，

*   `ARC Semantic Issue: No known class method for selector 'imageWithContentsOfUrl:'`

*   `Sematic Issue: Incompatible pointer types sending 'NSURL *__strong' to parameter of type 'NSString *'`

下面是我的代码，

```
//My View Controller
[super viewDidLoad];
 NSURL *url = [NSURL URLWithString:@"http://sample.com/Products.xml"];
 EGSParser *parser = [[EGSParser alloc] init];
// Error in below line( here firstImage is a UIImageView property)
 self.firstImage.image = [UIImage imageWithContentsOfUrl:[NSURL URLWithString:url]]; 
 if ([parser loadXMLByURL:url]) {
    NSLog(@"success; products=%@",parser.products);
 self.xmlProductsResults = parser.products;
}
else
{
 NSLog(@"Log Fail");
} 
```

请给我一个解决这个问题的想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T12:02:15.873

更改此行：

```
 self.firstImage.image = [UIImage imageWithContentsOfUrl:[NSURL URLWithString:url]]; 
```

到

```
 self.firstImage.image = [UIImage imageWithContentsOfFile:[NSString stringWithFormat:@"%@",url]]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T12:09:43.327

试试这个 ：-

代替

```
self.firstImage.image = [UIImage imageWithContentsOfUrl:[NSURL URLWithString:url]]; 
```

和

```
NSData *mydata = [[NSData alloc] initWithContentsOfURL:url];
self.firstImage.image = [UIImage imageWithData:mydata]; 
```

希望对你有帮助。。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T12:14:16.903

应该可以，换一个

```
self.firstImage.image = [UIImage imageWithContentsOfUrl:[NSURL URLWithString:url]] ; 
```

和

```
self.firstImage.image = [UIImage imageWithData:[NSData dataWithContentsOfURL:url]]; 
```

注意：NSUrl url 应该是图片 url

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-05T12:20:23.007

你有一个错字，它是`imageWithContentsOfURL:`(大写 URL) 而不是`imageWithContentsOfUrl:`. 这就是无法识别类方法的原因。

编辑：另外，它是`CIImage`and not的一种方法`UIImage`。

# javascript - 如何从 ajax 调用中解压缩压缩的 xml 文件？

> ID：14707069
> 
> 赞同：0
> 
> 时间：2013-02-05T12:00:54.087
> 
> 标签：javascript, ajax, zip

在我的网站上，我展示了大量编号的车辆路径。我通过ajax获取坐标，但有时由于文件大小太慢。我想压缩它，没关系，但在我处理javascript（使用jQuery）中的xml之前我无法解压缩它。不幸的是，我不能在服务器端使用 php。有人知道吗？

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T12:30:56.550

[如果您查看解压缩文件](https://stackoverflow.com/questions/2095697/unzip-files-using-javascript)（包含[zip.js](http://gildas-lormeau.github.com/zip.js/)的答案），Stackoverflow上已经有一些解决方案。这是一篇关于使用 javascript 跨浏览器（包括 IE）解压的博[文](http://blog.another-d-mention.ro/programming/read-load-files-from-zip-in-javascript/)。

> 其他解决方案可能是将带有 ajax 的 json（例如文件路径）发送到服务器，并让服务器语言为您解压缩文件，并在完成任务后做出响应。

不确定您使用的是哪种服务器端语言。但是有很多资源

*   PHP[类](http://www.phpclasses.org/package/2495-PHP-Pack-and-unpack-files-packed-in-ZIP-archives.html)
*   蟒蛇[gzip](http://docs.python.org/2/library/gzip.html)
*   Java[如何从 ZIP 文件中解压缩文件](http://www.mkyong.com/java/how-to-decompress-files-from-a-zip-file/)
*   ASP.NET[以编程方式解压缩 rar/zip 文件 RSS](http://forums.asp.net/t/1428916.aspx)

> **谢谢，我检查了它，但它不是跨浏览器的解决方案。**但我需要这样的东西。[克里](https://stackoverflow.com/users/469962/kree)

我建议使用一些服务器端语言来处理您的`zip`文件，因为这将是最简单的`cross-browser`解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T12:02:19.900

使用[HTTP 压缩](http://en.wikipedia.org/wiki/HTTP_compression)对其进行压缩，它将对您的 JavaScript 完全透明。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T12:03:39.943

最好让它更透明，就像在 PHP 中一样：

```
ob_start('ob_gz_handler');
header('Content-Type: application/json');
echo json_encode($data); 
```

这将使用 gzip 压缩发送输出，浏览器会自动为您解压缩。

或者，Web 服务器本身可以负责压缩任何服务器端脚本生成的输出。

# java - 升级到 JRE 1.7.0_13 后的小程序类名称错误

> ID：14707070
> 
> 赞同：2
> 
> 时间：2013-02-05T12:00:58.190
> 
> 标签：java, oracle, firefox, xul

我有一个 Firefox 扩展，它加载了扩展本身包含的 Java jar。我曾经使用 window.java DOM 对象，所以我可以这样做

```
var loader = java.net.URLClassLoader.newInstance(urls);
const myClassRef = java.lang.Class.forName("com.me.program", true, loader);
var myJavaObject = myClassRef.newInstance();
//use LiveConnect to directly call stuff on my object now. 
```

`file:///`在我的扩展程序的 JS 代码中，其中 urls 是一个包含jar 文件的 uri 的数组。

当 Firefox 删除 window.java 时，我开始在标签中嵌入一个小程序以获取对 java 的引用：

```
<html:embed id ="appletID" type="application/x-java-applet" 
    code="java.applet.Applet"  pluginspage="http://java.com/download/"  MAYSCRIPT="true" width="0" height="0" />

....

var ref = document.getElementById("appletID");
window.java = ref.Packages.java; 
```

这在更新到 7u13 后不再起作用，大概是由于不再支持 embed 标记中的 code 属性。我应该怎么做才能解决这个问题？

我已经尝试直接使用`archive=`指向我的小程序的属性，但问题是因为我在 Firefox 扩展中，所以一切都变成`chrome://`了 JRE 仍然无法处理的`file://`uris，而且似乎不支持 uris（我得到通用权限被拒绝消息）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T14:42:29.610

[这是在https://bugzilla.mozilla.org/show_bug.cgi?id=748343](https://bugzilla.mozilla.org/show_bug.cgi?id=748343)的评论 74 和 75 中提出并回答的。

简而言之，最新的 Java 插件不允许`code="java.applet.Applet"`. 而且似乎没有办法让插件访问扩展中的 jar 文件。解决方法是将 jar 文件放在可公开访问的 HTTP 站点；jar 文件只需要包含一些琐碎的小程序，例如`public class Applet extends java.applet.Applet { }`. 这是从 Firefox bugzilla 注释复制的覆盖 HTML：

```
<html:div name="appletDiv">
    <html:embed id ="appletID" type="application/x-java-applet" 
        archive="https://mysite.com/applet.jar" code="Applet" 
        pluginspage="http://java.com/download/"  
        MAYSCRIPT="true" width="0" height="0" />     
</html:div> 
```

# sql - PDO - 连接 - 如何保护

> ID：14707076
> 
> 赞同：0
> 
> 时间：2013-02-05T12:01:16.303
> 
> 标签：sql, pdo, sql-injection

$_pdo = new Data('mysql:host='.$db_host.';dbname='.$db_name.';port='.$db_port, $db_user, $db_pass, array(PDO::MYSQL_ATTR_INIT_COMMAND => 'SET NAMES '.$charset));

变量来自形式。如果我不去除这个变量，用户可以进行 sql 注入吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T12:21:30.230

在任何情况下，连接凭据**都不应**来自用户。
您必须将它们存储在您的服务器中的某个配置文件中。然后与连接字符串一起使用。
请注意，字符集应该在 DSN 中设置，而不是选项。

```
include 'settings.php';
$dsn = "mysql:host=$db_host;dbname=$db_name;port=$db_port;charset=$charset";
$pdo = new Data($dsn, $db_user, $db_pass); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T23:05:31.857

如果您接受来自表单的输入来创建连接，我可能会在使用它之前使用一些清理功能来清理它。如果将其存储在文本文件或数据库中，最好在保存之前以及在使用之前对其进行清理。

[http://php.net/manual/en/function.filter-var.php](http://php.net/manual/en/function.filter-var.php)

```
$db_host = filter_var($db_host,FILTER_SANITIZE_FULL_SPECIAL_CHARS); 
```

> 相当于调用 htmlspecialchars() 并设置了 ENT_QUOTES。可以通过设置 FILTER_FLAG_NO_ENCODE_QUOTES 来禁用编码引号。与 htmlspecialchars() 一样，此过滤器知道 default_charset，如果检测到构成当前字符集中无效字符的字节序列，则整个字符串将被拒绝，从而导致长度为 0 的字符串。 [http://www.php.net/manual/en/filter.filters.sanitize.php](http://www.php.net/manual/en/filter.filters.sanitize.php)

# c++ - 如何添加不同类型的属性图？

> ID：14707077
> 
> 赞同：1
> 
> 时间：2013-02-05T12:01:24.717
> 
> 标签：c++, oop, c++11, dynamic-typing

这是一个 C++(11) 设计问题：

假设我想创建一个图形数据结构，您可以在其中将节点/边映射到任意属性。（它是一个图表并不真正相关，它可能是具有属性的元素的任何容器，但这是我的示例。）

使用这样的数据结构，我可以为所有节点动态添加一个新属性：

```
Graph G;

G.addNodeMap("color", "white"); // map name, default value 
```

...然后将其设置为节点：

```
node v;
G.setAttr("color", v, "blue"); 
```

...并删除该属性以节省内存：

```
G.deleteNodeMap("color"); 
```

`G.addNodeMap`获取地图的标识符（可能是字符串）和条目的默认值。使用 C++11，`T`“节点映射”的类型可以方便地从给定的默认参数中推断出来。节点映射本身可能是 a `std::vector<T>`，因为节点只是一个索引。

问题：我在哪里存储向量`std::vector<std::string> map1`, `std::vector<std::double> map2`, `std::vector<Foo> map3`.... ？

动态类型语言不会出现此问题。如何用 C++ 实现这种行为？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T13:08:42.900

您可能想查看[**Boost.Graph 库**](http://www.boost.org/libs/graph/doc/using_property_maps.html)(BGL)的属性映射

> 图的抽象数学性质和它们用来解决的具体问题之间的主要联系是附加到图的顶点和边的属性，例如距离、容量、权重、颜色等。有很多方法根据数据结构实现将属性附加到图，但图算法不应该处理属性的实现细节。Section Property Map Concepts 中定义的属性映射接口提供了一种从图形访问属性的通用方法。这是 BGL 算法中用于访问属性的接口。

# onclick - 基于屏幕大小的不同 highslide onclick 事件

> ID：14707078
> 
> 赞同：0
> 
> 时间：2013-02-05T12:01:31.143
> 
> 标签：onclick, highslide

我正在升级我们的网站，所以它是响应式的。

目前，我的一个典型链接具有 onclick 功能的硬编码宽度：

我使用的一个示例如下：

```
<a href="#" onclick="return hs.htmlExpand(this, { width: 700 } )">

<b>This is the title</b></a>

<div class="highslide-maincontent" style="font-weight:normal"> 

This is where the content is

</div> 
```

但是我希望它在分辨率超过 500 像素时具有它，并且我希望它具有 90% 的宽度

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T15:40:53.603

您可以使用 CSS 设置弹出窗口的宽度，而不是使用 onclick 中的 width 变量。
定义*宽度：700px；**对于所有浏览器宽度，并用width: 90%*覆盖它；当浏览器的最大宽度为 500 像素时。

使用不带宽度变量的 onclick：

```
onclick="return hs.htmlExpand(this)" 
```

在页面 head 部分的 highslide.css 文件下方添加以下内容：

```
<style type="text/css" media="all">
.highslide-html-content {
    width: 700px;
}
</style>
<style type="text/css" media="(max-width: 500px)">
.highslide-html-content {
    width: 90%;
}
</style> 
```

# ios - JSON 解析后 -viewForAnnotation 在 MKMapView 上仅显示一个注释

> ID：14707080
> 
> 赞同：1
> 
> 时间：2013-02-05T12:01:32.370
> 
> 标签：ios, objective-c, mkmapview, afnetworking, mkannotationview

我需要在我的 MkMapView 上显示大约 10 个位置（以及相应的注释），按下按钮后，我需要根据不同的 JSON 解析结果添加新的不同注释（例如 locationIDValue < 100 表示红色引脚，否则为绿色）。这是简化的代码：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    map.showsUserLocation = true;
    map.mapType = MKMapTypeStandard;

    arrayID = [[NSMutableArray alloc] initWithObjects: @"id1", @"id2", @"id3", @"id4", @"id5", @"id6", @"id7", @"id8", @"id9", @"id10", nil]; 

    #define MakeLocation(lat,lon) [[CLLocation alloc] initWithLatitude:lat longitude:lon]

    locations= @[ MakeLocation(lat1,lon1), MakeLocation(lat2,lon2), MakeLocation(lat3,lon3), MakeLocation(lat4,lon4), MakeLocation(lat5,lon5), MakeLocation(lat6,lon6), MakeLocation(lat7,lon7), MakeLocation(lat8,lon8), MakeLocation(lat9,lon9), MakeLocation(lat10,lon10) ];

    for (int l=0; l<[locations count]; l++) { // HERE ITS PERFECT! I CAN SEE ALL 10 ANNOTATIONS!
        MKPointAnnotation* annotation= [MKPointAnnotation new];
        annotation.coordinate = [locations[l] coordinate];
        [map addAnnotation: annotation];
    }
} 
```

和

```
 - (IBAction)parseMethod {

        [map removeAnnotations:map.annotations];

        for (int i=0; i < [arrayID count]; i++) { // arrayID contains ID values to parse for each location

            NSURL *url = [NSURL URLWithString:
                          [NSString stringWithFormat:
                           @"http://JSONPARSINGURL/%@",[arrayID objectAtIndex:i]]];

            NSURLRequest *request = [NSURLRequest requestWithURL:url cachePolicy:NSURLRequestReloadIgnoringLocalAndRemoteCacheData timeoutInterval:5.0];
            operation = [AFJSONRequestOperation JSONRequestOperationWithRequest:request success:^(NSURLRequest *request, NSHTTPURLResponse *response, id JSON) {

        // PARSING CODE . . .

                NSMutableArray *value = [JSON objectForKey:@"value"];
                NSMutableDictionary *value0 = [value objectAtIndex:0];
                [valueID replaceObjectAtIndex:i withObject:[value0 objectForKey:@"valueID"]];
                locationIDValue = [[valueID objectAtIndex:i] intValue]; // locationIDValue contains the values that i must use to put different annotations on the map

                NSLog(@"locationIDValue: %d", locationIDValue); // here I control IF app parses all the values of locationIDValue

                [table reloadData]; // here I put another control to see all values parsed

            }
                                                                        failure:^(NSURLRequest *request, NSHTTPURLResponse *response, NSError *error, id JSON) {
                                                                            NSLog(@"FAILURE");
                                                                        }];

            NSOperationQueue *queue = [[NSOperationQueue alloc] init]; // I have used also simple [operation start] but I have same issue!
            [queue addOperation:operation];
            [queue waitUntilAllOperationsAreFinished];

    }

        NSLog(@"END PARSING"); // here I control the end of parsing, so now I can add new annotations to MKMapView according to locationIDValue array

        MKPointAnnotation *annotation = [[MKPointAnnotation alloc] init];
        for (int l=0; l<[locations count]; l++) { // HERE I CAN SEE ONLY A SINGLE LOCATION!
            annotation.coordinate = [locations[l] coordinate];

            NSLog(@"%f - %f", annotation.coordinate.latitude, annotation.coordinate.longitude); // here I control IF app parses all the values of coordinates

            [map addAnnotation: annotation];
        }

    } 
```

和

```
- (MKAnnotationView *) mapView:(MKMapView *)mapView viewForAnnotation:(id <MKAnnotation>)annotation {

    MKPinAnnotationView *pinView=[[MKPinAnnotationView alloc] initWithAnnotation:annotation reuseIdentifier:@"pinView"];
    pinView.animatesDrop=YES;

    if (annotation != map.userLocation)
    {
        if ( locationIDValue <= 100) {
            pinView.pinColor = MKPinAnnotationColorRed;
            return pinView;
        }
        pinView.pinColor = MKPinAnnotationColorGreen;
        return pinView;
    }
    else
    map.userLocation.title = @"My position";
    return nil;
} 
```

**情况：** 当我第一次打开应用程序时，我可以看到地图上的所有注释，根据#define MakeLocation纬度和经度；但是如果我按下按钮并启动 parseMethod，我等待几秒钟（根据 NSOperationQueue，但我也可以在没有队列的情况下测试它，使用简单的 [操作开始] 代码），然后我只能在地图上看到一个注释，总是一样的，奇怪的是在第五个位置，带有 lat5-lon5 坐标（否则，如果我更改一些代码，我可以看到所有注释都落在同一个位置）。如您所见，我编写了一些 NSLog 代码并添加 UITableView 来控制活动，结果如下：

```
END PARSING
coordinates: lat1 - lon1
coordinates: lat2 - lon2
coordinates: lat3 - lon3
coordinates: lat4 - lon4
coordinates: lat5 - lon5   <--- THE STRANGE POSITION
coordinates: lat6 - lon6
coordinates: lat7 - lon7
coordinates: lat8 - lon8
coordinates: lat9 - lon9
coordinates: lat10 - lon10
locationIDValue: 100
locationIDValue: 90
locationIDValue: 50
locationIDValue: 120
locationIDValue: 20
locationIDValue: 40
locationIDValue: 80
locationIDValue: 180
locationIDValue: 140
locationIDValue: 10 
```

好吧，看起来很完美：应用程序解析所有数据（也是一个 UITableView 填充行，其中包含所有解析的新值），所以在解析操作结束后，我认为我们拥有用新注​​释填充地图所需的每个值。好吧，这里有什么问题？为什么解析后我只能看到一个注释？或者，所有注释都放在同一个位置？请给我一个帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T18:35:29.383

在`parseMethod`中，改变这个：

```
MKPointAnnotation *annotation = [[MKPointAnnotation alloc] init];
for (int l=0; l<[locations count]; l++) { // HERE I CAN SEE ONLY A SINGLE LOCATION!
    annotation.coordinate = [locations[l] coordinate];

    NSLog(@"%f - %f", annotation.coordinate.latitude, annotation.coordinate.longitude); // here I control IF app parses all the values of coordinates

    [map addAnnotation: annotation];
} 
```

对此：

```
for (int l=0; l<[locations count]; l++) { // HERE I CAN SEE ONLY A SINGLE LOCATION!

    //create a NEW annotation for each location...
    MKPointAnnotation *annotation = [[MKPointAnnotation alloc] init];

    annotation.coordinate = [locations[l] coordinate];

    NSLog(@"%f - %f", annotation.coordinate.latitude, annotation.coordinate.longitude); // here I control IF app parses all the values of coordinates

    [map addAnnotation: annotation];
} 
```

将`MKPointAnnotation *annotation = [[MKPointAnnotation alloc] init]`to 移到for 循环*内*，以便为每个位置创建一个新的注释对象。

那里的现有代码创建了一个注释对象并不断修改其坐标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-06T08:22:56.650

还有一点需要注意（因为很难找到那个错误，我昨晚整晚都坐在这个前面......）是检查你的符合 MKAnnotation 的对象是否有一些主基类来实现方法 isEqual 和/或仅对基类的数据进行散列，并且您不会在基类中覆盖它。这是我的问题，因此 isEqual 对所有注释都返回 YES，因此它在地图上始终只显示一个注释。我在互联网上找不到任何关于此的提示，因此我至少会在此处为处于相同情况的穷人留下此评论。

# hibernate-search - 使用 includePaths 映射抽象类

> ID：14707081
> 
> 赞同：0
> 
> 时间：2013-02-05T12:01:34.213
> 
> 标签：hibernate-search

我有一个关于 Hibernate Search 映射和使用抽象基类的问题。我收到以下错误

```
Caused by: org.hibernate.search.SearchException: Found invalid @IndexedEmbedded->paths configured on class nl.project.model.social.AbstractGroup, member language: language.id
    at org.hibernate.search.engine.spi.AbstractDocumentBuilder.validateAllPathsEncountered(AbstractDocumentBuilder.java:901)
    at org.hibernate.search.engine.spi.AbstractDocumentBuilder.checkForIndexedEmbedded(AbstractDocumentBuilder.java:880)
    at org.hibernate.search.engine.spi.AbstractDocumentBuilder.initializeMemberLevelAnnotations(AbstractDocumentBuilder.java:489)
    at org.hibernate.search.engine.spi.AbstractDocumentBuilder.initializeClass(AbstractDocumentBuilder.java:391)
    at org.hibernate.search.engine.spi.AbstractDocumentBuilder.<init>(AbstractDocumentBuilder.java:174)
    at org.hibernate.search.engine.spi.DocumentBuilderContainedEntity.<init>(DocumentBuilderContainedEntity.java:60)
    at org.hibernate.search.spi.SearchFactoryBuilder.initDocumentBuilders(SearchFactoryBuilder.java:396)
    at org.hibernate.search.spi.SearchFactoryBuilder.buildNewSearchFactory(SearchFactoryBuilder.java:222)
    at org.hibernate.search.spi.SearchFactoryBuilder.buildSearchFactory(SearchFactoryBuilder.java:146)
    at org.hibernate.search.event.impl.FullTextIndexEventListener.initialize(FullTextIndexEventListener.java:130)
    at org.hibernate.search.hcore.impl.HibernateSearchIntegrator.integrate(HibernateSearchIntegrator.java:83)
    at org.hibernate.internal.SessionFactoryImpl.<init>(SessionFactoryImpl.java:301)
    at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1750) 
```

基于以下映射配置

```
@Entity
@Table
@Inheritance(strategy = InheritanceType.SINGLE_TABLE)
@DiscriminatorColumn(name = "DTYPE", discriminatorType= DiscriminatorType.STRING, length = 3)
@Indexed
public abstract class AbstractGroup implements Serializable, IEntity, IPhoto{

    protected Language language;

    @ManyToOne(fetch=FetchType.LAZY, cascade=CascadeType.ALL)
    @JoinColumn(name="FK_LanguageId")
    @Cache(usage=CacheConcurrencyStrategy.NONSTRICT_READ_WRITE,region=CacheRegion.NEVERCHANGE)
    @NotNull
    @IndexedEmbedded(includePaths={"id"})
    public Language getLanguage() {
        return language;
    }
}

@Entity
@DiscriminatorValue(value = "GRP")
@Cache(usage=CacheConcurrencyStrategy.NONSTRICT_READ_WRITE,region=CacheRegion.GROUP)
public class Group extends AbstractGroup{

@Entity
@DiscriminatorValue(value = "PGE")
@Cache(usage=CacheConcurrencyStrategy.NONSTRICT_READ_WRITE,region=CacheRegion.GROUP)
public class Page extends AbstractGroup{ 
```

我尝试将@Indexed 放在子类上，但这会产生相同的错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T10:52:46.513

@Indexed注释*确实*应该在子类上。但是，我不确定这与鉴别器列有什么关系。JPA 和 Search 注释应该是正交的。真的是两种不同的东西。顺便说一句，您的*语言*实体如何？另见[https://forum.hibernate.org/viewtopic.php?f=9&t=993097&hilit=abstract+base+class](https://forum.hibernate.org/viewtopic.php?f=9&t=993097&hilit=abstract+base+class)

# android - 如何用蓝牙连接安卓设备

> ID：14707086
> 
> 赞同：0
> 
> 时间：2013-02-05T12:01:39.103
> 
> 标签：android, bluetooth

我正在尝试通过蓝牙连接安卓设备，但我无法连接

我在下面有简单的代码

```
BluetoothAdapter adapter = BluetoothAdapter.getDefaultAdapter(); 
```

但是我得到了结果`adapter=null`并且不支持蓝牙。中止。

如何通过模拟器连接蓝牙？这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T12:04:39.673

需要使用物理设备，不能在模拟器上使用BT。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T12:08:58.057

无法使用模拟器连接到蓝牙。如果您的 PC 具有蓝牙功能，您可以使用您的应用程序连接到 Android 设备。

# sql-server-2008-r2 - SQL Server 管理扩展

> ID：14707089
> 
> 赞同：0
> 
> 时间：2013-02-05T12:01:46.967
> 
> 标签：sql-server-2008-r2, ssms

我们正在使用多租户架构，而不是基于分区，而是拥有大量数据库。我们决定进行一些测试

生成 5 000 个数据库模式，每个模式包含约 100 个数据库对象。总共有 250k 个表和 250k 个其他数据库对象（键、索引）。

发现缺点：

1.  尝试从 SQL MGMT Studio 打开表列表——大约需要 10-15 分钟。MGMT Studio 分配了 ~ 700 Mb 的 RAM
2.  DB Utilities 不工作——试过 Red Gate、DB Forge、Adept SQL Diff

像这样管理和运行 SQL Server 时有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T08:38:35.927

尝试使用从命令提示符运行的[sqlcmd 实用程序。](http://msdn.microsoft.com/en-us/library/ms162773.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T13:46:27.867

You could try writing your own management tool, targeted specifically at what you need using SMO:

[Creating SMO Programs - MSDN](http://msdn.microsoft.com/en-us/library/ms162202.aspx)

That way you could simplify the program and load only what is required and potentially increasing performance.

# ios - 将文件添加到 MFMailComposeViewController 中的传出消息？

> ID：14707092
> 
> 赞同：1
> 
> 时间：2013-02-05T12:02:11.657
> 
> 标签：ios, xcode, email, smtp

如何使用 smtp 发件人示例将文件添加到消息中，例如：

[锁定 MFMailComposeViewController 中的字段](https://stackoverflow.com/questions/6284599/mfmailcomposeviewcontroller-question-locking-the-fields/6287412#6287412)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T12:22:06.727

您可以使用 SKSMTPMessage 的这个分支：[https ://github.com/jetseven/skpsmtpmessage](https://github.com/jetseven/skpsmtpmessage)

有一个使用文件发送电子邮件的演示项目，查看此源文件：[https ://github.com/jetseven/skpsmtpmessage/blob/master/Demo/Classes/SMTPSenderAppDelegate.m](https://github.com/jetseven/skpsmtpmessage/blob/master/Demo/Classes/SMTPSenderAppDelegate.m)

你需要这些行：

```
NSDictionary *plainPart = [NSDictionary dictionaryWithObjectsAndKeys:@"text/plain",kSKPSMTPPartContentTypeKey,
                               @"This is a tést messåge.",kSKPSMTPPartMessageKey,@"8bit",kSKPSMTPPartContentTransferEncodingKey,nil];

NSString *vcfPath = [[NSBundle mainBundle] pathForResource:@"test" ofType:@"vcf"];
NSData *vcfData = [NSData dataWithContentsOfFile:vcfPath];

NSDictionary *vcfPart = [NSDictionary dictionaryWithObjectsAndKeys:@"text/directory;\r\n\tx-unix-mode=0644;\r\n\tname=\"test.vcf\"",kSKPSMTPPartContentTypeKey,
                         @"attachment;\r\n\tfilename=\"test.vcf\"",kSKPSMTPPartContentDispositionKey,[vcfData encodeBase64ForData],kSKPSMTPPartMessageKey,@"base64",kSKPSMTPPartContentTransferEncodingKey,nil];

testMsg.parts = [NSArray arrayWithObjects:plainPart,vcfPart,nil]; 
```

其中 testMsg 是`SKPSMTPMessage`类的一个实例

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T11:09:46.543

我刚刚找到了另一个用于在 iOS 上发送电子邮件的库：[MailCore](http://libmailcore.com/)

有一个特殊的类用于向电子邮件添加附件：[CTCoreAttachment](http://libmailcore.com/api/Classes/CTCoreAttachment.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T12:23:48.103

如果我这样做，它会将pdf文件和PNG文件附加到信中吗？

NSDictionary *plainPart = [NSDictionary dictionaryWithObjectsAndKeys:@"text/plain",kSKPSMTPPartContentTypeKey, @"这是一个测试消息。",kSKPSMTPPartMessageKey,@"8bit",kSKPSMTPPartContentTransferEncodingKey,nil];

```
NSString *vcfPath = [[NSBundle mainBundle] pathForResource:@"test" ofType:@"pdf"];
NSData *vcfData = [NSData dataWithContentsOfFile:vcfPath];

NSDictionary *vcfPart = [NSDictionary dictionaryWithObjectsAndKeys:@"text/directory;\r\n\tx-unix-mode=0644;\r\n\tname=\"test.pdf\"",kSKPSMTPPartContentTypeKey,
                         @"attachment;\r\n\tfilename=\"test.pdf\"",kSKPSMTPPartContentDispositionKey,[vcfData encodeBase64ForData],kSKPSMTPPartMessageKey,@"base64",kSKPSMTPPartContentTransferEncodingKey,nil];
NSString *vcfPath1 = [[NSBundle mainBundle] pathForResource:@"test" ofType:@"png"];
NSData *vcfData1 = [NSData dataWithContentsOfFile:vcfPath1];

NSDictionary *vcfPart1 = [NSDictionary dictionaryWithObjectsAndKeys:@"text/directory;\r\n\tx-unix-mode=0644;\r\n\tname=\"test.png\"",kSKPSMTPPartContentTypeKey,
                         @"attachment;\r\n\tfilename=\"test.png\"",kSKPSMTPPartContentDispositionKey,[vcfData1 encodeBase64ForData],kSKPSMTPPartMessageKey,@"base64",kSKPSMTPPartContentTransferEncodingKey,nil];
testMsg.parts = [NSArray arrayWithObjects:plainPart,vcfPart,vcfPart1,nil]; 
```

# google-app-engine - GAE：数据存储写回极度延迟

> ID：14707096
> 
> 赞同：0
> 
> 时间：2013-02-05T12:02:15.383
> 
> 标签：google-app-engine, google-cloud-datastore

在过去的 12 小时内，我们注意到两个 HRD 数据存储区写回严重延迟的实例：

(1) 在 2013 年 2 月 4 日美国东部标准时间晚上 9:58 保存了一个新实体（它的 ID 已写入我们的服务器日志），但通过一对一的外键查找不会检索结果超过距美国东部标准时间 2013 年 2 月 5 日凌晨 2 点 17 分还有 4 小时。

(2) 一个实体在 2013 年 2 月 5 日美国东部标准时间上午 1:51 被删除，但 10 分钟后的美国东部标准时间 2:01，它仍在查询中返回。

我向 GAE 提交了一个问题：[http ://code.google.com/p/googleappengine/issues/detail?id=8776](http://code.google.com/p/googleappengine/issues/detail?id=8776)

我们以前从未见过这样的事情，而且一晚上出现两次。有没有其他人观察到这一点？

# ruby-on-rails - Ruby/Rails - 每当任务导致错误

> ID：14707104
> 
> 赞同：2
> 
> 时间：2013-02-05T12:02:41.280
> 
> 标签：ruby-on-rails, ruby, raspberry-pi, whenever

我对 Ruby on Rails 非常陌生，并用它构建了一个小型 DemoApp。这个应用程序收集一些网络数据并将其存储在数据库中。此任务每分钟随时完成。我在 Ubuntu 上开发并测试了它，它运行得非常好。

现在，我想将此应用程序部署到我的 Raspberry Pi。我在上面安装了 rvm、ruby、rails 等并启动了 rails 服务器。奇怪的是，收集和存储网络数据的后台工作似乎不起作用。所以我自己执行了它并得到了这个：

```
script/rails runner -e development 'LogEntry.updateRecords'
/home/user/.rvm/gems/ruby1.9.3-p374/gems/sqlite3-1.3.7/lib/sqlite3/sqlite3_native.so: [BUG] Segmentation fault
ruby 1.8.7 (2012-02-08 patchlevel 358) [arm-linux-eabihf] 
```

当我使用“rails 控制台”时，LogEntry.update 再次完美运行。

时间表.rb：

```
every 1.minute do
runner "LogEntry.updateRecords", :environment => :development
end 
```

结果 crontab 条目：

```
# Begin Whenever generated tasks for: store
PATH=/home/user/.rvm/gems/ruby-1.9.3-p374/bin:/home/user/.rvm/gems/ruby-1.9.3-p374@global/bin:/home/user/.rvm/rubies/ruby-1.9.3-p374/bin:/home/user/.rvm/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/local/games:/usr/games

* * * * * /bin/bash -l -c 'cd /home/user/WhoIsOnline/AWE13-Exercise-1 && script/rails runner -e development '\''LogEntry.updateRecords'\'''

# End Whenever generated tasks for: store 
```

红宝石-v

```
ruby 1.9.3p194 (2012-04-20 revision 35410) [arm-linux-eabihf] 
```

经过大量不同的 rvm 设置和谷歌搜索，我希望你们能帮助我。

# php - 我应该根据 2013 年 2 月的重大变更更改 facebook 登录代码吗？

> ID：14707110
> 
> 赞同：0
> 
> 时间：2013-02-05T12:03:11.187
> 
> 标签：php, facebook, facebook-graph-api, facebook-login

在我的网站中，我使用 facebook 实现了登录。但我收到一条通知，称 Facebook 将永久更改某些功能。此处描述了[2013 年 2 月的重大更改。](https://developers.facebook.com/roadmap/#february-2013).

根据这个我应该更改我的登录代码吗？或者它不会影响现有代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T12:27:28.267

机会非常高，你不应该改变你的实现。

如果您使用经过身份验证的推荐，您只需要采用一些东西。与登录功能相关的所有其他内容保持不变。

# vb.net - AxAcroPDF 关于选择

> ID：14707112
> 
> 赞同：0
> 
> 时间：2013-02-05T12:03:20.267
> 
> 标签：vb.net, winforms, pdf, axacropdf

我有一个 VB winform，我在其中将 PDF 加载到 AxAcroPDF。如果我在此表单上选择，我可以右键单击并将此选择复制到剪贴板。

`"C:\temp\temp.bmp"`当我做这个选择时，有什么方法可以覆盖它并将这个选择保存为喜欢的？我设法通过类似的东西在 PictureBox 上做出这样的选择

```
... Handles PictureBox1.Mousedown 
```

这些选项不适用于 AxAcroPDF。

所以，我想要的是我所做的每一个选择都会创建/覆盖`"C:\temp\temp.bmp"`，有什么想法吗？

编辑：一种方法是使用该剪贴板功能，例如按下按钮时。我是这样想的；用户进行选择，点击按钮，它发送“Ctrl + C”，从剪贴板中获取最新项目并将其制作成图像。这可行，但问题是用户必须进行选择，然后手动按 Ctrl + C （或右键单击并单击复制），然后按下按钮并获取最新的剪贴板图像。我如何告诉它从 AxAcroPDF 制作这个 Ctrl + C ？

像这样：

```
Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click

    SendKeys.Send("^(c)") 'this will not make the copy from the AxAcroPDF

    Dim tempImg As IDataObject = Clipboard.GetDataObject()

    If tempImg.GetDataPresent(DataFormats.Bitmap) Then
        PictureBox1.Image = tempImg.GetData(DataFormats.Bitmap, True) 'just display it in a picturebox, the plan is actually to save it

    End If
End Sub 
```

# iphone - 如何使用 IOS 模拟器以编程方式发送 SMS

> ID：14707113
> 
> 赞同：-2
> 
> 时间：2013-02-05T12:03:21.800
> 
> 标签：iphone, ios

我正在尝试制作一个可以使用 IOS 模拟器以编程方式发送 SMS 的应用程序。有人可以请告诉我步骤的顺序是什么。什么是代码以及我们如何逐步使用它的详细信息。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T12:14:44.477

Ios 模拟器无法发送消息，但您可以使用此代码在 divice 中运行您的项目来发送消息。

在您的项目中添加 MessageUI 框架

然后在你的 .h 文件中添加这个

```
#import <MessageUI/MessageUI.h>

@interface MessageViewController : UIViewController<MFMessageComposeViewControllerDelegate>

- (IBAction)SendTextBtnTapped:(id)sender;

@end 
```

在你的 .m 文件中添加这个

```
- (IBAction)SendTextBtnTapped:(id)sender {
    [self sendSMS:@"" recipientList:[NSArray arrayWithObjects: nil]];
}

//for sms

- (void)sendSMS:(NSString *)bodyOfMessage recipientList:(NSArray *)recipients
{
    MFMessageComposeViewController *controller = [[MFMessageComposeViewController alloc] init];
    if([MFMessageComposeViewController canSendText])
    {
        controller.body = bodyOfMessage;    
        controller.recipients = recipients;
        controller.messageComposeDelegate = self;
        controller.navigationBar.barStyle = UIBarStyleBlackTranslucent;
        [self presentModalViewController:controller animated:YES];
        [[UIApplication sharedApplication] setStatusBarHidden:YES];
    }    
}

- (void)messageComposeViewController:(MFMessageComposeViewController *)controller didFinishWithResult:(MessageComposeResult)result
{
    [self dismissModalViewControllerAnimated:YES];

    if (result == MessageComposeResultCancelled)
        NSLog(@"Message cancelled");
    else if (result == MessageComposeResultSent)
        NSLog(@"Message sent");  
    else 
        NSLog(@"Message failed");
} 
```

# hibernate - 休眠，如何跳过收集

> ID：14707119
> 
> 赞同：0
> 
> 时间：2013-02-05T12:03:58.180
> 
> 标签：hibernate

这是一个表结构：

```
<class name="test.Book" table="book" >
  <cache usage="nonstrict-read-write"/>
  <id column="id" name="id" type="int" unsaved-value="-1">
    <generator class ="increment"/>  
  </id>
  <property column="title" name="title" type="string" not-null="false" />
  <property column="description" name="description" type="string" not-null="false" />
  <list name="chapters"  table="bookChapters" cascade="persist">
    <cache usage="nonstrict-read-write"/>
    <key column="bookChapter_id"  />
    <list-index column="rank"/>
    <many-to-many column="chapter_id" class="test.Chapter" />
  </list>
</class> 
```

每次我拿到这本书时，它都会收集章节：

```
DetachedCriteria crit = DetachedCriteria.forClass(Book.class, id);
List<Book> bookList = getHibernateTemplate().findByCriteria(crit); 
```

有时我需要一本没有章节集的书。如何用 Hibernate 做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T12:20:39.907

一本书有章节。如果它没有章节，则集合将为空。那正是你想要的。它允许通过执行遍历章节

```
for (Chapter chapter : book.getChapters()) {
    ...
} 
```

代替

```
if (book.getChapters() != null) {
    for (Chapter chapter : book.getChapters()) {
        ...
    }
} 
```

它允许测试这本书是否有章节

```
if (!book.getChapters().isEmpty()) 
```

而不是通过做

```
if (book.getChapters() != null && !book.getChapters.isEmpty()) 
```

`null`是邪恶的。您希望避免像瘟疫那样的空集合，因为它们会导致错误，并使代码的可读性降低。

# ios - 如何使用“查找我的朋友”向特定朋友开放？

> ID：14707124
> 
> 赞同：1
> 
> 时间：2013-02-05T12:04:15.597
> 
> 标签：ios, url, url-routing

我知道 URL Scheme 是

```
findmyfriends:// 
```

但是如果他/她已经是朋友，我如何向特定的人开放？如果他/她还不是朋友，有没有办法添加朋友？

我更喜欢使用 URL 处理程序，但可以使用 JavaScript。我正在尝试将代码嵌入网页中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T14:34:59.560

我认为您不能通过 URL 处理程序添加朋友。

# java - 带有admob的Surfaceview

> ID：14707126
> 
> 赞同：0
> 
> 时间：2013-02-05T12:04:17.180
> 
> 标签：java, android, admob, android-relativelayout

我正在尝试创建一个游戏。我使用 Surfaceview 进行绘图，现在我希望在屏幕底部显示一个 admob 视图。我试图以编程方式创建一个 RelativeLayout ，但目前**唯一要显示的**视图是 surfaceview ，没有显示 admob 视图！

这是代码：

```
RelativeLayout layout = new RelativeLayout(this);

    AdView admobView = new AdView(this, AdSize.BANNER, "MY_ADMOB_ID");
    RelativeLayout.LayoutParams admobParams = new RelativeLayout.LayoutParams(
            RelativeLayout.LayoutParams.WRAP_CONTENT,
            RelativeLayout.LayoutParams.WRAP_CONTENT);

    admobParams.addRule(RelativeLayout.ALIGN_BOTTOM);

    admobView.setLayoutParams(admobParams);

    layout.addView(admobView);

    RelativeLayout.LayoutParams threadParams = new RelativeLayout.LayoutParams(
            RelativeLayout.LayoutParams.WRAP_CONTENT,
            RelativeLayout.LayoutParams.WRAP_CONTENT);
    threadParams.addRule(RelativeLayout.ALIGN_PARENT_TOP);

    admobView.loadAd(new AdRequest());

    TimermodeThread timerThread = new TimermodeThread(getApplicationContext());
    timerThread.setLayoutParams(threadParams);
    layout.addView(timerThread);

    setContentView(layout); 
```

有没有人可以帮助我？

谢谢！

**编辑**

我可以在日志中看到我收到了广告。所以，我猜surfaceview占用了所有空间！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T12:18:13.920

我猜你的表面视图占据了整个屏幕。而不是使用相对布局使用 Framelayout。并在最后添加布局广告的代码。

# performance - 在 scala combinatorparser 中访问位置信息会降低性能

> ID：14707127
> 
> 赞同：5
> 
> 时间：2013-02-05T12:04:18.110
> 
> 标签：performance, parsing, scala, parser-combinators

我在 scala 中为我的解析器编写了一个新的组合器。

它是 ^^ 组合器的变体，用于传递位置信息。但是访问输入元素的位置信息确实很划算。

在我的例子中，解析一个大例子需要大约 3 秒没有位置信息，它需要超过 30 秒。

我写了一个可运行的示例，其中在访问位置时运行时间增加了大约 50%。

这是为什么？如何获得更好的运行时？

例子：

```
import scala.util.parsing.combinator.RegexParsers
import scala.util.parsing.combinator.Parsers
import scala.util.matching.Regex
import scala.language.implicitConversions
object FooParser extends RegexParsers with Parsers {
  var withPosInfo = false
  def b: Parser[String] = regexB("""[a-z]+""".r)  ^^@ { case (b, x) => b + " ::" + x.toString }
  def regexB(p: Regex): BParser[String] = new BParser(regex(p))
  class BParser[T](p: Parser[T]) {
    def ^^@[U](f: ((Int, Int), T) => U): Parser[U] = Parser { in =>
      val source = in.source
      val offset = in.offset
      val start = handleWhiteSpace(source, offset)
      val inwo = in.drop(start - offset)
      p(inwo) match {
        case Success(t, in1) =>
          {
            var a = 3
            var b = 4
            if(withPosInfo)
            { // takes a lot of time
              a = inwo.pos.line
              b = inwo.pos.column
            }            
            Success(f((a, b), t), in1)
          }
        case ns: NoSuccess => ns
      }
    }
  }
  def main(args: Array[String]) = {
    val r = "foo"*50000000
    var now = System.nanoTime

    parseAll(b, r) 
    var us = (System.nanoTime - now) / 1000
    println("without: %d us".format(us))
    withPosInfo = true
    now = System.nanoTime
    parseAll(b, r)
    us = (System.nanoTime - now) / 1000
    println("with   : %d us".format(us))
  }
} 
```

输出：

> 没有：2952496 我们
> 
> 与 : 4591070 我们

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T12:44:53.193

不幸的是，我认为您不能使用相同的方法。问题是行号最终实现，*每次创建时都会生成每个换行符*`scala.util.parsing.input.OffsetPosition`的列表。因此，如果它以字符串输入结束，它将在每次调用时解析整个内容（在您的示例中是两次）。有关详细信息，请参阅[CharSequenceReader](https://github.com/scala/scala/blob/v2.10.0/src/library/scala/util/parsing/input/CharSequenceReader.scala#L1)和[OffsetPosition](https://github.com/scala/scala/blob/v2.10.0/src/library/scala/util/parsing/input/OffsetPosition.scala#L1)的代码。*`pos`*

 *您可以做一件快速的事情来加快速度：

```
val ip = inwo.pos
a = ip.line
b = ip.column 
```

至少避免创建`pos`两次。但这仍然会给您留下很多多余的工作。恐怕要真正解决您必须像`OffsetPosition`自己一样构建索引的问题，只需一次，然后继续引用它。

您还可以提交错误报告/提出增强请求。这不是实现该功能的好方法。*

# android - AChart 引擎条形图显示不正确

> ID：14707131
> 
> 赞同：1
> 
> 时间：2013-02-05T12:04:35.770
> 
> 标签：android, charts, bar-chart, achartengine

我已经用最新的 jar 文件实现了条形图，但它没有正确显示

这是我的代码：

```
private void openChart(){
        int[] x = { 10,20,30,40,50,60,70 };
       // int[] y = { 10,20,30,40,50,60,70 };
        int[] income = { 20,25,27,30,28,35,37,38};
        int[] expense = {22, 27, 29, 28, 26, 30, 33, 34 };
        int[] sample = {22, 27, 29, 28, 26, 30, 33, 34 };

        // Creating an  XYSeries for Income
        XYSeries incomeSeries = new XYSeries("Income");
        // Creating an  XYSeries for Expense
        XYSeries expenseSeries = new XYSeries("Expense");
     // Creating an  XYSeries for Expense
        XYSeries sampleseries = new XYSeries("Sample");
        // Adding data to Income and Expense Series
        for(int i=0;i<x.length;i++){
            incomeSeries.add(i,income[i]);
            expenseSeries.add(i,expense[i]);
            sampleseries.add(i,sample[i]);
        }

        // Creating a dataset to hold each series
        XYMultipleSeriesDataset dataset = new XYMultipleSeriesDataset();
        // Adding Income Series to the dataset
        dataset.addSeries(incomeSeries);
        // Adding Expense Series to dataset
        dataset.addSeries(expenseSeries);
        // Adding Expense Series to dataset
        dataset.addSeries(sampleseries);

        // Creating XYSeriesRenderer to customize incomeSeries
        XYSeriesRenderer incomeRenderer = new XYSeriesRenderer();
        incomeRenderer.setColor(Color.rgb(130, 130, 230));
        incomeRenderer.setFillPoints(true);
        incomeRenderer.setLineWidth(2);
        incomeRenderer.setChartValuesTextAlign(Align.CENTER);
        incomeRenderer.setChartValuesTextSize(18);
        incomeRenderer.setDisplayChartValues(true);

        // Creating XYSeriesRenderer to customize expenseSeries
        XYSeriesRenderer expenseRenderer = new XYSeriesRenderer();
        expenseRenderer.setColor(Color.rgb(220, 80, 80));
        expenseRenderer.setFillPoints(true);
        expenseRenderer.setLineWidth(2);
        expenseRenderer.setChartValuesTextAlign(Align.CENTER);
        expenseRenderer.setChartValuesTextSize(18);
        expenseRenderer.setDisplayChartValues(true);

     // Creating XYSeriesRenderer to customize expenseSeries
        XYSeriesRenderer samplseries = new XYSeriesRenderer();
        samplseries.setColor(Color.rgb(120, 40, 40));
        samplseries.setFillPoints(true);
        samplseries.setLineWidth(2);
        samplseries.setChartValuesTextAlign(Align.CENTER);
        samplseries.setChartValuesTextSize(18);
        samplseries.setDisplayChartValues(true);

        // Creating a XYMultipleSeriesRenderer to customize the whole chart
        XYMultipleSeriesRenderer multiRenderer = new XYMultipleSeriesRenderer();
        multiRenderer.setMargins(new int[] {30, 50, 50, 20});
        multiRenderer.setZoomRate(0.2f); // disable pinch to zoom
        multiRenderer.setZoomEnabled(false, false); // disable pinch to zoom
        multiRenderer.setBarSpacing(0.3f); // space between series
        multiRenderer.setXAxisMin(-1); // for x axis to start with some space
        multiRenderer.setXAxisMax(5);
        multiRenderer.setYAxisMin(0);
        multiRenderer.setYAxisMax(50);
        multiRenderer.setAxisTitleTextSize(20); // increase the text size of title of x and y
        multiRenderer.setAxesColor(Color.BLACK); // x and y line color
        multiRenderer.setGridColor(Color.GRAY); // grid line color
        multiRenderer.setShowGridX(true); // to show the grid line
        multiRenderer.setXLabels(0);
        multiRenderer.setPanEnabled(true, false);
        multiRenderer.setPanLimits(new double[] {-1,x.length,0,x.length});
       // multiRenderer.setYLabels(0);
      //  multiRenderer.setChartTitle("Income vs Expense Chart");
        multiRenderer.setLegendTextSize(26);
        multiRenderer.setLabelsColor(Color.BLACK); // changing the x,y title color
        multiRenderer.setLabelsTextSize(20); // changing the text size labels of x and y  

        multiRenderer.setXLabelsColor(Color.BLACK); // changing the color of x label
        multiRenderer.setXTitle("Tests"); // title for x
        multiRenderer.setYLabelsAlign(Align.RIGHT);// labels to display right
        multiRenderer.setYLabelsColor(0, Color.BLACK);// changing the color of y label
        multiRenderer.setYTitle("Scores");// title for y

        for(int i=0; i< x.length;i++){
            multiRenderer.addXTextLabel(i, mMonth[i]);
        }
        /*for(int i=0; i< x.length;i++){
            multiRenderer.addYTextLabel(i, mScores[i]);
        }*/
        // Adding incomeRenderer and expenseRenderer to multipleRenderer
        // Note: The order of adding dataseries to dataset and renderers to multipleRenderer
        // should be same
        multiRenderer.addSeriesRenderer(incomeRenderer);
        multiRenderer.addSeriesRenderer(expenseRenderer);
        multiRenderer.addSeriesRenderer(samplseries);

        // Creating an intent to plot bar chart using dataset and multipleRenderer
        Intent intent = ChartFactory.getBarChartIntent(getBaseContext(), dataset, multiRenderer, Type.DEFAULT);

        // Start Activity
        startActivity(intent);

    } 
```

这就是我的条形图的样子；

![在此处输入图像描述](../Images/b17708011c6162afbec105c1d915d3a4.png)

我哪里错了？

由于黑色背景，它不滚动，不显示 x 轴，y 轴值，而且我已经给出了平移限制，但没有任何工作

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T12:27:18.533

好的，我自己解决了我错过了添加 multiRenderer.setMarginsColor(Color.WHITE);

# php - 解码 HTML 特殊字符

> ID：14707132
> 
> 赞同：0
> 
> 时间：2013-02-05T12:04:36.753
> 
> 标签：php, html, csv

我想在 PHP 的帮助下将我的一些数据导出到 CSV。代码工作正常，但我要导出的一些关键字在我保存在数据库中的其他 unicode 中

```
urlencode('אריה דרעי'); 
```

这将 unicode 以这种格式保存在数据库中：

```
%26%231488%3B%26%231512%3B%26%231497%3B%26%231492%3B+%26%231491%3B%26%231512%3B%26%231506%3B%26%231497%3B 
```

这里的主要问题是当我在 HTML 页面中显示它时它显示得很好，但是当我尝试将它导出为 CSV 时它显示相同的文本。

我尝试使用以下功能

```
url_decode('%26%231488%3B%26%231512%3B%26%231497%3B%26%231492%3B+%26%231491%3B%26%231512%3B%26%231506%3B%26%231497%3B'); 
```

但它再次生成特殊字符

```
&#1488;&#1512;&#1497;&#1492; &#1491;&#1512;&#1506;&#1497; 
```

然后我尝试使用它进一步解码

```
 htmlspecialchars_decode(); 
```

但它仍然在 CSV 文件中显示 אריה דרעי。

我希望我说得通。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T12:07:05.477

尝试使用 htmlspecialchars() 而不是 url_encode()

[http://www.php.net/manual/en/function.htmlspecialchars.php](http://www.php.net/manual/en/function.htmlspecialchars.php) 和[http://www.php.net/manual/en/function.htmlspecialchars-decode.php](http://www.php.net/manual/en/function.htmlspecialchars-decode.php)

# javascript - 由于某种原因，脚本不会随机增加字体大小

> ID：14707140
> 
> 赞同：0
> 
> 时间：2013-02-05T12:05:05.717
> 
> 标签：javascript, jquery, html, css

我正在使用以下脚本将大小增加 1 个像素 当我将它与元素绑定时脚本工作正常，但如果我将它与嵌套 div 一起使用并将脚本绑定到元素`p`，它会增加字体大小两到三倍`div`

[小提琴的例子](http://jsfiddle.net/WR3Am/2/)

示例脚本

```
<script type='text/javascript'>
//Here we're using jQuery 1.4.2
jQuery(document).ready(function () {
  //This is our jQuery code
  //Code to increase our text by 2px
  $('#increaseText').click(function() {
    //Increate the font size by 2px
    $('p').css('font-size', parseInt($('p').css('font-size'))+1);
    $('div').css('font-size', parseInt($('div').css('font-size'))+1);
  });
  //Code to decrease our text by 2px
  $('#decreaseText').click(function() {
    //Decrease the font size by 2px
    $('p').css('font-size', parseInt($('p').css('font-size'))-1);
    $('div').css('font-size', parseInt($('div').css('font-size'))-1);
  });
});
</script> 
```

我尝试使用元素 ID 制作此脚本，但它根本不起作用，如果可以修复，我将不胜感激。我不确定或什么情况下嵌套 div 将字体增加 2 或 3 倍

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T12:18:02.910

什么时候在你的元素上设置字体大小，你没有添加任何单位。尝试修复您的代码以包含字体大小的单位：

```
$('p').css('font-size', (parseInt($('p').css('font-size'))-1) + 'px'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T12:22:35.620

试试这个：[现场演示](http://jsfiddle.net/PTy2n/)

```
$('p').css('font-size', '+=1'); 
```

**更新**

这在 jQuery 1.4.2 中不起作用。

对于 1.4.2，使用

```
ss = parseInt($('p').css('font-size')) + 1 + "px";
$('p').css('font-size', ss); 
```

# c# - Web 浏览器控制问题不等到事件执行？

> ID：14707144
> 
> 赞同：0
> 
> 时间：2013-02-05T12:05:20.023
> 
> 标签：c#, .net, webbrowser-control, web-scraping, web-crawler

我试图使用网络浏览器进入一些网页并获取一些信息，以便它记住我的登录详细信息。事情一直工作到这里，但是对于多个 url，Web 浏览器文档加载无法按我的意愿正常工作。

我的意图是转到 url-> 等待它加载-> 将所需的数据放入文本中-> 新的 url 和相同的过程。

我使用 for 循环来更改 url，但是当我运行所有 url 时，所有的 url 都一一传递，而不是等到文档加载并写入文本。请帮我。

```
 private void button1_Click_1(object sender, EventArgs e)
    {

        String text = File.ReadAllText("links.txt");

        var result = Regex.Split(text, "\r\n|\r|\n");
        foreach (string s in result)
        {
            listBox1.Items.Add(s);
        }
        for (int i = 0; i < listBox1.Items.Count; i++)
        {
            this.Text = Convert.ToString(i + 1) + "/" + Convert.ToString(listBox1.Items.Count);
            textBox1.Text += listBox1.Items[i];

            String url = textBox1.Text;
            webBrowser2.ScriptErrorsSuppressed = true;
            webBrowser2.DocumentCompleted += webBrowser2_DocumentCompleted;
            webBrowser2.Navigate(url);

     }
   }

    void webBrowser2_DocumentCompleted(object sender, WebBrowserDocumentCompletedEventArgs e)
    {
        string sourceCode = webBrowser2.DocumentText;
        try
        {
           /*someregax expressions to filter text */

            StreamWriter sw = new StreamWriter("inks_info.txt", true);
            sw.Write("url" + "~" + sourceCode + "\n");
            sw.Close();

            textBox1.Text = "";
        }

        catch
        {

            StreamWriter sw = new StreamWriter("inks_fail.txt", true);
            sw.Write(textBox1.Text + "\n");
            sw.Close();

            textBox1.Text = "";

        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T07:58:21.027

您在每个项目的文档加载上都有一个事件处理程序，但在启动第二次导航之前，您不会等待它在第一次导航之后触发。您的 for 循环需要“更加异步”。例如，将项目放入队列并一次请求一个：

```
Queue<string> _items;
private void button1_Click_1(object sender, EventArgs e)
{        
    String text = File.ReadAllText("links.txt");
    _items = new Queue<string>(Regex.Split(text, "\r\n|\r|\n"));
    webBrowser2.ScriptErrorsSuppressed = true;
    webBrowser2.DocumentCompleted += webBrowser2_DocumentCompleted;
    RequestItem();
}
private void RequestItem()
{
    if (_items.Any())
    {
        var url = _items.Dequeue(); // preprocess as required
        webBrowser2.Navigate(url);
    }
}
void webBrowser2_DocumentCompleted(object sender, WebBrowserDocumentCompletedEventArgs e)
{
    // Handle result
    RequestItem(); // Then request next item
} 
```

您的代码看起来也像使用 UI 元素（如列表框）作为中间变量只是出于逻辑目的而不是显示。您应该从显示（在列表框中显示结果、更新文本框等）中分离出逻辑（使用常规变量、数据结构如列表和请求数据）。不清楚您是否要使用`WebBrowser`even - 看起来您只是在下载文本并且应该使用`WebClient`or `HttpClient`。然后使用 async/await 代码也可以更简洁：

```
foreach (var url in urls)
{
     string text = await new WebClient().DownloadStringAsync(url);
     // Handle text
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T11:38:21.013

非常简单的答案。WebBorwser 控件不适合这些东西，但这是您要寻找的东西：

```
WHILE(webBrowser.ReadyState != WebBrowserReadyState.Ready)
{
     Application.DoEvents()
} 
```

就是这样..它不会冻结您的应用程序或让您迷失在代码中，它只是等到它不导航。不客气。

# ruby-on-rails - NoMethodError 运行黄瓜测试

> ID：14707150
> 
> 赞同：2
> 
> 时间：2013-02-05T12:05:24.373
> 
> 标签：ruby-on-rails, testing, cucumber, capybara, nomethoderror

每当我尝试在 Rails 应用程序上运行此黄瓜测试时，我都会失败 - “然后我单击”步骤定义在其他地方工作，但每次都失败！而且我找不到使用“start_with”方法的任何地方？

这是错误输出：

```
 And I click "Add a Line Item"                            # features/step_definitions/first_test_steps.rb:17
  undefined method `start_with?' for nil:NilClass (NoMethodError)
  ./features/step_definitions/first_test_steps.rb:18:in `/^I click "(.*?)"$/'
  features/create_quote.feature:19:in `And I click "Add a Line Item"' 
```

这是我的步骤定义的代码：

```
When /^I click "(.*?)"$/ do |this|
 click_on(this)
end 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T14:12:46.797

如果“添加行项目”是链接，则使用

```
first(:link, "Add a Line Item") 
```

如果“添加订单项”是按钮，则使用

```
first(:button, "Add a Line Item") 
```

# c# - 我可以将 WCF RIA 服务与现有的 Web API 一起使用吗？

> ID：14707153
> 
> 赞同：0
> 
> 时间：2013-02-05T12:05:35.070
> 
> 标签：c#, wpf, wcf, silverlight, wcf-ria-services

我是这种开发的新手，到目前为止，我只看到过关于 WCF RIA 服务的教程，这些服务从数据库创建新的 ADO.Net 数据模型。

但是，我正在使用一个系统，该系统为您提供用于与数据交互的 Web API（我能够在我自己的 Web 服务中包含和使用它，这反过来将与我的 Silverlight 应用程序交互）。

在这种情况下使用 WCF RIA 服务是否可能/明智？还是我应该只使用使用这些 API 的常规 WCF 服务？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T13:41:41.913

我认为您应该首先真正了解 WCF RIA 服务的强大功能，如 msdn 文档[http://msdn.microsoft.com/en-us/library/ee707344(v=vs.91).aspx中所述](http://msdn.microsoft.com/en-us/library/ee707344(v=vs.91).aspx)

“开发 n 层 RIA 解决方案时的一个常见问题是协调中间层和表示层之间的应用程序逻辑。要创建最佳用户体验，您希望 RIA 服务客户端了解驻留在服务器上的应用程序逻辑，但您不想同时在表示层和中间层开发和维护应用程序逻辑。”

因此，只要您在域服务中，您就在经典的 WCF 服务中，因此您可以在这里与任何您希望的东西（包括外部 Web API）进行交互。但是，如果您的应用程序的逻辑已经嵌入到 Web API 中，则使用 WCF RIA 服务的优势会更小。

# scala - Scala 类构造函数默认参数，带有使用先前成员的表达式

> ID：14707156
> 
> 赞同：3
> 
> 时间：2013-02-05T12:05:54.357
> 
> 标签：scala, syntax

我想创建一个行为如下的类（或更好的案例类）：

```
case class MyClass(n: Int, m: Int = 2 * n) 
```

因此，它`m`可能具有基于的默认值`n`。但似乎这是不可能的，斯卡拉说：`not found: value n`. 第一个想法是如果它仍然是 -1，则在构造函数中编写`m: Int = -1`和变异它，但它是`val`. 现在我没有任何其他想法。

也许有人会阐明这里有什么可能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T12:10:25.060

您可以显式提供第二个工厂：

```
case class MyClass(n: Int, m: Int)
object MyClass{
  def apply(n: Int): MyClass = MyClass(n, 2 * n)
} 
```

与@om-nom-nom 的答案中使用 2 个参数列表不同，case 类不受影响，特别是您可以像往常一样进行模式匹配以同时提取`n`和`m`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T12:14:38.970

您必须定义一个伴随对象：

```
scala> :paste
// Entering paste mode (ctrl-D to finish)

case class MyClass(n: Int, m: Int);

object MyClass {
def apply(n: Int) : MyClass = new MyClass(n, n * 2)
}

// Exiting paste mode, now interpreting.

defined class MyClass
defined module MyClass

scala> MyClass(12);
res4: MyClass = MyClass(12,24) 
```

# dsl - XText 中关键字的悬停规则

> ID：14707159
> 
> 赞同：1
> 
> 时间：2013-02-05T12:05:58.323
> 
> 标签：dsl, xtext

我想知道 XText 是否支持关键字（规则）的悬停信息。到目前为止，我只看到了这些实例的示例，从来没有看到关键字本身。

在这里概述是我想到的一个小样本。

```
/**
 * use: login (username, password) 
 */
Login: 'login' ('('username=STRING ',' password=STRING ')' )?; 
```

然后，在编辑器中，当我将鼠标悬停在突出显示的关键字“登录”上时，我希望看到“使用：登录（用户名，密码）”。理想情况下，可以使用 Javadoc 样式的注释，但欢迎使用任何其他解决方案。

# php - 从多个表中选择结果

> ID：14707162
> 
> 赞同：0
> 
> 时间：2013-02-05T12:06:06.827
> 
> 标签：php, mysql

我正在创建一个社交网站。我有一个警报选项，需要根据它到达各种 div 的时间一起显示朋友请求和未读消息。实际上我缺乏关于如何显示两个表的结果的逻辑。请帮助我。

我的桌子是：

```
1)sk_friends=>[friendship_id, from_user_id, to_user_id, status,date] 
```

status 包含`accepted`或`pending`作为值。

```
2)sk_messages=>[msg_id, from_user_id, to_user_id,text, date, status] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T12:13:50.587

如果您尝试同时拉取待处理的好友请求和消息，您可能需要考虑添加更通用的“通知”样式表，或者将它们作为单独的查询运行。

所以你可以按照以下方式找一张桌子：

```
sk_notifications => [id, date, type, from_user, to_user, status] 
```

这将包含两种类型的事件（新消息和新朋友请求） - 然后您的代码将负责根据通知类型提供不同的操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T12:14:26.290

对于好友请求，请参阅下面的查询

```
select * from sk_friends where (logged_in_user_id in from_user_id or logged_in_user_id in to_user_id) and status='pending'; 
```

和未读消息

```
 select * from sk_messages where to_user_id=logged_in_user_id; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T12:12:22.440

```
SELECT * FROM sk_friends JOIN sk_message ON sk_friends.from_user_id = sk_message.from_user_id 
```

这将是从两个表中检索记录的基本查询..

试试这个..但不确定对你有多大帮助

# java - 从 Tomcat 启动新进程

> ID：14707165
> 
> 赞同：0
> 
> 时间：2013-02-05T12:06:16.227
> 
> 标签：java, tomcat, process, tomcat7

我有以下问题：

我正在尝试从 Tomcat 服务器当前正在运行的 Web 应用程序启动一个新进程。因此，Web 应用程序应该能够启动一个新进程。如果我从 Tomcat 尝试这个，什么也不会发生。但是，如果我在自己的未在 Tomcat 上运行的 Java 应用程序中使用相同的代码，则一切正常。

我错过了哪一部分？Tomcat 是否不允许从 Web 应用程序启动新进程？我必须设置特殊权限吗？

这里的代码在独立的 java 应用程序中运行良好：

```
public class Test1 {

/**
 * @param args
 */
public static void main(String[] args) {
    String javaHome = System.getProperty("java.home");
    String javaBin = javaHome + File.separator + "bin" + File.separator
            + "java";
    String classpath = System.getProperty("java.class.path");
    String className = Test2.class.getCanonicalName();

    ProcessBuilder builder = new ProcessBuilder(javaBin, "-cp", classpath,
            className);

    Process process;

    try {
        process = builder.start();

         Scanner s = new
         Scanner(process.getInputStream()).useDelimiter("\\Z");
         System.out.println(s.next());

        process.getOutputStream().close();
        process.getErrorStream().close();
        process.getInputStream().close();
    } catch (IOException e) {
        e.printStackTrace();
    }

} 
```

Test2.class 除了在屏幕上打印“hello world”之外什么也不做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T12:55:46.543

您的问题至少来自不同的类路径内容。

但我同意你试图做的不是干净的。

为什么不使用 JMS 在队列中发布作业并让另一个 MDB 进程呢？

# jsp - 包含页面中的显示标签

> ID：14707167
> 
> 赞同：0
> 
> 时间：2013-02-05T12:06:26.403
> 
> 标签：jsp, struts2, displaytag, jspinclude

我想在包含的页面中使用 displaytag，但我遇到了困难。我有一个主页，其中包括标题 jspf、菜单 jspf 和其他 jspf，具体取决于所选菜单（在 menu.jspf 上）

主文件

```
<html><body>
<table border="0">
  <tr>
     <td colspan="2"><s:include value="header.jspf"/></td>
  </tr>
  <tr>
     <td><s:include value="menu.jspf"/></td>
     <td><s:include value="%{page}"/></td>
  </tr>
</table>
</body></html> 
```

“其他”jspf（我在 Struts2 操作中更改了“页面”变量的值）

```
<%@ taglib prefix="display" uri="http://displaytag.sf.net" %>
<%@ taglib prefix="s" uri="/struts-tags" %> 
<html>
<link rel="stylesheet" href="./css/screen.css" type="text/css"/>
<link rel="stylesheet" href="./css/displaytag.css" type="text/css"/>
<body>

   <display:table name="${usageList}" pagesize="2" requestURI="menu_admin_freq.action" sort="list" class="mars">
      <display:column property="nameBackendService" title="BackendService" sortable="true"/>
      <display:column property="frequency" title="Frequency" sortable="true"/>
   </display:table>

</body></html> 
```

如您所见，我包含了一个完整的 JSP 页面，我认为这不是一个好主意……但是，当我尝试仅包含一个片段（没有`<html>`and`<body>`元素）并将 taglib 元素放入 main.jsp 时，displaytag 表确实没有出现...当我删除`<html>`and`<body>`元素并离开 taglib 时，我可以在网页上看到一条文本：`"<%@ taglib prefix="display" uri="http://displaytag.sf.net" %>"`

目前我有一个可行的解决方案（通过使用`<html>`，页面中必须包含`<body>`的元素），但我认为我的设计模式非常糟糕。`<%@ taglib>`我该如何解决这个问题？谢谢，维克多

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T12:26:09.773

Struts2`<s:include>`标记包括一个servlet 或一个JSP 页面的结果。如果要包含 JSP 片段，请使用 JSP 包含指令`<%@ include file="..." %>`。

对于使用`<s:include>`标签将您的页面重命名为`.jsp`并仅将 taglib 指令 (w/o `<html>`, `<body>`) 与您的表格一起放入包含的页面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T12:55:35.980

你应该使用

```
<jsp:include page="mySnippet.jsp"/> 
```

哪里`mySnippet.jsp`是一个部分 Jsp，没有 DTD，没有头部，没有正文，只有你需要的 HTML 片段。

需要时，在其中声明标签库（struts-tags等）......

# c# - 保护区与在基类中使用私有区域

> ID：14707169
> 
> 赞同：0
> 
> 时间：2013-02-05T12:06:37.827
> 
> 标签：c#, c++, .net

听说用受保护的成员不好，因为它破坏了基类的封装。我需要知道在基类中使用受保护成员而不是私有成员或反之亦然的优势是什么。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T12:12:29.353

与使用私有成员相比，使用受保护成员没有明显优势。它在任何方面在概念上都是不同的。

private：您只能在班级内使用您的会员

protected：成员可以在类内部和子类内部使用，但不能从外部使用

public：可以在课堂内外的任何地方调用和查看成员

这意味着：根据您要表达的内容选择您的概念！如果您必须覆盖成员，请​​使其受到保护。

绝对不推荐的是让成员在“以防万一”的情况下受到保护。如果你想表达有一个可以被覆盖的钩子，那么只有这样，才能保护它们。这必须在其他地方的代码中表达出来，例如使用覆盖成员的地方。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T12:08:39.120

假设您在基类中有一个不应从类外部使用的函数，但它可能必须被子类覆盖。然后你可以让它受到保护。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T12:10:16.937

实际上，我们不能谈论私有和受保护之间的优缺点。无论你做什么继承都会以某种方式破坏封装。您必须根据要求设置访问修饰符。如果派生类想要（或需要）使用或覆盖基类中的方法，则可以将其设置为受保护的，否则它应该是私有的。

# git - 由于 gitignore 没有结帐

> ID：14707172
> 
> 赞同：0
> 
> 时间：2013-02-05T12:06:47.190
> 
> 标签：git, gitignore, git-checkout

我在 git 下有一个项目。在我的 gitignore 文件中，我有一个文件夹文件夹/我不想让 git 关心。问题是，每次我想签出一个分支时，都会要求我出错：以下未跟踪的工作树文件将被签出覆盖：

错误：以下未跟踪的工作树文件将被结帐覆盖：文件夹/somefile 文件夹/子文件夹/somefile...

所以我移开了文件夹/，再次提交，然后在我的 git repo 中取回了文件夹/。但是为什么总是出现这个消息？（在我的 .gitignore 中，我有一行：文件夹/）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T12:09:07.217

您收到此消息，因为您`folder/`在将该文件夹添加到`.gitignore`.

这意味着，尽管您的文件夹中有该文件夹，`.gitignore`但它已经在您的存储库中，因此将被检出，就像所有其他文件一样。

`.gitignore`在签入文件**时**使用，而不是在签**出**文件时使用。

如果你想`folder/`从你的 git 存储库中删除，你可以通过发出命令来做到这一点`git rm folder/`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T12:11:06.713

您已经在已签出的分支中提交了一些文件/文件夹，大概是在您将它们添加到 .gitignore 之前。

使用将它们从您的索引中删除[`git rm folder\ --cached`](http://www.kernel.org/pub/software/scm/git/docs/git-rm.html)，然后重试 - 您不应该收到警告。

# sql-server-2008 - 我在 SQL VIEW 中收到错误的每个项目折扣的计算

> ID：14707180
> 
> 赞同：2
> 
> 时间：2013-02-05T12:07:13.633
> 
> 标签：sql-server-2008

我被困住了，我有 2 张桌子：`Sales`而且`SalesDetails`

`Sales`: InvNum, Total, Discount, Nettotal 等...

`SalesDetails`: InvNum, ItemCode, Amount 等。

问题是。我想计算每件商品的折扣。我使用代码在视图中完成了它。

```
SELECT dbo.Sales.InvNum, 
       dbo.SalesDetails.Amount
           /dbo.Sales.Total*dbo.Sales.Discount AS DiscountPerItem 
FROM dbo.Sales 
   INNER JOIN dbo.SalesDetails ON dbo.Sales.InvNum = dbo.SalesDetails.InvNum 
```

它工作正常，但问题是它没有给出准确的结果。例子 ：

```
Sales.Total = 33,355,7.7500
Sales.Discount = 2,948.7500

SalesDetails.ItemCode = 1
SalesDetails.DiscountPerItem = 1.4744 (wrong result by SQL) 
```

等等 (item2, 3, 4, .....) 那就是 DiscountPerItem 必须是**(198 / 33,355,7.7500 * 2,948.7500)** = 1.75 not = 1.4744 这个代码有什么错误。提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T12:21:13.907

尝试先乘以减少舍入误差

```
SELECT dbo.Sales.InvNum, 
       (dbo.SalesDetails.Amount*dbo.Sales.Discount)/dbo.Sales.Total 
           AS DiscountPerItem 
FROM dbo.Sales 
   INNER JOIN dbo.SalesDetails ON dbo.Sales.InvNum = dbo.SalesDetails.InvNum 
```

# windows - Jruby：将 Pry 与 JRuby（和 JRubyFx）一起使用

> ID：14707182
> 
> 赞同：1
> 
> 时间：2013-02-05T12:07:22.787
> 
> 标签：windows, jruby, javafx-2, pry

**在 Windows 上将 Pry gem 与 JRuby 和 JRubyFx 一起使用的正确方法是什么？**

我正在使用 JRubyFx（一个 JavaFX JRuby 绑定 - [https://github.com/jruby/jrubyfx](https://github.com/jruby/jrubyfx)），对于我的测试，我正在使用这个[示例](https://github.com/jruby/jrubyfx/blob/master/samples/fxml/Demo.rb)缩小到最少的必要行。

```
require 'jrubyfx'
require 'pry'

class SimpleFXApplication < JRubyFX::Application
    def start(stage)
    stage.title = "jrubyfx app"
    @ctrlr = SimpleFXController.load_fxml("some_fxml_code_for_ui.fxml", stage)
    stage.show
  end
end

class SimpleFXController < JRubyFX::Controller
end

SimpleFXApplication.launch
binding.pry 
```

启动应用程序后，控制台不再接受输入，并且“pry”仅在我关闭 SimpleFXApplication 窗口时才返回接受输入。

我也尝试过使用 Java 线程：

```
...
binding.pry
Java.java.lang.Thread.new do SimpleFXApplication.launch end 
```

但是，尽管新线程 ID 显示为正在运行，但 SimpleFXApplication 永远不会启动。

我尝试的另一件事是从控制台开始撬，然后要求并启动 SimpleFXApplication：

> jruby -S 撬
> 
> 需要'./jrubyfx_demo.rb'
> 
> 真的
> 
> SimpleFXApplication.launch

我收到以下错误...

> 异常运行应用程序：java.net.MalformedURLException：未知协议：c java.net.URL.(Unknown Source) java.net.URL.(Unknown Source) sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) sun.reflect.NativeConstructorAccessorImpl .newInstance(Unknown Source) sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source) java.lang.reflect.Constructor.newInstance(Unknown Source) org.jruby.javasupport.JavaConstructor.newInstanceDirect(JavaConstructor.java:291) org.jruby。 java.invokers.ConstructorInvoker.call(ConstructorInvoker.java:104) org.jruby.java.invokers.ConstructorInvoker.call(ConstructorInvoker.java:197) org.jruby.runtime.callsite.CachingCallSite.callBlock(CachingCallSite.java:211) org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:217) org.jruby.java.proxies。ConcreteJavaProxy$2.call(ConcreteJavaProxy.java:56) org.jruby.runtime.callsite.CachingCallSite.callBlock(CachingCallSite.java:211) org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:217) org.jruby .RubyClass.newInstance(RubyClass.java:862) org.jruby.RubyClass$INVOKER$i$newInstance.call(RubyClass$INVOKER$i$newInstance.gen) org.jruby.internal.runtime.methods.JavaMethod$JavaMethodZeroOrOneOrTwoOrNBlock.call (JavaMethod.java:295) org.jruby.java.proxies.ConcreteJavaProxy$3.call(ConcreteJavaProxy.java:155) org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:346) org.jruby.runtime。 callsite.CachingCallSite.call(CachingCallSite.java:204) org.jruby.ast.CallTwoArgNode.interpret(CallTwoArgNode.java:59) org.jruby.ast.NewlineNode.interpret(NewlineNode.java:105) org.jruby.ast。块节点。解释(BlockNode.java:71) org.jruby.ast.IfNode.interpret(IfNode.java:118) org.jruby.ast.AttrAssignOneArgNode.interpret(AttrAssignOneArgNode.java:33) org.jruby.ast.NewlineNode.interpret( NewlineNode.java:105) org.jruby.ast.BlockNode.interpret(BlockNode.java:71) org.jruby.evaluator.ASTInterpreter.INTERPRET_METHOD(ASTInterpreter.java:75) org.jruby.internal.runtime.methods.InterpretedMethod。 call(InterpretedMethod.java:268) org.jruby.internal.runtime.methods.DefaultMethod.call(DefaultMethod.java:220) org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:366) org.jruby。 runtime.callsite.CachingCallSite.call(CachingCallSite.java:238) org.jruby.ast.FCallThreeArgNode.interpret(FCallThreeArgNode.java:40) org.jruby.ast.LocalAsgnNode.interpret(LocalAsgnNode.java:123) org.jruby。 ast.NewlineNode。解释（NewlineNode.java:105）org.jruby.ast.BlockNode.interpret（BlockNode.java:71）org.jruby.evaluator.ASTInterpreter.INTERPRET_METHOD（ASTInterpreter.java:75）org.jruby.internal.runtime.methods。 InterpretedMethod.call(InterpretedMethod.java:225) org.jruby.internal.runtime.methods.DefaultMethod.call(DefaultMethod.java:204) org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:346) org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:346) org. jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:204) org.jruby.ast.CallTwoArgNode.interpret(CallTwoArgNode.java:59) org.jruby.ast.InstAsgnNode.interpret(InstAsgnNode.java:95) org. jruby.ast.NewlineNode.interpret(NewlineNode.java:105) org.jruby.ast.BlockNode.interpret(BlockNode.java:71) org.jruby.evaluator.ASTInterpreter.INTERPRET_METHOD(ASTInterpreter.java:75) org.jruby。 internal.runtime.methods。InterpretedMethod.call(InterpretedMethod.java:182) org.jruby.internal.runtime.methods.DefaultMethod.call(DefaultMethod.java:188) org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:326) org. jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:170) org.jruby.ast.CallOneArgNode.interpret(CallOneArgNode.java:57) org.jruby.ast.NewlineNode.interpret(NewlineNode.java:105) org. jruby.ast.BlockNode.interpret(BlockNode.java:71) org.jruby.ast.RescueNode.executeBody(RescueNode.java:224) org.jruby.ast.RescueNode.interpret(RescueNode.java:119) org.jruby。 ast.BeginNode.interpret(BeginNode.java:83) org.jruby.ast.NewlineNode.interpret(NewlineNode.java:105) org.jruby.evaluator.ASTInterpreter.INTERPRET_BLOCK(ASTInterpreter.java:112) org.jruby.runtime。 Interpreted19Block.evalBlockBody(Interpreted19Block.java:209) org.jruby.runtime.Interpreted19Block.yield(Interpreted19Block.java:197) org.jruby.runtime.Interpreted19Block.call(Interpreted19Block.java:128) org.jruby.runtime.Block.call(Block.java:89) org.jruby.RubyProc.call(RubyProc.java:261) org.jruby.RubyProc.call(RubyProc.java:213) org.jruby.javasupport.JavaUtil$1.call(JavaUtil.java:237) org.jruby.javasupport .util.RuntimeHelpers$MethodMissingMethod.call(RuntimeHelpers.java:445) org.jruby.gen.InterfaceImpl1014569521.run(org/jruby/gen/InterfaceImpl1014569521.gen:13) com.sun.javafx.application.PlatformImpl$5.run( PlatformImpl.java:215) com.sun.javafx.application.PlatformImpl$4$1.run(PlatformImpl.java:179) com.sun.javafx.application.PlatformImpl$4$1.run(PlatformImpl.java:176) java.security。 AccessController.doPrivileged(Native Method) com.sun.javafx.application.PlatformImpl$4。运行（PlatformImpl.java:176）com.sun.glass.ui.win.WinApplication._runLoop（本机方法）com.sun.glass.ui.win.WinApplication.access$100（WinApplication.java:29）com.sun。 glass.ui.win.WinApplication$3$1.run(WinApplication.java:73) java.lang.Thread.run(Unknown Source) => nil

我猜它与 JrubyFx 如何使用线程有关，或者我不知道这是否是一个更普遍的问题，会影响 JRuby 的 Pry 使用。我想知道更多，如果有人可以的话，我会很感激分享一些建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T20:48:39.790

SimpleFXApplication.launch 在调用 Platform.exit 之前永远不会返回（关闭窗口在后台执行此操作）

为了做你想做的事情，在 JavaFX 启动应用程序后，在 start 方法或其他一些计时器方法中分叉。

作为一名 JRubyFX 开发人员，我还可以告诉你线程在 JRubyFX/JavaFX 中是如何工作的：

1.  主线程产生 UI JavaFX 线程并等待来自 JavaFX 线程的锁
2.  UI 线程启动一堆平台的东西
3.  UI线程调用开始（阶段）
4.  start(stage) 设置事件处理程序、UI 等（这是你应该启动 pry 的地方）
5.  用户调用 stage.show 来启动 JavaFX 事件（单击、鼠标移动、按键、最小化等）
6.  事件线程使用事件处理程序回调 UI 线程
7.  用户通过单击 [x] 或调用 Platform.exit 发出他们想要关闭 JavaFX 的信号
8.  stage.show 接收事件锁并返回
9.  UI 线程释放主线程上的锁。
10.  UI 线程清理，而主线程继续

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T20:23:00.603

关于这一点：

异常运行应用程序：java.net.MalformedURLException：未知协议：c java.net.URL.(Unknown Source) java.net.URL.(Unknown Source)

您的配置文件中有指定文件位置的内容吗？如果是这样，那里的价值是什么？

如果您使用“C:[something]”，并且 C 是您当前的驱动器，我建议您尝试删除“C:”，以防 pry 被驱动器号弄糊涂了。

——基思

# javascript - 路由更改时从主干视图中清除间隔

> ID：14707183
> 
> 赞同：1
> 
> 时间：2013-02-05T12:07:28.867
> 
> 标签：javascript, backbone.js

我在这个视图中有一个间隔

```
var QuestionsView = Backbone.View.extend({
    render: function(){
        var view = this;
        this.updateQuestionsIntervalId = setInterval(function() {view.refreshQuestionLists()}, 3000);
    ),

    refreshQuestionLists: function() {
        this.questions.fetch({ 
            ...
        });
    },

    navigateAway: function() {
        clearInterval(this.updateQuestionsIntervalId);
    }

}); 
```

理想情况下，我想`QuestionView.navigateAway()`在路线改变时跑步。无论如何我可以做到这一点吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T12:18:21.840

作为一个省力的解决方案，您可以将视图方法直接绑定到`router:route`事件，每次路由器将 URL 更改匹配到任何定义的路由时都会触发该事件：

```
var QuestionsView = Backbone.View.extend({
  initialize: function(){
    this.listenTo(yourRouter, 'route', this.navigateAway); 
  )
}); 
```

这应该有效，但对我来说感觉就像意大利面条。

我通常`onBeforeClose`在我的视图上实现一个方法，我在离开当前视图之前调用它。类似于：

```
var Router = Backbone.Router.extend({
  navigateToView: function(view) {
    //I've actually abstracted this logic to a separate
    //view manager class, but you get the idea...
    var current = this.currentView; 
    if(current) {
      if(current.onBeforeClose)
        current.onBeforeClose();
      current.remove();
    }

    this.currentView = view;
    //render your current view here, however you like
    $(body).html(this.currentView.render().el);
  },

  someRoute: function() {
    var view = new SomeView();
    this.navigateToView(view);
  }
}); 
```

这更像是一种约定。如果一个视图没有`onBeforeClose`方法，它就不会被调用，也不会造成任何伤害。

请注意，这要求您使用一种集中式方法（`navigateToView`在本例中）呈现您的视图，但这是一件好事，因为您应该使用`remove`无论如何清理旧视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T12:40:21.100

我需要这样做的原因是通过停止前一个间隔来停止从呈现视图时开始的多个间隔。

但我至少需要一个跑步...

于是我走错了路，解决办法：

```
var QuestionsView = Backbone.View.extend({

    updateQuestionsIntervalId: false,

    render: function(){
        var view = this;

        if(this.updateQuestionsIntervalId == false)
            this.updateQuestionsIntervalId = setInterval(function() {view.refreshQuestionLists()}, 3000);
    ),

    refreshQuestionLists: function() {
        this.questions.fetch({ 
            ...
        });
    }

}); 
```

# mobile - Asyc Web 服务/HTTPS 调用在 Titanium 移动设备中不起作用？

> ID：14707184
> 
> 赞同：0
> 
> 时间：2013-02-05T12:07:29.920
> 
> 标签：mobile, titanium, httpclient, appcelerator-mobile

我们使用多个 Web 服务（`HTTPS`调用）从服务器获取数据。我们正在将文件上传到 Web 服务中的服务器，同时我们正在进行另一个 Web 服务调用以从同一服务器获取/发送数据。

但是直到第一个 Web 服务（上传回执）成功或失败，我们才得到第二个 Web 服务的响应。所以我们的疑问是当从 Titanium 应用程序发送多个 Web 服务时，Titanium 如何发送 Web 服务调用。

来自 Titanium 应用程序的 Web 服务调用是排队（同步）还是与其他 Web 服务并行调用（异步调用）？

在我们的 Titanium 应用程序中，我们`HTTPClient`为每个 Web 服务调用创建一个新对象，使用以下代码创建一个新`HTTPClient`对象：

```
function runService(){   
  var xhr = Ti.Network.createHTTPClient();
  xhr.onload = function() {
    var r = this.responseText; 
  }
  xhr.open("GET", URI);
  xhr.send();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T22:32:55.900

我认为您需要通过`true`异步

```
xhr.open("GET", URI, true); 
```

# ruby-on-rails - Rails ActiveAdmin 和 has_many 关联

> ID：14707187
> 
> 赞同：0
> 
> 时间：2013-02-05T12:07:46.283
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activeadmin

我对active_admin还很陌生，我想知道是否有办法实现以下目标

我有两个模型

```
User
  belongs_to :group

Group
 has_many :users 
```

我已经成功地在 activeadmin 中为组和用户创建了页面，现在我想要的是显示属于某个组的用户。我在组索引页面上有按钮 manage_members 应该只显示该组的成员。我可以从组中删除成员或添加更多成员。

这是我迄今为止能够做到的

```
member_action :manage_members do
    @group = Group.find(params[:id])
    @page_title = "Manage Groups > @#{@group.name}, Edit Members"
end 
```

和视图 app/vies/admin/groups/manage_users.html.arb

```
table_for assigns[:group].users do
  column "Name" do |u|
    u.user_id
  end
  column "email" do |u|
    u.user.email
  end
  column "Created Date" do |u|
    u.user.created_at
  end

  column "OfficePhone" do |u|
    u.user.office_no
  end
end 
```

这显示了组的成员，但我必须在此页面上完成所有工作才能添加编辑删除成员，我不能在这里有 active_admin 过滤器和其他很酷的东西，这就像一个自定义页面，

有没有办法拥有一个索引页面（具有过滤器批处理操作等所有优点）（就像用户一样），但只显示一个组的用户。类似于范围索引页面，它显示在组中的用户上，我对该页面具有与任何活动管理索引页面相同的控制权？更像下图

![这就是我所说的索引页](../Images/0e927f5a00020cff498ef13438d148aa.png)

而不是必须做我自己目前看起来像的所有工作

![我不想要这个](../Images/d39878a333d6c552505d07cb819c175e.png)

对 active_admin 来说非常新，所以如果我遗漏了一些非常直截了当的东西，我们深表歉意。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-25T15:45:05.400

也许过滤器会做。看起来像（把它放在你放置 member_action 的同一个文件中）

```
filter :group, :as => :select, :collection => proc { Group.for_select } 
```

proc 用于确保对组的更改（添加/删除/..）立即反映到过滤器中的选择列表。这与生产中的*类缓存*有关。不要忘记将此范围放在您的 Group 模型中。

```
scope :for_select, :select => [:id, :name], :order => ['name asc'] 
```

另一种方法是使用*范围*。如果您的 Group 模型中有一个字段，例如可以用作方法标头的 slug/label，那么您可以在您的 activeadmin 用户注册块中执行以下操作：

```
Group.all.each do |group|
  # note the sanitization of the Group name in the gsub
  scope "#{group.name.gsub(/-/,'_')}".to_sym
end 
```

这在您的用户模型中：

```
Group.all.each do |group|
  # note the sanitization of the Group name in the gsub
  scope "#{group.name.gsub(/-/,'_')}".to_sym, joins(:group).where("group.name = ?",role.name)  
  # using joins(:group) or joins(:groups) makes a difference,
  # so not sure as I have not tested, but maybe the where should be
  # ....where("groups.name = ....
end 
```

它应该在索引视图上方为您提供不错的按钮，如下所示：http: [//demo.activeadmin.info/admin/orders](http://demo.activeadmin.info/admin/orders)

如果你想要这个 has_and_belongs_to_many 关系，我建议你看看这个 [Rails3 Active Admin - How to filter only records that meet all checked items in collection](https://stackoverflow.com/questions/13251559/rails3-active-admin-how-to-filter-only-records-that-meet-all-checked-items-in)

祝你好运！

# iphone - 在 Xcode 中获取 iPhone 运营商手机号码

> ID：14707188
> 
> 赞同：0
> 
> 时间：2013-02-05T12:07:46.027
> 
> 标签：iphone, ios, objective-c, ipad

> **可能重复：**
> [在 iPhone OS 中以编程方式获取自己的电话号码](https://stackoverflow.com/questions/193182/programmatically-get-own-phone-number-in-iphone-os)

有没有可能通过程序在iPhone应用程序中获取iPhone用户的手机号码...

# c++ - 使用带有单例对象的函数指针c ++

> ID：14707190
> 
> 赞同：0
> 
> 时间：2013-02-05T12:07:49.973
> 
> 标签：c++, singleton, function-pointers

我是 C++ 新手，我尝试用谷歌搜索和搜索以找到答案，但无济于事。很可能这应该是一个愚蠢的问题。

我总是难以理解函数指针及其语法。

这是我第一次在一些*严肃*的代码中使用它。

我有一个像这样的**单身**课程。未显示单例方法。

```
class Derived:public base
{
    int fn();
    // This function has a single argument which 
    // is function pointer to any of the base class
    // function having same argument/return type of 
    // the singleton object.
};

class base
{
   public:
   int ConvertIntIndex(const unsigned int Index);
   int ConvertStringIndex(const unsigned int Index);
   int ConvertOidIndex(const unsigned int Index);
} 
```

如何声明`fn()`以及如何通过单例对象调用它。我尝试了不同的选项，甚至无法编译它。我遇到了很多错误，如果需要，我会发布这些详细信息。我过得很艰难。如果存在，任何人都可以帮助或指出重复项吗？如果有的话我会删除这个帖子。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T15:59:32.020

我猜你正在寻找这个：

```
class Derived: public base
{
    int fn(int (base::*arg)(unsigned int));
}; 
```

在里面`fn`，你会这样使用`arg`：

```
return (this->*arg)(7); 
```

该语法`int (base::*p)(unsigned int)`创建一个*指向成员函数的指针。*您可以将它与指向对象的指针（或引用）一起使用来调用成员函数。要取消对指针的引用，您可以将 use`->*`与指向对象的指针或`.*`对象本身一起使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T12:17:53.907

您可以将基类的指针作为参数发送到`fn()`. 你为什么不发布错误信息呢？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T13:53:21.607

你的意思是指向成员函数的指针吗？然后尝试：（更正评论）。你需要一个基础对象来调用 fp

```
typedef double (base::*bfptr)(double);

int fn(bfptr fp); 
```

# eclipse - 从与 SVN 、 eclipse IDE 同步中排除一些文件

> ID：14707192
> 
> 赞同：1
> 
> 时间：2013-02-05T12:07:50.673
> 
> 标签：eclipse, svn

是否可以从与 svn 中存在的 SVN 同步中排除/忽略某些特定文件？

这些文件已经存在于 SVN 中，我相信从其他帖子中`rightClick->Team->SVN:IGnore`只适用于 svn 中不存在的文件。

我已阅读其他帖子，但找不到答案。

原因：我们有一些文件在 SVN 中有一些特定内容，而在本地工作区中有一些其他内容，人们错误地将这些配置文件的版本检查到 SVN。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T14:25:39.310

也许有一种更简单的方法可以做到这一点，但以下应该可行：

1.  可选：将文件保存在某处，以防无法重新创建
2.  打开“SVN 存储库”视图，导航到您不想在 SVN 中的文件位置，右键单击它并选择“删除”。这将从存储库中删除文件
3.  同步。您会看到文件删除是传入的更改。接受。这将从您的本地文件系统中删除文件
4.  在本地文件系统中重新创建文件，或从步骤 (1) 复制。如果此时同步，文件将显示为传出更改。
5.  现在您应该可以在其上执行“右键单击->团队->添加到 SVN 忽略”。执行此操作并在文件夹上提交属性更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T14:20:25.760

[TortoiseSVN](http://tortoisesvn.net/)在 Windows 上下文菜单中有一个选项，通过右键单击文件来取消版本控制并添加到忽略列表。该动作也应该被插件识别，即使插件菜单没有这个选项。

如果您不想为此使用 Tortoise，一个简单的解决方法是：

*   从文件夹中删除文件（将它们临时存储在其他位置）

*   提交，删除的文件。

*   如果您现在不在提交计算机更新中

*   粘贴回删除的文件并将它们添加到忽略列表中。

# android - Android：如何重用回收的位图？

> ID：14707193
> 
> 赞同：3
> 
> 时间：2013-02-05T12:08:02.877
> 
> 标签：android, bitmap, recycle

当我不再需要位图时，我通常通过调用来回收它们

```
bitmap.recycle() 
```

但是，有几种情况我需要再次使用回收的 Bitmap，所以通常我只是再次加载它：

```
if(bitmap.isRecylced()) bitmap = BitmapFactory.decodeResource(gv.getContext().getResources(),bmp);
Log.e("log","bitmap recycled? "+bitmap.isRecycled()); 
```

正如我所料，bitmap.isRecycled() 在我的手机上返回“false”，但是当我尝试在另一部手机上运行该应用程序时，它返回“true”，Bitmap 仍然被回收，因此无法绘制。有谁知道可能导致此问题的原因以及如何解决？

# mvvm-light - 使用设计数据的最有效方法

> ID：14707194
> 
> 赞同：1
> 
> 时间：2013-02-05T12:08:08.337
> 
> 标签：mvvm-light

第一种方法，我之前一直使用的，是在 xaml 中定义设计数据：

```
d:DataContext="{d:DesignDataSource=/DesignData/MainPivot/ProductCategoriesDesignData.xaml}" 
```

然而，在开始使用 mvvm light 之后，我找到了自己的方式。通过 ViewModelLocator：

```
if (ViewModelBase.IsInDesignModeStatic)
        {
            // Create design time view services and models
        }
        else
        {
            // Create run time view services and models
        } 
```

那么哪一个更可取呢？（例如，不确定是否可以从 Blend 访问第二种方式）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T16:39:54.920

MVVM Light 中最好的功能之一是它如何处理设计时数据。

这就是为什么我真的喜欢使用设计时服务而不是

```
d:DataContext="{d:DesignDataSource=/DesignData/MainPivot/ProductCategoriesDesignData.xaml}" 
```

1.  您将编写更少的设计时代码。您几乎总是拥有比服务更多的视图模型。
2.  您的视图模型可以正确使用，并正确测试其逻辑。他们调用模拟服务并像往常一样处理数据。
3.  模拟服务实际上可能会指出您的视图模型中的错误。
4.  所有设计时代码都从 Xaml 中删除。它更干净

# javascript - 使用 JQuery 从现有 UL 将 LI 插入 UL

> ID：14707195
> 
> 赞同：0
> 
> 时间：2013-02-05T12:08:09.900
> 
> 标签：javascript, jquery, html-lists

我有 2 个 UL 和一个按钮

```
<ul class="droptrue ui-sortable" id="sortable1" style="min-height: 128px; mozuserselect: none;"
        unselectable="on">
        <li id="article_1" class="ui-state-default">
            <input type="checkbox" id="1" />
            Article #1</li>
        <li id="article_2" class="ui-state-default">
            <input type="checkbox" id="2" />
            Article #2</li>
        <li id="article_3" class="ui-state-default">
            <input type="checkbox" id="3" />
            Article #3</li>
</ul>

<ul class="droptrue ui-sortable" id="sortable2" style="min-height: 128px; mozuserselect: none;"
        unselectable="on">
        <li id="article_4" class="ui-state-default">
            <input type="checkbox" id="4" />
            Article #4</li>
        <li id="article_5" class="ui-state-default">
            <input type="checkbox" id="5" />
            Article #5</li>
        <li id="article_6" class="ui-state-default">
            <input type="checkbox" id="6" />
            Article #6</li>
    </ul>

<input type="button" id="add" value=">>" style="width: 15px" onclick="AddToList()" /> 
```

现在单击按钮，我需要删除相应的 li 表单“sortable1”并将其插入“sortable2”

我写了这样的函数

```
function AddToList() {
        var vals = $('#sortable1 input:checkbox:checked').map(
         function() {               
             $("#sortable2").append($(this).parent().html());
             $(this).parent().remove();
             return this.id;
         }).get().join(',');                        
    } 
```

但是这个函数删除了 li 但只将复选框添加到另一个 ul 中。如果我给 $(this).parent().parent().html() 它将所有 li 添加到另一个 ul。请告诉我我在这里缺少什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T12:12:10.513

使用`appendTo`方法。

```
 var vals = $('#sortable1 input[type=checkbox]:checked').map(function() { 
     $(this).parent().appendTo('#sortable2');
     return this.id;
 }).get().join(','); 
```

# php - 包含文件的某些内容未加载

> ID：14707196
> 
> 赞同：0
> 
> 时间：2013-02-05T12:08:11.040
> 
> 标签：php, include, require-once

我正在尝试使用 include_once() php api 将文件 (myfile.php) 的内容加载到另一个 (index.php) 中。但它没有加载内容。

```
// contents inside index page
if(include_once('myfile.php')){
    echo D; // this is working
    echo $b; // this is not working
} else {
    echo "unable to include the file";
}   

// contents inside myfile.php
define('D', '123');
$b = "abcd"; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T12:13:05.983

您可能没有正确包含它。

您可以[在文档](http://www.php.net/manual/en/function.include.php)中找到它：

```
<?php
// won't work, evaluated as include(('vars.php') == 'OK'), i.e. include('')
if (include('vars.php') == 'OK') {
    echo 'OK';
}

// works
if ((include 'vars.php') == 'OK') {
    echo 'OK';
}
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T12:18:10.597

[如手册](http://www.php.net/manual/en/function.include.php)中所述，include_once 不会在成功时返回 true 。

您需要使用 if ((include 'myfile.php') == 'OK') {....}

# drupal - 分类视图过滤器

> ID：14707198
> 
> 赞同：1
> 
> 时间：2013-02-05T12:08:15.850
> 
> 标签：drupal, drupal-7, drupal-modules, drupal-views, drupal-taxonomy

我们有以下图片：

![在此处输入图像描述](../Images/da581b202f8e11b5da3d9417c6123d17.png)

我们在同一个过滤器和 2 篇文章中有 4 个分类术语：一篇标记为ideea&news，另一篇标记为ideea&business。

现在，当您选择ideea&news 过滤器时，您将获得两篇文章作为结果。我怎样才能改变它，所以我得到了所选分类术语之间的交集（所以只有包含两个想法和新闻的结果）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T13:24:21.233

在您查看管理页面的`Advanced`部分下。点击`Query settings: Settings`并`Distinct`勾选。

希望这有效。

# c - sprintf 没有打印最后一个条目

> ID：14707199
> 
> 赞同：0
> 
> 时间：2013-02-05T12:08:16.810
> 
> 标签：c

sprintf 没有为变量 stats->info.transferID 提供正确的值，但 printf 为该变量提供了正确的值，所有其他值都是正确的

```
char buff[200]; 
sprintf(buff,"Index:1:%u:%u:%d\n",
            stats->connection.peer,
            stats->connection.local,
            stats->info.transferID);
printf("  %s",buff);
printf("  %d\n",stats->info.transferID); 
```

info 是 Transfer_Info 类型的结构。

```
typedef struct Transfer_Info {
    void *reserved_delay;
    int transferID;
    ----
    ----
 } 
```

我得到的输出：

```
Index:1:2005729282:3623921856:0

3 
```

缓冲区的大小足以容纳其值，

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T12:20:40.237

为我工作：

```
#include <stdio.h>

struct connection
{
  unsigned peer, local;
};

struct info
{
  int transferID;
};

struct stats
{
  struct connection connection;
  struct info info;
};

int main(void)
{
  char buff[100];

  struct stats s = { { 1, 2 }, { 3 } };
  struct stats* stats = &s;

  sprintf(buff,"Index:1:%u:%u:%d\n",
              stats->connection.peer,
              stats->connection.local,
              stats->info.transferID);

  printf("  %s",buff);
  printf("  %d\n",stats->info.transferID);

  return 0;
} 
```

输出（[ideone](http://ideone.com/TL7E4B)）：

```
 Index:1:1:2:3
  3 
```

你确定缓冲区足够大吗？您确定您使用的是正确的类型说明符（`%u`和`%d`）吗？

# windows-phone-7 - 如何在wp7中找到一个地方的经纬度

> ID：14707200
> 
> 赞同：0
> 
> 时间：2013-02-05T12:08:19.633
> 
> 标签：windows-phone-7, geolocation, gps

如何在Wp7中查找地址的纬度和经度

**前任 ：**

如果我给出位置名称：“纽约”，那么我想得到它的纬度和经度。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T09:18:18.997

```
WebClient webClient = new WebClient();
string xml = webClient.DownloadString("http://nominatim.openstreetmap.org/search?city=%22new%20york%22&format=xml"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-06T10:04:30.007

这应该有效：

用于反序列化 json 字符串的类

```
public class PlaceInfo
{
    public string place_id { get; set; }
    public string licence { get; set; }
    public string osm_type { get; set; }
    public string osm_id { get; set; }
    public List<string> boundingbox { get; set; }
    public string lat { get; set; }
    public string lon { get; set; }
    public string display_name { get; set; }
    public string @class { get; set; }
    public string type { get; set; }
    public double importance { get; set; }
    public string icon { get; set; }
} 
```

这是从网站获取信息的代码：格式为 JSON，我使用的是 c# 的 json 序列化器

使用 System.Runtime.Serialization；使用 System.Runtime.Serialization.Json；

```
WebClient webClient = new WebClient();
string jsonString = webClient.DownloadString("http://nominatim.openstreetmap.org/search?city=%22new%20york%22&format=json");

//load into memorystream
using (var ms = new MemoryStream(Encoding.Unicode.GetBytes(jsonString)))
{
    //parse
    var ser = new DataContractJsonSerializer(typeof(PlaceInfo[]));
    PlaceInfo[] obj = (PlaceInfo[])ser.ReadObject(ms);
} 
```

数组 obj 现在具有使用该名称找到的所有位置。例如 jsut 占据第一位，发现 obj[0].lon 和 obj[0].lat

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T12:20:52.590

也许你可以使用openstreetmaps：

[http://nominatim.openstreetmap.org/search?city=%22new%20york%22&format=json](http://nominatim.openstreetmap.org/search?city=%22new%20york%22&format=json)

[http://nominatim.openstreetmap.org/search?city=](http://nominatim.openstreetmap.org/search?city=) "---cityname---"&countrycodes="---CountryCode---"&limit=2&format=json

[http://wiki.openstreetmap.org/wiki/Nominatim](http://wiki.openstreetmap.org/wiki/Nominatim)

您可以将结果作为 json 或 xml

# ipad - 使用 Core Data 高效显示 100,000 个项目

> ID：14707201
> 
> 赞同：5
> 
> 时间：2013-02-05T12:08:20.560
> 
> 标签：ipad, core-data, nsfetchrequest

我正在使用 NSFetchResultsController 在 UITableView 中显示 100,000 多条记录。这可行，但速度很慢，尤其是在 iPad 1 上。加载可能需要 7 秒，这对我的用户来说是一种折磨。

我也希望能够使用部分，但这至少会增加 3 秒的延迟时间。

这是我的 NSFetchResultsController：

```
- (NSFetchedResultsController *)fetchedResultsController {

    if (self.clientsController != nil) {
        return self.clientsController;
    }

    NSFetchRequest *request = [[NSFetchRequest alloc] init];
    NSEntityDescription *entity = [NSEntityDescription entityForName:@"Client" inManagedObjectContext:self.managedObjectContext];
    [request setEntity:entity];
    [request setPredicate:[NSPredicate predicateWithFormat:@"ManufacturerID==%@", self.manufacturerID]];
    [request setFetchBatchSize:25];

    NSSortDescriptor *sort = [[NSSortDescriptor alloc]  initWithKey:@"UDF1" ascending:YES];
    NSSortDescriptor  *sort2= [[NSSortDescriptor alloc] initWithKey:@"Name" ascending:YES];
    [request setSortDescriptors:[NSArray arrayWithObjects:sort, sort2,nil]];

    NSArray *propertiesToFetch = [[NSArray alloc] initWithObjects:@"Name", @"ManufacturerID",@"CustomerNumber",@"City", @"StateProvince",@"PostalCode",@"UDF1",@"UDF2", nil];
    [request setPropertiesToFetch:propertiesToFetch];

    self.clientsController =
    [[NSFetchedResultsController alloc] initWithFetchRequest:request
                                        managedObjectContext:self.managedObjectContext sectionNameKeyPath:nil
                                                   cacheName:nil];

    return self.clientsController;

} 
```

我有一个在我的 NSPredicate 中使用的 ManufacturerID 索引。这似乎是一个非常基本的 NSFetchRequest - 我能做些什么来加快速度？还是我刚刚达到了限制？我肯定错过了什么。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-05T15:00:42.307

第一：您可以`NSFetchedResultsController`在第一次获取后使用 的缓存来加快显示速度。这应该很快下降到几分之一秒。

第二：您可以尝试仅显示第一个屏幕，然后在后台获取其余部分。我通过以下方式执行此操作：

*   当视图出现时，检查您是否有第一页缓存。
*   如果没有，我会获取第一页。您可以通过设置获取请求的`fetchLimit`.
    *   如果您正在使用部分，请执行两次快速提取以确定第一个部分标题和记录。
*   在后台线程中使用您的 long fetch 填充第二个 fetched results 控制器。
    *   您可以创建一个子上下文并使用`performBlock:`或
    *   使用`dispatch_async()`.
*   将第二个 FRC 分配给表视图并调用`reloadData`.

这在我最近的一个记录超过 200K 的项目中效果很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-17T14:01:48.510

我知道@Mundi 提供的答案已被接受，但我已经尝试实施它并遇到了问题。具体来说，第二个 FRC 创建的对象将基于另一个线程的 ManagedObjectContext。由于这些对象不是线程安全的，并且在另一个线程上属于它们自己的 MOC，因此我找到的解决方案是在加载对象时对其进行故障排除。所以在 cellForRowAtIndexPath 我添加了这一行：

```
NSManagedObject *object = [self.fetchedResultsController objectAtIndexPath:indexPath];
object = (TapCellar *)[self.managedObjectContext existingObjectWithID:[object objectID] error:nil]; 
```

然后你就有了一个对应于你所在线程的对象。另外需要注意的是，你对对象所做的更改不会反映在后台 MOC 中，因此你必须协调它们。我所做的是将后台 MOC 设为私有队列 MOC，而前台是它的子 MOC，如下所示：

```
NSPersistentStoreCoordinator *coordinator = [self persistentStoreCoordinator];
if (coordinator != nil) {
  _privateManagedObjectContext = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSPrivateQueueConcurrencyType];
  [_privateManagedObjectContext setPersistentStoreCoordinator:coordinator];

  _managedObjectContext = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSMainQueueConcurrencyType];
  [_managedObjectContext setParentContext:_privateManagedObjectContext];

} 
```

现在，当我在主线程中进行更改时，我可以通过执行以下操作轻松协调它们：

```
if ([self.managedObjectContext hasChanges]) {
   [self.managedObjectContext performBlockAndWait:^{
      NSError *error = nil;
      ZAssert([self.managedObjectContext save:&error], @"Error saving MOC: %@\n%@",
             [error localizedDescription], [error userInfo]);
   }];
} 
```

我等待它的返回，因为此时我要重新加载表数据，但如果你愿意，你可以选择不等待。即使对于 30K+ 记录，这个过程也非常快，因为通常只更改一两个。

希望这可以帮助那些坚持这一点的人！

# linq - 使用 LINQ 自定义比较字典

> ID：14707203
> 
> 赞同：1
> 
> 时间：2013-02-05T12:08:26.193
> 
> 标签：linq, dictionary

我有两个字典如下：

```
//Dictionary 1:

Dictionary<string, string> dict1 = new Dictionary<string, string>();
dict1 .Add("key1", "value1");
dict1 .Add("key2", "value2");    
dict1 .Add("key3", "value3");

//Dictionary 2 :
Dictionary<string, string> request = new Dictionary<string, string>();
request.Add("key1", "value1");
request.Add("key2", "value2"); 
```

我需要使用带有条件的 LINQ 查询来比较上述两个字典：

1.  **dict2 中的所有键都应与 dict1 中的键匹配**

2.  **匹配的键应该具有相同的值**

我尝试在字典上创建一个扩展方法，但它返回 false，因为 dict1 包含一个额外的对。

```
public static class DictionaryExtension
{
    public static bool CollectionEquals(this Dictionary<string, string> collection1,
                                        Dictionary<string, string> collection2)
    {
        return collection1.ToKeyValue().SequenceEqual(collection2.ToKeyValue());
    }

    private static IEnumerable<object> ToKeyValue(this Dictionary<string, string>  collection)
    {
        return collection.Keys.OrderBy(x => x).Select(x => new {Key = x, Value = collection[x]});
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T12:17:29.930

您可以只使用[`All()`](http://msdn.microsoft.com/en-us/library/bb548541.aspx)扩展方法来测试集合的所有元素是否满足特定条件。

```
var dict1 = new Dictionary<string, string>
{
    {"key1", "value1"},
    {"key2", "value2"},
    {"key3", "value3"}
};

var dict2 = new Dictionary<string, string>
{
    {"key1", "value1"},
    {"key2", "value2"}
};

dict2.All(kvp => dict1.Contains(kvp)); // returns true 
```

* * *

另一种（可能更快，但不是那么时髦）的方法是做两个哈希集的交集：

```
var h1 = new HashSet<KeyValuePair<string, string>>(dict1);
var h2 = new HashSet<KeyValuePair<string, string>>(dict2);
h1.IntersectWith(h2);
var result = (h1.Count == h2.Count); // contains true 
```

# java - jqgrid：更改选择的值

> ID：14707205
> 
> 赞同：0
> 
> 时间：2013-02-05T12:08:36.813
> 
> 标签：java, javascript, jsp, servlets, jqgrid

我正在使用 JSP 和 Servlet（IDE：Eclipse，数据库：Oracle10）开发一个 Web 应用程序。我`jqGrid`用来以表格格式显示记录。

**代码片段：**

```
{name:'CITY',index:'CITY', width:70,editable:true,edittype:"select",editoptions: {dataUrl: 'ProfileServ?action=comboCity', dataEvents: [{  type: 'change', fn: function(e) {alert(this.value);city= this.value;}}],}}, 
{name:'PIN',index:'PIN', width:200,sortable:false,editable:true, edittype:"select",editoptions: {dataUrl: 'ProfileServ?action=comboPin'}}, 
```

我想`PIN`根据 中选择的值更改 的值`CITY`。我已经使用`dataEvents`and`type: 'change'`来获取`CITY`. 我成功地获得了选定的值`CITY`。

我的问题是，我应该如何更新值更改`PIN`时的值？`CITY`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T12:18:00.683

不幸的是，没有简单的方法来实现依赖选择。必须在回调中**手动**更新整个`<select>`依赖选择（在您的情况下更新 PIN 选择）。我可以建议您的唯一方法是从[答案中检查](https://stackoverflow.com/a/4480184/315935)[演示](http://www.ok-soft-gmbh.com/jqGrid/EditWithDependendSelects2_.htm)代码。它不完全是您所需要的，因为它不使用，但它显示了应该做什么。**`change``dataUrl`**

# lisp - 在 Emacs Lisp 中获取指向列表元素的指针

> ID：14707208
> 
> 赞同：6
> 
> 时间：2013-02-05T12:08:47.193
> 
> 标签：lisp, elisp

例如，我有一个列表：

```
(setq foo '(1 2 3 4 5)) 
```

然后我需要获得一个指向其第三个索引元素的指针（`4`在示例中包含）：

```
(setq p (SOME_FUNCTION foo 3)) 
```

具有 p 地址的元素可以移动到另一个列表，所以我不能只保存它的当前`foo`索引。

我需要稍后再说：

```
(push 0 foo)
=> (0 1 2 3 4 5)
(setf p 444) 
```

并且列表`foo`必须在`(0 1 2 3 444 5)`之后。

这在 Emacs lisp 中可行吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-05T12:22:51.797

通常，您不能存储对象的“地址”。但是，您可以参考 cons 单元格（cons 单元格是列表的组成部分）。稍后可以使用`setcar`and修改 cons 单元格`setcdr`。

例如：

```
(defvar my-cons-cell nil)

(defun my-save-cons-cell (cons-cell)
  (setq my-cons-cell cons-cell))

(defun my-set-car-in-saved-cons-cell (value)
  (setcar my-cons-cell value))

;; Test

(setq foo '(1 2 3 4 5))

(my-save-cons-cell (cdr (cdr (cdr foo))))

(push 0 foo)

(my-set-car-in-saved-cons-cell 444) 
```

这里，`foo`有值`(0 1 2 3 444 5)`。

请注意，这真的不像lisp，并且打破了函数式编程范式......

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-05T13:22:03.087

你可以做

```
(setq p (nth 3 foo)) 
```

它存储在`p`您想要的索引处存储的值中。你也可以做

```
(setf (nth 3 foo) 444) 
```

将 444 存储在那个地方。但是如果你尝试做类似的事情

```
(setq pointer (nth 3 foo))
...
(setf pointer 444) 
```

那是行不通的。在我最近添加的 Emacs 的主干`gv-ref`中`gv-deref`，在这种情况下它可以正常工作。它们的工作方式与 C 非常相似`&`，并且`*`：

```
(setq pointer (gv-ref (nth 3 foo)))
...
(setf (gv-deref pointer) 444) 
```

# jquery - 使用 jquery 选择后在 div 中显示图像

> ID：14707209
> 
> 赞同：2
> 
> 时间：2013-02-05T12:08:48.433
> 
> 标签：jquery

如何使用 jQuery 在 div 中显示图像？我有这段代码，但它不工作。

```
$(document).ready(function () {
    $("#up").click(function () {
        var imgUrl = $("img_input").val();
        $("#imageDiv").prop("src", imgUrl).show();
    });
}); 
```

`up`给到`id`：

```
<input id="img_input" type="file">
<button id="up"> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T12:11:03.097

改变：

```
$("img_input").val(); 
```

至

```
$("#img_input").val(); 
```

如果`imageDiv`它的 id`div`和图像存在于其中，则执行以下操作：

```
$("#imageDiv").find("img").prop("src", imgUrl).show(); 
```

# sql - 在远程计算机的命令提示符下执行命令

> ID：14707211
> 
> 赞同：0
> 
> 时间：2013-02-05T12:08:51.617
> 
> 标签：sql, powershell, command-line

我需要在远程计算机的命令提示符下执行命令：- Powermt display dev = all。我怎么做 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T16:12:35.183

如果您在两台计算机上都有 PowerShell 2.0 或更高版本，并且可以通过 execute 在远程计算机上启用远程处理`Enable-PSRemoting -Force`，那么您可以从提升的/管理员 PowerShell 提示符运行：

```
Invoke-Command -ComputerName remotepcname -ScriptBlock { <commands to execute remotely> } 
```

这将远程执行命令并将结果返回到本地计算机。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T01:57:15.737

这是尝试 psexec 和 powershell 失败的另一种选择。这是令人费解和骇人听闻的，但至少可以尝试其他方法。:)

首先，在您自己的机器上共享一个文件夹。*确保在远程*计算机上具有管理员权限的帐户对您创建的此共享具有写入权限。然后执行以下命令：

```
wmic /node:remoteComputerAddr /user:adminOnRemoteComputer /password:adminPassword process call create "cmd.exe /c powermt display dev=all >>\\localComputerAddr\shareName\results.txt"
@type "c:\local\path\to\share\results.txt" 
```

不幸的是，`wmic`它没有向您显示它创建的过程的输出。这就是为什么您在本地工作站上启用共享，然后将远程命令的输出重定向到您的共享。

[更多信息](http://blog.commandlinekungfu.com/2009/05/episode-31-remote-command-execution.html)。

# python - python：将字符串转换为 c_ubyte_Array_8

> ID：14707218
> 
> 赞同：0
> 
> 时间：2013-02-05T12:09:13.087
> 
> 标签：python, struct, ctypes

我有一个写入`unsigned char`数据块的 c++ 应用程序。所以我会写`unsigned char data[8]`。

现在，我正在使用 python（python 中的读取`ctypes`功能）在我的工具中读取和缓冲它以进行进一步处理。

**问题**
当我从文件中读取数据并将其分解为 8 个块时，所有结果数据都是字符串格式。我具有以下结构

```
class MyData(Union):
     _fields_=[ ("data",8 * c_ubytes), ("overlap", SelfStructure) ] 
```

现在，我正在尝试按如下方式传递数据

```
 dataObj = MyData(str[0:8]) 
```

它抛出一个错误，`expected c_ubyte_Array_8 instance, got str`. 我想我需要转换`string`为`array of size 8 of c_ubyte`. 尝试过`bytearray`但没有成功。请让我知道该怎么做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T12:12:42.630

尝试这个：

```
(ctypes.c_ubyte * 8)(*[ctypes.c_ubyte(ord(c)) for c in str[:8]]) 
```

# web-applications - STS 3.1 中的 Spring MVC 项目

> ID：14707219
> 
> 赞同：1
> 
> 时间：2013-02-05T12:09:14.720
> 
> 标签：web-applications, spring-mvc

需要 Spring 开发人员的帮助。

我在 Windows 上使用 STS 3.1。通过选择 New > Spring Template Project > Spring MVC project named 'mymvc' 创建了一个新的 MVC 项目，并在 vFabric tc 服务器下运行它。当我将浏览器指向 时`http://localhost:8080/mymvc/`，它会出现 404 错误，但在我使用 url 时工作正常`http://localhost:8080/app/`。

服务器上只有一个应用程序，`/app` 项目中没有url映射。

我错过了什么吗？

请指导。谢谢。

编辑

这是 web.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app version="2.5" xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd">

    <!-- The definition of the Root Spring Container shared by all Servlets and Filters -->
    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/spring/root-context.xml</param-value>
    </context-param>

    <!-- Creates the Spring Container shared by all Servlets and Filters -->
    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>

    <!-- Processes application requests -->
    <servlet>
        <servlet-name>appServlet</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <init-param>
            <param-name>contextConfigLocation</param-name>
            <param-value>/WEB-INF/spring/appServlet/servlet-context.xml</param-value>
        </init-param>
        <load-on-startup>1</load-on-startup>
    </servlet>

    <servlet-mapping>
        <servlet-name>appServlet</servlet-name>
        <url-pattern>/</url-pattern>
    </servlet-mapping>

</web-app> 
```

还有一件事：我已将我的包命名为 com.mycompany.app 并启动​​了 STS `http://localhost:8080/app/`，而不是`http://localhost:8080/mymvc/`在我运行项目时启动。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T13:32:30.137

我认为该应用程序是您的包名称的最后一部分。例如，我认为您有以下情况：您的项目名为**myproject**，并且在其中，您有一个名为：**org.blabla.app的包**

默认情况下，STS 使用包名的最后一部分来创建项目的 URL，事实上你有这个 URL：`http://localhost:8080/app/`工作得很好

如果您希望您的 URL 类似于`http://local_host:8080/projectname`您必须更改项目的上下文根，使用 STS\Eclipse 您必须执行以下操作：

右键单击您的项目名称（在包资源管理器中）---> Web Project Setting 并在上下文根字段中插入您的项目名称，再次部署您的项目，这就是全部

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T14:08:57.107

您还有其他解决方案可以为您的应用程序配置 Tomcat 服务器，例如[Tomcat 默认应用程序](http://wiki.apache.org/tomcat/HowTo#How_do_I_make_my_web_application_be_the_Tomcat_default_application.3F)或[更改 server.xml 中的上下文](https://stackoverflow.com/questions/3773687/changing-app-root-for-spring-mvc-app-on-tomcat)

# python - Django：使用友好名称的 list_filter

> ID：14707226
> 
> 赞同：6
> 
> 时间：2013-02-05T12:09:46.160
> 
> 标签：python, django

在我的 admin.py 中，我按“活动”和“国家”进行过滤，这是使用SomethingAdmin 类中的以下代码行完成的......

```
 list_filter = ['active', 'countryid'] 
```

正如您所见，countryid 在我的管理列表视图中显示时并不漂亮，我怎样才能将其更改为更友好的名称，只说“国家”？

谢谢。

**更新：** 下面似乎工作：

```
incentiveid = models.ForeignKey(Incentive,verbose_name="Incentive", 
null=True, db_column='incentiveID', blank=True) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T12:16:25.623

正如[Aamir](https://stackoverflow.com/users/860103/aamir-adnan)所说，如果您在模型中的字段上定义标签，您应该会看到更具吸引力的过滤器选项：

```
class MyModel(models.Model):
    countryid = models.ForeignKey(Country, 
                                  verbose_name="Country", null=True, 
                                  db_column='countryID', blank=True) 
```

假设这`Country`是另一个名称`Model`- 这应该显示在`Admin`过滤器视图中。

# java - 在jsp中连接url

> ID：14707231
> 
> 赞同：2
> 
> 时间：2013-02-05T12:10:10.553
> 
> 标签：java, html, jsp, concatenation

我想将 url 与字符串变量的值连接起来。例子

```
string filename="example"
string extention="txt"
<a href="myuploads/(value of filename).(value of extention)"> 
```

我怎样才能做到这一点 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T12:21:37.510

```
String filename = "example"
String extension = "txt"
String url = "myuploads/" + filename + "." + extension 
```

我的 JSP ：

```
<a href='<%= url%>'></a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T12:57:18.627

除了声明另一个变量，它也可以这样做：

```
<a href="myuploads/<%=filename %>.<%=extension %>"></a> 
```

无论何时何地，都必须限制使用不必要的变量。

# c# - 用纯虚方法包装类

> ID：14707240
> 
> 赞同：0
> 
> 时间：2013-02-05T12:10:38.313
> 
> 标签：c#, c++, c++-cli, wrapper, word-wrap

我有一个非托管 dll，其中包含一个仅具有纯虚拟方法的类（一种回调）：

```
class PAClient
{
public:
    __declspec(dllexport) virtual void SetCalculationStarted() = 0;     
    __declspec(dllexport) virtual void SetCalculationStopped() = 0; 
} 
```

现在我必须将这些函数调用发送到托管 C# 代码并决定为此使用接口。这就是我所做的：

```
public interface class IPAClientWrapper
{
    void SetCalculationStarted();       
    void SetCalculationStopped();   
};

private class PAClientWrapper : public PAClient
{
private:
    gcroot<IPAClientWrapper^> callBack;

public:

    PAClientWrapper(IPAClientWrapper^ c)
    {
        callBack = c;
    }

    void SetCalculationStarted()
    {
        callBack->SetCalculationStarted();
    }

    void SetCalculationStopped()
    {
        callBack->SetCalculationStopped();
    }
} 
```

但是每次调用非**托管** `SetCalculationStarted()`时，非托管代码都会抛出异常：

```
An unhandled exception of type 'System.AccessViolationException' occurred in PAnalysisLib.dll

Additional information: Attempted to read or write protected memory. This is often an indication that other memory is corrupt. 
```

**编辑：**

```
public partial class Form1 : Form, IPAClientWrapper
{
    public Form1()
    {
        InitializeComponent();
    }

    public void SetCalculationStarted()
    {
        Console.WriteLine("started");
    }

    public void SetCalculationStopped()
    {
        Console.WriteLine("stopped");
    } 
```

}

我错过了什么吗？

# reporting-services - 在 IIF 表达式中将字符串转换为 DateTime

> ID：14707245
> 
> 赞同：3
> 
> 时间：2013-02-05T12:10:58.900
> 
> 标签：reporting-services, ssrs-2008, reporting, ssrs-2008-r2

我正在使用 SSRS 2008R2 创建报告。数据源是来自 web 服务的 xml 响应。如果没有数据，我想返回空字符串，但如果有数据行，我想将其转换为另一种日期时间格式。

我正在使用这样的IIF构造：

```
=IIF
(
    LEN(Fields!DateOfReg.Value) <= 0,
    "",
    FORMAT(CDATE(DateTime.ParseExact(Fields!DateOfReg.Value,"M/d/yyyy hh:mm:ss tt",
    System.Globalization.CultureInfo.InvariantCulture)), "dd.MM.yyyy HH:mm:ss")
) 
```

当没有数据时，它会在文本框和输出中显示**#Error ：**

> 字符串未被识别为有效的 DateTime

这是否意味着 IIF 构造同时计算 TRUE 和 FALSE 语句？如果是这样，如果没有数据，我怎样才能使它短路并且不转换行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T12:45:58.450

尝试以下操作：

```
=IIF
(
    Fields!DateOfReg.Value= "",
    "",
    Datevalue(Cstr(Fields!DateOfReg.Value))
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T13:51:31.593

是的，你是对的 - IIF 计算这两个语句。但是您可以使用 IIF 将空字符串转换为“Nothing”，然后尝试对其进行格式化，如下所示：

```
Format(IIF(Fields!DateOfReg.Value = "", Nothing, Fields!DateOfReg.Value), "yyyy/MM/dd") 
```

如果传递空字符串，格式化函数会导致异常，但如果传递“Nothing”，则返回空字符串。

# html - Twitter Bootstrap Glyphicons IE8 及更低版本中的部分不透明度

> ID：14707251
> 
> 赞同：1
> 
> 时间：2013-02-05T12:11:08.650
> 
> 标签：html, css, twitter-bootstrap, opacity, glyphicons

我在一个项目中使用[Twitter Bootstrap](http://twitter.github.com/bootstrap)的字形图标，并希望它们在 :hover 上变得部分透明。当然，在 Chrome、FF、Safari 甚至 IE9+ 中一切正常。

然而，在 IE7 和 IE8 中，不透明度使图标看起来很糟糕。以下是测试的要点：

```
<!doctype html>
<html>
    <head>
        <link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/css/bootstrap-combined.min.css" rel="stylesheet">
        <style>
            #icon {
                margin: 50px;
            }

            #icon:hover {
                -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=70)";
                filter: alpha(opacity=70);
                opacity: 0.7;
            }
        </style>
    </head>
    <body>
        <i id="icon" class="icon-search"></i>
    </body>
</html> 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T12:25:15.507

尝试更改顺序，以便后备在实际声明之后。

```
#icon:hover {

opacity: 0.7;
filter: alpha(opacity=70);
-ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=70)";

} 
```

# java - 为什么不简单地禁用未经检查的警告？

> ID：14707256
> 
> 赞同：10
> 
> 时间：2013-02-05T12:11:29.243
> 
> 标签：java, generics, unchecked

当开发人员与非通用 API 交互时，他们通常会遇到“未经检查”的警告。考虑以下示例：

```
import java.util.AbstractList;

import org.w3c.dom.Node;
import org.w3c.dom.NodeList;

public class IterableNodeList<T extends Node> extends AbstractList<T>
{
    private NodeList list;

    public IterableNodeList(NodeList list)
    {
        this.list = list;
    }

    public T get(int index)
    {
        return (T)this.list.item(index);
    }

    public int size()
    {
        return this.list.getLength();
    }
} 
```

当然可以投入精力以一种没有警告的方式编写此代码：在`T`类上使用类型参数和构造函数参数`Class<T>`，匹配成员变量和`cast()`调用。

或者，可以考虑简单地编辑 IDE 配置和构建脚本（例如 Maven POM）以完全禁用此编译器警告。现在，如果我们这样做，代码可以保持原样，但我确信这样做肯定有缺点。但是，我想不出任何合理、现实的例子

*   此警告提供的价值比“坚持在`@SuppressWarnings`这里，反正没有其他选择”以及在哪里
*   结果代码的行为实际上与我们忽略（禁用）警告的代码不同（并且更安全）。

你能想出这样的例子或说出另一个为什么全局禁用这些“未经检查的”警告是一个坏主意的原因吗？或者这实际上是个好主意？

## 更新

**前面的例子实际上并没有引起警告。有些答案现在不再有意义。带来不便敬请谅解。**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T12:23:03.593

根据`Item 24`of `Effective Java 2nd Edition`，广泛而频繁地使用`@SupressWarnings`通常是个坏主意，特别是如果您将此注释应用于整个类，因为此类警告显示您可能有危险的代码片段，这可能会导致`ClassCastException`.

但在某些情况下它可能很有用，例如在`ArrayList`的`toArray`方法实现中：

```
@SuppressWarnings("unchecked")
public <T> T[] toArray(T[] a) {
    if (a.length < size)
        // Make a new array of a's runtime type, but my contents:
        return (T[]) Arrays.copyOf(elementData, size, a.getClass());
    System.arraycopy(elementData, 0, a, 0, size);
    if (a.length > size)
        a[size] = null;
    return a;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-08T14:22:08.507

From *Effective Java 2nd Edition*:

> The `SuppressWarnings` annotation can be used at any granularity, from an individual local variable declaration to an entire class. **Always use the `SuppressWarnings` annotation on the smallest scope possible**. Typically this will be a variable declaration or a very short method or constructor. Never use `SuppressWarnings` on an entire class. Doing so could mask critical warnings.
> 
> If you find yourself using the `SuppressWarnings` annotation on a method or constructor that’s more than one line long, you may be able to move it onto a local variable declaration. You may have to declare a new local variable, but it’s worth it.
> 
> It is illegal to put a `SuppressWarnings` annotation on the return statement, because it isn’t a declaration [JLS, 9.7]. You might be tempted to put the annotation on the entire method, but don’t. Instead, declare a local variable to hold the return value and annotate its declaration

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-05T12:38:11.837

您的第二个示例不会在我的 Eclipse 中导致编译器警告，我也想不出它应该出现的原因。因此，这是我的首选解决方案。

存在未经检查的警告的原因是忽略它们会导致*堆污染*：

检查普通类型转换，即`ClassCastException`如果值与所需类型不兼容，它们会导致 a。未经检查的强制转换不能保证这一点，即即使值不是正确的类型，它们也能成功。这可能导致变量持有的值不是其声明类型的子类型，Java 规范[称为](http://docs.oracle.com/javase/specs/jls/se7/html/jls-4.html#jls-4.12.2)“堆污染”的情况。为了确保运行时类型系统的完整性，每当使用泛型类型的变量时，Java 编译器都会插入普通类型转换。在存在堆污染的情况下，这些强制转换可能会失败。

例如，程序：

```
static void appendTo(List list) {
    list.add(1); // unchecked warning
}

static void printLengths(List<String> strings) {
    for (String s : strings) { // throws ClassCastException
        System.out.println(s.length());
    }
}

public static void main(String[] args) throws Exception {
    List<String> strings = new ArrayList<>();
    strings.add("hello");
    appendTo(strings);
    printLengths(strings);
} 
```

`ClassCastException`在源代码中不包含强制转换的行处抛出 a 。这可能会严重混淆大多数程序员。

这就是为什么我建议尽可能使用检查转换，或者使用非泛型转换，或者（在泛型代码中）反射转换：

```
class Habitat<T> {
    private final Class<T> clazz;

    private List<T> inhabitants;

    void add(Object o) {
        inhabitants.add(clazz.cast(o));
    }
} 
```

# c# - 自引用实体上的 Linq 查询条件

> ID：14707257
> 
> 赞同：0
> 
> 时间：2013-02-05T12:11:31.963
> 
> 标签：c#, .net, linq, nhibernate, linq-to-nhibernate

我试图`Queried`从数据库中检索所有类型的实体，其中`Referenced`属性或其祖先的标签（意思是referenced.Parent.ChildLabel）等于某个给定的标签值`exampleLabel`，`Id`等于`exampleId`。

我尝试使用：

```
var result = nhibernateSession
    .Query<Queried>()
    .Where(queried => queried.SelfReferencing.GetSelfOrAncestor("exampleLabel") == exampleId)
    .ToList(); 
```

但它会抛出“System.NotSupportedException”，可能是因为它不知道如何将其转换`GetSelfOrAncestor`为 SQL。

该方法`GetSelfOrAncestor(string label)`返回调用它的实例或其祖先满足等于 的条件`Id`，否则返回 0。`SelfReferencing``this.Parent.ChildLabel``exampleLabel`

例如，在下图中，如果`queried.SelfReferencing`指向 at的对象`Level 2`，则`GetSelfOrAncestor("exampleLabel")`返回`Id`对象的 at `Level 1`。

[http://j.mp/Xl86OP](http://j.mp/Xl86OP)

```
public class Queried
{
    public int Id { get; set; }
    public SelfReferencing Referenced { get; set; }
}

public class SelfReferencing
{
    public SelfReferencing Parent { get; set; }
    private IList<SelfReferencing > children = new List<SelfReferencing >();
    public virtual IList<SelfReferencing > Children
    {
        get
        {
            return children;
        }
        set
        {
            children = value;
        }
    }
    public string ChildLabel { get; set; }
} 
```

任何有关如何实现这一目标的帮助将不胜感激:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T12:54:17.703

为了实现你想要的，我会在 SelfReference 中提供一个方法，通过对象图搜索标签。

应该是这样的：（警告，尚未测试！）

```
 public bool ContainsLabel(string label)
    {
        if (this.ChildLabel.Equals(label))
        {
            return true;
        }
        else
        {
            foreach (var child in Children)
            {
                return child.ContainsLabel(label);
            }
        }

        return false;
    } 
```

您可以按如下方式使用它：

```
var result = nhibernateSession
    .Query<Queried>()
    .Where(queried => queried.SelfReferencing.ContainsLabel("exampleLabel"))
    .ToList(); 
```

为方便阅读而编辑。

# javascript - JavaScript insertBefore 不更新 - 需要双击或三击

> ID：14707259
> 
> 赞同：1
> 
> 时间：2013-02-05T12:11:37.217
> 
> 标签：javascript

这让我发疯，这是一个在两个节点 ul 中交换两个节点的简单脚本：

```
// Html
<input type="button" onclick="swapItems()" value="Swap Items" />

//JavaScript
function swapItems() {
    var ul2 = document.getElementById("ul2");
    var first = ul2.firstChild;
    var last = ul2.lastChild;
    ul2.insertBefore(last, first);
} 
```

它可以工作，但我必须双击或三次单击按钮才能查看更改的列表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T12:23:20.280

如果您查看 ul2 的 childNodes，它将变得很明显。ul2 的第一个子节点是空白文本节点，最后一个子节点也是如此。您必须单击几次的原因是您正在移动空白文本节点。您在网页上看不到它，但如果您使用网络检查器，您应该能够将其拾取。

您可以将代码更改为：

```
function swapItems() {
    var ul2 = document.getElementById("ul2");
    var liChildren = ul2.getElementsByTagName('li');
    var first = ul2.liChildren[0];
    var last = ul2.liChildren[liChildren.length - 1];
    ul2.insertBefore(last, first);
} 
```

这应该可以按您的意愿工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T12:31:13.023

删除#ul2 中的空格。空格也被视为子节点。

# php - 查找按月分组的用户帖子，unixtime

> ID：14707262
> 
> 赞同：0
> 
> 时间：2013-02-05T12:11:40.940
> 
> 标签：php, mysql

我想找到按月分组的每个用户的帖子数。我目前正在使用 INT(10) unsigned 来存储帖子的日期。

什么是一个超级快速的方法来做到这一点？

```
CREATE TABLE IF NOT EXISTS `media` (
  `pid` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `class` tinyint(1) NOT NULL DEFAULT '1',
  `date_class_changed` int(10) unsigned NOT NULL,
  `title` char(5) CHARACTER SET latin1 COLLATE latin1_general_cs NOT NULL,
  `url` varchar(1024) CHARACTER SET latin1 COLLATE latin1_general_ci NOT NULL,
  `media` enum('image','video') CHARACTER SET latin1 COLLATE latin1_general_ci NOT NULL,
  `thumb` varchar(255) CHARACTER SET latin1 COLLATE latin1_general_ci NOT NULL,
  `description` varchar(140) COLLATE utf8_unicode_ci NOT NULL,
  `username` varchar(16) CHARACTER SET latin1 COLLATE latin1_general_ci NOT NULL,
  `date` int(10) unsigned NOT NULL,
  `file` varchar(1024) CHARACTER SET latin1 COLLATE latin1_general_ci NOT NULL,
  `hash` char(32) CHARACTER SET latin1 COLLATE latin1_general_ci NOT NULL,
  `hashtag` text CHARACTER SET latin1 COLLATE latin1_general_ci NOT NULL,
  `meta` varchar(255) CHARACTER SET latin1 COLLATE latin1_general_ci NOT NULL,
  `ip` int(10) unsigned NOT NULL,
  `kind` tinyint(1) unsigned NOT NULL DEFAULT '0',
  PRIMARY KEY (`pid`),
  UNIQUE KEY `title` (`title`),
  KEY `hash` (`hash`),
  KEY `class_date` (`class`,`date_class_changed`),
  KEY `username` (`username`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci AUTO_INCREMENT=1022724 ; 
```

这是表格，我在说，我想显示每个用户每个 mont 的帖子数，例如：2012 年 9 月，用户 X，N 个帖子等。

在@fthiella 的帮助下，我使用的查询是：

```
SELECT
    DATE_FORMAT(FROM_UNIXTIME(`date`), '%Y-%m') as YearMonth, username, COUNT(*) as Posts
FROM
  media
WHERE username = 'foobar'
GROUP BY 1
ORDER BY 1 DESC 
```

感谢上帝，它足够快，现在我会尝试优化以防它不使用索引，但现在几乎 1M 的记录做得很好。干杯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T12:23:16.107

```
SELECT
    DATE_FORMAT(FROM_UNIXTIME(`date`), '%Y-%m') as YearMonth,
    username,
    COUNT(*) as Posts
FROM
  media
GROUP BY
    DATE_FORMAT(FROM_UNIXTIME(`date`), '%Y-%m') as YearMonth,
    username 
```

# php - PHP/MySQL 使用带 LIMIT 的 ORDER BY

> ID：14707275
> 
> 赞同：3
> 
> 时间：2013-02-05T12:12:16.773
> 
> 标签：php, mysql, pagination

我大致按照这个链接创建了一个分页：

[http://www.awcore.com/dev/1/3/Create-Awesome-PHPMYSQL-Pagination_en#toggle](http://www.awcore.com/dev/1/3/Create-Awesome-PHPMYSQL-Pagination_en#toggle)

很酷。虽然我的查询有问题。

它像这样工作正常：

```
require 'includes/function.php';

    $page = (int) (!isset($_GET["page"]) ? 1 : $_GET["page"]);
    $limit = 8;
    $startpoint = ($page * $limit) - $limit;

    $statement = "cars WHERE deleted = 'no'";

$query = mysql_query("SELECT * FROM {$statement} LIMIT {$startpoint}, {$limit} ");

while ($row = mysql_fetch_assoc($query)) { 
```

但是，当我尝试向其中添加 ORDER BY 时，如下所示：

需要'includes/function.php'；

```
 $page = (int) (!isset($_GET["page"]) ? 1 : $_GET["page"]);
    $limit = 8;
    $startpoint = ($page * $limit) - $limit;

    $statement = "cars WHERE deleted = 'no'";

$query = mysql_query("SELECT * FROM {$statement} LIMIT {$startpoint}, {$limit} ORDER BY model DESC");

while ($row = mysql_fetch_assoc($query)) { 
```

或者只是像这样更改语句：

```
$statement = "rcr_cars WHERE deleted = 'no' ORDER BY model DESC"; 
```

我收到此错误：

```
Warning: mysql_fetch_assoc() expects parameter 1 to be resource, boolean given in filepath/myfile.php on line 79. 
```

第 79 行是这一行：

```
 while ($row = mysql_fetch_assoc($query)) { 
```

谁能告诉我我如何没有正确使用 ORDER BY，这让我很困惑。：/

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T12:19:33.077

尝试如下查询

```
$query = mysql_query("SELECT * FROM {$statement} ORDER BY model DESC LIMIT {$startpoint}, {$limit} "); 
```

你出错的地方是 LIMIT 应该在 ORDER BY 之后。[阅读更多](https://stackoverflow.com/questions/4708708/mysql-order-by-limit)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T12:16:38.973

更改查询：

```
$query = mysql_query("SELECT * FROM {$statement} ORDER BY model DESC LIMIT {$startpoint}, {$limit}") ; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T12:27:03.307

```
$query = mysql_query("SELECT * FROM {$statement} ORDER BY model DESC LIMIT {$startpoint}, {$limit} "); 
```

# ruby-on-rails - 从路由定义中删除 Id

> ID：14707277
> 
> 赞同：0
> 
> 时间：2013-02-05T12:12:20.803
> 
> 标签：ruby-on-rails

这是我的路线：

```
PUT    /welcome/:id(.:format)      welcome#update 
```

我想从路由定义中删除 :id 。

换句话说，我想在不发送 id 的情况下使用更新功能。

所以在我的 routes.rb 中，我试图定义：

```
resources :welcome
match '/welcome/:id' => 'welcome#update', :via => :put 
```

然后我跑了`rake routes`，但什么也没发生。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T12:14:56.830

`put '/welcome' => 'welcome#update'`之前使用`resources :welcome`所以它优先

更新：格式化

```
put '/welcome' => 'welcome#update'
resources :welcome 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T12:25:39.660

您真的要使用 put 请求吗？我认为您应该使用自定义操作来处理此问题。但是如果你想覆盖默认路由，你可以这样做

```
match 'welcome/' => 'welcome#update', :via => 'put'
resources :welcome, :except => [:update] 
```

# java - NoClassDefFoundError：无法初始化类 org.apache.axis2.description.AxisService

> ID：14707286
> 
> 赞同：1
> 
> 时间：2013-02-05T12:12:31.723
> 
> 标签：java, web-services, axis2, axis, axis2c

在运行应用程序时，我收到以下错误。

`java.lang.NoClassDefFoundError: Could not initialize class org.apache.axis2.description.AxisService`

AxisService 类在`axis2-kernel-1.6.2.jar`文件中。这个 jar 中的一些类运行良好，没有任何问题，但是一些类在运行时从这个 jar 文件中抛出 NoClassDefFoundError。`AxisService` 类存在于 中`axis2-kernel-1.6.2.jar`，即使它会引发错误。

这在本地机器上运行良好。但是进入 Oracle r12 服务器时出错。我已经为 jar 文件设置了类路径。

**我使用的 Java 版本是 1.6 和 Apache axis2.1.6.2。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-13T08:10:41.450

有同样的问题。我只包含了编译应用程序所需的 jar。当我包含 \axis2-1.6.2\lib\ 文件夹中的所有内容时，这个异常就消失了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-22T09:04:41.253

我在使用 Tomcat 和 Axis2 时遇到了类似的问题，一周后发现错误，我意识到存在轴配置问题。特别是我的应用程序无法实例化加入持久层的类。我包括这个参数行：

```
<parameter name="ServiceTCCL">composite</parameter> 
```

在axis2用来工作的services.xml文件中。

有关更多信息，请参阅[http://wso2.com/node/1131中的评论](http://wso2.com/node/1131)

# gwt - 为什么 GWT 不支持所有 java 类或方法？

> ID：14707287
> 
> 赞同：1
> 
> 时间：2013-02-05T12:12:36.790
> 
> 标签：gwt

从下面的链接中，我了解到 GWT 仅支持客户端以下包中的类或方法的子集。

```
java.lang
java.lang.annotation
java.util
java.io
java.sql 
```

[https://developers.google.com/web-toolkit/doc/1.6/RefJreEmulation#Package_java_lang](https://developers.google.com/web-toolkit/doc/1.6/RefJreEmulation#Package_java_lang)

为什么会这样？我认为这在开发中会带来更多问题，因为我只使用 GWT 客户端并使用 REST Web 服务而不是服务器。

是否有任何新版本的 jar，如[gwtx](http://code.google.com/p/gwtx/)（支持持久性、注释等的新版本）用于使用上述包中的所有类和方法。我的主要疑问是为什么他们不支持所有人？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-05T12:29:56.257

为了支持将 Java 转换为 JavaScript，必须**模拟每个***标准类*，即以 GWT 编译器知道如何将其转换为 JavaScript 的方式重新创建。例如基于 JavaScript ，方法必须在 JavaScript 之上模拟，等等。**`ArrayList``Array``String``String`**

 **而且有些东西是根本无法模拟的（文件、套接字）。其他一些东西不是有意模拟的，因为模拟版本虽然在技术上是可行的，但性能要比浏览器 API 的更直接映射低得多，而且 GWT 力求性能（第三方库，例如 GWTx，如果需要，可以提供这样的模拟）而不是*兼容性*（选择 Java 作为语言主要是为了利用工具，而不是提供*兼容层*来允许重用现有库）。

最后，不支持反射，因为它会使编译器无法修剪死代码并进行所有优化：它如何知道反射而不是直接调用实际上没有使用特定的类、字段或方法？**

# c# - 在哪里存储我的 SPItemEventReceivers 的全局设置？

> ID：14707288
> 
> 赞同：0
> 
> 时间：2013-02-05T12:12:38.927
> 
> 标签：c#, sharepoint

我有一个 SPItemEventReceiver，它除了使用 POST 请求通知给定 IP 和端口上的另一个 HTTP 服务器关于事件之外什么都不做。

HTTP 服务器与 sharepoint 在同一台计算机上运行，​​因此我过去常常在 localhost 和固定端口号上发送通知。但是由于可以在 serverfarm 中的其他服务器中调用 eventreceiver，因此 localhost:PORT 将不可用。

因此，每次我的 HTTP 服务器启动时，它都需要将其 IP 地址和端口保存在 SharePoint 中所有 EventReceiver 都可以访问的某个位置，无论它们在哪个服务器上被调用。

存储此类全球可用信息的好地方是什么？

我坚持了下来`SPWebService.ContentService.Properties`，但我不确定这是否是个好主意。你怎么看？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T12:56:34.030

好吧，如果您使用的是 Sharepoint 2010，我会考虑将这些值存储在属性包中。使用客户端对象模型甚至 Javascript/ECMAScript 客户端对象模型。这些代码可能对您有所帮助。

```
using (var context = new ClientContext("http://localhost"))
{
  var allProperties = context.Web.AllProperties;
  allProperties["testing"] = "Hello there";
  context.Web.Update();
  context.ExecuteQuery();
} 
```

或使用 javascript：

```
 function getWebProperty() {
        var ctx = new SP.ClientContext.get_current();
        var web = ctx.get_site().get_rootweb();
        this.props =  web.get_allProperties();
        this.props.set_item(“aProperty”, “aValue”);
        ctx.load(web);

        ctx.executeQueryAsync(Function.createDelegate(this, gotProperty), Function.createDelegate(this, failedGettingProperty));
    }

    function gotProperty() {
        alert(this.props.get_item(“aProperty”));
    }

    function failedGettingProperty() {
        alert("failed");
    } 
```

资料来源： [https ://sharepoint.stackexchange.com/questions/49299/sharepoint-2010-net-client-object-model-add-item-to-web-property-bag](https://sharepoint.stackexchange.com/questions/49299/sharepoint-2010-net-client-object-model-add-item-to-web-property-bag)

[https://www.nothingbutsharepoint.com/sites/devwiki/articles/Pages/Making-use-of-the-Property-Bag-in-the-ECMAScript-Client-Object-Model.aspx](https://www.nothingbutsharepoint.com/sites/devwiki/articles/Pages/Making-use-of-the-Property-Bag-in-the-ECMAScript-Client-Object-Model.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T16:41:43.437

实际上有几种方法可以在 SharePoint 中保存配置值：

*   SharePoint 对象`SPWebApplication, SPFarm,`SPSite、SPWeb、SPList、SPListItem的属性包
*   SharePoint 中的“配置”列表 - 只是您可能设置为的常规列表`Hidden = TRUE`
*   web.config 文件 - 特别是`<AppSettings>`

Wictor Wilen 实际上解释了[在 SharePoint 中存储设置的 6 种方法](http://www.wictorwilen.se/Post/Six-ways-to-store-settings-in-SharePoint.aspx)。

当您谈论试图将其设置保存在某处的外部进程时，通常我会推荐 web.config，但 web.config 中的每次更改都会导致`IISRESET`它不是一个好的选择。我强烈建议`SPWebApplication.Properties`在您最喜欢的网站中使用财产包（例如包）或隐藏列表。您可以像这样设置属性包：

```
SPWebApplication webApplication = ...
object customObject = ...
// set value in hashtable
webApp.Add("MySetting", customObject);
// persist the hashtable
webApp.Update(); 
```

看看这有什么好？您实际上可以在 Web 应用程序中存储一个对象，该对象可以包含多个设置，只要您保持对象可序列化。

# maven - maven-invoker 不会根据依赖调用安装

> ID：14707291
> 
> 赞同：0
> 
> 时间：2013-02-05T12:12:49.740
> 
> 标签：maven, build, maven-3, maven-release-plugin

我的 Maven 构建过程中有问题。有一个使用 maven-invoker-plugin 执行不同任务的 pom 文件：

```
<execution>
<id>createWebstartApps</id>

<phase>process-resources</phase>
<goals>
<goal>run</goal>
</goals>
<configuration>
<projectsDirectory>.</projectsDirectory>
<streamLogs>true</streamLogs>
<pomIncludes>
    <pomInclude>pom1.xml</pomInclude>
</pomIncludes>
.... 
```

但是当我使用 maven 发布插件“mvn release:prepare”时，安装目标不会在子 pom 依赖项上执行。例如 pom1.xml 具有以下依赖项：

```
<dependency>
<groupId>com.qnamic.dis</groupId>
<artifactId>DisAdminToolWithPlugins</artifactId>
<version>${project.parent.version}</version>
<type>pom</type>
<scope>runtime</scope>
..... 
```

但是这个依赖项（在这种情况下是 pom 文件）不会安装在我的本地 maven repo 中，因此找不到：

```
 [INFO] [INFO] Building: pomWebstartDisAdminTool.xml
[INFO] [INFO] [INFO] Scanning for projects...
[INFO] [INFO] [INFO]
[INFO] [INFO] [INFO] ------------------------------------------------------------------------
[INFO] [INFO] [INFO] Building RailOpt DIS Admin Tool 4.9.12
[INFO] [INFO] [INFO] ------------------------------------------------------------------------
[INFO] [INFO] [WARNING] The POM for com.qnamic.dis:DisAdminToolWithPlugins:pom:4.9.12 is missing, no dependency information available
[INFO] [INFO] [INFO] ------------------------------------------------------------------------
[INFO] [INFO] [INFO] BUILD FAILURE
[INFO] [INFO] [INFO] ------------------------------------------------------------------------
[INFO] [INFO] [INFO] Total time: 0.203s
[INFO] [INFO] [INFO] Finished at: Tue Feb 05 13:00:04 CET 2013
[INFO] [INFO] [INFO] Final Memory: 4M/15M
[INFO] [INFO] [INFO] ------------------------------------------------------------------------
[INFO] [INFO] [ERROR] Failed to execute goal on project DisAdminToolWebstart: Could not resolve dependencies for project com.qnamic.dis:DisAdminToolWebstart:pom:4.9.12: Failure to find com.qnamic.dis:DisAdminToolWithPlugins:pom:4.9.12 in http://maven.ad.bls.ch/content/groups/public/ was cached in the local repository, resolution will not be reattempted until the update interval of bls-public has elapsed or updates are forced -> [Help 1] 
```

有任何想法吗？

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:02:01.253

尝试在运行前添加安装。例如。

```
<execution>
  <id>createWebstartApps</id>
  <phase>process-resources</phase>
  <goals>
    <goal>install</goal>
    <goal>run</goal>
  </goals>
... 
```

更多信息： http: [//maven.apache.org/plugins/maven-invoker-plugin/install-mojo.html](http://maven.apache.org/plugins/maven-invoker-plugin/install-mojo.html) & [http://maven.apache.org/plugins/maven-invoker-plugin/usage.html](http://maven.apache.org/plugins/maven-invoker-plugin/usage.html)

HTH，杰米

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-08-13T15:27:14.223

在 pom.xml 旁边添加文件 invoker.properties 并将您的目标放入其中，例如：

```
invoker.goals = clean install 
```

# media-queries - CSS 媒体查询（移动设备、平板电脑和屏幕）

> ID：14707292
> 
> 赞同：3
> 
> 时间：2013-02-05T12:12:55.133
> 
> 标签：media-queries

我正在努力成为一名**响应式开发人员**（而不是固定的开发人员）。最近我一直在尝试理解媒体查询并且有些困惑。测试很简单：

我想将手机的主体背景颜色更改为红色，平板电脑为黄色，宽屏为绿色。以下代码演示了这一点（大部分情况下）。我遇到的问题是当宽度低于 480 像素（30 em）时，背景会恢复为默认值`css`（背景变成红色到白色）。现在..，我的小脑袋告诉我“哦，我会做一个

```
 @media only screen and (min-width:1em) { body { background:red;} } 
```

......这将解决问题！”

然而，这似乎是错误和不直观的。有谁知道完成这个简单任务的正确方法？

```
/*
==========================================================================
 MOBILE (min-width 480px)
========================================================================== */
   @media only screen and (min-width: 30em) {

    body { background:red; font-size:.75em; }

}

/* 
==========================================================================
 TABLETS (min-width 768px)
========================================================================== */
@media only screen and (min-width: 48em) {

body { background:yellow;  font-size:.85em; }

}

/* 
==========================================================================
 SCREENS (min-width 1140px)
========================================================================== */
@media only screen and (min-width: 71.25em) {

body { background:green;  font-size:1em; }

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T12:16:44.263

如果我是你，我会将整个 CSS 还原为`max-width`. 比如`max-width: XX`智能手机，`max-width: YY`平板电脑，或者屏幕。所以，它会变成这样：

```
body { background:green;  font-size:1em; }  

@media only screen and (max-width: 71.25em) {
  body { background:yellow;  font-size:.85em; }
}

@media only screen and (max-width: 48em) {
  body { background:red; font-size:.75em; }
} 
```

# c# - 获取提供给泛型方法的泛型参数类型和值

> ID：14707298
> 
> 赞同：10
> 
> 时间：2013-02-05T12:13:17.793
> 
> 标签：c#, .net, reflection

你如何获得提供给封闭/构造的泛型方法的参数值？

我已经有一段时间没有接触反射了。这一切过去都在我的背后，嗯，无论如何。

```
class Program
{
    static void Main(string[] args)
    {
        new ConcreteFoo().GenericMethod<int>(5);
        Console.ReadKey();
    }
}

class ConcreteFoo
{
    public void GenericMethod<Q>(Q q) 
    {
        var method = MethodInfo.GetCurrentMethod();    
        var parameters = method.GetParameters();    
        if (parameters.Length > 0)
            foreach (var p in parameters)
                Console.WriteLine("Type: {0}", p.ParameterType);

        // That still prints Q as the type. 
        // I've tried GetGenericArguments as well. No luck.                
        // I want to know:
        // 1) The closed type, i.e. the actual generic argument supplied by the caller; and
        // 2) The value of that argument
    }

    public void GenericMethodWithNoGenericParameters<Q>() 
    { 
        // Same here
    }
}

class GenericFoo<T>
{
    public void NonGenericMethod(T t) { /* And here*/ }  
    public void GenericMethod<Q>(Q q) { /* And here */ }
} 
```

**更新**

这个问题很荒谬，因此被提问者关闭。他希望保留它只是为了向他的孩子们展示爸爸是多么愚蠢，如果他们最终成为 C# 程序员的话。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-23T23:27:09.287

简短的回答是 typeof(Q)。

长答案（试图解释为什么你不能枚举这些类型，你必须专门写它们）是这样的：

每个泛型方法（比它声明的类更通用）对于它的所有（曾经）接触的具体化具有相应的、不同的 MethodInfo 实例，并且对于“模板”/打开方法具有另一个 MethodInfo。

你可以用它来获得你想要的：

```
class ConcreteFoo {    
   public void GenericMethod<Q>(Q q) {
     var method = MethodInfo.GetCurrentMethod();
     var closedMethod = method.MakeGenericMethod(typeof(Q));

     // etc
   }
} 
```

这是为什么 ？这是因为反射中没有一个“枚举操作”返回引用封闭细节的 MethodInfo 实例。

如果您像这样枚举 ConcreteFoo 声明的静态方法：

```
var atTime1 = typeof(ConcreteFoo).GetMethods(BindingFlags.Public | BindingFlags.Static | BindingFlags.DeclaredOnly);

ConcreteFoo.GenericMethod( true );

var atTime2 = typeof(ConcreteFoo).GetMethods(BindingFlags.Public | BindingFlags.Static | BindingFlags.DeclaredOnly); 
```

你会得到相同的结果。就 GenericMethod 及其随从的细节而言，您将仅获得与 GenericMethod 关联的反射对象（开放变体）。

atTime2 不会包含额外的 MethodInfo 引用新 jitted 的 GenericMethod<bool>。

但这并不是一件坏事，现在是吗？GetMethods() 应该返回一致的结果，并且其结果不会随时间变化。当涉及到“导航”操作时，泛型方法的代数实际上非常好：

1.  所有打开的 MethodInfos 都有 IsGenericMethod = true 和 IsGenericMethodDefinition = true
2.  所有关闭的 MethodInfos 都有 IsGenericMethod = true 和 IsGenericMethodDefinition = false
3.  通过在一个封闭的 MethodInfo 上调用 .GetGenericMethodDefinition() 你得到一个开放的
4.  通过在打开的 MethodInfo 上调用 .MakeGenericType(params Type[] types) ，您可以获得所需的任何已关闭的类型（在语法上不知道这些类型是什么，并且有可能因不遵守 where 子句而收到异常）

从当前线程的角度来看（而不是从程序集和类型的角度）的反射操作也是如此：

```
MethodBase MethodInfo.GetCurrentMethod() 
```

和

```
StackTrace trace = new StackTrace();
IEnumerable<MethodBase> methods = from frame in trace.GetFrames()
                                  select frame.GetMethod(); 
```

永远不要返回实际位于顶部或整个当前调用堆栈中的通用方法（如果有）的实际封闭变体。

在某种程度上，您的问题并不荒谬，因为在**GetCurrentMethod**的情况下， 您可以轻松地将其替换为**GetCurrentMethod**加上**MakeGenericMethod**加上语法上可用的**typeof(Whatever)**，但您不能对调用者这么说。

所以.. 对于非泛型方法，您始终可以查看您的堆栈并准确知道这些方法的参数类型是什么。相互调用并最终调用你的方法......但是对于通用方法（它们确实是真正封闭的，因为我再说一遍，认为运行和调用另一个并被其他人调用的通用方法是不合逻辑的（等等）是一个开放的）你无法找出参数的类型，就像你无法学习任何此类方法的局部变量的值一样（这是确定性的，但如果让它成为一个巨大的性能缺陷）可能性）。

# javascript - Javascript 数组 indexOf 返回未定义

> ID：14707302
> 
> 赞同：3
> 
> 时间：2013-02-05T12:13:25.110
> 
> 标签：javascript, arrays, undefined, indexof

调用我的函数`checkIss()`时，`issFullArray.indexOf(issToCheck)`总是返回`undefined`。我已经运行了`.length`，输出了 的内容`issFullArray`，但我不知道为什么它不起作用 - 数组对我来说看起来不错。正如您在下面看到的，我尝试显式设置`issArray`为数组并复制我返回的数组`getIssList()`

```
function updateIss() {
    var issArray = [];

    var currService = current.u_business_service;
    var currIss = current.u_is_service;
    issArray = getIssList(currService).slice(); //getIssList() returns an arry
    if (checkIss(issArray, currIss) === false) {
        //do stuff
    }
}

function checkIss(issFullArray, issToCheck) {
    if (issFullArray.indexOf(issToCheck) < 0) {
        return false;
    } else {
        return true;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T12:30:08.380

最简单的方法是遍历数组并比较每个值，如果匹配则返回 true，否则返回 false。代码不多，适用于所有浏览器。

```
function checkIss(issFullArray, issToCheck) {
    for(i=0; i<issFullArray.length; i++) {
        if(issFullArray[i]==issToCheck) {
            return true;
        }
    }
    return false;
} 
```

# bash - 如何在单个 ssh 命令中使用 bash $(awk)？

> ID：14707307
> 
> 赞同：23
> 
> 时间：2013-02-05T12:13:38.057
> 
> 标签：bash, ssh, awk

我正在尝试执行一个`ssh`包含“子代码”或 $(sub-code) 的命令（我一直使用它，但我不知道它的正式名称）要先执行，但是在目标服务器。

为了论证，假设这是我要使用的命令。当然，这可以通过 来完成`hostname`，但这只是一个简化的示例，其中包含我想要使用的所有格式化向导。

```
echo `uname -a | awk '{print $2}'` 
```

没问题。但是你如何正确地逃避这个以`ssh`在一个命令中发送它呢？以下是错误的，因为它让服务器回复您的本地主机名。子代码在本地执行：

```
ssh myServer echo `uname -a | awk '{print $2}'` 
```

但是想到的任何逃避主义都行不通：

```
$ ssh myServer echo \`uname -a | awk '{print $2}'\`
awk: cmd. line:1: {print $2}`
awk: cmd. line:1:           ^ invalid char '`' in expression
$ ssh myServer echo \$(uname -a | awk '{print $2}')
bash: syntax error near unexpected token `('
$ ssh myServer echo \$\(uname -a | awk '{print $2}')
bash: syntax error near unexpected token `)'
$ ssh myServer echo \$\(uname -a | awk '{print $2}'\)
awk: cmd. line:1: {print $2})
awk: cmd. line:1:           ^ syntax error
bash: -c: line 0: unexpected EOF while looking for matching `)'
bash: -c: line 1: syntax error: unexpected end of file 
```

我想要一个包括使用正确转义`` or $() because I'd like to know if it's possible.`的 echo 的答案可能会更复杂。

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2013-02-05T13:05:50.283

试试这个

```
ssh myServer "uname -a | awk '{print \$2}' " 
```

使用双引号`"`对您将远程执行的命令进行分组。

您还需要对`$`参数中的进行转义`$2`，这样它就不会在本地计算，而是传递给`awk`远程。

编辑：

如果要包含`$(` `)`，则必须再次转义该`$`符号，如下所示：

```
ssh myServer "echo \$(uname -a | awk '{print \$2}') " 
```

您还可以转义*反引号*`，如下所示：

```
ssh myServer "echo \`uname -a | awk '{print \$2}'\` " 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2018-06-14T08:33:12.990

最好使用**heredoc**以`ssh`避免在更复杂的命令中到处转义引号：

```
ssh -T myServer <<-'EOF'
uname -a | awk '{print $2}'
exit
EOF 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-02-05T12:28:18.680

管道输出命令并在本地运行 awk 怎么样？

```
ssh yourhost uname -a | awk '{ print $2 } ' 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-02-05T12:33:00.070

解决方法是使用命令创建一个 sh 文件，然后将其传递给 ssh 命令：

**测试.sh**

```
echo `uname -a | awk '{print $2}'` 
```

和命令：

```
ssh myServer 'bash -s' < test.sh 
```

**更新**：

不带引号的命令也可以正常工作：

```
ssh myServer uname -a | awk '{print $2}' 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2019-10-04T13:10:24.907

## 只是一些额外的说明：

### 就我而言，逃逸`$`无济于事：

```
ts1350:> ssh sysadm@node "grep feature features.txt| awk '{print $6}' "
Password: 
A  feature   -name  ue_trace_mme    | off
ts1350:> ssh sysadm@node "grep feature features.txt| awk '{print \$6}' "
Password: 
awk: cmd. line:1: {print \}
awk: cmd. line:1:        ^ backslash not last character on line
awk: cmd. line:1: {print \}
awk: cmd. line:1:        ^ syntax error
ts1350:> ssh sysadm@node "grep feature features.txt| awk '{print \\$6}' "
Password: 
awk: cmd. line:1: {print \\}
awk: cmd. line:1:        ^ backslash not last character on line
awk: cmd. line:1: {print \\}
awk: cmd. line:1:        ^ syntax error 
```

### 虽然添加一个`space`介于`$`和数字的作品：

```
Fri Oct  4 14:49:28 CEST 2019
ts1350:> ssh sysadm@node "grep feature features.txt| awk '{print $ 6}' "
Password: 
off 
```

希望这种第二种方式可以帮助像我这样的人。

感谢@dave 在他的回答中：[如何在远程 ssh 会话中使用 awk 打印特定列？](https://unix.stackexchange.com/a/294820)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-05-14T20:27:59.033

如果您尝试获取主机名，请使用：

`ssh myServer "uname -n"`

# php - 我想将搜索后找到的推文存储在文本文件中

> ID：14707309
> 
> 赞同：0
> 
> 时间：2013-02-05T12:13:53.800
> 
> 标签：php, html, twitter, store

有谁知道在 .txt 文件中搜索后如何保存推文？我的索引文件如下：

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
     <html xmlns="http://www.w3.org/1999/xhtml">
     <head>
     <title>Twitter</title>
     </head>
     <body>
  <?php
     require('twitter.class.php');
     $twitter = new twitter_class();
     echo $twitter->getTweets('tomato', 15);
   ?>
   </body>
   </html> 
```

我对这一切都很陌生，所以我会很感激任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T12:16:19.273

[fwrite()](http://php.net/manual/en/function.fwrite.php)是你的朋友。在循环中，您回显推文而不是回显它，将它们写入文本文件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T12:16:59.400

你试过这个功能`file_punt_contents`吗？

你可以这样做：

```
<?php
    $file = 'tweets.txt';

    $tweets = $twitter->getTweets('tomato', 15);

    // Write the contents back to the file
    file_put_contents($file, $tweets);
?> 
```

[更多信息。](http://php.net/manual/en/function.file-put-contents.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T12:18:25.287

您可以在 php usine 中创建文件并写入`fwrite`，这是一个简单的代码：

```
 $fp = fopen('data.txt', 'w');
    fwrite($fp, $twitter->getTweets('tomato', 15););
    fclose($fp); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T12:19:24.513

这是保存推文的代码：

```
<?php
    require('twitter.class.php');
    $twitter = new twitter_class();
    $tweets = $twitter->getTweets('tomato', 15);
    $currentfile = file_get_contents('tweets.txt');
    file_put_contents('tweets.txt', $currentfile.$tweets);
?> 
```

如果您不想附加推文，这将附加推文而不是删除数据，只需执行以下操作：

```
<?php
    require('twitter.class.php');
    $twitter = new twitter_class();
    $tweets = $twitter->getTweets('tomato', 15);
    file_put_contents('tweets.txt', $tweets);
?> 
```

# javascript - 即使 beforeSelectRow 返回 false，jqgrid 复选框也可选择

> ID：14707310
> 
> 赞同：3
> 
> 时间：2013-02-05T12:13:57.913
> 
> 标签：javascript, jquery, jqgrid

在启用了多选的 jqgrid 中，即使 beforeSelectRow 返回 false，复选框仍然可以选中。这是一个错误吗？如果是，是否有解决方法。

```
$("#grid").jqGrid({
    beforeSelectRow: function(rowid, e) {
        return false;
    } 
```

这里的用例：http : [//jsfiddle.net/erduT/1/](http://jsfiddle.net/erduT/1/) [http://jsfiddle.net/erduT/2/](http://jsfiddle.net/erduT/2/)

请指教。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T14:21:55.360

这不完全是一个错误，在这种情况下 beforeSelectRow 是禁用对**row**的选择，而不是对复选框的选择。这在您的小提琴中很明显，因为该行本身不会保持突出显示。因此，在您的 beforeSelectRow 函数中，您将不得不自己禁用任何其他 UI 元素。

前任。

```
beforeSelectRow: function(rowid, e) {
    $('#jqg_grid_' + rowid).attr("disabled", "disabled");
    return false;
}, 
```

要使用全选/无复选框，您可以使用**onSelectAll**事件。

> 参数：aRowids，状态
> 
> 当多选选项为真并且您单击标题复选框时会触发此事件。
> 
> **aRowids** - 所选行的数组（rowid's）。
> 
> **status** - 确定标题状态的布尔变量复选框 - 如果选中，则为 true，如果未选中，则为 false。
> 
> *请注意，选中或取消选中标题复选框时，aRowids 始终包含 id。*

前任。

```
onSelectAll: function(aRowids,status) {
     if (status) {
          $.each(aRowids, function(i, rowid) {
               $('#jqg_grid_' + rowid).attr("disabled", "disabled");
          });
     }
}, 
```

# jquery - 从 jQuery 获取 url 参数函数中理解正则表达式

> ID：14707311
> 
> 赞同：0
> 
> 时间：2013-02-05T12:14:08.250
> 
> 标签：jquery, regex

我在堆栈溢出中搜索了一个 Javascript 解决方案（在 jQuery 库中）以获取 URL 参数。

我有这个功能可以顺利完成：

```
// get the firstname value from the myurl - http://mysite.com?firstname=dany&lastname=dughy

var myurl = $("#gup").data("url");
var name = "firstname";

function gup(name, myurl) {
    name = name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");
    var regexS = "[\\?&]"+name+"=([^&#]*)";
    var regex = new RegExp( regexS );
    var results = regex.exec(myurl);
    if( results == null )
        return "";
    else
        return results[1];
} 
```

我了解它的工作原理，您设置了一个正则表达式，然后执行该正则表达式并在数组中检索结果。

**有人可以向我解释一下正则表达式吗？我似乎无法理解。**

泰

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T13:02:58.047

Let's call the function with `gup("NAME","http://domain.com?NAME=value&name2=value2")`.

```
function gup(name, myurl) {
    name = name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]"); 
```

This line escapes square brakets so it works nicely in the regex query, making `"[]"` into `"\\\[\\\]"`.

```
 var regexS = "[\\?&]"+name+"=([^&#]*)"; 
```

Now the name is parsed to work in the regex. It will look like `"[\\?&]NAME=([^&#]*)"`.

`"[\\?&]"` means find either `?` or `&`. Because `?` is a special character, to match a `?` in text you need to escape it like `\?`, so this regex would become `[\?&]` but in javascript strings you need to escape the `\` again. So `[\?&]` becomes `"[\\?&]"` in a string.

`=([^&#]*)` matches a literal `=` followed by any character except an `&` or `#`.

```
 var regex = new RegExp( regexS );
    var results = regex.exec(myurl);
    if( results == null )
        return "";
    else
        return results[1]; 
```

Returns the captured group, which is at position 1\. Position 0 is the whole match.

```
} 
```

Function call returns `value`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T12:36:44.333

假设您正在搜索名字，那么正则表达式变为：`[\\?&]firstname=([^&#]*)`。现在，它的意思是：`[\\?&]`搜索任何 characters `\`，`?`或者`&`之后有的`firstname=`，and `[^&#]*`= 除了`&`or`#`之后的任何字符

# javascript - 最新敲除和 jquery ui 对话框出错：在初始化之前无法调用

> ID：14707312
> 
> 赞同：1
> 
> 时间：2013-02-05T12:14:14.407
> 
> 标签：javascript, jquery, jquery-ui, knockout.js, knockout-2.0

我尝试使用淘汰赛 2.2 自定义绑定新 jquery 1.9 和 jquery ui 1.9.2。代码来自这里：[将 jquery ui 对话框与 knockoutjs 集成](https://stackoverflow.com/questions/8611327/integrating-jquery-ui-dialog-with-knockoutjs) 使用更新的库：http: [//jsfiddle.net/SnPdE/323/](http://jsfiddle.net/SnPdE/323/)

```
ko.bindingHandlers.dialog = {
        init: function(element, valueAccessor, allBindingsAccessor) {
            var options = ko.utils.unwrapObservable(valueAccessor()) || {};
            //do in a setTimeout, so the applyBindings doesn't bind twice from element being copied and moved to bottom
            setTimeout(function() { 
                options.close = function() {
                    allBindingsAccessor().dialogVisible(false);                        
                };

                $(element).dialog(options);          
            }, 0);

            //handle disposal (not strictly necessary in this scenario)
             ko.utils.domNodeDisposal.addDisposeCallback(element, function() {
                 $(element).dialog("destroy");
             });   
        },
        update: function(element, valueAccessor, allBindingsAccessor) {
             var shouldBeOpen = ko.utils.unwrapObservable(allBindingsAccessor().dialogVisible);
             $(element).dialog(shouldBeOpen ? "open" : "close");

        }
};

var viewModel = {
    label: ko.observable('dialog test'),
    isOpen: ko.observable(false),
    open: function() {
       this.isOpen(true);   
    },
    close: function() {
       this.isOpen(false);   
    }
};

ko.applyBindings(viewModel); 
```

问题是错误：错误：在初始化之前无法调用对话框上的方法；试图调用方法“关闭”

如果我删除 setTimeout - applyBindings 两次应用于对话框。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T12:49:15.220

在调用之前检查对话框是否已初始化`open`将修复它。

```
if ($(element).data('dialog')) {
    $(element).dialog(shouldBeOpen ? "open" : "close");
} 
```

`update`根本不需要初始值，因为如果`autoOpen`是`true`默认值，则在初始化期间将打开对话框。

**编辑：**
为了正确，`dialogVisible`最初`false`应该进行更改以设置`autoOpen`选项。

```
...
options.autoOpen = ko.utils.unwrapObservable(allBindingsAccessor().dialogVisible);
$(element).dialog(options); 
```

# javascript - 将复选框标签设置为右侧或固定位置

> ID：14707313
> 
> 赞同：10
> 
> 时间：2013-02-05T12:14:14.340
> 
> 标签：javascript, jquery, html, jquery-mobile

这是标准复选框的代码：

```
<fieldset data-role="controlgroup">
        <legend>Agree to the terms:</legend>
        <input type="checkbox" name="checkbox-1" id="checkbox-1" class="custom" />
        <label for="checkbox-1">I agree</label> 
</fieldset> 
```

如何将复选框的标签（文本）设置到右侧或固定的“px”位置？

像`align-right`或`right: 50px`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-05T12:21:12.683

只需在所需标签中添加样式

```
<label for="checkbox-1" style="float:right">I agree</label> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T12:21:28.797

为标签添加一个`classname`或 ID，如下所示：

```
<label for="checkbox-1" class="chkbox">I agree</label> 
```

然后为类添加css规则，

```
 .chkbox {
   padding-left: 10px;
   font-weight: bold;
 } 
```

您可以为标签提供填充、边框或任何您喜欢的样式。

演示：[演示小提琴](http://jsfiddle.net/Sriganesh/DxY9x/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-12-05T22:01:22.540

如果您在 html 文件中有此控件

```
<label for="2">Laparoscopic surgery</label>
<input type="checkbox" name="question" value="14" class="clickable" id="2"  /> 
```

在 css 中这样做就足够了：

```
.clickable{
    float: left;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T12:28:06.010

固定输入字段和标签的宽度并浮动它们。

例如：

```
input {
   width: 200px;
   float:left;
}

label {
   width:300px;
   float:left;
} 
```

然后清理你的花车。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-05T12:17:57.700

使用 jQuery

```
$(function(){ 
 $('label[for="checkbox-1"]').css({right: 50});
}); 
```

**或者**

```
$('label[for="checkbox-1"]').css({'margin-left': 50}); 
```

[在这里摆弄](http://jsfiddle.net/XXjga/1/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-11-29T15:52:59.923

将复选框浮动到右侧，将标签浮动到左侧，并将标签位置设置为绝对。

```
 <input type="checkbox" name="question" value="14" class="clickable" id="2"  
    style="float: left;"/>
    <label for="2" style="float: right; position: absolute;">Laparoscopic 
    surgery</label> 
```

如果只是将标签文本放在没有标签的框的右侧，则不会导致单击时选中复选框。

# git - 使用 vim 作为 git difftool

> ID：14707314
> 
> 赞同：6
> 
> 时间：2013-02-05T12:14:15.250
> 
> 标签：git, vim, diff, vimdiff

我在 .gitconfig 中将 Vim 配置为 git difftool

```
[diff]
    tool = vimdiff 
```

如果 N 个文件有变化，我必须关闭 vim (:qa) 才能看到下一个差异。

如何在不退出 vim 的情况下导航到下一个/上一个差异？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-13T10:08:41.293

没有办法告诉 vimdiff 转到下一个文件，因为`git difftool`为每个 diff 文件调用 vimdiff。

因此，当您以 结束 vimdiff 时`qa`，`git diff`使用下一个文件再次执行 vimdiff。从 vimdiff 的角度来看，没有下一个 diff 文件。

您可以抑制启动 vimdiff 的提示，这样可以减少烦人的情况：

`git config --global difftool.prompt false`

但是，正如您已经发现的那样，vim 插件[vim-fugitive](https://github.com/tpope/vim-fugitive)是要走的路。这个出色的插件提供了用于区分和合并的各种命令。

# java - 这个数组有什么问题

> ID：14707315
> 
> 赞同：0
> 
> 时间：2013-02-05T12:14:16.183
> 
> 标签：java, arrays

```
//Prime Number Calculator

import java.util.Scanner;

class PrimeNumbers {
    public static void main(String[] args){
        int End;
        int Begin;  

        Scanner in = new Scanner(System.in);

        //insert max value for the calculator.
        System.out.println("Where should I stop?");
        End = in.nextInt();

        for (Begin=3; Begin<=End; Begin++){
            System.out.println(Begin);
            int Prime;
            int PrimeList[] ;

            //something is wrong around here... I don't understand what...

            for (Prime:PrimeList); 
                PrimeList[0]=2;
            if(Begin%PrimeList[Prime]!=0){
                break;
            }
        }
    }    
} 
```

我知道那里有很多素数计算器，但在学校我想做一个但我不知道我哪里出错了。

错误信息：

```
Exception in thread "main" java.lang.Error: Unresolved compilation problems: 
Syntax error on token "Prime", Identifier expected after this token
Prime cannot be resolved to a type
Type mismatch: cannot convert from element type int to Prime

at PrimeNumbers.main(PrimeNumbers.java:25) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T12:34:30.583

好的，所以你的代码有几个问题（好的，可能更多），我将在这里列出：

**问题1：**

先说第一件事。始终遵循 Java 命名约定。你的变量名和方法名应该以小写字母开头。所以：

```
int End;   // Should be `int end;`
int Begin; // Should be `int begin;` 
```

**问题2：**

您刚刚声明了您的数组引用，并没有对其进行初始化。下面的语句只是声明了一个 int 类型的数组引用：

```
int PrimeList[] ; 
```

您需要创建一个数组对象，并将引用分配给它：

```
int PrimeList[] = new int[size]; 
```

**问题3：**

这个问题是**问题 2**的延伸。请注意，您正在循环的每次迭代中初始化一个新数组。所以，你所有的素数都不会在同一个地方累积。相反，您`array`将在每次迭代后清除。您应该从循环内部删除该数组声明。

现在，与其在循环外添加*数组声明*，我建议您改用 an `ArrayList`，它是一个动态递增的数组。因此，您不必提供初始大小。

*因此，您可以在外* `for`循环之外添加以下声明：

```
List<Integer> primeList = new ArrayList<Integer>(); 
```

**问题4：**

让我们继续您的*内部* `for`循环：

```
for (Prime:PrimeList); 
    PrimeList[0]=2;
    if(Begin % PrimeList[Prime] != 0){
        break;
    }
} 
```

现在，忘记那个循环有什么问题，因为根本不需要那个循环。你还没有初始化你的`list`. 因此，迭代它是没有意义的。您宁愿需要使用指定范围之间的素数对其进行初始化。

因此，您应该测试您正在测试的当前数字，而不是使用 for 循环来迭代*数组/列表，无论它是否是素数。*如果它是素数，请将其添加到列表中。要测试素数，您需要为每个数字循环。我建议以单独的方法移动该逻辑。要检查一个数字是否为素数，您需要继续将它除以从`2`到的数字`num / 2`。一旦你看到`modulus = 0`，`return false`否则`return true`： -

```
public boolean isPrime(int num) {
    for (int i = 2; i <= num / 2; i++) {
        if (num % i == 0) return false;
    }
    return true;
} 
```

现在，让我们回到原来的方法。看看你的外循环：

```
for (begin=3; begin <= end; begin++) {
    /** For each number, check whether it's prime or not **/
    if (isPrime(begin)) {
        /** Is Prime, add it to list **/
        primeList.add(begin);
    }
} 
```

就是这样。现在，我建议您逐步完成答案，并单独解决每个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T12:29:37.533

正如其他人所说，您尚未初始化您的`PrimeList`数组。

* * *

关于代码的其他建议。

1.  您应该对您正在接受的输入进行验证。检查相同的[异常处理](http://docs.oracle.com/javase/tutorial/essential/exceptions/)。例如，如果用户没有在您预期的地方输入数字，那么您的代码将中断。

2.  变量名不是java-bean 规范格式，即第一个字母应该是小写字母，然后应该遵循*camelCase*表示法，即变量名中每个下一个单词的首字母大写。

3.  该算法似乎完全错误。PrimeList 不会在任何地方填充，除非您在单独的代码中生成它们并且没有将其集成到上面给定的代码中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T12:31:11.073

您的 for 循环中有语法错误。它应该是

```
for (int prime: primeList) { 
```

短 for 循环需要迭代中使用的变量类型

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-05T12:17:48.510

在 java 中，[数组](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/arrays.html)是对象，应该使用`new`.

```
int[] PrimeList = new int[10]; 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-02-05T12:17:59.113

你必须初始化你的数组，例如：

```
int PrimeList[] = new int[3] 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-02-05T12:21:59.957

我认为你还没有初始化你的变量`int Prime;`和`int PrimeList[];`

将它们初始化为

```
int Prime = 0;
int PrimeList[] = new PrimeList[10]; 
```

# java - 将 POST 数据从 JSP 页面发送到远程 PHP 服务器（并获得答案）

> ID：14707317
> 
> 赞同：0
> 
> 时间：2013-02-05T12:14:19.940
> 
> 标签：java, php, jsp, httpurlconnection

我正在尝试将一些数据从 JSP 页面发送到 PHP 页面（它应该执行一些代码并返回成功消息）。我正在使用这个 java 函数进行一些测试：

```
public String excutePost(String targetURL, String urlParameters)
{
URL url;
HttpURLConnection connection = null;  
try {
  //Create connection
  url = new URL(targetURL);
  connection = (HttpURLConnection)url.openConnection();
  connection.setRequestMethod("POST");
  connection.setRequestProperty("Content-Type", 
       "application/x-www-form-urlencoded");

  connection.setRequestProperty("Content-Length", "" + 
           Integer.toString(urlParameters.getBytes().length));
  connection.setRequestProperty("Content-Language", "en-US");  

  connection.setUseCaches (false);
  connection.setDoInput(true);
  connection.setDoOutput(true);

  //Send request
  DataOutputStream wr = new DataOutputStream (
              connection.getOutputStream ());
  wr.writeBytes (urlParameters);
  wr.flush ();
  wr.close ();

  //Get Response    
  InputStream is = connection.getInputStream();
  BufferedReader rd = new BufferedReader(new InputStreamReader(is));
  String line;
  StringBuffer response = new StringBuffer(); 
  while((line = rd.readLine()) != null) {
    response.append(line);
    response.append('\r');
  }
  rd.close();
  return response.toString();

} catch (Exception e) {

  e.printStackTrace();
  return null;

} finally {

  if(connection != null) {
    connection.disconnect(); 
  }
}
}

String urlParameters =
         "var=" + URLEncoder.encode("varcontent", "UTF-8");
   out.println(excutePost("remoteurl",urlParameters)); 
```

现在，如果我运行该页面，我会得到响应“null”，并且 php 页面中的任何代码都不会被执行。难道我做错了什么？如何允许 php 页面运行其中的代码？`echo $_POST['var']`将数据发送回jsp页面还不够简单吗？

编辑：我试图通过在文件中写入发布的变量来查看 php 页面是否正在接收某些内容。但是里面什么也没写。

```
$file = 'debug.txt';
echo file_put_contents($file, $_POST['var']); 
```

这是我得到的例外..

```
java.net.SocketException: Connection reset 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T12:28:12.230

不，一个`echo`是不够的。输入`$_POST['var']`一个文本文件并提供更新的文本文件（每次需要跟踪时编辑文本文件`$_POST['var']`）。或者，您可以将其放入某个数据库并检查更改。

# ruby - 使用正则表达式拆分复杂字符串

> ID：14707324
> 
> 赞同：0
> 
> 时间：2013-02-05T12:14:44.717
> 
> 标签：ruby, regex

我有一个字符串：

```
(3592, -1, 7, N'SUNWopensp-root', N'1.5,REV=10.0.3.2004.12.15.14.19', N'Sun Microsystems, Inc.', N'The OpenJade Group''s SGML and XML parsing tools - platfowrm independent files, / filesystem', N'SunPackage', abc, 83) 
```

我需要用逗号分隔它，但不是 N' ... ' 子字符串中的那些。

我设法`N' ... '`用这个提取了字符串的所有内容：

```
N\'(.*?)(?:\',|\)|\'\)) 
```

但这不会拆分逗号`"3592, -1, 7"`等，而我不能单独拆分逗号，因为这会`N' ... '`用逗号分解字符串。最终目标是让所有字段以逗号分隔，`N' ... '`字符串中的字段除外（即`N'.. , ..'`也应该是一个完整的字段）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T13:27:14.850

由于这接近 CSV 格式，因此这是解析它的一种方法。

```
#remove parens and N's
csv = str.gsub(/^\(|\)$/, "").gsub(/, N/, ",")

CSV.parse_line(csv, {:quote_char => "'"}) 
```

输出：

```
[
 "3592",
 " -1",
 " 7",
 "SUNWopensp-root",
 "1.5,REV=10.0.3.2004.12.15.14.19",
 "Sun Microsystems, Inc.",
 "The OpenJade Group's SGML and XML parsing tools - platfowrm independent files,
 / filesystem",
 "SunPackage",
 " abc",
 " 83"
] 
```

注意：这是正确处理双撇号的唯一解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T12:43:26.877

```
given_string.scan(/(?:(?:N'.*?')|[^,])+/) 
```

给出：

```
[
  "(3592",
  " -1",
  " 7",
  " N'SUNWopensp-root'",
  " N'1.5,REV=10.0.3.2004.12.15.14.19'",
  " N'Sun Microsystems, Inc.'",
  " N'The OpenJade Group''s SGML and XML parsing tools - platfowrm independent files",
  " / filesystem'",
  " N'SunPackage'",
  " abc",
  " 83)"
] 
```

这看起来不寻常，因为它包含空格和括号，并且单词中的`'`字符用作 field 的分隔符`N'...'`，但由于这是问题中提到的，这就是我给出的。如果这不是您想要的，请归咎于问题的草率。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T12:43:05.693

您已经提取了 N' 个字段，现在您可以将它们 gsub 变成类似于 X 的东西，用逗号分隔它们并将 X 替换为您的 N' 个字段。这不是解决方案，但有效。

# javascript - Javascript documentwrite函数转义

> ID：14707332
> 
> 赞同：0
> 
> 时间：2013-02-05T12:15:13.097
> 
> 标签：javascript, escaping, javascript-framework

有这样的行并且onLoad函数参数报告错误：

```
document.write("document.getElementById(\"my_iframe\").innerHTML = '<iframe src=\"http://MyDomain.com/index.php?accessing_from=\'+loc+\'\" style=\"border: none; min-height: 60px;\" onload=\"resizeCrossDomainIframe(\'iframe\', \'http://MyDomain.com\');\"> </iframe>'  "); 
```

困扰我的部分是`onload=\"resizeCrossDomainIframe(\'iframe\', \'http://MyDomain.com\');\"`

我在此设置中遇到错误，但是当我删除函数参数并将其保留为`resizeCrossDomainIframe()` 一切正常时（就文档编写而言，但函数无法正常工作，因为它没有传递参数），所以我的问题是为什么这在参数时不起作用逃脱了吗？

----------------------已编辑 ----------

好的，在 MyDomain.com 我有文件 create_iframe.js ：

```
document.write("<script type=\"text/javascript\"> function resizeCrossDomainIframe(id, other_domain) { var iframe = document.getElementById(id);  window.addEventListener('message', function(event) {if (event.data === \"reload\") top.location.reload(); if (event.origin !== other_domain) return;  if (isNaN(event.data)) return;  var height = parseInt(event.data) + 40; iframe.height = height + \"px\"; }, false); }</script> ");
document.write("<div id=\"wwiz_rooster\"></div>");
document.write("<script type=\"text/javascript\">");
document.write("var loc = window.location.host; ");
document.write("loc = \"http://\"+loc;");
document.write("alert(loc);");
document.write("document.getElementById(\"wwiz_rooster\").innerHTML = '<iframe src=\"MyDomain.com/index.php?accessing_from=\'+loc+\'\" style=\"border: none; margin-top: 15px; margin-bottom: 15px; width:986px; min-height: 60px;\" onload=\"resizeCrossDomainIframe(\\'rooster_iframe\\', \\'http://MyDomain.com\\');\"> </iframe>'  ");
document.write("</script>"); 
```

编辑：愚蠢的我....忘记将实际 ID 分配给 IFRAME !!!!! 安威 - 一切正常！并感谢您的帮助！！！！！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T13:40:03.390

您有太多嵌套字符串文字，其引号未正确转义。看着它成长：

```
resizeCrossDomainIframe('iframe', 'http://MyDomain.com'); 
```

```
<iframe src="http://MyDomain.com/index.php?…"
  style="border: none; min-height: 60px;"
  onload="resizeCrossDomainIframe('iframe', 'http://MyDomain.com');"
></iframe> 
```

```
document.getElementById("my_iframe").innerHTML =
'<iframe src="http://MyDomain.com/index.php?accessing_from='+loc+'" \
  style="border: none; min-height: 60px;" \
  onload="resizeCrossDomainIframe(\'iframe\', \'http://MyDomain.com\');" \
></iframe>' 
```

```
"document.getElementById(\"my_iframe\").innerHTML = \
  '<iframe src=\"http://MyDomain.com/index.php?accessing_from=\'+loc+\'\" \
    style=\"border: none; min-height: 60px;\" \
    onload=\"resizeCrossDomainIframe(\\'iframe\\', \\'http://MyDomain.com\\');\" \
  ></iframe>' \
" 
```

您忘记在上一次迭代中将反斜杠加倍。您已经很幸运可以将撇号与双引号混合使用，否则它将成为一场噩梦，以至于您从愚蠢中醒来：

```
"document.getElementById(\"my_iframe\").innerHTML = \
  \"<iframe src=\\\"http://MyDomain.com/index.php?accessing_from=\"+loc+\"\\\" \
    style=\\\"border: none; min-height: 60px;\\\" \
    onload=\\\"resizeCrossDomainIframe(&quot;iframe&quot;, &quot;http://MyDomain.com&quot;); \\\" \
  ></iframe>\" " 
```

顺便说一句，第三次迭代在我看来是错误的。为什么要在文档中编写纯 JS？如果你想输出它，最好把它放在`<pre>`标签里，但不要用 JavaScript 写。如果你想执行它（除非你`document.write("<script>")`在它前面放一个，否则你不会执行它），只需执行它 - 永远不要将代码作为字符串处理！

* * *

关于您发布在当前站点上创建 iframe 的脚本的目标，该脚本应仅包含以下内容：

```
var loc = …;
document.write('<iframe src="http://MyDomain.com/index.php?accessing_from='+loc+'" \
  style="border: none; min-height: 60px;" \
  onload="resizeCrossDomainIframe(\'iframe\', \'http://MyDomain.com\');" \
></iframe>'); 
```

尝试将其包含到测试页面中。

# breeze - 财产文件

> ID：14707338
> 
> 赞同：0
> 
> 时间：2013-02-05T12:15:37.287
> 
> 标签：breeze

微风中是否有任何 entity.property 文档“字段”？例如，EntityFramework 中的 entity.property 上有两个文档属性：Long Description 和 Summary。我可以在客户端的元数据中看到这两个属性，但我想知道是否在微风中使用了这些属性。分析微风.debug.js 我没有注意到这些或类似属性的任何用法，但也许有人知道如何使用它们（从元数据中提取）并将它们附加到例如实体实例。或者也许有人有一些类似的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T17:27:09.173

这是一个好主意！。请将此添加到微风[用户语音](https://breezejs.uservoice.com/)中。我们非常重视这些建议。希望我们还可以获得一些描述如何拦截元数据检索过程的文档，以便您可以添加自己的逻辑来执行此操作。

作为权宜之计，**MetadataStore.fetchMetadata**方法当前**确实**返回（在它的 promise 'then' 方法中）从服务器检索到的原始“元数据”。所以现在，您可以探测它并挑选出这些属性并将它们直接附加到每个相应的微风数据属性。

请注意，当 fetchMetadata 方法返回时，整个 MetadataStore 将已经填充了 entityTypes、dataProperties、navigationProperties 等。这使得任务更加容易。

# java - 强制派生实现做某事，最佳实践是什么？

> ID：14707339
> 
> 赞同：0
> 
> 时间：2013-02-05T12:15:45.177
> 
> 标签：java, oop, design-patterns

我什至不确定这个问题是否有答案\合适的设计，但值得一问......我有一个抽象类（servlet），它使用（以及其他）processResults方法（抽象）从一些客户那里获取数据，并且onResultsReceived（非抽象）

```
public abstract class dataServlet implements HttpServlets {
      protected onDataReceived(){//blah blah}
      public abstract void processData();
} 
```

我的 onDataReceived 方法我正在做一些常见的事情，这些事情对于 processData 方法的所有实现都是必需的。如果明天有人会添加新的 dataServlet 实现，我想确保他会在他的 processData 实现中调用 onDataReceived。有什么方法，已知的设计可以这样做吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-05T12:16:41.813

听起来您应该考虑[*模板方法模式*](http://en.wikipedia.org/wiki/Template_pattern)，因为它强制执行特定的顺序，而不需要派生类的作者调用东西。

模式是：

```
abstract class Base {
    public doActivity() {
        doCommonStuff();
        doSpecificStuff();
        doOtherCommonStuff();
        doOtherSpecificStuff();
    }

    protected abstract void doSpecificStuff();
    protected abstract void doOtherSpecificStuff();

    private final void doCommonStuff() { ... }
    private final void doOtherCommonStuff() { ... }
} 
```

# boost - 使用boost asio将UDP数据包多播到系统中的多个接口（多个网络适配器）

> ID：14707340
> 
> 赞同：1
> 
> 时间：2013-02-05T12:15:46.383
> 
> 标签：boost, boost-asio, multicast

我想使用 boost asio(udp) 将数据多播到系统中存在的所有网卡。谁能帮助我理解如何做到这一点。我创建了以下示例，但它不起作用。发送到每个套接字的流数据正在混合，输出是单个接口上所有套接字数据的混合。

//例如假设发送到Interface1的数据是“Abcd”（注意：每个接口都有一个单独的socket）

发送到 Interface2 的数据是“xyz”

然后仅从 Interface1 接收输出，输出流是混合的（例如“abxycdz”或“abxcdzy”等）

请帮助我理解这个问题。

```
for(int i=0;i<NoOfInterfcaes;i++)
{
   Open("229.1.1.1",1000,sNetInterfcaeAddList[i],false);

}

....................................

for(int i=0;i<NoOfInterfcaes;i++)
{
   send(dataBuffer,len);

}

....................................

void Open(std::string &multicastIp,int nPort, std::string& sNetInterfcaeIpAdd,bool broadcast)
{

   m_sNetInterfcaeIpAdd=sNetInterfcaeIpAdd;
   m_sMulticastIp=multicastIp;
   m_nport = nPort;
   m_broadcast = broadcast ;
   // try and open socket
   const ip::udp::resolver::query queryIF( ip::udp::v4(),multicastIp.c_str(), nPort ); 
   ///resolve the connection
   m_resolver.async_resolve(queryIF,
                            boost::bind(&handle_resolve, this,
                                         boost::asio::placeholders::error,
                                         boost::asio::placeholders::iterator));

}
void handle_resolve(const boost::system::error_code& err,
                                       boost::asio::ip::udp::resolver::iterator endpoint_iterator)
{
   if (!err)
   {
      //make a connection
      m_socket.async_connect(*endpoint_iterator,
                              boost::bind(&handle_connect, this,
                                          boost::asio::placeholders::error, endpoint_iterator));
   }
   else
   {
      //error message
   }
}
void handle_connect(const boost::system::error_code& error,
                                       boost::asio::ip::udp::resolver::iterator endpoint_iterator)
{
   if (!error)
   {

      //Select the network adaptor
      m_socket.set_option( boost::asio::ip::multicast::outbound_interface( boost::asio::ip::address_v4::from_string(m_sNetInterfcaeIpAdd)));
      m_socket.set_option( boost::asio::ip::multicast::enable_loopback(false));
      if(m_broadcast)
      {
         boost::asio::socket_base::broadcast option(true);
         m_socket.set_option(option);
      }
   }
   else if (endpoint_iterator != boost::asio::ip::udp::resolver::iterator())
   {
      // The connection failed. Try the next endpoint in the list.
      m_socket.close();
      //try to connect
      m_socket.async_connect(*endpoint_iterator,
                              boost::bind(&handle_connect, this,
                                          boost::asio::placeholders::error, endpoint_iterator));
   }
   else
   {
      //
   }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:26:44.537

每个适配器使用一个套接字，使用以下问题中的代码将每个套接字绑定到其适配器：[Boost asio socket multicast to a specific ethernet interface](https://stackoverflow.com/questions/8593859/boost-asio-socket-multicast-to-a-specific-ethernet-interface/8604115#8604115)

# macos - 具有自定义 NSMenu/MenuItems 和拖放功能的 Mac OSX NSStatusItem

> ID：14707342
> 
> 赞同：3
> 
> 时间：2013-02-05T12:16:00.180
> 
> 标签：macos, drag-and-drop, nsmenuitem, nsmenu, nsstatusitem

我正在尝试创建一个在状态栏中具有 NSStatusItem 图标的 Mac 应用程序。状态栏图标应支持文件拖放，并且在单击时还必须显示菜单。

问题是我已经设法分别实现这两个功能并且很难将它们合并在一起。

我能够使用此链接创建状态栏应用程序：

[http://cocoatutorial.grapewave.com/2010/01/creating-a-status-bar-application/](http://cocoatutorial.grapewave.com/2010/01/creating-a-status-bar-application/)

然后我能够使用以下链接在状态栏图标上实现拖放功能

[使用 NSStatusItem 拖放](https://stackoverflow.com/questions/5663887/drag-and-drop-with-nsstatusitem/6493240#6493240)

我面临的问题如下，为了进行拖放，我必须创建另一个视图，然后将该视图分配给 NSStatusItem ，如下所示：

```
NSStatusItem *statusItem = [[NSStatusBar systemStatusBar] statusItemWithLength:NSVariableStatusItemLength];

ViewWithDragFunctionality* viewWithDrag = [[ViewWithDragFunctionality alloc] initWithFrame:NSMakeRect(0, 0, 24, 24)];
[statusItem.view addSubview:viewWithDrag]; 
```

由于这只是一个视图，显然它不会像 NSStatusItem 的默认视图那样运行，也不支持鼠标交互或其他任何东西。我设法通过将以下函数添加到 ViewWithDragFunctionality.m 找到解决方法

```
- (void)mouseDown:(NSEvent *)theEvent {
    NSLog(@"Status Bar Icon Clicked");
} 
```

每当单击状态栏图标并且还检测到文件拖放时，都会调用该函数。

**但是**现在我一直在弄清楚如何在单击状态栏图标时显示菜单。

任何帮助都感激不尽。我正在为此制定解决方案，如果我先找到一些东西，我会在这里发布:)

问候

舒迈斯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-27T11:53:28.443

经过多天的尝试和尝试，寻找合适的教程，又摸不着头脑，我终于偶然发现了一个在 github 上慷慨地为公众托管的 imgur 应用程序代码库。

The code was hosted at gihthub by a user called [ZBUC](https://github.com/zbuc).

The code that helped me out is at the following repository location on github : [https://github.com/zbuc/imgurBar](https://github.com/zbuc/imgurBar)

This is exactly what was needed, after studying how he/they did things in there and combining what I learned/found with the links mentioned in the question, I was able to create a Custom status menu item for my application, was able to get a proper menu to drop down as is the case with a default status menu item and was also able to add drag and drop functionality to my applications status menu item.

So now I have a Custom Status Menu for my application which works like a normal status menu and also supports drag and drop functionality.

I hope that the links in the question, along with the repository link posted above, are of help to everyone who needs what I did.

Thank You

Shumais

# c# - 将文本框写入 TextFile C#

> ID：14707343
> 
> 赞同：0
> 
> 时间：2013-02-05T12:16:02.007
> 
> 标签：c#, winforms

我正在尝试通过 TextBoxes 将信息写入 TextFile（在这种情况下，TextFile 类似于数据库）。当我`File.AppendAllText`在表单中使用它时它正在工作，但我试图通过方法来实现它。

我创建了一个名为`AddClient()`

```
Client getClient = new Client();
public void AddClient()
{
    string client = getClient.FirstName + "," + getClient.LastName + "\r\n";
    File.AppendAllText(textFilePath, client);
} 
```

并且表单中的注册按钮被调用`RegisterButton`并包含：

```
ClientRepository getMethods = new ClientRepository();
Client getClient = new Client();
private void RegisterButton_Click(object sender, EventArgs e)
{
    getClient.FirstName = FirstNameTextBox.Text;
    getClient.LastName = LastNameTextBox.Text;
    getMethods.AddClient();
} 
```

FirstName 和 LastName ofc 是`public class Client`

单击按钮后，它们都获得空值。请帮忙 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T12:28:46.207

您不会将具有正确设置 firstName 和 lastName 从输入文本框的 Client 类的实例传递给 AddClient 方法，而是在 ClientRepository 类中创建一个新的 Client 类实例，当然，这个新的实例的属性中没有任何内容。

更改您的代码以传递在您的表单中创建的客户端实例

在 ClientRepository 类中

```
public void AddClient(Client clientToAdd)
{
    string client = clientToAdd.FirstName + "," + clientToAdd.LastName + "\r\n";
    File.AppendAllText(textFilePath, client);
} 
```

在您的表单代码中

```
ClientRepository getMethods = new ClientRepository();
Client clientToAdd = new Client();
....
private void RegisterButton_Click(object sender, EventArgs e)
{
    clientToAdd.FirstName = FirstNameTextBox.Text;
    clientToAdd.LastName = LastNameTextBox.Text;
    getMethods.AddClient(clientToAdd);
} 
```

# oauth-2.0 - OAuth2：查询字符串与片段

> ID：14707345
> 
> 赞同：19
> 
> 时间：2013-02-05T12:16:13.757
> 
> 标签：oauth-2.0, query-string, fragment

刚刚注意到，在 OAuth2 中，当请求的授权类型为：“code”时，回调将其包含在查询字符串参数中（在“？”之后）。但是，当授权是“令牌”时，它作为片段传递（在“#”之后）。

这看起来是规范的一部分（[https://datatracker.ietf.org/doc/html/draft-ietf-oauth-v2-26#section-4.2](https://datatracker.ietf.org/doc/html/draft-ietf-oauth-v2-26#section-4.2)）

这种决定背后的理由是什么？

谢谢，彼得

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-05T22:54:41.010

当您的浏览器被网站重定向到带有查询参数的 URL 时，查询字符串也是您的浏览器现在发送到主机的请求的一部分。片段仅由您的 Web 浏览器在本地评估，不包含在对主机的请求中。

在**授权代码授予**的情况下，您通常有一个直接与提供者对话的 Web 应用程序，将数据发送到主机正是您所需要的：

*   Web 应用程序将您的浏览器重定向到您登录的提供商。
*   提供者现在告诉您的浏览器 Web 应用程序的回调 URL 并附加一个*授权代码*。此代码必须发送到 Web 应用程序，因此它作为查询参数包含在对回调 URL 的请求中。
*   现在，Web 应用程序本身在后台与提供者对话，并使用*授权代码*验证他确实被允许向提供者查询*访问令牌*。

在**隐式授权**的情况下，您通常会在浏览器中直接运行一些 Javascript 应用程序。无需向主机传递任何*授权码*，在大多数情况下也无需向主机发送*访问令牌*，因为浏览器中的 JS 可以直接与提供者对话。这样，您可以例如在服务器上创建一个网站，该网站使用从另一个提供商查询的信息，并征得用户同意，其中服务器*永远不会*访问用户的任何机密数据。（如果是受信任的网站，则不会将*访问令牌*发送到服务器。）

# ios - 使用 NSLayoutConstraints 移动 UIView 所需的建议

> ID：14707348
> 
> 赞同：0
> 
> 时间：2013-02-05T12:16:27.620
> 
> 标签：ios, objective-c, nslayoutconstraint

从下面的图片中，当用户点击 view1 时，我让 view2 和 view3 向下滑动到页脚，通过将 view3 的约束常量与页脚设置为 0（ish）来有效地拉动。我的 xib 设置了约束，如第一张图片所示。其中最重要的 2 个 [对我来说现在] 是 view1View2 约束和 view3Footer 约束

![带有约束和视图的 xib](../Images/22b693bcb39652cea4c4fbdcf4b57eb4.png)

为了实现向下滑动，我最终为 view1view2 约束设置了低优先级，为 view3Footer 约束设置了更高的优先级，然后在 animateWithDuration 中更新 view3Footer 约束常量

![成功滑下](../Images/d1463d482b1d519c43cbeec7048f8ba0.png)

我的问题是让 view2 和 view3 向后滑动，如果我使用相同的方法，我可以通过将 view1view2 约束常量设置为 2 来实现。

我相信上面上滑的问题是 view3Footer 约束比 view1View2 约束具有更高的优先级，优先级似乎只是只读的，所以我不能专门更改这些。我知道在设置约束时我只要求视图定位。

...我相信我可能完全使用了错误的方法...

我是否以正确的方式解决这个问题？我是否必须获取约束对象 IBOutlet 并重写它们？如果是这样，我会重写优先级吗？我是否应该将 >= 用于具有相同优先级的常量，这似乎不起作用。下面是我的简单动画代码，虽然不多，但除了手势识别器之外，设置主要在 xib

很感谢任何形式的帮助。谢谢，史蒂夫

对于向下滑动：

```
[UIView animateWithDuration:0.9 animations:^{
                        _view3FooterConstraint.constant=2;
                        [self.view layoutIfNeeded];
                        } completion:^(BOOL finished){}]; 
```

UPDATE 也试过这个设置优先级相等——不能再实现向下滑动

```
_view3FooterConstraint.constant=2;
[self.view setNeedsUpdateConstraints];
[UIView animateWithDuration:0.9 animations:^{                            
                        [self.view layoutIfNeeded];
                        } completion:^(BOOL finished){}]; 
```

对于上滑：

```
[UIView animateWithDuration:0.9 animations:^{
    _view1View2Constraint.constant=2;
    [self.view layoutIfNeeded];
} completion:^(BOOL finished){}]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T07:24:26.920

我想我会通过添加和删除更改的 2 个约束来做到这一点（2 的顶部约束为 1，3 的底部约束为页脚）。确保所有视图都有明确的高度，并使 IBOutlets 符合我上面提到的 2 个约束。您实际上一次只需要其中一个，但您需要在 IB 中添加这两个，以便您可以为它们创建出口。在 viewDidLoad 中，我立即删除了底部的那个。这应该适用于纵向和横向。我使用的代码是：

```
implementation ViewController {
   IBOutlet NSLayoutConstraint *conBottom;
   IBOutlet NSLayoutConstraint *conTop;
    int pos;
}

-(void)viewDidLoad{
    [super viewDidLoad];
    pos = 0;
    [self.view removeConstraint:conBottom];
    [self.view layoutSubviews];
}

-(IBAction)togglePosition:(id)sender { //tap recognizer on view one action method
    if (pos == 0) {
        [self moveDown];
    }else{
        [self moveUp];
    }
}

-(void)moveDown {
    [self.view removeConstraint:conTop];
    [self.view addConstraint:conBottom];
    conBottom.constant=2;
    [UIView animateWithDuration:0.9 animations:^{
        [self.view layoutIfNeeded];
    } completion:^(BOOL finished) {
        pos = 1;
    }];
}

-(void)moveUp {
    [self.view removeConstraint:conBottom];
    [self.view addConstraint:conTop];
    conTop.constant=2;
    [UIView animateWithDuration:0.9 animations:^{
        [self.view layoutIfNeeded];
    }completion:^(BOOL finished) {
        pos = 0;
    }];
} 
```

# c# - Ninject 工厂扩展内存泄漏？

> ID：14707351
> 
> 赞同：1
> 
> 时间：2013-02-05T12:16:38.807
> 
> 标签：c#, .net, ninject, ninject-extensions

我使用以下接口作为`ToFactory()`绑定：

```
public interface ISamplerFactory
{
    ISampler Create(Action<EventHandler<ValueChangedEventArgs>> register, Action<EventHandler<ValueChangedEventArgs>> unregister, Func<decimal?> valueGetter);
} 
```

当我绑定时，`ToFactory()`我可以成功地创建类，但随后会出现内存泄漏，其中 register、unregister 和 valueGetter 参数由`ConstructorArgument`内部 Ninject 保存，它引用了委托中的目标/参数对象。这可以防止目标对象被 GC。如果这有所作为，我也在使用 ContextPreservation 扩展。（请参阅下面的完整示例代码）

当我删除“ToFactory()”绑定并创建一个标准工厂类时，它就可以工作了。

```
public class SamplerFactory : ISamplerFactory
{
    private readonly IDistributionResolver _resolverFactory;

    public SamplerFactory(IDistributionResolverFactory resolverFactory)
    {
        _resolverFactory = resolverFactory;
    }

    ISampler Create(Action<EventHandler<ValueChangedEventArgs>> register, Action<EventHandler<ValueChangedEventArgs>> unregister, Func<decimal?> valueGetter)
    {
        return new SpecificSampler(_resolverFactory, register, unregister, valueGetter);
    }
} 
```

并且我的委托内的目标对象已成功进行 GC。

是不是我做错了什么，或者工厂扩展不是为了处理这些更复杂的参数？我假设如果我使用`.WithConstructorArgument`我会得到相同的结果。

编辑：添加了所有必要的绑定并重写了我的示例代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace ConsoleApplication
{
    using System;
    using Ninject;
    using Ninject.Extensions.ContextPreservation;
    using Ninject.Extensions.Factory;

    public class Program
    {
        static void Main(string[] args)
        {
            new Program().Run();
        }

        public void Run()
        {
            var kernel = new StandardKernel(new NinjectSettings() { LoadExtensions = false });
            kernel.Load(new FuncModule());
            kernel.Load(new ContextPreservationModule());

            kernel.Bind<IDistributionResolver>().To<DistributionResolver>(); // This is a constructor-less object.
            kernel.Bind<ISampler>().To<SpecificSampler>();
            kernel.Bind<ISamplerFactory>().ToFactory();
            kernel.Bind<IInjected>().To<Injected>();
            kernel.Bind<IDistributionResolver>().To<DistributionResolver>();
            kernel.Bind<IDistributionResolverFactory>().ToFactory();

            var s = new SomeObject();
            var weakS = new WeakReference(s);

            var factory = kernel.Get<ISamplerFactory>();

            var sampler = CreateInstance(factory, s);

            s = null;
            factory = null;
            sampler = null;

            GC.Collect();

            if (weakS.IsAlive)
                throw new Exception();
        }

        private ISampler CreateInstance(ISamplerFactory factory, SomeObject someObject)
        {
            var x = factory.Create(y => someObject.Do += y, z => someObject.Do -= z, () => someObject.Query());

            if (x == null)
                throw new Exception();

            return x;
        }

        public class SomeObject
        {
            public event EventHandler<ValueChangedEventArgs> Do;

            public decimal? Query()
            {
                return 0;
            }
        }

        public class SpecificSampler : ISampler
        {
            private readonly IDistributionResolverFactory resolver;
            private readonly Action<EventHandler<ValueChangedEventArgs>> register;
            private readonly Action<EventHandler<ValueChangedEventArgs>> unregister;
            private Func<decimal?> _valueGetter;

            public SpecificSampler(
                IDistributionResolverFactory resolver, // This is injected
                Action<EventHandler<ValueChangedEventArgs>> register, // The rest come from the factory inputs
                Action<EventHandler<ValueChangedEventArgs>> unregister,
                Func<decimal?> valueGetter)
            {
                this.resolver = resolver;
                this.register = register;
                this.unregister = unregister;
                _valueGetter = valueGetter;
                // Do Stuff;
            }
        }

        public class ValueChangedEventArgs : EventArgs
        {
        }

        public interface ISamplerFactory
        {
            ISampler Create(Action<EventHandler<ValueChangedEventArgs>> register, Action<EventHandler<ValueChangedEventArgs>> unregister, Func<decimal?> valueGetter);
        }

        public interface IDistributionResolverFactory
        {
            IDistributionResolver Create(IDictionary<string, string> picked);
        }

        public interface IDistributionResolver
        {

        }

        private class DistributionResolver : IDistributionResolver
        {
            readonly IInjected _i;
            readonly IDictionary<string, string> _picked;

            public DistributionResolver(IInjected i, IDictionary<string, string> picked)
            {
                _i = i;
                _picked = picked;
            }
        }

        public interface ISampler
        {
        }
    }

    public interface IInjected
    {
    }

    class Injected : IInjected
    {
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T12:26:03.273

我将此归结为 Ninject Core 中的内存泄漏：

[https://github.com/ninject/ninject/issues/74](https://github.com/ninject/ninject/issues/74)

# reporting-services - SQL Server Reporting Services - 抑制自由格式报告中的空行

> ID：14707352
> 
> 赞同：1
> 
> 时间：2013-02-05T12:16:41.640
> 
> 标签：reporting-services, reportingservices-2005

我有一个基于`List`SQL Server Reporting Services 中的控件的自由格式报告，基本上显示公司的地址：

```
Company Name
Address 1
Address 2
ZipCode City 
```

但是，我的一些公司记录没有该`Address2`字段的值——在这种情况下，我想完全删除`Textbox`包含不存在`Address2`数据的行（即）——所以它应该看起来像：

```
Company Name
Address 1
ZipCode City 
```

我可以很好地设置报告上的`Hidden`属性`Textbox`- 但是这只导致文本框被隐藏 - 并且一个空白行显示在`Address2`过去的位置......我想**禁止**那个空白行。***如何？！？！***

我不在 Tablix 或类似的东西中 - 它只是报告上的自由格式文本框。有没有机会让这个做我想做的事情而不需要付出巨大的努力？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-11-08T04:58:37.980

将所有字段放在一行中，并在每个字段之前检查是否需要换行。

例如：

```
[Name1]«Expr»[Name2]«Expr»[Name3]
[Street]
[City] 
```

用表达式：

```
=Iif(Fields!Name2.Value="",Nothing,vbCRLF)
=Iif(Fields!Name3.Value="",Nothing,vbCRLF) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-05T13:25:31.177

嗯，它可以完成，有点，取决于你需要什么。这是一个巨大的努力吗？由您决定：

首先，我创建了一个数据集。

```
select company = 'A'
, add1 = 'Add 1 A'
, add2 = 'Add 2 A'
, zip = '90210'
union all
select company = 'B'
, add1 = 'Add 1 B'
, add2 = null
, add3 = '12345' 
```

接下来，创建一个**List**并按*Company*对其进行分组。

![在此处输入图像描述](../Images/dd96ba669050825647987745c1825c63.png)

在此**列表中**添加一个**表**，其中包含每个字段的行。在每一行中添加一个**Rectangle**，然后添加一个带有字段详细信息的**文本框。**由于我们有一个**Table**我们可以根据表达式隐藏行，并且因为每行中有一个**Rectangle我们可以根据需要移动****Texbox**：

![在此处输入图像描述](../Images/c63a2a918b53c34b42505eb246ebd0da.png)

在第二个地址行中，根据表达式设置行可见性：

```
=IIf(IsNothing(Fields!add2.Value), true, false) 
```

最后结果：

![在此处输入图像描述](../Images/c8cd614b6ec6723293ecbaa747b8010a.png)

您可以根据需要移动字段。它并不完美而且有点繁琐，但至少这会给您带来更多的灵活性，并且可能会在它不是 100% 合适的情况下让您了解如何进行操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-30T23:13:39.250

只需将此表达式放在我的文本框中。（允许您在同一文本框中包含之前和之后的所有其他地址字段。）超级简单！

=iif(Fields!Street2.Value 什么都不是，Fields!Street1.Value, Fields!Street1.Value + vbCRLF + Fields!Street2.Value)

# javascript - Javascript 正则表达式再次多次捕获

> ID：14707360
> 
> 赞同：9
> 
> 时间：2013-02-05T12:17:00.647
> 
> 标签：javascript, regex

好的，我想我需要重新发布我最初的问题：

[Javascript 正则表达式组多个](https://stackoverflow.com/questions/14705844/javascript-regex-group-multiple/14706027#14706027)

有一个完整的例子。我有：

```
 var text = ""+ 
            "<html>                           " +
            "  <head>                         " +
            "  </head>                        " +
            "  <body>                         " +
            "    <g:alert content='alert'/>   " +
            "    <g:alert content='poop'/>    " +
            "  </body>                        " +
            "</html>";

        var regex = /<([a-zA-Z]*?):([a-zA-Z]*?)\s([\s\S]*?)>/m;
        var match = regex.exec( text );
        console.log(match) 
```

**console.log 的输出是：**

![来自 console.log 的输出](../Images/46b9b7e630defad76dc0759a7b95c91d.png)

问题是我只得到第一个的结果......而不是另一个......我能做些什么才能捕捉并遍历所有匹配的东西？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-05T12:25:09.463

`exec`一次只返回一个结果，并将指针设置为匹配的结尾。因此，如果要获取所有匹配项，请使用`while`循环：

```
while ((match = regex.exec( text )) != null)
{
    console.log(match);
} 
```

要一次性获得所有匹配项，请使用`text.match(regex)`, 其中正则表达式已`g`指定（全局标志）。该`g`标志将`match`查找字符串中正则表达式的所有匹配项，并返回数组中的所有匹配项。

[编辑] 这就是为什么我的示例设置了 ag 标志！[/eoe]

```
var text = ""+ 
           "<html>                           " +
           "  <head>                         " +
           "  </head>                        " +
           "  <body>                         " +
           "    <g:alert content='alert'/>   " +
           "    <g:alert content='poop'/>    " +
           "  </body>                        " +
           "</html>";

// Note the g flag
var regex = /<([a-zA-Z]*?):([a-zA-Z]*?)\s([\s\S]*?)>/gm;

var match = text.match( regex );
console.log(match); 
```

简单测试：

```
<button onclick="myFunction()">Try it</button>

<script>
function myFunction()
{
var text = ""+ 
           "<html>                           " +
           "  <head>                         " +
           "  </head>                        " +
           "  <body>                         " +
           "    <g:alert content='alert'/>   " +
           "    <g:alert content='poop'/>    " +
           "  </body>                        " +
           "</html>";

// Note the g flag
var regex = /<([a-zA-Z]*?):([a-zA-Z]*?)\s([\s\S]*?)>/gi;

var n = text.match( regex );
alert(n);
}
</script> 
```

完美地工作...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T13:06:02.527

这是有效的：

```
 var text = ""+
            "<html>                           " +
            "  <head>                         " +
            "  </head>                        " +
            "  <body>                         " +
            "    <g:alert content='alert'/>   " +
            "    <g:alert content='poop'/>    " +
            "  </body>                        " +
            "</html>";

        var regex = /<([a-zA-Z]*?):([a-zA-Z]*?)\s([\s\S]*?)>/g;
        var match = null;
        while ( (match = regex.exec( text )) != null  )
            console.log(match) 
```

注意**/g**这似乎是必要的

# matlab - MATLAB用另一个矩阵的值搜索矩阵的行索引

> ID：14707363
> 
> 赞同：1
> 
> 时间：2013-02-05T12:17:09.290
> 
> 标签：matlab, search, indexing, row

在 MATLAB 中，我有一个非常大的矩阵（矩阵 A）。现在我想在**第二**列中找到包含某些值的行的行索引。这些值——我在矩阵 A 中寻找——存储在另一个矩阵（矩阵 B）中，由一行（800 个数字）组成。

此外，我想为同一个矩阵 A 重做这个计算，但是对于十个不同的矩阵，具有不同的大小（其中包含我在矩阵 A 的**不同**列中寻找的值）。

由于矩阵的大小，我认为我需要一个循环来提取矩阵 A 中包含矩阵 B 的 te 值的行。我该怎么做？

问候，

五

感谢您及时的回复！确实，如果没有示例，这个问题可能有点复杂，并且确实重复的条目会导致一些问题。因此特此举个例子

例如，我有一个 -simplified- 矩阵 A：

1 2 3 4

9 9 9 9

4 3 2 1

和 - 简化矩阵（行）B：[9 3]

和一个简化矩阵（行）C：[9 2]

然后我想得到矩阵 D 和矩阵 E。这些矩阵应该在第一列中包含原始矩阵 D（或 E）中的数字，在第二列中包含矩阵 A 中该值的相应行位置。

所以，矩阵 D =

9 2

3 3

矩阵 E =

9 2

2 3

如本例所示，矩阵 B 和矩阵 C 可以包含存在于矩阵 A 的几列（如九列）中的数据。但是，矩阵 B 应该在矩阵 A 的第 2 列中“搜索”。同样，矩阵 C 应该在矩阵 A 的第 3 列中“搜索”，从而得到示例中给出的矩阵 D 和 E。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T13:53:07.560

正如 Shai 在他的评论中提到的那样，您的问题非常模糊，可能会出现很多特殊情况（重复条目、A 和 B 的相对大小等）。但总的来说，我尝试了一小段代码，似乎可以满足您的需求。当然有更快的方法可以做到这一点，当然更多关于您的问题的信息可以帮助优化这一点。

```
colA=2;
% Example
nmax=10;
nA=5;
A=randi(nmax,[nA nA]);
nB=3;
B=randi(nmax,[1 nB]);
% Find rows
rows=cell(size(B));
for i=1:numel(B)
    rows(i)={find(A(:,colA)==B(i))};
end 
```

输入/输出是：

```
A =
     3     7     8     5     4
     9     7     3     7     5
     8     2     9     9     8
     9     5     9     7     9
     3     3     4     6     8

B =
     1     7     5

rows =
     [0x1 double]    [1;2]    [4] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T13:59:11.883

假设您有两个向量`largeDataIndex`（矩阵的第二列）和`interestingIndex`（您的 b），并且您需要以下内容：

```
For each value of interestingIndex , find the position in largeDataIndex 
```

然后一个简单的方法是这样的：

```
result = zeros(size(interestingIndex))
for i = 1:length(result)
    result(i) = find(interestingIndex(i) == largeDataIndex)
end 
```

请注意，这假设始终只有一个匹配项，否则您应该将结果定义为元胞数组而不是向量。

# c# - 使用linq过滤后将列表项存储到变量中

> ID：14707365
> 
> 赞同：0
> 
> 时间：2013-02-05T12:17:14.517
> 
> 标签：c#, linq, list

我得到了一个项目列表，想要根据列不同值（即基于级别）过滤列表，并且在过滤后需要获取计数并将它们存储为 int 变量。谁能帮帮我吗。

```
**List**

   Public Class Totalitems
    {
     public string ItemName;
     public string ItemId;
     public string ItemGroup;
     public int Level;
    } 

    Id= "123asd";

    List<Totalitems> l_items = this.getslist(Id);

       /*How to filter based on distinct level */

      /*  var filteredItems = (
            from p in l_items 
           select p.Level)
            .Distinct();  */                       

    **Finally:**
        //Stores the elements contained in the List into a variable
        int totalItemsafterFiltering = l_FilteredItems.Count; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T12:18:42.667

您想`GroupBy`用于此任务：

```
var numberOfDifferentLevels = l_items.GroupBy(x => x.Level).Count(); 
```

`GroupBy`如果您想对组中的实际元素做一些事情，则特别有用。例如，您可能想知道每个级别有多少项目：

```
var itemsPerLevel = l_items.GroupBy(x => x.Level)
                           .Select(x => new { Level = x.Key,
                                              NumberOfItems = x.Count() }); 
```

当您真正只关心不同级别的数量时，另一种方法如下：

```
var numberOfDifferentLevels = l_items.Select(x => x.Level).Distinct().Count(); 
```

# php - 如何禁用特定州的免费送货？

> ID：14707366
> 
> 赞同：-1
> 
> 时间：2013-02-05T12:17:16.577
> 
> 标签：php, wordpress, woocommerce

当总金额超过 50 美元且国家/地区为美国时，我想禁用免费送货方式，但对于某些州（阿拉斯加、关岛、波多黎各、夏威夷），应禁用此送货方式。

我已经为美国设置了运费，将最低金额设置为 50 美元，但不知道如何在阿拉斯加、关岛、波多黎各、夏威夷这 4 个州禁用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T12:10:34.037

我在`wc-class-free-shipping.php`

```
function is_available($package)
{
    //added this line
    if($package['destination']['state'] == 'AK')
        return false;
} 
```

对我来说非常完美。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T12:20:23.683

在 Woocommerce 设置中的运输选项卡下，有一个名为免费送货的选项卡。选择`specific countries`，然后您可以允许您想要的国家和不允许您不想要的国家！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T14:27:55.107

```
return apply_filters( 'woocommerce_shipping_' . $this->id . '_is_available', true ); 
```

来源：[https ://github.com/woothemes/woocommerce/issues/977](https://github.com/woothemes/woocommerce/issues/977)

这应该可以帮助你。没有尝试过，因为我正在寻找同样的东西！

# ios - 应用程序进入后台模式时如何处理核心数据迁移？

> ID：14707367
> 
> 赞同：4
> 
> 时间：2013-02-05T12:17:17.397
> 
> 标签：ios, core-data, background, data-migration

我是否应该让迁移继续，如果迁移时间超过分配的时间（5 秒），然后让 iOS 终止应用程序 [这将生成崩溃日志]

或者我应该中止应用程序？[这也会生成崩溃日志]

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T12:41:21.757

也许使用[beginBackgroundTaskWithExpirationHandler:](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIApplication_Class/Reference/Reference.html#//apple_ref/occ/instm/UIApplication/beginBackgroundTaskWithExpirationHandler%3a "beginBackgroundTaskWithExpirationHandler：")要求更多时间？

# asp.net-web-api - 组织大型 Web API 解决方案

> ID：14707370
> 
> 赞同：0
> 
> 时间：2013-02-05T12:17:24.453
> 
> 标签：asp.net-web-api

再会，

我将开始为多公司组织开发 Web API 解决方案。我希望向整个组织的任何公司提供所有有用的数据。

鉴于我预计此解决方案会有很大的增长，我想确保从一开始就对其进行适当的组织。

我想按公司组织各种服务，然后再按应用程序或功能组织。

因此，关于 URL，我是否应该以如下结构为目标：

/company1/application1/serviceOperation1

或者有什么方法可以利用命名空间：

/company2.billing/serviceOperation2

是否可以在我的解决方案中为每家公司创建单独的 Web API 项目？这样做有什么价值吗？

希望我们不要太主观，但我看到的示例范围更小，我真的看到我的解决方案最终暴露了很多 Web API 服务。

谢谢，

克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T12:31:14.507

在编写一行代码之前，我将研究如何保护和部署信息、版本控制和公司文化。

所有公司和部门是否会共享相同的安全机制（协议、证书、模式等）？

`If they are shared then there is a case for keeping them in the same solution`

这些服务是否会导致不同数量的负载并部署到具有不同修补计划的多个服务器上？

`If the services are going onto different servers then they should probably be split to match`

每个服务的部署和后续版本控制计划是独立的，还是所有服务总是一起部署？

`If they are versioned independently then you would probably split the solution accordingly`

公司多久重组和保留他们的应用程序？

`If the company is constantly restructuring without you would probably want to split the services by application. If the company is somewhat stable and focused on changing the application capabilities then you would probably want to split the services by division function (accounts, legal, human resources, etc.)`

至于访问它的 URL，自然应该来自上面的答案。希望这可以帮助。

# c++ - 不使用 sleep() 发送 ZeroMQ 消息

> ID：14707373
> 
> 赞同：3
> 
> 时间：2013-02-05T12:17:40.663
> 
> 标签：c++, zeromq

我的 C 应用程序中有这个 ZeroMQ 消息发送代码

```
void *socket= zmq_socket (context, ZMQ_DEALER);
// ...
zmq_msg_t zmsg;
zmq_msg_init_size (&zmsg, msg_size);
memcpy(zmq_msg_data (&zmsg), content, msg_size);
zmq_msg_send (&zmsg, socket, 0);
zmq_msg_close(&zmsg); 
sleep (1); 
```

这实际上有效，但我不喜欢我必须调用 sleep(1) 来清除消息的事实。如果我离开它，则没有消息到达服务器。是否有任何其他可能性可以在不调用睡眠的情况下“刷新”套接字上的消息？我使用 ZeroMQ v3.2.2。

非常感谢你！

编辑：此行为似乎仅在调试模式下发生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T12:47:41.487

尝试将`ZMQ_LINGER`套接字选项设置为 0，然后在关闭 msg 后关闭套接字。

```
zmq_setsockopt(socket, ZMQ_LINGER, 0, sizeof(int));
...
zmq_close(socket); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T06:20:01.717

始终确保关闭套接字并终止上下文。 `zmq_term()`在没有未发送的消息之前不会返回。您可以在套接字上设置 LINGER 以给出在丢弃消息之前等待多长时间的上限。默认行为是永远等待。

```
void *socket= zmq_socket (context, ZMQ_DEALER);
// ...
zmq_msg_t zmsg;
zmq_msg_init_size (&zmsg, msg_size);
memcpy(zmq_msg_data (&zmsg), content, msg_size);
zmq_msg_send (&zmsg, socket, 0);
zmq_msg_close(&zmsg);
zmq_close(socket);
zmq_term(context); // this will block until the message is actually sent 
```

# php - 我尝试使用 sort() 对数组进行排序，但失败了

> ID：14707377
> 
> 赞同：2
> 
> 时间：2013-02-05T12:17:51.303
> 
> 标签：php, arrays, sorting

```
 if ( $_GET['_value'] == 'moto'  )
     {
        $array[] = array('1' => 'Yamaha');
        $array[] = array('2' => 'Suzuki');  
        $array[] = array('3' => 'Triumph');
        $array[] = array('4' => 'KTM');
        $array[] = array('5' => 'Honda');
        $array[] = array('6' => 'Harley Davidson');
        $array[] = array('7' => 'Buell');
        $array[] = array('8' => 'MV Agusta');
        $array[] = array('9' => 'Ducati');
        $array[] = array('10' => 'Other');

      } 
 $array = sort($array);
 echo json_encode( $array ); 
```

那是我拥有的代码，它被一个链接的下拉列表拉出来。我希望它返回按字母顺序排序的值，但根据您看到的代码，它返回一个空数组。我犯的错误是什么/

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T12:21:18.523

您的代码失败，因为您在这里有一个数组数组。您应该搜索“按子数组键对 php 数组进行排序”，或者您可以尝试以下操作：

```
$array[1] = 'Yamaha';
$array[2] = 'Suzuki'; 
// ...
sort($array);
echo json_encode($array); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-05T12:23:33.047

您的数组包含数组，因此无法排序，请尝试：

```
$array[1] = 'Yamaha';       

$array[2] = 'Suzuki'; 
```

然后`sort($array)`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-05T12:26:23.010

您可以使用 uasort() 函数

像：

```
function cmp($a, $b) {
    $a = reset($a);
    $b = reset($b);
    if ($a == $b) {
        return 0;
    }
    return ($a < $b) ? -1 : 1;
}

uasort($array, 'cmp') 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-05T12:36:23.363

它一点也不漂亮，但这确实有效。

除非您受到限制，否则您应该真正使用其他一些建议。

```
<?
if ( $_GET['_value'] == 'moto'  ) {
    $array[] = array('1' => 'Yamaha');
    $array[] = array('2' => 'Suzuki');  
    $array[] = array('3' => 'Triumph');
    $array[] = array('4' => 'KTM');
    $array[] = array('5' => 'Honda');
    $array[] = array('6' => 'Harley Davidson');
    $array[] = array('7' => 'Buell');
    $array[] = array('8' => 'MV Agusta');
    $array[] = array('9' => 'Ducati');
    $array[] = array('10' => 'Other');
    foreach($array as $i => $v)
    {
        $v = array_values($v);
        $sort[] = $v[0];
    }
    sort($sort);
    $c = 0;
    foreach($sort as $i => $v)
    {
        $c++;
        $sorted[] = array($c=>$v);
    }

    echo json_encode($sorted);
}
?> 
```

# jquery - Jquery根据选择的月份验证一天

> ID：14707379
> 
> 赞同：1
> 
> 时间：2013-02-05T12:17:54.853
> 
> 标签：jquery, validation, datetime

使用 jquery 验证日期的最简单方法是什么，这样用户就无法放置 2 月 31 日的示例。

代码：

```
<select name="ddd" id="ddd">
    @for (int i = 1; i <= 31; i++)
    {
            <option @(DateTime.Now.ToString("dd")==i.ToString("D2") ? "selected='selected'" : "" )>@i.ToString("D2")</option>
    }
</select>
<select name="ddmy">
    @for (int i = 0; i < 36; i++)
    {
            <option value="@DateTime.Now.AddMonths(i).ToString("MMyyyy")">@DateTime.Now.AddMonths(i).ToString("MMMM yyyy")</option>
    }
</select>
<select name="ddt">
    @for (int i = 0; i < 24; i++)
    {
        <option>@i.ToString("D2"):00</option>
}
</select> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T12:28:29.450

试试这个：http: [//jquerybyexample.blogspot.com/2011/12/validate-date-using-jquery.html](http://jquerybyexample.blogspot.com/2011/12/validate-date-using-jquery.html)

希望有帮助。

快乐的 jQuerying！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T12:35:05.723

取决于“最简单”的含义。我会尝试解析从所选值构造的日期字符串，看看它是否成功。

# c# - 如何在 C# 中将详细控制台重定向到 TextBox 而不会减慢应用程序的速度

> ID：14707386
> 
> 赞同：3
> 
> 时间：2013-02-05T12:18:03.123
> 
> 标签：c#, textbox, console

`TextBox`我正在使用以下设置将我的控制台重定向到：

```
public partial class WindowMain : Window
{
    public WindowMain()
    {
        InitializeComponent(); 
        TextWriter writer = new TextBoxStreamWriter(consoleTextBox);
        Console.SetOut(writer);
    }
} 
```

与类`TextBoxStreamWriter`：

```
public class TextBoxStreamWriter : TextWriter
{
    TextBox _output = null;

    public TextBoxStreamWriter(TextBox output)
    {
        _output = output;
    }

    public override void Write(char value)
    {
        base.Write(value);
        _output.Dispatcher.Invoke(new Action(() =>
        {
            _output.AppendText(value.ToString());
        })
        );
    }
} 
```

这是有效的。当我`Console.Write`在我的应用程序中调用时，我的 TextBox 被正确附加。问题是我不断地向控制台提供非常大的数据（通过`Process`调用启动的非常详细的批处理的输出`cmd.exe`）

```
process.OutputDataReceived += (s, e) =>
{
    if (e.Data != null)
    {
        Console.WriteLine(e.Data);
    }
}; 
```

这里的问题是这会减慢整个应用程序的速度（特别是我在馈送期间启动的线程）。我的想法是手动控制写作频率。但是我觉得这是一个普遍的问题，我不想重新发明轮子。有什么建议么 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T10:31:07.807

我最终不再使用控制台。我的应用程序确实不需要控制台。

```
process.OutputDataReceived += (s, e) =>
{
    if (e.Data != null)
    {
        consoleTextBox.AppendText(e.Data);
    }
}; 
```

我的解决方案比上面的代码更复杂，因为我使用了线程（这首先让我感到困惑，让我认为使用控制台很聪明）。

# jquery - 选择具有类的元素作为过滤器

> ID：14707392
> 
> 赞同：1
> 
> 时间：2013-02-05T12:18:25.383
> 
> 标签：jquery

我是 jQuery 的新手，对`.parents()`. 问题是当我使用 时`.parents('span[class^="lid"]')`，我的代码可以工作并且得到我想要的，即获取*元素*`class`作为过滤器。但是当我使用`.parents('span[class~="header"]')`or`.parents('span[class^="header"]')`时，我没有得到要显示的`<span>` *元素。*

下面是我的代码：[点击这里查看](http://jsbin.com/azurat/2/edit)

我肯定知道`~=`选择器检查它是否完全等于任何单词并`^=`检查值的开头是否匹配。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T12:20:16.637

jQuery 的选择与 CSS 类似，因此您可以使用点 (.)

```
$('tag.class');
$('tag#id');
... 
```

所以，在你的情况下：

```
.parents('span.header'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T12:24:53.670

它是一个“属性选择器”，而不是“类选择器”，因此它获取属性的值，该值是：

```
"lid_1 header1" 
```

它不**检查**每个类，它只是比较属性中的字符串并查看它是否以给定的字符串等开头。这就是为什么：

```
span[class*="header"] 
```

将起作用，因为字符串包含“header”，但它不以“header”开头，所以：

```
span[class^="header"] 
```

不管用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T12:25:17.430

您可以使用此代码直接使用

```
var parentEls = $("b").parents('span.lid_1').map(function() {
  return this.tagName;
}).get().join(", ");
$("b").append("<strong>" + parentEls + "</strong>"); 
```

[在http://jsbin.com/azurat/7/edit](http://jsbin.com/azurat/7/edit)上测试代码

# wpf - 绑定到 datacontext parent-WPF 的属性

> ID：14707396
> 
> 赞同：7
> 
> 时间：2013-02-05T12:18:55.030
> 
> 标签：wpf, binding, datagrid

我有一个数据网格：

```
 <DataGrid x:Name="DG" ItemsSource="{Binding}" AutoGenerateColumns="False">
     <DataGrid.Columns>
          <DataGridTextColumn Header="?" Binding="{Binding l}">
          </DataGridTextColumn>
     </DataGrid.Columns>
  </DataGrid> 
```

在 DataGrid 的 DataContext 中有 X 类的集合：

```
public ObservableCollection<xxx> col{ get; set; }// = DataContext of DG

    private string lName;

    public string LName
    {
        get { return lName; }
        set
        {
            lName= value;
            NotifyPropertyChanged("LName");
        }
    } 
```

我希望 lName 将成为 DataGrid 中特定列的标题

我尝试这种方式：

```
 <DataGridTextColumn  Binding="{Binding l}">//l=prop of xxx class that contains the collection
                                <DataGridTextColumn.HeaderTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding DataContext.LName,
                       RelativeSource={RelativeSource AncestorType=DataGrid}}"/>
                                    </DataTemplate>
                                </DataGridTextColumn.HeaderTemplate>
                            </DataGridTextColumn> 
```

**它不起作用**

怎么能做到这一点？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-05T12:37:19.640

尝试`{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Window}}, Path=DataContext.LName}`

我也不会玩名字案例。WPF 非常区分大小写。避免使用单一符号名称

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T12:25:48.003

绑定路径也区分大小写。您的 DC中没有财产`lName`。

# android - Android setOnclick 监听器到列表视图

> ID：14707398
> 
> 赞同：1
> 
> 时间：2013-02-05T12:18:59.250
> 
> 标签：android, android-layout, android-fragments, android-fragmentactivity

实际上，我有一个 viewpager，上面有一个 Imageview 和一个 listview，所以当我单击 Listview 时，我需要隐藏 listview 和底栏，以使 ImageView 全屏显示 viewpager 中的所有视图。并且单击图像视图可以取回视图。但我的问题是：

1.  我无法在 Listview 上实现 onClickListner，以使整个视图能够处理点击。被迫使用 onItemclickListner 并且它仅在您单击该项目时隐藏（这是不需要的）。
2.  当我在寻呼机内单击 Listview（位于 Fragment 内）时，它不会隐藏除当前视图之外的所有视图，但能够隐藏操作栏和底栏（在 Fragment Activity 上）。

截图供参考：

![在此处输入图像描述](../Images/6f4e62edd51e58e592b85f351d93ff43.png)

我怎样才能做到这一点，或者有没有更好的方法可以隐藏视图。

这是我在片段中的 ListView：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <ImageView
        android:id="@+id/imageView"
        android:layout_width="match_parent"
        android:layout_height="match_parent" />

    <ListView
        android:id="@+id/listView"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:background="@android:color/transparent"
        android:cacheColorHint="@android:color/transparent"
        android:divider="@android:color/transparent"
        android:listSelector="@android:color/transparent"
        android:scrollbars="none" />

</RelativeLayout> 
```

这是我的片段活动布局：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/detailLayout"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:clickable="true"
    android:orientation="vertical" >

    <android.support.v4.view.ViewPager
        android:id="@+id/pager"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_above="@+id/form" >
    </android.support.v4.view.ViewPager>

    <RelativeLayout
        android:id="@+id/form"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:orientation="horizontal"
        android:padding="2dp" >

        <EditText
            android:id="@+id/editText"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentLeft="true"
            android:layout_centerVertical="true"
            android:layout_toLeftOf="@+id/btnSend"
            android:drawableRight="@drawable/edit_keyboard"
            android:inputType="textMultiLine"
            android:maxLines="3" />

        <ImageButton
            android:id="@+id/btnSend"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentRight="true"
            android:layout_centerVertical="true"
            android:src="@drawable/send" />
    </RelativeLayout>

</RelativeLayout> 
```

使用 onitemclicklister 到 ListView 是成功的：

```
listComments.setOnItemClickListener(new OnItemClickListener() {

            @Override
            public void onItemClick(AdapterView<?> arg0, View arg1, int arg2, long arg3) {
                // TODO Auto-generated method stub

                if (getSherlockActivity().getSupportActionBar().isShowing()) {
                    getSherlockActivity().getSupportActionBar().hide();
                    listComments.setVisibility(View.GONE);
                    form.setVisibility(View.GONE);
                } else {
                    getSherlockActivity().getSupportActionBar().show();
                    listComments.setVisibility(View.VISIBLE);
                    form.setVisibility(View.VISIBLE);
                }
            }
        });

        imageView.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub
                getSherlockActivity().getSupportActionBar().show();
                listComments.setVisibility(View.VISIBLE);
                form.setVisibility(View.VISIBLE);
            }
        }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T04:28:51.823

您可以为 listView 设置可点击属性并检查吗？此外，每当您向其中添加新的编辑文本时，您是否会动态添加它？如果是这样，这意味着您正在动态地将项目添加到 listView。listView 不会知道您是否单击了视图本身的某个项目，因此当您单击该项目时会注册一个回调，因为这会优先考虑。

# python - 获取可通过其路径调用的 Pyramid View（请求上下文）

> ID：14707400
> 
> 赞同：1
> 
> 时间：2013-02-05T12:19:15.610
> 
> 标签：python, url, pyramid

我正在制作一个应用程序，它将 websocket 消息转换为对服务器的 AJAX 请求。这个决定主要是基于 Pyramid 已经有一个很好的 URL 调度系统，不使用它是愚蠢的。

问题是是否有一种简单的方法可以将 Pyramid 中的 URL（可能是实例化的 Request 对象）分派到它的相应视图可调用并*获取*视图可调用？或者至少获得与请求相关的可调用视图的输出？

我已经尝试了来自“prequest.py”的脚本，它基本上模拟了一个完整的 HTTP 客户端并给你响应（我仍然没有设法让它工作，但无论如何查看源代码是有意义的），我不喜欢那样做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T16:34:33.090

您可以重用`pview`命令中的代码将路径转换为视图引用：

```
from pyramid.scripts.pviews import PViewsCommand

pvcomm = PViewsCommand([])
view = pvcomm._find_view(path, request.registry) 
```

执行此操作的实际代码有点复杂，但`PViewsCommand`它已经为我们完成了这一切。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T13:38:21.333

我已经设法在最新版本的 Pyramid (1.4a1) 中使用 Router.invoke_subrequest 来做到这一点。

这启用了与路由相关的所有功能。URL 调度、参数传递、补间。

你可以在这里阅读：http: [//docs.pylonsproject.org/projects/pyramid/en/latest/api/request.html#pyramid.request.Request.invoke_subrequest](http://docs.pylonsproject.org/projects/pyramid/en/latest/api/request.html#pyramid.request.Request.invoke_subrequest)

# c# - 点击 toast 通知栏

> ID：14707407
> 
> 赞同：2
> 
> 时间：2013-02-05T12:19:34.767
> 
> 标签：c#, .net, windows-phone

我使用 Windows Phone 7 向移动设备发送 toast 通知。当我退出应用程序时，我会在屏幕顶部看到带有我的标题和描述的栏。这太棒了。
但是当我点击这个栏时如何处理事件呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T02:24:53.850

您可以通过单击 toast 通知来指定当您的应用程序打开时用户将被导航到的页面以及参数。它称为*深度链接，您可以在*[MSDN](http://msdn.microsoft.com/en-us/library/windowsphone/develop/jj662938%28v=vs.105%29.aspx#BKMK_Howtosendatoastnotification)上了解它。

您发送的 XML 应包含一个名为`Param`.

```
<wp:Param>[stuff goes here]</wp:Param> 
```

您可以提供三种选择：

> `/page1.xaml`– 定义应用程序启动时要在应用程序中导航到的屏幕。字符串必须以“/”开头。
> 
> `/page1.xaml?value1=1234 &amp;value2=9876`– 定义应用程序启动时要导航到的屏幕，以及信息的名称/值对。字符串必须以“/”开头。
> 
> `?value1=1234 &amp;value2=9876`– 包含传递到应用程序默认开始屏幕的信息的名称/值对。字符串必须以“？”开头。

然后，您可以在您的页面中选择这些，如下所示：

```
protected override void OnNavigatedTo(NavigationEventArgs e)
{
    string strVal1 = this.NavigationContext.QueryString["value1"];
} 
```

# java - Android App Development：如何根据事件更改屏幕上的内容

> ID：14707411
> 
> 赞同：0
> 
> 时间：2013-02-05T12:19:46.760
> 
> 标签：java, android, android-layout

刚开始开发一些安卓应用。来自网络开发背景，我想知道更改屏幕上显示的内容背后的想法是否类似于链接 html 文件。

假设我有一个按钮，一旦单击它就会显示一个全新的页面，按钮消失了，并且在其位置上出现了全新的内容。起初我以为这只是通过在主要活动类中添加条件语句来完成的。但我看不出这将如何与 xml 布局文件一起使用。

所以我得出的结论是，您必须定义多个 xml 文件并使用主类中的逻辑在它们之间切换。

如果这是正确的，那么最好的方法是什么，如果不是，有人可以建议如何正常实现吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T12:23:39.727

我认为遵循以下教程是明智的：http: [//developer.android.com/training/basics/firstapp/index.html](http://developer.android.com/training/basics/firstapp/index.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T12:24:34.533

您是否尝试过访问 Android 开发者的网站？您的问题可以通过该网站的 Android 培训模块获得解决。你说过你想去一个新的页面，你可以在这里使用活动。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-09T04:58:49.187

让我简单地解释一下。

在 Android 中，您需要为每个页面（活动）创建一个单独的 xml 文件。例如 main_activity.xml。

并且对于每个页面（活动）都有一个 java 类。对于前 MainActivity.java。该类可能包含事件处理和业务逻辑部分。

现在让我们来回答您关于在多个页面之间切换的问题。

假设您有 2 个活动：MainActivity 和 SecondActivity。

现在在 MainActivity 中有一个按钮，然后将其 onClick 属性设置为其事件处理方法。这可以在 xml 文件中完成。

```
android:onClick="goToSecond" 
```

现在在 MainActivity.java 中，您需要创建一个如下所示的方法。

```
 public void goToSecond(View v)
{
        Intent i=new Intent(MainActivity.this,SecondActivity.class); ``startActivity(i);`` `}` 

这是用于切换到第二个活动的代码片段。

我也同意您应该查看developers.android.com的其他答案

希望能帮助到你。

            回答 #4

赞同：0

时间：2013-02-05T12:36:17.453

无需在纵向和横向模式的 XML 文件之间切换。Android 会为您做到这一点。如果您正在编写一个使用两种方向的应用程序，那么您必须编写单独的布局文件并将它们保存在布局（纵向）、布局-土地（横向）文件夹中。如果您的设计在两个方向上看起来都相同，则根本没有必要。

```

# java - 使用 DatagramSockets 的迭代 DNS 客户端

> ID：14707420
> 
> 赞同：1
> 
> 时间：2013-02-05T12:20:13.757
> 
> 标签：java, dns

我的作业是使用 UDP 实现一个迭代 DNS 客户端。我找不到任何示例如何向 DNS 服务器询问例如 MX 记录？如何检查答案是否权威？任何示例代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T12:41:01.467

请求和响应的格式在[RFC-1035](https://www.rfc-editor.org/rfc/rfc1035)中定义。以下[链接](http://www.netfor2.com/dns.htm)仅以更易读的格式包含相关信息。

另请参阅 ServerFault 上的此[问题](https://serverfault.com/questions/173187/what-does-a-dns-request-look-like)，该问题建议使用 WireShark 之类的工具来检查通过线路传输和传输的数据以进行调试。

# php - 如何在 cakephp 和 ajax 中使用 jtable 插件

> ID：14707423
> 
> 赞同：0
> 
> 时间：2013-02-05T12:20:18.503
> 
> 标签：php, cakephp, url-rewriting, routes, jquery-jtable

我正在做 cakephp 项目，我正在使用 Jtable A JQuery 插件来创建基于 AJAX 的 CRUD 表。我正在从以下位置访问数据：

```
 localhost/mydomain/ControllName/functionName i.e

 localhost/mydomain/My/getUserPlan 
```

我已通过以下方式采取行动，但将相同的页面网址作为行动

这是我的代码：

```
$('.list-of-location').jtable({
    title: 'Table of location',
    actions: {
        getUserPlanAction:'/My/getUserPlan'   // It is not used by Jtable, instad taking same page url 
    },
    fields: {
        arrivaldate:{
            title: 'From',
            width: '40%'
        },
        departuredate: {
            title: 'To',
            width: '40%',
            key: true,
            create: false,
            edit: false,
            list: false
        },
        country: {
            title: 'Destination',
            width: '40%'
        },
        regular_cost:{
            title: 'reguler budget',
            width: '20%'
        },
        backpacker_cost: {
            title: 'low budget',
            width: '30%',
            type: 'date',
            create: false,
            edit: false
        }
    }
});   

$('.list-of-location').jtable('load'); 
```

知道我该如何采取行动。我也试过：

1) getUserPlanAction:'getUserPlan'

2) getUserPlan:'/我的/getUserPlan'

3）getUserPlan：'getUserPlan'

4) 操作：'/My/getUserPlan'

作为一项行动，但这些都没有工作并出现错误：

```
 An error occured while communicating to the server. 
```

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T12:44:37.767

是的，我只是通过使用它来工作：

```
listAction:'/domain/My/getUserPlan' 
```

作为一个动作

# android - 将纵向旋转为横向时强制关闭，我尝试了 android:configChanges="keyboard|keyboardHidden" 并在纵向模式下工作？

> ID：14707426
> 
> 赞同：-1
> 
> 时间：2013-02-05T12:20:38.113
> 
> 标签：android, android-intent, android-emulator

从纵向旋转到横向时，AM 在模拟器上强制关闭？我已经尝试添加清单 android:configChanges="keyboard|keyboardHidden"

```
02-05 17:29:52.321: E/AndroidRuntime(1192): FATAL EXCEPTION: main
02-05 17:29:52.321: E/AndroidRuntime(1192): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.kidzapp.sample/com.kidzapp.sample.alphabets}: java.lang.NullPointerException
02-05 17:29:52.321: E/AndroidRuntime(1192):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2663)
02-05 17:29:52.321: E/AndroidRuntime(1192):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
02-05 17:29:52.321: E/AndroidRuntime(1192):     at android.app.ActivityThread.access$2300(ActivityThread.java:125)
02-05 17:29:52.321: E/AndroidRuntime(1192):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
02-05 17:29:52.321: E/AndroidRuntime(1192):     at android.os.Handler.dispatchMessage(Handler.java:99)
02-05 17:29:52.321: E/AndroidRuntime(1192):     at android.os.Looper.loop(Looper.java:123)
02-05 17:29:52.321: E/AndroidRuntime(1192):     at android.app.ActivityThread.main(ActivityThread.java:4627)
02-05 17:29:52.321: E/AndroidRuntime(1192):     at java.lang.reflect.Method.invokeNative(Native Method)
02-05 17:29:52.321: E/AndroidRuntime(1192):     at java.lang.reflect.Method.invoke(Method.java:521)
02-05 17:29:52.321: E/AndroidRuntime(1192):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
02-05 17:29:52.321: E/AndroidRuntime(1192):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
02-05 17:29:52.321: E/AndroidRuntime(1192):     at dalvik.system.NativeStart.main(Native Method)
02-05 17:29:52.321: E/AndroidRuntime(1192): Caused by: java.lang.NullPointerException
02-05 17:29:52.321: E/AndroidRuntime(1192):     at com.kidzapp.sample.alphabets.onCreate(alphabets.java:68)
02-05 17:29:52.321: E/AndroidRuntime(1192):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
02-05 17:29:52.321: E/AndroidRuntime(1192):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627) 
```

这是我的代码：

```
public class alphabets extends Activity implements OnClickListener{

    ImageButton home;
    @Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.lower);

          home=(ImageButton)findViewById(R.id.home);

        home.setOnClickListener(this);
}

 public void onClick(View image) {
        // TODO Auto-generated method stub

switch (image.getId()) {
case R.id.home:

Intent i=new Intent(this, MainActivity.class);

startActivity(i);
finish();
break;

    }

}

@Override
protected void onStop() {
    // TODO Auto-generated method stub
    mp.stop();
    super.onStop();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T13:00:35.527

看来您的`ImageView home`视图为 NULL，为什么当您尝试设置 clickListener 时它会崩溃：

```
home.setOnClickListener(this); 
```

**如果**它仅在您处于横向模式时发生，我认为这是因为您正在使用特定的横向布局（目录`res/layout-land`）并且此布局没有`ImageView`带有`R.id.home`标识符。

编辑：

还有一件事，您不需要添加`android:configChanges="keyboard|keyboardHidden"`到清单中。这不是您的问题的原因，并且对于某些特定情况的 Android 开发期望不鼓励。

[在官方文档中](http://developer.android.com/guide/topics/resources/runtime-changes.html#HandlingTheChange)：

> 当您必须避免由于配置更改而重新启动并且不建议用于大多数应用程序时，应将此技术视为最后的手段。

# c - 在 char 指针中获取字符串输入

> ID：14707427
> 
> 赞同：12
> 
> 时间：2013-02-05T12:20:38.977
> 
> 标签：c

```
#include<stdio.h>
#include<string.h>
#include<stdlib.h>

int main(){
    char *s;
    printf("enter the string : ");
    scanf("%s", s);
    printf("you entered %s\n", s);
    return 0;
} 
```

当我提供长度不超过 17 个字符的小输入（例如“aaaaaaaaaaaaaaaa”）时，程序工作得非常好，但是在提供更大长度的输入时，它给我一个运行时错误，说“main.c 已意外停止工作”。

我的编译器（代码块）或我的电脑（Windows 7）有问题吗？还是它与C的输入缓冲区有某种关系？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-02-05T12:23:55.610

这是**[未定义的行为](http://en.wikipedia.org/wiki/Undefined_behavior)**，因为指针未初始化。你的编译器没有问题，但你的代码有问题:)

在将数据存储在其中之前，请先`s`指向有效内存。

* * *

要管理缓冲区溢出，您可以在格式说明符中指定长度：

```
scanf("%255s", s); // If s holds a memory of 256 bytes
// '255' should be modified as per the memory allocated. 
```

GNU C 支持一个非标准扩展，您不必分配内存，因为如果`%as`指定了分配，但应该传递指向指针的指针：

```
#include<stdio.h>
#include<stdlib.h>  

int main() {
  char *s,*p;

  s = malloc(256);
  scanf("%255s", s); // Don't read more than 255 chars
  printf("%s", s);

  // No need to malloc `p` here
  scanf("%as", &p); // GNU C library supports this type of allocate and store.
  printf("%s", p);
  free(s);
  free(p); 
  return 0;
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-05T12:23:16.510

char 指针未初始化，您应该为它动态分配内存，

```
char *s = malloc(sizeof(char) * N); 
```

`scanf` 其中 N 是您可以读取的最大字符串大小，如果不指定输入字符串的最大长度，使用它是不安全的，像这样使用它，

```
scanf("%Ns",s); 
```

其中 N 与 malloc 的相同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T12:23:34.203

您没有为字符数组分配任何内存，因此首先尝试通过调用 malloc() 或 calloc() 来获取内存。然后尝试使用它。

```
s = malloc(sizeof(char) * YOUR_ARRAY_SIZE);
...do your work...
free(s); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-05T12:24:37.463

您需要为指针指向的缓冲区分配足够的内存：

```
 s = malloc(sizeof(char) * BUF_LEN); 
```

如果您不再需要它，则释放此内存：

```
 free(s); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-05T12:25:09.663

您没有为字符串分配内存，因此，您正在尝试写入未经授权的内存地址。这里

```
char *s; 
```

你只是在声明一个指针。您没有指定为字符串保留多少内存。您可以像这样静态声明：

```
char s[100]; 
```

这将保留 100 个字符。如果你超过 100，它仍然会像你提到的那样再次崩溃，原因相同。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-05T12:24:41.177

问题在于您的代码..您永远不会为`char *`. 由于没有分配（使用`malloc()`）足够大的内存来保存字符串，因此这成为未定义的行为。

您必须分配内存`s`然后使用`scanf()`（我更喜欢`fgets()`）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-07-15T13:28:38.037

```
#include"stdio.h"
#include"malloc.h"

int main(){

        char *str;

        str=(char*)malloc(sizeof(char)*30);

        printf("\nENTER THE STRING : ");
        fgets(str,30,stdin);

        printf("\nSTRING IS : %s",str);

        return 0;
} 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2018-11-04T08:08:45.957

C中读取字符指针的代码

```
#include<stdio.h>
 #include<stdlib.h>
 void main()
 {
    char* str1;//a character pointer is created 
    str1 = (char*)malloc(sizeof(char)*100);//allocating memory to pointer
    scanf("%[^\n]s",str1);//hence the memory is allocated now we can store the characters in allocated memory space
    printf("%s",str1);
    free(str1);//free the memory allocated to the pointer
 } 
```

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2022-01-11T11:41:49.997

我遇到了这个问题。我在下面尝试了这段代码，它起作用了：

```
char *text; 
scanf("%s", *&text); 
```

我不知道它是如何工作的。我只是觉得想做。

# php - 如何防止 Symfony 2 在模板中设置全局变量？

> ID：14707428
> 
> 赞同：2
> 
> 时间：2013-02-05T12:20:39.123
> 
> 标签：php, symfony

如何告诉 Symfony2 不要`app`在模板中设置全局变量（如）？我想设置自己的`app`变量，但`Symfony\Bundle\FrameworkBundle\Templating\GlobalVariables Object`如果我在控制器中覆盖它，它就会有类型事件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T10:43:13.853

我认为这是这样的可能性（基本上从来没有因为`app`var 可以派上用场；））

`app`global 被添加到`Symfony\Bundle\TwigBundle\TwigEngine`（for twig）的构造函数和`Symfony\Bundle\FrameworkBundle\Templating\PhpEngine`（for php）的构造函数中

但是当你不传递`GlobalVariables`给构造函数（可以为空）时，它不会设置`app`变量。所以你可以像这样覆盖`templating`服务：

```
 <service id="templating" class="Acme\DemoBundle\Templating\TwigEngine">
        <argument type="service" id="twig" />
        <argument type="service" id="templating.name_parser" />
        <argument type="service" id="templating.locator" /> 
    </service> 
```

和 php 文件：

```
<?php 

namespace Acme\DemoBundle\Templating;

use Symfony\Bundle\TwigBundle\TwigEngine as BaseEngine;
use Symfony\Component\Templating\TemplateNameParserInterface;
use Symfony\Component\Config\FileLocatorInterface;

class TwigEngine extends BaseEngine
{
    public function __construct(\Twig_Environment $environment, TemplateNameParserInterface $parser, FileLocatorInterface $locator)
    { 
        parent::__construct($environment, $parser, $locator);
    } 
} 
```

您应该知道，您也可以在没有它的情况下实现自己的全局变量......只需定义自己的`templating.globals`服务来替换原来的服务。

# java - 避免两次注销表单服务android

> ID：14707431
> 
> 赞同：2
> 
> 时间：2013-02-05T12:20:48.227
> 
> 标签：java, android, android-service

我可以这样做吗：

```
mBoradcastReciver = null;
void register(){
  if(mBoradcastReciver == null){
     mBoradcastReciver = new ...
     registerReceiver(mBroadcastReceiver, ....);
  }
}

void unregister(){
    if(mBoradcastReciver != null){
       unregisterReceiver(mBroadcastReceiver);
       mBoradcastReciver = null;
    } 
```

和方法 register() 和 unregister() 每次我想要调用？这种方法有什么潜在的问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T12:26:55.227

潜在的问题是，如果接收者不为空且未注册，您将获得一个`IllegalStateException`. 所以要么做一个布尔标志或`catch`异常。布尔标志将`true`在您注册接收器时设置为，然后`false`在您取消注册时设置为。

# django - 如何处理“str”对象没有属性“_meta”错误？

> ID：14707433
> 
> 赞同：3
> 
> 时间：2013-02-05T12:20:59.820
> 
> 标签：django, django-templates

所以我一直在考虑为我的对象添加评级功能，并决定使用 Agon-ratings [https://github.com/eldarion/agon-ratings](https://github.com/eldarion/agon-ratings)

```
i have followed their usage documentation <http://agon-ratings.readthedocs.org/en/latest/usage.html>
did this with my template,
{% extends "base.html" %}
{% load url from future %}
{% block title %}Don't you jus love easy food{% endblock %}
{% block content %}
{% load agon_ratings_tags %}
<br/>
<br/>

<div>

{% if found_entries %}
 <p>You searched for "{{ query_string }}".</p> 
 {% for restaurant in found_entries %}

 <div>
   <div>
    <table>
     <tr>
        <td>dxtcfyguvhyju</td>

      <td><a href="{% url 'f4l_menu' restaurant.id %}">{{ restaurant.restaurant_name }}</td></a>
     </tr>
     <tr>
      <td>Location</td>
      <td>{{restaurant.address}}</td>
     </tr>
    </table>

 {% endfor %}
{% overall_rating obj as the_overall_rating %}
<div class="overall_rating">{{ the_overall_rating }}</div>
<div id= "user_rating"></div>

{% endif %}
{% if query_string and not found_entries %}
 <p>No results found.</p>
{% else %}
 <p>Type a search query into the box above, and press "Submit" to search.</p>
{% endif %}
   </div>
  </div>
  <div style="clear: both;"></div>
 </div>
</div>
{% user_rating_js request.user obj %}
{% endblock %} 
```

当我加载我的页面时，`'str' object has no attribute '_meta'` 我显然不明白我哪里出错了。顺便说一句，我是一名初学者 django 开发人员，正在开发我的第一个 django 应用程序

追溯，

```
Template error:
In template /home/mats-invasion/projects/f4l/templates/public/search.html, error at line 31
   'str' object has no attribute '_meta'
   21 :         

   22 :       <td><a href="{% url 'f4l_menu' restaurant.id %}">{{ restaurant.restaurant_name }}</td></a>

   23 :      </tr>

   24 :      <tr>

   25 :       <td>Location</td>

   26 :       <td>{{restaurant.address}}</td>

   27 :      </tr>

   28 :     </table>

   29 :     

   30 :  {% endfor %}

   31 :  {% overall_rating obj as the_overall_rating %} 

   32 : <div class="overall_rating">{{ the_overall_rating }}</div>

   33 : <div id= "user_rating"></div>

   34 :  

   35 : {% endif %}

   36 : {% if query_string and not found_entries %}

   37 :  <p>No results found.</p>

   38 : {% else %}

   39 :  <p>Type a search query into the box above, and press "Submit" to search.</p>

   40 : {% endif %}

   41 :    </div>

Traceback:
File "/home/mats-invasion/projects/f4l/env/local/lib/python2.7/site-packages/django/core/handlers/base.py" in get_response
  111\.                         response = callback(request, *callback_args, **callback_kwargs)
File "/home/mats-invasion/projects/f4l/f4l/f4l/views.py" in search
  64\.   return render_to_response('public/search.html',context,context_instance=RequestContext(request))
File "/home/mats-invasion/projects/f4l/env/local/lib/python2.7/site-packages/django/shortcuts/__init__.py" in render_to_response
  20\.     return HttpResponse(loader.render_to_string(*args, **kwargs), **httpresponse_kwargs)
File "/home/mats-invasion/projects/f4l/env/local/lib/python2.7/site-packages/django/template/loader.py" in render_to_string
  176\.         return t.render(context_instance)
File "/home/mats-invasion/projects/f4l/env/local/lib/python2.7/site-packages/django/template/base.py" in render
  140\.             return self._render(context)
File "/home/mats-invasion/projects/f4l/env/local/lib/python2.7/site-packages/django/test/utils.py" in instrumented_test_render
  62\.     return self.nodelist.render(context)
File "/home/mats-invasion/projects/f4l/env/local/lib/python2.7/site-packages/django/template/base.py" in render
  823\.                 bit = self.render_node(node, context)
File "/home/mats-invasion/projects/f4l/env/local/lib/python2.7/site-packages/django/template/debug.py" in render_node
  74\.             return node.render(context)
File "/home/mats-invasion/projects/f4l/env/local/lib/python2.7/site-packages/django/template/loader_tags.py" in render
  123\.         return compiled_parent._render(context)
File "/home/mats-invasion/projects/f4l/env/local/lib/python2.7/site-packages/django/test/utils.py" in instrumented_test_render
  62\.     return self.nodelist.render(context)
File "/home/mats-invasion/projects/f4l/env/local/lib/python2.7/site-packages/django/template/base.py" in render
  823\.                 bit = self.render_node(node, context)
File "/home/mats-invasion/projects/f4l/env/local/lib/python2.7/site-packages/django/template/debug.py" in render_node
  74\.             return node.render(context)
File "/home/mats-invasion/projects/f4l/env/local/lib/python2.7/site-packages/django/template/loader_tags.py" in render
  123\.         return compiled_parent._render(context)
File "/home/mats-invasion/projects/f4l/env/local/lib/python2.7/site-packages/django/test/utils.py" in instrumented_test_render
  62\.     return self.nodelist.render(context)
File "/home/mats-invasion/projects/f4l/env/local/lib/python2.7/site-packages/django/template/base.py" in render
  823\.                 bit = self.render_node(node, context)
File "/home/mats-invasion/projects/f4l/env/local/lib/python2.7/site-packages/django/template/debug.py" in render_node
  74\.             return node.render(context)
File "/home/mats-invasion/projects/f4l/env/local/lib/python2.7/site-packages/django/template/loader_tags.py" in render
  62\.             result = block.nodelist.render(context)
File "/home/mats-invasion/projects/f4l/env/local/lib/python2.7/site-packages/django/template/base.py" in render
  823\.                 bit = self.render_node(node, context)
File "/home/mats-invasion/projects/f4l/env/local/lib/python2.7/site-packages/django/template/debug.py" in render_node
  74\.             return node.render(context)
File "/home/mats-invasion/projects/f4l/env/local/lib/python2.7/site-packages/django/template/loader_tags.py" in render
  62\.             result = block.nodelist.render(context)
File "/home/mats-invasion/projects/f4l/env/local/lib/python2.7/site-packages/django/template/base.py" in render
  823\.                 bit = self.render_node(node, context)
File "/home/mats-invasion/projects/f4l/env/local/lib/python2.7/site-packages/django/template/debug.py" in render_node
  74\.             return node.render(context)
File "/home/mats-invasion/projects/f4l/env/local/lib/python2.7/site-packages/django/template/defaulttags.py" in render
  281\.                 return nodelist.render(context)
File "/home/mats-invasion/projects/f4l/env/local/lib/python2.7/site-packages/django/template/base.py" in render
  823\.                 bit = self.render_node(node, context)
File "/home/mats-invasion/projects/f4l/env/local/lib/python2.7/site-packages/django/template/debug.py" in render_node
  74\.             return node.render(context)
File "/home/mats-invasion/projects/f4l/env/local/lib/python2.7/site-packages/agon_ratings/templatetags/agon_ratings_tags.py" in render
  106\.             ct = ContentType.objects.get_for_model(obj)
File "/home/mats-invasion/projects/f4l/env/local/lib/python2.7/site-packages/django/contrib/contenttypes/models.py" in get_for_model
  32\.         opts = self._get_opts(model)
File "/home/mats-invasion/projects/f4l/env/local/lib/python2.7/site-packages/django/contrib/contenttypes/models.py" in _get_opts
  20\.         return model._meta.concrete_model._meta

Exception Type: AttributeError at /search/
Exception Value: 'str' object has no attribute '_meta' 
```

在views.py中，

```
def search(request):
    query_string=''
    found_entries=None
    search_fields=('delivery_territory',)
    option=request.REQUEST.get('deliveryType',None)
    if option== 'D':
        start_set=Restaurant.objects.filter(services='DEL')
    elif option == 'P':
        start_set = Restaurant.objects.filter(services='PCK')
    else:
        start_set=Restaurant.objects.all()
    if ('q' in request.GET) and request.GET['q'].strip():
        query_string= request.GET['q']
        entry_query= get_query(query_string,search_fields)
        found_entries= start_set.filter(entry_query).order_by('created_on')
    obj = Restaurant.objects.all()
    context={
        'query_string':query_string,
        'found_entries':found_entries,
        'obj':obj,
    }
    return render_to_response('public/search.html',context,context_instance=RequestContext(request)) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T12:54:12.160

这似乎`obj`是一个字符串值。而不是模型实例。请验证`obj`变量的值。

编辑 ：

[使用文档](http://agon-ratings.readthedocs.org/en/latest/usage.html)中给出的解释是针对详细视图（或多或少有一个主要对象）。

如果您愿意在其中显示每家餐厅的评分，则`found_entries`可能需要进行一些更改。（如果没有请提及）

该类在[这一行](https://github.com/eldarion/agon-ratings/blob/master/agon_ratings/templates/agon_ratings/_script.html#L43)`overall_rating`中是硬编码的。为了能够在搜索结果中对每家餐厅进行评分，您必须进行更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T23:43:33.733

只需将您的 2 个模板标签更改为如下所示： `{% overall_rating yourappmodel as the_overall_rating %}`和`{% user_rating_js request.user yourappmodel %}`

# c++ - 为什么这个全局堆对象没有被释放？

> ID：14707441
> 
> 赞同：0
> 
> 时间：2013-02-05T12:21:18.857
> 
> 标签：c++, heap-memory

我有这个代码：

```
class A {
    public:
            int x;
};

A *b;

void x() {
    A a;
    A *b = new A();
//  delete b; // works. free b.
}

int main() {
    x();
    delete b; //not. why ?
    return 0;
} 
```

为什么 b 只能在 x() 内部释放？不是 main() 吗？我认为 b 是一个手动变量，而不是范围限制。用valgrind检查。

谢谢你。:)

**更新：**

现在我想起来了。我可以使用 global b ：

b = 新的 A();

那么main()上的delete b就可以正确的删除全局b了。

****掌心****

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-05T12:22:57.433

因为`b`inside的声明`x()` *遮蔽*了全局声明；这是一个单独的变量。所以在你的代码中，全局`b`永远不会分配给，所以你有内存泄漏。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T12:23:10.163

你可以用这种方式操纵外部`b`：

```
 ::b; 
```

在函数内部`x()`，您声明了一个新的`b`，它显示`b`在全局中。`scope resolution notation ::`如果您想在 outter 上进行操作，您可以提供`b`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T12:24:03.410

在您的函数`x()`中，您声明了一个局部变量`b`。该变量与全局变量无关`b`。

`delete b`in`main()`试图删除全局指针`b`（它是全局的，被初始化为空指针值，所以`delete`它什么都不做）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T12:24:33.577

内部与全局范围不同`b`。我不知道“手动”变量应该是什么，但 C++（出于所有实际目的）是词法范围的。因此，新变量隐藏了更高范围级别的变量。`x``b`

# oracle - 如何更改 Oracle SDO_GEOMETRY 的 SRID

> ID：14707442
> 
> 赞同：11
> 
> 时间：2013-02-05T12:21:19.487
> 
> 标签：oracle, oracle-spatial

我有 Oracle 分配了 SRID **81989**的空间数据。我想将其更改为**27700** - 它们都是相同的坐标系，只是 Oracle 使用自己的 SRID；所以不需要重新投影（`SDO_CS.TRANSFORM`因为它实际上也改变了坐标，所以这不起作用，我不想要））。

我已经`USER_SDO_GEOM_METADATA`很容易更新了，但是`SDO_GEOMETRY`包含数据本身也有 SRID，我不知道如何更改它。

因此，例如，我当前的数据如下所示：

```
MDSYS.SDO_GEOMETRY(2001,81989,MDSYS.SDO_POINT_TYPE(420531.663898,268911.956161,NULL),NULL,NULL) 
```

我需要将其更改为：

```
MDSYS.SDO_GEOMETRY(2001,27700,MDSYS.SDO_POINT_TYPE(420531.663898,268911.956161,NULL),NULL,NULL) 
```

对于表中的所有行。但我不知道如何自动更改 SDO_GEOMETRY 中的单个元素，同时保持数组的其他方面不变。

谁能指出我的方向？谢谢。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-02-05T14:44:02.393

要更新 SRID，您可以使用以下内容：

```
UPDATE YOUR_TABLE T
SET T.YOUR_SDO_GEOMETRY_COLUMN.SDO_SRID = 27700
WHERE T.YOUR_SDO_GEOMETRY_COLUMN IS NOT NULL 
```

请注意，必须使用表别名（如本例中的 T）。

# backbone.js - 导出和使用主干模型并查看错误

> ID：14707445
> 
> 赞同：0
> 
> 时间：2013-02-05T12:21:29.497
> 
> 标签：backbone.js, requirejs

我在我的应用程序中使用“require.js”，我收到此错误：

```
ReferenceError: Can't find variable: appModel
require.js:32Error: Load timeout for modules: listView 
```

我无法理解我这边出了什么问题：

我的配置是：

```
requirejs.config({
    baseUrl:"scripts",
    paths:{
        //libraries
        jquery          :"lib/jquery-1.9.0.min",
        jqueryUI        :"lib/jquery-ui-1.9.2.custom.min",
        underScore      :"lib/lodash-1.0.0.min",
        backBone        :"lib/backbone-min",
        //scripts
        appInit         :"js/tasklist",
        loginValidate   :"js/loginValidate",
        listModel       :"js/models/listModel",
        listCollection  :"js/collections/listCollection",
        listView        :"js/views/listView"
    },
    shim:{
        "underScore":{
            exports: "_"
        },
        "backBone":{
            exports:"Backbone",
            deps:["underScore"]
        },
        "appInit" : {
            deps:["jquery","jqueryUI","underScore","backBone"]
        },
        "jqueryUI":{
            deps:["jquery"]
        },
        "loginValidate":{
            deps:['jquery']
        },
        "listModel":{
            exports:"listModel",
            deps:["backBone"]
        },
        "listCollection":{
            exports:"listCollection",
            deps:["listModel"]
        },
        "listView":{
            exports:"listView",
            deps:["listModel","listCollection"]
        }
    }
});

require(['jquery'],function(){
    if($('#tlLoginForm').length){
        require(["jquery","loginValidate"],function($){
            $(function(){
                var paramsLoginForm = {
                        loginForm : $('#tlLoginForm')
                    };
                var validate = tasklistHandler(paramsLoginForm);
                validate.init(); //it works fine.
            });
        });
    }
    if($("#boardTemplate").length){ // i am finding my template and initiating the values
        require(["backBone","listModel","listCollection","listView"], function(){

        });
    };
}); 
```

我在 listModel.js 中的模型

```
require(['jquery','backBone'],function($,Backbone){ // i am importing jquery, and backbone and assigning the model
var appModel = Backbone.Model.extend({
        url : 'data/data.json',
        defaults:{
          "id"                  :"id",
          "title"               :"Title",
          "projectName"         :"project",
          "dueDays"             :0,
          "dueTime"             :0,
          "dueDate"             :"0-0-0000",
          "totalTasks"          :0,
          "taskCompleted"       :0,
          "percent"             :65,
          "taskStatus"          :"Assigned",
          "jobtype"             :"vip",
          "username"            :"scott.pierce@groupfmg.com",
          "notes"               :"notes1"
        }  
      });

      return appModel; // tried not works
}); 
```

我在 listCollection.js 中的收藏

```
define(["jquery","backBone","listModel"],function($,Backbone,model){ 
```

// 我正在导入我在 listModel.js 中声明的 jquery、主干和模型，但它不起作用！console.log('collection',model); // 我的模型未定义 var collection = Backbone.Collection.extend({ model:model, initialize:function(){ console.log(this.model); } });

```
 var newModel = new appModel; //ReferenceError: Can't find variable: appModel
    console.log(newModel); // throw the error as like i mentioned.
}); 
```

任何人都可以帮我纠正我的问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T05:02:26.723

这对我有用..

而不是使用`"require"`我使用的`"define"`. 现在一切都很好。

谢谢大家。

# cakephp - Cakephp belongsTo 关系 - 访问相关模型

> ID：14707448
> 
> 赞同：3
> 
> 时间：2013-02-05T12:21:36.393
> 
> 标签：cakephp

我有一个顾问表，它有一个外键“specialty_id”，它链接到一个“specilaties”表。

```
class Consultant extends AppModel {
    public $belongsTo = array(
        'Specialty' => array(
            'className'     => 'Specialty',
            'conditions'    => array('Specialty.active' => 1)
        )
    );
}

class Specialty extends AppModel {
    public $hasOne = 'Consultant';
} 
```

我认为这是正确的，但是，我无法从顾问控制器获取专业列表（“在非对象上调用成员函数 find() ”）

```
$this->set('specialties', $this->Specialty->find('all')); 
```

我哪里错了？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T12:24:28.797

请记住，您在*控制器*中，而不是在模型中。试试这个：

```
$this->set('specialties', $this->Consultant->Specialty->find('all')); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T12:25:24.777

如果您在其他控制器中使用模型，则首先加载该模型，然后运行查询：

```
$this->loadModel('Specialty'); 
```

# javascript - 如何在 Dreamweaver 的 Spry 选项卡式面板中取消设置默认选项卡？

> ID：14707453
> 
> 赞同：0
> 
> 时间：2013-02-05T12:21:51.137
> 
> 标签：javascript, spry

我在 Dreamweaver 中有一个 Spry 选项卡式面板，第一个选项卡在页面加载时打开。我不想在页面加载时打开任何选项卡。我怎样才能做到这一点？

谢谢！

那是我的html：

```
 <ul class="TabbedPanelsTabGroup">
  <li class="TabbedPanelsTab play" tabindex="0"><h4>Play! Framework</h4></li>
  <li class="TabbedPanelsTab ruby" tabindex="1"><h4>Ruby on Rails</h4></li>
  <li class="TabbedPanelsTab api" tabindex="2"><h4>Restful Api</h4></li>
  </ul> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T14:14:28.267

这可能是可用的最笨拙的解决方法，但至少它很容易做到。找到您的`SpryTabbedPanels.js`文件并查看第一个函数的外观。如果你在某处有一行`this.defaultTab = 0;`注释，看看会发生什么。它应该使面板不可见。

您可能还想摆脱 javaScript 错误，因此找到包含以下内容的行`panels[tpIndex].style.display = "block";`并将其替换为：

```
if(panels[tpIndex]){
  panels[tpIndex].style.display = "block";
} 
```

实际上，如果页面上有多个面板组，您还需要进行第二次更正。否则只有第一个面板组被隐藏。

这应该有效。至少它适用于我使用 DW CS3 制作的 Spry。但它看起来很难看恕我直言。没有过渡/动画。但至少在第一次加载页面时看不到任何面板。选项卡当然是可见的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T12:23:40.910

```
$('ul > li').removeClass('selected'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-01-13T10:25:51.723

SpryCollapsiblePanel.js

顶部：

```
this.contentIsOpen = false; 
```

（用假代替真）

Dreamweaver CS6

# spring - java servlet 如果在上传文件时会话无效，会发生什么？

> ID：14707458
> 
> 赞同：1
> 
> 时间：2013-02-05T12:22:16.417
> 
> 标签：spring, session, servlets, file-upload, timeout

我正在使用 Apache 的 commons.fileupload 通过 servlet 将文件上传到服务器。文件数据从 Http 请求对象流式传输到网络目标（可能连接速度较慢）。会话身份验证/维护由 Spring 处理。会话将在 x 分钟后超时。

问题是; 如果在上传文件时会话无效（超时）会怎样？（大文件，短时间）

下载文件也是如此（如果二进制数据被添加到 Http 响应对象而不是发送到浏览器的链接）

此致，

安德烈

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T12:25:53.123

从逻辑上讲，会话超时不应发生，因为在文件上传期间，数据位会不断交换。

会话超时只会在客户端和服务器之间没有通信“x”分钟后发生

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T12:28:23.773

这取决于您如何实现代码。

通常，如果会话结束，用户不会中断他们的上传/下载过程，因为他们已经通过身份验证来执行该操作。我的建议是，当用户对服务器执行新操作（请求）时，放置一些更新会话生命周期（或重置它）的代码。

# jquery - 字段为空时不触发远程属性

> ID：14707460
> 
> 赞同：9
> 
> 时间：2013-02-05T12:22:25.690
> 
> 标签：jquery, asp.net, asp.net-mvc, validation, jquery-validate

我正在使用`RemoteAttribute`表单上的特定字段。它的目的并不重要。重要的是，无论何时更改字段，它都需要触发验证操作。这对我来说很好，除非该字段更改为空白。

我用谷歌搜索了这个，但没有找到任何结果。有谁知道是否`RemoteAttribute`确实触发了空白字段，如果没有，如何强制？

或者，是否可以自定义/修改远程验证器以触发空白值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T19:53:20.560

如果元素的值为空，jQuery 验证将不会运行任何规则。如果您有一条 minLength = 2 规则，但输入字段为空，则该规则不会失败。只有当用户输入 1 个字符时，它才会失败。

同样的想法也适用于远程验证器。如果该值为空，则它不会发送到服务器。

我不认为插件中有一个选项可以改变这种行为。您将需要创建一个自定义异步规则来获得您期望的行为。这可能会变得有点棘手。你确定没有其他方法可以做到吗？验证服务器中的空字符串是否有意义？您可以添加所需的规则吗？

# android - 从 ant 中的 AndroidManifest 文件中检索值

> ID：14707462
> 
> 赞同：0
> 
> 时间：2013-02-05T12:22:33.320
> 
> 标签：android, xml, ant

我正在尝试从 androidManifest xml 文件中检索 versionName，但无法通过 ant 执行此操作。

这是我尝试过的：

```
<xmlproperty file="AndroidManifest.xml"/>

<echo>android manifest test ${manifest.android:versionName} ${android.android:versionName} ${android:versionName}</echo> 
```

我尝试了 3 种组合，所有 3 种都无法输出 versionName

下面是我的清单文件的片段

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.hello.main" android:versionCode="1" android:versionName="20">

    <application

...

<activity

.... 
```

有什么建议么？

我只是想从 android:versionName="20" 检索值 20

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T16:07:23.267

这成功了

```
<xmlproperty file="AndroidManifest.xml" collapseAttributes="true"/> 
```

如果要将属性值视为元素，请使用上述

# git - 写入几个文件后 Git push 挂起

> ID：14707473
> 
> 赞同：1
> 
> 时间：2013-02-05T12:23:05.093
> 
> 标签：git, github, github-for-mac

我试图推动一个分支，但在写入 82% 的对象后它挂起。在 87 个文件中的 72 个之后它不会继续写入任何内容，但相应的文件大小会增加并最终超过整个项目的大小。问题是什么？

写入对象：82% (72/87)，4.09 MiB | 89 KB/秒

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T18:31:08.050

正如您在评论中指出的那样，提交历史记录中有一个视频。视频的任何提交都将是巨大的，但应该只需要推送一次。如果您对此感到满意，那么我将等待推送完成。

如果您需要删除它，则必须重写您的历史记录以不包含该视频。 [这个答案](https://stackoverflow.com/a/872700/166732)有关于如何做到这一点的说明。如果只有几个提交，你可以使用 rebase，如果没有，你应该使用`git filter-branch`.

# android - 用于监听联系人变化的 ContentObserver

> ID：14707475
> 
> 赞同：9
> 
> 时间：2013-02-05T12:23:13.547
> 
> 标签：android, android-contacts, contentobserver, android-query

我真的不明白为什么内容观察者会监听与联系信息无关的更改。

我只是注册到我想听变化的 URI：

```
getContentResolver().registerContentObserver(ContactsContract.CommonDataKinds.Phone.CONTENT_URI, true, contactsObserver); 
```

但是在给某人打电话或给某人发短信后，它会触发并调用 ContentObserver 中的 onChange 方法。所以我需要将所有联系人列表与我的应用程序重新同步，尽管我不需要这样做。

我唯一感兴趣的领域：

*   ContactsContract.CommonDataKinds.Phone.CONTACT_ID
*   ContactsContract.CommonDataKinds.Phone.DISPLAY_NAME
*   ContactsContract.CommonDataKinds.Phone.NUMBER

我应该实施什么样的更改来监听此数据库项目的更改？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-01-26T08:53:09.663

联系人数据库有一个字段`ContactsContract.Contacts.TIMES_CONTACTED` 每次您联系联系人列表中的某个人时，该字段都会更新。

甚至可以使用您自己的应用程序更新此字段，这意味着，如果您使用更新此字段的应用程序联系任何联系人，您的`onChange()`方法将被调用。

# qt - QGraphicsPixmapItem，连接到插槽的替代方法

> ID：14707478
> 
> 赞同：0
> 
> 时间：2013-02-05T12:23:16.150
> 
> 标签：qt

我知道如果我使用 QGraphicsPixmapItem，我需要从 QObject 派生才能连接到插槽，但我正在努力做到这一点。我尝试过其他方法来实现我想要的，我尝试过 onMousePress 和 isSelectable 即

> ```
> run->setFlag(QGraphicsPixmapItem::ItemIsSelectable);
> 
> if (run->isSelected())
> {
>     qDebug() << "selected";
> }
> else if (!run->isSelected())
> {
>     qDebug() << "not selected";
> } 
> ```

虽然 run 是可选择的，但第一个参数永远不会是真的，它总是“未选择”

这是我的代码，我正在研究 slot 方法；

```
mainwindow.cpp

int MainWindow::sim()
{

...
    QGraphicsPixmapItem* run = new QGraphicsPixmapItem(QPixmap::fromImage(image6));
    run->scale(0.3,0.3);
    run->setPos(-200,-200);
    run->setFlag(QGraphicsPixmapItem::ItemIsSelectable);
    run->setCursor(Qt::PointingHandCursor);
    connect(run, SIGNAL(selectionChanged()), this, SLOT(runClicked()));
    scene->addItem(run);

    //pause 
    QGraphicsPixmapItem* pause = new QGraphicsPixmapItem(QPixmap::fromImage(image7));
    pause->scale(0.3,0.3);
    pause->setPos(-160,-197);
    pause->setFlag(QGraphicsPixmapItem::ItemIsSelectable);
    pause->setCursor(Qt::PointingHandCursor);
    connect(pause, SIGNAL(selectionChanged()), this, SLOT(pauseClicked()));
    scene->addItem(pause);
...

}

void MainWindow::runClicked()
{
    qDebug() << "run Clicked";
}

void MainWindow::pauseClicked()
{
    qDebug() << "pause Clicked";
}

mainwindow.h

#define MAINWINDOW_H

#include <QMainWindow>

class MainWindow : public QMainWindow
{
    Q_OBJECT

public:
    MainWindow();
    int sim();
...

public slots:
    void runClicked();
    void pauseClicked();
... 
```

所以很明显我在连接到插槽时遇到了错误。有人可以帮忙吗？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T12:55:08.970

要确定您的项目是否被选中，请执行以下操作：

```
QVariant MyItem::itemChange( GraphicsItemChange change, const QVariant& value )
{
    if ( change == QGraphicsItem::ItemSelectedHasChanged ) {
        qDebug() << ( isSelected() ? "selected" : "not selected" );
    }

    return QGraphicsItem::itemChange( change, value );
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T13:22:34.907

如果你想使用信号和槽，你需要继承`QObject`和`QGraphicsPixmapItem`。

因为`QObject`不包含`clicked()`信号，所以您也需要通过重新实现
`void mousePressEvent ( QGraphicsSceneMouseEvent *e )`and来实现它`void mouseReleaseEvent ( QGraphicsSceneMouseEvent *e )`。

我的项目：

```
#pragma once

#include <QGraphicsPixmapItem>
#include <qobject.h>
#include <QMouseEvent>
#include <QGraphicsSceneMouseEvent>

class MyItem:  public QObject, public QGraphicsPixmapItem 
               /* moc.exe requires to derive from QObject first! */
{
    Q_OBJECT
public:
    MyItem(QGraphicsItem *parent = 0): QObject(), QGraphicsPixmapItem(parent)
    {

    }

    MyItem(const QPixmap & pixmap, QGraphicsItem * parent = 0 ): QObject(), 
                                                                 QGraphicsPixmapItem(pixmap, parent)
    {

    }

signals:
    void clicked();

protected:
    // re-implement processing of mouse events
    void mouseReleaseEvent ( QGraphicsSceneMouseEvent *e )
    {
        // check if cursor not moved since click beginning
        if ((m_mouseClick) && (e->pos() == m_lastPoint))
        {
            // do something: for example emit Click signal
            emit clicked();
        }
    }

    void mousePressEvent ( QGraphicsSceneMouseEvent *e )
    {
        // store click position
        m_lastPoint = e->pos();
        // set the flag meaning "click begin"
        m_mouseClick = true;
    }

private:
    bool m_mouseClick;
    QPointF m_lastPoint;
}; 
```

以及简单的用法示例：

```
#include <qgraphicsview.h>
#include <qgraphicsscene.h>
#include "reader.h"
#include <qdebug.h>
class MainAppClass: public QObject
{
    Q_OBJECT
public:
    MainAppClass()
    {
         QGraphicsScene *scene = new QGraphicsScene();;
         scene->setSceneRect( -100.0, -100.0, 200.0, 200.0 );

         MyItem *item = new MyItem(QPixmap("about.png"));
         connect(item, SIGNAL(clicked()), this, SLOT(pixmapClicked()));
         scene->addItem(item);

         QGraphicsView * view =  new QGraphicsView( scene );
         view->setRenderHints( QPainter::Antialiasing );
         view->show();
    }

public slots:
    void pixmapClicked()
    {
        qDebug() << "item clicked!" ;
    }
}; 
```

# java - CSV 文件和逗号内部值

> ID：14707481
> 
> 赞同：0
> 
> 时间：2013-02-05T12:23:21.743
> 
> 标签：java, csv, comma

> **可能重复：**
> [Java：拆分逗号分隔的字符串但忽略引号中的逗号](https://stackoverflow.com/questions/1757065/java-splitting-a-comma-separated-string-but-ignoring-commas-in-quotes)

有没有办法处理 csv 文件中的值内的逗号？

例如，如果有一个公司名称，Some Company, Inc.。通常的解析会将 company 和 Inc 之间的逗号解释为值之间的分隔符，这会抛出所有问题。

我无法控制 csv 文件——我需要按原样使用它。Java有解决方案吗？

编辑：可以在[这里找到解决方案](https://stackoverflow.com/questions/1757065/java-splitting-a-comma-separated-string-but-ignoring-commas-in-quotes)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T12:34:48.920

使用[OpenCSV](http://opencsv.sourceforge.net/)，这是一个广泛使用的处理 csv 格式的库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T12:27:34.227

如果 CSV 文件是通过引用生成的，您应该使用它们。否则，您必须创建一个工具，在处理文件之前根据一些可识别的模式自动转义逗号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T12:36:20.263

我通常使用用分号而不是逗号分隔的 csv 文件。基本上，csv 文件是带有分隔符的文本文件。您可以使用许多分隔符。例如，您可以通过创建一个文本文件来测试它，添加几个以分号分隔的项目，然后将文件扩展名更改为 csv。

[这是一个提供更多信息的链接](http://data-gov.tw.rpi.edu/wiki/CSV_files_use_delimiters_other_than_commas)

# ios - iPhone 应用程序会因为不支持 iPhone 5 屏幕尺寸而被拒绝吗？

> ID：14707482
> 
> 赞同：4
> 
> 时间：2013-02-05T12:23:21.840
> 
> 标签：ios, iphone, app-store

Apple 是否会拒绝新提交的不支持 iPhone 5 屏幕尺寸的 iPhone 应用程序，即在兼容模式下运行并根据 iPhone 4 的屏幕尺寸构建？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-05T12:26:46.190

~~不，这是没有必要的。您会在提交期间注意到[`http://itunesconnect.apple.com/`](http://itunesconnect.apple.com/)iPhone 5 (4 英寸视网膜) 的屏幕截图是可选的。~~

**更新：**

现在需要 4 英寸视网膜屏幕截图才能在 Apple AppStore 上提交 iPhone 应用程序。意味着现在您必须在您提交给苹果商店的每个新应用程序中支持 iPhone 5，当您向现有应用程序提交新版本时。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T12:24:58.663

不，它不会被拒绝。App Store 可以接受。不用担心。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T12:29:52.713

不会因为这个原因被拒绝。B'coz，它在 iPhone 5 上也能很好地工作，除了顶部和底部的黑色斑块。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T12:41:57.283

没有必要，所有的应用程序都必须兼容 iPhone5。其中一些可能仅适用于 iPhone 4 或 4s。然后它也可以在 iPhone5 上使用，剩余屏幕的顶部和底部都有黑色补丁。

所以你的应用肯定会被苹果接受！

# asp.net-mvc - 实体模型，将模型分组到一个模型文件中

> ID：14707483
> 
> 赞同：0
> 
> 时间：2013-02-05T12:23:22.097
> 
> 标签：asp.net-mvc, entity-framework, model

我有以下代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;

using System.Data.Entity;

namespace MyTestWebsite.Models
{
    public class Page
    {
        public int Id { get; set; }
        public int AuthorUserId { get; set; }
        public string Title { get; set; }
        public string Description { get; set; }
        public string Content { get; set; }
        public bool Hidden { get; set; }
    }

    public class PageState
    {
        public int Id { get; set; }
        public string Type { get; set; }
    }

    public class MyTestWebsiteDBContext : DbContext
    {
        public DbSet<Page> Pages { get; set; }
        public DbSet<PageState> PageStates { get; set; }
    }
} 
```

我去为 Page 创建一个控制器，我发现模型结构..没问题。

也就是说，我需要另一个名为 PageState 的模型，而我的模型列表没有显示第二个模型。

通常有大量模型......不管它们以某种方式链接吗？

我是否只添加一个名为 PageState 的模型？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T12:34:00.427

> 拥有大量模型是否很常见

是的，它们被称为视图模型。每个视图都应该有一个特定的视图模型。如果您有很多视图，那么拥有很多视图模型是完全正常的。视图模型可以聚合一个或多个 EF 域模型。

# c# - 如何转义 html.actionLinkstring.format 中的标签

> ID：14707484
> 
> 赞同：1
> 
> 时间：2013-02-05T12:23:30.827
> 
> 标签：c#, asp.net, asp.net-mvc

为了在可翻译文本中创建 URL，我们将`{0}`其用作占位符。

所以我们这样做：

```
@string.Format(@translationHelper.GetTranslation("label-ClickToContinue"),
    @Html.ActionLink(
        @translationHelper.GetTranslation("text-here"),
               "Login",
               new { Model.UserName, Model.UniqueId }
    )
) 
```

翻译键：

```
label-ClickToContinue = "Click {0} to continue"
text-here = "here" 
```

但这会将转义的字符串打印到源代码中：`&lt;a href="/Login/Login?UserName=alberttest3&amp;amp;UniqueId=f3647fed-bab4-4575-bb5f-98ed27edff43"&gt;label-RequestNewOfficeWizard&lt;/a&gt;`

如何确保它不会显示 html-tag，而是显示 URL？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T13:09:50.030

只需**将输出从`string.Format()`内部放入`Html.Raw()`**如下所示：

```
@Html.Raw(string.Format(@translationHelper.GetTranslation("label-ClickToContinue"),
       @Html.ActionLink(
            @translationHelper.GetTranslation("text-here"),
            "Login",
            new { Model.UserName, Model.UniqueId }
       )
)) 
```

翻译键：

```
label-ClickToContinue = "Click {0} to continue"
text-here = "here" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T12:28:39.313

ActionLink 帮助程序不支持此操作。它总是对文本进行 HTML 编码。您可以编写自己的不对文本进行编码的自定义助手，也可以简单地：

```
<a href="@Url.Action(Login, new { UserName, Model.UniqueId })">
    @Html.Raw(translationHelper.GetTranslation("text-here"))
</a> 
```

顺便说一句，现在我已经发布了这段代码，它看起来很丑。继续编写自定义助手：

```
public static class HtmlExtensions
{
    public static IHtmlString ActionLinkLocalized(
        this HtmlHelper html, 
        string translationText, 
        string actionName, 
        object routeValues
    )
    {
        var urlHelper = new UrlHelper(html.ViewContext.RequestContext);
        var anchor = new TagBuilder("a");
        anchor.Attributes["href"] = urlHelper.Action(actionName, routeValues);
        anchor.InnerHtml = TranslationHelper.GetTranslation(translationText);
        return new HtmlString(anchor.ToString());
    }
} 
```

在您看来，简单地说：

```
@Html.ActionLinkLocalized("text-here", "Login", new { UserName, Model.UniqueId }) 
```

# jsp - 访问 JSP 时出现错误 403

> ID：14707488
> 
> 赞同：0
> 
> 时间：2013-02-05T12:23:34.733
> 
> 标签：jsp, http-status-code-403

下面是我的 index.jsp

```
<%@ page import="java.util.*" %>
<%!
static int counter=0;
%>
<%
session.setAttribute("counter","Counter-"+counter);
counter++;
for(int id=0;id<60;id++)
{
System.out.println(id+"\tRequest Is Being Processsed for :"+(String)session.getAttribute("counter"));
try{
Thread.sleep(1000);
}
catch(Exception e)
{
e.printStackTrace();
}
}
out.println("<h2>Request Processing Completed");
%> 
```

当我从浏览器点击应用程序时，出现以下异常。

错误 403——来自 RFC 2068 超文本传输​​协议的禁止——HTTP/1.1：10.4.4 403 禁止

> 服务器理解请求，但拒绝执行。授权将无济于事，并且不应重复请求。如果请求方法不是 HEAD 并且服务器希望公开请求未完成的原因，它应该在实体中描述拒绝的原因。当服务器不希望确切地揭示请求被拒绝的原因或没有其他响应适用时，通常使用此状态代码。

需要帮助解决这个问题，还需要知道为什么会出现错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T14:14:41.473

未正确构建部署的战争文件导致此问题

# php - 使用 AJAX 将 jquery 数组传递给 PHP

> ID：14707492
> 
> 赞同：0
> 
> 时间：2013-02-05T12:23:42.300
> 
> 标签：php, jquery, ajax, arrays

将 jQuery 数组发送到 PHP 文件时有点问题。我在这里查看了类似的问题，但我的数据变量还有其他元素正在发送。这是代码：

```
var data = 'type='+e+'&offset=' + all_dates_offset + '&filters=' + filters;
$.ajax({
    url: "pos_jobs.php", 
    type: "POST", 
    cache: false,
    data:data,
    dataType:"json",
    success: function(html){
        //Do Something
    }
}); 
```

对于数据，“e”和“all_dates_offset”是标准变量，而“filters”是一个数组。在 PHP 方面，我希望我可以只使用 $_POST['filters'][0] 之类的东西，但这会返回一个空值。

有任何想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T12:28:53.850

```
$.ajax({
    url: "pos_jobs.php", 
    type: "POST", 
    data: {type: e, offset: all_dates_offset, filters: filters},
    dataType:"json"
}).done(function(data) {
    //do something
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T12:30:05.367

在下面使用

`$.ajax({ url: "pos_jobs.php", type: "POST", cache: false, data:{'type':e,'offset':all_dates_offset,'filters':filters}, dataType:"json", success: function(html){ //Do Something } });`

# android - android - 试图检测任何 NFC 标签

> ID：14707493
> 
> 赞同：0
> 
> 时间：2013-02-05T12:23:43.900
> 
> 标签：android, nfc

我得到了一张带有未知类型 NFC 标签的塑料卡，当我用它触摸我的 Nexus 7 时，会发出短暂的声音，仅此而已。我很好奇我是否可以对我的应用程序中的 NFC 标签做出反应，因此我为我的 Activity 声明了以下过滤器，因为我不知道标签的类型：

```
 <intent-filter>
            <action android:name="android.intent.action.MAIN" />
    <action android:name="android.nfc.action.NDEF_DISCOVERED" />
            <action android:name="android.nfc.action.TECH_DISCOVERED" />
            <action android:name="android.nfc.action.TAG_DISCOVERED" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter> 
```

但是当我触摸标签时它什么也没做。它也不会对 XPERIA 智能标签做出反应。我错过了什么？可以在不知道标签类型的情况下检测 NFC 标签吗？我的意思是在检测到标签触摸时执行相同的简单操作（例如设置文本）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:25:50.710

而不是`<category android:name="android.intent.category.LAUNCHER" />`你需要使用`<category android:name="android.intent.category.DEFAULT"/>`.

# windows-phone-7 - 键盘处于活动状态时，ScrollViewer 不会向上滚动

> ID：14707496
> 
> 赞同：4
> 
> 时间：2013-02-05T12:23:53.407
> 
> 标签：windows-phone-7

如何在 Windows Phone 中获取表单行为，例如设置>>移动网络>> EditAPN。在此页面中，它在滚动查看器中有许多文本框。当用户点击任何文本框并获得焦点时，页面向上滚动并且标题保持不变并显示 SIP 键盘。当用户从该文本框中失去焦点时，页面将恢复正常状态，SIP 键盘隐藏，标题保持不变。我想实现这种行为。我搜索了很多，但没有得到任何解决方案。奇怪的是在 WP7 中看到滚动查看器的行为。任何帮助都将是巨大而可观的。提前致谢。注意：如果有任何棘手的解决方案，请提供示例代码。

这是我的示例代码。

```
<Grid x:Name="ContentPanel" Grid.Row="1" >
            <ScrollViewer x:Name="Scroller">
                <StackPanel Orientation="Vertical">

                    <TextBlock Text="Name"/>
                    <TextBox x:Name="txtName" />
                    <TextBlock Text="Email"/>
                    <TextBox x:Name="txtEmail"/>
                    <TextBlock Text="Phone"/>
                    <TextBox x:Name="txtPhone" />
                    <TextBlock Text="Adress"/>
                    <TextBox x:Name="txtAddress" />                 

                </StackPanel>
            </ScrollViewer>
        </Grid> 
```

当我尝试向下滚动时，它并没有完全向下移动，并且似乎具有弹性。

编辑：这个例子，我已经看过了，对我来说没用。我有 4 个文本框，我的重点是第一个文本框，键盘出现并隐藏最后一个文本框。如果用户想要转到最后一个文本框并想要输入输入，它不会完全滚动并且具有弹性。因为这个用户必须按下屏幕的其他部分，然后他在最后一个框中输入。我在设置 -> 移动网络 -> EditAPN 中的 WP7 应用程序中看到。有 4-5 个文本框，它们可以完美滚动。不知道 MSFT 使用了哪个控件或解决方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T13:11:37.930

也许我错了，但为什么不使用简单的网格和 listpicker 控件。为此，您将需要 Windows Phone 工具包（Nuget [Here](http://nuget.org/packages/silverlighttoolkitwp)）。

网格的第一行包含标题并且不会更改。第二行包含你想要的（scrollview、listpicker、...）

这是一个非常基本的示例：

```
<phone:PhoneApplicationPage 
    x:Class="PhoneApp3.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:phone="clr-namespace:Microsoft.Phone.Controls;assembly=Microsoft.Phone"
    xmlns:shell="clr-namespace:Microsoft.Phone.Shell;assembly=Microsoft.Phone"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d" d:DesignWidth="480" d:DesignHeight="768"
    FontFamily="{StaticResource PhoneFontFamilyNormal}"
    FontSize="{StaticResource PhoneFontSizeNormal}"
    Foreground="{StaticResource PhoneForegroundBrush}"
    xmlns:toolkit="clr-namespace:Microsoft.Phone.Controls;assembly=Microsoft.Phone.Controls.Toolkit"
    SupportedOrientations="Portrait" Orientation="Portrait"
    shell:SystemTray.IsVisible="True">
    <!--LayoutRoot is the root grid where all page content is placed-->
    <Grid x:Name="LayoutRoot" Background="Transparent">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!--TitlePanel contains the name of the application and page title-->
        <StackPanel x:Name="TitlePanel" Grid.Row="0" Margin="12,17,0,28">
            <TextBlock x:Name="PageTitle" Text="MY HEADER" Margin="9,-7,0,0" Style="{StaticResource PhoneTextTitle1Style}"/>
        </StackPanel>

        <Grid x:Name="ContentPanel" Grid.Row="1">
            <toolkit:ListPicker>
                <toolkit:ListPickerItem Content="aaa" />
                <toolkit:ListPickerItem Content="bbb" />
                <toolkit:ListPickerItem Content="ccc" />
            </toolkit:ListPicker>
        </Grid>
    </Grid>
</phone:PhoneApplicationPage> 
```

**编辑 ：**

*呈现 SIP 键盘时，PhoneApplicationFrame.TranslateTransform.Y 设置为特定值（横向为 -259，纵向为 -339）。要更新布局，我们只需将上边距设置为指定的值 (-s)，然后 Silverlight 布局系统将修复该问题。*

这个[例子](http://sorokoletov.com/2011/08/windows-phone-70-handling-text-entry-screens/)可以帮助你。

# javascript - Safari 在表格中计算错误的宽度

> ID：14707499
> 
> 赞同：0
> 
> 时间：2013-02-05T12:24:04.757
> 
> 标签：javascript, html, css, safari, html-table

我正在为 HTML 表格开发一个简单的列调整大小功能。

到目前为止，该表工作正常 - **Safari 除外**（版本 5.1.4）。出于某种原因，Safari 将单元格宽度设为负值（！）。

此处提供 JSFiddle：[simple-resize](http://jsfiddle.net/sangil/kcAUM/)

`style="width"`如果从`<th>`元素中删除属性（或在代码检查器中禁用），则可以看到负列宽值

**HTML：**

```
<div class="tblcont" id="cont">
<table id="table1" class="pivot-table pivot-fixed-layout">
    <thead>
        <tr id="tr1">
            <th style="width: 52px;">city</th>
            <th style="width: 26px;"># c</th>
            <th style="width: 37px;"># id</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Tel Aviv</td>
            <td>814</td>
            <td>1,047</td>
        </tr>
        <tr>
            <td>Natanya</td>
            <td>805</td>
            <td>1,016</td>
        </tr>
    </tbody>
    </table>
</div> 
```

**CSS：**

```
.pivot-table.pivot-fixed-layout {
  border-collapse: collapse;
  table-layout: fixed;
  width: 0;
}

.pivot-table td, .pivot-table th {
  overflow: hidden;
  padding: 0 6px;
  border-right: 1px solid;
  border-bottom: 1px solid;
  text-overflow: ellipsis;
}

.pivot-table th {
    cursor: col-resize;
} 
```

**Javascript：**

```
var pressed = false,
    $column,
    $table = $("table"),
    startX, startWidth,
    tableInitialWidth = $('#cont').width() - 100,
    currentTableWidth, newTableWidth;

$("table th").mousedown(function(e) {
    $column = $(this);
    pressed = true;
    startX = e.pageX;
    startWidth = $column.width();
    $column.addClass("resizing");
});

$(document).mousemove(function(e) {
    if(pressed) {

        var delta = e.pageX - startX,
            currentColumnWidth,
            newColumnWidth;

        currentColumnWidth = $column.width();
        newColumnWidth = startWidth + delta;

        currentTableWidth = $table.width();
        newTableWidth = currentTableWidth + delta;

        // no not make columns smaller than min width
        if (newColumnWidth > 2) {
            $column.width(newColumnWidth);
        }
    }
});

$(document).mouseup(function() {
    if(pressed) {
        $column.removeClass("resizing");
        pressed = false;
    }
}); 
```

# python - 如何在模块和主模块中使用相对导入

> ID：14707500
> 
> 赞同：0
> 
> 时间：2013-02-05T12:24:12.787
> 
> 标签：python, python-2.7, import

我在python中有以下库设置：

```
library
  | - __init__.py
  | - lib1.py
  | - ...
  | - tools
        | - __init__.py
        | - testlib1.py 
```

所以换句话说，该目录`library`包含python模块和目录`tools`，它是一个子目录，`library`包含例如一个`testlib1.py`用于测试库的文件`lib1.py`。

`testlib1.py`因此需要`lib1.py`从上面的目录导入来做一些测试等，只需`python testlib1.py`从计算机上的某个地方调用，假设文件在搜索路径中。另外，我只想`PYTHONPATH`指定一个。

但是我们都知道下面的想法 for`testlib1.py`是行不通的，因为相对导入是行不通的：

```
from .. import lib1
...
do something with lib1 
```

我接受两种答案：

1.  一个答案，它描述了如何仍然可以`testlib1.py`直接调用作为正在执行的 python 脚本。
2.  一个解释模块等概念设置的更好的答案，前提是所有内容都必须位于目录中`project`，并且工具必须位于与实际库*不同的目录中。*

如果有不清楚的地方，我建议问，我会更新问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T12:33:51.667

尝试将 a 添加`__init__.py`到`tools`目录中。相对导入应该有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T12:49:48.927

你不能。如果您打算使用相对导入，那么您*不能*单独运行该模块。要么放弃相对导入，要么放弃`testlib1.py`直接运行的想法。

另外我相信测试文件不应该使用相对导入。测试应该检查库是否工作，因此代码应该尽可能地与用户实际使用的代码相似。并且通常用户不会将文件添加到库中以使用相对导入，而是使用绝对导入。

顺便说一句，我认为您的文件组织过于“类 java”：混合源代码和测试。如果您想进行测试，那么为什么不使用以下内容：

```
project/
   |
   +-- src/
   |    |
   |    +--library/
   |    |     |
   |    |     +- lib1.py
   |    |     |
   |    |    #...
   |    +--library2/ #etc.
   |
   +-- tests/
        |
        +--testlibrary/
        |      |
        |      +- testlib1.py
        #etc 
```

要运行测试，只需使用一个工具`nosetests`，它会自动查找这种文件夹结构并提供大量选项来更改搜索/测试设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T18:27:33.797

实际上，我找到了一个解决方案，它确实

1.  与当前实现一起工作
2.  不需要任何更改`PYTHONPATH`
3.  无需硬编码 top-lebel 目录

在`testlib1.py`下面的代码中会做（已经测试）：

```
import os
import sys
dirparts = os.path.dirname(os.path.abspath(__file__)).split('/')
sys.path.append('/'.join(dirparts[:-1]))

import  mylib1 
```

不完全确定这是一个非常干净或直接的解决方案，但它允许从上一级目录导入任何模块，这是我所需要的（因为测试代码或额外代码或无论是否始终位于实际模块的下一级文件）。

# uitableview - 无法连接 UITableViewCell 自定义单元格 IBOutlet

> ID：14707501
> 
> 赞同：0
> 
> 时间：2013-02-05T12:24:13.773
> 
> 标签：uitableview, interface-builder, iboutlet

我正在尝试连接 UITableViewCell IBOutlet。我在界面生成器中制作了一个 UITableView 单元格，

```
 @interface ViewController : UIViewController<UITableViewDataSource,UITableViewDelegate>
     {    
         IBOutlet UITableView *tableView;
         IBOutlet UITableViewCell *customCell;
     } 
```

尝试将新的引用出口连接到文件所有者时，没有显示连接（没有显示连接的项目）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T12:46:56.203

我不确定你做了什么？但是您的问题似乎与 xib 文件的文件所有权有关。可能是您单独创建了 xib 并忘记将所有权设置为您尝试从中获取建议的标头。**如果这是问题所在，您可以通过右 nib 助手窗格（左起第三个）中的身份检查器来检查它，并检查它是什么自定义类。**如果它不是 ViewController 那就是你的问题。将其设置为 ViewController（文件所有者的类名），清理并构建。我希望这会有所帮助。

# visual-studio-extensions - Visual Studio 2010 插件 - 如何在错误列表窗口中添加错误

> ID：14707507
> 
> 赞同：2
> 
> 时间：2013-02-05T12:24:26.580
> 
> 标签：visual-studio-extensions

我在 Visual Studio 2010 中创建了一个插件。该插件访问所有 .cs 文件并验证代码。

现在我的要求是显示错误/警告。我想在 Visual Studio 错误列表窗口中显示它。

我用谷歌搜索了一天，但没有成功。所以任何人都可以给我一个解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T11:49:57.053

这就是您需要[的：写入 VS ErrorList](http://vsxexperience.net/2010/03/23/writing-to-the-vs-errorlist/)

# c++ - 静态链接 C++ 2010 失败

> ID：14707514
> 
> 赞同：0
> 
> 时间：2013-02-05T12:24:40.607
> 
> 标签：c++

我的目标是通过静态链接来避免安装 Microsoft C++ 2010。因为我不知道该软件包是否会安装在所有客户计算机上，而且他的 IT 部门不允许安装软件。

另一种选择是避免使用管理特权。（例如，在与我的程序相同的目录中提取 dll）

我找到了一种可能的解决方案[http://social.msdn.microsoft.com/Forums/en-US/vclanguage/thread/ab187afb-3af0-44ba-a03c-dde9e5208a1a/](http://social.msdn.microsoft.com/Forums/en-US/vclanguage/thread/ab187afb-3af0-44ba-a03c-dde9e5208a1a/)并尝试了参数 /MT。

我有 2 个错误：

> Erreur 1 错误 LNK2019: symbole externe non rÚsolu __CrtDbgReportW rÚfÚrencÚ dans la fonction "void __cdecl std::_Debug_message(wchar_t const *,wchar_t const *,unsigned int)" (?_Debug_message@std@@YAXPB_W0I@Z) C:\Users\ philippe\Downloads\Portable Devices COM API Sample\C++\libcpmtd.lib(stdthrow.obj) WpdApiSample
> 
> Erreur 2 错误 LNK1120: 1 externes non rÚsolus C:\Users\philippe\Downloads\Portable Devices COM API Sample\C++\Debug\WpdApiSample.exe 1 1 WpdApiSample

我的方式好吗？我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T12:32:56.610

`_CrtDbgReportW`“要求”部分的文档说：

> **库：**仅限 C 运行时库的调试版本。

这意味着此类函数在库的发布版本中不存在，因此，您的代码的发布版本不应调用它们。

根据[**此表**](http://msdn.microsoft.com/en-us/library/2kzt1wy3.aspx)，您可能会使用`/MTd`，以便您将链接到静态调试版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T12:37:53.350

/MT 用于发布配置，/MTd 用于调试

# hibernate - MassIndexer 操作期间出错：分离实体传递给持久化，HSEARCH000058：HSEARCH000116

> ID：14707521
> 
> 赞同：1
> 
> 时间：2013-02-05T12:25:09.077
> 
> 标签：hibernate, jpa, lucene, indexing, hibernate-search

我在massindexer 操作期间遇到了问题。

我使用 JPA 2.0-cr-1、Hibernate search 4.2.0.Final 和 hibernate 4.1.9.Final 和 lucene 版本 3.6.2。我也使用弹簧框架。

自从我使用 Hibernate search 4.2.0.Final 代替 Hibernate search 3.3.0.Final 后，我似乎遇到了问题。

我索引实体 User.java ：

```
@Entity
@Table(name = "user", uniqueConstraints = {
    @UniqueConstraint(columnNames = "email"),
    @UniqueConstraint(columnNames = "login") })
@Indexed
@FullTextFilterDefs({
@FullTextFilterDef(name = "userFilterGroup", impl = UserFilterGroupFactory.class   ,cache=FilterCacheModeType.NONE),
@FullTextFilterDef(name = "userFilterAccountType", impl = LuceneStrFilterFactory.class ,cache=FilterCacheModeType.NONE)})
public class User extends TemporalBehavior implements java.io.Serializable {

/**
 * 
 */
private static final long serialVersionUID = -626437341655804022L;

public static final String[] SEARCH_FIELDS = new String[]{"id","login","email","profile.lastname","profile.firstname"};

private Integer id;

@Field(index=Index.YES, analyze=Analyze.YES, store=Store.NO)
@NotNull
@Size(min=1, max=255)
//@Size(min=6, max=255) //L'ancienne plateforme permet des login min=1
private String login;

@NotNull
@Size(min=1, max=255)
//@Size(min=6, max=255) //L'ancienne plateforme permet des pass min=1
private String password;

@Field(index=Index.YES, analyze=Analyze.YES, store=Store.NO)
@Email
private String email;

@Field(index=Index.YES, analyze=Analyze.YES, store=Store.NO)
private String partnerRef;

private Set<Contract> contracts = new HashSet<Contract>(0);
private Set<Contract> ownedContracts = new HashSet<Contract>();

    ....
    @ManyToMany(fetch = FetchType.LAZY, cascade=CascadeType.PERSIST)
@JoinTable(name = "user_contract", joinColumns = { @JoinColumn(name = "user_id", nullable = false, updatable = false) }, inverseJoinColumns = { @JoinColumn(name = "contract_id", nullable = false, updatable = false) })
public Set<Contract> getContracts() {
    return this.contracts;
}

    @OneToMany(mappedBy="owner")
public Set<Contract> getOwnedContracts() {
    return this.ownedContracts;
}

    ...

    } 
```

我调用的 Massindexer 操作：

```
FullTextEntityManager fem = Search.getFullTextEntityManager(em);
    try {
        fem.createIndexer(User.class)
        .purgeAllOnStart(true)
        .optimizeAfterPurge( true )   
        .optimizeOnFinish( true )
        .batchSizeToLoadObjects(100)  
        .threadsForSubsequentFetching(8)  
        .threadsToLoadObjects(4)  
        .cacheMode(CacheMode.NORMAL)    // todo : It is recommended to leave cacheMode to CacheMode.IGNORE (the default), as in most reindexing situations the cache will be a useless additional overhead; 
        .startAndWait();
    } catch (InterruptedException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 
```

然后质量索引器完成它的工作，但有一些错误（不是所有用户数据）：

```
[05-02-2013 13:06:11:086] ERROR org.hibernate.search.exception.impl.LogErrorHandler  -   HSEARCH000058: HSEARCH000116: Unexpected error during MassIndexer operation
org.hibernate.PersistentObjectException: detached entity passed to persist:   com.mycompany.prj.model.commercial.Contract
at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:141)
at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:78)
at org.hibernate.tuple.entity.AbstractEntityTuplizer$IncrediblySillyJpaMapsIdMappedIdentifierValueMarshaller.getIdentifier(AbstractEntityTuplizer.java:491)
at org.hibernate.tuple.entity.AbstractEntityTuplizer.getIdentifier(AbstractEntityTuplizer.java:337)
at org.hibernate.persister.entity.AbstractEntityPersister.getIdentifier(AbstractEntityPersister.java:4491)
at org.hibernate.event.internal.DefaultLockEventListener.onLock(DefaultLockEventListener.java:73)
at org.hibernate.internal.SessionImpl.fireLock(SessionImpl.java:810)
at org.hibernate.internal.SessionImpl.fireLock(SessionImpl.java:799)
at org.hibernate.internal.SessionImpl.access$1700(SessionImpl.java:175)
at org.hibernate.internal.SessionImpl$LockRequestImpl.lock(SessionImpl.java:2361)
at org.hibernate.engine.spi.CascadingAction$2.cascade(CascadingAction.java:178)
at org.hibernate.engine.internal.Cascade.cascadeToOne(Cascade.java:383)
at org.hibernate.engine.internal.Cascade.cascadeAssociation(Cascade.java:326)
at org.hibernate.engine.internal.Cascade.cascadeProperty(Cascade.java:208)
at org.hibernate.engine.internal.Cascade.cascadeCollectionElements(Cascade.java:412)
at org.hibernate.engine.internal.Cascade.cascadeCollection(Cascade.java:353)
at org.hibernate.engine.internal.Cascade.cascadeAssociation(Cascade.java:329)
at org.hibernate.engine.internal.Cascade.cascadeProperty(Cascade.java:208)
at org.hibernate.engine.internal.Cascade.cascade(Cascade.java:165)
at org.hibernate.event.internal.DefaultLockEventListener.cascadeOnLock(DefaultLockEventListener.java:92)
at org.hibernate.event.internal.DefaultLockEventListener.onLock(DefaultLockEventListener.java:82)
at org.hibernate.internal.SessionImpl.fireLock(SessionImpl.java:810)
at org.hibernate.internal.SessionImpl.fireLock(SessionImpl.java:799)
at org.hibernate.internal.SessionImpl.access$1700(SessionImpl.java:175)
at org.hibernate.internal.SessionImpl$LockRequestImpl.lock(SessionImpl.java:2361)
at org.hibernate.engine.spi.CascadingAction$2.cascade(CascadingAction.java:178)
at org.hibernate.engine.internal.Cascade.cascadeToOne(Cascade.java:383)
at org.hibernate.engine.internal.Cascade.cascadeAssociation(Cascade.java:326)
at org.hibernate.engine.internal.Cascade.cascadeProperty(Cascade.java:208)
at org.hibernate.engine.internal.Cascade.cascade(Cascade.java:165)
at org.hibernate.event.internal.DefaultLockEventListener.cascadeOnLock(DefaultLockEventListener.java:92)
at org.hibernate.event.internal.DefaultLockEventListener.onLock(DefaultLockEventListener.java:82)
at org.hibernate.internal.SessionImpl.fireLock(SessionImpl.java:810)
at org.hibernate.internal.SessionImpl.fireLock(SessionImpl.java:803)
at org.hibernate.internal.SessionImpl.access$1800(SessionImpl.java:175)
at org.hibernate.internal.SessionImpl$LockRequestImpl.lock(SessionImpl.java:2364)
at org.hibernate.search.batchindexing.impl.EntityConsumerLuceneWorkProducer.indexAllQueue(EntityConsumerLuceneWorkProducer.java:133)
at org.hibernate.search.batchindexing.impl.EntityConsumerLuceneWorkProducer.run(EntityConsumerLuceneWorkProducer.java:104)
at org.hibernate.search.batchindexing.impl.OptionallyWrapInJTATransaction.run(OptionallyWrapInJTATransaction.java:132)
at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
at java.lang.Thread.run(Thread.java:680) 
```

任何想法 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T18:01:37.190

当您尝试保留其 ID 已存在的实体时，似乎会发生这种情况。如果您打算让 MassIndexer 在给出的错误中更新合同记录，那么我相信您可能希望将 CascadeType 注释更改为：（`CascadeType.ALL`或者可能`CascadeType.SAVE_UPDATE`）。

看看[这个问题](https://stackoverflow.com/questions/2441598/detached-entity-passed-to-persist-error-with-jpa-ejb-code)，它进一步讨论了这个异常。

# c# - 在 ac# webservice 中读取已发布的 XML 文件

> ID：14707524
> 
> 赞同：2
> 
> 时间：2013-02-05T12:25:10.700
> 
> 标签：c#, web-services, post, xml-parsing

我对 c# 中的 web 服务非常陌生。

我将 XML 发布到具有以下功能的 Web 服务中：

```
public static XmlDocument PostXMLTransaction(string URL, XmlDocument XMLDoc)
        {
            //Declare XMLResponse document
        XmlDocument XMLResponse = null;

        //Declare an HTTP-specific implementation of the WebRequest class.
        HttpWebRequest objHttpWebRequest;

    //Declare an HTTP-specific implementation of the WebResponse class
    HttpWebResponse objHttpWebResponse = null;

    //Declare a generic view of a sequence of bytes
    Stream objRequestStream = null;
    Stream objResponseStream = null;

    //Declare XMLReader
    XmlTextReader objXMLReader;

    //Creates an HttpWebRequest for the specified URL.
    objHttpWebRequest = (HttpWebRequest)WebRequest.Create(URL);

    try
    {
        //---------- Start HttpRequest

        //Set HttpWebRequest properties
        byte[] bytes;
        bytes = System.Text.Encoding.ASCII.GetBytes(XMLDoc.InnerXml);
        objHttpWebRequest.Method = "POST";
        objHttpWebRequest.ContentLength = bytes.Length;
        objHttpWebRequest.ContentType = "text/xml; encoding='utf-8'";

        //Get Stream object
        objRequestStream = objHttpWebRequest.GetRequestStream();

        //Writes a sequence of bytes to the current stream
        objRequestStream.Write(bytes, 0, bytes.Length);

        //Close stream
        objRequestStream.Close();

        //---------- End HttpRequest

        //Sends the HttpWebRequest, and waits for a response.
        objHttpWebResponse = (HttpWebResponse)objHttpWebRequest.GetResponse();

        //---------- Start HttpResponse
        if (objHttpWebResponse.StatusCode == HttpStatusCode.OK)
        {
            //Get response stream
            objResponseStream = objHttpWebResponse.GetResponseStream();

            //Load response stream into XMLReader
            objXMLReader = new XmlTextReader(objResponseStream);

            //Declare XMLDocument
            XmlDocument xmldoc = new XmlDocument();
            xmldoc.Load(objXMLReader);

            //Set XMLResponse object returned from XMLReader
            XMLResponse = xmldoc;

            //Close XMLReader
            objXMLReader.Close();
        }

        //Close HttpWebResponse
        objHttpWebResponse.Close();
    }
    catch (WebException we)
    {
        //TODO: Add custom exception handling
        throw new Exception(we.Message);
    }
    catch (Exception ex)
    {
        throw new Exception(ex.Message);
    }
    finally
    {
        //Close connections
        objRequestStream.Close();
        objResponseStream.Close();
        objHttpWebResponse.Close();

        //Release objects
        objXMLReader = null;
        objRequestStream = null;
        objResponseStream = null;
        objHttpWebResponse = null;
        objHttpWebRequest = null;
    }
    //Return
    return XMLResponse;
} 
```

现在如何将这个 XML 读入由 url 参数指定的 web 服务中的 XmlDocument。我不确定是否可以将数据发布到网络服务，如果我错了，请纠正我

我已经使用这种方法将 xml 发布到 aspx 页面而不是服务。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T07:24:24.053

我得到了解决方案

```
[WebMethod]
public string sendXliff()
{
    XmlDocument xmldoc = new XmlDocument();
    //if (Request.InputStream != null)
    if(HttpContext.Current.Request.InputStream!=null)
    {

        StreamReader stream = new StreamReader(HttpContext.Current.Request.InputStream);
        string xmls = stream.ReadToEnd();  // added to view content of input stream
        //XDocument xmlInput = XDocument.Parse(xmls);
        xmldoc.LoadXml(xmls);
        XmlReaderSettings settings = new XmlReaderSettings();
        settings.Schemas.Add(null, "XSD LOCATION");
        settings.ValidationType = ValidationType.Schema;
        XmlReader rdr = XmlReader.Create(new StringReader(xmldoc.InnerXml), settings);
        while (rdr.Read()) { }
    }
    try
    {
        XmlNodeList xmlnode = xmldoc.GetElementsByTagName("ID");
        var sid = xmlnode[0].FirstChild.Value;
    }
    catch (Exception ex)
    {
    }

    return "OK";
} 
```

这会读取输入流，然后将读取的数据转换为 XmlDocument。然后从这里我可以解析 XML。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T12:35:10.197

这是读取 XML 文档的简单示例。如果是单个节点，则使用[XmlNode](http://msdn.microsoft.com/en-us/library/system.xml.xmlnode.aspx)

```
XmlDocument xmldoc = PostXMLTransaction(string URL, XmlDocument XMLDoc) // call to your code for xml document
XmlNode node= xmldoc.SelectSingleNode("you xml node path here");
if(node != null)
{
   var str = node.InnerText;
} 
```

如果是节点列表，则使用[XmlNodeList](http://msdn.microsoft.com/en-us/library/system.xml.xmlnodeList.aspx)

```
XmlNodeList nodes = xmlDoc.SelectNodes("you xml node path here");
if(nodes != null)
{
    foreach (XmlNode node in nodes)
    {
         --code here
    }
} 
```

# c# - 如何在int数组中上下移动

> ID：14707526
> 
> 赞同：-4
> 
> 时间：2013-02-05T12:25:13.623
> 
> 标签：c#

我有以下数组：

```
int[] month = new int[12] { 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12 }; 
```

这代表了我一年中的几个月。

现在我有两个按钮和一个标签。标签应该只显示数组中当前项的值。当我按下下一个按钮时，它应该从例如移动。数组中的 5 到 6，现在在标签中显示 6。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T12:48:51.453

试试下面的代码，它会帮助你...

**将此数组设置为全局**

```
int[] month = new int[12] { 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12 }; 
```

**加载事件**

```
label1.Text = month[4].ToString(); 
```

**下一步按钮单击**

```
 int ind = Array.IndexOf<int>(month, Convert.ToInt32(label1.Text));
        if ((ind + 1) != 12)
            label1.Text = month[ind + 1].ToString();
        else
            MessageBox.Show("End of the Array element"); 
```

**上一个按钮 单击**

```
 int ind = Array.IndexOf<int>(month, Convert.ToInt32(label1.Text));
            if ((ind - 1) != -1)
                label1.Text = month[ind - 1].ToString();
            else
                MessageBox.Show("End of the Array element"); 
```

# javascript - 为什么这个 JavaScript 属性返回空字符串，而 JavaScript 函数工作正常？

> ID：14707532
> 
> 赞同：4
> 
> 时间：2013-02-05T12:25:27.753
> 
> 标签：javascript, properties, closures, getter-setter

考虑这个简单的 JavaScript 模块模式：

```
var human = (function () {
    var _name = '';
    return {
        name: _name,
        setName: function (name) {
            _name = name;
        }
    }
})();
human.setName('somebody');
alert(human.name); // shows an empty string
human = (function () {
    var _name = '';
    return {
        name: function() {
            return _name;
        },
        setName: function (name) {
            _name = name;
        }
    }
})();
human.setName('somebody');
alert(human.name()); // shows 'somebody' 
```

为什么第二个关闭工作正常，而第一个关闭不工作？[请参见此处](http://jsfiddle.net/NxPFA/)的示例。

另请参阅[这个 fiddle](http://jsfiddle.net/afxVK/)，它证明可以使用简单的属性来代替 getter 函数。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-05T12:29:15.137

在 Javascript 中

*   字符串和原始类型（布尔和数字）按值传递
*   对象、数组和函数通过引用传递

由于 name 是一个字符串`name: _name`，它将存储 的当前值`_name`而不是对 的引用`_name`。

`setName`在您的示例中将仅修改`_name`.

`getName`将访问`_name`保存当前值的内容。

`.name`将访问在初始化期间设置的复制值 ( `name: _name`)。

另见[SO：Javascript by reference vs. by value](https://stackoverflow.com/questions/6605640/javascript-by-reference-vs-by-value)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T12:29:39.190

试试这个：

```
var human = (function () {
    var _name = '';
    var returnObj = {};
    returnObj.name = _name;
    returnObj.setName = function (name) {
        _name = name;
        returnObj.name = name;
    };

    return returnObj;
})();
human.setName('somebody');
alert(human.name); 
```

您的代码的问题在于`setName`为`_name`变量分配了一个值，并且您正在访问`name`返回对象的属性。

# jquery - jquery获取内部类的特定html？

> ID：14707533
> 
> 赞同：-2
> 
> 时间：2013-02-05T12:25:35.797
> 
> 标签：jquery, class, innerhtml

```
var myhtml= '<td class="dataCell"><table border="0" bordercolor="#FFFFFF" cellpadding="0" cellspacing="0" width="100%"><tbody><tr bgcolor="#FFFFFF"><td><div align="right">1.</div></td><td>Kabul Edildi - İZMİR(ÇAMDİBİ/ÇAMDİBİ)</td><td><div>04/02/2013 16:06:16</div></td></tr><tr><td><div align="right">2.</div></td><td>Torbaya Eklendi - İZMİR(ÇAMDİBİ/ÇAMDİBİ)</td><td><div>04/02/2013 16:09:33</div></td></tr><tr bgcolor="#FFFFFF"><td><div align="right">3.</div></td><td>Gönderinin Geliş Kaydı Yapıldı - İZMİR(İZMİR K.İ.M/MERKEZ)</td><td><div>04/02/2013 18:01:35</div></td></tr><tr><td><div align="right">4.</div></td><td>Torbaya Eklendi - İZMİR(İZMİR K.İ.M/MERKEZ)</td><td><div>04/02/2013 18:52:15</div></td></tr><tr bgcolor="#FFFFFF"><td><div align="right">5.</div></td><td>Gönderinin Geliş Kaydı Yapıldı - AYDIN(AYDIN POS.DAG.VE TOP/AYDIN POS.DAG.VE TOP)</td><td><div>05/02/2013 02:22:20</div></td></tr><tr><td><div align="right">6.</div></td><td>Torbaya Eklendi - AYDIN(AYDIN POS.DAG.VE TOP/AYDIN POS.DAG.VE TOP)</td><td><div>05/02/2013 02:35:34</div></td></tr><tr bgcolor="#FFFFFF"><td><div align="right">7.</div></td><td>Gönderinin Geliş Kaydı Yapıldı - AYDIN(SÖKE/SÖKE)</td><td><div>05/02/2013 09:27:41</div></td></tr></tbody></table></td>';
$('#siptakip_1360003997').html($('.dataCell', myhtml)); // ->not work....
$('#siptakip_1360003997').html(jQuery(myhtml).find('.dataCell').html()); // ->not work.... 
```

为什么我的 Jquery 代码不起作用？我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T12:38:06.233

你想做什么？？

这可能会有所帮助...

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script type="text/javascript" src="js/jquery.js"></script>
<script>
    $(function(){
        var myhtml= '<td class="dataCell"><table border="0" bordercolor="#FFFFFF" cellpadding="0" cellspacing="0" width="100%"><tbody><tr bgcolor="#FFFFFF"><td><div align="right">1.</div></td><td>Kabul Edildi - İZMİR(ÇAMDİBİ/ÇAMDİBİ)</td><td><div>04/02/2013 16:06:16</div></td></tr><tr><td><div align="right">2.</div></td><td>Torbaya Eklendi - İZMİR(ÇAMDİBİ/ÇAMDİBİ)</td><td><div>04/02/2013 16:09:33</div></td></tr><tr bgcolor="#FFFFFF"><td><div align="right">3.</div></td><td>Gönderinin Geliş Kaydı Yapıldı - İZMİR(İZMİR K.İ.M/MERKEZ)</td><td><div>04/02/2013 18:01:35</div></td></tr><tr><td><div align="right">4.</div></td><td>Torbaya Eklendi - İZMİR(İZMİR K.İ.M/MERKEZ)</td><td><div>04/02/2013 18:52:15</div></td></tr><tr bgcolor="#FFFFFF"><td><div align="right">5.</div></td><td>Gönderinin Geliş Kaydı Yapıldı - AYDIN(AYDIN POS.DAG.VE TOP/AYDIN POS.DAG.VE TOP)</td><td><div>05/02/2013 02:22:20</div></td></tr><tr><td><div align="right">6.</div></td><td>Torbaya Eklendi - AYDIN(AYDIN POS.DAG.VE TOP/AYDIN POS.DAG.VE TOP)</td><td><div>05/02/2013 02:35:34</div></td></tr><tr bgcolor="#FFFFFF"><td><div align="right">7.</div></td><td>Gönderinin Geliş Kaydı Yapıldı - AYDIN(SÖKE/SÖKE)</td><td><div>05/02/2013 09:27:41</div></td></tr></tbody></table></td>';
        $('#siptakip_1360003997').html(myhtml);
    });
</script>
<title>Untitled Document</title>
</head>

<body>

<table>
    <tr id="siptakip_1360003997"></tr>
</table>

</body>
</html> 
```

# iis - 一个重定向来统治他们

> ID：14707535
> 
> 赞同：0
> 
> 时间：2013-02-05T12:25:36.847
> 
> 标签：iis, redirect, url-rewriting, seo, url-redirection

在尝试[帮助 iis.net 论坛上的一位开发人员](http://forums.iis.net/t/1195459.aspx/1?Going+crazy+with+trailing+slash+and+double+redirects)后，我开始寻找一种更好的方式来进行重定向。因此，我结束了[这篇文章。](http://www.seomoz.org/blog/what-every-seo-should-know-about-iis#chaining)

我接受了很多这些想法并开始实现我自己的版本。一切似乎都很好，但我在路上遇到了一个颠簸，我希望你能提供帮助。

好的，快速解释一下我的规则：

我的想法是测试 url，如果我发现它有问题，我会重写 url 并让它继续，而不是立即重定向它。如果在任何时候我重写了 url，我将自定义服务器变量“重定向”设置为 true。然后最后，我测试我的自定义服务器变量是否为真并重定向用户。

它的重点是只有一个 301 重定向，而不是一系列重定向。

这些是我的规则（对不起墙）：

```
<rules>
  <rule name="WhiteList - resources" stopProcessing="true">
    <match url="^resources/" />
    <conditions logicalGrouping="MatchAll" trackAllCaptures="false" />
    <action type="None" />
  </rule>

  <rule name="Redirect subdomains with www to non-www" stopProcessing="false">
    <match url="(.*)" />
    <conditions logicalGrouping="MatchAll" trackAllCaptures="false">
      <add input="{HTTP_HOST}" pattern=".*localhost.*" negate="true" />
      <add input="{HTTP_HOST}" pattern="^www\.(.*)\.([^\.]+)\.([^\.]+)$" />
    </conditions>
    <action type="Rewrite" url="http://{C:1}.{C:2}.{C:3}{HTTP_URL}" />
    <serverVariables>
      <set name="Redirect" value="true" />
    </serverVariables>
  </rule>
  <rule name="Redirect top domains with non-www to www" stopProcessing="false">
    <match url="(.*)" />
    <conditions logicalGrouping="MatchAll" trackAllCaptures="false">
      <add input="{HTTP_HOST}" pattern=".*localhost.*" negate="true" />
      <add input="{HTTP_HOST}" pattern="^([^\.]+)\.([^\.]+)$" />
    </conditions>
    <action type="Rewrite" url="http://www.{HTTP_HOST}{HTTP_URL}" />
    <serverVariables>
      <set name="Redirect" value="true" />
    </serverVariables>
  </rule>

  <rule name="SEO - Remove trailing slash" stopProcessing="false">
    <match url="(.*)/$" />
    <conditions>
      <add input="{REQUEST_FILENAME}" matchType="IsFile" negate="true" />
      <add input="{REQUEST_FILENAME}" matchType="IsDirectory" negate="true" />
    </conditions>
    <action type="Rewrite" url="{R:1}" />
    <serverVariables>
      <set name="Redirect" value="true" />
    </serverVariables>
  </rule>
  <rule name="SEO - ToLower" stopProcessing="false">
    <match url="(.*)" ignoreCase="false" />
    <conditions logicalGrouping="MatchAll" trackAllCaptures="false">
      <add input="{URL}" pattern="[A-Z]" ignoreCase="false" />
      <add input="{URL}" pattern="^.*?\.(axd|css|js|jpg|jpeg|png|gif|ashx|asmx|svc).*?$" negate="true" />
      <add input="{URL}" pattern="^.*/(webshop)/.*$" negate="true" />
    </conditions>
    <action type="Rewrite" url="{ToLower:{R:1}}" />
    <serverVariables>
      <set name="Redirect" value="true" />
    </serverVariables>
  </rule>
  <rule name="SEO - remove default.aspx" stopProcessing="false">
    <match url="(.*?)/?default\.aspx$" />
    <action type="Rewrite" url="{R:1}" />
    <serverVariables>
      <set name="Redirect" value="true" />
    </serverVariables>
  </rule>
  <rule name="SEO - Trim aspx" stopProcessing="false">
    <match url="(.*)\.aspx$" />
    <action type="Rewrite" url="{R:1}" />
    <serverVariables>
      <set name="Redirect" value="true" />
    </serverVariables>
  </rule>

  <rule name="SEO - non-canonical redirect" stopProcessing="true">
    <match url="^(.*)" />
    <conditions>
      <add input="{Redirect}" pattern="true" />
    </conditions>
    <action type="Redirect" url="{R:1}" />
    <serverVariables>
      <set name="Redirect" value="false" />
    </serverVariables>
  </rule>
</rules> 
```

现在它的大部分实际上工作得很好，但我似乎对裸域有一些问题。

如果我使用带有 www 的子域（应该重定向到非 www），那么它似乎失败了。有趣的是，如果我转到子页面，它可以正常工作。

（我不能发布更多的网址，因为我是新来的：（我想感谢其他人让我开始做这件事。）

我已经将它追溯到服务器变量`{HTTP_URL}`，因为如果我删除它，它不会失败。然而，它当然也没有做它应该做的事情（它总是重定向到裸域）。我尝试了各种变量：`{URL}`，`{REQUEST_URI}`它们似乎都以相同的错误结束，这有点烦人。

如果有人对规则有一些改进，请随时回复，我喜欢与他们合作，我想做出近乎完美的重定向，所以欢迎任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-09-30T08:44:35.887

这最终更像是版本 1，我已经对其进行了改进以避免服务器变量。现在我使用一系列重写规则将 url 转换为我喜欢的内容，并附加下划线。然后剥离下划线，然后重定向。很长一段时间以来，它对我来说效果很好，公司几乎在所有项目中都在使用它。它已被制成一个 nuget 包，以便于设置。 [http://www.nuget.org/packages/RedirectRules/](http://www.nuget.org/packages/RedirectRules/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T16:13:46.417

我相信我现在真的找到了答案。我解决了一段时间，最后又遇到了另一个问题，再次是 www 与非 www。它根本没有做任何事情。

所以我最终把它放在最后并进行重定向而不是重写。显然这很好用，为什么？不知道。

cheesemacfly 建议我匹配 on`^(.+)$`而不是`(.*)`. 我认为它会做同样的事情，但意识到匹配根本不在主机名上，它是之后的一切。对我来说是一个很大的惊喜，但它确实开辟了一个新的可能性：

`{URL}`我可以简单地使用 match 来引用 match ，而不是 match`{HTTP_URL}`或几乎相同事物的其他变体`{R:1}`

自从第一篇文章以来，我已经放了两件事。我在某些规则上设置了条件以排除它们，如果它包含“umbraco”，因为我使用该系统以及我不想应用于后端的大多数规则。我还为 SSL 检查应用了重写映射，因此它会自动将您置于`https://`或`http://`使用服务器变量`{HTTPS}`

到目前为止，我还没有发现任何错误，所以我会将其标记为已解决，并为您提供我对规则的最新修订。享受 ：）

```
<rewrite>
    <rules>
        <rule name="WhiteList - resources" stopProcessing="true">
            <match url="^resources/" />
            <conditions logicalGrouping="MatchAll" trackAllCaptures="false" />
            <action type="None" />
        </rule>
        <rule name="SEO - Remove trailing slash" stopProcessing="false">
            <match url="(.*)/$" />
            <conditions>
                <add input="{REQUEST_FILENAME}" matchType="IsFile" negate="true" />
                <add input="{REQUEST_FILENAME}" matchType="IsDirectory" negate="true" />
            </conditions>
            <action type="Rewrite" url="{R:1}" />
            <serverVariables>
                <set name="Redirect" value="true" />
            </serverVariables>
        </rule>
        <rule name="SEO - ToLower" stopProcessing="false">
            <match url="(.*)" ignoreCase="false" />
            <conditions logicalGrouping="MatchAll" trackAllCaptures="false">
                <add input="{URL}" pattern="[A-Z]" ignoreCase="false" />
                <add input="{URL}" pattern="^.*?\.(axd|css|js|jpg|jpeg|png|gif|ashx|asmx|svc).*?$" negate="true" />
                <add input="{URL}" pattern="^.*/(webshop)/.*$" negate="true" />
                <add input="{URL}" pattern="^/umbraco/" negate="true" />
            </conditions>
            <action type="Rewrite" url="{ToLower:{R:1}}" />
            <serverVariables>
                <set name="Redirect" value="true" />
            </serverVariables>
        </rule>
        <rule name="SEO - remove default.aspx" stopProcessing="false">
            <match url="(.*?)/?default\.aspx$" />
            <conditions logicalGrouping="MatchAll" trackAllCaptures="false">
                <add input="{URL}" pattern="^/umbraco/" negate="true" />
            </conditions>
            <action type="Rewrite" url="{R:1}" />
            <serverVariables>
                <set name="Redirect" value="true" />
            </serverVariables>
        </rule>
        <rule name="SEO - Trim aspx" stopProcessing="false">
            <match url="(.*)\.aspx$" />
            <action type="Rewrite" url="{R:1}" />
            <conditions logicalGrouping="MatchAll" trackAllCaptures="false">
                <add input="{URL}" pattern="^/umbraco/" negate="true" />
            </conditions>
            <serverVariables>
                <set name="Redirect" value="true" />
            </serverVariables>
        </rule>
        <rule name="Redirect subdomains with www to non-www" stopProcessing="false">
            <match url="(.*)" />
            <conditions logicalGrouping="MatchAll" trackAllCaptures="false">
                <add input="{HTTP_HOST}" pattern=".*localhost.*" negate="true" />
                <add input="{HTTP_HOST}" pattern="^www\.(.*)\.([^\.]+)\.([^\.]+)$" />
            </conditions>
            <action type="Redirect" url="{MapSSL:{HTTPS}}{C:1}.{C:2}.{C:3}/{R:1}" redirectType="Permanent" />
            <serverVariables>
                <set name="Redirect" value="true" />
            </serverVariables>
        </rule>
        <rule name="Redirect top domains with non-www to www" stopProcessing="false">
            <match url="(.*)" />
            <conditions logicalGrouping="MatchAll" trackAllCaptures="false">
                <add input="{HTTP_HOST}" pattern=".*localhost.*" negate="true" />
                <add input="{HTTP_HOST}" pattern="^([^\.]+)\.([^\.]+)$" />
            </conditions>
            <action type="Rewrite" url="{MapSSL:{HTTPS}}www.{HTTP_HOST}/{R:1}" />
            <serverVariables>
                <set name="Redirect" value="true" />
            </serverVariables>
        </rule>
        <rule name="SEO - non-canonical redirect" stopProcessing="true">
            <match url="(.*)" />
            <conditions>
                <add input="{Redirect}" pattern="true" />
            </conditions>
            <action type="Redirect" url="{R:1}" redirectType="Permanent"/>
            <serverVariables>
                <set name="Redirect" value="false" />
            </serverVariables>
        </rule>
    </rules>
    <rewriteMaps>
        <rewriteMap name="MapSSL" defaultValue="OFF">
            <add key="ON" value="https://" />
            <add key="OFF" value="http://" />
        </rewriteMap>
    </rewriteMaps>
</rewrite> 
```

但是有一个警告：请注意，使用了自定义服务器变量。您不能使用开箱即用的自定义服务器变量。您需要将此变量添加到文件中的`<allowedServerVariables/>`元素中，该`applicationHost.config`文件是 IIS 的全局配置文件。( [Source](http://www.iis.net/learn/extensions/url-rewrite-module/url-rewrite-module-20-configuration-reference#Setting_Server_Variables "资源") ) 如果您使用共享主机（包括 Azure 网站），您可能无法更改此设置。

如果您使用的是 Azure Web 角色，则需要添加一个修改上述配置文件的启动任务。如果不这样做，您将收到 IIS 500 错误。

如果有人对如何使规则变得更好提出建议，仍然欢迎他们。

# php - 群发邮件错误，内容根据否重复。找到的记录

> ID：14707539
> 
> 赞同：-1
> 
> 时间：2013-02-05T12:25:54.677
> 
> 标签：php, mysql

我在向特定用户发送电子邮件时没有遇到任何问题，但是当我尝试将类似的消息发送到数据库（MYSQL）中找到的所有电子邮件时，问题就出现了。

如果我在数据库中找到了 4 个用户，它仍然会发送给所有 4 个用户，但是电子邮件的类似内容会重复 4 次。如果找到 250 个用户，则 250 个重复内容。

代码的代码片段是这样的，一直在插手，测试了很多次，我的想法就用完了。感谢您的关注，非常感谢您的帮助...

```
} elseif ($temptarget == 'Parents'){

$g1chk = mysql_query("SELECT * FROM wmsidb WHERE s_stat='ACTIVE'");
$g1found = mysql_num_rows($g1chk);

While ($rowg1 = mysql_fetch_array($g1chk)){

   $tempemail1 = $rowg1['g1_email'];
   $tempemail2 = $rowg1['g2_email'];

   $comments = (stripslashes($_POST['message']));

   $to = "Parent <$tempemail1>, Parent / Guardian <$tempemail2>" . "\r\n";
   $subject = "[$anndate] Announcement ::: $temptitle";

   // Main Headers
   $headers = "MIME-Version: 1.0" . "\r\n";
   $headers .= "Content-type: text/html; charset=iso-8859-1" . "\r\n";

   // Additional Headers
   $headers .= "From: Contact Us <mailer@mailer.com>" . "\r\n";

   $message .= "
   <table align='center' border='0' width='100%' cellpadding='6'>
   <tr><td width='100%' align='left' bgcolor='#33327e'><font face='Arial' size='4' color='#ffffff'><b>" . strtoupper($temptitle) . "</b></font></td></tr></table>

   <table align='center' border='0' width='100%' cellpadding='3'>
   <tr><td width='10%' align='right'><font face='Arial' color='#636363'> date </font></td><td width='90%' align='left'><font face='Arial'>" . $tempdd . " " . strtoupper($tempmm2) . " " . $tempyear . "</font></td></tr>
   <tr><td width='10%' align='right'><font face='Arial' color='#636363'> posted by </font></td><td width='90%' align='left'><font face='Arial'>" . $temppost . "</font></td></tr>
   <tr><td width='10%' align='right' valign='top'><font face='Arial' color='#636363'> message </font></td><td width='90%' align='left'><font face='Arial'>embedded below...</font></td></tr>
   </table>

   <br/>

   <table align='center' style='border:1px solid grey' width='95%' cellpadding='18'>
   <tr><td width='100%' align='left'><font face='Arial'>" . $comments . "</font></td></tr>
   </table>

   <br/>";

   if ($tempfeedback == 'Yes'){

   $message .= "
   <table align='center' border='0' width='100%' cellpadding='3'>
   <tr><td width='10%' align='right'><font face='Arial' color='#636363'> feedback </font></td><td width='90%' align='left'><font face='Arial'>We need you to provide us a response to announcement above.</font></td></tr>
   <tr><td width='10%' align='right'><font face='Arial' color='#636363'></font></td><td width='90%' align='left'><font face='Arial'>Please complete the 'Feedback Form' found in the link below. Thank you!</font></td></tr>
   <tr><td width='10%' align='right'><font face='Arial' color='#636363'> link </font></td><td width='90%' align='left'><font face='Arial'><b><a href='' target='_blank'>link</a></b></font></td></tr>
   </table>";

   } else {

   $message .= "
   <table align='center' border='0' width='100%' cellpadding='3'>
   <tr><td width='10%' align='right'><font face='Arial' color='#636363'> feedback </font></td><td width='90%' align='left'><font face='Arial'>No feedback required.</font></td></tr>
   </table>";

   }

   $message .= "
   <p><font face='Arial'><br/>

   <br/><br/>

   Footer with contact information

   </font></p>";

   mail ($to,$subject,$message,$headers);

}

   echo "<tr><td width='80%' align='right'><font face='Arial' color='#636363'>" . $g1found . " emails sent to parents / guardians </font></td><td width='20%' align='middle'><font face='Arial'>OK</font></td></tr>";
   echo "<tr><td width='80%' align='right'><font face='Arial' color='#252525'>module terminated</font></td><td width='20%' align='middle'><font face='Arial'></font></td></tr>";

   echo "</table>"; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T12:30:15.540

当然可以。

每次循环运行时都会填充变量消息，因此在每个循环开始时执行：`$message= "";`

# php - 找不到目标实体“某个实体”

> ID：14707541
> 
> 赞同：16
> 
> 时间：2013-02-05T12:26:04.967
> 
> 标签：php, doctrine, zend-framework2

我正在使用 ZF2 与学说我收到此错误。

> 在“Subject\Entity\Subject#user”中找不到目标实体 Entity\User。

这是我的代码的片段。

```
<?php

namespace Subject\Entity;

use Doctrine\ORM\Mapping as ORM;
use Zend\InputFilter\InputFilter;
use Zend\InputFilter\Factory as InputFactory;
use Zend\InputFilter\InputFilterAwareInterface;
use Zend\InputFilter\InputFilterInterface;
/** 

* @ORM\Entity

* @ORM\Table(name="subject")

* @property string $subjectname

* @property int $user_id

* @property int $id

*/
 class Subject implements InputFilterAwareInterface {

  protected $inputFilter;
 /**

 * @ORM\Id

 * @ORM\Column(type="integer");

 * @ORM\GeneratedValue(strategy="AUTO")

 */
protected $id;
/**

 * @ORM\Column(type="string")

 */
protected $subjectname;

/**
 * @ORM\ManyToOne(targetEntity="Entity\User", inversedBy="subjects")
 * @var User|null
 */
private $user;

/** @return User|null */
public function getUser() {
    return $this->user;
}

/** @param User $user */
public function setUser(User $user) {
    if($user === null || $user instanceof User) {
        $this->user = $user;
    } else {
        throw new InvalidArgumentException('$user must be instance of Entity\User or null!');
    }
}} 
```

然后是我的“用户”实体

```
namespace Subject\Entity;

use Doctrine\ORM\Mapping as ORM;
use Zend\InputFilter\InputFilter;
use Zend\InputFilter\Factory as InputFactory;
use Zend\InputFilter\InputFilterAwareInterface;
use Zend\InputFilter\InputFilterInterface;

/*
* @ORM\Entity

* @ORM\Table(name="users")

* @property string $username

* @property string $password

* @property int $id

*/
class User implements InputFilterAwareInterface {

 protected $_username;
 protected $_password;

 /**
 * @ORM\OneToMany(targetEntity="Entity\Subject", mappedBy="user")
 * @var Collection
 */
private $subjects;

/** @ORM\Id() @ORM\Column(type="integer") @ORM\GeneratedValue(strategy="AUTO") @var   int */
protected $_id;

public function __get($property) {

    return $this->$property;
}

public function __set($property, $value) {

    $this->$property = $value;
}

//Getters and setters

/** @return Collection */
public function getSubjects() {
    return $this->comments;
}

/** @param Comment $comment */
public function addSubject(Subject $comment) {
    $this->comments->add($comment);
    $comment->setUser($this);
} 
```

}

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-02-05T12:34:41.897

您的实体声明不正确：

```
 * @ORM\ManyToOne(targetEntity="Entity\User", inversedBy="subjects") 
```

这应该是这样的：

```
 * @ORM\ManyToOne(targetEntity="Subject\Entity\User", inversedBy="subjects") 
```

或者，由于这两个类共享同一个命名空间，你也可以这样使用：

```
 * @ORM\ManyToOne(targetEntity="User", inversedBy="subjects") 
```

必须是完全限定的`targetEntity`类名 (FQCN)，除非引用同一命名空间中的类，在这种情况下可以使用短名称（根据上面的最后一个示例）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-07-23T09:36:00.163

在我们的例子中，文件名与类名不同：它只是一个错字。

# c# - AutoMapper 让实例变量

> ID：14707542
> 
> 赞同：2
> 
> 时间：2013-02-05T12:26:05.273
> 
> 标签：c#, automapper, dto

抱歉，如果以前有人问过这个问题，我不确定要问的具体条款。

**一个简短的例子：**

```
public class SignOffDetails
{
    public int fUserID {get; set;}
    public DateTime SignedAt {get; set;}
}

public class User
{
    public int UserID {get; set;}
    public string FullName {get; set;}
    public Image Signature {get; set;}
}

public class MdlsCombined
{
    public int UserID {get; set;}
    public string FullName {get; set;}
    public Image Signature {get; set;} 
}

public void Program 
{

    Mapper.CreateMap<SignOffDetails, MdlsCombined>()
        .ForMember(m => m.UserID, y => y.MapFrom(z => z.fUserID));
    // Awesome
} 
```

我知道我可以单独映射它们，但是是否有一个我尚未发现的功能来执行以下操作？

```
Mapper.CreateMap<SignOffDetails, MdlsCombined>()
    .Let(z => (User)Users.GetUser(z.fUserID))
    .ForMember(m => m.UserID, y => y.MapFrom(z => z.fUserID))
    .ForMember(m => m.FullName, y => y.MapFromLet(l => ((User)l).FullName))
    .ForMember(m => m.Signature, y => y.MapFromLet(l => ((User)l).Signature)); 
```

我意识到这很愚蠢，并且首先消除了程序编程的全部意义，但它仍然是合法的使用恕我直言。

实际的解决方案是从 SignOffDetails > MdlsCombined 和 User > MdlsCombined 获得两张地图，但这并不流畅；）

# python - Django：模型对象保存中的 datetime.now() 时间不一致

> ID：14707547
> 
> 赞同：3
> 
> 时间：2013-02-05T12:26:19.393
> 
> 标签：python, django, datetime, django-models

![在此处输入图像描述](../Images/7ebb0ca14af31862835cfadb815f35e0.png)

以上是我在管理界面中按降序排列的表格之一`id`（最近的记录在顶部）。这是我用来创建模型对象并保存的方式。

```
notification = Notification(from_user=from_user, to_user=to_user,
                            created_date=datetime.now())
notification.save() 
```

此表的所有插入`Notification`仅在各种`post_save`信号处理程序中完成。会不会造成这样的矛盾？

`TIME_ZONE = 'GMT'`在 django 1.3.2 中使用。我可以尝试使用`auto_now_add=True`模型中的选项，但在此之前只想知道为什么会这样。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T12:35:48.187

`auto_now_add`不是一个好方法。避免使用它。最好的方法是使用设置默认值：

```
from django.utils import timezone

date_created = models.DateTimeField(default=timezone.now) 
```

`django.utils.timezone`将根据您的时区设置存储日期时间。

`()`请注意之后的缺失`timezone.now`是因为我们将一个可调用对象传递给模型，并且每次保存新实例时都会调用它。使用括号，它只在`models.py`加载时被调用一次。这个[问题](https://stackoverflow.com/questions/13225890/django-default-timezone-now-saves-records-using-old-time)更详细地阐明了这个问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-03-20T14:10:12.190

定义模型时不应初始化 datetime.now()。这会导致某种“缓存” datetime.now。

代替：

```
Notification(from_user=from_user, to_user=to_user,
                            created_date=datetime.now()) 
```

你应该使用：

```
Notification(from_user=from_user, to_user=to_user,
                            created_date=datetime.now) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T12:30:05.607

我相信这是由于 Python 运行时环境的处理方式，希望有人可以对此进行重新迭代。auto_add_now=True 应该是您建议的解决方案。

# scala - 在焦点丢失后基于值验证撤消文本字段值的行为

> ID：14707550
> 
> 赞同：1
> 
> 时间：2013-02-05T12:26:37.803
> 
> 标签：scala, event-handling, javafx-2, textfield, undo

我根据之前在此处发布的代码发布了新问题（[在 Slider 和 min/max TextField 之间的 BindDirectional 策略之后过滤 TextField 输入上的用户值](https://stackoverflow.com/questions/14693177/filter-users-values-on-textfield-input-after-a-binddirectional-strategy-betwen-a)）

我的目标很简单，`TextField`在用户失去对我的价值的焦点事件后，撤消错误价值（基于自定义验证）的最佳方法是什么。

唯一的方法是在用户用另一个焦点事件覆盖之前访问 oldValue 吗？

其实我有这个简单的代码：

```
val myTextField = new TextField ()

def parseDouble(s: String) = try {
  Some(s.toDouble)
} catch {
  case _ ⇒ None
}

myTextField.focusedProperty().addListener(
  new ChangeListener[java.lang.Boolean]() { 
    override def changed(observable: ObservableValue[_ <: java.lang.Boolean], oldValue: java.lang.Boolean, newValue: java.lang.Boolean) {
      if (!newValue) {
        parseDouble(myTextField.textProperty().get()) match {
          case Some(d: Double) ⇒  // test on the double value entered by user
          case _ ⇒ // code to reset to old value ??
        }
      }
    }
  }) 
```

**更新 1：**

我在这里找到讨论：[https](https://forums.oracle.com/forums/thread.jspa?threadID=2382472) ://forums.oracle.com/forums/thread.jspa?threadID=2382472 关于**TextField/TextArea 的撤消功能**和其他源代码`TextInputControlBehavior`：[https ://forums.oracle.com/forums/thread .jspa?threadID=2438759&tstart=45](https://forums.oracle.com/forums/thread.jspa?threadID=2438759&tstart=45)

我在这里[http://javafx-jira.kenai.com/browse/RT-7547](http://javafx-jira.kenai.com/browse/RT-7547)找到了 javafx 2.2 中实现的撤消行为的描述，但我找不到示例代码...

**更新 2：**

我在这里找到了公共撤消控制 API 的帖子（路线图固定为 2.2.6） ：http `TextInputControl`: [//javafx-jira.kenai.com/browse/RT-26575](http://javafx-jira.kenai.com/browse/RT-26575)

`TextInputBehaviorControl`可以在这里看到：[https ://bitbucket.org/shemnon/openjfx-rt/src/6696e9cea59c401d2637d82f9cf96a515d210203/javafx-ui-controls/src/com/sun/javafx/scene/control/behavior/TextInputControlBehavior.java](https://bitbucket.org/shemnon/openjfx-rt/src/6696e9cea59c401d2637d82f9cf96a515d210203/javafx-ui-controls/src/com/sun/javafx/scene/control/behavior/TextInputControlBehavior.java)

**更新 3：**

***塔达姆！***

最后我找到了一个可怕的方法来做到这一点，我希望公共 API 适用于 2.2.6 版本的 javaFX ...

```
 val myTextField = new TextField ()

    def parseDouble(s: String) = try {
      Some(s.toDouble)
    } catch {
      case _ ⇒ None
    }

  myTextField.focusedProperty().addListener(
    new ChangeListener[java.lang.Boolean]() { db ⇒
      override def changed(observable: ObservableValue[_ <: java.lang.Boolean], oldValue: java.lang.Boolean, newValue: java.lang.Boolean) {
        if (!newValue) {
          parseDouble(myTextField.textProperty().get()) match {
            case Some(d: Double) ⇒
              if (myTextField.minValue > d || d > myTextField.maxValue) {
                doubleField.getSkin.asInstanceOf[TextInputControlSkin[_, _]].getBehavior.asInstanceOf[TextInputControlBehavior[_]].callAction("Undo")
              } else {
                // Here you change value property of textField
              }
            case _ ⇒ myTextField.getSkin.asInstanceOf[TextInputControlSkin[_, _]].getBehavior.asInstanceOf[TextInputControlBehavior[_]].callAction("Undo")
          }
        }
      }
    }) 
```

如果有人找到更好的方法，我会验证答案:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T13:54:10.067

因为我目前也在使用 Scala 解决方案开发 JavaFX，所以我想尝试你的示例，但我无法编译它。具体`doubleField`和`value.set`不详！

我有一些提示 - 首先：有一个明显的代码重复，可以通过向案例添加条件来轻松解决 - 第一种情况仅在满足条件（d in range）时才成立

```
case Some(d: Double) if (doubleField.minValue <= d && d <= doubleField.maxValue) ⇒
  value.set(d)
case _ ⇒ 
  doubleField.getSkin.asInstanceOf[TextInputControlSkin[_, _]].getBehavior.asInstanceOf[TextInputControlBehavior[_]].callAction("Undo") 
```

第二：为 Java 中的匿名内部类提供一个包装器——例如上面的 ChangeListener 可以这样包装：

```
implicit def unit2ChangeListener[T](f: (ObservableValue[_ <: T], T, T) => Unit) =
  new ChangeListener[T] {
    override def changed(observable: ObservableValue[_ <: T], oldValue: T, newValue: T) {
      f(observable, oldValue, newValue)
    }
} 
```

这些隐式转换可以隐藏在 util 类中（以及一个不错的 unit2EventHandler）并导入到您的应用程序中。这将导致一些更具可读性的东西（但仍然有点痛苦）：

```
myTextField.focusedProperty().addListener(
  (observable: ObservableValue[_ <: java.lang.Boolean], 
     oldValue: java.lang.Boolean, newValue: java.lang.Boolean) =>
     if (!newValue) { ... }
) 
```

可能[ScalaFx](http://code.google.com/p/scalafx/)已经提供了类似的东西，但我还没有尝试过。

# java - 我们可以测试对象在 Oracle Coherence 中的存在吗？

> ID：14707559
> 
> 赞同：1
> 
> 时间：2013-02-05T12:26:59.637
> 
> 标签：java, oracle, caching, oracle-coherence

我有一个要求，我需要创建一个第三方应用程序来测试 Oracle Coherence 中任何对象的存在。

**场景：**我们的主应用程序使用 Oracle Coherence 存储一些数据，现在我必须创建一个单独的应用程序（它将在不同的服务器上运行 - 在 coherence 集群节点之外）。该特定应用程序将检测某些特定对象是否存在于相干性中。我们也没有计划在这台机器上运行一致性。任何第三方应用程序（不属于 coherence 集群的一部分）可以连接到 coherence 并获取数据吗？如果是，那怎么办？我可以得到一些指示来做同样的事情吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T15:32:36.097

有多种方法可以做到这一点。

1) 使用 Coherence Extend - 这允许任何应用程序与 Coherence 交互，而无需成为 Coherence Cluster 的一部分。参考[http://docs.oracle.com/cd/E14526_01/coh.350/e14509/configextend.htm](http://docs.oracle.com/cd/E14526_01/coh.350/e14509/configextend.htm)

仅当第三方应用程序使用 Java、.Net 或 C++ 时才支持此选项 [http://coherence.oracle.com/display/COH35UG/Coherence+Extend#CoherenceExtend-Typesofclients](http://coherence.oracle.com/display/COH35UG/Coherence+Extend#CoherenceExtend-Typesofclients)

2) 使用 REST API - Coherence 的较新/最新版本公开了使用 REST API 的缓存数据管理。请参阅[http://docs.oracle.com/cd/E24290_01/coh.371/e22839/rest_intro.htm](http://docs.oracle.com/cd/E24290_01/coh.371/e22839/rest_intro.htm)

此选项对客户端/第三方技术没有任何限制，因为它基于 HTTP 上的 XML/JSON。

使用 REST，您可以检查缓存键的存在，如下所示。

**获取操作**

获取 http://{host}:{port}/cacheName/key

根据键从缓存中返回单个对象。如果具有指定键的对象不存在，则返回 404（未找到）消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-25T00:33:07.983

前段时间我使用 C++ API 创建了这样一个工具。

[https://github.com/actsasflinn/coherence-tool](https://github.com/actsasflinn/coherence-tool)

为了编写脚本，我还将 C++ API 封装在 Ruby 绑定中。

[https://github.com/actsasflinn/ruby-coherence](https://github.com/actsasflinn/ruby-coherence)

它们中的任何一个都可以在集群外部独立运行，并依赖于与集群通信的 TCP 代理方法。

# mysql - 如果数据 MySQL 没有变化，则更新 MySQL 表的数据

> ID：14707567
> 
> 赞同：-4
> 
> 时间：2013-02-05T12:27:34.617
> 
> 标签：mysql, sql, sql-server

如果数据没有变化，我想更新一个表，在**SQL Server**中是可能的，但在 MySQL 中我怎么能？

**MySQL**

```
DROP TABLE IF EXISTS PEOPLE;
CREAte tempORARY  table PEOPLE
(
    _data CHAR(1),
    id int
);

INSERT into PEOPLE
SELECT 'N',1 UNION ALL 
SELECT 'Y',2 UNION ALL 
SELECT 'N',3 UNION ALL 
SELECT 'Y',4;

-- now I want to update it
UPDATE PEOPLE
SET _data = 'A'
WHERE id = 1;
-- 1 row(s) affected

-- now I want to update it again
UPDATE PEOPLE
SET _data = 'A'
WHERE id = 1;
-- 0 row(s) affected 
```

如果数据没有变化，我想更新数据。

**SQL 服务器**

```
DECLARE @tempORARY  table
(
    _data CHAR(1),
    id int
);

INSERT into @tempORARY 
SELECT 'N',1 UNION ALL 
SELECT 'Y',2 UNION ALL 
SELECT 'N',3 UNION ALL 
SELECT 'Y',4;

-- now I want to update it
UPDATE @tempORARY 
SET _data = 'A'
WHERE id = 1;
-- 1 row(s) affected

-- now I want to update it again
UPDATE @tempORARY 
SET _data = 'A'
WHERE id = 1;
-- 1 row(s) affected 
```

我希望我解决了我的问题，如果您仍有疑问，请发表评论。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T12:38:27.170

我仍然不知道你为什么要做这样的事情......但是使用 WHERE 子句怎么样

就像是：

```
UPDATE @tempORARY 
SET _data = 'A'
WHERE id = 1 AND _data != 'A'; 
```

希望这可以帮助

# python - 将在一个变量中创建的列表传递给类中的另一个变量（PYTHON）

> ID：14707569
> 
> 赞同：0
> 
> 时间：2013-02-05T12:27:35.800
> 
> 标签：python, maya

我不明白为什么在我调用第二个函数后我的列表没有返回到课堂并留在那里，这是我的代码：

```
class ShockAbsorber:
    '''create Proxy, based of 2 locators'''
    def createProxy(self):
        self.allLoc = {}
        self.allLoc["CylinderLoc"] = pm.spaceLocator (n = "Cylinder_Loc")
        self.allLoc["PistonLoc"] = pm.spaceLocator (n = "Piston_Loc", p =[0,30,0])
        pm.CenterPivot()

    '''create bones on locators'''
    def createRig(self):
        for name,loc in self.allLoc.items():
            print Loc 
```

我在一个单独的文件上有一个界面，为每个功能创建 2 个按钮。

```
 #define button Create Proxy
def CreateProxyPressed(self):
    csa = sa.ShockAbsorber() 
    csa.createProxy()

#define button Create Proxy
def CreateRigPressed(self):
    csa = sa.ShockAbsorber() 
    csa.createRig() 
```

如果我运行我的代码，我会收到此错误消息：

```
AttributeError: ShockAbsorber instance has no attribute 'allLoc' 
```

我希望这是足够的信息让您了解我的问题，我正在为“Autodesk Maya”编写一个工具。我很确定我的概念是正确的，所以我做错了什么？

先感谢您！

PS我很抱歉给大家带来了困惑，但是在您发现我的错字后，我现在编辑了我的代码以使其正确！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T12:31:00.153

您需要存储`allLoc`在类实例中，而不是返回它：

```
def createProxy(self, *args):
    allLoc = {}
    allLoc["CylinderLoc"] = pm.spaceLocator (n = "Cylinder_Loc")
    allLoc["PistonLoc"] = pm.spaceLocator (n = "Piston_Loc", p =[0,30,0])
    pm.CenterPivot()
    self.allLoc = allLoc 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T12:31:09.123

`createProxy`需要设置`self.allLoc`。您仅设置本地名称`allLoc`。

# google-app-engine - 用于外部链接的 webapp2 路由

> ID：14707572
> 
> 赞同：2
> 
> 时间：2013-02-05T12:27:38.000
> 
> 标签：google-app-engine, webapp2

我想在我的应用程序的中心位置管理外部链接，这样如果它们发生变化，我只需在一个地方更改它们。

由于我已经在使用 webapp2s 路由，我想我可以使用它，并像其他所有链接一样使用 url_for。因此，尝试了以下方法：

```
Route('http://www.google.com', name='google', build_only=True) 
```

但是当我渲染链接时，像这样：

```
uri_for('google') 
```

它对 http:// 位进行编码，如下所示：

```
http%3A//www.google.com 
```

这意味着如果你在 href 标签中使用它，你最终会得到一个像这样的相对链接：

```
http://localhost:8080/some/path/http%3A//www.google.com 
```

所以，问题是：

*   webapp2s 路由甚至是为外部链接设计的吗？
*   如果是，如何添加绝对 URL？
*   如果没有，是否有类似的机制这样做？

使用 webapp2s 路由会很好，这样我就可以无缝地使用 url_for 而不必编写另一个“相同但不同”的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T12:52:12.657

我设法通过实现我自己的 uri_for 方法解决了这个问题，并改用它

```
def uri_for(_name, _request=None, *args, **kwargs):
    uri = webapp2.uri_for(_name, _request, *args, **kwargs)
    return urllib.unquote(uri) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-21T18:38:17.813

在调用 uri_for 时，您可以将 _netloc 与服务器名称一起代替 _full（如上面提到的 voscausa）。将 _netloc 强制 _full 为 True。

请参阅[http://webapp-improved.appspot.com/api/webapp2.html#uri-routing](http://webapp-improved.appspot.com/api/webapp2.html#uri-routing)

# xml - xml cdata 返回 XML 解析失败：使用 xslt 编码时语法错误非法字节序列

> ID：14707575
> 
> 赞同：1
> 
> 时间：2013-02-05T12:27:49.720
> 
> 标签：xml, xslt, syntax-error, cdata

我搜索了一个答案，但找不到。

我有一个由服务器生成的长 xml。我想使用 xslt 显示一些节点。

**问题是：**当我在浏览器上打开 xml 时，我得到：XML 解析失败，XML 解析失败：语法错误，编码中的非法字节序列

错误在一个节点内的一个 cdata 内，`<![CDATA[`以`]]>`

错误是：`,`和数百个类似的字符。

据我了解，如果它在 cdata 中它应该忽略或逃避它，这不应该发生。

xml 编码是 utf8 。

感谢您的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T17:17:19.060

## 编码

你说“xml编码是utf8”。你的解析器告诉你你错了。它正在寻找一个在 UTF-8 中不可能出现的字节序列；根据我的经验，当 ISO 8859-1（ISO Latin 1）数据被错误地标记为 UTF-8 时，经常会发生这种情况。

如果您在十六进制转储或类似工具中检查了有问题的数据并确认它是合法的 UTF-8，那么您似乎有一个错误需要向您的供应商报告。如果你没有，那么这里会说解析器可能是正确的，并且你的数据不太可能是 UTF-8。找出它是什么，并正确声明它，或者修复服务器的配置以使其生成 UTF-8 数据流，或者使用字符编码转换实用程序将服务器的输出转换为 UTF-8。

## CDATA 部分

CDATA 部分出现在被解析为 XML 的字符序列中；他们声明其内容是字符数据而不是 XML 分隔符。CDATA 部分没有也不能声明其内容是任意位、字节或八位字节序列；当字符序列被识别为 CDATA 部分时，数据流编码中的位已经转换为字符；现在说“不要将这些八位字节解析为字符！”为时已晚。

# javascript - 如果 window.history 位置来自 www.example.com，则执行某些操作

> ID：14707578
> 
> 赞同：0
> 
> 时间：2013-02-05T12:28:12.073
> 
> 标签：javascript, url, history

我们如何确定 window.history 是否来自某个 URL，例如 www.example.com ，然后做一些事情，例如：

`if ( //window.history includes example.com string ) { $('.myclassname').hide() }`

它实际上需要知道历史的链接位置......有没有办法找到它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T12:32:23.503

您只能通过`document.referer`. 您无法从 js 访问历史记录。

# visual-studio-2010 - 程序集链接：致命错误 L1093：找不到目标文件

> ID：14707580
> 
> 赞同：0
> 
> 时间：2013-02-05T12:28:16.270
> 
> 标签：visual-studio-2010, assembly, x86, masm

我想在 Visual Studio 2010 中编写 16 位 8086 汇编代码，但给了我错误：代码：

```
.MODEL small
.STACK 100h
.data
 message BYTE "Hello, world!","$"
.code
_start:
mov ah,9
lea dx,message ; addr of buffer
int 21h
END _start 
```

输出给了我这个错误：

```
Link:  
Microsoft (R) Segmented Executable Linker  Version 5.60.339 Dec  5 1994
Copyright (C) Microsoft Corp 1984-1993\.  All rights reserved.  
warning L4017: /ERRORREPORT : unrecognized option name; option ignored
LINK : fatal error L1093: Files\Microsoft Visual Studio 10.0\VC\bin\link.exe : 
object file not found
Build FAILED. 
```

我该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T04:50:24.447

真的不知道是什么问题。我从来没有使用过 VS 来组装。那里有比 VS 恕我直言更好的汇编 IDE——RadASM、WinASM。这段代码：

```
.MODEL small
.STACK 100h
.data
 message BYTE "Hello, world!","$"
.code
_start:
mov ah,9
lea dx,message ; addr of buffer
int 21h
END _start 
```

用这个批处理文件很好地组装和链接：

```
@ECHO ON
del dosdisplay.exe
ML.EXE /DMASM /DDOS /Zm /c /nologo /I"d:\masm32\Include" "dosdisplay.asm"
link16.exe /NOLOGO "dosdisplay.obj" "",,,,,"" 
```

我使用的汇编器和链接器版本：

`Microsoft (R) Macro Assembler Version 6.15.8803`

`Microsoft (R) Segmented Executable Linker Version 5.60.339 Dec 5 1994`

什么是链接？不是32位版本吗？还是16位名称相同？不确定，多年来一直使用这 2 个文件/版本用于 DOS 应用程序。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-07-15T10:13:40.050

**出现这个问题：**

> 1.由于 .asm 文件的名称过长。缩短您的文件名并获得您想要的结果。
> 
> > 2.由于链接文件时路径错误。

# url - Joomla 3.0 组件 - 路由器 SEF，添加一个段

> ID：14707582
> 
> 赞同：0
> 
> 时间：2013-02-05T12:28:19.707
> 
> 标签：url, joomla, sef, joomla3.0

有人可以告诉我如何在 SEF URL 的开头添加一个段 - 即：

`http://somedomain.com/*SEGMENT*/task/id`

**SEGMENT**只是一个静态字符串，只是为了显示而不是从查询中获取。

我的组件中有一个非常基本的 router.php：

```
function MyComponentBuildRoute(&$query)
{
    $segments = array();

    if (isset($query['task'])) {
        $segments[] = $query['task'];
        unset($query['task']);
    }
    if (isset($query['id'])) {
        $segments[] = $query['id'];
        unset($query['id']);
    }

    return $segments;
}

function MyComponentParseRoute($segments)
{
    $vars = array();
    $count = count($segments);

    if ($count) {
        $count--;
        $segment = array_shift($segments);
        if (is_numeric($segment)) {
            $vars['id'] = $segment;
        } else {
            $vars['task'] = $segment;
        }
    }

    if ($count) {
        $count--;
        $segment = array_shift($segments) ;
        if (is_numeric($segment)) {
            $vars['id'] = $segment;
        }
    }
return $vars;
} 
```

希望有人能帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T07:59:13.957

为组件中的视图创建一个菜单项。如果您的**SEGMENT**需要是 /foo/，那么只需确保菜单项的别名是“foo”。如果您需要斜线，即/foo/bar/，您需要嵌套两个具有别名“foo”和“bar”的菜单项。这将告诉 Joomla 如何处理它。

# vim - gfortran 编译器的 Vim 错误格式

> ID：14707586
> 
> 赞同：2
> 
> 时间：2013-02-05T12:28:38.263
> 
> 标签：vim, makefile, fortran

我正在使用 vim`:make`使用 gfortran 编译 FORTRAN 代码。我喜欢快速修复窗口在编译错误之间跳转的功能。我正在使用[这里](http://vim.wikia.com/wiki/Errorformats)为 gfortran 建议的错误格式，即：

```
errorformat=%E%f:%l.%c:,%E%f:%l:,%C,%C%p%*[0123456789^],%ZError: %m,%C%.%# 
```

它检测到大部分错误。我想增加处理以下问题的可能性

*   警告
*   链接器错误
*   （奖金）涉及两个位置的错误：（1）和（2）

前段时间，当我尝试为英特尔 FORTRAN 制作错误格式时，我已经阅读了文档。我花了很多时间，只是为了大概的结果。我想添加警告 '%W' 应该不会太难，因为它具有与错误消息相同的结构。对于链接器错误，我不知道它是否会起作用，因为我对源和对象使用不同的文件夹并使用 vpath Makefile 功能。

我在下面附上了一些我希望由 errorformat 处理的 gfortran 编译器的错误消息示例。

非常感谢你的帮助

**错误示例（到目前为止由错误格式处理）**

```
folder/file.f90:22.19:

        ini=.false.
         1
Error: Symbol 'ini' at (1) has no IMPLICIT type 
```

**警告示例**

```
folder/file.f90:485.12:

        use SomeMod, only: somevar
            1
Warning: Unused module variable 'somevar' which has been explicitly imported at (1) 
```

**链接器错误示例**

```
 /tmp/ccPcF56y.o: In function `MAIN__':
test.f90:(.text+0x8e0): undefined reference to `init_'
../../_build/amod.o: In function `__amod_MOD_dostuff':
amod.f90:(.text+0x3e32): undefined reference to `dothis_'
amod.f90:(.text+0x3e74): undefined reference to `dothat_'
collect2: error: ld returned 1 exit status 
```

**多个错误位置示例**

```
file.f90:8.8:

    use AMod
        1
file.f90:231.25:

    call init()
         2
Error: 'init' at (1) has a type, which is not consistent with the CALL at (2) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-04-28T21:49:13.930

这在某种程度上有效

```
set efm=%A%f:%l.%c:,%C,%C\ %.%#,%ZError:\ %m,%ZWarning:\ %m,%f:(%.%#):%m 
```

*   多行部分 (%A-%Z) 平等地处理错误和警告
*   %C 代码是跳过空行和以空格开头的行
*   链接错误格式不会将您带到调用丢失函数的行，但它会打开正确的文件
*   我看不到如何使用 vim errorformat 处理多个错误情况。

这给出了 vim

```
:clist
 1 folder/file.f90:22 col 19:  Symbol 'ini' at (1) has no IMPLICIT type
 2 folder/file.f90:485 col 12:  Unused module variable 'somevar' which has been explicitly imported at (1)
 4 test.f90: undefined reference to `init_'
 6 amod.f90: undefined reference to `dothis_'
 7 amod.f90: undefined reference to `dothat_' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T13:51:42.757

这就是我所取得的成就，它有点工作，但不是很好

```
set efm=%I%.%#In\ function%m,%I%.%#undefined\ reference\ to%m,%E%f:%l.%c:,%E%f:%l:,%C,%C%p%*[0123456789^],%ZError:\ %m,%ZWarning:\ %m,%C%.%# 
```

# facebook - 在 flex 中与 facebook 共享链接

> ID：14707587
> 
> 赞同：0
> 
> 时间：2013-02-05T12:28:39.020
> 
> 标签：facebook, actionscript-3, apache-flex, actionscript, flex3

我使用我的 flex 3 应用程序与 facebook 共享了一个链接。

我的代码是：

```
<mx:Button id="btnFb" click="fbShare(event)" />

  protected function fbShare(event:MouseEvent):void
  {
     openPage('http://www.facebook.com/sharer/sharer.php?u='+getPublicationUrl(),"_popup");
  }

  private function getPublicationUrl():String
  {
      return "http://domain.com/index.html?userid=3&pubid=10";
  } 
```

现在，当我与 facebook 共享此（以上）链接时，它将仅共享“ [http://domain.com/index.html?userid=3](http://domain.com/index.html?userid=3) ”此链接。它将跳过**&pubid=10**。

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T12:46:23.217

您将希望在 getPublicationURL 函数的返回数据上使用 encodeURIComponent 函数：

```
private function getPublicationUrl():String
{
    return encodeURIComponent("http://domain.com/index.html?userid=3&pubid=10");
} 
```

核心问题是原始 URL 采用 &pubid 参数，因为它没有被编码。有关 escape、encodeURI 和 encodeURIComponent 的更多信息可在此处获得：

[你什么时候应该使用转义而不是 encodeURI / encodeURIComponent？](https://stackoverflow.com/questions/75980/best-practice-escape-or-encodeuri-encodeuricomponent)

# c# - Facebook 在 ASP.net 或 C# 中登录后，我想调用 C# 函数

> ID：14707592
> 
> 赞同：0
> 
> 时间：2013-02-05T12:28:51.203
> 
> 标签：c#, .net, facebook, login

我正在开发一个 ASP.Net 网络。该页面有一个 facebook 登录按钮，我希望当用户单击该按钮并登录时，调用 C# 函数来显示我页面的一些元素。

我创建了一个 facebook 应用程序，并在页面的代码中输入了 facebook SDK 登录名，但没有工作......

任何人都可以帮助我吗？

谢谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T13:07:30.220

您想要做的是在成功登录时调用网络服务

```
FB.Event.subscribe('auth.authResponseChange', function (response) {
    if (response.status === 'connected') {
        // log in successful
        callWebService();
    } 
    else if (response.status === 'not_authorized') {
        // the user is logged in to Facebook, 
        // but has not authenticated your app
    } 
    else {
        // the user isn't logged in to Facebook.
    }
}); 
```

然后你可以在 webservice 和 webservice 的成功回调中做任何你想做的事情！

# qt4 - PyQT4/Python33 问题

> ID：14707594
> 
> 赞同：0
> 
> 时间：2013-02-05T12:29:02.780
> 
> 标签：qt4, pyqt4, python-3.3

我已经在我的 Windows 7 机器上安装了 PyQt 4 以与 Python33 一起使用，我按照河岸上的说明进行操作，一切似乎都已正确完成，但是，我尝试了一个简单的示例来创建一个在网上找到的基本示例，该示例已编译但不显示任何内容图形用户界面。有任何想法吗？

```
import sys
from PyQt4 import QtGui

def main():

    app = QtGui.QApplication(sys.argv)

    w = QtGui.QWidget()
    w.resize(250, 150)
    w.move(300, 300)
    w.setWindowTitle('Hello')
    w.show()

    sys.exit(app.exec_()) 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T12:31:48.180

您只需定义一个函数。您还必须调用它才能查看小部件：

我已经在我的 Windows 7 机器上安装了 PyQt 4 以与 Python33 一起使用，我按照河岸上的说明进行操作，一切似乎都已正确完成，但是，我尝试了一个简单的示例来创建一个在网上找到的基本示例，该示例已编译但不显示任何内容图形用户界面。有任何想法吗？

```
import sys
from PyQt4 import QtGui

def main():

    app = QtGui.QApplication(sys.argv)

    w = QtGui.QWidget()
    w.resize(250, 150)
    w.move(300, 300)
    w.setWindowTitle('Hello')
    w.show()

    sys.exit(app.exec_())

if __name__ == '__main__':  #avoids execution when imported.
    main() 
```

启动程序`$python the-program.py`应该显示窗口。

# javascript - 使用 window.onbeforeunload 事件中的 window.event.keyCode 在 javascript 中捕获 f5 按键事件始终为 0 而不是 116

> ID：14707602
> 
> 赞同：16
> 
> 时间：2013-02-05T12:29:53.517
> 
> 标签：javascript, jquery

我正在创建一个 MVC 应用程序。有必要在关闭应用程序（即窗口/选项卡）时使会话中的变量为空，但在刷新应用程序时不需要。我通过以下代码进行了尝试。

```
<script type="text/javascript">
           window.onbeforeunload = function (e) {
               e = e || window.event;
               if (window.event.keyCode == 116) {
                   alert("f5 pressed");
               }
               else {
                   alert("Window closed");
                   //call my c# code to make my variable null, eg:Session["myVariable"] = null;
               }  
           };
</script> 
```

但是当按下 F5 时，“window.event.keyCode”总是 0 而不是 116。因此，即使按下 F5 键，我的变量也会变为空，这不是我的要求。

即使应用程序（即网页）关闭，即使它是 0（这可能是正确的）。

请注意，上述部分代码位于 .cshtml 文件中。

谁能告诉我哪里错了？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-02-05T12:49:13.707

如果你想让它在crossborwser中工作，你必须听不同的事件+你必须在每次按下按键事件时听，而不是在加载时：

```
document.onkeydown = fkey;
document.onkeypress = fkey
document.onkeyup = fkey;

var wasPressed = false;

function fkey(e){
        e = e || window.event;
       if( wasPressed ) return; 

        if (e.keyCode == 116) {
             alert("f5 pressed");
            wasPressed = true;
        }else {
            alert("Window closed");
        }
 } 
```

这是一个演示：http: [//jsfiddle.net/FSrgV/1/embedded/result/](http://jsfiddle.net/FSrgV/1/embedded/result/)

但如果您只是想知道用户是否退出页面，您可以简单地使用`window.onbeforeunload`：[https ://developer.mozilla.org/en-US/docs/DOM/window.onbeforeunload](https://developer.mozilla.org/en-US/docs/DOM/window.onbeforeunload)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2016-06-10T07:19:18.657

不要使用`e.keyCode == 116`use`e.keyCode == 'F5'`代替。

```
 function fkey(e){
    e = e || window.event;
   if( wasPressed ) return; 

    function fkey(e){
        e = e || window.event;
        if (e.code === 'F5') {
            alert("f5 pressed");
            wasPressed = true;
        }else {
            alert("Window closed");
        }
    } 
```

这是因为 't' 和 'F5' 都使用 116 号键码。如果您单独使用键码，那么如果用户按下 't' 键，您的页面将刷新。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-04-10T10:48:08.540

你可以这样写：

```
$(document.body).on("keydown", this, function (event) {
    if (event.keyCode == 116) {
        alert('F5 pressed!');
    }
}); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2019-01-10T08:19:18.550

```
document.onkeydown = disableF5;
document.onkeypress = disableF5
document.onkeyup = disableF5;    
function disableF5(e) { if ((e.which || e.keyCode) == 116) e.preventDefault(); }; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-10-31T09:48:45.557

修改后的版本，按“t”后也可以工作。

键 116 在 84 后自动按下

```
document.onkeydown = fkey;
document.onkeypress = fkey
document.onkeyup = fkey;

var wasPressed = false;

function fkey(e){
    e = e || window.event;
   if( wasPressed ) return; 

    if (e.keyCode == 116) {
         alert("f5 pressed");

    }else {
        alert("Window closed");
    }
    wasPressed = true;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-12-15T08:29:23.597

不要使用 (e.keyCode == 116) 来检查 F5 ；而不是使用这个

```
<script>
    document.onkeydown = capturekey;
    document.onkeypress = capturekey;
    document.onkeyup = capturekey;

    function capturekey(e) {
        e = e || window.event;
        //debugger
        if (e.code == 'F5') {
            if (confirm('do u wanna to refresh??')) {
                //allow to refresh
            } 
            else {
                //avoid from refresh
                e.preventDefault()
                e.stopPropagation()
            }
        }
    }
</script> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-05-21T16:32:43.850

我同意 meo 的解决方案，但我会添加一些修改。

当我们使用 document.onkeydown = fkey; 例如，在页面中，我们有另一个影响 document.onkeydown 的方法，那么浏览器将只检测到最后一个事件。然而，当我们使用： jQuery(document).on("keydown",fkey); 即使我们有另一个函数来处理 keydown 事件，所有的函数都会被触发。

请参阅下一个示例以进一步了解：

```
var wasPressed = false;
document.onkeydown = f1;
document.onkeydown = f2;

jQuery(document).on("keydown",f3); 
jQuery(document).on("keydown",f4); 
function f1(e){
e = e || window.event;
if( wasPressed ) return; 

        if (e.keyCode == 116) {
             alert("f5 pressed");
            wasPressed = true;
        }else {
            alert("Window closed");
        }
}
function f2(){
    alert('f2');
}
function f3(){
    alert('f3');
}
function f4(){
    alert('f4');
} 
```

此处将显示的内容：只有 3 个警报：f2、f3 和 f4。并且 f1 函数在此示例中未触发。

# jquery - jQuery UI 'easeoutbounce' 需要更有弹性

> ID：14707605
> 
> 赞同：0
> 
> 时间：2013-02-05T12:29:58.067
> 
> 标签：jquery, jquery-ui, jquery-effects, jquery-easing

我创建了一个 div，点击时它会下降到屏幕底部。它需要反弹，所以我使用了“easeOutBounce”作为缓动效果。它工作得很好，但客户要求它“更有弹性”。我知道我可以减慢动画的速度，但我真的不希望对象移动得更慢，我只想让它反弹得更多。我想，重力更小。

这是jQuery：

```
$( document ).click(function() {
    $( "div" ).animate({ top: 400 }, { duration: 2000, easing: 'easeOutBounce' });
}); 
```

这是一个小提琴：http: [//jsfiddle.net/NtkNB/1/](http://jsfiddle.net/NtkNB/1/)

我真的很难找到有关此特定效果的文档，并想知道是否有人可以建议如何配置当前设置以获得所需的效果，或者是否有任何更高级的动画效果可以做到这一点，我可以插入。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-07-23T19:35:11.180

这个问题很老，但似乎没有得到回答。发生在它身上，因为我只有相反的问题（div需要“不那么有弹性”）。我想出的解决方案是一个二次方程来控制每次反弹（也许不是最优雅的）。这是一个 jsfiddle： http: [//jsfiddle.net/NtkNB/194/](http://jsfiddle.net/NtkNB/194/) 这个比默认的 jquery 动画没有弹性。为了让它更有弹性，你只需要改变方程，这有点痛苦。

```
var thing = (-17.34*x*x)+(14.351*x)-2.944; 
```

我用 wolfram 确定：[http ://www.wolframalpha.com/input/?i=quadratic+through+%28.343%2C0%29%2C%28.4715%2C.1%29%2C+%28.6%2C0%29](http://www.wolframalpha.com/input/?i=quadratic+through+%28.343%2C0%29%2C%28.4715%2C.1%29%2C+%28.6%2C0%29)

# c# - 如何突出显示 ListView 的列

> ID：14707610
> 
> 赞同：0
> 
> 时间：2013-02-05T12:30:14.240
> 
> 标签：c#, wpf, xaml

如何`ListView`用灰色动态突出显示 WPF 的单击列？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T12:47:16.543

将`ListView.Selection`更改事件与委托处理程序一起使用，例如：

```
public delegate void SelectionChangedEventHandler(
      Object sender,
      SelectionChangedEventArgs e
  ) 
```

它会在项目索引更改时引发事件，寻找`SelectionChangedEventArgs`它有两个属性，

`AddedItems`和`RemovedItems`，然后更改&集合中`Background`的`ListViewItem``AddedItems``RemovedItems`

# regex - 与 Grep 不一致的结果

> ID：14707613
> 
> 赞同：2
> 
> 时间：2013-02-05T12:30:20.680
> 
> 标签：regex, grep

我正在通过一些文件查找字符串“主机”（带单引号）。我想捕获包含没有注释 (#) 的字符串的文件。

第一个示例中的测试用例工作得很好，但下面的第二个用例却不行。第二种情况是我创建的测试文件，并在其中插入了前导空格。所以我知道没有控制字符，只有空格。

两台服务器都是相当新的 Linux 版本。

什么可以解释第二个示例没有捕获文本？我知道我可以 grep for **host**，然后用**grep -v**过滤评论，但我不明白这一点让我很烦恼。

```
/home/user2> $ cat set.txt
   'host'
/home/user2> $ grep -E "^\s+'host'" set.txt
   'host' 
```

其他 Linux 服务器上的 Grep 未捕获所需数据：

```
[user1@wweb1 ~]$ cat set.txt
     'host'  
[user1@wweb1 ~]$ grep -E "^\s+'host'" set.txt
[user1@wweb1 ~]$ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T10:46:20.693

根据`grep`版本和类型，`\s`可能无法正常工作。在我的 grep 2.12 系统上，没有提到`\s`，尽管它确实有效。其他版本可能没有启用此功能。

从手册页：

```
The Backslash Character and Special Expressions
   The symbols \< and \>  respectively  match  the  empty  string  at  the
   beginning and end of a word.  The symbol \b matches the empty string at
   the edge of a word, and \B matches the empty string provided  it's  not
   at the edge of a word.  The symbol \w is a synonym for [_[:alnum:]] and
   \W is a synonym for [^_[:alnum:]]. 
```

此外，`man grep | grep "\\\\s"`根本不返回任何内容。就是这样：没有提到`\s`.

相反，您可以`[:space:]`这样使用：

```
 user@pc $ grep -E "^[[:space:]]+'host'" set.txt
     'host' 
```

因此，请检查您的 grep 版本，并选择适用于所有版本的语法。[这个邮件列表帖子](http://www.mail-archive.com/bug-grep@gnu.org/msg02689.html)说`\s`在 grep 2.5.1 中不起作用，但在 2.6.3 中起作用，所以你们中有一个 2.6.3 之前的版本，它可能不适用于`\s`.

# android - 通过 wifi 连接获取设备的目录列表

> ID：14707615
> 
> 赞同：0
> 
> 时间：2013-02-05T12:30:27.207
> 
> 标签：android, http, android-wifi, wifimanager, directory-listing

我想获取通过**wifi**连接到 android 设备的[FlashAir的](http://www.toshiba-components.com/FlashAir/index.html)**目录列表**，我需要下载选定的文件。

 **这是设备的网络规范

1.  支持的协议 - TCP/IP (IPv4)
2.  服务器功能 - HTTP 服务器、DHCP 服务器
3.  客户端功能 - HTTP、DHCP、DNS、NETBIOS

可以使用什么协议来获取目录列表以及如何获取？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T12:44:39.990

列表中唯一能够传输文件的协议是 http。但是，必须将 http 服务器配置为允许目录列表。另外，当然，可以浏览的文件系统子树将被限制在http服务器的“根”目录下的结构中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-05T14:59:36.253

这是一个教程，向您展示如何编写一个快速应用程序，该应用程序将允许您获取 FlashAir 内容的目录列表以及从 FlashAir 下载图像文件（或经过一些调整，任何文件）：

[https://flashair-developers.com/en/documents/tutorials/android/3/](https://flashair-developers.com/en/documents/tutorials/android/3/)**

# facebook-graph-api - 无需 Facebook 登录即可获得新的访问令牌

> ID：14707619
> 
> 赞同：0
> 
> 时间：2013-02-05T12:30:41.960
> 
> 标签：facebook-graph-api, oauth-2.0

有没有办法在用户不重新登录的情况下请求新的访问令牌（带有过期的令牌）？Facebook 必须有一种方法可以在不需要用户输入的情况下刷新应用令牌。这需要在服务器端而不是客户端完成。

更新：我忘了提到我已经有一个长期存在的令牌。我想在过期之前刷新并获得一个新的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T12:39:23.190

是的。在令牌到期之前，向 -

```
https://graph.facebook.com/oauth/access_token?  
grant_type=fb_exchange_token&           
client_id=APP_ID&
client_secret=APP_SECRET&
fb_exchange_token=SHORT_LIVED_ACCESS_TOKEN 
```

这将为您提供一个有效期为 2 个月的新令牌。

有关更多详细信息 -[扩展令牌](https://developers.facebook.com/docs/howtos/login/extending-tokens/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T12:35:10.047

可以将访问令牌的生命周期最长延长至 60 天。看看这里：[https ://developers.facebook.com/roadmap/offline-access-removal/](https://developers.facebook.com/roadmap/offline-access-removal/)

如果用户超过 60 天未返回，则无法获取新的用户访问令牌。

# struts2 - 使用 struts 2 jquery tree 插件时 CSS 无法正确加载

> ID：14707621
> 
> 赞同：0
> 
> 时间：2013-02-05T12:30:53.713
> 
> 标签：struts2, struts2-jquery-plugin

我正在使用 struts2 jquery 树插件在 div 中显示树。问题是树的 CSS 或我的 JSP 页面的 CSS 没有正确加载。

我尝试更改脚本加载的顺序，现在我可以看到我在 JSP 上的所有 CSS 都是所需的，但树没有加载正确的 CSS。

截至目前，我已将`jqueryui="true"`.`<sj:head>`

```
<sj:head jqueryui="true"  />    
<script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>       
<script type="text/javascript" src="http://jzaefferer.github.com/jquery-validation/jquery.validate.js"></script>
<script type="text/javascript" src="scripts/myscript.js" ></script>

<link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile.structure-1.2.0.min.css" />
<link rel="stylesheet" href="themes/Test.css" />
<link rel="stylesheet" href="themes/Custom.css" />
<link rel="stylesheet" href="css/styles.css" />
<script>

$.subscribe('treeClicked', function(event, data) {
      var item = event.originalEvent.data.rslt.obj;
      alert('Clicked ID : ' + item.attr("id") + ' - Text ' + item.text());
});
</script>
<body>
     <s:url var="treeDataUrl" action="GetData"/>
                            <sjt:tree 
                                    id="jsonTree" 
                                    href="%{treeDataUrl}"
                                    onClickTopics="treeClicked" 
                                    jstreetheme="default"
                            />
</body> 
```

注意：我需要包含我在代码中提到的所有 CSS 文件。它们对于我的 UI 是必需的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T11:24:29.827

我收集你的问题：
1\. jquery-ui-theme 的属性应该是`jstreetheme`，`NOT theme`
2\. 页面加载时不会调用你的脚本！将其更改为：

```
$(function(){
    alert("ECHO..."); // check if script called on page load
    $.subscribe('treeClicked', function(event, data) {
        var item = event.originalEvent.data.rslt.obj;
        alert('Clicked ID : ' + item.attr("id") + ' - Text ' + item.text());
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-08T08:59:34.970

现在，我正在用 jquery struts2 做我的项目。当我单击树节点时，我可以调用我的 javascript 方法，所以我想分享我的经验。

请把它写在 sjt 树标签中

> onClickTopics="treeClicked"

然后写入脚本标签

```
$(function(){
$.subscribe('treeClicked', function (event, data){
        // check if script called on page load
        alert("treeClicked");
        //Get the next item, this is the tree node object is selected, many operations need it
        var item = event.originalEvent.data.rslt.obj;
        //Other code written here
        //For example, we want to select the node id suggest, you can write like this
        alert ('Clicked ID : ' + item.attr ("id"));
});
}); 
```

希望我的回答对你有所帮助。

# javascript - 是否有自动过期旧密钥的 localStorage 解决方案？

> ID：14707626
> 
> 赞同：0
> 
> 时间：2013-02-05T12:31:11.620
> 
> 标签：javascript, html, local-storage

我使用 localStorage 存储应用程序的状态，但存储新产品的新密钥（我想记住不同的产品页面分开）。

但由于产品将被更新，我需要在一周或一个月后移除旧密钥。有没有内置的解决方案？

我正在使用 Rails 和 jQuery。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-13T19:18:15.087

有几个插件写了，我没有写这个，但我喜欢这个：

[https://code.google.com/p/local-cache/](https://code.google.com/p/local-cache/)

奇迹般有效！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-02T19:41:55.417

你可以看到使用[web-storage-cache](https://github.com/WQTeam/web-storage-cache)。我之前也遇到过你的问题，我通过添加一个属性来保存过期时间来解决它。也许你可以试试这个网络存储缓存。

# php - 捕获 JSON 请求中的所有输入（使用 Restler）

> ID：14707629
> 
> 赞同：0
> 
> 时间：2013-02-05T12:31:21.730
> 
> 标签：php, restler

我有一个请求，其中大部分输入参数都作为 JSON 请求对象放入。出于文档目的，我想指定用户可以输入的最常见字段，但是将进入 JSON 请求的名称值有很多可变性，我不想记录所有这些字段很麻烦。

这是我现在拥有的屏幕截图：

![资源管理器中的 API](../Images/c605a1553eb1a03d44438788a83a8de5.png)

例如，如果我想放入一个名为“people-with”的 JSON 属性并将其设置为“['joe','paul','jane'] 那么这在 JSON 中很容易做到，但我该怎么做在我的 PHP/Restler 代码中选择它。现在这个服务的签名是：

```
/**
 * ADD an Activity
 *
 * Add a new action to a user's stream
 *
 * @url POST /{user_id}
 *
 * @param integer   $user_id    The user_id for whom the actions apply; you can insert the text "self" and it will resolve to the current/default user
 * @param string    $start_time {@from body} The date/time that the activity was started (YYYY-MM-DD or YYYY-MM-DD HH:mm:SS)
 * @param string    $action     {@from body} The action "slug name" that uniquely identifies an action
 * @param string    $end_time   {@from body} The date/time that the activity concluded (YYYY-MM-DD or YYYY-MM-DD HH:mm:SS)
 * @param string    $app_id     {@from body} The application that captured this activity
 * @param string    $proxy_user_id  {@from body} The person who captured this activity for the individual
 * @param string    $location   {@from body} The location information associated with this activity
*/
public function add_action ($user_id, $start_time, $action, $end_time=null, $app_id=null, $proxy_user_id=null, $location=null)
{
    // implement
} 
```

ps 作为附注，我暂时将此 API 服务更改为 PUT 以避免几天前提出的 POST 问题，这在使用 POST 时也影响了我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T13:07:02.790

好的，解决这个问题的关键在于`$request_data`关联数组。因此，为了实现（关键字段的）文档和能够将值动态接收到 POST/PUT 服务中，您只需执行以下操作：

```
/**
 * ADD an Activity
 *
 * Add a new action to a user's stream
 *
 * @url PUT /{user_id}
 *
 * @param integer   $user_id    The user_id for whom the actions apply; you can insert the text "self" and it will resolve to the current/default user
 * @param string    $start_time {@from body} The date/time that the activity was started (YYYY-MM-DD or YYYY-MM-DD HH:mm:SS)
 * @param string    $action_nm  {@from body} The action "slug name" that uniquely identifies an action
 * @param string    $end_time   {@from body} The date/time that the activity concluded (YYYY-MM-DD or YYYY-MM-DD HH:mm:SS)
 * @param string    $app_id     {@from body} The application that captured this activity
 * @param string    $proxy_user_id  {@from body} The person who captured this activity for the individual
 * @param string    $location   {@from body} The location information associated with this activity
*/
public function add_activity ($user_id, $start_time, $action_nm, $end_time=null, $app_id=null, $proxy_user_id=null, $location=null, $request_data=null) 
```

请注意，没有`@param`for $request_data 但 $request_data 现在挂在函数签名的末尾。`'test' : 'me'`现在想象我在请求的 JSON 中传递了以下内容。现在我可以在我的处理程序中得到它：

```
echo $request_data['test']; // prints "me" 
```

这很有效，并且文档看起来也符合预期（请参见上面的屏幕截图）。

最后一点，对于那些好奇的人，您可以通过 $request_data 数组访问所有 J​​SON 变量。这意味着：

```
echo ($request_data['user_id'] === $user_id); // TRUE 
```

# ruby-on-rails-3 - 为什么或在哪里应该在 rails3 中使用 config.ru

> ID：14707632
> 
> 赞同：0
> 
> 时间：2013-02-05T12:31:35.327
> 
> 标签：ruby-on-rails-3

我不明白为什么 config.ru 文件在 rails3 中。请解释为什么会有？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T12:52:45.810

`rails server`完成创建`Rack::Builder`对象和启动网络服务器的基本工作。这是 Rails 的 Rack`rackup`脚本的等价物。

下面是如何`rails server`创建一个实例`Rack::Builder`

```
app = Rack::Builder.new {
  use Rails::Rack::LogTailer unless options[:detach]
  use Rails::Rack::Debugger if options[:debugger]
  use ActionDispatch::Static
  run ActionController::Dispatcher.new
}.to_app 
```

要`rackup`代替 Rails 的 rails 服务器，您可以将以下内容放在`config.ru`Rails 应用程序的根目录中：

```
# Rails.root/config.ru
require "config/environment"

use Rails::Rack::LogTailer
use ActionDispatch::Static
run ActionController::Dispatcher.new 
```

并启动服务器：

```
$ rackup config.ru 
```

要了解有关不同机架选项的更多信息：

```
$ rackup --help 
```

要了解更多 rakup，请查看[Ruby on Rails 指南](http://guides.rubyonrails.org/rails_on_rack.html)

# java - Jenkins Java API 和构建参数

> ID：14707633
> 
> 赞同：1
> 
> 时间：2013-02-05T12:31:36.143
> 
> 标签：java, api, jenkins

我正在将一个外部工具与 Jenkins 集成。部分集成要求用户必须能够使用 Jenkins 远程处理 Java API 调用参数化构建 / 如此处所述： [Kohsuke Kawaguchi 的示例 git repo](https://github.com/jenkinsci/cli-channel-demo/blob/master/src/main/java/org/jenkinsci/demo/cli/App.java) /；

参数将根据正在构建的内容而有所不同，即对于 Maven，它们将是人工制品和组 ID，对于自由式项目 - 文件夹路径、文件名等。

是否有允许您这样做的插件/设置？

我想创建一个 Jenkins 预构建步骤，它解析和转换我们通过 / 依赖于一些命名约定 / 发送的任何参数，然后调用主要的 Jenkins 构建步骤。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T12:50:01.113

查看[Jenkins CLI](https://wiki.jenkins-ci.org/display/JENKINS/Jenkins+CLI)，它允许您从脚本或 shell 访问 Jenkins。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T01:40:55.400

我认为您要做的是创建一个可重用的 Jenkins 构建作业，在运行时传入所有变量？很难维护这种设置，我认为使用 Jenkins API 为每个项目自动生成 Jenkins 作业更简单。

[对于复杂的参数处理，也许您应该考虑使用像rundeck](http://rundeck.org/)这样的替代工具？它是 Jenkins 的补充工具（请参阅[Rundeck 插件](https://wiki.jenkins-ci.org/display/JENKINS/RunDeck+Plugin)），最适合跨机器网络执行一般自动化任务。我在这个上下文中提到它是因为它有一个非常灵活的机制来配置作业选项，你可以用它来运行你的构建......

# iphone - 导航栏按钮不显示

> ID：14707634
> 
> 赞同：1
> 
> 时间：2013-02-05T12:31:38.030
> 
> 标签：iphone, ios6, uinavigationcontroller

当尝试在左侧和右侧添加导航按钮时，它没有显示？这是我使用的代码，这有什么问题？

这就是我在 appdelegate 中添加导航栏的方式，

```
 UIViewController *viewController1 = [[logyFirstViewController alloc] initWithNibName:@"logyFirstViewController" bundle:nil];
  UIViewController *viewController2 = [[logySecondViewController alloc] initWithNibName:@"logySecondViewController" bundle:nil];
  UIViewController *viewController3 = [[record alloc] initWithNibName:@"record" bundle:nil];
  UIViewController *viewController4 = [[searchview alloc] initWithNibName:@"searchview" bundle:nil];
  UIViewController *viewController5 = [[profilde alloc] initWithNibName:@"profilde" bundle:nil];
 self.tabBarController = [[UITabBarController alloc] init];

self.tabBarController.viewControllers = @[viewController1, viewController2, viewController3, viewController4, viewController5];
navigationController = [[UINavigationController alloc] initWithRootViewController:self.tabBarController];

self.navigationController.navigationBar.barStyle=UIBarStyleDefault;

[navigationController.navigationBar setAlpha:0.8f];
 [self.window addSubview:[navigationController view]];

 button4 = [UIButton buttonWithType:UIButtonTypeCustom];
 [button4 setFrame:CGRectMake(0.0f, 0.0f, 25.0f, 25.0f)];
 [button4 addTarget:self action:@selector(back) forControlEvents:UIControlEventTouchUpInside];
 [button4 setImage:[UIImage imageNamed:@"del.png"] forState:UIControlStateNormal];
 UIBarButtonItem *random1 = [[UIBarButtonItem alloc] initWithCustomView:button4];
 self.navigationController.navigationItem.leftBarButtonItem=random1; 
```

请帮忙。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-05T15:16:38.687

我认为您的代码没有任何问题，只需检查您的图像或尝试使用圆形矩形图像进行测试

```
UIButton* button4 = [UIButton buttonWithType:UIButtonTypeRoundedRect];
[button4 setFrame:CGRectMake(0.0f, 0.0f, 25.0f, 25.0f)];
[button4 addTarget:self action:@selector(back) forControlEvents:UIControlEventTouchUpInside];
UIBarButtonItem *random1 = [[UIBarButtonItem alloc] initWithCustomView:button4]; 
```

并使用 `self.navigationController.navigationBar.topItem.leftBarButtonItem=random1;` 而不是 `self.navigationController.navigationItem.leftBarButtonItem=random1;`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-05T12:45:20.910

问题出在以下行：

```
self.navigationController.navigationItem.leftBarButtonItem=random1; 
```

只需使用

```
self.navigationItem.leftBarButtonItem=random1; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T12:38:32.007

```
UIButton *button4 =  [UIButton buttonWithType:UIButtonTypeCustom];
[button4 setImage:[UIImage imageNamed:@"del.png"] forState:UIControlStateNormal];
[button4 addTarget:self action:@selector(back) forControlEvents:UIControlEventTouchUpInside];
[button4 setFrame:CGRectMake(0.0f, 0.0f, 25.0f, 25.0f)]];
    self.navigationItem.leftBarButtonItem = [[[UIBarButtonItem alloc] initWithCustomView:button4] autorelease]; 
```

对 leftBarButtonItem 使用相同的方法。希望它对你有用。谢谢

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T12:48:04.673

希望它对你有用...

```
UIButton *button4 = [UIButton buttonWithType:UIButtonTypeCustom];
[button4 setFrame:CGRectMake(0.0f, 0.0f, 25.0f, 25.0f)];
[button4 addTarget:self action:@selector(back) forControlEvents:UIControlEventTouchUpInside];
[button4 setImage:[UIImage imageNamed:@"del.png"] forState:UIControlStateNormal];
UIBarButtonItem *random1 = [[UIBarButtonItem alloc] initWithCustomView:button4];
[button4 release];

[[self navigationItem] setLeftBarButtonItem:random1];
[random1 release]; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-05T12:56:07.343

```
UIBarButtonItem *barBtnItem = [[UIBarButtonItem alloc] initWithTitle:@"back" style:UIBarButtonItemStyleBordered target:self action:@selector(nextToPhoneAuth)];
self.navigationItem.backBarButtonItem = barBtnItem 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-05T12:58:33.827

请检查您的导航栏是否提供了隐藏属性，并尝试使用默认的后退按钮一次，让我们知道它是否工作。

# r - 可视化以日期范围表示的时间范围数据

> ID：14707635
> 
> 赞同：3
> 
> 时间：2013-02-05T04:26:42.003
> 
> 标签：r, data-visualization

我想可视化下面给出的五个项目的时间框架数据。目前我正在使用 OpenOffice 绘图应用程序并手动生成如下所示的图表。但我不满意。你能帮我解决以下问题吗？谢谢你。

```
1\. How can I produce somewhat similar graphs using R (or excel) with better precision in terms of days? 
2\. Is there a way for better visualization of the data? If so, please let me know how to produce that using R or Excel. 

Project     Time
-------    ------ 
A   Feb 15 – March 1
B   March 15 – June 15
C   Feb 1 – March 15
D   April 10 – May 15
E   March 1 – June 30 
```

![在此处输入图像描述](../Images/3ac76dafa01e543ced54c2e5a20fb0c3.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T05:14:38.003

`ggplot2`提供了一种（合理）直接的方式来构建绘图。

首先，您需要将数据放入`R`. 你希望你的开始和结束日期是某种`Date`格式`R`（我用过`Date`）

```
library(ggplot2)
library(scales) # for date formatting with ggplot2

DT <- data.frame(Project = LETTERS[1:5], 
  start = as.Date(ISOdate(2012, c(2,3,2,4,3), c(15,15,1,10) )),
  end = as.Date(ISOdate(2012, c(3,5,3,5,6), c(1,15,15,15,30))))
# it is useful to have a numeric version of the Project column (
DT$ProjectN <- as.numeric(DT$Project) 
```

您还需要计算放置文本的位置，我将使用 plyr 包中的 `ddply1

```
library(plyr)
# find the midpoint date  for each project
DTa <- ddply(DT, .(ProjectN, Project), summarize, mid = mean(c(start,end))) 
```

你想创建

*   每个项目的矩形，因此您可以使用`geom_rect`
*   每个中点的文本标签

这是一个如何构建情节的示例

```
ggplot(DT) + 
   geom_rect(aes(colour = Project,ymin = ProjectN - 0.45, 
                ymax = ProjectN + 0.45,  xmin = start, xmax = end)), fill = NA) + 
  scale_colour_hue(guide = 'none') +  # this removes the legend
 geom_text(data = DTa, aes(label = Project, y = ProjectN, x = mid,colour = Project), inherit.aes= FALSE) + # now some prettying up to remove text / axis ticks
  theme(panel.background = element_blank(), 
        axis.ticks.y = element_blank(), axis.text.y = element_blank()) + # and add date labels
  scale_x_date(labels = date_format('%b %d'), 
  breaks = sort(unique(c(DT$start,DT$end))))+ # remove axis labels
  labs(y = NULL, x = NULL) 
```

![在此处输入图像描述](../Images/7fc857f45b4119d5c0e64e8333dfeee1.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-05T05:49:00.220

您还可以检查 plotrix 包中的 gantt.chart 函数。

```
library(plotrix)
?gantt.chart 
```

这是一种实现

```
dmY.format<-"%d/%m/%Y"
gantt.info<-list(
  labels= c("A","B","C","D","E"),
  starts= as.Date(c("15/02/2012", "15/03/2012", "01/02/2012", "10/04/2012","01/03/2012"),
                  format=dmY.format),
  ends= as.Date(c("01/03/2012", "15/06/2012", "15/03/2012", "15/05/2012","30/06/2012"),
                format=dmY.format)
  )

vgridpos<-as.Date(c("01/01/2012","01/02/2012","01/03/2012","01/04/2012","01/05/2012","01/06/2012","01/07/2012","01/08/2012"),format=dmY.format)
vgridlab<-
  c("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug")

gantt.chart(gantt.info, xlim= c(as.Date("01/01/2012",format=dmY.format), as.Date("01/08/2012",format=dmY.format)) , main="Projects duration",taskcolors=FALSE, border.col="black",
            vgridpos=vgridpos,vgridlab=vgridlab,hgrid=TRUE) 
```

![在此处输入图像描述](../Images/26450ac43dba98a84c56d60b7f34c443.png)

我也试过ggplot2。但是 mnel 比我快。这是我的代码

```
data1 <- as.data.frame(gantt.info)
data1$order <- 1:nrow(data1)

library(ggplot2)

ggplot(data1, aes(xmin = starts, xmax = ends, ymin = order, ymax = order+0.5)) + geom_rect(color="black",fill=FALSE) + theme_bw()  + geom_text(aes(x= starts + (ends-starts)/2 ,y=order+0.25, label=labels)) +  ylab("Projects") + xlab("Date") 
```

![在此处输入图像描述](../Images/1546bbf173d7cb392cab24b4799d50be.png)

# javascript - 通过电子邮件发送 HTML 表格

> ID：14707641
> 
> 赞同：0
> 
> 时间：2013-02-05T12:32:00.697
> 
> 标签：javascript, php, jquery, html-table

我是 Web 开发的新手。我有一个使用 jQuery 生成的动态 HTML 表。我想通过单击按钮邮寄表格。我能够使用 JavaScript 读取表格，但在那之后我很震惊。我不知道如何使用 PHP ( mailto ) 函数通过电子邮件发送它。

按钮代码：

```
<button name="doModify" onclick="OQ()">Mail</button> 
```

Javascript：

```
 function mail_content()    
 {    
   var tableContent = document.getElementById("cartcontent").innerHTML;    
   var mBody = "<html><body><table>" + tableContent + "</table></body></html>";    
   alert(mBody);    
 } 
```

如何邮寄我用 Javascript 构建的字符串。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T12:35:38.637

您需要在函数中添加 ajax 并通过 ajax 发送内容。然后在接收通过ajax发送的内容后使用邮件功能

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T12:41:19.020

```
<button name="doModify" onclick="mail_content()">Mail</button> 
<script>
     function mail_content()    
     {    
       var tableContent = document.getElementById("cartcontent").innerHTML;    
       $.post('mail.php',{content:tablecontent},function(data) {
    });
     }
</script> 
```

在 mail.php 中

```
<?php
$to = "somebody@example.com";
$subject = "ur subject";
$txt = $_POST['content'];
$headers = "From: webmaster@example.com" . "\r\n" .
"CC: somebodyelse@example.com";

mail($to,$subject,$txt,$headers);
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T12:36:44.830

1.  使用 ajax 将此字符串发送到 php 文件，或将内容复制到表单的隐藏字段，然后使用 javascript 提交该表单。

2.  在该 php 文件中，获取内容并使用 PHP 发送邮件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T12:37:49.080

**邮寄：**

```
function mail_content() {
  var tableContent = document.getElementById("cartcontent").innerHTML;
  var mBody = "" + tableContent + "";
  document.location.href = "mailto:test@domain.com?subject=Titel&body=" + mBody;  
} 
```

**没有 jQuery 的 HTTP 请求：**

```
function myHttp(){
    var tableContent = document.getElementById("cartcontent").innerHTML;    
    var mBody = "<html><body><table>" + tableContent + "</table></body></html>";

    var url = "mail.php";
    var http = new XMLHttpRequest();
    http.open("POST", url, true);
    http.setRequestHeader("Content-type", "application/x-www-form-urlencoded");

    http.onreadystatechange = function() {
        if(http.readyState == 4 && http.status == 200) {
            alert(http.responseText);
        }
    }
    http.send('data=' + mBody);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-05T12:38:16.377

mail() 函数只存在于 php.ini 中。您需要向发送此变量的 php 文件发出 ajax 请求，并使 php 文件在 mail() 函数中使用该变量。

# iphone - 如何将图像从我们的应用程序导出到 Instagram？

> ID：14707642
> 
> 赞同：3
> 
> 时间：2013-02-05T12:32:01.433
> 
> 标签：iphone, ios, objective-c, instagram

我使用了以下代码，但它没有用。我想将我的应用程序中的图像放到我 iPhone 上安装的 Instagram 应用程序中。

```
NSString *fileToOpen = [[NSBundle mainBundle] pathForResource:@"IMG_0192"  ofType:@"jpg"];
fileToOpen = [fileToOpen substringToIndex:[fileToOpen length] - 3];
fileToOpen=[NSString stringWithFormat:@"%@ig",fileToOpen];
NSURL *instagramURL = [NSURL URLWithString:@"instagram://app"];
NSLog(@"%@",fileToOpen);
if ([[UIApplication sharedApplication] canOpenURL:instagramURL]) {
//imageToUpload is a file path with .ig file extension
/*UIAlertView *alert = [[UIAlertView alloc] 
                      initWithTitle:@"" 
                      message:@"Can open app!" 
                      delegate:self  
                      cancelButtonTitle:@"OK" 
                      otherButtonTitles:nil];
[alert show];
*/

self.documentInteractionController = [UIDocumentInteractionController interactionControllerWithURL:[NSURL fileURLWithPath:fileToOpen]];
self.documentInteractionController.UTI = @"com.instagram.photo";
self.documentInteractionController.annotation = [NSDictionary dictionaryWithObject:@"Its a testing" forKey:@"InstagramCaption"]; 
```

我尝试了很多，但它根本不起作用。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-05T12:35:19.250

您可以使用以下代码将图像从您的应用程序共享到安装在 iPhone 上的 Instagram 应用程序。

```
- (void) shareImageToInstagram 
{
    NSURL *instagramURL = [NSURL URLWithString:@"instagram://"];
    if ([[UIApplication sharedApplication] canOpenURL:instagramURL]) 
    {
        CGRect rect = CGRectMake(0,0,0,0);
        CGRect cropRect=CGRectMake(0,0,612,612);
        NSString *jpgPath=[NSHomeDirectory() stringByAppendingPathComponent:@"Documents/test.igo"];
        CGImageRef imageRef = CGImageCreateWithImageInRect([imgViewPost.image CGImage], cropRect);
        UIImage *img = [[UIImage alloc] initWithCGImage:imageRef];
        CGImageRelease(imageRef);

        [UIImageJPEGRepresentation(img, 1.0) writeToFile:jpgPath atomically:YES];
        NSURL *igImageHookFile = [[NSURL alloc] initWithString:[[NSString alloc] initWithFormat:@"file://%@",jpgPath]];
        self.dicont.UTI = @"com.instagram.photo";
        self.dicont = [self setupControllerWithURL:igImageHookFile usingDelegate:self];
        self.dicont.annotation = [NSDictionary dictionaryWithObject:@"Your AppName" forKey:@"InstagramCaption"];
        [self.dicont presentOpenInMenuFromRect: rect  inView: self.view animated: YES ];
    }
    else
    {
        DisplayAlert(@"Instagram not installed in this device!\nTo share image please install instagram.");
    }
}

- (UIDocumentInteractionController *) setupControllerWithURL: (NSURL*) fileURL usingDelegate: (id <UIDocumentInteractionControllerDelegate>) interactionDelegate {
    UIDocumentInteractionController *interactionController = [UIDocumentInteractionController interactionControllerWithURL: fileURL];
    interactionController.delegate = interactionDelegate;

    return interactionController;
} 
```

请尝试此代码..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T12:42:04.517

您可以使用此代码：

```
-(void)shareImageOnInstagram:(UIImage*)shareImage
{
   //It is important that image must be larger than 612x612 size if not resize it.   

    NSURL *instagramURL = [NSURL URLWithString:@"instagram://app"];

    if([[UIApplication sharedApplication] canOpenURL:instagramURL])
    {
        NSString *documentDirectory=[NSHomeDirectory() stringByAppendingPathComponent:@"Documents"];
        NSString *saveImagePath=[documentDirectory stringByAppendingPathComponent:@"Image.ig"];
        NSData *imageData=UIImagePNGRepresentation(shareImage);
        [imageData writeToFile:saveImagePath atomically:YES];

        NSURL *imageURL=[NSURL fileURLWithPath:saveImagePath];

        UIDocumentInteractionController *docController=[[UIDocumentInteractionController alloc]init];
        docController.delegate=self;
        [docController retain];
        docController.UTI=@"com.instagram.photo";

        docController.annotation=[NSDictionary dictionaryWithObjectsAndKeys:@"Image Taken via @App",@"InstagramCaption", nil];

        [docController setURL:imageURL];

        [docController presentOpenInMenuFromBarButtonItem:self.navigationItem.rightBarButtonItem animated:YES];  //Here try which one is suitable for u to present the doc Controller. if crash occurs
    }
    else
    {
        NSLog ("Instagram is not available");
    }
} 
```

# ios - 将 .txt 附加到 MFMailComposeViewController

> ID：14707645
> 
> 赞同：14
> 
> 时间：2013-02-05T12:32:11.430
> 
> 标签：ios, objective-c, xcode, email-attachments, mfmailcomposeviewcontroller

我有一个 .txt 文件存储在 Documents 文件夹中，我想通过 MFMailComposeViewController 发送它，并在`-sendEmail`方法主体中使用下一个代码：

```
NSData *txtData = [NSData dataWithContentsOfFile:[[NSBundle mainBundle] pathForResource:@"dataBase" ofType:@"txt"]];
        [mail addAttachmentData:txtData mimeType:@"text/plain" fileName:[NSString stringWithFormat:@"dataBase.txt"]]; 
```

当 Mail composer 出现时，我可以在邮件正文中看到附件，但我收到的邮件没有附件。.txt 附件的 MIME 类型可能是错误的，或者此代码有问题？

谢谢

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-02-05T12:37:21.740

```
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory,NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:0];        
        NSString *txtFilePath = [documentsDirectory stringByAppendingPathComponent:@"abc.txt"];
NSData *noteData = [NSData dataWithContentsOfFile:txtFilePath];
        MFMailComposeViewController *_mailController = [[MFMailComposeViewController alloc] init];
        [_mailController setSubject:[NSString stringWithFormat:@"ABC"]];
        [_mailController setMessageBody:_messageBody
                                 isHTML:NO];
        [_mailController setMailComposeDelegate:self];
        [_mailController addAttachmentData:noteData mimeType:@"text/plain" fileName:@"abc.txt"]; 
```

希望能帮助到你。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2017-05-11T05:43:32.993

在 Swift 3 中，您可以像这样发送带有附件的邮件

```
@IBAction func emailLogs(_ sender: Any) {
    let allPaths = NSSearchPathForDirectoriesInDomains(.documentDirectory, .userDomainMask, true)
    let documentsDirectory = allPaths.first!
    let pathForLog = documentsDirectory.appending("/application.log")

    if MFMailComposeViewController.canSendMail() {
        let mail = MFMailComposeViewController()
        mail.mailComposeDelegate = self;
        mail.setToRecipients(["recipient@email.com"])
        mail.setSubject("Application Logs")
        mail.setMessageBody("Please see attached", isHTML: true)

        if let fileData = NSData(contentsOfFile: pathForLog) {
            mail.addAttachmentData(fileData as Data, mimeType: "text/txt", fileName: "application.log")
        }

        self.present(mail, animated: true, completion: nil)
    }
} 
```

然后在结果上关闭作曲家控制器

```
func mailComposeController(_ controller: MFMailComposeViewController, didFinishWith result: MFMailComposeResult, error: Error?) {
    controller.dismiss(animated: true, completion: nil)
} 
```

确保订阅此委托

```
MFMailComposeViewControllerDelegate 
```

# unix - 显示包含指定字符串的行的 UNIX 命令

> ID：14707646
> 
> 赞同：0
> 
> 时间：2013-02-05T12:32:17.250
> 
> 标签：unix

我的文件包含以下内容：

嗨，你好吗，你是天才，嗨，我很好，这是测试课程

我需要显示包含“是”字的行的 UNIX 命令。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T12:34:05.550

嗯，这真的是`grep`.

```
grep -w "are" myfile.txt 
```

# c# - 实现自定义 IComparer<>（示例）

> ID：14707650
> 
> 赞同：5
> 
> 时间：2013-02-05T12:32:33.423
> 
> 标签：c#, compare, icomparer

我刚刚编写了以下代码，它将按其本机排序字符串，`string.Compare()`但允许一组异常（在本例`customPriority`中）将优先于默认`string.Compare()`函数。

这一切似乎有点啰嗦，我想知道 .NET 中是否有内置的东西允许这样做？

```
 var unorderered = new[] { "a", "b", "c", "x", "y", "z" };
    var ordered = unorderered.OrderBy(a => a, new CustomStringComparer());
    //expected order y,x,a,b,c,z

class CustomStringComparer : IComparer<string>
{
    int IComparer<string>.Compare(string x, string y)
    {
        if (x == y)
            return 0;
        else
        {
            //----------------------------
            //beginning of custom ordering
            var customPriority = new[] { "y", "x" };
            if (customPriority.Any(a => a == x) && customPriority.Any(a => a == y)) //both in custom ordered array
            {
                if (Array.IndexOf(customPriority, x) < Array.IndexOf(customPriority, y))
                    return -1;                   
                return 1;
            }
            else if (customPriority.Any(a => a == x)) //only one item in custom ordered array (and its x)                    
                return -1;
            else if (customPriority.Any(a => a == y)) //only one item in custom ordered array (and its y)                    
                return 1;
            //---------------------------
            //degrade to default ordering
            else
                return string.Compare(x, y);

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T13:27:02.963

首先，我认为重述问题很有用：您想按以下方式排序：

1.  给定数组中的索引；如果该项目不在数组中，则索引为无穷大
2.  字符串本身

`OrderBy()`这意味着您可以通过使用第一个条件，然后使用第二个条件来实现排序顺序`ThenBy()`：

```
private static uint NegativeToMaxValue(int i)
{
    if (i < 0)
        return uint.MaxValue;
    return (uint)i;
}

…

var ordered = unorderered
    .OrderBy(a => NegativeToMaxValue(Array.IndexOf(new[] { "y", "x" }, a)))
    .ThenBy(a => a); 
```

`NegativeToMaxValue()`是必要的，因为不在数组中的项目应该在最后，但通常它们会在第一个，因为索引是-1。（一种骇人听闻且难以理解的方法是直接将结果转换为`IndexOf()`to `uint`。）

如果您想通过创建一个 .Net 来重用这种排序`IComparer`，我相信 .Net 中没有任何东西可以帮助您。但是您可以改用[ComparerExtensions](https://github.com/jehugaleahsa/ComparerExtensions)：

```
IComparer<string> comparer = KeyComparer<string>
    .OrderBy(a => NegativeToMaxValue(Array.IndexOf(new[] { "y", "x" }, a)))
    .ThenBy(a => a); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T12:56:41.873

没有内置的比较方法可以做你想做的事，但我猜这不是你所说的“冗长”部分。

令人讨厌的是，您必须创建一个自定义比较器类才能传递应该是一个简单的比较函数。

好吧，有一种方法可以减轻这种情况。您可以编写几个帮助类，让您只需传递一个方法的名称就可以使用 OrderBy()。如果您编写这些类，它们将适用于您的所有 OrderBy() 语句。

这是一些示例代码。辅助类称为 EnumerableExt 和 ComparisonDelegator。它们一起工作以允许您将方法传递给 OrderBy()。

下面的代码显然比您的代码长得多，但请记住，EnumerableExt 和 ComparisonDelegator 类将位于单独的公共程序集中，因此您不应计算它们。

```
using System;
using System.Collections;
using System.Collections.Generic;
using System.Diagnostics.Contracts;
using System.Linq;

namespace Demo
{
    public static class Program
    {
        private static void Main(string[] args)
        {
            var unorderered = new[] { "a", "b", "c", "x", "y", "z" };

            var ordered = unorderered.OrderBy(compare); // Just need to specify the compare method!
        }

        // Each custom compare method must be written specially, as before:

        private static int compare(string x, string y)
        {
            if (x == y)
                return 0;
            else
            {
                //----------------------------
                //beginning of custom ordering
                var customPriority = new[] { "y", "x" };
                if (customPriority.Any(a => a == x) && customPriority.Any(a => a == y)) //both in custom ordered array
                {
                    if (Array.IndexOf(customPriority, x) < Array.IndexOf(customPriority, y))
                        return -1;
                    return 1;
                }
                else if (customPriority.Any(a => a == x)) //only one item in custom ordered array (and its x)                    
                    return -1;
                else if (customPriority.Any(a => a == y)) //only one item in custom ordered array (and its y)                    
                    return 1;
                //---------------------------
                //degrade to default ordering
                else
                    return string.Compare(x, y);

            }
        }
    }

    // The following classes only need to be written once:

    public static class EnumerableExt
    {
        /// <summary>
        /// Convenience method on IEnumerable{T} to allow passing of a
        /// Comparison{T} delegate to the OrderBy method.
        /// </summary>

        public static IEnumerable<T> OrderBy<T>(this IEnumerable<T> list, Comparison<T> comparison)
        {
            Contract.Requires(list != null, "list can't be null.");
            Contract.Requires(comparison != null, "comparer can't be null.");

            return list.OrderBy(t => t, new ComparisonDelegator<T>(comparison));
        }
    }

    /// <summary>
    /// Provides a mechanism for easily converting a Comparison&lt;&gt; delegate (or lambda) to an IComparer&lt;&gt;.
    /// This can be used for List.BinarySearch(), for example.
    /// </summary>
    /// <typeparam name="T">The type of items to be compared.</typeparam>

    public sealed class ComparisonDelegator<T>: IComparer<T>, IComparer
    {
        /// <summary>Create from a Comparison&lt;&gt; delegate.</summary>
        /// <param name="comparison">A Comparison&lt;&gt; delegate.</param>

        public ComparisonDelegator(Comparison<T> comparison)
        {
            Contract.Requires(comparison != null);

            this._comparison = comparison;
        }

        /// <summary>Implements the IComparer.Compare() method.</summary>

        public int Compare(T x, T y)
        {
            return _comparison(x, y);
        }

        /// <summary>Implements the IComparer.Compare() method.</summary>

        public int Compare(object x, object y)
        {
            return _comparison((T)x, (T)y);
        }

        /// <summary>Used to store the Comparison delegate.</summary>

        private readonly Comparison<T> _comparison;
    }
} 
```

然后，您还可以如下内联编写 compare 方法（但我不建议将这种方法用于如此复杂的 compare 方法；这只是为了说明）：

```
 private static void Main(string[] args)
    {
        var unorderered = new[] { "a", "b", "c", "x", "y", "z" };

        var ordered = unorderered.OrderBy((x, y) =>
        {
            if (x == y)
                return 0;
            else
            {
                var customPriority = new[] { "y", "x" };
                if (customPriority.Any(a => a == x) && customPriority.Any(a => a == y)) //both in custom ordered array
                {
                    if (Array.IndexOf(customPriority, x) < Array.IndexOf(customPriority, y))
                        return -1;
                    return 1;
                }
                else if (customPriority.Any(a => a == x)) //only one item in custom ordered array (and its x)                    
                    return -1;
                else if (customPriority.Any(a => a == y)) //only one item in custom ordered array (and its y)                    
                    return 1;
                else
                    return string.Compare(x, y);
            }
        });
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T12:36:58.250

## 我有 99.99% 的把握，在 .Net 框架中默认不存在这样的东西。

* * *

您的排序是非常自定义的，不是一种通用的排序方式，因此默认情况下，.NET Framework 中不存在类似的排序。

# ocaml - 在 OCaml 中写这个的正确方法是什么？

> ID：14707651
> 
> 赞同：4
> 
> 时间：2013-02-05T12:32:37.470
> 
> 标签：ocaml

```
type t = MyInt of int | MyFloat of float | MyString of string
let foo printerf = function
  | MyInt i -> printerf string_of_int i
  | MyFloat x -> printerf string_of_float x
  | MyString s -> printerf (fun x -> x) s 
```

它报告：

```
Error: This expression has type float -> string
       but an expression was expected of type int -> string 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-05T16:34:57.327

移植这个确切的代码片段（我猜它来自[这个网页](http://www.podval.org/~sds/ocaml-sucks.html)）的正确方法是使用一流的多态性，如本常见问题解答条目中所述：[如何编写具有多态参数的函数？](http://caml.inria.fr/resources/doc/faq/core.en.html#polymorphic-arguments). 请阅读常见问题解答条目，但为了快速参考，这里是工作代码的一个示例：

```
type t = MyInt of int | MyFloat of float | MyString of string

type 'b printer = { print : 'a . ('a -> string) -> 'a -> 'b }
let foo erf = function
  | MyInt i -> erf.print string_of_int i
  | MyFloat x -> erf.print string_of_float x
  | MyString s -> erf.print (fun x -> x) s

let () = foo
  { print = fun printer data -> print_endline (printer data) }
  (MyString "Hello World!") 
```

但是请注意，您实际上并不*需要*这种一流的多态性。通过参数化，唯一`printer`可以对类型数据做的事情`'a`就是将它传递给打印函数 `'a -> string`。所以打印机的行为完全取决于它对结果`string`数据的作用。换句话说，类型与类型`'b printer`同构`string -> 'b`，它不会带来其他信息。所以你可以写：

```
let foo erf = function
  | MyInt i -> erf (string_of_int i)
  | MyFloat x -> erf (string_of_float x)
  | MyString s -> erf s

let () = foo print_endline (MyString "Hello World!") 
```

的类型`foo`是现在`(string -> 'a) -> t -> 'a`。这被称为 *延续传递风格*：摆脱这种类型的唯一方法`'a`是在字符串上调用参数函数，所以实际上你只是返回一个字符串并调用函数（延续）在上面。这可以重写为：

```
let foo = function
  | MyInt i -> string_of_int i
  | MyFloat x -> string_of_float x
  | MyString s -> s

let () = print_endline (foo (MyString "Hello World!")) 
```

长话短说：您展示的代码过于复杂，而且它似乎提出的问题被夸大了。这里不需要复杂的类型系统。（但您当然可以找到更好的示例，其中常见问题解答中演示的一流多态性实际上很有用。只是碰巧这个示例......很烂。）

## 历史和科学背景

问题要求的关于一流多态性的历史性旁白。

`'a . ('a -> string) -> 'a -> 'b`意思是“为所有人`'a`” `('a -> string) -> 'a -> 'b`。它是类型变量中的多态类型`'a`（由`'a .`位“定义”），并且具有自由变量`'b`（定义为`printer`类型的参数）。

`foo`上面代码的第一个版本中的类型是`'b printer -> t -> 'b`. 可以理解为对[System F](http://en.wikipedia.org/wiki/System_F)类型进行编码

```
forall 'b . (forall 'a . ('a -> string) -> 'a -> 'b) -> t -> 'b 
```

ML 类型推断算法是推断类型仅限于“前缀多态”，即所有类型变量都在前面量化的类型。这是上述`'b`类型的情况，但不是*在*（多态）参数`'a`中量化的。完全尊重 ML (Hindley-Damas-Milner) 推理系统的这种限制的类型系统不会推断出这种类型，因此会拒绝将需要它的程序视为错误类型（意思不是“错误”但“我无法证明它是正确的” ）。

 *这种限制使得推理系统既可判定（完整系统 F 的类型推断是不可判定的（Joe B. Wells））和“主体”（如果您不知道主体类型是什么，请参阅[此 SO 讨论](https://stackoverflow.com/a/11545705/298143)；简而言之，这意味着推理引擎总是选择最通用的类​​型），但它也拒绝类型良好的程序，这通常是安全类型系统的祸根。

大多数 ML 语言（OCaml、Haskell ......）在某些时候遇到了他们真正希望能够编写的代码的这种限制。对于 90 年代出现的 OCaml，当时正在使用该语言对面向对象的编程模式进行编码（参见[手册中的示例](http://caml.inria.fr/pub/docs/manual-ocaml/manual005.html#toc28)）。

这就是为什么第一类多态性首先在方法类型中引入，后来扩展到记录（第一类模块是一个独立的、最近添加的也允许这样做）。有一个很好的理由为什么这在某种意义上仍然或多或少地局限于具有“字段”的“事物”，因为这为放置（必要的）多态性注释提供了一种自然的方式，而字段投影是一个很好的地方类型检查器来测试实例化多态值的需要——如果你愿意的话，这会使理论更简单。

有关 OCaml 社区这一时期的研究工作，请参见[Extending ML with Semi-Explicit Higher-Order Polymorphism](http://cristal.inria.fr/~remy/publications_abstracts.html#Garrigue-Remy/poly-ml/tacs) , Jacques Garrigue 和 Didier Rémy, 1997。已经开发了其他一流多态性的方法（参见第 5 节（相关著作） ) ，以及其他用例，特别是Haskell 中的 monad ( [Lazy Functional State Threads](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.144.2237)，Simon Peyton Jones 和 John Launchbury，1994) [。](http://gallium.inria.fr/~remy/publications_abstracts.html#LeBotlan-Remy/recasting-mlf)`ST`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T12:42:11.260

从这条线

```
| MyInt i -> printerf string_of_int i 
```

编译器推断 的第一个参数`printerf`应该有 type `int -> string`，但从下一行

```
| MyFloat x -> printerf string_of_float x 
```

似乎第一个论点`printerf`应该是 a `float -> string`。我想你知道 OCaml 对整数和实数有不同的类型......所以这种类型的冲突`printerf`让编译器生病了。

`printerf`您期望此代码中的类型是什么类型？也许您应该避免使用高阶函数并更直接地实现到字符串的转换？*

# linq - 有序查询中一行的百分比

> ID：14707655
> 
> 赞同：0
> 
> 时间：2013-02-05T12:32:45.437
> 
> 标签：linq

好奇的问题，不知道如何在 linq 中执行此操作。部分问题可能是我试图一次完成这一切。

我有一个相位表

```
[id, name, [order]]
{{1, 'phase 2', 2}, {2, 'phase 1', 1} 
```

我想在给定的 phaseid 的所有阶段中获得一定百分比的进度。

我知道用 sql 做到这一点的方法。

```
SELECT (SELECT a.row
        FROM   [phase] p 
               INNER JOIN (SELECT Row_number() 
                                    OVER( 
                                      ORDER BY [order]) row,
                                  id 
                           FROM   [phase]) p2 
                       ON p2.id = p.id 
        WHERE  p.id = @phaseid) / CONVERT(FLOAT, Count(*)) 
FROM   [phase] 
```

有没有办法在 linq 中做到这一点？我所有的尝试似乎都失败了

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T12:47:37.687

尝试以下操作：

```
var query = phases.OrderBy(x => x.Order).Select(x => x.Id).ToList();
var result = query.Select((x, i) => new { x.Id, Index = i + 1 })
                  .Single(x => x.Id == phaseId).Index / (double)query.Count; 
```

它首先从数据库中查询所有已正确排序的阶段的 ID。然后在内存中生成行号并过滤掉具有请求 ID 的阶段。
然后根据指数和相总数计算百分比。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T13:26:48.650

我为将来解决这个问题的任何人工作的第一件事。VB.net

```
Dim query = (From p2 In db.Phases Order By p2.Order).AsEnumerable().Select(Function(p2, index) New test With {.id = p2.ID, .row = index + 1})
Dim Percentage = query.Where(Function(x) x.id = 3).Select(Function(x) x.row).First / db.Phases.Count 
```

# javascript - 从不同的文件调用对象

> ID：14707665
> 
> 赞同：0
> 
> 时间：2013-02-05T12:33:05.503
> 
> 标签：javascript, jquery

当我从不同的文件中调用一个对象时，我遇到了一个问题。

```
function node(id, content, prev, next){
    this.id = id;
    this.prev = prev;
    this.next = next;
    this.content = content;
} 
```

如果之前未定义对象，我正在使用此代码加载外部文件。

```
function callNode(node){
    if(typeof(node) === 'undefined')
    {   
        path = "js/tree/t2.js";
        $.getScript(path, function(){
            console.log('done');
            for(i in node)
            alert(node[i]);
        });
    }
    else alert('node exist');
} 
```

在 t2.js 我有以下内容：

```
n1 = new node('text1','n1');
n2 = new node('text2','n2');
n3 = new node('text3','n3');

n2.next = n3;
n2.prev = n1; 
```

html代码：

```
<button onclick="callNode(n2)".. 
```

但它一直给我未定义的对象

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T13:52:02.143

`callNode(n2)`如果`n2`尚未初始化，则无法调用。您需要先加载脚本，然后才能访问`n2`- 例如从回调。

```
// init.js
function Node(id, content, prev, next){
    this.id = id;
    this.prev = prev;
    this.next = next;
    this.content = content;
}
var loader;
function callNode(nodeid, callback){
    if (!loader)
       loader = $.getScript("js/tree/t2.js").done(function() {
        console.log('done');
    });
    loader.done(function() {
        callback(nodes[nodeid]););
    }
}
function logNode(node) {
    // not sure whether you really want *that*, but
    for (i in node)
        alert(node[i]);
});

// t2.js
nodes = {
    n1: new Node('text1','n1'),
    n2: new Node('text2','n2'),
    n3: new Node('text3','n3')
};
nodes.n2.next = nodes.n3;
nodes.n2.prev = nodes.n1;

// event handler code:
callNode("n2", logNode); 
```

# android - Jquery Mobile：在选择列表中选择一个选项后。页面滚动到顶部

> ID：14707668
> 
> 赞同：1
> 
> 时间：2013-02-05T12:33:27.593
> 
> 标签：android, jquery, jquery-mobile, galaxy

我在三星 Galaxy SIII 上发现了这个问题，但它在 iOS 设备上运行良好。

感谢。

# c++ - 在堆栈上分配一个小对象是否比在堆上创建它（一次）更有效？

> ID：14707670
> 
> 赞同：2
> 
> 时间：2013-02-05T12:33:29.793
> 
> 标签：c++, design-patterns, objectfactory

目前使用我编写的库，我的小对象（不是多态的）被分配在一个对象池中，在一个带有`unique_ptr`'s. 现在显然我想改变这一点，因为这么多次调用 new 显然有很多开销。我很好奇它是否更有效：将对象缓存在池中（将其存储在向量中，即`vector<Object>`），或在需要时通过其 ID 创建对象。请注意，创建了很多对象。

我的意思是，我应该这样做：

在需要时创建对象？（注意这些对象很小，64-128 位，因为只包含一个 ID 和一个指向父对象的引用/指针）

```
Object ObjectFactory::create()
{
    return Object(nextId(), getParent());
}

Object ObjectFactory::get(unsigned id)
{
    return Object(id, getParent());
} 
```

或者：

```
Object& ObjectFactory::create()
{
     // get the next id of the object
     unsigned id = nextId();

     // resize (if necessary)
     if(_objects.size() <= id)
     {
        _objects.resize(id + 1);
        _objects[id]._parent = getParent();
     }

     return _objects[id];
}

Object& ObjectFactory::get(unsigned id)
{ return _objects[id]; } 
```

我特别关心的是：重新创建`Object`' 会导致很多开销吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T15:55:45.030

@LokiAstari 是对的，您的调整大小指针显然有问题。

有什么我不明白的；你说你正在使用一个对象池，但是你有太多新语句的问题。如果您使用的是对象池，我会说这正是为了避免新的语句，不是吗？

这是我的建议，尽管我不是专家，并且通常可能有更好的解决方案涉及您自己的分配器的实现（力量的黑暗面......）。您可以使用类似 的容器`std::deque`，以确保指针/引用在调整大小时的有效性。

您将从大量对象（您的池）的初始调整大小开始，您可以在需要时手动处理后续调整大小（使用预定义大小的块扩展容量），或者如果您知道应该接受新的语句不是很多，并使用 emplace_back 方法。

我也不知道您是否正在使用您的 ID 插入/删除大量对象。如果是这样，您可以考虑使用`std::unordered_map`.

这是一个使用示例`std::deque`：

```
#include <iostream>
#include <deque>

#define POOL_RESERVE 1000

// Data storage for your object
struct MyObjectData
{
    double some_data;
};

// Container returned by the factory
struct MyObject 
{
    typedef MyObjectData data_type;

    unsigned   id; 
    data_type* data;

    MyObject(): id(0), data(0) {}
    MyObject( const unsigned& id_, data_type* data_ ): id(id_), data(data_) {}

    void set( const unsigned& id_, data_type* data_ )
        { id = id_; data = data_; }
};

// MyObject Pool
class MyObjectPool
{
public:

    typedef MyObjectData data_type;

    MyObjectPool(): count(0) { pool.resize(POOL_RESERVE); }

    void get( const unsigned& id, MyObject& obj )
        {
            // Check requested index
            if ( id >= count )
                obj.set( 0, 0 );
            else
                obj.set( id, &pool[id] );
        }

    void create( MyObject& obj )
        {
            // Create new data container if needed
            if ( count++ >= pool.size() ) pool.emplace_back();

            // Return next available object
            obj.set( count-1, &pool[count-1] );
        }

private:

    unsigned count;
    std::deque<data_type> pool;
};

// MyObject factory
class MyObjectFactory
{
    typedef MyObjectFactory self;
    static MyObject local;

    static MyObjectPool& get_instance()
        {
            static MyObjectPool pool; 
            return pool;
        }

public:

    static MyObject get( const unsigned& id )
        {
            self::get_instance().get(id,local);
            return local;
        }

    static MyObject create()
        {
            self::get_instance().create(local);
            return local;
        }
};

// Define static variable
MyObject MyObjectFactory::local = MyObject();

// Usage example
int main()
{
    MyObject a,b,c;

    a = MyObjectFactory::create();
    b = MyObjectFactory::create();
    c = MyObjectFactory::get(1);
} 
```

# javascript - 单击它后，如何在 SELECT 多行中创建一个选项？

> ID：14707671
> 
> 赞同：1
> 
> 时间：2013-02-05T12:33:32.553
> 
> 标签：javascript, jquery, html

我有一个下拉菜单，其中包含水平溢出的项目，但是当我单击它时我想制作一个多行选项，以便我可以看到所有内容。

我可以尝试工具提示，但我知道工具提示不会持续很长时间。

我怎样才能实现这个多行的想法或类似的东西，而无需引入 jquery ui 和所有这些？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T12:34:27.080

理论上应该这样做

```
$('#identifier').focus(function(){
    $(this).attr('multiple','multiple');
}); 
```

# javascript - 如何绘制可通过滑块控制的动态曲线

> ID：14707673
> 
> 赞同：0
> 
> 时间：2013-02-05T12:33:35.090
> 
> 标签：javascript, html5-canvas

用户可以在运行时控制动态正弦曲线吗？例如，如果用户使用滑块控制正弦曲线，则曲线应从值更改时开始更改（而不是整个可见曲线）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T15:28:21.620

这一切都取决于你的视觉表现。

使用：

`clearRect(0, 0, canvas.width, canvas.height)`

将清除整个画布，您必须保留有关先前绘制的正弦波的信息。

可以像这样使用它：

`clearRect(theta, 0, period, canvas.height)`

IE 仅重绘您希望让用户控制的画布部分，然后重绘修改后的正弦波。

这是一个小提琴：

[http://jsfiddle.net/UkR4G/1/](http://jsfiddle.net/UkR4G/1/)

如您所见，我只清除了曲线的一部分，让您可以在本节中重新绘制不同的频率波。

你如何做到这一点取决于你。

# joomla - 扩展 joomla 模块

> ID：14707681
> 
> 赞同：0
> 
> 时间：2013-02-05T12:34:12.253
> 
> 标签：joomla, joomla2.5

我是 joomla 的新手，一直在尝试完全了解它的工作原理，

有一个名为“最新消息”的 Joomla 模块，我想更改此模块的输出以包含从文章中提取的图像，我不想更改 tmpl/default.php 文件，因为我仍然想保持通常的外观职位，我猜我必须使用插件，

如果这确实是在这种情况下扩展模块的最佳方式，那么如何将插件附加到模块？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T08:02:59.533

您不需要插件，而是需要新的模块布局。

您可以在两个地方放置新的模块布局：

1.  在 /modules/your_module/tmpl/newlayout.php 下
2.  在 /templates/your_template/html/your_module/newlayout.php 下（但在这种情况下，**请确保您还复制了 default.php** - 这是强制性的，否则将不会看到覆盖）

现在前往您的模块配置，您将找到您的布局。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T13:42:46.560

我对你想要什么有点困惑......你是说你有时想要包含图像，有时不想要？

如果您总是想包含图像，那么您可以为故障 default.php 执行常规模板覆盖。不要更改核心文件，将文件放在 modules/mod_latest 下的模板文件夹中。如果您只想在某些情况下使用它，请将修改后的文件放在那里，但名称不同，然后通过选择该布局作为替代布局来编辑您的模块实例以使用该布局。它位于 J3 的 Advance Optons 选项卡中，也是 J2.5 中的滑块之一

# python - 无法在 Mac OSX 中通过 Python 将 Skype4Py 附加到 Skype

> ID：14707686
> 
> 赞同：1
> 
> 时间：2013-02-05T12:34:28.890
> 
> 标签：python, macos, segmentation-fault, skype4py

我在 Mac OSX (10.8.2) 上，正在尝试使用 Skype4py 通过 Python 连接到我当前正在运行的 Skype 实例。

我的困难在于我已按照网站上的说明（[http://pypi.python.org/pypi/Skype4Py/1.0.34#segfaults](http://pypi.python.org/pypi/Skype4Py/1.0.34#segfaults)`arch -i386 pip install Skype4Py` ），并使用该命令正确安装了 Skype4Py 。如说明所述，我已将代码编辑器的运行代码设置为使用`arch -i386 python`命令而不是典型的命令来运行事物`python`（并尝试使用两者直接从终端运行文件）。

我的代码目前非常简单（一旦连接正常，我计划进一步工作），如下所示：

```
import Skype4Py
skype = Skype4Py.Skype()
skype.Attach() 
```

这给了我一个 python 必须关闭的错误窗口以及以下错误：`Run Command: line 1: 66888 Segmentation fault: 11 arch -i386 python "$1" "${@:3}"`

在这些论坛上进行了一些搜索之后，我发现了一些同意以下代码修订作为答案的线程：

```
import Skype4Py
skype = Skype4Py.Skype(Transport='x11')
skype.Attach() 
```

不幸的是，这个修复只是改变了我的错误的性质。新的错误信息更复杂：

```
Traceback (most recent call last):
  File "skypeAttach.py", line 4, in <module>
    skype = Skype4Py.Skype(Transport='x11')
  File "build/bdist.macosx-10.8-intel/egg/Skype4Py/skype.py", line 250, in __init__
  File "build/bdist.macosx-10.8-intel/egg/Skype4Py/api/darwin.py", line 296, in __init__
  File "build/bdist.macosx-10.8-intel/egg/Skype4Py/api/__init__.py", line 214, in finalize_opts
TypeError: Unexpected option(s): Transport 
```

在我有限的编程知识下，它似乎试图告诉我“传输”是一个意想不到的参数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T13:13:02.993

从 Skype4Py PyPI 页面：

> 它适用于具有 Python 2.x 版本的 Windows、OSX 和 Linux 平台。

它与 Python 3.3 不兼容。尝试使用 Python 2.7 安装它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-21T00:00:50.270

我最终使用了一个 shell 脚本来强制 32 位模式：

```
#!/bin/bash
arch -i386 /usr/bin/python ./sendMessage.py 
```

# c - 在不使用宏的情况下简化并减少代码量

> ID：14707689
> 
> 赞同：3
> 
> 时间：2013-02-05T12:34:30.730
> 
> 标签：c, optimization, coding-style, macros

有时，在某些情况下，简单代码块的重复是不可避免的。为了说明，使用此示例代码：

*注意：此代码仅用于说明目的，实际代码更大更复杂。它也可能包含错误，但这个问题的重点不是那个。*

```
switch(cmd) {
    case CMD_BLOCK_READ:
        if(current_user != key) {
            ERROR("Access violation - invalid key!");
            res = CR_ACCESS_DENIED;
            break; 
        }
        if(current_state < STATE_BUSY) {
            WARN("Command %s is not allowed in this state!", cmd_name[cmd]);
            res = CR_NOT_PERMITTED;
            break;
        }
        if(ioctl(fd, HPI_CTL_BR) != 0) {
            WARN("Handshake failed (%s). Aborted!", strerror(errno));
            res = CR_TIME_OUT;
            goto post_resp;
        }
        if(block_read(id) != 0) {
            ERROR("Failed to read %d block (%s)! Aborted!", id, strerror(errno));
            res = CR_FAIL;
            goto send_nop;
        }

        res = CR_SUCCESS;
        break;
    case CMD_BLOCK_WRITE:
        if(current_user != key) {
            ERROR("Access violation - invalid key!");
            res = CR_ACCESS_DENIED;
            break; 
        }
        if(current_state < STATE_BUSY) {
            WARN("Command %s is not allowed in this state!", cmd_name[cmd]);
            res = CR_NOT_PERMITTED;
            break;
        }
        if(ioctl(fd, HPI_CTL_BR) != 0) {
            WARN("Handshake failed (%s). Aborted!", strerror(errno));
            res = CR_TIME_OUT;
            goto post_resp;
        }
        if(block_write(id) != 0) {
            ERROR("Failed to write %d block - %s. Command aborted!", id, strerror(errno));
            res = CR_FAIL;
            goto send_nop;
        }
        res = CR_SUCCESS;
        break;
    case CMD_REQ_START:
        if(current_state < STATE_READY) {
            WARN("Command %s is not allowed in this state!", cmd_name[cmd]);
            res = CR_NOT_PERMITTED;
            break;
        }
        state = STATE_BUSY;
        if(ioctl(fd, HPI_CTL_BR) != 0) {
            WARN("Handshake failed (%s). Aborted!", strerror(errno));
            res = CR_TIME_OUT;
            goto send_nop;
        }
        if(block_read(id) != 0) {
            ERROR("Failed to read %d block (%s)! Aborted!", id, strerror(errno));
            res = CR_FAIL;
            goto post_resp;
        }
        res = CR_SUCCESS;
        break;
    }

    /* The remaining 28 or so similar commands */
} 
```

如您所见，由于细微差别和广泛使用*break/goto*语句，无法使用函数或内联。我通常做的是定义一些宏：

```
/* NOTE: DO NOT USE these macros outside of Big Switch */
#define CHECK_KEY(_key) \
   if(current_user != (_key)) \
   { \
      ERROR("Access violation!"); \
      res = CR_ACCESS_DENIED; \
      break; \
   }
#define CHECK_STATE(_state) \
   if(current_state < _state) \
   { \
      WARN("Command %s is not allowed in this state!", cmd_name[cmd]); \
      res = CR_NOT_PERMITTED; \
      break; \
   }

#define HANDSHAKE(_fail) \
   if(ioctl(fd, CTL_BR) != 0) \
   { \
      WARN("Handshake failed (%s). Aborted!", strerror(errno)); \
      res = CR_TIME_OUT; \
      goto _fail; \
   }

#define BLOCK_READ(_id, _fail) \
   if(block_read((int)(_id))!= 0) \
   { \
      ERROR("Failed to read %d block (%s)! Aborted!", (int)_id, strerror(errno)); \
      res = CR_FAIL; \
      goto _fail; \
   }

#define BLOCK_WRITE(_id, _fail) \
   if(block_write((int)(_id)) != 0) \
   { \
      ERROR("Failed to write %d block - %s. Aborted!", (int)_id, strerror(errno)); \
      res = CR_FAIL; \
      goto _fail; \
   } 
```

..并使用它们编写相同的代码。代码变得**更**小并且（可以说）更具可读性：

```
switch(cmd) 
{
case CMD_BLOCK_READ:
   CHECK_KEY(key);
   CHECK_STATE(STATE_BUSY);
   HANDSHAKE(post_resp);
   BLOCK_READ(id, send_nop);
   res = CR_SUCCESS;
   break;
case CMD_BLOCK_WRITE:
   CHECK_KEY(key);
   CHECK_STATE(STATE_BUSY);
   HANDSHAKE(post_resp);
   BLOCK_WRITE(id, send_nop);
   res = CR_SUCCESS;
   break;
case CMD_REQ_START:
{
   CHECK_STATE(STATE_READY);
   state = STATE_BUSY;
   HANDSHAKE(send_nop);
   BLOCK_READ(id, post_resp);
   res = CR_SUCCESS;
   break;
}
/* The remaining 28 or so similar commands */
<..> 
```

代码看起来更像某种脚本语言，而不是好的旧*C*语言，而且非常丑陋，但为了可读性，我愿意牺牲它。

**问题**是你如何应对类似的情况？有哪些更优雅的解决方案和最佳实践？

**PS**我承认，在一般情况下，宏和*goto*语句是糟糕设计的标志，所以没有必要对它们有多邪恶或我的编程风格有多糟糕而大发雷霆。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T12:55:12.063

我不会声称 Python 源代码是组织的典范，但它包含（恕我直言）用于简化复杂代码的宏的一个很好的例子。

Python 主循环实现了一个基于堆栈的字节码执行 VM。它包含一个巨大的开关盒，每个 Python 支持的操作码都有一个盒。操作码的调度如下所示：

```
case STORE_ATTR:
    w = GETITEM(names, oparg);
    v = TOP();
    u = SECOND();
    STACKADJ(-2);
    err = PyObject_SetAttr(v, w, u); /* v.w = u */
    Py_DECREF(v);
    Py_DECREF(u);
    if (err == 0) continue;
    break; 
```

其中`TOP`和都定义为对堆栈对象进行操作的宏`SECOND`。一些宏具有用于帮助调试的`STACKADJ`备用s。`#define`所有的操作码都是以这种方式编写的，通过这种微型脚本语言表达逻辑，有助于使每个操作码的实现更加清晰。

在我看来，谨慎、明智和有限地使用宏可以提高代码的可读性，并使逻辑更清晰。在您的情况下，宏隐藏了一些小但重要的功能，使用宏来标准化实现并确保您没有要更新的相同代码片段的多个副本可能很有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T13:30:57.893

在这种情况下，我通常会考虑是否可以用数据合理地描述案例，然后在单个公共代码块中处理这些数据。当然不能总是这样做，但通常是可能的。

在您的情况下，它可能会导致类似于以下内容：

```
 #define IO_NOOP    0
#define IO_READ    1
#define IO_WRITE   2

struct cmd_desc { 
   int check_key;     /* non-zero to do a check */
   int check_state;
   int new_state;
   void* handshake_fail;
   int io_dir;
   void* io_fail;
};

const struct cmd_desc cmd_desc_list[] = {
   { 1, STATE_BUSY,  -1,         &&post_resp, IO_READ,  &&send_nop },  /* CMD_BLOCK_READ */
   { 1, STATE_BUSY,  -1,         &&post_resp, IO_WRITE, &&send_nop },  /* CMD_BLOCK_WRITE */
   { 0, STATE_READY, STATE_BUSY, &&send_nop,  IO_READ,  &&post_rep }   /* CMD_REQ_START */
};

const struct cmd_desc* cmd_desc = cmds[cmd];

if(cmd_desc->check_key) {
   if(current_user != key) {
      ERROR("Access violation - invalid key!");
      return CR_ACCESS_DENIED;
   }
}

if(cmd_desc->check_state != -1) {
   if(current_state check_state) {
      WARN("Command %s is not allowed in this state!", cmd_name[cmd]);
      return CR_NOT_PERMITTED;
   }
}

if(cmd_desc->new_state != -1)
   state = cmd_desc->new_state;

switch(cmd_desc->io_dir) {
   case IO_READ:
      if(block_read(id) != 0) {
         ERROR("Failed to read %d block (%s)! Aborted!", id, strerror(errno));
         res = CR_FAIL;
         goto *cmd_desc->io_fail;
      }
      break;

   case IO_WRITE:
      if(block_write(id) != 0) {
         ERROR("Failed to write %d block (%s)! Aborted!", id, strerror(errno));
         res = CR_FAIL;
         goto *cmd_desc->io_fail;
      }
      break;

   case IO_NOOP:
      break;
}

res = CR_SUCCESS; 
```

注释我使用 gcc 的“标签作为值”扩展作为 goto 标签（[http://gcc.gnu.org/onlinedocs/gcc/Labels-as-Values.html](http://gcc.gnu.org/onlinedocs/gcc/Labels-as-Values.html)）。在标准 C 中，您可能会改用函数指针，但这需要对代码进行一些重组，而我没有足够的信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-06T02:05:43.627

使用您发布的代码，您没有理由不能使用函数。这将是“提取函数”重构模式。要处理 goto，只需将它们留在主函数中，然后根据函数结果调用或不调用它们。

[http://www.refactoring.com/catalog/extractMethod.html](http://www.refactoring.com/catalog/extractMethod.html)

此外，通过在未传入的宏中使用变量，你真的把事情搞得一团糟。这意味着你不能轻易地重用它们，而且它们可能比直接写整个东西更糟糕。如果您传入了宏使用的所有内容，那么它会更有用。然后你会得到一个鸭式风格的编码，可以有效地使用。

此外，您使用的是 C，因此您不应该“避免”宏。它们非常有用，主要用于代码生成。（即字符串化和连接）许多 C++ 和其他一些人说“宏是邪恶的”。这是 C，宏并不邪恶。

# php - 无法在编辑记录的下拉列表中显示列表

> ID：14707691
> 
> 赞同：0
> 
> 时间：2013-02-05T12:34:42.597
> 
> 标签：php, mysql

在我的页面中，当用户登录到他的帐户时，有两个字段名称和项目，因此每当他登录时，他的姓名填写的名称字段和他的所有项目都列在项目字段的下拉列表中。我的问题是当我编辑此记录时它显示我是他在提交时选择的名称和项目，但我希望在编辑时将他的所有项目列在提交时间。

这是我的提交时间下拉项目代码：

```
<tr>
           <td>Select Project</td>
           <td>
           <select id="project" name="project">
           <option value="">-- select --</option>
           <?php while($row = mysql_fetch_array($result))
              {
                 $pm = $row['assignpm'];
                 $assignpm = explode(",",$pm);
                 if(in_array($_SESSION['id'], $assignpm)){ ?>

               <option value="<?php echo htmlspecialchars($row['projectname']);?>"><?php echo htmlspecialchars($row['projectname']); ?></option>
 <?php } }?> 
             </select></td>
         </tr> 
```

这是我编辑项目字段的代码：

```
<tr>
           <td>Select Project</td>
           <td><select name="project" id="project" style="width:145px">
               <option>Select</option>
              <option selected="selected" value="<?php echo $fetuser1['project'];?>"><?php echo $fetuser1['project'];?></option>       
                 </select></td>
         </tr> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T13:02:30.977

depends... what do your query look like? one query? two querys? one on the userid, name and stuff and another on the projects...

or are all project in the same table as the fetched username? and how are thy stored (blob, json, simple list)?

And last: mixing php inline with html is a very bad habbit ;)

say you have two querys

```
//query SELECT projectname FROM whatevertable WHERE userid = 'users-id'

$options = "<option value="">-- select --</option>".PHP_EOL;
while($row = mysql_fetch_array($result))
{
    if(htmlspecialchars($row['projectname']) == $_SESSION['preselected']) //whatever
        $options. = "<option selected="selected" value=".htmlspecialchars($row['projectname']).">".htmlspecialchars($row['projectname'])."</option>".PHP_EOL;
    else
        $options. = "<option value=".htmlspecialchars($row['projectname']).">".htmlspecialchars($row['projectname'])."</option>".PHP_EOL;
} 
```

and after all the php code you can

```
echo "<td>Select Project</td>
<td>
    <select id=/"project/" name=/"project/">
        {$options}
    </select>
</td>"; 
```

But without knowing any of your code but that little php-mixed-html it's hard to answer precisely

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T12:50:51.273

因此，在编辑时，您必须执行与“提交时间”相同的操作。

```
<tr>
    <td>Select Project</td>
    <td>
        <select name="project" id="project" style="width:145px">
            <option>Select</option>
            <?php 
                while($row = mysql_fetch_array($result)) {
                    $pm = $row['assignpm'];
                    $assignpm = explode(",",$pm);
                    if(in_array($_SESSION['id'], $assignpm)) {
                ?>
                <option 
                    <?php if($fetchuser1['project'] == $row['projectname']) echo "selected='selected'";?> 
                    value="<?php echo htmlspecialchars($row['projectname']);?>"
                >
                    <?php echo htmlspecialchars($row['projectname']); ?>
                </option>
            <?php } }?>
        </select>
    </td>
 </tr> 
```

# c# - 如何使用计时器替换 Azure Worker Role 中的 Thread.Sleep(...)？

> ID：14707693
> 
> 赞同：2
> 
> 时间：2013-02-05T12:34:44.193
> 
> 标签：c#, .net, azure, timer, azure-worker-roles

有很多人说使用 a`Timer`而不是`Thread.Sleep(...)`in 的例子`Azure Worker Role`。没有问题。

我正在努力理解的是如何编码。

目前，我有以下（伪代码）

```
_timer.Elapsed += (sender, args) => DoWork();

public override void Run()
{
    while(true)
    {
        DoWork();
    }
}

public void DoWork()
{
    try
    {
        _timer.Stop();

        // Now - do stuff ....

     }
     catch(....) { ... }

     _timer.Start()
} 
```

发生的情况是代码进入该`DoWork()`方法一次，然后`DoesStuff(tm)`……很好……启动计时器（例如……以 30 秒的间隔），然后退出该方法。

然后，它返回到该`Run()`循环中的主方法..。因此它**立即**返回并再次进入该`DoWork()`方法......而不是等待计时器将其触发。

所以我不确定如何`Thread.Sleep(...)`用计时器替换任何内容。

有什么线索吗？

### 澄清

我不想退出该`Run()`方法 :) 我很高兴一直循环下去。我坚持的是替换标准`Thread.Sleep(...)`调用（阻塞线程）并将其替换为`Timer`大多数人建议的 a 。

### 更新

请不要链接或建议我应该`cancelSource.Token.WaitHandle.WaitOne();`用作解决方案。这不是我想要在这里实现的。请注意帖子标题！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-06T22:26:26.510

我认为，如果您想按照您在此处概述的方式解决这种情况，您将需要一个 WaitHandle 和一个计时器。

简短的答案在下面。长答案变成了一篇博文：[HowTo wait in a WorkerRole using Timer and EventWaitHandle over Thread.Sleep](http://magnusmartensson.com/howto-wait-in-a-workerrole-using-system-timers-timer-and-system-threading-eventwaithandle-over-system-threading-thread-sleep)

我将 EventWaitHandle 与 Timer 一起使用，并提出了以下解决方案：

```
public class WorkerRole : RoleEntryPoint
{
    Waiter waiter;

    public override bool OnStart()
    {
        waiter = new Waiter(WorkerConfiguration.WaitInterval);
        return base.OnStart();
    }

    public override void Run()
    {
        while (true)
        {
            DoWork();
            waiter.Wait();
        }
    }

    public void DoWork()
    {
        // [...]
    }
} 
```

这是服务员类：

```
public class Waiter
{
    private readonly Timer timer;
    private readonly EventWaitHandle waitHandle;

    public Waiter(TimeSpan? interval = null)
    {
        waitHandle = new AutoResetEvent(false);
        timer = new Timer();
        timer.Elapsed += (sender, args) => waitHandle.Set();
        SetInterval(interval);
    }

    public TimeSpan Interval
    {
        set { timer.Interval = value.TotalMilliseconds; }
    }

    public void Wait(TimeSpan? newInterval = null)
    {
        SetInterval(newInterval);
        timer.Start();
        waitHandle.WaitOne();
        timer.Close();
        waitHandle.Reset();
    }

    private void SetInterval(TimeSpan? newInterval)
    {
        if (newInterval.HasValue)
        {
            Interval = newInterval.Value;
        }
    }
} 
```

# websocket - Jetty 8.1.9.v20130131 Web 套接字问题

> ID：14707694
> 
> 赞同：3
> 
> 时间：2013-02-05T12:34:46.577
> 
> 标签：websocket, jetty

我确实对 jetty 8 websockets 有一个奇怪的问题。我发现几个教程几乎显示了相同的代码，但是当我尝试从本地 html 页面打开 websocket 时出现此错误：

```
2013-02-05 13:14:03.467:INFO:oejs.Server:jetty-8.1.9.v20130131
2013-02-05 13:14:03.770:INFO:oejs.AbstractConnector:Started SelectChannelConnector@0.0.0.0:8080
2013-02-05 13:14:18.002:WARN:oejs.ServletHandler:/echo
java.lang.NullPointerException
    at org.eclipse.jetty.websocket.WebSocketFactory.upgrade(WebSocketFactory.java:236)
    at org.eclipse.jetty.websocket.WebSocketFactory.acceptWebSocket(WebSocketFactory.java:382)
    at org.eclipse.jetty.websocket.WebSocketServlet.service(WebSocketServlet.java:104)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:848)
    at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:669)
    at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:457)
    at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:137) 
```

这是套接字 servlet：

```
public class ExampleWebSocketServlet extends WebSocketServlet {
    private static final long serialVersionUID = 1L;

    /**
     * @see WebSocketServlet#WebSocketServlet()
     */
    public ExampleWebSocketServlet() {
        super();
    }

protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        PrintWriter out = response.getWriter();
        out.println("OK");
        out.close();
        System.out.println("OK");
    }

    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        getServletContext().getNamedDispatcher("default").forward(request, response);
    }

    public WebSocket doWebSocketConnect(HttpServletRequest request, String protocol) {
        return new EchoWebSocket();
    }
} 
```

和 WebSocket（用于简单的 Echo）

```
public class EchoWebSocket implements WebSocket.OnTextMessage {

    private Connection con;

    @Override
    public void onClose(int closeCode, String message) {

    }

    @Override
    public void onOpen(Connection con) {
        this.con = con;

        try {
            con.sendMessage("Server received Web Socket upgrade ...");
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    @Override
    public void onMessage(String msg) {
        System.out.println("Received: "+msg);

        try {
            con.sendMessage(msg);
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } //send it back

    }
} 
```

我的 html 页面适用于其他 websocket 测试服务器，例如 websocket.org

有什么问题？我在 Eclipse 上，创建了一个动态 Web 项目并使用 jetty webapp 运行配置。此外，当码头启动时，我可以看到

/Users/sven.haiges/dev/jetty/jetty-distribution-8.1.9.v20130131/lib/jetty-websocket-8.1.9.v20130131.jar

在类路径上。

任何帮助表示赞赏，谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T15:05:47.713

我对 Run Jetty Run 插件有同样的问题。终于找到了解决办法。去运行配置

*   在左侧面板的 jetty webapp 下选择您的项目名称
*   在 Jetty 选项卡下的右侧选择 jetty 版本 8.1

应用/运行就是这样

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T17:07:29.457

尝试使用 Jetty 8.1.8 版本。今天，我在通过 @WebServlet 注释创建一个简单的 servlet 时遇到了问题。码头服务器没有响应，我不知道为什么。但是当我突然改回 8.1.8 版本时，一切正常。也许这是一个类似的问题。

# cloudbees - 如何将我的组织的私人仓库添加到 BuildHive？

> ID：14707696
> 
> 赞同：0
> 
> 时间：2013-02-05T12:34:56.727
> 
> 标签：cloudbees, buildhive

我想为我的组织添加一个私有 Github 存储库到 BuildHive，但由于某种原因，它们没有显示在“从 GitHub 添加项目！”中 页。

有什么办法可以添加这些，还是不支持私人回购？是否有一些 BuildHive 付费订阅服务可以用来获得这种支持？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T15:17:24.360

BuildHive 是一个有意简单的构建服务：仅支持开源（或至少公共）存储库，仅在 GitHub 上，并且具有最少的配置选项。如果您需要任何其他选项，您可以订阅[DEV@cloud](http://www.cloudbees.com/dev.cb)服务以获取您可以随意配置的 Jenkins 实例，包括访问受密码保护的版本控制。

# java - 如何确保正在使用quartz.properties？

> ID：14707703
> 
> 赞同：8
> 
> 时间：2013-02-05T12:35:14.023
> 
> 标签：java, threadpool, quartz-scheduler

我在我的 quartz.properties 文件中设置了以下属性：

```
org.quartz.threadPool.threadCount = 60
org.quartz.scheduler.batchTriggerAcquisitionMaxCount = 60 
```

，但是，由于某种原因，显然它没有生效。因为当我启动我的应用程序时，日志显示它仍然使用池中的 1 个线程：

```
[main] INFO org.quartz.impl.StdSchedulerFactory - Using default implementation for ThreadExecutor 
[main] INFO org.quartz.core.SchedulerSignalerImpl - Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl 
[main] INFO org.quartz.core.QuartzScheduler - Quartz Scheduler v.2.1.1 created. 
[main] INFO org.quartz.simpl.RAMJobStore - RAMJobStore initialized.
[main] INFO org.quartz.core.QuartzScheduler - Scheduler meta-data: Quartz Scheduler (v2.1.1) 'QuartzScheduler' with instanceId 'NON_CLUSTERED' Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally. NOT STARTED. Currently in standby mode. Number of jobs executed: 0   
Using **thread pool 'org.quartz.simpl.SimpleThreadPool' - with 1 threads.** 
```

我知道，quartz.properties 需要在类路径中才能找到。我就这么做了。没有检测到此文件的任何其他原因？或者它被检测到但线程数设置不正确？

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2016-03-21T15:51:50.293

对于那些使用 Spring + Quartz 并且`quartz.properties`文件不工作的人（即在启动应用程序时被忽略）：

`org.quartz.Scheduler`由 Spring Factory Bean ( ) 实例化的Quartz Scheduler ( ) 默认情况下`org.springframework.scheduling.quartz.SchedulerFactoryBean`不会`quartz.properties`从类路径中读取文件，正如 Quartz 文档中所说 - 您需要手动设置引用：

[在 Java 配置的情况下]：

```
@Bean
public SchedulerFactoryBean schedulerFactoryBean() {
    SchedulerFactoryBean schedulerFactoryBean = new SchedulerFactoryBean();
    schedulerFactoryBean.setConfigLocation(new ClassPathResource("quartz.properties"));
    // ...
} 
```

[在 XML 配置的情况下]：

```
<bean class="org.springframework.scheduling.quartz.SchedulerFactoryBean">
    <property name="configLocation" value="classpath:quartz.properties" />
    // ...
</bean> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-06-03T04:58:35.270

**哎呀，我发现了问题，实际上代码通过在代码**中创建 Properties 类的实例来覆盖属性文件配置。所以答案是这一行：

`sf = new StdSchedulerFactory("conf/quartz.properties");`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-11-19T08:19:07.473

如果有人仍在寻找答案，他们可以使用以下代码段

```
@Bean                                                                           
public SchedulerFactoryBean schedulerFactoryBean() throws IOException {
    SchedulerFactoryBean scheduler = new SchedulerFactoryBean();
    scheduler.setTriggers(jobOneTrigger());
    scheduler.setQuartzProperties(quartzProperties());
    scheduler.setJobDetails(jobOneDetail());
    return scheduler;
}

@Bean
public Properties quartzProperties() throws IOException {
    PropertiesFactoryBean propertiesFactoryBean = new PropertiesFactoryBean();
    propertiesFactoryBean.setLocation(new ClassPathResource("/quartz.properties"));
    propertiesFactoryBean.afterPropertiesSet();
    return propertiesFactoryBean.getObject();
} 
```

# php - 在另一个类的函数中调用函数返回“0”

> ID：14707704
> 
> 赞同：0
> 
> 时间：2013-02-05T12:35:14.727
> 
> 标签：php, class, function

```
<?php
class Kunde 
{
    public $knr;
    public $navn;
    public $adr;
    public $tlfnr;
    public $kurv = array();

    function __construct($nr,$n,$a)
    {
        $this->knr = $nr;
        $this->navn = $n;
        $this->adr = $a;
    }

    function LeggTilVare($vnavn,$vantall,$vpris)
    {
        $this->kurv[]=new Vare($vnavn,$vantall,$vpris);
    }

    function VisVarer()
    {
        for($i=0; $i < count($this->kurv); $i++)
        {
            $text+= $this->kurv[$i]->getInfo() . "<br/>";
        }

        return $text;
    }

class Vare 
{
    public $varenavn;
    public $antall;
    public $pris;

    function __construct($navn,$antall,$pris)
    {
        $this->varenavn=$navn;
        $this->antall=$antall;
        $this->pris=$pris;
    }

    function getInfo()
    {
        return $this->varenavn.", ".$this->antall." st, ".$this->pris.",-";
    }
}

$kunde1 = new Kunde(1,"Andreas","Gronland");

$kunde1->LeggTilVare("Kjekks", 10, 10.00); 
```

我习惯用 Java 编程，但现在正在学习 PHP。

我的函数`VisVarer()`只会返回`"0"`，没有别的。我想这与`getInfo()`另一个类的另一个函数内部的调用有关，或者我的 for 循环有问题。

也许这是编写此类程序的错误方法？

```
echo $kunde1->kurv[0]->getInfo(); // returns "Kjekks, 10 st, 10"

echo $kunde1->VisVarer(); // returns "0" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T12:37:48.637

在 php 中，连接运算符是点在这一行中：

```
$text+= $this->kurv[$i]->getInfo() . "<br/>"; 
```

您正在使用您习惯的 java (+=) 以及特定于 php 的那个，点

尝试将该行（以及所有类似的行）更改为

```
$text .= $this->kurv[$i]->getInfo() . "<br/>"; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T12:37:56.677

`+=`当您应该使用`.=`运算符进行字符串连接时，您正在使用运算符。

在 PHP 中，这是两种不同的运算，数学加法和字符串连接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T12:38:20.993

您正在使用此运算符：

```
+= 
```

这仅用于整数。PHP 将尝试将字符串转换为整数（最终为 0）。

相反，您可能需要字符串连接运算符：

```
.= 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T12:39:19.857

字符串连接是用 完成的`.`，而不是`+`。

因此，您想要 do`.=`而不是`+=`in `VisVarer`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-05T12:39:38.433

将此行更改为

```
$text.= $this->kurv[$i]->getInfo() . "<br/>"; 
```

PHP 中的连接赋值运算符`.=`不是`+=`. 发生的事情是您将结果字符串添加为数字，`$text`因此它将始终为零。

# ruby-on-rails - Rails：如何将 for 循环的结果保存到数据库中

> ID：14707707
> 
> 赞同：1
> 
> 时间：2013-02-05T12:35:22.600
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2

我是 Rails 新手，可能需要一些帮助。被困在这几天了。我已经搜索了解决方案，但仍然没有得到它。问题是我想将 for 循环的结果保存到数据库（postgreSQL）中。

```
 <% @amount = (params[:h].to_d * params[:k].to_d) %> 
    <% @percent = (params[:h].to_d * params[:k].to_d) / params[:p].to_d %>
<% for i in 0..params[:a].to_i do %>  
    <% @newAmount = ((@amount/(@percent)) + @amount) %>  
    <%= "#{i}" + " - #{@amount}" %><br />
    <% @amount=@newAmount %>
<% end %> 
```

如果我也可以保存表单数据，那就太好了，我发现form_tag不太好保存数据，但我真的不知道如何使用form_for来做到这一点。

```
<%= form_tag ('/calc') do  %> 
  A_n: <%= text_field_tag :a_n %><br />
  H: <%= text_field_tag :h %><br />
  K: <%= text_field_tag :k %><br />
  P: <%= text_field_tag :p %><br />
  A: <%= text_field_tag :a %><br />
  <%= submit_tag 'Calc' %>
<% end %> 
```

如果这是基本的或非常简单的（我敢肯定），我很抱歉，但我希望我能找到一些帮助来正确地做到这一点。

模型：

```
class Calculation < ActiveRecord::Base
  attr_accessible :a, :a_n, :h, :k, :p
end 
```

桌子：

```
 create_table "calculation", :force => true do |t|

    t.string   "a_n"

    t.decimal  "h"

    t.decimal  "k"

    t.decimal  "p"

    t.integer  "a"

    t.datetime "created_at",  :null => false

    t.datetime "updated_at",  :null => false

  end 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-06T18:41:32.743

这就是我的表单的样子，使用 form_for 很容易进行验证，那么为什么不进行验证呢？

```
<%= form_for @calculation do |f| %>
  <% if @calculation.errors.any? %>
    <h2>Errors:</h2>
    <ul>
      <% @calculation.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
    </ul>
  <% end %>
  A n: <%= f.text_field :a_n %><br />
  H: <%= f.text_field :h %><br />
  K: <%= f.text_field :k %><br />
  P: <%= f.text_field :p %><br />
  A: <%= f.text_field :a %><br />
  <%= f.submit 'CALC' %>
<% end %> 
```

显示视图是：

```
<p>A n: <%= @calculation.a_n %></p>
<p>H: <%= @calculation.h %></p>
<p>K: <%= @calculation.k %></p>
<p>P: <%= @calculation.p %></p>
<p>A: <%= @calculation.a %></p>
<small>T: <%= @calculation.created_at %></small>
 <br />
    <%= @calculation.a_n %> <br />
    <% @amount = (@calculation.h * @calculation.k) %> 
    <% @percent = (@calculation.h * @calculation.k) / @calculation.p %> 
  <% for i in 0..@calculation.a do %> 
    <% @newAmount = ((@amount/(@percent)) + @amount) %>
    <%= "#{i}" + " - #{@amount}" %><br />
    <% @amount=@newAmount %>
  <% end %> 
```

这完美！感谢您的关注和帮助！

# vb.net - 该值未分配给 vb.net 中的标签

> ID：14707711
> 
> 赞同：-1
> 
> 时间：2013-02-05T12:35:39.120
> 
> 标签：vb.net

该值未分配给 lbl5

```
Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click

    Dim cc As String
    Dim an As String
    Dim da As Double
    Dim intam, tab As Double

    an = Val(txtan.Text)
    da = Val(txtxda.Text)
    cc = Val(txtcc.Text)

    If Val(txtan.Text) = "k" Then
        lbl5.Text = "hhhhhhhhhhhhhhh"
        intam = da * 0.05
    ElseIf an = "wanitha" Then
        intam = da * 0.06
    ElseIf an = "upahara" Then
        intam = da * 0.07

    End If

    tab = (da) + intam

End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T12:40:53.660

[来自 MSDN](http://msdn.microsoft.com/en-us/library/k7beh1x9%28v=VS.71%29.aspx)

> Val 函数将字符串中包含的数字作为适当类型的数值返回。Val 函数在它无法识别为数字的一部分的第一个字符处停止读取字符串

这个条件怎么可能是真的？

```
If Val(txtan.Text) = "k" Then 
```

你应该检查

```
If txtan.Text = "k" Then 
```

这也不完全正确：

```
an = Val(txtan.Text) 
```

应该

```
an = txtan.Text 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T12:41:28.293

在该行中放置一个断点：

```
line If Val(txtan.Text) = "k" Then 
```

并检查comming值是否真的是“k”

你也不需要用val(txtan.Text)，txttan.Text就够了

请在下一个问题中更具体

# numpy - 索引重复的 NumPy 数组也会影响原始数组

> ID：14707717
> 
> 赞同：0
> 
> 时间：2013-02-05T12:35:49.077
> 
> 标签：numpy

如果我尝试更改重复数组中的某些值，原始数组也会神秘地受到影响。

```
import numpy as np

x = np.zeros((3, 10))
y = x

print(x)
print(y, "\n")

y[1:3, 4:8] = 1

print(x)
print(y) 
```

我的系统上的输出如下：

```
[[ 0\.  0\.  0\.  0\.  0\.  0\.  0\.  0\.  0\.  0.]
 [ 0\.  0\.  0\.  0\.  0\.  0\.  0\.  0\.  0\.  0.]
 [ 0\.  0\.  0\.  0\.  0\.  0\.  0\.  0\.  0\.  0.]]
[[ 0\.  0\.  0\.  0\.  0\.  0\.  0\.  0\.  0\.  0.]
 [ 0\.  0\.  0\.  0\.  0\.  0\.  0\.  0\.  0\.  0.]
 [ 0\.  0\.  0\.  0\.  0\.  0\.  0\.  0\.  0\.  0.]]

[[ 0\.  0\.  0\.  0\.  0\.  0\.  0\.  0\.  0\.  0.]
 [ 0\.  0\.  0\.  0\.  1\.  1\.  1\.  1\.  0\.  0.]
 [ 0\.  0\.  0\.  0\.  1\.  1\.  1\.  1\.  0\.  0.]]
[[ 0\.  0\.  0\.  0\.  0\.  0\.  0\.  0\.  0\.  0.]
 [ 0\.  0\.  0\.  0\.  1\.  1\.  1\.  1\.  0\.  0.]
 [ 0\.  0\.  0\.  0\.  1\.  1\.  1\.  1\.  0\.  0.]] 
```

我目前正在使用 NumPy 1.6.2 作为针对 Intel MKL（来自 [Christoph Gohlke](http://www.lfd.uci.edu/~gohlke/pythonlibs/#numpy)）与 Python 3.2.3 一起编译的 64 位版本。我还尝试了 32 位“官方”版本，但得到了完全相同的结果......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T12:37:42.523

您没有**创建**数组的副本。您只需创建*对同一*数组的新引用。如果要复制数组，请使用`numpy.copy`：

```
y = numpy.copy(x) 
```

请注意，使用常规 python 列表，您可以获得具有语法的浅表副本`the_list[:]`（其中`[:]`意味着创建一个从原始列表开头开始并在原始列表末尾结束的切片），而在大多数情况下，`numpy`切片实际上是*视图：*

```
>>> import numpy as np
a>>> a = np.arange(10)
>>> b = a[:]
>>> b[0] = 100
>>> a
array([100, 1, 2, 3, 4, 5, 6, 7, 8, 9])
>>> b
array([100, 1, 2, 3, 4, 5, 6, 7, 8, 9]) 
```

相对：

```
>>> a = range(10)
>>> b = a[:]    # does a real copy
>>> b[0] = 100
>>> a
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
>>> b
[100, 1, 2, 3, 4, 5, 6, 7, 8, 9] 
```

* * *

在 python 中，每个标识符都是对对象的引用。当你做作业时：

```
y = x 
```

赋值将名称*绑定*`y`到 引用的对象`x`。换句话说，成为**的引用**的`y`副本。现在被引用的对象又多了一个引用。当一个对象不再有引用时，它就会从内存中删除。Python 没有 C 中的“变量”概念。**`x``x`**

 **另一种思考方式是任何标识符都是指向对象的指针。因此`y = x`复制*指针*而不是对象本身（这就是实际发生的情况。C/API 总是使用指向`PyObject`结构的指针）

这在每个 python 教程中都有解释，因此我建议你先搁置`numpy`一会，先阅读 python 教程。

* * *

我决定使用一些 Unicode 艺术来说明绑定会发生什么。这个想法不是我的，而是来自[python-it.org 论坛](http://www.python-it.org/smfforum)的用户 Claudio_F 。

这个想法是在 python 中你有标识符，我将其表示为浮标。每个浮标都可以连接到一个物体，该物体被表示为海底的一块岩石（或其他任何东西）。一个物体可以绑定更多的浮标。当一个物体没有绑定任何浮标时，它就会沉入海中，当它到达海底时，一个巨大的海怪会摧毁它（又名垃圾收集器）。

现在当你做任务时：

```
a = 5 
```

这是这种情况：

```
 ___
            (   )
            ( a )
            (   )
^~~~~^~~~~^~~'¿'~~~~^~~~~~^~~~~~^~~~~~~
              |
  O        .--+--.         o    ___
           |  5  |           |\/  x\
           .-----.            ^\_/

             ___             O
    o       /o  \/|
            〉 GC  |       o      o
            \___/\|
        (   
   )     )             (
  (     (      )        )        )
(  )  )  )    (   (    ( (    ) ( (
 )(  (  (   (  )   )    ) )  (   ) ) 
```

当你做任务时：

```
b = a 
```

两个浮标都绑定到同一个对象：

```
 ___               ___
           (   )             (   )
           ( a )             ( b )
           (   )             (   )
^~~~^~~~~^~~'¿'~~~~~^~~~~^~~~~'¿'~~~~^~~~~~^
             \        o       /
              \     o        /
               \     O      /
                \          /    __________
                 \        /    /          \
       o          \      /    /            \
                   \    /       )  | (  | )
     O              \  /       (   |  )  (
        o            \/            | (    )
                  .--+--.             )
                  |  5  |
                  .-----.

             ___             O
    o       /o  \/|
            〉 GC  |       o      o
            \___/\|
        (   
   )     )             (
  (     (      )        )        )
(  )  )  )    (   (    ( (    ) ( (
 )(  (  (   (  )   )    ) )  (   ) ) 
```

当你做第三个作业时：

```
a = 7 
```

`a`链条从物体上解开并`5`绑定到一个新的`7`, 物体上，但`b`的浮标仍然绑定到`5`:

```
 ___               ___
           (   )             (   )
           ( a )             ( b )
           (   )             (   )
^~~~^~~~~^~~'¿'~~~~~^~~~~^~~~~'¿'~~~~^~~~~~^
             |         o       |
             |                 |
             |     O           |      o
             |                 |
     o       |                 |
             |        o        |
             |              .--+--.
   O      .--+--.           |  5  |
          |  7  |           .-----.
          .-----.

     o     

             ___             O
    o       /o  \/|
            〉 GC  |       o      o
            \___/\|
        (   
   )     )             (
  (     (      )        )        )
(  )  )  )    (   (    ( (    ) ( (
 )(  (  (   (  )   )    ) )  (   ) ) 
```

我希望你喜欢这些照片，并且他们清楚地说明了它是如何工作的。（水母和死鱼只是因为我觉得它们很酷而已）

顺便说一句，这种表示对于理解对象之间的引用也很棒。例如代码：

```
L = [1,2,3] 
```

将像这样表示：

```
 ___
               (   )
               ( L )
               (   )
 ^~~~~^~~~~^~~~~'¿'~~~~^~~~~^~~~~^~~~~^
                 |
                 |
        .--------+----------.
        | [ '¿', '¿', '¿' ] |
        .----|----|----|----.
            /     |     \
           /      |      \
       .--+--.    |    .--+--.
       |  1  |    |    |  3  |
       .-----.    |    .-----.
                  |
               .--+--.
               |  2  |
               .-----.

             ___             O
    o       /o  \/|
            〉 GC  |       o      o
            \___/\|
        (   
   )     )             (
  (     (      )        )        )
(  )  )  )    (   (    ( (    ) ( (
 )(  (  (   (  )   )    ) )  (   ) ) 
```

请注意列表如何具有指向对象的“指针”，而不是实际对象。

另外，回到切片，如果你这样做：

```
R = L[:] 
```

您获得此方案：

```
 ___                        ___
               (   )                      (   )
               ( L )                      ( R )
               (   )                      (   )
 ^~~~~^~~~~^~~~~'¿'~~~~^~~~~^~~~~^~~~~^~~~~'¿'~~~~~~^~~~~~^~~~~~
                 |                          |
                 |                          |
        .--------+----------.     .---------+---------.
        | [ '¿', '¿', '¿' ] |     | [ '¿', '¿', '¿' ] |
        .----|----|----|----.     .----|----|----|----.
             \     \    \             /    /    /
              \     \    \           /    /    /
               \     \    \         /    /    /
                \     \    \       /    /    /
                 \     \    \     /    /    /
                  \     \    \   /    /    /
                   \     \    \ /    /    /
                    \     | .--+--. |    /
                     \    | |  1  | |   /
                      \   | .-----. |  /
                       \   \       /  /
                        \   \     /  /
                         \   \   /  /
                          |   \ /   |
                          | .--+--. |
                          | |  2  | |
                          | .-----. |
                           \       /
                            \     /
                             \   /
                              \ /
                            .--+--.
                            |  3  |
                            .-----.

             ___             O
    o       /o  \/|
            〉 GC  |       o      o
            \___/\|
        (                                (
   )     )             (                  )   (     
  (     (      )        )        )       (  )  )     )        (
(  )  )  )    (   (    ( (    ) ( (    )  )(  (  (  (          )(
 )(  (  (   (  )   )    ) )  (   ) )  (  (  )  )  )  )      ) (  ) 
```

请注意，两个列表都指向相同的对象。这就是为什么它被称为浅拷贝。如果你放了一些可变对象而不是整数，就像另一个列表一样，你可以清楚地理解为什么修改它会改变两个列表的内容。**

# haskell - Haskell：为什么 ((.).(.)) fg 等于 f 。gx?

> ID：14707720
> 
> 赞同：9
> 
> 时间：2013-02-05T12:36:09.357
> 
> 标签：haskell, types, function-composition, combinators, pointfree

你能解释一下表达式 ((.).(.)) 的含义吗？据我所知 (.) 的类型为 (b -> c) -> (a -> b) -> a -> c。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-02-05T12:48:54.557

`(.) . (.)`是组合算子与自身的组合。

如果我们看

```
((.) . (.)) f g x 
```

我们可以评估几个步骤，首先我们加上括号，

```
((((.) . (.)) f) g) x 
```

然后我们申请，使用`(foo . bar) arg = foo (bar arg)`：

```
~> (((.) ((.) f)) g) x
~> (((.) f) . g) x
~> ((.) f) (g x)
~> f . g x 
```

更有原则，

```
(.) :: (b -> c) -> (a -> b) -> (a -> c) 
```

所以，`(.)`作为 的第一个参数`(.)`，我们必须统一

```
b -> c 
```

和

```
(v -> w) -> (u -> v) -> (u -> w) 
```

这会产生

```
b = v -> w
c = (u -> v) -> (u -> w) 
```

和

```
(.) (.) = ((.) .) :: (a -> v -> w) -> a -> (u -> v) -> (u -> w) 
```

现在，要将其应用于`(.)`，我们必须统一类型

```
a -> v -> w 
```

类型为`(.)`, 重命名后

```
(s -> t) -> (r -> s) -> (r -> t) 
```

产生

```
a = s -> t
v = r -> s
w = r -> t 
```

因此

```
(.) . (.) :: (s -> t) -> (u -> r -> s) -> (u -> r -> t) 
```

并且从我们可以（几乎）读取的类型中，`(.) . (.)`将（一个参数的）函数应用于两个参数的函数的结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-06T10:45:17.050

你已经得到了答案，这里有一个稍微不同的看法。

在[组合逻辑](http://en.wikipedia.org/wiki/Combinatory_logic) `(.)`中是[***B** -combinator*](http://en.wikipedia.org/wiki/B,C,K,W_system) : `Babc = a(bc)`。在编写组合子表达式时，通常假定每个标识符仅由一个字母组成，并在应用程序中省略空格，以使表达式更具可读性。当然，通常的柯里化适用：`abcde`is `(((ab)c)d)e`，反之亦然。

`(.)`是**B**，所以`((.) . (.))`== `(.) (.) (.)`== **BBB**。所以，

```
BBBfgxy = B(Bf)gxy = (Bf)(gx)y = Bf(gx)y = (f . g x) y    
 abc        a  bc                 a b  c 
```

我们可以在最后扔掉两个`y`s （这被称为[eta-reduction](http://en.wikipedia.org/wiki/Lambda_calculus#.CE.B7-conversion) : `Gy=Hy`--> `G=H`，如果`y`没有出现在`H`¹中）。但是，另一种表达方式是

```
BBBfgxy = B(Bf)gxy = ((f .) . g) x y = f (g x y)     -- (.) f == (f .)
-- compare with:       (f .) g x = f (g x) 
```

`((f .) . g) x y`可能比输入更容易`((.).(.)) f g x y`，但是 YMMV.

* * *

¹例如，使用[**S**组合](http://en.wikipedia.org/wiki/SKI_combinator_calculus)器，定义为`Sfgx = fx(gx)`，不考虑该规则，我们可以写

```
Sfgx = fx(gx) = B(fx)gx = (f x . g) x
Sfg = B(fx)g = (f x . g)   --- WRONG, what is "x"? 
```

这是胡说八道。

# asp.net-mvc-3 - 将 MVC3 打印视图导出为 PDF

> ID：14707721
> 
> 赞同：0
> 
> 时间：2013-02-05T12:36:09.777
> 
> 标签：asp.net-mvc-3, pdf

是否可以使用 MVC3（必要时使用 3rd 方插件）使用页面的打印视图动态生成 PDF？如您在打印或打印时看到的布局预览视图。

我知道 iText(sharp) 可以从页面的普通视图创建 PDF，但我需要创建打印视图 PDF（最好通过控制器），以便可以通过电子邮件发送。

我以前有 Crystal Reports，但为了支持 HTML 报告而放弃了它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T11:00:40.677

我通过实现 Rotativa（可从 NuGet 获得）解决了我的问题。它比周围的其他转换器更简单、更有效（尽管使用自定义身份验证有点棘手）。

# r - 具有 ezANOVA 输出的事后测试

> ID：14707725
> 
> 赞同：1
> 
> 时间：2013-02-05T12:36:16.667
> 
> 标签：r, anova

我尝试使用`TukeyHSD(my_anova$aov)`但它给出了一个错误：

```
Error in UseMethod("TukeyHSD") :
no applicable method for 'TukeyHSD' applied to an object of class "c('aovlist', 'listof')" 
```

谷歌表示没有办法使用“aovlist”进行临时性发布。但也许你对 ezANOVA 输出的事后有任何想法。

例子：

```
require(ez)
data(ANT)
rt_anova = ezANOVA(data = ANT[ANT$error==0,], dv = rt, wid = subnum, within = cue,return_aov = TRUE) 
```

尝试使用 multcomp：

```
require(multcomp)
glht(my_anova$aov, linfct = mcp(cue = "Tukey"))

Error in model.matrix.aovlist(model) : 
  ‘glht’ does not support objects of class ‘aovlist’
Error in factor_contrasts(model) : 
  no ‘model.matrix’ method for ‘model’ found! 
```

尝试使用`lme`：

```
require(nlme)
lme_velocity = lme(rt ~ cue, data=ANT[ANT$error==0,], random = ~1|subnum)

Error in .Call("La_chol", as.matrix(x), PACKAGE = "base") : 
  Incorrect number of arguments (1), expecting 2 for 'La_chol'

> sessionInfo()
R version 2.15.2 (2012-10-26)
Platform: i386-w64-mingw32/i386 (32-bit)

locale:
[1] LC_COLLATE=Russian_Russia.1251  LC_CTYPE=Russian_Russia.1251    LC_MONETARY=Russian_Russia.1251 LC_NUMERIC=C                    LC_TIME=Russian_Russia.1251    

attached base packages:
[1] splines   stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] nlme_3.1-108     multcomp_1.2-15  survival_2.37-2  mvtnorm_0.9-9994 ez_4.1-1         stringr_0.6.2    scales_0.2.3     reshape2_1.2.2   plyr_1.8         memoise_0.1     
[11] mgcv_1.7-22      lme4_0.999999-0  Matrix_1.0-10    lattice_0.20-13  ggplot2_0.9.3    car_2.0-15       nnet_7.3-5       MASS_7.3-23     

loaded via a namespace (and not attached):
 [1] colorspace_1.2-1   dichromat_2.0-0    digest_0.6.2       grid_2.15.0        gtable_0.1.2       labeling_0.1       munsell_0.4        proto_0.3-10       RColorBrewer_1.0-5
[10] stats4_2.15.0      tools_2.15.0 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T12:58:38.800

这不是 ezANOVA 输出，而是重复测量 ANOVA。'aovlist' 类通常用于此目的。TukeyHSD 用于独立设计。在此处查看[此问题](https://stats.stackexchange.com/questions/14078/post-hoc-test-after-anova-with-repeated-measures-using-r)和相关链接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T12:44:04.417

您没有提供任何可重现的代码，但我的猜测是您需要使用包[multcomp](http://cran.r-project.org/web/packages/multcomp/)：

```
require(multcomp)
glht(my_anova$aov, linfct = mcp(cue= "Tukey")) 
```

（不适用于重复措施`aov`，请参阅@John 的回答为什么）

===更新===

您的代码对我有用（R 2.15.2，nlme 3.1-105，multcomp 1.2-15）：

```
> data(ANT)
> lme_velocity = lme(rt ~ cue, data=ANT[ANT$error==0,], random = ~1|subnum)
> glht(lme_velocity, linfct = mcp(cue= "Tukey"))

     General Linear Hypotheses

Multiple Comparisons of Means: Tukey Contrasts

Linear Hypotheses:
                      Estimate
Center - None == 0     -41.872
Double - None == 0     -47.897
Spatial - None == 0    -86.040
Double - Center == 0    -6.026
Spatial - Center == 0  -44.169
Spatial - Double == 0  -38.143 
```

# jquery - Jquery下拉可变高度

> ID：14707726
> 
> 赞同：0
> 
> 时间：2013-02-05T12:36:17.437
> 
> 标签：jquery

所以我想创建一个类似于星巴克的下拉 div 菜单。我的初始菜单是一个带有链接的简单 UL，但没有像普通下拉菜单那样的第二个撕裂列表。我有 Jquery 来处理链接上的悬停并显示具有相应类的 div。即，将鼠标悬停在带有 id 'blog' 的链接上 .. 显示带有类博客的 div。这很好用，问题出在 slideUp slideDown 过渡。而不是仅仅改变高度并显示新菜单（所以如果 div1 的高度为 100px ， div2 的高度为 200px ......而不是仅仅改变高度（就像在星巴克上）我的过渡一直向上滑动，然后回到新的高度。

我怎么能拥有它，所以高度只会向上或向下滑动到新的高度......然后当悬停离开时它会一直向上滑动。

目前我有一个容器 div 和其中的特定内容 div。容器 div 向下滑动，内容 div 在需要时隐藏和显示。

```
 <script>
   $('#menu a').hover(function(){

    var id =(this.id);

    switch(id)
    {
        case 'blog':
        $('.blog').show();
        $('#dropdown').slideDown();

        break;
         case 'videos':
        $('.videos').show();
        $('#dropdown').slideDown();

        break;
        case 'tutorials':
        $('.tutorials').show();
        $('#dropdown').slideDown();

        break;

    };
    },
    function(){

    $('#dropdown').slideUp();
    $('.ddmenu').hide();

   });
   </script> 
```

- - - - - - -固定的

解决它。很好破解它。我决定首先在菜单容器上使用 .hover 并在悬停时将高度设置为 0 ......但是在内部功能似乎有点浪费但使用 .mouseout 不起作用：/

继承人的代码：

```
 <script>
       $('#menu ').hover(function(){

    },
    function(){

    $('#dropdown').stop().animate({height:0},200);
    });

   $('#menu a').hover(function(){

    var id =(this.id);

    switch(id)
    {
        case 'blog':
        $('#dropdown').stop().animate({height:200},300);

        $('.blog').show();

        break;
         case 'videos':
        $('#dropdown').stop().animate({height:100},300);
        $('.videos').show();

        break;
        case 'tutorials':
        $('#dropdown').stop().animate({height:300},300);
        $('.tutorials').show();

        break;
            case 'none':
        $('#dropdown').stop().animate({height:0},300);
           $('.ddmenu').hide();       

        break;

    };
    },
    function(){

    $('.ddmenu').hide();

   });

   </script> 
```

# petapoco - 当孩子有自己的映射要做时，在 NPoco 中获取多个

> ID：14707730
> 
> 赞同：2
> 
> 时间：2013-02-05T12:36:30.707
> 
> 标签：petapoco, npoco

我已经成功地使用 NPoco FetchManyToOne 使用以下代码获取父母及其孩子：

```
public class Parent
{
    public int Id { get; set; }
    public string Name { get; set; }
    public IList<Child> Children { get; set; }
}

public class Child
{
    public int Id { get; set; }
    public int ParentId { get; set; }
    public string Name { get; set; }
}

db.FetchOneToMany<Parent, Child>(parent => parent.Id, child => child.Id,
                    @"SELECT
                        P.Id, P.Name,

                        C.Id, C.ParentId, C.Name
                    FROM Parent AS P
                        LEFT JOIN Child AS C ON P.Id = C.ParentId",
                    id); 
```

现在有这种情况，孩子可以属于一个时期。孩子不必属于某个时期，因为这是可选的。在数据库中，Period 表由一个 id 列和两个日期时间列 Start 和 End 组成。Child 表有一个新列 PeriodId，如果它不属于某个时间段，则它可以包含一个空值。

Child 类现在获得了 Period 类型的新属性。可以是 null 或 Period 类的实例。查看类结构的变化：

```
public class Parent
{
    public int Id { get; set; }
    public string Name { get; set; }
    public IList<Child> Children { get; set; }
}

public class Child
{
    public int Id { get; set; }
    public int ParentId { get; set; }
    public string Name { get; set; }

    public Period ChildPeriod { get; set; }
}

public class Period
{
    public int Id { get; set; }
    public DateTime Start { get; set; }
    public DateTime End { get; set; }
} 
```

如何将此 sql 映射到我的类？

```
@"SELECT
                        P.Id, P.Name,

                        C.Id, C.ParentId, C.Name,

                        PE.Id, PE.Start, PE.End
                    FROM Parent AS P
                        LEFT JOIN Child AS C ON P.Id = C.ParentId
                        LEFT JOIN Period AS PE ON C.PeriodId = PE.Id" 
```

因此，当一个孩子是某个时期的一部分时，该时期就是 Child 类上的属性 ChildPeriod 的值。是否有可能或者我必须编写两个对数据库的调用并自己进行一些手动映射？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T23:31:00.003

由于这实际上是 Period 的外部联接，其中 Period 有时会为空，因此您的 Child 类为：

```
public class Child
{
  public int Id { get; set; }
  public int ParentId { get; set; }
  public string Name { get; set; }

  [ResultColumn] public DateTime? Start { get; set; }
  [ResultColumn] public DateTime? End { get; set; }
} 
```

# vba - VBA：需要确定 FIND 方法的结果是 NOTHING 还是“”（空）

> ID：14707731
> 
> 赞同：2
> 
> 时间：2013-02-05T12:36:30.247
> 
> 标签：vba, excel

我有这个

```
Set rngFound = Selection.Find(What:=Trim(prirustek.Cells(i, 1).Value), LookIn:=xlValues, LookAt:=xlWhole) 
```

并且需要做这样的事情：

```
If rngFound Is Nothing Or rngFound = "" Then
... 
```

但此代码以“对象变量或未设置块变量（错误 91）”停止。我认为这个问题出在 rngFound 中，它什么都没有，但我该怎么做

```
rngFound = "" 
```

在 IF 语句中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T13:10:00.400

试试这个`If IIf(rng Is Nothing, "", rng) = "" Then`

它首先处理整个`nothing`情况。这有点像`Nz()`Access。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T12:46:17.673

怎么样：

```
Private Function isRangeEmptyOrNothing(r As Range) As Boolean

  If r Is Nothing Then
    isRangeEmptyOrNothing = True
  ElseIf IsEmpty(r) Then
    isRangeEmptyOrNothing = True
  ElseIf r = "" Then 'Not sure if this is redundant with IsEmpty
    isRangeEmptyOrNothing = True
  End If

End Function 
```

然后在您的主代码中：

```
If isRangeEmptyOrNothing(rngFound) Then 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T12:40:51.013

尝试`If rngFound Is Nothing Or rngFound.Value = "" Then`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T12:48:46.733

您可以尝试以下方法：

```
If rngFound = Empty Then ... 
```

或者

```
If isNull(rngFound) = true Then ... 
```

# c# - 阻止来自表单/用户控件的事件

> ID：14707732
> 
> 赞同：0
> 
> 时间：2013-02-05T12:36:37.767
> 
> 标签：c#, .net, winforms, user-interface

我的应用程序有时会与另一个线程中的服务器通信，而此时应该锁定表单（这意味着用户不能触发任何`Click`, `KeyDown`.... 事件）。此时，带有加载圆圈的等待覆盖显示了阻止任何鼠标事件（如单击或鼠标悬停）。

但问题是，用户可以通过按键触发 KeyDown 事件，并且用户还可以通过在使用 TAB 键导航到按钮后按 Enter 来进行鼠标点击。

我知道这`Form.Enabled = true;`可以解决问题，但是表格看起来很丑陋。我也知道我可以制作一个`bool inaction;`然后在事件处理程序中查看这个 var，但我认为有更好的方法。

**短表单：如何在没有 .Enabled = True 的情况下阻止表单中的 Click 或 KeyDown 等 GUI 事件？**

任何帮助将不胜感激。

**编辑：通过将其添加到覆盖控件来解决它：**

```
protected override bool ProcessKeyMessage(ref Message m)
{
    return true;
}
protected override bool ProcessTabKey(bool forward)
{
    return true;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T12:43:59.153

您可以将[`KeyPreview`](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.keypreview.aspx)表单的属性设置为 false。

当`KeyPreview`为 false 时，窗体将不会在事件传递给具有焦点的控件之前接收键事件。如果您将焦点更改为不与键交互的未使用控件，则表单或任何等待键事件的控件将不会收到任何事件。

# codeblocks - 如何在代码块中缩进我的代码？

> ID：14707742
> 
> 赞同：15
> 
> 时间：2013-02-05T12:37:01.210
> 
> 标签：codeblocks

最好的代码块快捷方式是什么？还有什么方法可以直接缩进我们所有的代码？此外，我们如何在代码块中的活动选项卡中移动？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2014-10-19T22:21:05.267

当您从头开始编写代码时，有关选项卡标识的提示会很有帮助。但是，如果您从某些外部源（如 PDF 文档）将代码**粘贴**到 CodeBlocks 中，则该代码通常不会具有良好的标识。

在这种情况下，您需要选择代码，右键单击它，然后选择**Format use AStyle**选项。这是用于正确文本格式的 CodeBlocks 插件。

我希望这会对某人有所帮助！

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2013-02-05T15:38:24.643

您（我相信这些是默认设置）可以选择一段代码并按下该`Tab`键。这将**缩进**整个块。

因此，对于缩进整个文件：`Ctrl`+ `A`，然后`Tab`.

此外，您可以在选定的块上使用`Shift`+来**“取消缩进”**`Tab`

 **`Ctrl`您可以使用++在打开的选项卡中`Shift`移动`Tab`。

**至于最好的捷径：**

我喜欢`Ctrl`+`D`复制一行

`Ctrl`+`L`复制它。

无论如何，您可以在编辑器菜单中设置您喜欢的任何快捷键（在那里您还可以找到当前设置的所有快捷键）。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2016-05-02T16:36:21.587

[![[![][1]](../Images/b22b3cb12db16b2c346a77f9b733c9e0.png)](https://i.stack.imgur.com/wiIcZ.png)] [2](https://i.stack.imgur.com/LflJg.png)

根据需要从**Settings->Editor->Keyboard shortcuts->plugins->Source code formatters(Astyle)**添加快捷方式或使用**Plugins->Source code formatters(Astyle)**

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-08-01T21:34:37.310

`CTRL`+`A`选择代码和`TAB`对齐。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-05-21T17:58:08.410

我对 C::B 中的代码格式化程序不太走运。我喜欢我的代码看起来像这样......

```
if (blah..) {
  SomeCode();
} else {
  DifferentCode();
} 
```

它允许更多代码适合屏幕，并且仍然具有合理的可读性。

在尝试调整 Settings->Editor 中的设置，然后是 Source Formatter 选项卡后，当我去格式化我的代码时，它完全删除了 if 行，我无法取消我的调整以使其工作。

Fornatually， ctrl-z 仍然有效。

代码格式化程序不应该删除代码，只能使用空格。

也许有更好的插件。

标记。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-11-17T18:35:38.980

此外，如何在代码块中的选项卡之间切换。

代码块 20.03
Linux (KDE Neon)

在选项卡之间切换。

用 激活它`CTRL+SHIFT+TAB`，然后您可以使用已知选项：

*   CTRL+TAB ，切换到右侧选项卡。

*   CTRL+SHIFT+TAB ，切换到左侧选项卡。

*   **或其他选项**，但这不在[键盘快捷键](http://wiki.codeblocks.org/index.php/Keyboard_Shortcuts)中，此选项在循环模式下不起作用，当您获得最后一个正确的选项卡时，它会跳转到底部选项卡：

    *   CTRL+ 右箭头键，切换到右侧选项卡。
    *   CTRL+左箭头键，切换到左侧标签。

**记得用 激活`CTRL+SHIFT+TAB`**。

进入愿望选项卡后，您可以键入`TAB`开始编写代码。**

# jsf - JSF：Primefaces：无法使用 RequestContext 从 Bean 打开对话框

> ID：14707751
> 
> 赞同：1
> 
> 时间：2013-02-05T12:37:34.167
> 
> 标签：jsf, dialog, primefaces, requestcontext

我无法从我的 Bean 中打开 Dialog。我也试过`actionListener`而不是`action`

**这就是我的 JSF 的样子：**

```
<ui:composition template="../templates/site.xhtml"
xmlns="http://www.w3.org/1999/xhtml"
xmlns:ui="http://java.sun.com/jsf/facelets"
xmlns:f="http://java.sun.com/jsf/core"
xmlns:h="http://java.sun.com/jsf/html"
xmlns:p="http://primefaces.org/ui"
xmlns:sec="http://www.springframework.org/security/tags">
<!-- remove me just for encoding check Ã¤ -->
<ui:define name="content">
    <h:form id="form">
        <h:panelGrid columns="1" cellpadding="5">

            <p:commandButton value="Button" type="button" id="myButton"
                action="#{testBean.showDialog}" />
        </h:panelGrid>
    </h:form>

    <p:dialog id="testDialog" widgetVar="testDialog2"
        header="My Test Dialog" modal="true" appendToBody="true">
        <h:form>

            <h:outputText value="Output" />

        </h:form>
    </p:dialog>

</ui:define> 
```

**这是我的豆子**

```
@Component
@Scope("view")
public class TestBean {

    public void showDialog(){
        RequestContext.getCurrentInstance().execute("testDialog2.show()");
    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T12:46:06.553

您的`showDialog()`方法根本没有被调用。删除`type="button"`，因为你想使用 AJAX 启用提交，而不是按钮。

# php - 解析错误：语法错误，意外的 T_ECHO，期待 ',' 或 ';' 在 /home/content/95/10216895/html/test/call_entry.php 上线

> ID：14707754
> 
> 赞同：1
> 
> 时间：2013-02-05T12:37:44.317
> 
> 标签：php

我正在尝试在下拉列表中显示表格中的值。但我遇到了错误。任何人都可以帮我解决这个问题吗？

```
echo "<select name=\"product\">"
while ($row = mysqli_fetch_array($result))
{
echo "<li>" .$row['product_id']. "</li>";
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T12:38:31.247

您在第一行缺少一个半列。

```
echo "<select name=\"product\">"; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-05T12:38:41.557

```
echo "<select name=\"product\">" ; 
```

你最后错过了分号

# javascript - 如何在dojo中使用正则表达式获取元素ID

> ID：14707762
> 
> 赞同：1
> 
> 时间：2013-02-05T12:37:58.797
> 
> 标签：javascript, html, regex, dom, dojo

我有很多输入字段，例如：

```
<input id="number1" type="text" />
<input id="number2" type="text" />
<input id="number3" type="text" />
<input id="number4" type="text" /> 
```

我想获取所有以“数字”开头的 ID，后跟一个数字。

任何可以帮助我获得这些值的函数（在 dojo 库中）..

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-05T12:49:33.843

试试这个

```
 console.log(dojo.query("[id^='number']")); 
```

这将获取从编号开始的所有带有 id 的文件

# php - 我无法在工作组的某些电脑上连接到我的系统

> ID：14707763
> 
> 赞同：-1
> 
> 时间：2013-02-05T12:38:03.490
> 
> 标签：php, mysql, appserver

好吧，我在服务器中安装了 Appserv appserv-win32-2.5.10，并且我在 Php 和 mysql 中有一个系统。工作组的一些电脑无法进入我的系统，系统充电慢，无法完成。

请帮助对不起我的英语。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T14:45:51.567

在你的 httpd.conf Apache 文件的目录标签中，你应该尝试这样的事情：

```
<Directory "/www/your_webroot">
 order allow,deny
 allow from all
</Directory> 
```

所有人的允许，应该有效；）

PS：这是 httpd.conf 文件的一个很好的例子：http: [//www.devside.net/guides/config/windows/httpd-conf](http://www.devside.net/guides/config/windows/httpd-conf)

# xml - 根据用户输入读取 XML 节点属性

> ID：14707770
> 
> 赞同：0
> 
> 时间：2013-02-05T12:38:18.807
> 
> 标签：xml, linq, c#-4.0, linq-to-xml, readxml

```
<Default>
<SharepointContentType id="SharePointContentType">

<name id="Test1"
         DisplayName="TestOne"
         SharepointGroup="Test1SPGp">
    </name>

<name id="Test2"
         DisplayName="TestTwo"
          SharepointGroup="Test2SPGp">
    </name>
.
.
.
.

</SharepointContentType>
.
.
.
.
<Default> 
```

对于上面我想下降的模式，找到一个 id 的节点，而不是找到id的`SharePointContentType`标签（用户定义），然后获取元素的值`<name >``Test1``SharepointGroup`

例如，如果用户输入`Test1`不是输出，`Test1SPGp`请帮助我尝试使用 linq 并设法编写如下代码，但未能成功。

```
 XDocument xDoc = XDocument.Load(GetDefaultXMLFile());

    var feeds = from feed in xDoc.Descendants("name")
                where feed.Attribute("id").Equals("admin")
                select new
                {
                    fxfv = feed.Attribute("SharepointGroup").Value
                }; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T07:36:37.957

我认为你在 where 条件上有一个错误，见下文：

feed.Attribute("id") 返回 XAttribute 类，因此您不能使用 equals 与字符串进行比较，但在 Value 属性之后可以。

```
 var feeds = from feed in xDoc.Descendants("name")
                    where feed.Attribute("id").Value.Equals("Test1")
                    select new
                    {
                        fxfv = feed.Attribute("SharepointGroup").Value
                    }; 
```

# ajax - 使用 ajax 和 jquery 从 url 获取响应

> ID：14707771
> 
> 赞同：-3
> 
> 时间：2013-02-05T12:38:19.577
> 
> 标签：ajax, jquery, asp.net-ajax

想要使用 ajax 和 jquery 从 url 获得响应。

尝试使用此代码

```
$(document).ready(function () { 
     $.ajax({ 
       type: 'POST', 
       url: 'apexweb.co.in/apex_quote/uname_validation.asp?,
       dataType:'jsonp', 
      success: function(data){ 
           alert(data); 
      } 
    });
}); 
```

我想将响应显示为失败，但我没有在浏览器上得到任何响应

帮我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T13:21:54.167

尝试这个

```
$(document).ready(function () {
            $.ajax({
                type: "POST",
                url: "apexweb.co.in/apex_quote/uname_validation.asp?",                
                contentType: "application/json; charset=utf-8",
                dataType: "jsonp",
                success: function (data) {
                    alert(data.d); 
                },
                failure: function (data) {
                    alert(data.d);
                }
            });
        }); 
```

# database - 在数据库项目中使用 XmlSerializers 程序集部署错误

> ID：14707779
> 
> 赞同：0
> 
> 时间：2013-02-05T12:38:37.893
> 
> 标签：database, visual-studio-2010, sql-server-2008

在 VS2010 数据库项目中，我引用了一个 CLR 项目“MyProject”，它使用构建选项“生成序列化程序集”。所以，一代MyProject会生成MyProject.dll和MyProject.XmlSerializers.dll。

当我在我的数据库项目上选择“部署”时，出现以下错误： MyDatabase.dbschema(0,0): Error TSD00562: If this deployment is executed, [MyProject.XmlSerializers] 将被删除并且不会重新创建。

如何解决此错误？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-28T13:49:51.453

在我的示例程序集中名称是 CallWorkflowServiceCLR.dll 和 CallWorkflowServiceCLR.XmlSerializers.dll

我在目标服务器（“my_server_name”）上创建并共享文件夹“D:\CLRProcedure”，专门用于部署。

在 Visual Studio 中的项目属性/构建事件/构建后事件命令行中 - 我写道： xcopy /Q /Y "$(TargetDir)*.dll" "\my_server_name\CLRProcedure\"

然后在 PostDeployScript.sql 中写道：

```
if exists (select * from sys.assemblies 
where name = 'CallWorkflowServiceCLR.XmlSerializers')
DROP ASSEMBLY [CallWorkflowServiceCLR.XmlSerializers]

CREATE ASSEMBLY [CallWorkflowServiceCLR.XmlSerializers] 
from 'D:\CLRProcedure\CallWorkflowServiceCLR.XmlSerializers.dll' 
```

PS：在我的项目属性中：

```
Build / Generate serialization assembly = ON
Database / Permisssion level = EXTERNAL 
```

此外，您应该从有权使用目标服务器的用户帐户启动 Visual Studio

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-25T15:34:13.753

解决方案是一组 Visual C# SQLCLR 数据库项目，关于 Build 属性“生成序列化程序集”为“ON”参见[http://msdn.microsoft.com/en-us/library/vstudio/kb4wyys2(v=vs. 100).aspx](http://msdn.microsoft.com/en-us/library/vstudio/kb4wyys2(v=vs.100).aspx)。问候拉科。

# java - 使用 InternalEntryFactory 类将 Infinispan 4.2 迁移到 5.1

> ID：14707784
> 
> 赞同：0
> 
> 时间：2013-02-05T12:38:49.917
> 
> 标签：java, jboss, infinispan

我们正在 Java 项目中从 Infinispan 4.2 迁移到 5.1。

在 4.2 版中，有一个名为 InternalEntryFactory 的类，它位于 org.infinispan.container.entries 包中。

但是在 5.1 版本中，这个类不再存在。它被 org.infinispan.container 包中的 InternalEntryFactory 接口所取代。

这是我的问题：我现在应该使用这个接口的哪个实现？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T08:52:31.220

使用哪种实现取决于缓存是否是版本控制的。但是你不应该直接实例化实现类，你应该只使用接口：

```
 InternalEntryFactory internalEntryFactory = cache.getAdvancedCache().getComponentRegistry().getComponent(InternalEntryFactory.class); 
```

# c - 以编程方式在 Linux 中查找文件类型

> ID：14707785
> 
> 赞同：0
> 
> 时间：2013-02-05T12:38:49.953
> 
> 标签：c, linux, linux-kernel

我正在尝试查找 .pdf、.doc、.docx 等文件的文件类型，但以编程方式不使用 shell 命令。实际上我必须制作一个应用程序来阻止访问特定扩展名的文件。我已经在 LKM 中连接了 sys_call_table，现在我希望在触发打开/读取系统调用时，我的 LKM 会检查文件类型。

我知道我们有一个当前指针，它可以访问当前进程结构，我们可以使用它来查找存储在 dentry 结构中的文件名，而且在 Linux 中，文件类型由存储在文件起始字节中的幻数标识。但我不知道如何找到文件类型以及它的确切存储位置？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-05T12:48:18.143

Linux 不会“存储”其文件的文件类型（与 Mac OS 的[resource fork](http://en.wikipedia.org/wiki/Resource_fork)不同，我认为这是最知名的执行此操作的平台）。文件只是命名的字节流，它们没有操作系统暗示的结构。

要么您只是告诉程序要使用哪个文件（然后它按您说的做），要么程序使用更高级别的功能来解决它​​。

有一些程序可以重新发明这个特定的轮子（我负责[其中一个](http://en.wikipedia.org/wiki/Gentoo_file_manager)），但你也可以使用例如[`file(1)`](http://linux.die.net/man/1/file). 当然，这需要您的程序解析和“理解”您将获得的文本输出，这在某种意义上只会解决问题。

然而，我不认为`file`从内核空间调用是非常明智的，所以最好为你需要的任何类型重新创建测试，以保持它的小。

换句话说，我的意思是你应该简单地重新实现所需的测试。这通常是相当复杂的，所以如果你真的需要为尽可能多的类型做这件事，这可能不是一个好主意。：/

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T13:03:51.320

> Actually i have to make an application which blocks access to files of a particular extension.

that's a flawed requirement. If you check by file extension, then you'll miss files that doesn't use the extension which is quite common in Linux since it does not use file extension.

The officially sanctioned way of detecting file type in Linux is by their magic number. The shell command `file` is basically just a wrapper for libmagic, so you have the option of linking to that library

# encoding - ANSI 视图与记事本和记事本++不同。为什么？

> ID：14707786
> 
> 赞同：0
> 
> 时间：2013-02-05T12:38:56.127
> 
> 标签：encoding, notepad++, iso-8859-1, notepad

我正在使用 ISO-8859 编码将一些数据写为 xml 文件。如果我尝试在 notepad++ 中打开文件。我可以看到文件中已经存在的“Â”字符。但是如果我尝试打开记事本中的文件，字符'Â'被删除。虽然我对编码很陌生，但我不知道为什么。请为此提出一些理由。

该文件也可以在浏览器中使用 'Â' 字符打开。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T09:44:17.467

Windows 记事本是一个非常基本的编辑器，有很多限制，其中之一是它支持除 ANSI、Unicode 和 UTF-8 之外的不同编码格式。编辑其他格式的文件时，可能会产生不可靠/意外的结果。

如果您要处理不同编码格式的文件，最好完全避免使用记事本并使用对多种编码格式有更好支持的编辑器（例如 Notepad++）。

有关 Windows 记事本如何以正确格式“猜测”以使用（成功程度不同）的更多信息，[请参见此处](http://blogs.msdn.com/b/oldnewthing/archive/2007/04/17/2158334.aspx)

请记住，其他编辑器经常使用类似的技术来“猜测”文件的格式，因此最好手动检查/设置文件的编码（在可能的情况下）以获取不太常见的编码格式，以确保您得到每次都是正确的结果。

# java - 如何序列化类型 X 的列表，填充类型为 Y 的对象，扩展 X，并且在反序列化时仍然获得 Y 元素？

> ID：14707789
> 
> 赞同：0
> 
> 时间：2013-02-05T12:38:58.887
> 
> 标签：java, list, serialization, types, subclass

我有这个清单

```
LinkedList<ASD> list = new LinkedList<ASD>(); 
```

然后，我添加了一些扩展 ASD 的对象

```
BSD bsd = new BSD(); // BSD extends ASD
list.add(bsd); 
```

并序列化列表。

如何让它将 bsd 元素序列化和反序列化为 BSD 而不是 ASD？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T12:44:12.410

这不成问题。您要序列化的所有对象都必须是实现`Serializable`. `LinkedList`可以。声明`ASD`或`BSD`（在您的情况下无关紧要）实施`Serializable`并尝试。一切都应该工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T13:21:10.780

正如 AlexR 所指出的，一切都很好：

```
class ASD implements Serializable {
  private static final long serialVersionUID = 1L;
}

class BSD extends ASD {
  private static final long serialVersionUID = 1L;
}

LinkedList<ASD> list = new LinkedList<ASD>();
list.add(new BSD())
```

现在，如果你序列化`list`，然后反序列化它，它的元素将是正确的类型`BSD`。

此外，在序列化期间不会保存泛型类型参数（`<ASD>`事物）。序列化过程只会记住那`list`是一个`LinkedList`对象。这意味着您可以序列化一个类型的对象，`LinkedList<ASD>`然后将其反序列化为`LinkedList<BSD>`（或什至为 eg `LinkedList<Integer>`）。但是，如果您尝试访问无法转换为新指定的泛型类型的列表元素，则稍后可能会引发异常。

最后，我只是说这是可行的，并不是说这是一个好习惯:)

# java - 使用 Z3 的 Java 中的分段错误

> ID：14707790
> 
> 赞同：1
> 
> 时间：2013-02-05T12:39:00.730
> 
> 标签：java, c, java-native-interface, z3

我正在使用 Java JNI 将[Z3 Solver](http://z3.codeplex.com/) C-Api 集成到我们正在使用的框架中。现在，我收到以下消息的分段错误 -

```
#
# A fatal error has been detected by the Java Runtime Environment:
#
#  SIGSEGV (0xb) at pc=0x664c4af0, pid=10878, tid=3060636480
#
# JRE version: 7.0_09-b30
# Java VM: OpenJDK Server VM (23.2-b09 mixed mode linux-x86 )
# Problematic frame:
# C  [libSpdfZ3.so+0x634af0]  small_object_allocator::allocate(unsigned int)+0x40
#
# Failed to write core dump. Core dumps have been disabled. To enable core dumping, try "ulimit -c unlimited" before starting Java again
#
# An error report file with more information is saved as:
# /home/rajtendulkar/workspace/Java-WorkSpace/spdf-compiler_with_Yices_and_Z3_StaticLib/hs_err_pid10878.log
#
# If you would like to submit a bug report, please include
# instructions on how to reproduce the bug and visit:
#   https://bugs.launchpad.net/ubuntu/+source/openjdk-7/
# The crash happened outside the Java Virtual Machine in native code.
# See problematic frame for where to report the bug.
# 
```

在日志文件中，它指向分配 Z3 上下文的一个调用。基本上它是一个带有一些内存分配的初始化例程。

我想尝试了解导致此分段错误的原因。我想提一下，我的程序运行一次就可以正常工作。但是，如果我在这样的 for 循环中运行它 -

```
for (int i=0;i<5;i++)
{
     // create z3 context
     Z3Object obj = new Z3Object();
     ...
     ... 
     .. do some exploration here ..
     ...  
     ...
     ...     
} 
```

我只是在想这是否与内存分配或内存不足或类似的事情有关？

任何有关如何调试它的指针都值得赞赏。

**编辑 ：**

当我有时尝试调试代码并慢慢单步执行时，我没有遇到这个问题。同样，如果我在 for 循环结束时延迟 5 秒，我不会得到任何 seg。过错。那么它是否与任何并发问题有关？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T17:15:37.863

您似乎正在为 Z3 开发自定义 JNI 绑定。请注意，Z3 将在下一个版本中附带它自己的绑定。这已经包含在[Codeplex](http://z3.codeplex.com/SourceControl/BrowseLatest)的“不稳定”分支中，可以作为灵感甚至替代。

请注意，从 z3.dll 获得的对象必须正确进行引用计数，这取决于所使用的垃圾收集器的类型，这可能会非常棘手。我的第一个怀疑是（由 Z3 收集）对象而您的程序没有意识到它（例如，因为引用计数不同步），或者您的垃圾收集器试图以 Z3 没有的顺序销毁对象t 预期（例如，在所有关联对象被销毁之前销毁上下文）。

并发问题可能不是由于您自己的程序，而是因为垃圾收集器是并发的（如果我没记错的话，Java 的更高版本实际上带有 4 个不同的，并根据主机系统在它们之间进行选择，这可能是问题的来源）。

# c# - 如何绑定datagridviewcomboboxcell并添加valuemember和displaymember

> ID：14707791
> 
> 赞同：0
> 
> 时间：2013-02-05T12:39:15.503
> 
> 标签：c#, vb.net, winforms

大家好，

我正在用 VB.NET 和 C# 开发桌面应用程序，我已经掌握了简单页面 CRUD 应用程序的每个概念，现在我正在开发具有主事务表概念的页面，我需要在 datagridview 中绑定组合框，但是我我没有办法做到这一点，

因此，我们将不胜感激有关此主题的任何帮助，

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T12:53:40.110

如果您有 DataGridViewComboBoxColumn 然后将此列中的每个 ComboBoxCell 绑定到给定的数据源，您可以这样做：

```
private void Bind(ICollection<YourObject> source)
{
     //assume col is the combobox column
     col.DisplayMember = "Name";  //name of property that will be displayed in combo box
     col.ValueMember = "Id";      
     col.DataSource = source;
} 
```

就是这样:)。

# antlr - 在 antlr4 词法分析器中，如何有一个规则将所有剩余的“单词”捕获为未知标记？

> ID：14707797
> 
> 赞同：14
> 
> 时间：2013-02-05T12:39:33.203
> 
> 标签：antlr, lexer, antlr4

我有一个 antlr4 词法分析器语法。它有许多单词规则，但我也希望它为其他规则无法匹配的任何单词创建一个未知标记。我有这样的事情：

```
Whitespace : [ \t\n\r]+ -> skip;
Punctuation : [.,:;?!];
// Other rules here
Unknown : .+? ; 
```

现在生成的匹配器将 '~' 捕获为未知，但会为输入 '~~~' 创建 3 个 '~' 未知标记，而不是单个 '~~~' 标记。我应该怎么做才能告诉词法分析器为未知的连续字符生成单词标记。我也试过“未知：.;” 和“未知：.+ ;” 没有结果。

**编辑：**在当前的 antlr 版本中 .+? 现在捕获剩余的单词，所以这个问题似乎得到了解决。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-05T19:23:14.810

`.+?`在词法分析器规则的末尾将始终匹配单个字符。但是`.+`会尽可能多地消耗，这在 ANTLR v3（可能也是 v4）的规则末尾是非法的。

您可以做的只是匹配一个字符，然后在解析器中将它们“粘合”在一起：

```
unknowns : Unknown+ ; 

...

Unknown  : . ; 
```

## 编辑

> ...但我只有一个词法分析器，没有解析器...

啊，我明白了。然后你可以覆盖该`nextToken()`方法：

```
lexer grammar Lex;

@members {

  public static void main(String[] args) {
    Lex lex = new Lex(new ANTLRInputStream("foo, bar...\n"));
    for(Token t : lex.getAllTokens()) {
      System.out.printf("%-15s '%s'\n", tokenNames[t.getType()], t.getText());
    }
  }

  private java.util.Queue<Token> queue = new java.util.LinkedList<Token>();

  @Override
  public Token nextToken() {    

    if(!queue.isEmpty()) {
      return queue.poll();
    }

    Token next = super.nextToken();

    if(next.getType() != Unknown) {
      return next;
    }

    StringBuilder builder = new StringBuilder();

    while(next.getType() == Unknown) {
      builder.append(next.getText());
      next = super.nextToken();
    }

    // The `next` will _not_ be an Unknown-token, store it in 
    // the queue to return the next time!
    queue.offer(next);

    return new CommonToken(Unknown, builder.toString());
  }
}

Whitespace  : [ \t\n\r]+ -> skip ;
Punctuation : [.,:;?!] ;
Unknown     : . ; 
```

运行它：

```
java -cp antlr-4.0-complete.jar org.antlr.v4.Tool Lex.g4
javac -cp antlr-4.0-complete.jar *.java
java -cp .:antlr-4.0-complete.jar Lex
```

将打印：

```
未知的“富”
标点符号','
未知的“酒吧”
标点符号“。”
标点符号“。”
标点符号“。”
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-01-18T00:16:53.980

接受的答案有效，但仅适用于 Java。

我将提供的 Java 代码转换为与 C# ANTLR 运行时一起使用。如果其他人需要它...给你！

```
@members {
private IToken _NextToken = null;
public override IToken NextToken()
{
    if(_NextToken != null)
    {
        var token = _NextToken;
        _NextToken = null;
        return token;
    }

    var next = base.NextToken();
    if(next.Type != UNKNOWN)
    {
        return next;
    }

    var originalToken = next;
    var lastToken = next;
    var builder = new StringBuilder();
    while(next.Type == UNKNOWN)
    {
        lastToken = next;
        builder.Append(next.Text);
        next = base.NextToken();
    }
    _NextToken = next;
    return new CommonToken(
        originalToken
    )
    {
        Text = builder.ToString(),
        StopIndex = lastToken.Column
    };
}
} 
```

# sql - 按相关性查询和排序

> ID：14707799
> 
> 赞同：2
> 
> 时间：2013-02-05T12:39:37.057
> 
> 标签：sql, postgresql, postgresql-performance

我在这样的查询中有多个条件：

```
SELECT * FROM image WHERE name LIKE '%text%' AND group_id = 10 LIMIT 1 
```

WHERE 语句由 3 个条件组成：

*   文字匹配
*   外键匹配

如果我想按相关性对结果进行排序怎么办，这取决于：

1.  文本匹配的精确程度
2.  完全满足多少条件（例如文本匹配*和*外键）

这是两个问题，但我认为有时这些问题结合起来会很方便。通过这个，我指的是我以前的帖子中提出的一个问题（[在结果可用之前尝试多个 SELECTs 的方法？](https://stackoverflow.com/questions/14339715)）。

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-05T12:53:08.510

要知道文本的匹配程度，您需要[`fuzzystrmatch`](http://www.postgresql.org/docs/9.1/static/fuzzystrmatch.html)PostgreSQL 模块。它提供了函数 as`difference`并且`levenshtein`可以估计两个字符串之间的相似性。

然后，您可以使用以下条件构建查询：

```
 SELECT *
      FROM image
     WHERE name LIKE '%text%' 
       AND ( group_id = 10 
             OR second_field = 4
             OR thirth_field = 5
           )
    ORDER BY ( (group_id=10)::int
               + (second_field=4)::int
               + (thirth_field=5)::int
             ) * weight_1
             + (strlen(name) - levenshtein('text',name)) * weight_2 
```

您可以调整`weight_1`并`weight_2`优先考虑文本距离或满足的条件数量。

# mysql - 带有计数子查询的 MYSQL 内连接

> ID：14707800
> 
> 赞同：0
> 
> 时间：2013-02-05T12:39:38.160
> 
> 标签：mysql, sql, join

我有一个 Mysql 查询，它从具有内部连接的 2 个表中选择一些列。它应该从一个表列中计算“Y”值，并使用 Group By 来计算这个计数。

这是我的查询：

```
SELECT (SELECT Count(tblinterview.Contacted) FROM tblinterview WHERE tblinterview.Contacted = "Y") 
as Contact_Y , tbldata.RegionID, tbldata.BranchCode, tbldata.BranchDesc, tbldata.CampaignID,      tblinterview.EndTime      
FROM tbldata INNER JOIN tblinterview 
WHERE tblinterview.DataID = tbldata.DataId 
AND tblinterview.Complete = "Y"
GROUP BY tbldata.BranchCode, tbldata.RegionID, tblinterview.EndTime 
```

我的结果集是：所有 Contact_Y 都是所有记录的总数，而不是分组计数。

```
Contact_Y      RegionID        BranchCode           BranchDesc     CampaignID   EndTime
1407            1           9725            Dada Motors        31           2012-01-26 12:51:12
1407            1           9725            Dada Motors        31           2012-01-31 10:25:18
1407            1           9725            Dada Motors        31           2012-02-01 11:30:37
1407            1           9725            Dada Motors        31           2012-02-01 14:48:57
1407            3           9732            Ballito Autohaus   37       2012-01-16 15:04:12
1407            3           9732            Ballito Autohaus   46           2012-01-18 11:59:53
1407            3           9732            Ballito Autohaus   31           2012-01-20 14:26:12
1407            3           9732            Ballito Autohaus   31           2012-01-20 16:05:48 
```

有人可以解释我的查询哪里错了吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T12:47:29.783

*试试这个*

```
SELECT   (SELECT Count(s.Contacted) 
        FROM tblinterview s
        WHERE s.Contacted = "Y" AND 
        tbldata .DataID = s.DataID) as Contact_Y , 
        tbldata.RegionID, 
        tbldata.BranchCode, 
        tbldata.BranchDesc, 
        tbldata.CampaignID,      
        tblinterview.EndTime      
FROM    tbldata 
        INNER JOIN tblinterview  ON tblinterview.DataID = tbldata.DataId 
WHERE   tblinterview.Complete = "Y"
GROUP BY tbldata.BranchCode, tbldata.RegionID, tblinterview.EndTime 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T12:45:44.627

```
SELECT
  Count(tblinterview.Contacted) as Contact_Y,
  tbldata.RegionID,
  tbldata.BranchCode,
  tbldata.BranchDesc,
  tbldata.CampaignID,
  tblinterview.EndTime
FROM
  tbldata INNER JOIN tblinterview
  ON (tblinterview.DataID = tbldata.DataId
      AND tblinterview.Contacted = "Y")
GROUP BY
  tbldata.BranchCode,
  tbldata.RegionID,tblinterview.EndTime 
```

# caching - L1 和 L2 缓存的行大小

> ID：14707803
> 
> 赞同：88
> 
> 时间：2013-02-05T12:39:38.510
> 
> 标签：caching, memory-management, cpu-architecture, cpu-cache

从本论坛上一个[问题](https://stackoverflow.com/questions/14705840/cache-eviction-from-l1-cache-on-l2-eviction)中，我了解到在大多数内存系统中，L1 缓存是 L2 缓存的子集，这意味着从 L2 中删除的任何条目也会从 L1 中删除。

所以现在我的问题是如何为 L2 缓存中的条目确定 L1 缓存中的相应条目。L2 条目中存储的唯一信息是标签信息。基于此标记信息，如果我重新创建 addr，如果 L1 和 L2 缓存的行大小不同，它可能会跨越 L1 缓存中的多行。

该体系结构是否真的会为刷新两条线而烦恼，或者它只是维护具有相同线大小的 L1 和 L2 缓存。

我知道这是一个政策决定，但我想知道常用的技术。

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2013-03-01T16:57:47.817

Cache-Lines 大小（通常）为 64 字节。

此外，看看这篇关于处理器缓存的非常有趣的文章： [*处理器缓存效果库*](http://igoro.com/archive/gallery-of-processor-cache-effects/)

您将找到以下章节：

1.  内存访问和性能
2.  缓存行的影响
3.  L1 和 L2 缓存大小
4.  指令级并行
5.  缓存关联性
6.  虚假缓存行共享
7.  硬件复杂性

* * *

## 回答 #2

> 赞同：89
> 
> 时间：2013-03-11T07:19:47.390

在核心 i7 中，L1、L2 和 L3 中的行大小是相同的：即 64 字节。我想这简化了维护包容性和连贯性。

请参见第 10 页：[https ://www.aristeia.com/TalkNotes/ACCU2011_CPUCaches.pdf](https://www.aristeia.com/TalkNotes/ACCU2011_CPUCaches.pdf)

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2014-08-13T15:00:33.760

在严格包含的缓存层次结构中处理缓存块大小的最常见技术是对强制包含属性的所有缓存级别使用相同大小的缓存块。与更高级别的缓存使用更大的块相比，这会导致更大的标签开销，这不仅会使用芯片面积，而且还会增加延迟，因为更高级别的缓存通常使用分阶段访问（在访问数据部分之前检查标签）。然而，它也在一定程度上简化了设计，并减少了数据未使用部分造成的容量浪费。它不需要在 128 字节缓存块中占用大部分未使用的 64 字节块来补偿额外 32 位标记的面积损失。此外，可以通过相对简单的预取来提供利用更广泛空间局部性的更大缓存块效果，

一种不太常见的技术将缓存块划分为扇区。将扇区大小与较低级别缓存的块大小相同可以避免过度反向无效的问题，因为较高级别缓存中的每个扇区都有自己的有效位。（为每个扇区提供所有一致性状态元数据而不仅仅是有效性可以避免在一个块中至少一个扇区没有脏/修改和一些一致性开销时使用过多的回写带宽[例如，如果一个扇区处于共享状态而另一个扇区处于共享状态。在独占状态下，对独占状态下的扇区的写入可能不涉及一致性流量——如果使用的是 snoopy 而不是目录一致性]。）

当标签在处理器芯片上但数据在芯片外时，扇区缓存块的面积节省尤其显着。显然，如果数据存储占用的面积与处理器芯片的大小相当（这并非不合理），那么带有 64 字节块的 32 位标签将占用大约 16（~6%）的处理器面积，而 128-字节块将需要一半。（IBM 于 2009 年推出的 POWER6+ 可能是使用处理器芯片内标签和处理器外数据的最新处理器。像 IBM 那样将数据存储在更高密度的嵌入式 DRAM 和低密度 SRAM 中的标签夸大了这一点影响。）

需要注意的是，英特尔使用“缓存行”来指代较小的单元，而“缓存扇区”则指代较大的单元。（这是我在解释中使用“高速缓存块”的原因之一。）使用英特尔的术语，高速缓存行的大小在高速缓存级别之间变化是非常不寻常的，无论级别是严格包含、严格排他还是使用其他一些包容性政策。

（严格排除通常使用更高级别的缓存作为受害者缓存，其中来自较低级别缓存的驱逐被插入到更高级别的缓存中。显然，如果块大小不同并且未使用扇区，那么驱逐将需要其余的从某处读取的较大块，*如果*存在于较低级别的缓存中则无效。[*理论上*，严格排除可以与不灵活的缓存绕过一起使用，其中 L1 驱逐将绕过 L2 并转到 L3，而 L1/L2 缓存未命中只会是分配*给*L1*或**L2，绕过 L1 进行某些访问。我所知道的最接近此实现的是 Itanium 绕过 L1 进行浮点访问。但是，如果我没记错的话，L2 包括 L1。]）*

 ** * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-08-13T11:13:48.803

通常，在一次访问主存储器时，会访问 64 个字节的数据和 8 个字节的奇偶校验/ECC（我不记得具体是哪个）。在不同的内存级别维护不同的高速缓存行大小是相当复杂的。您必须注意，缓存行大小与该架构上的字对齐大小的相关性比其他任何因素都高。基于此，高速缓存行大小与内存访问大小几乎不可能不同。现在，奇偶校验位供内存控制器使用——因此高速缓存行大小通常为 64 字节。除了寄存器之外，处理器实际上控制的很少。计算机中发生的所有其他事情更多是关于安装硬件以优化 CPU 性能。同样在这个意义上，*

# linux - 无法将名称与 uid 1234 关联

> ID：14707805
> 
> 赞同：0
> 
> 时间：2013-02-05T12:39:59.120
> 
> 标签：linux, email

如何使用*虚拟*用户从批处理脚本发送邮件（/etc/passwd 中不存在 uid 号）？

目前它一直在失败：

```
$ mail -s "my subject" foobar@example.com
Cannot associate a name with uid 1234 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T12:48:13.967

你可以`sendmail`直接打电话。只需构建包含标题的完整电子邮件消息，然后通过`sendmail -t`. `-t`告诉 sendmail 从消息本身读取标题以获取所需信息。

```
---start of mail.txt---
date: now
to: foobar@example.com
subject: My Subject 
from: your-email@example.com

body of message.....
---end of mail.txt---- 
```

然后

```
 /usr/sbin/sendmail -t < mail.txt 
```

或者您可以只打开一个管道，并将消息的内容回显到管道中

`| /usr/sbin/sendmail -t`

# facebook - Facebook 在发布时未从页面显示正确的图像

> ID：14707806
> 
> 赞同：0
> 
> 时间：2013-02-05T12:40:06.143
> 
> 标签：facebook, image, post, share

我创建了这个网站 www.almasryanews.com 问题是在 facebook 上发布这样的链接时（不使用页面中的共享按钮） [http://www.almasryanews.com/news_details.php?id=217](http://www.almasryanews.com/news_details.php?id=217)我没有获得主图像，但我从侧边栏中的照片库中获得了一些其他图像，当我使用页面中的共享按钮时，它会显示正确的图像，尽管我正在使用

```
 <link rel="image_src" href="image path here"/> 
```

请问如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T12:42:56.403

您应该通过将其添加到您的 head 标签中来指定它

```
<meta property="og:image" content="http://yourwebsite.com/path_to_your_image.jpeg" /> 
```

并将您的 html 标记替换为

```
<html xmlns="http://www.w3.org/1999/xhtml" dir="rtl" xmlns:fb="http://ogp.me/ns/fb#"> 
```

我建议你：

*   阅读有关[开放图协议](http://ogp.me/)的更多信息。
*   使用[Facebook 调试器](http://developers.facebook.com/tools/debug)了解 Facebook 实际*看到*的内容（注意缓存）。

# iphone - iPhone 应用程序横向模式不起作用

> ID：14707809
> 
> 赞同：1
> 
> 时间：2013-02-05T12:40:30.757
> 
> 标签：iphone, ios, objective-c, cocoa-touch

目前我在 iPhone 应用程序中只有纵向模式。我想在应用程序中允许一个控制器的横向模式，但不幸的是我无法使其工作。

我的 plist 文件中有这些设置：

```
<array>
    <string>UIInterfaceOrientationPortrait</string>
    <string>UIInterfaceOrientationLandscapeRight</string>
    <string>UIInterfaceOrientationLandscapeLeft</string>
</array> 
```

我在我的控制器中实现了这些方法：

```
-(BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
}

-(NSUInteger)supportedInterfaceOrientations
{
    return UIInterfaceOrientationMaskAllButUpsideDown;
}

-(BOOL)shouldAutorotate
{
   return YES;
} 
```

我在应用程序中使用导航控制器，所以我意识到这可能是问题所在。我将其子类化`UINavigationController`并再次实现`shouldAutorotateToInterfaceOrientation`，`supportedInterfaceOrientations`并`shouldAutorotate`以与上述相同的方式。当然，我使用子类导航控制器来显示应该具有旋转能力的控制器。我也尝试按类别覆盖导航控制器的方法，但它也不起作用。

我从一开始就没有在应用程序上工作，我继承了代码。如果有可能如何在全球范围内限制景观，那可能就是我的情况。对于测试，我使用 iPhone 6.0 模拟器，但我的部署目标是 5.0。我感谢任何提示/帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T12:50:58.210

iOS6 还要求您为窗口设置一个 rootViewController，而不是将控制器的视图添加为子视图。

如果你正在做这样的事情：

```
[window addSubview:someController.view]; 
```

那么您可以尝试将其更改为：

```
[window setRootViewController:someController]; 
```

也看看这个[链接](https://msmvps.com/blogs/kevinmcneish/archive/2012/10/12/handling-autorotation-in-ios-5-and-ios-6-supportedinterfaceorienations-and-shouldautorotate.aspx)。对于 ios6，Apple 引入了这两种方法：

```
supportedInter 
```

1.  面对方向：
2.  应该自转

希望能帮助到你。

舒迈斯·乌尔哈克

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T12:48:12.673

在你想要横向的控制器上试试这个

```
// override to allow orientations other than the default portrait orientation
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    // return YES for supported orientations
    return UIInterfaceOrientationIsLandscape(interfaceOrientation); // support only landscape
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T12:43:45.373

1.  转到目标窗口。
2.  单击摘要选项卡。
3.  iPhone/iPad 部署信息 -> 根据您的要求为 iPhone 和 iPad 设置支持的界面方向。有关更多参考，请参见下图。

![在此处输入图像描述](../Images/205739a9fe0c6da049991341176630a0.png)

# .htaccess - 重定向 301 Magento 不工作

> ID：14707811
> 
> 赞同：0
> 
> 时间：2013-02-05T12:40:32.023
> 
> 标签：.htaccess, magento, redirect

**注意：** stackoverflow 中已经存在相同的问题。我尝试了这些但仍然无法正常工作。

我的要求是，如果有人尝试使用 url 访问我们的网站

`http://oursite.com`

那么它应该重定向到

`http://www.oursite.com`

用于 SEO 目的。

我在 Magento 中遇到了 Redirect 301 的问题。我试着用

```
admin->System->Configuration->Web->Url Options->Auto-redirect to Base URL 
```

我已将其设置为**是（301 Moved Permanenty）**，但它仍然无法正常工作。我也尝试使用以下代码块编辑 .htaccess

```
Redirect 301 http://oursite.com http://www.outsite.com 
```

但它仍然无法正常工作。我不知道可能是什么原因。请有任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T14:06:22.020

假设在 admin -> System -> Configuration -> Web -> Unsecure

> 基本网址 =`http://www.oursite.com`

然后你重定向到基本网址应该可以工作

如果你想使用 .htaccess 然后尝试

```
RewriteCond %{HTTP_HOST} ^oursite\.com$ [NC]
RewriteRule ^(.*)$ http://www.oursite.com/$1 [R=301,L] 
```

# mysql - Mysql使用准备好的语句选择和插入

> ID：14707812
> 
> 赞同：1
> 
> 时间：2013-02-05T12:40:33.913
> 
> 标签：mysql, sql, select, insert

我的 mysql 查询工作正常

```
INSERT INTO donor_location (pc_id)
SELECT id
FROM pc
WHERE postcode= ? 
```

即从邮政编码表中获取邮政编码ID，然后将该ID 插入到donor_location 表中。我正在使用 mysqli 和准备好的语句

如果没有选择部分，它会很容易 - 比如

```
$stmt = $mysqli->prepare("INSERT INTO donor_charity(
id) values (?)") ; 
```

但是我完全不知道如何合并选择

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T13:01:18.847

您所做的几乎相同，只是更改了查询位。
要从charity_donor 中选择id 为25 的所有记录，您将执行以下查询：

```
SELECT *
FROM   donor_charity
WHERE  id = 25 
```

现在要查询这个，首先你必须准备它：

```
$stmt = $mysqli->prepare("
    SELECT *
    FROM   donor_charity
    WHERE  id = ?
"); 
```

现在要遍历结果，您必须绑定参数并执行查询。

```
$stmt->bind_param('d', 25 ); // First param means the type of the value you're 
                             passing. In this example, d for digit.
$stmt->execute(); 
```

然后你设置一个数组来保存从查询返回的数据，

```
$row = array();
stmt_bind_assoc($stmt, $row); 
```

现在循环返回的数据。

```
while ( $stmt->fetch () ) {
    print_r($row); // Should now contain the column.
} 
```

有关文档，请参阅：
准备：[http](http://www.php.net/manual/en/mysqli.prepare.php)
: //www.php.net/manual/en/mysqli.prepare.php 绑定参数：[http ://www.php.net/manual/en/mysqli-stmt.bind-param .php](http://www.php.net/manual/en/mysqli-stmt.bind-param.php)
执行：[http](http://www.php.net/manual/en/mysqli-stmt.execute.php)
://www.php.net/manual/en/mysqli-stmt.execute.php 获取：[http ://www.php.net/manual/en/mysqli-stmt.fetch.php](http://www.php.net/manual/en/mysqli-stmt.fetch.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T12:48:29.833

希望这篇文章有帮助，它是如此简单。 [http://www.java2s.com/Code/Java/Database-SQL-JDBC/InsertRecordsUsingPreparedStatement.htm](http://www.java2s.com/Code/Java/Database-SQL-JDBC/InsertRecordsUsingPreparedStatement.htm)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T13:08:33.477

您需要在 Prepare 语句之后使用 Bind_param。

```
$sql = "INSERT INTO donor_charity(
id) values (?)
       ";
/* create a prepared statement */
if (!$stmt = $db->prepare($sql)) {
    echo 'Database prepare error';
    exit;
}

 /* bind parameters for markers */
$stmt->bind_param('ssssss', $id);

$id = '123456';

 /* execute query */
$stmt->execute(); 
```

# c# - 为什么解析助手没有变得更容易使用？

> ID：14707814
> 
> 赞同：2
> 
> 时间：2013-02-05T12:40:50.243
> 
> 标签：c#, parsing, language-design, nullable, deprecated

鉴于 .NET 团队已经声明（我会找到一个来源......）他们对原始类型的解析方法（例如[`Int32.TryParse(String s, out Int32 result)`](http://msdn.microsoft.com/en-us/library/f02979c7.aspx)）的设计感到遗憾，为什么没有使用更明显和对客户端友好的变体来更新这些方法？

**框架版本：**

```
Int32? numValue;
Int32 placeHolder;
if (! Int32.TryParse("not a number", out placeHolder))
    numValue = 10; 
```

**改良版：**

```
var numValue = Int32.Parse("not a number", 10); 
```

改进的解析方法的签名是：

```
public static Int32? Parse(String s, Int32? defaultValue = null); 
```

它可能有一个幼稚的实现：

```
public static Int32? Parse(String s, Int32? defaultValue = null) {
    Int32 temp;
    return ! Int32.TryParse(s, out temp)
        ? defaultValue
        : temp;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T13:07:43.323

这个签名：

```
public static Int32? Parse(String s, Int32? defaultValue = null); 
```

会与现有的`Parse(string s)`重载冲突，因为如果未指定可选参数，则无法区分它们。现有方法可能永远不会更改或删除，因为它会破坏与现有代码的兼容性。

但是，可以创建`TryParse`不带`out int value`参数的重载：

```
public static int? TryParse(string s) 
```

请注意，您不需要为默认值添加参数：您可以改用 null 合并运算符。

```
string s = ...
int value = int.TryParse(s) ?? 0; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T13:19:56.483

我不确定是否会有明确的答案，除非 BCL 团队的某个人有故事要讲。

一些考虑可能是：

1.  更改方法将对现有代码库构成*重大*的重大更改，而收益很少（如果有的话，值得商榷）。有些人可能会争辩说，由于以下原因，这将是有害的。
2.  可空类型~~将~~包装的基础值封装起来，即使您希望解析成功并且无论如何都不想要可空类型，也会导致（次要）性能下降。
3.  如果您*知道*您的输入*应该*是有效的，那么该`Parse` 方法会在输入无效的*例外情况下抛出异常。*这通常更高效，因为我们没有额外的错误处理代码，当我们不需要它时，并且从设计的角度来看是预期的。如果您打算处理无效案件，那就是这样`TryParse`做的。
4.  `int Parse(string, int? defaultValue)`和之间的混淆`int Parse(string)`，主要是关于它们的错误处理。请注意，我已经删除了第一个方法的可选部分，否则同时拥有这两种方法是没有意义的（如果没有显式传递，您将永远无法调用您的方法`null`）。在这一点上，它会有点令人困惑，因为一个重载会在失败时引发异常，而另一个则不会。对此有一些例外，例如 [Type.GetType](http://msdn.microsoft.com/en-us/library/c5cf8k43.aspx) 但它们通常很少见，在这种情况下，它们使用*显式命名的参数*来指示*它将*或*不会*抛出异常。
5.  设计的另一个好处`TryParse`是，它通过 API 非常明确地处理通过/失败结果。它不是一个`null`指示失败的幻数/结果 ()，而是返回一个*单独*的真/假值。现在，*一些*机制会这样做（`String.IndexOf`例如返回-1），所以这是好事还是坏事还有待商榷。根据您的实践，使用返回`true/false`值可能会更容易，或者使用神奇的`null`结果可能会更容易。但是他们决定我猜不要用两种方法做完全相同的事情，但签名/返回值略有不同。
6.  *另一个考虑因素是可空*值类型的常见程度。你真的`Int32?`在很多地方使用吗？还是仅用于错误/输入处理？以我的经验，可为空的值*主要* 用于数据库 I/O（即便如此，也不经常使用）。唯一的其他时间可能是来自不可信来源的输入，这些输入仅用于初始接口；所有底层代码仍将针对 non-nullable 键入`Int32`。在这种情况下，您有两种方法，原始方法：

    ```
    int input;
    if (TryParse(someString, out input))
        DoSomethingValid(input); //valid! Do something
    else
        ErrorMessage()//not valid, error! 
    ```

    或者你的建议：

    ```
    int? input = Parse(someString)
    if (input != null)
        DoSomethingValid(input.GetValueOrDefault())//valid! Do something
    else
        ErrorMessage()//not valid, error! 
    ```

    请注意两者的*相似之处。*如果对这种情况有任何帮助，您的建议确实提供的很少。还要注意 的用法，如果您知道它是非空的 `GetValueOrDefault()`，这*实际上是*[访问包装值](http://ericlippert.com/2012/12/20/nullable-micro-optimizations-part-one/)的更快/更好的方法，但很少（至少从我在互联网上看到的）它在`Value` 访问器上使用。如果 BCL 按照您的建议添加/更改`Parse`方法，我认为*很多*人会不必要地点击`Value`访问器。

    我不能*特别*评论在整个应用程序设计和/或其层中显着使用可为空值的情况，但根据我的经验，它们很少使用或应该很少使用（对我来说，这几乎是“字符串”级别的代码气味类型的”数据）

最终，我相信添加扩展方法（除了 Linq）的*部分原因是允许用户根据需要滚动他们自己的 API。*在您的情况下，您可以*轻松*添加扩展方法来获得所需的语法：

```
public static Int32? Parse(this String s, Int32? defaultValue = null)
{
    Int32 temp;
    return !Int32.TryParse(s, out temp)
        ? defaultValue
        : temp;
}

string validString = "1";
int? parsed = validString.Parse(); //1
int? failParsed = "asdf".Parse(9); //9 
```

团队通常倾向于保持现状，并且添加必须提供足够显着的*好处*才能添加到系统中，并且团队还考虑 API 中已经存在哪些变通方法。我建议考虑到扩展方法选项，考虑到 API 的重大破坏性，更改 API 并不是什么大问题。

# android - 如何在Android中解析没有标题对象的JSON？

> ID：14707820
> 
> 赞同：0
> 
> 时间：2013-02-05T12:40:54.613
> 
> 标签：android, json, gson

我有一个 json 输出，它返回如下内容：

```
[
 {
  "title":"facebook",
  "description":"social networking website",
  "url":"http://www.facebook.com"
 },
 {
  "title":"WoW",
  "description":"game",
  "url":"http://us.battle.net/wow/"
 },
 {
  "title":"google",
  "description":"search engine",
  "url":"http://www.google.com"
 }
] 
```

我熟悉解析具有标题对象的 json，但我不知道如何解析上面的 json，因为它缺少标题对象。您能否为我提供一些提示/示例，以便我检查它们并解析上述代码？

注意：我在这里检查了一个类似的例子，但它没有一个令人满意的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T12:45:15.910

```
JSONArray jsonArr = new JSONArray(jsonResponse);

for(int i=0;i<jsonArr.length();i++){ 
JSONObject e = jsonArr.getJSONObject(i);
String title = e.getString("title");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T12:44:16.533

例如，使用[JSONObject.has(String name)](http://developer.android.com/reference/org/json/JSONObject.html#has%28java.lang.String%29)检查当前 json 中是否存在键名

```
 JSONArray jsonArray = new JSONArray("json String");
 for(int i = 0 ; i < jsonArray.length() ; i++) {
   JSONObject jsonobj = jsonArray.getJSONObject(i);
   String title ="";
   if(jsonobj.has("title")){ // check if title exist in JSONObject

     String title = jsonobj.getString("title");  // get title
   }
   else{
        title="default value here";
    }

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T17:31:15.867

您的 JSON 是一个对象数组。

围绕（和其他 JSON 序列化/反序列化）库的整个想法`Gson`是，您最终会得到自己的 POJO。

下面是如何创建一个 POJO 来表示包含在数组中的对象并`List`从该 JSON 中获取它们：

```
public class App 
{
    public static void main( String[] args ) 
    {
        String json = "[{\"title\":\"facebook\",\"description\":\"social networking website\"," +
            "\"url\":\"http://www.facebook.com\"},{\"title\":\"WoW\",\"description\":\"game\"," +
            "\"url\":\"http://us.battle.net/wow/\"},{\"title\":\"google\",\"description\":\"search engine\"," +
            "\"url\":\"http://www.google.com\"}]";

        // The next 3 lines are all that is required to parse your JSON 
        // into a List of your POJO
        Gson gson = new Gson();
        Type type = new TypeToken<List<WebsiteInfo>>(){}.getType();
        List<WebsiteInfo> list = gson.fromJson(json, type);

        // Show that you have the contents as expected.
        for (WebsiteInfo i : list)
        {
            System.out.println(i.title + " : " + i.description);
        }
    }
}

// Simple POJO just for demonstration. Normally
// these would be private with getters/setters 
class WebsiteInfo 
{
    String title;
    String description;
    String url;
} 
```

输出：

> facebook : 社交网站
> WoW : 游戏
> google : 搜索引擎

**编辑添加：**因为 JSON 是一个数组，所以`TypeToken`需要使用 来获取 a `List`，因为涉及到泛型。没有它，您实际上可以执行以下操作：

```
WebsiteInfo[] array = new Gson().fromJson(json, WebsiteInfo[].class); 
```

现在，您`WebsiteInfo`从一行代码中获得了一组对象。话虽如此，使用泛型`Collection`或`List`如演示的那样灵活得多，并且通常被推荐。

[您可以在Gson 用户指南](https://sites.google.com/site/gson/gson-user-guide#TOC-Collections-Examples)中阅读更多相关信息

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T12:44:46.360

```
JSONArray array = new JSONArray(yourJson);
for(int i = 0 ; i < array.lengh(); i++) {
JSONObject product = (JSONObject) array.get(i);
    .....
} 
```

# asp.net - 如何以编程方式构建带有表单和用户控件的 System.Web.UI.Page？

> ID：14707826
> 
> 赞同：2
> 
> 时间：2013-02-05T12:41:05.017
> 
> 标签：asp.net, webforms, asmx, ascx

我有这个代码：

```
public static string RenderView(string path)
{
    Page pageHolder = new Page();
    UserControl viewControl = (UserControl)pageHolder.LoadControl(path);

    pageHolder.Controls.Add(viewControl);

    StringWriter output = new StringWriter();
    HttpContext.Current.Server.Execute(pageHolder, output, false);

    return output.ToString();
} 
```

运行自：

```
 [WebMethod]
    public string GetReportsHTML()
    {
        string output = "";

        output = ViewManager.RenderView("ReportsControl.ascx");

        return output;
    } 
```

这是为了测试呈现 ASCX 文件并将它们从 SOAP/REST 服务中吐出。

问题是，如果某些控件（runat=server 的）没有封装在带有 runat=server 的标签中，它们就会失败。

解决方案在[这里](https://stackoverflow.com/questions/13777442/control-0-of-type-textbox-must-be-placed-inside-a-form-tag-with-runat-server/13777536#comment20569725_13777536)，但该解决方案假设在一个 ASPX 文件中，我可以在其中编辑标记。

我将如何以编程方式构建页面、添加表单、设置 runat=server 以便我可以遵循该解决方案并将我的控件添加到表单控件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T15:03:46.360

你有没有尝试过这样的事情？

```
public static string RenderView(string path)
{
    Page pageHolder = new Page();
    System.Web.UI.HtmlControls.HtmlForm formHolder = new System.Web.UI.HtmlControls.HtmlForm();
    pageHolder.Controls.Add(formHolder );

    UserControl viewControl = (UserControl)pageHolder.LoadControl(path);

    formHolder.Controls.Add(viewControl);

    StringWriter output = new StringWriter();
    HttpContext.Current.Server.Execute(pageHolder, output, false);

    return output.ToString();
} 
```

希望这会有所帮助

# iphone - 应用程序在背景图像加载 iphone 中崩溃

> ID：14707834
> 
> 赞同：0
> 
> 时间：2013-02-05T12:41:32.293
> 
> 标签：iphone, ios, uiimageview, uiimage, lazy-loading

我有 60 的滚动视图`UIImageView's`。这些图像视图中显示的图像来自 url 和我从 web 服务获得的 url。当用户滚动到底部时，我调用 web 服务并获取**新的 60 urls**。获得网址后，我使用相同的网址`UIImageView's`显示图像。以下是我显示图像的代码。

```
for (UIView *viewSel in [scrlView subviews]) {
    NSString *strImgUrl = [arrImgURL valueForKey:@"url"];
    if ([viewSel isKindOfClass:[UIImageView class]]) {

            UIImageView *imgView = (UIImageView *)viewSel;

            [imgView setImage:[UIImage imageNamed:@"loading432x520.png"]];

            NSMutableArray *arr = [[NSMutableArray alloc] init];

            [arr addObject:[NSString stringWithFormat:@"%@",strImgUrl]];

            [arr addObject:imgView];
            [self performSelectorInBackground:@selector(loadImageInBackground:) withObject:arr];

            [arr release];
    }
}

- (void) loadImageInBackground:(NSMutableArray *)arr  {

    NSLog(@"loadImage");
    NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];
    NSData *imgData = [NSData dataWithContentsOfURL:[NSURL URLWithString:[arr objectAtIndex:0]]];
    UIImage *img    = [[UIImage alloc] initWithData:imgData];
    if (img != nil) {
        [arr addObject:img];
    }
    else{
        [arr addObject:[UIImage imageNamed:@"no-image432x520.png"]];
    }
    [img release];
    [self performSelectorOnMainThread:@selector(assignImageToImageView:) withObject:arr waitUntilDone:YES];
    [pool release];
}
- (void) assignImageToImageView:(NSMutableArray *)arr{
    NSLog(@"assignImage");
    UIImageView *imgView = [arr objectAtIndex:1];
    imgView.image = [arr objectAtIndex:2];
} 
```

该代码第一次完美运行。但是当我得到新的网址时，它正在工作一段时间或崩溃。我不知道为什么它会崩溃。我想阻止那场崩溃。如果您没有回答我的问题，请告诉我。请帮助我。提前致谢。有效的答案将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T05:43:10.120

感谢大家对我的问题给予充分的帮助。我得到了错误。在将内存分配给 uiimageview 时，我将 CALayer 添加到 uiimageview。我删除了那个 CALayer 代码，它工作得很好。Nikita 的评论帮助我找到我的错误。

# wcf - 从 NSIS 调用 .net dll

> ID：14707835
> 
> 赞同：1
> 
> 时间：2013-02-05T12:41:36.967
> 
> 标签：wcf, nsis

我想在继续安装 NSIS 之前验证用户名和密码。

当我单击下一步按钮时，我想检查用户是否有权安装应用程序。对于此检查，我想从我的 .NET 应用程序进行 WCF 调用。它将返回真或假。

基于此，我将继续或中止我的安装。我尝试使用`CLR::Call /NOUNLOAD`插件。由于我指的是服务引用，因此它引发了异常：

`Error calling .net dll method`

这是我到目前为止的 NSIS 脚本：

```
Name "Test CLRDLL MakeLogEntry" 
OutFile "TestCLRDLL.exe"
Page instfiles

Section 
    start InitPluginsDir 
    SetOutPath $PLUGINSDIR 
    File "MyDll.dll" 
    CLR::Call /NOUNLOAD "MyDll.dll" "namespace.classname" \ "ValidateLogin" 3 "Myserviceaddress/Servicename.svc"; "username" "password" 
    pop $0 
    MessageBox MB_OK $0 
sectionEnd 

Function .onGUIEnd 
    CLR::Destroy 
FunctionEnd 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T16:55:10.413

您还应该知道，CLR::Call 插件仅适用于 .Net 2.0 程序集（不是更高版本）。所以也许你应该重新编译你的dll。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T22:20:23.810

你不能做这个。

CLR::Call 插件[仅支持 .Net 2.0 程序集](http://nsis.sourceforge.net/Call_.NET_DLL_methods_plug-in#Prerequisites)。

[WCF 是在 .NET 3.0 中引入的](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/e85d3167-1e22-4962-b091-ad0a82b36026/)。

# c# - linq获取所有实现接口的对象

> ID：14707837
> 
> 赞同：2
> 
> 时间：2013-02-05T12:41:41.230
> 
> 标签：c#, linq, c#-4.0

是否有可能得到这样的东西：

```
return Session.Query<A>().Where(x => x is B).ToList(); 
```

其中 B 派生自 A 为接口工作（即获取实现某个接口的所有对象）？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T12:49:26.087

您不能直接将此语句转换为 SQL。首先，您必须评估查询或使用`AsEnumerable()`.

```
return Session.Query<A>().AsEnumerable().Where(x => x is B).ToList(); 
```

或者：

```
return Session.Query<A>().AsEnumerable().OfType<B>().ToList(); 
```

之后的部分`AsEnumerable`将在内存中执行。

# mysql - SQL 错误 (1111)：组函数的使用无效

> ID：14707840
> 
> 赞同：0
> 
> 时间：2013-02-05T12:41:50.303
> 
> 标签：mysql

我正在尝试在（entrydate 列中的最大日期）和（entrydate 列中的最大日期-15 天）之间获取数据！！

表1：共有953行 ![在此处输入图像描述](../Images/cf27c961938da57f82dd6ac133801692.png)

表 2：总共有 400 行 ![在此处输入图像描述](../Images/3bcf8d8c6c522a75402b03091b238790.png)

我得到了这个错误，请帮助我！

```
 Select  
o_material_transaction_inward.Mat_Code,
s_material_details.Mat_Spec,
s_material_details.Mat_Make,
o_material_transaction_inward.Sup_Name,
o_material_transaction_inward.Entry_Date,
o_material_transaction_inward.DC_qty,
o_material_transaction_inward.Received_qty,
    from 
o_material_transaction_inward 
    join 
s_material_details 
    on 
s_material_details.Mat_Code=o_material_transaction_inward.Mat_Code and s_material_details.Mat_Group_Id=o_material_transaction_inward.Mat_Group_id
    where 
o_material_transaction_inward.Entry_Date between Max(o_material_transaction_inward.Entry_Date) and Max(o_material_transaction_inward.Entry_Date - 15) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T12:46:06.050

**更新：**固定`BETWEEN`谓词：

它不起作用的原因是最低值必须是`BETWEEN`谓词中的第一个值，因此为了从两个表中获取这些行，它们`entry_date`的最大输入日期介于 - 15 和最大输入日期之间，请尝试以下操作：

```
SELECT
  o.Mat_Code,
  s.Mat_Spec,
  s.Mat_Make,
  o.Sup_Name,
  DATE_FORMAT(o.Entry_Date, '%Y-%m-%d') AS Entry_Date,
  o.DC_qty,
  o.Received_qty
FROM o_material_transaction_inward AS o
INNER JOIN s_material_details      AS s  ON s.Mat_Code     = o.Mat_Code
WHERE o.Entry_Date BETWEEN ((SELECT Max(Entry_Date) 
                            FROM o_material_transaction_inward) - 15)
                       AND (SELECT Max(Entry_Date) 
                            FROM o_material_transaction_inward) ; 
```

[**SQL 小提琴演示**](http://www.sqlfiddle.com/#!2/e9615/10)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T12:58:39.713

这应该有效：

```
SELECT
  o.Mat_Code,
  s.Mat_Spec,
  s.Mat_Make,
  o.Sup_Name,
  o.Entry_Date,
  o.DC_qty,
  o.Received_qty,
FROM o_material_transaction_inward AS o
INNER JOIN s_material_details      AS s  ON s.Mat_Code     = o.Mat_Code
                                        AND s.Mat_Group_Id = o.Mat_Group_id
WHERE o.Entry_Date BETWEEN (SELECT Max(Entry_Date) 
                            FROM o_material_transaction_inward) 
                       AND (SELECT Max(Entry_Date) 
                            FROM o_material_transaction_inward) - 15); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T12:48:54.107

尝试：

```
 Select  
o_material_transaction_inward.Mat_Code,
s_material_details.Mat_Spec,
s_material_details.Mat_Make,
o_material_transaction_inward.Sup_Name,
o_material_transaction_inward.Entry_Date,
o_material_transaction_inward.DC_qty,
o_material_transaction_inward.Received_qty,
    from 
o_material_transaction_inward 
    join 
s_material_details 
    on 
s_material_details.Mat_Code=o_material_transaction_inward.Mat_Code and s_material_details.Mat_Group_Id=o_material_transaction_inward.Mat_Group_id
    having 
o_material_transaction_inward.Entry_Date between Max(o_material_transaction_inward.Entry_Date) and Max(o_material_transaction_inward.Entry_Date - 15) 
```

（参见[MySQL 的公认答案：Invalid use of group function](https://stackoverflow.com/questions/2330840/mysql-invalid-use-of-group-function)来解释`where`vs `having`）

# sql - 在数据库中存储数据库引用

> ID：14707843
> 
> 赞同：0
> 
> 时间：2013-02-05T12:42:02.913
> 
> 标签：sql, database, linux, postgresql, debian

我希望能够从数据库中而不是我的应用程序中使用单个值（即其名称）来标记数据库，因为它始终是每个数据库的一个 ID。例如，像这样：

**DATABASE_A.sql**

```
-- Database Name Table
CREATE TABLE database (
    name VARCHAR(10) NOT NULL UNIQUE,
);

CREATE TABLE item (
    id SERIAL PRIMARY KEY,
    name VARCHAR(10) NOT NULL UNIQUE,
);

Insert Into database (name) values ('A'); 
```

**DATABASE_B.sql**

```
-- Database Name Table
CREATE TABLE database (
    name VARCHAR(10) NOT NULL UNIQUE,
);

CREATE TABLE item (
    id SERIAL PRIMARY KEY,
    name VARCHAR(10) NOT NULL UNIQUE,
);

Insert Into database (name) values ('B'); 
```

这是因为当它们组合并存储在 SOLR 搜索服务器上时，它们的 ID 是它们的数据库名称和它们的项目 ID 的组合，例如：

**SOLR 项目 ID**

```
A1
A2
A3
B1 
```

是否可以有一个表来定义前缀，以便当我从我的 SQL 网站查找 SOLR 时，我可以执行以下查询：

```
database (name) + item (id) = SolrID 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T12:59:41.373

我更倾向于在每个包含数据库 ID 的数据库中构建一个过程，例如：

```
CREATE OR REPLACE FUNCTION solrid(IN local_id INTEGER, OUT result TEXT) AS $$
DECLARE
  database_id TEXT := 'A';
BEGIN
  result := database_id || local_id::TEXT;
END;
$$ LANGUAGE PLPGSQL; 
```

然后你可以写你的选择语句，如：

```
SELECT solrid(id), name FROM item; 
```

这似乎是一个更清洁的解决方案。

# sqlite - Windows 商店应用程序中的 Sqlite 数据库限制

> ID：14707847
> 
> 赞同：1
> 
> 时间：2013-02-05T12:42:15.343
> 
> 标签：sqlite, visual-studio-2012, windows-runtime, windows-store-apps

我对 Sq lite 有一些问题。我读了[一篇微软文章](http://code.msdn.microsoft.com/windowsapps/Using-SQLite-in-a-Windows-c16aea77#content)

在该站点中，它提到“**当您在 Visual Studio 中创建新的 C# 或 VB Windows Store 项目时，它默认支持所有架构（x86、x64 和 ARM）。但由于您将 Sq Lite 添加到项目中，您可以” t 构建一个面向所有架构的包。您必须为每个架构构建一个目标。选择 Build|Configuration Manager 并从 Platform 下拉列表中选择 x86、x64 或 ARM。** "

我的应用程序是使用 C# 为 windows 平板电脑开发的报纸应用程序。我可以为所有处理器构建吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T13:16:39.687

是的，你可以，唯一的缺点是你必须编译你的应用程序三个不同的时间，以支持 ARM、X86 和 X&4 架构。

如果您使用不同的架构配置配置管理器，这可以轻松完成；）

检查此链接[如何：创建和编辑配置](http://msdn.microsoft.com/en-us/library/kwybya3w%28v=vs.80%29.aspx)

# silverlight - XAP 中缺少引用的程序集

> ID：14707852
> 
> 赞同：1
> 
> 时间：2013-02-05T12:42:28.660
> 
> 标签：silverlight, silverlight-4.0

我有一个 Silverlight 应用程序。我已经定义了资源程序集。我在我的应用程序中提到了同样的内容。在运行时，我收到找不到资源程序集的异常。我解压缩了 xap，发现 XAP 中缺少程序集。我不确定为什么？请帮我。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T12:45:18.950

您必须检查您的资源是否“嵌入”不仅被引用，而且在 Visual Studio 的属性窗口中进行检查

# perl - 在 perl 中使用正则表达式在两个字符串之间搜索字符串

> ID：14707853
> 
> 赞同：4
> 
> 时间：2013-02-05T12:42:37.553
> 
> 标签：perl

我想在文件中多次检索落在两个指定字符串之间的字符串

我试过这个，但这不起作用

```
/(?m)"String 1"!.*?"String2":/; 
```

> 我想要所有介于“String 1”和“String 2”之间的东西

请帮忙

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-05T12:56:10.363

假设您的输入字符串是这样的

```
$str='String 1GIANT FISHString 2' 
```

这会起作用

```
($wanted)= $str =~ /String 1(.*)String 2/ 
```

`$wanted`现在是“巨鱼”

dah..文件中的多行...编辑即将到来

好的多行，假设输入

```
String 1Line oneString 2
String 1GIANT FISHString 2
String 1String2 
```

这将得到所有的字符串

```
(@wanted)= $str =~ /String 1(.*)String 2/g 
```

@wanted 有三个条目

```
('Line one','GIANT FISH','') 
```

在第二个正则表达式中，g for global 查找字符串中的所有匹配项

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T13:40:34.957

下面会做：

```
perl -lne 'push @a,/string(.*?)string/g;END{print "@a"}' 
```

这两个字符串是*字符串*和*字符串*，它们之间的任何内容都将作为数组元素进行存储。下面是我为此目的测试过的示例。无论如何，您可以将两个字符串更改为您需要的任何字符串。

测试：

```
> cat temp
string123stringstring234string
string456stringstring789string

> perl -lne 'push @a,/string(.*?)string/g;END{print "@a"}' temp
123 234 456 789 
```

# mysql - 在 MySQL 中存储数据

> ID：14707857
> 
> 赞同：0
> 
> 时间：2013-02-05T12:42:49.207
> 
> 标签：mysql, syntax-error, special-characters, storing-data

我想在 mysql 数据库中存储一些值，例如**“st paul's school” 。**但是由于特殊符号 **'** 我无法在 mysql 中存储这些值。我尝试了 varchar 数据类型，但它不起作用。请建议一种合适的方法或数据类型将**'**存储在 mysql 中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T12:44:07.080

添加两个像这样的单引号 '' 或像这样转义它 \'

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T12:43:52.637

如果您直接在 MySQL 服务器上执行此操作，*请将单引号加倍*，它将起作用。例子

```
INSERT INTO tableName VALUES ('St. Paul''s School') 
```

但在前端，为此使用*PreparedStatements*。

如果你正在使用`PHP`，使用`PDO`或`MySQLI`扩展就可以避免`SQL Injection`。请看下面的文章，

*   [如何*防止*PHP 中的 SQL 注入？](https://stackoverflow.com/questions/60174/how-to-prevent-sql-injection-in-php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T12:46:33.223

如果你有这个撇号使用的变量`htmlentities`

```
 $your_var = "St. Paul's School";
 $your_var = htmlentities($your_var);
 INSERT INTO tableName VALUES ('$your_var') 
```

如果你只有字符串，你可以做这样的双引号

```
 INSERT INTO tableName VALUES ("St. Paul's School") 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T12:52:05.290

只需将引号符号替换为其实体即可。如果您使用的是**php**

```
<?php
    $str = "st paul's school";
    $str = str_replace("\'","&acute;",$str);
    $str = str_replace("\"","&quot;",$str);
?> 
```

你也可以使用

```
$str= htmlentities($str,ENT_QUOTES, 'UTF-8'); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-05T12:54:49.370

您可以使用 mysqli_real_escape_string($text) 来转义您插入数据库的文本中的那些 '。

# c++ - Boost协程断言失败

> ID：14707860
> 
> 赞同：6
> 
> 时间：2013-02-05T12:43:16.683
> 
> 标签：c++, boost, boost-coroutine

为了在 boost 中尝试新的协程功能，我创建了以下程序：

```
#include <boost/coroutine/all.hpp>
#include <string>
#include <vector>

typedef boost::coroutines::coroutine<int(char)> coroutine_t;

void f(coroutine_t::caller_type & ca)
{
    std::vector<int> vec = {1, 2, 3};
    for (int i : vec)
    {
        char c = ca.get();
        std::cout << "c: " << c << std::endl;
        ca(i);
    }
}

int main()
{
    coroutine_t cr(f);
    std::string str("abc");
    for (char c : str)
    {
        std::cout << c << std::flush;
        cr(c);
        int n = cr.get();
        std::cout << n << std::endl;        
    }
} 
```

该代码基于[docs 中的示例代码](http://www.boost.org/doc/libs/1_53_0/libs/coroutine/doc/html/coroutine/coroutine.html)。

我的构建命令如下：

```
$ g++ -std=c++11 -o test -I/usr/local/include -L/usr/local/lib main.cpp /usr/local/lib/libboost_context.a 
```

输出：

```
$ ./test
test: /usr/local/include/boost/coroutine/detail/coroutine_get.hpp:43: typename boost::coroutines::detail::param<Result>::type boost::coroutines::detail::coroutine_get<D, Result, arity>::get() const [with D = boost::coroutines::coroutine<char(int), 1>; Result = char; int arity = 1; typename boost::coroutines::detail::param<Result>::type = char]: Assertion `static_cast< D const* >( this)->impl_->result_' failed.
Aborted (core dumped) 
```

由于断言失败，程序被中止。你能帮我找出我的代码中的错误吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T15:12:15.020

我相信您需要`ca()`在函数的开头添加一个调用`f`。

从升压文档：

> 执行控制在构造时转移到协程（进入协程函数） - 当控制应该返回到原始调用例程时，在 boost 类型的第一个参数上调用 boost::coroutines::coroutine<>::operator()： :coroutines::coroutine<>::caller_type 在协程函数中。

# java - 在现有代码上实现线程

> ID：14707861
> 
> 赞同：0
> 
> 时间：2013-02-05T12:43:21.743
> 
> 标签：java, multithreading, concurrency, java-6, concurrent-programming

我不是一个彻底的 JAVA 专业人士，但有编程经验，但没有线程。我有一个当前执行以下操作的应用程序代码。

1.  与数据库建立连接
2.  将数据库中的记录拉到一个集合中（每条记录都有一个“操作代码”1-5，除了其他东西
3.  每条记录都被一个一个地挑选出来，并根据每个动作代码，从一个类 EVENTHANDLER.class 中调用一些特定的方法（每个动作代码一个）
4.  这些单独的方法还使用/共享 EVENTHANDLER.class 和其他一些类中的一些其他方法，用于一些常见的功能
5.  最后更新 db_sequence
6.  处理完所有记录

现在，我有一个要求，现在有点模糊，但它希望在上面引入线程，主要是为了提高性能。除了将某些特定操作代码的某些记录的过程优先于其他记录之外。例如 - 操作代码为 -2 的记录的优先级应高于 1，然后是 3，然后是 4。

我的问题是如何首先采用实现这一点的方法。其次，这是在 JAVA 1.6 中完成的，所以我应该使用哪些类。此外，任何方向代码（示例代码）或基于上面的功能流程都会非常有帮助。

一个非常直接的问题是 - 对于上述操作代码 (1-5)，我应该有五个线程同时运行，还是应该为每条记录设置一个线程（可能有数百个），而不管操作代码如何？

已经谢谢了

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T12:47:37.877

如果我是你或要求你这样做的人，我会很担心。

你有数字来显示现有应用程序的性能吗？如果是，它们是否超过了预期性能的目标？在我拥有两者之前，我不会对线程做出判断。

线程是一个很容易出错的高级主题，即使您有经验。

在我看来，数据库部分可以是单线程。处理程序可能会长时间运行，因此我会使用 Executor 和 Java 并发包中的新结构来运行这些处理程序。在任何情况下都不应使用原始线程执行此操作。

听起来你需要帮助。我会找到比您更了解 Java 的人来咨询。

# eclipse - 在 Eclipse JDT 中使用 ${word_selection}

> ID：14707886
> 
> 赞同：2
> 
> 时间：2013-02-05T12:44:54.707
> 
> 标签：eclipse, templates

如何在我的 Java 模板中使用 ${word_selection} ？我已经插入它，但我无法让它工作。

我在使用之前复制粘贴了一个单词，但所选单词没有出现在模板的结果中。

我做错了什么？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T13:19:58.097

我认为它的工作方式`${word_selection}`是在您的编辑器中被选定的单词替换。

我刚刚在这里发布了一个类似问题的答案：[Eclipse: “Simple” Template Problem with ${word_selection}](https://stackoverflow.com/a/15949395/1592796)

也许这对你有帮助。

# multithreading - 如何在生产者队列消费者模式中获得结果

> ID：14707887
> 
> 赞同：0
> 
> 时间：2013-02-05T12:44:55.597
> 
> 标签：multithreading, producer-consumer

我非常使用（多）生产者-队列-消费者设计模式，但我不知道如何获得操作的结果。

我有 3 个生产者 P1、P2、P3，它们产生一条消息 IMessage；此消息在同步队列中发送，并由 Cosumer 进行详细说明。

消费者 C 如何告诉生产者（P1 或 P2 或 P3）请求已完成并给出结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T16:24:57.890

一种异步方式是让消费者在完成后将消息排队返回其生产者。该消息可以包含结果成员，（和/或在消息处理期间可能已引发的任何异常对象或错误消息）。另一种可能性是生产者只是等待一些也与消息一起排队的同步对象。完成后，消费者会发出信号。这两种方案都可以由生产者使用“OnCompletion(Message *thisMessage)”函数/事件/委托加载消息来支持，消费者在处理消息时调用该函数/事件/委托。

# java - 正则表达式 / String.split 未按预期工作

> ID：14707889
> 
> 赞同：1
> 
> 时间：2013-02-05T12:44:59.913
> 
> 标签：java, android, regex

我正在以这种格式接收数据，这三行中的每一行都是它自己的字符串：

```
 0 -rw-------    1       167 Tue Nov 13 10:39:28 2012 .bash_history
   0 -rw-r--r--    1        40 Wed Nov 28 12:18:03 2012 aaa.txt
22290 -rw-r--r--    1  22824944 Tue Jan 15 15:05:58 2013 a.bin 
```

我尝试使用此正则表达式将其拆分为由空格分隔的标记。

```
String[] tokens = newParts[i].split("\\s{1,}"); 
```

但是，这始终将第一个标记创建为前两行的空字符串，并将 22290 正确设置为第三行的第一个标记。为什么是这样？所有其余的令牌都是我想要的。只是不是前两行中的第一行，为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T12:52:35.253

在拆分字符串之前，您可以 .trim() 删除前导和尾随空格。这应该可以防止不需要的额外令牌。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T12:54:18.190

引用[`Pattern.split`文档](http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html#split%28java.lang.CharSequence,%20int%29)：

> 此方法返回的数组包含输入序列的每个子字符串，这些子字符串由与此模式匹配的另一个子序列终止或在输入序列的末尾终止。

因此，如果您的字符串以分隔符开头，则您的第一个元素将是一个空字符串。同样，如果您的字符串以分隔符结尾，您的最后一个元素将是一个空字符串。

**编辑：**实际`split(string)`调用`split(string, 0)`，它明确丢弃尾随的空元素。但它对空的起始元素没有任何作用。

如果您`trim()`先调用输入，它应该可以按预期工作。

# iphone - 无法隐藏创建的 UIButton

> ID：14707893
> 
> 赞同：0
> 
> 时间：2013-02-05T12:45:18.653
> 
> 标签：iphone, xcode, uibutton, nsmutablearray

我有三个 UIButtons，它们使用以下命令以随机顺序显示：

```
NSMutableArray *indexArray = [NSMutableArray arrayWithObjects:
                              [NSValue valueWithCGRect:CGRectMake(20, 187, 280, 44)],
                              [NSValue valueWithCGRect:CGRectMake(20, 258, 280, 44)],
                              [NSValue valueWithCGRect:CGRectMake(20, 330, 280, 44)], nil];

//Randomize the array
NSUInteger count = [indexArray count];
for (NSUInteger i = 0; i < count; ++i) {
    int nElements = count - i;
    int n = (arc4random() % nElements) + i;
    [indexArray exchangeObjectAtIndex:i withObjectAtIndex:n];
}

//Assign the frames
button1.frame = [((NSValue *)[indexArray objectAtIndex:0]) CGRectValue];
button2.frame = [((NSValue *)[indexArray objectAtIndex:1]) CGRectValue];
button3.frame = [((NSValue *)[indexArray objectAtIndex:2]) CGRectValue]; 
```

出于某种原因，我无法在显示多个项目后隐藏这些按钮。例如，我尝试过

button1.hidden = YES；还有 [self.button1.hidden = YES];

有任何想法吗？非常感激任何的帮助。

杰米

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T13:14:56.693

将标签传递给按钮并使用以下代码

```
 for (UIButton *btn in [self.view subviews]) 
    {
        if (btn.tag==1)
        {
            [btn removeFromSuperview];
        }
   } 
```

你的问题将得到解决并恢复我..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T12:53:01.820

这些按钮是IBOUTLET？

你可以想办法隐藏

比如，'[UIView viewWithTag:(NSInteger)]

示例代码在这里

```
UIButton *tmpBtn = (UIButton *)[self.view viewWithTag:1]; // tag is your choice
tmpBtn.hidden = YES 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T14:24:48.223

> 为此，我使用这个：
> 
> ```
>  if ([questions count]== 11)
>    { button1.hidden = YES; button2.hidden = YES; button3.hidden = YES } 
> ```

我建议你检查两件事：

1.  你有效地采取了分支；

2.  你的`button*`变量不是`nil`。

例如：

```
 if ([questions count]== 11)
 {
    NSLog(@"Enter branch with %x, %x, %x", button1, button2, button3);
    button1.hidden = YES; button2.hidden = YES; button3.hidden = YES;
 } 
```

（忽略您将在 NSLog 上收到的警告）。

# objective-c - 具有可拖动的 NSTabViewItem

> ID：14707898
> 
> 赞同：1
> 
> 时间：2013-02-05T12:45:36.713
> 
> 标签：objective-c, cocoa, nstableview, nsview

是否可以提供可拖动的 NSTabViewItem，
基本上是我想要的，如果我在 NSTabViewITem 的标签上按下 L 按钮并移动，我应该允许拖动 TabView 项目，我想为 NSTabView 项目的移动做这件事并拥有更多功能，如果用户拖动 NSTabView 项目的标签并将其移动到特定区域，那么我应该允许删除该 NSTabView 项目，

我只能找到一种拥有 PSMTab 栏的方法，但我在 NSTabView 项目上还有其他功能，如果我采用这种方法，我将丢失这些功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T12:03:52.770

感谢您调查它，不知何故我可以做到......发布一些重要的代码......

1 -- 必须有自定义 TabView 类来处理鼠标事件。

// 接口贴在下面，

```
#import <Cocoa/Cocoa.h>

typedef enum __itemDragState{
    itemNotDragging = 0,
    itemDragStatNormal = 0,
    itemDragging    = 1,
    itemDropped     = 2
} ItemDragStat;

@protocol CustomTabViewDelegate <NSObject>

@required
-(bool)allowDrag;
-(bool)allowDrop;
-(void)dragEnter;
-(void)acceptDrop;
-(void)draggingCancelled;
-(void)itemDropped:(id)draggedTabViewItem;
-(void)itemDroppedCompleted:(id)droppedTabViewItem;
@end

@interface CustomTab : NSTabView{
    ItemDragStat eItemDragStat; 
    id draggedItem;
}

@property(assign)id draggedItem;
@end 
```

现在一些重要的实现

```
#import "CustomTab.h"
#include "Log.h"

@implementation CustomTab

@synthesize draggedItem;

- (id)initWithFrame:(NSRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        // Initialization code here.
    }

    return self;
}

# if 0
// don't delete it, might need later on
- (void)drawRect:(NSRect)dirtyRect
{
    // Drawing code here.
}
# endif
- (void)mouseUp:(NSEvent *)theEvent{
    log(" Mouse up ");

    NSPoint location = [self convertPoint: [theEvent locationInWindow]
                                 fromView: nil];

    NSTabViewItem *anItem = [self tabViewItemAtPoint: location];

    if ( anItem == nil ) {
        // if its mouse up else where, reject dragging regardless
        eItemDragStat = itemDragStatNormal;
        log("Item will not be dropped");
        return;
    }

    if ( ![anItem isEqual:[self selectedTabViewItem]]){
        log("Mouse up is in nonselected item");

        if ( eItemDragStat == itemDragging){
            log("Item will be dropped into this ");

            id droppedTabViewItem = anItem;

            if ( droppedTabViewItem && [droppedTabViewItem respondsToSelector:@selector(itemDropped:)]){

                id selectedTabViewItem = [self selectedTabViewItem];

                [droppedTabViewItem performSelector:@selector(itemDropped:) withObject:selectedTabViewItem];

            }
        }
    }
    eItemDragStat = itemDragStatNormal;
    //   return;

    //    [super mouseUp:theEvent];
}
- (void)mouseDown:(NSEvent *)theEvent{

    NSPoint location = [self convertPoint: [theEvent locationInWindow]
                                 fromView: nil];

    draggedItem = [self tabViewItemAtPoint:location];

    NSTabViewItem *anItem = [self tabViewItemAtPoint: location];

    if (anItem != nil  &&  ![anItem isEqual: [self selectedTabViewItem]])
    {
        [self selectTabViewItem: anItem];
    }

}

- (void)mouseDragged:(NSEvent *)theEvent{

    NSPoint location = [self convertPoint: [theEvent locationInWindow]
                                 fromView: nil];

    id tabViewItemId = [self tabViewItemAtPoint:location];

    NSTabViewItem *anItem = [self tabViewItemAtPoint: location];

    if (anItem){
        if (![anItem isEqual:draggedItem]){

            if (tabViewItemId && [tabViewItemId respondsToSelector:@selector(allowDrag)]){
                eItemDragStat = itemDragging;

            }else{
                // drag will be cancelled now.
                // tell client item to stop dragging
                if (eItemDragStat == itemDragging){
                    if ( draggedItem && [ draggedItem respondsToSelector:@selector(draggingCancelled)]){

                        [draggedItem performSelector:@selector(draggingCancelled)];
                        draggedItem = nil;
                    }
                    }
                eItemDragStat = itemNotDragging;
                // if we have +cursor then it should be reset
            }

        }else{
           log(" Mouse dragged");
        }
    }else{
        // dragging went elsewhere, lets close this dragging operation
        if ( draggedItem && [ draggedItem respondsToSelector:@selector(draggingCancelled)]){

            [draggedItem performSelector:@selector(draggingCancelled)];
            draggedItem = nil;
        }
        // here reset the mouse pointer
         eItemDragStat = itemNotDragging;

    }
}

@end 
```

它需要一些更精细的调整，并且还在继续......

# xcode - XCode 强制触摸

> ID：14707899
> 
> 赞同：0
> 
> 时间：2013-02-05T12:45:42.620
> 
> 标签：xcode, touch

每次点击构建按钮时，如何强制 Xcode（4.5.x）强制“触摸”文件（foo.m）。

我希望每次都编译该文件，即使没有任何改变（它包含一个**DATE** & **TIME**宏，以防你好奇）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T14:30:44.053

这是一个糟糕的解决方案。最好运行一个构建脚本，该脚本将生成一个包含当前日期和时间的源文件。然后，您可以编译此生成的源文件并将其与最终二进制文件链接。

这也将使管理变得更容易，即使没有发生功能更改`git`，也不会被视为更改。`foo.m`

# c# - BinaryReader 根据 BufferSize 读取不同长度的数据

> ID：14707902
> 
> 赞同：0
> 
> 时间：2013-02-05T12:45:52.067
> 
> 标签：c#, httpwebrequest, binaryreader

问题如下，我正在使用 an`HttpWebRequest`从 [dmo.gov.uk](http://www.dmo.gov.uk/xmlData.aspx?rptCode=D3B.2)请求一些在线数据。我正在使用 a 阅读`BinaryReader`并写入 a的响应`MemoryStream`。我已经将正在使用的代码打包成一个简单的测试方法：

```
public static byte[] Test(int bufferSize)
{
    var request = (HttpWebRequest)WebRequest.Create("http://www.dmo.gov.uk/xmlData.aspx?rptCode=D3B.2");
    request.Method = "GET";
    request.Credentials = CredentialCache.DefaultCredentials;

    var buffer = new byte[bufferSize];
    using (var httpResponse = (HttpWebResponse)request.GetResponse())
    {
        using (var ms = new MemoryStream())
        {
            using (var reader = new BinaryReader(httpResponse.GetResponseStream()))
            {
                int bytesRead;
                while ((bytesRead = reader.Read(buffer, 0, bufferSize)) > 0)
                {
                    ms.Write(buffer, 0, bytesRead);
                }
            }
            return ms.GetBuffer();
        }
    }
} 
```

我的实际代码通常使用 2048 字节的缓冲区大小，但是我今天注意到该文件末尾有大量空字节 ( `\0`)，这会使文件大小膨胀。作为测试，我尝试将缓冲区大小增加到接近我预期的文件大小（我期待〜80Kb，所以缓冲区大小为79000），现在我得到了正确的文件大小。但我很困惑，无论用于读取数据的缓冲区大小如何，我都希望获得相同的文件大小。

以下测试：

```
Console.WriteLine(Test(2048).Length);
Console.WriteLine(Test(79000).Length);
Console.ReadLine(); 
```

产生以下输出：

```
131072
81341 
```

第二个数字，使用高缓冲区大小是我期望的确切文件大小（这个文件每天都在变化，所以预计在今天之后该大小会有所不同）。第一个数字包含`\0`预期文件大小之后的所有内容。

这里发生了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T12:52:10.420

您应该更改`ms.GetBuffer();`为`ms.ToArray();`.

`GetBuffer`将返回整个`MemoryStream`缓冲区，同时`ToArray`将返回`MemoryStream`.

# php - HTML、CSS 和 PHP 跨浏览器样式

> ID：14707903
> 
> 赞同：0
> 
> 时间：2013-02-05T12:45:54.987
> 
> 标签：php, html, css, html-table

我是一名自学成才的程序员，通常我可以自己解决问题，但这是一个固执的问题。我正在为我的朋友重新设计一个网站，并且我已经成功地编写了他网站的移动版本，但事实证明桌面版本很困难。

该网站是一个家庭酒吧的数据库，跟踪；饮酒者、射击、单位和标签。索引页面是一个排行榜，上面有饮酒者和最后的饮品。我的问题是将饮酒者排名定位在排行榜上以跨多个网络浏览器工作。

它看起来像这样：（截图）

[http://giblets-grave.co.uk/previews/1400x900_GG-desktop_design_final.jpg](http://giblets-grave.co.uk/previews/1400x900_GG-desktop_design_final.jpg)

如果交替背景使回显结果更容易，我愿意放弃它。

我尝试过使用表格、div、ul/li's .. 我使用的示例：

```
<table cellpadding="0" cellspacing="0">
<col width="85px" />
<col width="65px" />
<col width="65px" />
   <tr>
      <th colspan="3" align="left">Chris Clarkson</th>
   </tr>
   <tr>
      <td>
         <div class="crop round-five body-shadow" >
            <img src="uploads/1.jpg" class="" />
         </div>
      </td>
      <td>
         <ul><h2>382.73</h2><li>units</li></ul><br />
      </td>
      <td>
         <ul><h2>613</h2><li>shots</li></ul><br />
      </td>
   </tr>
</table> 
```

但它只是一团糟，有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T17:19:29.957

在我看来，绝对应该使用 table 来做到这一点。

至于显示交替颜色，您可能希望使用 nth-child() 伪类为 tr 应用背景颜色。

**JSFIDDLE：http:** [//jsfiddle.net/XYh7f/](http://jsfiddle.net/XYh7f/)

**HTML：**

```
<div class="container">
<div class="leaderboard">
<table id="main">
    <tr>
        <td>Leaderboard</td>
    </tr>
    <tr>
        <td>
            <table class="client">
                <tr> 
                    <th colspan="3">Chris Clarkson</th>
                </tr>
                <tr>
                    <td>IMG</td>
                    <td>267.26 units</td>
                    <td>457 shots</td>
                </tr>
            </table>
        </td>
    </tr>
    <tr>
        <td>
            <table class="client">
                <tr> 
                    <th colspan="3">Chris Clarkson</th>
                </tr>
                <tr>
                    <td>IMG</td>
                    <td>267.26 units</td>
                    <td>457 shots</td>
                </tr>
            </table>
        </td>
    </tr>
</table>
</div>
<div class="drinks">
    <table id="main-data">
        <tr>
            <td class="data-title"><h2>Last Drinks Served</h2></td>
        </tr>
        <tr>
            <table class="data">
                <tr>
                    <td class="data-time">Time</td>
                    <td class="data-shots">Shots</td>
                    <td class="data-drink">Drink</td>
                    <td class="data-drinker">Drinker</td>
                    <td class="data-date">Date</td>
                </tr>
                <tr>
                    <td class="data-time">Time</td>
                    <td class="data-shots">Shots</td>
                    <td class="data-drink">Drink</td>
                    <td class="data-drinker">Drinker</td>
                    <td class="data-date">Date</td>
                </tr>
                <tr>
                    <td class="data-time">Time</td>
                    <td class="data-shots">Shots</td>
                    <td class="data-drink">Drink</td>
                    <td class="data-drinker">Drinker</td>
                    <td class="data-date">Date</td>
                </tr>
            </table>
        </tr>
    </table>
</div>
</div><!-- END CONTAINER --> 
```

**CSS：**

```
/* CONTAINER STYLES */
.container {
    width: 960px;
}

.leaderboard {
    float: left;
}

.drinks { 
    float: left;
}

/* LEADER BOARD STYLES */
table {
    color: #eee;
    width: 200px;
    background: none;
}

tr { background: none; }
td { background: none; }

#main {
    text-align: center;
}

#main tr:nth-child(odd) {
    background: #444;
}

#main tr:nth-child(even) {
    background: #555;
}

#main tr td .client tr {
    background: none;
}

/* LAST DRINKS SERVED STYLES */

#main-data {
    width: 740px;
}

#main-data tr:nth-child(odd) {
    background: #444;
}

.data {
    width: 740px;
}

.data tr:nth-child(odd) {
    background: #222;
}

.data td {
    border-right: 1px solid #000;
}

.data tr:nth-child(even) {
    background: #333;
}

.data-title {
    padding: 0 0 0 60px;
}

.data-time {
    text-align: right;
    width: 120px;
}

.data-shots {
    text-align: right;
    width: 60px;
}

.data-drink {
    text-align: center;
    width: 240px;
}

.data-drinker {
    text-align: left;
    width: 200px;
}

.data-date {
    width: 140px;
} 
```

# python - Python：将整数写入单个字节

> ID：14707904
> 
> 赞同：1
> 
> 时间：2013-02-05T12:45:55.497
> 
> 标签：python, struct

我正在尝试将 4 个整数写入单个字节。

在下面的示例中，我可以解压缩 \x11 然后读取位（答案 = 1 2 0 0），但我将如何做相反的事情？即我如何将 1 2 0 0 打包到 \xll

```
import struct

val = struct.unpack('B', '\x11')[0]

a = val & 7
b = (val >> 3) & 7
c = (val >> 6) & 1
d = (val >> 7)

print a, b, c, d 
```

我对这一切都很陌生……非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T12:48:01.020

像这样：

```
val = ((d & 1) << 7) | ((c & 1) << 6) | ((b & 7) << 3) | (a & 7) 
```

# c# - 如何从另一个表单更改表单上所有控件的文本

> ID：14707906
> 
> 赞同：1
> 
> 时间：2013-02-05T12:46:00.723
> 
> 标签：c#, winforms

我在form2上有两个表单（Form1，form2）这个代码......我在form1上创建了所有控件的循环并获取控件的名称（ControlName）我想将任何文本（例如“sherif”）发送到这个控件（案例按钮）

```
 foreach (Control ctrl in form1.Controls)
{
    form1.Controls[ControlName]).Text = "sherif";
} 
```

出现错误信息 NullReferenceException 对象引用未设置为对象的实例。如果指针停在 [ControlName] 上面读取控件的名称，但是当 continue 时会出现 Null 值

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T12:50:28.040

如果您只想更改`Text`表单中所有控件的属性，应该这样做：

```
foreach (Control ctrl in form1.Controls)
{
   ctrl.Text = "sherif";
} 
```

请注意，这只会更改顶层的控件，而不是嵌套控件....

如果您也需要嵌套控件，请递归执行：

```
 public void RecursiveChange(Control control)       
 {

    foreach (Control ctrl in control.Controls)
    {
       RecursiveChange(ctrl);
       ctrl.Text = "sherif";
    }
 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T12:54:59.473

此方法递归返回所有表单控件：

```
public IEnumerable<Control> GetChildControls(Control parent)
{
    foreach(Control ctrl in parent.Controls)
    {
        yield return ctrl;

        if (ctrl.HasChildren)
            yield return GetChildControls(ctrl);
    }
} 
```

更新文字：

```
foreach(var ctrl in GetChildControls(form1))
    ctrl.Text = "sherif"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T12:51:15.007

您必须循环所有控件。其中一些可以在面板内。使用这种递归方法：

```
private void SetText(Control control, string text)       
{
     foreach (Control ctrl in control.Controls)
     {
         ctrl.Text = text;
         SetText(ctrl, text);
     }
} 
```

用法：

```
SetText(form1,  "sherif"); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-05T12:50:49.770

尝试这个

```
foreach (Control c in form1.Controls)
{

    if (c!= null)
    {
        c.text="Sherif";
    }
} 
```

# ruby-on-rails - 如何将评论表单与正确的帖子相关联

> ID：14707907
> 
> 赞同：1
> 
> 时间：2013-02-05T12:46:01.613
> 
> 标签：ruby-on-rails, form-for

我有用户/微博/评论模型，用户可以在其中评论其他人的微博。在每个帖子下都会显示一个文本字段，以便用户可以输入评论，但是我很难找到 Micropost Id。我认为问题出在我的 form_for 评论或控制器中，但我不确定。希望得到一些帮助，谢谢。

错误：找不到没有 ID 的微博

楷模：

```
User Model: has many microposts, has many comments
Micropost Model: belongs to user, has many comments
Comment Model: belongs to micropost, belongs to user 
```

用户控制器：

```
def show #(the profile page where all the posts and comments are)
  @user = User.find(params[:id])
  @microposts = @user.microposts.paginate(page: params[:page])
  @micropost  = current_user.microposts.build if signed_in?
  @comments = @micropost.comments
  @comment = current_user.comments.build(:micropost => @micropost) if signed_in?
end 
```

评论控制器：

```
def create
  @micropost = Micropost.find(params[:id])
  @comment = current_user.comments.build(:micropost => @micropost) #can someone explain what happens in the parentheses? 
  @comment.user = current_user
  @comment.save
  redirect_to :back
end 
```

查看/评论/_comment_form：

```
<%= form_for(@comment) do |f| %>
  <div id="comment_field">
    <%= f.text_field :content, placeholder: "Say Something..." %>
  </div>
<% end %> 
```

路线：

```
resources :users
resources :microposts, only: [:create, :destroy]
resources :comments, only: [:create, :destroy] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T12:56:29.867

只需为 micropost_id 添加一个隐藏字段

```
<%= form_for(@comment) do |f| %>
  <%= f.hidden_field :micropost_id, value: @micropost.id %>
  <div id="comment_field">
    <%= f.text_field :content, placeholder: "Say Something..." %>
  </div>
<% end %> 
```

更新：在`micropost_id`没有对控制器进行任何更改的情况下传递

根据您的评论控制器，您会`micropost`根据`params[:id]`提交表单时缺少的内容来查找。下面的代码解决了这个问题。但是，我建议您查看嵌套资源，这将使控制器代码更漂亮、更流畅

```
<%= form_for @comment do |f| %>
  <%= hidden_field_tag :id, @micropost.id %>
  <div id="comment_field">
    <%= f.text_field :content, placeholder: "Say Something..." %>
  </div>
<% end %> 
```

或更新`action`表格

```
<%= form_for @comment, url: comments_path(id: @micropost.id) do |f| %>
  <div id="comment_field">
    <%= f.text_field :content, placeholder: "Say Something..." %>
  </div>
<% end %> 
```

更新：对评论控制器进行编辑

```
# view
<%= form_for @comment do |f| %>
  <%= hidden_field_tag :micropost_id, @micropost.id %>
  <div id="comment_field">
    <%= f.text_field :content, placeholder: "Say Something..." %>
  </div>
<% end %>

# comments_controller.rb

def create
  @micropost = Micropost.find params[:micropost_id]
  @comment = current_user.comments.build
  @comment.micropost = @micropost
  @comment.save
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T13:08:06.143

您应该以这种方式设置您的评论资源：

```
resources :users
resources :microposts, only: [:create, :destroy] do
  resources :comments, only: [:create, :destroy]
end 
```

上述资源称为嵌套资源。在您的情况下，评论始终与微博相关，您应该将评论资源***嵌套*****到微博** 和评论控制器中：

```
def create
  @micropost = Micropost.find(params[:id])
  @comment = current_user.comments.build(:micropost => @micropost) #can someone explain what happens in the parentheses?
  @comment.save
  redirect_to :back
end 
```

上面的 build 方法创建了一个 Comment 模型的新对象/实例，正如您使用`current_user.comments`的那样，该对象将`user_id = current_user.id`自动拥有，您无需再次指定它。并且 'build(:micropost => @micropost)' 将添加`micropost's id`到`@comment`对象。

# php - 由于字符编码，PHP header() 不起作用

> ID：14707908
> 
> 赞同：0
> 
> 时间：2013-02-05T12:46:05.690
> 
> 标签：php, character-encoding

我有一个只包含这个的 PHP 文件：

```
<?php header( 'Location: http://www.yahoo.com'); ?> 
```

重定向在本地有效，但在我的 Blue Host 服务器上无效。支持部门说我必须将我的 PHP 文件的字符编码从 UTF8 更改为 ASCII，它会起作用。但是我不知道该怎么做。有没有可以轻松完成的免费软件或任何其他方式？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T12:52:07.983

这就是为什么您永远不应该向 HSP 支持人员询问编程问题。这超出了他们的范围，在最好的情况下，他们会提供一些像这样的虚假建议。

不管怎样，对 UTF-8 的引用可能有些道理。检查您的编辑器设置并确保您的 UTF-8 文件不包含 BOM（Unicode 字节顺序标记）。它不是强制性的，大多数应用程序都会对此感到困惑，尤其是。PHP 本身。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T12:51:56.477

在较新版本的记事本（Windows）中，您可以在“另存为”时选择编码。

否则使用具有编码菜单的[记事本++ 。](http://notepad-plus-plus.org/)

# c# - 从元数据中的 Xml 元素名称中获取方法名称

> ID：14707914
> 
> 赞同：1
> 
> 时间：2013-02-05T12:46:17.753
> 
> 标签：c#, xml, reflection, metadata

```
[XmlElement(ElementName = "SalesStageId", Form = XmlSchemaForm.None)]
public EntityIdentifier OpportunitySalesStageId { get; set; } 
```

上面`ElementName`是`"SalesStageId"`方法名称是`"OpportunitySalesStageId"`。

有没有办法通过包含上述方法的类的对象从元素名中找出方法名。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:37:22.063

1.  使用反射来获取类型的属性[`Type.GetProperties()`](http://msdn.microsoft.com/en-us/library/system.type.getproperties.aspx)
2.  然后你可以搜索每个自`PropertyInfo`定义属性`XmlElementAttribute`[`PropertyInfo.GetCustomAttribute`](http://msdn.microsoft.com/en-us/library/system.reflection.propertyinfo.getcustomattributes.aspx)
3.  如果找到该属性（即不为空），您可以简单地查询其内容以查看它是否匹配。
4.  对其余属性重复步骤 2 和 3

**示例程序：**

（使用 LINQ 和扩展方法进行了优化）

```
using System;
using System.Linq;
using System.Reflection;
using System.Xml.Schema;
using System.Xml.Serialization;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            string propName = FindPropertyNameByXmlElementAttributeElementName(typeof (MyClass), "Foo");

            Console.WriteLine(propName);
            Console.ReadKey();
        }
        static string FindPropertyNameByXmlElementAttributeElementName(Type type, string elementName)
        {
            PropertyInfo propertyInfo = 
                type.GetProperties().SingleOrDefault(
                        prop => prop.HasAttributeWithValue<XmlElementAttribute>(
                                a => a.ElementName == elementName
                            )
                    );
            if (propertyInfo == null)
            {
                return "NOT FOUND";
            }
            return propertyInfo.Name;
        }
    }

    public static class PropertyInfoExtensions
    {
        public static bool HasAttributeWithValue<TAttribute>(this PropertyInfo pi, Func<TAttribute, bool> hasValue)
        {
            TAttribute attribute = 
                (TAttribute)pi.GetCustomAttributes(typeof(TAttribute), true).SingleOrDefault();
            if (attribute == null)
            {
                return false;
            }
            return hasValue(attribute);
        }
    }
    class MyClass
    {
        [XmlElement(ElementName = "Foo", Form = XmlSchemaForm.None)]
        public string Rumplestiltskin { get; set; }
    }
} 
```

# javascript - Ajax 方法突然开始返回 302

> ID：14707916
> 
> 赞同：0
> 
> 时间：2013-02-05T12:46:26.983
> 
> 标签：javascript, ruby, ajax, sinatra

我有一个 Sinatra 应用程序，其中有一个 ajax 方法。以前它返回 200 和结果。现在它开始返回 302 并且结果**仍然正确**（我可以在 Google Chrome 调试控制台中看到）。

这是xaml代码：

```
 :javascript
        $(document).ready(function() { 
            $(document).on("click", "#my_id", function(){
              $.ajax({
                type: "GET",
                url: "/my_url",
                success: function(data){
                  window.location = data;
                }
            });
          });
        });

   def my_url
    #getting a data.....
    #returning the data... there is nothing unusual
  end 
```

**更新**：这就是我所做的：

```
 def my_url
    result = get_result()
    response.headers['Location'] = request.referer
    result
  end 
```

但是`Location`标题中的`Response`内容尚未更改，并且错误仍然存​​在。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T13:59:07.370

302 不是错误代码。这是您通过添加`Location`标头进行的重定向的 HTTP 状态代码。添加`Location`标头会自动将状态代码更改为 302。对于 302 的唯一预期响应类型是不理解 302 的浏览器会看到的内容。例如，一个 HTML 页面解释它是一个带有指向新页面的链接的重定向。对于 AJAX，302 没有响应，浏览器将获取您重定向到的新位置的结果。

有关 HTTP 状态代码的更多详细信息，请参见[http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.3.3](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.3.3)。

# php - 调整 BBcode 解析器以注意解析 URL 中的笑脸？

> ID：14707921
> 
> 赞同：1
> 
> 时间：2013-02-05T12:46:55.097
> 
> 标签：php, regex, bbcode

我想知道如何调整我的 BBcode 解析器以不解析 URL 中的笑脸？

这是我的解析器：

```
 $smilies = array(   
"><" => '<img src="/jscripts/sce/emoticons/angry.png" alt="" />',
":'(" => '<img src="/jscripts/sce/emoticons/cry.png" alt="" />',
":S" => '<img src="/jscripts/sce/emoticons/dizzy.png" alt="" />',
":D" => '<img src="/jscripts/sce/emoticons/grin.png" alt="" />',
"^_^" => '<img src="/jscripts/sce/emoticons/happy.png" alt="" />',
"<3" => '<img src="/jscripts/sce/emoticons/heart.png" alt="" />',
":huh:" => '<img src="/jscripts/sce/emoticons/huh.png" alt="" />',
":|" => '<img src="/jscripts/sce/emoticons/pouty.png" alt="" />',
":(" => '<img src="/jscripts/sce/emoticons/sad.png" alt=""/>',
":O" => '<img src="/jscripts/sce/emoticons/shocked.png" alt="" />',
":sick:" => '<img src="/jscripts/sce/emoticons/sick.png" alt="" />',
":)" => '<img src="/jscripts/sce/emoticons/smile.png" alt="" />',
":P" => '<img src="/jscripts/sce/emoticons/tongue.png" alt="" />',
":S" => '<img src="/jscripts/sce/emoticons/unsure.png" alt="" />',
":woot:" => '<img src="/jscripts/sce/emoticons/w00t.png" alt="" />',
":whistle:" => '<img src="/jscripts/sce/emoticons/whistle.png" alt="" />',
";)" => '<img src="/jscripts/sce/emoticons/wink.png" alt="" />',
":wub:" => '<img src="/jscripts/sce/emoticons/wub.png" alt="" />'
);

$body = str_replace( array_keys( $smilies ), array_values( $smilies ), $body ); 
```

问题出现了，因为有人放了一个链接

```
http://pcgamingwiki.com/wiki/User:Soeb 
```

然后哪个尝试放入“：S”笑脸图像？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T11:59:46.097

您可以使用[preg_replace()](http://php.net/manual/en/function.preg-replace.php)代替`str_replace()`并检查笑脸是否由空格*（或字符串开头或字符串结尾）限制*

代码：

```
$smilies = array(   
"/( |^)><( |$)/" => ' <img src="/jscripts/sce/emoticons/angry.png" alt="" /> ',
"/( |^):'\(( |$)/" => ' <img src="/jscripts/sce/emoticons/cry.png" alt="" /> ',
"/( |^):S( |$)/" => ' <img src="/jscripts/sce/emoticons/dizzy.png" alt="" /> ',
"/( |^):D( |$)/" => ' <img src="/jscripts/sce/emoticons/grin.png" alt="" /> ',
"/( |^)\^_\^( |$)/" => ' <img src="/jscripts/sce/emoticons/happy.png" alt="" /> ',
"/( |^)<3( |$)/" => ' <img src="/jscripts/sce/emoticons/heart.png" alt="" /> ',
"/( |^):huh:( |$)/" => ' <img src="/jscripts/sce/emoticons/huh.png" alt="" /> ',
"/( |^):\|( |$)/" => ' <img src="/jscripts/sce/emoticons/pouty.png" alt="" /> ',
"/( |^):\(( |$)/" => ' <img src="/jscripts/sce/emoticons/sad.png" alt=""/> ',
"/( |^):O( |$)/" => ' <img src="/jscripts/sce/emoticons/shocked.png" alt="" /> ',
"/( |^):sick:( |$)/" => ' <img src="/jscripts/sce/emoticons/sick.png" alt="" /> ',
"/( |^):\)( |$)/" => ' <img src="/jscripts/sce/emoticons/smile.png" alt="" /> ',
"/( |^):P( |$)/" => ' <img src="/jscripts/sce/emoticons/tongue.png" alt="" /> ',
"/( |^):S( |$)/" => ' <img src="/jscripts/sce/emoticons/unsure.png" alt="" /> ',
"/( |^):woot:( |$)/" => ' <img src="/jscripts/sce/emoticons/w00t.png" alt="" /> ',
"/( |^):whistle:( |$)/" => ' <img src="/jscripts/sce/emoticons/whistle.png" alt="" /> ',
"/( |^);\)( |$)/" => ' <img src="/jscripts/sce/emoticons/wink.png" alt="" /> ',
"/( |^):wub:( |$)/" => ' <img src="/jscripts/sce/emoticons/wub.png" alt="" /> '
);

$body=preg_replace( array_keys($smilies), array_values($smilies), $body ); 
```

[在这里](http://codepad.viper-7.com/0Zy7HU)查看它的实际应用。

# c# - C# Linq - 嵌套表达式参数

> ID：14707922
> 
> 赞同：1
> 
> 时间：2013-02-05T12:46:55.597
> 
> 标签：c#, linq

我有一个 LINQ 表达式，它调用另一个表达式，它也调用另一个表达式......

```
public static Expression<Func<Models.Order, Models.Product,decimal?>> _ExpressionOfGetCounterValue
{
    get
    {
        var _getAmountProxy = Product._ExpressionOfGetAmount;
        var _convertQuantityProxy = Product._ExpressionOfConvertQuantity;

        Expression<Func<Models.Order, Models.Product, decimal?>> cv =
            (order,product) => (
                _getAmountProxy.Invoke(
                    order.Product,
                    _convertQuantityProxy.Invoke(order.Product,order.Quantity), 
                    order.Product.Price));

        return cv;
    }
}

public static Expression<Func<Models.Product, decimal?, decimal?>> _ExpressionOfConvertQuantity
{
    get
    {
        Expression<Func<Models.Product, decimal?, decimal?>> convertQuantity =
            (product, quantity) => ModelEntities.DoubleToDecimal(
                                       ModelEntities.DecimalToDouble(quantity.Value)
                                     * Math.Pow(10.0, ModelEntities.DecimalToDouble(product.QuantityDecimals))
                                   );

        return convertQuantity;
    }
} 
```

执行此操作时，我收到错误 InvalidOperationException：参数 'order' 未绑定在指定的 LINQ to Entities 查询表达式中。

此异常来自 _convertQuantityProxy .Invoke(order.Product,order.Quantity) 如何将原始参数“order”传递给此调用？请注意，我使用 LinqKit / AsExpandable() 函数。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T13:13:37.103

最后我发现，我必须返回
return cv.Expand();

# entity-framework - 架构优先和简单的成员资格？

> ID：14707926
> 
> 赞同：0
> 
> 时间：2013-02-05T12:47:20.670
> 
> 标签：entity-framework, asp.net-mvc-4, asp.net-membership, simplemembership

我正在尝试首先使用模式（EF5）构建数据库并添加简单的成员资格。

在“绘制”我的架构后，我添加了用户配置文件表（UserId&UserName）删除

过滤器：InitializeSimpleMembershipAttribute，删除所有这些..

```
//public class UsersContext : DbContext
//{
//    public UsersContext()
//        : base("DefaultConnection")
//    {
//    }

//    public DbSet<UserProfile> UserProfiles { get; set; }

//}

//[Table("UserProfile")]
//public class UserProfile
//{
//    [Key]
//    [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
//    public int UserId { get; set; }
//    public string UserName { get; set; }
//} 
```

在生成的类中（首先按模式）我尝试手动添加

```
[Key]
[DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)] 
```

到我的 UserProfile 类

我也在我的 AppStart 中注册：

```
WebSecurity.InitializeDatabaseConnection("Model1Container", "UserProfile",
    "UserId", "UserName", autoCreateTables: true); 
```

但是在调试时我收到了这个错误：

```
Unable to find the requested .Net Framework Data Provider.  It may not be installed

WebSecurity.InitializeDatabaseConnection("Model1Container", "UserProfile", 
```

有没有一个好的做法怎么做？

是否可以先使用模式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T16:47:04.260

请注意，您已删除以下具有连接名称的部分。

```
public UsersContext()
//        : base("DefaultConnection")
//    {
//    } 
```

只需将其添加到您的上下文类中即可。是的，您可以使用代码优先方法来做到这一点，我认为这比您现在所做的要容易得多..

# sql-server-2008 - 用于插入已删除行的 SQL Server 查询

> ID：14707933
> 
> 赞同：0
> 
> 时间：2013-02-05T12:47:37.763
> 
> 标签：sql-server-2008

将表“A”中删除的行插入另一个表“B”的 SQL 查询是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T12:49:31.897

如果`TableB`满足作为[子句](http://msdn.microsoft.com/en-gb/library/ms177564.aspx)[目标的`OUTPUT`](http://msdn.microsoft.com/en-gb/library/ms177564.aspx)表的要求。

```
DELETE FROM TableA 
OUTPUT deleted.* INTO TableB 
WHERE Foo='Bar' 
```

> **以下限制适用于外部 INSERT 语句的目标：**
> 
> *   目标不能是远程表、视图或公用表表达式。
>     
>     
> *   目标不能有 FOREIGN KEY 约束，也不能被 FOREIGN KEY 约束引用。
>     
>     
> *   无法在目标上定义触发器。
>     
>     
> *   目标不能参与事务复制的合并复制或可更新订阅。

如果它不满足这些要求，解决方法是

```
INSERT INTO TableB
EXEC('
DELETE FROM TableA 
OUTPUT DELETED.*
WHERE Foo=''Bar''
') 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-05T12:51:40.243

一种选择是使用触发器。

```
CREATE TRIGGER CopyOnDelete
ON A
AFTER DELETE 
AS
    INSERT INTO B
    SELECT * FROM deleted
GO 
```

# vbscript - 使用 QTP 从 Web 列表中选择值时网页未更新

> ID：14707937
> 
> 赞同：0
> 
> 时间：2013-02-05T12:47:51.553
> 
> 标签：vbscript, combobox, qtp

所以我一直在寻找这个问题的答案很长一段时间，并想出了一个临时解决方案，我将在下面写下，但我想知道是否有更优雅的解决方案？

在我正在处理的应用程序中，有一个网络列表可以包含以下四个值之一：10,25,50,100。When a value is selected the web table below should show 10,25,50 or 100 results depending on the value selected of course.

现在，当我调用标准 Obj.Select “100” 时，它会将列表框更改为 100，但没有其他任何反应。没有触发任何事件，因此下面的 web 表格保持不变。如果我手动选择 100，则 Web 表会更新以显示 100 条记录。

我尝试向网络列表触发不同的事件，但它们似乎都没有更新网络表！

最后，我确定了以下解决方案：

```
Public Function CustomSelect(obj, strValue)

Dim intCounter, strProperty, boolItemInList, strEnabledOrDisabled, arrAllItems, strAllItems
Dim xCoord, yCoord

If strValue = "@@" Then
   Call AddComment("Passed in @@, skipping set function")
   Exit Function
End If

Reporter.Filter = rfEnableErrorsOnly
strProperty= obj.GetTOProperty("name")

If strProperty= "" Then 
    strProperty= obj.GetTOProperty("html id")
End If

Reporter.Filter = rfEnableAll

If obj.exist(5) Then
    XCoord = obj.GetROProperty("abs_x")
    YCoord = obj.GetROProperty("abs_y")
    strEnabledOrDisabled = obj.GetROProperty("disabled")
    If strEnabledOrDisabled = 0 Or strEnabledOrDisabled = "0" Then
        strAllItems = obj.GetROProperty("all items")
        arrAllItems = split(strAllItems,";")
        For intCounter = LBound(arrAllItems) to Ubound(arrAllItems)
            'Obj.SendKeys "{DOWN}"
            Obj.Select "#" & intCounter
            If arrAllItems(intCounter) = strValue Then
                Exit For
            End If
        Next
    Else
        Call ReportExpectedVsActual("Weblist is disabled: " & strProperty, False, True)
    End If
Else
    Call ReportExpectedVsActual("Weblist doesnt exist: " & strProperty, True, False)
End If

End Function

RegisterUserFunc "WebList", "CustomSelect", "CustomSelect" 
```

我知道它看起来有点乱，但我现在能想到的就是让它工作。有没有人对尝试什么有任何其他想法？

干杯

缺口

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T16:39:18.040

至少有两件事可以尝试：

尝试查看网页的来源以了解操作是如何触发的。它可能是类似的东西，`onchange='RefreshIt();'`或者你会看到一个`EventHandler`附加的东西，然后你必须更深入地挖掘。

如果您已识别将更新您的页面的事件，请尝试在使用 更新列表后触发该事件`WebListObject.FireEvent {yourEvent}`。`yourEvent`可以是包含 onchange、onclick、ondblclick、onblur、onfocus、onmousedown、onmouseup、onmouseover、onmouseout、onsubmit、onreset 或 onpropertychange 的字符串。

另一种更简单（但控制更少）的方法值得一试。这是通过设置完成的：转到`Tools > Options`并在树视图中，选择`Web > Advanced`。`Run only click`尝试更改复选框和单选按钮时会发生什么`Replay type`。

# android - Android - 在edittext中不能加粗超过一个单词

> ID：14707944
> 
> 赞同：0
> 
> 时间：2013-02-05T12:48:16.557
> 
> 标签：android, android-edittext, html, bold

我有一个editText，我想在其中加粗我选择的文本。我正在使用带有按钮的上下文操作栏来加粗选定的单词。问题是，如果我加粗一个词，我就不能加粗另一个词，如果我从那个词中删除跨度，我就不能再次添加它。et 是我在其中编写的editText，我还使用 2 SpannableString 来捕获剩余的文本，以保持之前添加的最终跨度。

自定义回调

```
cs1 = new StyleSpan(Typeface.BOLD);

class CustomCallback implements ActionMode.Callback {
public boolean onCreateActionMode(ActionMode mode, Menu menu) {

    //exploiting the CAB

    MenuInflater inflater = mode.getMenuInflater();
    inflater.inflate(R.menu.context_menu, menu);
    menu.removeItem(android.R.id.selectAll);
    return true;
}

public boolean onPrepareActionMode(ActionMode mode, Menu menu) {
    return false;
} 
```

行动加粗

```
public boolean onActionItemClicked(ActionMode mode, MenuItem item) {

    int start = et.getSelectionStart();
    int end = et.getSelectionEnd();

    SpannableStringBuilder s_before,s_next;

    SpannableStringBuilder ssb = new SpannableStringBuilder(et.getText().subSequence(start, end));
    s_before= new SpannableStringBuilder (et.getText().subSequence(0, start));
    s_next= new SpannableStringBuilder (et.getText().subSequence(end, et.length()));

    switch(item.getItemId()) {

    case R.id.bold:

        int a=ssb.getSpanStart(cs1);
        int b=ssb.getSpanEnd(cs1);

        if(a==-1 && b==-1){

            ssb.setSpan(cs1, 0, ssb.length(), Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);
        }
        else{
            ssb.removeSpan(cs1);
        }
        et.setText("");
        et.append(s_before);
        et.append(ssb);
        et.append(s_next);

        return true; 
```

我该如何解决？提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-22T09:15:04.653

我刚刚放了一个 RichEditText 库[https://github.com/kemallette/RichEditText](https://github.com/kemallette/RichEditText) ，它添加了粗体/斜体/strike/underline .. 和其他一些字体样式功能。它还增加了一堆很棒的验证。

如果这不符合您的需求，您将需要专注于跟踪跨度的位置、它们的类型以及它们正在被调整/重新添加。看看上面库中的 RichEditText 和 RichTextWatcher 类。它会让您更好地了解 EditText 中的文本更改时实际发生的情况。

# android - 如何在android中获取保存在图库中的图像路径

> ID：14707949
> 
> 赞同：0
> 
> 时间：2013-02-05T12:48:35.947
> 
> 标签：android, image, camera

我正在制作一个从相机中获取图像并将其保存在图库中的 android 应用程序。我想要的是获取保存图像的路径。我曾尝试使用 intent.getData() 但不工作..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T13:02:44.133

> I have tried using intent.getData() but is not working..

you Will get `intent as NULL` in Some Samsung Devices Like Samsung Galaxy S3 with Android OS Version 4.1.1.

i have face this Problems and Solve it by Below way you can try it out if it helps you.

While Calling intent for Image Capture :

```
String storageState = Environment.getExternalStorageState();

                    if (storageState.equals(Environment.MEDIA_MOUNTED)) {
                        Intent intent = new Intent(
                                MediaStore.ACTION_IMAGE_CAPTURE);

                        String filename = System.currentTimeMillis() + ".jpg";
                        ContentValues values = new ContentValues();
                        values.put(MediaStore.Images.Media.TITLE, filename);
                        mImageCaptureUri = getContentResolver().insert(
                                MediaStore.Images.Media.EXTERNAL_CONTENT_URI,
                                values);

                        intent.putExtra(
                                android.provider.MediaStore.EXTRA_OUTPUT,
                                mImageCaptureUri);

                        try {

                            startActivityForResult(intent, PICK_FROM_CAMERA);
                        } catch (ActivityNotFoundException e) {
                            e.printStackTrace();
                        }
                    } else {
                        new AlertDialog.Builder(BuildInukshk_4_Camera.this)
                                .setMessage(
                                        "External Storeage (SD Card) is required.\n\nCurrent state: "
                                                + storageState)
                                .setCancelable(true).create().show();
                    }

                } else { // pick from file
                    Intent intent = new Intent();

                    intent.setType("image/*");
                    intent.setAction(Intent.ACTION_GET_CONTENT);

                    startActivityForResult(Intent.createChooser(intent,
                            "Complete action using"), PICK_FROM_FILE);
                } 
```

Inside OnActivityResult Method :

```
case PICK_FROM_CAMERA:
                Log.i("TAG", "Inside PICK_FROM_CAMERA");

                // Final Code As Below
                try {
                    Log.i("TAG", "inside Samsung Phones");
                    String[] projection = {
                            MediaStore.Images.Thumbnails._ID, // The columns we want
                            MediaStore.Images.Thumbnails.IMAGE_ID,
                            MediaStore.Images.Thumbnails.KIND,
                            MediaStore.Images.Thumbnails.DATA };
                    String selection = MediaStore.Images.Thumbnails.KIND + "=" + // Select
                                                                                    // only
                                                                                    // mini's
                            MediaStore.Images.Thumbnails.MINI_KIND;

                    String sort = MediaStore.Images.Thumbnails._ID + " DESC";

                    // At the moment, this is a bit of a hack, as I'm returning ALL
                    // images, and just taking the latest one. There is a better way
                    // to
                    // narrow this down I think with a WHERE clause which is
                    // currently
                    // the selection variable
                    Cursor myCursor = this.managedQuery(
                            MediaStore.Images.Thumbnails.EXTERNAL_CONTENT_URI,
                            projection, selection, null, sort);

                    long imageId = 0l;
                    long thumbnailImageId = 0l;
                    String thumbnailPath = "";

                    try {
                        myCursor.moveToFirst();
                        imageId = myCursor
                                .getLong(myCursor
                                        .getColumnIndexOrThrow(MediaStore.Images.Thumbnails.IMAGE_ID));
                        thumbnailImageId = myCursor
                                .getLong(myCursor
                                        .getColumnIndexOrThrow(MediaStore.Images.Thumbnails._ID));
                        thumbnailPath = myCursor
                                .getString(myCursor
                                        .getColumnIndexOrThrow(MediaStore.Images.Thumbnails.DATA));
                    } finally {
                        // myCursor.close();
                    }

                    // Create new Cursor to obtain the file Path for the large image

                    String[] largeFileProjection = {
                            MediaStore.Images.ImageColumns._ID,
                            MediaStore.Images.ImageColumns.DATA };

                    String largeFileSort = MediaStore.Images.ImageColumns._ID
                            + " DESC";
                    myCursor = this.managedQuery(
                            MediaStore.Images.Media.EXTERNAL_CONTENT_URI,
                            largeFileProjection, null, null, largeFileSort);
                    String largeImagePath = "";

                    try {
                        myCursor.moveToFirst();

                        // This will actually give yo uthe file path location of the
                        // image.
                        largeImagePath = myCursor
                                .getString(myCursor
                                        .getColumnIndexOrThrow(MediaStore.Images.ImageColumns.DATA));
                        mImageCaptureUri_samsung = Uri.fromFile(new File(
                                largeImagePath));
                        mImageCaptureUri = null;
                    } finally {
                        // myCursor.close();
                    }

                    // These are the two URI's you'll be interested in. They give
                    // you a
                    // handle to the actual images
                    Uri uriLargeImage = Uri.withAppendedPath(
                            MediaStore.Images.Media.EXTERNAL_CONTENT_URI,
                            String.valueOf(imageId));
                    Uri uriThumbnailImage = Uri.withAppendedPath(
                            MediaStore.Images.Thumbnails.EXTERNAL_CONTENT_URI,
                            String.valueOf(thumbnailImageId));

                    // I've left out the remaining code, as all I do is assign the
                    // URI's
                    // to my own objects anyways...
                } catch (Exception e) {
                    mImageCaptureUri_samsung = null;
                    Log.i("TAG",
                            "inside catch Samsung Phones exception " + e.toString());

                }

                try {
                    Log.i("TAG",
                            "URI Samsung:" + mImageCaptureUri_samsung.getPath());

                } catch (Exception e) {
                    Log.i("TAG", "Excfeption inside Samsung URI :" + e.toString());
                }

                try {

                    Log.i("TAG", "URI Normal:" + mImageCaptureUri.getPath());
                } catch (Exception e) {
                    Log.i("TAG", "Excfeption inside Normal URI :" + e.toString());
                }

                break; 
```

After Running Below Code you Will get Two URIs `mImageCaptureUri_samsung` and `mImageCaptureUri`

you will get the mImageCaptureUri as your Path if you are running the App with Simple Devices and you will get your Cpatured Image path in mImageCaptureUri_samsung if you are running with Devices Like Samsung Galaxy S3.

Further you all can go ahead with your Code. it Works For me Very Fine With all the Devices i have tested on.

Also if Someone is having Problem with Above Code than they can reference the Below Great Link [Solution of Samsung Galaxy S3](http://kevinpotgieter.wordpress.com/2011/03/30/null-intent-passed-back-on-samsung-galaxy-tab/)

Hope it will Help.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-29T11:38:49.557

代码非常好。尝试在 android manifest 中授予 android.permission.WRITE_EXTERNAL_STORAGE 和 android.permission.READ_EXTERNAL_STORAGE 的权限。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T13:04:51.123

试试这个：

```
public class Camera extends Activity  {
         private static final int CAMERA_REQUEST = 1888;
         private String selectedImagePath;
         String fileName = "capturedImage.jpg";
         private static Uri mCapturedImageURI; 

        @Override
        public void onCreate(Bundle savedInstanceState)
        {
            super.onCreate(savedInstanceState);
            TakePhoto();
        }

        public void TakePhoto()
        {   
                ContentValues values = new ContentValues();  
                values.put(MediaStore.Images.Media.TITLE, fileName);  
                mCapturedImageURI = getContentResolver().insert(MediaStore.Images.Media.EXTERNAL_CONTENT_URI,
    values);
                Intent cameraIntent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);
                cameraIntent.putExtra(MediaStore.EXTRA_OUTPUT, mCapturedImageURI); 
                startActivityForResult(cameraIntent, CAMERA_REQUEST);
        }  

        @Override
        public void onActivityResult(int requestCode, int resultCode, Intent data)
        {
            if (resultCode == RESULT_OK)
                {
                  if (requestCode == CAMERA_REQUEST) 
                  { 
                    selectedImagePath = getPath(mCapturedImageURI);
                    Log.v("selectedImagePath: ", ""+selectedImagePath);
                     //Save the path to pass between activities
                  }
                }
        }

        public String getPath(Uri uri) {
            String[] projection = { MediaStore.Images.Media.DATA };
            Cursor cursor = managedQuery(uri, projection, null, null, null);
            int column_index = cursor
                    .getColumnIndexOrThrow(MediaStore.Images.Media.DATA);
            cursor.moveToFirst();
            return cursor.getString(column_index);
        }

    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T13:17:15.963

这就是我所做的：首先创建图像 uri，并使用意图 ACTION_IMAGE_CAPTURE 传递一个带有此值的额外 MediaStore.EXTRA_OUTPUT。

```
captureButton.setOnClickListener(new View.OnClickListener() {
                        @Override
                        public void onClick(View v) {
                            capturedImageURI =  ImageUtils.takePicture(ReceiptFormActivity.this);
                        }
                    }); 
```

然后 onActivityResult 将此 uri 路径转换为字符串路径并调用将从该字符串路径获取位图并将其设置在您的 imageView 上的方法。

```
 protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        super.onActivityResult(requestCode, resultCode, data);
            if (requestCode == CONSTANTS.TAKE_PICTURE)
            {
            if (resultCode == RESULT_OK)
            {               
                if(capturedImageURI != null)
                {
                    Utils.imagePath = ImageUtils.getStringPathFromURI(ReceiptFormActivity.this, capturedImageURI);;
                    setThumbnail();
                }
            }

        }
    }

    void setThumbnail()
    {
        try{
            if(Utils.imagePath != null)
            {
                ((TextView)findViewById(R.id.display_image)).setOnClickListener(new OnClickListener() {
                    @Override
                    public void onClick(View v) {
                        File f = new File(Utils.imagePath);
                        if(f.exists())
                        {
                            Intent intent = new Intent();  
                            intent.setAction(Intent.ACTION_VIEW); 
                            Uri imgUri = Uri.fromFile(f);
                            intent.setDataAndType(imgUri, "image/*");  
                            startActivityForResult(intent,2000);
                        }   
                    }
                });

                File imgFilePath = new File(Utils.imagePath);
                if(imgFilePath != null && imgFilePath.exists())
                {
                Bitmap bitmap =  ImageUtils.decodeFile(imgFilePath, CONSTANTS.THUMBNAIL_HEIGHT, CONSTANTS.THUMBNAIL_WIDTH);
                if(bitmap != null)
                {
                receipt_thumbnail.setImageBitmap(bitmap);
                return;
                }
                }
            }
        }
        catch (Exception e) {
            receipt_thumbnail.setImageResource(R.drawable.some_img);
        }
        /*
         * default img incase of not any exception and no bitmap either.
         */
        receipt_thumbnail.setImageResource(R.drawable.some_img);
    } 
```

ImageUtils.java

```
public class ImageUtils {
    public static Uri takePicture(Context context)
    {
        ContentValues values = new ContentValues();
        values.put(MediaStore.Images.Media.TITLE, "Receipt_" + System.currentTimeMillis());
        Uri mCapturedImageURI = context.getContentResolver().insert(MediaStore.Images.Media.EXTERNAL_CONTENT_URI, values);
        Intent intentPicture = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);
        intentPicture.putExtra(MediaStore.EXTRA_OUTPUT, mCapturedImageURI);
        ((Activity) context).startActivityForResult(intentPicture,CONSTANTS.TAKE_PICTURE);

        return mCapturedImageURI;

    }

     public static String getStringPathFromURI(Context context, Uri contentUri)
        {
            try
            {
                String[] proj = {MediaStore.Images.Media.DATA};
                Cursor cursor =  context.getContentResolver().query(contentUri, proj, null, null, null);
                int column_index = cursor.getColumnIndexOrThrow(MediaStore.Images.Media.DATA);
                cursor.moveToFirst();
                return cursor.getString(column_index);
            }
            catch (Exception e)
            {
                return contentUri.getPath();
            }
        }

         public static Bitmap decodeFile(File f, int thumbnailReqHeight, int thumbnailReqWidth)
        {
            Bitmap b = null;

            try {
                //Decode image size
                BitmapFactory.Options o = new BitmapFactory.Options();
                o.inJustDecodeBounds = true;

                FileInputStream fis = new FileInputStream(f);
                BitmapFactory.decodeStream(fis, null, o);
                fis.close();

                int scale = 1;
                if (o.outHeight > thumbnailReqHeight || o.outWidth > thumbnailReqWidth)
                {
                    scale = (int)Math.pow(2, (int) Math.round(Math.log(thumbnailReqHeight / (double) Math.max(o.outHeight, o.outWidth)) / Math.log(0.5)));
                }

                //Decode with inSampleSize
                o.inJustDecodeBounds = false;
                o.inSampleSize = scale;
                fis = new FileInputStream(f);
                b = BitmapFactory.decodeStream(fis, null, o);
                fis.close();
            } catch (IOException e) {
            }
            return b;
        }
    } 
```

# spring - Hibernate：具有两个不同的 ManyToOne 关系的子表

> ID：14707950
> 
> 赞同：0
> 
> 时间：2013-02-05T12:48:37.167
> 
> 标签：spring, hibernate, many-to-one, hibernate-onetomany

在我正在编写的 Spring/Hibernate/Java/Tomcat 应用程序中，组织与其联系人之间存在 OneToMany 关系。

**组织 1:M 联系人（具有外键 org_id）**

在组织中，我有这个领域：

```
@OneToMany(mappedBy="organization")
private List<Contact> contacts; 
```

在联系我有这个领域：

```
@ManyToOne
@JoinColumn(name="org_id")
private Organization organization; 
```

到目前为止一切正常。现在我添加了一个提议的概念。要约可以由组织提出，并且您与该特定要约的指定联系人交谈。

**Offer 具有其组织 (org_id) 和指定联系人 (contact_id) 的外键。**

到目前为止，报价看起来像：

```
@OneToOne
@JoinColumn(...)
private Organization offering_org;

@OneToOne
@JoinColumn(...)
private Contact offering_contact; 
```

我的问题的重点来了。我已经注释了用于组织的联系人类。如果我尝试以通常的 Hibernate 方式持久化 Offer 对象，我需要将 Organization 对象和 Contact 对象的副本存储到 Offer 对象中。这似乎与我现有的组织冲突：两个Java类的联系使用。例如，如果我有一个 1:1 的 Offer，如果我把它放到 Contact 类中，我是可以选择使用其中之一还是强制同时使用两者？

由于Offer是另一个关系，我是否需要编写Contact的数据传输对象版本以用于Offer关系？

谢谢，杰罗姆。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T11:57:12.143

也许我不完全理解这个问题，但我会做这样的事情：

```
// contact & organization being already persisted entity objects
Offer offer = new Offer();
offer.setOffering_org(organization);
offer.setOffering_contact(contact);

// Persisting the new Offer object to the database, 
// implicitly making the relations.
service.saveObject(offer); 
```

我认为没有理由创建组织对象的副本？
碰巧的是，**Organization**对象中的“联系人”集合也可以是一个或多个**Offer对象中的****Contact**。

 *** * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T14:47:11.910

我在想我原来的问题有点愚蠢。我所做的尝试是将其放在 Offer.java 中：

```
@Column(name="org_id")
private Long orgId = null;

@Column(name="contact_id")
private Long contactId = null; 
```

我手动填写 orgId，因为报价始终与用户的组织相关联。它是网页中的隐藏字段。

我在网页中放置了一个填充有适当联系人对象（contact.id、contact.name）的 SELECT。

提交网页时，Offer 的 orgId 和 contactId 字段将填写在 @ModelAttribute 参数中。这带我去我想去的地方。

为了解决 mspringer 先生的评论，如果我愿意在我的 Offer 对象中使用组织或联系人列表，您的示例可能会起作用（您说明了“创建新”情况）。这也是我最初问题的主题。但由于我发现我真的不想玩 Offer 中的扩展对象，我也不想玩，所以我可以避免我原来的问题的话题。

感谢所有困惑地看着我的练习的人。**

# r - 带有散点图叠加的ggplot箱线图（相同的变量）

> ID：14707952
> 
> 赞同：1
> 
> 时间：2013-02-05T00:28:19.923
> 
> 标签：r, ggplot2, boxplot

我是一名本科生研究员，过去几个月我一直在自学 R。我刚开始尝试ggplot，遇到了一些麻烦。我制作了一系列箱线图，观察不同声学接收站的鱼的深度。我想添加一个散点图，显示接收站的深度。这是我到目前为止所拥有的：

```
data    <- read.csv(".....MPS.csv", header=TRUE)
df      <- data.frame(f1=factor(data$Tagging.location), #$
                      f2=factor(data$Station),data$Detection.depth)
df2     <- data.frame(f2=factor(data$Station), data$depth)
df$f1f2 <- interaction(df$f1, df$f2) #$
plot1   <- ggplot(aes(y = data$Detection.depth, x = f2, fill = f1), data = df) + #$
                  geom_boxplot() + stat_summary(fun.data = give.n, geom = "text", 
                  position = position_dodge(height = 0, width = 0.75), size = 3)
                  plot1+xlab("MPS Station") + ylab("Depth(m)") +
                  theme(legend.title=element_blank()) + scale_y_reverse() + 
                  coord_cartesian(ylim=c(150, -10))
plot2   <- ggplot(aes(y=data$depth, x=f2), data=df2) + geom_point()
                  plot2+scale_y_reverse() + coord_cartesian(ylim=c(150,-10)) + 
                  xlab("MPS Station") + ylab("Depth (m)") 
```

不幸的是，由于我是这个论坛的新用户，我不能上传这两个地块的图像。我的 x 轴是“站”（有 12 个选项），我的 y 轴是“深度”（0-150 m）。箱线图通过标记站点（有 2 个选项）进行颜色编码。深度来自我的电子表格中的两个不同的列，它们不能合并为一个。

我的目标是通过将“plot2”（站深度散点图）添加到“plot1”箱线图（检测深度）来组合这两个图。它们都在查看相同的变量（深度和站点），并且必须是相同的 y 轴刻度。

如果我使用 R 基础程序，我想我可以找到一个混乱的解决方法，但如果可能的话，我想正确学习 ggplot。任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T13:47:43.303

**更新**：我对原始帖子中使用的语言感到困惑，并写了一个比必要的稍微复杂的答案。这是清理后的版本。

**第 1 步**：设置。在这里，我们确保两个数据帧中的深度值具有相同的变量名称（为了便于阅读）。

```
df <- data.frame(f1=factor(data$Tagging.location), f2=factor(data$Station), depth=data$Detection.depth)

df2 <- data.frame(f2=factor(data$Station), depth=data$depth) 
```

**第 2 步**：现在您可以使用 'ggplot' 函数绘制它，并使用 `col=f1` 参数拆分数据。我们将分别绘制检测数据，因为这需要一个箱线图，然后我们将用彩色点绘制站点的深度（假设每个站点只有一个深度）。我们通过引用“geom”函数中的数据来指定两个不同的图，而不是指定主“ggplot”函数中的数据。它应该看起来像这样：

```
ggplot()+geom_boxplot(data=df, aes(x=f2, y=depth, col=f1)) + geom_point(data=df2, aes(x=f2, y=depth), colour="blue") + scale_y_reverse() 
```

在这个绘图示例中，我们使用箱线图来表示检测数据并通过站点标签为这些箱线图着色。但是，我们使用特定颜色的点单独绘制站点，因此我们将能够相对于箱线图清楚地看到它们。

您应该能够从这里调整情节以满足您的需要。

我创建了一些虚拟数据并加载到图表中，以向您展示它的外观。请记住，这纯粹是随机数据，没有任何意义。

![深度图](../Images/1ba9a2792a83271cae8fef070f222ee5.png)

# c# - 如何为引用和值类型的属性创建表达式？

> ID：14707953
> 
> 赞同：2
> 
> 时间：2013-02-05T12:48:40.667
> 
> 标签：c#, reflection, linq-expressions

我正在尝试在运行时创建表达式以传递给第三方 API，该 API 的签名为 `Expression<Func<T, object>>`. 以下是我到目前为止所拥有的。这适用于引用类型，但值类型会导致异常（第 3 行）。

> “System.Boolean”类型的表达式不能用于返回类型“System.Object”

我假设这是由于拳击问题，我没有处理。

我已尝试添加`Expression.TypeAs(property, typeof(object))`，但 API 不会接受/解析此输入，因为它会生成`obj=> (obj.Foo As Object)`.

任何人都对如何创建与任何类型所需的签名匹配的表达式有任何想法？

```
// must be in the form of 'obj => obj.Foo', or the API wont parse
private static Expression<Func<T, object>> CreatePropertyExpression(PropertyInfo propertyInfo)
{
   var instanceParam = Expression.Parameter(propertyInfo.DeclaringType, "obj");
   var property = Expression.Property(instanceParam, propertyInfo);
   var lambda = Expression.Lambda<Func<T, object>>(property, instanceParam); // kaboom

   return (Expression<Func<T, object>>)lambda;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T12:53:24.250

添加演员/转换：

```
return Expression.Lambda<Func<T, object>>(
    Expression.Convert(property, typeof(object)), instanceParam); 
```

# php - 将会话设置为已登录的两个步骤

> ID：14707960
> 
> 赞同：0
> 
> 时间：2013-02-05T12:49:01.653
> 
> 标签：php, mysql, session

我有一个奇怪的问题，直到第二次点击才将用户设置为登录到会话（尽管他们已登录）

所以，我有一个如下所示的登录下拉列表：

![在此处输入图像描述](../Images/9479308f4d2e7f324f90769c171c5cd1.png)

我将用户发送到 ACCOUNT-SELECTOR。PHP 根据企业或个人帐户确定适当的验证：

```
if (isset($_POST['loginAccountType']) && $_POST['loginAccountType'] == 'individual') {       
     include('ind_login.php');;
} elseif (isset($_POST['loginAccountType']) && $_POST['loginAccountType'] == 'business') {
     include('bus_login.php');
} else {
     include('error_login.php');
} 
```

我`session_start();`的 account-selector.php 页面和我的`ind_login.php`页面都有。而且，两者都位于页面的最顶部（在其他任何内容之前）。

登录后，这是我的观点：

![在此处输入图像描述](../Images/5943d698943a786ea71b6ac8beda83ca.png)

如您所见，我可以`$_SESSION['Ind_ID']`在`ind_login.php`页面上设置并返回并查看您的个人资料作品（链接到会话 ID）。

但是，当代码说此按钮应设置为 display:none 时，我们仍然在导航上看到一个 LOG IN 按钮：

```
if(isset($_SESSION['Ind_ID'])) {
     $accIndStyle = "visibility: visible;"; 
} else {
     $accIndStyle = "display:none;";
} 
```

我知道这是正确的代码，因为按钮确实变成了显示：其他按钮没有。但是，如果我第二次登录，或者使用会话（开始）转到不同的页面，该站点将读取`$_SESSION['Ind_ID']`设置并隐藏登录按钮并用注销按钮替换它。

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T12:56:12.350

将 session_start() 放在 index.php 文件的顶部（该文件包括其他文件。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T12:54:19.013

似乎您的页面需要刷新，或者只是在那里抛出一个 ajax 调用以根据会话更新按钮值。

# arrays - 在条件检查中的bash for循环错误

> ID：14707961
> 
> 赞同：0
> 
> 时间：2013-02-05T12:49:03.393
> 
> 标签：arrays, bash, shell

我有一个 for 循环来检查我在文件中的节点列表是否还活着：

```
#!/bin/bash
tmpnodes=$(cat $1)
#declare -a nodes
nodes=()
for node in $tmpnodes
do
        result=$(ping -q -c 1 -W 2 $node >/dev/null 2>&1; echo $?)
        echo "Result: $result, on node $node"
        if [ $result -eq 0 ] ; then
                nodes+=("$node")
                #nodes=(${nodes[@]} "$node")
        fi
done

echo "pingable nodes:"
for node in $nodes
do
        echo "$node"
done 
```

（我也试过这个版本`declare`）

虽然我有更多可 ping 的节点，但我总是得到这个输出：

```
$  ./script.sh nodes
Result: 1, on node clab148node11
Result: 1, on node clab148node12
Result: 0, on node clab148node15
Result: 0, on node clab148node16
Result: 0, on node clab148node17
Result: 0, on node clab148node18
pingable nodes:
clab148node15 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T13:17:29.060

代替：

```
for node in $nodes
do
        echo "$node"
done 
```

每次我这样做时，它确实打印了数组的第一个元素：

```
echo ${nodes[@]} 
```

# php - php中以小时、分钟和秒为单位的平均时间

> ID：14707964
> 
> 赞同：3
> 
> 时间：2013-02-05T12:49:11.907
> 
> 标签：php, average

我有一些总小时数，需要计算平均值。例如，我的总小时值为 2452:43:44 (H:m:s)，总计数为 15。我想以相同的格式获取平均时间，即小时:分钟:秒。我们如何在 PHP 中做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T12:56:09.627

```
function average_time($total, $count, $rounding = 0) {
    $total = explode(":", strval($total));
    if (count($total) !== 3) return false;
    $sum = $total[0]*60*60 + $total[1]*60 + $total[2];
    $average = $sum/(float)$count;
    $hours = floor($average/3600);
    $minutes = floor(fmod($average,3600)/60);
    $seconds = number_format(fmod(fmod($average,3600),60),(int)$rounding);
    return $hours.":".$minutes.":".$seconds;
}
echo average_time("2452:43:44", 15); // prints "163:30:55"
echo average_time("2452:43:44", 15, 2); // prints "163:30:54.93" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T13:06:56.053

接近[安东尼的](https://stackoverflow.com/users/1493698/antony)解决方案，但有给定的数组`hours`：

```
$time = array (
            '2452:43:44',
            '452:43:44',
            '242:43:44',
            '252:43:44',
            '2:43:44'
        );

$seconds = 0;
foreach($time as $hours) {
    $exp = explode(':', strval($hours));
    $seconds += $exp[0]*60*60 + $exp[1]*60 + $exp[2];
}

$average = $seconds/sizeof( $time );
echo floor($average/3600).':'.floor(($average%3600)/60).':'.($average%3600)%60; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-05-03T01:42:21.637

```
$totalhourandmunite+=str_replace(":",'',$date);
strtoheur(round($totalhourandmunite/$nbdate,0));
function strtoheur($temp)
{
    if(strlen($temp)==1) return $temp;
    if(strlen($temp)==2)
        $temp=$temp."00";
    if(strlen($temp)==3)
        $temp="0".$temp;
    $temp=str_split($temp);
    $heure=$temp["0"].$temp["1"];
    $min=$temp["2"].$temp["3"];
    if($min/60>1)
    {
        $min=$min%60;
        $heure++;
    }
    if($min<10 && strlen($min)==1)
        $min="0".$min;
    if($heure>23)
    {
        $heure=$heure%24;
    }
    $temp=$heure.":".$min;
    return $temp;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T12:56:45.563

1.  最好的方法是以秒为单位更改总小时值。
2.  除以总计数值。你将得到的是平均秒数。
3.  将平均值转换回 H:m:s 格式。

# java - 我在哪里可以下载适用于 Mac OSX Lion 的 Java 6？

> ID：14707969
> 
> 赞同：-4
> 
> 时间：2013-02-05T12:49:21.147
> 
> 标签：java, google-chrome

www.screenr.com 不适用于带有 Java 7 的 Chrome。我不能使用其他浏览器，所以我猜我需要降级到 Java 6？我试过这样做，但我想我已经意外地从我的系统中删除了所有版本的 Java。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T12:53:45.183

由于浏览器插件存在严重的安全问题，我强烈反对降级到较早的 Java 版本。而是坚持使用最新版本（截至目前为 7u13），因为版本 6 已经面临生命周期的终结。看到这个，例如： [http ://www.h-online.com/open/news/item/Oracle-releases-emergency-patches-for-Java-1796543.html](http://www.h-online.com/open/news/item/Oracle-releases-emergency-patches-for-Java-1796543.html)

# jquery - jQuery - 如何在鼠标移动时间轴时运行 .animate？

> ID：14707970
> 
> 赞同：1
> 
> 时间：2013-02-05T12:49:22.083
> 
> 标签：jquery, jquery-animate, offset, timeline

我希望 div 在鼠标在时间轴上移动时运行此动画。`width/height 100px`当鼠标接近时间线的一半时，div 开始，同时将 div 的大小调整为`width/height 200px`. 当鼠标接近时间线的末尾时返回 div `width/height 100px`。

```
$('#timeline').mousemove(function(e){
    var position = e.clientX;
    $('#mark').css("left", position - 50);
});

$('#animation').animate({
    width: "200",
    height: "200"
}, 2000).animate({
    width: 100,
    height: 100
}, 2000); 
```

[jsfiddle.net](http://jsfiddle.net/69eEL/420/)

请建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T14:00:58.147

你需要做一些`Math`，宝贝！具体来说，该`abs`函数可用于计算您距中点的距离。使用以下方法计算与中心线的**距离：**

```
var timelineWidth = $('#timeline').width;
var dist = Maths.abs((width/2) - e.ClientX); // distance from the middle 
```

您的最终功能将如下所示：

```
$('#timeline').mousemove(function(e){
    var timelineWidth = $('#timeline').width();
    var position = e.clientX;
    /* Calculate the distance from the mid-point */
    var dist = Math.abs((position - 50) - timelineWidth/2);
    /* Work out the percentage increase needed for your square */
    var squareSide = ((timelineWidth-dist)/timelineWidth) * 200;
    $('#mark').css("left", position - 50);
    /* Apply the transformation to your square */
    $('#animation').height(squareSide);
    $('#animation').width(squareSide);
}); 
```

希望有帮助！

# jquery - jQuery 使用 .get/ajax 在数组中追加多个 URL 的内容

> ID：14707973
> 
> 赞同：0
> 
> 时间：2013-02-05T12:49:26.990
> 
> 标签：jquery, ajax, arrays, get

是否可以使用 jQuery 将数组中每个 URL 的内容附加到 URls 列表中的给定容器？

像这样：

```
<li class="contacts"><a href="index.php#contact1">Contact 1</a>
<li class="contacts"><a href="index.php#contact2">Contact 2</a>
<li class="contacts"><a href="index.php#contact3">Contact 3</a>
<li class="contacts"><a href="index.php#contact4">Contact 4</a> 
```

我知道如何使用 jQuery 获取 URL 数组：

```
$(document).ready(function() {
    var allLinks = $('li.contacts a').map(function(i,el) { return $(el).attr('href');     });
    console.log($(allLinks));
}); 
```

好的，我在 allLinks 变量中有一个 URL 数组。我现在想用 .get() 函数附加每个 URL 的 #content 元素的内容。

如何从数组中的第一个 URL 循环到最后一个 URL 并将其内容附加到我的当前页面？它基本上应该像这样结束：

```
<div id="currentpage">
//#content of URL1
//#content of URL2
//#content of URL3
//#content of URL4
</div> 
```

URL 列表是动态生成的（这不是问题）。

我试过这个：

```
$(document).ready(function() {
    var allLinks = $('li.contacts a').map(function(i,el) { return $(el).attr('href'); });
    console.log($(allLinks));

  var curr  = 0;
        if (curr++ > allLinks.length) curr = 0;

        $.get(allLinks[curr],function(data){
        var myContent = $(data).find('#content').children();
            jQuery('#wrapper').append(myContent);
   });
}); 
```

但没有成功。有什么线索吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T13:01:19.280

**更新答案：（**将点击的 href 加载到 div 中）

```
$('.contacts a').click(function() {
  var url= $(this).attr('href');
  $('#currentpage').html('loading...');
  $.ajax({
     url: url
  }).success(function(data) {
     $('#currentpage').html(data);
  });       
  return false;
});
//JSBin http://jsbin.com/ucobuv/3/edit
//No need for the allLinks variable here 
```

旧答案：（加载所有链接）

```
(function getContent(i) {
    $.ajax({
        url: allLinks[i++]
    }).success(function(data) {
        $('#currentpage').append(data);
        if(allLinks[i]) getContent(i);
    });
})(0);
//JSBin http://jsbin.com/ucobuv/1/edit 
```

# ruby-on-rails - 没有运算符与给定名称和参数类型匹配

> ID：14707975
> 
> 赞同：1
> 
> 时间：2013-02-05T12:49:30.737
> 
> 标签：ruby-on-rails, ruby, heroku, postgresql-9.1, hstore

我将 Rails 3.2.x 应用程序设置为使用 PostgreSQL HStore，但出现错误。看起来 hstore 扩展尚未被环境拾取。我已经重新启动了我的机器，检查了数据库扩展等。

当我尝试执行时：

```
User.where("settings @> (:key => :value)", :key => "setting_x", :value => "test") 
```

我收到一个错误：（`@>`无法识别，即`hstore`未安装扩展程序？）

```
HINT:  No operator matches the given name and argument type(s). You might need to add explicit type casts. 
```

我的 Rails 应用程序设置是：

宝石文件.rb：

```
gem 'activerecord-postgres-hstore' 
```

移民：

```
add_column :users, :settings, :hstore
execute "CREATE INDEX CONCURRENTLY users_gin_settings ON users USING GIN(settings)"
# can see the extenstion installed on my local dev psql database after this 
```

`User`模型：

```
serialize :settings, ActiveRecord::Coders::Hstore 
```

动态`User`方法：

```
# metaprogramming: has_setting_x + instance.setting_x
%w[setting_x setting_y setting_z].each do |key|
attr_accessible key
    # doesn't work > throws error because of the @> operator
    scope "has_#{key}", lambda { |value| where("settings @> (? => ?)", key, value) }

    # works: can use instance.setting_x
    define_method(key) do
      settings && settings[key]
    end

    # works: can use instance.setting_x = "value"
    define_method("#{key}=") do |value|
      self.settings = (settings || {}).merge(key => value)
    end
end 
```

* * *

更新1：

当我直接与 PostgreSQL DB 对话时，这很有效：

```
SELECT "users".* FROM "users" WHERE (settings @> hstore('setting_x','6D9Q7RO4SVWHXK86F')); 
```

Hstore[文档](http://www.postgresql.org/docs/9.1/static/hstore.html)说：

```
The => operator is deprecated and may be removed in a future release. Use the hstore(text, text) function instead. 
```

所以，从表面上看，我的 PostgreSQL 数据库版本（9.2.1）已经弃用了这个`=>`符号。看来我还有更多的研究要做。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-05T15:50:13.997

来自[PostgreSQL 文档](http://www.postgresql.org/docs/9.1/static/hstore.html)：

> 该`=>`运算符已弃用，可能会在将来的版本中删除。请改用该`hstore(text, text)`功能。

所以从外观上看，我的 PG 数据库版本（ 9.2.1 ）已经弃用了这个`=>`符号。
现在在本地和 Heroku 上工作。

例子：

```
User.where("settings @> hstore(?,?)", "setting_x", key) 
```

# templates - Joomla 2.5！如何为类别布局自定义自己的模板？

> ID：14707980
> 
> 赞同：0
> 
> 时间：2013-02-05T12:49:40.353
> 
> 标签：templates, layout, joomla, joomla2.5

我正在设计一个模板。使用 Beez_2 模板，文章可以在博客布局下显示，但使用我自己的模板，它们只能在列表布局下显示。我如何自定义自己的模板以在博客/列表布局下的类别中显示文章？...谢谢。我正在使用 joomla 2.5！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T08:06:58.700

检查你的模板的/templates/some_template/html/com_content/category 文件夹：应该至少有两个文件，“default.php”和“blog.php”，如果你只有default，博客视图可能不可用。

对于测试，只需将“类别”重命名为其他名称，您应该会再次看到默认博客可用。

# php - php FOR 不工作

> ID：14707982
> 
> 赞同：0
> 
> 时间：2013-02-05T12:49:51.703
> 
> 标签：php, xml

这是我的代码。它从mysql创建xml文件..

我的问题：

```
for($i=0; $i<count($str_exp1); $i++) // HERE 
{
  $str_exp2 = explode(",", $str_exp1[$i]);

  $newnode->setAttribute("lat", $str_exp2[0]);
  $newnode->setAttribute("lng", $str_exp2[1]);  

} 
```

因为不显示所有数据...它只显示最新的一个数据..我找不到哪里有问题..

PS对不起我的英语

0

```
$doc =  new DOMDocument("1.0");
$node = $doc->createElement("marker");
$parnode = $doc->appendchild($node);

$result = mysql_query("SELECT * FROM usersline");
if(mysql_num_rows($result)>0)
{ 
  header("Content-type: text/xml");
  while ($mar = mysql_fetch_array($result))
  {

    $node = $doc->createElement("line");
    $newnode = $parnode->appendChild($node);
    $newnode->setAttribute("id_line", $mar['id_line']);
    $newnode->setAttribute("color", $mar['colour']);
    $newnode->setAttribute("width", $mar['width']);

    $node = $doc->createElement("point");
    $newnode = $parnode->appendChild($node);

    $str_exp1 = explode(";", $mar['coordinats']);

    for($i=0; $i<count($str_exp1); $i++) // HERE 
    {
      $str_exp2 = explode(",", $str_exp1[$i]);

      $newnode->setAttribute("lat", $str_exp2[0]);
      $newnode->setAttribute("lng", $str_exp2[1]);  

    }

  }
  $xmlfile = $doc->saveXML();
  echo $xmlfile;
}
else
{
  echo "<p>Ëèíèé íå îáíàðóæåíî!</p>";
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:28:39.393

您的问题是您为同一个节点设置了多个值。所以你总是用最新的纬度/经度值覆盖属性值。

相反，您需要为每个纬度/经度对添加一个新元素，因为 XML 元素没有重复的属性。

基于您的问题的一些示例代码，如您所见，我介绍了一些功能以使事情更加模块化：

```
$result = $db->query("SELECT * FROM usersline");

if (!$result || !count($result)) {
    echo "<p>Ëèíèé íå îáíàðóæåíî!</p>";
    return;
}

$doc = new DOMDocument("1.0");
$doc->loadXML('<marker/>');
$marker = $doc->documentElement;

foreach ($result as $mar) {

    $line = $doc->createElement('line');
    $attributes = array_map_array(['id_line', 'colour' => 'color', 'width'], $mar);
    element_add_attributes($line, $attributes);
    foreach (coordinates_to_array($mar['coordinats']) as $latlong) {
        $point = $doc->createElement('point');            
        element_add_attributes($point, $latlong);
        $line->appendChild($point);
    }

    $marker->appendChild($line);

}

header("Content-type: text/xml");
echo $doc->saveXML();

function element_add_attributes(DOMElement $element, array $attributes)
{
    foreach ($attributes as $name => $value) {
        if (!is_string($name)) continue;
        $element->setAttribute($name, $value);
    }
}

function array_map_array(array $map, array $array)
{
    $result = array();
    foreach ($map as $alias => $name) {
        $source = is_string($alias) ? $alias : $name;
        $result[$name] = $array[$source];
    }
    return $result;
}

function coordinates_to_array($coordinates)
{
    $result = array();
    $coordinatePairs = explode(";", $coordinates);

    foreach ($coordinatePairs as $coordinatePair) {
        list($pair['lat'], $pair['lng']) = explode(',', $coordinatePair, 2) + ['', ''];
        $result[] = $pair;
    }

    return $result;
} 
```

我希望这个示例对您有所帮助，并向您展示一些如何解决问题的方法，以便您的代码变得更加简单和稳定。

* * *

要使用`$db->query(...)`首先定义一个具有该`query`方法的类：

```
class DB {
    public function query($sql) {
        $dbhandle = mysql_query($sql);
        $result  = array();

        while ($mar = mysql_fetch_array($dbhandle)) 
            $result[] = $mar
        ;

        return $result;
    }
} 
```

然后实例化它：

```
$db = new DB(); 
```

然后，您可以将上面的代码用于该部分。

对于 PHP 5.4 数组表示法的问题，例如在这一行中：

```
$attributes = array_map_array(['id_line', 'colour' => 'color', 'width'], $mar); 
```

首先从中提取数组：

```
$mapping    = ['id_line', 'colour' => 'color', 'width'];
$attributes = array_map_array($mapping, $mar); 
```

`array(`然后用and`)`符号而不是`[`and定义数组`]`：

```
$mapping    = array('id_line', 'colour' => 'color', 'width');
$attributes = array_map_array($mapping, $mar); 
```

在其他地方也这样做，例如

```
['', ''] 
```

变成

```
array('', '') 
```

和类似的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T12:56:35.063

用这个替换你的代码：

```
$str_exp1 = explode(";", $mar['coordinats']);

$newnode->setAttribute("lat", $str_exp1[0]);
$newnode->setAttribute("lng", $str_exp1[1]); 
```

# linq - 自定义比较字典 linq

> ID：14707983
> 
> 赞同：1
> 
> 时间：2013-02-05T12:49:53.643
> 
> 标签：linq, dictionary

我有两个字典如下：

词典 1：

```
Dictionary<string, string> dict1 = new Dictionary<string, string>();

request.Add("key1", "value1");

request.Add("key2", "value2");    

request.Add("key3", "value3"); 
```

字典 2：

```
Dictionary<string, string> request = new Dictionary<string, string>();

request.Add("key1", "value1");

request.Add("key2", "value2"); 
```

我需要使用带有条件的 LINQ 查询来比较上述两个字典：

1) **dict2 中的所有键都应与 dict1 中的键匹配**

2)**匹配的键值应该相等**

3）**即使dict2中key2的值为空，也应该匹配**

对上面的帮助表示赞赏。提前致谢。

问候，

萨钦

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T12:51:30.057

您可以使用该[`Contains`方法并提供自定义`IEqualityComparer`](http://msdn.microsoft.com/en-us/library/bb339118.aspx)，但更简单的方法是使用[`Any()`](http://msdn.microsoft.com/en-us/library/bb534972.aspx)：

```
var dict1 = new Dictionary<string, string>
{
    {"key1", "value1"},
    {"key2", "value2"},
    {"key3", "value3"}
};

var dict2 = new Dictionary<string, string>
{
    {"key1", "value1"},
    {"key2", "value2"}
};

dict2.All(k2 => 
        dict1.Any(k1 => k1.Key == k2.Key && 
                        (String.IsNullOrEmpty(k2.Value) || k1.Value == k2.Value))) 
```

我猜你的意思是*空*`null`的或空字符串，因此我使用了[`String.IsNullOrEmpty`](http://msdn.microsoft.com/en-us/library/system.string.isnullorempty%28v=vs.85%29.aspx). 如果您只想检查`null`，请改为执行简单操作`k2.Value == null`。