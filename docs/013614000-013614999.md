# StackOverflow 问答 13614000-13614999

# php - eBay购物API分页

> ID：13614003
> 
> 赞同：1
> 
> 时间：2012-11-28T20:41:03.717
> 
> 标签：php, pagination, ebay-api

我想知道是否有人可以帮助我解决我商店中的一些分页问题。使用 pajinate，我最初把它放在一起，但它似乎被窃听了。我想添加一个“上一页”和“回到开头”以及“下一页”和“最后一页”按钮。我尝试先实现“回到开头”和“上一个”按钮，但它们无法正常工作。如果有人可以帮助我，那就太好了。附带说明一下，我设置了一次显示 10 个数字的范围，但每次我点击更高的页码时，它都会附加 4-5 个数字，对此问题的任何见解也将不胜感激。

```
<?php
// find out total pages

$totalpages = $resp->paginationOutput->totalPages;
echo "Total Results: ";
echo $totalpages.' pages ';
// get the current page or set a default
if (isset($_GET['pgno']) && is_numeric($_GET['pgno'])) {
   // cast var as int
   $currentpage = (int) $_GET['pgno'];
} else {
   // default page num
   $currentpage = 1;
} // end if

// if current page is greater than total pages...
if ($currentpage > $totalpages) {
   // set current page to last page
   $currentpage = $totalpages;
} // end if
// if current page is less than first page...
if ($currentpage < 1) {
   // set current page to first page
   $currentpage = 1;
} // end if

// the offset of the list, based on current page
$offset = ($currentpage - 1) * $entriesPerPage;

/******  build the pagination links ******/
// if not on page 1, don't show back links
if ($currentpage > 1) {
   // show << link to go back to page 1
if(null!=$queryString){
//  echo " <a href='{$_SERVER['PHP_SELF']}?$queryString&currentpage=1'><<</a> ";
}else{
//  echo " <a href='{$_SERVER['PHP_SELF']}?currentpage=1'><<</a> ";
}
   // get previous page num
 //  $prevpage = $currentpage - 1;
   // show < link to go back 1 page
//   echo " <a href='{$_SERVER['PHP_SELF']}?currentpage=$prevpage'><</a> ";
} // end if

// range of num links to show
$range = 10;

// loop to show links to range of pages around current page
for ($x = ($currentpage - $range); $x < (($currentpage + $range)  + 1); $x++) {
   // if it's a valid page number...
   if (($x > 0) && ($x <= $totalpages)) {
      // if we're on current page...
      if ($x == $currentpage) {
         // 'highlight' it but don't make a link
         echo " [<strong>$x</strong>] ";
      // if not current page...
      } else {
         // make it a link
         echo " <a href='".add_url_param('pgno',$x)."'>$x</a> ";

      } // end else
   } // end if
} // end for
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T11:43:33.200

您已将上一页注释掉，并使用 $_GET['currentpage'] 而不是 $_GET['pgno']，这对我有用：

```
<?
$totalpages = 10;
if (isset($_GET['pgno']) && is_numeric($_GET['pgno'])) {
// cast var as int
$currentpage = (int) $_GET['pgno'];
} else {
// default page num
$currentpage = 1;
} // end if

echo $currentpage;
echo "/".$totalpages;
echo "<br />";

// if current page is greater than total pages...
if ($currentpage > $totalpages) {
// set current page to last page
$currentpage = $totalpages;
} // end if
 // if current page is less than first page...
if ($currentpage < 1) {
 // set current page to first page
 $currentpage = 1;
}   // end if

// the offset of the list, based on current page
$offset = ($currentpage - 1) * $entriesPerPage;

/******  build the pagination links ******/
// if not on page 1, don't show back links
if ($currentpage > 1) {
// show << link to go back to page 1
if(null!=$queryString){
 echo " <a href='{$_SERVER['PHP_SELF']}?$queryString&pgno=1'><<</a> ";
}else{
  echo " <a href='{$_SERVER['PHP_SELF']}?pgno=1'><<</a> ";
}
// get previous page num
$prevpage = $currentpage - 1;
// show < link to go back 1 page
 echo " <a href='{$_SERVER['PHP_SELF']}?pgno=$prevpage'><</a> ";
} // end if

// range of num links to show
$range = 10;

// loop to show links to range of pages around current page
for ($x = ($currentpage - $range); $x < (($currentpage + $range)  + 1); $x++) {
// if it's a valid page number...
  if (($x > 0) && ($x <= $totalpages)) {
    // if we're on current page...
     if ($x == $currentpage) {
       // 'highlight' it but don't make a link
       echo " [<strong>$x</strong>] ";
    // if not current page...
    } else {
       // make it a link
       echo " <a href='".$_SERVER['PHP_SELF']."?pgno=$x"."'>$x</a> ";

     } // end else
   } // end if
 } // end for
 ?> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2016-04-08T11:01:26.597

```
$offset = ($currentpage - 1) * $entriesPerPage;

if ($currentpage > 1) {

?where comes this variable 
```

# string - 如何使用正则表达式在 perl 中解析电子邮件地址的行？

> ID：13614009
> 
> 赞同：-1
> 
> 时间：2012-11-28T20:41:22.377
> 
> 标签：string, perl, parsing, email-address

我一生都无法弄清楚如何使用 RegEx 从字符串中解析出电子邮件地址。

我不认为我可以使用 Email::Address 模块，因为它没有附带我们​​被告知要下载的 perl 版本，否则这将非常简单。

我当前使用 Email::Address 的代码

```
use strict;

#use Email::Valid;

my $infile = 'IJCA_reviewer_list.txt';
my $outfile = 'output.txt';
open my $out, ">> $outfile";
open my $in, "< $infile" or die "Can't open $infile : $!";
use Email::Address;

while(my $line = <$in> ) {

    chomp $line;

    my $addrs = Email::Address->parse($line);

    print $out "$addrs , ";
}

close $in;
close $out; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T18:54:52.537

我会像这样使用[File::Slurp](https://metacpan.org/module/File%3a%3aSlurp)和[Email::Address](https://metacpan.org/module/Email%3a%3aAddress)：

```
#!/usr/bin/env perl
#
use strict;
use warnings;

use File::Slurp qw( read_file );
use Email::Address;

my $infile  = 'IJCA_reviewer_list.txt';
my $outfile = 'output.txt';

my $intext = File::Slurp::read_file( $infile );
my @emails = Email::Address->parse( $intext );

File::Slurp::write_file( $outfile, join("\n", @emails) ); 
```

**更新**：如果您在安装 CPAN 模块时需要帮助，可以阅读[此](http://www.cpan.org/modules/INSTALL.html)内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T20:50:53.087

[http://www.ex-parrot.com/pdw/Mail-RFC822-Address.html](http://www.ex-parrot.com/pdw/Mail-RFC822-Address.html)显示用于解析电子邮件的正则表达式。

电子邮件的规范非常苛刻。

您可能最好在 cpan 中搜索一个可以为您将电子邮件分成几部分的模块。

# actionscript-3 - 代码在 Firefox 中有效，但在 IE 或 Chrome 中无效

> ID：13614012
> 
> 赞同：2
> 
> 时间：2012-11-28T20:41:38.543
> 
> 标签：actionscript-3, actionscript

这是一个从文本提要中提取数据并显示该提要中的股票值的脚本。当我测试电影时它工作得很好，但是当我尝试在网页中发布它时它不会在 IE 或 Chrome 中显示实时数据。我只是在使用默认的发布选项，我也在尝试在数字标牌播放器上使用它，该播放器本质上是在 IE 中呈现网页。

```
import flash.net.URLLoader;
import flash.net.URLRequest;

var loader:URLLoader = new URLLoader();
loader.addEventListener(Event.COMPLETE, onLoaded);

function onLoaded(e:Event):void{
    var rawRSS:String = e.target.data;
    var pattern:RegExp = /<TD.*?TD>/sg; 
    var pieces:Array = rawRSS.match(pattern);   
    var CH = pieces[2].split(">");
    var CHR = CH[1].split("<");
    var CHRW:String = String(CHR[0]);
    var CHRWT:String = CHRW.substr(0,5);

    stock_price.text = CHRWT;

    var loc:int = pieces[4].indexOf("+",0);
    var gain:String = String(pieces[4].charAt(loc));
    //trace(gain);

    if (gain == "+"){
        stock_price.textColor = 0x00CC33;
    }
    else {
        stock_price.textColor = 0xFF0000;
    }

}

loader.load(new URLRequest("http://www.nasdaq.com/aspxcontent/NasdaqRSS.aspx?data=quotes&symbol=CHRW")); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T21:14:41.020

查看您的最后一行代码。参数数据不应该直接附加到问号上吗？

顺便说一句，我还注意到如果以编程方式附加到 DOM，IE8 和以前的版本不接受事件处理程序。但我想，你已经在不同的浏览器中测试过了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T22:28:54.877

如果您从 Web 服务器运行您的 swf，则不允许从另一个域获取数据，除非该域允许它在 crossdomain.xml 文件中，而[纳斯达克](http://www.nasdaq.com/crossdomain.xml)则不允许。

# playframework - 使用 LaTex 播放框架

> ID：13614014
> 
> 赞同：0
> 
> 时间：2012-11-28T20:41:51.097
> 
> 标签：playframework, latex

> **可能重复：**
> [模板中的 Latex 指令导致“Unicode 转义错误”](https://stackoverflow.com/questions/13489262/latex-directives-in-template-are-causing-error-in-unicode-escape)

我试图将 Latex 添加到播放应用程序中的视图中。你能给我一些方向吗？谢谢

# mysql - MySQL 喜欢不喜欢`\`？

> ID：13614016
> 
> 赞同：0
> 
> 时间：2012-11-28T20:41:56.097
> 
> 标签：mysql

我有一个字符串列表。它们都是绝对路径（目前没有相对路径）并且都以`\`（windows文件夹分隔符）开头

当我使用类似的方式进行查询时

```
select * from list where name like @foo 
```

和 foo 是

```
@"\a" + % 
```

我没有得到任何结果。如果我使用`%\a%`我会得到结果。然后我尝试使用 mysql 命令行并写了

```
where name like '\a%' limit 10; 
```

除非我写，否则我在那里也没有得到任何结果`%\a%`。为什么不喜欢`\`？我如何有一个字符串开头`\a`？我不想`\random\apples\file`在我期待的时候得到`\apples\file`

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-28T20:43:49.870

因为`\`是转义符。

尝试将其替换`\\`为

[特殊字符转义序列](http://dev.mysql.com/doc/refman/5.0/en/string-literals.html#character-escape-sequences)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T20:45:39.390

试试这个

\ 是转义下一个符号的符号.. 有时用于转义 \" 引号或反斜杠本身

> 其中名称如 '\\a%' 限制为 10；

# ruby-on-rails-3 - form_for 带有条件的标签 + rails3

> ID：13614023
> 
> 赞同：0
> 
> 时间：2012-11-28T20:42:45.460
> 
> 标签：ruby-on-rails-3, form-for

我有一个 form_for 标签，我想`:remote => true`根据用户状态启用它的选项

```
if the current user is not an admin I want the form to be :remote => true
if the current user is an admin I want the form to be a default form 
```

这就是我想出的，它现在不起作用；（

```
<%= form_for @school, ((:remote => true) unless current_user.admin?) ,  :html => { :class => 'form-horizontal' } do |f| %> 
```

有人能帮我吗

我上线了

```
ruby 1.9
Rails 3.2.x 
```

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T21:04:26.170

如何使用具有以下内容的 Helper 方法

```
def form_remote_or_not(user, object, &block)
    if user.admin?
        form_for object, :remote => true, &block
    else
        form_for object, &block
    end
end 
```

至于您的视图文件；`<%= form_remote_or_not(current_user, @school) do |f| %>`

# jdbc - 如何在同一个应用程序中使用不同的事务隔离级别？

> ID：13614029
> 
> 赞同：0
> 
> 时间：2012-11-28T20:43:18.837
> 
> 标签：jdbc, transaction-isolation

是否可以在同一个应用程序中使用不同的事务隔离级别？例如，我想将 READ_COMMITTED 用于简单的客户端请求，将 READ_REPEATABLE 用于更复杂的请求。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T20:43:18.837

我浪费了数周时间试图弄清楚这一点，所以我发布了我学到的东西的记录。欢迎补充答案。

虽然在技术上可以使用[Connection.setTransactionIsolation(int)](http://docs.oracle.com/javase/7/docs/api/java/sql/Connection.html#setTransactionIsolation%28int%29)更改事务隔离级别，但我强烈建议**不**要这样做。

*   事务隔离必须在事务开始之前设置。否则会导致“实现定义的”行为。
*   为了检测适当的事务隔离，您必须弄清楚您调用的任何方法（以及*它们*调用的任何方法）所需的事务隔离。
*   这很快演变成一场维护噩梦，您在努力跟踪每种方法的正确隔离级别。
*   如果您尝试在运行时以编程方式查询正确的隔离级别（通过询问您的依赖项他们需要什么隔离级别），您最终会得到非常丑陋的代码，并且再次成为维护的噩梦。

相反，我建议硬着头皮在整个应用程序中选择一个事务隔离级别。从安全的东西开始，然后慢慢转向性能更高的隔离级别。

# wcf - 在 WCF 中使用 DataContract 代理

> ID：13614032
> 
> 赞同：0
> 
> 时间：2012-11-28T20:43:21.290
> 
> 标签：wcf, serialization, dto

因此，我创建了几个 WCF 服务。每个返回列表的某种类型的数据合约。但是，这些数据合约具有其他数据合约的列表属性。我正在尝试实现数据合同集合的延迟加载。

我的想法是在客户端实现一个类，该类继承自数据协定并重写集合属性，以便 setter 和 getter 方法调用服务并获取实际的集合项。

我的问题是：如何使基本通道返回实现数据契约的类而不是实际的数据契约？如何控制基本通道返回的内容？

我的服务客户端如下所示：

```
public class ServiceClient : BaseClient<IServiceClient> 
{
   public IList<DataObject> FindAll() 
   {
       // how to control what base.Channel.FindAll return during deserialization.
       return base.Channel.FindAll();
   }
} 
```

请注意，我不想做这样的事情：

```
public class ServiceClient : BaseClient<IServiceClient> 
{
   public IList<DataObject> FindAll() 
   {
       var dtos = base.Channel.FindAll();
       var dtoProxies = Mapper.Map<DataObject, DataObjectProxy>();

       return dtoProxies;
   }
} 
```

我想要一种方法，以便 WCF 自动返回`List<DataObject>`哪些元素实际上是 type `DataObjectProxy`。

关于如何做到这一点的任何建议？

谢谢！

**编辑：**示例 DataObject 类：

```
[DataContract]
public class DataObject 
{
   public virtual List<OtherDomainObject> SubItems { get; set; }
}

public class DataObjectProxy : DataObject 
{
   public override List<OtherDomainObject> SubItems 
   {
      get { // Custom way to retrieve collection... }
      set { // Etc.. }
   }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T21:45:01.717

首先，用 [DataContract] 属性装饰 DataObjectProxy，WCF 需要所有类型的显式合同标识 - 无论您以后要对它们做什么。然后，在要向客户端公开的数据协定类型的每个字段（在您的情况下为属性）上设置 [DataMember]。最后，在 DataObject 类上添加 [KnownType(typeof(DataObjectProxy))] 属性。KnownType 为客户端上的多态替换定义了给定基的所有子类型。这应该有效。

```
[DataContract]
[KnownType(typeof(DataObjectProxy))]
public class DataObject 
{
   [DataMember]
   public virtual List<OtherDomainObject> SubItems { get; set; }
}

[DataContract]
public class DataObjectProxy : DataObject 
{
   [DataMember]
   public override List<OtherDomainObject> SubItems 
   {
      get { // Custom way to retrieve collection... }
      set { // Etc.. }
  }
} 
```

# c - 文件描述符和文件有什么区别

> ID：13614040
> 
> 赞同：4
> 
> 时间：2012-11-28T20:44:14.027
> 
> 标签：c, linux

什么是fildes，在linux中，文件描述符和fildes有什么区别。例如，下面的 write 处理文件描述符

```
ssize_t write(int fd, const void *buf, size_t count); 
```

下面的 pwrite 处理 fildes

```
ssize_t pwrite(int fildes, const void *buf, size_t nbyte, off_t offset); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-28T20:47:29.093

这些只是参数名称。它们都引用文件描述符。

阅读这些功能的手册

```
man 2 write
man pwrite 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T20:47:46.460

通常在像这样的功能中

`foo(int a, int b);`或者`foo1(int x, int y);`

无需问什么是`a`什么，什么是`x`（只需查看声明）。所以只考虑类型，与类型关联的名称只是函数内部使用的参数列表中的标识符。

在您的情况下，`fd`和`fildes`都是文件描述符。

# java - 凌乱的for循环/if语句

> ID：13614041
> 
> 赞同：0
> 
> 时间：2012-11-28T20:44:16.033
> 
> 标签：java, if-statement, for-loop

我在做一个吃豆人游戏。以下代码用于鬼魂移动，它可以正常工作。但我必须包括另一张支票。问题是我总是破坏逻辑。

当前代码：

```
public void moveGhost(Tiles target) {
    if(specialIntersections()){
        direction = direction; //keeps going in the same direction
    }
    else{
        int oppDir;
        if(direction == UP){
            oppDir = DOWN;
    }
    else if(direction == DOWN){
        oppDir = UP;
    }
    else if(direction == LEFT){
        oppDir = RIGHT;
    }
    else{
        oppDir=LEFT;
    }

    double minDist = 10000.0;
    Tiles potentialNext;

    for(int i=0; i<4; i++){
        if(i!=oppDir){
            potentialNext = maze.nextTile(getCurrentPos(), i);
            if(!(potentialNext.wall()) && check(potentialNext)){
                if(calculateDistance(target, potentialNext) < minDist){
                   minDist = calculateDistance(target, potentialNext);
                   futureDirection = i;
                }
            }
        }
    }
}

changeDirection();
timer++;
increment();

x += xinc;
y += yinc;
tunnel(); 
```

}

我需要包括的另一项检查：

```
 //if the door is a wall (closed) the object cannot go through it
  if(DoorIsWall()){
if(!(potentialNext.wall()) && !(potentialNext.door())  && check(potentialNext)){ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T20:51:06.570

当我的条件开始变得不守规矩时，我通常会编写一个新方法：

```
if (isTileValid(potentialNext)) {
    // do stuff
}

private boolean isTileValid(TileObject someTile) {
    if (someTile.wall()) {
        return false;
    }
    if (someTile.door()) {
        return false;
    }
    if (! check(someTile)) {
        return false;
    }
    return true;
} 
```

# javascript - 检查多个变量的值以确保它们都匹配

> ID：13614042
> 
> 赞同：1
> 
> 时间：2012-11-28T20:44:18.140
> 
> 标签：javascript, variables, string-matching

如何有效地检查多个变量的值是否全部匹配？如果它们匹配，则以下函数应返回 true，否则返回 false：

```
function projectIsLocked (data) {
    if (data.ArchiveSnapshotID === data.CurrentSnapshotID === data.LiveSnapshotID) {
        return true;
    }
    return false;
} 
```

我以为我可以使用`if (data.ArchiveSnapshotID === data.CurrentSnapshotID === data.LiveSnapshotID)`，但它似乎不起作用。

一些简单的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T20:46:12.323

为什么不将它们全部推送到一个数组中。这样你可以使用尽可能多的。

```
function check_for_equal_array_elements(my_array){
  if (my_array.length == 1 || my_array.length == 0) {
     return true;
  }
  for (i=0;i<my_array.length;i++){
     if (i > 0 && my_array[i] !== my_array[i-1]) {
       return false;
     }
  }
  return true;
}

//Example:
var my_array = [];
my_array.push(5);
my_array.push(5);

// will alert "true"
alert("all elements equal? "+check_for_equal_array_elements(my_array));

my_array.push(6);
// will alert "false"
alert("all elements equal? "+check_for_equal_array_elements(my_array)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T20:50:32.217

如果只有 3 个比较，那么这应该足够了。

```
function projectIsLocked (data) {
    var archive = data.ArchiveSnapshotID;
    var current = data.CurrentSnapshotID;
    var live = data.LiveSnapshotID;

    return (archive === current && current === live)
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T20:50:56.207

这里的问题是，逻辑表达式的一部分被评估然后比较，因此 `data.ArchiveSnapshotID === data.CurrentSnapshotID`评估为“true”并`data.LiveSnapshotID`检查是否为 true，您可以在此处看到（`LiveSnapshotID`已更改为 boolean `true`）：

```
function projectIsLocked (data) {
    if (data.ArchiveSnapshotID === data.CurrentSnapshotID === data.LiveSnapshotID) {
        return true;
    }
    return false;
}

var data = { ArchiveSnapshotID: "foo", CurrentSnapshotID: "foo", LiveSnapshotID: true };
alert(projectIsLocked (data)); 
```

您可能想要使用类似这样的东西，它对于更多的属性是相当可扩展的。

```
function projectIsLocked (data) {
    var props = ["ArchiveSnapshotID", "CurrentSnapshotID", "LiveSnapshotID"];

    for (var i = 1; i < props.length; i++) 
    {
        if (data[props[i]] !== data[props[i - 1]])
            return false;
    }
    return true;
} 
```

# iphone - 为 iOS（iPhone 和 iPad）制作两个故事板

> ID：13614043
> 
> 赞同：5
> 
> 时间：2012-11-28T20:44:20.030
> 
> 标签：iphone, ios, xcode, ipad

是否可以只制作一个应用程序并在其中制作两个故事板，一个用于 iPhone，一个用于 iPad？我不喜欢在 iPad 上运行应用程序并单击 2x 按钮的想法。

我的想法是创建两个故事板并开设一个入门课程，以检查您使用的设备是 iPhone 还是 iPad，然后重定向到相应的故事板。我认为这是一个好主意，因为代码是相同的。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-29T04:10:21.363

创建两个不同的故事板并命名它们，以便轻松指定它们是哪个。然后单击允许您更改实际应用程序设置的文件。并将构建更改为`universal`，然后指定要使用的情节提要！

iphone和ipad有一个故事板设置

苹果手机

![在此处输入图像描述](../Images/34364e9cc7739c42f1fcba4678111997.png)

iPad

![在此处输入图像描述](../Images/75b93ed3f3e2daf7becc6911ee9087f1.png)

确保故事板的名称设置正确

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-28T23:30:23.007

即使您已经将应用程序设为非通用，只需将其更改为通用（目标-->摘要），然后创建一个新的 ipad 故事板并确保在目标-->摘要下设置了主 iphone 故事板和主 ipad 故事板到正确的故事板。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-28T23:53:41.443

我最近不得不在一个项目中这样做......所以首先你应该导航到你的项目目标，然后单击顶部栏中的摘要按钮，然后你会看到一个显示“iOS应用程序目标”的栏，你会看到一个下降带有标题的下拉菜单 设备选择通用选项。现在为 iPad 添加一个故事板。现在回到项目目标并向下滚动到“iPad 部署信息”部分，并在此处的文本字段中将新故事板设置为主故事板，您还可以添加 iPad 图标和启动图像。现在您已准备好创建通用应用程序！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-28T20:57:16.073

您是否尝试过创建新的 Universarl XCode 项目？如果您创建 Universal 项目，将默认创建两个 Storyboard（一个用于 iPhone，另一个用于 iPad）。我认为。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-06-29T10:24:58.903

它非常简单，只需执行应用程序，`universal`然后转到目标然后信息，然后添加主`storyborad`文件基本名称（iPad），然后在 iPhone 运行到其显示 iPhone 时构建并运行，当 iPad 运行时显示为 iPad。

# facebook - 是否可以在博客循环内的 Shopify 网站的博客页面上添加 Facebook 图标？

> ID：13614044
> 
> 赞同：1
> 
> 时间：2012-11-28T20:44:21.780
> 
> 标签：facebook, icons, blogs, shopify, liquid

我希望用户能够喜欢 Shopify 网站的博客页面上的单个文章。我在博客循环中添加了我的社交媒体图标。

**博客液体**

```
{% for article in blog.articles %}<!-- START ENTRY {{ forloop.index }} -->
<div id="post{{ article.id }}">

{{ article.content | strip_html | truncate: 40 }} <br/> <a href="{{ article.url}}">Read More</a>

{% assign description = article.title | escape | replace:' ','%20' %}
{% assign link = article.url %}
{% include 'social' %}

</div>
{% endfor %} 
```

**social.liquid 片段**

```
<div class="social-plugins">

<span class="twitter">
<a href="http://twitter.com/share"{% if template == 'product' or template == 'article' or template == 'blog' %} data-url="{{ shop.url }}{{ link }}"{% endif %} data-text="{% if template == 'product' %}{{ product.title | escape }} by {{ product.vendor | escape }}{% elsif template == 'blog' %}{{ social.title | escape }}{% else %}{{ page_title | escape }}{% endif %}" class="twitter-share-button" data-count="horizontal" data-via="bondiNYC">Tweet</a>
<script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>
</span>

<span class="facebook">
<iframe src="//www.facebook.com/plugins/like.php?href={{shop.url}}{{link}}&amp;send=false&amp;layout=button_count&amp;width=100&amp;show_faces=false&amp;action=like&amp;colorscheme=light&amp;font&amp;height=21" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:100px; height:21px;" allowTransparency="true"</iframe>
</span>

<span class="pinterest">
<a href="http://pinterest.com/pin/create/button/?url={{ shop.url }}{{ link }}&description={{ description }}&media={{src | escape}}" class="pin-it-button" count-layout="none">Pin It</a>
</span>

</div> 
```

如果我只输入 {{shop.url}}{{blog.url}}，则赞按钮有效，但当我添加 {{shop.url}}{{link}} 时则无效。{{link}} 是根据页面分配的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T02:18:29.543

在我的店里 - 我这样做是通过使用：

```
{{ shop.url }}{{ article.url }} 
```

这将返回要插入到 facebook/twitter/pinterest iframe 中的文章 URL。

注意：请务必检查代码是否正在`blog.liquid`页面上呈现。我这样做是在我的等价物`social.liquid`

# actionscript-3 - 如何在隐藏其他所有内容的同时播放 Movieclip？

> ID：13614045
> 
> 赞同：0
> 
> 时间：2012-11-28T20:44:25.303
> 
> 标签：actionscript-3

当使用 .play() 播放电影剪辑时，我该如何做到这一点？屏幕上的所有其他内容都被隐藏了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T20:49:52.603

有多种方法可以做到这一点，具体取决于您的代码布局方式。您可以将 MovieClip 移动到主显示列表的顶部并访问其他所有调用 otherItem.visible = false;

或者只是在影片剪辑后面放置一个空白背景，以便它覆盖所有内容。提供对您正在做的事情的更多见解，您将得到一个不太通用的答案。

# android - 无论类如何，应用程序上下文是否始终相同？

> ID：13614047
> 
> 赞同：5
> 
> 时间：2012-11-28T20:44:34.107
> 
> 标签：android, sqlite, broadcastreceiver

我是整个 Android 环境的新手，我通常有一些疑问，也许你可以考虑非常基础的知识和有点愚蠢。我会尽力解释我的疑问以及为什么我要让我理解。

我正在做一个应用程序，您可以在其中设置通知以提醒您想要的学者课程。我已经完成了一个扩展 BroadcastReceiver 的类，因此它可以在设备启动后重置所有警报。我有一个数据库，用于保存有关警报的信息：类、必须配置的时间等。我检索所有警报并将它们设置为 alarmManager：

```
intent = new Intent(ctxt.getApplicationContext(), Notificacion.class);
intent.putExtra("TAG", tag);
intent.putExtra("SUBJECT", cursor2.getString(0));
intent.putExtra("AULA", cursor2.getString(1));                  
displayIntent = PendingIntent.getBroadcast(ctxt, Integer.parseInt(tag), intent, PendingIntent.FLAG_UPDATE_CURRENT );               
alarmManager.setRepeating(AlarmManager.RTC_WAKEUP, calendar.getTimeInMillis(), AlarmManager.INTERVAL_DAY*7, displayIntent); 
```

好吧，我想这应该可以正常工作，直到这里。问题是，当您使用该应用程序并想要设置通知时，您是从“Schedule.class”类中进行的，因此意图将具有以下上下文：

```
Intent intent = new Intent(getApplicationContext(), Notification.class);
PendingIntent pend = PendingIntent.getBroadcast(this, Integer.parseInt(tag), intent, PendingIntent.FLAG_UPDATE_CURRENT); 
```

在应用程序中，您可以删除警报，您必须调用 alarmManager.cancel(pend) 才能执行此操作。所以我怀疑它是否能够取消它。

如果上下文不同，它将找不到与挂起意图的匹配项，因为它是根据我在 BroadCastReceiver (ctxt) 扩展中获得的上下文设置的，并且警报是根据我从 Schedule.class 获得的上下文设置的.

那么..应用程序上下文是否总是相同的？我知道设置上下文是为了向其他类提供有关正在发生的事情的信息，但我不确定 Intent 过滤器是否会区分上下文的给出位置。

先感谢您！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T22:01:50.900

Looking at the AlarmManager documentation for the cancel method you're using:

> [public void cancel (PendingIntent operation)](http://developer.android.com/reference/android/app/AlarmManager.html#cancel%28android.app.PendingIntent%29)
> 
> Added in API level 1
> 
> Remove any alarms with a matching Intent. Any alarm, of any type, whose Intent matches this one **(as defined by [filterEquals(Intent)](http://developer.android.com/reference/android/content/Intent.html#filterEquals%28android.content.Intent%29))**, will be canceled.

So, the Intent.filterEquals documentation says the following:

> [public boolean filterEquals (Intent other)](http://developer.android.com/reference/android/content/Intent.html#filterEquals%28android.content.Intent%29)
> 
> Added in API level 1
> 
> Determine if two intents are the same for the purposes of intent resolution (filtering). That is, **if their action, data, type, class, and categories are the same**. This does not compare any extra data included in the intents.

I can't think of any reason why the action, data, type, class, or category would be different from one explicit Intent to another (unless, obviously you went out of your way to change those things). The contexts do not appear to be in the criteria for the matching, so I think you can be fairly confident that it will be cancelled no matter which context was used to create it in the first place.

# go - Go：为什么 os.Getwd() 有时会因 EOF 而失败

> ID：13614048
> 
> 赞同：4
> 
> 时间：2012-11-28T20:44:35.823
> 
> 标签：go

```
package main
import "os"
import "fmt"

func main() {
    _, err := os.Getwd()
    if err != nil {
        fmt.Println(err)
    }
} 
```

这有时会打印 EOF 错误。有谁知道为什么？之前通常会发生一些 os.Chdir ，但这不会出错。

```
GOARCH="amd64"
GOBIN=""
GOCHAR="6"
GOEXE=""
GOGCCFLAGS="-g -O2 -fPIC -m64 -pthread -fno-common"
GOHOSTARCH="amd64"
GOHOSTOS="darwin"
GOOS="darwin"

go version go1.0.3 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T08:08:20.620

这是一个错误`os.Getwd`，在不支持`getwd`系统调用的平台上，当工作目录不再存在时，它会返回 EOF 作为错误。这是 OS X 上的可重复测试用例。

```
package main
import "os"
import "fmt"

const DIR = "/tmp/somedir"

func main() {
    os.Remove(DIR)
    if err := os.Mkdir(DIR, 0755); err != nil {
      fmt.Println(err)
      return
    }
    if err := os.Chdir(DIR); err != nil {
      fmt.Println(err)
      return
    }
    if err := os.Remove(DIR); err != nil {
      fmt.Println(err)
      return
    }
    wd, err := os.Getwd()
    fmt.Println("err:", err)
    fmt.Println("wd:", wd)
} 
```

输出：

```
err: EOF
wd: 
```

# c++ - 如何将两个类之间的重度依赖表示为子类化契约？

> ID：13614052
> 
> 赞同：1
> 
> 时间：2012-11-28T20:44:46.817
> 
> 标签：c++, templates, design-patterns, inheritance, relationship

我不知道如何表达两个将被子类化的类的依赖关系/关系。我认为一个例子可以在这里有所帮助：

假设我有两个班级，`Master`并且`Slave`. 该类`Master`有一些方法，例如`void use(Slave * s)`和`Slave * generateFrom(int a)`

```
class Master
{
  public:
    virtual void use(Slave * s) = 0;
    virtual Slave * generateFrom(int a) = 0;
};

class Slave
{
}; 
```

现在我想继承这两个类，但不想失去它们之间的关系：

```
ConcreteMasterA ma();
ConcreteSlaveA * sa = ma.generateFrom(1);
ConcreteMasterB mb();
mb.use(sa); // THIS SHALL NOT WORK

Master * m = new ConcreteMasterA();
Slave * s = m->generateFrom(1); //s should now be a ConcreteSlaveA
m->use(s); // THIS SHALL WORK 
```

有没有办法用 C++ 类/模板/什么来表达这种关系？

### 附加信息

也许我需要更具体：

我有`Arm`代表机械臂的类。机器人手臂的状态由一些参数（角度、距离）指定，并由类表示`JointVariableVector`

我想稍后使用另一个类来控制手臂，但是这个类只能使用`Arm`and导出的方法`JointVariableVector`。

`Arm`将被子类化以提供每个特定机器人手臂（例如 SCARA 或 KUKA）的正确功能，并且由于结构不同，我需要子类`JointVariableVector`（例如，一个子类只有 2 个角度，另一个子类有 3 个角度和一个距离）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T22:07:37.613

我会做这样的事情

```
class ConcreteMasterA:public Master
{
    typedef ConcreteSlaveA MySlaveType;
    public:
    virtual void use(Slave * s){
        MySlaveType* ms = dynamic_cast<MySlaveType*>(s);
        assert(ms); // or other type of error handling
    }

    virtual Slave * generateFrom(int a){
        return new MySlaveType();
    }
}; 
```

如果您想要更严格的测试，您可以使用

```
assert(typeid(s)==typeid(MySlaveType*)); 
```

在您的使用功能中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T21:00:24.663

您可以在包含创建它的 Master 的从属类中使用变量 Master。调用 use 时，与此值进行比较，并在值相等时接受。

```
class Slave {
private:
    Master * creator;

public:
    Slave(Master* master) : creator(Master) {};
    Master * getMaster() { return creator; }
}

class Master {
    Slave *generateForm(int) {
        return new Slave(this);
    }

    void use(Slave) {
        if (Slave.getMaster) == this) {
             do stuff;
        }
    }
} 
```

# android - Android/Java 使用 cipher.getOutputSize() "OutOfMemoryError" 分配 -byte 内存不足

> ID：13614062
> 
> 赞同：2
> 
> 时间：2012-11-28T20:45:17.377
> 
> 标签：android, arrays, out-of-memory, aes, bouncycastle

我在使用充气城堡的 Aes 中解密的功能有问题。

我有一个常规的加密/解密功能，但是太慢了。现在我正在尝试使用 BouncyCastle' Lib 中测试文件示例的部分代码来解决此问题。我写了这样的代码：

[http://www.java2s.com/Tutorial/Java/0490__Security/SymmetricencryptionexamplewithpaddingandCBCusingDESwiththeinitializationvectorinline.htm](http://www.java2s.com/Tutorial/Java/0490__Security/SymmetricencryptionexamplewithpaddingandCBCusingDESwiththeinitializationvectorinline.htm)

现在我收到一个错误

> “E/dalvikvm-heap(548)：52023154 字节分配内存不足。”
> 
> 原因：尝试分配 byte[] 纯文本时出现 java.lang.OutOfMemoryError。

我对大小为 1-2 MB 的文件没有问题，但在大于 2MB 的文件上是否存在此错误。

我对此一无所知，也没有在网上找到任何回应。你能帮助我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T21:47:26.187

我在这篇文章中找到了一个解决方案： [如何从命令行更改 android 模拟器 RAM 大小？](https://stackoverflow.com/questions/9322540/how-to-change-the-android-emulator-ram-size-from-command-line) 通过这次升级我的堆大小！感谢社区！

# ruby-on-rails - Rails：belongs_to multiple > 方法

> ID：13614063
> 
> 赞同：1
> 
> 时间：2012-11-28T20:45:19.250
> 
> 标签：ruby-on-rails, methods, table-relationships

我刚刚完成了 Michael Hartl Rails 教程。试图做我自己的东西。

我无法让 Rails 了解我正在尝试创建的关系。我会尽量简化这一点。一棵有树枝、树枝和树叶的树会很合适，但是......

我将以父子格式为例。所以自然我有用户，假设用户创建家庭。

所以：

```
Class User < ActiveRecord::Base

 has_many :families
 has_many :parents
 has_many :children

end

Class Family < ActiveRecord::Base

 belongs_to :user
 has_many :parents

end

Class Parent < ActiveRecord::Base

 belongs_to: :user
 belongs_to: :family
 has_many: :children

end

Class Child < ActiveRecord::Base

 belongs_to :user
 belongs_to :parent

end 
```

如您所见，我希望孩子属于属于家庭的父母，但孩子本身不属于家庭，除非通过父母。如果这不是一个比喻，但在这种特殊情况下是真实的，这很可悲。;)

我在父母下试过：

```
has_many :children, through: :parent 
```

和

```
has_many :children, through: :family 
```

但这没有用。

当我尝试使用时：

```
User.family.new 
```

或者

```
User.child.new 
```

...它说该方法不存在。我认为这意味着它不了解这些关系。

我究竟做错了什么？

如果它是相关的，那么现在家庭、父、子表中唯一的就是这些列：

```
 t.string :content
  t.integer :user_id 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T05:33:13.840

你没有这些方法：

```
User.family.new
User.child.new 
```

当您定义`has_many`关联时，您只需使用这些方法来创建关联的新对象：

```
collection.build(attributes = {}, …)
collection.create(attributes = {}) 
```

遵循 Rails 指南：

> 集合被作为第一个参数传递给 has_many 的符号替换

您可以查看这个[has_many 关联参考](http://guides.rubyonrails.org/association_basics.html#has_many-association-reference)以获取更多信息。因此，如果`User`要创建新的家庭或孩子，您需要使用以下方法：

```
user = User.create(name: "ABC") # create new user and save to database. 
user.families.build  # create new family belongs to user
user.children.build  # create new children belongs to user

user.families.create # create new family belongs to user and save it to database.
user.children.create # create new child belongs to user and save it to database. 
```

如果你想让孩子属于属于家庭的父母，你可以修改你的关联：

```
Class Family < ActiveRecord::Base

 belongs_to :user
 has_many :parents
 has_many :children, through: :parents # Get children through parents
end

Class Parent < ActiveRecord::Base

 belongs_to: :user
 belongs_to: :family
 has_many: :children

end

Class Child < ActiveRecord::Base

 belongs_to :user
 belongs_to :parent

end 
```

现在，您可以让所有孩子都属于属于一个家庭的父母（我假设家庭的 id = 1）：

```
 f = Family.find(1) # Find a family with id = 1
 f.children # Get all children in family. 
```

# javascript - 如何将 javascript 选框增加到网站的大小？

> ID：13614064
> 
> 赞同：2
> 
> 时间：2012-11-28T20:45:18.500
> 
> 标签：javascript, css, height, css-position, marquee

我的网站 (http://blogandthecity.net) 上有一个垂直的 javascript 字幕。我希望它卡在屏幕上。我认为它被称为“固定”。现在选框停在某个点，但我希望它是整个屏幕/网站的大小。

我认为有两种选择： **1.**尽可能长的选框（但是有些网页比其他网页长。我不知道如何才能使选框更长。我已经尝试了一些东西） **2.**定位固定的。（我试图在代码中输入“位置：固定”，但结果是选框不再滚动。所以运动停止了。选框也不适合屏幕......）

你知道我该如何解决这个问题吗？如果你需要css样式，我也会放在这里。

在代码下方（我排除了文本部分）：

```
 <script type="text/javascript" src="http://blogandthecity.net/js/marquee-packed.js" ></script>  
    <script type="text/javascript">  
    //create instance and call method horizontal for horizontal scrolling  
   var horizontal = new marquee("marquee").horizontal(  
   {  
    step:1, //how many pixels to move per interval (default: 1)  
    interval: 40, //how often to move pixels in miliseconds (default: 10)  
    stop_on_hover: true, //should marquee stop on mouse hover (default: true)  
    backwards: false, //rotate elements in opposite direction  
}); 
```

```
 <script type="text/javascript">  
     //create instance and call method horizontal for horizontal scrolling  
    var horizontal = new marquee("marquee2").horizontal(  
{  
    step:1, //how many pixels to move per interval (default: 1)  
    interval: 40, //how often to move pixels in miliseconds (default: 10)  
    stop_on_hover: true, //should marquee stop on mouse hover (default: true)  
    backwards: false, //rotate elements in opposite direction  
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T22:44:44.703

它被称为位置：固定；在您的选框向下滚动并全屏显示的 CSS 下方。您可能需要使用 jQuery，因为它们是内联样式（或修改 html？）

```
#marquee, #marquee2 {
position:fixed;
}

#marquee {
margin-top:140px;
}

#marquee2 {
margin-left:-520px;
} 
```

# java - 方法简单说明，我的java生锈了

> ID：13614065
> 
> 赞同：-7
> 
> 时间：2012-11-28T20:45:24.930
> 
> 标签：java

谁能给我这个方法和任何问题的简要解释。我认为它是输入少于 5 个单词的行并在制表符、换行符等上拆分行，然后进行比较以查找输入行中单词的重复。

```
public static void findNeedles(String haystack, String[] needles){
  if(needles.length > 5){
      System.err.println("Too many words!");
  }

  else{
      int[] countArray = new int[needles.length];
      for(int i = 0; i < needles.length; i++){
          String[] words = haystack.split("[ \"\'\t\n\b\f\r]", 0);
          for(int j = 0; j < words.length; j++){
              if(words[j].compareTo(needles[i]) == 0){
                  countArray[i]++;
        }
    }
      }
      for (int j = 0; j < needles.length; j++) {
          System.out.println(needls[j] + ": " + countArray[j]);
      }
  }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T20:56:15.500

您的函数有两个参数，`haystack`一个字符串和`needles`一个字符串数组。

它首先检查 的大小`needles`是否大于 5。如果是，则打印“错误”并随后退出。

如果不是，它会将`haystack`字符串拆分为多个字符（包括单引号和双引号、制表符、换行符、单词边界、换页符和回车符）到一个名为`words`.

每个“针”（阵列的元素`needles`）与阵列的每个元素进行比较`words`，如果遇到“针”作为`words`阵列的元素，则相应针的“计数器”递增。

搜索后，每根针都会显示出来，以及它在大海捞针中出现的次数。

然后函数退出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T20:51:57.337

它需要两个输入，一个字符串和一个最多包含 5 个字符串的数组。

它查看字符串，将每个单词与数组中的每个单词进行比较，并计算匹配项。

它打印出在字符串中找到数组中每个单词的次数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T20:56:27.903

该方法计算“干草堆”文本中“针”字的数量，最多可查找 5 个字。

您可以改进的一件事是将文本的拆分移动到外循环之外。

另一种可能性是通过使用针作为分隔符来拆分干草堆，从而为您`count + 1`提供文本片段，从而完全摆脱内部循环。

# ruby-on-rails - 这些方法是如何添加到我的课程中的？

> ID：13614069
> 
> 赞同：2
> 
> 时间：2012-11-28T20:45:44.840
> 
> 标签：ruby-on-rails, ruby, rspec-rails

我的 Writer 模型类上没有“posted_posts”或“rejected_posts”属性。但是，使用此 SQL：

```
posts = self.posts.select("sum(case when state = 'posted' then 1 else 0 end) as posted_posts, sum(case when state = 'rejected' then 1 else 0 end) as rejected_posts") 
```

我可以访问 Writer 实例上的那些“属性”。但是，当我使用 RSpec 时，我不想进行此查询，但是我无法设置 Writer 实例的这些属性，因为它认为我正在调用一个方法：

```
writer.rejected_posts = 8 
```

上面的行导致“未定义的方法'rejected_posts'”

为了“模拟”这些属性，我这样做了：

```
describe "performance_score" do
    it "should return a score based on the posted_posts and rejected_posts algorithm" do
      class Writer
        attr_accessor :posted_posts, :rejected_posts
      end
      writer = Factory(:writer)
      writer.rejected_posts = 8
      writer.posted_posts = 2
      writer.performance_score.should == 80
    end
  end 
```

我的主要问题是如何将这些方法添加到类中。创建一个新的 Writer 类如何知道与我的 writer 工厂“同步”？我以为我正在为这个测试创建一个新的 Writer 类，但奇怪的是我仍然可以访问我的 writer 工厂的其他属性。希望这是有道理的，谢谢。

另外，有没有其他人在测试中做过类似的事情，这是处理这种情况的最佳方法吗？如果您尝试设置一个不存在的属性，它会像在 JavaScript 中那样创建它，那就太好了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T21:52:42.963

从您的选择查询返回的东西可能不是真正的`Writer`模型。它可能是一个`ActiveRecord::Relation`. 为了提供您在 SQL 语句中分配值的方法，它可能正在实现`method_missing`并检查 AREL 的某种内部哈希设置。

对于模拟测试，你所做的肯定会奏效。另一种选择是使用`stub`.

```
it "should return a score based on the posted_posts and rejected_posts algorithm" do
  writer = Factory(:writer)
  writer.stub(:rejected_posts => 8)
  writer.stub(:posted_posts => 2)
  writer.performance_score.should == 80
end 
```

# objective-c - 检测到“多任务栏”被触发

> ID：13614081
> 
> 赞同：0
> 
> 时间：2012-11-28T20:46:28.410
> 
> 标签：objective-c, ios, ios5, ios6

有什么方法可以检测到“多任务栏”（按两次主页按钮）被触发了吗？

我认为应该有一些通知告诉 UIView 视口（或类似的东西）被修改，这是最简单/不太复杂的解决方案吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T21:02:16.130

没有办法检测出最近使用的应用程序列表。您的应用程序将被通知它不再处于活动状态，但在许多其他情况下也会发生这种情况。

# javascript - 在命名空间中使用 jQuery 的 filter() 时导致这些 JavaScript 错误的原因是什么？

> ID：13614083
> 
> 赞同：1
> 
> 时间：2012-11-28T20:46:34.930
> 
> 标签：javascript, jquery, regex, filter

> **可能重复：**
> [SyntaxError: Unexpected token ILLEGAL](https://stackoverflow.com/questions/12719859/syntaxerror-unexpected-token-illegal)

有人能告诉我为什么会发生这些错误以及如何解决这些错误吗？

```
/*global $:false */

Blah.BlahBlah = {
  findLinks : function () {
    "use strict";

    $('a').filter(function () {
      return !(/https?:\/\/[^\/]*xyz.*/i.test($(this).attr('href')));
    }).text("***");
  ​}
}; 
```

在 JSHint 中抛出这些错误：

*   第 10 行：​} 意外的“​”。
*   第 11 行：}; 期望 '}' 匹配第 3 行中的 '{'，而看到的是 ';'。
*   第 11 行：}; 缺少分号。

Chrome 控制台显示此错误：

*   Uncaught SyntaxError: Unexpected token ILLEGAL

但是，在封装的匿名函数中使用此代码 ( [JSFiddle](http://jsfiddle.net/dgy6T/) ) 不会引发错误：

```
/*global $:false */

(function() {

  "use strict";

  $('a').filter(function() {
    return !(/https?:\/\/[^\/]*xyz.*/i.test($(this).attr('href')));
  }).text("***");

}()); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T20:49:47.860

我将您的第一个片段粘贴到 jsbin 中，我在倒数第二个右大括号之前看到了一个奇怪的字符`}`......可能是一个通常不可打印的字符？

# ruby-on-rails - rabl 有两个我想以不同方式命名的子项

> ID：13614087
> 
> 赞同：1
> 
> 时间：2012-11-28T20:46:59.923
> 
> 标签：ruby-on-rails, ruby-on-rails-3.1, rabl

我有一个奇怪的关系，其中有一个 car_item 和 part_item 的组合，它们都是 item 类型，我的 rabl 看起来像这样：

```
object @l
attributes :id, :car_item, :part_item 
```

如果我做这样的事情（只返回一组属性）：

```
child :car_item do
  attributes :id, :header, :detail
end 
```

它是：

```
"item":{
  "id":24,
  "header":"my header",
  "detail":"my detail"

} 
```

我想要这样的事情：

```
child :car_item as :car_item do
  attributes :id, :header, :detail
end

child :part_item as :part_item do
  attributes :id, :header, :detail
end 
```

我该怎么做？

提前谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:04:02.473

看起来这样做。哦...

```
child :car_item => "car_item" do
  attributes :id, :header, :detail
end 
```

# java - 致命崩溃：焦点搜索返回了无法获得焦点的视图

> ID：13614101
> 
> 赞同：55
> 
> 时间：2012-11-28T20:47:51.997
> 
> 标签：java, android, illegalstateexception

当我在 EditText 中键入内容时，我的应用程序不断崩溃，但这并不总是仅在某些情况下发生。我在装有 Android 4.0.4 (ICS) 的三星 Galaxy Tab 2 10.1 WiFI 和 3G (GT-P5100) 上运行我的应用程序。我使用股票键盘。

这是我的日志：

```
11-28 21:43:01.007: E/AndroidRuntime(15540): java.lang.IllegalStateException: focus search returned a view that wasn't able to take focus!
11-28 21:43:01.007: E/AndroidRuntime(15540):    at android.widget.TextView.onKeyUp(TextView.java:5833)
11-28 21:43:01.007: E/AndroidRuntime(15540):    at android.view.KeyEvent.dispatch(KeyEvent.java:2659)
11-28 21:43:01.007: E/AndroidRuntime(15540):    at android.view.View.dispatchKeyEvent(View.java:5547)
11-28 21:43:01.007: E/AndroidRuntime(15540):    at android.view.ViewGroup.dispatchKeyEvent(ViewGroup.java:1246)
11-28 21:43:01.007: E/AndroidRuntime(15540):    at android.view.ViewGroup.dispatchKeyEvent(ViewGroup.java:1246)
11-28 21:43:01.007: E/AndroidRuntime(15540):    at android.view.ViewGroup.dispatchKeyEvent(ViewGroup.java:1246)
11-28 21:43:01.007: E/AndroidRuntime(15540):    at android.view.ViewGroup.dispatchKeyEvent(ViewGroup.java:1246)
11-28 21:43:01.007: E/AndroidRuntime(15540):    at android.view.ViewGroup.dispatchKeyEvent(ViewGroup.java:1246)
11-28 21:43:01.007: E/AndroidRuntime(15540):    at android.view.ViewGroup.dispatchKeyEvent(ViewGroup.java:1246)
11-28 21:43:01.007: E/AndroidRuntime(15540):    at com.android.internal.policy.impl.PhoneWindow$DecorView.superDispatchKeyEvent(PhoneWindow.java:2027)
11-28 21:43:01.007: E/AndroidRuntime(15540):    at com.android.internal.policy.impl.PhoneWindow.superDispatchKeyEvent(PhoneWindow.java:1388)
11-28 21:43:01.007: E/AndroidRuntime(15540):    at android.app.Activity.dispatchKeyEvent(Activity.java:2324)
11-28 21:43:01.007: E/AndroidRuntime(15540):    at com.android.internal.policy.impl.PhoneWindow$DecorView.dispatchKeyEvent(PhoneWindow.java:1954)
11-28 21:43:01.007: E/AndroidRuntime(15540):    at android.view.ViewRootImpl.deliverKeyEventPostIme(ViewRootImpl.java:3360)
11-28 21:43:01.007: E/AndroidRuntime(15540):    at android.view.ViewRootImpl.handleMessage(ViewRootImpl.java:2618)
11-28 21:43:01.007: E/AndroidRuntime(15540):    at android.os.Handler.dispatchMessage(Handler.java:99)
11-28 21:43:01.007: E/AndroidRuntime(15540):    at android.os.Looper.loop(Looper.java:137)
11-28 21:43:01.007: E/AndroidRuntime(15540):    at android.app.ActivityThread.main(ActivityThread.java:4514)
11-28 21:43:01.007: E/AndroidRuntime(15540):    at java.lang.reflect.Method.invokeNative(Native Method)
11-28 21:43:01.007: E/AndroidRuntime(15540):    at java.lang.reflect.Method.invoke(Method.java:511)
11-28 21:43:01.007: E/AndroidRuntime(15540):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:790)
11-28 21:43:01.007: E/AndroidRuntime(15540):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:557)
11-28 21:43:01.007: E/AndroidRuntime(15540):    at dalvik.system.NativeStart.main(Native Method) 
```

这是我的编辑文本之一：

```
 <EditText
    android:id="@+id/input_ftu_position_other"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_marginLeft="64dp"
    android:ems="20"
    android:inputType="text" /> 
```

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2017-12-27T11:44:26.513

当 ImeOptions 设置为`EditorInfo.IME_ACTION_NEXT`或时会发生此错误`EditorInfo.IME_ACTION_PREVIOUS`。虽然该视图的父级不可聚焦，或者下一个找到的焦点对象不可聚焦。

它调用查找应该快速跳转到的下一个焦点项目，但它不存在或不可聚焦，它会引发此错误。如果下一个被隐藏因此无法聚焦，或者父级实际上无法处理 findFocus() 调用并返回 null，则会发生这种情况。

因此，解决方案相当容易。在这种情况下，不要将其设置为 IME_ACTION。如果您不能快速从文本字段跳转到文本字段，那么要么使该操作可行，要么将操作切换为 DONE。

```
edittext.setImeOptions(EditorInfo.IME_ACTION_DONE); 
```

请注意代码中违规位之前的注释：

> 这是一些默认操作的处理。请注意，为了向后兼容，如果没有给出明确的 ime 选项，我们不会执行此默认处理，而是将其转换为应用程序可能期望的正常输入键代码。

如果你设置了 edittext 类型或者你给出了一个在功能上没有错误的显式 IME，它就不会这样做。或者有一个可以关注下一个或其他任何东西的父对象。它只是后备位中的遗留代码，有时可能没有给定的操作。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2018-03-22T16:04:51.713

以前的答案都不适合我。我在 recyclerview 中有 editText，而下一个 editText 不在视图中时无法获得焦点。

我检查了问题的原因，它在 TextView 类中是这样的：

```
 // This is the handling for some default action.
        // Note that for backwards compatibility we don't do this
        // default handling if explicit ime options have not been given,
        // instead turning this into the normal enter key codes that an
        // app may be expecting.
        if (actionCode == EditorInfo.IME_ACTION_NEXT) {
            View view = focusSearch(FOCUS_FORWARD);
            if (view != null) {
                if (!view.requestFocus(FOCUS_FORWARD)) {
                    throw new IllegalStateException("focus search returned a view "
                            + "that wasn't able to take focus!");
                }
            }
            return;

        } 
```

我更新了我的 EditText 以侦听任何编辑器操作并执行此操作：

```
 companyNameET.setOnEditorActionListener(new TextView.OnEditorActionListener() {
        @Override
        public boolean onEditorAction(TextView textView, int actionId, KeyEvent event) {
            if (actionId == EditorInfo.IME_ACTION_NEXT) {
                View view = textView.focusSearch(FOCUS_FORWARD);
                if (view != null) {
                    if (!view.requestFocus(FOCUS_FORWARD)) {
                        return true;
                    }
                }
               return false;
            } 
            return false;
        }
    }); 
```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2013-01-07T02:37:56.917

我遇到了同样的崩溃，虽然这听起来不像是确切的情况，但也许这仍然会有所帮助：

我有两个 EditText 框。底部是顶部的 Next Focus Down。在某些情况下，我会隐藏底部框，因此当我从顶部框按键盘上的下一步时，它会尝试转到底部框，但由于它被隐藏而会崩溃。我通过将底部框（另一个 EditText 的 Next Down Focus 的目标）设置为不可聚焦来解决此问题：

```
 EditText inputBox = (EditText)findViewById(R.id.Bottom_Box);
    inputBox.setFocusable(false); 
```

我希望这有帮助。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-08-03T10:12:45.547

我有另一个解决方案，跟踪 TextView 源代码并匹配您提供的错误日志

文本视图.java：

```
if (!hasOnClickListeners()) {
    View v = focusSearch(FOCUS_DOWN);

    if (v != null) {
        if (!v.requestFocus(FOCUS_DOWN)) {
            throw new IllegalStateException(
                    "focus search returned a view " +
                    "that wasn't able to take focus!");
        }
    }
} 
```

因此，我认为您可以给 View.OnClickListener 以避免发生错误。

例如：textView.setOnClickListener(new OnClickListener);

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2022-01-13T06:22:54.373

只需在您的编辑文本中添加以下属性。 **android:imeOptions="actionDone"**

```
<EditText
    android:id="@+id/input_ftu_position_other"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_marginLeft="64dp"
    android:ems="20"
    android:inputType="text" 
    android:imeOptions="actionDone"
/> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-05-16T11:34:31.330

我遇到了这个问题并像这样修复它：

```
public void setEditable(boolean flag) {
    mEditText.setFocusableInTouchMode(flag);
    mEditText.setFocusable(flag);
    mEditText.setClickable(flag);
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-03-08T10:53:03.860

发生这种情况的一个原因是当您的 EditText 有一个禁用的视图指定为`nextFocusDown`.

# jquery - bPopup 不会回发

> ID：13614104
> 
> 赞同：0
> 
> 时间：2012-11-28T20:48:01.230
> 
> 标签：jquery, postback, bpopup

我有 bPopup，它打开一个带有文本框和发送按钮的 div。

但是，当我单击发送按钮时，什么也没有发生。单击不会引发回发事件。有谁知道为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-18T06:42:31.133

如果您仍然需要，这是您的答案...

此行应该在您的 jQuery 区域中：appendTo: 'form'

它记录在 bPopup 页面上，但并不太明显。

转到此页面： [bPopup 文档](http://dinbror.dk/blog/bpopup/comment-page-9/#Options)

并搜索“ASP.NET”。

希望这可以帮助！我遇到了同样的问题，花了 3 个小时才发现这个修复。

# jquery - 使用 CSS3 动画 jQuery 排序的 div

> ID：13614106
> 
> 赞同：2
> 
> 时间：2012-11-28T20:48:05.570
> 
> 标签：jquery, css

我正在使用 jQuery 对 div 进行排序，并希望将 css3 过渡动画应用于 div 位置过渡。

不幸的是，css3 过渡动画不起作用，我试图找出原因：

这是一个工作示例：[jsFiddle](http://jsfiddle.net/CfvsS/)

```
<!DOCTYPE html> 
<html lang="en"> 
<head> 
<title>Test</title> 
<link rel='stylesheet' href='http://code.jquery.com/ui/1.9.2/themes/base/jquery-ui.css' type='text/css' media='screen' />
<script type='text/javascript' src='http://code.jquery.com/jquery-1.8.3.js'></script>
<script type='text/javascript' src='http://code.jquery.com/ui/1.9.2/jquery-ui.js'></script>
<style>
.gallery {
  background-color: black;
}

.imgitem {
  width: 40px;
  height: 40px;
  background-color: blue;
  margin-bottom: 10px;
  overflow: hidden;
  background-color: blue;
  position: relative;
}

.imgitem {
  -webkit-transition: all 1s ease-in-out;
  -moz-transition: all 1s ease-in-out;
  -o-transition: all 1s ease-in-out;
  transition: all 1s ease-in-out;
}
</style>
</head> 
<body>
<button id="chrank">Sort</button>
<div class="gallery">
  <div class="imgitem" style="background-color: red;"><div class="pop">6</div></div>
  <div class="imgitem" style="background-color: blue;"><div class="pop">4</div></div>
  <div class="imgitem" style="background-color: green;"><div class="pop">8</div></div>
  <div class="imgitem" style="background-color: brown;"><div class="pop">1</div></div>
  <div class="imgitem" style="background-color: magenta;"><div class="pop">3</div></div>
  <div class="imgitem" style="background-color: grey;"><div class="pop">5</div></div>
  <div class="imgitem" style="background-color: pink;"><div class="pop">4</div></div>
  <div class="imgitem" style="background-color: navy;"><div class="pop">7</div></div>
  <div class="imgitem" style="background-color: yellow;"><div class="pop">9</div></div>
</div>

<script>
    $('.gallery').sortable({ disable: true });

    function doSort()
    {
        $('.gallery').sortable({ disable: true });
        $('.gallery').sortable('refresh');
        $('.gallery .imgitem').sort(sortAscending).appendTo('.gallery');
    }

    function sortAscending(a, b) {
        return $(a).find(".pop").text() > $(b).find(".pop").text() ? 1 : -1;
    };

    $("#chrank").live("click", function(){
      doSort();
    });
</script>

</body> 
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:04:04.917

首先，CSS 过渡有效。如果您打开开发工具并向`.imgitem`元素添加 CSS 位置（如`style="position: relative, top: 20px"`），您会注意到过渡**效果很好！**

我认为它不影响的原因`dvi.gallery`是因为`doSort()`不改变元素的实际位置。它只需要所有集合，按 ACS 排序，然后将*“排序堆”*放入`dvi.gallery`

# c# - WCF 服务超时，然后执行操作？

> ID：13614108
> 
> 赞同：2
> 
> 时间：2012-11-28T20:48:17.800
> 
> 标签：c#, asp.net-mvc, wcf

好的，我有一个 WCF 服务，它的行为非常尴尬。问题是，当我调用服务方法时，如下所示：

```
using (var wcf = new Wcf<IDroneService>("http://test.group.com/DroneService.svc"))
{
    wcf.Channel.StartLoadTest(scenario);
} 
```

直到请求在一分钟后超时之前什么都没有发生，但是只有在抛出异常之后，WCF 服务（托管在 IIS 中）才会启动，也就是说，实际加载它的程序集，并运行 Application_Start，实例化该服务服务器端的端点等，它继续***正确接收请求并执行它***。但是这只发生在请求超时并且抛出异常之后**。**

这是我配置客户端和服务器绑定的方式：

```
public class WcfConfigurator
{
    public Binding GetBinding()
    {
        var basic = new BasicHttpBinding
        {
            MaxBufferSize = int.MaxValue,
            MaxBufferPoolSize = int.MaxValue,
            MaxReceivedMessageSize = int.MaxValue,
            TransferMode = TransferMode.Streamed,
            ReceiveTimeout = TimeSpan.FromSeconds(30),
            ReaderQuotas =
            {
                MaxDepth = int.MaxValue,
                MaxStringContentLength = int.MaxValue,
                MaxArrayLength = int.MaxValue,
                MaxBytesPerRead = int.MaxValue,
                MaxNameTableCharCount = int.MaxValue
            }
        };
        return basic;
    }

    public void ConfigureBehavior(ServiceEndpoint endpoint)
    {
        foreach (OperationDescription op in endpoint.Contract.Operations)
        {
            var dataContractBehavior = op.Behaviors.Find<DataContractSerializerOperationBehavior>();
            if (dataContractBehavior != null)
            {
                dataContractBehavior.MaxItemsInObjectGraph = int.MaxValue;
            }
        }
    }

    public void ConfigureBehavior(KeyedByTypeCollection<IServiceBehavior> behaviors)
    {
        var serviceDebugBehavior = behaviors.Find<ServiceDebugBehavior>();
        if (serviceDebugBehavior != null)
        {
            serviceDebugBehavior.IncludeExceptionDetailInFaults = Config.Wcf.ExceptionDetails;
        }
    }
} 
```

我在服务器端使用相同的编程配置来构建端点。这个问题只出现在大信封上，对于较小的信封，这不是问题。

我在 Wcf 通道的配置中遗漏了什么吗？`Wcf<T>`只是一个包装`ChannelFactory.CreateChannel`; 在 WCF 服务器上，我也使用 Windsor WcfIntegration 工具以编程方式对其进行配置。像这样：

```
public override ServiceHostBase CreateServiceHost(string constructorString, Uri[] baseAddresses)
{
    ServiceHostBase serviceHost = base.CreateServiceHost(constructorString, baseAddresses);
    return ConfiguredServiceHost(serviceHost);
}

private T ConfiguredServiceHost<T>(T serviceHost) where T : ServiceHostBase
{
    serviceHost.AddDefaultEndpoints();

    wcfConfigurator.ConfigureBehavior(serviceHost.Description.Behaviors);

    foreach (ServiceEndpoint endpoint in serviceHost.Description.Endpoints)
    {
        endpoint.Binding = wcfConfigurator.GetBinding();
        wcfConfigurator.ConfigureBehavior(endpoint);
    }
    return serviceHost;
} 
```

虽然我不认为这是服务器端问题（至少到目前为止不是），因为就像我说的那样，如果信封太大，WCF 服务器的符号甚至不会加载（直到请求超时，并且无论如何都已处理）。

有没有人遇到过这个奇怪的问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T21:12:58.490

根据我使用 WCF 的经验 - WCF 错误很难预测和诊断，需要深入调查并启用大量日志记录和 WCF 跟踪。我觉得客户端/服务器服务超时存在一些错误配置。所以安装最新版本的 Fiddler，看看发生了什么，发送了哪些请求，是否发送了响应。还可以使用 启用 WCF 跟踪`switchLevel="All"`，在大多数情况下，WCF 跟踪日志会明确指出您的问题。

你提到1分钟...

[WCF 中的超时及其默认值](http://blogs.msdn.com/b/hongmeig/archive/2010/03/06/timeouts-in-wcf-and-their-default-values.aspx)

> 这些是最著名的超时。`SendTimeout`, `ReceiveTimeout`,`OpenTimeout`和`CloseTimeout`. 它们可以通过配置或绑定上的代码轻松设置。这些的默认值为**1 分钟**

尝试显式增加其值，但首先我建议您了解问题所在，为什么会出现，因为 1 分钟建立连接就足够了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T09:16:24.860

我之前在使用 WCF 时也遇到过类似的问题，这导致我在使用服务时使用了 ChannelFactory。我知道它不能解释你的错误，但也许值得一试。我是这样做的：

```
internal static class ServiceObjects
{
    public static ISomeService SomeSVC { get { return GetSomeServiceClient(); }

    private static BasicHttpBinding _Binding = new BasicHttpBinding("SomeBasicHttpBindingEndpoint"); 
    private static EndpointAddress _Endpoint = new EndpointAddress(new Uri("http://test.helloworld.com/SomeService.svc"));

    private static IDocManagerService GetDocServiceClient()
    {
        ChannelFactory<ISomeService> _someSvcFactory = new ChannelFactory<ISomeService>(_Binding, _Endpoint);

        foreach (OperationDescription op in _someSvcFactory.Endpoint.Contract.Operations)
        {
            DataContractSerializerOperationBehavior _dataContractBehavior = op.Behaviors.Find<DataContractSerializerOperationBehavior>() as DataContractSerializerOperationBehavior;

            if (_dataContractBehavior != null)
            {
                _dataContractBehavior.MaxItemsInObjectGraph = int.MaxValue;
            }
        }

        return _someSvcFactory.CreateChannel();
    }
} 
```

并使用服务：

```
ServiceObjects.SomeSVC.SomeMethod() 
```

# android - 拦截 Android Gmail SSL 连接

> ID：13614109
> 
> 赞同：0
> 
> 时间：2012-11-28T20:48:21.387
> 
> 标签：android, ssl, gmail, fiddler

是否可以通过我自己的 HTTP 代理路由 android gmail 应用程序流量？

我知道我可以在安卓手机上安装证书，但我不确定 gmail 应用程序是否有硬编码的证书信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T19:48:12.227

通过更改 wi-fi 网络上的代理设置，我能够将 Fiddler 与 Android ICS 一起使用

# javascript - 使用带有固定位置标题的 scrollIntoView

> ID：13614112
> 
> 赞同：97
> 
> 时间：2012-11-28T20:48:27.083
> 
> 标签：javascript, twitter-bootstrap

我有一个标头设置为`position: fixed`. 在我的一个页面上，我使用`scrollIntoView(true)`了一个元素。我的问题是，当`scrollIntoView`被调用时，元素被定位在标题下方。我将如何解决这个问题，以便元素显示在标题下方？

我正在使用 Bootstrap 框架，并且标头的样式为`navbar navbar-fixed-top`.

* * *

## 回答 #1

> 赞同：111
> 
> 时间：2012-12-13T10:00:18.507

这有点hacky，但这里有一个解决方法。

```
var node = 'select your element';
var yourHeight = 'height of your fixed header';

// scroll to your element
node.scrollIntoView(true);

// now account for fixed header
var scrolledY = window.scrollY;

if(scrolledY){
  window.scroll(0, scrolledY - yourHeight);
} 
```

编辑：

现代解决方法是将 CSS`scroll-margin-top`属性与`:target`选择器结合使用。详细描述：[https ://www.bram.us/2020/03/01/prevent-content-from-being-hidden-underneath-a-fixed-header-by-using-scroll-margin-top/](https://www.bram.us/2020/03/01/prevent-content-from-being-hidden-underneath-a-fixed-header-by-using-scroll-margin-top/)

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2016-01-11T16:42:57.723

**编辑：**虽然不太兼容（没有 Edge + IE 兼容性），但`scroll-margin-top`也可以解决这个问题，正如[Arye Eidelman](https://stackoverflow.com/users/3458162/arye-eidelman)[的回答](https://stackoverflow.com/a/59253905/1268612)中提到的那样。

您可以使用 CSS 解决此问题，方法是将 a`padding-top`和负数`margin-top`应用于要滚动到的元素。

### [演示](http://work.karlhorky.com/frontend-tricks/anchors-with-fixed-header/index.html)

```
// For demo only, no JS needed for the solution
document.querySelector('.scroll-to-working-inline').addEventListener('click', function() {
  document.querySelector('.working-inline').scrollIntoView();
});

document.querySelector('.scroll-to-working-block').addEventListener('click', function() {
  document.querySelector('.working-block').scrollIntoView();
});

document.querySelector('.scroll-to-broken').addEventListener('click', function() {
  document.querySelector('.broken').scrollIntoView();
});
```

```
/* Relevant styles */
.working-inline {
  padding-top: 60px;
  margin-top: -60px;
}

.working-block {
  padding-top: 60px;
  margin-top: -60px;
}

/* Allow scrolling to the top */
body {
  padding-top: 60px;
}

/* Only for the demo */
body { margin: 0; }

header {
  position: fixed;
  top: 0;
  background-color: tomato;
  color: white;
  width: 100%;
  height: 60px;
  line-height: 60px;
  text-align: center;
}

[class^='working'],
[class^='broken'] {
  font-size: 3rem;
}
```

```
<header>
  scroll to...
  <button class="scroll-to-working-inline">working inline element</button>
  <button class="scroll-to-working-block">working block element</button>
  <button class="scroll-to-broken">broken element</button>
</header>

<main>
  <p>Sql daemon epoch all your base are belong to us packet system perl semaphore. Interpreter warez pragma kilo worm back door baz continue chown blob unix Dennis Ritchie stack mutex bar throw fopen man pages linux. Sql suitably small values bit infinite loop pwned rm -rf.</p>

  <a class="working-inline">Working inline</a>

  <p>Syn baz man pages unix vi crack leapfrog semaphore fail pwned afk null socket cd long leet emacs Donald Knuth bin grep todo pragma stdio.h January 1, 1970\. Alloc gc system new finally sql stack trace syn mainframe cat machine code memory leak server salt flood tunnel in back door thread. Bytes fatal throw ctl-c Dennis Ritchie over clock eof tera perl regex.</p>

  <div class="working-block">Working block element</div>

  <p>Public injection class unix malloc error script kiddies packet less fail int I'm sorry Dave, I'm afraid I can't do that. Tarball memory leak double rsa pwned public all your base are belong to us. False bytes bang bar tarball semaphore warez cd port daemon exception mountain dew sql mainframe gcc ifdef chown private.</p>

  <div class="broken">Broken element</div>

  <p>Daemon bubble sort protected mutex overflow grep snarf crack warez I'm compiling bit if memory leak Starcraft nak script kiddies long it's a feature. Hello world public server James T. Kirk injection terminal wannabee race condition syn alloc. Gobble leapfrog finally bypass concurrently while irc gurfle do back door blob man pages sql over clock.</p>

  <p>Char hello world then man pages ascii long salt while char fatal do boolean tunnel in system else foo packet sniffer float terminal int default. Trojan horse ssh ifdef /dev/null chown cache error protocol afk todo rm -rf mainframe piggyback pwned regex xss warez Starcraft try catch stdio.h bubble sort. It's a feature I'm sorry Dave, I'm afraid I can't do that *.* port bypass ip.</p>

  <p>Stdio.h epoch mutex flood wannabee do race condition sql access exception. Bar pragma man pages dereference flush todo highjack while buffer bit nak big-endian syn xss salt for d00dz. Leslie Lamport linux server error hexadecimal snarf tunnel in rm -rf firewall then shell all your base are belong to us.</p>

  <p>Ascii gcc grep int flood kilo linux access mailbomb hash *.* fork semaphore frack else win bar ssh Leslie Lamport. Man pages strlen cache gnu segfault tarball race condition perl packet sniffer root cookie private chown d00dz January 1, 1970\. Rsa public crack bit warez throw for void concurrently ip mutex.</p>

  <p>Char hello world then man pages ascii long salt while char fatal do boolean tunnel in system else foo packet sniffer float terminal int default. Trojan horse ssh ifdef /dev/null chown cache error protocol afk todo rm -rf mainframe piggyback pwned regex xss warez Starcraft try catch stdio.h bubble sort. It's a feature I'm sorry Dave, I'm afraid I can't do that *.* port bypass ip.</p>

  <p>Stdio.h epoch mutex flood wannabee do race condition sql access exception. Bar pragma man pages dereference flush todo highjack while buffer bit nak big-endian syn xss salt for d00dz. Leslie Lamport linux server error hexadecimal snarf tunnel in rm -rf firewall then shell all your base are belong to us.</p>

  <p>Ascii gcc grep int flood kilo linux access mailbomb hash *.* fork semaphore frack else win bar ssh Leslie Lamport. Man pages strlen cache gnu segfault tarball race condition perl packet sniffer root cookie private chown d00dz January 1, 1970\. Rsa public crack bit warez throw for void concurrently ip mutex.</p>

  <p>Char hello world then man pages ascii long salt while char fatal do boolean tunnel in system else foo packet sniffer float terminal int default. Trojan horse ssh ifdef /dev/null chown cache error protocol afk todo rm -rf mainframe piggyback pwned regex xss warez Starcraft try catch stdio.h bubble sort. It's a feature I'm sorry Dave, I'm afraid I can't do that *.* port bypass ip.</p>

  <p>Stdio.h epoch mutex flood wannabee do race condition sql access exception. Bar pragma man pages dereference flush todo highjack while buffer bit nak big-endian syn xss salt for d00dz. Leslie Lamport linux server error hexadecimal snarf tunnel in rm -rf firewall then shell all your base are belong to us.</p>

  <p>Ascii gcc grep int flood kilo linux access mailbomb hash *.* fork semaphore frack else win bar ssh Leslie Lamport. Man pages strlen cache gnu segfault tarball race condition perl packet sniffer root cookie private chown d00dz January 1, 1970\. Rsa public crack bit warez throw for void concurrently ip mutex.</p>
</main>
```

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2018-05-21T04:00:14.057

以下代码会平滑滚动到元素顶部，并带有固定标题的偏移量：

```
var topOfElement = document.querySelector('#targetElement').offsetTop - XX;
window.scroll({ top: topOfElement, behavior: "smooth" }); 
```

其中 XX 是固定标题的高度。

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2019-12-09T17:34:46.937

## 滚动边距顶部：$ header-height；

新的`scroll-margin-top`CSS 属性提供了一种非 hacky 方式来实现这一点，适用于标准 HTML 链接和 scrollIntoView。

`scroll-margin-top`更改垂直滚动目标，使目标元素远离视口顶部。将其设置为与标题相同的高度将确保它不会最终落在标题后面。

```
/*
  Add a scroll-margin-top to all elements that you want to be able to link to.
  (you may need to select items that don't have an id as well)
*/

* {
  scroll-margin-top: 100px;
} 
```

[我可以使用滚动边距顶部吗？](https://caniuse.com/#feat=mdn-css_properties_scroll-margin-top)这适用于大多数现代浏览器，[自 2021 年 5 月以来的最新 Safari](https://bugs.webkit.org/show_bug.cgi?id=189265)，而不是 IE 或旧版 Edge。

[MDN 文档滚动边距顶部](https://developer.mozilla.org/en-US/docs/Web/CSS/scroll-margin-top)

* * *

我在下面的演示中添加了平滑滚动，因此很明显这是使用 scrollIntoView。

[在代码笔中查看](https://codepen.io/arye-dov-eidelman/full/bGNEaXN)

```
links = [ ...document.getElementsByClassName("js-link")]
links.forEach(element => {
  element.addEventListener("click", e => {
    e.preventDefault()
    document.getElementById(e.target.dataset.target).scrollIntoView({
      behavior: "smooth", block: "start", inline: "nearest"
    })
  })
})
```

```
body {
  margin: 0;
}

header {
  position: sticky;
  top: 0;
  left: 0;
  right: 0;
  height: 100px;
  background: #eee;
  display: flex;
  align-items: center;
}
header a {
  padding: 0.5em;
}

h1 {
  padding: 0.7em;
}

* {
  scroll-margin-top: 100px;
}

p {
  padding: 1em;
}
```

```
<header>
  <h1>page title</h1>
  <nav>
    <a href="#p1" class="js-link" data-target="p1">1</a>
    <a href="#p2" class="js-link" data-target="p2">2</a>
    <a href="#p3" class="js-link" data-target="p3">3</a>
    <a href="#p4" class="js-link" data-target="p4">4</a>
    <a href="#p5" class="js-link" data-target="p5">5</a>
  </nav>
</header>

<main>
  <p id="p1">
    paragraph 1.
    <br>
    Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsu
  </p>
  <p id="p2">
    paragraph 2.
    <br>
    Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsu
  </p>
  <p id="p3">
    paragraph 3.
    <br>
    Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsu
  </p>
  <p id="p4">
    paragraph 4.
    <br>
    Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsu
  </p>
  <p id="p5">
    paragraph 5.
    <br>
    Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsu
  </p>
</main>
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2019-06-05T13:52:25.357

试试下面的。这对我来说很有效：

```
 const headerHeight = 50; /* PUT HEADER HEIGHT HERE */
  const buffer = 25; /* MAY NOT BE NEEDED */
  const scrollToEl = document.querySelector("#YOUR-ELEMENT-SELECTOR");

  const topOfElement = window.pageYOffset + scrollToEl.getBoundingClientRect().top - headerHeight - buffer;
  window.scroll({ top: topOfElement, behavior: "smooth" }); 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2020-12-10T21:05:56.010

一个很棒的简单解决方案（受 Sanyam Jain 的评论启发）是使用`{block: 'center'}`垂直居中的选择，如下所示：

```
scrollIntoView({block: 'center'}) 
```

编辑——我很遗憾地在 MDN 页面上发现这个功能是“实验性的——不应该在生产中使用”。此外，IE 不支持它（如果需要）。

[![在此处输入图像描述](../Images/ca4167fdc9cc7088ad1a1f5f6cf87383.png)](https://i.stack.imgur.com/sHEx1.png)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-03-21T15:11:59.447

如果有人在 scrollIntoView 之后遇到容器 div 的上边距被忽略的问题，那么不要将元素滚动到视图中，只需相对于其父滚动容器执行 scrollTop，如下所示：

```
var topOfElementToView= $('#elementToScroll').position().top;
$('#parentScrollingContainer').scrollTop(topOfElementToView); 
```

在此线程上从 user113716 得到答案：[如何转到页面上的特定元素？](https://stackoverflow.com/questions/4801655/how-to-go-to-a-specific-element-on-page)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-10-26T10:45:58.763

我怀疑对个人有用的东西在很大程度上取决于他们的页面布局，所以这个答案是作为一个额外的选择，而不是篡夺任何人。

我需要做的就是传递 false 以滚动到视图中`scrollIntoView(false)`

```
it('should be able to click a button selector', function () {
    let EC = protractor.ExpectedConditions;
    let button = element(by.css('.my-button-css));

    browser.executeScript('arguments[0].scrollIntoView(false)', button.getWebElement()).then(function () {
        browser.wait(EC.elementToBeClickable(button), 3000).then(function () {
            expect(button.isDisplayed()).toBeTruthy();
            button.click();

            // more test logic here

        });
    });
}); 
```

感谢[重新启动杰夫](http://rebootjeff.github.io/blog/2014/08/17/protractor-e2e-testing-reveal-element-blocked-by-fixed-nav/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-07-23T18:29:39.993

如果有人在滚动后修复了隐藏 Header\Title 的导航栏，这是解决方案（基于`@coco puffs`的答案和[这个](https://stackoverflow.com/a/50441816/4992248)）：

```
let anchorLinks = document.querySelectorAll('a[href^="#"]')

for (let item of anchorLinks) {
  item.addEventListener('click', (e) => {
    let hashVal = item.getAttribute('href')
    let topOfElement = document.querySelector(hashVal).offsetTop - 70

    window.scroll({ top: topOfElement, behavior: "smooth" })
    history.pushState(null, null, hashVal)
    e.preventDefault()
  })
} 
```

在代码`70px`中都用到了。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2022-01-17T04:27:22.057

我是这样做的

```
var messageContainer
var message
var autoScroll

var messageCounter = 0
var messageQuantity = 20
while(messageQuantity >1){
        messageQuantity--
        messageContainer = document.createElement('div')
        messageContainer.className = 'messageContainer'

        message = document.createElement('div')
        message.className = 'message'

        message.innerHTML = `message: ${messageCounter++}`
        messageContainer.append(message)

        document.getElementsByClassName('overflow_section')[0].append(messageContainer)

        document.getElementById('messageQuantity').textContent = `counter: ${messageCounter}`
}

var appendMessage = document.getElementsByClassName('appendMessage')[0]
        appendMessage.addEventListener("click", ()=>{
            autoScroll = document.getElementById('autoScroll')

            messageContainer = document.createElement('div')
            messageContainer.className = 'messageContainer'

            message = document.createElement('div')
            message.className = 'message'

            message.innerHTML = `message: ${messageCounter++}`
            messageContainer.append(message)

            document.getElementsByClassName('overflow_section')[0].append(messageContainer)

            if(autoScroll.checked){
                var count = document.getElementsByClassName('overflow_section')[0].getElementsByClassName('messageContainer')
                document.getElementsByClassName('messageContainer')[count.length - 1].scrollIntoView({
                    behavior: 'smooth', block: 'nearest', inline: 'start' 
                })
            }
            document.getElementById('messageQuantity').textContent = `counter: ${messageCounter}`

        })

        var scrollUp = document.getElementsByClassName('scrollUp')[0]       
        scrollUp.addEventListener("click", ()=>{
            var count = document.getElementsByClassName('overflow_section')[0].getElementsByClassName('messageContainer')   
                if(count.length > 0){
                   document.getElementsByClassName('messageContainer')[0].scrollIntoView({
                        behavior: 'smooth', block: 'center', inline: 'start' 
                    })  
                }           

        })

        var scrollDown = document.getElementsByClassName('scrollDown')[0]       
        scrollDown.addEventListener("click", ()=>{
            var count = document.getElementsByClassName('overflow_section')[0].getElementsByClassName('messageContainer')   
                if(count.length > 0){
                     document.getElementsByClassName('messageContainer')[count.length - 1].scrollIntoView({
                        behavior: 'smooth', block: 'nearest', inline: 'start' 
                    })
                }           

        })
```

```
button{
    background-color: rgb(0 0 0 / 80%);
    border-radius:5px;
    padding:10px;
    border:none;
    color:white;
}

input{
   background-color: rgb(179 229 249 / 50%);
   position:relative;
   top:10px;
    width:30px;
    height:30px;
}

.overflow_section{
    overflow: auto;
    font-size:20px;
    background-color: rgb(179 229 249 / 50%);
    width:50%;
    height:200px;
    margin:15px;
    margin-left:auto;
    margin-right:auto;
}

.messageContainer{
    background-color: rgb(255 120 0 / 50%);
    border-radius:5px;
    margin:5px;
    padding:15px;
}

#messageQuantity{
    background-color: rgb(255 120 0 / 100%);
    font-weight:700;
    border-radius:5px;
    padding:10px;
    color:black;
}
```

```
<div align="center">
    <span align="center" id='messageQuantity'></span>
    <button class='appendMessage'>Append message</button>
    <button class='scrollUp'>Scroll Up</button>
    <button class='scrollDown'>Scroll Down</button>

    <input type="checkbox" id="autoScroll" />
    <label for="vehicle1">Auto scroll</label>
</div>
<div class='overflow_section'></div>
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-06-02T18:33:54.463

对我来说，将元素滚动到窗口中心就可以了。

`scrollIntoViewIfNeeded({ block: "center" })`这样做很好，但不幸的是浏览器兼容性有限（[https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollIntoViewIfNeeded](https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollIntoViewIfNeeded)）。它不适用于 IE 和 Firefox。

但是，您可以自己轻松构建此函数：

```
function scrollIntoCenter(element) {
  // first scroll element into view. This means element is at the very top.
  element.scrollIntoView();

  // calculate new scrollYPosition by subtracting half of window-height
  let y = window.scrollY - window.innerHeight/2;

  // scroll up by half of window height
  window.scroll(0, y);
} 
```

# php - php/yii 日志记录：类别不起作用

> ID：13614114
> 
> 赞同：0
> 
> 时间：2012-11-28T20:48:43.540
> 
> 标签：php, logging, yii

在我的控制器中：

```
private $log_category   = "application.event";
private $log_info           = "info"; 
```

然后我像这样记录（在同一个控制器中）：

```
Yii::trace("actionIndex", $log_category);
Yii::log("saved",$log_info,$log_category); 
```

但它不起作用：日志不会出现在日志文件中。这是配置：

```
'log'=>array(
            'class'=>'CLogRouter',
            'routes'=>array(
                array(
                    'class'=>'CFileLogRoute',
                    'levels'=>'error,warning,info,trace',
                    'categories' => 'application'
                ),
            ), 
```

既不`"*"`也不`"application.*"`工作；但是如果我完全删除类别参数（或将其设为空），我会在日志中收到系统消息 - 这意味着正在写入日志文件并且不知何故我的类别是错误的。

如何定义类别？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T21:11:46.600

`$this`你在调用你的类属性时错过了一个：

```
Yii::trace("actionIndex", $this->log_category);
Yii::log("saved",$this->log_info,$this->log_category); 
```

# php - php数组的获取和计算

> ID：13614115
> 
> 赞同：0
> 
> 时间：2012-11-28T20:48:44.397
> 
> 标签：php, javascript, html, arrays, function

这是我的代码

```
for ($i=0; $i<$Percentile["Parameter_length"]; $i++)
{
  $parameters.="Eqt_Param".$i."=".$Percentile["Eqt_Param".$i]; 
  $Per_Wtg.="Per_Wtg".$i."=".$Percentile["Eqt_Param".$i]/100;
} 
```

如果我在 for 循环外显示（echo $Per_Wtg;）$per_wtg 我得到

```
'Per_Wtg0=0.03 Per_Wtg1=0 Per_Wtg2=0 Per_Wtg3=0' 
```

好吧，我还有一个代码

```
for ($i=0; $i<$Percentile["min_length"]; $i++)
{
    $min.="Eqt_Min".$i."=".$Percentile["Eqt_Min".$i];
} 
```

如果我在 for 循环外显示（echo $min;）$min 我得到

```
'Eqt_Min0=1.00Eqt_Min1=1.00Eqt_Min2=1.00Eqt_Min3=1.00' 
```

但现在我需要再显示一个数组变量

```
$Eqt_Sr0=($Per_Wtg0-$Eqt_Min0) ,
$Eqt_Sr1=($Per_Wtg1-$Eqt_Min1) , 
$Eqt_Sr2=($Per_Wtg2-$Eqt_Min2) , 
$Eqt_Sr3=($Per_Wtg3-$Eqt_Min3) 
```

为了做到这一点，我可能不得不再拿一个数组`$Eqt_Sr`

但是无论如何如何在外面显示这个`for loop`来解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:02:12.160

只需这样做：

```
$Eqt_Sr = array();

for ($i=0; $i<$Percentile["Parameter_length"]; $i++)
{
  $parameters.="Eqt_Param".$i."=".$Percentile["Eqt_Param".$i]; 
  $Per_Wtg.="Per_Wtg".$i."=".$Percentile["Eqt_Param".$i]/100;

  /*Look the array $Eqt_Sr*/
  $Eqt_Sr[$i] = $Percentile["Eqt_Param".$i]/100;
} 
```

然后：

```
for ($i=0; $i<$Percentile["min_length"]; $i++)
{
    $min.="Eqt_Min".$i."=".$Percentile["Eqt_Min".$i];

    // Add here
    $Eqt_Sr[$i] =  $Eqt_Sr[$i] - $Percentile["Eqt_Min".$i];
} 
```

要显示数组：

```
for($i=0; $i<count($Eqt_Sr); $i++){
   $output .= "Eqt_Sr".$i."=(".$Eqt_Sr[$i]."),";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T21:22:58.727

您的代码绝对是一团糟，无法说出您实际在寻找什么，但我会猜测一下。

不确定为什么要使用“Parameter_length”和“min_length”，因为您似乎希望它们始终是相同的值 - 但是如果它们不同会发生什么？我下面的代码处理`min_length >= Parameter_length`, 但不是`min_length < Parmeter_length`

**脚本**

```
<?php

// Data assumed from inspection of original post
$Percentile = array
(
        'Eqt_Param0' => 3.00,
        'Eqt_Param1' => 0.00,
        'Eqt_Param2' => 0.00,

        'Parameter_length' => 3,

        'Eqt_Min0' => 1.00,
        'Eqt_Min1' => 1.00,
        'Eqt_Min2' => 1.00,

        'min_length' => 3,
);

$Parameters = array();
$Per_Wtg    = array();
$Eqt_Min    = array();
$Eqt_Sr     = array();

for ($i = 0; $i < $Percentile['Parameter_length']; $i++)
{
    $param = $Percentile["Eqt_Param{$i}"];
    $wtg   = $param / 100;

    $Parameters[$i] = $param;
    $Per_Wtg[$i]    = $wtg;
}

// TODO What if 'min_length' != 'Parameter_length' ??
for ($i = 0; $i < $Percentile['min_length']; $i++)
{
    $param = $Percentile["Eqt_Param{$i}"];
    $min   = $Percentile["Eqt_Min{$i}"];

    $Eqt_Min[$i] = $min;
    $Eqt_Sr[$i]  = ( array_key_exists($i, $Parameters) ? $Parameters[$i] : 0 ) - $min;
}

print " Parameters => " . join(', ', $Parameters) . "\n";
print " Per_Wtg    => " . join(', ', $Per_Wtg   ) . "\n";
print " Eqt_Min    => " . join(', ', $Eqt_Min   ) . "\n";
print " Eqt_Sr     => " . join(', ', $Eqt_Sr    ) . "\n"; 
```

**输出**

```
 Parameters => 3, 0, 0
 Per_Wtg    => 0.03, 0, 0
 Eqt_Min    => 1, 1, 1
 Eqt_Sr     => 2, -1, -1 
```

# asp.net - 如何更改特定的课程 在 ASP.NET 列表视图中？

> ID：13614116
> 
> 赞同：0
> 
> 时间：2012-11-28T20:48:48.580
> 
> 标签：asp.net, css, listview

这个想法是为了一个菜单。我需要根据单击哪个顶部节点来突出显示菜单的特定颜色。所以如果我只需要用一种颜色突出显示它，我可以说

```
 <li <%# (Container.DataItem as FigLeafMenuItem).ItemSelected == "True" ? @" class=""MainMenuSelectedBlue""" : @" class=""""" %>> 
```

但是我需要根据服务器端信息的某些部分来更改颜色。我得到的最接近的是下面。我如何访问那个特定的 LI，以便向它添加一个类？

```
 protected void lvMainOuter_ItemDataBound(object sender, ListViewItemEventArgs e)
{
    if (e.Item.ItemType == ListViewItemType.DataItem)
    {
        ListViewDataItem lvdi = (ListViewDataItem)e.Item;
        FigLeafMenuItem flmi  = (FigLeafMenuItem)lvdi.DataItem;

        if (flmi.Name == "About Us")
        {
            HtmlGenericControl hgc = (HtmlGenericControl)e.Item.FindControl("xxx");
            hgc.Attributes.Add("class", "MainMenuSelectedBlue");
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T22:59:41.410

如果没有`runat="server"`. 但是，您可以使用文字控件呈现整个`li`标签。

```
<asp:Literal id="MenuItemLiteral" runat="server" />

if (flmi.Name == "About Us")
{
  var literal = (Literal)e.Item.FindControl("MenuItemLiteral");
  literal.Text = string.format("<li class=\"{0}\">{1}</li>", DATA1, DATA2);
} 
```

# hbase - 在 HBase 中与 checkAndPut 一起实现批处理的任何方式

> ID：13614118
> 
> 赞同：1
> 
> 时间：2012-11-28T20:49:01.487
> 
> 标签：hbase

我正在写 HBase 集群。我只有在数据不存在时才写，因此我使用`checkAndPut()`. 但与 相比，性能较差`put(List<Put>)`。有什么办法可以将这两个操作结合起来吗？我试图环顾四周，但什么也找不到。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-29T12:24:49.833

使用时`checkAndPut()`，每个请求执行一次 RPC 调用。因此，您无法获得超过`1 / rtt`每秒请求数的性能（rtt 是往返时间）。如果您的客户端和区域服务器之间有 rtt 1ms，那么您的理论最大值为 1000 rps。当使用批处理操作时，`put(List<Put>)`您需要更少的 RPC 调用，从而提高性能。我看到了两种解决问题的方法：

1.  使用工作池并行请求。您可能会发现`HTablePool`用于管理工作人员中的连接的有用类。

2.  如果您不需要了解操作状态（插入新单元或保留旧单元），您可以尝试编写协处理器，在单元存在的情况下静默丢弃 put 请求。在这种情况下，如果您需要替换某个单元格，您必须先将其删除。

# windows-phone-7 - 我的应用程序如何像 Metro Tube 那样为 Windows Phone 7 播放视频？

> ID：13614121
> 
> 赞同：3
> 
> 时间：2012-11-28T20:49:14.733
> 
> 标签：windows-phone-7, youtube, video-player

我必须编写一个从 YouTube 播放视频的 Windows Phone 7 应用程序。这很正常，但第一种方法是以与 MetroTube 相同的方式播放它们（参见[http://www.metrotubeapp.com/](http://www.metrotubeapp.com/)）（例如，您可以在不全屏的情况下播放 youtube 视频，也有播放控制）

![在此处输入图像描述][1](../Images/24efbf10612809a837ee70064febd273.png)

我不知道如何实现这一点，也许是基于[You Tube 视频集成](https://stackoverflow.com/questions/3017067/you-tube-video-integration)的嵌入式页面，但还不太确定。

知道如何为 WP7 创建这个非常灵活的 YouTube 播放器吗？

# java - com.google.common.util.concurrent.Service 与暂停回调？

> ID：13614122
> 
> 赞同：1
> 
> 时间：2012-11-28T20:49:16.987
> 
> 标签：java, guava

是否有 Guava com.google.common.util.concurrent.Service 的实现允许调用者在服务停止时注册通知，无论是在 TERMINATED 还是 FAILED 状态？

我想创建两个服务，其中服务#1 依赖于服务#2。如果 Service #2 关闭（有意进入 TERMINATED 状态或无意进入 FAILED 状态），我希望 Service #1 得到通知，以便它也可以启动关闭。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T22:07:12.730

只是将其重新发布为答案...

`Service.addListener`在 Guava 13.0 中添加，这似乎完全符合您的要求。

# sql - Oracle 查询设计

> ID：13614123
> 
> 赞同：-1
> 
> 时间：2012-11-28T20:49:20.473
> 
> 标签：sql, oracle

我有两个表加入左外连接

**员工**

```
Employeed_Id    Employee_Name   Location_id

1               David           1
2               Andrew          2
3               Mike            3
4               steve           4 
```

**Employee_profile**

```
profile_id     profile_name   location_id  profile_location
1              manager           1          NYC
2              accountant        2          Jersey
3              engineer          1          Mexico
4              trainer           3           Boston 
```

这是我必须根据位置检索所有员工的常见查询。这里 profile_location 是唯一的。

问题是，在应用程序的某些部分 profile_location 不是必需的。因此，不需要上述表之间的外连接。

如何开发查询，以便在 profile_location 没有外连接输入值的情况下正常运行。

**以下是我的查询：**

```
select e.Employee_Name 
from Employee e,
     Employee_profile ep 
 where e.location_id (+) = ep.location_id
 and ep.profile_location='xxxxx' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T20:35:52.810

如果你想返回那些匹配你传入的记录，`profile_location`但又想在位置不存在时返回所有记录，那么你可以使用这样的东西：

```
select distinct e."Employee_Name"
from Employee e
left join Employee_profile ep 
  on e."Location_id" = ep."location_id"
where ep."profile_location" = 'xxx'
    or not exists (select ep1."profile_location" 
                   from Employee_profile ep1
                   where  ep1."profile_location" = 'xxx') 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!4/64369/31)

如果您传入一个不存在的值，`'xxx'`结果如下：

```
| EMPLOYEE_NAME |
-----------------
|         David |
|        Andrew |
|         steve |
|          Mike | 
```

如果你传入`'NYC'`结果是：

```
| EMPLOYEE_NAME |
-----------------
|         David | 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T21:54:26.503

```
select e.Employee_Name 
from Employee e,
     Employee_profile ep 
 where e.location_id (+) = ep.location_id
 and (ep.profile_location='xxxxx'
   Or ep.profile_location is null) 
```

# content-management-system - Orchard、WebForms 和 iFrames

> ID：13614125
> 
> 赞同：0
> 
> 时间：2012-11-28T20:49:34.837
> 
> 标签：content-management-system, orchardcms

我正在尝试将 iFrame 嵌入到 Orchard CMS 部分（相同的域 - 控件位于主 Orchard 安装的子目录中）。我在这里找到了两个讨论我遇到的问题的线程（请参阅[此处](https://stackoverflow.com/questions/6735379/webforms-page-inside-of-orchard-cms-application)和[此处](https://stackoverflow.com/questions/6735379/webforms-page-inside-of-orchard-cms-application)），但我仍然遇到问题。我试图在 iFrame 中加载的页面是标准 WebForms，并且需要 WebResource.axd 和 ScriptResource.axd。我设法让 WebResource.axd 正常工作，但 ScriptResource 返回 500 Internal Server Error（根据 Chrome），但我无法弄清楚导致 500 的原因或真正的错误是什么。我的 web.config 中的相关条目如下 - 有什么建议吗？

```
<handlers accessPolicy="Script">
  <!-- clear all handlers, prevents executing code file extensions, prevents returning any file contents -->
  <clear />

  <!-- Custom Controls -->
  <add name="ASPX" path="*.aspx" verb="*" type="System.Web.UI.PageHandlerFactory" preCondition="integratedMode" requireAccess="Script"/>
  <add name="WebResource" path="WebResource.axd" verb="GET" type="System.Web.Handlers.AssemblyResourceLoader" preCondition="integratedMode" />
  <add name="ScriptResource" path="ScriptResource.axd" verb="GET" type="System.Web.Handlers.ScriptResourceHandler" preCondition="integratedMode" />

  <!-- Everything below added from Orchard -->
  <!-- Return 404 for all requests via managed handler. The url routing handler will substitute the mvc request handler when routes match. -->
  <!--<add name="NotFound" path="*" verb="*" type="System.Web.HttpNotFoundHandler" preCondition="integratedMode" requireAccess="Script" />-->

  <!-- WebApi -->
  <remove name="ExtensionlessUrlHandler-ISAPI-4.0_32bit" />
  <remove name="ExtensionlessUrlHandler-ISAPI-4.0_64bit" />
  <remove name="ExtensionlessUrlHandler-Integrated-4.0" />
  <add name="ExtensionlessUrlHandler-ISAPI-4.0_32bit" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" modules="IsapiModule" scriptProcessor="%windir%\Microsoft.NET\Framework\v4.0.30319\aspnet_isapi.dll" preCondition="classicMode,runtimeVersionv4.0,bitness32" responseBufferLimit="0" />
  <add name="ExtensionlessUrlHandler-ISAPI-4.0_64bit" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" modules="IsapiModule" scriptProcessor="%windir%\Microsoft.NET\Framework64\v4.0.30319\aspnet_isapi.dll" preCondition="classicMode,runtimeVersionv4.0,bitness64" responseBufferLimit="0" />
  <add name="ExtensionlessUrlHandler-Integrated-4.0" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" type="System.Web.Handlers.TransferRequestHandler" preCondition="integratedMode,runtimeVersionv4.0" />
</handlers> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T02:49:50.520

结合 Bertrand 的建议和大量的尝试，我最终找到了解决方案。

首先，自定义内容需要位于子文件夹中，并且在 IIS 中，您可以将该子文件夹切换到应用程序（而不是虚拟目录）。为了让您更加安心，我还给了它一个专用的应用程序池，所以如果它确实有什么奇怪的地方，主站点就不会关闭。

接下来的部分涉及几个步骤 - 主要是因为 system.webServer/handlers 中的 <clear /> 条目。在父应用程序中删除它会破坏 Orchard，但将它放入会破坏我的子应用程序，因为它继承了父应用程序的所有设置。为了解决这个问题，我的子应用程序必须具有以下 system.webServer 配置：

```
 <system.webServer>
  <handlers>
    <remove name="NotFound" />
    <add name="ASPX" path="*.aspx" verb="*" type="System.Web.UI.PageHandlerFactory" preCondition="integratedMode" requireAccess="Script"/>
  <add name="WebResource" path="WebResource.axd" verb="GET" type="System.Web.Handlers.AssemblyResourceLoader" preCondition="integratedMode" />
  <add name="ScriptResource" preCondition="integratedMode" verb="GET,HEAD" path="ScriptResource.axd" type="System.Web.Handlers.ScriptResourceHandler, System.Web.Extensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
  </handlers>
  <modules>
    <remove name="WarmupHttpModule" />
  </modules>
</system.webServer> 
```

[我使用此处](https://stackoverflow.com/questions/3822733/ajaxtoolkit-iis7-asp-net-4-0-sys-is-not-defined-handler-mapping-issue)引用的 SO 链接来查找所需的“真实”ScriptResource.axd 引用，看起来一切正常。

# java - Java：如何调试作为另一个应用程序插件的模块/jar

> ID：13614134
> 
> 赞同：1
> 
> 时间：2012-11-28T20:50:24.677
> 
> 标签：java, debugging

我知道这听起来像一个可悲的问题，我相信它会被嘲笑，但这是我知道如何描述这种情况的唯一方法。

Scenerio：我正在为另一个 java 应用程序创建一个插件。这个使用编译 jar（我的插件）的应用程序被放置在应用程序插件目录中。无论如何，我可以在执行我没有源的应用程序时调试这个 jar（我必须找到它）吗？

我使用 Eclispe Juno 作为我的 IDE。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T20:58:45.547

我会说是的，如果您可以启动插件插入的应用程序:)。

`java -Xdebug -Xrunjdwp:server=y,transport=dt_socket,address=4000,suspend=n myapp` 然后在 Eclipse 中启动一个远程调试会话，将其设置为连接到在 java 调试模式下运行的应用程序到端口 4000 上的 localhost

这个链接可能会解决你所有的日食问题

[http://javarevisited.blogspot.com/2011/02/how-to-setup-remote-debugging-in.html](http://javarevisited.blogspot.com/2011/02/how-to-setup-remote-debugging-in.html)

# javascript - Javascript 子类别 - 清除选择

> ID：13614137
> 
> 赞同：1
> 
> 时间：2012-11-28T20:50:31.910
> 
> 标签：javascript

这是关于子类别的附加问题。当前的问题是，当我更改选项时，清除操作系统列表的功能不起作用，并且随着更改的进行而继续增长。我尝试在任何地方添加删除功能，但它仍然不起作用。要重新创建问题，请为网络选择内部，然后查看操作系统列表。选择物理资源，然后查看操作系统列表。我在 list.js 文件中有一个名为 removeAllOptions 的函数，它在资源更改时不会清除操作系统选择。当网络发生变化时，它确实有效。任何想法都非常感谢。

谢谢，雷

[JS小提琴](http://jsfiddle.net/7ey8E/1/)

**索引.php**

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
    <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

    <head>
    <script language="javascript" src="list.js"></script>
    </head>
    <head>
   <script language="javascript" src="list.js"></script>
</head>
<div class="left_box" />
<body onload="fillCategory();">
   <div id="formWrapper" />
   <FORM name="drop_list" action="availability.php" method="POST" />
   <fieldset>
      <label>Network</label>
      <SELECT class="formSelect" NAME="build" onChange="selectResource();">
         <Option value="">Select Internal or Firewall</option>
      </SELECT>
      <br />
      <br />
      <label>Resource</label>
      <SELECT class="formSelect" id="resource" NAME="resource" 
          onChange="selectOS(this);">
         <Option value="">Resource</option>
      </SELECT>
      <br />
      <br />
      <label>OS</label>
      <SELECT class="formSelect" id="OS" NAME="OS">
         <Option value="">OS</option>
      </SELECT>
      <br />
      <br />
   </fieldset> 
```

**列表.js**

```
function fillCategory(){ 
 // this function is used to fill the category list on load
addOption(document.drop_list.build, "Internal", "Internal", "");
addOption(document.drop_list.build, "Internal Cluster", "Internal Cluster", "");
addOption(document.drop_list.build, "Firewall", "Firewall", "");
addOption(document.drop_list.build, "Firewall Cluster", "Firewall Cluster", "");
}

function selectResource(){
// ON selection of category this function will work
removeAllOptions(document.drop_list.resource);
removeAllOptions(document.drop_list.OS);

if((document.drop_list.build.value == 'Internal')||(document.drop_list.build.value == 'Firewall')){
addOption(document.drop_list.resource,"Virtual", "Virtual","");
addOption(document.drop_list.resource,"Physical", "Physical","");
}

if((document.drop_list.build.value == 'Internal Cluster') || (document.drop_list.build.value     == 'Firewall Cluster')) {
addOption(document.drop_list.resource,"Physical", "Physical");
}
    selectOS();
}
function selectOS(el){

if(document.drop_list.build.value == 'Internal') {
addOption(document.drop_list.OS,"AIX 6.1", "AIX 6.1");
addOption(document.drop_list.OS,"Linux 5.0 (64-bit)", "Linux 5.0 (64-bit)");
addOption(document.drop_list.OS,"Linux 6.0 (64-bit)", "Linux 6.0 (64-bit)");
addOption(document.drop_list.OS,"Solaris 10", "Solaris 10");
addOption(document.drop_list.OS,"Windows 2008 (64-bit) Standard", "Windows 2008 (64-bit) Standard");
addOption(document.drop_list.OS,"Windows 2008 (64-bit) Enterprise", "Windows 2008 (64-bit)   Enterprise");
addOption(document.drop_list.OS,"Windows 2008 R2 (64-bit) Standard", "Windows 2008 R2 (64-bit)  Standard");
addOption(document.drop_list.OS,"Windows 2008 R2 (64-bit) Enterprise", "Windows 2008 R2 (64-bit) Enterprise");
addOption(document.drop_list.OS,"Special", "Special");
}

if((document.drop_list.build.value == 'Internal Cluster') ||(document.drop_list.build.value == 'Firewall Cluster')){
addOption(document.drop_list.OS,"AIX 6.1", "AIX 6.1");
addOption(document.drop_list.OS,"Linux 5.0 (64-bit)", "Linux 5.0 (64-bit)");
addOption(document.drop_list.OS,"Linux 6.0 (64-bit)", "Linux 6.0 (64-bit)");
addOption(document.drop_list.OS,"Solaris 10", "Solaris 10");
addOption(document.drop_list.OS,"Windows 2008 (64-bit) Enterprise", "Windows 2008 (64-bit) Enterprise");
addOption(document.drop_list.OS,"Windows 2008 R2 (64-bit) Enterprise", "Windows 2008 R2 (64-bit) Enterprise");
}

if((document.drop_list.build.value == 'Firewall') && (document.drop_list.resource.value == 'Virtual')) {
addOption(document.drop_list.OS,"Linux 5.0 (64-bit)", "Linux 5.0 (64-bit)");
addOption(document.drop_list.OS,"Linux 6.0 (64-bit)", "Linux 6.0 (64-bit)");
addOption(document.drop_list.OS,"Windows 2008 (64-bit) Enterprise", "Windows 2008 (64-bit) Enterprise");
addOption(document.drop_list.OS,"Windows 2008 R2 (64-bit) Enterprise", "Windows 2008 R2 (64-bit) Enterprise");
}

if((document.drop_list.build.value == 'Firewall') && (document.drop_list.resource.value == 'Physical')) {
addOption(document.drop_list.OS,"AIX 6.1", "AIX 6.1");
addOption(document.drop_list.OS,"Linux 5.0 (64-bit)", "Linux 5.0 (64-bit)");
addOption(document.drop_list.OS,"Linux 6.0 (64-bit)", "Linux 6.0 (64-bit)");
addOption(document.drop_list.OS,"Solaris 10", "Solaris 10");
addOption(document.drop_list.OS,"Windows 2008 (64-bit) Enterprise", "Windows 2008 (64-bit) Enterprise");
addOption(document.drop_list.OS,"Windows 2008 R2 (64-bit) Enterprise", "Windows 2008 R2 (64-bit) Enterprise");
}

} 

function removeAllOptions(selectbox)
{
    var i;
    for(i=selectbox.options.length-1;i>=0;i--)
{
    //selectbox.options.remove(i);
    selectbox.remove(i);
}
} 

function addOption(selectbox, value, text )
{
var optn = document.createElement("OPTION");
optn.text = text;
optn.value = value;

selectbox.options.add(optn);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:21:20.653

对于快速修复，您可以在调用该`removeAllOptions()`函数时调用该函数。

但是您有太多重复的代码，并且每次调用选择框时都尝试访问**DOM 。**

**最好缓存它们。**

**代码**

```
var networkList = '';
var resourceList = '';
var osList = '';

function fillCategory() {
    // this function is used to fill the category list on load
    networkList = document.drop_list.build;
    resourceList = document.drop_list.resource;
    osList = document.drop_list.OS;
    var catOptions = ["Internal", "Internal Cluster"
                      , "Firewall", "Firewall Cluster"];
    addOptions(networkList, catOptions);
}

function selectResource() {
    // ON selection of category this function will work
    removeAllOptions(resourceList);
    removeAllOptions(osList);
    var networkValue = networkList.value;

    if ((networkValue == 'Internal') || (networkValue == 'Firewall')) {
        addOptions(resourceList, ["Virtual", "Physical"]);
    }
    else if ((networkValue == 'Internal Cluster') 
               || (networkValue == 'Firewall Cluster')) {
        addOptions(resourceList, ["Physical"]);
    }
    selectOS();
}

function selectOS(el) {
    var networkValue = networkList.value;
    var resourceValue = resourceList.value;

    var internalOS = ["AIX 6.1","Linux 5.0 (64-bit)","Linux 6.0 (64-bit)"
                      ,"Solaris 10","Windows 2008 (64-bit) Standard"
                      ,"Windows 2008 (64-bit) Enterprise"
                      , "Windows 2008 R2 (64-bit) Standard" 
                      ,"Windows 2008 R2 (64-bit) Enterprise"
                      , "Special"];
    var clusterOS = ["AIX 6.1","Linux 5.0 (64-bit)","Linux 6.0 (64-bit)",
                     "Solaris 10","Windows 2008 (64-bit) Enterprise"
                     ,"Windows 2008 R2 (64-bit) Enterprise" ];

    var firewallOS = ["Linux 5.0 (64-bit)","Linux 6.0 (64-bit)"
                       ,"Windows 2008 (64-bit) Enterprise"
                      ,"Windows 2008 R2 (64-bit) Enterprise" ];

    removeAllOptions(osList); // Clear your OS list here
    if (networkValue == 'Internal') {
        addOptions(osList , internalOS);
    }
    else if ((networkValue == 'Internal Cluster') 
              || (networkValue == 'Firewall Cluster')) {
        addOptions(osList , clusterOS);
    }
    else if ((networkValue == 'Firewall') && (resourceValue == 'Virtual')) {
       addOptions(osList , firewallOS);
    }
    else if ((networkValue == 'Firewall') && (resourceValue == 'Physical')) {
        addOptions(osList , clusterOS);
    }

}

function removeAllOptions(selectbox) {
    var i;
    for (i = selectbox.options.length - 1; i >= 0; i--) {
        selectbox.remove(i);
    }
}

function addOptions(selectbox, arr) {
    // use an array to populate Select Options
    for (var i = 0; i < arr.length; i++) {
        var optn = document.createElement("OPTION");
        optn.text = arr[i];
        optn.value = arr[i];
        selectbox.options.add(optn);
    }
}​ 
```

这可以得到**更多优化。** 您也可以将 jQuery 用于此类目的。最好将内联 javascript 移动到脚本本身。

**[工作小提琴](http://jsfiddle.net/sushanth009/7ey8E/7/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T21:19:28.143

清除选择选项的代码，即`removeAllOptions(document.drop_list.OS);`从函数调用`selectResource`。但是，您的`resource` `onChange`处理程序直接调用`selectOS`，完全绕过了选项删除代码。

解决方案：

```
function selectResource(){
    // ON selection of category this function will work
    removeAllOptions(document.drop_list.resource);

    if((document.drop_list.build.value == 'Internal')||(document.drop_list.build.value == 'Firewall')) {
        addOption(document.drop_list.resource,"Virtual", "Virtual","");
        addOption(document.drop_list.resource,"Physical", "Physical","");
    }

    if((document.drop_list.build.value == 'Internal Cluster') || (document.drop_list.build.value     == 'Firewall Cluster')) {
        addOption(document.drop_list.resource,"Physical", "Physical");
    }

    selectOS();
}

function selectOS(el) {

    removeAllOptions(document.drop_list.OS);

    if(document.drop_list.build.value == 'Internal') {
        addOption(document.drop_list.OS,"AIX 6.1", "AIX 6.1");
        addOption(document.drop_list.OS,"Linux 5.0 (64-bit)", "Linux 5.0 (64-bit)");
        addOption(document.drop_list.OS,"Linux 6.0 (64-bit)", "Linux 6.0 (64-bit)");
        addOption(document.drop_list.OS,"Solaris 10", "Solaris 10");
        addOption(document.drop_list.OS,"Windows 2008 (64-bit) Standard", "Windows 2008 (64-bit) Standard");
        addOption(document.drop_list.OS,"Windows 2008 (64-bit) Enterprise", "Windows 2008 (64-bit)   Enterprise");
        addOption(document.drop_list.OS,"Windows 2008 R2 (64-bit) Standard", "Windows 2008 R2 (64-bit)  Standard");
        addOption(document.drop_list.OS,"Windows 2008 R2 (64-bit) Enterprise", "Windows 2008 R2 (64-bit) Enterprise");
        addOption(document.drop_list.OS,"Special", "Special");
    }

    // the remaing code of this function

} 
```

我所做的更改是将 to 移到`removeAllOptions(document.drop_list.OS);`inside `selectOS`。

**建议：**请使用像 jQuery 这样的 dom 库。我注意到您正在使用`.value`检索选择框的选定值。有报道称代码无法在某些版本的 IE 上运行。同样，所有浏览器中都有其他怪癖。

# perl - Perl：如何声明和实现函数`say`

> ID：13614139
> 
> 赞同：1
> 
> 时间：2012-11-28T20:50:51.323
> 
> 标签：perl, implementation, declaration

简单的问题：

我想写一个像`say`.

但它有一个不好的特性：文件句柄。

```
 say FILEHANDLE LIST
       say FILEHANDLE
       say LIST
       say 
```

如何申报？是否可以？

PS：我找到了一个例子`myopen(*;$)`，但它不是一回事。
PPS：我在旧的 Perl 版本中需要这个函数，因为写起来很烦人`print "\n"`

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-28T21:08:02.303

[Perl6::Say](https://metacpan.org/module/Perl6%3a%3aSay)就是这样做的。

`say FILEHANDLE TEXT`它利用 Perl 通常非常烦人的[间接方法调用语法](http://modernperlbooks.com/mt/2009/08/the-problems-with-indirect-object-notation.html)巧妙地模拟了语法。它加载[IO::Handle](https://metacpan.org/module/IO%3a%3aHandle)将每个文件句柄转换为一个对象并创建`IO::Handle->say`. 现在`say FILEHANDLE TEXT`其实是`FILEHANDLE->say(TEXT)`。

它确实有警告。从[文档](https://metacpan.org/module/Perl6%3a%3aSay#General)...

```
Use it just like print (except that it only supports the indirect
object syntax when the stream is a bareword). That is, assuming
the relevant filehandles are open for output, you can use any of these:

say @data;
say FH @data;
FH->say(@data);
*FH->say(@data);
(\*FH)->say(@data);
say $fh, @data;
$fh->say(@data);

but not any of these:

say {FH} @data;
say {*FH} @data;
say {\*FH} @data;
say $fh @data;
say {$fh} @data; 
```

**更新**：为了更简单，我刚刚上传了[Say::Compat](https://metacpan.org/module/MSCHWERN/Say-Compat-0.01/lib/Say/Compat.pm)，它加载 Perl6::Say 或`use feature 'say'`取决于您的 Perl 版本。

[如果不使用Devel::Declare](https://metacpan.org/module/Devel%3a%3aDeclare)，您可能会得到最好的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T21:15:27.200

`say`不能由 subs 重新创建。

```
>perl -E"say prototype('CORE::say') // 'Special'"
Special 
```

你需要一个调用解析器和调用检查器来实现这一点。有关示例，请参见[Syntax::Feature::Loop 。](http://search.cpan.org/perldoc?Syntax%3a%3aFeature%3a%3aLoop)

# canvas - 使用 python 3.2.2 tkinter 我创建了一个带有滚动条的画布，但是当我移动滚动条时画布内的数据不会滚动

> ID：13614141
> 
> 赞同：1
> 
> 时间：2012-11-28T20:50:57.457
> 
> 标签：canvas, python-3.x, tkinter, scrollbar

使用 python 3.2.2 tkinter 我创建了一个带有滚动条的画布，但是当我移动滚动条时画布内的数据不会滚动。tkinter 的语法问题或错误？

示例代码：

```
from tkinter import *

## GUI color map ###
black = "#000000"

root = Tk()
root.minsize(100,100)
root.maxsize(500,500)
root.resizable(0,0)

topFrame = Frame(root, bd=2, relief=SUNKEN)
topFrame.pack()

xscrollbar = Scrollbar(topFrame, orient=HORIZONTAL)
xscrollbar.pack(side=BOTTOM, fill=X)

yscrollbar = Scrollbar(topFrame, orient=VERTICAL)
yscrollbar.pack(side=RIGHT, fill=Y)

conFrame = Canvas(topFrame, bd=0, scrollregion=(0, 0, 1000, 1000),
                xscrollcommand=xscrollbar.set,
                yscrollcommand=yscrollbar.set)

conFrame.pack(side=TOP, fill=BOTH, expand=1)
xscrollbar.config(command=conFrame.xview)
yscrollbar.config(command=conFrame.yview)

for i in range(1,30):
    function_name = 'my'+str(i)+'ItemList = StringVar()'
    exec(function_name)
    function_name = 'my'+str(i)+'Item = '+str(i)
    exec(function_name)
    function_name = 'my'+str(i)+'ItemList.set(my'+str(i)+'Item)'
    exec(function_name)
    function_name = 'my'+str(i)+'ItemListEntry = Entry(conFrame, width=148,     foreground=black, textvariable=my'+str(i)+'ItemList)'
    exec(function_name)
    function_name = 'my'+str(i)+'ItemListEntry.pack(side=TOP, padx=2)'
    exec(function_name)

mainloop() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T21:15:25.110

滚动条*确实*滚动画布。您正在创建的小部件（以一种*非常*不寻常的方式）不是画布的一部分，因此它们不会滚动。如果您在画布上使用绘图命令，您会看到画布项目实际上是滚动的。

为了让小部件滚动，您必须将它们嵌入到画布中`create_window`。如果您尝试创建滚动框架，典型的解决方案是将所有小部件放在一个框架中，用于`create_window`将该框架添加到画布，然后将 设置为`scrollregion`框架的大小（您必须在屏幕更新，因为在实际呈现小部件之前不会计算大小）

在旁注中，您为什么使用 exec？它使您的代码非常难以理解，并且您没有得到任何回报。你知道你可以用更简单的东西代替这 10 行吗？例如：

```
var = {}
for i in range(1,30):
    var[i] = StringVar()
    var[i].set(i)
    e = Entry(conFrame, width=148, foreground=black, textvariable=var[i])
    e.pack(side=TOP, padx=2) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T17:25:57.550

工作代码示例：

```
from tkinter import *

## GUI color map ###
black = "#000000"

root = Tk()
root.title("Canvas Scrollbar Example")
root.minsize(100,100)
root.maxsize(500,500)
root.resizable(0,0)

topFrame = Frame(root, bd=2, relief=SUNKEN)
topFrame.pack()

xscrollbar = Scrollbar(topFrame, orient=HORIZONTAL)
xscrollbar.pack(side=BOTTOM, fill=X)

yscrollbar = Scrollbar(topFrame, orient=VERTICAL)
yscrollbar.pack(side=RIGHT, fill=Y)

canvasFrame = Canvas(topFrame, width=500, height=500, scrollregion=(0, 0, 1000, 1000),
                xscrollcommand=xscrollbar.set,
                yscrollcommand=yscrollbar.set)

canvasFrame.pack(side=TOP, fill=BOTH, expand=1)

xscrollbar.config(command=canvasFrame.xview)
yscrollbar.config(command=canvasFrame.yview)

entryFrame = Frame(canvasFrame, bd=2, relief=SUNKEN)
entryFrame.pack()

var = {}
for i in range(1,30):
    var[i] = StringVar()
    var[i].set(i)
    e = Entry(entryFrame, width=148, foreground=black, textvariable=var[i])
    e.pack(side=TOP, padx=2)

canvasFrame.create_window(0, 0, window=entryFrame, anchor='nw')

mainloop() 
```

# java - 线程 getName() 返回错误的名称

> ID：13614143
> 
> 赞同：5
> 
> 时间：2012-11-28T20:51:04.137
> 
> 标签：java, multithreading, thread-safety

好的，我知道这可能是对线程如何真正工作的理解不好，但是直到有人帮助我理解我才会相信这是一个错误:)

在我的 Main 类及其 main() 方法中，我有：

```
public static void main(String args[]){
    StoneBucket stoneBucket = new StoneBucket();    
    StonePutter spRunnable   = new StonePutter(stoneBucket);
    StoneThrower stRunnable  = new StoneThrower(stoneBucket);
    StoneThrower stRunnable2 = new StoneThrower(stoneBucket);

    //Create the Threads that will take the Runnables as arguments
    Thread puttingThread = new Thread(spRunnable);
    Thread throwingThread = new Thread(stRunnable);
    Thread throwingThread2 = new Thread(stRunnable);

    puttingThread.setName("Putter");
    throwingThread.setName("Thrower 1");
    throwingThread2.setName("Thrower 2");
    [...] 
```

然后在我的 StoneThrower 课上

```
public class StoneThrower implements Runnable{

private StoneBucket sb;
private String name;

public StoneThrower(StoneBucket _sb){
    this.sb = _sb;
}   

public void run(){

    name = Thread.currentThread().getName();        
    System.out.println("T::"+name+" started...");       
    int count = 0;      
    while(true){
            [...] 
```

当我编译并运行这段代码时，我得到：

![2个线程的屏幕截图...](../Images/d50858b8e59c8e45eac405646868cd9c.png)

所以，我的问题是为什么这两个线程都返回相同的名称`currentThread().getName()`？当它们被创建时，它们被分配了名称，`threadX.setName("XXX")`并且这些可运行文件通过调用开始`threadX.start()`......有人可以澄清一下吗？

编辑：我接受了正确的答案，因为将 stRunnable 更改为 stRunnable2 行为符合预期。现在真正的问题是为什么会发生这种情况。我创建了两个线程并分别启动它们。run() 方法（在创建线程时调用一次）如何返回错误的名称？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-28T21:03:10.377

发生这种情况是因为您将线程名称存储`name`在`StoneThrower`. 由于并发性，第二个线程覆盖`name`了第一个线程刚刚设置的值，并且它们都输出相同的值。

这是你的场景：

```
1\. Thread1#start
2\. Thread2#start
3\. Thread1#runnable#run -> runnable.name = 'Thrower 1'
4\. Thread2#runnable#run -> runnable.name = 'Thrower 2' // overrides
5\. Thread1#runnable#run -> System.out.println(runnable.name)
6\. Thread2#runnable#run -> System.out.println(runnable.name) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-28T20:53:54.763

您使用相同的可运行对象创建两个线程：

```
Thread throwingThread = new Thread(stRunnable);
Thread throwingThread2 = new Thread(stRunnable);
                                    ^^^^^^^^^^ stRunnable2? 
```

您将线程名称存储在`Runnable`对象的实例变量中。由于该对象由两个线程共享，因此要执行的第二个线程会`name = Thread.currentThread().getName()`用自己的名称覆盖第一个线程的名称。

# php - Mysql使用数组插入

> ID：13614148
> 
> 赞同：0
> 
> 时间：2012-11-28T20:51:27.267
> 
> 标签：php, mysql

我有一个存储在变量 $contactid 中的数组。我需要运行此查询为数组中的每个contact_id 插入一行。做这个的最好方式是什么？这是我需要运行的查询...

```
$contactid=$_POST['contact_id'];
$eventid=$_POST['event_id'];
$groupid=$_POST['group_id'];

mysql_query($query);
$query="INSERT INTO attendance (event_id,contact_id,group_id) VALUES ('$eventid','$contactid','$groupid')"; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T20:57:16.407

使用`foreach`循环。

```
$query = "INSERT INTO attendance (event_id,contact_id,group_id) VALUES ";

foreach($contactid as $value)
{
    $query .= "('{$eventid}','{$value}','{$groupid}'),";
}

mysql_query(substr($query, 0, -1)); 
```

*这里的想法是连接您的查询字符串并且只对数据库进行 1 次查询，每个值集用逗号分隔*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T21:05:11.763

由于还没有人说，你实际上不能这样做：

```
$query = '
INSERT INTO [Table] ([Column List])
VALUES ([Value List 1]);
INSERT INTO [Table] ([Column List])
VALUES ([Value List 2]);
';
mysql_query($query); 
```

因为这已被阻止以防止 mysql_query 代码中的 sql 注入。mysql_query 的给定查询参数中不能有分号。除了以下例外，取自[手册注释](http://www.php.net/manual/en/function.mysql-query.php#91669)：

> 该文档声称“不支持多个查询”。
> 
> 但是，似乎支持多个查询。您只需将标志 65536 作为 mysql_connect 的 5 参数 (client_flags) 传递。该值在 /usr/include/mysql/mysql_com.h 中定义：
> 
> #define CLIENT_MULTI_STATEMENTS (1UL << 16) /* 启用/禁用 multi-stmt 支持 */
> 
> 一次执行多个查询，mysql_query 函数将只返回第一个查询的结果。其他查询也将被执行，但您不会得到它们的结果。

但是，这是未记录且不受支持的行为，并且很容易将您的代码打开到 SQL 注入。相反，你可以用 mysql_query 做的是

```
$query = '
INSERT INTO [Table] ([Column List])
VALUES ([Value List 1])
     , ([Value List 2])
       [...]
     , ([Value List N])
';
mysql_query($query); 
```

因此，您实际上可以使用一个查询和一个插入语句插入多行。在[这个答案](https://stackoverflow.com/a/780046/365237)中有一个代码示例，它不会连接到循环中的字符串，这比这个线程中建议的要好。

* * *

但是，无视上述所有内容，您最好还是使用准备好的语句，例如

```
$stmt->prepare("INSERT INTO mytbl (fld1, fld2, fld3, fld4) VALUES(?, ?, ?, ?)");
foreach($myarray as $row)
{
    $stmt->bind_param('idsb', $row['fld1'], $row['fld2'], $row['fld3'], $row['fld4']);
    $stmt->execute();
}
$stmt->close(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-28T20:58:05.547

使用类似下面的东西。请注意，您不应再使用 mysql_* 函数，并且您的代码容易被注入。

```
for ($i = 0; $i < count($contactid); $i++) {
    $query="INSERT INTO attendance (event_id,contact_id,group_id) VALUES ('$eventid','$contactid[$i]','$groupid')";
    mysql_query($query);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-28T20:57:50.633

关于什么：

```
$contactIds = $_POST['contact_id'];
$eventIds = $_POST['event_id'];
$groupIds = $_POST['group_id'];

foreach($contactIds as $key => $value)
{
    $currentContactId = $value;
    $currentEventId = $eventIds[$key];
    $currentGroupId = $groupIds[$key];

    $query="INSERT INTO attendance (event_id,contact_id,group_id) VALUES ('$currentEventId','$currentContactId','$currentGroupId')";

    mysql_query($query);
} 
```

好吧，您可以重构它以在单个查询中插入所有内容，但您明白了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-28T20:56:55.903

我不确定运行多个查询是否是最好的做法，因此不建议创建一个 for 循环，例如，为数组的每个元素运行。我宁愿说，做一个递归循环，将新元素添加到一个字符串中，然后传递给查询。如果您可以给我们一个关于您的数据库结构的简短示例以及您希望它的外观（即数组应该如何进入表中），我可以给您一个示例循环语法。

干杯!

# mysql - MYSQL：外键错误

> ID：13614150
> 
> 赞同：0
> 
> 时间：2012-11-28T20:51:32.613
> 
> 标签：mysql

添加一个外键时出现一些外键错误。我有：

```
CREATE TABLE PRODUCT_1( PROD_ID NUMERIC(5) NOT NULL PRIMARY KEY,
  PROD_NAME CHAR(20), 
  PROD_DESC CHAR(20),  
  PROD_PRICE NUMERIC(20), 
  SIZE_ID NUMERIC(5) NOT NULL, 
  PROD_CAT_ID CHAR(5));

CREATE TABLE SIZE( 
  SIZE_ID NUMERIC(5) NOT NULL PRIMARY KEY, 
  SIZE_SMALL CHAR(2), 
  SIZE_MEDIUM CHAR(2), 
  SIZE_LARGE CHAR(2)); 
```

我正在尝试使用以下方法添加外键：

更改表 SIZE 添加外键（SIZE_ID）引用 PRODUCT_1（SIZE_ID）

但是我收到以下错误：错误1005（HY000）：无法创建表'./mmmm/#sql-842_33e1.frm'（错误号：150）

但是，如果我反过来说：

更改表 PRODUCT_1 添加外键（SIZE_ID）引用 SIZE（SIZE_ID）

这工作正常，我无法向其中添加任何数据，它会给我诸如“无法更新子表”之类的错误。

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:01:26.560

PRODUCT_1.SIZE_ID 在此示例中是外键，因为它引用另一个表 SIZE 的主键。因此，第二个 ALTER TABLE 语句是正确的，因为它是 PRODUCT_1 表的属性。

现在，在将任何行插入 PRODUCT_1 表之前，您应该确保表 SIZE 已经有一条记录，其中包含新行中引用的 SIZE_ID。如果数据库发现您正在尝试插入具有 SIZE_ID 的行，但该行在 SIZE 表中不存在，则您违反了 FOREIGN KEY 约束，它将不允许您插入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T20:56:48.917

那是对的。SIZE_ID 是 PRODUCT_1 中的“外键”，因为它是 SIZE 表的“主键”。尝试向 SIZE 添加外键约束没有任何意义。

如果您运行 SHOW INNODB STATUS 您将获得一些信息，表明您没有所需的索引，但是，从逻辑上讲，没有理由尝试创建该约束。

但是，您确实希望在 PRODUCT_1 上创建约束。此时，您将只能在 PRODUCT_1 中输入 SIZE 中已经存在的 SIZE_ID 值，因为这是典型的“查找表”设计。

# c# - 如果发生错误，使 DataContext 继续插入

> ID：13614152
> 
> 赞同：0
> 
> 时间：2012-11-28T20:51:35.877
> 
> 标签：c#, linq-to-sql, datacontext

我正在使用`DataContext`c# 中的对象和 Linq to SQL。我正在尝试将愿望清单上的愿望投票转移到管理员已确定第一个问题与其重复的问题。但是，由于该`vote`表具有`WishId`and`UserId`作为主键，如果用户已经对目标愿望进行了投票，则插入将失败。我想做的是忽略这些情况（`vote`在插入之前不查询表）并插入所有有效票。这就是我想做的。

```
using (linqWishesDataContext dataContext = new linqWishesDataContext())
{
    try
    {
        dataContext.WishlistUpvotes.InsertAllOnSubmit(destinationVotes);
        dataContext.SubmitChanges(ConflictMode.ContinueOnConflict);
    }
    catch{}
} 
```

我现在的一个解决方案是这样做：

```
foreach (WishlistUpvote vote in destinationVotes)
{
    using (linqWishesDataContext dataContext = new linqWishesDataContext())
    {
        try
        {
            dataContext.WishlistUpvotes.InsertOnSubmit(vote);
            dataContext.SubmitChanges();
        }
        catch { }
    }
} 
```

但是，如果有几百或几千张选票需要移动，那么`DataContext`为每张选票创建一个新选票似乎是个坏主意。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T23:26:32.043

无需`DataContext`每次都创建一个新的；您可以重复使用同一个，并像现在一样简单地循环调用，否则。

```
using (linqWishesDataContext dataContext = new linqWishesDataContext())
{
    foreach (WishlistUpvote vote in destinationVotes)
    {
        try
        {
            dataContext.WishlistUpvotes.InsertOnSubmit(vote);
            dataContext.SubmitChanges();
        }
        catch { }
    }
} 
```

当然，这将为每次更新发出单独的命令。（虽然 ADO.NET 连接池仍将在幕后工作，所以它并不*那么*可怕） 如果不手动构建插入的 SQL，我不知道你还能做什么。数据上下文将为`SubmitChanges()`事务中的一次调用执行所有更改，这就是您获得“全有或全无”行为的原因。

# jquery - 这个 jQuery 片段做了什么（为什么）？

> ID：13614154
> 
> 赞同：0
> 
> 时间：2012-11-28T20:51:46.407
> 
> 标签：jquery

```
$("div", $("body")).length 
```

在 qUnit 文档中看到了类似的东西，我以前从未见过类似的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T20:53:49.633

第二个参数是如下语法中的上下文，

> `jQuery( selector [, context] )`
> 
> ```
> selector: A string containing a selector expression
> 
> context: A DOM Element, Document, or jQuery to use as context 
> ```

基本上定义如下，

> 默认情况下，选择器从文档根目录开始在 DOM 中执行搜索。但是，可以使用 $() 函数的可选第二个参数为搜索提供替代上下文。

[http://api.jquery.com/jQuery/](http://api.jquery.com/jQuery/)

# c# - 获取列表框中所选项目的文本

> ID：13614157
> 
> 赞同：10
> 
> 时间：2012-11-28T20:52:07.220
> 
> 标签：c#, winforms

我正在尝试在消息框中显示 listBox1 的选定项目，这是代码：

```
int index;
string  item;
foreach (int i in listBox1 .SelectedIndices )
{
    index = listBox1.SelectedIndex;
    item = listBox1.Items[index].ToString ();
    groupids = item;
    MessageBox.Show(groupids);
} 
```

问题是当我选择多个项目时，消息框会显示我选择的第一个项目并重复消息 EX：如果我选择了 3 个项目，则该消息将与第一个项目一起出现 3 次

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-28T20:56:05.173

您可以像这样遍历您的项目：

```
 foreach (var item in listBox1.SelectedItems)
        {
            MessageBox.Show(item.ToString());
        } 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-28T20:54:09.830

`i`foreach 循环中有您需要的索引。您正在使用`listBox1.SelectedIndex`其中只有第一个。所以项目应该是：

```
item = listBox1.Items[i].ToString (); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-28T21:08:40.673

包含所有选定项目的 1 个消息框怎么样？

```
List<string> selectedList = new List<string>();
foreach (var item in listBox1.SelectedItems) {
   selectedList.Add(item.ToString());
}
if (selectedList.Count() == 0) { return; }
MessageBox.Show("Selected Items: " + Environment.NewLine +
        string.Join(Environment.NewLine, selectedList)); 
```

如果选择了任何一个，这应该为您的消息框中的每个选定项目提供一行。使用 linq 可能有一种更漂亮的方法，但您没有指定 .NET 版本。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-01-26T08:45:06.863

试试这个解决方案：

```
string  item = "";    
foreach (int i in listBox1.SelectedIndices )
    {
       item += listBox1.Items[i] + Environment.NewLine;
    }
MessageBox.Show(item); 
```

# c - 为什么这里需要禁用中断？

> ID：13614162
> 
> 赞同：8
> 
> 时间：2012-11-28T20:52:32.890
> 
> 标签：c, embedded, rtos

```
static void RadioReleaseSPI(void) {
    __disable_interrupt();
    spiTxRxByteCount &= ~0x0100;
    __enable_interrupt();
} 
```

我了解多个任务可能会尝试使用 SPI 资源。`spiTxRxByteCount`是一个全局变量，用于跟踪 SPI 当前是否被另一个任务使用。当任务需要 SPI 时，它可以检查 SPI 的状态`spiTxRxByteCount`以查看是否正在使用 SPI。当使用 SPI 完成任务时，它会调用此函数并清除该位，以指示 SPI 现在空闲。但是为什么要先禁用中断，然后再重新启用它们呢？只是偏执狂？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-28T21:04:18.710

&= 将执行读取-修改-写入操作 - 它不是原子的。您不希望在中间发生中断改变事情，从而导致写入覆盖的值不正确。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-11-28T21:23:43.990

您需要禁用中断以确保原子访问。您不希望任何其他进程在您阅读它时访问并可能修改该变量。

从[介绍到嵌入式计算](http://www.scriptoriumdesigns.com/embedded/interrupts.php)：

> # 原子访问的需求
> 
> 想象一下这种情况：在 8 位 uC 上运行的前台程序需要检查一个 16 位变量，将其称为 X。因此它先加载高字节，然后再加载低字节（或者相反，顺序不没关系），然后检查 16 位值。现在想象一个带有修改该 16 位变量的关联 ISR 的中断。进一步想象，在程序执行的给定时间，变量的值恰好是 0x1234。这是可能发生的非常糟糕的事情：
> 
> *   前台加载高字节（0x12）
> *   ISR 发生，修改 X 为 0xABCD
> *   前台加载低字节（0xCD）
> *   前台程序看到 16 位值 0x12CD。
> 
> 问题是，我们的变量 X 在访问它的过程中实际上被修改了，因为访问该变量的 CPU 指令是可分割的。因此，我们的变量 X 负载已损坏。您可以看到变量读取的顺序无关紧要。如果在我们的示例中顺序颠倒，变量将被错误地读取为 0xAB34 而不是 0x12CD。无论哪种方式，读取的值都不是旧的有效值 (0x1234) 也不是新的有效值 (0xABCD)。
> 
> 编写 ISR 引用的数据也好不到哪里去。这次假设前台程序为了 ISR 的利益已经写入了之前的值 0x1234，然后需要写入一个新的值 0xABCD。在这种情况下，VBT 如下：
> 
> *   前台存储新的高字节（0xAB）
> *   ISR 发生，将 X 读取为 0xAB34
> *   前台存储新的低字节（0xCD）
> 
> 再一次，代码（这次是 ISR）既没有看到之前的有效值 0x1234，也没有看到新的有效值 0xABCD，而是看到了无效的 0xAB34 值。

虽然`spiTxRxByteCount &= ~0x0100;`可能看起来像 C 中的一条指令，但它实际上是 CPU 的几条指令。在 GCC 中编译，程序集清单如下所示：

```
 57:atomic.c      ****     spiTxRxByteCount &= ~0x0100;
  68                    .loc 1 57 0
  69 004d A1000000      movl    _spiTxRxByteCount, %eax
  69      00
  70 0052 80E4FE        andb    $254, %ah
  71 0055 A3000000      movl    %eax, _spiTxRxByteCount
  71      00 
```

如果在任何这些指令之间出现中断并修改数据，您的第一个 ISR 可能会读取错误的值。因此，您需要在对其进行操作之前禁用中断并声明变量[`volatile`](http://tigcc.ticalc.org/doc/keywords.html#volatile)。

# c# - 如何查看所有触发事件以进行控制

> ID：13614163
> 
> 赞同：0
> 
> 时间：2012-11-28T20:52:32.983
> 
> 标签：c#, wpf, events, .net-4.0, triggers

无论如何要查看专门为 ui 控件触发的所有事件。

我已将扩展的 WPF 工具包集成到我的应用程序中，目前面临的问题是 TimePicker 不会触发 ValueChanged，除非它失去焦点。这是可以理解的，但它在控件中有更改值的按钮......所以失去焦点并不理想，因为我需要单击另一个控件。

这是我第一次遇到这种类型的问题，但很多时候我不太确定我想使用哪个事件，所以我只是放了一堆带断点的事件，看看哪个事件在理想的时刻被击中.

出于这个原因，我很想知道是否有任何类型的调试器工具或类似的东西可以注册/显示所有被击中的事件，而无需我在每个事件中设置断点或修改控件代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T04:52:37.860

如果 ValueChanged 是 RoutedEvent，您可以使用 snoop 之类的工具。[http://snoopwpf.codeplex.com/](http://snoopwpf.codeplex.com/)

事件选项卡将在触发事件时向您显示事件（请注意，您必须在下拉列表中选中要收听的事件。

# android - Android：如何将 setOnClickListener/onClick 用于 20 个不同的按钮？

> ID：13614166
> 
> 赞同：1
> 
> 时间：2012-11-28T20:52:40.753
> 
> 标签：android, android-intent, onclick, android-activity, onclicklistener

在我的 Android 应用程序中有一个包含 20 个按钮的活动。每个按钮都必须转到另一个活动/页面。我尝试了几种方法，但我不能多次使用意图。

选项1：

```
public void onClick(View v) {

switch(v.getId()){

case R.id.ivNB: 
   Intent intent = new Intent(this, NoordBrabant.class);
   this.startActivity(intent);
   break;

case R.id.ivZH1: 
   Intent intent = new Intent(this, ZuidHolland.class);
   this.startActivity(intent);
   break;

/**** End so 20 more ****/
} 
```

在第二种情况下，意图不好，我不能在 1 个开关中使用更多意图吗？

选项 2：

```
ivNB.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub
            Intent i = new Intent(getApplicationContext(), NoordBrabant.class);
            startActivity(i);
        }

    });
    ivZeeland.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub
            Intent i = new Intent(getApplicationContext(), Zeeland.class);
            startActivity(i);
        }

    });
/**** End so 20 more ****/ 
```

这种方式与 maby 10 中的 5 个相同，但有 20 个应用程序崩溃。

选项 3：

```
public void onClick(View v) {
        if (v == ivGelderland){
            Intent intent = new Intent(this, Gelderland.class);
            this.startActivity(intent);
        }
        else if (v == ivNB) {
            Intent intent = new Intent(this, NoordBrabant.class);
            this.startActivity(intent);
        }
        else if (v == ivLimburg) {
            Intent intent = new Intent(this, Limburg.class);
            this.startActivity(intent);
        }
/**** End so 20 more ****/ 
```

这种方式根本不起作用，我在这里做错了吗？

请有人可以帮助我，我现在正在为此苦苦挣扎几天！

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:14:31.570

定义一个 HashMap，其中键是 view.getId() 的整数值，值是 Activity 的类。

```
private static HashMap<Integer,Class> activityMap = new HashMap<Intger,Class>();
static {
    activityMap.put( R.id.ivNB, NoordBrabant.class );
    activityMap.put( R.id.ivZH1, ZuidHolland.class );
    //...
}

// use this in the layout xml file for all the buttons onClick attribute
public void handleBtnClicked( View vw ) {
    startActivity( new Intent( this, activityMap.get( vw.getId() ) );
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T21:41:27.783

您可以创建自定义并覆盖 onClick 事件，然后只需传递目标活动。

//自定义按钮

```
import android.content.Context;

import android.content.Intent;

import android.util.AttributeSet;

import android.view.View;

import android.view.View.OnClickListener;

import android.widget.Button;

public class MyBtn extends Button implements OnClickListener {

    private Context context;
    private Class _class;

    public MyBtn(Context context, AttributeSet attrs) {
        super(context, attrs);
        init();
        this.context = context;
    }

    private void init() {
        setOnClickListener(this);
    }

    public void setActivity(Class _class) {
        this._class = _class;
    }

    @Override
    public void onClick(View v) {
        Intent i = new Intent(context, _class);
        this.context.startActivity(i);
    }

} 
```

// 你的布局

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent" android:orientation="vertical" >

    <com.example.mixed.MyBtn
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Button" />

     <com.example.mixed.MyBtn
        android:id="@+id/button2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Button" />

      <com.example.mixed.MyBtn
        android:id="@+id/button3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Button" />

       <com.example.mixed.MyBtn
        android:id="@+id/button4"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Button" />

</LinearLayout> 
```

// 你的主要活动

```
import android.app.Activity;
import android.os.Bundle;

public class MainActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);     

         com.example.mixed.MyBtn btn1 = (com.example.mixed.MyBtn)findViewById(R.id.button1);         
         com.example.mixed.MyBtn btn2 = (com.example.mixed.MyBtn)findViewById(R.id.button2);
         com.example.mixed.MyBtn btn3 = (com.example.mixed.MyBtn)findViewById(R.id.button3);
         com.example.mixed.MyBtn btn4 = (com.example.mixed.MyBtn)findViewById(R.id.button4);

         btn1.setActivity(MainActivity2.class);
         btn2.setActivity(MainActivity3.class);
         btn3.setActivity(MainActivity4.class);
         btn4.setActivity(MainActivity5.class);         

    }   

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T20:55:44.987

使用[android:onClick xml 属性](http://developer.android.com/reference/android/view/View.html#attr_android%3aonClick)将按钮点击映射到方法。

因此，您的活动中基本上可以有 20 种方法，如下所示

```
public void buttonXpressed( View view ){
    startActivity(new Intent(this, MyNextActivity.class));
} 
```

在你的布局 xml

```
<Button .... 
    android:onClick="buttonXpressed"
   ... >
</Button> 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-11-28T21:06:43.997

使用您的选项 1（在切换前声明意图）：

```
public void onClick(View v) {
    Intent intent;
switch(v.getId()){

case R.id.ivNB: 
   intent = new Intent(this, NoordBrabant.class);
   this.startActivity(intent);
   break;

case R.id.ivZH1: 
   intent = new Intent(this, ZuidHolland.class);
   this.startActivity(intent);
   break;

/**** End so 20 more ****/
} 
```

# c++ - 将不匹配“\\s”的正则表达式提升为空格

> ID：13614171
> 
> 赞同：0
> 
> 时间：2012-11-28T20:53:01.330
> 
> 标签：c++, regex, boost, whitespace, boost-regex

我刚开始使用 boost 和 c++，我正在努力理解 boost 的正则表达式引擎在匹配空格时的行为。如果我使用代码：

```
boost::regex rx(" ");
cout << regex_search(" ", rx); 
```

匹配空格，然后一切都按预期工作，并且 regex_search 返回 true。但是，如果我尝试用“\s”替换正则表达式以匹配所有空白字符，我永远不会得到匹配，并且以下代码总是输出 false：

```
boost::regex rx("\\s");
cout << regex_search(" ", rx); 
```

我在这里想念什么？

根据要求，这是我的完整测试用例：

```
#include <boost/regex.hpp>
#include <iostream>

using namespace std;

int main()
{
    boost::regex rx("\\s", boost::regex::icase);
    cout << regex_search(" ", rx);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T08:54:24.180

明白了——我最初使用的是来自ascend4.org/Binary_installer_for_Boost_on_MinGW 的预建库。构建 Boost 1.52 后，代码按预期工作。试图缩短提升构建过程最终让我花费了几个小时的挫败感......我现在已经吸取了教训！

# javascript - 递归javascript函数

> ID：13614173
> 
> 赞同：-3
> 
> 时间：2012-11-28T20:53:03.873
> 
> 标签：javascript, recursion

这是文件 1：

```
file1
include file2; 
```

这是文件2：

```
file2
include file3; 
```

这是文件 3：

```
file3
include file4; 
```

这是文件4：

```
file4 
```

最终结果应该是：

```
file1
file2
file3
file4 
```

这有什么问题？

```
function recurse(data, callback) {
    if (data.match(/include(.*)\;/)) {
        var fn = data.match(/include(.*)\;/)[1];
        var filetxt = readfile(fn);
        recurse(filetxt, callback);
    } else {
        callback(data);
    }
}
var txt = recurse(readfile('file1'), function(s) {
    console.log(s);
}) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T21:00:11.060

将您的正则表达式更改为

```
/include (.*)\;/ 
```

以便匹配组捕获`"fileN"`而不是`" fileN"`（注意前导空格）。

# c++ - C++ 中的表达式 'ab' == "ab" 是否为真

> ID：13614174
> 
> 赞同：5
> 
> 时间：2012-11-28T20:53:09.853
> 
> 标签：c++, types, normalization

我的问题听起来可能很愚蠢，但我必须在准备学士考试时回答它。

那么，您如何看待 C++ 中这样的表达式 'ab' == "ab"？这不是真的还是根本不合法和编译错误？我用谷歌搜索了一下，知道'ab'是int类型，而“ab”当然不是......

我必须考虑的不是编译器所说的，而是语言的正式描述。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-28T20:57:07.447

它肯定会生成一个警告，但默认情况下`gcc`会编译它。它通常应该是错误的。

话虽如此，理论上应该是可能的，当然取决于您运行它的平台，`"ab"`在内存位置具有编译时常量，其地址的数值等于'ab'的数值，表达式为真的情况（尽管比较当然没有意义）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-28T21:35:17.270

在 C 和 C++ 中的表达式`'ab' == "ab"`都是无效的。它没有任何意义。两种语言都不允许将任意整数值与指针值进行比较。因此，它是否“真实”的问题甚至不会出现。为了将其转换为可编译的表达式，您必须将操作数显式转换为可比较的类型。

这里唯一的漏洞是多字符字符常量的值是实现定义的。如果在某些实现中 的值`'ab'`恰好为零，则它可以用作空指针常量。在这种情况下`'ab' == "ab"`，等于`0 == "ab"`和`NULL == "ab"`。这保证是假的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-28T20:57:15.027

它会给你一个警告，但它会建立。它将多字节整数“ab”与字符串文字“ab”的地址进行比较。

最重要的是，比较的结果不会反映字母是否相同的选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-28T21:26:18.267

让我们考虑一下简单 C 中的部分，'c' 是一个简单的字符，如果你想操作字符串，你将不得不使用字符数组，因此'ca' 不应该按照你期望的方式工作，并且在 c++ 中这东西仍然有效。如果要使用字符串，则必须使用不是原始类型的 String 类。它所做的只是一个具有方法和类型定义的类，因此您可以更轻松地处理数组字符。结果，即使是 C 样式字符串和字符数组也是不同的东西，结果 'ab' == "ab" 不会给出有效的布尔响应。这就像尝试将 int 与字符串进行比较。所以，这个comaprison 很可能会抛出一个错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-28T21:08:35.633

标准对于将整数类型与指针进行比较完全没有什么可说的。它所说的只是以下内容（在第 5.9 节中）：

> 操作数应具有算术、枚举或指针类型，或类型 std::nullptr_t...

然后详细描述了比较两个指针的含义，并提到了比较两个整数。所以我对缺乏规范的解释是“无论编译器作者决定什么”，这要么是错误，要么是警告。

# c - 在linux中，是否可以对常规文件进行部分读取

> ID：13614181
> 
> 赞同：0
> 
> 时间：2012-11-28T20:53:40.313
> 
> 标签：c, linux

我需要编写一个以非常快的速度将日志条目吐出到常规文件的应用程序。此外，还有另一个进程可以同时读取同一个文件，其他进程将写入它。我有以下问题

1.  read() 如何确定 EOF，特别是在底层文件可能同时被修改的情况下？

2.  read() 是否可以从其他进程写入返回部分写入的数据？例如，写过程写了半行，读会选择那半行并返回？

该应用程序将使用 Ex4 文件系统在 linux 2.6.x 上用 C 语言编写

更新：下面的链接指向补丁，在读写之前将 inode 锁定在 EXT4 中。 [http://patchwork.ozlabs.org/patch/91834/](http://patchwork.ozlabs.org/patch/91834/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-28T21:01:47.113

> read() 如何确定 EOF，特别是在底层文件可能同时被修改的情况下？

当您尝试`read()`越过文件末尾时，它会返回`EOF`. 您仍然可以来回查找文件并再次读取（仅当文件描述符引用文件而不是管道或套接字时）。

> read() 是否可以从其他进程写入返回部分写入的数据？例如，写过程写了半行，读会选择那半行并返回？

很有可能。

# c# - 在 C# 中使用 SQL Server 调用存储过程错误

> ID：13614182
> 
> 赞同：-7
> 
> 时间：2012-11-28T20:53:38.667
> 
> 标签：c#, database, sql-server-2005

> **可能重复：**
> [存储过程返回到 C# .Net 中的 DataSet](https://stackoverflow.com/questions/12973773/stored-procedure-return-into-dataset-in-c-sharp-net)

如何使用 C# 从我的项目中调用存储过程？我需要将该存储过程的输出放入数据表中，但出现错误。

**代码：**

```
private string connectionString = "Provider=SQLOLEDB.1;Persist Security Info=False;Integrated Security=SSPI;Initial Catalog=blablalbla;";
    private DataTable dtProductPrijsActueel = new DataTable();
    public DataTable productPrijsActueel()
    {
        SqlConnection conn = new SqlConnection(connectionString);
        conn.Open();
        SqlCommand comm = conn.CreateCommand();
        comm.CommandType = CommandType.StoredProcedure;
        comm.CommandText = "procSelectPrijsActueel";

        dtProductPrijsActueel.Load(comm.ExecuteReader());
        conn.Close();
        conn.Dispose();

        return dtProductPrijsActueel;
    } 
```

**错误：**

```
ERROR : KEYWORD NOT SUPPORTED : 'PROVIDER' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:01:10.077

这*确实*是应该刚刚被谷歌搜索的东西，但是您正在寻找的一般代码看起来像这样：

```
 string connect = System.Configuration.ConfigurationManager.AppSettings["conn"];
  SqlConnection connection = new SqlConnection(connect);
  string spName = "TheSpName";

  SqlCommand spCmd = new SqlCommand(spName, connection);
  spCmd.CommandType = CommandType.StoredProcedure;

  spCmd.Parameters.Add("@SomeParam", SqlDbType.String).Value = "Some Parameter";

  connection.Open();

  var dataTableReader = spCmd.ExecuteReader(); 
```

# c# - C# 中的内部属性设置器

> ID：13614190
> 
> 赞同：16
> 
> 时间：2012-11-28T20:54:07.157
> 
> 标签：c#, properties, setter, internal

我正在尝试找出解决此问题的好方法。我有一个实现 ICustomer 接口的 Customer 类。这个接口有很多属性：

```
public interface ICustomer
{

   string FirstName {get; set;}
   string LastName  {get; set;}
} 
```

但是，我只希望某些类能够设置这些属性；即项目中的那些类。所以我想制作二传手`internal`：

```
public class Customer : ICustomer
{

   string FirstName {get; internal set;}
   string LastName  {get; internal set;}
} 
```

但是，我想将该设置器标记为接口中的内部，因此不可能有人实现 ICustomer 并且程序集之外的人修改这些属性。有没有好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-11-28T20:58:07.063

接口中的属性应该是只读的。实现接口的具体类有一个setter是可以接受的，即使接口中没有定义。

```
public interface ICustomer
{
   string FirstName { get; }
   string LastName  { get; }
}

public class Customer : ICustomer
{
   public string FirstName { get; internal set; }
   public string LastName  { get; internal set; }
} 
```

如果通过接口公开设置器真的很重要，而不是让接口完全只读，你可以使用这样的东西：

```
public interface IReadCustomer
{
    string FirstName { get; }
    string LastName { get; }
}

internal interface IWriteCustomer
{
    string FirstName { set; }
    string LastName { set; }
}

internal interface IReadWriteCustomer : IReadCustomer, IWriteCustomer
{ }

public class Customer : IReadWriteCustomer
{
    private string _firstName;
    private string _lastName;

    public string FirstName
    {
        get { return _firstName; }
        internal set { _firstName = value; }
    }
    public string LastName
    {
        get { return _lastName; }
        internal set { _lastName = value; }
    }

    string IReadCustomer.FirstName
    {
        get { return FirstName; }
    }

    string IReadCustomer.LastName
    {
        get { return LastName; }
    }

    string IWriteCustomer.FirstName
    {
        set { FirstName = value; }
    }

    string IWriteCustomer.LastName
    {
        set { LastName = value; }
    }
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-28T20:59:15.300

> 但是，我想将该设置器标记为接口中的内部，因此不可能有人实现 ICustomer 并且程序集之外的人修改这些属性。有没有好的方法来做到这一点？

不，不幸的是，财产成员*始终是公开的。*此外，在接口上指定部分属性的访问级别搞乱会很痛苦，IIRC。你*可以*做的是：

```
public interface ICustomer
{
    string FirstName { get; }
    string SecondName { get; }
}

internal interface ICustomerWithSetMethods : ICustomer
{
    void SetFirstName(string name);
    void SetLastName(string name);
}

public class Customer : ICustomerWithSetMethods 
```

然后从*外面*看，它看起来`Customer`只是 implements `ICustomer`，但从*内部*你的代码会看到它 implements `ICustomerWithSetMethods`。

不幸的是，如果您的 API 需要声明任何您*真正*想声明返回类型为 的公共方法，这并不能很好地发挥作用`ICustomer`，但您实际上会知道它总是`ICustomerWithSetMethods`.

假设您仍然希望允许多个实现，您可能会选择一个抽象类：

```
public abstract class CustomerBase
{
    public abstract string FirstName { get; }
    public abstract string LastName { get; }

    internal abstract void SetFirstName(string name);
    internal abstract void SetLastName(string name);
} 
```

`CustomerBase`现在我们有点奇怪，程序集之外的任何人都无法扩展*您*的`CustomerBase`.

这就是我们在[Noda Time](https://nodatime.org/)中最终为日历系统采用的方法——当我第一次想出这个计划时，我[在博客上写过它。](https://codeblog.jonskeet.uk/2010/10/03/the-curious-case-of-the-publicity-seeking-interface-and-the-shy-abstract-class/)我*通常*更喜欢接口而不是抽象类，但这里的好处是显着的。

# php - PHP输出包含两个空格甚至没有找到结果

> ID：13614200
> 
> 赞同：0
> 
> 时间：2012-11-28T20:54:34.207
> 
> 标签：php, mysql

我使用下面的 php 代码将 MYSQL 数据库搜索的结果发送到 AJAX 请求...

```
$query = $db->query("SELECT name FROM search WHERE qurl = '" . $queryString . "'");

if($query) {

    while ($result = $query ->fetch_object()) {             
           echo $result->name; 
    }
} else { echo 'no results found'; } 
```

但即使没有结果，我也从来没有收到**未找到结果**的消息，如果没有结果，我只会得到`two empty spaces`- 我发现在 AJAX 页面中使用 alert(data.length)，结果为 2，这意味着 php 输出有两个空格没有结果...

但是当有结果时它工作正常......

删除这两个空格的任何方式或为什么我没有收到**未找到结果**的消息？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T20:57:25.467

```
if ($query->num_rows > 0) {
  while ...
} else {
  echo 'no results found';
} 
```

`$db->query()`仅`false`在执行查询出错时返回。空结果集不是错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T20:57:15.683

您正在评估的是该语句是否有效......它是有效的，并且将始终返回 true。要评估返回的结果，您需要评估 $query->num_rows

# python-2.7 - 如何将字符串中的python字典中的键和值转换为int/float？

> ID：13614201
> 
> 赞同：1
> 
> 时间：2012-11-28T20:54:35.077
> 
> 标签：python-2.7

我有一本字典

```
d = { '0' : ['1', '2', '3'], '1' : ['4', '5'], '4' : ['6'] } 
```

我需要将键和值转换为`int`/ `float`，例如：

```
d = {0 : [1,2,3], 1:[4,5], 4:[6]} 
```

我该怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-28T21:05:03.030

```
d = dict((float(k), map(float, v)) for k, v in d.iteritems()) 
```

如果您希望某些项目是`int`, some ，请使用带有此功能的`float`替换：`float`

```
def int_float_str(s):
    if s.isdigit():
        return int(s)
    else:
        try:
            return float(s)
        except ValueError:
            return s 
```

# android - Android：将LinearLayouts扩展为项目的ListView会导致重复

> ID：13614203
> 
> 赞同：0
> 
> 时间：2012-11-28T20:54:43.770
> 
> 标签：android, listview, scroll, duplicates, expandable

我正在尝试编写一个由几个片段组成的测试应用程序。
一个片段应包含设备中所有音乐艺术家的列表视图。
这个列表的每个项目都是一个线性布局，以一个带有艺术家姓名的 TextView 开头，下面是一个空的线性布局，如下所示：
该列表是这个布局的：

```
<ListView
    android:id="@+id/artistsLists"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:layout_centerHorizontal="true"
    android:layout_centerVertical="true" >
</ListView> 
```

每个项目的布局如下：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical" >

    <TextView
        android:id="@+id/artistName"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:textSize="24sp"
        android:text="" />

    <LinearLayout
        android:id="@+id/artistsAlbums"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical" >
    </LinearLayout>

</LinearLayout> 
```

我通过以下方式使用 SimpleCursorAdapter 填充列表：

```
public class MusicTabFragment extends Fragment 
{

public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState)
{
    View view = inflater.inflate(R.layout.fragment_music_tab,container,false);

    Cursor artistsCursor = getActivity().getContentResolver().query(Audio.Artists.EXTERNAL_CONTENT_URI, new String[]{Audio.Artists.ARTIST,Audio.Artists._ID}, null, null,Audio.Artists.ARTIST);

    SimpleCursorAdapter adapter = new SimpleCursorAdapter(view.getContext(), R.layout.music_artist_list_item_layout, artistsCursor, new String[]{Audio.Artists.ARTIST},new int[]{R.id.artistName},0 );

    ListView lView = (ListView)view.findViewById(R.id.artistsLists);
    lView.setAdapter(adapter);
    lView.setOnItemClickListener(new OnItemClickListener()
        {
            public void onItemClick(AdapterView<?> parent, View view, int position, long id) 
            {
                ((LinearLayout)view.findViewById(R.id.artistsAlbums)).removeAllViews();

                Cursor albumsCursor = getActivity().getContentResolver().query(Audio.Artists.Albums.getContentUri("external", ((Cursor)parent.getItemAtPosition(position)).getLong(1)), new String[]{Audio.Albums.ALBUM, Audio.Albums._ID},null,null,null);

                LinearLayout artistLayout = (LinearLayout)view.findViewById(R.id.artistsAlbums);

                for(albumsCursor.moveToFirst();!albumsCursor.isAfterLast();albumsCursor.moveToNext())
                {
                    View albumView = LayoutInflater.from(view.getContext()).inflate(android.R.layout.simple_list_item_1,artistLayout,false);
                    ((TextView)albumView.findViewById(android.R.id.text1)).setText(albumsCursor.getString(0));
                    artistLayout.addView(albumView);
                }

                Log.d("POPULATE","populated again!");
                albumsCursor.close();
            }
        });

    return view;
}
} 
```

这工作得很好。当我单击艺术家姓名时，线性布局会填充所有此艺术家专辑名称。问题是，一旦 linearLayout 滚动出视图，它会再次从视图的另一边缘（PacMan 样式）显示，就好像另一个列表项的 linearLayout 已填充一样。每次扩展的布局消失时都会发生这种情况。有趣的是，有时向上滚动时，linearLayout 会以不同的艺术家名称显示。
[例子](https://www.dropbox.com/s/3kyb4knxrfw4plr/Screenshot_2012-11-28-22-49-36.png)

我很高兴听到我应该如何实现这个片段。但我也想知道为什么会导致这种行为。

谢谢，
毛尔。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T08:57:27.333

我在 stackoverflow.com 找到了解决方案 看来视图不应该保存任何数据，因为当我向后滚动和第四次滚动时它被用于不同的数据。

I think holding an external data structure to save each virtual view state is not nice programming. is there a way to keep this data anyway? (for this i will be looking now)

# c# - .Net 图表将日期显示为一周中的几天

> ID：13614209
> 
> 赞同：3
> 
> 时间：2012-11-28T20:55:04.377
> 
> 标签：c#, .net, data-binding, charts

我正在用 C# 制作一个链接到捐赠数据的图表。每周，总捐款记录在表格中。该图表提取这些数字并将它们绘制成折线图。

我遇到的问题是每周都被记录为一周中的一天，因此应该基于周工作的控件无法正常工作。我附上了我的代码和下面的结果图片。

我想知道为什么这里的每个数据点都显示为一周中的一天。这是我加载数据的方式吗？

感谢您提供的任何帮助。

这是我的代码：

```
 #region Chart4
        string DonationSelect = this.DonationSelect.SelectedValue;
        Time = Convert.ToInt32(DonationSelect);

        if (Time > 3)
            Chart4.Series[0].IsValueShownAsLabel = false;
        else
            Chart4.Series[0].IsValueShownAsLabel = true;

        Chart4.Series[0].ChartType = SeriesChartType.Line;
        Chart4.ChartAreas["ChartArea1"].AxisX.IsMarginVisible = true;

        StartDate = GetNextDay(DateTime.Today, DayOfWeek.Sunday);
        TargetDate = GetNextDay(StartDate.AddMonths(-1 * Time), DayOfWeek.Sunday);

        for (DateTime i = TargetDate; i <= DateTime.Now; i = i.AddDays(7))
        {
            int Donations = 0;
            var oDonation = oDatabase.ExecuteScalar(@"SELECT Offering FROM 
            tblStats WHERE Date=@Date",
                "Date", i);

            if (oDonation != null && oDonation != DBNull.Value)
            {
                Donations = Convert.ToInt32(oDonation);
            }
            //int Attendance = Convert.ToInt32();

            string Date = i.ToShortDateString();

            Chart4.Series[0].Points.AddXY(Date, Donations);
        }

        StripLine StripLine = new StripLine();

        StripLine.BackColor = Color.LightGray;
        StripLine.Interval = 1;
        StripLine.IntervalType = DateTimeIntervalType.Weeks;
        StripLine.StripWidth = .5;
        StripLine.StripWidthType = DateTimeIntervalType.Weeks;
        StripLine.IntervalOffset = 0;
        StripLine.IntervalOffsetType = DateTimeIntervalType.Days;

        Chart4.Legends.Add(new Legend("Legend3"));
        Chart4.Series[0].Legend = "Legend3";
        Chart4.Series[0].IsVisibleInLegend = true;
        Chart4.Series[0].LegendText = "Donations";
        Chart4.BorderSkin.SkinStyle = BorderSkinStyle.Emboss;
        Chart4.BackColor = Color.PowderBlue;
        Chart4.Series[0].BorderWidth = 3;
        Chart4.Series[0].BorderColor = Color.Orange;
        Chart4.ChartAreas["ChartArea1"].AxisX.Title = "Date";
        Chart4.ChartAreas["ChartArea1"].BackColor = Color.LightGray;
        Chart4.ChartAreas["ChartArea1"].BackSecondaryColor = Color.White;
        Chart4.ChartAreas["ChartArea1"].BackGradientStyle = GradientStyle.TopBottom;
        Chart4.ChartAreas["ChartArea1"].AxisX.StripLines.Add(StripLine);
        #endregion 
```

![捐赠图](../Images/92756d6a79c212f4856658741d8dee3a.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T08:42:28.913

根据[http://msdn.microsoft.com/en-us/library/system.globalization.calendar.getweekofyear.aspx](http://msdn.microsoft.com/en-us/library/system.globalization.calendar.getweekofyear.aspx)，您可以尝试替换这些行：

```
string Date = i.ToShortDateString();
Chart4.Series[0].Points.AddXY(Date, Donations); 
```

和那些 ：

```
 DateTimeFormatInfo dfi = DateTimeFormatInfo.CurrentInfo;
  Calendar cal = dfi.Calendar;
  Chart4.Series[0].Points.AddXY(cal.GetWeekOfYear(i, dfi.CalendarWeekRule, 
                                      dfi.FirstDayOfWeek), Donations); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T14:05:34.207

好的，所以我昨天又摆弄了很多，这就是问题所在： string Date = i.ToShortDateString();

```
 Chart4.Series[0].Points.AddXY(Date, Donations); 
```

问题是，为了使日期正常工作，需要将它们作为`DateTime`变量而不是字符串添加到轴中。因此，任何与周一起工作的东西都简单地以 7 个字符串为单位计算。正确的代码在这里：

```
 Chart4.Series[0].Points.AddXY(i, Donations); 
```

感谢您为我指明正确的方向！

# asp.net - .aspx 页面无法正确呈现

> ID：13614210
> 
> 赞同：0
> 
> 时间：2012-11-28T20:55:04.157
> 
> 标签：asp.net, iis-7

问题：

.aspx 页面不会呈现与母版页相关联的 css

查看图像按住 ctrl 并使用鼠标滚轮放大

![在此处输入图像描述](../Images/a234cbbd6ad46fbdfa962c54e918d6fd.png)

设置：

1.  IIS 7 Windows 2008 r2 服务器
2.  .Net 框架 4.0
3.  我使用了 aspnet_regiis.exe -i
4.  启用静态内容
5.  已经有一个站点正在运行，在其层次结构中创建了一个虚拟目录并将文件放置在其中

截图页面的页面指令：

```
<%@Page Title="" Language="C#" MasterPageFile="~/Site.Master" AutoEventWireup="true" CodeBehind="Solomon Conversion.aspx.cs" Inherits="AcuFinal.Solomon_Conversion" %> 
```

母版页的 Asp.Net 代码：

```
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head runat="server">
    <title></title>
    <link href="~/Styles/Site.css" rel="stylesheet" type="text/css" />
    <asp:ContentPlaceHolder ID="HeadContent" runat="server">
    </asp:ContentPlaceHolder>
</head>
<body>
    <form runat="server">
    <div class="page">
        <div class="header">
            <div class="title">
                <h1>
                    AcuConvert
                </h1>
            </div>
            <div class="loginDisplay">
                <asp:LoginView ID="HeadLoginView" runat="server" EnableViewState="false">
                    <AnonymousTemplate>
                        [ <a href="~/Account/Login.aspx" ID="HeadLoginStatus" runat="server">Log In</a> ]
                    </AnonymousTemplate>
                    <LoggedInTemplate>
                        Welcome <span class="bold"><asp:LoginName ID="HeadLoginName" runat="server" /></span>!
                        [ <asp:LoginStatus ID="HeadLoginStatus" runat="server" LogoutAction="Redirect" LogoutText="Log Out" LogoutPageUrl="~/"/> ]
                    </LoggedInTemplate>
                </asp:LoginView>
            </div>
            <div class="clear hideSkiplink">
                <asp:Menu ID="NavigationMenu" runat="server" CssClass="menu" EnableViewState="false" IncludeStyleBlock="false" Orientation="Horizontal">
                    <Items>
                        <asp:MenuItem NavigateUrl="~/Default.aspx" Text="Home"/>
                        <asp:MenuItem NavigateUrl="~/Conversion Data Validation.aspx" 
                            Text="Conversion Data Validation" Value="Conversion Data Validation"/>
                        <asp:MenuItem Text="Solomon Conversion" Value="Solomon Conversion" 
                            NavigateUrl="~/Solomon Conversion.aspx">
                        </asp:MenuItem>
                    </Items>
                </asp:Menu>
            </div>
        </div>
        <div class="main">
            <asp:ContentPlaceHolder ID="MainContent" runat="server"/>
        </div>
        <div class="clear">
        </div>
    </div>
    <div class="footer">

    </div>
    </form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:03:04.870

```
 <link href="~/Styles/Site.css" rel="stylesheet" type="text/css" /> 
```

应该

```
 <link href="<%= Page.ResolveUrl("~/Styles/Site.css") %>" rel="stylesheet" type="text/css" /> 
```

当它们不是服务器控件的属性时，其他包含虚拟路径的 url 也应该如此。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T21:09:10.327

尝试 ：

```
<link href="<%=Url.Content("~/Styles/Site.css") %>" rel="stylesheet" type="text/css" /> 
```

# javascript - Highcharts - 仅将工具提示添加到某些动态添加的系列

> ID：13614211
> 
> 赞同：1
> 
> 时间：2012-11-28T20:55:25.763
> 
> 标签：javascript, highcharts

使用 highcharts，我将多个系列添加到现有图表中。添加系列时，我需要能够根据添加的系列打开或关闭工具提示。

这是我所在的位置：

* * *

```
widget.chart.addSeries({
      data: newSeries, 
      color: color, 
      tooltip: { 
        enabled: true, 
        formatter: function() { 
          return 'test';
        }  
      }
    }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T23:36:41.683

试试这个。

内部`chart`选项。

```
tooltip: {
    formatter: function() {
        var text = false;
        if(this.series.name == "GOOG") {
        // just an example of serie name
        // you can use index or other data too
            text = 'test';
        }

        return text;
    }
} 
```

[**演示**](http://jsfiddle.net/guNPL/)

# php - 为什么我可以访问父 php 类中的私有属性？

> ID：13614214
> 
> 赞同：2
> 
> 时间：2012-11-28T20:55:37.200
> 
> 标签：php, class

我们最近发现了这种奇怪的 PHP 行为。访问父类中的私有不应该工作。这是一个功能吗？也许有人可以解释一下。

```
// PHP classes

class Father {
    // private property
    private $value = 'test';
}

Class Child extends Father {

    // Should fail, se
    public function setValue() {
     $this->value = 'why does';
    }

    public function getValue() {
     return $this->value;
    }
}

$c = new Child();

// should fail!
$c->setValue();
echo $c->getValue() . "|";

// should fail!!!!!!!
$c->value = "it work?";
echo $c->getValue();

// output: why does|it work? 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-28T20:58:17.797

你不是在改变父亲的私有财产，而是`value`为孩子引入一个新的财产。

# oracle - 数据比较oracle（源到目标）

> ID：13614221
> 
> 赞同：0
> 
> 时间：2012-11-28T20:56:12.600
> 
> 标签：oracle, data-comparison

我在下面有一个来自源的查询，这是如何派生目标的活动标志

```
 select case when active_end_date is null then 'Y' else 'N' end
    from csi_item_instances cii
    where instance_id = <<INSTALL BASE ID>> --- (MP.INSTALL_BASE_ID) 
```

我正在使用下面的 SQL 比较活动字段值，有更好的方法吗？

```
 select * from stgdba.Stg_s_csi_item_instances cii, MDHDBA.M_CUSTOMER_PRODUCT mp
    where cii.instance_id= MP.INSTALL_BASE_ID
    and cii.active_end_date is null
    and MP.ACTIVE_FLAG = 'N' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T21:00:40.200

如果要像这样永久计算该值，您可以在视图/计算列中执行此操作，这将使逻辑更加永久并且不会在所有地方重复。

（在风格上，我也会尝试更多地使用 ANSI 连接。）

# jenkins - 程序在 IDE 中编译良好，但在命令行上无法编译

> ID：13614223
> 
> 赞同：2
> 
> 时间：2012-11-28T20:56:17.640
> 
> 标签：jenkins, c++builder, c++builder-xe

我的一个构建遇到了一些问题。我正在使用 Jenkins 构建 builderXE 项目，但出现以下错误。

```
C:\Program Files\Embarcadero\RAD Studio\8.0\Bin\CodeGear.Cpp.Targets(2341,5): error : Error: Unresolved external '__fastcall Sqlexpr::TSQLQuery::~TSQLQuery()' referenced from    C:\JENKINS\WORKSPACE\project\STRINGLOOKUPFRMCODE.OBJ
C:\Program Files\Embarcadero\RAD Studio\8.0\Bin\CodeGear.Cpp.Targets(2341,5): error : Error: Unresolved external '__fastcall Sqlexpr::TCustomSQLDataSet::~TCustomSQLDataSet()' referenced from C:\JENKINS\WORKSPACE\project\STRINGLOOKUPFRMCODE.OBJ
C:\Program Files\Embarcadero\RAD Studio\8.0\Bin\CodeGear.Cpp.Targets(2341,5): error : Error: Unresolved external '__fastcall Sqlexpr::TCustomSQLDataSet::ParamByName(const System::UnicodeString)' referenced from C:\JENKINS\WORKSPACE\project\STRINGLOOKUPFRMCODE.OBJ
C:\Program Files\Embarcadero\RAD Studio\8.0\Bin\CodeGear.Cpp.Targets(2341,5): error : Error: Unable to perform link 
```

我读到可以使用 rsvars.bat 修复路径，但是当我尝试时没有任何反应。这是我尝试过的。

```
"C:\Program Files\Embarcadero\RAD Studio\8.0\bin\rsvars.bat" MSBuild "/t:Clean;Build" "/p:config=Release" "C:\jenkins\workspace\project\myProject.cbproj" 
```

该项目在 builderXE 中编译没有问题，但是当我使用 Jenkins 或仅使用命令行时，我得到了这些错误。我需要做什么才能让它再次工作。

更新：我已经用我正在使用的脚本更新了我的帖子。

```
set PATH="C:\Program Files\Embarcadero\RAD Studio\8.0\lib\win32\release;C:\Program  Files\Embarcadero\RAD Studio\8.0\bin;C:\Documents and Settings\All Users\Documents\RAD Studio\8.0\Bpl;C:\Program Files\Embarcadero\RAD Studio\7.0\bin;C:\Documents and Settings\All Users\Documents\RAD Studio\7.0\Bpl;C:\PROGRA~1\Serena\vm\win32\bin;C:\PROGRA~1\Serena\vm\common\bin\win32;C:\PROGRA~1\Borland\CBUILD~1\Projects\Bpl;C:\PROGRA~1\Borland\CBUILD~1\Bin;%SystemRoot%\system32;%SystemRoot%;%SystemRoot%\System32\Wbem;C:\Program Files\Wave Systems Corp\Dell Preboot Manager\Access Client\v5\;C:\Program Files\Microsoft SQL Server\90\Tools\binn\;C:\tmssoftware\TMS Component Pack\bpl\;C:\Program Files\SmartBear\Automated Build Studio\bin;C:\Program Files\Mercurial;C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727;C:\Program Files\borland\CBuilder5\Bin;C:\Program Files\Embarcadero\RAD Studio\8.0\bin;C:\Program Files\Embarcadero\RAD Studio\7.0\bin;%IMPLIB%;%ADV%\x86;C:\Program Files\TortoiseHg\;C:\Python26;C:\Program Files\Embarcadero\RAD Studio\8.0\lib\win32\debug;"

call "C:\Program Files\Embarcadero\RAD Studio\8.0\bin\rsvars.bat"
MSBuild "C:\jenkins\workspace\project\myProject.cbproj" "/t:Clean;Build" "/p:config=Release" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T14:10:15.327

在 Jenkins 中，您是否使用“执行 Windows 批处理命令”来进行这些调用？如果是这样，试试这个：

```
call "C:\Program Files\Embarcadero\RAD Studio\8.0\bin\rsvars.bat"
MSBuild "/t:Clean;Build" "/p:config=Release" "C:\jenkins\workspace\project\myProject.cbproj" 
```

该`call`命令将运行批处理文件并设置当前会话中的所有环境变量。然后，这些将可用于您的 MSBuild 调用。

还要确保您需要的任何 dll 都在当前的 %PATH% 中。您可以通过以下方式做到这一点：

```
set PATH=<your_dll_path_here>;%PATH% 
```

这应该在一开始就完成。

# .net - 仅获取 xml 节点的文本

> ID：13614225
> 
> 赞同：1
> 
> 时间：2012-11-28T20:56:18.977
> 
> 标签：.net, xml

我有这个xml：

```
 <root>      
      <sub>maintext1
        <subsub>subtext1</subsub>
        <subsub>subtext2</subsub>
      </sub>          
    </root> 
```

我最初尝试了 <sub>.Value，但这会返回 sub 内的所有内容，然后返回执行相同操作的 <sub>.ToString。我搜索了一个解决方案，但到处都使用了 xmlElement.InnerText 但我需要它来处理不可用的 xElement。如何使用 xElement 的内部文本属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:09:16.130

`maintext1`创建一个文本节点，因此您可以执行以下操作：

```
var xml = @"<root>      
<sub>maintext1
<subsub>subtext1</subsub>
<subsub>subtext2</subsub>
</sub>          
</root>";
var doc = XDocument.Parse(xml);
var txt = (IEnumerable<object>)doc.XPathEvaluate("/root/sub/text()");
var textNode = (XText)txt.First();
Console.WriteLine(textNode.Value); 
```

请注意，您需要为此导入以下命名空间才能编译：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Xml.Linq;
using System.Xml.XPath; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T21:18:02.877

您可以通过在方法的返回值上`XElement`使用 Linq 扩展来获取特定类型的所有节点。`OfType``Nodes`

```
XElement.Nodes().OfType<XText>() 
```

这个例子得到了你正在寻找的价值，我认为：

```
var xml = 
    @"<root>      
       <sub>maintext1
        <subsub>subtext1</subsub>
        <subsub>subtext2</subsub>
       </sub>          
      </root>";
var xel = XElement.Parse(xml);
var textNodes = xel.Element("sub").Nodes().OfType<XText>();
var mainText1 = textNodes.First().Value; 
```

# configuration - Sphinx searchd 守护进程配置致命错误

> ID：13614226
> 
> 赞同：2
> 
> 时间：2012-11-28T20:56:22.313
> 
> 标签：configuration, full-text-search, sphinx, config, indexer

我对 sphinx searchd 配置有疑问。索引和索引器正在工作，因为我可以使用搜索工具对索引运行查询。但是当我使用 searchd --config 时，我收到错误：警告：索引：锁定：无法锁定 index.spl，没有这样的文件或目录：不提供服务致命：没有有效的索引可供服务。

我授予了数据文件夹的权限，并使用我的管理员帐户登录了该服务，因此我怀疑这是权限问题。

我已经尝试解决它 2 天了，但没有成功，也没有人提出任何建议。我真的很感激任何帮助。

有没有人有任何想法？

非常感谢。

# c# - 将制表位添加到 pdf

> ID：13614239
> 
> 赞同：0
> 
> 时间：2012-11-28T20:56:59.560
> 
> 标签：c#, pdf, tabstop, winnovative

我们使用一个名为 Winnovative 的库来创建带有数字签名输入的 PDF。我想知道是否有可能以及如何在这些位置添加制表位。我希望我能提供某种尝试的证据，但我真的不知道从哪里开始，在这里。任何与创建制表位相关的信息都会有所帮助。

我知道这个问题有点含糊——如果它含糊不清，请提出一种编辑方法，以便我改进问题。

# c# - VSIX：打开浏览器窗口

> ID：13614242
> 
> 赞同：1
> 
> 时间：2012-11-28T20:57:07.507
> 
> 标签：c#, visual-studio-2010, vsix

我的 Visual Studio 扩展生成一个 URL，我想在 Visual Studio 中将它作为新选项卡打开。

我可以`Process.Start()`用来打开外部浏览器，但这看起来不太好。

我可以使用这种方法从磁盘打开文件：

```
void OnOpenBrowserWindow(string url)
  {
     if (url != null)
     {
        IVsCommandWindow service = (IVsCommandWindow) this.GetService(typeof (SVsCommandWindow));
        if (service != null)
        {
           string command = string.Format("File.OpenFile \"{0}\"", url);
           service.ExecuteCommand(command);
        }
     }
  } 
```

但它不适用于 URL

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T22:13:02.733

最简单的方法是使用[ItemOperations.Navigate()](http://msdn.microsoft.com/en-us/library/envdte.itemoperations.navigate%28v=vs.80%29.aspx)方法。

```
var itemOps = Dte.ItemOperations;
itemOps.Navigate("http://bing.com"); 
```

# java - 使用 ObjectStreams over Sockets 传输 Java Key Object

> ID：13614243
> 
> 赞同：0
> 
> 时间：2012-11-28T20:57:10.137
> 
> 标签：java, sockets, exception, serialization

我正在尝试将 Key 类型的公钥对象发送到我的服务器。但我没有得到这个运行。prototocl 如下所示：

[命令]\n[序列化密钥对象]

客户端使用此代码：

```
Socket admin;
PrintWriter pw;
OutputStream os;
BufferedReader is; 
for(int tries = 0; tries < MAX_RECONNECT_TRIES_ADMIN_SERVER; tries++)
{
    try 
    {
        admin = new Socket(host,port);
        os = admin.getOutputStream();
        is = new BufferedReader(new InputStreamReader(admin.getInputStream()));
        pw = new PrintWriter(new OutputStreamWriter(os));   

        AdminServerCommand.NODE_REGISTER.writeToPrintWriter(pw);
        pw.flush();

        sendPublicKey(os);

        String resultLine = null;
        resultLine = is.readLine();
        if(AdminServer.Feedback.KEY_REGISTERED.commandMatch(resultLine))
        {
            is.close();
            os.close();
            admin.close();
            return true;
        }
        is.close();
        os.close();
        admin.close();
        registerNodeRetrySleep(1000);
    }
    catch (Exception e) 
    {}
}
return false;

public void sendPublicKey(OutputStream out)
{
    try
    {
        ObjectOutputStream outO = new ObjectOutputStream(out);
        outO.writeObject(cyper.getPublicKey());
        outO.flush();
    }
    catch (Exception ex)
    {
        ex.printStackTrace();
    }
}

public void writeToPrintWriter(PrintWriter os)
{
    if(os == null)
        throw new IllegalArgumentException("Can not write command to null stream.");
    os.println(comm);
    os.flush();
} 
```

服务器使用

```
String com = "";
    try 
    {
        if(client.getInputStream().available() > 2)
        com = is.readLine();
    }
    catch (IOException e) 
    {
        errorResponse(Error.COMMAND_ERROR);
    }
    Key key = null;
    try
    {
        ObjectInputStream keyIn = new ObjectInputStream(client.getInputStream());
        key = (Key)keyIn.readObject();
    }
    catch(Exception b)
    {
        b.printStackTrace();
        errorResponse(Error.BAD_KEY);
        return;
    } 
```

异常如下所示：

```
Nov 28, 2012 9:52:59 PM AdminServer.AdminServer run
INFO: Get a new request
java.io.StreamCorruptedException: invalid stream header: 73720014
    at java.io.ObjectInputStream.readStreamHeader(Unknown Source)
    at java.io.ObjectInputStream.<init>(Unknown Source)
    at AdminServer.AdminServer.registerNewKeyEntry(AdminServer.java:115)
    at AdminServer.AdminServer.run(AdminServer.java:65)
    at java.lang.Thread.run(Unknown Source)
Nov 28, 2012 9:52:59 PM AdminServer.AdminServer errorResponse
WARNING: Error: Bad public key format. Use object stream with key object. 
```

现在有没有人可以解决这个问题。类型 Key 是一个接口类型，它实现了自己的 Interface Serializable。所以序列化这个对象应该不是问题。我整个晚上都在处理这个问题。希望任何人都可以帮助我摆脱这个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:25:51.883

您的问题中没有足够的代码来完全诊断 - 但这里有一些观察结果。

这段代码看起来很可疑：

```
if(client.getInputStream().available() > 2)
com = is.readLine(); 
```

大概您有一个`is`包装客户端输入流的缓冲阅读器。如果 if 语句不正确会发生什么 - 您跳过阅读该行？现在该行文本仍在管道中，并将传递给您的 keyIn.readObject 方法。这可能会导致损坏错误。

我建议只删除整`if`行。readLine() 无论如何都会阻塞，因此不需要检查。

另外，您是否绝对确定在`AdminServerCommand.NODE_REGISTER.writeToPrintWriter(pw);`换行后发送了一行完全没有字符的文本？

但是 - 我认为你在这里有一个更大的问题。这种在 Java 对象序列化和手动文本读取/写入之间来回切换的设计只是一场等待发生的灾难。如果要使用对象序列化，请独占使用它。您可以交替发送一个 String 对象，然后是一个 Key 对象，并且您的流不会因为您发送一个太多或一个两个几个换行符而损坏。

例如： ObjectOutputStream outO = new ObjectOutputStream(out);

```
 String command = "whatever";
    outO.writeObject(command);
    outO.writeObject(cyper.getPublicKey());
    outO.flush(); 
```

然后在服务器端，总是使用 readObject，知道第一个是命令，第二个是键。

# sql - 在 PostgreSQL 中合并行

> ID：13614251
> 
> 赞同：2
> 
> 时间：2012-11-28T20:57:23.487
> 
> 标签：sql, postgresql, merge, aggregate-functions

这是我的数据：

```
ID      FName   LName   data1   data2
1       John    Doe     xxx1    
2       John    Doe     xxx2    yyy2 
```

这是我想要的结果：

```
ID      FName   LName   data1   data2
1       John    Doe     xxx1    yyy2 
```

简而言之，我有一张桌子，里面有很多人，而且这张桌子是从具有不同数据和 ID 的多个来源填充的。我想要的是，对于我找到的每个重复项以及表格视图中的每一列，如果该单元格中存在数据，那么，如果存在，则尝试将其转储到该人的最旧记录中，如果有数据，没做什么。

我不知道我是否说清楚了。

最好的方法应该是什么？我应该写一个存储过程还是可以用一个我还没有想出的聪明的查询来完成？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T21:21:51.783

您可以像这样创建自定义聚合：

```
CREATE FUNCTION remember_first(acc text, newval text) RETURNS text AS $$
BEGIN
    RETURN COALESCE(acc, newval);
END;
$$ LANGUAGE plpgsql IMMUTABLE;

CREATE AGGREGATE first(text) (
    sfunc = remember_first,
    stype = text
); 
```

它将返回第一个非`null`值。然后：

```
SELECT FName, LName, first(data1), first(data2)
FROM your_table
GROUP BY FName, LName
ORDER BY FName, LName, id -- or your ordering columns 
```

获取您需要的数据。最后 - 只需使用它`SELECT`来更新记录。或者只是`VIEW`用所需的数据创建一个。

PS聚合函数来自[自定义聚合函数](https://stackoverflow.com/questions/8350437/postgres-custom-aggregate-function)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T01:36:54.567

[您可以通过使用连接和窗口函数](http://www.postgresql.org/docs/current/static/tutorial-window.html)的查询来解决这个问题：

```
select nodups.id, nodups.fname, nodups.lname, d1.data1, d2.data2
from
  (select min(id) as id, fname, lname from sample group by fname, lname) nodups
left join
  (select fname, lname, min(data1) as data1
   from (select fname, lname
           , first_value(data1) over (partition by fname, lname order by id) as data1
         from sample where data1 is not null) d1x
   group by fname, lname
  ) d1 using (fname, lname)
left join
  (select fname, lname, min(data2) as data2
   from (select fname, lname
           , first_value(data2) over (partition by fname, lname order by id) as data2
         from sample where data2 is not null) d2x
   group by fname, lname
  ) d2 using (fname, lname)
order by id
; 
```

[SQLFiddle](http://sqlfiddle.com/#!12/5bb12/10)

尝试使用您的真实数据针对 Igor 的自定义聚合测试这种方法，看看哪个表现更好。

# vb.net - 如何将事件处理程序添加到 VB.NET 中动态创建的控件？

> ID：13614254
> 
> 赞同：1
> 
> 时间：2012-11-28T20:57:37.873
> 
> 标签：vb.net, visual-studio-2008, event-handling

我在这个论坛和其他网站上搜索并看到了无数的样本，但我仍然遇到这个问题；我想为动态创建的 PictureBox-es 添加一个 Click Handler 并在其上传递一个参数，以便我知道单击了哪个图片框）。

这是我当前的代码：

```
Public Class frmMbarimAbonimi

Private Sub frmMbarimAbonimi_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
    'TODO: This line of code loads data into the 'FitnessdbDataSet.clients' table. You can move, or remove it, as needed.
    'Me.ClientsTableAdapter.Fill(Me.FitnessdbDataSet.clients)

    '===============
    Dim dt As DataTable = PaPaguar()
    Dim i As Integer = 0

    Dim gr(dt.Rows.Count) As GroupBox
    Dim pp(dt.Rows.Count) As PictureBox
    Dim lb(dt.Rows.Count) As Label

    For Each row As DataRow In dt.Rows

        gr(i) = New GroupBox
        gr(i).Width = 200
        gr(i).Height = 180

        pp(i) = New PictureBox
        pp(i).SizeMode = PictureBoxSizeMode.StretchImage

        lb(i) = New Label

        '-------------------------
        Try
            Using str As Stream = File.OpenRead("C:\Fotot\" + dt.Rows(i).Item("Foto"))
                pp(i).Image = Image.FromStream(str)
            End Using

            lb(i).Text = dt.Rows(i).Item("Emer")

        Catch ex As Exception

            MsgBox("Fotoja nuk mund te ngarkohet, ju lutem realizoheni nje foto tjeter!!!")

        End Try
        '-------------------------
        pp(i).Visible = True
        pp(i).Width = 200
        pp(i).Height = 150

        AddHandler pp(i).Click, AddressOf testini

        gr(i).Controls.Add(pp(i))

        lb(i).Visible = True
        lb(i).Width = 200
        lb(i).Height = 30
        lb(i).Left = pp(i).Left
        lb(i).Top = pp(i).Top + 150
        lb(i).BackColor = Color.WhiteSmoke
        lb(i).BringToFront()
        gr(i).Controls.Add(lb(i))

        flpanel.Controls.Add(gr(i))

        i = i + 1
    Next row
End Sub 
End Class 
```

所以我试图使用 AddHandler pp(i).Click, AddressOf testini 但显然这不允许我使用参数调用“testini”来识别单击了哪个图片框。

有人可以指出我正确的方向或提供一些建议吗？非常感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T21:04:41.350

您需要向创建的 PictureBox 添加一些内容以在事件处理程序中识别它们，因为您无法更改单击事件处理程序的签名添加“参数”

例如，您可以设置 Name 属性

```
pp(i) = New GroupBox
pp(i).Name = "PictureBox" + i.ToString 
```

然后在事件处理程序中，您可以识别您的图片框将发送者对象转换为图片框并获取 Name 属性。
请记住，sender 始终是触发事件的控件。在您的情况下，始终是您动态创建的图片框之一

```
Private Sub testini(sender As Object, e As System.EventArgs) 
     Dim pb As PictureBox = DirectCast(sender, PictureBox)
     Dim pbIdentity As String = pb.Name
     .....
End Sub 
```

# database - CLASSIC asp 连接到 SQL Express Server 500 服务器错误

> ID：13614255
> 
> 赞同：2
> 
> 时间：2012-11-28T20:57:42.177
> 
> 标签：database, asp-classic, adodb, recordset

嘿，我正在尝试在**Classic ASP中连接到我的 SQL Server 版本 10.50.2500**

我在 .asp 页面中的代码是（包括我尝试使用的所有连接字符串）：

```
Set objConn = Server.CreateObject("ADODB.Connection")
Set objRS   = Server.CreateObject("ADODB.Recordset")

'objConn.ConnectionString = "Provider={SQL Server};Server=xxx.xxx.xxx.xxx\SQLEXPRESS;Database=JForm;User ID=xxxx;Pwd=xxxx"
'objConn.ConnectionString = "Driver={SQL Server};Server=xxx.xxx.xxx.xxx\SQLEXPRESS;Database=JForm;Uid=xxxx;Pwd=xxxx;"
'objConn.ConnectionString = "Provider=SQLNCLI10;Server=xxx.xxx.xxx.xxx,1433;Database=JForm;Uid=xxxx;Pwd=xxxx;Persist Security Info=True"
'objConn.ConnectionString = "Provider=SQLNCLI;Server=.\SQLEXPRESS;Database=JForm;Uid=xxxx;Pwd=xxxx"
objConn.ConnectionString = "Driver={SQL Server Native Client 10.0};Server=xxx.xxx.xxx.xxx\SQLEXPRESS;Database=JForm;Uid=xxxx;Pwd=xxxx"

strSQL = "UPDATE jURLS " & _
        "SET rssFeedURL = 'http://www.xxxx.com/rss/" & rss & "'," & _
        "csvURL = 'http://www.xxxx.com/csv/" & csv & "'," & _
        "jFormName = '" & forname & "'," & _
        "isActive = " & active & " " & _
        "WHERE jFormName = '" & forname & "'"

objConn.open
objRS.Open strSQL, objConn, 1,3

'If Not objRS.EOF Then
 'iterate through records here
'Else
 'no records found
'End If

objRS.close
Set objRS=Nothing
objConn.close
Set objConn=Nothing 
```

它似乎在**objConn.open**上崩溃了。但是，它只给了我一个**500 - Internal server error。**而不是一个有帮助的错误！

一旦我从页面中获取数据库代码并保留其他所有内容，它就可以在不显示**500 - Internal server error**的情况下工作。

为了让它发挥作用，我还能尝试什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T05:39:47.110

你在这里有一个额外的逗号：

```
"isActive = " & active & "," & _ 
```

将其更改为：

```
"isActive = " & active & " " & _ 
```

关于连接错误，[尝试使用 connection.errors 集合进行调试](http://msdn.microsoft.com/en-us/library/windows/desktop/ms675540%28v=vs.85%29.aspx)

```
On Error Resume Next
objConn.open

for each errobj in objConn.Errors
    Response.write errobj.Number & "<br />"
    Response.write errobj.Description & "<br />"
next

On Error Goto 0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T21:16:21.257

尝试：

```
response.write(strSQL) <-- this will allow you to look at your current SQL statement and see if it makes sense.
set objRS = objConn.execute(strSQL) 
```

# html - 带有背景图像下拉问题的选项卡菜单

> ID：13614258
> 
> 赞同：0
> 
> 时间：2012-11-28T20:57:49.013
> 
> 标签：html, css

我有一个下拉菜单，当我翻转时会出现一个下拉菜单。唯一的问题是我的主列表的背景图像也显示为子菜单列表的背景。

下面是我在翻转时分配选项卡背景的 CSS。但我假设由于技术用户仍在滚动`<li>`标签背景显示在所有子`<li>`

CSS：

```
#main_menu ul li:hover a {
  background: url(images/right_tab_bg.png) top right no-repeat;
  color: #578ba0;
}

#main_menu ul li:hover a span {
  background: url(images/left_tab_bg.png) top left no-repeat;
} 
```

有没有办法告诉上面的 css 只影响父级`<a>`或`<span>`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T21:04:11.750

通过直接后代选择器更具体地使用您的选择器（我假设作为顶级列表的 ul 是任何内容的直接后代`#main_menu`）：

```
#main_menu > ul > li:hover > a /* select only the parent li's a */
#main_menu > ul > li li a /* select any child li's a, excluding the top level li */ 
```

# ruby-on-rails - 在 routes.rb 中安装 rails 引擎并将其包含在 gemfile（或 gemspec）文件中是否相同？

> ID：13614261
> 
> 赞同：1
> 
> 时间：2012-11-28T20:57:57.153
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rails-engines

我们在 3.2.8 应用程序中使用 rails 引擎。当我们想`engine`在我们的 Rails 应用程序/另一个引擎中包含一个时，我们确实包含了`engine`in`gemfile(gemspec)`并将其安装在`routes.rb.`但是我们注意到，如果我们删除安装命令`routes.rb`并且只保留文件不变，相同的 rpsec 情况可以通过而不会出错`gem engine`。`gemfile (gemspec)`这让我们想知道安装导轨引擎`routes.rb`和将其放入`gemfile`（gemspec for engine）或两者都做有什么区别。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-29T23:13:14.323

当您想在 Rails 应用程序中安装 Rails 引擎时，将 gem 添加到应用程序的 Gemfile 中（以便在应用程序启动时需要 gem 的源代码）。您在应用程序中指定挂载路径，`config/routes.rb`以便引擎的控制器响应 HTTP 请求：

```
Rails.application.routes.draw do

  mount MyGem::Engine => "/mygem"

  root to: 'home#index'

end 
```

当您创建引擎时，默认情况下，生成器将创建一个“虚拟”应用程序，您的测试将使用该应用程序来测试您的引擎。我的猜测是您的测试仍在通过，因为您仍然在虚拟应用程序中指定了这个挂载路径。

# regex - 正则表达式中的 JAX-RS URI 匹配

> ID：13614262
> 
> 赞同：1
> 
> 时间：2012-11-28T20:57:58.417
> 
> 标签：regex, jax-rs

我正在尝试匹配 URI 中的特定路径元素。我有两种不同的 URI 类型：

```
/aaa/bbb/ccc?param2=x,param2=y 
```

和：

```
/_Vddd/aaa/bbb/ccc?param2=x,param2=y 
```

我想总是收集整个字符串，除了第二种情况，当我想在`/_Vddd`

注意：`ddd`可以是任何东西。

顺便说一句：这是在 JAX-RS 路径语句中使用的。我正在尝试使用非捕获组，但无法匹配。由于某些原因：

`/{path:(?:(/_V[^/]*))?/.*}`仅当 URI 包含 , 时才匹配，并作为路径变量`/_Vddd`的一部分返回。`/_Vddd`

有什么想法吗？

# ruby-on-rails - 具有许多并发用户的 Postgres SessionStore

> ID：13614264
> 
> 赞同：0
> 
> 时间：2012-11-28T20:57:59.463
> 
> 标签：ruby-on-rails, session, activerecord, database-connection

我正在使用 SessionStore 将我的 jruby Rails 会话存储在 postgres 数据库中。连接池配置为：

```
pool: 10
timeout: 5000 
```

在我的测试中，我发现大约有 15 个连接时，我开始收到以下错误：

```
ActiveRecord::ConnectionTimeoutError (could not obtain a database connection within 5 seconds.  The max pool size is currently 10; consider increasing it.) 
```

看来这失败得太早了。10 个数据库连接肯定可以支持超过 15 个并发用户吗？我只使用这个数据库来访问会话，所以我假设每个请求只使用连接一小段时间。这些故障发生在合理的时间吗？

**Rails 如何使用数据库连接进行会话存储？**它是在请求的长度内保持数据库连接，还是在每个请求开始时简单地加载一次？关于可能导致这种不良数据库连接使用的任何想法？

# android - 具有搜索功能的 ListView 不是预期的行为

> ID：13614270
> 
> 赞同：0
> 
> 时间：2012-11-28T20:58:17.873
> 
> 标签：android, listview, search

我有一个 ListView 填充了 ArrayAdapter 的数据，并且我实现了一个搜索功能，因为列表很长。

假设我有这个列表：

0 - 橙色 1 - 苹果 2 - 番茄 3 - 鳄鱼 4 - 火车 5 - 海龟 6 - 狗 7 - 猫

好的，现在在我用来过滤这个列表的 EditText 中，我写了一个`t`. 然后，列表将是：

0 - 番茄 1 - 火车 2 - 乌龟

问题是我已经实现了一个`onItemClickListener`，以便我可以根据项目访问一个页面或另一个页面，当我单击第一个（ 0 - tometoe ）时，它会选择列表中第一个元素的（ 0 ）没有过滤（0 - 橙色），当我点击第二个（1 - 火车）时，它会选择列表中第一个元素的（1）而不过滤（1 - 苹果）等等......

这是我正在使用的代码：

```
ListView lv = new ListView(this);
        final String[] tricks;

        final ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, R.layout.listviewcustom, tricks);

        lv.setAdapter(adapter);

        lv.setOnItemClickListener(new OnItemClickListener() {
            public void onItemClick(android.widget.AdapterView<?> arg0, View arg1, int arg2, long arg3) {
                showTrick(arg2, tricks[arg2], modality);
                //Log.e("itemClickListener", String.valueOf("LISTVIEWJ     " + arg2 + " - " + tricks[arg2] + " - " + modality));
            }
        });

        searchBox.addTextChangedListener(new TextWatcher() {

            public void onTextChanged(CharSequence cs, int arg1, int arg2, int arg3) {
                adapter.getFilter().filter(cs);
            }

            public void beforeTextChanged(CharSequence arg0, int arg1, int arg2, int arg3) { }

            public void afterTextChanged(Editable arg0) { }
        });

        tricksLayout.addView(lv, LayoutParams.MATCH_PARENT, LayoutParams.MATCH_PARENT); 
```

所以我的问题是：我怎样才能让它按我的意愿工作？

谢谢你的好处！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:40:29.660

我没有完全理解你的问题。这是我从您的问题中理解的答案，如果不是您所要求的发表评论，我将编辑我的答案。

制作一个 ArrayList 并填充它。

```
ArrayList<String> list = new ArrayList<String>();

list.add("orange"); //1
list.add("apple"); //2
list.add("tomatoe"); //3
list.add("alligator"); //4
list.add("train"); //5 
```

在过滤器上，您会得到这样的列表视图 0 - 番茄 1 - 火车 2 - 海龟

现在在 onItemClickListener 上单击位置 1

```
String temp =  here you get "train" at index 1 
//temp = "train"

int i = termsList.indexOf("train"); 
// it will give you actual position of train which is 5 
```

已编辑

也用于`notifyDataSetChanged`正确更新列表。

# python - python脚本列出所有已创建的文件和目录

> ID：13614271
> 
> 赞同：-4
> 
> 时间：2012-11-28T20:58:17.920
> 
> 标签：python

spython 脚本列出所有已创建的文件和目录

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:07:51.330

在不给您完整答案的情况下，以下是您需要的部分：

*   [walk](http://docs.python.org/3/library/os.html#os.walk)：`os.walk('.')`遍历所有文件和目录`.`及其任何子目录。您可以`for`围绕它进行循环。查看示例以获得`os.path.join(dirpath, filename)`正确的和其他细节。
*   [stat](http://docs.python.org/3/library/os.html#os.stat)：`os.stat(pathname)`返回一个`stat`对象，其中包含有关文件的信息`pathname`。根据您的平台，可能是创建时间，`st_ctime`也`st_birthtime`可能是创建时间。（在某些平台上，没有办法得到它。）格式是自纪元以来的秒数。
*   [时间](http://docs.python.org/3/library/time.html)模块：你已经被告知过这个。使用您最喜欢的 seconds-since-the-epoch 函数在启动时获取当前时间。任何`starttime - create time <= X * 60`新文件。（但请确保您获得正确的时区信息 - 使用 GMT 或本地时间作为文件时间和当前时间。）

# php - mysqli 查询失败，没有错误

> ID：13614272
> 
> 赞同：3
> 
> 时间：2012-11-28T20:58:18.207
> 
> 标签：php, mysql, mysqli

我有一个名为“目录”的数据库和一个名为“类别”的表。该表按此顺序有 3 列：categoryId、categoryName、parentCategory。我正在尝试为具有 parentCategory = 'root' 的每一行获取 categoryId 和 categoryName。我认为这是一个简单的查询，但显然我做错了，因为我不断收到消息——无法执行查询——但没有显示 mysql 错误。我已经在下面发布了我的代码。任何人都可以直接指出我吗？

PS 我确实为 $db 变量分配了值；我只是没有在这里包括那些。

```
<?php
$connect = mysqli_connect($db_host,$db_user,$db_password,$db_database)
    or die ("Couldn't connect to server: ".mysqli_error());

function display_children($parent) {
    $query = "SELECT categoryId, categoryName FROM `categories` WHERE parentCategory=".$parent;
    $result = mysqli_query($connect,$query)
        or die ("Couldn't execute query: ".mysqli_error());

    echo "<ul>";
    while ($row = mysqli_fetch_assoc($result)) {
          echo "<li>".$row['categoryName']."</li>";
          display_children($row['categoryId']); 
    }
    echo "</ul>";
    mysqli_close($connect);
}

?>

<div class="menu">    
<?php
    /* Menu Write */
    display_children("root");
?>
</div> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-28T21:15:11.943

display_children() 函数无权访问 $connect 变量。

尝试这个：

```
function display_children($parent) {
    global $connect;
    $query = "SELECT categoryId, categoryName FROM `categories` WHERE parentCategory=".$parent;
    $result = mysqli_query($connect,$query)
        or die ("Couldn't execute query: ".mysqli_error());

    echo "<ul>";
    while ($row = mysqli_fetch_assoc($result)) {
          echo "<li>".$row['categoryName']."</li>";
          display_children($row['categoryId']); 
    }
    echo "</ul>";
    mysqli_close($connect);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T21:01:16.737

`mysqli_error()`需要与数据库的链接作为参数。

因此错误的代码如下所示：

```
or die ("error: " +mysqli_error($connect)); 
```

这也在这里描述：http: [//php.net/manual/en/mysqli.error.php](http://php.net/manual/en/mysqli.error.php)

也许这有助于错误报告......

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-28T21:00:16.140

我相信您只需要`$parent`在查询中引用 of 的值。

```
$query = "SELECT categoryId, categoryName FROM `categories` 
          WHERE parentCategory = '" . $parent . "'"; 
```

希望这可以帮助！

# python - 为什么这个 pandas groupby 对象有所有这些额外的组？

> ID：13614273
> 
> 赞同：-1
> 
> 时间：2012-11-28T20:58:19.213
> 
> 标签：python, pandas

[这](https://dl.dropbox.com/u/6160029/t.pickle)是我正在使用的数据的链接。

我尝试根据我想要的列（ 和 ）创建一个组`cuepos`，`targetpos`但是`soa`当我列出这些组时，它似乎也在创建包含其他一些列的组......

```
groups = t.groupby(['cuepos', 'targetpos', 'soa'])
for name, _ in groups:
    print name 
```

输出：

```
(-89, -89, -89.41139261318807)
(-88, -88, -88.44728835230345)
(-88, -88, -88.20648583606493)
(-87, -87, -87.77339640061896)
(-86, -86, -86.8637199297012)
(-85, -85, -85.50514526170076)
(-83, -83, -83.87935779179833)
(-83, -83, -83.86953491773222)
(-81, -81, -81.43570407709822)
(-80, -80, -80.70639872201482)
(-80, -80, -80.38454772926528)
(-79, -79, -79.81516051155803)
(-75, -75, -75.83933409447087)
(-74, -74, -74.53528962061156)
(-73, -73, -73.10397238440302)
(-70, -70, -70.33208101764106)
(-64, -64, -64.18024404177129)
(-61, -61, -61.969216551968344)
(-61, -61, -61.89154280549519)
(-61, -61, -61.81223645812457)
(-61, -61, -61.80055105439692)
(-59, -59, -59.81551441456813)
(-57, -57, -57.67934478380107)
(-53, -53, -53.91038834185852)
(-51, -51, -51.35605559139145)
(-48, -48, -48.63443042074468)
(-48, -48, -48.026567177299825)
(-44, -44, -44.84750981999042)
(-44, -44, -44.20816797871376)
(-43, -43, -43.97185684796753)
(-39, -39, -39.03132145644588)
(-37, -37, -37.09246448040565)
(-37, -37, -37.06406445785262)
(-36, -36, -36.89551705610748)
(-34, -34, -34.23312940622742)
(-33, -33, -33.771084303661524)
(-31, -31, -31.183030415916534)
(-29, -29, -29.062383175092265)
(-22, -22, -22.1763042325164)
(-17, -17, -17.51138905398824)
(-14, -14, -14.673170146200675)
(-9, -9, -9.389620131659427)
(-9, -9, -9.28109130634627)
(-8, -8, -8.871025817651997)
(-8, -8, -8.47526860623043)
(-7, -7, -7.484697635519495)
(-3, -3, -3.265563116265213)
(-2, -2, -2.842961251214575)
(1, 1, -0.1)
(1, 1, 0.1)
(1, 1, 0.4)
(1, 2, -0.1)
(1, 2, 0.4)
(2, 1, -0.1)
(2, 1, 0.4)
(2, 2, -0.1)
(2, 2, 0.1)
(2, 2, 0.4)
(6, 6, 6.928400268960042)
(8, 8, 8.476818809273727)
(11, 11, 11.225720357570507)
(13, 13, 13.949059199458294)
(17, 17, 17.272663104264836)
(18, 18, 18.548979295124248)
(21, 21, 21.075945669054835)
(22, 22, 22.101344720547228)
(22, 22, 22.36405009971824)
(24, 24, 24.658480906080996)
(27, 27, 27.977154868918745)
(33, 33, 33.75660016684323)
(49, 49, 49.59296862775889)
(51, 51, 51.09435632596291)
(52, 52, 52.107845391762766)
(54, 54, 54.22026217046835)
(54, 54, 54.55461208382168)
(56, 56, 56.92397800238861)
(57, 57, 57.15634257840432)
(57, 57, 57.490226928649264)
(57, 57, 57.82030543311612)
(58, 58, 58.20496727209113)
(58, 58, 58.44217165553367)
(58, 58, 58.591804845872765)
(58, 58, 58.84514017314996)
(60, 60, 60.15474896731822)
(60, 60, 60.49526399943247)
(60, 60, 60.621239605283456)
(61, 61, 61.73542327989246)
(61, 61, 61.882729155824705)
(63, 63, 63.15716022529575)
(65, 65, 65.62684954629724)
(67, 67, 67.32622273875754)
(68, 68, 68.72997170017184)
(71, 71, 71.64012395084114)
(71, 71, 71.87357582509455)
(71, 71, 71.91237771102328)
(72, 72, 72.87756472051248)
(73, 73, 73.23547239962096)
(75, 75, 75.20111322246554)
(76, 76, 76.37312687962122)
(78, 78, 78.39727821292199)
(79, 79, 79.27674426299386)
(80, 80, 80.22644745900354)
(82, 82, 82.38562004739285)
(82, 82, 82.75922122217577)
(85, 85, 85.19181215842043)
(85, 85, 85.6896980533089)
(85, 85, 85.84141277449113)
(87, 87, 87.21598891172931)
(87, 87, 87.60810304014197)
(87, 87, 87.80910737578778) 
```

所需的组位于中间（看起来像 的组`(1, 1, -0.1)`）。这又是什么东西？我在这里做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T22:20:31.987

好吧，数据并没有对观察到的 3 元组撒谎：

```
In [9]: df[['cuepos', 'targetpos', 'soa']].drop_duplicates()
Out[9]: 
     cuepos  targetpos        soa
0         2          2   0.400000
1         2          1   0.400000
2         1          1  -0.100000
3         1          1   0.400000
4         1          2  -0.100000
5         1          1   0.100000
8         2          2  -0.100000
12        1          2   0.400000
18        2          2   0.100000
24        2          1  -0.100000
52       85         85  85.689698
77       -3         -3  -3.265563
117     -83        -83 -83.869535
133      11         11  11.225720
26      -88        -88 -88.206486
31      -48        -48 -48.634430
34       63         63  63.157160
55       85         85  85.841413
80      -61        -61 -61.812236
86      -61        -61 -61.891543
89       87         87  87.215989
92       80         80  80.226447
94       58         58  58.204967
126      71         71  71.912378
128      60         60  60.154749
132       8          8   8.476819
139      65         65  65.626850
141      54         54  54.554612
11      -61        -61 -61.800551
39      -33        -33 -33.771084
46       76         76  76.373127
52      -37        -37 -37.064064
55      -44        -44 -44.847510
60      -70        -70 -70.332081
62       61         61  61.735423
63       75         75  75.201113
69       58         58  58.845140
94      -79        -79 -79.815161
109     -29        -29 -29.062383
111     -51        -51 -51.356056
117     -83        -83 -83.879358
123      21         21  21.075946
135     -31        -31 -31.183030
143       6          6   6.928400
4       -17        -17 -17.511389
11       57         57  57.490227
18      -88        -88 -88.447288
36       78         78  78.397278
39      -14        -14 -14.673170
42       52         52  52.107845
49      -87        -87 -87.773396
50       60         60  60.495264
71       33         33  33.756600
74      -61        -61 -61.969217
84       18         18  18.548979
85       -8         -8  -8.475269
98      -59        -59 -59.815514
101     -80        -80 -80.384548
114     -39        -39 -39.031321
119      71         71  71.873576
121     -86        -86 -86.863720
128      68         68  68.729972
130     -34        -34 -34.233129
140      82         82  82.759221
0       -75        -75 -75.839334
15       67         67  67.326223
34      -57        -57 -57.679345
35      -74        -74 -74.535290
42      -48        -48 -48.026567
67       85         85  85.191812
75       72         72  72.877565
80       -7         -7  -7.484698
99       -9         -9  -9.389620
118     -44        -44 -44.208168
130      73         73  73.235472
143      58         58  58.442172
56       22         22  22.364050
67      -85        -85 -85.505145
95       60         60  60.621240
109      54         54  54.220262
111      87         87  87.809107
112     -81        -81 -81.435704
114      71         71  71.640124
119     -22        -22 -22.176304
120      27         27  27.977155
121      56         56  56.923978
128      57         57  57.820305
133      22         22  22.101345
11       61         61  61.882729
13       58         58  58.591805
28       57         57  57.156343
78      -80        -80 -80.706399
80       49         49  49.592969
81      -37        -37 -37.092464
101     -36        -36 -36.895517
124      17         17  17.272663
128      51         51  51.094356
137     -89        -89 -89.411393
140     -64        -64 -64.180244
36       -8         -8  -8.871026
44      -73        -73 -73.103972
47       -9         -9  -9.281091
49       -2         -2  -2.842961
51       87         87  87.608103
85       24         24  24.658481
90      -53        -53 -53.910388
98       82         82  82.385620
120      79         79  79.276744
127     -43        -43 -43.971857
130      13         13  13.949059 
```

# bash - 在makefile中读取文件

> ID：13614275
> 
> 赞同：11
> 
> 时间：2012-11-28T20:58:22.733
> 
> 标签：bash, shell, makefile, gnu

我想在 makefile中读取一个名为*metafile的文件。*

元文件看起来像这样：
file1
file2
file3

我需要逐行读取我的makefile中的这个元文件，并检查里面提到的文件是否存在，并且只打印存在的文件的名称。

我已经尝试了一些没有成功的事情。喜欢：

```
FILE=`cat metafile`
for line in $(FILE); if [ -e $${line} ]; then echo $${line} fi; done; 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-11-28T21:12:30.877

您可以将任意一段 shell 脚本放入目标中。将文件的内容保存在 Makefile 变量中对我来说没有任何意义，除非您出于其他原因还需要其他目标中的数据。（如果是这样，无论如何你不能使用反引号。）

```
target:
        @while read -r file; do \
            test -e "$$file" && echo "$$file"; \
        done <metafile 
```

值得一提的是，与使用反引号`while`的循环相比，循环是一种更安全、更惯用的方式来循环 shell 脚本中的文件行，[即使您经常看到这种方式。](https://mywiki.wooledge.org/DontReadLinesWithFor)`for`

`@`防止 Make 回显 shell 脚本命令；如果出于某种原因您需要查看它们，请将其删除。事实上，我建议不要使用它，尤其是在你调试的时候——一旦你确信你的配方可以正常工作，就使用它`make -s`来静默运行。`make`

在 Makefile 中执行此操作的一种更惯用的方法是让目标依赖于这些文件，并使用 Make 自己的逻辑：

```
target: file1 file2 file3
        @echo $(filter-out $?,$^) 
```

这是 GNU Make 语法；如果您想移植到其他 Make 风格，它可能会变得更加复杂（毕竟可能 shell 脚本更可取）。它将在一行上回显所有内容，但如果您需要单独的行，那应该是一个简单的修复。

我会简单地构建一个小的辅助 Makefile 片段并包含依赖项：

```
target: target.d
target.d: metafile
        sed 's/^/target: /' $< >$@
include target.d 
```

这会构建一个小的依赖项列表，因此您无需在`target:`依赖项中明确列出它们；所以不是`file1 file2 file3`在上面的配方中，依赖项将存在于生成`target.d`的包含

```
target: file1
target: file2
target: file3 
```

您需要过滤掉对的依赖`target.d`（或不声明它；我相信 GNU Make 应该可以应付）。

# facebook-graph-api - 使用 curl 查询图形 api

> ID：13614280
> 
> 赞同：8
> 
> 时间：2012-11-28T20:58:35.010
> 
> 标签：facebook-graph-api, curl

我想检查如何处理`access_token`. 所以，我`curl`用来执行以下查询：

```
curl -X POST https://graph.facebook.com/oauth/access_token -d "client_id=<appId>&client_secret=<secret>&grant_type=client_credentials&redirect_uri=" 
```

它返回 的值`access_token`。

然后，我想获取我的朋友列表：

```
curl -X POST https://graph.facebook.com/me/friends -d "access_token=<token>" 
```

它返回此错误：

```
{"error":{"message":"An active access token must be used to query information about the current user.","type":"OAuthException","code":2500}} 
```

有什么提示吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2017-04-01T06:59:01.580

最简单的方法是使用图形 API 资源管理器，使用您的 facebook 开发者帐户去那里获取和访问令牌：

> 生成基本用户访问令牌
> 
> 当您开始构建自己的应用程序时，您需要了解访问令牌以及如何使用 Facebook 登录生成它们，但现在，我们可以通过 Graph API Explorer 快速获得一个：
> 
> ```
> Click on the Get Token button in the top right of the Explorer.
> Choose the option Get User Access Token.
> In the following dialog don't check any boxes, just click the blue Get Access Token button.
> You'll see a Facebook Login Dialog, click **OK" here to proceed. 
> ```

您可以将图形 api explorer 用作 curl，但如果您想使用真正的 curl 进行尝试，最后一个 api v2.8 的 sintaxis 如下：

```
curl -i -H 'Authorization: Bearer YOUR_ACCES_TOKEN' -XGET 'https://graph.facebook.com/v2.8/me' 
```

就我而言：

```
toni@MBP-de-Antonio  ~  curl -i -H 'Authorization: Bearer MY-ACCES_TOKEN' -XGET 'https://graph.facebook.com/v2.8/me'
HTTP/1.1 200 OK
x-app-usage: {"call_count":2,"total_cputime":3,"total_time":3}
Expires: Sat, 01 Jan 2000 00:00:00 GMT
x-fb-trace-id: BnLv25AHTjq
facebook-api-version: v2.8
Content-Type: application/json; charset=UTF-8
x-fb-rev: 2929740
Cache-Control: private, no-cache, no-store, must-revalidate
Pragma: no-cache
ETag: "39875e94193dcd62dcbbf583fc0008c110820a6c"
Access-Control-Allow-Origin: *
X-FB-Debug: fvO9W8Bfl+BihEy/3aZyzOiMrXOkrbK8q1I3Xk2wYnI7sSujZNC6vQzR4RoTWK7K3Hx6EdzoE2kZ/aWhsXe4OA==
Date: Sat, 01 Apr 2017 06:55:52 GMT
Connection: keep-alive
Content-Length: 61

{"name":"Antonio Juan Querol Giner","id":"10204458008519686"}% 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T21:07:18.130

我认为您的问题可能是您尝试访问自己的数据时使用的“/me”标识符。（根据您的客户端 ID 设置，因为您可能指的是应用程序而不是您自己，请尝试使用您的配置文件 ID 而不是“/me”）。

还要检查一下[https://stackoverflow.com/a/6701982/1546542](https://stackoverflow.com/a/6701982/1546542)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T21:13:08.587

您是否尝试过使用调试器？在此处调试您的访问令牌，它会告诉您有关该访问令牌的信息，以及它是否与用户相关： [https ://developers.facebook.com/tools/debug](https://developers.facebook.com/tools/debug)

另外，你为什么要使用 POST 来获取 /me/friends？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-05-27T17:48:53.233

您应该在 curl -X POST 之后用双引号括起来 "https://...."。

# php - Symfony 1.4 - Doctrine - 自定义插件 - 未知连接

> ID：13614281
> 
> 赞同：1
> 
> 时间：2012-11-28T20:58:36.580
> 
> 标签：php, symfony1, symfony-1.4

我正在构建一个自定义插件，它由我试图与插件紧密耦合的模式组成。例如，我有一个 plugins/userPlugin/config/doctrine/schema.yml 引用了一个“store-rw-user”连接。我的目标是强制项目的 databases.yml 包含“store-rw-user”的连接，这样项目将负责设置单独的用户连接。

但是，当我尝试访问与插件相关的代码时，我不断收到：`Doctrine_Manager_Exception Unknown connection: store-rw-user`.

这是**插件架构**文件的相关片段：

```
# plugins/userPlugin/config/doctrine/schema.yml
connection: store-rw-user

User:
  tableName: user
  actAs: [Timestampable] 
```

这是**BaseUser.class.php**的相关片段（在构建模型时生成）：

```
<?php
// lib/model/doctrine/userPlugin/base/BaseUser.class.php

// Connection Component Binding
Doctrine_Manager::getInstance()->bindComponent('User', 'store-rw-user');

.... 
```

最后是项目的**databases.yml**文件的相关片段：

```
# config/databases.yml
all:
  store-rw-user:
    class: sfDoctrineDatabase
    param:
    .... 
```

一开始，一切看起来都配置正确。插件 schema.yml 导致基类绑定了正确的数据库连接，该连接存在于项目的 databases.yml 文件中。但是，我遇到了上述问题。在我开始尝试通过插件的 initialize() 方法手动操作教义连接管理器之前，我想知道是否有其他方法可以解决此问题。

**- 更新 -**

经过进一步调查，sfDatabaseManager 似乎知道“store-rw-user”连接，但是，Doctrine_Manager 不是。起初我认为这可能是由于我在主项目配置文件中添加插件的顺序，但它只影响 sfDatabaseManager 是否支持连接，但为了完整起见，这里是项目配置文件的片段：

```
// config/ProjectConfiguration.class.php
class ProjectConfiguration extends sfProjectConfiguration
{
    ....

    public function setup()
    {
        ....

        $this->enablePlugins(
            array(
                'sfDoctrinePlugin',
                'userPlugin'
            )
        );
    }
} 
```

为了以防万一，这里是 userPlugin 的 app.yml：

```
# plugins/userPlugin/config/app.yml
# This entry was needed so build-model was executed, the plugin schema file would be pulled in for build as well
all:
  userPlugin:
    config_dir: %SF_PLUGINS_DIR%/userPlugin/config
    recursive: true 
```

这是令人困惑的代码片段，我可以通过 sfDatabaseManager 而不是 Doctrine_Manager 访问“store-rw-user”连接，这是一个问题，因为错误是从 Doctrine_Manager 而不是 sfDatabaseManager 抛出的：

```
// plugins/userPlugin/config/userPluginConfiguration.class.php
class userPluginConfiguration extends sfPluginConfiguration
{
    public function initialize()
    {
        parent::initialize();

        var_dump(Doctrine_Manager::getInstance()->getConnections());

        $config = ProjectConfiguration::getActive();

        $manager = new sfDatabaseManager($config);

        var_dump($manager->getDatabase('store-rw-user'));

        exit;
    }
} 
```

结果：

```
array (size=0)
  empty

object(sfDoctrineDatabase)[53]
  protected '_doctrineConnection' => 
    object(Doctrine_Connection_Mysql)[55]
      protected 'driverName' => string 'Mysql' (length=5)
      protected 'dbh' => null
      protected 'tables' => 
        array (size=0)
          empty
      protected '_name' => string 'store-rw-user' (length=13)
.... 
```

不知道发生了什么，尝试查看其他插件以了解它们的处理方式，并且它们没有我能找到的任何数据库引用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T01:09:42.770

在添加了一些调试代码来选择源文件（Doctrine_Manager）之后，我终于在上面的initialize（）方法中的代码片段中看到，通过简单地配置sfDatabaseManager，doctrine就意识到了连接。简而言之，我的方法最终看起来像这样：

```
class userPluginConfiguration extends sfPluginConfiguration
{
    public function initialize()
    {
        parent::initialize();

        // Don't ask me why, without this the needed db connection never gets initialized and plugin craps out
        $manager = new sfDatabaseManager(ProjectConfiguration::getActive());
    }
} 
```

而且，神奇的是，教义现在知道项目的 databases.yml 文件中的所有连接。对我来说似乎很弱，我必须明确地进行这个调用，但至少我可以继续进行一些编码。

# php - 如何在wordpress功能中跳过具有特定类别的图像

> ID：13614282
> 
> 赞同：0
> 
> 时间：2012-11-28T20:58:37.157
> 
> 标签：php, css, wordpress

我的主题功能页面中有以下功能。基本上它所做的是在帖子页面中查找任何图像并添加一些带有 css 的跨度以动态创建一个 pinterest 按钮。

```
function insert_pinterest($content) {
global $post;

$posturl = urlencode(get_permalink()); //Get the post URL
$pinspan = '<span class="pinterest-button">';
$pinurlNew = '<a href="#" onclick="window.open(&quot;http://pinterest.com/pin/create/button/?url='.$posturl.'&amp;media=';

$pindescription = '&amp;description='.urlencode(get_the_title());
$options = '&quot;,&quot;Pinterest&quot;,&quot;scrollbars=no,menubar=no,width=600,height=380,resizable=yes,toolbar=no,location=no,status=no';
$pinfinish = '&quot;);return false;" class="pin-it"></a>';
$pinend = '</span>';
$pattern = '/<img(.*?)src="(.*?).(bmp|gif|jpeg|jpg|png)"(.*?) \/>/i';
$replacement = $pinspan.$pinurlNew.'$2.$3'.$pindescription.$options.$pinfinish.'<img$1src="$2.$3" $4 />'.$pinend;
$content = preg_replace( $pattern, $replacement, $content );

//Fix the link problem
$newpattern = '/<a(.*?)><span class="pinterest-button"><a(.*?)><\/a><img(.*?)\/><\/span><\/a>/i';
$replacement = '<span class="pinterest-button"><a$2></a><a$1><img$3\/></a></span>';

$content = preg_replace( $newpattern, $replacement, $content );
return $content;
}
add_filter( 'the_content', 'insert_pinterest' ); 
```

它做的一切都很好。但是有没有办法让它跳过一个带有特定类名的图像，比如“noPin”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T22:21:43.870

我会使用 preg_replace_callback 来检查匹配的图像是否包含 noPin。

```
function skipNoPin($matches){
    if ( strpos($matches[0], "noPin") === false){
        return $pinspan.$pinurlNew.'$matches[2].$matches[3]'.$pindescription.$options.$pinfinish.'<img$1src="$2.$3" $4 />'.$pinend;
    } else {
        return $matches[0]

$content = preg_replace_callback( 
    $pattern, 
    skipNoPin,
    $content ); 
```

可以想象，另一个图像属性可能包含 noPin，如果您担心这种边缘情况，只需使 if 语句中的测试更具体。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T22:04:06.507

You have to exclude the class noPin from the `$pattern` regexp :

```
$pattern = '/<img(.*?)src="(.*?).(bmp|gif|jpeg|jpg|png)"(.*?) \/>/i'; 
```

Has to become something like

```
$pattern = '/<img(.*?)src="(.*?).(bmp|gif|jpeg|jpg|png)"(.*?) (?!class="noPin") \/>/i'; 
```

Please check the regexp syntax, but the idea is to exclude `class="noPin"` from the searched pattern. Then your replacement will not be added to these images.

# c# - 没有证书的 WCF 身份验证

> ID：13614284
> 
> 赞同：2
> 
> 时间：2012-11-28T20:58:45.287
> 
> 标签：c#, .net, wcf, web-services, authentication

我正在设置 WCF 服务。该服务必须使用 https 上的传输安全性，我需要使用某种身份验证来防止不必要的使用。

到目前为止，深入研究 WCF 理论让我感到失望。

到目前为止，我发现我可以将 UserName 身份验证与传输安全性结合使用。但是我需要一个证书来保护消息。

这使得大多数 .NET 语言难以使用。

我很惊讶我找不到任何关于**如何在没有消息安全性的情况下使用 wcf 对用户进行身份验证的好信息？**

我想要的是客户端以某种方式将用户名和密码传递给我的服务。

并记录在案。该服务将使用传输安全性。

分解它：

1.  如何在不限制互操作性的情况下实施身份验证？
2.  WCF服务是不是太麻烦了，我要么得用一个完全开放的服务。并使用 IP 过滤或 VPN 来限制访问？

更新： **由于我计划使用带有 SSL 证书的 https，安全模式“TransportWithMessageCredential”是否适合我？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:02:09.553

**获得真正安全的唯一方法是使用数字证书。**

有关详细信息，请参阅[我自己](https://stackoverflow.com/questions/13177024/add-rsa-based-encryption-to-wcf-service-without-certificates)关于此主题的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T21:33:44.583

TransportWithMessageCredential（AKA 混合模式安全）确实是您正在寻找的。

# autocomplete - 使用 ElasticSearch 支持 typeahead 自动完成

> ID：13614286
> 
> 赞同：9
> 
> 时间：2012-11-28T20:58:46.940
> 
> 标签：autocomplete, elasticsearch, typeahead

是否有一种标准方法可以使用 ElasticSearch 对小字段（例如地名）实现逐个字符的预输入自动完成。

（在写这篇文章的时候，有很多可以通过搜索获得的讨论，但似乎没有什么是确定的。（另外，我看到有关于 Apache Lucene 4 中自动完成/建议功能支持的效果的讨论。））

谢谢你的想法。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-28T21:33:34.233

您可以使用基于 Edge NGram 的分析器，请参阅[http://www.elasticsearch.org/guide/reference/index-modules/analysis/edgengram-tokenizer.html](http://www.elasticsearch.org/guide/reference/index-modules/analysis/edgengram-tokenizer.html)

或者使用建议插件：[https ://github.com/spinscale/elasticsearch-suggest-plugin](https://github.com/spinscale/elasticsearch-suggest-plugin)

高温高压

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-29T09:24:37.333

正如大卫所写，您可以使用 NGrams 或建议插件。使用 lucene 4，可以有更好的开箱即用的自动建议，而无需维护单独的索引。

现在，您还可以在您的字段上创建一个[术语方面](http://www.elasticsearch.org/guide/reference/api/search/facets/terms-facet.html)，并使用正则表达式模式来仅保留以相关前缀开头的条目：

```
"facets" : {
    "tag" : {
        "terms" : {
            "field" : "field_name",
            "regex" : "prefix.*"
        }
    }
} 
```

[正则表达式只是一个示例，它可以改进，您也可以使用正确的正则表达式标志](http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html#field_summary)使其不区分大小写。此外，请注意，在包含许多独特术语的字段上进行刻面并不是一个好主意，除非您有足够的内存。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-09-05T22:06:57.357

使用自 0.90.3 版以来可用的内置自动完成提示器：

[http://www.elastic.co/guide/en/elasticsearch/reference/master/search-suggesters-completion.html](http://www.elastic.co/guide/en/elasticsearch/reference/master/search-suggesters-completion.html)

它速度极快，专为该用例而开发。

# java - 带有请求标头的 Web 客户端

> ID：13614289
> 
> 赞同：0
> 
> 时间：2012-11-28T20:58:55.050
> 
> 标签：java, .net, sockets, httpclient, webclient

我在 .net 中的代码如下所示。我想用java写它。我该怎么做？我应该使用 httpclient 还是 socket 来做到这一点？

```
 using (WebClient wc = new WebClient())
            {
                wc.Encoding = System.Text.Encoding.UTF8;
                wc.Headers.Add("HOST", "example.com");
                wc.Headers.Add("User-Agent", "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:16.0) Gecko/20100101 Firefox/16.0"); 
                wc.Headers.Add("Accept", "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8");
                wc.Headers.Add("Accept-Language", "tr-TR,tr;q=0.8,en-US;q=0.5,en;q=0.3");
                html = wc.DownloadString(link);
                if (temp == null)
                    return string.Empty;

                return html;
             } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T21:52:34.757

使用默认 JDK 附带的 HttpUrlConnection。不需要下载额外的库。这是上面这段代码在java中的翻译

```
public static String get(String link){
   HttpURLConnection connection=null;
   try{  
      URL url=new URL(link);
      connection=(HttpURLConnection)url.openConnection();
      connection.setRequestMethod("GET");
      connection.setRequestProperty("HOST", "example.com");
      connection.setRequestProperty("User-Agent", "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:16.0) Gecko/20100101 Firefox/16.0");
      connection.setRequestProperty("Accept", "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8");
      connection.setRequestProperty("Accept-Language", "tr-TR,tr;q=0.8,en-US;q=0.5,en;q=0.3");
      connection.setDoInput(true);
      connection.setDoOutput(true);
      BufferedReader in=new BufferedReader(new InputStreamReader(connection.getInputStream(),"UTF-8"));
      String line,response="";
      while((line=in.readLine())!=null)
         response+=(line+"\n");
      in.close();
      return response;
   }catch(Exception e){}
   return "";
} 
```

# .net - 如何正确转义mysql？

> ID：13614291
> 
> 赞同：0
> 
> 时间：2012-11-28T20:58:56.830
> 
> 标签：.net, mysql

我刚刚发现如果我写

```
select * from tbl where name like @foo 
```

然后添加 foo 作为参数，其值`\a`（用户数据）不会正确转义。我勒个去！？！它想要`\\a`。即使我正在使用参数，我也不禁觉得我对 sql 注入持开放态度。

如何正确转义变量中的用户数据？我在 C# 上使用 mysql 并使用 dapper.net

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T21:27:28.723

对于我在此添加的类似陈述

```
.Replace(@"\", @"\\").Replace(@"_", @"\_").Replace(@"%", @"\%") 
```

# jquery - 防止脚本再次重新加载

> ID：13614295
> 
> 赞同：0
> 
> 时间：2012-11-28T20:59:21.993
> 
> 标签：jquery, json

我制作了一个类似无限加载脚本的脚本。当您从上到下滚动时，一切正常。当我单击产品并单击浏览器后退按钮以返回具有无限加载器的页面时，出现问题。重新加载所有产品。

经过一番搜索，我发现这*可能*是因为再次触发了该`document.ready`功能。问题是所有其他脚本都不再工作了。我的下一个建议是在加载产品之前清空加载产品的 div。现在的问题是只加载了下一页的第一个或最后一个产品。

有谁知道解决方案或者可以指出我的一些方向？

我的完整加载程序脚本->

```
<script type="text/javascript">

  var currentPage = {{ collection.page }};
  var collectionPages = {{ collection.pages }};
  var category = '{{ collection.internal.url }}';

  var appendProduct = function(product) {
    if(currentPage == 1){
      return false
    }
        //$(".collection-more").html("");
    $('<div class="product"></div>').html(product).appendTo($(".collection-more"));  
    var i = 1;
    $('.product').each(function() {
      if(i++ % 3 == 0)
        $(this).addClass('last');
    });
  };

  var loadProducts = function() {

    var url = "http://www.hioshop.nl/"+category+"/page"+currentPage+".ajax";

    $.getJSON(url,function(data) {

      $.each(data.products, function(index, product) {

        var imageUrl = product.image.replace('50x50x2', '180x150x2');

        var itemHtml = '' +
            '<a href="' + product.url + '" title="'+ product.fulltitle +'"><img src="'+imageUrl+'" width="180" height="150" alt="'+product.fulltitle+'" title="'+product.fulltitle+'" />';

        if(product.data_01 === 'sale'){
          itemHtml = itemHtml + '<div class="labels sale"></div>';
        }
        if(product.data_01 === 'nieuw'){
          itemHtml = itemHtml + '<div class="labels nieuw"></div>';
        }
        itemHtml = itemHtml +   
            '</a>' +
            '<div class="info">' +
            '<h3>' + '<a href="' + product.url + '" title="'+ product.fulltitle +'">' + product.fulltitle + '</a>' + '</h3>' +
            '<div class="price">' + product.price.price_money + '';

        if(product.price.price_old){
          itemHtml = itemHtml + ' <span>' + '<del>' + product.price.price_old_money + '</del>' + '</span>';
        }    

        itemHtml = itemHtml +
          '</div>' + // price
          '<div class="gridAddToCart">' +
          '<a class="button grey" href="'+product.url+'" title="'+product.fulltitle+'" rel="nofollow">'+'<span>Details</span></a>' +
          '<div style="margin-top:2px;"></div>' +
          '<a class="opener button blue" href="{{ 'cart/add/' | url }}'+product.vid+'" title="'+product.fulltitle+'" rel="nofollow"><span>In winkelwagen</span></a>'

          itemHtml = itemHtml +
          '</div>' + // gridAddToCart
          '</div>' + // info
          '<div class="clear"></div>' +
          '</div>';

        appendProduct(itemHtml)
          });

        $("#overlay").fadeOut();

        $(window).scroll(function() {
          update();
        });

      });
    };

    loadProducts();

    var isUpdating = false;

    var update = function() {  

      if($(window).height() + $(window).scrollTop() >= $(document).height() - 2000) {

        if(currentPage < collectionPages && !isUpdating) {

          isUpdating = true;

          currentPage++;
            $("#overlay").fadeIn();
          $(window).unbind('scroll');  

          setTimeout(function(){

            loadProducts();

            setTimeout(function(){

              isUpdating = false;

            }, 100);

          }, 100);
        }
      }
    };

    $(window).scroll(function() {
      update();
    });

</script> 
```

**更新**完整代码

# html - Chrome 径向渐变无法正确显示

> ID：13614296
> 
> 赞同：0
> 
> 时间：2012-11-28T20:59:23.767
> 
> 标签：html, css, google-chrome, gradient, radial-gradients

我正在使用 Chrome 版本 24.0.1312.25 beta-m，并且我正在尝试为一个小型站点获取径向渐变，它似乎无法在 Chrome 中正确显示。

我正在使用的 CSS 是：

```
html {
    background: -webkit-radial-gradient(circle, rgb(255, 255, 255), rgb(0, 0, 0));
} 
```

使用 HTML：

```
<!DOCTYPE HTML>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" type="text/css" href="dHb.css" />
  </head>

  <body>
  </body>
</html> 
```

它显示为：http: [//i.imgur.com/GCWyF.jpg](http://i.imgur.com/GCWyF.jpg)

首先，它不是径向的。其次，如果你仔细观察，中间有一条带子。

有谁知道为什么会发生这种情况以及我能做些什么来让它发挥作用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T21:12:11.110

试试这个

```
<!DOCTYPE HTML>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" type="text/css" href="dHb.css" />
  </head>

  <body>
  </body>
</html>​ 
```

CSS

```
html {
    height: 100%;
}

body {
    height: 100%;
    margin: 0;
    background-repeat: no-repeat;
    background-attachment: fixed;

  /* fallback */
  background-color: #2F2727;
  background-image: url(images/radial_bg.png);
  background-position: center center;
  background-repeat: no-repeat;

  /* Safari 4-5, Chrome 1-9 */
  /* Can't specify a percentage size? Laaaaaame. */
  background: -webkit-gradient(radial, center center, 0, center center, 460, from(#FFFFFF), to(#000000));

  /* Safari 5.1+, Chrome 10+ */
  background: -webkit-radial-gradient(circle, #FFFFFF, #000000);

  /* Firefox 3.6+ */ 
  background: -moz-radial-gradient(circle, #FFFFFF, #000000);

  /* IE 10 */ 
  background: -ms-radial-gradient(circle, #FFFFFF, #000000);

  /* Opera cannot do radial gradients yet */
}​ 
```

[http://jsfiddle.net/ETKpb/5/](http://jsfiddle.net/ETKpb/5/)

# ios - UITextField 可能发布得太早了，我不知道在哪里以及为什么

> ID：13614298
> 
> 赞同：0
> 
> 时间：2012-11-28T20:59:27.220
> 
> 标签：ios, automatic-ref-counting

以下是我班上关注的领域：

`.h`

```
@interface TimerViewController : UIViewController <UITextFieldDelegate> {
    IBOutlet UITextField *hourField,*minuteField;
}

@property (strong, nonatomic) IBOutlet UITextField *hourField,*minuteField;

@end 
```

`.m`

```
@implementation TimerViewController
@synthesize hourField,minuteField;

@end 
```

我的问题是，在应用程序因此日志崩溃之前，我可以多次使用文本字段（检索和设置属性）：

```
*** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason:
'-[__NSCFString setText:]: unrecognized selector sent to instance 0x1e1dafa0' 
```

运行代码时会发生这种情况`[self.hourField setText:@"5"];`。`[self.hourField isFirstResponder]`检查是否使用相同类型的日志时也会发生这种情况。

控制台将文本字段视为 a `__NSCFString`，这让我认为它可能已被释放？

与 ARC 一起运行，我总是使用合成访问器。以前从未遇到过这个问题，也看不出我哪里出错了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:19:16.940

我认为问题可能与您声明变量的方式混淆。您不再需要 @synthesize 语句，并且通常您希望私有 iVar 的拼写与您的属性声明不同。要查看这是否是问题，请删除您的 @property 声明和您的 @synthesize 并简单地访问 hourField [hourField setText:@"5"]; . 另一种方法是完全删除 @synthesize 和 iVar 声明。

其他我要检查的是 IBOutlet 是否连接到您的 .xib 或情节提要中的正确项目。

# php - PHP - 会话未在服务器上的页面之间传递

> ID：13614300
> 
> 赞同：-4
> 
> 时间：2012-11-28T20:59:31.167
> 
> 标签：php, session

> **可能重复：**
> [页面之间的 PHP 会话 ID 更改](https://stackoverflow.com/questions/2045550/php-session-id-changes-between-pages)

我对实时服务器上的会话有疑问。之前的开发人员对站点进行了编码，一切正常，直到上周我们不得不将服务器升级到 php 5.2。然后所有会话停止工作，用户无法登录。我删除了 session_register 等的使用，但没有任何效果。

对于一个简单的测试，我从 php.net 复制了一个非常简单的会话脚本，并在我的机器上进行了尝试，它可以工作。一旦我将它加载到服务器上，第二页就不会显示我在第一页中创建的会话变量。

是否需要在服务器上设置任何配置才能传递会话变量？

我在第一页使用了 print_r($_SESSION)，它显示了已创建的会话，我在第二页再次使用它，数组为空。

任何帮助或建议将不胜感激。

编辑：

```
 session_start(); 
```

包含在所有页面上，并且

```
 print_r($_SESSION) 
```

在第 1 页显示会话已创建，而在第 2 页显示会话未通过

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:02:17.333

您是否使用 开始会话`session_start()`？- [http://php.net/manual/en/function.session-start.php](http://php.net/manual/en/function.session-start.php)

# jquery - 如何根据另一个字段jquery规则消息验证一个字段是否包含某个值

> ID：13614306
> 
> 赞同：0
> 
> 时间：2012-11-28T20:59:51.730
> 
> 标签：jquery, asp.net, if-statement, conditional-statements

所以我有两个单选按钮，一个是“是”，另一个是“否”，我有一个文本框。它们都是asp.net控件。如果选中“是”单选按钮，我试图在文本框中输入一个值，如果选中“否”单选按钮，则不需要它。我需要使用 jQuery 规则和消息来做到这一点。有谁知道如何为以下控件执行此操作？

```
<asp:RadioButton runat="server" ID="rbYes" GroupName="radioGroup" Text="Yes"/>
<asp:RadioButton runat="server" ID="rbNo" GroupName="radioGroup" Text="No"/>
<asp:TextBox runat="server" ID="txtBox"/> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T23:30:40.003

看看`ClientID`.NET 控件的属性。例如，要确定是否选中了“是”单选按钮，请使用

```
var yesIsChecked = $('#<%=rbYes.ClientID%>').is(':checked'); 
```

同样，要测试文本框是否为空，请使用

```
var txtBoxIsEmpty = $('#<%=txtBox.ClientID%>').val() == ""; 
```

您可以将其与例如自定义验证器结合使用来实现您的目标。有关自定义验证器的更多信息，请[点击此处](http://www.4guysfromrolla.com/articles/073102-1.aspx)。在底部，文章提到了`ClientValidationFunction`属性，它应该包含执行验证逻辑的函数的名称。MSDN 参考在[这里](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.customvalidator.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T21:03:34.430

非常感谢，

这就是我解决问题的方式：

1.  要禁用或启用文本框，我将以下代码放在`$(document).ready()`jQuery 脚本块的部分中：

    ```
    if($('#<%= rbNo.ClientID  %>').is(':checked')) {
        txtBox.attr('disabled', true);
    } else {
        txtBox.removeAttr('disabled');
    } 
    ```

2.  将规则添加到 jQuery 验证（也在`$(document).ready()`代码块中）：

    ```
    var rules = {
        txtBox: {
            required: true,
            messages: {required: "Required field when Yes is checked"}
        }
    };

    $('#<%= rbNo.ClientID  %>').click(function (e) {
        if (this.checked) {
            txtBox.attr('disabled', true);
            addOrRemoveRules(rules, "remove");
        }
        else {
            txtBox.removeAttr('disabled');
            addOrRemoveRules(rules, "add");
        }
    }); 
    ```

3.  现在在`$(document).ready()`代码块之外，在`javascript`代码块中，您需要包含添加或删除规则和消息所需的函数：

    ```
    function addOrRemoveRules(rulesObj, operation){
    if (operation == "add") {
            for (var item in rulesObj){
                $('#'+item).rules('add',rulesObj[item]);  
            }
        }
        else{
            for (var item in rulesObj){
               $('#'+item).rules('remove');
            }
        }           
    } 
    ```

# vba - 如何在同一文件夹中的多个文件上获取特定文件的时间戳？

> ID：13614315
> 
> 赞同：0
> 
> 时间：2012-11-28T21:00:26.987
> 
> 标签：vba

我正在尝试编写一个简单的脚本来查看文件夹，找到指定的文件，然后在单元格上吐出时间戳。这是我已经拥有的简单部分（使用字符串和对象）。

我遇到问题的部分是在一个包含 +1,000 个文件的文件夹中重复超过 400 个特定文件。所有文件都有不同的标签，但有些可能有相似之处（AB.xls、AC.xls、AD.xls；A1.xls、A2.xls 等）。我可以走很长的路，只需冲洗并重复将字符串名称更改为每个特定文件，但这将花费太长时间来编写。

是否有一个捷径来循环这个，或者我是否需要为文件名添加一个变量行以每次更改？

这是一个片段：

```
Sub Timecheck() 
    Dim oFS As Object 
    Dim strFilename As String 

    strFilename = "Where the file is located" 
    Set oFS = CreateObject("Scripting.FileSystemObject") 
    Sheets("tab").Activate
    ActiveSheet.Cells(3, 3).Value = oFS.GetFile(strFilename).Datelastmodified 
    Set oFS = Nothing
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T21:27:32.293

循环思考一个文件夹：

```
Sub timecheck()
Dim FSO As Object
Dim FLD As Object
Dim fil As Object
Dim i As Long
Dim strFolder As String
i = 1

strFolder = "C:\Your Folder Name"

'Create the filesystem object
Set FSO = CreateObject("Scripting.FileSystemObject")
'Get a reference to the folder you want to search
Set FLD = FSO.GetFolder(strFolder)

'loop through the folder and get the file names
For Each fil In FLD.Files
    Sheets("Sheet1").Cells(i, 1) = fil.Name ' Filename in column A
    Sheets("Sheet1").Cells(i, 2) = fil.datelastmodified ' Date in column B
    i = i + 1
Next
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T21:28:26.773

如果文件的名称在另一张纸上，您需要创建另一个函数来遍历该单元格范围。

一旦你有了这个函数，让它调用这个函数：

```
Sub Timecheck(byval aCell as object,byval X as integer,Y as integer) 
    Dim oFS As Object 
    Dim strFilename As String 
    strFilename = aCell.Text 
    Set oFS = CreateObject("Scripting.FileSystemObject") 
    Sheets("tab").Activate
    ActiveSheet.Cells(X,Y).Value = oFS.GetFile(strFilename).Datelastmodified 
    Set oFS = Nothing
End Sub 
```

其中 X 和 Y 是要放入数据的单元格的坐标。您可以通过传入从另一张表中获取的范围内的单元格来调用它。

或者，如果您不想遍历范围，则将每个文件名放在新工作表上的单个单元格中，并用不会出现在名称中的字符对其进行分隔。然后把它分解成文件名。

祝你好运。

编辑：

如果您想遍历单元格内分隔列表中的项目，那么一旦您在对象中拥有单元格文本：

[http://msdn.microsoft.com/en-us/library/6x627e5f(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/6x627e5f(v=vs.80).aspx)

输入`'filename1.xls^filename2.xls^filename3.xls'`

一旦你有包含文件列表的单元格对象就调用

```
DoStuff(cellObejct, "^")

Public Sub DoStuff( byval aCell as object, byval specialChar as string)
    Dim ListOfNames as Variant
    Dim intIndex, xCell, yCell as integer

    ListOfNames = Split(aCell.Text,specialChar)

    xCell = 1
    yCell = 1

    For intIndex = LBound(ListOfNames) To UBound(ListOfNames) 
        TimeCheck(ListOfNames(intIndex),xCell,yCell)
        yCell = yCell + 1            
    Next intIndex
End Sub

    Sub Timecheck(byval fName as string,byval X as integer,Y as integer) 
        Dim oFS As Object 
        Set oFS = CreateObject("Scripting.FileSystemObject") 
        Sheets("tab").Activate
        ActiveSheet.Cells(X,Y).Value = oFS.GetFile(fName).Datelastmodified 
        Set oFS = Nothing
    End Sub 
```

# xmlhttprequest - 重复的访问控制允许来源：* 导致 COR 错误？

> ID：13614316
> 
> 赞同：1
> 
> 时间：2012-11-28T21:00:32.417
> 
> 标签：xmlhttprequest, cross-domain, cors, access-control

从客户的 web api 调用 rest api，它返回重复的 Access-Control-Allow-Origin: * 并导致 COR 错误。

我已经在本地进行了测试，并且重复确实会导致错误，而单个 Access-Control-Allow-Origin: * 有效。

调用 GET 时，我这边有没有办法解决这个问题？

```
HTTP/1.1 200 OK
Date: Wed, 28 Nov 2012 19:40:10 GMT
Server: Microsoft-IIS/6.0
X-Powered-By: ASP.NET
Access-Control-Allow-Origin: *
Access-Control-Allow-Origin: *
Set-Cookie: TargetToken=AB3Hirk0TNDPCfVY6LZd1Fs1; Expires=Fri, 28-Nov-2014 19:40:10 G11T;       Path=/; HttpOnly
Cache-Control: no-cache
Pragma: no-cache
Expires: -1
Content-Type: application/xml; charset=utf-8
Content-Length: 590 
```

> XMLHttpRequest 无法加载[http://target.com/api/getstuff?stuffid=4](http://target.com/api/getstuff?stuffid=4)。Access-Control-Allow-Origin 不允许来源[http://mysite.com 。](http://mysite.com)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T21:32:10.707

CORS 规范明确指出不允许使用多个 Access-Control-Allow-Origin 标头：http: [//www.w3.org/TR/cors/#resource-sharing-check-0](http://www.w3.org/TR/cors/#resource-sharing-check-0)

有没有办法说服客户修复他们的服务器实现？

# jquery - 使用 cookie 显示模态窗口

> ID：13614318
> 
> 赞同：0
> 
> 时间：2012-11-28T21:00:36.933
> 
> 标签：jquery, cookies, modal-dialog

我正在尝试使用 cookie 在每个会话中显示一次模态窗口。使用下面的代码，每个会话都会显示一次警报框，但是如果我放置模态代码，它就不起作用。

```
if ($.cookie('modal') != 'shown') { 
    $.cookie('modal', 'shown'); 
    alert("message");
} 
```

代替 alert("message") 我放置以下模式代码：

```
$("#dialog-modal").dialog({ 
    height: 750,
    width: 1045,
    modal: true,
    resizable: false,
    draggable: false
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:34:01.820

您是否确保将 jQuery 代码包装在`$(document).ready()`函数调用中，即：

```
$(document).ready(function () {
    $("#dialog-modal").dialog({ 
        height: 750,
        width: 1045,
        modal: true,
        resizable: false,
        draggable: false
    });
}); 
```

# performance - Wicket 中较短的链接网址

> ID：13614320
> 
> 赞同：1
> 
> 时间：2012-11-28T21:00:51.387
> 
> 标签：performance, url, wicket, wicket-1.6

我正在创建一个包含很多链接的应用程序。由于链接包含在表格的单元格中，Wicket 生成的 url 往往会变长，从而使页面加载速度变慢。

例如：

```
 <a href="./?0-2.ILinkListener-f-t-body-rows-11-cells-2-cell-li-35-link">2011-06-09 00:00:00.0</a> 
```

我试图弄清楚从哪里开始探索 URL 的编码/解码，但它是相当复杂的材料。我的第一种方法是只对组件使用“短”名称（如“t”、“f”等）。我可以想象有更好的方法。

我可以想象，只需对链接进行“编号”即可；由于页面仍然存在，所以我最终会得到这样的结果：

```
 <a href="./?0-2.ILinkListener-1237">2011-06-09 00:00:00.0</a> 
```

我的问题是否已经有解决方案，或者任何人都可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T08:31:25.360

如果 Javascript 解决方案是可接受的，您可以在整个表上使用单个事件侦听器，而不是在表中使用许多链接。

请参阅此示例以获取灵感：

[https://github.com/svenmeier/apachecon-wicket/tree/master/src/main/java/eu/apachecon/base/ui/performance](https://github.com/svenmeier/apachecon-wicket/tree/master/src/main/java/eu/apachecon/base/ui/performance)

请注意 Ajax 行为如何将动态额外参数传输到服务器。它只查找行。如果您需要区分被点击的表格*单元格*，您将不得不扩展这个想法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-02T22:37:36.230

Sven 建议的解决方案是更好的解决方案。

这是一个您可以称之为基本的解决方案：注册您自己的根 IRequestMapper，它将压缩/解压缩由真实映射器生成的 url。有关自定义根映射器的示例，请参阅 CryptoMapper 和 HttpsMapper。

# php - 为什么我的 PHP 表单没有发送信息？

> ID：13614323
> 
> 赞同：-2
> 
> 时间：2012-11-28T21:01:03.540
> 
> 标签：php, html, mysql, database, forms

我正在尝试在 PHP 中创建一个表单，然后将变量传递到下一页。我的问题是表单中的下拉元素根本没有传递它们的值。当我在下一页上执行 print_r($_GET) 以查看通过表单传递了哪些值时，只会出现类型为“text”或“radio”的输入。我不确定我做错了什么，因为我过去已经让这个工作了。有人能帮我吗？我知道我从 MySQL 查询中提取的变量名称是正确的，ID 也是正确的。

```
//begin form    
print "<form action = 'restaurant_confirm.php' method = 'GET'>";
print "Restaurant Name: <input type = 'text' size = 50 name = restaurant_name></br>";
// drop down for cuisine
print "Cuisine: <select>";
    while ($row = mysql_fetch_array($cuisine_result) ){
        print "<option name = 'cuisine' value = '".$row['cuisine_id']."'>". $row['cuisine_name']. "</option>";
    }
print "</select></br>";
// drop down form restaurant type
print "Restaurant Type: <select>";
    while ($row = mysql_fetch_array($type_result) ){
        print "<option name = 'restaurant_type' value = '".$row['type_id']."'>";
        print $row['restaurant_type'];
        print "</option>";
    }
print "</select></br>";
//Check boxes for price point
//table for alignment
print "Select one price point </br>";
print "<table>";
    //header row
    print "<tr>";
    print "<td>Price Point</td>";
    print "<td>Value</td>";
    print "<td>Select</td>";
    print "</tr>";
    while ($row = mysql_fetch_array($price_result)) {
        print "<tr>";
        //prints the price point
        print "<td>";
        print $row['price_point'];
        print "</td>";
        //prints the value
        print "<td>";
        print $row['price_value'];
        print "</td>";
        print "<td>";
        // radio button to choose
        print "<input type = 'radio' name = 'price_selection' value = ".$row['price_id'].">";
        print "</tr>";
    }

print"</table></br>";

//Check boxes for gluten type
//table for alignment
print "Select one gluten type</br>";
print "<table>";
    //header row
    print "<tr>";
    print "<td>Gluten Type</td>";
    print "<td>Select</td>";
    print "</tr>";
    while ($row = mysql_fetch_array($gluten_result)) {
        print "<tr>";
        //prints the gluten type
        print "<td>";
        print $row['gluten_type'];
        print "</td>";
        print "<td>";
        // radio button to choose
        print "<input type = 'radio' name = 'gluten_selection' value = ".$row['gluten_type_id'].">";
        print"</td>";
        print "</tr>";
    }

print "</table></br>";
//submit button
print "<input type = 'submit' value = 'Add'>"; 
```

打印 ””;

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T21:03:52.987

你`select`没有名字，这是必需的。

将选择更改为`<select name="whatever">`，您将能够通过`$_GET["whatever"]`下一页获取它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T21:03:45.557

您的输入和选择字段没有`name`指定参数。`name`定义变量名。

`<input name="blah" />`也会如此`$_GET['blah']`

# indy - IdNotify：如何将参数传递给函数

> ID：13614325
> 
> 赞同：1
> 
> 时间：2012-11-28T21:01:12.103
> 
> 标签：indy, lazarus

经过长时间的斗争，我安装了带有 lazarus 的代码台风，我设法将单元 IdSync 包含到我的项目中。

如何将参数传递给要在 TIdNotify 的主线程中执行的函数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T03:42:53.730

你必须重写 TIdNotify.DoNotify() 方法，然后你可以传递你想要的任何参数，例如：

```
type
  TMyNotify = class(TIdNotify)
  protected
    procedure DoNotify; override;
  end;

procedure TMyNotify.DoNotify;
begin
  SomeFunction(parameters);
end; 
```

.

```
begin
  ...
  TMyNotify.Create.Notify;
  ...
end; 
```

大概，您希望调用线程指定参数值，因此只需将它们设为类的成员，例如：

```
type
  TMyNotify = class(TIdNotify)
  protected
    Param1: SomeType;
    Param2: SomeType;
    Param3: SomeType;
    procedure DoNotify; override;
  end;

procedure TMyNotify.DoNotify;
begin
  SomeFunction(Param1, Param2, Param2);
end; 
```

.

```
begin
  ...
  with TMyNotify.Create do
  begin
    Param1 := ...;
    Param2 := ...;
    Param3 := ...
    Notify;
  end;
  ...
end; 
```

# wso2 - WSO2 ESB 4.5.0 无法启动，挂载到远程注册表后挂起

> ID：13614327
> 
> 赞同：1
> 
> 时间：2012-11-28T21:01:18.360
> 
> 标签：wso2, wso2esb, wso2carbon

我在 ESB 启动时遇到问题。在出现以下 INFO 消息后，它在安装到远程存储库后立即失败，但之前它以相同的配置启动而没有任何问题：

```
TID: [] [WSO2 Enterprise Service Bus] [2012-11-28 15:16:22,604]  INFO {org.wso2.carbon.registry.core.internal.RegistryCoreServiceComponent} -  Registry Mode    : READ-WRITE {org.wso2.carbon.registry.core.internal.RegistryCoreServiceComponent} 
```

我启用了调试并注意到一些重复出现的消息，这些消息永远不会停止发生：

```
TID: [] [WSO2 Enterprise Service Bus] [2012-11-28 15:25:21,926] DEBUG    {org.wso2.carbon.registry.core.statistics.StatisticsLog} -  Total Number of Connections Created      : 598 {org.wso2.carbon.registry.core.statistics.StatisticsLog}
TID: [] [WSO2 Enterprise Service Bus] [2012-11-28 15:25:21,926] DEBUG {org.wso2.carbon.registry.core.statistics.StatisticsLog} -  Total Number of Connections Closed       : 614 {org.wso2.carbon.registry.core.statistics.StatisticsLog}
TID: [] [WSO2 Enterprise Service Bus] [2012-11-28 15:25:21,926] DEBUG {org.wso2.carbon.registry.core.statistics.StatisticsLog} -  Total Number of Connections Committed    : 614 {org.wso2.carbon.registry.core.statistics.StatisticsLog}
TID: [] [WSO2 Enterprise Service Bus] [2012-11-28 15:25:21,926] DEBUG {org.wso2.carbon.registry.core.statistics.StatisticsLog} -  Total Number of Connections Rollbacked   : 0 {org.wso2.carbon.registry.core.statistics.StatisticsLog}
TID: [] [WSO2 Enterprise Service Bus] [2012-11-28 15:25:21,926] DEBUG {org.wso2.carbon.registry.core.statistics.StatisticsLog} -  Total Number of Statements Prepared      : 402 {org.wso2.carbon.registry.core.statistics.StatisticsLog}
TID: [] [WSO2 Enterprise Service Bus] [2012-11-28 15:25:21,926] DEBUG {org.wso2.carbon.registry.core.statistics.StatisticsLog} -  Total Number of Statements Closed        : 402 {org.wso2.carbon.registry.core.statistics.StatisticsLog}
TID: [] [WSO2 Enterprise Service Bus] [2012-11-28 15:25:21,926] DEBUG {org.wso2.carbon.registry.core.statistics.StatisticsLog} -  Total Number of Active Transactions      : 0 {org.wso2.carbon.registry.core.statistics.StatisticsLog}
TID: [] [WSO2 Enterprise Service Bus] [2012-11-28 15:25:22,115] DEBUG {org.wso2.carbon.registry.core.statistics.StatisticsLog} -  Total Number of get calls                : 36 {org.wso2.carbon.registry.core.statistics.StatisticsLog}
TID: [] [WSO2 Enterprise Service Bus] [2012-11-28 15:25:22,115] DEBUG {org.wso2.carbon.registry.core.statistics.StatisticsLog} -  Total Number of put calls                : 0 {org.wso2.carbon.registry.core.statistics.StatisticsLog}
TID: [] [WSO2 Enterprise Service Bus] [2012-11-28 15:25:22,115] DEBUG {org.wso2.carbon.registry.core.statistics.StatisticsLog} -  Total Number of import calls             : 0 {org.wso2.carbon.registry.core.statistics.StatisticsLog}
TID: [] [WSO2 Enterprise Service Bus] [2012-11-28 15:25:22,115] DEBUG {org.wso2.carbon.registry.core.statistics.StatisticsLog} -  Total Number of move calls               : 0 {org.wso2.carbon.registry.core.statistics.StatisticsLog}
TID: [] [WSO2 Enterprise Service Bus] [2012-11-28 15:25:22,115] DEBUG {org.wso2.carbon.registry.core.statistics.StatisticsLog} -  Total Number of copy calls               : 0 {org.wso2.carbon.registry.core.statistics.StatisticsLog}
TID: [] [WSO2 Enterprise Service Bus] [2012-11-28 15:25:22,115] DEBUG {org.wso2.carbon.registry.core.statistics.StatisticsLog} -  Total Number of rename calls             : 0 {org.wso2.carbon.registry.core.statistics.StatisticsLog}
TID: [] [WSO2 Enterprise Service Bus] [2012-11-28 15:25:22,115] DEBUG {org.wso2.carbon.registry.core.statistics.StatisticsLog} -  Total Number of delete calls             : 0 {org.wso2.carbon.registry.core.statistics.StatisticsLog}
TID: [] [WSO2 Enterprise Service Bus] [2012-11-28 15:25:22,116] DEBUG {org.wso2.carbon.registry.core.statistics.StatisticsLog} -  Total Number of addAssociation calls     : 0 {org.wso2.carbon.registry.core.statistics.StatisticsLog}
TID: [] [WSO2 Enterprise Service Bus] [2012-11-28 15:25:22,116] DEBUG {org.wso2.carbon.registry.core.statistics.StatisticsLog} -  Total Number of removeAssociation calls  : 0 {org.wso2.carbon.registry.core.statistics.StatisticsLog}
TID: [] [WSO2 Enterprise Service Bus] [2012-11-28 15:25:22,116] DEBUG {org.wso2.carbon.registry.core.statistics.StatisticsLog} -  Total Number of getAssociations calls    : 0 {org.wso2.carbon.registry.core.statistics.StatisticsLog}
TID: [] [WSO2 Enterprise Service Bus] [2012-11-28 15:25:22,116] DEBUG {org.wso2.carbon.registry.core.statistics.StatisticsLog} -  Total Number of getAllAssociations calls : 0 {org.wso2.carbon.registry.core.statistics.StatisticsLog}
TID: [] [WSO2 Enterprise Service Bus] [2012-11-28 15:25:22,116] DEBUG {org.wso2.carbon.registry.core.statistics.StatisticsLog} -  Total Number of executeQuery calls       : 0 {org.wso2.carbon.registry.core.statistics.StatisticsLog}
TID: [] [WSO2 Enterprise Service Bus] [2012-11-28 15:25:22,116] DEBUG {org.wso2.carbon.registry.core.statistics.StatisticsLog} -  Total Number of resourceExists calls     : 234 {org.wso2.carbon.registry.core.statistics.StatisticsLog}
TID: [] [WSO2 Enterprise Service Bus] [2012-11-28 15:25:22,116] DEBUG {org.wso2.carbon.registry.core.statistics.StatisticsLog} -  Total Number of dump calls               : 0 {org.wso2.carbon.registry.core.statistics.StatisticsLog}
TID: [] [WSO2 Enterprise Service Bus] [2012-11-28 15:25:22,116] DEBUG {org.wso2.carbon.registry.core.statistics.StatisticsLog} -  Total Number of restore calls            : 0 {org.wso2.carbon.registry.core.statistics.StatisticsLog}
TID: [] [WSO2 Enterprise Service Bus] [2012-11-28 15:25:24,262] DEBUG {org.wso2.carbon.user.core.util.DatabaseUtil} -  Total Number of Connections Created      : 2 {org.wso2.carbon.user.core.util.DatabaseUtil}
TID: [] [WSO2 Enterprise Service Bus] [2012-11-28 15:25:24,262] DEBUG {org.wso2.carbon.user.core.util.DatabaseUtil} -  Total Number of Connections Closed       : 12 {org.wso2.carbon.user.core.util.DatabaseUtil} 
```

完整日志可[在此处获得](http://pastebin.com/2i5hExVX)

主数据源.xml：

```
 <datasource>
        <name>WSO2_CARBON_DB</name>
        <description>The datasource used for registry and user manager</description>
        <jndiConfig>
            <name>jdbc/WSO2CarbonDB</name>
        </jndiConfig>
        <definition type="RDBMS">
            <configuration>
                <url>jdbc:mysql://localhost:3306/WSO2_ESB?autoReconnect=true</url>
                <username>username</username>
                <password>password</password>
                <driverClassName>com.mysql.jdbc.Driver</driverClassName>
                <maxActive>50</maxActive>
                <maxWait>60000</maxWait>
                <testOnBorrow>true</testOnBorrow>
                <validationQuery>SELECT 1</validationQuery>
                <validationInterval>30000</validationInterval>
            </configuration>
        </definition>
    </datasource>

    <datasource>
        <name>WSO2_CARBON_DB_GREG</name>
        <description>The datasource used for registry </description>
        <jndiConfig>
            <name>jdbc/WSO2CarbonDB_GREG</name>
        </jndiConfig>
        <definition type="RDBMS">
            <configuration>
                <url>jdbc:mysql://localhost:3306/WSO2_REGISTRY?autoReconnect=true</url>
                <username>username</username>
                <password>password</password>
                <driverClassName>com.mysql.jdbc.Driver</driverClassName>
                <maxactive>50</maxactive>
                <maxwait>60000</maxwait>
                <testonborrow>true</testonborrow>
                <validationquery>SELECT 1</validationquery>
                <validationinterval>30000</validationinterval>
            </configuration>
        </definition>
    </datasource> 
```

注册表.xml：

```
<currentDBConfig>wso2registry</currentDBConfig>
<readOnly>false</readOnly>
<enableCache>true</enableCache>
<registryRoot>/</registryRoot>

<dbConfig name="wso2registry">
    <dataSource>jdbc/WSO2CarbonDB</dataSource>
</dbConfig>

<dbConfig name="wso2registry_mounted">
    <dataSource>jdbc/WSO2CarbonDB_GREG</dataSource>
</dbConfig>

<remoteInstance url="https://localhost:9443/registry">
    <id>wso2_registry_mounted</id>
    <dbConfig>wso2registry_mounted</dbConfig>
    <readOnly>false</readOnly>
    <enableCache>true</enableCache>
    <registryRoot>/</registryRoot>
</remoteInstance>

<mount overwrite="true" path="/_system/config">
    <instanceId>wso2_registry_mounted</instanceId>
    <targetPath>/_system/nodes</targetPath>
</mount>

<mount overwrite="true" path="/_system/governance">
    <instanceId>wso2_registry_mounted</instanceId>
    <targetPath>/_system/governance</targetPath>
</mount> 
```

有没有人遇到过同样的问题？

在此先感谢，弗拉基米尔。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T05:09:57.710

我注意到您的配置中有标签错误。标签区分大小写。以下标签在您的第二个数据源配置中是错误的。

```
<maxactive>50</maxactive>
<maxwait>60000</maxwait>
<testonborrow>true</testonborrow>
<validationquery>SELECT 1</validationquery>
<validationinterval>30000</validationinterval> 
```

它应该是，

```
<maxActive>50</maxActive>
<maxWait>60000</maxWait>
<testonBorrow>true</testonBorrow>
<validatiOnQuery>SELECT 1</validatiOnQuery>
<validatiOnInterval>30000</validatiOnInterval> 
```

同时，您可以按照 [1] 中的指南进行操作。

1.  [http://ajithvblogs.blogspot.com/2012/09/create-jdbc-mount-to-wso2-governance.html](http://ajithvblogs.blogspot.com/2012/09/create-jdbc-mount-to-wso2-governance.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-11T03:08:30.177

刚遇到这个问题，它在试图安装我们正在设置的两个坐骑之一时卡住了。我们发现通过注释掉它是有效的。

我们获得两种安装的最终解决方案是创建一个新文件夹并将所有内容移入其中，删除旧文件夹，然后重命名新文件夹。

# c++ - shared_ptr 的子数据（类似子字符串？）

> ID：13614333
> 
> 赞同：0
> 
> 时间：2012-11-28T21:01:50.303
> 
> 标签：c++, boost, shared-ptr

我有一个数据缓冲区存储在`shared_ptr<void>`.

这个缓冲区被组织在几个封装层中，所以我最终得到：

```
-----------------------------------...
- Header 1 | Header 2 | Data
-----------------------------------... 
```

（实际上它是一个以太网数据包，我在其中逐层解封装）。

一旦我读取了 Header 1，我想将数据包的其余部分传递给下一层进行读取，所以我想创建一个指向：

```
-----------------------...
- Header 2 | Data
-----------------------... 
```

使用原始指针将非常容易，因为它只是指针算术的问题。但是我怎样才能用 shared_ptr 实现呢？（我使用 boost::shared_ptr）：

*   我无法为“第一个 shared_ptr.get() + offset”创建一个新的 shared_ptr，因为将所有权归于公正是没有意义的`Header 2 + Data`（并且 delete 最终会崩溃）
*   我不想复制数据，因为它会很傻
*   **我希望在两个对象之间共享整个**缓冲区的所有权（即，只要父对象或仅需要 Header 2 的对象需要数据，则不应删除数据）。

我可以把它包装成这样的结构，`boost::tuple<shared_ptr<void>, int /*offset*/, int /*length*/>`但我想知道是否有更方便/优雅的方式来实现这一结果。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:33:26.297

我建议将每个层封装在一个知道如何处理数据的类中，就好像它是那个层一样。将每一个都视为缓冲区的视图。这是一个让你思考的起点。

```
class Layer1{
public:
    Layer1(shared_ptr<void> buffer) : buffer_(buffer) { }

   /* All the functions you need for treating your buffer as a Layer 1 type */
    void DoSomething() {}

private:
   shared_ptr<void> buffer_;
};

class Layer2{
public:
    Layer2(shared_ptr<void> buffer) : buffer_(buffer) { }

   /* All the functions you need for treating your buffer as a Layer 2 type */
    void DoSomethingElse() {}

private:
   shared_ptr<void> buffer_;
}; 
```

以及如何使用它：

```
shared_ptr<void> buff = getBuff(); //< Do what you need to get the raw buffer.

// I show these together, but chances are, sections of your code will only need
// to think about the data as though it belongs to one layer or the other.
Layer1 l1(buff);
Layer2 l2(buff);

l1.DoSomething();
l2.DoSomethingElse(); 
```

以这种方式布局允许您编写仅在该层上运行的函数，即使它们在内部表示相同的数据。

但是，*这绝不是完美的。*

也许 Layer2 应该能够调用 Layer1 的方法。为此，您也需要继承。我对您的设计知之甚少，无法说出这是否有帮助。其他改进的空间是用`shared_ptr<void>`一个具有处理缓冲区的有用方法的类来替换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T21:08:40.107

你能用一个简单的包装器吗？

像这样的东西？

```
class HeaderHolder : protected shared_ptr<void> {
public:
    // Constructor and blah blah

    void* operator* () {
        offset += a_certain_length;
        return (shared_ptr<void>::operator*() + offset);
    }
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T13:43:42.027

顺便说一句，我只是使用了一个简单的包装器，如果有人偶然发现这个问题，我会在这里复制它。

```
class DataWrapper {
public:
    DataWrapper (shared_ptr<void> pData, size_t offset, size_t length) : mpData(pData), mOffset(offset), mLength(length) {}

    void* GetData() {return (unsigned char*)mpData.get() + mOffset;}
    // same with const...
    void SkipData (size_t skipSize) { mOffset += skipSize; mLength -= skipSize; }
    void GetLength const {return mLength;}

    // Then you can add operator+, +=, (void*), -, -=
    // if you need pointer-like semantics.
    // Also a "memcpy" member function to copy just this buffer may be useful
    // and other helper functions if you need

private:
    shared_ptr<void> mpData;
    size_t mOffset, mLength;
}; 
```

使用 GetData 时要小心：确保在使用不安全的 void* 时不会释放缓冲区。只要您知道 DataWrapper 对象是活动的，使用 void* 是安全的（因为它在缓冲区中保存了一个 shared_ptr，因此它可以防止它被释放）。

# php - PHP中的排队系统

> ID：13614338
> 
> 赞同：-1
> 
> 时间：2012-11-28T21:02:15.143
> 
> 标签：php, logic

我有一个网站，我有一个查询被分配给服务台的销售人员。销售人员分为 A 级、B 级和 C 级，其中 A 级表现最好，B 级和 C 级表现更好和公平的表演者。

现在，当查询到达队列时，应按以下比例分配查询，如下所示

```
 Grade A:Grade B:Grade C  = 3:2:1 
```

也就是说，当队列开始时，前三个查询应该分配给 A 级，接下来 2 个分配给 B 级，最后 1 个分配给 C。

如何在 PHP 中实现这一点

编辑：我有一个 Web 表单，人们将在其中发布有关各种项目的查询，并将其分配给服务台的销售人员。根据销售人员的经验，他们被分为A级、B级和C级，C级是经验最少的，与A级和B级相比，他们参加询盘的速度相对较慢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:30:46.373

按顺序对查询进行编号，然后：

```
$inq_id = 12345;
$assign_raw = $inq_id % 6;

switch($assign_raw) {
    case 0:
    case 1:
    case 2:
        assign_to('Class_A', $inq_id);
        break;;
    case 3:
    case 4:
        assign_to('Class_B', $inq_id);
        break;;
    case 5:
        assign_to('Class_C', $inq_id);
        break;
} 
```

或者对查询的某些 [理想上唯一] 部分执行一些哈希函数，并将其用作模数 [ `%`] 操作的基础。IE：

```
$assign_raw = hexdec(substr(md5($client_email), -4)) % 6; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T21:29:09.533

听起来您需要编写一个算法来分析表单发布的“查询”，并将“查询”路由到正确的组。我们无法猜测解析查询所需的业务逻辑并确定如何路由“查询”，这取决于您根据您的业务需求来确定。

但是，您可以使用以下演示性想法作为起点：

问题一：我如何一边走路一边嚼口香糖？

解决方案：解析关键字“walk”和“chew”，路由到 C 组。

问题 2：如何制造黑质？

解决方案：解析短语“black matter”，路由到 A 组。

等等

或者，如果您有预先设定的查询，您可以根据提交的“查询 ID”将算法路由到正确的组。

这个问题可能会被关闭，因为它不会收到“确切”的解决方案，但这应该有助于您朝着正确的方向开始。

# session - 在 PHP 中的响应函数（XMLHTML 请求）中获取 SESSION

> ID：13614344
> 
> 赞同：0
> 
> 时间：2012-11-28T21:03:02.287
> 
> 标签：session

我尝试将 $_SESSION["avalue"] 从 request.php 文件扔到 response.php 文件，如下所示：
request.php：

```
<?php
    $_SESSION["across"] = "across Session";
?>

<script type="text/javascript"> 
  function requestExample(){
    xmlhttp.open("POST", "../response.php?Name=Example", true);
    xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
    xmlhttp.send();
  }
</script> 
```

... .......
Response.php：

```
<?php
if(isset($_GET["Name"]))
{
    $name = $_GET["Name"];
    switch($name){
        case "Example":
            echo $_SESSION["across"];
            break;
                ......
    }
}

?> 
```

我收到错误：未定义的索引：在 ......../response.php 中

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T10:16:36.527

我通过使用下面的代码得到了它。[来源 http://docs.joomla.org/How_to_access_session_variables_set_by_an_external_script]

```
define( '_JEXEC', 1 );
define( 'DS', DIRECTORY_SEPARATOR );
define('JPATH_BASE', dirname(__FILE__) );

require_once ( JPATH_BASE .DS.'includes'.DS.'defines.php' );
require_once ( JPATH_BASE .DS.'includes'.DS.'framework.php' );

$mainframe =& JFactory::getApplication('site');
$mainframe->initialise();

$session =& JFactory::getSession();
$user = $session->get( 'across' ); 
```

谢谢！

# css - 为什么选择框默认在 WordPress 管理面板中滚动而不是下拉？

> ID：13614346
> 
> 赞同：0
> 
> 时间：2012-11-28T21:03:05.057
> 
> 标签：css, wordpress, styles, wordpress-theming

我正在 WordPress 中制作一个特定主题的管理面板。我在使用 select 标签时遇到了一个问题，我知道我没有任何样式使它表现得这样：

![在此处输入图像描述](../Images/6bde3654dbf095a8ccc16766e15fcd5f.png)

这不是我的面板的屏幕截图，但这是一个很好的例子。看到左上角的方框了吗？好吧，每当我使用选择框时，它默认为图片中的滚动模式。我不希望它那样做。我希望它是一个常规的下拉列表框，就像图像中的其他 3 个一样。我不知道这是否是 CSS 问题。我已经查看了一些关于选择框的资源，但没有一个提到任何关于选择标签的类型属性或任何可以让我改变滚动模式的内容。是否有某种内置的 wordpress 样式可以改变选择标签在管理面板中的呈现方式？如果是这样，我如何设置这个元素的样式，使它只是一个常规的下拉列表框？这是我用于选择的代码：

```
<select name="slide_type" size="30">
                        <option>Slice Down</option>
                        <option>Slice Down Left</option>
                        <option>Slice Up</option>
                        <option>Slice Up Left</option>
                        <option>Slice Down</option>
                        <option>Slice Up & Down</option>
                        <option>Slice Up & Down Left</option>
                        <option>Fold</option>
                    </select> 
```

注意：我已经检查了 firebug，并且没有附加到这个下拉列表或其名称的样式 - “slide_type”，而不是以下 CSS：

```
select{
   color: black;
} 
```

非常感谢任何建议或帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:19:48.437

嗯，当然是大小值。

采用

```
 size=1 
```

（或未定义）

并获得[免费的愚蠢演示](http://jsfiddle.net/62LGJ/)！

# c++ - gtkmm 项目中如何包含 libsigc？

> ID：13614348
> 
> 赞同：0
> 
> 时间：2012-11-28T21:03:19.173
> 
> 标签：c++, gtk, gtkmm, libsigc++

在[gtkmm 教程 hello world 示例](http://developer.gnome.org/gtkmm-tutorial/3.2/sec-helloworld.html.en)中，该`libsigc++`库在`helloword.cc`文件中使用：

```
#include "helloworld.h"
#include <iostream>

HelloWorld::HelloWorld()
: m_button("Hello World")   // creates a new button with label "Hello World".
{
    // Sets the border width of the window.
    set_border_width(10);

    // When the button receives the "clicked" signal, it will call the
    // on_button_clicked() method defined below.
    m_button.signal_clicked().connect(sigc::mem_fun(*this,
                &HelloWorld::on_button_clicked));

    // This packs the button into the Window (a container).
    add(m_button);

    // The final step is to display this newly created widget...
    m_button.show();
} 
```

但是，`libsigc++`从未包含在此文件中，但仍然可以正常工作。`sigc`命名空间从何而来？

编辑 `helloworld.h`：：

```
#ifndef GTKMM_EXAMPLE_HELLOWORLD_H
#define GTKMM_EXAMPLE_HELLOWORLD_H

#include <gtkmm/button.h>
#include <gtkmm/window.h>

class HelloWorld : public Gtk::Window
{

  public:
    HelloWorld();
    virtual ~HelloWorld();

  protected:
    //Signal handlers:
    void on_button_clicked();

    //Member widgets:
    Gtk::Button m_button;
};

#endif // GTKMM_EXAMPLE_HELLOWORLD_H 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:13:19.653

检查“gtkmm/window.h”的内容

[http://fossies.org/unix/privat/gtkmm-3.6.0.tar.gz/dox/gtk_2gtkmm_2window_8h.html](http://fossies.org/unix/privat/gtkmm-3.6.0.tar.gz/dox/gtk_2gtkmm_2window_8h.html)

它包括“sigc++.h”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T08:46:40.887

你可以找到包含在`main.h`

[http://git.gnome.org/browse/gtkmm/tree/gtk/src/main.hg#n22](http://git.gnome.org/browse/gtkmm/tree/gtk/src/main.hg#n22)

其中包括`gtkmm.h`

[http://git.gnome.org/browse/gtkmm/tree/gtk/gtkmm.h#n181](http://git.gnome.org/browse/gtkmm/tree/gtk/gtkmm.h#n181)

# mysql - MysqlDataTruncation：数据截断：列的数据太长

> ID：13614349
> 
> 赞同：-1
> 
> 时间：2012-11-28T21:03:30.260
> 
> 标签：mysql, jasper-reports, jasperserver

我正在尝试在 jaspersoft 服务器上配置 jaspersoft 报告。我创建了一个报告，该报告执行一个传递多个值的存储过程。

当我尝试运行将长字符串作为输入参数传递的报告时，服务器显示以下错误：

```
com.jaspersoft.jasperserver.api.JSException: Error filling report
com.mysql.jdbc.MysqlDataTruncation: Data truncation: Data too long for column 'canales'
at row 1 at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3607)
at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3541) 
at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2002) 
at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2163) 
at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2624) 
at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:2127) 
at com.mysql.jdbc.PreparedStatement.executeQuery(PreparedStatement.java:2293) 
at org.apache.commons.dbcp.DelegatingPreparedStatement.executeQuery(DelegatingPreparedStatement.java:92) 
at net.sf.jasperreports.engine.query.JRJdbcQueryExecuter.createDatasource(JRJdbcQueryExecuter.java:239) 
... 15 more 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T21:15:48.043

要禁用数据截断引发的错误，请首先检查您的当前配置：

```
SHOW VARIABLES LIKE 'sql_mode' 
```

你可能有这样的事情：

```
STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION
STRICT_ALL_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION 
```

所以只需通过执行删除 STRICT_TRANS_TABLES 或 STRICT_ALL_TABLES （取决于存储引擎）

```
SET sql_mode = 'NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION'; 
```

最好的解决方案是在执行查询之前检查字符串的长度，如果超过可能的长度则截断它

# php - DynamoDB-PHP：当区域不是东海岸时出错

> ID：13614351
> 
> 赞同：1
> 
> 时间：2012-11-28T21:03:35.793
> 
> 标签：php, amazon-dynamodb

我有一个 PHP 应用程序，使用 symfony2、silex 和 AWS DynamoDB SDK。它工作正常。DynamoDB 在东海岸创建。

我们有第二个 AWS 账户，我们复制了 DynamoDB 结构（表名、表结构等都相同）。此 DynamoDB 安装位于西海岸（加利福尼亚北部）。

当我们尝试使用第二个 AWS 凭证时，我的应用程序无法运行。

当我尝试这样做时：

```
$res = $app['db']->describe_table(array('TableName' => 'account')); 
```

我转储 $res，这就是我得到的：

```
CFResponse Object
(
[header] => Array
    (
        [x-amzn-requestid] => xxxxxxxxxxxxxxxxxxxxxxxxxx
        [x-amz-crc32] => xxxxxxxxxxxxx
        [content-type] => application/x-amz-json-1.0
        [content-length] => 143
        [date] => Wed, 28 Nov 2012 20:49:31 GMT
        [_info] => Array
            (
                [url] => https://dynamodb.us-east-1.amazonaws.com/
                [content_type] => application/x-amz-json-1.0
                [http_code] => 400
                [header_size] => 224
                [request_size] => 896
                [filetime] => -1
                [ssl_verify_result] => 0
                [redirect_count] => 0
                [total_time] => 0.363967
                [namelookup_time] => 0.008497
                [connect_time] => 0.091183
                [pretransfer_time] => 0.263514
                [size_upload] => 28
                [size_download] => 143
                [speed_download] => 392
                [speed_upload] => 76
                [download_content_length] => 143
                [upload_content_length] => 0
                [starttransfer_time] => 0.363929
                [redirect_time] => 0
                [certinfo] => Array
                    (
                    )

                [redirect_url] => 
                [method] => POST
            )

        [x-aws-stringtosign] => AWS4-HMAC-SHA256
            20121128T204931Z
            20121128/us-east-1/dynamodb/aws4_request
            xxxxxxxxxxxxxxxxxxxxxxx
        [x-aws-canonicalrequest] => POST
            /
            content-length:28
            content-type:application/x-amz-json-1.0
            host:dynamodb.us-east-1.amazonaws.com
            x-amz-date:20121128T204931Z
            x-amz-target:DynamoDB_20111205.DescribeTable
            content-length;content-type;host;x-amz-date;x-amz-target
            xxxxxxxxxxxxxxxxxxxxxxxxxxxxx
        [x-aws-request-headers] => Array
            (
                [Content-Length] => 28
                [Content-Type] => application/x-amz-json-1.0
                [Host] => dynamodb.us-east-1.amazonaws.com
                [X-Amz-Date] => 20121128T204931Z
                [X-Amz-Target] => DynamoDB_20111205.DescribeTable
                [Authorization] => AWS4-HMAC-SHA256 Credential=AKIAJAIBF2DKGD2UD3YQ/20121128/us-east-1/dynamodb/aws4_request,SignedHeaders=content-length;content-type;host;x-amz-date;x-amz-target,Signature=xxxxxxxxxxxxxxxxxxxxxxxx
                [Expect] => 
            )

        [x-aws-body] => {"TableName":"account"}
    )

[body] => CFSimpleXML Object
    (
        [__type] => com.amazonaws.dynamodb.v20111205#ResourceNotFoundException
        [message] => Requested resource not found: Table: account not found
    )

[status] => 400
) 
```

我认为唯一需要的配置是在 AWS DynamoDB SDK 文件 config.inc.php 中，我只能在其中配置凭证。情况似乎并非如此，因为响应包含对东海岸的所有这些引用，而我的目标 DynamoDB 表位于西海岸。有什么想法可以告诉它 AmazonSDK 指向另一个区域吗？还有什么我应该关心的问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T01:27:40.603

解决了。它被隐藏在文档中（亚马逊认为该产品及其文档为 BETA）。

在使用 $app['db'] 之前，我需要做：

```
$app['db']->set_region('dynamodb.us-west-1.amazonaws.com'); 
```

或创建我的 DynamoDB 的任何区域。亚马逊提供了一些区域常量作为 amazonDynamodb 类的一部分，但我在使用它们时遇到了问题。因此，您可以使用 REGION_US_W1 之类的东西，而不是“dynamodb.us-west-1.amazonaws.com”

似乎默认情况下使用 REGION_US_E1，所以如果您在该区域，您可能不需要设置任何内容，但这样做可能是明智的，因为亚马逊可能会修改 SDK 类。

# java - ContactsContract 返回此字符串 content://com.android.contacts/data/1 而不是联系人列表中的电话号码

> ID：13614352
> 
> 赞同：0
> 
> 时间：2012-11-28T21:03:39.953
> 
> 标签：java, android, contactscontract

我从Beginning Android™ Application Development Book 中复制代码示例。该代码用于在用户单击按钮时根据我的应用程序上的电话号码显示联系人列表。当我评论`// startActivity(i); on onActivityResult(int requestCode, int resultCode, Intent data) function`我得到以下字符串时，代码工作正常

> 内容：//com.android.contacts/data/1

但我想从我的联系人列表中获取电话号码。为此，我使用以下代码。

```
public OnClickListener addContactButtonListener = new OnClickListener() {

    @Override
    public void onClick(View v) {
        // TODO Auto-generated method stub
        Log.v(TAG, "addContactButtonListener  ");
        Intent i = new Intent(android.content.Intent.ACTION_PICK);
        i.setType(ContactsContract.CommonDataKinds.Phone.CONTENT_TYPE);
        startActivityForResult(i, 1);

    }
};

public void onActivityResult(int requestCode, int resultCode, Intent data) {
    Log.v(TAG, "onActivityResult");

    if (requestCode == 1) {
        Log.v(TAG, "onActivityResult > requestCode " + requestCode);

        if (resultCode == RESULT_OK) {
            Log.v(TAG, "onActivityResult > resultCode " + resultCode);
            Toast.makeText(this, data.getData().toString(),
                    Toast.LENGTH_SHORT).show();

            queryEditText.setText(data.getData().toString());
            Intent i = new Intent(android.content.Intent.ACTION_VIEW,
                    Uri.parse(data.getData().toString()));

            Log.v(TAG, "onActivityResult > startActivity " + i.toString());

            startActivity(i);
        }
    }
} 
```

但是在取消评论时`startActivity(i);` 我得到了以下错误

```
11-09 23:09:37.913: V/MyApp_Main(4002): onActivityResult > startActivity Intent { act=android.intent.action.VIEW dat=content://com.android.contacts/data/1 }
11-09 23:09:37.923: D/AndroidRuntime(4002): Shutting down VM
11-09 23:09:37.923: W/dalvikvm(4002): threadid=1: thread exiting with uncaught exception (group=0x40015560)
11-09 23:09:37.933: E/AndroidRuntime(4002): FATAL EXCEPTION: main
11-09 23:09:37.933: E/AndroidRuntime(4002): java.lang.RuntimeException: Failure delivering result ResultInfo{who=null, request=1, result=-1, data=Intent { dat=content://com.android.contacts/data/1 flg=0x1 (has extras) }} to activity {com.example.MyApp/com.example.MyApp.MyApp_Main}: android.content.ActivityNotFoundException: No Activity found to handle Intent { act=android.intent.action.VIEW dat=content://com.android.contacts/data/1 }
11-09 23:09:37.933: E/AndroidRuntime(4002):     at android.app.ActivityThread.deliverResults(ActivityThread.java:2532)
11-09 23:09:37.933: E/AndroidRuntime(4002):     at android.app.ActivityThread.handleSendResult(ActivityThread.java:2574)
11-09 23:09:37.933: E/AndroidRuntime(4002):     at android.app.ActivityThread.access$2000(ActivityThread.java:117)
11-09 23:09:37.933: E/AndroidRuntime(4002):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:961) 
```

**谁能解释这里发生了什么？**

# r - 创建数值变量顺序

> ID：13614353
> 
> 赞同：0
> 
> 时间：2012-11-28T21:03:45.090
> 
> 标签：r, variables, numerical

我有一组包含 3 列的数据：索引列（没有名称）、颜色、种子颜色和发芽时间。

如何创建一个名为“order”的数值变量，其值为 1 到 22（数据集的数量）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:10:00.533

我不知道我是否正确，但最简单的方法是：

```
> order <- c(1:22)
> order
 [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 
```

不，如果你运行：

```
class(order) 
```

你会得到：

```
[1] "integer" 
```

但是您可以轻松获取对象顺序的每个元素（尤其是在循环中）

```
for(i in 1:length(order)){
print(order[i])
} 
```

# stylesheet - 如何更改默认的 javadoc 样式表？

> ID：13614355
> 
> 赞同：8
> 
> 时间：2012-11-28T21:03:44.463
> 
> 标签：stylesheet, javadoc

是否有命令行选项来更改由 javadoc 创建的样式表文件？我想使用我自己的css文件。默认的蓝色很无聊。我尝试了一个 -stylesheet 选项，但它不受支持。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-09-06T13:38:12.927

是的，这是可能的，而且实际上非常简单。例如，如果您查看 Mockito 的 javadoc：

*   [http://docs.mockito.googlecode.com/hg/org/mockito/Mockito.html](http://docs.mockito.googlecode.com/hg/org/mockito/Mockito.html)（你可以看到他们已经改变了使用[这个样式表](http://docs.mockito.googlecode.com/hg/stylesheet.css)的默认外观）

如果您使用的是 Maven，您可以通过在 maven-javadoc-plugin 中添加一些配置来做到这一点：

*   [http://maven.apache.org/plugins/maven-javadoc-plugin/examples/stylesheet-configuration.html](http://maven.apache.org/plugins/maven-javadoc-plugin/examples/stylesheet-configuration.html)。

如果您使用的是 ant，有一种方法可以将参数注入 javadoc 工具：

*   [http://ant.apache.org/manual/Tasks/javadoc.html](http://ant.apache.org/manual/Tasks/javadoc.html)

有关更多信息，stackoverflow 中有一些关于此的讨论主题：[JavaDoc Style Sheets](https://stackoverflow.com/questions/1499967/javadoc-style-sheets)

# c# - 一侧有纹理其他颜色的黄色 XNA C#

> ID：13614356
> 
> 赞同：0
> 
> 时间：2012-11-28T21:03:45.243
> 
> 标签：c#, xna-4.0

这次我有这个由三角形组成的立方体。我的代码为每个三角形分配纹理。如何更改代码以便只留下一堵墙作为纹理而另一堵墙涂成黄色？

```
public class Game1 : Microsoft.Xna.Framework.Game
    {
        private float angle = .9f;
        private float SecondAngle = -1f;

        //MyVertexFormat struct to go here

        struct MyVertexFormat
        {
            private Vector3 position;
            private Vector2 texCoord;
            public MyVertexFormat(Vector3 position, Vector2 texCoord)
            {
                this.position = position;
                this.texCoord = texCoord;
            }

            //Add VertexDeclaration here

        public readonly static VertexDeclaration VertexDeclaration = new
    VertexDeclaration(
    new VertexElement(0, VertexElementFormat.Vector3,
    VertexElementUsage.Position, 0),
    new VertexElement(sizeof(float) * 3,
    VertexElementFormat.Vector2,
    VertexElementUsage.TextureCoordinate, 0));
        }

        GraphicsDeviceManager graphics;
        GraphicsDevice device;

        Effect effect;
        Matrix viewMatrix;
        Matrix projectionMatrix;
        VertexBuffer vertexBuffer;
        Vector3 cameraPos;
        Texture2D wallTexture;

        public Game1()
        {
            graphics = new GraphicsDeviceManager(this);
            Content.RootDirectory = "Content";
        }

        protected override void Initialize()
        {
            graphics.PreferredBackBufferWidth = 500;
            graphics.PreferredBackBufferHeight = 500;
            graphics.IsFullScreen = false;
            graphics.ApplyChanges();
            Window.Title = "HLSL Start";

            base.Initialize();
        }

        protected override void LoadContent()
        {
            device = GraphicsDevice;
            wallTexture = Content.Load<Texture2D>("wall");
            effect = Content.Load<Effect>("Effect1"); 
            SetUpVertices(); 
            SetUpCamera();
        }

        private void SetUpVertices()
        {
            MyVertexFormat[] vertices = new MyVertexFormat[36];
            //Back
            vertices[0] = new MyVertexFormat(new Vector3(-1, -1, -1),
           new Vector2(1.0f, 0.0f));
            vertices[1] = new MyVertexFormat(new Vector3(1, 1, -1),
           new Vector2(0.0f, 1.0f));
            vertices[2] = new MyVertexFormat(new Vector3(-1, 1, -1),
           new Vector2(1.0f, 1.0f));

            vertices[3] = new MyVertexFormat(new Vector3(-1, -1, -1),
            new Vector2(1.0f, 0.0f));
            vertices[4] = new MyVertexFormat(new Vector3(1, -1, -1),
            new Vector2(0.0f, 0.0f));
            vertices[5] = new MyVertexFormat(new Vector3(1, 1, -1),
            new Vector2(0.0f, 1.0f));

            //Bottom
            vertices[6] = new MyVertexFormat(new Vector3(1, -1, 1),
            new Vector2(1.0f, 1.0f));
            vertices[7] = new MyVertexFormat(new Vector3(1, -1, -1),
            new Vector2(1.0f, 0.0f));
            vertices[8] = new MyVertexFormat(new Vector3(-1, -1, -1),
            new Vector2(0.0f, 0.0f));

            vertices[9] = new MyVertexFormat(new Vector3(-1, -1, -1),
            new Vector2(0.0f, 0.0f));
            vertices[10] = new MyVertexFormat(new Vector3(-1, -1, 1),
            new Vector2(0.0f, 1.0f));
            vertices[11] = new MyVertexFormat(new Vector3(1, -1, 1),
           new Vector2(1.0f, 1.0f));

            //Top
            vertices[12] = new MyVertexFormat(new Vector3(-1, 1, 1),
            new Vector2(0.0f, 1.0f));
            vertices[13] = new MyVertexFormat(new Vector3(-1, 1, -1),
            new Vector2(1.0f, 1.0f));
            vertices[14] = new MyVertexFormat(new Vector3(1, 1, 1),
            new Vector2(0.0f, 0.0f));

            vertices[15] = new MyVertexFormat(new Vector3(1, 1, 1),
            new Vector2(0.0f, 0.0f));
            vertices[16] = new MyVertexFormat(new Vector3(-1, 1, -1),
            new Vector2(1.0f, 1.0f));
            vertices[17] = new MyVertexFormat(new Vector3(1, 1, -1),
            new Vector2(1.0f, 0.0f));

            //Right side
            vertices[18] = new MyVertexFormat(new Vector3(1, 1, 1),
            new Vector2(1.0f, 1.0f));
            vertices[19] = new MyVertexFormat(new Vector3(1, -1, -1),
            new Vector2(0.0f, 0.0f));
            vertices[20] = new MyVertexFormat(new Vector3(1, -1, 1),
            new Vector2(1.0f, 0.0f));

            vertices[21] = new MyVertexFormat(new Vector3(1, -1, -1),
            new Vector2(0.0f, 0.0f));
            vertices[22] = new MyVertexFormat(new Vector3(1, 1, 1),
            new Vector2(1.0f, 1.0f));
            vertices[23] = new MyVertexFormat(new Vector3(1, 1, -1),
            new Vector2(0.0f, 1.0f));

            //Left side
            vertices[24] = new MyVertexFormat(new Vector3(-1, -1, 1),
            new Vector2(0.0f, 0.0f));
            vertices[25] = new MyVertexFormat(new Vector3(-1, -1, -1),
            new Vector2(1.0f, 0.0f));
            vertices[26] = new MyVertexFormat(new Vector3(-1, 1, 1),
            new Vector2(0.0f, 1.0f));

            vertices[29] = new MyVertexFormat(new Vector3(-1, 1, 1),
            new Vector2(0.0f, 1.0f));
            vertices[28] = new MyVertexFormat(new Vector3(-1, 1, -1),
            new Vector2(1.0f, 1.0f));
            vertices[27] = new MyVertexFormat(new Vector3(-1, -1, -1),
            new Vector2(1.0f, 0.0f));

            //Front
           vertices[30] = new MyVertexFormat(new Vector3(-1, 1, 1),
           new Vector2(1.0f, 1.0f));
           vertices[31] = new MyVertexFormat(new Vector3(1, 1, 1),
           new Vector2(0.0f, 1.0f));
           vertices[32] = new MyVertexFormat(new Vector3(-1, -1, 1),
           new Vector2(1.0f, 0.0f));

           vertices[33] = new MyVertexFormat(new Vector3(1, -1, 1),
           new Vector2(0.0f, 0.0f));
           vertices[34] = new MyVertexFormat(new Vector3(-1, -1, 1),
           new Vector2(1.0f, 0.0f));
           vertices[35] = new MyVertexFormat(new Vector3(1, 1, 1),
           new Vector2(0.0f, 1.0f));

            vertexBuffer = new VertexBuffer(device,
                MyVertexFormat.VertexDeclaration, vertices.Length,
            BufferUsage.WriteOnly);
            vertexBuffer.SetData(vertices);

        }

        private void SetUpCamera()
        {
            cameraPos = new Vector3(0, 5, 6);
            viewMatrix =  Matrix.CreateLookAt(cameraPos, new Vector3(0, 0, 1), new Vector3(0, 1, 0));
            projectionMatrix = Matrix.CreatePerspectiveFieldOfView(MathHelper.PiOver4, device.Viewport.AspectRatio, 1.0f, 200.0f);
        }

        protected override void UnloadContent()
        {
        }

        protected override void Update(GameTime gameTime)
        {
            if (GamePad.GetState(PlayerIndex.One).Buttons.Back == ButtonState.Pressed)
                this.Exit();

            viewMatrix = Matrix.CreateRotationY(MathHelper.ToRadians(angle)) *
                         Matrix.CreateRotationX(MathHelper.ToRadians(SecondAngle)) *
                         viewMatrix;

            base.Update(gameTime);
        }

        protected override void Draw(GameTime gameTime)
        {
            device.Clear(ClearOptions.Target | ClearOptions.DepthBuffer, Color.DarkSlateBlue, 1.0f, 0);

            effect.CurrentTechnique = effect.Techniques["Shaded"];
            effect.Parameters["View"].SetValue(viewMatrix);
            effect.Parameters["Projection"].SetValue(projectionMatrix);
            effect.Parameters["World"].SetValue(Matrix.Identity);
            effect.Parameters["myTexture"].SetValue(wallTexture);

            foreach (EffectPass pass in effect.CurrentTechnique.Passes)
            {
                pass.Apply();

                device.SetVertexBuffer(vertexBuffer);
                device.DrawPrimitives(PrimitiveType.TriangleList, 0, 12);
            }

            base.Draw(gameTime);
        }
    }
} 
```

**效果文件：**

```
float4x4 World;
float4x4 View;
float4x4 Projection;
Texture myTexture;

sampler TextureSampler = sampler_state {
texture = <myTexture>;
MinFilter = Anisotropic; // Minification Filter
MagFilter = Anisotropic; // Magnification Filter
MipFilter = Linear; // Mip-mapping
AddressU = Wrap; // Address Mode for U Coordinates
AddressV = Wrap; // Address Mode for V Coordinates
};

struct VertexShaderInput
{
float4 Position : POSITION0;
float2 UV: TEXCOORD0;
};

struct VertexShaderOutput
{
float4 Position : POSITION0;
float2 UV: TEXCOORD0;

};

VertexShaderOutput VertexShaderFunction(VertexShaderInput input)
{
VertexShaderOutput output;
float4 worldPosition = mul(input.Position, World);
float4 viewPosition = mul(worldPosition, View);
output.Position = mul(viewPosition, Projection);
output.UV = input.UV;

return output;
}

float4 PixelShaderFunction(VertexShaderOutput input) : COLOR0
{
float3 output = float3(1, 1, 1);
output *= tex2D(TextureSampler, input.UV);
return float4(output, 1);
}

technique Shaded
{
pass Pass1
{
VertexShader = compile vs_2_0 VertexShaderFunction();
PixelShader = compile ps_2_0 PixelShaderFunction();
}
} 
```

有人知道吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T22:49:41.577

将黄色添加到纹理的一小块区域，并设置要为黄色的三角形的 (U,V) 纹理坐标以映射该区域。

**[编辑]**

将颜色通道添加到您的顶点格式结构：

**班级**

```
 struct MyVertexFormat
    {
        private Vector3 position;
        private Vector2 texCoord;
        private Color color;
        public MyVertexFormat(Vector3 position, Vector2 texCoord, Color color)
        {
            this.position = position;
            this.texCoord = texCoord;
            this.color = color;
        }

        //Add VertexDeclaration here

    public readonly static VertexDeclaration VertexDeclaration = 
        new VertexDeclaration(
            new VertexElement(0, VertexElementFormat.Vector3,
                                 VertexElementUsage.Position, 0),
            new VertexElement(sizeof(float) * 3,
                VertexElementFormat.Vector2,
                VertexElementUsage.TextureCoordinate, 0)),
            new VertexElement(sizeof(float) * 7,
                VertexElementFormat.Color,
                VertexElementUsage.Color, 0));

            } 
```

**影响**

```
struct VertexShaderInput
{
    float4 Position : POSITION0;
    float2 UV: TEXCOORD0;
    float4 Color: Color0;
}; 
```

作为说明，我认为最好从 IVertexType 继承您的顶点结构。

# windows - 什么是 GetIpAddrTable 的有效 IPv4 地址

> ID：13614357
> 
> 赞同：0
> 
> 时间：2012-11-28T21:03:48.060
> 
> 标签：windows, winapi, networking

我想知道在 win32函数调用的*上下文中什么是“有效的 IPv4 地址”。*[文档](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365949%28v=vs.85%29.aspx)表明此函数在 Vista 及更高版本上不会返回无效的 IPv4 地址`GetIpAddrTable`。它没有解释它如何确定有效性。

> 在 Windows Server 2008 和 Windows Vista 上，GetIpAddrTable 函数返回的 IPv4 地址不受本地计算机上 TCP/IP 堆栈的媒体感知功能的影响。*GetIpAddrTable 函数只返回有效的 IPv4 地址。*

我正在研究一个问题，即对该函数的调用未返回正常工作的适配器的地址。适配器使用驱动程序的 DHCP 服务器来分配链路本地 IP 地址。在大多数系统上，这工作正常。在特定的客户系统上，它没有。

Ping 和流量测试工作正常，适配器显示在`GetAdaptersAddresses`. 我的另一个问题似乎表明唯一的区别应该是 IPv6 支持。有问题的适配器也接收到链接本地 IPv6 地址，但这不应该阻止它出现在`GetIpAddrTable`输出中吗？

## 交叉引用

*   [GetIpAddrTable 返回的适配器列表与 GetAdaptersAddresses 不同](https://stackoverflow.com/questions/13573007/getipaddrtable-returned-adapter-list-differs-from-getadaptersaddresses)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T20:25:57.623

简单的回答：它完全按照它所说的去做——它返回运行 IPv4 的连接接口。

我现在已经确认 GetAdaptersAddresses 在限制为 IPv4 接口时也会跳过我们的网络适配器。因此，驱动程序和 Windows 在识别为 IPv4 接口时似乎存在问题。

# xml - 聚合似乎与 VersionOne RESTful API 中的数据不匹配

> ID：13614360
> 
> 赞同：1
> 
> 时间：2012-11-28T21:03:52.910
> 
> 标签：xml, http, versionone

鉴于此查询（为便于阅读而添加间距）：

```
rest-1.v1\Data\Story?
    sel=
        Children.ID,
        Children.Actuals.Value,
        Children:Task.@Count,
        Children.Actuals.Value.@Sum.Value
    &where=Number='B-02833' 
```

我收到以下回复：

```
<Assets total="1" pageSize="2147483647" pageStart="0">
    <Asset href="/rest-1.v1/Data/Story/13195" id="Story:13195">
        <Relation name="Children.ID">
            <Asset href="/rest-1.v1/Data/Task/34505" idref="Task:34505"/>
            <Asset href="/rest-1.v1/Data/Task/34506" idref="Task:34506"/>
            <Asset href="/rest-1.v1/Data/Task/34507" idref="Task:34507"/>
        </Relation>
        <Attribute name="Children.Actuals.Value.@Sum">97.2</Attribute>
        <Attribute name="Children.Actuals.Value">
            <Value>1</Value>
            <Value>2</Value>
        </Attribute>
        <Attribute name="Children:Task.@Count">6</Attribute>
    </Asset>
</Assets> 
```

有人可以解释为什么返回的值总计为 3，但 .@Sum 显示为 97.2？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T19:41:18.490

最可能的原因是聚合函数喜欢`@Sum`并且`@Count`不会自动忽略已删除/死资产。

你可能想说这样的话：

```
rest-1.v1\Data\Story?
    sel=
        Children.ID,
        Children.Actuals.Value,
        Children:Task[AssetState!=Dead].@Count,
        Children[AssetState!=Dead].Actuals.Value.@Sum.Value
    &where=Number='B-02833' 
```

# jsf-2 - JSF：值更改后调用动作

> ID：13614366
> 
> 赞同：1
> 
> 时间：2012-11-28T21:04:10.517
> 
> 标签：jsf-2, icefaces-3

在我的代码库中，我们非常依赖事件重新排队，我怀疑这是由于 ICEfaces 或 MyFaces 中的实现细节而不是标准指定的行为。我们过去经常做的一件事是这样的事情：

```
<ice:inputText value="#{bb.frequency}" valueChangeListener="#{bb.valueChanged}"/> 
```

目标是安排在频率变化时`retune`被调用。`setFrequency`

然后我们在支持 bean 中有一些相当恶心的代码，这些代码会重新排队事件。它通常看起来像这样：

```
class BB {
  // this happens first, thanks to UPDATE_MODEL_VALUES
  public void setFrequency(Frequency f) {
    this.model.f = f;
  }

  public void valueChanged(ValueChangeEvent event) {
    if (event.getOldValue().equals(event.getNewValue())
      return; // nothing changed, so leave

    if (FacesContext.getCurrentInstance().getPhaseId() != INVOKE_APPLICATION) {
      OurMagicEventUtils.requeueEvent(event, INVOKE_APPLICATION);
    }
    else {
      // do the post-setter work here (the setter happened recently during 
      // UPDATE_MODEL_VALUES so we're up-to-date by here
      this.model.retune();
    }
  }
} 
```

这不是一个好的生活方式。我还没有找到一种可靠的方法来为后期阶段重新排队事件，这显然不是人们做的那种事情。我看到两个解决方案：

1.  将重调智能移至`BB#setFrequency`方法。

    在很多情况下，我无法摆脱这一点，因为我直接处理了一个较低级别的模型类，并且我不想干扰它对其他客户的行为。

2.  创建一个自定义组件并将逻辑移到那里的`setFoo`方法中。

    我不喜欢这一点，因为 Mojarra 和自定义组件在嵌入其他容器时存在很多问题。对于我需要做的事情来说，这似乎也有点矫枉过正——我实际上只需要`retune`在设置一些属性后调用。

3.  为所有内容创建支持 bean。将大多数方法直接委托给内部事物，但`setFoo`在那里捕获并执行重调。这与我们过去所做的非常相似，它意味着大量的样板、包装器和胶水代码，所以我不喜欢它。

在我的脑海中，我想象这样的事情：

```
<ice:inputText value="#{bb.frequency}" afterChange=#{bb.retune}"/> 
```

但这显然是行不通的，也不会附加一个，`<f:actionListener>`因为它需要一个类名，但与你当前正在做的任何事情都没有关联，此外它只能设置在`UICommand`s 上，而`UIInput`s 不是。

解决这个困境的优雅/正确方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T23:33:51.153

由于您已经在使用 JSF2，因此只需使用`<f:ajax>`.

```
<ice:inputText value="#{bb.frequency}">
    <f:ajax listener="#{bb.retune}"/>
</ice:inputText> 
```

和

```
public void retune(AjaxBehaviorEvent event) { // Note: the argument is optional.
    // ...
} 
```

`change`当 HTML DOM事件发生时，这将在调用操作阶段被调用。

# html - 三列布局 - 无浮动对齐

> ID：13614369
> 
> 赞同：1
> 
> 时间：2012-11-28T21:04:13.687
> 
> 标签：html, css, layout

据我了解，在现代 Web 开发中，并排水平对齐元素是通过使用浮动来实现的（例如，三列布局是通过将两个方向浮动到另一个方向来实现的）。然而，这确实带来了各种问题，目前我正在开发一个需要在标题和内容中分别列的网站，因此我需要浮动几乎所有内容并设置各种边距和宽度以防止它们到处乱跳.

随着 HTML5 和 CSS3 的兴起，我想知道是否有什么东西可以用更简单的解决方案代替浮动？由于 HTML5 和 CSS3 引入了更简单的方法来使某些事情发生（例如带有边框半径的圆角），因此人们会认为网站中的多个列几乎是不可避免的，这样可以减轻麻烦。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:11:59.810

是的，它是 flexbox，或[CSS 灵活框布局模块](http://www.w3.org/TR/css3-flexbox/)。

该规范似乎相当稳定，因为它已达到[候选推荐](http://www.w3.org/2005/10/Process-20051014/tr#q74)状态。我不知道这个最新版本的浏览器支持有多好。

这是[最近的一篇文章](http://www.vanseodesign.com/css/flexbox-revisited/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T21:07:43.607

您是否看过任何响应式框架，例如[Twitter Bootstrap](http://twitter.github.com/bootstrap/scaffolding.html)？使用响应式框架，根据屏幕大小设置列非常容易。

据我所知，除了使用浮动和动态宽度创建自己的列之外，没有内置的 CSS 属性。

# vb.net - 棒球票销售

> ID：13614371
> 
> 赞同：0
> 
> 时间：2012-11-28T21:04:24.977
> 
> 标签：vb.net, vb.net-2010

我有一个关于 Visual Basic 作业的问题。问题是要求用户设计一个 Windows 应用程序并编写将根据需求文档执行的代码。该问题的定价要求如下：对于季票，包厢座位为 2500 美元，下层座位为 1500 美元。对于单场比赛门票，包厢座位为 55 美元，下层为 35 美元，上层为 25 美元，仅站立室为 15 美元。当我的程序运行时，它似乎只使用了 $55 或 $2500 的值，并且就像其他值不是实际选择一样。其他一切都有效。任何帮助将不胜感激。这是我的代码：

```
 ' Program Name: Baseball Tickets Selection
' Author:       William Gambill
' Date:         November 26, 2012
' Purpose:      The Baseball Tickets Selection application determines the
'               type of baseball tickets available and calculates the cost
'               depending upon the seat chosen and number of seats.

Option Strict On

Public Class frmBaseballTicketSales

    ' Class Variables
    Private _strBoxSeats As String = "Box Seats                 $55"
    Private _strLowerDeck As String = "Lower Deck Seats     $35"
    Private _strUpperDeck As String = "Upper Deck Seats     $25"
    Private _strStdRmOnly As String = "Standing Room Only $15"
    Private _strSeasnBoxSeats As String = "Box Seats             $2500"
    Private _strSeasnLowerDeck As String = "Lower Deck Seats $1500"

    Private Sub cboTicketSelection_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs)         Handles cboTicketSelection.SelectedIndexChanged

    ' This event handler allows the user to enter the ticket choice
    ' and then calls subprocedures to place the seat choices in the list.

    Dim intTicketChoice As Integer

    intTicketChoice = Me.cboTicketSelection.SelectedIndex
    lstSeatType.Items.Clear()
    Select Case intTicketChoice
        Case 0
            SingleTickets()
        Case 1
            SeasonTickets()
    End Select
    ' Make items visible in the window
    lblNumberOfTickets.Visible = True
    txtNumberOfTickets.Visible = True
    lblSeatType.Visible = True
    lstSeatType.Visible = True
    btnCalculate.Visible = True
    btnClear.Visible = True
    lblTotalTicketCost.Visible = True
    lblFinalTotalCost.Visible = True
    ' Clear the labels
    lblFinalTotalCost.Text = ""
    ' Set focus on number in tickets text box
    txtNumberOfTickets.Clear()
    txtNumberOfTickets.Focus()

End Sub

Private Sub SingleTickets()
    ' This procedure fills in the possible single game tickets
    lstSeatType.Items.Add(_strBoxSeats)
    lstSeatType.Items.Add(_strLowerDeck)
    lstSeatType.Items.Add(_strUpperDeck)
    lstSeatType.Items.Add(_strStdRmOnly)
End Sub
Private Sub SeasonTickets()
    ' This procedure fills in the possible season tickets
    lstSeatType.Items.Add(_strSeasnBoxSeats)
    lstSeatType.Items.Add(_strSeasnLowerDeck)
End Sub

Private Sub btnCalculate_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnCalculate.Click
    ' This button event handler determines the cost of baseball tickets
    ' based on ticket type, seat type, and number of tickets bought.
    ' It displays the total cost of the tickets.

    Dim intNumberOfTickets As Integer
    Dim blnNumberOfTicketsIsValid As Boolean = False
    Dim blnTypeIsSelected As Boolean = False
    Dim intTypeChoice As Integer
    Dim intTicketChoice As Integer
    Dim decTotalCost As Decimal

    ' Call a function to ensure the number of tickets is valid
    blnNumberOfTicketsIsValid = ValidateNumberOfTickets()
    ' If number of tickets and the type selection are valid, calculate the cost
    If (blnNumberOfTicketsIsValid) Then
        intNumberOfTickets = Convert.ToInt32(txtNumberOfTickets.Text)
        intTicketChoice = Me.cboTicketSelection.SelectedIndex()
        Select Case intTicketChoice
            Case 0
                decTotalCost = SingleFindCost(intTypeChoice, _
                                             intNumberOfTickets)
            Case 1
                decTotalCost = SeasonFindCost(intTypeChoice, _
                                             intNumberOfTickets)
        End Select
        ' Display the cost of the tickets
        lblFinalTotalCost.Text = decTotalCost.ToString("C")
    End If
End Sub

Private Function ValidateNumberOfTickets() As Boolean
    ' This procedure validates the value entered for the number of tickets

    Dim intTicketNumber As Integer
    Dim blnValidityCheck As Boolean = False
    Dim strNumberOfTicketsErrorMessage As String = _
        "Please enter the number of tickets (1-99)"
    Dim strMessageBoxTitle As String = "Error"

    Try
        intTicketNumber = Convert.ToInt32(txtNumberOfTickets.Text)
        If intTicketNumber > 0 And intTicketNumber < 100 Then
            blnValidityCheck = True
        Else
            MsgBox(strNumberOfTicketsErrorMessage, , strMessageBoxTitle)
            txtNumberOfTickets.Focus()
            txtNumberOfTickets.Clear()
        End If
    Catch Exception As FormatException
        MsgBox(strNumberOfTicketsErrorMessage, , strMessageBoxTitle)
        txtNumberOfTickets.Focus()
        txtNumberOfTickets.Clear()
    Catch Exception As OverflowException
        MsgBox(strNumberOfTicketsErrorMessage, , strMessageBoxTitle)
        txtNumberOfTickets.Focus()
        txtNumberOfTickets.Clear()
    Catch Exception As SystemException
        MsgBox(strNumberOfTicketsErrorMessage, , strMessageBoxTitle)
        txtNumberOfTickets.Focus()
        txtNumberOfTickets.Clear()
    End Try

    Return blnValidityCheck

End Function

Private Function SingleFindCost(ByRef intTypeSelection As Integer, _
                               ByRef intNumberOfTickets As Integer) As Decimal
    ' This function calculates the cost of Single Game tickets

    Dim decTypeCost As Decimal
    Dim decFinalCost As Decimal
    Dim decSingleBoxCost As Decimal = 55D
    Dim decSingleLowerCost As Decimal = 35D
    Dim decSingleUpperCost As Decimal = 25D
    Dim decSingleStandCost As Decimal = 15D

    Select Case intTypeSelection
        Case 0
            decTypeCost = decSingleBoxCost
        Case 1
            decTypeCost = decSingleLowerCost
        Case 2
            decTypeCost = decSingleUpperCost
        Case 3
            decTypeCost = decSingleStandCost
    End Select
    decFinalCost = decTypeCost * intNumberOfTickets
    Return decFinalCost

End Function

Private Function SeasonFindCost(ByRef intTypeSelection As Integer, _
                               ByRef intNumberOfTickets As Integer) As Decimal
    ' This function calculates the cost of Season Tickets

    Dim decTypeCost As Decimal
    Dim decFinalCost As Decimal
    Dim decSeasonBoxCost As Decimal = 2500D
    Dim decSeasonLowerCost As Decimal = 1500D

    Select Case intTypeSelection
        Case 0
            decTypeCost = decSeasonBoxCost
        Case 1
            decTypeCost = decSeasonLowerCost
    End Select
    decFinalCost = decTypeCost * intNumberOfTickets
    Return decFinalCost

End Function

Private Sub btnClear_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnClear.Click
    ' This event handler clears the form and resets the form for
    ' reuse when the user clicks the Clear button.

    cboTicketSelection.Text = "Select Ticket Type"
    txtNumberOfTickets.Clear()
    lstSeatType.Items.Clear()
    lblFinalTotalCost.Text = ""
    lblNumberOfTickets.Visible = False
    txtNumberOfTickets.Visible = False
    lblSeatType.Visible = False
    lstSeatType.Visible = False
    btnCalculate.Visible = False
    btnClear.Visible = False
    lblTotalTicketCost.Visible = False
    lblFinalTotalCost.Visible = False
End Sub

Private Sub frmBaseballTicketSales_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
    ' Hold the splash screen for 5 seconds

    Threading.Thread.Sleep(5000)

End Sub

End Class 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T21:11:52.483

我会使用调试器检查 cboTicketSelection.SelectedIndex() 是否返回预期结果。它似乎每次都返回 0。

# c++ - 什么是运算符 &&？

> ID：13614373
> 
> 赞同：0
> 
> 时间：2012-11-28T21:04:25.867
> 
> 标签：c++, operator-overloading

它的目的是重载方法中的操作，但它的真正目的是什么？

```
class CModeType
{
public:
    CModeType(){m_nModeType=1;}
    ~CModeType(){}
    int m_nModeType;
    CModeType&              operator&&( const CModeType& rModeType );
};
CModeType& CModeType::operator &&( const CModeType& rModeType )
{
    this->m_nModeType += rModeType.m_nModeType;
    return *this;
}
int _tmain(int argc, _TCHAR* argv[])
{
    CModeType Mode;
    CModeType Mod2;
    Mode && Mode;
    cout << Mode.m_nModeType << endl; //output:2
    return 0;
} 
```

我也会问， `||`但我相信答案会帮助我理解它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-28T21:06:18.490

> 但它的真正目的是什么？

在这种情况下，其目的是降低代码的可读性和反直觉。

在实践中，很少有您想要重载**逻辑与运算符**的情况（这是问题标题的答案）。这不是他们的一部分。

通常，`operator &&`应该标记为，`const`因为您不期望它也不应该修改对象。在这种情况下，它不是，它确实如此。从逻辑上讲，你真的会期望在你这样做之后

```
a && b 
```

`a`被修改？**不！**这是对语言的严重滥用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-28T21:06:06.460

对于内置类型，`&&`运算符是“逻辑与”，因此当且仅当在布尔上下文中求值时`x && y`两者`x`和都为真时，该运算符为真。`y`

对于内置类型，`&&`运算符是*short-circuited*，因此如果第一个参数已经为假，则永远不会评估第二个参数，因此您可以这样说`if (p && *p == 10)`而不会冒空指针取消引用的风险。对于`operator&&`用户定义类型的重载，这是不正确的，它只是一个普通函数（因此参数以不确定的顺序计算）。谨防！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T21:07:38.117

这意味着逻辑运算`and`符。在代码`if (a && b) { ... }`中，如果两者都为真，`...`则将执行。`a``b`

在您的代码中，您正在重载运算符，因此您在`CModeType& operator&&( const CModeType& rModeType )`实现中定义了一个全新的用途。它将`this`和`rModeType`（参数）的 m_nModeType 相加，然后返回指向`this`. 对我来说似乎很愚蠢和不合逻辑，我建议不要这样做。

# android - 将应用程序图标存储在可绘制文件夹中

> ID：13614383
> 
> 赞同：1
> 
> 时间：2012-11-28T21:05:29.883
> 
> 标签：android

有没有办法在可绘制文件夹中绘制存储应用程序图标？我想在列表视图中的应用程序名称旁边显示应用程序图标。

我知道有一种获取图标的方法，但我不太确定如何存储该图标，以便以后可以使用它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T21:07:32.873

应用程序图标应该已经存储在可绘制文件夹中（实际上最佳做法是在每个密度可绘制文件夹中存储一个）

您应该能够在运行时引用它，就像使用任何其他可绘制对象`R.drawable.ic_launcher`或您给文件提供的任何名称（如果不是）一样`ic_launcher`

所以把它放到 ImageView 你可以做类似的事情

```
iv.setImageResource(R.drawable.ic_launcher); 
```

# maps - 这里/诺基亚地图标记并不总是显示

> ID：13614385
> 
> 赞同：1
> 
> 时间：2012-11-28T21:05:45.607
> 
> 标签：maps, markers, here-api

我有一些地图标记遍布各处，我想自动缩放以显示它们。

我拥有的代码应该可以正常工作，但有时（似乎取决于地图标记的位置）它并不总是正确缩放以显示标记。

这是一个小提琴（带有示例标记来显示问题）：http: [//jsfiddle.net/amnesia7/9YUVe/embedded/result/](http://jsfiddle.net/amnesia7/9YUVe/embedded/result/)使用以下标记位置：

```
// Add markers to the map for each location
addMarker(1, "Hello 1", [-18,178.333]);
addMarker(2, "Hello 2", [-18.5,180]);
addMarker(3, "Hello 3", [-18.5,-178.333]); 
```

自动缩放完全出错了，似乎在某处放大了大海。

对我来说似乎是一个错误，因为它似乎取决于地图标记的位置是否正确缩放。

* * *

**更新**

我已经创建了一个更简单的版本，使用 HERE 开发人员演示“缩放到一组标记”

[http://jsfiddle.net/amnesia7/uhZVz/](http://jsfiddle.net/amnesia7/uhZVz/)

您需要缩小地图以查看默认情况下应该在视图中的标记。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T14:32:29.893

它对我来说也像是一个错误，并且仅在标记聚集在经度 180 线附近时才会发生。**在这种情况下， zoomTo()**计算似乎不正确，只考虑最后一个标记，因为它位于国际日期变更线的“错误”一侧。

无论如何，视口上的**getWidth()**似乎确实有效，因此您*可以*修改自己的**zoomTo()**函数，如下面的 kludge 所示。

还要注意在加载库时使用**kml=auto&map=js-p2d-dom** - 这使用 DOM 实现而不是画布实现，这可以正确显示第 180 条经线两侧的标记。

```
<!DOCTYPE HTML SYSTEM>
<html>
    <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=7; IE=EmulateIE9" />

        <style type="text/css">

            html {
                overflow:hidden;
            }

            body {
                margin: 0;
                padding: 0;
                overflow: hidden;
                width: 100%;
                height: 100%;
                position: absolute;
            }

            #mapContainer {
                width:100%;
                height: 100%;
                left: 0;
                top: 0;
                position: absolute;
            }

 </style>
   <script type="text/javascript" charset="UTF-8" src="http://api.maps.nokia.com/2.2.3/jsl.js?kml=auto&map=js-p2d-dom"></script>
    </head>
    <body>
        <div id="mapContainer"></div>

    <script type="text/javascript">
 /*    Set authentication token and appid
*    WARNING: this is a demo-only key
*    please register on http://api.developer.nokia.com/
*    and obtain your own developer's API key
*/
nokia.Settings.set("appId", "APP_ID");
nokia.Settings.set("authenticationToken", "TOKEN");

// Get the DOM node to which we will append the map
var mapContainer = document.getElementById("mapContainer");
// Create a map inside the map container DOM node
var map = new nokia.maps.map.Display(mapContainer, {
    // initial center and zoom level of the map
    center: [52.51, 13.4],
    zoomLevel: 13,
    components: [
        // We add the behavior component to allow panning / zooming of the map
        new nokia.maps.map.component.Behavior()
    ]
});

// We create an instance of Container to store markers per city
var myContainer = new nokia.maps.map.Container();

/* We add all of the city containers to map's object collection so that
 * when we add markers to them they will be rendered onto the map
 */
map.objects.add(myContainer);

// We create several of marker for a variety of famous landmarks
var firstMarker = new nokia.maps.map.StandardMarker(
        [-18, 178.333],
        { text: 1 }
    ),
    secondMarker = new nokia.maps.map.StandardMarker(
        [-18.5, 180],
        { text: 2 }
    ),
    thirdMarker = new nokia.maps.map.StandardMarker(
        [-18.5, -178.333],
        { text: 3 }
    );

// Add the newly created landmakers per city to its container
myContainer.objects.addAll([firstMarker, secondMarker, thirdMarker]);

/* Now we calculate the bounding boxes for every container.
 * A bounding box represents a rectangular area in the geographic coordinate system.
 */
var myBoundingBox = myContainer.getBoundingBox();

zoom = 1;
map.setCenter(myBoundingBox.getCenter());
map.setZoomLevel(zoom);

while (map.getViewBounds().getWidth() >  myBoundingBox.getWidth())   {
    zoom++;
    map.setZoomLevel(zoom); 
}
zoom--
map.setZoomLevel(zoom--);

</script>

    </body>
</html> 
```

# javascript - jQuery BBQ：添加淡入淡出、滑动等过渡

> ID：13614391
> 
> 赞同：0
> 
> 时间：2012-11-28T21:06:11.923
> 
> 标签：javascript, jquery, jquery-bbq

第一次在这里问问题，但我狂热地使用stackoverflow。

我创建了一个使用 jQuery BBQ 以 AJAX 方式加载页面的网站，并且仍然能够使用后退按钮等来跟踪历史记录......

开箱即用的 BBQ 只使用`.hide()`和`.show()`函数来加载内容。例如，我想知道如何修改它以实现无缝过渡（例如褪色）的最佳方法。

这是代码：

```
$(function(){

  // Keep a mapping of url-to-container for caching purposes.
  var cache = {
    // If url is '' (no fragment), display this div's content.
    '': $('#home')
  };

  // Bind an event to window.onhashchange that, when the history state changes,
  // gets the url from the hash and displays either our cached content or fetches
  // new content to be displayed.
  $(window).bind( 'hashchange', function(e) {

    // Get the hash (fragment) as a string, with any leading # removed. Note that
    // in jQuery 1.4, you should use e.fragment instead of $.param.fragment().
    var url = $.param.fragment();

    // Remove .current class from any previously "current" link(s).
    $( 'a.current' ).removeClass( 'current' );

    // Hide any visible ajax content.
    $( '#main' ).children( ':visible' ).hide(1000);

    // Add .current class to "current" nav link(s), only if url isn't empty.
    url && $( 'a[href="#' + url + '"]' ).addClass( 'current' );

    if ( cache[ url ] ) {
      // Since the element is already in the cache, it doesn't need to be
      // created, so instead of creating it again, let's just show it!
      cache[ url ].show(1000);

    } else {
      // Show "loading" content while AJAX content loads.
      $( '.bbq-loading' ).show();

      // Create container for this url's content and store a reference to it in
      // the cache.
     //$('.page:visible').fadeout(1000);
       url  = $( '<div class="page"/>' )

        // Append the content container to the parent container.
        .appendTo( '#main' )

        // Load external content via AJAX. Note that in order to keep this
        // example streamlined, only the content in .infobox is shown. You'll
        // want to change this based on your needs.
        .load( url, function(){
          // Content loaded, hide "loading" content.
          $( '.bbq-loading' ).hide();

        });
    }
  })

  // Since the event is only triggered when the hash changes, we need to trigger
  // the event now, to handle the hash the page may have loaded with.
  $(window).trigger( 'hashchange' );

}); 
```

如您所见，我有一个`.hide(1000)`and `.show(1000)`，但它似乎会闪烁页面上的所有内容，甚至是不在`<div id="main">`...

任何帮助将非常感激。很抱歉，我不能包含该示例，因为它在我和客户之间是机密的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T22:27:05.700

您应该使用组合 jquery addClass +css 但您也可以通过淡入淡出或动画在纯 jQuery 中执行此操作，如下所示：

```
//fadeOut the element
.fadeOut(1000);
.animate({opacity: 0}, 1000);

//fadeIn the element
.fadeIn(1000);
.animate({opacity: 1}, 1000); 
```

# java - 如何解析 HTML 并获取 CSS 样式

> ID：13614392
> 
> 赞同：3
> 
> 时间：2012-11-28T21:06:11.127
> 
> 标签：java, parsing, html-parsing, css-parsing

我需要解析 HTML 并找到相应的 CSS 样式。我可以单独解析 HTML 和 CSS，但我不能将它们结合起来。例如，我有一个这样的 XHTML 页面：

```
<html>
<head>
<title></title>
</head>
<body>
<div class="abc">Hello World</div>
</body>
</html> 
```

我必须搜索“hello world”并找到它的类名，然后我需要从外部 CSS 文件中找到它的样式。使用 Java、JavaScript 和 PHP 的答案都可以。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T22:06:44.867

在 java 中使用[jsoup](http://jsoup.org/)库，它是一个 HTML 解析器。例如，您可以[在此处](http://jsoup.org/cookbook/)
查看例如，您可以执行以下操作：

```
String html="<<your html content>>";
Document doc = Jsoup.parse(html);
Element ele=doc.getElementsContainingOwnText("Hello World").first.clone(); //get tag containing Hello world
HashSet<String>class=ele.classNames(); //gives you the classnames of element containing Hello world 
```

您可以进一步探索图书馆以满足您的需求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T21:56:39.443

类似的问题[jQuery 可以获取与元素关联的所有 CSS 样式吗？](https://stackoverflow.com/questions/754607/can-jquery-get-all-css-styles-associated-with-an-element). 也许 css 优化器可以做你想做的事，看看[used-css.com](http://unused-css.com)它的在线工具，但也列出了其他工具。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T22:02:01.687

As i understood you have chance to parse style sheet from external file and this makes your task easy to solve. First try to parse html file with [jsoup](http://www.jsoup.org) which supports jquery like selector syntax that helps you parse complicated html files easier. then check this [previous](https://stackoverflow.com/questions/1513587/looking-for-a-css-parser-in-java) solution to parse css file. Im not going to full solution as i state with these libraries all task done internally and the only thing you should do is writing glue code to combine these two.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-28T21:41:20.490

使用 Java java.util.regex

```
String s = "<body>...<div class=\"abc\">Hello World</div></body>";
    Pattern p = Pattern.compile("<div.+?class\\s*?=\\s*['\"]?([^ '\"]+).*?>Hello World</div>", Pattern.CASE_INSENSITIVE);    Matcher m = p.matcher(s);
if (m.find()) {
    System.out.println(m.group(1));
} 
```

打印 abc

# java - 如何将非方形图像调整为方形缩略图（通过添加空格）？

> ID：13614393
> 
> 赞同：3
> 
> 时间：2012-11-28T21:06:14.653
> 
> 标签：java, image, resize

我想使用 Java 创建图像的方形缩略图。我已经设法通过几种方式调整图像大小。但是我想创建一个**真正的**方形图像，也可以从一个非方形图像。

示例：源大小为 200x400（宽度/高度），目标大小为 100x100 然后算法需要将图像大小调整为 50x100，并在左侧和右侧分别添加 25x100 像素的空白。

谁能帮我这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:14:30.787

只需创建一个 100x100 背景；将缩放的图像添加到它。使用 Math.max(width, height) 确定比例因子。然后，在背景上绘制缩放图像，使用计算（偏移 x，偏移 y）将其放置在正确的位置。

# android - 使用多个视图时出现 Android 错误

> ID：13614397
> 
> 赞同：0
> 
> 时间：2012-11-28T21:06:26.667
> 
> 标签：android, view

我过去创建了一个应用程序，当单击按钮时，它会从第一个屏幕切换到下一个屏幕。我正在尝试修改一个新的应用程序来做类似的事情，但是有两个屏幕可供选择。主屏幕上有两个单选按钮，我希望根据用户的选择显示相应的视图。但是，当我尝试执行此操作时，程序上不会出现错误，但是当我尝试运行它时会弹出错误。控制台和日志都没有报错。它仅在引入我的新 xml 文件后发生。我的最终目标是创建一个像 MadLibs 这样的应用程序。

活动主.xml：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent" >

<TextView
    android:id="@+id/categoryTextView"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true"
    android:layout_marginLeft="30dp"
    android:layout_marginTop="22dp"
    android:text="@string/cat" />

<RadioGroup
    android:id="@+id/radioGroup1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignLeft="@+id/categoryTextView"
    android:layout_below="@+id/categoryTextView"
    android:layout_marginTop="14dp" >

    <RadioButton
        android:id="@+id/bkRadio"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:checked="true"
        android:text="@string/bekind" />

    <RadioButton
        android:id="@+id/oldmcRadio"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/oldmc" />

</RadioGroup>

<Button
    android:id="@+id/chooseButton"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignLeft="@+id/radioGroup1"
    android:layout_below="@+id/radioGroup1"
    android:layout_marginTop="18dp"
    android:text="@string/choose"
    android:onClick="buttonclick" />

</RelativeLayout> 
```

bekindwords.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical" >

<TextView
    android:id="@+id/nounKindTextView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="@string/noun" />

<EditText
    android:id="@+id/nounKindEditText1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:inputType="text"
    android:ems="10" />

<TextView
    android:id="@+id/nounpKindTextView"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="@string/nounp" />

<EditText
    android:id="@+id/nounpKindEditText"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:inputType="text"
    android:ems="10" />

<TextView
    android:id="@+id/nounKindTextView2"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="@string/noun" />

<EditText
    android:id="@+id/nounKindEditText2"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:inputType="text"
    android:ems="10" />

   <TextView
    android:id="@+id/placeKindTextView2"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="@string/place" />

<EditText
    android:id="@+id/placeKindEditText2"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:inputType="text"
    android:ems="10" />

<TextView
    android:id="@+id/adjKindTextView"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="@string/adj" />

<EditText
    android:id="@+id/@+id/adjKindEditText"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:inputType="text"
    android:ems="10" />

<TextView
    android:id="@+id/nounKindTextView3"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="@string/noun" />

<EditText
    android:id="@+id/nounKindEditText3"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:inputType="text"
    android:ems="10" />

<Button
    android:id="@+id/enterButton"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:onClick="buttonclick2"
    android:text="@string/ent" />

</LinearLayout> 
```

主.java：

```
package com.deitel.adlibs;

import com.deitel.adlibs.R;

import android.os.Bundle;
import android.app.Activity;
import android.view.Menu;
import android.view.View;
import android.widget.Button;
import android.widget.RadioButton;

public class Main extends Activity {
//Global variable
        double bk;
        private Button choose;  // creates a button 

            @Override
        public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);

            choose = (Button) findViewById(R.id.chooseButton);

            //Start with first screen
            setContentView(R.layout.activity_main);
        }

      //buttonclick for form 1
        public void buttonclick(View view){

            RadioButton bk = (RadioButton) findViewById(R.id.bkRadio);

             if(bk.isChecked())
            {
                //switch views to screen 2
                   setContentView(R.layout.bekindwords);  
            }

            }
             } 
```

# r - 如何将 attr<- 与 lapply 一起使用？

> ID：13614399
> 
> 赞同：3
> 
> 时间：2012-11-28T21:06:36.697
> 
> 标签：r, attributes, lapply

或者更笼统地说：如何向列表的元素添加多个属性？

我一直试图为列表的元素设置属性，所有这些元素都是`data.frames`. 最后，我想为每个内部添加`names(myList)`一个可变属性。`data.frame`但我什至无法获得所有列表元素的静态属性。

```
lapply(myList,attr,which="myname") <- "myStaticName" 
```

这不起作用，因为`lapply`不适用于`lapply<-`. 如果我至少知道如何做到这一点，也许我可以弄清楚如何使用列表名称等不同的属性来做到这一点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-28T21:21:26.433

~~我不推荐它，但~~你可以这样做：`lapply(myList, 'attr<-', which='myname', value='myStaticName')`. 老式的`for`循环可能是执行此任务的最清晰方法——或者在创建对象时在上游执行此分配。

```
for (i in seq_along(myList)) attr(myList[[i]], 'myname') <- 'myStaticName' 
```

编辑：

正如@mnel 在评论中指出的那样，`setattr`在`data.table`包中也是一个有效的选择，因为它通过引用分配。

编辑：@mnel - 不要将 setattr 与`lapply`. `for`这是循环更快的一种情况。

```
library(microbenchmark)
library(data.table)
myList <- as.list(1:10000)

`lapply.attr<-` <- 
    function() 
    lapply(myList, 'attr<-', which='myname', value='myStaticName')

`for.attr<-` <- 
    function() 
    for (i in seq_along(myList)) 
        attr(myList[[i]], 'myname') <- 'myStaticName'

lapply.setattr <- 
  function() 
  lapply(myList, setattr, name='myname', value='myStaticName')

for.setattr <- function() 
  for (i in seq_along(myList)) 
  setattr(myList[[i]], name = 'myname', value = 'myStaticName')

result <- microbenchmark(`lapply.attr<-`(), `for.attr<-`(), lapply.setattr(), for.setattr())
plot(result) 
```

![在此处输入图像描述](../Images/6615e17147679e85aa7c2fda7b5eb390.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T21:29:30.087

根据[蒂埃里的这个回答，](http://grokbase.com/t/r/r-help/114vz4ct7k/r-assignments-inside-lapply)我自己找到了一个解决方案。实际上，我已经尝试了几次，但没有返回关键的整个列表。

```
myList <- lapply(names(myList),function(X){
attr(myList[[X]],"myname") <- X
myList[[X]]
}) 
```

我的错误不是返回整个列表，而是只返回函数的第二行，即属性。因此，我无法替换初始列表。

@Matthew Plourde：奇怪的是：您的基准测试在我的机器上看起来有些不同：RStudio、OS X、2.5 Ghz Intel Core i7、16GB RAM。 ![在此处输入图像描述](../Images/cca816ed434860fd1424442296895281.png)

# php - 购物车 PHP 显示错误

> ID：13614400
> 
> 赞同：0
> 
> 时间：2012-11-28T21:06:38.567
> 
> 标签：php, cart, shopping

我正在为大学项目制作购物车并跟随导师示例代码，但对其进行调整以适合我自己的设计。

我的网站产品被命名为

```
cutecupcak.es/product.php?id=vanilla_cupcakes 
```

而不是

```
cutecupcak.es/product.php?id=2 
```

购物车页面显示购物车中产品的代码是

```
if(is_numeric($id)) {
    $cartresult = mysql_query($sql); 
```

但是我的产品 url 不是数字的，所以购物车没有显示结果，正如你在这里看到的那样——http: [//cutecupcak.es/shoppingcart.php——](http://cutecupcak.es/shoppingcart.php)如果你测试一下。

如果你有`products.php?id=2`等，它会起作用。

我需要改变什么 -`is_numeric`使其适用于我的 url 格式？

完整代码

```
<?php

session_start(); // start new session or call exisiting session
include('include/dbconnect.php'); // include the database connections

function renderCartForm()
    {
    $cart = $_SESSION['cart'];
    if ($cart) {
        $items = explode(',',$cart);
        $contents = array();
        foreach ($items as $item) {
            $contents[$item] = (isset($contents[$item])) ? $contents[$item] + 1 : 1;
        }
        $output[] = '<form action="shoppingcart.php?action=update" method="post" id="cart">';
        $output[] = '<div class="form">';
        $output[] = '<table border="2" class="formcontainer">';
        $output[] = '<tr class="formlabels">';
        $output[] = '<td width="400">Cake Name</td>';
        $output[] = '<td width="75">Price</td>';
        $output[] = '<td width="75">Quantity</td>';
        $output[] = '<td width="100">Total</td>';
        $output[] = '<td width="100">Remove?</td>';
        $output[] = '</tr>';
        foreach ($contents as $id=>$qty) {
            $sql = 'SELECT * FROM `CAKE` WHERE `cake_url` = '.$id;

            if(is_numeric($id)) {
                $cartresult=mysql_query($sql);

            while($cartrow = mysql_fetch_array($cartresult)) {
                $output[] = '<tr>';
                $output[] = '<td>'.$cartrow['cake_name'].'</td>';
                $output[] = '<td>'.$cartrow['cake_price'].'</td>';
                $output[] = '<td><input type="text" name="qty'.$id.'" value="'.$qty.'" size="2" maxlength="2" /></td>';
                $output[] = '<td>&pound;'.($cartrow['cake_price'] * $qty).'</td>';
                $output[] = '<td><a href="shoppingcart.php?action=delete&id='.$id.'">Remove</a></td>';
                $total += $cartrow['cake_price'] * $qty;
                $output[] = '</tr>';
            }
            }
        }
        $output[] = '</table>';
        $output[] = '</div>';
        $output[] = '<p>Grand total: <strong>&pound;'.$total.'</strong></p>';
        $output[] = '<div class="\"formlabels\"><button type="submit">Update Cart</button></div>';
        $output[] = '</form>';
    } else {
        $output[] = '<p>Your shopping cart is empty.</p>';
    }
    echo join('
                ',$output);
    } 
```

?>

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T21:10:53.167

PHP 的[is_string](http://us3.php.net/manual/en/function.is-string.php)函数正是您要寻找的。如果您的产品名称都不包含数字，您也可以简单地执行`!is_numeric`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T21:21:40.280

If your `$id` is a string rather than a number, then you don't need to check whether it's numeric or not. In fact, you only need to check whether it's not empty, such as

```
if(strlen(trim($id)) {
    $cartresult = mysql_query($sql); 
```

**However!** You will almost certainly need to modify how your `$sql` is built. You're not showing it in your code, but it has to be done somewhere before the `mysql_query` line. You'll probably end up with something like

```
$dbh = new PDO('mysql:host=hostname;port=portnum;dbname=databasename', 'username', 'password');

if(strlen(trim($id)) {
    $sql = "SELECT * FROM product WHERE id=?";
    $sth = $dbh->prepare($sql);
    $sth->bindParam(1, $id, PDO::PARAM_ISTR);
    $sth->execute();

    while($row = $sth->fetch()) {
        ...
    }
} 
```

Note that this example is using PDO rather than `mysql_` set of function, which is deprecated anyway. You should probably start using PDO, as it's a lot more versatile and secure (if used properly).

# c# - C#、WCF 和 DateTime.MinValue() 与空日期

> ID：13614406
> 
> 赞同：5
> 
> 时间：2012-11-28T21:07:09.440
> 
> 标签：c#, wcf, datetime

我已经四处搜索，但尚未为我的问题找到令人满意的答案：

概述：我正在开发一个小型应用程序，该应用程序使用 WCF 将多个 DateTime 字段用于单个表。我们正在尝试消除所有表中的空字段。到目前为止，每当我们转换从表中选择的日期时间字段时，我们首先验证它是否为空，然后再显示或以其他方式“使用”它。如果该值为 NULL，我们替换`DateTime.MinValue`该值。由于我们现在要删除所有字段的可空方面，我们需要插入一个表示空的公共值；由于`DateTime.MinValue()`在代码中的任何地方都被替换，因此将其作为空替换放入字段中似乎是一个可行的值。

问题：插入 a`DateTime.MinValue()`会导致一般的“执行此请求的问题”错误。

解决方案？：正如其他地方记录的那样，`DateTime.MinValue()`有一个未指定的 DateTimeKind 所以......我们添加了 ToUniversalTime 调用，如下所示：

```
DateTime nullDate = DateTime.MinValue.ToUniversalTime(); // 1/1/0001 6:00:00 AM 
```

这不起作用，可能是因为 WCF 上的日期转换中的一些“可接受范围”设置？

注释中指出的是“1/1/0001 6:00 am”的结果值。奇怪的早上 6:00 或“1”年除外，这似乎很好。（考虑到过去的默认年份，如 1970 年 12:00 AM 仍然是相当标准的，但我离题了......）

是的，我知道 DateTime 不是 C#，它是 .NET。我也知道 WCF 在其转换约束内允许某种形式的“最小”和“最大”时间。我不知道如何设置这些（我也不知道如何设置 VerboseMessages 位；我对 WCF 还很陌生。）

手动创建一个可以很好地转换为表格的新字段值的建议是可行的，并且有效：

```
DateTime nullDate = new DateTime(1970, 1, 1, 0, 0, 0, DateTimeKind.Utc); 
```

（顺便说一句，如果我们使用 1 年而不是 1970 年（例如）插入也会失败。）

即使我们使用上面的 nullDate 作为一个可行的替代品......问题是在代码中的任何地方我们仍然在评估`DateTime.MinValue()`代表一个空日期，而这两个日期并不完全相同。

我能想到的唯一可行的解​​决方案是覆盖或以其他方式从 DateTime 创建一个扩展类，以创建一个通用的 NullDate 并相应地修改所有代码。

有没有人看到一个好的选择？有谁知道将 插入`System.DateTime.MinValue()`WCF 表的解决方案，例如更改好/坏日期的可接受边界？

我觉得我将不得不硬着头皮改变所有对 MinValue 的引用......我试图避免这种情况，因为它在评估“默认”值时不遵循任何标准的逻辑思想。

建议任何人？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-28T21:30:09.503

这取决于您用于存储数据的数据库。例如，SQL Server 的最小日期为 1753 年 1 月 1 日，请参阅[MSDN](http://msdn.microsoft.com/en-us/library/aa258277%28v=SQL.80%29.aspx)。我不确定甲骨文。

如果你必须使用一个神奇的日期，你可以使用它，或者其他特定的东西（我使用 1815 年 12 月 10 日来纪念第一位程序员 Ada Lovelace 女士）。一般来说，如果您遇到没有已知值的情况，则数据存储应将该值表示为“null”。现在在实践中，这并不总是可行的。您可以做的是将可为空的列重构为子表，并且仅在您实际上有要记录的内容时才包含子记录。

# sql - 唯一性由两列的组合确定时的 UPDATE OR INSERT 函数

> ID：13614407
> 
> 赞同：1
> 
> 时间：2012-11-28T21:07:11.633
> 
> 标签：sql, postgresql, stored-procedures

扩展通常的插入或更新难题

我有一个提供正常 UPDATE 或 INSERT 的函数，它看起来像这样：

```
CREATE OR REPLACE FUNCTION updateslave ( varchar(7), smallint ) RETURNS void AS
$$
 BEGIN
   LOOP
     UPDATE consist SET
       master = $1,
       time = now() WHERE slave = $2;
     IF found THEN
       RETURN;
     END IF;
     BEGIN
       INSERT INTO consist(master, slave, time) VALUES ( $1, $2, now() );
       RETURN;
     EXCEPTION WHEN unique_violation THEN
       -- do nothing, then loop and retry
     END;
   END LOOP;
 END;
##
LANGUAGE plpgsql; 
```

现在，问题是我正在尝试重写它以在不同的表中进行类似的操作。但是，不同的是，在另一个表中，没有单一的唯一列，而是两列的组合只存在于一行中。是否可以根据两列的组合来声明 unique_violation ？

为了使示例简单，我们假设该表看起来与我使用上述函数的表完全相同，但主从是两个共同产生唯一性的列：

```
 Column |            Type             |                  Modifiers                   | Storage  | Description
--------+-----------------------------+----------------------------------------------+----------+-------------
 master | character varying(7)        | not null default 'unused'::character varying | extended |
 slave  | smallint                    | not null                                     | plain    |
 time   | timestamp without time zone | default now()                                | plain    | 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T21:12:47.137

最好的方法是在表上定义一个唯一的约束，这样无论更新是如何发生的，即，如果你的 proc 被使用与否，一切都很好。

最简单的方法是在两列上创建唯一索引：

```
create unique index any_mame on mytable(col1, col2); 
```

您还可以更改表以添加唯一约束，但没有太大区别。

# ios - 如何调整 OpenEars 错误识别

> ID：13614410
> 
> 赞同：2
> 
> 时间：2012-11-28T21:07:25.887
> 
> 标签：ios, openears

我为我的应用程序使用了 OpenEars。只需识别字母表中的“a”到“z”。但它在识别字母而不是单词方面识别不佳。

那么，我如何使用我的声音模型来提高 OpenEars 的识别度。

以及如何使用 OpenEars 来识别一些特殊的声音。

例如。我给 OpenEars 一个狗的声音，我想让它给我回“狗”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T22:07:44.023

所以这是一个由两部分组成的问题，可能对社区分裂更好。据我所知，OpenEars 最好使用字典中的单词。如果你想让它识别字母，我会尝试使用每个字母的拼音而不是只使用字母。因此，不要使用“f”，而是使用“ef”。

至于问题的第二部分，您可能能够识别出特定类型的狗会“发怒”，但较小的狗会更容易“咂”！也必须添加到初始字典中。

我会得到演示应用程序，并且真的只是尝试这些词。

# php - 在 htaccess 中显示结果

> ID：13614412
> 
> 赞同：1
> 
> 时间：2012-11-28T21:07:30.440
> 
> 标签：php, apache, .htaccess

有没有办法实时显示 htaccess 指令的结果？例如：

```
RewriteCond %{DOCUMENT_ROOT} 
```

是否有任何指令可以放在 htaccess 中以显示`%{DOCUMENT_ROOT}`值？

我知道这可以通过正确地址中的 PHP 脚本来完成，但我想知道它是否也可以在 htaccess 中实现？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T22:07:50.447

尝试这个

```
RewriteEngine On
RewriteBase /
RewriteRule (.*) /$1?docroot=%{DOCUMENT_ROOT} [L,QSA] 
```

没有可能对此进行测试，但应该可以

来自[Apache 2.2 文档](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html)

> 除了纯文本之外，Substition 字符串还可以包括
> 
> *   对 RewriteRule 模式的反向引用 ($N)
> *   对最后匹配的 RewriteCond 模式的反向引用 (%N)
> *   服务器变量，如规则条件测试字符串 (%{VARNAME})
> *   映射函数调用 (${mapname:key|default})

# netezza - 连接时数据包长度无效

> ID：13614415
> 
> 赞同：0
> 
> 时间：2012-11-28T21:07:32.373
> 
> 标签：netezza

我公司的另一个团队委托了一台新服务器并在其上安装了 Netezza，以及一堆内部程序。他们所有连接到 Netezza 的程序现在都出现此错误：

```
A connection error has occurred: Invalid packet length 
```

尝试使用 DbVisualizer 或 RazorSQL 等 GUI 连接到数据库会产生相同的错误。连接到“旧”服务器仍然可以正常工作。两个盒子之间的区别之一是 Java 版本，旧版本为 1.5，新版本为 1.7……不确定这是否相关。（我不是 Netezza 专家，也不是真正的 Netezza 用户！）

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T00:00:13.607

从一开始我的印象就是 NZ1 和 NZ2 运行的是同一个 Netezza 版本。显然情况并非如此。

新的 NZ2 主机针对 6.0 版运行，而 NZ2 针对 3.0 版运行。我们用于 NZ2 的 JDBC 驱动程序的**3 个主要版本太旧了**。这也解释了为什么 NZ1 上的 nzsql 客户端无法连接到 NZ2 主机。

我们更新到 IBM 的最新 JDBC 驱动程序，现在可以正常连接。

# javascript - 隐藏由锚的href选择

> ID：13614418
> 
> 赞同：1
> 
> 时间：2012-11-28T21:07:35.330
> 
> 标签：javascript, jquery, anchor

我试图找出一个功能，`divs`如果单击引用链接，我可以隐藏和显示它们。

很难解释，但这是我要找的：

```
<ul>
   <li><a href="#id-1">Link 1</a></li>
   <li class="active"><a href="#id-2">Link 1</a></li>
   <li><a href="#id-3">Link 1</a></li>
<ul>
<div id="id-1">Some content</div> // Hidden
<div id="id-2">Some content</div> //  This should only show in document
<div id="id-3">Some content</div> // hidden 
```

每当单击其他锚点时，其他锚点`divs`应隐藏。

我希望他说得通，并提前感谢您的帮助

多姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:09:40.613

尝试

```
$("a").click( function( ) {
    var elId = $(this).attr("href");
    $(elId).show().siblings("div[id^=id-]").hide();
}); 
```

[**在这里**](http://jsfiddle.net/MPZqT/)提琴[](http://jsfiddle.net/MPZqT/)

 *** * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T21:14:23.803

您可以使用这样的东西（未经测试，因此可能需要调整）：

```
$(document).ready(function() {              //fires on dom ready

    $("a").click(function(e) {              //assign click handler to all <a> tags

        $(".classForYourDivs").hide();      //hide all divs (put class on ones you want to hide)

        var element = $(e.target);
        var href = element.attr("href");    //get the attribute

        $(href).show();                     //show the relevent one
        return false;                       //important to stop default click behavior of link
    });

}); 
```

顺便说一句，您应该考虑使用 href 以外的东西来存储此信息...查看 jquery data() 函数的文档

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-28T21:15:19.040

`ul`向和 中添加一个类`divs`。

```
<ul class="myUL">
   <li><a href="#id-1">Link 1</a></li>
   <li class="active"><a href="#id-2">Link 1</a></li>
   <li><a href="#id-3">Link 1</a></li>
<ul>
<div id="id-1" class="myDivs">Some content</div> // Hidden
<div id="id-2" class="myDivs">Some content</div> //  This should only show in document
<div id="id-3" class="myDivs">Some content</div> // hidden 
```

然后在 CSS 中，

```
.myDivs { display: none; } 
```

并尝试下面的js代码，

```
var $myDivs = $('.myDivs');
$('.myUL a').on('click', function () {
    $myDivs.hide();
    $($(this).attr('href')).show();
}); 
```

**演示：http:** [//jsfiddle.net/LYKVG/](http://jsfiddle.net/LYKVG/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-28T21:15:34.493

```
$("body").on("click","a", function(){
    var divtoshowselector = $(this).attr("href");
    $(divtoshowselector).show().siblings().hide();
}) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-28T21:18:15.220

[http://jsfiddle.net/](http://jsfiddle.net/)

## html

```
<ul>
   <li><a href="#id-1">Link 1</a></li>
   <li class="active"><a href="#id-2">Link 2</a></li>
   <li><a href="#id-3">Link 3</a></li>
<ul>
<div id="id-1">Some content 1</div> 
<div id="id-2">Some content 2</div>
<div id="id-3">Some content 3</div>​ 
```

## css

```
div {display: none;} 
```

## javascript/jquery

```
$("a").click( function(e) {
    e.preventDefault();    
    var elId = $(this).attr('href');
    $('div').hide();
    $(elId).show();
});​ 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-28T21:19:58.860

我已经为你设置了一个小提琴，请查看：http: [//jsfiddle.net/UsGag/](http://jsfiddle.net/UsGag/)

```
function currentActive()
{
    return $("li.active a").attr("href");
}

$("div:not(" + currentActive() + ")").hide();

$("li a").on("click", function()
{
    //hide old active div
    $("div" + currentActive()).hide();
    $("li").removeClass("active");

    //activate new div
    $(this).parent().addClass("active");    
    $("div" + currentActive()).show();
}); 
```

希望这对您有所帮助，扩展到您自己的需求。并且只是为了完整性：不要使用`-`in ids / classnames。​</p>**

# javascript - 根据自己现有的内容替换header标签的内容

> ID：13614421
> 
> 赞同：1
> 
> 时间：2012-11-28T21:07:42.500
> 
> 标签：javascript, jquery, html, dom

d我有一个预先存在的 html 块，我需要使用 jQuery 进行更改。HTML 如下所示：

```
<div class="main">
    <div class="wms-column wms-column-nav">
        <div class="wms-column-nav-body">
        <div class="section">
            <h3>Recent News</h3>
            <ul class="other">
            <li>Something</li>
            </ul>
        </div>
        </div>
    </div>
</div>​ 
```

我需要定位 H3 并更改其内部文本。但是，如果没有 ID，使用选择器定位它是很棘手的。通过他们的站点还有许多其他 H3 标签无法更改，但具有相同的选择器路径。我怎样才能根据它的内容来定位这个H3，然后改变它？我更喜欢插入 html 而不是文本的方法，因为将使用一些特殊字符。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T21:09:39.440

在香草 Javascript 中：

```
var elements = document.getElementsByTagName('h3');
for (var i=elements.length; i-->0; ) {
    var element = elements[i];
    var text = element.textContent || element.innerText;
    if (text=='Recent News') {
       element.innerHTML = 'some new text';   
    }
} 
```

[示范](http://jsfiddle.net/TAuar/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T21:11:32.127

使用 jQuery：

`$('h3')`将选择所有标题标签。您可以单独解决它们：`$('h3').eq(0)` `$('h3').eq(1)`等等。

您还可以轻松地遍历它们：

```
$('h3').each(function() {
     alert(this.text()) <-- "this" will point to the current item in the loop.
}) 
```

在循环内，您可以访问任何当前项目的内容、属性或属性。您可以相应地基于此逻辑。

# sql-server - 如何检测和绑定 SQL 表中行值之间的更改？

> ID：13614431
> 
> 赞同：19
> 
> 时间：2012-11-28T21:08:17.880
> 
> 标签：sql-server, sql-server-2008, tsql

我有一个记录随时间变化的值的表，类似于以下内容：

```
RecordId  Time   Name
========================
1         10     Running
2         18     Running
3         21     Running
4         29     Walking
5         33     Walking
6         57     Running
7         66     Running 
```

查询此表后，我需要类似于以下的结果：

```
FromTime  ToTime  Name
=========================
10        29      Running
29        57      Walking
57        NULL    Running 
```

我玩弄了一些聚合函数（例如 MIN、MAX 等）、PARTITION 和 CTE，但我似乎无法找到正确的解决方案。我希望 SQL 大师可以帮助我，或者至少为我指明正确的方向。有没有一种相当直接的方法来查询这个（最好没有游标？）

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-11-29T02:45:17.950

**通过聚合而不是连接查找“ToTime”**

我想分享一个非常疯狂的查询，它只需要对表进行 1 次扫描和 1 次逻辑读取。相比之下，页面上最好的其他答案 Simon Kingston 的查询需要 2 次扫描。

在一个非常大的数据集（17,408 个输入行，产生 8,193 个结果行）上，它需要 574 个 CPU 和 2645 个时间，而 Simon Kingston 的查询需要 63,820 个 CPU 和 37,108 个时间。

使用索引可能会使页面上的其他查询性能好很多倍，但我很感兴趣的是，仅通过重写查询就可以实现 111 倍的 CPU 提升和 14 倍的速度提升。

（请注意：我完全没有对 Simon Kingston 或其他任何人的不尊重；我只是对我对这个查询的想法感到兴奋。他的查询比我的要好，因为它的性能很好，而且实际上是可以理解和维护的，不像我的。）

这是不可能的查询。很难理解。很难写。但这太棒了。:)

```
WITH Ranks AS (
   SELECT
      T = Dense_Rank() OVER (ORDER BY Time, Num),
      N = Dense_Rank() OVER (PARTITION BY Name ORDER BY Time, Num),
      *
   FROM
      #Data D
      CROSS JOIN (
         VALUES (1), (2)
      ) X (Num)
), Items AS (
   SELECT
      FromTime = Min(Time),
      ToTime = Max(Time),
      Name = IsNull(Min(CASE WHEN Num = 2 THEN Name END), Min(Name)),
      I = IsNull(Min(CASE WHEN Num = 2 THEN T - N END), Min(T - N)),
      MinNum = Min(Num)
   FROM
      Ranks
   GROUP BY
      T / 2
)
SELECT
   FromTime = Min(FromTime),
   ToTime = CASE WHEN MinNum = 2 THEN NULL ELSE Max(ToTime) END,
   Name
FROM Items
GROUP BY
   I, Name, MinNum
ORDER BY
   FromTime 
```

注意：这需要 SQL 2008 或更高版本。要使其在 SQL 2005 中工作，请将 VALUES 子句更改为`SELECT 1 UNION ALL SELECT 2`.

**更新查询**

想了想，我意识到我同时完成了两个独立的逻辑任务，这使查询变得不必要的复杂：1）剪掉与最终解决方案无关的中间行（不开始的行）一个新任务）和 2）从下一行中提取“ToTime”值。通过在 # 2*之前*执行 #1 ，查询更简单，并且使用大约一半的 CPU 执行！

所以这里是一个简化的查询，首先修剪掉我们不关心的行，*然后*使用聚合而不是 JOIN 获取 ToTime 值。是的，它确实有 3 个窗口函数而不是 2 个，但最终由于行数更少（在修剪我们不关心的行之后），它要做的工作更少：

```
WITH Ranks AS (
   SELECT
      Grp =
         Row_Number() OVER (ORDER BY Time)
         - Row_Number() OVER (PARTITION BY Name ORDER BY Time),
      [Time], Name
   FROM #Data D
), Ranges AS (
   SELECT
      Result = Row_Number() OVER (ORDER BY Min(R.[Time]), X.Num) / 2,
      [Time] = Min(R.[Time]),
      R.Name, X.Num
   FROM
      Ranks R
      CROSS JOIN (VALUES (1), (2)) X (Num)
   GROUP BY
      R.Name, R.Grp, X.Num
)
SELECT
   FromTime = Min([Time]),
   ToTime = CASE WHEN Count(*) = 1 THEN NULL ELSE Max([Time]) END,
   Name = IsNull(Min(CASE WHEN Num = 2 THEN Name ELSE NULL END), Min(Name))
FROM Ranges R
WHERE Result > 0
GROUP BY Result
ORDER BY FromTime; 
```

这个更新后的查询与我在解释中提出的所有问题相同，但是，它们更容易解决，因为我不处理多余的不需要的行。我还看到`Row_Number() / 2`我必须排除 0 的值，我不知道为什么我没有从先前的查询中排除它，但无论如何这完美地工作并且速度非常快！

**外部应用收拾东西**

最后，这是一个与 Simon Kingston 的查询基本相同的版本，我认为它的语法更易于理解。

```
SELECT
   FromTime = Min(D.Time),
   X.ToTime,
   D.Name
FROM
   #Data D
   OUTER APPLY (
      SELECT TOP 1 ToTime = D2.[Time]
      FROM #Data D2
      WHERE
         D.[Time] < D2.[Time]
         AND D.[Name] <> D2.[Name]
      ORDER BY D2.[Time]
   ) X
GROUP BY
   X.ToTime,
   D.Name
ORDER BY
   FromTime; 
```

如果您想对更大的数据集进行性能比较，请使用以下设置脚本：

```
CREATE TABLE #Data (
    RecordId int,
    [Time]  int,
    Name varchar(10)
);
INSERT #Data VALUES
    (1, 10, 'Running'),
    (2, 18, 'Running'),
    (3, 21, 'Running'),
    (4, 29, 'Walking'),
    (5, 33, 'Walking'),
    (6, 57, 'Running'),
    (7, 66, 'Running'),
    (8, 77, 'Running'),
    (9, 81, 'Walking'),
    (10, 89, 'Running'),
    (11, 93, 'Walking'),
    (12, 99, 'Running'),
    (13, 107, 'Running'),
    (14, 113, 'Walking'),
    (15, 124, 'Walking'),
    (16, 155, 'Walking'),
    (17, 178, 'Running');
GO
insert #data select recordid + (select max(recordid) from #data), time + (select max(time) +25 from #data), name from #data
GO 10 
```

**解释**

这是我的查询背后的基本思想。

1.  代表切换的时间必须出现在两个相邻的行中，一个用于结束前一个活动，一个用于开始下一个活动。对此的自然解决方案是连接，以便输出行可以从其自己的行（开始时间）和*下一个更改*的行（结束时间）中拉出。

2.  但是，我的查询通过重复该行两次来完成使结束时间出现在两个不同行中的需要，使用`CROSS JOIN (VALUES (1), (2))`. 我们现在已经复制了所有行。这个想法是，我们将使用某种形式的聚合将每对所需的行合并为一个，而不是使用 JOIN 跨列进行计算。

3.  下一个任务是正确拆分每个重复的行，以便一个实例与前一对一起使用，一个与下一对一起使用。这是通过 T 列完成的，按`ROW_NUMBER()`排序`Time`，然后除以 2（尽管我将其更改为 DENSE_RANK() 以实现对称性，因为在这种情况下它返回与 ROW_NUMBER 相同的值）。为了提高效率，我在下一步中执行了除法，以便可以在另一个计算中重复使用行号（继续阅读）。由于行号从 1 开始，除以 2 隐式转换为 int，这具有产生`0 1 1 2 2 3 3 4 4 ...`具有所需结果的序列的效果：通过按此计算值分组，因为我们还按`Num`在行号中，我们现在已经完成了第一个之后的所有集合都由“前”行的 Num = 2 和“下”行的 Num = 1 组成。

4.  下一个艰巨的任务是找出一种方法来消除我们不关心的行，并以某种方式将块的开始时间折叠到与块的结束时间相同的行中。我们想要的是一种方法，让每个离散的 Running 或 Walking 集合都有自己的编号，以便我们可以按它进行分组。`DENSE_RANK()`是一个自然的解决方案，但问题是它关注`ORDER BY`子句中的每个值——我们没有语法可以这样做`DENSE_RANK() OVER (PREORDER BY Time ORDER BY Name)`，这样`Time`不会导致`RANK`计算发生变化，除非`Name`. [经过一番思考后，我意识到我可以从Itzik Ben-Gan 的分组岛屿解决方案](http://tsql.solidq.com/books/source_code/SQL%20Server%20MVP%20Deep%20Dives%20-%20Chapter%2005.txt)背后的逻辑中汲取一点灵感，我发现`Time`按`Name`并按 排序`Time`，将产生一个值，该值对于同一组中的每一行都相同，但与其他组不同。通用的分组岛技术是创建两个计算值，它们都与行同步上升，例如`4 5 6`和`1 2 3`，减去它们时将产生相同的值（在本示例`3 3 3`中为 、 和 的`4 - 1`结果`5 - 2`）`6 - 3`。注意：我最初是从`ROW_NUMBER()`我的`N`计算开始的，但它不起作用。正确的答案是`DENSE_RANK()`虽然我很抱歉地说我不记得我当时为什么得出这个结论，但我必须再次深入研究才能弄清楚。但无论如何，这就是`T-N`计算：可以分组以隔离一个状态（跑步或步行）的每个“岛”的数字。

5.  但这不是结束，因为有一些皱纹。首先，每组中的“下一个”行包含 、 和 的`Name`错误`N`值`T`。我们通过从每个组中选择存在的`Num = 2`行中的值来解决这个问题（但如果不存在，则使用剩余的值）。这会产生如下表达式`CASE WHEN NUM = 2 THEN x END`：这将正确清除不正确的“下一个”行值。

6.  经过一些实验，我意识到单独分组是不够的`T - N`，因为步行组和跑步组可以有相同的计算值（在我提供的样本数据最多为 17 的情况下，有两个`T - N`值6）。但是简单地分组`Name`也可以解决这个问题。“跑步”或“步行”组中的任何组都不会具有来自相反类型的相同数量的干预值。也就是说，由于第一组以“Running”开始，并且在下一个“Running”组之前有两个“Walking”行，因此 N 的值将比`T`下一个“Running”组中的值小 2 . 我刚刚意识到，思考这个问题的一种方法是`T - N`计算计算当前行之前不属于相同值“Running”或“Walking”的行数。一些想法会表明这是真的：如果我们继续前进到第三组“跑步”组，它只是第三组，因为有一个“步行”组将它们分开，所以它有不同数量的中间行进入在它之前，并且由于它从更高的位置开始，它足够高，以至于不能复制值。

7.  最后，由于我们的最后一组仅包含一行（没有结束时间，我们需要显示 a`NULL`代替），我不得不进行计算，该计算可用于确定我们是否有结束时间。这是通过`Min(Num)`表达式完成的，然后最终检测到当 Min(Num) 为 2 时（意味着我们没有“下一个”行），然后显示 a`NULL`而不是`Max(ToTime)`值。

我希望这个解释对人们有所帮助。我不知道我的“行乘法”技术是否普遍有用并适用于生产环境中的大多数 SQL 查询编写器，因为理解它的困难和维护的困难它肯定会呈现给下一个访问代码（反应可能是“它到底在做什么！？！”然后是快速的“重写时间！”）。

如果您已经做到了这一步，那么我感谢您抽出宝贵的时间，让我沉迷于我对令人难以置信的有趣 sql-puzzle-land 的小旅行。

**亲眼看看**

又名模拟“PREORDER BY”：

最后一点。要了解`T - N`这项工作的效果——并注意使用我的方法的这一部分可能不适用于 SQL 社区——对示例数据的前 17 行运行以下查询：

```
WITH Ranks AS (
   SELECT
      T = Dense_Rank() OVER (ORDER BY Time),
      N = Dense_Rank() OVER (PARTITION BY Name ORDER BY Time),
      *
   FROM
      #Data D
)
SELECT
   *,
   T - N
FROM Ranks
ORDER BY
   [Time]; 
```

这产生：

```
RecordId    Time Name       T    N    T - N
----------- ---- ---------- ---- ---- -----
1           10   Running    1    1    0
2           18   Running    2    2    0
3           21   Running    3    3    0
4           29   Walking    4    1    3
5           33   Walking    5    2    3
6           57   Running    6    4    2
7           66   Running    7    5    2
8           77   Running    8    6    2
9           81   Walking    9    3    6
10          89   Running    10   7    3
11          93   Walking    11   4    7
12          99   Running    12   8    4
13          107  Running    13   9    4
14          113  Walking    14   5    9
15          124  Walking    15   6    9
16          155  Walking    16   7    9
17          178  Running    17   10   7 
```

重要的部分是每组“Walking”或“Running”具有相同的值，`T - N`这与任何其他具有相同名称的组不同。

**表现**

我不想详细说明我的查询比其他人的查询快。但是，考虑到差异有多么显着（当没有索引时），我想以表格格式显示数字。当需要这种行间关联的高性能时，这是一种很好的技术。

在每个查询运行之前，我使用了`DBCC FREEPROCCACHE; DBCC DROPCLEANBUFFERS;`. 我将每个查询的 MAXDOP 设置为 1，以消除并行性的时间折叠效应。我将每个结果集选择为变量而不是将它们返回给客户端，以便仅衡量性能而不衡量客户端数据传输。所有查询都被赋予相同的 ORDER BY 子句。所有测试使用 17,408 个输入行，产生 8,193 个结果行。

以下人员/原因未显示任何结果：

```
RichardTheKiwi *Could not test--query needs updating*
ypercube       *No SQL 2012 environment yet :)*
Tim S          *Did not complete tests within 5 minutes* 
```

没有索引：

```
 CPU         Duration    Reads       Writes
               ----------- ----------- ----------- -----------
ErikE          344         344         99          0
Simon Kingston 68672       69582       549203      49 
```

带索引`CREATE UNIQUE CLUSTERED INDEX CI_#Data ON #Data (Time);`：

```
 CPU         Duration    Reads       Writes
               ----------- ----------- ----------- -----------
ErikE          328         336         99          0
Simon Kingston 70391       71291       549203      49          * basically not worse 
```

带索引`CREATE UNIQUE CLUSTERED INDEX CI_#Data ON #Data (Time, Name);`：

```
 CPU         Duration    Reads       Writes
               ----------- ----------- ----------- -----------
ErikE          375         414         359         0           * IO WINNER
Simon Kingston 172         189         38273       0           * CPU WINNER 
```

所以这个故事的寓意是：

**适当的索引比查询魔法更重要**

使用适当的索引，Simon Kingston 的版本总体上获胜，尤其是在包括查询复杂性/可维护性时。

好好听听这个教训！38k 的阅读量并没有那么多，Simon Kingston 的版本运行时间是我的一半。我的查询速度的提高完全是由于表上没有索引，并且随之而来的灾难性成本给任何需要连接的查询（我的没有）：全表扫描哈希匹配杀死了它的性能。有了索引，他的查询就能够通过聚集索引查找（又名书签查找）进行嵌套循环，这让事情变得*非常*快。

有趣的是，仅 Time 上的聚集索引是不够的。尽管 Times 是唯一的，这意味着每次只出现一个 Name，但它仍然需要 Name 作为索引的一部分才能正确使用它。

在充满数据的情况下将聚集索引添加到表中需要不到 1 秒的时间！不要忽视你的索引。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-28T22:33:55.633

这在 SQL Server 2008 中不起作用，仅在具有[**`LAG()`**和**`LEAD()`**分析功能](http://msdn.microsoft.com/en-us/library/hh213234.aspx)的 SQL Server 2012 版本中起作用，但我将把它留给任何使用较新版本的人：

```
SELECT Time AS FromTime
     , LEAD(Time) OVER (ORDER BY Time) AS ToTime
     , Name
FROM
  ( SELECT Time 
         , LAG(Name) OVER (ORDER BY Time) AS PreviousName
         , Name
    FROM Data  
  ) AS tmp
WHERE PreviousName <> Name 
   OR PreviousName IS NULL ; 
```

在**[SQL-Fiddle中测试](http://www.sqlfiddle.com/#!6/2d1cf/1)**

有了索引，`(Time, Name)`就需要进行索引扫描。

# 编辑：

如果`NULL`是一个有效值`Name`，则需要将其视为有效条目，请使用以下`WHERE`子句：

```
WHERE PreviousName <> Name 
   OR (PreviousName IS NULL AND Name IS NOT NULL)
   OR (PreviousName IS NOT NULL AND Name IS NULL) ; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-28T21:56:36.893

我假设 RecordID 并不总是连续的，因此 CTE 创建一个不间断的序列号。

## [SQLFiddle](http://www.sqlfiddle.com/#!6/b8add/1/0)

```
;with SequentiallyNumbered as (
    select *, N = row_number() over (order by RecordId)
      from Data)
, Tmp as (
    select A.*, RN=row_number() over (order by A.Time)
      from SequentiallyNumbered A
 left join SequentiallyNumbered B on B.N = A.N-1 and A.name = B.name
     where B.name is null)
   select A.Time FromTime, B.Time ToTime, A.Name
     from Tmp A
left join Tmp B on B.RN = A.RN + 1; 
```

我用来测试的数据集

```
create table Data (
    RecordId int,
    Time  int,
    Name varchar(10));
insert Data values
    (1         ,10     ,'Running'),
    (2         ,18     ,'Running'),
    (3         ,21     ,'Running'),
    (4         ,29     ,'Walking'),
    (5         ,33     ,'Walking'),
    (6         ,57     ,'Running'),
    (7         ,66     ,'Running'); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-11-28T21:56:53.173

这是一个 CTE 解决方案，可以得到您正在寻找的结果：

```
;WITH TheRecords (FirstTime,SecondTime,[Name])
AS
(
    SELECT [Time],
    (
        SELECT MIN([Time]) 
        FROM ActivityTable at2
        WHERE at2.[Time]>at.[Time]
        AND at2.[Name]<>at.[Name]
    ),
    [Name]
    FROM ActivityTable at
)
SELECT MIN(FirstTime) AS FromTime,SecondTime AS ToTime,MIN([Name]) AS [Name]
FROM TheRecords
GROUP BY SecondTime
ORDER BY FromTime,ToTime 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-11-28T21:59:38.497

我认为您本质上对“名称”从一条记录更改为下一条记录的位置（按“时间”顺序）感兴趣。如果您可以确定发生这种情况的位置，则可以生成所需的输出。

由于您提到了 CTE，我假设您使用的是 SQL Server 2005+，因此可以使用该`ROW_NUMBER()`功能。您可以使用`ROW_NUMBER()`一种方便的方法来识别连续的记录对，然后找到“名称”发生变化的那些。

这个怎么样：

```
WITH OrderedTable AS
(
    SELECT
        *,
        ROW_NUMBER() OVER (ORDER BY Time) AS Ordinal
    FROM
        [YourTable]
),
NameChange AS
(
    SELECT
        after.Time AS Time,
        after.Name AS Name,
        ROW_NUMBER() OVER (ORDER BY after.Time) AS Ordinal
    FROM
        OrderedTable before
        RIGHT JOIN OrderedTable after ON after.Ordinal = before.Ordinal + 1
    WHERE
        ISNULL(before.Name, '') <> after.Name
)

SELECT
    before.Time AS FromTime,
    after.Time AS ToTime,
    before.Name
FROM
    NameChange before
    LEFT JOIN NameChange after ON after.Ordinal = before.Ordinal + 1 
```

# c# - 列表视图的搜索框无法正常工作

> ID：13614434
> 
> 赞同：0
> 
> 时间：2012-11-28T21:08:33.403
> 
> 标签：c#, asp.net, sql-server

嗨，我正在尝试创建一个搜索 ListView 的搜索框，我设法做到了这一点，如果我让它只由用户名搜索，它就可以工作。只要我用参数替换用户名，代码就不再工作了。这里是我的代码：

```
string searchSelectBox = SearchSelectDropDown.SelectedItem.Text;

GetAllUsersFromDb.SelectCommand =
    "SELECT aspnet_Users.UserName, aspnet_Roles.RoleName, "
    + "aspnet_Membership.Email, aspnet_Membership.LastLoginDate "
    + "FROM aspnet_Users "
    + "INNER JOIN aspnet_UsersInRoles "
    + "ON aspnet_Users.UserId = aspnet_UsersInRoles.UserId "
    + "INNER JOIN aspnet_Roles "
    + "ON aspnet_UsersInRoles.RoleId = aspnet_Roles.RoleId "
    + "INNER JOIN aspnet_Membership "
    + "ON aspnet_Users.UserId = aspnet_Membership.UserId "
    + "WHERE @SelectField LiKE @Param";
GetAllUsersFromDb.SelectParameters.Clear();
GetAllUsersFromDb.SelectParameters.Add("SelectField" , searchSelectBox);
GetAllUsersFromDb.SelectParameters.Add("Param" , SearchBox.Text);
GetAllUsersFromDb.DataBind();
textListView.DataBind(); 
```

searchSelectBox 可以采用的值是 Username 、 Rolename 和 Email

如果我用用户名替换@SelectField 并输入一个正确的用户名，则搜索可以工作，但实际上它没有。

这里有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T21:18:39.260

试试这个

```
string searchSelectBox = SearchSelectDropDown.SelectedItem.Text;

    GetAllUsersFromDb.SelectCommand =
       string.Format("SELECT aspnet_Users.UserName, aspnet_Roles.RoleName, 
                      aspnet_Membership.Email, aspnet_Membership.LastLoginDate 
                      FROM aspnet_Users 
                      INNER JOIN aspnet_UsersInRoles ON aspnet_Users.UserId = aspnet_UsersInRoles.UserId 
                      INNER JOIN aspnet_Roles ON aspnet_UsersInRoles.RoleId = aspnet_Roles.RoleId 
                      INNER JOIN aspnet_Membership ON aspnet_Users.UserId = aspnet_Membership.UserId 
                      WHERE {0} LiKE @Param", searchSelectBox);
    GetAllUsersFromDb.SelectParameters.Clear();

    GetAllUsersFromDb.SelectParameters.Add("Param" , SearchBox.Text);
    GetAllUsersFromDb.DataBind();
    textListView.DataBind(); 
```

# sql-server-2008 - 如何在 SQL Server 2008 中查看内部表？

> ID：13614440
> 
> 赞同：6
> 
> 时间：2012-11-28T21:08:46.710
> 
> 标签：sql-server-2008

我专门寻找一种方法来查看全文索引片段和 xml 索引，[根据文档](http://msdn.microsoft.com/en-us/library/cc879306.aspx#fragments)，它们存储为内部表。[本页](http://msdn.microsoft.com/en-us/library/ms366343%28v=sql.105%29.aspx)介绍如何查看内部表元数据。我希望的是一种查看内部表中数据的方法。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-28T22:08:12.137

您可以从中获取架构名称和表名称`sys.internal_tables`

```
SELECT QUOTENAME(SCHEMA_NAME(schema_id)) + '.' + QUOTENAME(name)
FROM sys.internal_tables 
```

然后，如果您[通过 DAC](http://msdn.microsoft.com/en-us/library/ms189595.aspx)连接，您可以简单地从中选择

```
select * from [sys].[xml_index_nodes_1765581328_256000]
select * from [sys].[fulltext_avdl_1077578877]
select * from [sys].[ifts_comp_fragment_610101214_4] 
```

不过，可能有更好的方法来获取您想要的任何信息。[例如，这里列出了](http://msdn.microsoft.com/en-us/library/ms174971%28v=sql.100%29.aspx)与 SQL Server 2008 中的全文索引相关的 DMV 。

# mysql - 获取过去 30 天内数组中的表中当天的记录总数

> ID：13614441
> 
> 赞同：2
> 
> 时间：2012-11-28T21:08:50.323
> 
> 标签：mysql, ruby-on-rails-3, activerecord, query-optimization

我想绘制一个图表来查看过去 30 天的用户增长情况。

所以它将是一个像这样的数组：（一个增量数组）

```
 [0,100,250,500,1000,1100.....5000,5500] 
```

**解决方案 1：**一个愚蠢的方法是每天触发查询：

```
 (30.days.ago.to_date..Date.today).map {|date| User.where("Date(created_at) <= ?" , date).count} 
```

但这将触发 30 个查询。

**解决方案 2：**使用 group by 选项查找所有记录，然后对其进行循环并总结以前的记录。

```
 User.group('Date(created_at)').count
 (30.days.ago.to_date..Date.today).map {|date| counts[date] || 0} //and again loop over it
 //and now start summing up previous ones elements to get an another array.. 
```

但是这两种解决方案都是无用的。将其作为优化建议的任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T21:36:31.983

You should be able to do this with sql itself,

Ex: I have the following table

```
+---------+---------------------+
| user_id | training_start_date |
+---------+---------------------+
|   15981 | 2012-10-08 06:12:45 |
|   15981 | 2012-10-08 06:13:26 |
|   15981 | 2012-10-08 06:29:34 |
|   15981 | 2012-10-08 06:33:53 |
| 1005933 | 2012-10-08 07:41:54 |
+---------+---------------------+ 
```

when I want to get how many users got the training each day, I could do

```
select count(user_id), training_start_date from training_users group by DATE_FORMAT(training_start_date, "%M %e, %Y"); 
```

This is the link which [helped me](http://database-programmer.blogspot.com/2008/04/group-by-having-sum-avg-and-count.html)

HTH

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T22:32:46.420

我将执行以下操作：

```
growth = []
users =  User.group('Date(created_at)').count

(30.days.ago.to_date..Date.today).each do |day|
  growth.push(growth.sum + (users[day] || 0))
end 
```

未经测试，但你明白了。

# sql-server-2008 - 使用 T-SQL 和 XQuery 解析 TFS 2010 进程参数 XML

> ID：13614442
> 
> 赞同：2
> 
> 时间：2012-11-28T21:08:54.043
> 
> 标签：sql-server-2008, tsql, namespaces, xquery

我正在尝试在下面显示的代码示例中获取 XML 中x:String 节点**(L1.0.0.0)的值。**示例中的 XML 在我们对构建进行排队时由 TFS 2010 生成。XML 有两个主要节点和**Dictionary**和**x:String**，我已经尝试过类似于另一个堆栈溢出线程的查询，并且我已经将其包括在额外的研究中。有人对我的 XQuery 不工作有什么建议吗？

```
DECLARE @XML XML;
SET @XML = '<Dictionary x:TypeArguments="x:String, x:Object" 
xmlns="clr-namespace:System.Collections.Generic;assembly=mscorlib" 
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">   
<x:String x:Key="GetVersion">L1.0.0.0</x:String> 
</Dictionary>'

;WITH XMLNAMESPACES(
'clr-namespace:System.Collections.Generic;assembly=mscorlib' AS a,
'http://schemas.microsoft.com/winfx/2006/xaml' AS x)

SELECT @XML.value('(/Dictionary/x:String)[1]', varchar(100)) AS BuildLabel 
```

附加研究 Stack Overflow [T-SQL, XQuery Invalid Column](https://stackoverflow.com/questions/8590183/t-sql-xquery-invalid-column)

[如何使用多个命名空间](http://beyondrelational.com/modules/2/blogs/28/posts/10318/xquery-lab-37-working-with-multiple-namespaces.aspx)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T07:34:53.573

`Dictionary`在您的查询中，您需要添加前缀`a`since`clr-namespace:System.Collections.Generic;assembly=mscorlib`是默认命名空间并且`Dictionary`属于该命名空间。

```
;WITH XMLNAMESPACES(
'clr-namespace:System.Collections.Generic;assembly=mscorlib' AS a,
'http://schemas.microsoft.com/winfx/2006/xaml' AS x)
SELECT @XML.value('(/a:Dictionary/x:String)[1]', 'varchar(100)') AS BuildLabel 
```

或者您可以在查询中将命名空间指定为默认值。

```
;WITH XMLNAMESPACES('http://schemas.microsoft.com/winfx/2006/xaml' as x,
                     DEFAULT 'clr-namespace:System.Collections.Generic;assembly=mscorlib')
SELECT @XML.value('(/Dictionary/x:String)[1]', 'varchar(100)') AS BuildLabel 
```

# php - 在 codeigniter 中获取发布数据的问题

> ID：13614444
> 
> 赞同：0
> 
> 时间：2012-11-28T21:09:01.610
> 
> 标签：php, codeigniter

我在从我的视图中获取帖子数据时遇到问题。在我的控制器中，我目前有以下内容：

```
function update()
{
    var_dump($this->input->post('name'));
} 
```

那返回

```
bool(false) 
```

我努力了

```
var_dump($_POST); 
```

但这会返回一个空数组

这是我对 pastebin 的看法（我无法在此处获取格式）

[http://pastebin.com/zJvuDRu4](http://pastebin.com/zJvuDRu4)

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-28T21:15:27.003

您忘记了属性名称

```
<td><input type="text" id="name" value="{name}"/></td></tr> 
```

正确的是：

```
<td><input type="text" id="name" value="{name}" name="name"/></td></tr> 
```

而其他输入，你也必须这样做。

# javascript - SimpleCart JS：我如何知道产品是否正确销售？

> ID：13614448
> 
> 赞同：0
> 
> 时间：2012-11-28T21:09:09.810
> 
> 标签：javascript, simplecart

我正在尝试[http://simplecartjs.org](http://simplecartjs.org) – 有一种方法可以知道用户是否购买并支付了商品？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:15:38.010

如果您查看此购物车应用程序的文档，您会发现有几个可用的结帐选项。参见例如：[http ://simplecartjs.org/documentation/paypal](http://simplecartjs.org/documentation/paypal)

因此，您可以将您的 SimpleCart 链接到这些结帐提供商之一，并且您必须在这些网站上查找已完成的付款。

当然，您可以选择使用[SendForm](http://simplecartjs.org/documentation/sendform-checkout)来使用自己的结帐方法，但您必须自己编写。

结帐过程也有几个事件回调，例如，`checkoutSuccess`您可以使用。`checkoutFail``beforeCheckout`

```
simpleCart({
    checkout: {
        type: "PayPal" ,
        email: "you@yours.com"
    },
    checkoutSuccess    : null, /* insert your function call here */
    checkoutFail       : null,
    beforeCheckout     : null
}); 
```

而不是`null`您只需插入您的函数调用。

# c# - vshost32.exe 由于糟糕的命名类和对象管理而失败

> ID：13614450
> 
> 赞同：0
> 
> 时间：2012-11-28T21:09:19.437
> 
> 标签：c#

我不是 C# 的经验丰富的专业人士，并且遇到了一个错误，我找不到一个离散的解决方案。目前我有一个类是我的命名空间的一部分

```
namespace BlackBoxStudio
{
    public partial class Project : Form
    { 
```

这个项目类实现了我的表单的各种功能。我要做的是使`label.text`同一名称空间内的另一个 .cs 类可以访问一个字段。因此，我已经公开了相应的字段：

```
 public string lb_InformationText
    {
        get { return lb_Information.Text; }
        set { lb_Information.Text = value; }
    } 
```

为了调用这些，我在我的`RsaFunctions`类中获取或设置方法，我创建了一个新的私有`project`方法：

```
namespace BlackBoxStudio
{
    class RsaFunctions 
    {
        //private Project proj =  new Project(); 
```

但是，我们注释的行导致我的 vshost32.exe 应用程序失败并且程序死亡。当我取消注释相应的行时，为什么这会导致 vshost32.exe 失败？或者我怎样才能更好地组织我的课程，这样就不会发生这种情况？关于我制作新课程等的策略的任何提示将不胜感激。

# mysql - 使用 AJAX 和 JSP 查询 MySQL 数据库

> ID：13614451
> 
> 赞同：0
> 
> 时间：2012-11-28T21:09:19.910
> 
> 标签：mysql, ajax, jsp

基本上，我有一个文本区域，用户将在其中键入 MySQL 查询，例如 SELECT * FROM table_names。需要运行查询并且需要将结果加载到选择字段中。我已经尝试了各种方法，但都没有成功，任何关于这样做的建议将不胜感激。

主界面.jsp

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<%@ page language="Java" import="java.sql.*" %>
<%@page contentType="text/html"%>
<%@page pageEncoding="UTF-8"%>
<%! 
String gUser;
String gDatabase;
String gPassword;
String gUrl;
String gUrlFront;
String gUrlBack;
%>
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

        <link href="main_canvas.css" rel="stylesheet" type="text/css" />
        <link rel="stylesheet" type="text/css" href="tabview.css" />
        <link rel="stylesheet" href="css/jquery.treeview.css" />

        <script type="text/javascript" src="tabview.js"></script>

        <script src="js/jquery-1.4.min.js" type="text/javascript"></script>
        <script src="js/jquery.cookie.js" type="text/javascript"></script>
        <script src="js/jquery.treeview.js" type="text/javascript"></script>
        <script language="javascript" type="text/javascript">
<!-- 
//Browser Support Code
function ajaxFunction(){
    var ajaxRequest;  // The variable that makes Ajax possible!

    try
        {
            // Opera 8.0+, Firefox, Safari
            ajaxRequest = new XMLHttpRequest();
    } 
        catch (e)
        {
            // Internet Explorer Browsers
            try
            {
        ajaxRequest = new ActiveXObject("Msxml2.XMLHTTP");
            } 
            catch (e) 
            {
        try
                {
                    ajaxRequest = new ActiveXObject("Microsoft.XMLHTTP");
        } 
                catch (e)
                {
                    // Something went wrong
                    alert("Your browser broke!");
                    return false;
        }
            }
    }
    // Create a function that will receive data sent from the server
    ajaxRequest.onreadystatechange = function()
        {
            if(ajaxRequest.readyState == 4)
            {
                document.getElementById("boxx").innerHTML= "<option>" + ajaxRequest.responseText + "</option>";
            }
    }
    var age = 1;
    var wpm = 3;
    var sex = 5;
    var queryString = "?dsname=" + gDatabase + "&user=" + gUser + "&pass=" + gPassword + "&u1=" + gUrlFront + "&u2=" + gUrl + "&u2=" + gUrlBack ;
    ajaxRequest.open("GET", "exeQuery.jsp" + queryString, true);
    ajaxRequest.send(null); 
}

//-->
</script>
        <script type="text/javascript">
            $(function() {
                $("#tree").treeview({
                    collapsed: true,
                    animated: "medium",
                    control:"#sidetreecontrol",
                    prerendered: true,
                    persist: "location"
                });
            })  

            function myFunction()
            {

            }
        </script>
        <style type="text/css">
            html, body
            {
                height: 99%;
                width:99%;
                background-color:black;
            }
        </style>
    </head>

    <body>
            <div class="main_body_container" >  <!--Start Main Body-->

                <div class="main_body_container_left"><!--Start Left Pane-->

<jsp:useBean id="NinGoo" scope="session" class="NinGoo.beancode" />
<%
    ResultSet rs = null;    
    Connection conn = null;

        String database = request.getParameter("dsname");
        gDatabase = database;
        String urlfront = "jdbc:mysql://";
        gUrlFront = urlfront;
        String url = request.getParameter("url"); // localhost:3306
        gUrl = url;
        String urlback = "/";        
        gUrlBack = urlback;
        String username = request.getParameter("user");
        gUser = username;
        String password = request.getParameter("password");
        gPassword = password;

        NinGoo.setDsname(database);
        NinGoo.setURL(urlfront + url + urlback);
        NinGoo.setusername(username);
        NinGoo.setpassword("");

        conn = NinGoo.getConnection();
        rs = NinGoo.executeSQL( "SELECT DISTINCT TABLE_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA=" + "'" + database + "'"); 

        String result; 
%>

                    <div id="sidetree">

                        <ul class="treeview" id="tree" >
                <h1>LOGO HERE </h1>
                            <li class="expandable"><div class="hitarea expandable-hitarea"></div><span><strong><b><%=database %> (DSNAME)</b> </br></strong></span>

                                <ul style="display: none;">

<%
    while (rs.next())
    {
        result = rs.getString("TABLE_NAME");

%>

                                    <li class="expandable"><div class="hitarea expandable-hitarea"></div><span><strong><%=result%></strong></span>

                                        <ul style="display: none;">

<%
        ResultSet columnNames = null;
        String colName;
        String colType;
        columnNames = NinGoo.executeSQL("SELECT COLUMN_NAME, COLUMN_TYPE FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA='" + database + "'" + "AND TABLE_NAME='" + result + "'");

        while(columnNames.next())
        {
            colName = columnNames.getString("COLUMN_NAME");
            colType = columnNames.getString("COLUMN_TYPE");

%>
            <table>
            <li><tr><td style="width:60px;"><%=colName%></td><td style="width:20px;"></td><td align="left" style="width:100px;white-space: nowrap;"><%=colType%></td></tr></li>
            </table>
<%
        }
%>
                                        </ul> 
                                    </li>    
<%
    }
%>                            
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div><!--End Left Pane-->

                <div class="main_body_container_right">    <!--Start Right Pane-->
                    <div class="TabView" id="TabView">  <!--Start Tabs Section-->
                         <div class="Tabs" style="width: 400px;"><!--Start Tabs-->
                            <a>Construct Cube</a>
                            <a>Explore Cube</a>
                        </div><!-- End Tabs-->
                        <div class="Pages"> <!--Begin Pages Content-->

                            <div class="Page"> <!-- *** Page1 Start *** -->
                                 <div class="Pad"><!-- Page 1 Start Pad-->
                                        <button onclick="ajaxFunction()" style="float:left;"> Execute Query </button>

                                        <textarea style="float:left;height:400px;width:1000px;resize:none;border: solid black 2px;"> </textarea>

                                        <b style="padding-left:30%; padding-top:20px;">Cube Name </b>
                                        <input id="cubeName" type="text" size="65" style="border:solid black 1px"/>
                                        <table>
                                            <tr>
                                                <td style="height:30px;">
                                                    <!--Empty Cell Used For Alignment-->
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="height:30px;">
                                                    <!--Empty Cell Used For Alignment-->
                                                </td>
                                                <td>
                                                    <button id="dim">Add Dimension</button>
                                                </td>

                                                <td>
                                                    <button>Choose Column</button>
                                                </td>

                                                <td>
                                                    <!--Empty Column Used For Alignment-->
                                                </td>

                                                <td>
                                                    <button>Granularity</button>
                                                </td>
                                            </tr>

                                            <tr>
                                                <td style="width:50px;">
                                                    <!--Empty Column Used For Alignment-->
                                                </td>
                                                <tr>
                                                    <td style="height:100px;">
                                                        <!--Empty Cell Used For Alignment-->
                                                    </td>
                                                    <td style="width:200px;;">
                                                        <select size="5" name="selectionField" multiple="yes" > 
                                                            <option >Will List Dimensions</option>
                                                        </select>
                                                    </td>
                                                    <td >
                                                        <select id="boxx" style="width:200px;" name="selectionField" multiple="yes" > 
                                                            <option >Will List Columns</option>
                                                        </select>
                                                    </td>
                                                    <td align="center" style="width:100px;">
                                                        <button> --> </button>
                                                    </td>
                                                    <td>
                                                        <select size="5" name="selectionField" multiple="yes" > 
                                                            <option >Will List Granularity</option>
                                                        </select>
                                                    </td>
                                                </tr>

                                                <tr>
                                                    <td style="height:30px;">
                                                        <!--Empty Cell Used For Alignment-->
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td style="height:60px;">
                                                        <!--Empty Cell Used For Alignment-->
                                                    </td>
                                                    <td>
                                                        <button>Aggregate</button>
                                                    </td>

                                                    <td>
                                                        <button>Choose Column</button>
                                                    </td>

                                                    <td>
                                                        <!--Empty Column Used For Alignment-->
                                                    </td>

                                                    <td>
                                                        <button>Measures</button>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td style="width:50px;">
                                                        <!--Empty Column Used For Alignment-->
                                                    </td>

                                                    <td style="width:200px;;">
                                                        <select size="5" name="selectionField" multiple="yes" > 
                                                            <option >Will List Aggregate </option>
                                                        </select>
                                                    </td>
                                                    <td>
                                                        <select size="5" name="selectionField" multiple="yes" > 
                                                            <option >Will List Columns</option>
                                                        </select>
                                                    </td>
                                                    <td align="center" style="width:100px;">
                                                        <button> --> </button>
                                                    </td>
                                                    <td>
                                                        <select size="5" name="selectionField" multiple="yes" > 
                                                            <option >Will List Measures</option>
                                                        </select>
                                                    </td>
                                                </tr>

                                                <tr>
                                                    <td style="height:50px;">
                                                        <!--Empty Column Used For Alignment-->
                                                    </td>
                                                    <td align="center" colspan="4">
                                                        <button style="padding-left:25px; padding-right:25px;"> Save Cube </button>
                                                    </td>
                                                </tr>
                                        </table>                            
                                 </div> <!--End Page1 Pad -->
                            </div> <!--End Page 1 -->

                            <div class="Page"> <!-- *** Page2 Start *** -->
                                 <div class="Pad"><!-- Page2 Start Pad-->
                                 </div> <!--End Page2 Pad -->
                            </div> <!--End Page 2 -->

                        </div> <!--End Pages -->
                    </div><!--End TabView -->
                </div><!--End Right Pane-->

            </div> <!--End Main Body-->

        <script type="text/javascript">
            tabview_initialize('TabView');
        </script>

    </body>
</html>

    <%-- 
    Document   : exeQuery.jsp
    Created on : Nov 28, 2012, 3:07:13 PM
    Author     : Raymond
--%> 
```

exeQuery.jsp

```
<%@ page language="Java" import="java.sql.*" %>
<%@page contentType="text/html"%>
<%@page pageEncoding="UTF-8"%>

<!DOCTYPE html>
<jsp:useBean id="NinGoo" scope="session" class="NinGoo.beancode" />
<%
    ResultSet rs = null;    
    Connection conn = null;

        String database = request.getParameter("dsname");
        String urlfront = "jdbc:mysql://";
        String url = request.getParameter("u2"); // localhost:3306
        String urlback = "/";        
        String username = request.getParameter("user");
        String password = request.getParameter("pass");

        NinGoo.setDsname(database);
        NinGoo.setURL(urlfront + url + urlback);
        NinGoo.setusername(username);
        NinGoo.setpassword("");

        conn = NinGoo.getConnection();
        rs = NinGoo.executeSQL( "SELECT DISTINCT TABLE_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA=" + "'" + database + "'"); 

        String result = null; 

        while (rs.next())
        {
            result = rs.getString("TABLE_NAME");
        }

        out.print(result);
%> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T21:19:51.447

您可能应该只创建一个 Servlet，使用 AJAX 发布到它，然后从查询中发回信息并填充您的选择字段。如果你不想在 JS 中写很多东西，我建议你在 Servlet 中创建带有名称和所有内容的字段，然后将其发送回 AJAX 对象。然后，您可以将返回的内容添加到页面中的元素。

编辑：您永远不应该使用 JSP 来执行您的查询。

# python - python多维布尔数组？

> ID：13614452
> 
> 赞同：2
> 
> 时间：2012-11-28T21:09:29.140
> 
> 标签：python, arrays, boolean

它最多包含 1000 x 1000 x 1000 个元素，这对于 python 字典来说太大了。

使用 dict，大约 30 x 1000 x 1000 个元素，在我的机器上它已经消耗了 2gb 的内存并且一切都被扔了。

任何可以处理其值仅为 True/False 的 3 维数组的模块？我检查了 bitarray [http://pypi.python.org/pypi/bitarray](http://pypi.python.org/pypi/bitarray)，它看起来很合理并且用 C 编码，但是它看起来更像是一个比特流而不是一个数组，因为它只支持一维。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-28T21:13:03.590

numpy 是你的朋友：

```
import numpy as np
a = np.zeros((1000,1000,1000), dtype=bool)
a[1,10,100] = True 
```

尽可能少地占用内存。

### 编辑：

如果您确实需要，您还可以查看集合模块中的 defaultdict 类容器，它不存储默认值的值。但如果不是必须的，请使用 numpy.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T21:12:08.243

一个位数组列表的列表怎么样，也许用一个不错的 API 封装到你自己的类中？

或者，一个 3D NumPy 整数数组，使用您自己的代码将多个布尔值打包/解包到每个整数中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-28T22:01:38.003

`numpy`EnricoGiampieri 已经建议过，如果你可以使用它，你应该这样做。

否则，有两种选择：

正如 NPE 所建议的，锯齿状数组将是`list`s 中的`list`一个。`bitarray`这允许你有锯齿状的边界——例如，每一行可以是不同的宽度，甚至可以独立调整大小：

```
bits3d = [[bitarray.bitarray(1000) for y in range(1000)] for x in range(1000)]
myvalue = bits3d[x][y][z] 
```

或者，正如 Xymotech 所建议的那样，对一维数组进行自己的索引：

```
bits3d = bitarray.bitarray(1000*1000*1000)
myvalue = bits3d[x + y*1000 + z*1000*1000] 
```

无论哪种方式，您可能都希望将其包装在一个类中，因此您可以这样做：

```
bits3d = BitArray(1000, 1000, 1000)
myvalue = bits3d[x, y, z] 
```

这很简单：

```
class Jagged3DBitArray(object):
    def __init__(self, xsize, ysize, zsize):
        self.lll = [[bitarray(zsize) for y in range(ysize)] 
                    for x in range(xsize)]
    def __getitem__(self, key):
        x, y, z = key
        return self.lll[x][y][z]
    def __setitem__(self, key, value):
        x, y, z = key
        self.lll[x][y][z] = value

class Fixed3DBitArray(object):
    def __init__(self, xsize, ysize, zsize):
        self.xsize, self.ysize, self.zsize = xsize, ysize, zsize
        self.b = bitarray(xsize * ysize * zsize)
    def __getitem__(self, key):
        x, y, z = key
        return self.b[x + y * self.ysize + z * self.ysize * self.zsize]
    def __setitem__(self, key, value):
        x, y, z = key
        self.b[x + y * self.ysize + z * self.ysize * self.zsize] = value 
```

当然如果你想要更多的功能（比如切片），你必须多写一点。

锯齿状数组将使用更多内存（毕竟，您有 1M`bitarray`对象和 1K`list`对象的开销），并且可能会慢一些，但这通常不会有太大区别。

重要的决定因素应该是您的数据是否具有锯齿状行本身就是一个错误。如果是这样，请使用第二种解决方案；如果有锯齿状或可调整大小的行可能有用，请使用前者。（请记住`numpy`，如果可能的话，我会使用任何一种解决方案。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-28T21:16:48.063

从 unix 文件权限中获得灵感怎么样？`755`是为所有者读取、写入、执行和为其他所有人读取、执行。这是因为`7`转换为 binary `111`。

因此，您的 1000x1000x1000 bool 数组可能是 1000x1000 的`int`s 列表，其中每个 int 的二进制表示为您提供了一个表示 bool 数组的 1000“位”字符串。

所有这些都应该适合 1GB 的内存

# elasticsearch - 如何在 ElasticSearch 中执行索引查询？

> ID：13614453
> 
> 赞同：11
> 
> 时间：2012-11-28T21:09:34.917
> 
> 标签：elasticsearch

您使用什么 URL 来执行索引查询？

我在此处看到以下内容，但是执行此操作的 URL 是什么？ [http://www.elasticsearch.org/guide/reference/query-dsl/indices-query.html](http://www.elasticsearch.org/guide/reference/query-dsl/indices-query.html)

我知道如何在弹性搜索中查询的唯一方法是使用 URI：

```
http://localhost:9200/myindex 
```

我遇到的问题是我有多个索引与不同的文档 myindex1 myindex2 myindex3

并且我希望能够对 myindex1 和 myindex2（或者只是 myindex2 和 myindex3）执行任何查询

这可能吗？您还可以将索引查询与 QueryDSL 结合起来，例如 match_all 查询或术语查询：

[http://www.elasticsearch.org/guide/reference/query-dsl/terms-query.html](http://www.elasticsearch.org/guide/reference/query-dsl/terms-query.html)

请显示示例 URL 的示例，以及请求正文中的内容（如果可能），以便我了解。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-28T21:46:53.607

你可以试试：

```
 curl http://localhost:9200/myindex1,myindex2/_search?q=* 
```

或者

```
 curl -XPOST http://localhost:9200/myindex1,myindex2/_search -d '{
    // your query here
 }' 
```

是你要找的吗？

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-04-15T06:15:13.283

如果你使用 sense 插件，你可以这样写

```
 POST myindex1/_search
{
"query": {"match_all": {}}
 } 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-12-09T19:12:13.447

你可以通过几种不同的方式来做到这一点。

1) 在字段上使用索引查询`myindex1`和在字段`myindex2`上使用术语查询。`title`

```
curl -XPOST http://localhost:9200/_search -d '{
  "query": {
    "indices": {
      "indices": [
        "myindex1",
        "myindex2"
      ],
      "query": {
        "terms": {
          "title": [
            "foo",
            "bar"
          ]
        }
      }
    }
  }
}' 
```

2) 通过指定要在 URI 中搜索的索引（使用相同的确切术语查询）。

```
curl -XPOST http://localhost:9200/myindex1,myindex2/_search -d '{
  "query": {
    "terms": {
      "title": [
        "cookies",
        "cake"
      ]
    }
  }
}' 
```

是的，您可以在这两个示例中的任何一个中将 terms 查询换成 match_all 查询（或[此处的任何其他查询）。](http://www.elasticsearch.org/guide/reference/query-dsl/)这是在第二个示例中执行 match_all 查询的方法：

```
curl -XPOST http://localhost:9200/myindex1,myindex2/_search -d '{
  "query": {
    "match_all": {}
  }
}' 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-08-24T00:22:01.343

我建议安装 elastic-head 插件。该界面上的第三个选项卡有一个查询生成器。您可以选择一个索引，构建一个查询，然后查看它生成的 dsl 查询。这是了解 dsl 查询语法的快速方法。

[http://mobz.github.io/elasticsearch-head/](http://mobz.github.io/elasticsearch-head/)

# json - 用数组的动态数组计算淘汰赛

> ID：13614458
> 
> 赞同：0
> 
> 时间：2012-11-28T21:10:04.870
> 
> 标签：json, knockout.js

我有一个带有行和列的网格。我还有一个额外的列来跟踪总数。我有一个与此类似的 JSON 数据：

```
{
    GreatGrandfather: {
        GrandFather: {
            Father: [
                {
                    Son: [
                        {
                            Name: "A",
                            Cost: "100" 
                        },
                        {
                            Name: "B",
                            Cost: "1",
                        },
                        {
                            Name: "C",
                           Cost: "50",
                        }
                    ]
                },
                {
                    [
                        Son: {
                             {
                            Name: "A",
                            Cost: "44"    
                        },
                        {
                            Name: "B",
                            Cost: "13",
                        },
                        {
                            Name: "C",
                           Cost: "22",
                        }
                    ]
                }
            ]
        }
    }
} 
```

我可以我有一个动态数量的父亲和儿子。我的问题是如何按名字显示儿子的总数？所以对于这个例子，我总共有 3 个。A (144)、B (14) 和 C(72) 的总和。请帮忙！谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T02:16:37.680

以您拥有的方式组织数据是很难做到的。您要求做的事情在服务器端做起来要容易得多。

如果您重新组织数据以便对每个 Son 的成本求和，这是可行的，因为您可以使用 for 循环来完成。[我在http://jsfiddle.net/photo_tom/p6dW6/15/](http://jsfiddle.net/photo_tom/p6dW6/15/)有一个工作演示。

我将以下 ko.computed 添加到每个 Son 数组对象。

```
var sons = vm.GreatGrandfather.GrandFather.Father();
var i = sons.length;
for (var i1 = 0; i1 < i; i1++) {
    sons[i1].sum = ko.computed({
        read: function() {
            var sonsArray = this.Son();
            var sonsLen = sonsArray.length;
            var sum = 0;
            for (var i2 = 0; i2 < sonsLen; i2++) {
                var costValue = sonsArray[i2].Cost();
                sum += Number(costValue) ;
            }
            return sum;
        },
        owner: sons[i1]
    }); 
```

# ios - 使用滑块面板和 TableView 设计 ViewController

> ID：13614462
> 
> 赞同：0
> 
> 时间：2012-11-28T21:10:37.273
> 
> 标签：ios, user-interface

我想咨询一下我的新 ViewController 的设计方法。

这是一个项目。请原谅外语。幸运的是，文本并不重要。也忽略黄色的东西

![图形用户界面项目](../Images/0202113f869cfbc0633a47d4f1186319.png)

不要打扰这些栏，那些只是导航栏和标签栏。重要的是设计表格和上面的搜索面板的正确方法（“Szukaj”是一个搜索按钮）。

应通过单击导航栏上的放大镜按钮打开搜索面板。它应该从导航栏下方向下滑动并在表格中向下移动，直到它完全打开。搜索面板隐藏在放大镜单击或表格滚动上。它只会在那些情况下向上/向下滑动，不会有“手指滑动”它

构建它的最佳方法是什么？

**我应该在我的 ViewController xib 文件中包含搜索面板，还是使用另一个 xib 在运行时创建和添加它？**向下/向上滑动动画非常重要，我希望它看起来很酷。

如果它从一开始就在 nib 文件中设置为隐藏怎么办？桌子会代替它吗？我可以很容易地为它制作动画吗？

欢迎任何建议

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T21:24:54.197

我不得不说，我们中的许多人可能会找到几种方法来解决这个问题，但我认为我会这样做：

我将为搜索面板创建一个单独的 UIView 并将其放在笔尖的隐藏位置，该位置将位于可见区域的顶部。按下按钮后，我会将其向下滑动（使用简单的 UIView 的动画任务），同时调整 UITableView 的大小，使其顶部与搜索面板的底部对齐，底部保持在同一个位置。

每次有人打开和关闭时创建和销毁搜索面板对我来说似乎效率低下，尤其是它可能在短时间内发生很多次。

# mysql - 修复 MySQL 错误 1064

> ID：13614463
> 
> 赞同：1
> 
> 时间：2012-11-28T21:10:38.397
> 
> 标签：mysql

```
ALTER TABLE  `The Watch Desk Articles Index` ADD  `Subject` VARCHAR CHARACTER SET utf8                 
COLLATE utf8_general_mysql500_ci NOT NULL AFTER `none` ,
ADD FULLTEXT (

`Subject`
)

#1064 - You have an error in your SQL syntax; check the manual that corresponds to your   
MySQL server version for the right syntax to use near 'CHARACTER SET utf8 COLLATE  
utf8_general_mysql500_ci NOT NULL AFTER `none`,  ADD ' at line 1 
```

这个错误要求我改变什么？我正在使用 phpMyAdmin 构建带有选择框的表格列，但我一直收到此错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:27:38.363

至少，您必须指定 varchar 字段的大小，例如最多允许 255 个字符：

```
 ALTER TABLE  `The Watch Desk Articles Index` ADD  `Subject` VARCHAR(255) 
     CHARACTER SET  ...rest of stuff here... 
```

# javascript - Bootstrap 预输入和带引号的字符串

> ID：13614469
> 
> 赞同：1
> 
> 时间：2012-11-28T21:10:48.897
> 
> 标签：javascript, twitter-bootstrap, angularjs

我遇到了[这里提到的同样的问题](https://github.com/twitter/bootstrap/issues/5646)

```
<input type="text" class="span3" style="margin: 0 auto;" data-provide="typeahead" data-items="4" data-source='["Amsterdam", "Maastricht"]' />

does work, but when using double quotes like

<input type="text" class="span3" style="margin: 0 auto;" data-provide="typeahead" data-items="4" data-source="['Amsterdam', 'Maastricht']" />

it won't work. 
```

我实际上将它与 Angular + Angular-ui 一起使用

```
<input type="text" ng-model="mymodel" placeholder="Cities.."
                ui-jq="typeahead" ui-options="{source:cities}"/>

$scope.cities =["D","A"] 
```

如果我将 Typeahead 更改为

```
$scope.cities =['D','A'] 
```

我需要用双引号字符串转换我的数组吗？如何。有没有办法通过[本机 json](https://developer.mozilla.org/en-US/docs/Using_native_JSON)来做到这一点。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T21:46:04.267

我对 Angular-UI 不熟悉，但它几乎听起来像是在替换 ui-options 属性中的 $eval'ed 项目......所以你最终会得到类似的东西`ui-options="{source:["D","A"]}"`

编辑：所以就像你在评论中说的，用单引号括起来。

# php - 克隆 div 并在提交多个表单块 jquery 时从 textarea 附加值

> ID：13614470
> 
> 赞同：0
> 
> 时间：2012-11-28T21:10:51.130
> 
> 标签：php, javascript, jquery, html

我有一组表单，基本上是一个多回复框，当我试图获取每个回复表单的值然后将其附加到每个表单块下的容器时，我能够获取每个表单的值然后克隆它，并将其附加到容器中，但问题是我的脚本没有将值附加到每个块，基本上只附加到第一个块，我创建了一个[http://jsfiddle.net/creativestudio/NgEpS/](http://jsfiddle.net/creativestudio/NgEpS/)

这是我的html：1

```
 <div class="post-container">
            <form class="reply-form">
                <div class="reply-box">
                    <textarea placeholder="Reply box 2..." columns="10" rows="1" name="comment-input"></textarea>
                    <input type="submit" value="Send">
                </div>
                <div class="post-dropdown"></div>
                <div class="post-dropdown-content">
                    <div class="post-dropdown-reply hidden"></div>
                </div>
            </form>
        </div>

        <div class="post-container">
            <form class="reply-form">
                <div class="reply-box">
                    <textarea placeholder="Reply box 3..." columns="10" rows="1" name="comment-input"></textarea>
                    <input type="submit" value="Send">
                </div>
                <div class="post-dropdown"></div>
                <div class="post-dropdown-content">
                    <div class="post-dropdown-reply">1</div>
                    <div class="post-dropdown-reply">2</div>
                    <div class="post-dropdown-reply">3</div>
                    <div class="post-dropdown-reply">4</div>
                </div>
            </form>
        </div>
        ​ 
```

这是我的js：

```
 function gettingReplyVal() {

            $('.reply-form').submit(function(e) {
                var post_clone =    $('.post-dropdown-content').first().clone();

                var textAreaValue = $(this).find('textarea').val();

                $(post_clone).insertBefore(".post-dropdown-content:first").find('.post-dropdown-reply').html(textAreaValue);

                e.preventDefault();

            });
        }

        gettingReplyVal(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T21:22:46.940

看看这个：http: [//jsfiddle.net/NgEpS/1/](http://jsfiddle.net/NgEpS/1/)

更改在此行：

```
 $(post_clone).insertBefore($(this).find(".post-dropdown-content")).find('.post-dropdown-reply').html(textAreaValue); 
```

我将其更改为使用 $(this) 上下文查找 .post-dropdown-content div。你在页面上找到了第一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T00:11:28.010

我想你想要这样的东西：

```
// Find the text that was entered
var textAreaValue = $(this).find('textarea').val();

// Make a new post div, and add the appropriate classes
post = $("<div>").addClass("post-dropdown-reply");

// Set its html
post.html(textAreaValue);

// Add it onto the content list
$(this).find('.post-dropdown-content').prepend(post); 
```

这样做的缺点是您必须从头开始生成一个新的帖子 div，但它的效果要好得多。（见[jsfiddle](http://jsfiddle.net/2SQcn/)）

# json - 将 JSON 日期发布到 MVC 4 操作 webapi

> ID：13614473
> 
> 赞同：1
> 
> 时间：2012-11-28T21:11:05.040
> 
> 标签：json, asp.net-mvc-4

我正在尝试将 JSON 日期发布到 webapi 控制器中的 MVC 4 操作。

时间现在是**22:05 +1 GMT**。

Javascript 说使用：**new Date() - Wed Nov 28 2012 22:05:46 GMT+0100 (Romance Standard Time)**

当使用以下命令发布到服务器时，它会被 JSON 化：**ko.toJSON({date:new Date()}) 得到： "{"date":"2012-11-28T21:06:50.273Z"}"**

这就是我在服务器 21:06 得到的结果，但现在是 22:06。MVC 4 正在使用 JSON.net，所以我错过了什么？

webapi/动作：

```
public JsonResult Post([FromBody]VM vm)
{
     vm.date = 21:06 ????
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T11:17:02.700

服务器上的 DateTime 类型是 UTC，当使用 ToLocalTime() 时，我得到了想要的结果。

# jakarta-ee - 使用java从文件夹文件系统输出存储的文件

> ID：13614475
> 
> 赞同：1
> 
> 时间：2012-11-28T21:11:09.877
> 
> 标签：jakarta-ee, spring-mvc, outputstream

我有这个问题。我使用spring并将附件（doc，pdf，png ...）存储到服务器文件系统中。然后我将文件的路径和名称保存到我的数据库中。现在我怎样才能将此文件作为链接读取到浏览器中？

我想将文件写入网络位置并将该位置提供给浏览器。这是一个好习惯吗？但是可视化后如何删除文件？

我希望这个问题很清楚。

![在此处输入图像描述](../Images/635720d0454c869ac206da90b88b78b7.png)

写我使用：

```
 /** what write for reach temp-file folder (my project name is intranet)
   I thougth TEMP_FOLDER=""/intranet/resources/temp-files/";
   but It doesnt work. ioexception (The system cannot find the path specified)
 */
 final static String TEMP_FOLDER=?????

public static String createTempFile(String originalPathFile,String fileName){
String tempPathFile="";
try {
    InputStream inputStream = new FileInputStream(originalPathFile);
    tempPathFile=TEMP_FOLDER+fileName;
    File tempFile = new File(tempPathFile);

    OutputStream out = new FileOutputStream(tempFile);
    int read = 0;
    byte[] bytes = new byte[1024];
    while ((read = inputStream.read(bytes)) != -1) {
        out.write(bytes, 0, read);
    }
    out.flush();
    out.close();
} catch (IOException ioe) {
     System.out.println("Error while Creating File in Java" + ioe);
}

return tempPathFile;
  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T01:12:14.837

> 现在我怎样才能将此文件作为链接读取到浏览器中？

将以下链接放在您的 JSP 中

```
<a href="<c:url value="/fileDownloadController/downloadFile?filename=xyz.txt"/>" title="Download xyz.txt"></a> 
```

在您的控制器中：

```
@Controller
@RequestMapping("/fileDownloadController")
public class FileDownloadController
{
    @RequestMapping("/downloadFile")
    public void downloadFile( 
        @RequestParam String filename,
        HttpServletResponse response)
    {
        OutputStream outputStream = null;
        InputStream in = null;
        try {
            in = new FileInputStream("/tmp/" + filename); // I assume files are at /tmp
            byte[] buffer = new byte[1024];
            int bytesRead = 0;
            response.setHeader(
                "Content-Disposition",
                "attachment;filename=\"" + filename + "\"");
            outputStream = response.getOutputStream();
            while( 0 < ( bytesRead = in.read( buffer ) ) )
            {
                outputStream.write( buffer, 0, bytesRead );
            }
        }
        finally
        {
            if ( null != in )
            {
                in.close();
            }
        }

    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-07T17:51:35.233

另一个对使用 IOUtils 输入此问题的人有用的答案：

```
IOUtils.copy(new FileInputStream("filename"), outputStream); 
```

# perforce - Perforce（P4V）自定义工具中的多个提示参数？

> ID：13614482
> 
> 赞同：1
> 
> 时间：2012-11-28T21:11:34.523
> 
> 标签：perforce

我可以在 P4V 中创建一个自定义工具来提示用户输入多个参数吗？

该设置的措辞似乎可能 - “提示用户输入参数”，但我尝试将各种分隔符类型的字符放入“描述”字段，但我只得到一个提示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T04:11:29.143

我认为您只能拥有一个，但您的自定义工具当然可以解析出逗号或空格分隔的一组参数。

# php - 没有在命名空间中捕获 PDOException

> ID：13614484
> 
> 赞同：7
> 
> 时间：2012-11-28T21:11:41.910
> 
> 标签：php, database, namespaces, pdo

我不知道如何`PDOException`在下面的代码中捕获，请告诉我在下面的代码中哪里抛出异常？

我有（目录）：

```
 - folder
     -1) b.php
     -2) c.php

 - autoloader 
```

在`b.php`：

```
<?php
namespace folder;
use folder as x;
require_once '../autoload.php';
class b{
    function __construct(){
        print("<p>you are in class b<p/>");
    }
}
$t=new x\c();
?> 
```

并在`c.php`：

```
class c{
    function __construct(){
        print("<p>you are in class c<p/>");

        if(DB_TYPE == 'mysql')  
        $pdoString=DB_TYPE.':dbname='.DB_NAME.';host='.DB_HOST;

        $pdoUsername=DB_USERNAME;
        $pdoPass='1';//DB_PASS; in this line I enter wrong password

    try{
            $this->pdo = new PDO($pdoString, $pdoUsername, $pdoPass);

    }catch(PDOException $e){ //we can't catch exception here!
        die('<p> Error DataBase Connection: '.$e->getMessage()."</p>");
    }
}
}
?> 
```

我输入了错误的密码，我希望在我的`try catch`块中捕获了异常但有这个输出：

```
 you are in class c

 Fatal error: Uncaught exception 'PDOException' with message 'SQLSTATE[HY000] [1045] Access denied for user 'root'@'localhost' (using password: YES)' in C:\xampp\htdocs\TEST\folder\c.php:17 Stack trace: #0 C:\xampp\htdocs\TEST\folder\c.php(17): PDO->__construct('mysql:dbname=kn...', 'root', '1') #1 C:\xampp\htdocs\TEST\folder\b.php(10): folder\c->__construct() #2 {main} thrown in C:\xampp\htdocs\TEST\folder\c.php on line 17 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-28T21:13:45.780

你在一个命名空间中。因此，PHP 将寻找命名空间类`folder\PDOException`并尝试捕获它（但失败）。

要使用全局命名空间，只需在类名后面添加一个反斜杠：

```
catch (\PDOException $e) { 
```

# prolog - ProLog 列表显示结果

> ID：13614488
> 
> 赞同：0
> 
> 时间：2012-11-28T21:11:52.183
> 
> 标签：prolog

大家好，我是 prolog 的新手，我正在尝试完成我的第一个项目。我有一个带有 3 个参数的家谱（family/3）（人（爸爸），人（妈妈），。列出所有孩子） .目前我的知识库中有 3 个家庭。我想要完成的是显示有 3 个以上孩子的母亲的名字。任何帮助都会很棒。这是到目前为止的代码。

```
family(person(tom,right,date(17,May,1950),works(mathematician)),person(ann,right,date(29,May,1951),unemployed),
[person(pat,right,date(5,May,1983),unemployed),person(max,right,date(15,May,1973),unemployed),[]]).

family(person(nick,wellbard,date(15,September,1954),works(electrician)),person(cathrine,wellbard,date(11,March,1957),unemployed),
[person(john,wellbard,date(15,May,1985),works(musician)),person(mike,wellbard,date(25,May,1989),unemployed),
person(chloe,wellbard,date(13,October,1991),unemployed),[]]).

family(person(john,brock,date(17,January,1951),works(programmer)),person(mary,brock,date(19,March,1952),works(teacher)),
[person(tony,brock,date(20,May,1975),unemployed),person(sasha,brock,date(1,April,1979),unemployed),
person(josh,brock,date(29,April,1982),unemployed),[]]). 
```

我在想这样的事情，`family(_,X,_):-[X,Y,Z|]`这样我就可以显示至少有 3 个孩子的母亲的名字。请原谅我在 ProLog 的任何错误，任何帮助或指导都会很棒，谢谢 :)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T22:20:40.567

你在轨道上，或多或少......试试

```
mother_with_at_least_3_sons(M) :-
   family(_,M,[_,_,_|_]). 
```

**编辑**如果您不能更改子列表，删除无用的 [] 最后，该规则实际上应该是

```
mother_with_at_least_3_sons(M) :-
   family(_,M,[_,_,_,_|_]). 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T22:36:39.253

这是我对你的问题的回答。

**如果您找到一个有爸爸，妈妈，孩子的家庭，我们会“说”序言**

**% 其中 Kids 是一个包含 3 个以上元素的列表（通过 length 获得）**

**% 然后给我妈妈的名字和姓氏**

```
more_than_three_children(MotherName,MotherSurname) :- family(Dad,Mom,Kids),
                                                      length(Kids,NumberOfKids),
                                                      NumberOfKids > 3,
                                                      Mom=person(MotherName,MotherSurname,_,_). 
```

**% 为了找到所有的母亲，我们可以使用 findall 谓词**

**% 第一个参数是 OBJECT ，我们使用 GOAL 创建对象的实例**

**% 第二个参数是目标。如果prolog“找到”一些满足该目标的结构**

**% 它将把它放在列表中（这是第三个参数）**

```
mother_list(List) :- findall((MotherName,MotherSurname),more_than_three_children(MotherName,MotherSurname),List). 
```

# perl - 使用 Perl 的 Dancer 在子进程中分叉运行代码

> ID：13614498
> 
> 赞同：1
> 
> 时间：2012-11-28T21:12:15.897
> 
> 标签：perl, perl-module, fork, dancer

我在 perl 中有一个 Dancer 应用程序来处理获取/发布请求。

我的示例路线之一如下：

```
post '/handle_data' => sub {

    # perform some calculations
    ...
    # store some data
    ...
    # do some long running tasks
    ...
}; 
```

我的问题：有没有一种简单的方法可以在另一个进程中执行长时间运行的任务而不阻塞请求？

我已经`fork and return`在父进程中尝试过，`exit`在孩子长时间运行任务之后，但这一切似乎都阻止了响应发送，直到孩子完成。

任何帮助表示赞赏。

**编辑：**

我最终切换到一个成熟的作业服务器，特别是[Gearman的 perl 版本](http://gearman.org/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T21:20:24.380

分叉和返回似乎对我有用。

我试过：

```
#!/usr/bin/perl

use Dancer;

get '/' => sub {
    fork and return "Content!\n";

    sleep 10; # do your actual work here
    warn "Child process done\n";
    exit;
};

dance; 
```

通过独立服务器或通过 plackup/Starman 运行它，按预期工作 - “内容！\n”立即返回到用户的浏览器，请求结束；分叉的进程挂起十秒钟睡眠，然后发出警告（在终端上可见）然后退出。

# java - Netbeans 中的可读目录，但从 JAR 文件运行时不可读

> ID：13614499
> 
> 赞同：1
> 
> 时间：2012-11-28T21:12:17.163
> 
> 标签：java, netbeans, jar

我已经能够在 Netbeans 和 JAR 文件（例如 ImageIcons）中加载资源，但是今天从 JAR 文件运行我的程序时，我无法从同一目录“读取”。我想列出类路径目录中的目录和文件，但是当我从 JAR 文件运行程序时，目录变得不可读。它在 Netbeans 中运行良好。

`tileDirectory = new File(TileDirectoryLister.class.getResource("/resources/images/tiles").getPath());`

 ````
 jta.append("\nThe class path for the tile directory is:"
            + "\n\t" + tileDirectory.getPath());

    jta.append("\nThe tile directory is readable: " + tileDirectory.canRead()); 
````  `从 Netbeans 运行时，它打印为 true；从 JAR 文件运行时，它会打印错误。**为什么从 JAR 文件运行时`canRead`打印`false`？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:56:04.600

File 表示文件系统上的路径。您的图标位于 jar 文件中。您不能使用文件来访问它们。

要访问 jar 文件中的某些资源，只需使用

```
SomeClass.class.getResourceAsStream("/resources/images/tiles/SomeIcon.png"); 
```

获取 InputStream，或

```
SomeClass.class.getResource("/resources/images/tiles/SomeIcon.png"); 
```

获取 URL。`

# php - strtotime 返回 false

> ID：13614500
> 
> 赞同：10
> 
> 时间：2012-11-28T21:12:22.810
> 
> 标签：php

我有看起来像这样的日期字符串：

```
"2012 28 Nov 21:00 CET" 
```

`strtotime("2012 28 Nov 21:00 CET")`返回假。

有什么方法可以将此字符串转换为日期对象，还是我需要以不同的方式对其进行格式化？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-11-28T21:22:51.917

`2012 28 Nov 21:00 CET`是奇怪的日期/时间格式。YDM? 你从哪里得到的？

无论如何，DateTime 对象有一个方法`createFromFormat`可以更好地解析：

```
$dt = DateTime::createFromFormat("Y d M H:i T", '2012 28 Nov 21:00 CET');
$ts = $dt->getTimestamp();
echo $ts; // 1354132800 
```

在这里试试：http: [//codepad.viper-7.com/NfAmcw](http://codepad.viper-7.com/NfAmcw)

`strtotime`需要一个“英文文本日期时间” [（根据手册](http://php.net/manual/en/function.strtotime.php)），而 YDM 不是。任何时候都`strtotime`返回 false，它根本不理解您的字符串，这在此应用程序中是预期的。手册页上的注释处理了这个问题：

> 笔记：
> 
> m/d/y 或 dmy 格式的日期通过查看各个组件之间的分隔符来消除歧义：如果分隔符是斜杠 (/)，则假定为美式 m/d/y；而如果分隔符是破折号 (-) 或点 (.)，则假定为欧洲 dmy 格式。
> 
> 为避免潜在的歧义，最好尽可能使用 ISO 8601 (YYYY-MM-DD) 日期或 DateTime::createFromFormat()。

同样，`DateTime`它是与日期或时间进行任何交互的出色工具。

**文档**

*   `DateTime`类- [http://www.php.net/manual/en/class.datetime.php](http://www.php.net/manual/en/class.datetime.php)
*   `DateTime::createFromFormat`- [http://www.php.net/manual/en/datetime.createfromformat.php](http://www.php.net/manual/en/datetime.createfromformat.php)
*   `strtotime`- [http://php.net/manual/en/function.strtotime.php](http://php.net/manual/en/function.strtotime.php)
*   `date`（也列出日期格式字符串） - [http://php.net/manual/en/function.date.php](http://php.net/manual/en/function.date.php)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T21:20:47.333

[strtotime](http://www.php.net/manual/en/function.strtotime.php)不会创建日期对象，它只是尝试解析您的输入并返回一个 unix 时间戳。

您可以在这里找到有效的格式：[http ://www.php.net/manual/en/datetime.formats.php](http://www.php.net/manual/en/datetime.formats.php)

```
echo strtotime("2012-11-28T21:00:00+01:00"); 
```

会输出`1354132800`

要创建一个 php [DateTime](http://www.php.net/manual/de/class.datetime.php)对象，您可以这样做：

```
$date = new DateTime('2012-11-28T21:00:00+01:00');
echo $date->format('Y-m-d H:i:s'); 
```

# c# - 错误：并非所有代码路径都返回值

> ID：13614503
> 
> 赞同：-7
> 
> 时间：2012-11-28T21:12:32.580
> 
> 标签：c#

```
public Boolean DetectPlayerAndGround1Collision2(/*snip*/)
{            
    if (/*snip*/)
    {   
        if (/*snip*/) { return true; }
        else if (/*snip*/) { return true; }
        else if ((/*snip*/) { return true; }
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-28T21:15:23.643

在 else 情况下您未能返回值：

```
public Boolean DetectPlayerAndGround1Collision2(/*snip*/)
{            
    if (/*snip*/)
    {   
        if (/*snip*/) { return true; }
        else if (/*snip*/) { return true; }
        else if ((/*snip*/) { return true; }
        else{return false;}
    }
    else
    {
       return false;
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-28T21:18:20.997

我建议执行以下操作：

```
public Boolean DetectPlayerAndGround1Collision2(/*snip*/)
{
    bool result = false;            
    if (/*snip*/)
    {   
        if (/*snip*/) { result = true; }
        else if (/*snip*/) { result = true; }
        else if (/*snip*/) { result =true; }
    }
    return result;
} 
```

使用单个 return 语句可以更轻松地跟踪正在发生的事情，并确保它在任何条件语句之外并在声明时进行初始化，以确保您始终返回一个值。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-28T21:25:44.710

以下：

```
if (A)
{   
    if (B) { return true; }
    else if (C) { return true; }
    else if (D) { return true; }
} 
```

相当于：

```
return A && (B || C || D); 
```

（假设之前没有返回任何值的任何情况都意味着返回 false。）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-28T21:16:53.287

您并不总是返回一个值：

```
 if (playerPositionM.Y <= groundPositionM.Y + groundM.Height && playerPositionM.Y > groundPositionM.Y)
    {   
        if (playerPositionM.X < groundPositionM.X && (playerPositionM.X + playerM.Width < groundPositionM.X + groundM.Width && playerPositionM.X + playerM.Width > groundPositionM.X)) 
        { 
            return true; 
        }
        else if (playerPositionM.X + playerM.Width > groundPositionM.X + groundM.Width && (playerPositionM.X < groundPositionM.X + groundM.Width && playerPositionM.X > groundPositionM.X))
        { 
            return true; 
        }
        else if ((playerPositionM.X > groundPositionM.X && playerPositionM.X < groundPositionM.X + groundM.Width) && (playerPositionM.X + playerM.Width < groundPositionM.X + groundM.Width && playerPositionM.X + playerM.Width > groundPositionM.X)) 
        { 
            return true; 
        }
        else
        {
            // You need to return a value here:
        }
    }
    else
    {
        // You need to return a value here:
    }

etc! 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-11-28T21:14:45.110

如果没有`else`作为其余条件的全部内容，您需要添加`return false;`以下逻辑检查。

```
public Boolean DetectPlayerAndGround1Collision2(/*snip*/)
{            
    if (/*snip*/)
    {   
        if (/*snip*/) { return true; }
        else if (/*snip*/) { return true; }
        else if (/*snip*/) { return true; }
    }
    return false; 
} 
```

# database - 如何在活动服务器页面上实现分页（ASP 经典）

> ID：13614504
> 
> 赞同：3
> 
> 时间：2012-11-28T21:12:31.203
> 
> 标签：database, asp-classic, recordset

我已经完成了一个 Active Server Page。它在门厅显示器上运行并显示会议。我将显示会议限制为 6 个。我的数据库中有 15 个会议。但门厅一次只能显示 6 个会议。为了显示其余的会议，我想实现分页，但我不知道如何。

分页应该自动发生。例如：显示前 6 次会议 10 秒，然后显示下 6 次会议 10 秒，然后显示最后 3 次会议 10 秒，然后再次显示前 6 次会议，依此类推。

任何人都可以帮助我吗？我不知道该怎么做。谢谢！

```
 <%
    set rs=Server.CreateObject("ADODB.recordset")
    set rsRaum=Server.CreateObject("ADODB.recordset")

    rs.Open "select distinct buchung_id, von, bis, abteilung, veranstalter, THEMA, THEMA_ENABLED " & _
            "  from RESERVIERUNGRAUM r  " & _
            "      ,BUCHUNG b  " & _
            " where r.BUCHUNG_ID = b.ID " & _
            "   and von >= convert(date, getdate(), 4) " & _
            "   and von < convert(date, dateadd(day,1, GETDATE()), 4) " & _
            "   and BIS >= getdate() " & _
            "   and STORNO is null  " & _
            " order by von, bis" _
           ,objConn 

    lineMax = 6
    lineCount = 1
    do until rs.EOF

      rsRaum.open "select DISPLAY_ENABLED from Buchung where ID = " & rs("buchung_id"), objConn
                displayanzeige = rsRaum("DISPLAY_ENABLED")
      rsRaum.close

      rsRaum.open      "select distinct g.BEZEICHNUNG " & _
                       "from GEBAEUDE g, ETAGE e, RAUM r " & _
                       "Where g.ID = e.GEBAEUDE_ID and e.GEBAEUDE_ID = r.GEBAEUDE_ID and r.ID = " & raum_id, objConn

                       GebaeudeBezeichnung = rsRaum("BEZEICHNUNG")

      rsRaum.close

      rsRaum.open "select bezeichnung from Raum where ID = " & raum_id, objConn

          raumname = rsRaum("bezeichnung")

      rsRaum.close

      If lineCount > lineMax Then
        exit do
      End If 

      if ucase(displayanzeige) = "Y" or isnull(displayanzeige) then
    %> 
```

'

```
<tr "margin-bottom:100px" height="70" valign="top">
    <td style="overflow:hidden;" class="<% =color%>"><% =thema %></td>
    <td class="<% =color%>"><% =Hinweistext %></td>
    <td align="center"; class="<% =color%>"><% =FormatDateTime( rs("von"), 4)%></td>
    <td align="center"; class="<% =color%>"><% =FormatDateTime( rs("bis"), 4) %></td>
    <td align="center"; class="<% =color%>"><% =GebaeudeBezeichnung %><br></td>
    <td align="center"; class="<% =color%>"><% =raumname %><br></td>
  </tr> 
```

'

```
<%  

rs.moveNext

loop
rs.close 
%> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-06T17:22:23.270

你需要做几件事：

1.  使您的脚本采用 GET 参数，该参数指定要显示的“页面”。就像是：

    ```
    dim page = Request.QueryString("page")
    dim next_page = page + 1
    dim num_pages = [ you'll want to get this from your database table ] 
    ```

2.  修改您的数据库查询以适当地使用新的变量页面

3.  在页面上生成一些 javascript，这将导致浏览器在 10 秒后为下一页加载新的 URL。如果它超过总页数，则返回开始。

    ```
    <script type="text/javascript">
    function doNextPage(){
      window.location = "/my/display.asp?page=<% Response.Write next_page mod num_pages %>";
    }
    function doNextPageDelayed(){
      setTimeout("doNextPage()", 10000);
    }
    </script> 
    ```

4.  您还需要使函数“doNextPageDelayed”实际运行。为此，请在 HTML 的 body 标记中插入一些代码。

    ```
    <body onload="doNextPageDelayed()">
    </body> 
    ```

我发现此链接有助于记住如何导致延迟运行 javascript 函数： [http://www.geekpedia.com/KB55_How-do-I-make-a-JavaScript-function-wait-before-executing-(睡眠或延迟）.html](http://www.geekpedia.com/KB55_How-do-I-make-a-JavaScript-function-wait-before-executing-(sleep-or-delay).html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-06T17:23:10.063

如果您看到一个工作示例会更好......整个页面。只是这里缩进的代码太多了。见附件...[分页](http://www.artistscope.com/download/custom/pagination.zip)

此示例还包括可排序的列和行删除以及选择页面上所有行的选项。

# java - 如何在 Java 中将字符串转换为 SOAPMessage？

> ID：13614508
> 
> 赞同：27
> 
> 时间：2012-11-28T21:12:49.600
> 
> 标签：java, string, soap

我想知道有没有办法将字符串转换为*SOAPMessage*？

让我说我有一个字符串如下：

```
String send = "<soap:Envelope xmlns:mrns0=\"http://sdp.SOMETHING.com/mapping/TSO\" xmlns:sdp=\"http://sdp.SOMETHING.com.tr/mapping/generated\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\">"
        + "<soap:Header>"
        + "<sdp:token>"
        + "<sdp:sessionId>" + sessionId + "</sdp:sessionId>"
        + "</sdp:token>"
        + "<sdp:transaction-list>"
        + "<sdp:transaction-id>" + 11 + "</sdp:transaction-id>"
        + "</sdp:transaction-list>"
        + "</soap:Header>"
        + "<soap:Body>"
        + "<sdp:SendSMSInput>"
        + "<sdp:EXPIRY_DATE>" + extime + "</sdp:EXPIRY_DATE>"
        + "<sdp:MESSAGE_CLASS>0</sdp:MESSAGE_CLASS>"
        + "<sdp:S_DATE>" + time + "</sdp:S_DATE>"
        + "<sdp:SHORT_NUMBER>1905</sdp:SHORT_NUMBER>"
        + "<sdp:SRC_MSISDN>" + numSend + "</sdp:SRC_MSISDN>"
        + "<sdp:TO_RECEIVERS>"
        + "<sdp:msisdn>" + numSend + "</sdp:msisdn>"
        + "</sdp:TO_RECEIVERS>"
        + "<sdp:MESSAGE_BODY>"
        + "<sdp:message>Message body here.</sdp:message>"
        + "</sdp:MESSAGE_BODY>"
        + "</sdp:SendSMSInput>"
        + "</soap:Body>"
        + "</soap:Envelope>"; 
```

如何转换字符串？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-11-28T21:20:02.167

将 String 转换为输入流，然后将其读入 SOAP 消息工厂。

```
InputStream is = new ByteArrayInputStream(send.getBytes());
SOAPMessage request = MessageFactory.newInstance().createMessage(null, is); 
```

[您可以在此处阅读有关如何执行此操作的信息。](http://docs.oracle.com/javaee/5/api/javax/xml/soap/MessageFactory.html#createMessage%28javax.xml.soap.MimeHeaders,%20java.io.InputStream%29)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-08T14:58:31.213

这对我有用：

```
SOAPMessage sm = MessageFactory.newInstance(SOAPConstants.SOAP_1_2_PROTOCOL).createMessage(new MimeHeaders(), is); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-06-06T17:55:45.730

我测得的进`SOAPMessage`给`SAXSource`速度比公认答案中使用的内部 SAAJ 解析实现快 50% 左右：

```
SOAPMessage message = messageFactory.createMessage();
message.getSOAPPart().setContent(new SAXSource(new InputSource(new StringReader(send)))); 
```

以下是测试各种 XML 解析源和工厂缓存影响的基准测试：

```
/*
Benchmark (jdk1.8.0_202 32-bit)                                       Mode  Cnt     Score     Error  Units
SoapMessageBenchmark.testCreateMessage                               thrpt  100  4156,685 ? 215,571  ops/s
SoapMessageBenchmark.testCreateMessageWithMessageFactoryNotCached    thrpt  100  3709,299 ? 115,495  ops/s
SoapMessageBenchmark.testSetContentDom                               thrpt  100  5935,972 ? 215,389  ops/s
SoapMessageBenchmark.testSetContentDomWithDocumentBuilderNotCached   thrpt  100  3433,539 ? 218,889  ops/s
SoapMessageBenchmark.testSetContentSax                               thrpt  100  6693,179 ? 319,581  ops/s
SoapMessageBenchmark.testSetContentSaxAndExtractContentAsDocument    thrpt  100  4109,924 ? 229,987  ops/s
SoapMessageBenchmark.testSetContentStax                              thrpt  100  5126,822 ? 249,648  ops/s
SoapMessageBenchmark.testSetContentStaxWithXmlInputFactoryNotCached  thrpt  100  4630,860 ? 235,773  ops/s
*/

package org.sample;

import org.openjdk.jmh.annotations.Benchmark;
import org.openjdk.jmh.annotations.BenchmarkMode;
import org.openjdk.jmh.annotations.Measurement;
import org.openjdk.jmh.annotations.Mode;
import org.openjdk.jmh.annotations.Scope;
import org.openjdk.jmh.annotations.State;
import org.openjdk.jmh.annotations.Timeout;
import org.openjdk.jmh.annotations.Warmup;
import org.w3c.dom.Document;
import org.xml.sax.InputSource;
import org.xml.sax.SAXException;

import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;
import javax.xml.parsers.ParserConfigurationException;
import javax.xml.soap.MessageFactory;
import javax.xml.soap.SOAPBody;
import javax.xml.soap.SOAPConstants;
import javax.xml.soap.SOAPException;
import javax.xml.soap.SOAPMessage;
import javax.xml.stream.XMLInputFactory;
import javax.xml.stream.XMLStreamException;
import javax.xml.stream.XMLStreamReader;
import javax.xml.stream.util.StreamReaderDelegate;
import javax.xml.transform.dom.DOMSource;
import javax.xml.transform.sax.SAXSource;
import javax.xml.transform.stax.StAXSource;
import java.io.ByteArrayInputStream;
import java.io.IOException;
import java.io.InputStream;
import java.util.concurrent.TimeUnit;

@BenchmarkMode(Mode.Throughput)
@Warmup(iterations = 10, time = 100, timeUnit = TimeUnit.MILLISECONDS)
@Measurement(iterations = 10, time = 100, timeUnit = TimeUnit.MILLISECONDS)
@Timeout(time = 10)
public class SoapMessageBenchmark {

    private static MessageFactory messageFactory;
    private static DocumentBuilder documentBuilder;
    private static XMLInputFactory xmlInputFactory;

    static {
        try {
            documentBuilder = DocumentBuilderFactory.newInstance().newDocumentBuilder();
            messageFactory = MessageFactory.newInstance(SOAPConstants.SOAP_1_1_PROTOCOL);
            xmlInputFactory = XMLInputFactory.newInstance();
        } catch (SOAPException | ParserConfigurationException e) {
            throw new IllegalStateException(e);
        }
    }

    @State(Scope.Benchmark)
    public static class S {
        byte[] bytes = ("<soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\">\n" +
                                "  <soap:Header>\n" +
                                "    <ResponseHeader xmlns=\"https://www.google.com/apis/ads/publisher/v201905\">\n" +
                                "      <requestId>xxxxxxxxxxxxxxxxxxxx</requestId>\n" +
                                "      <responseTime>1063</responseTime>\n" +
                                "    </ResponseHeader>\n" +
                                "  </soap:Header>\n" +
                                "  <soap:Body>\n" +
                                "    <getAdUnitsByStatementResponse xmlns=\"https://www.google.com/apis/ads/publisher/v201905\">\n" +
                                "      <rval>\n" +
                                "        <totalResultSetSize>1</totalResultSetSize>\n" +
                                "        <startIndex>0</startIndex>\n" +
                                "        <results>\n" +
                                "          <id>2372</id>\n" +
                                "          <name>RootAdUnit</name>\n" +
                                "          <description></description>\n" +
                                "          <targetWindow>TOP</targetWindow>\n" +
                                "          <status>ACTIVE</status>\n" +
                                "          <adUnitCode>1002372</adUnitCode>\n" +
                                "          <inheritedAdSenseSettings>\n" +
                                "            <value>\n" +
                                "              <adSenseEnabled>true</adSenseEnabled>\n" +
                                "              <borderColor>FFFFFF</borderColor>\n" +
                                "              <titleColor>0000FF</titleColor>\n" +
                                "              <backgroundColor>FFFFFF</backgroundColor>\n" +
                                "              <textColor>000000</textColor>\n" +
                                "              <urlColor>008000</urlColor>\n" +
                                "              <adType>TEXT_AND_IMAGE</adType>\n" +
                                "              <borderStyle>DEFAULT</borderStyle>\n" +
                                "              <fontFamily>DEFAULT</fontFamily>\n" +
                                "              <fontSize>DEFAULT</fontSize>\n" +
                                "            </value>\n" +
                                "          </inheritedAdSenseSettings>\n" +
                                "        </results>\n" +
                                "      </rval>\n" +
                                "    </getAdUnitsByStatementResponse>\n" +
                                "  </soap:Body>\n" +
                                "</soap:Envelope>").getBytes();
    }

    @Benchmark
    public SOAPBody testCreateMessage(S s) throws SOAPException, IOException {
        try (InputStream inputStream = new ByteArrayInputStream(s.bytes)) {
            SOAPMessage message = messageFactory.createMessage(null, inputStream);
            return message.getSOAPBody();
        }
    }

    @Benchmark
    public SOAPBody testCreateMessageWithMessageFactoryNotCached(S s) throws SOAPException, IOException {
        MessageFactory messageFactory = MessageFactory.newInstance(SOAPConstants.SOAP_1_1_PROTOCOL);
        try (InputStream inputStream = new ByteArrayInputStream(s.bytes)) {
            SOAPMessage message = messageFactory.createMessage(null, inputStream);
            return message.getSOAPBody();
        }
    }

    @Benchmark
    public SOAPBody testSetContentDom(S s) throws SOAPException, IOException, SAXException {
        try (InputStream inputStream = new ByteArrayInputStream(s.bytes)) {
            Document document = documentBuilder.parse(inputStream);
            SOAPMessage message = messageFactory.createMessage();
            message.getSOAPPart().setContent(new DOMSource(document));
            return message.getSOAPBody();
        }
    }

    @Benchmark
    public SOAPBody testSetContentDomWithDocumentBuilderNotCached(S s) throws SOAPException, IOException, SAXException, ParserConfigurationException {
        DocumentBuilder documentBuilder = DocumentBuilderFactory.newInstance().newDocumentBuilder();
        try (InputStream inputStream = new ByteArrayInputStream(s.bytes)) {
            Document document = documentBuilder.parse(inputStream);
            SOAPMessage message = messageFactory.createMessage();
            message.getSOAPPart().setContent(new DOMSource(document));
            return message.getSOAPBody();
        }
    }

    @Benchmark
    public SOAPBody testSetContentSax(S s) throws SOAPException, IOException {
        try (InputStream inputStream = new ByteArrayInputStream(s.bytes)) {
            SOAPMessage message = messageFactory.createMessage();
            message.getSOAPPart().setContent(new SAXSource(new InputSource(inputStream)));
            return message.getSOAPBody();
        }
    }

    @Benchmark
    public Document testSetContentSaxAndExtractContentAsDocument(S s) throws SOAPException, IOException {
        try (InputStream inputStream = new ByteArrayInputStream(s.bytes)) {
            SOAPMessage message = messageFactory.createMessage();
            message.getSOAPPart().setContent(new SAXSource(new InputSource(inputStream)));
            return message.getSOAPBody().extractContentAsDocument();
        }
    }

    @Benchmark
    public SOAPBody testSetContentStax(S s) throws SOAPException, IOException, XMLStreamException {
        try (InputStream inputStream = new ByteArrayInputStream(s.bytes)) {
            XMLStreamReader xmlStreamReader = new StreamReaderDelegate(xmlInputFactory.createXMLStreamReader(inputStream)) {
                @Override
                public String getVersion() {
                    return "1.1";
                }
            };
            SOAPMessage message = messageFactory.createMessage();
            message.getSOAPPart().setContent(new StAXSource(xmlStreamReader));
            return message.getSOAPBody();
        }
    }

    @Benchmark
    public SOAPBody testSetContentStaxWithXmlInputFactoryNotCached(S s) throws SOAPException, IOException, XMLStreamException {
        XMLInputFactory xmlInputFactory = XMLInputFactory.newInstance();
        try (InputStream inputStream = new ByteArrayInputStream(s.bytes)) {
            XMLStreamReader xmlStreamReader = new StreamReaderDelegate(xmlInputFactory.createXMLStreamReader(inputStream)) {
                @Override
                public String getVersion() {
                    return "1.1";
                }
            };
            SOAPMessage message = messageFactory.createMessage();
            message.getSOAPPart().setContent(new StAXSource(xmlStreamReader));
            return message.getSOAPBody();
        }
    }

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-08T08:48:21.570

代替：

```
System.out.println(response.getContentDescription()); 
```

得到响应后将其替换为以下行：

```
response.writeTo(System.out); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-15T18:08:42.533

这样您就可以从文件中读取：

```
byte[] encoded = Files.readAllBytes(Paths.get("C:/resources/soap/RequestFileReply.xml"));
InputStream bStream = new ByteArrayInputStream(encoded);
SOAPMessage request = MessageFactory.newInstance().createMessage(null, bStream);
SOAPBody body = request.getSOAPBody(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-09-07T05:37:35.517

我只想在 Stack-Overflow 中分享我的代码片段，这可能会对某些人有所帮助。

> 带注释的 SOAP-XML 字符串

```
static boolean OMIT_XML_DECLARATION = true;
static String soapXML = "<env:Envelope xmlns:env=\"http://www.w3.org/2003/05/soap-envelope\">"
            + "<env:Body> "
            + "<product version=\"11.1.2.4.0\">  <!-- Data XML -->"
            + "<name>API Gateway</name> <company>Oracle</company> <description>SOA Security and Management</description>"
            + "</product> </env:Body> </env:Envelope>"; 
```

> 将 SOAP-XML 字符串转换为 SOAP-Message 对象

```
public SOAPMessage getSoapMessage(String xmlData, boolean isToIgnoringComments) throws Exception {
    if (isToIgnoringComments) {
        Document doc = getDocument(xmlData); // SOAP MSG removing comment elements
        xmlData = toStringDocument(doc);
    }

    ByteArrayInputStream byteArrayInputStream = new ByteArrayInputStream(xmlData.getBytes());
    MimeHeaders mimeHeaders = new MimeHeaders();
    SOAPMessage message = MessageFactory.newInstance(SOAPConstants.SOAP_1_2_PROTOCOL).createMessage(mimeHeaders, byteArrayInputStream);
    return message;
}
public static Document getDocument(String xmlData) throws Exception {
    DocumentBuilderFactory dbFactory = DocumentBuilderFactory.newInstance();
    dbFactory.setNamespaceAware(true);
    dbFactory.setIgnoringComments(true);
    DocumentBuilder dBuilder = dbFactory.newDocumentBuilder();
        InputSource ips = new org.xml.sax.InputSource(new StringReader(xmlData));
        Document doc = dBuilder.parse(ips);
    return doc;
} 
```

> 将 SOAP-Message 对象转换为 SOPA-XML 字符串

```
public static String toStringDocument(Document doc) throws TransformerException {
    StringWriter sw = new StringWriter();
    TransformerFactory tf = TransformerFactory.newInstance();
    Transformer transformer = tf.newTransformer();
    if (OMIT_XML_DECLARATION) {
        transformer.setOutputProperty(OutputKeys.OMIT_XML_DECLARATION, "yes");
    } else {
        transformer.setOutputProperty(OutputKeys.OMIT_XML_DECLARATION, "no");
    }
    transformer.setOutputProperty(OutputKeys.METHOD, "xml");
    transformer.setOutputProperty(OutputKeys.INDENT, "yes");
    transformer.setOutputProperty(OutputKeys.ENCODING, "UTF-8");

    transformer.transform(new DOMSource(doc), new StreamResult(sw));
    return sw.toString(); // sw.getBuffer().toString();
} 
```

完整示例：

```
public class SOAPOperations {

    // dependency: groupId:xml-security, artifactId:xmlsec, version:1.3.0
    // dependency: groupId:xalan, artifactId:xalan, version:2.7.1
    public static void main(String[] args) throws Exception {

        SOAPOperations obj = new SOAPOperations();

        SOAPMessage soapMessage = obj.getSoapMessage(soapXML, true);
        System.out.println("SOAP Message Object:\n"+soapMessage);

        String soapMessageStr = obj.getSoapMessage(soapMessage);
        System.out.println("SOAP Message String:\n"+soapMessageStr);

        String soapBodyStr = obj.getSoapBody(soapMessage);
        System.out.println("SOAP Body String:\n"+soapBodyStr);
    }

    public String getSoapBody(SOAPMessage soapMessage) throws Exception {
        SOAPBody soapEnv = soapMessage.getSOAPBody();
        Document ownerDocument = soapEnv.extractContentAsDocument();
        String stringDocument = toStringDocument(ownerDocument);
        return stringDocument;
    }
    public String getSoapMessage(SOAPMessage soapMessage) throws Exception {
        SOAPEnvelope soapEnv = soapMessage.getSOAPPart().getEnvelope();
        Document ownerDocument = soapEnv.getOwnerDocument();
        String stringDocument = toStringDocument(ownerDocument);
        return stringDocument;
    }
} 
```

* * *

@See SOAP 链接

*   [Oracle - 使用 JAX-WS 创建简单的 Web 服务和客户端](https://docs.oracle.com/cd/E19316-01/819-3669/6n5sg7bi9/index.html)
*   [SOAP XML WS-Security 签名验证](https://stackoverflow.com/q/63615930/5081877)

# php - PHP函数在数组中查找某些值，然后执行代码

> ID：13614509
> 
> 赞同：0
> 
> 时间：2012-11-28T21:12:55.567
> 
> 标签：php

所以我试图检查这个数组是否有下划线。我不确定我是否使用了正确的功能来执行此操作。任何输入将不胜感激。

更多信息，如果数组确实有下划线，我希望它运行下面的代码。这段代码分开并给了我我想要的属性。我还检查它是否有和 S 然后运行一些代码。这些都是查询的输出，然后在最后进行查询。

```
 if (count($h)==3){
           if (strpos($h[2], '_') !== false)  // test to see if this is a weird quiestion ID with an underscore
               {
                    if (strpos($h[2], 'S') !== false)
                    {
                     // it has an S
                     $underscoreLocation = strpos($h[2], '_');
                     $parent = substr($h[2], 0, $underscoreLocation - 6); // start at beginning and go to S
                     $title = substr($h[2], $underscoreLocation - 5, 5);
                     $questions = "select question from lime_questions where sid =".$h[0]." and gid =".$h[1]." and parent_qid =".$parent." and title =".$title.";";
                    }
                    else
                    {
                     // there is no S
                     $underscoreLocation = strpos($h[2], '_');
                     $parent = substr($h[2], 0, $underscoreLocation - 2);
                     $title = substr($h[2], $underscoreLocation - 1, 1);
                     $questions = "select question from lime_questions where sid =".$h[0]." and gid =".$h[1]." and parent_qid =".$parent." and title =".$title.";";
                    }    
               }

           else
           {
            $questions = "select question from lime_questions where sid =".$h[0]." and gid =".$h[1]." and qid =".$h[2].";";
           } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:29:12.453

当检查字符串中是否存在子字符串时，strpos() 是一个很好的函数，所以你的基本前提是好的。

您提交给 strpos() 的干草堆（即 $h[2]）是一个字符串，不是吗？您在问题中说您正在检查数组是否包含下划线，但代码仅检查单个数组项是否包含下划线 - 这是两个非常不同的事情。

如果 $h[2] 是一个子数组，而不仅仅是 $h 数组中的一个字符串，那么您需要遍历子数组并检查每个项目。

所以：

```
 for ($x=0; $x<count($h[2]); $x++) {
     if (strpos($h[2][$x], "_")!==false) {
         if (strpos($h[2][$x], 'S') !== false) {
            // Run code
         } else { 
            // Run code
         }
     }
  } 
```

如果 $h[2] 只是一个字符串，那么你所拥有的应该没问题。

* * *

更新：尝试添加

```
print($h[2][$x].' - '.strpos($h[2][$x], '')); 
```

之前上线

```
print ($h[2][$x].' - '.strpos($h[2][$x], '')); 
```

这应该让我们了解问题所在。

* * *

更新：

根据我们刚刚运行的代码，事情与我的想法有很大不同。首先，并非所有返回的 $h 数组都有 3 个项目。其次 $h2 是一个搅拌，而不是一个子数组。

所以这是新代码：

```
 if (count($h)==3) {
     print($h2.' | ');
     if (strpos($h[2], "_")!==false) {
         print(' underscore was found | ');
         if (strpos($h[2], 'S') !== false) {
            // Run code
         } else { 
            // Run code
         }
     }
  } else {
     // array does not represent a question
  } 
```

Also, you need to change all of the $h[2][$x] back to just $h[2]. Tell me how it goes.

# ruby-on-rails - Rails 的 Turbolinks 未激活

> ID：13614510
> 
> 赞同：5
> 
> 时间：2012-11-28T21:12:57.230
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我正在尝试让 Turbolinks 与我的**Rails 3.2**应用程序一起使用，但没有成功。当我点击链接时，我仍然会在 Chrome 和 Firefox 中重新加载整页。

1.  我已将 turbolinks gem 包含在 中，并在文件`Gemfile`中需要它。`application.js`
2.  我应该补充一点，我运行`Twitter Bootstrap 2.2.1.1`，并且所有非引导/rails javascript 都被禁用。

在 Chrome 开发人员工具中，我可以看到 turbolinks.js 以及所有其他文件已加载。关于为什么 turbolinks 在我的应用程序中不活动的任何建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T17:07:40.327

如果您使用的是引导模板，则 javascript（默认情况下）不会放置在`<head>`您页面的元素中。

我能够使用 Rails 3.2.11、turbolinks 1.0 和默认引导模板作为我的应用程序布局重现该问题

如果你`<%= javascript_include_tag "application" %>`从布局的底部移动（通常就`</body>`在`<head>`元素的上方），那么一切都应该开始工作了。

一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T15:22:20.647

If I were you I would disable bootstrap to isolate the problem first. There might be some weird problems due to that. Take a look at Yehuda Katz' blog post on Turbolinks and you'll see some of the possible problems.

However, from your post I'm unclear as to what the problem is. If it is that page-specific js isn't getting loaded, this may be because turbolinks doesn't reload :head within your rails view.

Look into calling (page:load), (page:change) as found in the Turbolinks README.md file and loading things that way? Also, with certain pages that might not be well suited to turbolinks, you can pass a data tag to disable it on that specific page.

Will

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-12-06T08:26:25.480

就我而言，我有一件奇怪的事情：

Turbolink 与 firefox 和 safari 配合得很好；但它不是 chrome ：我有一个完整的页面重新加载，由网络检查员确认。

# c# - 如何使用泛型而不是继承来拥有多个版本的东西

> ID：13614516
> 
> 赞同：1
> 
> 时间：2012-11-28T21:13:09.460
> 
> 标签：c#, .net, generics, inheritance

在您的公司中，假设您有以下代码：

```
public abstract Phone
{
    public int PhoneID {get;set;}
    public string PhoneNumber {get;set;}
}

public CustomerPhone : Phone
{
    public int CustomerID {get;set;}
}

public AccountPhone : Phone
{
    public int AccountID {get;set;}
} 
```

这应该意味着我们有多种类型的电话，一些是客户电话，一些是帐户电话，等等......

问题是“这可能吗？如果可以，那怎么办？” 似乎最简单的方法是拥有一个可以插入类型的通用电话类，然后它会在需要时使用该类型的信息（AccountID 或 CustomerID）。我还在检查是否可以在没有 DI 的情况下执行此操作（无论是通过构造函数、方法还是属性。）

我脑子里的东西看起来像这样：

```
public interface IUsePhone
{
    int GetOwnerID();
}

public class Phone<T> where T : IUsePhone
{
    //all of Phone's properties from above.

    public int GetOwnerID()
    {
        //return T or item or something's GetOwnerID();
    }
}

public class Account : IUsePhone
{
    private int _accountID;

    //other Account members, including an AccountID property.

    public int GetOwnerID()
    {
        return _accountID;
    }   

    public Phone<Account> Phone { get; set; }
}

public class Customer : IUsePhone
{
    private int _customerID;

    //other Customer members, including an CustomerID property.

    public int GetOwnerID()
    {
        return _customerID;
    }

    public Phone<Customer> Phone { get; set; }
} 
```

这不会编译，因为 Phone 的 GetOwnerID() 当前没有任何方法来返回它的所有者的 GetOwnerID() 结果。我希望从客户的角度来看的最终结果可能是这样的：

```
Account myAccount = new Account();
myAccount.AccountID = 10;

int ownerID = myAccount.Phone.GetOwnerID(); //this would return 10. 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-28T21:19:45.943

我认为您需要问自己为什么要这样做。

如果您真的想要一堆不同的类型，所有这些类型都已`Phone`履行合同，那么您最好使用一个接口，再加上一个抽象的基础实现：

```
public interface IPhone
{
    int PhoneID {get;set;}
    string PhoneNumber {get;set;}
}

public abstract AbstractPhoneBase : IPhone
{
    public int PhoneID {get;set;}
    public string PhoneNumber {get;set;}
}

public CustomerPhone : AbstractPhoneBase
{
    public int CustomerID {get;set;}
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T21:38:04.513

我认为您的示例很好 - 只是缺少接受实现 IUsePhone 的所有者实例（帐户、客户等）的构造函数。

尝试将此添加到您的`Phone<T>`课程中。

```
 public IUsePhone Owner { get; private set; }

    public Phone(T owner)
    {
        this.Owner = owner;
    }

    public int GetOwnerID()
    {
        return this.Owner.GetOwnerID();
    } 
```

注意：在您的示例中，不要忘记您必须先设置 Phone 属性才能`myAccount.Phone.GetOwnerID();`调用。

如果你这样做，我会沿着已经建议的抽象基类路线走下去，并将电话设置在一个基本方法中，如下所示：

```
public virtual void SetPhoneNumber<T>(string number)
    {
        this.Phone = new Phone<T>(this);
        this.Phone.Number = number;
    } 
```

所以你的使用最终会是这样的：

```
 Account myAccount = new Account();
    myAccount.AccountID = 10;

    myAccount.SetPhoneNumber("123456");

    int ownerID = myAccount.Phone.GetOwnerID(); // this would return 10. 
```

# string - 如何避免使用 CSS 重叠文本？

> ID：13614517
> 
> 赞同：0
> 
> 时间：2012-11-28T21:13:10.803
> 
> 标签：string, html, css, browser

例如 StackOverflow，如果我使用`Firebug`并将我的名字更改为长名称，或者我将徽章数量更改为长整数，我该如何管理它`CSS`以避免一个输入另一个？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-28T21:14:24.410

使用`overflow: hidden`,或 css属性`overflow: scroll`的类似值。`overflow`

# highcharts - 在 highchart.stock 中启用禁用悬停

> ID：13614523
> 
> 赞同：3
> 
> 时间：2012-11-28T21:13:33.393
> 
> 标签：highcharts, highstock

您好，我正在开发一个[highchart 应用程序](http://calija.com/bourse/)。如果点击并移动鼠标，它会画一条黑色的线。问题是它仍然悬停在高点图表的烛台上。我想让它成为[这个例子](http://v4.zulutrade.com/charts)。在此示例中，如果单击 addLine 按钮。光标变为十字准线。我们不能悬停在高点图表的烛台上。

问题是=>我如何在candels上启用和禁用悬停之间进行转换。轻松画出黑线。通过外部按钮

这是我的代码

```
chart = new Highcharts.StockChart({
            chart : {
                renderTo : 'container',

            },
            },

        },

            rangeSelector : {
                selected : 1
            },

            title : {
                text : 'AAPL Stock Price'
            },

            yAxis: [{ // Primary yAxis
            lineWidth:1,
            lineColor:"#cccccc",
            labels: {
                align: 'right',
                x: 25,
                y: +5
            },
            title: {
                text: ' ',
                align: 'high',
                margin:50
            },
             showLastLabel: true,
            gridLineColor:'#cccccc',
             minorGridLineColor: '#F0F0F0',
               minorTickInterval: 'auto',
                minorGridLineDashStyle: 'longdash',
             plotLines: [{
                value: 620,
                width: 2,
                color: 'green',
                zIndex:10,
                dashStyle: 'solid',
                label: {

                    text: '<span style="background-color:#000;" >620</span>',
                    align: 'right',
                    zIndex:1000,
                    y: 2,
                    x: 25
                }
            }],

                opposite: true

            }],

            series : [{
                type : 'candlestick',
                name : 'YNS/GPB',
                data : data,

            }]
        ,
        }); 
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:46:26.007

您可以通过[标记](http://api.highcharts.com/highstock#plotOptions.candlestick.marker.states.hover.enabled)属性来做到这一点：

```
states: {
     hover: {
          enabled: false
     }
} 
```

`chart.series[i].marker.states.hover`我相信你会通过它访问它。因此，我认为单击“添加行”按钮会触发呼叫以禁用悬停在系列标记上。然后，绘制完线条后，您需要关闭“添加线条”按钮并发出呼叫以重新启用悬停。

# google-app-engine - 逐行调试谷歌应用引擎项目

> ID：13614527
> 
> 赞同：1
> 
> 时间：2012-11-28T21:13:42.363
> 
> 标签：google-app-engine

任何人都可以为我正在处理的谷歌应用引擎项目推荐一个易于设置的调试器吗？

理想情况下，我想单击特定页面上的 html 按钮，然后逐步查看执行的代码，逐个函数执行，直到出错。我在本地运行应用服务器

```
 dev_appserver.py . --datastore_path /tmp/data.store 
```

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:43:24.723

如果您使用 Python，则可以将 Eclipse 与 Pydev 一起使用。它具有出色的调试器和跟踪器。这是一个从 Eclipse 和 Pydev 开始的教程。但是您不需要添加 src 文件夹（图 4.2）。[http://www.mkyong.com/google-app-engine/google-app-engine-python-hello-world-example-using-eclipse/](http://www.mkyong.com/google-app-engine/google-app-engine-python-hello-world-example-using-eclipse/)

# php - 在给定图像内容的 PHP 中显示图像

> ID：13614529
> 
> 赞同：2
> 
> 时间：2012-11-28T21:13:47.453
> 
> 标签：php, image, screen-grab

我正在使用 GrabzIt PHP 库，它返回网页的屏幕截图。

库返回要保存为文件的图像内容，例如：

```
file_put_contents('images/screenshot.png', $grabzitImageContents); 
```

我想在页面中显示此图像而不保存图像（使用服务器空间）。可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:16:31.663

您可以使用[数据 URI](http://en.wikipedia.org/wiki/Data_URI_scheme)：

```
$encoded = base64_encode($grabzitImageContents);
echo '<img src="data:image/png;base64,' . $encoded . '" />'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T21:17:27.533

您可以只发送标头，然后回显数据：

```
header("Content-Type: image/png");
echo $grabzitImageContents; 
```

试试看。

# c# - C# - 异步回调 - WP7 - Silverlight - 存储数据

> ID：13614531
> 
> 赞同：0
> 
> 时间：2012-11-28T21:13:49.423
> 
> 标签：c#, silverlight, windows-phone-7, asynchronous, callback

我有一个用于 silverlight/WP7 应用程序的异步回调函数，如下所示。

```
public static my_function()
{
     PostClient conn = new PostClient(POST);
            conn.DownloadStringCompleted += (object sender2, DownloadStringCompletedEventArgs z) =>
            {
                if (z.Error == null)
                {
                    //Process result
                    string data = z.Result;
                    //MessageBox.Show(z.Result);  

                    //Convert Login value to true false
                    try
                    { ... do stuff here

                    }
} 
```

我希望能够使用回调函数以预先存在的方法返回数据值；IE

```
public List<Usernames> GetUsernames()
{
       List<Usernames> user_list = my_funtion();
       return user_list;
} 
```

目前，我正在让回调函数更新触发事件的静态变量，并且使用大量数据并跟踪所有数据是一件令人讨厌的事情，尤其是当每个数据变量都需要自己的函数和静态变量时。

这样做的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T21:37:54.530

Tasks to the rescue!

```
public static Task<List<Usernames>> my_function()
{
    var tcs = new TaskCompletionSource<List<Usernames>>(); //pay attention to this line

    PostClient conn = new PostClient(POST);
    conn.DownloadStringCompleted += (object sender2, DownloadStringCompletedEventArgs z) =>
    {
        if (z.Error == null)
        {
            //Process result
            string data = z.Result;
            //MessageBox.Show(z.Result);  

            //Convert Login value to true false
            try
            {
                ///... do stuff here

                tcs.SetResult(null); //pay attention to this line
            }
            finally
            {
            }
        }
        else
        {
             //pay attention to this line
            tcs.SetException(new Exception());//todo put in real exception
        }
    };

    return tcs.Task; //pay attention to this line
} 
```

I stuck in some `//pay attention to this line` comments to emphasize the few lines of code I added from your existing code.

If you're using C# 5.0 you can `await` on the result when calling the function. If you're in a context in which it's acceptable to perform a blocking wait you can just use `Result` on the returned task right away (be careful when doing that in certain environments) or you could use continuations of the returned task to process results (which is what `await` will do behind the scenes).

# javascript - Jquery：如何使用函数 .attr() 动态添加属性

> ID：13614532
> 
> 赞同：3
> 
> 时间：2012-11-28T21:13:50.740
> 
> 标签：javascript, jquery, dynamic, attributes

我需要将我的属性动态添加到我的输入中，但它不起作用。

*   this.nomRoot 是此处“输入”组件的名称。

*   this.lstAttr 是一个具有“name”或“checked”等属性的数组。

*   this.lstAttrValue 是一个具有属性值的数组，例如“myCheckbox”或“true”。

这是我的代码：

```
Component("Input", {
    add: function(element, type) {
       html = $('<'+this.nomRoot+' type="'+ type +'" />').appendTo('#'+element);

       for(key in this.lstAttr) {
          alert(this.lstAttr[key]);
          alert(this.lstAttrValue[key]);
          $(html).attr("'"+this.lstAttr[key]+"', '"+this.lstAttrValue[key]+"'");
       }

    }
}); 
```

所以我的代码使用萤火虫运行，但不添加属性。

我尝试过这样的事情：

*   this.lstOptions 是一个包含属性和属性值的数组，例如“name, myCheckbox”

    ```
    $("<"+this.nomRoot+" />").attr(this.lstOptions).appendTo(element); 
    ```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T21:17:12.113

您要设置属性和值，只需引用两个索引即可。无需构建某种字符串。

```
$(html).attr(this.lstAttr[key], this.lstAttrValue[key]); 
```

# joomla - 为什么我的模块类后缀没有附加到 Joomla 中的菜单模块？

> ID：13614533
> 
> 赞同：-1
> 
> 时间：2012-11-28T21:13:54.390
> 
> 标签：joomla

当我尝试将模块类后缀添加到菜单模块时，它没有在现场显示。

我在“模块类后缀”字段中放置了一个自定义值。只有一个菜单组件被使用。但是，我指定的值没有附加到元素的 classname 属性中。

我禁用了缓存。还有什么我应该检查的吗？

我正在使用最新的稳定 Joomla 3.0.2

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-18T12:12:15.470

我还不能投票 - 但迈克对他自己的回答的评论是标准 joomla 模板（例如 beez 或 protostar）中缺少的 IMO 解决方案。谢谢！澄清一下：我将 /modules/mod_menu/tmpl/default.php 复制到我的模板的 html/mod_menu/ 目录中，并在顶部附近添加了以下内容：

`<?php $moduleclass_sfx = htmlspecialchars($params->get('moduleclass_sfx')); ?> <nav class="navigation<?php echo $moduleclass_sfx; ?>">`

就在之前

`<?php // The menu class is deprecated. Use nav instead. ?>`

当然，`<nav>`在文件末尾也关闭了。

（差点错过评论，这就是为什么我想投票，现在不得不发布。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T23:43:52.050

也许模块模板没有使用类后缀参数。在你的模块的模板文件中应该有如下内容：

```
<div class="mymodule<?php echo $moduleclass_sfx ?>"> 
```

# iphone - 用分钟将 HH:MM NSString 转换为 NSInteger

> ID：13614536
> 
> 赞同：0
> 
> 时间：2012-11-28T21:14:10.083
> 
> 标签：iphone, objective-c, ios, cocoa-touch, nsdate

我有几个`NSStrings`包含持续时间的，它们看起来像这样：`@"03:40", @"08:40"`- 时间是一个动作的持续时间。我想`int`为每个字符串设置一个分钟，比如“01:20”是“80”（分钟），以便稍后将它们相互比较。

你如何在 Objective-C 中管理这个简单的事情？提前致谢

**编辑：**

这个试过了，没用。我想要一种完全不同的方法，简单而轻松。

```
- (NSMutableArray *)sortResultsByTime
{
    NSMutableArray *sortedTrips = [NSMutableArray arrayWithArray:[_tweets sortedArrayUsingComparator: ^(id trip1, id trip2) {

        double time1 = [self durationFromString:[(Tweet *) trip1 flightDuration]];
        double time2 = [self durationFromString:[(Tweet *) trip1 flightDuration]];
        NSLog(@"What's time1? It's %f", time1);
        NSLog(@"What's time2? It's %f", time2);

        if (time1 < time2) {
            return (NSComparisonResult)NSOrderedDescending;
        }

        if (time1 > time2) {
            return (NSComparisonResult)NSOrderedAscending;
        }

        return (NSComparisonResult)NSOrderedSame;
    }]];

    return sortedTrips;
}

- (double)durationFromString:(NSString *)durationString
{
    NSArray *durationArray = [durationString componentsSeparatedByString:@":"];

    return [durationArray[0] doubleValue] + [durationArray[1] doubleValue] / 60.0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:28:33.467

我不明白你为什么认为其他答案过于复杂，但如果你想要一个没有数组的解决方案，你在这里：

```
- (double)durationFromString:(NSString *)s
{
    int hr = 0, min = 0;
    NSScanner *scn = [NSScanner scannerWithString:s];
    [scn scanInt:&hr];
    [scn scanString:@":" intoString:NULL];
    [scn scanInt:&min];
    return hr * 60 + min;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T21:19:15.690

您发布的代码试图将字符串转换为小时数，而不是分钟数。

你要：

```
return [durationArray[0] doubleValue] * 60 + [durationArray[1] doubleValue]; 
```

编辑：原始代码失败，因为这一行：

```
double time2 = [self durationFromString:[(Tweet *) trip1 flightDuration]]; 
```

需要是：

```
double time2 = [self durationFromString:[(Tweet *) trip2 flightDuration]]; 
```

更新：既然 OP 想要一种不同的方法，为什么不简单地这样做：

```
NSString *time1 = [(Tweet *) trip1 flightDuration];
NSString *time2 = [(Tweet *) trip2 flightDuration];

return [time1 compare:time2]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-28T21:20:38.403

拆分`:`（使用`-[NSString componentsSeparatedByString:]`），访问每个元素（使用`-[NSArray objectAtIndex:`），然后转换为整数（`-[NSString intValue]`），最后乘法和加法。

# jquery - Jquery函数在第二个div上不起作用

> ID：13614538
> 
> 赞同：0
> 
> 时间：2012-11-28T21:14:21.547
> 
> 标签：jquery, jquery-ui

我对 jQuery 很陌生，我有这个功能来换掉隐藏的 div onclick

```
$('#menu a').click(function(){  
    $firstpanel.html($('.' +$(this).attr("rel")).html());   
    $('#bg a:eq(0)').addClass('active2');   
}); 
```

但是，当尝试为另一个 div 复制此功能时，它将不起作用。

```
$('#bg a').click(function(){    
    $('#bg2').html($('.' +$(this).attr("rel")).html()); 
}); 
```

您应该能够查看源代码以查看完整的脚本。

[链接到页面](http://madebymzl.com/MZL/process-2/campaign_content_tyler.html)

HTML

```
<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--><html lang="en"> <!--<![endif]-->
<html>
<head>

    <!-- Basic Page Needs
  ================================================== -->
    <meta charset="utf-8">
    <title>Campaign/Content</title>
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Mobile Specific Metas
  ================================================== -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <!-- CSS
  ================================================== -->
    <link rel="stylesheet" href="stylesheets/base.css">
    <link rel="stylesheet" href="stylesheets/skeleton.css">
    <link rel="stylesheet" href="stylesheets/layout.css">
    <script src="http://code.jquery.com/jquery-1.8.2.js"></script>
    <script src="http://code.jquery.com/ui/1.9.1/jquery-ui.js"></script>

    <!--[if lt IE 9]>
        <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Favicons
    ================================================== -->

<script>
$(document).ready(function() {
    var $menu =$('#menu a');
    var $firstpanel =$('#bg');
    var $firstlink =$("a.some-link");
    $menu.click(function(event){
    $menu.removeClass('active');
    $(this).addClass('active');
    });
    $firstlink.live('click', function() {
    $(this).addClass('active2').siblings().removeClass('active2');
    });
$(function(){
    $firstpanel.html($('.' +$('#engage').attr("rel")).html());
    $('#engage').addClass('active');
    $firstpanel.show('drop', '4000');
    $('#bg a:eq(0)').addClass('active2');   
    $('#bgcontainer').show('drop','4000');
    });
$('#menu a').click(function(){
    $firstpanel.html($('.' +$(this).attr("rel")).html());
    $('#bg a:eq(0)').addClass('active2');
    });
$('#bg a').click(function(){
    $('#bg2').html($('.' +$(this).attr("rel")).html());
    });

});
</script>

</head>
<body>

<div id="desktop">
    <!-- Primary Page Layout -->
    <div class="header">

    <a href="index.html" class="brand"><img src="img/MZ_logo_white_smaller.png" alt="MZL logo"></a>

    </div>

    <div class="container">
        <div class="sixteen columns">
            <h1 class="remove-bottom" style="margin-top: 40px"><br></h1>
            <h5>CAMPAIGN/ CONTENT</h5>
            <hr />
        </div>
        <div id="menu"  class="one-third column">
            <a class="btn btnfirst" id="engage" href="#" rel="engagecon"><span>ENGAGE</span></a>
            <a class="btn btnfirst" id="intake" href="#" rel="intakecon"><span>INTAKE</span></a>
            <a class="btn btnfirst" id="plan" href="#" rel="plancon"><span>PLAN</span></a>
            <a class="btn btnfirst" id="execute" href="#"><span>EXECUTE</span></a>
            <a class="btn btnfirst" id="report" href="#"><span>REPORT</span></a>
            <a class="btn btnfirst" id="recognize" href="#"><span>RECOGNIZE</span></a>

        </div>
    <div class="one-third column">
      <div id="bg"></div>
        <div id="bglinks1" class="engagecon show">

            <a class="some-link" href="#" rel="placeholder"><h3>Lorem ipsum</h3>
            <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.</p></a>

            <a class="some-link" href="#" rel="placeholder2"><h3>Lorem ipsum</h3>
            <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.</p></a>

            <a class="some-link" href="#" rel="placeholder3"><h3>Lorem ipsum</h3>
            <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.</p></a>

        </div>

        <div id="bglinks2" class="intakecon show">
            <a class="some-link" href="#" rel="projectinput"><h3>Project Input</h3>
            <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.</p></a>

            <a class="some-link" href="#"><h3>Existing SOQ</h3>
            <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.</p></a>

            <a class="some-link" href="#"><h3>New SOW</h3>
            <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.</p></a>

        </div>

        <div id="bglinks3" class="plancon show">
            <a class="some-link" href="#"><h3>Schedule Meeting</h3>
            <p>Collaborate on project schedule and basic plan.</p></a>
            <a class="some-link" href="#"><h3>Message Planning</h3>
            <p>Prepare competitive and situation analysis based on project needs and SOW</p></a>
            <a class="some-link" href="#"><h3>Creative Brief</h3>
            <p>Prepare competitive and situation analysis based on project needs and SOW</p></a>
            <a class="some-link" href="#"><h3>Automation</h3>
            <p>Prepare competitive and situation analysis based on project needs and SOW</p></a>

        </div>
    </div>

    <div id="bgcontainer" class="two-thirds column">
     <div id="bg2"></div>
        <div class="placeholder">
            <h3>ACCOUNT</h3>
            <p>

            Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.<br />
            Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.<br />
            Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.</p>

            <h3>PLANNING</h3>
            <p>

            Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.<br />
            Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.</p>

            <h3>CREATIVE</h3>
            <p>

            Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.</p>

            <h3>AUTOMATION</h3>
            <p>

            Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.</p>
        </div>
        <div class="placeholder2">
            <h3>ACCOUNT2</h3>
            <p>

            Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.<br />
            Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.<br />
            Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.</p>

            <h3>PLANNING</h3>
            <p>

            Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.<br />
            Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.</p>

            <h3>CREATIVE</h3>
            <p>

            Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.</p>

            <h3>AUTOMATION</h3>
            <p>

            Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.</p>
        </div>
        <div class="placeholder3">
            <h3>ACCOUNT3</h3>
            <p>

            Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.<br />
            Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.<br />
            Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.</p>

            <h3>PLANNING</h3>
            <p>

            Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.<br />
            Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.</p>

            <h3>CREATIVE</h3>
            <p>

            Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.</p>

            <h3>AUTOMATION</h3>
            <p>

            Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.</p>
        </div>

        <div class="projectinput">
            <h3>ACCOUNT2</h3>
            <p>

            Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.<br />
            Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.<br />
            Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.</p>

            <h3>PLANNING</h3>
            <p>

            Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.<br />
            Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.</p>

            <h3>CREATIVE</h3>
            <p>

            Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.</p>

            <h3>AUTOMATION</h3>
            <p>

            Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.</p>
        </div>
    </div><!-- container -->
 </div>
</div>
<!-- End Document
================================================== -->
</body>
</html> 
```

CSS

```
.container {
    position: relative;
    width: 960px;
    margin: 0 auto;
    padding: 0;
}

.container .column,
    .container .columns {
    float: left;
    display: inline;
    margin-left: 10px;
    margin-right: 10px;
}

.row {
    margin-bottom: 20px;
}

/* Nested Column Classes */

.column.alpha, .columns.alpha {
    margin-left: 0;
}

.column.omega, .columns.omega {
    margin-right: 0;
}

/* Base Grid */

.container .one.column,
    .container .one.columns {
    width: 40px;
}

.container .two.columns {
    width: 100px;
}

.container .three.columns {
    width: 160px;
}

.container .four.columns {
    width: 220px;
}

.container .five.columns {
    width: 280px;
}

.container .six.columns {
    width: 340px;
}

.container .seven.columns {
    width: 400px;
}

.container .eight.columns {
    width: 460px;
}

.container .nine.columns {
    width: 520px;
}

.container .ten.columns {
    width: 580px;
}

.container .eleven.columns {
    width: 640px;
}

.container .twelve.columns {
    width: 700px;
}

.container .thirteen.columns {
    width: 760px;
}

.container .fourteen.columns {
    width: 820px;
}

.container .fifteen.columns {
    width: 880px;
}

.container .sixteen.columns {
    width: 940px;
}

.container .one-third.column {
    width: 220px;

}

#bg {
    background-color:white;
    padding:10px;
    display:none;
    opacity:1;  
}

.show {
  background-color: white;
}

.arrow{
display:none;   
}

.projectinput{
display:none;   
}

.placeholder2{
display:none;   
}

.placeholder3{
display:none;   
}

.intakecon{
background-color: white;
display:none;
}

.engagecon{
background-color: white;
display:none;
}

.plancon{
background-color: white;
display:none;
}

#bg2 {

background-color: white;
padding: 10px;
display:none;

}

#bgcontainer{
display:none;
padding:10px;
}

.container .two-thirds.column {
    width: 420px;
    background-color:white;
}

.btn {
    display: block;
    width: 154px;
    height: 40px;
    padding: 20px 0 0 30px;
    background: white;
    margin-bottom: 8px;
    opacity: 0.5;
}

a.btn:hover{
opacity:1;
}

a:link {text-decoration:none;}

a:hover{
text-decoration:underline;
color:#7FBCCD;
}
.active{
opacity:1;
}

.active2{
text-decoration:underline;
font-weight:bold;
}

.btn span {
    display: none;
}

.btnfirst {
    padding: 0 0 0 30px;
}

#engage {
    margin:0 0 10px 35px;
    background: url(../images/btn-1.png) no-repeat;
}

#intake {
    margin:0 0 10px 35px;
    background: url(../images/btn-2.png) no-repeat;
}

#plan {
    margin:0 0 10px 35px;
    background: url(../images/btn-3.png) no-repeat;
}

#execute {
    margin:0 0 10px 35px;
    background: url(../images/btn-4.png) no-repeat;
}

#report {
    margin:0 0 10px 35px;
    background: url(../images/btn-5.png) no-repeat;
}

#recognize {
    margin:0 0 10px 35px;
    background: url(../images/btn-6.png) no-repeat;
}

hr { border: solid #ddd; border-width: 1px 0 0; clear: both; margin: 10px 0 30px; width:960px;height: 0; }

hr, .divide {display: none; }

/* Offsets */

.container .offset-by-one {
    padding-left: 60px;
}

.container .offset-by-two {
    padding-left: 120px;
}

.container .offset-by-three {
    padding-left: 180px;
}

.container .offset-by-four {
    padding-left: 240px;
}

.container .offset-by-five {
    padding-left: 300px;
}

.container .offset-by-six {
    padding-left: 360px;
}

.container .offset-by-seven {
    padding-left: 420px;
}

.container .offset-by-eight {
    padding-left: 480px;
}

.container .offset-by-nine {
    padding-left: 540px;
}

.container .offset-by-ten {
    padding-left: 600px;
}

.container .offset-by-eleven {
    padding-left: 660px;
}

.container .offset-by-twelve {
    padding-left: 720px;
}

.container .offset-by-thirteen {
    padding-left: 780px;
}

.container .offset-by-fourteen {
    padding-left: 840px;
}

.container .offset-by-fifteen {
    padding-left: 900px;
}

/* #Tablet (Portrait)
================================================== */

/* Note: Design for a width of 768px */

@media only screen and (min-width: 768px) and (max-width: 959px) {

.container {
    width: 768px;
}

.container .column,
        .container .columns {
    margin-left: 10px;
    margin-right: 10px;
}

.column.alpha, .columns.alpha {
    margin-left: 0;
    margin-right: 10px;
}

.column.omega, .columns.omega {
    margin-right: 0;
    margin-left: 10px;
}

.alpha.omega {
    margin-left: 0;
    margin-right: 0;
}

.container .one.columns {
    width: 28px;
}

.container .two.columns {
    width: 76px;
}

.container .three.columns {
    width: 124px;
}

.container .four.columns {
    width: 172px;
}

.container .five.columns {
    width: 220px;
}

.container .six.columns {
    width: 268px;
}

.container .seven.columns {
    width: 316px;
}

.container .eight.columns {
    width: 364px;
}

.container .nine.columns {
    width: 412px;
}

.container .ten.columns {
    width: 460px;
}

.container .eleven.columns {
    width: 508px;
}

.container .twelve.columns {
    width: 556px;
}

.container .thirteen.columns {
    width: 604px;
}

.container .fourteen.columns {
    width: 652px;
}

.container .fifteen.columns {
    width: 700px;
}

.container .sixteen.columns {
    width: 748px;
}

.container .one-third.column {
    width: 190px;
}

.container .two-thirds.column {
    width: 220px;
}

.btn {
    display: block;
    width: 154px;
    height: 40px;
    padding: 20px 0 0 30px;
    background: white;
    margin-bottom: 8px;
}

.btn span {
    display: none;
}

.btnfirst {
    padding: 0 0 0 30px;
}

#engage {
    margin:0 0 10px 20px;
    background: url(../images/btn-1.png) no-repeat;
}

#intake {
    margin:0 0 10px 20px;
    background: url(../images/btn-2.png) no-repeat;
}

#plan {
    margin:0 0 10px 20px;
    background: url(../images/btn-3.png) no-repeat;
}

#execute {
    margin:0 0 10px 20px;
    background: url(../images/btn-4.png) no-repeat;
}

#report {
    margin:0 0 10px 20px;
    background: url(../images/btn-5.png) no-repeat;
}

#recognize {
    margin:0 0 10px 20px;
    background: url(../images/btn-6.png) no-repeat;
}

hr { border: solid #ddd; border-width: 1px 0 0; clear: both; margin: 10px 0 30px; width:715px;height: 0; }

/* Offsets */

.container .offset-by-one {
    padding-left: 48px;
}

.container .offset-by-two {
    padding-left: 96px;
}

.container .offset-by-three {
    padding-left: 144px;
}

.container .offset-by-four {
    padding-left: 192px;
}

.container .offset-by-five {
    padding-left: 240px;
}

.container .offset-by-six {
    padding-left: 288px;
}

.container .offset-by-seven {
    padding-left: 336px;
}

.container .offset-by-eight {
    padding-left: 384px;
}

.container .offset-by-nine {
    padding-left: 432px;
}

.container .offset-by-ten {
    padding-left: 480px;
}

.container .offset-by-eleven {
    padding-left: 528px;
}

.container .offset-by-twelve {
    padding-left: 576px;
}

.container .offset-by-thirteen {
    padding-left: 624px;
}

.container .offset-by-fourteen {
    padding-left: 672px;
}

.container .offset-by-fifteen {
    padding-left: 720px;
}

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:22:44.350

查看您的来源，您有相同的名称（值）分配给“ID”属性 - 这是一个不。确保每个 ID 都有一个唯一的名称。那可能是你的问题。例如，您有 3 个名为“show”的 id。

此外，您可能需要在此末尾添加 ()：

```
$(function(){
$firstpanel.html($('.' +$('#engage').attr("rel")).html());
$('#engage').addClass('active');
$firstpanel.show('drop', '4000');
$('#bg a:eq(0)').addClass('active2');   
$('#bgcontainer').show('drop','4000');
})(); 
```

# forms - 我的 JavaScript 验证是否足够？

> ID：13614543
> 
> 赞同：1
> 
> 时间：2012-11-28T21:14:26.607
> 
> 标签：forms, validation

我有一个关于验证使用 AJAX 提交的表单中的数据的问题（并不重要）。

我正在使用 jQuery 验证它，通常是三件事：

*   现场有数据吗？
*   数据的长度（和数据的种类）是否正确？
*   数据是否与正则表达式匹配（没有奇怪的 XSS 字符等）

我的问题：我需要在服务器端重复多少验证？用户可以执行 JS 和/或更改我的 HTML 以将任何危险代码提交到我的后端吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T21:27:50.140

永远不要*依赖*JavaScript 和客户端验证。仅仅因为用户可以很容易地禁用或规避您的客户端验证。

**在服务器端验证之前，任何用户输入都应视为无效**。

客户端验证应被视为“值得拥有”的功能，以增加应用程序的 UX 价值（它允许用户更快地检测到错误，而无需重新填写表单）。但仅此而已。它不是可靠的服务器端验证的替代方案。

# javascript - Google Maps V3 IE9 信息窗口不显示外部 js 文件

> ID：13614546
> 
> 赞同：0
> 
> 时间：2012-11-28T21:14:35.377
> 
> 标签：javascript, google-maps-api-3, dom-events, internet-explorer-9

我正在从 Google Maps V2 更新到 V3：

V2：[http ://www.fortwayne2030.org/clubloc.html](http://www.fortwayne2030.org/clubloc.html)

V3：[http ://www.fortwayne2030.org/clublocv3.html](http://www.fortwayne2030.org/clublocv3.html)

我为第 3 版所做的更新似乎在 Google Chrome 中运行良好。但是，我似乎无法让信息窗口出现在 IE9 中。这与我将代码分离到单独的 .js 文件这一事实有关吗？

我的 clublocv3.html 看起来像这样：

```
<!DOCTYPE html>
<html>
    <head>
        <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
        <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
        <title>A2030 Map</title>
    <link rel="stylesheet" href="includes/a2030style.css"> 
    <noscript><b>JavaScript must be enabled in order for you to use Google Maps.</b> 
      However, it seems JavaScript is either disabled or not supported by your browser. 
      To view Google Maps, enable JavaScript by changing your browser options, and then 
      try again.
    </noscript>
        <script src="http://maps.googleapis.com/maps/api/js?sensor=false" type="text/javascript">
        </script>
        <script type="text/javascript" src="includes/a2030gmapv3.js"></script>
    </head>
    <body onload="initialize()">
        <table>
            <tr><th>Active 20-30 Map</th><th>Clubs</tr>
            <tr>
                <td>
                    <div id="map_canvas" style="width: 712px; height: 400px"></div>
                </td>
                <td>
                    <div id="side_bar"/>
                </td>
            </tr>
        </table>
    </body>
</html> 
```

这是 a2030gmapv3.js：

```
// Variables
var map;
var infowindow = new google.maps.InfoWindow(
  { 
    size: new google.maps.Size(150,50)
  });
var side_bar_html = "";
// array to hold copies of the markers used by the side_bar
var gmarkers = [];

// Main init function
function initialize() {

  var mapOptions = {
    center: new google.maps.LatLng(38.6, -100), zoom: 4, mapTypeId: google.maps.MapTypeId.ROADMAP
  };
    map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);

  var2030Icon = new google.maps.MarkerImage('images/a2030Pointer01.png',new google.maps.Size(26, 37));
  var2030FormingIcon = new google.maps.MarkerImage('images/a2030Pointer02F.png',new google.maps.Size(26, 37));

  downloadUrl("includes/a2030USClubLoc.xml", function(data) {
    //Active Clubs
    var markers = data.documentElement.getElementsByTagName("marker");
    side_bar_html = "<b>United States</b><br/><ul>";
    for (var i = 0; i < markers.length; i++) {
      var latlng = new google.maps.LatLng(parseFloat(markers[i].getAttribute("lat")),
                              parseFloat(markers[i].getAttribute("lng")));
      var label = markers[i].getAttribute("label");
      var html = markers[i].getElementsByTagName("infowindow")[0].textContent;
      var marker = createMarker(latlng,label,html,var2030Icon,map);
    }
    side_bar_html += "</ul><br/>";
    //Clubs in formation
    var markersforming = data.documentElement.getElementsByTagName("markerforming");
    side_bar_html += "<br/><b>United States Clubs in Formation</b><br/><ul>";
    for (var i = 0; i < markersforming.length; i++) {
      var latlng = new google.maps.LatLng(parseFloat(markersforming[i].getAttribute("lat")),
                              parseFloat(markersforming[i].getAttribute("lng")));
      var label = markersforming[i].getAttribute("label");
      var html = (markersforming[i].getElementsByTagName("infowindow")[0]).textContent;
      var marker = createMarker(latlng,label,html,var2030FormingIcon,map);
    }
    side_bar_html += "</ul><br/>";
            // put the assembled side_bar_html contents into the side_bar div
      document.getElementById("side_bar").innerHTML = side_bar_html;
  }
  );

} // end initialize

// A function to create the marker and set up the event window
function createMarker(mypoint,mylabel,myhtml,myicon,mymap) {
  var marker = new google.maps.Marker({
    position: mypoint,
    map: mymap,
    title: mylabel,
    icon: myicon
  });
  // save the info we need to use later for the side_bar
  gmarkers.push(marker);
  google.maps.event.addListener(marker, "click", function() {
    if (infowindow) infowindow.close();
    infowindow = new google.maps.InfoWindow({content: myhtml});
    infowindow.open(mymap, marker);
  });
  // add a line to the side_bar html
  side_bar_html += '<li><a href="javascript:myclick(' + (gmarkers.length-1) + ')">' + mylabel + '<\/a></li>';
  return marker;
}

function myclick(i) {
  google.maps.event.trigger(gmarkers[i], 'click');
}

google.maps.event.addDomListener(window, 'load', initialize);

/**
The below functions have been copied from util.js for XML parsing, file provided by Google:
http://gmaps-samples-v3.googlecode.com/svn/trunk/xmlparsing/
*/

/**
* Returns an XMLHttp instance to use for asynchronous
* downloading. This method will never throw an exception, but will
* return NULL if the browser does not support XmlHttp for any reason.
* @return {XMLHttpRequest|Null}
*/
function createXmlHttpRequest() {
 try {
   if (typeof ActiveXObject != 'undefined') {
     return new ActiveXObject('Microsoft.XMLHTTP');
   } else if (window["XMLHttpRequest"]) {
     return new XMLHttpRequest();
   }
 } catch (e) {
   changeStatus(e);
 }
 return null;
};

/**
* This functions wraps XMLHttpRequest open/send function.
* It lets you specify a URL and will call the callback if
* it gets a status code of 200.
* @param {String} url The URL to retrieve
* @param {Function} callback The function to call once retrieved.
*/
function downloadUrl(url, callback) {
 var status = -1;
 var request = createXmlHttpRequest();
 if (!request) {
   return false;
 }

 request.onreadystatechange = function() {
   if (request.readyState == 4) {
     try {
       status = request.status;
     } catch (e) {
       // Usually indicates request timed out in FF.
     }
     if (status == 200) {
       callback(request.responseXML, request.status);
       request.onreadystatechange = function() {};
     }
   }
 }
 request.open('GET', url, true);
 try {
   request.send(null);
 } catch (e) {
   changeStatus(e);
 }
};

/**
 * Parses the given XML string and returns the parsed document in a
 * DOM data structure. This function will return an empty DOM node if
 * XML parsing is not supported in this browser.
 * @param {string} str XML string.
 * @return {Element|Document} DOM.
 */
function xmlParse(str) {
  if (typeof ActiveXObject != 'undefined' && typeof GetObject != 'undefined') {
    var doc = new ActiveXObject('Microsoft.XMLDOM');
    doc.loadXML(str);
    return doc;
  }

  if (typeof DOMParser != 'undefined') {
    return (new DOMParser()).parseFromString(str, 'text/xml');
  }

  return createElement('div', null);
}

/**
 * Appends a JavaScript file to the page.
 * @param {string} url
 */
function downloadScript(url) {
  var script = document.createElement('script');
  script.src = url;
  document.body.appendChild(script);
} 
```

有谁知道为什么 IE9 不能像 Chrome 一样显示信息窗口？当我转到代码就在同一个 HTML 文件中的示例时，Infowindows 确实显示在 IE9 中。我希望避免这种情况并保留单独的 .js 文件。对于如何为 IE9 注册它以及尽可能多的跨浏览器支持，我们将不胜感激。

我是新手，所以我现在只能发布 2 个超链接……但我认为如果您需要 XML 数据，可以从 fortwayne2030.org/includes/a2030USClubLoc.xml 获取

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T21:38:46.650

在 a2030gmapv3.js 的第 31 行和第 41 行更改您的代码：

第 31 行：

```
var infoNode = markers[i].getElementsByTagName("infowindow")[0];
var html = "textContent" in infoNode ? infoNode.textContent : infoNode.text; 
```

第 41 行：

```
var infoNode = markersforming[i].getElementsByTagName("infowindow")[0];
var html = "textContent" in infoNode ? infoNode.textContent : infoNode.text; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T22:52:26.103

此行在 IE 中不起作用：

```
 var html = markers[i].getElementsByTagName("infowindow")[0].textContent; 
```

所以 InfoWindow 没有内容（显然这意味着它没有打开）

# redis - 如果芹菜（显然）随机忘记任务，我该怎么办？

> ID：13614550
> 
> 赞同：0
> 
> 时间：2012-11-28T21:14:48.167
> 
> 标签：redis, celery, celery-task

我有一个带有 sqlalchemy 的烧瓶应用程序和一个正在运行的芹菜工人。我使用 redis 作为我的经纪人。每次有人在对话中提交新消息时，都会启动一个工作人员，并且应该向所有参与对话的人发送通知邮件。因此，它连接到数据库并获取所有相关的电子邮件地址。

不幸的是，似乎有一个随机因素决定芹菜是否知道发送邮件的任务。在某些启动后它可以完美运行（有时），在某些启动后它根本不起作用。当它不起作用时，我得到的错误是：

```
[2012-11-28 21:42:58,751: ERROR/MainProcess] Received unregistered task of type 'messages.sendnotifies'.
 The message has been ignored and discarded.

 Did you remember to import the module containing this task?
 Or maybe you are using relative imports?
 Please see http://bit.ly/gLye1c for more information.

 The full contents of the message body was:
 {'retries': 0, 'task': 'messages.sendnotifies', 'eta': None, 'args': [41L], 'expires': None, 'callbacks': None, 'errbacks': None, 'kwargs': {}, 'id': '47da3ba7-ec91-4056-bb4f-a6afec2f960f', 'utc': True} (183b)
 Traceback (most recent call last):
   File "/var/www/virtual/venv/lib/python2.7/site-packages/celery/worker/consumer.py", line 410, in on_task_received
     connection = self.connection
 KeyError: 'messages.sendnotifies' 
```

当我用它运行 celery 时，`--loglevel=DEBUG`它会在任务列表中列出任务：

```
[Tasks]
   . celery.backend_cleanup
   . celery.chain
   . celery.chord
   . celery.chord_unlock
   . celery.chunks
   . celery.group
   . celery.map
   . celery.starmap
   . event.notfiy
   . messages.sendnotifies
   . money.checktransaction
   . money.deploypayment
   . money.invoicepromotion
   . protocols.plotweight
   . questionnaire.deploy
   . questionnaire.suitability
   . registration.notify
   . tracking.track
   . user.checkaccount
   . user.checkaccounts
   . user.fixpermissions
   . user.genpassreset 
```

我还不能确定一个系统，什么时候可以工作，什么时候不工作。但是我已将所有相关软件包升级到今天可用的最新版本，但它仍然无法正常工作。

我希望对为什么这可能不起作用以及如何解决它有任何想法。非常感谢每一个反馈，因为我有点绝望！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T16:07:14.617

这可能是当前 3.0 开发中修复的错误，您可以通过安装来帮助测试它：

点安装[https://github.com/celery/celery/zipball/3.0](https://github.com/celery/celery/zipball/3.0)

# ruby-on-rails - 调用嵌套模型视图

> ID：13614551
> 
> 赞同：0
> 
> 时间：2012-11-28T21:14:51.180
> 
> 标签：ruby-on-rails, nested-forms

我有一个嵌套模型

```
resources :customers do 
 resources :readings
end 
```

我现在想从客户的显示视图中访问我的 ../customerid/readings/new 视图。

在客户显示视图中，如何使用按钮调用新读数视图？

客户展示.html

```
<%- model_class = Customer -%>
<div class="page-header">
<h1><%=t '.title', :default => model_class.model_name.human %></h1>
</div>

<dl class="dl-horizontal">
<dt><strong><%= model_class.human_attribute_name(:name) %>:</strong></dt>
<dd><%= @customer.name %></dd>
<dt><strong><%= model_class.human_attribute_name(:customer_currency) %>:</strong></dt>
<dd><%= @customer.customer_currency %></dd>
<dt><strong><%= model_class.human_attribute_name(:payment_terms) %>:</strong></dt>
<dd><%= @customer.payment_terms %></dd>
<dt><strong><%= model_class.human_attribute_name(:phase_type) %>:</strong></dt>
<dd><%= @customer.phase_type %></dd>
<dt><strong><%= model_class.human_attribute_name(:billing_address) %>:</strong></dt>
<dd><%= @customer.billing_address %></dd>
<dt><strong><%= model_class.human_attribute_name(:first_name) %>:</strong></dt>
<dd><%= @customer.first_name %></dd>
<dt><strong><%= model_class.human_attribute_name(:last_name) %>:</strong></dt>
<dd><%= @customer.last_name %></dd>
<dt><strong><%= model_class.human_attribute_name(:mobile) %>:</strong></dt>
<dd><%= @customer.mobile %></dd>
<dt><strong><%= model_class.human_attribute_name(:email) %>:</strong></dt>
<dd><%= @customer.email %></dd>
</dl>

<div class="form-actions">
<%= link_to t('.back', :default => t("helpers.links.back")),
          customers_path, :class => 'btn'  %>
<%= link_to t('.edit', :default => t("helpers.links.edit")),
          edit_customer_path(@customer), :class => 'btn' %>

<%= link_to t('.destroy', :default => t("helpers.links.destroy")),
          customer_path(@customer),
          :method => 'delete',
          :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm",   :default => 'Are you sure?')) },
          :class => 'btn btn-danger' %>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T21:20:22.950

我及时解决了

```
 <%= link_to 'Readings', customer_readings_path(@customer) %> | 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T21:21:05.473

根据Ruby on Rails 路由指南的[“2.7 嵌套资源”章节](http://guides.rubyonrails.org/routing.html#nested-resources)`/customers/:customer_id/readings/new`，要获取以下 URL ，请使用：

```
customer_readings_path(@customer) # Generate the path for new Reading which belongs to @customer 
```

# r - 如何创建示例（匿名）R 脚本以提供可重现的示例？

> ID：13614556
> 
> 赞同：0
> 
> 时间：2012-11-28T21:15:09.050
> 
> 标签：r

这与：
[如何从私有数据创建示例数据集（用无信息的占位符替换变量名称和级别）？](https://stackoverflow.com/questions/10454973/how-to-create-example-data-set-from-private-data-replacing-variable-names-and-l)
这源于：
[如何制作一个出色的 R 可重现示例？](https://stackoverflow.com/questions/5963269/how-to-make-a-great-r-reproducible-example)

我已经意识到拥有一个匿名数据集（数据和标签是否提供信息但与原始数据一致）是从您无法共享的脚本和数据中生成可重复示例（用于问题或错误报告）的一半（例如专有信息、未发表的发现等）。

关于如何自动翻译脚本以使其与使用[此 stackoverflow答案中提供的答案之一创建的匿名数据框中的变量相匹配的任何建议](https://stackoverflow.com/questions/10454973/how-to-create-example-data-set-from-private-data-replacing-variable-names-and-l%29)

这可能是一个比它价值更大的挑战，但如果它被广泛使用（比如作为一个包），它可以减少没有可重现示例的问题和错误报告的发生。

# c# - 网络服务应用设置

> ID：13614565
> 
> 赞同：1
> 
> 时间：2012-11-28T21:15:25.523
> 
> 标签：c#, asp.net, web-services

我有一个 C# 库，它需要引用 2 个 Web 服务，一个在站点处于“阶段”时，然后在“生产”时指向另一个。如何为 Web 服务设置不同的 URL？我注意到 URL 是硬编码在 .disco 文件中的。有没有办法做这个动态设置？我也试过这个解决方案：

[不是 Visual Studio 2010 中的 Web 项目的项目的 App.Config 转换？](https://stackoverflow.com/questions/3004210/app-config-transformation-for-projects-which-are-not-web-projects-in-visual-stud)

但是由于某种原因，当我编译我的网站时，编译了库，但应用程序配置没有被复制到 bin 文件夹中。所以我假设我的 Web 服务 URL 是硬编码在库 dll 中的。任何帮助是极大的赞赏。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:23:55.173

您说您编译了您的“网站”，这表明您有一个网站项目，该项目正在引用您的 Web 服务引用所在的类库项目。

如果是，该网站将有一个 web.config 文件 - 对其进行转换，而不是类库项目中的 app.config。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T21:24:43.180

可能需要更多信息，但我可以在早期告诉您：

您始终可以将服务器（主机）设置为为相同的确切服务“提供”两个不同的端点，这可以从 Visual Studio 使用您的 WCF 配置选项进行配置。

如果您的意思是“指向”具有相同 Web 服务定义的不同 url，那么您只需要实例化您在添加 Web 引用时创建的代理，并在构造函数中提供您在生产中使用的另一个 url。

您的 web 配置通常被复制到您的 bin 文件夹中，也许您应该检查您的部署安装过程。或尝试自己添加。

# c++ - 变量在对象列表中不变

> ID：13614568
> 
> 赞同：0
> 
> 时间：2012-11-28T21:15:31.913
> 
> 标签：c++, list, class, draw

我正在使用 openGL 和 c++ 制作一个小行星游戏。我遇到了一个问题，我现在将尝试描述。

我有一个小行星类，它有变量和方法。它有一个 create 方法来设置小行星的当前位置，还有一个 draw 方法用来随机改变小行星的位置。

当我尝试在我的主课中使用这颗小行星时，它工作正常。它会移动并做我想做的一切。

然后，我为创建小行星列表的 Asteroid Generator 创建了一个类，并且我还有一个方法可以初始化列表中每个元素的 draw 方法。但是当我运行它时，小行星并没有移动。我使用visual studio完成了我的代码，我发现在小行星的draw方法中值被正确更改，但是当再次绘制时，位置被重置回原来的值，所以它不会移动. 这可能与每个方法之后的 c++ 转储内存有关，所以我相信我搞砸了指针。如果您能帮我发现我的错误，我将不胜感激！

我添加了头文件和方法来展示我如何使用我的小行星生成器。

小行星生成器

```
#ifndef ASTEROIDGEN_H
#define ASTEROIDGEN_H

#undef UNICODE
#define WIN32_LEAN_AND_MEAN

#include <windows.h>    // for timeGetTime()
#include <mmsystem.h>   // ditto
#include <iostream>     // I/O
#include "model3DS.h"
#include "Camera.h"
#include <glut.h>       // for gluPerspective & gluLookAt
#include <List>
#include "asteroid.h"
#include "position.h"

class AsteroidGen{
    public:
        std::list<Asteroid> listAsteroids;
        void AsteroidGen::generateAsteroid(int amount, int delet);
        void AsteroidGen::DrawAsteroids();
};

#endif // ASTEROIDGEN_H 
```

AsteroidGen.cpp

```
#include "asteroidgen.h"

void AsteroidGen::generateAsteroid(int amount, int delet){
        if (delet == true)
            listAsteroids.clear();

        for (int i = 0; i < amount; i++)
        {
            Asteroid temp;
            temp.Create();
            listAsteroids.push_front(temp);
        }
}

void AsteroidGen::DrawAsteroids(){
    for each (Asteroid c in listAsteroids){
        c.Draw();  
    }
} 
```

小行星.h

```
#ifndef ASTEROID_H
#define ASTEROID_H

#undef UNICODE
#define WIN32_LEAN_AND_MEAN

#include <windows.h>    // for timeGetTime()
#include <mmsystem.h>   // ditto
#include <iostream>     // I/O
#include "model3DS.h"
#include "Camera.h"
#include "position.h"
#include <glut.h>       // for gluPerspective & gluLookAt
#include <cmath>
#include "textureTGA.h"

class Asteroid{
    public:
    GLuint textureId;
        GLuint list;
        Position pos;
        float incX;
        float incY;
        float asteroidSpeed;
        float radio;
        float rotation;
        bool status;

        void Asteroid::GenSphere();
        void Asteroid::Reset();
        void Asteroid::Draw();
        void Asteroid::Create();
};

#endif // ASTEROID_H 
```

主文件

初始化一次

```
asteroidgen.generateAsteroid(1, false); 
```

每帧绘制方法

```
asteroidgen.DrawAsteroids(); 
```

编辑：

```
void Asteroid::Draw(){
    pos.z += asteroidSpeed;
    pos.y += incY;
    pos.x += incX;
    rotation += 1;

    glPushMatrix();
        glTranslatef(pos.x, pos.y, pos.z);    
        glRotatef(rotation, 1, 1, 1);
        glBindTexture(GL_TEXTURE_2D,textureId);
        glCallList(list);
    glPopMatrix();
} 
```

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T22:13:13.993

问题是`listAsteroids`持有小行星，而不是指向小行星的指针。`std::list<Asteroid> listAsteroids;`通过更改为`std::list<Asteroid*> listAsteroids;`and 而不是`Asteroid temp;`do来修复它`Asteroid* temp = new Asteroid`。

您的实际问题是在 for 循环中引起的。`for each (Asteroid c in listAsteroids)`在这里，您将获得每个 Asteroid 实例的按值复制`Asteroid c`，然后将其更改，并且不会更改实际实例。再次`Asteroid* c`在这里使用，所以你得到一个指向**实际**实例的指针。

这样，您的列表包含指向 Asteroids 实际实例的指针，而不是按值复制实例（这会导致这些临时更改为临时对象）

除了解决您的问题之外，这还可以节省时间和资源；例如，如果您曾经将列表用作函数中的参数，则复制指针比复制值要快得多。只要记住使用`->`而不是`.`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T21:25:17.627

这只是一个猜测，但您的 Astroid 类的复制构造函数可能无法在 OpenGL 中正常工作？我注意到在 generate 方法中，您在堆栈上创建了一个新的 astroid，调用 Create() 函数，然后将其推送到列表中。在那个时间点，该列表有一个创建的 astroid 的副本，而不是那个名为 temp 的确切副本。我会亲自在堆上创建一个 astroid，然后使列表成为指向 astroid 的指针列表。只要您记得进行所有适当的内存清理，这可能会有所帮助。让我知道这是否接近！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T21:57:26.540

我认为问题在于“for each”循环；它似乎是按值迭代列表，因此获取列表中每个 Asteroid 的副本，然后在其 Draw 方法中对其进行修改，但这些修改会丢失，因为它只是一个副本。

我不完全确定，因为那是非标准语法；据我所知，这是一些奇怪的 Visual C++ 扩展。标准的写法是：

```
for (Asteroid& asteroid : listAsteroids) {
    asteroid.Draw();
} 
```

因为这是一个参考，所以这些变化应该坚持下去。

# javascript - 在 javascript 中使用通配符搜索文件名

> ID：13614577
> 
> 赞同：0
> 
> 时间：2012-11-28T21:15:54.783
> 
> 标签：javascript, regex

我正在使用通配符 (* %.) 搜索文件名，即用户将输入表达式，脚本将在预定义目录中的文件名上运行用户输入模式。我尝试在 javascript 中执行此操作，但面临问题. 我是javascript新手，所以不知道这是否是最好的方法。这是我尝试的代码片段：

```
<script>
function checkPattern(str1) 
{
var matchesFound = new Array();
for(var i=0; i<directory.length;i++)
{
    var newStr1 = directory[i];

    if(newStr1 == newStr1.match(str1))
        matchesFound.push(newStr);

}
//display items in matchesFound
}
</script>
</head>
<body>

<form>
<input name="testText" type="text" size=45>
<button onClick="checkPattern(testText.value);">Check pattern</button>

</form>
</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:57:16.953

让我们使用 SQL 语法（`%`通配符）。

要将此类搜索字符串转换为正则表达式模式，请使用以下内容 »

```
RegExp.quote = function(str) {
  return (str+'').replace(/([.?*+^$[\]\\(){}|-])/g, '\\$1');
};

var replaceCallback = function(match) { 
  return RegExp.quote(match);
}

regexPattern = searchString.replace(/[^%]+/g, replaceCallback).replace(/%/g, ".*"); 
```

**[在这里](http://jsfiddle.net/ncXTa/)**测试一下。

然后你可以使用这样的正则表达式模式`RegExp`- 阅读**[这个](http://www.regular-expressions.info/javascriptexample.html)**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T21:31:10.117

您需要将这些通配符转换为有效的正则表达式。现在你正试图匹配一个字符串和另一个字符串。

# ruby-on-rails - Heroku 在为其在 Rails 中的视图设置模型字段时出错

> ID：13614578
> 
> 赞同：0
> 
> 时间：2012-11-28T21:16:00.227
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord, heroku, ruby-on-rails-3.2

我非常简单地在我的用户模型上设置了一个字段`UsersController#new`：

```
def new
  @user = User.new
  @user.next_billing_cycle = Date.today

  respond_to do |format|
    format.html # new.html.erb
    format.json { render json: @user }
  end
end 
```

在我的开发环境中完美运行。我的用户模型有`attr_accessible :next_billing_cycle`，所以它也有一`date_select`组相应的字段：

```
class User < ActiveRecord::Base
  attr_accessible :name, :next_billing_cycle
end 
```

但是，在 Heroku 中，我收到此错误：

```
2012-11-28T21:02:47+00:00 app[web.1]: Started GET "/users/new" for 173.55.174.235 at 2012-11-28 21:02:47 +0000
2012-11-28T21:02:47+00:00 heroku[router]: at=info method=GET path=/users/new host=example.com fwd=173.55.174.235 dyno=web.1 queue=0 wait=0ms connect=1ms service=402ms status=500 bytes=643
2012-11-28T21:02:47+00:00 app[web.1]: 
2012-11-28T21:02:47+00:00 app[web.1]: NoMethodError (undefined method `next_billing_cycle=' for #<User:0x00000004f47618>):
2012-11-28T21:02:47+00:00 app[web.1]: 
2012-11-28T21:02:47+00:00 app[web.1]: Completed 500 Internal Server Error in 322ms
2012-11-28T21:02:47+00:00 app[web.1]: 
2012-11-28T21:02:47+00:00 app[web.1]:   app/controllers/users_controller.rb:29:in `new'
2012-11-28T21:02:47+00:00 app[web.1]: Processing by UsersController#new as HTML 
```

***更新***：我应该说清楚，我**确实**跑了`heroku rake db:migrate`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T21:32:14.953

你的意思是使用`attr_accessor`？或者是`next_billing_cycle`数据库中的一列？

# php - 如何通过我的 wasit 服务器从服务器获取图像？

> ID：13614591
> 
> 赞同：1
> 
> 时间：2012-11-28T21:17:15.857
> 
> 标签：php

我想通过我的服务器（wasit 服务器）从其他服务器检索图像并将其发送给客户端。我使用了这个结构：

测试.html：

```
<img src="test2.php?img=http://the server/img/a.jpg"> 
```

测试2.php：

```
<?php
ob_start();
if (isset($_GET['img'])) {
    $im = imagecreatefromjpeg($_GET['img']);
    header('Content-Type: image/jpeg');
    imagejpeg($im);
    imagedestroy($im);
}
ob_end_flush();
?> 
```

但它不起作用。

为什么？请帮我 ！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T03:05:09.890

你看过你的错误日志吗？

您可能至少面临以下问题之一（也可能是其他问题）：

*   您没有（正确）安装 GD 库。
    *   但是如果你这样做了：你安装了这个库的哪个版本？
*   在您的`php.ini`中，您已设置：`allow_url_fopen=0`

最后一个错误禁止您从服务器外部加载图像。

如果您向我们提供您的错误日志中关于您的脚本的内容，我们将能够为您提供更好的帮助。

# c++ - Qt Signal/Slot 示例的链接器错误

> ID：13614593
> 
> 赞同：5
> 
> 时间：2012-11-28T21:17:19.040
> 
> 标签：c++, visual-studio-2010, qt, linker-errors

我有一个带有多个使用信号和插槽的类的 Qt 应用程序，它编译得很好。但是，当我在主 CPP (main.cpp) 文件中创建自定义类时，会出现链接器错误。

这是我使用的代码：

```
class Counter : public QObject
{
    Q_OBJECT

public:
    Counter() { m_value = 0; }

    int value() const { return m_value; }

public slots:
    void setValue(int value)
    {
     if(value!=m_value)
     {
         m_value = value;
         qDebug() << "Value " << value;
         emit valueChanged(value);
     }
    }

signals:
    void valueChanged(int newValue);

private:
    int m_value;
};

int main(int argc, char *argv[])
{
    QCoreApplication app(argc, argv);
    Counter a, b;
    QObject::connect(&a, SIGNAL(valueChanged(int)), &b, SLOT(setValue(int)));

    a.setValue(12);     // a.value() == 12, b.value() == 12
    b.setValue(48);     // a.value() == 12, b.value() == 48

    QTimer::singleShot(0, &app, SLOT(quit()));

    return app.exec();
} 
```

以下是错误：

```
Error   4   error LNK2001: unresolved external symbol "public: virtual struct QMetaObject const * __thiscall Counter::metaObject(void)const " (?metaObject@Counter@@UBEPBUQMetaObject@@XZ)  
Error   5   error LNK2001: unresolved external symbol "public: virtual void * __thiscall Counter::qt_metacast(char const *)" (?qt_metacast@Counter@@UAEPAXPBD@Z)
Error   6   error LNK2001: unresolved external symbol "public: virtual int __thiscall Counter::qt_metacall(enum QMetaObject::Call,int,void * *)" (?qt_metacall@Counter@@UAEHW4Call@QMetaObject@@HPAPAX@Z)   
Error   7   error LNK2019: unresolved external symbol "protected: void __thiscall Counter::valueChanged(int)" (?valueChanged@Counter@@IAEXH@Z) referenced in function "public: void __thiscall Counter::setValue(int)" (?setValue@Counter@@QAEXH@Z) 
```

**当我将计数器放在单独的头文件中时，不会发生此链接器错误。这种行为的原因是什么？**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-28T21:27:09.840

我假设你正在使用`qmake`.

`moc`默认情况下，它会自动在头文件上运行，因为这是一般声明类的地方。请注意，此规则是在 makefile 中定义的，您可以`moc`在源文件上手动运行。

您必须通知`qmake`该文件包含一个类。为此，`#include "filename.moc"`请将`Counter`. 您可以[在此处 (QtCentre)](http://www.qtcentre.org/threads/28580-Why-does-qmake-moc-only-process-header-files)或[此处 (doc)](http://doc.qt.digia.com/qt/moc.html#writing-make-rules-for-invoking)查看更多详细信息。

如果您使用的是其他工具`qmake`，例如 CMake，则必须指定一个规则来强制 moc 解析`.cpp`文件（最简单的是处理所有文件）。对于不包含 Qt 对象类的文件，`moc`将生成一个空文件。

然而，即使这个类是“私有的”，我建议你在标题中声明它（例如`counter_private.h`）。例如，Qt 源码就使用了这个技巧。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T21:26:41.797

看起来您只有一个代码文件。如果您使用默认方式创建 Qt 项目构建（qmake && make 或 QtCreator），MOC 仅扫描 *.h 文件。如果您将所有代码放在一个 main.cpp 中，MOC 将不会创建任何代码，但这是 Signal/Slots 工作所必需的。

使这个特定示例工作的最简单方法是在 main.cpp 的末尾添加一行“#include “main.moc””。qmake 将检测到此依赖关系，并创建所需的 Makefile 目标。

最可爱的方法是干净的：一个类 - 一个头文件和一个实现文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-28T21:21:09.863

他们 moc/uic 自定义构建命令是在头文件上完成的，所以当放在单独的头文件/源文件中而不是放在同一个源文件中时它会编译

# android - Android NDK：ndk-build 构建错误

> ID：13614597
> 
> 赞同：1
> 
> 时间：2012-11-28T21:17:51.060
> 
> 标签：android, ubuntu, android-ndk

我开始使用 android ndk (r8c)，为此我安装了新版本的 Ubuntu 12.10 (32bit) 问题，无论我尝试构建什么，我都会遇到让我发疯的怪异错误......

> ~/workspace/Test$ ndk-build
> 
> 编译拇指：Test <= Test.c SharedLibrary：libTest.so arm-linux-androideabi-g++：错误：./obj/local/armeabi/objs/Test/Test.o：没有这样的文件或目录 make： *** [obj /local/armeabi/libTest.so] 错误 1

所以在这里，我尝试在 jni 中的一个简单的 hello world 上运行 ndk-build。我无法理解这个问题，因为我认为 ndk-build 命令应该创建 Test.o 本身......所以我用 ndk-r7 尝试了同样的事情（我们永远不知道），它甚至更丑陋...... .

> ~/workspace/Test$ ~/Code/android-ndk-r7/ndk-build
> 
> 编译拇指：Test <= Test.c Messages de l'assembleur: Erreur fatale: option -march= invalide: « armv5te » make: *** [obj/local/armeabi/objs/Test/Test.o] Erreur 1

我找不到任何似乎有帮助的答案。（我也尝试过以相同的方式构建 hello-jni 示例，但输出是相同的。

请有人救救我的头发...希望我已经足够清楚了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T22:25:49.983

所以我决定重新安装我的ubuntu，这次它运行良好。

我仍然不知道为什么它不是第一次，因为我认为我做了完全相同的操作（虽然我去了 Ubuntu 12.04 而不是 12.10）。

# html - 带有图像交换的 CSS 水平导航不起作用

> ID：13614600
> 
> 赞同：0
> 
> 时间：2012-11-28T21:18:04.737
> 
> 标签：html, css, navigation, horizontallist

无法弄清楚我做错了什么......

[http://tacticaloffense.com/indexNew.php](http://tacticaloffense.com/indexNew.php)

这是我的 HTML：

```
 <div id="headerTopNav">
    <ul id="topNav">
      <li id="home"><a href="index.php" class="home">Home</a></li>
      <li id="about"><a href="about.php" class="about">About</a></li>
      <li id="products"><a href="shop/index.php" class="products">Products</a></li>
      <li id="wpNews"><a href="news/index.php" class="wpNews">News</a></li>
      <li id="contact"><a href="contact.php" class="contact">Contact</a></li>
    </ul>
  </div> 
```

这是我的CSS：

```
#headerTopNav {
    position:absolute;
    top:11px;
    left:520px;
    height:30px;
}
#topNav {
    height:30px;
    padding:0;
    margin:0;
    display:inline;
}
#topNav li {
    list-style:none;
    display:inline;
}
#topNav li:after {
    border-right:1px solid #063d04;
}
#topNav li:last-child {
    border:none;
}
#topNav a {
    background:url(../img/nav/nav_map.png);
    display:inline-block;
    height:30px;
    text-indent:-9000px;
}
#topNav a.home,
#topNav a.about,
#topNav a.products,
#topNav a.wpNews,
#topNav a.contact {
    height:30px;
}
#topNav li#home, #topNav a.home {
    width:77px;
}
#topNav li#about, #topNav a.about {
    width:102px;
}
#topNav li#products, #topNav a.products {
    width:99px;
}
#topNav li#wpNews, #topNav a.wpNews {
    width:72px;
}
#topNav li#contact, #topNav a.contact {
    width:92px;
}

#topNav a.home:link, #topNav a.home:visited {
    background:url(../img/nav/nav_map.png) no-repeat -246px 0px;
}
#topNav a.home:hover {
    background:url(../img/nav/nav_map.png) no-repeat -246px -30px;
}
#topNav a.about:link, #topNav a.about:visited {
    background:url(../img/nav/nav_map.png) no-repeat 0px 0px;
}
#topNav a.about:hover {
    background:url(../img/nav/nav_map.png) no-repeat 0px -30px;
}
#topNav a.products:link, #topNav a.products:visited {
    background:url(../img/nav/nav_map.png) no-repeat -570px 0px;
}
#topNav a.products:hover {
    background:url(../img/nav/nav_map.png) no-repeat -570px -30px;
}
#topNav a.wpNews:link, #topNav a.wpNews:visited {
    background:url(../img/nav/nav_map.png) no-repeat -447px -60px;
}
#topNav a.wpNews:hover {
    background:url(../img/nav/nav_map.png) no-repeat -447px -90px;
}
#topNav a.contact:link, #topNav a.contact:visited {
    background:url(../img/nav/nav_map.png) no-repeat -140px -60px;
}
#topNav a.contact:hover {
    background:url(../img/nav/nav_map.png) no-repeat -140px -90px;
} 
```

有人能帮忙吗？我正在尝试使用图像做一个水平导航菜单，以便您在每个链接上看到一个图像，当您将鼠标悬停在每个链接上时会看到一个不同的图像。一共10张图片。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T21:20:51.387

将内联放在 ul 类中。您还应该对 li 元素应用宽度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T19:07:21.960

`#logo`菜单是你的。将宽度应用于徽标或`z-index`菜单。以下其中一项可以解决您的问题。

无论是这个

```
#logo {
  padding-left: 45px;
  padding-top: 21px;
  position: relative;
  width: 360px;
} 
```

或这个

```
#topNav {
  display: inline;
  height: 30px;
  margin: 0;
  padding: 0;
  position: relative;
  z-index: 100;
} 
```

# gwt - Cloudfoundry 上的基本 spring gwt 应用程序在加载屏幕上挂起

> ID：13614604
> 
> 赞同：1
> 
> 时间：2012-11-28T21:18:19.700
> 
> 标签：gwt, spring-roo, cloud-foundry

我使用 GWT 和 HSQL/Hibernate 将一个非常简单的 Spring ROO Java (6) 应用程序部署到 Cloudfoundry。它已部署并正在运行，但在访问时，浏览器窗口仅显示“正在加载”并且似乎无限期挂起。它通过 Maven 目标“gwt:run”在本地运行良好。

仅供参考，我已经以相同的方式构建了一个类似的应用程序，仅使用 MVC 而不是 GWT，并且它已部署并运行良好。MVC 应用程序使用多个 HSQL 表。

我已将 GWT 应用程序简化为包含单个字段的单个表，但仍然无法显示它。关于从哪里开始寻找的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T23:03:35.750

用户提出问题时回答了问题：“好吧，我找到了自己的答案，发布在 Springsource 网站上：线程：如何将 gwt 项目部署到 tomcat？ http: [//forum.springsource.org/showthread.php ?105346 -how-to-deploy-a-gwt-project-to-tomcat](http://forum.springsource.org/showthread.php?105346-how-to-deploy-a-gwt-project-to-tomcat) "

# sql - 使用 table() 函数加入慢得多

> ID：13614606
> 
> 赞同：1
> 
> 时间：2012-11-28T21:18:29.573
> 
> 标签：sql, oracle, plsql

我试图在对象上使用 table() 函数，以便在 PL/SQL 函数中进行连接。使用此功能时，查询最多可能需要 20 分钟才能完成；当我直接将数据输入到表格中时，只需不到 5 秒。我无法弄清楚为什么会有如此显着的差异，但我最好的预感是连接表中的列上的索引没有被使用。表和对象的列定义是相同的。

这是一些示例代码：

```
create or replace type VARCHAR20_TYPE is OBJECT
(
  val varchar2(20 byte);
);

create or replace type VARCHAR20_TABLE is table of VARCHAR20_TYPE;

create or replace FUNCTION test_function( 
    in_project_ids VARCHAR20_TABLE
  ) RETURN INTEGER
  IS
    l_result INTEGER;
  BEGIN

    SELECT count(*) into l_result FROM project p JOIN TABLE(in_project_ids) t ON p.project_id = t.val;      
    RETURN l_result;

  END; 
```

如果我要`in_project_ids`在上面的示例中替换为具有相同列定义的真实表的连接，它会显着提高函数的性能。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-28T21:24:41.713

这是可以预料的。在处理像这样的内存数组时，Oracle 将假设该表中有 8k 行。

试试这个来帮助它：

```
SELECT /*+ cardinality(t, 20) */ count(*) into l_result FROM project p JOIN TABLE(in_project_ids) t ON p.project_id = t.val; 
```

其中 20 应该是对实际条目数的粗略猜测。这是提示“可以”（并且需要帮助优化器）的边缘情况之一。

编辑

例如：

```
SQL> explain plan for SELECT /*+ cardinality(t, 1) */ * FROM project p JOIN TABLE(VARCHAR20_TABLE()) t ON p.project_id = t.val;

Explained.

SQL> select * From table(dbms_xplan.display);

Plan hash value: 858605789

--------------------------------------------------------------------------------------------------------
| Id  | Operation                               | Name         | Rows  | Bytes | Cost (%CPU)| Time     |
--------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                        |              |     1 |    27 |    30   (0)| 00:00:01 |
|   1 |  NESTED LOOPS                           |              |       |       |            |          |
|   2 |   NESTED LOOPS                          |              |     1 |    27 |    30   (0)| 00:00:01 |
|   3 |    COLLECTION ITERATOR CONSTRUCTOR FETCH|              |     1 |     2 |    29   (0)| 00:00:01 |
|*  4 |    INDEX UNIQUE SCAN                    | SYS_C0011177 |     1 |       |     0   (0)| 00:00:01 |
|   5 |   TABLE ACCESS BY INDEX ROWID           | PROJECT      |     1 |    25 |     1   (0)| 00:00:01 |
--------------------------------------------------------------------------------------------------------

Predicate Information (identified by operation id):
---------------------------------------------------

   4 - access("P"."PROJECT_ID"=TO_NUMBER(SYS_OP_ATG(VALUE(KOKBF$),1,2,2)))

Note
-----
   - dynamic sampling used for this statement (level=2)

21 rows selected.

SQL> explain plan for SELECT * FROM project p JOIN TABLE(VARCHAR20_TABLE()) t ON p.project_id = t.val;

Explained.

SQL> select * From table(dbms_xplan.display);

Plan hash value: 583089723

--------------------------------------------------------------------------------------------------
| Id  | Operation                              | Name    | Rows  | Bytes | Cost (%CPU)| Time     |
--------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                       |         |  8168 |   215K|    33   (4)| 00:00:01 |
|*  1 |  HASH JOIN                             |         |  8168 |   215K|    33   (4)| 00:00:01 |
|   2 |   TABLE ACCESS FULL                    | PROJECT |  2000 | 50000 |     3   (0)| 00:00:01 |
|   3 |   COLLECTION ITERATOR CONSTRUCTOR FETCH|         |  8168 | 16336 |    29   (0)| 00:00:01 |
--------------------------------------------------------------------------------------------------

Predicate Information (identified by operation id):
---------------------------------------------------

   1 - access("P"."PROJECT_ID"=TO_NUMBER(SYS_OP_ATG(VALUE(KOKBF$),1,2,2)))

Note
-----
   - dynamic sampling used for this statement (level=2)

19 rows selected. 
```

一个简单的例子，但请注意集合 fetch = 8168 上的“行”，没有提示和计划的更改。检查解释计划与真实表与集合与提示集合，并有帮助，使用合理的基数提示数，您的计划和性能应该得到改善。

# ios - iOS 上的 Twitter 框架 - 发布推文

> ID：13614608
> 
> 赞同：0
> 
> 时间：2012-11-28T21:18:34.680
> 
> 标签：ios, permissions, twitter, user-permissions

由于 Twitter 框架处理登录身份验证，这是否意味着我可以自由地将推文发布到用户的墙上？

由于通过设置页面登录 twitter 可以访问所有游戏，如果某些游戏滥用它并在用户的 twitter 页面上发送垃圾邮件怎么办？如果用户收到垃圾邮件并且只想阻止该游戏，这可能吗？

每当用户完成某事时，我的游戏都会自动发布帖子，我是否应该在每次发布推文之前征求许可？还是我应该简单地发布一条推文并希望它不会被视为垃圾邮件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T21:30:39.307

您可以向用户显示推文对话框，然后它会为您发布。这很容易做到，这里有一个很棒的教程：

[http://www.raywenderlich.com/21558/beginning-twitter-tutorial-updated-for-ios-6](http://www.raywenderlich.com/21558/beginning-twitter-tutorial-updated-for-ios-6)

# mysql - 使用 mysql 自动填充排序顺序

> ID：13614611
> 
> 赞同：0
> 
> 时间：2012-11-28T21:18:44.160
> 
> 标签：mysql

我有一个名为`t_home_feature`以下列的表：`id, type, sort_order`. 然后我执行了以下 MySQL 语句：

```
INSERT INTO t_home_feature (SELECT news_id, 'news', ( SELECT max(sort_order) + 1 FROM t_home_feature ) FROM t_news ) 
```

然后我做了 a`SELECT * FROM t_home_feature`但是所有行的 sort_order 的值等于`t_home_feature`插入语句之前的行数，而不是像`previous row + 1`.

如何修改我的插入查询以实现`previous row + 1`输出？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:23:20.357

您可以将 sort_order 转换为 auto_increment 字段，这意味着数据库将自动递增它，您无需在插入时引用它。这必须是键，但不是主键。例如，这里有一个例子：

[http://forums.mysql.com/read.php?22,264498,264967#msg-264967](http://forums.mysql.com/read.php?22,264498,264967#msg-264967)

该链接有一个解决方法的示例：

```
create table ai (
    id int auto_increment not null,
    xx varchar(9),
    key(id),
    primary key (xx)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T21:32:53.940

您可能必须对局部变量做一些花哨的事情。也许是这样的：

```
SELECT COUNT(1) INTO @maxval FROM t_home_feature;
INSERT INTO t_home_feature
SELECT news_id, 'news', @maxval:=@maxval+1 FROM t_news ; 
```

无需从表中自动增加任何值。

我以前回答问题的时候也做过这样的事情。以下是我在 DBA StackExchange 中使用局部变量回答的四 (4) 个问题示例：

*   [https://dba.stackexchange.com/questions/29007/update-ranking-on-table/29009#29009](https://dba.stackexchange.com/questions/29007/update-ranking-on-table/29009#29009)
*   [https://dba.stackexchange.com/questions/29016/selecting-without-repititions/29018#29018](https://dba.stackexchange.com/questions/29016/selecting-without-repititions/29018#29018)
*   [https://dba.stackexchange.com/questions/18987/update-rank-on-a-large-table/18990#18990](https://dba.stackexchange.com/questions/18987/update-rank-on-a-large-table/18990#18990)
*   [https://dba.stackexchange.com/questions/10251/whats-wrong-with-this-update-rank-query10320#10320](https://dba.stackexchange.com/questions/10251/whats-wrong-with-this-update-rank-query10320#10320)

# python - 如何在 Ubuntu 12.10 上安装 Google App 引擎？

> ID：13614615
> 
> 赞同：2
> 
> 时间：2012-11-28T21:18:58.480
> 
> 标签：python, google-app-engine, ubuntu, installation

从一开始一步一步将不胜感激！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-28T22:22:18.243

1.  [下载开发工具包](https://developers.google.com/appengine/downloads#Google_App_Engine_SDK_for_Python)。
2.  将 SDK 解压缩到`~/google_appengine`.
3.  目录中有一些程序`google_appengine`。您可以[将`google_appengine`目录添加到您`PATH`](https://askubuntu.com/q/60218/8005)的程序中，也可以将程序符号链接到您的 `PATH`. 例如，

    ```
    ln -s ~/google_appengine/dev_appserver.py ~/bin
    ln -s ~/google_appengine/appcfg.py ~/bin 
    ```

    请注意，如果`google_appengine`您`PATH`通过编辑 /etc/environment（这需要超级用户权限）将目录添加到您的目录，那么机器上的**所有用户都会将****您的**google_appengine 目录添加到他们的`PATH`. 这对他们来说可能是一个安全风险，如果他们也想安装 google appengine，这可能是一个烦恼。

4.  按照[Hello World 教程](https://developers.google.com/appengine/docs/python/gettingstartedpython27/helloworld)开始。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T21:20:58.193

1.  下载并解[压缩 zip 文件](http://googleappengine.googlecode.com/files/google_appengine_1.7.3.zip)。
2.  `google_appengine`在文件中添加解压文件夹的路径`/etc/environment`。
3.  注销并再次登录，现在`dev_appserver.py`在终端中运行命令，它不应该返回类似`dev_appserver.py: command not found`. `

# php - 将任何可转换的 utf8 char 音译成 ascii 等价物

> ID：13614622
> 
> 赞同：22
> 
> 时间：2012-11-28T21:19:18.297
> 
> 标签：php, utf-8, ascii, iconv, transliteration

有什么好的解决方案可以很好地进行这种音译吗？

我试过使用`iconv()`，但很烦人，而且它的行为不像人们预期的那样。

*   使用`//TRANSLIT`将尝试替换它可以替换的内容，将所有不可转换的内容保留为“？”
*   使用`//IGNORE`不会离开“？” `E_NOTICE`在文本中，但也不会音译，并且在找到不可转换的 char 时也会引发，因此您必须将 iconv 与@错误抑制器一起使用
*   使用`//IGNORE//TRANSLIT`（正如一些人在 PHP 论坛中建议的那样）实际上与`//IGNORE`（在 php 版本 5.3.2 和 5.3.13 上自己尝试过）相同
*   也使用`//TRANSLIT//IGNORE`与`//TRANSLIT`

它还使用当前的语言环境设置进行音译。

**警告 - 大量文本和代码如下！**

这里有些例子：

```
$text = 'Regular ascii text + čćžšđ + äöüß + éĕěėëȩ + æø€ + $ + ¶ + @';
echo '<br />original: ' . $text;
echo '<br />regular: ' . iconv("UTF-8", "ASCII//TRANSLIT", $text);
//> regular: Regular ascii text + ????? + ???ss + ?????? + ae?EUR + $ + ? + @

setlocale(LC_ALL, 'en_GB');
echo '<br />en_GB: ' . iconv("UTF-8", "ASCII//TRANSLIT", $text);
//> en_GB: Regular ascii text + cczs? + aouss + eeeeee + ae?EUR + $ + ? + @

setlocale(LC_ALL, 'en_GB.UTF8'); // will this work?
echo '<br />en_GB.UTF8: ' . iconv("UTF-8", "ASCII//TRANSLIT", $text);
//> en_GB.UTF8: Regular ascii text + cczs? + aouss + eeeeee + ae?EUR + $ + ? + @ 
```

好的，确实转换了 č ć š ä ö ü ß é ĕ ě ė ë ȩ 和 æ，但为什么不转换 đ 和 ø？

```
// now specific locales
setlocale(LC_ALL, 'hr_Hr'); // this should fix croatian đ, right?
echo '<br />hr_Hr: ' . iconv("UTF-8", "ASCII//TRANSLIT", $text);
// wrong > hr_Hr: Regular ascii text + cczs? + aouss + eeeeee + ae?EUR + $ + ? + @

setlocale(LC_ALL, 'sv_SE'); // so this will fix swedish ø?
echo '<br />sv_SE: ' . iconv("UTF-8", "ASCII//TRANSLIT", $text);
// will not > sv_SE: Regular ascii text + cczs? + aouss + eeeeee + ae?EUR + $ + ? + @

//this is interesting
setlocale(LC_ALL, 'de_DE');
echo '<br />de_DE: ' . iconv("UTF-8", "ASCII//TRANSLIT", $text);
//> de_DE: Regular ascii text + cczs? + aeoeuess + eeeeee + ae?EUR + $ + ? + @
// actually this is what any german would expect since ä ö ü really is same as ae oe ue 
```

让我们尝试`//IGNORE`：

```
echo '<br />ignore: ' . iconv("UTF-8", "ASCII//IGNORE", $text);
//> ignore: Regular ascii text + + + + + $ + + @
//+ E_NOTICE: "Notice: iconv(): Detected an illegal character in input string in /var/www/test.server.web/index.php on line 49"

// with translit?
echo '<br />ignore/translit: ' . iconv("UTF-8", "ASCII//IGNORE//TRANSLIT", $text);
//same as ignore only> ignore/translit: Regular ascii text + + + + + $ + + @
//+ E_NOTICE: "Notice: iconv(): Detected an illegal character in input string in /var/www/test.server.web/index.php on line 54"

// translit/ignore?
echo '<br />translit/ignore: ' . iconv("UTF-8", "ASCII//TRANSLIT//IGNORE", $text);
//same as translit only> translit/ignore: Regular ascii text + cczs? + aouss + eeeeee + ae?EUR + $ + ? + @ 
```

使用[这个人的解决方案](https://stackoverflow.com/a/6857767/555097)也不能按预期工作：`Regular ascii text + YYYYY + aous + eYYYeY + aoY + $ + � + @`

即使使用 PECL intl [Normalizer](http://www.php.net/manual/en/class.normalizer.php)类（即使您的 PHP > 5.3.0 也不总是可用的，因为 ICU 包 intl 使用可能对 PHP 不可用，即在某些托管服务器上）会产生错误的结果：

```
echo '<br />normalize: ' .preg_replace('/\p{Mn}/u', '', Normalizer::normalize($text, Normalizer::FORM_KD));
//>normalize: Regular ascii text + cczsđ + aouß + eeeeee + æø€ + $ + ¶ + @ 
```

那么有没有其他方法可以做到这一点，或者唯一正确的做法是自己做`preg_replace()`或`str_replace()`定义音译表？

// 附录：我在 2008 年的 ZF wiki 辩论中发现了有关[Zend_Filter_Transliterate 提案的建议，](http://framework.zend.com/wiki/display/ZFPROP/Zend_Filter_Transliteration+-+Martin+Hujer)但由于在某些语言中无法转换（即中文），因此该项目被放弃，但对于任何基于拉丁语和西里尔语的语言 IMO 仍然有此选项应该存在。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-11-14T15:48:54.613

Patchwork\Utf8 的 toAscii() 函数正是这样做的，请参见：

[https://github.com/nicolas-grekas/Patchwork-UTF8/blob/master/src/Patchwork/Utf8.php](https://github.com/nicolas-grekas/Patchwork-UTF8/blob/master/src/Patchwork/Utf8.php)

它利用 iconv 和 intl 的 Normalizer 来删除重音、拆分连字并执行许多其他通用音译。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-28T21:41:45.167

从[这个网站](http://myshadowself.com/coding/php-function-to-convert-accented-characters-to-their-non-accented-equivalant/)，我发现了一些可能对你有帮助的东西：

```
function removeAccents($str)
{
  $a = array('À', 'Á', 'Â', 'Ã', 'Ä', 'Å', 'Æ', 'Ç', 'È', 'É', 'Ê', 'Ë', 'Ì', 'Í', 'Î', 'Ï', 'Ð', 'Ñ', 'Ò', 'Ó', 'Ô', 'Õ', 'Ö', 'Ø', 'Ù', 'Ú', 'Û', 'Ü', 'Ý', 'ß', 'à', 'á', 'â', 'ã', 'ä', 'å', 'æ', 'ç', 'è', 'é', 'ê', 'ë', 'ì', 'í', 'î', 'ï', 'ñ', 'ò', 'ó', 'ô', 'õ', 'ö', 'ø', 'ù', 'ú', 'û', 'ü', 'ý', 'ÿ', 'Ā', 'ā', 'Ă', 'ă', 'Ą', 'ą', 'Ć', 'ć', 'Ĉ', 'ĉ', 'Ċ', 'ċ', 'Č', 'č', 'Ď', 'ď', 'Đ', 'đ', 'Ē', 'ē', 'Ĕ', 'ĕ', 'Ė', 'ė', 'Ę', 'ę', 'Ě', 'ě', 'Ĝ', 'ĝ', 'Ğ', 'ğ', 'Ġ', 'ġ', 'Ģ', 'ģ', 'Ĥ', 'ĥ', 'Ħ', 'ħ', 'Ĩ', 'ĩ', 'Ī', 'ī', 'Ĭ', 'ĭ', 'Į', 'į', 'İ', 'ı', 'Ĳ', 'ĳ', 'Ĵ', 'ĵ', 'Ķ', 'ķ', 'Ĺ', 'ĺ', 'Ļ', 'ļ', 'Ľ', 'ľ', 'Ŀ', 'ŀ', 'Ł', 'ł', 'Ń', 'ń', 'Ņ', 'ņ', 'Ň', 'ň', 'ŉ', 'Ō', 'ō', 'Ŏ', 'ŏ', 'Ő', 'ő', 'Œ', 'œ', 'Ŕ', 'ŕ', 'Ŗ', 'ŗ', 'Ř', 'ř', 'Ś', 'ś', 'Ŝ', 'ŝ', 'Ş', 'ş', 'Š', 'š', 'Ţ', 'ţ', 'Ť', 'ť', 'Ŧ', 'ŧ', 'Ũ', 'ũ', 'Ū', 'ū', 'Ŭ', 'ŭ', 'Ů', 'ů', 'Ű', 'ű', 'Ų', 'ų', 'Ŵ', 'ŵ', 'Ŷ', 'ŷ', 'Ÿ', 'Ź', 'ź', 'Ż', 'ż', 'Ž', 'ž', 'ſ', 'ƒ', 'Ơ', 'ơ', 'Ư', 'ư', 'Ǎ', 'ǎ', 'Ǐ', 'ǐ', 'Ǒ', 'ǒ', 'Ǔ', 'ǔ', 'Ǖ', 'ǖ', 'Ǘ', 'ǘ', 'Ǚ', 'ǚ', 'Ǜ', 'ǜ', 'Ǻ', 'ǻ', 'Ǽ', 'ǽ', 'Ǿ', 'ǿ');
  $b = array('A', 'A', 'A', 'A', 'A', 'A', 'AE', 'C', 'E', 'E', 'E', 'E', 'I', 'I', 'I', 'I', 'D', 'N', 'O', 'O', 'O', 'O', 'O', 'O', 'U', 'U', 'U', 'U', 'Y', 's', 'a', 'a', 'a', 'a', 'a', 'a', 'ae', 'c', 'e', 'e', 'e', 'e', 'i', 'i', 'i', 'i', 'n', 'o', 'o', 'o', 'o', 'o', 'o', 'u', 'u', 'u', 'u', 'y', 'y', 'A', 'a', 'A', 'a', 'A', 'a', 'C', 'c', 'C', 'c', 'C', 'c', 'C', 'c', 'D', 'd', 'D', 'd', 'E', 'e', 'E', 'e', 'E', 'e', 'E', 'e', 'E', 'e', 'G', 'g', 'G', 'g', 'G', 'g', 'G', 'g', 'H', 'h', 'H', 'h', 'I', 'i', 'I', 'i', 'I', 'i', 'I', 'i', 'I', 'i', 'IJ', 'ij', 'J', 'j', 'K', 'k', 'L', 'l', 'L', 'l', 'L', 'l', 'L', 'l', 'l', 'l', 'N', 'n', 'N', 'n', 'N', 'n', 'n', 'O', 'o', 'O', 'o', 'O', 'o', 'OE', 'oe', 'R', 'r', 'R', 'r', 'R', 'r', 'S', 's', 'S', 's', 'S', 's', 'S', 's', 'T', 't', 'T', 't', 'T', 't', 'U', 'u', 'U', 'u', 'U', 'u', 'U', 'u', 'U', 'u', 'U', 'u', 'W', 'w', 'Y', 'y', 'Y', 'Z', 'z', 'Z', 'z', 'Z', 'z', 's', 'f', 'O', 'o', 'U', 'u', 'A', 'a', 'I', 'i', 'O', 'o', 'U', 'u', 'U', 'u', 'U', 'u', 'U', 'u', 'U', 'u', 'A', 'a', 'AE', 'ae', 'O', 'o');
  return str_replace($a, $b, $str);
} 
```

用法示例：

```
$text = 'Regular ascii text + čćžšđ + äöüß + éĕěėëȩ + æø€ + $ + ¶ + @';
echo removeAccents($text); 
```

显示：

```
Regular ascii text + cczsd + aous + eeeeeȩ + aeo€ + $ + ¶ + @ 
```

你需要改进它，但你明白了……如果有直接的方法来做这样的工作，我不知道。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-05-30T12:43:54.093

我认为设置正确的语言环境是要走的路。请注意，特定的语言环境也必须在系统上可用，请使用`locale -a`. 如果你只有`de_DE.utf8`- 你也必须使用 set_locale( `de_DE.utf8`)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-08-06T11:53:22.227

由于上述解决方案都不适合我（我需要将许多欧洲字符集音译为 ASCII），我终于找到了这个似乎可以正常工作的旧 PECL 包[http://derickrethans.nl/projects.html#translit](http://derickrethans.nl/projects.html#translit)。我遇到了特别是西里尔字符集的问题，这似乎可以完美地处理它们。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-09-11T15:49:33.770

如果我对您的理解正确，我可能会为您提供答案：我编写了一个基本的 PHP 类，它允许您将大多数字符转换为它们的 ASCII 等价物。

下面是其输出的屏幕截图，它转换了名称中带有重音符号的各种作曲家名称。

你可以在这里从 github 分叉它[https://github.com/LukeMadhanga/transliterator](https://github.com/LukeMadhanga/transliterator)。

注意：它尚未被记录在案，但应该很容易掌握。

[![例子](../Images/148cc9750ef88dcb8e9341095e57cb68.png)](https://i.stack.imgur.com/DbGkg.png)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-03-14T23:18:12.897

我用 Golang 写了这个[https://github.com/marekkowalczyk/sanitize](https://github.com/marekkowalczyk/sanitize)；开箱即用，易于改进。

# ruby - watir splash 中的页面对象——如何确保实例化正确的页面对象

> ID：13614625
> 
> 赞同：1
> 
> 时间：2012-11-28T21:19:24.803
> 
> 标签：ruby, webdriver, automated-tests, watir, web-testing

我正在使用 Watir Splash 框架来测试一个 Web 应用程序，并且我已经设置了两个页面类。第一个是“登录”页面，详细信息如下：

```
module App
 module Page
 class Login < WatirSplash::Page::Base
  url "http://[removed].com"

    def login_btn
        modify button(:id => 'btnLogin'), :click => lambda {redirect_to VehicleSelection}
    end 
```

另一个页面类是“车辆选择”页面。我使用了[此处](http://itreallymatters.net/post/12242886944/awesome-page-objects-in-testing#.ULZ-TIdlX-s)文档中所示的修改方法，以确保成功登录后车辆选择页面对象可用于 RSpec。

但是如果登录失败会发生什么？我有一些测试用例故意将不正确的信息输入登录表单以确保身份验证正常工作。RSpec 需要“登录”类中定义的方法来访问正确的元素以完成测试用例。在这种情况下，无论如何都会返回我指定方法“VehicleSeleciton”对象的方式。（或者看起来）

任何帮助表示赞赏。此外，我对测试框架的其他建议持开放态度，特别是如果有更多示例代码可供我参考。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T18:10:22.197

以下是我尝试过的几种方法。我没有使用 WatirSplash 框架，但应用了相同的概念（尽管尝试的 WatirSplash 示例代码可能不是 100% 准确）。

**解决方案 1：返回页面对象**

我个人的偏好是不让页面对象返回页面对象。相反，我发现更容易阅读/使用测试中每个页面对象的显式初始化。Alister Scott 在他的[博客](http://watirmelon.com/2012/05/29/page-objects-returning-page-objects/)中讨论了这个问题。

您的测试将如下所示：

```
#For login successful tests
page = App::Page::Login.new
page.login_btn.click
page = App::Page::VehicleSelection.new  #The VehicleSelection page is explicitly initialized
page.validate_page #or whatever you want to do with the page

#For login failed tests
page = App::Page::Login.new
page.login_btn.click
page.validate_page #or whatever you want to do with the page 
```

**解决方案2：创建多种登录方法**

另一种解决方案是创建两种登录方法 - 一种用于成功登录，一种用于不成功登录。

页面对象可以是：

```
module App
    module Page
        class Login < WatirSplash::Page::Base
            url "http://[removed].com"

            def login(user, password)
                #Do whatever code to input name and password and then click the button

                #Then redirect to the VehicleSelection page since that is where you will want to go most often
                redirect_to VehicleSelection
            end

            def login_failed(user, password)
                login(user, password)               

                #Return the Login page (instead of the VehicleSelection page).
                redirect_to Login
            end
        end
    end
end 
```

测试是：

```
#For login successful tests
login_page = App::Page::Login.new
vehicle_page = login_page.login(user, password)
vehicle_page.validate_page #or whatever you want to do with the Vehicle Selection page

#For login failed tests
login_page = App::Page::Login.new
login_page.login_failed(user, password)
login_page.validate_page #or whatever you want to do with the Login page 
```

**解决方案 3：让按钮知道它要去哪里**

另一种解决方案是让登录按钮知道要重定向到哪个页面。

页面对象可以是：

```
module App
    module Page
        class Login < WatirSplash::Page::Base
            url "http://[removed].com"

            def login_btn(login_successful=true)
                if login_successful
                    modify button(:id => 'btnLogin'), :click => lambda {redirect_to VehicleSelection}
                else
                    modify button(:id => 'btnLogin'), :click => lambda {redirect_to Login}
                end
            end
        end
    end
end 
```

测试是：

```
#For login successful tests
login_page= App::Page::Login.new
vehicle_page = login_page.login_btn.click
vehicle_page.validate_page #or whatever you want to do with the Vehicle Selection page

#For login failed tests
login_page= App::Page::Login.new
login_page.login_btn(false).click
login_page.validate_page #or whatever you want to do with the Login page 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T19:43:55.080

感谢您试用我的宝石 WatirSplash。我会在解决方案#2 的行中写一些东西——例如，为成功登录和失败登录创建两个单独的方法。`#modify`两种方法都不需要使用，就像贾斯汀一样。

另外，我建议您使用我的其他宝石[测试页面](http://github.com/jarmo/test-page)，它或多或少与 WatirSplash 中的页面对象相同，但它被提取到单独的 gem 中 - WatirSplash 将在长期内被弃用，因为所有它的部分被提取到单独的 gem 中，以便更好地控制每个项目中需要哪些功能。

# java - 如何修改我的代码以仅获取日期的时间部分？

> ID：13614629
> 
> 赞同：1
> 
> 时间：2012-11-28T21:19:39.547
> 
> 标签：java, date

我有以下代码：

```
Date time = new SimpleDateFormat("HH:mm").parse("8:00"); 
```

当我打电话`time.toString()`时，会产生以下内容：

`Thu Jan 01 08:00:00 CET 1970`

有什么办法可以从中提取`8:00`出来吗？我进行了广泛搜索，但没有找到使用标准 SimpleDateFormat 的任何方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T21:21:14.980

> 当我调用 time.toString() 时，会产生以下内容

是的，它会是 - 因为你打电话给`Date.toString`. 值`Date`没有格式的概念。

> 有什么方法可以从中提取 8:00 吗？

每当您想转换为字符串时，都应该使用`DateFormat`. 因此，请使用您解析的相同格式。

或者，使用[Joda-Time](http://www.joda.org/joda-time/)，它有一个[`LocalTime`](http://www.joda.org/joda-time/apidocs/org/joda/time/LocalTime.html)专门用于“一天中的时间”的类型，并且有一个方便的`parse`方法。每次要转换为字符串时，您仍应*使用*格式化[程序，但至少在此之前该值将更易于使用且更具描述性。](http://www.joda.org/joda-time/apidocs/org/joda/time/format/DateTimeFormatter.html)

```
LocalTime localTime = LocalTime.parse("8:00"); 
```

要格式化它，您可以使用类似的东西，[`ISODateTimeFormat.hourMinute()`](http://www.joda.org/joda-time/apidocs/org/joda/time/format/ISODateTimeFormat.html#hourMinute())或者如果您可能有更高的精度，也许`ISODateTimeFormat.hourMinuteSecond()`- 请参阅文档以获取所有可用选项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T21:23:39.403

回收你的原始`SimpleDateFormat`对象

```
SimpleDateFormat format = new SimpleDateFormat("HH:mm")
Date time = format.parse("8:00");
String outString = format.format(time); 
```

如果您想知道，[这里有一些关于 DateTime Masks 的更多信息](http://publib.boulder.ibm.com/infocenter/eglce/v1r0/index.jsp?topic=/com.ibm.eglce.lr.doc/topics/regl_core_date_format.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-28T21:24:13.133

使用相同的 SimpleDateFormat 实例将日期格式化为字符串。

```
SimpleDateFormat sdf = new SimpleDateFormat("HH:mm");
Date time = sdf.parse("8:00");
System.out.println(sdf.format(time)); 
```

这将打印：

```
08:00 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-28T21:22:33.227

[java.util.Date](http://docs.oracle.com/javase/7/docs/api/java/util/Date.html)类表示特定的时间瞬间，精度为毫秒。

**API 说[java.util.Date.toString()](http://docs.oracle.com/javase/7/docs/api/java/util/Date.html#toString%28%29)**

> 将此 Date 对象转换为以下形式的字符串：
> dow mon dd hh:mm:ss zzz yyyy

为了格式化日期的使用[SimpleDateFormat](http://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html)类

```
 System.out.println(new SimpleDateFormat("HH:mm").format(time)); 
```

# java - Java DefaultMutableTree 不兼容类型

> ID：13614630
> 
> 赞同：2
> 
> 时间：2012-11-28T21:19:43.723
> 
> 标签：java, swing, types, jtree

一直在网上寻找答案，但还没有找到任何答案。我创建了以下方法

```
public void process(DefaultTreeModel tree){
    DefaultMutableTreeNode current = tree.getRoot();
} 
```

但是，编译器会抛出不兼容的类型错误。树是通过从我自己的类创建 DefaultMutableTreeNodes 来创建的，然后将它们添加到 DefaultMutableTree （经过测试并且工作正常）。

我不确定为什么类型不兼容，因为当我运行以下

```
public void process(DefaultTreeModel tree){
    Object o = tree.getRoot();
    System.out.println(o.getClass());
} 
```

它输出：

```
class javax.swing.tree.DefaultMutableTreeNode 
```

非常感谢所有帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:26:11.557

当您调用 getRoot() 时，[DefaultTreeModel返回一个对象。](http://docs.oracle.com/javase/1.4.2/docs/api/javax/swing/tree/DefaultTreeModel.html#getRoot%28%29)编译器没有关于它在运行时将是什么类型的信息，因此它假定它是一个对象并且不能将其转换为 DefaultMutableTreeNode。

即使它在运行时是正确的类，它也无法在编译时知道这一点。你将不得不检查它`instanceof`

```
Object o = tree.getRoot();
if(o instanceof DefaultMutableTreeNode) {
    DefaultMutableTreeNode root = (DefaultMutableTreeNode)o;
    ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T21:26:33.200

那是因为`getRoot`返回一个对象：[http://docs.oracle.com/javase/6/docs/api/javax/swing/tree/DefaultTreeModel.html#getRoot()](http://docs.oracle.com/javase/6/docs/api/javax/swing/tree/DefaultTreeModel.html#getRoot())

尝试铸造：

```
DefaultMutableTreeNode current = (DefaultMutableTreeNode)tree.getRoot(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-28T21:24:32.337

如果您查看[文档](http://docs.oracle.com/javase/1.4.2/docs/api/javax/swing/tree/DefaultTreeModel.html#getRoot%28%29)，您会看到`getRoot`返回一个`Object`. 您可以尝试投射：

```
DefaultMutableTreeNode current = (DefaultMutableTreeNode)tree.getRoot(); 
```

`getClass`可能正在返回`javax.swing.tree.DefaultMutableTreeNode`，因为此对象是 a 的实例*（*`DefaultMutableTreeNode`但它的类型仍然是`Object`，这就是您收到错误的原因）。

* * *

相关文件：

*   [`DefaultTreeModel`](http://docs.oracle.com/javase/1.4.2/docs/api/javax/swing/tree/DefaultTreeModel.html)
*   [`DefaultMutableTreeNode`](http://docs.oracle.com/javase/1.4.2/docs/api/javax/swing/tree/DefaultMutableTreeNode.html)

# c# - 如何在具有起点和方向矢量的网格中绘制 3D 空间中的线

> ID：13614636
> 
> 赞同：1
> 
> 时间：2012-11-28T21:19:55.490
> 
> 标签：c#, line, raytracing, bresenham

我正在开发第一人称 3D 游戏。关卡完全基于立方体，墙壁/地板/等都只是平铺的立方体（1x1x1）。

我目前正在使用相机位置和相机的旋转来获取方向来创建射线。然后我想将光线投射到第一个不为空的立方体上（或者当光线从网格上掉下来时）。很多时候，这些是方向向量，例如 0,0,1 或 1,0,0。

我在找到适用于方向矢量而不是起点/终点的 Bresenham 线条绘制算法时运气不佳。特别是考虑到方向向量不仅仅包含整数。

所以，对于一个特定的问题，我想我想问是否有人可以解释我是否接近以正确的方式解决这个问题，以及是否有人可能会详细说明无论如何应该如何完成。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:54:49.390

Bresenham 在这里不会帮助你，我担心......你需要的是 Ray/Line-Plane 相交算法：

*   [维基百科上的线平面交叉点](http://en.wikipedia.org/wiki/Line-plane_intersection)
*   [Wolfram 上的线平面交点](http://mathworld.wolfram.com/Line-PlaneIntersection.html)
*   [SigGraph 上的射线平面相交](http://www.siggraph.org/education/materials/HyperGraph/raytrace/rayplane_intersection.htm)

在非常粗糙的数学伪代码中：

（警告：我已经很久没有做 3d 图形了）

```
// Ray == origin point + some distance in a direction
myRay = Porg + t*Dir;

// Plane == Some point on cube face * normal of cube face (facing out),
// at some distance from origin
myPlane = Pcube * Ncubeface - d;

// Straight shot: from ray origin to point on cube direction
straightTo = (Pcube - Porg); 
```

通过这两个等式，您可以推断出一些事情：

*   如果 'straightTo' 和平面法线的点积为零（称为“angA”），则您的原点在立方体的面内。

*   如果光线方向和平面法线的点积接近于 0（称为“angB”），则光线平行于立方体的面——也就是说，不相交（除非你计算原点是否在立方体面，上面）。

*   如果 (-angA / angB) < 0，则您的光线指向远离立方体面。

还有其他的东西，但我已经在逼迫我微薄的记忆力了。:)

编辑：*可能*有一个“捷径”，现在我认为它有点......这一切都假设你正在为你的“地图”使用类似 3-d 数组的结构。

好的，请耐心等待，在我的手机上思考和打字——如果您使用标准的旧 Bresenham delta-error 算法，但将其“固定”为 2D 会怎样？

所以让我们说：

*   我们在 (10x10x10) “盒子”中的位置 (5, 5, 5)
*   我们指向 (1 0 0)（即 +X 轴）
*   从我们视锥体左上角投射的光线仍然只是一条线；“x”和“y”的定义改变了，就是
*   在这种情况下，“X”将是（心理可视化）......比如说沿着平行于眼线的轴，但与投射线齐平；也就是说，如果我们正在查看 (640x480) 的 2D 图像，“中心”是 (0,0)，左上角是 (-320,-240)，那么这条“X 轴线”将是一条线通过点 (-320,0) 投射到无穷远。
*   “Y”同样是正常“Y”轴的投影，所以......几乎相同，除非我们歪着头。
*   现在，当试图弄清楚下一个 deltaX 值是多少时，数学会变得非常棘手，但是一旦你弄清楚了公式，它基本上就是常数时间计算（现在我想起来了， “X 轴”只是通过您的相机投影投影的矢量 <1 0 0>，对吗？

对不起，我在回家的火车上。;)

# xslt - xslt 变量赋值是一次性完成的吗？

> ID：13614641
> 
> 赞同：0
> 
> 时间：2012-11-28T21:20:15.197
> 
> 标签：xslt

我需要知道变量**$transformed_date**是否每次都会被评估，或者这个变量是否与变量影响一样好（如在 C、Java 等中）。我想确保我不会一遍又一遍地重新评估同一件事。

```
<xsl:variable name="transformed_date" select="adjust-dateTime-to-timezone(xs:dateTime(concat(substring ($original_date, 1, 4),'-',substring ($original_date, 5, 2),'-',substring ($original_date, 7, 2),'T',substring ($original_date, 9, 2),':',substring ($original_date, 11, 2),':',substring ($original_date, 13, 2),'-00:00')), xs:dayTimeDuration('-PT5H'))"/>

<xsl:choose>
    <xsl:when test="substring (xs:string($transformed_date), 6, 2) = '01'">
        <fo:inline>
            Jan.
        </fo:inline>
    </xsl:when>
    <xsl:when test="substring (xs:string($transformed_date), 6, 2) = '02'">
        <fo:inline>
            Feb.
        </fo:inline>
    </xsl:when>
... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T21:23:44.070

xslt 中的变量只能设置一次。一旦设置，您将无法更改它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T00:16:41.670

您可能会假设该变量只会被评估一次。但是处理器可能会选择以不同的方式做事；可以免费优化。例如，假设变量占用大量空间而处理器内存不足，它可能会释放空间并在下次引用变量时重新评估变量。或者，如果处理器认为评估将非常便宜（例如，如果您说 select="23"），那么处理器可以决定在每次引用它时评估它，如果它认为这是最好的策略。

# java - Google AppEngine：开发服务器 - 读取“datastore-indexes-auto.xml”的访问被拒绝

> ID：13614655
> 
> 赞同：0
> 
> 时间：2012-11-28T21:21:08.983
> 
> 标签：java, security, google-app-engine, google-cloud-datastore, devserver

当我尝试在“http://localhost:8080/_ah/admin/datastore”的本地数据存储查看器中查看任何实体时，在 Windows 7 Pro 64 位上运行的 Google AppEngine 开发服务器会引发异常。实体列表显示得很好并且我的应用程序能够将实体添加到数据存储区。问题可能是什么？它与安全管理器有关吗？

```
Nov 28, 2012 8:59:59 PM com.google.appengine.api.datastore.dev.LocalDatastoreService init
INFO: Local Datastore initialized: 
    Type: High Replication
    Storage: d:\project\out\local_db.bin
Nov 28, 2012 8:59:59 PM com.google.appengine.api.datastore.dev.LocalDatastoreService load
INFO: Time to load datastore: 32 ms
Nov 28, 2012 8:59:59 PM com.google.apphosting.utils.jetty.JettyLogger warn
WARNING: /_ah/admin/datastore
java.security.AccessControlException: access denied (java.io.FilePermission d:\project\out\datastore-indexes-auto.xml read)
at java.security.AccessControlContext.checkPermission(AccessControlContext.java:374)
at java.security.AccessController.checkPermission(AccessController.java:546)
at java.lang.SecurityManager.checkPermission(SecurityManager.java:532)
at com.google.appengine.tools.development.DevAppServerFactory$CustomSecurityManager.checkPermission(DevAppServerFactory.java:289)
at java.lang.SecurityManager.checkRead(SecurityManager.java:871)
at java.io.File.exists(File.java:731)
at com.google.appengine.api.datastore.dev.LocalCompositeIndexManager.getGeneratedIndexFileInputStream(LocalCompositeIndexManager.java:430)
at com.google.appengine.api.datastore.dev.LocalCompositeIndexManager.getCompositeIndicesNode(LocalCompositeIndexManager.java:448)
at com.google.appengine.api.datastore.dev.LocalCompositeIndexManager.getIndices(LocalCompositeIndexManager.java:273)
at com.google.appengine.api.datastore.dev.LocalCompositeIndexManager.getIndicesForKind(LocalCompositeIndexManager.java:294)
at com.google.appengine.api.datastore.dev.LocalDatastoreCostAnalysis.changedIndexRows(LocalDatastoreCostAnalysis.java:136)
at com.google.appengine.api.datastore.dev.LocalDatastoreCostAnalysis.getWriteOps(LocalDatastoreCostAnalysis.java:83)
at com.google.appengine.api.datastore.dev.LocalDatastoreCostAnalysis.getWriteCost(LocalDatastoreCostAnalysis.java:61)
at com.google.appengine.api.datastore.dev.LocalDatastoreCostAnalysis.getCreationCostAnalysis(LocalDatastoreCostAnalysis.java:45)
at com.google.appengine.api.datastore.dev.LocalDatastoreService.getCreationCostAnalysis(LocalDatastoreService.java:2580)
at com.google.apphosting.utils.servlet.DatastoreViewerServlet.getEntityViews(DatastoreViewerServlet.java:211)
at com.google.apphosting.utils.servlet.DatastoreViewerServlet.doGetDatastoreViewer(DatastoreViewerServlet.java:295)
at com.google.apphosting.utils.servlet.DatastoreViewerServlet.doGet(DatastoreViewerServlet.java:235)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:617)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:511)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1166)
at com.google.appengine.api.socket.dev.DevSocketFilter.doFilter(DevSocketFilter.java:74)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at com.google.appengine.tools.development.ResponseRewriterFilter.doFilter(ResponseRewriterFilter.java:123)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at com.google.appengine.tools.development.HeaderVerificationFilter.doFilter(HeaderVerificationFilter.java:34)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at com.google.appengine.api.blobstore.dev.ServeBlobFilter.doFilter(ServeBlobFilter.java:61)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at com.google.apphosting.utils.servlet.TransactionCleanupFilter.doFilter(TransactionCleanupFilter.java:43)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at com.google.appengine.tools.development.StaticFileFilter.doFilter(StaticFileFilter.java:125)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at com.google.appengine.tools.development.BackendServersFilter.doFilter(BackendServersFilter.java:97)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:388)
at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:765)
at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:418)
at com.google.appengine.tools.development.DevAppEngineWebAppContext.handle(DevAppEngineWebAppContext.java:94)
at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
at com.google.appengine.tools.development.JettyContainerService$ApiProxyHandler.handle(JettyContainerService.java:383)
at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
at org.mortbay.jetty.Server.handle(Server.java:326)
at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)
at org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:923)
at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:547)
at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:212)
at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)
at org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:409)
at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:582) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T09:30:57.827

你有没有尝试过

*   停止你的开发应用服务器
*   删除“datastore-indexes-auto.xml”文件
*   重新启动您的开发应用服务器
*   使用本地数据存储查看器？

# xcode - 在 Jenkins 中运行 XCodeBuild 的代码签名错误

> ID：13614657
> 
> 赞同：5
> 
> 时间：2012-11-28T21:21:12.540
> 
> 标签：xcode, jenkins, xcodebuild

[不是下面解释的类似问题的重复]

从 Jenkins 中运行 XCodeBuild 时出现代码签名错误，但它可以从命令行或 Xcode 中构建。

过去有几个人遇到过这个问题，他们的共同主题是 Jenkins 在启动时作为守护程序用户运行，因此尝试访问系统钥匙串。人们应用的解决方案是将凭据复制到系统钥匙串或运行命令来设置要使用的钥匙串。

但是在我的情况下，如果我在活动管理器中查看launchd，则用户显示为我登录到机器的用户，因此Jenkins应该以该用户而不是守护程序用户身份运行。

我尝试通过在运行 XCodeBuild 之前将此命令添加到 Jenkins 脚本来设置要使用的钥匙串

```
security list-keychains -s /Users/[user]/Library/Keychains/login.keychain 
```

但这并没有解决问题。

我得到的错误是：

```
Code Sign error: The identity 'iPhone Developer: NNNNN (9TYX5WAM63)' doesn't match any valid, non-expired certificate/private key pair in your keychains" 
```

因此，我尝试将凭据移至系统钥匙串，但现在在 Jenkins 中出现此错误，但从命令行仍然可以：

```
Code Sign error: Provisioning profile 'F152C66E-B99A-47F6-B262-376CE4403D71' can't be found 
```

此外，当我将凭据移动到系统钥匙串时，我不再能够从 XCOde 中构建 - 我收到与上面最上面的错误消息相同的错误。

我还尝试编辑 org.jenkins-ci.plist 文件以将用户设置为我登录到机器的用户，按照这个，但这也没有效果。

[使用 Jenkins/Hudson 作为 iOS 和 Mac 开发的持续集成时，钥匙串中缺少证书和密钥](https://stackoverflow.com/questions/6827874/missing-certificates-and-keys-in-the-keychain-while-using-jenkins-hudson-as-cont/9482707#9482707)

有什么想法我可以尝试下一步吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-28T21:54:57.033

我觉得你上次我们搞砸了这件事，这是一个很大的挑战。我们在为项目设置 CI 服务器时这样做了。如果我没记错的话（大致），我们遵循了以下步骤：

1) 将 Jenkins 设置为 Apple Dev 帐户的开发人员

2) 专门为 Jenkins 创建了一个证书和开发配置文件

3) 在 CI 服务器上设置一个 Jenkins 用户，并从该用户的 xcode 中删除任何以前的 certs/prov 配置文件

4) 将 Jenkins 证书添加到 AD-Hoc Dist 配置文件（如果您尝试将 .ipa 分发到 HockeyApp，则需要将其用于存档构建。）

5) 进入 xcode 项目文件并删除对 Provisioning Profiles 的任何现有引用

6) 下载并安装此用户的证书和相应的 Prov 配置文件。

7) 在构建之前解锁 Jenkins 用户钥匙串。仅当 Jenkins 用户不是运行 xcode 构建的用户时才执行此操作。

以 Jenkins 用户身份登录时，验证 Xcode 在管理器中显示 Prov Profile 是否有效。

我知道我的回答有些含糊，我的意图是提供帮助。这种类型的错误通常是由三件事之一引起的。Xcode 找不到配置文件，Xcode 找不到证书或 Xcode 找到多个配置文件（应该会产生不同的错误，但并非总是如此）并且存在某种不匹配。通常重做 Prov Profiles 是最不痛苦的解决方案。

祝你好运。你会解决它只是一个巨大的头痛！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T15:50:08.123

可能不是您正在寻找的答案，但由于多种原因我放弃了 XCodeBuild 插件，并通过“执行 Shell”步骤运行我的构建。

您说您的命令行构建有效，因此您已经知道所需的命令。只需将其放入外壳中即可。

```
xcodebuild -verbose -alltargets -configuration Debug clean build CODE_SIGN_IDENTITY="${CODE_SIGN_IDENTITY}" PROVISIONING_PROFILE=${PROVISIONING_PROFILE}
&&
/usr/bin/xcrun -sdk iphoneos PackageApplication -v "${WORKSPACE}/client_trunk/build/Debug-iphoneos/${Application}.app" -o "${WORKSPACE}/client_trunk/build/Debug-iphoneos/${Application}-Debug-${shortVer}.${revVer}.ipa" --sign "${CODE_SIGN_IDENTITY}" --embed "/Users/[youruser]/Library/MobileDevice/Provisioning Profiles/${PROVISIONING_PROFILE}.mobileprovision" 
```

上面，`${CODE_SIGN_IDENTITY}`是一个看起来像`iPhone Developer: blah`
并且`${PROVISIONING_PROFILE}`是配置文件的十六进制数，如`F152C66E-B99A-47F6-B262-376CE4403D71`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-07-21T11:20:42.877

按照[Xcode 插件主页](https://wiki.jenkins-ci.org/display/JENKINS/Xcode+Plugin#XcodePlugin-Userinteractionisnotallowed)上的说明进行操作：

> 如果构建机器上没有显示此提示，您可以通过从构建机器上的终端运行失败的 codesign 命令来强制它出现：/usr/bin/codesign --force --sign "iPhone Distribution: .. ...

以 Jenkins 用户身份从终端执行失败的签名命令并选择“始终允许”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-18T20:19:08.237

使用 Jenkins 我得到了这个错误：

```
/Users/Shared/Jenkins/Home/jobs/ExampleTabbed-Integration/workspace/build/Debug-iphoneos/ExamplesTabbed.app: User interaction is not allowed. 
```

命令 /usr/bin/codedesign 失败，退出代码为 1

我通过执行以下操作来修复它：

*   在 XCode（jenkins 插件）步骤之前添加 Build Step
*   添加以下内容作为执行命令：

    security unlock-keychain -p "passwordhere" ${HOME}/Library/Keychains/login.keychain

*   在 XCode（通过插件）配置中，我使用以下内容：

    *   解锁钥匙串？（未选中）
    *   钥匙串路径：${HOME}/Library/Keychains/login.keychain
    *   钥匙串密码：（空）

可能可以删除前置步骤并使用实际的 xcode 配置来执行此操作，但它的工作方式与描述的一样，没有问题。

请注意，这还没有考虑使用更安全的解决方案，但这是我对 xcode 签名问题的解决方案。我正在使用 Jenkins 安装程序在 OSX 上运行，并作为默认 Jenkins 安装程序应用程序使用的 launchctl 命令运行。如果这有帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-07-10T02:32:34.697

# Java/Jenkins 的子进程需要解锁对钥匙串的访问权限。

假设您的构建/代码签名/发布过程运行良好。唯一的阻碍是当您尝试在 Jenkins 中运行完全相同的进程时。

很可能钥匙串被锁定，不是为了用户，而是为了 Jenkins 子进程。

解锁钥匙串的安全命令需要作为 Jenkins 作业运行一次。即使同一个登录用户已经解锁了终端中的钥匙串。

因此，在 Jenkins 中设置一个简单的自由式作业，并添加以下 shell 命令作为构建阶段。

```
security unlock-keychain -p $PASSWORD /Users/$MACOS_USER/Library/Keychains/login.keychain-db 
```

`$PASSWORD`作为 Jenkins 作业的输入参数提供。

`$MACOS_USER`Mac 钥匙串所有者的 macos 用户名。

运行此作业后，从钥匙串提示中选择“始终允许”。现在，尝试您的常规构建/发布工作，它应该可以工作。假设您在登录钥匙串中拥有所有必需的证书。

## 永远不要将密码硬编码到配置/作业/代码等中。

# automation - AutoHotKey：如何在我的代码中发送 CTRL B 以及括号中的其他文本

> ID：13614661
> 
> 赞同：0
> 
> 时间：2012-11-28T21:21:28.740
> 
> 标签：automation, autohotkey

这是我的自动热键代码：

```
::\update client::
(
Hi team,

We are emailing to advise you an update on following job:
#CTRL-B Here
Here
•   Our Reference:
Your Reference:
#CTRL-B Here
) 
```

我正在尝试用一段文本替换单词更新客户端。我想在要点之前和要点之后发送`Ctrl`+键。`B`我该怎么做？有人可以帮我语法吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:59:16.060

您需要划分文本。

```
::\update client::
SendInput
(
Hi team,

We are emailing to advise you an update on following job:
)
SendInput, ^b
SendInput
(
Here
•   Our Reference:
Your Reference:
)
SendInput, ^b
Return 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T22:07:54.180

这是我使用换行符的解决方案。

```
::test::
    SendInput Hi team,`n`nWe are emailing to advise you an update on following job:
    SendInput ^b
    SendInput Here`n•   Our Reference:`nYour Reference:
    SendInput ^b
    return 
```

# windows - 在 Windows 中将大量数据从一个程序发送到另一个程序的最快方法是什么？

> ID：13614662
> 
> 赞同：0
> 
> 时间：2012-11-28T21:21:29.433
> 
> 标签：windows, ipc, pipe, shared-memory, memory-mapped-files

我需要在 Windows 7 中将大量数据（~10MB）从一个程序发送到另一个程序。我想要一种方法，该方法允许至少每秒 1 GB 的总吞吐量，并且系统负载非常低。为了简化这一点，所有 blob 的大小可能相同，并且一个程序可能是另一个程序的子进程。

方法1：[在两个程序中内存映射同一个文件](http://msdn.microsoft.com/en-us/library/aa366551%28VS.85%29.aspx)：CreateFileMapping() / MapViewOfFile()

在这种情况下，内存映射文件可能包含用于环形缓冲区中的几个 blob 的空间。需要一些外部机制来同步对环形缓冲区的访问。

方法 2：[创建命名数据段](http://msdn.microsoft.com/en-us/library/h90dkhs0%28VS.80%29.aspx)

方法 3：[WriteProcessMemory](http://msdn.microsoft.com/en-us/library/windows/desktop/ms681674%28v=vs.85%29.aspx)（下面由 Hristo Iliev 建议，谢谢！）

方法 4：读/写 RAM 盘上的文件。

方法 5：读/写匿名管道。

方法？：还有别的吗？也许通过 TCP 编写，使用 MPI，...

我知道内存映射文件（方法1）被认为是这个问题的标准解决方案:)

*   内存映射文件有多快？（大致数量级）

*   有没有更快的方法？

*   其他方法的性能差多少？其中哪些可以达到 GB/秒的吞吐量？

*   如果使用内存映射文件，程序同步访问正在传递的数据的最佳方式是什么？（即：生产者如何向消费者指示新的 blob 可用，以及消费者如何指示它已使用特定的 blob 完成？）

*   如果使用内存映射文件，最好将所有 blob 放在一个文件中（文件中的环形缓冲区），还是每个 blob 一个文件（文件的环形缓冲区）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T15:04:01.093

您还可以使用[WriteProcessMemory](http://msdn.microsoft.com/en-us/library/windows/desktop/ms681674%28v=vs.85%29.aspx)并让第一个进程直接将数据发布到第二个进程的地址空间中。您需要开发某种协议。例如，第二个进程可以通过命名管道或共享内存块将其接收缓冲区的虚拟地址发送给第一个进程，然后第一个进程使用复制数据`WriteProcessMemory`，完成后通过信号量向第二个进程发送信号或者其他的东西。这应该是在两个进程之间发送数据的最快方式，因为它涉及单个复制操作。第一个进程需要获得第二个进程的适当权限，只要两个进程属于同一个用户，这应该不是问题。

# javascript - Javascript - 对于每个名称集 ID 等于 Name[i] 并验证

> ID：13614666
> 
> 赞同：0
> 
> 时间：2012-11-28T21:21:49.263
> 
> 标签：javascript, validation

好的，我已经创建了一张发票，根据发票项目的数量，它将在每个项目旁边生成一个复选框以供批准。每个复选框都有名称`invoiceApproval`。

到目前为止，我的脚本将计数以查看有多少输入具有名称`invoiceApproval`，然后为每个具有 ID = 的输入分配一个 ID`invoiceApproval[i]`

这是完美的工作，但现在当我使用[JavaScript 表单验证时：快速简单！在 HTML 表单](http://www.javascript-coder.com/html-form/javascript-form-validation.phtml)中为每个 ID 分配一个`frmvalidator.addValidation`（每个 ID 的数量等于具有该名称的复选框的数量`invoiceApproval`）它仅验证具有 ID 的第一个框`invoiceApproval0`。

为什么我的“for each”只适用于第一个实例？？？我在这里做错了什么：

```
<script type="text/javascript"> 
    var frmvalidator  = new Validator("forminvoice"); 

    var inva = document.getElementsByName("invoiceApproval");
    for (var i = 0; i < inva.length;i++) {
        var inc = "invoiceApproval"+[i];
        inva[i].setAttribute("id",inc); 
    }

    var inva = document.getElementsByName("invoiceApproval");
    for (var i = 0; i < inva.length;i++) {
        var inc = "invoiceApproval"+[i];
        frmvalidator.addValidation(inc,"shouldselchk=x","You must check off each item on the right hand side of the invoice before you can submit approval.");
    }
</script> 
```

生成复选框的 PHP 循环是：

```
while($row = mysql_fetch_array($result))
{
    echo "<input type='checkbox'  value='x' name ='invoiceApproval' > Approve";  
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T22:16:47.727

图书馆的代码正在使用

```
var itemobj = this.formobj[itemname]; 
```

检索表单项。后来确实

```
if (itemobj.length && isNaN(itemobj.selectedIndex))
{
    itemobj = itemobj[0];
} 
```

这意味着如果有多个具有相同名称的项目，它将始终选择第一个。取名字来引用你的表单域是很糟糕的做法

唯一的解决方案（如果你想使用这个库，但我会远离它，它真的写得很糟糕）是让你的名字不一样。

**边注**

线

```
var inc = "invoiceApproval"+[i]; 
```

正在创建一个包含单个值的数组，然后在其上调用 toString，并且`toString`（幸运的是）返回单个值数组作为值本身。摆脱那些括号，它应该是

```
var inc = "invoiceApproval"+i; 
```

# ruby-on-rails - Rails - 将路由匹配到命名空间控制器

> ID：13614671
> 
> 赞同：12
> 
> 时间：2012-11-28T21:22:23.697
> 
> 标签：ruby-on-rails

```
match '/submit_expense/:id' => 'expenses#submit_expense', :as => 'submit_expense' 
```

我如何将它定向到我的 :admin 命名空间？我必须在命名空间声明中定义匹配吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-01-15T01:12:30.057

您可以在使用控制器生成器时使用 / like：

```
match '/submit_expense/:id' => 'admin/expenses#submit_expense', :as => 'submit_expense' 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-11-28T21:34:10.163

在`routes.rb`这可能工作......

```
namespace :admin do
  match '/submit_expense/:id' => 'expenses#submit_expense', :as => 'submit_expense'
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-03-30T15:57:01.023

你也可以`to:`像这样使用指令：

```
 get '/submit_expense/:id', to: 'admin/expenses#submit_expense' 
```

# android - Android 中对 HTTP POST 请求的意外响应

> ID：13614673
> 
> 赞同：1
> 
> 时间：2012-11-28T21:22:43.493
> 
> 标签：android, http-post, http-response-codes, post-parameter

我最近在通过 Android 上的 http POST 请求发送/接收数据时遇到了奇怪的问题。

我在设置[Fiddler](http://fiddler2.com/fiddler2/)来监控我的 Android 应用程序和服务器之间的流量时遇到了困难，因此我创建了简单的 Web 表单来模拟 POST 请求。

```
<form action="http://www.my.server.org/my_script.php" method="POST">
  <input name="deviceID" type="text" width=30> Device ID <br>
  <input name="lang" type="text" width=30> Language (en / cs) <br>
  <input name="lastUpdated" type="text" width=30> Last Updated (yyyy-MM-dd hh:mm) <br>
  <button type="submit">Send</button>
</form> 
```

当我使用此表单发送请求时，会返回带有 200 OK 状态代码和所需 XML 文件的响应。

我认为它相当于我的 Android 应用程序中的 Java 代码。

```
private static final String POST_PARAM_LAST_UPDATED = "lastUpdated";
private static final String POST_PARAM_DEVICE_ID = "deviceId";
private static final String POST_PARAM_LANG = "lang";

...

// Create a POST Header and add POST Parameters
HttpPost httpPost = new HttpPost(URL_ARTICLES);
List<NameValuePair> postParameters = new ArrayList<NameValuePair>(3);
postParameters.add(new BasicNameValuePair(POST_PARAM_DEVICE_ID, deviceId));
postParameters.add(new BasicNameValuePair(POST_PARAM_LANG, lang));
postParameters.add(new BasicNameValuePair(POST_PARAM_LAST_UPDATED, lastUpdated));
httpPost.setEntity(new UrlEncodedFormEntity(postParameters));

// Create new HttpClient and execute HTTP Post Request
HttpClient httpClient = new DefaultHttpClient();
HttpResponse response = httpClient.execute(httpPost);

// Get and parse the response
List<Article> parsedArticles = new ArrayList<Article>();
HttpEntity entity = response.getEntity();
if (entity != null) {
  parsedArticles = Parser.parseArticles(entity.getContent());
} 
```

但是，即使我输入了相同的参数值（与我在 Web 表单中输入的参数值相同），这种情况下的响应也是 204 NO CONTENT 并且显然没有 XML 文件。

有人可以告诉我这两种方法为什么不等效并且响应不同吗？是编码还是我错过了什么？

不幸的是，我无法访问服务器，也无法调试 Android 传出和传入数据，因为 Fiddler 和我的模拟器/连接到 PC 的设备拒绝合作。

而且我还想知道是否应该使用`AndroidHttpClient`代替，`DefaultHttpClient`但我认为在这种情况下它不会改变任何东西。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T09:54:52.050

由于 Maxims 的评论，我发现了问题所在。

这是 POST_PARAM_DEVICE_ID 常量中的一个愚蠢的小写字母。它的值是“deviceId”（应该是 web 表单中的“deviceID”）。

好吧，我的开发人员伙伴们，在定义字符串键时要注意 - 它区分大小写！

# iphone - 如何创建具有多个选项的 UIAlertView？

> ID：13614675
> 
> 赞同：0
> 
> 时间：2012-11-28T21:22:44.523
> 
> 标签：iphone, objective-c, xcode, ios5

我正在尝试弄清楚如何使用 UIAlertView 来执行多个命令。

基本上，在我的 ViewController 中，已经有一个 alertView，但是我现在添加了一些 storekit 文件，这些文件需要有自己的 alertView（告诉它是购买应用内还是取消等）

这是原始的 alertView 代码；

```
- (void) alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex
{
    [alertView dismissWithClickedButtonIndex:0 animated:NO];
    if (buttonIndex == 1) {
        [g_GameUtils removeAlbumFolder:deleteIndex];
        [g_GameUtils readAllData];
        [g_GameUtils getAlbumFolderList];
        [m_pTable reloadData];
    }
} 
```

这也是我需要的 - 它们都被称为 alertView 所以我不能像这样使用两者，有没有办法将它们结合起来？还是称其中之一为 alertView2 更好？如果是这样，它如何知道要调用哪一个来发出特定警报？

提前致谢！

克里斯

```
- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex
{
    if (buttonIndex == 0){
        //cancel button clicked. Do something here or nothing here
    }
    else{
        //other button indexes clicked
        [[MKStoreManager sharedManager] buyFeature:@"com.davis.apptoken.buy"];
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:46:57.647

您也可以使用 alertView.tag = 1; 和 alertView2.tag = 2; 并添加适当的条件来委托：

```
if (alertView.tag == 1) 
{
    // First alert 
} 
```

# javascript - 正确循环 .each(function) 并将数字字符串格式化为电话号码

> ID：13614679
> 
> 赞同：2
> 
> 时间：2012-11-28T21:23:00.263
> 
> 标签：javascript, jquery

如何遍历我的结果并格式化每个数字字符串。第一个结果的格式正确，但不是第二个结果或第一个结果之后的任何结果。

```
 $('#phoneResults').each(function(){              
     //Only the first result is being altered! Ugh.
     var string = $(this).html();
     $(this).html(string.substring(0,3) + '.' + string.substring(3,6) + '.' + string.substring(6,10))     
 }); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-28T21:25:50.640

可能是因为`#`引用了一个元素 ID，按照惯例，它是唯一的。jQuery 会将其视为单个项目，因此迭代只会产生单个结果。

也许尝试类似：

```
$('.phoneResults').each(function() { 
    // your code here 
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T21:26:42.150

问题是您使用的是重复的 id `#phoneresults`。ID 必须是唯一的。当您的选择器运行时，它会查找具有 ID 的第一个元素，然后停止，因为不应有任何其他具有该 ID 的元素。所以你的`each()`函数没有在多个元素上运行。

将此作为一个类并将您的选择器更改为`.phoneresults`，您应该一切顺利。

# c++ - 我可以读取向量的数字位置吗 ::迭代器？

> ID：13614683
> 
> 赞同：2
> 
> 时间：2012-11-28T21:23:21.653
> 
> 标签：c++, iterator

我有一个字符串向量。我希望能够在该向量中搜索字符串，如果我在向量中找到匹配项，我希望能够返回位置，例如向量中项目的向量索引。

这是我试图解决问题的代码：

```
enum ActorType  { at_none, at_plane, at_sphere, at_cylinder, at_cube, at_skybox, at_obj, at_numtypes };

class ActorTypes
{
private:
    std::vector<std::string>  _sActorTypes;

public:
    ActorTypes()
    {
        // initializer lists don't work in vs2012 :/
        using std::string;
        _sActorTypes.push_back( string("plane") );
        _sActorTypes.push_back( string("sphere") );
        _sActorTypes.push_back( string("cylinder") );
        _sActorTypes.push_back( string("cube") );
        _sActorTypes.push_back( string("skybox") );
        _sActorTypes.push_back( string("obj") );
    }

    const ActorType FindType( const std::string & s )
    {
        auto itr = std::find( _sActorTypes.cbegin(), _sActorTypes.cend(), s );

        uint32_t nIndex = ???;

        // I want to be able to do the following
        return (ActorType) nIndex;
    }       
}; 
```

我知道我可以只编写一个 for 循环并返回我找到匹配项的 for 循环索引，但我想知道更一般的情况 - 我可以获得 vector::iterator 的索引值吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-28T21:26:23.187

使用`std::distance`：

```
uint32_t index = std::distance(std::begin(_sActorTypes), itr); 
```

`find`不过，您应该首先检查to的返回值`end()`，以确保它确实被找到。您也可以使用减法，因为`std::vector`使用随机访问迭代器，但减法不适用于所有容器，例如`std::list`使用双向迭代器的容器。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-28T21:26:34.707

您可以使用[std::distance](http://en.cppreference.com/w/cpp/iterator/distance)：

```
auto itr = std::find( _sActorTypes.cbegin(), _sActorTypes.cend(), s );
uint32_t nIndex = std::distance(_sActorTypes.cbegin(), itr); 
```

# jquery - 如何获取没有子元素文本的文本

> ID：13614684
> 
> 赞同：-1
> 
> 时间：2012-11-28T21:23:30.280
> 
> 标签：jquery

我想获取我的 div 中的文本，而不是子 div 中的文本。

我有

html

```
 <div id='textDiv'>
       texts I want to get
          <span id='textChildDiv'>
             texts I don't want
          </span>
    </div> 
```

jQuery

```
 $('#textDiv').click(function(){
       alert($(this).text())  //will get 'texts I want to gettexts I don't want'
       //I only want 'texts I want to get' to be returned.
    }) 
```

我发现

[http://viralpatel.net/blogs/jquery-get-text-element-without-child-element/](http://viralpatel.net/blogs/jquery-get-text-element-without-child-element/)

对于我的解决方案，但似乎有比他的方式更好的方法。

有任何想法吗？非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T21:27:30.377

```
var text = $("#textDiv").contents().filter(function() {
    return this.nodeType === 3;
}).text(); 
```

**演示：http:** [//jsfiddle.net/VcghZ/](http://jsfiddle.net/VcghZ/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T21:28:28.270

尝试`.contents`单独使用和获取文本节点。见下文，

**演示：http:** [//jsfiddle.net/pyaAN/](http://jsfiddle.net/pyaAN/)

```
 var result = '';
    $('#textDiv').contents().each(function () {
        if (this.nodeType == 3 && $.trim($(this).text()).length > 0) {
            result += this.nodeValue;
        }
    }); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-28T21:29:27.210

尝试使用

```
$('#textDiv').click(function(){

    alert($(this).contents().filter(function() {
        return this.nodeType === 3;
      }).text())
});​ 
```

正如这个小提琴：http: [//jsfiddle.net/jQf6d/](http://jsfiddle.net/jQf6d/)

# php - 从 Linux 服务器发送 iMessage？

> ID：13614685
> 
> 赞同：11
> 
> 时间：2012-11-28T21:23:37.610
> 
> 标签：php, iphone, linux, sms, imessage

有没有办法将 iMessage 从 Linux 服务器发送到 iPhone？

显然......对于大多数传统的 SMS 计划，您始终可以向 2125551212@txt.att.net 之类的方式发送消息，然后在手机上接收。

iMessage 是否存在等价物？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-28T21:31:34.463

不，iMessage 不像传统的 SMS 那样工作。

该协议也没有可用的公共 API。

# objective-c - 为什么将 nil 分配给单例的静态变量

> ID：13614692
> 
> 赞同：5
> 
> 时间：2012-11-28T21:24:08.627
> 
> 标签：objective-c, static, singleton, null

使用这个有什么好处：

```
+ (CardPainter*) sharedPainter {
    static CardPainter* sp = nil;

    if (nil == sp) {
        sp = [[CardPainter alloc] init];
    }

    return sp;
} 
```

而不是这个：

```
+ (CardPainter*) sharedPainter {
    static CardPainter* sp = [[CardPainter alloc] init];

    return sp;
} 
```

静态变量初始化只执行一次，所以我看不到前者的优势。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T06:04:00.417

好吧，在编译器级别有几个重叠的原因……最简单的考虑是静态变量存储在已编译应用程序的专用数据部分中，它只是按原样映射到内存中。所以编译器必须在编译时准确地知道那是什么。根据定义和实践，任何 Objective-C 方法调用的结果在编译时都是不可预测的——你永远不知道在运行时不会发生“有趣”的事情来改变该方法调用的行为，所以你不会确定将返回什么。

由于各种原因，这与例如 C++ 有点不同（一个关键是 C++ 有构造函数，而 Objective-C 没有）。但即使在 C++ 中，由于以下几个原因，它仍然不受欢迎：

1.  构造函数的顺序是不可预测的，但是构造函数相互依赖是很容易和常见的，这意味着您的程序在运行时可能具有未定义的行为（包括数据损坏或崩溃）。
2.  许多重要对象的初始化可能会很昂贵。在启动时一起完成这一切可能是有效的，但它会使您的应用程序启动缓慢，这要糟糕得多。

后一点同样适用于 Objective-C。您可以避免在发布时做的越多，而是按时按需做，用户体验通常就越好。

[请注意，“无静态对象实例”规则有一个值得注意的例外，那就是 @"foo" 形式的字符串。这些实际上在您的应用程序的数据部分中编码为真实实例（一个特殊的 NSString 子类），它们只是在启动时被映射并按原样神奇地工作。但这是经过精心设计的，编译器和运行时在这方面紧密耦合，以确保一切顺利。它不会也不能普遍适用。]

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-11-28T21:34:11.117

因为如果你不问，你会在任何时候调用“sharedPainter”时启动“*sp”，丢失任何数据。

所以，如果你问 sp 是否为 nil 并且答案是 FALSE 意味着“sp”已经初始化并且它返回实例。如果答案是真的，那意味着 sp 没有被初始化，只是在这种情况下你调用了 init 函数。

# knockout.js - 淘汰赛选择名单

> ID：13614701
> 
> 赞同：0
> 
> 时间：2012-11-28T21:24:44.320
> 
> 标签：knockout.js

我可以根据[http://learn.knockoutjs.com/#/?tutorial=collections](http://learn.knockoutjs.com/#/?tutorial=collections)的指导填充我的选择列表框。然而，我面临两个问题。

*   所选索引偏移 1

我在这里放了一个小提琴：http: [//jsfiddle.net/poundingCode/a9MGk/](http://jsfiddle.net/poundingCode/a9MGk/)并将调用中的数据添加到我的服务器。

我发现最令人费解的是 BDay 和 BYear 控件实际上是相同的。与底层模型唯一不同的是 BYear 是一个可为空的数据类型，但我传入的值不是空的。

与往常一样，我们将不胜感激任何指导。

代码：`var Namespace = {};

```
 // View model declaration
    Namespace.initMemberVM = function (model) {
        console.log('initViewCalled');
        var memberViewModel = {
            Id: ko.observable(model.Id),
            BDay: ko.observable(model.Days[model.BDay]),
            BMonth: ko.observable(model.Months[model.BMonth]),
            BYear: ko.observable(model.Years[model.BYear]),
            Company: ko.observable(model.Company),
            FName: ko.observable(model.FName),
            LName: ko.observable(model.LName),
            Interests: ko.observable(model.Interests),
            Married: ko.observable(model.Married),
            MName: ko.observable(model.MName),
            Name: ko.observable(model.Name),
            SalutationId: ko.observable(model.SalutationId),
            Salutation: ko.observable(model.Salutations[model.SalutationId]),
            Months: ko.observableArray(model.Months),
            Days: ko.observableArray(model.Days),
            Years: ko.observableArray(model.Years),
            Salutations: ko.observableArray(model.Salutations)
        };
        return memberViewModel;
    }; 
```

1992"},{"Id":"1993"}],"Associations":"","BDay":2,"BMonth":2,"BYear":1983, "SalutationId":1, "FName": “James”，“MName”：“R”，“LName”：“Fleming”，“I​​nterests”：“我想知道的是为什么年份选择下拉菜单不显示值 1983？以及为什么所选索引关闭 1？SalutationId = 1 但显示的值为 SalutationId #2..."}; 1992"},{"Id":"1993"}],"Associations":"","BDay":2,"BMonth":2,"BYear":1983, "SalutationId":1, "FName": “James”，“MName”：“R”，“LName”：“Fleming”，“I​​nterests”：“我想知道的是为什么年份选择下拉菜单不显示值 1983？以及为什么所选索引关闭 1？SalutationId = 1 但显示的值为 SalutationId #2..."}; 想知道为什么年份选择下拉菜单不显示值 1983？以及为什么所选索引关闭 1？SalutationId = 1 但显示的值为 SalutationId #2..."}; 想知道为什么年份选择下拉菜单不显示值 1983？以及为什么所选索引关闭 1？SalutationId = 1 但显示的值为 SalutationId #2..."};

```
 $(document).ready(function () {
          var viewModel = Namespace.initMemberVM(data);
        ko.applyBindings(viewModel);
    });` 
```

HTML

```
<article>
    <h2>Summary</h2>
    <label data-bind="text: FName"></label>
    <table>
        <tbody>
        <tr><td>User Id</td><td colspan="4"><label data-bind="text: Name"></label></td></tr>
        <tr>
        <td>Salutation</td><td><select data-bind="options: Salutations, value: Salutation, optionsText: 'Name', optionsCaption: 'Select'"></select></td>
        </tr>
        <tr>
        <td></td><td>First</td><td>Middle</td><td>Last</td>
        </tr>
        <tr>
            <td>Name</td><td><input type="text" data-bind="value: FName"></td><td><input type="text"  data-bind="value: MName"></td><td><input type="text"  data-bind="value: LName"></td>
        </tr>
        <tr><td></td><td colspan="2">Month &nbsp;&nbsp; Day &nbsp;&nbsp; Year</td></tr>
            <tr><td>DOB</td><td colspan="2">
                                <select name="BMonth" data-bind="options: Months, value: BMonth, optionsText: 'Name', optionsCaption: 'Select'"></select>/
                                <select name="BDay"     data-bind="options: Days, value: BDay, optionsText: 'Id',  optionsCaption: 'Select' "></select>
                                <select name="BYear" data-bind="options: Years, value: BYear, optionsText: 'Id', optionsCaption: 'Select'"></select>
                            </td><td> <label><input type="checkbox" data-bind="checked: Married">Married</label></td></tr>
        <tr><td><label>Interests</label></td><td colspan="3"><textarea data-bind="value: Interests" rows="10" cols="40"></textarea></td></tr>
    </tbody> 
```

```
</article> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T21:51:28.057

我明白了 - 请参阅前面提到的小提琴以获得答案。我需要做的是让值按预期显示的两件事。我陷入困境的时间比我愿意承认的要长，但我希望吸取的教训可以帮助其他人。

我必须发送 Id 而不是对象

```
 BDay: ko.observable(model.BDay),
            BMonth: ko.observable(model.BMonth),
            BYear: ko.observable(model.BYear), 
```

对比

BDay: ko.observable(model.Days[model.BDay]), BMonth: ko.observable(model.Months[model.BMonth]), BYear: ko.observable(model.Years[model.BYear]), 公司: ko.observable(model.Company),

我还需要通过添加 optionsValue: 'Id' 来更新选择的 HTML。

希望这可以帮助

# windows - Windows XP x86 检查构建？

> ID：13614709
> 
> 赞同：6
> 
> 时间：2012-11-28T21:25:45.690
> 
> 标签：windows, checked

似乎不可能找到 Windows XP Professional x86 检查构建的图像。但我仍然需要支持该软件并为该系统做我的工作。:(

是的，我知道我只能在免费版本上安装经过检查的内核，但我仍然想要一个经过检查的系统，而不是两者的混合。

解决方案，有人吗？

更新：从问题本身来看，我并不清楚我正在寻找的是安装映像本身（ISO 映像），因此我可以安装操作系统的完整检查版本。不是服务包。不是 x64 图像。

更新 2：为什么调用 MS 无济于事：请参阅“由于 Java 相关的结算导致产品不可用”之后的[http://msdn.microsoft.com/en-us/subscriptions/ff723773.aspx 。](http://msdn.microsoft.com/en-us/subscriptions/ff723773.aspx)

更新3：见[http://social.msdn.microsoft.com/Forums/en/wdk/thread/5fa40892-8207-425a-8866-0fcaebb0c343——](http://social.msdn.microsoft.com/Forums/en/wdk/thread/5fa40892-8207-425a-8866-0fcaebb0c343)有人建议“检查过的XP的唯一安装盘是发行版，即没有服务包。MSDN 和 Technet 发行版将磁盘作为其中之一。这里有人有这些磁盘吗？似乎我们的遗失在了时间的流沙中。

更新 4：将其缩小到名为“Windows® XP Professional Checked/Debug Build (English)”的 MSDN CD，光盘 1013，卷标 X08-48914，日期为 2001 年 10 月。有人有那个吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-02T23:36:18.037

我敢打赌，如果您支持您的软件在 Windows Server 2003 中运行，那么即使 Microsoft 的调试符号不同，您的软件也将在 Windows XP 中运行。您可以安装经过检查的 Windows Server 2003 RTM 版本，添加桌面体验的可选组件，它将与带有 SP1 的 Windows XP 大致相同，并增加了一些安全性。已检查的构建服务包可用于 Windows Server 2003。因此，您可以估计 Windows XP 的每个服务包版本，Windows XP RTM 除外。

检查版本仅提供英文版本。您可以安装 MUI 包，但结果与实际的俄语版本的 Windows 不同。您必须在客户使用的实际 Windows 版本中再次测试您的软件，并且该版本不会是经过检查的版本。

这些文件可从 MSDN 下载：

```
en_windows_server_2003_enterprise_chk.iso
en_windows_server_2003_enterprise_x64_chk.iso 
```

（第一段被编辑提到 Windows Server 2003 RTM 下载也是经过检查的版本。否则下载当然没有用。）

# c# - 如果 StreamWriter 变量在 if 语句中初始化并作为参数传递给 Console.SetOut()，它会不会太快被 GC 处理？

> ID：13614711
> 
> 赞同：1
> 
> 时间：2012-11-28T21:25:51.027
> 
> 标签：c#, .net, console, streamwriter

我试图决定这个 StreamWriter 变量是否应该在 if 语句中声明为字段、本地或本地。我担心的是，在我将它传递给 Console.SetOut() 并继续执行 if 语句之后，将不再有对该对象的引用，并且它会被垃圾收集。

我是否过度考虑了这一点，或者假设 Console 类将在我的应用程序的整个执行过程中引用它是否安全？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-28T21:30:20.973

> 在我将它传递给 Console.SetOut() 并继续执行 if 语句之后，将不再有对该对象的引用

这个假设是不正确的：将有一个对对象的引用，即`Console`. 所以，不用担心你的流编写器会被 GC 处理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T21:28:17.530

GC~~计数~~将跟踪引用，即使它们已经在应用程序中传递。如果您无法再访问它们，GC 应该只收集对象。

具体来说，保留对传递给它`Console.SetOut`的内部引用。`TextWriter`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-28T21:29:59.740

是的，你想多了...... GC 永远不会收集你可能使用的任何东西。算了吧……你（应该）有更重要的事情要担心……

我建议您遵循的有关 GC 的唯一规则是，如果一个类实现 IDisposable，您必须调用 .Dispose() 或将其包装在“使用”中。就这样。

# php - 如何使用 jpgraph 在 x 轴上创建具有随机时间的图形

> ID：13614719
> 
> 赞同：1
> 
> 时间：2012-11-28T21:26:20.987
> 
> 标签：php, graph, charts, jpgraph

我有数据，其中包括来自各种随机时间的仪表读数。

我想创建一个（线）图来显示仪表读数的变化，但是时间不规律 - 一天可能有 3 个，或者一周没有。

因此，我不确定如何最好地创建一个图表来显示这一点。由于时间的随机性，我不能按原样使用数据 - 如果读数之间是一周，则需要在 x 轴上表示为一周。

如果我给出一个任意的比例（例如每个刻度 1 天），我不确定如何说“在这个刻度上没有数据”来说明哪里有差距。我也不确定我是否可以表示更小的粒度（例如，如果早上有一个，下午有一个，我认为它会出现在同一个地方，每刻度刻度为 1 天）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T09:35:40.567

我也有同样的问题。如果您检查类参考中的 LinePlot，您会看到您可以为 x 轴值设置第二个参数。显然，Y 轴和 X 轴数组必须具有相同数量的元素。我根据手册做了一些示例代码。该代码尚未经过测试，但它应该是这样工作的：

```
function elevation_chart ($ydata, $xdata) {
  require_once('jpgraph/jpgraph.php');
  require_once('jpgraph/jpgraph_line.php');
  $width = 600; $height = 200;
  $graph = new Graph($width,$height);
  $graph->SetScale('intint');
  $graph->title->Set('Elevation profile');
  $graph->xaxis->title->Set('(Distance)');
  $graph->yaxis->title->Set('(Altitude)');
  $lineplot = new LinePlot($ydata, $xdata); //here you have to add $xdata as second argument
  $graph->Add($lineplot);
  $graph->Stroke();
} 
```

# log4net - Log4Net：RollingFile Appender - 附加 .TXT

> ID：13614725
> 
> 赞同：0
> 
> 时间：2012-11-28T21:26:41.793
> 
> 标签：log4net

我有以下工作配置：

```
<appender name="RollingFile" type="log4net.Appender.RollingFileAppender">
  <file value=".\\App_Data\\log.txt" /> 
```

我想让日志文件看起来像这样

```
log.2012-11-28.txt
log.2012-11-29.txt 
```

等等。注意最后的 .txt。

如何更改配置中的**文件值**来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:31:32.020

将此添加到 appender 配置中，请确保您没有添加其他 rollingStyle

```
<rollingStyle value="Date" />
<datePattern value="'log.'yyyy-MM-dd'.txt'" /> 
```

# javascript - 简单的正则表达式来匹配多个带有空格/多个空格或没有空格的单词

> ID：13614727
> 
> 赞同：-1
> 
> 时间：2012-11-28T21:26:49.343
> 
> 标签：javascript, java, regex, string

我正在尝试将所有单词与单个或多个空格匹配。我的表情

(\w+\s*)* 不工作

编辑1：假设我有一个这种形式的句子

```
[[do "hi i am bob"]]
[[do "hi   i am Bob"]]

now I have to replace this with 
cool("hi i am bob") or 
cool("hi    i am Bob") 
```

我不关心用单个替换多个空格。

我可以用一个词来实现这一点

`\[\[do\"(\w+)\"\]\] and replacing regex cool\(\"$1\")`但这看起来不是一个有效的解决方案，并且不匹配多个单词....对于不完整的问题，我深表歉意

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T22:21:18.637

找到这个正则表达式：

```
/\[\[do\s+("[\w\s]+")\s*\]\]/ 
```

并执行以下替换：

```
'cool($1)' 
```

这里唯一要做的特别的事情是使用字符类来发挥我们的优势

```
[\w\s]+ 
```

匹配一个或多个单词或空格字符（az、AZ、0-9、_ 和空格）。那';; 吃掉你内部的东西没问题。

```
'[[do "hi   i am Bob"]]'.replace(/\[\[do\s+("[\w\s]+")\s*\]\]/, 'cool($1)') 
```

吐出来

```
cool("hi   i am Bob") 
```

虽然 - 如果你想添加标点符号（你可能会这样做），你应该这样做：

```
/\[\[do\s+("[^"]+")\s*\]\]/ 
```

它将匹配任何不是双引号的字符，保留您的子字符串。还有更复杂的可以让您处理转义的引号，但我认为这超出了这个问题的范围。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T21:30:49.540

要匹配“所有带有单个或多个空格的单词”，您不能使用`\s*`，因为它甚至会匹配没有空格。

另一方面，看起来您甚至想匹配“hi”，这是一个没有空格的单词。

您可能想要匹配一个或多个以空格分隔的单词。如果是这样，请使用正则表达式模式

```
(\w+(?:$|\s+))+ 
```

或者

```
\w+(\s+\w+)* 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T21:34:10.590

我不确定，但也许这就是你想要得到的：

```
"Hi I am bob".match(/\b\w+\b/g);  // ["Hi", "I", "am", "bob"] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-28T21:34:39.057

您的正则表达式正在做的是：

```
/([a-zA-Z0-9_]{1,}[ \r\v\n\t\f]{0,}){0,}/ 
```

也就是说，找到一个或多个 A 到 Z 的第一个匹配项，包括数字和下划线，然后是零个或多个空格字符，它们是：

*   一个空格字符
*   回车符
*   垂直制表符
*   换行符
*   制表符
*   换页符

然后是零个或多个 A 到 Z 扰乱上下以及数字和下划线。

`\s`匹配的不仅仅是简单的空格，你可以输入一个文字空间，它会起作用。

我相信你想要：

```
/(\w+ +\w+)/g 
```

其中A 到 Z 中的一项或多项的**所有**匹配项以及数字和下划线都会影响大小写，然后是**一个**或多个空格，然后是 A 到 Z 的一个或多个匹配项以及数字和下划线会影响大小写。

这将匹配由空格分隔的所有*单词字符。*

如果您只想查找所有单词字符簇，没有标点符号或空格，那么您可以使用：

```
/(\w+)/g 
```

这将找到组合在一起*的所有单词字符。*

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-28T21:35:00.527

简单的。匹配所有非空白字符组

```
var str = "Hi I   am   Bob";

var matches = str.match(/[^ ]+/g); // => ["Hi", "I", "am", "Bob"] 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-28T21:35:43.943

```
var regex=/\w+\s+/g; 
```

现场演示：http: [//jsfiddle.net/GngWn/](http://jsfiddle.net/GngWn/)

[更新]我只是在回答这个问题，但根据评论，这更有可能是您正在寻找的：

```
var regex=/\b\w+\b/g; 
```

\b 是单词边界。

演示：http: [//jsfiddle.net/GngWn/2/](http://jsfiddle.net/GngWn/2/)

[Update2] 您的编辑使它成为一个完全不同的问题：

```
string.replace(/\[\[do "([\s\S]+)"\]\]/,'cool("$1")'); 
```

演示：http: [//jsfiddle.net/GngWn/3/](http://jsfiddle.net/GngWn/3/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-28T21:37:52.763

使用正则表达式模式`\w+(\s+\w+)*`如下：

```
m = s.match(/\w+(\s+\w+)*/g); 
```

# asp.net-mvc-3 - 是否有一种通用方法可以将新对象的值分配给同一类的原始对象的值？

> ID：13614729
> 
> 赞同：0
> 
> 时间：2012-11-28T21:26:55.867
> 
> 标签：asp.net-mvc-3, automapper, valueinjecter

我有一个具有子类和属性的原始文档对象。我有一个不同的对象，它是该对象的一个​​子集，它保存从表单输入的值，如果您愿意，可以是视图模型。由于两个对象都来自同一类，因此结构是相同的。

有没有办法将新对象的值一般分配给原始对象？我目前的方法是明确的：

```
 myOrigDoc.Introduction.Name = myDoc.Introduction.Name;
            myOrigDoc.Introduction.Clients[0].Firstname =    
            myDoc.Introduction.Clients[0].Firstname; 
```

另外我想确保只分配具有值（非空）的属性。

这可以做到吗？

提前谢谢了，

埃德

编辑：对 ValueInjector 及其类进行实验，以防止分配空值。

```
public class StrNotNull: ConventionInjection
{
    protected override bool Match(ConventionInfo c)
    {
        return c.SourceProp.Name == c.TargetProp.Name && c.SourceProp.Value != null;
    }

    //protected override object SetValue(ConventionInfo c)
    //{
    //    return c.SourceProp.Value.ToString();
    //}
} 
```

调用它的代码：

```
 myOrigDoc.InjectFrom<StrNotNull>(myDoc); 
```

EDIT2：Automapper 使用的可能代码。虽然还不确定是否忽略空值，因此确实进行了合并。

```
 Mapper.CreateMap<Document, Document>();
        myOrigDoc = Mapper.Map<Document, Document>(myDoc); 
```

提前感谢您的任何建议和帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T22:33:34.400

您可以使用 AutoMapper，该任务的对象到对象映射器。库和文档可以在[http://automapper.org/找到](http://automapper.org/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T14:23:34.903

[ValueInjecter](http://valueinjecter.codeplex.com)可能会解决您需要的问题

# objective-c - 设置循环以每 5 秒检查一次操作，直到完成

> ID：13614730
> 
> 赞同：0
> 
> 时间：2012-11-28T21:26:58.457
> 
> 标签：objective-c

我似乎无法弄清楚......对于我的 InApp 购买，我调用 iTunes 服务器来请求格式化的价格。

另外，如果产品是 0.99，它将在美国显示 0.99，在英国显示 0.67 便士或其他任何值，在意大利显示 120 万里拉等......

但是问题来了，如果服务器宕机，或者用户立即点击inApp购买按钮，将不会显示价格......因为程序没有时间或iTunes服务器不可用......

我怎样才能设置某种计时器来检查 iTunes 服务器的可用性......然后一旦它可用就不再检查了。

我的信息几乎太多了，我似乎无法将它们捆绑在一个有凝聚力的整体中。解决这个问题的最佳方法是什么。

谢谢。

安迪

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:28:30.473

要设置计时器，请使用 NSTimer 类，在其中指定将调用的方法。

例子：

```
[NSTimer scheduledTimerWithTimeInterval:5.0
    target:self
    selector:@selector(targetMethod:)
    userInfo:nil
    repeats:YES]; 
```

targetMethod 然后将每 5 秒调用一次，在里面

更多信息，另请参阅[如何使用 NSTimer？](https://stackoverflow.com/questions/1449035/how-do-i-use-nstimer)

# git - 过滤 Git 日志以查找不包含特定单词的提交

> ID：13614731
> 
> 赞同：3
> 
> 时间：2012-11-28T21:27:01.263
> 
> 标签：git

如何过滤不包含特定单词的提交的 git 日志？

我查看了正则表达式站点，并在 Git Bash 中尝试了一些没有成功的案例。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-11-04T16:02:03.047

您可以`git log --grep="<your string>"`与`--invert-grep`参数结合使用来反转搜索条件（从 Git for Windows 2.6.2 开始）。

## 例子：

查找提交消息**包含**字符串的提交`foo`：

`git log --grep="foo"`

查找提交消息**不包含**字符串的提交`foo`：

`git log --invert-grep --grep="foo"`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T12:41:44.310

正如[克劳迪乌所说](https://stackoverflow.com/a/717659)

> 一般来说，编写一个不包含特定字符串的正则表达式是很痛苦的。我们必须为计算模型执行此操作 - 您采用 NFA，它很容易定义，然后将其简化为正则表达式。不包含“猫”的事物的表达式大约有 80 个字符长。

你可以用相反的方式来做，不是优雅，而是工作方式

`git log ... | grep -v "someword"`

PS - RE 中的否定是 ^ 前缀，它（前缀用法）可能需要 -E（扩展正则表达式） for `git log`，但是将*否定词定义为正则表达式的* **词**只是真正的噩梦

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T21:34:40.853

您只能通过这种方式搜索*提交消息*，这是通过使用`-m`签入中的标志提交代码来完成的。例子：

```
commit -m "message describing awesome code changes" 
```

这会将消息保存`"message describing awesome code changes"`在日志中，这意味着搜索单词`awesome`，例如，现在将返回它作为结果。

您正在搜索的短语/单词/消息是否可能从未包含在提交消息中？

# delphi - 为什么 SetString 内在函数会导致 PChar 参数出现“不兼容的类型”错误？

> ID：13614737
> 
> 赞同：4
> 
> 时间：2012-11-28T21:27:35.017
> 
> 标签：delphi, delphi-xe2

请原谅这个愚蠢的问题，但我很困惑。考虑以下方法（对不起，嘈杂的评论，这是一个正在开发的真实代码）：

```
function HLanguages.GetISO639LangName(Index: Integer): string;
const
  MaxIso639LangName = 9;  { see msdn.microsoft.com/en-us/library/windows/desktop/dd373848 }
var
  LCData: array[0..MaxIso639LangName-1] of Char;
  Length: Integer;
begin
  { TODO : GetLocaleStr sucks, write proper implementation }
  //Result := GetLocaleStr(LocaleID[Index], LOCALE_SISO639LANGNAME, '??');
  Length := GetLocaleInfo(LocaleID[Index], LOCALE_SISO639LANGNAME, @LCData, System.Length(LCData));
  Win32Check(Length <> 0);
  SetString(Result, @LCData, Length); // "E2008 Incompatible types" here, but why?
end; 
```

如果我删除了引用运算符，那么隐式转换 from`$X+`就会进行救援并编译方法。为什么编译器*使用引用运算符*拒绝此代码超出了我的理解。

这是 Delphi XE2，这种行为可能是它特有的。

* * *

而且，如果我在此错误范围内添加一个具有等效原型的测试用例虚拟对象作为内在原型，`HLanguages.GetISO639LangName`它将神奇地消失：

```
procedure SetString(var s: string; buffer: PChar; len: Integer);
begin
  { test case dummy }
end; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-28T21:33:12.563

您必须将其显式转换为`PChar`：

```
SetString(result,PChar(@LCData),Length); 
```

正如您所说，`SetString()`对第二个参数类型要求很高。它必须是 a`PChar`要么 a`PWideChar`要么 a `PAnsiChar`，具体取决于字符串类型本身。

我怀疑这是由于`SetString()`定义为使用 a `string`、 a`WideString`或 a`AnsiString`作为第一个参数重载的事实。因此，为了验证正确的签名，它需要与所有参数类型完全匹配：

```
SetString(var s: string; buf: PChar; len: integer); overload;
SetString(var s: AnsiString; buf: PAnsiChar; len: integer); overload;
SetString(var s: WideString; buf: PWideChar; len: integer); overload; 
```

当然，所有这些都是“内在的”，所以你不会在 system.pas 中找到这样的定义，而是直接一些类似`_LStrFromPCharLen() _UStrFromPCharLen() _WStrFromPWCharLen()`或这样的过程。

这种行为与早期版本的 Delphi 相同，并且不是 XE2 中的回归。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-28T22:28:11.273

我认为那里存在编译器错误，因为行为与`SetString`您提供的重载函数的行为不同。此外，还有与 Typed @ 运算符编译器选项的交互。不知道你是怎么设置的。我总是启用它，但我怀疑我在那里是少数。

所以我不能解释奇怪的行为，也不能回答你问的确切问题。我怀疑回答它的唯一方法是查看编译器的内部结构，而我们中很少有人能做到这一点。

无论如何，如果它有帮助，我认为传递参数的最干净的方法是这样的：

```
SetString(Result, LCData, Length); 
```

无论您将 Typed @ 运算符设置为什么，它都会编译。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-29T13:48:43.337

我知道这并不能回答有关 SetString 的具体问题，但我想指出，您可以通过简单地编写来做同样的事情

```
Result := LCData; 
```

分配给字符串时，Delphi 将具有**零**起始索引的 char 静态数组视为具有最大长度的 Null 终止字符串。考虑以下：

```
var
  IndexOneArray  : array [ 1 .. 9 ] of char;
  IndexZeroArray : array [ 0 .. 8 ] of char;
  S : string;
  T : string;
begin
  IndexOneArray  := 'ABCD'#0'EFGH';
  IndexZeroArray := 'ABCD'#0'EFGH';
  S := IndexOneArray;
  T := IndexZeroArray;

  ShowMessage (      'S has ' + inttostr(length(S)) + ' chars. '
                + #13'T has ' + inttostr(length(T)) + ' chars. ' );
end; 
```

这将显示一条消息，即 S 有 9 个字符，而 T 有 4 个。它也适用于零索引数组有 9 个非空字符时。结果将是 9 个字符，无论以下内存位置是什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-04-14T09:52:14.570

因为`LCData`是指向的指针`array`，而不是指向的`Char`。当然，有时会发生数组或记录或类以 char 类型变量开头，但结果不是静态类型编译器应该依赖的。

您必须将指针指向该数组中的字符，而不是指向数组本身。

```
SetString(Result, @LCData[Low(LCData)], Length); 
```

# url - Magento 1 - 删除 url 键/产品 url 中的数字

> ID：13614738
> 
> 赞同：11
> 
> 时间：2012-11-28T21:27:37.380
> 
> 标签：url, numbers, magento-1.9

您可能知道，如果您的产品共享一个 url 键，则 url 键将附加一个数字：

IE

`http://www.example.com/main-category/sub-category/product-name-**6260**.html`

我如何找到那个 6260 的*来源*（这是附加到我的网址的 # 之一）？我试过产品id，sku，我找不到它的来源。我问的原因是，如果我能找到它，我可以创建一个字符串替换函数，在我在某些产品列表页面上回显它们之前将其从 url 中清除。

谢谢。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-11-29T00:04:04.223

在我们到达发生这种情况的代码位置之前，请注意您正在进入一个痛苦的世界。

1.  关于如何生成这些数字并没有**简单的规则。**有时是商店 ID，有时是简单的产品 ID。在某些情况下两者都不是

2.  即使有，非从头开始的 Magento 网站也很常见包含改变这一点的自定义功能

3.  最终，由于 Magento 的人类可读/SEO 友好的 URL 位于`core_url_rewrite`表中，因此人们可以插入任意文本

除了厄运警告之外，您正在寻找的模型是`Mage::getSingleton('catalog/url')`. 这包含生成 Magento 目录和产品重写的大部分逻辑。所有这些方法都以通过该`getUnusedPath`方法传递请求路径来结束。

```
#File: app/code/core/Mage/Catalog/Model/Url.php
public function getUnusedPath($storeId, $requestPath, $idPath)
{
    //...
} 
```

此方法包含用于在 URL 末尾创建唯一编号的逻辑。完全追踪这一点超出了 Stack Overflow 帖子的范围，但这一行尤其令人鼓舞/令人沮丧。

```
$lastRequestPath = $this->getResource()
    ->getLastUsedRewriteRequestIncrement($match[1], $match[4], $storeId);
if ($lastRequestPath) {
    $match[3] = $lastRequestPath;
}
return $match[1]
    . (isset($match[3]) ? ($match[3]+1) : '1')
    . $match[4]; 
```

特别是这两行

```
$match[3] = $lastRequestPath;
//...
. (isset($match[3]) ? ($match[3]+1) : '1')
//... 
```

如果不是很明显，在某些情况下，Magento 会自动将 a 附加`1`到 URL，然后继续增加它。这使得这些 URL 的生成依赖于它们生成时的系统状态——没有简单的规则。

此文件中其他感兴趣的行是

```
if (strpos($idPath, 'product') !== false) {
    $suffix = $this->getProductUrlSuffix($storeId);
} else {
    $suffix = $this->getCategoryUrlSuffix($storeId);
} 
```

这`$suffix`也将用于 URL 的末尾，因此这些方法值得研究。

如果您想要做的只是从 URL 中删除数字，那么使用正则表达式或一些`explode`/`implode`字符串抖动可能会更好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T04:37:15.940

我几乎不知道为什么会这样，但这对我有用。很可能是因为它使网址不唯一。Magento 版本。1.7.0.2 突然开始为我的新产品名称添加数字作为后缀，即使它们的 url 键和名称与旧产品不同。凭直觉，我去了`System -> Configuration -> Catalog -> Search Engine Optimizations -> Product URL Suffix`并将默认设置更改`.html`为`-prod.html`. 我想您可以将其更改为您想要的任何后缀。然后我重新索引了我的网站，刷新了缓存，然后很快！所有数字都从产品网址中消失了。产品网址现在都具有格式`custom-product-name-prod.html`。规范标签也显示`custom-product-name-prod.html`，所以我很高兴。

不知道它是否适用于其他人，但我希望它会。请注意，我确实有具有重复 URL 的新旧产品，并且在执行此过程之前我已禁用旧产品。因此，如果您有 2 个具有相同 url 键的产品并且都启用了，那么这可能不适合您。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-09-30T11:58:05.833

有问题！当您查看编辑产品时，您可以看到链接是正确的，但在您的商店中，网址不同。

*   第 1 步：编辑 URL 并将 SS 添加到自定义 URL 的末尾。按保存。\产品名称.html
*   第 2 步：转到目录 -> URL 重写
*   第 3 步：缩小标准以仅包括问题情况。按搜索。
*   第 4 步：下载 Jib Bit Mouse Recorder/Macro Recorder。它免费我支付。
*   第 5 步：编辑第一次重写。按删除和确定。
*   第 6 步：按 JitBit 上的录制。编辑第一次重写。删除。好的。按停止。
*   第 7 步：下拉播放选择 X 次。写入记录数。按确定。
*   第 8 步：观看节目为您删除所有记录。
*   第 9 步：目录 -> 管理产品。从自定义 URL 的末尾删除 SS。不要检查创建重定向。固定的。

我的是 279 条更改该产品的记录。所以花了大约一个小时。

# logic - 在 Alloy 中建模完全连接的图

> ID：13614740
> 
> 赞同：3
> 
> 时间：2012-11-28T21:27:41.190
> 
> 标签：logic, alloy, model-checking

我正在尝试使用 Alloy（对于形式逻辑也相对较新），并且尝试从完全连接的节点图开始。

```
sig Node {
  adj : set Node
}

fact {
  adj = ~adj    -- symmetrical
  no iden & adj     -- no loops
  all n : Node | Node in n.*adj -- connected
}

pred ex { }
run ex for exactly 3 Node 
```

从图中可以看出，节点 0 和 1 未连接。我认为我的事实足以让它完全联系起来……但也许我错过了一些东西。

![合金](../Images/f1f57e9b396e98351afe142196630a71.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-28T22:19:44.277

怎么样

```
adj = Node -> Node - iden 
```

这基本上说`adj`包含所有可能的节点对，除了身份（自循环）。

`Node1`可以为您的模型连接并且没有连接的原因是`Node2`您的事实的最后一个子句，它限制了对于每个节点，所有节点都是可传递的，但在我看来，您希望它们立即可访问。或者使用我上面的解决方案，您可以更改

`all n: Node | Node in n.*adj`到`all n: Node | (Node - n) in n.adj`

以获得相同的效果。

# java - 对话框没有被点击就消失了

> ID：13614741
> 
> 赞同：0
> 
> 时间：2012-11-28T21:27:41.873
> 
> 标签：java, android, android-intent, dialog

```
public void onClick(View v) {

            if(a){

Intent i = new Intent();
if(type.equals("x")){
showErrorAlert("string");

                    i = new Intent(Activity1.this, Activity2.class);
                    i.putExtra("label", var);
                    i.putExtra("label1", var2);
                    startActivity(i);
                }
                else if(type.equals("y")){
                    i = new Intent(Activity1.this, Activity3.class);
                    i.putExtra("label2", var3);
                }

                //startActivity(i);
            }

            else startActivity(new Intent(Activity1.this, Activity4.class));
        }
    });

private void showErrorAlert(String errorMsg){           
    AlertDialog errorDialog = new AlertDialog.Builder(this).create();
    errorDialog.setTitle("title");
    errorDialog.setMessage(errorMsg);
    errorDialog.setButton(AlertDialog.BUTTON_NEUTRAL, "Okay", new  DialogInterface.OnClickListener() {

        @Override
        public void onClick(DialogInterface dialog, int which) {
            // TODO Auto-generated method stub

        }
    });

    errorDialog.show();
} 
```

所以会发生错误警报显示，但它会立即关闭并出现下一个活动。我希望活动在选择“好的”之后才开始。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T21:29:06.443

根据您的需要，将您`startActivity(i);`的 if（或）else（或）两个块移至内部。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T00:53:29.873

放置 startActivity(i); 在对话框中的 onClick 方法中，如下所示：

```
private void showErrorAlert(String errorMsg){           
        AlertDialog errorDialog = new AlertDialog.Builder(this).create();
        errorDialog.setTitle("title");
        errorDialog.setMessage(errorMsg);
        errorDialog.setButton(AlertDialog.BUTTON_NEUTRAL, "Okay", new  DialogInterface.OnClickListener() {

            @Override
            public void onClick(DialogInterface dialog, int which) {
                startActivity(i);

            }
        });

        errorDialog.show();
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T06:13:15.337

试试这个

```
public void onClick(View v) {

            if(a){
                Intent i = new Intent();
                if(type.equals("x")){
                 showErrorAlert("string");

               }
                else if(type.equals("y")){
                    i = new Intent(Activity1.this, Activity3.class);
                    i.putExtra("label2", var3);
                }

                //startActivity(i);
            }

            else startActivity(new Intent(Activity1.this, Activity4.class));
        }
    });

private void showErrorAlert(String errorMsg){           
    AlertDialog errorDialog = new AlertDialog.Builder(this).create();
    errorDialog.setTitle("title");
    errorDialog.setMessage(errorMsg);
    errorDialog.setButton(AlertDialog.BUTTON_NEUTRAL, "Okay", new  DialogInterface.OnClickListener() {

        @Override
        public void onClick(DialogInterface dialog, int which) {
            // TODO Auto-generated method stub

             Intent i = new Intent(Activity1.this, Activity2.class);
                    i.putExtra("label", var);
                    i.putExtra("label1", var2);
                    startActivity(i);
        }
    });

    errorDialog.show();
} 
```

# r - R中的模数错误

> ID：13614749
> 
> 赞同：3
> 
> 时间：2012-11-28T21:28:02.193
> 
> 标签：r, modulo

> **可能重复：**
> [为什么这些数字不相等？](https://stackoverflow.com/questions/9508518/why-are-these-numbers-not-equal)

刚刚注意到 R 中的这个错误。我猜这是 0.6 的表示方式，但有人知道到底发生了什么吗？

根据 R：

```
0.3 %% 0.2 = 0.1
0.4 %% 0.2 = 0
0.5 %% 0.2 = 0.1
**0.6 %% 0.2 = 0.2**
0.7 %% 0.2 = 0.1
0.8 %% 0.2 = 0 
```

这是怎么回事？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-28T21:48:49.157

除了@joshua Ulrich 的评论

从`?'%%'`

> %% 和 x %/% y 可用于非整数 y，例如 1 %/% 0.2，但结果会出现表示错误，因此可能与平台有关。因为 0.2 的 IEC 60059 表示是略大于 0.2 的二进制分数，所以 1 %/% 0.2 的答案应该是 4，但大多数平台给出 5。

也类似于我们得到这个的原因

```
> .1 + .1 + .1 == .3
[1] FALSE 
```

正如@Ben Boker 指出的那样，您可能想要使用类似的东西

```
> 3:8 %% 2 / 10
[1] 0.1 0.0 0.1 0.0 0.1 0.0 
```

# java - Java swing 单选按钮，带有变化的、可点击的图标

> ID：13614750
> 
> 赞同：3
> 
> 时间：2012-11-28T21:28:04.393
> 
> 标签：java, swing, icons, actionlistener

设计一个问题，答案的范围可以通过radioButtons来选择。为了显示更大的可点击区域（该应用程序用于触摸屏），我将 icon_1 放在单选按钮上。

每次鼠标点击都可以将显示的图标更改为 icon_2，反之亦然。对不起，使用

```
jRadioButtonActionPerformed 
ImageIcon o_ButtonIcon = new ImageIcon ("....") 
jRadioButton.setIcon(Icon m_ButtonIcon). 
```

我没有改变，可点击的图像。你能帮帮我吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-28T21:42:58.637

似乎工作正常。

发布[SSCCE](http://sscce.org)以显示具体问题。

![在此处输入图像描述](../Images/e14f0b32cd644c6de2be993e71d46052.png)

![在此处输入图像描述](../Images/81a39023f5a839229e9b0e6c63d3ad83.png)

这是示例（我不建议`getScaledInstance(..)`仅将其用于快速示例）

```
import java.awt.Image;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.net.URL;
import javax.imageio.ImageIO;
import javax.swing.ImageIcon;
import javax.swing.JFrame;
import javax.swing.JRadioButton;
import javax.swing.SwingUtilities;

public class Test {

    private ImageIcon ii1;
    private ImageIcon ii2;
    private JRadioButton jrb = new JRadioButton("Click me :)");
    private JFrame frame = new JFrame();

    public Test() {
        try {
            ii1 = new ImageIcon(ImageIO.read(new URL("http://cdn.macrumors.com/article/2010/09/03/145454-itunes_10_icon.jpg")).getScaledInstance(48, 48, Image.SCALE_SMOOTH));
            ii2 = new ImageIcon(ImageIO.read(new URL("http://www.quarktet.com/Icon-small.jpg")).getScaledInstance(48, 48, Image.SCALE_SMOOTH));
        } catch (Exception ex) {
            ex.printStackTrace();
        }
        initComponents();
    }

    public static void main(String args[]) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                new Test();
            }
        });
    }

    private void initComponents() {
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        jrb.setIcon(ii1);
        jrb.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent ae) {
                if (jrb.getIcon() == ii1) {
                    jrb.setIcon(ii2);
                } else {
                    jrb.setIcon(ii1);
                }
            }
        });

        frame.add(jrb);
        frame.pack();
        frame.setVisible(true);
    }
} 
```

# php - 发送不带 vars 数组的 cUrl 数据

> ID：13614751
> 
> 赞同：1
> 
> 时间：2012-11-28T21:28:15.543
> 
> 标签：php, curl, http-post

我尝试在不设置变量或数组的情况下发布数据。我不知道这可能吗？当我发送 $data = array('var_name'=>'var_val') 一切正常，但是当我设置 $data ='to send' 时，我没有得到任何发布数据。

$data = '要发送的样本数据';

```
 $ch = curl_init($url);                                                                      
    curl_setopt($ch, CURLOPT_POST, true);

    curl_setopt($ch, CURLOPT_HEADER, false);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, false);
    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
    curl_setopt($ch, CURLOPT_BINARYTRANSFER, true);
    //curl_setopt($ch,CURLOPT_HTTPHEADER,array('Content-type: application/json'));
    curl_setopt($ch, CURLOPT_POSTFIELDS, $data);                        

    $resp = curl_exec($ch); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T08:23:28.187

原因是“发送”成为 $_POST 数据的关键。为了能够看到它，在 $url 的 PHP 文件中，执行 var_dump($_POST); 这应该显示输出的关键值。但正如你所料，它没有任何价值。

您可以将您在 POSTFIELDS 中写入的数据作为原始数据使用

```
$yourPostedData = file_get_contents('php://input'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T08:25:45.067

从[手册](http://php.net/curl_setopt)：

> ### CURLOPT_POSTFIELDS
> 
> 在 HTTP“POST”操作中发布的完整数据。要发布文件，请在文件名前加上 @ 并使用完整路径。可以通过使用格式为“ `;type=mimetype`”的文件名来显式指定文件类型。此参数可以作为 urlencoded 字符串传递，也可以`'para1=val1&para2=val2&...'`作为数组传递，其中字段名称作为键，字段数据作为值。如果 value 是一个数组，则 Content-Type 标头将设置为`multipart/form-data`。从 PHP 5.2.0 开始，如果文件以 @ 前缀传递给此选项，则 value 必须是数组。

*另一*端假定简单字符串是键/值对。无论另一端是什么，都看不到您传递的未键入的值。如果这是 GET 而不是 POST，我会说只是检查查询字符串。由于情况并非如此，您需要使用键和值来发送数据，或者弄清楚另一端如何读取原始 POST 数据。如果另一端是 PHP，那么[至少有两种方法](http://php.net/reserved.variables.httprawpostdata)可以做到这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T20:03:06.173

POST 请求不一定包含成对的`variable = value`. 有时它包含原始数据。要访问它，您需要使用`$HTTP_RAW_POST_DATA`在这种情况下将填充原始 POST 数据的变量。

# javascript - .net 会话超时和 Kendo 弹出窗口

> ID：13614753
> 
> 赞同：0
> 
> 时间：2012-11-28T21:28:19.457
> 
> 标签：javascript, asp.net, asp.net-mvc, kendo-ui

我使用 Kendoui 框架使用弹出窗口进行编辑操作。

当弹出窗口打开时会话超时，登录页面将加载到弹出窗口内。

我想在表单重定向页面中添加 js，并检查它是否正在弹出窗口中加载，如果是，则重定向并关闭窗口。

有没有办法确定页面是否在弹出窗口中加载，如果是，我如何获得它的句柄？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T00:18:08.853

通常，在您单击按钮或执行某些操作之前，该页面不会重定向到登录页面。我们遇到了同样的问题，我们使用 Ajax 调用弹出窗口解决了这个问题。所以我们在弹出窗口上有一些按钮，我们从服务器读取响应。如果会话已经过期，您将收到错误的响应代码（肯定不是 200）。您可以阅读和解释它，并在您的 JS 关闭弹出窗口中并重定向到登录页面，例如：

```
window.location = login_url 
```

# html - CSS 中 100% 高度的空 div

> ID：13614761
> 
> 赞同：17
> 
> 时间：2012-11-28T21:28:31.553
> 
> 标签：html, css

我已经用这个代码玩了将近半天，最后我决定把它传给你。我想将三个`div`元素彼此相邻放置，左右元素围绕主要元素。我希望两个外部 div 都只包含一个背景图像，因此与中间的高度相同`div`。我一直在使用其他类似帖子的解决方案，但我所有的尝试都没有成功。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="pl" lang="pl">
<head>  
</head>
<body>
<div id="container">
    <div id="left"></div>
    <div id="content">
        <p> Lorem ipsum dolor<br/><br/>sit amet<br/><br/>consectetur adipiscing elit</p>
    </div>
    <div id="right"></div>
</div>
</body> 
```

CSS：

```
body {
    text-align: center;
}

div#container {
    width: 954px;
    margin: 0px auto;
    height: 100%;
    border: 1px solid lime;
    overflow: hidden;
    position: relative;
}

div#left {
    margin: 0px auto;
    width: 5px;
    border: 1px solid red;
    float: left;
    display: block;
}

div#right {
    margin: 0px auto;
width: 5px;
float: left;
border: 1px solid blue;
}

div#content {
    width: 920px;
    margin: 0px auto;
    text-align: left;
    background: #ffffff;
    padding: 0px 10px;
    float: left;
}
p {
    font: normal 16px/18px 'Trebuchet MS', Helvetica, sans-serif;
    margin: 20px 0px;
} 
```

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-11-28T21:36:42.197

您需要添加`height: 100%`到您的`body`和`html`标签，以及您的 div 类：

```
html {
    height: 100%; /* <------------ */
}

body {
    text-align: center;
    height: 100%; /* <------------ */
}

div#container {
    width: 954px;
    margin: 0px auto;
    height: 100%;
    border: 1px solid lime;
    overflow: hidden;
    position: relative;
}

div#left {
    margin: 0px auto;
    width: 5px;
    border: 1px solid red;
    float: left;
    display: block;
    height: 100%; /* <------------ */
}

div#right {
    margin: 0px auto;
    width: 5px;
    float: left;
    border: 1px solid blue;
    height: 100%; /* <------------ */
}

div#content {
    width: 920px;
    margin: 0px auto;
    text-align: left;
    background: #ffffff;
    padding: 0px 10px;
    float: left;
    height: 100%; /* <------------ */
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-28T21:47:14.033

我知道这并不能真正回答您的问题，但我倾向于使用`position:relative`在父元素和`position:absolute`封顶元素上使用的方法。这保证了动态变化的框不会影响您的布局。由于语义原因，我也喜欢使用 :before :after 属性（IE 8+），但您可以使用子元素。效果一样好。我还加入了 box-sizing （FF 需要 -moz 语法），所以边框看起来不丑。（在生产环境中可能没有必要，因为您将使用背景）。

现在，代码！

## CSS

```
div#container:before {
    content:"";
    width: 5px;
    border: 1px solid red;
    display: block;
    position:absolute;
    height:100%;
    left:0px;
    top:0px;
    box-sizing:border-box; /* careful... FF needs -moz if you need that compatibility */
}

div#container:after {
    content:"";
    width: 5px;
    border: 1px solid blue;
    display: block;
    position:absolute;
    height:100%;
    right:0px;
    top:0px;
    box-sizing:border-box;
} 
```

## HTML

```
<div id="container">
    <div id="content">
        <p> Lorem ipsum dolor<br/><br/>sit amet<br/><br/>consectetur adipiscing elit</p>
    </div>
</div> 
```

## 演示

[http://jsfiddle.net/f7yL6/](http://jsfiddle.net/f7yL6/)
[http://jsfiddle.net/f7yL6/show](http://jsfiddle.net/f7yL6/show)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-29T09:02:20.830

媒体查询可用于实现 % 提供的大部分功能，而不会带来任何痛苦。它不是那么流畅，但是当用于介绍横幅时，它是完全可以接受的。

首先使用移动声明，你会使用这样的东西。

```
.banner { height: 200px; }

@media all and (min-width: 500px) {
  .banner { height: 400px; }
}

@media all and (min-width: 1000px) {
  .banner { height: 500px; }
} 
```

编辑：我使用了 min-width 但 min-height 也可以使用。为了真正让所有设备上的东西看起来都很好，需要混合使用 min-width 和 min-height 。

# python - 将字典对象插入到数组的特定元素中（Python/Django）

> ID：13614763
> 
> 赞同：0
> 
> 时间：2012-11-28T21:28:38.860
> 
> 标签：python, django, arrays, dictionary

我有 Python 代码，它从数据库中获取数据，如下所示：

```
for result in request.user.results.all():
    data.append(dict([(str(word.type.type), str(word.word)) for word in result.word.all()
    data.append(dict([(season, ResultForm.CHOICES[r.season][1])])) 
```

将“数据”显示为：

```
[{'color': 'blue', 'kind': 'pencil', 'rating': 'high'}, {'color': 'red', 'kind': 'truck', 'rating': 'low'}, {'season': 'winter'}, {'season': 'spring'}] 
```

我如何调整代码，使数据的输出看起来像：

```
[{'color': 'blue', 'kind': 'pencil', 'rating': 'high', 'season': 'winter'}, {'color': 'red', 'kind': 'truck', 'rating': 'low', 'season': 'spring'}] 
```

不要只添加最后一个对象，而是将其添加到每个元素中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T21:36:01.687

我想你想要`dict.update`这里。但是，我有点不确定在哪里插入，`dict.update`因为我不知道你的代码是如何工作的——在我看来，你的输出应该是这样的：

```
[{'color': 'blue', 'kind': 'pencil', 'rating': 'high'}, {'season': 'winter'}, {'color': 'red', 'kind': 'truck', 'rating': 'low'},  {'season': 'spring'}] 
```

由于“季节”字典是在另一个（“颜色”等）字典之后立即添加的......

* * *

作为旁注：

```
dict([(score, ResultForm.CHOICES[r.season][1])]) 
```

必须更容易理解（和有效）地写成：

```
{score: ResultForm.CHOICES[r.season][1]} 
```

* * *

如您的评论所示，我相信您想要这样的东西：

```
for result in request.user.results.all():
    data.append(dict((str(word.type.type), str(word.word)) for word in result.word.all()))
    data[-1].update( {score: ResultForm.CHOICES[r.season][1]} ) 
```

# jquery - jQuery：如何在 Ajax 调用后获取数据值

> ID：13614764
> 
> 赞同：1
> 
> 时间：2012-11-28T21:28:50.120
> 
> 标签：jquery

我已经阅读了其他一些关于此的问题，但我仍然无法弄清楚如何让它发挥作用。

我有这个函数进行ajax调用：

```
 function validateDataPoint(newDataPoint) {
        var $form = $(this).parents('form');
        var $formAction = $form.attr('action');
        var $validationResult;

        return $.ajax({
            type: "POST",
            url: "/DataPoints/ValidateNewDataPointBeforeSaving",
            data: newDataPoint
        });

        return $validationResult;
    } 
```

这就是我在另一个函数中调用它的方式：

```
 var validationRequest = validateDataPoint(newDataPoint);
        validationResult = validationRequest.success(function (data) {
            return data.Urn;
        }); 
```

然后在同一个函数中，我想测试validationResult 的值，因为data.Urn 与在服务器端完成的处理相关的字符串值要么是“Success”，要么是“Failed”。

所以这里是下面的代码：

```
 //post the Json object to the server to validate and get the result
        var validationRequest = validateDataPoint(newDataPoint);
        validationResult = validationRequest.success(function (data) {
            return data.Urn;
        });

        //based on the result give the thumbs-up or thumbs-down
        if (validationResult == "Success") {
            resultFlag = "<span class='badge badge-success'><i class='icon-thumbs-up icon-white'></i></span>";
        }
        else if (validationResult == "Failed") {
            resultFlag = "<span class='badge badge-important'><i class='icon-thumbs-down icon-white'></i></span>";
        }
        else {
            resultFlag = "<span class='badge badge-warning'></span>";
        } 
```

**所以问题是**...

当我尝试访问 validationResult.responseText 的值时，我得到一个未定义的错误。基本上我想将 data.Urn 的值分配给 validationResult 但我无法让它工作。如果我提醒（验证结果）；我得到 [object Object] 然后如果我 alert(validationResult); 我不确定。

我在这里想念什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:34:52.737

jQuery 的 ajax 函数以异步方式工作。在 ajax 实际完成之前，您的检查`validationResult`正在发生。

为什么不把它们放在回调中？

```
validationResult = validationRequest.success(function (data) {
    processResponse(data.Urn);
});

function processResponse(validationResult)
{
    //based on the result give the thumbs-up or thumbs-down
    if (validationResult == "Success") {
        resultFlag = "<span class='badge badge-success'><i class='icon-thumbs-up icon-white'></i></span>";
    }
    else if (validationResult == "Failed") {
        resultFlag = "<span class='badge badge-important'><i class='icon-thumbs-down icon-white'></i></span>";
    }
    else {
        resultFlag = "<span class='badge badge-warning'></span>";
    }
} 
```

# java - 无法通过 servlet 代码在 tomcat 服务器上上传文件

> ID：13614768
> 
> 赞同：1
> 
> 时间：2012-11-28T21:29:14.543
> 
> 标签：java, android, servlets, tomcat7

我一直在尝试通过 servlet 将文件上传到 Tomcat 服务器，但没有成功。我能够创建一个目录，但不知何故，servlet 代码没有在“上传”目录中创建一个文件。

Android中的Java代码：

```
 public void upLoad()
{

     String exsistingFileName = path+"//"+"test123.txt";

     String lineEnd = "\r\n";
     String twoHyphens = "--";
     String boundary = "*****";
     try {
         // ------------------ CLIENT REQUEST

         Log.e(Tag, "Inside second Method");

         FileInputStream fileInputStream = new FileInputStream(new File(
                 exsistingFileName));

         // open a URL connection to the Servlet

         URL url = new URL(urlString);

         // Open a HTTP connection to the URL

         conn = (HttpURLConnection) url.openConnection();

         // Allow Inputs
         conn.setDoInput(true);

         // Allow Outputs
         conn.setDoOutput(true);

         // Don't use a cached copy.
         conn.setUseCaches(false);

         // Use a post method.
         conn.setRequestMethod("POST");

         conn.setRequestProperty("Connection", "Keep-Alive");

         conn.setRequestProperty("Content-Type",
                "multipart/form-data;boundary=" + boundary);

         DataOutputStream dos = new DataOutputStream(conn.getOutputStream());

         dos.writeBytes(twoHyphens + boundary + lineEnd);
         dos.writeBytes("Content-Disposition: post-data; name=uploadedfile;filename="
                         + exsistingFileName + "" + lineEnd);
         dos.writeBytes(lineEnd);

         Log.e(Tag, "Headers are written");

         // create a buffer of maximum size

         int bytesAvailable = fileInputStream.available();
         int maxBufferSize = 1000;
         // int bufferSize = Math.min(bytesAvailable, maxBufferSize);
         byte[] buffer = new byte[bytesAvailable];

         // read file and write it into form...

         int bytesRead = fileInputStream.read(buffer, 0, bytesAvailable);

         while (bytesRead > 0) {
             dos.write(buffer, 0, bytesAvailable);
             bytesAvailable = fileInputStream.available();
             bytesAvailable = Math.min(bytesAvailable, maxBufferSize);
             bytesRead = fileInputStream.read(buffer, 0, bytesAvailable);
         }

         // send multipart form data necesssary after file data...

         dos.writeBytes(lineEnd);
         dos.writeBytes(twoHyphens + boundary + twoHyphens + lineEnd);

         // close streams
         Log.e(Tag, "File is written");
         fileInputStream.close();
         dos.flush();
         dos.close();

     } catch (MalformedURLException ex) {
         Log.e(Tag, "error: " + ex.getMessage(), ex);
     }

     catch (IOException ioe) {
         Log.e(Tag, "error: " + ioe.getMessage(), ioe);
     }

     try {
         BufferedReader rd = new BufferedReader(new InputStreamReader(conn
                 .getInputStream()));
         String line;
         while ((line = rd.readLine()) != null) {
             Log.e("Dialoge Box", "Message: " + line);
         }
         rd.close();

     } catch (IOException ioex) {
         Log.e("MediaPlayer", "error: " + ioex.getMessage(), ioex);
     }
} 
```

Tomcat 服务器上的 Servlet 代码：

```
import java.io.File;
import java.io.IOException;
import java.util.Iterator;
import java.util.List;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.apache.commons.fileupload.FileItem;
import org.apache.commons.fileupload.disk.DiskFileItemFactory;
import org.apache.commons.fileupload.servlet.ServletFileUpload;

/**
* Servlet implementation class UploadServlet
*/
public class UploadServlet extends HttpServlet {
private static final long serialVersionUID = 1L;

private static final String UPLOAD_DIRECTORY = "upload";
private static final int THRESHOLD_SIZE = 1024 * 1024 * 3; // 3MB
private static final int MAX_FILE_SIZE = 1024 * 1024 * 40; // 40MB
private static final int REQUEST_SIZE = 1024 * 1024 * 50; // 50MB

/**
 * @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse
 *      response)
 */
 protected void doPost(HttpServletRequest request,
        HttpServletResponse response) throws ServletException, IOException {
    // checks if the request actually contains upload file
    if (!ServletFileUpload.isMultipartContent(request)) {
        // if not, we stop here
        return;
    }

    // configures some settings
    DiskFileItemFactory factory = new DiskFileItemFactory();
    factory.setSizeThreshold(THRESHOLD_SIZE);
    factory.setRepository(new File(System.getProperty("java.io.tmpdir")));

    ServletFileUpload upload = new ServletFileUpload(factory);
    upload.setFileSizeMax(MAX_FILE_SIZE);
    upload.setSizeMax(REQUEST_SIZE);

    // constructs the directory path to store upload file
    String uploadPath = getServletContext().getRealPath("")
        + File.separator + UPLOAD_DIRECTORY;
    // creates the directory if it does not exist
    File uploadDir = new File(uploadPath);
    if (!uploadDir.exists()) {
        uploadDir.mkdir();   //I can see the created directory...but nothing happens after that....No error message display after creating directory
    }

    try {
        // parses the request's content to extract file data
        List formItems = upload.parseRequest(request);
        Iterator iter = formItems.iterator();

        // iterates over form's fields
        while (iter.hasNext()) {
            FileItem item = (FileItem) iter.next();
            // processes only fields that are not form fields
            if (!item.isFormField()) {
                String fileName = new File(item.getName()).getName();
                String filePath = uploadPath + File.separator + fileName;
                File storeFile = new File(filePath);

                // saves the file on disk
                item.write(storeFile);
            }
        }
        request.setAttribute("message", "Upload has been done successfully!");
    } catch (Exception ex) {
        request.setAttribute("message", "There was an error: " + ex.getMessage());
    }
    getServletContext().getRequestDispatcher("/message.jsp").forward(request,         response);
 }
} 
```

我在服务器上的文件结构是：

```
/webapps/
   demo/
      upload/ - The file I'm trying to create (test123.txt) should be inside this folder, but it's not.
   WEB-INF/
      classes/ - UploadServlet.class
      lib/ - commons IO and upload jars 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T01:34:46.477

你的`Content-Disposition`标题是错误的。它说`post-data`虽然它必须`form-data`以防万一`multipart/form-data`。在您的客户端中相应地修复它：

```
dos.writeBytes("Content-Disposition: form-data; name=uploadedfile;filename="
                     + exsistingFileName + "" + lineEnd); 
```

### 也可以看看：

*   [使用 java.net.URLConnection 触发和处理 HTTP 请求](https://stackoverflow.com/questions/2793150/how-to-use-java-net-urlconnection-to-fire-and-handle-http-requests)

* * *

**与具体问题无关**，将上传的文件存储在 webapp 的部署文件夹中绝对是个坏主意。每当您重新部署 webapp 的新版本时，它们都会丢失，原因很简单，到目前为止所有上传的文件肯定不包含在原始 WAR 中。将它们存储在部署文件夹之外的其他位置。只是永远不要使用`getRealPath()`，它只会导致不良做法。

此外，`FileInputStream#available()`绝对不会按照您在代码中的想法进行操作。摆脱它，只需在具有固定缓冲区大小（例如 10KB）的 for 循环中执行通常的读写操作。

此外，`DataOutputStream`在这里使用是可怕的。它有不同的用途（创建`.dat`文件），在这个特定的结构中，字符编码相关问题存在很大风险。只需使用带有指定字符集的`PrintWriter`环绕即可。`OutputStreamWriter`请注意，上面的“另请参阅”链接中显示了一个完整的示例。

# objective-c - NSFontManager selectedFont 返回 null

> ID：13614769
> 
> 赞同：6
> 
> 时间：2012-11-28T21:29:18.107
> 
> 标签：objective-c, xcode, cocoa, nsfontpanel, nsfontmanager

好的，所以我检查了整个 SO 和 Google，但我找不到我的代码有什么问题：

```
- (IBAction)selectFont:(id)sender
{
    NSFontManager *fontManager = [NSFontManager sharedFontManager];
    [fontManager setDelegate:self];
    [fontManager setTarget:self];

    NSFontPanel *fontPanel = [fontManager fontPanel:YES];
    [fontPanel makeKeyAndOrderFront:sender];
}

- (void)changeFont:(id)sender
{
    NSFontManager *fontManager = [NSFontManager sharedFontManager];
    font = [fontManager selectedFont];
    NSLog(@"%@",[fontManager selectedFont]);
} 
```

字体面板弹出，但是当我选择一种字体时，控制台会返回`(null)`字体管理器的所选字体。有人知道我错过了什么吗？

谢谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-28T22:40:24.210

Apple 的[文档](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/ApplicationKit/Classes/NSFontManager_Class/Reference/Reference.html#//apple_ref/occ/instm/NSObject/changeFont%3a)说使用`selectedFont`in`changeFont:`可能会导致意外行为，并且“*强烈建议不要在 changeFont: 中使用 selectedFont。* ”获取字体的适当方法`NSFontPanel`是要求`NSFontManager`将当前字体转换为所选字体。这是一个正确使用的示例应用程序`NSFontPanel`：

```
@interface AppDelegate : NSObject <NSApplicationDelegate>{
    NSFont *font;
}

- (IBAction)selectFont:(id)sender;

@end

@implementation AppDelegate

- (void)applicationDidFinishLaunching:(NSNotification *)aNotification
{
    font = [NSFont boldSystemFontOfSize:12];
}

- (IBAction)selectFont:(id)sender
{
    NSFontManager *fontManager = [NSFontManager sharedFontManager];
    [fontManager setDelegate:self];
    [fontManager setTarget:self];
    [fontManager orderFrontFontPanel:self];
}

- (void)changeFont:(id)sender
{
    font = [sender convertFont:font];
    NSLog(@"%@", font);
} 
```

我已经删除了与您的问题无关的代码片段（例如 IBOutlets 到 NSButtons 和 NSWindow）。
请注意，此示例使用 ARC。

另一件重要的事情是，参数 to`convertFont:`需要是一个有效的`NSFont`实例。否则，`convertFont:`即使在`NSFontPanel`. 因此，将`NSFont *font`实例变量初始化为有效`NSFont`实例很重要。

# python - 是否有用于创建特定大小的测试文件的 Python 模块？

> ID：13614774
> 
> 赞同：3
> 
> 时间：2012-11-28T21:29:39.490
> 
> 标签：python, file, testing

我有一个上传文件的服务器。我需要分析各种文件大小的上传/响应时间到该服务器，即上传 10kb 文件、100mb 文件和许多其他大小的文件需要多长时间。我想避免手动创建所有文件并存储它们。

是否有一个 Python 模块可以让您创建任意大小的测试文件？我基本上在寻找类似的东西：

```
test_1mb_file = test_file_module.create_test_file(size=1048576) 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-28T21:34:33.380

你真的不需要写 1MB 来创建一个 1MB 的文件：

```
with open('bigfile', 'wb') as bigfile:
    bigfile.seek(1048575)
    bigfile.write('0') 
```

另一方面，你真的需要一个文件吗？许多 API 采用任何“类文件对象”。并不总是很清楚这是否意味着`read`,`read`和`seek`, 逐行迭代或其他什么……但无论如何，您应该能够模拟一个 1MB 的文件，而不会创建比单个`read`或`readline`一次更多的数据。

PS，如果您实际上不是从 Python 发送文件，只是创建它们以供以后使用，则有专门为此类事情设计的工具：

```
dd bs=1024 seek=1024 count=0 if=/dev/null of=bigfile # 1MB uninitialized
dd bs=1024 count=1024 if=/dev/zero of=bigfile # 1MB of zeroes
dd bs=1024 count=1024 if=/dev/random of=bigfile # 1MB of random data 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T21:31:38.090

做就是了：

```
size = 1000
with open("myTestFile.txt", "wb") as f:
    f.write(" " * size) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-28T21:33:02.877

我可能会使用类似的东西

```
with tempfile.NamedTemporaryFile() as h:
    h.write("0" * 1048576)
    # Do whatever you need to do while the context manager keeps the file open
# Once you "outdent" the file will be closed and deleted. 
```

这使用 Python 的[tempfile](http://docs.python.org/2/library/tempfile.html#tempfile.TemporaryFile)模块。

我使用 a`NamedTemporaryFile`以防您需要外部访问它，否则 a`tempfile.TemporaryFile`就足够了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-09-13T18:47:59.320

来自@abarnert 和@jedwards 的回答：

```
mb = 1
with tempfile.TemporaryFile() as tf:
    tf.seek(mb * 1024 * 1024 - 1)
    tf.write(b'0')
    tf.seek(0) 
```

# c - 我应该如何将一个巨大的 int/double 数组插入到 bson 对象中？

> ID：13614776
> 
> 赞同：2
> 
> 时间：2012-11-28T21:29:50.103
> 
> 标签：c, mongodb, bson

我应该如何使用 C 库向 BSON 对象添加一个巨大的多维 (100x100) 整数/双精度/浮点字段？

我看到的最接近的 stackoverflow 问题/答案是针对 C++（[MongoDB：如何在 C++ 中的 BSON 中存储二进制数组？](https://stackoverflow.com/questions/7840824/mongodb-how-do-i-store-binary-array-in-a-bson-in-c)）

我在想也许我应该使用 bson_append_binary？我不太确定我会怎么做……我应该承认我的 C 很弱。我会写下我认为可以将 double[] 转换为二进制的方式，但我真的不知道如何。

我不反对切换到 C++，但如果可行，我更愿意坚持使用 C 驱动程序。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T14:19:57.057

我，和回答的人是对的，是`bson_append_binary`。

正在做，

```
int array[] = {10,11,12};
int *array_ptr = array;
...
bson_append_binary(&b, "fld", BSON_BIN_USER, (char*)array_ptr, sizeof(array));
... 
```

然后，我能够从 mongo 中读取数组：

```
...
if ( bson_find( iterator, mongo_cursor_bson( cursor ), "fld" )) {
    array_ptr = (int*)bson_iterator_bin_data(iterator);
    printf(" first element: %i\n", *(array_ptr++));
    printf("second element: %i\n", *(array_ptr++));
    printf(" third element: %i\n", *array_ptr);
}
... 
```

看起来很简单，但因为我的 C 很糟糕，我花了好几个小时。下一个挑战是弄清楚如何从另一个（例如 PHP）客户端读取二进制文件。感谢帮助过的人！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T03:44:42.883

看起来您会使用 bson_append_binary() 函数调用：

[bson_append_binary() API 文档](http://api.mongodb.org/c/current/api/bson_8h.html#a9f2a39604f01c1f6337717f5c2a38aea)

所以代码看起来像：

```
int[100][100] bigArray;
bson_append_binary(bsonHandle, "yourFieldName", BSON_BIN_BINARY, bigArray, sizeof(bigArray)); 
```

# ruby-on-rails - `Model.where(:attribute)` 或 `Model.find_by_attribute_id(id)` 哪个更快？

> ID：13614778
> 
> 赞同：0
> 
> 时间：2012-11-28T21:30:02.843
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有一个模型叫`Max`.

这将是找到此记录的更快方法：

假设这`user`是一个已经设置的局部变量。

```
Max.where(:user_id => user.id) 
```

或者

```
Max.find_by_user_id(user.id) 
```

假设这个查询会经常运行，并且表`user_id`上的列有一个索引`Maxes`。

采取一种或另一种方式有什么好处吗？即一个产生较少的查询但运行速度较慢，反之亦然？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-28T21:35:20.740

该`.where`方法的主要优点是**返回一个 ActiveRecord::Relation**（就像一个数组，如果没有记录与给定条件匹配，**则可以为空）。**另一个很大的优点`.where`是您可以将它们**链接**起来，这对范围非常有用！

使用`.find`，它**返回 Object 或引发 ActiveRecord::RecordNotFound**错误。

* * *

因此，假设您没有与您传递的 id 匹配的用户：

```
Max.find(-1) # => Raise ActiveRecord::RecordNotFound: Couldn't find Project with ID=-1

Max.where(id: -1) # => Returns an empty ActiveRecord::Relation, doesn't raise an error 
```

## 更新

我在 IRB 控制台中尝试并比较了以下 2 个（数据库中约 620 条记录）

```
User.find(User.all.map(&:id))
User.where(id: User.all.map(&:id)) 
```

它**产生相同的查询**，并**花费相同的执行时间**。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T21:35:45.293

尽管需要运行少量的 ruby​​ 代码，但它们是相同的。

检查您的开发日志。它们生成*相同的 SQL*。

我更喜欢新的 AREL 形式——它更通用，只在需要时执行，并且可以链接。

# sql - 访问 SQL SumIf 等效项

> ID：13614779
> 
> 赞同：2
> 
> 时间：2012-11-28T21:30:03.247
> 
> 标签：sql, ms-access

我有一个查询，我正在尝试查找某个位置的到达人数并按时间范围分组。前任。0001-0559、0600-1159、1200-1759 和 1800-2359。我的查询 SQL 是这样的...

```
SELECT tbl_2_trip_details_2012.arrival_id,
       Hour([tbl_2_trip_details_2012] ! [arrive_ts])    AS [B-Hour],
       Weekday([tbl_2_trip_details_2012] ! [arrive_ts]) AS [A-WeekDay#],
       Month(tbl_2_trip_details_2012 ! arrive_ts)       AS [Month],
       Count(tbl_2_trip_details_2012.trip_id)           AS CountOfTrip_ID

FROM   tbl_2_trip_details_2012

WHERE  (( ( tbl_2_trip_details_2012.arrival_id ) = 84252114 ))

GROUP  BY tbl_2_trip_details_2012.arrival_id,
          Hour([tbl_2_trip_details_2012] ! [arrive_ts]),
          Weekday([tbl_2_trip_details_2012] ! [arrive_ts]),
          Month(tbl_2_trip_details_2012 ! arrive_ts)

HAVING (( ( Month([tbl_2_trip_details_2012] ! [arrive_ts]) ) = 7 ))

ORDER  BY Weekday([tbl_2_trip_details_2012] ! [arrive_ts]),
          Hour(tbl_2_trip_details_2012 ! arrive_ts); 
```

这种格式的查询会提取我需要的所有信息。我无法按星期几对时间范围求和。我一直在尝试在 Criteria 字段中使用 "> 或 <" 计算 CountOfTrip_ID 的总和。我已经用尽了堆栈上的文件和访问帮助功能。有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T22:12:59.377

要将您的小时数分组为 6 小时范围，只需将小时数的整数乘以 6，然后再将结果乘以 6。所以它看起来像这样：

```
int(Hour([tbl_2_trip_details_2012] ! [arrive_ts]) / 6) * 6   AS [Hour-range] 
```

然后，您将获得可以分组的值 0、6、12 和 18（每个组的开始）。

# ipython - 以编程方式将单元格添加到 ipython 笔记本以生成报告

> ID：13614783
> 
> 赞同：27
> 
> 时间：2012-11-28T21:30:23.127
> 
> 标签：ipython, ipython-notebook, reproducible-research

我看过一些 iPython 开发人员关于如何将 ipython 笔记本转换 [为博客文章、pdf](http://blog.fperez.org/2012/09/blogging-with-ipython-notebook.html)甚至[整本书](https://www.youtube.com/watch?feature=player_embedded&v=F4rFuIb1Ie4)的演讲（大约 43 分钟）。[PDF-to-X 转换器](https://github.com/ipython/nbconvert)会解释用 markdown 或代码编写的iPython 单元格，并在一个步骤中输出一个新格式化的文档。

我的问题是我想生成一个大型文档，其中许多图形和部分都是以编程方式生成的 - 类似[这样](http://learnr.wordpress.com/2009/09/09/brew-creating-repetitive-reports/)。为了使用上述方法在 iPython 中工作，我需要能够编写一个函数来编写其他 iPython-Code-Blocks。这种能力存在吗？

```
#some pseudocode to give an idea
for variable in list:
    image = make_image(variable)
    write_iPython_Markdown_Cell(variable)
    write_iPython_Image_cell(image) 
```

我认为这可能有用，所以我想知道是否：

1.  通过 iPython 生成 iPython 单元是可能的
2.  如果有理由认为这是一个坏主意，我应该坚持使用模板库（Jinja）等“经典”解决方案。

谢谢，扎克cp

编辑：根据 Thomas 的建议，我在[ipython 邮件列表](http://python.6.n6.nabble.com/IPython-User-using-iPython-as-a-way-to-generate-repetitive-reports-td4998047.html)上发布了一些关于这个想法可行性的反馈。简而言之 - 有一些技术上的困难使这个想法对于最初的想法不太理想。对于想要生成 markdown 单元和相应图像/表格的重复报告，通过 ipython 内核/浏览器工作比直接使用 Jinja 等模板系统生成报告要复杂得多。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2014-05-19T04:14:07.017

[Fernando Perez这里](http://nbviewer.ipython.org/gist/fperez/9716279)有一个 Notebook gist ，演示了如何以编程方式创建新单元格。请注意，您还可以传入元数据，因此如果您正在生成报告并希望将笔记本变成幻灯片，您可以轻松地指示单元格是否应该是幻灯片、子幻灯片、片段等。

您可以添加任何类型的单元格，因此您现在想要的很简单（尽管可能不是在提出问题时！）。例如，这样的东西（未经测试的代码）应该可以工作：

```
from IPython.nbformat import current as nbf

nb = nbf.new_notebook()

cells = []

for var in my_list:
    # Assume make_image() saves an image to file and returns the filename
    image_file = make_image(var)
    text = "Variable: %s\n![image](%s)" % (var, image_file)
    cell = nbf.new_text_cell('markdown', text)
    cells.append(cell)

nb['worksheets'].append(nbf.new_worksheet(cells=cells))

with open('my_notebook.ipynb', 'w') as f:
        nbf.write(nb, f, 'ipynb') 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-11-29T17:39:24.547

我不会判断这是否是一个好主意，但是如果您`get_ipython().set_next_input(s)`在笔记本中调用，它将创建一个带有字符串的新单元格`s`。这就是 IPython 内部用于其`%load`和`%recall`命令的内容。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-11-05T19:40:32.477

请注意，Tal 接受的答案有点被弃用并且越来越被弃用：在 ipython v3 中，您可以（/应该）`nbformat`直接导入，之后您需要指定要创建的笔记本版本。

所以，

`from IPython.nbformat import current as nbf`

变成

`from nbformat import current as nbf`

变成

`from nbformat import v4 as nbf`

*然而*，在这个最终版本中，兼容性中断了，因为该`write`方法位于父模块`nbformat`中，而 Fernando Perez 使用的所有其他方法都在该`v4`模块中，尽管其中一些名称不同（例如`new_text_cell('markdown', source)`become `new_markdown_cell(source)`）。

[这](https://github.com/clbarnes/plotstyles)是 v3 处理方式的示例：查看`generate_examples.py`代码和`plotstyles.ipynb`输出。在撰写本文时，IPython 4 非常新，以至于使用 Web 界面并单击“新笔记本”仍会生成 v3 笔记本。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-03-30T09:03:23.437

下面是函数的代码，它将加载文件的内容并将其插入笔记本的下一个单元格：

```
from IPython.display import display_javascript

def make_cell(s):
   text = s.replace('\n','\\n').replace("\"", "\\\"").replace("'", "\\'")
   text2 = """var t_cell = IPython.notebook.get_selected_cell()
   t_cell.set_text('{}');
   var t_index = IPython.notebook.get_cells().indexOf(t_cell);
   IPython.notebook.to_code(t_index);
   IPython.notebook.get_cell(t_index).render();""".format(text)
   display_javascript(text2, raw=True)

def insert_file(filename):
   with open(filename, 'r') as content_file:
       content = content_file.read()
   make_cell(content) 
```

[在我的博客中](http://ihorbobak.com/index.php/2018/03/30/programmatically-create-jupyter-notebook-cells/)查看详细信息。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-09-12T11:43:19.100

使用魔法可能是另一种解决方案。例如

`get_ipython().run_cell_magic(u'HTML', u'', u'<font color=red>heffffo</font>')`

现在您可以在单元格中以编程方式生成 HTML，您可以根据需要以任何方式进行格式化。当然支持图像。如果您想重复生成多个单元格的输出，只需将字符串作为占位符执行上述多个操作。

ps 我曾经有过这种需求并到达了这个线程。当时我想渲染一个表（不是列表和元组的 ascii 输出）。后来我发现`pandas.DataFrame`它非常适合我的工作。它会自动生成 HTML 格式的表格。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-10-28T08:53:13.240

```
from IPython.display import display, Javascript

def add_cell(text,  type='code', direct='above'):
    text = text.replace('\n','\\n').replace("\"", "\\\"").replace("'", "\\'")
    display(Javascript('''
        var cell = IPython.notebook.insert_cell_{}("{}")
        cell.set_text("{}")
        '''.format(direct, type, text)));

for i in range(3):
    add_cell(f'# heading{i}', 'markdown')
    add_cell(f'code {i}') 
```

上面的代码会添加如下单元格： [![在此处输入图像描述](../Images/66283503776df35b5871a8195434f3db.png)](https://i.stack.imgur.com/0uX3a.png)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-04-15T20:53:35.227

使用命令行转到 myfile.py 文件所在的目录并执行（示例）：C:\MyDir\pip install p2j

然后执行：C:\MyDir\p2j myfile.py -t myfile.ipynb

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-04-15T20:49:34.363

在 Jupyter 笔记本中运行：

```
!pip install p2j 
```

然后，使用命令行，进入文件所在的对应目录，执行：

```
python p2j <myfile.py> -t <myfile.ipynb> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-11-22T08:53:17.073

@xingpei Pang 解决方案非常完美，特别是如果您想为每个具有多个组的数据集创建自定义代码。但是，javascript 代码的主要问题是，如果您在**受信任**的笔记本中运行此代码，它会在每次加载笔记本时运行。

我想出的解决方案是在执行后清除单元格输出。javascript 代码存储在输出单元格中，因此通过清除输出，代码就消失了，并且没有任何内容可以再次在受信任模式下执行。通过使用[此处](https://stackoverflow.com/questions/24816237/ipython-notebook-clear-cell-output-in-code)的代码，解决方案是下面的代码。

```
from IPython.display import display, Javascript, clear_output

def add_cell(text,  type='code', direct='above'):
    text = text.replace('\n','\\n').replace("\"", "\\\"").replace("'", "\\'")
    display(Javascript('''
        var cell = IPython.notebook.insert_cell_{}("{}")
        cell.set_text("{}")
        '''.format(direct, type, text)));

# create cells
for i in range(3):
    add_cell(f'# heading{i}', 'markdown')
    add_cell(f'code {i}')

# clean the javascript code from the current cell output
for i in range(10):
    clear_output(wait=True) 
```

请注意，`clear_output()`需要多次运行以确保清除输出。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-06-17T19:25:48.873

作为包含[Tal 上述答案](https://stackoverflow.com/a/23729611/199166)的轻微更新，[来自 Chris Barnes的更新和对](https://stackoverflow.com/a/33553360/199166)[nbformat 文档](https://nbformat.readthedocs.io/en/latest/api.html)的一点挖掘，以下内容对我有用：

```
import nbformat
from nbformat import v4 as nbf

nb = nbf.new_notebook()

cells = [
    nbf.new_code_cell(f"""print("Doing the thing: {i}")""")
    for i in range(10)
]

nb.cells.extend(cells)

with open('generated_notebook.ipynb', 'w') as f:
    nbformat.write(nb, f) 
```

然后，您可以启动新的人工笔记本并在任何需要的地方剪切和粘贴单元格。

这不太可能是做任何事情的最佳方式，但它作为一个肮脏的黑客很有用。‍</p>

这适用于以下版本：

```
Package              Version
-------------------- ----------
ipykernel            5.3.0
ipython              7.15.0
jupyter              1.0.0
jupyter-client       6.1.3
jupyter-console      6.1.0
jupyter-core         4.6.3
nbconvert            5.6.1
nbformat             5.0.7
notebook             6.0.3
... 
```

# linux - mac OS X 和 linux 之间的 rsync 所有权

> ID：13614791
> 
> 赞同：0
> 
> 时间：2012-11-28T21:31:06.870
> 
> 标签：linux, macos, rsync, ownership

我想使用 rsync 将我的 OS X 机器上的本地 Web 应用程序上传到 linux 服务器。

我使用这个命令：

```
sudo rsync -Harov --delete -e "ssh -p 33224" "/Users/me/myapp/" "linuxuser@12.34.56.78:/home/linuxuser/test-rsync-app" 
```

问题是我的本地应用程序有一些属于 _www 的文件夹（在 Mac OS X 上），当上传时，它们都属于 linuxuser，所以我失去了 apache 用户对这些文件夹的所有权。

理想情况下，我会使用 rsync 并且 Mac 上属于 _www 的文件将属于 linux 服务器上的 www-data。

有没有办法做到这一点 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T22:35:58.767

如果您在 Linux 服务器上没有 root 权限，那么不，您不能将用户（和组）设置为 www-data。

如果您确实具有root权限，那么这个问题应该对您有所帮助：

[rsync over SSH 仅保留 www-data 拥有的文件的所有权](https://stackoverflow.com/questions/9586798/rsync-over-ssh-preserve-ownership-only-for-www-data-owned-files)

# javascript - 来自毫秒和时区的 Javascript 日期

> ID：13614792
> 
> 赞同：12
> 
> 时间：2012-11-28T21:31:06.560
> 
> 标签：javascript, jquery, json, datetime

> **可能重复：**
> [如何格式化 JSON 日期？](https://stackoverflow.com/questions/206384/how-to-format-a-json-date)
> [从网络服务解析日期](https://stackoverflow.com/questions/11024367/parsing-date-from-webservice)

对不起，如果这个问题已经被问过。我环顾四周，但一直找不到。是否有一种快速便捷的方法可以仅使用and （不包括其他库）将“ *json* ”日期转换为人类友好的格式？`javascript``jQuery``jQuery`

日期格式如下：

```
creationDate: "/Date(1346713200000+0100)/" 
```

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-28T22:09:44.717

```
> var maybeDateString = "/Date(1346713200000+0100)/";
> fromDateString(maybeDateString)
Tue Sep 04 2012 02:00:00 GMT+0200

function fromDateString(str) {
    var res = str.match(/\/Date\((\d+)(?:([+-])(\d\d)(\d\d))?\)\//);
    if (res == null)
        return new Date(NaN); // or something that indicates it was not a DateString
    var time = parseInt(res[1], 10);
    if (res[2] && res[3] && res[4]) {
        var dir = res[2] == "+" ? -1 : 1,
            h = parseInt(res[3], 10),
            m = parseInt(res[4], 10);
        time += dir * (h*60+m) * 60000;
    }
    return new Date(time);
} 
```

# c - 将 microSD 与 LPC1769 板连接

> ID：13614794
> 
> 赞同：0
> 
> 时间：2012-11-28T21:31:23.440
> 
> 标签：c, interface, spi

因此，我们尝试使用板载 SPI 协议将 LPC1769 微控制器板上的数据字节（来自 A/D 转换器）存储到 SanDisk 1Gb microSD 卡中。我知道所有这些东西是如何工作的，但我不知道如何开始使用 microSD 卡——我已经看到了对 CMD0 的各种引用，但我不知道在哪里可以找到这个库或如何正确将其合并到板的 C 编译器中。

我所需要的只是弄清楚如何正确启动连接，然后如何在指定的块处将数据读写到卡中。 `void write(int data, int block) int read(int block)`<< 如果有一种方法可以简单地使用预定义的 microSD 函数库来做到这一点，那就太棒了

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T22:56:35.353

FatFS 是一个简单的 FAT 文件系统，它已被移植到许多微控制器（也许它已经可供您使用），它还提供对 SD 卡的低级写入（您可以将其用作您工作的参考。它可以让您编写将实际文件保存到 SD 卡中，然后您可以将其放在计算机上并读取/写入。这最终工作得非常好。

```
http://bikealive.nl/fatfs.html 
```

TI 还提供了一个不错的应用说明，其中包含一些基本 API 来执行此操作：

```
http://www.ti.com/general/docs/lit/getliterature.tsp?literatureNumber=slaa281b&fileType=pdf 
```

虽然它是针对 MSP430 的，但它可以清楚地向您展示您自己写入字节所需的寄存器访问类型，并且您可以实现等效的东西。

最后，Olimex 的开发板具有类似的微控制器和 SD 卡，您可以看到它们的作用：

```
https://www.olimex.com/Products/ARM/NXP/LPC1766-STK/ 
```

我找到了更多专门针对您的微控制器的信息（尽管上面的建议也很有效）：

来自恩智浦的两份应用说明，关于做你要求的事情：

```
AN10916 - "FAT library EFSL and FatFs port on NXP LPC1700"
AN11070 - "Accessing SDC/MMC card using SPI/SSP on LPC1700". 
```

有了这个，你应该准备好了。

# php - 将 Unicode 字符转换为“\uxxxx”形式

> ID：13614796
> 
> 赞同：4
> 
> 时间：2012-11-28T21:31:32.330
> 
> 标签：php, unicode

我正在尝试将字符（例如 À）转换为转义形式，例如`\u00c0`. 我知道这可以用 来完成`json_encode`，但是该函数会为特殊字符添加反斜杠。（我实际上并不希望得到一个 json 对象，只是字符串转换）：

`$str = 'À ß \ Ć " Ď < Ĕ';`

对于上面的字符串，它将返回

`$str = '\u00c0 \u00df \\ \u0106 \" \u010e < \u0114';`

如果是我`stripslashes`，它也会在每个之前剥离一个`uxxxx`。

这种特定转换是否有功能？或者最简单的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-11-25T00:45:28.273

您可以使用以下代码来回前进

## **代码**：

```
if (!function_exists('codepoint_encode')) {
    function codepoint_encode($str) {
        return substr(json_encode($str), 1, -1);
    }
}

if (!function_exists('codepoint_decode')) {
    function codepoint_decode($str) {
        return json_decode(sprintf('"%s"', $str));
    }
} 
```

## **如何使用**：

```
echo "\nUse JSON encoding / decoding\n";
var_dump(codepoint_encode("我好"));
var_dump(codepoint_decode('\u6211\u597d')); 
```

## **输出**：

```
Use JSON encoding / decoding
string(12) "\u6211\u597d"
string(6) "我好" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T21:39:00.660

```
$str = 'À ß \ Ć " Ď < Ĕ';

echo trim(preg_replace('/\\\\([^u])/', "$1", json_encode($str)), '"');
// ouptuts: \u00c0 \u00df \ \u0106 " \u010e < \u0114 
```

I know it uses json_encode(), but it's the easiest way to convert to \uXXXX

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T21:54:25.457

对@cryptic 的回答稍作修改：

**脚本**

```
$str = 'À ß \ Ć " Ď < Ĕ \\\\uxxx';
echo trim(preg_replace('/\\\\([^u])/', "$1", json_encode($string, JSON_UNESCAPED_SLASHES)), '"'); 
```

**输出**

```
\u00c0 \u00df \ \u0106 " \u010e < \u0114 \\uxxx 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-23T12:34:21.370

```
function convertChars($str) {
    return json_decode("\"$str\"");
} 
```

# postgresql - 带有索引标记的行的postgresql副本

> ID：13614798
> 
> 赞同：1
> 
> 时间：2012-11-28T21:31:37.463
> 
> 标签：postgresql, tags, row

有没有办法让 sql 查询返回拆分行。我什至不知道该怎么问。下面有“index_tag”。

```
select event.name, tb_ev.start_time, tb_ev.end_time
from block as tb_ev,event
where location_id in ( 28522 ) 
and tb_ev.event_id=event.id;

name           | start_time | end_time 
---------------+------------+---------- 
 Register #1   | 06:00:00   | 09:00:00
 Register #2   | 11:00:00   | 12:00:00
 Register #3   | 11:00:00   | 14:00:00 
```

从 3 行到 7 行

```
 name          | start_time | end_time | index_tag
---------------+------------+-------------------- 
 Register #1   | 06:00:00   | 09:00:00 | 06:00:00
 Register #1   | 06:00:00   | 09:00:00 | 07:00:00
 Register #1   | 06:00:00   | 09:00:00 | 08:00:00
 Register #2   | 11:00:00   | 12:00:00 | 11:00:00
 Register #3   | 11:00:00   | 14:00:00 | 11:00:00
 Register #3   | 11:00:00   | 14:00:00 | 12:00:00
 Register #3   | 11:00:00   | 14:00:00 | 13:00:00 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:54:31.277

尝试这个：

```
SELECT *, start_time +
          generate_series(0,extract(hour from (end_time - start_time))::int -1)
          * interval '1 hour' as index_tag
FROM block 
```

它有点难看，但它可以工作（`generate_series`不适用于`time`. 只有`int`or `timestamp`）。

这是[SQLFiddle](http://sqlfiddle.com/#!12/48ae9/1)

关于的详细信息[`generate_series`](http://www.postgresql.org/docs/current/static/functions-srf.html)

# racket - 使用 Racket scribble/lp 进行文学编程的示例

> ID：13614801
> 
> 赞同：6
> 
> 时间：2012-11-28T21:31:42.817
> 
> 标签：racket, literate-programming, scribble

除了学习球拍，我还在尝试学习文学编程。不幸的是，关于 scribble/lp，至少可以说 Racket 文档很少。有人可以指出我关于这个主题的一些更好的资源或用 Racket 编写的识字程序示例吗？

非常感谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-28T21:59:05.653

这是 Racket 中的一个小型益智游戏，使用`scribble/lp`库：[https ://github.com/racket/games/blob/master/chat-noir/chat-noir-literate.rkt](https://github.com/racket/games/blob/master/chat-noir/chat-noir-literate.rkt)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-12-18T21:57:37.500

这是另一个较短且不言自明的示例：

[项目存储库 Github。](https://github.com/brudgers/LiterateProgrammingExample)

[使用编织输出的项目页面。](http://brudgers.github.io/LiterateProgrammingExample/)

它是为了弥补 Racket 文档中的一些空白而编写的。

# javascript - Jquery Ajax 请求调用了两次，第一个请求未在标头中发送令牌

> ID：13614802
> 
> 赞同：3
> 
> 时间：2012-11-28T21:31:51.193
> 
> 标签：javascript, jquery, ajax

我正在使用 ajax 调用基于 WCF REST 的服务。

在页面加载之前调用 ajax 方法。我希望在 ajax 请求的标头中发送一个“令牌”。在提琴手这就是我所看到的：

1.) 对服务的请求，但标头中没有令牌。（AJAX 调用失败） 2.) 对同一服务的请求，但标头中有令牌。（AJAX 调用通过）

之后，一切都在 chrome 和 safari 上运行良好。但是在 IE 10 和 Mozilla 上只有一个服务调用。结果，服务调用在 IE 10 和 Mozilla 中失败，因为请求的标头中没有令牌。

这是我调用的方法：

```
function callservice (method, serviceUrl, params, successHandler, errorHandler) {
    $.ajax({
        crossDomain: true,
        type: method,
        url: serviceUrl,
        beforeSend: function (XMLHttpRequest) { XMLHttpRequest.setRequestHeader("Authorization", Token); },
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: successHandler,
        error: errorHandler
    });
    function photos(data) {
        alert(data);
        console.log(data);
    };
} 
```

我控制 Web 服务和应用程序（调用此 Web 服务）。当应用程序和 Web 服务都托管在本地主机上时，不会出现此问题。在这种情况下，只有一个成功的服务调用。但是在有跨域调用的时候有两个AJAX调用。

我的问题是为什么 AJAX 请求没有在第一次尝试时发送令牌？为什么令牌只在第二个 AJAX 调用中发送？

任何形式的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-28T15:09:47.827

问题出在CORS。以前，浏览器不允许向与客户端不同的域发出ajax请求，因为它被认为是安全威胁。现代浏览器可以发出跨域ajax请求，只要服务器与客户端合作。所以当有来自浏览器的跨域请求时，实际上会发生这种情况：

1.）首先，浏览器向服务发送“预检”请求，以从 WCF 服务收集授权信息（在我的情况下，这是一个标头方法为“OPTIONS”的请求）。作为回报，Web 服务发送访问控制允许来源作为其响应标头的一部分。由于此请求而在提琴手上显示的错误是 HTTP 500 错误。此 AJAX 请求在数据字段中没有任何内容，因为它只是一种查找 WCF 服务授权详细信息的方法。

2.) Chrome 和 Safari 然后向 Web 服务发出第二个请求，因为它们拥有服务的授权详细信息。而 Firefox 和 IE 不喜欢向该服务发出第二个 ajax 请求，因为存在 HTTP 500 错误飞行前的请求。因此，Chrome 和 Safari 都能够与该服务进行通信。

因此，解决方案是修改来自 WCF 服务的响应，以防出现“预检请求”。我修改了服务发送的响应，以防出现“预检请求”以发送 HTTP 200 OK 响应。这允许 IE 和 Mozilla 等浏览器在预检请求之后发送实际请求。

这是我提到的来源之一： [http ://www.bennadel.com/blog/2327-Cross-Origin-Resource-Sharing-CORS-AJAX-Requests-Between-jQuery-And-Node-js.htm](http://www.bennadel.com/blog/2327-Cross-Origin-Resource-Sharing-CORS-AJAX-Requests-Between-jQuery-And-Node-js.htm)

希望这可以帮助面临同样问题的人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T21:51:25.450

跨域调用属于同源策略。默认情况下您无法拨打电话。您需要使用[CORS](https://developer.mozilla.org/en-US/docs/HTTP_access_control)或 JSONP 或代理。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-28T21:42:01.220

XMLHttpRequest：除非他们更改它，否则使用 MS Explorer，您将需要使用 ActiveXObject("Microsoft.XMLHTTP")。对于我用纯 JS 进行的 ajax 调用，我使用这一行根据浏览器创建对象：

```
if (window.XMLHttpRequest){
   //for most BRowsers
   r = new XMLHttpRequest(); 
} else{ 
   //for Explorer
   r = new ActiveXObject("Microsoft.XMLHTTP");
} 
```

然后在我的例子中将你的 beforesend 应用到这里创建的对象（r​​）。我真的相信这是你的EI问题。但未测试。

# javascript - 如何检查 HTML5 音频是否达到不同的错误

> ID：13614803
> 
> 赞同：24
> 
> 时间：2012-11-28T21:32:06.523
> 
> 标签：javascript, html, audio

具体来说，如果 206 个音频请求中的一个失败并且缓冲停止，有没有办法检测到该状态？或者我是否应该通过将缓冲量与过去的量进行比较来检查缓冲是否停止？

另外，我如何检查指定的来源是否失败，然后您可以将其指向另一个来源吗？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-01-23T21:07:17.537

**1\. 具体来说，如果其中一个音频请求失败并且缓冲停止，有没有办法检测到该状态？**

是的，有几种方法可以做到这一点！但是，如果您想捕获错误类型，可以将错误事件侦听器附加到源：

```
$('audio').addEventListener('error', function failed(e) {
   // audio playback failed - show a message saying why
   // to get the source of the audio element use $(this).src
   switch (e.target.error.code) {
     case e.target.error.MEDIA_ERR_ABORTED:
       alert('You aborted the video playback.');
       break;
     case e.target.error.MEDIA_ERR_NETWORK:
       alert('A network error caused the audio download to fail.');
       break;
     case e.target.error.MEDIA_ERR_DECODE:
       alert('The audio playback was aborted due to a corruption problem or because the video used features your browser did not support.');
       break;
     case e.target.error.MEDIA_ERR_SRC_NOT_SUPPORTED:
       alert('The video audio not be loaded, either because the server or network failed or because the format is not supported.');
       break;
     default:
       alert('An unknown error occurred.');
       break;
   }
 }, true); 
```

**2\. 你能把它指向另一个来源吗？**

在错误处理函数中，您可以使用`src`音频元素的属性更改源：

```
var audio = $(this);
audio.src = "new-audio-file.mp3";
audio.load(); 
```

另一种选择是使用以下语法将多个源添加到同一个音频标签：

```
<audio>
    <source id="audio_player_ogv" src="test.ogv" type="audio/ogg" />
    //In case that you can't load the ogv file it will try to load test.mp3
    <source id="audio_player_mp3" src="test.mp3" type="audio/mpeg" />
</audio> 
```

**3.关于管理多个音频文件**

如果您正在考虑管理 206 个音频文件，我建议您使用插件。我一直在使用[SoundManager2](http://www.schillmania.com/projects/soundmanager2/)，它非常好！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-23T17:46:02.613

规范中有媒体元素处理的事件的完整列表：[https ://html.spec.whatwg.org/multipage/embedded-content.html#media-elements](https://html.spec.whatwg.org/multipage/embedded-content.html#media-elements)

我会特别关注停滞、中止、进展事件。

由于此元素相对较新，因此实现可能会有很大差异。因此，我将针对您所针对的平台测试这些事件，以查看它们是否按预期工作以满足您的需求。如果不是，您可能需要做一些更手动的事情，例如轮询您提到的缓冲状态。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-11-28T21:55:57.800

我想你可以在页面末尾的[w3schools](http://www.w3schools.com/tags/ref_eventattributes.asp)找到你的答案（媒体事件块）

可能`onerror`或`onstalled`或`onreadystatechange`

# html - 如何对齐中间的几个按钮？

> ID：13614806
> 
> 赞同：0
> 
> 时间：2012-11-28T21:32:29.587
> 
> 标签：html, css, button, alignment

```
<div class="button">

<p>
 <style>
a.button1 {
float: left;
height: 398px;
margin: 59px 0px 0px 17px;
background-image: url("i/about-button.gif");
text-indent: -9999px;
display: inline-block;
}

a#about-button {
width: 340px;
background-position: 0px 0px;}

a#about-button:hover {
background-position: 0px -796px;}

a#about-button:active {
background-position: 0px -398px;}</style>
<body>
<a href="about.html" class="button1" id="about-button" image></a>
</body>
</p>
</div> 
```

好吧，我是这方面的菜鸟，所以请耐心等待。我正在尝试将导航按钮对齐在中心。也就是说，无论您的窗口有多宽，它们大部分都将停留在中间。现在，它们都向左对齐。

我有 a.button1、a.button2、a.button3 和 a.button4。它们彼此完美对齐；我只需要弄清楚如何让它们都移动到中心。抱歉，但我无法在其他主题中找到对我的代码有帮助的答案。帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:39:27.240

You can align several things together in the middle by using something like this

In the Head:

```
<style>
.button {
    text-align:centre;
}
.button > * {
    display:inline-block;
}
</style> 
```

And at the point you want to centre the things:

```
<div class="button">
    <a href="about.html" class="button1" id="about-button"></a>
    <a href="contact.html" class="button2" id="contact-button"></a>
</div> 
```

And that will place those two links centre aligned together within the div `button`. All direct child elements of that div will be centred too.

By the way, your html should look like:

```
<html>
<head>
<style>
a.button1 {
float: left;
height: 398px;
margin: 59px 0px 0px 17px;
background-image: url("i/about-button.gif");
text-indent: -9999px;
display: inline-block;
}

a#about-button {
width: 340px;
background-position: 0px 0px;}

a#about-button:hover {
background-position: 0px -796px;}

a#about-button:active {
background-position: 0px -398px;}
</style>
</head>
<body>
<div class="button">
<p>
<a href="about.html" class="button1" id="about-button" image></a>
</p>
</div>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T21:42:04.357

为了做到这一点，您需要了解几件事：

1.  您不能将按钮向左浮动，并期望它保持居中。
2.  你不需要`<div><p><a>`- 额外的标记只会让事情变得复杂。
3.  为了使窗口中的某些内容居中，请在`text-align: center`上设置`body`，或者设置一个全角元素（例如下面的 div）。

你的风格，调整：

```
div.button {
    text-align: center;
}

a.button1 {
    height: 398px;
    margin: 59px auto 0px auto;
    background-image: url("i/about-button.gif");
    text-indent: -9999px;
    display: inline-block;
}

a#about-button {
    width: 340px;
    background-position: 0px 0px;
}

a#about-button:hover {
    background-position: 0px -796px;
}

a#about-button:active {
    background-position: 0px -398px;
} 
```

您的 HTML 应该只需要像这样：

```
<div class="button">
        <a href="about.html" class="button1" id="about-button" image></a>
</div> 
```

**编辑：** 既然你提到了你的导航*按钮*，我想我会告诉你什么也适用于多个链接：

首先，这就是 HTML 所需的全部内容：

```
<div class="button">
        <a href="about.html" class="button1" id="about-button"></a>
        <a href="about.html" class="button1" id="about-button"></a>
        <a href="about.html" class="button1" id="about-button"></a>
</div> 
```

你需要为你的按钮稍微修改你的css，因为它非常宽和高。

# flash - Action Script 3.0 Vector 在函数退出后不存储变量

> ID：13614818
> 
> 赞同：1
> 
> 时间：2012-11-28T21:33:47.480
> 
> 标签：flash, actionscript, vector, scope

我是 Action Script 的新手，我以前使用过 OOP 语言，但我遇到了一个问题，我必须为图书馆构建一个小册子应用程序，他们以 XML 格式向我提供了他们书籍的数据。我建立了两个类：书籍和图书馆。

**书本：**

```
package
{
    import flash.display.Sprite;
    import flash.net.URLLoader;
    import flash.net.URLRequest;    
    import flash.display.Loader;
    import flash.events.Event;
    import flash.display.Sprite
    public class Book extends Sprite
    {
        public var _author_name:String;
        public var _book_title:String;
        public var _book_subject:String;
        public var _book_edition:String;
        public var _ISBN: String;
        public var _publication_year:String;
        public var _price:String;
        public var _in_stock:String;
        public var _book_cover:String;
        public function Book()
        {
        }
        public function  getAuthorName():String
        {
            return _author_name;
        }
        public function  getBookTitle():String
        {
            return _book_title;
        }
        public function  getBookSubject():String
        {
            return _book_subject;
        }
        public function  getBookEdition():String
        {
            return _book_edition;
        }
        public function  getISBN():String 
        {
            return _ISBN;
        }
        public function  getPublicationYear():String
        {
            return _publication_year;
        }
        public function  getPrice():String
        {
            return _price;
        }
        public function  getAvailability():String
        {
            return _in_stock;
        }
        public function getBookCover():String
        {
            return _book_cover;
        }
        public function setBookCover(temp:String):void
        {
            _book_cover = temp;
        }
        public function  setAvailability(temp:String):void
        {
            _in_stock = temp;
        }
        public function  setPrice(temp:String):void
        {
            _price = temp;
        }
        public function  setPublicationYear(temp:String):void
        {
            _publication_year = temp;
        }
        public function setISBN(temp:String):void
        {
            _ISBN = temp;
        }
        public function setBookEdition(temp:String):void
        {
            _book_edition = temp;
        }
        public function setBookSubject(temp:String):void
        {
            _book_subject = temp;
        }
        public function setBookTitle(temp:String):void
        {
            _book_title = temp;
        }
        public function setAuthorName(temp:String):void
        {
            _author_name = temp;
        }
        public override function toString():String
        {
            var book_desc:String;
            book_desc = "Author Name: " + _author_name + "\n";
            book_desc = book_desc + "Title: " + _book_title + "\n";
            book_desc = book_desc + "Subject: " +_book_subject + "\n";
            book_desc = book_desc + "Edition : " +_book_edition + "\n";
            book_desc = book_desc + "ISBN: " +_ISBN + "\n";
            book_desc = book_desc + "Publication Year: " + _publication_year + "\n";
            book_desc = book_desc + "Price: " + _price + "\n";
            book_desc = book_desc + "Available: " +_in_stock + "\n";
            book_desc = book_desc + "Book Cover URL : " +_book_cover + "\n";  
            return book_desc;
        }
        public function equals(temp:Book):Boolean
        {
            if(_ISBN == temp.getISBN())
                return true;
            else 
                return false;
        }

    }
} 
```

**图书馆.as**

```
package
{
    import flash.net.URLLoader;
    import flash.net.URLRequest;    
    import flash.display.Loader;
    import flash.events.Event;
    import flash.display.Sprite;
    import flash.display.Sprite

    public class Library extends Sprite
    {
        public var xml:XML;
        public var url_loader:URLLoader;
        public var _book_vector:Vector.<Book>
        public var _xml_path:String;
        public function Library(xml_path:String)
        {
            _xml_path = xml_path;
            _book_vector = new Vector.<Book>(20);
        }
        public function getXMLPath():String
        {
            return _xml_path;
        }
        public function setXMLPath(temp:String):void
        {
            _xml_path = temp;
        }
        public function LoadXML():void
        {
            url_loader = new URLLoader(new URLRequest(_xml_path));
            url_loader.addEventListener(Event.COMPLETE,ParseXML);
        }
        public function ParseXML(temp:Event):void
        {
            xml = new XML(temp.target.data);
            LoadBooks();
        }
        public function LoadBooks():void
        {
            for(var i :int=0;i<xml.children().length();i++ )
            {
                _book_vector[i] = new Book();
                _book_vector[i]._author_name = xml.children()[i].AuthorName;
                _book_vector[i]._book_title =  xml.children()[i].BookTitle;
                _book_vector[i]._book_subject = xml.children()[i].Subject;
                _book_vector[i]._book_edition = xml.children()[i].Edition;
                _book_vector[i]._price = xml.children()[i].Price;
                _book_vector[i]._publication_year = xml.children()[i].Year;
                _book_vector[i]._in_stock = xml.children()[i].Availabilty;
                _book_vector[i]._book_cover = xml.children()[i].ImagePath;
                _book_vector[i]._ISBN = xml.children()[i].@ISBN;
            }
        }
        public function printLibrary():void
        {
            for(var i:int=0;i<this._book_vector.length;i++)
            {
                trace(_book_vector[i].toString());
            }
        }
    }
} 
```

XML 加载正常，但是当我尝试调用 printLibrary() 时，它会出现：错误 #1009：无法访问空对象引用的属性或方法。

当我使用调试器时，我可以看到 _book_vector 正在加载“书籍”并使用 XML 读取的数据归档，但是当 LoadBooks 退出时，向量不再保留它们，为什么？_book_vector 不是函数本地的！我做错了什么？有什么我没有得到正确的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T22:02:34.420

try

```
new Vector.<Book>(20); 
```

instead of

```
new Vector().<Book>(20); 
```

Using `new Vector()...` gives me this error:

```
[Fault] exception, information=TypeError: Error #1007: Instantiation attempted on a non-constructor. 
```

But that's perhaps because my error handler is a little more strict.

# iphone - 将 xcode 集成到 mopub

> ID：13614828
> 
> 赞同：0
> 
> 时间：2012-11-28T21:34:23.377
> 
> 标签：iphone, objective-c, ios, xcode

我在尝试将 mopub 集成到 iOS 时不断收到错误消息。它不断给我服务器响应，表明没有广告可用。

```
 MPAdView *adView = [[MPAdView alloc] initWithAdUnitId:@"<xxxxxxxxxxxxxxxxxxxxxx>"   size:MOPUB_BANNER_SIZE];
adView.delegate = self;

CGRect frame = adView.frame;
CGSize size = [adView adContentViewSize];
frame.origin.y = self.view.bounds.size.height - size.height;
adView.frame = frame;

[adView loadAd];
[self.view addSubview:adView];
[adView release]; 
```

我不确定我做错了什么，有人可以帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-06T14:05:17.750

确保您的广告单元的 Mopub 市场分配为 100%。有时 mopub 的测试模式不能正常工作，或者可能存在连接问题（尤其是在模拟器中）。

您可以使用中介作为替代方案，在市场广告之外使用 admob 或 iAd（假设您实施 mopub full bundle）。如果您启用了 iAds，您可以在真实设备上进行测试，打开开发者模式。您可以在设置中打开真实设备（iphone 或 ipad）上的开发者模式 - 开发者具有 %100 或填充率。

谷歌广告可以设置为从 admob 面板测试广告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T02:16:23.653

尝试按照此处所示实施测试模式：

[https://github.com/mopub/mopub-client/wiki/Testing-Ad-Units](https://github.com/mopub/mopub-client/wiki/Testing-Ad-Units)

只需确保在将应用提交到应用商店时，删除测试标志即可。

# php - 如何插入两个字段？

> ID：13614829
> 
> 赞同：0
> 
> 时间：2012-11-28T21:34:24.923
> 
> 标签：php, mongodb

如何同时插入（如果未添加则更新）两个字段？它适用于单个领域，但不再适用于两个领域。

难道我做错了什么？：

```
$db->url->update(   
      array("url" => $linkurlcache),
      array('$set' => array('url' => $linkurlcache, 'pos' => $rand_num)),
      array("upsert" => true),
      array("multi" => true)
); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T21:55:15.583

我真的很讨厌不得不回答我自己的问题。我会删除它，但我在任何网站上都找不到解决方案。

无论如何，`array("multi" => true)`考虑到我们正在调用更新函数，这很有意义，但这是错误的。

正确的解决方案是没有它！只是：

```
$db->url->update(   
      array("field1" => $field1),
      array('$set' => array('field1' => $field1, 'field2' => $field2)),
      array("upsert" => true)
); 
```

因为`upsert`实际上进行了插入（如果查询不匹配）。

# javascript - Node.js 回调

> ID：13614832
> 
> 赞同：2
> 
> 时间：2012-11-28T21:34:38.013
> 
> 标签：javascript, node.js

我正在学习节点，我似乎无法弄清楚的一件事是回调签名。似乎大多数回调通常采用以下形式

```
function myCallback(err, doc) 
```

这是有道理的。但后来我遇到了一些其他模块，比如 node-easyimage，它随便提到了具有不同签名的示例，比如

```
function myCallback(err, stdout, stderr) 
```

没有提到哪些 API 需要哪种格式的回调，所以我最终深入研究了代码。但是鉴于几乎从未提及回调签名；我觉得有一条潜规则我没读过。有没有？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-28T21:39:01.117

不幸的是，没有标准的方法，所以你只需要习惯每个包使用的技术。这是一个普遍的 Javascript 问题，而不仅仅是 node.js，这就是为什么[TypeScript](http://www.typescriptlang.org/)具有如此吸引力的原因。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T04:13:11.220

虽然确实没有**标准**，但 Node 社区正在慢慢地围绕一个约定合并`callback(error, results)`，其中`results`可能是字符串、数组、对象等，具体取决于 API。

# c++ - 尝试复制数组时从 DLL 调用函数时程序崩溃

> ID：13614833
> 
> 赞同：0
> 
> 时间：2012-11-28T21:34:36.730
> 
> 标签：c++, vb.net, visual-studio-2010

今天我尝试制作我的第一个 DLL 和我的第一个使用 DLL 的应用程序。

DLL 是用 C++ 制作的，这是我正在调用的代码：

```
void Graph::findPath_r(Node* pStart, Node* pEnd, std::vector<cell> &road, cell &costMx)
{
//.....
    if(pEnd->getParent() != NULL)
    {
        while(!path.empty())
        {
            road.push_back(path.top()->getName());
            costMx += path.top()->getGCost();
            path.pop();
        }
        return;
    }
    return;
}
vector <int>tbcway;
int FUNCTION CalculatePath(int Start, int End, int * Array, int &cost)
{
    dgraph->findPath_r(xNode[Start].NodeID ,xNode[End].NodeID,tbcway,cost); 
    dgraph->reset();
    std::copy(tbcway.begin(), tbcway.end(), Array);
    tbcway.clear();
    return 1;
} 
```

这就是我在 VB.net 中声明并调用它的方式：

```
Imports System.Runtime.InteropServices

Public Class Form1

<DllImport("RCP.dll")> _
Public Shared Function LOAD_SYSTEM() As Boolean
End Function

<DllImport("RCP.dll")> _
Public Shared Function GetPluginVersion() As Integer
End Function

<DllImport("RCP.dll")> _
Public Shared Function CalculatePath(ByVal StartNode As Integer, ByVal EndNode As Integer, ByRef Array() As Array, ByRef cost As Integer) As Integer
End Function

Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load
    LOAD_SYSTEM()
    MsgBox(GetPluginVersion().ToString())
    Dim path(4096) As Array
    Dim movecost As Integer
    CalculatePath(1702, 27932, path, movecost)
End Sub
End Class 
```

那么，这段代码有什么问题呢？我得到的错误是：

> 调用 PInvoke 函数 'RCP GUI!RCP_GUI.Form1::CalculatePath' 使堆栈失衡。这可能是因为托管 PInvoke 签名与非托管目标签名不匹配。检查 PInvoke 签名的调用约定和参数是否与目标非托管签名匹配。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T23:18:34.883

这可能是调用约定不匹配。

尝试使用不同的调用约定来装饰您的 DllImport 以查看哪个有效（我的猜测是它应该是 cdecl）。

# c# - 为什么排序字典和列表的添加、删除和获取值比未排序的要慢？

> ID：13614834
> 
> 赞同：2
> 
> 时间：2012-11-28T21:34:39.007
> 
> 标签：c#, testing, dictionary, sortedlist, sorteddictionary

我做了一些测试：SortedDictionary、SortedList 和 Dictionary（只是为了比较）。结果是 Dictionary 在基于键的添加、删除和返回值方面比其他两个快得多（每个字典中有 100,000 对键+值）。

有人能告诉我为什么 SortedList 和 SortedDictionary 比 Dictionary 慢吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T21:50:04.803

以基于未排序列表的排序列表为例。

让我们假设在任意索引处的未排序列表上的插入时间为 O(n/2)，其中 n 是列表的大小。这反映了平均而言，一半的列表元素必须被移动，以便为插入的元素腾出空间。

类似地，在这个列表中，从任意位置移除一个元素也是 O(n/2)，因为平均而言，必须移动一半的元素来缩小差距。

. . .

现在，想象一下同样的实现，但是有排序。

排序必须在插入时完成——它必​​须找到新元素的位置。由于所有先前的元素都已经排序（我们在插入时这样做，所以这是真的），我们可以从头开始扫描。

这是一个 O(n/2) 操作，甚至在我们开始插入之前。那只是为了找到插入点。

一种更好的方法，使用二分搜索可以让我们 O(log n) 找到插入位置，但仍然在支付 O(n/2) 成本之前进行插入本身。

如果一次扫描操作的代价是 s，插入操作的代价是 m（对于移动），那么排序插入的代价是：

```
s x O(log n) + m x (n/2) 
```

但是，在任意位置的未排序列表上的插入操作只是：

```
 m x (n /2) 
```

这是排序操作需要更长时间的真正原因的具体示例。

这种类型的理论还有更多内容，但这应该是一个开始。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T21:39:12.377

Because these data structures do a sort *again* each time you add or remove values from them. So you get a performance hit when using them.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T21:46:07.880

Dictionary 只是在列表末尾抛出新条目。它所要做的就是跟踪列表末尾的位置。但是，SortedDictionary 必须在列表中找到正确的位置来放置新条目。显然，这需要一些计算工作，并且比简单地将其添加到末尾要慢。

对于删除，这两种类型的对象都必须找出要删除的记录，但排序类型需要评估删除该记录对其内部结构的影响。例如，一个 b-tree 可能需要在删除后重新平衡它的分支。同样需要一些计算来评估这一点。因此性能上的差异。

# sqlite - 单声道共享缓存模式下的 SQLite？

> ID：13614836
> 
> 赞同：1
> 
> 时间：2012-11-28T21:34:39.880
> 
> 标签：sqlite, xamarin.ios

Mono.Data.SQLite 是否支持使用共享缓存模式的内存数据库？我收到 ArgumentException 抱怨数据源 URI 字符串的格式。我尝试使用的连接字符串是：

```
URI=file::memory:?cache=shared;Version=3 
```

我也尝试过使用`Data Source`连接字符串属性，结果相似。

（作为参考，这是在 iPhone MonoTouch 应用程序的上下文中。）

# c# - 使用 == 或 .Equals() 进行布尔比较

> ID：13614839
> 
> 赞同：14
> 
> 时间：2012-11-28T21:34:52.800
> 
> 标签：c#

我正在查看一些代码，我发现一些看起来像这样的东西：

```
public class MyClass
{
    public bool IsEditable { get; set; }

    public void HandleInput()
    {
        if (IsEditable.Equals(false))
        {
            //do stuff
        }
    }
} 
```

据我所知，`(IsEditable.Equals(false))`与`(IsEditable == false)`（也与`(!IsEditable)`）相同。

`.Equals()`除了个人喜好之外， and之间有什么区别`==`，**特别是用于比较`bool`s**时？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-28T21:37:04.640

这主要是一个可读性问题。我通常会使用`==`，因为那是我习惯看的。

特别是对于布尔值，您根本不必比较它们

```
if(!IsEditable) 
```

就足够了

虽然，有时我自己会写一些东西，`if (val == false)`只是为了确保在我必须修改代码时不会误读它。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-11-28T22:15:22.773

事实上，对于诸如 等基本类型`int`，调用和`bool`是有区别的，因为 CIL 有处理这些类型的指令。调用会强制对值进行装箱并进行虚拟方法调用，而使用会导致使用单个 CIL 指令。`Equals()``==``Equals()``==`

`!value`并且`value == false`实际上是相同的，至少在与 .NET 4.0 捆绑在一起的 Microsoft 的 C# 编译器中。

因此，以下方法中的比较

```
public static int CompareWithBoxingAndVirtualMethodCall(bool value)
{
    if (value.Equals(false)) { return 0; } else { return 1; }
}

public static int CompareWithCILInstruction(bool value)
{
    if (value == false) { return 0; } else { return 1; }
    if (!value) { return 0; } else { return 1; } // comparison same as line above
} 
```

将编译为以下 CIL 指令：

```
// CompareWithBoxingAndVirtualMethodCall

ldarga.s 'value'
ldc.i4.0
call instance bool [mscorlib]System.Boolean::Equals(bool) // virtual method call
brfalse.s IL_000c // additional boolean comparison, jump for if statement

// CompareWithCILInstruction

ldarg.0
brtrue.s IL_0005 // actual single boolean comparison, jump for if statement 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-11-28T21:48:17.570

这种`Equals`方式似乎要慢得多——在调试模式下大约是 2.7 倍，在发布模式下是七倍多。

这是我快速而肮脏的基准：

```
public static void Main() {
    bool a = bool.Parse("false");
    bool b = bool.Parse("true");
    bool c = bool.Parse("true");
    var sw = new Stopwatch();
    const int Max = 1000000000;
    int count = 0;
    sw.Start();
    // The loop will increment count Max times; let's measure how long it takes
    for (int i = 0; i != Max; i++) {
        count++;
    }
    sw.Stop();
    var baseTime = sw.ElapsedMilliseconds;
    sw.Start();
    count = 0;
    for (int i = 0; i != Max; i++) {
        if (a.Equals(c)) count++;
        if (b.Equals(c)) count++;
    }
    sw.Stop();
    Console.WriteLine(sw.ElapsedMilliseconds - baseTime);
    sw.Reset();
    count = 0;
    sw.Start();
    for (int i = 0; i != Max; i++) {
        if (a==c) count++;
        if (b==c) count++;
    }
    sw.Stop();
    Console.WriteLine(sw.ElapsedMilliseconds - baseTime);
    sw.Reset();
    count = 0;
    sw.Start();
    for (int i = 0; i != Max; i++) {
        if (!a) count++;
        if (!b) count++;
    }
    sw.Stop();
    Console.WriteLine(sw.ElapsedMilliseconds - baseTime);
} 
```

运行它会产生以下结果：

### 在调试模式

```
8959
2950
1874 
```

### 在释放模式

```
5348
751
7 
```

`Equals`似乎是最慢的。`==`和之间似乎没有什么区别`!=`。然而，`if (!boolExpr)`似乎是明显的赢家。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-28T22:50:55.097

如果您反编译 System.Boolean 并查看它，它的 Equals 重载是这样定义的：

```
public override bool Equals(object obj)
{
  if (!(obj is bool))
    return false;
  else
    return this == (bool) obj;
}

public bool Equals(bool obj)
{
  return this == obj;
} 
```

我想 C# 编译器的优化器和 .Net JIT 编译器足够聪明，可以内联这些，至少对于发布/优化编译，使它们完全相同。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-06-23T00:44:25.980

有区别-至少在.NET 4.8中-我相信原因是由于[Oliver Hanappi的](https://stackoverflow.com/questions/13614839/using-or-equals-for-bool-comparison#answer-13615362)回答中描述的拳击：

```
static void Main(string[] args)
{
     object lhs = true;
     object rhs = true;

     Console.WriteLine($"Are Equal - {(lhs == rhs ? "Yes" : "No")}"); // Outputs no
     Console.WriteLine($"Are Equal - {(lhs.Equals(rhs) ? "Yes" : "No")}"); // Outputs yes
     Console.ReadLine();
} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-11-28T21:45:41.093

在这种情况下，对于 bool，它没有任何区别，但是对于其他内置的非引用类型，它可以。

`==`如果不能，则允许类型 `.Equals`转换

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-11-28T21:54:28.437

看一下[从这里](http://blogs.msdn.com/b/csharpfaq/archive/2004/03/29/when-should-i-use-and-when-should-i-use-equals.aspx)摘录的以下引用：

> Equals 方法只是在 System.Object 中定义的一个虚拟方法，并且被选择这样做的任何类覆盖。== 运算符是一个可以被类重载的运算符，但通常具有标识行为。
> 
> 对于 == 没有被重载的引用类型，它会比较两个引用是否引用同一个对象——这正是 Equals 在 System.Object 中的实现。

所以简而言之，`Equals`实际上只是在做一个 == 反正。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2014-08-27T09:49:23.013

`==`总是比`.Equals`。在整数比较的情况下，`==`运行速度比`.Equals`. 在下面的测试中，经过的时间使用`==`157，而`.Equals`经过的时间是 230。

```
class Program
 {        
   static void Main(string[] args)
    {

        Program programObj = new Program();
            programObj.mymethod();
            programObj.mynextmethod();

    }
    void mynextmethod()
    {
        var watch = Stopwatch.StartNew();

        for (int i = 0; i < 60000000; i++)
        {
            int j = 0;
            if (i.Equals(j))

                j = j + 1;
        }
        watch.Stop();
        var elapsedMs = watch.ElapsedMilliseconds;
        Console.WriteLine("Time take in method" + elapsedMs);

        Console.ReadLine();
    }
    void mymethod()
    {
        var watch = Stopwatch.StartNew();

        for (int i = 0; i < 60000000; i++)
        {
            int j = 0;
            if (i == j)

                j = j + 1;
        }
        watch.Stop();
        var elapsedMs = watch.ElapsedMilliseconds;
        Console.WriteLine("Time take in method" + elapsedMs);
    }
} 
```

# c++ - C++：类和构造函数：使用初始化列表来初始化字段

> ID：13614844
> 
> 赞同：3
> 
> 时间：2012-11-28T21:35:09.187
> 
> 标签：c++, constructor, initialization

完整的代码。稍后指定的行。

```
#include <iostream>
#include <string>

using namespace std;

class X
{
    private:

    int i;
    float f;
    char c;

    public:

    X(int first=1, float second=2.0, char third='a') : i(first) , f(second) , c(third) { } 
    void print() { cout << i << " " << f << " " << c << endl;}

};

int main()
{
    X var1;
    var1.print();

    return 0;
} 
```

这条线上到底发生了什么：

```
X(int first=1, float second=2.0, char third='a') : i(first) , f(second) , c(third) { } 
```

据我所知（可能是错误的），我们首先声明对象，第二个和第三个类型（类）X。我们在声明期间初始化它们。结肠后发生了什么？到底是怎么回事？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T22:25:17.547

这条线上到底发生了什么：

```
X(int first=1, float second=2.0, char third='a') 
: i(first) , f(second) , c(third) { 
} 
```

它是一个构造函数，它接受 3 个具有默认值的参数。

这部分`: i(first) , f(second) , c(third)`称为`member initializer list`. 成员初始值设定项列表由逗号分隔的初始值设定项列表组成，前面有一个冒号。它位于参数列表的右括号之后和函数体的左括号之前。

只有构造函数可以使用这个初始化列表语法。const 类成员必须在成员初始化器中初始化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T21:38:05.390

The stuff in the parenthesis are default values for the arguments to the constructor, and the stuff after the colon initializes those items after the colon.

The colon notation is most commonly used to invoke the constructors of other objects the class uses.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-28T21:52:05.647

您有具有三个字段的 X 类：i、f、c。您已经定义了具有三个默认参数的构造函数 - 当此构造函数调用的字段使用参数初始化时（传递给构造函数或默认值）。就像是：

```
X (int first=1, float second=2.0, char third='a')
{
   i = first;
   f = second;
   c = third;
} 
```

您的行只是初始化字段的另一种方式，通常它们是相等的（继承存在一些差异）。

在您的主代码中，您正在创建一个`var1`X 类型的局部变量，因此调用了构造函数。您不传递任何参数，因此使用默认值。

结果，您有**一个**X 类型的本地对象，使用构造函数中列出的默认值进行了初始化。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-28T21:46:24.627

```
X(int first=1, float second=2.0, char third='a') : i(first) , f(second) , c(third) { } 
```

这是 X 的构造函数。共有三个参数，每个参数都有一个默认值，因此可以以不同的方式调用它

```
X myX;
X myX(first);
X myX(first, second);
X myX(first, second, third); 
```

论据之后的部分

```
: i(first) , f(second) , c(third) 
```

是`i`,`f`和`c`成员的初始化器。如果可能的话，这种初始化风格优于函数体中的初始化，并且如果成员是常量类型，则需要这种风格。

然后构造函数有一个空体`{}`

# php - AND 在一个数组中？

> ID：13614847
> 
> 赞同：-1
> 
> 时间：2012-11-28T21:35:26.847
> 
> 标签：php

所以我有一个数组

```
$date1 = "12/31/12";
$date2 = "01/01/13";

$a = array(
            'all' => true,
            'upcoming'=>true,
            'date'=>$date1,
            //'date'=>$date2,
            'is_nye'=>true,
            'where'=>$where,
            'status'=>'A'
        ); 
```

我想检查查询是否有两个日期我将如何处理？据我所知，如果我以当前状态添加它，它将仅显示 date2，因为它取代了原始日期。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T21:39:07.497

似乎您正在尝试使用重复键构建一个数组，这是无法完成的：[https ://stackoverflow.com/a/2879138/665261](https://stackoverflow.com/a/2879138/665261)

由于无法存储您尝试存储的数组（使用重复键），因此当然无法检索值。

答案是使用不同的数据结构，或者将键重命名为唯一的。

我想我会做的是自己制作`date`一个数组，所以像......

```
 $a = array(
        'all' => true,
        'upcoming'=>true,
        'date'=>array(
             $date1,
             $date2
        ),
        'is_nye'=>true,
        'where'=>$where,
        'status'=>'A'
    ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T21:38:04.187

只需以不同的方式命名键：

```
$a = array(
    'all' => true,
    'upcoming'=>true,
    'date_1'=>$date1,
    'date_2'=>$date2,
    'is_nye'=>true,
    'where'=>$where,
    'status'=>'A'
); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T21:41:22.810

您可以使用：

```
$a = array(
            'all' => true,
            'upcoming'=>true,
            'date1'=>$date1,
            'date2'=>$date2,
            'is_nye'=>true,
            'where'=>$where,
            'status'=>'A'
        ); 
```

要构造查询，请执行以下操作：

```
if($a['date2']){

    $query .= "AND date2 = '" . $a['date2'] . "'";

} 
```

# r - Combine items with same name into data frame

> ID：13614851
> 
> 赞同：1
> 
> 时间：2012-11-28T21:35:44.530
> 
> 标签：r, sum

if I have a table that looks like this (read in with read.table):

[http://i.stack.imgur.com/gaef6.png](http://i.stack.imgur.com/gaef6.png)

(The 0s are placeholders so I have a consistent number of rows)

Is there a way that I can add values with the same coresponding names (both values for a, all 4 values for l) and output it as a data frame? Also, the rows are not consistent (i.e. some columns have 4 a's, some have 2)

The result should look like this:

[http://i.stack.imgur.com/HrCt5.png](http://i.stack.imgur.com/HrCt5.png)

I can assemble the data frame with a, b etc as row names and the columns once the values are summed, but I cannot figure out how to sum them according to their corresponding names.

This is how I am currently approaching this:

*   `read.table()` for my table

*   define empty `data.frame`

*   use loop to extract and add column values by corresponding names? <-need help with this

*   `cbind()` data frame and column I just generated

*   continue through end of loop

-use row.names() and colnames() to change row and column names

My code so far:

```
setwd(wd)
read.table(dat.txt,sep="\t")->x
read.table(total.txt, sep="\t")->total
met<-c("a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r")
y<-data.frame(),
total[2,]->name
for g in 1:ncol(x){
  #column will be the column with the combined values according to name
  cbind(y,column)
}
row.names(y)<-met
colnames(y)<-name
write.table(y,file="data.txt",sep="\t") 
```

Any help would be much appreciated.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T00:07:56.110

您可以将其分为两部分：

(1) 聚合每一列 (2) 组合成一张漂亮的表格

使用 *apply 可以很好地完成它。我将其分解为 for 循环以使其更易于阅读

```
 ## sample df 
  df <- structure(list(thing1.met = c("a", "a", "b", "b", "c", "c", "d", "d", "e", "e", "f", "f", "g", "g", "h", "h", "i", "i", "j", "j", "k", "k", "l", "l", "m", "n", "o", "p", "q", "r"), thing1 = c(-0.57, 0.42, -1.12, -0.5, -0.94, -1.87, -2.22, -0.33, 1.45, 0.46, -1.96, -0.35, -1.01, 0.72, 0.04, -0.21, 0.81, 1.28, -0.52, -1.19, 0.03, -1.71, 0.53, -1.96, 1.58, -0.1, -0.88, 0.92, 0.02, -0.91), thing2.met = c("a", "a", "a", "b", "b", "c", "c", "c", "d", "e", "e", "f", "f", "g", "g", "h", "h", "i", "i", "j", "j", "k", "l", "l", "m", "n", "o", "p", "q", "r"), thing2 = c(-0.06, -0.7, 0.16, 1.96, 0.78, -0.65, -0.17, 0.89, 0.68, -0.93, -1.44, -0.16, -0.52, -0.19, 1.15, -0.77, 0.69, -0.48, 1.75, 1.62, -0.68, -1.06, -1.2, 1.42, -0.2, 1.33, 2.24, 0.35, 2, -1.21), thing3.met = c("a", "a", "a", "b", "c", "c", "d", "d", "e", "e", "f", "f", "g", "g", "g", "g", "g", "i", "k", "l", "l", "l", "m", "o", "o", "o", "p", "p", "p", "q"),     thing3 = c(1.27, 4.45, -2.42, -9.53, 3.33, 5.58, -2.94, 2.54,     12.44, 12.41, 7.6, 0.63, 5.67, -3.79, 12.28, 1.77, -0.4,     -0.04, 0.95, 4.93, 1.77, 0.37, -2.79, 2.36, 12.76, -5.4,     -4.73, -1.8, 0.52, -4.97)), .Names = c("thing1.met", "thing1", "thing2.met", "thing2", "thing3.met", "thing3"), row.names = c(NA, -30L), class = "data.frame")

  # create blank data frame
  results <- data.frame(row.names=met)

  # grab every other column
  cols <- seq(2, ncol(df), 2) 

  # aggregate over all m, over every pair of columns
  for (m in met) { 
    for (c in cols) {
      results[m, c/2] <- sum(df[,c][df[,c-1]==m])
    }
  }

  # clean up column names
  names(results) <- names(df)[cols]

  # final output
  results 
```

例子：

```
 > results
       thing1 thing2 thing3
    a  -0.15  -0.60   3.30
    b  -1.62   2.74  -9.53
    c  -2.81   0.07   8.91
    d  -2.55   0.68  -0.40
    e   1.91  -2.37  24.85
    f  -2.31  -0.68   8.23
    g  -0.29   0.96  15.53
    h  -0.17  -0.08   0.00
    i   2.09   1.27  -0.04
    j  -1.71   0.94   0.00
    k  -1.68  -1.06   0.95
    l  -1.43   0.22   7.07
    m   1.58  -0.20  -2.79
    n  -0.10   1.33   0.00
    o  -0.88   2.24   9.72
    p   0.92   0.35  -6.01
    q   0.02   2.00  -4.97
    r  -0.91  -1.21   0.00 
```

# c# - Visual Studio 2012 添加对错误 DLL 的引用

> ID：13614854
> 
> 赞同：12
> 
> 时间：2012-11-28T21:36:04.853
> 
> 标签：c#, visual-studio, visual-studio-2012

我无法让 Visual Studio 在发布模式下构建我的项目......它给了我关于程序集格式错误的错误。结果是一些 x86 程序集被引用而不是 x64 程序集。PresentationCore、System.Data 等程序集。

我尝试过的事情：

*   调试模式，任何 CPU 都可以正常构建。

*   调试模式，x64 构建良好。

*   释放模式，任何 CPU 出现故障

*   发布模式，x64 失败（这是我想要构建项目的组合）

当我尝试删除 x86 引用并将其切换到 x64 引用时，问题就出现了。Visual Studio 只是添加旧的 x86 引用而不是 x64 引用。例如：

我删除了其中的 System.Data 引用`C:\Windows\Microsoft.NET\Framework\v2.0.50727\System.Data.dll`

我浏览并添加`C:\Windows\Microsoft.NET\Framework64\v2.0.50727\System.Data.dll`，但是当我单击该 System.Data 引用时，路径显然仍然指向旧 dll 并导致发生相同的错误。这也发生在其他几个 DLL 中。

有谁知道这个问题的解决方案？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-07T19:04:14.603

> PresentationCore、System.Data 等程序集。

我讨厌在没有看到错误消息的情况下回答问题。但这个次要证据足以回答这个问题。首先，这*不是*错误，而是**警告**。它看起来像这样：

> 警告 CS1607：程序集生成 -- 引用的程序集“System.Data.dll”针对不同的处理器

您还将看到一个用于 mscorlib.dll 的文件。以及 WPF 项目中的 PresentationCore.dll。这里发生的是这些程序集是*特殊*的，它们是混合模式程序集。换句话说，它们包含本机代码和托管代码。本机代码是麻烦制造者，这样的程序集只能在针对正确处理器风格的项目中使用。如果你把它混在一起，那么你会在运行时得到一个 BadImageFormatException 。

这不是 .NET 程序集的真正问题，您的机器实际上在 GAC 中存储了这些 DLL 的*两个*版本。如果您的程序在 32 位模式下运行，将使用一个，另一个在 64 位模式下使用。CLR 会自动选择正确的。

但是，只有一个版本的*引用程序集*，即存储在 c:\windows\microsoft.net 中的版本，您可以将其传递给编译器以从中读取元数据。它始终是 x86 版本，没有其他版本，所以不要费心寻找它。同样，这不是问题，编译器只使用引用程序集的元数据，它不执行任何代码。并且元数据不依赖于程序集的位数。

然而，如果您创建自己的混合模式程序集，这一切都*可能成为问题。*您很容易忽略提供两个版本的需要。所以编译器担心的是它看到您要求项目的 AnyCPU 或 x64 构建。但是检测到参考程序集只能在您以 x86 为目标时工作。所以它对你有点刺耳，只是一个温和的提醒，有一些证据表明你弄错了，当你运行它时，你的程序可能会在 BadImageFormatException 上崩溃。它不会以其他方式处理与您自己的参考程序集有任何不同的框架参考程序集。

所以，功能，而不是错误。只是一个不会阻止您的程序构建的警告。您可以放心地忽略该警告，因为您*知道*.NET 在运行时在 GAC 中具有正确的程序集。值得注意的是 .NET 4.0 没有这个问题，它使用非常不同的引用程序集，这些程序集没有关闭 ILONLY 元数据标志。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-28T21:58:13.020

奇怪的行为。在项目属性中的构建下关闭“生成序列化程序集”会使项目在发布模式下构建得很好。查看[此链接](http://msdn.microsoft.com/en-us/library/vstudio/kb4wyys2.aspx)会发现此设置与 XML 序列化有关，我们甚至在整个解决方案中都没有使用它。

很奇怪。仍然在这里寻找这个问题和行为的解释。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-10T12:35:10.273

查看您的构建配置是什么样的。有时会发生此错误，因为解决方案上的某些项目被配置为在一个构建配置中构建，而不是在另一个构建配置中。

去做这个：

1.  转到“编译 > 配置管理...”
2.  在“活动解决方案配置”上选择“发布”，这是给您带来问题的配置。
3.  在“活动解决方案平台”上选中“任何 CPU”。如果定义了“x64”，您也可以选择它。
4.  查看构建项目列表。解决方案所需的所有项目都必须在“配置”、“平台”中标记正确的值，并进行“编译”检查。

在我的情况下，我有一个沙堡项目，我在大多数情况下都取消选中，至少在调试模式下是这样，因为编译需要很长时间。有时会发生一个项目没有“发布”配置的配置，因此，当构建过程试图获得其结果时，这些不存在（没有 DLL）并且它抛出异常。在其他情况下，可能是一个项目被迫为 x86（或 x64）编译而其余的则不是，因此在尝试将其他引用项目链接到所引用 DLL 的正确版本时会引发错误。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-06T20:03:02.787

您正在为哪个版本的 .NET 编译？如果您可以将项目更改为更高版本的 .NET 框架，那可能会有所帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-04-23T05:28:17.647

我的 VS2010 Web 项目也生成了这些警告，并且 IIS 抛出了 BadImageException。Build/Configuration/Platform 设置看起来没问题，但输出窗口显示 dll 是在 x64 文件夹中为任何 CPU 配置构建的。删除bin下的所有文件夹并重建。警告消失了，BadImageException 也消失了。

# android - How do you set the tab width using images for each tab and ActionBarSherlock

> ID：13614857
> 
> 赞同：3
> 
> 时间：2012-11-28T21:36:29.000
> 
> 标签：android, tabs, android-actionbar, actionbarsherlock

I can create five tabs using ActionBarSherlock that will not scroll and all fit on the screen. After I set one of the tabs to use an image, all the tabs become as wide as that tab, which itself becomes larger than the image I am using. How can I show five tabs, each with an image? I do not want them to scroll, but all be visible at once. Here is how I am setting the tab with the image:

```
tab1.setIcon(R.drawable.tab_home_unselect); 
```

![enter image description here](../Images/8469f1309630ae3be7718acc8638877e.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-08T09:23:33.960

我想你将不得不使用填充、边距、布局和图像的大小......

这是带有图像和文本的选项卡布局示例：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/tab_item"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="center"
    android:orientation="vertical"
    android:padding="2dip" >

    <ImageView
        android:id="@+id/tab_icon"
        android:layout_width="28dip"
        android:layout_height="28dip"
        android:layout_marginBottom="1dip" />

    <TextView
        android:id="@+id/tab_title"
        android:layout_width="wrap_content"
        android:layout_height="0dip"
        android:layout_marginBottom="2dp"
        android:layout_weight="1"
        android:gravity="center"
        android:textColor="@android:color/white"
        android:textSize="12sp" />

</LinearLayout> 
```

以及添加它们的方法

```
private View getTabIndicator(String text, int drawable) {

    View indicator = _inflater.inflate(R.layout.abs_tab, null);
    ((TextView) indicator.findViewById(R.id.tab_title)).setText(text);
    ((ImageView) indicator.findViewById(R.id.tab_icon)).setImageResource(drawable);
    return indicator;
} 
```

# css - “完美”的矩形动态文本

> ID：13614866
> 
> 赞同：0
> 
> 时间：2012-11-28T21:37:22.853
> 
> 标签：css, dynamic, text, width, containers

是否可以缩短容器（最好是 div），以便在不增加高度的情况下动态插入的文本成为“完美”矩形？

```
<div style="width:800px;">
<div>I'd like these words to look like below, but I'd like to "automatically" set it with a few lines of CSS rather than with jQuery or some other computationally intensive alternative.</div>
</div>
<br>
<div style="width:800px;">
<div style="width:530px;">I'd like these words to look like below, but I'd like to "automatically" set it with a few lines of CSS rather than with jQuery or some other computationally intensive alternative.</div>
</div>​ 
```

[http://jsfiddle.net/Q7gcb/](http://jsfiddle.net/Q7gcb/)

如果可能的话，我想用一个 CSS 设置来做到这一点，但我找不到。我还想避免 javascript 中的循环来执行此操作，因为我必须对很多 div 执行此操作，并且我不希望性能受到影响。

除非我用错了，否则空白似乎没有帮助。

提前谢谢了！

**文本对齐：对齐；**

本身没有帮助：http: [//jsfiddle.net/Q7gcb/4/](http://jsfiddle.net/Q7gcb/4/)

**最大宽度 + 文本对齐：对齐；**

也不起作用：http: [//jsfiddle.net/Q7gcb/5/](http://jsfiddle.net/Q7gcb/5/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:40:37.420

```
div {text-align: justify;}​ 
```

你也应该设置宽度值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-11T18:50:52.300

我相信你要找的东西都可以在[这里找到](https://stackoverflow.com/questions/6205109/justify-text-to-fill-a-div)

“在 DTP 和文字处理应用程序中，此选项称为‘强制对齐’。不幸的是，这不是 CSS 中的选项。”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T21:50:41.360

将`max-width`和设置`text-align`为`justify`。

```
div {
    max-width: 500px;
    text-align: justify;
} 
```

[演示](http://jsfiddle.net/Q7gcb/6/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-28T21:56:54.490

试试这个。

HTML

```
<div style="width:800px;">
<div>I'd like these words to look like below, but I'd like to "automatically" set it with a few lines of CSS rather than with jQuery or some other computationally intensive alternative.</div>
</div>
<br>
<div style="width:800px;">
<div style="width:530px;">I'd like these words to look like below, but I'd like to "automatically" set it with a few lines of CSS rather than with jQuery or some other computationally intensive alternative.</div>
</div>
<br>
<div style="width:800px;">
<div class="justify">I'd like these words to look like below, but I'd like to "automatically" set it with a few lines of CSS rather than with jQuery or some other computationally intensive alternative.</div>
</div>​ 
```

CSS

```
.justify{
    text-align: justify;
    text-align-last: justify;
}

.justify:after {
    content: "";
    display: inline-block;
    width: 100%;
}​ 
```

[http://jsfiddle.net/Q7gcb/7/](http://jsfiddle.net/Q7gcb/7/)

# xml - Where are all of the XML error codes documented?

> ID：13614872
> 
> 赞同：2
> 
> 时间：2012-11-28T21:37:52.783
> 
> 标签：xml, windows-runtime

In the Windows Runtime the DOM classes (XmlDocument) result in case of errors in a COM error with HRESULT value. Most of the error codes are documented (for MSXML) in the [MSXML documentation / XML Error Messages](http://msdn.microsoft.com/en-us/library/windows/desktop/jj134410%28v=vs.85%29.aspx).

But I could not find the documentation of other error codes. For example when trying to load an XML document having elements named using a namespace prefix that is not declared, HRESULT 0xC00CE01D results. The HRESULT codes in the mentioned documentation start with 0xC00CEE00, 0xC00CE01D is not mentioned there. I suppose there is a whole range of HRESULT values missing in the documentation (possible 0xC00CE000 to 0xC00CEDFF).

Does anyone know where I could find the documentation of missing HRESULT values for XML?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-08T20:34:08.053

请参阅 Microsoft [XML Lite 文档](http://msdn.microsoft.com/en-us/library/windows/desktop/ms753129%28v=vs.85%29.aspx)

错误代码在 xmllite.h 中定义。其中许多与 MSXML 中的错误相同。

# python - Flask-Login and Heroku issues

> ID：13614877
> 
> 赞同：5
> 
> 时间：2012-11-28T21:38:13.423
> 
> 标签：python, heroku, flask, flask-login

I have a sample web application (flask with flask-login running on heroku) at this URL: [http://twittaclone.herokuapp.com](http://twittaclone.herokuapp.com).

When I run it on my localhost the login functionality works fine. When I push to heroku it freaks out and does not allow users to login (it does allow user registration). Database modifications are being made.

Why would flask login not work on heroku?

```
app = Flask(__name__)
mysql = MySQL()

app.config['MYSQL_DATABASE_HOST'] = os.environ['MYSQL_DATABASE_HOST'] if 'MYSQL_DATABASE_HOST' in os.environ else config.MYSQL_DATABASE_HOST
app.config['MYSQL_DATABASE_PORT'] = os.environ['MYSQL_DATABASE_PORT'] if 'MYSQL_DATABASE_PORT' in os.environ else config.MYSQL_DATABASE_PORT
app.config['MYSQL_DATABASE_USER'] = os.environ['MYSQL_DATABASE_USER'] if 'MYSQL_DATABASE_USER' in os.environ else config.MYSQL_DATABASE_USER
app.config['MYSQL_DATABASE_PASSWORD'] = os.environ['MYSQL_DATABASE_PASSWORD'] if 'MYSQL_DATABASE_PASSWORD' in os.environ else config.MYSQL_DATABASE_PASSWORD
app.config['MYSQL_DATABASE_DB'] = os.environ['MYSQL_DATABASE_DB'] if 'MYSQL_DATABASE_DB' in os.environ else config.MYSQL_DATABASE_DB

mysql.init_app(app)

if 'SECRET_KEY' in os.environ: app.config['SECRET_KEY'] = os.environ['SECRET_KEY']
else: app.config['SECRET_KEY'] = os.urandom(24)

def connect_db(): return mysql.connect()

###
# Routing for your application.
###

login_manager = LoginManager()
login_manager.login_view = "login"

@login_manager.user_loader
def load_user(username):
    g.db = connect_db()
    return get_user(username)

login_manager.init_app(app)

@app.route('/')
def home(): return render_template('home.html')

def connect_db(): return mysql.connect()

@app.before_request
def before_request():
    g.user = current_user
    g.db = connect_db()

@app.teardown_request
def tear_down(exception):
    g.db.close()

@app.route('/main/')
@login_required
def main():
    print("in main")
    tweets, user = get_main()
    follower_count, followee_count = get_follower_info(g.user.username)
    return render_template('main.html', user=user, tweets=tweets, followercount =      follower_count, followeecount = followee_count)

@app.route('/login/', methods=['GET', 'POST'])
def login():
    """Logs the user in."""
    if request.method == 'GET':
        if current_user is user_logged_in: logout_user()

    error = None
    if request.method == 'POST':
        user = get_user(request.form['username'])
        if user is None:
            error = 'Invalid username'
        elif not check_password_hash(user.password, request.form['password']):
            error = 'Invalid password'
        else:
            flash('You were logged in')
            login_user(user)
            return redirect(url_for('main'))

    return render_template('login.html', error=error) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2022-01-18T01:00:45.123

许多年后，但这解决了您的问题：[Heroku gunicorn flask login is not working proper](https://stackoverflow.com/questions/39684364/heroku-gunicorn-flask-login-is-not-working-properly/39768181#39768181)

更新的Procfile：

网页：gunicorn app:app --preload

gunicorn 预加载文档：[https ://docs.gunicorn.org/en/stable/settings.html](https://docs.gunicorn.org/en/stable/settings.html)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-09-12T00:42:40.473

我很确定 Heroku 使用 PostgreSQL。尝试参考他们的文档[https://devcenter.heroku.com/articles/heroku-postgresql](https://devcenter.heroku.com/articles/heroku-postgresql)

# matlab - 在 MATLAB 中使用 SVD 压缩图像

> ID：13614886
> 
> 赞同：16
> 
> 时间：2012-11-28T21:39:02.250
> 
> 标签：matlab, image-processing, octave, image-compression, svd

我是 MATLAB 的新手，但正在尝试为灰度图像做一些图像压缩代码。

**问题**

如何使用 SVD 修剪低值特征值以重建压缩图像？

**迄今为止的工作/尝试**

到目前为止，我的代码是：

```
B=imread('images1.jpeg');   
B=rgb2gray(B);  
doubleB=double(B);  
%read the image and store it as matrix B, convert the image to a grayscale
photo and convert the matrix to a class 'double' for values 0-255  
[U,S,V]=svd(doubleB); 
```

这使我能够成功地分解具有存储在变量 S 中的特征值的图像矩阵。

如何截断 S（即 167x301，双级）？假设我只想取前 100 个（或任何 n 个）的 167 个特征值，我该怎么做并重建压缩图像？

**更新的代码/想法**

这是我目前的草稿，而不是在评论部分放一堆代码。我已经能够通过手动更改 N 成功创建压缩图像，但我想做两件事：

1-显示各种压缩的图像面板（即，运行 N = 5、10、25 等的循环）

2-以某种方式计算每个图像与原始图像之间的差异（误差）并绘制它。

我对循环和输出的理解很糟糕，但这是我尝试过的：

```
B=imread('images1.jpeg');  
B=rgb2gray(B);  
doubleB=im2double(B);%  
%read the image and store it as matrix B, convert the image to a grayscale  
%photo and convert the image to a class 'double'  
[U,S,V]=svd(doubleB);   
C=S;  
for N=[5,10,25,50,100]  
C(N+1:end,:)=0;  
C(:,N+1:end)=0;  
D=U*C*V';  
%Use singular value decomposition on the image doubleB, create a new matrix  
%C (for Compression diagonal) and zero out all entries above N, (which in  
%this case is 100). Then construct a new image, D, by using the new  
%diagonal matrix C.  
imshow(D);  
error=C-D;  
end 
```

显然有一些错误，因为我没有得到多张图片或知道如何“绘制”错误矩阵

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-07-16T12:26:20.953

虽然这个问题很老，但它对我理解 SVD 帮助很大。我已经修改了您在问题中编写的代码以使其正常工作。

我相信您可能已经解决了这个问题，但只是为了供访问此页面的任何人将来参考，我在此处包含完整的代码以及输出图像和图表。

下面是代码：

```
close all
clear all
clc

%reading and converting the image
inImage=imread('fruits.jpg');
inImage=rgb2gray(inImage);
inImageD=double(inImage);

% decomposing the image using singular value decomposition
[U,S,V]=svd(inImageD);

% Using different number of singular values (diagonal of S) to compress and
% reconstruct the image
dispEr = [];
numSVals = [];
for N=5:25:300
    % store the singular values in a temporary var
    C = S;

    % discard the diagonal values not required for compression
    C(N+1:end,:)=0;
    C(:,N+1:end)=0;

    % Construct an Image using the selected singular values
    D=U*C*V';

    % display and compute error
    figure;
    buffer = sprintf('Image output using %d singular values', N)
    imshow(uint8(D));
    title(buffer);
    error=sum(sum((inImageD-D).^2));

    % store vals for display
    dispEr = [dispEr; error];
    numSVals = [numSVals; N];
end

% dislay the error graph
figure; 
title('Error in compression');
plot(numSVals, dispEr);
grid on
xlabel('Number of Singular Values used');
ylabel('Error between compress and original image'); 
```

将此应用于以下图像： ![原始图像](../Images/f9d0a67961bc5ec08cc157bef433ec5b.png)

仅使用前 5 个奇异值给出以下结果，

![前 5 个奇异值](../Images/00d361b37f3ecc3ec4ada5ada3f05fc9.png)

具有前 30 个奇异值，

![前 30 个奇异值](../Images/0b6babafa12b19ef8061e13fb5c273e7.png)

和前 55 个奇异值，

![前 55 个奇异值](../Images/2f7a83fc37dfd04b3eeb6306cb63ef1e.png)

下图中可以看到随着奇异值数量的增加而发生的误差变化。

![错误图](../Images/861e72a79b3be897550e8ff788cc5444.png)

在这里，您可以注意到该图显示使用大约 200 个第一奇异值会产生大约零误差。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-11-28T22:14:59.357

刚开始，我假设您知道 SVD 确实不是对单个图像中的像素进行去相关的最佳工具。但这是很好的做法。

好的，所以我们知道`B = U*S*V'`。我们知道 S 是对角线，并按大小排序。因此，仅使用 S 的前几个值，您将获得图像的近似值。假设`C=U*S2*V'`S2 是你修改后的 S。U 和 V 的大小没有改变，所以现在最简单的做法是将 S 中不想使用的元素归零，然后运行重建。（最简单的方法是：）`S2=S; S2(N+1:end, :) = 0; S2(:, N+1:end) = 0;`。

现在是压缩部分。 `U`已满， 也是如此`V`，因此无论 发生什么`S2`，您的数据量都不会改变。但是看看会发生什么`U*S2`。（绘制图像）。如果在 中保留 N 个奇异值`S2`，则只有前 N 行`S2`是非零的。压缩！除了你还得处理`V`。在你已经完成之后你不能使用相同的技巧`(U*S2)`，因为更多的`U*S2`非零而不是`S2`本身。我们如何在两边都使用 S2？嗯，它是对角线的，所以使用`D=sqrt(S2)`, 和 now `C=U*D*D*V'`。所以现在`U*D`只有 N 个非零行，并且`D*V'`只有 N 个非零列。只传输这些量，你可以重构 C，它与 B 大致相似。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-10-14T15:12:33.640

[例如，这是Lena](https://en.wikipedia.org/wiki/Lenna)的 512 x 512 黑白图像：

[![莉娜](../Images/74d3d13a49e3caa8bb024fc672999938.png)](https://i.stack.imgur.com/Xi4CS.jpg)

我们计算 Lena 的 SVD。选择大于最大奇异值 1% 的奇异值，我们只剩下**53 个奇异值**。用这些奇异值和相应的（左和右）奇异向量重构 Lena，我们得到 Lena 的[低秩近似](https://en.wikipedia.org/wiki/Low-rank_approximation)：

[![在此处输入图像描述](../Images/3b1ac165ec0797812afb7c92322b5df3.png)](https://i.stack.imgur.com/UcuPP.jpg)

我们可以存储 2 x (512 x 53) + 53 = 54325 个值，而不是存储 512 * 512 = 262144 个值（每个值占用 8 位），这大约**是原始大小的 20%**。这是如何使用 SVD 进行有损图像压缩的一个示例。

* * *

这是**MATLAB**代码：

```
% open Lena image and convert from uint8 to double
Lena = double(imread('LenaBW.bmp'));

% perform SVD on Lena
[U,S,V] = svd(Lena);

% extract singular values
singvals = diag(S);

% find out where to truncate the U, S, V matrices
indices = find(singvals >= 0.01 * singvals(1));

% reduce SVD matrices
U_red = U(:,indices);
S_red = S(indices,indices);
V_red = V(:,indices);

% construct low-rank approximation of Lena
Lena_red = U_red * S_red * V_red';

% print results to command window
r = num2str(length(indices));
m = num2str(length(singvals));
disp(['Low-rank approximation used ',r,' of ',m,' singular values']);

% save reduced Lena
imwrite(uint8(Lena_red),'Reduced Lena.bmp'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-28T21:46:20.117

取前 n 个最大特征值及其对应的特征向量可能会解决您的问题。对于 PCA，原始数据乘以第一个升序特征向量将通过 nxd 构建您的图像，其中 d 表示特征向量的数量。

# java - What is a mnemonic in java?

> ID：13614887
> 
> 赞同：8
> 
> 时间：2012-11-28T21:39:05.867
> 
> 标签：java, mnemonics

I can find a bunch of info talking about mnemonics but nothing about what they are. Can someone help me here?

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-28T21:42:18.130

从[摇摆文档](http://docs.oracle.com/javase/tutorial/uiswing/components/menu.html#mnemonic)：

> 助记符提供了一种使用键盘导航菜单层次结构的方法，增加了程序的可访问性。

它是菜单、按钮、标签、选项卡等中带下划线的字母。按下 ALT 键和键盘上带下划线的字母选择该菜单项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T21:43:02.420

助记符是一种键盘快捷键，可让您访问某些菜单项。这是一个可访问性的东西。

本[教程](http://www.macs.hw.ac.uk/guidebook/?name=JMenuBar&page=3)是一个很好的说明。

# macos - How can I change one single colour on Mac OS X screen (similar to invert colours)?

> ID：13614891
> 
> 赞同：1
> 
> 时间：2012-11-28T21:39:15.663
> 
> 标签：macos, graphics, colors, accessibility

I've read some guys have done a trick editing this file, but I'm not a guru.

```
defaults write com.apple.CoreGraphics \
(DisplayUseInvertedPolarity -bool YES) 
```

Basically I want to change the white background color to sepia or anything darker when I read in Skim pdf reader. Since Skim (unlike Kindle) doesnt support this feature, maybe I find a work around and I can change the white color of the screen so it will be useful with any application I want if I can make this happen.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-07T18:26:48.843

由于您似乎只想在任何地方添加 Kindle 的棕褐色模式，我建议您访问[http://justgetflux.com/](http://justgetflux.com/)而不是尝试手动实现您想要的。

# c# - 如何将 onclick 事件添加到 gridview 的第一列而不是整行？

> ID：13614893
> 
> 赞同：2
> 
> 时间：2012-11-28T21:39:19.493
> 
> 标签：c#, javascript, gridview, onclick, code-behind

标题是不言自明的。我有一个gridview，当用户单击特定行时，我会在第一列中添加一个阴影。问题是，用户可以单击行上的任意位置，并添加阴影，但如果用户单击链接（即第一列），链接只会在新选项卡中打开。如何仅将 onclick 事件添加到每一行的第一列？

```
 if (e.Row.RowType == DataControlRowType.DataRow)
    {
        // Javascript function to call on row-click event
        e.Row.Attributes.Add("onClick", "javascript:void SelectRow(this);");
    } 
```

如果有帮助，我使用[此处](http://www.codeproject.com/Tips/209416/Make-the-entire-GridView-Row-clickable-and-selecta)的示例来实现 SelectRow。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-28T21:41:58.240

`e.Row.Cells[0]` 将其添加到

```
if (e.Row.RowType == DataControlRowType.DataRow)
{
   e.Row.Cells[0].Attributes.Add("onClick", "SelectRow(this);");
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T21:42:15.110

尝试：

```
e.Row.Cells[0].Attributes.Add("onClick", "javascript:void SelectRow(this);"); 
```

# python - 在python中删除选定的csv列

> ID：13614899
> 
> 赞同：1
> 
> 时间：2012-11-28T21:39:50.010
> 
> 标签：python, csv

我有一个包含以下字符串的变量：

```
fruit_wanted = 'banana,apple' 
```

我也有一个 csv 文件

```
fruit,'orange','grape','banana','mango','apple','strawberry'
number,1,2,3,4,5,6
value,3,2,2,4,2,1
price,3,2,1,2,3,4 
```

现在如何删除“fruit_wanted”变量中未列出“fruit”的列？

所以outfile看起来像

```
fruit,'banana','apple'
number,3,5
value,2,2
price,1,3 
```

谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-28T21:43:35.790

[`DictReader()`使用class](http://docs.python.org/2/library/csv.html#csv.DictReader)读取 csv 文件，并忽略不需要的列：

```
fruit_wanted = ['fruit'] + ["'%s'" % f for f in fruit_wanted.split(',')]
outfile = csv.DictWriter(open(outputfile, 'wb'), fieldnames=fruit_wanted)
fruit_wanted = set(fruit_wanted)

for row in csv.DictReader(open(inputfile, 'rb')):
    row = {k: row[k] for k in row if k in fruit_wanted}
    outfile.writerow(row) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T21:43:53.650

这是一些伪代码：

```
open the original CSV for input, and the new one for output
read the first row of the original CSV and figure out which columns you want to delete
write the modified first row to the output CSV
for each row in the input CSV:
    delete the columns you figured out before
    write the modified row to the output CSV 
```

# java - 使用 XSLT 将 XML 文件转换为符合 KML 标记规则的新 XML 文件的 Java 程序？

> ID：13614904
> 
> 赞同：0
> 
> 时间：2012-11-28T21:40:12.220
> 
> 标签：java, xml, kml

这种程序需要做什么？我知道一种方法必须在原始文件中进行解析，然后我们 XSLT 将原始代码转换为更好的形式（遵循 KML 标记规则）。我真的需要知道如何在我的 Java 程序中调用 XSLT。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T07:40:55.797

> 这种程序需要做什么？

好吧，我们不知道任何细节，所以我们只能说它是一种 XML 到 XML 的转换，而表达这种转换的最佳语言是 XSLT。您是否在询问如何从 Java 调用 XSLT？这很容易。或者您是在问如何编写 XSLT？这取决于输入和输出。

# mocking - 在 PHPUnit 中使用不同参数的测试方法调用

> ID：13614905
> 
> 赞同：2
> 
> 时间：2012-11-28T21:40:15.493
> 
> 标签：mocking, phpunit

我有以下抽象类：

```
abstract class Voter
{
    public function vote()
    {
        $this->something();
        $this->something();

        $this->voteFoo();
        $this->voteBar();
    }

    public function __call($method, $args)
    {
        //...
    }

    abstract public function something();
} 
```

`voteFoo`并由`voteBar`处理`__call`。

我想断言同时`vote()`调用`voteFoo()`and `voteBar()`，我该怎么做？

我尝试使用`$this->at(..)`，但它给了我一个错误：

```
$voter = $this->getMockForAbstractClass('Voter', array(), '', true, true, true, array('__call'));

$voter->expects($this->any())
      ->method('something')
      ->will($this->returnValue(true));

$voter->expects($this->at(0))
      ->method('__call')
      ->with($this->equalTo('voteFoo'));

$voter->expects($this->at(1))
      ->method('__call')
      ->with($this->equalTo('voteBar'));

$voter->vote();

*********** ERROR *************
Expectation failed for method name is equal to <string:__call> when invoked at
sequence index 0.
Mocked method does not exist. 
```

**编辑**：

如果我将值更改`$this->at()`为**2**和**3**，则测试通过，这意味着由于某种原因`$this->something()`也会触发该`__call`方法。

这个*Voter*类不是我真正的*Voter*类，它是问题的简单版本。`__call`在我真正的课堂上，我不知道会被调用多少次..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T20:15:05.433

从[docs](http://www.phpunit.de/manual/current/en/test-doubles.html#test-doubles.stubs.examples.StubTest5.php)中并不完全清楚，但是您应该可以使用`returnValueMap`它：

```
$voter->expects($this->any())
      ->method('something')
      ->will($this->returnValue(true));

$argumentMap = array(
    array('voteFoo'),
    array('voteBar')
);

$voter->expects($this->exactly(2))
      ->method('__call')
      ->will($this->returnValueMap($argumentMap)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-22T10:57:11.283

当计算所有函数调用时，这是 PHPunit 错误。3.7版本修复了Bug

# powershell - 使用 csv 的 ForEach 中的 If 语句

> ID：13614912
> 
> 赞同：3
> 
> 时间：2012-11-28T21:40:46.953
> 
> 标签：powershell, csv, if-statement, foreach

我们正在使用 powershell 在我们的 Active Directory 中自动创建我们的学生用户。除了启用邮箱，我们一切正常。我们只向中学生提供电子邮件地址。所以我试图让脚本读取 csv 并且只为中学生启用邮箱。我们所有中学的校园号都小于 100，所以我尝试让脚本使用 ForEach，然后如果 $_.extensionAttribute1（csv 中带有校园号的列）小于 100，那么它将邮件启用该帐户. 我遇到的问题是只处理第一个用户并结束脚本。我希望它遍历 csv 中的每一行。这是我的脚本。

```
add-pssnapin Microsoft.Exchange.Management.PowerShell.E2010

Import-CSV C:\scripts\updateuser.csv | ForEach {
    $campus =$_.extensionAttribute1
    If ($campus -lt '100') {
    Enable-Mailbox -Identity $_.sAMAccountName -Database NISDSRV6DB1
    }} 
```

非常感谢您提供的任何帮助以使其贯穿整个 csv。预先感谢您的帮助。

编辑...我在搞乱 csv 文件，得到了一些有趣的结果。该脚本显示任何内容的唯一方法是 extensionAttribute1 字段是否填充了 1。我正在尝试获取小于 100 的所有用户。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T22:19:16.867

尝试`;`在变量赋值的末尾添加

`$campus =$_.extensionAttribute1;`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T23:35:55.543

您的 'extensionAttribute1' 值未在 'if' 语句中正确转换为整数。试试这个：

```
add-pssnapin Microsoft.Exchange.Management.PowerShell.E2010

Import-CSV C:\scripts\updateuser.csv | ForEach {
    $campus =$_.extensionAttribute1 -as [Int]
    if ($campus -lt '100'){
        Write-Host $_.sAMAccountName            
        Enable-Mailbox -Identity $_.sAMAccountName -Database NISDSRV6DB1
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T15:23:52.413

我已经想通了。我的中学数字是 1、7、10、42、43、44、45 和 46。如果数字是 1，我只会认出小于（奇怪）。如果我在每个数字前面加上 0 到 3 位数字，它就会识别它们。001、007、010、042、043、044、045 和 046 可以工作并被识别为小于 100。还没有找到原因，但我现在需要调整我的 csv 导出过程以考虑这个数字方案.

# java - Android在准备Asunc时停止媒体播放器

> ID：13614914
> 
> 赞同：0
> 
> 时间：2012-11-28T21:40:55.437
> 
> 标签：java, android

当我使用 mediaplayer.prepareAsunc() 时，如何在加载过程中停止媒体播放器（在设置无线电流的路径之后）..当我完成活动时，它开始播放，加载后..如何在加载过程中停止它? 没有 System.exit(0) 方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:44:29.673

```
private void releaseMediaPlayer() {
        if (mMediaPlayer != null) {
            mMediaPlayer.release();
            mMediaPlayer = null;
        }
    } 
```

# php - 在作曲家包中包含 CLI 脚本

> ID：13614916
> 
> 赞同：2
> 
> 时间：2012-11-28T21:41:04.613
> 
> 标签：php, composer-php

我有一个作曲家包`http://github.com/danmatthews/req`，我正在尝试包含一个 CLI 脚本，使用 Composer 的`bin`指令在`composer.php`.

问题？我的脚本使用 Symfony 的控制台组件作为依赖项，我包括 Composer*的*autoload.php 以便将它们拉入。**但是**当我的包作为另一个项目的一部分包含时，显然供应商文件夹存储在顶层，而不是在我的包裹里面。

我可以做些什么来确保无论我的`bin/req`脚本在哪里结束（当与 composer 一起安装时），它总是会加载它需要的依赖项？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T22:40:06.840

看看 Behat 在这里是如何做到的：[https ://github.com/Behat/Behat/blob/master/bin/behat](https://github.com/Behat/Behat/blob/master/bin/behat)

或此处的教义：[https ://github.com/doctrine/doctrine2/blob/master/bin/doctrine.php](https://github.com/doctrine/doctrine2/blob/master/bin/doctrine.php)

我注意到你需要 Req 类。我宁愿把它留给自动加载器。

# symfony - Symfony2 开发环境中的图像路径损坏

> ID：13614922
> 
> 赞同：1
> 
> 时间：2012-11-28T21:41:27.677
> 
> 标签：symfony

成功发布我的包后，开发环境被破坏了。

![破碎的 symfony2](../Images/1f7d5a9039a02940f784842daa1b06ab.png)

为了发布我的资产，我做了：

`php console assets:install --symlink --relative /home/bitnami/stack/frameworks/symfony/web`

`php console assetic:dump`

`php console cache:clear --env=prod --no-debug`

图片参考：/symfony/web/bundles/webprofiler/images/profiler/logo_symfony_profiler.png

# c++ - 比较从 Arduino 中的串行数据接收到的连接字符串

> ID：13614927
> 
> 赞同：0
> 
> 时间：2012-11-28T21:42:00.933
> 
> 标签：c++, arduino

我正在尝试将串行数据读入一个能够与另一个字符串进行比较的字符串。我正在使用 if (inputString.equals("test")) 来测试布尔值，但它总是返回为假，因为当在串行监视器中键入测试时，它们永远不会显示（它会回显我发送的内容）到arduino）。有任何想法吗？以这种方式连接字符串是否会向字符串添加额外的非显示字节？

```
String inputString = "";         // a string to hold incoming data
boolean stringComplete = false;  // whether the string is complete

void setup() {
// initialize serial:
Serial.begin(9600);
}

void loop() {
  // print the string when a newline arrives:
  if (stringComplete) {

       if (inputString.equals("test")) {
       Serial.print("THEY ARE EQUAL"); 
    }

    Serial.print(inputString); 
    // clear the string:
    inputString = "";
    stringComplete = false;
    }

   }

void serialEvent() {
  while (Serial.available()) {
  // get the new byte:
  char inChar = (char)Serial.read(); 
  // add it to the inputString:
  inputString += inChar;
  stringComplete = true;

  }
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T01:25:20.810

您需要留出足够的时间来读取串行数据。添加延迟

```
char inChar = (char)Serial.read(); 
// add it to the inputString:
delay(100);
inputString += inChar; 
```

# localdb - 如何在 InstallShield 项目中包含 KB2544524

> ID：13614936
> 
> 赞同：1
> 
> 时间：2012-11-28T21:42:34.203
> 
> 标签：localdb, installshield-2012

我有一个使用我通过 InstallShield Express Spring 2012 部署的 SQLLocalDb 的应用程序。

LocalDb 要求安装 KB2544514 的 .Net 更新。没有此更新，LocalDb 无法连接到 LocalDb 实例。

当我将此 exe 作为自定义操作添加到 InstallShield 时：

*   除非以管理员身份运行安装，否则在执行 NPD40-KB2544514-x86-x64.exe 时会遇到错误 1721。

*   如果包含 NPD40-KB2544514-x86-x64.exe 的安装程序以管理员身份运行，则安装成功。

有没有一种方法可以将 Microsoft KB 更新与安装进行菊花链式连接，而无需右键单击“以管理员身份运行”。我担心的是，99% 的用户通常会忽略“右键单击并以管理员身份运行”的说明，并会产生大量的支持电话。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T19:36:15.810

您必须通过“Install Shield Prerequisite editor”创建自定义先决条件并将其与您的功能相关联。

# c - 从中间/底部规则中的最顶部规则中获取值

> ID：13614939
> 
> 赞同：2
> 
> 时间：2012-11-28T21:42:46.030
> 
> 标签：c, bison

我正在做我自己的小语言，我正在尝试制作块，但我非常坚持如何跟踪当前块（因为我需要知道变量是在哪个块中创建的，所以 -等等等等）。

我的语法文件看起来像这样（为简单起见，它不是整个代码）：

```
%{
    struct Node *nodest = NULL;
    struct Node *currentblock = NULL;
%}

%start source

%%

source
    : stmts { nodest = block($1); currentblock = nodest; }
    ;

stmts
    : stmt
    | stmts stmt
    ;

stmt
    : expr_stmt
    | iter_stmt
    | select_stmt
    | comp_stmt
    ;

expr_stmt
    : ';'
    | expr ';'
    ;

expr
    : binary_expr
    | assign_expr
    | call_expr
    | decl_expr
    | init_expr
    | VAR_IDENT
    | INTEGER
    | '(' expr ')'
    ;

comp_stmt
    : '{' '}'
    | '{' stmts '}' { $$ = block($2); currentblock = $$; }
    ;

decl_expr
    : type VAR_IDENT  { $$ = declaration($1, $2, currentblock) }
    ;
/* ... */

type
    : TYPE_INT
    ; 
```

这显然是行不通的，因为`nodest`（作为一个包含所有其他节点的块节点）实际上在创建 AST 的最后阶段被赋予了一些值，所以在其余时间它是 NULL，所以`currentblock`不能使用像 in `decl_expr`，因为它当时是 NULL 。

`nodest`所以我的问题是：我怎样才能在代码中获得稍后的值（指向它指向的位置或其他） ？

或者，如果这不是真的可能，您能否给我一些说明/提示我如何才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T22:50:29.953

规则中的操作代码在规则缩减时执行，因此如果您希望在流程中更早地执行操作，则需要将它们放在更早缩减的规则上。yacc 和 bison 都允许您引入匿名 epsilon 规则，只需在规则右侧的前面放置一个额外的操作。因此，您可以执行以下操作：

```
source: { $$ = currentblock = nodest = empty_block(); } stmts
        { $$ = add_to_block($1, $2); }

comp_stmt:
    '{' { $$ = currentblock = empty_block(); } stmts '}'
    { $$ = add_to_block($2, $3); }
; 
```

请注意，当您像这样尽早创建块时，您必须将它们创建为空的（因为您尚未解析任何进入块的内容），然后稍后再向它们添加内容。在解析时将每个 stmt 添加到当前块可能更有意义（在这种情况下，您需要确保 currentblock 确实是当前块而不是最后一个块：

```
source: { currentblock = nodest = empty_block(); } stmts ;

stmts: /* empty*/
     | stmts stmt { add_to_block(currentblock, $2; }

comp_stmt:
    '{' { $$ = currentblock; currentblock = empty_block(); } stmts '}'
    { $$ = currentblock; currentblock = $2 }
; 
```

# joomla - 在 Joomla 2.5 中，如何在所有页面上仅显示一个根级别项目的子菜单项？

> ID：13614942
> 
> 赞同：2
> 
> 时间：2012-11-28T21:43:10.850
> 
> 标签：joomla, menu, joomla2.5, submenu

我正在使用 Joomla 2.5.8，我想在网站的所有页面上都有一个二级菜单，它只显示主菜单中根菜单项 #2 的子菜单项。

```
Item 1 | Item 2 | Item 3 | Item 4
 --- Show just the below items ---
       | Item 2-1 |
       | Item 2-2 |
       | Item 2-3 |
       | Item 2-4 | 
```

我尝试创建另一个菜单模块并设置开始和结束级别，但它只显示作为根菜单项一部分的页面。

我也尝试过不设置开始和结束级别选项，只使用模板 css 隐藏我不想要的项目，但是当我隐藏根菜单项时，我无法显示子菜单项。

我真的不想制作单独的菜单，因为如果主菜单有主要的菜单类型更改，我不必制作两次。

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-29T09:43:07.410

这是我刚刚制作的一个模块。它从您选择的菜单项中呈现子菜单项。在此处下载插件：[下载](http://www.multiupload.nl/7VXAKEK011)

如果您无法下载或出现问题，这里是插件文件：

PHP 文件 ( `mod_submenu.php`):

```
<ul class="menu">

    <?php
    defined('_JEXEC') or die;

    $m = JFactory::getApplication()->getMenu();

    $active = $m->getActive();
    $active_id = isset($active) ? $active->id : $m->getDefault()->id;
    $path   = isset($active) ? $active->tree : array();

    $menu = $m->getMenu();

    $parentId = $params->get("menuitem");
    foreach($menu as $item){
        if($item->level == 2 && $item->parent_id == $parentId){
            $class = 'item-'.$item->id;
            if ($item->id == $active_id) {
                $class .= ' current';
            }
            if (in_array($item->id, $path)) {
                $class .= ' active';
            }

            $flink = $item->link;
            if ((strpos($item->link, 'index.php?') === 0) && (strpos($item->link, 'Itemid=') === false)) {
                $item->flink = $item->link.'&Itemid='.$item->id;

                if (strcasecmp(substr($item->flink, 0, 4), 'http') && (strpos($item->flink, 'index.php?') !== false)) {
                    $item->flink = JRoute::_($item->flink, true, $item->params->get('secure'));
                }
                else {
                    $item->flink = JRoute::_($item->flink);
                }
            }
            echo "<li class='$class'><a href='$item->flink'>$item->title</a></li>";
        }
    }
    ?>

</ul> 
```

XML 文件 ( `mod_submenu.xml`):

```
<?xml version="1.0" encoding="utf-8"?>
<extension type="module" version="2.5.0" client="site" method="install">
<name>Show Submenu</name>
<author>Brian</author>
<creationDate>2012</creationDate>
<copyright></copyright>
<license>No license</license>
<authorEmail>No email</authorEmail> 
<authorUrl>No website</authorUrl> 
<version>1.0.0</version> 
<description>Showing a submenu</description>

<files>
    <filename module="mod_submenu">mod_submenu.php</filename>
    <filename>index.html</filename>
</files>

<config>
    <fields name="params">
        <fieldset name="basic">
            <field
            name="menuitem"
            type="menuitem"
            label="Choose the menuitem" />
        </fieldset>
    </fields>
</config>
</extension> 
```

（请原谅格式，我还是要习惯 SO）

还有一个空白的 index.html 文件。将它们全部放在一个名为`mod_submenu`, zip 的文件夹中，安装并配置它！

配置：

![配置插件](../Images/15f04a0037876307c0000c4fc23ba3a3.png)

结果：

![显示子菜单结果](../Images/3ee302e31ff66c05fcf1e4418b1677c5.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T22:21:18.307

这可能不是绝对最好的方法，但这是我暂时能想到的。

对于父菜单项（第 2 项），将类型设置为“文本分隔符”。这将使它不再是一个正确的菜单项，并且很可能（取决于模板）将标签包裹在文本周围。

然后打开一个属于该模板的 CSS 文件并添加以下代码：

```
span.classname {
    display:none;
} 
```

显然，您需要将**“类名”**更改为赋予它的任何类。Chrome 开发工具或 Firebug 将帮助您解决此问题。

# video - 无法访问 red5 w 上的安装程序链接。Ubuntu 11.10

> ID：13614955
> 
> 赞同：0
> 
> 时间：2012-11-28T21:44:20.783
> 
> 标签：video, ubuntu, streaming, localhost, red5

我刚刚使用本指南安装了 red5：http: [//labs.distriqt.com/post/493](http://labs.distriqt.com/post/493)一切正常，如果我转到 localhost:5080，它会显示 red5 测试页面。但是，如果我单击安装现成的应用程序或启动演示，它会显示无法连接 Firefox 无法在 localhost:5080 建立与服务器的连接。有人知道我该如何解决这个问题吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T07:59:45.547

你用的是Red5的trunk，当前发布的版本还是别的。我们已经设置了 red5 快照的每晚构建，因此您无需编译源代码： [https ://builds.apache.org/view/MR/view/OpenMeetings/job/Red5%20Trunk/](https://builds.apache.org/view/M-R/view/OpenMeetings/job/Red5%20Trunk/)

...如果您只是想运行 Red5，也不需要 ant。

塞巴斯蒂安

# web-services - 列表项的 SharePoint 2010 Webservice GetListeItems 响应返回多个作者

> ID：13614957
> 
> 赞同：5
> 
> 时间：2012-11-28T21:44:29.673
> 
> 标签：web-services, sharepoint-2010, metadata

我正在使用 SharePoint Webservices 在文档库中创建一个文件，一切都很好。

现在我还需要覆盖创建者/修改者和日期，因此我在 SharePoint 服务器上创建了一个 SOAP 服务，该服务使用可以设置这些值的 listItem.UpdateOverwriteVersion()。当我在 SharePoint 中单击“查看属性”时，工作并且看起来不错。

现在到我的问题/问题，当我调用 GetListItems.asmx 再次查看文档（SOAP 服务）时，我最初创建它的作者仍然列在那里（我也看到我做了覆盖的那个）。

那为什么我会看到这个……好像我做了覆盖，但仍然保留原作者。

简而言之，为什么我会同时看到这两个：

vti_author:SR|TEST\tm（用于创建文档的用户）和 display_urn\:schemas-microsoft-com\:office\:office#Author:SW|TEST\Administrator（用户在覆盖时设置为新创建者）

SR 与 SW 的含义是什么？

我已粘贴“GetListItems”命令的完整项目响应

```
<z:row ows_ID="63" 
       ows_Title="Even NS 1.0" 
       ows_MetaInfo="63;#display_urn\:schemas-microsoft-com\:office\:office#Editor:SW|TEST\\Administrator
           vti_parserversion:SR|14.0.0.4762
           vti_folderitemcount:IR|0
           Order:DW|6300.00000000000Site / LocationTaxHTField0:SW|Singapore|dc0e351b-e873-453c-8d23-6b0e21b8360a
           Subject Matter Expert:IW|3
           vti_author:SR|TEST\\tm
           vti_modifiedby:SR|TEST\\tm
           _CopySource:SW|c:\\SharePoint Source\\Pdfs\\wicketBasic.pdf
           vti_foldersubfolderitemcount:IR|0
           TopicsTaxHTField0:SW|Molds|cddd6251-227d-4bb0-86aa-ff5ed715602f;Etiolog|63537636-fbdd-4071-8e1d-0c5cfcec84e3;Allergies|8ca11784-e48a-4d70-a22d-43a06f33f0a2
           Document Status:SW|Review
           display_urn\:schemas-microsoft-com\:office\:office#Author:SW|TEST\\Administrator
           ContentTypeId:SW|0x0101000FF13CC8F9D9B5408C6B72B560B15D6600C85CC76A22DB0D4298AC2D15EBF60842
           vti_title:SW|Even NS 1.0
           Topics:SW|9;#Molds|cddd6251-227d-4bb0-86aa-ff5ed715602f;#10;#Etiolog|63537636-fbdd-4071-8e1d-0c5cfcec84e3;#11;#Allergies|8ca11784-e48a-4d70-a22d-43a06f33f0a2 
           Site / Location:SW|8;#Singapore|dc0e351b-e873-453c-8d23-6b0e21b8360a
           TaxCatchAll:SW|10;#Etiolog|63537636-fbdd-4071-8e1d-0c5cfcec84e3;#9;#Molds|cddd6251-227d-4bb0-86aa-ff5ed715602f;#8;#Singapore|dc0e351b-e873-453c-8d23-6b0e21b8360a;#11;#Allergies|8ca11784-e48a-4d70-a22d-43a06f33f0a2
           display_urn\:schemas-microsoft-com\:office\:office#Subject_x0020_Matter_x0020_Expert:SW|TEST\\Administrator"
      ows__ModerationStatus="0" 
      ows__Level="1" 
      ows_Last_x0020_Modified="63;#2011-09-27 00:57:18" 
      ows_UniqueId="63;#{369FADAB-58E1-4C00-B279-6966D3FDB725}" 
      ows_owshiddenversion="5" 
      ows_FSObjType="63;#0" 
      ows_Created_x0020_Date="63;#2011-09-27 00:57:18" 
      ows_ProgId="63;#" 
      ows_FileLeafRef="63;#wicketBasic.pdf"
      ows_PermMask="0x7fffffffffffffff"
      ows_Modified="2011-09-27 00:57:18" 
      ows_FileRef="63;#Sync Source/wicketBasic.pdf"
      ows_DocIcon="pdf"
      ows_Editor="3;#TEST\Administrator"></z:row> 
```

# django - 用于字符串列表的 Django 表单字段

> ID：13614959
> 
> 赞同：10
> 
> 时间：2012-11-28T21:44:48.380
> 
> 标签：django, string, forms, list, django-forms

我需要一个**Django 表单字段**，它将获取一个字符串列表。

我将遍历这个列表并为每个字符串创建一个新的模型对象。

我不能做**Model Multiple Choice Field ，因为模型对象是在表单提交***之后*才创建的，我不能做**Multiple Choice Field**，因为我需要接受任意字符串，而不仅仅是一系列预先定义的选项。

有人知道怎么做吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-28T22:30:50.323

只需使用由逗号分隔的常规文本字段。在视图中处理表单提交后，根据该字段进行逗号字符串拆分。然后遍历每个创建并保存一个新模型。应该不会太难。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2022-02-09T12:21:55.070

在我的情况下，处理`forms.JSONField(decoder="array")`我`forms.py`在表单类中使用的字符串列表

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-11-29T18:23:25.363

我想出了一个解决方案——有点老套，但现在可以了。

获取表单数据后，我将列表存储在一个变量中：
`event_locations = form_data.get('event_locations', None)`

然后我从 form_data 中删除它，所以 Django 表单永远不会得到列表：

```
if event_locations:
   del form_data['event_locations'] 
```

我用 form_data 实例化我的表单，并分别处理列表：

```
f = NewEventForm(form_data)
...
for loc in event_locations:
  #create new models here 
```

我意识到这并不能直接解决我提出的问题，因为我们仍然没有 Django 表单字段来获取列表，但这是一种将列表传递给采用表单并能够处理它的视图的方法.

# sql - SELECT ... FOR UPDATE 和冲突插入

> ID：13614965
> 
> 赞同：1
> 
> 时间：2012-11-28T21:45:23.987
> 
> 标签：sql, select

我想插入一行，但如果发生冲突（下面的示例），我希望数据库锁定现有行，以便我可以记录其内容以进行调试。我正在使用`READ_COMMITTED`事务隔离。

例如：

```
CREATE TABLE users(id BIGINT AUTO_INCREMENT, name VARCHAR(30),
  count INT NOT NULL, PRIMARY KEY(id), UNIQUE(name));

Thread 1:
  INSERT INTO users(username, count) VALUES('joe', 1000);
  transaction.commit();

Thread 2:
  // Insert fails due to conflict with above record
  INSERT INTO users(username, count) VALUES('joe', 0);

  // Get the conflicting row and log its properties
  SELECT * FROM users WHERE username = 'joe'; 
```

如果冲突行没有被锁定，我检查的时候可能会被修改。`SELECT id FROM users WHERE username = 'joe' FOR UPDATE`我发现的唯一解决方法是在插入之前调用。**当没有发生冲突时，是否有可能在没有任何开销的情况下实现这一点？**

**更新**： 我**不是**要求避免冲突或结果`SQLException`。我只是要求锁定冲突的行，以便我可以查找哪些值触发了冲突。是的，我知道冲突记录包含`joe`但我想记录它的所有其他列。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T01:23:29.303

`UNIQUE`不，当使用`INSERT`具有唯一列的行时， 不可能消除列的冲突。

尝试编写永远不必处理 SQL 异常的 SQL 只是浪费精力，最终总是会创建在某些情况下失败的 SQL。

在处理实时多线程多用户数据库服务器时，异常处理是不可避免的，除非您有能力锁定表、执行更新和解锁表（这在许多负载过重时会产生糟糕的性能）用户）

`UNIQUE CONSTRAINT VIOLATION`例外总是在 2nd 发生，`INSERT`因为您的示例中的两个`INSERT`s 可能在时间上相距很远（例如，按小时、天或周）；表或行锁定不会改变这一点。

这个问题无论如何都应该在 GUI 级别解决，因为选择以前用户可能已经选择的“用户名”需要向“新”用户提供反馈，例如“对不起，该用户名已经在使用中由另一个用户”，因此看起来不太可能`UNIQUE VIOLATION`或应该“避免”处理异常。

此外，没有理由这样做`SELECT ... FOR UPDATE`，因为您需要做的就是`SELECT id WHERE name = newName`看看您是否得到结果`id`or `null`; (id == null) => 用户名未使用，但即便如此，两个用户也可以尝试同时获得“未使用”结果，其中一个`INSERT`仍然可能失败。

当`UNIQUE`对 duplicate 返回异常时`INSERT`，第二个`INSERT`已经失败并且没有创建该记录，因此没有“重复”记录要锁定，然后`UNIQUE`在 failed 上返回异常后读取`INSERT`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T19:06:06.160

您使用的是哪个版本的 SQL？我不确定我是否正确理解了您的问题，但我认为您可以在触发器中执行此操作。

在触发器中，您可以查看插入的值（您的冲突行）并记录它，并进行回滚。Wich 的意思是当你插入你的行时，当没有发生冲突时，你不必提交任何东西，而当发生冲突时，记录日志并且不插入行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-01T12:26:21.127

不，大多数数据库不支持这种操作。

你可以做一些技巧，比如创建一个显式事务

```
BEGIN TRANSACTION
IF EXIST(SELECT ...)
  ROLLBACK
INSERT INTO...
COMMIT 
```

但这并不是你想要的。实现您所要求的唯一方法是使用 B-TREE 样式库之一，它的级别要低得多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-06T21:41:24.113

似乎没有一种可移植的方式来执行此操作，并且查看[MVCC](https://stackoverflow.com/a/13675622/14731)有一个强烈的迹象表明，如果没有实质性的性能影响，这将无法实现。

所以总而言之：您将不得不接受知道发生了冲突，但无法 100% 确定原因（没有线程安全可验证）。

# javascript - 点击图片移动到前面？

> ID：13614966
> 
> 赞同：-1
> 
> 时间：2012-11-28T21:45:26.017
> 
> 标签：javascript, jquery, css

有人可以指出我正确的方向，以便我可以创建这样的功能[吗？](http://sawyerhollenshead.com/)

我想创建类似的东西，当您单击一堆图像中的图像时，它会将其带到前面。

好像找不到它的名字。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-28T21:48:18.213

```
$("img.myclass").click(function() {
     $("img.myclass").not(this).css("z-index", 0);
     $(this).css("z-index", 100);
}); 
```

应该可以帮助您入门

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T21:48:24.513

如果图像使用 定位`position: absolute`，您可以将 onclick 处理程序附加到它们并更改它们的`z-index`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T21:55:58.437

我会这样做，这样你就有了一个全局`zIndex`变量，你只需用最新的值 + 1 进行更新。

```
var zIndex = 0;
$('.myImageClass').click(function(){
  zIndex++;  
  $(this).css('zIndex', zIndex);
}); 
```

z-index 仅影响定位在静态以外的任何元素（例如：相对、绝对或固定）。

使用此方法，您将能够以任何您想要的顺序放置它们，而不是总是将其他所有内容恢复为默认值。

# sql - 我可以将 SQL Server Enterprise 镜像到标准吗？

> ID：13614967
> 
> 赞同：3
> 
> 时间：2012-11-28T21:45:30.190
> 
> 标签：sql, sql-server, sql-server-2012

我想在 2 个 SQL Server 副本之间设置镜像。主框是 SQL Server 企业版。

我可以将它镜像到 SQL Server 标准版吗？目的是节省一公吨的钱。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-28T21:52:39.300

来自[在线书籍](http://msdn.microsoft.com/en-us/library/ms366349.aspx/)：

> 主体服务器和镜像服务器这两个伙伴必须运行相同版本的 SQL Server。见证（如果有）可以在任何支持数据库镜像的 SQL Server 版本上运行。

话虽如此，只要您使用 TSQL 命令而不是 GUI，就可以进行设置。我永远不会推荐它，但它是可能的，只要您保证您没有使用任何企业功能。更多警告[HERE](http://blogs.msdn.com/b/ialonso/archive/2011/11/09/never-ever-set-up-a-database-mirroring-session-across-different-sql-server-editions-sku.aspx)和[HERE](http://social.msdn.microsoft.com/forums/en-US/sqldatabasemirroring/thread/979539fd-dfcd-4d6e-8f92-ca609a063deb//)。

最后一次编辑 - 显然这已在 SQL 2012 中完全被阻止。看起来你不走运。

# c# - C# 从字符串中删除第 n 项

> ID：13614972
> 
> 赞同：1
> 
> 时间：2012-11-28T21:45:41.083
> 
> 标签：c#, .net

我将如何删除（不仅仅是用 a 替换`' '`）字符串的第 n 个字符。假设我想`Hello World`输出`Hllo World`任何可以做到这一点的东西？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-28T21:49:10.127

使用 .Remove

```
var removed = s.Remove(1, 1); 
```

请注意，您不能更改字符串，您只能创建一个删除字符的新字符串。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T21:49:14.967

String 类有一个[remove](http://msdn.microsoft.com/en-us/library/system.string.remove.aspx)方法

```
var s = "abc".Remove(1,1); //will return ac 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T21:50:37.853

```
StringBuilder a = new StringBuilder("Hello World");
a.remove(1, 1); 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-11-28T22:10:04.080

```
string stringFlag = "ImAFlag";

var charList = stringFlag .Select(c => c.ToString()).ToArray();

charList.RemoveAt(0);

string newString = null;
foreach(var item in charList)
{
    newString += item.ToString();
} 
```

现在 stringFlag 是

```
"mAFlag" 
```

# scala - 带有 Gemfile 的 Ruby + Bundler 的 Scala + sbt 工作流程是什么？

> ID：13614974
> 
> 赞同：6
> 
> 时间：2012-11-28T21:45:50.960
> 
> 标签：scala, development-environment, sbt

我在学习 Scala 时玩得很开心，但我很难掌握如何设置开发环境。

# 在红宝石中

*   文件层次结构

    ```
    my_app/
      |
      +-- Gemfile
      +-- app.rb 
    ```

*   宝石文件

    ```
    source :rubygems
    gem "mechanize" 
    ```

*   应用程序.rb

    ```
    require "mechanize"
    agent = Mechanize.new
    page = agent.get("http://google.com") 
    ```

*   安装依赖并运行

    ```
    $ bundle install
    $ ruby app.rb 
    ```

# sbt 的 Scala 等价物是什么？

我正在阅读 sbt 以及包/导入/jar 依赖项如何在 Java/Scala 中工作，但我似乎无法过滤掉最基本的必需品。

*   用 Scala 复制上述内容的最小文件层次结构是什么？
*   这是 Maven 上可用的 Java Mechanize 库：[http ://search.maven.org/#search|ga|1|mechanize](http://search.maven.org/#search|ga|1|mechanize)
*   一旦你运行`sbt`并下载了 Mechanize 依赖项，你如何辨别`import`你需要让它工作的必要语句？

    ```
    val agent = new MechanizeAgent
    val page: HtmlDocument = agent.get("http://www.google.com") 
    ```

通过手动导入 .jars 然后从库中导入包，直到编译器/运行时错误停止并且代理工作，我在 Eclipse 中完成了上述工作。但那次经历令人沮丧，我来这里是为了悔改。

**这个问题的意图**：Java 生态系统/工作流程对我来说是压倒性的，因为我已经习惯了 Ruby 轻松、无 IDE 的工作流程。我认为一个简单的骨骼等价物会给我一个开始构建的地方。

理想情况下，我希望在依赖 Eclipse 之前只使用 Vim 和命令行进行 Scala 开发。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-28T22:32:40.527

sbt 使用名为 ivy 的库从主 maven 存储库导入项目。有一些 sbt 预配置的存储库可以使用，包括主 maven 存储库。

一旦这些库被“解析”（下载到您的计算机并连接到您的项目），eclipse 插件将为生成的 eclipse 项目中的每个 jar 创建依赖关系。

这是您配置它的方式。

**sbt 托管依赖**

[http://www.scala-sbt.org/release/docs/Getting-Started/Basic-Def.html#adding-library-dependencies](http://www.scala-sbt.org/release/docs/Getting-Started/Basic-Def.html#adding-library-dependencies)

在项目的 build.sbt 文件中添加依赖项。如果添加依赖于特定版本的 scala 的依赖项，请在组和工件名称之间使用两个 %%。不要忘记在 build.sbt 文件中的每个命令之间添加一个空行。

```
libraryDependencies += "com.gistlabs" % "mechanize" % "0.11.0"

libraryDependencies += "org.scalatest" %% "scalatest" % "1.6.1" % "test" 
```

通过运行 update 命令更新依赖项：

```
$ sbt update 
```

**sbt Eclipse 插件**

[https://github.com/typesafehub/sbteclipse/wiki/Installing-sbteclipse](https://github.com/typesafehub/sbteclipse/wiki/Installing-sbteclipse)

您可以通过在 ~/.sbt/plugins/plugins.sbt 创建一个文件并将此行放入其中来全局安装 sbt eclipse 插件：

```
addSbtPlugin("com.typesafe.sbteclipse" % "sbteclipse-plugin" % "2.1.0") 
```

每当您添加或更新依赖项时，运行以下命令并刷新您的 eclipse 项目：

```
$ sbt eclipse 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T19:21:59.960

我想比 ffk 的答案更进一步，做更多的手把手，并实际上提供 Ruby 示例到 Scala + sbt 的直接翻译。

*   文件层次结构

    ```
    Crawler/
      +- build.sbt
      +- src/
         +- main/
            +- scala/
               +- Crawler.scala 
    ```

*   构建.sbt

    ```
    libraryDependencies += "com.gistlabs" % "mechanize" % "0.11.0" 
    ```

*   爬虫.scala

    ```
    import com.gistlabs.mechanize.MechanizeAgent
    import com.gistlabs.mechanize.document.Document

    object Crawler extends App {
      val agent = new MechanizeAgent
      val page: Document = agent.get("http://google.com")
    } 
    ```

*   安装依赖并运行

    ```
    $ sbt run 
    ```

要使项目可导入 Eclipse 或 IntelliJ，您需要**sbteclipse-plugin**或**sbt-idea**插件。但是不必为每个新项目在每个 build.sbt 中声明这些插件，您可以在全局 build.sbt 中声明它们：

```
// in ~/.sbt/plugins/build.sbt
addSbtPlugin("com.typesafe.sbteclipse" % "sbteclipse-plugin" % "2.1.0")
addSbtPlugin("com.github.mpeltonen" % "sbt-idea" % "1.2.0") 
```

然后，回到 Scala 应用程序的根目录：

```
$ sbt eclipse
or
$ gen-idea 
```

之后，您应该能够在相应的 IDE 中打开它。

注意：每当您在 build.sbt 中添加依赖项时，您都需要重新运行`sbt eclipse`/`gen-idea`命令，以便 IDE 可以选择它。

# delphi - 包含控制台应用程序标准输出流的 Delphi Windows 服务

> ID：13614977
> 
> 赞同：1
> 
> 时间：2012-11-28T21:46:06.337
> 
> 标签：delphi, windows-services, console, stdout

过去，我使用该框架为 Delphi 编写了许多服务。我现在想用一些类似控制台的功能来扩展服务。

我可以提供的最简单的示例是，我想在命令提示符下运行类似以下内容的服务可执行文件。

```
> myservice.exe /version

MyService Version 1.0 
```

在项目文件中，我将在服务初始化之前处理参数并退出并完成。

```
If ParamStr(1) = '/version' then
begin
   writeln ('MyService Version 1.0');
   exit;
end;

// Other standard service launch code is after this for proper initialization
// when run as a service, i.e.
if not Application.DelayInitialize or Application Installing then 
... 
```

但是，要使`writeln`声明生效，通常我需要`{$APPTYPE CONSOLE}`项目文件中的指令，然后中断服务应用程序 Destroy 事件。

`{$APPTYPE CONSOLE}`是否有另一种方法可以在不使用Delphi Windows 服务应用程序的指令的情况下将标准输出连接到控制台？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:52:55.913

新的自己的控制台

```
begin

  if paramstr(1)='/?' then
    begin
      if Windows.AllocConsole then
      try
        WriteLn;
        // irgendeine sinnvolle Information, z.B.:
        WriteLn('Your Info');
        readln;
      finally
        FreeConsole;
      end;
    end

  else
     begin
     //Your Appcode 
```

或附加到控制台，而不创建自己的控制台

```
begin

  if paramstr(1) = '/?' then
  begin

    if AttachConsole($FFFFFFFF) then
    begin
      WriteLn('Your Info');
      Readln;
      FreeConsole; 
    end;
  end

  else
  begin
  // Your Appcode 
```

# crystal-reports - 详细级别的比率汇总字段 - Crystal Reports

> ID：13614979
> 
> 赞同：4
> 
> 时间：2012-11-28T21:46:17.507
> 
> 标签：crystal-reports, report, summary

我正在尝试找到一种方法来显示感兴趣字段与感兴趣字段总和的比率，并在行详细信息级别显示它。

名称： 利润： 利润比率：

* * *

ABC 1000 美元 10%

XYZ $5000 50%

NMO 2000 美元 20%

QST $2000 20%

* * *

总计 10000 美元

即 ABC 的利润比率 = 利润 / 总利润 = 1000 美元 / 10000 美元 = 10%

因为总计是在详细级别之后计算的，所以我无法理解如何在行详细级别的计算中“重用”摘要。我猜它与打印订单有关，但我无法理解它。

任何帮助将不胜感激谢谢B

PS水晶8.5版&老foxPro .dbf

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T05:06:43.027

这可以通过以下公式实现。

```
numbervar a;
a:=({Profit}/Sum ({Profit}))*100;
a; 
```

将此公式放在*详细信息*中，您将获得利润比率。

注意：确保字段*Profit*和*SumProfit*为数字数据类型，如果它们为字符串，则必须转换为数字。

试试这个并得到结果。准备进一步帮助您！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T13:05:52.633

将 Hariharan Anbazhagan 的回答更进一步。您可以使用这样的组和。

```
Sum({field},{group field}) 
```

# c# - C# 和 OpenSSL：AES 加密的不同输出

> ID：13614982
> 
> 赞同：4
> 
> 时间：2012-11-28T21:46:21.927
> 
> 标签：c#, openssl, aes

我正在尝试编写一个 C# 方法，该方法将吐出与 openssl 二进制文件相同的加密字符串（Base64），但我花了很多时间来匹配。

大量的终端输出和 C# 要遵循...：P

我们将使用非常令人兴奋的例子，用密码“123”加密字符串“a”。

**当我提供静态盐和密码时，首先**是 openssl（这是命令的理想运行方式，也是我希望 C# 输出匹配的内容）：

```
dev@magoo ~# echo -n a | openssl enc -aes-128-cbc -S cc77e2a591358a1c -pass pass:123 -a -p
salt=CC77E2A591358A1C
key=7B2AD689138A44AD32297BBAAA5B0EEE
iv =EC4F0416B2E9A9B2FEEF2E66FF982159
U2FsdGVkX1/Md+KlkTWKHOtnt1ftHSKyWiz6GxkBVck= 
```

**第二个**是openssl，当我提供我的静态盐时，以及从该盐派生的密钥和iv（来自第一个命令的输出的C + P'd）但没有密码（因为即使是文档也说这不是-好主意）：

```
dev@magoo ~# echo -n a | openssl enc -aes-128-cbc -S cc77e2a591358a1c -K 7b2ad689138a44ad32297bbaaa5b0eee -iv ec4f0416b2e9a9b2feef2e66ff982159 -a -p
salt=E85778B7FFFFFFFF
key=7B2AD689138A44AD32297BBAAA5B0EEE
iv =EC4F0416B2E9A9B2FEEF2E66FF982159
62e3V+0dIrJaLPobGQFVyQ== 
```

这让我觉得很奇怪。将第一个命令中“调试”输出（-p 参数）中的键和 iv 值添加到相同的盐，我不知何故得到了不同的盐！（CC77E2A591358A1C 与 E85778B7FFFFFFFF [这里的 0xff 的 4 个字节似乎很有趣]）。

**第三**是我的应用程序的输出：

```
dev@magoo ~# mono aestest.exe "a" "123"
==> INPUT     : a
==> SECRET    : 123
==> SALT      : cc77e2a591358a1c
==> KEY       : 7b2ad689138a44ad32297bbaaa5b0eee
==> IV        : ec4f0416b2e9a9b2feef2e66ff982159
==> ENCRYPTED : 62e3V+0dIrJaLPobGQFVyQ== 
```

因此，当我自己手动指定密钥和 IV（然后以某种方式生成不同的盐）时，C# 匹配 openssl 命令的输出，但这似乎是错误的。在我看来，C# 应用程序的输出应该与 OpenSSL 的第一组输出匹配，不是吗？

C#代码：

```
public static string EncryptString(string plainText, string password)
{
  byte[] salt = Encryption.GetStaticSalt();
  byte[] key, iv;

  Encryption.DeriveKeyAndIV(password, salt, out key, out iv);

  var amAes = new AesManaged();
  amAes.Mode = CipherMode.CBC;
  amAes.KeySize = 128;
  amAes.BlockSize = 128;
  amAes.Key = key;
  amAes.IV = iv;

  var icTransformer = amAes.CreateEncryptor();
  var msTemp = new MemoryStream();

  var csEncrypt = new CryptoStream(msTemp, icTransformer, CryptoStreamMode.Write);
  var sw = new StreamWriter(csEncrypt);
  sw.Write(plainText);
  sw.Close();
  sw.Dispose();

  csEncrypt.Clear();
  csEncrypt.Dispose();

  byte[] bResult = msTemp.ToArray();
  string sResult = Convert.ToBase64String(bResult);

  if (System.Diagnostics.Debugger.IsAttached)
  {
    string debugDetails = "";
    debugDetails += "==> INPUT     : " + plainText + Environment.NewLine;
    debugDetails += "==> SECRET    : " + password + Environment.NewLine;
    debugDetails += "==> SALT      : " + Encryption.ByteArrayToHexString(salt) + Environment.NewLine;
    debugDetails += "==> KEY       : " + Encryption.ByteArrayToHexString(amAes.Key) + " (" + amAes.KeySize.ToString() + ")" + Environment.NewLine;
    debugDetails += "==> IV        : " + Encryption.ByteArrayToHexString(amAes.IV) + Environment.NewLine;
    debugDetails += "==> ENCRYPTED : " + sResult;
    Console.WriteLine(debugDetails);
  }

  return sResult;
}

private static string ByteArrayToHexString(byte[] bytes)
{
  StringBuilder sbHex = new StringBuilder();

  foreach (byte b in bytes)
    sbHex.AppendFormat("{0:x2}", b);

  return sbHex.ToString();
}

public static byte[] GetStaticSalt()
{
  // Just random bytes.
  return new byte[]
  {
    0xcc,
    0x77,
    0xe2,
    0xa5,
    0x91,
    0x35,
    0x8a,
    0x1c
  };
}

// largely hijacked from http://stackoverflow.com/a/8011654/97423
public static void DeriveKeyAndIV(string password, byte[] bSalt, out byte[] bKey, out byte[] bIV)
{
  int keyLen = 16;
  int ivLen = 16;

  byte[] bPassword = Encoding.UTF8.GetBytes(password);

  using (var md5Gen = MD5.Create())
  {
    List<byte> lstHashes = new List<byte>(keyLen + ivLen);
    byte[] currHash = new byte[0];

    int preHashLength = bPassword.Length + bSalt.Length;
    byte[] preHash = new byte[preHashLength];

    Buffer.BlockCopy(bPassword, 0, preHash, 0, bPassword.Length);
    Buffer.BlockCopy(bSalt, 0, preHash, bPassword.Length, bSalt.Length);

    currHash = md5Gen.ComputeHash(preHash);
    lstHashes.AddRange(currHash);

    while (lstHashes.Count < (keyLen + ivLen))
    {
      preHashLength = currHash.Length + password.Length + bSalt.Length;
      preHash = new byte[preHashLength];

      Buffer.BlockCopy(currHash, 0, preHash, 0, currHash.Length);
      Buffer.BlockCopy(bPassword, 0, preHash, currHash.Length, password.Length);
      Buffer.BlockCopy(bSalt, 0, preHash, currHash.Length + password.Length, bSalt.Length);

      currHash = md5Gen.ComputeHash(preHash);
      lstHashes.AddRange(currHash);
    }

    bKey = new byte[keyLen];
    bIV = new byte[ivLen];

    lstHashes.CopyTo(0, bKey, 0, keyLen);
    lstHashes.CopyTo(keyLen, bIV, 0, ivLen);
  }
} 
```

我在这里错过了一些非常明显的东西，还是更微妙的东西？我环顾四周，看到了很多关于 C#、OpenSSL 和 AES 的信息，但对这个特定问题一无所知……所以，停顿了吗？;)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T17:39:24.633

如果您直接指定密钥和 IV，那么盐甚至不会发挥作用。需要 salt 才能使用密钥派生函数（在`EVP_BytesToKey`OpenSSL 的情况下为专有函数）将密码短语转换为密钥。因此，您可能会得到盐的无关紧要的输出。

现在 OpenSSL 在 1) 中的第一个输出包含一个标头（检查 ASCII 值:)、salt 和密文，这是十六进制的 base 64 字符串：

```
53616C7465645F5F CC77E2A591358A1C EB67B757ED1D22B25A2CFA1B190155C9 
```

您的应用程序 3) 和 2) 中的 openssl 命令都输出

```
EB67B757ED1D22B25A2CFA1B190155C9 
```

所以每一件小事似乎都很好。

# wordpress - 增强同一域 iFrame 的 SEO 的最佳方法是什么？

> ID：13614990
> 
> 赞同：4
> 
> 时间：2012-11-28T21:47:04.540
> 
> 标签：wordpress, iframe, seo, pyro

我公司的网站通过 PyroCMS 安装运行，该安装非常昂贵，但完全无法维护。另外，它是建立在一个不使用标签的平台上的，所以我们博客的 SEO 很差。

我已经在 Wordpress 上构建了博客的副本，并将 iframe 将其放入博客页面上的 Pyro 安装中。它们都托管在同一台服务器上，并且 wordpress 安装在 Pyro 安装中。

我的问题是：为了使用 iFrame 增强 SEO，我需要做什么？有没有更好的方法来做到这一点，我没有想到？基本上，有一些很好的文章正在写，我希望这些主题的利基性能够提高页面排名。

想法？谢谢。

〜乔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T20:34:32.717

看来您对这个网站有很多了解。

我最近（不到一个月前）签约了一个客户，他的网站建立在一个同样困难且非常古老的平台上。我们所做的是将博客设置为页面扩展 www.url.com/blog。该博客位于 WordPress 平台上，并且还添加了我们所有的插件（如果您愿意，我可以将您发送到这些插件的列表）。这样做有很多好处，主要有：

1.  博客 PR 值与主索引的权限相关联。
2.  您的索引因博客上写的所有内容而受到赞誉。

我告诉你的客户网站，他们的一些关键词已经在第 2 页上（即使网站本身并不好）。显然，我想说这不是因为他们正在排名的博客，但这是一个关键功能，因为谷歌希望看到您的网站在具有相关、独特​​、可共享内容的页面中增长。

不要忘记社交媒体和反向链接！如果您有任何其他问题，请告诉我，出于很多原因，请远离 iFrames...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T21:58:38.777

使用 iFrame 会阻碍您的 SEO 工作。重复内容也是如此（尽管在这种情况下重复内容可能不适用；我需要更多信息）。如果我是你，我不会采取这种策略。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-30T14:18:27.827

我已经看到 iframed 内容被编入索引，就好像它真的是它所在页面的一部分，但是你为自己创造了一场大规模的战斗。

使用 iframe 的最大问题之一是博客的每个页面看起来都在同一个 URL 上。试试吧。移动博客并检查地址栏。没变。

这意味着人们无法为您博客上的特定页面添加书签、链接或返回。非常糟糕的用户体验以及削弱您获取博客页面自然链接的能力。

还有其他问题，但这足以意味着不要将 iframe 用于博客。

答：为 iframe 增强 SEO，不要使用它。

为什么你觉得你首先需要一个 iframe。是否将网站设计包装在博客周围。如果是这种情况，请更新博客模板，使其自然地看起来像您网站的其余部分。

如果是因为您不喜欢该博客所在的域。移动它。

# c-preprocessor - C 预处理器递归宏

> ID：13614992
> 
> 赞同：10
> 
> 时间：2012-11-28T21:47:08.333
> 
> 标签：c-preprocessor

```
#define PP_ARG0_(arg0, ...) arg0
#define PP_REST_(arg0, ...) __VA_ARGS__
#define PP_ARG0(args) PP_ARG0_ args
#define PP_REST(args) PP_REST_ args

#define FUNCTION(name) void name();
#define FUNCTION_TABLE(...)                   \
    FUNCTION(PP_ARG0((__VA_ARGS__)))          \
    FUNCTION_TABLE(PP_REST((__VA_ARGS__)))    \ 
```

测试代码：

```
FUNCTION_TABLE(f1, f2,f3,testA,testB,testC); 
```

显然，由于递归扩展，它只会声明`void f1();` ，其余的不会被扩展：

```
void f1(); FUNCTION_TABLE(f2,f3,testA,testB,testC); 
```

在这种情况下，我可以使用什么样的技巧来实现递归扩展？问题是我需要支持许多参数（最多 100 个）而且我绝对不能使用 boost。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-06-07T22:59:23.540

最简单的解决方案是像这样使用序列迭代：

```
#define CAT(x, y) PRIMITIVE_CAT(x, y)
#define PRIMITIVE_CAT(x, y) x ## y

#define FUNCTION(name) void name();
#define FUNCTION_TABLE(seq) CAT(FUNCTION_TABLE_1 seq, _END)
#define FUNCTION_TABLE_1(x) FUNCTION(x) FUNCTION_TABLE_2
#define FUNCTION_TABLE_2(x) FUNCTION(x) FUNCTION_TABLE_1
#define FUNCTION_TABLE_1_END
#define FUNCTION_TABLE_2_END 
```

然后您`FUNCTION_TABLE`使用预处理器序列而不是可变参数调用：

```
FUNCTION_TABLE((f1)(f2)(f3)(testA)(testB)(testC)) 
```

这不仅简单得多，而且比使用递归解决方案（如您展示的解决方案或[此处](https://stackoverflow.com/a/10542793/375343)的解决方案）更快（即编译速度更快）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-30T00:50:47.950

如果有人想做同样的事情，这是答案。

```
#define _PP_0(_1, ...) _1            // (a,b,c,d) => a
#define _PP_X(_1, ...) (__VA_ARGS__) // (a,b,c,d) => (b,c,d)

//for each a in __VA_ARGS__ do f(a,x) 
//where x is some parameter passed to PP_TRANSFORM
#define PP_TRANSFORM(f,x,...) \
    PP_JOIN(PP_TRANSFORM_,PP_NARG(__VA_ARGS__))(f,x,(__VA_ARGS__))

#define PP_TRANSFORM_0(...)
#define PP_TRANSFORM_1( f,x,a) f(_PP_0 a,x) PP_TRANSFORM_0( f,x,_PP_X a)
#define PP_TRANSFORM_2( f,x,a) f(_PP_0 a,x) PP_TRANSFORM_1( f,x,_PP_X a)
...
#define PP_TRANSFORM_51(f,x,a) f(_PP_0 a,x) PP_TRANSFORM_50( f,x,_PP_X a)
...
#define PP_TRANSFORM_99(f,x,a) f(_PP_0 a,x) PP_TRANSFORM_98(f,x,_PP_X a)
#define PP_TRANSFORM_100(f,x,a)f(_PP_0 a,x) PP_TRANSFORM_99(f,x,_PP_X a) 
```

其中[`PP_NARG`](https://stackoverflow.com/a/2308651/468725)是计算参数数量的`PP_JOIN`宏，并且是连接标记的宏（即`PP_JOIN(a,b) => ab`）。`PP_NARG`如果您希望能够处理超过 64 个参数，您还需要修补它。

现在，回到最初的问题。使用的解决方案`PP_TRANSFORM`是：

```
#define FUNCTION(name, dummy) void name();
#define FUNCTION_TABLE(...) PP_TRANSFORM(FUNCTION,dummy,__VA_ARGS__) 
```

如果你想生成 c++ 实现函数，那么你可以使用不透明的 x 参数`PP_TRANSFORM`：

```
#define FUNCTION_CPP(name, class) void class::name(){}
#define FUNCTION_TABLE_CPP(...) PP_TRANSFORM(FUNCTION_CPP,MyClass,__VA_ARGS__) 
```

所有这些都适用于 GCC 和 MSVC 预处理器；PP_TRANSFORM_NN 不`__VA_ARGS__`用于避免 GCC 和 MSVC 的 100 个定义的单独实现

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-02-10T04:16:36.087

我真的很难理解这个序列迭代概念，但是将[上面的答案](https://stackoverflow.com/a/16994140/1599699)和[这里](https://stackoverflow.com/a/43997072/1599699)的答案拼凑在一起- 并且一点一点地完成它...... - 我相信我已经弄清楚了，以及如何解释和理解它.

* * *

这是一些友好的代码，我已经对其进行了调整：

*   重命名宏（我发现更合理地命名宏有助于我更好地理解这个过程）
*   如果需要通过提供可选的空参数选项。`__VA_OPT__`（如果不需要，可以删除该部分）
*   重新排列宏的顺序，以便它们与我当前的编译器 g++ 一起使用*（从技术上讲，这段代码是 c++，而不是 c，但这里基本上是一样的。）*
*   提供换出用于此递归过程的可变参数宏的能力

请注意，**必须**以格式`(() () ())`而不是指定参数`( , , )`，因为函数样式的宏依赖于它来处理任何参数。**请参阅下面的代码以获取深入的解释性演练。**

```
#include <iostream>

#define CONCAT(a, ...) a ## __VA_ARGS__
#define CONCAT_FUNC(a, ...) CONCAT(a, __VA_ARGS__)

//Whatever is inside each () will be prepended and appended with what's here.
#define MyVariadicMacro(...) << __VA_ARGS__ + 7 << " "
#define MyVariadicMacro2(...) << __VA_ARGS__ << " "

#define RESOLVE_A(...) __VA_OPT__(VARIADIC_FUNC(__VA_ARGS__)) RESOLVE_B
#define RESOLVE_B(...) __VA_OPT__(VARIADIC_FUNC(__VA_ARGS__)) RESOLVE_A
#define RESOLVE_A_END
#define RESOLVE_B_END
#define RECURSE(...) CONCAT_FUNC(RESOLVE_A __VA_ARGS__, _END)

int main()
{
  //Choose your own variadic macro, to provide what to prepend and append to each variadic argument!
  #define VARIADIC_FUNC MyVariadicMacro

  //Note: Empty ()'s are in here just to provide an example that they can be ignored via. __VA_OPT__().
  std::cout RECURSE(() (0) () (1) (2) (3) ());

  //Swapping out with variadic macro is being utilized for RECURSE.
  #undef VARIADIC_FUNC
  #define VARIADIC_FUNC MyVariadicMacro2

  std::cout RECURSE(() (0) () (1) (2) (3) ());

  #undef VARIADIC_FUNC

  return 0;
} 
```

`Output: 7 8 9 10 0 1 2 3`

```
//Starting with:
std::cout RECURSE(() (0) () (1) (2) (3) ());

//Apply: #define RECURSE(...) CONCAT_FUNC(RESOLVE_A __VA_ARGS__, _END)
std::cout CONCAT_FUNC(RESOLVE_A() (0) () (1) (2) (3) (), _END);

//Apply: #define CONCAT_FUNC(a, ...) CONCAT(a, __VA_ARGS__)
std::cout CONCAT(RESOLVE_A() (0) () (1) (2) (3) (), _END);

//Apply: #define CONCAT(a, ...) a ## __VA_ARGS__
std::cout RESOLVE_A() (0) () (1) (2) (3) () ## _END;

//Apply: #define RESOLVE_A(...) __VA_OPT__(VARIADIC_FUNC(__VA_ARGS__)) RESOLVE_B
//Note: Since the () is empty, the __VA_OPT__() part is simply skipped.
std::cout RESOLVE_B(0) () (1) (2) (3) () ## _END;

//Apply: #define RESOLVE_B(...) __VA_OPT__(VARIADIC_FUNC(__VA_ARGS__)) RESOLVE_A
std::cout VARIADIC_FUNC(0) RESOLVE_A() (1) (2) (3) () ## _END;

//Apply: #define MyVariadicMacro(...) << __VA_ARGS__ + 7 << " "
//Apply: #define VARIADIC_FUNC MyVariadicMacro
std::cout << 0 + 7 << " " RESOLVE_A() (1) (2) (3) () ## _END;

//Apply: #define RESOLVE_A(...) __VA_OPT__(VARIADIC_FUNC(__VA_ARGS__)) RESOLVE_B
//Note: Since the () is empty, the __VA_OPT__() part is simply skipped.
std::cout << 0 + 7 << " " RESOLVE_B(1) (2) (3) () ## _END;

//And so on... ending up with:
//Note: Ending with empty () or non-empty() doesn't matter; either way, we will end up with a RESOLVE_?_END.
std::cout << 0 + 7 << " " << 1 + 7 << " " << 2 + 7 << " " << 3 + 7 << " " RESOLVE_A() ## _END;

//Apply: #define RESOLVE_A(...) __VA_OPT__(VARIADIC_FUNC(__VA_ARGS__)) RESOLVE_B
//Note: Since the () is empty, the __VA_OPT__() part is simply skipped.
std::cout << 0 + 7 << " " << 1 + 7 << " " << 2 + 7 << " " << 3 + 7 << " " RESOLVE_B ## _END;

//Apply: ## simply concatenates.
std::cout << 0 + 7 << " " << 1 + 7 << " " << 2 + 7 << " " << 3 + 7 << " " RESOLVE_B_END;

//Apply: #define RESOLVE_B_END
//Note: In this particular case, we happened to end up with RESOLVE_B_END; in other cases, we will end with
//RESOLVE_A_END.
std::cout << 0 + 7 << " " << 1 + 7 << " " << 2 + 7 << " " << 3 + 7 << " ";

//Etc.
std::cout << 7 << " " << 8 << " " << 9 << " " << 10 << " "; 
```

* * *

注意：如果你想使用`RECURSE`X-macro 概念，你必须做一些额外的事情。X-macro 的问题是你会像这样定义它以便在递归宏中使用：

```
#define MyThing (() (0) () (1) (2) (3) ()) 
```

当你去使用它时，无论是通过。`RECURSE()`或任何其他宏，它包含在一些额外的括号中：

```
//It interprets this as RECURSE((() (0) () (1) (2) (3) ())), which is bad.
std::cout RECURSE(MyThing); 
```

解决方案是使用这样的宏，并让它自然解决删除括号。这是一个为此修改的示例`RECURSE()`：

```
#define ESCAPE_PAREN(...) __VA_ARGS__

//Old RECURSE():
#define RECURSE(...) CONCAT_FUNC(RESOLVE_A __VA_ARGS__, _END)

//New RECURSE():
#define RECURSE(...) CONCAT_FUNC(RESOLVE_A ESCAPE_PAREN __VA_ARGS__, _END)

//Alternatively, just use this instead of RECURSE() (seems to work better):
#define RECURSE_ESCAPE(...) ESCAPE_PAREN __VA_ARGS__ 
```

这里需要注意的重要一点是，`ESCAPE_PAREN`使用时不会将 in 换`__VA_ARGS__`行`()`。

* * *

编辑：我尝试在实际项目中使用它们后更新了上述宏。我还添加了一些其他可能有用的相关宏（`RECURSE_FIRST`（仅通过第一个条目），`RECURSE_LATTER`（仅在第一个条目之后通过后面的条目）及其`_ESCAPE`版本，以及`RECURSE_SPLIT`（通过第一个条目，应用`VARIADIC_FUNC_FIRST()`宏在那，只通过后面的条目，`VARIADIC_FUNC()`在这些条目上应用宏，再次通过第一个条目，在上面应用`VARIADIC_FUNC_END()`宏，然后将所有这些连接在一起......））：

```
//#define ESCAPE_PAREN(...) __VA_ARGS__

#define RESOLVE_A(...) __VA_OPT__(VARIADIC_FUNC(__VA_ARGS__) RESOLVE_B)
#define RESOLVE_B(...) __VA_OPT__(VARIADIC_FUNC(__VA_ARGS__) RESOLVE_A)
#define RECURSE(...) RESOLVE_A __VA_ARGS__
//#define RECURSE_ESCAPE(...) RECURSE(ESCAPE_PAREN __VA_ARGS__)

#define RESOLVE_FIRST(...) __VA_OPT__(VARIADIC_FUNC(__VA_ARGS__) DISCARD_A)
#define RESOLVE_LATTER(...) RESOLVE_B
#define DISCARD_A(...) __VA_OPT__(DISCARD_B)
#define DISCARD_B(...) __VA_OPT__(DISCARD_A)
#define RECURSE_FIRST(...) RESOLVE_FIRST __VA_ARGS__ ()
#define RECURSE_LATTER(...) RESOLVE_LATTER __VA_ARGS__ ()

#define RESOLVE_SPLIT_FIRST(...) __VA_OPT__(VARIADIC_FUNC_FIRST(__VA_ARGS__) DISCARD_A)
#define RESOLVE_SPLIT_END(...) __VA_OPT__(VARIADIC_FUNC_END(__VA_ARGS__) DISCARD_A)
#define RECURSE_SPLIT(...) RESOLVE_SPLIT_FIRST __VA_ARGS__ () RESOLVE_LATTER __VA_ARGS__ () RESOLVE_SPLIT_END __VA_ARGS__ () 
```

在我的宏中尝试使用逗号和分号时，我发现这些麻烦/抑制要少得多......它们当然就像上面一样工作，您可以使用以下形式的 X-宏：

```
MyXMacro((a) (b) (57) (32))
MyXMacro((c) (d) (49) (32)) 
```

* * *

也可以看看：

*   [https://en.wikipedia.org/wiki/C_preprocessor](https://en.wikipedia.org/wiki/C_preprocessor)
*   [https://en.wikipedia.org/wiki/Variadic_macro](https://en.wikipedia.org/wiki/Variadic_macro)
*   X-macros，一个非常强大的工具：
    *   （本文展示了一种比您通常看到的更简洁的方式：）[https://quuxplusone.github.io/blog/2021/02/01/x-macros](https://quuxplusone.github.io/blog/2021/02/01/x-macros)
    *   [https://en.wikipedia.org/wiki/X_Macro](https://en.wikipedia.org/wiki/X_Macro)

# python - GAE 错误 204 - 这是什么意思我该如何避免它？

> ID：13614996
> 
> 赞同：2
> 
> 时间：2012-11-28T21:47:22.363
> 
> 标签：python, google-app-engine, google-cloud-datastore, cloud, app-engine-ndb

我收到一个空白屏幕，日志中显示以下警告消息：

```
A problem was encountered with the process that handled this request, 
causing it to exit. This is likely to cause a new process to be used for
the next request to your application. (Error code 204) 
```

我没有其他事情可以继续。我正在大量使用 tasklet (@ndb.tasklet)、异步数据存储操作和异步 urlfetches（它是一个搜索引擎）。根据 appstats，例如，我将 15 分钟的处理时间缩短为 15 秒。如果我处理较少的数据，它会起作用。如果我处理更多它会失败并显示上述警告。实例选项卡仅显示一次实例。我的直觉是我正在超载该实例。

我认为额外的实例会自动启动以支持额外的负载 - 尽管实例可能只响应请求而不是 CPU / 内存负载？当我启动三个不同的页面时，三个不同的实例也会启动。问题是每个请求都需要大量处理。

我可以使用任务队列来定位后端实例，但我需要知道任务何时完成并返回结果。不幸的是，任务队列[无法监控给定任务何时完成](https://stackoverflow.com/questions/13504389/determine-if-a-task-has-been-deleted-gae-python)。

我如何（并且应该）显式地跨实例拆分处理？还有其他解决方案吗？如何避免 204 错误消息？

编辑：我提高了我的递归限制：

```
sys.setrecursionlimit 
```

当我对此发表评论时，我收到以下错误：

```
RuntimeError: maximum recursion depth exceeded 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T15:12:24.847

递归限制让我认为您将同步操作与异步操作混合在一起。尝试只使用异步操作和产量，而不是 get_result()。或者向我们展示一些（真实的）代码。

特别是，提高递归限制最终会导致 C 级堆栈溢出，这很可能导致进程被内核毫不客气地杀死。在这种情况下，日志也会丢失。在你提高递归限制之前，你得到了什么样的堆栈跟踪？是大约 1000 个条目，还是只有几十个？如果是后者，您肯定会遇到混合同步和异步操作的问题。

请注意，有两种形式的同步操作，在 tasklet 中的任何地方（以及它调用的任何东西！）都应避免使用：同步调用，如 ent.put()、key.get()；和异步调用，然后是 get_result() 调用，例如 ent.put_async().get_result()。

# excel - 根据搜索键 VBA 删除行

> ID：13614997
> 
> 赞同：2
> 
> 时间：2012-11-28T21:47:31.613
> 
> 标签：excel, vba

我正在尝试使用 VBA 删除在 B 列中找到值“X”的**每一行。**但是，我遇到了三个问题：

1.  我无法使用 cells.find 方法让我的 VBA 代码从活动单元格向下移动到下一个单元格 (B3)（请参见下面的代码）
2.  我的代码不会删除在 B 列中找到值“X”的整行
3.  B 列中的数据量可能会有所不同：它可以在今天的 B10 或明天的 B100 结束（见下面的屏幕截图）

任何帮助将不胜感激。

```
Sub RemoveRows()   
    Dim strLookFor As String
    Dim strRow As String

    Worksheets("Sheet1").Range("B2").Activate

    strLookFor = "X"
    strRow = Range("B2").Address

    Do Until ActiveCell.Value = ""        
        MsgBox (ActiveCell.Value)        
        If ActiveCell.Value = strLookFor Then
            Rows.Delete (strRow)
        End If            
        strRow = Cells.Find(what:=strLookFor).Address
    Loop

    MsgBox ("Deleted all rows with value " & strLookFor)    
End Sub 
```

![在此处输入图像描述](../Images/06a9b6eb7c3ecc167cfa5fb531a47765.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-29T02:22:14.667

使用 an`AutoFilter`比 range 循环更有效

```
Sub QuickCull()
Dim ws As Worksheet
Dim rng1 As Range
Set ws = Sheets("Sheet1")
Set rng1 = ws.Range(ws.[b2], ws.Cells(Rows.Count, "B").End(xlUp))
Application.ScreenUpdating = False
With ActiveSheet
        .AutoFilterMode = False
        rng1.AutoFilter Field:=1, Criteria1:="X"
        rng1.Offset(1, 0).EntireRow.Delete
        .AutoFilterMode = False
    End With
Application.ScreenUpdating = True
End Sub 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T21:56:54.870

```
dim x as long
dim r as long
dim sht as worksheet

set sht = Worksheets("Sheet1")
r = sht.Cells(rows.count,2).end(xlup).row 

for x = r to 2 step -1
    with sht.cells(x,2)
        if .value = "X" then .entirerow.delete
    end with 
next x 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-28T21:56:32.857

这应该有效：

```
Sub DeleteRowsWithX()

maxRow = ActiveSheet.UsedRange.Rows.Count

For i = 1 To maxRow
    Do While (StrComp(ActiveSheet.Cells(i, 2).Text, "X", vbTextCompare) = 0)
        Rows(i).Select
        Selection.Delete Shift:=xlUp
   Loop
Next

End Sub 
```

# c - 如何在c中递归地将字符串反转为空字符串

> ID：13614998
> 
> 赞同：0
> 
> 时间：2012-11-28T21:47:42.300
> 
> 标签：c, recursion

我的作业有这个问题。我应该将一个字符串递归地反转为另一个空字符串。问题是该函数修改了它不应该做的源字符串，只是将字符串向后复制到目标字符串。我不明白为什么会这样……

```
#include <stdio.h>
#include <string.h>

void
invert(const char *src, char dest[])
{
    if(*src=='\0')
        return;
    else
    {
        invert(src+1, dest);
        dest[strlen(src)-1]=*src;
    }
}

int main(int argc, const char * argv[])
{
    char dest[]="";
    char src[]="";
    printf("write a word: \n");
    scanf("%s", src);
    invert(src, dest);
    dest[strlen(src)]='\0';
    printf("the inversion of the word is: %s\n", dest);
    return 0;
} 
```

例如：写作 Ulysses => sessesU 和写作 Jones => seesJ\377

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-28T21:50:13.083

问题在这里：

```
char dest[]="";
char src[]=""; 
```

你分配了两次一个字符 - 变量可能在堆栈上彼此相邻，这就是为什么写入一个错误地覆盖另一个的内容。

您应该为字符串分配足够的存储空间。如果您确定程序的输入永远不会超过例如 1023 字节，那么两个 1k 缓冲区应该是好的：

```
char src[1024], dest[1024]; 
```