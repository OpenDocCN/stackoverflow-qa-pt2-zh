# StackOverflow 问答 14898000-14898999

# c++ - 在 XCode 4.6 中启用 OpenMP 支持

> ID：14898003
> 
> 赞同：2
> 
> 时间：2013-02-15T15:33:03.540
> 
> 标签：c++, xcode, openmp

我目前使用的是最新版本的`XCode`ie `4.6`，并且在启用 OpenMP 时遇到了麻烦。`Enable OpenMP Support`我在构建设置中没有看到任何诸如“”之类的选项。我正在使用支持 C++11 的标准库`Apple LLVM Compiler 4.2`。`libc++ LLVM C++`任何帮助，将不胜感激..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-09T18:37:40.203

在构建设置中，我将“C/C++/Objective-C 编译器”更改为“LLVM GCC 4.2”

然后，在“LLVM GCC 4.2 - 语言”设置下，您可以选择启用 OpenMP。我还没有测试编译真实代码，但至少“#include”现在可以工作了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-27T11:47:53.190

较早的用户说得对，但他错过了一件事，这就是他不能包含“omp.h”的原因，您必须在“库搜索路径”选项中提及库的路径。否则编译器无法自动定位。所以步骤如下：

1.  在构建设置中，我将“C/C++/Objective-C 编译器”更改为“LLVM GCC 4.2”
2.  然后，在“LLVM GCC 4.2 - 语言”设置下，您可以选择启用 OpenMP。
3.  在“Headers Search Paths”中，添加“omp.h”文件的位置。
4.  现在你完成了

复制以下代码并享受：

```
int main(int argc, char **argv) { 
    omp_set_num_threads(8);
    int iter;
    int NCOUNT = 100000000; 
#pragma omp parallel for
    for(iter = 0; iter < NCOUNT; iter++)
    {
        printf("OMP: Hello World, %d times\n", iter);
    } 
    return 0;
} 
```

注意：对于我的 MAC 计算机，我在“/usr/llvm-gcc-4.2/lib/gcc/i686-apple-darwin11/4.2.1/include”中找到了“omp.h”文件，可能会有所不同对于您的情况，但我确信它必须在“/usr/..”中，所以只需使用“查找”操作来定位特定文件。请注意，“/usr”是您 MAC 系统中的隐藏文件夹，因此您必须激活系统才能显示隐藏文件和文件夹。

# unit-testing - Visual Studio 2012 中的规范流错误

> ID：14898006
> 
> 赞同：10
> 
> 时间：2013-02-15T15:33:12.197
> 
> 标签：unit-testing, selenium, visual-studio-2012, specflow, build-error

我正在使用 selenium、Specflow 和 nUnit 来运行 Visual Studio 的自动化测试。该代码与 Visual Studio 2010 一起使用。在我再次安装 Visual Studio 2012、Selenium 和 Specflow 之后（我认为我做对了），它停止了工作。首先，这些步骤无法识别它们的定义，我想我在所有包含它们的定义的 c# 文件中编写 [Binding] 来修复它。现在，当我尝试构建项目时，它会显示一个我无法解决所有功能文件的错误。

它显示了 50 个错误（与我拥有的 Specflow 功能文件数量相同），它们都是相同的，并且它说：

`Error: Generation error: SpecFlow configuration error -> The element <unitTestProvider> may only appear once in this section`.

我不知道如何解决这个问题。我希望有人能帮助我，因为这个我真的很担心。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-03-18T06:20:05.397

在app.config中**只**保留一个**属性**`unitTestProvider name="SpecRun"``unitTestProvider name="NUnit"`

 **这个错误是由**app.config 中的****两个** `'unitTestProviders'`引起的。

 *** * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-10T03:16:12.163

在我安装-Package SpecRun.SpecFlow -Version 1.2.0 之后，

我在 app.config 中有 2 个条目 unitTestProvider name="SpecRun" 和 unitTestProvider name="NUnit"，这导致了错误。

应该手动改成合一

```
 <unitTestProvider name="SpecRun+NUnit" /> 
```****

# https - VideoView.setVideoURI() 不接受 HTTPS

> ID：14898008
> 
> 赞同：1
> 
> 时间：2013-02-15T15:33:16.163
> 
> 标签：https, android-videoview, google-tv

this.videoView.setVideoURI(Uri.parse(url+"&ext=.m3u8"));

呼叫永远不会到达服务器。使用 http 一切正常。在所有其他 Android 设备 (!=Google TV) 上，HTTPS 也可以正常工作。

该网址具有以下格式：

[https://example.com/index.php?videoId=3&sessionId=xxxxxxxxxxxxxxxxxxx&ext=.m3u8](https://example.com/index.php?videoId=3&sessionId=xxxxxxxxxxxxxxxxxxx&ext=.m3u8)

这是一个 PHP 脚本，它将返回一个 m3u8 HLS 文件。但是服务器甚至从未被调用过。

如果我删除 '&ext=.m3u8' 部分，这也是一样的。

证书不是自签名的。应用程序对 HTTPS 服务器的其他调用成功，没有问题。

编辑：错误也没有帮助。0/0（什么/额外）我正在使用带有 Android GoogleTV 3.2 的 Sony NSZ-GS7

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T03:32:54.893

上面有两个问题，1）我们的 HLS 播放器不接受 HTTPS，它需要 .m3u8 之前？（即 .php 是不可接受的）

我不确定我是否会接受 Krispy 的建议，除非辅助文件 .m3u8 和 .ts 不使用 https。当然，您可以在您的应用程序中构建一个驻留在电视上的小型代理，并使用 https 中继 https 请求。

# java - 从不同类中的文件读取和写入，而无需在 java 中关闭流

> ID：14898014
> 
> 赞同：0
> 
> 时间：2013-02-15T15:33:52.600
> 
> 标签：java, file, stream, dataoutputstream

嘿大家:] 只是想知道是否可以在不同类中读取和写入文件而不必关闭流并重新开始？

我需要使用`DataOutputStream`和`DataInputStream`。我目前有 2 个类，我的第一个类应该将所有对象写入文件。取决于它是什么类型的对象。我会将对象发送到另一个类，它将继续写入。

问题是我要么在流关闭之前只写 1 个对象，我不能继续写下一个对象，要么每个对象都会覆盖最后一个对象。

```
 public int skrivTilFil( String filnavn)
  {
      try{DataOutputStream input = new DataOutputStream(new FileOutputStream(filnavn)))
      {
          Bok løper = første;
          {
              while(løper != null)
              {
                  if(løper instanceof Skolebok)
                  {
                      Skolebok bok = (Skolebok) løper;
                      bok.skrivObjektTilFil(input);
                  }

                  løper = løper.neste;
              }
          }
      }
  }

public void skrivObjektTilFil(DataOutputStream output) // skolebok class
         {
             try
             { 
                            output.writeUTF("Skolefag");
                output.writeInt(klassetrinn);
                output.writeUTF(skolefag);
                super.skrivObjektTilFil(output);
             }catch(IOException e)
             {               
                            System.out.println("General I/O exception: "
                            e.getMessage());e.printStackTrace(); 
                        }
         } 
```

在这里我会得到`IOException`，因为流已关闭，所以我不能继续下一个对象，但如果我`DataOutputStream`在第二类中设置，我将覆盖每个对象。这个问题有简单的解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T16:06:13.363

您需要**附加**到`FileOutputStream`.

您应该修改它的创建，如下所示：

```
...                                                                           
try{DataOutputStream input =                                  //append
            new DataOutputStream(new FileOutputStream(filnavn,true)))
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T16:47:19.950

您可以将 DataOutputStream 从一个类/方法传递到另一个类/方法，就像传递任何其他对象一样。只要它没有关闭，您就可以继续从您传递的任何类/方法中写入它。作为最佳实践，负责打开 DataOutputStream 的类应该负责关闭它。

# html - CSS活动链接不起作用

> ID：14898015
> 
> 赞同：10
> 
> 时间：2013-02-15T15:33:54.867
> 
> 标签：html, css

所以我有一个导航栏。使用 Zurb 构建：

```
<div class="seven columns navigation" id="navigation">
    <a href="#">Page1</a>
    <a href="#">Page2</a>
    <a href="#">Page3</a>
    <a href="#">Page4</a>
    <a href="#">Page5</a>
 </div> 
```

悬停时，导航会更改背景颜色。那很简单。但是，如果链接处于活动状态，我无法让背景保持不变。因此，如果您在 page1 上，它将保持蓝色背景。

这是我到目前为止尝试过的 CSS。

```
.navigation a {
  font-size: 1.2em;
  display: inline-block;
  margin-top: 20px;
  padding: 8px 12px;
  color: #666666;
  font-weight: bold; }

.navigation a:hover{
  background: #29abe2;
  color: #fff;
  border-radius: 5px; }

.navigation a.active{
  background: #29abe2;
  color: #fff;
  border-radius: 5px; }

#navigation a .active-link{
  background: #29abe2;
  color: #fff;
  border-radius: 5px; } 
```

不起作用，我用谷歌搜索了这个负载，但都说活动链接应该工作？

谁能告诉我哪里出错了？对不起，如果它的简单 CSS 不是我最强的语言。

编辑：

感谢您的建议，但是

```
.navigation a:active{
  background: #29abe2;
  color: #fff;
  border-radius: 5px; } 
```

也不行。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-15T15:37:06.387

我看到这里有一个错误，应该是`:active`而不是`.active`，所以替换：

```
.navigation a.active {
  background: #29abe2;
  color: #fff;
  border-radius: 5px;
} 
```

和：

```
.navigation a:active {
  background: #29abe2;
  border-radius: 5px; 
  color: #fff;
} 
```

* * *

否则，如果您谈论的是每个页面都具有活动状态，那么您编写的 CSS 是正确的。在您的 HTML 中，您需要添加以下内容：

```
<div class="seven columns navigation" id="navigation">
  <a href="#" class="active">Page1</a>
  <a href="#">Page2</a>
  <a href="#">Page3</a>
  <a href="#">Page4</a>
  <a href="#">Page5</a>
</div> 
```

现在，该特定链接将显示为活动状态。如果您使用 HTML，则必须为每个页面完成，或者如果您使用 PHP 之类的东西，则可以使用编程来完成。所以，在 PHP 中同样的事情是：

```
<div class="seven columns navigation" id="navigation">
  <a href="#"<?php if ($page == 1) echo ' class="active"'; ?>>Page1</a>
  <a href="#"<?php if ($page == 2) echo ' class="active"'; ?>>Page2</a>
  <a href="#"<?php if ($page == 3) echo ' class="active"'; ?>>Page3</a>
  <a href="#"<?php if ($page == 4) echo ' class="active"'; ?>>Page4</a>
  <a href="#"<?php if ($page == 5) echo ' class="active"'; ?>>Page5</a>
</div> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T15:44:23.487

你不能用纯 CSS 做你想做的事。首先，您必须定义当用户在该页面上时用于链接的类（就像您所做的那样，但您有错字）：

```
.navigation a.active-link {
      background: #29abe2;
      color: #fff;
      border-radius: 5px; 
} 
```

接下来，您需要在用户访问该页面时将该类应用于链接。因此，如果我在第 1 页，导航将如下所示：

```
<div class="seven columns navigation" id="navigation">
    <a href="#" class="active-link">Page1</a>
    <a href="#">Page2</a>
    <a href="#">Page3</a>
    <a href="#">Page4</a>
    <a href="#">Page5</a>
 </div> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-15T15:44:29.213

`a:visited`实际上是您的“.active”状态。对于导致您想知道发生了什么的效果。

`a:`如果您要尝试以这种方式使用它，则必须将它包含在您的伪类中。

为您的元素建立“默认/重置”状态`<a>`将防止这种类型的“WTF？” 场景：

```
a:link { color:black }
a:hover { color:blue }
a:visited, a:active, a:focus { color:red } 
```

当您希望特定链接在其相应页面上显示“突出显示”时，您最好使用 ID 或类（取决于您的使用情况）：

```
<a id="highlight">Home</a>
<a>About</a>
<a>Contact</a> 
```

**编辑**

再读一遍你的问题。由于和`#navigation a .active-link{...`之间的空间，不适合您。您实际上是针对类名为. 修复 #1 将是.`a``.active-link``a``active-link``a.active-link`

忽略您在上面阅读的有关 PHP、Targeter 等的内容。您似乎只是想让您的导航“突出显示”/更改与导航中的链接匹配的页面。您可以使用直接的 HTML/CSS 轻松完成此操作（如果您对此有疑问，服务器端代码解决方案只会让您更加沮丧）。请参阅我的答案中的三个`<a>`要素。然后将其添加到您的 CSS（修复 #2）：

```
a#highlight { color:red } 
```

我相信您的混乱都是使用与 CSS 中的“保留”名称太接近的类名称的产物（因此您错过了 a.active 与 a:active ——即使两者都是有效的，但很容易错过你正在校对你的代码）。（修复＃3）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-15T16:10:27.070

要仅通过 CSS 技巧解决此问题，您需要使用 Selector Target，首先为页面分配不同的 id 并将链接放置到该引用，然后根据目标 ID 更改样式。

这是[仅使用 CSS 和 HTML 的解决方案的 JS Fiddle](http://jsfiddle.net/hRxr2/1/)

但本质上它是这样工作的：

这是您的 id 和目标更改的 HTML

```
<div class="seven columns navigation" id="navigation">
    <a href="#page1" id="page1">Page1</a>
    <a href="#page2" id="page2">Page2</a>
    <a href="#page3" id="page3">Page3</a>
    <a href="#page4" id="page4">Page4</a>
    <a href="#page5" id="page5">Page5</a>
</div> 
```

毕竟，您需要根据目标更改样式，如下所示：

```
#page1:target, #page2:target, #page3:target, #page4:target, #page5:target{
  background: #29abe2;
  color: #fff;
  border-radius: 5px;
} 
```

这行得通，但通常是使用服务器端，例如 ruby​​ on rails、python、php，任何你觉得舒服的语言都可以提供准确的 url 并使用简单的 jQuery [.addClass()](http://api.jquery.com/addClass/)或[.removeClass()](http://api.jquery.com/removeClass/)或甚至[.toggleClass()](http://api.jquery.com/toggleClass/)将活动类放在正确的链接上。

希望能帮助到你！干杯

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-02-28T13:55:29.737

更好地在 jQuery 中使用以实现浏览器兼容性

```
<script type="text/javascript" src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
<script type="text/javascript">
  $( document ).ready(function() {
    var urlArray = window.location.pathname.split( '/' );
    var pagAtual =urlArray[urlArray.length -1];
    $("a[href*="+pagAtual+"]").css("color","#67E8A7");
  });
</script> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-09-01T19:17:09.853

Try to replace .navigation with #navigation, there is id="navigation",not a class.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-15T15:47:38.567

您将需要创建一个活动类，然后手动将其分配给导航栏中的链接。

HTML + CSS 不知道他们在哪里，不能去哪里

> “好吧，我在 article.html 上，所以我会激活文章链接。”

因此，当您在该页面上时，您需要使用 javascript 或一些编程语言（如 python、php、asp 等）为正确的链接分配一个类，例如使用服务器端语言动态构建导航。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-03-27T15:00:42.693

我知道这是旧的，但是我在更改活动链接的颜色时遇到了问题，并且在太久之后意识到因为我在测试时在本地托管站点，所以某些路径当然不一样，并且相应的链接也不是实际活跃。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-08-10T11:08:56.863

我遇到了同样的问题，但我通过以下方式解决了它，**但有些事情很奇怪**：

app.component.html**文件**：

```
 <div class="container">
      <nav class="navbar" >
        <form class="form-inline">
          <a routerLinkActive="active" routerLink="list">List</a>
          <a routerLinkActive="active" routerLink="create" 
             style="padding-left: 20px;">Create</a>
        </form>
      </nav>
      <router-outlet></router-outlet>
    </div> 
```

app.component.css**文件**：

```
 /* unvisited link */
    a.link {
      color: blue;
    }

    /* selected link */
    a.active {
      color: hotpink;
    }

    /* visited link (This doesn't work well, so I don't use it in my app)*/
    a.visited {
      color: green;
    }

    /* mouse over link */
    a:hover {
      color: red;
    } 
```

[![在此处输入图像描述](../Images/84ed1dbedbd9f344f0eeae9928654cff.png)](https://i.stack.imgur.com/oDhBe.png)

**奇怪的事情：**

1.  对于**活动链接颜色**，**“a.active”**有效，而**“a:active** ”**无效**；

2.  对于**悬停颜色**，**“a:hover”**有效，而**“a.hover** ”**无效**。

3.  对于**访问的链接颜色**，如果我使用**"a:visited"**，其他颜色将被**禁用**。

还有一些其他的情况，但细节太多了。

我花了很长时间才弄清楚。

顺便说一句，**routerLinkActive="active"**是必要的。我只是为了测试它而摆脱它，但它没有用。所以我把它放回去了，然后它工作得很好。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-12-26T09:50:24.923

在其他新闻中，`:action`如果您有`event.preventDefault()`on *mousedown*事件，也会被取消。

但是，这不适用于*click*和*mouseup*事件，您可以在不取消 :action 行为的情况下对它们使用 preventDefault() 。我没有测试触摸事件，但我认为情况相同。

# spring - EJB 的 JNDI 查找和存储以供将来调用

> ID：14898016
> 
> 赞同：0
> 
> 时间：2013-02-15T15:33:57.520
> 
> 标签：spring, jakarta-ee, ejb-3.0, java-ee-6, jndi

我浏览了链接 [https://docs.jboss.org/author/display/AS71/JNDI+Reference](https://docs.jboss.org/author/display/AS71/JNDI+Reference)

当我们进行传统 JNDI 查找时，我们首先获取远程接口的存根对象，然后进行另一个网络调用以进行实际的 EJB 调用。这已被列为 2 个网络调用。

我想弄清楚是否有什么方法可以让我们只获取一次存根对象的单例存储，然后使用它来进行后续调用？我不是 RMI 细节方面的专家，但只要存根可用，我们就应该能够使用它……不是吗？

基本上是在寻找任何 Spring 选项，在该选项中，Spring 位在启动时进行 JNDI EJB 查找并将其存储在一个单例对象中，只要应用程序正在运行，该对象将在上下文中可用以备将来使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T04:16:46.603

您可以使用以下内容查找 bean 并将其用于后续调用：

```
<jee:local-slsb id="myComponent" jndi-name="ejb/myBean"
      business-interface="com.mycom.MyComponent"/> 
```

或者在远程 EJB 的情况下：

```
<jee:remote-slsb id="myComponent" jndi-name="ejb/myBean"
      business-interface="com.mycom.MyComponent"/> 
```

# javascript - Rails 3：submit_tag 不 :confirm （而 link_to 有）

> ID：14898017
> 
> 赞同：1
> 
> 时间：2013-02-15T15:34:03.277
> 
> 标签：javascript, jquery, ruby-on-rails-3

为什么这会正确启动“确认”对话框...

```
<%= link_to "Visit Other Site", "http://www.rubyonrails.org/", :confirm => "Are you sure?" %> 
```

...但不是这个：

```
<%= submit_tag "Save", :confirm => "Are you sure?" %> 
```

我在用着：

*   导轨 3.2.12
*   宝石'jquery-rails'（版本：2.2.1）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T15:39:16.650

该`:confirm`选项已弃用，现在将由 data 属性替换。在内部，`submit_tag`已经在进行替换。

请参阅[`submit_tag`文档和源代码](http://api.rubyonrails.org/classes/ActionView/Helpers/FormTagHelper.html#method-i-submit_tag)。

因为数据属性依赖于 Unobtrusive JavaScript 来执行，所以您应该包含 jQuery JS 和 Rails UJS 文件。否则，该属性将在源代码中可见（请检查它）但不会触发确认。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-30T16:13:05.937

这是一个悬而未决的问题/错误，请参阅上面的评论。

# cocoa-touch - NSDate 增加一天

> ID：14898019
> 
> 赞同：1
> 
> 时间：2013-02-15T15:34:15.577
> 
> 标签：cocoa-touch

我一直在开发一个集成了秒表的应用程序。我让秒表工作并正确显示秒/分钟等。

但我的问题是，我想在任务完成后显示完整时间（您在 1 天、2 小时、3 分钟、4 秒等时间内完成了此任务）

但每当我这样做时，它总是在等式中增加 1 天（例如，它应该是 0 天、0 小时、2 分钟和 14 秒）但它输出 1 天、0 小时、2 分钟和 14 秒。

代码：

```
startDate = [[NSDate date] retain];
NSDate *currentDate = [NSDate date];
NSTimeInterval timeInterval = [currentDate timeIntervalSinceDate:startDate];
NSDate *timerDate = [NSDate dateWithTimeIntervalSince1970:timeInterval];

NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
[dateFormatter setDateFormat:@"D' Days, 'H' Hours, 'm' Minutes and 's' Seconds'"];
[dateFormatter setTimeZone:[NSTimeZone timeZoneForSecondsFromGMT:0.0]];
NSString *timeString = [dateFormatter stringFromDate:timerDate];
overtext2.text = timeString;
[dateFormatter release]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T15:44:07.170

看起来你真的在这里滥用 NSDate 。

您获得“额外”日期的原因是您实际上是在打印日期和时间，就好像您的计时器是在 1970 年 1 月 1 日 00:00:00 开始的。因此，如果您的计时器运行 4 小时 30 分钟，`timerDate`将是 1970 年 1 月 1 日 04:30:00。如果您的计时器要运行 40 天，那么这些天数将超过`timerDate`1970 年 9 月 2 日 00:00:00，并且您的“天数”值将是 9，而不是预期的 40。

您最好手动计算天、小时、分钟、秒：

```
NSDate *startDate; // When the timer was started
NSTimeInterval timerValue = [[NSDate date] timeIntervalSinceDate:startDate]; // Time in seconds from startDate to now
NSInteger secs = timerValue % 60;
NSInteger mins = (timerValue % 3600) / 60;
NSInteger hours = (timerValue % 86400) / 3600;
NSInteger days = timerValue / 86400;
NSString *timeString = [NSString stringWithFormat:@"%d days, %d hours, %d minutes and %d seconds.", days, hours, mins, secs]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T15:38:25.070

```
NSDate *timerDate = [NSDate dateWithTimeIntervalSince1970:timeInterval]; 
```

这会将秒数添加到 1970，然后您将该时间转换为天：小时：分钟：秒，这永远不会发生。

或者，您可以这样做：

```
NSInteger seconds=timeInterval;//timeInterval float converted to long.
NSInteger secs = seconds% 60;
NSInteger mins = (seconds% 3600) / 60;
NSInteger hours = (seconds% 86400) / 3600;
NSInteger days = seconds/ 86400;
NSString *timeString = [NSString stringWithFormat:@"%d days, %d hours, %d minutes and %d seconds.", days, hours, mins, secs]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T16:03:40.503

答案在于问题所在的文档

d 1..2 1 日期 - 日期 D 1..3 345 日期

在您的情况下，您计算的间隔具有正确的秒数，但这一天是一年中的第一天。

如果您按如下方式修改代码以包含月份，您还将获得 1（对于 1 月）。

```
[dateFormatter setDateFormat:@"D' Days, 'M' Months, 'H' Hours, 'm' Minutes and 's' Seconds'"]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-15T15:55:17.383

你听说过日期时间加法..吗？在我所做的一种情况下，这曾经导致问题。因此，我建议您在必须添加或减去日期时始终使用 NSDateComponents。这是正确的方法..请尝试一下，看看它是否有效..

# yii - yii 最好的用户管理器扩展？

> ID：14898020
> 
> 赞同：2
> 
> 时间：2013-02-15T15:34:16.443
> 
> 标签：yii, yii-extensions

你认为 yii 最好的用户管理器是什么？在 irc 我听说 yii-auth？

我需要 2 类用户：1）工作人员 - 他们对不同面板的访问权限有限。2）客户——他们可以进入商店购买产品和一些非常有限的其他地方。

我可以将 yii-auth 之类的模块用于 1) 和 2) 吗？还是仅对 1) 有意义？

我正在编写的应用程序是具有完整复杂功能（如支持等）的商店。

你有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T16:26:01.717

如果你想要一些简单的东西，在身份验证时，在 SESSION 中设置用户的类型。

```
// Example
Yii::app()->user->setState('type', 'W'); // Worker
Yii::app()->user->setState('type', 'C'); // Client 
```

然后，在执行一些只有一种类型的用户可以运行的操作之前，你做...

```
if(Yii::app()->user->getState('type') === 'W') {
    // Action of the Worker
} else {
    // Exception
} 
```

如果您需要更专业的东西，您可以通过扩展[Yii Rights](http://www.yiiframework.com/extension/rights/)或[Yii SRBAC](http://www.yiiframework.com/extension/srbac/)控制对您网站的访问，并根据您的情况使用最好的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-23T18:03:52.377

最近我在我的小项目中使用了这个 wiki： [http ://www.yiiframework.com/wiki/328/simple-rbac/](http://www.yiiframework.com/wiki/328/simple-rbac/)

这是更多功能模块： [https ://github.com/thyseus/yii-user-management](https://github.com/thyseus/yii-user-management)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T16:47:11.310

不确定最好的（我猜这取决于），但这是我在我的一个项目中使用的一个很好的。[yii 用户](http://www.yiiframework.com/extension/yii-user)。

# php - 用于检查数组是否为数字的 PHP 代码不起作用

> ID：14898021
> 
> 赞同：1
> 
> 时间：2013-02-15T15:34:16.883
> 
> 标签：php, arrays, function, integer, numeric

我有以下 PHP：

```
 <?php

 $array = array("1","2","3");
 $only_integers === array_filter($array,'is_numeric'); // true

 if($only_integers == TRUE)
 {
 echo 'right';
 }

 ?> 
```

由于某种原因，它总是什么都不返回。我不知道我做错了什么。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T15:36:07.527

[`is_int`](http://php.net/is-int)检查变量的实际类型，`string`在您的情况下。无论变量类型如何，用于[`is_numeric`](http://php.net/is-numeric)数值。

请注意，以下值都被视为“数字”：

```
"1"
1 
1.5
"1.5"
"0xf"
"1e4" 
```

即任何可以有效表示浮点数或整数的浮点数、整数或字符串。

**编辑：**另外，您可能误解[`array_filter`](http://php.net/array-filter)了，它不返回 true 或 false，而是返回一个包含回调函数返回 true 的所有值的新数组。`if($only_integers)`尽管如此（在您修复了赋值运算符之后）仍然有效，因为所有非空数组都被认为是“真实的”。

**编辑2：**正如@SDC 指出的那样，[`ctype_digit`](http://php.net/ctype-digit)如果您只想允许十进制格式的整数，则应该使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T15:43:54.133

您必须将原始数组的长度与过滤后的数组的长度进行比较。array_filter 函数返回一个数组，其值与设置为 true 的过滤器匹配。

[http://php.net/array_filter](http://php.net/array_filter)

```
 if(count($only_integers) == count($array))  {
     echo 'right';
 } else {
     echo 'wrong';
 } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-15T15:52:01.640

1.  `is_int()`将返回`false`，`"1"`因为它是一个字符串。
    我看到你现在已经编辑了这个问题来`is_numeric()`代替使用；这也可能是一个坏主意，因为它将返回`true`您可能不想要的十六进制和指数值（例如`is_numeric("dead")`将返回 true）。
    我建议`ctype_digit()`改用。

2.  三等号在这里被滥用了。它用于比较，而不是分配，因此`$only_integers`永远不会设置。使用 single-equal 来设置`$only_integers`.

3.  `array_filter()`不返回`true`/`false`值；它返回数组，并删除过滤后的值。这意味着后续检查`$only_integers`为真将不起作用。

4.  `$only_integers == TRUE`. 这没关系，但您可能应该在这里使用三等号。但是当然，我们已经知道它`$only_integers`不会是`true`or `false`，它会是一个数组，所以实际上我们需要检查它是否有任何元素。`count()`会在这里做的伎俩。

考虑到所有这些，这就是您的代码的样子...

```
 $array = array("1","2","3");
 $only_integers = array_filter($array,'ctype_digit'); // true

 if(count($only_integers) > 0)
 {
     echo 'right';
 } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-15T15:40:08.357

改变它`===`用于`=`比较不用于初始化变量

```
<?php

 $array = array(1,2,3);
 $only_integers = array_filter($array,'is_int'); // true

 if($only_integers == TRUE)
 {
 echo 'right';
 }

?> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-15T15:47:51.320

您是否尝试在发布之前运行您的代码？我有这个错误：

```
Notice: Undefined variable: only_integers in ~/php/test.php on line 4
Notice: Undefined variable: only_integers in ~/php/test.php on line 6 
```

更改`===`以立即`=`解决问题。你最好学习如何使用 phplint 和其他工具来避免这样的拼写错误。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-02-15T15:39:01.583

```
<?php
$test1 = "1";
if (is_int($test1) == TRUE) {
    echo '$test1 is an integer';
}
$test2 = 1;
if (is_int($test2) == TRUE) {
    echo '$test2 is an integer';
}
?> 
```

试试这段代码，你就会明白为什么你的代码不起作用。

# css - css的奇怪行为，刷新后修复

> ID：14898028
> 
> 赞同：0
> 
> 时间：2013-02-15T15:34:36.070
> 
> 标签：css, positioning, browser-refresh

我正在尝试建立一个用户浏览某些 Flash 游戏的页面，并`<div>`为他们创建缩略图。一开始效果很好，但是当我点击一个游戏，然后返回浏览页面时，文字与图像重合，当我刷新时，就可以了。

错误版本：（返回后） ![在此处输入图像描述](../Images/cdb218637b452e8b8baf874bbb9eb1d3.png)

正确版本：（开始时和刷新后） ![在此处输入图像描述](../Images/ef22eee7b7fa93b51793f3e9ecc80cd3.png)

没有运行 JavaScript，所以我不更改元素的样式。有`<div>`问题的 .css 代码如下：

```
div.game_side_texts
{
clear:right;
float:top; 
max-height:80%;
}

img.gamethumb
{
height:80%;
}

div.game_img_div
{
float:left;
margin-right:2%;
min-width:30%;
}

.game_thumbnail_div /* the div that contains everything */
{
float:left;

width:40%;
height:20%;

margin-top:6%;
margin-right:1%;

padding-bottom:3%;
} 
```

那么可能是什么问题呢？提前致谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T21:10:50.923

对于初学者来说，`.game_thumbnail_div`宽度和高度太小了。要么删除它们，要么使尺寸至少为 286 x 140。此外，`float:top`不做任何事情。我知道您提到您尝试过它并且它有效，但我向您保证它不是必需的。

[更新了小提琴。](http://jsfiddle.net/xbycA/5/)

# c# - C#、Async Tasks 和 NetworkStream.BeginRead，如何保证缓冲区不会被覆盖？

> ID：14898031
> 
> 赞同：0
> 
> 时间：2013-02-15T15:34:44.447
> 
> 标签：c#, asynchronous

我正在尝试用 C# 编写一段代码以异步读取 TcpClient 。这是我的代码：

```
using System;
using System.Net;
using System.Net.Sockets;
using System.Threading.Tasks;

class Connection
{
    private TcpClient socket;
    private NetworkStream socketStream;
    private byte[] buffer;
    private int bytesRead;
    private Task<int> readTask;

    public Connection(TcpClient socket)
    {
        this.socket = socket;
        socketStream = socket.GetStream();
        buffer = new byte[4096];

        readTask = Task.Factory.FromAsync<byte[], int, int, int>(
            this.socketStream.BeginRead
            , this.socketStream.EndRead
            , this.buffer
            , 0
            , this.buffer.Length
            , null
        );
        readTask.ContinueWith(
            (task) => {
                this.bytesRead = (int)task.Result;
                //Do something with buffer.
            }
            , TaskContinuationOptions.OnlyOnRanToCompletion
        );
    }
} 
```

问题是异步 BeginRead 将尝试覆盖 Connection 对象的缓冲区，一旦新数据到达，无论是否使用旧数据，都会覆盖旧数据。我应该如何解决这个问题？AFAIK 它应该与闭包有关，但我不知道怎么做！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T17:49:35.333

您必须拥有一组需要处理的缓冲区。您可以简单地分配一个本地缓冲区（`var buffer = new byte[4096];`），然后将该缓冲区添加到一个集合（也许`Stack`）中。您可能最终还必须处理通知另一个线程来处理队列中的新数据。

例如：

```
class Connection
{
    private TcpClient socket;
    private NetworkStream socketStream;
    private int bytesRead;
    private Task<int> readTask;
    private Stack<byte[]> buffersToProcess;
    private readonly object lockObject = new object();

    public Connection(TcpClient socket)
    {
        this.socket = socket;
        socketStream = socket.GetStream();
        var buffer = new byte[4096];

        readTask = Task.Factory.FromAsync<byte[], int, int, int>(
            this.socketStream.BeginRead
            , this.socketStream.EndRead
            , buffer
            , 0
            , buffer.Length
            , null
            );
        readTask.ContinueWith(
            (task) =>
                {
                    this.bytesRead = (int) task.Result;
                    var actualBytes = new byte[bytesRead];
                    Array.Copy(buffer, 0, actualBytes, 0, bytesRead);
                    lock (lockObject)
                    {
                        buffersToProcess.Push(actualBytes);
                    }
                    // TODO: do something with buffersToProcess
                }
            , TaskContinuationOptions.OnlyOnRanToCompletion
            );
    }
} 
```

但是，您确实没有提供足够的信息来真正说明您在这种情况下真正需要什么。例如，为什么之前的缓冲区还没有被处理？

# rest - 连接词的 RESTful 命名

> ID：14898033
> 
> 赞同：0
> 
> 时间：2013-02-15T15:34:58.017
> 
> 标签：rest, naming-conventions

我们讨论了如何设计我们的 RESTful URI，当它们包含多个需要连接的单词（如“配置值”）时。我读过下划线通常像“config_values”一样使用，但在视觉上我更喜欢像“config-values”这样的破折号。

问题是：是否有任何论据可以使用其中一个或另一个？或者它只是一个在任何地方都不会产生任何严重影响的化妆品。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T15:27:17.317

对于请求参数，我更喜欢 Java 中的驼峰式大小写，以及`one-two`Stackoverflow 等路径组件的虚线命名。

# sharepoint - SharePoint 应用程序页面中的自定义 DLL

> ID：14898038
> 
> 赞同：1
> 
> 时间：2013-02-15T15:35:26.457
> 
> 标签：sharepoint, sharepoint-2010

我已经通过 VS 2010 将自定义 DLL 添加到 SharePoint 中的自定义应用程序页面，就像我添加任何其他 asp.net 项目一样。然后我运行 Build and Package 并获取包并通过 PowerShell 部署它。当我导航到自定义应用程序页面时，它给了我一个“找不到文件”SharePoint 错误。如果我取出使用自定义 DLL 的代码，则不会出错。知道我需要做什么才能让这个 DLL 在 SharePoint 的自定义应用程序页面中工作吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T16:09:33.280

当然，您还需要部署 DLL。在 SharePoint 中，您可以通过您的包执行此操作：

> 打开你的包
> 点击“高级”（在底部）
> 添加你的外部DLL，甚至可能为web.config添加SafeControls

正如[我在这篇文章中所解释的那样](https://stackoverflow.com/questions/5092544/deploying-custom-dlls-in-sharepoint-2010)。

# c# - 我可以依赖 .Net 程序集名称的特定大写吗？

> ID：14898042
> 
> 赞同：0
> 
> 时间：2013-02-15T15:35:31.513
> 
> 标签：c#, .net, reflection, assemblies

在我的代码中，我想检查是否加载了特定的程序集。我有这个代码：

```
var assembly = AppDomain.CurrentDomain.GetAssemblies().Where(
    a => a.FullName.StartsWith("Microsoft.WindowsAzure.ServiceRuntime")).SingleOrDefault(); 
```

现在此代码依赖于程序集的特定大小写 - 比较区分大小写。

我是否需要比较不区分大小写，或者我可以一直期待特定的大写？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T15:48:42.043

据此[，](http://msdn.microsoft.com/en-us/library/k8xx4k69.aspx)运行时将程序集名称视为不区分大小写。也就是说，您不会同时加载两个名称*仅*大小写不同的程序集。

因此，如果您只想检查特定的程序集名称，您应该使用[StartsWith](http://msdn.microsoft.com/en-us/library/vstudio/ms131452.aspx)和[StringComparison](http://msdn.microsoft.com/en-us/library/vstudio/system.stringcomparison.aspx) `.InvariantCultureIgnoreCase`的重载进行不区分大小写的比较，以避免（非常罕见）程序集名称的大写已更改的情况。

```
a.FullName.StartsWith("Microsoft.WindowsAzure.ServiceRuntime",
     StringComparison.InvariantCultureIgnoreCase) 
```

# php - Web 主机/服务器上的 Codeigniter 文件

> ID：14898046
> 
> 赞同：0
> 
> 时间：2013-02-15T15:35:45.723
> 
> 标签：php, codeigniter

我无法理解 CI 安装说明中的这一行，web root 是什么意思？它说为了更好的安全性，系统和应用程序应该在 web 根目录之上，这是否意味着就像在 web 主机中一样，它应该在 public_html 之上？还是在public_html里面？例如 public_html/system 和 public_html/application.. 或者对于像 XAMPP 这样的本地服务器，在 htdocs 中？像 htdocs/system 和 htdocs/application？当它在 web root 上面说时，我真的很困惑。因为如果我想到它，它将在 public_html 或 htdocs 之外。请赐教

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T15:59:59.493

```
. /
.. /
public_ftp /
public_html /
application /
system / 
```

这将把`application`webroot放在上面`system``public_html`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T15:37:38.970

不，在 public_html 之上，

所以如果 /home/lemoncodes/public_html 是你的 WWW 文件夹，你应该把你的文件放在：/home/lemoncodes。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T15:41:22.130

如果你认为一个目录和子目录的表示是一棵树，我们很快就会看到它指的是以下内容：

```
. /
.. /
public_ftp /
public_html /
| - Application /
| - System /
etc. 
```

很快 Aplication 和 System 文件夹应该在 public_html 里面。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-15T15:42:27.337

在 Web 服务器中，根是 public_html/system 和 public_html/application 这意味着 public_html 是指您的域名。

在本地 htdocs/domain/system 和 htdocs/domain/applications

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-15T16:01:59.910

具有单个网站的 Web 服务器：文件应该放在服务器告诉您 Web 根目录的任何位置，在大多数服务器场景中，这是 public_html，如 Arthur Barros 所示。

具有多个站点的 Web 服务器：在这种情况下，常见的处理方式是每个站点在 public_html 中都有自己的文件夹。在这种情况下，为每个域设置了 Web 服务器以拥有自己的文件夹，因此该域文件夹成为 Web 根目录。所以如下

```
public_html
...WebSite1
...WebSite2
......Application
......System
...WebSite3 
```

XAMPP：我强烈建议按照我解释的方式在 XAMPP 中设置 CI，您可以在具有多个站点的网络服务器中设置它。虽然它在技术上可以直接在 htdocs 文件夹中工作，但我认为这不是一个好主意。在 htdocs 中为您的站点创建一个文件夹，然后通过网络浏览器中的该文件夹访问它。

```
htdocs
...myWebsite
......Application
......System

http://localhost/myWebsite would be your base url. 
```

即使在具有单个网站的网络主机上，将 CI 包含在它自己的文件夹中仍然有意义，调整您的 htaccess、配置和路由文件以指向该文件夹。因此，您的站点实际上可以驻留在 www.example.com/my_website 中，但您设置了文件，以便指向 www.example.com 或 www.example.com/contact。

这只是将东西分开，并允许您在服务器上安装其他东西、其他 CI 应用程序等，而不会与您的原始安装冲突。

# wifi - 限制 wifi 路由器访问特定的 Android 和 iPhone 应用

> ID：14898050
> 
> 赞同：0
> 
> 时间：2013-02-15T15:35:49.137
> 
> 标签：wifi, itunes, router

拥有 wifi 连接的最佳解决方案是只能访问一个特定的 Android 和 iPhone 应用程序。这将在商店中使用，以允许客户下载应用程序，而无需将 wifi 连接用于其他目的。（另一个连接将专用于其他用途）

最好的办法是该应用程序将预先加载到路由器中，以便下载速度最快。然后路由器将只需要与 iTunes 或 Google play 通信，因为它们的协议和统计原因。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T15:40:07.983

您将始终在您的 AP（接入点）中预订特定设备。您不能将其限制为单个应用程序（设备上没有您无法影响的策略）。

无法将 Wifi 连接用于其他目的只是连接到 AP 以及如何配置它的问题。这意味着不要将其连接到另一个网络或互联网，分别在网络之间设置防火墙。

# .htaccess - mod_rewrite 和 .htaccess：我的 RewriteRule 替换可以是 DocumentRoot 父文件夹中的子文件夹吗？

> ID：14898051
> 
> 赞同：1
> 
> 时间：2013-02-15T15:35:50.237
> 
> 标签：.htaccess, mod-rewrite

提前感谢您的帮助。

这就是我所在的位置以及我要完成的工作：

*   我在 /home/username/code/project/static/ 中有静态文件
*   我的文档根目录是 /home/username/public_html/ （这是我的 .htaccess 文件所在的位置）。
*   我正在尝试在 .htaccess 文件中使用以下内容（我无权访问 httpd.conf）：

    ```
    RewriteRule ^(static/.*)$ /home/username/code/project/static/ [L] 
    ```

    但如果我正确理解了 mod_rewrite 的文档（见下文），“/home/username/code/project/static/”将被视为相对于我的文档根目录的文件系统路径或 URL 路径，而不是绝对的我想要的文件系统路径。

我尝试使用“~/code/project/static/”和“../code/project/static/”，但在尝试访问我的页面时出现内部服务器错误（是的，我有点菜鸟）。

所以我的问题是：有没有办法将 .htaccess 上下文中使用的重写规则替换为绝对文件系统路径，而不是相对于我的 DocumentRoot 的路径？

这是 mod_rewrite 文档的摘录供参考（可以在这里找到完整的：[http](http://httpd.apache.org/docs/current/mod/mod_rewrite.html#rewriterule) ://httpd.apache.org/docs/current/mod/mod_rewrite.html#rewriterule ）：

> 例如，如果您指定 /www/file.html 的替换字符串，那么这将被视为 URL 路径，除非在根目录或文件系统中存在名为 www 的目录**（或者，在使用重写的情况下在 .htaccess 文件中，相对于您的文档根目录）**，在这种情况下，它将被视为文件系统路径。

任何帮助都感激不尽 ：）

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T18:41:22.293

完成您想要做的事情的一种方法是在 public_html 中创建一个`static`指向`/home/username/code/project/static/`. 这需要[选项指令文档](http://httpd.apache.org/docs/2.2/mod/core.html#options)`FollowSymlnks`中详述的选项，但在完整的 Apache 配置中可能不允许使用，这是您无法控制的。

更好的方法是反转链接 - 将 public_html/static 设置为保存真实文件的位置，然后将 /home/username/code/project/static 设置为指向 public_html/static 的符号链接。这避免了对特定 .htaccess 规则的任何需要。由于您似乎无论如何都希望使该目录下的文件可公开访问，因此它在安全方面也更好，因为它将可公开访问的文件全部保存在相同的目录结构下，并避免因允许符号链接而产生的潜在安全问题去从 Web 根目录到文件系统的其他区域。

# php - PHP 致命错误：调用未定义的方法 DB_Error::getAll()

> ID：14898060
> 
> 赞同：1
> 
> 时间：2013-02-15T15:36:12.223
> 
> 标签：php, database, pear

我很无聊，我备份了网站，并尝试正确重新发布，但我有一个 php 错误...

> PHP 致命错误：调用未定义的方法 DB_Error::getAll()

检查我的代码：

```
//renvoi toutes les lignes 
public function getAll($p_Req)
{
    global $db;
    return $db->getAll($p_Req);
} 
```

我已经重新安装了 php 5.2.17 pear 1.9.1 和 DB 包 1.7.14

这是这个网站的好配置，我没有接触代码，我不明白为什么它不起作用。

请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T15:54:54.980

出于某种原因，您在 $db 变量中实例化的不是 PEAR:DB 类而是 PEAR:DB_Error

您需要仔细检查 $db 变量的来源。

# java - 将 Kerberos 与 Webstart 一起使用。无法从票证缓存中获取 tgt

> ID：14898061
> 
> 赞同：0
> 
> 时间：2013-02-15T15:36:19.093
> 
> 标签：java, kerberos, java-web-start, principal

我在使用带有 Webstart 的 Kerberos 时遇到问题。我想获取当前已登录 Windows 用户的 Principal，并且 API 尝试从票证缓存中获取 tgt。

AllowTgtSessionKey 在注册表中设置为 1。

使用普通的 Java 应用程序一切正常，我得到了票并且可以使用主体。

但是当我将我的应用程序部署为 Webstart 时，我无法从缓存中获取票证并在调用 LoginContext#login 时获得 LoginException。

这是我的代码：

配置：

```
private static Configuration getProgramaticLoginConfig() 
{
    HashMap<String, String> options = new HashMap<String, String>(); 
    options.put("useTicketCache", "true"); 
    options.put("doNotPrompt", "true"); 
    options.put("debug","true");                                       
    AppConfigurationEntry krb5LoginModule = new AppConfigurationEntry("com.sun.security.auth.module.Krb5LoginModule", LoginModuleControlFlag.REQUIRED, options); 
    final AppConfigurationEntry[] aces = new AppConfigurationEntry[]{krb5LoginModule}; 
    Configuration progConfig = new Configuration() 
    { 
      @Override 
      public AppConfigurationEntry[] getAppConfigurationEntry(String arg0) 
      {                                 
           return aces; 
      } 

    }; 
    return progConfig; 
} 
```

这是我的代码：

```
LoginContext lc = null;
    try {
        // create a LoginContext
        lc = new LoginContext("asdjfkasdjkfasdö",new DialogCallbackHandler());
    } catch(Exception e) {
        log.error("Initialisierung fehlgeschlagen",e);
    }
    try {       
        // login (effectively populating the Subject)
        lc.login();
    } catch(LoginException e) {
        log.error("Login failed",e);
    }
try {
    //get the Subject that represents the signed-on user
    Subject signedOnUserSubject = lc.getSubject();
... 
```

我究竟做错了什么？所有的罐子都签名了！

谢谢你的帮助。

问候，霍尔格

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-15T19:22:27.880

当您使用 web start 启动应用程序时，它处于具有降低权限的小程序上下文中。

您将需要签署您的 jar 以允许 jaas 登录。

这里的例子[http://www.narendranaidu.com/2007/11/3-easy-steps-to-self-sign-applet-jar.html](http://www.narendranaidu.com/2007/11/3-easy-steps-to-self-sign-applet-jar.html)

# javascript - jQuery UI：TypeError：$(...).accordion 不是函数

> ID：14898071
> 
> 赞同：20
> 
> 时间：2013-02-15T15:36:40.177
> 
> 标签：javascript, jquery, jquery-ui, jquery-ui-accordion

由于某种原因，**jQuery UI Accordion**不起作用。我不断收到此错误：

> TypeError: $(...).accordion 不是函数

我究竟做错了什么？根据本网站上类似主题的其他答案，我认为这与包含的文件有关。

我的标题包括：

```
<!-- Mobile Specific Metas -->
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">  

<!-- CSS -->
<link rel="stylesheet" href="<?php echo base_url(); ?>css/base_con.css">
<link rel="stylesheet" href="<?php echo base_url(); ?>css/skeleton.css">
<link rel="stylesheet" href="<?php echo base_url(); ?>css/layout.css">

<!--[if lt IE 8]>
<script src="http://ie7-js.googlecode.com/svn/version/2.1(beta4)/IE8.js"></script>
<![endif]-->

<!--[if lt IE 9]>
<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

<!-- Favicons -->
<link rel="shortcut icon" href="<?php echo base_url(); ?>images/favicon.ico">
<link rel="apple-touch-icon" href="<?php echo base_url(); ?>images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
<link rel="stylesheet" href="<?php echo base_url(); ?>css/custom-theme/jquery-ui-1.10.0.custom.css" type="text/css" />

<!-- Scripts -->
<script src="<?php echo base_url(); ?>js/jquery-1.9.0.js"></script>
<script src="<?php echo base_url(); ?>js/jquery-ui-1.10.0.custom.js"></script>
<script src="<?php echo base_url(); ?>js/responsiveslides.min.js" type="text/javascript"> 
```

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2014-05-03T12:48:09.223

这个问题可能源于几个不同的事情：

*   您不包括 jQuery UI 库。
*   您在包含 jQuery 库的上方包含 jQuery UI 库
*   jQuery UI 和 jQuery 库的路径可能不正确
*   您正在使用没有手风琴的自定义 jQuery UI 库

由于前两个不适用于您，我建议三重检查路径并使用完整的 jQuery UI 库而不是自定义库：

```
<script src="http://code.jquery.com/ui/1.10.0/jquery-ui.js"></script> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-10-07T08:36:05.647

使用两个`jquery.js`文件可能会导致冲突并引发错误。避免导入两个或更多`jquery.js`文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-21T14:18:14.270

在最后的代码行中，按以下顺序包含脚本：-

无需包含以下内容，因为上面的脚本会处理它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-02-10T19:00:53.910

js文件的顺序很重要！

```
/external/jquery/jquery.js should be listed above jquery-ui.js! 
```

# android - Android SDK 3.0：尽管用户撤销了应用程序的权限，但 openForRead 返回 AccessToken

> ID：14898075
> 
> 赞同：1
> 
> 时间：2013-02-15T15:36:57.510
> 
> 标签：android, facebook-android-sdk, facebook-access-token

我的FB整合很简单。对于用户的注册和登录，我只需要通过 SDK 获取 FB 令牌，然后将其交给我的服务器。我的应用程序没有进一步的图形调用等。一切都是从服务器完成的。我使用以下静态类来获取它，它工作正常。除了用户在 FB 主页上撤销对应用程序的访问权限的情况外，我仍然得到旧的访问令牌，我的服务器显然不能再使用了。

有什么办法可以强制 SDK 让我获得一个有效的令牌，并在必要时再次向用户询问权限？

```
public static void getAccessToken(Fragment fragment, final FacebookTokenListener listener) {
        Session currentSession = Session.getActiveSession();
        if (currentSession == null || currentSession.getState().isClosed()) {
            Session session = new Session.Builder(fragment.getActivity()).setApplicationId(
                    fragment.getString(R.string.facebook_app_id)).build();
            Session.setActiveSession(session);
            currentSession = session;
        }
        if (!currentSession.isOpened()) {
            Session.OpenRequest openRequest = null;
            openRequest = new Session.OpenRequest(fragment);

            if (openRequest != null) {
                openRequest.setPermissions(Configuration.FB_PERMISSIONS);
                openRequest.setCallback(new StatusCallback() {

                    @Override
                    public void call(Session session, SessionState state, Exception exception) {
                        Log.d(TAG, "call " + session.getAccessToken() + " , state: " + state.name() + " ,exception: "
                                + (exception == null ? "null" : exception.getMessage()));
                        if (session.isOpened()) {
                            Log.d(TAG, "fb token: " + session.getAccessToken());
                            listener.onAccessTokenReceived(session.getAccessToken());
                        }
                    }
                });
                currentSession.openForRead(openRequest);
            }
        } else {
            Log.d(TAG, "fb token: " + currentSession.getAccessToken());
            listener.onAccessTokenReceived(currentSession.getAccessToken());
        }
    } 
```

# c# - 如何从标签中的 DateTime 字段显示短日期？

> ID：14898079
> 
> 赞同：3
> 
> 时间：2013-02-15T15:37:08.740
> 
> 标签：c#, winforms, visual-studio, sql-server-2008, datetime

我的 SQL Server DB 中有一个 DateTime 字段，我想在 WinForm (C#) 的标签上仅显示短日期形式的日期。我仍然得到 06/01/2013 12:00:00，尽管，即使使用：

```
label_date.Text = myDateTimeField.Date.ToString(); 
```

为了提取时间供以后使用，我使用：

```
label_time.Text = myDateTimeField.TimeOfDay.ToString(); 
```

这很好用。

有人知道如何*单独*约会吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-15T15:38:23.250

您可以使用[`DateTime.ToShortDateString`](http://msdn.microsoft.com/en-us/library/system.datetime.toshortdatestring.aspx)：

```
label_date.Text = myDateTimeField.ToShortDateString(); 
```

评论：

> 当前 DateTime 对象的值使用与当前线程区域性关联的[DateTimeFormatInfo.ShortDatePattern属性定义的模式进行格式化。](http://msdn.microsoft.com/en-us/library/system.globalization.datetimeformatinfo.shortdatepattern.aspx)返回值与使用 ToString(String) 方法指定“d”标准 DateTime 格式字符串所返回的值相同。
> 
> ToShortDateString 方法返回的字符串区分区域性。它反映了当前区域性的[DateTimeFormatInfo](http://msdn.microsoft.com/en-us/library/system.globalization.datetimeformatinfo.aspx)对象定义的模式。例如，对于 en-US 文化，标准的短日期模式是“M/d/yyyy”；对于 de-DE 文化，它是“dd.MM.yyyy”；对于 ja-JP 文化，它是“yyyy/M/d”。特定计算机上的特定格式字符串也可以自定义，使其不同于标准的短日期格式字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T15:41:11.053

您还可以使用：

`string shortDate = DateTime.Now.ToString("yyyy-MM-dd");`

更改*`yyyy-MM-dd`*您要查找的格式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T16:09:31.453

检查日期 - 月 - 年的顺序 sql中的输入不同

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-08T18:10:12.647

您可以在模型（或 ViewModel）类中使用数据注释，如下所示：

```
[DataType(DataType.Date)]
public DateTime DateOfExpiration { get; set; } 
```

# java - 抹掉网址

> ID：14898080
> 
> 赞同：1
> 
> 时间：2013-02-15T15:37:10.007
> 
> 标签：java, jakarta-ee

我有一个 AJAX 应用程序，它将调用一个 servlet 来运行报告并返回一个 PDF。这一切都很好，除了用户将看到一个网页，该网页将包含报告名称和他们的客户 ID。更改客户 ID 将允许他们为另一个人运行相同的报告。哎呀！

我记得一些关于 URL 重写的事情，它被可疑地用于会话管理。我想知道我是否可以只修改我的 servlet 中的 URL，以便用户返回的内容不会被黑客攻击以获取其他报告。我该怎么办？

另外，有没有人有更好的主意？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T15:44:54.703

只需使用（匿名）会话 ID 作为文件部分。并通过添加会话 ID 让 servlet 流式传输文件系统中的文件。

这假设控制流不能因为 Ajax 而更容易完成并且一次做两件事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T15:45:06.310

好吧，正如 GarethL 在他的评论中所说，用户应该必须登录。然后您可以将客户 ID 存储在会话中并使用它而不是参数。

问题是您首先需要以某种方式确认用户的身份，最简单的方法是密码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T17:13:19.020

我最终编写了一个代理 servlet 来复制内容。这是由在会话中存储 URL 参数的哈希键触发的。这为我提供了所需的所有安全性。

谢谢。

# azure - 多点查询 Azure 存储服务

> ID：14898082
> 
> 赞同：1
> 
> 时间：2013-02-15T15:37:16.020
> 
> 标签：azure, storage, point

我对 Azure 中的点查询有疑问。如果我有大量的分区键/行键对，是否有一种聪明的方法可以进行大量的点查询来获取实体？

我当然可以遍历 n 对并进行 n 次查询，但我觉得有一种更聪明的方法。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-18T20:23:24.163

[我从Microsoft 的 Joe Giardino](http://social.msdn.microsoft.com/Forums/windowsazure/en-US/5160b393-6f40-4354-86a0-8357cb6cf5d6/best-way-to-select-different-unrelated-records-using-rowkey)那里找到了答案：

> 如果您想要几个不连续的行键，那么发出以下形式的单独但并行的单独查询将执行得更好。当您同时指定 PartitionKey 和 RowKey 时，查询被视为“PointQuery”，这是性能最高的选项。

```
 a) PartitionKey == “MyPK” && RowKey == “FirstRK”
 b) PartitionKey == “MyPK” && RowKey == “SecondRK" 
```

# sql-server - 如何在 SQL Server 中调试合并？

> ID：14898086
> 
> 赞同：8
> 
> 时间：2013-02-15T15:37:22.783
> 
> 标签：sql-server

我正在尝试学习如何使用 MERGE 运算符。以下代码正确编译：

```
 ALTER PROCEDURE moto.procPM_UpdateLines
@LineId As Int = null,
@LineName As Varchar(100),
@DeleteMe As Bit = 0
    AS
    BEGIN

    MERGE moto.tblPMLine AS line
    USING (SELECT LineId, LineName FROM moto.tblPMLine) AS existsLine
    ON line.LineId = existsLine.LineId
    WHEN MATCHED AND @DeleteMe = 1 THEN DELETE
    WHEN MATCHED AND @DeleteMe = 0 THEN UPDATE SET line.LineName = @LineName
    WHEN NOT MATCHED THEN INSERT(LineName) VALUES(@LineName);
    END
    GO 
```

我知道这是一个非常简单的过程，但由于某种原因，当我使用以下命令时，它似乎没有生成任何条目。

```
 execute moto.procPM_UpdateLines null, 'First test', 0 
```

有没有办法让我知道它遵循哪些选项（如果有的话）？

* * *

以前的存储过程已修复。

```
 MERGE INTO moto.tblPMLine AS T
   USING (SELECT @LineId as LineId, @LineName as LineName) AS S
   ON T.LineId = S.LineId
   WHEN MATCHED AND @DeleteMe = 0 THEN --UPDATE
        UPDATE SET LineName = @LineName 
   WHEN MATCHED AND @DeleteMe = 1 THEN --DELETE
        DELETE
   WHEN NOT MATCHED THEN--INSERT
        INSERT (LineName) VALUES (@LineName)    
   OUTPUT $action AS ChangesMade; 
```

现在它插入、更新和删除，以及返回输出。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-15T15:56:19.367

您可以结合`MERGE`该`OUTPUT`子句来获得某种“活动报告”（或调试“打印语句”）`MERGE`正在做什么 - 也许这会帮助您了解出了什么问题。

请参阅 Adam Machanic 的优秀博[文 Dr. OUTPUT 或：我如何学会停止担心并喜欢 MERGE](http://sqlblog.com/blogs/adam_machanic/archive/2009/08/24/dr-output-or-how-i-learned-to-stop-worrying-and-love-the-merge.aspx)，它展示了该技术以及如何使用它

基本上它归结为使用`OUTPUT`带有语句的子句`MERGE`来获取正在发生的事情的信息 - 大致类似于：

```
MERGE INTO ......
WHEN MATCHED THEN
    .......
WHEN NOT MATCHED THEN
    ......
WHEN NOT MATCHED BY SOURCE THEN
    ........
OUTPUT
    $action AS dml_action,
    inserted.x AS new_x,
    deleted.x AS old_x,
    inserted.y AS new_y,
    deleted.y AS old_y; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T15:53:13.310

```
MERGE moto.tblPMLine AS line
USING (SELECT LineId, LineName FROM moto.tblPMLine WHERE LineID = @LineID) AS existsLine 
```

原谅我没用过`MERGE`。但是，我没有看到使用`@LineID`变量的代码。

# python - 带有 irclib.py 的类型错误

> ID：14898089
> 
> 赞同：0
> 
> 时间：2013-02-15T15:37:30.973
> 
> 标签：python, arduino, irc

我试图让这个：[http](http://blog.datasingularity.com/?p=148) ://blog.datasingularity.com/?p=148 工作。我已经走了很远，但我碰壁了，尤其是对于像我一样不擅长编程的人。

我收到此错误：

```
C:\windows\system32>python C:\Users\Jenna\Downloads\arduinoIRC\Main.py
Traceback (most recent call last):
  File "C:\Users\Jenna\Downloads\arduinoIRC\Main.py", line 28, in <module>
    main()
  File "C:\Users\Jenna\Downloads\arduinoIRC\Main.py", line 25, in main
    bot.start()
  File "C:\Python27\lib\ircbot.py", line 246, in start
    self._connect()
  File "C:\Python27\lib\ircbot.py", line 96, in _connect
    ircname=self._realname)
  File "C:\Python27\lib\irclib.py", line 1084, in connect
    localaddress, localport, ssl, ipv6)
  File "C:\Python27\lib\irclib.py", line 433, in connect
    self.socket.connect((self.server, self.port))
  File "C:\Python27\lib\socket.py", line 224, in meth
    return getattr(self._sock,name)(*args)
TypeError: an integer is required 
```

主文件

```
import Commands

from ArduinoBot import *
from Arduinos import Arduino     

def main():

    bot = ArduinoBot(Arduino(Commands.PORT, Commands.BAUD), Commands.CHANNEL,     Commands.NICK, Commands.SERVER, Commands.PORT)
    bot.start()

if __name__ == "__main__":
    main() 
```

命令 [.py http://pastebin.com/kH7w9Mt3](http://pastebin.com/kH7w9Mt3)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T15:38:50.900

可以发一下内容吗`Commands.py`

看起来你给它一个字符串，它期待一个 int。

# delphi - 为什么新组件向导不显示任何祖先类？

> ID：14898090
> 
> 赞同：4
> 
> 时间：2013-02-15T15:37:32.523
> 
> 标签：delphi, ide, c++builder, vcl

我正在尝试在 RAD Studio XE2 中创建新的 VCL 组件。我使用 C++ Builder 或 Delphi 得到了相同的结果：

![不显示祖先的新组件向导](../Images/ba7341f52568ecca7fd4201be32fc2e3.png)

如何获取 VCL 组件列表？我尝试了“修复设置”，但没有成功。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-15T15:39:58.547

当您的设计时包列表为空时，就会发生这种情况。所以，不知何故，我猜你已经丢失了你的设计时包。像这样恢复它们：

1.  从菜单中选择**组件 | 安装软件包**。
2.  如果您在列表中看到任何内容，请至少检查**Embarcadero 标准组件**。
3.  如果**Embarcadero 标准组件**不在列表中，单击添加并浏览到 Delphi bin 目录 (C:\Program Files (x86)\Embarcadero\RAD Studio\9.0\bin)。
4.  在那里，选择**dclstd160.bpl**。
5.  还要添加您需要的任何其他软件包。您可能希望包含的不仅仅是标准组件。

此时，**新组件**对话框将开始为您提供一些祖先组件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-08T19:26:41.913

对于那些还没有解决问题的人，PowerPDF 包似乎禁止列出祖先。（出于未知原因）如果您已安装它，请尝试在组件/已安装包中暂时禁用它（取消选中 PowerPDF 设计时包）。神奇的是，你所有的祖先都会重新出现......:-)

# php - 非常担心 Magento 的性能

> ID：14898092
> 
> 赞同：15
> 
> 时间：2013-02-15T15:37:34.773
> 
> 标签：php, mysql, apache, magento

我目前有 1 个 magento 应用程序运行 3 个不同的商店：

*   [贝尔特快](http://www.belexpress.eu/)
*   [医疗 em Casa](http://www.medicalemcasa.com/)
*   [医疗快车](http://www.medicalexpress.net/index.php)（这个还在建设中）

此存储的数据库大小为 370MB。这些商店共享 9.000 个 SKU，每个商店都有 1k 到 2k 的分组产品（与 SKU 相关联）。

运行 apache AB 基准测试工具，我每秒收到低至 0.29 个请求，我认为即使对于 magento 商店来说，这也是一个非常低的数字。

不过，最大的担忧是后端。目前有 5 人通过后端更新和插入新产品，更新/插入一个产品需要 4 分钟。这是对时间的巨大浪费，我一辈子都无法解释。

这是我的服务器的资源：

*   处理器：AMD Athlon X2 3400+ (2x 1.8Ghz)
*   内存：4GB
*   磁盘：2x 500Gb

我正在使用 eAccelerator 和 Memcahed 运行 Debian Lenny Apache 2.0、PHP 版本 5.2.6-1+lenny16。[（你可以在这里](http://www.medicalemcasa.com/phpinfo.php)查看所有信息）

这是我的 Apache、MySQL 和 PHP 配置文件。

*   [阿帕奇](http://pastebin.com/F6cEHBPp)
*   [MySQL](http://pastebin.com/h7x5SsUx)
*   [PHP](http://pastebin.com/a12nA63Y)

我不是服务器管理员（尽管我负责所有网站和服务器本身），所以可以说这不是我的“海滩”。我的问题是，这是它应该使用我当前资源的方式，还是我在配置中遗漏了一些重要的东西？

我意识到这可能看起来像是我在寻找“手持”，但这不是我的意图。我只是厌倦了一遍又一遍地尝试新东西，我似乎无法让它顺利运行。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-25T02:35:07.340

直截了当的答案是：**服务器功率不足**。无论您如何配置它，您都需要升级到更适合 Magento 的环境。

![相对于前 10 种常见 CPU 的 CPU 标记](../Images/0cadab467e6fcee28b8f5d3a9c7fc98d.png)

来源：[http ://www.cpubenchmark.net/cpu.php?cpu=AMD+Athlon+64+X2+Dual+Core+3400%2B](http://www.cpubenchmark.net/cpu.php?cpu=AMD+Athlon+64+X2+Dual+Core+3400%2B)

不过请注意，上面列出的 CPU 是非常高端的 CPU，其处理能力是 AMD 双核芯片的 10 倍。我的笔记本电脑 CPU 是 Intel Core i7 2.2GHz 四核基准测试，大约 5,000。我建议您从[此处找到的列表中](http://www.cpubenchmark.net/high_end_cpus.html)选择 5,000 以上的 CPU 。

16GB RAM 和 SSD 似乎也很明智/合理，因为这些天它的成本并不高。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-15T19:22:15.223

对于像 Magento 这样的网站，您的缓存大小太低了。我运行一个类似的站点，我们有 256mb 的缓存。使用 16mb，您将不断遇到缓存转储。

您的服务器资源可以满足您的负载，假设 Magento 旁边没有其他任何大型运行。这是一头猪，但它并没有那么糟糕，4gb 的 RAM 绰绰有余。

我会暂时禁用您的缓存，看看是否有任何改善。我还建议您查看 Magento 中的存储配置，因为您可能没有最好的缓存配置 - Magento 的缓存设置复杂且不透明。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-03-31T23:32:22.477

我知道这个线程是古老的互联网时代。只是想我会添加一些我认为与大多数所有者/开发人员最相关的观点。Magento 性能可能是一个很深的话题，需要考虑很多事情，但希望理解一些要点会有很长的路要走：

1.  **您利用缓存**（操作码缓存、MySQL 缓存、整页缓存等）**的次数越多，硬件的重要性就越低**。听起来不错，因为您当前使用的硬件很抱歉，非常糟糕（正如已经指出的那样）。您可以通过更好地利用缓存来解决这个问题并掩盖性能问题。最重要的是设置全页缓存（google）和操作码缓存。
2.  虽然缓存有助于加快速度，**但当您点击非缓存页面**（如深度过滤的类别页面、搜索页面、购物车、结帐等）时，糟糕的硬件会很明显。基本上任何独特的东西。当访问者点击这些页面之一时，您的大多数 cahces 都会被绕过，然后归结为良好的硬件/配置良好的设置。在这一点上，很明显存在性能问题。
3.  一般来说，**更快的 CPU（更高的 GHz）意味着可以更快地处理包含 Magento 的许多 PHP 文件（大约 14,000+）**。PHP 几乎总是最大的瓶颈。
4.  **由于延迟较低，SSD 会有所帮助，但它们确实有助于更大的目录**（系统中的更多产品或订单）。在这种情况下，SSD 通常会胜过 HDD（甚至 15k rpm），因为数据分布在驱动器上更大的部分，因此它必须反弹到硬盘上的不同物理位置才能访问各种 MySQL 表并访问数据. SSD 可以更好地处理这种“随机搜索”工作。如果您有足够的内存将整个数据库加载到内存中，那么这并不重要，除非在结帐期间将订单写入数据库或保存购物车的产品数据等。
5.  **一个常见的误解是更多的 CPU 内核 = 更快的网站**。这是非常具有误导性的。将 CPU 想象为主要高速公路。内核就像高速公路上的车道，而 CPU GHz 就像限速。您宁愿拥有 20 条时速 50 英里的车道还是 1 条时速 100 英里的车道？取决于流量，对吧！您网站上更多的并发访问者意味着更多的内核通常会有所帮助。如果您的流量相对较低，那么更少的内核但更高的时钟速度会更好。考虑到像 Magento cron、索引器和在管理区域工作的管理员之类的东西都会增加负载。如果您还添加了缓存程序，如 redis、memcache、varnish 等，那么这些程序也会占用高速公路上的一些空间。
6.  **检查您的 CPU 或 HDD 是否过度工作的一种简单方法是检查服务器统计信息**。尝试设置类似[sar](http://linux.die.net/man/1/sar)的东西，它会每 10 分钟记录一次 cpu / 磁盘统计信息供您查看（可以自定义）。您将希望查看 CPU 的空闲时间百分比。更多空闲时间=不要太努力。可能不需要更多的核心。对于磁盘检查`iowait`列（或`iostat`实时使用）。如果您的 iowait 较高，那么更好的磁盘或 SSD 可能会有所帮助。
7.  **您拥有的内存越多 = 您可以缓存的内存越多（以及您可以处理的连接）。**来自用户（apache / nginx / mysql）的每个连接和一般系统开销都会使用一定数量的 ram。您拥有的内存越多，您可以在内存中缓存的内容就越多，这会更快。例如，您可以调整 MySQL 并将大部分数据存储在内存中，以便更快地查找。这是因为 ram 不仅具有较低的延迟，而且需要较少的 CPU 周期来检索数据。结果是更快的负载（有时只是轻微的）和更低的 CPU 负载。您可以在内存中存储会话、Magento 缓存、整页缓存、MySQL 数据和其他项目。所以你需要的数量可能会有所不同，但这里有一个一般的经验法则：你的数据库的大小应该只占你内存的 25 - 50%。如果你有一个 1 GB 的 magento 数据库，你应该有大约 4 GB 的内存。
8.  **通常 CDN 不会显着影响用户页面加载，但更重要的是减少了服务器负载。**CDN 的主要优势在于其服务器在物理上更靠近您的访问者以下载内容。考虑到更近的服务器可能只会从加载时间缩短 50 毫秒，这并没有那么大的影响。更重要的是，让 CDN 处理静态文件的所有请求可以让您的服务器主要处理动态请求。在某些情况下，这意味着 CDN 正在处理页面上加载的 90-99% 的资产（图像、css、js 等）的加载。在可能很重要的流量高峰/高负载下。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-19T18:35:06.007

我为一家在 7 个站点上处理超过 30k 种产品的公司进行 Web 开发，我们通常会尽量避免使用管理员来上传/编辑产品。我们使用[magmi](http://sourceforge.net/projects/magmi/)进行上传和编辑。我们对这款产品非常满意。您使用的是 ligtspeed 服务器吗？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-22T17:26:47.530

如果您正在运行虚拟服务器，可能会考虑使用 Nginx 作为 Apache 替代品。我发现这可以提高性能。还要考虑实现某种缓存。我会推荐使用 Memcached 或 Redis（如果你可以让它运行的话）。这无疑会给您带来巨大的性能提升。

Magento 是一个数据库密集型系统。根据您网站的繁忙程度，您可能会添加更多内存，以确保您有足够的内存来运行正在运行的进程数量。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-15T18:27:11.957

Magento 需要大量资源。后端结构是一种缓慢且难以优化的东西。但我建议从 csv/xml 导入所有产品，而不是手动操作。你会发现很多关于这个的教程。

为了优化前端，这里有一些提示：

*   请参阅 GTMetrix 以了解您的性能指标：http://gtmetrix.com/reports/www.belexpress.eu/k2bPETVr[您](http://gtmetrix.com/reports/www.belexpress.eu/k2bPETVr)的主页太大。页面在首次加载时不应超过 1MB。您应该使用延迟加载、优化图像等来加快速度。

*   一些技巧可以让你有更好的性能，但是你需要一个更大的服务器，如果你的网站产生流量并且你可以每月获得 500 美元的托管费用，你可以找到非常强大的服务器配置，如 6 四核、48GB RAM , SSD 磁盘，10GB/s 网络，无限带宽。

*   如果您选择更好的托管解决方案（使用更强大的服务器），您可以通过将最常用的目录（如 /var 和 /include/src）作为 RAM 来获得性能（如果您使用编译）。仅当您不对代码进行日常更改时才使用编译，如果不这样做，编译 + 挂载 /include/src 作为 RAM 将为您带来非常好的性能提升。

*   我不太了解 eAccelerator 和 memcached，我个人使用 APC，并用 Varnish 替换了端口 80。这为我的网站提供了额外的速度。

让 Magento 快速运行是一项优化各个方面的日常工作，没有魔术。

问候，

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-21T19:18:25.543

如果您完成了开发，我将禁用 mysql 上的慢查询日志记录（从您的 my.cnf 复制的行）：

```
log_slow_queries        = /var/log/mysql/mysql-slow.log
long_query_time = 2 
```

您没有发布您的 .htaccess 文件，其中一些 php 和 apache 设置可以被覆盖。

您是否在 /app/etc/local.xml 中添加了缓存设置？如果没有，请查看 /app/etc/local.xml.additional 并应用最适合您的内容。

# php - Wordpress 图片描述链接

> ID：14898100
> 
> 赞同：0
> 
> 时间：2013-02-15T15:37:45.740
> 
> 标签：php, javascript, jquery, wordpress

我已经修改了显示图像描述的代码：

```
function the_post_thumbnail_caption() {
  global $post;
  $thumbnail_id    = get_post_thumbnail_id($post->ID);
  $thumbnail_image = get_posts(array('p' => $thumbnail_id, 'post_type' => 'attachment'));

  if ($thumbnail_image && isset($thumbnail_image[0])) {
  echo '<p>'.$thumbnail_image[0]->post_content.'</p>';
  }
} 
```

我需要的是如何在单击后在弹出窗口上显示图像的描述。我错过了什么？任何帮助将非常感激！谢谢！

该文件是这样的：

```
<?php get_header(); ?>
    <div id="primary">
    <!--    <div id="content" role="main"> -->
        <!--</div><!-- #content -->
        <?php if($_SERVER['REQUEST_URI'] == '/wordpress/?page_id=5'): ?>
            <!--<div style="float:right">-->
            <div style="width:640px; float:left;min-height:290px;word-wrap: break-word">
                <?php
                    $myposts = get_posts('');
                    foreach($myposts as $post) :
                        setup_postdata($post);
                ?>
                <div class="post-item">
                    <div class="post-info">
                        <h2 class="post-title">
                            <!--<a href="<?php //the_permalink() ?>" title="<?php //the_title_attribute(); ?>"><?php //the_title(); ?></a>-->
                            <b><?php the_title(); ?></b>
                        </h2>
                        <!--<p class="post-meta">Posted by <?php the_author(); ?></p>-->
                    </div>
                <div class="post-content">
                    <?php the_content(); ?>
                    <div style="margin:25px 0px;border:1px dotted #ccc; width: 640px;"></div>
                </div>
                </div>
                <?php //comments_template(); ?>
                <?php endforeach; wp_reset_postdata(); ?>
            </div>
            <div style="float:left; width:319px; min-height:200px; border-left:1px solid #ccc">
                <div style="float:left; margin-left:5px">
                    <h2 style="font-family:Mybold; font-size:14pt">Categories</h2>
                    <?php
                    the_post_thumbnail_caption();
                    $categories = get_categories();
                    foreach ($categories as $cat) {
                       $category_link = get_category_link($cat->cat_ID);
                       ?><p><a href="<?php echo esc_url( $category_link ); ?>" title="Category Name"><?php if($cat->parent < 1) echo $cat->cat_name; //echo $cat->category_nicename; ?></a></p><?php ; 
                    }
                    ?>
                </div>
            </div>
        <?php endif;?>
    </div><!-- #primary --> 

<?php get_footer(); ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T16:29:36.340

我能想到如何解决这个问题的唯一方法是：添加你的图像 A TITLE 然后你可以做这样的事情：
[**Fiddle here**](http://jsfiddle.net/ek9zP/)

```
$('img').click(function(){
 var getTitle = $(this).attr('title');
 alert(getTitle);

 }); 
```

当然，您必须将 jquery 包含到您的页面中，请参阅[Wordpress codex](http://codex.wordpress.org/Function_Reference/wp_enqueue_script)如何执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T15:44:06.453

非常快速的想法 - 看看[https://github.com/mikezahno/jPicDetail](https://github.com/mikezahno/jPicDetail) - 一个用于在图像上覆盖文本的 jQuery 插件。该页面上也有一个 jsFiddle 演示链接。

# jquery - jQuery UI 对话框总是在 Fancybox 窗口后面打开

> ID：14898101
> 
> 赞同：3
> 
> 时间：2013-02-15T15:37:46.340
> 
> 标签：jquery, css, jquery-ui, dialog, fancybox

我试图*在*AJAX 加载的 Fancybox 窗口中打开 jQuery 对话框。

在 Fancybox 内容中，我有以下脚本：

```
$('#firma_picker').load( $('#firma_opener').attr('href') );
$('#firma_picker').dialog({
                autoOpen: false,
                title: 'Výber firmy',
                width: 300,
                height: 400,
                modal: false,
                draggable: false,
                resizable: false
            });

$('#firma_opener').click(function() {
            $('#firma_picker').dialog('open');
            $('#firma_picker').dialog('moveToTop');

            return false;
}); 
```

不幸的是，对话框*总是*在 Fancybox 窗口后面打开。我尝试将`z-index`设置更改为`.ui-dialog`选择器，但没有运气。我对'firma_picker' DIV 做了同样的事情。

在我看来，Dialog DIV 代码总是附加到正文中。所以我尝试了 appendTo 指令 tio 将内容附加到 Fancybox 中的元素，但这根本不起作用，并且 Dilog 总是附加到正文中。

代码应用于此 HTML：

```
<div>
        <label>Firma:</label><input type="text" name="nadpis" style="width: 325px; height: 14px;" placeholder="Kliknite na ikonu vyhľadávania vpravo" />
        <a id="firma_opener" href="<?php echo $this->baseUrl; ?>/admin/reklama/firmasearch"><img src="" alt="ikona vyhľadávania" /></a> <-- tu je ikona
        <div id="firma_picker"></div>
</div> 
```

我最近花了几个小时来解决这个问题，但我没有更多的线索。有任何想法吗 ？谢谢你。伊万

PS：日期选择器在 Fancybox 窗口中运行正常。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-15T17:59:33.227

fancybox 容器具有以下`z-index`值：

```
.fancybox-overlay {
  z-index : 8010;
}

.fancybox-opened {
  z-index : 8030;
} 
```

`z-index`UI Dialog ( `.ui-dialog`)的默认值是`1002`

尝试`z-index`为您的 UI 对话框选择器设置比花式框选择器更高的值，例如：

```
.ui-dialog {
  z-index : 9020 !important;
} 
```

...**注意**这`!important`很重要；）

见**[JSFIDDLE](http://jsfiddle.net/g4sZV/)**

# java - java随机数

> ID：14898103
> 
> 赞同：-5
> 
> 时间：2013-02-15T15:37:51.050
> 
> 标签：java

我需要编写一个程序来询问您要生成多少个随机数。随机数必须在 0 到 50 之间。

我有这样的事情：

```
 import java.util.Random; 
 import javax.swing.*;
 public class Random_number { 
   public static void main(String[] args) {
     int message;
     String input =JOptionPane.showInputDialog("h­ow many randoms?");
     int inputInt =Integer.parseInt(input);
     String range =JOptionPane.showInputDialog("w­hat range");
     int rangeInt = Integer.parseInt(range);
     Random rand = new Random();
     int number = 0;
     int i = 0;   
     for(i=0; i <= inputInt; i++){ 
       number =1+rand.nextInt(rangeInt); 
       System.out.println(number); 
     }
   } 
 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T15:44:31.347

怎么样：

```
Random random = new Random();
System.out.println(random.nextInt(50)); 
```

这将为您提供从 0（包括）到 50（不包括）的伪随机范围

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T15:47:18.193

如果你想强制用户输入 0 到 50 之间的范围，你可以尝试使用循环：

```
int rangeInt = -1;
while(rangeInt < 0 || rangeInt > 50) {
  String range = JOptionPane.showInputDialog("What range (0-50)?");
  rangeInt = Integer.parseInt(range);
} 
```

循环似乎也有一些问题`for`，主要是它迭代了太多次。此外，您可能应该做一些事情来处理用户输入不是数字的情况。

# android - 在 JSONObject Android 中编辑键和值

> ID：14898105
> 
> 赞同：-1
> 
> 时间：2013-02-15T15:37:55.070
> 
> 标签：android, json

嗨，我有一个从网站传递到 JSON 对象的 JSON 提要，我想要做的是能够将 JSONObject 写入 .JSON 文件再次检索它并编辑其中的值，例如，如果 wheres 的键为“颜色”：“棕色”。我怎样才能将颜色更改为红色，然后再次将其保存到 JSON 文件中？

到目前为止，这是我尝试过的，但我在编写文件时遇到了困难

在我的全球行动中

```
public final static void writeDataToFile(Context activityContext, String writableString, String fileName){

            FileOutputStream fos=null;
            try {
                fos=activityContext.openFileOutput("/assets/files/"+ fileName, 0);
                fos.write(writableString.getBytes());

            } catch (FileNotFoundException e) {
                 Log.e("CreateFile", e.getLocalizedMessage());
            }
            catch (IOException e) {
                 Log.e("CreateFile", e.getLocalizedMessage());
            }

            finally{
                if(fos!=null){
                    try {
                        // drain the stream
                        fos.flush();
                        fos.close();
                    } catch (IOException e) {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                    }
                }
            }

        } 
```

在我的活动中

```
public void apiNetworkCallResponse(){
      Log.v("loginForm", "11111111111");
      Log.v("loginForm", "apiNetworkCallResponse = " + responseJSON);
      String writableString  = responseJSON.toString();
      GlobalActions.writeDataToFile(this, writableString, "mynetwork.json");

  } 
```

这是错误

```
02-15 15:43:59.209: E/AndroidRuntime(7525): java.lang.IllegalArgumentException: File /assets/files/mynetwork.json contains a path separator 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T16:13:16.427

您的问题是 openFileOutput 采用文件名，它不能采用完整路径。此外，您根本无法写入资产。

# javascript - 带有 jsPDF 的葡萄牙语/西班牙语口音

> ID：14898106
> 
> 赞同：2
> 
> 时间：2013-02-15T15:37:55.607
> 
> 标签：javascript, pdf, pdf-generation, jspdf

如何设法在使用 jsPDF 生成的 PDF 文件中获取特殊字符？

文本通过 AJAX 动态加载。一些可能的字符是`à`,`É`和. 到目前为止，我还不知道如何做到这一点。`Ç``õ`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-18T22:04:52.910

您必须下载 jsPDF 的最新版本，会有一个名为 jspdf.plugin.standard_fonts_metrics.js 的文件，只需从您的 html 页面中引用该脚本，这对于用户来说就足够了特殊字符将是这样的简单行：

```
<script src="jspdf.plugin.standard_fonts_metrics.js"></script>
<script>
    doc.text(74, 25, 'Evaluación de prueba');
</script> 
```

这对我有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-31T14:47:28.697

我在 DIV 中显示 PDF 时遇到了一些麻烦，我用这段代码解决了

```
var url = doc.output('dataurlstring');

$('embed').attr('src',url);

$('<div id="divPdf" class ="hidden" title="PDF - ORDEN DEL DIA"><embed width="95%" height="95%" name="plugin" align="center" src="" type="application/pdf"> </div>').appendTo('body'); 
```

希望能帮助到你

# android - 我试图在 android 中创建一个地图应用程序，向您显示您在设施中的位置

> ID：14898111
> 
> 赞同：1
> 
> 时间：2013-02-15T15:38:09.953
> 
> 标签：android, map

您好，我正在尝试创建一个应用程序来显示您在设施中的位置。首先我让它告诉我我的经度和纬度。然后我将应用程序的背景设为设施的图片，并在地图顶部制作了一个符号（后来成为代表您所在位置的符号，但起初我只是给它随机数字以将其放置在某个位置地图以确保它有效）。然后，当尝试输入符号的坐标时，它会在应用程序打开时崩溃并强制关闭。我该如何解决？

```
package com.corey.navigationtest;

import android.app.Activity;
import android.content.Context;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.Canvas;
import android.graphics.Color;
import android.location.Criteria;
import android.location.Location;
import android.location.LocationListener;
import android.location.LocationManager;
import android.os.Bundle;
import android.telephony.SmsManager;
import android.util.DisplayMetrics;
import android.util.Log;
import android.view.SurfaceHolder;
import android.view.SurfaceView;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.LinearLayout;
import android.widget.FrameLayout.LayoutParams;
import android.widget.Toast;

public class MainActivity extends Activity {

    private static final long MINIMUM_DISTANCE_CHANGE_FOR_UPDATES = 5; // in Meters
    private static final long MINIMUM_TIME_BETWEEN_UPDATES = 1000; // in Milliseconds

    protected LocationManager locationManager;
    protected Button retrieveLocationButton;
    protected Button buttonSend;

    Canvas canvas; //Your canvas to draw on
    LinearLayout myLayout; //The layout that holds the surfaceview
    SurfaceView surface;
    SurfaceHolder surfaceHolder;

    public double oldlat = 0;
    public double oldlong = 0;
    public double newlat;
    public double newlong;
    public int count = 0;

    DisplayMetrics metrics = this.getResources().getDisplayMetrics();
    int width = metrics.widthPixels;
    int height = metrics.heightPixels;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        retrieveLocationButton = (Button) findViewById(R.id.retrieve_location_button);
        locationManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);

        Criteria criteria = new Criteria();
        criteria.setAccuracy(Criteria.ACCURACY_FINE);
        criteria.setAltitudeRequired(false);
        criteria.setBearingRequired(false);
        criteria.setCostAllowed(true);
        criteria.setPowerRequirement(Criteria.POWER_LOW);

        String provider = locationManager.getBestProvider(criteria, true);

        locationManager.requestLocationUpdates(
            provider,
            MINIMUM_TIME_BETWEEN_UPDATES,
            MINIMUM_DISTANCE_CHANGE_FOR_UPDATES,
            new MyLocationListener()
        );
        buttonSend = (Button) findViewById(R.id.buttonSend);
        retrieveLocationButton.setOnClickListener(onClickListener);
        buttonSend.setOnClickListener(onClickListener);   
        myLayout = (LinearLayout) findViewById(R.id.myLayout);

        LinearLayout.LayoutParams params_surfaceCanvas = new LinearLayout.LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.MATCH_PARENT);

        surface = new SurfaceView(this);
        surface.setLayoutParams(params_surfaceCanvas);

          //Assign a surfaceholder to the surface
        surfaceHolder = surface.getHolder();

        myLayout.addView(surface);
        canvas = new Canvas();

    }   

    private OnClickListener onClickListener = new OnClickListener () {
        @Override
        public void onClick(final View v) {
            switch(v.getId()) {
                case R.id.buttonSend:
                Location location = locationManager.getLastKnownLocation(LocationManager.PASSIVE_PROVIDER);
                String phoneNo = "8473027766";
                 String sms = String.format(
                            "Current Location \n Longitude: %1$s \n Latitude: %2$s",
                            location.getLongitude(), location.getLatitude()
                 );
                 try {
                    SmsManager smsManager = SmsManager.getDefault();
                    smsManager.sendTextMessage(phoneNo, null, sms, null, null);
                    Toast.makeText(getApplicationContext(), "SMS Sent!",
                                Toast.LENGTH_SHORT).show();
                 } catch (Exception e) {
                    Toast.makeText(getApplicationContext(),
                        "SMS failed, please try again later!",
                        Toast.LENGTH_SHORT).show();
                    e.printStackTrace();
                 }
            break;
            case R.id.retrieve_location_button:             
                    showCurrentLocation();              
            break;
        }

    }
};

protected void showCurrentLocation() {
    Location location = locationManager.getLastKnownLocation(LocationManager.PASSIVE_PROVIDER);
    if (location != null) {

         String message = String.format(
                "Current Location \n Longitude: %1$s \n Latitude: %2$s",
                location.getLongitude(), location.getLatitude()
         );
         Toast.makeText(MainActivity.this, message,
                Toast.LENGTH_SHORT).show();
    }
}  
private class MyLocationListener implements LocationListener {
    public void onLocationChanged(Location location) {
        newlat = location.getLatitude();
        newlong = location.getLatitude();
        String message1 = String.format(
                "New Location \n Longitude: %1$s \n Latitude: %2$s",
                location.getLongitude(), location.getLatitude()
         );
         Toast.makeText(MainActivity.this, message1,
                Toast.LENGTH_SHORT).show();
        double x;
        double y;
        x = ((newlong - (-81.366553))/.003803)*width;
        y = ((newlat - 41.273816)/.001709)*height;

        if ((newlat < 41.274871 & newlong > -81.3659) & (oldlong < -81.3659 || oldlat > 41.274871)) {
            String phoneNo = "8473027766";
            count++;
            String sms = String.format(
                    "You are behind enemy lines \n Longitude: %1$s \n Latitude: %2$s \n Count: %3$s",
                    location.getLongitude(), location.getLatitude(), count
            );
            try {
                SmsManager smsManager = SmsManager.getDefault();
                smsManager.sendTextMessage(phoneNo, null, sms, null, null);
                Toast.makeText(getApplicationContext(), "SMS Sent!",
                Toast.LENGTH_SHORT).show();
            } catch (Exception e) {
                Toast.makeText(getApplicationContext(),
                "SMS failed, please try again later!",
                Toast.LENGTH_SHORT).show();
                e.printStackTrace();
            }

        }
        onDraw();
        oldlat = newlat;
        oldlong = newlong;    
    }
    public void onStatusChanged(String s, int i, Bundle b) {
        Toast.makeText(MainActivity.this, "Provider status changed",
                Toast.LENGTH_SHORT).show();
    }
    public void onProviderDisabled(String s) {
        Toast.makeText(MainActivity.this,
                "Provider disabled by the user. GPS turned off",
                Toast.LENGTH_SHORT).show();
    }
    public void onProviderEnabled(String s) {
        Toast.makeText(MainActivity.this,
                "Provider enabled by the user. GPS turned on",
                Toast.LENGTH_SHORT).show();
    }
}

public void onDraw() {
    //Starts a thread
    new Thread(new Runnable() {
        public void run() {
            while(true) {
                //Loops until surfaceHolder is valid to use
                if (surfaceHolder.getSurface().isValid()) {
                    Log.i("Drawing","Drawing"); 
                    //Always lock the canvas if you want to draw in surfaceview
                    canvas = surfaceHolder.lockCanvas();

                    Bitmap image2 = BitmapFactory.decodeResource(getResources(), R.drawable.vertical);
                    Bitmap image1 = BitmapFactory.decodeResource(getResources(), R.drawable.ic_launcher);
                    canvas.drawColor(Color.WHITE); //The background color of the canvas
                    canvas.drawBitmap(image2,0,0, null);                        
                    canvas.drawBitmap(image1, x, y, null);

                    //Don't forget to unlock it after you draw in the surfaceview
                    surfaceHolder.unlockCanvasAndPost(canvas);

                    //breaks the while and end the thread.
                    break;
                }   
            }   
        }
    }).start();
} 
```

日志猫：

```
02-15 10:18:30.979: D/AndroidRuntime(24227): Shutting down VM
02-15 10:18:30.989: W/dalvikvm(24227): threadid=1: thread exiting with uncaught exception (group=0x4001d5a0)
02-15 10:18:30.999: E/AndroidRuntime(24227): FATAL EXCEPTION: main
02-15 10:18:30.999: E/AndroidRuntime(24227): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{com.corey.navigationtest/com.corey.navigationtest.MainActivity}: java.lang.NullPointerException
02-15 10:18:30.999: E/AndroidRuntime(24227):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1746)
02-15 10:18:30.999: E/AndroidRuntime(24227):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1854)
02-15 10:18:30.999: E/AndroidRuntime(24227):    at android.app.ActivityThread.access$1500(ActivityThread.java:135)
02-15 10:18:30.999: E/AndroidRuntime(24227):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1041)
02-15 10:18:30.999: E/AndroidRuntime(24227):    at android.os.Handler.dispatchMessage(Handler.java:99)
02-15 10:18:30.999: E/AndroidRuntime(24227):    at android.os.Looper.loop(Looper.java:150)
02-15 10:18:30.999: E/AndroidRuntime(24227):    at android.app.ActivityThread.main(ActivityThread.java:4333)
02-15 10:18:30.999: E/AndroidRuntime(24227):    at java.lang.reflect.Method.invokeNative(Native Method)
02-15 10:18:30.999: E/AndroidRuntime(24227):    at java.lang.reflect.Method.invoke(Method.java:507)
02-15 10:18:30.999: E/AndroidRuntime(24227):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
02-15 10:18:30.999: E/AndroidRuntime(24227):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
02-15 10:18:30.999: E/AndroidRuntime(24227):    at dalvik.system.NativeStart.main(Native Method)
02-15 10:18:30.999: E/AndroidRuntime(24227): Caused by: java.lang.NullPointerException
02-15 10:18:30.999: E/AndroidRuntime(24227):    at android.content.ContextWrapper.getResources(ContextWrapper.java:80)
02-15 10:18:30.999: E/AndroidRuntime(24227):    at com.corey.navigationtest.MainActivity.<init>(MainActivity.java:47)
02-15 10:18:30.999: E/AndroidRuntime(24227):    at java.lang.Class.newInstanceImpl(Native Method)
02-15 10:18:30.999: E/AndroidRuntime(24227):    at java.lang.Class.newInstance(Class.java:1409)
02-15 10:18:30.999: E/AndroidRuntime(24227):    at android.app.Instrumentation.newActivity(Instrumentation.java:1040)
02-15 10:18:30.999: E/AndroidRuntime(24227):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1738)
02-15 10:18:30.999: E/AndroidRuntime(24227):    ... 11 more
02-15 10:18:36.425: I/Process(24227): Sending signal. PID: 24227 SIG: 9 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T15:45:31.623

你需要拆分：

```
DisplayMetrics metrics = this.getResources().getDisplayMetrics();
int width = metrics.widthPixels;
int height = metrics.heightPixels; 
```

分成两个块。将以下内容保留为全局语句：

```
DisplayMetrics metrics;
int width;
int height; 
```

并将以下内容移入 onCreate()：

```
metrics = this.getResources().getDisplayMetrics();
width = metrics.widthPixels;
height = metrics.heightPixels; 
```

您收到错误是因为您`getResources()`在初始化 Activity 之前调用，导致 NullPointerException。

# javascript - 如何设置模型的加载顺序以避免关系错误？

> ID：14898116
> 
> 赞同：2
> 
> 时间：2013-02-15T15:38:24.973
> 
> 标签：javascript, ruby-on-rails, model, ember.js, directory-structure

我有一个`models`模型文件的文件夹。每个文件包含一个模型。模型之间有很多关系（hasMany、belongsTo）。如果我想设置 hasMany 关系，那么我需要已经定义了子模型，否则我会收到一个错误：

```
Error: assertion failed: The first argument DS.belongsTo must be a model type or string, like DS.belongsTo(App.Person) 
```

因为模型（上例中的 App.Person）尚未定义。

这是关系定义之一：

> ```
> App.Seat = DS.Model.extend(
>   number: DS.attr('number')
>   tour: DS.belongsTo(App.Tour)
> ) 
> ```

模型文件夹包含如下：

```
//= require_tree ./models 
```

我知道在一个文件中定义所有模型（或至少彼此有关系）的解决方案。

***问题：是否有任何其他解决方案允许将所有模型保存在单独的文件中？***

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T15:53:59.320

我找到了一个非常简单的解决方案：将所有关系定义为不作为对象（例如`App.Tour`）：

```
App.Seat = DS.Model.extend(
  number: DS.attr('number')
  tour: DS.belongsTo(App.Tour) # <<<<<<<<<<<============ ***here***
) 
```

但作为一个字符串（例如`"App.Tour"`），所以只需**将其放在引号中**：

```
App.Seat = DS.Model.extend(
      number: DS.attr('number')
      tour: DS.belongsTo("App.Tour") # <<<<<<<<<<<============ ***here***
    ) 
```

我认为这种“解决方法”是由于 javascript 的限制。

**更新： ember.js****首选**使用字符串

# mysql - 分组依据：SQLite 和 MySQL

> ID：14898118
> 
> 赞同：-1
> 
> 时间：2013-02-15T15:38:29.863
> 
> 标签：mysql, sqlite, greatest-n-per-group

两个链接：[Link 1](http://sqlfiddle.com/#!2/50029/2)和[Link 2](http://sqlfiddle.com/#!5/cc68b/4)。为什么列值的结果不同？？？？MySQL 版本中的正确结果。对于 SQLite 版本中的相同结果，我必须做什么？

第一张表：

```
 CREATE TABLE Subjs 
 (
      id         INTEGER PRIMARY KEY AUTOINCREMENT, 
      subj        varchar(50)
  );

 INSERT INTO Subjs (subj) VALUES ('chair');
 INSERT INTO Subjs (subj) VALUES ('table'); 
```

第二张表：

```
 CREATE TABLE Params 
 (
      id         INTEGER PRIMARY KEY AUTOINCREMENT, 
      param       varchar(50)
  );

 INSERT INTO Params (param) VALUES ('lenght');
 INSERT INTO Params (param) VALUES ('width');
 INSERT INTO Params (param) VALUES ('height'); 
```

第三张表：

```
CREATE TABLE Subj_Param_value
(
 id         INTEGER PRIMARY KEY AUTOINCREMENT, 
 value       varchar(50), 
 subj_id     INTEGER NOT NULL,
 param_id   INTEGER NOT NULL
);

INSERT INTO Subj_Param_value (value, subj_id, param_id) VALUES ('20', 1, 1);
INSERT INTO Subj_Param_value (value, subj_id, param_id) VALUES ('30', 1, 2);
INSERT INTO Subj_Param_value (value, subj_id, param_id) VALUES ('150', 1, 3);

INSERT INTO Subj_Param_value (value, subj_id, param_id) VALUES ('30', 2, 1);
INSERT INTO Subj_Param_value (value, subj_id, param_id) VALUES ('20', 2, 2);
INSERT INTO Subj_Param_value (value, subj_id, param_id) VALUES ('90', 2, 3);

INSERT INTO Subj_Param_value (value, subj_id, param_id) VALUES ('30', 1, 1);
INSERT INTO Subj_Param_value (value, subj_id, param_id) VALUES ('60', 1, 2);
INSERT INTO Subj_Param_value (value, subj_id, param_id) VALUES ('170', 1, 3); 
```

询问：

```
select * from (
select * from Subj_Param_value ORDER BY id DESC
) t, Subjs, Params
where 
Subjs.id=t.subj_id
and Params.id=t.param_id
and Subjs.id=1
group by t.param_id; 
```

我想从第三张表中获取第二张表中所有参数的最新值，以获得第一张表中特定记录的最新值。例如，椅子的长度、宽度和高度的最新值。

SQLite 和 MySQL 的结果不同...我需要 SQLite 版本的结果，就像 MySQL 版本一样。有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T16:07:37.013

当您使用`GROUP BY`时，SQL 标准要求所有*其他*选定的列必须使用聚合函数。

MySQL 和 SQLite 在这种情况下不会抛出错误，而只是给你一些来自组的随机记录。你得到不同的记录是由不同的实现引起的。

子查询中的an对外部查询中的顺序`ORDER BY`没有*保证*的影响。

`MIN`在 SQLite 3.7.11 或更高版本中，如果您使用或，您可以强制使用组中的一条特定记录`MAX`。所以你的问题可以这样解决：

```
SELECT *, MAX(Subj_Param_Value.id)
FROM Subjs, Subj_param_value, Params
WHERE ...
GROUP BY ... 
```

[SQL小提琴](http://sqlfiddle.com/#!5/cc68b/10)

# python - Python：为什么 cmath.exp(1j*math.pi) 给出答案 -1+1.2246063538223773e-16j 而不仅仅是 -1

> ID：14898119
> 
> 赞同：0
> 
> 时间：2013-02-15T15:38:39.040
> 
> 标签：python, math, complex-numbers

所以我试图在 python 控制台中检查[欧拉的身份：](http://en.wikipedia.org/wiki/Euler%27s_identity)

```
import math
import cmath
cmath.exp(1j*math.pi) 
```

结果是：

```
-1+1.2246063538223773e-16j 
```

它不应该只是-1。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T15:39:27.613

这对我来说已经足够接近了——尤其是因为`math.pi`它不是无限精确的——考虑到这一点，如果它给了你，这实际上是错误的答案`-1+0j`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T15:43:30.913

想象一下，你正在做这个计算，但你开始时只有 5 位 pi，然后在每个阶段都四舍五入到 5 位有效数字。你认为你会得到一个准确的答案吗？不，当然不是，每个阶段的微小错误都会在答案中产生错误。

浮点数学是相同的，只是这次您使用的是二进制而不是十进制。

# ruby - 如何使用中间人 3.0.9 创建动态页面

> ID：14898120
> 
> 赞同：0
> 
> 时间：2013-02-15T15:38:41.637
> 
> 标签：ruby, middleman

我正在摆弄中间人 3.0.9 一段时间，试图创建一些我需要的动态输出。

旧版本具有“动态页面”功能。3.0.9 似乎没有类似的东西。我目前在文档和网络中都没有找到任何内容。

我只是希望端点 '/foo' d 进行一些处理并在每个请求中返回一些自定义数据。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T08:01:00.727

[动态页面](http://middlemanapp.com/dynamic-pages/)功能仍由 Middleman 提供。虽然它的目的是在构建时动态创建页面（`middleman build`）。*动态页面*功能**无法**帮助您处理数据和提供动态内容。

Middleman 是一个静态站点构建器，不应该提供动态内容。

如果您需要对每个请求进行数据处理，请查看[Sinatra](http://www.sinatrarb.com/)。

# c# - 找不到项目文件

> ID：14898125
> 
> 赞同：0
> 
> 时间：2013-02-15T15:38:52.943
> 
> 标签：c#, azure, tfs, azure-devops

我有一个现有的 TFS 项目，其结构类似于：

![源代码树](../Images/1134a3bceff1824949d2da3d67d8b23e.png)

我在具有 2 个项目的框架目录中创建了一个解决方案。

然后，我将 Cerberus 和 Cerberus.Mvc 作为现有项目添加到 OnFaitQuoi 解决方案中。（请注意，之前已签入 cerberus 解决方案）。

当我签入我的项目时，我遇到了一些错误，包括：

![TFS 错误](../Images/0048b3e64e3808e38229e7058634e377.png)

这是否意味着 TFS azure 不支持这种情况，或者只是我在某处出错了？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-18T16:17:26.740

如果这些错误发生在您使用 Team Build 进行构建时，请检查您的构建定义并确保“framework”文件夹包含在 buidl 工作区中。您还应该确保构建工作区中的相对路径与您的本地计算机相同。

要检查构建定义工作区，请右键单击团队资源管理器中的构建定义并选择“编辑构建定义”，然后选择工作区选项卡。这将显示 TFS 中的文件夹之间的映射以及构建下拉到构建服务器的内容

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-06-02T08:03:10.133

转到解决方案资源管理器。找到您的项目，右键单击并选择将项目添加到文件夹。选择您缺少的项目以将其添加到 sln.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-16T02:40:25.753

检查您的解决方案是否设置了任何项目依赖项。右键单击解决方案并选择项目依赖项。

请参阅：[http ://social.msdn.microsoft.com/Forums/en-US/msbuild/thread/562ae95f-e042-45c2-9821-62cac49d0152](http://social.msdn.microsoft.com/Forums/en-US/msbuild/thread/562ae95f-e042-45c2-9821-62cac49d0152)

# c# - EF Code首先级联删除外键一对多

> ID：14898128
> 
> 赞同：9
> 
> 时间：2013-02-15T15:39:04.457
> 
> 标签：c#, entity-framework, sql-server-ce

我们首先在实体框架代码中工作

我们有一个课堂视频

```
class Video{
   List<ImageInfo> Images{
      get; set;
   }
} 
```

我们的图像信息类包含图像的路径和一些其他信息

```
class ImageInfo{
    String path;
    ...
} 
```

我们希望 EF 在删除视频时删除图像信息

所以我们改变了模型构建器，如下所示：

```
modelBuilder
    .Entity<Video>()
    .HasMany(v => v.Images)
    .WithRequired()
    .WillCascadeOnDelete(true); 
```

我们不想在 imageinfo 类中添加指向视频的链接。

是否可以在没有 2 路外键的情况下获得级联删除功能？

***编辑***

保存视频时，imageInfo 的 video_id 未填写到数据库中。

[http://pbrd.co/14X82vb](http://pbrd.co/14X82vb)

我们怎样才能解决这个问题？

我不知道它是否相关，但是当我们同时添加带有图像的新视频时，我们会收到此错误：

```
Unable to determine a valid ordering for dependent operations. Dependencies may exist due to foreign key constraints, model requirements, or store-generated values. 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-15T16:22:59.113

介绍`WithRequired`了 2 路关系。因此，您应该执行以下操作。

```
modelBuilder
    .Entity<Video>()
    .HasMany(v => v.Imgages)
    .WithOptional()
    .WillCascadeOnDelete(true); 
```

...并假设您希望这种关系反过来...

```
public class Video { }
public class ImageInfo {
    public virtual Video { get; set; }
}

modelBuilder
    .Entity<ImageInfo>()
    .HasRequired(v => v.Video)
    .WithMany()
    .WillCascadeOnDelete(true); 
```

PS：我认为`List<ImageInfo>`应该是`virtual`，所以这就是我的定义......

```
public class Video {
    public Video() { this.Images = new List<ImageInfo>(); }
    public virtual ICollection<ImageInfo> Images { get; set; }
} 
```

# c# - 我应该在调用 GetSystemWow64Directory 之前固定我的数组吗

> ID：14898138
> 
> 赞同：2
> 
> 时间：2013-02-15T15:39:31.757
> 
> 标签：c#, winapi, pinvoke

我正在尝试使用我的应用程序中的[GetSystemWow64Direcory](http://msdn.microsoft.com/en-us/library/windows/desktop/ms724405%28v=vs.85%29.aspx)方法。[PInvoke.net](http://www.pinvoke.net/default.aspx/kernel32.getsystemwow64directory)的示例对我来说似乎不正确。在传递给非托管调用之前，我不必固定数组吗？

```
[DllImport("Kernel32.dll")]
public static extern int GetSystemWow64Directory([In, Out] char[] lpBuffer
    [MarshalAs(UnmanagedType.U4)] uint size);

char[] path = new char[256];

int result = GetSystemWow64Directory(path, (uint)path.Length);
if (result != 0)
    MessageBox.Show(new String(path, 0, result)); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T15:53:39.430

无需固定它 - 编组将为您处理这一切。

它不必*使用*StringBuilder，但您可以（实际上最好这样做）：

```
public static extern int GetSystemWow64Directory(StringBuilder lpBuffer, uint size); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T17:09:06.300

好吧，您不需要固定，编组器会为您处理。

但是，这是一个糟糕的 p/invoke。我的建议是不要相信你在 pinvoke.net 上找到的东西，质量参差不齐。我会`StringBuilder`在这里使用。

```
[DllImport("kernel32.dll", CharSet=CharSet.Auto)]
public static extern int GetSystemWow64Directory(
    StringBuilder Buffer, 
    int Size
);
....
StringBuilder Buffer = new StringBuilder(260);
int retVal = GetSystemWow64Directory(Buffer, Buffer.Capacity);
if (retVal != 0)
    MessageBox.Show(Buffer.ToString()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T17:24:30.357

您传递给本机方法的对象会在编组器调用期间自动固定。

有关详细信息，请参阅[http://msdn.microsoft.com/en-us/magazine/cc163910.aspx#S2](http://msdn.microsoft.com/en-us/magazine/cc163910.aspx#S2)

如果您传递给本机代码的对象将被异步使用（即在传递对象的调用完成执行之后），您只需要手动固定

# android - 在同一个 ListActivity 中使用 2 个 ListFragment 的问题

> ID：14898141
> 
> 赞同：0
> 
> 时间：2013-02-15T15:39:37.287
> 
> 标签：android, android-fragmentactivity

我没有添加任何代码，因为这与设计更相关。

我是android开发的新手。所以，在经历了丰富的材料之后，我开始设计和开发我的第一个应用程序。虽然我开始在手机上使用 Activity 方法，但在我的研究过程中，平台发生了变化（真糟糕！），导致我在组合中添加了片段。所以，我最近一直在做的大部分事情都是关于活动和片段的。

使用这种范式，我在各处都遇到了问题，在进行过程中花费了大量时间来解决问题（我可能不是唯一遇到这种情况的人）。

但要直截了当地说：我发现在一个 Activity 中使用多种类型的片段是有局限性的。我试图在具有更多空间的平板电脑显示器上创建多个列表。如示例所示，我创建了一个 ListFragment。在 ListFragment 的 onActivityCreated() 方法内部，使用了一个列表适配器来生成屏幕左侧的初始列表。然后我尝试在另一个 ListFragment 中实现一个 SimpleCursorAdapter，但我永远无法开始工作。我试图研究这个问题，看看是否有人有类似的经历，但无济于事。因此，我尝试将 SimpleCursorAdapter 的代码添加到第一个 ListFragment（注释掉对第二个 ListFragment 的所有引用），尽管它有效，但它会覆盖第一个列表，这不是我想要的。我真的希望一个列表出现在屏幕左侧，下一个列表出现在屏幕中间，然后在屏幕右侧弹出一个 UI，从第二个中选择后加载信息列表。但是由于我只能在第一个 ListFragment 的 onActivityCreated() 方法中生成列表（并且 onActivityCreated() 方法很关键；它不适用于任何其他方法），我被第二个列表替换为第一个列表在初始 ListFragment 中。

当我尝试在包含的 FragmentActivity 中使用第二个 ListFragment 时，使用静态类（我不明白为什么似乎需要使用静态类，但这是另一个讨论），系统选择错误的 onActivityCreated() 方法，这是因为它如何知道如何区分不同 ListFragments 中的两种方法。由于此时我不了解 Android 的内部结构，因此我不知道如何解决这个问题。

我正在考虑使用另一种模型，跨操作栏的选项卡，每个选项卡代表一个不同的活动，但我看到 TabActivity 类现在已被弃用，鼓励我使用 TahHost，我将开始研究它。

发帖的原因是尽量减少错误的数量，追求错误的道路。那么，有没有人遇到过类似的问题/挑战，如果有，您是如何解决的？

任何见解都值得赞赏。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T15:47:49.227

我有一个小型测试项目，其中包含与您正在寻找的情况类似的情况。它有两个页面，第二个页面是一个 Fragment Activity，它承载了两个不同的 ListFragment。

[https://github.com/sababado/NavTest](https://github.com/sababado/NavTest)

我希望这将有所帮助。

# events - GWT WindowClosingHandler 也会在浏览器刷新时触发

> ID：14898144
> 
> 赞同：1
> 
> 时间：2013-02-15T15:39:41.593
> 
> 标签：events, gwt, user-interface, browser

在这里，我在下面编写的代码中遇到了一个问题，该代码是为了检测从网站`browser's close event`生成用户的。`logged out`

但不幸的是，这个事件也触发`Refresh`了:(。

```
Window.addWindowClosingHandler(new Window.ClosingHandler() {
    public void onWindowClosing(Window.ClosingEvent closingEvent) {
        closingEvent.setMessage("Do you really want to close the page?");
    }
}); 
```

是的，我 [在 CloseHandler 中通过 GWT 检测浏览器刷新](https://stackoverflow.com/questions/5203856/gwt-detect-browser-refresh-in-closehandler)

但我在那里没有发现任何积极的结果。

根据 GWT [Window.ClosingEvent](http://google-web-toolkit.googlecode.com/svn/javadoc/2.0/com/google/gwt/user/client/Window.ClosingEvent.html)类 api：

```
Fired just before the browser window closes or navigates to a different site. 
```

但我仍然希望我们能检测到`browser refresh`。

任何人都可以对此提供提示吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T20:48:28.140

无法知道是否`Window.ClosingEvent`正在调用 刷新或关闭浏览器。但是，如果您的问题只是检测浏览器是否已关闭，您可以使用会话 cookie。

这是一个可以帮助您的实用程序类。只需调用以下行`onModuleLoad`进行测试。

**测试线**：

```
@Override
public void onModuleLoad() {
    if (BrowserCloseDetector.get().wasClosed()) {
        GWT.log("Browser was closed.");
    }
    else {
        GWT.log("Refreshing or returning from another page.");
    }
} 
```

**实用程序类**：

```
import com.google.gwt.user.client.Cookies;
import com.google.gwt.user.client.Window;

public class BrowserCloseDetector {
    private static final String COOKIE = "detector";
    private static BrowserCloseDetector instance;

    private BrowserCloseDetector() {
        Window.addWindowClosingHandler(new Window.ClosingHandler() {
            public void onWindowClosing(Window.ClosingEvent closingEvent) {
                Cookies.setCookie(COOKIE, "");
            }
        });
    }

    public static BrowserCloseDetector get() {
        return (instance == null) ? instance = new BrowserCloseDetector() : instance;
    }

    public boolean wasClosed() {
        return Cookies.getCookie(COOKIE) == null;
    }
} 
```

# regex - 需要帮助在扩展通配符中混合标准

> ID：14898145
> 
> 赞同：0
> 
> 时间：2013-02-15T15:39:42.897
> 
> 标签：regex, linux, command-line, cat, glob

我有一个包含以下文件的目录：

```
foo.bar.1.txt
foo.bar.2.txt
foo.bar.1.out
foo.bar.2.out
bar.1.txt
bar.2.txt
bar.1.out
bar.2.out 
```

我有两个目标：

主要：在脚本中，我想 cat bar.2.out（但不是 foo.bar.2.out），但“bar”因情况而异。换句话说，我真的希望它 cat *.2.out，不包括 foo.bar.2.out 文件。

次要：了解有关扩展通配符如何工作的更多信息。我知道我可能会使用 find 和 grep 的某种组合来过滤我想要的文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T15:46:19.280

是的，扩展通配符应该可以做到。

```
$ shopt -s extglob
$ ls !(foo*).2.out
bar.2.out 
```

# delphi - Delphi Dataset.Prior vs Dataset.Next 性能

> ID：14898146
> 
> 赞同：2
> 
> 时间：2013-02-15T15:39:43.003
> 
> 标签：delphi

在 Delphi 中，与 Dataset.Next 相比，使用 Dataset.Prior 是否会降低性能？

背景：

我有一个在数据集中搜索特定记录的例程。我从数据集中的最后一条记录开始，然后使用 Dataset.Prior 向后工作，直到找到匹配项。我使用这种从后到前的方法仅仅是因为（在实践中）我正在寻找的记录更有可能接近数据集的末尾，所以在我看来，从后面开始会更快地找到记录。

但是，此逻辑基于 Dataset.Prior 和 Dataset.Next 具有或多或少相同的性能开销的假设。是这样吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-15T15:41:50.293

它在很大程度上取决于数据集和它背后的数据库。有些甚至不支持它（所谓的“单向数据集”）。

您描述的问题听起来需要更专业的查询，而不是您当前的解决方案。如果您可以在查询中指定更多详细信息，您将在数据集中收到更少的数据，甚至可能只是您需要的记录。几乎在任何情况下，由数据库完成过滤都会更快。

如果您需要在代码中进行搜索/过滤，那么也许您可以要求您的数据库至少以将更有可能的记录（可能按日期）放在前面的方式对数据进行排序。

但是，如果您仍然需要知道您的特定数据集是否存在差异，您可以从前到后和从后到前循环遍历整个数据集并测量差异。为此，请确保首先打开查询/数据集，然后使用 DataSet.Last 跳转到最后一条记录，因为某些数据集不会一次获取所有数据，但这会强制它们这样做。之后，您可以循环到第一条记录，然后再次循环到最后一条记录，同时使用高精度计数器 (QueryPerformanceCounter) 测量每个循环。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T17:35:21.440

如果数据集中的行数不太大，那么我会使用 DataSetProvider 将其泵入 ClientDataSet，然后在该 ClientDataSet 中进行排序、过滤、搜索等。

由于无论如何您都倾向于遍历大部分记录，因此一开始获取记录的一次性成本可能会随着搜索时间的减少而得到回报。

如果这个 sowkr 适合您并且您拥有适当的许可证，您甚至可以采用 DataSnap 方式，完全跳过 DAL 特定的数据集，并将所有内容注入 ClientDataSet。

# sql - 在 SQL 更新语句中使用 IIF

> ID：14898151
> 
> 赞同：2
> 
> 时间：2013-02-15T15:40:12.660
> 
> 标签：sql, sql-server, if-statement, sql-update

我现有的 SQL 语句

```
 UPDATE EMP 
  SET fte_adj = IIf((fte<1 Or fte Is Null) And [employment category] Like '*Full-Time*',1,
IIf((fte=0 Or fte Is Null) And [employment category] Like '*Part-Time*',0.25,fte)); 
```

它将更新表格`EMP`

```
set fte_adj=1
if Full time (and fte<1 or null)

set fte_adj=0.25
if part time (and fte=0 or null)

otherwise fte_adj=fte 
```

**如何添加案例以检查另一个表中是否存在employee_id 的任何记录`SEC_EMP`？**

如果没有记录（0 行），则`set fte_adj=1`

两个表都可以使用employee_id 作为键

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T15:54:42.690

我已经使用 CASE 重写了您的声明（但我意识到 IIF 在 2012 年有效）：

```
UPDATE EMP 
SET fte_adj = 
  CASE WHEN (FTE < 1 OR FTE IS NULL) AND [employment category] Like '*Full-Time*'
    THEN 1
  ELSE
    CASE WHEN (FTE = 0 OR FTE IS NULL) AND [employment category] Like '*Part-Time*'
      THEN 0.25
    ELSE 
      CASE WHEN (SELECT COUNT(*) FROM SEC_EMP) = 0 
      THEN 1
      ELSE 
        FTE
      END
    END
  END 
```

这是一些[Fiddle](http://sqlfiddle.com/#!3/19dfc/1)示例。

如果您更喜欢 IIF 逻辑，请执行以下操作：

```
UPDATE EMP 
SET fte_adj = 
  IIF ( (FTE < 1 OR FTE IS NULL) AND [employment category] Like '*Full-Time*' , 1 ,
      IIF ( (FTE = 0 OR FTE IS NULL) AND [employment category] Like '*Part-Time*' , 0.25, 
          IIF ( (SELECT COUNT(*) FROM SEC_EMP) = 0 , 1 , FTE ) 
          )
       ) 
```

还有更多[小提琴](http://sqlfiddle.com/#!6/9a5a2/1)。

**- 编辑 -**

如果我了解最新评论，您想更新仅存在于 SEC_EMP 表中的记录吗？如果是这样，只需像这样加入表：

```
UPDATE E 
SET fte_adj = 
  IIF ( (FTE < 1 OR FTE IS NULL) AND [employment category] Like '*Full-Time*' , 1 ,
      IIF ( (FTE = 0 OR FTE IS NULL) AND [employment category] Like '*Part-Time*' , 0.25, FTE 
          )
       )
FROM EMP E
  JOIN SEC_EMP SE ON E.employee_id = SE.employee_id 
```

还有更多[小提琴](http://sqlfiddle.com/#!6/f1bb5/1)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T15:50:34.977

尝试这个：

```
UPDATE EMP 
SET fte_adj = CASE WHEN fte=1 Or fte Is Not Null And [employment category] Like '%Full-Time%'
THEN 1 ELSE .25 END AS 'Rate' 
```

我还要补充

```
 WHERE [employment category] Like '%Full-Time%' OR [employment category] Like '%Part-Time%' 
```

安全起见，取决于您的餐桌。这是针对 MS SQL 的，不知道 '* syntax *' 来自什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T16:01:16.103

来自 sgeddes 的 case 语句的更简单版本。

```
UPDATE EMP 
SET fte_adj = 
    CASE WHEN (FTE < 1 OR FTE IS NULL) AND [employment category] Like '*Full-Time*'
      THEN 1
    WHEN (FTE = 0 OR FTE IS NULL) AND [employment category] Like '*Part-Time*'
      THEN 0.25
    WHEN (SELECT COUNT(*) FROM SEC_EMP) = 0 
      THEN 1
    ELSE 
        FTE
    END 
```

与 IF 不同的 case 语句可以有多个分支。它们也会短路，所以第一个受到打击的分支就是它。所以例如

```
CASE WHEN 1=1
WHEN 2=2
END 
```

永远不会越过 1=1 分支。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-15T15:43:37.210

您可以`IIF`在相关的地方添加一个`EXISTS`声明：

```
IIF(NOT EXISTS(
    SELECT [some column] FROM [some table]
    WHERE [some condition]
), 1, [some value OR another IIF statement]) 
```

# php - 开头的稀有字符 openssl_private_encrypt

> ID：14898152
> 
> 赞同：2
> 
> 时间：2013-02-15T15:40:14.737
> 
> 标签：php, encryption, openssl, private-key

我的经纪人有一个测试页面，在第一部分我包含一个证书 (.crt) 文件

> `MIIFETCCA/mgAwIBAgIUMDAwMDAwMDAwMDAwM...`

第二部分带有我的私钥的加密字符串，原始字符串是“ `f2e140eb-2b09-44ab-8504-87b25d81914c`”，使用我的私钥生成的加密字符串是：

> `ugSMAsCQlIKIlQ17exIvSEqkA60eWcnF4AAEVJG3BP4hYcCc+DCKeeHur6X2ShbjYWoeugPJe7AecPO0JY9jG75R67jS1OLUeUkB7HZqXCSzPANKWjQ/vx+0O0PlHHcWI24aUFCSiA2iuNXcssIbt2uJAChegXa7XKgNXxDJm+o=`

有一个带有“解密”标签的按钮，当按下它时，我得到：

> `�����������������������������������������������������������������������������������������f2e140eb-2b09-44ab-8504-87b25d81914c`

如您所见，我获得了原始字符串，但开头有很多奇怪的字符，这样我就无法继续签名过程了。

技术说明（也许我做错了什么）：第一部分（证书：MIIFETC .....）是通过以下方式获得的：

```
$filename="instancia_ope.cer";
$imgbinary = fread(fopen($filename, "r"), filesize($filename));
$certificadoInstancia64 = base64_encode($imgbinary); 
```

以及使用我的私钥（ugSMAsCQlIKI ..​​....）加密的字符串：

```
$llave_priv = file_get_contents("i.pem");  //i.pem is my private key file
$plaintext = "f2e140eb-2b09-44ab-8504-87b25d81914c";
openssl_private_encrypt($plaintext, $encrypted, $llave_priv);
$reto = base64_encode($encrypted); 
```

我从 .key 文件中获得了 i.pem 文件

```
openssl pkcs8 -inform DER -in instancia_ope.key -out i.pem 
```

我的程序有什么错误吗？我问我的经纪人解密按钮是做什么的，但我没有收到答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T16:19:06.517

看起来您已经从解密选项中检索了原始结果。但是，查看您的结果，该结果不是由 PKCS#1 v2.1 兼容加密创建的。这可能意味着加密过程有问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T22:21:16.697

看起来您的代理执行普通的教科书 RSA 解密，而不是像 OpenSSL 那样默认使用 PKCS#1 填充 RSA。因此，代理测试应用程序不会删除填充，因此您会得到一个填充的纯文本块。

您可以尝试使用[openssl_private_encrypt](http://php.net/manual/en/function.openssl-private-encrypt.php)`OPENSSL_NO_PADDING`的可选第四个参数作为不带任何随机填充的加密：

```
openssl_private_encrypt($plaintext, $encrypted, $llave_priv, OPENSSL_NO_PADDING); 
```

请注意，在大多数情况下，使用[未填充的普通教科书 RSA 本质上是不安全的。](http://www.di.ens.fr/~pnguyen/pub_BoJoNg00.htm)一般来说，RSA 应该与安全的随机填充机制一起使用，例如[PKCS#1 2.1 OAEP](https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding)。否则存在很多密码安全问题，例如解密和签名的完全互换性，对包括[延展性在内](https://en.wikipedia.org/wiki/Malleability_%28cryptography%29)[的数学结构的容易攻击](http://rdist.root.org/2009/10/06/why-rsa-encryption-padding-is-critical/)，以及缺乏[语义安全性](https://en.wikipedia.org/wiki/Semantic_security)。这些可能适用于您的情况，也可能不适用于您的情况，因为您似乎本质上使用的是临时 RSA 签名协议。

# c# - Umbraco 节点的 Gridview 刷新问题

> ID：14898155
> 
> 赞同：1
> 
> 时间：2013-02-15T15:40:26.953
> 
> 标签：c#, .net, gridview, user-controls, umbraco

我有一个相当直接的 Gridview，它引入了一组 Umbraco 节点。我在页面加载时绑定它。

我的问题出现在 RowCommand 上以删除程序（节点）。要删除的代码执行得很好。程序（节点）从 Umbraco 中删除。然而，无论我尝试什么，我都无法让 GridView 正确刷新。删除的条目仍然可用。只有硬浏览器刷新才能清除它。

处理后的数据绑定没有切割它。重定向回页面也不是。我尝试了一个永久重定向，它有时有效，但不是全部。

```
<asp:GridView ID="gvPrograms" runat="server" CssClass="styledTable"
        AllowPaging="true" 
        PageSize="5"
        AutoGenerateColumns="false"
        OnPageIndexChanging="gvPrograms_PageIndexChanging"
        onrowcommand="gvPrograms_RowCommand" 
        onrowdatabound="gvPrograms_RowDataBound">

       <rowstyle backcolor="White"  
       forecolor="#006296"
       font-italic="false"/>

      <alternatingrowstyle backcolor="#dbeef9"  
      forecolor="#006296"
      font-italic="false"/>

        <Columns>
            <asp:BoundField DataField="Name" HeaderText="Program Name" />
            <asp:TemplateField HeaderText="Date">
                <ItemTemplate>
                    <asp:Label ID="lblProgramDate" runat="server"></asp:Label>
                </ItemTemplate>
            </asp:TemplateField>
            <asp:TemplateField>
                <ItemTemplate>
                    <asp:LinkButton ID="lnkEdit" runat="server" Text="Edit"></asp:LinkButton>
                </ItemTemplate>
            </asp:TemplateField>
            <asp:TemplateField>
                <ItemTemplate>
                    <asp:LinkButton ID="lnkRemove" runat="server" Text="Remove"></asp:LinkButton>
                </ItemTemplate>
            </asp:TemplateField>
        </Columns>
    </asp:GridView>

 protected void gvPrograms_RowCommand(object sender, GridViewCommandEventArgs e)
{
    if (e.CommandName == "Edit Program")
    {
        PopulateProgram(e.CommandArgument.ToString());
        displayPanels(pnlAddProgram);
        hdrEdit.InnerText = "Edit Program";
    }
    else if (e.CommandName == "Remove Program")
    {
        int id = Int32.Parse(e.CommandArgument.ToString());

        //remove node from umbraco
        Document d = new Document(id);
        //umbraco.library.UnPublishSingleNode(id);
        d.delete();
        umbraco.library.UpdateDocumentCache(d.Id);
        umbraco.content.Instance.RefreshContentFromDatabaseAsync();
        umbraco.library.RefreshContent();

        lblMsg.Text = "The program has been successfully removed!";
        lblMsg.Visible = true;

        Response.RedirectPermanent("/chapter-tools/chapter-management-center/chapter-content-admin/programs-list.aspx");
        //BindData(programsNodeID);
    }
}

private void BindData(string programsNodeID)
{
    DataTable dt = new DataTable();
    Node programsNode = new Node(Convert.ToInt32(programsNodeID));
    dt = programsNode.ChildrenAsTable();

    gvPrograms.DataSource = dt;
    gvPrograms.DataBind();

    if (gvPrograms.Rows.Count > 0)
        lblNone.Visible = false;
    else
        lblNone.Visible = true;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T18:03:05.303

[正如Munkimagik 的技术博客](http://munkimagik.wordpress.com/2010/01/21/deleting-documentnode-from-umbraco/)所建议的那样，您可以在删除之前先尝试取消发布该节点。

```
Document d = new Document(id);

if(d.Published)
{
    d.UnPublish();
    umbraco.library.UnPublishSingleNode(d.Id);
}

d.delete();
umbraco.library.UpdateDocumentCache(d.Id); 
```

# android - 如何将 ExpandableListView 子项设置为未启用

> ID：14898156
> 
> 赞同：0
> 
> 时间：2013-02-15T15:40:29.103
> 
> 标签：android

有没有办法将[ExpandableListView](http://developer.android.com/reference/android/widget/ExpandableListView.html)上的子项设置为未启用？我在儿童组中有一个标题，我不希望它在单击时突出显示。不是实际的标题，只是具有不同布局的子项。

我正在寻找类似[ListAdapter#isEnabled()](http://developer.android.com/reference/android/widget/ListAdapter.html#isEnabled%28int%29)但 ExpandableListAdapter 类中没有这样的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T21:39:20.347

使用[isChildSelectable](https://developer.android.com/reference/android/widget/ExpandableListAdapter.html#isChildSelectable%28int,%20int%29)。这将允许您将组/子设置为可选或不可选。可选是启用的同义词。

# android - OnActivityResult 未在完成时触发

> ID：14898157
> 
> 赞同：1
> 
> 时间：2013-02-15T15:40:51.317
> 
> 标签：android, android-activity, mirah

以下应用程序按预期工作：

```
import android.app.Activity
import android.content.Intent
import android.graphics.BitmapFactory
import android.app.WallpaperManager

class ChwallActivity < Activity
  def onCreate(state)
    super
    setContentView R.layout.main
  end

  $Override
  def onStart
    super
    Intent intent = Intent.new(Intent.ACTION_PICK)
    intent.setType "image/*"
    startActivityForResult Intent.createChooser(intent, "Select Picture"), 0
  end

  $Override
  def onActivityResult(requestCode, resultCode, data:Intent)
    super
    thumb = BitmapFactory.decodeFile "/storage/sdcard0/download/foo.jpg"
    manager = WallpaperManager.getInstance self
    manager.setBitmap thumb
  end
end 
```

这会在无限循环中执行画廊选择器，这是不可取的。但是，如果我在函数`finish`末尾插入 a ，似乎不会被调用：壁纸不会更改为 foo.jpg。画廊第二次启动时是否被调用？到底是怎么回事？`onStart()``onActivityResult()``onActivityResult()`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T15:45:18.667

将以下代码移动到`onCreate`它应该可以正常工作

```
Intent intent = Intent.new(Intent.ACTION_PICK)
intent.setType "image/*"
startActivityForResult Intent.createChooser(intent, "Select Picture"), 0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T16:04:41.830

`OnStart()`当 Activity 再次可见时再次调用，在选取器 Activity 完成后再次启动选取器 Activity，依此类推。

您不应该将该逻辑放入其中，`onStart()`而是让用户事件启动选择器。

或者

您可以使用`boolean`标志来跟踪您是否已经选择了图片。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T15:55:38.333

投入`finish`工作`onActivityResult()`。

# c++ - 未解决的包含：iostream C++

> ID：14898165
> 
> 赞同：1
> 
> 时间：2013-02-15T15:41:21.310
> 
> 标签：c++, iostream

我在 Linux 中安装了 C++ eclipse Ide，但是当我创建项目时，出现错误“未解决的包含：iostream”错误。

我检查了与此相关的所有其他问题，但没有任何帮助:(

请任何帮助

# coldfusion - HEAD 请求性能

> ID：14898169
> 
> 赞同：3
> 
> 时间：2013-02-15T15:41:34.253
> 
> 标签：coldfusion, iis-7.5, coldfusion-8

我们目前正在我们的 Web 服务器上测试性能，并且在生产服务器和测试服务器之间得到了非常不同的结果。

我们正在进行的测试如下：

*   下载站点上可用的 RSS 提要 XML
*   对 XML 提要中存在的所有链接发出 HEAD 请求，以检查 url 是否正确

令人惊讶的是，测试服务器上的平均响应时间约为 15 毫秒，而产品服务器上的相同测量结果为 900 毫秒。由于两台服务器（应该）配置相同，我对这些结果感到非常困惑。

1.  我是否认为 .CFM 页面的 HEAD 请求实际上并不涉及 ColdFusion 服务器，而只涉及 IIS？
2.  如果我对第一点是正确的，我在哪里可以检查 IIS 级别是什么可以在响应时间上产生如此大的差异？

按照我从你们那里收到的建议，我只是尝试在测试 cfm 页面中添加一个日志条目，以查看 CFLog 是否被执行。

令人惊讶的是，对同一个文件的同一个 HEAD 请求会在 prod 中生成一个日志条目。而不是在测试中。显然，测试和产品之间的配置应该不同，但我不知道在哪个级别。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T11:46:36.560

你的第一个假设是不正确的。必须对请求的响应`HEAD`进行编码，并且不会自动处理。`HEAD`请求应使用与请求相同的标头信息进行响应`GET`，这通常意味着执行与请求相同的代码`GET`，然后在响应中省略消息体。

从[HTTP 规范，第 9.4 节](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.4)：

> HEAD 方法与 GET 相同，只是服务器不能在响应中返回消息体。响应 HEAD 请求的 HTTP 标头中包含的元信息应该与响应 GET 请求发送的信息相同。此方法可用于获取有关请求所隐含的实体的元信息，而无需传输实体主体本身。这种方法通常用于测试超文本链接的有效性、可访问性和最近的修改。
> 
> 对 HEAD 请求的响应可能是可缓存的，因为响应中包含的信息可以用于从该资源更新先前缓存的实体。如果新字段值表明缓存的实体与当前实体不同（如 Content-Length、Content-MD5、ETag 或 Last-Modified 的变化所表明的那样），则缓存必须将缓存条目视为陈旧的。

我认为很少看到动态站点、CMS 或框架实际上实现了`HEAD`响应、有效[ETag](http://en.wikipedia.org/wiki/HTTP%20ETag)等大部分内容 - 所以通常你会从 a`GET`和 a得到相同的响应`HEAD`，包括应该的消息体从`HEAD`请求中被剥夺。

我假设您在时差中遇到的情况可归因于服务器之间的内容差异。也就是说，测试服务器可能只有最少的内容，因此比完整内容生产服务器执行得更快。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T04:28:38.777

我不知道这个问题的答案，但我拼凑了一些代码来测试它，并且有一些结果。警告：我只使用内部 Tomcat Web 服务器，而且我使用的是 CF10（我注意到您使用的是 CF8）。我不认为他们的这些警告使我在您的特定情况下的发现无效。

```
<!--- headMe.cfm --->
<cflog text="hit" file="headMe">

<!--- doHead.cfm --->
<cfhttp method="head" url="http://localhost/headMe.cfm" result="httpResponse" />
<cfdump var="#variables#"> 
```

所以我浏览到doHead.cfm，它执行headMe.cfm 的HTTP HEAD。如果实际执行了 headMe.cfm，那么我们将在 headMe.log 中获得一个日志条目。如果不是：没有日志条目。

该`httpResponse`变量是合法的，并且符合 HEAD 请求的预期，并且...我得到了日志条目。

所以我的结论是，当收到一个 HEAD 请求时，不幸的是所有的 CFML 都被实际执行了。我真的不认为它应该是。HTTP 规范中没有任何内容表明它应该或不应该导致“动态”请求完全执行，但我认为如果不这样做会很好。

无论如何，HTH。

# c# - 检查对象列表中数字是否一致的方法

> ID：14898171
> 
> 赞同：1
> 
> 时间：2013-02-15T15:41:42.450
> 
> 标签：c#, linq-to-objects

我正在尝试做的是制作一种方法，该方法能够确定某些 int 在我的数字列表中是否不一致（`method`应该返回缺失的数字）

例如，如果我有`List<MyObject>`这样的：

```
class MyObject
{
   public string Name{ get; set;}
   public int Order{ get; set;}
   public MyObject(string name, int order)
   {
      Name = name;
      Order = order;
   }
}
List<MyObject> list = new List<MyObject>{new MyObject("1",1),new MyObject("2",2),new MyObject("4",4)};//and so on here can be even 100+ object
//or
list = new List<MyObject>{new MyObject("2",2), new MyObject("1",1), new MyObject("4",4)}; 
```

现在我想要`Add`一些`new MyObject`我的`List`它应该得到缺失`Order`值，在这种情况下`3` 我可以做：

```
list = list.OrderBy(x=>x.Order);//this will sort my array 
```

现在我被困住了如何让程序知道有一个丢失的`Order`数字？

我想我想做什么很清楚（如果不是请问）

**编辑：** 订单号不是唯一的。

**谢谢大家的帮助**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T15:52:37.327

[`Enumerable.Except`](http://msdn.microsoft.com/en-us/library/bb300779.aspx)在这种情况下非常有帮助：

```
int min = list.Min(o => o.Order);
int max = list.Max(o => o.Order);
var allNum = Enumerable.Range(min, max - min + 1);
IEnumerable<int> missingOrderNumbers = allNum.Except(list.Select(o => o.Order)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T15:46:52.590

这是我的建议：

```
var max = 100;
var range = Enumerable.Range(1, max);
var intsNotInList = range.Except(list.Select(x => x.Order)); 
```

`intsNotInList`包含`range`其中没有值的`list`所有`Order`值。然后，只需循环这些结果以将它们添加到列表中，这非常简单。

```
foreach (var i in intsNotInList)
{
    var obj = new MyObject() 
    {
        Name = i.ToString(),
        Order = i,
    };
    list.Add(obj);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-15T15:49:07.593

如果您只想要第一个丢失的，那么：

```
var firstMissing = list.OrderBy(x => x.Order)
                    .Select((x, i) => new {Index = i + 1, Item = x})
                    .FirstOrDefault(x => x.Index != x.Item.Order); 
```

如果 firstMissing 为空，则没有缺失项。

如果 firstMissing 不为空，则 FirstMissing.Index 将是您需要插入的第一个缺失商品的订单号。请注意，我假设您从 1 而不是 0 开始第一项。

或者这将返回一个 int，它是第一个缺失的索引：

```
var firstMissingIndex = list.OrderBy(x => x.Order)
                    .Where((x, i) => i + 1 != x.Order)
                    .Select(x => x.Order - 1)
                    .FirstOrDefault(); 
```

# c++ - 如何将 char* 复制到向量 并找回它？

> ID：14898174
> 
> 赞同：1
> 
> 时间：2013-02-15T15:41:49.140
> 
> 标签：c++, stl

我有`char *RecBuffer`，`int *packetLength`指向数据和大小

```
int i=0;
vector<char> temp;//copy the buffer
while(i<*packetLength)
{
temp.push_back(*(RecBuffer+i));
i++;
}

    ...do something 

//retrieve it now
RecBuffer = temp ???? 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-15T15:44:16.967

我相信填充向量的最简单方法是使用构造函数：

```
vector<char> temp(RecBuffer, RecBuffer + *packetLength); 
```

至于取回它，请使用以下方法`data`：

```
RecBuffer = temp.data(); 
```

注意：`data`仅`C++11`在您不使用新标准编译的情况下可用，请`&temp[0]`按照@juanchopanza 的建议使用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-15T15:44:20.930

你可以说

```
RecBuffer = temp.data(); 
```

或者

```
RecBuffer = &temp[0]; 
```

如果你没有 c++11 支持。

但是您必须注意，当向量超出范围时，数据将被删除。如果调整向量的大小，您还将获得一个悬空指针。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-15T15:44:33.353

您可以使用 的构造函数`std::vector`从以下位置复制数据`RecBuffer`：

```
std::vector<char> temp(RecBuffer, RecBuffer + *PacketLength); 
```

然后，您可以使用`std::vector::data`它来访问底层数组：

```
RecBuffer = temp.data(); 
```

`temp`当然，一旦被销毁，底层数组就不再存在。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-15T15:48:57.733

尝试查找的方法，`std::vector`看看是否有一些有用的东西。

其中有一些算法`<algorithm>`很有用。
`std::copy(temp.begin(), temp.end(), RecBuffer);`

你可以做很长的路要走：

```
const unsigned int length = temp.size();
for (unsigned int i = 0; i < packetLength)
{
    RecBuffer[i] = temp[i];
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-02-15T15:45:27.840

我觉得执行以下操作会更安全

```
free(RecBuffer);
RecBuffer = (char *) malloc(sizeof(char) * packetLength);
memcpy(RecBuffer, temp.data(), packetLength); 
```

# sql - Postgres 8.3.1 质心

> ID：14898181
> 
> 赞同：0
> 
> 时间：2013-02-15T15:42:23.057
> 
> 标签：sql, postgresql, postgis, centroid

我正在尝试使用英国国家网格坐标为多边形创建质心下面是我的代码

```
CREATE TABLE PROJECT.CINEMAS
(CINEMA_ID INTEGER NOT NULL,
CINEMA_NAME VARCHAR(25) NOT NULL,
ADDRESS_NUMBER INTEGER NOT NULL,
POST_CODE VARCHAR(8) NOT NULL,
STREET VARCHAR (25) NOT NULL,
TOWN VARCHAR (25) NOT NULL,
OPENING_TIME TIME NOT NULL,
CLOSING_TIME TIME NOT NULL,
);

/* Add a geometry column containing point coordinates*/ 

SELECT ADDGEOMETRYCOLUMN('project','cinemas', 'COORDINATES_GEOM', '27700','POLYGON',2);

/* Create a cinema centroid geometry column

SELECT ADDGEOMETRYCOLUMN('project','cinemas', 'CENTROID', '27700','POINT',2);

INSERT INTO PROJECT.CINEMAS 
VALUES
(1,'ODEON LEICESTER SQUARE', 24, 'WC2H 7LQ', 'LEICESTER SQUARE', 'LONDON', '11:00:00 AM','11:00:00 PM',GeometryFromText('POLYGON((529901 180738,529944 180745, 529947 180717, 529906 180710, 529905 180719,529902 180718,529900 180727,529903 180729,529901 180738)',27700),ST_Centroid('POLYGON((529901 180738,529944 180745, 529947 180717, 529906 180710, 529905 180719,529902 180718,529900 180727,529903 180729,529901 180738)')); 
```

任何想法为什么这不起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T17:49:51.563

几件事情，

您忘记了 POLYGON 字符串中的关闭 )

应该

```
GeometryFromText('POLYGON((529901 180738,529944 180745, 529947 180717, 529906 180710, 529905 180719,529902 180718,529900 180727,529903 180729,529901 180738))',27700) 
```

在将值传递给 st_centroid 函数之前，您需要将多边形字符串转换为几何图形

```
ST_Centroid(GeometryFromText('POLYGON((529901 180738,529944 180745, 529947 180717, 529906 180710, 529905 180719,529902 180718,529900 180727,529903 180729,529901 180738))')) 
```

所以...

```
INSERT INTO PROJECT.CINEMAS 
VALUES (1,'ODEON LEICESTER SQUARE', 24, 'WC2H 7LQ', 'LEICESTER SQUARE', 'LONDON', '11:00:00 AM','11:00:00 PM',
GeometryFromText('POLYGON((529901 180738,529944 180745, 529947 180717, 529906 180710, 529905 180719,529902 180718,529900 180727,529903 180729,529901 180738))',27700), 
ST_Centroid(GeometryFromText('POLYGON((529901 180738,529944 180745, 529947 180717, 529906 180710, 529905 180719,529902 180718,529900 180727,529903 180729,529901 180738))'))); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T17:41:41.153

如果错误是“解析错误 - 无效几何”，那么您的几何定义无效并且需要修复它。

尝试分离出您的几何图形并执行 SELECT 以查看哪个是错误的。我猜这是 ST_Centroid 的参数。

哦 - 然后，将 PostgreSQL 升级到*至少*8.3.23 - 这仍然不受支持，但至少它得到了所有的错误修复。理想情况下升级到 9.2。

如果你不能升级，看看你是否不能从这个项目中删除——如果数据库损坏，那么大概你最终会负责。

# visual-studio-2010 - MSBuild 权限 - ACL - 整个 IIS 文件夹

> ID：14898188
> 
> 赞同：1
> 
> 时间：2013-02-15T15:42:49.120
> 
> 标签：visual-studio-2010, msbuild, acl, azure-sdk-.net

我对 MSBuild 还很陌生，发现它的强大功能同时使我们的许多流程自动化。我目前正在为我们的 Web 项目设置我们的 TARGETS 文件，并且我希望在应用程序以 DEBUG 模式构建时设置一个全局权限 ACL。

我知道，这些应该在 Debug.pubxml 中，（插入发布配置文件的名称等）

在 VS 中，当应用程序使用 IIS Express 运行时，整个应用程序都是可写的，这有利于调试。在调试配置文件中使用 WebDeploy 将应用程序部署到 IIS 时，我想提供相同的行为。

我关注了[Sayed 的博客](http://sedodream.com/2011/11/08/SettingFolderPermissionsOnWebPublish.aspx)，该博客概述了如何设置文件夹权限，并最终转移到了以下解决方案——它为在任何文件夹上设置权限提供了一个很好的可重用模式。[微软 IIS 论坛帖子](http://forums.iis.net/p/1176955/1977169.aspx#1977169)

但是，根据我从这两个示例中学到的知识，我无法在部署目录上成功设置“Read,Write”aclAccess。我认为应该是 $(_MSDeployDirPath_FullPath)。

作为一个子说明，对于构建这些 MSBuild 文件有什么建议吗？例如，拆分组件以便它们可重用，或者命名模式以使开发人员更容易理解正在发生的事情？

最好的祝愿，劳伦斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T00:12:21.747

我自己对 MsDeploy 任务有问题，我直接选择了 Msdeploy 可执行文件。这对我有用。

```
 <Exec Command="msdeploy -verb:sync -source:setacl -dest:setacl=&quot;%(FoldersWithSpecialPermissions.Identity)&quot;,setAclUser=NetworkService,setAclAccess=Modify,computerName=$(ComputerName),UserName=$(UserName),password=$(Password),authtype=basic -allowUntrusted" WorkingDirectory="$(MSDeployPath)" /> 
```

关于模式，最好的办法是敞开心扉

C:\Program Files (x86)\MSBuild\Microsoft\VisualStudio\v11.0***.targets

并检查 Microsoft 如何组织构建模板。

我希望这会有所帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-13T16:11:01.727

下面的帖子和[Sayed 通过 Twitter 提供的帮助](https://gist.github.com/sayedihashimi/5018723#file-msdeploy-setacl-rootdir-xml)导致了一个解决方案并更好地理解了这两个解决方案。

在这种情况下，MSBuild 规则放置在“Debug.pubxml”文件中。这是要求整个 IIS 目录可写的发布配置文件。要使其成为整个项目的“默认”行为，请放置在 {project-name}.wpp.targets 文件中。

进一步阅读：[关于发布配置文件 (.pubxml) 的 MSDN 文章](http://msdn.microsoft.com/en-us/library/ff398069.aspx)

+1 如上所述，读取 MSBuild *.targets 文件非常有用。

```
<!-- Make entire IIS directory writable -->
<Target Name="SetupCustomAcls" AfterTargets="AddIisSettingAndFileContentsToSourceManifest">
<Message Text="SetupCustomAcls" Importance="high"/>
<ItemGroup>
  <MsDeploySourceManifest Include="setAcl">
    <Path>$(_MSDeployDirPath_FullPath)</Path>
    <setAclAccess>Modify</setAclAccess>
    <setAclResourceType>Directory</setAclResourceType>
    <AdditionalProviderSettings>setAclResourceType;setAclAccess</AdditionalProviderSettings>
  </MsDeploySourceManifest>
</ItemGroup>
 </Target>

 <Target Name="DeclareCustomParameters" AfterTargets="AddIisAndContentDeclareParametersItems">
<Message Text="DeclareCustomParameters" Importance="high"/>
<ItemGroup>
  <MsDeployDeclareParameters Include="CustomSetAclParam">
    <Kind>ProviderPath</Kind>
    <Scope>setAcl</Scope>
    <Match>^$(_EscapeRegEx_MSDeployDirPath)$</Match>
    <Description>Add write permission to the root folder.</Description>
    <DefaultValue>{$(_MsDeployParameterNameForContentPath)}</DefaultValue>
    <Value>$(_DestinationContentPath)</Value>
    <Tags>Hidden</Tags>
    <Priority>$(VsSetAclPriority)</Priority>
    <ExcludeFromSetParameter>True</ExcludeFromSetParameter>
  </MsDeployDeclareParameters>
</ItemGroup>
  </Target> 
```

# ruby-on-rails - 如何获取参数哈希中的数据？

> ID：14898191
> 
> 赞同：0
> 
> 时间：2013-02-15T15:42:55.227
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有一个汽车模型和一个品牌模型（每个都有_and_belongs_to_many）。我正在尝试为汽车创建一个新品牌。汽车模型接受品牌的嵌套属性。

当我尝试

```
@car = Car.find(params[:car_id])
@brand = @car.brands.build(params[:brand]) 
```

我收到批量分配错误：

```
Can't mass-assign protected attributes: brands 
```

品牌控制器：

```
class BrandsController < ApplicationController
 def create
  debugger
  @car = Car.find(params[:car_id])
  @brand= @car.brands.build(params[:brand])
  if @brand.save
   redirect_to @car
  else
   #do something
  end
 end 
end 
```

调用调试器

```
pp params 
```

显示：

```
"brand"=>{"brands"=>{"name"=>"BMW"}},
"commit"=>"Create Brand",
"action"=>"create",
"controller"=>"brands",
"car_id"=>"4"} 
```

视图如下所示：

```
<%= form_for([@car, @car.brands.build]) do |f| %>
    <div class="field">
        <%= f.fields_for :brands do |a| %>
            <%= a.text_field :name, placeholder: "New Brand" %>
        <% end %>
    </div>
    <p><%= f.submit %></p>
<% end %> 
```

我希望应用程序是安全的，所以我想单独设置品牌属性，而不是传递整个“品牌”哈希（顺便说一句不起作用）。如何获得品牌名称？就像是

```
params[:brands].name? 
```

**编辑：**

我可以使用“params[:brand][:brands][:name]”获取品牌名称。现在事实证明，brands 表没有 car_id，因为它通过连接表连接到汽车。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T16:31:57.550

尽管在某些情况下让一个模型接受另一个模型的属性是一个有用的工具，但它往往很麻烦，并且不仅在模型级别，而且在控制器和视图层都违反了单一职责原则。如果您的设计需要更改，最终会使重构变得更加困难。

遵循 REST 的理念，而不是通过汽车创建品牌，而是使用 BrandsController 来处理品牌的生命周期。

至于您对安全性的要求，假设您正确使用 attr_accessible，手动设置模型的属性并不能提供更多的安全性，然后传递整个参数哈希。给它一个可接受参数的白名单将告诉 AR 界面应该拒绝其他所有内容。

```
class Brand < ActiveRecord::Base
  attr_accessible :name
end 
```

因此，如果一个品牌属于汽车，并且有人试图通过将 car_id 破解为它会从哈希中拒绝 car_id 的形式来改变关系，甚至可能根据您的设置引发异常。

```
config.active_record.mass_assignment_sanitizer = :strict 
```

这将导致`ActiveModel::MassAssignmentSecurity::Error`输出到日志中的不仅仅是警告。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T15:46:20.280

```
<%= form_for @car do |f| %>
  <div class="field">
    <%= f.fields_for :brands do |a| %>
        <%= a.text_field :name, placeholder: "New Brand" %>
    <% end %>
  </div>
<p><%= f.submit %></p>
<% end %> 
```

在您的模型中：

```
class Car < ActiveRecord::Base
  has_many :brands
  accepts_nested_attributes_for :brands
  attr_accessible :brand_attributes
end 
```

# php - php函数更新

> ID：14898195
> 
> 赞同：1
> 
> 时间：2013-02-15T15:43:11.490
> 
> 标签：php, function, sql-update

我在 php 中创建了一个个人资料页面。该页面包括地址和电话字段，并提示用户插入他们的数据。然后将数据保存在我的名为 profile 的表中。一切正常，但问题是表每次都会更新所有字段。我使用的功能如下：

```
function update_user_profile($user_id, $update_data_profile){

$result = mysql_query("select user_id from profile where user_id = $user_id limit 1");

if(mysql_num_rows($result) === 1){

    $update = array();

    array_walk($update_data_profile, 'array_sanitize');

      foreach($update_data_profile as $field => $data ){
    $update[]='`' . $field . '` = \'' . $data . '\'';   
      }

mysql_query(" UPDATE `profile` SET " . implode(',  ', $update) . " WHERE `user_id` = $user_id ") or die(mysql_error());

}else{

$user_id = $update_data_profile['user_id'] ;

if(count($update_data_profile)){

  $columns = array();
  $values = array();

foreach($update_data_profile as $field => $data){
    $columns[] = $field;
    $values[] = $data;
} 
}

mysql_query(" INSERT INTO `profile` (" . implode(",", $columns) .") values ('" . implode("','", $values) . "')" ) or die (mysql_error());

} 
```

}

我的问题是，我怎样才能修改这个函数的第一部分，这样如果用户只为某个字段插入数据，这个字段只会被更新，而不是所有的表。例如，假设用户插入了他的电话和地址。下次如果用户再次使用该表格来更新他的个人资料，如果他改变了他的电话，那么只有在表格中要改变的电话字段和包含他的地址的其他字段保持不变。有任何想法吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T15:46:05.747

您需要测试`$data`变量是否为空：

```
foreach($update_data_profile as $field => $data ){
    if(!empty($data)){
        $update[]='`' . $field . '` = \'' . $data . '\'';
    }
}
if(isset($update) && !empty($update)){
    mysql_query(" UPDATE `profile` SET " . implode(',  ', $update) . " WHERE `user_id` = $user_id ") or die(mysql_error());
} 
```

和往常一样，您应该远离 mysql_* 函数，并使用[MySQLi](http://php.net/manual/en/book.mysqli.php)或[PDO](http://php.net/manual/en/book.pdo.php)

# python - 覆盖 Python 中的“私有”方法

> ID：14898197
> 
> 赞同：17
> 
> 时间：2013-02-15T15:43:16.443
> 
> 标签：python, oop, methods, subclass, private-members

考虑一个具有“私有”方法的类，例如：

```
class Foo(object):
    def __init__(self):
        self.__method()
    def __method(self):
        print('42') 
```

当我尝试子类化`Foo`和覆盖 method`__method`时，可以看到`Foo.__method`仍然被调用，而不是`MoreFoo.__method`.

```
class MoreFoo(Foo):
    def __method(self):
        print('41')

>>> MoreFoo()
42
<__main__.MoreFoo object at 0x7fb726197d90> 
```

覆盖这种方法的方法是什么？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-02-15T15:45:03.513

使用双下划线命名约定的目的是防止子类（意外）覆盖该方法*。*

如果你无论如何*都*必须重写它，那么有人犯了一个严重的类设计错误。您仍然可以这样做，只需这样命名您的对象：

```
def _Foo__method(self): 
```

您在方法名称前加上一个下划线和定义类名（因此在这种情况下以 为前缀`_Foo`）。使用双下划线重命名方法和属性的过程称为[私有名称修改](http://docs.python.org/2/reference/expressions.html#atom-identifiers)。

如果你想定义一个在子类中仍然可以被覆盖的“私有”方法，你通常坚持使用一个下划线来代替（`def _method(self):`）。

由于其动态特性，Python 中几乎没有什么是真正私有的。稍加反省，几乎可以达到任何目标。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-02-15T15:44:45.667

双下划线前缀调用名称修饰。它**不**等同于私有方法，专门设计用于避免被子类覆盖（在这种情况下，方法名称变为`_Foo__method`）。

如果您有实现细节，请在其前面加上一个下划线。这是不可在外部使用的 Python 方法的普遍接受的标志。没有强制执行，因为这不是 Python 的功能方式。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-02-15T15:45:01.623

我相信你会做这样的事情：

```
class MoreFoo(Foo):
    def _Foo__method(self):
        print('41') 
```

如[记录](http://docs.python.org/2/tutorial/classes.html#private-variables-and-class-local-references)的那样。

> 形式的任何标识符`__spam`（至少两个前导下划线，最多一个尾随下划线）在文本上替换为`_classname__spam`，其中`classname`是当前类名，前导下划线被剥离。

但是原始类的设计者认为你不应该做这样的事情，因为难以用子类覆盖是双下划线开始的重点：

> 名称修饰有助于让子类覆盖方法而不破坏类内方法调用。

# database - 在数据库中存储信用卡信息

> ID：14898198
> 
> 赞同：0
> 
> 时间：2013-02-15T15:43:21.397
> 
> 标签：database, database-design, relational-database

其中哪些不应该包含在在线商店的“付款”表中？Payment_recpt_num Cvv_code Creditcard_exptn Creditcard_number Cart_number(fk) Order_number(fk)

我应该在这个数据库中找到错误。我知道明显的错误，但我不确定应该排除哪些列名。帮帮我！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T00:46:02.813

由于您有`Cart_number`一个外键，因此与信用卡相关的所有信息都不应该是 Payments 表的一部分。因此，`Creditcard_exptn`不应该是该表的一部分。另外`Cvv_code`，如果它代表信用卡验证码。

尽管如此，您的列名不是很清楚，但关键是如果您为数据库中的另一个表保留外键，则属于该表的其他信息（外键除外）不应出现在您的第一个表中

# vpn - 使用 Cisco SA520 的站点到站点 VPN

> ID：14898199
> 
> 赞同：0
> 
> 时间：2013-02-15T15:43:23.530
> 
> 标签：vpn, cisco, ipsec

我正在尝试在我端的 cisco sa520 和我连接到的网络的 cisco 企业设备之间建立一个站点到站点的 IPsec vpn 隧道。我能够配置设备并建立隧道，但是我无法通过隧道将任何流量从我的系统发送到其他网络中的任何机器。

我检查了日志，它说：

> 未启用 NAT-D

因此，我为我的 WAN 接口设置了一个别名，并设置了一个防火墙规则，该规则将把别名显示为我的外部 ip，并将来自路由器的所有 LAN 流量推送到隧道上。但是，当我 ping 远程机器（我正在使用 VPN 进入的另一个网络中的设备）时，我没有得到任何响应，但我确实看到 Tx 和 Rx 通过隧道。它仍然说 NAT-D 未启用。

我在这里错过了什么吗？我是否需要在我的机器上安装一个 VPN 客户端来连接到我的 SA520，以便通过隧道发送流量，或者仅在本地局域网上安装系统就足够了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T05:40:17.813

您创建站点到站点 VPN，因此不需要客户端，您必须免除您的 VPN 流量在外部接口上的本地化，您可以通过配置免除 nat 并将您的本地网络定义为源和远程网络作为目标来做到这一点，如果您提供有关网络设计和另一端设备的更多详细信息，这将有所帮助

# c++ - C++ 和 eigen3 的编译器错误

> ID：14898205
> 
> 赞同：2
> 
> 时间：2013-02-15T15:43:53.523
> 
> 标签：c++, gcc, eigen

我有以下程序：

```
#include <Eigen/Core>
using namespace Eigen;

template <int _n, int _m>
void func(Matrix<double, _m, _n> A)
{
  Matrix<double, 2, 3> AA;

  AA << 1, 0, 5,
        2, 0, 7;

  MatrixXd KK = AA.triangularView<Lower>();

  // if I uncomment this, the code won't compile
  // MatrixXd K = A.triangularView<Lower>();

}

int main()
{
  Matrix<double, 2, 4> AA;

  AA << 1, 0, 5, 17,
        2, 0, 7, -2;

  func(AA);

  return 0;
} 
```

我用它编译`g++ $(pkg-config --cflags --libs eigen3) -o main main.cc`

如果指示的代码被注释掉，我会收到以下错误：

```
main.cc: In function ‘void func(Eigen::Matrix<double, _m, _n>)’:
main.cc:15:40: error: expected primary-expression before ‘)’ token
main.cc: In instantiation of ‘void func(Eigen::Matrix<double, _m, _n>) [with int _n = 4; int _m = 2]’:
main.cc:26:10:   required from here
main.cc:15:40: error: no match for ‘operator<’ in ‘A.Eigen::MatrixBase<Eigen::Matrix<double, 2, 4> >::triangularView < (Eigen::._79)1u’ 
```

r

我不明白这里的问题。似乎 g++ 认为我不想将矩阵与`Lower`枚举常量进行比较，即使我只想调用一个成员函数。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-15T15:51:01.363

你需要说`MatrixXd K = A.template triangularView<Lower>();`

见[http://womble.decadent.org.uk/c++/template-faq.html#disambiguation](http://womble.decadent.org.uk/c++/template-faq.html#disambiguation)

# git - 使用适用于 Windows 的 Git 推送到 GitHub 时出错

> ID：14898213
> 
> 赞同：0
> 
> 时间：2013-02-15T15:44:11.710
> 
> 标签：git, github

我在 GitHub 上创建了一个 Git 存储库，也创建了一个本地存储库。首先，我将远程存储库拉入本地存储库。然后我添加了一个文件，暂存文件，提交它，现在我尝试再次推送到远程存储库，但失败并显示以下消息：

```
推送到 https://github.com/jjenkov/java-utils
到 https://github.com/jjenkov/java-utils
 ！[拒绝] master -> master（非快进）
错误：未能将一些参考推送到“https://github.com/jjenkov/java-utils”
提示：更新被拒绝，因为您当前分支的尖端落后
提示：它的远程对应物。合并远程更改（例如“git pull”）
提示：在再次推动之前。
提示：有关详细信息，请参阅“git push --help”中的“关于快进的说明”。
```

我对 Git 和 Github 完全陌生，所以也许我做错了什么。我已经将远程存储库“提取”到本地存储库中，尽管远程存储库应该是空的（GitHub 生成的自述文件除外）。

有谁知道问题是什么，或者我可以在哪里阅读解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T15:49:46.307

远程仓库不为空；它包含`README`您可能通过 GitHub Web 界面创建的一个。您必须先拉动它，然后才能推向它：

```
git pull --rebase origin master
git push 
```

（这`--rebase`不是绝对必要的，但可以避免丑陋的合并提交。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T16:03:46.993

非快进推送意味着远程`master`不是您本地的祖先`master`。Git 拒绝将推送作为一种安全机制来防止破坏工作。

的输出`git log --graph --decorate --pretty=oneline --abbrev-commit --all`将为您提供存储库历史的图形描述。如果您确定不介意替换或销毁 GitHub 中的内容，请运行

```
$ git push --force origin master 
```

该`--force`选项被记录为（特别强调）

> **`-f`**, 通常，该命令拒绝更新不是用于覆盖它的本地 ref 的祖先的远程 ref。此标志禁用检查。**这可能会导致远程存储库丢失提交；****小心使用它。****`--force`**

 **要保留那里的内容，您需要在 GitHub 上的本地 master 基础上重新设置基础，然后推送结果。

```
$ git fetch
$ git rebase origin/master master
$ git push origin master 
```

要不就

```
$ git checkout master
$ git pull --rebase 
```

上面的序列是晴天的情况。您可能需要解决冲突，但鉴于您的描述，这似乎不太可能。**

# xml - 需要多次克隆 XML 文档并增加值

> ID：14898214
> 
> 赞同：0
> 
> 时间：2013-02-15T15:44:13.760
> 
> 标签：xml, rest, xslt, scripting

我有一个 XML 文档，它构成了自动化 REST 测试步骤的一部分。我需要克隆该步骤大约一千次，但是文档中有一个键值需要对每个克隆都是唯一的。最好的方法是什么 - 脚本、工具或其他任何东西，我可以用来一遍又一遍地复制它，但为每个实例更改一个值？我曾想过尝试编写一个 java 程序来做到这一点，但我没有在 java 中处理 XML 的经验，我的理解是解析很痛苦。

更新：目前正在研究 XSLT 以及它是否适合这种需要。如果您有任何意见或知识，请分享。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T18:05:01.750

XSLT 2.0 就可以了。（如果您需要 XSLT 2.0 处理器，我会推荐[Saxon](http://saxon.sourceforge.net/)。）

例如，这个简单的 XML 文档：

```
<doc>
    <foo/>
    <bar id="orig-id"/>
</doc> 
```

和这个 XSLT 2.0 样式表：

```
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output indent="yes"/>
    <xsl:strip-space elements="*"/>

    <xsl:param name="threshold" select="10"/>

    <xsl:template match="@*|node()" mode="clone">
        <xsl:copy>
            <xsl:apply-templates select="@*|node()" mode="clone"/>          
        </xsl:copy>
    </xsl:template>

    <xsl:template match="/*/bar/@id" mode="clone">
        <xsl:param name="doc-id" tunnel="yes"/>
        <xsl:attribute name="id" select="$doc-id"/> 
    </xsl:template>

    <xsl:template match="/" name="createDocs">
        <xsl:param name="dashNbr" select="1"/>
        <xsl:variable name="doc-id" select="concat(generate-id(),'-',$dashNbr)"/>
        <xsl:result-document href="{$doc-id}.xml">
            <xsl:apply-templates select="/*" mode="clone">
                <xsl:with-param name="doc-id" select="$doc-id" tunnel="yes"/>
            </xsl:apply-templates>          
        </xsl:result-document>
        <xsl:if test="$threshold > $dashNbr">
            <xsl:call-template name="createDocs">
                <xsl:with-param name="dashNbr" select="$dashNbr + 1"/>
            </xsl:call-template>
        </xsl:if>
    </xsl:template>

</xsl:stylesheet> 
```

生成 10 个具有独特`id`属性的文件。文件名基于 id。

例子：

d1-1.xml

```
<doc>
   <foo/>
   <bar id="d1-1"/>
</doc> 
```

d1-2.xml

```
<doc>
   <foo/>
   <bar id="d1-2"/>
</doc> 
```

d1-10.xml

```
<doc>
   <foo/>
   <bar id="d1-10"/>
</doc> 
```

您只需要将`threshold`参数的值更改为要创建的文件数，然后更改`match`要修改的属性。

# javascript - 防止在视频覆盖关闭后显示 youtube 视频伪影

> ID：14898223
> 
> 赞同：1
> 
> 时间：2013-02-15T15:44:31.850
> 
> 标签：javascript, youtube

我将视频放在用户单击视频缩略图时显示的叠加层中。我使用 iframe youtube api。当用户关闭覆盖时，我 stopVideo 视频并且覆盖关闭。但是，当您将鼠标悬停在视频所在的屏幕部分时，视频最后一帧的伪影开始随机出现（在 Chrome 中测试）。

我尝试过隐藏 iframe，将其移出屏幕等。似乎唯一可行的方法是将播放器 iframe 从叠加层中物理移除。这是一种前进的方式，但更好的方式是首先防止工件有任何想法？

# java - 获取文件路径的相对路径？

> ID：14898224
> 
> 赞同：2
> 
> 时间：2013-02-15T15:44:33.143
> 
> 标签：java, file, path, relative-path, java-7

我需要从`File`对象中获取相对文件路径（相对于程序可执行路径）。

最好的方法是什么？`File`仅提供绝对路径的方法。也许手动获取执行路径，然后从绝对路径中切断这条路径以获得相对路径？

我在 Java 7 上，以防万一 java.nio 有一些帮助方法。

Tahnks 任何提示！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T16:00:05.007

当您使用 Java 7 时，您可以使用新的 Path 类，它有许多非常酷的方法，包括[Path.relativize](http://docs.oracle.com/javase/7/docs/api/java/nio/file/Path.html#relativize%28java.nio.file.Path%29)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T15:48:20.580

你需要的方法：

```
Path relativize(Path other) 
```

的`java.nio.file.Path`。

要从文件中获取路径，您可以使用它的`Path toPath()`方法。

# maven - maven发布插件挂起

> ID：14898244
> 
> 赞同：2
> 
> 时间：2013-02-15T15:45:23.437
> 
> 标签：maven, cvs, maven-release-plugin, maven-scm-plugin

我正在尝试使用 mvn release 插件发布 CVS 项目。

我已经成功使用 mvn release:prepare 但是当我运行 release:perform 时它挂起，因为 CVS 模块上似乎是一个前导斜杠

/cust/shared_code

```
[INFO] [release:perform {execution: default-cli}]
[INFO] Checking out the project to perform the release ...
[INFO] Executing: /bin/sh -c cd /home/jmorgan/cvs_src/HEAD/cust-repo/cust/shared_code/target && cvs -z3 -f -d :pserver:jmorgan@pserver:/cvsroot-cust -q checkout -r cust-shared_code-8_0_4 -d checkout /cust/shared_code
[INFO] Working directory: /home/jmorgan/cvs_src/HEAD/cust-repo/cust/shared_code/target 
```

这挂...

删除斜线

```
/bin/sh -c cd /home/jmorgan/cvs_src/HEAD/cust-repo/cust/shared_code/target && cvs -z3 -f -d :pserver:jmorgan@pserver:/cvsroot-cust -q checkout -r cust-shared_code-8_0_4 -d checkout cust/shared_code
U checkout/acct-dcash-xml
U checkout/acct-dcash
U checkout/acct_qry
U checkout/acct_totals
... 
```

这开始检查，如我所料

我的 maven-scm-plugin v1.8.1 设置是

```
<scm>
<connection>scm:cvs:pserver:${env.USER}:${password}@pserver:/cvsroot-cust:cust/shared_code</connection>
<developerConnection>scm:cvs:pserver:${env.USER}:${password}@pserver:/cvsroot-cust:cust/shared_code</developerConnection>
</scm>

 <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-scm-plugin</artifactId>
            <configuration>
                <providerImplementations>
                    <cvs>cvs_native</cvs>
                </providerImplementations>
            </configuration>
        </plugin> 
```

看起来它与[http://jira.codehaus.org/browse/SCM-216](http://jira.codehaus.org/browse/SCM-216)有关，尽管这显然已在 1.0-beta-4 中修复

非常感激任何的帮助

詹姆士

- - 更新

看来我的 release.properties 不正确

```
#release configuration
#Fri Feb 15 14:58:18 GMT 2013
project.dev.com.cust.shared\:cust-shared_code=8.0.5-SNAPSHOT
scm.tag=cust-shared_code-8_0_4
scm.url=scm\:cvs\:pserver\:jmorgan\:${password}@pserver\:/cvsroot-cust\:/cust/shared_code
preparationGoals=clean verify
project.rel.com.cust.shared\:cust-shared_code=8.0.4
scm.commentPrefix=[maven-release-plugin]
project.scm.com.cust.shared\:cust-shared_code.tag=HEAD
project.scm.com.cust.shared\:cust-shared_code.developerConnection=scm\:cvs\:pserver\:builder\:${password}@pserver\:/cvsroot-cust\:/cust/shared_code
project.scm.com.cust.shared\:cust-shared_code.connection=scm\:cvs\:pserver\:builder\:${password}@pserver\:/cvsroot-cust\:cust/shared_code
exec.additionalArguments=-P artifactory
completedPhase=end-release 
```

虽然不确定如何纠正这个

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T14:19:47.123

正如我在上一条评论中提到的，我通过更新到所有插件的最新版本解决了这个问题。maven-release-plugin v2.4 和 maven-scm-provider-cvs v1.8

# java - Java 构造函数超参数

> ID：14898245
> 
> 赞同：4
> 
> 时间：2013-02-15T15:45:26.140
> 
> 标签：java, class, inheritance, constructor

查看抽象类的代码，[`ByteBuffer`](http://www.docjar.com/src/api/java/nio/ByteBuffer.java)很明显它继承自基类[`Buffer`](http://www.docjar.com/src/api/java/nio/Buffer.java)。

`ByteBuffer`有一个构造函数：

```
ByteBuffer(int capacity) {
    super(capacity);
} 
```

并且`Buffer`有一个构造函数：

```
Buffer(int mark, int pos, int lim, int cap) { 
    ...
} 
```

所以我的问题是 - 当`ByteBuffer`调用它的父构造函数时，这是如何工作的，因为参数不匹配？

****更新：这不是问题，但值得知道的是，一些在线 Java 源代码库（在本例中为 docjar）包含 Java 源代码的混搭。最好下载JDK ******

 *** * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T15:50:31.570

似乎是文档错误。

[**GrepCode**](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/nio/ByteBuffer.java)上的 ByteBuffer 源代码是正确的。

```
 ByteBuffer(int mark, int pos, int lim, int cap,   // package-private
274                  byte[] hb, int offset)
275     {
276         super(mark, pos, lim, cap);
277         this.hb = hb;
278         this.offset = offset;
279     }
280 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T15:54:55.187

恐怕您正在查看的 Buffer 类似乎已过时-当前的javadoc具有：

```
ByteBuffer(int mark, int pos, int lim, int cap) {   // package-private
ByteBuffer(int mark, int pos, int lim, int cap,          // package-private
  byte[] hb, int offset) 
```**

# concurrency - 并发 CUDA 内核执行的优先级

> ID：14898248
> 
> 赞同：4
> 
> 时间：2013-02-15T15:45:36.137
> 
> 标签：concurrency, cuda, gpu

我有两个可以同时执行的内核（A 和 B）。我需要内核 A 尽快完成（进行结果的 MPI 交换）。所以我可以在一个流中执行它们：A 然后 B。

但是，内核 A 的线程块很少，因此如果我按顺序运行 A 和 B，则在 A 运行时 GPU 没有得到充分利用。

是否可以同时执行 A 和 B 而 A 具有更高的优先级？

**即，我希望内核 B 的线程块仅在内核 A没有**未启动的块时才开始执行。

据我了解，如果我在一个流中启动内核 A，并且在主机代码的下一行，在另一个流中启动内核 B，我不能保证来自 B 的线程块实际上不会首先执行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-20T02:42:10.650

*NVIDIA 现在提供了一种优先处理 CUDA 内核的方法。*这是一个相当新的功能，因此您需要升级到 CUDA 5.5 才能使用。

对于您的情况，您将`kernel A`在高优先级 CUDA 流中启动，并`kernel B`在低优先级 CUDA 流中启动。您可能想要的功能是**`cudaStreamCreateWithPriority(..., priority)`**.

*   要使用此功能，您需要具有 Compute Capability 3.5 或更高版本的 GPU。要检查您的 GPU 是否支持优先级，请查看`cudaDeviceProp::streamPrioritiesSupported`.
*   `cudaDeviceGetStreamPriorityRange`应该告诉您 GPU 上有多少优先级可用。for 的语法`cudaDeviceGetStreamPriorityRange`有点奇怪。值得在 CUDA 手册中查看它是如何工作的。

* * *

[CUDA Runtime API 手册](http://docs.nvidia.com/cuda/pdf/CUDA_Runtime_API.pdf)中有关优先级设置的更详细文档：

```
cudaError_t cudaStreamCreateWithPriority(cudaStream_t *pStream, 
                                         unsigned int flags, int priority)
Create an asynchronous stream with the specified priority.

Parameters
pStream  = Pointer to new stream identifier 
flags    = Flags for stream creation. See cudaStreamCreateWithFlags for a list of 
           valid flags that can be passed 
priority = Priority of the stream. Lower numbers represent higher priorities. See  
           cudaDeviceGetStreamPriorityRange for more information about the 
           meaningful stream priorities that can be passed. 
```

# java - 在没有 maven 的 Eclipse 中启用注释处理工作区范围

> ID：14898250
> 
> 赞同：3
> 
> 时间：2013-02-15T15:45:47.397
> 
> 标签：java, eclipse, annotations, workspace, processor

我很难找到答案，但找不到任何答案，这是我目前的情况：（使用 JDK1.6.31 运行 Eclipse 3.5 Galileo）

我正在尝试在我的工作区中设置注释处理，目的是在工作区范围内激活注释处理，因为我们有 20 多个项目，并且每次创建新项目时都进行设置，这很烦人而且很危险，以防万一我们忘记这样做（并生成近 100 个新配置文件）。

根据 Java 6 API，将包含注释处理器的 Jar 添加到类路径应该会自动使它们在编译过程中可用。

所以我虽然将它添加到项目中并使其可用于导出会起作用，但它没有。

我知道 Eclipse 使用自己的编译器，但它的行为方式应该相同（或者不是）。

是否有可能将参数传递给 JDT 编译器？或者一些我在 Eclipse 中没有听说过的设置？

# android - 运行 android 应用程序的 Eclipse 因“安装错误：INSTALL_FAILED_MEDIA_UNAVAILABLE”而失败

> ID：14898251
> 
> 赞同：1
> 
> 时间：2013-02-15T15:45:52.567
> 
> 标签：android, eclipse

这不会一直发生。

我从 Eclipse 中运行我的应用程序，右键单击>运行方式>Android 应用程序

我将我的应用程序成功发送到手机可能 2 或 3 次，然后突然间它开始抛出此错误。看来唯一的解决办法是重启手机。它非常烦人，并且真的需要一些关于永久修复的帮助。

我正在使用 Windows 7 电脑、USB 电缆、三星 Galaxy SII。安卓版本：v21.1.0-569685

完整的控制台错误转储

```
Android Launch!
[2013-02-15 15:36:50 - myapp] adb is running normally.
[2013-02-15 15:36:50 - myapp] Performing com.myapp.myapp.myaptivity activity launch
[2013-02-15 15:36:54 - myapp] Uploading myapp.apk onto device '0019dxxxxxxxxx'
[2013-02-15 15:36:58 - myapp] Installing myapp.apk...
[2013-02-15 15:36:59 - myapp] Installation error: INSTALL_FAILED_MEDIA_UNAVAILABLE
[2013-02-15 15:36:59 - myapp] Please check logcat output for more details.
[2013-02-15 15:37:00 - myapp] Launch canceled! 
```

我已阅读[https://stackoverflow.com/a/9273766/828395](https://stackoverflow.com/a/9273766/828395)上的建议 我没有内部存储卡，我有 300mb 的可用空间。手机做了一件奇怪的事情，它的 USB 驱动器似乎总是在 Windows 中可用，但不完全是。因此，如果我从连接的驱动器中删除文件，手机屏幕会更改并进入 USB 模式，然后再次退出。刷新电话文件夹是我的另一个烦恼，因为它似乎并不明显。

很想把这个排序，因为它花费了我很多时间来重新启动。所以有什么想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T14:07:23.330

我认为这是由于 USB 电缆有故障。我有一根电缆的一端有一个裸露的护套，当我使用这根电缆时，我通过 Eclipse 得到了大约 2-4 次使用，然后它会吹出失败的媒体错误。其他电缆似乎一直没问题！

因此，如果您到达这里，请检查您的 USB 电缆和 USB 连接！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-21T13:19:16.303

如果您在运行之前卸载应用程序，它有时也可以解决问题。（我认为它以某种方式被锁定：/）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-13T13:51:14.383

就我而言，我用以下方法解决了它....

将以下行添加到您应用中的**AndroidManifest.xml文件中：**

```
android:installLocation="auto" 
```

...应该是这样的：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.MyTestApp"
android:installLocation="auto" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-11T20:59:54.407

当我使用时，我的工作：

android:installLocation="internalOnly"

在清单文件中

# asp.net - 如何根据内容将 NavigateUrl 分配给 HyperLinkField (GridView)

> ID：14898252
> 
> 赞同：0
> 
> 时间：2013-02-15T15:45:52.937
> 
> 标签：asp.net, vb.net, gridview

我有一个带有一些 BoundFields 和一些 HyperLinkFields 的 GridView。HyperLinkField，我想仅将 NavigateUrl 分配给其中包含文本“拒绝”的单元格。

这是我的标记：

```
<asp:GridView ID="gvS25ATransactions" CellSpacing="-1" GridLines="None" AutoGenerateColumns="false" OnPreRender="gvS25ATransactions_PreRender" AllowPaging="true" AllowSorting="true" PageSize="10"  runat="server">
<Columns>
    <asp:BoundField DataField="SIN" SortExpression="SIN" HeaderText="<%$ Resources:S25ATransactions, litSIN %>" />
    <asp:BoundField DataField="TRANSACTION_TYPE_DESC_EN" SortExpression="TRANSACTION_TYPE_DESC_EN" HeaderText="<%$ Resources:S25ATransactions, litType %>" />
    <asp:BoundField DataField="TRANSACTION_TYPE_DESC_FR" SortExpression="TRANSACTION_TYPE_DESC_FR" HeaderText="<%$ Resources:S25ATransactions, litType %>" />
    <asp:BoundField DataField="DATE_UPDATED" SortExpression="DATE_UPDATED" HeaderText="<%$ Resources:S25ATransactions, litDate %>" />
    <asp:BoundField DataField="USER_CODE" SortExpression="USER_CODE" HeaderText="<%$ Resources:S25ATransactions, litUser %>" />
    <asp:HyperLinkField DataTextField="STATUS_DESC_EN" SortExpression="STATUS_DESC_EN" HeaderText="<%$ Resources:S25ATransactions, litStatus %>" />
    <asp:HyperLinkField DataTextField="STATUS_DESC_FR" SortExpression="STATUS_DESC_FR" HeaderText="<%$ Resources:S25ATransactions, litStatus %>" />
</Columns>
<PagerStyle CssClass="pagination" /> 
```

这就是我迄今为止尝试做的事情：

```
Protected Sub gvS25ATransactions_RowDataBound(sender As Object, e As System.Web.UI.WebControls.GridViewRowEventArgs) Handles gvS25ATransactions.RowDataBound

    If e.Row.RowType = DataControlRowType.DataRow Then

        For Each column As DataControlField In gvS25ATransactions.Columns

            If column.HeaderText = "Status" Or column.HeaderText = "Statut" Then

                For i As Integer = 0 To gvS25ATransactions.Rows.Count - 1

                    If gvS25ATransactions.Rows(i).Cells(5).Text = "Rejected by SD110" Then
                        Dim hl As HyperLink = TryCast(e.Row.FindControl("HyperLink1"), HyperLink)
                        hl.NavigateUrl = "#coucou"
                    End If

                Next

            End If

        Next

    End If

End Sub 
```

带有“拒绝”文本的单元格将位于第 5 列或第 6 列（一个是英语，另一个是法语）。

当我执行上面的代码时，它永远不会进入这个 for 循环。

```
For i As Integer = 0 To gvS25ATransactions.Rows.Count - 1 
```

它说“i”没有被声明。由于它的保护级别，它可能无法访问

帮助？

**更新**

这是我为 RedDevil79 的建议添加的新标记

```
<asp:GridView ID="gvS25ATransactions" CellSpacing="-1" GridLines="None" AutoGenerateColumns="false" OnPreRender="gvS25ATransactions_PreRender" AllowPaging="true" AllowSorting="true" PageSize="10"  runat="server">
<Columns>
    <asp:BoundField DataField="SIN" SortExpression="SIN" HeaderText="<%$ Resources:S25ATransactions, litSIN %>" />
    <asp:BoundField DataField="TRANSACTION_TYPE_DESC_EN" SortExpression="TRANSACTION_TYPE_DESC_EN" HeaderText="<%$ Resources:S25ATransactions, litType %>" />
    <asp:BoundField DataField="TRANSACTION_TYPE_DESC_FR" SortExpression="TRANSACTION_TYPE_DESC_FR" HeaderText="<%$ Resources:S25ATransactions, litType %>" />
    <asp:BoundField DataField="DATE_UPDATED" SortExpression="DATE_UPDATED" HeaderText="<%$ Resources:S25ATransactions, litDate %>" />
    <asp:BoundField DataField="USER_CODE" SortExpression="USER_CODE" HeaderText="<%$ Resources:S25ATransactions, litUser %>" />
    <asp:TemplateField  SortExpression="STATUS_DESC_EN" HeaderText="<%$ Resources:S25ATransactions, litStatus %>">
        <ItemTemplate>
            <asp:HyperLink ID="STATUS_DESC_EN" runat="server"><%# Eval("STATUS_DESC_EN")%></asp:HyperLink>
        </ItemTemplate>
    </asp:TemplateField>
    <asp:TemplateField  SortExpression="STATUS_DESC_FR" HeaderText="<%$ Resources:S25ATransactions, litStatus %>">
        <ItemTemplate>
            <asp:HyperLink ID="STATUS_DESC_FR" runat="server"><%# Eval("STATUS_DESC_FR")%></asp:HyperLink>
        </ItemTemplate>
    </asp:TemplateField>       
</Columns>
<PagerStyle CssClass="pagination" /> 
```

这是VB代码

```
Protected Sub gvS25ATransactions_RowDataBound(sender As Object, e As System.Web.UI.WebControls.GridViewRowEventArgs) Handles gvS25ATransactions.RowDataBound

    If e.Row.RowType = DataControlRowType.DataRow Then
        Dim hl As HyperLink = TryCast(e.Row.FindControl("STATUS_DESC_EN"), HyperLink)
        Dim hl2 As HyperLink = TryCast(e.Row.FindControl("STATUS_DESC_FR"), HyperLink)
        If hl.Text = "Rejected by SD110" Or hl2.Text = "Rejeté par SD110" Then
            hl.NavigateUrl = "#coucou"
            hl2.NavigateUrl = "#coucoufr"
        End If
    End If

End Sub 
```

The problem I am facing now is that hl.Text and hl2.Text are always ="" so it never goes in the if statement

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T12:37:38.980

Try this:

Convert the 2 hyperlink fields in GridView to template and change the RowDataBound to:

```
If e.Row.RowType = DataControlRowType.DataRow Then

    For Each column As DataControlField In gvS25ATransactions.Columns

        If column.HeaderText = "Status" Or column.HeaderText = "Statut" Then               

                If e.Row.Cells(5).Text = "Rejected by SD110" Then
                    Dim hl As HyperLink = TryCast(e.Row.FindControl("HyperLink1"), HyperLink)
                    hl.NavigateUrl = "#coucou"
                End If

        End If

    Next

End If 
```

Explanation:

You have to convert the hyperlink fields to template because you need the name of the control in FindControl function.

In RowDataBound you don't need to iterate through all the rows of gridview. The RowDataBound is executed for every row in gridview when data is added to it. That's why you don't need the for loop.

**Update:**

```
If e.Row.RowType = DataControlRowType.DataRow Then
     Dim hl As HyperLink = TryCast(e.Row.FindControl("STATUS_DESC_EN"), HyperLink)
     Dim hl2 As HyperLink = TryCast(e.Row.FindControl("STATUS_DESC_FR"), HyperLink)
     If hl.Text = "Rejected by SD110" Or hl2.Text = "Rejected by SD110" Then
         hl.NavigateUrl = "#coucou"
     End If
End If 
```

Your Hyperlink tags are not well formed:

```
<asp:GridView ID="gvS25ATransactions" CellSpacing="-1" GridLines="None" AutoGenerateColumns="false" OnPreRender="gvS25ATransactions_PreRender" AllowPaging="true" AllowSorting="true" PageSize="10"  runat="server">
    <Columns>
        <asp:BoundField DataField="SIN" SortExpression="SIN" HeaderText="<%$ Resources:S25ATransactions, litSIN %>" />
        <asp:BoundField DataField="TRANSACTION_TYPE_DESC_EN" SortExpression="TRANSACTION_TYPE_DESC_EN" HeaderText="<%$ Resources:S25ATransactions, litType %>" />
        <asp:BoundField DataField="TRANSACTION_TYPE_DESC_FR" SortExpression="TRANSACTION_TYPE_DESC_FR" HeaderText="<%$ Resources:S25ATransactions, litType %>" />
        <asp:BoundField DataField="DATE_UPDATED" SortExpression="DATE_UPDATED" HeaderText="<%$ Resources:S25ATransactions, litDate %>" />
        <asp:BoundField DataField="USER_CODE" SortExpression="USER_CODE" HeaderText="<%$ Resources:S25ATransactions, litUser %>" />
        <asp:TemplateField  SortExpression="STATUS_DESC_EN" HeaderText="<%$ Resources:S25ATransactions, litStatus %>">
            <ItemTemplate>
                <asp:HyperLink ID="STATUS_DESC_EN" runat="server" Text='<%# Eval("STATUS_DESC_EN")%>'></asp:HyperLink>
            </ItemTemplate>
        </asp:TemplateField>
        <asp:TemplateField  SortExpression="STATUS_DESC_FR" HeaderText="<%$ Resources:S25ATransactions, litStatus %>">
            <ItemTemplate>
                <asp:HyperLink ID="STATUS_DESC_FR" runat="server" Text='<%# Eval("STATUS_DESC_FR")%>'></asp:HyperLink>
            </ItemTemplate>
        </asp:TemplateField>       
    </Columns>
    <PagerStyle CssClass="pagination" />
</asp:GridView> 
```

You have to Bind the field to the text property of Hyperlink.

**Important:** the Text property only works with ' not "

# java - 如何从 Java 代码创建数据库 ID？

> ID：14898254
> 
> 赞同：0
> 
> 时间：2013-02-15T15:46:03.730
> 
> 标签：java, oracle, resultset, javadb

我在我的数据库中手动增加我的 ID 号，因为我无法让它自动工作。这是一个项目，如果它不能自动工作也没关系 - 我可以稍后尝试解决。

我正在创建一个方法来检查结果集中的最低空闲 ID 号。最低的将被设置为一个名为 availableId 的整数，用户将在注册时获得该整数。

这是我到目前为止阅读的内容：

[http://docs.oracle.com/javase/6/docs/api/java/sql/ResultSet.html](http://docs.oracle.com/javase/6/docs/api/java/sql/ResultSet.html) [http://wiki.netbeans.org/GetStartedwithJavaDB](http://wiki.netbeans.org/GetStartedwithJavaDB)

例如，这些是我在数据库中的 ID：

```
/,2,/,4,5,6,/,8,9 
```

由于这些用户删除了他们的帐户，因此缺少 1、3 和 7。我想在填写任何其他人之前填写数字 1，然后下一个用户将注册为例如数字 3。

```
public int getAvailableId() {
    int availableId = 1;
    try {
        String stmt = "select PID from APP.PERSON";
        PreparedStatement ps = Main.getPreparedStatement(stmt);
        ResultSet rs = ps.executeQuery();
        while (rs.next()) {
            int n = rs.getInt(1);
            int n2 = rs.next().getInt(1);

            if (!(n == 1)) {
                return availableId;
            } else if (!(n2-- == n)) {
                availableId = n++;
            }
        }
        rs.close();
        ps.close();
    } catch (Exception e) {
        System.out.println(e);
    }
    return availableId;
} 
```

这里有两个问题：

1.  `rs.next()`返回一个布尔值，但我希望 n2 在下一行中保存整数的值 - 我找不到从这里执行此操作的方法 - [http://docs.oracle.com/javase/6/docs/api /java/sql/ResultSet.html](http://docs.oracle.com/javase/6/docs/api/java/sql/ResultSet.html)
2.  我不知道如何遍历所有内容以找到可能的最低免费 ID 号。

请原谅垃圾代码！随着我的发展，我学到了很多东西，我知道这对一和二来说是不好的做法，代码不是很好。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T15:48:13.283

您的代码略有错误。这需要改变：

```
rs.next().getInt(1); 
```

只是：

```
rs.getInt("PID"); 
```

`rs.next()`做两件事。如果有下一行，则返回 true，然后将结果集游标移动到下一行。

当没有下一行时，它将返回 false 并因此中断循环。

当您调用`getInt`它时，它将尝试从当前行中检索 int。如您所见`rs.next()`，循环中的条件每次都会将其移动到下一行。

* * *

同样在这种情况下，您需要声明

`int n`在循环之外。

然后`n = n2`在每次循环迭代结束时分配。

像这样的东西：

```
 int n = 0;
    while (rs.next()) {

        int n2 = rs.getInt(1);

        if (!(n == 1)) {
            return availableId;
        } else if (!(n2-- == n)) {
            availableId = n++;
        }

        n = n2;
    } 
```

您可能需要玩弄它才能让它完全按照您的意愿行事。

* * *

我的最后评论，不要费心试图获得尽可能低的免费 ID 号码，只需使用 SQL MAX() 或其他东西从数据库中获取最高号码，然后加 1。

# javascript - 在我的网站上禁用浏览器插件，例如 Firebug、Web Developer Tools

> ID：14898257
> 
> 赞同：-1
> 
> 时间：2013-02-15T15:46:07.200
> 
> 标签：javascript

我只是想知道有什么方法可以在我的网站上禁用浏览器插件，如 Web Developer Tools、Firebug 等？我想出于安全目的禁用此类插件，因为我意识到通过使用这些工具，可以在将表单数据传递到服务器之前对其进行操作。我已经在进行服务器端验证，但如果我可以禁用可能更改我网站代码的此类脚本，我仍然会很高兴

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-15T15:46:52.250

不，你不能。

而且您必须考虑到客户端发生的任何事情都无法控制：您**必须**在服务器端进行所有验证。客户端验证对用户的舒适度有用，而不是对安全性有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T15:48:02.287

任何人可以使用这些工具对您网站上的客户端代码进行的任何更改只会影响他们自己。您不必担心他们会让体验对自己不利。

只要您有足够的服务器端验证来保护**您**在服务器上的文件，一切都会安全。在您的服务器上运行代码时，用户发送的任何输入或数据都应被视为可疑。验证所有数据，不要假设你会得到你所期望的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-15T15:54:57.447

客户端验证是专门为用户的利益和使事情看起来不错的。服务器端验证是必须的，因为它是唯一重要的验证。

# cocoa - Cocoa NSTextView 改变字大小

> ID：14898263
> 
> 赞同：1
> 
> 时间：2013-02-15T15:46:27.823
> 
> 标签：cocoa

我的窗口上有一个 NSTextView 对象。我将 NSStrings 传递给它并显示。我想更改显示的单词的大小。我怎么做？我是在检查器中执行此操作还是有办法在代码中执行此操作？请举个例子。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T15:49:29.243

`NSTextField`派生自`NSControl`它公开一个`font`属性（[参考](http://developer.apple.com/library/mac/documentation/Cocoa/Reference/ApplicationKit/Classes/NSControl_Class/Reference/Reference.html#//apple_ref/occ/instm/NSControl/setFont%3a)）：

```
textField.font = [NSFont fontWithName:@"Something" size:12.0]; 
```

# xamarin.android - 在 Mono for Android 中在模拟器和设备之间切换

> ID：14898264
> 
> 赞同：1
> 
> 时间：2013-02-15T15:46:37.997
> 
> 标签：xamarin.android, monodevelop

我在 Mac 上使用 Mono for Android 和 MonoDevelop。我有兴趣能够在仿真器上进行调试，然后切换到设备。我发现第一次尝试调试时，系统会提示我选择模拟器或设备。一旦我选择了一个 MD 就会记住它，我不能切换。

如何选择部署位置以进行调试？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T21:28:12.633

单击`Project`（在顶部菜单上），然后`Android Device Target`设置调试设备。

# html - 如何防止移动浏览器微缩 HTML 块级元素？

> ID：14898267
> 
> 赞同：1
> 
> 时间：2013-02-15T15:46:42.707
> 
> 标签：html, css, mobile

我正在尝试使用 CSS @media 标签为移动设备设置相应的 Web 应用程序样式。

我可以访问两个可以测试开发的移动设备：Nexus S 和旧的 iPod Touch，它们都有低分辨率屏幕。

声明我的元标题时，我选择了**target-densitydpi=device-dpi**以使事物看起来清晰而不会受到太多骚扰，否则屏幕上会出现奇怪的线条和事物（使用 android chrome 浏览器）。

现在，我担心在具有超高 DPI 的新设备高分辨率设备上，事情会显得非常微小。

我在这里搜索并阅读了各种查询，但我真的不明白我需要在这里做什么。

我可以将图像缩放 2 倍、3 倍、4 倍等，这没问题，但是我的一些块级元素（例如标题块）具有以像素为单位的确定高度，如果 Nexus S 的 800 到 480 像素屏幕显示在一种方式，我想知道例如具有 1280-720 显示屏的 Galaxy S 或 iPhone 4 和 5 会如何显示它们？

我需要如何声明我的标签以及如何解决这个可能的问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T15:51:57.683

移动浏览器没有设备的分辨率。有两种标准的移动宽度：320px 和 360px。

Google Nexus 和三星 Galaxy Note（和 Note 2）的宽度为 360 像素，而几乎所有其他设备的宽度均为 320 像素。

这意味着无论手机的屏幕分辨率是多少，浏览器的宽度都是 320 或 360 像素。

所以你应该专注于此。

[你可以在这里](http://www.quirksmode.org/blog/archives/2010/04/a_pixel_is_not.html)阅读更多关于它的信息。

# api - 鲁棒性原理和 API

> ID：14898271
> 
> 赞同：2
> 
> 时间：2013-02-15T15:46:51.747
> 
> 标签：api, rest

是否应该将[稳健性原则](http://en.wikipedia.org/wiki/Robustness_principle "稳健性原则")（*在你所做的事情上保持保守，在你从他人那里接受的事情上保持自由*）应用于 API？

举个例子，我见过以两种方式之一处理用户参数的 API，例如*limit ：*

其中*limit是要返回的最大结果数，如果用户在**limit*中输入字母“x” ，一些 API 会抛出验证错误，因为输入不是数字，其他 API 只是回退到默认限制（例如： 1000)。

在如何处理此类用户输入方面，您有什么建议？抛出一个有用的描述性验证错误，或者优雅地清理输入并继续请求？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T20:05:36.443

只要您清楚地记录您将要做什么，这两种方式都不会产生太大的影响。您在这种情况下的行为在很大程度上取决于特定的字段和数据类型。例如，您可以将数值默认为 1000 之类的数字，但是您将如何处理无效的时间戳？

对于一个限制值，我会降级为默认值（如果根本不包含它，你会使用什么值），但是你应该清楚地记录你的 API 对每个字段的行为方式（是否需要，它的默认值等） . 如果它被清楚地记录在案，您的用户将（应该）能够以任何一种方式正确使用它。

# jquery - 识别 jquery 中的标签，同时遍历每个节点 -

> ID：14898276
> 
> 赞同：0
> 
> 时间：2013-02-15T15:46:56.513
> 
> 标签：jquery, html, prepend

这就是问题所在，它真的让我很生气，因为它可能有一个非常简单的解决方案。看看这个[jsfiddle](http://jsfiddle.net/FL2Ut/3/)

```
<body>
<p>
    this is the first paragraph and it will get the prepend without any problems at all
</p>
<span>
    this is a simple span element, and it will also get the prepend without any problems at all
</span>
<em>
    heres a em and this works as well

</em>
<p>
   here is another para and it works , BUT NOW LOOK AT THE NEXT LINE
    <br>BR STARTS HERE
        where is this prepend, ladies and gentlement,,NADA.
    </br>
</p> 
```

```
$("*", document.body).each(function () {
$(this).prepend('<b><font color="red">  soccer  </font></b>');
}); 
```

您会发现一组简单的 HTML 标签，只是一些随机放置的`<p>`标签`<span>`。我编写了一个小 jquery（2 行函数），它遍历页面正文中的所有标签，并在每个标签前添加一段 html。

不幸的是，这些`<br>`标签似乎并不遵循所有其他标签的做法。它没有得到前置的 HTML，我只是想不通。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T15:49:36.727

这是因为`<br/>`标签不能有任何子元素或内容[https://developer.mozilla.org/en-US/docs/HTML/Element/br](https://developer.mozilla.org/en-US/docs/HTML/Element/br) .. 如果你使用 .before()/.after() 它会显示为您想要的兄弟姐妹。

[http://jsfiddle.net/Gmbpt/](http://jsfiddle.net/Gmbpt/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T15:50:28.710

如果您阅读规范（[http://www.w3.org/TR/html5/text-level-semantics.html#the-br-element](http://www.w3.org/TR/html5/text-level-semantics.html#the-br-element)），您会看到内容模型`br`为***空***。

这意味着它不能有内容..

# php - symfony2 包含类漂亮的 sql 格式化程序并将 sql 输出到模板

> ID：14898277
> 
> 赞同：0
> 
> 时间：2013-02-15T15:46:58.557
> 
> 标签：php, symfony, twig

我正在寻找使用包含在 symfony2 库中的漂亮 sql 格式化程序。在模板页面上输出一些sql。

格式化程序包含在这里 /vendor/jdorn/sql-formatter/lib/SqlFormatter。

我会将它传递给树枝模板

**页面控制器.php**

```
$queryBaseSQL = "SELECT * FROM exampleTable WHERE 'this' = 1 ";

return $this->render('sjQueryBundle:Page:index.html.twig', array(
  'queryBaseSQL' => $queryBaseSQL
)); 
```

我希望能够在树枝里面把它叫做 where

**(index.html.twig)**

```
{{ sqlFormatter::format(queryBaseSQL) }} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T15:53:10.303

```
$queryBaseSQL = "SELECT * FROM exampleTable WHERE 'this' = 1 ";

return $this->render('sjQueryBundle:Page:index.html.twig', array(
  'queryBaseSQL' => \SqlFormatter::format($queryBaseSQL);
)); 
```

枝条：

```
{{ queryBaseSQL|raw }} 
```

# ember.js - TypeError: router.get(...).loadMoreDetails 不是函数

> ID：14898281
> 
> 赞同：0
> 
> 时间：2013-02-15T15:47:23.107
> 
> 标签：ember.js

我正在关注来自 trek.github.com 的介绍教程，但在运行它时遇到了标题中的错误。[粘贴可用](http://paste.ubuntu.com/1658277/)，第 119 行发生错误。同时，我想用这个线程来解决一些 EmberJS 新手问题：

1.  Ember.ObjectController 和 Ember.Object 有什么区别？
2.  在第 70 行，在 URL 之后出现了 .fmt(this.get('login'))。这是做什么的？
3.  我注意到 Ember 可以使用 '/:VAR' 符号处理变量 URL 名称。只是想知道，如果出现多个变量 URL 名称，如果有重复，EmberJS 如何管理它们？使用可变 URL 名称是一种好习惯吗？
4.  该示例带有序列化和反序列化函数（从第 107 行开始）来获取登录名。但我没有看到他们在任何地方被调用。

谢谢你的耐心，安吉拉

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T16:39:30.397

恐怕你在这里使用的是旧版本的 Ember，安吉拉。您使用的是 pre 2，而最新版本是 pre 4。我建议您使用 pre 4，因为发生了很多变化。例如，看看你的第 119 行，我可以直接告诉你`connectOutlets`pre 4 中没有任何方法了。

综上所述，我认为您的问题是，粗略地看一下，您正试图调用`loadMoreDetails`控制器的内容，而不是控制器本身。尝试：`router.get('oneContributorController').loadMoreDetails();`

此外，在pre 4中不再可以访问路由器。我认为更新至关重要。

**问题**

1.  `Ember.Object`表示单个对象，而`Ember.ObjectController`更多的是关于存储许多`Ember.Object`s 的集合。您应该使用`Ember.ArrayController`（类似对象的数组）、`Ember.ObjectController`（许多不同*相关*对象的容器）或`Ember.Controller`（通用用法），具体取决于您的用例。

2.  你的背景是什么？红宝石还是 PHP？无论哪种方式，该`fmt`方法都类似于 PHP`sprintf`和 Rails 的`%`运算符 ( `"Tasks: %d" % @tasksCount`)。是指定的`%@`值`get('login);`将出现在字符串中的什么位置。

3.  Ember 没有在 URL 本身中指定变量的名称。无论如何，不​​是默认情况下。是您的路由器（您使用的是路由器 v1，而它是 pre 4 中的路由器 v2）告诉 Ember URL 的哪个部分映射到哪个属性。这样就没有重复项，因为每个变量在 URL 中都有自己独特的空间。

4.  这些来自您正在使用的旧 Ember。在新版本中，它们更加直观。为了告诉控制器它应该代表哪个模型，您`model`在路由器中有一个方法可以返回正确的模型。在您使用的版本中，它们告诉 Ember 如何从 URL 参数创建对象（`deserialize`- 为什么有`deserialized`？），反之亦然，从您传入的对象中获取 URL 的属性（`serialize`）。

**PS：**我想你会发现[我昨天](https://stackoverflow.com/questions/14862973/how-to-communicate-between-controllers-in-ember-js/14866210#14866210)的帖子内容丰富。

# mysql - 在mysql中获取多对多关系

> ID：14898287
> 
> 赞同：0
> 
> 时间：2013-02-15T15:47:36.947
> 
> 标签：mysql, sql

我有如下表格：

```
users         roles        users_roles
-id (pk)      -id (pk)     -user_id (fk) references users
-username     -name        -role_id (fk) references roles
-password 
```

我在角色列中有三条记录（ROLE_USER、ROLE_MODERATOR、ROLE_TESTER）

多对多关系中的用户和角色之间的关系。我有一个表单字段（包含具有多个选择选项的角色的选择框），它允许管理员根据选择框中的选择来搜索用户。

假设管理员同时选择 ROLE_USER 和 ROLE_MODERATOR。如何编写单个查询来查找同时具有此角色的用户（排除仅具有其中一个角色的用户）

这是 sqlfiddle 链接[http://sqlfiddle.com/#!2/214b8/3](http://sqlfiddle.com/#!2/214b8/3)

我想让用户同时拥有两个角色（ROLES_USER 和 ROLES_MODERATOR）。用户必须同时具有这两个角色

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T15:53:47.353

尝试这个。

```
SELECT DISTINCT users.id, users.username,group_concat(distinct roles.name) as role_names
FROM users
INNER JOIN users_roles ON users.id = users_roles.user_id
INNER JOIN roles ON roles.id = users_roles.role_id
WHERE roles.name = 'ROLE_USER' OR roles.name = 'ROLE_MODERATOR'
GROUP by users.id HAVING (role_names = 'ROLE_USER,ROLE_MODERATOR' OR role_names = 'ROLE_MODERATOR,ROLE_USER'); 
```

您可以自定义此查询以获取所需的列并根据需要添加分组。

尽管我对这种查询结构并不完全满意，但我还是将其作为临时解决方案。如果我们从 MySQL 专家那里得到任何评论，我会很棒。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T16:03:27.493

您需要使用`GROUP BY`和`HAVING`：

```
SELECT user_id 
FROM users_roles 
WHERE role_id iN (1,2)
GROUP BY user_id 
HAVING COUNT(DISTINCT role_id) = 2 
```

这是一些示例[小提琴](http://sqlfiddle.com/#!2/7a3a4/1)。

如果你需要到`JOIN`你的其他表：

```
SELECT u.id, u.username
FROM users u 
    JOIN users_roles ur on u.id = ur.user_id
    JOIN roles r on ur.role_id = r.id
WHERE r.id iN (1,2)
GROUP BY u.id, u.username
HAVING COUNT(DISTINCT r.id) = 2 
```

# php - 如何让 WAMP 立即登录到 error_log？

> ID：14898289
> 
> 赞同：1
> 
> 时间：2013-02-15T15:47:43.673
> 
> 标签：php, windows, apache, wamp, error-log

wamp 中的错误日志已打开，正在运行，但 1-30 分钟后可以看到更改。这不是问题，比如[为什么 WAMP 中的 Apache 2.1.7 不会将 PHP 错误记录到 PHP 错误日志中？](https://stackoverflow.com/questions/5095784/apache-2-1-7-in-wamp-wont-log-php-errors-to-php-error-log)- 具有一般日志记录，但具有从 apache/php 记录的刷新信息。我使用的是 Windows 7，我不记得 XP 上的这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T15:52:20.957

线; log_errors 被评论

```
log_errors = Off 
```

并将值更改为 On。你记事本打开错误日志文件。[阅读更多](https://stackoverflow.com/questions/5095784/apache-2-1-7-in-wamp-wont-log-php-errors-to-php-error-log)

# c++ - 比较两个字符串（类似于 GNU diff 的做法）

> ID：14898290
> 
> 赞同：-1
> 
> 时间：2013-02-15T15:47:45.580
> 
> 标签：c++, diff

是否有任何开源项目或库能够以[GNU diff](http://en.wikipedia.org/wiki/Diff)的方式比较两个字符串，但无需启动外部进程，并且使用**内存缓冲区**而不是文件？

也就是说，看起来像这个假设函数：

```
comparison_result* diff(wchar_t *text1, wchar_t *text2); 
```

我查看了[GNU diffutils 的源代码](http://ftp.gnu.org/gnu/diffutils/)，希望它会在内部使用这样的函数，但不幸的是，它正在**逐块**读取文件，而不是将它们读入内存缓冲区并进行比较。代码本身比较复杂，我也不是很懂，更别说重写了。

开源项目中有这样的功能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T16:29:22.507

diffutils 程序/函数的源代码确实有点难以适应此目的，因为它在比较算法期间使用了许多文件的部分缓冲。

但是，diff 实现的功能并不是真正具有革命性或难以重现。它已在其他图书馆中复制。例如，来自 google-code 的[google-diff-match-patch](http://code.google.com/p/google-diff-match-patch/)库，它的 API 有点粗糙，但似乎可以胜任。

另一种可能性是将数据写入内存`FILE*`缓冲区，然后使用 diffutils 函数读取和写入这些内存缓冲区。[您可以使用fmemopen](http://pubs.opengroup.org/onlinepubs/9699919799/functions/fmemopen.html)创建此类缓冲区。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T16:44:43.263

您可以参考[libmba](http://www.ioplex.com/~miallen/libmba/)，其 diff 源代码位于[http://www.ioplex.com/~miallen/libmba/dl/src/diff.c](http://www.ioplex.com/~miallen/libmba/dl/src/diff.c)

# javascript - D3.js 在条形图上分组条形图文本

> ID：14898291
> 
> 赞同：1
> 
> 时间：2013-02-15T15:47:46.023
> 
> 标签：javascript, d3.js, label, bar-chart

我[将此示例](http://bl.ocks.org/3887051)用作基础，并且需要将列（65 岁及以上，45 至 64 岁，......）作为条形本身的文本或在 x 轴上的状态下方具有第二束标签。

我想这应该相对容易，但我无法弄清楚。如果它更容易，我不需要不同颜色的条，我为一组中的每个条添加填充，并根据是否超过某个阈值的值对它们进行着色。

[所以它应该看起来像图像](https://imgur.com/cvO86VU)中这两个分组的条之一

![在此处输入图像描述](../Images/497f825c9660a6e7e02ccc7d192c154d.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T18:25:16.183

您可以通过添加`text`元素以与添加条本身相同的方式来实现此目的。代码看起来像这样。

```
state.selectAll("text")
  .data(function(d) { return d.ages; })
.enter().append("text")
  .attr("x", function(d) { return x1(d.name); })
  .attr("y", function(d) { return y(d.value); })
  .attr("transform", "rotate(90)")
  .text(function(d, i) { return ageNames.slice()[i]; }); 
```

您可能需要调整`x`/`y`位置和旋转以正确对齐标签。

# wicket - 记住先前状态的 Wicket 表单组件

> ID：14898292
> 
> 赞同：0
> 
> 时间：2013-02-15T15:47:48.103
> 
> 标签：wicket

我有一个带有 OnChangeAjaxBehavior 的 DropDownChoice。在 OnChangeAjaxBehavior 中，我有一个条件行为——如果用户选择了与上次相同的值，则该行为不应该做任何事情。如何优雅地保存以前的值？我试过了

```
@Override
protected void onModelChanging() {
    this.previousValue = carDataModel.getObject().getModel();
    log.debug("Saving previous value from model: {}", previousValue);
} 
```

但是**如果选择的值与前一个值相同，**`onModelChanging()`则不会调用方法方法，因此前一个值并不总是正确更新。

 **在模型更新之前我可以使用在 Wicket 组件生命周期中调用的另一种方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T22:22:31.297

您可以覆盖 #getUpdateModel() 以返回 false，因此在您的 #onUpdate() 中，组件仍然具有其原始模型对象，您可以在自己调用 component#updateModel() 之前访问 FormComponent#getConvertedInput()。**

# django - groups__name 记录在哪里？

> ID：14898295
> 
> 赞同：0
> 
> 时间：2013-02-15T15:47:54.540
> 
> 标签：django, django-models, django-testing

我的 Django 应用程序有几种不同类型的用户。对于我的项目模型，我想将 pm 列限制为仅属于“项目经理”组的用户对象。在浏览 SE 并搜索了一下之后，我添加了“limit_choices_to”并分配了一个 Q 对象。

但是，当我设置一个我确信会失败的 TestCase 时，似乎任何用户都可以添加为 pm。模型和测试用例如下：

```
class Project(models.Model):
    name = models.CharField(max_length=50, unique=True)
    tracker = models.IntegerField(max_length=5)
    pm = models.ForeignKey('auth.User', limit_choices_to=Q(groups__name = 'Project Manager'))

class ProjectTestCase(TestCase):
    def setUp(self):
        self.name = 'Crappy Project'
        self.tracker = 38493
        self.pm = User.objects.create_user('username', 'user@example.com', 'password')
        proj = Project.objects.create(name=self.name, tracker=self.tracker, pm=self.pm)
        proj.save()

    def test_proj_creation(self):       
        # Check stored values
        proj_zero = proj_in_db[0]
        self.assertEquals(proj_zero.name, self.name)
        self.assertEquals(proj_zero.pm, self.pm) 
```

如果我没有将用户分配到任何组，我试图理解为什么我的测试会继续通过。另外，“groups__name”记录在哪里？我无法在 Django 文档中引用它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T15:58:59.907

该`groups__name`文档基本上是[auth.User 文档](https://docs.djangoproject.com/en/1.4/topics/auth/#methods)和[字段查找文档](https://docs.djangoproject.com/en/1.4/topics/db/queries/#field-lookups)的组合，假设您知道`auth.models.User`有一个`groups`与`auth.models.Group`.

`limit_choices`仅限制管理员和（模型）表单中可用的选项；它不限制数据库中的选择，因此仍然可以通过编程方式设置任何可用的选择；在您的情况下，根本没有（默认）。您可以在数据库中戳一下，看看它实际上为您提供了哪些`pm`领域。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T15:59:28.503

`limit_choices_to`仅限制`select`表单中 s 中的选择（在 admin 和您自己`ModelForm`的 s 中）。在您的代码中，您仍然可以分配您喜欢的任何人。

该[`django.contrib.auth`文档](https://docs.djangoproject.com/en/dev/ref/contrib/auth/#django-contrib-auth)涵盖了`User`和`Group`模型及其领域。

# angularjs - 如何取消订阅 angularJS 中的广播事件。如何删除通过 $on 注册的函数

> ID：14898296
> 
> 赞同：285
> 
> 时间：2013-02-15T15:47:54.927
> 
> 标签：angularjs

我已经使用 $on 函数将我的侦听器注册到 $broadcast 事件

```
$scope.$on("onViewUpdated", this.callMe); 
```

我想根据特定的业务规则取消注册这个监听器。但我的问题是，一旦注册，我就无法取消注册。

AngularJS 中是否有任何方法可以取消注册特定的侦听器？像 $on 这样取消注册此事件的方法可能是 $off。所以基于业务逻辑我可以说

```
 $scope.$off("onViewUpdated", this.callMe); 
```

当有人广播“onViewUpdated”事件时，此函数将停止调用。

谢谢

**编辑**：我想从另一个函数中注销监听器。不是我注册它的功能。

* * *

## 回答 #1

> 赞同：488
> 
> 时间：2013-02-15T16:16:41.480

您需要存储返回的函数并调用它以取消订阅事件。

```
var deregisterListener = $scope.$on("onViewUpdated", callMe);
deregisterListener (); // this will deregister that listener 
```

这可以在源代码中找到:) 至少在 1.0.4 中。我将发布完整的代码，因为它很短

```
/**
  * @param {string} name Event name to listen on.
  * @param {function(event)} listener Function to call when the event is emitted.
  * @returns {function()} Returns a deregistration function for this listener.
  */
$on: function(name, listener) {
    var namedListeners = this.$$listeners[name];
    if (!namedListeners) {
      this.$$listeners[name] = namedListeners = [];
    }
    namedListeners.push(listener);

    return function() {
      namedListeners[indexOf(namedListeners, listener)] = null;
    };
}, 
```

另外，请参阅[文档](https://docs.angularjs.org/api/ng/type/$rootScope.Scope#$on)。

* * *

## 回答 #2

> 赞同：62
> 
> 时间：2015-03-31T20:19:28.517

查看大多数回复，它们似乎过于复杂。Angular 内置了注销机制。

使用[返回的注销函数`$on`](https://docs.angularjs.org/api/ng/type/$rootScope.Scope#$on)：

```
// Register and get a handle to the listener
var listener = $scope.$on('someMessage', function () {
    $log.log("Message received");
});

// Unregister
$scope.$on('$destroy', function () {
    $log.log("Unregistering listener");
    listener();
}); 
```

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2013-08-21T10:39:30.083

这段代码对我有用：

```
$rootScope.$$listeners.nameOfYourEvent=[]; 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2013-02-15T16:13:47.190

**编辑：正确的做法是在@LiviuT 的回答中！**

您始终可以扩展 Angular 的范围以允许您像这样删除此类侦听器：

```
//A little hack to add an $off() method to $scopes.
(function () {
  var injector = angular.injector(['ng']),
      rootScope = injector.get('$rootScope');
      rootScope.constructor.prototype.$off = function(eventName, fn) {
        if(this.$$listeners) {
          var eventArr = this.$$listeners[eventName];
          if(eventArr) {
            for(var i = 0; i < eventArr.length; i++) {
              if(eventArr[i] === fn) {
                eventArr.splice(i, 1);
              }
            }
          }
        }
      }
}()); 
```

以下是它的工作原理：

```
 function myEvent() {
    alert('test');
  }
  $scope.$on('test', myEvent);
  $scope.$broadcast('test');
  $scope.$off('test', myEvent);
  $scope.$broadcast('test'); 
```

[这是它的一个小动作](http://plnkr.co/edit/ZRt2wVtoJsy6fl5MrWY6)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2013-02-15T16:24:40.327

调试代码后，我创建了自己的函数，就像“blesh”的答案一样。所以这就是我所做的

```
MyModule = angular.module('FIT', [])
.run(function ($rootScope) {
        // Custom $off function to un-register the listener.
        $rootScope.$off = function (name, listener) {
            var namedListeners = this.$$listeners[name];
            if (namedListeners) {
                // Loop through the array of named listeners and remove them from the array.
                for (var i = 0; i < namedListeners.length; i++) {
                    if (namedListeners[i] === listener) {
                        return namedListeners.splice(i, 1);
                    }
                }
            }
        }
}); 
```

因此，通过将我的函数附加到 $rootscope 现在它可供我的所有控制器使用。

在我的代码中我正在做

```
$scope.$off("onViewUpdated", callMe); 
```

谢谢

**编辑： AngularJS 的方法在@LiviuT 的回答中！但是，如果您想在另一个范围内取消注册侦听器，同时又想远离创建局部变量以保留取消注册函数的引用。这是一个可能的解决方案。**

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-01-08T04:16:39.340

@LiviuT 的答案很棒，但似乎让很多人想知道如何从另一个 $scope 或函数重新访问处理程序的拆卸函数，如果你想从创建它的地方以外的地方销毁它。@Рустем Мусабеков 的回答效果很好，但不是很地道。（并且依赖于应该是私有的实现细节，它可能随时改变。）从那里开始，它变得更加复杂......

我认为这里的简单答案是简单地在处理程序本身中携带对拆卸函数（`offCallMeFn`在他的示例中）的引用，然后根据某些条件调用它；可能是您在 $broadcast 或 $emit 事件中包含的 arg。因此，处理程序可以随时随地拆除自己，随身携带毁灭自己的种子。像这样：

```
// Creation of our handler:
var tearDownFunc = $rootScope.$on('demo-event', function(event, booleanParam) {
    var selfDestruct = tearDownFunc;
    if (booleanParam === false) {
        console.log('This is the routine handler here. I can do your normal handling-type stuff.')
    }
    if (booleanParam === true) {
        console.log("5... 4... 3... 2... 1...")
        selfDestruct();
    }
});

// These two functions are purely for demonstration
window.trigger = function(booleanArg) {
    $scope.$emit('demo-event', booleanArg);
}
window.check = function() {
    // shows us where Angular is stashing our handlers, while they exist
    console.log($rootScope.$$listeners['demo-event'])
};

// Interactive Demo:

>> trigger(false);
// "This is the routine handler here. I can do your normal handling-type stuff."

>> check();
// [function] (So, there's a handler registered at this point.)  

>> trigger(true);
// "5... 4... 3... 2... 1..."

>> check();
// [null] (No more handler.)

>> trigger(false);
// undefined (He's dead, Jim.) 
```

两个想法：

1.  对于一次性处理程序来说，这是一个很好的公式。只要放弃条件并在`selfDestruct`它完成自杀任务后立即运行。
2.  考虑到您携带对封闭变量的引用，我想知道原始范围是否会被正确销毁和垃圾收集。您必须使用其中的一百万个才能让它成为内存问题，但我很好奇。如果有人有任何见解，请分享。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-03-11T21:30:27.097

注册一个钩子以在组件被删除时取消订阅您的侦听器：

```
$scope.$on('$destroy', function () {
   delete $rootScope.$$listeners["youreventname"];
}); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-04-11T08:06:21.157

如果您需要多次打开和关闭监听器，您可以创建一个带`boolean`参数的函数

```
function switchListen(_switch) {
    if (_switch) {
      $scope.$on("onViewUpdated", this.callMe);
    } else {
      $rootScope.$$listeners.onViewUpdated = [];
    }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-06-13T08:04:22.110

'$on' 本身返回注销函数

```
 var unregister=  $rootScope.$on('$stateChangeStart',
            function(event, toState, toParams, fromState, fromParams, options) { 
                alert('state changing'); 
            }); 
```

您可以调用 unregister() 函数来取消注册该侦听器

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-10-19T11:51:29.107

一种方法是在完成后简单地销毁侦听器。

```
var removeListener = $scope.$on('navBarRight-ready', function () {
        $rootScope.$broadcast('workerProfile-display', $scope.worker)
        removeListener(); //destroy the listener
    }) 
```

# sql-server - 如何在网页上将多个数据库行显示为单个条目

> ID：14898298
> 
> 赞同：0
> 
> 时间：2013-02-15T15:48:03.347
> 
> 标签：sql-server, asp.net-mvc, entity-framework, webforms

我将尝试设置一个场景以使我的示例更清晰，但假设我的 SQL Server 数据库有 2 个表，一个带有人名、出生日期、最喜欢的颜色和 ID，另一个带有 personID 和电子邮件的表。这是一对多的关系（1 个人的许多电子邮件地址）。假设只有 1 个人有 2 个电子邮件地址。当我`SELECT *`在我的网页上显示 a 的结果时，我会看到 2 行，唯一的区别是电子邮件地址（和 ID，但对于本示例，我不会显示 ID 的结果）。

我的问题是，我们如何解决这个问题以将其显示为仅一个“项目”并且电子邮件以逗号分隔。请考虑这些图像之前和之后：

由于数据库中的连接，数据将出现两次，因为它们是 2 行： ![在此处输入图像描述](../Images/67e50119c2213dc3325f205b7e7f41c6.png)

这就是我想要的：

![在此处输入图像描述](../Images/7f36f1cc9013087fad3bb73505cdf5b6.png)

在我的网页中，我按 ID 对结果进行排序，记下当前 ID，并将其与每次迭代的前一个 ID 进行比较，如果匹配，则继续显示电子邮件的结果，直到 previousID 与 recentId 不同。这也意味着之前将最喜欢的颜色记为变量并在没有更多匹配 ID 时显示它（我希望这是有道理的）。

这可以吗，或者在使用 EF 时有一种优雅的方式吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T17:37:27.900

尝试使用 xml 路径：

```
select name, dob, substring(emails, 1, len(emails) - 1) as emails
from (
    select name, dob, (select email + ', '
                       from PersonEmail
                       for xml path('')) as emails
    from Person
) t 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T16:16:18.657

在列出电子邮件的数据库中创建一个函数。

```
CREATE FUNCTION PersonEmails
(
    -- Add the parameters for the function here
    @PersonID INT
) 

DECLARE @emailList VARCHAR(500)

SELECT @emailList = COALESCE(@emailList + ', ' , '') + email
    FROM PersonEmailTable
    WHERE PersonId = @PersonID

SELECT @emailList 
```

然后在您的 SQL 查询中调用该函数

```
SELECT Persons.*, dbo.PersonEmails(Persons.ID) as Emails FROM Persons 
```

# wpf - 在 mvvmlight 中从主项目 viewmodellocatoe 注册不同项目中的视图模型

> ID：14898301
> 
> 赞同：3
> 
> 时间：2013-02-15T15:48:14.180
> 
> 标签：wpf, mvvm, viewmodel, mvvm-light, viewmodellocator

如何在 MVVMLight 的 ViewModelLocator 类中的不同引用项目中注册视图模型。当我尝试使用 SimpleIoc 注册 viewmodel 类时，我不断收到错误，因为它位于不同的项目中，我想为我的应用程序的不同部分保留不同的项目。

# php - 如何在 wordpress 的仪表板上添加已注册侧边栏的文本小部件？

> ID：14898302
> 
> 赞同：2
> 
> 时间：2013-02-15T15:48:14.563
> 
> 标签：php, wordpress, backend, dashboard, custom-backend

我想知道是否可以在 wordpress 的仪表板中添加特定的文本小部件（$id）或整个 dynamic_sidebar（$id）。

实际上，我只需要客户端在仪表板上编辑文本小部件的文本，而无需转到菜单“外观 > 小部件”——此部分对于该用户角色是隐藏的。

如果您可以在此处留下一些链接或代码，我将不胜感激。
提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T22:18:42.120

为了解决这个问题，我的研究使我：

*   [以编程方式将小部件添加到侧边栏](https://wordpress.stackexchange.com/q/26557/12615)
*   [`control_callback`通过functions.php或插件创建小部件时如何使用？](https://wordpress.stackexchange.com/q/77830/12615)

以下只是基于[@Bainternet](https://wordpress.stackexchange.com/users/2487/bainternet)始终出色的代码（在 Q about 中`control_callback`）的概念证明。

仪表板小部件显示选定文本小部件的标题，^(*它显示“...的内容”，但应该是“...的标题”*)

 `![](../Images/45bb9197610ddb20cb494fed905f3dcf.png)`

它的配置屏幕显示一个下拉列表，其中包含所有侧边栏的所有文本小部件：

 `![](../Images/0aadf37a1f1ad1bd62f44426c82d625a.png)`

这是外观 > 小部件屏幕

 `![](../Images/f9b36da3debbe9d0215be92c3f88a508.png)`

现在，剩下要实现的是一个**编辑界面**（文本输入等）并在 option中**保存正确的值**`widget_text`，使用：
`update_option('widget_text', $a_VERY_well_structured_array_otherwise_things_will_break);`。

```
<?php
/*
Plugin Name: Dashboard Widget to deal with Text Widgets
Plugin URI: http://stackoverflow.com/q/14898302/1287812
Description: based on Bainternet plugin https://wordpress.stackexchange.com/q/77830/12615
Version: 0.1
Author: brasofilo
Author URI: https://wordpress.stackexchange.com/users/12615/brasofilo
*/

// Register widget
add_action( 'wp_dashboard_setup', 'add_dashboard_widget_wpse_77830' );

function add_dashboard_widget_wpse_77830() 
{
    wp_add_dashboard_widget(
        'dashboard_widget_wpse_77830', 
        'Text Widgets', 
        'dashboard_widget_wpse_77830', 
        'dashboard_widget_wpse_77830_handle'
    );
}

// Show widget
function dashboard_widget_wpse_77830() 
{
    //get saved data
    if ( !$widget_options = get_option( 'my_dashboard_widget_options' ) )
        $widget_options = array();

    $saved_txt_widget = isset( $widget_options['txt_widget'] ) ? $widget_options['txt_widget'] : '';
    echo "
    <p><strong>Content of the Widget</strong></p>
    <div class='txt_widget_class_wrap'>
        <label style='background:#ccc;'>&nbsp; {$saved_txt_widget}</label>
    </div>
    ";
}

// Configure and update widget
function dashboard_widget_wpse_77830_handle()
{

    // Get saved data
    if ( !$widget_options = get_option( 'my_dashboard_widget_options' ) )
        $widget_options = array();

    // Process update
    if ( 'POST' == $_SERVER['REQUEST_METHOD'] && isset($_POST['my_dashboard_widget_options']) ) 
    {
        // Minor validation
        $widget_options['txt_widget'] = wp_kses( $_POST['my_dashboard_widget_options']['txt_widget'], array() );
        // Save update
        update_option( 'my_dashboard_widget_options', $widget_options );
    }

    // Set defaults  
    if( !isset( $widget_options['txt_widget'] ) )
        $widget_options['txt_widget'] = ''; //you can set the default

    // Get Widget Text
    $txt = get_option( 'widget_text' );
    // Not necessary in the array
    unset($txt['_multiwidget']);

    // Start HTML
    echo "
    <p><strong>Available Text Widgets</strong></p>
    <div class='txt_widget_class_wrap'>
        <label>Title</label>
        <select name='my_dashboard_widget_options[txt_widget]' id='txt_widget'>";

    // Print options
    foreach( $txt as $t )
    {
        printf(
            '<option value="%s" %s>%s</option>',
            $t['title'],
            selected( $widget_options['txt_widget'], $t['title'], false ),
            $t['title']
            );

    }

    // End HTML
    echo "
           </select>
       </div>
       ";
} 
```

# struts2 - Struts 2值堆栈“登录尝试”计数器不持久变量

> ID：14898306
> 
> 赞同：0
> 
> 时间：2013-02-15T15:48:25.323
> 
> 标签：struts2, persistent-storage, valuestack

我现在正在学习 Struts 2，并尝试创建一个登录尝试计数器，以在 x 次尝试失败后阻止任何进一步的登录尝试。

这是我的 login.jsp 的正文

```
<body>

<h1><s:property value="loginAttempts"/></h1>

<s:form action="login">
    <s:textfield name="username" label="Username" />
    <s:password name="password" label="Password"/>
<%-- <s:hidden name="loginAttempts"  value="<s:property value="loginAttempts"/>" /> --%>
    <s:set var="loginAttempts"><s:property value="loginAttempts"/></s:set>
    <s:submit value="login"/>
</s:form>

</body> 
```

还有我的 Action 类（我不包括带有 getter 和 setter 的私有 var，但它们都在那里）

```
public String execute() throws Exception{

    if (username.equals("admin")&& password.equals("admin"))
    {   return SUCCESS;}
    else if (Integer.parseInt(getLoginAttempts())>2)
    {
        return "lockout";
    }
    else
    {   setLoginAttempts(String.valueOf(Integer.parseInt(getLoginAttempts())+1));
        return "fail";}
} 
```

在最初调用 login.jsp 的操作中，我传入一个初始值

```
loginAttempts="0"; 
```

这很好用。当我在 login.jsp 页面上点击提交时，问题就来了。

我得到以下堆栈跟踪

```
java.lang.NumberFormatException: null 
java.lang.Integer.parseInt(Integer.java:417)
java.lang.Integer.parseInt(Integer.java:499)
com.struts.users.LoginAction.execute(LoginAction.java:17)
sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) 
```

第 17 行是

```
else if (Integer.parseInt(getLoginAttempts())>2) 
```

每次我点击提交按钮时，`loginAttempt`它都会将变量重置为`NULL`.

谢谢

编辑：我知道这可能不是这样做的正确方法，我可能应该在会话中这样做。但是我试图理解为什么它不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T16:00:59.597

一个struts2的动作不是持久的！每次请求发生时都会重新创建它。
您需要做的是实现该`ServletRequestAware`操作的接口，这将使您可以访问`HttpServletRequest`，然后您可以获取您的网络服务器存储的 http 会话对象并增加其值。请小心，因为这需要是线程安全的 - 您可能需要在更新值时锁定 http 会话。
另一种方法是在`ServletContext`其中存储一个`Map`用于登录尝试的用户名的对象。这可能更可靠。

评论中的一些澄清：

您的表单将其上的值发送（称为 POST）到您的网络服务器，struts2 然后获取此“POST 数据”并为您解释它 - 使用您操作的相关设置器使您可以使用此数据。
因此，为了发送登录尝试值，您的表单需要将其作为变量，因此需要一个`<s:hidden>`. 然后，您的操作应该有一个用于登录尝试的设置器；即带有签名的方法`setLoginAttempts(int loginAttempts)`。
现在，当您的操作完成并发现请求无效时，您希望增加该变量并在操作中为其提供一个 getter。
现在，您的 JSP（由尝试失败时的操作呈现）可以从操作中读取该值并将其添加到用户将发送的 HTML 表单中。因此我提到了一个圆圈。
此方法不会增加您网站的安全性，因为该变量`loginAttempts`是从用户 POST 数据中读取的 - 用户可以发送它想要的任何内容，并且您的操作会将其读取为登录尝试的次数。
我希望这会有所帮助...

# ios - Facebook 登录独立于原生 iOS

> ID：14898309
> 
> 赞同：1
> 
> 时间：2013-02-15T15:48:37.033
> 
> 标签：ios, facebook, facebook-login

我试图弄清楚如何在我的应用程序中使用 Facebook 登录，该登录与在其他地方登录设备的任何 Facebook 帐户完全分开。

我希望能够在我的应用程序中切换 Facebook 帐户，同时保持 iPad 所有者的 Facebook 帐户与设备本地关联。这可能吗？

我知道这不仅仅是简单的代码，因为我基本上想绕过本机 Facebook sdk 登录。

# c# - 从 ASP.Net 服务器端访问深度链接 url

> ID：14898311
> 
> 赞同：0
> 
> 时间：2013-02-15T15:48:46.120
> 
> 标签：c#, asp.net, .net, swfaddress

我知道 ASP.Net Request.Url 不能给我由 SWFAddress 生成的[深层链接url。](http://en.wikipedia.org/wiki/Deep_linking)

[http://www.mysite.com/Default.aspx#/6/](http://www.mysite.com/Default.aspx#/6/)

ASP.Net Request.Url 只返回

[http://www.mysite.com/Default.aspx](http://www.mysite.com/Default.aspx)

我发现了一个问题，但它已经很老了 - [SWFAddress Deeplinks and C# library?](https://stackoverflow.com/questions/77637/swfaddress-deeplinks-and-c-sharp-library)

是否有任何库/技术可以从服务器端访问深度链接 url？

谢谢！

**更新：**这是我访问 /Default.aspx#/6/ 时得到的

```
? Request.Url
{http://localhost:56476/Default.aspx}
    AbsolutePath: "/Default.aspx"
    AbsoluteUri: "http://localhost:56476/Default.aspx"
    Authority: "localhost:56476"
    DnsSafeHost: "localhost"
    Fragment: ""
    Host: "localhost"
    HostNameType: Dns
    IsAbsoluteUri: true
    IsDefaultPort: false
    IsFile: false
    IsLoopback: true
    IsUnc: false
    LocalPath: "/Default.aspx"
    OriginalString: "http://localhost:56476/Default.aspx"
    PathAndQuery: "/Default.aspx"
    Port: 56476
    Query: ""
    Scheme: "http"
    Segments: {string[2]}
    UserEscaped: false
    UserInfo: "" 
```

**更新**：很抱歉我没有把我的问题说清楚。如果用户浏览以下 url（很可能保存在收藏夹中），我想从服务器端检索完整的 url。你可以去那个网址；这是一个真正的应用程序。

[http://publ.com/Kgd3A5y#/13/zoomed](http://publ.com/Kgd3A5y#/13/zoomed)

**我当前的解决方案：**我在客户端订阅了一个事件（比如说页面加载）。我在客户端解析 url，并使用 ajax 返回服务器。缺点是它会创建两个页面加载。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T16:24:41.730

不，这不是深度链接。你说的是本地主播。完全不同的东西。

你的问题需要重新定义，然后才能理解。你的问题不是深度链接。您的问题是本地程序正在为本地工作生成本地值（锚）。

如果您在服务器端需要这些信息（并且从表面上看我们的新定义，您似乎不需要——本地工作和数据预计是本地的），那么您需要做两件事之一。

1.  重新定义您的要求和设计，使其不在本地执行这些功能。

2.  在本地进程和您的服务器之间实现通信以传达此信息。

* * *

基于评论和思考这个问题：

您可以通过对您的要求进行以下更改（上面的#1）轻松实施解决方案

而不是使用看起来像这样的链接

```
http://www.mysite.com/Default.aspx#/6/ 
```

使用如下所示的链接

```
http://www.mysite.com/Default.aspx/6/ 
```

或者

```
http://www.mysite.com/Default.aspx?6/ 
```

这些是实际的“深层链接”，服务器端将能够看到它们，您的库也将能够处理它们。（基于您链接到的文档的快速扫描。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T15:58:35.703

带有 # 的 URL 的一部分是锚点。锚点仅在客户端可见。您需要使用例如 JavaScript 在客户端处理锚点，并且您可以将您的请求转换为服务器端可读的正确 URL。

这不是 Asp.Net 或 C# 特定的。这是任何服务器技术的标准行为。

仅引用标准[RFC1808](http://www.ietf.org/rfc/rfc1808.txt)：

> **请注意，片段标识符（以及它前面的“#”）不被视为 URL 的一部分。**

**更新**：

如果你想从你的 swf 发送一些数据到服务器你可以在服务器端编写 web 服务，然后 swf 可以与这个 web 服务通信，所以你可以发送任何你喜欢的数据。

客户端 JavaScript 也可以将 URL 发送到 Web 服务。

**编辑：**

伙伴 你已经收到了很多请求：

> 81 个请求 ❘ 传输 1.37MB ❘ 24.10 秒（加载：2.41 秒，DOMContentLoaded：2.17 秒）

，所以我认为用异步请求发送几个字节不会有任何区别。

此外，我不认为你可以做很多事情。锚完全是客户端的东西，它**不是**URL 的一部分，要处理它你需要在客户端处理并在客户端处理你需要从服务器加载你的客户端脚本，故事结束。

Flash 中有可用的套接字通信，但它过头了，您提到您无权访问 swf 代码。

真的，我看不出有什么理由改变你所拥有的，也没有好的选择。

# java - 在 roo 项目中使用 javax.persistence.Table @Table 注释，如何使用 maven（或 spring）从构建配置文件中设置模式？

> ID：14898316
> 
> 赞同：3
> 
> 时间：2013-02-15T15:49:06.857
> 
> 标签：java, maven, jpa, spring-roo, spring-profiles

和标题里说的差不多。我想让 maven（或 roo）管理 @Table 注释在构建时使用的模式。

我试过了

```
@Table(schema = ${env.schema},name = "MYTABLE") 
```

但得出的结论是，这不是 maven 的工作方式。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T22:44:34.983

@Table 是 JPA 注解，它与 Roo（创建应用程序的工具）或 Maven（编译应用程序的工具，包括对依赖项的管理）无关

如果架构在所有环境中都相同，只需使用名称（注解属性的唯一可用选项）

但是，使用 Spring 可以实现您所要求的：将模式名称参数化。

您可以在 org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean 中配置 jpaProperties 属性

例如，在 Hibernate 中，将 hibernate.default_schema 设置为一个变量，其值可以由 PropertyPlaceHolderConfigurer 管理（在 database.properties 外部文件或环境属性中）

```
<context:property-placeholder location="classpath*:META-INF/spring/*.properties"/>
<bean class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean" id="entityManagerFactory">
    <property name="persistenceUnitName" value="persistenceUnit"/>
    <property name="dataSource" ref="dataSource"/>
    <property name="jpaProperties">
       <props>
        <prop key="hibernate.default_schema">${database.schema}</prop>
    </property>
</bean> 
```

该值不是从构建配置文件中获得的，但我希望它对您有所帮助。我已经使用这种方法很长时间了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T16:00:50.687

您能否设置另一个持久性单元并将模式排除在表注释之外？我不知道 roo shell 对此有何反应。

# c++ - 找到连续的最小值并在队列向量中进行比较

> ID：14898320
> 
> 赞同：1
> 
> 时间：2013-02-15T15:49:20.810
> 
> 标签：c++, sorting, loops, vector, queue

我只是实现一个逻辑，其中一个整数之前被排入队列，搜索向量中的队列循环并将整数排入队列中具有最小大小的队列。以下代码显示了操作。

```
#include <vector> 
#include <queue> 
std::vector<std::queue<int> > q
int min_index = 0;
std::size_t size = q.size();
for( i=0; i<size; i++){ //accessing loop of queues
    if(q[min_index].size() > q[i].size())
        min_index = i; // Now q[min_index] is the shortest queue
} 
q[min_index].push(int) 
```

现在另外我想扩展我的范例，条件是整数应该继续在最短队列中排队**，而条件为真的**最短队列的大小小于或等于队列循环中任何另一个队列的大小。

想做如下所示的代码

```
#include <vector> 
    #include <queue> 
    std::vector<std::queue<int> > q
    int min_index = 0;
    std::size_t size = q.size();
    for( i=0; i<size; i++){ //accessing loop of queues
        if(q[min_index].size() > q[i].size())
            min_index = i

    while(q[min_index].size <= q[some_other_index].size() )
    {
        q[min_index].push(int);

} 
```

我想我应该找到循环的连续最小值并在while循环中进行比较？但我不知道如何继续寻找连续的最小值。

继续这个问题，因为我没有明确地 [比较向量中的队列大小](https://stackoverflow.com/questions/14894658/comparing-queue-sizes-in-a-vector)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T16:06:28.133

如果在循环进行时其他队列未更改，则可以使用初始最小搜索来查找**两个**最短的队列。就像是：

```
std::size_t min_index = 0;
std::size_t second_shortest_index = 0;
std::size_t size = q.size();
for( i=0; i<size; i++){ //accessing loop of queues
    if(q[min_index].size() > q[i].size()) {
        second_shortest_index = min_index; 
        min_index = i; // Now q[min_index] is the shortest queue
    } else if (q[second_shortest_index].size() > q[i].size()) {
        second_shortest_index = min_index;
    }
} 
```

然后，您可以`second_shortest_index`用作您的`some_other_index`. 当您达到该限制时，这仍然需要您搜索新的第二短队列（因为可能有多个最短或第二短的元素）

如果您可以`vector<queue>`使用间接比较器重新排序或使用索引向量，则可以使用`std::make_heap`相关函数更轻松地跟踪最小队列。

# php - 通过 php-osx Liip mac os x 更新 php

> ID：14898321
> 
> 赞同：0
> 
> 时间：2013-02-15T15:49:22.030
> 
> 标签：php, macos, operating-system

我已经通过[php-osx Liip](http://php-osx.liip.ch)安装了 PHP，使用：

```
curl -s http://php-osx.liip.ch/install.sh | bash -s 5.4 
```

命令行说安装没问题，但是当我`php -v`在终端上运行时，终端显示旧版本和apache `<?php phpinfo();`。

我是否必须更改某些内容才能识别新版本

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-10T20:16:50.523

命令行二进制文件位于 /usr/local/php5/bin/php 中，您必须直接调用它。

您还可以添加

```
export PATH=/usr/local/php5/bin:$PATH 
```

例如。你的 ~/.profile 文件将它放在你的搜索路径中

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-15T16:16:40.917

我想我已经解决了

php-osx 在 /usr/loacl/php5 上安装 php。所以我做了什么：

```
sudo nano /etc/apache2/httpd.conf 
```

我已经换行了

```
LoadModule php5_module  libexec/apache2/libphp5.so 
```

至：

```
LoadModule php5_module /usr/local/php5/libphp5.so 
```

链接到apache的php版本更新了，但终端上的php版本保持旧版本

如果有人有另一种解释，那就太好了

# c# - MongoDb 高效的连接创建

> ID：14898322
> 
> 赞同：2
> 
> 时间：2013-02-15T15:49:27.667
> 
> 标签：c#, mongodb

我想知道创建/关闭 MongoDb 连接的最有效方法。

我有一组 Restful 服务（使用 c# 创建），其中一些从 MongoDb 和一些 POST 数据中获取数据。

```
 public static MongoDatabase GetDatabase()
   {
      MongoServerSettings settings = new MongoServerSettings();
      settings.Server = new MongoServerAddress("localhost", 27017);
      MongoServer server = new MongoServer(settings);
      var database = server.GetDatabase("RapidDataStream");
      return database;
   } 
```

我从我的每个服务中使用上述连接，例如列出所有传感器的服务。

```
public List<Sensor> getPublicSensors()
{
            List<Sensor> sensors = new List<Sensor>();
            MongoDatabase mySensor = GetDatabase();
            var query = Query.And(Query.EQ("User", BsonValue.Create("Public")));
            var mySensorRecords = mySensor.GetCollection("sensor_meta_data").Find(query);
            DataSet ds = new DataSet();

            foreach (var rec in mySensorRecords)
            {
                Sensor sensor = new Sensor();
                sensor.sensorId = rec["EnvId"].ToString();

                for (int i = 2; i < rec.ElementCount; i++)
                {
                    SensorObject so = new SensorObject();
                    so.fieldName = rec.GetElement(i).Name.ToString();
                    so.value = rec.GetElement(i).Value.ToString();
                    sensor.sensorObject.Add(so);
                }
                sensors.Add(sensor);
            }
            return sensors;
} 
```

我的问题是，这是否是一个有效的设计，否则我该如何改进它？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T15:56:58.000

我相信 Mongo（或驱动程序）会为我们处理一些事情，所以我使用 Create 方法：

```
MongoServer.Create(....) 
```

而不是创建一个新实例。该`Create`方法将创建一个新实例或返回一个现有实例（每个服务器设置都是唯一的）。

事实上，只是为了向您展示我目前使用的实际方法：

```
internal static MongoDatabase DB(IMongoConfig config)
{
    return MongoServer
           .Create(config.ConnectionString)    //This bit is getting the MongoServer
           .GetDatabase(config.DatabaseName);  //This bit gets the Database, which is returned
} 
```

`IMongoConfig`如您所见，这只是我用来指定我需要的连接字符串和数据库名称的一个小 DTO - 这与它的工作原理相结合，`MongoServer.Create`使得处理从同一运行代码库到多个数据库的连接变得非常容易。

```
public interface IMongoConfig
    {
        string ConnectionString { get; set; }
        string DatabaseName { get; set; }
    } 
```

# php - 如何在 PHP 中编辑句子之间的空格？

> ID：14898323
> 
> 赞同：0
> 
> 时间：2013-02-15T15:49:28.600
> 
> 标签：php, regex, preg-replace, sentence

我目前正在使用

```
$text= preg_replace('/(?<=[a-zA-Z])[.](?![\s$])/','. ',$text); 
```

要在 PHP 中编辑句子，但我有一个问题，这里有一个例子：

> 这是我的示例文本。在这句话之后，点后面没有空格。还有一些其他的句子。

我该怎么办？我希望 PHP 在这种情况下添加空格，但不是在已经有空格或以“...”结尾的句子之后

另一个不受欢迎的行为是数字。例如 ：

> 在彩票中赢得 1.000.000 是多么棒的事！

我真的不希望它`1\. 000\. 000`在编辑后变成。

也一样`C.J.`。它必须留下`C.J.`而不是`C. J.`

所以简而言之，在以下情况下应该有空格：

*   “。” **不**跟数字（可以是其他符号）
*   当有多个点如“...”时忽略
*   当点前有 1 或 2 个字母时忽略。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T15:52:07.923

```
$text = preg_replace('/(?<! [a-z]| [a-z]{2})\.(?! |\d|\.)/i', '. ', $text); 
```

在这里查看它的实际操作：[http ://regex101.com/r/zE4pI4](http://regex101.com/r/zE4pI4)

* * *

如果您想考虑文本开头的首字母缩写，这可能会变得更加复杂（[请参阅此处它是如何失败](http://regex101.com/r/sW4sM2)的）。由于后视必须是固定长度，因此您必须为此创建一个单独的后视：

```
/(?<! [a-z]| [a-z]{2})(?<!\b[a-z]|\b[a-z]{2})\.(?! |\d|\.)/ 
```

在此处查看实际操作：[http ://regex101.com/r/pH1mZ5](http://regex101.com/r/pH1mZ5)

# ruby - 如何在 YAML 文件中创建动态键名

> ID：14898326
> 
> 赞同：2
> 
> 时间：2013-02-15T15:49:36.470
> 
> 标签：ruby, yaml

我想在 YAML 文件中创建动态键名和值，这样可以节省一些空间。

例如：

```
KID(\d+)_AGE: &kid(params)_age
```

```
  孩子（参数）：“18”
```

所以预期的结果应该是：

```
KID1_AGE: &kid1_age
```

```
  孩子1：“18”
```

因此，每当我输入 KID1_AGE、KID2_AGE 时，密钥都是动态的，它们将获取相同的哈希值。

关于如何获得这个的任何建议？这主要用于 Ruby。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T15:54:32.140

如果您使用的是 Rails，则首先使用 ERb 解析文件

```
# foo.yaml

my_random: <%= Random.rand(1..100) %> 
```

* * *

所以你可以做类似的事情

```
<% 100.times do |n| %>
<%= "KID#{n}_AGE: &kid#{n}_age" %>
<% end %> 
```

不过，这感觉代码很臭。您可能应该解释您的总体目标，而不是您希望如何实现它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T18:08:46.600

您不能使用看起来像正则表达式模式的字符串作为键，并期望它像正则表达式一样工作。YAML 和 Ruby 不能那样工作。您也不能使用正则表达式模式作为散列的键，然后在散列中抛出一个字符串，让键自动匹配并返回关联的值。哈希和 Ruby 不是这样工作的。

您可以创建与模式匹配的键，然后让 Ruby 遍历 YAML 返回的哈希，寻找匹配的键，但这不会为您节省任何空间，具体取决于您所说的目标。

尽可能充分地使用 YAML 使用[别名和锚点](http://www.yaml.org/YAML_for_ruby.html#aliases_and_anchors)的能力。它们可以使 YAML 文件更小，同时在文件被解析后仍然可以访问您需要的值。

# http - 不使用浏览器发送 HTTP 数据包？

> ID：14898331
> 
> 赞同：4
> 
> 时间：2013-02-15T15:50:01.797
> 
> 标签：http, telnet

我想我有两个问题：

1.  我正在尝试在不使用 Web 浏览器的情况下向 Web 服务器发送 HTTP 请求。我已经阅读了使用 Telnet 执行此操作的最常见方法，但我想知道其他方法。

2.  另外，我认为我的 telnet 有问题。我激活了 telnet 客户端，然后在命令窗口中输入 telnet，然后输入“open IP-address 80”，它会一直显示“connecting to IP-address ...”，但永远不会让我越过它。你们中有人遇到过这个问题吗？另外，我在 Wireshark 上注意到 TCP 握手正确发生。

谢谢，麻烦您了！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T15:58:18.783

您还应该查看 curl 命令行实用程序：[http](http://curl.haxx.se/) ://curl.haxx.se/基本上，它是一个很酷的小软件，可以发出 HTTP 请求（并且还支持其他协议）。另请查看 hurl：[http](http://www.hurl.it/) ://www.hurl.it/ ，它是 curl 的一种 Web 应用程序版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T15:56:09.530

您可以使用`sockets`or `WebClient`(C#) 来完成同样的事情：

默认方式是`Telnet`：

在 telnet 命令提示符下，您可以执行以下操作：

```
 o   host   port>         (o www.website.com 80)
 GET /index.htm HTTP/1.1 
```

使用`WebClient`（注意：这是一个 C# WebClient 对象）：

```
 var webClient = new WebClient();
 webClient.Headers.Add("user-agent", "Agent");
 Stream responseStream = webClient.OpenRead("http://www.google.com") 
```

来自服务器的响应将存储在`responseStream`对象中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T15:53:30.887

指定端口了吗？端口 80 通常用于 HTTP 请求。

`telnet www.some-site.com/some-page.html 80`

连接后，您需要提出`GET`请求。（发送命令`GET`）。

# java - 如何从java脚本数组中的java代码中获取值

> ID：14898332
> 
> 赞同：0
> 
> 时间：2013-02-15T15:50:06.923
> 
> 标签：java, javascript, html

我有一个使用 MyEclipse 制作的 java 代码。在主要方法中，我有一个输出，它是一个数组 [10,23,31,45]。我的问题是如何在 java 脚本数组中获取这些值。是否有任何方法或工具可以让我在 java 脚本中使用我的 java 对象值以在 HTML 中显示某些内容。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T15:55:20.707

好吧，这取决于您如何创建 html 页面或通常将数据获取到您的页面上。在大多数框架中，您可以将数组直接渲染到传递给浏览器的 hmtl 源中。

在 JSP 中，它可能是这样的：

```
<script ...>
  var myarray = <%=Arrays.toString(javaArray)%> <!-- not sure about the formatting though, might have to be altered-->
</srcipt> 
```

*编辑*

澄清一下：您需要的是适合 JavaScript 的数组的字符串表示形式，并且`toString()`可能不会产生您需要的结果。在这种情况下，您可以使用 JSON 库将您的对象转换为 JSON（因此是与 JavaScript 兼容的表示）或编写您自己的数组/对象 -> 字符串转换器。

使用上面的代码`int[] javaArray = {1,2,3};`会导致
`var myarray = [1, 2, 3];`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T15:59:14.260

如果您想从 JVM 中的 java 中执行 javascript，这可能会有所帮助：[http ://commons.apache.org/bsf/](http://commons.apache.org/bsf/)

如果要在 JSP 中输出 java 对象值，可以使用 EL、scriptlet、表达式等。

**表达：** `var javascriptArray = <%= javaArray.toString() %>`

**EL：（** `var javascriptArray = ${javaArray}`注意这种情况下的格式）

**JSTL：** `var javascriptArray = [
<c:forEach var="element" items="${javaArray}" varStatus="cursor">
"${element}"
<c:if test="${!cursor.last}">,</c:if>
</c:forEach>
]`

# java - Ajax response.getWriter() 不支持特殊字符

> ID：14898333
> 
> 赞同：0
> 
> 时间：2013-02-15T15:50:14.637
> 
> 标签：java, javascript, ajax

我正在用两种语言（英语和法语）制作表格。当有人输入它的名字时，表单使用 ajax 从我们的数据库中查询信息。可悲的是，当我使用 response.getWriter().write("Hey é è"); 功能它似乎不支持像'é''è'这样的字符。

这是我的 javascript 和 ajax ：

```
 function fillBlanks(idOfInputText,valueOfInputText)
    {

        //Prepare a new ajaxRequest.
        if (window.XMLHttpRequest) 
        {// code for IE7+, Firefox, Chrome, Opera, Safari
            xmlhttp = new XMLHttpRequest();
        } else {// code for IE6, IE5
            xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
        }

        //Ajax receiving the response in this function
        xmlhttp.onreadystatechange = function() 
        {
            //state 4 is response ready.
            //Status 200 is page found.
            if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                //Change the content of the select to ajax result.
                var content = [];
                content = decode(xmlhttp.responseText);

                document.getElementById('lastName').innerHTML = content[0];
                document.getElementById('firstName').innerHTML = content[1];
                document.getElementById('defaultPrinter').innerHTML = content[2];
                document.getElementById('dropDownRespExistant').innerHTML = content[3];

            }
        };

        //Send the Ajax request.
        xmlhttp.open('GET','mainServlet?command=ajax.FillBlanksHtml&ID='+ idOfInputText + '&VALUE=' + valueOfInputText, true);
        xmlhttp.send();
    } 
```

这是我的java类：

```
public class FillBlanksHtmlCommand extends FrontCommand
{
public static String userName;
public static String lastName;
public static String firstName;

@Override
public void processRequest(HttpServletRequest request,HttpServletResponse response) throws ServletException, IOException 
{
    String value = new String(request.getParameter("VALUE"));//get the ajax value

    response.getWriter().write(OracleUserFinder.findHtmlCodeForOracleUser(value));

} 
} 
```

我想知道是否可以通过其他方式发送特殊字符。如果你能告诉我这个函数使用什么编码，那就太好了！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T15:57:42.773

根据[Detecting the character encoding of an HTTP POST request](https://stackoverflow.com/q/708915/1065197)问题，您应该将请求的字符编码从 ISO-8859-1 更改为 UTF-8，以使您的请求正常工作。

最简单的方法是（从问题的答案）：

```
<form accept-charset="UTF-8"> 
```

尽管您可以使用那里提出的任何其他解决方案。

对于响应，您只需将字符集添加到 UTF-8，如下所示：[设置 HTTP 字符集参数](http://www.w3.org/International/O-HTTP-charset.en.php)

在您的 Servlet（或 Controller 类）中，只需添加以下代码：

```
response.setContentType("text/xml; charset=UTF-8"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T16:02:33.417

如何使用 jQuery

```
contentType: "application/x-www-form-urlencoded; charset=UTF-8" 
```

看看这个链接 [http://www.gunith.com/2010/11/how-to-send-german-umlauts-through-jquery-ajax/](http://www.gunith.com/2010/11/how-to-send-german-umlauts-through-jquery-ajax/)

# python - 使用python登录后如何抓取网页？

> ID：14898335
> 
> 赞同：1
> 
> 时间：2013-02-15T15:50:20.577
> 
> 标签：python, http, urllib, cookielib

登录后，我需要为我的帖子**刮脸**书，但我不知道如何“保持连接活跃”。

我正在使用 urllib，我知道如何连接到服务器、获取页面、发送数据，但我不知道如何处理 cookie 以访问需要登录的页面。我发现我需要 cookielib 来完成这项工作，但找不到教程或解释如何完成工作的东西。

你能以某种方式帮助我吗？或者给我一个教程的链接？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T15:52:18.813

请不要抓取您的 Facebook 页面，它违反条款和条件，而是使用允许您注册可以获取帖子的应用程序的[Graph API](http://developers.facebook.com/docs/reference/api/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T16:58:56.440

为此，您需要在应用程序中维护一个[CookieJar 。](http://docs.python.org/2/library/cookielib.html#examples)这个库就像 Python HTTP 客户端的一个插件，它可以让你在整个抓取会话中保存 cookie（例如你所使用的登录令牌）。

请注意，您可能需要为 Facebook[指定有效的用户代理](http://www.diveintopython.net/http_web_services/user_agent.html)才能接受您的请求。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-15T16:24:57.833

为什么不使用现有的[Python for Facebook](http://www.pythonforfacebook.com/)库？如果您只是想连接 API 并发布/检索状态消息，我看不出它有那么复杂。

# c - C中的帕斯卡三角形解决方案给出了意外的输出

> ID：14898338
> 
> 赞同：0
> 
> 时间：2013-02-15T15:50:22.350
> 
> 标签：c

我正在尝试 C 中的帕斯卡三角解决方案，基于以下公式：

![帕斯卡树的公式](../Images/266cca72bcb207c117bc9e2fa1ecd8ef.png)

我根据上面的公式编写了以下代码：

```
#include <stdio.h>
#include <stdlib.h>

int pascalTriangle(int row, int col);

int main()
{
  int row, col;

  printf("Enter the row [0 to n]: ");
  scanf("%i", &row);
  printf("Enter the column [0 to m]: ");
  scanf("%i", &col);

  if(col > row) {
    printf("Error: column can be less than or equal to row\n");
    exit(1);
  }

  printf("Value = %i\n", pascalTriangle(row, col));
  return 0;
}

int pascalTriangle(int row, int col)
{
  int value[100];
  value[0]=1;
  int i=1;
  if(row==0 || row==col || col==0) {
    return value[0];
  } else {
row=row+1;
    while(i<=col) {
        printf("i = %i\trow = %i\tcol = %i\n", i, row, col);
        value[i]='\0';
        value[i]=(value[i-1]) * ((row-i)/i);
        printf("value[%i] = %i\tvalue[%i] = %i\n", i-1, value[i-1], i, value[i]);
        ++i;
    }
    return value[i-1];
  }
} 
```

在这里，在某种程度上，它提供了适当的 O/P。但是，对于许多 I/P，我发现了错误的答案。我找不到逻辑错误，因为在纸面上逻辑给出了预期的 O/P。示例：- 我给 row=4 & col=2，O/P 应该是 6，但得到 4 作为 O/P。

请帮忙！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T16:00:08.567

线

```
value[i]=(value[i-1]) * ((row-i)/i); 
```

是错的。`row - i`不需要被`i`（通常不是）整除。你需要先乘然后除，

```
value[i]=(value[i-1] * (row-i))/i; 
```

（括号不是必需的，因为它们是隐式放置的），但是你有更早的溢出，所以对于较大的值`row`，计算 gcd，

```
int g = gcd(row - i, i) 
```

和除法`(row - i) / g`，`value[i-1]/(i/g)`并乘以这些结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T15:58:39.870

因为`row`和`i`是整数`((row-i)/i)`使用截断的整数除法。所以当`row == 5`和`i == 2`它评估为 1 而不是 1.5。

由于该系列的工作方式，我认为您可以通过重新配置表达式来避免使用浮点运算：

```
value[i]= (value[i-1]) * (row-i)) / i; 
```

# wordpress - 找不到页面上的 Wordpress 分页链接

> ID：14898339
> 
> 赞同：1
> 
> 时间：2013-02-15T15:50:23.217
> 
> 标签：wordpress, pagination, wordpress-theming, http-status-code-404, custom-post-type

我的 wordpress 主题有点问题。所以我刚刚创建了一个类别主题，并为我的永久链接使用以下结构：/%year%/%monthnum%/%postname%/。

分页起初不起作用，但现在我终于设法让它运行了。链接

```
 <div class="pagination">
            <div class="alignleft"><?php previous_posts_link('&laquo; neuere Artikel') ?></div>
            <div class="alignright"><?php next_posts_link('ältere Artikel &raquo;','') ?></div>
         </div> 
```

正在显示。

主要问题是当我单击“next_posts”-Link 或 previous_posts-Link 时，我会得到 404。

这是我的代码：

```
 <?
        $temp = $wp_query; 
$wp_query = null; 
$wp_query = new WP_Query();  
    $paged = (get_query_var('paged')) ? get_query_var('paged') : 1;
    $wp_query->query(array(
    'posts_per_page' => 5,
    'orderby'=> 'menu_order',
    'paged'=>$paged
    ) );
?>

<?php if (have_posts()) : ?>
        <?php  while ($wp_query->have_posts()) : $wp_query->the_post(); ?>
            <div class="type-post">
                <h2><a href="<?php echo get_permalink(); ?>"><?php echo get_the_title(); ?></a></h2>
                <div class="blog-date">
                    <a  class="admin" href="<?php echo get_author_posts_url(get_the_author_meta( 'ID' )); ?>"><?php the_author_meta('display_name'); ?></a> 
                    <a href="#" class="date"><?php the_time('j. F, Y'); ?></a> 
                    <a href="<?php comments_link(); ?>" class="comments"><?php comments_number('0 Kommentare','1 Kommentar','% Kommentare'); ?></a>
                </div><!-- close .blog-date -->

                <p><? echo wp_trim_words( get_the_content(), 100 ); ?> </p>
                <p class="alignright"><a href="blog-single.php" class="button">Read more</a></p>
            <div class="clearfix"></div>
            </div>
                <?php endwhile; ?>
            <!-- END Single Content -->
         <div class="pagination">
            <div class="alignleft"><?php previous_posts_link('&laquo; neuere Artikel') ?></div>
            <div class="alignright"><?php next_posts_link('ältere Artikel &raquo;','') ?></div>
         </div>
        <?php endif; ?>
            <div class="clearfix"></div>

<!-- END CONTENT -->
<?php   $wp_query = null; 
$wp_query = $temp;  ?> 
```

但它仍然不起作用。有人可以帮我吗？提前致谢。<3

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-10T09:42:40.930

去

```
Settings -> Reading 
```

并设置`Blog pages show at most`和中的选项`Syndication feeds show the most recent`相同。`posts_per_page``wp_query->query`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T05:36:22.403

在您的代码中 $paged = (get_query_var('paged')) ？get_query_var('paged') : 1;

get_query_var('paged') 替换为 get_query_var('page')

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-25T17:10:48.530

```
<?php
global $wp_query;
$paged = ( get_query_var('paged') ) ? get_query_var('paged') : 1;
$args = array(  
            'post_type' => 'your post type', //Post type
            'posts_per_page' => 5, //How many post u want to display per page
            'paged' => $paged  ,
            'orderby'=> 'menu_order',                    
            );
$the_query = new WP_Query( $args );
 if (have_posts()) : ?>
        <?php  while ($the_query->have_posts()) : $the_query->the_post(); ?>
            <div class="type-post">
                <h2><a href="<?php echo get_permalink(); ?>"><?php echo get_the_title(); ?></a></h2>
                <div class="blog-date">
                    <a  class="admin" href="<?php echo get_author_posts_url(get_the_author_meta( 'ID' )); ?>"><?php the_author_meta('display_name'); ?></a> 
                    <a href="#" class="date"><?php the_time('j. F, Y'); ?></a> 
                    <a href="<?php comments_link(); ?>" class="comments"><?php comments_number('0 Kommentare','1 Kommentar','% Kommentare'); ?></a>
                </div><!-- close .blog-date -->

                <p><? echo wp_trim_words( get_the_content(), 100 ); ?> </p>
                <p class="alignright"><a href="blog-single.php" class="button">Read more</a></p>
            <div class="clearfix"></div>
            </div>
                <?php endwhile; ?>
            <!-- END Single Content -->
        <?php endif; ?>
<div class="pagination">
<?php             
    global $wp_query;

    $big = 999999999; // need an unlikely integer

    echo paginate_links( array(
        'base' => str_replace( $big, '%#%', esc_url( get_pagenum_link( $big ) ) ),
        'format' => '?paged=%#%',
        'current' => max( 1, get_query_var('paged') ),
        'total' => $wp_query->max_num_pages
    ) );
?>
</div> 
```

# android - 设置 AVD android 的困难

> ID：14898340
> 
> 赞同：0
> 
> 时间：2013-02-15T15:50:25.217
> 
> 标签：android, avd

我在 Eclipse Indigo Java EE IDE 中设置 AVD 时遇到困难。我尝试了许多带有许多 API 的皮肤，但我无法获得我在教程中经常看到的正确 AVD，此外，控制按钮和键盘没有出现在我的 AVD 中。连设置窗口都不一样，这里是： [AVD设置](http://imageshack.us/photo/my-images/16/avdu.png/)

这是我通常得到的 AVD： [AVD running](http://imageshack.us/photo/my-images/254/avd2.png/)

谁能帮帮我，告诉我在设置我的 AVD 时选择的确切规格！！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T16:28:08.060

您只需要选中 2 个复选框，说明存在硬件键盘并显示带有硬件控件的皮肤。通过这样做，您将在 AVD 上获得键盘和其他控件。

# php - Times 在不同的服务器上代表不同

> ID：14898342
> 
> 赞同：0
> 
> 时间：2013-02-15T15:50:28.747
> 
> 标签：php

我对 php 相当陌生，并且在我的测试 vr 生产服务器上时间表示不同时遇到了问题。我正在计算工作时间，就像在时钟上一样。打卡打卡=总工作时间。我正在使用这段代码：

```
$time1 = $_POST['txt_starttime'];
$time2= $_POST['txt_endtime'];

$TotTime=date('H:i',strtotime($time2)-strtotime($time1)); 
```

晚上 11:45 到晚上 11:50 = 5 分钟在我的测试服务器上，它工作正常，并将 00:05 存储在数据库中。在生产服务器上，它给了我 05:05:00 我玩了格式变量，但后来我得到了 17:05:00

这是服务器端设置...请帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T15:53:07.713

您需要设置时区

```
date_default_timezone_set('Etc/GMT+1'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T15:53:15.853

似乎服务器正在使用默认的 GMT 时区。您需要匹配逻辑中的差异或配置服务器以调整差异。

因此，如果您的家庭时区是`+530`小时，您需要以某种方式添加`+ 5 hours 30 minutes`到`strtotime()`, 例如：

```
if ($production)
    $basetime = "+ 5 hours 30 minutes";
else
    $basetime = "" 
```

并且您需要将生产中的标志设置为`true`.

否则，您可以使用该函数[`date_default_timezone_set`](http://php.net/manual/en/function.date-default-timezone-set.php)并传递时区：

```
date_default_timezone_set('Asia/Calcutta'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T15:56:16.430

`date`根据 UNIX 时间戳为您提供**一天中的时间。**UNIX 时间戳是自 1970 年 1 月 1 日以来的秒数；因此它是一个*相对时间*。结果`date`是*绝对时间*。

您想表示一个时间跨度，即*相对时间*。不要将其格式化为绝对时间。您正在生成的是绝对时间戳*January 1st 1970 00:05*`00:05` ，如果在正确的时区中表示，其中的小时和分钟部分恰好是。在不同的时区，情况会有所不同。

要从`300`(秒) 到`5`(分钟)，请使用数学 ( `300 / 60`) 将它们转换。

# php - 购物车/结帐上的致命错误

> ID：14898346
> 
> 赞同：0
> 
> 时间：2013-02-15T15:50:35.703
> 
> 标签：php, wordpress

我在 Wordpress 的子主题上设置 WooCommerce 时遇到问题。

一切似乎都很好，直到您进入购物车和结帐页面，我收到此错误：

> 致命错误：在第 23 行的 /home/electric/public_html/test/creative/wp-content/plugins/woocommerce/templates/content-product.php 中的非对象上调用成员函数 is_visible()

我用谷歌搜索，阅读教程和指南，但似乎没有任何解决方法。有没有其他人遇到过类似的问题，并且可以提供解决方案？

我已经卸载了插件，停用/重新激活并更改了模板。它适用于默认的 211 主题，但由于它是子主题，我会认为它会继承父主题的功能等？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T15:59:35.387

尝试重建您的永久链接。

转到您的仪表板、设置、永久链接，然后将永久链接更改为 ID，保存，然后将其更改回您拥有的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-14T04:36:16.583

我有同样的问题。如果您尝试在自定义页面上获取产品，则需要将 woocommerce 设置中的主商店页面更改为您的页面。

# entity-framework - 跨关联的 LINQ 查询

> ID：14898347
> 
> 赞同：1
> 
> 时间：2013-02-15T15:50:36.350
> 
> 标签：entity-framework, linq-to-entities, linq-query-syntax

我有一个从我的数据库生成的实体框架。在这个数据库中有一个名为 User_Security_Role 的表，它由两个字段组成：Employee_ID 和 User_Name。这两个字段都充当其主键，也是外键。这些字段来自两个表 Sytem_Role（以 Role_ID 作为其 PK）和 User_Identity（以 User_Name 作为其 PK）。生成 .edmx 文件时，User_Security_Role 表不是作为表生成的，而是作为两个实体之间的关联集生成的：System_Role 和 User_Identity。

我想用以下查询查询 EF：

```
var usr = from u in _imEntities.User_Security_Role
          where u.Role_ID == 3
          select u.User_Name; 
```

但是，“User_Security_Role”没有显示为实体集中的实体，现在我不确定如何查询它，因为它是一个关联集。如何编写 linq 查询以从关联而不是实体中选择数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T18:06:43.363

听起来 EF 已将 User_Security_Role 表标识为多对多关系中不需要的表（它可能是）。在这种情况下，您可以将查询编写为以下内容之一：

```
var usr = From u in _imEntities.User_Identities
          where u.Roles.Any(r => r.Role_ID == 3)
          select u; 
```

或者

```
var usr = from r in _imEntities.System_Roles
          where r.Role_ID == 3
          from u in r.UserSecurities
          select u; 
```

# javascript - 在对话框加载之前显示引导模式对话框背景？

> ID：14898348
> 
> 赞同：-1
> 
> 时间：2013-02-15T15:50:46.113
> 
> 标签：javascript, jquery, twitter-bootstrap, modal-dialog

我正在通过 jquery 将内容加载到引导模式对话框中。（我正在使用 bootbox 插件来创建动态模式对话框）

```
$.ajax({
        url: "create.cshtml",
        dataType: 'html',
        success: function (data, textStatus, jqXHR)
        {
            bootbox.dialog(data);
        },
        error: function (jqXHR, textStatus, errorThrown)
        {
            HandleError(textStatus, errorThrown);
        }
    }); 
```

现在这一切都很好。

但是我想要做的是在等待 aync 调用完成时显示背景淡入淡出，以便用户可以看到它正在加载。我在文档中看不到有关显示模态背景的任何内容，但我认为在执行异步调用之前必须有一种方法来触发它。

有人有想法么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T15:53:47.790

你可以这样做：

```
$("YOUR_BACKGROUND").fadeIn("slow", function(){

//MAKE YOUR AJAX CALL HERE

}); 
```

# opencv - 如何在 Opencv 中计算两个图像的联合熵

> ID：14898349
> 
> 赞同：3
> 
> 时间：2013-02-15T15:50:47.280
> 
> 标签：opencv, entropy

我必须计算两个灰度图像之间的互信息。为此，我必须计算图像的熵和联合熵。但是我在 Opencv 中找不到任何熵和联合熵函数。谁能帮我在 Opencv 中找到熵和联合熵函数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T18:25:28.160

为此，您需要计算可以在 OpenCV 中使用该`calcHist()`函数执行的图像直方图。然后，您可以通过将每个 bin 中的值除以图像中的像素总数来对直方图进行归一化以获得概率。图像熵由下式给出：

![公式](../Images/d253148a9b1dae3835264521e05a8d24.png)

其中每个元素![公式2](../Images/ff8bdd1e091ad1d5a74a145569f3d7aa.png)都是直方图中的一个值（假设您的直方图在 [0-255] 范围内）。您需要小心零值，因为在获取日志时这些值会评估为 -infinity。

# dynamics-crm-2011 - 动态 crm 2011：根据值更改表单和/或记录在视图中的外观

> ID：14898353
> 
> 赞同：1
> 
> 时间：2013-02-15T15:51:10.130
> 
> 标签：dynamics-crm-2011

我想根据一个简单的值更改表单的外观以及列表视图中的记录。

例如，对于所有具有电子邮件地址的记录：

1.  使表格变黄
2.  使视图中的记录变为红色。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T16:39:55.813

您可以将 css 应用为 WebResources。你可以在这里看到一些例子：

*   [http://blog.customereffective.com/blog/2011/08/crm-2011-form-customization-part-2.html](http://blog.customereffective.com/blog/2011/08/crm-2011-form-customization-part-2.html)
*   [http://weblogs.asp.net/gayanperera/archive/2010/06/30/how-to-change-the-grid-icons-dynamically.aspx](http://weblogs.asp.net/gayanperera/archive/2010/06/30/how-to-change-the-grid-icons-dynamically.aspx)

在 Codeplex 中有一些模板的[工具。](http://crm2011templates.codeplex.com/)看一看。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T19:11:55.237

您将无法以受支持的方式执行这些操作。**这里正确的做法是挑战需求。**不受支持的更改可能会在将来不经通知的情况下破坏您的解决方案。CRM Online 尤其如此（我知道您还没有说过您正在使用它）。

无论如何 +1 佩德罗，因为尽管不受支持，但他的建议将实现您的目标。

# python - 线性/对数直方图的自适应 xy 轴限制，以制作直方图的宽度和高度

> ID：14898355
> 
> 赞同：0
> 
> 时间：2013-02-15T15:51:11.953
> 
> 标签：python, matplotlib, histogram

目前我正在绘制如下直方图：

我只想用等间距的直方图重新组合数据，但使用新的比例。我需要指定宽度，但由于 xscale,yscale 重置轴的方式，我不知道如何定义它。即在每种情况下（线性对数、对数对数等），应该做什么

```
ax.set_xlim(min(bin_edges), max(bin_edges))
ax.set_ylim(min(hist), max(hist)) 
```

设置为？或者有没有办法自动设置它，所以直方图看起来很正确，这*完全*基于我将 xscale 和 yscale 设置为“线性”或“对数”的事实。我确信有一个更简单的解决方案。目前，当我进入日志空间时，条形重叠并且宽度不同。

```
 if self.xscale_hist == 'linear-linear':
            ax.set_xscale("linear")
            ax.set_yscale("linear")
            hist, bin_edges = np.histogram(self.tmphistdata, bins=self.numhistbins)
            width = (max(bin_edges)-min(bin_edges))/len(bin_edges)
            self._display_points = ax.bar(bin_edges[:-1], hist, width = width, facecolor='green')
        if self.xscale_hist == 'linear-log':
            ax.set_xscale("linear")
            ax.set_yscale("log")
            hist, bin_edges = np.histogram(self.tmphistdata, bins=self.numhistbins)
            hist = np.log10(hist)
            width = (max(bin_edges)-min(bin_edges))/len(bin_edges)
            self._display_points = ax.bar(bin_edges[:-1], hist, width = width, facecolor='green')
        if self.xscale_hist == 'log-linear':
            ax.set_xscale("log")
            ax.set_yscale("linear")
            hist, bin_edges = np.histogram(self.tmphistdata, bins=self.numhistbins)
            bin_edges = np.log10(bin_edges)
            width = (max(bin_edges)-min(bin_edges))/len(bin_edges)
            self._display_points = ax.bar(bin_edges[:-1], hist, width = width, facecolor='green')
        if self.xscale_hist == 'log-log':
            ax.set_xscale("log")
            ax.set_yscale("log")
            hist, bin_edges = np.histogram(self.tmphistdata, bins=self.numhistbins)
            bin_edges = np.log10(bin_edges)
            hist = np.log10(hist)
            width = (max(bin_edges)-min(bin_edges))/len(bin_edges)
            self._display_points = ax.bar(bin_edges[:-1], hist, width = width, facecolor='green') 
```

# sql - 在 Oracle SQL 中计算工作日（无函数或过程）

> ID：14898357
> 
> 赞同：12
> 
> 时间：2013-02-15T15:51:24.183
> 
> 标签：sql, oracle11g, date-arithmetic

我正在尝试计算 Oracle 选择中两个日期之间的工作日。当我的计算给出给定日期的大多数结果正确时，我明白了（我将它与 excel 中的 NETWORKDAYS 进行比较）但有时它从 2 天到 -2 天不等 - 我不知道为什么......

这是我的代码：

```
SELECT
((to_char(CompleteDate,'J') - to_char(InstallDate,'J'))+1) - (((to_char(CompleteDate,'WW')+ (52 * ((to_char(CompleteDate,'YYYY') - to_char(InstallDate,'YYYY'))))) - to_char(InstallDate,'WW'))*2) as BusinessDays
FROM TABLE 
```

谢谢！

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-02-17T15:05:49.097

最终解决方案：

```
SELECT OrderNumber, InstallDate, CompleteDate,
  (TRUNC(CompleteDate) - TRUNC(InstallDate) ) +1 - 
  ((((TRUNC(CompleteDate,'D'))-(TRUNC(InstallDate,'D')))/7)*2) -
  (CASE WHEN TO_CHAR(InstallDate,'DY','nls_date_language=english')='SUN' THEN 1 ELSE 0 END) -
  (CASE WHEN TO_CHAR(CompleteDate,'DY','nls_date_language=english')='SAT' THEN 1 ELSE 0 END) as BusinessDays
FROM Orders
ORDER BY OrderNumber; 
```

感谢您的所有回复！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-11-14T16:24:30.383

我考虑了上面讨论的所有不同方法，并提出了一个简单的查询，它为我们提供了两个日期之间一年中每个月的工作日数：

`WITH test_data AS ( SELECT TO_DATE('01-JAN-14') AS start_date, TO_DATE('31-DEC-14') AS end_date
FROM dual ), all_dates AS (
SELECT td.start_date, td.end_date, td.start_date + LEVEL-1 as week_day FROM test_data td CONNECT BY td.start_date + LEVEL-1 <= td.end_date) SELECT TO_CHAR(week_day, 'MON'), COUNT(*)
FROM all_dates WHERE to_char(week_day, 'dy', 'nls_date_language=AMERICAN') NOT IN ('sun' , 'sat') GROUP BY TO_CHAR(week_day, 'MON');`

请随时根据需要修改查询。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-17T06:20:29.773

试试这个：

```
with holidays as 
(
select d from (
select minDate + level -1 d
 from (select min(submitDate) minDate, max (completeDate) maxDate
 from t)
 connect by level <= maxDate - mindate + 1) 
 where to_char(d, 'dy', 'nls_date_language=AMERICAN') not in ('sun' , 'sat')
)
select t.OrderNo, t.submitDate, t.completeDate, count(*) businessDays
from t join holidays h on h.d between t.submitDate and t.completeDate
group by t.OrderNo, t.submitDate, t.completeDate
order by orderno 
```

[这是一个 sqlfiddle 演示](http://www.sqlfiddle.com/#!4/5c345/2)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-15T16:17:28.323

我将示例更改为更具可读性并返回总线计数。天之间。我不知道你为什么需要'J'- Julian 格式。只需要开始/安装和结束/完成日期。使用此方法，您将获得 2 个日期之间的正确天数。用你的日期替换我的日期，如果需要，添加 NLS ......：

```
 SELECT Count(*) BusDaysBtwn
  FROM
  (
  SELECT TO_DATE('2013-02-18', 'YYYY-MM-DD') + LEVEL-1 InstallDate  -- MON or any other day 
       , TO_DATE('2013-02-25', 'YYYY-MM-DD') CompleteDate           -- MON or any other day
       , TO_CHAR(TO_DATE('2013-02-18', 'YYYY-MM-DD') + LEVEL-1, 'DY') InstallDay   -- day of week
    FROM dual 
  CONNECT BY LEVEL <= (TO_DATE('2013-02-25', 'YYYY-MM-DD') - TO_DATE('2013-02-18', 'YYYY-MM-DD')) -- end_date - start_date 
   )
   WHERE InstallDay NOT IN ('SAT', 'SUN')
  /

  SQL> 5 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-04-21T17:10:24.783

我看到标记的最终解决方案并不总是正确的。假设 InstallDate 是本月的 1 日（如果是星期六）， CompleteDate 是本月的 16 日（如果是星期日）

在这种情况下，实际工作日为 10，但标记的查询结果将给出答案为 12。所以，我们也必须处理这种类型的情况，我使用过

```
(CASE WHEN TO_CHAR(InstallDate,'DY','nls_date_language=english')='SAT' AND TO_CHAR(CompleteDate,'DY','nls_date_language=english')='SUN' THEN 2 ELSE 0 END 
```

线来处理它。

```
SELECT OrderNumber, InstallDate, CompleteDate,
(TRUNC(CompleteDate) - TRUNC(InstallDate) ) +1 - 
((((TRUNC(CompleteDate,'D'))-(TRUNC(InstallDate,'D')))/7)*2) -
(CASE WHEN TO_CHAR(InstallDate,'DY','nls_date_language=english')='SUN' THEN 1 ELSE 0 END) -
(CASE WHEN TO_CHAR(CompleteDate,'DY','nls_date_language=english')='SAT' THEN 1 ELSE 0 END) -
(CASE WHEN TO_CHAR(InstallDate,'DY','nls_date_language=english')='SAT' AND TO_CHAR(CompleteDate,'DY','nls_date_language=english')='SUN' THEN 2 ELSE 0 END)as BusinessDays
FROM Orders
ORDER BY OrderNumber; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-03-23T13:24:10.160

公认的解决方案非常接近，但在某些情况下似乎是错误的（例如，2015 年 2 月 1 日至 2015 年 2 月 28 日或 2015 年 5 月 1 日至 2015 年 5 月 31 日）。这是一个精致的版本...

```
 end_date-begin_date+1 /* total days */
  - TRUNC(2*(end_date-begin_date+1)/7) /* weekend days in whole weeks */
  - (CASE
      WHEN TO_CHAR(begin_date,'D') = 1 AND REMAINDER(end_date-begin_date+1,7) > 0 THEN 1
      WHEN TO_CHAR(begin_date,'D') = 8 - REMAINDER(end_date-begin_date+1,7) THEN 1
      WHEN TO_CHAR(begin_date,'D') > 8 - REMAINDER(end_date-begin_date+1,7) THEN 2
      ELSE 0
    END) /* weekend days in partial week */
  AS business_days 
```

处理 7 的倍数（整周）的部分很好。但是，在考虑部分周部分时，它取决于星期偏移量和部分部分中的天数，根据以下矩阵......

```
 654321
1N 111111
2M 100000
3T 210000
4W 221000
5R 222100
6F 222210
7S 222221 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-02-22T17:13:51.917

要删除星期日和星期六，您可以使用它

```
SELECT Base_DateDiff
     - (floor((Base_DateDiff + 0 + Start_WeekDay) / 7))
     - (floor((Base_DateDiff + 1 + Start_WeekDay) / 7))
FROM   (SELECT 1 + TRUNC(InstallDate) - TRUNC(InstallDate, 'IW') Start_WeekDay
             , CompleteDate - InstallDate + 1 Base_DateDiff
        FROM TABLE) a 
```

`Base_DateDiff`计算两个日期之间的天
`(floor((Base_DateDiff + 0 + Start_WeekDay) / 7))`数 计算星期日
`(floor((Base_DateDiff + 1 + Start_WeekDay) / 7))`的数量 计算星期六的数量

`1 + TRUNC(InstallDate) - TRUNC(InstallDate, 'IW')`星期一得到 1 到星期日得到 7

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-05-17T20:23:44.267

此查询可用于从给定日期向后退 N 天（仅限工作日）

例如，从 2017-05-17 后退 15 天：

```
select date_point, closest_saturday - (15 - offset + floor((15 - offset) / 6) * 2) from(
   select date_point,
          closest_saturday,
          (case
             when weekday_num > 1 then
              weekday_num - 2
             else
              0
           end) offset
    from (
           select  to_date('2017-05-17', 'yyyy-mm-dd') date_point,
                   to_date('2017-05-17', 'yyyy-mm-dd') - to_char(to_date('2017-05-17', 'yyyy-mm-dd'), 'D') closest_saturday,
                   to_char(to_date('2017-05-17', 'yyyy-mm-dd'), 'D') weekday_num
           from dual
          )) 
```

一些简短的解释：假设我们想从给定日期向后退 N 天 - 找到小于或等于给定日期的最近的星期六。- 从最近的星期六开始，向后退（N - 偏移）天。offset 是最近的星期六和给定日期（不包括给定日期）之间的工作日数。

*要从星期六返回 M 天（仅限工作日），请使用此公式 DateOfMonthOfTheSaturday - [M + Floor(M / 6) * 2]

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2013-05-07T07:52:41.877

这是一个快速灵活的功能。您可以计算日期范围内的任何工作日。

```
CREATE OR REPLACE FUNCTION wfportal.cx_count_specific_weekdays( p_week_days   VARCHAR2 DEFAULT 'MON,TUE,WED,THU,FRI'
                                                              , p_start_date  DATE
                                                              , p_end_date    DATE)
RETURN NUMBER 
IS

 /***************************************************************************************************************
  *
  * FUNCTION DESCRIPTION:
  *
  *   This function calculates the total required week days in a date range.
  *
  * PARAMETERS:
  *
  *   p_week_days   VARCHAR2  The week days that need to be counted, comma seperated e.g. MON,TUE,WED,THU,FRU,SAT,SUN 
  *   p_start_date  DATE      The start date
  *   p_end_date    DATE      The end date
  *
  * CHANGE history
  *
  * No.  Date         Changed by       Change Description
  * ---- -----------  -------------    -------------------------------------------------------------------------
  *    0 07-May-2013  yourname         Created
  *
  ***************************************************************************************************************/

   v_date_end_first_date_range    DATE;
   v_date_start_last_date_range   DATE;
   v_total_days_in_the_weeks      NUMBER;
   v_total_days_first_date_range  NUMBER;
   v_total_days_last_date_range   NUMBER;
   v_output                       NUMBER;

   v_error_text                   CX_ERROR_CODES.ERROR_MESSAGE%TYPE;

   --Count the required days in a specific date ranges by using a list of all the weekdays in that range.
   CURSOR c_total_days ( v_start_date DATE
                       , v_end_date   DATE ) IS
     SELECT COUNT(*) total_days
     FROM ( SELECT ( v_start_date + level - 1) days
            FROM dual
            CONNECT BY LEVEL <= ( v_end_date - v_start_date ) + 1
           )
     WHERE INSTR( ',' || p_week_days || ',', ',' || TO_CHAR( days, 'DY', 'NLS_DATE_LANGUAGE=english') || ',', 1 ) > 0
   ;

   --Calculate the first and last date range by retrieving the first Sunday after the start date and the last Monday before the end date. 
   --Calculate the total amount of weeks in between and multiply that with the total required days.
   CURSOR c_calculate_new_dates ( v_start_date DATE
                                , v_end_date   DATE ) IS
     SELECT date_end_first_date_range
     ,      date_start_last_date_range
     ,      ( 
              (
                ( date_start_last_date_range - ( date_end_first_date_range + 1 ) )
              ) / 7 
            ) * total_required_days   total_days_in_the_weeks  --The total amount of required days 
     FROM ( SELECT v_start_date + DECODE( TO_CHAR( v_start_date, 'DY', 'NLS_DATE_LANGUAGE=english')
                                        , 'MON', 6
                                        , 'TUE', 5
                                        , 'WED', 4
                                        , 'THU', 3
                                        , 'FRI', 2
                                        , 'SAT', 1
                                        , 'SUN', 0
                                        , 0 )   date_end_first_date_range
            ,      v_end_date - DECODE( TO_CHAR( v_end_date, 'DY', 'NLS_DATE_LANGUAGE=english')
                                      , 'MON', 0
                                      , 'TUE', 1
                                      , 'WED', 2
                                      , 'THU', 3
                                      , 'FRI', 4
                                      , 'SAT', 5
                                      , 'SUN', 6
                                      , 0 )  date_start_last_date_range
            ,      REGEXP_COUNT( p_week_days, ',' ) + 1  total_required_days  --Count the commas + 1 to get the total required weekdays
            FROM dual 
     )
     ;

BEGIN

  --Verify that the start date is before the end date
  IF p_start_date < p_end_date THEN

    --Get the new calculated days.
    OPEN c_calculate_new_dates( p_start_date, p_end_date );

      FETCH c_calculate_new_dates INTO  v_date_end_first_date_range
                                      , v_date_start_last_date_range
                                      , v_total_days_in_the_weeks;

    CLOSE c_calculate_new_dates;

    --Calculate the days in the first date range
    OPEN c_total_days( p_start_date, v_date_end_first_date_range );
      FETCH c_total_days INTO v_total_days_first_date_range;
    CLOSE c_total_days;

    --Calculate the days in the last date range
    OPEN c_total_days( v_date_start_last_date_range, p_end_date );
      FETCH c_total_days INTO v_total_days_last_date_range;
    CLOSE c_total_days;

    --Sum the total required days
    v_output := v_total_days_first_date_range + v_total_days_last_date_range + v_total_days_in_the_weeks;

  ELSE

     v_output := 0;

  END IF;

  RETURN v_output;

  EXCEPTION

    WHEN OTHERS
    THEN

    RETURN NULL;

END cx_count_specific_weekdays;
/ 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2013-08-21T14:55:03.963

干得好...

1.  首先检查您在假期表中有多少天，不包括周末。
2.  获取两个日期之间的工作日（周一至周五），然后减去假期。

    ```
    create or replace
    FUNCTION calculate_business_days (p_start_date IN DATE, p_end_date IN DATE)
            RETURN NUMBER IS
            v_holidays     NUMBER;
            v_start_date   DATE   := TRUNC (p_start_date);
            v_end_date     DATE   := TRUNC (p_end_date);
            BEGIN
            IF v_end_date >= v_start_date
            THEN
                    SELECT COUNT (*)
                    INTO v_holidays
                    FROM holidays
                    WHERE day BETWEEN v_start_date AND v_end_date
                    AND day NOT IN (
                            SELECT hol.day 
                            FROM holidays hol 
                            WHERE MOD(TO_CHAR(hol.day, 'J'), 7) + 1 IN (6, 7)
                    );

            RETURN   GREATEST (NEXT_DAY (v_start_date, 'MON') - v_start_date - 2, 0)
                 +   (  (  NEXT_DAY (v_end_date, 'MON')
                         - NEXT_DAY (v_start_date, 'MON')
                        )
                      / 7
                     )
                   * 5
                 - GREATEST (NEXT_DAY (v_end_date, 'MON') - v_end_date - 3, 0)
                 - v_holidays;
            ELSE
                    RETURN NULL;
            END IF;
    END calculate_business_days; 
    ```

之后，您可以对其进行测试，例如：

```
 select 
            calculate_business_days('21-AUG-2013','28-AUG-2013') as business_days 
    from dual; 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2013-09-12T15:25:18.550

还有另一种更简单的方法，使用 connect by 和 dual ...

```
with t as (select to_date('30-sep-2013') end_date, trunc(sysdate) start_date from dual)select count(1) from dual, t where to_char(t.start_date  + level, 'D') not in (1,7) connect by t.start_date + level <= t.end_date; 
```

通过连接，您可以获得从 start_date 到 end_date 的所有日期。然后你可以排除你不需要的日期，只计算需要的日期。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2018-03-05T17:26:49.593

这将返回工作日：

```
(CompleteDate-InstallDate)-2*FLOOR((CompleteDate-InstallDate)/7)-
  DECODE(SIGN(TO_CHAR(CompleteDate,'D')-
    TO_CHAR(InstallDate,'D')),-1,2,0)+DECODE(TO_CHAR(CompleteDate,'D'),7,1,0)-
    DECODE(TO_CHAR(InstallDate,'D'),7,1,0) as BusinessDays, 
```

# asp.net-mvc - 带区域的 Url.Action() 返回空字符串

> ID：14898362
> 
> 赞同：15
> 
> 时间：2013-02-15T15:51:36.417
> 
> 标签：asp.net-mvc

我在 MVC 4 中使用 Razor。我正在尝试将 URL 从一个区域中的视图创建到另一个区域中的控制器操作。以下返回一个空字符串：

```
 @Url.Action("Action", "MyController", new { area = "OtherArea" }) 
```

我已经用其他选项做了一些测试，下面返回一个 URL，但它是错误的：

```
 @Url.Action("Action", "MyController", new { parameter = 1 }) 
```

生成的 URL 为 /App/IncorrectArea/My/Action?parameter=1。注意不正确的区域；Url.Action 假设（因为我没有通过一个区域）控制器居住在它没有的当前区域！

有任何想法吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-15T16:02:33.377

发现我的问题。我更改了区域名称，但未能更新区域注册中的 AreaName 属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-02-14T16:03:44.500

我遇到了同样的问题，因为我将`RegisterRoutes`方法从`{controller}/{action}/{id}`更改`{action}/{id}`为仅从 URL 发出控制器名称

# r - 在R中的循环之后使用索引命名矩阵

> ID：14898370
> 
> 赞同：2
> 
> 时间：2013-02-15T15:52:14.013
> 
> 标签：r, matrix

请原谅我的幼稚问题。

我有一个循环，每一步都返回一个 matrix `b`。我想根据迭代次数以不同的名称保存每个循环中的每个矩阵。例如，在第一次迭代结束时，我想得到名为的矩阵`b1`，在第二次迭代结束时，`b2`等等......

例如，让我们使用以下代码：

```
count=0
a=matrix(c(1,2,3,4,5,6,7,8,9,10,11,12), nrow=6)
for (count in 1:10)  {
  b<-cbind(a[,1],matrix(c( a[sample(nrow(a)),2]), nrow=nrow(a)) ) 
  print(b)
}
count+1 
```

在这里，原始矩阵是`matrix a`具有`6`行和`2`列的。我排列了第二列中元素的顺序。结果`matrix b`, 是包含原始的第一列的第一列`matrix a`和第二列的排列的第二列的矩阵`a`。

谁能帮我？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T16:00:35.550

您真的不想将它们存储为单独的变量 - 将它们保留为 10 个矩阵的列表会更好。这可以很容易地使用`replicate`：

```
lst = replicate(10, cbind(a[,1],matrix(c( a[sample(nrow(a)),2]), nrow=nrow(a)) ),
          simplify=FALSE) 
```

然后，您可以访问 10 个矩阵中的任何一个，如下所示：

```
lst[[1]]
#     [,1] [,2]
#[1,]    1    7
#[2,]    2   10
#[3,]    3   11
#[4,]    4    8
#[5,]    5    9
#[6,]    6   12 
```

同样，您可以像这样遍历它们：

```
for (m in lst) {
    print(m)
    # do something with your matrix m
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T16:40:25.990

正如在其他选项中所说，最好使用列表。这是一个`sapply`用于获得漂亮命名结果的版本：

```
 res <- sapply(paste('b',1:10,sep=''), 
           function(x) cbind(a[,1],matrix(c( a[sample(nrow(a)),2]), nrow=nrow(a)) ),
       simplify=F) 
```

然后以获取矩阵`b5`为例，

```
res$b5

   [,1] [,2]
[1,]    1    9
[2,]    2    7
[3,]    3    8
[4,]    4   11
[5,]    5   10
[6,]    6   12 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-15T16:04:29.307

如前所述，列表是一个更好的选择。但是，如果您仍想将每个交互保存在不同的变量上，您可以使用`assign()`

```
count=0
a=matrix(c(1,2,3,4,5,6,7,8,9,10,11,12), nrow=6)
for (count in 1:10)  {
  assign(paste('b',count,sep=''),cbind(a[,1],matrix(c( a[sample(nrow(a)),2]), nrow=nrow(a))))
}
b1
b2 
```

# javascript - 包含括号的变量会导致问题

> ID：14898371
> 
> 赞同：0
> 
> 时间：2013-02-15T15:52:17.087
> 
> 标签：javascript, html

简单的东西：我在单击按钮并将其写入文本字段时读取了选择框的值：

选择框：

```
<select name="link[link_category]">
  <option value="Fun">Sport</option>
  <option value="Music">Music</option>
</select> 
```

现在我有我的按钮

```
<button class="btn btn-success" onclick="myFunction()">Continue</button> 
```

触发一个简单的功能

```
<script>
function myFunction()
{
  result = document.new_link.link[link_category].value;
  document.getElementById("demo").innerHTML=result;
}
</script> 
```

result 从选择框中读取值，函数在名为“demo”的字段中输出值

```
<p id="demo"></p> 
```

我的问题：

为 Box 使用一个简单的名称，如“abc”，让一切都像魅力一样工作。但是一旦使用括号（我的rails应用程序需要括号才能工作），它就会说

*未捕获的引用错误：未定义链接类别*

如何使用括号来处理我的 JS 函数？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T15:54:35.667

您将需要使用括号符号来访问它

```
result = document.new_link['link[link_category]'].value; 
```

# selenium - 使用 Robot Framework 执行 selenium 示例时发生错误

> ID：14898372
> 
> 赞同：3
> 
> 时间：2013-02-15T15:52:18.770
> 
> 标签：selenium, python-2.7, selenium-webdriver, robotframework

在我的系统上，我有 Python 2.6 和 Robot 框架。我已经按照以下链接的说明安装了 Selenium2Library： [https](https://github.com/rtomac/robotframework-selenium2library) ://github.com/rtomac/robotframework-selenium2library 但是当我尝试运行该示例时，它给了我以下错误并且没有打开 firefox 窗口。

```
ERROR:  clean-python26-env]$ python testExeJS.py 
======================================================================
ERROR: test_exe_javascript (__main__.ExecuteJavascriptTestCase)
----------------------------------------------------------------------

Traceback (most recent call last):
  File "testExeJS.py", line 7, in setUp
    selenium.setTimeout("60000")
NameError: global name 'selenium' is not defined

----------------------------------------------------------------------
Ran 1 test in 0.000s

FAILED (errors=1) 
```

任何帮助真的很感激

# 编辑

对不起，我才看到你的回复。可能这将帮助您更多地了解我的问题。示例代码链接为：` [http://www.wallix.org/2011/07/26/how-to-use-robotframework-with-the-selenium-library/](http://www.wallix.org/2011/07/26/how-to-use-robotframework-with-the-selenium-library/)

我的运行错误是：

```
$ pybot myFirstTest.txt 

==============================================================================
myFirstTest :: This is your first test                                        
==============================================================================
[ WARN ] Keyword 'Capture Page Screenshot' could not be run on failure: No browser is open
Go To Google Page [Documentation] Go to google page and search som... | FAIL |
WebDriverException: Message: 'The browser appears to have exited before we could connect. The output was: Error: no display specified\n'
------------------------------------------------------------------------------
[ WARN ] Keyword 'Capture Page Screenshot' could not be run on failure: No browser is open
Open Selenium Page [Documentation] TestCase for open Selenium page    | FAIL |
No browser is open
------------------------------------------------------------------------------
myFirstTest :: This is your first test                                | FAIL |
2 critical tests, 0 passed, 2 failed
2 tests total, 0 passed, 2 failed
==============================================================================
Output:  /data/home/sadikhan/ironport/Selenium/output.xml
Log:     /data/home/sadikhan/ironport/Selenium/log.html
Report:  /data/home/sadikhan/ironport/Selenium/report.html 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T10:44:36.620

好的，所以在这里我要对日志进行注释，以便您将来可以看到如何读取它并从中进行调试。对于任何不准确之处，我深表歉意，因为我已经习惯了 Selenium2Library：

```
$ pybot myFirstTest.txt 
==============================================================================
myFirstTest :: This is your first test                                        
==============================================================================
[ WARN ] Keyword 'Capture Page Screenshot' could not be run on failure: No browser is open 
```

好的，这是您的第一个线索 - selenium 正在尝试截取屏幕截图，但没有看到打开的浏览器 - 您看到浏览器打开了吗？它是否打开到正确的页面？

```
Go To Google Page [Documentation] Go to google page and search som... | FAIL |
WebDriverException: Message: 'The browser appears to have exited before we could connect. The output was: Error: no display specified\n' 
```

所以这是下一条线索 -`The browser appears to have exited before we could connect. The output was: Error: no display specified`所以这表明问题是你正在无头运行，而 SeleniumLibrary 期望找到一个显示（如果我错了，请纠正我）所以你可能需要创建一个，这相当容易比听起来可能 - 你会想要安装[PyVirtualDisplay](https://pypi.python.org/pypi/PyVirtualDisplay)然后从机器人框架 -`| Library | pyvirtualdisplay.smartdisplay.SmartDisplay |`在使用 SeleniumLibrary 之前尝试使用。

```
------------------------------------------------------------------------------
[ WARN ] Keyword 'Capture Page Screenshot' could not be run on failure: No browser is open 
```

这又是第一个线索。

```
Open Selenium Page [Documentation] TestCase for open Selenium page    | FAIL |
No browser is open 
```

这是因为早期的问题。

```
------------------------------------------------------------------------------
myFirstTest :: This is your first test                                | FAIL |
2 critical tests, 0 passed, 2 failed
2 tests total, 0 passed, 2 failed
==============================================================================
Output:  /data/home/sadikhan/ironport/Selenium/output.xml
Log:     /data/home/sadikhan/ironport/Selenium/log.html
Report:  /data/home/sadikhan/ironport/Selenium/report.html 
```

# c# - 如何检测启用触摸的设备（Win 8，C#.NET）

> ID：14898376
> 
> 赞同：0
> 
> 时间：2013-02-15T15:52:22.313
> 
> 标签：c#, windows-8, touch

在 MS Surface Win8 Pro 上运行时，某些触摸功能在我的应用程序中无法正常工作。仅当字体 DPI 设置为 150%（不幸的是默认值）时。如果用户在支持触摸的设备上在 Win8 中运行我的应用程序以更改其 dpi 设置以获得更好的体验，我想向用户显示一条消息。我知道如何检查操作系统版本和 dpi 设置，但正在寻找一种方法来检查是否存在启用触摸的设备，因此我不必为在其他平台/设备上运行此消息的用户显示此消息。我的应用程序在 C#.Net 4.5 中。

这不是 Windows 8 应用程序。这是一个可以在Vista/7/8 上运行的winform。我没有看到其他帖子中建议的 Windows.Devices.Input 命名空间？

# python - 防止 SQLAlchemy 对过期对象重新运行查询的正确方法？

> ID：14898379
> 
> 赞同：3
> 
> 时间：2013-02-15T15:52:36.677
> 
> 标签：python, sqlalchemy, flask, flask-sqlalchemy

我在思考如何处理烧瓶请求中过期的 sqlalchemy 对象时遇到了麻烦。假设我执行以下操作：

```
from models import Foo, Bar

@app.route("/page")
def page():
  foos = Foo.query.all()

  for foo in foos:
    b = Bar(foo.data)
    db.session.add(b)

  db.session.commit()

  return render_template('page.html', foos=foos) 
```

然后在`page.html`：

```
{% for foo in foos %}
  {{ foo. name }}
{% endfor %} 
```

SQLAlchemy 然后将为模板循环中的每个 foo 执行选择查询，因为将集合`session.commit()`标记为已过期。`foos`如果我知道`foos`实际上无法更改，那么阻止`len(foos)`执行查询的正确方法是什么？同样，如果`foos` *发生*了变化，使用单个查询而不是多次查询来刷新数据的正确方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-15T16:50:42.250

如果您知道 foos 无法更新，为什么还要发布`db.session.commit()`呢？如果有时是这样，那么只有在某些内容已更新时才会在其中添加一些逻辑来触发提交。

您可以`foos = Foo.query.all()`在该行下方添加一个`db.session.commit()`。这将只对所有数据触发一个查询，而不是每行一个。

正如您所说，提交数据会将其设置为过期，因此需要重新查询它们。也许您可以刷新会话而不是重新查询，有关[SQLAlchemy 文档中的](http://docs.sqlalchemy.org/en/latest/orm/session.html#refreshing-expiring)更多信息似乎表明您可以这样做`session.refresh(object)`。

## 更新：使用两个会话

您可以使用第二个会话，您将使用它来查询`Foo`，然后另一个会话来处理`Bars`. 当您提交时，这将使 foos 保持不变，因此您不必再次点击它。

这是一个粗略的例子：

```
from flask.ext.sqlalchemy import Session

@app.route('/example/')
def home():
    session_two = Session(bind=db.engine.connect())
    foos = session_two.query(Foo).all()

    for foo in foos:
        db.session.add(Bar(foo))
    db.session.commit()

    return render_template_string('''
        {% for foo in foos %}
            {{ foo.name }}
        {% endfor %}
    ''', foos=foos) 
```

`expire_on_commit=False` [另外，我想知道您是否可以通过文档](http://docs.sqlalchemy.org/en/latest/orm/session.html#committing)中配置的单个会话来处理它：

> “commit() 的另一个行为是，默认情况下，它会在提交完成后使存在的所有实例的状态过期。这是为了在下次访问实例时，通过属性访问或它们存在于查询结果集中, 他们收到最新的状态。要禁用此行为，请将 sessionmaker 配置为 expire_on_commit=False"

## 使用 Session.expunge

根据需要从会话中删除对象

```
@app.route('/')
def home():
    foos = Foo.query.all()
    for foo in foos:
        db.session.add(Bar(foo))
        db.session.expunge(foo)
    db.session.commit()

    return render_template_string('''
        {% for foo in foos %}
            {{ foo.name }}
        {% endfor %}
    ''', foos=foos) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T22:36:16.223

我有一个稍微不同的方法，我不推荐 99% 的情况。（但无论如何我都会分享）

我对通过 SqlAlchemy 获取的数据进行积极缓存。为了假装实时 SqlAlchemy 对象和缓存数据之间的级别奇偶校验，我执行以下操作（参考[https://gist.github.com/jvanasco/01af92e100769d52f7b8](https://gist.github.com/jvanasco/01af92e100769d52f7b8)）

*   当数据进入缓存时，我将其转换为原始字典（即，删除所有 sqlalchemy 信息。我只想要表的信息）

*   当我从缓存中提取数据时，我将其转换为“ObjectifiedDict”。这是一个简单地提供基于点的属性访问的字典——就像 SqlAlchemy 对象一样。

*   从缓存中提取数据的例程也可以将属性指定为延迟加载函数（这是在我从缓存中拉出数据时编写的）。这样，我可以将“用户帐户”对象的照片属性关联为将特定照片从缓存中拉出的函数。

使用这种方法，我的只读部分使用与应用程序的可写部分相同的模板——唯一的区别是，如果您查看视图，一个部分上的对象是 dicts 的版本，而其他部分是实际的 SqlAlchemy .

对于 99% 的情况，我不建议这样做。但是在 1% 的情况下，当您尝试将缓存数据持久化时，我发现这是最好的解决方案。

# asp.net-mvc - Google 在我的 mvc 中找不到任何页面

> ID：14898382
> 
> 赞同：0
> 
> 时间：2013-02-15T15:52:39.703
> 
> 标签：asp.net-mvc, googlebot

嗨，我有一个刚刚与谷歌合作的主页。当我在谷歌搜索框“site: [http://www.nameofmysite.com](http://www.nameofmysite.com) ”中输入以下内容时，我得到 Page not found。Google 无法为我的整个网站中的单个页面编制索引。我的网站上有很多页面。

但是，如果您只是浏览我的网站，它看起来不错，一切运行良好。我有一个 MVC 3 站点，我已将其设为多语言，并且语言参数 en、sv、es 等反映在 url 中，例如 www.nameofmysite.com/en/ContactMail

我没有发布任何代码，因为我不知道问题出在代码还是其他原因上。如果有人想让我发布代码，请告诉我。

希望有人可以对此有所了解。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T06:43:52.250

我的问题已在另一个线程中得到解答。 [国际版 NerdDinner](https://stackoverflow.com/questions/14908429/international-version-of-nerddinner)

问题是，在我的 basecontroller 和 global.asax 文件中，如果由 google bot 获取，我有一些返回空值的代码。

# ios - GPUImage背景减法iOS

> ID：14898387
> 
> 赞同：4
> 
> 时间：2013-02-15T15:53:01.013
> 
> 标签：ios, gpuimage

我开始使用`startCameraCapture`并使用`setFrameProcessingCompletionBlock`拍摄相机`GPUImageOutput`（我的背景图像）。现在我希望每一帧都从其他捕获的帧中减去我的背景图像。

我怎样才能做到这一点？谢谢

# android - 带有 SherlockListFragment 的 CustomAdapter

> ID：14898389
> 
> 赞同：0
> 
> 时间：2013-02-15T15:53:09.763
> 
> 标签：android, android-listfragment

我正在尝试通过使用 SherlockFragmentActivity、SherlockListFragment 和 CustomAdapter（*扩展 ArraAdapter*）来为 SherlockListFragment 实现自定义行我有 3 个主要布局文件

**主要的.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <!-- This FrameLayout will be the PlaceHolder of the Fragments. -->
    <FrameLayout android:id="@+id/fragment_container"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent" />
</LinearLayout> 
```

**list_layout.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
         android:orientation="vertical"
         android:layout_width="match_parent"
         android:layout_height="match_parent"
         android:paddingLeft="8dp"
         android:paddingRight="8dp">
    <ListView
        android:id="@android:id/list"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"/>

    <TextView android:id="@android:id/empty"
              android:layout_width="match_parent"
              android:layout_height="match_parent"
              android:background="#FF0000"
              android:text="No data"/>
</LinearLayout> 
```

最后是我的行

**list_row_layout.xml**

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal">

    <Button
        android:id="@+id/list_row_button_fav"
        android:layout_width="32dp"
        android:layout_height="32dp"
        android:padding="8dp"
        android:src="@drawable/fav_star_icon">
    </Button>
    <TextView
        android:id="@+id/list_row_text_dist_value"
        android:layout_width="wrap_content"
        android:layout_height="32dp"
        android:text=".2"/>
</LinearLayout> 
```

我在 getView 方法的自定义适配器中收到 NullPointerException，我不确定为什么会发生这种情况？我的 getView 伪代码如下..

```
private Context mContext;
    private LayoutInflater mInflater;
    private final List<Model> myData;

    public MyListAdapter(Context context, int textViewResourceId, List<Model> data){
        super(context, R.layout.list_layout, data);
        mContext = context;
        this.myData = data;
    }

        @Override
        public View getView(int position, View convertView, ViewGroup parent) {
            View view = convertView;

            if(view == null){
                mInflater = (LayoutInflater)mContext.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
                view = mInflater.inflate(R.layout.list_row_layout, parent, false);
            }
                // find button and text views by Id and set them accordingly, yadda, yadda...
               return view;
        } 
```

堆栈跟踪：

```
02-15 10:58:36.384: E/AndroidRuntime(16734): FATAL EXCEPTION: main
02-15 10:58:36.384: E/AndroidRuntime(16734): java.lang.NullPointerException
02-15 10:58:36.384: E/AndroidRuntime(16734):    at com.app.test.MyListAdapter.getView(MyListAdapter.java:41)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at android.widget.AbsListView.obtainView(AbsListView.java:2159)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at android.widget.ListView.measureHeightOfChildren(ListView.java:1246)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at android.widget.ListView.onMeasure(ListView.java:1158)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at android.view.View.measure(View.java:15513)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:4827)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at android.widget.LinearLayout.measureChildBeforeLayout(LinearLayout.java:1404)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at android.widget.LinearLayout.measureVertical(LinearLayout.java:695)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at android.widget.LinearLayout.onMeasure(LinearLayout.java:588)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at android.view.View.measure(View.java:15513)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:4827)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at android.widget.FrameLayout.onMeasure(FrameLayout.java:310)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at android.view.View.measure(View.java:15513)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:4827)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at android.widget.FrameLayout.onMeasure(FrameLayout.java:310)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at android.view.View.measure(View.java:15513)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:4827)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at android.widget.LinearLayout.measureChildBeforeLayout(LinearLayout.java:1404)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at android.widget.LinearLayout.measureVertical(LinearLayout.java:695)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at android.widget.LinearLayout.onMeasure(LinearLayout.java:588)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at android.view.View.measure(View.java:15513)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:4827)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at android.widget.FrameLayout.onMeasure(FrameLayout.java:310)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at android.view.View.measure(View.java:15513)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at android.widget.LinearLayout.measureVertical(LinearLayout.java:847)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at android.widget.LinearLayout.onMeasure(LinearLayout.java:588)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at android.view.View.measure(View.java:15513)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:4827)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at android.widget.FrameLayout.onMeasure(FrameLayout.java:310)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at com.android.internal.policy.impl.PhoneWindow$DecorView.onMeasure(PhoneWindow.java:2176)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at android.view.View.measure(View.java:15513)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at android.view.ViewRootImpl.performMeasure(ViewRootImpl.java:1874)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at android.view.ViewRootImpl.measureHierarchy(ViewRootImpl.java:1089)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at android.view.ViewRootImpl.performTraversals(ViewRootImpl.java:1265)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at android.view.ViewRootImpl.doTraversal(ViewRootImpl.java:989)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at android.view.ViewRootImpl$TraversalRunnable.run(ViewRootImpl.java:4351)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at android.view.Choreographer$CallbackRecord.run(Choreographer.java:749)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at android.view.Choreographer.doCallbacks(Choreographer.java:562)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at android.view.Choreographer.doFrame(Choreographer.java:532)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at android.view.Choreographer$FrameDisplayEventReceiver.run(Choreographer.java:735)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at android.os.Handler.handleCallback(Handler.java:725)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at android.os.Handler.dispatchMessage(Handler.java:92)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at android.os.Looper.loop(Looper.java:137)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at android.app.ActivityThread.main(ActivityThread.java:5039)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at java.lang.reflect.Method.invokeNative(Native Method)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at java.lang.reflect.Method.invoke(Method.java:511)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
02-15 10:58:36.384: E/AndroidRuntime(16734):    at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T15:54:45.077

如果您收到 NullPointerException ，`getView()`则此行看起来像罪魁祸首：

```
LayoutInflater mInflater = (LayoutInflater)mContext.getSystemService(Context.LAYOUT_INFLATER_SERVICE); 
```

我猜你忘了初始化`mContext`......而且你只需要一个 LayoutInflater 以便你可以`mInflater`在适配器的构造函数中创建。

# c++ - C++ Builder - Lib 和 Res 的区别

> ID：14898393
> 
> 赞同：3
> 
> 时间：2013-02-15T15:53:15.180
> 
> 标签：c++, compiler-construction, c++builder

如果我的理解是正确的： * 类编译成 obj 文件。* 库是 obj 文件的集合。

什么是 .res 文件？它们像库，还是有区别？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T15:56:15.910

.res 文件是已编译的 Windows 资源（就像 .obj 是已编译的 C++ 源代码一样）。它们包含位图、图标等。

特别是，C++Builder IDE 将自动维护一个 .res 文件，其中包含您在项目 -> 选项 -> 应用程序和项目 -> 选项 -> 版本信息下设置的应用程序图标和版本信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T15:58:18.250

.res 文件是编译的资源脚本 (.rc) 可以编辑：[http ://www.resedit.net/](http://www.resedit.net/)

**有关资源脚本的更多信息：** [http ://en.wikibooks.org/wiki/Windows_Programming/Resource_Scripts](http://en.wikibooks.org/wiki/Windows_Programming/Resource_Scripts)

> 以下是常用资源列表：
> 
> 下拉菜单
> 
> 弹出菜单
> 
> 文本字符串
> 
> 键盘加速器（按键组合，例如 [Ctrl]+[C] 复制文本）
> 
> 图标
> 
> 位图图像
> 
> 对话框
> 
> 版本信息
> 
> 鼠标光标

**如何编写资源脚本： http:** [//mirrors.zoreil.com/webclub.kcom.ne.jp/ma/colinp/win32/resources/script.html](http://mirrors.zoreil.com/webclub.kcom.ne.jp/ma/colinp/win32/resources/script.html)

# c# - 对字典泛型进行排序

> ID：14898401
> 
> 赞同：0
> 
> 时间：2013-02-15T15:53:25.897
> 
> 标签：c#, idictionary

我需要知道是否有任何方法可以在不知道它到底是什么类型的情况下订购 IDictionary ...

例如，我有一个接收对象的方法，其中我有一个 Dictionary 对象......我所知道的是它是一个 Dictionary 所以我可以这样做：

```
public void MyMethod(PropertyInfo propriedadeParametro, object parameters){
   IDictionary dictionary = ((IDictionary) propriedadeParametro.GetValue (parameters, null));
} 
```

但需要按 EnumPersonalizado 对本词典的项目进行排序，而不管其他类型“某事”是什么？拥有

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T16:21:57.197

你不能对字典进行排序。根据定义，字典没有其中项目的“顺序”。这些项目存储在某种超出您控制范围的机制中，旨在使其尽可能高效地添加、删除和搜索。

您能做的最好的事情就是从字典中取出所有项目，将它们放入其他类型的集合中，然后对其进行排序。

至于您的特定情况，我们不清楚字典中的键或值的类型是什么，并且需要知道这些类型才能尝试对数据进行排序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T16:22:45.730

看到这个[问题](https://stackoverflow.com/questions/2552928/changing-the-order-in-a-net-generic-dictionary)。字典本身没有索引顺序。考虑改为从 KeyedCollection 类继承。它是字典和普通列表的合并，它旨在使用您的项目成员作为键，并具有索引顺序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-06-13T17:58:14.223

有很多合理的理由希望基于键对字典应用部分排序，键无序并不是基本质量，只是给定键会产生给定值。

话虽如此，如果您发现自己使用的是非泛型`IDictionary`，那么在不了解密钥类型的情况下按密钥“排序”实际上会很麻烦。在我的特定场景中，我想要一个函数，它将一个 IDictionary 转换为另一个 IDictionary，其中条目可以通过有序键枚举。

```
IDictionary ToSortedDictionary(IDictionary dictionary) {
    return new SortedList(dictionary);
} 
```

这将构造一个新的字典实例，以便遍历 ( `foreach`) 将根据键的排序顺序访问条目。

奇怪命名的[SortedList](http://msdn.microsoft.com/en-us/library/System.Collections.SortedList.aspx)可以在`System.Collections`使用`ÌComparable`接口的排序键中找到。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-02-15T16:11:48.053

IDictionary 是 IEnumerable，因此您可以尝试执行类似的操作`new ArrayList(dictionary).Sort()`，但它会尝试将成员强制转换为 IComparable，或者您可以使用接受 IComparer 对象的排序重载。另一种方法是使用反射——首先找到实际的键/值类型，然后创建对通用 OrderBy 的调用。

# css - Scroolbars 在 IE 7 中不应该显示，为什么？

> ID：14898415
> 
> 赞同：0
> 
> 时间：2013-02-15T15:54:22.493
> 
> 标签：css, positioning

我已经设置了一个 div 的样式，其中包含的内容可能会以下列方式在高度和宽度上有所不同：

```
div.myDiv {
   display:inline-block;
   *display:inline;/* For IE7*/
   *zoom:1;/* For IE7*/
   white-space:normal;
   vertical-align:top; max-width:280px; overflow:auto; 
} 
```

目的是限制元素扩展超过 280 像素，并让内容垂直增长，因为我有一个溢出：容器元素上的自动。这适用于除 IE7 之外的所有浏览器。我不确定偏移量是否与这个问题有关？

![在此处输入图像描述](../Images/000d963a6a70c3d8fa92c908babc3286.png)

编辑：[这是](http://jsfiddle.net/krul/pBdaX/)我设置 jsfiddle 来演示我的场景的地方，但我什至无法使用 IE9 查看 jsfiddle（在 IE 7 模式下运行）。希望这将有助于理解我面临的问题。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T16:52:39.913

尝试设置`overflow:hidden`：

```
div.myDiv {
   display:inline-block;
   *display:inline;/* For IE7*/
   *zoom:1;/* For IE7*/
   white-space:normal;
   vertical-align:top; max-width:280px; overflow:auto; 

   /*This line should hide the scrollbar*/

   *overflow:hidden;
} 
```

# excel - 使用 Coldfusion 导入 Excel - 接收奇怪的日期格式 mm\/dd\/yyyy

> ID：14898416
> 
> 赞同：2
> 
> 时间：2013-02-15T15:54:26.630
> 
> 标签：excel, coldfusion, coldfusion-9

我正在使用 ColdFusion 9 从 Excel (2007, xls) 电子表格中导入数据。正在导入的列之一是日期字段。在大多数情况下，日期很好，但在某些情况下，日期格式似乎发生了一些奇怪的事情。它是`mm\/dd\/yyyy`. 我不知道添加那些额外`\`的 's 是什么。具体错误很明显：

```
"11\/15\/2012 is an invalid date or time string." 
```

直接查看电子表格和单元格本身，日期的格式正确显示为`mm/dd/yyyy`.

有谁知道这可能是什么原因造成的？

**跟进**

感谢您提供有用的答案。最后，最好的解决方案来自 CoderSeven。我曾经`Replace(dateString, '\', '', 'all')`删除有问题的斜线并处理数据。这被证明是最好的解决方案，因为我正在处理可能来自成千上万个人的电子表格，虽然我控制他们使用的电子表格的格式，但我无法控制他们是否将数据键入或剪切并粘贴到字段中。最终我很想知道那个额外的斜线是从哪里来的，但是这个解决方案效果很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T23:29:03.563

这并不是关于为什么会发生这种情况的真正答案，但它是一种解决方法。

只需使用`Replace(yourdate, '\', '')`.

就个人而言，我倾向于采取以下立场：

如果 MS 产品做了一些奇怪的事情，最好的解决方案是确保您能够处理这种奇怪，而不是试图找出这种奇怪的来源。

并不是说 MS 产品不好，它通常会为您节省大量时间和精力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T16:56:36.863

“11\/15\/2012 是无效的日期或时间字符串。” 一个问题可能是电子表格上的日期不是字符串，它们是 Excel 时间值——基本上是整数。也许使用以下方法将这些单元格转换为文本格式： =TEXT(C7,"mm/dd/yyyy")

可能会解决问题。为了安全起见，我也会将格式更改为文本。祝你好运。

# javascript - 如何制作 scrollTo +numberofpixels 而不是依赖于锚点？

> ID：14898420
> 
> 赞同：0
> 
> 时间：2013-02-15T15:54:40.880
> 
> 标签：javascript, jquery, html, scroll, scrollto

我正在尝试在水平导航（类似幻灯片）上创建下一个/上一个滚动到，并且找不到任何关于如何滚动到不涉及锚点的文章。

我该如何做到这一点，以便每次点击 Next - scrollTo 移动一定数量的像素而不是锚点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T15:56:37.897

您将为此使用[scrollLeft()](http://api.jquery.com/scrollLeft/)：

```
$('#next').on('click', function() {
    var scroll = $('body').scrollLeft();
    $('body').animate({ scrollLeft : scroll + 400 });
}); 
```

# java - 如何在 Java 中格式化 UDP 数据包？

> ID：14898423
> 
> 赞同：0
> 
> 时间：2013-02-15T15:54:52.623
> 
> 标签：java, udp, format

我需要使用 UDP 向 IP 地址发送一些数据。我不知道如何格式化我的字符串。我需要发送多个数据包吗？

从开发人员页面我只得到以下信息： ![在此处输入图像描述](../Images/f92a00bd3762d5f8cc04006a53d9f961.png)

我应该做些什么？在右侧部分是我需要发送的字符串。

谁能解释一下“挑战”是什么意思？

从开发者网站：

*游戏服务器初始化后不久，它会选择两个主服务器“加入”。为了让客户在单击“Internet”选项卡时看到特定的游戏服务器，游戏服务器必须存在于 Steam 主服务器的记录中。游戏服务器向每个主服务器发送“q”(71)。每个主服务器通过发送 FF FF FF FF 73 0A 后跟（相对）唯一的 4 字节“挑战”号来响应。如果您向主服务器发送无效质询，您将收到另一个质询作为响应。*

这是什么意思？

> FF FF FF FF 73 0A

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-16T12:25:19.000

正如我在评论中所写，您需要发送字节，而不是真正的字符串。因此，您必须确定服务器是否使用 ascii 编码或不同的编码，然后以正确的编码获取字符串的字节。

当文档谈到“发送 FF 73 ...”时，它意味着发送字节。它是一个以 16 为底的数字 (="Hexadecimal")。例如，创建一个字节“FF”，如下所示：

```
byte b = 0xFF; // Hex for 255 
```

当文档谈到发送“q（71）”时，它意味着发送一个字节（0x71），它在ascii中编码字母“q”。

关于“挑战”，请阅读[Wikipedia](http://en.wikipedia.org/wiki/Challenge%E2%80%93response_authentication)并更深入地咨询开发人员文档。我相信他们会在这件事上说得更多。

关于在 Java 中使用 UDP，您可以参考[oracle 中的许多示例和教程](http://docs.oracle.com/javase/tutorial/networking/datagrams/index.html)。

# symfony - Symfony2 Production CSS/JS 包括抛出 404（可能是父问题）

> ID：14898428
> 
> 赞同：0
> 
> 时间：2013-02-15T15:54:58.397
> 
> 标签：symfony, twig, development-environment, production-environment, assetic

我正在编写一个 Bundle 来为我们正在开发的网站提供主题。其他捆绑包调用核心捆绑包以通过 Twig 进行模板化，而这个主题捆绑包会扭曲该核心捆绑包。

我通过在主题包类中实现 getParent() 方法以返回核心包的名称来完成此操作，从而导致 Symfony2 在查看核心包之前先查看主题包（基本上是任何文件）。

现在，这在开发模式下效果很好，但是，当我尝试在生产模式下，并且我的 CSS/JS 文件合并为一个时，生成的路径解析为 404 页面，并且所有样式都丢失了。

我已经清除了 dev 和 production 缓存，以及`rm -rf`dev 和 prod 目录。调用`php app/console assetic:dump --env=prod --no-debug`返回：

```
$ php app/console assetic:dump --env=prod --no-debug
Dumping all prod assets.
Debug mode is off.

10:25:40 [file+] /webapps/xxxbundle/app/../web/css/f996955.css
10:25:46 [file+] /webapps/xxxbundle/app/../web/js/f307b3f.js
10:26:05 [file+] /webapps/xxxbundle/app/../web/css/55d26a0.css
10:26:05 [file+] /webapps/xxxbundle/app/../web/js/ccfc30e.js

  [RuntimeException]
  The source file "/webapps/xxxclient/app/../web/bundles/xxxbundle/js/modernizer.custom.96376.js"
  does not exist.

assetic:dump [--watch] [--force] [--period="..."] [write_to] 
```

面向 web 的 css 和 js 目录显示：

```
$ ls web/css
55d26a0.css  f996955.css
$ ls web/js
f307b3f.js 
```

缺少 JS 文件可能是由于另一个未使用的捆绑包。主要问题是，模板正在寻找：

```
<link rel="stylesheet" type="text/css" media="screen" href="/css/2a6fc23.css">
<script src="/js/adf6a7a.js"></script> 
```

两者都不存在。有什么想法或方向吗？

[[ 编辑 ]]

进一步审查，即使资产生产缓存引用这些文件，但它们从未被创建......为什么？……

[[ 模板]]

（覆盖模板）

```
{% extends 'FrontBundle:Frame:base.html.twig' %}
{% block title %}{{ page.title }}{% endblock %}

{% block wrapper %}

    {# route: {{ route }} #}

    {{ rendered | raw }}

{% endblock %} 
```

（覆盖模板）

```
{% extends 'SkinBundle::layout.html.twig' %}

{# Site Name #}
{% block site_name %}
    {{ page.title }} | {{ parent() }}
{% endblock %} 
```

布局扩展了一个基本模板，它只是一个站点的外壳，在覆盖的过程中，可以说 CSS 如下：

```
{% extends 'FrontBundle:Frame:default.html.twig' %}
{# Stylesheets #}
{% block stylesheets %}
{# no execute {{ parent() }}#}
{% stylesheets
    filter='cssrewrite'
    'bundles/core/css/normalize.css'
    'bundles/skin/css/main.css'
    %}
        <link rel="stylesheet" type="text/css" media="screen" href="{{ asset_url }}">
    {% endstylesheets %}
{% endblock %} 
```

在 Base 模板中声明为：

```
 {# Stylesheets #}
        {% block stylesheets %}
            {% stylesheets
                filter='cssrewrite'
                'bundles/core/css/normalize.css'
                'bundles/front/css/global.css'
                'bundles/page/css/page.css'
            %}
            <link rel="stylesheet" type="text/css" media="screen" href="{{ asset_url }}">
            {% endstylesheets %}
            <!-- Page -->
        {% endblock %} 
```

不需要这些样式表，这就是为什么我将 parent() 包装在注释标签中。完全删除线没有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T18:26:00.857

`parent()`在彻底清除缓存并重建后，删除确实有所帮助。

我将很快在这里制作一个错误票，因为由于某种原因，`parent()`在注释 ( `{# ... #}`) 中包含的内容会破坏生成，即使`{# ... #}`模板编译器不应该解析甚至考虑其中的任何内容。

棘手的错误。

# android - 为什么在 onActivityResult() 中启动 Activity 时在 onCreate() 之后调用 onStop()

> ID：14898431
> 
> 赞同：1
> 
> 时间：2013-02-15T15:55:03.263
> 
> 标签：android, android-activity

我有以下工作流程：

*   startActivityForResult(Activity1)
*   在 Activity1 上调用 finish() （按下按钮时）
*   onActivityResult() ==> startActivityForResult(Activity2)

===> Activity2.onCreate() 在 Activity1.onStop() 之前被调用

为什么我有那个？

**编辑：**

这是代码：

1- MainActivity.java

```
 // On click on a button
    public void start(View view) {
        Intent activityIntent = new Intent(this, Activity2.class);
        startActivityForResult(activityIntent, 0);
    }

    protected void onActivityResult(int requestCode, 
            int resultCode, 
            Intent data) {
            super.onActivityResult(requestCode, resultCode, data);

                Intent activityIntent = new Intent(this, Activity3.class);
                startActivityForResult(activityIntent, 0);
            } 
```

2- Activity2.java

```
// A button to finish the activity
public void stop(View view) {
    finish();
}

@Override
protected void onStop() {
    super.onStop();
} 
```

3- Activity3.java

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_activity3);
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-15T16:10:09.457

因为生命周期。直到从视图中删除 Activity 后才会调用 onStop。所以 onStop 不会被调用，直到在这种情况下有其他东西阻止它从用户活动 2 中获取。这意味着必须已经创建了 Activity2，因为如果您不存在，则无法阻止另一个活动。

# wpf - 什么事件或绑定允许我在编辑开始时禁用添加记录按钮？

> ID：14898432
> 
> 赞同：0
> 
> 时间：2013-02-15T15:55:05.737
> 
> 标签：wpf, entity-framework, events, binding

我的 WPF 窗口直接绑定到实体框架数据上下文 (CollectionViewSource)。一旦找到记录，用户就会立即开始编辑。**当表单变脏时，我想禁用“添加”按钮并启用“保存”和“撤消”按钮。**有没有一种简单的方法可以使用绑定或事件来做到这一点？

我没有使用 MVVM。我首先使用实体​​框架数据库和 EF 设计器。我希望避免为每个字段添加代码。数据库相当大。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T16:32:44.150

如果您愿意，您可以在没有事件的情况下执行此操作。而且您可以利用`DataBinding`MVVM 的强大功能。下面的示例以非常简单的方式演示了如何完成此操作。如果您的实体类还没有 IsDirty 属性（自从我使用数据库优先 EF 以来已经有一段时间了），您可以使用部分类添加该属性。

XAML：

```
 <TextBlock HorizontalAlignment="Right" VerticalAlignment="Center" Text="Name:" Margin="10"/>
      <TextBox x:Name="NameTextBox" Grid.Column="1" HorizontalAlignment="Stretch" VerticalAlignment="Center" Margin="10" Text="{Binding Name, UpdateSourceTrigger=PropertyChanged}"/>

      <StackPanel Grid.Row="1" Grid.ColumnSpan="2" Orientation="Horizontal" HorizontalAlignment="Right">
        <Button Content="Save" HorizontalAlignment="Right" Margin="5" IsEnabled="{Binding IsDirty}" />
        <Button Content="Cancel" HorizontalAlignment="Right" Margin="5" IsEnabled="{Binding IsDirty}" Click="Cancel_Click"/>
        <Button Content="Add" HorizontalAlignment="Right" Margin="5" IsEnabled="{Binding IsClean}"/>
      </StackPanel>
  </Grid>
</Window> 
```

一个测试实体类：

```
public class Entity : INotifyPropertyChanged
{
    private string _name;
    private bool _isDirty = false;

    public string Name
    {
        get { return _name; }
        set
        {
            if(!IsDirty)
                IsDirty = (value != _name);

            _name = value;
            RaisePropertyChanged("Name");               
        }
    }

    public bool IsDirty
    {
        get{ return _isDirty; }
        set{
            _isDirty = value;
            RaisePropertyChanged("IsDirty");
            RaisePropertyChanged("IsClean");
        }
    }

    public bool IsClean
    {
        get { return !_isDirty; }
    }

    #region INotifyPropertyChanged Members

    public event PropertyChangedEventHandler PropertyChanged;

    protected void RaisePropertyChanged(string propertyName)
    {
        if (PropertyChanged != null)
            PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
    }

    #endregion
} 
```

以及窗口背后的代码：

```
namespace Test
{
  public partial class EditTesting : Window
  {
    private Entity _myEntity;

    public EditTesting()
    {
      InitializeComponent();
      _myEntity = new Entity();
      this.DataContext = _myEntity;
    }

    private void Cancel_Click(object sender, RoutedEventArgs e)
    {
      _myEntity.Name = string.Empty;
      _myEntity.IsDirty = false;
    }       
  }
} 
```

# sql-server - 插入时 SQL Server 2000 触发器

> ID：14898433
> 
> 赞同：1
> 
> 时间：2013-02-15T15:55:06.837
> 
> 标签：sql-server, triggers

我需要为包含数百万个插入的表创建一个触发器。

该触发器将向我发送一封电子邮件（已经完成），说该表正在通电。

该电子邮件应在插入开始时仅发送一次（每天一封）。

换句话说，我想这样做：

```
Create trigger on table T1 on FIRST INSERT; EXEC my procedure to send email 
```

作为一个开发者，我真的不知道如何写这个......

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T16:05:26.763

你不能轻易地`ON FIRST INSERT`触发。

你可以做的是：

*   创建一个`ON INSERT`向您发送电子邮件的正常触发器
*   在该触发器结束时，禁用该触发器：

    ```
    ALTER TABLE dbo.YourTable DISABLE TRIGGER YourTriggerNameHere 
    ```

这将防止触发器一遍又一遍地触发并向您发送大量电子邮件。

然后，您还需要一个 SQL 代理作业，该作业将在晚上再次启用该触发器 - 以便它可以在第二天的第一次插入时再次触发。

**更新：**好的，所以在你的情况下，它将是：

```
CREATE TRIGGER sendMail 
ON MyTable AFTER INSERT 
AS 
    EXEC master.dbo.MyProcedure 

    ALTER TABLE dbo.MyTable DISABLE TRIGGER sendMail 
```

在晚上的 SQL 代理工作中，您需要：

```
ALTER TABLE dbo.MyTable ENABLE TRIGGER sendMail 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T17:24:48.817

为什么不在触发器中使用上次发送电子邮件的时间更新表格？然后您可以在触发器中查询此表并决定是否要发送另一个

```
create trigger tr
on tab after insert
as
begin
    declare @today datetime;
    set @today = cast(convert(varchar(32), getdate(), 112) as datetime);

    if not exists(select * from logtab where logdate = @today)
    begin
        -- Send the email
        exec sendMail

        -- Update Log Table
        update logtab
            set logdate = @today
    end
end
GO 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T15:59:28.353

您不能在第一次更新时直接触发触发器。

但是，您可以有一个表记录您发送电子邮件时的日志以及哪个表，并且在触发器中您可以询问当天是否有记录不发送，如果没有，则插入该表并调用您的 sp。

你的 sp 也可以做这个检查。

# user-interface - 用java编写的opc服务器使我的java UI停止工作

> ID：14898440
> 
> 赞同：0
> 
> 时间：2013-02-15T15:55:23.487
> 
> 标签：user-interface, opc, jnetpcap

我在 java 中创建了一个使用卡片布局的用户界面。它基本上显示了它通过我们公司的本地网络接收的大量读数。现在我必须用 java 编写一个 OPC 服务器，以便我的 ui 接收到的所有读数都存储到该服务器上。我成功写了。我的 UI 工作了将近一天，但是第二天当我到办公室时，我发现我的 UI 冻结了，因为没有更多的通信发生。UI 停止接收或传输号码。当我在没有 OPC 的情况下运行 UI 时，它会一直持续下去，但是当我将 OPC 添加到它时，它会冻结/我尝试了各种东西，但我仍然无法解决它。是的，我使用 Jnet Pcap 在 UI 中捕获数据包。其中有大量代码，因此如果有人需要查看任何特定代码，请告诉我。

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-02-25T21:18:16.990

这真的很难遵循。您面临的确切问题是什么仍不清楚。具有免费 OPC 实现的 openSCADA 网站应该是您最好的选择... [http://openscada.org/projects/utgard/](http://openscada.org/projects/utgard/)

此外，您还可以尝试最初免费的 JEasyOPC 客户端。

# objective-c - 从 iOS 模拟器中检测山狮

> ID：14898442
> 
> 赞同：0
> 
> 时间：2013-02-15T15:55:35.443
> 
> 标签：objective-c, macos, ios-simulator, osx-mountain-lion, detection

是否有一种 Objective-C 机制可以从 iOS 模拟器中检测您是否在 Mountain Lion 上运行？在 iOS 模拟器中，我需要在 Mountain Lion 上执行与早期版本的 Mac OS 不同的代码路径。最佳解决方案是在运行时检测到这一点，但我认为在编译时检测以及 ifdef 两个代码路径也是一个可接受的解决方案。所以......如果你有它们，请张贴。谢谢！

# sql-server-2008 - IF EXISTS 在 WHERE 子句中？

> ID：14898444
> 
> 赞同：0
> 
> 时间：2013-02-15T15:55:39.903
> 
> 标签：sql-server-2008, sql-server-2008-r2

我想在我的一个查询中插入一个条件，但真的不知道该怎么做。基本上，我按它们的文件夹_id 对一堆文件进行排序，即它们所属的文件夹（使用按folder_id 排序）。对于这些文件组中的每一个，我现在想要的是选择满足特定条件的第一个文件的查询。如果文件夹中的任何文件都不满足该条件，则查询应选择文件夹中可用的第一个文档。

这是我的查询（简化）：

```
select folder_id,
       file_id,
       first_name
from f_file
where first_name = 'John'
order by folder_id 
```

所以，如果我现在的结果是：

```
FOLDER ID    FILE ID      AUTHOR
A            32           John
A            41           John
A            56           Thomas
A            78           Peter
B            02           Peter
B            03           Peter
B            45           Peter
C            34           John
C            56           Thomas
C            77           Peter
C            86           John
D            12           Peter
D            34           Thomas
D            89           Thomas 
```

对于每个文件夹，我希望查询仅显示 John 创建的第一个文档（最低 file_id）。如果该文件夹中根本没有 John 创建的文档，那么任何其他作者的第一个文档都会这样做。

```
FOLDER ID    FILE ID      AUTHOR
A            32           John
B            02           Peter
C            34           John
D            12           Peter 
```

因此，ID 必须是最低的，但作者必须是 John 或其他人。我的想法是在`IF EXISTS`子句中插入一个子句`WHERE`，但是怎么做呢？

感谢您的回复。瓦尔

# matlab - 在 matlab 中运行另一个循环时，值是否继续增加？

> ID：14898447
> 
> 赞同：0
> 
> 时间：2013-02-15T15:55:57.350
> 
> 标签：matlab, loops, switch-statement, monitoring, nested-loops

我有三个操作。每个操作都在一个循环中，并且`flag`在操作运行时具有一个减小的值。在操作运行时，任何其他`flag`值达到最大阈值的操作都应中断它并改为运行（具有最高优先级）。该`flag`值根据随时间的微分方程而变化。

*   我希望每个操作的`flag`值在另一个操作运行时增加，并在`flag`值达到最大阈值时向系统发出切换到它的信号。
*   每个操作的`flag`值在操作运行时根据随时间变化的特定微分方程增加和减少。

所有操作当前都在一个文件中，在一个`Switch case`语句中循环。当前代码是：

```
while 1
  [value, index]=max(flag);
  switch index
      case 1
          operation1
          ...
          ...
          flag = [x y z]
      case 2
          operation2
          ...
          ...
          flag = [x y z]
      case 3
          operation3
          ...
          ...
          flag = [x y z]
    end
end 
```

有任何想法吗 ？如果您需要我更好地解释，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T16:14:30.620

这里有几种方法

1.  每次运行一个操作，其他操作都应该增加一些权重，下次选择一个操作时，选择权重最高的一个。
2.  每毫秒运行一个操作，其他操作应该增加一些权重，下一次选择操作时选择权重最高的操作。
3.  每运行一个操作毫秒，其他操作就会增加一些权重。一旦操作失去其最高标志状态，它就应该被中断。

每个都需要不同的解决方案

* * *

以下是针对相应问题的一些建议解决方案：

1.  相当简单，每次运行操作时将所有操作的标志加 1，或者交替将此操作的标志减 1。
2.  测量完成操作所花费的时间（可能使用`tic`and `toc`），使用该值增加所有其他操作的标志。
3.  将该标志作为操作的输入，当经过的时间让该操作超过另一个标志时，该操作在内部停止。请注意，如果不进行调整，这意味着您基本上会尝试以毫秒为单位交替操作。

# ruby-on-rails - 尝试使用 Prawn 定位桌子

> ID：14898455
> 
> 赞同：0
> 
> 时间：2013-02-15T15:56:16.807
> 
> 标签：ruby-on-rails, ruby, pdf, prawn

我正在使用 ruby​​ on rails 中的 prawn 创建一个 pdf 名册。我的表中将有大约 100 行，垂直时它不适合一页。我想要做的是让表格在到达页面底部后环绕，并在前几行的右侧开始新行。到目前为止，我有以下代码，它（取决于为名册 pdf 选择的选项）生成一个适合六页的长表。

```
user_list.in_groups_of(26,false) do |ul| #26 reaches the bottom of the page 
    ul.each do |u|
    row = Array(u.first_name + " " + u.last_name ) #Individual Row
      columns.to_i.times do |c|
        row << "     " #Optional columns being added
      end
    data << row #Individual row being added to the table data
    end
  table(data,:row_colors => ["E0E0E0", "FFFFFF"])
  data = Array.new
end 
```

我尝试做一个边界框，但我无法让它工作。有没有我可以添加的某种定位命令，然后每次抓取下一组 26 人时增加它？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T15:24:06.000

我最终使用 column_box 来获得这个所需的布局。我的最终代码现在看起来像

```
 column_box([0, cursor], :columns => 5, :width => bounds.width) do
     user_list.each do |u|
      row = Array(u.first_name + " " + u.last_name ) 
        columns.to_i.times do |c|
         row << "     "
        end #END OF COLUMN LOOP
      data << row 
     end #END OF USERLIST LOOP
     table(data,:row_colors => ["E0E0E0", "FFFFFF"],:width => 160 + (columns.to_i-1) * 30)
    end #END OF COLUMN_BOX 
```

可以在[此处](http://prawn.majesticseacreature.com/docs/0.11.1/Prawn/Document.html#method-i-column_box)找到有关 column_box 的更多信息。

# c# - 加入两个表 sortby 用户点击计数然后每个人都使用 linq 点击计数

> ID：14898462
> 
> 赞同：1
> 
> 时间：2013-02-15T15:56:40.940
> 
> 标签：c#, linq, join, favorites

我是 linq 的新手，我需要一定的加入。所以我有两个表用于我想加入 Linq 的某些页面，类似于

**用户收藏**表：

```
Page.id
userClickCount 
```

**页**表：

```
id
everyoneClickCount 
```

用户收藏夹是在单击或收藏时创建的，因此只有一定数量的链接。我想显示两个表中的所有结果，按用户点击次数最多的排序，然后是每个人点击次数最多的排序。

我现在有这个，但它按每个人的数量排序。

```
pages = (from page in context.Page
              join ps in
          (from favs in context.UserFavorites
              select favs) on page.Id equals ps.Page.Id into temp
          from t in temp.DefaultIfEmpty()
              orderby t.userClickCount descending, t.Page.everyoneClickCount  descending, t.Page.PageName ascending
            select dash).ToList(); 
```

我只是不确定从这里去哪里。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T16:26:55.790

尝试这个：

```
var pages = context.Pages.Select(page => new { 
                                               PageData = page, 
                                               Favs = page.UserFavorites 
                                             })
                         .OrderByDescending(page => (page.Fav.Sum(userClickCount))
                         .ThenBy(page => page.PageData.everyoneClickCount)
                         .ThenBy(page => page.PageData.Name)
                         .ToList(); 
```

请注意，这将按*所有*用户点击次数的总和排序。如果您只想要当前用户，请将该行替换为`.OrderByDescending(page => (page.Fav.Where(u => u.userID == userid).Sum(userClickCount))`

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2013-02-15T15:59:12.330

对于复杂的连接，我建议编写一个存储过程，然后使用 EF 和 linq 调用这个 SP。

# vim - 每行的VIm根据同一行上的另一个单词替换一个单词

> ID：14898468
> 
> 赞同：1
> 
> 时间：2013-02-15T15:57:08.800
> 
> 标签：vim

如何在 VIM 中实现以下内容

```
substitute/regex_this_word/regex_with_another_word_from_the_same_line 
```

例如

```
select "ali" as name where _placeholder = _placeholder
union
select "sam" as name where _placeholder = _placeholder 
```

申请后

```
:%s/_placeholder/anythin_between_quotation/ 
```

变成

```
select "ali" as name where ali = ali
union
select "sam" as name where sam = sam 
```

例如2

```
select id, "_placeholder" as vul members_repeater/vul/none 
```

申请后

```
:%s/_placehold/\=something_like_regexp(getline('.'),'regexp_pattern_to_select_everthing_after_/vul/") 
```

变成

```
select id, "none" as vul members_repeater/vul/none 
```

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T16:09:31.857

```
:%s/_placeholder/\=split(getline("."),'"')[1]/g 
```

这在这种情况下有效：

*   **每行只有一个**引用部分（替换）
*   引用部分可以在这一行的**任何地方**

例如：

```
select "ali" as name where _placeholder = _placeholder
union
select "sam" as name where _placeholder = _placeholder
select _placeholder where _placeholder = _placeholder "foo"
select _placeholder where "bar", _placeholder = _placeholder 
```

进入

```
select "ali" as name where ali = ali
union
select "sam" as name where sam = sam
select foo where foo = foo "foo"
select bar where "bar", bar = bar 
```

**编辑**

```
\=split(getline("."),'"')[1]
 |  |      |
 |  |      +--- get current line text
 |  |
 |  +------ split the line with " as separator, pick the middle part ([1])
 |
 |
 +---- using expression replacement 
```

**新编辑**

所以你可以重新使用旧的例程：

```
:%s#_placeholder#\=split(split(getline("."),"vul/")[1]," ")[0]#g 
```

这`vul/`在您的行中只需要一个，但**关键字**后面可能有文本（以空格作为分隔符），例如：

```
select id, "_placeholder" as vul members_repeater/vul/none trashtrash 
```

进入

```
select id, "none" as vul members_repeater/vul/none trashtrash 
```

看这个例子：

![在此处输入图像描述](../Images/15ace7126631603b933ee1621a7d4948.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T16:01:25.337

特别是对于这些行，那将是

```
s/^\(.*\)"\([^"]*\)"\(.*\)_placeholder\ = _placeholder/\1"\2"\3\2 = \2/ 
```

说明： 匹配的`\(`和之间的表达式`\)`被捕获在 \1、\2 等中。因此，在这里进行的一种方法是捕获直到 的所有内容`_placeholder`，然后将其放回原处。诚然，有点难以理解。

该解决方案假定每一行的双引号中只有一个表达式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-15T16:55:53.120

如果知道的话，您可以轻松使用`sed`它，它允许您使用扩展的正则表达式：

example_with_no_link.txt：

```
from django.utils import unittest
from django.core import management
from app import subapp 
```

vim 命令：

```
:%! sed -re "/django/ s/from (.*) import (.*)/from \2 import \1/" 
```

该命令执行以下操作：
1\. `:%!`：将所有行放入标准输出
2\. ：如果第 3行中`sed -re "/django/`有 'django' 。 ：括号中的反向模式
`s/from (.*) import (.*)/from \2 import \1/`

在 sed 中，您用括号捕获搜索的单词并用`\n`.
输出重定向到 vim。

# c# - 在没有标题 ace.oledb 的工作簿中创建工作表

> ID：14898469
> 
> 赞同：2
> 
> 时间：2013-02-15T15:57:23.770
> 
> 标签：c#, excel, oledb, ado

如何通过 ace.oledb 创建没有标题的命名工作表 - 就像默认工作表一样？

工作表的创建命令必须类似于：

```
CREATE TABLE [MySheet] (field1 type, field2 type ..., fieldn type ) 
```

它创建 MySheet 并始终插入（无论连接字符串中的 HDR 扩展属性或注册表设置 FirstRowHasNames）在 MySheet 中包含 field1、field2...fieldn 的第一行

基本上我不想要一个“表头”，我只需要在一个新创建的命名空表中插入值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T21:36:16.523

这并不漂亮，但这是我发现创建一个没有任何内容的新工作表的唯一方法。我发现的唯一问题是 Oledb 会自动在`CREATE`命令中指定的标题单元格上创建一个命名范围，但假设您不关心它，那么这应该可以正常工作。

```
string connectionString = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" + fileName +
    ";Mode=ReadWrite;Extended Properties=\"Excel 12.0 XML;HDR=NO\"";

using (OleDbConnection conn = new OleDbConnection(connectionString))
{
    conn.Open();

    using (OleDbCommand cmd = new OleDbCommand())
    {
        cmd.Connection = conn;
        cmd.CommandText = "CREATE TABLE [MySheet] (<colname> <col type>)";  // Doesn't matter what the field is called
        cmd.ExecuteNonQuery();

        cmd.CommandText = "UPDATE [MySheet$] SET F1 = \"\"";
        cmd.ExecuteNonQuery();
    }

    conn.Close();
} 
```

# directshow - 在directshow中使用SampleGrabber过滤器在帧数和帧采样时间之间生成映射

> ID：14898471
> 
> 赞同：0
> 
> 时间：2013-02-15T15:57:36.150
> 
> 标签：directshow

在我的一个应用程序中，我需要知道给定视频文件的帧位置（帧号）和实际帧采样时间之间的映射。我在回调模式下使用 Directshow SampleGrabber 过滤器。我正在覆盖 ISampleGraberCB 类的 BufferCB 方法，每当调用回调时，我都会将到达的采样时间映射到地图中的帧位置。每当新样本从零开始到达时，帧位置就会增加。虽然我能够生成所需的地图，但在处理大型视频文件时，上述方法非常慢。有人可以就如何快速生成此地图或任何其他更好的方法提供任何建议。

提前致谢。

普拉迪普

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T21:25:26.413

There are basically no such thing as "frame number" in DirectShow, only time stamps. The only thing to do the needed is to go through the entire file and record timestamps, as you already do.

However, the process might be *way* faster if you set the sample grabber to receive raw/undecoded fames. This way there is no need for decoder and the whole iteration through frames happens pretty quick. Don't forget to remove clock from the graph to request ASAP processing (as opposed to default real time pace).

# c# - 并行化直方图函数

> ID：14898473
> 
> 赞同：6
> 
> 时间：2013-02-15T15:57:41.707
> 
> 标签：c#, .net, image-processing, parallel-processing, histogram

我已经实现了一个简单函数的普通和并行版本，该函数从 32bppArgb 位图计算直方图。普通版本在 1920x1080 图像上大约需要 0.03 秒，而并行版本需要 0.07 秒。

线程开销真的那么重吗？除了 Parallel.For 之外还有其他构造可以加快这个过程吗？我需要加快速度，因为我正在处理 30fps 视频。

这是简化的代码：

```
public sealed class Histogram
{
    public int MaxA = 0;
    public int MaxR = 0;
    public int MaxG = 0;
    public int MaxB = 0;
    public int MaxT = 0;

    public int [] A = null;
    public int [] R = null;
    public int [] G = null;
    public int [] B = null;

    public Histogram ()
    {
        this.A = new int [256];
        this.R = new int [256];
        this.G = new int [256];
        this.B = new int [256];

        this.Initialize();
    }

    public void Initialize ()
    {
        this.MaxA = 0;
        this.MaxR = 0;
        this.MaxG = 0;
        this.MaxB = 0;
        this.MaxT = 0;

        for (int i = 0; i < this.A.Length; i++)
            this.A [i] = 0;
        for (int i = 0; i < this.R.Length; i++)
            this.R [i] = 0;
        for (int i = 0; i < this.G.Length; i++)
            this.G [i] = 0;
        for (int i = 0; i < this.B.Length; i++)
            this.B [i] = 0;
    }

    public void ComputeHistogram (System.Drawing.Bitmap bitmap, bool parallel = false)
    {
        System.Drawing.Imaging.BitmapData data = null;

        data = bitmap.LockBits
        (
            new System.Drawing.Rectangle(0, 0, bitmap.Width, bitmap.Height),
            System.Drawing.Imaging.ImageLockMode.ReadOnly,
            System.Drawing.Imaging.PixelFormat.Format32bppArgb
        );

        try
        {
            ComputeHistogram(data, parallel);
        }
        catch
        {
            bitmap.UnlockBits(data);

            throw;
        }

        bitmap.UnlockBits(data);
    }

    public void ComputeHistogram (System.Drawing.Imaging.BitmapData data, bool parallel = false)
    {
        int stride = System.Math.Abs(data.Stride);

        this.Initialize();

        if (parallel)
        {
            unsafe
            {
                System.Threading.Tasks.Parallel.For
                (
                    0,
                    data.Height,
                    new System.Threading.Tasks.ParallelOptions() { MaxDegreeOfParallelism = System.Environment.ProcessorCount },
                    y =>
                    {
                        byte* pointer = ((byte*) data.Scan0) + (stride * y);

                        for (int x = 0; x < stride; x += 4)
                        {
                            this.B [pointer [x + 0]]++;
                            this.G [pointer [x + 1]]++;
                            this.R [pointer [x + 2]]++;
                            this.A [pointer [x + 3]]++;
                        }
                    }
                );
            }
        }
        else
        {
            unsafe
            {
                for (int y = 0; y < data.Height; y++)
                {
                    byte* pointer = ((byte*) data.Scan0) + (stride * y);

                    for (int x = 0; x < stride; x += 4)
                    {
                        this.B [pointer [x + 0]]++;
                        this.G [pointer [x + 1]]++;
                        this.R [pointer [x + 2]]++;
                        this.A [pointer [x + 3]]++;
                    }
                }
            }
        }

        for (int i = 0; i < this.A.Length; i++)
            if (this.MaxA < this.A [i]) this.MaxA = this.A [i];
        for (int i = 0; i < this.R.Length; i++)
            if (this.MaxR < this.R [i]) this.MaxR = this.R [i];
        for (int i = 0; i < this.G.Length; i++)
            if (this.MaxG < this.G [i]) this.MaxG = this.G [i];
        for (int i = 0; i < this.B.Length; i++)
            if (this.MaxB < this.B [i]) this.MaxB = this.B [i];

        if (this.MaxT < this.MaxA) this.MaxT = this.MaxA;
        if (this.MaxT < this.MaxR) this.MaxT = this.MaxR;
        if (this.MaxT < this.MaxG) this.MaxT = this.MaxG;
        if (this.MaxT < this.MaxB) this.MaxT = this.MaxB;
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-15T20:34:10.223

好吧，首先，您的 Parallel 循环中有一个巨大的错误：

您将有多个线程访问、递增和更新共享数组 - 由于固有的竞争条件，只需在同一个图像上多次运行示例代码会导致截然不同的结果。

但这不是你问的。

至于为什么你看到使用并行实现的性能下降，简单的答案是你可能没有在每个并行任务的主体中做足够的工作来抵消创建新任务的“启动成本”，调度它，等等

可能更关键的是，我相信您正在通过内存中的所有跳跃从 L1/L2 缓存中彻底崩溃 - 每个任务线程都将尝试将它认为需要的内容加载到缓存内存中，但是就像您一样到处索引，您不再创建一致的访问模式，因此每次尝试访问位图缓冲区或内部数组时，您都可能会遇到缓存未命中。

还有一种同样高效的方法可以在不使用不安全代码的情况下获取位图的只读数据……实际上，让我们先这样做：

因此，通过调用`LockBits`，您有一个指向非托管内存的指针。让我们复制它：

```
System.Drawing.Imaging.BitmapData data = null;
data = bitmap.LockBits
(
    new System.Drawing.Rectangle(0, 0, bitmap.Width, bitmap.Height),
    System.Drawing.Imaging.ImageLockMode.ReadOnly,
    System.Drawing.Imaging.PixelFormat.Format32bppArgb
);

// For later usage
var imageStride = data.Stride;
var imageHeight = data.Height;

// allocate space to hold the data
byte[] buffer = new byte[data.Stride * data.Height];

// Source will be the bitmap scan data
IntPtr pointer = data.Scan0;

// the CLR marshalling system knows how to move blocks of bytes around, FAST.
Marshal.Copy(pointer, buffer, 0, buffer.Length);

// and now we can unlock this since we don't need it anymore
bitmap.UnlockBits(data);

ComputeHistogram(buffer, imageStride, imageHeight, parallel); 
```

现在，至于竞争条件 - 您可以通过使用`Interlocked`调用增加计数以合理的性能方式克服这个问题（**注意！！！多线程编程很困难，我的解决方案完全有可能不是完美的！**）

```
public void ComputeHistogram (byte[] data, int stride, int height, bool parallel = false)
{
    this.Initialize();

    if (parallel)
    {
        System.Threading.Tasks.Parallel.For
        (
            0,
            height,
            new ParallelOptions() { MaxDegreeOfParallelism = Environment.ProcessorCount },
            y =>
            {
                int startIndex = (stride * y);
                int endIndex = stride * (y+1);
                for (int x = startIndex; x < endIndex; x += 4)
                {
                    // Interlocked actions are more-or-less atomic 
                    // (caveats abound, but this should work for us)
                    Interlocked.Increment(ref this.B[data[x]]);
                    Interlocked.Increment(ref this.G[data[x+1]]);
                    Interlocked.Increment(ref this.R[data[x+2]]);
                    Interlocked.Increment(ref this.A[data[x+3]]);
                }
            }
        );
    }
    else
    {
        // the original way is ok for non-parallel, since only one
        // thread is mucking around with the data
    }

    // Sorry, couldn't help myself, this just looked "cleaner" to me
    this.MaxA = this.A.Max();
    this.MaxR = this.R.Max();
    this.MaxG = this.G.Max();
    this.MaxB = this.B.Max();
    this.MaxT = new[] { this.MaxA, this.MaxB, this.MaxG, this.MaxR }.Max();
} 
```

那么，这对运行时行为有什么影响呢？

不是很多，但至少并行分叉现在计算出正确的结果。:)

使用非常便宜的测试台：

```
void Main()
{    
    foreach(var useParallel in new[]{false, true})
    {
        var totalRunTime = TimeSpan.Zero;
        var sw = new Stopwatch();
        var runCount = 10;
        for(int run=0; run < runCount; run++)
        {
            GC.Collect();
            GC.WaitForPendingFinalizers();
            GC.Collect();
            sw.Reset();
            sw.Start();
            var bmp = Bitmap.FromFile(@"c:\temp\banner.bmp") as Bitmap;
            var hist = new Histogram();
            hist.ComputeHistogram(bmp, useParallel);
            sw.Stop();
            totalRunTime = totalRunTime.Add(sw.Elapsed);
        }
        Console.WriteLine("Parallel={0}, Avg={1} ms", useParallel, totalRunTime.TotalMilliseconds / runCount);
    }
} 
```

我得到这样的结果：

```
Parallel=False, Avg=1.69777 ms
Parallel=True, Avg=5.33584 ms 
```

如您所见，我们仍未解决您最初的问题。:)

因此，让我们努力使并行工作“更好”：

让我们看看“给任务更多的工作”做了什么：

```
if (parallel)
{
    var batchSize = 2;
    System.Threading.Tasks.Parallel.For
    (
        0,
        height / batchSize,
        new ParallelOptions() { MaxDegreeOfParallelism = Environment.ProcessorCount },
        y =>
        {
            int startIndex = (stride * y * batchSize);
            int endIndex = startIndex + (stride * batchSize);
            for (int x = startIndex; x < endIndex; x += 4)
            {
                // Interlocked actions are more-or-less atomic 
                // (caveats abound, but this should work for us)
                Interlocked.Increment(ref this.B[data[x]]);
                Interlocked.Increment(ref this.G[data[x+1]]);
                Interlocked.Increment(ref this.R[data[x+2]]);
                Interlocked.Increment(ref this.A[data[x+3]]);
            }
        }
    );
} 
```

结果：

```
Parallel=False, Avg=1.70273 ms
Parallel=True, Avg=4.82591 ms 
```

哦，这看起来很有希望......我想知道随着我们的变化会发生什么`batchSize`？

让我们改变我们的测试台：

```
void Main()
{    
    foreach(var useParallel in new[]{false, true})
    {
        for(int batchSize = 1; batchSize < 1024; batchSize <<= 1)
        {
            var totalRunTime = TimeSpan.Zero;
            var sw = new Stopwatch();
            var runCount = 10;
            for(int run=0; run < runCount; run++)
            {
                GC.Collect();
                GC.WaitForPendingFinalizers();
                GC.Collect();
                sw.Reset();
                sw.Start();
                var bmp = Bitmap.FromFile(@"c:\temp\banner.bmp") as Bitmap;
                var hist = new Histogram();
                hist.ComputeHistogram(bmp, useParallel, batchSize);
                sw.Stop();
                totalRunTime = totalRunTime.Add(sw.Elapsed);
            }
            Console.WriteLine("Parallel={0}, BatchSize={1} Avg={2} ms", useParallel, batchSize, totalRunTime.TotalMilliseconds / runCount);
        }        
    }
} 
```

结果：（只显示parallel=true，因为non-parallel不会改变）

```
Parallel=True, BatchSize=1 Avg=5.57644 ms
Parallel=True, BatchSize=2 Avg=5.49982 ms
Parallel=True, BatchSize=4 Avg=5.20434 ms
Parallel=True, BatchSize=8 Avg=5.1721 ms
Parallel=True, BatchSize=16 Avg=5.00405 ms
Parallel=True, BatchSize=32 Avg=4.44973 ms
Parallel=True, BatchSize=64 Avg=2.28332 ms
Parallel=True, BatchSize=128 Avg=1.39957 ms
Parallel=True, BatchSize=256 Avg=1.29156 ms
Parallel=True, BatchSize=512 Avg=1.28656 ms 
```

一旦我们在批量大小中达到 64-128 范围，我们似乎正在接近某种渐近线，尽管当然您的里程可能会根据您的位图大小等而有所不同。

我希望这有帮助！这是我等待生产构建完成的一天的有趣分心！:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T17:10:38.757

创建线程有相当大的开销。执行可能比单线程版本运行得快得多，但完成速度太快而无法弥补这个初始开销。

如果你每帧都这样做，它只会减慢你的速度。

但是，如果您手动创建线程池、手动分配工作并为每个帧重用线程，您可能会发现到第二或第三帧时，您的代码会飞速超过单线程版本。

# intellij-idea - IntelliJ Idea中如何根据文件状态过滤文件

> ID：14898479
> 
> 赞同：0
> 
> 时间：2013-02-15T15:58:15.027
> 
> 标签：intellij-idea

当我在本地添加新文件时，文件状态**未知**，文件颜色为棕色。但是，在我明确将其添加到存储库之前，该文件不会显示在对话框 Commit Changes 中。

![在此处输入图像描述](../Images/251b2aa3cc3670bcfb821a2e668c50d9.png)

真正的问题是我几乎不记得在漫长的工作日后创建了多少文件。有人可以告诉我如何让 IntelliJ**显示所有未知文件**吗？

提前致谢

IntelliJ Idea 中的文件状态亮点：http: [//www.jetbrains.com/idea/webhelp/file-status-highlights.html](http://www.jetbrains.com/idea/webhelp/file-status-highlights.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T16:05:26.827

1.  `Alt`+`9`
2.  点击本地
3.  单击“未版本控制的文件（n 个目录和 m 个文件）单击以浏览）”
4.  `Ctrl`+`NumPad +`选择所有必须添加到版本控制的文件单击“+”

# javascript - Firefox 中的 window.close

> ID：14898486
> 
> 赞同：1
> 
> 时间：2013-02-15T15:58:29.540
> 
> 标签：javascript, firefox

随着 Firefox 的最新更新，当客户单击屏幕上的关闭按钮时，我不再能够使用 javascript 关闭页面。以下是我过去一直在使用的，我似乎无法找到替代解决方案。任何想法？

```
var response = confirm('The webpage you are viewing is trying to close the window.\n\nDo you want to close the window?');

    if (response) {
        window.open('', '_self');
        window.close();
    } 
```

# sql-server - SELECT distinct top 5 Topic_ID, Thread_ID from tblThread ORDER BY Thread_ID DESC

> ID：14898487
> 
> 赞同：0
> 
> 时间：2013-02-15T15:58:30.607
> 
> 标签：sql-server

我正在尝试从 Threads 表中返回带有线程的最新 5 个主题。然后我还需要加入主题表以将 topic_name + 从线程表连接返回到作者表并返回作者姓名。

如果一个主题在最近的 x 个帖子中出现多次，我只想要最近（最高）的线程 ID 信息。

```
SELECT distinct top 5 Topic_ID, Thread_ID from tblThread ORDER BY Thread_ID DESC 
```

只返回 5 个最近的线程 ID，如下所示

topic_id - Thread_id

852 - 2905

852 - 2904,

850 - 2903,

937 - 2902,

937 - 2901

我要返回 852 - 2905 + 其他字段，主题名，作者名

850 - 2903 + ..

937 - 2902 + ...

&接下来的两个主题ID

提前致谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T16:08:34.633

像这样的东西应该可以解决问题（尽管您需要在那里使用真实的表和列）：

```
;WITH CTE AS
(
    SELECT *, ROW_NUMBER() OVER(PARTITION BY Topic_ID ORDER BY Thread_ID DESC) RN
    FROM tblThread 
)
SELECT  A.Topic_ID,
        A.Thread_ID,
        B.Topic_Name,
        C.Author_Name
FROM CTE A
INNER JOIN tblTopic B
    ON A.Topic_ID = B.Topic_ID
INNER JOIN tblAuthor C
    ON A.Author_ID = C.Author_ID
WHERE RN = 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T16:31:27.987

这行不通：

```
select topic, max(thread) as thread from tblThread
group by topic
order by thread desc 
```

You would do whatever joins you need after that.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T17:13:22.677

final answer:

```
;WITH CTE AS
(
    SELECT top 10 *, ROW_NUMBER() OVER(PARTITION BY Topic_ID ORDER BY Thread_ID DESC) RN
    FROM tblThread 
    ORDER BY tblThread.Thread_ID DESC
)
SELECT  tblThread.Topic_ID,
        tblThread.Thread_ID,
        tblTopic.Subject,
        tblAuthor.UserName
FROM CTE tblThread
INNER JOIN tblTopic
    ON tblThread.Topic_ID = tblTopic.Topic_ID
INNER JOIN tblAuthor
    ON tblThread.Author_ID = tblAuthor.Author_ID
WHERE RN = 1 
```

# css - IE8 CSS 更高特异性选择器被忽略

> ID：14898488
> 
> 赞同：1
> 
> 时间：2013-02-15T15:58:34.320
> 
> 标签：css, internet-explorer-8

我遇到了一个 IE8 特异性问题，这让我抓狂：http: [//proffetdemo.themesforge.com/shop/](http://proffetdemo.themesforge.com/shop/)

以下选择器在 Chrome/Firefox 等中正确应用。人。

```
.tfshop-3 ul.products li.product {
    width: 30.5% !important;
} 
```

但是在 IE8 中它被完全忽略了。上面的选择器是另一个选择器的覆盖：

```
ul.products li.product {
    float: left;
    margin: 0 0 20px;
    position: relative;
    width: 48%;
} 
```

任何人都知道为什么 IE8 忽略了更具体的选择器？

**更新 1：2013 年 2 月 15 日** 我现在认为这可能与 response.js 在 IE8 中未正确加载有关 - 看起来其他媒体查询没有在 IE8 中启动 - 嗯......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T16:02:50.723

尝试在类前面添加标签。喜欢`div.tfshop ul.products li.product`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T16:10:54.223

```
@media only screen and (min-width: 768px) {
  ...
  div.tfshop-3 ul.products li.product {
    width: 30.5% !important;
}
  ...
} 
```

[您将这些样式定义到@media 条件查询中，IE8 和更低的http://caniuse.com/css-mediaqueries](http://caniuse.com/css-mediaqueries)不支持

这就是[http://wicky.nillia.ms/enquire.js/](http://wicky.nillia.ms/enquire.js/)可能有助于以更简单的方式处理它的原因。

# c++ - 如何自动生成和分配与矩阵中的元素相对应的变量？

> ID：14898489
> 
> 赞同：-2
> 
> 时间：2013-02-15T15:58:34.520
> 
> 标签：c++, python, matlab, optimization, matrix

我正在研究一个二进制线性程序问题。

我对任何计算机语言都不是很熟悉（刚学了几个月的 Java 和 C++），但我可能不得不使用计算机，因为问题相当复杂。

第一步是为（至少 8 X 8）矩阵 M 中的每个条目声明变量 m_ij。然后我将矩阵的每个元素的相应值分配给这些变量中的每一个。

接下来是生成其他变量集 x_ij1、x_ij2、x_ij3、x_ij4 和 x_ij5，只要 m_ij 的值不为 0。x_ijk 变量的值是 0 或 1，我不必为x_ijk 变量。

可能最简单的方法是为每个变量声明并分配一个值，例如

```
int* m_11 = 5, int* m_12 = 2, int* m_13 = 0, ... int* m_1n = 1

int* m_21 = 3, int* m_12 = 1, int* m_13 = 2, ... int* m_2n = 3 
```

然后选择不为0的变量，并相应地声明x_ij1~x_ij5。

但这可能工作量太大，特别是因为我要为这个问题考虑许多不同的矩阵。

有没有办法自动做到这一点？

我知道一点 Java 和 C++，我正在考虑在 C++ 中使用 lp_solve 包（解决二进制整数线性程序问题），但如果我能轻松做到这一点，我愿意使用任何其他语言或程序。

我确信一定有某种方法可以做到这一点（可能使用循环，我猜？），这是一个非常简单的任务，但我只是不知道，因为我没有太多的编程语言。

我的一个团队编写了一个程序，用于生成满足我们需要的某些条件的随机矩阵，所以如果我可以使用该矩阵作为我的输入，它可能是理想的，但到目前为止，任何方法都可以。

比如说，如果有办法用 MS excel 来做，比如将矩阵条目放入 excel 文件中的单元格，然后将其导入 C++ 并自动生成变量并为其赋值，那么这将大大简化任务交易！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T16:25:22.477

在 C++ 中，你可以使用一个[`std::vector`](http://en.cppreference.com/w/cpp/container/vector)向量，比如

```
std::vector<std::vector<int>> matrix; 
```

您不需要为矩阵值使用单独的变量，当您拥有矩阵时为什么要这样做？

我不明白您需要在评估`true`或`false`. 而是直接放入`std::vector`您的条件评估为的坐标中`true`：

```
std::vector<std::pair<int, int> true_values;
for (int i = 0; i < matrix.size(); i++)
{
    for (int j = 0; j < matrix[i].size(); j++)
    {
        if (some_condition_for_this_matrix_value(matrix[i][j], i, j) == true)
            true_values.emplace_back(std::make_pair(i, j));
    }
} 
```

现在你有一个包含所有矩阵坐标的向量，你的条件是`true`。

* * *

如果你真的想同时拥有`true`和`false`值，你可以使用 a[`std::unordered_map`](http://en.cppreference.com/w/cpp/container/unordered_map)和[`std::pair`](http://en.cppreference.com/w/cpp/utility/pair)包含矩阵坐标作为键和`bool`值的 a：

```
// Create a type alias, as this type will be used multiple times
typedef std::map<std::pair<int, int>, bool> bool_map_type;
bool_map_type bool_map; 
```

将矩阵中的所有值插入此映射，矩阵的坐标作为键，映射值作为`true`或`false`取决于您拥有的任何条件。

要从中获取所有条目的列表，`bool_map`您可以使用以下命令删除任何`false`条目[`std::remove_if`](http://en.cppreference.com/w/cpp/algorithm/remove)：

```
std::remove_if(bool_map.begin(), bool_map.end(),
    [](const bool_map_type::value_type& value) {
        return value.second == false;
    }; 
```

现在您有一个地图，其中仅包含其值为 的条目`true`。遍历此地图以获取矩阵的坐标

* * *

当然，我可能完全误解了你的问题，在这种情况下，你当然可以无视这个答案。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T16:34:11.840

我知道 C++ 和 Matlab（不是 Python），在你的情况下，我真的会选择 Matlab，因为当你开始编程时它更容易使用（但当你发现 Matlab 的限制时不要忘记回到 C++ ）。

在 Matlab 中，您可以很容易地定义矩阵：只需键入矩阵的名称和要设置的索引：

```
m(1,1) = 1
m(2,2) = 1 
```

为您提供一个 2x2 单位矩阵（Matlab 中的索引以 1 开头，默认情况下条目为 0）。你也可以用同样的方法定义 3d 矩阵：

```
x(1,2,3) = 2 
```

对于从 Excel 导入，如果您将 Excel 文件保存为 CSV 格式，则可以使用该功能`dlmread`在 Matlab 中读取它。您也可以稍后尝试直接在 Matlab 中实现您的算法。

最后，如果你想解决你的二进制整数程序，Matlab 中已经有一个内置函数，调用`bintprog`它可以为你解决它。

希望能帮助到你！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T17:42:38.593

Matlab 似乎确实非常适合这项任务。尽管@Dr_Sam 提供的示例确实会即时创建矩阵，但我建议您在分配值之前初始化它们。这样，如果工作区中已经存在同名的东西，您的代码仍然会以正确的变量结束，并且您的变量将始终具有预期的大小。

假设您要定义一个 8x8 方形矩阵：

```
m = zeros(8) 
```

`imax`现在一般来说，如果你想初始化一个大小为, `jmax`,的三维矩阵`kmax`：

```
imax = 8;
jmax = 8;
kmax = 5;
x = zeros(imax,jmax,kmax); 
```

现在分配或读取这些矩阵非常容易，请注意 m 的长度和 with 已选择与 的第一个维度相同`x`：

```
m(3,4) = 4; %Assign a value
myvalue = m(3,4) %read the value
m(:,1) = 1:8 *Assign the values 1 through 8 to the first column

x(2,4,5) = 12; %Assign a single value to the three dimensional matrix
x(:,:,2) = m+1; Assign the entire matrix plus one to one of the planes in x. 
```

# android - 使用 JSON 向 GCM 发送多通知

> ID：14898492
> 
> 赞同：3
> 
> 时间：2013-02-15T15:58:40.530
> 
> 标签：android, json, push-notification, google-cloud-messaging

我想使用 GCM 一次向多个注册设备发送多个通知，我知道使用纯文本无法做到这一点，因为它只能用于一次发送一个设备的通知。因此，我决定使用 JSON 制作 HTTP 正文内容，并设法制作了以下表示 JSON 对象的字符串：

```
{ collapse_key : my_CollapseKey, data.message : myMessage,  registration_ids : ["regid1","regid2",...] } 
```

但是每当我发送请求时，我都会收到一个 400 响应，其中说明了错误请求，当我参考[GCM 架构概述](http://developer.android.com/google/gcm/gcm.html)的文档时，它指出

> 响应 400 仅适用于 JSON 请求。表示请求无法解析为 JSON，或者它包含无效字段（例如，在需要数字的地方传递字符串）

这是我在 ASP.Net 中开发的用于发送请求的 Web 应用程序的快照：

```
request.ContentType = "application/json"
        request.Headers.Add("Authorization: key=My_Server_Key")
        request.Headers.Add("Sender: id=myProject_ID")
        Dim collapsKey = Guid.NewGuid.ToString("n")
        Dim data As String = "{ collapse_key : " + collapsKey + "," + " data.message : " + HttpUtility.UrlEncode(TextBox1.Text) + "}" + ", registration_ids : " + jsonids1 + "}"
        Dim byteArray As Byte() = Encoding.UTF8.GetBytes(data)
        request.ContentLength = byteArray.Length
        Dim dataStream As Stream = request.GetRequestStream
        dataStream.Write(byteArray, 0, byteArray.Length)
        dataStream.Close() 
```

知道如何正确解析我的 JSON 对象并发送多个通知吗？任何帮助将不胜感激。

问候

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-15T16:11:48.917

JSON 应如下所示：

```
{
  "registration_ids" : ["APA91bHun4MxP5egoKMwt2KZFBaFUH-1RYqx...",...],
  "data" : {
    "Team" : "Portugal",
    "Score" : "3",
    "Player" : "Varela",
  },
} 
```

您忘记为数据创建字典。

来自 GCM 文档：

> **数据**
> 一个 JSON 对象，其字段表示消息有效负载数据的键值对。如果存在，有效负载数据将作为应用程序数据包含在 Intent 中，键是额外的名称。例如，"data":{"score":"3x1"} 将导致一个意图额外命名的分数，其值为字符串 3x1。键/值对的数量没有限制，但消息的总大小（4kb）有限制。这些值可以是任何 JSON 对象，但我们建议使用字符串，因为无论如何这些值都会在 GCM 服务器中转换为字符串。如果要包含对象或其他非字符串数据类型（如整数或布尔值），则必须自己转换为字符串。另请注意，密钥不能是保留字（from 或任何以 google. 开头的单词）。让事情稍微复杂一点的是，在有效载荷数据中技术上允许使用一些保留字（例如 collapse_key）。但是，如果请求中还包含该单词，则请求中的值将覆盖有效负载数据中的值。因此，即使在技术上允许的情况下，也不建议使用在此表中定义为字段名称的词。可选的。即使在技术上允许的情况下。可选的。即使在技术上允许的情况下。可选的。

# jquery - jquery getjson 没有

> ID：14898495
> 
> 赞同：0
> 
> 时间：2013-02-15T15:58:58.063
> 
> 标签：jquery, json

我有这个 html 页面：

```
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
    <title>Untitled Page</title>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
</head>
<body>
    <script type="text/javascript">
        $(document).ready(function () {
            $.getJSON('test.json', function (data) {
                var items = [];

                $.each(data, function (key, val) {
                    items.push('<li id="' + key + '">' + val + '</li>');
                });

                $('<ul/>', {
                    'class': 'my-new-list',
                    html: items.join('')
                }).appendTo('body');
            });
        });
    </script>
</body>
</html> 
```

而这个 test.json 文件

```
{
  "one": "Singular sensation",
  "two": "Beady little eyes",
  "three": "Little birds pitch by my doorstep"
} 
```

我已经验证了 json 文件，看起来没问题，但结果没有附加到 body 标记中。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T21:08:02.227

似乎它正在工作，但因为我没有在 Chrome 以外的其他浏览器中测试过它，所以我看不到结果。感谢@Jack 提到 Chrome 不会在文件系统之外运行 ajax。此处讨论了该问题：[http](http://code.google.com/p/chromium/issues/detail?id=40787) ://code.google.com/p/chromium/issues/detail?id=40787供感兴趣的人使用。

# java - 我需要做什么才能用渐变色复制这个组件？

> ID：14898497
> 
> 赞同：6
> 
> 时间：2013-02-15T15:59:01.727
> 
> 标签：java, swing, graphics, gradient, paintcomponent

我试图复制这个组件（在帖子的底部），但我似乎无法让它看起来不错。

![在此处输入图像描述](../Images/e0766295e800a2cecc81c1254f82cb65.png)

所以我想知道，我如何复制这种渐变色？或者如果不是渐变色，我该怎么做才能得到类似的结果？

与这个组件相比，我的尝试变成了非常平坦的黑色。它还具有 JFrame 选项（关闭、最小化等），并且对组件没有“圆形”外观。我正在寻找可以改善我所拥有的并解释我哪里出错的人。我知道我可以简单地使用已经制作的外观和感觉，但我想让我的示例项目尽可能接近图像中的 BitDefender GUI，不包括文本。（如果需要我可以提供代码）

另请注意，我跳过了背景和“病毒防护”、“自动扫描”、“我的 BitDefender”面板之间的面板。我这样做主要是因为我想让我的 SSCCE 尽可能小。

另外我想指出，将插图设置为`gbc.insets = new Insets(2,10,2,10);`3`TopPanels`使其看起来更接近 BitDefender GUI 的间距。（我只是暂时没有时间上传图片。所以我保留了代码，但我确实意识到它可以更新到上面的插图。

![在此处输入图像描述](../Images/a6df298416a029448b8fbb79ba0bf230.png)

**编辑 - 更新了更多来源**

这是我的代码/SSCCE（它是 3 个单独的类，但我将它们合并为一个 .java）

```
package testgui;

import java.awt.*;
import javax.swing.BorderFactory;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;

public class TestGui {

    public TestGui() {
        JFrame frame = new JFrame();
        MidPanel midPanel = new MidPanel();
        TopPanel topPanel1 = new TopPanel();
        TopPanel topPanel2 = new TopPanel();
        TopPanel topPanel3 = new TopPanel();
        JLabel appName = new JLabel("MyApplication");
        JLabel verNum = new JLabel("version 1.0");
        Font verFont = new Font("Tahoma", Font.BOLD, 11);
        Font nameFont = new Font("Tahoma", Font.BOLD, 14);

        GridBagConstraints gbc = new GridBagConstraints();

        appName.setForeground(Color.WHITE);
        appName.setFont(nameFont);
        verNum.setForeground(Color.WHITE);
        verNum.setFont(verFont);

        //add program name and version number
        gbc.gridx = 0;
        gbc.gridy = 0;
        gbc.anchor = GridBagConstraints.WEST;
        gbc.insets = new Insets(5, 5, 5, 5);
        midPanel.add(appName, gbc);

        gbc.gridx = 0;
        gbc.gridy = 1;
        gbc.anchor = GridBagConstraints.WEST;
        gbc.insets = new Insets(5, 5, 5, 5);
        midPanel.add(verNum, gbc);

        //add 3 example top panels to midpanel
        gbc.gridx = 0;
        gbc.gridy = 2;
        gbc.anchor = GridBagConstraints.NORTHWEST;
        gbc.insets = new Insets(1,2,1,2);
        gbc.fill = GridBagConstraints.HORIZONTAL;
        gbc.weightx = 1.0;
        midPanel.add(topPanel1, gbc);

        gbc.gridx = 0;
        gbc.gridy = 3;
        gbc.insets = new Insets(1,2,1,2);
        gbc.anchor = GridBagConstraints.NORTHWEST;
        gbc.fill = GridBagConstraints.HORIZONTAL;
        gbc.weightx = 1.0;
        midPanel.add(topPanel2, gbc);

        gbc.gridx = 0;
        gbc.gridy = 4;
        gbc.anchor = GridBagConstraints.NORTHWEST;
        gbc.insets = new Insets(1,2,1,2);
        gbc.fill = GridBagConstraints.HORIZONTAL;
        gbc.weightx = 1.0;
        midPanel.add(topPanel3, gbc);

        //add panel to push other panels to top
        gbc.gridx = 0;
        gbc.gridy = 5;
        gbc.fill = GridBagConstraints.VERTICAL;
        gbc.weighty = 1.0;
        JPanel invisPanel = new JPanel();
        invisPanel.setOpaque(false);
        midPanel.add(invisPanel, gbc);

        frame.getContentPane().add(midPanel);
        frame.pack();
        frame.setVisible(true);
    }

    //test it out
    public static void main(String[] args) {
        new TestGui();
    }

    //class for the top 3 panels
    private class TopPanel extends JPanel {

        private int maxLength;
        private boolean cyclic;

        public TopPanel() {
            initComponents();
            setOpaque(false);
            cyclic = true;
            maxLength = 0;
        }

        @Override
        public void paintComponent(Graphics g) {
            if(isOpaque()) {
                super.paintComponent(g);
                return;
            }

            int width = getWidth();
            int height = getHeight();

            GradientPaint paint = null;

            Color top = new Color(50, 50, 50);
            Color btm = new Color(19, 19, 19);

            paint = new GradientPaint(width / 2, 0, top, width / 2, maxLength > 0 ? maxLength : height, btm, cyclic);

            if(paint == null) {
                throw new RuntimeException("Invalid direction specified in GamerTagPanel");
            }

            Graphics2D g2d = (Graphics2D) g;
            Paint oldPaint = g2d.getPaint();
            g2d.setPaint(paint);
            g2d.fillRect(0, 0, width, height);
            g2d.setPaint(oldPaint);
            super.paintComponent(g);
        }

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(300, 200);  
        }

        private void initComponents() {
            GridBagConstraints gbc;
            JLabel jLabel1 = new JLabel();
            JLabel jLabel2 = new JLabel();

            setBorder(BorderFactory.createLineBorder(new Color(204,204,204)));
            setLayout(new GridBagLayout());

            jLabel1.setFont(new Font("Tahoma", Font.BOLD, 11));
            jLabel1.setForeground(new Color(255, 255, 255));
            jLabel1.setText("Scanning...");
            gbc = new GridBagConstraints();
            gbc.gridx = 0;
            gbc.gridy = 0;
            gbc.anchor = GridBagConstraints.NORTHWEST;
            gbc.insets = new Insets(5, 5, 5, 5);
            add(jLabel1, gbc);

            jLabel2.setFont(new java.awt.Font("Tahoma", Font.BOLD, 11)); 
            jLabel2.setForeground(new java.awt.Color(255, 255, 255));
            jLabel2.setText("C:\\Directory\\Folder\\SubFolder\\SpecificFolder\\File.file");
            gbc = new GridBagConstraints();
            gbc.gridx = 0;
            gbc.gridy = 1;
            gbc.gridwidth = 2;
            gbc.fill = GridBagConstraints.HORIZONTAL;
            gbc.anchor = GridBagConstraints.NORTHWEST;
            gbc.weightx = 1.0;
            gbc.insets = new Insets(5, 5, 5, 5);
            add(jLabel2, gbc);
        }
    }

    public class MidPanel extends JPanel {

        private int maxLength;
        private boolean cyclic;

        public MidPanel() {
            setLayout(new GridBagLayout());
            setOpaque(false);
            maxLength = 0;
            cyclic = false;
        }

        @Override
        public void paintComponent(Graphics g) {
            if(isOpaque()) {
                super.paintComponent(g);
                return;
            }

            int width = getWidth();
            int height = getHeight();

            GradientPaint paint = null;

            Color top = new Color(75, 75, 75);
            Color btm = new Color(19, 19, 19);

            paint = new GradientPaint(width / 2, 0, top, width / 2, maxLength > 0 ? maxLength : height, btm, cyclic);

            if(paint == null) {
                throw new RuntimeException("Invalid direction specified in GamerTagPanel");
            }

            Graphics2D g2d = (Graphics2D) g;
            Paint oldPaint = g2d.getPaint();
            g2d.setPaint(paint);
            g2d.fillRect(0, 0, width, height);
            g2d.setPaint(oldPaint);
            super.paintComponent(g);
        }

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(300, 400);
        }
    }
} 
```

感谢 JoopEggen 指出我在 GradientPaint 上的颜色问题。它帮了大忙。我仍在寻找某人来组合一个更好/更接近的例子。这是我第一次以这种方式覆盖paintComponent。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-22T17:34:56.380

让我们先做一些逆向工程。在此过程中可以进行一些简化。此外，我想说增强应用程序的外观也是可能的，因为第一印象远非积极。

![在此处输入图像描述](../Images/56f260195b0615206148e046632a57f4.png)

基本上可以在该设计背后找到以下元素：

*   渐变
*   正确选择的颜色
*   圆角
*   大纲

![在此处输入图像描述](../Images/ccdeb0f6ad759a37499f6d61a793af78.png)

请注意，圆角、轮廓很重要。顺便说一句，可以优化一些渐变以提供干净和简单的设计。请查看[平面设计与拟物化之间的战斗](http://sachagreif.com/flat-pixels/)以获得更多动力。

您的示例已修改，如下所示（它只是一个视觉结果）：

![在此处输入图像描述](../Images/cd06d3b41b87014b38c65160b49b1ce3.png)

我使用了以下颜色：

![在此处输入图像描述](../Images/b39074db54ae92c3808af800c742bc71.png)

代码：

```
public class TestGui {

    public TestGui() {
        JFrame frame = new JFrame();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        MidPanel midPanel = new MidPanel();
        TopPanel topPanel1 = new TopPanel();
        TopPanel topPanel2 = new TopPanel();
        TopPanel topPanel3 = new TopPanel();

        JLabel appName = new JLabel("MyApplication");
        JLabel verNum = new JLabel("version 1.0");
        Font verFont = new Font("Tahoma", Font.BOLD, 11);
        Font nameFont = new Font("Tahoma", Font.BOLD, 14);

        GridBagConstraints gbc = new GridBagConstraints();

        appName.setForeground(Color.WHITE);
        appName.setFont(nameFont);
        verNum.setForeground(new Color(0xFF9f9f9f));
        verNum.setFont(verFont);

        //add program name and version number
        gbc.gridx = 0;
        gbc.gridy = 0;
        gbc.anchor = GridBagConstraints.WEST;
        gbc.insets = new Insets(5, 5, 5, 5);
        midPanel.add(appName, gbc);

        gbc.gridx = 0;
        gbc.gridy = 1;
        gbc.anchor = GridBagConstraints.WEST;
        gbc.insets = new Insets(5, 5, 5, 5);
        midPanel.add(verNum, gbc);

        //add 3 example top panels to midpanel
        gbc.gridx = 0;
        gbc.gridy = 2;
        gbc.anchor = GridBagConstraints.NORTHWEST;
        gbc.insets = new Insets(1,2,1,2);
        gbc.fill = GridBagConstraints.HORIZONTAL;
        gbc.weightx = 1.0;
        midPanel.add(topPanel1, gbc);

        gbc.gridx = 0;
        gbc.gridy = 3;
        gbc.insets = new Insets(1,2,1,2);
        gbc.anchor = GridBagConstraints.NORTHWEST;
        gbc.fill = GridBagConstraints.HORIZONTAL;
        gbc.weightx = 1.0;
        midPanel.add(topPanel2, gbc);

        gbc.gridx = 0;
        gbc.gridy = 4;
        gbc.anchor = GridBagConstraints.NORTHWEST;
        gbc.insets = new Insets(1,2,1,2);
        gbc.fill = GridBagConstraints.HORIZONTAL;
        gbc.weightx = 1.0;
        midPanel.add(topPanel3, gbc);

        //add panel to push other panels to top
        gbc.gridx = 0;
        gbc.gridy = 5;
        gbc.fill = GridBagConstraints.VERTICAL;
        gbc.weighty = 1.0;
        JPanel invisPanel = new JPanel();
        invisPanel.setOpaque(false);
        midPanel.add(invisPanel, gbc);

        frame.getContentPane().add(midPanel);
        frame.pack();
        frame.setVisible(true);
    }

    //test it out
    public static void main(String[] args) {
        new TestGui();
    }

    //class for the top 3 panels
    private class TopPanel extends JPanel {

        private int maxLength;
        private boolean cyclic;

        public TopPanel() {
            super(true);
            initComponents();
            setOpaque(false);
            cyclic = true;
            maxLength = 0;
        }

        @Override
        public void paintComponent(Graphics g) {
            if(isOpaque()) {
                super.paintComponent(g);
                return;
            }

            int width = getWidth();
            int height = getHeight();

            GradientPaint paint = null;

            //Color top = new Color(50, 50, 50);
            //Color btm = new Color(19, 19, 19);

            Color top = new Color(0xFF222222);
            Color btm = new Color(0xFF0c0c0c);

            paint = new GradientPaint(width / 2, 0, top, width / 2, maxLength > 0 ? maxLength : height, btm, cyclic);

            if(paint == null) {
                throw new RuntimeException("Invalid direction specified in GamerTagPanel");
            }

            Graphics2D g2d = (Graphics2D) g;
            Paint oldPaint = g2d.getPaint();
            g2d.setPaint(paint);
            g2d.fillRect(0, 0, width, height);
            g2d.setPaint(oldPaint);

            super.paintComponent(g);
        }

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(300, 200);
        }

        @Override
        public void paintBorder(Graphics g) {
            Dimension d = getSize();

            g.setColor(new Color(0xFF484848));
            g.drawRoundRect(1, 1, d.width-3, d.height-3, 10, 10);

            g.setColor(Color.BLACK);
            g.drawRoundRect(0, 0, d.width-1, d.height-1, 10, 10);
        }        

        private void initComponents() {
            GridBagConstraints gbc;
            JLabel jLabel1 = new JLabel();
            JLabel jLabel2 = new JLabel();

            setBorder(BorderFactory.createLineBorder(new Color(204,204,204)));
            setLayout(new GridBagLayout());

            jLabel1.setFont(new Font("Tahoma", Font.BOLD, 11));
            jLabel1.setForeground(new Color(255, 255, 255));
            jLabel1.setText("Scanning...");
            gbc = new GridBagConstraints();
            gbc.gridx = 0;
            gbc.gridy = 0;
            gbc.anchor = GridBagConstraints.NORTHWEST;
            gbc.insets = new Insets(5, 5, 5, 5);
            add(jLabel1, gbc);

            jLabel2.setFont(new java.awt.Font("Tahoma", Font.BOLD, 11));
            jLabel2.setForeground(new Color(0xFF9f9f9f));
            jLabel2.setText("C:\\Directory\\Folder\\SubFolder\\SpecificFolder\\File.file");
            gbc = new GridBagConstraints();
            gbc.gridx = 0;
            gbc.gridy = 1;
            gbc.gridwidth = 2;
            gbc.fill = GridBagConstraints.HORIZONTAL;
            gbc.anchor = GridBagConstraints.NORTHWEST;
            gbc.weightx = 1.0;
            gbc.insets = new Insets(5, 5, 5, 5);
            add(jLabel2, gbc);
        }
    }

    public class MidPanel extends JPanel {

        private int maxLength;
        private boolean cyclic;

        public MidPanel() {
            setLayout(new GridBagLayout());
            setOpaque(false);
            maxLength = 0;
            cyclic = false;
        }

//        public void paintBorder(Graphics g) {
//            g.setColor(Color.RED);
//            Rectangle bounds = getBounds();
//            g.drawRoundRect(bounds.x, bounds.y, bounds.width, bounds.height, 10, 10);
//        }

        @Override
        public void paintComponent(Graphics g) {
            if(isOpaque()) {
                super.paintComponent(g);
                return;
            }

            int width = getWidth();
            int height = getHeight();

            GradientPaint paint = null;

            Color top = new Color(0xFF282828);
            Color btm = new Color(0xFF0e0e0e);

            paint = new GradientPaint(width / 2, 0, top, width / 2, maxLength > 0 ? maxLength : height, btm, cyclic);

            if(paint == null) {
                throw new RuntimeException("Invalid direction specified in GamerTagPanel");
            }

            Graphics2D g2d = (Graphics2D) g;
            Paint oldPaint = g2d.getPaint();
            g2d.setPaint(paint);
            g2d.fillRect(0, 0, width, height);
            g2d.setPaint(oldPaint);
            super.paintComponent(g);
        }

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(300, 400);
        }
    }
} 
```

**实现此 UI 的最佳方式**

我认为唯一正确的方法是实现新的 Look&Feel 子集。看看[项目 seaglass](http://code.google.com/p/seaglass/)：

![在此处输入图像描述](../Images/61a3f1bf8ae0fd46f794421721008695.png)

**我用了什么**

所有这些示例都是使用[Inkscape](http://inkscape.org/)准备的——一个开源矢量图形编辑器。你可以下载我的[SVG 源代码](http://renat.in.ua/web/stackoverflow/application-replica.svg)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-22T04:27:30.227

在紧要关头，这是我能想到的最好的。

![渐变面板](../Images/1a9a51651f589d5ad9fb447877ea02ac.png)

### 笔记：

1.  据我所知，线条边框颜色是 74、74、74。我使用了圆形边框，但它的半径比原始示例中显示的要小。
2.  顶部颜色由代码中定义的颜色变亮`offset`（主要是为了让我能**看到**差异！）将其减少到 0 以使颜色更接近出现的颜色并使线条更明显。
3.  文本的颜色似乎是 249,249,249 ( `#F9F9F9`)，但我使用`#B9B9B9`顶部文本，其余部分使用白色。

* * *

```
import java.awt.*;
import javax.swing.*;
import javax.swing.border.*;

class GradientPanels {

    /** An 'offset' to make gradients more obvious. 
     * Reduce to 0 for more subtle effect.  */
    static final int o = 50;
    static final Color borderColor = new Color(74,74,74);

    public static void main(String[] args) {
        Runnable r = new Runnable() {

            @Override
            public void run() {
                JPanel gui = new JPanel(new BorderLayout());

                JPanel main = new GradientPanel(o + 40, 22);
                main.setLayout(new BorderLayout(4, 4));
                JLabel lTop = new JLabel("<html><body><h1 style='color: #B9B9B9'>Up<br>Here");
                main.add(lTop, BorderLayout.PAGE_START);
                main.setBorder(new EmptyBorder(4, 4, 4, 4));

                JPanel center = new GradientPanel(o + 40, 17);
                AbstractBorder b = new CompoundBorder(
                        new LineBorder(borderColor, 1, true),
                        new EmptyBorder(6, 6, 6, 6));
                center.setBorder(b);
                LayoutManager lm = new BoxLayout(center, BoxLayout.Y_AXIS);
                center.setLayout(lm);
                main.add(center, BorderLayout.CENTER);

                addPanel(center, "Virus Shield", o);
                center.add(Box.createRigidArea(new Dimension(10, 10)));
                addPanel(center, "Auto Scan", o);
                center.add(Box.createRigidArea(new Dimension(10, 10)));
                addPanel(center, "My BitDefender", o);
                center.add(Box.createRigidArea(new Dimension(10, 50)));

                gui.add(main, BorderLayout.CENTER);

                JOptionPane.showMessageDialog(null, gui);
            }
        };
        // Swing GUIs should be created and updated on the EDT
        // http://docs.oracle.com/javase/tutorial/uiswing/concurrency/initial.html
        SwingUtilities.invokeLater(r);
    }

    public static void addPanel(JPanel p, String text, int offset) {
        JPanel t = new GradientPanel(offset + 28, 20);
        AbstractBorder b = new CompoundBorder(
                new LineBorder(borderColor, 1, true),
                new EmptyBorder(6, 6, 6, 6));
        t.setBorder(b);
        t.add(new JLabel("<html><body><h2 style='color: #FFFFFF'>" + text));

        p.add(t);
    }
}

class GradientPanel extends JPanel {

    Color top;
    Color btm;

    GradientPanel(int t, int b) {
        top = new Color(t, t, t);
        btm = new Color(b, b, b);
    }

    @Override
    public void paintComponent(Graphics g) {
        super.paintComponent(g);
        Graphics2D g2 = (Graphics2D) g;
        GradientPaint gp = new GradientPaint(0f, 0f, top,
                0f, (float) getHeight(), btm);
        g2.setPaint(gp);
        g2.fillRect(0, 0, getWidth(), getHeight());
    }
} 
```

* * *

## 编辑 1

我的第一个示例中的边框与所需屏幕截图中的边框仍然相去甚远。在[这个答案](https://stackoverflow.com/a/8463742/418556)中，我创建了一个带有更多圆角的自定义边框（“语音气泡”）。

![会话框](../Images/49a61ca3ed27f9b299bb7d4cc2f5135a.png)

不幸的是，该示例对于完全透明的组件（例如`JLabel`. 我还没有时间考虑将其用于不透明组件。

有关进一步讨论，请参阅[带圆角和透明度的边框。](https://stackoverflow.com/q/15025092/418556)

# php - Magento 模块开发 1.7

> ID：14898500
> 
> 赞同：1
> 
> 时间：2013-02-15T15:59:25.750
> 
> 标签：php, module, magento-1.7

我最近开始考虑在 Magento 上进行开发，但是我遇到了一个小小的障碍。这是关于缺乏制作自定义模块的文档。

我找到了很多旧版本的指南，甚至尝试过一个完整的指南，它没有破坏任何东西，但没有任何改变。

1.7 有没有像样的参考资料？Magento 有一种做任何事情的混蛋方式，当我至少第一次这样做时，没有一个框架可以遵循，因为我永远不会去任何地方。

我也试过下载一个模块来看看它是如何构建的，但是现在它们通常太先进了，对我的学习过程没有帮助，所以任何类型的空白数据库表接口模块都是一个完美的参考。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T16:04:00.660

就模块结构而言，版本之间没有太大变化。

学习的一个好方法是使用模块创建器为自己生成一个基本模块，然后对其进行修改：

[http://www.silksoftware.com/magento-module-creator/](http://www.silksoftware.com/magento-module-creator/)

您可以根据要包含的内容选择不同的选项，这是一种学习的好方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T16:04:14.983

这是一个非常简单的基本模块教程，用于创建记录每个产品保存操作的事件观察器：

[http://coding.smashingmagazine.com/2012/03/01/basics-creating-magento-module/](http://coding.smashingmagazine.com/2012/03/01/basics-creating-magento-module/)

这应该让您对编写一个小模块有一个初步的了解。一般来说，您可以在网上找到的 Magento 1.5 或 1.6 的大多数示例也可以在 1.7 中轻松运行

# sql - Oracle SQL 中的排序问题

> ID：14898503
> 
> 赞同：0
> 
> 时间：2013-02-15T15:59:29.640
> 
> 标签：sql, oracle

当我使用以下查询时

```
select model from client_source order by model; 
```

结果数据按此顺序

```
model
______
1234
4g
default
unknown
default1
ipad
iphone simulator
ipod touch
iphone
ipod
test 
```

但我希望按以下顺序排序

```
model
________

1234
4g
default
default1
ipad
iphone
iphone simulator
ipod
ipod touch
test
unknown 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T16:25:23.820

我想你的[`NLS_SORT`](http://docs.oracle.com/cd/E11882_01/server.112/e25513/initparams153.htm#REFRN10127)参数是`BINARY`. 在`BINARY`排序中，字符串按照它们的二进制表达式排序，这意味着大写字母将排在小写字母之前：

```
SQL> alter session set nls_sort=binary;

Session altered

SQL> select model from client_source order by model;

MODEL
--------------------
1234
4g
Default
Unknown
default1
ipad
iphone
iphone simulator
ipod
ipod touch
test 
```

`NLS_SORT`您可以使用不同的值更改此行为。使用带后缀的[值`NLS_SORT`](http://docs.oracle.com/cd/E11882_01/server.112/e10729/applocaledata.htm#i637232)`_CI`使其不区分大小写：

```
SQL> alter session set nls_sort=latin_ci;

Session altered

SQL> select model from client_source order by model;

MODEL
--------------------
Default
default1
ipad
iphone
iphone simulator
ipod
ipod touch
test
Unknown
1234
4g 
```

您可以使用 移动前面的数字`CASE`：

```
SQL> SELECT model
  2    FROM client_source
  3   ORDER BY CASE WHEN regexp_like(model, '^[[:digit:]]')
  4                    THEN 0
  5                    ELSE 1
  6            END,
  7            model;

MODEL
--------------------
1234
4g
Default
default1
ipad
iphone
iphone simulator
ipod
ipod touch
test
Unknown 
```

此外，您可以使用该[`NLSSORT`](http://docs.oracle.com/cd/E11882_01/server.112/e26088/functions113.htm#SQLRF00678)函数来修改单个查询的排序首选项：

```
select model from client_source order by NLSSORT(model, 'NLS_SORT = LATIN_CI'); 
```

# java - 使用 JERSEY 设置重复的 REST 服务

> ID：14898512
> 
> 赞同：0
> 
> 时间：2013-02-15T16:00:01.563
> 
> 标签：java, jersey

我有一个使用 JERSEY 的工作 REST 设置。对于一组不同的实体，我需要几乎相同的功能。我需要做什么来克隆这个当前的功能？

```
@Path("/will")
public class FileResource {

private final BlobstoreService blobstoreService = BlobstoreServiceFactory.getBlobstoreService();
private final BlobInfoFactory blobInfoFactory = new BlobInfoFactory();

/* step 1\. get a unique url */

@GET
@Path("/url")
public Response getCallbackUrl() {
  /* this is /_ah/upload and it redirects to its given path */
  String url = blobstoreService.createUploadUrl("/rest/will");
  return Response.ok(new FileUrl(url), MediaType.APPLICATION_JSON).build();
}

/* step 2\. post a file */

@POST
@Consumes(MediaType.MULTIPART_FORM_DATA)
public void post(@Context HttpServletRequest req, @Context HttpServletResponse res) throws IOException, URISyntaxException {
  Map<String, BlobKey> blobs = blobstoreService.getUploadedBlobs(req);
  BlobKey blobKey = blobs.get("files[]");
  res.sendRedirect("/rest/will/" + blobKey.getKeyString() + "/meta");
}

.... 
```

我可以简单地复制这个类并将意志改为其他东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T16:07:21.420

泽西岛没有什么神奇之处，你可以像往常一样超类。例如：

```
public class BaseResource
{

  @GET
  @Path("/url")
  public Response getCallbackUrl() {
    // Default code goes here
  }
}

@Path("/will")
public class WillResource extends BaseResource
{
  // Overrides go here
}

@Path("/abc")
public class AbcResource extends BaseResource
{
  // Overrides go here
} 
```

这将为您提供 /will/url 和 /abc/url 的响应

# asp.net - 如何区分二进制序列化以存储和序列化以跨应用程序域传递对象

> ID：14898519
> 
> 赞同：2
> 
> 时间：2013-02-15T16:00:13.363
> 
> 标签：asp.net, .net, serialization, portable-class-library

我正在使用可移植类库将我的框架代码从 .NET 4.0 移植到 4.5。我遇到的一件事是缺少 SerializableAttribute，我用它来启用二进制序列化以将对象存储在 asp.net 会话状态中。我见过有人建议使用 DataContract 作为替代方案，但这对 BinaryFormatter 没有帮助。

基本上我有2个场景：

*   我想将对象存储在会话状态（进程外）

*   我希望能够将它们序列化为 XML 的 JSON 以通过网络发送它们

什么是一个好的解决方案，可以让我两者兼得？

# javascript - 单击时需要将本地数组传递给函数

> ID：14898522
> 
> 赞同：0
> 
> 时间：2013-02-15T16:00:18.550
> 
> 标签：javascript, arrays, function

我正在编写一个菜单系统，当用户单击特定行时，我需要调用一个函数。我正在使用新函数来传递调用该​​函数的 div 以及用户单击的行。一切都很好，直到我尝试将本地数组传递给函数。如果我执行以下操作：

```
for (i=0;i<tmpdropnumber;i++){
    var dv=document.getElementById(id+i);
    dv.style.cursor="pointer";  
    dv.onmouseover = new Function('dropover'+"('" + id + "','" + i + "')");
    dv.onmouseout = new Function('dropout'+"('" + id + "','" + i + "')");
    dv.onclick = new Function('dropclick'+"('" + id + "','" + i + "','"+tmparray1+"','"+tmparray2+"')");
} 
```

正如您所期望的，数组作为字符串传递。我可以重建函数中的数组，但这似乎不优雅。

如果我尝试以下操作：

```
for (i=0;i<tmpdropnumber;i++){
    var dv=document.getElementById(id+i);
    dv.style.cursor="pointer";  
    dv.onmouseover = new Function('dropover'+"('" + id + "','" + i + "')");
    dv.onmouseout = new Function('dropout'+"('" + id + "','" + i + "')");
    dv.onclick = new Function('dropclick'+"('" + id + "','" + i + "',"+tmparray1+","+tmparray2+")");
} 
```

试图传递它崩溃的数组。关于如何实现这一目标的任何想法？我在我的代码中使用 jquery，所以使用 javascript 或 jquery 解决方案就可以了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T16:03:25.803

代替

```
dv.onclick = new Function('dropclick'+"('" + id + "','" + i + "','"+tmparray1+"','"+tmparray2+"')"); 
```

尝试

```
dv.onclick = function() {
    dropclick(id, i, tmparray1, tmparray2);
}; 
```

**编辑**

将您的声明包装在匿名函数中：

```
(function(id, i) {
    dv.onclick = function() {
        dropclick(id, i, tmparray1, tmparray2);
    };
} (id, i)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T16:05:25.350

不要使用新功能。

您遇到了问题，因为在构建字符串时，数组正在变成字符串。

绕过 toString() 的基本思想

```
for (i=0;i<tmpdropnumber;i++){
    var dv=document.getElementById(id+i);
    dv.style.cursor="pointer";
    (function(id, i){  
        dv.onmouseover = function(){ dropover(id,i); };
        dv.onmouseout = function(){ dropout(id,i); };
        dv.onclick = function(){ dropclick(id,i, tmparray1, tmparray2); };
    })(id,i);
} 
```

但实际上没有必要传入一个对象 id。

您始终可以使用`this`来获取当前行并且表上有rowIndex。哎呀，您可以在桌子上拥有一个事件处理程序，并使用 table/tbody 上的处理程序来捕获冒泡并使用 target/srcElement。

# java - 在java中计算组合

> ID：14898523
> 
> 赞同：0
> 
> 时间：2013-02-15T16:00:30.037
> 
> 标签：java, combinatorics

我正在尝试用Java编写一个算法来计算板球比赛中击球手的最佳顺序，基于他们在每个顺序中的经验。

我有一个包含 11 个列表的列表。11 个名单中的每一个都包含球队中的所有 11 名击球手，按他们在这个位置上的比赛次数排名。

所以第一个列表会从在第一位置上玩最多游戏的玩家开始，到在第一位置玩最少游戏的玩家结束。第二个列表从在第二位置上玩最多游戏的玩家开始，到在第二位置玩最少游戏的玩家结束。ETC..

我想要做的是找到击球手的组合，每个列表中一个，这样可以最大限度地减少列表中球员位置的总和。如果所有玩家都只玩过一场游戏，那么这很容易，每个列表的顶级玩家。然而，有些玩家在多个榜单上名列前茅，而其他玩家可能不在任何榜单上。

我意识到这可能需要很多循环，计算这个最有效的方法是什么？如果您需要更多信息，请询问..对不起，这有点令人困惑......

这会是11吗！组合？啊啊啊啊啊

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T16:28:00.407

Guava 方法[Collections2.permutations](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Collections2.html#permutations%28java.util.Collection%29) 为您计算所有可能的排列（11！），执行所有循环，您只需要评估结果。

编辑：为了检查内存消耗，运行以下测试（这需要一些时间，但你不应该得到 OutOfMemoryError）：

```
public class Perm {
    public static void main(String[] args) {
        List<String> list = Arrays.asList("1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11");
        Collection<List<String>> permutations = Collections2.permutations(list);
        for (List<String> strings : permutations) {
            String s = strings.toString();
            System.out.println(s);
        }
    }
} 
```

# javascript - Ember.js 从控制器获取数据

> ID：14898528
> 
> 赞同：0
> 
> 时间：2013-02-15T16:00:42.277
> 
> 标签：javascript, ember.js

我有一个控制器，我在其中定义`TakenSeatNumbers`变量：

```
TravelClient.TourSeatsController = Ember.ObjectController.extend({
  selectSeat: function(seat) {
    var orderTransaction = TravelClient.store.transaction();
    var takenSeatNumber = orderTransaction.createRecord(TravelClient.TakenSeatNumber, {number: seat.get('id')});
  }
}); 
```

如何`TakenSeatsNumbers`从`tour/seats`模板访问？该模型`Tour`在`TourSeatsController`.

* * *

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T17:07:13.837

根据我的评论，将该函数变量 ( `takenSeatsNumber`) 提升为控制器内的一个属性，以便它是公共的，类似于以下内容：

```
TravelClient.TourSeatsController = Ember.ObjectController.extend({
  takenSeatNumber: null, 
  selectSeat: function(seat) {
    var orderTransaction = TravelClient.store.transaction();
    this.set('takenSeatNumber', 
             orderTransaction.createRecord(TravelClient.TakenSeatNumber, {number: seat.get('id')})
    );
  }
}); 
```

# python - 如何在 Python 中创建自定义数据对象？

> ID：14898537
> 
> 赞同：0
> 
> 时间：2013-02-15T16:01:03.453
> 
> 标签：python, windows, data-objects

我正在寻找 .NET`DataObject`类的 Python 替代品，因此我可以设置数据，然后将 DataObject 复制到剪贴板。伪代码：

```
dataobject = DataObject()
dataobject.setdata('SomeKey', 'SomeValue')
dataobject.setdata('SomeKey2', 'SomeValue2')
dataobject.copy_to_clipboard() 
```

有没有这方面的图书馆？

# javascript - 对 ie6 用户隐藏 CSS 和 HTML？

> ID：14898538
> 
> 赞同：2
> 
> 时间：2013-02-15T16:01:07.683
> 
> 标签：javascript, jquery, html, css, internet-explorer

我试图强迫我的 ie6 用户在查看我的网站时升级到现代浏览器。因为修改所有内容以适用于 ie6 太费时了。由于一切看起来都坏了，我宁愿隐藏整个 CSS + HTML，只显示一个弹出式浏览器。我的问题是，如果用户使用的是 ie6，如何将所有元素设置为不显示？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-15T16:03:18.620

```
<!--[if IE 6]>
    Special instructions for IE 6 here
<![endif]--> 
```

例子：

```
<!--[if IE 6]>
    <style type="text/css">
         #browserWarning { display:block; }
         /* hide content here */
     </style>
<![endif]--> 
```

[http://www.quirksmode.org/css/condcom.html](http://www.quirksmode.org/css/condcom.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T16:36:51.607

您可以将其添加到页面顶部的 head 元素中，以将用户重定向到特定页面。

```
if (navigator.userAgent.match(/MSIE/i)) {
    document.location.replace("/ie6warning.html");
} 
```

# c++ - 将垫子转换为关键点？

> ID：14898540
> 
> 赞同：1
> 
> 时间：2013-02-15T16:01:16.913
> 
> 标签：c++, opencv, type-conversion, computer-vision, surf

我正在将描述符（SurfDescriptorExtractor 输出）和关键点（SurfFeatureDetector 输出）写入 XML 文件。在将关键点（std::vector）转换为 Mat 之前完成（如下：[将关键点转换为 mat 或将它们保存到文本文件 opencv](https://stackoverflow.com/questions/7643342/convert-keypoints-to-mat-or-save-them-to-text-file-opencv/14898185)）。因为描述符不是必需的，它们已经是 Mat 了。所以两者都保存为Mat，阅读也没有问题。但是当使用 FlannBasedMatcher，然后使用 drawMatches 时，此方法要求提供关键点数据。

问题是：如何将 Mat 转换为 Keypoint 的向量，哪种方法最好？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T17:53:32.403

这就是[opencv 源代码](https://github.com/Itseez/opencv)在**Java**中进行转换的方式，我在 C++ 中找不到这种转换，它可能不存在。你也许可以把它翻译成 C++，它不是很复杂。

```
 //Code from Opencv4Android: utils/Converters.java
 public static void Mat_to_vector_KeyPoint(Mat m, List<KeyPoint> kps) {
        if (kps == null)
            throw new java.lang.IllegalArgumentException("Output List can't be null");

        int count = m.rows();
        if (CvType.CV_64FC(7) != m.type() || m.cols() != 1)
            throw new java.lang.IllegalArgumentException(
                    "CvType.CV_64FC(7) != m.type() ||  m.cols()!=1\n" + m);

        kps.clear();
        double[] buff = new double[7 * count];
        m.get(0, 0, buff);

        for (int i = 0; i < count; i++) {
            kps.add(new KeyPoint((float) buff[7 * i], (float) buff[7 * i + 1], (float) buff[7 * i + 2], (float) buff[7 * i + 3],
                    (float) buff[7 * i + 4], (int) buff[7 * i + 5], (int) buff[7 * i + 6]));
        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-16T04:09:36.273

刚刚通过查看 OpenCV 源代码（在 /modules/java/generator/src/cpp/converters.cpp 下，第 185 行附近）发现了这一点：

```
void Mat_to_vector_KeyPoint(Mat& mat, vector<KeyPoint>& v_kp)
{
    v_kp.clear();
    CHECK_MAT(mat.type()==CV_32FC(7) && mat.cols==1);
    for(int i=0; i<mat.rows; i++)
    {
        Vec<float, 7> v = mat.at< Vec<float, 7> >(i,0);
        KeyPoint kp(v[0], v[1], v[2], v[3], v[4], (int)v[5], (int)v[6]);
        v_kp.push_back(kp);
    }
    return;
} 
```

我将其用作：

```
vector<KeyPoint> mat_to_keypoints(Mat* mat) {

    vector<KeyPoint>  c_keypoints;

    for ( int i = 0; i < mat->rows; i++) {
        Vec<float, 7> v = mat.at< Vec<float, 7> >(i,0);

        KeyPoint kp(v[0], v[1], v[2], v[3], v[4], (int)v[5], (int)v[6]);

        c_keypoints.push_back(kp);

    };

    return c_keypoints;

}; 
```

# c++ - 静态方法中的结构初始化 - 代码安全

> ID：14898541
> 
> 赞同：-2
> 
> 时间：2013-02-15T16:01:16.963
> 
> 标签：c++, static

我有以下代码：

```
typedef struct
{
    string name;
    int length;
}myStruct;

static myStruct getname()
{
    static myStruct name;

    if (name.length == 0)
    {
        name.value = "BLABLA";
            name.length = name.value.size();
    }

    return &name;
} 
```

这段代码安全吗？？即我可以保证在构造之后`myStruct name`，`name.length`将等于0

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T16:02:50.533

是的，有点，因为静态变量是零初始化的。但是，您的代码不是线程安全的。最好说`static myStruct name = initName();`，这将保证只执行一次。

由于两次存储字符串长度也没有意义，因此您的整个代码可以简化为：

```
static std::string const & getName()
{
    static std::string impl("BLABLA");
    return impl;
} 
```

甚至：

```
static const char * const name = "BLABLA"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T16:04:08.807

是的，`name.length`将是 0。

注意：您返回`&name`的是指向 a 的指针，`myStruct`而您的代码被声明为仅返回 a`myStruct`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T16:04:45.840

```
struct myStruct {
    string name;
    int length;
    myStruct(string name = "") : name(name), length(name.size()) {} 
};

static myStruct getname() {
    static myStruct name("BLABLA");
    return name;
} 
```

使用构造函数初始化列表，这样更安全。这里长度被初始化为名称的大小，默认为大小 == 0 的空字符串。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-15T16:08:12.423

这里有不同的“安全”概念。

目前的代码是安全的，因为静态变量被初始化为零。（*[更多信息](https://stackoverflow.com/questions/3373108/why-are-static-variables-auto-initialized-to-zero)*）

但是，我不认为它是“安全的”，因为初始化并不明显。
如果另一个程序员试图修改这段代码，他们可能没有意识到初始化为零的重要性，以及关键字`name.length`保证初始化的事实。`static`

编写的代码*看起来*好像没有初始化，但实际上它是。我认为至少您需要添加评论：

```
/* structure is initialized to all-zeros because it is static */
static myStruct name; 
```

# rdf - 将 SPARQL 查询限制为某种类

> ID：14898542
> 
> 赞同：2
> 
> 时间：2013-02-15T16:01:19.817
> 
> 标签：rdf, sparql, owl, rdfs

我有一个 SPARQL 查询来选择在 dbpedia 数据库中具有“加利福尼亚”位置的所有资源：

```
select distinct ?subj where {
 ?subj dbpprop:location dbpedia:California .
} LIMIT 100 
```

现在我的问题是过滤这个结果，这样我只能得到`?subj`某个类的子类，例如`dbpedia:Public_company`.

我试过了。像这样：

```
select distinct ?subj where {
 ?subj a dbpedia:Public_company .
 ?subj dbpprop:location dbpedia:California .
} LIMIT 100 
```

但这会导致结果集为空。

如何将其限制`?subj`为来自某种类型的类？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-16T00:17:06.363

您的查询是限制某个类的实例的正确方法。如果你得到一个空的结果集，那仅仅意味着没有找到实例。我在 DBPedia 中短暂查看了一下，没有遇到任何`dbpedia:Public_company`. 可能你的类名有错别字。

# c# - 如何在 WPF 中获取以像素为单位的 Grid 列宽？

> ID：14898545
> 
> 赞同：5
> 
> 时间：2013-02-15T16:01:21.967
> 
> 标签：c#, wpf, width, pixels

列宽以不同方式指定（星号、自动等） 如何获取特定列的宽度（以像素为单位）？

```
GridLength l=tip.basis.ColumnDefinitions[0].Width; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T16:06:35.107

您可以使用元素的`ActualWidth`or`ActualHeight`属性来获取元素的宽度/高度。 [这个答案](https://stackoverflow.com/questions/607827/what-is-the-difference-between-width-and-actualwidth-in-wpf)描述了“实际宽度”和“宽度”之间的区别。

所以在上面的例子中，它将是：

```
Double width = tip.basis.ColumnDefinitions[0].ActualWidth; 
```

还要记住，WPF 使用与设备无关的像素，如[本答案](https://stackoverflow.com/questions/4153227/device-independent-pixel)中所述。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-15T16:06:41.237

该`ActualWidth`属性应以像素为单位提供列的宽度

[MSDN 页面](http://msdn.microsoft.com/en-us/library/system.windows.controls.columndefinition.actualwidth.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T16:06:01.900

使用[ActualWidth](http://msdn.microsoft.com/en-us/library/system.windows.controls.datagridcolumn.actualwidth.aspx)属性获取宽度。它代表

> 列的宽度，以与设备无关的单位（每单位 1/96 英寸）表示。

# javascript - 从后面的 vb.net 代码调用在外部 javascript 函数中定义的函数（.html 不是 .aspx）

> ID：14898549
> 
> 赞同：0
> 
> 时间：2013-02-15T16:01:36.157
> 
> 标签：javascript, asp.net, vb.net

我有一个普通`.html`页面，其中包含一个`hiddenField`和一个对`External.js`. 由于我正在实现 using `ASP.NET`，服务器端将首先执行。但是，我需要`External.js`在服务器代码执行之前执行一个函数。该解决方案可通过以下代码获得：

*****在 .aspx 中*******

 **```
<script src="External.js" type="text/javascript"></script>
<asp:ScriptManager ID="ScriptManager1" runat="server" EnablePageMethods="true" />` 
```

**在 .aspx.vb 中**

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
Try
If Not Page.IsPostBack Then
ScriptManager.RegisterStartupScript(Me, Me.GetType(), "register", "MyFunction();", True)
End If
Catch ex As Exception
MsgBox(ex.Message)
End Try
 End Sub 
```

当我使用`.aspx`页面时，代码可以完美运行。显然，我不能`ASP.NET`在纯`.html`页面中使用任何服务器控件。所以`<asp:ScriptManager>`在`.html`页面中使用是行不通的。我怎样才能在一个页面中做同样的事情**。**`.html`中应该定义什么`.html page`以及如何从后面的代码中调用该函数，请记住我不能使用任何`<asp:>`控件。

好的，所以我想要做的是我有 my `External.js`which 具有`populateHidden()`基本上为 my 设置值的功能`hiddenField`。

```
function populateHidden()
{
document.getElementByID('Hidden').value = "abcdefg";
} 
```

我还有另一个函数`PassData()`，它基本上初始化`ajax request`服务器以将值传递`Hidden`给后面的代码（使用 webMethod）。问题是我想`populateHidden()`先执行，以便`passData()`传递`abcdefg`（在`populateHidden()`执行之后）到后面的代码以将值存储在数据库中。所以目前我运行这两个功能的方式如下。

**在 .html 中**

`<body onload="PassData()">`

**在代码隐藏中**

由于服务器端首先执行`populateHidden();`，因此尝试继续执行。`Page_Load`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T16:22:52.080

我不确定我是否理解正确。但是，如果您想以与您相同的方式调用脚本，您只需要这样做：

```
<body onload="MyFunction();"> 
```

完整版：

```
<html>
    <head>
        <meta charset="UTF-8">
        <title>Document</title>
        <script src="External.js" type="text/javascript"></script>
    </head>
    <body onload="MyFunction();">
    ...
    </body>
</html> 
```

是吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T16:51:52.003

我从@Cleydson 的回答中借用了这个：

**JS**

```
function MyFunction()
{
    populateHidden();
    PassData();
} 
```

**HTML**

```
<html>
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <script src="External.js" type="text/javascript"></script>
</head>
<body onload="MyFunction();">
...
</body> 
```

现在你`populateHidden()` **以前打电话** `PassData()`**

# ruby-on-rails - 使用 em-websocket gem 无法将连接更改为 'ws://' RUBY

> ID：14898554
> 
> 赞同：0
> 
> 时间：2013-02-15T16:02:01.137
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, websocket, em-websocket

我是Ruby的新手。

我正在尝试使用 WebSocket 连接。所以我使用 em-websocket gem。我也使用瘦网络服务器。我做了一切就像例子告诉我的那样。所以请帮帮我。

但服务器不断返回我：

```
HTTP/1.1 200 OK
Content-Type: text/html; charset=utf-8
X-UA-Compatible: IE=Edge
ETag: "7592ed842deb971babc6640ff75207fb"
Cache-Control: max-age=0, private, must-revalidate
X-Request-Id: f2d12b00aa2eb202b24c309ce0570da0
X-Runtime: 0.008190
Connection: close
Server: thin 1.5.0 codename Knife 
```

客户要求：

```
GET /home/webSocket HTTP/1.1
Upgrade: websocket
Connection: Upgrade
Host: localhost:3000
Origin: http://localhost:3000
Pragma: no-cache
Cache-Control: no-cache
Sec-WebSocket-Key: i6Efmjpxmz2GOFpjduxoyA==
Sec-WebSocket-Version: 13
Sec-WebSocket-Extensions: x-webkit-deflate-frame 
```

客户端代码：

```
$(document).ready(
    function() {
        ws = new WebSocket("ws://localhost:3000/home/webSocket");
        ws.onopen = function() {
          alert('open');
          ws.send("hello server");
        };
        ws.onmessage = function(evt) { alert(evt.data); };
        ws.onclose = function() { alert('close'); };

    }); 
```

这是服务器端代码：

```
def webSocket
    require "rubygems"
    require "em-websocket"

    EventMachine.run {
     EventMachine::WebSocket.start(:host => "0.0.0.0", :port => 8000) do |ws|
     ws.onopen { |handshake|
       puts "WebSocket opened #{{
          :path => handshake.path,
          :query => handshake.query,
          :origin => handshake.origin,
        }}"

        ws.send "Hello Client!"
      }
      ws.onmessage { |msg|
        ws.send "Pong: #{msg}"
      }
      ws.onclose {
        puts "WebSocket closed"
      }
      ws.onerror { |e|
        puts "Error: #{e.message}"
      }
      end
    }
  end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T16:12:18.633

EventMachine 正在侦听端口 8000： `EventMachine::WebSocket.start(:host => "0.0.0.0", :port => 8000)`但您正在尝试连接到端口 3000：`ws = new WebSocket("ws://localhost:3000/home/webSocket");`

将其更改为连接到端口 8000：

`ws = new WebSocket("ws://localhost:8000/home/webSocket");`

`/home/webSocket`尽管除非您特别想传递给 EventMachine ，否则不需要额外的路径。

# database - 使用 SQLite 在给定深度的数据库表中查找闭包

> ID：14898555
> 
> 赞同：1
> 
> 时间：2013-02-15T16:02:02.643
> 
> 标签：database, sqlite, closures, transitive-closure-table

我有下表：（我正在使用 sqlite）

```
.schema T 
CREATE TABLE T (i TEXT, j TEXT, v INTEGER);

select * from T;

i |j |v
x |y |1
x |z |1
y |a |1
z |b |1
a |c |1
c |d |1 
```

我需要找到`i`给定深度的特定闭包。但是，对于 SQLite，我不能使用递归查询。我尝试编写一个查询，但无法有效地调用它以获得所需的结果：

```
sqlite> Select i,j,v  FROM T WHERE i='x'

...> union

...> SELECT R.i "i",T.j "j",R.v+t.v "v" FROM T JOIN T as R ON R.j=T.i where R.i='x';

i|j|v
x|a|2
x|b|2
x|y|1
x|z|1 
```

这列出了深度为 2 的所有闭包。但在我的特定用例中，我需要允许深度为 8 的闭包。

使用这种类型的查询，我可以尝试：

```
SELECT   i,j,v FROM T WHERE i='x'

union

SELECT R.i "i",T.j "j",R.R.x+T.v "x" FROM T JOIN (SELECT R.i,T.j,R.v+T.v "x" FROM T JOIN T AS 
R ON R.j=T.i where R.i='x') AS R ON R.j=T.i where R.i='x'

union

SELECT R.i "i",T.j "j",R.v+T.v "x" FROM T JOIN T AS R ON R.j=T.i where R.i='x';

i|j|v
x|a|2
x|b|2
x|c|3
x|y|1
x|z|1 
```

这将返回深度为 3 的闭包，但有冗余的选择查询。有没有更好的方法来找到闭包？

# python - 如何克隆一个类？

> ID：14898556
> 
> 赞同：-1
> 
> 时间：2013-02-15T16:02:04.977
> 
> 标签：python, deep-copy

我有以下课程

```
class CommandList( HasTraits ):

    command_nr = Int    

    command_code = Int    

    command_name = Str

    status = Int       

    settings = None #It will be a list[dic{list[]}] 
```

我`copy.deepcopy`用来克隆类

```
a = copy.deepcopy(b) 
```

但是当我更改设置变量时，`a`它会影响`b`变量。似乎 deepcopy 没有克隆这个变量。我读到可以覆盖该`__deepcopy__`功能。这是个好主意吗？我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T16:15:40.683

我相信这是有记录的：

```
import copy

class Ex(object):
    clvar='foo'
    def __init__(self,i):
        self.i=i

    def __repr__(self):
        return 'clvar={}, self.i={}'.format(self.clvar,self.i)

ex1=Ex(1)
ex2=Ex(2)

excopy1=copy.deepcopy(ex1) 
excopy2=copy.deepcopy(ex2)     

print ex1,ex2   

print excopy1,excopy2

excopy1.i=22
excopy1.clvar='bar'

print ex1,excopy1

class Ex2(Ex):
    pass

ex2_2=Ex2(222)

print ex2_2 
```

印刷：

```
clvar=foo, self.i=1 clvar=foo, self.i=2
clvar=foo, self.i=1 clvar=foo, self.i=2
clvar=foo, self.i=1 clvar=bar, self.i=22
clvar=foo, self.i=222 
```

“复制”类定义的唯一方法是通过继承。您可以使用 deepcopy 复制实例，但最好编写一个复制方法来处理实例详细信息。

# intellij-idea - Intellij - 在文件中来回移动

> ID：14898557
> 
> 赞同：11
> 
> 时间：2013-02-15T16:02:18.477
> 
> 标签：intellij-idea

是否可以使用热键在类或文件中来回导航......而不是在文件之间？

我知道来回是可能的，但现在这在全球范围内发生，使用所有文件。我只想在这个文件的位置之间跳转。

应该不难添加，只需过滤当前活动文件的历史堆栈。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-15T16:17:03.053

不可以。但可以转到最后编辑的位置。如果您需要它 - 您可以在[JetBrains tracker](http://youtrack.jetbrains.com/)上编写功能请求。 ![在此处输入图像描述](../Images/8b0c7e8fc3b99f8b18c5350ae81b867b.png)

**UPD 2019** 实际上有相对较新的快捷键 Ctrl + Shift + E 来显示最近的位置。 [![在此处输入图像描述](../Images/aae26873cba22588be55697feeb140c0.png)](https://i.stack.imgur.com/yNLEs.png)

# random - 需要为 Highcharts 系列生成随机数据

> ID：14898566
> 
> 赞同：0
> 
> 时间：2013-02-15T16:02:46.987
> 
> 标签：random, highcharts

我正在尝试为我的 Highcharts 系列生成一些随机数据点，但我遇到了数据函数的问题。[**这是我的代码（从Fiddle**](http://jsfiddle.net/cnTqS/1/)简化）：

```
series : {
    name : 'Total Mentions',
    type:'spline',
    lineWidth:1,
    data : (function() {
        var arr = [];
        for(var i = 0; i < 500; i++) {
            var date = randomDate(new Date(2004, 0, 9), new Date());
            var randNum = Math.round(Math.random()*100);
            var finalDate = "Date.UTC(" + date.getFullYear() + ", " + date.getDate() + ", " + date.getMonth() + ")";
            arr.push([finalDate, randNum]);
        }
        return arr;
    })()
},
[...etc...], 
```

应该出现的格式应该是这样的：

```
[Date.UTC(2008, 23, 8),56], 
[Date.UTC(2012, 12, 6),21],
[Date.UTC(2008, 22, 10),16],
[Date.UTC(2009, 17, 7),25],
[...etc...], 
```

现在，我的页面没有加载图表。该页面将无限加载，就好像它无法识别数据一样。

有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T18:11:19.173

您应该在数组中以毫秒为单位推送日期，如下所示；

```
 arr.push([date.getTime(), randNum]);
   arr.sort(function (a,b) { if (a[0] < b[0]) return -1; if (a[0] > b[0]) return 1; 
   return 0; })  
   return arr; 
```

我创造了一个小提琴; [http://jsfiddle.net/hkskoglund/cnTqS/4/](http://jsfiddle.net/hkskoglund/cnTqS/4/)

尝试在 Chrome devtools 的控制台中捕获其他语法错误。

# php - 如何使用 mysqli_multi_query() 从 SELECT 查询中获取结果集？

> ID：14898569
> 
> 赞同：1
> 
> 时间：2013-02-15T16:02:52.780
> 
> 标签：php, mysqli, resultset, mysqli-multi-query

我的查询是：

```
CREATE TEMPORARY TABLE `hcaconsumptions_temp` (
    `DeviceID` INT (11) NOT NULL,
    `TimeStamp` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    `Consumption` FLOAT NOT NULL,
    `DeviceBrand` VARCHAR (255) CHARACTER
SET utf8 COLLATE utf8_unicode_ci NOT NULL,
 `SerialNumber` VARCHAR (255) CHARACTER
SET utf8 COLLATE utf8_unicode_ci NOT NULL
) ENGINE = MyISAM DEFAULT CHARACTER
SET = utf8 COLLATE = utf8_unicode_ci;

INSERT INTO hcaconsumptions_temp 
    (DeviceBrand, SerialNumber, `TIMESTAMP`, Consumption) 
    VALUES
    ('Adunos','24100008','2013-01-14 19:39:48','157'),
    ('Adunos','24100010','2013-01-14 18:50:38','134'),
    ...
    ('Adunos','24100019','2013-01-14 18:40:58','117'),
    ('Adunos','24100020','2013-01-14 18:42:22','74');

UPDATE hcaconsumptions_temp
SET DeviceID = (
    SELECT
        DeviceID
    FROM
        hcadevices
    WHERE
        hcadevices.DeviceBrand = hcaconsumptions_temp.DeviceBrand
    AND hcadevices.SerialNumber = hcaconsumptions_temp.SerialNumber
);

SELECT
    count(DeviceID)
FROM
    hcaconsumptions_temp
WHERE
    DeviceID = '0'; 
```

正如您在最后看到的那样，有`SELECT`查询，但我无法得到结果。

可能是因为之前有 3 个查询，所以它给出了错误。我如何得到结果？

我的 PHP 代码是：

```
$test_result = mysqli_multi_query($link, $multi_test_query);
$count = mysqli_fetch_assoc($test_result);
print_r($count); 
```

给出的警告是：

> `mysqli_fetch_assoc() expects parameter 1 to be mysqli_result, boolean given`

此代码给出了 2 个错误：

```
$test_result = mysqli_multi_query($link, $multi_test_query);
$count = mysqli_fetch_assoc($test_result);
echo mysqli_error();
print_r($count); 
```

> **警告**：mysqli_fetch_assoc() 期望参数 1 为 mysqli_result，布尔值在**C:\Program Files (x86)\EasyPHP-12.1\www\App\php\post\excel_yukle.php**第**123行**
> 
> **警告**：mysqli_error() 需要 1 个参数，0在第**124**行的**C:\Program Files (x86)\EasyPHP-12.1\www\App\php\post\excel_yukle.php中给出**

 **编辑：我试过这个：

```
/* execute multi query */
if (mysqli_multi_query($link, $multi_test_query)) {
    do {
        /* store first result set */
        if ($result = mysqli_store_result($link)) {
            while ($row = mysqli_fetch_row($result)) {
                printf("%s\n", $row[0]);
            }
            mysqli_free_result($result);
        }
        /* print divider */
        if (mysqli_more_results($link)) {
            printf("-----------------\n");
        }
    } while (mysqli_next_result($link));
} 
```

结果是：

```
-----------------
-----------------
-----------------
46
<br />
<b>Strict Standards</b>:  mysqli_next_result(): There is no next result set. Please, call mysqli_more_results()/mysqli::more_results() to check whether to call this function/method in <b>C:\Program Files (x86)\EasyPHP-12.1\www\HCAWebApp\php\post\excel_yukle.php</b> on line <b>136</b><br /> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-03-18T02:11:33.837

您第一次编码尝试的错误是因为您正在存储`mysqli_multi_query()`as的布尔结果，`$test_result`然后尝试`$test_result`输入`mysqli_fetch_assoc()`. 您打算将查询结果发送到 fetching 函数，但这不是使用 multi_query 完成的方式 - 这是一个可以理解的混乱与`mysqli_query()`工作方式。

[这是手册](http://php.net/manual/en/mysqli.multi-query.php)中的重要引述：

> 要从第一个查询中检索结果集，您可以使用`mysqli_use_result()`或`mysqli_store_result()`。所有后续查询结果都可以使用`mysqli_more_results()`和进行处理`mysqli_next_result()`。

...此引用还涉及您第二次发布尝试的问题，该尝试仅检查`mysqli_next_result($link)`. 明确遵循手册的说明意味着编写以下`while`条件：

```
} while(mysqli_more_results($link) && mysqli_next_result($link)); 
```

OP 提供/选择的答案是无法找到解决方案的解决方法。这整个`$i`业务应该被删除；[您在任何mysqli 文档页面](http://www.php.net/manual/en/mysqli.summary.php)都看不到此类工作。

在您正在运行的查询中，只有其中一个应该有记录集。

```
CREATE TEMPORARY TABLE //returns true/false. *structural, no rows in this case.

INSERT //returns true/false. *mysqli_affected_rows if desired.

UPDATE //returns true/false. *mysqli_affected_rows if desired.

SELECT //returns record set.  *max of 1 row in this case. 
```

我提出的解决方案是：

```
if (mysqli_multi_query($link, $multi_test_query)) {
    do {
        if ($result = mysqli_store_result($link)) { // record set was generated for this query
            $satirsayisi = mysqli_fetch_row($result)[0];
            mysqli_free_result($result);
        }
    } while (mysqli_more_results($link) && mysqli_next_result($link));
}
if ($hata = mysqli_error($link)) {
    echo "Error / hata: $hata";  // don't display error messages when site is public
} else {
    echo "Number of lines / satır sayısı: $satirsayisi";
} 
```

如果有任何错误，`$hata`将被回显。

如果您的 SELECT 查询成功，`$satirsayisi`您的计数值将回显到屏幕上。

其他建议/要点：

Fetching From Single-Value-Result: using`mysqli_fetch_row()[0]`可以在一行中完成工作；不需要while循环。

循环`mysqli_multi_query()`：参考文档使用`DO WHILE`循环，以便始终在第一次迭代时进入循环，并在每次迭代结束时检查条件语句。

如果任何查询有任何错误，`mysqli_multi_query`将停止执行后续查询——这就是函数的设计方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T16:55:01.063

我已经解决了。

```
$i = 1;
if (mysqli_multi_query($link, $multi_test_query)) {
    while(mysqli_next_result($link)) {
        /* store first result set */
        if ($result = mysqli_store_result($link)) {
            while ($row = mysqli_fetch_row($result)) {
                //printf("%s\n", $row[0]);
                if($i==3) $satirsayisi = $row[0];
            }
            mysqli_free_result($result);
        }
        /* print divider */
        if (mysqli_more_results($link)) {
            //printf("-----------------\n");
        }

        $i = $i + 1;
        if($i>3) break;
    }
}

echo $satirsayisi; 
```**

# java - 如何在java中获取当前活动窗口（父和子）的标题

> ID：14898571
> 
> 赞同：1
> 
> 时间：2013-02-15T16:02:54.843
> 
> 标签：java, passwords, window

我正在开发一个 passPro 应用程序，我想要一个当前活动窗口的标题，如 Adob​​e reader、Ms word、excel、access 等。当我单击特定应用程序时，所有具有密码保护的应用程序“输入密码” “像子窗口被打开。我想要那个子窗口标题。我正在开发应用程序，当我打开任何受密码保护的文件应用程序（如访问、word、pdf 或 PPT）时，它会自动从我的访问数据库中检测密码。

# javascript - 使用 jquery 点击获取 div-class id

> ID：14898572
> 
> 赞同：0
> 
> 时间：2013-02-15T16:02:56.793
> 
> 标签：javascript, jquery, html, google-chrome-extension

如果这听起来太简单，请耐心等待。

我正在编写一个 chrome 扩展程序，一旦用户右键单击页面中的对象，就会出现上下文菜单，并且他可以选择获取单击的 div 类的 ID + 对其进行评分。

我已经为此工作了几天，并设法将额外的按钮添加到上下文菜单中。一旦点击了这些按钮中的任何一个，就会记录页面的源。本来可以花更少的时间来做这件事，但这是我第一次用 javascript 编写，我一直卡在这个过程中。

无论如何，我不想要页面的整个 html 代码，而是点击的 div 类。我在谷歌搜索后发现最好的方法是使用 jquery 的“html”函数而不是纯 javascript。问题是它对我不起作用。

这是我的代码：

BackgroundPage（这里一切似乎都很好）

```
 function genericOnClick(tab) 
    {
        console.log(tab.pageUrl);

        chrome.tabs.getSelected(null, function(tab) 
        {
            chrome.tabs.sendMessage(tab.id, {action: "getSource"}, function(source) {
            console.log(source);
            });
        });

    }

    // Create a parent item and two children.
    var parent1 = chrome.contextMenus.create({"title": "Rank Trigger", "contexts":["all"]});

    var child1 = chrome.contextMenus.create
    (

    {"title": "Rank 1", "contexts":["all"], "parentId": parent1, "onclick": genericOnClick}
);
var child2 = chrome.contextMenus.create
(
    {"title": "Rank 2", "contexts":["all"], "parentId": parent1, "onclick": genericOnClick}
);
var child3 = chrome.contextMenus.create
(
    {"title": "Rank 3", "contexts":["all"], "parentId": parent1, "onclick": genericOnClick}
); 
```

ContentPage：（这里有问题）

```
chrome.extension.onMessage.addListener(function(request, sender, callback) 
{
    if (request.action == "getSource")
    {
     // callback(document.documentElement.outerHTML); //here i can get the page's whole source, I only want the clicked div class
     callback($('div class).html(); <--- something wrong here
    }

  }); 
```

清单文件：

```
{
  "name": "x",
  "description": "x",
  "version": "0.1",
  "permissions": ["contextMenus", "tabs"],
  "content_scripts": 
  [
    {
      "matches": ["http://*/*","https://*/*"],
      "js": ["jquery.js", "content.js"],
      "run_at": "document_end"
    }
  ],
  "background": 
  {
    "scripts": ["background.js"]
  },
  "manifest_version": 2
} 
```

有任何想法吗？我再次知道我的问题看起来很简单，但我是自学所有这些，并且出于某种原因，我发现 Web 编程比应用程序编程更难一些。

非常感谢。

**编辑**：只是为了澄清我想要的 html 源代码是这样的： `<div class="story reviewed-product-story" data-story-id="488481648"....</div>`。我想要这个 div 类，以便我可以解析它以获取数据故事 ID。如果有一种方法可以在不先获取 div 类的情况下获取 ID，那么它也可以工作（甚至可能更可取）

**编辑**：感谢 Adeneo，我现在可以获得页面源中第一个 div 类的 ID，但不能获得点击的 ID。在我拥有的东西上向前迈进了一步，但并不完全是我需要的东西。也许我必须在使用 $('.story').data('story-id') 之前获取点击的 div 的来源。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T16:08:32.040

我猜应该是：

```
chrome.extension.onMessage.addListener(function(request, sender, callback) {
    console.log('message listener');
    if (request.action == "getSource") {
        callback( $('.story').data('story-id') );
    }
}); 
```

# python - 在不添加新日期的情况下重新采样盘中 pandas DataFrame

> ID：14898574
> 
> 赞同：9
> 
> 时间：2013-02-15T16:03:00.657
> 
> 标签：python, pandas, time-series

我想在不添加新日期的情况下对一些日内数据进行下采样

```
df.resample('30Min') 
```

将添加周末等，这是不可取的。有没有办法解决？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-17T07:53:54.840

组合的 groupby/resample 可能会起作用：

```
In [22]: dates = pd.date_range('01-Jan-2014','11-Jan-2014', freq='T')[0:-1]
    ...: dates = dates[dates.dayofweek < 5]
    ...: s = pd.TimeSeries(np.random.randn(dates.size), dates)
    ...: 

In [23]: s.size
Out[23]: 11520

In [24]: s.groupby(lambda d: d.date()).resample('30min').size
Out[24]: 384

In [25]: s.groupby(lambda d: d.date()).resample('30min')
Out[25]: 
2014-01-01  2014-01-01 00:00:00    0.202943
            2014-01-01 00:30:00   -0.466010
            2014-01-01 01:00:00    0.029175
            2014-01-01 01:30:00   -0.064492
            2014-01-01 02:00:00   -0.113348
            2014-01-01 02:30:00    0.100408
            2014-01-01 03:00:00   -0.036561
            2014-01-01 03:30:00   -0.029578
            2014-01-01 04:00:00   -0.047602
            2014-01-01 04:30:00   -0.073846
            2014-01-01 05:00:00   -0.410143
            2014-01-01 05:30:00    0.143853
            2014-01-01 06:00:00   -0.077783
            2014-01-01 06:30:00   -0.122345
            2014-01-01 07:00:00    0.153003
...
2014-01-10  2014-01-10 16:30:00   -0.107377
            2014-01-10 17:00:00   -0.157420
            2014-01-10 17:30:00    0.201802
            2014-01-10 18:00:00   -0.189018
            2014-01-10 18:30:00   -0.310503
            2014-01-10 19:00:00   -0.086091
            2014-01-10 19:30:00   -0.090800
            2014-01-10 20:00:00   -0.263758
            2014-01-10 20:30:00   -0.036789
            2014-01-10 21:00:00    0.041957
            2014-01-10 21:30:00   -0.192332
            2014-01-10 22:00:00   -0.263690
            2014-01-10 22:30:00   -0.395939
            2014-01-10 23:00:00   -0.171149
            2014-01-10 23:30:00    0.263057
Length: 384

In [26]: np.unique(_25.index.get_level_values(1).minute)
Out[26]: array([ 0, 30])

In [27]: np.unique(_25.index.get_level_values(1).dayofweek)
Out[27]: array([0, 1, 2, 3, 4]) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-17T03:12:46.260

现在最简单的解决方法可能是这样的：

```
rs = df.resample('30min')
rs[rs.index.dayofweek < 5] 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-09-26T02:22:48.063

可能最简单的方法是事后做一个`dropna`来摆脱空行，例如

```
df.resample('30Min').dropna() 
```

# javascript - Highcharts 不呈现小数据集

> ID：14898579
> 
> 赞同：2
> 
> 时间：2013-02-15T16:03:24.983
> 
> 标签：javascript, highcharts, highstock

我有一个要渲染的数据集，这主要是为了探索控件。但是，我注意到如果我渲染的数据只跨越几个小时，图表将不会绘制任何东西。如果我在几天内跨越数据，那么它将绘制。我已经尝试调整两者`tickInterval (5)`，`pointInterval (3600 * 1000)`但我似乎无法让它绘制出来。任何人都可以提供任何可能的建议吗？谢谢！

```
window.chart = new Highcharts.StockChart({
    chart: {
        renderTo: 'container',
        zoomType: 'x'
    },
    rangeSelector: {
        selected: 1
    },

    title: {
        text: 'AAPL Stock Price'
    },
    xAxis: {
        type: 'datetime',
        pointInterval: 1000
    },

    series: [{
        name: 'AAPL Stock Price',
        data: [
                [Date.UTC(2006, 0, 29, 0, 0, 0), 30.14],
                [Date.UTC(2006, 0, 29, 0, 0, 0), 33.11],
                [Date.UTC(2006, 0, 29, 1, 0, 0), 34.76],
                [Date.UTC(2006, 0, 29, 1, 0, 0), 23.12],
                [Date.UTC(2006, 0, 29, 2, 0, 0), 34.34],
                [Date.UTC(2006, 0, 29, 2, 0, 0), 34.48],
                [Date.UTC(2006, 0, 29, 3, 0, 0), 33.9],
                [Date.UTC(2006, 0, 29, 3, 0, 0), 14.72]
            ]
    }]
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T16:50:03.593

您有多个具有[相同 x 值](http://jsfiddle.net/PYVmj/)的数据点：

```
[Date.UTC(2006, 0, 29, 0, 0, 0), 30.14],
[Date.UTC(2006, 0, 29, 0, 0, 0), 33.11], 
```

这些都是从 2006 年 1 月 29 日午夜开始的。如果您将它们[全部设为不同的时间](http://jsfiddle.net/PYVmj/1/)，它将呈现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T17:09:00.727

如果您想在同一日期绘制数据点，您还可以创建一个额外的系列。

```
series: [
{
    name: 'AAPL Stock Price',
    data: [
        [Date.UTC(2006, 0, 29, 0, 0, 0), 30.14],
        [Date.UTC(2006, 0, 29, 1, 0, 0), 34.76],
        [Date.UTC(2006, 0, 29, 2, 0, 0), 34.34],
        [Date.UTC(2006, 0, 29, 3, 0, 0), 33.9]
    ]
},{
    name: 'AAPL Stock Price 2',
    data: [
        [Date.UTC(2006, 0, 29, 0, 0, 0), 33.11],
        [Date.UTC(2006, 0, 29, 1, 0, 0), 23.12],
        [Date.UTC(2006, 0, 29, 2, 0, 0), 34.48],
        [Date.UTC(2006, 0, 29, 3, 0, 0), 14.72]
    ]
}] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-18T09:42:12.623

我建议禁用 dataGrouping，[http: //api.highcharts.com/highstock#plotOptions.series.dataGrouping](http://api.highcharts.com/highstock#plotOptions.series.dataGrouping)

# javascript - jquery 切换高度和更改按钮值

> ID：14898582
> 
> 赞同：0
> 
> 时间：2013-02-15T16:03:31.503
> 
> 标签：javascript, jquery, toggle

我有这个默认为 500px 高度的 div (#world)。当我单击#world div应该动画并减小到200px高度的按钮时，我还有一个值为“open”的按钮，同时按钮值将更改为“close”。

需要一些帮助:(我已经用谷歌搜索了这个，但我真的不明白怎么做。是的，我是新手 :)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T16:16:23.350

这是你想要达到的目标吗？

演示：http: [//jsfiddle.net/FRBhz/](http://jsfiddle.net/FRBhz/)

```
$(document).ready(function() {
    $('button').click(function() {
        this.value = (this.value == 'open') ? 'close' : 'open';
        var new_height = ($('#world').height() == 500) ? 200 : 500;
        $('#world').animate({
            height: new_height
        });
    })
}); 
```

# c - 这个递归 GCD 函数是否正确？

> ID：14898583
> 
> 赞同：-2
> 
> 时间：2013-02-15T16:03:33.033
> 
> 标签：c, recursion

一切都为我的程序编译并完美运行。我不得不编写一个递归 GCD 函数。然而，我使用了两个函数，gcdRecursive 和 gcd。我可以将此代码压缩成一个函数，这样我下面的代码中就不需要 gcd 函数了吗？或者我的代码是否正确，并且这两个功能都是必需的。

```
void gcdRecursive(int *x, int *y, int i){
  if (i >= 1) {
    if (*x % i == 0 && *y % i == 0) {
        printf("The GCD of %d and %d is %d", *x, *y, i); 
    } 
    else {
        gcdRecursive(x, y, i - 1);
    }
  }
}
void gcd(int *x, int *y){
  getValuesForGCD(x, y);
  gcdRecursive(x, y, *x);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T16:05:51.660

是的，它是正确的，但到目前为止还不是最理想的。

编辑：尝试使用这个：

```
if (x > y) 
  gcd(x,y) = gcd(y, x);
if (y % x == 0)
  gcd(x, y) = x;
else 
  gcd(x, y) = gcd(x, y%x) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T16:50:08.863

更紧凑的形式可能是

```
int getGcd(int num1, int num2)
{
    int remainder;

    if(num2 != 0)
        remainder = (num1 % num2);
    return ((num2 == 0) ? num1: getGcd(num2, remainder));
} 
```

# java - 远程 XA JMS 连接

> ID：14898587
> 
> 赞同：2
> 
> 时间：2013-02-15T16:03:42.577
> 
> 标签：java, jboss, jms, xa

是否可以在 JBoss AS 7 上提供和查找事务性连接工厂？标准的“RemoteConnectionFactory”似乎不是事务性的（XA），我不知道如何使其成为 XA 或如何定义某种可以从远程客户端使用的 XARemoteConnectionFactory。

我尝试添加`<xa>true</xa>`元素（在 hornetq 配置中有效，但在 jboss 配置文件中是非法的）并尝试创建`<pooled-connection-factory>`类似“java:/jmsXA”的元素（但我无法在上下文中查找它，即使使用用于导出的正确名称）。

# jquery - 当我在“每个”中“克隆”时，为什么会丢失原始元素？

> ID：14898589
> 
> 赞同：0
> 
> 时间：2013-02-15T16:03:46.837
> 
> 标签：jquery, jquery-1.8, jquery-clone

我正在尝试制作自己的`clone`功能，但遇到了问题。我可以自己使用 jQuery 的`clone`函数而不会出现这样的问题：`

```
$.prototype.cloneDumpingEvents = function () {
    return $(this).clone();
}; 
```

（或者，在行动中看到它：http: [//jsfiddle.net/Shawn/dCm59/2/](http://jsfiddle.net/Shawn/dCm59/2/)）

但是，如果我尝试使其适用于元素集合（添加`each`），它将删除原始：

```
$.prototype.cloneDumpingEvents = function () {
    return this.each(function() {
        $(this).clone();
    });
}; 
```

（或者，在行动中看到它：http: [//jsfiddle.net/Shawn/dCm59/3/](http://jsfiddle.net/Shawn/dCm59/3/)）

为什么第二个版本删除了原版？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T16:05:29.690

因为您要返回原件而不是克隆。改用这个：

```
$.fn.cloneDumpingEvents = function () {

    var collection = $();

    this.each(function() {
        collection = collection.add( $(this).clone() );
    });

    return collection;
}; 
```

这是你的小提琴：http: [//jsfiddle.net/dCm59/4/](http://jsfiddle.net/dCm59/4/)

* * *

正如@FabrícioMatté 在评论中指出的那样，[`.map`](http://api.jquery.com/map/)要短得多：

```
$.fn.cloneDumpingEvents = function () {
    return this.map(function() {
        return $.clone(this);
    });
}; 
```

这是你的小提琴：http: [//jsfiddle.net/dCm59/7/](http://jsfiddle.net/dCm59/7/)

# ruby-on-rails - 在 Rails 中显示主题属于某个主题的标签

> ID：14898591
> 
> 赞同：0
> 
> 时间：2013-02-15T16:03:49.080
> 
> 标签：ruby-on-rails, associations

我不知道这个功能应该叫什么......所以我只能描述基本场景：topic has_many tags through :tagging tag has_many topic through :tagging

所以，在@topic 显示页面中，我想显示所有具有属于@topic 的标签的主题（不具有相同的标签，只有一个常见的标签）

一种可能的方法是

```
tags.each do |tag|
  tag.topics.each do |topic|
    topic
  end
end 
```

但这会导致主题重复，因为一个主题可能属于不同的标签

我发现可以`ids.uniq`用来删除数组中的重复项。那么这会是一个解决方案吗？我怎样才能得到`topic_ids`？也许`topic_ids= topic_ids + topic.id`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T16:11:18.310

这将为您提供所有与相关联的 tag_id 匹配的主题`@topic`。请注意，这也将包括原始`@topic`：

```
topics = Topic.joins(:taggings).
               where(:taggings => {:tag_id => @topic.taggings.pluck(:tag_id) }).
               uniq 
```

如果要排除原始内容，只需`where`在链中添加一个附加项：

```
where("taggings.topic_id != ?", @topic.id) 
```

使用子查询而不是初始数据库调用来获取关联的 s 有一种更有效的方法`tag_id`，但这可能就足够了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T16:28:44.800

我更喜欢acts_as_taggable_on 然后我使用

```
<%= raw @topic.find_related_tags.map { |t| link_to(t.title, topic_path(t)}.join(" ") %> 
```

# android - 有没有办法在屏幕关闭后以编程方式找到让您的手机保持清醒的应用程序？

> ID：14898594
> 
> 赞同：0
> 
> 时间：2013-02-15T16:04:01.163
> 
> 标签：android, android-wake-lock

有没有办法在屏幕关闭后以编程方式找到让您的手机保持清醒的应用程序？

我需要检测哪些应用程序保持唤醒状态，以便为用户做一些统计？

例如，在 2 月 11 日 13:44，应用 X 保持唤醒状态 20 分钟。ETC

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T16:34:25.447

这可能是[How can I see which wakelocks are active](https://stackoverflow.com/questions/5780280/how-can-i-see-which-wakelocks-are-active)的转贴，这是关于唤醒锁的真正彻底的讨论。本质上，您可以从 running 的转储中收集唤醒锁信息`adb shell dumpsys power`。

# c - 自动将 C 源代码翻译成 C89 或 C90

> ID：14898600
> 
> 赞同：3
> 
> 时间：2013-02-15T16:04:28.087
> 
> 标签：c, visual-studio, gcc, code-translation

所以我正在研究这个 C/C++ 库，我正在使用 GNU 编译器，它支持最新的 C 和 C++ 标准。

我想让我的库与仅支持 C89/C90 的 VC++ 编译器兼容，而不是允许在函数体内的其他语句之后进行变量声明的较新的 C 标准。

有没有我可以使用的工具，可以在函数体的开头声明我的所有变量？

我的图书馆很大，有一个工具来完成这项任务将使这个过程变得容易。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T02:26:54.643

对不起，反答案，但 Visual C++ 不是 C 编译器。它可能是一些旧的、过时的（准确地说是 22 年过时的）语言的编译器，而不是 C。你应该做的最好的事情是建议那些要求你提供这种支持的人，并要求他们切换编译器而不是使用损坏的编译器。

如果这个解决方案真的超出您的选择（不是），那么您可以寻找类似的主题： [How to compile c99-to-c89 converter with clang？](https://stackoverflow.com/questions/13475775/how-to-compile-c99-to-c89-convertor-with-clang) [https://github.com/libav/c99-to-c89/](https://github.com/libav/c99-to-c89/)

如果您认为我所说的没有意义，请再想一想：这是一个 22 年过时的 C 编译器。想想世界各地的人们为支持它所付出的努力和金钱。

编辑：顺便说一句，那是 C： [http ://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf](http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf)

[http://www.open-std.org/jtc1/sc22/wg14/www/standards](http://www.open-std.org/jtc1/sc22/wg14/www/standards)

# javascript - 从完全限定的字符串中获取 JSON 属性

> ID：14898610
> 
> 赞同：0
> 
> 时间：2013-02-15T16:05:14.533
> 
> 标签：javascript, json

假设我有一个这样的 JSON 对象：

```
var a = {
  "b" : {
    "c" : 1
  }
} 
```

当我知道字符串 "bc" 时，有没有一种快速的方法来获取 c ？

我想我可以将字符串按点拆分，然后从中向下钻取到 c，但我希望有一种快速的方法可以一次性做到这一点。

就像我希望的那样，`var c = a["b.c"]`但这不起作用

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T16:12:06.593

正如您建议使用拆分的那样，这样的事情怎么样：

```
var a = {
  "b" : {
    "c" : 1
  }
}

var n = "b.c".split(".");
var x = a;
for(var i = 0; i < n.length; i++){
   x = x[n[i]];
}
//x should now equal a.b.c 
```

[这是一个工作示例](http://jsfiddle.net/qg7rD/)

* * *

如果路径无效，则应进行一些额外检查。正如我上面的代码，`x`如果`undefined`路径的最后部分无效（例如“bd”）。如果路径的任何其他部分无效（例如“dc”），则 javascript 将出错。

这是一个修改后的示例，它将在 的第一个实例处结束循环`undefined`，这将保持`x`原样`undefined`并确保 javascript 可以继续执行（没有错误！）...

```
var n = "d.c".split(".");
var x = a;
for (var i = 0; i < n.length; i++) {
    x = x[n[i]];
    if (typeof(x) == "undefined") {
        break;
    }
} 
```

[这是一个实际的例子](http://jsfiddle.net/qg7rD/2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T16:12:36.893

```
var a = {
  "b" : {
    "c" : 1
  }
}

var c = "b.c".split(".").reduce(function(obj, key) {
    return obj[key];
}, a);

alert(c) 
```

见[减少](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/Reduce)。该链接还显示了如何为不支持 ES5 的浏览器实现 shim。请注意，此代码已简化，假设键存在于对象中。

# java - 扫描仪 nextLine 被跳过

> ID：14898617
> 
> 赞同：0
> 
> 时间：2013-02-15T16:05:26.980
> 
> 标签：java

所以这是我正在使用的代码：

```
System.out.println("Create a name.");
name = input.nextLine();
System.out.println("Create a password.");
password = input.nextLine(); 
```

但是当它到达这一点时，它只会说“创建一个名称”。和“创建密码”。两者同时，然后我必须输入一些东西。所以它基本上跳过了我需要输入字符串的扫描仪部分。在“创建名称”之后。和“创建密码”。打印出来，然后我输入，名称和密码都更改为我输入的内容。我该如何解决这个问题？

这是全班。我只是在测试，所以它实际上并不是一个程序：

```
package just.testing;

import java.util.Scanner;
public class TestingJava
{
    static int age;
    static String name;
    static String password;
    static boolean makeid = true;
    static boolean id = true;

    public static void main(String[] args){
        makeid(null);
        if(makeid == true){
            System.out.println("Yay.");
        }else{

        }
    }
    public static void makeid(String[] args){
        System.out.println("Create your account.");
        Scanner input = new Scanner(System.in);
        System.out.println("What is your age?");
        int age = input.nextInt();
        if(age<12){
            System.out.println("You are too young to make an account.");
            makeid = false;
            return;
        }
        System.out.println("Create a name.");
        name = input.nextLine();
        System.out.println("Create a password.");
        password = input.nextLine();
        return;
    }
} 
```

对不起我的语法不好。我不是英国人，所以我很难解释这一点。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-15T16:16:38.043

nextInt() 吃掉了输入数字，但没有吃掉 EOLN：

```
Create your account.
What is your age?
123 <- Here's actually another '\n' 
```

所以在创建名称后第一次调用 nextLine() 接受它作为输入。

```
System.out.println("Create a name.");
name = input.nextLine(); <- This just gives you "\n" 
```

用户 Integer.parseInt(input.nextLine()) 或在读取数字后添加另一个 input.nextLine() 将解决此问题：

```
int age = Integer.parseInt(input.nextLine()); 
```

或者

```
int age = input.nextInt();
input.nextLine() 
```

另请参阅[此处](https://stackoverflow.com/questions/7056749/scanner-issue-when-using-nextline-after-nextxxx)以获取重复的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T16:17:22.787

这实际上并没有告诉您为什么要跳过这些行，但是当您捕获名称和密码时，您可以使用控制台：

```
Console console = System.console();
String name = console.readLine("Create a name.");
char[] password = console.readPassword("Create a password.");
System.out.println(name + ":" + new String(password)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T16:20:31.097

您也可以使用 next() 代替 nextLine()。我已经在eclipse中测试过了。它工作正常。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-08-19T09:48:40.837

`next()`可以工作，但它不会读取空格后的字符串。

# vb.net - DataSet/DataGridView 将选定列设置为变量 .VB

> ID：14898620
> 
> 赞同：0
> 
> 时间：2013-02-15T16:05:32.423
> 
> 标签：vb.net, datagridview, datatable

是否可以将选定的数据网格视图列名称设置为变量。

我的代码示例。

```
 Dim cmevoids As DataTable = ds.Tables(0)
    Dim test As String
    test = "event_code"

    Dim Query = From payments In cmevoids.AsEnumerable() _
                Where payments.Field(Of String)("event_code") = "MB120117"
                Where payments.Field(Of String)("event_transaction_status") = "PAID"
    Order By payments.Field(Of String)("event_code") _
                Select New With {.event_code = payments.Field(Of String)(test), _
                                        .event_transaction_status = payments.Field(Of String)("event_transaction_status"), _
                                        .event_transaction_detail_amount = payments.Field(Of String)("event_transaction_detail_amount")}
    dgvQuery.DataSource = Query.ToList() 
```

我想获取用户从第一个数据网格视图的组合框中选择的 w/e 列，并将其显示在第二个数据网格视图中以供查询。

我可以让它搜索并显示由测试变量给出的变量选择的表。但我无法将查询数据网格视图中的列名更改为变量的名称。我只能将它命名为硬编码，在本例中为 event_code、event_transaction_status 和 event_transaction_detail_amount。

有什么方法可以在没有硬代码但变量的情况下做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T18:07:57.227

像你一样填充gridview，然后在绑定后更改它呢？

```
Dim Result as string = "w/e column the user selects from a combo box"
Dim i as integer = 0 'your colum index
GridView1.Columns(i).HeaderText = Result 
```

# iphone - 如何判断ios用户是否登录了twitter？

> ID：14898621
> 
> 赞同：0
> 
> 时间：2013-02-15T16:05:34.873
> 
> 标签：iphone, ios, twitter

我想确定用户是否登录了 twitter，所以我可以提示他们发布推文，但前提是他们设置了 ios 和 twitter。另外，有没有办法用默认推文设置推特屏幕？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-15T16:12:15.720

对于 iOS 5.x，您可以使用以下命令检查用户是否已登录 twitter：

```
[TWTweetComposeViewController canSendTweet] 
```

至于显示带有默认消息的推文屏幕，您可以执行以下操作：

```
TWTweetComposeViewController *tweetSheet = [[TWTweetComposeViewController alloc] init];
[tweetSheet setInitialText:defaultMsg];
[self presentModalViewController:tweetSheet animated:YES]; 
```

您可以参考[本教程](https://www.google.co.in/url?sa=f&rct=j&url=http://www.raywenderlich.com/5519/beginning-twitter-in-ios-5&q=&esrc=s&ei=R14eUeOjKcOGrAefmYH4BA&usg=AFQjCNEswAPlSErP2wNlAEpq-pu4hspV8w)了解更多信息。

**编辑：**对于`iOS 6.0`及以上，使用：

```
// requires "Social.framework"
[SLComposeViewController isAvailableForServiceType:SLServiceTypeTwitter] 
```

因此，一个示例用法可能是：

```
if([SLComposeViewController isAvailableForServiceType:SLServiceTypeTwitter])
    {
        SLComposeViewController *controller = [SLComposeViewController composeViewControllerForServiceType:SLServiceTypeTwitter];

        SLComposeViewControllerCompletionHandler myBlock = ^(SLComposeViewControllerResult result){
            [controller dismissViewControllerAnimated:YES completion:Nil];
        };
        controller.completionHandler = myBlock;
        [controller setInitialText:@"#myHashTag"];
        [controller addImage:myImage];
        [self presentViewController:controller animated:YES completion:Nil];
    }
    else
    { /* Show error alert, etc*/ } 
```

[进一步阅读](https://developer.apple.com/library/ios/documentation/NetworkingInternet/Reference/SLComposeViewController_Class/Reference/Reference.html#//apple_ref/occ/clm/SLComposeViewController/isAvailableForServiceType%3a)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T16:16:16.780

正如我在评论中所说，如果您使用的是 IOS 5 或更高版本，只需添加`Twitter.framework`到您的项目中即可

```
#import <Twitter/Twitter.h>

//post tweets
- (IBAction)postTapped:(id)sender{

    if ([TWTweetComposeViewController canSendTweet])
    {
        TWTweetComposeViewController *tweetSheet = [[TWTweetComposeViewController alloc] init];
        [tweetSheet setInitialText:@" #hashtag"];

        [self presentModalViewController:tweetSheet animated:YES];
    }
    else
    {

        TWTweetComposeViewController *viewController = [[TWTweetComposeViewController alloc] init];

        //hide the tweet screen
        viewController.view.hidden = YES;

        //fire tweetComposeView to show "No Twitter Accounts" alert view on iOS5.1
        viewController.completionHandler = ^(TWTweetComposeViewControllerResult result) {
            if (result == TWTweetComposeViewControllerResultCancelled) {
                [self dismissModalViewControllerAnimated:NO];
            }
        };
        [self presentModalViewController:viewController animated:NO];

        //hide the keyboard
        [viewController.view endEditing:YES];
    }

} 
```

# google-search-console - 使用网站管理员工具仅获取 100 个抓取问题

> ID：14898623
> 
> 赞同：2
> 
> 时间：2013-02-15T16:05:40.923
> 
> 标签：google-search-console

我正在使用 Feed crawlIssues = wtr.GetCrawlIssues(encodedSiteID); 从我的网站管理员工具帐户中获取抓取错误。有超过 5k 个错误，但上面的代码只检索前 100 个。如何检索所有错误？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-12-12T11:10:12.197

我遇到了和你一样的问题，我也只有前 100 个错误。基本上，由于站长工具中的一个错误，它只显示了 100 个批次的错误。

据我所知，它没有内置的解决方案，但有一种解决方法。您可以使用提供的 ExecRequest.exe 命令行工具通过 http 请求访问数据，而不是使用 GetCrawlIssues 函数。基本用法是：

ExecRequest cl QUERY [http://www.google.com/webmasters/tools/feeds/example_site.com/crawlissues/?start-index=1&max-results=100](http://www.google.com/webmasters/tools/feeds/example_site.com/crawlissues/?start-index=1&max-results=100) example@gmail.com mypassword

这将输出生成的 XML 到控制台。您可以指定起始点和要下载的错误数：
?start-index=startIndex
&max-results=100
您可以将 max-result 值设置为您想要的任何值，但它最多只能下载 100 个项目。
批量下载后，可以从下载的xml文件中获取数据。

如果你只需要数据，我还用 Python 写了一个小脚本，你可以在[这里查看](https://github.com/fulibacsi/SmallProjects/tree/master/GData_Crawl_Error)，非常简单。

# wolfram-mathematica - 数学简化分母

> ID：14898624
> 
> 赞同：1
> 
> 时间：2013-02-15T16:05:42.843
> 
> 标签：wolfram-mathematica, expression, simplify

在这个代数表达式中，如何强制 Mathematica 首先计算一个公共

分母，然后简化：

```
(32768 Sqrt[\[Pi]] Va)/((7/b^2 + 2/mua^2)^(3/2) mua^3) +
  (32 Sqrt[\[Pi]] Va)/((b^2 + mua^2)^(3/2) (2/b^2 + 1/(b^2 + mua^2))^(3/2)) 
  + (6144 Sqrt[\[Pi]] Va)/((b^2 + mua^2)^( 3/2) (3/b^2 + 1/(b^2 + mua^2))^(3/2)) 
```

表情太长了，这只是一部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T15:16:39.867

利用

```
Together[ (your expression here) ] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T21:22:39.953

对于这个表达式，它与 Together[] 和 Apart[] 一起使用。但是对于具有 50 个这样的术语的更大的表达式，我使用了 Expand[expression]//Factor，然后再次 Expand[expression] 来分隔这些术语。

# android - 管理不同 XML 文件中的按钮

> ID：14898627
> 
> 赞同：0
> 
> 时间：2013-02-15T16:05:51.077
> 
> 标签：android, android-layout

我的项目中有两个xml文件，“main.xml”和“newn.xml”。main.xml 中具有 id button1 和 newn.xml 中的 button2 的按钮。

我想单击 button1 并转到 newn 布局文件并在单击 button2 时返回主布局。

```
Button b = (Button) findViewById(R.id.button1);
    b.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub
            setContentView(R.layout.newn);
        }
    });
    Button b1 = (Button) findViewById(R.id.button2);
b1.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub
            setContentView(R.layout.main);
        }
    }); 
```

但有一个运行时错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T16:31:59.210

您不能以这种方式简单地切换布局。

如果你想显示一个新的布局，你需要使用 Fragments、对话框或启动一个新的 Activity。

按照本教程学习如何开始一项新活动。

[http://developer.android.com/training/basics/firstapp/starting-activity.html](http://developer.android.com/training/basics/firstapp/starting-activity.html)

# css - 两次 last-child 电话，一个有效，另一个无效

> ID：14898631
> 
> 赞同：0
> 
> 时间：2013-02-15T16:06:06.527
> 
> 标签：css

我在这里有我的代码：http: [//jsfiddle.net/u9BsD/2/](http://jsfiddle.net/u9BsD/2/)

您将看到第二部分 #indoorRange 正在应用最后一个子对象，将最后一个框向右推，并将宽度扩大 1%。第一部分#membership 完全相同，但有三个块，但最后一个子类没有影响它应该影响的元素。是否有一些关于我不知道的最后一个孩子规则的规则？

感谢您的帮助。

```
<div id="memberships">
<div class="greyHeading">
    <header>
         <h3>Individual Membership:</h3>

    </header>
    <p>$175.00</p>
</div>
<div class="greyHeading">
    <header>
         <h3>Family Membership:</h3>

    </header>
    <p>$200.00 (Includes spouse and children under 21)</p>
</div>
<div class="greyHeading">
    <header>
         <h3>Red, White and Blue Discounts:</h3>

    </header>
    <p>Active LE, military, and 1st responders: 1/2 price membership discount!</p>
    <p>Retired LE, military and 1st responders 25% discount on membership!</p>
</div>
<div class="cl"></div>
</div>
<div id="indoorRange">
<div class="greyHeading">
    <header>
         <h3>Range Fees</h3>

    </header>
    <p>The range fees are per session. A "session" is defined as a visit to Allen
        Arms Indoor Shooting Range. We reserve the right to limit sessions to one
        hour if other customers are waiting for lanes.</p>
    <p>All lanes limited to two shooters unless special permission is obtained
        in advance.</p>
</div>
<div class="greyHeading">
    <header>
         <h3>Single Session</h3>

    </header>
    <ul>
        <li>One Adult Shooter: $10.00</li>
        <li>Two Adult Shooters on Same Lane: $7.50 Each</li>
        <li>Children under 18 with paying adult guardian: Free</li>
    </ul>
</div>
<div class="greyHeading">
    <header>
         <h3>Ladies Day</h3>

    </header>
    <p>Every Wednesday is Ladies Day! Women shoot for $5.00\. Additionally, women
        receive 20% off range memberships.</p>
</div>
<div class="greyHeading">
    <header>
         <h3>Red White and Blue Discounts</h3>

    </header>
    <p>Law Enforcement, Active Duty Military, First Responders, and Security
        personnel pay only $5.00 per session any time, and receive 50% discount
        on memberships!</p>
</div>
</div>

#memberships .greyHeading {
float: left;
width: 32%;
margin: 0 1% 0 0;
}
#memberships .greyHeading:last-child {
float: right;
margin: 0;
width: 33%;
}
#memberships .greyHeading header {
background: #666;
margin: 0 0 10px 0;
}
#memberships .greyHeading header h3 {
color: #fff;
text-shadow: 0px 1px 1px rgba(0, 0, 0, 1);
line-height: 25px;
margin: 0;
padding: 5px 0 1px 5px;
}
#indoorRange .greyHeading {
float: left;
width: 24%;
margin: 0 1% 0 0;
}
#indoorRange .greyHeading:last-child {
float: right;
margin: 0;
width: 25%;
}
#indoorRange .greyHeading header {
background: #666;
margin: 0 0 10px 0;
height: 55px;
}
#indoorRange .greyHeading header h3 {
color: #fff;
text-shadow: 0px 1px 1px rgba(0, 0, 0, 1);
line-height: 25px;
margin: 0;
padding: 5px 0 1px 5px;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T16:56:53.240

`<div class="cl"></div>`从 HTML 中删除并添加到`#indoorRange { clear: both; }`css，我相信这可以解决它。

样式未应用于最后一个成员 grayHeading，因为`<div class="cl">`它实际上不是最后一个子元素。

编辑：[小提琴证明](http://jsfiddle.net/N8weQ/)

EDIT2：我对应用样式的 cl div 是正确的，你也许可以使用`last-of-type`伪选择器来实现你想要的，不幸的是我不知道浏览器支持是什么样的。

有关更多信息，请参阅此 SO 问题：

[CSS last-child 选择器：选择特定类的最后一个元素，而不是父级中的最后一个子级？](https://stackoverflow.com/questions/7298057/css-last-child-selector-select-last-element-of-specific-class-not-last-child-i)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T16:49:49.353

这不是最理想的答案，因为它不能解决 :last-child 不起作用的原因。但是，这确实对我有用，并且可能是一个合适的解决方案。

我所做的只是从使用 last-child 切换到 nth-child。所以这两个特定的类是变化......我还添加了背景颜色，以使它们在此处的 jsfiddle 中工作在视觉上更加明显：http: [//jsfiddle.net/u9BsD/3/](http://jsfiddle.net/u9BsD/3/)

```
#memberships .greyHeading:nth-child(3) {
    float: right;
    margin: 0;
    width: 33%;
    background: red;
}

#indoorRange .greyHeading:nth-child(4) {
    float: right;
    margin: 0;
    width: 25%;
    background: blue;
} 
```

# ajax - 填充 chlid jSF selectOneMenu - 隐式值验证错误

> ID：14898637
> 
> 赞同：1
> 
> 时间：2013-02-15T16:06:18.497
> 
> 标签：ajax, jsf, jakarta-ee, primefaces, selectonemenu

正如您在屏幕截图中看到的，我对属性“member.city”有一个**JSF 隐式值验证错误**。目的是-通过ajax-在上一个Country Select one menu上选择一个国家后填充city select One Menu。这是通过使用**selectOneMenu 更改侦听**器和**ajax**来更新显示城市列表的组件来实现的。但是，我收到验证错误，并且未提交表单。

![验证错误截图](../Images/d2a925ea121ae2a3e98af1e69fbf6410.png)

我尝试使用**和不使用（hascode 和 equals 方法）**的实体，但徒劳无功。我使用了一个**单独的 Managed Bean ViewScoped**来检索过滤后的列表，但徒劳无功。**

> 如果我用检索所有城市的列表替换过滤的城市列表（在 xhtml 表单中，替换`<f:selectItems value="#{cityBean.citiesByCountry}" />`为`<f:selectItems value="#{cityBean.all}" />`，则没有验证错误并且表单成功提交。

** 这里是代码：

**形式：**

```
<p:outputLabel for="country" value="#{i18n.country}" />
                    <p:selectOneMenu valueChangeListener="#{cityBean.selectCountry}" rendered="true" id="country" value="#{newMember.country}" converter="#{countryBean.converter}" 
                        style="width:160px;text-align:left;border:thin solid gray;"
                        required="true" requiredMessage="#{i18n.required}">                     
                        <f:selectItems value="#{countryBean.all}" var="countryname" itemLabel="#{countryname.name}"/>
                        <p:ajax event="change" update="city" />
                    </p:selectOneMenu>
                    <p:message for="country" />

                    <p:outputLabel for="city" value="#{i18n.city}" />
                    <p:selectOneMenu rendered="true" id="city" value="#{newMember.city}" converter="#{cityBean.converter}" converterMessage="Conversion error!"
                        style="width:160px;text-align:left;border:thin solid gray;"
                        required="true" requiredMessage="#{i18n.required}">                                         
                        <f:selectItems value="#{cityBean.citiesByCountry}" var="cityname" itemLabel="#{cityname.cityname}"/>                        
                    </p:selectOneMenu>
                    <p:message for="city" /> 
```

**市实体负责人：**

```
@XmlRootElement
@Entity
@Table(name = "city", schema = "public")
@NamedQueries({
        @NamedQuery(name = "City.findAll", query = "SELECT c FROM City c"),
        @NamedQuery(name = "City.findById", query = "SELECT c FROM City c WHERE c.id = :id"),
        @NamedQuery(name = "City.findByCountry", query = "SELECT c FROM City c WHERE c.country = :country"),
        @NamedQuery(name = "City.findByCountryOrderedByName", query = "SELECT c FROM City c WHERE c.country = :country ORDER BY c.cityname ASC") })
@NamedNativeQueries({ @NamedNativeQuery(name = "City.findCountryNativeSQL", query = "select * from city c where c.countrybeta = :country.betacode", resultClass = City.class) })
public class City implements java.io.Serializable {

    private static final long serialVersionUID = 3364735938266980295L;
    private int id;
    private Integer version;
    private Country country;
    private String cityname;
    private String district;
    private int population;
    private Set<Member> members = new HashSet<Member>(0);

    public City() {
    }
// ...remainder of entity code (contructors and fields..) 
```

**豆子：**

```
@Named
@Stateful
@ConversationScoped
public class CityBean implements Serializable {

    private static final long serialVersionUID = 1L;
    private City city;
    private List<City> cityList;

    public City getCity() {
        return this.city;
    }

    private Country selectedCountry;

    @Inject
    private Conversation conversation;

    @PersistenceContext(type = PersistenceContextType.EXTENDED)
    private EntityManager entityManager;
// remainder of code....

// The List that works fine with Select one Menu
public List<City> getAll() {

        CriteriaQuery<City> criteria = this.entityManager.getCriteriaBuilder()
                .createQuery(City.class);
        return this.entityManager.createQuery(
                criteria.select(criteria.from(City.class))).getResultList();
    }

    @PostConstruct
    public void init() {
        setCityList(getCitiesByCountry());
    }

    public List<City> getCityList() {
        return cityList;
    }

    public void setCityList(List<City> cityList) {
        this.cityList = cityList;
    }

    /**
     * The List That triggers a jsf value validation error
     * @return List of Cities by Country ordered by city name
     */
    public List<City> getCitiesByCountry() {
        TypedQuery<City> query = this.entityManager.createNamedQuery(
                "City.findByCountryOrderedByName", City.class);
        query.setParameter("country", selectedCountry);
        return query.getResultList();
    }

    // The Select One Menu Listener
    public void selectCountry(ValueChangeEvent event) {

        if (event != null) {
            selectedCountry = (Country) event.getNewValue();
        }
        }

        // getters and setters.... 
```

环境： - JSF 21 - 休眠 - JBoss AS 7.1 - PrimeFaces 3.5 - Linux 3.5 / Firefox 18.0.2

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T16:56:47.797

您的具体问题是因为您没有开始对话`@PostConstruct`，因此 bean 的行为类似于请求范围。这样，城市列表将在处理表单提交期间发生不兼容的变化并变为空（因此在可用项目列表中找不到所选项目，因此出现此验证错误）。

您需要在`@PostConstruct`.

```
conversation.begin(); 
```

### 也可以看看：

*   [如何在 JSF 2.0/2.1 中用 CDI 替换 @ManagedBean / @ViewScope](https://stackoverflow.com/questions/14384369/how-to-replace-managedbean-viewscope-by-cdi/14384824#14384824)
*   [验证错误：值无效](https://stackoverflow.com/questions/9069379/validation-error-value-is-not-valid/9069660#9069660)

* * *

**与具体问题**无关**`valueChangeListener`，在 getter 方法中使用和执行业务逻辑是错误的方法。您根本不应该在 getter 方法中执行业务逻辑。这显然是低效的。它们应该只返回已经准备好的 bean 属性。**

 **重写你的逻辑如下：

```
<p:selectOneMenu value="#{bean.country}" ...>
    <f:selectItems value="#{bean.countries}" />
    <p:ajax listener="#{bean.updateCities}" update="city" />
</p:selectOneMenu>

<p:selectOneMenu id="city" value="#{bean.city}" ...>                                         
    <f:selectItems value="#{bean.cities}" />
</p:selectOneMenu> 
```

和

```
private Country country;
private List<Country> countries;
private City city;
private List<City> cities;

@PostConstruct
public void init() {
    countries = service.listCountries();

public void updateCities() {
    cities = service.listCities(country);
}

// Add/generate normal!! getters/setters. 
```

### 也可以看看：

*   [为什么 JSF 多次调用 getter](https://stackoverflow.com/questions/2090033/why-jsf-calls-getters-multiple-times/2090062#2090062)
*   [我们的`selectOneMenu`标签 wiki 页面](https://stackoverflow.com/tags/selectonemenu/info)**

# javascript - 将 JQuery 事件分配给自定义对象方法

> ID：14898647
> 
> 赞同：1
> 
> 时间：2013-02-15T16:06:49.797
> 
> 标签：javascript, jquery, oop, jquery-mobile

我正在使用 JQuery (Mobile) 创建一个应用程序，但我遇到了 JQuery 事件结构的问题。我定义了一个像这样的虚拟“类”：

```
MyClass = function()
{
    this.property = initvalue;

    this.foo = function()
    {
        alert("That's my property = " + this.property);
    }
} 
```

然后我基于MyClass定义了一个对象：

```
var obj1 = new MyClass(); 
```

当我使用 obj1.foo() 作为回调函数来通知事件时，问题就来了，例如：

```
$(element).click(obj1.foo); 
```

或者

```
$(element).load(URL, obj1.foo); 
```

执行 foo() 时，“this”指的是元素，而不是对象“obj1”，当然我不能通过自引用访问对象的“属性”。我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T16:09:22.030

您可以将方法[绑定](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/bind)到其实例：

```
$(element).click(obj1.foo.bind(obj1)); 
```

该`.bind()`方法返回一个函数，因此您仍在将一个函数传递给 jQuery 方法，但是该函数的上下文将绑定到您传递给`.bind()`.

如果需要支持旧版浏览器，可以使用之前链接的 MDN 文章中给出的 polyfill，也可以使用 jQuery[`$.proxy`](http://api.jquery.com/jQuery.proxy/)方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T16:10:15.243

您可以使用 jQUery 的`proxy`方法：

```
$(element).load(URL, $.proxy(obj1.foo, obj1)); 
```

这会将`obj1`上下文分配给您的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T16:26:07.440

您可以将 click 事件绑定到引用`this`对象上下文中的缓存版本的匿名函数。

```
var myClass = this;
$(element).click(function () { myClass.foo(); }); 
```

一般来说，使用此方法比库提供的替代方法（如 $.bind、$.proxy 和 _.bindAll）更有效（尽管在您当前的示例中，我认为性能是相当的）。请参阅[这篇关于上下文绑定](http://freshbrewedcode.com/jimcowart/2013/02/12/getting-into-context-binds/)的文章。

# adobe-indesign - 如何使用 Adob e InDesign CS4 脚本将文档定位在左下角？

> ID：14898648
> 
> 赞同：1
> 
> 时间：2013-02-15T16:06:52.570
> 
> 标签：adobe-indesign, cs4

我是这种脚本语言的新手。我需要一个文档，在将单页文档输出到 postscript 文件之前，我需要将它放在页面的左下角。我研究了“printPreferences”的属性，但什么也没想到（除了我不知道的 CENTERED 的变体，为什么 PagePositions 不支持任何东西）。

我试图对

```
marginPreferences.top = marginPreferences.top + marginPrefernces.bottom;
bottom = 0; 
```

我知道很懒。任何想法都会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T20:57:12.970

我对脚本也比较陌生，但大多数情况下你只能做应用程序通常支持的事情。

您的选择似乎是（来自[http://jongware.mit.edu/idcs4js/pc_PrintPreference.html](http://jongware.mit.edu/idcs4js/pc_PrintPreference.html)）

```
PagePositions.UPPER_LEFT
PagePositions.CENTER_HORIZONTALLY
PagePositions.CENTER_VERTICALLY
PagePositions.CENTERED 
```

无论如何，要做我认为你正在尝试做的事情，你可以制作一个脚本来将你的文件输出为 pdf，然后创建一个新文档并将该 pdf 准确地放在页面上你想要的位置（使页面大小与您的打印纸），然后将该文件输出到您的 postscript 文件。

# c# - 使用 JSON.NET 的 XML 到 JSON

> ID：14898651
> 
> 赞同：1
> 
> 时间：2013-02-15T16:06:56.223
> 
> 标签：c#, json.net

我有一个格式不正确但需要使用的 XML：

```
<Users>
<User First="aaa" Second="bbb">InnerValue</User>
<User First="bbb" Second="">InnerValue</User>
</Users> 
```

类定义：

```
public class Users
    {            
        public List<User> User{ get; set; }
    }

 public class User
    {        
        [JsonProperty("@First")]
        public string First{ get; set; }

        [JsonProperty("@Second")]
        public string Second{ get; set; }

        //how to define a property to get the InnerValue
    } 
```

解析：

```
XDocument xmlDocument = XDocument.Parse(xmlData);
string jsonData = JsonConvert.SerializeXNode(xmlDocument);
Users users = JsonConvert.DeserializeObject<Users>(jsonData); 
```

所以一切都很好地反序列化了，但是如何获得内在价值呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T16:33:46.663

要获得内部值，您必须使用它 `[JsonProperty("#text")]`来更新：

```
public class User
    {        
        [JsonProperty("@First")]
        public string First{ get; set; }

        [JsonProperty("@Second")]
        public string Second{ get; set; }

        [JsonProperty("#text")]
        public string InnerValue { get; set; }
    } 
```

# c++ - MFC 应用程序到 Linux dll

> ID：14898656
> 
> 赞同：0
> 
> 时间：2013-02-15T16:07:22.630
> 
> 标签：c++, linux, cakephp, dll, mfc

目前，我们有一个用 MFC（服务器）和 Java（客户端）编写的遗留客户端/服务器系统。由于各种原因，该系统无法在 Internet 上运行。因此，我们正在蛋糕 php 等中开发一个小型系统（这个遗留系统的功能很少）来满足客户的需求。

现在，旧系统中的一项功能需要在这个新系统中使用。我们正在考虑制作该代码的 DLL，然后将其与 cake php 集成（以节省时间），但此 DLL 无法在新系统所在的 Linux 上运行。

那么，有没有办法生成一个 dll 以便它在使用 QT 等的 Linux 系统中与 php 一起使用？

或者

我们必须重写整个事情吗？在这种情况下，最适合开发跨平台 dll 的框架是什么。我更喜欢用 Windows 来写。

另外，我们可以用 cake php 运行 dll 吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T16:17:27.667

> 那么，有没有办法生成一个 dll 以便它在使用 QT 等的 Linux 系统中与 php 一起使用？

不，Linux 不支持 DLL 文件格式。您可能希望从源代码编译 ELF 格式的共享对象文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T16:18:08.590

我认为，两个最著名的跨平台 GUI 库是[wxWidgets](http://www.wxwidgets.org/)和[Qt](http://qt-project.org/)。

您不能将 Windows DLL 用作 Linux 应用程序的一部分。由于对象格式不同，这根本不可能。

因此，唯一的选择是以某种形式重写或移植它。

移植应用程序的指南可能是[Porting MFC applications to Linux](https://www.ibm.com/developerworks/library/l-mfc/)，它使用 wxWidgets。

另一个使用 Qt 的可能是[MFC to Qt Migration - Walkthrough](http://doc.qt.digia.com/solutions/qtwinmigrate/winmigrate-walkthrough.html)。

# java - 通过 PHP 将数据读入 Java 小程序

> ID：14898658
> 
> 赞同：0
> 
> 时间：2013-02-15T16:07:34.570
> 
> 标签：java, php, applet

我编写了一个 Java 小程序，它通过将最新的文本字段条目存储在格式如下的文本文件中来管理持久数据：

```
Key: day; Value: 1  
Key: month; Value: 1  
Key: year; Value: 1900 
```

（在这种情况下，该数据表示 1900 年 1 月 1 日的日期。）我已经完成了写入文件的能力，它是通过 Java 小程序打开一个 PHP 文件并将文本值发送到 PHP 文件来完成的，然后写入文件。

但是，我现在正试图弄清楚如何从这个文本文件中读取数据并将数据恢复到 Java 小程序中，但我不知道该怎么做，因为我对 PHP 的经验很少。有没有办法使用 PHP 从文本文件读取到小程序？

# java - NullPointerException SynthLabelUI

> ID：14898661
> 
> 赞同：0
> 
> 时间：2013-02-15T16:07:43.573
> 
> 标签：java, nullpointerexception

我有一个`NullPointerException`我不明白的。通常，当这种情况发生时，控制台会指向我的代码中的一行。这一次，它指向

```
at javax.swing.plaf.synth.SynthLabelUI.getPreferredSize(SynthLabelUI.java:238) 
```

据我了解，这不在我的代码中。有人可以向我解释发生了什么吗？

```
Exception in thread "AWT-EventQueue-1" java.lang.NullPointerException
at javax.swing.plaf.synth.SynthLabelUI.getPreferredSize(SynthLabelUI.java:238)
at javax.swing.JComponent.getPreferredSize(JComponent.java:1660)
at javax.swing.plaf.basic.BasicSliderUI.getHeightOfTallestLabel(BasicSliderUI.java:775)
at javax.swing.plaf.synth.SynthSliderUI.layout(SynthSliderUI.java:378)
at javax.swing.plaf.synth.SynthSliderUI.calculateGeometry(SynthSliderUI.java:343)
at javax.swing.plaf.basic.BasicSliderUI$Handler.componentResized(BasicSliderUI.java:1496)
at java.awt.Component.processComponentEvent(Component.java:6331)
at java.awt.Component.processEvent(Component.java:6285)
at java.awt.Container.processEvent(Container.java:2229)
at java.awt.Component.dispatchEventImpl(Component.java:4861)
at java.awt.Container.dispatchEventImpl(Container.java:2287)
at java.awt.Component.dispatchEvent(Component.java:4687)
at java.awt.EventQueue.dispatchEventImpl(EventQueue.java:723)
at java.awt.EventQueue.access$200(EventQueue.java:103)
at java.awt.EventQueue$3.run(EventQueue.java:682)
at java.awt.EventQueue$3.run(EventQueue.java:680)
at java.security.AccessController.doPrivileged(Native Method)
at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:76)
at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:87)
at java.awt.EventQueue$4.run(EventQueue.java:696)
at java.awt.EventQueue$4.run(EventQueue.java:694)
at java.security.AccessController.doPrivileged(Native Method)
at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:76)
at java.awt.EventQueue.dispatchEvent(EventQueue.java:693)
at java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThread.java:242)
at java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.java:161)
at java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThread.java:150)
at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:146)
at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:138)
at java.awt.EventDispatchThread.run(EventDispatchThread.java:91) 
```

我正在绘制自定义标签

```
private void setSliderLabels() {
    Dictionary<Integer, JLabel> table = new Hashtable<Integer, JLabel>();
    table.put(-256, new JLabel("-w/2"));
    table.put(-128, new JLabel("-w/4"));
    table.put(0, new JLabel("0"));
    table.put(128, new JLabel("w/4"));
    table.put(256, new JLabel("w/2"));
    LSlider.setLabelTable(table);
    QSlider.setLabelTable(table);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T16:11:55.803

这通常意味着您违反了您正在使用的 API 的（暗示或明示的）合同。例如调用一个不应该用 null 调用的 null 值的方法，或者不设置一些应该设置的字段。如果 API 在这方面不清楚，这通常是猜测。

# command-prompt - 遍历文件夹中的文件（Windows 机器）

> ID：14898662
> 
> 赞同：0
> 
> 时间：2013-02-15T16:07:58.227
> 
> 标签：command-prompt, loops

我编写了一个命令来对文件夹中的所有文件进行特定操作。它可以在 linux 机器上的 shell 上完美运行，但我无法让它在 windows 机器上运行......我需要让它在 windows 机器上运行。该命令如下所示：

```
ls |grep -v _output| while read file; do ..\..\..\program.exe [option] ..\..\input_file "$file" > "$file"_output; done 
```

我得到了`ls`and`while`和的错误`grep`。非常欢迎任何建议！

瞎扯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T16:20:13.417

Windows 本身不支持 ls、while 和 grep。我建议安装 Cygwin；如果这不是一个选项，您需要运行它的机器可能安装了 PowerShell。

# html - 使 ul 在容器中居中

> ID：14898664
> 
> 赞同：0
> 
> 时间：2013-02-15T16:08:04.227
> 
> 标签：html, css

我很难在容器宽度上居中 3 li 元素。我正在研究响应式布局，所以我不想在任何元素上使用固定宽度。这是我的代码[http://jsfiddle.net/vzNbr/](http://jsfiddle.net/vzNbr/)

请注意，如果您扩展与容器左侧对齐而不是居中的输出屏幕。CSS 很简单：

```
.container {
width: 70%;
margin: 0 auto;
}

#about {
background-color: #ebebeb;
height: 100%;
width: 100%;
}

#about ul.info {
display: block;
width: 100%;
margin: 0 auto;
list-style: none;
padding: 0;
}

#about ul.info li {
width: 20%;
float: left;
display: inline-block;
vertical-align: top;
margin: 1.5em;
font-size: .8em;
} 
```

截图：![在此处输入图像描述](../Images/d3567976938599d9aa08dc203acbe1d5.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T16:30:21.587

尝试丢失浮动并将显示更改为表格单元格：

```
#about ul.info li {
width: 20%;
display: table-cell;
vertical-align: top;
margin: 1.5em;
font-size: .8em;
} 
```

您可能需要调整填充等，但它应该可以解决问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T16:34:16.960

你需要取出`float:left`，设置你的`ul`at`display:table`和`li`as `display:table-cell`。这是你的演示：http: [//jsfiddle.net/vzNbr/1/](http://jsfiddle.net/vzNbr/1/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-15T16:40:23.740

看看这是否是你需要的[http://jsfiddle.net/vzNbr/2/](http://jsfiddle.net/vzNbr/2/)

我放了一些颜色只是为了看清楚，但是，你只需要改变

```
#about ul.info li {
    margin: 1.5em;
} 
```

对此

```
#about ul.info li {
    margin:0 6.6666665%;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-15T16:29:04.773

不完全确定它为什么向左浮动，但这似乎使它更加居中，尽管我怀疑这是最好的解决方案。

```
 #about {
    position: relative;
}
.container {
    position: relative;
    width: 70%;
    left:20%;
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-15T16:37:29.423

如果你有 3 列，它们的宽度应该是 33,33%。为了不让边距为这 33% 增加额外的宽度，您可以使用 padding 和 box-sizing：border-box。

[http://jsfiddle.net/willemvb/n8gkK/](http://jsfiddle.net/willemvb/n8gkK/)

```
#about ul.info li {
    width: 33.33%;
    float: left;
    display: inline-block;
    padding: 1.5em;
    -webkit-box-sizing: border-box;
    -moz-box-sizing: border-box;
    box-sizing: border-box;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-15T16:45:48.107

要使元素居中，请使用以下代码片段：在这种情况下，您有一个容器应该适合其子元素的总大小。如果您不知道它的大小，请在 firebug 或 chrome inspect-element 中检查它并使用以下内容。

```
.centered {
  position: based on your choice;
  top: 50%;
  left: 50%;
  margin-top: -(container-element_height/2);
  margin-left: -(container-element_width/2);
} 
```

如果你的容器元素没有已知的大小，你应该像表格一样规则你的布局。

# ruby - 正则表达式 "(.*)" 与 "([^"]*)"

> ID：14898667
> 
> 赞同：2
> 
> 时间：2013-02-15T16:08:21.293
> 
> 标签：ruby, regex

我想做的是获取引号之间的所有文本。这两个似乎都可以正常工作（使用 ruby​​）。有人可以告诉我这两者的工作方式是否存在差异，或者它们是否只是相同的东西表达方式不同。

编辑：我主要看在黄瓜步骤定义的双引号之间获取文本（然后我应该看到“Hello World”）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T16:10:56.507

如果有多个带引号的字符串，第一个可能不会为您提供相同的数据：如果输入数据是，例如

```
"hello" "world" 
```

第一个表达式将匹配整个字符串，而第二个表达式将仅匹配`"hello"`部分。

一般来说，第二个表达式应该更快，因为没有回溯。这是[一篇详细讨论此问题的文章的链接](http://blog.stevenlevithan.com/archives/greedy-lazy-performance)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-15T16:15:12.070

*   `"(.*)"`- 这个正则表达式匹配字符串的**第一个和最后一个** 引号之间的所有符号，因为它`.*`告诉在匹配中**包含任何符号**。
*   `"([^"]*)"`**- 这个正则表达式匹配字符串的第一个和第二个**引号之间的所有符号 ，因为它`[^"]`告诉**不要**在匹配中包含引号。

我建议使用[rubular](http://rubular.com)进行正则表达式检查。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-15T16:09:37.573

嗯不应该这样。`(.*)`将匹配任何内容，即使它包含引号，另一方面`([^"]*)`将计算任意数量的**不包含引号**的符号。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-15T16:11:09.010

它们是不相同的。* 是贪婪的，所以 "(.*)" 将匹配：

fooo "bar" baz "asd"

从 bar 之前的引号一直到包含 asd。这可能不是你想要的。你的第二个例子避免了这种情况。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-15T16:12:28.830

它们的不同之处在于`.`将匹配任何字符并且`[^"]`将匹配除引号之外的任何字符。

为了使它们的行为更加一致，您可以将第一个示例更改为`"(.*?)"`使任何字符的匹配不贪婪（它将捕获它可以捕获的最短字符串，从而避免在文本中稍后找到另一个结束引号的风险）。

# php - Internet Explorer 上的 Zend 框架会话

> ID：14898669
> 
> 赞同：0
> 
> 时间：2013-02-15T16:08:28.110
> 
> 标签：php, zend-framework, session, zend-db, zend-session

发布此链接后仍然无法使其工作： [Zend framework session lost](https://stackoverflow.com/questions/14776097/zend-framework-session-lost)

我有这个注册表单，允许用户注册并将他们立即重定向到他们的页面。**除了INTERNET EXPLORER**之外，所有浏览器都可以正常工作。

我尝试了不同的方法，但仍然无法正常工作。将用户保存到数据库后，会话将不会存储。但是，如果我取出用户的保存，则可以存储会话和 cookie。

这是代码：

```
public function signUpAction()
{
    $signupForm = new Application_Form_UserSignUp();
    if ($this->getRequest()->isPost())
    {

        if ($signupForm->isValid($this->getRequest()->getParams()))
        {
            $user = $this->_helper->model('Users')->createRow($signupForm->getValues());
            if ($user->save())
            {
                //Set email into cookies for displaying into login inputfield
                setcookie('display_email', $this->getRequest()->getParam('email'), time() + 3600*24*30, '/'); <-- not working
                Zend_Session::rememberMe(186400 * 14); <-- not working
                Zend_Auth::getInstance()->getStorage()->write($user); <-- not working

                $user->sendSignUpEmail(); <-- i'm receiving this email
                $this->getHelper('redirector')->gotoRoute(array(), 'invite');                   
                return;
            }
        }
    }
    $this->view->signupForm = $signupForm; 
```

这是我正在做的另一种方式，但仍然无法在**IE**上运行：

```
public function signUpAction()
{

    $users = new Application_Model_DbTable_Users();
    $signupForm = new Application_Form_UserSignUp();
    if ($this->getRequest()->isPost())
    {
        $firstname = $this->getRequest()->getParam('first_name');
        $lastname = $this->getRequest()->getParam('last_name');
        $email = $this->getRequest()->getParam('email');

        if ($signupForm->isValid($this->getRequest()->getParams()))
        {
            $user = $this->_helper->model('Users')->createRow($signupForm->getValues());

            $user = array('email' => $email, 'first_name' => $firstname, 'last_name' => $last_name);
            $users->insert($user);
            Zend_Session::rememberMe(186400 * 14);
            Zend_Auth::getInstance()->getStorage()->write($user);
            $this->_redirect('invite');
        }
    }
    $this->view->signupForm = $signupForm; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T18:00:41.260

[`session_write_close`](http://php.net/manual/en/function.session-write-close.php)在调用重定向之前尝试使用。或者我认为 Zend 有一个等价物，请参阅： Zend_Session::writeclose

唯一想到的其他事情（IE 是唯一给您带来麻烦的浏览器）是 P3P 策略。在这里查看 Talha 的帖子：[Zend Sessions problem with IE8](https://stackoverflow.com/questions/1084008/zend-sessions-problem-with-ie8)

# java - Java/JDBC/MySQL：如何解决 DriverManager.getConnection() 返回 NULL 的原因？

> ID：14898672
> 
> 赞同：6
> 
> 时间：2013-02-15T16:08:36.877
> 
> 标签：java, mysql, jdbc

我正在尝试解决使用 JDBC 连接到 MySQL 数据库的 Java 应用程序的问题。表面问题是，当连接到有效数据库时，DriverManager.getConnection 有时会返回 NULL，而几分钟后它会返回与完全相同数据库的有效连接。

我正试图解决这个问题，但我对 Java、JDBC 和 MySQL 在何处相遇的理解相当有限。我一直在对此进行大量研究，但是碰壁了，不知道从哪里开始。

这是我到目前为止所做的：

*   在 Java 端，我一直跟踪代码到 DriverManager.getConnection()。我已经确定 NULL 连接来自那里，但我不知道 getConnection 背后发生了什么。我一直在努力在网上找到对此的彻底解释。
*   在 MySQL 端，我已经验证有很多可用的连接（有时大约 1000 个免费连接），所以我知道我没有超过那里的最大连接数。查看日志，我能够确定在我遇到最多问题的时间范围内，有稍多的连接被中止，但我不知道如何确定这些连接被中止的原因（MySQL 是否中止、JDBC、Java 应用程序？）我不确定在 MySQL 端是否还有其他需要寻找的东西。
*   在中间，使用 JDBC，我很迷茫。我一直在[http://dev.mysql.com/doc/refman/5.1/en/connector-j.html](http://dev.mysql.com/doc/refman/5.1/en/connector-j.html)阅读 MySQL Connector/J ，但不确定该信息是否与正在使用的 JDBC 驱动程序有关爪哇。

任何关于我可以从这里去哪里的方向都将不胜感激。

谢谢！

**编辑 - 中部标准时间 2 月 15 日上午 10:35 我很** 抱歉没有更具体。此应用程序是一个生产应用程序，通常可以正常工作。它每天成功处理数万个连接，没有任何问题，只是这个问题会在一天中的随机时间出现，并且在发生时会持续 30 秒到 5 分钟。

这是我一直追踪到 DriverManager.getConnection 的代码：

```
var dbConn = DatabaseConnectionFactory.createDatabaseConnection('com.mysql.jdbc.Driver','jdbc:mysql://'+ serverName +':' + port + '/' + database, userName, password);

public static DatabaseConnection createDatabaseConnection(String driver, String address, String username, String password) throws SQLException {
        try {
            Class.forName(driver);
        } catch (Exception e) {
            e.printStackTrace();
        }

        Properties info = new Properties();
        info.setProperty("user", username);
        info.setProperty("password", password);

        // this property should only be set if it's for embedded database
        info.setProperty("shutdown", "true");

        return new DatabaseConnection(address, info);
    }

public DatabaseConnection(String address, Properties info) throws SQLException {
        logger.debug("creating new database connection: address=" + address + ", " + info);
        this.address = address;
        connection = DriverManager.getConnection(address, info);
    } 
```

我不相信代码实际上有任何问题，而是 getConnection() 和 MySQL 之间的某个问题。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-15T16:52:51.743

单个驱动程序可以为连接请求返回 null，JDBC 4.1 规范是这样说的：

> 当 DriverManager 尝试建立连接时，它会调用该驱动程序的 connect 方法并将 URL 传递给驱动程序。如果驱动程序实现理解 URL，它将返回一个 Connection 对象，或者如果无法与数据库建立连接，则抛出一个 SQLException。如果 Driver 实现不理解 URL，它将返回 null。

但是，查看`java.sql.DriverManager`（在 Java 7 Update 13 中）的代码，当所有可用的驱动程序都已返回以进行调用时，它**总是**会抛出一个`SQLException`带有消息*没有为 <url> 找到合适的驱动程序：*`null``connect(url, properties)`

```
//  Worker method called by the public getConnection() methods.
private static Connection getConnection(
    String url, java.util.Properties info, ClassLoader callerCL) throws SQLException {
// Removed some classloading stuff for brevity
    if(url == null) {
        throw new SQLException("The url cannot be null", "08001");
    }
    // Walk through the loaded registeredDrivers attempting to make a connection.
    // Remember the first exception that gets raised so we can reraise it.
    SQLException reason = null;
    for(DriverInfo aDriver : registeredDrivers) {
        // If the caller does not have permission to load the driver then
        // skip it.
        if(isDriverAllowed(aDriver.driver, callerCL)) {
            try {
                println("    trying " + aDriver.driver.getClass().getName());
                Connection con = aDriver.driver.connect(url, info);
                if (con != null) {
                    // Success!
                    println("getConnection returning " + aDriver.driver.getClass().getName());
                    return (con);
                }
            } catch (SQLException ex) {
                if (reason == null) {
                    reason = ex;
                }
            }
        } else {
            println("    skipping: " + aDriver.getClass().getName());
        }
    }
    // if we got here nobody could connect.
    if (reason != null)    {
        println("getConnection failed: " + reason);
        throw reason;
    }
    println("getConnection: no suitable driver found for "+ url);
    throw new SQLException("No suitable driver found for "+ url, "08001");
} 
```

换句话说：您所描述的事情不会发生（至少在 Java 7 Update 13 中不会发生）。快速浏览一下 Java 5 Update 22 源代码会发现几乎相同的实现，但它根本无法返回 null。

您更有可能吞下异常，然后尝试使用`Connection`值为 null 的变量或字段。

另一种可能性是您没有获得与 的连接`DriverManager.getConnection(url, ...)`，但由于上面建立的规则，`DriverManager.getDriver(url).connect(...)`它可以返回。`null`如果您这样做，那么如果您始终使用完全相同的 URL，它可能指向 Connector/J 驱动程序中的错误：驱动程序无法决定在某一时刻返回特定 URL 的连接，然后返回 null。它应该始终为相同的 URL 返回一个`Connection`或抛出一个`SQLException`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T16:15:55.927

是的，`DriverManager`是为您获取连接的类。

它使用通过 MySQL Connector-J JAR 获得的 JDBC 驱动程序类来管理它。`CLASSPATH`当你开始的时候，那个 JAR 必须在你的里面。

首先确保您可以从运行 Java 应用程序的机器连接到 MySQL。成功登录 MySQL 管理应用程序，您已经克服了第一个障碍。

我会根据你的情况给你上一堂医生课。这些方法通常对您有用。根据您的情况修改连接、凭据和查询并试一试。我*知道*这段代码有效。

```
package persistence;

import java.sql.*;
import java.util.*;

/**
 * util.DatabaseUtils
 * User: Michael
 * Date: Aug 17, 2010
 * Time: 7:58:02 PM
 */
public class DatabaseUtils {
/*
    private static final String DEFAULT_DRIVER = "oracle.jdbc.driver.OracleDriver";
    private static final String DEFAULT_URL = "jdbc:oracle:thin:@host:1521:database";
    private static final String DEFAULT_USERNAME = "username";
    private static final String DEFAULT_PASSWORD = "password";
*/
/*
    private static final String DEFAULT_DRIVER = "org.postgresql.Driver";
    private static final String DEFAULT_URL = "jdbc:postgresql://localhost:5432/party";
    private static final String DEFAULT_USERNAME = "pgsuper";
    private static final String DEFAULT_PASSWORD = "pgsuper";
*/
    private static final String DEFAULT_DRIVER = "com.mysql.jdbc.Driver";
    private static final String DEFAULT_URL = "jdbc:mysql://localhost:3306/party";
    private static final String DEFAULT_USERNAME = "party";
    private static final String DEFAULT_PASSWORD = "party";

    public static void main(String[] args) {
        long begTime = System.currentTimeMillis();

        String driver = ((args.length > 0) ? args[0] : DEFAULT_DRIVER);
        String url = ((args.length > 1) ? args[1] : DEFAULT_URL);
        String username = ((args.length > 2) ? args[2] : DEFAULT_USERNAME);
        String password = ((args.length > 3) ? args[3] : DEFAULT_PASSWORD);

        Connection connection = null;

        try {
            connection = createConnection(driver, url, username, password);
            DatabaseMetaData meta = connection.getMetaData();
            System.out.println(meta.getDatabaseProductName());
            System.out.println(meta.getDatabaseProductVersion());

            String sqlQuery = "SELECT PERSON_ID, FIRST_NAME, LAST_NAME FROM PERSON ORDER BY LAST_NAME";
            System.out.println("before insert: " + query(connection, sqlQuery, Collections.EMPTY_LIST));

            connection.setAutoCommit(false);
            String sqlUpdate = "INSERT INTO PERSON(FIRST_NAME, LAST_NAME) VALUES(?,?)";
            List parameters = Arrays.asList("Foo", "Bar");
            int numRowsUpdated = update(connection, sqlUpdate, parameters);
            connection.commit();

            System.out.println("# rows inserted: " + numRowsUpdated);
            System.out.println("after insert: " + query(connection, sqlQuery, Collections.EMPTY_LIST));
        } catch (Exception e) {
            rollback(connection);
            e.printStackTrace();
        } finally {
            close(connection);
            long endTime = System.currentTimeMillis();
            System.out.println("wall time: " + (endTime - begTime) + " ms");
        }
    }

    public static Connection createConnection(String driver, String url, String username, String password) throws ClassNotFoundException, SQLException {
        Class.forName(driver);
        if ((username == null) || (password == null) || (username.trim().length() == 0) || (password.trim().length() == 0)) {
            return DriverManager.getConnection(url);
        } else {
            return DriverManager.getConnection(url, username, password);
        }
    }

    public static void close(Connection connection) {
        try {
            if (connection != null) {
                connection.close();
            }
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }

    public static void close(Statement st) {
        try {
            if (st != null) {
                st.close();
            }
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }

    public static void close(ResultSet rs) {
        try {
            if (rs != null) {
                rs.close();
            }
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }

    public static void rollback(Connection connection) {
        try {
            if (connection != null) {
                connection.rollback();
            }
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }

    public static List<Map<String, Object>> map(ResultSet rs) throws SQLException {
        List<Map<String, Object>> results = new ArrayList<Map<String, Object>>();
        try {
            if (rs != null) {
                ResultSetMetaData meta = rs.getMetaData();
                int numColumns = meta.getColumnCount();
                while (rs.next()) {
                    Map<String, Object> row = new HashMap<String, Object>();
                    for (int i = 1; i <= numColumns; ++i) {
                        String name = meta.getColumnName(i);
                        Object value = rs.getObject(i);
                        row.put(name, value);
                    }
                    results.add(row);
                }
            }
        } finally {
            close(rs);
        }
        return results;
    }

    public static List<Map<String, Object>> query(Connection connection, String sql, List<Object> parameters) throws SQLException {
        List<Map<String, Object>> results = null;
        PreparedStatement ps = null;
        ResultSet rs = null;
        try {
            ps = connection.prepareStatement(sql);

            int i = 0;
            for (Object parameter : parameters) {
                ps.setObject(++i, parameter);
            }
            rs = ps.executeQuery();
            results = map(rs);
        } finally {
            close(rs);
            close(ps);
        }
        return results;
    }

    public static int update(Connection connection, String sql, List<Object> parameters) throws SQLException {
        int numRowsUpdated = 0;
        PreparedStatement ps = null;
        try {
            ps = connection.prepareStatement(sql);

            int i = 0;
            for (Object parameter : parameters) {
                ps.setObject(++i, parameter);
            }
            numRowsUpdated = ps.executeUpdate();
        } finally {
            close(ps);
        }
        return numRowsUpdated;
    }
} 
```

编译后，使用以下命令运行它：

```
java -classpath .;<Connector-J driver path here> persistence.DatabaseUtils 
```

# html - Facebook 刮板不加载动态元标签

> ID：14898673
> 
> 赞同：10
> 
> 时间：2013-02-15T16:08:41.383
> 
> 标签：html, facebook, web-scraping, meta-tags, scraper

我正在使用下面的函数 (GWT) 动态创建 HTML 元标记。将它放在 DOM 上需要 1 秒。除了 Facebook，它工作正常。当我从我的网站共享一个链接时，抓取工具会获取 HTML 中的元标记：无。我怎样才能解决这个问题？

```
/**
* Include the HTML attributes: title, description and keywords (meta tags)
*/
private void createHTMLheader(MyClass thing) {

    String title=thing.getTitle();
    String description=thing.getDescription();

    Document.get().setTitle(title);

    MetaElement metaDesc = Document.get().createMetaElement();
    metaDesc.setName("description");
    metaDesc.setContent(description);
    NodeList<Element> nodes = Document.get().getElementsByTagName("head");
    nodes.getItem(0).appendChild(metaDesc);
} 
```

这是 DOM 上的结果 HEAD。标题**`aaaa`**和元描述已动态加载。（感谢CBroe的提示）。在“查看源代码”功能中，这些动态标签不会显示（仅在开发人员工具上 - 查看 dom）。

```
<head>
    <title>aaaa</title>
    <meta content="text/html; charset=utf-8" http-equiv="content-type">
    <meta name="description" content="My description">

    <script language="javascript" type="text/javascript" src="dialective/dialective.nocache.js"></script><script defer="defer">dialective.onInjectionDone('dialective')</script>

</head> 
```

原始 HTML 没有 TITLE 或 META-DESCRIPTION 标签。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-15T17:27:30.367

Facebook 抓取工具只能看到`<meta>`来自服务器的原始 HTML 响应中包含的标签。运行任何 JavaScript 代码、Flash 插件、Java 小程序或任何其他成熟浏览器可能运行的东西都不够“智能”。

您需要`<meta>`使用服务器端框架在服务器上生成这些标签。

此外，Facebook 提供了一个方便的[测试工具](http://developers.facebook.com/tools/debug)，以确保您的页面公开适当的元标记。您可能还需要添加 OpenGraph 标记，例如`og:title`和`og:description`。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-02-15T16:27:58.483

> 由于某种原因，元描述尚未加载上述功能......

那是因为你只是在*创建*一个新的 MetaElement——但你对它*什么*都不做。

您必须将其*附加*到文档中，更具体到其`head`元素。

就像是

```
getHead().appendChild(metaDesc) 
```

不见了。

# python - 运行kivy pong教程时DLL加载失败

> ID：14898675
> 
> 赞同：2
> 
> 时间：2013-02-15T16:08:43.453
> 
> 标签：python, installation, kivy

我一直在尝试学习 python 并使用 kivy 创建一个小型应用程序，以了解 kivy python 应用程序。但我什至无法让标准 kivy 安装附带的 pong 教程正常工作。当我在示例文件夹中运行文件 pong.py 时，我得到以下输出。

```
botstrapping Kivy @ C:\Users\myname\Applications\Kivy\
Setting Environment Variables:
#################################
GST_REGISTRY
C:\Users\myname\Applications\Kivy\gstreamer\registry.bin
---------------
GST_PLUGIN_PATH:
C:\Users\myname\Applications\Kivy\gstreamer\lib\gstreamer-0.10
---------------
PATH:
C:\Users\myname\Applications\Kivy\;C:\Users\myname\Applications\Kivy\Python;C:
\Users\myname\Applications\Kivy\Python\Scripts;C:\Users\myname\Applications\Ki
vy\gstreamer\bin;C:\Users\myname\Applications\Kivy\MinGW\bin;C:\Perl\site\bin;C
:\Perl\bin;C:\Program Files\ActiveState Perl Dev Kit 9.2.1\bin\;C:\Program Files
\ActiveState Komodo Edit 7\;C:\Program Files\NVIDIA Corporation\PhysX\Common;C:\
Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\Windows
PowerShell\v1.0\;c:\Program Files\Microsoft SQL Server\100\Tools\Binn\;c:\Progra
m Files\Microsoft SQL Server\100\DTS\Binn\;C:\Program Files\TortoiseSVN\bin;C:\P
rogram Files\Autodesk\Backburner\;C:\Program Files\Common Files\Autodesk Shared\
;C:\Program Files\Microsoft\Web Platform Installer\;C:\Program Files\Microsoft A
SP.NET\ASP.NET Web Pages\v1.0\;C:\Program Files\Windows Kits\8.0\Windows Perform
ance Toolkit\;C:\Program Files\Microsoft SQL Server\110\Tools\Binn\;C:\Program F
iles\QuickTime\QTSystem\;C:\Program Files\MiKTeX 2.9\miktex\bin\;C:\Program File
s\Perforce
----------------------------------
PYTHONPATH:
C:\Users\myname\Applications\Kivy\kivy;
----------------------------------
##################################
done bootstraping kivy...have fun!\n
running "python.exe C:\Users\myname\Applications\Kivy\kivy\examples\tutorials\p
ong\main.py" \n
[INFO              ] Kivy v1.5.1
[INFO              ] [Logger      ] Record log in C:\Users\myname\.kivy\logs\ki
vy_13-02-15_11.txt
[INFO              ] [Factory     ] 137 symbols loaded
[DEBUG             ] [Cache       ] register <kv.lang> with limit=None, timeout=
Nones
[DEBUG             ] [Cache       ] register <kv.image> with limit=None, timeout
=60s
[DEBUG             ] [Cache       ] register <kv.atlas> with limit=None, timeout
=Nones
[DEBUG             ] [Cache       ] register <kv.texture> with limit=1000, timeo
ut=60s
[DEBUG             ] [Cache       ] register <kv.shader> with limit=1000, timeou
t=3600s
 Traceback (most recent call last):
   File "C:\Users\myname\Applications\Kivy\kivy\examples\tutorials\pong\main.py
", line 4, in <module>
     from kivy.app import App
   File "C:\Users\myname\Applications\Kivy\kivy\kivy\app.py", line 222, in <mod
ule>
     from kivy.uix.widget import Widget
   File "C:\Users\myname\Applications\Kivy\kivy\kivy\uix\widget.py", line 86, i
n <module>
     from kivy.graphics import Canvas
   File "C:\Users\myname\Applications\Kivy\kivy\kivy\graphics\__init__.py", lin
e 76, in <module>
     from kivy.graphics.instructions import Callback, Canvas, CanvasBase, \
   File "vbo.pxd", line 8, in init kivy.graphics.instructions (kivy\graphics\ins
tructions.c:11678)
   File "texture.pxd", line 3, in init kivy.graphics.vbo (kivy\graphics\vbo.c:43
61)
   File "texture.pyx", line 1, in init kivy.graphics.texture (kivy\graphics\text
ure.c:11112)
   File "opengl_utils.pyx", line 19, in init kivy.graphics.opengl_utils (kivy\gr
aphics\opengl_utils.c:3717)
 ImportError: DLL load failed: The specified procedure could not be found.
Press any key to continue . . ." 
```

我相信在声明期间失败即将来临：

```
from opengl import _GL_GET_SIZE 
```

但我不确定为什么这不起作用以及为什么它甚至无法加载他们的预制教程。有谁知道如何解决这个问题？

# c++ - Qt Creator 找不到 cl.exe (VS2012) 编译器

> ID：14898676
> 
> 赞同：1
> 
> 时间：2013-02-15T16:08:47.173
> 
> 标签：c++, visual-studio-2010, qt, build, visual-studio-2012

我分别编译了3个版本的Qt 5.0.1：

1- VS2012 64 位上的 Qt 5.0.1

2- VS2012 32 位上的 Qt 5.0.1

做了一些测试

3- VS2010 32 位上的 Qt 5.0.1

当我进行测试时，Qt 5.0.1 64 和 32 的编译版本运行良好。然后用VS2010编译后，VS2012编译器在Qt Creator中就不能工作了！！！我总是收到这样的信息：

```
'cl' is not recognized as an internal or external command 
```

并且只有 VS2010 编译器在 Qt Creator 中有效。

我明白编译器的路径应该在环境变量 PATH 中。但我现在有两个编译器。如果他们都在 PATH 中，这不会让他们发生冲突吗？Qt Creator 不应该在编译之前自动运行 vcvarshell 以设置正确的环境变量吗？我该怎么办？请指教。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T17:26:34.967

好，我知道了。我将编译器切换到 VS2012 amd64 而不是 x86_amd64，这在 VS2012 Express 中不可用。这让 Qt Creator 的命令提示符找不到编译器。所以我切换回 x86_amd64 编译器，它工作了。

所以你可以有两个编译器没有冲突，这是个好消息 :)

# sql - 如何重置忘记的 sa 密码？

> ID：14898682
> 
> 赞同：0
> 
> 时间：2013-02-15T16:09:10.337
> 
> 标签：sql, sql-server, sql-server-2008-r2

我正在使用 SQL Server 2008 r2。我在安装的时候选择了SQL认证的混合模式。

我已经给出`sa`了用户名并给出了一些密码，然后我忘记了密码。

我不知道如何更改用户密码或删除密码并创建新用户登录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T16:11:08.133

尝试：

```
exec sp_password null, '<new password>', 'sa' 
```

以 sysadmin 用户身份运行它，用您想要的任何新密码替换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T16:17:33.330

如果您可以以系统管理员身份登录系统，请运行以下命令。

```
ALTER LOGIN sa WITH PASSWORD = 'xx' 
```

如果您无法以系统管理员身份登录，但至少可以以管理员身份登录服务器，请告诉我，我将向您发送有关如何解决问题的链接。

# jquery - 文档中所有表格的通用 jQuery 排序解决方案

> ID：14898683
> 
> 赞同：-2
> 
> 时间：2013-02-15T16:09:11.350
> 
> 标签：jquery

为我的表实现通用 jQuery 排序解决方案的最佳方法是什么，以便当用户单击 thead 元素时，它将按字母或数字顺序对列进行排序。这是我的代码：http: [//jsfiddle.net/uJmJ7/](http://jsfiddle.net/uJmJ7/)

```
<table class="ui-widget" style="border-collapse: collapse;">
    <thead class="ui-widget-header">
        <tr>
            <th>Module Code</th>
            <th>Module Name</th>
            <th>Module Grade</th>
        </tr>
    </thead>
    <tbody class="ui-widget-content">
        <tr>
            <tr class="moduleList">
                <td class="moduleList_id">SB005</td>
                <td class="moduleList_name">Accounting</td>
                <td class="moduleList_grade">79</td>
            </tr>
            <tr class="moduleList">
                <td class="moduleList_id">SA572</td>
                <td class="moduleList_name">Statistics</td>
                <td class="moduleList_grade">45</td>
            </tr>
            <tr class="moduleList">
                <td class="moduleList_id">SA570</td>
                <td class="moduleList_name">Methods for Business</td>
                <td class="moduleList_grade">56</td>
            </tr>
            <tr class="moduleList">
                <td class="moduleList_id">SA526</td>
                <td class="moduleList_name">Finance</td>
                <td class="moduleList_grade">89</td>
            </tr>
            <tr class="moduleList">
                <td class="moduleList_id">SA512</td>
                <td class="moduleList_name">Leisure</td>
                <td class="moduleList_grade">66</td>
            </tr>
            <tr class="moduleList">
                <td class="moduleList_id">SA510</td>
                <td class="moduleList_name">Environment</td>
                <td class="moduleList_grade">30</td>
            </tr>
        </tr>
    </tbody>
</table> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T16:36:32.090

您可能想研究具有此功能的插件或类似 KendoUI 的东西......

[剑道UI](http://demos.kendoui.com/)

[数据表网](http://datatables.net/)

# css - 如何在没有使用负边距的情况下将元素定位在 div 顶部？

> ID：14898691
> 
> 赞同：0
> 
> 时间：2013-02-15T16:09:30.873
> 
> 标签：css, position, margin

如何在不使用负边距或填充的情况下将元素放置在 div 顶部？检查图像以查看我要实现的目标：

![在此处输入图像描述](../Images/c5164edc6b769d6d137424a0de55a199.png)

灰色区域是 div #content，蓝色是 h1。我需要 h1 在#content 中。我认为如果我将 h1 放在 #content div 之前并使用 z-index ，我可以实现这一点，但这不是唯一的方法，是吗？

```
<div id="content">
<h1>text here</h1>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T16:11:57.463

你可以用`position`ing。

```
#content h1 {position: relative; top: -15px;} 
```

或者用一种更好的方式说，`position`两者兼而有之。

```
#content {position: relative;}
#content h1 {position: absolute; top: -15px;} 
```

关于负值的查询`top`：

> 负值是允许的，这将导致元素以与上面已经说明的方向相反的方向移动。

参考：

*   [站点点](http://reference.sitepoint.com/css/top)

# jsp - EditableGrid 数据类型：双精度

> ID：14898705
> 
> 赞同：3
> 
> 时间：2013-02-15T16:10:38.053
> 
> 标签：jsp, double, editablegrid

我正在使用 editablegrid 库使表格可编辑，以便以后可以编辑和更新要从中提取数据的数据库。我对 jsp 中的元数据标头有一些问题。我有：

```
<script src="js/editablegrid-2.0.1.js"></script>
<script>
    window.onload = function() {
        editableGrid = new EditableGrid("grid");

        // we build and load the metadata in Javascript
        editableGrid.load({
            metadata : [ {
                name : "ID",
                datatype : "string",
                editable : false
            }, {
                name : "DATE",
                datatype : "date",
                editable : false
            }, {
                name : "PRICE",
                datatype : "double (m, 10)",
                editable : true
            } ]
        });

        editableGrid.attachToHTMLTable('Grid');
        editableGrid.renderGrid();
    };
</script> 
```

这一切都很好，但是显示的 PRICE 列有点奇怪，它使用逗号而不是句号，反之亦然。例如：

1.5（一个半）将显示为“1,5” 1,500（一千五）将显示为“1.500”

有谁知道如何改变这个？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-05-12T05:25:13.583

以下对我有用。

```
{ name: "Price", datatype: "double($,2,dot,comma,1)", editable: true }, 
```

[您可以通过阅读source](https://github.com/webismymind/editablegrid/blob/master/editablegrid.js#L642)找出 datatype 参数的格式。

在这种情况下，我指定了“$”，因为我想在数字前加一个美元符号。“2”因为我想要两位小数。“点”是因为我想要一个点作为小数分隔符，“逗号”作为千位分隔符，而 1 是因为我希望美元符号出现在数字之前而不是之后。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-12T14:48:45.047

也是一个很好的简短解释：

用法：

```
double(<unit>, <precision>, <decimal_point>, <thousands_separator>, 
       <show_unit_before_number>, <nansymbol>) 
```

例子：

```
double(m³, 2, dot, comma, 0, n/a) 
```

代码链接： [https ://github.com/webismymind/editablegrid/blob/master/editablegrid.js#L698](https://github.com/webismymind/editablegrid/blob/master/editablegrid.js#L698)

讨论链接： [https ://github.com/webismymind/editablegrid/issues/51](https://github.com/webismymind/editablegrid/issues/51)

# spotify - 多会话Spotify

> ID：14898715
> 
> 赞同：1
> 
> 时间：2013-02-15T16:11:23.920
> 
> 标签：spotify, libspotify

我们的应用程序在多音频分区 PC 上运行，该 PC 将音乐分发到家庭的各个部分等。有谁知道 Libspotify 是否支持多个会话？它似乎是这样做的，但我没有运气让它工作。如果是这样，任何关于如何让它工作的指示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T16:25:49.470

您是指在多个设备上同时播放还是在一个进程中有多个会话实例？

无论哪种方式，答案是否定的：

*   虽然您可以使用任意数量的设备登录，但 libspotify（和所有其他 Spotify 客户端）只允许您一次流式传输到一台机器。

*   libSpotify 仅支持每个进程一个会话实例。如果您希望多个用户在一台机器上登录，您需要为每个登录用户使用不同的进程。

# .htaccess - 404页面被重定向到htaccess中的主页

> ID：14898716
> 
> 赞同：0
> 
> 时间：2013-02-15T16:11:26.460
> 
> 标签：.htaccess, redirect, http-status-code-404

我的 htaccess 中有这个

```
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteRule ^(.*)$ /index.php?url=$1 [QSA,L]
</IfModule> 
```

该网站需要这个才能正常运行。当我放置不正确的网址（不存在的页面）时，它会将我重定向到主页？我想改为显示我的 404 页面？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T19:00:55.873

如果您的 404 页面是一个实际文件（例如 /404.html），那么该规则应该按原样工作，因为它指定不将其应用于现有文件。如果你的 404 页面是虚拟的，那么你需要添加一个 RewriteCond 来排除它。例如，如果确实是 404 页面，`/index.php?error`您将在 RewriteRule 前面添加以下 RewriteCond，根据需要更新查询字符串：

`RewriteCond %{QUERY_STRING} !^error`

或者，您可以制作一个真正的 404.html 页面供您的 php/CMS 代码使用，在这种情况下，原始规则应该没问题。

# c++ - Eclipse 无法识别向量的返回值

> ID：14898717
> 
> 赞同：0
> 
> 时间：2013-02-15T16:11:31.023
> 
> 标签：c++, eclipse, vector

我一直在让 C++ 在 Eclipse 中工作。我的代码一直在编译，但 Eclipse 一直很困惑。一开始无法识别任何标头（iostream、fstream、GL/glut.h），我最终发现要手动添加所有库路径。

现在所有的错误都消失了，除了一种涉及向量的错误。这里有些例子：

```
list[i]._v2 
```

list 是 vector 类型。Edge 是一个具有 _v2 的类。我可以通过从向量转换返回来修复这个错误：

```
((Edge)list[i])._v1 
```

还有其他示例，它们都与使用向量访问返回的值有关，而无需某种显式强制转换。

这是我编译的方式：

```
g++ -o <exec> <files.cc> -lglut -lGLU -lGL 
```

那么为什么 eclipse 不知道在哪里可以找到任何东西，为什么它现在能识别向量，但不能识别它们的返回类型呢？

编辑：它在 eclispe 之外编译得很好，并且一直都有。它还可以在 eclipse 中正常编译和运行（我使用的是我自己的 makefile），但是 eclipse 会实时显示代码中的错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T16:16:22.923

在开始一个新项目后，我意识到我认为我的问题是：eclipse 没有将我的文件识别为源文件夹中。我创建了一个项目并假装它不是来自源代码，允许 Eclipse 创建一个 Hello World 文件（并设置包含）。然后我把我的文件放在 src/ 文件夹中，现在一切正常。

# shell - shell - 将字符串与变量（字符串或数字）进行比较

> ID：14898721
> 
> 赞同：0
> 
> 时间：2013-02-15T16:11:40.323
> 
> 标签：shell, string-comparison

我想知道字符串变量是否为空。我通过将变量与文字空字符串 ( `""`) 进行比较来做到这一点。

这是我的代码：

```
var=$1

if [$var == ""]; then
    echo "\$var is $var"
fi 
```

`$1`当是`""`（没有命令行参数）时，它给了我这个错误：

```
./script.sh: line 5: [: ==: unary operator expected 
```

当`$1`有一个值时，它工作正常。

我已经尝试了以下事情，但他们仍然给了我一个错误：

1.  更改`==`为`-eq`.
2.  周围`$var`有`""`。
3.  把它放在`space`里面。`""``" "`
4.  1-3的不同组合

我希望能够将字符串变量（是否为空）与`""`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T16:15:00.790

左括号 ( `[`) 后应始终有一个空格，因为它是命令名称。

最接近您自己的方法：`if [ "$var" = "" ]; then...`

另一种方法（`-n`谓词 which test for non-emptiness）：`if [ -n "$var" ]; then...`

需要双引号`$var`。

# actionscript-3 - 如何在 flash as3 的定时器类中添加返回函数？

> ID：14898736
> 
> 赞同：0
> 
> 时间：2013-02-15T16:12:40.843
> 
> 标签：actionscript-3, flash, for-loop, timer

嗨，我有一个关于 for 循环的问题。我有一个包含 3 个影片剪辑的数组，我想一个接一个地播放每个影片剪辑，我计划通过在 for 循环中使用计时器类来延迟播放（）；每个 MC。

谁能指出我正确的方向，下面显示的是我使用返回函数的尝试（但是没有成功）

```
//Shuffling the array to produce a random order when MC's are playing
function randomSort(a:*, b:*):Number
{
    if (Math.random() < 0.5) return -1;
    else return 1;
}
var obstacleArray:Array = [obstacleCar,obstacleCar2,obstacleCar3];
obstacleArray.sort(randomSort);

trace(obstacleArray);
trace(obstacleArray.length);

//OBSTACLE START DELAY
var timerPlay:Timer = new Timer(1000,1);
timerPlay.addEventListener(TimerEvent.TIMER, ontimerPlay);
timerPlay.start();
function ontimerPlay(evt:TimerEvent):void{

    //FOR EACH OBSTACLE

    var _i:Number=-1;
    for(var i:Number=0; i<obstacleArray.length; i++){

        var timerDelay:Timer = new Timer(1000,1);
        timerDelay.addEventListener(TimerEvent.TIMER, ontimerDelay);
        timerDelay.start();
        function ontimerDelay(evt:TimerEvent):void{

            _i = i;
            trace(obstacleArray[i]);
            obstacleArray[i].play();
            trace(i);
        }
    }
    return _i;
} 
```

提前非常感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T16:35:17.893

首先，如果您的函数要返回某些内容，则类型不得为“void”。尔格...

```
function getNumber():Number {
    return 123;
} 
```

其次，您需要启动计时器，而不是生成创建计时器的函数。另外，我想你会想要跟踪每个 MovieClip 的长度。假设它们可能都不同，那么最简单的方法是在您存储 MovieClips 的同一个数组中。

试试这个（见评论）。

```
//Shuffling the array to produce a random order when MC's are playing
function randomSort(a:*, b:*):Number {
    if (Math.random() < 0.5) return -1;
    else return 1;
}

// Array holds both the MovieClip reference as well as the duration of the clip.
var obstacleArray:Array = [
    {   "obj":obstacleCar,
        "duration":1050 },
    {   "obj":obstacleCar2,
        "duration":2500 },
    {   "obj":obstacleCar3,
        "duration":3857 }
];

obstacleArray.sort(randomSort);

// Holds the current index we're watching in the array
var currentIndex:int = 0;

// Create the timer and start it up.
var timerPlay:Timer = new Timer(10, 1);
timerPlay.addEventListener(TimerEvent.TIMER, ontimerPlay);
timerPlay.start();

function ontimerPlay(evt:TimerEvent):void {
    obstacleArray[currentIndex].obj.play();

    // Increment the index.
    currentIndex = currentIndex + 1;

    // If the index does not exceed the array length, start a timer for it.
    if (currentIndex < obstacleArray.length) {
        // And use the length specified in the array.
        timerPlay = new Timer(obstacleArray[currentIndex].duration, 1);
        timerPlay.start();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T16:33:43.223

我建议这样做：

```
// ...

timerPlay.start();

// Move these two variables outside of ontimerPlay. Variables defined in functions 
// generally last only while the function is being executed.
var i:int = 0;
// The timer will fire three times. Each time it fires, i will be incremented.
var timerDelay:Timer = new Timer(1000, 3);

function ontimerPlay(evt:TimerEvent):void{
    // Remove the for loop. The way you had it, three timers were starting and ending 
    // all at the same time.

    timerDelay.addEventListener(TimerEvent.TIMER, ontimerDelay);
    timerDelay.start();
}

function ontimerDelay(evt:TimerEvent):void{
    obstacleArray[i].play();
    i++;
} 
```

# java - 通过循环为按钮分配 onClickListeners - Android

> ID：14898737
> 
> 赞同：3
> 
> 时间：2013-02-15T16:12:47.623
> 
> 标签：java, android, button, onclicklistener

我知道如何通过冗长的非优雅方式完成这项任务，但我想缩短它并使其更优雅。下面我展示了我可以用非优雅的方式做什么，以及我想如何优雅地做。优雅的方式不是编译。我评论了错误的位置和错误。

任何代码结构帮助表示赞赏！先感谢您。

结果.java

```
public class Results extends Activity {
int x = -1;

Button q1details, q2details, q3details, q4details, q5details, q6details, q7details, q8details, q9details, q10details;

final Context context = this;

@Override
public void onCreate(Bundle savedInstanceState) {

    q1details = (Button)findViewById(R.id.q1details);
    q2details = (Button)findViewById(R.id.q2details);
    q3details = (Button)findViewById(R.id.q3details);
    q4details = (Button)findViewById(R.id.q4details);
    q5details = (Button)findViewById(R.id.q5details);
    q6details = (Button)findViewById(R.id.q6details);
    q7details = (Button)findViewById(R.id.q7details);
    q8details = (Button)findViewById(R.id.q8details);
    q9details = (Button)findViewById(R.id.q9details);
    q10details = (Button)findViewById(R.id.q10details);

    buttonList.add(q1details); buttonList.add(q2details); buttonList.add(q3details); buttonList.add(q4details); buttonList.add(q5details); buttonList.add(q6details); buttonList.add(q7details); buttonList.add(q8details); buttonList.add(q9details); buttonList.add(q10details);

    for(int i = 0; i < buttonList.size(); i++) {
        buttonList.get(i).setText("Question Details");
        buttonList.get(i).setOnClickListener(new OnClickListener() {
            public void onClick(View arg0) {
                x = i;  //ERROR:  "Cannot refer to a non-final variable  i inside an inner class defined in a different method."  But I cannot put the i as Final in a for-loop.
                displayDetails();
            }
        });
    }

/*      q1details.setOnClickListener(new OnClickListener() {
        public void onClick(View arg0) {
            x = 0;
            displayDetails();
        }
    });
            //I could do 10 of these to accomplish the task but its non-elegant...
*/

public void displayDetails() {

    final Dialog dialog = new Dialog(context);
    dialog.setContentView(R.layout.questiondetails);
    dialog.setTitle("Question " + (x + 1) + " Details");

    ImageView image = (ImageView)dialog.findViewById(R.id.image);
    TextView correctness = (TextView)dialog.findViewById(R.id.correctness);
    TextView questionHeader = (TextView)dialog.findViewById(R.id.questionHeader);
    TextView question = (TextView)dialog.findViewById(R.id.question);
    TextView selectedAnswerHeader = (TextView)dialog.findViewById(R.id.selectedAnswerHeader);
    TextView selectedAnswer = (TextView)dialog.findViewById(R.id.selectedAnswer);
    TextView correctAnswerHeader = (TextView)dialog.findViewById(R.id.correctAnswerHeader);
    TextView correctAnswer = (TextView)dialog.findViewById(R.id.correctAnswer);
    TextView points = (TextView)dialog.findViewById(R.id.points);
    TextView verseHeader = (TextView)dialog.findViewById(R.id.verseHeader);
    TextView verse = (TextView)dialog.findViewById(R.id.verse);
    Button close = (Button)dialog.findViewById(R.id.close);

    if(qs.get(x).getSelectedAnswer() == qs.get(x).getCorrectAnswer()) {
        image.setBackgroundResource(R.drawable.green_check_mark);
        correctness.setText("CORRECT!");
        correctness.setTextColor(Color.GREEN);
    } else {
        image.setBackgroundResource(R.drawable.red_x);
        correctness.setText("INCORRECT!");
        correctness.setTextColor(Color.RED);
    }

    String a = "<u>QUESTION</u>";
    questionHeader.setText(Html.fromHtml(a));
    question.setText(qs.get(0).getQuery());

    String b = "<u>ANSWER YOU SELECTED</u>";
    selectedAnswerHeader.setText(Html.fromHtml(b));
    selectedAnswer.setText("" + qs.get(0).getStringSelectedAnswer());

    String c = "<u>CORRECT ANSWER</u>";
    correctAnswerHeader.setText(Html.fromHtml(c));
    correctAnswer.setText("" + qs.get(0).getStringCorrectAnswer());

    points.setText("You received " + QuestionView.getPointsPerQuestion().get(x) + " out of a possible 100 points.");

    String d = "<u>PROVE THE ANSWER IN YOUR BIBLE</u>";
    verseHeader.setText(Html.fromHtml(d));
    verse.setText(qs.get(0).getVerse());        

    close.setText("Close");

    close.setOnClickListener(new OnClickListener() {
        public void onClick(View arg0) {
            dialog.dismiss();
        }
    });
    dialog.show();
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-15T16:37:25.913

在匿名类的外部范围内声明的最终引用可供该匿名类访问。（Java 的闭包风格）：

```
for(int i = 0; i < buttonList.size(); i++) {
    Button button = buttonList.get(i);
    button.setText("Question Details");

    final int j = i;

    button.setOnClickListener(new OnClickListener() {
        public void onClick(View arg0) {
            x = j;
            displayDetails();
        }
    });
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T16:15:56.823

里面的代码`onClick()`将在按下 Button 时运行，而不是在循环期间运行......所以即使你以某种方式制作`i`final，它也不会保持你期望的值。

但是，您可以使用泛型`setTag()`和`getTag()`方法来存储`i`.
就像是：

```
for(int i = 0; i < buttonList.size(); i++) {
    Button button = buttonList.get(i);
    button.setTag(i);
    button.setText("Question Details");
    button.setOnClickListener(new OnClickListener() {
        public void onClick(View arg0) {
            x = (Integer) arg0.getTag();
            displayDetails();
        }
    });
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T16:18:32.630

您不能像这样在匿名函数中引用变量。有 3 种方法可以解决此问题。

1）在视图上使用 setTag 和 getTag 来标记它的索引号

2）不要使用匿名类。使其成为在函数外部（但在活动类内部）定义的私有类，并使其通过其构造函数获取索引。

3）在每次点击时，遍历按钮列表并找到等于传入视图的索引。

我认为 2 号是最干净的，但它们中的任何一个都可以。

# c# - SocketAsyncEventArgs 缓冲区填充了“System.Byte []”而不是发送的消息

> ID：14898740
> 
> 赞同：1
> 
> 时间：2013-02-15T16:13:01.757
> 
> 标签：c#, asynchronous, windows-phone-7.1, windows-phone, tcplistener

我最近开始开发一个 Windows Phone 7.1 应用程序。该应用程序需要服务器从数据库中获取答案。为此，我打算使用套接字和 tcp 连接。

它连接到服务器的效果非常好，但是当我开始尝试流式传输数据时，输出始终是“System.Byte []”。我认为它只是从 byte[] 到字符串的一些错误转换，但它似乎比这更复杂。缓冲区实际上加载了一个 ASCII 符号的 byte[]，仅表示“System.Byte[]”。发送的信息是“Bam！” 在长度为 4 的字节 [] 中。我不知道为什么会这样，但从我能够收集到的信息来看，发送的消息似乎只是在传输过程中被修改过。请帮我解决一下这个。

这是我的 Windows Phone 客户端代码

```
public partial class MainPage : PhoneApplicationPage
{
    // Constructor
    public MainPage()
    {
        InitializeComponent();
    }
    private IPAddress ServerAddress = new IPAddress(0xff00ff00); //I sensored my IP
    private int ServerPort = 13000;
    private Socket CurrentSocket;

    private void Button_Click(object sender, RoutedEventArgs e)
    {
        try
        {
            ConnectToServer();
        }
        catch (Exception exception)
        {
            Dispatcher.BeginInvoke(() => MessageBox.Show("Error: " + exception.Message));
        }
    }

    private void ConnectToServer()
    {
        CurrentSocket = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);

        //Create a new SocketAsyncEventArgs
        SocketAsyncEventArgs socketEventArgs = new SocketAsyncEventArgs();
        socketEventArgs.RemoteEndPoint = new IPEndPoint(ServerAddress, ServerPort);
        socketEventArgs.Completed += ConnectionCompleted;

        socketEventArgs.SetBuffer(new byte[32], 0, 32);

        CurrentSocket.ConnectAsync(socketEventArgs);
    }

    private void ConnectionCompleted(object sender, SocketAsyncEventArgs e)
    {
        Dispatcher.BeginInvoke(() => MessageBox.Show("You are connected to the server"));

        //Create a new SocketAsyncEventArgs
        SocketAsyncEventArgs socketEventArgs = new SocketAsyncEventArgs();
        socketEventArgs.RemoteEndPoint = new IPEndPoint(ServerAddress, ServerPort);
        socketEventArgs.Completed += MessageReceived;

        socketEventArgs.SetBuffer(new byte[32], 0, 32);

        CurrentSocket.ReceiveAsync(socketEventArgs);
    }

    private void MessageReceived(object sender, SocketAsyncEventArgs e)
    {
        Dispatcher.BeginInvoke(() => MessageBox.Show("You have received a message!"));

        string message1 = Convert.ToString(e.Buffer);
        string message2 = Encoding.UTF8.GetString(e.Buffer, e.Offset, e.BytesTransferred);

        if (message1.Equals(message2))
            Dispatcher.BeginInvoke(() => MessageBox.Show(message1));

        CurrentSocket.ReceiveAsync(e);
    }
} 
```

这是 C# 服务器代码

```
class ConnectionHandler
{
    TcpListener listener;

    public ConnectionHandler()
    {
        listener = new TcpListener(System.Net.IPAddress.Any, 13000);
        listener.Start();

        while (true)
        {
            Thread thread = new Thread(Service);
            Socket socket = listener.AcceptSocket();
            Console.WriteLine("Socket accepted");
            thread.Start(socket);
        }
    }

    public void Service(object arg)
    {
        Socket socket = (Socket)arg;

        try
        {
            Stream stream = new NetworkStream(socket);
            Console.WriteLine("Stream created");

            string output = "Bam!";

            Byte[] bytes = Encoding.UTF8.GetBytes(output);

            StreamWriter writer = new StreamWriter(stream);

            writer.Write(bytes);
            writer.Flush();
            writer.Close();

            output = Encoding.UTF8.GetString(bytes);

            Console.WriteLine("Message sent: " + output);

            stream.Close();
        }
        catch (Exception e)
        {
            Console.WriteLine("You got an error in ConnectionHandler");
            Console.WriteLine(e.Message);
            socket.Close();
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T16:31:50.533

问题出在你的`Service`方法上。

[StreamWriter](http://msdn.microsoft.com/en-us/library/system.io.streamwriter.aspx)允许您将 Unicode 字符串写入底层[Stream](http://msdn.microsoft.com/en-us/library/system.io.stream.aspx)。在将字符串写入 Stream 之前，它使用[Encoding将字符串转换为字节。](http://msdn.microsoft.com/en-us/library/system.text.encoding.aspx)

您`"Bam!"`自己将字符串转换为字节，然后调用[StreamWriter.Write 方法 (Object)](http://msdn.microsoft.com/en-us/library/dfc2b8zk.aspx) — [StreamWriter](http://msdn.microsoft.com/en-us/library/system.io.streamwriter.aspx)类没有接受`byte[]`.

[StreamWriter.Write 方法（对象）](http://msdn.microsoft.com/en-us/library/dfc2b8zk.aspx)在传递的对象上调用ToString [。](http://msdn.microsoft.com/en-us/library/system.object.tostring.aspx)[ToString](http://msdn.microsoft.com/en-us/library/system.object.tostring.aspx)`"String.Byte[]"`方法 返回一个`byte[]`.

*解决方案：*

```
string output = "Bam!";

StreamWriter writer = new StreamWriter(stream);
writer.Write(output);
writer.Flush();
writer.Close(); 
```

*或者*

```
string output = "Bam!";

Byte[] bytes = Encoding.UTF8.GetBytes(output);

stream.Write(bytes, 0, bytes.Length); 
```

# javascript - scrollLeft 在 Internet Explorer 中不起作用

> ID：14898742
> 
> 赞同：2
> 
> 时间：2013-02-15T16:13:06.157
> 
> 标签：javascript, html, scroll

我正在尝试使滚轮水平滚动页面。像 Windows 8 Metro 界面和新的 myspace 网站。

我只是无法让它在 Internet Explorer (10) 中工作。我的 JSFiddle：http: [//jsfiddle.net/88dRJ/4/](http://jsfiddle.net/88dRJ/4/)

我已经尝试删除溢出以使滚动条可见。微软在他们的 doScroll 文档中声明它不适用于隐藏的滚动条。我更喜欢隐藏的滚动条。

Javascript

```
var mouseWheelEvt = function (e) {
    var event = e || window.event;
    if (document.body.doScroll) {
        document.body.doScroll(event.wheelDelta > 0 ? "left" : "right");
    } else if ((event.wheelDelta || event.detail) > 0) {
        document.body.scrollLeft -= event.wheelDelta || 120;
    } else {
        document.body.scrollLeft -= event.wheelDelta || -120;
    }
    return false;
};
document.addEventListener("mousewheel", mouseWheelEvt);
document.addEventListener("DOMMouseScroll", mouseWheelEvt); 
```

编辑：为了澄清我更喜欢没有 jquery 或其他库的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T16:33:06.193

对于 IE，您需要使用`document.documentElement`而不是`document.body`访问/修改`scrollLeft`或`scrollTop`

`document.documentElement.scrollLeft -= event.wheelDelta || 120`;

# ruby-on-rails - 在 Ruby on Rails 中的 redirect_to 上保留引荐来源网址

> ID：14898744
> 
> 赞同：0
> 
> 时间：2013-02-15T16:13:18.537
> 
> 标签：ruby-on-rails, ruby-on-rails-3

出于网络跟踪的目的，我想`redirect_to`在 Rails 中使用时保留 HTTP 引荐来源网址。这是重定向到相应语言版本所必需的。

代码示例：

```
redirect_to "/#{Option[:locales].first}", :status => 301 
```

如何在不使用查询参数的情况下保留引荐来源网址？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T16:40:21.720

[这个问题](https://stackoverflow.com/questions/771656/correctly-doing-redirect-to-back-in-ruby-on-rails-when-referrer-is-not-availabl)中详细介绍了几种方法。

`store_referrer`我首选的方法是在你的控制器中设置一个 before_filter ，它在我的`application_controller`. 然后`redirect_back_or_default`在您的操作中使用该方法来处理重定向。

```
def store_referrer
  session[:return_to] = request.request_uri
end

def redirect_back_or_default(default)
  redirect_to(session[:return_to] || default)
  session[:return_to] = nil
end 
```

您还可以查看`redirect_to :back`Rails 中可用的方法，或者如果您使用的是 Authlogic/Devise，它们都带有类似的帮助器来做同样的事情。

看看链接的线程，[troex的](https://stackoverflow.com/users/216254/troex)[这个](https://stackoverflow.com/a/12064410/403664)建议是一个很好的建议。

# ajax - ASP.NET MVC3 Razor 中的 Ajax

> ID：14898745
> 
> 赞同：1
> 
> 时间：2013-02-15T16:13:22.583
> 
> 标签：ajax, asp.net-mvc, razor

我对 Ajax 有疑问。我想制作多个表单并在提交后用部分视图替换包含一个的 div。当我只使用一种表格时，它对我有用。我不知道我在这里做错了什么。也许是因为自定义编辑器？这是我的代码，请尝试帮助我，我已经尝试了 2 天。

**指数**

```
@model MetriceWeb.Models.TaskInputModel
@{
    ViewBag.Title = "Tasks";
}
<h3>
    Tasks</h3>

@if (Model.Values.Count == 0)
{
   <p>No pendings forms for you at the moment</p>
}
else
{
    @Html.EditorFor(x => x.Values)
} 
```

**TaskInputValue（编辑器）**

```
@model MetriceWeb.Models.TaskInputValue
@{string s = "task" + Model.TaskId;}

@using (Ajax.BeginForm("GetFromLibrary", "Metrice", new AjaxOptions
{
HttpMethod = "Get",
UpdateTargetId = s,
InsertionMode = InsertionMode.Replace
}))
{
<div class="editor-field" id="@s">
@Html.HiddenFor(x => x.TaskId, new { @class = "TaskId" , id = "TaskId" })
@Html.HiddenFor(x => x.InputId, new { @class = "InputId" })
<h2>
@Html.DisplayFor(x => x.Task)
</h2>
<span>Created: </span>
@Html.DisplayFor(x => x.Date)

<div>
Input Value

    @Html.EditorFor(x => x.DateValue)
    @Html.ValidationMessageFor(x => x.DateValue)
</div>
<input type="submit" value="Submit" />
</div>
<br />
} 
```

它在我的控制器中输入方法，我正在返回部分视图。提交后我的 div 没有被替换，整个新站点被加载。这里有什么问题？请帮助我，我非常需要。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T16:26:56.523

为了使`Ajax`助手`Ajax.BeginForm`能够正常工作（例如发送 AJAX 请求），您需要在视图中参考以下 JavaScript 文件

```
jquery.unobtrusive-ajax.js 
```

（当然在那个jquery之前）

来自[ASP.NET MVC 3 中的 Unobtrusive Ajax](http://bradwilson.typepad.com/blog/2010/10/mvc3-unobtrusive-ajax.html)

> 一个有趣的注意事项：因为当您使用不显眼的 Ajax 时不会发出实际的 JavaScript，如果您忘记包含一个或另一个脚本，则在尝试提交 Ajax 请求时不会看到任何错误；它的行为就像一个非 Ajax 请求。

# .net - 为什么LINQPad.exe需要调用LINQPad.exe才能运行？

> ID：14898751
> 
> 赞同：1
> 
> 时间：2013-02-15T16:13:48.493
> 
> 标签：.net, process, linqpad

我使用 LINQPad 连接到不同的环境，比如“本地”和“开发”。连接设置在 LINQPad.exe 的配置文件中。

为了帮助我组织设置，我想制作几个 LINQPad.exe 副本，并使用相应的配置文件重命名它们，如下所示：

*   LINQPad.local.exe
*   LINQPad.local.config
*   LINQPad.development.exe
*   LINQPad.development.config

但是 LINQPad.exe 在启动时抱怨：

应用程序必须命名为 LINKPad.exe 才能运行。

为什么是这样？

PS 很明显，我不是在问如何管理我的配置文件（我现在有不同的文件夹）——我更好奇有什么编程原因可以强制执行进程的名称？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-16T01:40:58.917

强制执行此操作的原因是您的查询依赖于 LINQPad.exe（对于 .Dump() 等方法）。因此，如果您重命名文件，CLR 将无法找到正确的程序集。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T16:19:26.713

如果您查看 Reflector 中的源代码，您会发现它需要一个特定的名称。

```
if (Path.GetFileName(Assembly.GetExecutingAssembly().Location).ToLowerInvariant() != "linqpad.exe")
{
    MessageBox.Show("The application must be named LINQPad.exe in order to run.", "LINQPad");
} 
```

它还按名称引用配置文件，因此它可能会强制执行程序集名称以保持简单。

# javascript - 将对象转换为可通过 eval() 复制的文本；带有函数对象的异常

> ID：14898752
> 
> 赞同：0
> 
> 时间：2013-02-15T16:13:57.720
> 
> 标签：javascript

我的目标是将对象转换为文本形式，可以使用*localStorage*进行存储，然后使用 eval() 检索并转换回其原始对象形式。我编写了一个名为 uneval() 的函数来转换为文本，如下所示：

```
function uneval(obj){
// Convert object to a string that can be evaluated with eval() to its original
if(obj===null)return 'null';
     if(typeof obj === 'number' || typeof obj === 'boolean')return ''+obj;
if(typeof obj === 'string')return '"'+obj+'"';
if(Object.prototype.toString.call(obj) === '[object Array]')
{   var str = '[', i=0, l=obj.length;
    for(i;i<l;i++)str+= (i==0?'':',') + uneval(obj[i]);
    return str+']';
}
if(typeof obj === 'object')
{   var str='({', i;
    for (i in obj)str+= (2==str.length?'':',') + i + ':' + uneval(obj[i]);
    return str+='})';
}
if(typeof obj === 'function')return '(' + obj.toString() + ')';

return '';} 
```

[编辑 1：{} 中的对象需要使用 eval() 成功转换括号]

[编辑 2：修改功能代码以在功能代码字符串周围放置括号]

[编辑 3：更改为用于递归避免 arguments.callee 的命名函数]

[编辑 4：处理空值]

请注意，此函数保留嵌套结构。它可以正常工作（至少在 Google Chrome 和 MS IE8 中），除非对象或对象的项是函数。我通过将字符串形式的函数分配给一个不太可能的变量（如“_=”）找到了一种解决方法。这就是工作。没有它，我会从 eval() 中得到一个语法错误。谁能解释一下为什么会这样？

顺便说一句，我可以通过在 _ 本地化的覆盖函数中调用 eval() 来避免使用 _ 作为变量发生冲突的可能性很小。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T18:06:16.687

在这段代码中：

```
var func = eval('function () {}'); 
```

`eval`将字符串解析为函数*声明*，而不是函数*表达式*，并且由于函数声明不能​​是匿名的，因此会引发语法错误。为了确保您的字符串被解析为函数表达式，而不是声明，只需在字符串的开头和结尾添加括号即可。这些父母将被解析为[分组运算符](http://ecma-international.org/ecma-262/5.1/#sec-11.1.6)。然后将分组运算符的内容解析为表达式；在这种情况下，一个函数表达式。

```
var func = eval('(function () {})'); // doesn't throw 
```

因此，在您的`uneval`函数中，执行以下操作：

```
if ( typeof obj === 'function' ) return '(' + obj.toString() + ')'; 
```

# python - 附加到图表的颜色条

> ID：14898753
> 
> 赞同：1
> 
> 时间：2013-02-15T16:14:00.030
> 
> 标签：python, matplotlib, wxpython

```
data = np.array(number_list)
self.fig = plt.Figure()
self.ax = self.fig.add_subplot(1,1,1)

N = data.max() + 5
self.ax.set_xlim(0,N)
self.ax.set_ylim(0,N)
self.ax.invert_yaxis()

self.ax.get_xaxis().set_visible(False)
self.ax.get_yaxis().set_visible(False)
self.ax.set_aspect('equal')
this = self.ax.scatter(data[:,1], data[:,0],color= 'black', marker = 's', s=3)

self.fig.colorbar(this, ticks=[-1, 0, 1],orientation='horizontal')

self.canvas = FigureCanvas(self, -1, self.fig)
self.toolbar = NavigationToolBar(self.canvas)
    self.vbox = wx.BoxSizer(wx.VERTICAL)
    self.vbox.Add(self.canvas, 1, wx.LEFT | wx.TOP | wx.GROW)
self.vbox.Add(self.toolbar,0,wx.EXPAND)
    self.vbox.AddSpacer(25)
    self.SetSizer(self.vbox)
    self.vbox.Fit(self) 
```

我尝试创建一个“附加”到图表的颜色栏，但是我得到了错误`TypeError: You must first set_array for mappable`。该图是一个矩阵图。我哪里错了？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T16:28:14.913

```
this = self.ax.scatter(data[:,1], data[:,0],color= 'black', marker = 's', s=3)

self.fig.colorbar(this, ticks=[-1, 0, 1],orientation='horizontal') 
```

问题在于这些方面。您已将所有标记设置为固定颜色，因此颜色条没有任何意义。如果要使用 ，则`colorbar`需要通过映射标量 -> 颜色来设置标记的颜色，如下所示：

```
this = self.ax.scatter(data[:,1], data[:,0],color=color_data, marker = 's', s=3)

self.fig.colorbar(this, ticks=[-1, 0, 1],orientation='horizontal') 
```

其中`len(color_data) == len(data[:,0]`和 是一维数组对象。

# vbscript - 从 VBScript 发送 Outlook 消息时如何避免 Outlook 安全警报？

> ID：14898756
> 
> 赞同：6
> 
> 时间：2013-02-15T16:14:09.290
> 
> 标签：vbscript, outlook, security-warning

我有这种情况：

*   代码**必须**在 VBScript 中（不在我的控制范围内）
*   无法在 Outlook 首选项中禁用编程访问限制（组策略，而不是管理员，并且 Windows 无法识别已安装的有效病毒扫描程序）
*   不能使用 SMTP，因为它是不允许的。

我认为*没有*办法使用 Outlook 以自动方式发送电子邮件（在无人看管的盒子上以屏幕锁定的用户身份登录）。我尝试了许多不同的方法，但总是会收到安全警告消息。我怎样才能解决这个问题？

我已经在[这个](http://www.outlookcode.com/article.aspx?id=52)有用的网站上尝试了所有方法，并消除了每个选项，如下所示：

> **策略**
> 理想情况下，自动化 Outlook 的应用程序应该避免触发这些安全提示的代码。

这**正是**我最终做的事情（请参阅下面的答案），这就是为什么该页面上的所有其他选项都不相关的原因。让我们一一来看：

> **发送消息**
> 如果您的目标只是创建和发送电子邮件消息，则根本不需要使用 Outlook 对象。Microsoft 提供了用于使用 SMTP 创建和发送消息的 CDO for Windows 库。使用此库完全绕过 Outlook 和 MAPI，并且不会触发安全提示。有关代码示例，请参阅...

SMTP。不行。网络策略不允许。

> 对于所有可能触发安全提示的代码，请使用扩展 MAPI 而不是 Outlook 对象、简单 MAPI 或 CDO 1.21。

扩展的 MAPI 可能会起作用，但它非常繁琐和冗长，并且涉及大量 C/C++ 代码（这不是这个问题的主题；见上文），并且在不提示用户输入密码的情况下似乎无法使用它。

> 对所有可能触发安全提示的代码使用第三方库——Redemption 或 MAPI33。这种方法比使用扩展 MAPI 更容易，后者具有陡峭的学习曲线，并且几乎同样安全。这些库还提供其他功能来帮助处理 Outlook 代码项目。

第三方库的问题有四个方面： - 他们花钱；- 即使它们是免费的，它们也会引入许可问题（一些组织在允许软件进入生态系统之前需要律师的广泛审查）；- 整个问题甚至令人担忧的大多数环境是用户**无法**在 Outlook 选项中禁用编程访问警告的环境。嗯，那些可能的情况是什么？会不会是……*企业环境*? 在企业环境中采购软件需要很长时间，以至于不切实际，除非使用它所节省的成本将超过数百万美元。但是，可以进行许多实际的流程改进，这些改进不会产生那么高的成本节约，但如果需要软件采购，采购第三方软件所花费的金钱和劳动力将超过总节约成本。- 网络管理员可能不相信该软件驻留在系统上，因为它可能被用于恶意目的。

> 使用您的应用程序部署一个工具来抑制安全提示。

这假设**抑制**OMG 提示是必要的，在我的情况下，它不是，只是发送一封简单的电子邮件（见我的回答）。

> 对于 Outlook 2007，请确保计算机正在运行最新的防病毒应用程序并使用 Outlook 对象进行所有编码，避免使用 CDO 1.21 和简单 MAPI 代码。

病毒扫描程序是最新的，但我完全无法控制更改其版本或供应商，并且 Outlook 无法识别它。它说：“防病毒状态：无效。此版本的 Windows 支持防病毒检测，但未找到防病毒。”

> 在 Outlook 自定义表单代码、Outlook VBA 代码和 COM 加载项中，从 VBA 或加载项体系结构提供的 Outlook.Application 对象派生所有对象。例如，请参阅下面的示例 VBA“运行脚本”规则过程。

有趣，可能有用，但不是必需的。这对在 Outlook 中设置规则以部署软件产生了不必要的依赖，这使部署复杂化。

> 部署“信任”某些 COM 加载项或允许所有应用程序不受限制地访问某些功能（例如访问地址）的 Outlook 安全设置。在 Outlook 2007 之前的版本中，这需要 Microsoft Exchange Server。对于 Outlook 2007，请参阅下面有关版本特定注意事项的部分。

繁琐：安装 COM 插件需要管理权限，并且在某些组织中很难通过管理权限获得。

> 在以 Exchange 为电子邮件服务器的企业环境中，可以通过从 Exchange 2000 开始的 WebDAV API 以及从 Exchange 2007 开始的 Exchange Web 服务直接访问服务器上的数据。

在我的环境中禁用，可能还有其他环境。

> 在公司环境中，管理员可以选择为部分或所有用户放松 Outlook 安全性。

当然可以，但这需要与网络团队进行沟通/协调/合作。如果管理访问不可用于安装 COM 插件，则它也可能不可用于放松组策略。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-15T16:14:09.290

此代码适用于我的带有 Outlook 2010 的系统，无需用户交互即可发送电子邮件。它*有点*脆弱，因为如果用户在撰写邮件时碰巧在系统上积极工作（打字、点击），则可能会发生用户输入进入弹出窗口的瞬间，并且要么干扰邮件的发送，要么在邮件正文中添加额外的未知字符。

只要在其系统上运行此功能的用户意识到这一点，并且虚假击键干扰的潜在后果不是关键业务，此功能是可以接受的。

需要注意的重要一点：这个解决方案的关键是我们不调用该`MailItem.Send`方法。这是触发程序访问保护的方法。相反，我们触发`ALT`+`s`快捷方式，默认情况下，当邮件窗口在 Outlook 中具有焦点时，按下“发送”按钮。如果您启用了默认的拼写检查提示，则会弹出进一步的拼写检查提示。我们的解决方案是禁用拼写检查提示，尽管我相信您可以添加更多 SendKeys 来单击它，因为拼写检查提示不是与安全相关的对话框。

*关于 UIPI（用户界面特权隔离）的说明：*

Outlook 2010 以登录系统的用户身份运行，具有**中等**完整性级别。由 Windows 资源管理器启动的程序，或作为以类似方式启动的程序的子程序或后代启动的程序，也将以**中等**完整性级别启动。UIPI 对防止“SendKeys”类型输入无效，只要用户和会话 ID 匹配，并且完整性级别相同或更高。在我的特定环境中，用户和会话 ID 相同，VBScript 宿主进程和 Outlook 进程的完整性级别相同。在您的环境中，如果其中任何一个条件为假，则此代码将**不起作用**。它还在比 2010 版更早或更高版本的 Office 上未经测试。

```
Sub SendEmail_Outlook()
    Set WshShell = WScript.CreateObject("WScript.Shell")
    Set ol=CreateObject("Outlook.Application") 
    Set Mail=ol.CreateItem(0) 
    Mail.to= "you@example.com"
    Mail.Subject = "test"
    Mail.HTMLBody = "test"
    Mail.Display    
    WshShell.SendKeys "%s"
    Set Mail = Nothing 
    Set ol = Nothing 
End Sub

SendEmail_Outlook 
```

此外，这里是从 Windows 任务计划程序运行 VBScript 时如何使这项工作。只需勾选红色椭圆所描绘的框“以最高权限运行”，以使其在没有 UAC 提升的情况下以可能的最高完整性级别运行（如果您不是管理员帐户，则为“中”）。

![windows任务调度程序属性](../Images/a269dc13fb3a817ce73de4d26329ed25.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-26T23:26:33.867

几个选项：

1.  最新的防病毒软件（此时 Outlook 不会显示提示）
2.  扩展 MAPI（C++ 或 Delphi，不适用于 VB 脚本）。但是，您可以使用像[Redemption](http://www.dimastr.com/redemption)这样的包装器，它使用扩展 MAPI，但可以从包括 VBS 在内的任何语言访问。
3.  [ClickYes 之](http://www.contextmagic.com/express-clickyes/)类的产品。

有关讨论和可用选项列表，请参见[http://www.outlookcode.com/article.aspx?id=52 。](http://www.outlookcode.com/article.aspx?id=52)

# ruby-on-rails - 如何使 has_one 关联模型显示在类 attributes() 结果中？

> ID：14898763
> 
> 赞同：2
> 
> 时间：2013-02-15T16:14:56.203
> 
> 标签：ruby-on-rails, associations, nested-attributes, rails-activerecord, has-one

在哪里`Person` `has_one` `Brain`，我应该期望`brain`出现在for**返回的哈希** `attributes()`中`Person`？如果是这样，如何做到这一点？

Rails 控制台输出：

```
1.9.3p327 :003 > Person.new.attributes
 => {"id"=>nil, "name"=>nil, "created_at"=>nil, "updated_at"=>nil} 
1.9.3p327 :004 > Brain.new.attributes
 => {"id"=>nil, "weight_kg"=>nil, "created_at"=>nil, "updated_at"=>nil, "person_id"=>nil} 
```

这两个模型是`Person`和`Brain`：

```
class Person < ActiveRecord::Base
  has_one :brain
  attr_accessible :name
  attr_accessible :brain
  attr_accessible :brain_attributes
  accepts_nested_attributes_for :brain

end

class Brain < ActiveRecord::Base
  belongs_to :person
  attr_accessible :weight_kg
  attr_accessible :person
  attr_accessible :person_attributes
  accepts_nested_attributes_for :person
end 
```

`person_id`显示在属性中，`Brain`因为该`brains`表有一个`person_id`列。该表不需要这样的列`people`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T16:43:24.877

不确定列出属性之间的关联是一个好主意，但您可以获得如下关联名称：

```
association_names = self.class.reflect_on_all_associations.map(&:name) 
```

请参阅[有关反思的文档](http://api.rubyonrails.org/classes/ActiveRecord/Reflection/ClassMethods.html#method-i-reflect_on_all_associations)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T16:51:40.120

它不会亲自显示大脑的属性，因为如果您查看人的 sql 表 .. 没有“大脑”字段 .. 但在大脑表中有 person_id。

维克多关于如何反思联想的好建议！

# jquery-ui - 将变量传递给 JQuery UI 对话框

> ID：14898765
> 
> 赞同：30
> 
> 时间：2013-02-15T16:15:00.697
> 
> 标签：jquery-ui

我正在使用 PHP 删除记录。我想使用 JQuery UI 对话框来确认操作，但我不知道如何将变量（我的 RecordID）传递给重定向 URL 函数，或允许 URL 访问`window.location.href`。

```
$("#confirm" ).dialog({
resizable: false,
autoOpen: false,
modal: true,
buttons: {
    'OK': function() {
            window.location.href = 'url and myvar??';
        $( this ).dialog( "close" );
        },
    'Cancel': function() {
        $( this ).dialog( "close" );
        }
    }
});

$("#delete").click(function() {
    $("#confirm").dialog( "open" ).html ( "Are U Sure?" );
    return false;
}); 
```

HTML

```
<a href='index.php?recordid=$row[recordid]' id='delete'>DELETE</a> 
```

有没有好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2013-02-15T16:50:51.590

您可以尝试使用 .data() 方法为您存储数据。看看这个答案 [Passing data to a jQuery UI Dialog](https://stackoverflow.com/questions/394491/passing-data-to-a-jquery-ui-dialog/3458299#3458299)

例如要传递一个变量，您可以在打开对话框之前使用 data 函数存储它

```
$("#dialog_div")
.data('param_1', 'whateverdata')
.dialog("open"); 
```

然后你可以通过以下方式取回：

```
var my_data = $("#dialog_div").data('param_1') 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-15T16:45:09.100

您想在单击时更改对话框的配置（在本例中为 Ok 按钮的行为）。为此，您有很多解决方案，所有这些都很难看（imo）。我建议即时生成一个对话框，并在使用后将其销毁，如下所示：

```
$("#delete").click(function(ev) {
    ev.preventDefault(); // preventDefault should suffice, no return false
    var href = $(this).attr("href");
    var dialog = $("<div>Are you sure?</div>");

    $(dialog).dialog({
        resizable: false,
        autoOpen: true,
        modal: true,
        buttons: {
            'OK': function() {
                window.location = href;
                $( this ).dialog( "close" );
            },
            'Cancel': function() {
                $( this ).dialog( "close" );
            }
        },
        close: {
            $( this ).remove();
        }
    });
}); 
```

或者更好的是，将确认对话框封装到一个函数中，以便您可以重复使用它，如下所示：

```
function confirmDialog(msg) {
    var dialog = $("<div>"+msg+"</div>");
    var def = $.Deferred();

    $(dialog).dialog({
        resizable: false,
        autoOpen: true,
        modal: true,
        buttons: {
            'OK': function() {
                def.resolve();
                $( this ).dialog( "close" );
            },
            'Cancel': function() {
                def.reject();
                $( this ).dialog( "close" );
            }
        },
        close: {
            $( this ).remove();
        }
    });
    return def.promise();
} 
```

然后像这样使用它

```
confirmDialog("are your sure?").done(function() {
    window.location = $(this).attr("href"); 
}).fail(function() {
    // cry a little
}); 
```

在关闭对话框之前，您可能必须检查延迟对象是否已被拒绝或解决，以确保在关闭时确认拒绝（而不仅仅是在按下“取消”按钮时）。这可以通过 def.state() === "pending" 条件来完成。

有关 jquery deferred 的更多信息：http: [//api.jquery.com/category/deferred-object/](http://api.jquery.com/category/deferred-object/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T16:52:28.917

删除操作可能不应该使用 GET 来完成，但如果你想这样做，我建议在 jQuery 中使用 $.data，这样每个链接都有一个 data-record-id 属性。然后单击其中一个链接，它会弹出对话框，并在确认后将其添加到 URL 并重定向。 **例子：**

```
$(function(){
    $(".deleteLink").click(function(){
       var id = $(this).data("record-id");
       var myHref = $(this).attr('href');
        $("#confirmDialog").dialog({
            buttons:{
            "Yes": function()
                {
                    window.location.href = myHref + id;
                }
            }
        });
    }); 
```

});

```
<a class="deleteLink" data-record-id="1">Delete</a>
...
<div id="confirmDialog">
   <p>Are you sure?</p>
</div> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-01-05T23:25:56.093

1.  HTML

    `<a data-title="Title" data-content="content" data-mydata="1" class="confirmation-dialog" href="#">Link</a>`

2.  JS

    `$('.confirmation-dialog').confirm({ buttons: { Yes: function(){ console.log(this.$target.attr('data-mydata')); No: function(){ } } });`

# joomla - 没有装饰器的 Joomla 菜单显示

> ID：14898766
> 
> 赞同：0
> 
> 时间：2013-02-15T16:15:06.007
> 
> 标签：joomla, joomla2.5, joomla-extensions

因为有几次后台管理员中的 Joomla 菜单在没有装饰器的情况下显示。

PHP没有抛出任何错误，所以我不明白为什么要这样做。

![在此处输入图像描述](../Images/e55b0d37335887d9e172a57b9bf8a156.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T09:53:16.573

好吧，我挖了

在 #_menu 表中，有一个 'level' 值非常高的声音，例如 4559099066767 。

'level'的声音，是类别嵌套的层次。这会导致代码内部出现无限循环，并将结果作为屏幕显示。

我的版本是 2.5.9

谢谢

# php - 如何使用 PHP 维护 HTTPS 连接

> ID：14898767
> 
> 赞同：0
> 
> 时间：2013-02-15T16:15:08.060
> 
> 标签：php, url, https, include

我目前在安全服务器上设置了一个网站。

当我访问我的网站时，浏览器将在页面加载开始时显示 HTTPS 安全连接符号，但是一旦页面完全加载，该符号将被划掉（谷歌浏览器）或消失（safari）。

我了解任何未通过 HTTPS 路径链接到特定页面的文件都会导致该页面不被视为安全。

我已将我的所有 CSS 和 JavaScript 文件设置为通过[https://www.example.com/file](https://www.example.com/file)访问，但是我知道我的所有 PHP 包含也必须通过 HTTPS 安全路径访问。

当我将 php.ini 文件设置为“allow_url_include = on”时，它仍然不允许我使用 URL 路径包含。我还设置了“allow_url_fopen = on”，但我仍然无法使用[https://www.example.com](https://www.example.com)包含 URL 。

有人可以向我解释如何使它工作，以便通过 HTTPS 包含每个 PHP 包含，以便我的所有页面都将在用户的浏览器中显示为 HTTPS？（这是一个电子商务网站，所以这个因素对我的用户来说很重要）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T16:22:14.000

> 我已将所有 CSS 和 JavaScript 文件设置为可通过[https://www.example.com/file访问](https://www.example.com/file)

好的。

您还需要对所有图像以及包含的任何其他资源执行此操作。

> 但是我知道我所有的 PHP 包含也必须通过 HTTPS 安全路径访问。

一般来说，PHP 包含应该从文件系统中完成，并且根本不命中 HTTP(S)（因为那是低效的）。

浏览器看不到 PHP 做了什么，所以这不是问题的原因。

# java - 如何使用 getJSONArray 方法访问 json 对象的嵌套元素

> ID：14898768
> 
> 赞同：65
> 
> 时间：2013-02-15T16:15:09.653
> 
> 标签：java, json, arrays

我有一个如下所示的 JSON 响应：

```
{
  "result": {
    "map": {
      "entry": [
        {
          "key": { "@xsi.type": "xs:string", "$": "ContentA" },
          "value": "fsdf"
        },
        {
          "key": { "@xsi.type": "xs:string", "$": "ContentB" },
          "value": "dfdf"
        }
      ]
    }
  }
} 
```

我想访问`"entry"`数组对象的值。我正在尝试访问：

```
RESPONSE_JSON_OBJECT.getJSONArray("entry"); 
```

我越来越`JSONException`。有人可以帮我从上面的 JSON 响应中获取 JSON 数组吗？

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2013-02-15T16:28:37.160

您必须分解整个对象才能到达`entry`数组。

假设`REPONSE_JSON_OBJECT`已经是一个已解析的`JSONObject`.

```
REPONSE_JSON_OBJECT.getJSONObject("result")
    .getJSONObject("map")
    .getJSONArray("entry"); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-02-15T16:58:08.883

我建议你使用[Gson](http://code.google.com/p/google-gson/)库。它允许将 JSON 字符串解析为对象数据模型。请看我的例子：

```
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

import com.google.gson.Gson;
import com.google.gson.GsonBuilder;
import com.google.gson.annotations.SerializedName;

public class GsonProgram {

    public static void main(String... args) {
        String response = "{\"result\":{\"map\":{\"entry\":[{\"key\":{\"@xsi.type\":\"xs:string\",\"$\":\"ContentA\"},\"value\":\"fsdf\"},{\"key\":{\"@xsi.type\":\"xs:string\",\"$\":\"ContentB\"},\"value\":\"dfdf\"}]}}}";

        Gson gson = new GsonBuilder().serializeNulls().create();
        Response res = gson.fromJson(response, Response.class);

        System.out.println("Entries: " + res.getResult().getMap().getEntry());
    }
}

class Response {

    private Result result;

    public Result getResult() {
        return result;
    }

    public void setResult(Result result) {
        this.result = result;
    }

    @Override
    public String toString() {
        return result.toString();
    }
}

class Result {

    private MapNode map;

    public MapNode getMap() {
        return map;
    }

    public void setMap(MapNode map) {
        this.map = map;
    }

    @Override
    public String toString() {
        return map.toString();
    }
}

class MapNode {

    List<Entry> entry = new ArrayList<Entry>();

    public List<Entry> getEntry() {
        return entry;
    }

    public void setEntry(List<Entry> entry) {
        this.entry = entry;
    }

    @Override
    public String toString() {
        return Arrays.toString(entry.toArray());
    }
}

class Entry {

    private Key key;
    private String value;

    public String getValue() {
        return value;
    }

    public void setValue(String value) {
        this.value = value;
    }

    public Key getKey() {
        return key;
    }

    public void setKey(Key key) {
        this.key = key;
    }

    @Override
    public String toString() {
        return "[key=" + key + ", value=" + value + "]";
    }
}

class Key {

    @SerializedName("$")
    private String value;

    @SerializedName("@xsi.type")
    private String type;

    public String getValue() {
        return value;
    }

    public void setValue(String value) {
        this.value = value;
    }

    public String getType() {
        return type;
    }

    public void setType(String type) {
        this.type = type;
    }

    @Override
    public String toString() {
        return "[value=" + value + ", type=" + type + "]";
    }
} 
```

程序输出：

```
Entries: [[key=[value=ContentA, type=xs:string], value=fsdf], [key=[value=ContentB, type=xs:string], value=dfdf]] 
```

如果你不熟悉这个库，那么你可以在“ [Gson 用户指南](https://sites.google.com/site/gson/gson-user-guide)”中找到很多信息。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2015-12-29T12:06:36.953

使用 Gson 库尝试此代码并完成工作。

```
Gson gson = new GsonBuilder().create();

JsonObject job = gson.fromJson(JsonString, JsonObject.class);
JsonElement entry=job.getAsJsonObject("results").getAsJsonObject("map").getAsJsonArray("entry");

String str = entry.toString();

System.out.println(str); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-10-01T19:10:33.420

这是给尼古拉的。

```
 public static JSONObject setProperty(JSONObject js1, String keys, String valueNew) throws JSONException {
    String[] keyMain = keys.split("\\.");
    for (String keym : keyMain) {
        Iterator iterator = js1.keys();
        String key = null;
        while (iterator.hasNext()) {
            key = (String) iterator.next();
            if ((js1.optJSONArray(key) == null) && (js1.optJSONObject(key) == null)) {
                if ((key.equals(keym)) && (js1.get(key).toString().equals(valueMain))) {
                    js1.put(key, valueNew);
                    return js1;
                }
            }
            if (js1.optJSONObject(key) != null) {
                if ((key.equals(keym))) {
                    js1 = js1.getJSONObject(key);
                    break;
                }
            }
            if (js1.optJSONArray(key) != null) {
                JSONArray jArray = js1.getJSONArray(key);
                JSONObject j;
                for (int i = 0; i < jArray.length(); i++) {
                    js1 = jArray.getJSONObject(i);
                    break;
                }
            }
        }
    }
    return js1;
}

public static void main(String[] args) throws IOException, JSONException {
    String text = "{ "key1":{ "key2":{ "key3":{ "key4":[ { "fieldValue":"Empty", "fieldName":"Enter Field Name 1" }, { "fieldValue":"Empty", "fieldName":"Enter Field Name 2" } ] } } } }";
    JSONObject json = new JSONObject(text);
    setProperty(json, "ke1.key2.key3.key4.fieldValue", "nikola");
    System.out.println(json.toString(4));

} 
```

如果对兄弟有帮助，请不要忘记为我的名声）））

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-02-15T16:31:02.060

你可以试试这个：

```
JSONObject result = new JSONObject("Your string here").getJSONObject("result");
JSONObject map = result.getJSONObject("map");
JSONArray entries= map.getJSONArray("entry"); 
```

我希望这有帮助。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-09-30T18:20:31.477

我也面临这个问题。所以我用递归解决了。也许会有所帮助。我创建了方法。我使用了 org.json 库。

```
 public static JSONObject function(JSONObject obj, String keyMain, String newValue) throws Exception {
    // We need to know keys of Jsonobject
    Iterator iterator = obj.keys();
    String key = null;
    while (iterator.hasNext()) {
        key = (String) iterator.next();
        // if object is just string we change value in key
        if ((obj.optJSONArray(key)==null) && (obj.optJSONObject(key)==null)) {
            if ((key.equals(keyMain)) && (obj.get(key).toString().equals(valueMain))) {
                // put new value
                obj.put(key, newValue);
                return obj;
            }
        }

        // if it's jsonobject
        if (obj.optJSONObject(key) != null) {
            function(obj.getJSONObject(key), keyMain, valueMain, newValue);
        }

        // if it's jsonarray
        if (obj.optJSONArray(key) != null) {
            JSONArray jArray = obj.getJSONArray(key);
            for (int i=0;i<jArray.length();i++) {
                    function(jArray.getJSONObject(i), keyMain, valueMain, newValue);
            }
        }
    }
    return obj;
} 
```

如果你有问题，我可以解释...

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2016-07-26T17:48:12.133

我也会这样尝试

1) 从 JSON 模式创建 Java Bean

2) 使用 JSON 解析器库来避免任何类型的异常

3) 将解析结果转换为从初始 JSON 模式创建的 Java 对象。

下面是一个示例 JSON Schema"

```
{
  "USD" : {"15m" : 478.68, "last" : 478.68, "buy" : 478.55, "sell" : 478.68,  "symbol" : "$"},
  "JPY" : {"15m" : 51033.99, "last" : 51033.99, "buy" : 51020.13, "sell" : 51033.99,  "symbol" : "¥"},
} 
```

* * *

## 代码

```
public class Container { 

    private JPY JPY;

    private USD USD;

    public JPY getJPY ()
    {
        return JPY;
    }

    public void setJPY (JPY JPY)
    {
        this.JPY = JPY;
    }

    public USD getUSD ()
    {
        return USD;
    }

    public void setUSD (USD USD)
    {
        this.USD = USD;
    }

    @Override
    public String toString()
    {
        return "ClassPojo [JPY = "+JPY+", USD = "+USD+"]";
    }
}

public class JPY
{    
    @SerializedName("15m")
    private double  fifitenM;

    private String symbol;

    private double last;

    private double sell;

    private double buy;

    public double getFifitenM ()
    {
        return fifitenM;
    }

    public void setFifitenM (double fifitenM)
    {
        this.fifitenM = fifitenM;
    }

    public String getSymbol ()
    {
        return symbol;
    }

    public void setSymbol (String symbol)
    {
        this.symbol = symbol;
    }

    public double getLast ()
    {
        return last;
    }

    public void setLast (double last)
    {
        this.last = last;
    }

    public double getSell ()
    {
        return sell;
    }

    public void setSell (double sell)
    {
        this.sell = sell;
    }

    public double getBuy ()
    {
        return buy;
    }

    public void setBuy (double buy)
    {
        this.buy = buy;
    }

    @Override
    public String toString()
    {
        return "ClassPojo [15m = "+fifitenM+", symbol = "+symbol+", last = "+last+", sell = "+sell+", buy = "+buy+"]";
    }
}

public class USD
{
    @SerializedName("15m")
    private double fifitenM;

    private String symbol;

    private double last;

    private double sell;

    private double buy;

    public double getFifitenM ()
    {
        return fifitenM;
    }

    public void setFifitenM (double fifitenM)
    {
        this.fifitenM = fifitenM;
    }

    public String getSymbol ()
    {
        return symbol;
    }

    public void setSymbol (String symbol)
    {
        this.symbol = symbol;
    }

    public double getLast ()
    {
        return last;
    }

    public void setLast (double last)
    {
        this.last = last;
    }

    public double getSell ()
    {
        return sell;
    }

    public void setSell (double sell)
    {
        this.sell = sell;
    }

    public double getBuy ()
    {
        return buy;
    }

    public void setBuy (double buy)
    {
        this.buy = buy;
    }

    @Override
    public String toString()
    {
        return "ClassPojo [15m = "+fifitenM+", symbol = "+symbol+", last = "+last+", sell = "+sell+", buy = "+buy+"]";
    }
}

public class MainMethd
{
    public static void main(String[] args) throws JsonIOException, JsonSyntaxException, FileNotFoundException {
        // TODO Auto-generated method stub
        JsonParser parser = new JsonParser();
        Object obj = parser.parse(new FileReader("C:\\Users\\Documents\\file.json"));
        String res = obj.toString();
        Gson gson = new Gson();
        Container container = new Container();
        container = gson.fromJson(res, Container.class);
        System.out.println(container.getUSD());
        System.out.println("Sell Price : " + container.getUSD().getSymbol()+""+ container.getUSD().getSell());
        System.out.println("Buy Price : " + container.getUSD().getSymbol()+""+ container.getUSD().getBuy());
    }

} 
```

主要方法的输出是：

ClassPojo [15m = 478.68，符号 = $，最后 = 478.68，卖出 = 478.68，买入 = 478.55]

售价 : $478.68

购买价格 : $478.55

希望这可以帮助。

# sql-server - 通过 HTTP GET 读取 TSQL 中的二进制数据

> ID：14898771
> 
> 赞同：1
> 
> 时间：2013-02-15T16:15:22.457
> 
> 标签：sql-server, tsql, http, binaryfiles

我需要通过 HTTP URL 将一些图像导出到我的 SQL Server 中。

我找到了有关导出 XML 数据的文章：

```
sp_configure 'show advanced options', 1;
GO
RECONFIGURE;
GO
sp_configure 'Ole Automation Procedures', 1;
GO
RECONFIGURE;
GO

Declare @Object as Int; 
Declare @ResponseText as Varchar(8000); 
Declare @Url as Varchar(MAX); 
select @Url = 'http://somexml.com/xmlfile.xml'

Exec sp_OACreate 'MSXML2.XMLHTTP', @Object OUT; 
Exec sp_OAMethod @Object, 'open', NULL, 'get', @Url, 'false' 
Exec sp_OAMethod @Object, 'send' 
Exec sp_OAMethod @Object, 'responseText', @ResponseText OUTPUT      
Exec sp_OADestroy @Object 

--load into Xml 
Declare @XmlResponse as xml; 
select @ResponseText 
```

同样在研究过程中，我发现我应该将**ADODB.Stream**用于二进制数据。但我不知道如何使用上述方法读取此对象。有没有办法在纯 TSQL 中读取二进制数据，或者我应该为此使用 CLR？

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-05-08T08:14:42.767

我和你有同样的问题，找到了怎么做！这是我的 sql（它支持检索文本和二进制数据）：

```
EXEC sp_configure 'show advanced options', 1;
GO
RECONFIGURE;
GO
EXEC sp_configure 'Ole Automation Procedures', 1;
GO
RECONFIGURE;
GO

declare @xmlObject as int
declare @responseText as varchar(max)
declare @responseBody as varbinary(max)
declare @status as int
declare @url as varchar(2048)

select @url = 'http://someurl.com/someimage.jpg'

exec sp_OACreate 'MSXML2.XMLHTTP', @xmlObject OUT;
exec sp_OAMethod @xmlObject, 'open', NULL, 'get', @url, 'false'
exec sp_OAMethod @xmlObject, 'send'
exec sp_OAMethod @xmlObject, 'status', @status OUTPUT
exec sp_OAMethod @xmlObject, 'responsetext', @responseText OUTPUT
declare @responseTable as table ( body varbinary(max) )
INSERT INTO @responseTable exec sp_OAMethod @xmlObject, 'responsebody'
exec sp_OADestroy @xmlObject

select @status
select @responseText
select @responseBody=body from @responseTable    
select @responseBody 
```

希望这对那里的人有帮助:)

# php - 文件上传临时目录为空

> ID：14898777
> 
> 赞同：0
> 
> 时间：2013-02-15T16:15:58.873
> 
> 标签：php, upload

我正在研究文件上传如何在 PHP 中工作。

当我上传文件时，`$_FILES`全局说临时文件名是`/tmp/phpDFUMAz`，但这不存在。

如果我检查ini设置，`upload_tmp_dir`我可以看到以下内容：

```
upload_tmp_dir  no value 
```

PHP 到底在做什么？它为上传的文件提供了一个临时文件名，但服务器上不存在该文件名。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T16:21:41.397

临时文件在您上传到的脚本完成后被删除。如果您想保留文件以供以后使用，您上传的脚本也需要将文件移出临时目录。

# javascript - 如何在不将其添加到每个 JS 文件中的情况下对所有文件调用通用 JavaScript 函数？

> ID：14898778
> 
> 赞同：1
> 
> 时间：2013-02-15T16:16:03.100
> 
> 标签：javascript, jquery, html, web-applications

我有一个 log.js 文件（它包含日志功能以及一些属性）用于调试目的。我还有另外两个 js 文件，它们控制着 Web 应用程序的各种行为。现在我需要包含日志函数，考虑到不在 js 文件中重复调试函数而只调用文件名。我该怎么做？这个想法是让我的代码干净并将它们分开在其他文件中以限制单个 js 文件的大小。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-15T16:17:33.403

在 html 页面中包含所有 .js 文件。首先包含 log.js。随心所欲地调用函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T16:21:27.673

所有文件中的所有功能都包含在源代码中并“写在页面上”，任何功能都可以从 HTML 中的任何位置访问，因为它们本质上都是一个文档。确保您没有重复的功能，因为这可能会导致问题

# python - 从 Python 打印到 Heroku 日志时出现 Unicode 错误

> ID：14898779
> 
> 赞同：3
> 
> 时间：2013-02-15T16:16:05.163
> 
> 标签：python, heroku, utf-8

我有一个 python 脚本，它使用他们的调度程序插件在 Heroku 上定期运行。它会打印一些调试信息，但是当文本中有非 ASCII 字符时，我会在日志中收到错误消息，例如：

```
SyntaxError: Non-ASCII character '\xc2' in file send-tweet.py on line 40, but no encoding declared; see http://www.python.org/peps/pep-0263.html for details 
```

那是我在脚本中有这样一行的时候：

```
print u"Unicode test: £ ’ …" 
```

我不知道该怎么办。如果我在脚本中有这个：

```
import locale
print u"Encoding: %s" % locale.getdefaultlocale()[1] 
```

然后在日志中输出：

```
Encoding: UTF-8 
```

那么，为什么要尝试以 ASCII 格式输出其他文本却失败了呢？

**更新：** FWIW，这是我正在使用[的实际脚本。](https://github.com/philgyford/samuelpepys-twitter/blob/81633756f7479f70ad94ff1ffed97d51f05a5dc7/send-tweet.pyy)调试输出在第 38-39 行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T16:51:20.097

正如错误所说：

```
no encoding declared 
```

即在您的 Python 源文件中没有声明任何编码。

链接的 PEP 告诉您如何在 Python 源代码中声明编码：编码应设置为您的编辑器/IDE 在您输入示例中的 unicode 字符 £ 时使用的表。最有可能假定为 UTF-8，因此在您输入的第一行`send-tweet.py`：

```
# coding=utf-8 
```

如果第一行已经包含一个路径指令，例如：

```
#!/usr/local/bin/python 
```

然后将编码指令放在第二行，例如

```
#!/usr/local/bin/python
# coding=utf-8 
```

此外，在 Python 源代码中编写 Unicode 字符并声明 UTF-8 编码时，您**必须**使用支持 UTF-8 文件保存的编辑器，即可以将 Unicode 代码点序列化为 UTF-8 的编辑器。

在这方面，请注意 Unicode 和 UTF-8 是不一样的。Unicode 是指标准，而 UTF-8 是一种特定的编码，它决定了如何将 Unicode 码位序列化为与 ASCII 兼容的字符串，并使用 1 到 4 个字节来表示原始 Unicode 字符串。

因此，在 Python 解释器中，字符串可能存储为 Unicode，但如果要将 Unicode 字符串编写为 UTF-8，则需要先将字符串显式序列化为 UTF-8，例如

```
s.encode("utf-8") 
```

这在将 Unicode 字符串输出到字节大小的流时尤其重要，例如，当写入通常假定字节大小的字符的日志文件句柄时，即 UTF-8 用于包含非 ASCII 字符的内容。

# eclipse - 在 Eclipse rcp 中关闭视图

> ID：14898791
> 
> 赞同：2
> 
> 时间：2013-02-15T16:16:35.597
> 
> 标签：eclipse, eclipse-plugin, eclipse-rcp

我正在使用 Eclipse RCP 来开发我的应用程序。

我有一个带有桌子的视图。双击该表中的一条记录时，它会为该记录打开一个新视图以进行编辑，如果我为每条记录单击该表中的多个记录，则会有多个视图。但是，当我从父视图（我有表）中删除一条记录时，它应该删除为编辑该记录而打开的视图。

如果我从父视图的表中删除记录，如何关闭视图。

任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T16:32:58.570

我用它来隐藏视图。

```
 IWorkbenchPage page = PlatformUI.getWorkbench()
                .getActiveWorkbenchWindow().getActivePage();
        page.hideView(page.findView(View.ID)); 
```

# python - Python：从内部和外部for循环迭代器中删除项目

> ID：14898798
> 
> 赞同：1
> 
> 时间：2013-02-15T16:16:47.420
> 
> 标签：python, list, for-loop, iterator

这段代码有潜在危险吗？它会与内部和外部迭代混淆吗？

```
for a in listA:
            for b in listB: 
                if [... something...]:
                    ... something else...
                    listA.remove(a)
                    listB.remove(b)
                    break 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-15T16:24:29.610

这段代码有潜在危险吗？要看。在迭代序列时减小序列的大小会产生意想不到的行为。

考虑这个例子

```
listA = [1,2,3,4]

>>> for a in listA:
    listA.remove(a)
    print a 
```

因为，在删除项目时，超出它的所有项目都被推向左侧，您打算迭代的项目将自动移动到下一个元素

第一次迭代：

```
 listA = [1,2,3,4]
             ^
             |
_____________|

    listA.remove(a)

    listA = [2,3,4]
             ^
             |
_____________|

    print a
    (outputs) 1 
```

第二次迭代：

```
 listA = [2,3,4]
               ^
               |
_______________|

    listA.remove(a)

    listA = [2,4]
               ^
               |
_______________|

    print a
    (outputs) 3 
```

第三次迭代：

```
 listA = [2,4]
                 ^
                 |
_________________|

(Exits the Loop) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T16:24:06.533

更改被迭代的序列通常是 Python 中的反模式。虽然您可以在特定情况下围绕它跳舞，但最好看看您是否可以构建一个仅包含您需要的项目的新列表（或字典）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-15T16:36:57.143

我同意 jknupp - 删除列表中的项目可能比创建新项目更昂贵。然而，另一个技巧是倒着做：

```
>>> l = range(5)
>>> for a in reversed(l):
...     print a
...     l.remove(a)
... 
4
3
2
1
0 
```

# asp.net - Internet Explorer：FileUpload 控件无法识别具有长文件名的文件

> ID：14898799
> 
> 赞同：1
> 
> 时间：2013-02-15T16:16:49.243
> 
> 标签：asp.net, windows, internet-explorer, file-upload, name-length

阅读此问题后，您可能会认为这在某种程度上是不切实际的，但在我们的一个生产应用程序中存在以下情况。

我们的一位用户报告说，如果他尝试上传名称过长的文件，他会收到错误消息，我们必须通过将文件名限制为不超过 255 个字符（包括文件扩展名）来解决这个问题。但是我们遇到了另一种奇怪的行为，它只存在于 Internet Explorer 中。

如果用户尝试上传包含扩展名在内的长度为 255 个字符的文件，则 FileUpload 不会选择文件（即无法识别文件）并且显示文件名的文本框保持空白。这在 IE8、IE9 和 IE 10 中有效！这在 ASP.NET 或 SharePoint 解决方案中有效。

我尝试在 GMail 中上传相同的文件，我能够在除 Internet Explorer 之外的所有浏览器中上传它，这意味着它与 IE 相关。

有什么建议么？任何修复？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T16:47:14.140

不幸的是，它似乎（曾经？）是 Windows 的“功能”。

请参阅：http: [//msdn.microsoft.com/en-us/library/aa365247%28v=vs.85%29.aspx#maxpath](http://msdn.microsoft.com/en-us/library/aa365247%28v=vs.85%29.aspx#maxpath)

> 本地路径按以下顺序构造：驱动器号、冒号、反斜杠、由反斜杠分隔的名称组件和终止空字符。例如，驱动器 D 上的最大路径是“D:\some 256-character path string”，其中“”表示当前系统代码页的不可见终止空字符。

我想你应该避免操作完整**路径**超过 260 个字符的文件，

不知道在文件输入文本框中使用“\?\”很长的名称前缀是否可行。

希望这会有所帮助。

# awk - 通过使用 awk 脚本比较其他文件中的字符串来输出记录

> ID：14898804
> 
> 赞同：1
> 
> 时间：2013-02-15T16:17:08.667
> 
> 标签：awk

我想使用 awk 脚本 file1 代码在另一个文件中输出具有匹配字符串的记录

```
849002|48|1208004|1
849007|28|1208004|1
855003|48|1208004|1
855004|28|1208004|1
855006|28|1208004|1 
```

文件2代码：

```
00990029000000004804470425|ST1400029|0.550|Recurring|1248073|ST1400029
00990029000000008410517183|IM1450029|1.000|Recurring|855003|ST1400029
009900290000000000007800612988|IM3350029|1.000|Recurring|1248063|ST1400029 
```

注意`855003`出现在每个样本的中间行吗？这就是我正在寻找的匹配，输出应该是：

```
00990029000000008410517183|IM1450029|1.000|Recurring|855003|ST1400029 
```

因为我想在file2中的$5中搜索file1的$1，如果找到匹配则输出我试过的行，但它返回零记录

```
awk 'NR==FNR{a[$1]=$1;next}a[$5]{print $0}' file2 file1  > outfile 
```

您的帮助将解决我的问题，我必须搜索一长串数据

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T16:23:54.140

不要忘记使用`-F`标志设置分隔符：

```
awk -F "|" 'FNR==NR { a[$1]; next } $5 in a' file1 file2 
```

结果：

```
00990029000000008410517183|IM1450029|1.000|Recurring|855003|ST1400029 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T16:23:42.813

试试这个（没有测试）

```
awk 'NR==FNR{a[$1];next}$5 in a' file1 file2 
```

# sql - GROUP BY 选择一列

> ID：14898806
> 
> 赞同：2
> 
> 时间：2013-02-15T16:17:10.417
> 
> 标签：sql, select, group-by, database

如果我选择一列，例如

```
SELECT columnname FROM table 
```

结果是否总是与

```
SELECT columnname FROM table GROUP BY columnname 
```

还是取决于数据库管理系统？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T16:18:03.677

不，这*不*一样，因为第一个查询可能返回重复项，而第二个查询不会。

另一方面，此查询将返回与该查询相同的结果`group by`：

```
SELECT DISTINCT columnname FROM table 
```

结果的顺序可能不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T16:18:47.833

它不一样，如果你 grup oyu 每个列名只会得到一条记录，另一个你可以有多个。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-15T16:45:56.853

您发布的任何查询都没有定义顺序...要设置顺序，您必须放置 ORDER BY 子句，如下所示：

```
 SELECT columnname FROM table ORDER BY columnname; 
```

结果可能会出现重复的行...这取决于您的表上是否有重复的值。GROUP BY 子句只会选择每种类型中的一种，可以如下设置：

```
 SELECT columnname FROM table GROUP BY columnname ORDER BY columnname; 
```

或者，正如 Dasblink 之前所说，使用 DISTINCT 子句......

```
 SELECT DISTINCT columnname FROM table ORDER BY columnname; 
```

请注意，您可以仅使用 ORDER BY 和参数或放置 ASC 或 DESC 条件，因此顺序将来自较高的值到较低的值。

# javafx-2 - 在属性中使用 fx:constant？

> ID：14898808
> 
> 赞同：5
> 
> 时间：2013-02-15T16:17:20.460
> 
> 标签：javafx-2, constants, fxml

我想知道，是否可以`<fx:constant>`在属性中使用而不是单独的标签？

目前这对我有用：

```
<Label>
    <text>
        <MyController fx:constant="MY_CONSTANT_STRING" />
    </text>
</Label> 
```

虽然我更喜欢这样的东西：

```
<Label text="<MyController fx:constant="MY_CONSTANT_STRING" />" /> 
```

后一种可能吗？

感谢您的任何提示！

# javascript - Javascript 获取图像的源代码

> ID：14898817
> 
> 赞同：0
> 
> 时间：2013-02-15T16:17:38.310
> 
> 标签：javascript, html

想象一下使用记事本在您的计算机上打开一个图像文件。我正在尝试使用 javascript 从 img 标记或 Image 对象中获得相同的结果。这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T16:19:07.490

您可以向服务器上的图像 URL 发送 AJAX 请求。

如果服务器发送好的缓存头，那甚至不会浪费带宽。

# magento - 更改 Magento 子类别的排序顺序

> ID：14898819
> 
> 赞同：0
> 
> 时间：2013-02-15T16:17:45.140
> 
> 标签：magento

我正在一个网站上显示与当前类别相关的所有子类别的列表。下面的代码可以正常工作，但我想更改子类别列表的排序方式。目前，它按类别 ID 排序。我希望它以 Magento 用户将类别放入管理员中的任何顺序显示（他们可以拖放以更改类别顺序）。感谢任何帮助！

```
 <?php
                $currentCat = Mage::registry('current_category');

                if ( $currentCat->getParentId() == Mage::app()->getStore()->getRootCategoryId() )
                {
                    // current category is a toplevel category
                    $loadCategory = $currentCat;
                }
                else
                {
                    // current category is a sub-(or subsub-, etc...)category of a toplevel category
                    // load the parent category of the current category
                    $loadCategory = Mage::getModel('catalog/category')->load($currentCat->getParentId());
                }
                $subCategories = explode(',', $loadCategory->getChildren());

                foreach ( $subCategories as $subCategoryId )
                {
                    $cat = Mage::getModel('catalog/category')->load($subCategoryId);

                    if($cat->getIsActive())
                    {
                        echo '<a href="'.$cat->getURL().'">'.$cat->getName().'</a>';
                    }
                }
            ?> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-15T16:43:51.463

尝试调用 getChildrenCategories 这将考虑每个类别的位置：

```
$loadCategory->getChildrenCategories() 
```

**已编辑**

与返回所有类别 ID 的字符串的 getChildren 不同，它返回一个 Mage_Catalog_Model_Category 数组，因此您需要更改代码以考虑到这一点。

从您上面的代码片段中，以下更改应该有效。请注意对 getChildrenCategories() 的调用和 foreach 循环中的更改，因为每个项目都应该是一个类别对象。

```
<?php
$currentCat = Mage::registry('current_category');

if ( $currentCat->getParentId() == Mage::app()->getStore()->getRootCategoryId() )
{
    // current category is a toplevel category
    $loadCategory = $currentCat;
}
else
{
    // current category is a sub-(or subsub-, etc...)category of a toplevel category
    // load the parent category of the current category
    $loadCategory = Mage::getModel('catalog/category')->load($currentCat->getParentId());
}
$subCategories = $loadCategory->getChildrenCategories();

foreach ( $subCategories as $subCategory )
{
    if($subCategory->getIsActive())
    {
        echo '<a href="'.$subCategory->getURL().'">'.$subCategory->getName().'</a>';
    }
}
?> 
```

# runtime - Powerbuilder (ver 7) 运行时问题

> ID：14898820
> 
> 赞同：2
> 
> 时间：2013-02-15T16:17:49.680
> 
> 标签：runtime, powerbuilder, powerbuilder-build-deploy

我们有一个旧的 Powerbuilder 应用程序在 Server 2000 上运行，需要移动它。我在将 Powerbuilder 应用程序 7.0 版移动到更新的平台 - Server 2003 时遇到问题。

我们基本上移动了包含应用程序和所有 Dll 的目录。然后我注册了允许它的那些。我们还必须设置 Informix 客户端软件并验证它能够连接到数据库。

该应用程序基本上采用 2 个参数，然后检查远程数据库中的数据，然后生成一个返回码以供另一个应用程序使用。我们得到的返回码是出乎意料的，我在查找号码时没有运气：

**-1073741811**

该应用程序从命令行运行。当我运行该应用程序时，我收到一个 Windows 错误，其中提到了 Sybase 和 msvcr80.dll 以及一个转储，以及上面提到的返回代码 - 这是清单文本中的错误：

```
Server=watson.microsoft.com
UI LCID=1033
Flags=99088
Brand=WINDOWS
TitleName=Sybase Inc. Product File
DigPidRegPath=HKLM\Software\Microsoft\Windows NT\CurrentVersion\DigitalProductId
RegSubPath=Microsoft\PCHealth\ErrorReporting\DW
ErrorText=This error occurred on 2/14/2013 at 7:56:14 AM.
HeaderText=Sybase Inc. Product File encountered a problem and needed to close.
Stage1URL=/StageOne/cert_lsi_exe/7_0_3_10180/msvcr80_dll/8_0_50727_6195/0001e6d5.htm
Stage2URL=/dw/stagetwo.asp?szAppName=cert_lsi.exe&szAppVer=7.0.3.10180&szModName=msvcr80.dll&szModVer=8.0.50727.6195&offset=0001e6d5
ErrorSig=AppName: cert_lsi.exe                AppVer: 7.0.3.10180     ModName: msvcr80.dll                       ModVer: 8.0.50727.6195        Offset: 0001e6d5
DataFiles=C:\DOCUME~1\smarkley\LOCALS~1\Temp\2\WER1.tmp.dir00\cert_lsi.exe.mdmp|C:\DOCUME~1\smarkley\LOCALS~1\Temp\2\WER1.tmp.dir00\appcompat.txt
Heap=C:\DOCUME~1\smarkley\LOCALS~1\Temp\2\WER1.tmp.dir00\cert_lsi.exe.hdmp
ErrorSubPath=cert_lsi.exe\7.0.3.10180\msvcr80.dll\8.0.50727.6195\0001e6d5 
```

我对 msvcr80.dll 请求感到惊讶，因为这个应用程序是在 2003 年左右编写的，我认为 c 编译器还没有到版本 8。我使用了 Dependency Walker，没有看到任何抱怨。不过，我可能在 DLLHell 中处理这件事……有人知道要寻找什么吗？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-10-05T15:22:47.863

我周围还有一些 PB 7 应用程序。

您是否尝试过应用程序兼容性？

导航到文件夹并右键单击可执行文件并选择兼容性选项卡。

我建议尝试

> 以兼容性运行此程序`Windows XP (Service Pack 3)`
> 
> 特权级别`[x] Run this program as administrator`

您可能需要使用`Windows XP (Service Pack 2)`Windows 或更早版本。

# python - 使用相同 url 模式的多个 django 应用程序

> ID：14898827
> 
> 赞同：1
> 
> 时间：2013-02-15T16:18:30.150
> 
> 标签：python, django, django-urls

我想运行两个具有相同 url 模式的应用程序。我想避免使用特定于应用程序的 slug，例如 domain.com/pages/something-here 或 domain.com/blog/something-there。

我试过这个：

```
# urls.py
urlpatterns = patterns('',
    url(r'^$', 'my.homepage.view'),
    url(r'^admin/', include(admin.site.urls)),
    url(r'^', include('pages.urls')),
    url(r'^', include('blog.urls')),
)

# pages/urls.py
urlpatterns = patterns('',
    url(r'^(.+)/$', views.page),
)

# blog/urls.py
urlpatterns = patterns('',
    url(r'^(.+)/$', views.post),
) 
```

我的代码不起作用，无论哪个先出现（此处为 pages.urls）都可以，其他 url（用于博客）抛出 404。

提前致谢

**编辑：**我是这样做的：在与 settings.py 相同的目录中创建了glue.py。它将处理我的主页和这个调度程序视图：

```
def dispatcher(request, slug):
    try:
        page = get_object_or_404(Page, slug=slug)
        return render(request, 'pages/page.html', {'page': page})
    except:
        post = get_object_or_404(Post, slug=slug)
        return render(request, 'blog/post.html', {'post': post}) 
```

不知道行不行 我希望有更好的方法。

感谢您的评论。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-05-12T15:41:29.437

我不知道这是否是一个更好的答案。但是，如果您对这些情况感到满意..

1.  如果您的 django 应用程序基于 django 模板渲染。

2.  您正在谈论的 url 不需要通过在浏览器本身中键入端点来直接访问。

然后，也许您可​​以考虑 url 命名空间和模板重定向。

[https://docs.djangoproject.com/en/1.11/topics/http/urls/#url-namespaces](https://docs.djangoproject.com/en/1.11/topics/http/urls/#url-namespaces)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T17:06:12.133

这不起作用，因为 django url 是按顺序解析的，这意味着与正则表达式匹配的第一个 url 将是已解析的。在您的情况下，将永远不会搜索博客应用程序中包含的 url，因为 django 已经解析了页面上的 url 包含行。

此外，django url 模块不应该知道某个页面或博客文章是否存在，因为我相信在您的应用程序中，这是通过数据库查找确定的。

urls 模块只执行连接到第一个匹配的正则表达式的视图。

您应该更改您的逻辑，例如将“blog/”附加到博客网址（这有什么问题？）

```
 url(r'^blog/', include('blog.urls')),
   url(r'^', include('pages.urls')), 
```

请注意，我将博客 url 向上移动，因为大多数通用 regxexp 应该始终是 django url 解析器尝试的最后一个。

或者，您可以编写一个代理视图来尝试博客文章和页面。但这对我来说似乎不是最好的方法。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-15T16:33:13.713

您希望它如何工作？他们都使用相同的 URL（这当然会导致问题）。用户如何访问“页面”而不是“博客”，反之亦然？

通常，您的 URL 模式中不能有重叠的 URL（不包括其他数据）。

编辑：

因此，您希望第一个应用程序检查它是否具有与 URL 匹配的视图，如果第一个应用程序没有，则下一步接管？你可以做一些复杂的事情，比如写一个“视图匹配器”来做你想做的事情，但是还有更直接的解决方案。

最简单的方法是更改`slug`​​您的一个应用程序的生成功能。让一个人使用除下划线以外的一些分隔符，或者总是将应用程序的名称附加到 slug 上。这样你就可以找到页面，因为它们的 url 是“some-slug-page”，而博客是“some-slug-blog”，然后你可以为其编写一个 URL 模式。如果您不想添加整个 URL，您可以仅附加/前置第一个字母，或任何您想要的。

**只需考虑一种您可以接受的方式来为每个应用程序生成 URL，只需读取 URL，您就可以知道该页面属于哪个应用程序。**

# visual-studio - 比较 TFS 2012 和 Subversion

> ID：14898831
> 
> 赞同：2
> 
> 时间：2013-02-15T16:18:48.910
> 
> 标签：visual-studio, svn, version-control, tfs

注意：这个问题讨论了 TFS- **2012**与 SVN。与早期 TFS 版本相比，类似（但不重复）的问题。

根据我的发现（在其他问题和网站上），微软已经修复了 TFS 早期版本（与 SVN 相比）的大部分早期抱怨（性能、功能等）。

**Team Foundation Server 2012**和**Subversion**解决方案（TortoiseSVN、VisualSVN、AnkhSVN）之间的主要优缺点是什么？还存在哪些 TFS 问题？svn 提供了哪些在 TFS 中不可用的功能？

# desire2learn - 使用 APP ID 和 APP KEY 将用户身份验证到 D2L

> ID：14898832
> 
> 赞同：1
> 
> 时间：2013-02-15T16:18:48.650
> 
> 标签：desire2learn

如果您已经使用 APPID 和 APPKEY 以及特定用户进行了身份验证（意味着当提示用户用户名和密码已输入并通过身份验证时）并且系统已发送回 USERID 和 USERKEY。然后，您能否调用 API 以将该用户验证到 D2L，以便用户到达 D2L MY HOME 页面？

除此之外...如果特定用户的 USERID 和 USERKEY 存储在数据库中，您是否可以单独使用该数据通过 API 调用将用户身份验证到 D2L 中，以便用户无需附加即可到达我的主页登录提示？

我知道如果 USERID 和 USERKEY 已过期，这将不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T14:35:31.903

这个问题有几个不同的问题。

**用户的活动网络会话**。目前，D2L 的 Valence 平台的用户身份验证不采用这种方式。当 LMS 可以确认它与用户有活动会话时，它只会在身份验证过程中提供用户 ID/密钥对：

1.  API 调用客户端直接向 LMS 发出请求以检索用户的用户 ID/密钥对。

2.  一个。如果 LMS 与用户有活动会话，（如有必要，生成并）返回该应用程序/用户对的用户 ID/密钥对。

    湾。如果 LMS 没有*与*用户的活动会话，请通过它配置的登录过程来验证用户：这可能是将调用 Web 请求重定向到 LMS 自己的用户登录页面，或者该重定向可以通过LMS 用于对用户进行身份验证的第三方服务（例如，已配置的 SSO IDP）。

这意味着：如果您使用 API 启动身份验证过程以检索用户 ID/密钥对，则调用 Web 浏览器将（作为该过程的一部分）已经与 LMS 进行了活动 Web 会话。要么用户将被要求使用 LMS 使用的任何身份验证进程登录，*要么*用户已经这样做并且调用浏览器将知道这一点（因为它具有指示活动会话的 cookie 状态）。

**程序化登录**。目前，D2L 的 Valence 平台不*支持*直接参与用户身份验证过程：没有调用通过提供用户 ID/密码或用户与 LMS 之间共享的任何其他秘密来使用 LMS 对用户进行身份验证。Valence 安全模型专门寻求避免让调用 API 的客户端知道用户和 LMS 之间共享的身份验证秘密。

使用 Valence 学习框架 API 的客户端需要：

*   通过向 LMS 请求 UserID/Key 对来启动身份验证过程（在这种情况下，LMS 将寻求对用户进行身份验证；请参阅上一个答案）

*   使用已从 LMS 收集的缓存状态中的有效用户 ID/密钥对重建用户上下文（反过来，这将需要真实用户向 LMS 进行身份验证）

**用户 ID/密钥对到期**。请注意，LMS 提供给调用客户端的这些身份验证令牌旨在*长期存在*。它们应该比浏览器为用户提供的当前 Web 会话持续时间更长。因此，客户端应用程序应将这些视为安全数据，*尤其*是结合客户端应用程序自己的 ID/Key 对（因为用户 ID/Key 对绑定了应用程序自己的 ID/Key 对）。虽然我们希望客户端应用程序缓存这些身份验证令牌，但我们也希望它们被缓存为敏感信息。

当以下事件之一发生时，为应用程序生成的用户 ID/密钥对将过期：

*   LMS 生成时与 ID/Key 对关联的到期时间的到来（LMS 管理员可以确保这些令牌的默认到期时间值是“不确定的”）

*   用户密码更改（由用户或 LMS 管理员重置）

*   LMS 管理员手动撤销用户的客户端应用程序访问权限

# php - 只能使用 jQuery 和 PHP 从表单列表中读取第一个值

> ID：14898833
> 
> 赞同：0
> 
> 时间：2013-02-15T16:18:51.847
> 
> 标签：php, jquery

我正在尝试用 jQuery 和 PHP 构建购物车，但无法从表单列表中读取值。当试图从提交的表单中获取值时，我只从列表视图中的第一个表单中获取值。

请在此处查看行为：http: [//www.adlertz.se/index.php?op=prodlist &katID=9&sidemenu=menushop](http://www.adlertz.se/index.php?op=prodlist&katID=9&sidemenu=menushop)

点击购买前。中间，你从第一个获得价值。

请帮帮我，我已经找了三天的解决方案。可能是一个简单的问题，但我无法在任何地方找到答案：| ！！！！

提前谢谢了！

```
 function prodlist(){
$katID = $_GET['katID'];

$sql = mysql_query("SELECT * FROM shop_prod WHERE kategoriID=$katID");

while ($rad=mysql_fetch_array($sql)) {
    echo "<div class=\"shop_prod_list\">";
        echo "<div class=\"shop_prod_list_tmb\"><img src=\"shop/images/prod_images_tmb/".$rad['prodID'].".png\" alt=\"\"></div>";

        echo "<form id=\"addcartform\" class=\"addcartform\" method=\"post\">";
        echo "<input type=\"hidden\" name=\"prodID\" id=\"prodID\" value=\"".$rad['prodID']."\" />";
        echo "<input type=\"submit\" class=\"shop_prod_list_kundvagn\" value=\"\" id=\"addcart\"/>";
        echo "</form>";

    echo "</div>";
}
echo "<div id=\"search_results\"></div>"; 
```

}

```
 $(document).ready(function(){ 

$(".addcartform").click(function(e){ 
    e.preventDefault(); 
    addcart(); 
}); 
```

});

```
 function addcart(){ 

var prodID=(this).document.getElementById('prodID').value; <-(Reads value but only the first)

$.post("functions/cart.php", {prodID : prodID}, function(data){
    if (data.length>0){ 
        $("#search_results").show();    
        $("#search_results").html(data);
    } 
}) 
```

}

```
 <?php
  include "db_config.php";
  include "db_connect.php";

$prodID = strip_tags(substr($_POST['prodID'],0, 100));
$prodID = mysql_escape_string($prodID);

echo $prodID ." is added."; 
```

?>

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T16:27:29.430

使用类而不是 id

```
echo "<input type=\"hidden\" name=\"prodID\" class=\"prodID\" value=\"".$rad['prodID']."\" />"; 
```

将被点击的元素发送到您的函数

```
$(".addcartform").click(function(e){ 
    e.preventDefault(); 
    addcart(this); //this line
}); 
```

然后使用该元素查找您的类的输入

```
function addcart(element){ 

    var prodID = $(element).find('.prodID').val();  //Get val of clicked item

    $.post("functions/cart.php", {prodID : prodID}, function(data){
        if (data.length>0){ 
            $("#search_results").show();    
            $("#search_results").html(data);
        } 
}) 
```

* * *

虽然我只会使用一个按钮，但没有这样的表格。

php：

```
echo "<button name='prodID' class='shop_prod_list_kundvagn addcart' data-prodid='".$rad['prodID']."' value='Add' />"; 
```

Javascript：

```
$(".addcart").click(function(e){ 
    e.preventDefault(); 
    var prodID = $(this).data('prodid');

    $.post("functions/cart.php", {prodID : prodID}, function(data){
        if (data.length>0){ 
            $("#search_results").show();    
            $("#search_results").html(data);
        } 
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T16:29:57.770

您用来挑选值的代码不正确。

从理论上讲，您应该拥有唯一的 ID - 所以这是您要解决的第一个问题。

其次，您需要找到更好的方法来定位您感兴趣的值。

我的建议是在每个表单中添加一个按钮并将其称为“提交”。

在此按钮上，您添加一个包含产品 ID 的数据属性。

使用此按钮上的 onclick 处理程序，您将能够直接获取数据属性。

未经测试的示例：

```
<button data-prodid="XYZ" onlcick="handleclick()">submit</button> 
```

Javascript：

```
$(this).data('prodid') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T16:36:47.080

请注意，同一页面上不应有重复的 ID。

在这种情况下，您的所有三个产品的 id 都是“prodID”。因此，在您的 JavaScript 中，当您 getElementById 时，您将始终获得具有该名称的第一个 ID。

有很多解决方案。例如，您可以将产品 ID 添加到按钮的 ID，例如`'id="addcart_' . $rad['prodID'] . '"'`

然后，您将在表单提交时解析该 ID 以确定选择了哪个产品。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-16T21:46:41.047

我在这里找到了另一个解决方案：http: [//api.jquery.com/serialize/](http://api.jquery.com/serialize/) - 传递隐藏值。

但是您的解决方案要简单得多:)

# c# - 如何在 C# 中 DateTimePicker 中的 DateTime 字段中显示时间？

> ID：14898834
> 
> 赞同：1
> 
> 时间：2013-02-15T16:18:54.207
> 
> 标签：c#, visual-studio, datetime, datetimepicker

今天的日期时间字段有很多麻烦......

我有一个 DateTime 字段，我想将它分开并显示为一个 DateTimePicker 中的日期和另一个 DTP 中的时间。这是我尝试过的：

```
dtp_date.Value = myRow.myDateTime.Date;
dtp_time.Value = myRow.myDateTime.TimeOfDay; 
```

我收到一条错误消息，指出它无法将类型“System.TimeSpan”转换为“System.DateTime”。我想我只是不明白我需要做些什么不同的事情。它所要做的就是立即显示一天中的时间，而不是存储在我的 DateTime 字段中的时间。

有人知道如何提取时间吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T16:21:51.377

您可以设置控件的`CustomFormat`属性：`DateTimePicker`

```
dtp_date.CustomFormat = CultureInfo.CurrentCulture.DateTimeFormat.ShortTimePattern;
dtp_date.Value = myRow.myDateTime; 
```

那应该显示您日期的时间部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T16:35:14.817

尝试给 DateTimePicker 一个有效的日期和时间。隐藏显示日期，仅使用 DateTimePickerFormat.Time 显示时间

```
DateTimePicker1.Value = new DateTime( DateTime.Now.Year, DateTime.Now.Month, DateTime.Now.Day, 5, 30, 0 ) 
```

从 myRow.myDateTime 字段中弹出您的时间值

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T16:36:51.373

只需使用您需要的值创建一个 New DateTime 对象： `dtp_time.Value = new DateTime(0,0,0,myRow.myDateTime.Hour,myRow.myDateTime.Minute, myRow.myDateTime.Second);`

# doctrine-orm - 教义“逆向”移除孤儿

> ID：14898835
> 
> 赞同：3
> 
> 时间：2013-02-15T16:18:56.683
> 
> 标签：doctrine-orm

我有两个实体（简化）：

```
class EncryptedMasterKey {
    /**
     * @ORM\ManyToOne(targetEntity="ExchangeFile", inversedBy="encryptedMasterKeys")
     * @ORM\JoinColumn(name="exchange_file_id", referencedColumnName="id")
     *
     * @var ExchangeFile
     */
    protected $exchangeFile;
} 
```

和

```
class ExchangeFile {
    /**
     * @ORM\OneToMany(targetEntity="EncryptedMasterKey", mappedBy="exchangeFile", orphanRemoval=true, cascade={"persist", "remove"})
     */
    protected $encryptedMasterKeys;
} 
```

数据库中可以有多个`EncryptedMasterKey`s `ExchangeFile`。如果`ExchangeFile`删除，所有相关的加密`MasterKeys`都将被删除（`orphanRemoval=true`并`cascade={"persist", "remove"}`确保是这种情况）。到现在为止还挺好。

现在由于实际文件在硬盘上是加密的，因此必须**至少有一个`EncryptedMasterKey`**文件才能解密。所以当 a`EncryptedMasterKey`被删除并且我发现它是它的最后一个时`ExchangeFile`，我也必须删除它，`ExchangeFile` **因为它不能再被解密了**。一个`ExchangeFile`人不能没有至少一个`EncryptedMasterKey`。

我如何实现这一目标？`@ORM\PreRemove`在`EncryptedMasterKey`课堂上并没有真正帮助我，因为我无权访问实体管理器：

```
class EncryptedMasterKey {
    //...
    /** @ORM\PreRemove */
    public function removeOrphanExchangeFile()
    {
        if ($this->exchangeFile->isTheOnlyMasterKey($this))
            // I don't have access to the Entity Manager,
            // so how do I delete the ExchangeFile?
    }
} 
```

有什么优雅的解决方案吗？

谢谢你的时间。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T16:42:53.987

您可以使用[事件订阅者](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/events.html#the-event-system)并创建如下类：

```
class MyEncryptedMasterSubscriber implements \Doctrine\Common\EventSubscriber
{
    public function getSubscribedEvents()
    {
        return array(\Doctrine\ORM\Events::onFlush);
    }

    public function onFlush(\Doctrine\ORM\Events\OnFlushEventArgs $eventArgs)
    {
        $uow = $eventArgs->getEntityManager()->getUnitOfWork();

        foreach ($uow->getScheduledEntityDeletions() AS $entity) {
            if (
                $entity instanceof EncryptedMasterKey 
                && $entity->getExchangeFile()->isTheOnlyMasterKey($entity)
            ) {
                $uow->scheduleForDelete($entity->getExchangeFile());
            }
        }
    }
} 
```

你可以阅读更多关于如何在 Symfony 2 的特定案例中注册订阅者[的文档](http://symfony.com/doc/2.0/cookbook/doctrine/event_listeners_subscribers.html)。

# php - mysql清理行名

> ID：14898836
> 
> 赞同：1
> 
> 时间：2013-02-15T16:18:58.920
> 
> 标签：php, sql, mysqli

我目前正在编写一个专注于安全性的 php 框架。我使用查询生成器来生成 SQL 语句，这样它就不会绑定到 MySQL。（或一般的 SQL）我发现用户可以注入行名的某些可能性，所以它必须以某种方式转义它们。由于查询生成器的工作方式，我很遗憾不能使用准备好的语句。我怎样才能解决这个问题？

编辑：

例如，该系统的工作方式如下：`db::select()-from('Tablename')->that('rowname')->run()`. 而且我担心一个用户可能会做类似的`that($_GET['foo'])`事情。我可以忍受，但我认为必须有一种方法来净化它

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T18:07:05.353

要逃避反引号，您必须将其[加倍](http://dev.mysql.com/doc/refman/5.0/en/identifiers.html)。这是我班上的一个函数

```
private function escapeIdent($value)
{
    if ($value)
    {
        return "`".str_replace("`","``",$value)."`";
    } else {
        $this->error("Empty value for identifier (?n) placeholder");
    }
}

//example:
$db->query("UPDATE users SET ?u=?s", $_POST['field'], $_POST['value']); 
```

因此，它将创建一个语法正确的标识符。

但最好将其[列入白名单](https://stackoverflow.com/a/8255054/285587)，因为可能有一个字段，尽管名称正确，但用户没有访问权限。（因此，从这个角度来看，基于模式的解决方案仍然很危险。想象一下，我的示例中有一个`role`带有查询值的字段） 我的类中有 2 个用于此目的的函数，它们都接受一个允许值的数组。`admin`

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-15T16:50:55.253

> 由于查询生成器的工作方式，我很遗憾不能使用准备好的语句。我怎样才能解决这个问题？

如果您不能使用查询参数，请更改查询构建器以将转义应用于其参数，然后再将它们插入 SQL 表达式。

***很多人正确地提倡查询参数，但如果***你正确且一致地进行转义，转义也是安全的。

参照。[mysqli::real_escape_string()](http://php.net/manual/en/mysqli.real-escape-string.php)

* * *

回复你的评论，好吧，我知道你要去哪里。我很困惑，因为您说的是“行名”，而这不是正确的术语。您必须指的是*列名*。

是的，你是对的，任何 MySQL API 中都没有函数可以正确转义表或列标识符。转义函数仅适用于字符串文字和日期文字。

当不受信任的输入命名表或列时，保护 SQL 查询的最佳方法是使用**白名单**。也就是说，针对已知表名或列名列表测试参数，您可以手动编码，也可以从[`DESCRIBE table`](http://dev.mysql.com/doc/refman/5.5/en/describe.html).

请参阅我过去的答案中的白名单示例：

*   [使用 PDO 转义列名](https://stackoverflow.com/questions/13448274/escaping-column-name-with-pdo/13448443#13448443)
*   [PHP PDO + 准备语句](https://stackoverflow.com/questions/8675704/php-pdo-prepare-statement/8675775#8675775)
*   我的演讲[SQL 注入神话和谬误](http://www.slideshare.net/billkarwin/sql-injection-myths-and-fallacies)
*   我的书[SQL 反模式：避免数据库编程的陷阱](http://www.pragprog.com/titles/bksqla/sql-antipatterns)。

# ios - 在 NSOperationQueue 和 AFNetworking 中显示 activityView WHILE 等待操作结束

> ID：14898841
> 
> 赞同：0
> 
> 时间：2013-02-15T16:19:26.247
> 
> 标签：ios, afnetworking, nsoperation, uiactivityindicatorview, nsoperationqueue

我找到了一种方法来排队 JSON 解析操作以等待完整的数据解析，这是代码：

```
- (void)LoadParse { // this method is called by a UIButton

    NSURLRequest *request = [NSURLRequest requestWithURL:url cachePolicy:NSURLRequestReloadIgnoringLocalAndRemoteCacheData timeoutInterval:5.0];

    AFJSONRequestOperation *operation = [AFJSONRequestOperation JSONRequestOperationWithRequest:request success:^(NSURLRequest *request, NSHTTPURLResponse *response, id JSON) {
        // PARSING SUCCESS CODE
        NSLog(@"operation completed"); <--- END OPERATION
        [self anotherMethod]; <--- CALL METHOD AFTER OPERATION IS FINISHED
    }
    failure:^(NSURLRequest *request, NSHTTPURLResponse *response, NSError *error, id JSON {
        // PARSING FAILURE CODE
    }];

    NSOperationQueue *queue = [[NSOperationQueue alloc] init];
    [queue addOperation:operation]; <--- START OPERATION

    // I NEED TO SHOW A SORT OF INDICATOR TO ADVERT USER THAT OPERATION ARE STILL LOADING
    // EXAMPLE: [DejalBezelActivityView activityViewForView:self.view withLabel:@"LOADING..."].showNetworkActivityIndicator = YES;

    [queue waitUntilAllOperationsAreFinished];

} 
```

队列完美运行：app 等待解析操作结束，然后调用**anotherMethod**。但是当仍然有加载操作时，我需要向用户展示一种**活动**视图：如你所见，我试图在**addOperation**和**waitUntilAllOperationsAreFinished**之间添加它，但我什么也看不到。这是正确的方法吗？那么，在所有操作完成之前放置 activityView 代码以查看它的正确位置在哪里，或者另一种方法来做到这一点？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T16:58:43.533

可以使用此代码

```
- (void)LoadParse { // this method is called by a UIButton

    NSURLRequest *request = [NSURLRequest requestWithURL:url cachePolicy:NSURLRequestReloadIgnoringLocalAndRemoteCacheData timeoutInterval:5.0];

    AFJSONRequestOperation *operation = [AFJSONRequestOperation JSONRequestOperationWithRequest:request success:^(NSURLRequest *request, NSHTTPURLResponse *response, id JSON) {
        // PARSING SUCCESS CODE
    }
    failure:^(NSURLRequest *request, NSHTTPURLResponse *response, NSError *error, id JSON {
        // PARSING FAILURE CODE
    }];

    NSOperationQueue *queue = [[NSOperationQueue alloc] init];
    [queue addOperation:operation];

    UIActivityIndicatorView *tempSpinner = [[UIActivityIndicatorView alloc]initWithActivityIndicatorStyle:UIActivityIndicatorViewStyleWhiteLarge];
    [self.view addSubview:tempSpinner]; 
    [tempSpinner startAnimating];

    [queue waitUntilAllOperationsAreFinished];

    [tempSpinner stopAnimating]; 
    //release tempSpinner if not using arc using [tempSpinner release];
    [self anotherMethod];
} 
```

# python - 有什么方法可以将静态方法应用于所有类方法？

> ID：14898843
> 
> 赞同：1
> 
> 时间：2013-02-15T16:19:30.897
> 
> 标签：python, static-methods

有没有办法将静态方法应用于给定类的所有方法。

我在想我们可以访问其元类中的方法（在**新**的元类中）并应用静态方法，但我不知道语法。任何人都可以阐明这一点吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T16:20:43.803

如果没有一个方法共享任何状态，那么根本没有理由拥有一个类。具有功能的模块可能是一个更好的主意...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-15T16:24:45.677

虽然[模块（如 mgilson 所建议的）](https://stackoverflow.com/a/14898860/722121)是一个更好的选择，但如果您*真的*对此有很好的用途（我想不出一个），那么使用[模块`inspect`和](http://docs.python.org/3/library/inspect.html)类装饰器相对容易：

```
import inspect

def staticmethods(cls):
    for name, method in inspect.getmembers(cls, inspect.ismethod):
        setattr(cls, name, staticmethod(method.__func__))
    return cls

@staticmethods
class Test:
    def test():
        print("Test")

Test.test() 
```

类装饰器所做的就是用 循环遍历对象上的方法，然后用原始（未绑定）函数的`inspect.getmembers()`a 覆盖该函数。`staticmethod()`

请注意，我会为此使用一个模块而不是一个类，并且可能也只是手动调用`@staticmethod`每个函数而不是这样做（例如，这会破坏我的编辑器的检查）。给出这个答案是为了表明它是可能的，因为它是一个非常简单的实现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-15T16:41:56.210

[mgilson 的答案](https://stackoverflow.com/a/14898860/1235039)是最好的，但要添加另一种通常用于将类定义为命名空间的模式，您还可以实例化该类，覆盖类名：

```
class Test:
    def a_static_method(self, arg1, srg2):
        pass

Test = Test() 
```

但是请注意，这`Test`实际上是一个类实例，这可能会产生误导，具体取决于您使用它的方式。

# vb.net - 使用开始/暂停/停止下载文件

> ID：14898847
> 
> 赞同：1
> 
> 时间：2013-02-15T16:19:45.187
> 
> 标签：vb.net

有什么办法可以在我的 vb 程序中暂停文件下载？我已经尝试了 http 方法和 my.computer.net 方法，但都没有成功。我也尝试过通过这种方法暂停后台工作者：[URL] 但即使 bgworker 被暂停，下载也会继续......

```
Dim locationfiledownload As String
Dim whereToSave As String 'Where the program save the file

Delegate Sub ChangeTextsSafe(ByVal length As Long, ByVal position As Integer, ByVal percent As Integer, ByVal speed As Double)
Delegate Sub DownloadCompleteSafe(ByVal cancelled As Boolean)

Public Sub DownloadComplete(ByVal cancelled As Boolean)
    ToolStripButton2.Enabled = True
    ToolStripButton3.Enabled = False

    If cancelled Then
        Me.Label4.Text = "Cancelled"
        MessageBox.Show("Download aborted", "Aborted", MessageBoxButtons.OK, MessageBoxIcon.Information)
    Else
        Me.Label4.Text = "Successfully downloaded"
        MessageBox.Show("Successfully downloaded!", "All OK", MessageBoxButtons.OK, MessageBoxIcon.Information)
    End If

    Me.RadProgressBar1.Value1 = 0
    Me.Label4.Text = ""

End Sub

Public Sub ChangeTexts(ByVal length As Long, ByVal position As Integer, ByVal percent As Integer, ByVal speed As Double)
    Me.Label4.Text = "Downloaded " & Math.Round((position / 1024), 2) & " KB of " & Math.Round((length / 1024), 2) & "KB"
    Me.RadProgressBar1.Value1 = percent
End Sub

Public Sub btnDownload_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ToolStripButton2.Click
    locationfiledownload = GetPage("http://asankonkur.ir/update/locationfiledownload.txt")

    If locationfiledownload <> "" AndAlso locationfiledownload.StartsWith("http://") Then

        Me.SaveFileDialog1.FileName = locationfiledownload.Split("/"c)(locationfiledownload.Split("/"c).Length - 1)
        If Me.SaveFileDialog1.ShowDialog = Windows.Forms.DialogResult.OK Then
            Me.whereToSave = Me.SaveFileDialog1.FileName
            Me.SaveFileDialog1.FileName = ""

            ToolStripButton2.Enabled = False
            ToolStripButton3.Enabled = True

            Me.BackgroundWorker2.RunWorkerAsync() 'Start download
        End If
    Else
        MessageBox.Show("Please insert valid URL for download", "Warning", MessageBoxButtons.OK, MessageBoxIcon.Warning)
    End If
End Sub

Private Sub BackgroundWorker2_DoWork(ByVal sender As System.Object, ByVal e As System.ComponentModel.DoWorkEventArgs) Handles BackgroundWorker2.DoWork
    'Creating the request and getting the response
    Dim theResponse As HttpWebResponse
    Dim theRequest As HttpWebRequest
    Try 'Checks if the file exist

        theRequest = WebRequest.Create(locationfiledownload)
        theResponse = theRequest.GetResponse
    Catch ex As Exception

        MessageBox.Show("An error occurred while downloading file. Possibe causes:" & ControlChars.CrLf & _
                        "1) File doesn't exist" & ControlChars.CrLf & _
                        "2) Remote server error", "Error", MessageBoxButtons.OK, MessageBoxIcon.Error)

        Dim cancelDelegate As New DownloadCompleteSafe(AddressOf DownloadComplete)
        Me.Invoke(cancelDelegate, True)

        Exit Sub
    End Try
    Dim length As Long = theResponse.ContentLength 'Size of the response (in bytes)

    Dim safedelegate As New ChangeTextsSafe(AddressOf ChangeTexts)
    Me.Invoke(safedelegate, length, 0, 0, 0) 'Invoke the TreadsafeDelegate

    Dim writeStream As New IO.FileStream(Me.whereToSave, IO.FileMode.Create)
    'Replacement for Stream.Position (webResponse stream doesn't support seek)
    Dim nRead As Integer
    'To calculate the download speed
    Dim speedtimer As New Stopwatch
    Dim currentspeed As Double = -1
    Dim readings As Integer = 0

    Do
        If BackgroundWorker2.CancellationPending Then 'If user abort download
            Exit Do
        End If
        speedtimer.Start()
        Dim readBytes(4095) As Byte
        Dim bytesread As Integer = theResponse.GetResponseStream.Read(readBytes, 0, 4096)

        nRead += bytesread
        Dim percent As Short = (nRead * 100) / length

        Me.Invoke(safedelegate, length, nRead, percent, currentspeed)

        If bytesread = 0 Then Exit Do

        writeStream.Write(readBytes, 0, bytesread)

        speedtimer.Stop()

        readings += 1
        If readings >= 5 Then 'For increase precision, the speed it's calculated only every five cicles
            currentspeed = 20480 / (speedtimer.ElapsedMilliseconds / 1000)
            speedtimer.Reset()
            readings = 0
        End If
    Loop
    'Close the streams
    theResponse.GetResponseStream.Close()
    writeStream.Close()
    If Me.BackgroundWorker2.CancellationPending Then
        IO.File.Delete(Me.whereToSave)
        Dim cancelDelegate As New DownloadCompleteSafe(AddressOf DownloadComplete)
        Me.Invoke(cancelDelegate, True)
        Exit Sub
    End If

    Dim completeDelegate As New DownloadCompleteSafe(AddressOf DownloadComplete)
    Me.Invoke(completeDelegate, False)

End Sub

Private Sub mainForm_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
    Me.Label4.Text = ""
End Sub

Private Sub btnCancel_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ToolStripButton3.Click
    Me.BackgroundWorker2.CancelAsync() 'Send cancel request
End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T16:39:41.713

在您的代码中，您使用的是`WebRequest.Create(locationfiledownload)`. 默认情况下，这会创建一个请求*整个*文件的请求标头。您需要编辑该请求并添加一个 Range 标头，该标头询问您要查找的文件的特定字节范围。例如，添加到`WebRequest.Headers.Range.Ranges`集合中。不幸的是，这将使您的代码变得相当复杂，因为您需要在某处存储已经下载的内容的详细信息（假设您想在应用程序关闭/重新启动后恢复）。你需要知道；

1.  已经下载了多少文件（如果有）
2.  您打算在任何时候下载多少

一旦你知道了这一点，你将不得不为文件的 X 字节形成一个带有 Range 标头的请求。收到后，您需要保存它并要求下一部分。此处的代码项目中提供了一个用 C# 编写的示例：http: [//www.codeproject.com/Tips/307548/Resume-Suppoert-Downloading](http://www.codeproject.com/Tips/307548/Resume-Suppoert-Downloading)

# java - 在 Gervill SF2Soundbank 中将多个样本添加到一台仪器

> ID：14898849
> 
> 赞同：2
> 
> 时间：2013-02-15T16:19:51.410
> 
> 标签：java, midi, openjdk, sample, gervill

我正在使用 Gervill 创建带有乐器的音库。我已经为每个音高录制了一个样本，现在我想将这些样本放入一个乐器中。我目前使用的文档是来自 openjdk6 源代码的测试。除此之外，我还找到了 Karl Helgason 的一个例子，这很有帮助。该示例将音频文件加载到音库中，但每个乐器仅使用一个样本。我修改了他的示例文件，当我使用音库进行回放时，似乎只使用了一个样本并根据请求的音高进行音调。相反，我想为每个音高使用一个特定的样本。我怀疑我的 for 循环是围绕方法的错误部分构建的，并且额外的样本正在覆盖以前保存的样本。

我的问题是每个样本应该分别有哪些部分：层？还是地区？两个都？不幸的是，格维尔术语似乎与我发现[的另一个](http://www.csounds.com/manual/html/MiscSf2.html)术语略有不同，所以我有点困惑。

我使用了以下源代码（我在修改后的源代码中留下了版权说明，我不是律师，所以我不确定这是否是正确的做法。）：

```
/*
 * Copyright (c) 2007 by Karl Helgason
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 *
 * - Redistributions of source code must retain the above copyright notice,
 *   this list of conditions and the following disclaimer.
 * - Redistributions in binary form must reproduce the above copyright
 *   notice, this list of conditions and the following disclaimer in the
 *   documentation and/or other materials provided with the distribution.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
 * FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
 * COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
 * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
 * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
 * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
 * OF THE POSSIBILITY OF SUCH DAMAGE.
 */

package midiplay;

    import com.sun.media.sound.*;
    import java.io.File;
    import java.io.IOException;
    import javax.sound.midi.Patch;
    import javax.sound.sampled.*;

    public class MakeSoundfont {

        public SF2Soundbank CreateSoundbank()
                throws UnsupportedAudioFileException, IOException {

            SF2Soundbank sf2 = new SF2Soundbank();

            String[] fnames = new String[]{"C.wav", "Cs.wav", "D.wav", "Ds.wav"};

            SF2Layer layer = new SF2Layer(sf2);
            layer.setName("fname Layer");
            sf2.addResource(layer);

            int i = 0;
            for (String fname : fnames) {

                File audiofile = new File("./" + fname);
                AudioInputStream audiostream = AudioSystem
                        .getAudioInputStream(audiofile);

                AudioFormat format = new AudioFormat(audiostream.getFormat()
                        .getSampleRate(), 16, 2, true, false);
                AudioInputStream convaudiostream = AudioSystem.getAudioInputStream(
                        format, audiostream);

                /*
                 * Read the content of the file into a byte array.
                 */

                int datalength = (int) convaudiostream.getFrameLength()
                        * format.getFrameSize();
                byte[] data = new byte[datalength];
                convaudiostream.read(data, 0, data.length);
                audiostream.close();

                /*
                 * Create SoundFont2 sample.
                 */

                SF2Sample sample = new SF2Sample(sf2);
                sample.setName(fname);
                sample.setData(data);
                sample.setSampleRate((long) format.getSampleRate());
                sample.setOriginalPitch(60 + i);
                sf2.addResource(sample);
                i++;

                /*
                 * Create region for layer.
                 */
                SF2LayerRegion region = new SF2LayerRegion();
                region.putInteger(SF2Region.GENERATOR_RELEASEVOLENV, 12000);
                region.setSample(sample);

                layer.getRegions().add(region);
            }

            /*
             * Create SoundFont2 instrument.
             */
            SF2Instrument ins = new SF2Instrument(sf2);
            ins.setName("Back Instrument");
            ins.setPatch(new Patch(0, 0));
            sf2.addInstrument(ins);

            /*
             * Create region for instrument.
             */
            SF2InstrumentRegion insregion = new SF2InstrumentRegion();
            insregion.setLayer(layer);
            ins.getRegions().add(insregion);

            return sf2;

        }
    } 
```

编辑：我似乎一次听所有的样本。它们同时播放，所以我刚刚意识到以下几点：我只是设置样本的原始音高，但我没有设置范围，即我没有将样本分配给某些 MIDI 键。我在哪里可以这样做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T09:38:39.233

在阅读了一些 Gervill 源代码后，我自己找到了解决方案。使用 GENERATOR_KEYRANGE 可以定义特定样本的音高范围：

```
 SF2LayerRegion region = new SF2LayerRegion();
        region.putInteger(SF2Region.GENERATOR_RELEASEVOLENV, 12000); 
        region.putBytes(SF2Region.GENERATOR_KEYRANGE, new byte[]{(byte)(60+i),(byte)(60+i)});
        i++;
        region.setSample(sample);
        layer.getRegions().add(region); 
```

# css - CSS 样式声明重用

> ID：14898852
> 
> 赞同：0
> 
> 时间：2013-02-15T16:20:13.583
> 
> 标签：css

假设我在我的 CSS 中有一个颜色定义：

```
.headerColor   { background-color: #a6c9e2; } 
```

现在我还想定义一个使用 .headerColor 的 CSS 定义：

```
.header        { padding-left: 2px; } 
```

在 CSS 级别上，如何从 .headerColor 继承 .header？我知道我可以将这两种样式放在 HTML 元素上（class='header headerColor'），但是如何将 .header 分配给我的 HTML 元素并让它拉出它的父样式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T16:25:19.093

你可以这样写：

```
.headerColor, .header   { background-color: #a6c9e2; }
.header                 { padding-left: 2px; } 
```

现在，您只需要`class="header"`在 HTML 中进行设置。

# mysql - SQL查询查找下一个版本号

> ID：14898857
> 
> 赞同：1
> 
> 时间：2013-02-15T16:20:34.207
> 
> 标签：mysql, sql

我在远程服务器上有一个表，用于存储我们客户端软件的版本号。我使用 SOAP 来处理请求。客户端软件发送一个版本号，我需要使用 SQL 查找下一个版本号。

这是我使用的 SQL。我的大脑一天有点糟糕，我知道这是不正确的，但我似乎无法弄清楚我需要做什么。

创建表代码：

```
CREATE TABLE IF NOT EXISTS `sqlUpdateVersions` (
  `primary_key` int(11) NOT NULL AUTO_INCREMENT,
  `timestamp` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `comment` text NOT NULL,
  `majorVS` tinyint(4) NOT NULL,
  `minorVS` tinyint(4) NOT NULL,
  `revisionVS` tinyint(4) NOT NULL,
  `buildVS` tinyint(4) NOT NULL,
  `filePK` int(11) NOT NULL,
  `customDBJarPK` int(11) DEFAULT NULL,
  PRIMARY KEY (`primary_key`),
  KEY `filePK` (`filePK`)
) ENGINE=InnoDB  DEFAULT CHARSET=latin1 AUTO_INCREMENT=9 ; 
```

这是查找版本号的 SQL 查询。我在这个版本中转储了 1.1.0.0

```
select b.majorVS, b.minorVS,b.revisionVS, b.buildVS
 from sqlUpdateVersions b  where
 b.majorVS>=1 AND b.minorVS >=1 AND b.revisionVS>=0 AND b.buildVS>=10 
 ORDER BY b.majorVS,b.minorVS,b.revisionVS, b.buildVS 
```

现在很明显我可以告诉这个 SQL 是有问题的。但是我将如何构造一个返回下一个值的结构，比如 1.2.0.0 或 1.1.1.0

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T16:28:30.543

这是一种蛮力方法：

```
select suv.*
from sqlUpdateVersions suv
where suv.majorVS > 1 or
      (suv.MajorVs = 1 and suv.minorVS > 1) or
      (suv.MajorVS = 1 and suv.minorVS = 1 and suv.revisionVS > 0) or
      (suv.MajorVS = 1 and suv.minorVS = 1 and suv.revisionVS = 0 and suv.buildVS > 10)
order by suv.MajorVS, suv.MinorVS, suv.revisionVS, suv.buildVS 
```

您还可以将版本转换为 bigint 并直接进行比较：

```
select suv.*
from (select suv.*,
             buildVS + (cast(1000 as bigint)*revisionVS +
                        (cast(1000 as bigint)*minorVS +
                         (cast(1000 as bigint)*majorVS
                         )
                        )
                       ) as bigVersion 
      from sqlUpdateVersions suv
     ) suv
 where bigversion > 1001000010 
```

# unit-testing - Roboguice 2.0 测试教程

> ID：14898861
> 
> 赞同：2
> 
> 时间：2013-02-15T16:20:44.637
> 
> 标签：unit-testing, testing, roboguice

我正在使用 RoboGuice 2.0，但我很难测试代码。我找到的唯一文档使用了 RoboUnitTestCase，它似乎不再存在于 RoboGuice 2.0 中。我搜索了很多关于这个主题的教程，但没有找到任何东西。

有谁知道这方面的好例子或教程？

# java - java中的匹配字符串模式

> ID：14898862
> 
> 赞同：2
> 
> 时间：2013-02-15T16:20:45.410
> 
> 标签：java, regex, string, jakarta-ee

我正在尝试将一个字符串与另一个字符串匹配，以使两者之间至少有 3 个字符匹配。我的字符串的长度应为 4，全部大写，3 个字母和 1 个介于 0 和 10 之间的数字（不包括 0 和 10）。例如：RM5Z 我怎样才能以最简化的形式在 java 中做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T16:31:04.243

要检查字符串的形式，您可以使用此`^(?=[A-Z]*[1-9][A-Z]*$).{4}$`正则表达式

*   `^.{4}$`将确保长度 4
*   `^(?=[A-Z]*[1-9][A-Z]*$)`将只接受包含 1-9 范围内的数字的字符串，这些数字可以用字母 AZ 包围

不确定这是否是您要检查字符串的方式，请告诉我

```
static boolean testStrings(String a, String b) {

    if (isValid(a) && isValid(b)) {
        for (int i = 0; i < 4; i++) {
            a = a.replaceFirst(String.valueOf(b.charAt(i)), "");
        }
        return a.length() <= (4 - 3);
    }else
        return false;

}

static boolean isValid(String s) {
    return s.matches("^(?=[A-Z]*[1-9][A-Z]*$).{4}$");
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T16:36:24.650

如果您想知道两个长度为 4 的字符串是否共有三个字符，并且您知道所有字符都在受限范围内，那么您只需将位集相交并计算位：

```
public static boolean haveNCharsInCommon(String a, String b, int n) {
  BitSet charsInA = charsIn(a);
  BitSet charsInB = charsIn(b);
  charsInA.and(charsInB);
  return charsInA.cardinality() >= n;
}

private BitSet charsIn(String s) {
  BitSet bs = new BitSet();
  for (int i = 0, n = s.length(); i < n; ++i) {
    bs.set(s.charAt(i);
  }
  return bs;
} 
```

如果字符串可以包含任意代码点，您可能希望使用稀疏向量而不是位集。

# java - SimpleXml @ElementListUnion 标签在 Android 上的性能

> ID：14898865
> 
> 赞同：1
> 
> 时间：2013-02-15T16:21:04.093
> 
> 标签：java, android, performance, serialization, simple-framework

我在 Android 中使用 simpleXml 来序列化/反序列化对象列表。以前，我有 30 个不同的对象，每个对象都有一个包含列表的关联类。为了编写更少重复的代码，我决定只使用一个带有这样注释的列表的`@ElementListUnion`类：

```
@ElementListUnion({
    @ElementList(entry = "A", inline = true, type = A.class, required=false),
    @ElementList(entry = "B", inline = true, type = B.class, required=false),
    @ElementList(entry = "C", inline = true, type = C.class, required=false)
    })
private List<Object> serializableList; 
```

当元素列表长大时，我注意到反序列化在 android 上的性能下降。是否存在另一种形式来使用另一个注释来做到这一点，或者我必须返回到我的程序的旧实现？

注意：我列表中的所有元素都属于同一类型，可以`serializableList` 是 a或.`List<A>``List<B>``List<C>`

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T17:44:51.830

您可以像这样注释类（包含列表）：

```
@Root
public class Example
{
    @ElementList
    private List<Object> serializableList;

    // ...
} 
```

和类（`A`等`B`）：

```
@Default
public class A
{
    // ...
} 
```

*（或者：类`@Root`和你需要的每个元素，，，`@Element`... `@ElementList`）*

通过这种方式，您可以将所需的所有内容放入列表中。

# php - php用str_replace删除特定单词后的一行

> ID：14898870
> 
> 赞同：0
> 
> 时间：2013-02-15T16:21:25.550
> 
> 标签：php, str-replace

文件中有文本作为示例：

```
<div class="from">jack</span></div>
hey u

<div class="from">ron</span></div>
bye 
```

我正在尝试删除“”之后的新行标记并替换“|”

我需要的结果是：

```
<div class="from">jack</span></div>|hey u

<div class="from">ron</span></div>|bye 
```

我试过这个，但认为我弄错了，因为它可以完成工作。

```
$string = file_get_contents($filename);
$string = str_replace('/(<\/span><\/div>\r\n)', '|', $string);
file_put_contents($filename, $string); 
```

什么是正确的方法？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T16:25:39.690

```
<?php
$string = '<div class="from"><span>jack</span></div>
hey u';

echo preg_replace('/\r\n/', '|', $string); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T16:27:27.287

```
$file_handle = fopen($filename, "r");
$text = "";
while (!feof($file_handle)) {
   $line = fgets($file_handle);
   if (strpos($line,'<div>') !== false) {
      $line = preg_replace('/\r\n/', '|', $line)
   }
   $text .= $line;
}
file_put_contents($filename, $text);
fclose($file_handle); 
```

如何逐行读取文件，如果该行有标签，它会替换 \n\r，然后最后将所有行写回文件中。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-15T16:24:09.237

这取决于使用的行尾，有三种可能的行尾，\n、\r\n 和 \r。

尝试这个：

```
$string = str_replace('/(<\/span><\/div>\n)', '|', $string); 
```

该字符串中的第一个斜线也是可疑的，所以试试这个：

```
$string = str_replace('(<\/span><\/div>\r\n)', '(<\/span><\/div>|', $string); 
```

# php - 将模型注册为事件监听器

> ID：14898872
> 
> 赞同：1
> 
> 时间：2013-02-15T16:21:32.410
> 
> 标签：php, cakephp, cakephp-2.3

我想知道在模型的 PHP 文件中将模型类注册为 CakeEventListener 是否是个好主意。

例如，如果我创建了一个名为 Document 的模型来实现侦听器，并在 Document.php 的底部将其注册为侦听器。

```
class Document extends AppModel implements CakeEventListener
{
   .....
}

CakeEventManager::instance()->attach(ClassRegistery::init('Document')); 
```

我的问题是关于 nexted 调用`ClassRegistery::init('Document')`以及上述是否会导致`Document`创建两个实例。

例如，假设我的控制器中有以下内容。

```
class DocumentsController extends AppController
{
     public function index()
     {
         $model = ClassRegistery::init('Document');
         ..... 
```

`Document`实例化了多少次？

*   来自控制器的第一次调用`ClassRegistery::init('Document')`加载 Document.php 文件。
*   是否会`ClassRegistery::init('Document')`从 Document.php 的底部进行第二次调用，`befoe`第一次调用已完成？

这会以某种方式在 CakePHP 中散布注册表吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T18:02:02.240

这不应该是一个问题。`ClassRegistry::init()`只实例化对象一次。后续调用`init()`返回现有对象。

但是，我建议在 Document 的`__construct`函数中注册监听器。这感觉更简洁，因为我们没有将自执行 PHP 与类文件混合。它还允许以后可能的注入，这对单元测试很有用。

# javascript - CORS 的概念，我应该强制执行 Origin 标头吗？

> ID：14898876
> 
> 赞同：8
> 
> 时间：2013-02-15T16:21:53.237
> 
> 标签：javascript, web-services, api, rest, cors

据我了解，***CORS 无法以您可以真正确定来电者是谁的方式准确地保护您***。因为调用者可以发送他想要的任何 ORIGIN 标头。实际上，我在某处读到您无法通过 javascript 设置原始标头，因为它是受限制的标头 - 但我不太确定。无论如何..如果您要实现自己的 HttpClient ，您可以轻松伪造您的原始标头，从而使用您不应该使用的服务。

其次***，如果没有指定 Origin 标头，则请求也可以正常工作***。例如，我使用 Google Chrome 的 Postman Extension，它不发送任何原始标头。事实上，如果您尝试手动添加一个，它不会通过网络发送。

所以...

*   ...***问题 1***是：我的应用程序是否应该拒绝没有任何 Origin 标头的请求？和...*   ...***问题 2***：究竟如何使 CORS 我的 REST 服务更安全？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-16T11:36:49.690

有支持 CORS 和不支持 CORS 的浏览器。（我们处于 CORS 的早期阶段，CORS 规范跨浏览器的实现并不一致）。

*   不支持 CORS 意味着当浏览器检测到跨域请求时，请求被阻塞，不会发送到服务器。
*   支持 CORS 意味着浏览器应用 CORS 策略：在向服务器发送请求之前附加 Origin 标头，在收到响应后，浏览器检查 Access-Control-Allow-Origin 决定是否丢弃响应。

同源策略旨在降低 XSS 攻击的风险，这种攻击主要发生在浏览器上，不太可能发生在 HttpClient 中。CORS 政策旨在放宽同源政策，以便如果您是两个站点的所有者，则可以利用此政策来允许您的 2 个站点之间进行通信。

>  提示 支持CORS意味着浏览器在联系到服务器并获得响应头后必须应用跨域安全策略，这意味着即使响应因缺少或指定所需的头而被丢弃，也会发出请求不同的域。这是一种与没有实现 CORS 的浏览器非常不同的方法，浏览器只是阻止请求，从不联系服务器。

摘自[本书](http://books.google.com.vn/books?id=sr5yu98mCmkC&printsec=frontcover&hl=vi&source=gbs_ge_summary_r&cad=0#v=onepage&q&f=false)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-15T16:23:33.010

CORS 的目的是防止（或允许）在不同域上运行的 Javascript 向您的 API 发送 AJAX 请求并使用用户经过身份验证的会话 cookie。

CORS**不能**代替正确的身份验证；所做的一切就是防止浏览器充当对您现有身份验证方案的[混淆代理。](http://en.wikipedia.org/wiki/Confused_deputy_problem)

# objective-c - Objective-C：使用最少代码的多个 if 和 return 语句

> ID：14898879
> 
> 赞同：1
> 
> 时间：2013-02-15T16:21:59.947
> 
> 标签：objective-c

这是一个关于如何用尽可能少的代码有效地编写代码的问题。它已经有效，但我需要加入 paramenter `numberOfShapes`。如果 1 返回■，如果 2 ■■，如果 3 ■■■ 等等...

我可以做一些额外的 if statemets 和额外的 return 语句。如果 Square->if number = 1> return ■，if number >2 return ■■ 等等。但是对于一些非常简单的事情来说，这是一大堆代码。

用最少的代码进行编码的最佳方法是什么？

```
- (NSString *)getShape: (NSNumber *)shape numberOfShapes: (NSNumber *)number
{
    if ([shape isEqualToNumber:[NSNumber numberWithInt:SQUARE]]) return @"■";
    if ([shape isEqualToNumber:[NSNumber numberWithInt:CIRCLE]]) return @"●";
    if ([shape isEqualToNumber:[NSNumber numberWithInt:TRIANGLE]]) return @"▲";

    return @"?";
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-15T16:34:52.077

除非您有一些非常严格的性能要求，否则很大程度上是一个品味问题。

一种方法是建立一个字典，其中包含从数字到字形的映射。

假设您有一个静态变量，请在类的方法`glyphs`中对其进行初始化：`initialize`

```
static NSDictionary *glyphs;

+ (void)initialize 
{
    glyphs = @{
      @(SQUARE):@"■",
      @(CIRCLE):@"●",
      @(TRIANGLE):@"▲"
    };
} 
```

那么你所要做的就是：

```
- (NSString *)shapeForNumber:(NSInteger)shape 
{
    NSString *glyph = [glyphs objectForKey: [NSNumber numberWithInteger: shape]];

    return glyph ? glyph : @"?";
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-15T16:28:35.957

```
- (NSString *)getShape: (NSNumber *)shape numberOfShapes: (NSNumber *)number
{
    unsigned shapeInt = [shape unsignedIntValue];
    if (shapeInt >= 3)
        return @"?";
    NSString *shapeStr = [@"■●▲" substringWithRange:NSMakeRange(shapeInt, 1)];

    // Add autorelease here, if using MRR...
    NSMutableString *result = [[NSMutableString alloc] init];

    unsigned numberInt = [number unsignedIntValue];
    for (unsigned i = 0; i < numberInt; i++)
        [result appendString:shapeStr];
    return result;
} 
```

我看不出使用`NSNumber`对象来传递这样的参数有什么意义，因为它们不能做任何简单`NSUInteger`或`unsigned`可以做的事情，而且使用起来更昂贵。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-15T16:34:27.523

代码是否存在*性能*问题？否则，我认为一个开关是很清楚的。或者，更少的行和 O(1) 是......

```
// declare this earlier
static NSArray *shapeChars = @[ @"■", @"●" /* etc. */ ];

// then
return [shapeChars objectAtIndex:[shape intValue]]; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-15T16:30:01.920

输入循环的概念。另外，你为什么用`NSNumber`s 来做这个？普通`int`的旧款就足够了。

```
- (NSString *)getShape:(int)shape numberOfShapes:(int)number
{
    if (shape == SQUARE]) return [self shapeRepeated:@"■" nTimes:number];
    if (shape == CIRCLE]]) return [self shapeRepeated:@"●" nTimes:number];
    if (shape == TRIANGLE]]) return [self shapeRepeated:@"▲" nTimes:number];

    return @"?";
}

- (NSString *)shapeRepeated:(NSString *)shape nTimes:(int)n
{
    return [@"" stringByPaddingToLength:n withString:shape startingAtIndex:0];
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-15T18:21:30.977

```
- (NSString *)getShape: (NSNumber *)shape numberOfShapes: (NSNumber *)number
{
    switch([number intValue]): {
        case SQUARE: return @"■";
        case CIRCLE: return @"●";
        case TRIANGLE: return @"▲";
        default: return @"?";
    }
} 
```

合并“数字”：

```
- (NSString *)getShape: (NSNumber *)shape numberOfShapes: (NSNumber *)number
{
    NSString* result = nil;
    switch([number intValue]): {
        case SQUARE: result = @"■"; break;
        case CIRCLE: result = @"●"; break;
        case TRIANGLE: result= @"▲"; break;
        default: result = @"?";
    }
    NSString* realResult = @"";
    for (int i = 0; i < number; i++) {
       realResult = [realResult stringByAppendingString:result];
    }
    return realResult;
} 
```

您可以通过对结果使用 char 值来整理它，但我太懒了。

# javascript - Javascript正则表达式替换方括号之间的最后一位数字出现？

> ID：14898882
> 
> 赞同：2
> 
> 时间：2013-02-15T16:22:02.487
> 
> 标签：javascript, regex

我一直在寻找这个几个小时，现在我以一种非常丑陋的方式结束（但工作）。我想找到一种可重复使用的好方法来做到这一点。

我有一个这样的字符串：

```
wanna[0].some[0].javascript 
```

我想替换方括号之间的最后一位数字：

```
wanna[0].some[1].javascript 
```

我已经结束了这种（丑陋的）方式：

```
myString.replace(/\d].javascript$/, "1].javascript") 
```

哪个应该是与之匹配的最佳正则表达式？

```
myString.replace(/\d/, 1) // this should be for the first digit
myString.replace(/\d/g, 1) // this for every digit 
```

我已经阅读了有关负前瞻的信息，但如果 JS 支持这一点，我仍然没有得到。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T16:24:48.237

只需使用负前瞻来确定在您匹配的括号之后没有更多的括号：

```
var text = 'wanna[0].some[0].javascript';

text = text.replace(/\[\d](?!.*\[)/, '[1]'); 
```

这是小提琴：http: [//jsfiddle.net/bRkEP/](http://jsfiddle.net/bRkEP/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T16:30:20.663

不知道为什么需要前瞻。你给出的答案（虽然丑陋）应该有效。正如 Crockford 所说的*JavaScript 中的负前瞻：好的部分*：“这不是一个好的部分。”

如果您提供的行不起作用，我想这是因为您没有逃脱方括号。它应该是：

```
myString.replace(/\d\].javascript$/, "1].javascript"); 
```

您还可以进行一些捕捉以使眼睛更容易。

我同意你的问题的评论，这似乎是一个奇怪的问题要解决。为什么要更改字符串中的数字？这看起来可以更好地在方括号中使用数字变量来提供，然后您可以增加该变量。

# asp.net-mvc-4 - 在 EF CodeFirst 中使用复杂数据类型

> ID：14898886
> 
> 赞同：0
> 
> 时间：2013-02-15T16:22:13.963
> 
> 标签：asp.net-mvc-4, ef-code-first, entity-framework-5

这是我的模型：

```
public class Course
    {
        public int Id { get; set; }
        public string Title { get; set; }
        public string Institute { get; set; }
        public string Instructor { get; set; }
        public string Duration { get; set; }
        public Level Level { get; set; }
        public Format Format { get; set; }
        public DateTime Released { get; set; }
        public string FileSize { get; set; }
        public string Desciption { get; set; }
    }
    public enum Level
    {
        Beginner,
        Intermediate,
        Advanced
    }
    public enum Format
    {
        Avi,
        Hd,
        FullHd
    }
    public class CourseDb:DbContext
    {
        public DbSet<Course> Courses { get; set; }
    } 
```

当我想使用 EF 模板创建我的新控制器时，当我使用 EF5 时
它不会同时创建`Level`和字段，我 的问题是什么？ 谢谢你的建议`Format`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T16:37:59.803

脚手架时当前不支持枚举类型，这很可能是未创建字段的原因。

我的建议是使用辅助方法，例如：[Working with enums in ASP.NET MVC 3](https://stackoverflow.com/questions/6133771/working-with-enums-in-asp-net-mvc-3)

并手动编码。

更新：

看起来这里记录了支持它的票：http: [//mvcscaffolding.codeplex.com/workitem/10](http://mvcscaffolding.codeplex.com/workitem/10)

# django - 在哪里为模型添加方法？

> ID：14898888
> 
> 赞同：1
> 
> 时间：2013-02-15T16:22:15.403
> 
> 标签：django

我有以下场景，我想知道在 Django 中实现它的最佳方法：

我有两个模型**Product**和**Person**。我想给一个产品是否适合这个人**打分。**我的问题**不是**关于如何计算这个，而是在 Django 中的哪里做这个？

我一直在想我可以拥有这样的东西……</p>

```
Product.object.getscore(Person) 
Or 
Person.object.getscore(Product) 
```

那么我将如何在模型中做到这一点（忘记实际得分，这不是问题）？但是在哪里放置这个方法以及如何在模型中？我不想存储分数，它必须根据传递的对象是动态的。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T16:35:14.273

您可以通过以下方式在任一类中实现该方法：

**注意：**我的假设是这是一个 1-M 关系：

```
class Product(models.Model):
  person = ForeignKey(Person)
  ...
  def get_score(self):
    # do your thing here
    # use a person reference
    if self.person:
      # calculate score in one way
    else:
      # calculate score some other way 
    return score 
```

或者你可以在`Person`课堂上实现它。这完全取决于您是想从人的角度还是从产品的角度工作

您提出的建议`Product.objects.get_score()`是在您对整个查询集而不是单个项目执行计算时。

**更新：在澄清产品与人无关后**

在这种情况下，您可以简单地将其实现为

```
class Product(models.Model):
  ...

  def get_score(self, person):
    # check the conditions you need to calculate the score
    if person.has_some_property and self.has_some_product_property:
      # calculate score in one way
    else:
      # calculate score some other way 
    return score 
```

使用产品实例，您可以简单地执行以下操作：

```
person = Person.objects.get(pk=<some_id>)
product = Product.objects.get(pk=<some_id>)
product.get_score(person) 
```

# python - 从 Web 运行 Python 脚本

> ID：14898890
> 
> 赞同：10
> 
> 时间：2013-02-15T16:22:30.553
> 
> 标签：python, web-services, web-applications, web, python-2.7

近一年来，我一直在遇到同样的问题。我总是想办法解决它，但我厌倦了寻找解决方法。

我需要的是在服务器上运行 python 脚本的网页（最好是 HTML，而不是 PHP 或 ASP）上创建一个按钮。我还希望能够让这个按钮将信息从表单发送到脚本。

我需要在本地主机上并通过托管在 Amazon Cloud 上的 Web 服务来执行此操作。我将无法在 Amazon Cloud 服务上安装任何额外的东西，例如 PHP 或 CGI。

我真的很想要一个简单的解决方案，我是 python 专家，我可以编写吹口哨的网页，但我就是找不到一个简单的解决方案来解决这个问题。

我理想的解决方案是要标记的邮件：

```
<a href="mailto:someone@example.com?Subject=Hello%20again">Send Mail</a> 
```

除了：

```
<a href="myscript.py?Subject=1234">Run Script</a> 
```

现在我非常怀疑这样的解决方案是否存在，但我可以梦想成真。

我试图运行的脚本：

1.  返回用户的唯一 ID
2.  将 ID 发送到 GIS 程序，该程序根据 ID 创建地图（ID 选择地图的区域）
3.  然后将地图导出为 PNG，写入 HTML 文档，然后在新选项卡中为用户显示。

编辑 - - - - - - - - - - - - - -

感谢@Ketouem 的回答，我能够找到解决问题的好方法。我将在这里发布一些代码，以便其他人可以受益。确保你下载了 Python 的 Bottle Module，它很棒。

```
# 01 - Import System Modules
from bottle import get, post, request, Bottle, run, template

# 02 - Script Variables
app = Bottle()

# 03 - Build Temporary Webpage
@app.route('/SLR')
def login_form():
    return '''<form method="POST" action="/SLR">
                Parcel Fabric ID: <input name="UID" type="text" /><br />
                Save Location: <input name="SaveLocation" type="text" value="D:/Python27/BottleTest/SLR_TestOutputs"/><br />
                Air Photo On: <input name="AirPhoto" type="checkbox"/><br />                
                Open on Completion: <input name="Open" type="checkbox"/><br />
                Scale: <input name="Scale" type="text" value="10000"/><br />
                <input type="submit" />
              </form>'''

# 04 - Return to GIS App
@app.route('/SLR', method='POST')
def PHPH_SLR_Script():
    # I won't bother adding the GIS Section of the code, but at this point it send the variables to a program that makes a map. This map then saves as an XML and opens up in a new tab.

 # 04 - Create and Run Page
run(app, host='localhost', port=8080) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-15T16:26:02.360

你可以使用 Bottle：[http](http://bottlepy.org/docs/dev/index.html) ://bottlepy.org/docs/dev/index.html这是一个轻量级的网络框架

# java - 使用 map 缓存来自 sql 的数据（其中带有 <= timestamp col）

> ID：14898891
> 
> 赞同：2
> 
> 时间：2013-02-15T16:22:38.600
> 
> 标签：java, sql, caching, collections, oracle10g

我想将以下 sql 中的所有数据放在一个地图中（因为这个 sql 被多次调用，而不是每次都去 db ），但我想知道如何为时间戳实现 <=

编辑：

*我正在使用 Oracle，只是更新了标签，但是，我在 java 中使用 PreparedStatement 来缓存查询，而无需重新编译，但是我们的程序没有缓存解决方案来缓存表中的数据。去数据库并获取数据需要 2 毫秒的往返时间，但从 HashMap 获取数据需要一纳秒。该查询执行了大约 20,000 次，我们希望最初加载所有数据并将其放入 Hashmap 中。*

编辑结束。

```
SELECT ar   
FROM table1   
WHERE fk_col1 = ?   
AND timestamp_col <= ?   
ORDER BY date DESC 
```

我这样做的方式如下：但我不确定，equals和hashCode中的timestamp_col是否正确。你能建议修改吗？

```
public class Table1Key
{
    private String fk_col1;
    private java.sql.Timestamp timestamp_col;
    //setters and getters here.
    //implementing hashCode and equals.
    @Override
    public int hashCode() {
        final int prime = 31;
        int result = 1;
        result = prime * result
                + ((fk_col1 == null) ? 0 : fk_col1.hashCode());
        result = prime * result
                + ((timestamp_col == null) ? 0 : timestamp_col.hashCode());
        return result;
    }
    @Override
    public boolean equals(Object obj) {
        if (this == obj)
            return true;
        if (obj == null)
            return false;
        if (getClass() != obj.getClass())
            return false;
        Table1Key other = (Table1Key) obj;
        if (fk_col1 == null) {
            if (other.fk_col1 != null)
                return false;
        } else if (!fk_col1.equals(other.fk_col1))
            return false;
        if (timestamp_col == null) {
            if (other.timestamp_col != null)
                return false;
        } else if (!timestamp_col.equals(other.timestamp_col))
            return false;
        return true;
    }
} 
```

...

```
private Map<Table1Key, String> map = Functions.getHashMapInstance();

public class Functions {
...
  public static <K,V> HashMap<K,V> getHashMapInstance() {
      return new HashMap<K,V>();
  }
} 
```

* * *

所以，我会像下面这样填充地图：

```
private void populateMap() throws SQLException {
      try {
        ps = conn.prepareStatement(table1Sql);
        ps.setFetchSize(20000);
        ResultSet rs = ps.executeQuery();
        while(rs.next()) {
            Table1Key rdk = new Table1Key();
            String ar = rs.getString(1);
            rdk.setFk_col1(rs.getString(2));
            rdk.setTimestampCol(rs.getTimestamp(3));
            if(actualRateMap.get(rdk) == null) {
                actualRateMap.put(rdk, ar);
            }
        }
    } catch (SQLException e) {
        e.printStackTrace();
        throw e;
    } finally {
        ps.close();
    }
  } 
```

//在这里设置密钥。

```
Table1Key tk = new Table1Key();
tk.setFk_col1(col1);
tk.setTimestampCol(timestamp);
String ar = actualRateMap.get(tk); 
```

//我主要关心的是..如果sql有timestamp_col =？这将起作用，但是如果timestamp_col <而不是地图中存在的值怎么办？

```
if(actualRate != null) {
    Logger.info("Actual Rate:"+actualRate);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T16:57:41.927

`HashMap`不适合您的情况，而**[TreeMap](http://docs.oracle.com/javase/6/docs/api/java/util/TreeMap.html)**可以提供帮助。

a): **[RangeMap](http://code.google.com/p/guava-libraries/wiki/NewCollectionTypesExplained#RangeMap)**解决方案

Guava [RangeMap](http://code.google.com/p/guava-libraries/wiki/NewCollectionTypesExplained#RangeMap)旨在处理这种情况：

```
//Initial RangeMap  
final RangeMap<java.sql.Timestamp, String> cache = TreeRangeMap.create();
...
String value = cache.get(thisTimestamp);
if(value == null){
     String queryFromDB = ...;//Query from DB
     cache.put(Range.atMost(thisTimestamp), queryFromDB);
     value = queryFromDB;
} 
```

当然，'fk_coll' 是个问题。所以你可以定义`Map<String/*fk_coll*/, RangeMap<java.sql.Timestamp, String>>`来处理这个案子。

b)：**[TreeMap](http://docs.oracle.com/javase/6/docs/api/java/util/TreeMap.html)**解决方案

```
final TreeMap<java.sql.Timestamp, String> cache = new TreeMap<>();
...
//Get least key greater than or equal to the 'thisTimestamp' 
Map.Entry<java.sql.Timestamp, String> entry = cache.ceilingEntry(thisTimestamp);
if(entry == null){
   String queryFromDB = ...;//Query from DB
   cache.put(thisTimestamp, queryFromDB);
   value = queryFromDB;
} else {
   value = entry.getValue();
} 
```

和

```
HashMap<String/*fk_coll*/, TreeMap<java.sql.Timestamp, String>> 
```

处理“fk_coll”。

加：驱逐在任何缓​​存情况下都是一个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T17:20:53.767

虽然 HashMap 没有指定元素的顺序，但 TreeMap 可以。我没有测试以下代码，但我想它应该可以工作：

```
TreeMap<Timestamp, String> map = new TreeMap<Timestamp, String>(new Comparator<Timestamp>() {
    public int compare(Timestamp t1, Timestamp t2) {
       // Inverse order is required for using tailMap() as <= operator
       return t2.compareTo(t1);
    }

    public boolean equals(Object o) {
       throw new UnsupportedOperationException("This operation has not been implemented!");
    }
});
// TODO: insert data to the map
// ...

// Get the first key that is <= timestamp (remember that map is using inverse order)
TreeMap<Timestamp, String> tailMap = map.tailMap(timestamp);
Timestamp firstKey = tailMap.firstKey();
if (firstKey != null) {
  // Get the value
  String value = tailMap.get(firstKey);
} 
```

# html - 将 span 文本放置在 li 元素的中间（垂直和水平）

> ID：14898896
> 
> 赞同：3
> 
> 时间：2013-02-15T16:22:52.187
> 
> 标签：html, css

如何定位跨度文本，使其位于中间（垂直和水平）。我制作了一个[jsfiddle 示例](http://jsfiddle.net/r4Dr9/)，这是我的代码：

```
<ul>
    <li class="one"><span>One</span></li>
    <li class="two"><span>Two</span></li>
</ul> 
```

CSS：

```
ul {
    height: 200px;
    border: 1px solid #000;
    width: 200px;
    list-style: none;
    margin: 0;
    padding: 0;
    position: relative;
}

li {
    height: 30px;
    width: 100%;
    position: absolute;
    background-color: blue;
}

.one {
    top: 30px;
    height: 50px;
}

.two {
    top: 150px;
}

li span {
    color: #fff;
    vertical-align: middle;
    height: 100%;
    display: block;
} 
```

li 的高度可以变化。以上只是使用固定高度的参考。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T16:29:28.443

您需要设置`line-height`与您的高度相同`li`：

```
li span {
    color: #fff;
    vertical-align: middle;
    height: 100%;
    display: block;
    line-height:30px;
}
li.one span{
    line-height:50px;
} 
```

这是你的演示：http: [//jsfiddle.net/r4Dr9/2/](http://jsfiddle.net/r4Dr9/2/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T16:35:22.027

您不需要使用边距或填充做技巧。

给出`<li>`a`display:table;`和`<span>`a `display:table-cell;`。

[**演示**](http://jsfiddle.net/Xrg4m/)

**要添加的 CSS**

```
li {
    text-align:center;
    display:table;
}

li span {
    display:table-cell;
    vertical-align:middle;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T16:28:07.003

几件事。首先，`height:100%;`，`vertical-align:middle;`什么都不做。此外，`width:100%;`无论是否指定文本对齐，它总是默认为左。我个人会使用填充：

```
li span {
    display:inline-block;
    color: #fff;
    text-align:center;
    height: 100%;
}

.one span {
    padding-top:10px;
}

.two span {
    padding-top:3px;
} 
```

我也更新了你的 jsFiddle。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-15T16:32:25.880

尝试`text-align: center;`在 上使用`li span`，您必须相应地为每个设置上边距才能从顶部向下移动。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-05-15T09:57:27.247

在 li 元素上添加了样式 - 'text-align: center'，它对我有用

# sql - sql中的数据透视表连接

> ID：14898898
> 
> 赞同：-1
> 
> 时间：2013-02-15T16:23:04.547
> 
> 标签：sql, pivot-table

我有表 Tbl_Login

```
Cat_ID 整数
金额 1 小数
金额 2 小数
金额 3 小数
日期日期

Cat_ID Amount1 Amount2 Amount3 日期
1 10 12 12 2013-02-12
2 10 12 12 2013-02-12
3 10 12 12 2013-02-12
4 10 12 12 2013-02-12

1 20 22 22 2013-02-13
2 20 22 22 2013-02-13
3 20 22 22 2013-02-13
5 20 22 22 2013-02-13
我想输入两个日期 12/02/2013 15/02/2013 和

列 1 Cat_ID 12-02-2013 13-02-2013 14-02-2013 15-02-2013
金额1 1 10 20 null null    
金额 2 1 12 22 null null
金额 3 1 12 22 null null    

金额1 2 10 20 null null    
金额 2 2 12 22 null null
金额 3 2 12 22 null null    

金额1 3 10 20 null null    
金额2 3 12 22 null null
金额 3 3 12 22 null null    

金额1 4 10 null null null    
金额 2 4 12 null null null
金额 3 4 12 null null null    

金额1 5 null 20 null null    
金额 2 5 无 22 无 无
金额 3 5 无 22 无 无  

```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T16:29:00.010

您没有指定您使用的是什么 RDBMS，但是您可以通过多种方式将此数据转换为您需要的结果。

如果您使用的数据库没有`PIVOT`函数，那么这可以通过使用`UNION ALL`查询来取消透视数据，然后使用带有`CASE`表达式的聚合函数将日期透视到列中来完成。查询将与此类似：

```
select col, 
  cat_id,
  max(case when dateon = '2013-02-12' then value end) [2013-02-12],
  max(case when dateon = '2013-02-13' then value end) [2013-02-13],
  max(case when dateon = '2013-02-14' then value end) [2013-02-14],
  max(case when dateon = '2013-02-15' then value end) [2013-02-15]
from
(
  select cat_id, 'amount1' col, amount1 value, dateon
  from tbl_login
  where dateon >= '2013-02-12'
    and dateon <= '2013-02-15'
  union all
  select cat_id, 'amount2' col, cast(amount2 as decimal(10,2)) value, dateon
  from tbl_login
  where dateon >= '2013-02-12'
    and dateon <= '2013-02-15'
  union all
  select cat_id, 'amount3' col, cast(amount3 as decimal(10,2)) value, dateon
  from tbl_login
  where dateon >= '2013-02-12'
    and dateon <= '2013-02-15'
) src
group by col, cat_id
order by cat_id, col 
```

请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!3/52b06/1)

如果您使用的是 SQL Server 2005+ 或 Oracle 11g+，那么您可以同时使用`UNPIVOT`和`PIVOT`函数：

```
select col, cat_id,
  [2013-02-12], [2013-02-13], 
  [2013-02-14], [2013-02-15]
from
(
  select cat_id, dateon,
    col, value
  from
  (
    select cat_id, amount1, 
      cast(amount2 as decimal(10,2)) amount2, 
      cast(amount3 as decimal(10,2)) amount3, 
      dateon
    from tbl_login
    where dateon >= '2013-02-12'
      and dateon <= '2013-02-15'
  ) s
  unpivot
  (
    value
    for col in (Amount1, Amount2, Amount3)
  ) unpiv
) src
pivot
(
  max(value)
  for dateon in ([2013-02-12], [2013-02-13], 
                 [2013-02-14], [2013-02-15])
) piv
order by cat_id, col 
```

请参阅[SQL Fiddle with Demo](http://www.sqlfiddle.com/#!3/52b06/2)。

如果您有未知数量的日期要转换为列，则可以使用动态 sql（*注意：动态代码是 sql server 语法*）：

```
DECLARE @cols AS NVARCHAR(MAX),
    @query  AS NVARCHAR(MAX),
    @startdate datetime,
    @enddate datetime

set @startdate  ='2013-02-12'
set @enddate  ='2013-02-15'

;with dates (dt) as
(
  select @startdate
  union all
  select dateadd(dd, 1, dt)
  from dates
  where dateadd(dd, 1, dt) <= @enddate
)
select dt
into #temp
from dates

select @cols = STUFF((SELECT distinct ',' + QUOTENAME(convert(varchar(10), dt, 120)) 
                    from #temp
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,1,'')

set @query = 'SELECT col, cat_id,' + @cols + ' 
            from
            (
              select cat_id, dateon,
                col, value
              from
              (
                select cat_id, amount1, 
                  cast(amount2 as decimal(10,2)) amount2, 
                  cast(amount3 as decimal(10,2)) amount3, 
                  dateon
                from tbl_login
                where dateon >= '''+convert(varchar(10), @startdate, 120)+'''
                  and dateon <= '''+convert(varchar(10), @enddate, 120)+'''
              ) s
              unpivot
              (
                value
                for col in (Amount1, Amount2, Amount3)
              ) unpiv
            ) src
            pivot
            (
              max(value)
              for dateon in (' + @cols + ')
            ) p 
            order by cat_id, col'

execute(@query) 
```

请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!3/52b06/3)

所有查询的结果是：

```
|     COL | CAT_ID | 2013-02-12 | 2013-02-13 | 2013-02-14 | 2013-02-15 |
------------------------------------------------------------------------
| amount1 |      1 |         10 |         20 |     (null) |     (null) |
| amount2 |      1 |         12 |         22 |     (null) |     (null) |
| amount3 |      1 |         12 |         22 |     (null) |     (null) |
| amount1 |      2 |         10 |         20 |     (null) |     (null) |
| amount2 |      2 |         12 |         22 |     (null) |     (null) |
| amount3 |      2 |         12 |         22 |     (null) |     (null) |
| amount1 |      3 |         10 |         20 |     (null) |     (null) |
| amount2 |      3 |         12 |         22 |     (null) |     (null) |
| amount3 |      3 |         12 |         22 |     (null) |     (null) |
| amount1 |      4 |         10 |     (null) |     (null) |     (null) |
| amount2 |      4 |         12 |     (null) |     (null) |     (null) |
| amount3 |      4 |         12 |     (null) |     (null) |     (null) |
| amount1 |      5 |     (null) |         20 |     (null) |     (null) |
| amount2 |      5 |     (null) |         22 |     (null) |     (null) |
| amount3 |      5 |     (null) |         22 |     (null) |     (null) | 
```

# java - 在 Java 中获取输入的不同方法

> ID：14898902
> 
> 赞同：1
> 
> 时间：2013-02-15T16:23:14.000
> 
> 标签：java, input, java.util.scanner, bufferedreader

在 Java 中获取输入的不同方法是什么？

我使用了两种方法：

`BufferedReader`和

`Scanner`

还有其他获取输入的方法吗？

如果是这样，它们之间有什么区别？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-04-25T19:05:05.040

好吧，我尝试了几种方法来查看如何通过不同对象进行输入的可能性，并以 4 种不同的方式进行了探索

```
 public String input1()
{
    System.out.println("enter the input");
    Scanner sc=new Scanner(System.in);
    String s1=sc.nextLine();
    return s1;
}
public String input2()throws IOError
{

    Console c=System.console();
    String s2=null;
    s2=c.readLine("enter the value");
    return s2;
}
public String input3()
{
    System.out.println("enter the input");
    String s3=javax.swing.JOptionPane.showInputDialog("enter the text");
    return s3;

}
public String input4()throws Exception
{
    System.out.println("enter the input");
    InputStreamReader isr=new InputStreamReader(System.in);
    BufferedReader br=new BufferedReader(isr);
    String s4=br.readLine();
    return s4;
} 
```

如果我再遇到，我一定会在这里列出

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T16:46:40.907

还有控制台类。

[http://docs.oracle.com/javase/6/docs/api/java/io/Console.html](http://docs.oracle.com/javase/6/docs/api/java/io/Console.html)

其使用示例：

[http://www.javapractices.com/topic/TopicAction.do?Id=79](http://www.javapractices.com/topic/TopicAction.do?Id=79)

# batch-file - 选择程序

> ID：14898904
> 
> 赞同：-1
> 
> 时间：2013-02-15T16:23:19.007
> 
> 标签：batch-file, choice

我正在尝试制作一个在用户做出选择后发送消息的程序，但在做出选择后它只是关闭 cmd。有什么帮助吗？这是程序。

```
 @echo off
    title Get A Life
    cd C:
    :menu
    cls
    echo I take no responsibility for your actions. Beyond this point it is you that   has the power to kill yourself. If you press ‘x’ then your PC will be formatted. Do not cry if you loose your data or anything.
    pause
    echo Pick your option:
    echo 1\. Die slowly
    echo 2\. Instant Death
    echo 3\. Stay Away From This One
    echo 4\. Die this way (For Wimps!)
    echo 5\. Easy way out
    set input=nothing
    set /p input=Choice:
    if %input%=1
    then msg * Your computer will now sutdown
    else GOTO END
    if %input%=2
    then msg * Your hard drive will now be formatted
    else GOTO END
    if %input%=3
    then msg * FINE! JUST PICK THE MIDDLE ONE!
    else GOTO end
    if %input%=4 
    then msg * Can you guess what happens next?
    else GOTO END
    if %input%=5
    then START %documents%/%Personal Projects%/Cool trick.bat
    :END 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T16:44:55.770

试试这个：

```
@echo off
title Get A Life
cd C:
:menu
cls
echo I take no responsibility for your actions. Beyond this point it is you that   has the power to kill yourself. If you press ‘x’ then your PC will be formatted. Do not cry if you loose your data or anything.
pause
echo Pick your option:
echo 1\. Die slowly
echo 2\. Instant Death
echo 3\. Stay Away From This One
echo 4\. Die this way (For Wimps!)
echo 5\. Easy way out
set input=nothing
set /p input=Choice:

if %input%==1 (
    msg * Your computer will now sutdown
) else if %input%==2 (
    msg * Your hard drive will now be formatted
) else if %input%==3 (
    msg * FINE! JUST PICK THE MIDDLE ONE!
) else if %input%==4 (
    msg * Can you guess what happens next?
) else if %input%==5 (
    START %documents%/%Personal Projects%/Cool trick.bat
)
:END 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T16:46:12.200

好吧，我不确定那是什么语言，但这里是 Windows 批处理：

```
@echo off
title Get A Life
cd C:
:menu
cls
echo I take no responsibility for your actions. Beyond this point it is you that   has the power to kill yourself. If you press ‘x’ then your PC will be formatted. Do not cry if you loose your data or anything.
pause
echo Pick your option:
echo 1\. Die slowly
echo 2\. Instant Death
echo 3\. Stay Away From This One
echo 4\. Die this way (For Wimps!)
echo 5\. Easy way out
set input=nothing
set /p input="Choice: "

for %%I in (1 2 3 4 5) do if "%choice%"=="%%I" goto run%%I
goto :EOF

:run1
echo * Your computer will now sutdown
goto :EOF

:run2
echo * Your hard drive will now be formatted
goto :EOF

:run3
echo * FINE! JUST PICK THE MIDDLE ONE!
goto :EOF

:run4
echo * Can you guess what happens next?
goto :EOF

:run5
START %documents%/%Personal Projects%/Cool trick.bat 
```

# git - Ubuntu下的Git分支提示不起作用

> ID：14898905
> 
> 赞同：0
> 
> 时间：2013-02-15T16:23:20.567
> 
> 标签：git, prompt

我在 Ubuntu 12.10 下，我已经安装了这个 git-prompt-aware：[https ://github.com/jimeh/git-aware-prompt](https://github.com/jimeh/git-aware-prompt)

每当我在一个有 git 存储库的目录中时，我都需要做 source`~/.bash_profile`来显示分支。如果我不这样做，它就不会出现。但是，当我关闭终端并转到同一目录时，我需要再次执行`~/.bash_profile`，任何想法为什么会发生这种情况？

我的问题是在 .bashrc 中我已经将 PS1 定义为：

```
case "$TERM" in
    xterm-color) color_prompt=yes;;
esac

# uncomment for a colored prompt, if the terminal has the capability; turned
# off by default to not distract the user: the focus in a terminal window
# should be on the output of commands, not on the prompt
force_color_prompt=yes

if [ -n "$force_color_prompt" ]; then
    if [ -x /usr/bin/tput ] && tput setaf 1 >&/dev/null; then
    # We have color support; assume it's compliant with Ecma-48
    # (ISO/IEC-6429). (Lack of such support is extremely rare, and such
    # a case would tend to support setf rather than setaf.)
    color_prompt=yes
    else
    color_prompt=
    fi
fi

if [ "$color_prompt" = yes ]; then
    PS1='${debian_chroot:+($debian_chroot)}\[\033[01;32m\]\u@\h\[\033[00m\]:\[\033[01;34m\]\w\[\033[00m\]\$ '
else
    PS1='${debian_chroot:+($debian_chroot)}\u@\h:\w\$ '
fi
unset color_prompt force_color_prompt

# If this is an xterm set the title to user@host:dir
case "$TERM" in
xterm*|rxvt*)
    PS1="\[\e]0;${debian_chroot:+($debian_chroot)}\u@\h: \w\a\]$PS1"
    ;;
*)
    ;;
esac 
```

这会覆盖我在 .bash_profile 中的内容：

```
export GITAWAREPROMPT=~/.bash/git-aware-prompt
source $GITAWAREPROMPT/main.sh
export PS1="\u@\h \w\[$txtcyn\]\$git_branch\[$txtylw\]\$git_dirty\[$txtrst\]\$ " 
```

如何结合这两个 PS1 设置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T16:24:38.187

把里面的内容放进`~/.bash_profile`去`~/.bashrc`。每次启动终端时，`~/.bashrc`都会读取 的内容。

# powershell - Powershell IIS 日志耗时大于

> ID：14898907
> 
> 赞同：3
> 
> 时间：2013-02-15T16:23:29.967
> 
> 标签：powershell, iis-7, w3c

我正在尝试获取耗时超过 999 毫秒的请求的准确计数。我试过使用这个脚本：

[http://wingleungchan.blogspot.com/2011/04/parsing-iis-logs-with-powershell.html](http://wingleungchan.blogspot.com/2011/04/parsing-iis-logs-with-powershell.html)

但它不能准确地提取大于 999 的数字。在 Powershell 中是否有一种有效的方法来对基于整数的 IIS(W3C) 字段进行排序？

仅供参考：我正在运行 Windows 2008。请不要建议我使用 Log Parser。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2021-03-18T09:35:24.927

# 导入 Iis 日志

由于问题中的赞成评论发布的有用链接（[https://poshcode.org/2574](https://poshcode.org/2574)）已损坏，以下是网页上的原始内容（PowerShell脚本）（以防对任何人有帮助）：

## Mark Shevchenko 的 Import-Iis-Log

读入以`*log`W3C 格式保存的 IIS 文件。

该`Import-Iis-Log`cmdlet 为您提供了一种从 IIS`*log`文件（以 W3C 格式保存）中读取数据，然后在 Windows PowerShell 控制台中以表格格式显示该数据的方法。

## 参数：

*   `Path`(string, required, position = 0, value from pipeline, not null, not empty) 指定要导入的 IIS *.log 文件的路径。您还可以通过管道将路径导入 Import-Iss-Log。

*   `Delimiter`(string, position = 1, not null, not empty) 指定分隔 IIS *log 文件中的属性值的分隔符。默认值为空格键。

*   `Encoding`(Microsoft.PowerShell.Commands.FileSystemCmdletProviderEncoding) IIS *.log 文件的字符编码。默认值为 UTF8。

## 管道对象中的 cmdlet 输出具有以下属性：

`DateTime`(System.DateTime) 日志的组合“日期”和“时间”值。

`ClientHost`(System.Net.IpAddress) 日志的“c-ip”值。

`UserName`（匿名用户的字符串或 $null）日志的“cs-username”值。

`Service`（字符串）日志的“s-sitename”值。

`Machine`（字符串）日志的“s-computername”值。

`ServerIp`(System.Net.IpAddress) 日志的“s-ip”值。

`ServerPort`(int) 日志的“s-port”值。

`Method`（字符串）日志的“cs-method”值。

`ScriptPath`（字符串）日志的“cs-uri-stem”值，使用 System.Web.HttpUtility.UrlDecode 解码。

`QueryString`（字符串或 $null 用于没有查询字符串的 HTTP 请求）日志的“cs-uri-query”值，使用 System.Web.HttpUtility.UrlDecode 解码。

`ServiceStatus`(int) 日志的“sc-status”值。

`ServiceSubStatus`(int) 日志的“sc-substatus”值。

`Win32Status`(int) 日志的“sc-win32-status”值。

`BytesSent`(System.UInt64) 日志的“sc-bytes”值。

`BytesRecived`(System.UInt64) 日志的“cs-bytes”值。

`ProcessingTime`(int) 日志的“耗时”值。

`ProtocolVersion`（字符串）日志的“cs-version”值。

`Host`（不带 Host 标头的 HTTP 请求的 $null 字符串）日志的“cs-host”值。

`UserAgent`（对于没有 User-Agent 标头的请求的字符串或 $null）“cs(User-Agent)”日志的值。

`Cookie`（对于没有 cookie 的请求，字符串或 $null）“cs(Cookie)”日志的值。

`Referer`（对于没有引用者的请求，字符串或 $null）“cs(Referer)”日志的值，使用 System.Web.HttpUtility.UrlDecode 解码。

```
param
(
    [Parameter(
        Mandatory=$true,
        Position = 0,
        ValueFromPipeline=$true,
        HelpMessage="Specifies the path to the IIS *.log file to import. You can also pipe a path to Import-Iss-Log."
    )]
    [ValidateNotNullOrEmpty()]
    [string]
    $Path,

    [Parameter(
        Position = 1,
        HelpMessage="Specifies the delimiter that separates the property values in the IIS *.log file. The default is a spacebar."
    )]
    [ValidateNotNullOrEmpty()]
    [string]
    $Delimiter = " ",

    [Parameter(HelpMessage="The character encoding for the IIS *log file. The default is the UTF8.")]
    [Microsoft.PowerShell.Commands.FileSystemCmdletProviderEncoding]
    $Encoding = [Microsoft.PowerShell.Commands.FileSystemCmdletProviderEncoding]::UTF8
)

begin
{
    $fieldNames = @()

    $output = New-Object Object
    Add-Member -InputObject $output -MemberType NoteProperty -Name "DateTime" -Value $null
    Add-Member -InputObject $output -MemberType NoteProperty -Name "ClientHost" -Value $null
    Add-Member -InputObject $output -MemberType NoteProperty -Name "UserName" -Value $null
    Add-Member -InputObject $output -MemberType NoteProperty -Name "Service" -Value $null
    Add-Member -InputObject $output -MemberType NoteProperty -Name "Machine" -Value $null
    Add-Member -InputObject $output -MemberType NoteProperty -Name "ServerIp" -Value $null
    Add-Member -InputObject $output -MemberType NoteProperty -Name "ServerPort" -Value $null
    Add-Member -InputObject $output -MemberType NoteProperty -Name "Method" -Value $null
    Add-Member -InputObject $output -MemberType NoteProperty -Name "ScriptPath" -Value $null
    Add-Member -InputObject $output -MemberType NoteProperty -Name "QueryString" -Value $null
    Add-Member -InputObject $output -MemberType NoteProperty -Name "ServiceStatus" -Value $null
    Add-Member -InputObject $output -MemberType NoteProperty -Name "ServiceSubStatus" -Value $null
    Add-Member -InputObject $output -MemberType NoteProperty -Name "Win32Status" -Value $null
    Add-Member -InputObject $output -MemberType NoteProperty -Name "BytesSent" -Value $null
    Add-Member -InputObject $output -MemberType NoteProperty -Name "BytesRecived" -Value $null
    Add-Member -InputObject $output -MemberType NoteProperty -Name "ProcessingTime" -Value $null
    Add-Member -InputObject $output -MemberType NoteProperty -Name "ProtocolVersion" -Value $null
    Add-Member -InputObject $output -MemberType NoteProperty -Name "Host" -Value $null
    Add-Member -InputObject $output -MemberType NoteProperty -Name "UserAgent" -Value $null
    Add-Member -InputObject $output -MemberType NoteProperty -Name "Cookie" -Value $null
    Add-Member -InputObject $output -MemberType NoteProperty -Name "Referer" -Value $null
}

process
{
    foreach($line in Get-Content -Path $Path -Encoding $Encoding)
    {
        if($line.StartsWith("#Fields: "))
        {
            $fieldNames = @($line.Substring("#Fields: ".Length).Split($Delimiter));
        }
        elseif(-not $line.StartsWith("#"))
        {
            $fieldValues = @($line.Split($Delimiter));

            for($i = 0; $i -lt $fieldValues.Length; $i++)
            {
                $name = $fieldNames[$i]
                $value = $fieldValues[$i]

                switch($name)
                {
                "date" { $output.DateTime = [DateTime]::Parse($value) }
                "time" { $output.DateTime += [TimeSpan]::Parse($value) }
                "c-ip" { $output.ClientHost = [System.Net.IPAddress]::Parse($value) }
                "cs-username" { $output.UserName = if($value -eq '-') { $null } else { $value } }
                "s-sitename" { $output.Service = $value }
                "s-computername" { $output.Machine = $value }
                "s-ip" { $output.ServerIp = [System.Net.IPAddress]::Parse($value) }
                "s-port" { $output.ServerPort = [int]$value }
                "cs-method" { $output.Method = $value }
                "cs-uri-stem" { $output.ScriptPath = [System.Web.HttpUtility]::UrlDecode($value) }
                "cs-uri-query" { $output.QueryString = if($value -eq '-') { $null } else { [System.Web.HttpUtility]::UrlDecode($value) } }
                "sc-status" { $output.ServiceStatus = [int]$value }
                "sc-substatus" { $output.ServiceSubStatus = [int]$value }
                "sc-win32-status" { $output.Win32Status = [BitConverter]::ToInt32([BitConverter]::GetBytes([UInt32]($value)), 0) }
                "sc-bytes" { $output.BytesSent = [UInt64]$value }
                "cs-bytes" { $output.BytesRecived = [UInt64]$value }
                "time-taken" { $output.ProcessingTime = [int]$value }
                "cs-version" { $output.ProtocolVersion = $value }
                "cs-host" { $output.Host = if($value -eq '-') { $null } else { $value } }
                "cs(User-Agent)" { $output.UserAgent = if($value -eq '-') { $null } else { $value } }
                "cs(Cookie)" { $output.Cookie = if($value -eq '-') { $null } else { $value } }
                "cs(Referer)" { $output.Referer = if($value -eq '-') { $null } else { [System.Web.HttpUtility]::UrlDecode($value) } }
                }
            }

            Write-Output $output
        }
    }
} 
```

来源：[https ://web.archive.org/web/20170430094952/https://poshcode.org/2574](https://web.archive.org/web/20170430094952/https://poshcode.org/2574)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-08T21:39:26.507

ConvertFrom-Csv works pretty well. You need to strip out the comment lines and provide a list of headers.

```
$headers @("Date", "Time", ..., "TimeTaken")
Get-Content "u_ex130815.log" | select -Skip 4| ConvertFrom-Csv -Delimiter " " -Header $headers | ? timetaken -gt 999 
```

# php - 将 html 存储在数据库中以便用户可以编辑它是一个坏主意吗？

> ID：14898911
> 
> 赞同：3
> 
> 时间：2013-02-15T16:23:36.987
> 
> 标签：php, mysql

我只是想听听你对我打算如何处理这种情况的意见。

情况：我正在开发一所学校的网站，严格的教育委员会政策不允许除我以外的任何人通过 FTP 访问该网站。但是，学校将在一个“网页”类中设置一组六名学生，以管理需要经常更新的 10-12 个页面。

这些页面看起来都非常相似：标题、导航、侧边导航（针对特定部分（体育、学术等））和**主要内容**。

主要内容由 div“内容”提供，所以我想做的只是从用另一个文件编辑的 Mysql db 加载所有#content 的内容（我非常保证使用准备好的语句）。

您对此有什么意见，或者有更好的方法吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T16:30:55.583

当您将标记保存在数据库中时，为了获得您需要的标记：

1.  解析配置文件（如果有）并建立连接
2.  查询并获取数据
3.  附加结果

当您将标记保存在文件中时，您需要做的就是通过`require()`语言结构包含该标记

**编辑**

**具体来说**- 不。将动态 HTML 内容存储在表格中并不是一个坏主意。这是一种**常见的做法**。但是，如果您还将标题，导航等静态内容存储在每个页面的表格中，则只会导致**数据重复**。

我个人会将我从未更改过的部分存储在文件中。倾向于“动态”的部分我会存储在表格中。我会使用 jquery-ajax 通过 TinyMCE 添加/编辑它们。

我如何做到这一点的一个例子：

文件：page_view.php

```
<?php

class Page_View // <- This isn't MVC
{
    private $data = array();

    public function render()
    {
        include('page_template.phtml');
        exit();
    }

    private function getTitle()
    {
       return $this->data['title'];
    }

    private function getBody()
    {
        return $this->data['body'];
    }

    private function getStaticBlock($file)
    {
        include($file);
    }

    public function setBody($body)
    {
       $this->data['body'] = $body;
    }

    public function setTitle($title)
    {
       $this->data['title'] = $title;
    }
} 
```

文件：page_template.phtml ?>

```
<!DOCTYPE html>
<html>
<head>
<title><?php echo $this->getTitle(); ?></title>

<?php $this->getStaticBlock('/templates/blocks/header.phtml'); ?> 

<body>
 <div id="navigation">
  <?php $this->getStaticBlock('/templates/blocks/navigation.phtml'); ?>
 </div>

   <div id="content"><?php echo $this->getBody(); ?></div>

</body>
</head>
</html> 
```

使用示例：

```
<?php

// $data is what you got from a table

$page = new Page_View();
$page->setTitle($data['title']);
$page->setBody($data['body']);

$page->render(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T17:19:43.053

是的，在数据​​库中存储任意 HTML 是维护和安全的**噩梦。**在设计新解决方案之前，我会更仔细地研究您要完成的工作。

我强烈推荐一个内容管理系统。他们有能力处理这种工作，从头开始重建没有任何意义。

如果选定的学生将经常更新网站，请考虑将网站的那部分分开。

例如，如果主网站是静态的，但经常更新的部分是博客，则设置一个静态网站以及一个包含 wordpress 博客的子域或子目录。

如果学生要编辑页面的实际内容，那么像 Drupal 这样的 CMS 更有效。

# ajax - 对象未添加到集合中

> ID：14898913
> 
> 赞同：1
> 
> 时间：2013-02-15T16:23:47.367
> 
> 标签：ajax, asp.net-mvc-3

我有这个模型：

```
public class QuestionDTO
{
    public Question Question { get; set; }
    public OpenQuestionAnwser OpenQuestionAnwser { get; set; }
    public List<ChoiceQuestionAnwser> ChoiceQuestionAnwsers { get; set; }

    public void AddChoiceQuestionAnwser()
    {
        ChoiceQuestionAnwsers.Add(new ChoiceQuestionAnwser() {ChoiceQuestionAnwserID = ChoiceQuestionAnwsers.Count});
    }

    public void RemoveChoiceQuestionAnwser(int index)
    {
        ChoiceQuestionAnwsers.RemoveAt(index);
    }

    public void Save()
    {

    }
} 
```

我想创建一个 ajax 表单来动态地将对象添加到集合中，但是我遇到了问题，因为当我将表单发送到服务器时，我得到了一个空集合。我尝试了几种不同的方法，但没有运气。

表格代码：

```
@using (Ajax.BeginForm("AddChoiceQuestionAnwser","Question",new AjaxOptions
                                                                    {
                                                                        UpdateTargetId = "chooseAnwsersTableBody"
                                                                    }))

{
    <table class="hovered" id="anwsers">
        <tr>
            <th>Poprawna</th>
            <th>Treść odpowiedzi</th>
            <th></th>
        </tr>
        <tbody id="chooseAnwsersTableBody">
            @Html.Partial("ChooseAnwsersView",Model)
        </tbody>
    </table>

    @Html.HiddenFor(a => a.ChoiceQuestionAnwsers);            
    @Html.HiddenFor(a => a.OpenQuestionAnwser)
    @Html.HiddenFor(a => a.Question)

    <div>
        <input type="submit" value="Dodaj odpowiedź"/>
    </div>
} 
```

和控制器代码：

```
[HttpPost]
public ActionResult AddChoiceQuestionAnwser(QuestionDTO questionDto)
{
    questionDto.AddChoiceQuestionAnwser();
    return PartialView("ChooseAnwsersView", questionDto);
} 
```

和局部视图

```
@model BusinessLogic.DTO.Test.QuestionDTO
@{
    ViewBag.Title = "ChooseAnwsersView";
}

@foreach(var item in Model.ChoiceQuestionAnwsers)
{
    <tr>
        <td>     @Html.CheckBox("ChoiceQuestionAnwsers["+item.ChoiceQuestionAnwserID+"].IsCorrect",item.IsCorrect,new {@id="ChoiceQuestionAnwsers_"+item.ChoiceQuestionAnwserID+"__IsCorrect"})
            @Html.Hidden("ChoiceQuestionAnwsers[" + item.ChoiceQuestionAnwserID + "].ChoiceAnwserType", item.ChoiceAnwserType, new { @id = "ChoiceQuestionAnwsers_" + item.ChoiceQuestionAnwserID + "__ChoiceAnwserType" })
            @Html.Hidden("ChoiceQuestionAnwsers[" + item.ChoiceQuestionAnwserID + "].ChoiceQuestionAnwserID", item.ChoiceQuestionAnwserID, new { @id = "ChoiceQuestionAnwsers_" + item.ChoiceQuestionAnwserID + "__ChoiceQuestionAnwserID" })
            @Html.Hidden("ChoiceQuestionAnwsers[" + item.ChoiceQuestionAnwserID + "].Data", item.Data, new { @id = "ChoiceQuestionAnwsers_" + item.ChoiceQuestionAnwserID + "__Data" })
            @Html.Hidden("ChoiceQuestionAnwsers[" + item.ChoiceQuestionAnwserID + "].Question", item.Question, new { @id = "ChoiceQuestionAnwsers_" + item.ChoiceQuestionAnwserID + "__Question" })
            @Html.Hidden("ChoiceQuestionAnwsers[" + item.ChoiceQuestionAnwserID + "].QuestionID", item.QuestionID, new { @id = "ChoiceQuestionAnwsers_" + item.ChoiceQuestionAnwserID + "__QuestionID" })
        </td>
        <td>@Html.Editor("ChoiceQuestionAnwsers[" + item.ChoiceQuestionAnwserID + "].Text", item.Text, new { @id = "ChoiceQuestionAnwsers_" + item.ChoiceQuestionAnwserID + "__Text" })
        </td>
        <td><a href='#' data-bind='click: $root.removeGift'>Usuń</a></td>
    </tr>
} 
```

有谁能够帮我？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T23:21:15.673

尝试强输入表单：

```
@for (int i = 0; i < Model.ChoiceQuestionAnwsers.Count; i++) 
{
    @Html.CheckBoxFor(m => m.ChoiceQuestionAnwsers[i].IsCorrect)
    ...
} 
```

在你的局部视图里面。

# sql - 需要包含不匹配记录的 SQL 查询帮助

> ID：14898920
> 
> 赞同：0
> 
> 时间：2013-02-15T16:24:00.907
> 
> 标签：sql

我需要显示一个查询，该查询显示与主查找表匹配和不匹配的行

该`@PostCodes`表包含第二个查询将与之匹配的主表的邮政编码

```
DECLARE @PostCodes TABLE 
(
    RowID int not null primary key identity(1,1), 
    Postcodes varchar(100) 
) 

SELECT 
   C.CampaignId, C.Name, C.Description,C.EndedOn, C.Active, C.Manager, 
   P.PostcodeArea, P.PostcodeDistrict
FROM 
   Campaign C, CampaignPostcode P, @PostCodes pc
WHERE 
   P.CampaignId = C.CampaignId AND
   P.PostcodeDistrict = pc.Postcodes AND
   C.EndedOn IS NULL 
```

第二个查询只返回与邮政编码匹配的记录，我已经尝试了所有方法来包含不匹配的记录，但没有运气。

有什么帮助吗？

* * *

## 编辑（表格）

```
 PostCodes  (table1)             Campaign (table2)                      

Id      Postcodes          CampaignId    Name      Desc           
1        AA                  1            camp1    Desc1
2        AB                  2            camp2    Desc2 
3        AC                  3            camp3    Desc3
4        AD                  4            camp4    Desc4

CampaignPostcode (table3)

CampaignPostcodeId  CampaignId  PostcodeArea
 1                      1          AA
 2                      2          AB
 3                      2          AB
 4                      3          AC 
```

需要输出

```
 Id  CampaignName   Desc   PostcodeIn PostcodeOut
    1    Camp1        Desc1     AA          NULL
    2    Camp2        Desc2     AB          NULL
    3    Camp2        Desc2     AB          NULL
    4    Camp3        Desc3     AC          NULL
    5    Camp4        Desc4     NULL        AD 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T16:29:09.423

那这个呢：

```
SELECT 
   C.CampaignId, C.Name, C.Description,C.EndedOn, C.Active, C.Manager, 
   P.PostcodeArea, P.PostcodeDistrict
FROM 
   Campaign C
INNER JOIN
   CampaignPostcode P ON P.CampaignId = C.CampaignId
LEFT OUTER JOIN
   @PostCodes pc ON P.PostcodeDistrict = pc.Postcodes 
WHERE 
   C.EndedOn IS NULL 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T17:06:48.423

试试这个：

```
SELECT   
  p.*
FROM @PostCodes AS PC
LEFT JOIN
(
  SELECT *
  FROM Campaign C
  INNER JOIN CampaignPostcode P ON  P.CampaignId = C.CampaignId
) AS p ON P.PostcodeDistrict = pc.Postcodes
WHERE P.EndedOn IS NULL 
```

# html - IE8 及以下内联块 CSS

> ID：14898928
> 
> 赞同：0
> 
> 时间：2013-02-15T16:24:32.213
> 
> 标签：html, internet-explorer, css

所以我知道 IE8 及以下版本不喜欢`inline-block`，但我读到`inline`应该会导致相同的行为。所以我修改了我的复制`main.css`到`main-ie8below.css`并将所有更改`inline-block`为`inline`. 我使用以下代码来尝试实现这一目标：

```
 <!--[if lte IE 8]>
            <link rel="stylesheet" type="text/css" href="/media/css/main-ie8below.css" />
        <![endif]-->
        <!--[if gt IE 8]>
            <link rel="stylesheet" type="text/css" href="/media/css/main.css" />
        <![endif]-->
        <!--[if !IE]><!-->
            <link rel="stylesheet" type="text/css" href="/media/css/main.css" />
         <!--<![endif]--> 
```

但是，这是行不通的。看来我的 if 语句不正确。是这样吗，还是我错过了其他东西？

这是有问题的 HMTL（删除了无用的东西）：

```
 <nav id="main_nav" role="navigation"><!--
                            <div><a href=""><img src=""  /></a></div><!--
                    --><div><a href=""><img src=""  /></a></div><!--
                    --><div><a href=""><img src=""  /></a></div><!--
                    --><div><a href=""><img src=""  /></a></div><!--
                    --> 
```

这是一个小提琴，除了没有图像：

[http://jsfiddle.net/bqXsU/](http://jsfiddle.net/bqXsU/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T16:26:23.700

您需要使用这种方式：

```
display: inline;
zoom: 1; 
```

我猜你错过了这个`zoom: 1`部分。如果您要与适用于所有 IE 版本和现代浏览器的现有样式表耦合，那么最好使用这种方式：

```
display: inline-block;
*display: inline;
*zoom: 1; 
```

但问题是，您的 CSS 可能无法验证。

* * *

没看懂，哪一部分是你没看懂的。让我解释一下我使用的三个东西。

1.  **Star Hack：**在样式规则前面添加 a `*`，将使其仅对 IE 7 及以下版本可见。
2.  **验证问题：**规则`*zoom`和`*display`不是有效的 CSS 属性。
3.  **这是如何运作的？**在 IE 7 及更低版本中，这`zoom: 1;`将触发元素的属性，从而`hasLayout`使其可用于`width`、`height`和。`margin``padding`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T19:27:27.413

原来是 IE8 无法识别 HTML5 元素的问题。通过添加 HTML5shiv 我能够修复它。

# c++ - 如何在没有对象函数的情况下检查约束是否可行？

> ID：14898933
> 
> 赞同：4
> 
> 时间：2013-02-15T16:24:46.573
> 
> 标签：c++, math, mathematical-optimization, linear-programming

我的教授给了我一个二元线性规划问题，但这个问题与我过去解决的优化问题略有不同（即这可能不是最大化或最小化目标函数。）

问题如下，给定一个矩阵 M，对于条目 m_ij != 0，有对应的 x_ijk 变量。条目 m_ij = 0 可以忽略。

x_ijk要么是0要么是1，我想为每个m_ij尝试5个x_ijk变量（即x_ij1、x_ij2、x_ij3、x_ij4和x_ij5。其中一个为1，其他为0）足以满足一些条件（一组不等式）。

更简单地说，这是检查每个 m_ij 涉及 5 个 x_ijk 变量的约束集是否是有效（或可行）约束。

我已经解决了一些优化问题，但我从来没有解决过没有目标函数的问题。

我应该在这里设置什么作为我的目标函数？0? 没有？

我可能正在使用 lp_solve 或 CPLEX。

提前感谢您的建议！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T18:56:10.323

没错，您可以将任意常数值设置为目标函数。

我尝试过的大多数求解器都允许一个空的目标函数。只需将其从您的模型中删除即可。

根据您使用的求解器和 API，您可能必须将目标中所有变量的系数设置为零。

别担心，它必须工作。

* * *

**回复您的评论：**是的，约束编程工具可以在可行性问题上提供比 LP 求解器（例如 CPLEX）更好的性能。几个月前我玩过[IBM ILOG CPLEX CP Optimizer ，它对学术用户免费。](http://www-01.ibm.com/software/integration/optimization/cplex-cp-optimizer/)LP 求解器和 CP 求解器都未能解决我的问题。不要指望约束编程会带来奇迹。

请记住，在最坏的情况下，解决约束程序所需的时间会随着问题的规模呈指数增长。迟早，您的问题很可能会变得无法使用任何一种工具来解决。

仅供参考：最后，约束规划求解器将调用 LP 求解器（例如 CPLEX）。

**My advice is:** try the tool you already have / use the problem formulation that is more natural to you. Check whether the tool can solve your problem. Switch tool only if the tool fails and you cannot improve your model.

# mysql - MySql 为一个简单的复选框表单添加了太多记录？

> ID：14898934
> 
> 赞同：0
> 
> 时间：2013-02-15T16:24:48.483
> 
> 标签：mysql, sql, checkbox, many-to-many

我创建了一个包含很多复选框的表单，我想知道如何将它放入我的 MySql 数据库中。

下面是一个表格示例：

* * *

标签：金额

复选框：很少 | 许多 | 没那么多| 等等等等

* * *

标签：篮式

复选框：木篮 | 钢篮 | 等| 等等

* * *

标签： 水果

复选框：香蕉 | 苹果 | 橘子| 高分辨率照片| CLIPARTO 等| 等等

* * *

在上面的示例中，您可以选择多个数量，例如我想要一个只有很少或很多水果的篮子。您只能选择一种篮子类型，您可以选择一种或多种水果。

所有这些单独的项目都从数据库中加载，并在复选框中添加了一个 id。

现在提交表单时我现在存储它们的方式是：表：FruitBasket Record 1：Fruitbasket Id = 1 Fruit Id = 1 Basket Type = 1 Amount Id = 1 Record 2：Fruitbasket Id = 1 Fruit Id = 1 Basket Type = 1金额 ID = 3

因此，如果选中 10 个复选框，则提交此表单一次将生成大量记录。很多用户将创建这些，并且可以选择比较这些 FruitBasket。

所以我的问题是，我目前存储数据的方式是否正确，因为它似乎真的效率低下并且生成了这么多记录。有没有另一种方法将所有这些数据存储为一个水果篮？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T16:57:16.667

我建议使用位域来存储每个水果篮。您可以使用按位运算符等直接比较水果篮。如果您使用 Javascript 将用户限制为真正可用的选项，那么它应该可以正常工作。

例子：

```
// Quantities
LITTLE = 1        (0x0000000000000001)
MANY = 2          (0x0000000000000010)
NOT_SO_MANY = 4   (0x0000000000000100)
ALL_QTYS = 7      (0x0000000000000111)

// Basket type
WOODEN = 8        (0x0000000000001000)
STEEL = 16        (0x0000000000010000)
ALL_BASKETS = 24  (0x0000000000011000)

// Fruit types
BANANAS = 32      (0x0000000000100000)
APPLES = 64       (0x0000000001000000)
ALL_FRUIT = 96    (0x0000000001100000)

user_selection = LITTLE | STEEL | BANANAS | APPLES;  (0x0000000001110001)

other_user_selection = LITTLE | WOODEN | BANANAS | APPLES;  (0x0000000001101001)

// use the bitwise AND to compare only the fruit types...
if((user_selection & ALL_FRUIT) == (other_user_selection & ALL_FRUIT))
   echo "Fruit selection is the same!"; 
```

# c# - FluentNHibernate 中的参考表

> ID：14898936
> 
> 赞同：0
> 
> 时间：2013-02-15T16:24:50.160
> 
> 标签：c#, nhibernate, fluent-nhibernate

我有一组通过引用表（产品、商店和商店产品）映射的表

**表**

```
Table: Product
---------------
Name
Id
Desc

Table: Stores
---------------
Name
Id
ZipCode

Table: StoreProduct
---------------
Id
StoreId
ProductId
isAvailable
ShelfID 
```

**楷模**

```
public class Store
{
    public int Id {get;set;}
    public string Name {get;set;}
    public List<Product> Products {get;set;}
}

public class Product
{
    public int Id {get;set;}
    public string Name {get;set;}
    public bool isAvailable {get;set;}
    public int ShelfId {get;set}
    public List<Store> Stores {get;set;}
} 
```

**映射**

```
public class StoreMap: ClassMap<Store>
{
    public StoreMap()
    {
        Id(x => x.Id);
        Map(x => x.Name).Length(255).Nullable();
        HasMany(x => x.Products)
            .Table("StoreProduct")
            .ParentKeyColumn("StoreId")
            .ChildKeyColumn("ProductId");

    }
}

public class ProductMap: ClassMap<Product>
{
    public ProductMap()
    {
        Id(x => x.Id);
        Map(x => x.Name).Length(255).Nullable();
        HasMany(x => x.Stores)
            .Table("StoreProduct")
            .ParentKeyColumn("ProductId")
            .ChildKeyColumn("StoreId");

    }
} 
```

我查看了[FluentNHibernate 查找表](https://stackoverflow.com/questions/1494055/fluentnhibernate-lookup-table)，但看不到如何将其应用于我的结构。我走的是正确的路线吗？如何使用 Fluent 映射将 StoreProduct 表映射到每个域模型？

其次，如何将参考查找表中的列映射到子表（参见 isAvailable 列）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T16:43:56.027

我认为你在这里有一个多对多的关系。一个商店包含许多产品，一个产品可以被多个商店携带。

像这样的东西

```
public ProductMap()
{
    Id(x => x.Id);
    Map(x => x.Name).Length(255).Nullable();
    HasManyToMany(x => x.Stores)
        .AsBag()
        .Table("StoreProduct")
} 
```

# php - 显示mysql查询结果

> ID：14898937
> 
> 赞同：1
> 
> 时间：2013-02-15T16:24:53.640
> 
> 标签：php, sql, median

我已经设法在这里使用其他问题来找到我的表中的中值结果，但现在我不确定如何打印这个结果。

这是我的PHP：

```
$query = "SELECT x.price 
          FROM price_pints x, price_pints y 
          GROUP BY x.price 
          HAVING SUM(    
                       SIGN( 
                             1 - SIGN( y.price - x.price ) 
                           ) 
                    ) / COUNT( * ) > .5 
          LIMIT 1"; 

$result = mysql_query($query) or die(mysql_error());

// Print out result
while($row = mysql_fetch_array($result)){
echo "The average price of a pint ". $row['type']. " is £".$row['x.price(price)'];
echo "<br />";
} 
```

当我在 phpmyadmin 中测试 sql 查询时，结果显示为 5，但是当我回显结果时它不显示。

以前我计算了平均值，这很容易打印为：

```
echo "The average price of a pint ". $row['type']. " is £".$row['AVG(price)']; 
```

现在我被困在如何改变 .$row[price(price)] ^^^

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T16:54:32.733

正如评论所建议的那样，考虑迁移到 PDO 或 mySQLi，因为所有`mysql_`命令都已被弃用。

你的 PHP 需要阅读；

```
echo "The average price of a pint ". $row['type']. " is £".$row['price']; 
```

但是，我想知道您希望在 Type 列中返回什么？由于您没有在上面选择它，因此即使您正在计算所有价格的中位数，您也只会返回一个值和一种类型。

至少，您的 SQL 将是；

```
 SELECT x.price, x.type 
      FROM price_pints x, price_pints y 
      GROUP BY x.price 
      HAVING SUM(    
                   SIGN( 
                         1 - SIGN( y.price - x.price ) 
                       ) 
                ) / COUNT( * ) > .5 
      LIMIT 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T16:35:30.050

首先，您需要考虑使用 mysqli 或 PDO 来运行查询，您完全容易受到使用 mysql_query 的 sql 注入的影响，并且无论如何它已经贬值，并且很快就会被删除。话虽这么说，如果您的查询在直接在数据库上运行时正在运行，它应该从 php.ini 运行。

检查您要返回的行数

```
$numrows = mysql_num_rows($result) 
```

确保您引用了正确的列。

# android - Sherlock 操作栏 invalidateOptionsMenu()

> ID：14898940
> 
> 赞同：6
> 
> 时间：2013-02-15T16:24:58.690
> 
> 标签：android, web-applications, webview, actionbarsherlock

我在这里犯了一个大错误。我正在尝试使用 supportInvalidateOptionsMenu(); 更改操作栏菜单 但是当函数执行时，应用程序关闭，没有错误。

奇怪的是，在我的 Galaxy Nexus (4.2.2) 上一切正常，但在我朋友的手机 (android 4.0.3) 和我的 android 2.1 模拟器中都不起作用

这是我的代码：

```
protected void onCreate(Bundle savedInstanceState) {
...
actionbar = getSupportActionBar();
...
myWebView = (WebView) findViewById(R.id.webview);
myWebView.getSettings().setJavaScriptEnabled(true);
myWebView.addJavascriptInterface(new WebAppInterface(this), "Android");
myWebView.loadUrl(getString(R.string.site_load));
...
}

public class WebAppInterface {
SherlockActivity mActivity;
WebAppInterface(SherlockActivity c) {mActivity = c;}  
public void setrefreshon() {showRefresh = true; mActivity.supportInvalidateOptionsMenu();}
} 
```

有人能帮我吗？：/

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-18T15:10:04.313

这很可能是线程问题。您应该会在主线程之外看到有关 UI 访问的记录错误。也许你正在过滤掉它们？查看完整的日志，而不仅仅是您的包的日志。

从[在 Webview 中构建 Web 应用程序](http://developer.android.com/guide/webapps/webview.html)：

> 注意：绑定到 JavaScript 的对象在另一个线程中运行，而不是在构造它的线程中。

尝试：

```
mActivity.runOnUiThread(new Runnable(){
  @Override
  public void run(){
    mActivity.supportInvalidateOptionsMenu();
  }
}); 
```

# c++ - 在多图中迭代一个组我如何知道我是在第一个还是最后一个元素中？

> ID：14898943
> 
> 赞同：2
> 
> 时间：2013-02-15T16:25:05.053
> 
> 标签：c++, c++11, iteration, multimap

我的意思是这种情况：

```
for (auto iter = myMmap.equal_range(find_key).first;
  iter != myMmap.equal_range(find_key).second;
  ++iter)
{
  //code
} 
```

如何从我在此集合中的第一项或最后一项中的迭代器（即不使用计数器）派生。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-15T16:28:52.417

像这样？

```
auto range = myMmap.equal_range(find_key);

for (auto it = range.first; it != range.second; ++it) {
    if (it == range.first) { // first

    } else if (std::next(it) == range.second) { // last

    } else {}
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T16:29:25.523

我相信混合`iter`并且`cit`是错字。

您检查迭代器是组中的第一个还是最后一个元素，就像您在 for_cycle 中所做的一样 - 第一个元素是`equal_range(find_key).first`，最后一个元素之后的一个元素是`equal_range(find_key).second`。

# php - 上传大文件时未存储 $_POST 变量

> ID：14898944
> 
> 赞同：4
> 
> 时间：2013-02-15T16:25:06.120
> 
> 标签：php, forms, file-upload

首先，我知道有人问过类似的问题，但是我的似乎不是服务器限制的文件大小....

当使用下面表格的一个页面并尝试发送到另一个包含脚本的文件时，它适用于小文件（小于 2MB）。但是，一个稍大的文件（大约 3MB）似乎可以正确传递 $_POST 变量，但脚本由于某些未知原因而失败。最后，一个 9MB 的测试文件根本无法发送 $_POST 变量，并且`print_r($_POST)`每个变量都显示为未定义。

这是表格：

```
<form enctype="multipart/form-data" id="formEditTAPPS" method="POST" action="scripts/editTAPPSprocess.php">
Page ID Number:  <? echo $id; ?>
<input type="hidden" name="id" value="<? echo $id; ?>" />
<br />
Page Title:  <input type="text" name="newPageTitle" value="<?php echo $row['title']; ?>" style="width:300px;" />
<br />
Number of Pages in PDF:  <input type="text" name="newNumberOfPages" value="<?php echo $row['num_pages']; ?>" style="width:30px;" />
<br />
TAPPS Category:
    <select name="newCategory">
        <? while ($row2 = mysql_fetch_array($data2)) {
            $catIDfromCat = $row2['cat_id'];
            $catName = $row2['cat_name'];
        ?><option value="<? echo $catIDfromCat; ?>" <?php if ($catIDfromPages==$catIDfromCat){echo "selected=\"selected\"";} ?> ><? echo $catName; ?></option>
        <? } ?>
    </select>
<br />
Last Updated:  <? echo $row['last_updated']; ?>
<br />
Display Order:  <input type="text" name="newDisplayOrder" value="<?php echo $row['display_order']; ?>" />
<br />
Existing PDF:  <a href="/files/tapps/<? echo $row['filename']; ?>" /><? echo $row['filename']; ?></a>
<br />
Upload a New PDF:  <input name="newPDF" type="file" />
<br />
<input type="submit" name="Submit" value="Update this TAPPS Page" style="margin: 20px 0 0 50px;" /> 
```

这是处理脚本：

```
include_once('../../../common/db/conn.php');     // Connect to the database
// Assigns the variables passed from the form.
$id = $_POST['id'];
$title = $_POST['newPageTitle'];
$num_pages = $_POST['newNumberOfPages'];
$cat_id = $_POST['newCategory'];
$display_order = $_POST['newDisplayOrder'];
$newPDF = basename($_FILES['newPDF']['name']);
// Try to upload the file...
$target = "../../../files/tapps/";
$target = $target . $newPDF;
if(move_uploaded_file($_FILES['newPDF']['tmp_name'], $target)) {
    // Saves the data into the correct database table.
    $sql = "UPDATE tapps_pages SET title='$title', num_pages='$num_pages', cat_id='$cat_id', display_order='$display_order', filename='$newPDF' WHERE id='$id'";
    // Verifies the database stores the form results and sends the user to the "Success" page.
    $result = mysql_query($sql);
    if($result) {
        echo "<meta HTTP-EQUIV=\"REFRESH\" content=\"0; url=../editTAPPSpage.php?id=$id&success=1\">";
    } else {
        echo "<br /><br />Bummer, something broke. &nbsp;&nbsp;&nbsp;&nbsp; =(<br /><br />";
        print_r($_POST);
    }
} else {
    //  Problem uploading the file
    echo "<br /><br />Looks like there was a problem uploading the TAPPS page... Better tell Kevin!<br /><br />He's going to want to know this info, so please copy and paste it into the email...<br />";
    print_r($_POST);
    echo "<br /><br />";
    print_r($_SERVER);
    echo "<br /><br />";
    print_r($_SESSION);
} 
```

听起来`upload_max_filesize`对我来说是个问题，但我已经用 php.ini 文件解决了这个问题：

```
memory_limit = 128M
max_execution_time = 600
upload_max_filesize = 50M
post_max_size = 64M 
```

并`phpinfo()`表明在重新启动 Apache 后更改卡住了。

我是否缺少可能导致超时或将文件大小限制为 2MB 的设置？提前感谢您的帮助！

# windows-8 - 如何在桌面模式和现代 UI 模式之间切换我的应用程序？

> ID：14898946
> 
> 赞同：2
> 
> 时间：2013-02-15T16:25:16.740
> 
> 标签：windows-8, microsoft-metro, windows-runtime, desktop-application

我注意到 Internet Explorer 10 和 Google Chrome 23（？及更高版本）都能够在应用程序中在桌面和现代 UI（又名 Metro）模式之间切换。我一直在试图确定这是如何完成的。我的猜测是这可能使用协议处理程序。[到目前为止，我对 Chromium 源的](https://code.google.com/p/chromium/source/search)搜索证明是徒劳的，所以我想我会把它推销给社区，看看我是否能得到关于如何做到这一点的明确答案。与此同时，我将一如既往地继续寻找其他地方。

那么，如何编写一个同时具有桌面和现代 UI 变体的应用程序，并且能够在应用程序内部在两者之间切换呢？

# javascript - 如何在不使用 eval() 的情况下以 Base62 编码压缩 javascript 代码？

> ID：14898951
> 
> 赞同：1
> 
> 时间：2013-02-15T16:25:25.777
> 
> 标签：javascript, compression, base64, eval

我使用[了这个 javascript 压缩器](http://www.javascriptcompressor.com/)并检查了“Base62 编码”。我注意到它所做的第一件事就是将所有内容都包含在一个`eval()`函数中（这是有道理的），但我*真的*想避免使用它。有没有替代品？？就像一个立即调用的函数表达式？

### 编辑：

我想压缩我的代码，因为有大量的条件`if`用于特征检测。（我不使用 Modernizr 的原因是因为我不想为我正在做的事情加载整个库），而且`if`s 很难看。（另外我是 javascript 的新手，我宁愿学习 javascript 而不是学习 Modernizr）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T17:20:55.657

您可以将 eval(...) 替换为 new Function(...)() ，如下所示：

```
new Function(function(p,a,c,k,e,r){e=function(c){return c.toString(a)};if(!''.replace(/^/,String)){while(c--)r[e(c)]=k[c]||e(c);k=[function(e){return r[e]}];e=function(){return'\\w+'};c=1};while(c--)if(k[c])p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c]);return p}('2(a.6){3.4("5")[0].1+=" 6"}2(b.7){3.4("5")[0].1+=" 7"}2(8.9){3.4("5")[0].1+=" 9"}2(8.c){3.4("5")[0].1+=" d"}',14,14,'|className|if|document|getElementsByTagName|html|opacity|touch|html5|webworkers|css3|has|audio|html5audio'.split('|'),0,{}))() 
```

这并不是一个真正的改进，但它避免了使用 eval。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T17:03:21.920

在第一次检查时，[Closure Compile](https://developers.google.com/closure/compiler/)不会将您的代码包装在`eval()`调用中。这是关于使用 GUI 版本[的教程。](https://developers.google.com/closure/compiler/docs/gettingstarted_ui)

# r - 包“xlsReadWrite”pdf 指南中的错误示例？

> ID：14898952
> 
> 赞同：1
> 
> 时间：2013-02-15T16:25:27.430
> 
> 标签：r, export-to-excel

在以下链接中，您可以找到 xls.ReadWrite 包的 pdf 指南

[http://cran.r-project.org/web/packages/xlsReadWrite/xlsReadWrite.pdf](http://cran.r-project.org/web/packages/xlsReadWrite/xlsReadWrite.pdf)

在 R 上运行此代码可在第 8 页找到（xls.write 函数）：

```
myval <- data.frame(
Fertility = c(80.2, 83.1, 92.5),
Agriculture = c(17, 45.1, 39.7),
Testlogical = c(TRUE, TRUE, FALSE),
Education = as.integer(c(12, 9, 5)),
Catholic = c(9.96, 84.84, 93.4),
Infant.Mortality = c(22.2, 22.2, 20.2),
Testcharacter = c("Co", "De", "Fr"), stringsAsFactors = FALSE)

# write the data.frame...
write.xls(myval, "mytest.xls") 
```

...我收到以下错误：

```
Error in .Call("WriteXls", x, file, colNames, sheet, from - 1, rowNames,  : 
  Incorrect number of arguments (7), expecting 6 for 'WriteXls' 
```

我该如何解释这种奇怪的行为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T20:11:18.320

您需要在安装软件包后运行它：

```
xls.getshlib() 
```

两种情况中的任何一种都会发生：

1 - 它将工作并且软件包将工作或 2 - 它会抱怨您不在 32 位操作系统上并且无法工作。

如果它有效，您的 write.xls 应该可以正常工作。如果不只是导出为 csv 并将其保存为 excel 文件。

# javascript - 捕获放置在 HTML 元素上的文件的位置

> ID：14898954
> 
> 赞同：1
> 
> 时间：2013-02-15T16:25:31.813
> 
> 标签：javascript, html, internet-explorer-8, internet-explorer-9

我想在 HTML 中创建拖放占位符，这将捕获拖放文件的位置。我针对 IE8 和 IE9，并认为一些简单的 JS 可以处理这个，但不是。

我尝试了很多变化。我从失败中很快注意到的第一件事是 IE8/9 不支持“ [file api](http://caniuse.com/#search=fileapi) ”，所以我能够在 SO 上搜索的所有示例都无法应用。然后我尝试使用 iframe 技巧来捕获文件位置，但它在 IE8 上不起作用，据说它适用于 IE9，但我没有检查。

然后我想停止在黑暗中狩猎并询问更有经验的人在IE8 / 9上的HTML页面中拖放功能的方式是什么，而不使用庞大的JS库？

# dataset - 将 CSV 文件读入 Mplus

> ID：14898956
> 
> 赞同：1
> 
> 时间：2013-02-15T15:13:17.843
> 
> 标签：dataset

我在我的 Mac 上使用 Remote Desktop Client 2.1.1 连接到提供 Mplus 6.12 的 Windows 应用程序服务器。然后我运行以下脚本：

```
Title:      Loading data from CSV and performing GMM
DATA:       FILE IS "\\tsclient\Macint1 on Mike's Macbook\Users\Aron\Downloads\output.csv";
VARIABLE:   NAMES ARE repo_name t03 t04 t05 t06 t07 t08 t09 t10 t11 t12;
            CLASSES = c (2);
ANALYSIS:   TYPE = MIXTURE;
            STARTS = 40 8;
MODEL:      %OVERALL$%
            i s | t03@0 t04@1 t05@2 t06@3 t07@4 t08@5 t09@6 t10@7 t11@8 t12@9;
OUTPUT:     TECH1 TECH8; 
```

但是，当我运行它时，我收到以下错误消息：

```
*** ERROR
  The number of observations is 0\.  Check your data and format statement.
  Data file:  \\tsclient\macint1\users\mike\github\local\latent_growth_classes\output.csv
*** ERROR
  Non-missing blank found in data file at record #1, field #: 1 
```

我尝试以多种方式指定路径，以及提供带和不带标题的 CSV 文件，但我总是收到相同的消息。我究竟做错了什么？如何将 CSV 文件读入 Mplus？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T21:49:19.430

Mplus中数据文件的第一行必须是第一行数据，所以上面没有变量名！因此它必须看起来像这样。

```
9.00,3.00,1.00,1.00,34.00,35.00 
0.00,9.00,2.00,1.00,44.00,41.00 
  .    .    .    .     .     .
  .    .    .    .     .     .
  .    .    .    .     .     .
0.00,4.00,3.00,1.00,44.00,33.00 
1.00,4.00,3.00,2.00,36.00,37.00 
```

因此，您必须使用`Names ARE`语句定义名称，并且“记住”变量的确切顺序很重要（因为您无法从数据文件中检索它们）。要获得没有标题的 .csv 文件，您必须使用 TextPad（或类似的东西）打开 .csv 文件并删除变量行并再次保存文件。

注意：如果你很聪明...使用cut而不是delete并在Mplus中粘贴这行变量，这样出错的可能性就会大大降低！

# c# - 泛型方法中的 InvalidCastException

> ID：14898958
> 
> 赞同：1
> 
> 时间：2013-02-15T16:25:41.437
> 
> 标签：c#, generics, casting

我有以下来源：

```
 private T GetValue<T>(object value)
    {
        return (T)value;
    }

    private void button1_Click(object sender, EventArgs e)
    {
        Int64 integer = GetValue<Int64>(0);
    } 
```

所以常数 0 是一个 Int32 并且必须在通用方法 GetValue 中转换为 Int64。但这将导致 InvalidCastException。

但为什么？

当我使用 Int64 作为参数时，它工作正常。

```
 private T GetValue<T>(object value)
    {
        return (T)value;
    }

    private void button1_Click(object sender, EventArgs e)
    {
        Int64 zero = 0;
        Int64 integer = GetValue<Int64>(zero);
    } 
```

感谢乔恩和布赖恩。我的最终（简化）解决方案是这样的。

```
 private T GetValue<T>(object value)
    {
        return (T)Convert.ChangeType(defaultValue, typeof(T));
    }

    private void button1_Click(object sender, EventArgs e)
    {
        Int64 integer = GetValue<Int64>(0);
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-15T16:27:28.330

> 但为什么？

因为你是从一个装箱的拆箱`int`到`long`. 它失败的方式与没有泛型的失败完全相同：

```
int original = 0;
object boxed = original;
long unboxed = (long) boxed; // Bang! 
```

*必须*对相同类型（模枚举和有符号/无符号）进行拆箱转换。

# matlab - 如何对matlab数组进行零填充？

> ID：14898959
> 
> 赞同：7
> 
> 时间：2013-02-15T16:25:41.893
> 
> 标签：matlab

（零）填充matlab数组的最简单方法是什么？
即给定`[1,2,3,4]`和长度6返回`[1,2,3,4,0,0]`

## 背景

我有一个数据数组，我想在对数据运行 fft 之前应用一个窗口函数。

我曾经将数据直接传递给 fft，这会将零填充到 2 的下一个幂，但现在我需要在 fft 之前将它的零填充，这样我就可以乘以窗口函数。

```
fs = 100;                          % Sample frequency (Hz)
t = 0:1/fs:10-1/fs;                % 10 sec sample
x = (1.3)*sin(2*pi*15*t) ...       % 15 Hz component
  + (1.7)*sin(2*pi*40*(t-2)) ...   % 40 Hz component
  + (2.5)*randn(size(t));          % Gaussian noise;

m = length(x);          % Window length
n = pow2(nextpow2(m));  % Transform length
w = barthannwin( n );   % FFT Window

y = fft(data, n);       % DFT

windowed_data = x*w ; % Dimensions do not match as x not padded
y = fft(windowed_data, n); % DFT 
```

我知道[padarray](http://www.mathworks.co.uk/help/images/ref/padarray.html)作为图像处理工具箱的一部分，我没有。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-15T16:28:12.023

**编辑**

这种方法可能对向量更好，因为它在转置时不会中断，请注意它会改变原始向量，这可能是不可取的：

```
myVec = 1:7;
myVec(end+3)=0 
```

或者，您可以连接零和您拥有的向量并用它创建一个新变量。

```
myVec = 1:7;
requiredpadding = 10-7;
myVecPadded=[myVec zeros(1,requiredpadding)] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-15T17:50:27.847

没有内置函数来进行填充，但这里有一个小函数可以在`x`给定最小长度的情况下填充向量`n`。

```
function y = pad(x, n)
y = x;
if length(x) < n
    y(n) = 0;
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-15T17:45:21.823

对于数组，这应该用零填充到最接近的 2 次幂`a`：

`a(2^ceil(log2(length(a))))=0;`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-16T19:01:01.867

Matlab的图像处理工具箱有一个内置函数来填充数组`padarray(A,dim,value`

对于您的示例：

```
A = [1, 2, 3, 4];
dimension = [0 1]; % pad with extra columns
size = 2; % how much to pad
B = padarray(A,size*dimension,'post') % 'post' says to pad at the end
% just for demonstration, let's pre-pad the first dimension (rows)
dimension = [1 0];
C = padarray(A,dimension,'pre') % just as an example
% or pad in both directions
dimension = [1 2];
D = padarray(A,dimension) % by default, it will pad both pre and post 
```

返回

```
B =

 1     2     3     4     0     0

C =

 0     0     0     0
 1     2     3     4
D =

 0     0     0     0     0     0     0     0
 0     0     1     2     3     4     0     0
 0     0     0     0     0     0     0     0 
```

也可以用于多维数组，只需要对维向量进行相应的扩展，即`dimension = [0 0 1]`在第三维上扩展。

# javascript - 单元测试冗余比较值

> ID：14898961
> 
> 赞同：0
> 
> 时间：2013-02-15T16:25:45.257
> 
> 标签：javascript, unit-testing, qunit, redundancy

当我必须检查返回值的函数时，我在单元测试中遇到了这种奇怪的情况，而该值不能手动生成（值）。事实上，这个函数是为创建这个值而设计的。所以像这样测试（javascript和QUnit框架）：

```
asyncTest("UTF-8 - ArrayBuffer conversion", 1, function() {
    var arrayBuffer;
    var testUtf8 = "łużyński";
    var blob = new Blob([testUtf8]);
    var f = new FileReader();
    f.onload = function(e) {
        arrayBuffer = e.target.result;
        start();
    };
    equal(utf8ToArrayBuffer(testUtf8), arrayBuffer, "UTF-8 to ArrayBuffer, OK!");
}); 
```

是多余的，因为准备 arrayBuffer 变量以将其与返回值进行比较实际上与 using 相同`utf8ToArrayBuffer(testUtf8)`，因此测试如下所示：

```
equal(utf8ToArrayBuffer(testUtf8), utf8ToArrayBuffer(testUtf8), "UTF-8 to ArrayBuffer, OK!"); 
```

我应该测试这样的事情还是离开它？或者也许还有另一种方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T17:13:10.830

您不应该测试两个相等的函数调用是否返回相同的结果。您应该测试函数调用的结果是否符合您的预期。在你的情况下，这意味着你有一个值（`"łużyński"`）作为输入，你得到一个数组缓冲区作为输出。您可以测试输入值是否实际包含在输出中。

但是如果没有要测试的函数代码 ( `utf8ToArrayBuffer()`)，很难说您究竟可以测试什么。

# c++ - Qt C++ 慢慢移动 QListWidget

> ID：14898966
> 
> 赞同：0
> 
> 时间：2013-02-15T16:26:00.893
> 
> 标签：c++, qt

我有 QListWidget 我需要从一个点移动到另一个点，但它必须很慢，比如动画。你能帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T16:49:15.687

您需要为此使用[Qt Animation 框架](http://doc.qt.digia.com/4.7-snapshot/animation-overview.html)。有很多可用的示例，因此您应该阅读它。

您正在尝试做的事情可以通过[QPropertyAnimation](http://doc.qt.digia.com/4.7-snapshot/qpropertyanimation.html)类来完成，通过动画[几何](http://doc.qt.digia.com/stable/qwidget.html#geometry-prop)属性`QListWidget`：

```
 QPropertyAnimation animation(&lstWidget, "geometry"); //animate geometry property
 animation.setDuration(5000); // 5 seconds 
 animation.setStartValue(QRect(50, 50, 100, 100)); // start value for geometry property
 animation.setEndValue(QRect(300, 300, 100, 100)); // end value for geometry property

 animation.start(); 
```

这将从小部件从 (50,50) 移动到 (300, 300)。`geometry`您可以通过读取属性 from来设置起始值以`lstWidget`从当前位置开始移动等。

# java - java中的这个动态for循环是什么

> ID：14898969
> 
> 赞同：-4
> 
> 时间：2013-02-15T16:26:03.227
> 
> 标签：java, for-loop

在创建“列表”对象类型后，我已经看到了使用这种 FOR 循环的不同方法。

```
List<Focus> focuses = new ArrayList<Focus>();
String my_string = "";
for (Focus obj1 : list_obj_x) {
    my_string += obj1;
} 
```

我不明白这个 FOR 循环在这种情况下是如何工作的。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T16:28:03.083

它被称为[**增强的 for-loop/For-Each 构造**](http://docs.oracle.com/javase/1.5.0/docs/guide/language/foreach.html)。在 Java 1.5 中引入。它主要是为了迭代集合和数组而引入的。

这个：

```
List<Focus> focuses = new ArrayList<Focus>();
String my_string = "";
for (Focus obj1 : list_obj_x) {
    my_string += obj1;
} 
```

和

```
List<Focus> focuses = new ArrayList<Focus>();
String my_string = "";
for (int i=0; i<focuses.size(); i++) {
    my_string += focuses.get(i);
} 
```

但是请注意，您只能对那些实现[**Iterable 接口**](http://docs.oracle.com/javase/7/docs/api/java/lang/Iterable.html)的对象使用 for-each 循环。

> 实现这个接口允许一个对象成为“foreach”语句的目标。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T16:42:25.950

增强的 for 循环可以与任何实现对象`Iterable<X>`和数组一起使用。它等效于使用带有迭代器的 for 循环（在可迭代的情况下）：

```
// with Iterables:

Iterable<String> iterableStrings = getListOfStrings();

// standard for loop
for (Iterator<String> it = iterableStrings.iterator(); it.hasNext(); ) {
   String s = it.next();
   System.out.println(s);
}

// enhanced for loop
for (String s : iterableStrings) {
   System.out.println(s);
}

// with arrays:

String[] stringArray = getStringArray();

// standard for loop
for (int i = 0; i < stringArray.length; i++) {
   String s = stringArray[i];
   System.out.println(s);
}

// enhanced for loop
for (String s : stringArray) {
   System.out.println(s);
} 
```

它的用途*不仅*限于列表和数组等“索引集合”。

**参考**

[JLS 14.14.2](http://docs.oracle.com/javase/specs/jls/se7/html/jls-14.html#jls-14.14.2)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-15T16:28:14.883

```
for (Focus obj1 : list_obj_x) {
    my_string += obj1;
} 
```

当您看到冒号 (:) 时，将其读作“in”。上面的循环读作“对于 list_obj_x 中的每个 Focus obj1”。如您所见，for-each 构造与泛型完美结合。它保留了所有类型的安全性，同时消除了剩余的混乱。因为您不必声明迭代器，所以您不必为它提供通用声明。（编译器会在你背后为你做这件事，但你不必关心它。）

相当于上面的每个循环是：

```
for (int i =0 ; i< list_obj_x.size(); i++) {
    my_string += list_obj_x.get(i);
} 
```

# sql - 如何在数据库中的所有表中搜索特定值？

> ID：14898973
> 
> 赞同：2
> 
> 时间：2013-02-15T16:26:23.447
> 
> 标签：sql, search

是否有查询或工具可以在所有表​​/字段中搜索特定值？该程序将成本存储在一个字段中，我找不到它。Profiler 不是一个选项。

在此先感谢，布莱恩·摩尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T18:37:51.440

有几个未记录的存储过程遍历所有表和所有数据库，但是确切的答案在这里：http: [//vyaskn.tripod.com/search_all_columns_in_all_tables.htm](http://vyaskn.tripod.com/search_all_columns_in_all_tables.htm)实际上这是一个很好的站点，非常值得一般浏览不时出现的模糊和不太模糊的问题的许多答案。

希望这可以帮助

# api - 嵌入代码 Brightcove 媒体 api

> ID：14898975
> 
> 赞同：1
> 
> 时间：2013-02-15T16:26:24.553
> 
> 标签：api, html, publish, brightcove

我正在尝试找到一种通过 Brightcove 在我的媒体 api 上访问视频发布代码的方法，就像您可以在云工作室上为下面这样的播放器获取的方法一样。

```
<!-- Start of Brightcove Player -->

<div style="display:none">

</div>

<!--
By use of this code snippet, I agree to the Brightcove Publisher T and C 
found at https://accounts.brightcove.com/en/terms-and-conditions/. 
-->

<script language="JavaScript" type="text/javascript" src="http://admin.brightcove.com/js/BrightcoveExperiences.js"></script>

<object id="myExperience" class="BrightcoveExperience">
<param name="bgcolor" value="#FFFFFF" />
<param name="width" value="960" />
<param name="height" value="445" />
<param name="playerID" value="2164048951001" />
<param name="playerKey" value="AQ~~,AAABzJDWv4k~,nrw5-YJoyhvZYIpODobX62cNFZVSM1ri" />
<param name="isVid" value="true" />
<param name="isUI" value="true" />
<param name="dynamicStreaming" value="true" />

</object>

<!-- 
This script tag will cause the Brightcove Players defined above it to be created as soon
as the line is read by the browser. If you wish to have the player instantiated only after
the rest of the HTML is processed and the page load is complete, remove the line.
-->
<script type="text/javascript">brightcove.createExperiences();</script> 
```

我想在我的 api 的视频元数据部分中将此作为选项，有没有人有任何建议从哪里开始。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-16T16:03:11.300

我不确定您是否可以通过 BC API 收集资产的发布代码，但这不是必需的。您可以做的是使用变量来替换该片段中唯一可能更改的项目 - 主要是 playerID 和 playerKey 以及 videoPlayer 值（这将指示要使用哪个播放器以及要插入哪个视频），还有可能的宽度和高度设置。

假设您希望动态换出视频（假设您将始终使用相同的播放器），您可以执行以下操作：

```
function get_player($video_id){
$player = '<script language="JavaScript" type="text/javascript" src="http://admin.brightcove.com/js/BrightcoveExperiences.js"></script>    
<object id="myExperience" class="BrightcoveExperience">
<param name="bgcolor" value="#FFFFFF" />
<param name="width" value="960" />
<param name="height" value="445" />
<param name="playerID" value="2164048951001" />
<param name="playerKey" value="AQ~~,AAABzJDWv4k~,nrw5-YJoyhvZYIpODobX62cNFZVSM1ri" />
<param name="isVid" value="true" />
<param name="isUI" value="true" />
<param name="dynamicStreaming" value="true" />
<param name="@videoPlayer" value="'.$video_id.'" />
</object><script type="text/javascript">brightcove.createExperiences();</script>';
return $player;
} 
```

然后只需使用要在此播放器中显示的视频的 id 调用该函数。这同样适用于更换球员和体型。

```
echo get_player('my_video_id'); 
```

@videoPlayer 参数告诉播放器要加载哪个视频。该[文档](http://support.brightcove.com/en/video-cloud/docs/player-configuration-parameters)可能会有所帮助。

# rest - 用于 REST 服务的 DotNetOpenAuth 提供程序

> ID：14898976
> 
> 赞同：3
> 
> 时间：2013-02-15T16:26:31.953
> 
> 标签：rest, dotnetopenauth

我在我的 ASP.NET MVC 4 Web 应用程序的一个区域中创建了一个 REST API。API 工作正常，我现在想保护它。

有没有一个非常简单的例子来说明我如何做到这一点？我正在浏览 DotNetOpenAuth 下载附带的示例，我完全迷失了它。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-16T12:14:05.867

几天前我遇到了同样的问题。这个答案太长了，也许有更简单的方法。

就个人而言，我不再使用 DNOA，因为它是为自我验证（即加密令牌）而设计的，因此您无需在每次请求时都访问数据库。这样做的一个非常重要的副作用是访问撤销不会立即生效，而只有在必须更新令牌之后才会生效。此外，访问令牌会变得很长（大约 500 字节）。

作为第一步，请确保您知道自己需要什么：

* * *

OAuth / OAuth2 起初看起来很简单，但了解授权工作流程的设计方式很重要。此外，他们的术语可能很烦人，例如“客户端”指的是我天真地称之为客户端*应用程序*的东西。它不是用户（在 OAuth 术语中称为“资源所有者”）。我的建议：阅读[RFC 6749](https://www.rfc-editor.org/rfc/rfc6749)。看起来很枯燥，但读起来很有趣（你可以跳过一半……）

一个关键问题是：您需要 2-legged OAuth 还是 3-legged OAuth（或两者都需要？）。您需要支持哪些资助类型？

如果您基本上想替换 H​​TTP Basic Auth，那么简单的“资源所有者密码凭据流程”就可以了。“让这个应用程序访问我的个人资料信息”的 facebook/twitter 类型是 3-legged OAuth。

有一个 IBM 文档附带了很好的[授权类型图](http://pic.dhe.ibm.com/infocenter/tivihelp/v2r1/index.jsp?topic=/com.ibm.tivoli.fim.doc_6.2.2/config/concept/OAuth20Workflow.html)。

* * *

现在到 DNOA，看看`Samples/OAuthAuthorizationServer`.

一个好的入口点是`OAuthController.cs`文件。请注意，只有当您希望用户能够授予对第三方应用程序的访问权限时（三足 OAuth），才需要`Authorize`和操作。`AuthorizeResponse`

在 2-legged 场景中，用户`token`直接访问 OAuth 端点并简单地请求访问令牌。无论如何，您的 REST 应用程序中都需要这样的控制器。

内部工作的关键是`OAuth2AuthorizationServer`类（不是`AuthorizationServer`类）。看`Code/OAuth2AuthorizationServer.cs`。它实现`IAuthorizationServerHost`.

该类的一半处理数据存储（如果您使用不同的数据存储，您可能需要对其进行修改），其中一半处理访问令牌的加密。您还需要为您的应用程序实现 IAuthorizationServerHost。

确保您的代码中有一行`#define SAMPLESONLY`，因此它将接受硬编码的证书。

要真正授权请求，编写一个 custom 很有帮助`ActionFilterAttribute`。这是一些超级精简的代码，尚未准备好生产：

```
public sealed class BasicAuthenticationAttribute : System.Web.Http.Filters.ActionFilterAttribute
{
    private readonly OAuthResourceServer _authServer; 
    public override void OnActionExecuting(HttpActionContext actionContext)
    {
        if (actionContext.Request.Headers.Authorization.Scheme == "Bearer"
            || actionContext.Request.Properties.ContainsKey("access_token"))
        {
            authenticatedUser = _authServer.VerifyOAuth2(request, required_claims);
            HttpContext.Current.User = authenticatedUser;
            Thread.CurrentPrincipal = authenticatedUser;
        }
    }
}

// See OAuthResourceServer/Code/OAuthAuthorizationManager.cs in DNOA samples
public sealed class OAuthResourceServer
{
    public IPrincipal VerifyOAuth2(HttpRequestMessage httpDetails, params string[] requiredScopes)
    {
        // for this sample where the auth server and resource server are the same site,
        // we use the same public/private key.
        using (var signing = CreateAuthorizationServerSigningServiceProvider())
        {
            using (var encrypting = CreateResourceServerEncryptionServiceProvider())
            {
                var tokenAnalyzer = new StandardAccessTokenAnalyzer(signing, encrypting);
                var resourceServer = new ResourceServer(_myUserService, tokenAnalyzer);
                return resourceServer.GetPrincipal(httpDetails, requiredScopes);
            }
        }
    }
} 
```

资源服务器仍然丢失

```
public sealed class MyResourceServer : ResourceServer
{
    public override System.Security.Principal.IPrincipal GetPrincipal([System.Runtime.InteropServices.OptionalAttribute]
        [System.Runtime.InteropServices.DefaultParameterValueAttribute(null)]
        HttpRequestBase httpRequestInfo, params string[] requiredScopes)
    {
        AccessToken accessToken = this.GetAccessToken(httpRequestInfo, requiredScopes);
        string principalUserName = !string.IsNullOrEmpty(accessToken.User)
            ? this.ResourceOwnerPrincipalPrefix + accessToken.User
            : this.ClientPrincipalPrefix + accessToken.ClientIdentifier;
        string[] principalScope = accessToken.Scope != null ? accessToken.Scope.ToArray() : new string[0];

        // Now your own code that retrieves the user 
        // based on principalUserName from the DB:
        return myUserService.GetUser(userName);
    }
} 
```

接下来，修改 web.config，这样 DNOA 就不会抱怨开发中缺少 SSL 连接：

```
<configSections>
      <sectionGroup name="dotNetOpenAuth" type="DotNetOpenAuth.Configuration.DotNetOpenAuthSection, DotNetOpenAuth">
        <section name="openid" type="DotNetOpenAuth.Configuration.OpenIdElement, DotNetOpenAuth" requirePermission="false" allowLocation="true" />
        <section name="oauth" type="DotNetOpenAuth.Configuration.OAuthElement, DotNetOpenAuth" requirePermission="false" allowLocation="true" />
        <sectionGroup name="oauth2" type="DotNetOpenAuth.Configuration.OAuth2SectionGroup, DotNetOpenAuth">
          <section name="authorizationServer" type="DotNetOpenAuth.Configuration.OAuth2AuthorizationServerSection, DotNetOpenAuth" requirePermission="false" allowLocation="true" />
        </sectionGroup>
        <section name="messaging" type="DotNetOpenAuth.Configuration.MessagingElement, DotNetOpenAuth" requirePermission="false" allowLocation="true" />
        <section name="reporting" type="DotNetOpenAuth.Configuration.ReportingElement, DotNetOpenAuth" requirePermission="false" allowLocation="true" />
      </sectionGroup>    
  </configSections>
  <dotNetOpenAuth>
    <!-- Allow DotNetOpenAuth to publish usage statistics to library authors to improve the library. -->
    <reporting enabled="true" />
    <openid>
      <provider>
        <security requireSsl="false">
        </security>
      </provider>
    </openid>
    <oauth2>
      <authorizationServer >
      </authorizationServer>
    </oauth2>
    <!-- Relaxing SSL requirements is useful for simple samples, but NOT a good idea in production. -->
    <messaging relaxSslRequirements="true">
      <untrustedWebRequest>
        <whitelistHosts>
          <!-- since this is a sample, and will often be used with localhost -->
          <add name="localhost"/>
        </whitelistHosts>
      </untrustedWebRequest>
    </messaging>
  </dotNetOpenAuth> 
```

# c# - 覆盖另一个 Xml 文件中的值

> ID：14898977
> 
> 赞同：1
> 
> 时间：2013-02-15T16:26:33.447
> 
> 标签：c#, linq-to-xml

寻找一种合并到 XML 文件的方法，其中第二个文件中的修改属性应该覆盖第一个文件中对象的值。似乎这对于 linq to xml 应该是可行的，但在弄清楚如何做到这一点时遇到了一些麻烦。

以以下两个 XML 文件为例：

文件 1：

```
<root>
   <foo name="1">
     <val1>hello</val1>
     <val2>world</val2>
   </foo>
   <foo name="2">
     <val1>bye</val1>
   </foo>
</root> 
```

文件 2：

```
<root>
   <foo name="1">
     <val2>friend</val2>
   </foo>
</root> 
```

所需的最终结果是将文件 2 合并到文件 1 并最终得到

```
<root>
   <foo name="1">
     <val1>hello</val1>
     <val2>friend</val2>
   </foo>
   <foo name="2">
     <val1>bye</val1>
   </foo>
</root> 
```

子“foo”元素应由其“名称”值唯一标识，文件 2 中的任何设置值覆盖文件 1 中的值。

任何指向正确方向的指针将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T18:58:12.613

您可以只迭代和更新值-虽然不知道您希望它有多通用...

```
class Program
{
    const string file1 = @"<root><foo name=""1""><val1>hello</val1><val2>world</val2></foo><foo name=""2""><val1>bye</val1></foo></root>";

    const string file2 = @"<root><foo name=""1""><val2>friend</val2></foo></root>";

    static void Main(string[] args)
    {
        XDocument document1 = XDocument.Parse(file1);
        XDocument document2 = XDocument.Parse(file2);

        foreach (XElement foo in document2.Descendants("foo"))
        {
            foreach (XElement val in foo.Elements())
            {
                XElement elementToUpdate = (from fooElement in document1.Descendants("foo")
                                            from valElement in fooElement.Elements()
                                            where fooElement.Attribute("name").Value == foo.Attribute("name").Value &&
                                                 valElement.Name == val.Name
                                            select valElement).FirstOrDefault();

                if (elementToUpdate != null)
                    elementToUpdate.Value = val.Value;

            }
        }

        Console.WriteLine(document1.ToString());

        Console.ReadLine();

    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T19:36:14.997

您可以从这两个构建新的 xml：

```
XDocument xdoc1 = XDocument.Load("file1.xml");
XDocument xdoc2 = XDocument.Load("file2.xml");

XElement root =
    new XElement("root",
        from f in xdoc2.Descendants("foo").Concat(xdoc1.Descendants("foo"))
        group f by (int)f.Attribute("name") into foos
        select new XElement("foo",
            new XAttribute("name", foos.Key),
            foos.Elements().GroupBy(v => v.Name.LocalName)
                           .OrderBy(g => g.Key)
                           .Select(g => g.First())));

root.Save("file1.xml"); 
```

因此，首先选择第二个文件中的 foo 元素，它们将优先于第一个文件中的 foo 元素（当我们进行分组时）。

# php - 从对象访问对象

> ID：14898979
> 
> 赞同：0
> 
> 时间：2013-02-15T16:26:46.260
> 
> 标签：php, oop, object

我从 PHP 中的 OOP 开始，我想做一些事情。让我举个例子：

类.php

```
<?php
    class a {
        public function a() {
            echo 'a';
        }
    }

    class b {
        public function calla() {
            $x->a();
        }
    }
?> 
```

索引.php

```
<?php
    include('classes.php');
    $x = new a();
    $d = new b();
    $d->calla();
?> 
```

这可能吗？我知道我可以做类似的事情：

```
class b {
        public function calla($object) {
            $object->a();
        }
    } 
```

和

```
$d->calla($x); 
```

但是第一个例子可以吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T16:37:35.867

我想我理解您要问的问题，但是您将参数可见性概念与类方法中的对象传递混为一谈。所以，让我们清理...

在您的 classes.php 文件`calla()`中，类 b 的方法与类完全无关`a`，除非`$x`它本身是类的实例`a`。

在您的 index.php 文件中，您将其实例`$x`化为 class `a`，但它是一个全局变量，并且该类`b`对它没有可见性。此外，您的调用`$d->calla()`将返回错误，因为您正在从外部访问私有方法。

您的第三个示例更接近解决方案，将实例传递给`calla()`方法有助于类`b`查看 class 的实例`a`，我猜您想将 index.php 文件编辑为：

```
<?php
include('class.php');
$x = new a();
$d = new b();
$d->calla($x);
?> 
```

但这仍然行不通，直到您将私有方法更改为公共方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T16:40:28.700

所以你想`$x`用作全局变量吗？语法相同，对象与否：

```
class b {
    public function calla() {
        $GLOBALS['x']->a();
    }
} 
```

... 或者：

```
class b {
    public function calla() {
        global $x;
        $x->a();
    }
} 
```

当然，这是一个可怕的设计，它注入了难以跟踪的依赖项，并且可能会导致意想不到的副作用和令人头疼的问题。

此外，`a()`对于类来说，它是一个糟糕的方法名称，`a`因为它是构造函数的 PHP 4 语法。如果您运行此代码：

```
<?php

class a {
    public function a() {
        echo 'a';
    }
}

class b {
    public function calla() {
        $GLOBALS['x']->a();
    }
}

$x = new a();
$d = new b();
$d->calla(); 
```

...你会看到它`a()`运行了两次。猜猜为什么？

# c# - 如果在后台线程上运行，控件不显示（c#winform）

> ID：14898986
> 
> 赞同：0
> 
> 时间：2013-02-15T16:27:14.223
> 
> 标签：c#, multithreading, winforms

我有一个带有多个控件的表单（代码中的**complexForm**），需要一些时间来加载。所以我决定放入一个单独的线程以减少初始加载时间。除了等待表单上的标签控件（代码中的**Form1**）最初没有显示外，一切正常；就在 Form1 关闭前一秒钟。所以我的问题是，为什么标签控件不显示？

```
[STAThread]
static void Main()
{
    Thread thread = new Thread(delegate()
    {
        var wait = new Form1(); //simple form with a label control with text "please wait"
        wait.Show();
        var complexUI = new complexForm();// this takes long time to load
        wait.Dispose();// it will go off even without this method
        // MessageBox.Show("loaded");
    });

    thread.SetApartmentState(ApartmentState.STA);
    thread.Priority = ThreadPriority.Highest;
    thread.IsBackground = true;
    thread.Start();
    Application.EnableVisualStyles();
    Application.SetCompatibleTextRenderingDefault(false);
    Application.Run(new main());

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T16:37:49.453

不要这样做。会以泪水收场。仅从 UI 线程创建 UI 控件 - 这是拥有消息泵的线程，这对于正确操作至关重要。

正确的解决方案是创建一个启动画面，它会在您的主窗口初始化时显示。

Stack Overflow 上有很多关于如何创建启动画面的主题。

# mysql - 通过内部选择的结果过滤 MySQL 结果集

> ID：14898987
> 
> 赞同：0
> 
> 时间：2013-02-15T16:27:18.720
> 
> 标签：mysql, sql, select, join

我有一个 MySQL 语句，它执行内部`SELECT`并将结果作为伪列返回。我想在我的`WHERE`子句中使用这个伪列的结果。我当前的 SQL 语句如下所示：

```
SELECT
    product.product_id,
    product.range_id,
    product.title,
    product.image,
    product.image_text,
    product.friendly_url,
    attribute.comfort_grade_id,
    category.category_id,
    category.category AS category_name,
    category.friendly_url AS category_friendly_url,
    (SELECT price_now FROM product_bedding_sizes AS size
        WHERE size.product_id = product.product_id
        ORDER BY size.price_now ASC LIMIT 1) AS price
FROM
    products AS product
LEFT JOIN
    categories AS category ON product.category_id = category.category_id
LEFT JOIN
    product_bedding_attributes AS attribute
         ON product.product_id = attribute.product_id
$where
$order
LIMIT
    ?,? 
```

但是，我在运行查询时收到以下错误消息：

> #1054 - 'where 子句'中的未知列 'price'

我怎样才能解决这个问题并实际使用`price`我的`WHERE`子句中的值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T16:31:24.913

该`WHERE`子句在该子句之前进行评估`SELECT`，因此它不会说出别名。您必须`WHERE`在外部查询中按子句进行过滤，如下所示：

```
SELECT *
FROM
(
    SELECT
        product.product_id,
        product.range_id,
        product.title,
        product.image,
        product.image_text,
        product.friendly_url,
        attribute.comfort_grade_id,
        category.category_id,
        category.category AS category_name,
        category.friendly_url AS category_friendly_url,
        (SELECT price_now 
         FROM product_bedding_sizes AS size 
         WHERE size.product_id = product.product_id 
         ORDER BY size.price_now ASC 
         LIMIT 1) AS price
    FROM
     ...
) AS sub
WHERE price = ... <--- here it can see the price alias. 
```

有关更多详细信息，请参见：

*   [**我的 SQL 查询操作顺序**](http://www.bennadel.com/blog/70-SQL-Query-Order-of-Operations.htm)。

* * *

**或者：**您可以加入该表，而不是像这样的相关子查询：

```
SELECT
    product.product_id,
    product.range_id,
    product.title,
    product.image,
    product.image_text,
    product.friendly_url,
    attribute.comfort_grade_id,
    category.category_id,
    category.category AS category_name,
    category.friendly_url AS category_friendly_url,
    size.price_now 
FROM
    products AS product
LEFT JOIN
(
   SELECT product_id, MIN(price_now) AS price
   FROM product_bedding_sizes
   GROUP BY product_id
) AS size ON size.product_id = product.product_id
LEFT JOIN
    categories AS category ON product.category_id = category.category_id
LEFT JOIN
    product_bedding_attributes AS attribute ON product.product_id = attribute.product_id
$where price = ----; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T12:19:38.730

如果你有

```
 WHERE price > 0 AND price` <= 199` 
```

在你的 where 子句中

然后尝试使用 HAVING 子句执行此操作

像那样

```
 $HAVING
      //-- where $having  = HAVING price > 0 AND price <= 199 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T18:39:40.020

尝试使用变量：

```
@price:= (SELECT price_now 
          FROM product_bedding_sizes AS size 
          WHERE size.product_id = product.product_id 
          ORDER BY size.price_now ASC LIMIT 1) AS price; 
```

然后将其引用为

```
WHERE @price > 9000; 
```

# xslt - 在 if 语句中从出生日期获取年龄

> ID：14898988
> 
> 赞同：1
> 
> 时间：2013-02-15T16:27:20.457
> 
> 标签：xslt, xslt-1.0

我正在获取`YYYY-MM-DD`格式的 DOB。

我必须计算年龄，如果年龄大于 18，那么我必须通过名字。

如何在 XSLT 中执行此操作

喜欢

```
 <xsl:if test="age>18">
      <xsl:element name="first_nam" ">
   <xsl:value-of select="FirstName_TEXT/text()"/>
      </xsl:element>
    </xsl:if> 
```

这里面怎么算年龄。这个camparison > 18会起作用吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T16:47:40.243

我不知道你将如何在 1.0 中做到这一点，但如果你有机会使用 2.0，这很容易：

**XML 输入**

```
<person>
    <dob>1980-05-22</dob>
    <FirstName_TEXT>Pac</FirstName_TEXT>
</person> 
```

**XSLT 2.0**

```
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" exclude-result-prefixes="xs" xmlns:xs="http://www.w3.org/2001/XMLSchema">
    <xsl:output indent="yes"/>
    <xsl:strip-space elements="*"/>

    <xsl:template match="/person">
        <xsl:variable name="age" select="floor(days-from-duration(current-date() - xs:date(dob)) div 365)"/>
        <xsl:if test="$age > 18">
            <first_nam>
                <xsl:value-of select="FirstName_TEXT"/>
            </first_nam>
        </xsl:if>
    </xsl:template>

</xsl:stylesheet> 
```

**结果**

```
<first_nam>Pac</first_nam> 
```

# ios - IOS 如何异步下载和缓存图像和视频以在我的应用程序中使用

> ID：14898994
> 
> 赞同：15
> 
> 时间：2013-02-15T16:27:41.160
> 
> 标签：ios, caching, video, asynchronous, download

我有一个同时显示图像和视频的 iphone 应用程序。该应用程序的大部分图像和视频的结构方式将保持不变，偶尔会添加一个。我想对异步下载和缓存图像和视频的最佳和最简单的方法提出意见，以便即使在应用程序退出后它们也会持续存在。另外，我只关心 IOS 5 及更高版本。

这是我迄今为止找到的一些信息，但我仍然不清楚最好的方法是什么，以及缓存是否会持久化。

[这篇](http://davidgolightly.blogspot.com/2009/02/asynchronous-image-caching-with-iphone.html)关于异步图像缓存的文章（旧 2009）

[这篇](http://petersteinberger.com/blog/2012/nsurlcache-uses-a-disk-cache-as-of-ios5/)关于 NSURLCache 的文章

[SDWebImage](https://github.com/rs/SDWebImage)（看起来不错，但仅适用于图像）

[AFDownloadRequestOperation](https://github.com/steipete/AFDownloadRequestOperation)

这似乎是一个非常常见的用例，所以我真的在寻找最佳实践和/或对示例代码的引用。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-02-19T16:02:24.973

下载和缓存非常简单。以下代码将异步下载和缓存。

```
NSCache *memoryCache; //assume there is a memoryCache for images or videos

dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_BACKGROUND, 0), ^{

    NSString *urlString = @"http://URL";

    NSData *downloadedData = [NSData dataWithContentsOfURL:[NSURL URLWithString:urlString]];

    if (downloadedData) {

        // STORE IN FILESYSTEM
        NSString* cachesDirectory = [NSSearchPathForDirectoriesInDomains(NSCachesDirectory, NSUserDomainMask, YES) objectAtIndex:0];
        NSString *file = [cachesDirectory stringByAppendingPathComponent:urlString];
        [downloadedData writeToFile:file atomically:YES];

        // STORE IN MEMORY
        [memoryCache setObject:downloadedData forKey:urlString];
    }

    // NOW YOU CAN CREATE AN AVASSET OR UIIMAGE FROM THE FILE OR DATA
}); 
```

现在 UIImages 有一些特殊的东西使得像 SDWebImage 这样的库如此有价值，即使异步下载图像非常容易。显示图像时，iOS 使用惰性图像解压缩方案，因此存在延迟。如果您将这些图像放入 tableView 单元格，这将变成锯齿状滚动。正确的解决方案是在后台进行图像解压（或解码），然后在主线程中显示解压后的图像。

要了解有关惰性图像解压缩的更多信息，请参阅： http: [//www.cocoanetics.com/2011/10/avoiding-image-decompression-sickness/](http://www.cocoanetics.com/2011/10/avoiding-image-decompression-sickness/)

我的建议是为您的图像使用 SDWebImage，为您的视频使用上面的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-07T07:32:32.917

> ## 强大的 iOS 图像缓存组件必须：
> 
> *   异步下载图片，尽量少用主队列
> *   解压缩背景队列上的图像。这远非微不足道。看一篇关于[后台解压的强文](http://www.cocoanetics.com/2011/10/avoiding-image-decompression-sickness/)
> *   将图像缓存到内存和磁盘上。在磁盘上缓存很重要，因为应用程序可能会因内存不足而关闭或需要清除内存。在这种情况下，从磁盘重新加载图像比下载图像要快得多。注意：如果您使用 NSCache 作为内存缓存，当发出内存警告时，此类将清除其所有内容。此处有关 NSCache 的详细信息 [http://nshipster.com/nscache/](http://nshipster.com/nscache/)
> *   store the decompressed image on disk and in memory to avoid redoing the decompression
> *   use GCD and blocks. This makes the code more performant, easier to read and write. In nowadays, GCD and blocks is a must for async operations
> *   nice to have: category over UIImageView for trivial integration. nice to have: ability to process the image after download and before storing it into the cache.
> 
> **ADVANCED IMAGING ON IOS**
> 
> * * *
> 
> To find out more about imaging on iOS, how the SDK frameworks work (CoreGraphics, Image IO, CoreAnimation, CoreImage), CPU vs GPU and more, go through this [great article by @rsebbe](http://www.slideshare.net/rsebbe/2014-cocoaheads-advimaging).

Source: [https://bpoplauschi.wordpress.com/2014/03/21/ios-image-caching-sdwebimage-vs-fastimage/](https://bpoplauschi.wordpress.com/2014/03/21/ios-image-caching-sdwebimage-vs-fastimage/)

# android - 使用下一个/上一个按钮逐一显示记录

> ID：14898996
> 
> 赞同：0
> 
> 时间：2013-02-15T16:27:45.233
> 
> 标签：android, android-widget, android-listview, android-button

我使用 Hash Map 显示 10 条记录，如下所示：

```
 for (int i = 0; i < jArray.length(); i++) {
                JSONObject c = jArray.getJSONObject(i);

            //  Item objItem = new Item();

                u_Id = jArray.getJSONObject(i).getString(TAG_ID);
                u_name = jArray.getJSONObject(i).getString(TAG_NAME);
                u_refer = jArray.getJSONObject(i).getString(TAG_Image);
                u_image = jArray.getJSONObject(i).getString(TAG_refere);
                u_des = jArray.getJSONObject(i).getString(TAG_des);

                HashMap<String, String> map = new HashMap<String, String>();

                map.put(TAG_ID, u_Id);
                map.put(TAG_NAME, u_name);
                map.put(TAG_refere, u_refer);
                List.add(map);

                Log.v(TAG_ID, u_Id);
                Log.v(TAG_NAME,u_name);
                Log.v(TAG_refere, u_refer);
                Log.v(TAG_Image,u_image);
                Log.v(TAG_des, u_des);

             ListAdapter adapter = new SimpleAdapter(this, List,
             R.layout.row,new String[] { TAG_ID, TAG_NAME }, new int[] {R.id.textView1, R.id.textView2 });
             listView.setAdapter(adapter);
           //  View header = (View)getLayoutInflater().inflate(R.layout.todo_row, null);
           //  listView.addHeaderView(header);

            } 
```

现在我想在下一个和上一个按钮上一个接一个地显示记录，上一个按钮应该显示上一个记录，下一个按钮应该显示下一个记录。请任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T18:02:10.773

我通过这样做实现了我的目标：

```
 int position =0 ;

@Override
        public void onClick(View button) {
            if (button == nxt) {
                if(position < List.size() - 1){
                    position++;
                    List.get(position);
                    String name = List.get(position).get(TAG_NAME);
                    String Des = List.get(position).get(TAG_des);
                    String aa = String.valueOf(position);
                 //  Log.v("tag",name);
                 //   Log.v("tag", Des);
                   System.out.println( name+Des);
                }
                else
                  Log.d("TAG","Last Record");
            } else if (button == pre) {
                if(position > 0){
                   position--;        
                  List.get(position);
                  String aa = String.valueOf(position);
                 Log.i("tag", aa);
               // System.out.print(position);
              //  (position);
              }
              else
                Log.d("TAG","First Record"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-06-24T09:27:47.180

> 将您的字符串数组和位置值发送到下一个活动

```
list.setOnItemClickListener(new OnItemClickListener() {
          public void onItemClick(AdapterView<?> parent, View view,
              int position, long id) {
              Intent i = new Intent(listview.this, Single_SMS.class);
              // sending data to new activity
              i.putExtra("position", position);
              i.putExtra("strings", web);
              startActivity(i);

          }
        }); 
```

> 在下一个活动中检索字符串数组和位置。

```
public class NextActivity extends Activity {
int position;
String[] web;
int size;

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
     setContentView(R.layout.single_sms);

    Bundle bd = getIntent().getExtras();

    if (bd != null) {
        position = bd.getInt("position", 0);
        web = bd.getStringArray("strings");
        size = web.length;
        Button txtProduct = (Button) findViewById(R.id.button1);
        txtProduct.setText(" " + web[position]);
    }

    btn_next.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            position = position + 1;
            if (position > size) {
                Button txtProduct = (Button) findViewById(R.id.button1);
                txtProduct.setText(" " + web[position]);
            }

        }
    });

}} 
```

# c# - 将 serialport.readline() 非 ascii 字符串转换为字节数组

> ID：14898997
> 
> 赞同：0
> 
> 时间：2013-02-15T16:27:50.607
> 
> 标签：c#, string, encoding, serial-port

我想使用**serialport.readline()**因为它是一个阻塞调用，我得到的数据最后有 0x0D 0x0A (CR LF)。但是，我想要的是一个十六进制字符串而不是一个 Ascii 表示。

例如，我与之通信的设备正在发送像 {0xff,0xff,0x45,0x0D,0x0A} 这样的字节数组。我想在我的程序中简单地打印出来，就像这样：0xff，0xff，0x45。Readline() 会删除 LF 和 CR。

我想通过指定我想读取多少字节来使用**serialport.read(buff[]...) 。**但它并没有很好地工作，因为如果我读得太快，一半的数组将是 0x00，如果我读得太慢，com 端口就会溢出。我不想丢失任何字节。

我试图将从**serialport.readline()**得到的内容转换为字节数组，但我得到的十六进制字符串通常变成**0x3f**。代码是这样的：

```
var line = string.Join(",", mySerialPort.ReadLine().Select(c => ((Byte)c).ToString("X")).ToArray()); 
```

我改变了几次编码（ASCII，UTF8，UNICODE），但还是不行。

有什么方法可以将我从**readline()获得的****非 Ascii**字符串转换为字节数组？

 *** * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-15T16:29:37.940

听起来您根本不应该将其作为*文本*数据来阅读。

你从根本上处理二进制数据，所以使用它的重载[`Read`](http://msdn.microsoft.com/en-us/library/ms143549.aspx)需要一个*字节*数组而不是一个*字符*数组。（或`ReadByte`反复调用。）

每当您尝试将任意二进制数据视为文本时，您都会遇到糟糕的体验。

听起来你已经尝试过了，但做得很糟糕：

> 但它并没有很好地工作，因为如果我读得太快，一半的数组将是 0x00

这表明您忽略了 的返回值`Read`，它表示实际读取了多少字节。你应该有类似的东西：

```
int bytesRead = port.Read(buffer, 0, buffer.Length);
// Now use the portion of buffer which is from 0 (inclusive) to
// bytesRead (exclusive). 
```**

# javascript - ruby vs javascript中的按位或

> ID：14898998
> 
> 赞同：3
> 
> 时间：2013-02-15T16:27:51.420
> 
> 标签：javascript, ruby, bitwise-operators

尝试将 UID 生成器从 Javascript 转换为 Ruby，我想了解以下行为。

这行代码

```
89190868196442450 | 0 
```

会用 javascript

```
1074708816 
```

在红宝石中

```
89190868196442450 
```

我完全理解 ruby​​ 行为，因为如果它存在于 hether 操作数中，则按位 OR 运算符会复制一点，但我仍然对 javascript 行为感到困惑。我更深入地研究了 javascript 整数表示，但找不到明确的解释。我[找到了这个](https://stackoverflow.com/questions/1003879/understanding-bitwise-operations-in-javascript)，但没有完全明白。

二进制的 89190868196442450 是 100111100110111101001111101000000000011101100000101010010 ，这使其长度为 57 位。

谁能给我一个明确的解释或上述结果。我应该对 ruby​​ 代码进行什么操作以确保类似的行为？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T16:30:33.250

如果您想用 32 位以上的数字表示数字并在 Javascript 中对它们执行按位运算，最好使用模拟长整数，例如：[http://closure-library.googlecode.com/svn/docs/class_goog_math_Long。 .html](http://closure-library.googlecode.com/svn/docs/class_goog_math_Long.html) _

看看这个条目。从技术上讲，Javascript 可以表示 2^53 个整数，但按位运算限制为 32 位。

[一个数字可以在不损失精度的情况下达到 JavaScript 的最高整数值是多少？](https://stackoverflow.com/questions/307179/what-is-javascripts-max-int-whats-the-highest-integer-value-a-number-can-go-t)

详细说明，当您执行 89190868196442450 | 时 JS 中发生了什么 0 是 Javascript 采用*最低有效*的32 位并将它们与 0 进行 ORing，得到 1074708816，而在 Ruby 中，它与所有位进行 ORing。如果出于某种原因你想在 Ruby 中重现它，你可以将你的数字与 1FFFFFFFF 相加，这样你就只在最低有效的 32 位上进行操作，然后将其与 0 相或（除了会给你相同的结果之外什么都不做）。

# ruby-on-rails-3 - Rspec 控制器错误：没有路由匹配 {:controller=>"bookings", :action=>"/dashboard/index"}

> ID：14898999
> 
> 赞同：2
> 
> 时间：2013-02-15T16:27:56.927
> 
> 标签：ruby-on-rails-3, rspec, controller

当我尝试测试 mi 控制器时出现错误，我是 rspec 测试的新手，也许有些东西我不明白。

$rspec 规范/控制器/booking_controller_spec.rb

我收到以下错误：

没有路线匹配 {:controller=>"bookings", :action=>"/dashboard/index"}

我不明白为什么？所以如果能帮助我，我真的很感激一些帮助。

文件结构：

```
app/models/booking.rb
app/models/user.rb
app/models/role.rb
app/models/ability.rb   

app/controllers/bookings_controller.rb

app/views/bookings/index.html.erb
app/views/dashboard/index.html.erb

app/spec/controllers/bookings_controller_spec.rb 
```

我的失败规格：

```
describe BookingsController do
    context 'as guest' do
    before(:each) do
        @user = User.new(:email => 'mail_admin@test.com',
                    :username => 'admin',
                    :password => 'password_admin',
                    :password_confirmation => 'password_admin')
        @user.save
        #when i save, with gem CanCan i assign a default role to @user
        #with the default role the user only can see the views/dashboard/index.html.erb
    end

    it 'should not render index template from bookings' do
        get :index
        response.should_not render_template(:index)
    end

    it 'should render index template from dashboard' do
        get '/dashboard/index'
        response.should render_template('index')
    end
end 
end 
```

控制器：

```
class BookingsController < ApplicationController
load_and_authorize_resource

   def index
    ...      
   end

   def show
    ...
   end
end 
```

我的模型：

```
class Booking < Activerecord::Base
paginates_per 20

   def 
    ...      
   end

   def 
    ...
   end
end 
```

用户：

```
Class User < ActiveRecord::Base
  after_save :set_default_role
  rolify
  .
  .
  .
  .
  def set_default_role
    self.add_role :default
  end
end 
```

角色：

```
class Role < ActiveRecord::Base
  ROLES = {"admin" => "Admin", "default" => "Default"}
  .
  .
  .
  . 
  scopify
end 
```

能力：

```
class Ability
  include CanCan::Ability

  def initialize(user)
    user ||= User.new
    if user.has_role? :admin
      can :manage, :all
    elsif user.has_role? :data_consistency
      can :read, Booking
    end
  end
end 
```