# StackOverflow 问答 14063000-14063999

# orchardcms - 果园替代形状模板不显示值

> ID：14063001
> 
> 赞同：1
> 
> 时间：2012-12-28T00:13:37.453
> 
> 标签：orchardcms

我是 Orchard 的新手，看过 Pluralsight“Orchard Fundamentals”和“Advanced Orchard”教程。它是一个很棒的平台，但我很难理解一些事情。

我想在主页上创建一个博客展示横幅，仅用于轮换网站上的博客文章。我将 HTML 切片并在 HTML 模板上运行。横幅如下所示：

[http://arerra.com/news-slideshow.jpg](http://arerra.com/news-slideshow.jpg)

到目前为止，我已经完成了以下工作：

1.  我创建了一个名为“文章”的博客，并在其中放置了一个帖子进行测试。

2.  添加了一个名为“ArticleList”的图层，其中我为“最近的博客文章”放置了一个小部件

3.  我在我的主题中为主页创建了一个名为“Layout-Url-HomePage.cshtml”的自定义布局。

4.  在我的主题“视图”文件夹中，我创建了一个名为“Widget.Wrapper.cshtml”的文件，其中仅`@Display(Model.Child)`用于删除`<article><header/><footer /><article>`标签。

5.  在“Views > Parts > Blogs.RecentBlogPosts.cshtml”中添加了一个文件来控制我的形状的布局。代码如下：

    ```
    @using Orchard.ContentManagement;
    @{
        IEnumerable<object> blogPosts = Model.ContentItems.ContentItems;
    }

    @if (blogPosts != null) {
    <div class="container news-slider">
        <ul class="slide-images">
            @foreach (dynamic post in blogPosts) {
                 string title = post.Title;
                 ContentItem item = post.ContentItem;

                 <img src="/Themes/MountainWestHoops/Content/img/placeholder-700x380.jpg" alt="@title" class="active" />
            }
        </ul>

        @foreach (dynamic post in blogPosts) {
            string title = post.Title;
            string body = post.Body;
            ContentItem item = post.ContentItem;

            <div class="featured-story threeD active">
                <h1>@title</h1>
                <p>@body @Html.ItemDisplayLink("READ MORE", item)</p>
            </div>
        }

        <aside>
            <ul class="tabs">
                @foreach (dynamic post in blogPosts) {
                    string title = post.Title;
                    string url = post.Url;
                    ContentItem item = post.ContentItem;

                    <li><a href="@url"><h3>@title</h3></a></li>
                }
            </ul>

            <div class="ad-three-day-trial">
                <a href=""><img src="/Themes/Content/img/placeholder-260x190.gif" /></a>
            </div>
        </aside>
    </div>
    } 
    ```

6.  我的 HTML 正在正确呈现，但我指定的值都没有显示出来。

7.  我正在使用“Shape Tracer”模块来查看正在使用的模板。有趣的是，@Html.ItemDisplayLink("READ MORE", item) 正在呈现文章的 URL，如果我将“READ MORE”替换为字符串标题，标题会正确呈现。

我在这里做错了什么导致字符串不显示？我是否遗漏了一个更大的观点并误解了基本面？教程似乎说你可以简单地移动部件，但在这种情况下，我需要有非常具体的标记才能让这个滑块工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T02:42:16.630

好像您的来源是[http://weblogs.asp.net/bleroy/archive/2011/03/27/taking-over-list-rendering-in-orchard.aspx](http://weblogs.asp.net/bleroy/archive/2011/03/27/taking-over-list-rendering-in-orchard.aspx)

那是一个相当古老的帖子，从那时起标题的处理方式发生了变化。

DisplayLink 之所以有效，是因为这里唯一正确的属性是`post.ContentItem`，这就是 API 所采用的。另一方面，很可能是空的，这就是为什么你什么也看不到的原因`post.Title`。`post.Body`要访问标题，您可以使用`post.ContentItem.TitlePart.Title`和 来获取正文，`post.ContentItem.BodyPart.Text`.

# android - Google 云端硬盘 + ACTION_GET_CONTENT

> ID：14063003
> 
> 赞同：7
> 
> 时间：2012-12-28T00:13:57.440
> 
> 标签：android, android-intent, google-drive-api

Google Drive 似乎有一个响应 GET_CONTENT 操作的活动，但它没有被导出。

我是否可以在我的应用中使用另一种方法从云端硬盘中提取内容，而无需*从*云端硬盘启动流程？自己编写选择器/选择器活动并使用后端 API 列出和打开文件显然是一种选择，但我更愿意使用 Drive 自己的 UI 来做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-11-18T17:11:59.543

Google Drive 只有一个支持`GET_CONTENT`API 19 之前的设备的活动。根据[存储访问框架指南](https://developer.android.com/guide/topics/providers/document-provider.html#custom)，`GET_CONTENT`必须在 API 19+ 设备上禁用该活动，以防止与[DocumentsProvider](https://developer.android.com/reference/android/provider/DocumentsProvider.html)重复。

存储访问框架的全部意义在于它提供了一个单一的 UI（当您使用 、 或 Intent 时启动`startActivity`）`GET_CONTENT`，`OPEN_DOCUMENT`允许`OPEN_DOCUMENT_TREE`用户从**任何**来源进行选择，包括本地存储、Google Drive 或任何其他应用程序。然后，您的应用可以使用完全相同的代码访问选定的文件。

没有任何功能可以让您指定只显示一个根目录（例如 Google Drive）。用户将始终能够从任何可用的根目录中进行选择。

# bitbucket-server - 使用 Stash Rest API 获取原始文件内容

> ID：14063008
> 
> 赞同：13
> 
> 时间：2012-12-28T00:14:25.547
> 
> 标签：bitbucket-server, bitbucket-api

我可以使用 Bitbucket REST API 获取原始文件内容，如

[https://api.bitbucket.org/1.0/repositories/AccountName/Repo_Slug/raw/master/MyFolder/MyFile.cs](https://api.bitbucket.org/1.0/repositories/AccountName/Repo_Slug/raw/master/MyFolder/MyFile.cs)，

是否有等效的方法可以使用 Stash Rest API 从 Stash 获取它。我在这里找不到它： [https ://developer.atlassian.com/static/rest/stash/2.0.1/stash-rest.html#resources](https://developer.atlassian.com/static/rest/stash/2.0.1/stash-rest.html#resources)

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-28T01:01:10.393

只需指定文件的 URL 并附加`?raw`

`http://example.com/projects/TES/repos/testrepo/browse/testfile?raw`

正如我所提到的，这不是任何一个 REST API 的功能，它只是文件的完整 URL。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-03-11T20:19:34.637

使用 1.0 的 stash/bitbucket api，您可以使用以下内容获取原始文件内容

```
 https://example.com/rest/api/1.0/TES/repos/testrepo/raw/testfile?at=feature/branch 
```

# javascript - 浏览器关闭时检测刷新浏览器以进行卸载/卸载前

> ID：14063012
> 
> 赞同：2
> 
> 时间：2012-12-28T00:14:56.050
> 
> 标签：javascript

这实际上是我上一个[问题](https://stackoverflow.com/questions/13783659/logout-when-window-closed-using-javascript)的延续。我仍然面临问题，因为当我刷新浏览器时，unload 或 beforeunload 也会触发，我只在浏览器关闭时才想要它们。只是想到使用 window.outerHeight 或 window.innerHeight 但仍然无法弄清楚如何做到这一点。有什么建议/片段吗？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T00:47:13.140

据我所知，无法从浏览器刷新中单独检测到浏览器关闭，因为浏览器不向网页（窗口）提供该信息。就您的页面及其 Javascript 代码而言，两者是一回事。

由于它是您需要的浏览器信息，因此获取它的唯一方法是使用可以访问该信息的东西，即。一个浏览器插件。但是你需要为每个浏览器制作一个插件，并让每个用户都安装它。由于我非常怀疑您会发现这是否值得，因此您的问题的真正答案（尽管可能令人沮丧）是：停止尝试检测刷新与关闭并继续前进。

# ios - ivar 中来自 AVAudioPlayer 的内存未重用

> ID：14063018
> 
> 赞同：4
> 
> 时间：2012-12-28T00:16:17.627
> 
> 标签：ios, memory-management, avaudioplayer

我设置了一个实例变量来引用我用来在不同时间播放不同音频数据的 AVAudioPlayer。我的头文件包含：

```
AVAudioPlayer *player; 
```

和

```
@property (nonatomic, retain) AVAudioPlayer *player; 
```

我的实现文件包含：

```
- (void)playAudioData:(NSData *)data {
    NSMutableData *trimmedData = [NSMutableData dataWithData:data];
    int duration = 2; // seconds
    int dataLength = duration * 2 * 44100; // assumes 16-bit mono data
    [trimmedData setLength:dataLength];

    NSError *playerError;
    self.player = [[AVAudioPlayer alloc] initWithData:trimmedData error:&playerError];
    [self.player autorelease]; // ADDED
    if (playerError) {
        NSLog(@"player error: %@", playerError);
    }
    [self.player play];
    if (([[[UIDevice currentDevice] systemVersion] compare:@"6.0"] != NSOrderedAscending)&&([[[UIDevice currentDevice] systemVersion] compare:@"6.1"] == NSOrderedAscending)) {
        [trimmedData autorelease]; // ADDED
    }
}

- (void)dealloc {
    [self.player release];
} 
```

在分析我的应用程序的内存使用情况时，我注意到调用此方法会将实时字节增加 500k，这大约是我正在播放的音频数据的大小。但是，如果我再次调用该方法，则每次调用该方法时，活动字节都会再增加 500k 和另一个。

根据[这个 SO answer](https://stackoverflow.com/a/7087530/462162)，我不应该在这里做任何不同的事情，因为设置 self.player 变量会减少现有值的保留计数。但我也尝试在给它一个新值之前释放 self.player 并将其设置为 nil ，如[this answer](https://stackoverflow.com/a/5932944/462162)所示，并在设置后自动释放 self.player ，如[this answer所示](https://stackoverflow.com/a/1766022/462162)所示。（我没有收到初始化播放器的错误，就像最后一个答案中的问题一样。）在所有这些情况下，我的内存使用量一直在上升，并且再也不会下降。

我还需要做些什么来重用每次初始化音频播放器时分配的内存吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T00:47:09.400

在切换到 [ARC] 之前，我的应用程序遇到了同样的问题`Automatic Reference Counting`，内存使用量会增加，直到应用程序崩溃，对吧？解决此问题的最快方法是在您的应用程序/项目中也使用 ARC，实际上它会在需要时完成管理内存和释放的所有工作[如果您使用 ARC，您的代码中`AVAudioPlayer`不需要任何内容​​] `-void(dealloc)`，所以没有更多的泄漏:-)。如果您不知道 ARC 是什么，您也可以查看此链接：

[http://www.raywenderlich.com/5677/beginning-arc-in-ios-5-part-1](http://www.raywenderlich.com/5677/beginning-arc-in-ios-5-part-1)

**标题：**

```
#import <UIKit/UIKit.h>
#import <AVFoundation/AVAudioPlayer.h>

@interface YourViewController : UIViewController <AVAudioPlayerDelegate>
{
    AVAudioPlayer           *player;

    /* Your other code here */
}

/* Your other code here */

@end 
```

**主要的：**

```
#import "YourViewController.h"

@implementation YourViewController

/* Your other code here */

- (void)playAudioData:(NSData *)data
{
    NSError *playerError;
    self.player = [[AVAudioPlayer alloc] initWithData:data error:&playerError]; error:NULL];

    if (playerError)
    {
        NSLog(@"player error: %@", playerError);
    }

    [self.player play];

    /* No more need to release AVAudioPlayer, ARC will do the job */

}

/* Your other code here */

@end 
```

# python - 如何根据表格中的数据在 Django 表单上显示项目？

> ID：14063023
> 
> 赞同：1
> 
> 时间：2012-12-28T00:16:42.520
> 
> 标签：python, django, django-models, django-forms

我试图弄清楚如何根据表格中的数据显示表格。我基本上想使用一个表中的数据作为标签来输入进入另一个表的数据。

我有两张餐桌：

```
class FoodType(models.Model):
  name = models.CharField(max_length=200)

class Food(models.Model):
  foodtype = models.ForeignKey(FoodType)
  tracktemp = models.BooleanField(verbose_name="Track Temperature?") 
```

和这样的临时表：

```
class Temp(models.Model):
  date = models.DateField('Entry Date')
  time = models.TimeField('Entry Time')
  food = models.ForeignKey(Food)
  temp = models.IntegerField(max_length=4, blank=True, null=True) 
```

我的`Food`桌子上有两种食物（豆类、豆芽），每种食物`tracktemp`都准备`True`好了。

在 Temp 表中，我希望能够添加多个记录，每个记录在特定时间都有一个 temp。例如：

```
Beans  1st Dec 2012 6.00pm     230
Beans  1st Dec 2012 6.04pm     235
Beans  1st Dec 2012 6.10pm     240 
```

为此，我希望能够呈现这样的表单来输入临时值：

```
Beans   [    ]
Sprouts [    ]
[save] 
```

关于上述表格的一些说明：

*   食物名称应该是标签，而不是组合框。
*   我不会显示日期/时间字段，只是以编程方式设置它们。

因此，我需要在 Food 表中找到所有`tracktemp`设置为“True”的项目，并使用它向用户呈现一个表单，以便用户可以为那个时间添加一个临时工。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T14:32:58.073

棘手的部分基本上是将 呈现为`Temp.food`除了选择小部件（这是 ForeignKey 关系的默认值）之外的其他东西。

为此，您必须对`Select`小部件进行子类化并覆盖该`render`方法以仅输出带有所选值的标签

```
from django.forms.widgets import Select

class MyLabelSelect(Select):
    def render(self, name, value, attrs=None, choices=()):
        # read the django.forms.widgets.Select.render() source to 
        # understand what you have to do here. Not that hard.
        pass 
```

这里确实需要一个表单集，但需要注意的是：您需要向它传递一个稍微自定义的表单，该表单将您的新小部件用于 FK 关系。

```
from django import forms
from .widgets import MyLabelSelect
from .models import Temp

class TempForm(forms.ModelForm):
    class Meta:
        model = Temp
        exclude = ('date', 'time')
        widgets = {
            'food': MyLabelSelect
        } 
```

好的，现在我们需要构建实际的表单集

```
from django.forms.models import modelformset_factory
from .forms import TempForm
from .models import Temp

def my_view(request):
    TempFormset = modelformset_factory(
        Temp,
        form = TempForm,
        max_num = Temp.objects.count()
    )

    if request.method == 'POST' and request.POST:
        # I'll just demonstrate the GET request
        pass
    else:
        # Grab the Temp objects we want
        temps = Temp.objects.filter(food__tracktemp=True)
        temp_formset = TempFormset(
            queryset=temps 
        )
    return render_to_response(....) 
```

还没有实际测试过上面的代码，但是这些代码就是你所追求的。如果我有任何明显的错误，请告诉我，我会纠正它们。

# python - 子进程检查输出错误

> ID：14063027
> 
> 赞同：5
> 
> 时间：2012-12-28T00:17:37.490
> 
> 标签：python, subprocess

我正在尝试使用下面的脚本检查 check_output 的使用情况并遇到编译错误，我哪里出错了？

```
import os
import subprocess
from subprocess import check_output

#result = subprocess.check_output(['your_program.exe', 'arg1', 'arg2'])
SCRIPT_ROOT=subprocess.check_output(["pwd","shell=True"])
print SCRIPT_ROOT

def main ():
    pass

if __name__ == '__main__':
    main()

Traceback (most recent call last):
  File "test.py", line 3, in <module>
    from subprocess import check_output
ImportError: cannot import name check_output 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-28T00:19:55.557

`check_output`已在 Python 2.7 中引入。如果您使用的是较早版本的 python，则它不存在。

另一种方法是使用`Popen`.

```
output = subprocess.Popen(['pwd'], stdout=subprocess.PIPE).communicate()[0] 
```

可以在[这里](http://docs.python.org/2.7/whatsnew/2.7.html)找到证明。

> 新功能：子进程模块的 check_output() 运行带有指定参数集的命令，并在命令运行无误时将命令的输出作为字符串返回，否则引发 CalledProcessError 异常。

替代品演示。

```
import subprocess
cmd = subprocess.Popen(['pwd'], stdout=subprocess.PIPE)
output = cmd.communicate()[0]
print cmd.returncode
print output 
```

输出

```
> python p.py
/Users/vlazarenko/tests 
```

唯一真正的区别是`Popen`当命令返回非零代码时不会抛出异常。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-28T00:30:00.900

# oracle - 单行子查询返回不止一个行更新嵌套选择和 substr

> ID：14063029
> 
> 赞同：0
> 
> 时间：2012-12-28T00:17:43.703
> 
> 标签：oracle, select, nested, subquery, substring

我正在尝试为需要根据某些参数更新某些记录的表编写查询。我有几个嵌套选择和几个嵌套子字符串，我想这是让我难以排除故障的原因。我解决了其中的几个**ORA-01427：单行子查询已经返回多行**问题，但我似乎找不到这个问题。基本上，该脚本所做的是从一条记录中获取两列，并根据多个不同标准根据包含在不同表中的另一条记录更新它们。以下是我正在使用的当前代码：

```
UPDATE CMC_SBEL_ELIG_ENT p
SET (p.CSPI_ID, p.SBEL_EFF_DT) =
(SELECT co.new_plan, co.ch_dt
   FROM sbsb_plan_conv co, cmc_sbel_elig_ent p
   WHERE co.ch_dt > p.sbel_eff_dt
     and co.ch_dt < current_date
     AND co.new_plan <> p.CSPI_ID
     AND co.sbsb_ck = p.sbsb_ck
     AND p.cspi_id IN co.OLD_PLAN
     and p.SBEL_ELIG_TYPE IN ('tm','ce','TM','CE')
     )
WHERE (p.cspd_cat IN (
   select unique substr(o.old_plan, 1, 1) 
      from facets_ws.sbsb_plan_conv o
      where 
        substr(o.old_plan, 1, 1) IN (
            select substr(y.new_plan, 1, 1)   
            from sbsb_plan_conv y, cmc_sbel_elig_ent u
            where y.sbsb_ck = u.sbsb_ck
              AND (p.SBEL_ELIG_TYPE IN ('tm','ce','TM','CE'))

              and ((substr(y.new_plan, 1, 1) = 'M'
                and substr(y.new_plan, 1, 1) != 'R'
                and substr(y.new_plan, 1, 1) != 'D') 

                or (substr(y.new_plan, 1, 1) = 'R'
                and substr(y.new_plan, 1, 1) != 'M'
                and substr(y.new_plan, 1, 1) != 'D')

                or (substr(y.new_plan, 1, 1) = 'D'
                and substr(y.new_plan, 1, 1) != 'R'
                and substr(y.new_plan, 1, 1) != 'M'))

            and o.sbsb_ck = p.sbsb_ck)
      )
  ); 
```

现在，当我对两个 select 语句运行单个查询时，它们都返回明确的唯一值。所以我相当肯定他们不是问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T02:50:24.353

尝试执行以下查询：-

```
SELECT count(co.new_plan)
  FROM sbsb_plan_conv co, cmc_sbel_elig_ent p
WHERE co.ch_dt > p.sbel_eff_dt
 and co.ch_dt < current_date
 AND co.new_plan <> p.CSPI_ID
 AND co.sbsb_ck = p.sbsb_ck
 AND p.cspi_id IN co.OLD_PLAN
 and p.SBEL_ELIG_TYPE IN ('tm','ce','TM','CE')
 group by co.new_plan; 
```

如果上面返回多于一行或返回的计数多于一，那么您可能需要更改查询以执行 DISTINCT / MIN / 使用 ROWNUM 或其他一些技术。

# mysql - 时间戳间隔

> ID：14063042
> 
> 赞同：3
> 
> 时间：2012-12-28T00:20:33.997
> 
> 标签：mysql, sql, select, timestamp

我有一个名为“s_timestamp”的列。

如何返回时间戳中包含当天的所有记录？

例如，

```
s_timestamp
2012-12-27 1:00:00
2012-12-27 2:00:00
2012-12-26 0:00:01
2012-12-20 0:00:02
2012-12-21 0:00:03 
```

我想要以下输出：

```
2012-12-27 1:00:00
2012-12-27 2:00:00 
```

如果不清楚，请告诉我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T00:22:25.873

只需使用`CURDATE()`. 例如

```
SELECT *
FROM tableName
WHERE DATE(s_timestamp) = CURDATE() 
```

*   [日期（）](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_date)
*   [CURDATE()](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_curdate)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-28T00:32:36.283

这可能比将时间戳转换为更有效`DATE`，特别是如果您在时间戳列上有索引（应该有）：

```
SELECT *
FROM tableName
WHERE s_timestamp >= CURDATE() 
```

或者，如果您想排除任何未来日期：

```
SELECT *
FROM tableName
WHERE s_timestamp >= CURDATE()
  AND s_timestamp < DATE_ADD(CURDATE(), INTERVAL 1 DAY) 
```

这是有效的，因为当 a`DATETIME`或 a`TIMESTAMP`与 a 进行比较时`DATE`，`DATE`实际上，它被解释为具有 的时间部分`0:00:00`。

# facebook - 如何选择只能授予访问权限的特定用户？

> ID：14063043
> 
> 赞同：1
> 
> 时间：2012-12-28T00:21:07.640
> 
> 标签：facebook, login

登录后是否可以选择能够查看您网站内容的特定 Facebook 用户（基于 ID？）？

例如，我只想要能够查看网站上可用内容的特定人员。

我期待着您的回复！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T00:34:33.600

您可以为沙盒模式定义测试用户，但我得到的印象不是您所说的。

如果是生产环境：

您应该有某种形式的 user_ids 存储，允许查看内容。在您的代码（服务器或客户端，最好是服务器，以便内容不在页面源中）中，您应该检查它们是否具有有效的 Facebook 会话，以及`user_id`您是否可以将其识别为有效。

# sql - 在 Ruby Sinatra 中使用 SQL 脚本和 DataMapper 创建简单表的最佳方法是什么？

> ID：14063045
> 
> 赞同：1
> 
> 时间：2012-12-28T00:21:19.220
> 
> 标签：sql, ruby, sinatra, datamapper

我想在我的 Sinatra 应用程序中创建一个简单的表，使用 DataMapper 进行数据库连接，使用以下 SQL：

```
CREATE TABLE `prov_abbrev` (
  `abbrev` varchar(2) NOT NULL DEFAULT '',
  `province` varchar(256) NOT NULL DEFAULT ''
) DEFAULT CHARSET=utf8;

    INSERT INTO `prov_abbrev` (`abbrev`,`province`)
    VALUES
    ('AB','Alberta'),
    ('BC','British Columbia'),
    ('MB','Manitoba'),
    ('NB','New Brunswick'),
    ('NL','Newfoundland and Labrador'),
    ('NT','Northwest Territories'),
    ('NS','Nova Scotia'),
    ('NU','Nunavut'),
    ('ON','Ontario'),
    ('PE','Prince Edward Island'),
    ('QC','Quebec'),
    ('SK','Saskatchewan'),
    ('YT','Yukon'); 
```

我想在各种应用程序中将它用作各种其他模型的查找表，所以它会被使用很多。做这个的最好方式是什么？只设置一个包含数据的哈希/数组会更有意义吗？将数据放在表格中是否有任何好处，例如能够使用 js 从表单中查找值...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T00:29:47.220

我会使用[Data Mapper Migrations gem](https://github.com/datamapper/dm-migrations)：进行向上迁移以创建表，然后在插入行的同时遍历 Ruby 数组。（以及一个简单的下拉表作为向下迁移）。

# c++ - fallocate vs posix_fallocate

> ID：14063046
> 
> 赞同：10
> 
> 时间：2012-12-28T00:21:20.470
> 
> 标签：c++, c, posix

我正在讨论在`posix_fallocate`和之间使用哪个函数`fallocate`。 `posix_fallocate`立即写入文件（将字符初始化为 NULL）。但是，`fallocate`不会更改文件大小（使用`FALLOC_FL_KEEP_SIZE`标志时）。根据我的实验，似乎`fallocate`不会将 NULL 或零字符写入文件。

有人可以根据您的经验发表评论吗？谢谢你的时间。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-05-07T04:24:53.477

文件占用的存储空间超过其显示长度并不常见，因此除非您有充分的理由这样做（例如，您想使用文件长度来跟踪下载的距离，以便恢复它），最好使用默认的 fallocate(2) 行为。（没有 FALLOC_FL_KEEP_SIZE）。这与 posix_fallocate(3) 的语义相同。

fallocate(2) 的手册页甚至说它的默认行为（无标志）旨在作为实现 posix_fallocate(3) 的最佳方式，并指出这是一种分配空间的可移植方式。

最初的问题是关于将零写入文件。除了元数据之外，这些调用都不会写入任何内容。如果您从已预先分配但尚未写入的空间中读取，您将得到零（不是该磁盘空间之前的任何内容，这将是一个很大的安全漏洞）。您只能读取到文件的末尾（长度，由 fallocate、ftruncate 或各种其他方式设置），因此如果您有一个零长度文件并使用 FALLOC_FL_KEEP_SIZE 进行 fallocate，那么您将无法读取任何内容。与预分配无关，只是文件大小语义。

因此，如果您对 POSIX 语义满意，请使用它，因为它更便携。每个 GNU/Linux 系统都将支持 posix_fallocate(3)，但其他一些系统也将支持。

然而，多亏了 POSIX 语义，事情并没有那么简单。如果你在一个不支持预分配的文件系统上使用它，它仍然会成功，但是通过回退到在文件的每个块中实际写入一个零来做到这一点。

测试程序：

```
#include <fcntl.h>
int main() {
    int fd = open("foo", O_RDWR|O_CREAT, 0666);
    if (fd < 0) return 1;
    return posix_fallocate(fd, 0, 400000);
} 
```

在 XFS 上

```
$ strace ~/src/c/falloc
...
open("foo", O_RDWR|O_CREAT, 0666) = 3
fallocate(3, 0, 0, 400000)              = 0
exit_group(0)                           = ? 
```

在 fat32 闪存驱动器上：

```
open("foo", O_RDWR|O_CREAT, 0666) = 3
fallocate(3, 0, 0, 400000)              = -1 EOPNOTSUPP (Operation not supported)
fstat(3, {st_mode=S_IFREG|0755, st_size=400000, ...}) = 0
fstatfs(3, {f_type="MSDOS_SUPER_MAGIC", f_bsize=65536, f_blocks=122113, f_bfree=38274, f_bavail=38274, f_files=0, f_ffree=0, f_fsid={2145, 0}, f_namelen=1530, f_frsize=65536}) = 0
pread(3, "\0", 1, 6783)                 = 1
pwrite(3, "\0", 1, 6783)                = 1
pread(3, "\0", 1, 72319)                = 1
pwrite(3, "\0", 1, 72319)               = 1
pread(3, "\0", 1, 137855)               = 1
pwrite(3, "\0", 1, 137855)              = 1
pread(3, "\0", 1, 203391)               = 1
pwrite(3, "\0", 1, 203391)              = 1
pread(3, "\0", 1, 268927)               = 1
pwrite(3, "\0", 1, 268927)              = 1
pread(3, "\0", 1, 334463)               = 1
pwrite(3, "\0", 1, 334463)              = 1
pread(3, "\0", 1, 399999)               = 1
pwrite(3, "\0", 1, 399999)              = 1
exit_group(0)                           = ? 
```

如果文件还没有那么长，它确实可以避免读取，但是写入每个块仍然很糟糕。

如果你想要一些简单的东西，我仍然会选择 posix_fallocate。它有一个 FreeBSD 手册页，它由 POSIX 指定，因此每个 POSIX 兼容系统都提供它。一个缺点是在不支持预分配的文件系统上使用 glibc 会很糟糕。参见例如[https://plus.google.com/+AaronSeigo/posts/FGtXM13QuhQ](https://plus.google.com/+AaronSeigo/posts/FGtXM13QuhQ)。对于处理大文件（例如种子）的程序，这可能非常糟糕。

您可以感谢 POSIX 语义要求 glibc 执行此操作，因为它没有为“文件系统不支持预分配”定义错误代码。 [http://pubs.opengroup.org/onlinepubs/009695399/functions/posix_fallocate.html](http://pubs.opengroup.org/onlinepubs/009695399/functions/posix_fallocate.html)。它还保证如果调用成功，后续对分配区域的写入不会因磁盘空间不足而失败。因此，posix 设计没有提供一种方法来处理调用者关心效率/性能/碎片而不是磁盘空间保证的情况。这迫使 POSIX 实现执行读写循环，而不是将其作为需要磁盘空间保证的调用者的选项。感谢POSIX ...

我不知道当文件系统不支持预分配时，posix_fallocate 的非 GNU 实现是否同样会退回到极其缓慢的读写行为。（FreeBSD，Solaris？）。显然 OS X (Darwin) 没有实现 posix_fallocate，除非它是最近的。

如果您希望支持跨许多平台的预分配，但如果操作系统有办法尝试预分配，但又不退回到先读后写，您必须使用任何可用的特定于平台的方法。例如查看 [https://github.com/arvidn/libtorrent/blob/master/src/file.cpp](https://github.com/arvidn/libtorrent/blob/master/src/file.cpp)

搜索文件::set_size。它有几个 ifdeffed 块，具体取决于编译目标支持的内容，从 windows 代码开始加载 DLL 并在那里执行操作，然后是 fcntl F_PREALLOCATE 或 fcntl F_ALLOCSP64，然后是 Linux fallocate(2)，然后回退到使用 posix_fallocate。此外，找到了 OS X Darwin 的 2007 年列表帖子：http: [//lists.apple.com/archives/darwin-dev/2007/Dec/msg00040.html](http://lists.apple.com/archives/darwin-dev/2007/Dec/msg00040.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-28T00:40:16.823

我认为您没有查看说

> ```
>  The mode argument determines the operation to be performed on the given range.
>    Currently only one flag is supported for mode:
> 
>    FALLOC_FL_KEEP_SIZE
>           This flag allocates and initializes to zero the disk space within the
>           range specified by offset and len.  After a successful call, subsequent
>           writes into this range are guaranteed not to fail because of lack of
>           disk space.  Preallocating zeroed blocks beyond the end of the file is
>           useful for optimizing append workloads.  Preallocating blocks does not
>           change the file size (as reported by stat(2)) even if it is less than
>           offset+len.
> 
>    If FALLOC_FL_KEEP_SIZE flag is not specified in mode, the default behavior is
>    almost same as when this flag is specified.  The only difference is that on
>    success, the file size will be changed if offset + len is greater than the
>    file size.  This default behavior closely resembles the behavior of the
>    posix_fallocate(3) library function, and is intended as a method of optimally
>    implementing that function. 
> ```

posix_fallocate() 的手册页似乎没有提到相同的内容，但相反，查看源代码[here](http://sourceware.org/git/?p=glibc.git;a=blob;f=sysdeps/posix/posix_fallocate.c;h=6c2890f8872332d8d2d080148122513764f97919;hb=7fffbdfff7d39cec0783e5b9381fa4093484c235)，它似乎写入了文件的每个块（第 88 行）。

[人 fallocate](http://www.kernel.org/doc/man-pages/online/pages/man2/fallocate.2.html) [人 posix_fallocate](http://linux.die.net/man/3/posix_fallocate)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-28T00:31:30.553

至少有一点信息来自 fallocate(2) 手册页：

```
int fallocate(int fd, int mode, off_t offset, off_t len);

DESCRIPTION
   This is a nonportable, Linux-specific system call. 
```

虽然系统调用文档没有说明，但 fallocate(1) 程序手册页说：

```
As of the Linux Kernel v2.6.31, the fallocate system call is supported
by the btrfs, ext4, ocfs2, and xfs filesystems. 
```

这对我来说很有意义，因为 NTFS、FAT、CDFS 和大多数其他常见文件系统在磁盘上没有支持调用的内部机制。我认为对这些的支持将由内核缓冲，并且该设置不会在系统启动后持续存在。

# javascript - addEventListener 以编程方式为空

> ID：14063050
> 
> 赞同：1
> 
> 时间：2012-12-28T00:21:47.723
> 
> 标签：javascript, events, dom-events, winjs

```
var button = document.createElement("button");
button.type = "button";

button.className = "button";
button.innerText = "OK";
button.addEventListener("click", function () {
    console.log("Hello!");
}, false); 
```

当我这样做时，按钮永远不会得到那个事件监听器。我试过`attachEvent`, `button.onclick`，但似乎没有任何效果。该按钮与类和文本一起显示得很好。

编辑：所以基本上我想要做的是以编程方式显示一个“弹出”数组的div。

这是它的截图：[http://i.imgur.com/IqaOq.png](https://i.imgur.com/IqaOq.png)，我将其设置为：`var x = new JMTK.Custom.MessageDialog()`，然后添加一个弹出窗口，我只需键入`x.addMessage({template: {type: JMTK.Custom.MessageDialog.templates.alert, title: "Alert title", message: "This is a message here", button1: {text: "Hello"}}})`

这是`addMessage()`：

```
var content = document.createElement("div"); 
//htmlObject.template is the object that has all the info, 'this' is the scrim element that contains each "white" popup"
content.innerHTML = MessageDialogClass.html.alert(htmlObject.template, this).innerHTML 
```

调用此函数：

```
alert: function (template, element) {
    //Array of functions
    var callbacks = MessageDialogClass.callbacks;

    var alert = document.createElement("div");
    var id = Date.now();
    alert.id = id;

    var header = document.createElement("h1");
    header.innerText = (template.title ? template.title : "ALERT");

    var paragraph = document.createElement("p");
    paragraph.innerText = (template.message ? template.message : "No message specified")

    var button = document.createElement("button");
    button.type = "button";

    button.className = "button";
    button.innerText = (template.button1.text ? template.button1.text : "OK");
    button.addEventListener("click", function () {
        if (template.button1.callback) {
            template.button1.callback();
        }

        //MessageDialogClass.popElement(id);
        //delete callbacks.id;
    }, false);

    alert.appendChild(header);
    alert.appendChild(paragraph);
    alert.appendChild(button);

    callbacks.id = alert;

    return alert;
}, 
```

但是同样，当我单击按钮时，什么也没有发生，并且在 DOM Explorer 中没有`onclick`属性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T16:25:39.520

很难说你的解决方案可能是什么。您已经提供了有关单击按钮*要*执行的操作的详细信息，但恐怕还有其他事情在起作用。我想知道您是否在按钮前面有一个元素可以防止它接收鼠标点击。我看到您在 Windows 8 的 WinJS 项目中。您在 VS2012 中有非常好的开发工具。将按钮添加到 DOM 后立即中断，然后转到 DOM Explorer 并查看是否找到该按钮。转到 JavaScript 控制台，看看您是否可以访问该按钮。看看你是否可以在那里手动添加一个事件监听器。尝试在标记中手动添加按钮，然后查看添加事件是否有效。希望其中之一能让您找到解决方案。祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T13:30:44.980

问题是我`div`在我的“警报”模板中创建了一个，然后将另一个 div 的 innerHTML 设置为该 div。所以它不允许我设置事件监听器，因为它不是 DOM 的一部分。

所以而不是做

```
var content = document.createElement("div"); 
//htmlObject.template is the object that has all the info, 'this' is the scrim element that contains each "white" popup"
content.innerHTML = MessageDialogClass.html.alert(htmlObject.template, this).innerHTML 
```

我已经做了

```
var content = document.createElement("div"); 
//htmlObject.template is the object that has all the info, 'this' is the scrim element that contains each "white" popup"
content = MessageDialogClass.html.alert(htmlObject.template, this).innerHTML 
```

因为`alert`已经返回了`div`。所以，是的，它与设置 innerHTML 而不仅仅是设置它等于 DOM 节点有关。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-12-28T00:28:24.763

我认为您需要在设置事件侦听器之前附加您的按钮。

# javascript - 通过 iFrame 显示文件路径

> ID：14063051
> 
> 赞同：0
> 
> 时间：2012-12-28T00:21:50.703
> 
> 标签：javascript, jquery, html, iframe

我有一个网页，我需要在其中获取用户计算机上本地文件的文件路径。我在想有一个 iFrame，用户可以在其中拖动文件，响应是文件路径。

例如：

[ in ] 用户将文件拖入网页的 iFrame [ out ] 网页显示拖放文件的文件路径 (/Volumes/path/file)

我该怎么做？（一个代码示例或教程的链接会很棒）

这是我可以在 SO 上找到的最佳答案：[https](https://stackoverflow.com/a/7890676/651174) ://stackoverflow.com/a/7890676/651174 。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T00:36:17.060

获取文件路径是一个安全问题。您可以获得的最接近的是[fakepath](http://jsfiddle.net/EaPDV/)。您还可以使用`files[0]`而不是 value 来获取有关文件的更多信息。

考虑通过 HTML5 FileReader API 使用 HTML5 文件拖放。[本教程](http://www.htmlgoodies.com/html5/javascript/drag-files-into-the-browser-from-the-desktop-HTML5.html#fbid=AujL2WR0GgP)解释了如何做到这一点。

# backbone.js - 在 iOS Safari 中，backbone.js 获取失败，在 chrome 中工作

> ID：14063061
> 
> 赞同：0
> 
> 时间：2012-12-28T00:23:54.460
> 
> 标签：backbone.js, mobile-safari

iOS safari 和backbone.js 有点奇怪。

我正在尝试通过 post 命令获取集合，我的主干代码是

```
MyApp.search_results.fetch（{数据：数据，类型：'POST'，
                         成功：函数（响应）{
                                 //我做了一堆成功的事情
                          },
                         错误：函数（）{
                           alert('搜索时出现问题');
                          }
                });

```

当我在 chrome（桌面和 iPhone 或 Android）中运行上述代码时，我得到的结果没有问题。

但是在 iOS 上使用 safari，我得到了`Failed to load resource: the server responded with a status of 404 (Not Found)`.

最大的问题是我的 Rails 控制台甚至没有显示 safari 正在发送请求，我看不到上一个请求，所以我收到 404 错误，但这实际上不是问题。

有任何想法吗？

- - - - - - - - - - - - 更新 - - - - - - - - - - - -

问题是由`type: 'POST'`. 我已删除，现在正在提交一个获取请求，但我希望这是一个帖子类型。所以任何关于如何解决这个问题的建议都会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T12:04:41.260

Backbone 在内部设置`GET`了`fetch`函数的请求方法。尝试覆盖它可能会导致任何数量的不一致，因此不建议这样做。

如果您正在尝试获取数据，那么为什么不更新您的服务器代码以读取`GET`参数而不是`POST`参数（或两者）？

# jquery - 将单选按钮标记为选中 jquery

> ID：14063062
> 
> 赞同：1
> 
> 时间：2012-12-28T00:23:55.203
> 
> 标签：jquery

我正在使用以下代码，为什么它不起作用？

```
javascript:$('input[id=mod1radio]:eq(1)').attr('checked', 'checked'); 
```

和

```
<input id="mod1radio" type="radio" name="group1" value="24"> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T00:26:48.323

因为`eq()`使用基于 0 的索引（即，如果您只有其中一个，因为 id 是不同的，所以您应该选择数组的末尾。`eq(0)`应该可以）。

但是，如果您有一个 id，为什么还要进行复杂的选择呢？为什么不只是`$("#mod1radio")`？

此外，如评论中所述，`attr()`已弃用，您应该使用`prop()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T00:25:36.853

只有输入。`eq(1)`会选择第二个。@charlietfl 建议使用jQuery >= 1.6 版`prop()`而不是。`attr()`

> 从 jQuery 1.6 开始，.attr() 方法为尚未设置的属性返回 undefined。此外，.attr() 不应用于普通对象、数组、窗口或文档。要检索和更改 DOM 属性，请使用 .prop() 方法。

由于 id`mod1radio`必须是唯一的，只需使用

```
$('#mod1radio').prop('checked', true);​ 
```

JSFiddle [http://jsfiddle.net/mFkQQ/3/](http://jsfiddle.net/mFkQQ/3/)

如果`mod1radio`应该是一个类，那么使用

```
$('.mod1radio:eq(0)').prop('checked', true);​ 
```

小提琴[http://jsfiddle.net/mFkQQ/5/](http://jsfiddle.net/mFkQQ/5/)

# matlab - 如何在Matlab中绘制负增益的根轨迹图？

> ID：14063063
> 
> 赞同：3
> 
> 时间：2012-12-28T00:24:01.613
> 
> 标签：matlab

该函数`rlocus`绘制系统的正增益根轨迹。如何绘制负增益根轨迹？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-28T00:52:03.700

`num`对于负增益值，只需在or前面放置一个减号`sys`，其中传递函数和“系统”格式的函数语法为：

```
rlocus(num; den);
rlocus(sys); 
```

# javascript - 如何找到我的 javascript 中使用的全局变量

> ID：14063064
> 
> 赞同：9
> 
> 时间：2012-12-28T00:24:07.833
> 
> 标签：javascript

> **可能重复：**
> [获取页面中的所有（javascript）全局变量](https://stackoverflow.com/questions/2226007/fetching-all-javascript-global-variables-in-a-page)

我的应用程序在 javascript 中使用全局变量。有没有办法找出其中有多少？

谢谢唵

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-28T00:33:47.193

我做了一个。

```
var GlobalTester = (function(){
    var fields = {};
    var before = function(w){
        for(var field in w){
            fields[field] = true;
        };
    };

    var after = function(w){
        for(var field in w){
            if(!fields[field]){
                 console.log(field + " has been added");
            }            
        };

    };
    return {before: before, after:after};
}());

GlobalTester.before(window);

// Run your code here        
window.blar = "sdfg";      

GlobalTester.after(window);        
​
​ 
```

这将`blar has been added`在控制台中输出

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-28T00:34:48.993

在您的浏览器开发人员窗口 (F12) 中尝试此操作：

```
Object.keys(window).length 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-28T00:31:51.883

像这样遍历 window 元素：

```
for(var globe in window){
 console.log(globe);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-28T00:29:30.817

当引入全局变量时，使用 linter 会警告您。您还可以比较`window`代码运行前后的项目。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-12-28T00:36:22.557

检查窗口对象，但在执行此操作之前，您需要知道所有全局变量名称，这是一个示例：

```
var myGlobalVars = {"global1":0, "global2":0};

function countGlobals() {
    var count = 0;
    for (myGlobalVar in myGlobalVars) {
        if (myGlobalVar in window) {
            count++;
        }
    }

    return count;
}

countGlobals(); 
```

# java - 自定义键盘——如何使这些按钮起作用？

> ID：14063065
> 
> 赞同：0
> 
> 时间：2012-12-28T00:24:50.563
> 
> 标签：java, android

我有一个几乎完成的应用程序，它是一个记分牌应用程序。当用户在乐谱上进行长按时，当前会出现一个对话框，其中显示带有 OK 和 CANCEL 按钮的 EditText 字段。当用户单击 EditText 字段时，会出现一个键盘（仅限数字），用户在其中键入新分数，单击 DONE，然后 EditText 字段在对话框中显示新值，当用户单击 OK 时，它会保存输入的值到显示当前分数的 TextView。

问题是我觉得它很麻烦。这是我想要发生的事情：

1.  用户对分数进行了 LongClick
2.  键盘出现
3.  用户输入新分数
4.  用户点击确定
5.  键盘消失，值被保存到更新当前分数的 TextView。

为了做到这一点，我想到了两件事：

1.  我可以创建一个扩展 View 的新类——我对 android 太陌生，无法真正理解这个选项。
2.  我可以将对话框中的 EditText 替换为一个新的 XML 文件，该文件的设计类似于键盘。

选项 2：我认为这可能是最简单的，所以我设计了 XML 布局并将其命名为 keypad.xml。现在，当用户执行 LongClick 时，keypad.xml 文件会在带有 OK 和 CANCEL 的对话框中膨胀。到目前为止，一切都很好。但是，我不知道应该将按钮操作的代码放在哪里。

起初，我想我可以为布局中的所有按钮设置一些 onClick 侦听器。我认为所有按钮都将执行完全相同的功能。基本上，从按钮（在本例中为 0-9）获取文本并将其附加到键盘上方的 TextView。然后，当用户单击确定时，将 keypad.xml 中的 TextView 保存到当前分数 textview。

任何人都可以帮我指出正确的方向来完成这个吗？

这是keypad.xml的截图（数字上方有一个空的TextView）： ![在此处输入图像描述](../Images/5a5fa11f73ef3044f3e2827bf083c13d.png)

这是 XML 代码：

```
<?xml version="1.0" encoding="utf-8"?>
<GridLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:layout_gravity="fill"
android:columnCount="3" >

<TextView
    android:id="@+id/textView1"
    android:layout_columnSpan="3"
    android:layout_gravity="fill"
    android:gravity="right|center_vertical"
    android:textSize="24sp" />

<Button android:text="1" />

<Button android:text="2" />

<Button android:text="3" />
<Button android:text="4" />
<Button android:text="5" />
<Button android:text="6" />
<Button android:text="7" />
<Button android:text="8" />
<Button android:text="9" />

<Button
    android:layout_columnSpan="3"
    android:layout_gravity="fill"
    android:gravity="center"
    android:text="0" /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T18:41:01.943

This Question has not seemed to prompt a response. In case anyone is looking for an answer to this, I have come up with another solution which isn't exactly the same but works none the less.

[Please see this question.](https://stackoverflow.com/questions/14073154/textview-editable-onlongclick-but-one-small-issue-when-back-button-pressed)

# python - 在较大的图像上覆盖较小的图像 python OpenCv

> ID：14063070
> 
> 赞同：76
> 
> 时间：2012-12-28T00:26:20.523
> 
> 标签：python, opencv, object-detection

嗨，我正在创建一个程序，用别人的脸替换图像中的脸。但是，我坚持尝试将新面孔插入到原始的更大图像中。我研究了 ROI 和 addWeight（需要图像大小相同），但我还没有找到在 python 中执行此操作的方法。任何建议都很棒。我是opencv的新手。

我正在使用以下测试图像：

较小的图像：

![在此处输入图像描述](../Images/eeb2b016cb34334e9792cbea848e6c0e.png)

大图：

![在此处输入图像描述](../Images/af3c8cf7caa22e127c31602058ceda8c.png)

到目前为止，这是我的代码......其他样本的混合器：

```
import cv2
import cv2.cv as cv
import sys
import numpy

def detect(img, cascade):
    rects = cascade.detectMultiScale(img, scaleFactor=1.1, minNeighbors=3, minSize=(10, 10), flags = cv.CV_HAAR_SCALE_IMAGE)
    if len(rects) == 0:
        return []
    rects[:,2:] += rects[:,:2]
    return rects

def draw_rects(img, rects, color):
    for x1, y1, x2, y2 in rects:
        cv2.rectangle(img, (x1, y1), (x2, y2), color, 2)

if __name__ == '__main__':
    if len(sys.argv) != 2:                                         ## Check for error in usage syntax

    print "Usage : python faces.py <image_file>"

else:
    img = cv2.imread(sys.argv[1],cv2.CV_LOAD_IMAGE_COLOR)  ## Read image file

    if (img == None):                                     
        print "Could not open or find the image"
    else:
        cascade = cv2.CascadeClassifier("haarcascade_frontalface_alt.xml")
        gray = cv2.cvtColor(img, cv.CV_BGR2GRAY)
        gray = cv2.equalizeHist(gray)

        rects = detect(gray, cascade)

        ## Extract face coordinates         
        x1 = rects[0][3]
        y1 = rects[0][0]
        x2 = rects[0][4]
        y2 = rects[0][5]
        y=y2-y1
        x=x2-x1
        ## Extract face ROI
        faceROI = gray[x1:x2, y1:y2]

        ## Show face ROI
        cv2.imshow('Display face ROI', faceROI)
        small = cv2.imread("average_face.png",cv2.CV_LOAD_IMAGE_COLOR)  
        print "here"
        small=cv2.resize(small, (x, y))
        cv2.namedWindow('Display image')          ## create window for display
        cv2.imshow('Display image', small)          ## Show image in the window

        print "size of image: ", img.shape        ## print size of image
        cv2.waitKey(1000) 
```

* * *

## 回答 #1

> 赞同：158
> 
> 时间：2012-12-31T13:07:58.830

一个简单的方法来实现你想要的：

```
import cv2
s_img = cv2.imread("smaller_image.png")
l_img = cv2.imread("larger_image.jpg")
x_offset=y_offset=50
l_img[y_offset:y_offset+s_img.shape[0], x_offset:x_offset+s_img.shape[1]] = s_img 
```

![结果图像](../Images/77311f49210f915785855ec21f994ad7.png)

## 更新

我想你也想处理 alpha 通道。这是一种快速而肮脏的方法：

```
s_img = cv2.imread("smaller_image.png", -1)

y1, y2 = y_offset, y_offset + s_img.shape[0]
x1, x2 = x_offset, x_offset + s_img.shape[1]

alpha_s = s_img[:, :, 3] / 255.0
alpha_l = 1.0 - alpha_s

for c in range(0, 3):
    l_img[y1:y2, x1:x2, c] = (alpha_s * s_img[:, :, c] +
                              alpha_l * l_img[y1:y2, x1:x2, c]) 
```

![带有 alpha 的结果图像](../Images/57b2454e671b7484838436f2550426cf.png)

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2017-07-15T12:06:35.003

使用@fireant 的想法，我编写了一个函数来处理覆盖。这适用于任何位置参数（包括负位置）。

```
def overlay_image_alpha(img, img_overlay, x, y, alpha_mask):
    """Overlay `img_overlay` onto `img` at (x, y) and blend using `alpha_mask`.

    `alpha_mask` must have same HxW as `img_overlay` and values in range [0, 1].
    """
    # Image ranges
    y1, y2 = max(0, y), min(img.shape[0], y + img_overlay.shape[0])
    x1, x2 = max(0, x), min(img.shape[1], x + img_overlay.shape[1])

    # Overlay ranges
    y1o, y2o = max(0, -y), min(img_overlay.shape[0], img.shape[0] - y)
    x1o, x2o = max(0, -x), min(img_overlay.shape[1], img.shape[1] - x)

    # Exit if nothing to do
    if y1 >= y2 or x1 >= x2 or y1o >= y2o or x1o >= x2o:
        return

    # Blend overlay within the determined ranges
    img_crop = img[y1:y2, x1:x2]
    img_overlay_crop = img_overlay[y1o:y2o, x1o:x2o]
    alpha = alpha_mask[y1o:y2o, x1o:x2o, np.newaxis]
    alpha_inv = 1.0 - alpha

    img_crop[:] = alpha * img_overlay_crop + alpha_inv * img_crop 
```

示例用法：

```
import numpy as np
from PIL import Image

# Prepare inputs
x, y = 50, 0
img = np.array(Image.open("img_large.jpg"))
img_overlay_rgba = np.array(Image.open("img_small.png"))

# Perform blending
alpha_mask = img_overlay_rgba[:, :, 3] / 255.0
img_result = img[:, :, :3].copy()
img_overlay = img_overlay_rgba[:, :, :3]
overlay_image_alpha(img_result, img_overlay, x, y, alpha_mask)

# Save result
Image.fromarray(img_result).save("img_result.jpg") 
```

结果：

[![img_result.jpg](../Images/be8bd8691a2f37a0d2d097901fcf3e32.png)](https://i.stack.imgur.com/CF4h5.jpg)

如果您遇到错误或异常输出，请确保：

*   `img` *不应*包含 Alpha 通道。（例如如果是RGBA，则先转换为RGB。）
*   `img_overlay`具有与 相同数量的通道`img`。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2016-11-20T20:32:16.883

根据上面fireant的出色回答，这里是alpha混合，但更易读。您可能需要交换`1.0-alpha`，`alpha`具体取决于您要合并的方向（我的交换来自 fireant 的答案）。

`o* == s_img.*` `b* == b_img.*`

```
for c in range(0,3):
    alpha = s_img[oy:oy+height, ox:ox+width, 3] / 255.0
    color = s_img[oy:oy+height, ox:ox+width, c] * (1.0-alpha)
    beta  = l_img[by:by+height, bx:bx+width, c] * (alpha)

    l_img[by:by+height, bx:bx+width, c] = color + beta 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2018-10-10T14:29:26.423

这里是：

```
def put4ChannelImageOn4ChannelImage(back, fore, x, y):
    rows, cols, channels = fore.shape    
    trans_indices = fore[...,3] != 0 # Where not transparent
    overlay_copy = back[y:y+rows, x:x+cols] 
    overlay_copy[trans_indices] = fore[trans_indices]
    back[y:y+rows, x:x+cols] = overlay_copy

#test
background = np.zeros((1000, 1000, 4), np.uint8)
background[:] = (127, 127, 127, 1)
overlay = cv2.imread('imagee.png', cv2.IMREAD_UNCHANGED)
put4ChannelImageOn4ChannelImage(background, overlay, 5, 5) 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2020-11-01T15:53:56.363

一个简单的函数，将图像blits到图像`front`上`back`并返回结果。它适用于 3 通道和 4 通道图像并处理 alpha 通道。重叠也得到处理。

输出图像的大小与背面相同，但始终为 4 个通道。
输出 alpha 通道由 (u+v)/(1+uv) 给出，其中 u,v 是前后图像的 alpha 通道，-1 <= u,v <= 1。前面，取后面的 alpha 值。

```
import cv2

def merge_image(back, front, x,y):
    # convert to rgba
    if back.shape[2] == 3:
        back = cv2.cvtColor(back, cv2.COLOR_BGR2BGRA)
    if front.shape[2] == 3:
        front = cv2.cvtColor(front, cv2.COLOR_BGR2BGRA)

    # crop the overlay from both images
    bh,bw = back.shape[:2]
    fh,fw = front.shape[:2]
    x1, x2 = max(x, 0), min(x+fw, bw)
    y1, y2 = max(y, 0), min(y+fh, bh)
    front_cropped = front[y1-y:y2-y, x1-x:x2-x]
    back_cropped = back[y1:y2, x1:x2]

    alpha_front = front_cropped[:,:,3:4] / 255
    alpha_back = back_cropped[:,:,3:4] / 255

    # replace an area in result with overlay
    result = back.copy()
    print(f'af: {alpha_front.shape}\nab: {alpha_back.shape}\nfront_cropped: {front_cropped.shape}\nback_cropped: {back_cropped.shape}')
    result[y1:y2, x1:x2, :3] = alpha_front * front_cropped[:,:,:3] + (1-alpha_front) * back_cropped[:,:,:3]
    result[y1:y2, x1:x2, 3:4] = (alpha_front + alpha_back) / (1 + alpha_front*alpha_back) * 255

    return result 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2018-10-05T13:26:19.243

只需向 s_img 添加一个 alpha 通道，我只需在该行之前使用 cv2.addWeighted `l_img[y_offset:y_offset+s_img.shape[0], x_offset:x_offset+s_img.shape[1]] = s_img`

如下：
`s_img=cv2.addWeighted(l_img[y_offset:y_offset+s_img.shape[0], x_offset:x_offset+s_img.shape[1]],0.5,s_img,0.5,0)`

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-02-17T19:49:11.407

尝试使用上述任何答案写入目标图像时，您会收到以下错误：

```
ValueError: assignment destination is read-only 
```

一个快速的潜在解决方法是将 WRITEABLE 标志设置为 true。

```
img.setflags(write=1) 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-07-24T11:23:56.990

一个简单的 4on4 粘贴功能 -

```
def paste(background,foreground,pos=(0,0)):
    #get position and crop pasting area if needed
    x = pos[0]
    y = pos[1]
    bgWidth = background.shape[0]
    bgHeight = background.shape[1]
    frWidth = foreground.shape[0]
    frHeight = foreground.shape[1]
    width = bgWidth-x
    height = bgHeight-y
    if frWidth<width:
        width = frWidth
    if frHeight<height:
        height = frHeight
    # normalize alpha channels from 0-255 to 0-1
    alpha_background = background[x:x+width,y:y+height,3] / 255.0
    alpha_foreground = foreground[:width,:height,3] / 255.0
    # set adjusted colors
    for color in range(0, 3):
        fr = alpha_foreground * foreground[:width,:height,color]
        bg = alpha_background * background[x:x+width,y:y+height,color] * (1 - alpha_foreground)
        background[x:x+width,y:y+height,color] = fr+bg
    # set adjusted alpha and denormalize back to 0-255
    background[x:x+width,y:y+height,3] = (1 - (1 - alpha_foreground) * (1 - alpha_background)) * 255
    return background 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-12-10T03:29:00.873

我重新设计了@fireant 的概念，以允许可选的 alpha 掩码并允许任何 x 或 y，包括图像边界之外的值。它将裁剪到边界。

```
def overlay_image_alpha(img, img_overlay, x, y, alpha_mask=None):
    """Overlay `img_overlay` onto `img` at (x, y) and blend using optional `alpha_mask`.

    `alpha_mask` must have same HxW as `img_overlay` and values in range [0, 1].
    """

    if y < 0 or y + img_overlay.shape[0] > img.shape[0] or x < 0 or x + img_overlay.shape[1] > img.shape[1]:
        y_origin = 0 if y > 0 else -y
        y_end = img_overlay.shape[0] if y < 0 else min(img.shape[0] - y, img_overlay.shape[0])

        x_origin = 0 if x > 0 else -x
        x_end = img_overlay.shape[1] if x < 0 else min(img.shape[1] - x, img_overlay.shape[1])

        img_overlay_crop = img_overlay[y_origin:y_end, x_origin:x_end]
        alpha = alpha_mask[y_origin:y_end, x_origin:x_end] if alpha_mask is not None else None
    else:
        img_overlay_crop = img_overlay
        alpha = alpha_mask

    y1 = max(y, 0)
    y2 = min(img.shape[0], y1 + img_overlay_crop.shape[0])

    x1 = max(x, 0)
    x2 = min(img.shape[1], x1 + img_overlay_crop.shape[1])

    img_crop = img[y1:y2, x1:x2]
    img_crop[:] = alpha * img_overlay_crop + (1.0 - alpha) * img_crop if alpha is not None else img_overlay_crop 
```

# java - 如何将 Java 循环与 SQL 条件选择混合使用

> ID：14063072
> 
> 赞同：0
> 
> 时间：2012-12-28T00:26:22.333
> 
> 标签：java, mysql, sql, exception-handling

所以我想从 SQL 数据库中进行选择，使用 Java，受条件语句（小于或等于某些东西）的影响，受 Java 中的某个循环的影响。换句话说，类似于以下内容：

```
for (int i=0; i< 195; i++) {
            // Get the results of the SQL query
            resultSet = statement.executeQuery( 
                    "SELECT max( millisFromMid ) FROM stockInfo1 WHERE ( millisFromMid <=  34200000 + (120000)*i ) GROUP BY stockID" 
                    ); 
```

现在Java在这里返回一个异常，因为它不希望我在这种情况下使用“i”；但是，由于无法在此处使用它，我不确定如何更改此条件。问题是这样的：我希望从一个数据库中检索数据，目的是进行一些操作并将结果放入一个新数据库中。这些操作取决于获取最新的可用数据，这就是为什么我想增加millisFromMid 的边界数。那有意义吗？

有人对某人如何做这样的事情有建议吗？这似乎是一起使用 Java 和 SQL 时必须具备的一项基本技能，所以我非常想知道它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-28T00:40:23.123

SQL 语句在与 Java 代码不同的环境中解析和运行——不同的语言、不同的范围，除非你使用 SQLite，否则它们在不同的进程甚至不同的机器中运行。因此，您不能只`i`从 SQL 代码中引用 Java 变量——您必须注入它或使用特殊的 API。

第一个选项 - 注入 - 是简单地将 i 的值放入字符串中：

```
"SELECT max( millisFromMid ) FROM stockInfo1 WHERE ( millisFromMid <=  34200000 + (120000)*"+i+" ) GROUP BY stockID" 
```

就个人而言，我更喜欢使用`String.format`- 但这只是我。

```
String.format("SELECT max( millisFromMid ) FROM stockInfo1 WHERE ( millisFromMid <=  34200000 + (120000)*%d ) GROUP BY stockID",i) 
```

第二个选项 - 通过 API - 更复杂但也更快（特别是如果你将它与事务结合使用） - 使用 SQL 参数。您需要创建一个准备好的语句：

```
PreparedStatement preparedStatement = connection.prepareStatement("SELECT max( millisFromMid ) FROM stockInfo1 WHERE ( millisFromMid <=  34200000 + (120000)*? ) GROUP BY stockID") 
```

请注意`?`正在替换的`i`- 这是您的参数。您创建`prepareStatement` **一次**- 在循环之前，在循环内您每次设置参数并执行它：

```
for (int i=0; i< 195; i++) {
    preparedStatement.setInt(1,i); //Set the paramater to the current value of i.
    resultSet = preparedStatement.executeQuery(); //Execute the statement - each time with different value of the parameter.
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T00:33:39.937

问题 os 数据库没有被告知 i 的值。而是让 Java 将值放入字符串中，然后将其提交到数据库。

string sql = "select * from foo where bar=" + i;

您需要始终记住，数据库只知道您明确告诉它的内容，并且您实际上是在运行时编写将在另一台主机上执行的代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T00:41:39.193

您可以生成一个 sql 字符串并通过 jdbc 调用它，使用绑定变量从性能、安全性来看更正确。它还可以避免您转义任何特殊字符。

由于您正在学习将 sql 与 jdbc 一起使用，请阅读有关绑定变量的内容。一个例子是[here](http://steveracanovic.blogspot.in/2008/03/performance-using-bind-variables-in.html)

# objective-c - 检索 iTunes Track Artwork 图像时出错。有时它说它不是图像

> ID：14063080
> 
> 赞同：0
> 
> 时间：2012-12-28T00:27:44.703
> 
> 标签：objective-c, xcode, macos, cocoa, itunes

我有以下代码来检索 currentTrack 的作品（使用`iTunes.h`）：

```
iTunesArtwork *iTunesArtwork = [[iTunes.currentTrack artworks] objectAtIndex:0];
NSImage *artwork = iTunesArtwork.data;                   
if (artwork != nil){
    [_musicImageView setImage:artwork];
} 
```

它适用于大多数轨道，但有时它会给我这个错误（即使轨道有图像）：

```
NSImageCell's object value must be an NSImage.
2012-12-28 00:22:12.217 App[3256:303] (
    0   CoreFoundation                      0x00007fff904360a6 __exceptionPreprocess + 198
    1   libobjc.A.dylib                     0x00007fff8d5bf3f0 objc_exception_throw + 43
    2   CoreFoundation                      0x00007fff90435e7c +[NSException raise:format:] + 204
    3   AppKit                              0x00007fff9747c31b -[NSImageCell setObjectValue:] + 106
    4   AppKit                              0x00007fff974b8563 -[NSImageView setImage:] + 90
    5   App                                 0x0000000100001b38 -[AppDelegate setupPlayer] + 600
    6   Foundation                          0x00007fff8d10c513 __NSFireTimer + 96
    7   CoreFoundation                      0x00007fff903f2da4 __CFRUNLOOP_IS_CALLING_OUT_TO_A_TIMER_CALLBACK_FUNCTION__ + 20
    8   CoreFoundation                      0x00007fff903f28bd __CFRunLoopDoTimer + 557
    9   CoreFoundation                      0x00007fff903d8099 __CFRunLoopRun + 1513
    10  CoreFoundation                      0x00007fff903d76b2 CFRunLoopRunSpecific + 290
    11  HIToolbox                           0x00007fff939e40a4 RunCurrentEventLoopInMode + 209
    12  HIToolbox                           0x00007fff939e3e42 ReceiveNextEventCommon + 356
    13  HIToolbox                           0x00007fff939e3cd3 BlockUntilNextEventMatchingListInMode + 62
    14  AppKit                              0x00007fff97337613 _DPSNextEvent + 685
    15  AppKit                              0x00007fff97336ed2 -[NSApplication nextEventMatchingMask:untilDate:inMode:dequeue:] + 128
    16  AppKit                              0x00007fff9732e283 -[NSApplication run] + 517
    17  AppKit                              0x00007fff972d2cb6 NSApplicationMain + 869
    18  App                                 0x0000000100001822 main + 34
    19  libdyld.dylib                       0x00007fff93cb77e1 start + 0
) 
```

关于发生了什么的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T00:30:45.327

确保它是一个图像——不仅仅是检查它是否不为零，这还不够。h 文件中的类型不能是对象真正具有的类型。它更像是......它应该是一个图像：D

```
if([artwork isKindOfClass:[NSImage class]]) {
    .... 
```

* * *

从评论中。那并不总是有效。嗯。没有更多的崩溃，但有些图像没有显示。我们使用 rawData 作为后备：

```
//kind of like this
if(![artwork isKindOfClass:[NSImage class]]) {
    artwork = [[NSImage alloc] initWithData:tunesArtwork.rawData];
}
if([artwork isKindOfClass:[NSImage class]]) {
    ...
} 
```

# c++ - C++ 模板化成员函数作为另一个模板化类的接口

> ID：14063083
> 
> 赞同：3
> 
> 时间：2012-12-28T00:28:14.503
> 
> 标签：c++, templates

我想创建一个类，作为一组专用模板类的接口。例如：

```
template<typename T>
class ThingDoer {
    public:
        void Method()
        {
            // do something;
        }
};

class ThingDoerInterface {
    public:
        template<typename T>
        void Method()
        {
            // call ThingDoer<T>::Method(); somehow
        }
};

int main()
{
    ThingDoerInterface i;
    i.Method<int>();
    i.Method<char>();
    // etc.

    return 0;
} 
```

我对我想要的对象的一般要求如下所示：

*   用户只需要创建一个对象的非模板化实例。
*   但是可以存在多个实例，并且应该是独立的。
*   该对象将派生自类型 A 的（用户定义的）对象的实例与派生自类型 B 的（一个或多个）对象相关联。
*   用户可以根据A的*类型*调用对 B 执行某些操作的对象的方法。

我有一个基于`std::unordered_multimap`.

## 编辑：

这是一个更具体的例子，我希望能说明我真正想要做的事情。

```
class ABase {
    public:
        virtual ~ABase() {}
};

class A1 : public ABase {};
class A2 : public ABase {};

class BBase {
    public:
        virtual ~BBase() {}
};
class B1 : public BBase {};
class B2 : public BBase {};

class ThingDoerInterface {
    public:
        template<typename T>
        void Store(BBase* b_ptr)
        {
            // store the B pointer with the type of T as a key
            // (T will be A1 or A2)
        }

        template<typename T>
        void Recall()
        {
            // call all the stored B pointers associated with the type of T
        }
};

int main()
{
    ThingDoerInterface i;

    B1* b_one_ptr = new B1;
    B2* b_two_ptr = new B2;

    i.Store<A1>(b_one_ptr);
    i.Store<A1>(b_two_ptr);

    i.Store<A2>(b_one_ptr);

    i.Recall<A1>(); // do something with b_one_ptr and b_two_ptr
    i.Recall<A2>(); // do something with b_one_ptr

    delete b_two_ptr;
    delete b_one_ptr;

    return 0;
} 
```

我已经用 . 完成了这个`std::unordered_multimap`，但我想知道是否可以像这样存储关联：

```
template<typename T>
class ThingDoer {
    public:
        void Store(BBase* b_ptr)
        {
            b_ptrs.push_back(b_ptr);
        }

        void Recall()
        {
            // do something with the b_ptrs associated with the type of T
        }
    private:
        std::vector<BBase*> b_ptrs;
}; 
```

但以`ThingDoerInterface`某种方式这样做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T18:37:09.937

我不一定说它值得复杂，但是......

```
#include<iostream>
#include<vector>
using namespace std;

class repo {
public:
  repo(){
    id = highestid++;
  }
  template<typename T>
  T& get() {
    vector<T>& vec = data<T>::vec;
    if (vec.size() <= id) {
      vec.resize(id+1);
    }
    return vec[id];
  }
private:
  template<typename T>
  struct data {
    static vector<T> vec;
  };
  int id;
  static int highestid;
};
/*static*/ int repo::highestid = 0;
template<typename T>
/*static*/ vector<T> repo::data<T>::vec;

main(){
  repo a, b;
  a.get<int>() = 42;
  b.get<int>() = 54;
  a.get<float>() = 4.2;
  b.get<float>() = 5.4;
  cout << a.get<int>() << ", " << b.get<int>() << ", " << a.get<float>() << ", " << b.get<float>() << endl;
} 
```

我写它是为了快速查找。第一次为给定的 repo 调用 get 时，会使其他 repo 返回的所有引用无效，并且销毁 repo 不会清理任何东西。但是如果你有少量的 repos，它们的生命周期基本上是整个程序，那应该没问题。

# javascript - 我如何处理填充在我的资源中的 data:img 元素？

> ID：14063088
> 
> 赞同：0
> 
> 时间：2012-12-28T00:28:33.033
> 
> 标签：javascript, google-chrome-extension, screenshot

注意数据：img 图像...我不知道如何从内存中删除它们，并且 document.images 不包含它们...

![数据太多：img 被保存在内存中，让我放慢了速度](../Images/9e6e8f1f23955d01eba805f3a7cfe071.png)

我正在编写一个 Chrome 扩展程序。它有点像一个混合屏幕截图应用程序，基本上当用户滚动时，它会将用户滚动到的屏幕的新部分附加到整个网站的主屏幕截图上（是的，我使用过谷歌的屏幕截图应用程序）。我的代码有效，但是当我将 img 从扩展传递到内容脚本时，它将 data:img 源存储到内存中我无法访问的某个位置。我已经尝试过 document.images 并测试了它们是否可以在其中填充但没有运气。

如果您有兴趣，这是代码。

**page.js**

```
var ovr = 0;
var run = (window==window.top)?1:0;
if(run&&ovr){
function obj(){
    window.onload = function(){
        obj.conversion = .5;
        obj.screenShot();
        obj.startRecordingScroll();
        obj.showShot(); 
    };

}
obj.showShot = function(){
    obj.fullShot = document.createElement('canvas');
    obj.fullShot.zIndex = -100;
    obj.fullShot.style.position = 'fixed';
    obj.fullShot.style.top = '70px';
    obj.fullShot.style.right = '20px';
    obj.fullShot.style.backgroundColor = '#999999';
    obj.fullShot.width = window.innerWidth*obj.conversion;
    obj.fullShot.height = document.height*obj.conversion;
    document.body.appendChild(obj.fullShot);
    obj.ctx = obj.fullShot.getContext('2d');
};
obj.startRecordingScroll = function(){
    document.onscroll = function(){
        obj.scroll();
    };
};
obj.scroll = function(){
    var pagxoff = window.pageXOffset;
    var pagyoff = window.pageYOffset;
    alert(document.images.length);
    console.log("scroll");
    obj.screenShot();

};
obj.displayScreenShot = function(img){
    console.log('displayScreenShot');
    var ycur = window.pageYOffset;
    var yMaxCur = window.innerHeight+window.pageYOffset;
    var distance = yMaxCur - obj.lastMaxYSeen;
    distance = Math.abs(distance);
    if(!obj.firstRunShot){
        obj.lastMinYSeen = window.pageYOffset;
        obj.lastMinXSeen = window.pageXOffset;
        obj.lastMaxYSeen = (window.innerHeight+window.pageYOffset);
        obj.lastMaxXSeen = (window.innerWidth+window.pageXOffset);
        var shot = document.createElement('img');
        shot.src = img;
        console.log(img);
        shot.onload = function(){
            obj.ctx.drawImage(
                shot,
                0, // 0 right
                0, // 0 down
                window.innerWidth, // viewport width
                window.innerHeight, // viewport height
                0, // 0 right
                0, // 0 down
                window.innerWidth*obj.conversion,
                window.innerHeight*obj.conversion
            );
        };
        obj.firstRunShot = true;
        return;
    }

    if(obj.firstRunShot){
        if(ycur>obj.lastMinYSeen){
            obj.lastMinYSeen = window.pageYOffset;
            obj.lastMinXSeen = window.pageXOffset;
            obj.lastMaxYSeen = (window.innerHeight+window.pageYOffset);
            obj.lastMaxXSeen = (window.innerWidth+window.pageXOffset);
            var xshot = document.createElement('img');
            xshot.src = img;
            xshot.onload = function(){
                obj.ctx.drawImage(
                    xshot,
                    0,
                    window.innerHeight-distance,
                    window.innerWidth,
                    distance,
                    0,
                    (obj.lastMaxYSeen-distance)*obj.conversion,
                    window.innerWidth*obj.conversion,
                    (distance)*obj.conversion
                );
            };
            return;
        }
    }
};
obj.screenShot = function(){
    var port = chrome.extension.connect({
        name: "screenshot"
    });
    port.postMessage({
        request: "screenshot"
    });
    port.onMessage.addListener(function (msg) {
        obj.displayScreenShot(msg);
    });
    console.log('screenShot');
};

var builder = new obj();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T05:40:52.670

如果您想通过删除节点来删除某些资源修改 DOM，您可以使用 API 跟踪正在[添加](https://developer.chrome.com/extensions/devtools.inspectedWindow.html#event-onResourceAdded)的资源并[操作](https://developer.chrome.com/extensions/devtools.inspectedWindow.html#method-Resource-setContent)这些资源的所有内容。`chrome.devtools.inspectedWindow`

document.images 确实包含资源。

![在此处输入图像描述](../Images/1135f087b00efc7d239820b6b0387f39.png)

[资源面板](https://developers.google.com/chrome-developer-tools/docs/resources)允许您检查在检查页面中加载的资源，您是否将图像加载到检查页面以显示在这里？

如果您尝试使用[FILE API](http://www.html5rocks.com/en/tutorials/file/dndfiles/)将图像存储到本地磁盘，请记住它们是沙盒的，无法通过其他方式访问。

## 参考

*   [`chrome.devtools.inspectedWindow`](https://developer.chrome.com/extensions/devtools.inspectedWindow.html)
*   [`Resources Panel`](https://developers.google.com/chrome-developer-tools/docs/resources)
*   [`File API`](http://www.w3.org/TR/FileAPI/)
*   [`Content Scripts`](https://developer.chrome.com/extensions/content_scripts.html)

# wcf - 共享合约是否需要 IExtensibleDataObject 接口

> ID：14063091
> 
> 赞同：0
> 
> 时间：2012-12-28T00:28:55.560
> 
> 标签：wcf

我们正在开发供公司内部使用的 WCF 服务。实体（数据契约）位于单独的程序集中，并由服务和使用该服务的应用程序引用。

是否需要实现 IExtensibleDataObject 接口？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T01:14:37.043

否。`IExtensibleDataObject`如果您希望您的合同接收（例如，在服务调用中）比数据成员中列出的更多的数据，则使用（IEDO）。如果您在客户端和服务上都有相同的程序集，则情况并非如此。

有关 IEDO 有用的场景的更详细描述，请查看[http://blogs.msdn.com/b/carlosfigueira/archive/2011/09/27/wcf-extensibility-other-serialization-extensions.aspx](http://blogs.msdn.com/b/carlosfigueira/archive/2011/09/27/wcf-extensibility-other-serialization-extensions.aspx)上的帖子.

# android - 受插入 sql / android 影响的行数

> ID：14063093
> 
> 赞同：3
> 
> 时间：2012-12-28T00:29:01.227
> 
> 标签：android, sqlite, insert

> **可能重复：**
> [使用原始查询从 Android 中的 SQLite 获取更新的行数？](https://stackoverflow.com/questions/6659673/get-updated-rows-count-from-sqlite-in-android-using-a-raw-query)

我想获取受 sqlite`insert`命令影响的行数。我的查询看起来链接了这个：

```
String sql = "INSERT OR REPLACE INTO "+TABLE_USER+" (`...
                ")" ;

        c = myDataBase.rawQuery(sql, null); 
```

我的研究没有成功。我找到了类似`count()`sql 命令的东西，但我没有让它工作。如何获取sql`INSERT`命令的修改行数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T00:53:33.090

您应该尝试使用`changes() function`来返回受影响的行数。

“changes() 函数返回最近完成的 INSERT、DELETE 或 UPDATE 语句更改或插入或删除的数据库行数，不包括低级触发器中的语句。changes() SQL 函数是一个包装器围绕 sqlite3_changes() C/C++ 函数，因此遵循相同的规则来计算更改。” --“http://www.sqlite.org”

# solr - 如何阻止某些结果存储在 Solr 的 FilterCache 中

> ID：14063095
> 
> 赞同：1
> 
> 时间：2012-12-28T00:29:29.313
> 
> 标签：solr

我一直在 Solr 的多方面查询中使用一些过滤器。现在过滤器只使用值，但现在我必须将其扩展为多值，我认为我必须为此使用 OR。我没有进行任何性能检查，但我想知道是否有办法阻止我的过滤器查询被存储到 FilterCache？我不想缓存具有两个以上值的过滤器查询的结果。理想情况下，我想我必须依靠缓存算法做得很好，但我只是想知道。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T00:34:52.357

取自[这里](http://searchhub.org/2012/02/10/advanced-filter-caching-in-solr/)。

为了告诉 Solr 不要缓存过滤器，我们使用同样强大的本地参数 DSL，它将元数据添加到查询参数中，并用于指定不同类型的查询语法和查询解析器。对于没有任何 localParam 元数据的普通查询，只需在`cache=false`.

# android - INSERT INTO table SELECT values FROM other_table 不起作用

> ID：14063105
> 
> 赞同：0
> 
> 时间：2012-12-28T00:30:24.763
> 
> 标签：android, sqlite, android-sqlite

我正在尝试从我的数据库中删除一个表，所以我按照[官方说明](http://www.sqlite.org/faq.html#q11)进行操作。这就是我的代码的样子：

```
@Override
public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
    // A list of the values I want to preserve
    String contents = Values.KEY_ROWID + ","
            + Values.KEY_NAME + ","
            + Values.COURSE_KEY_TEACHER + ","
            + Values.KEY_DESCRIPTION + ","
            + Values.KEY_ROOM + ","
            + Values.COURSE_KEY_TIMES_OF_DAY + ","
            + Values.COURSE_KEY_COLOR;

    db.execSQL("CREATE TABLE course_backup("
        + Values.KEY_ROWID + " int, "
        + Values.KEY_NAME + " text not null, "
        + Values.COURSE_KEY_TEACHER + " text not null, "
        + Values.KEY_DESCRIPTION + " text, "
        + Values.KEY_ROOM + " int, "
        + Values.COURSE_KEY_TIMES_OF_DAY + " text, "
        + Values.COURSE_KEY_COLOR + " int not null);");
    db.execSQL("INSERT INTO course_backup SELECT "
        + contents
        + " FROM course_backup;");
    /*db.execSQL("DROP TABLE " + Values.COURSE_TABLE + ";");
    db.execSQL(Values.COURSE_DATABASE_CREATE);
    db.execSQL("INSERT INTO " + Values.COURSE_TABLE + " SELECT "
    + contents + " FROM course_backup");*/
} 
```

但是当我将数据库的副本拉到我的计算机上并查看 course_backup 表时，它完全是空的。所有列都是正确创建的，但没有一行数据。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T00:34:57.247

您正在从 course_backup 中进行选择，这是您刚刚创建的表。相当合理（假设没有插入到 course_backup 之间）这个表是空的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T00:35:08.547

您正在从空的备份表中选择行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T00:34:08.780

您缺少要插入的列。请参阅此相关讨论：[插入...值（SELECT ... FROM ...）](https://stackoverflow.com/questions/25969/sql-insert-into-values-select-from)。哦，是的，正如其他人指出的那样，您的源和目标是同一个空表。

# javascript - 将 eval 解析转换为 json.parse

> ID：14063116
> 
> 赞同：-1
> 
> 时间：2012-12-28T00:32:31.577
> 
> 标签：javascript, json

这与称为 ProcessMaker 的 BPM 应用程序有关，但逻辑和语法应该相对相同。我正在尝试从另一个已将数据传递到隐藏字段的序列化网格填充一个网格（基本上是一个表）。

传递给隐藏字段的数据格式如下：

前任：

```
{"1":{"id":"4332","product":"ball","price":"$5.00",”ordered":"On"} 
```

下面在 processmaker 的 wiki 上找到的 javascript 示例将隐藏字段反序列化为一个对象，并使用其信息填充一个新网格，无论它是什么。processmaker 的 wiki 上的示例使用 eval 函数，但您将如何使用 json.parse() 函数对其进行转换？

```
 function populateGrid() {
           var grd = getObject("newAccountsGrid");
           //remove all existing rows in the grid (except the first one): 
           var i = Number_Rows_Grid("newAccountsGrid", "accId");
           for (; i > 1; i--)
              grd.deleteGridRow(i, true);
           //The first row can't be deleted, so clear the fields in the first row:
           for (i = 0; i < grd.aFields.length; i++)
              getGridField("contactsGrid", 1, grd.aFields[i].sFieldName).value = "";
           //unserialize the hidden field as an object:
           var oAccounts = eval('(' + getField("sAccounts").value + ')'); 
           if (typeof oAccounts == 'object') { 
              for (var rowNo in oAccounts) {
                 if (rowNo != 1)
                    grd.addGridRow();
                 getGridField('newAccountsGrid', rowNo, 'accId').href = oAccounts[rowNo]["accountId"];
                 getGridField('newAccountsGrid', rowNo, 'accName').href = oAccounts[rowNo]["accountName"];
                 getGridField('newAccountsGrid', rowNo, 'createDate').href = oAccounts[rowNo]["created"];
              }
           }
        }
        populateGrid(); //execute when the DynaForm loads 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T00:48:10.023

这很简单：

```
var oAccounts = JSON.parse(getField("sAccounts").value); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T00:49:42.583

`eval("("+something+")")`⇒`JSON.parse(something)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-17T16:48:45.483

在这个例子（ProcessMaker wiki）上面几行，是一个建议使用 JSON.parse() 的注释。使用您的示例，您的代码应如下所示：

```
 function populateGrid() {
   var grd = getObject("newAccountsGrid");
   //remove all existing rows in the grid (except the first one): 
   var i = Number_Rows_Grid("newAccountsGrid", "accId");
   for (; i > 1; i--)
      grd.deleteGridRow(i, true);
   //The first row can't be deleted, so clear the fields in the first row:
   for (i = 0; i < grd.aFields.length; i++)
      getGridField("contactsGrid", 1, grd.aFields[i].sFieldName).value = "";
   //unserialize the hidden field as an object:
   var oAccounts = JSON.parse(getField("sAccounts").value); 
   if (typeof oAccounts == 'object') { 
      for (var rowNo in oAccounts) {
         if (rowNo != 1)
            grd.addGridRow();
         getGridField('newAccountsGrid', rowNo, 'accId').href = oAccounts[rowNo]["accountId"];
         getGridField('newAccountsGrid', rowNo, 'accName').href = oAccounts[rowNo]["accountName"];
         getGridField('newAccountsGrid', rowNo, 'createDate').href = oAccounts[rowNo]["created"];
      }
   }
}
populateGrid(); //execute when the DynaForm loads 
```

# django - Django：为链接到用户配置文件的数据创建表单

> ID：14063120
> 
> 赞同：0
> 
> 时间：2012-12-28T00:33:27.707
> 
> 标签：django, forms, authentication

我正在尝试使用用户作为外键的模型保存链接到用户配置文件的数据。我想不出一种方法来创建一个允许添加新数据实例而无需在表单本身中包含用户名的表单。我想要一个排除用户外键的表单。一切正常，直到我尝试将用户 ID 添加到即将保存的表单/数据中。

如何获取登录用户，在请求对象中来回传递，并在保存之前将其注入数据中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T01:58:30.670

使用表单构造函数为表单赋予初始值，例如

```
render_to_response(
'template.html', 
{"form" : MyForm(initial={"username": request.user})}, 
context_instance = RequestContext(request)
) 
```

您可以在[django 文档中阅读更多内容](https://docs.djangoproject.com/en/dev/ref/forms/api/#dynamic-initial-values)

# android - android 4.0 加载UI前出现声音

> ID：14063122
> 
> 赞同：1
> 
> 时间：2012-12-28T00:33:44.557
> 
> 标签：android, android-layout, android-activity

首先说我没有太多编程经验，这些是我在 Android 中的第一步。

我已经为 android 开发了一个应用程序，带有`minSdkVersion 8`和`targetSdkVersion 16`.

该应用程序就像一个相册，当您触摸其中一张图片时，会显示一个带有图片、文字的屏幕，并播放两种声音。您可以用手指滑动查看上一个或下一个屏幕，或使其间隔一定时间自动滑动。

我已经在模拟器中使用`android 2.2`和 在某些设备中使用`android 2.3.5`和测试了该应用程序`android 4.0.x`。

应用`android 2.2 and 2.3.5`程序正常工作，但`android 4.0.x`我检测到“手动”方式正常工作，但“自动图像滑动”不起作用。

问题是您选择了其中一张图片并且第一个活动正确运行，但是在第一个活动之后，在此活动的布局出现在屏幕上之前就听到了下一个活动的声音。如果您退出主菜单并选择其他图片，问题是一样的。您正确地看到了第一个活动，然后，声音推进了活动的形象。

我没有发现任何类似于我在这里搜索的问题。谁能帮我？

编辑显示一些代码。

onCompletion 代码：

```
public void onCompletion(MediaPlayer mp) {
    if(mp.equals(mpNom)){
        try {
            Thread.sleep (mpNom.getDuration()+500);
        } catch (InterruptedException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }           

    }else if(mp.equals(mpSo)){
        try {
            Thread.sleep (mpSo.getDuration());
        } catch (InterruptedException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
}
} 
```

该应用程序没有显示任何错误，也没有崩溃，但是当声音已经重现时，会显示 UI。

任何的想法？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T23:17:13.660

最后我解决了这个问题。

似乎问题出在 OnCompletion 方法或该方法内的代码中。

我重写了使应用程序执行相同但以不同方式（编程方式）的代码，避免了 OnCompletion 方法，现在该应用程序在 android 4.0.x 中完美运行

# python - ImportError：无法导入名称 SignedJwtAssertionCredentials

> ID：14063124
> 
> 赞同：32
> 
> 时间：2012-12-28T00:33:57.713
> 
> 标签：python, google-api, oauth-2.0

我正在尝试使用此代码通过 Python 客户端访问 google 应用程序以获得授权（显然已编辑私人信息）：

```
import gflags
import httplib2

from apiclient.discovery import build
from oauth2client.file import Storage
from oauth2client.client import SignedJwtAssertionCredentials
from oauth2client.tools import run

f = open('privatekey.p12', 'rb')
key = f.read()
f.close()
credentials = SignedJwtAssertionCredentials(
    service_account_name='name@developer.gserviceaccount.com',
    private_key=key,
    scope = 'https://www.googleapis.com/auth/calendar')
http = httplib2.Http()
http = credentials.authorize(http)
service = build(serviceName='calendar', version='v3', http=http) 
```

然而我收到这个错误：

```
ImportError: cannot import name SignedJwtAssertionCredentials 
```

我已经安装了 Google v3 API Python 客户端以及 OAuth2；我似乎对这些模块没有任何其他问题，尽管我没有太多使用它们。有谁知道发生了什么？

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2016-02-17T04:07:36.517

我今天遇到了这个问题，不得不从 oauth2client 2.0 版回滚到 1.5.2 版：

```
pip install oauth2client==1.5.2 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2013-01-04T15:01:15.073

好像你还没有安装 pyopenssl。通过安装`easy_install pyopenssl`。

```
Libraries oauth2client.client
if HAS_OPENSSL:
  # PyOpenSSL is not a prerequisite for oauth2client, so if it is missing then
  # don't create the SignedJwtAssertionCredentials or the verify_id_token()
  # method.

  class SignedJwtAssertionCredentials(AssertionCredentials):
.... 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2016-03-03T14:53:48.333

[源存储库](https://github.com/google/oauth2client)最近更新，以使用新代码：

```
from apiclient.discovery import build
from oauth2client.service_account import ServiceAccountCredentials

... 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-03-22T19:01:09.537

正如 alexander margraf 所说，您需要 PyOpenSSL 来导入 SignedJwtAssertionCredentials

简单地说： pip install pyopenssl

请记住：如果您没有安装 OpenSSL Win32 库[http://slproweb.com/products/Win32OpenSSL.html](http://slproweb.com/products/Win32OpenSSL.html)（您需要完整的软件包，而不是精简版），它将在 Windows 上失败。另请记住，在安装 pyopenssl 之前，您需要将其添加到路径变量中

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-09-17T11:48:12.020

我试图建立一个本地开发环境，但这里的解决方案都没有奏效。对我来说，难题中的额外部分是：

```
$ pip install pycrypto 
```

可能除了以下任何或全部：

```
$ pip install pyopenssl
$ pip install httplib2
$ pip install oauth2client
$ pip install ssl 
```

[GAE`pycrypto`内部有可用的包](https://cloud.google.com/appengine/docs/standard/python/tools/built-in-libraries-27)（检查你的 app.yaml 中列出的库），所以需要它的东西可能在他们的机器上工作，但不是你的机器 - 我想 - 抱歉，我还不清楚他们让生活如此美好的原因和原因对图书馆很痛苦。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-06-08T13:50:11.370

首先检查您的`oauth2client`版本。

如果此版本 >= 2.0，则使用`ServiceAccountCredentials`代替`SignedJwtAssertionCredentials`.

看三个参考：

*   问题：
    *   [https://github.com/google/oauth2client/issues/401](https://github.com/google/oauth2client/issues/401)
*   升级到 2.0
    *   [https://github.com/google/oauth2client/releases/tag/v2.0.0](https://github.com/google/oauth2client/releases/tag/v2.0.0)
*   文档
    *   [http://oauth2client.readthedocs.io/en/latest/source/oauth2client.service_account.html#module-oauth2client.service_account](http://oauth2client.readthedocs.io/en/latest/source/oauth2client.service_account.html#module-oauth2client.service_account)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-11-11T20:25:20.227

检查您的 'oauth2client' 模块版本，如果是这样，您可能正在使用高于 1.5.2 的版本，您可以通过降级版本并重新安装 1.5.2 或 'oauth2client.client.AccessTokenCredentials' 来解决此问题。文档链接[https://oauth2client.readthedocs.io/en/latest/source/oauth2client.client.html](https://oauth2client.readthedocs.io/en/latest/source/oauth2client.client.html)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-11-18T11:38:01.343

您可以为 oauth2client 版本 >= 2.0 尝试此操作，

```
from oauth2client.service_account import ServiceAccountCredentials

ServiceAccountCredentials.from_p12_keyfile(
    service_account_email='name@developer.gserviceaccount.com', 
    filename=KEY_PATH, 
    scopes='https://www.googleapis.com/auth/calendar') 
```

# zend-framework - Zend Framework：将完整页面保存到文件

> ID：14063125
> 
> 赞同：1
> 
> 时间：2012-12-28T00:33:58.233
> 
> 标签：zend-framework, layout, save, render

我需要将基于 Zend 的站点的主导航/标题添加到第三方产品的顶部。第三方产品将允许我将服务器上的任何文件包含到他们的布局中。我的想法是我会运行一个 cron，它将我的 Zend 布局的标题部分每晚保存到一个硬编码的 html 文件中。然后在第三部分读入相应的文件。

所以我尝试了：

$htmlcontent = $this->view->render('file.phtml');

然后将 $htmlcontent 保存到文件中。它正确地保存了 file.phtml 中的所有内容，但不包括我真正需要的部分布局/标题。我将如何将生成的所有内容（包括布局）保存到文件中。

谢谢夏天

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T03:04:58.857

视图脚本只是整个布局的一部分。在正常的 Zend Framework 设置中，您将有一个布局，其中您的视图脚本（例如，file.phtml）在您的情况下。布局文件将如下所示：

```
 <html>
      <body>
          <div>My header here</div>
          <?php echo $this->layout()->content; ?>
          <div>I have a footer here.</div>
      </body>
   </html> 
```

**$this->layout()->content**将根据您所在的页面保存您的视图脚本（例如，当您调用 fileAction() 时的 file.phtml）。

因此，要访问页面的完整 HTML，您有两种选择：

1.  使用旧的[file_get_contents](http://php.net/manual/en/function.file-get-contents.php)并通过 http 请求将完整呈现的 HTML 转换为字符串。

    ```
    $htmlcontent = file_get_contents('http://yourdomain/index/file'); 
    ```

2.  获取 Zend Framework 的布局实例，为其分配内容，并将其呈现为字符串，如下所示：

    ```
     $layout = $this->_helper->layout->getLayoutInstance();
     $layout->content = $this->view->render('file.phtml');
     $htmlcontent =  $layout->render(); 
    ```

# gwt - 是否可以使用 mvp4g 创建库？

> ID：14063129
> 
> 赞同：0
> 
> 时间：2012-12-28T00:34:20.013
> 
> 标签：gwt, mvp4g

我正在使用 mvp4g 创建一个 GWT 应用程序。作为应用程序的一部分，我还在另一个 gwt 模块中创建了一个库；这个库遵循 mvp4g 模式，但在这里我自己创建一切，视图、演示者、事件、处理程序。

该库用于主应用程序的不同部分。基本上，该库提供了一个主小部件，该小部件根据应用程序的部分进行配置，通过将其他小部件（来自同一库）添加到主小部件来启用功能。

此外，该库应该在其他项目中使用，因此可以创建其他小部件并将其添加到主小部件中。

所以，我想知道是否有办法使用 mvp4g 来创建这个库，或者 mvp4g 是否仅用于应用程序。是否有任何其他 mvp 库可以做到这一点？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T02:23:01.697

mvp4g 允许您按照结构化方法使用 gwt 代码进行开发。它应该可以在没有入口点的库项目中使用，就像在有入口点的项目中一样容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T02:51:32.923

可以创建一个或多个客户端库并将它们作为依赖项添加到您正在使用 GWT 编译器编译的 web 应用程序中。

请参阅`Dividing code into multiple modules`此处： [https](https://developers.google.com/web-toolkit/doc/latest/DevGuideOrganizingProjects) ://developers.google.com/web-toolkit/doc/latest/DevGuideOrganizingProjects 。

Maven 或 Gradle 是将代码收集、构建和打包成功能单元的不错选择。

# objective-c - 您如何“中止”Objective C 中的方法？

> ID：14063141
> 
> 赞同：3
> 
> 时间：2012-12-28T00:36:02.530
> 
> 标签：objective-c, cocoa-touch, ibaction, abort

我知道有办法解决这个问题，但我想知道以下问题是否可行。你能在 Objective-C 中“中止”一个方法吗？在这种情况下，它是在 Cocoa Touch 上。我有一个 IBAction。在那个动作中，我有 if/else if/else 语句。如果不是这样，我想中止该方法的其余部分。有点像返回 0，但对于 IBAction。

这可能吗？如果是这样，你将如何做到这一点。整个方法有点长，但这是我正在查看的部分：

```
if ([unitType isEqualToString:@"mg/dl"])
    {
        //Unit is mg.
        typeOfUnit = unitType;
    }
    else if ([unitType isEqualToString:@"mmol"])
    {
        //Unit is mmol
        typeOfUnit = unitType;
    }
    else
    {
        //Apparently either a bug or a (null) item.
        typeOfUnit = @"mg/dl";
        [[LEItemStore sharedStore] createItem];
        item = [[[LEItemStore sharedStore] allItems] objectAtIndex:0];
        [self loadItems:self];

        //Code to Abort the rest of the method here.
    } 
```

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-28T01:29:13.990

这很简单：

`return;`

（太简单了，没有这句话就太短了。）

# css-transitions - 尝试在 h1 类的悬停时创建 css 过渡

> ID：14063147
> 
> 赞同：0
> 
> 时间：2012-12-28T00:36:57.793
> 
> 标签：css-transitions

我以前做过这个，但它目前不起作用，我不知道为什么。我希望第一个 h1 在悬停时稍微旋转。这是我的代码

[http://jsfiddle.net/YLXtd/1/](http://jsfiddle.net/YLXtd/1/)

html

```
 <div id="headLine">
    <h1 class="fitText"><span class="highLight">Austin Kitson</span></h1>
    <h2 class="fitText"><span class="highLight">Marketing & Sales</span></h2>
  </div>
 </section> 
```

css

```
#headLine {
  position: relative;
  top: 10em;
  margin-left:auto;
  margin-right:auto;
  width:100%;
  text-align:center;
 }
  #headLine .fitText {
    -webkit-transition: 0.3s;
    -moz-transition: 0.3s;
    transition: 0.3s; 
    padding:1em;

}

  #headLine .fitText:hover {
    -moz-transform: rotate(3deg);
    -ms-transform: rotate(3deg);
    -o-transform: rotate(3deg);
    transform: rotate(3deg); }
  #headLine .highLight {
    background: rgba(151, 173, 191, 0.7);
    padding: 0.3em;
    color: #ebe6e0; } 
```

​</p>

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T01:58:47.080

哈，原来我忘记了 safari 的供应商前缀`-webkit-transform: rotate(3deg);`，我正在使用 safari，我很傻。我一直在做这些事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T10:52:47.490

使用此代码：它对我有用

```
 #headLine .fitText {
    -webkit-transition: 1.5s all ease;
            -moz-transition: 1.5s all ease;
            -o-transition: 1.5s all ease;
    transition: 1.5s all ease; 

}

  .fitText:hover {
    -webkit-transform: rotate(3deg);
        -moz-transform: rotate(3deg);
        -o-transform: rotate(3deg);
    transform: rotate(3deg); 
} 
```

这是链接[http://jsfiddle.net/YLXtd/7/](http://jsfiddle.net/YLXtd/7/)

# c - 在 C 中根据长度对向量进行排序

> ID：14063151
> 
> 赞同：0
> 
> 时间：2012-12-28T00:37:42.503
> 
> 标签：c, vector

我想制作一个程序，根据向量的长度对向量的维度和数量进行排序。大多数代码有效，但程序的排序部分无效。基本上我想做的是：比较数组 w 中 2 个位置的 bereken_lengte 函数的输出。但似乎什么也没有发生。同样在函数 bereken_lengte 中，我无法在循环结束后求和的根。

```
#include <stdio.h>
#include <stdlib.h>
#include <math.h>

double bereken_lengte(double *array, int dim)
{
  int i, j;
  double sum = 0.0;
  for(i=0; i<dim; ++i)
    sum += pow(array[i],2);
  return sum;
}

void swap(double **p, double **q)
{
  double *tmp;
  tmp = *p;
  *p = *q;
  *q = tmp;
}

void sort_vector(double *w[] , int num , int dik )
{
  int i,dim,j;
  dim = dik;
  for(i=0;i<num;++i)
    for(j = 1+i;j<num;++j)
    {
      if(bereken_lengte(w[i],dim) > bereken_lengte(w[j],dim)  )
        swap(&w[i], &w[j]);
    }
}

int main (void)
{
  int dim, num;
  int i, j,k,l;
  double **w;
  scanf ("%d %d", &dim, &num);          /* read N and M */
  w = calloc (num, sizeof (double *));  /* allocate array of M pointers */
  for (i = 0; i < num; i++)
  {
    /* allocate space for N dimensional vector */
    w[i] = calloc (dim, sizeof (double));
    /* read the vector */
    for (j = 0; j < dim; j++)
    {
      scanf ("%lf", &w[i][j]);
    }
  }
  sort_vector(w,num,dim);
  for(k=0; k<num; ++k)
  {
    printf("\n");
    for(l=0; l<dim; ++l)
      printf("%f ", w[k][l]);
  }
  return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T00:51:12.470

```
double bereken_lengte(double *array, int dim)
{
  unsigned int i;
  double sum =0.0;
  for(i=0; i<dim; ++i)
    sum += pow(array[i],2);
  return sum;
} 
```

在求和之前将总和初始化为零。

顺便说一句，我将 i 更改为未签名。IMnsvHO 对索引 && 大小变量使用无符号类型是一个好习惯（它们不会下溢，如果这样做，您会注意到它）

更新：这试图避免 int 索引和大小，并使用 qsort。（相当丑陋，因为比较函数只需要两个元素；不要在多线程程序中尝试这个......）注意，我可能有行和列互换，但这是一种生活方式...... gewoon，omdat het kan ！：

```
#include <stdio.h>
#include <stdlib.h>
#include <math.h>

double bereken_lengte(double *array, size_t dim)
{
  size_t i;
  double sum=0.0;
  for(i=0; i<dim; ++i)
    sum += pow(array[i],2);
  return sum;
}

        /* this is ugly: qsort only allows only two arguments */
static size_t ze_third_argument=0;
int srt_pdbl(void *l, void *r)
{
double **dl = l, **dr = r;
double diff;
diff = bereken_lengte( *dl, ze_third_argument) - bereken_lengte( *dr, ze_third_argument) ;
return (int) diff;
}

void sort_vector(double *w[] , size_t num , size_t dik )
{
ze_third_argument = dik;
qsort(w, num, sizeof *w, srt_pdbl );
}

int main (void)
{
  size_t dim, num;
  size_t i, j,k,l;
  double **w;
  scanf ("%zu %zu", &dim, &num);          /* read N and M */
  w = calloc (num, sizeof *w);  /* allocate array of M pointers */
  for (i = 0; i < num; i++)
  {
    /* allocate space for N dimensional vector */
    w[i] = calloc (dim, sizeof *w[i] );
    /* read the vector */
    for (j = 0; j < dim; j++)
    {
      scanf ("%lf", &w[i][j]);
    }
  }
  sort_vector(w,num,dim);
  for(k=0; k<num; ++k)
  {
    printf("\n");
    for(l=0; l<dim; ++l)
      printf("%f ", w[k][l]);
  }
  return 0;
} 
```

# javascript - 保证Javascript中的异步请求回调顺序

> ID：14063152
> 
> 赞同：6
> 
> 时间：2012-12-28T00:37:43.597
> 
> 标签：javascript, jquery, asynchronous, callback

在 Javascript 中，我有两个异步数据请求：

```
$.getJSON('http://foo.com', fooQuery, fooSuccess(data));
$.getJSON('http://bar.com', barQuery, barSuccess(data)); 
```

和两个回调来处理接收到的数据：

```
fooSuccess(data) { // Stuff }
barSuccess(data) { // More Stuff } 
```

如何确保 barSuccess 仅在 fooSuccess 完成后执行？

笔记：

*   我想保持数据请求原样：异步和非阻塞（因为服务器响应可能需要一段时间）。
*   但是，我希望处理数据的回调按顺序执行。也就是说，我不想在 fooSuccess 完成之前执行 barSuccess。

非常感谢您的智慧和帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-28T00:53:41.093

以下是使用 ajax 请求返回的 jQuery 延迟对象的方法。

```
var fooDfd = $.getJSON('http://foo.com', fooQuery);
var barDfd = $.getJSON('http://bar.com', barQuery);

fooDfd.then(function(fooData){
    fooSuccess(fooData);
    barDfd.then(barSuccess);
}); 
```

​</p>

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-28T00:55:03.360

最好的方法是`when().done()`像这样使用 jQuery 功能：

```
$.when(
    $.getJSON('http://foo.com', fooQuery, fooSuccess(data)), 
    $.getJSON('http://bar.com', barQuery, barSuccess(data))
).done(function(arg1, arg2){
    fooSuccess(arg1);
    barSuccess(arg2);
}); 
```

这允许同时执行 AJAX 请求并保证在`done()`所有请求成功完成后执行该函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-28T01:46:02.337

I'm follow this very interesting post from a half an hour ago, when appear the elegant solution presented by @Mike Brant I quickly was to dive in the jquery library to see how the magic is made. Don't you? I recommend, is very interesting! BTW I think we don't need all that magic, not in this case, we have two asynchronous calls handlers(functions), no matter which end first, we need to know when the second end, then all we need is a third function that will be called by the two handlers and act when all the data is ready. I know this approach will vaste four or five lines more of code than the elegant jquery solution, but at the end our brain and soul will be in better condition. Sorry my english.

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-12-28T00:40:49.797

将`barSuccess`调用放入`fooSuccess`成功回调中。

```
fooSuccess(data){
  jQuery.ajax({
    data: data,
    success: function(response){
      barSuccess(data) //should still be in scope, I think?
    }
  }
} 
```

# c# - 开始使用 Selenium 在文本框中输入文本时我缺少什么

> ID：14063153
> 
> 赞同：0
> 
> 时间：2012-12-28T00:37:54.267
> 
> 标签：c#, selenium

我正在尝试开始使用 Selenium。这是我的简单代码。打开 StackOverflow 并在搜索框中输入 sdf。IE 出现并导航到正确的页面。然后事情向南发展。看看输出。这是在控制台应用程序中。

更新：我查看了驱动程序中的 HTML ......它正在查看 Selenium 起始页。

代码：

```
IWebDriver _driver;
_driver = new InternetExplorerDriver();
_driver.Manage().Timeouts().ImplicitlyWait(new TimeSpan(0, 0, 30));
_driver.Navigate().GoToUrl("http://www.stackoverflow.com/");
Console.WriteLine(_driver.PageSource);
_driver.FindElement(By.Name("q")).Clear();
_driver.FindElement(By.Name("q")).SendKeys("sdf"); 
```

输出：

```
Started InternetExplorerDriver server (64-bit)
2.28.0.0
Listening on port 60181
<HTML><HEAD><TITLE>WebDriver</TITLE></HEAD>
<BODY>
<P id=main>This is the initial start page for the WebDriver server.</P></BODY></HTML>
Unable to find element with name == q
DONE 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T05:47:27.810

尝试使用其他定位器

```
By.cssSelector()

By.id()

By.xpath() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T16:16:36.077

尝试使用 xpath`//input[@name='q' and @placeholder='search']`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T09:05:04.643

这个 CSS 应该可以工作。

表单#搜索 div 输入

# c# - 显示屏幕（虚拟）键盘

> ID：14063154
> 
> 赞同：0
> 
> 时间：2012-12-28T00:38:34.550
> 
> 标签：c#, xaml, windows-8, microsoft-metro

是否可以从代码中手动显示/隐藏屏幕键盘？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T02:36:27.943

不。这是一个设计决定（[在此处](http://msdn.microsoft.com/en-us/library/windows/apps/hh465404.aspx#user-driven_invocation)记录），让最终用户控制被调用的键盘。因此，最终用户必须触摸文本框（或类似物）来调用虚拟屏幕键盘。

从那个链接：

> “触摸键盘的调用模型旨在让用户控制键盘。用户向系统表明他们希望通过点击输入控件来输入文本，而不是让应用程序代表他们做出决定。这将意外调用键盘的情况减少到零，这可能是 UI 流失的痛苦来源，因为键盘可以占用高达 50% 的屏幕并损害应用程序的用户体验。为了启用用户驱动调用，我们跟踪最后一次触摸事件的坐标，并将它们与当前具有焦点的元素的边界矩形的位置进行比较。如果该点包含在边界矩形内，则调用触摸键盘。
> 
> 这意味着应用程序无法通过焦点操作以编程方式调用触摸键盘。”

# java - 用Java绘制方阵

> ID：14063155
> 
> 赞同：1
> 
> 时间：2012-12-28T00:38:35.907
> 
> 标签：java, matrix

我正在练习 Java swing。我创建了一个矩阵作为二维`Rectangle2D`对象数组。我已将 设置`MouseListener`为绘制被点击的正方形。我已经设置了 for 循环来检查单击了哪个方块。当我点击一个正方形时，它被涂成蓝色。问题是，当我点击另一个方块时，第一个变成白色，另一个变成蓝色。我的问题是，如何保持第一次点击的方块的颜色？

这是类的代码`Matrica(Matrix)`（它是我的母语，`crtanjeMatrice`意思是.`drawMatrix``duzina``length`

```
public class Matrica extends JPanel implements MouseListener {
Rectangle2D[][] matrica = new Rectangle2D[8][8];
Color boja = Color.white;
int a = 0;
int b = 0;

    public Matrica() {
        addMouseListener(this);
    }

    public void paint(Graphics g){
        Graphics2D g2 = (Graphics2D)g;
        g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
        g2.clearRect(0, 0, this.getWidth(), this.getHeight());
        crtanjeMatrice(g2);
        g2.setColor(boja);
        g2.fill(matrica[a][b]);

    }

    private void crtanjeMatrice(Graphics2D g2){
        g2.setColor(Color.black);
        int startX = 0;
        int startY =0;
        int duzina = 50;
        for(int i=0; i < matrica.length; i++){
            for(int j = 0; j < matrica.length; j++){
                matrica[i][j] = new Rectangle2D.Double(startX,startY,duzina,duzina);
                g2.draw(matrica[i][j]);
                startX = startX + duzina;
            }
            startY = startY + duzina;
            startX = 0;
        }

    }

    @Override
    public void mouseClicked(MouseEvent e) {
    }

    @Override
    public void mousePressed(MouseEvent e) {
        int m,n;
        int x = e.getX();
        int y = e.getY();
        for(int i = 0; i < matrica.length; i++)
        for(int j =0; j < matrica.length; j++)
            if(matrica[i][j].contains(x, y)){
                boja = Color.blue;
                a = i;
                b = j;
                repaint();
            }
    }

    @Override
    public void mouseReleased(MouseEvent e) {
    }

    @Override
    public void mouseEntered(MouseEvent e) {
    }

    @Override
    public void mouseExited(MouseEvent e) {
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T02:25:09.840

您当前正在方法中绘制单个矩阵单元`paint`：

```
g2.fill(matrica[a][b]); 
```

但是您需要“记住”单击了哪些矩形。为此，`List`可以使用一个简单的方法来存储已单击矩形的索引。基于类的`Point`类提供了一种在列表中存储*行列*索引信息的好方法。

```
@Override
protected void paintComponent(Graphics g) {
   super.paintComponent(g);
   Graphics2D g2 = (Graphics2D) g;
   g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
   g2.clearRect(0, 0, this.getWidth(), this.getHeight());
   crtanjeMatrice(g2);
   for (MyRowColumn index : indexList) { // MyRowColumn based on Point
     g2.setColor(Color.blue);
     g2.fill(matrica[index.x][index.y]);
   }
} 
```

* * *

*除了：*，不要使用 override `paint`， override`paintComponent`而是记住调用 `super.paintComponent`来渲染子组件。

# xcode - 快照屏幕在哪里？

> ID：14063156
> 
> 赞同：1
> 
> 时间：2012-12-28T00:38:36.133
> 
> 标签：xcode, snapshot

我有两个要在 Xcode 中比较的快照（在 Xcode 中使用 File、Create Snapshot 创建）。我阅读的文档显示了如何通过在快照窗口中选择它们来比较快照，但它没有解释如何进入快照窗口。它在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T00:43:32.080

单击管理器。选择项目。下面列出了快照。

# ruby-on-rails - 无法从其他方法输出 flash msg

> ID：14063162
> 
> 赞同：0
> 
> 时间：2012-12-28T00:39:59.583
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我尝试使用另一个函数/方法来重定向和输出通知，但它不起作用。它在自己的功能内工作正常。

```
 def delete_sb
    # @sb = SasaranBaru.find(params[:id])
    # @sb.destroy
    flash[:notice] = "fffff"
    render_group("flash msg")
  end

  def render_group(notice)
    logger.debug notice
    flash[:notice] = notice
    if params[:filter]
      filter = prepare_filter_query(params[:filter])
      redirect_to "/groups?#{filter.to_query}", notice: 'okokoko okokokok '
    else
      redirect_to "/groups", notice: 'hehehehe eheheheh'
    end
  end 
```

在我看来，闪光灯没有任何价值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T02:09:28.157

这段代码之后是否有重定向？flash 只对一个请求有效，然后消失。

一种测试方法是使用：

```
flash.keep[:notice]='ffffff' 
```

看看是否出现了，但我怀疑你正在通过另一个控制器`/group`并再次重定向，失去闪光。

# jquery - 悬停函数 addClass

> ID：14063168
> 
> 赞同：0
> 
> 时间：2012-12-28T00:40:51.080
> 
> 标签：jquery

```
$("table.table").hover(function() {
  $('.main-head').toggleClass("hovered");
}); 
```

这段代码确实有效。尽管它使我所有的`.main-head`元素都发生了变化，但有什么办法可以解决这个问题，只改变最近的元素？我尝试添加 a`.closest()`甚至 a `.each(function(){`，也许我没有正确编写它们，并且在看到它们不起作用后我将它们扔掉了。

有什么建议么？基本标记（只是写下我的头顶）

```
<div class="main-head">
   <div class="title">
     <h2>TITLE</h2>
     </div>
</div>
  <div class="main-content">
   <table class="table">
     <tr>
       <td></td>
     </tr>
   </table>
 </div> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-28T00:42:50.167

```
$("table.table").hover(function() {
    $(this).closest('.main-head').toggleClass("hovered");
}); 
```

[**演示**](http://jsfiddle.net/rWG78/)

* * *

**更新**

对于更改的标记

```
$("table.table").hover(function() {
    $(this).parent().prev('.main-head').toggleClass("hovered");
}); ​ 
```

[**演示**](http://jsfiddle.net/rWG78/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T00:48:51.190

如果它是您想要切换的第一个元素，那么您可以添加类似这样的内容；

```
 $('.main-head:first').toggleClass("hovered"); 
```

# c++ - 检查所选数组中是否存储了任何内容？C++

> ID：14063170
> 
> 赞同：0
> 
> 时间：2012-12-28T00:41:12.547
> 
> 标签：c++, arrays

```
#include <iostream> 
#include <string>
#include <math.h> 
#include <fstream>
using namespace std;

int main()
{
    int i;
    string information[10][7];

    //This bit should check if theres anything stored currently.
    cout << "\nWhich Slot would you like to store the informaton in ?(1-10)";
    cin >> i;
    i--;

    //input
    for (int j=0;j<7;j++)
    {
        switch(j+1)
        {
        case 1:
            cout << "\nFirst Name: ";
            break;
        case 2:
            cout << "\nLast Name: ";
            break;
        case 3:
            cout << "\nAge: ";
            break;
        case 4:
            cout << "\nEmail: ";
            break;
        case 5:
            cout << "\nDoor Number: ";
            break;
        case 6:
            cout << "\nRoad Name: ";
            break;
        case 7:
            cout << "\nPost Code: ";
            break;
        default:
            ;
        }

        cin >> information[i][j];
    }

    // output
    for (int j=0;j<7;j++)
    {   
        switch(j+1)
        {
        case 1:
            cout << "\nFirst Name: ";
            break;
        case 2:
            cout << "\nLast Name: ";
            break;
        case 3:
            cout << "\nAge: ";
            break;
        case 4:
            cout << "\nEmail: ";
            break;
        case 5:
            cout << "\nDoor Number: ";
            break;
        case 6:
            cout << "\nRoad Name: ";
            break;
        case 7:
            cout << "\nPost Code: ";
            break;
        default:
            ;
        }       

        cout << information[i][j];
    }
    system("PAUSE");

    return 0;
} 
```

基本上问题是我将如何处理这段代码来检查用户选择的数组是否已经存储了信息？我如何检查。另外我想知道我如何通过输入他们的年龄来搜索用户的详细信息，例如即使我使用了字符串是可能的还是我必须使用 int。？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T00:45:56.493

使用 bool 数组可能会产生一些开销，但如果您也在执行删除操作，则可能会有所帮助：

```
bool stored[10] = {false};

/* ... */

do {
  cout << "\nWhich Slot would you like to store the informaton in ?(1-10)";
  cin >> i;
  i--;
} while (stored[i]);

stored[i] = true; 
```

当然，您可以定义一个包含 7 个字符串成员和一个布尔值用于此信息的类/结构。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T01:57:37.757

使用`string::length`函数 ( `information[1].length()`) 怎么样？如果它返回 0，那么它还没有被初始化。

只需进行比较即可找到某些东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T00:51:00.520

让我们从这样一个事实开始，即您的代码看起来像您的数组一样，您有十个 7 个字符长的字段。即使我们交换它，名称或电子邮件地址只有 10 个字符是相当短的。我的姓是 9 个字母，我见过比这更长的名字。

最后是你的问题。您可以使用 perreal 建议的方法。但我可能会简单地做`if (string[i][0] == "") ... stuff to do when it's empty ...;`。

# delphi - Cookie 过期 Indy

> ID：14063172
> 
> 赞同：1
> 
> 时间：2012-12-28T00:41:26.167
> 
> 标签：delphi, delphi-xe2, indy10, delphi-xe3

最近我发现在调用 IDHTTP.GET 后**我得到了****EConvertError**。我分析了流量，发现 cookie 上的过期日期是 2000。现在我的问题是如何绕过它。我正在使用 XE3 中的 Indy10。我知道 Indy 遵循关于 cookie 处理的严格标准，但不应该有一个功能来关闭它吗？

**网址：** [https ://graph.facebook.com/me?access_token=ACCESS_TOKEN](https://graph.facebook.com/me?access_token=ACCESS_TOKEN)

**堆栈跟踪：**

```
:75a5c41f KERNELBASE.RaiseException + 0x58
System.SysUtils.ConvertErrorFmt($412994,(...))
System.SysUtils.StrToInt('')
IdGlobal.IndyStrToInt('')
IdGlobalProtocols.RawStrInternetToDateTime('',0)
IdGlobalProtocols.GMTToLocalDateTime('')
IdHTTPHeaderInfo.TIdEntityHeaderInfo.ProcessHeaders
IdHTTPHeaderInfo.TIdResponseHeaderInfo.ProcessHeaders
IdHTTP.TIdHTTPProtocol.RetrieveHeaders(???) 
```

**响应标头：**

```
(Status-Line)   HTTP/1.1 200 OK
Access-Control-Allow-Origin *
Cache-Control   private, no-cache, no-store, must-revalidate
Content-Type    text/javascript; charset=UTF-8
ETag    "676c539ac3cd7161f5492ce95d72d8b620c6fa6c"
Expires Sat, 01 Jan 2000 00:00:00 GMT
Last-Modified   2012-12-20T20:08:20+0000
P3P CP="Facebook does not have a P3P policy. Learn why here: http://fb.me/p3p"
Pragma  no-cache
X-FB-Rev    702819
X-UA-Compatible IE=edge,chrome=1
Set-Cookie  m_ts=deleted; expires=Thu, 01-Jan-1970 00:00:01 GMT; path=/; domain=.facebook.com; httponly
Set-Cookie  reg_ext_ref=deleted; expires=Thu, 01-Jan-1970 00:00:01 GMT; path=/; domain=.facebook.com
Set-Cookie  reg_fb_gate=deleted; expires=Thu, 01-Jan-1970 00:00:01 GMT; path=/; domain=.facebook.com
Set-Cookie  reg_fb_ref=deleted; expires=Thu, 01-Jan-1970 00:00:01 GMT; path=/; domain=.facebook.com
X-FB-Debug  kZmwuLCRhfhJBKfLoQEbTOBJNyKQGUKLEeJ2R2rcxXg=
Date    Fri, 28 Dec 2012 10:02:19 GMT
Connection  keep-alive
Content-Length  1932 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T19:10:19.460

有问题的日期/时间字符串不是来自 cookie，因为您显示的调用堆栈中不包含`TIdCustomHTTP.ProcessCookies()`、`TIdCookieManager.AddServerCookies()`和方法。`TIdCookie.ParseServerCookie()`实际上是`Last-Modified`标题有问题。Facebook 正在发送一个 ISO 8601 格式的日期，HTTP 规范不支持该日期。这是 Facebook 的 HTTP 服务器中的一个错误。他们应该知道最好不要对 HTTP 日期标头使用不符合标准的格式。该错误需要向 Facebook 报告，以便他们修复。与此同时，我已经签入了[对最新 Indy SVN 快照](http://www.indyproject.org/Sockets/Docs/Indy10Installation.EN.aspx)的更新，因此`TIdHTTP`现在可以解析 ISO 8601 日期。

# java - 爪哇玩！启动问题

> ID：14063185
> 
> 赞同：0
> 
> 时间：2012-12-28T00:43:56.160
> 
> 标签：java, playframework-2.0

当我第一次在我的项目上运行 eclipsify 时，我注意到 Eclipse 抱怨：

```
return ok(index.render("Your new application is ready.")); 
```

线。它不承认索引方法。该应用程序仍在运行，因此我暂时忽略了它。但是，现在我遇到了一个新错误。我想我刚刚向 Mongo 添加了一些依赖项，附加了一些模型文件并重新构建，但我现在收到此错误：

> 编译：sbt.InvalidComponent：找不到所需的组件'compiler-interface-src'

我不确定为什么会发生这种情况，尤其是因为我有点像白痴。作为旁注，Eclipse 报告我的“classes_managed”构建路径条目丢失，但我认为这是由于我在清理后无法编译。（清理和更新工作正常）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T10:26:51.167

1) 模板由 Play 编译，而不是 eclipse。在“eclipsify”之后，您需要运行`play compile`（或`play run`）并刷新您的 eclipse 项目。请参阅[如何让 Eclipse 看到 Play 中的更改！编译模板？](https://stackoverflow.com/questions/10042987/how-to-make-eclipse-see-the-changes-in-play-compiled-templates)

2）添加依赖后，启动新的时间`play eclipsify`命令。但我认为这不是问题。**您添加的依赖项是什么？你的 Play2 版本是什么？**（我怀疑与 Play2.1 库不兼容）

供您参考，一般规则：Play 不依赖 Eclipse 来编译文件。不要尝试在 eclipse 中清理，而是运行`play clean`（并刷新 eclipse）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-12-29T22:21:34.267

碰巧遇到这个问题几次，在上面尝试过，也遵循
[基于清理播放框架的项目](https://stackoverflow.com/questions/9841024/clean-up-play-framework-based-project)

但没有任何效果。

What it turned out to be was a IntelliJ Idea **cache corruption** issue, and *invalidate and restart* Idea worked fine.

# ruby-on-rails - 向 Ruby on Rails 服务器应用程序发布 json 请求 - 500 错误

> ID：14063186
> 
> 赞同：2
> 
> 时间：2012-12-28T00:43:56.870
> 
> 标签：ruby-on-rails, json, httprequest

我有一个 Ruby on Rails 服务器应用程序（托管在 Heroku 上），它应该能够接收带有 JSON 字符串的 HTTP POST 请求并将 JSON 对象添加到数据库中。有两种数据库模型：感恩节和请求。

控制器/request_controller.rb：

```
class RequestsController < ApplicationController
  [...]
  # POST /requests
  # POST /requests.json
  def create
    @request = Request.new(params[:request])

    respond_to do |format|
      if @request.save
        format.html { redirect_to @request, notice: 'Request was successfully created.' }
        format.json { render json: @request, status: :created, location: @request }
      else
        format.html { render action: "new" }
        format.json { render json: @request.errors, status: :unprocessable_entity }
      end
    end
  end
[...]
end 
```

对于感恩节数据库模型和请求数据库模型，不同数据库模型对象值的 JSON 键应分别为“thanks”和“request”。

模型/request.rb：

```
class Request < ActiveRecord::Base
  attr_accessible :request
end 
```

模型/感恩节.rb：

```
class Thanksgiving < ActiveRecord::Base
  attr_accessible :thanks
end 
```

[当我向http://YADA.herokuapp.com/thanksgivings.json](http://YADA.herokuapp.com/thanksgivings.json)发布 HTTP 请求时，一切正常，但是当我将其发送到 .../requests.json 时，出现 500 错误。如果我在 JSON 字符串中使用了错误的键，则请求成功，但值变为空。

请求 1：（对 Thanksgiving.json 的正确请求）
POST
主机： http: [//YADA.herokuapp.com/thanksgivings.json](http://YADA.herokuapp.com/thanksgivings.json)
内容类型：application/json 正文
：{"thanks":"qwerty"}

请求 2：（对 request.json 的正确请求 - 返回 500）
POST
主机：http: [//YADA.herokuapp.com/requests.json](http://YADA.herokuapp.com/requests.json)
内容类型：application/json 正文
：{"request":"qwerty"}

请求 3：（错误的键 - 将成功：值将为空，键将是“请求”作为响应，将添加数据库元素）
POST
主机：http: [//YADA.herokuapp.com/requests.json](http://YADA.herokuapp.com/requests.json)
内容类型：应用程序/json 正文
：{"abc":"qwerty"}

奇怪的是，这两个控制器，Thanksgivings_controller.rb 和 requests_controller.rb，是“相同的”，但它们的行为不同。

任何人都知道如何成功地做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T22:41:26.757

根据服务器日志，有一个 NoMethodError – stringify_keys。这个问题的答案是解决方案：[undefined method `stringify_keys'](https://stackoverflow.com/questions/8514970/undefined-method-stringify-keys)

更改
`@request = Request.new(params[:request])`
为
`@request = Request.new(:request => params[:request])`
成功了。

# c# - 检查按钮的颜色并使用二维数组更改它

> ID：14063191
> 
> 赞同：2
> 
> 时间：2012-12-28T00:44:41.590
> 
> 标签：c#, arrays, winforms, visual-studio-2010, multidimensional-array

我正在创建一个小游戏，就像游戏 Reversi/Othello 我已经设法创建了一个带有按钮的 2x3 棋盘。

这些按钮会更改您单击它们的颜色，但我无法检测两种黑色之间是否有白色，如果有，请将白色变为黑色。我希望这是有道理的。按钮位于二维数组中。任何可以帮助我做到这一点的建议将不胜感激。

图片：

![在此处输入图像描述](../Images/4acd15ccb90f4bd026dd89bb3a213eee.png) 这是我的代码：

```
![namespace reversitest
{
    public partial class Form1 : Form
    {

        private Button\[,\] squares;
        public Form1()
        {
            InitializeComponent();

            squares = new Button\[3, 2\];
            squares = new Button\[,\] {{button1,  button2,  button3},
                {button4,  button5,  button6,}};
        }

        private void Form1_Load(object sender, EventArgs e)
        {
            foreach (Button sqrr in squares)
            {
                sqrr.Click += new System.EventHandler(this.DrawCharacter);
            }
        }
        int _turn = 0;
        private void DrawCharacter(object sender, EventArgs e)
        {
            Button sqrr = (Button)sender;
            int col = 0;

            if (sqrr.BackColor.Equals(Color.Black) || sqrr.BackColor.Equals(Color.White))
            {
                MessageBox.Show("Move Not Allowed!");
            }
            else 
            {
               for ( int i = 0; i < squares.GetLongLength(1); ++i)
               {

                  // check othere squares and change color
                   if (i < 2)
                   {
                       for (int f = 0; f < 3; ++f)
                       {
                           var ss = squares\[i, f\];
                           if (ss.BackColor.Equals(Color.Black))
                           {

                               MessageBox.Show("we have a black");

                               //ss = squares\[i, f+1\];
                               ss.BackColor = Color.Black;

                           }
                           else
                           {
                               MessageBox.Show("no black");
                           } 
                       }

                   }

                       if (_turn == 0)
                       {
                           _turn = 1;
                           sqrr.BackColor = Color.Black;

                       }
                       else
                       {
                           _turn = 0;
                           sqrr.BackColor = Color.White;

                       } 

               }

            }

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T05:26:53.533

首先使用数组索引命名您的按钮。它将帮助您找到按钮。
例如，根据您的图片 button1 名称将是 btn_1_1。

然后在您的按钮单击事件中首先获取按钮名称，然后识别定位的按钮。

```
 Button b = sender as Button;
        string[] btnData = b.Name.Split('_');
        int x = int.Parse(btnData[1]);
        int y = int.Parse(btnData[2]);

        //check for possible combinations 
        int top = y - 2;
        int botton = y + 2;

        int left = x - 2;
        int right = x + 2;

        if (top >= 0 && squares[top, y].Background == Color.Black)
        {
            squares[top+1, y].Background = Color.Black;
        }  
        ...  
        ... 
```

继续这样。如果您需要更多详细信息，请随时询问。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T18:56:52.223

最终答案

```
//check for possible combinations 
            int top = x - 2;
            int botton = x + 2;

            int left = y - 2;
            int right = y + 2;

            if (top >= 0 && squares[top, y].BackColor == Color.Black)
            {
                squares[top + 1, y].BackColor = Color.Black;
            }
            else if (left >= 0 && squares[x, left].BackColor == Color.Black)
            {
                squares[x, left + 1].BackColor = Color.Black;
            }

            else if (left >= 0 && squares[x, left].BackColor == Color.Black)
            {
                squares[x, left + 1].BackColor = Color.Black;
            } 
```

稍后将扩展为 8x8 板

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T03:38:46.967

你需要它优雅吗？一种蛮力法：你可以检查8个不同方向的碎片，它们有可能对齐。例如，您从黑色棋子开始。朝一个方向检查下一块。如果它是白色的，请继续并记下白色的位置，以便稍后将其更改为黑色。当您最终击中黑色棋子时，将所有存储的位置更改为黑色并继续前进到下一个方向并重复该过程，直到您完成所有 8 个方向。

# ant - 来自ant的sshexec中的bash脚本中的变量

> ID：14063194
> 
> 赞同：1
> 
> 时间：2012-12-28T00:44:50.427
> 
> 标签：ant

我对 sshexec 任务中的变量有疑问。我的 build.xml 蚂蚁脚本看起来像：

```
<?xml version="1.0" encoding="UTF-8"?>
<project name="sshexecproject" basedir="." default="build">
<target name="build">
    <sshexec 
        host="192.168.2.106" 
        username="root" 
        password="xxx" 
        commandResource="${basedir}/to_run.sh" 
        trust="true"
        verbose="true"
        failonerror="true"
    />
</target> 
```

在 to_run 脚本中，我有两个变量：

```
#!/bin/bash

name="Pink Panther"
export name2="Panther Pink"

echo "Name: "
echo $name
echo "Name with export: "
echo $name2 
```

如果我在终端上运行脚本，我会得到以下输出：

```
$ ./to_run.sh 
Name: 
Pink Panther
Name with export: 
Panther Pink 
```

我们可以看到一切正常。但是，如果我从 ant 启动 build.xml 脚本，我会得到以下输出：

```
...
[sshexec] Authentication succeeded (password).
[sshexec] cmd : #!/bin/bash
[sshexec] cmd : 
[sshexec] cmd : name="Pink Panther"
[sshexec] cmd : export name2="Panther Pink"
[sshexec] cmd : 
[sshexec] cmd : echo "Name: "
[sshexec] Name: 
[sshexec] cmd : echo $name
[sshexec] 
[sshexec] cmd : echo "Name with export: "
[sshexec] Name with export: 
[sshexec] cmd : echo $name2
[sshexec] 
[sshexec] Disconnecting from ... 
```

我们可以看到在远程服务器上这个脚本创建了一个空的回显。变量名和name2没有填写。为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T02:12:03.197

更改此行：

```
commandResource="${basedir}/to_run.sh" 
```

至

```
command="${basedir}/to_run.sh" 
```

结果如下：

```
[sshexec] Authentication succeeded (password).
[sshexec] cmd : /data/tmp/anttest/to_run.sh
[sshexec] Name:
[sshexec] Pink Panther
[sshexec] Name with export:
[sshexec] Panther Pink 
```

`commandResource`获取一个包含命令列表的资源文件并单独执行每一行，`bash -c $LINE`因此定义的任何变量仅在同一行上有效。`command`在同一个 shell 中执行整个脚本。

# python - Python 3：获取字符串中出现的倒数第二个索引

> ID：14063195
> 
> 赞同：13
> 
> 时间：2012-12-28T00:44:59.333
> 
> 标签：python, python-3.x

我有一个字符串`abcdabababcebc`如何获取倒数第二个出现的索引`b`？我搜索并找到了 rfind() 但这不起作用，因为它是最后一个索引，而不是倒数第二个。

我正在使用 Python 3。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-28T00:49:56.140

这是一种方法：

```
>>> def find_second_last(text, pattern):
...   return text.rfind(pattern, 0, text.rfind(pattern))
... 
>>> find_second_last("abracadabra", "a")
7 
```

这使用可选的 start 和 end 参数在找到第一个匹配项后查找第二个匹配项。

注意：这不会进行任何类型的完整性检查，如果文本中没有至少 2 次出现模式，则会爆炸。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-12-28T00:47:53.033

```
>>> s = "abcdabababcebc"
>>> s[:s.rfind("b")].rfind("b")
9 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-12-28T00:49:02.847

枚举所有索引并选择你想要的

```
In [19]: mystr = "abcdabababcebc"

In [20]: inds = [i for i,c in enumerate(mystr) if c=='b']

In [21]: inds
Out[21]: [1, 5, 7, 9, 12]

In [22]: inds[-2]
Out[22]: 9 
```

# ruby-on-rails - 在 Ruby on Rails 中将 HH:MM 时间转换为十进制 before_save

> ID：14063196
> 
> 赞同：3
> 
> 时间：2012-12-28T00:45:02.143
> 
> 标签：ruby-on-rails, ruby

我的数据库中有一个十进制数据类型的**持续时间字段。**

我的表格接受**小数**（例如 1.5 小时），但我也希望能够接受**HH:MM**（例如 1:30 表示一小时三十分钟）。

我希望能够`before_save`在我的模型中使用正则表达式检测 HH:MM 并将其转换为十进制，以便用户可以输入十进制或 HH:MM。这部分很好，但我遇到的问题是针对字段中的值测试正则表达式。

1:30 被解释为数据类型`--- !ruby/class 'BigDecimal'`，我无法针对正则表达式对其进行测试。

对其`.to_s`进行操作会将其转换为 1.0

**如何让我的十进制类型字段放松并让我将其值转换为字符串以在我的模型中进行正则表达式测试？**

这是我的代码：

```
# --- Model ---
before_save :convert_duration

def convert_duration
  if duration =~ /^([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$/
    time_pieces = duration.split(":")
    hours = time_pieces[0].to_i
    minutes = (time_pieces[1].to_f/60.0)

    # Final value ready for database
    self.duration = (hours+minutes).round(1)
  end
end 
```

*红宝石 1.9.3；导轨 3.2.8*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T01:27:12.507

`duration_before_type_cast`当您想要访问原始字符串时使用该属性。

文档：[http ://api.rubyonrails.org/classes/ActiveRecord/Base.html#label-Accessing+attributes+before+they+have+been+typecasted](http://api.rubyonrails.org/classes/ActiveRecord/Base.html#label-Accessing+attributes+before+they+have+been+typecasted)

# jquery - Jquery关于焦点事件委托

> ID：14063199
> 
> 赞同：6
> 
> 时间：2012-12-28T00:45:35.197
> 
> 标签：jquery

由于某些奇怪的原因，这个简单的功能似乎不起作用：

```
$("body").on("focus", this, function(){
    alert('d');
}) 
```

`this`是输入或文本区域元素。

如果我这样做：

```
$(this).on("focus", function(){
    alert('d');
}) 
```

它适用于目前存在的那些元素，但我的事件不会在新创建的元素上触发，我做错了什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-28T00:56:51.190

正如 API 所描述的，第二个参数是**“一个选择器字符串，用于过滤触发事件的选定元素的后代”。**

我假设`this`，在你的情况下，是一个 DOM 元素。尝试将其更改为选择器以匹配输入或文本区域。这将导致每当`focus`事件`body`从与您的选择器匹配的元素冒泡时调用您的函数。这应该适合你：

```
$("body").on("focus", "input, textarea", function() {
    alert('d');
}); 
```

更多信息在`on()`这里：[http ://api.jquery.com/on/](http://api.jquery.com/on/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T01:12:21.563

正如@grantman16 提到的，第二个参数必须是选择器，

但是如果它是一个新创建的元素，为什么不使用[focus()](http://api.jquery.com/focus/)。

```
​va​r input = $("<input>");
input.focus(function() {
  alert('d');
});
$("body").append(input);​
​ 
```

[示例-1](http://jsfiddle.net/Ut3Jp/)

你不需要使用`.on`，但如果你坚持使用它，你应该设置一个选择器作为第二个参数，

```
var input = $("<input>").addClass("lastInput");
$("body").on("focus", "input.lastInput", function() {
  alert('d');
});
$("body").append(input);
​ 
```

[示例-2](http://jsfiddle.net/Ut3Jp/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T00:53:31.707

你想要这样的东西：

```
$(document).ready(function() {
    $("body").on("focus", 'textarea, input', function(){
       console.log('d');
    })​
}); 
```

# c# - 常量字符串数组

> ID：14063203
> 
> 赞同：38
> 
> 时间：2012-12-28T00:46:19.923
> 
> 标签：c#, .net, arrays, string, constants

> **可能重复：**
> [声明一个常量数组](https://stackoverflow.com/questions/5142349/declare-a-const-array)

我需要一个类中的 const 字符串数组。就像是

```
public class some_class_t
{
    public const string[] names = new string[4]
    {
        "alpha", "beta", "gamma", "delta"
    };
} 
```

但是这段代码会导致错误：

> 引用类型“string[]”的常量“names”只能用 null 初始化。

我该怎么办？

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2012-12-28T00:49:07.853

将其声明为，`readonly`而不是`const`：

```
public readonly string[] names = { "alpha", "beta", "gamma", "delta" }; 
```

# .net - 正则表达式需要解析出几个变量的值

> ID：14063210
> 
> 赞同：0
> 
> 时间：2012-12-28T00:47:13.080
> 
> 标签：.net, regex

我正在尝试从以下示例中检索所有变量值的列表：

```
JobName :: Variable1 = 1 | Variable2 = 2 | Variable3 = 3 
```

我想帮助从上述变量返回值 1 2 和 3

我正在尝试进行以下工作，但到目前为止非常不成功！不确定如何在正则表达式中正确使用 OR 和 AND 符号。

```
(<?<=\s*=\s*).+ | \n 
```

基本上，正则表达式应该匹配等号之后的任何内容，并继续匹配到 PIPE 和/或 END OF THE LINE。

另一个例子：

```
JobName :: Variable1 = 123456 234567 | Variable2 = asdf q s | Variable3 = as123!@#/*() 
```

正则表达式将返回： 123456 234567 ， asdf qs ， as123!@#/*()

请注意：我只需要返回 [= 和 |] 或 [= 和 \n] 之间的内容

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T01:06:13.953

我不了解 .net，但我在 ruby​​ 中尝试过这个并且效果很好：

```
=\s([^\|]*)\s?\|? 
```

它将捕获三个变量（或者更多，如果你有更多）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T01:06:41.673

```
 string a = "JobName :: Variable1 = 123456 234567 | Variable2 = asdf q s | Variable3 = as123!@#/*()";

        MatchCollection mc = Regex.Matches(a, "Variable.+?=(.+?)([|]|$)");
        foreach (Match item in mc)
        {
            string res = item.Result("$1");
        } 
```

或者您甚至可以跳过“变量”并仅用`"=(.+?)([|]|$)"`作模式

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T01:09:37.733

这是一个非常简单的解决方案，可以像您想要的那样提取变量/值：

```
(?<variable>[^| :=\r\n]+)\s*=(?<value>[^|\r\n]+) 
```

演示+说明：[http ://regex101.com/r/mC8jR2](http://regex101.com/r/mC8jR2)

# hadoop - 在 mapreduce 中重用可写对象

> ID：14063212
> 
> 赞同：4
> 
> 时间：2012-12-28T00:47:50.763
> 
> 标签：hadoop, mapreduce

我试图找到重用可写对象与在 wordcount mapreduce 程序中创建新对象的性能优势。然而，无论输入数据有多大，这两个版本几乎都需要相同的时间来完成。

我还尝试通过更改为任务提供较低的堆空间，

```
<property>
    <name>mapred.child.java.opts</name>
    <value>-Xmx120m</value>
</property> 
```

但是与更高的堆空间相比，这两个版本的运行速度都慢了一点。我永远无法获得重用可写文件以更好地执行的程序。我在这里错过了什么吗？

我修改的字数部分，

```
public void map(Object key, Text value, Context context
                ) throws IOException, InterruptedException {
  StringTokenizer itr = new StringTokenizer(value.toString());
  while (itr.hasMoreTokens()) {
    context.write(new Text(itr.nextToken()), new IntWritable(1));
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T09:27:34.467

这不是什么大问题，原因有两个：

1.  你这样做`IO`很**慢**，所以在每个输入行创建一些新对象并让它被垃圾收集并不是什么大不了的事。
2.  最有可能的是，无论如何，您的内存占用量非常低。所以如果你创建对象，只要超过一定的内存阈值，它们就会被存储在堆内存中。因此，您的其他解决方案可能比其他解决方案占用更多的堆内存。如果您现在降低堆内存，则`Garbage Collector`必须更频繁地运行，因为阈值超出的频率更高。如果你打开它，你会在 GC 日志中看到它。

另一个原因可能是您测量时间的方式，a`Map task`涉及到大量的 RPC 通信在后面，因此您不能总是 100% 确定您的数据没有受到网络拥塞或其他环境影响的影响。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T01:01:35.120

问题是这里的性能瓶颈，或者哪个对性能的影响更大，可重用的 IntVariable 或 IO。

重用变量理论上更好，但基于阿姆达尔定律[http://en.wikipedia.org/wiki/Amdahl%27s_law](http://en.wikipedia.org/wiki/Amdahl%27s_law)，改进可能甚至不明显。

# php - 在 SQL 中整理一系列数字（id）的最佳方法是什么

> ID：14063220
> 
> 赞同：-1
> 
> 时间：2012-12-28T00:48:45.583
> 
> 标签：php, sql, math, logic

我在数据库中有以下系列：

```
9, 10, 10, 12, 12, 13, 15, 15, 18, 18, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28 
```

我想让它们都独一无二（因为它们应该是）。谁能建议解决这个问题的最佳方法是什么？使用 php 代码是可以的（也是首选），但我不能手动执行此操作，因为我的数据库中有数百万行。为了更清楚一点，结果系列应如下所示：

```
9, 10, 11, 12, 13, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T00:52:02.493

有几种简单的方法可以做到这一点：

```
SELECT DISTINCT the_number_column
FROM your_table
ORDER BY the_number_column; 
```

或者：

```
SELECT the_number_column
FROM your_table
GROUP BY the_number_column
ORDER BY the_number_column; 
```

最小的性能差异（至少使用 Oracle）：[http ://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:32961403234212](http://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:32961403234212)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T00:53:08.843

您可以使用 sql 选择所有唯一的记录

```
select distinct column from table order by column; 
```

# objective-c - 什么是objective-c中的“to the power of”符号

> ID：14063242
> 
> 赞同：22
> 
> 时间：2012-12-28T00:51:31.337
> 
> 标签：objective-c, symbols

对于我正在制作的程序，我需要符号的幂，但是当我尝试使用通用符号（^）时，它无法识别？

谁能告诉我用什么符号代替？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-12-28T00:55:53.513

没有战俘符号。使用 C 函数 pow(x,y)；

```
double res = pow(5.0,2.0); //25 
```

* * *

BSD 库函数手册

名称： pow -- 幂函数

概要：

```
 #include <math.h>

 double pow(double x, double y); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-28T00:55:39.590

使用“pow”功能。`pow(4,3)`给你四的三次方。

# r - 如何为具有百分比的多个变量创建堆积条形图

> ID：14063244
> 
> 赞同：2
> 
> 时间：2012-12-28T00:51:32.727
> 
> 标签：r, ggplot2

**我正在尝试创建一个包含多个**变量的堆积条形图，但我遇到了两个问题：

1）我似乎无法让旋转的 y 轴显示百分比而不是计数。

2）我想根据“非常同意”响应的百分比对变量（desc）进行排序。

这是我到目前为止的一个例子：

```
require(scales)
require(ggplot2)
require(reshape2)

# create data frame
  my.df <- data.frame(replicate(10, sample(1:4, 200, rep=TRUE)))
  my.df$id <- seq(1, 200, by = 1)

# melt
  melted <- melt(my.df, id.vars="id")

# factors
  melted$value <- factor(melted$value, 
                         levels=c(1,2,3,4),
                         labels=c("strongly disagree", 
                                  "disagree", 
                                  "agree", 
                                  "strongly agree"))
# plot
  ggplot(melted) + 
    geom_bar(aes(variable, fill=value, position="fill")) +
    scale_fill_manual(name="Responses",
                      values=c("#EFF3FF", "#BDD7E7", "#6BAED6",
                               "#2171B5"),
                      breaks=c("strongly disagree", 
                               "disagree", 
                               "agree", 
                               "strongly agree"),
                      labels=c("strongly disagree", 
                               "disagree", 
                               "agree", 
                               "strongly agree")) +
    labs(x="Items", y="Percentage (%)", title="my title") +
    coord_flip() 
```

我要感谢几个人帮助我走到这一步。以下是 Google 提供的众多页面中的一些：

[http://www.r-bloggers.com/fumblings-with-ranked-likert-scale-data-in-r/](http://www.r-bloggers.com/fumblings-with-ranked-likert-scale-data-in-r/)

[创建堆叠条形图，其中每个堆栈都缩放为总和为 100%](https://stackoverflow.com/questions/9563368/create-stacked-percent-barplot-in-r)

```
sessionInfo()
R version 2.15.0 (2012-03-30)
Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] reshape2_1.2.2  ggplot2_0.9.2.1 scales_0.2.2   

loaded via a namespace (and not attached):
 [1] colorspace_1.2-0    dichromat_1.2-4     digest_0.6.0        grid_2.15.0         gtable_0.1.1        HH_2.3-23          
 [7] labeling_0.1        lattice_0.20-10     latticeExtra_0.6-24 MASS_7.3-22         memoise_0.1         munsell_0.4        
[13] plyr_1.7.1          proto_0.3-9.2       RColorBrewer_1.0-5  rstudio_0.97.237    stringr_0.6.1       tools_2.15.0 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-28T03:19:43.387

由于您使用的是李克特数据，您可能需要考虑`likert()`包 HH 中的函数。（希望可以将您指向另一个方向，因为已经有一个很好的答案来解决您原来的 ggplot2 方法。）

正如人们可能希望的那样，`likert()`以一种与李克特相称的方式进行情节，并尽量减少斗争。`PositiveOrder=TRUE`将按照项目在正方向上延伸的距离对项目进行排序。该`ReferenceZero`参数将允许您通过中性项目的中间进行零中心（下面不需要，但[在此处显示](https://stackoverflow.com/a/13706851/1700987)）。并将`as.percent=TRUE`计数转换为百分比并在边距中列出实际计数（除非我们将其关闭）。

```
library(reshape2)
library(HH)

# create data as before
my.df <- data.frame(replicate(10, sample(1:4, 200, rep=TRUE)))
my.df$id <- seq(1, 200, by = 1)

# melt() and dcast() with reshape2 package
melted <- melt(my.df,id.var="id", na.rm=TRUE)
summd <- dcast(data=melted,variable~value, length) # note: length()
                                                   # not robust if NAs present

# give names to cols and rows for likert() to use
names(summd) <- c("Question", "strongly disagree", 
                              "disagree", 
                              "agree", 
                              "strongly agree")
rownames(summd) <- summd[,1]  # question number as rowname
summd[,1] <- NULL             

# plot
likert(summd,
       as.percent=TRUE,       # automatically scales
       main = NULL,           # or give "title",
       xlab = "Percent",      # label axis
       positive.order = TRUE, # orders by furthest right
       ReferenceZero = 2.5,   # zero point btwn levels 2&3
       ylab = "Question",     # label for left side
       auto.key = list(space = "right", columns = 1,
                     reverse = TRUE)) # make positive items on top of legend 
```

![在此处输入图像描述](../Images/f4e57ff916d24f8e073334086cfc91d3.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-28T01:49:11.657

对于 (1)
要获得百分比，您必须创建一个`data.frame`from `melted`。至少这是我能想到的方式。

```
# 200 is the total sum always. Using that to get the percentage
require(plyr)
df <- ddply(melted, .(variable, value), function(x) length(x$value)/200 * 100) 
```

然后提供计算出的百分比，如下所示`weights`：`geom_bar`

```
ggplot(df) + 
geom_bar(aes(variable, fill=value, weight=V1, position="fill")) +
scale_fill_manual(name="Responses",
                  values=c("#EFF3FF", "#BDD7E7", "#6BAED6",
                           "#2171B5"),
                  breaks=c("strongly disagree", 
                           "disagree", 
                           "agree", 
                           "strongly agree"),
                  labels=c("strongly disagree", 
                           "disagree", 
                           "agree", 
                           "strongly agree")) +
labs(x="Items", y="Percentage (%)", title="my title") +
coord_flip() 
```

我不太明白（2）。你想（a）计算`relative percentages`（参考为“强烈同意”吗？或者（b）你是否希望情节总是显示“强烈同意”，然后“同意”等。你可以通过只是完成（b）重新排序 df 中的因子，

```
df$value <- factor(df$value, levels=c("strongly agree", "agree", "disagree", 
                 "strongly disagree"), ordered = TRUE) 
```

`Edit:`您可以按照您需要的顺序重新排列级别`variable`和`value`顺序，如下所示：

```
variable.order <- names(sort(daply(df, .(variable), 
                     function(x) x$V1[x$value == "strongly agree"] ), 
                     decreasing = TRUE))
value.order <- c("strongly agree", "agree", "disagree", "strongly disagree")
df$variable <- factor(df$variable, levels = variable.order, ordered = TRUE)
df$value <- factor(df$value, levels = value.order, ordered = TRUE) 
```

# javascript - 拦截 Jquery AJAX 请求以插入其他变量？

> ID：14063248
> 
> 赞同：5
> 
> 时间：2012-12-28T00:52:10.730
> 
> 标签：javascript, jquery, ajax

有什么方法可以拦截通过 jquery 发出的 ajax 请求，将其他变量插入其中？

我知道[。](http://api.jquery.com/ajaxStart/)变量写入其内容，然后提交。

这是用于无法直接更改自己的代码的 3rd 方软件的插件。

编辑：似乎[.ajaxSetup()](http://api.jquery.com/jQuery.ajaxSetup/)允许您设置一些与 ajaxRequests 相关的全局变量。如果我注册了一个 beforeSend 功能，该功能是否能够取消满足某些条件的请求以创建不同的请求？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-28T01:09:14.807

想通了，这是我使用的代码：

```
jQuery(document).ready(function()
{    
    var func = function(e, data) 
    {       
        //data.data is a string with &seperated values, e.g a=b&c=d&.. . 
        //Append additional variables to it and they'll be submitted with the request:      
        data.data += "&id=3&d=f&z=y";
        return true;
    };
    jQuery.ajaxSetup( {beforeSend: func} );
    jQuery.post('example.php', {a : 'b'}, 'json');    
} ); 
```

要取消请求，返回 false from`func`似乎可行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-03-12T05:33:28.873

有[两种方法可以拦截 ajax 调用](http://myprogrammingnotes.com/intercept-ajax-calls-jquery.html)并向其中插入附加数据：javascript 方法和 jQuery 方法：

javacript 方法

```
(function(send) {
    XMLHttpRequest.prototype.send = function(body) {
        var info="send data\r\n"+body;
        alert(info);
        send.call(this, body);
    }; 
```

jQuery 方法

```
$.ajaxSetup({
    beforeSend: function (xhr,settings) {
        alert(settings.data);
        alert(settings.url);
    }
}); 
```

# jquery - 更改背景图像，淡出旧图像两次然后淡入新图像

> ID：14063251
> 
> 赞同：0
> 
> 时间：2012-12-28T00:53:05.027
> 
> 标签：jquery

我有以下代码：

```
$('.active-bean-bag ul li').hover(function() { 
    var activeBeanBag = 'menu-' + $(this).attr("class");
    $('.active-bean-bag img.menu-image').fadeOut();
    $('.active-bean-bag img.menu-image').fadeIn(function(){
            $('.active-bean-bag img.menu-image').attr("src", '/images/'+activeBeanBag+'.png');
    });
}); 
```

但是，当我将鼠标悬停在不同的`LI`位置上时，它看起来像是在旧图像上淡出两次，然后淡入淡出，然后淡出增益然后淡入新图像？任何想法为什么？

更新：

```
$('.active-bean-bag ul li').mouseover(function() { 
    var activeBeanBag = 'menu-' + $(this).attr("class");
    var newImage = '/skins/temaplate/customer/images/'+activeBeanBag+'.png';
    var $img = $('.active-bean-bag img.menu-image');
    if ($img.attr('src') != newImage) {
        $img.fadeOut(function() {
            $(this).attr("src", newImage).fadeIn();
        });
    }
});​ 
```

也尝试了相同的结果：

```
$(".active-bean-bag ul li").hover(function(e) {
    e.preventDefault();
        var activeBeanBag = 'menu-' + $(this).attr("class");
    $('.active-bean-bag img.menu-image').fadeOut(400, function() {
                $('.active-bean-bag img.menu-image').attr('src','/skins/template/customer/images/'+activeBeanBag+'.png');
        }).fadeIn(400);
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T01:25:44.090

试试这个：

```
$('.active-bean-bag ul li').mouseover(function() { 
    var activeBeanBag = 'basn0g' + $(this).attr("class");
    var newImage = 'http://www.schaik.com/pngsuite/'+activeBeanBag+'.png';
    var $img = $('.active-bean-bag img.menu-image');
    if ($img.attr('src') != newImage) {
        $img.fadeOut(function() {
            $(this).attr("src", newImage).fadeIn();
        });
    }
});​ 
```

在这里摆弄：http: [//jsfiddle.net/grantman16/XPthr/4/](http://jsfiddle.net/grantman16/XPthr/4/)

当您只使用一个参数悬停时，您将函数绑定到 mouseenter 和 mouseleave 事件。这就是为什么它消失了两次。请参阅此处的文档：http: [//api.jquery.com/hover/](http://api.jquery.com/hover/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T01:39:10.440

调用`fadeIn()`和`fadeOut()`同时运行，为不透明度而战。相反，将您的`fadeIn()`调用链接到以下回调`fadeOut()`：

```
$('.active-bean-bag ul li').hover(function() { 
var activeBeanBag = 'basn0g' + $(this).attr("class");
$('.active-bean-bag img.menu-image').fadeOut(function(){
    $('.active-bean-bag img.menu-image').attr("src", 'http://www.schaik.com/pngsuite/'+activeBeanBag+'.png');
    $('.active-bean-bag img.menu-image').fadeIn();
}); 
```

});​</p>

就像在这个 jsfiddle 中一样：http: [//jsfiddle.net/XPthr/5/](http://jsfiddle.net/XPthr/5/)。（我还将`src`分配更改为 before`fadeIn()`以便它淡入并显示新图像。

# html - 在 html 中显示 html

> ID：14063256
> 
> 赞同：3
> 
> 时间：2012-12-28T00:53:26.227
> 
> 标签：html

我有一个 html 页面，我想在其中包含另一个有很多链接的 html 页面。我能够使用 iframe 实现它，但我希望 iframe 内的页面具有与原始页面相同的文本和链接颜色属性，并且我不想要滚动条，我只想完全显示链接页面（大约 700 行链接），有一个限制，我只能看到 38 行没有滚动条的链接。

没有iframe有什么办法吗？或者我可以对 iframe 进行其他调整吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T00:55:58.113

查看[jQuery .load()](http://api.jquery.com/load/)以使用请求的 HTML 加载 div。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-28T01:37:31.467

```
<style>
div.frame{
    width:50%;
    height:50%;
    border:solid #000 1px;
}
</style>

<div class="frame"></div>

<script type="text/javascript">
$('document').ready(function(){
    $('div.frame').load('/links/links1.html');
});
</script> 
```

只需链接一个 jquery 库即可使其工作:) 希望这会有所帮助..

# python - Eclipse 导入错误 Django

> ID：14063261
> 
> 赞同：-1
> 
> 时间：2012-12-28T00:54:15.463
> 
> 标签：python, django, eclipse

我有一个用 Notepad++ 开发的 Django 程序，但现在我已经为 Eclipse 安装了 Pydev，所以，我想在 Eclipse 中开发这个程序。

我在购物车文件夹下有 cart.py 和 views.py 模块，但是当我在 views.py 文件中导入购物车模块时，我收到一个错误--Unresolved import:cart --- on the views.py 文件导入语句..任何帮助，将不胜感激。

购物车.py

```
from cart.models import CartItem
from catalog.models import Product
from django.shortcuts import get_object_or_404
from django.http  import HttpResponseRedirect
import decimal
import random
CART_ID_SESSION_KEY = 'cart_id'
#get the current users cart id,set new one if blank
def _cart_id(request):
    print 'Get Cart Id'
    if request.session.get(CART_ID_SESSION_KEY,'') == '':
        print 'Failing here start'
        request.session[CART_ID_SESSION_KEY] = _generate_cart_id()
        print 'Failing here End'

    return request.session[CART_ID_SESSION_KEY]
#
def _generate_cart_id():
    print 'Generate cart id'
    cart_id = ''
    characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890!@#$%^&*()' 
    cart_id_length = 50 
    for y in range(cart_id_length):
        cart_id += characters[random.randint(0,len(characters)-1)]
    return cart_id
#return all items form the current users cart
def get_cart_items(request):
    return CartItem.objects.filter(cart_id =_cart_id(request))
#add an item to the cart
def add_to_cart(request):
    postdata = request.POST.copy()
    #get product slug from post.data, return blank if empty
    product_slug = postdata.get('product_slug','')
    #get quantity added,return 1 if empty
    quantity = postdata.get('quantity',1)
    #fetch the product or return a missing page error
    p = get_object_or_404(Product, slug=product_slug)
    #get producsts in cart
    cart_products = get_cart_items(request)
    #check to see if the item is already in cart
    product_in_cart = False
    for cart_item in cart_products:
        if cart_item.product.id == p.id:
            cart_item.augment_quantity(quantity)
            product_in_cart = True
    if not product_in_cart:
        ci = CartItem()
        ci.product = p
        ci.quantity = quantity
        ci.cart_id = _cart_id(request)
        ci.save()
def cart_distinct_item_count(request):
    return get_cart_items(request).count() 
```

视图.py

```
import decimal
from django.shortcuts import render_to_response
from django.template import RequestContext
from ..cart import cart
from django.shortcuts import get_object_or_404

def show_cart(request, template_name="cart/cart.html"): 
     if request.method == 'POST': 
          postdata = request.POST.copy() 
          if postdata['submit'] == 'Remove': 
               cart.remove_from_cart(request) 
          if postdata['submit'] == 'Update': 
               cart.update_cart(request) 
     cart_items = cart.get_cart_items(request) 
     page_title = 'Shopping Cart'    
     cart_subtotal = cart.cart_subtotal(request) 
     return render_to_response(template_name, locals(),
          context_instance=RequestContext(request)) 

def get_single_item(request, item_id): 
     return get_object_or_404(CartItem, id=item_id, cart_id=_cart_id(request))  

# update quantity for single item 
def update_cart(request): 
     postdata = request.POST.copy() 
     item_id = postdata['item_id'] 
     quantity = postdata['quantity'] 
     cart_item = get_single_item(request, item_id) 
     if cart_item:
    if int(quantity) > 0: 
               cart_item.quantity = int(quantity) 
               cart_item.save() 
        else: 
               remove_from_cart(request) 

# remove a single item from cart 
def remove_from_cart(request): 
     postdata = request.POST.copy() 
     item_id = postdata['item_id'] 
     cart_item = get_single_item(request, item_id) 
     if cart_item: 
          cart_item.delete() 

# gets the total cost for the current cart 
def cart_subtotal(request): 
     cart_total = decimal.Decimal('0.00') 
     cart_products = get_cart_items(request) 
     for cart_item in cart_products: 
          cart_total += cart_item.product.price * cart_item.quantity 
     return cart_total 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T00:58:20.060

`..`前面的可能是在`from ..cart import cart`惹你。这意味着`cart.py`应该比`views.py`从您的问题得出的目录级别高一级 - 并非如此。

# .htaccess - .htaccess 从一个子目录重写到另一个

> ID：14063268
> 
> 赞同：0
> 
> 时间：2012-12-28T00:55:25.053
> 
> 标签：.htaccess, mod-rewrite

我有以下文件：

`/forums/faq.php`-- 在[http://www.domain.com/forums/faq.php](http://www.domain.com/forums/faq.php)

我希望将此文件的调用（通常以 faq.php?faq=faqname 的形式完成）重写为：

`/faq/faqname`-- 在[http://www.domain.com/faq/faqname](http://www.domain.com/faq/faqname)

我一直在尝试以下 .htaccess 规则无济于事。在我的根 .htaccess 上：

```
RewriteRule ^forums/faq.php?faq=(.*)$ faq/$1 [L,R=301]
RewriteRule ^faq$ faq/ [L,QSA,R=301] 
```

在我的 /forums/.htaccess 上：

```
RewriteRule ^faq.php?faq=(.*)$ http://www.domain.com/faq/$1 [L,R=301] 
```

我可以在这里忽略一些非常明显的东西吗？我的语法关闭了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T01:31:29.793

1.  您可以`/forums/`放弃 htaccess 中的规则，那里的规则优先于文档根目录中的规则。你在这两个地方都不需要它们。

2.  如果他们按照您的意愿行事，您的规则将导致重定向循环。

您无法匹配 a 中的查询字符串`RewriteRule`，因此第一条规则不会匹配任何内容。您真正想要做的是匹配实际请求。

```
# redirect /forums/faq.php?faq=faqname to /faq/faqname
RewriteCond %{THE_REQUEST} \ /forums/faq\.php\?faq=([^&\ ]+)
RewriteRule ^forums/faq.php$ /faq/%1? [L,R=301] 
```

然后你需要在内部把它改回来

```
RewriteRule ^faq/(.+)$ /forums/faq.php?faq=$1 [L,QSA] 
```

# javascript - 如何使用数组中的特定数据 - click 示例

> ID：14063279
> 
> 赞同：0
> 
> 时间：2012-12-28T00:56:24.427
> 
> 标签：javascript, jquery, html, click

我有以下 JQuery 代码：

```
var test = new Array();

    $(".quiz_list_row").each(function(index){
            // Gets the data necessary to show game chosen
            $quiz_list_id = $(this).data("quizlistId");
            $quiz_level_reached = $(this).data("quizlevelReached");

                test.push($quiz_list_id,$quiz_level_reached);

            $(this).click(function(){
                alert("test: "+test);
            });

    }); 
```

div（使用 html5 发送数据）：

```
<div class="quiz_list_row" data-quizlist-id="1" data-quizlevel-reached="5">
    <div class="inline quiz_list_cell" id="quiz_list_cell_row0_id1">Quiz 1</div>
    <div class="inline quiz_list_cell" id="quiz_list_cell_row0_id2">Current level: 5</div>
</div>
<div class="quiz_list_row" data-quizlist-id="2" data-quizlevel-reached="7">
    <div class="inline quiz_list_cell" id="quiz_list_cell_row1_id1">Quiz 2</div>
    <div class="inline quiz_list_cell" id="quiz_list_cell_row1_id2">Current level: 7</div>
</div> 
```

`test`问题是当用户单击特定行（我想使用`$quiz_list_id`and `$quiz_level_reached`）时，我需要找出如何使用数组中的数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T01:32:28.637

除非有特定原因您要提取属性并将它们放入数组中，否则我认为您正在采取一些不必要的步骤来实现您想要的。消除这方面的复杂性，您可以随时使用该`.data()`方法访问数据属性，您可以访问元素 jQuery 对象，其中一个时间是在单击处理程序本身内。

```
var quizRows = $(".quiz_list_row");

quizRows.click(function(event) {

    var self = $(this);

    //As the element clicked on has it's data attributes defined
    //You would just need to retrieve it when the element is clicked on
    var id = self.data('quizlist-id'),
        level = self.data('quizlevel-reached');

    console.log("id is " + id);
    console.log("level is " + level);
} 
```

# javascript - 使用 Ajax 加载页面 - 不使用 Jquery

> ID：14063285
> 
> 赞同：1
> 
> 时间：2012-12-28T00:57:40.383
> 
> 标签：javascript

有人可以告诉我通过 AJAX 加载页面的基本语法，只使用 javascript——而不是 jquery？加载（）方法？

```
xmlhttp=new XMLHttpRequest(); 
```

我从这里去哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T01:23:07.990

您将在没有 jQuery 的情况下编写更多行，在 jQuery 中它将在 2 行中完成。

无论如何，这是代码

**没有 jQuery**

```
var xmlhttp = new XMLHttpRequest();
xmlhttp.onreadystatechange = function()
{
   if (xmlhttp.readyState == 4)
   {
        alert(xmlhttp.responseText);
    }
}
xmlhttp.open('GET', 'http://www.google.com', true);
xmlhttp.send(null); 
```

如果你想做一些 POST 的东西

```
xmlhttp.open("POST",'http://www.google.com', true);
xmlhttp.send(); 
```

您还需要检查 IE

请参阅此链接以了解更多信息 - [XMLHttpRequest](https://developer.mozilla.org/en-US/docs/DOM/XMLHttpRequest/Using_XMLHttpRequest)

**与 jQuety**

```
$.get('http://www.google.com', function(responseText) {
    alert(responseText);
}); 
```

# jquery - 包含另一个帖子 url 的 AJAX 帖子数据

> ID：14063287
> 
> 赞同：0
> 
> 时间：2012-12-28T00:58:20.977
> 
> 标签：jquery, ajax, post

通常，当您发布帖子时，数据看起来像这样：“var1=value1&var2=value2&var3=value3”，但我希望我的 url var 本身包含一个帖子 url。话虽如此，ajax 将我希望在 url 变量中的值解释为单独的变量和值。在我的 run.php 脚本中，我希望能够抓取 $_POST["url"]，而不必抓取 $_POST["fish"] 和 $_POST["dog"]。

此外，我不能只是连接 run.php 中的变量，因为变量名称会有所不同......

```
var dataString = 'url=http://somewhere.com/tuna?fish=x&dog=y';

$.ajax({
    type: "POST",
    url: "/php/run.php",
    data: dataString,
    ...
}); 
```

任何帮助表示赞赏。谢谢！

让我知道是否需要进一步解释——正如你所知，我很难解释这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T01:23:25.587

试试这个

```
var dataString = 'url=http://somewhere.com/tuna?fish=x&dog=y';

$.ajax({
type: "POST",
url: "/php/run.php",
data: {url:dataString},
dataType: "json",
success:function(data){
  res = $.parseJSON(data);
  if(res.reply == 1)
    alert('I got the url');
  else
    alert('Something went wrong');
},
}); 
```

在你的 php 中：

```
<?php
if($_POST['url'] != '')
  echo json_encode(array('reply'=>1));
else
  echo json_encode(array('reply'=>0));
?> 
```

# ruby-on-rails-3 - 在使用“范围”验证唯一性时出错后在两个表单字段上显示错误

> ID：14063288
> 
> 赞同：1
> 
> 时间：2012-12-28T00:58:46.617
> 
> 标签：ruby-on-rails-3, simple-form

我有一个模型

```
attr_accessible :name, :activity

validates :name, uniqueness: { scope: :activity } 
```

它有效，并且不允许创建重复条目。但是使用 simple_form 它只显示`:name`字段上的错误。我希望它在两个字段上都有错误，表明这个“名称”和“活动”组合已经被采用。

我在想我需要创建一个自定义验证方法，但我希望有一个更优雅的解决方案，到目前为止我已经忽略了。

有没有办法在这两个字段上显示错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T05:33:57.607

您可以在 :activity 上添加另一个验证，以便它也将被标记为重复：

```
validates :activity, uniqueness: { scope: :name } 
```

我不确定这是最优雅的解决方案，但它会为您节省自定义验证方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T14:19:49.123

我最终做了

```
validates :name, uniqueness: { scope: :activity, message: 'This name and activity combination has already been taken.' } 
```

我还没有决定是否要让它同时验证两个字段并将消息放在两个字段上，但是字段的反面`:activity`是相同的。

# json - 在没有 shell 访问权限的 Web 主机上安装 JSON.pm

> ID：14063290
> 
> 赞同：1
> 
> 时间：2012-12-28T00:59:28.770
> 
> 标签：json, perl, cpan, perl-module

我的主机 (iPage) 没有安装 JSON.pm。我不想使用他们已安装的模块 (XML) 将数据从 CGI 脚本传输回网页。无论如何我可以使用 JSON 而无需他们在 Perl 上安装它？

我问的原因是因为我注意到当我下载 JSON zip 时，我必须运行 makefile json.pm 命令，但我无法访问 Unix shell 或 SSH 终端。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-28T01:58:16.270

如果您的 Perl 足够新，5.14 及更高版本，它将附带[JSON::PP](https://metacpan.org/module/JSON%3a%3aPP)，这是 JSON 解析器的纯 Perl 实现。令人困惑的是，它没有随 JSON.pm 一起提供。所以试着`use JSON::PP`看看它是否有效。

否则，请遵循 Ilmari 的指示。如果您切换到具有 shell 访问权限的主机，则可以使用[local::lib](https://metacpan.org/module/local%3a%3alib)来管理 CPAN 模块。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-28T01:56:11.767

您应该能够安装[JSON 模块的纯 Perl 版本的](http://search.cpan.org/~makamaka/JSON-2.53/)本地副本，而无需访问 shell。只需将`.tar.gz`存档下载到您自己的计算机上，解压缩并将`lib`子目录下的所有内容复制到您的虚拟主机上的合适位置即可。

* * *

您还需要告诉 Perl 在哪里可以找到模块，为此您需要知道将模块复制到的文件系统路径。例如，如果您将`lib`目录的内容复制到`/home/username/perl-lib`您的虚拟主机上，那么您将在代码中包含以下行：

```
use lib '/home/username/perl-lib';
use JSON; 
```

根据您的虚拟主机的配置方式，您可能还可以使用`$ENV{HOME}`获取主目录的路径，以便您可以编写：

```
use lib "$ENV{HOME}/perl-lib";
use JSON; 
```

或者您可以尝试使用[FindBin 模块](http://perldoc.perl.org/FindBin.html)查找包含您的脚本的目录的路径，并从那里找到该`lib`目录（请参阅 FindBin 文档中的示例）。

# asp.net-mvc - 未找到与请求 URI 匹配的 HTTP 资源

> ID：14063292
> 
> 赞同：6
> 
> 时间：2012-12-28T01:00:15.760
> 
> 标签：asp.net-mvc, asp.net-web-api

我刚刚将我的 MVC 应用程序部署到一个子域，但我无法让 webapi 工作。

本地访问：localhost:40052/api/apiEmpreendimento/GetObjects 工作正常，但在线访问以下内容： [http ://subdomain.mysite.com/api/apiEmpreendimento/GetObjects](http://subdomain.mysite.com/api/apiEmpreendimento/GetObjects)

给我

{"Message":"未找到与请求 URI 'http://subdomain.mysite.com/api/apiEmpreendimento/GetObjects' 匹配的 HTTP 资源。"}

App_Start/WebApiConfig.cs

```
public static class WebApiConfig
{
    public static void Register(HttpConfiguration config)
    {
        config.Routes.MapHttpRoute(
            name: "DefaultApi",
            routeTemplate: "api/{controller}/{action}/{id}",
            defaults: new { action = "get", id = RouteParameter.Optional }
        );
    }
} 
```

非常感谢任何提示。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-01T20:16:56.517

我认为这是关于新的 WepApi。MVC 理解它就像 WebApi 控制器，微软为自己保留 Api 控制器，我用 MyApiController 更改了我的控制器名称并解决了问题。

# mysql - 根据现有值随机化主键

> ID：14063293
> 
> 赞同：2
> 
> 时间：2012-12-28T01:00:24.473
> 
> 标签：mysql, sql, shuffle

我有一个较旧的数据库（出于一些非常可疑和晦涩的原因，我不想在这里过多地讨论主题）我想随机化或随机化主键。

我现在在 Mysql 数据库表中有自动增量字段。

我没有很多关系，那些存在的没有定义为外键。不需要保留这些关系。

我正在寻找的只是获取主键的当前值并将其替换为以下随机值：

```
ID := new(ID) 
```

新函数从具有 1:1 匹配的所有 OLD id 集合中返回一个值。例如

```
2 := 3
3 := 2 
```

但不是

```
2 := 3
3 := 3 
```

有没有办法通过（理想情况下）每个表的单个 SQL 查询来更改数据库中的数据？

*编辑：*我没有非常严格的要求。如果有帮助，考虑对数据库进行独占访问，包括来回更改对主键的约束，例如更改表、执行操作、将表更改为以前的模式。也可以为新的（或旧的）PK 值添加另一列。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-28T01:42:47.980

只是过程的一个缩影。创建两个临时表

```
CREATE TABLE temp_old
( ai INT NOT NULL AUTO_INCREMENT
, id INT NOT NULL
, PRIMARY KEY (ai)
, INDEX old_idx (id, ai)
) ENGINE = InnoDB ;

CREATE TABLE temp_new
( ai INT NOT NULL AUTO_INCREMENT
, id INT NOT NULL
, PRIMARY KEY (ai)
, INDEX new_idx (id, ai)
) ENGINE = InnoDB ; 
```

将不同顺序的值复制`id`到两个表中（随机在第二个表中）：

```
INSERT INTO temp_old
  (id)
SELECT id
FROM tableX 
ORDER BY id ;

INSERT INTO temp_new
  (id)
SELECT id
FROM tableX 
ORDER BY RAND() ; 
```

然后我们删除主键：

```
ALTER TABLE tableX
  DROP PRIMARY KEY ; 
```

运行实际`UPDATE`语句：

```
UPDATE tableX AS t
  JOIN temp_old AS o
    ON o.id = t.id
  JOIN temp_new AS n
    ON n.ai = o.ai
SET t.id = n.id ; 
```

然后重新创建主键并删除临时表：

```
ALTER TABLE tableX
  ADD PRIMARY KEY (id) ; 

DROP TABLE temp_old ;
DROP TABLE temp_new ; 
```

在**[SQL-Fiddle中测试](http://sqlfiddle.com/#!2/15769/1)**

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-28T01:35:13.107

这是一种按表格顺序创建您的 id 列表的技术，以及从 1 开始的序列号，它还以随机顺序创建您的 id 列表，以及从 1 开始的序列号。然后它根据与序号相匹配。

rand() 的排序性能存在问题（而且是随机性）。

如果您的键已经从 1 开始顺序排列，您可以简化此操作。

```
Update
  Test as t
    Inner Join (
    Select 
      @rownum2 := @rownum2 + 1 as rank,
      t2.id
    From
      Test t2,
      (Select @rownum2:= 0) a1
  ) as o on t.id = o.id
    Inner Join (
      Select
        @rownum := @rownum + 1 as rank,
        t3.id
      From
        (Select id from Test order by Rand()) t3,
        (Select @rownum:= 0) a2
  ) as n on o.rank = n.rank
Set
  t.id = n.id 
```

[http://sqlfiddle.com/#!2/3f354/1](http://sqlfiddle.com/#!2/3f354/1)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-28T01:07:01.753

您可以创建一个存储过程，该过程将创建一个包含所有 id 的临时表，然后您可以遍历每条记录，用临时表中的 id 替换 id，然后从临时表中删除该 id。我不相信有一种方法可以在单个查询中完成您所说的事情。

# asp.net-mvc - Razor 智能感知不适用于自定义 ASP.NET MVC 构建

> ID：14063296
> 
> 赞同：2
> 
> 时间：2012-12-28T01:00:39.617
> 
> 标签：asp.net-mvc, visual-studio-2012

我能够创建 ASP.NET MVC 的自定义构建并在 Web 应用程序中使用它，但是，我似乎无法弄清楚如何让 Razor 智能感知正常工作。

如果您按照以下步骤操作，Razor 智能感知将只显示网页信息，而不会显示其他信息（HTML 帮助程序等）。

我正在使用 VS 2012。

这是我到目前为止所做的：

1.  我克隆了最新的[ASP.NET Web Stack](http://aspnetwebstack.codeplex.com/)
2.  打开`Runtime.sln`并构建解决方案
3.  创建了一个新的 ASP.NET MVC 4 (.NET 4.0) Web 应用程序
4.  删除了`System.Web.Mvc`、`System.Web.Razor`、`System.Web.WebPages`、的现有引用`System.Web.WebPages.Razor`，`System.Web.WebPages.Deployment`并在步骤 #2 中添加了对已构建程序集的引用。
5.  在`~/Views/Web.config`, 替换`System.Web.WebPages.Razor, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35`为`System.Web.WebPages.Razor`
6.  此外，替换`System.Web.Mvc, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35`为`System.Web.Mvc`
7.  从以下内容中删除`web.config`

    ```
    <runtime>
        <assemblyBinding xmlns="urn:schemasmicrosoftcom:asm.v1">
          <dependentAssembly>
            <assemblyIdentity name="System.Web.Helpers" publicKeyToken="31bf3856ad364e35" />
            <bindingRedirect oldVersion="1.0.0.0-2.0.0.0" newVersion="2.0.0.0" />
          </dependentAssembly>
          <dependentAssembly>
            <assemblyIdentity name="System.Web.Mvc" publicKeyToken="31bf3856ad364e35" />
            <bindingRedirect oldVersion="1.0.0.0-4.0.0.0" newVersion="4.0.0.0" />
          </dependentAssembly>
          <dependentAssembly>
            <assemblyIdentity name="System.Web.WebPages" publicKeyToken="31bf3856ad364e35" />
            <bindingRedirect oldVersion="1.0.0.0-2.0.0.0" newVersion="2.0.0.0" />
          </dependentAssembly>
        </assemblyBinding>
    </runtime> 
    ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T15:41:18.917

如果您正在寻找 VS 2012 中对视图的智能感知支持，以及控制器文件夹和视图文件夹的右键单击上下文菜单（添加控制器和添加视图的快捷方式），那么您需要打开 .csproj 文件您的 Web 项目并手动对其进行编辑以包含 MVC 项目类型 GUID。这就是 VS 实际上用来决定你得到什么类型的智能感知（除其他外）。

具体来说，您要查找的 .csproj 文件的 xml 标记是：

```
<ProjectTypeGuids>{E3E379DF-F4C6-4180-9B81-6769533ABE47};{349c5851-65df-11da-9384-00065b846f21};{fae04ec0-301f-11d3-bf4b-00c04f79efbc}</ProjectTypeGuids> 
```

您应该缺少 GUID 值

```
{E3E379DF-F4C6-4180-9B81-6769533ABE47} 
```

祝你好运！

# django - “github”和“git heroku”同时保存的简单方法

> ID：14063303
> 
> 赞同：1
> 
> 时间：2012-12-28T01:01:56.977
> 
> 标签：django, heroku, github

到目前为止，我使用 svn 作为源代码控制。这时候我已经开始了一个新项目，它存储在 gitHub 上。

问题是 Heroku 和 GitHub 都使用 git。第一个发布应用程序，第二个用于版本控制。

我的应用架构是：

```
base-dir                                    <--github base
    some-text-files (Readme, ... )
    django-project-dir                      <--heroku base
        manage.py
        main-app-dir
           settings.py
        other-app-dirs
           views.py
           models.py 
```

当我推送到 gitHub base-dir 并推送所有子文件夹时。

Heroku 只有 django-project-dir 应该被推送。

注意：我尝试在 django-project-dir 级别创建一个新的 git 存储库，但 git 将其作为子模块并从 gitHub 中排除。

因为这是一个新项目，我可以轻松更改为另一个架构目录。

我的问题：

**Heroku 和 GitHub git 配置共存的简单方法是什么？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T01:08:21.407

您最好的选择可能是将完整的存储库推送到 Heroku，但请确保 Heroku 忽略运行您的应用程序不需要的所有文件（请参阅[https://devcenter.heroku.com/articles/slug-compiler](https://devcenter.heroku.com/articles/slug-compiler)）。或者，考虑创建两个存储库（一个用于文档，一个用于生产代码）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T01:27:26.780

最好的办法是将自述文件和其他文件移至项目根目录。然后只需将 GitHub 添加为单独的远程（当您在项目目录中时）。

```
git remote add origin https://github.com/USERNAME/REPO 
```

然后你可以使用 .push 推送到 GitHub `git push origin master`。`-f`假设您正在推送过去专门用于 Heroku 的存储库，那么您将不得不在第一次进行强制推送（选项）。

您仍然可以使用`git push heroku master`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T01:30:07.170

你应该有两个遥控器。

这很好，甚至是可取的。

你有 github，那是你的远程代码记录库。

然后你有一个通过 heroku 的当前部署，这是第二个遥控器。

Heroku 实际上设置为使用 git 作为将更改推送到您的站点的系统的一部分。

# c# - 在构造函数中克隆类

> ID：14063308
> 
> 赞同：1
> 
> 时间：2012-12-28T01:03:43.150
> 
> 标签：c#

我需要类似的东西

```
public class  object_t 
{

    public object_t ( string config, object_t default_obj )
    {
         if( /*failed to initialize from config*/ )
         { 
            this = default_obj; // need to copy default object into self
         }
    }
 } 
```

我知道这是不正确的。如何实现这个构造函数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T01:09:29.980

最常见的可能是使用静态工厂方法：

```
public class object_t 
{    
    public static object_t CreateObjectT(string config, object_t default_obj)
    {
         object_t theconfiguredobject = new object_t();

         //try to configure it

         if( /*failed to initialize from config*/ )
         { 
             return default_obj.Clone();
         }
         else
         {
             return theconfiguredobject;
         }
    }
} 
```

* * *

执行上述操作的更好方法是创建一个复制构造函数：

```
public object_t (object_t obj)
    : this()
{
    this.prop1 = obj.prop1;
    this.prop2 = obj.prop2;
    //...
} 
```

以及尝试从配置字符串创建对象的方法：

```
private static bool TryCreateObjectT(string config, out object_t o)
{
    //try to configure the object o
    //if it succeeds, return true; else return false
} 
```

然后让您的工厂方法首先调用 TryCreateObjectT，如果失败，则复制构造函数：

```
public static object_t CreateObjectT(string config, object_t default_obj)
{
     object_t o;
     return TryCreateObjectT(config, out o) ? o : new object_t(default_obj);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-28T01:09:11.913

您应该将每个字段从默认对象复制到构造函数中的新对象：

```
public class  object_t 
{ 
    int A, B;

    public object_t ( string config, object_t default_obj )
    {
         if( /*failed to initialize from config*/ )
         { 
            this.A = default_obj.A; 
            this.B = default_obj.B; 
            //...
         }
    }
} 
```

但是你应该记住，如果这个类的字段是引用类型，你也必须对`Clone`它们进行引用，而不仅仅是分配一个引用。

这种方法确实会创建默认对象的副本，而如果您只需要返回默认对象本身，则应该使用 lc 提到的工厂方法。

# php - Smarty 模板条件停止工作

> ID：14063310
> 
> 赞同：0
> 
> 时间：2012-12-28T01:03:54.027
> 
> 标签：php, smarty, smarty3

我有一个聪明的模板，一段时间以来一直很好用，但由于我不太了解我“分配”给模板的变量之一是 $activity_date 以及当我发送带有日期信息的时间信息时它有一些令人惊讶的效果（也就是说，它在“2012-12-27”被传入时有效，但在“2012-12-27 00:00:00”被传入时以一种奇怪的方式倒下。

如果问题实际上与与此变量的某种模板交互有关，但似乎并非如此，这可能会更有意义。相反，最终效果是条件语句，如：

```
class="ajax-selector {if ($span)}span{$span}{/if} left" 
```

产生以下错误：

```
PHP Notice:  Undefined index: span in /[PATH]/templates/compiled/96681eebf17717b8605c8deffb547d7e89c1ace6.file.select2-ajax.tmpl.php on line 35 
```

对我来说，这很矛盾。代码说“测试 $span 的存在”，然后只有在它确实存在时才采取行动。错误消息抱怨未定义的索引，这是条件测试的意图。

正如我之前所说，所有这些类型的条件语句过去都可以完全按照您的预期工作，但是它们都开始失败，唯一的区别似乎是“activity_date”是否以时间级精度返回或只是日期级别的精度。

如果有帮助，这里是设置模板的代码：

```
public function handler ( $request ) {
    $response = new stdClass();
    $response->action = $request['action'];
    $response->post_type = LG_TAX_Action()->post_type($response->action); 
    $response->meta = LG_TAX_Action()->meta ( $response->action );

    $template = FE_Template::init();
    $meta = new LG_Meta();
    $template->assign ( 'form' , $response );
    if ( isset ($request['activity_date']) ) {
        $template->assign ( 'activity_date' , $request['activity_date'] );
    }
    $named_days = new stdClass();
    $named_days->today = new DateTime('today');
    $named_days->today = $named_days->today->format('Y-m-d');
    $named_days->yesterday = new DateTime('yesterday');
    $named_days->yesterday = $named_days->yesterday->format('Y-m-d');
    $template->assign ( 'named_days' , $named_days ); 
    $template->assign ( 'meta' , $meta ); // provides the "template_exists()" method

    $response->template = $template->fetch( 'activity_forms/master.tmpl' );

    return $response;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T02:06:53.130

这是我认为可能导致问题的原因。

从您上面发布的代码来看， $span 似乎没有在任何地方初始化/设置。这显然会导致未定义的索引错误。但也许 smarty 对象还没有设置为忽略那些未定义的错误报告。您可以通过在实例化或 setOption 方法期间将值为“YES”的数组键“error_reporting”传递给 smarty 的构造函数来轻松做到这一点。

此外，如果您使用 smarty 的日期格式方法来生成 $span，那么根据[smarty 文档](http://www.smarty.net/docsv2/en/language.modifier.date.format.tpl)，该值应该是

> unix 时间戳、mysql 时间戳或由月日年组成的任何字符串，可由 php 的 strtotime() 解析

希望能帮助到你！

# post - cURL POST --data-binary vs --form

> ID：14063311
> 
> 赞同：24
> 
> 时间：2012-12-28T01:03:58.710
> 
> 标签：post, curl

关于 cURL 的使用，我有一个简单的问题。在我的 Google 搜索或手册页中没有找到太多明确的答案。

在[这里](https://superuser.com/questions/361504/how-to-send-post-with-body-data-headers-andhttp-params-over-the-curl-command)讨论在发送文件/附件时使用任一`--data`vs。`--form`我很想知道主要区别是什么以及在什么情况下您会选择`--data-binary`VS `--form`？

POST“正文”可以通过`--data (for application/x-www-form-urlencoded)`或发送`--form (for multipart/form-data)`：

```
-F "foo=bar"                  # 'foo' value is 'bar'
-F "foo=<foovalue.txt"        # the specified file is sent as plain text input
-F "foo=@foovalue.txt"        # the specified file is sent as an attachment

-d "foo=bar"
-d "foo=<foovalue.txt"
-d "foo=@foovalue.txt"
-d "@entirebody.txt"          # the specified file is used as the POST body

--data-binary "@binarybody.jpg" 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2014-11-12T19:25:56.247

不同之处在[Forms 的 HTML 4.01 Specification 部分](http://www.w3.org/TR/html401/interact/forms.html#h-17.13.4)中进行了解释：

> application/x-www-form-urlencoded 是默认的内容类型。
> 
> 内容类型“application/x-www-form-urlencoded”对于发送大量二进制数据或包含非 ASCII 字符的文本效率低下。内容类型“multipart/form-data”应用于提交包含文件、非 ASCII 数据和二进制数据的表单。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-28T01:12:07.063

这正是主要区别，发送到服务器的数据类型（`application/x-www-form-urlencoded`vs `multipart/form-data`）

# c# - 如何在不装箱的情况下检索枚举的哈希码？

> ID：14063313
> 
> 赞同：9
> 
> 时间：2012-12-28T01:04:27.523
> 
> 标签：c#, hash, clr, hashtable

如果一个枚举存储在聚合类型中，则可能希望将其包含在类型的哈希码中（假设典型的“[乘以素数](https://stackoverflow.com/a/1079203/82320)”哈希函数）。如果只调用`SomeEnum.GetHashCode()`，则 JIT 似乎将实例装箱，即使在发布版本中也是如此。

对此进行分析表明，我的应用程序大约 10% 的时间花在了各种`GetHashCode`函数中的装箱枚举上。

几种值类型实现`IEquatable`或类似的接口，允许`GetHashCode`作为静态方法调用；这避免了拳击。但`System.Enum`不提供`GetHashCode`. 是否有一些方法可以计算应该使用但避免装箱的代码？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-28T01:23:28.020

您可以转换为枚举的基础类型（通常`int`除非枚举定义另有说明）并使用该类型的覆盖`GetHashCode()`方法。

```
enum TestEnum
{
    Test1,
    Test2
}

TestEnum t = TestEnum.Test1;
((int)t).GetHashCode(); // no boxing
t.GetHashCode(); // boxing 
```

这是此代码的 IL：

```
IL_0000:  nop
IL_0001:  ldc.i4.0
IL_0002:  stloc.0
IL_0003:  ldloc.0
IL_0004:  stloc.1
IL_0005:  ldloca.s   V_1
IL_0007:  call       instance int32 [mscorlib]System.Int32::GetHashCode()
IL_000c:  pop
IL_000d:  ldloc.0
IL_000e:  box        ConsoleApplication1.Program/TestEnum
IL_0013:  callvirt   instance int32 [mscorlib]System.Object::GetHashCode()
IL_0018:  pop
IL_0019:  ret 
```

**编辑：**为了完整起见，我应该指出的主体`int.GetHashCode()`是简单的`return this;`，所以正如 Raymond Chen 在上面的评论中指出的那样，简单地将枚举转换为 an`int`就足以获得哈希码。

# objective-c - Xcode 中的未知类型名称（即使有 @class 声明）

> ID：14063317
> 
> 赞同：4
> 
> 时间：2012-12-28T01:05:22.983
> 
> 标签：objective-c, ios, xcode

我在设置数据控制器的简单应用程序时遇到问题。我`@property (strong, nonatomic) BirdsListDataController *dataController;`在 BirdsListViewController.h 中遇到错误。我已尽力使用 BirdsListDataController 的 @class 声明，并尝试从 .h 文件中删除任何 #import 语句，并尝试删除循环 #import，您可以在 BirdsListViewController 顶部找到已注释掉的循环。 H。我猜这很简单。

BirdsListViewController.h

```
#import <UIKit/UIKit.h>
@class BirdsListDataController;

@interface BirdsListViewController : UITableViewController <UITextFieldDelegate>
{
// NSMutableArray *listOfBirds;
IBOutlet UITextField *addNewBirdTextField;

}
//@property (nonatomic, retain) NSIndexPath *checkedIndexPath;
@property (nonatomic, retain) NSString *textLabelContents;
@property (nonatomic, retain) NSMutableArray *workingArray;
@property (strong, nonatomic) BirdsListDataController *dataController;
@property (strong, nonatomic) IBOutlet UITableView *birdListTableView;

@end 
```

BirdsListViewController.m

```
#import "BirdsListViewController.h"
#import "BirdsListDataController.h"

@interface BirdsListViewController ()
@end

@implementation BirdsListViewController

- (id)initWithStyle:(UITableViewStyle)style
{
    self = [super initWithStyle:style];
    if (self) {
... 
```

BirdsListDataController.h

```
#import <Foundation/Foundation.h>     
@class BirdName;

@interface BirdsListDataController : NSObject

@property (nonatomic, copy) NSMutableArray *listOfBirds;
-(NSUInteger)countOfList;
-(BirdName *)objectInListAtIndex:(NSUInteger)theIndex;
-(void)addBirdNameWithName:(BirdName *)bName;
@end 
```

BirdsListDataController.m

```
#import "BirdsListDataController.h"
//#import "BirdsListViewController.h"
#import "Bird.h"

@implementation BirdsListDataController

-(id)init
{... 
```

我对 iOS 和 Objective C 还是很陌生，所以希望我的代码不会太糟糕而无法排除故障。谢谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T15:52:44.663

对于寻找比注释/取消注释代码更好的答案的人来说，更好的解决方案是清理您的项目并删除您的派生数据。修复循环引用后，击键`Command+Shift+K`将清理您的项目，或者您可以转到并选择`Product->Clean`.

要删除派生数据，请打开管理器，单击项目选项卡，导航到侧栏中的项目。您应该在项目名称标题下看到“派生数据”。右边应该是一个说删除的按钮。如果启用，删除派生数据也可以消除挂起错误。

作为解释，有时 Xcode 似乎与项目不同步，坚持不再存在的错误。这在较新的版本中更好，但偶尔仍会发生。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T01:31:19.670

我不确定是什么导致了您的问题，但有几件事：

*   在您提供的代码中，没有理由不在 BirdListViewController.h 中导入 BirdListDataController.h，因为在 BirdListDataController.h 中没有对 BirdListViewControllers 的引用。所以尝试用#import 语句替换你的@class 声明。

*   在 BirdListDataController.h 中声明 @class BirdName，但在 BirdListDataController.m 中导入 Bird.h 而不是 BirdName.h。那里似乎有问题，尽管我必须查看 BirdName.h 和 Bird.h 的代码才能确定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-21T06:00:44.920

就我而言，我在不同的文件夹结构中有重复的类名，一旦我删除了新类并以不同的方式命名它，一切都会再次起作用。

因此，根据“shA.t”的评论，将其转化为实用的解决方案：

如果您注释/取消注释您的代码，或者按照上面建议的答案清理项目但仍然没有解决它：

1.  采取措施回顾最近的类更改并仔细检查所有类名是唯一的，即使在不同的目录中，仔细检查

    商场

2.  如果发现重复的类名：备份该代码，删除该类（不仅是引用，还可以删除）
3.  创建一个具有唯一名称的新类并合并备份代码

对于这种特殊的类名重复场景，这将为您省去导入和注释 #import "class.h" 的麻烦

# django - Django ImageField [Errno 13] 权限被拒绝，即使目录是可写的

> ID：14063318
> 
> 赞同：3
> 
> 时间：2012-12-28T01:05:24.540
> 
> 标签：django, permission-denied, imagefield

我在“赞助商”模型中包含了一个 ImageField 字段，该字段设置为将上传的图像文件保存到 my_app/static/uploads/sponsor_logos，当我尝试使用管理界面保存记录时，出现以下错误：

/admin/sponsors/sponsor/add/ 处的 OSError [Errno 13] 权限被拒绝：'/static'

这是我的模型：

```
from django.db import models

class Sponsor(models.Model):
    name = models.CharField(max_length=200)
    level_choices = (('Gold', 'Gold'), ('Silver', 'Silver'), ('Bronze', 'Bronze'))
    level = models.CharField(max_length=10, choices=level_choices)
    logo = models.ImageField(upload_to = 'sponsor_logos/')

    class Meta:
        ordering = ["name"]

    def __unicode__(self):
        return self.name 
```

我的媒体根设置为：

```
MEDIA_ROOT = '/static/uploads/' 
```

这是回溯：

```
Environment:

Request Method: POST
Request URL: http://127.0.0.1:8000/admin/sponsors/sponsor/add/

Django Version: 1.4.2
Python Version: 2.7.2
Installed Applications:
('django.contrib.auth',
 'django.contrib.contenttypes',
 'django.contrib.sessions',
 'django.contrib.sites',
 'django.contrib.messages',
 'django.contrib.staticfiles',
 'django.contrib.flatpages',
 'django.contrib.humanize',
 'awards',
 'sponsors',
 'django.contrib.admin')
Installed Middleware:
('django.middleware.common.CommonMiddleware',
 'django.contrib.sessions.middleware.SessionMiddleware',
 'django.middleware.csrf.CsrfViewMiddleware',
 'django.contrib.auth.middleware.AuthenticationMiddleware',
 'django.contrib.messages.middleware.MessageMiddleware')

Traceback:
File "/Library/Python/2.7/site-packages/django/core/handlers/base.py" in get_response
  111\.                         response = callback(request, *callback_args, **callback_kwargs)
File "/Library/Python/2.7/site-packages/django/contrib/admin/options.py" in wrapper
  366\.                 return self.admin_site.admin_view(view)(*args, **kwargs)
File "/Library/Python/2.7/site-packages/django/utils/decorators.py" in _wrapped_view
  91\.                     response = view_func(request, *args, **kwargs)
File "/Library/Python/2.7/site-packages/django/views/decorators/cache.py" in _wrapped_view_func
  89\.         response = view_func(request, *args, **kwargs)
File "/Library/Python/2.7/site-packages/django/contrib/admin/sites.py" in inner
  196\.             return view(request, *args, **kwargs)
File "/Library/Python/2.7/site-packages/django/utils/decorators.py" in _wrapper
  25\.             return bound_func(*args, **kwargs)
File "/Library/Python/2.7/site-packages/django/utils/decorators.py" in _wrapped_view
  91\.                     response = view_func(request, *args, **kwargs)
File "/Library/Python/2.7/site-packages/django/utils/decorators.py" in bound_func
  21\.                 return func(self, *args2, **kwargs2)
File "/Library/Python/2.7/site-packages/django/db/transaction.py" in inner
  209\.                 return func(*args, **kwargs)
File "/Library/Python/2.7/site-packages/django/contrib/admin/options.py" in add_view
  955\.                 self.save_model(request, new_object, form, False)
File "/Library/Python/2.7/site-packages/django/contrib/admin/options.py" in save_model
  709\.         obj.save()
File "/Library/Python/2.7/site-packages/django/db/models/base.py" in save
  463\.         self.save_base(using=using, force_insert=force_insert, force_update=force_update)
File "/Library/Python/2.7/site-packages/django/db/models/base.py" in save_base
  551\.                 result = manager._insert([self], fields=fields, return_id=update_pk, using=using, raw=raw)
File "/Library/Python/2.7/site-packages/django/db/models/manager.py" in _insert
  203\.         return insert_query(self.model, objs, fields, **kwargs)
File "/Library/Python/2.7/site-packages/django/db/models/query.py" in insert_query
  1593\.     return query.get_compiler(using=using).execute_sql(return_id)
File "/Library/Python/2.7/site-packages/django/db/models/sql/compiler.py" in execute_sql
  909\.         for sql, params in self.as_sql():
File "/Library/Python/2.7/site-packages/django/db/models/sql/compiler.py" in as_sql
  872\.                 for obj in self.query.objs
File "/Library/Python/2.7/site-packages/django/db/models/fields/files.py" in pre_save
  249\.             file.save(file.name, file, save=False)
File "/Library/Python/2.7/site-packages/django/db/models/fields/files.py" in save
  86\.         self.name = self.storage.save(name, content)
File "/Library/Python/2.7/site-packages/django/core/files/storage.py" in save
  45\.         name = self._save(name, content)
File "/Library/Python/2.7/site-packages/django/core/files/storage.py" in _save
  168\.                 os.makedirs(directory)
File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/os.py" in makedirs
  150\.             makedirs(head, mode)
File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/os.py" in makedirs
  150\.             makedirs(head, mode)
File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/os.py" in makedirs
  157\.     mkdir(name, mode)

Exception Type: OSError at /admin/sponsors/sponsor/add/
Exception Value: [Errno 13] Permission denied: '/static' 
```

我在 my_app/static/uploads/sponsor_logos 目录上运行了 chmod 777，所以它应该是可写的。此外，我运行了 python manage.py shell，并从那里在赞助商徽标目录中创建了一个新的文本文件，因此该目录似乎是可写的。为什么我不断收到此错误？

# wpf - WPF 的 ComponentOne：文本似乎呈现在不正确的位置？

> ID：14063320
> 
> 赞同：3
> 
> 时间：2012-12-28T01:06:07.050
> 
> 标签：wpf, pdf, pdf-generation, componentone

在我的文档上呈现文本时遇到问题。具体来说，文本呈现得太低。我尝试在文本后面填充一个矩形以查看会发生什么，我发现它们似乎呈现略微偏移：

![使用相同的矩形从背景偏移文本。](../Images/46a76490accc0d49cfebdc348b7ab2d0.png)

这是我用来呈现框和文本的代码：

```
_doc.FillRectangle(Colors.LightGray, 36, 72, 37.344, 9);
_doc.DrawString("Lorem", new Font("Arial", 12), Colors.Black, 
   new Rect(36, 72, 37.344, 9)); 
```

我知道矩形 (9) 的高度似乎与字体 (12) 的高度不匹配，起初我认为这可能是问题所在。但是，然后我对字体本身做了一个 MeasureString，发现它的高度实际上是 9 而不是 12（我为此使用了即时窗口，这就是为什么它是图片而不是文本块的原因）：

![立即窗口调用 MeasureString 的结果。](../Images/8fe2df07e65c0d510ce332725569bf02.png)

关于什么可能导致它以及如何避免它的任何想法？

谢谢！

-阿里

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T20:46:42.527

*   有几篇文章讨论了[WPF 文本呈现不一致](https://stackoverflow.com/questions/3444031/wpf-text-rendering-inconsistencies)问题。

*   其他帖子之一：[WPF 文本渲染问题](https://stackoverflow.com/questions/5375282/wpf-text-rendering-problem)，指出**`SnapToDevicePixels`如果文本已调整大小以跨像素显示，则可能会破坏文本渲染。**建议的答案是保留，

    `SnapToDevicePixels = True on borders/backgrounds`但将其关闭`text elements`。

*   至于您正在使用的当前方法。请查看我之前的一篇文章：[通过单击按钮增加条形图值](https://stackoverflow.com/questions/14004009/increase-bar-chart-values-with-button-clicks/14004620#14004620)：我曾经`DrawString()`在`rectangle`. 所有绘图都在**`Panel`**.

代码： ...

```
 panel1.Paint += new PaintEventHandler(panel1_Paint);

        using (Graphics g = this.panel1.CreateGraphics())
        {
            Brush brush = new SolidBrush(Color.Green);
            g.FillRectangle(brush, px, py, 20, 20);                           
            Pen pen = new Pen(new SolidBrush(Color.White));
            g.DrawRectangle(pen, px, py, 20, 20);                    

            //add each total5Click into chart block
            g.DrawString((total5Times).ToString(), new Font("Arial", 7), 
            new SolidBrush(Color.AntiqueWhite),
            px + 1, py+8, StringFormat.GenericDefault);
            pen.Dispose();}
    ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T20:40:31.460

我建议使用该方法`DrawString Method (String, Font, Brush, RectangleF, StringFormat)`并提供字符串格式。在查看了 ComponentOne 之后，他们似乎将几种方法放在一起，所以我可能对该方法的 StringFormat 默认设置存在问题。我有点假设他们正在调用主要的 DrawString 方法并在未提供默认参数时传入默认参数。

还请务必检查该部分

使用 LineAlignment 指定字符串的垂直对齐方式。

在下面的链接中

[链接到方法](http://helpcentral.componentone.com/nethelp/c1pdf/default.htm#!XMLDocuments/Reference/html/M_C1_C1Pdf_C1PdfDocument_DrawString_5_51a7b4b8.htm)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T01:05:19.007

好吧，经过进一步的研究和实验，ComponentOne 库中肯定存在错误。具体来说，我碰巧在这里使用的重载返回了错误的高度。如果您明确指定可用宽度，您将获得正确的高度。具体来说，此代码生成正确的数据：

```
var resultHeight = _doc.MeasureString(text, pdfFont, double.MaxValue).Height;
var resultWidth = _doc.MeasureString(text, pdfFont).Width;

return new Tuple<double,double>(resultHeight, resultWidth); 
```

注意只为高度添加了第三个参数—— `double.MaxValue`。在这两种情况下都正确计算了宽度，但只有在您提供该`double`参数时才能正确计算高度。我`double.MaxValue`在这种情况下选择只是因为我不知道字符串会变得多宽，所以我不想冒险被赋予多行高度。

# c# - 如何为单个请求禁用 HttpWebRequest 中的“期望：100 继续”标头？

> ID：14063327
> 
> 赞同：47
> 
> 时间：2012-12-28T01:06:39.633
> 
> 标签：c#, .net, httpwebrequest

`HttpWebRequest``Expect: 100-continue`自动为 POST 请求附加标头。互联网上的各种消息来源表明，可以按如下方式禁用此功能：

```
System.Net.ServicePointManager.Expect100Continue = false; 
```

但是，我正在编写一个库，我不能为整个 appdomain 禁用它，以防应用程序依赖此行为。我也不能假设它将保持设置为该值。如何针对特定请求禁用它？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2012-12-28T01:06:39.633

该类`HttpWebRequest`有一个名为的属性`ServicePoint`，可用于更改特定请求的此设置。例如：

```
var req = (HttpWebRequest) WebRequest.Create(...);
req.ServicePoint.Expect100Continue = false; 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2014-09-17T08:02:20.770

如果您还需要设置代理，请务必先设置。否则**Expect100Continue**将再次恢复为**真**。所以：

```
HttpWebRequest webRequest = WebRequest.CreateHttp(_url);
webRequest.Proxy = new WebProxy(_proxyHost, _proxyPort);
webRequest.ServicePoint.Expect100Continue = false; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-02-01T21:36:25.137

这也可以在配置中覆盖：

```
<system.net>
    <settings>
        <servicePointManager expect100Continue="false"/>
    </settings>
</system.net> 
```

# php - PHP - 如何使用 $timestamp 检查今天是星期一还是本月的第一天？

> ID：14063336
> 
> 赞同：23
> 
> 时间：2012-12-28T01:08:24.447
> 
> 标签：php, timestamp

我一直在网上浏览示例，我发现它们有点神秘或矫枉过正。

我需要做的是这样的：

```
$timestamp = time(); 
```

然后找出这一天是星期一还是本月的第一天？

我相信这是可能的，我只是不知道该怎么做。

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2012-12-28T01:16:03.543

实际上，您不需要时间戳变量，因为：

摘自 php.net 的[日期](http://php.net/manual/en/function.date.php)函数：

> 返回根据给定格式字符串格式化的字符串，使用给定的整数时间戳或当前时间（如果没有给出时间戳）。换句话说，timestamp 是可选的，默认为 time() 的值。

```
if(date('j', $timestamp) === '1') 
    echo "It is the first day of the month today\n";

if(date('D', $timestamp) === 'Mon') 
    echo "It is Monday today\n"; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-28T01:23:17.357

这应该解决它：

```
$day = date('D');
$date = date('d')
if($day == Mon){
    //Code for monday
}
if($date == 01){
    //code for 1st fo the month
}
else{
    //not the first, no money for you =/
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-28T01:19:18.130

这将抓住..星期一从mysql

```
$monday = 1; //tuesday= 2.. sunday = 7

    AND $monday = (date_format(from_unixtime(your_date_column),'%w')) 
```

或天..

```
$day = 1; ///1st in month

    AND $day = (date_format(from_unixtime(your_date_column),'%d')) 
```

想知道

```
$date  = date("d"); //1st?
$dayinweek = date("w"); //monday? //as a number in a week what you need more then just "Monday" I guess.. 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-28T01:12:11.033

你可以使用：[strtotime](http://php.net/manual/en/function.strtotime.php)

```
$firstdaymonth = strtotime('first day this month'); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-12-24T04:23:56.887

**因为 $date 可以是星期一或星期日。应该检查一下**

```
public function getWeek($date){
    $date_stamp = strtotime(date('Y-m-d', strtotime($date)));

     //check date is sunday or monday
    $stamp = date('l', $date_stamp);      

    if($stamp == 'Mon'){
        $week_start = $date;
    }else{
        $week_start = date('Y-m-d', strtotime('Last Monday', $date_stamp));
    }

    if($stamp == 'Sunday'){
        $week_end = $date;
    }else{
        $week_end = date('Y-m-d', strtotime('Next Sunday', $date_stamp));
    }        
    return array($week_start, $week_end);
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-05-21T17:34:02.753

由于**PHP >= 5.1**，因此可以使用`date('N')`，它返回 ISO-8601 数字表示一周中的某一天，其中 1 是星期一，7 是星期日。

所以你可以做

```
if(date('N', $timestamp) === '1' || date('j', $timestamp) === '1')) {
    echo "Today it is Monday OR the first of the month";
} 
```

# css - 复制 CSS 类

> ID：14063337
> 
> 赞同：0
> 
> 时间：2012-12-28T01:08:25.923
> 
> 标签：css, twitter-bootstrap

假设您正在使用 Twitter Boostrap，并且您拥有通用的 boostrap.css 和其他与 boostrap 相关的 css 文件，并且您希望自己的类与某些给定的 boostrap 类具有相同的属性。据我了解，您不希望直接修改 css 引导文件，而是希望通过创建 custom.css 文件来扩展它们。

因此，无需接触 boostrap 文件。我将如何为我自己的课程复制一个 boostrap 课程？唯一的方法是从 boostrap.css 文件中复制和粘贴。或者有没有办法

```
.myownclass {
    -- some command to replicate class 'alert alert-error' without repeating the CSS that has already been written
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T01:29:07.723

您可以使用**css 预处理器**。其他用户已经引用的其他方法很好，但使用 css 预处理器是最好的方法。

Bootstrap 是使用**LESS**构建的，因此您可以使用 LESS。看看这里：[http](http://bootstrap.lesscss.ru/less.html) ://bootstrap.lesscss.ru/less.html 。

也可以使用**SASS 。**在我看来，SASS 更好。您可以在此处找到教程：[http ://www.1stwebdesigner.com/css/build-website-using-twitter-bootstrap-sass-1/](http://www.1stwebdesigner.com/css/build-website-using-twitter-bootstrap-sass-1/)

**什么是 CSS 预处理器？**

浏览器只能将 CSS 理解为任何正在渲染的 DOM 元素的样式技术。CSS，作为一门语言有自己的特性集，有时可能不足以创建一个干净和可重用的规则块。例如。无法在多个选择器中重用规则集合，变量不可用可能导致样式表中的数据不明确。为了克服这些限制中的大部分，预处理器的概念诞生了——它提供了一种编写 CSS 的高级方法，它扩展了基本功能。此高级代码稍后会使用相应的编译器（取决于您使用的预处理器）编译为普通的 CSS 代码，浏览器会理解这些代码。

**你应该使用预处理器吗？**

在我看来，为您的下一个项目采用预处理器的决定应该在经过大量分析后做出，并且完全取决于您的专业水平，最重要的是项目要求和整个团队的工作流程。以下是一些可以帮助您做出决定的提示：

*   **不适合初学者：**如果您是初学者并开始探索 CSS 的奇妙世界，我建议您在使用任何类型的框架或预处理器之前先使用普通的 CSS。理解和能够使用你所使用的任何语言的核心概念真的很重要，这对于 CSS 和任何其他编程语言一样都是正确的。

*   **你是前端开发团队吗？**作为一个前端开发团队，采用预处理器将是一个很好的举措。但前提是团队中的某个人真的知道如何处理巨大的 CSS 文件并相应地构建它们。通过利用该语言提供的强大功能，首先将整个 CSS 结构化为可重用的块并为 CSS 组织定义策略是很重要的。例如。您是否要使用多个 CSS 文件来进行排版、表单、布局等。您是否要使用可主题化的 UI，您可能需要在其中广泛使用变量等。

*   **你愿意跨界吗？**采用预处理器意味着您将在您的 CSS 编码方法中实现更多的编程概念。任何基本编程语言都会有很多概念，您可能想通过使用预处理器来学习和实现这些概念。这意味着，您肯定需要提高您的编程技能，并且可能永远改变您查看 CSS 代码的方式。如果你愿意跨越这个障碍，并准备好自信地接受改变，那么这就是给你的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-28T01:33:45.600

在 CSS 中这是不可能的。唯一的方法是在你的 html 标签中链接类。

```
<div class="alert alert-error myownclass"></div> 
```

如果您使用较少，您可以这样做：

```
 .myownclass {
   .alert
   .alert-error;
 } 
```

这会将设置从一个类复制到另一个类。结果将与直接复制类的内容相同。

如果您使用的是 Sass，则无需复制课程内容即可。只需引用如下所示的类。这不会复制内容，而是会在您的 css 代码中的正确位置引用您的自定义类。

```
.myownclass {
   @extend .alert;
   @extend .alert-error;
} 
```

[参考：萨斯@extend](http://sass-lang.com/docs/yardoc/file.SASS_REFERENCE.html#extend)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-28T01:17:16.947

你可以给元素两个类——原始的 Bootstrap 类，然后是你自己制作的一个。然后你会像这样定位它：

### HTML

```
<h1 class="original_class myownclass">Hello</h1> 
```

### CSS

```
.original_class.myownclass {
  // css code
} 
```

这是一个说明这个概念的小 jsfiddle：http: [//jsfiddle.net/ApEpr/](http://jsfiddle.net/ApEpr/)

这不需要使用 CSS 预处理器——它只是普通的旧 CSS。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-28T01:17:19.083

您必须使用 LESS 来避免复制/粘贴：

```
.myClass {
    .bootstrapClass;
} 
```

或者，您可以使用 TBS 已移植到的任何其他 CSS 预处理器（Sass 有一个，其他的不确定）。

# forms - TYPO3：在前端插件中使用 t3lib_TCEforms

> ID：14063338
> 
> 赞同：0
> 
> 时间：2012-12-28T01:08:52.400
> 
> 标签：forms, typo3

我想尽可能多地使用标准 TYPO3 来创建一个表单来编辑来自 tx_mytable 的单个记录。

在 pi1 中，我为表加载 tca： t3lib_div::loadTCA('tx_mytable');

现在我想使用标准函数来创建我的表单元素，或多或少就像在后端完成的那样......

我在前端找到了这个，但找不到任何工作示例：t3lib_TCEforms_fe.php（扩展了普通的 t3lib_TCEforms）

这是正确的方法还是有更好的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T22:05:32.020

我得到了一些工作，但在前端并不是那么好的代码

这是一个链接，说明 TCA 还不够，但需要数组中的两个新条目 [http://www.martin-helmich.de/?p=15](http://www.martin-helmich.de/?p=15)

它是 itemFormElName 和 itemFormElValue

```
// include tceforms_fe (place outside class where pipase is included)
require_once(PATH_t3lib.'class.t3lib_tceforms_fe.php');

// load TCA for table in frontend
t3lib_div::loadTCA('tx_ogcrmdb_tasks');

// init tceforms
$this->tceforms = t3lib_div::makeInstance("t3lib_TCEforms_FE");
$this->tceforms->initDefaultBEMode(); // is needed ??
$this->tceforms->backPath = $GLOBALS['BACK_PATH']; // is empty... may not be needed

//////////REPEAT FOR EACH INPUT FIELD/////////
// start create input fields, here just a single select for responsible

// conf used for tceforms similar to but not exactly like normal TCA
$conftest = array(
    'itemFormElName' => $GLOBALS['TCA']['tx_ogcrmdb_tasks']['columns']['responsible']['label'],
    'itemFormElValue' => 1,
    'fieldConf' => array(
        'config' => $GLOBALS['TCA']['tx_ogcrmdb_tasks']['columns']['responsible']['config']
    )
);

// create input field
$this->content .= $this->tceforms->getSingleField_SW('','',array(),$conftest);

// wrap in form
$output = '<form action="" name="editform" method="post">';
$output .= $this->content;
$output .= '</form>';

// wrap and return output
return $output; 
```

仍在寻找使用自定义模板作为输入字段的工作示例。

# average - 如何命名我的平均技术？

> ID：14063340
> 
> 赞同：0
> 
> 时间：2012-12-28T01:09:08.957
> 
> 标签：average

假设我有一个值列表 {4, 10, 3, 6, 7, 15, 11}。这个数字列表的平均值是 avg=8。现在我将只选择那些元素 > avg，它们是 {10,11,15}。现在我再次做平均并选择大于平均水平的元素。我相信这是一种从列表中获得最高评价值的有用技术，我不确定这种平均技术的命名。任何人都可以帮我命名这种方法吗？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T01:24:56.577

我不确定您的代码是什么样的，但我想在一次通过时您返回的元素高于平均水平？所以我会命名那个方法`ElementsGreaterThanAverage`。

如果你总是只做两次传球，你可以叫它`TopQuarterByAveraging`什么的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-28T01:17:37.527

如何使用平均？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-28T01:32:44.587

您正在计算平均值，然后显示它上面的所有内容。因此，OverMean。

# javascript - 使用jquery对话框时如何停止重新加载基本页面

> ID：14063343
> 
> 赞同：0
> 
> 时间：2012-12-28T01:09:16.457
> 
> 标签：javascript, jquery

我的 editRecords.php 页面上有以下代码。此页面是一个记录表，当我单击视图链接时，它会打开一个对话框，其中包含 displayRecord.php 页面。问题是，如果我打开表中的最后一条记录，而不是打开/关闭对话框，并且 editRecords.php 页面保持原样，它似乎会重新加载，这会将我带回页面顶部。

```
$(document).ready(function() { 

     //creating a dialog box
     var dlg=$('#ticketDetails').dialog({
        title: 'Ticket Details',
        resizable: false,
        autoOpen:false,
        modal: true,
        hide: 'fade',
        width: 1300

     });

    //loading dialog box with record
    $('a.view').click(

    function(e) 
    {
         dlg.load('displayRecord.php?id='+this.id, function(){ 
         dlg.dialog('open');
         });

      });

}); 
```

我尝试过使用`e.preventDefault()`，但这会导致对话框加载时焦点位于中间而不是顶部。

```
function(e) 
        {
                 //tested here e.preventDefault();
             dlg.load('displayRecord.php?id='+this.id, function(){ 
             dlg.dialog('open');
             });
         //tested here e.preventDefault(); 
```

如何修复/调整这种行为？

谢谢。

**澄清：** `e.preventDefault()`有效，但问题是它会导致对话框加载，焦点在中间。我打开或关闭对话框没有问题。我只想停止重新加载基本页面（editRecords.php）（或看起来像是重新加载页面），这样当我关闭对话框时，我会看到我点击的记录，而不必再次向下滚动。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T01:12:19.740

让我们看看如何在这个对话框中动态加载内容

```
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Load Page Dynamically inside a jQuery UI Dialog</title>
<link rel="Stylesheet" type="text/css" href="
http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/base/jquery-ui.css
" />
<script  type="text/javascript" src="
http://ajax.microsoft.com/ajax/jquery/jquery-1.4.2.min.js">
</script>
<script type="text/javascript" src="
http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js">
</script>

<script type="text/javascript">
    $(function ()    {
        $('<div>').dialog({
            modal: true,
            open: function ()
            {
                $(this).load('Sample.htm');
            },         
            height: 400,
            width: 400,
            title: 'Dynamically Loaded Page'
        });
    });
</script>
</head>
<body>

</body>
</html> 
```

如您所见，我们正在动态创建一个 div 元素并为 open 事件指定回调，该回调会动态加载页面“Sample.htm”的内容。

多次打开和关闭对话框不会从页面中删除对话框。如果要实现关闭事件，请在对话框选项中使用此代码（未经测试的代码）：

`close: function(e, i) { $(this).close(); }`

就这样！

# c# - 在我的项目中关闭程序后，在 C# 中出现错误“CannotUnloadAppDomainException”

> ID：14063344
> 
> 赞同：0
> 
> 时间：2012-12-28T01:09:24.347
> 
> 标签：c#

当我在我的项目中创建和使用报告（rdlc）时，这开始了，现在每次我打开带有报告的表单时它仍然可以正常工作，当我关闭我的应用程序时会显示错误我该如何解决这个问题？

![在此处输入图像描述](../Images/9f19b4930acf812d63e4288bf433ab3d.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T01:19:57.507

```
private void Form1_FormClosing(Object sender,System.Windows.Forms.FormClosingEventArgs e) 
{
        ReportViewer1.LocalReport.ReleaseSandboxAppDomain();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-24T09:48:13.590

这也对我有用。

> 报告查看器.Reset();

# ios - 谷歌地图右键菜单滑动动画

> ID：14063349
> 
> 赞同：1
> 
> 时间：2012-12-28T01:10:44.893
> 
> 标签：ios, google-maps, animation

我想重现新的 google-maps 右键菜单滑动动画（用于显示交通、卫星）。有什么想法可以重现这个吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-11T12:13:28.120

看看下面的 CocoaPod：[https ://github.com/monospacecollective/MSNavigationPaneViewController](https://github.com/monospacecollective/MSNavigationPaneViewController)

它包括您正在寻找的动画，称为缩放。

# ruby-on-rails - rails 在两个表中划分循环。导轨视图，新手

> ID：14063352
> 
> 赞同：2
> 
> 时间：2012-12-28T01:11:14.887
> 
> 标签：ruby-on-rails, ruby, loops, view

想知道将视图中模型上的循环拆分到两个表上的最佳方法是什么。看起来很简单。

```
 <div>
        <table>
          <tr><th>Refreshments and Exhibits</th></tr>
          <% @exhibitor.each do |exhibitor| %>
          <tr>
            <td><%= exhibitor.name %></td>
          </tr>
        <% end %>
        </table>
    </div>
    <div>
        <table>
          <tr><th>Refreshments and Exhibits</th></tr>
          <% @exhibitor.each do |exhibitor| %>
          <tr>
            <td><%= exhibitor.name %></td>
          </tr>
        <% end %>
        </table>
     </div> 
```

这将显示同一张表两次。我想循环遍历@exhibitor 以填充第一个表中的 td，限制为 15。然后继续循环遍历第二个表的其余部分。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T01:20:29.030

如果你想要 15 桌，请执行此操作

```
<% @exhibitors.each_slice(15) do |exhibitors_group| %>
  <div>
    <table>
      <tr><th>Refreshments and Exhibits</th></tr>
      <% exhibitors_group.each do |exhibitor| %>
        <tr>
          <td><%= exhibitor.name %></td>
        </tr>
      <% end %>
    </table>
  </div>
<% end %> 
```

如果您想要前 15 个和其他表中的其余部分，请执行此操作

```
 <div>
    <table>
      <tr><th>Refreshments and Exhibits</th></tr>
      <% @exhibitor[0..15].each do |exhibitor| %>
        <tr>
          <td><%= exhibitor.name %></td>
        </tr>
      <% end %>
    </table>
  </div>

  <div>
    <table>
      <tr><th>Refreshments and Exhibits</th></tr>
      <% @exhibitors[16..-1].each do |exhibitor| %>
        <tr>
          <td><%= exhibitor.name %></td>
        </tr>
      <% end %>
    </table>
  </div> 
```

您还应该考虑两件事：

*   为这些表使用助手或布局
*   而不是在视图中对数组进行切片，而是在控制器中进行

# google-app-engine - 下载源时缺少 App.yaml

> ID：14063356
> 
> 赞同：1
> 
> 时间：2012-12-28T01:12:13.053
> 
> 标签：google-app-engine

刚刚尝试使用 SDK 1.7.4.437（在 Mac 上）下载我的一个旧应用程序的源代码，但下载的源代码不包含 app.yaml 文件。

使用了以下命令：`appcfg.py download_app -A <application_id> -V <version> <folder>`

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T02:09:58.997

部署项目时未上传 app.yaml

**更新**

下载的源代码缺少 .yaml 文件：[http ://code.google.com/p/googleappengine/issues/detail?id=4337](http://code.google.com/p/googleappengine/issues/detail?id=4337)

但是再次发现这个问题，我也找到了这个条目。查看下载文件列表。 [http://forums.udacity.com/questions/6006963/downloading-your-source-from-google-app-engine](http://forums.udacity.com/questions/6006963/downloading-your-source-from-google-app-engine)

# python - os.path.isdir 检查失败

> ID：14063367
> 
> 赞同：0
> 
> 时间：2012-12-28T01:13:55.890
> 
> 标签：python, unix

我有以下代码，我试图检查目录“Gerrits/HEAD/wlan”，然后执行一些操作，出于某种原因，如果即使目录存在，检查目录的条件仍然失败？if condition@if (os.path.isdir(SCRIPT_ROOT + "/Gerrits/HEAD/wlan")) 有什么问题：下面

```
import os
import subprocess
from subprocess import check_call

SCRIPT_ROOT=subprocess.Popen(['pwd'], stdout=subprocess.PIPE).communicate()[0]
print SCRIPT_ROOT

def main ():
    if (os.path.isdir(SCRIPT_ROOT + "/Gerrits/HEAD/wlan")):
        print "SCRIPT_ROOT/Gerrits/HEAD/wlan already exists,cloning it again to the tip"
        check_call("rm -rf $SCRIPT_ROOT/Gerrits/HEAD/wlan ", shell=True)
        check_call("cd Gerrits/HEAD",shell=True)
    else:
        print "SCRIPT_ROOT/Gerrits/HEAD/wlan doesn't exist,cloning it"
        os.makedirs("Gerrits/HEAD/wlan")
        check_call("cd Gerrits/HEAD",shell=True)
        currdir=subprocess.Popen(['pwd'], stdout=subprocess.PIPE).communicate()[0]

if __name__ == '__main__':
    main() 
```

错误：-

```
SCRIPT_ROOT/Gerrits/HEAD/wlan doesn't exist,cloning it
Traceback (most recent call last):
  File "test.py", line 21, in <module>
    main()
  File "test.py", line 16, in main
    os.makedirs("Gerrits/HEAD/wlan")
  File "/usr/lib/python2.6/os.py", line 157, in makedirs
    mkdir(name, mode)
OSError: [Errno 17] File exists: 'Gerrits/HEAD/wlan' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T01:25:05.307

添加`.strip()`到您的`communicate()[0]`调用中，代码原样在输出中包含尾随换行符。

可以肯定的是，我刚刚在带有 Python 2.5 的 linux 机器上测试了您的脚本。

```
import os
import subprocess
from subprocess import check_call

SCRIPT_ROOT=subprocess.Popen(['pwd'], stdout=subprocess.PIPE).communicate()[0].strip()
print SCRIPT_ROOT

def main ():
    if (os.path.isdir(SCRIPT_ROOT + "/Gerrits/HEAD/wlan")):
        print "SCRIPT_ROOT/Gerrits/HEAD/wlan already exists,cloning it again to the tip"
        check_call("rm -rf %s/Gerrits/HEAD/wlan" % SCRIPT_ROOT, shell=True)
        check_call("cd Gerrits/HEAD",shell=True)
    else:
        print "SCRIPT_ROOT/Gerrits/HEAD/wlan doesn't exist,cloning it"
        os.makedirs("Gerrits/HEAD/wlan")
        check_call("cd Gerrits/HEAD",shell=True)
        currdir=subprocess.Popen(['pwd'], stdout=subprocess.PIPE).communicate()[0].strip()

if __name__ == '__main__':
    main() 
```

及其输出：

```
vlazarenko@xx:~$ python o.py 
/media/home/vlazarenko
SCRIPT_ROOT/Gerrits/HEAD/wlan already exists,cloning it again to the tip 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T01:25:23.010

当我在这里执行这行代码时：

```
SCRIPT_ROOT=subprocess.Popen(['pwd'], stdout=subprocess.PIPE).communicate()[0] 
```

...的值`SCRIPT_ROOT`有一个尾随换行符

```
>>> import os
>>> import subprocess
>>> ROOT = subprocess.Popen(['pwd'], stdout=subprocess.PIPE).communicate()[0]
>>> ROOT
'/Users/bgporter/personal\n' 
```

...这使得这个电话

```
if (os.path.isdir(SCRIPT_ROOT + "/Gerrits/HEAD/wlan")): 
```

行为与您希望的不同。您可以对该值调用 strip() ，或者如果您总是想获取当前工作目录，您可以通过调用更轻松地做到这一点[`os.getcwd()`](http://docs.python.org/2/library/os.html#os.getcwd)

同样，您可以使用该[`os.removedirs()`](http://docs.python.org/2/library/os.html#os.removedirs)函数递归地删除您不想要的目录，而不是脱壳。

# visual-studio - 我可以在 Visual Studio Express 2012 for Windows Desktop 中使用 F# 吗？

> ID：14063369
> 
> 赞同：8
> 
> 时间：2012-12-28T01:14:24.120
> 
> 标签：visual-studio, f#, visual-studio-2012

*Microsoft 为Visual Studio Express 2012 for Web*发布了 F# 工具，但我正在使用*Visual Studio Express 2012 for Windows Desktop*。我读到微软没有计划支持桌面版本。

还有一种方法可以在*Visual Studio Express 2012 for Windows Desktop*中使用 F#吗？*是否可以以某种方式调用Visual Studio Express 2012 for Web*的 F# 工具附带的 F# 编译器？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-28T12:49:40.593

> 是否还有办法在 Visual Studio Express 2012 for Windows Desktop 中使用 F#？

不可以。在免费版本中，F# 3.0 仅适用于 Visual Studio Express 2012 for Web。

> 是否可以以某种方式调用 Visual Studio Express 2012 for Web 的 F# 工具附带的 F# 编译器？

不是AFAIK。

# mongodb - 无法使用 mongo shell 连接到远程 mongodb

> ID：14063370
> 
> 赞同：1
> 
> 时间：2012-12-28T01:14:36.117
> 
> 标签：mongodb, ubuntu

我正在尝试连接到远程 mongodb 服务，但无法弄清楚如何让它工作。遥控器`mongod`在 Ubuntu 机器上运行。我是一个非常新手的 unix 用户，但我有理由确定问题是我可能没有打开防火墙`iptables`，我已经尝试了 mongodb 文档中的命令，但仍然没有成功。

mongodb.conf 相关规则

```
bind_ip = 0.0.0.0
port = 27017
auth = false 
```

网络统计 -A

```
Proto Recv-Q Send-Q Local Address           Foreign Address         State
tcp        0      0 *:28017                 *:*                     LISTEN
tcp        0      0 *:27017                 *:*                     LISTEN 
```

iptables -L -n

```
target     prot opt source               destination
ACCEPT     all  --  0.0.0.0/0            0.0.0.0/0
ACCEPT     all  --  0.0.0.0/0            0.0.0.0/0           state RELATED,ESTABLISHED
ACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0           tcp dpt:22
ACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0           tcp dpt:80
DROP       all  --  0.0.0.0/0            0.0.0.0/0
ACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0           tcp dpt:27017 state NEW,ESTABLISHED
ACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0           tcp dpt:28017 state NEW,ESTABLISHED

Chain FORWARD (policy ACCEPT)
target     prot opt source               destination

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination
ACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0           tcp spt:27017 state ESTABLISHED 
```

iptables 命令按照 mongodb 文档中的说明执行 - [http://docs.mongodb.org/manual/tutorial/configure-linux-iptables-firewall/#patterns](http://docs.mongodb.org/manual/tutorial/configure-linux-iptables-firewall/#patterns)

这是我尝试过的：

浏览器：[http://xx.xx.xx.xx:27017/](http://xx.xx.xx.xx:27017/)无响应。

浏览器：[http://xx.xx.xx.xx:28017/](http://xx.xx.xx.xx:28017/)无响应。

浏览器： http: [//www.hostname.com](http://www.hostname.com:27017/) :27017/无响应。

浏览器： http: [//www.hostname.com](http://www.hostname.com:28017/) :28017/无响应。

mongo.exe xx.xx.xx.xx:27017（远程）`couldn't connect to server xx.xx.xx.xx`

mongo xx.xx.xx.xx:27017（来自本地主机）正确连接

mongo www.hostname.com:27017 （来自本地主机）正确连接

它通过托管 mongodb 的服务器上的 localhost 正确连接的事实，即使我指定了 IP 地址，也让我认为这一定是防火墙问题。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-28T01:36:45.560

`iptables`规则完全按照它们出现的顺序阅读。您现在`DROP`优先于`ACCEPT`您的 mongodb 端口。

将设置 iptables 的特定脚本中的行打乱，然后刷新并重新读取它们。

如果您尚未保存防火墙，请删除该`DROP`规则并重新添加它，它会将其移到列表中并解决您的问题。

# scala - 类型论中所有 Kind 实例的共同超类型是什么

> ID：14063372
> 
> 赞同：7
> 
> 时间：2012-12-28T01:15:24.697
> 
> 标签：scala, haskell, semantics, type-systems, type-theory

我正在尝试设计一个本体，例如可以使用 OWL 或 Topic Maps 定义，其中包括对 List[T] 等多态类型的支持，其中 T 是 Interval Kind In(Nothing, Any) 的类型参数，List 是函数种类 * -> *. 最终，我想用足够详细和严谨的语义语言描述类型系统本体，它可以成为用相同语义语言编写的类型安全软件代码的基础。

考虑到这个目标，我试图找出种类的层次结构，其中类型、间隔种类和函数种类都是种类的实例。所有种类的共同“超类”有正式名称吗？我能想到的最好的术语是“Kind Instance”。这甚至是类型论中的一个有意义的概念吗？即使不是，我也需要这样一个概念来表达诸如（在主题地图术语中）“函数-参数-类型-约束关联有一个角色'允许类型'，其玩家必须是'种类实例'类型'”。

除此之外，我才刚刚开始为这个项目自学类型理论，在完成它之前我还有很多东西要学。我已经阅读了一些关于类型理论的与 scala 相关的论文，包括更高种类的泛型 (http://adriaanm.github.com/files/higher.pdf)，并开始通过 Scala 中的安全类型级抽象 ( http://adriaanm.github.com/files/scalina-final.pdf) 和[Scala 的类型构造函数多态性[pdf]](https://lirias.kuleuven.be/bitstream/1979/2642/5/thesis_adriaan_moors_archive.pdf)。我对 Haskell 的熟悉程度不如 Scala，但我遇到过一些相关的论文，例如[System F with Type Equality Coercions[pdf]](http://research.microsoft.com/en-us/um/people/simonpj/papers/ext-f/fc-tldi.pdf)我需要更深入地掌握 Haskell 才能理解。如果有人可以建议从初学者级别开始学习 Haskell 类型系统的阅读材料的进展，一直到广义代数数据类型等高级原则，那也将不胜感激。

最后，如果您知道任何现有的尝试使用语义本体语言（如 OWL 或主题映射）来描述类型系统，或者您对如何做到这一点有任何建议，我也很想听听。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-28T02:38:55.797

没有比 Benjamin Pierce 的“类型和编程语言”更好的类型理论介绍了。我认为上面的级别没有标准化的名称，但“排序”是一种常见的选择。另一种常见的选择是直接跳转到依赖类型，并扁平化层次结构，这样毕竟只有一个层次。在这种情况下（在处理逻辑内容通常不那么重要的日常编程语言时）要添加的一个常见类型规则是“Type : Type”规则，例如，3 : Int : Type : 类型 : 类型 : ...

# activerecord - 选项卡不会在 ExtJS 中切换

> ID：14063375
> 
> 赞同：0
> 
> 时间：2012-12-28T01:15:49.940
> 
> 标签：activerecord, extjs, tabs, extjs4.1

我正在运行 ExtJS 4.1，并在下面定义了一个标签打开器：

```
var tabs =   (typeof tabs != 'undefined') ? tabs : this.getMainTabs();
tabs = (typeof tabs == 'string') ? Ext.getCmp(tabs) : tabs;
var have_record = (typeof record != 'undefined' && record != '');

var id = have_record ? record.id : 'new';
var tab_id = 'tab-' + xtypeString + '-' + id;
var checkTab=Ext.getCmp(tab_id);

if(checkTab){
    tabs.setActiveTab(checkTab);
} else {
    var default_params = {xtype: xtypeString, closable : true, id : tab_id};
    var override_params = (typeof params != 'undefined') ? params : {};
    params = Ext.merge(default_params, override_params);

    var checkTab = tabs.add(params);
    tabs.setActiveTab(checkTab);
    (have_record) ? checkTab.setRecord(record) : checkTab.setRecord();
}
return checkTab; 
```

所以发生的事情是我们创建了一个初始选项卡 (tab-a)，然后我们返回主屏幕创建第二个选项卡 (tab-b)。现在当我去点击tab-a时，什么也没有发生。当我返回主屏幕然后单击 tab-a 时，它会打开 tab-b。

有人对为什么会发生这种情况有想法吗？（如果您需要更多数据，请告诉我......虽然我在下面所做的事情似乎很不言自明，但这可能是因为我一直在盯着这个）

这是我们正在创建的带有 xtype 的选项卡

```
{
   xtype: 'tabpanel',
   region: 'center',
   id: 'searchtabs',
   itemId: 'searchtabs',
   listeners: {
       tabchange: {
           fn: me.onSearchtabsTabChange,
           scope: me
       }
    }
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T15:13:21.883

您的 xtype 定义可能有问题，您是在设置`id`还是`itemId`？

另请注意，使用相同的组件创建多个组件`id`可能会在以后导致许多麻烦。如果您要创建一个组件的多个实例，请确保`id`在创建时指定不同的实例——不要在 xtype 定义中指定一个。

# javascript - gif图像未显示在html页面上

> ID：14063385
> 
> 赞同：3
> 
> 时间：2012-12-28T01:18:07.443
> 
> 标签：javascript, jquery, html, gif, animated-gif

我有一个 html 页面，在它等待来自服务器的数据时，它应该显示一个动画`gif`图像以表明它正在等待。

这是代码：

```
 $("#display").append('<img src="/templates/image.gif alt="red" width="30" height="30" " />'); 
```

这是html：

```
 <div style="margin:0 auto;" id="display"></div> 
```

动画 gif 取自 gif 生成器：[http](http://www.ajaxload.info/) ://www.ajaxload.info/并放入相关目录。

但是，在 Google chrome 中显示的只是一个“破损的图片图标”，而在 Firefox 中根本没有显示任何内容。`.gif file`当我`404 error`尝试从服务器访问文件时，它似乎无法访问。尽管我可以在工作区的目录中看到它。

我看不出我可能会遇到什么问题。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-28T01:21:40.600

Firefox 隐藏“损坏的图像”，Chrome/Internet Explorer 显示损坏的图像占位符。

好像你没有关闭 src 属性。

```
$("#display").append('<img src="/templates/image.gif alt="red" width="30" height="30" " />'); 
```

应该

```
$("#display").append('<img src="/templates/image.gif" alt="red" width="30" height="30" />'); 
```

# wildcard - 如果路径被引用，则“javac：找不到文件”

> ID：14063386
> 
> 赞同：0
> 
> 时间：2012-12-28T01:18:19.503
> 
> 标签：wildcard, javac

我构建了一个应用程序来编译和运行 java 文件，它运行完全正常。

由于是用户选择要编译和执行的java文件的路径，所以我引用了路径，以便它可以包含空格和特殊字符。像这样：

```
javac "C:\test project\*.java" 
```

现在，我在另一台计算机上尝试了，现在我遇到了这个错误：

```
javac: file not found: C:\test project\*.java
Usage: javac <options> <source files>
use -help for a list of possible options 
```

如果我删除引号并且路径中没有空格或特殊字符，它可以工作，但对于上面的示例，它包含一个空格，我会收到此错误：

```
javac: invalid flag: C:\test 
Usage: javac <options> <source files>
use -help for a list of possible options 
```

我已经阅读了一些关于此的主题，但我无法找到解决方案。有人有线索吗？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-14T12:03:24.830

尝试**仅**引用路径并在引用**后**添加 *.java 。例如：

```
javac "C:\test project"\*.java 
```

我的测试环境中有一个具有相同模式的脚本，该脚本今天停止工作。经过一些研究，我发现唯一的变化是我已经从 JDK7 更新 7 更新到更新 17，当我回到更新 7 时它又可以工作了。似乎在两者之间的某个地方引入了一个新错误。经过反复试验，我想出了这个解决方法，它适用于旧的和新的 javac。

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T02:07:44.900

`*`对 shell 有意义，对编译器没有意义。当你把它放在`*`引号中时，你将它传递给编译器，不允许 shell 扩展它。您需要引用空格而不引用星号。

但是，最好使用适当的构建工具，例如 ant 或 maven。

# python - 在较大列表中处理可变大小的子列表

> ID：14063387
> 
> 赞同：1
> 
> 时间：2012-12-28T01:18:21.567
> 
> 标签：python, nested-lists, dna-sequence

我是一名生物工程博士生，试图自学 Python 编程以用于自动化我的部分研究，但我遇到了处理更大列表中的子列表的问题，我似乎无法解决。

基本上，我要做的目标是编写一个小脚本，该脚本将处理一个 CSV 文件，其中包含我正在使用各种 DNA 组装方法构建的质粒序列列表，然后吐出我需要的引物序列订购以构建质粒。

这是我正在处理的场景：

当我想构建一个质粒时，我必须在我的 Excel 电子表格中输入该质粒的完整序列。我必须在称为“Gibson”和“iPCR”的两种 DNA 组装方法之间进行选择。每个“iPCR”组装只需要列表中的一行，所以我已经知道如何处理这些人，因为我只需将我正在尝试构建的质粒的完整序列放入一个单元格中。另一方面，“Gibson”组装要求我必须将完整的 DNA 序列分成更小的块，所以有时我需要 Excel 电子表格中的 2-5 行来完整描述一个质粒。

所以我最终得到了一个看起来像这样的电子表格：

构造......策略......名称

1.....Gibson.....P(OmpC)-cI::P(cI)-LacZ 控制器
1.....Gibson.....P(OmpC)-cI::P(cI )-LacZ 控制器
1......Gibson......P(OmpC)-cI::P(cI)-LacZ 控制器
2......iPCR.......P(cpcG2)-带 K1F 位置的 K1F 控制器。反馈
3 .....Gibson .....P(cpcG2)-K1F 控制器与交换启动子位置
3 .....Gibson .....P(cpcG2)-K1F 控制器与交换启动子位置
4.. ...iPCR.......P(cpcG2)-K1F 控制器，具有更强的 K1F RBS 库

我认为这个长度的列表具有足够的代表性。

所以我遇到的问题是，我希望能够遍历列表并处理吉布森，但我似乎无法让代码以我想要的方式工作。这是我到目前为止编写的代码：

```
#import BioPython Tools
from Bio.Seq import Seq
from Bio.Alphabet import IUPAC

#import csv tools
import csv
import sys
import os

with open('constructs-to-make.csv', 'rU') as constructs:
    construct_list = csv.reader(constructs, delimiter=',')
    construct_list.next()
    construct_number = 1
    primer_list = []
    temp_list = []
    counter = 2

    for row in construct_list:
        print('Current row is row number ' + str(counter))
        print('Current construct number is ' + str(construct_number))
        print('Current assembly type is ' + row[1])
        if row[1] == "Gibson": #here, we process the Gibson assemblies first
            print('Current construct number is: #' + row[0] + ' on row ' + str(counter) + ', which is a Gibson assembly')
##            print(int(row[0]))
##            print(row[3])
            if int(row[0]) == construct_number:
                print('Adding DNA sequence from row ' + str(counter) + ' for construct number ' + row[0])
                temp_list.append(str(row[3]))
                counter += 1
            if int(row[0]) > construct_number:
                print('Current construct number is ' + str(row[0]) + ', which is greater than the current construct number, ' + str(construct_number))
                print('Therefore, going to work on construct number ' + str(construct_number))
                for part in temp_list: #process the primer design work here
                    print('test')
##                    print(part)
                construct_number += 1
                temp_list = []
                print('Adding DNA from row #' + str(counter) + ' from construct number ' + str(construct_number))
                temp_list.append(row)
                print('Next construct number is number ' + str(construct_number))
                counter += 1
##            counter += 1
        if str(row[1]) == "iPCR":
            print('Current construct number is: ' + row[0] + ' on row ' + str(counter) + ', which is an iPCR assembly.')
            #process the primer design work here
            #get first 60 nucleotides from the sequence
            sequence = row[3]
            fw_primer = sequence[1:61]
            print('Sequence of forward primer:')
            print(fw_primer)
            last_sixty = sequence[-60:]
##            print(last_sixty)
            re_primer = Seq(last_sixty).reverse_complement()
            print('Sequence of reverse primer:')
            print(re_primer)
            #ending code: add 1 to counter and construct number
            counter += 1
            construct_number += 1
##            if int(row[0]) == construct_number:
##        else:
##            counter += 1
##            construct_number += 1
##    print(temp_list)

##        for row in temp_list:
##    print(temp_list)        
##    print(temp_list[-1])
#                fw_primer = temp_list[counter - 1]. 
```

（我知道代码可能看起来很菜鸟 - 除了介绍性 Java，我从未做过任何编程课程。）

这段代码的问题在于，如果我有 n 个试图通过“Gibson”组装构建的“构造”（又名质粒），它将处理前 n-1 个质粒，但不会处理最后一个。然而，我也想不出任何更好的方法来编写这段代码，但我可以看到，对于我试图实现的工作流程，知道如何处理列表中的“n”个事物，但每个“事物“可变数量的行，对我来说真的很方便。

我真的很感谢这里的任何人的帮助！非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T01:29:52.067

> 这段代码的问题在于，如果我有 n 个试图通过“Gibson”组装构建的“构造”（又名质粒），它将处理前 n-1 个质粒，但不会处理最后一个。

这实际上是一个普遍的问题，最简单的解决方法是在循环后添加一个检查，如下所示：

```
for row in construct_list:
    do all your existing code
if we have a current Gibson list:
    repeat the code to process it. 
```

当然，您不想重复自己……所以您将这项工作转移到一个函数中，在这两个地方都调用它。

但是，我可能会用不同的方式写这个，使用[`groupby`](http://docs.python.org/2/library/itertools.html#itertools.groupby). 我知道这乍一看可能看起来“太高级了”，但值得尝试看看你是否能理解它，因为它让事情变得简单多了。

```
def get_strategy(row):
    return row[0]
for group in itertools.groupby(construct_list, key=get_strategy): 
```

现在，您将获得每个构造作为单独的列表，因此您根本不需要`temp_list`。例如，第一组将是：

```
[[1, 'Gibson', 'P(OmpC)-cI::P(cI)-LacZ controller'],
 [1, 'Gibson', 'P(OmpC)-cI::P(cI)-LacZ controller'],
 [1, 'Gibson', 'P(OmpC)-cI::P(cI)-LacZ controller']] 
```

接下来将是：

```
[[2, 'iPCR', 'P(cpcG2)-K1F controller with K1F pos. feedback']] 
```

最后不会有剩下的群体需要担心。

所以：

```
for group in itertools.groupby(construct_list, key=get_strategy):
    construct_strategy = get_strategy(group[0])
    if construct_strategy == "Gibson":
        # your existing code, using group instead of temp_list,
        # and no need to maintain temp_list at all
    elif construct_strategy == 'iPCR":
        # your existing code, using group[0] instead of row 
```

一旦克服了抽象障碍，以这种方式思考问题就会简单得多。

事实上，一旦你开始直观地掌握迭代器，你就会开始发现`itertools`（以及它的文档页面上的食谱、第三方库`more_itertools`以及你可以自己编写的类似代码）将很多复杂的问题变得非常简单那些。“如何在行列表中跟踪当前匹配行组？”的答案。是“保留一个临时列表，并记住在每次组更改时检查它，然后在最后再次检查是否有剩余”，但是等效问题的答案“如何将行迭代转换为行组迭代？” 是“将迭代器包装在`groupby`.”中。

您可能还想添加一个`assert`或其他检查`all(row[1] == construct_strategy for row in group[1:])`，`len(group) == 1`在这种`iPCR`情况下，没有意外的第三个策略等，所以当您不可避免地遇到错误时，更容易判断它是否是坏数据或错误的代码。

同时，与其使用 a `csv.reader`，跳过第一行并用无意义的数字引用列，不如使用 a [`DictReader`](http://docs.python.org/library/csv.html#csv.DictReader)：

```
with open('constructs-to-make.csv', 'rU') as constructs:
    primer_list = []
    def get_strategy(row):
        return row["Strategy"]
    for group in itertools.groupby(csv.DictReader(constructs), key=get_strategy):
        # same as before, but with
        # ... row["Construct"] instead of row[0]
        # ... row["Strategy"] instead of row[1]
        # ... row["Name"] instead of row[2] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T01:31:04.327

只是一些关于 python 的一般编码帮助。如果您还没有阅读 PEP8，请这样做。

为了保持清晰的代码，将变量分配给记录/行中引用的字段会很有帮助。

我会为引用的任何字段添加类似的内容：

```
construct_idx = 0 
```

另外，我建议使用字符串格式，它更干净。

所以：

```
print('Current construct number is: #{} on row {}, which is a Gibson assembly'.format(row[construct_idx], counter)) 
```

代替：

```
print('Current construct number is: #' + row[0] + ' on row ' + str(counter) + ', which is a Gibson assembly') 
```

如果您正在创建一个 csv 阅读器对象，则将其设置为变量名“*_list”可能会导致误导。称它为“*_reader”更直观。

```
construct_reader = csv.reader(constructs, delimiter=',') 
```

代替：

```
construct_list = csv.reader(constructs, delimiter=',') 
```

# ios - 带有块回调的自定义 UIAlertView

> ID：14063389
> 
> 赞同：0
> 
> 时间：2012-12-28T01:18:28.867
> 
> 标签：ios, block, uialertview, objective-c-blocks

MyAlertView（UIAlertView 的子类）有这个方法：

```
- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex {
    if (self.clickedButtonAtIndexBlock != NULL)
        self.clickedButtonAtIndexBlock(buttonIndex);
} 
```

我的问题是创建警报视图时如何定义回调？显然这是错误的：

```
alert.clickedButtonAtIndexBlock = ^{
    NSLog(@"clicked: %d", buttonIndex);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-02-26T13:54:49.120

我写了一篇关于如何（以及为什么）将块回调添加到警报视图、操作表和动画的博客文章：

[http://blog.innovattic.com/uikitblocks/](http://blog.innovattic.com/uikitblocks/)

如果您只想要一个有效的实现，您可以从 GitHub 下载源文件：

[https://github.com/Innovattic/UIKit-Blocks](https://github.com/Innovattic/UIKit-Blocks)

用法：

```
UIAlertView* alert = [[UIAlertView alloc] initWithTitle:@"My easy alert"  
                                                message:@"Would you like to perform some kind of action?"
                                      cancelButtonTitle:@"No"
                                      otherButtonTitles:@"Yes", nil];
[alert setHandler:^(UIAlertView* alert, NSInteger buttonIndex) {
    NSLog(@"Perform some kind of action");
} forButtonAtIndex:[alert firstOtherButtonIndex]];
[alert show]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-28T01:42:06.613

尝试做这样的事情（我还没有测试过）：

```
.h
typedef void (^MyClickedIndexBlock)(NSInteger index);

@interface YouInterface : YourSuperclass
@property (nonatomic, strong) MyClickedIndexBlock clickedIndexBlock;
@end

.m
//where you have to call the block
if (self.clickedIndexBlock != nil)
    self.clickedIndexBlock(buttonIndex);

// where you want to receive the callback
alert.clickedIndexBlock = ^(NSInteger index){
    NSLog(@"%d", index);
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-09-25T13:12:05.357

检查这个[OpinionzAlertView](https://github.com/Opinionz/OpinionzAlertView)我在几个项目中使用过它，对我很有用。这是示例：

```
OpinionzAlertView *alert = [[OpinionzAlertView alloc] initWithTitle:@"title"
                                                            message:@"message"
                                                  cancelButtonTitle:@"No, thanks"
                                                  otherButtonTitles:@[@"Done"]
                                            usingBlockWhenTapButton:^(OpinionzAlertView *alertView, NSInteger buttonIndex) {

                                                NSLog(@"buttonIndex: %li", (long)buttonIndex);
                                                NSLog(@"buttonTitle: %@", [alertView buttonTitleAtIndex:buttonIndex]);
                                            }];
[alert show]; 
```

我希望它对你有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-28T01:48:55.633

试试这个

假设您创建了一个名为 MyCustomAlert 的类，并将其声明为该变量。

```
MyCustomAlert *myCustomAlert = [[MyCustomAlent alloc] init]; 
```

你可以把它放在你的头文件中。

```
- (void)setCompletion:(void (^)(int selectedButtonIndex))completion; 
```

你会把它放在你的实现文件中

```
typedef void (^IntBlock)(int intBlock);
IntBlock _completion;

- (void)setCompletion:(void (^)(int selectedButtonIndex))completion{
    _completion = completion;
} 
```

现在在您声明“myCustomAlert”的项目中。如果你输入

```
[myCustomAlert setCompletion: // And select the autocomplete item 
```

你最终会得到这个

```
[myCustomAlert setCompletion:<#^(int intBlock)completion#>] 
```

值 <#^(int intBlock)completion#> 将显示为像这样的气泡。

![在此处输入图像描述](../Images/73f180ad2c7302c849f529333229601a.png)

当您按回车键时，它将填写块供您使用。

```
[myCustomAlert setCompletion:^(int selectedButtonIndex) {

} 
```

当您想在自定义类中触发 _completion 块时，您可以在代码中的某处调用它，如下所示。

```
- (void) callCompletionWithButtonIndex:(int) index{
    if (_completion != nil) _completion(index);
} 
```

希望能消除复杂性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-11T23:17:08.993

我编写了一个简单的类 LMSVBlocks 来轻松显示警报并在 1 行中获取块回调。希望您会发现它对此有用

[https://github.com/sourabhverma/LMSVBlocks](https://github.com/sourabhverma/LMSVBlocks)

**概念：**要使 UIAlertView 块兼容，您需要另一个类（例如 LMSVBlockAlert）来处理委托方法，当 UIAlertView 委托将给出回调时，LMSVBlockAlert 类可以在块中发送回调。

**代码：** （LMSVBlockAlert.m）

将 LMSVBlockAlert 的所有实例维护在一个数组中，以便它们具有强引用

```
static NSMutableArray *_LMSVblockHandlersArray = nil; 
```

将块处理程序保留在 LMSVBlockAlert

```
@interface LMSVBlockAlert() <UIAlertViewDelegate>
@property (nonatomic, copy) void (^cancelCompletionBlock)();
@property (nonatomic, copy) void (^confirmCompletionBlock)();
@end 
```

当触发新警报时，创建具有 UIAlertView 和委托回调的 LMSVBlockAlert 新实例

```
+(LMSVBlockAlert*)newInstance{
    LMSVBlockAlert *newIns = [[LMSVBlockAlert alloc] init];
    [LMSVBlockAlert updateHandlerArrayWith:newIns];
    return newIns;
} 
```

当在 LMSVBlockAlert 中触发警报委托时，发送回调以阻止并从内存中清除它

```
- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex{

    switch (buttonIndex) {
        case 0://Cancel
        {
            if(_cancelCompletionBlock){
                _cancelCompletionBlock();
            }
        }
            break;
        case 1://OK
        {
            if(_confirmCompletionBlock){
                _confirmCompletionBlock(alertView);
            }
        }
            break;
        default:
            break;
    }
    [_LMSVblockHandlersArray removeObject:self];
} 
```

现在你可以有两个简单的方法可以给你 UIAlertView 回调

```
+(UIAlertView*)promptAlertTwoBtn:(NSString*)msg title:(NSString*)title onCancel:(void (^)())onCancel onConfirm:(void (^)())onConfirm{

    return [[LMSVBlockAlert newInstance] showAlertMainWithTitle:title msg:msg onCancel:^{
        onCancel();
    } onConfirm:^(UIAlertView *alertView) {
        onConfirm();
    }];
}

-(UIAlertView*)showAlertMainWithTitle:(NSString*)title msg:(NSString*)msg onCancel:(void (^)())onCancel onConfirm:(void (^)(UIAlertView*))onConfirm{

    UIAlertView *newAlert = nil;

    newAlert = [[UIAlertView alloc]
                    initWithTitle:title
                    message:msg
                    delegate:self
                    @"Cancel"
                    otherButtonTitles:@"Confirm", nil];

    [newAlert show];

    self.cancelCompletionBlock = onCancel;
    self.confirmCompletionBlock = onConfirm;

    return newAlert;
} 
```

**最后** 希望你发现它有用..

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-01-26T04:18:25.137

您可以简单地使用来自 github 的这些类别类。

[Alert_ActionSheetWithBlocks](https://github.com/gurmundi7/Alert_ActionSheetWithBlocks)

这为 AlertView 和操作表提供了 Dismiss 块。

例如。

```
UIAlertView* alert = [[UIAlertView alloc] initWithTitle:@"AlertView+Block" message:@"WithBlocks" delegate:self cancelButtonTitle:@"Cancel" otherButtonTitles:@"newAlertViewWithTextFields",@"newAlertViewWithSingleTextField", nil];
[alert showWithFinishBlock:^(UIAlertView *alertView, NSInteger buttonIndex) 
{ if (buttonIndex == 0) { } else if (buttonIndex == 1) { } }]; 
```

除此之外，它还提供文本字段的方法..

```
-(void) showWithFinishBlock:(FinishBlock_)block_; //-- AlertView with TextField [simple or secure]

-(void) showWithTextFieldBlock:(TextFieldBlock_)block_ secure:(BOOL)isSecure; //-- AlertView with two textfields username & password 
```

您可以查看与它捆绑的示例。我希望它对你有帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-02-06T03:06:10.520

我用 Swift 写了一个简单的扩展，希望对你有帮助

```
import UIKit

extension UIAlertView {

    func show(completion: (alertView: UIAlertView, buttonIndex: Int) -> Void){
        self.delegate = AlertViewDelegate(completion: completion)
        self.show()
    }

    class func showInput(title: String?, message: String?, cancellable: Bool, completion: (text: String?) -> Void){

        var strOK = NSLocalizedString("OK",comment: "OK")
        var strCancel = NSLocalizedString("Cancel",comment: "Cancel")
        var alert = UIAlertView(title: title, message: message, delegate: nil, cancelButtonTitle: cancellable ? strCancel : strOK)
        alert.alertViewStyle = UIAlertViewStyle.PlainTextInput
        if(cancellable) {
            alert.addButtonWithTitle(strOK)
        }
        alert.show { (alertView, buttonIndex) -> Void in
            if(cancellable && alertView.cancelButtonIndex == buttonIndex) {
                completion(text: nil)
                return
            }
            completion(text: alertView.textFieldAtIndex(0)?.text)
        }
    }

    private class AlertViewDelegate : NSObject, UIAlertViewDelegate {
        var completion :  (alertView: UIAlertView, buttonIndex: Int) -> Void
        var retainedSelf : NSObject?
        init(completion: (UIAlertView, Int) -> Void ) {
            self.completion = completion
            super.init()

            self.retainedSelf = self
        }

        func alertView(alertView: UIAlertView, didDismissWithButtonIndex buttonIndex: Int) {
            var retain = self
            retain.retainedSelf = nil
            retain.completion(alertView: alertView, buttonIndex: buttonIndex)
        }
    }
} 
```

# ruby - RSpec 类变量测试

> ID：14063395
> 
> 赞同：10
> 
> 时间：2012-12-28T01:19:48.817
> 
> 标签：ruby, rspec

我正在使用 RSpec 在 gem 中测试类级别的实例变量（和设置器）。我需要测试以下内容：

1.  如果从未使用过设置器，则会提供正确的默认值。
2.  变量可以通过设置器成功更新。

显然这里有一个运行顺序问题。如果我使用设置器更改值，我会忘记默认值是什么。我可以在 setter 测试之前将它保存到一个变量中，然后在最后重置该值，但这只有在所有 setter 测试都遵循相同的做法时才能保护我。

测试变量默认值的最佳方法是什么？

这是一个简单的例子：

```
class Foo
  class << self
    attr_accessor :items
  end
  @items = %w(foo bar baz) # Set the default
  ...
end

describe Foo do

  it "should have a default" do
    Foo.items.should eq(%w(foo bar baz))
  end

  it "should allow items to be added" do
    Foo.items << "kittens"
    Foo.items.include?("kittens").should eq(true)
  end
end 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-28T01:26:04.797

```
class Foo
  DEFAULT_ITEMS = %w(foo bar baz)

  class << self
    attr_accessor :items
  end

  @items = DEFAULT_ITEMS
end

describe Foo do
  before(:each) { Foo.class_variable_set :@items, Foo::DEFAULT_ITEMS }

  it "should have a default" do
    Foo.items.should eq(Foo::DEFAULT_ITEMS)
  end

  it "should allow items to be added" do
    Foo.items << "kittens"
    Foo.items.include?("kittens").should eq(true)
  end
end 
```

或者也许更好的方法是重新加载类

```
describe 'items' do
  before(:each) do
    Object.send(:remove_const, 'Foo')
    load 'foo.rb'
  end
end 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-12-11T12:13:28.247

如果你的班级有你想测试的内部状态，我发现使用`class_variable_get`一种很好的方法来解决这个问题。这不需要您公开类中的任何变量，因此类可以保持不变。

```
it 'increases number by one' do
    expect(YourClass.class_variable_get(:@@number)).to equal(0)
    YourClass.increase_by_one()
    expect(YourClass.class_variable_get(:@@number)).to equal(1)
end 
```

我知道这不是您在问题中所要求的，而是在标题中，这让我来到了这里。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-05-22T16:08:55.697

我发现这个问题追求一个稍微不同的问题——清除 rspec 示例之间的缓存类变量。

在一个模块中，我有一个昂贵的类配置，我像这样缓存它：

```
module Thingamizer
  def config
    @config ||= compute_config_the_hard_way()
  end
end

class Thing
   extend Thingamizer
end 
```

在我对 Thing 的 rspec 测试中，`compute_config_the_hard_way`仅第一次调用。后续调用使用缓存版本，即使我`compute_config_the_hard_way`在其他测试中模拟返回不同的东西。

我通过在每个示例之前清除 @config 解决了这个问题：

```
 before { Thing.instance_variable_set(:@config, nil) } 
```

现在我被挂断的是@config 是一个*类*变量，而不是一个实例变量。我尝试了很多`class_variable_set`没有运气的变体。

这里的问题是 Thing（类）实际上是 Class 的一个*实例*。所以在类方法中看似是类变量的东西*实际上是*一个实例变量，在Class的一个实例中（即Thing）。一旦我把我的头脑围绕在这个想法上，使用`instance_variable_set`而不是`class_variable_set`完全有意义。

有关将类变量作为实例变量的讨论，请参阅[在类方法中使用实例变量 - Ruby](https://stackoverflow.com/questions/9311347/using-instance-variables-in-class-methods-ruby)。

# javascript - 复杂的 JS 对象填充可点击列表和表单

> ID：14063400
> 
> 赞同：0
> 
> 时间：2012-12-28T01:20:08.113
> 
> 标签：javascript, jquery, json, forms

在这段代码中，我引入了一个非结构化的字符串，并将其解析为一个 JS 对象。我现在需要将其应用于 Web 表单。

[这是演示](http://jsfiddle.net/T59fL/1/)。它显示已解析/结构化对象层次结构，并提醒目标项目的示例。

1.  创建关键项目的可点击列表（即按钮、图像、标签等

2.  单击列表项，使用值填充表单

3.  修改值并保存回对象

有一些警告：

1.  有重复的键。我不知道如何在保持数据完整性的同时使它们独一无二。我不能嵌套它们。我唯一能想到的就是为它们附加一个唯一的 id
2.  理想情况下，表单将根据对象中的字段动态生成字段。（即“按钮”具有宽度、高度、过渡和名称，而“标签”具有不同的字段集。
3.  一些元素是嵌套的（即“滚动”有自己的“按钮”和“标签”

任何帮助将不胜感激。下面的代码确实创建了一个元素列表，但我无法让它根据我的点击将值加载到表单中。

这是代码

```
 //Parse String
var str = 'View\n{\n    Name: View1;\n    Image\n    {\n        BackgroundImage: Image.gif;\n        Position: 0, 0;\n        Width: 320;\n        Height: 480;\n    }\n\n    Button\n    {\n        BackgroundImage: Button.gif;\n        Transition: View2;\n        Position: 49, 80;\n        Width: 216;\n        Height: 71;\n    }\n\n    Button\n    {\n        BackgroundImage: Button2.gif;\n        Position: 65, 217;\n        Width: 188;\n        Height: 134;\n    }\n\n    Label\n    {\n        Position: 106, 91;\n        Width: 96;\n        Height: 34;\n        Text: "Button";\n        FontSize: 32;\n        Color: 0.12549, 0.298039, 0.364706, 1;\n    }\n    Scroll\n    {\n        Position: 106, 91;\n        Width: 96;\n        Height: 34;\n        Button{\n            BackgroundImage: Button2.gif;\n            Position: 65, 217;\n            Width: 188;\n            Height: 134;\n        }\n        Button{\n            BackgroundImage: Button2.gif;\n            Position: 65, 217;\n            Width: 188;\n     \n      Height: 134;\n        }\n\n    }\n\n}';

str = str.replace(/(\w+)\s*\{/g, "$1:{"); // add in colon after each named object
str = str.replace(/\}(\s*\w)/g, "},$1"); // add comma before each new named object
str = str.replace(/;/g, ","); // swap out semicolons with commas
str = str.replace(/,(\s+\})/g, "$1"); // get rid of trailing commas
str = str.replace(/([\d\.]+(, [\d\.]+)+)/g, "[$1]"); // create number arrays
str = str.replace(/"/g, ""); // get rid of all double quotes
str = str.replace(/:\s+([^\[\d\{][^,]+)/g, ':"$1"');  // create strings

$("#parseList").html(str);

var objStr;
eval("objStr={" + str + "};");

//console.log(objStr.View.Button)
//alert(objStr.View.Scroll.Button.Width);
//End Parse String

$(document).ready(function () {

    //Build Initial Object LIst
    var initObjectList = '<div id="prePop">';
    $.each(objStr.View, function (k, v) {
        initObjectList += '<div class="inLineObjects">' + '<div class="key">' + k + '</div>' + '</div>';

    });
    initObjectList += '</div>';
    $('#code').append(initObjectList) 
```

对象输出示例：

```
 View:{
    Name:"View1",
    Image:{
        BackgroundImage:"Image.gif",
        Position: [0, 0],
        Width: 320,
        Height: 480
    },

    Button:{
        BackgroundImage:"Button.gif",
        Transition:"View2",
        Position: [49, 80],
        Width: 216,
        Height: 71
    },

    Button:{
        BackgroundImage:"Button2.gif",
        Position: [65, 217],
        Width: 188,
        Height: 134
    },

    Label:{
        Position: [106, 91],
        Width: 96,
        Height: 34,
        Text:"Button",
        FontSize: 32,
        Color: [0.12549, 0.298039, 0.364706, 1]
    },
    Scroll:{
        Position: [106, 91],
        Width: 96,
        Height: 34,
        Button:{
            BackgroundImage:"Button2.gif",
            Position: [65, 217],
            Width: 188,
            Height: 134
        },
        Button:{
            BackgroundImage:"Button2.gif",
            Position: [65, 217],
            Width: 188,

      Height: 134
        }

    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T03:04:05.530

解决方案：http: [//jsfiddle.net/kHysL/](http://jsfiddle.net/kHysL/)

这是我的解决方案：

```
 var str = 'View\n{\n    Name: View1;\n    Image\n    {\n        BackgroundImage: Image.gif;\n        Position: 0, 0;\n        Width: 320;\n        Height: 480;\n    }\n\n    Button\n    {\n        BackgroundImage: Button.gif;\n        Transition: View2;\n        Position: 49, 80;\n        Width: 216;\n        Height: 71;\n    }\n\n    Button\n    {\n        BackgroundImage: Button2.gif;\n        Position: 65, 217;\n        Width: 188;\n        Height: 134;\n    }\n\n    Label\n    {\n        Position: 106, 91;\n        Width: 96;\n        Height: 34;\n        Text: "Button";\n        FontSize: 32;\n        Color: 0.12549, 0.298039, 0.364706, 1;\n    }\n    Scroll\n    {\n        Position: 106, 91;\n        Width: 96;\n        Height: 34;\n        Button{\n            BackgroundImage: Button2.gif;\n            Position: 65, 217;\n            Width: 188;\n            Height: 134;\n        }\n        Button{\n            BackgroundImage: Button2.gif;\n            Position: 65, 217;\n            Width: 188;\n     \n      Height: 134;\n        }\n\n    }\n\n}';

str = str.replace(/(\w+)\s*\{/g, "$1:{"); // add in colon after each named object
str = str.replace(/\}(\s*\w)/g, "},$1"); // add comma before each new named object
str = str.replace(/;/g, ","); // swap out semicolons with commas
str = str.replace(/,(\s+\})/g, "$1"); // get rid of trailing commas
str = str.replace(/([\d\.]+(, [\d\.]+)+)/g, "[$1]"); // create number arrays
str = str.replace(/"/g, ""); // get rid of all double quotes
str = str.replace(/:\s+([^\[\d\{][^,]+)/g, ':"$1"');  // create strings

$("#parseList").html(str);

var objStr;
eval("objStr={" + str + "};");

//End Parse String

$(document).ready(function () {
    var selected;
    //Build Initial Object LIst
    var initObjectList = '<div id="main">';
    $.each(objStr.View, function (k, v) {
        initObjectList += '<div>' + k + '</div>';

    });
    initObjectList += '</div>';
    $('#main').append(initObjectList)

    $(document).on('click', '#main div div', function () {
        var index = $('#main div div').index(this);

        $(this).click(function () {
            $('#form div').remove();
            codeSnippet = "";
            x = $('#main div div').toArray();
            codeSnippet = (x[index].innerHTML);
            console.log(codeSnippet);

            var initObjectDetail = '<div id="form">';
            $.each(objStr.View[codeSnippet], function (k, v) {
                initObjectDetail += '<div>' + k + '</div>' + '<input value=' + v + '>' + '</input>';
                console.log(v);

            });
            initObjectList += '</div>';
            $('#form').append(initObjectDetail)
        });

    });
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T01:50:40.110

如果我对您的理解正确，那么您最好的选择可能是在构建时为每个表单构建表单`objStr.View,`，但保持该表单隐藏（CSS `display:none`）。然后，当用户点击一个时，您所要做的`$(thatForm).show()`就是设置好。

# java - Java中的惰性集合

> ID：14063403
> 
> 赞同：6
> 
> 时间：2012-12-28T01:20:17.203
> 
> 标签：java, collections

考虑一个问题，我正在开发像 Collection 这样的树。

我的 Collection 的主要功能之一是逐个跟踪所有存储的项目，然后为每个项目调用**给定函数，直到满足****给定条件**（惰性集合）。

因此该函数应具有以下签名：

```
void Trace(function func, criteria crit)
{
    item i = firstItem();
    while (i != endItem())
    {
        i = nextItem();
        func(i);
        if (crit(i))
            return;
    }
} 
```

in`C++`函数指针可用于`func`和`crit`。
在`C#`,`yield`关键字正是这个问题的解决方案，我相信。

我怎样才能在 Java 中得到同样的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T01:34:28.673

在 Java 中，您将传递对实现适用功能的类的对象的引用，或者使用 Commons Collections 代替：

*   使用部件[`Predicate`](http://commons.apache.org/collections/apidocs/org/apache/commons/collections/Predicate.html)的实现`crit`。
*   使用部件[`Closure`](http://commons.apache.org/collections/apidocs/org/apache/commons/collections/Closure.html)的实现`func`。

例如：

```
Closure c = new Closure() {
    public void execute(Object obj) {
        ...
    }
};

Predicate p = new Predicate() {
    public boolean evaluate(Object obj) {
        ...
    }
}

Trace(c, p); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-28T01:35:35.880

您在这里寻找的是[策略](http://en.wikipedia.org/wiki/Strategy_pattern)设计模式。

此模式的目标是将算法的实现抽象为 Strategy 对象。在这里，您的算法是您要传入的`func`和函数。`crit`

所以，你会有一个接口，叫做`TraceStrategy`. 然后，您将此接口的实现传递到您的集合中。你的代码看起来像

```
void Trace(TraceStrategy traceStrategy)
{
    item i = firstItem();
    while (i != endItem())
    {
        i = nextItem();
        traceStrategy.func(i);
        if (traceStrategy.crit(i))
            return;
    }
} 
```

和

```
interface TraceStrategy {
   public boolean crit(item i);

   public void func(item i);
} 
```

你可能想让这个通用，这样你就不会被束缚在`item`……但你明白了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-28T01:34:00.907

创建一个声明方法的接口，并要求引用实现该接口的对象作为参数。调用者可以使用匿名内部类创建对象。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-28T01:38:52.477

您可以通过结合几种技术使这个`trace`函数在 Java 中正常工作：

*   而不是“函数指针”，您的参数`func`应该`crit`是实现特定接口的对象实例。然后你可以在对象的这个接口上调用一个函数`i`。实际上，这是一个具有两个不同访问者参数的访问者模式。
*   您还需要一些方法来遍历树。您可以实现`Iterator`- 这为您提供了一种遍历整个结构的好方法。或者，您可以进行`trace`递归（它在树的左右分支上调用自身），然后您就不需要迭代器了。

迭代器版本看起来像这样：

```
public void trace(IFunction func, ICriteria crit) {
    for (T i: this) {
        func.call(i);
        if (crit.test(i)) return;
    }
} 
```

这里`T`是集合的项类型，`call`和分别是和接口`test`中的函数定义。`IFunction``ICriteria`

# javascript - 如何将下拉菜单保留在 ActiveX 之上

> ID：14063405
> 
> 赞同：3
> 
> 时间：2012-12-28T01:20:52.697
> 
> 标签：javascript, css, activexobject

我在所有页面上都有一个由 JavaScript 创建的下拉菜单，有些列最多有 20 个项目。此下拉列表显示在 Mozilla 浏览器中所有内容的最上方，但在 Internet Explorer 中，当 ActiveX 对象显示在其下方时，它会被部分覆盖。

我曾尝试在 DIV 层中显示 ActiveX 并设置 z-index，但到目前为止我还没有找到可行的解决方案。向对象标签添加样式没有效果......

```
<object etc style='z-index:3;'> 
```

将样式应用于包含对象的 DIV 也没有效果......

```
<div align="center" style="z-index:2;"> 
```

下拉菜单应用了 z-index=1。向对象添加“wmode”参数也不起作用......

```
<param name='wmode' value='transparent'> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T03:56:22.593

显然问题在于进程内插件与进程外插件。进程内插件（和 activex）将在与网页本身相同的环境中运行并遵循 z 顺序。但在进程中很少见。大多数浏览器在单独的进程中运行插件和activex，因此网页在一个进程中，而activex/plugin 在不同的进程中。浏览器通过使插件/activex 在包含网页的屏幕区域中绘制自身来使其看起来像一个单一的过程，但是您了解它的烟雾和镜子，并且 z 排序实际上被忽略了。它绘制网页（包括菜单）然后导致插件/activex 绘制。

解决它的唯一方法（并不总是有效）是将 html 菜单包装在 iframe 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-18T20:31:59.827

我想在这里扩展这个问题。WilliamK 提供的答案*有点*朝着正确的方向，但并没有真正解释问题的真正原因，也没有提供足够的解决方案。

问题的主要原因是某些 UI 元素是在**窗口**上下文（与无窗口）中呈现的，这基本上意味着它是在一个单独的操作系统级进程中呈现的，该进程发生*在浏览器之上，*而不是*在*浏览器内. 这遵循了 WilliamK 试图解释的内容，除了现在的浏览器是多线程的，因此“进程外”并不能说明全部情况。 [这是 windowed vs. windowless 的一个很好的解释](http://neugierig.org/software/chromium/notes/2009/07/windowed-windowless-plugins.html)。

一个简单的解决方案不是*在*iframe 中渲染某些内容，而是让 iframe位于您想要在另一个窗口对象之上渲染的任何内容的*后面。*这最好通过例子来解释。假设它`<object>`是一些在其自己的窗口上下文中呈现的 ActiveX 或 Flash 对象：

```
<style>
.overlay {
    position: absolute;

    /* adjust for your site - values shown here are arbitrary */
    width: 600px;
    height: 600px;
    top: 100px;
    left: 100px;
    z-index: 1;
    overflow: auto;
}

.overlay-content {
    position: relative;
    z-index: 2;
}

.overlay iframe {
    position: absolute;
    z-index: 1;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
}
</style>

<body>
    <object ...></object>
    <div class="overlay">
        <div class="overlay-content">This is content you want to appear on top of the windowed object</div>
        <iframe border="0"></iframe>
    </div>
</body> 
```

# javascript - 改变一个对象的属性也会影响另一个对象

> ID：14063406
> 
> 赞同：2
> 
> 时间：2012-12-28T01:21:00.560
> 
> 标签：javascript, jquery, html, canvas, kineticjs

**问题：**当我改变`points`一个多边形的`poly2`时候，它也改变了`points`另一个多边形的`poly`！

为什么改变一个也会改变另一个，**我们如何将它们解耦**？

```
console.log(poly.getPoints()[1].x);  // 100

// Make a change to `poly2`
poly2.setPoints(poly.getPoints());
poly2.getPoints()[1].x=200

console.log(poly.getPoints()[1].x);  // 200 (both poly and poly2 are affected!) 
```

**jsfiddle：http:** [//jsfiddle.net/8hFyv/](http://jsfiddle.net/8hFyv/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T01:25:24.417

```
poly2.setPoints(poly.getPoints()); 
```

这是你的问题。点数组是同一个对象。

由于您的数组中有数组，因此该`slice(0)`技巧不起作用，您需要深拷贝。

幸运的是，您使用的是 jQuery，它有一个方法可以做到这一点。

将上面的行替换为：

```
poly2.setPoints($.extend(true, [], poly.getPoints())); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T01:25:20.227

执行此操作时，您的 poly 和 poly2 对象引用相同的点数组：

```
poly2.setPoints(poly.getPoints()); 
```

将其更改为：

```
poly2.setPoints([0, 0, 100, 0, 100, 100, 0, 100]); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-28T01:34:40.857

要克隆这些点，而不是在多边形之间共享它们，您需要自己为每个点创建新对象。

你可以这样做[`map`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/map)：

```
poly2.setPoints(poly.getPoints().map(function (p) {
    return { x: p.x, y: p.y };
})); 
```

或者，使用[`jQuery.map`](http://api.jquery.com/jQuery.map/)：

```
poly2.setPoints($.map(poly.getPoints(), function (p) {
    return { x: p.x, y: p.y };
})); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-28T01:34:44.340

其他答案在评估问题时是正确的，但还有另一种方法可以解决它：设置点数组时“克隆”它。换句话说：

```
poly2.setPoints(poly.getPoints().slice()); 
```

如果由于某种原因`getPoints()`返回数组以外的东西，您将需要一种不同的克隆方法（例如 axel.michel 建议的方法），但因为我认为它应该对您有用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-28T01:34:50.720

问题是，poly.getPoints 是一组动力学指针对象，要摆脱它，请尝试以下操作：

```
poly2.setPoints(JSON.parse(JSON.stringify(poly.getPoints()))); 
```

# mysql - 当没有日期记录时，MYSQL 查询返回 0

> ID：14063409
> 
> 赞同：0
> 
> 时间：2012-12-28T01:21:40.870
> 
> 标签：mysql, left-join

我有这个查询：

```
Select
  X.type1transsum, Y.type2transsum,
  (X.type1transsum + Y.type2transsum),
  X.`date`
From (
  Select sum(trans) as type1transsum, `date`
  from type1trans where shopcode = 1037
  group by `date`
) X 
Left join (
  Select sum(trans) as type2transsum, `date`
  from type2trans where shopcode = 1037
  group by `date`
) Y on X.`date` = Y.`date` 
```

该`type2trans`表有每个日期的记录，而在`type1trans`某些日子里没有记录（因为那些日子没有交易）。

对于 type1trans 中没有记录的日期，则没有显示 type2 日期的记录，并且该日期的总数与 type2 相同，因为 type1 为空。如何让 type1 为日期返回 null？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T01:29:59.497

使用 a`RIGHT JOIN`而不是 a `LEFT JOIN`（或者只是在查询中交换两个子选择）。

记住[左连接和右连接之间区别的一个有用规则是，左连接包括其](http://phpweby.com/tutorials/mysql/32)*左侧*的每一行，即使右侧没有匹配的行，而右连接相反，包括其*右侧*的每一行。

# c# - 如何在 Action 集合上使用 Task？

> ID：14063410
> 
> 赞同：0
> 
> 时间：2012-12-28T01:22:04.213
> 
> 标签：c#, task-parallel-library

我有一些动作集合。集合中的每个动作都必须在他运行之前等待他之前的动作，例如..

```
 List<Action> actionCollection = new List<Action>()
   {
          func1,
          func2,
          func3
   }; 
```

现在，我想让所有动作在 Task 中运行 - 但 Action1 ( func 1 ) 必须在 Action2 ( func 2 ) 之前运行，并且 Action2 在 Action1 完成之前无法启动。

怎么做 ？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T01:27:12.767

```
public Task ExecuteConsecutivelyAsync(IEnumerable<Action> actions) {
    return Task.Factory.StartNew(delegate {
        foreach (var action in actions) {
            action();
        }
    });
} 
```

您可能希望/需要调用`StartNew`接受 TaskScheduler 的重载并传入`TaskScheduler.FromCurrentSynchronizationContext()`以保持任务在您的 UI 线程上运行。如上所述，它将倾向于在线程池上运行。

# objective-c - 我们应该在 viewDidLoad 还是 viewDidAppear 中调用广告？

> ID：14063420
> 
> 赞同：3
> 
> 时间：2012-12-28T01:24:08.753
> 
> 标签：objective-c, ios, cocoa-touch, admob, iad

我们有一个标签繁重的应用程序，它有 5 个标签可以来回使用。我们有 iAd 和 admobs（作为没有 iAd 的国家/地区的备份），我们在 viewDidLoad 中“调用”广告。在 viewDidAppear 中调用它们会有所不同吗？然后在 viewDidDisappear 中删除它们或为了不搞砸框架等？这会给人更多的印象等吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T01:52:21.257

**viewDidLoad：**

> viewDidLoad 在控制器的视图加载到内存后调用。

```
- (void)viewDidLoad 
```

> 讨论 在视图控制器将其视图层次结构加载到内存后调用此方法。无论视图层次结构是从 nib 文件加载还是在 loadView 方法中以编程方式创建，都会调用此方法。您通常覆盖此方法以对从 nib 文件加载的视图执行额外的初始化。

* * *

**viewDidAppear:**

> viewDidAppear：通知视图控制器其视图已添加到视图层次结构中。

```
- (void)viewDidAppear:(BOOL)animated 
```

> 参数动画 如果是，则使用动画将视图添加到窗口。讨论 您可以覆盖此方法以执行与呈现视图相关的其他任务。如果你重写了这个方法，你必须在你的实现中调用 super 。

**接听**

所以 viewDidLoad 的调用比 viewDidAppear: 稍早一些，唯一的区别是当 viewDidAppear: 视图已经绘制完毕，而在 viewDidLoad 中视图仍然需要绘制。

所以回答你的问题：

> 在 viewDidAppear 中调用它们会有所不同吗？

如果调用广告是一个缓慢的操作，那么您首先会看到以它的颜色显示的视图，然后在几个时间间隔后看到广告。但这必须太慢才能产生真正的影响。

> 然后在 viewDidDisappear 中删除它们或为了不搞砸框架等？

它不会“搞砸框架”，这是肯定的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T01:57:44.947

你只需要在 viewDidLoad 中调用它

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T18:54:59.363

Putting your ad code in viewDidAppear: (and removing it in viewDidDisappear:) will certainly give you more impressions, but unless you're a whitelisted pub, you're probably getting paid on a cost per click basis anyway ([AdMob Help Center article](http://support.google.com/admob/bin/answer.py?hl=en&answer=1619753)).

In this case, instead of having the overhead of creating and destroying GADBannerView objects on tab changes, you might as well create a singleton GADBannerView that you use throughout your TabbedController (look at an example [here](http://code.google.com/p/google-mobile-dev/source/browse/?repo=adcatalog-ios#git/AdCatalog/Classes/AdvancedLayoutUseCases/TabbedViewExample)).

# python - Python Anywhere 拒绝访问 MySQL 数据库

> ID：14063421
> 
> 赞同：6
> 
> 时间：2012-12-28T01:24:19.707
> 
> 标签：python, mysql, django, pythonanywhere

我今天开始使用 [Python Anywhere](http://pythonanywhere.com)。我按照说明创建了数据库 MySQL。问题是我无法执行简单的 manage.py syncdb，因为我的 mysql 数据库中的用户 'irgmedeiros' 出现访问被拒绝错误。我不能向我的用户授予权限，也不能创建另一个具有权限的用户。如何解决？在他们的论坛中找不到解决方案，我正在等待电子邮件的答复。以前有人经历过吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-28T12:22:27.000

一些可能的故障排除步骤：

*   检查服务器地址 -`mysql.server`
*   仔细检查密码 - 是否与您在 pythonanywhere MySQL 配置屏幕上配置的密码相同
*   仔细检查数据库名称 - 这遵循格式`username$database_name`
*   检查是否可以打开一个普通的 mysql 控制台，首先从 MySQL 选项卡，然后在 bash shell 中手动使用

.

```
mysql -u my_username -h mysql.server -p 
```

[编辑] - 最终解决方案是：

*** 仔细检查数据库名称 - 这遵循格式`username$database_name`**

别忘了那些`username$`人！

# python - 接收空表单的烧瓶

> ID：14063423
> 
> 赞同：24
> 
> 时间：2012-12-28T01:24:50.127
> 
> 标签：python, html, forms, post, flask

我正在尝试在 Flask 中为我自己的教育设置一个简单的表单。我有一个带有此表单代码的 login.html 页面：

```
<form action="{{ url_for('login') }}" method="post">
    <div>
        <label for="username">Username</label>
        <div>
            <input type="text" id="username" name="username" placeholder="Username">
        </div>
    </div>
    <div>
        <label for="password">Password</label>
        <div>
            <input type="password" id="password" name="password" placeholder="Password">
        </div>
    </div>
    <div >
        <input class="btn" type="submit">
    </div>
</form> 
```

我正在使用如下代码来接收它，但 Flask 返回一个空`request.form`，所以我无法处理它。

```
@app.route('/login', methods=['GET', 'POST'])
def login():
    if request.method == 'POST':
        request.form['username']
        ... 
```

我现在真的不想学习另一个库（WTForms），而且我正在使用引导程序，这样会增加头痛。Flask/HTML 在这里我看不到什么？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2016-05-26T09:24:48.067

我遇到了这个问题，但这是因为我忘记为`name`我的输入元素分配一个属性，而我试图通过`id`属性引用访问表单数据

IE

*我的*HTML 和 Python如下所示

HTML

```
<input type="text" id="usernameTxtBx"> 
```

Python

```
request.form['usernameTxtBx'] 
```

我*现在*所做的：

HTML

```
<input type="text" name="username" id="usernameTxtBx"> 
```

Python

```
request.form['username'] 
```

我还需要确保我正在使用`POST`请求。一个`GET`请求在我的 python 代码中给了我一个空字典。

OP没有犯这些错误。但这可能会对偶然发现此线程的人有所帮助。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2016-03-18T11:05:01.110

我有那个问题。一些工具，如邮递员或一些库或网络浏览器，以烧瓶不识别为发布值的方式发送数据。从我的角度来看，这是一个烧瓶问题。

这是我用来解决它的解决方法： 1 - 我使用 json 发送信息。看看这个：

> [如何使用 html 表单数据发送 JSON 对象](https://stackoverflow.com/questions/22195065/how-to-send-a-json-object-using-html-form-data)

2 - 我没有使用以下方法获取参数： value = request.form["myparamname"] 我使用了这个：

```
json_data = request.get_json(force=True) 

value = json_data["myparamname"] 
```

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2013-12-03T14:12:05.290

**登录.html**

```
{% extends "layout.html" %}

{% block content %}
  <div class="form">
    <h2>Sign In</h2>

 {% for field in form.errors %}
{% for error in form.errors[field] %}
    <div class="alert alert-error">
        <strong>Oops...</strong> {{error}}.
    </div>
{% endfor %}
{% endfor %}

  <form action="{{ url_for('login') }}" method=post>
    {{ form.hidden_tag() }}

    {{ form.email.label }}
    {{ form.email }}

    {{ form.password.label }}
    {{ form.password }}

      <p> <input id="submit" name="submit" type="submit" class="btn btn-inverse" value="Sign In"></p>
  </form>
</div>
{% endblock %} 
```

**表格.py**

```
 class SigninForm(Form):
        email = TextField("email", [validators.Required("Please enter your email")])
        password = PasswordField('Password', [validators.Required("Please enter a password.")])
        submit = SubmitField("Sign In") 
```

然后在您的视图中导入 signinform 并像这样创建您的登录方法

```
@app.route('/login', methods=['GET', 'POST'])
def signin():
  form = SigninForm()
  if form.validate_on_submit():
      session['email'] = form.email.data

      flash('You are logged in')
      return redirect(url_for('dashboard'))
  return render_template('signin.html', form=form) 
```

有关更详细的说明，请参阅本教程 [http://pypix.com/python/building-flask-blog-part-1/](http://pypix.com/python/building-flask-blog-part-1/)

# php - 如何将 jQuery 自动完成中的多个值保存到 MySQLi DB？

> ID：14063425
> 
> 赞同：0
> 
> 时间：2012-12-28T01:24:53.700
> 
> 标签：php, jquery, jquery-ui, mysqli

我只是在学习 jQuery AutoComplete 小部件。这些值很好地用逗号弹出。因此，对用户的视觉显示很棒。

我的问题是如何将多个值保存到 MySQLi 数据库？

这是代码：

```
 <script>
     $(function() {
      var availableskills = [
        "ActionScript",
        "AppleScript",
         ..........
         more languages
        "XML"
    ];
    function split( val ) {
        return val.split( /,\s*/ );
    }
    function extractLast( term ) {
        return split( term ).pop();
    }

    $( "#skills" )
        // don't navigate away from the field on tab when selecting an item
        .bind( "keydown", function( event ) {
            if ( event.keyCode === $.ui.keyCode.TAB &&
                    $( this ).data( "autocomplete" ).menu.active ) {
                event.preventDefault();
            }
        })
        .autocomplete({
            minLength: 0,
            // could have source as a "url"
            source: function( request, response ) {
                // delegate back to autocomplete, but extract the last term
                response( $.ui.autocomplete.filter(
                    availableskills, extractLast( request.term ) ) );
            },
            focus: function() {
                // prevent value inserted on focus
                return false;
            },
            select: function( event, ui ) {
                var terms = split( this.value );
                // remove the current input
                terms.pop();
                // add the selected item
                terms.push( ui.item.value );
                // add placeholder to get the comma-and-space at the end
                terms.push( "" );
                this.value = terms.join( ", " );
                return false;
            }
        });
});
</script> 
```

现在，这是我让用户选择技能的输入 ID：

```
 <div class="ui-widget">
<!--<label for="skills">Tag programming languages: </label>-->
<input type="text" id="skills" size="50" />
 </div> 
```

不确定如何将用户选择的技能保存到数据库中。我可以轻松地将数据保存到 MySQLi 数据库；问题是我怎样才能说出三个技能并将它们保存到数据库表中的三个不同行中。

任何帮助，非常感谢。

肯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T01:35:21.517

例如，您将使用输入名称技能进行表单发布

```
<form method="post" action="test.php">
<div class="ui-widget">
<input type="text" id="skills" size="50" name='skills' />
</div>
</form> 
```

那么 test.php 将类似于

```
<?php
//...do some mysql connections
$skills = explode(",",$_POST['skills']);
foreach($skills as $skill){
    $statement.="INSERT INTO blahblahblah SET skill = ".mysqli_real_escape_string($skill);
}
$mysqli->multi_query($statement); 
```

# variables - 使用变量控制 Pentaho 转换中的数据流

> ID：14063426
> 
> 赞同：1
> 
> 时间：2012-12-28T01:24:55.220
> 
> 标签：variables, etl, pentaho, jobs, pentaho-design-studio

我想用系统变量控制 pentaho 转换文件中的数据流。我找到了一个名为“简单评估”的组件，这正是我想要的，但它只能在作业文件中使用。我已经经历了从勺子转换的组件树，但找不到像“简单评估”这样的组件树。

谁能给我一些想法，如何制作？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T07:26:18.087

IIRC 您不能在过滤行步骤中使用变量。这可能是一个值得在 jira.pentaho.com 提出的更改请求

因此，只需使用“获取变量”步骤将变量放入流中，然后使用过滤行步骤。（或根据复杂性切换/案例）

# cqrs - 在共享的 Asp.net 环境中部署 CQRS

> ID：14063428
> 
> 赞同：1
> 
> 时间：2012-12-28T01:24:56.897
> 
> 标签：cqrs

我是 CQRS 的新手，但我了解它背后的意图。从我浏览的少数文档中，我不明白如何在共享的 asp.net 托管环境（由 GoDaddy 或 DiscountAsp.net 提供的托管）中部署 CQRS 应用程序/服务。托管服务器是否需要 MSMQ 或类似的消息处理应用程序才能使 CQRS 工作？或者它可以通过 MVC4、WCF 服务或 Asp.net 应用程序中可用的异步通信来工作。

感谢反馈以及任何讨论共享环境中 CQRS 部署方面的链接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T23:39:20.540

> 托管服务器是否需要 MSMQ 或类似的消息处理应用程序才能使 CQRS 工作？

通常是的，但这当然取决于您对 CQRS 的定义。例如，有些人会考虑仅使用不同的读写模型作为 CQRS 的单一数据存储架构。在这种情况下，不需要显式同步读取和写入存储。然而，在通常的意义上，读写之间需要同步，并且通常使用以 MSMQ 为实例的消息传递系统来实现。

> 托管服务器是否需要 MSMQ 或类似的消息处理应用程序才能使 CQRS 工作？

ASP.NET MVC 中的异步用于异步处理单个请求，而不是用于执行后台任务或在进程和/或节点之间传递消息，例如写入和读取存储。

一些建议：

*   考虑在 Azure、AWS、AppHarbor、iron.io 等提供商上托管 CQRS 所需的基础设施。
*   考虑使用 RavenHQ 之类的东西作为数据存储，因为 RavenDB 可以有效地支持开箱即用的 CQRS。在这种情况和前一种情况下，如果绝对必要，您仍然可以使用 GoDaddy 等来托管面向前端的 ASP.NET 应用程序。

# oracle - 想更新表的范围分区上限（Oracle 11gR2）怎么办？

> ID：14063431
> 
> 赞同：0
> 
> 时间：2012-12-28T01:25:06.773
> 
> 标签：oracle, oracle11g

我对生产表的分区上限犯了一个错误，现在我想将表的最新分区更新为较小的值。有没有一种简单的方法可以在不加载数据的情况下重新创建具有较小上限值的分区，然后再加载数据？非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T11:33:42.890

你可以：

1.  拆分上层分区，并删除新的最高分区
2.  与新创建的表交换分区，删除现在为空的上分区，添加新的上分区，并与之交换表。

我希望第一个选项会更好——我相信，如果数据仅包含在一个新分区中，那么在 11g 中拆分分区会得到优化。

# android - 带有图像的 Android WheelView 适配器

> ID：14063432
> 
> 赞同：1
> 
> 时间：2012-12-28T01:25:08.007
> 
> 标签：android

我的 Android 应用程序中有一个 Wheel View。我可以通过查看文本来使用它，但我需要的是查看图像。我看不到有关此问题的任何教程链接。

任何想法都会对我有很大帮助。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T01:36:20.280

[对于在 Android 的WheelView](http://code.google.com/p/android-wheel/)控件中添加图像。您需要通过扩展 AbstractWheelTextAdapter 创建自定义适配器，并使用 TextView 和 ImageView 视图创建行布局 xml。

您可以看到以下在 WheelView 中添加图像的示例：

[http://code.google.com/p/android-wheel/source/browse/trunk/wheel-demo/src/kankan/wheel/demo/CitiesActivity.java](http://code.google.com/p/android-wheel/source/browse/trunk/wheel-demo/src/kankan/wheel/demo/CitiesActivity.java)

# c# - 如何在 C# 中将克转换为磅

> ID：14063433
> 
> 赞同：-1
> 
> 时间：2012-12-28T01:25:11.297
> 
> 标签：c#, unit-conversion

我的问题是如何从公斤转换为磅和盎司？

我知道 1kg=1000gm 和 2 lb 3.274 oz (1 lb = 16 oz)

我将阅读包含以下内容的文件：

> A 重量 3000 gm，B 重量 90 kg

所以 3000 公斤的结果将是**188 磅和 1.6 盎司**。

```
static void ToLB(double Weight, string type)
{
    double Weightgram, kgtopounds;
    // lbs / 2.2 = kilograms
    // kg x  2.2 = pounds

    if (type == "g")
    {
        // convert gram to kg
        Weightgram = Weight * 1000;
        // then convert kg to lb
        kgtopounds = 2.204627 * Weight;
        //convert gram to oz" 

        Weightgram = Weightgram * 0.035274;
        Console.Write("\n");
        Console.Write(kgtopounds);
    }
// I want to convert each gram and kg to pounds and oz using C# 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T01:54:00.420

您应该改为使用`enum`您的类型（也就是说，如果它适合您的文件读取模型等等）。这是我得出的解决方案：

```
public static void ConvertToPounds(double weight, WeightType type)
{
    switch (type)
    {
        case WeightType.Kilograms:
        {
            double pounds = weight * 2.20462d;
            double ounces = pounds - Math.Floor(pounds);
            pounds -= ounces;
            ounces *= 16;
            Console.WriteLine("{0} lbs and {1} oz.", pounds, ounces);
            break;
        }
        default:
            throw new Exception("Weight type not supported");
    }
} 
```

[ideone链接](http://ideone.com/lyO4rC)

# php - API Client 类的真实示例

> ID：14063442
> 
> 赞同：2
> 
> 时间：2012-12-28T01:26:10.720
> 
> 标签：php, api, client

我试图找到一些访问分布式 API 的 PHP 类的简单示例。

每当我搜索 PHP API 客户端时，它会提供太多关于构建 API 本身的信息，而除了 curl 示例之外，几乎没有提供真正的访问方法。一个包含良好 curl 方法和处理请求的方法的 PHP 类会很好。我通过例子和大量的重新安排来学习。

我从一个构造开始，以捕获通常的连接设置：

```
private $hosts = array( URI_1,  URI_2,  URI_3);
private $users = array( USER_1, USER_2, USER_3);
private $pass =  array( PASS_1, PASS_2, PASS_3);

    public function __construct($request = array())
    {
        if (is_array($request)) {
        if(isset($request['hostname'])) {
            if(in_array($request['hostname'], $hosts)) {
                $this->input['hostname'] = $request['hostname'];
            }
        }
        if (isset($request['username'])) {
            if(in_array($request['username'], $users)) {
                $this->input['username'] = $request['username'];
            }
        }
        if (isset($request['password'])) {
            if (in_array($request['password'], $pass)) {
                $this->input['password'] = $request['password'];
            }
        }
        if (isset($this->input['hostname']) &&
                isset($this->input['username']) &&
                isset($this->input['password'])) {
            return true;
        }
    } else {
        return false;
    }
} 
```

一些最佳实践的简单示例将使这变得容易得多。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-28T01:33:12.840

试试[Guzzle](http://guzzlephp.org/)：

> Guzzle 消除了发送 HTTP 请求的痛苦和创建 Web 服务客户端的冗余。
> 
> Guzzle 是一个框架，其中包含创建强大的 Web 服务客户端所需的工具，包括：用于定义 API 输入和输出的服务描述、用于遍历分页资源的资源迭代器、用于尽可能高效地发送大量请求的批处理.

# c# - 如何在 C# 中生成具有 500 个不平衡节点的树

> ID：14063443
> 
> 赞同：-4
> 
> 时间：2012-12-28T01:26:12.777
> 
> 标签：c#

我还是编程新手。

我在树中手动添加节点。如何生成具有 500 或 1000 个不平衡节点的树？也许有 15 个级别，并且每次运行程序时都可能生成。它将生成一棵不同的树。也许在高度或宽度上更多。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using Model.Trees;

/* Adding nodes manully to the tree*/
namespace UserInterface.Samples
{

    public abstract class SampleTree1
    {

        public static Tree TreeSample()
        {
            var tree = new Tree();
            var root = new Node("Burgle House");
            Node node1 = new Node(" Defeat Door security");
            Node node2 = new Node(" Open front OR back doors ");
            Node node3 = new Node(" Open Door using gift card or credit card");
            Node node4 = new Node(" using trees");
            Node node5 = new Node(" Enter via Windows ");
            Node node6 = new Node(" Cover the window in duct tape and gently shatter the enti");
            Node node7 = new Node(" Garage Attack ");
            Node node8 = new Node(" Enter Garage ");
            Node node9 = new Node(" Open car door ");
            Node node10 = new Node(" Brutal Force on the Garage Door)");
            Node node11 = new Node(" Put Door opener code");
            Node node12 = new Node(" EavesDrop opener code)");
            Node node13 = new Node(" Steal opener from Car)");
            Node node14 = new Node(" Cut the hole in the wall or roof ");
            Node node15 = new Node(" Penitrate House ");
            Node node16 = new Node(" Open passger door ");
            Node node17 = new Node("break Down the passanger door");
            Node node18 = new Node(" Pick lock");
            Node node19 = new Node(" Steal Keys");
            Node node20 = new Node(" Cut the hole in the wall or roof ");
            Node node21 = new Node(" Cut the wall or roof ");
            Node node22 = new Node(" Chimney attack ");
            Node node23 = new Node(" Tunnel through the floor ");
            Node node24 = new Node(" Social engineering ");
            Node node25 = new Node(" A bomb blast");
            Node node26 = new Node(" Call a locksmith");

            /*Add nodes to the tree*/

            tree.AddNode(root, null);
            tree.AddNode(node1, root);
            tree.AddNode(node2, node1);
            tree.AddNode(node3, node1);
            tree.AddNode(node4, root);
            tree.AddNode(node5, root);
            tree.AddNode(node6, node5);
            tree.AddNode(node7, root);
            tree.AddNode(node8, node7);
            tree.AddNode(node9, node8);
            tree.AddNode(node10, node9);
            tree.AddNode(node11, node9);
            tree.AddNode(node12, node11);
            tree.AddNode(node13, node11);
            tree.AddNode(node14, node8);
            tree.AddNode(node15, node7);
            tree.AddNode(node16, node15);
            tree.AddNode(node17, node16);
            tree.AddNode(node18, node16);
            tree.AddNode(node19, node16);
            tree.AddNode(node20, node15);
            tree.AddNode(node21, root);
            tree.AddNode(node22, root);
            tree.AddNode(node23, root);
            tree.AddNode(node24, root);
            tree.AddNode(node25, root);
            tree.AddNode(node26, root);

            return tree;
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T02:03:35.213

因为刚刚过了圣诞节。这应该让你继续前进。您只需要调整它以满足您的需求。

```
public class Node
{
    public Node(string name)
    {
        Name = name;
    }

    private List<Node> children = new List<Node>();

    public string Name { get; set; }

    public void Add(Node child)
    {
        children.Add(child);
    }

    public void Print(string prefix)
    {
        Console.WriteLine(prefix + Name);
        prefix = "-" + prefix;
        foreach (var child in children) child.Print(prefix);
    }
}

class Program
{
    static Random  random = new Random();

    public static Node CreateBranch(int depth, int maxDepth, int maxWidth)
    {            
        if (depth > maxDepth) return null;
        var node = new Node(Path.GetRandomFileName());
        int width = random.Next(maxWidth);
        depth++;
        for (var i=0; i<width; i++)
        {
            var child = CreateBranch(depth, maxDepth, maxWidth);
            if (child != null) node.Add(child);
        }
        return node;
    }

    static void Main(string[] args)
    {
        var node = CreateBranch(0, 5, 5);
        node.Print("");
    }
} 
```

# postgresql - 如何创建一个作为一组枚举值的 PostgreSQL 列？

> ID：14063444
> 
> 赞同：1
> 
> 时间：2012-12-28T01:26:43.463
> 
> 标签：postgresql, types, enums

我喜欢我可以[在 PostgreSQL 中创建新的枚举类型](http://www.postgresql.org/docs/9.2/interactive/datatype-enum.html)。但是，如果我想要一个作为一*组*枚举值的列值怎么办。我是否需要使用整数列类型和按位运算符手动实现它，还是有办法继续按名称使用枚举？

```
CREATE TYPE foo AS ENUM ('none', 'loud', 'bright', 'cheap')
CREATE TABLE t (
    id serial,
    properties [set of foo?]
)
...
SELECT * FROM t;
1      loud
2      loud, cheap
3      bright
4      none
... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T07:56:42.093

您可以使用数组：

```
CREATE TYPE foo AS ENUM ('none', 'loud', 'bright', 'cheap');
CREATE TABLE t (
    id serial,
    properties foo[]
); 
```

# python - 是实例化一个新对象更好，还是简单地更新新数据的属性？

> ID：14063445
> 
> 赞同：1
> 
> 时间：2012-12-28T01:26:55.627
> 
> 标签：python, python-2.7

更新属性还是只实例化一个新对象更有效？

例如：

```
class Position(object):
    def __init__(self, x, y, z):
        self.x = x
        self.y = y
        self.z = z

    def update_position(self, x, y, z):
        self.x = x
        self.y = y
        self.z = z

    def new_Position(self, message):
        self.update_position(message[0], message[1], message[2])

def new_Position(message):
    return Position(message[0], message[1], message[2]) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T09:25:58.817

**您不应该进行过早的优化**，更新方法和某种工厂功能之间的选择主要是设计选择。

无论如何，出于好奇，这是两个调用之间的[反汇编代码：](http://docs.python.org/2/library/dis.html#dis.dis)

```
>>> p = Position(1,2,3)
>>> dis.dis(p.new_position)
 11           0 LOAD_FAST                0 (self)
              3 LOAD_ATTR                0 (update_position)
              6 LOAD_FAST                1 (message)
              9 LOAD_CONST               1 (0)
             12 BINARY_SUBSCR       
             13 LOAD_FAST                1 (message)
             16 LOAD_CONST               2 (1)
             19 BINARY_SUBSCR       
             20 LOAD_FAST                1 (message)
             23 LOAD_CONST               3 (2)
             26 BINARY_SUBSCR       
             27 CALL_FUNCTION            3
             30 POP_TOP             
             31 LOAD_CONST               0 (None)
             34 RETURN_VALUE        
>>> dis.dis(new_position)
  2           0 LOAD_GLOBAL              0 (Position)
              3 LOAD_FAST                0 (message)
              6 LOAD_CONST               1 (0)
              9 BINARY_SUBSCR       
             10 LOAD_FAST                0 (message)
             13 LOAD_CONST               2 (1)
             16 BINARY_SUBSCR       
             17 LOAD_FAST                0 (message)
             20 LOAD_CONST               3 (2)
             23 BINARY_SUBSCR       
             24 CALL_FUNCTION            3
             27 RETURN_VALUE 
```

# macos - 双击和控制台打开有什么区别

> ID：14063451
> 
> 赞同：2
> 
> 时间：2012-12-28T01:27:33.387
> 
> 标签：macos, cocoa

我只想打开一个应用程序实例一次，所以我就像
`NSArray *apps = [NSRunningApplication runningApplicationsWithBundleIdentifier:@"com.my.app"];`在 main.m 中一样。
当我从控制台打开应用程序时，应用程序数组的计数将为 0。但是，当我双击应用程序时，它将是1
那么谁能告诉我双击和控制台打开有什么区别？或者给我另一种方法来检查是否已经有一个实例在运行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T01:53:13.040

该命令查询工作区并“延迟”更新

当应用程序从 finder 启动时，它会**通过**启动`NSWorkspace`，因此工作区会立即更新

当应用程序通过控制台/xcode 启动时，它**不会通过 启动** `NSWorkspace`，因此该类在开始时返回 0。在`NSApplication`您的进程启动后，将通知工作区及其 1。

=> 它总是正确的`- (void)applicationDidFinishLaunching:(NSNotification *)aNotification`

* * *

所以要么等待 NSApplication 启动然后杀死它（就像你现在做的那样，但稍后）

或者

请参阅[防止 Linux 上的多个进程实例，](https://stackoverflow.com/questions/2964391/preventing-multiple-process-instances-on-linux)以了解无需可可的方法

或者

你看看可以做到这一点的launchd :) [http://developer.apple.com/library/mac/#documentation/MacOSX/Conceptual/BPSystemStartup/Chapters/CreatingLaunchdJobs.html](http://developer.apple.com/library/mac/#documentation/MacOSX/Conceptual/BPSystemStartup/Chapters/CreatingLaunchdJobs.html)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-28T06:23:41.460

您可以使用以下代码。 `getBSDProcessList`函数将返回`NSArray`正在运行的进程。[[1]](https://stackoverflow.com/a/3772594/944634)

```
static int GetBSDProcessList(kinfo_proc **procList, size_t *procCount)
// Returns a list of all BSD processes on the system.  This routine
// allocates the list and puts it in *procList and a count of the
// number of entries in *procCount.  You are responsible for freeing
// this list (use "free" from System framework).
// On success, the function returns 0.
// On error, the function returns a BSD errno value.
{
    int                 err;
    kinfo_proc *        result;
    bool                done;
    static const int    name[] = { CTL_KERN, KERN_PROC, KERN_PROC_ALL, 0 };
    // Declaring name as const requires us to cast it when passing it to
    // sysctl because the prototype doesn't include the const modifier.
    size_t              length;

    //    assert( procList != NULL);
    //    assert(*procList == NULL);
    //    assert(procCount != NULL);

    *procCount = 0;

    // We start by calling sysctl with result == NULL and length == 0.
    // That will succeed, and set length to the appropriate length.
    // We then allocate a buffer of that size and call sysctl again
    // with that buffer.  If that succeeds, we're done.  If that fails
    // with ENOMEM, we have to throw away our buffer and loop.  Note
    // that the loop causes use to call sysctl with NULL again; this
    // is necessary because the ENOMEM failure case sets length to
    // the amount of data returned, not the amount of data that
    // could have been returned.

    result = NULL;
    done = false;
    do {
        assert(result == NULL);

        // Call sysctl with a NULL buffer.

        length = 0;
        err = sysctl( (int *) name, (sizeof(name) / sizeof(*name)) - 1,
                     NULL, &length,
                     NULL, 0);
        if (err == -1) {
            err = errno;
        }

        // Allocate an appropriately sized buffer based on the results
        // from the previous call.

        if (err == 0) {
            result = malloc(length);
            if (result == NULL) {
                err = ENOMEM;
            }
        }

        // Call sysctl again with the new buffer.  If we get an ENOMEM
        // error, toss away our buffer and start again.

        if (err == 0) {
            err = sysctl( (int *) name, (sizeof(name) / sizeof(*name)) - 1,
                         result, &length,
                         NULL, 0);
            if (err == -1) {
                err = errno;
            }
            if (err == 0) {
                done = true;
            } else if (err == ENOMEM) {
                assert(result != NULL);
                free(result);
                result = NULL;
                err = 0;
            }
        }
    } while (err == 0 && ! done);

    // Clean up and establish post conditions.

    if (err != 0 && result != NULL) {
        free(result);
        result = NULL;
    }
    *procList = result;
    if (err == 0) {
        *procCount = length / sizeof(kinfo_proc);
    }

    assert( (err == 0) == (*procList != NULL) );

    return err;
}

+ (NSArray*)getBSDProcessList
{
    NSMutableArray *ret = [NSMutableArray arrayWithCapacity:1];
    kinfo_proc *mylist;
    size_t mycount = 0;
    mylist = (kinfo_proc *)malloc(sizeof(kinfo_proc));
    GetBSDProcessList(&mylist, &mycount);
    int k;
    for(k = 0; k < mycount; k++) {
        kinfo_proc *proc = NULL;
        proc = &mylist[k];
        NSString *fullName = [[self infoForPID:proc->kp_proc.p_pid] objectForKey:(id)kCFBundleNameKey];
        NSLog(@"fullName %@", fullName);
        if (fullName != nil) 
        {
            [ret addObject:fullName];
        }                                        
    }
    free(mylist);  
    return ret;
}

+ (NSDictionary *)infoForPID:(pid_t)pid 
{
    NSDictionary *ret = nil;
    ProcessSerialNumber psn = { kNoProcess, kNoProcess };
    if (GetProcessForPID(pid, &psn) == noErr) {
        CFDictionaryRef cfDict = ProcessInformationCopyDictionary(&psn,kProcessDictionaryIncludeAllInformationMask); 
        ret = [NSDictionary dictionaryWithDictionary:(NSDictionary *)cfDict];
        CFRelease(cfDict);
    }
    return ret;
} 
```

查看[技术问答 QA1123](http://developer.apple.com/legacy/mac/library/#qa/qa2001/qa1123.html)（获取 Mac OS X 上所有进程的列表）

# c# - 使用 HtmlAgilityPack 从列表中解析图像

> ID：14063454
> 
> 赞同：0
> 
> 时间：2012-12-28T01:28:24.140
> 
> 标签：c#, parsing, html-agility-pack

有一个这样的html页面

```
<li class="liclass">
some html
<a href="blabla" class="first aclass">
some other html
</li>
<li class="liclass">
some html
<a href="blabla" class="first aclass">
some other html
</li>
<li class="liclass">
some html
<a href="blabla" class="first aclass">
some other html
</li>
... 
```

我想从 lis 中获取所有 href，但是这样我仍然可以获取 li 和 a 标签之间的关系。所以首先 li 到第一个标签，第二到第二个等等..

我有这段代码，但它总是返回相同的 a href 上下文：

```
 foreach (var node in docu.DocumentNode.SelectNodes("//li[@class='liclass']"))
 {
    String href = node.SelectNodes("//a[@class='first aclass']")[0].Attributes["href"].Value
    } 
```

我该如何改进该代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T01:42:31.833

你可能想添加所有href

```
 string href="";
 foreach (var node in docu.DocumentNode.SelectNodes("//li[@class='liclass']"))
 {
    href+= node.SelectNodes("//a[@class='first aclass']")[0].Attributes["href"].Value+",";

  } 
```

# ruby-on-rails - 具有 Devise 和 rails 的多个模型的唯一 after_sign_out 路径

> ID：14063455
> 
> 赞同：5
> 
> 时间：2012-12-28T01:28:25.793
> 
> 标签：ruby-on-rails, ruby-on-rails-3, devise

我有一个带有 Devise 2.1 的 rails 3.2 应用程序

我有 2 个使用设计的模型（AdminUser 和 User）

楷模：

```
class AdminUser < ActiveRecord::Base
    devise :database_authenticatable, :registerable,
    :recoverable, :rememberable, :trackable, :validatable
end

class User < ActiveRecord::Base
    devise :database_authenticatable, :registerable,
     :recoverable, :rememberable, :trackable, :validatable
end 
```

我已经通过设计生成器为两个模型生成了单独的视图。AdminUser 的views/devise 文件夹（在新要求之前几个月实施） 用户模型的views/users 文件夹

注销后，我想重定向到与设计模型匹配的特定操作。下面的代码适用于 application_controller.rb 但它适用于我不想做的两个模型：

```
def after_sign_out_path_for(user)
  user_landing_path
end 
```

退出任一模型都会重定向到相同的登录页面，但我希望两个设计模型都有一个唯一的目的地。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-28T03:47:51.377

在查看了这里的一些示例后，我想出了一个解决方案 [http://eureka.ykyuen.info/2011/03/10/rails-redirect-previous-page-after-devise-sign-in/](http://eureka.ykyuen.info/2011/03/10/rails-redirect-previous-page-after-devise-sign-in/)

```
def after_sign_out_path_for(resource_or_scope)
  case resource_or_scope
    when :user, User
      user_landing_path
    when :admin_user, AdminUser
      admin_user_landing_path
    else
      super
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T02:00:19.200

你可以做的一些事情：

```
case user.class
when AdminUser.class
  do_admin_sign_out()
when User.class
  do_user_sign_out()
else
  no_idea_who_you_are()
end 
```

或者

```
if user.kind_of? AdminUser
  do_admin_thing()
else
  do_user_thing()
end 
```

或者，您可以为两个模型添加一个`admin?`检查，并检查，即：

```
if user.admin?
  do_admin_thing()
... 
```

我可能会做后者，因为这可能会出现在其他地方，但这些都是你的选择。

# java - Ajax 调用 Spring 服务

> ID：14063457
> 
> 赞同：2
> 
> 时间：2012-12-28T01:28:45.550
> 
> 标签：java, jquery, ajax, spring-mvc

我正在尝试对我设置的 spring REST 服务进行简单的 ajax 调用。

我的控制器定义如下：

```
@Controller
public class SongPlayerController {
    ....
    @RequestMapping(value = { "/ajax", "/ajax/" }, method = RequestMethod.GET)
    @ResponseBody
    public String ajax() {
        return "New Song URL";
    }
} 
```

然后我有一个带有 ajax 请求的简单 html 页面：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<script type="text/javascript" src="jquery-1.8.3.js"></script>
<title>Insert title here</title>

<script type="text/javascript">
    function loadAjax() {
        $.ajax({
            type : "GET",
            url : "http://localhost:8080/song-player/ajax",
            data : "text",
            success : function(response) {
                $('#ajax').val(response);
            },
            error : function(e) {
                alert('Error: ' + e);
            }
        });
    }

    function getAjax() {
        $.getJSON('http://localhost:8080/song-player/ajax', function(data) {
            alert('Ajax data' + data);
        });
    }
</script>
</head>
<body>
    <button type="button" onclick="loadAjax()">Ajax Call</button>
    <div id="ajax">This will be an ajax call.</div>
</body>
</html> 
```

但是，既不使用也不`$.ajax`返回`$.getJSON`任何东西。使用 ajax 调用时，我收到错误“错误：[object Object]”。

但是，我知道我的控制器设置正确，因为我可以使用[RESTClient Firefox 插件访问](http://restclient.net/)我的服务并获得响应，所以我认为问题在于我如何处理 jQuery 调用，但这是我第一次尝试使用 jQuery，所以我不知道它有什么问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T01:33:52.730

字符串文字`"New Song URL"`不是有效的 JSON。尝试返回这个：

```
@Controller
public class SongPlayerController {
    @RequestMapping(value = { "/ajax", "/ajax/" }, method = RequestMethod.GET)
    @ResponseBody
    public String ajax() {
        return "{\"url\":\"New Song URL\"}";
    }
} 
```

然后按如下方式访问此值：

```
function getAjax() {
    $.getJSON('http://localhost:8080/song-player/ajax', function(data) {
        alert('Ajax data' + data.url);
    });
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-28T03:19:58.803

```
$('#ajax').val(response); 
```

不会工作。这是一个div。利用

```
$('#ajax').text(response); 
```

这就是为什么`loadAjax`不起作用。`getAjax`不起作用，因为正如其他人指出的那样，您的响应不是有效的 json，因此 getJSON 将不起作用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-28T02:47:42.520

您可以使用[JSON-js](https://github.com/douglascrockford/JSON-js)的`stringify()`功能如下：

```
$.getJSON('http://localhost:8080/song-player/ajax', function(data) {
    alert('Ajax data' + JSON.stringify(data));
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-28T14:51:52.880

除了其他人指出的有关 malfomred json 的内容外，我的问题似乎源于试图使用[JSONP](http://en.wikipedia.org/wiki/JSONP)调用我的服务。

我最终修改了控制器以遵循[此博客文章](http://www.fouzi.com/blog/?p=303)，以使用回调参数包装我的响应。

我还将我的 ajax 调用更改为期望 JSONP：

```
function loadAjax() {
        $.ajax({
            type : "GET",
            url : "http://localhost:8080/song-player/ajax.json",
            async : false,
            dataType: "jsonp",
            success : function(response) {
                            $('#ajax').text(response.streamUrl);
                alert('Success: ' + response);
            },
            error : function(e) {
                alert('Error: ' + e);
            }
        }).done(function(data) {
            console.log(data);
            console.log(data.streamUrl);
        });
    } 
```

感谢所有的帮助。

# objective-c - 需要帮助解决Objective-c简单程序输出

> ID：14063458
> 
> 赞同：-2
> 
> 时间：2012-12-28T01:28:45.367
> 
> 标签：objective-c

```
#import <Foundation/Foundation.h>

@interface engine : NSObject

@end

#import "engine.h"

@implementation engine

-(NSString *)discription{
    return (@"I am an engine");
}
@end

#import <Foundation/Foundation.h>

@interface tire : NSObject

@end

#import "tire.h"

@implementation tire
-(NSString *)description{
    return (@"I am a tire, I last for a while");
}
@end

#import <Foundation/Foundation.h>
#import "tire.h"
#import "engine.h"
@interface car : NSObject{
    engine *eng;
    tire *tir[4];
}
-(void)print;
@end

#import "car.h"

@implementation car

-(id)init{
    if(self ==[super init]){
        eng=[engine new];
        tir[0]=[tire new];
        tir[1]=[tire new];
        tir[2]=[tire new];
        tir[3]=[tire new];

    }
    return (self); 
}
-(void)print{
    NSLog(@"%@",eng);
    NSLog(@"%@",tir[0]);
    NSLog(@"%@",tir[1]);
    NSLog(@"%@",tir[2]);
    NSLog(@"%@",tir[3]);
}

@end

#import <UIKit/UIKit.h>
#import "car.h"

int main(int argc, char *argv[])
{
    car *ca;
    ca=[car new];
    [ca print];
    return (0);

} 
```

//在Xcode运行程序时输出结果：

// 2012-12-27 00:55:31.241 CarProject[9341:f803] 引擎：0x686d990

// 2012-12-27 00:55:31.244 CarProject[9341:f803] 我是轮胎，我能坚持一段时间

// 2012-12-27 00:55:31.245 CarProject[9341:f803] 我是轮胎，我能坚持一段时间

// 2012-12-27 00:55:31.246 CarProject[9341:f803] 我是轮胎，我能坚持一段时间

// 2012-12-27 00:55:31.246 CarProject[9341:f803] 我是轮胎，我能坚持一段时间

// 所以引擎无法正确输出字符串。我需要这方面的帮助。谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-28T01:32:56.753

您拼错了`Engine`类的描述方法的名称：应该是`description`，不是`discription`。

# actionscript-3 - 如何从一个类访问事件处理程序到另一个类（第 2 部分）as3

> ID：14063459
> 
> 赞同：-2
> 
> 时间：2012-12-28T01:29:01.757
> 
> 标签：actionscript-3

我有两个名为 Guest 和 Guest2 的课程。我想知道是否可以从 Guest2 类中删除 Guest 类中的事件监听器。下面是完整的代码。注意：两个类的代码完全相同

```
package 
        {
    import flash.display.MovieClip;
        import flash.events.Event;
        import flash.events.MouseEvent;
        import flash.filters.*;

        public class Guest extends MovieClip
        {
            var walkSpeed:Number = 5;
            var oldPosX;
            var oldPosY;

            var myGlow:GlowFilter = new GlowFilter();

            public function Guest()
            {   
                addEventListener(MouseEvent.MOUSE_OVER, addGlow);
            }

            function addGlow(event:MouseEvent):void
            {
                filters = [myGlow];
                addEventListener(MouseEvent.MOUSE_OUT, removeGlow);
                addEventListener(MouseEvent.CLICK, ready);

            }

            function removeGlow(event:MouseEvent):void
            {
                filters = [];
            }

            function ready(event:MouseEvent):void
            {
                filters = [myGlow];
                stage.addEventListener(MouseEvent.MOUSE_DOWN, walk);
                removeEventListener(MouseEvent.MOUSE_OUT, removeGlow);
                **MovieClip(root).Guest02.addEventListener(MouseEvent.CLICK, walkTo);**
            }

            function walk(event:MouseEvent):void
            {
                oldPosX = parent.mouseX;
                oldPosY = parent.mouseY;
                rotation = Math.atan2(oldPosY - y,oldPosX - x) / Math.PI * 180;
                filters = [];
                stage.removeEventListener(MouseEvent.MOUSE_DOWN, walk);
                stage.addEventListener(Event.ENTER_FRAME, loop);
            }

            function loop(event:Event):void
            {
                var dx:Number = oldPosX - x;
                var dy:Number = oldPosY - y;
                var distance:Number = Math.sqrt((dx*dx)+(dy*dy));
                if (distance<walkSpeed)
                {
                    // if you are near the target, snap to it
                    x = oldPosX;
                    y = oldPosY;
                    removeEventListener(Event.ENTER_FRAME, loop);

                }
                else
                {
                    x = x+Math.cos(rotation/180*Math.PI)*walkSpeed;
                    y = y+Math.sin(rotation/180*Math.PI)*walkSpeed;
                }

            }

            **function walkTo(event:MouseEvent):void
            {
                _Guest02.removeEventListener(MouseEvent.CLICK, ready);
            }**

        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T14:10:34.003

正如 Jake King 已经指出的那样，您可能希望从面向对象编程的角度重新审视您的代码。如果你说这两个类共享完全相同的功能，你为什么不设置一个类Guest 并创建两个实例，例如guest1 和guest2。

至于您关于事件处理程序的问题，您需要将侦听器存储在一个公共实例变量中，然后可以从另一个实例访问（不好的样式），或者编写一个允许删除侦听器的专用公共函数，而侦听器变量保持私有：

```
public class Guest extends MovieClip
{
    private var overListener;

    public function Guest()
    {   
        overListener = addEventListener(MouseEvent.MOUSE_OVER, addGlow);
    }

    public function removeOverListener() 
    {
        if (overListener) {
            removeEventListener(MouseEvent.MOUSE_OVER, overListener);
        }
    }

    ...
} 
```

如果 guest1 和 guest2 都是 Guest 的实例，并且 guest1 存储了对 guest2 的引用，那么您可以从 guest1 中删除 guest2 中的侦听器，如下所示：

```
guest2.removeOverListener(); 
```

# uiview - 绘制 UIImage 与 resizableEdgeInsets 在中心与拉伸边

> ID：14063462
> 
> 赞同：0
> 
> 时间：2012-12-28T01:29:10.057
> 
> 标签：uiview, uiimage, drawrect, uiedgeinsets

我认为这是可能的，因为 UIImageView 做得很好。我可以在 UIView 的`drawRect:`方法中以水平居中图像的方式绘制 UIImage，然后拉伸 UIImage 的边以填充 UIView 的提醒吗？

```
- (void)drawRect:(CGRect)rect {
    [[[UIImage imageNamed:@"image"] resizableImageWithCapInsets:UIEdgeInsetsMake(0, 2, 0, 2)] drawInRect:rect];
} 
```

整个图像一直在拉伸。例如，图像是 100 像素宽。中心的90个像素无法拉伸，但两边都有5个像素我想在两边拉伸到矩形的边缘。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T22:47:30.263

恐怕这不是 resizableImageWithCapInsets: 的工作原理。它旨在保持边缘未拉伸并平铺中间位以填充剩余空间。

为了达到我认为你想要的效果，你可能需要并排绘制三个图像。

希望有帮助。

# c++ - Win32 GDI 画圆？

> ID：14063463
> 
> 赞同：4
> 
> 时间：2012-12-28T01:29:13.130
> 
> 标签：c++, gdi, win32gui

我正在尝试画一个圆圈，我目前正在使用 Ellipse() 函数。

我有起始鼠标坐标 - x1 和 y1 以及结束坐标 x2 和 y2。如您所见，我强制 y2(temp_shape.bottom) 为 = y1+(x2-x1)。这不能按预期工作。我知道计算是完全错误的，但是关于什么是正确的有什么想法吗？

代码如下。

```
case WM_PAINT:
        {

            hdc = BeginPaint(hWnd, &ps);
            // TODO: Add any drawing code here...
            RECT rect;
            GetClientRect(hWnd, &rect);

            HDC backbuffDC = CreateCompatibleDC(hdc);

            HBITMAP backbuffer = CreateCompatibleBitmap( hdc, rect.right, rect.bottom);

            int savedDC = SaveDC(backbuffDC);
            SelectObject( backbuffDC, backbuffer );
            HBRUSH hBrush = CreateSolidBrush(RGB(255,255,255));
            FillRect(backbuffDC,&rect,hBrush);
            DeleteObject(hBrush);

            //Brush and Pen colours
            SelectObject(backbuffDC, GetStockObject(DC_BRUSH));
            SetDCBrushColor(backbuffDC, RGB(255,0,0));
            SelectObject(backbuffDC, GetStockObject(DC_PEN));
            SetDCPenColor(backbuffDC, RGB(0,0,0));

            //Shape Coordinates
            temp_shape.left=x1;
            temp_shape.top=y1;
            temp_shape.right=x2;
            temp_shape.bottom=y2;

            //Draw Old Shapes
            //Rectangles
            for ( int i = 0; i < current_rect_count; i++ )
            {
                Rectangle(backbuffDC, rect_list[i].left, rect_list[i].top, rect_list[i].right, rect_list[i].bottom);
            }
            //Ellipses
            for ( int i = 0; i < current_ellipse_count; i++ )
            {
                Ellipse(backbuffDC, ellipse_list[i].left, ellipse_list[i].top, ellipse_list[i].right, ellipse_list[i].bottom);
            }

            if(mouse_down)
            {
                if(drawCircle)
                {

                    temp_shape.right=y1+(x2-x1);

                    Ellipse(backbuffDC, temp_shape.left, temp_shape.top, temp_shape.right, temp_shape.bottom);
                }

                if(drawRect)
                {
                    Rectangle(backbuffDC, temp_shape.left, temp_shape.top, temp_shape.right, temp_shape.bottom);
                }

                if(drawEllipse)
                {
                    Ellipse(backbuffDC, temp_shape.left, temp_shape.top, temp_shape.right, temp_shape.bottom);
                }
            }

            BitBlt(hdc,0,0,rect.right,rect.bottom,backbuffDC,0,0,SRCCOPY);
            RestoreDC(backbuffDC,savedDC);

            DeleteObject(backbuffer);
            DeleteDC(backbuffDC);
            EndPaint(hWnd, &ps);
        }
        break; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T01:50:52.557

如果你想`Ellipse()`画一个完美的圆形，你需要给它一个完美的正方形的坐标，而不是一个矩形。

假设`x1,y1`是拖动的起始坐标并且`x2,y2`是当前鼠标坐标，那么试试这个：

```
//Shape Coordinates
temp_shape.left = min(x1, x2);
temp_shape.top = min(y1, y2);
temp_shape.right = max(x1, x2);
temp_shape.bottom = max(y1, y2);

...

if (drawCircle)
{
    int length = min(abs(x2-x1), abs(y2-y1));

    if (x2 < x1)
        temp_shape.left = temp_shape.right - length;
    else
        temp_shape.right = temp_shape.left + length;

    if (y2 < y1)
        temp_shape.top = temp_shape.bottom - length;
    else
        temp_shape.bottom = temp_shape.top + length;

    Ellipse(backbuffDC, temp_shape.left, temp_shape.top, temp_shape.right, temp_shape.bottom);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T00:12:20.013

我制定了一个效果更好的计算方法。粘贴在下面以供其他想要相同的人使用。

```
if(drawSquare)
                {

                    int xdiff = abs(x2-x1);
                    int ydiff=abs(y2-y1);

                    if(xdiff>ydiff)
                    {
                        if(y2>y1)
                            temp_shape.bottom=y1+xdiff;
                        else
                            temp_shape.bottom=y1-xdiff;
                    }
                    else
                    {
                        if(x2>x1)
                            temp_shape.right=x1+ydiff;
                        else
                            temp_shape.right=x1-ydiff;
                    }

                    Rectangle(backbuffDC, temp_shape.left, temp_shape.top, temp_shape.right, temp_shape.bottom);
                } 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-12-28T01:38:50.610

您的代码对于临时 DC 和后台缓冲区来说过于复杂，并且您在每个 WM_PAIT 中重新创建 GDI 画笔？但这不是重点。这是一个问题：你为什么这样做：

```
temp_shape.right=y1+(x2-x1);  //basing horizontal coordinate on vertical? 
```

这是在什么框架堆栈之上？.NET，那你为什么不使用内置的双缓冲呢？

# c# - 如何限制 MonoTouch 中的 UITextView 字符限制？

> ID：14063465
> 
> 赞同：3
> 
> 时间：2012-12-28T01:29:24.037
> 
> 标签：c#, xamarin.ios, uitextview, xamarin

我希望用户能够在`UITextView`. 这也需要与复制粘贴一起使用。我找到[了这个解决方案](https://stackoverflow.com/a/5897912/458193)，但它是 Objective C，它有一个缺点，即在达到限制后重置光标位置。

我想要的是一个继承自`UITextView`、公开`MaxCharacters`属性并在内部完成所有工作的类。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-28T01:29:24.037

此代码基于[manicaesar 的答案](https://stackoverflow.com/a/5897912/458193)，但在达到限制后不会重置插入符号位置。

```
[Register ("LimitedTextView")]
public class LimitedTextView : UITextView
{
    public int MaxCharacters { get; set; }

    void Initialize ()
    {
        MaxCharacters = 140;
        ShouldChangeText = ShouldLimit;
    }

    static bool ShouldLimit (UITextView view, NSRange range, string text)
    {
        var textView = (LimitedTextView)view;
        var limit = textView.MaxCharacters;

        int newLength = (view.Text.Length - range.Length) + text.Length;
        if (newLength <= limit)
            return true;

        // This will clip pasted text to include as many characters as possible
        // See https://stackoverflow.com/a/5897912/458193

        var emptySpace = Math.Max (0, limit - (view.Text.Length - range.Length));
        var beforeCaret = view.Text.Substring (0, range.Location) + text.Substring (0, emptySpace);
        var afterCaret = view.Text.Substring (range.Location + range.Length);

        view.Text = beforeCaret + afterCaret;
        view.SelectedRange = new NSRange (beforeCaret.Length, 0);

        return false;
    }

    public LimitedTextView (IntPtr handle) : base (handle) { Initialize (); }
    public LimitedTextView (RectangleF frame) : base (frame) { Initialize (); }
} 
```

# objective-c - Admobs 有时会在不同的位置出现两次

> ID：14063469
> 
> 赞同：2
> 
> 时间：2012-12-28T01:29:58.110
> 
> 标签：objective-c, ios, cocoa-touch, admob, iad

我们正在`admobs`为没有`iAd`. 但有时广告会出现两次，第二个广告有时会在屏幕中间比另一个广告高 100-200 像素。似乎第二个广告仅在访问已经有广告的视图时出现。感觉有点像广告调用`viewDidAppear`而不是`viewDidLoad`，但我们没有。或者`didFailToReceiveAdWithError`被外部呼叫- 呼叫`viewDidLoad`广告。有人知道这是什么一回事吗？

**编辑：** 它们可以同时出现，而无需重新访问已经有广告的视图。

**编辑（代码）** 基本上：

```
-(void) viewDidLoad
{
    [self createAdBannerView];
    [self.view addSubview:bannerView];
}

-(void) createAdBannerView
{
    bannerView = [[AdBannerView alloc] initWithFrame:CGRectZero];
    CGRect bannerFrame = bannerView.frame;
    bannerView.frame = bannerFrame;
    bannerView.delegate = self;
    bannerView.requiredContentSizeIdentifiers = [NSSet setWithObjects:ADBannerContentSizeIdentifiersPortrait,AdBannerContentSizeIdentifierLandscape,nil];
}

-(void)bannerView:(AdBannerView*)banner didFailToReceiveAdWithError:(NSError *)error
{
    [self.bannerView removeFromSuperview];
    GbannerView = [[GADBannerView alloc] initWithFrame:CGRectMake(0.0, self.view.frame.size.height-99, 320,50)];
    self.GbannerView.adUnitID=@"xxxxxxx";
    self.GbannerView.rootViewController = self;
    [self.view addSubview:self.GbannerView];
    [self.GbannerView loadRequest:[GADRequest request]];
} 
```

另外，如果有人知道：在包含 tableViews 的视图中，admobs 的位置是错误的。它卡在标签栏后面，即使该位置考虑了这一点。这不会发生在普通的 UIView 中。什么..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T19:05:25.883

我建议您将 tableView 问题提取到它自己的问题中。[这里](http://code.google.com/p/google-mobile-dev/source/browse/?repo=adcatalog-ios#git/AdCatalog/Classes/AdvancedLayoutUseCases/TableViewExample)有一个如何执行此操作的示例，但我不知道这是否满足您的具体情况）。

您是否有理由不只是在这里使用[AdMob 中介](http://mediation.admob.com/)？他们已经获得了对 iAd 的支持，并且使用客户端代码进行设置非常容易。

对于您的具体情况，我想知道: 即使您从其超级视图`bannerView:didFailToReceiveAdWithError`中删除后是否会不断被调用。`AdBannerView`为什么不在:开头创建一个，`GADBannerView`然后在实例化任何新的之前检查它是否存在？`AdBannerView``viewDidLoad`

# html - 960gs：更改特定列的背景颜色

> ID：14063474
> 
> 赞同：1
> 
> 时间：2012-12-28T01:31:06.857
> 
> 标签：html, css, 960.gs

我正在使用 960 网格系统进行网站设计，我希望能够更改特定列的背景颜色。我已经想出了如何通过执行类似的操作来更改整个容器的背景颜色

```
.container_12 {
  background-color: #000000;
  overflow: hidden; /* so that the margin is transparent */
} 
```

但是，如果我想更改 1-3 列的背景颜色怎么办？我希望颜色一直到容器的底部。

例子。假设我有一些 html，例如：

```
<div class="container_12">
  <div class="grid_4 alpha"> a </div>
  <div class="grid_4"> b </div>
  <div class="grid_4 omega"> c </div>
  <div class="grid_1 alpha"> A </div>
  <div class="grid_10"> B </div>
  <div class="grid_1 omega"> C </div>
</div> 
```

我想对其进行样式设置，以便第 1-3 列具有给定的背景颜色。这意味着a div、A div 的前三列和B div 的前两列将具有这种颜色。基本上我想设置列的样式，而不是网格。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T01:36:49.893

你可以这样做：

```
.grid_4.alpha, .grid_1.alpha {
    background-color: blue;
}

.grid_4, .grid_10 {
    background-color: red;
}

.grid_4.omega, .grid_1.omega {
    background-color: green;
} 
```

工作示例：http: [//jsfiddle.net/fewds/tnMhc/](http://jsfiddle.net/fewds/tnMhc/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T02:20:31.943

我不确定我是否理解正确，也不熟悉 960gs 框架。我认为列是根据百分比调整大小的，在这种情况下，我认为我的解决方案会起作用。此外，您的容器需要具有固定的高度，以便从上到下着色。

所以诀窍是：

*   在你的 container_12 中，放一个空的  
*   将其高度设置为 100% 并将背景设置为任何值
*   将其设置为 margin-right ，使其正好等于其宽度的反面

看看这个[http://codepen.io/joe/pen/bwBky](http://codepen.io/joe/pen/bwBky)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-28T08:33:24.100

我认为这里发生的事情是您对网格系统的想法并不完全是它们的预期用途。这很好，因为我最近才开始使用网格系统！

网格系统旨在为您的内容提供结构，而不是样式。

`.grid_4`, `.grid_8`, 和`.grid_12`是列，而不是单元格。如果您希望`div`a 和`div`A 在第一列，您可以将它们一个接一个地放在`.grid_4 alpha`.

并且由于网格系统并不意味着样式，您应该避免样式化网格 CSS，而是创建自己的样式。

所以你的 HTML 最终看起来像这样：

```
<div class="container_12">
  <div class="grid_4 alpha red-column">
    <div>Content-a</div>
    <div>Content-A</div>
  </div>
  <div class="grid_4 green-column">
    <div>Content-b</div>
    <div>Content-B</b>
  </div>
  <div class="grid_4 omega blue-column">
    <div>Content-c</div>
    <div>Content-C</div>
  </div>
</div> 
```

然后您将其添加到您的 CSS 中：

```
.red-column {background-color:#f00;}
.green-column {background-color:#0f0;}
.blue-column {background-color:#00f;} 
```

# visual-studio-2010 - 建成项目清单

> ID：14063478
> 
> 赞同：0
> 
> 时间：2012-12-28T01:31:49.150
> 
> 标签：visual-studio-2010, msbuild, visual-studio-2012

MSBuild 能否捕获它在构建期间“迄今为止”构建的项目列表？

我想要一个`@(ProjectsBuilt)`我可以访问的假设项目列表，其中列出了`csproj`已完成构建的文件。

您可能会问“为什么要使用此功能？” 抽象地说，它与更新或导出依赖项有关——尤其是在增量构建设置中。我举两个例子：

*   Visual Studio 解决方案包含许多“插件”项目。当一些插件被更新和构建时，一个通用脚本“捕获”哪些项目被构建，并立即启动 nuget 打包和存储库上传。
*   Visual Studio 解决方案包含“实现”项目和“接口”项目。换句话说，一些生成的程序集旨在导出以用于其他解决方案。在进行了一些代码更改后，构建任何和所有项目所产生的“接口”程序集随后被导出到一个特殊的“公共”文件夹以供其他应用程序使用。

当然，上述问题可以通过让每个“导出”或“插件”项目包含一个构建后脚本来应用适当的依赖项导出步骤来解决。但是要求在每个参与的 VS 项目中添加构建后步骤是反 DRY 的。

如果 MS build 只是简单地记录“到目前为止”已构建的项目，那么在适当的构建步骤中，所有必要的“依赖项导出”都可以从一个集中的 msbuild 位置一举完成。此功能所针对的项目根本不需要任何每个项目的构建步骤。好的！

# java - 矩阵表达式计算

> ID：14063481
> 
> 赞同：1
> 
> 时间：2012-12-28T01:32:29.307
> 
> 标签：java, matrix

请任何人指出如何进行矩阵乘法的算法（确定乘法的顺序）。我尝试了我可以设计的非常不同的方式，但不幸的是：（例如，我有以下矩阵链之一可以相乘：

```
((((0(((((((((((((((1 2)3)4)5)6)7)8)9)10)11)12)13)14)15)16))17)18)19 

((((((((((((0 1)2)3)4)5)6)7)8)9)10)(11(12(13(14(15(16(1718))))))))19

(((((0 1)(2(((3 4)(5 6))(((7 8)(9(10 11)))((((12 13)14)15)16)))))17)18)19  

(((((((0 1)2)3)4)5)(6(7(8(9(10(11(12 13))))))))(((((14 15)16)17)18)19) 
```

有人可以为所有情况共享一个通用算法吗？

注意：
1.我只需要乘法。
2.矩阵有不同的维度，所以它们不是正方形的。（当然，矩阵的维度是一致的） 3.也许[这个话题](https://stackoverflow.com/questions/2245962/is-there-an-alternative-for-flex-bison-that-is-usable-on-8-bit-embedded-systems/2336769#2336769)会有所帮助，但我真的不知道如何在这里应用它。

提前感谢所有试图提供帮助的人！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T01:42:13.423

您正在寻找的是“矩阵链乘法”。 [http://en.wikipedia.org/wiki/Matrix_chain_multiplication](http://en.wikipedia.org/wiki/Matrix_chain_multiplication)

# java - 更新 OpenGL libGDX 中的边界框

> ID：14063488
> 
> 赞同：0
> 
> 时间：2012-12-28T01:33:44.073
> 
> 标签：java, android, opengl-es, libgdx

我目前有一些物体围绕我的 3D 世界旋转。它们中的每一个都有一个`BoundingBox`与之关联的对象。`glRotate()`调用和后如何更新边界框值`glTranslate()`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T01:39:44.693

为此，您必须遍历每个顶点，计算它在世界中的位置（乘以模型视图）并找到每个对象内的最小/最大顶点坐标（就像您第一次计算它时一样）。

# javascript - 与书签的来回跨域通信

> ID：14063499
> 
> 赞同：1
> 
> 时间：2012-12-28T01:34:51.340
> 
> 标签：javascript, ajax, jsonp, bookmarklet

我想制作一个书签，用户可以添加以在浏览网站时单击。单击小书签会抓取一些页面内容并将其发送到 myserverapi.com

myserverapi.com 然后将回复发送回小书签，然后小书签将结果显示给用户（不会将他们从单击小书签的页面中移开）。用户确认某事，然后数据再次发送回 myserverapi.com

这可能吗？

我知道 JSONP，但据我所知，它仅适用于检索数据：我想知道是否可以以某种方式对信息进行编码并以来回方式发送到服务器。

谢谢！

* * *

啊，在这个用例中，CORS 可以工作，因为我可以控制服务器。无论如何，我想不出需要来回将数据发送到可能“不愿意”的服务器的场景，反之亦然。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T03:46:04.413

因此，如果您有 CORS，为什么不将这些数据发布到服务器？请参阅： [如何使跨域资源共享 (CORS) 发布请求正常工作](https://stackoverflow.com/questions/5750696/how-to-get-a-cross-origin-resource-sharing-cors-post-request-working)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T16:05:47.983

这个问题得到了回答，但如果你不能使用 CORS，这里是答案：

> 我知道 JSONP，但据我所知，它仅适用于检索数据：我想知道是否可以以某种方式对信息进行编码并以来回方式发送到服务器。

你是如此接近，答案就在你的掌握之中。

您可以通过以下两种方式之一将数据发送到服务器：

1.) 最简单的方法是使用 GET。你的 JSONP 脚本可以像 server/jsonp.php?data=antyhing+you+want。因此，这与在同一个域中使用 AJAX 通信的方式基本相同，但不是使用 XMLHttpRequest 来执行 GET，而是附加一个脚本。

2.) 如果要发送的数据超出 GET 可以处理的范围，您可以使用表单和 iFrame 发布数据。其中一个表单变量应包含一个唯一 ID，以便该 POST 用作键。由于 POST 不能返回任何数据，所以您必须使用 GET 方法来获取与该键对应的响应。因为 POST 是异步的，所以您的 GET 应该轮询服务器，直到服务器成功响应，这取决于服务器已收到具有相应密钥的 POST。

# python - 模型上的 Django __getitem__：元类冲突

> ID：14063504
> 
> 赞同：0
> 
> 时间：2012-12-28T01:35:37.860
> 
> 标签：python, django, metaclass, magic-methods

在 Django 中，我想`__getitem__`在类级别上实现（所以在下面的示例中，我想做`Alpha['a']`）。我发现我需要一个元类：就像它需要在类上实现以使其在实例上可访问一样，它必须在元类上实现才能在类级别上使用它，据我所知。

```
class AlphaMeta(type):

    a = 7

    def __getitem__(self, key):
        return getattr(self, key)

class Alpha(models.Model):

    value = models.CharField(max_length = 64, default = '')

    __metaclass__ = AlphaMeta

print Alpha['a'] 
```

问题是我收到以下错误。如果 Alpha 是一个普通的新式类 ( `class Alpha(object)`)，它可以正常工作，但对于更复杂的基础，它需要更多。但是，我不明白它想从我这里得到什么，因为我不明白它是什么`the metaclasses of all it's bases`。

```
metaclass conflict: the metaclass of a derived class must be a 
(non-strict) subclass of the metaclasses of all it's bases 
```

我对元类很陌生；非常感谢任何提示！

*编辑：模型字段进入`Alpha`而不是`AlphaMeta`*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T01:44:09.900

我真的建议避免弄乱模型的元类，因为您很容易遇到一些难以调试的奇怪问题。无论如何，如果您仍想这样做，错误消息会告诉您需要做什么。

`AlphaMeta`需要是 的元类的子类`models.Model`，即`django.db.models.base.ModelBase`. 所以试试

```
from django.db.models.base import ModelBase

class AlphaMeta(ModelBase):
    … 
```

您可能还想在 a 的情况下调用超类实现`KeyError`。

# php - PHP 创建类变量

> ID：14063505
> 
> 赞同：2
> 
> 时间：2012-12-28T01:35:56.973
> 
> 标签：php, variables, static

有什么方法可以在方法内创建类静态变量吗？像这样的东西..

```
class foo {

    public function bind($name, $value) {
         self::$name = $value;
    }

}; 
```

还是有其他解决方案可以将变量绑定到类，然后在没有长而丑陋的语法“$this->”的情况下使用它

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T01:44:47.053

我不确定我是否理解这个问题。但是如果你想在运行时附加变量，你可以这样做：

```
abstract class RuntimeVariableBinder
{
    protected $__dict__ = array();

    protected function __get($name) {
        if (isset($this->__dict__[$name])) {
            return $this->__dict__[$name];
        } else {
            return null;
        }
    }

    protected function __set($name, $value) {
        $this->__dict__[$name] = $value;
    }
}

class Foo
extends RuntimeVariableBinder
{
    // Explicitly allow calling code to get/set variables
    public function __get($name) {
        return parent::__get($name);
    }
    public function __set($name, $value) {
        parent::__set($name, $value);
    }
}

$foo = new Foo();
$foo->bar = "Hello, world!";
echo $foo->bar; // Prints "Hello, world!" 
```

[http://codepad.org/H9bz2uVp](http://codepad.org/H9bz2uVp)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T01:41:49.697

使用`self`将导致致命错误，因为该属性未声明。您必须使用`$this`which 才能作为公共变量访问：

```
<?php
class foo { 
    public function bind($name, $value) {
         $this->$name = $value;
    }

}

$foo = new Foo;
$foo->bind('bar','Hello World');

echo '<pre>';
print_r($foo);
echo $foo->bar;
echo '</pre>';?> 
```

# html - 全屏登录

> ID：14063508
> 
> 赞同：8
> 
> 时间：2012-12-28T01:36:11.810
> 
> 标签：html, css

我正在登录屏幕上工作，我需要让它全屏工作。

我正在尝试将表单放在用户名之上，只是我没有得到正确的位置

这是一个例子：http: [//jsfiddle.net/TSbRY/](http://jsfiddle.net/TSbRY/)

```
 #loginbackground{
        width:100%;
        height:100%;
        position:fixed;
        top:0px;
        left:0px;
        background: url(http://ivojonkers.com/loginscreentemp.jpg) no-repeat center center fixed; 
        -webkit-background-size: cover;
        -moz-background-size: cover;
        -o-background-size: cover;
        background-size: cover;
        filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src='.myBackground.jpg', sizingMethod='scale');
        -ms-filter: "progid:DXImageTransform.Microsoft.AlphaImageLoader(src='myBackground.jpg', sizingMethod='scale')"; 
}

    #loginbackground form{
        width:18.667%;
        height:7.466%;
        position:absolute;
        top:51.4%;
        left:50%;
        margin-left:-8.867%;
 }

    #loginbackground input{
        width:100%;
        height:31.25%;
        background-color:#F00;
        border:none;
        font:Georgia, "Times New Roman", Times, serif;
        font-size:18px;
        position: absolute;
 } 
```

​</p>

我的问题是我想将表单放在用户名和 pas 上，并且在每个屏幕分辨率下都存在，所以当你缩放浏览器时，你需要将表单放在你认为可以输入 img 的部分的顶部.

ash 你可以在这里全屏看到[http://fiddle.jshell.net/TSbRY/show/](http://fiddle.jshell.net/TSbRY/show/)它适用于某些屏幕分辨率，但不适用于所有屏幕分辨率

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-31T06:57:23.140

好吧，有一种方法可以轻松解决这个问题。您可以按照 Bastian Rang 在他的回答中所说的去做，或者您可以继续将该图像分成两张图片。因此，登录信息将是一个单独的图像。这样，您可以通过 css 或 javascript 将其居中并调整大小。并将登录面板设置为相对位置，您可以轻松地将输入放置在内部并轻松移动它。如有必要，我可以解释更多。您面临的问题是因为您拥有的图像结合了输入区域和背景。把它们分开，这会容易得多。

*圣诞快乐，新年快乐！*本着给予的精神，给你：[**[更新] OP登录的设计。**](http://jsfiddle.net/TSbRY/24/) **您需要在 Google Chrome 中查看它并使用它的最新版本。仅在谷歌浏览器上测试。**

```
<div style = "height:100%;width:100%;position:relative;top:0;right:0;left:0;bottom:0;
position:fixed;">
<div style = "background:red;height:55%;top:0;left:0;right:0;position:absolute;background: -webkit-linear-gradient(top, #3BBCFE, #64D5FF,#06ADFE);"></div>
<div style = "background:blue;height:45%;top:55%;left:0;right:0;position:absolute;background: -webkit-linear-gradient(top, #59D2FF,#41C1FE);"></div>
<div style = "background:green;height:20%;width:40%;background: -webkit-linear-gradient(top, #01C5FF,#076799);border-radius:4px;
              box-shadow:0 0 120px 0 rgba(0,0,0,0.5), inset 0 2px 1px 0 rgba(255,255,255,0.5), 0 1px 3px 0 rgba(0,0,0,0.4);position:absolute;left:30%;right:0;top:40%;
              border:1px solid rgba(0,0,0,0.2);border-top:none;border-bottom:1px solid rgba(0,0,0,0.7);">
                  <input type = "text" style = "position:absolute;left:5%;top:18%;right:5%;width:90%;height:25%;border:none;background:#00A2ED;box-shadow:inset 0 1px 8px 0 rgba(0,0,0,0.3), 0 1px 0 0 rgba(255,255,255,0.5),inset 0 1px 2px 0 rgba(0,0,0,0.1);border-radius:4px;"/>
                  <input type = "text" style = "position:absolute;left:5%;top:53%;right:5%;height:25%;width:90%;border:none;background:#00A2ED;box-shadow:inset 0 1px 8px 0 rgba(0,0,0,0.3), 0 1px 0 0 rgba(255,255,255,0.5),inset 0 1px 2px 0 rgba(0,0,0,0.1);border-radius:4px;"/>
</div> 
```

您可以看到我如何使用 position:absolute 和 position:relative 和 % 表示高度、宽度、顶部、底部、左侧和右侧来创建效果。

请不要只是复制它。尝试了解这是如何工作的，从长远来看，它将为您提供更好的服务。

[**[更新！] OP 的登录设计。**](http://jsfiddle.net/TSbRY/24/)

**更新：**我不确定您是否希望我们为您制作图像并为您提供代码。但如果你是，我想说社区不会为你编写代码，而是会引导你走上正确的道路。您需要知道的是选择更智能的路径。诸如“我需要支持所有浏览器”之类的说法是相当不成熟的。首先通过研究现代浏览器趋势以及使用最多的浏览器来选择您的受众。首先选择最好的浏览器开始开发。有超过 160 种浏览器，开发像您这样复杂的详细布局（即 box-shadows）具有挑战性或几乎不可能。所以，基本上有两个选择*纯 css*或*使用图像和 css*. 纯 CSS 可以轻松调整，而图像变得非常静态并且需要时间来创建（如果您不熟悉图形）和/或编辑。图像必须在 Photoshop、Fireworks、GIMP 或 Pixlr.com 之类的工具中制作，以创建图像，然后通过浏览器（使用 css）根据需要对其进行缩放——同样，这并不适合所有浏览器。最后我要说的是，社区不会为你制作图像——那将是你的工作。

免责声明：简单的 html 将在不同的浏览器中完全呈现，但更复杂的涉及 box-shadows 和渐变的则不会。

我制作了一个小图，表示可以实现您正在寻找的完美和跨浏览器兼容性的切口。但这非常具有挑战性。**下载到图像以查看完整分辨率的注释/标记。**

查看*9-patch*图像：基本上，当您决定分解这些图像时使用该概念。

![下载查看笔记](../Images/a394f02a4d3dd84e1a2c01bcd239eee7.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-31T11:10:38.540

你不能。

那是一个图像。

使用像素宽度/高度，您将有一个固定的图像，然后没有全屏；

使用百分比宽度/高度，您将进行图像拉伸/重新缩放，并且您将不知道在哪里或如何重新定位表单字段。

你能做的是

1) 仅使用 CSS 渲染图像，因为它是一个简单的图像，您可以使用 CSS3`Gradients`和属性来实现`Border-radius`；`Box-shadow`

或者

2）使用固定图像，设置`margin: 0 auto`为始终设置在中心。然后，放置背景颜色以填充屏幕的其余部分。

或者

3）将图像拆分为两个图像：调整背景图像（渐变）的大小，同时仅为登录框设置固定宽度/高度，使其始终居中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T00:17:37.287

我没有最终解决方案，但您可以使用一些提示：

1.  您正在混合像素和百分比。这绝不是一个好主意。
2.  为什么你使用图像作为背景？您的示例中的图像仅使用背景渐变的 css 是可能的 - > [http://www.colorzilla.com/gradient-editor/](http://www.colorzilla.com/gradient-editor/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-31T07:55:07.873

我只能建议一种方法，可以有很多。

首先使用背景图片作为实际图片，img 标签。然后使用**z-index**将输入元素绝对放置在其上。使用 jquery .height() 计算图像的高度。然后动态决定输入字段的位置。

```
$(document).ready(function(){
$width=$('img#backimage').width();
$height=$('img#backimage').height();

/*Code to decide the position of box based on image dimensions*/
$('form').css('top','your calculated value');

}) 
```

另一种方法是将您的图像分成两部分。将背景图像分别用于页面和表单。因此，单独使用表单背景图像“蓝色框”并将像素尺寸用作宽度：400 像素并将其调整为中心。这使您可以准确地决定放置元素的位置。

```
form{
background:url('yourbox.png');
width:400px; /*consider this is width of your backg image too*/ 
left:50%;
top:500px;
margin-left:-200px; /*To adjust to center*/
padding-top:20px; /*Adjust according to back image*/
padding-left:10 px;/*Adjust according to back image*/
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-05T16:53:34.260

这是一个图像，使用它你不能让它按照你想要的方式工作。更好的选择是使用 HTML 标记来创建您想要的效果。我创建了一个类似的页面，这是演示 [http://jsbin.com/alivas/1/](http://jsbin.com/alivas/1/)

要检查我使用的代码，请参阅此链接 [http://jsbin.com/alivas/1/edit](http://jsbin.com/alivas/1/edit)

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2012-12-28T01:47:55.570

您是否尝试过更改[z-index](http://www.w3schools.com/cssref/pr_pos_z-index.asp)？

尝试将表单的 z-index 更改为正数：

```
z-index:1; 
```

如果您想查看 z-index 的实际效果：[Go Here](http://www.w3schools.com/cssref/playit.asp?filename=playcss_z-index)

# sql - SQLite - 帮助优化具有多个条件的先前行的聚合总数

> ID：14063514
> 
> 赞同：2
> 
> 时间：2012-12-28T01:37:04.657
> 
> 标签：sql, sqlite, aggregate-functions

我正在尝试获取表中每条记录的值列的条件总和，以获取按相同“类别”字段值和相同“已批准”字段值分组的所有“先前”记录，然后分为负数和正数。

在我的程序中，用户可以按任意顺序创建文档记录，因此“上一个”定义为：

如果*Approved* =TRUE，则“先前”记录的*ApprovedDate*字段值比当前记录旧。如果*ApprovedDate*字段值相同，则“以前的”记录具有较低的*DocumentNumber*字段值。

如果*Approved* =FALSE，则“以前的”记录具有比当前记录更早的*IssuedDate字段值。*如果*IssuedDate*字段值相同，则“以前的”记录具有较低的*DocumentNumber*字段值。

例如，在下表中：

```
CREATE TABLE Changes (GUID TEXT, Value REAL, DocumentNumber TEXT, Approved INTEGER, ApprovedDate TEXT, IssuedDate TEXT, Category TEXT);
INSERT INTO Changes (GUID, DocumentNumber, Approved, Value, ApprovedDate, IssuedDate, Category) VALUES ('4F7253A4E1B3D841B84D4A82B4F0E7A2', '11', 0, 18526.7, '', '2009-03-31T05:00:00Z', 'UNKNOWN');
INSERT INTO Changes (GUID, DocumentNumber, Approved, Value, ApprovedDate, IssuedDate, Category) VALUES ('D97537852E927B499C21C14F3D13CF06', '1', 0, 0, '', '2008-11-10T05:00:00Z', 'UNKNOWN');
INSERT INTO Changes (GUID, DocumentNumber, Approved, Value, ApprovedDate, IssuedDate, Category) VALUES ('857DADB463807345918729B33399B36F', '2', 0, 0, '', '2008-11-10T05:00:00Z', 'UNKNOWN');
INSERT INTO Changes (GUID, DocumentNumber, Approved, Value, ApprovedDate, IssuedDate, Category) VALUES ('7989D242E05AFF4FB5EE99114822BF80', '21', 0, 50112, '', '2009-07-22T05:00:00Z', 'UNKNOWN');
INSERT INTO Changes (GUID, DocumentNumber, Approved, Value, ApprovedDate, IssuedDate, Category) VALUES ('16A0AB27FD3A784D9E0A14406C7683E0', '3', 0, 0, '', '2009-01-15T05:00:00Z', 'UNKNOWN');
INSERT INTO Changes (GUID, DocumentNumber, Approved, Value, ApprovedDate, IssuedDate, Category) VALUES ('D3D7B1C306D38C438FC3DEDFCB57D411', '131', 0, 17204, '', '2010-12-14T05:00:00Z', 'UNKNOWN');
INSERT INTO Changes (GUID, DocumentNumber, Approved, Value, ApprovedDate, IssuedDate, Category) VALUES ('2C89D974DDF86743A0D7D62B385FBDEF', '147', 0, 0, '', '2010-12-01T05:00:00Z', 'UNKNOWN');
INSERT INTO Changes (GUID, DocumentNumber, Approved, Value, ApprovedDate, IssuedDate, Category) VALUES ('F371D4237C837D448824697EB0162905', '198', 0, 0, '', '2011-01-10T05:00:00Z', 'UNKNOWN');
INSERT INTO Changes (GUID, DocumentNumber, Approved, Value, ApprovedDate, IssuedDate, Category) VALUES ('433D64C871AE4E46A0E1BFCE2BB69BA7', '364', 0, 0, '', '2011-11-14T05:00:00Z', 'UNKNOWN');
INSERT INTO Changes (GUID, DocumentNumber, Approved, Value, ApprovedDate, IssuedDate, Category) VALUES ('808496DBDE76CB4F911396BB817724F3', '352', 0, 0, '', '2011-10-17T05:00:00Z', 'UNKNOWN');
INSERT INTO Changes (GUID, DocumentNumber, Approved, Value, ApprovedDate, IssuedDate, Category) VALUES ('9545DEF1666B5F4D8626F19F8E9E9333', '418', 0, 10948, '', '2012-03-07T22:19:18Z', 'UNKNOWN');
INSERT INTO Changes (GUID, DocumentNumber, Approved, Value, ApprovedDate, IssuedDate, Category) VALUES ('244D7D89B79E0F4E91100E4ADB300656', '439', 0, 50945, '', '2012-04-27T20:33:26Z', 'UNKNOWN');
INSERT INTO Changes (GUID, DocumentNumber, Approved, Value, ApprovedDate, IssuedDate, Category) VALUES ('115A427BBB1D2C43BA11D9E5875FAA2C', '465', 0, 480049, '', '2012-07-20T16:17:54Z', 'UNKNOWN');
INSERT INTO Changes (GUID, DocumentNumber, Approved, Value, ApprovedDate, IssuedDate, Category) VALUES ('3A2271EFCC767E4CA40017E68802F10C', '478', 0, 54298, '', '2012-08-01T17:26:38Z', 'UNKNOWN');
INSERT INTO Changes (GUID, DocumentNumber, Approved, Value, ApprovedDate, IssuedDate, Category) VALUES ('99D0EFC5A9F1AA498DB1A4CDF294129B', '490', 0, 11500, '', '2012-09-18T14:23:13Z', 'ALTER');
INSERT INTO Changes (GUID, DocumentNumber, Approved, Value, ApprovedDate, IssuedDate, Category) VALUES ('38B2E3A379C5084998E6A84D496AC555', '491', 0, 26088, '', '2012-09-25T06:00:00Z', 'ALTER');
INSERT INTO Changes (GUID, DocumentNumber, Approved, Value, ApprovedDate, IssuedDate, Category) VALUES ('8902831C8FAD4941841EE2847656BDAF', '494', 0, -825, '', '2012-10-16T14:20:06Z', 'ALTER');
INSERT INTO Changes (GUID, DocumentNumber, Approved, Value, ApprovedDate, IssuedDate, Category) VALUES ('7AFDB08A002AE54A8DE7699855AEBE30', '495', 0, 221, '', '2012-10-16T14:21:27Z', 'ALTER');
INSERT INTO Changes (GUID, DocumentNumber, Approved, Value, ApprovedDate, IssuedDate, Category) VALUES ('38A2CCEF5F0B294AA8B8752F461D121D', '496', 0, 0, '', '2012-12-24T01:11:15Z', 'ALTER');
INSERT INTO Changes (GUID, DocumentNumber, Approved, Value, ApprovedDate, IssuedDate, Category) VALUES ('24CCD5CE409E674593108CBD816DBCCE', '486', 1, -825, '2012-10-01T21:42:52Z', '2012-09-17T20:42:12Z', 'ALTER');
INSERT INTO Changes (GUID, DocumentNumber, Approved, Value, ApprovedDate, IssuedDate, Category) VALUES ('C7458704E36C8F448C1F3A485EB08304', '485', 1, 10000, '2012-10-01T21:25:56Z', '2012-09-11T21:29:44Z', 'ALTER');
INSERT INTO Changes (GUID, DocumentNumber, Approved, Value, ApprovedDate, IssuedDate, Category) VALUES ('B511953AE6FB6446A63AA83C159057BE', '487', 1, 82170, '2012-10-01T21:42:51Z', '2012-09-17T20:46:41Z', 'ALTER');
INSERT INTO Changes (GUID, DocumentNumber, Approved, Value, ApprovedDate, IssuedDate, Category) VALUES ('EC977BC304A971439D04BB9DF4D8188A', '488', 1, 15500, '2012-10-01T20:58:15Z', '2012-09-18T06:00:00Z', 'ALTER');
INSERT INTO Changes (GUID, DocumentNumber, Approved, Value, ApprovedDate, IssuedDate, Category) VALUES ('D9B1F0C0A8E490448697B783639E09E0', '489', 1, 11503, '2012-10-01T21:42:50Z', '2012-09-18T13:56:18Z', 'ALTER');
INSERT INTO Changes (GUID, DocumentNumber, Approved, Value, ApprovedDate, IssuedDate, Category) VALUES ('698BB6D65832D146A49727C717A591A1', '492', 1, 2787, '2012-10-01T21:10:06Z', '2012-09-25T15:55:02Z', 'ALTER');
INSERT INTO Changes (GUID, DocumentNumber, Approved, Value, ApprovedDate, IssuedDate, Category) VALUES ('155D4F2B1854B34FABCDE8CF20F1E44C', '493', 1, 12162, '2012-10-01T21:10:06Z', '2012-09-25T16:04:40Z', 'ALTER');
INSERT INTO Changes (GUID, DocumentNumber, Approved, Value, ApprovedDate, IssuedDate, Category) VALUES ('137C9BF2B1EFD34B8831ADA70C5F9431', '1', 1, 369543, '2011-12-08T13:41:04Z', '1899-12-30T05:00:00Z', 'DRAW');
INSERT INTO Changes (GUID, DocumentNumber, Approved, Value, ApprovedDate, IssuedDate, Category) VALUES ('7F29FC7114BD10468AE92A047345B5DB', '2', 1, 7258, '2011-12-08T13:41:04Z', '2011-10-20T05:00:00Z', 'DRAW');
INSERT INTO Changes (GUID, DocumentNumber, Approved, Value, ApprovedDate, IssuedDate, Category) VALUES ('6B66D8EAD88E6E4FA29401CD524B978A', '3', 1, 979321, '2011-12-08T13:41:04Z', '2011-11-08T05:00:00Z', 'DRAW');
INSERT INTO Changes (GUID, DocumentNumber, Approved, Value, ApprovedDate, IssuedDate, Category) VALUES ('7F393B712B213041A6DD211E04F6DCA6', '4', 1, 14998, '2012-04-20T15:16:21Z', '2012-04-18T21:07:07Z', 'DRAW');
INSERT INTO Changes (GUID, DocumentNumber, Approved, Value, ApprovedDate, IssuedDate, Category) VALUES ('2255F84E7C7DA04389765724872D6413', '5', 1, 58926, '2012-04-20T15:16:23Z', '2012-04-18T21:13:15Z', 'DRAW');
INSERT INTO Changes (GUID, DocumentNumber, Approved, Value, ApprovedDate, IssuedDate, Category) VALUES ('DB4A5588DEB9F34C868F7AD1CB13ACC3', '6', 1, 13232, '2012-04-20T15:16:05Z', '2012-04-18T21:17:00Z', 'DRAW');
INSERT INTO Changes (GUID, DocumentNumber, Approved, Value, ApprovedDate, IssuedDate, Category) VALUES ('B5231AE40F8E7D41BA0A4D09614CBDF9', '7', 1, 10176, '2012-04-20T15:16:25Z', '2012-04-18T21:19:41Z', 'DRAW');
INSERT INTO Changes (GUID, DocumentNumber, Approved, Value, ApprovedDate, IssuedDate, Category) VALUES ('2362D54FCC53E447AC7D8289EA89FD05', '8', 1, 17556, '2012-04-20T15:16:04Z', '2012-04-18T21:21:20Z', 'DRAW');
INSERT INTO Changes (GUID, DocumentNumber, Approved, Value, ApprovedDate, IssuedDate, Category) VALUES ('6ED4565CA041704B8D006EDA4A1E4CF9', '9', 1, 399639, '2012-05-30T16:32:43Z', '2012-05-17T06:00:00Z', 'DRAW');
INSERT INTO Changes (GUID, DocumentNumber, Approved, Value, ApprovedDate, IssuedDate, Category) VALUES ('B21BE07E3E42C2418C70AD17862D3AE1', '10', 1, 6231, '2012-08-16T16:55:00Z', '2012-08-02T16:02:03Z', 'DRAW');
INSERT INTO Changes (GUID, DocumentNumber, Approved, Value, ApprovedDate, IssuedDate, Category) VALUES ('8FD252A50137754A98698F93AC9B01A7', '11', 1, 629, '2012-08-16T16:54:58Z', '2012-08-02T16:07:57Z', 'DRAW');
INSERT INTO Changes (GUID, DocumentNumber, Approved, Value, ApprovedDate, IssuedDate, Category) VALUES ('1B9AFD2C20362F48A486E8A535B29AF5', '20', 1, -113810, '2011-12-13T17:15:53Z', '2010-02-10T05:00:00Z', 'UNKNOWN'); 
```

结果应该是：

**[结果][2]**：

```
|                             GUID |                             SORTID |          VALUE | POSITIVE_PREVIOUS_TOTAL | NEGATIVE_PREVIOUS_TOTAL |
----------------------------------------------------------------------------------------------------------------------------------------------
| 99D0EFC5A9F1AA498DB1A4CDF294129B |   ALTER_0_2012-09-18T14:23:13Z_490 |          11500 |                       0 |                       0 |
| 38B2E3A379C5084998E6A84D496AC555 |   ALTER_0_2012-09-25T06:00:00Z_491 |          26088 |                   11500 |                       0 |
| 8902831C8FAD4941841EE2847656BDAF |   ALTER_0_2012-10-16T14:20:06Z_494 |           -825 |                   37588 |                       0 |
| 7AFDB08A002AE54A8DE7699855AEBE30 |   ALTER_0_2012-10-16T14:21:27Z_495 |            221 |                   37588 |                    -825 |
| 38A2CCEF5F0B294AA8B8752F461D121D |   ALTER_0_2012-12-24T01:11:15Z_496 |              0 |                   37809 |                    -825 |
| EC977BC304A971439D04BB9DF4D8188A |   ALTER_1_2012-10-01T20:58:15Z_488 |          15500 |                   92170 |                    -825 |
| 698BB6D65832D146A49727C717A591A1 |   ALTER_1_2012-10-01T21:10:06Z_492 |           2787 |                  119173 |                    -825 |
| 155D4F2B1854B34FABCDE8CF20F1E44C |   ALTER_1_2012-10-01T21:10:06Z_493 |          12162 |                  121960 |                    -825 |
| C7458704E36C8F448C1F3A485EB08304 |   ALTER_1_2012-10-01T21:25:56Z_485 |          10000 |                       0 |                       0 |
| D9B1F0C0A8E490448697B783639E09E0 |   ALTER_1_2012-10-01T21:42:50Z_489 |          11503 |                  107670 |                    -825 |
| B511953AE6FB6446A63AA83C159057BE |   ALTER_1_2012-10-01T21:42:51Z_487 |          82170 |                   10000 |                    -825 |
| 24CCD5CE409E674593108CBD816DBCCE |   ALTER_1_2012-10-01T21:42:52Z_486 |           -825 |                   10000 |                       0 |
| 137C9BF2B1EFD34B8831ADA70C5F9431 |      DRAW_1_2011-12-08T13:41:04Z_1 |         369543 |                       0 |                       0 |
| 7F29FC7114BD10468AE92A047345B5DB |      DRAW_1_2011-12-08T13:41:04Z_2 |           7258 |                  369543 |                       0 |
| 6B66D8EAD88E6E4FA29401CD524B978A |      DRAW_1_2011-12-08T13:41:04Z_3 |         979321 |                  376801 |                       0 |
| 2362D54FCC53E447AC7D8289EA89FD05 |      DRAW_1_2012-04-20T15:16:04Z_8 |          17556 |                 1453454 |                       0 |
| DB4A5588DEB9F34C868F7AD1CB13ACC3 |      DRAW_1_2012-04-20T15:16:05Z_6 |          13232 |                 1430046 |                       0 |
| 7F393B712B213041A6DD211E04F6DCA6 |      DRAW_1_2012-04-20T15:16:21Z_4 |          14998 |                 1356122 |                       0 |
| 2255F84E7C7DA04389765724872D6413 |      DRAW_1_2012-04-20T15:16:23Z_5 |          58926 |                 1371120 |                       0 |
| B5231AE40F8E7D41BA0A4D09614CBDF9 |      DRAW_1_2012-04-20T15:16:25Z_7 |          10176 |                 1443278 |                       0 |
| 6ED4565CA041704B8D006EDA4A1E4CF9 |      DRAW_1_2012-05-30T16:32:43Z_9 |         399639 |                 1471010 |                       0 |
| 8FD252A50137754A98698F93AC9B01A7 |     DRAW_1_2012-08-16T16:54:58Z_11 |            629 |                 1876880 |                       0 |
| B21BE07E3E42C2418C70AD17862D3AE1 |     DRAW_1_2012-08-16T16:55:00Z_10 |           6231 |                 1870649 |                       0 |
| D97537852E927B499C21C14F3D13CF06 |   UNKNOWN_0_2008-11-10T05:00:00Z_1 |              0 |                       0 |                       0 |
| 857DADB463807345918729B33399B36F |   UNKNOWN_0_2008-11-10T05:00:00Z_2 |              0 |                       0 |                       0 |
| 16A0AB27FD3A784D9E0A14406C7683E0 |   UNKNOWN_0_2009-01-15T05:00:00Z_3 |              0 |                       0 |                       0 |
| 4F7253A4E1B3D841B84D4A82B4F0E7A2 |  UNKNOWN_0_2009-03-31T05:00:00Z_11 | 18526.69921875 |                       0 |                       0 |
| 7989D242E05AFF4FB5EE99114822BF80 |  UNKNOWN_0_2009-07-22T05:00:00Z_21 |          50112 |          18526.69921875 |                       0 |
| 2C89D974DDF86743A0D7D62B385FBDEF | UNKNOWN_0_2010-12-01T05:00:00Z_147 |              0 |          68638.69921875 |                       0 |
| D3D7B1C306D38C438FC3DEDFCB57D411 | UNKNOWN_0_2010-12-14T05:00:00Z_131 |          17204 |          68638.69921875 |                       0 |
| F371D4237C837D448824697EB0162905 | UNKNOWN_0_2011-01-10T05:00:00Z_198 |              0 |          85842.69921875 |                       0 |
| 808496DBDE76CB4F911396BB817724F3 | UNKNOWN_0_2011-10-17T05:00:00Z_352 |              0 |          85842.69921875 |                       0 |
| 433D64C871AE4E46A0E1BFCE2BB69BA7 | UNKNOWN_0_2011-11-14T05:00:00Z_364 |              0 |          85842.69921875 |                       0 |
| 9545DEF1666B5F4D8626F19F8E9E9333 | UNKNOWN_0_2012-03-07T22:19:18Z_418 |          10948 |          85842.69921875 |                       0 |
| 244D7D89B79E0F4E91100E4ADB300656 | UNKNOWN_0_2012-04-27T20:33:26Z_439 |          50945 |          96790.69921875 |                       0 |
| 115A427BBB1D2C43BA11D9E5875FAA2C | UNKNOWN_0_2012-07-20T16:17:54Z_465 |         480049 |         147735.69921875 |                       0 |
| 3A2271EFCC767E4CA40017E68802F10C | UNKNOWN_0_2012-08-01T17:26:38Z_478 |          54298 |         627784.69921875 |                       0 |
| 1B9AFD2C20362F48A486E8A535B29AF5 |  UNKNOWN_1_2011-12-13T17:15:53Z_20 |        -113810 |                       0 |                       0 | 
```

本质上 - 所有记录都按类别和批准字段值分组，然后按批准日期、文档编号（如果批准=TRUE）或颁发日期、文档编号（如果批准=FALSE）排序。最后，在逐个记录的基础上，对具有相同类别和批准值的每个先前记录的值进行计算，在单独的列中报告负数和正数。

我可以通过子选择获得所需的结果，但性能很差（700 条记录需要 6.5 秒）。我一直在尝试将 CASE WHEN 语句与各种 GROUP BY 和 HAVING 子句结合使用，但我似乎无法获得正确的值（我无法获得确定“先前”记录以满足我的要求的逻辑） . 但是，使用这种方法的性能非常好（对于相同的数据集，大多数情况下不到 200 毫秒）。

这是我的尝试（仅限 SQLite，下面是 T-SQL），但需要很长时间：

```
SELECT a.GUID, 
SUM(CASE WHEN b.Value>0 THEN b.Value ELSE 0 END) as positive_previous_total, 
SUM(CASE WHEN b.Value<0 THEN b.Value ELSE 0 END)  as negative_previous_total 
FROM Changes AS a left join Changes as b 
ON b.rowid != a.rowid 
AND b.Approved =a.Approved 
AND b.Category=a.Category 
AND ((IFNULL(SUBSTR(CASE WHEN b.Approved THEN b.ApprovedDate ELSE b.IssuedDate END, 1, 10), '0000-00-00')<IFNULL(SUBSTR(CASE WHEN a.Approved THEN a.ApprovedDate ELSE a.IssuedDate END, 1, 10), '0000-00-00') 
OR ((IFNULL(SUBSTR(CASE WHEN b.Approved THEN b.ApprovedDate ELSE b.IssuedDate END, 1, 10), '0000-00-00')=IFNULL(SUBSTR(CASE WHEN a.Approved THEN a.ApprovedDate ELSE a.IssuedDate END, 1, 10), '0000-00-00') AND b.DocumentNumber<a.DocumentNumber)))) 
GROUP BY a.rowid 
```

这是我的尝试（T-SQL）

```
 SELECT 
    a.[GUID], 
    [positive_previous_total] = SUM(CASE WHEN b.Value>0 THEN b.Value ELSE 0 END), 
    [negative_previous_total] = SUM(CASE WHEN b.Value<0 THEN b.Value ELSE 0 END) 
FROM 
    #Changes a 
    LEFT OUTER JOIN #Changes b 
        ON 
        b.[GUID]    <> a.[GUID] AND
        b.Approved  = a.Approved AND
        b.Category  = a.Category 
        AND 
        (
        ISNULL(SUBSTRING(CASE WHEN b.Approved=1 THEN b.ApprovedDate ELSE b.IssuedDate END, 1, 10), '0000-00-00') 
          < ISNULL(SUBSTRING(CASE WHEN a.Approved=1 THEN a.ApprovedDate ELSE a.IssuedDate END, 1, 10), '0000-00-00')
        OR 
            (
            ISNULL(SUBSTRING(CASE WHEN b.Approved=1 THEN b.ApprovedDate ELSE b.IssuedDate END, 1, 10), '0000-00-00')
              =ISNULL(SUBSTRING(CASE WHEN a.Approved=1 THEN a.ApprovedDate ELSE a.IssuedDate END, 1, 10), '0000-00-00') 
            AND 
            b.DocumentNumber<a.DocumentNumber
            )
        ) 
GROUP BY a.[GUID] 
```

有人对获得我需要的结果有什么建议吗？

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T17:30:29.670

首先-感谢whytheq和以下线程中的贡献者：[这是否可以简化并因此进行优化](https://stackoverflow.com/questions/14073190/can-this-be-simplified-and-therefore-optimized)，即使解决方案由于其局限性而并非全部适用于SQLite，也值得一读。我能够根据将 SELECT 时间减半的建议实施一些优化。

它是如何完成的：

1.  添加了 EffectiveDate 列，当 Approved=TRUE 时 ApprovedDate 的日期部分或 Approved=FALSE 时的 IssuedDate 日期部分存储为整数而不是 ISO8601 文本。

2.  添加了一个名为 EffectiveID 的新列，它将 Category、Approved、零填充的 EffectiveDate 和零填充的 DocumentNumber 存储为单个值，以便更快地进行比较。

3.  在更新 Approved、IssedDate 和 ApprovedDate 列时创建 UPDATE TRIGGER 以更新 EffectiveDate 列。

4.  在 EFfectiveDate、Category、Approved 和 Number 列上创建了一个 UPDATE TRIGGER，以相应地更新 EffectiveID 字段。

5.  在插入新行时创建了一个 TRIGGER 以相应地更新 EffectiveDate。

6.  为 EffectiveDate 和 EffectiveID 列添加了索引

7.  重新安排 ON 子句测试以减少匹配数，减少处理

8.  将 JOIN 更改为仅选择结果集中所需的列子集。

最终的SQL如下：

```
SELECT 
a.GUID, 
TOTAL(CASE WHEN b.Value>0 THEN b.Value ELSE 0 END) as positive_previous_total, 
TOTAL(CASE WHEN b.Value<0 THEN b.Value ELSE 0 END) as negative_previous_total 
FROM 
Changes AS a 
LEFT JOIN 
(SELECT rowid, Value, Category, Approved, EffectiveId FROM Changes) as b 
ON 
b.EffectiveID < a.EffectiveID 
AND b.Category=a.Category
AND b.Approved=a.Approved
AND b.rowid != a.rowid
GROUP BY 
a.rowid 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T08:45:30.317

请参阅[**此处**](https://stackoverflow.com/questions/14073190/can-this-be-simplified-and-therefore-optimized)的建议以了解加快速度的方法。

有两三个重量级人物做出了贡献，所以我会与您的 DBA 取得联系，看看可以做出哪些改变。

似乎共识是您需要在`changes`表上添加一些索引。

我还喜欢将几个计算字段添加到此表中以使后续脚本更具可读性的想法。

如果您能够更改某些数据类型，那么答案中有很多建议。

# python - 哪些 Python Web 框架包含适合生产使用的 Web 服务器？

> ID：14063516
> 
> 赞同：0
> 
> 时间：2012-12-28T01:37:22.473
> 
> 标签：python, frameworks

我需要编写一个非常轻量级的数据库（sqlite 很好）应用程序，该应用程序最初将在客户端 Windows PC 上本地运行，但如果有必要，可以升级以在公共互联网上工作而无需完全重写。

我的最终用户在技术上不是很倾向于，我想让事情尽可能简单。为此，我真的很想避免安装本地网络服务器，但是对你或我来说可能看起来“简单”。Django 特别警告不要在生产中使用它的内置网络服务器，所以我的两个选项似乎是......

a) 当应用程序在 Windows 上本地运行时，无论如何都要使用 django 的内置服务器，如果它需要升级以通过网络工作，只需将其粘贴在云中某处的 linux 机器上的 apache 后面。

b) 从一开始就使用具有更强大的内置 Web 服务器的框架。

我的理解是，django 内置服务器的唯一两个缺点是缺乏安全测试（如果仅在本地运行则没有实际意义），并且它是单线程性质（对于运行的低/零并发单用户应用程序来说可能不是什么大问题本地）。我离基地很远吗？

如果是这样，那么我能否获得一些其他“全栈”框架建议 - 我非常喜欢 python，但如果没有明确的 python 赢家，我也对基于 PHP 和 ruby​​ 的解决方案持开放态度。我可能要支持这个应用程序十年或更长时间，所以我宁愿不使用任何太新或太深奥的东西，除非它来自具有严肃血统的开发人员。

谢谢你的建议 ：）

罗杰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T01:42:41.227

我发现 Django 的管理员对于非技术客户来说非常容易使用。事实上，这是我最近使用 Django 的主要考虑因素。一旦设置正确，非技术人员可以非常轻松地更新信息，并立即反映在前端。

客户感到被赋予了权力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T11:44:08.453

使用`Django`. 您上手非常简单。此外，他们拥有最好的文档。按照一步一步的应用程序创建教程。Django 支持所有存在的数据库。此外，内置服务器非常易于用于开发和生产服务器。我强烈推荐 Django。

# python - len(array) 从解释器工作，在函数内调用时失败

> ID：14063519
> 
> 赞同：1
> 
> 时间：2012-12-28T01:37:37.020
> 
> 标签：python, jython

我有一个简单的函数，当我在我的 Jython 解释器中手动输入它时可以工作，但是当我尝试将代码作为函数运行时，对 len() 的调用失败。

```
 def calculateChecksum(self, command):
      sum = 0
      for b in range(len(command)):
        sum = sum + command[b-1]
      mod =  sum % 64
      checkbyte = mod & (0xFF)
      checksum = checkbyte | 0x80 
```

where command 是一个字节的 jarray.array （为什么我不使用内置的数组类型？我问你：这有关系吗？jarray.array 适用于其他一切，它在某些情况下显然有效，见下文）

```
>>> testarray
array([55, 57, 51], byte)
>>> len(testarray)
3
>>> stage.calculateChecksum(stage, testarray)
Traceback (innermost last):

  File "<console>", line 1, in ?

  File "....py", line 75, in calculateChecksum

AttributeError: __len__ 
```

所以我认为可以肯定地说这个数组实现了 len()，但我不知道为什么这似乎并不总是正确的。知道这里发生了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T01:40:12.750

像这样调用方法：

```
stage.calculateChecksum(testarray) 
```

请注意，您不必显式传递参数`stage`，`self`当您在对象上调用方法时会隐式传递（`stage`在本例中。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T02:41:27.217

您定义`def calculateChecksum(self, command):`到一个类中，当您调用一个类方法时，您不需要添加`self`变量。Python 为您添加了它。

# sql-server - 数据库约束冲突错误处理

> ID：14063520
> 
> 赞同：3
> 
> 时间：2012-12-28T01:37:43.120
> 
> 标签：sql-server, delphi, error-handling

我仍然对如何处理数据库违规错误感到困惑。这段代码是否提供了最好的错误处理？或者任何其他处理错误的方式，这也让用户清楚为什么会发生错误？

```
procedure TForm2.cxButton1Click(Sender: TObject);
var
  sp:TADOStoredProc;
  errorMsg : string;
begin
  //
  sp := TADOStoredProc.Create(nil);
  try
    sp.Connection := FOrm1.ADOConnection1;
    sp.ProcedureName := 'cfg.AddConfiguration';
    sp.Parameters.CreateParameter('@RETURN_VALUE', TFieldType.ftInteger, pdReturnValue, 0, 0);
    sp.Parameters.CreateParameter('@key', ftString, pdInput, 50, cxTextEdit1.Text);
    sp.Parameters.CreateParameter('@caption', ftString, pdInput, 50, cxTextEdit2.Text);
    sp.Parameters.CreateParameter('@datatype', ftString, pdInput, 50, cxComboBox1.Text);
    sp.Parameters.CreateParameter('@description', ftString, pdInput, 4000, cxMemo1.Text);
    try
      sp.ExecProc;
    except
      on e:EOleException do
      begin
        errorMsg := 'Failed to add new configuration.';
        if e.ErrorCode = 2601 then
        begin
          errorMsg := errorMsg + sLineBreak + 'Possible duplicate in key!';
        end;
        MessageDlg(errorMsg, mtError, [mbOK], 0);
      end;
    end;
  finally
    sp.Free;
  end;
end; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-28T01:44:40.657

您拥有的代码非常依赖于数据库。每个 RDBMS 都以不同的方式报告这些约束违规。如果您只使用特定数据库（根据 ADO 对象的使用情况判断），那么可以，可以检查 errorCode，但是我会将这些特定于 RDBMS 的 errorCode 检查封装在存储过程本身中，然后返回我的应用程序特定的错误原因代码ans 向用户显示了一条消息，从而完全保护了 Delphi 层免受丑陋的数据库异常的影响。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-28T08:15:30.227

我建议将过程调用和错误处理从用户界面（表单“Form2”）移到数据模块中的单独方法。我还将确保在此方法中不会显示任何消息框/对话框，以支持在服务器端（中间层、应用程序服务器等）或非 GUI 类型应用程序中的使用。

然后我会使用返回码或应用程序特定的异常来向调用 GUI 方法报告错误。

# android - 搜索数据时无法启动搜索活动android

> ID：14063522
> 
> 赞同：0
> 
> 时间：2012-12-28T01:38:05.197
> 
> 标签：android, search

所以我正在尝试对这个搜索活动进行编程，当我在模拟器中执行搜索时，我的日志猫中出现一个错误，提示该活动无法启动，我无法弄清楚是什么导致了该错误。

搜索活动代码：

```
package com.example.myfirstapp;

import android.os.Bundle;
import android.app.SearchManager;
import android.app.ListActivity;
import android.view.Menu;
import android.view.View;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemClickListener;
import android.widget.ArrayAdapter;
import android.widget.ListView;
import android.content.Intent;
import android.database.Cursor;
public class SearchResultsActivity extends ListActivity {

private ListView list;
DatabaseTable db = new DatabaseTable(this);
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(android.R.id.list);
    handleIntent(getIntent());
}

public void onNewIntent(Intent intent) {
    setIntent(intent);
    handleIntent(intent);
}

private void handleIntent(Intent intent) {
    if (Intent.ACTION_VIEW.equals(intent.getAction())) {
        Intent contactIntent = new Intent(this, ContactActivity.class);
        contactIntent.setData(intent.getData());
        startActivity(contactIntent);
        finish();
    } else if (Intent.ACTION_SEARCH.equals(intent.getAction())) {
        String query = intent.getStringExtra(SearchManager.QUERY);
        showResults(query);
    }

}

private void showResults(String query) {
    int name = 0;
    String c = "";
    Cursor cursor = db.getContactMatches(query, null);
    int cursor_length = db.cursorLength(cursor);
    String[] display = new String[cursor_length];
    list = (ListView)findViewById(android.R.id.list);
    int x = 0;

    //Loading data through Cursor into String array
    for (cursor.moveToFirst(); !cursor.isAfterLast(); cursor.moveToNext())
    {
        name = cursor.getColumnIndex(DatabaseTable.COL_NAME);
        c = (cursor.getString(name));
        display[x] = c;
        c = "";
        x = x + 1;
        name = 0;
    }

    ArrayAdapter<String> contactAdapter = new ArrayAdapter<String>(this,
              R.layout.activity_search_results, android.R.id.list, display);
    list.setAdapter(contactAdapter);
    list.setOnItemClickListener(new OnItemClickListener() {
        public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
            Intent contactIntent = new Intent(getApplicationContext(),ContactActivity.class);
            contactIntent.setData(getIntent().getData());
            startActivity(contactIntent);
        }
    });
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_search_results, menu);
    return true;
} 
```

}

安卓清单

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.example.myfirstapp"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="14"
    android:targetSdkVersion="15" />

<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name=".MainActivity"
        android:label="@string/title_activity_main" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>

        <meta-data
            android:name="android.app.default_searchable"
            android:value=".SearchResultsActivity" />
    </activity>
    <activity
        android:name=".SearchResultsActivity"
        android:label="@string/title_activity_search_results"
        android:launchMode="singleTop" >
        <intent-filter>
            <action android:name="android.intent.action.SEARCH" />
        </intent-filter>
        <intent-filter>
            <action android:name="android.intent.action.VIEW" />
        </intent-filter>

        <meta-data
            android:name="android.app.searchable"
            android:resource="@xml/searchable" />
    </activity>
    <activity
        android:name=".AddContacts"
        android:label="@string/title_activity_add_contacts" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity
        android:name=".ContactActivity"
        android:label="@string/title_activity_contact" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
</application> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T02:05:23.393

这里

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(android.R.id.list);  //<<<< 
```

您将 ListView id 添加为`ListActivity`. 只需`setContentView(android.R.id.list);` 从 ListActivity 的 onCreate 中删除并为 Activty 添加您自己的布局

并将 onCreate 方法中的数据库实例初始化为

```
 DatabaseTable db;
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
                 setContentView(R.layout.main); // <<< add activity layout here
        db = new DatabaseTable(this); 
```

请参阅本教程以使用 ListView 创建布局：

[http://www.java2s.com/Code/Android/UI/UsingImageViewwithinListActivity.htm](http://www.java2s.com/Code/Android/UI/UsingImageViewwithinListActivity.htm)

# php - 我应该在 PHP 中使用单独的变量来定义我的 SQL 语句句柄吗？

> ID：14063527
> 
> 赞同：1
> 
> 时间：2012-12-28T01:39:02.167
> 
> 标签：php, mysql, function, methods

## 所有 3 个选项都相同（Y/N）还是一个更好（A/B/C）？

**选项 A** - (1) 在变量中定义 SQL 字符串， (2) 使用变量上`$sql`的“方法”定义语句句柄以组合语句，以及 (3) 使用执行函数在步骤 2 中激活语句组合。`prepare``$sql`

```
 $sql = "SELECT * FROM table1";
    $sth = $dbh->prepare($sql);
    $sth->execute(); 
```

**选项 B** - 类似于选项 C，因为该`->query`方法直接在 db 对象上使用，并且类似于选项 A，因为 sql 语句是分开的。

```
 $sql = "SELECT * FROM table1";
    $sth = $dbh->query($sql); 
```

**选项 C** - 语句句柄是 sql 查询本身（不引用任何其他变量，只使用一种方法。

```
 $sth = $dbh->query("SELECT * FROM table1"); 
```

问题：

*   两种选择是否产生相同的结果？*   如果它们产生相同的结果，是否推荐一种方法（即最佳实践）？*   我的“变量”、“方法”和“函数”之类的词汇是否正确？*   尽管没有明确使用该`->query()`方法，选项 A 是否仍然查询数据库？*   将 sql stmnt 包含在单独的变量中与 PDO 语句中的优缺点是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T01:48:11.373

我想说这两种方法在使用字符串变量或直接文本字符串方面是相同的。

假设您使用 PDO，prepare 语句和调用查询语句之间存在差异。

在情况 A 中，prepare 语句将使数据库创建一个计划，以便可以重新执行该语句而无需重新解析查询字符串。

在情况 B 中，查询将立即执行。

在您给定的示例中，B 会运行得更快一些。但是，如果您的语句使用参数 case A 由于占位符已被驱动程序替换，您将获得额外的安全性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-28T01:55:47.320

> 两种选择是否产生相同的结果？

是的。

> 如果它们产生相同的结果，是否推荐一种方法（即最佳实践）？

两者都很好。在您的特定示例中，选项 B 用更少的代码完成了相同的工作。

但是，如果您需要在查询中使用参数和/或约束（例如 ...WHERE id = :id），您需要选择选项 A 以使用 $dbh->bindParam(':id', $ id, PDO::PARAM_INT) 方法在您准备好您的语句后，例如：

```
$dbh->prepare('UPDATE table SET column = :value WHERE id = :id');
$dbh->bindParam(':value', $someNewValue, PDO::PARAM_STR);
$dbh->bindParam(':id', $targetId, PDO::PARAM_INT);
$dbh->execute(); 
```

这样做还可以保护您免受 SQL 注入等令人讨厌的事情的影响。

仅当您计划稍后在代码中重用该查询时，才需要将查询存储在单独的变量中。否则，您不妨直接在您的准备/查询方法中输入它。

> 我的“变量”、“方法”和“函数”之类的词汇是否正确？

看起来差不多！除了：“执行功能”是一种方法。函数和方法基本上是相同的东西，除了它们属于一个对象时，它们被称为方法。在您的示例中，执行属于 $sth 对象，因此它被称为方法。

> 尽管没有明确使用 ->query() 方法，选项 A 是否仍然查询数据库？

是的。execute 方法执行在 $dbh->prepare(...) 中准备好的查询。如果你想使用参数，你可以在你的准备和执行方法之间调用 ->bindParam() 。如果不需要参数，直接调用 ->query() 确实是更方便的方法。

# colors - 计算 RGBA 以匹配 RGB 颜色

> ID：14063530
> 
> 赞同：6
> 
> 时间：2012-12-28T01:39:12.163
> 
> 标签：colors

如果我有 RGB 颜色，不透明度为 100%。

我想要具有透明 Alpha 通道的相同颜色（或接近它）。我将在白色背景上绘制透明颜色。

如何计算 RGBA 颜色？

我想我要问的是[这个问题的反面](https://stackoverflow.com/questions/2049230/convert-rgba-color-to-rgb)。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-28T03:10:44.917

你的意思是你想要具有最大透明度的 RGBA 颜色，当在白色背景上绘制时，它会给出原始的 RGB 颜色？

设*R* [0]、*G* [0]、*B* [0]为原色的分量，取值范围为0.0～1.0，设*R*、*G*、*B*、*A*为新RGBA颜色的分量（*A* =1表示100%不透明度）。我们知道颜色必须满足：

> *R* [0] = *A* · *R* + (1 - *A* )
> *G* [0] = *A* · *G* + (1 - *A* )
> *B* [0] = *A* · *B* + (1 - *A* )

如果我们知道*A*，我们可以很容易地求解*R*、*G*和*B*：

> *R* = ( *R* [0] - 1 + *A* ) / *A* = 1 - (1 - *R* [0] ) / *A*
> *G* = ( *G* [0] - 1 + *A* ) / *A* = 1 - (1 - *G* [0] ) / *A*
> *B* = ( *B* [0] - 1 + *A* ) / *A* = 1 - (1 - *B* [0] ) / *A*

由于我们要求*R* ≥ 0、*G* ≥ 0 和*B* ≥ 0，因此 1 - *R* [0] ≥ A、1 - *G* [0] ≥ A 和 1 - *B* [0] ≥ A，因此 A 的最小可能*值为*：

> *A* = 最大值（ 1 - *R* [0]， 1 - *G* [0]， 1 - *B* [0]） = 1 - 最小值（*R* [0]，*G* [0]，*B* [0]）

因此，我们想要的颜色是：

> *A* = 1 - min( *R* [0] , *G* [0] , *B* [0] )
> *R* = 1 - (1 - *R* [0] ) / *A*
> *G* = 1 - (1 - *G* [0] ) / *A*
> *B* = 1 - (1 - *B* [0] ) /*一个*

* * *

附言。对于*黑色*背景，相同的公式会更简单：

> *A* = 最大值（*R* [0]，*G* [0]，*B* [0]）
> *R* = *R* [0] / *A*
> *G* = *G* [0] / *A*
> *B* = *B* [0] / *A*

* * *

pps。澄清一下，以上所有公式都适用于*非*预乘 RGBA 颜色。对于预乘 alpha，只需将上面计算的*R*、*G*和*B乘以**A*，得到：

> *R* = *A* · ( 1 - (1 - *R* [0] ) / *A* ) = *R* [0] - (1 - *A* )
> *G* = *A* · ( 1 - (1 - *G* [0] ) / *A* ) = *G* [0] - (1 - *A* )
> *B* = *A* · ( 1 - (1 - *B* [0] ) / *A* ) = *B* [0] - (1 - *A* )

（或者，对于黑色背景，只需*R* = *R* [0]，*G* = *G* [0]和*B* = *B* [0]。）

# sql - 为用户友谊设计数据库

> ID：14063531
> 
> 赞同：4
> 
> 时间：2012-12-28T01:39:21.187
> 
> 标签：sql, database

我想将友谊存储在数据库中。我的想法是，当 user1 与 user2 成为朋友时，我会存储该友谊，以便在需要时可以获取任一用户的所有朋友。起初我以为我只需将他们的 id 存储在一个插入的表中，但后来我在查询数据库时想到了一些复杂性。

如果我有 2 个用户 ID 分别为 10 和 20 的用户，当他们成为朋友时，我是否应该在数据库中插入两次

```
ID USER1 USER2
1  10    20
2  20    10 
```

或者如果我只像这样插入一个，是否有办法查询数据库以仅获取特定用户的朋友

```
ID USER1 USER2
1  10    20 
```

我知道第一种方法肯定可以给我我正在寻找的东西，但我想知道这是否是好的做法，以及是否有更好的选择。如果可以查询第二种方式来获得我会像所有用户 10 的朋友一样寻找的结果。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-28T01:57:44.960

友谊是双向的纽带（出于所有意图和目的）。与另一个链接（例如单向消息）不同，友谊应该只有一个条目。但是，您所看到的是正确的；您需要查询这两个列来获取用户的朋友，但这很简单：

```
-- The uses of `1` below is where you'd insert the ID of
-- the person you're looking up friends on
SELECT      u.id, u.name
FROM        friendship f
  LEFT JOIN user u
  ON        (u.id = f.user1 OR u.id = f.user2)
    AND     u.id <> 1
WHERE       (f.user1 = 1 OR f.user2 = 1) 
```

[这里的例子](http://www.sqlfiddle.com/#!2/eee26/9/0)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-28T02:15:11.047

Brad Christie 关于双向查询表的建议很好。但是，鉴于 MySQL 不擅长优化`OR`查询，使用`UNION ALL`可能更有效：

```
( SELECT u.id, u.name
  FROM friendship f, user u
  WHERE f.user1 = 1 AND f.user2 = u.id )
UNION ALL
( SELECT u.id, u.name
  FROM friendship f, user u
  WHERE f.user2 = 1 AND f.user1 = u.id ) 
```

[这是它的 SQLFiddle](http://www.sqlfiddle.com/#!2/d02cd/1/0)，基于 Brad 的示例。我修改了`friendship`表格以添加双向索引以实现高效访问，并删除了[无意义的`id`列](https://stackoverflow.com/questions/1843222/do-link-tables-need-a-meaningless-primary-key-field)。当然，用这么小的例子你不能真正测试真实世界的性能，但是比较两个版本之间的执行计划可能是有启发性的。

# java - 使用 JSON 和 Jackson 库将 JSON 映射回 POJO

> ID：14063535
> 
> 赞同：2
> 
> 时间：2012-12-28T01:39:47.960
> 
> 标签：java, json, jackson

我有一个 JSON 字符串：

```
{
    "fruit": {
        "weight":"29.01",
        "texture":null
    },
    "status":"ok"
} 
```

...我正在尝试映射回 POJO：

```
public class Widget {
    private double weight; // same as the weight item above
    private String texture; // same as the texture item above

    // Getters and setters for both properties
} 
```

上面的字符串（我正在尝试映射）实际上包含在[org.json.JSONObject](http://www.json.org/java/)中，可以通过调用该对象的`toString()`方法来获得。

我想使用[Jackson JSON](http://jackson.codehaus.org/) object/JSON mapping framework 来做这个映射，到目前为止这是我最好的尝试：

```
try {
    // Contains the above string
    JSONObject jsonObj = getJSONObject();

    ObjectMapper mapper = new ObjectMapper();
    Widget w = mapper.readValue(jsonObj.toString(), Widget.class);

    System.out.println("w.weight = " + w.getWeight());
} catch(Throwable throwable) {
    System.out.println(throwable.getMessage());
} 
```

`readValue(...)`不幸的是，当执行 Jackson 方法时，这段代码会引发异常：

```
Unrecognized field "fruit" (class org.me.myapp.Widget), not marked as ignorable (2 known properties: , "weight", "texture"])
    at [Source: java.io.StringReader@26c623af; line: 1, column: 14] (through reference chain: org.me.myapp.Widget["fruit"]) 
```

我需要映射器：

1.  完全忽略外部大括号（“ `{`”和“ `}`”）
2.  将 更改`fruit`为`Widget`
3.  `status`完全忽略

如果这样做的唯一方法是调用`JSONObject`'`toString()`方法，那就这样吧。但是我想知道 Jackson 是否带有任何已经与 Java JSON 库一起使用的“开箱即用”的东西？

无论哪种方式，编写杰克逊映射器是我的主要问题。谁能发现我哪里出错了？提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-28T05:22:22.513

您需要有一个`PojoClass`包含（具有）`Widget`实例的类，称为`fruit`.

在你的映射器中试试这个：

```
 String str = "{\"fruit\": {\"weight\":\"29.01\", \"texture\":null}, \"status\":\"ok\"}";
    JSONObject jsonObj = JSONObject.fromObject(str);
    try
    {
        // Contains the above string

        ObjectMapper mapper = new ObjectMapper();
        PojoClass p = mapper.readValue(jsonObj.toString(), new TypeReference<PojoClass>()
        {
        });

        System.out.println("w.weight = " + p.getFruit().getWeight());
    }
    catch (Throwable throwable)
    {
        System.out.println(throwable.getMessage());
    } 
```

这是你的`Widget`班级。

```
public class Widget
{    private double weight;
     private String texture;
    //getter and setters.
} 
```

这是你的`PojoClass`

```
public class PojoClass
{
    private Widget fruit;
    private String status;
    //getter and setters.
} 
```

# jquery - 引导程序无法在自定义按钮渐变中编程

> ID：14063538
> 
> 赞同：0
> 
> 时间：2012-12-28T01:40:22.950
> 
> 标签：jquery, css, jquery-mobile, twitter-bootstrap

**请注意我正在使用这个“ [http://andymatthews.net/read/2012/02/13/New-jQuery-Mobile-theme:-Twitter-Bootstrap”**](http://andymatthews.net/read/2012/02/13/New-jQuery-Mobile-theme:-Twitter-Bootstrap)

所以这就是标准按钮“嵌入”的样子，只是一个简单的元素。

```
<a href="/mobile/daily.cfm" data-rel="dialog" data-role="button" data-transition="pop" data-ajax="false" data-theme="b" class="">Daily Progress</a> 
```

现在我不确定你们中是否有人熟悉 Bootstrapper，但它带有一些预定义的按钮样式。虽然我不知道如何添加自定义的。我原以为这会是在公园里散步，但事实证明并非如此……或者至少我犯了一个愚蠢的错误或忘记了什么。

我要使用的渐变是这个

```
background: #fa5976; /* Old browsers */
background: -moz-linear-gradient(top,  #fa5976 0%, #fa5573 13%, #fa4c6b 30%, #f6374e 100%); /* FF3.6+ */
background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#fa5976), color-stop(13%,#fa5573), color-stop(30%,#fa4c6b), color-stop(100%,#f6374e)); /* Chrome,Safari4+ */
background: -webkit-linear-gradient(top,  #fa5976 0%,#fa5573 13%,#fa4c6b 30%,#f6374e 100%); /* Chrome10+,Safari5.1+ */
background: -o-linear-gradient(top,  #fa5976 0%,#fa5573 13%,#fa4c6b 30%,#f6374e 100%); /* Opera 11.10+ */
background: -ms-linear-gradient(top,  #fa5976 0%,#fa5573 13%,#fa4c6b 30%,#f6374e 100%); /* IE10+ */
background: linear-gradient(to bottom,  #fa5976 0%,#fa5573 13%,#fa4c6b 30%,#f6374e 100%); /* W3C */
filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#fa5976', endColorstr='#f6374e',GradientType=0 ); /* IE6-9 */ 
```

该梯度是使用梯度生成器生成的。渐变只是一种中等的粉红色风格。

现在我认为这就像复制“b”样式并制作新的“x”、“z”、“p”等样式一样简单，但显然这不起作用。

这是“b”样式看起来很长的样子，所以我将发布一个指向 pastebin 的链接。( [http://pastebin.com/Jz0JhsPq](http://pastebin.com/Jz0JhsPq) )。

现在我想我可以做这样的事情（[http://pastebin.com/4h4rhscH](http://pastebin.com/4h4rhscH)），然后将菜单项更改为这样的

```
<a href="/mobile/daily.cfm" data-rel="dialog" data-role="button" data-transition="pop" data-ajax="false" data-theme="p" class="">Daily Progress</a> 
```

但这并没有奏效，只是让它们变成了灰白色。我真的可以在这里使用一些帮助，任何支持都将不胜感激。

非常感谢提前！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T09:29:59.583

这可以相对容易地完成。

*   下载[http://andymatthews.net/read/2012/02/13/New-jQuery-Mobile-theme:-Twitter-Bootstrap](http://andymatthews.net/read/2012/02/13/New-jQuery-Mobile-theme%3a-Twitter-Bootstrap)。您可能没有删除它，只是为了安全起见。

*   转到此链接[http://jquerymobile.com/themeroller/](http://jquerymobile.com/themeroller/)。当它加载时，请查看顶部并单击“导入或升级”按钮。这将打开一个文本区域，您必须在其中粘贴您的 CSS。

*   打开 /Bootstrap.css 并复制其内容。将其粘贴到 textarea 字段中。

*   现在单击添加色板并创建您自己的主题。您可以复制现有的一个或从头开始创建一个全新的。

*   完成工作后，单击屏幕顶部的下载按钮。

就是这样。

# java - 将 .toBinaryString 转换为其补码

> ID：14063541
> 
> 赞同：1
> 
> 时间：2012-12-28T01:41:36.260
> 
> 标签：java

我不知道为什么在 yy.charAt(i) 作业中出现错误。它说...变量预期...不是价值。

```
static int subtract(int x,int y)
{
    String yy=Integer.toBinaryString(y);
    System.out.println(yy);
    for(int i=0;i<yy.length();i++)
    {
        if(yy.charAt(i)==1)
        {
            yy.charAt(i)=0;
        }
        else
        {
            yy.charAt(i)
        }
    }
    int t=Integer.parseInt(yy);
    return(t);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T01:53:00.157

您不能将值分配给字符串的索引位置，字符串在 Java 中是不可变的。这永远不会奏效：

```
yy.charAt(i)=0; 
```

如果您需要修改字符串，请将其转换为`char[]`（使用`toCharArray()`方法），修改数组，然后使用`String(char[])`构造函数从该数组构建一个新字符串。

或者，您可以使用 a`StringBuilder`在返回新字符串之前修改字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T02:03:42.823

请改用 StringBuilder。

除了以下更改外，代码几乎与您现在拥有的相同：

```
StringBuilder yy = new StringBuilder(Integer.toBinaryString(y));
...
yy.setChatAt(i, '0'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T02:04:30.130

我认为您有一些不清楚的地方。

*   我认为您的意思是字符'0'而不是值0。
*   线条`else { yy.charAt(i); }`完全没有效果。你可以简单地省略它们。
*   字符串在 Java 中是不可变的（即它们不能就地修改）。
*   即使他们是，你的语法是错误的。class_name.method_name() 形式的东西是对类方法的调用。它返回一个您可以存储的值，它与变量不同，尝试分配给方法调用根本没有意义。

要在 Java 中修改字符串，最好的方法可能是使用 StringBuilder。您使用您的字符串创建一个新的 StringBuilder，对其进行必要的更改，然后将其转换回字符串。

所以这看起来像这样：

```
StringBuilder builder = new StringBuilder(yy); // StringBuilder from yy.

// rest of your code here

builder.setCharAt(i, '0');

// more code

yy = StringBuilder.toString(); // convert it back to a String. 
```

请注意，即使在 StringBuilder 中，您也必须调用适当的方法并传入要分配给它的值。

# c# - 设置鼠标位置不起作用c#

> ID：14063542
> 
> 赞同：5
> 
> 时间：2012-12-28T01:41:48.470
> 
> 标签：c#, mouseevent, mouse-hook

我一直在尝试编写一个小实用程序来修改鼠标在整个屏幕上的移动范围。我使用了在[这里](http://www.codeproject.com/Articles/7294/Processing-Global-Mouse-and-Keyboard-Hooks-in-C)找到的全局鼠标钩子库（我使用的是版本 1），然后将鼠标位置信息从它生成的事件传递给我自己的函数（只是一个测试，看看它现在是否工作） .

```
internal void ProcessMouseEvent(System.Drawing.Point point)
{
    Cursor.Position = new Point(50,50);
} 
```

运行它时，鼠标确实会闪烁到指定点，但如果它是一个移动事件，它会立即恢复到更改之前的位置。只有当它通过点击事件完成时，它才会真正保持在新位置。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T01:48:52.670

要限制鼠标有效移动的位置，您需要使用 cursor.clip。[你可以在这里](http://msdn.microsoft.com/en-us/library/system.windows.forms.cursor.clip.aspx)找到它的文档。它会更轻松地完成您想要的操作，并且是推荐的方式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-10-15T00:38:40.477

这里的问题是钩子给你一个鼠标消息的*通知*。但不会阻止它被实际处理通知的应用程序处理。所以它被正常处理，鼠标移动到它想去的地方。你需要做的实际上是阻止消息被传递，这需要从钩子回调中返回一个非零值。

该库不允许您修改挂钩回调返回值，这将需要手术。当心它是越野车。我将改为使用[此示例代码](https://stackoverflow.com/questions/11607133/global-mouse-event-handler)。使用此示例回调方法：

```
private static IntPtr HookCallback(int nCode, IntPtr wParam, IntPtr lParam) {
    if (nCode >= 0 && MouseMessages.WM_MOUSEMOVE == (MouseMessages)wParam) {
        System.Windows.Forms.Cursor.Position = new Point(50, 50);
        return (IntPtr)1;   // Stop further processing!
    }
    return CallNextHookEx(_hookID, nCode, wParam, lParam);
} 
```

你会看到它现在被牢牢地卡住了。使用 Alt+Tab、Alt+D、E 重新获得控制权。

# java - 扩展类简介

> ID：14063544
> 
> 赞同：0
> 
> 时间：2012-12-28T01:41:51.567
> 
> 标签：java, class

我有一个类*Triangle*和一个扩展*Triangle*的类，称为*IsoscelesRight*。我从老师那里得到了这个指令和提示来写*IsoscelesRight*，但我仍然不确定如何去做。

IsoscelesRight 只取一个 double 值，但设置边以形成等腰直角三角形。提示：通过将边 a 和 b 设置为相同的值来做到这一点，边 c 将等于边 a 乘以二的平方根。确保构造函数适当地调用 super()。

```
public class Triangle
{
    private double sideA;
    private double sideB;
    private double sideC;

public Triangle(double a, double b, double c)
{
    sideA = a;
    sideB = b;
    sideC = c;
}

public double getSideA()
{
    return sideA;
}

public double getSideB()
{
    return sideB;
}

public double getSideC()
{
    return sideC;
}
} 
```

这就是我需要更改的*IsoscelesRight的所有内容。*

```
public class IsoscelesRight extends Triangle
{
    public IsoscelesRight(double side)
    {
        super(side, side, side);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T01:49:43.060

您一定在寻找：

```
public class IsoscelesRight extends Triangle {
  public IsoscelesRight(double side) {
    super(side, side, Math.sqrt(2) * side);
  }
} 
```

**我会把关于为什么**的研究留给你，因为这显然是家庭作业。

请注意，如果您只是将此代码提交给您的教授，您几乎肯定会得到`f`努力。

一个稍微好一点（当然也更有启发性）的解决方案是：

```
public class Isosceles extends Triangle {
  public Isosceles(double side, double hypotenuse) {
    super(side, side, hypotenuse);
  }
}

public class Right extends Isosceles {
  public Right(double side) {
    super(side, Math.sqrt(2) * side);
  }
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-28T02:03:52.260

在任何三角形中，边都受到勾股定理的约束，所以如果你打算存储边长，你只需要存储 2，并且总是计算第三个（即斜边）。这将占用更少的空间，但需要更多的时间来检索斜边，因为 SQRT 需要时间来计算。所以修改你的模型，因为它不能只存储逻辑有效三角形的 3 个长度（不需要为 3 个值占用内存）而无需在 .ctor 中进行任何检查。

只存储A边和B边，斜边按公式计算：A^2 + B^2 = C^2。如果您存储所有 3 个边然后检查值是否根据公式相加，否则您的三角形将存储逻辑损坏的数据。

如果我是你的老师，我至少会想听到这些担忧的声音。实际的类设计可能是应用程序所需的任何东西 - 无论是速度、性能、数据的逻辑一致性以及上述所有组合。

# javascript - 谷歌地图圈子不是圆的

> ID：14063545
> 
> 赞同：10
> 
> 时间：2012-12-28T01:41:53.953
> 
> 标签：javascript, html, google-maps, google-maps-api-3

我试图在谷歌地图上画很多圈（每个屋顶很多圈）。

我尝试了 Circle 类，似乎对大圆圈没问题，但在画小圆圈时，它们根本不是圆的。

我使用的代码是这样的：

```
for(var i = 0; i < latitudes.length; i++)
    var newCircle = new google.maps.Circle({
        strokeColor: "#FFFFFF",
        strokeOpacity: 0,
        strokeWeight: 1,
        fillColor: "#FFFFFF",
        fillOpacity: 1,
        map: map,
        center: new google.maps.LatLng(latitudes[i], longitudes[i]),
        radius: 0.5
    });
    newCircle.setMap(map); 
```

结果是：![带有白色圆圈的谷歌地图](../Images/23f4a94b3f7673e2f141f71516a726ed.png)

我知道还有其他方法可以在谷歌地图上绘制点，但如果有办法让它们看起来像应该的那样，我真的很想使用谷歌解决方案。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-29T00:20:59.293

你可以使用符号，它们应该是完美的圆圈。尝试这个：

```
var whiteCircle = {
    path: google.maps.SymbolPath.CIRCLE,
    fillOpacity: 1.0,
    fillColor: "white",
    strokeOpacity: 1.0,
    strokeColor: "white",
    strokeWeight: 1.0,
    scale: 1.0
}; 
```

然后

```
for(var i = 0; i < latitudes.length; i++) {
    var latLng = new google.maps.LatLng(latitudes[i], longitudes[i])
    var newCircle = new google.maps.Marker({
        icon: whiteCircle,
        position: latLng
    });
    newCircle.setMap(map);
} 
```

圆圈可能很大，因此请调整比例以使其正确。

我从未使用过 Circle 类。符号是在今年的 Google I/O 中引入的。它们是向量，这意味着您几乎可以定义自己的形状。以下是更多信息的链接： [**googlegeodevelopers.blogspot.com/2012/06/powerful-data-visualization-with.html**](http://googlegeodevelopers.blogspot.com/2012/06/powerful-data-visualization-with.html)

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-12-28T01:59:34.210

抗锯齿至关重要。

`g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON)`

Google 解决方案不适用于较小的圈子。

# wpf - 在 ScrollViewer 中自动调整 ListBox 的大小

> ID：14063551
> 
> 赞同：0
> 
> 时间：2012-12-28T01:42:59.890
> 
> 标签：wpf, xaml, listview, user-controls, scrollviewer

在我的应用程序中，我有一个`Window`. 它包含左侧菜单、标题和内容位置。

这个内容是动态加载的——a`UserControl`被放在那里。这些`UserControls`是多种多样的。从只是一个`TextBlock`非常复杂的页面。为了确保所有内容都可见，我必须用一个`ScrollViewer`（我的意思是在 MyWindow.xaml 中）包装它。在我需要`ListView`在内容中添加 a 之前，一切正常。

或多或少的代码看起来像这样：

```
<ScrollViewer> // this is the wrapping viewer actually it's in a different file
    <UserControl>
        ......
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="10*"/>
                <ColumnDefinition Width="20*"/>
            </Grid.ColumnDefinitions>
            <ListView  ItemsSource="{Binding Entities}">
                <ListView.ItemTemplate>
                    <DataTemplate>
                        <StackPanel>
                            <TextBlock Style="{StaticResource Value}" Text="{Binding WorkOrderNumber}"/>
                            <TextBlock Style="{StaticResource Value}" Text="{Binding ActionType}"/>
                            <TextBlock Style="{StaticResource Value}" Text="{Binding StartDate}"/>
                            <TextBlock Style="{StaticResource Value}" Text="{Binding StopDate}"/>
                            <Separator/>
                        </StackPanel>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>
            <Whatever.. Grid.Row="0" Grid.Column="1"/>
            <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Right">
                <Button Style="{StaticResource CustomButton}" Content="Previous" />
                <Button Style="{StaticResource CustomButton}" Content="Current" />
                <Button Style="{StaticResource CustomButton}" Content="Next" />
            </StackPanel>
        </Grid>
    </UserControl>
</ScrollViewer> 
```

结果是列表框没有滚动条并且变高。滚动条仅在窗口的滚动查看器中。

所以在我的 UserControl 我想要：

*   按钮始终位于最底部
*   填充整个剩余空间的列表框（也与窗口一起调整大小）
*   避免硬编码列表框的高度

那可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T05:08:43.480

使用 DockPanel 而不是 Grid。DockPanel 有一个名为 LastChhildFill 的属性。默认情况下为真。如果您将 ListBox 设置为最后一个 Child，它将填满所有空间：

```
<ScrollViewer>
    <DockPanel>
        <StackPanel DockPanel.Dock="Bottom"
                    Orientation="Horizontal"
                    HorizontalAlignment="Center">
            <Button Style="{StaticResource CustomButton}"
                    Content="Previous" />
            <Button Style="{StaticResource CustomButton}"
                    Content="Current" />
            <Button Style="{StaticResource CustomButton}"
                    Content="Next" />
        </StackPanel>
        <ListView >
        </ListView>
    </DockPanel>
</ScrollViewer> 
```

但是这个设置会使按钮消失。我的意思是它们总是在列表框的底部。所以也许你需要**删除 ScrollViewer**。

# javascript - 如何从阻止滚动的元素中消除抖动

> ID：14063552
> 
> 赞同：-1
> 
> 时间：2012-12-28T01:43:01.740
> 
> 标签：javascript, jquery, mouseevent, mousewheel

请先看另一个问题：[鼠标滚轮滚动事件](https://stackoverflow.com/questions/14051908/mouse-wheel-scroll-event)和[接受答案中的演示](http://pastehtml.com/view/cn1zjbcgm.html)。

取消滚动事件时如何减少抖动？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T02:01:46.437

演示：http: [//jsfiddle.net/HUGTL/](http://jsfiddle.net/HUGTL/)

基于对[原始问题的回答](https://stackoverflow.com/a/14052284/453277)，您可以执行以下操作：

```
var noscroll = document.getElementById('noscroll');

var locked, lockedX, lockedY;
noscroll.addEventListener('mouseover', function (){
    locked = true;
    lockedX = window.scrollX;
    lockedY = window.scrollY;
}, false);
noscroll.addEventListener('mouseout', function (){
    locked = false;
}, false);

// changes

$(window).on("mousewheel keydown", function(e){
    if(locked === true){
        return false;
    }
});

$(window).on("scroll", function(e){
    if(locked === true){
        // add fallback here for other scenarios
    }
}); 
```

我正在使用 jQuery 来简化/标准化事件处理。

请注意，防止关键事件可能是不可取的；我把它包括在内是为了展示如何防止箭头键（你也可以检查特定的键码）。

我还为不由`mousewheel/keydown`.

这对于触摸事件可能不起作用（或根本不起作用）。最重要的是，确保它不会让您的用户感到困惑或删除预期的功能。

如果您只想处理鼠标滚轮，它可能会简单得多：

```
$("#noscroll").on("mousewheel", function(e){
    return false;
}); 
```

演示：http: [//jsfiddle.net/HUGTL/3/](http://jsfiddle.net/HUGTL/3/)。但是，这不适用于关键事件。

# javascript - 9gag解析json

> ID：14063553
> 
> 赞同：1
> 
> 时间：2012-12-28T01:43:06.543
> 
> 标签：javascript, json, parsing

我想从中挑选一张随机图片：

> [http://9gag.com/top/all/index/page/1?view=json](http://9gag.com/top/all/index/page/1?view=json)

为了正确显示它，我需要知道这个图像的大小。

我使用 YQL 将此 json 的结果放入一个变量（称为**source**）中。

我用 http 替换 https 并删除每个反斜杠。

```
var it = $.parseJSON(source);
var total = it.count-1;
var random = Math.floor((Math.random()*total)+0);     
var gagurl = it.items[random];
var gagurldecode = gagurl.replace('\\','');
gagurldecode = gagurldecode.replace('https','http'); //here is the url of the image 
```

但我无法检索此图像的大小。

```
 var img = new Image();
   img.src = gagurldecode; 
```

警报（img.height）；什么都不返回。

如果我更换

```
img.src = gagurldecode; 
```

和

```
img.src = 'http://d24w6bsrhbeh9d.cloudfront.net/photo/1777377_460s.jpg'; 
```

有用。

**我做错了什么？** PS：对不起我的英语！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T01:55:08.487

此行是不必要的，因为在解析 JSON 时会转义斜杠：

```
var gagurldecode = gagurl.replace('\\',''); 
```

对于您的实际问题，直到下载`height`并`width`检查图像后才会填充 和 。如果浏览器没有看到图像（在事件处理程序中），则这是异步完成的，`onload`但如果像硬编码示例中那样从缓存中检索，则可以同步完成：

```
img.onload = function() {
    alert(img.height);
} 
```

这将每次都有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T01:48:14.897

你为什么要做替换电话？这不是必需的，因为在将字符串解析为 json 后，斜杠将不会为您转义。（此外，您的替换调用不是replaceAll）

尝试这个：

```
//str is going to be the json you get from that url
var str = '{"items":["http:\/\/d24w6bsrhbeh9d.cloudfront.net\/photo\/5373376_460s.jpg","http:\/\/d24w6bsrhbeh9d.cloudfront.net\/photo\/2899638_460s_v1.jpg","http:\/\/d24w6bsrhbeh9d.cloudfront.net\/photo\/3196367_460s.jpg","http:\/\/d24w6bsrhbeh9d.cloudfront.net\/photo\/1777377_460s.jpg","http:\/\/d24w6bsrhbeh9d.cloudfront.net\/photo\/3233576_460s.jpg","http:\/\/d24w6bsrhbeh9d.cloudfront.net\/photo\/3101249_460s.jpg","http:\/\/d24w6bsrhbeh9d.cloudfront.net\/photo\/3279498_460s.jpg","http:\/\/d24w6bsrhbeh9d.cloudfront.net\/photo\/2487961_460s.jpg","http:\/\/d24w6bsrhbeh9d.cloudfront.net\/photo\/2693569_460s.jpg"],"layout":"list","count":9}'
var obj = JSON.parse(str);
var src = obj.items[~~(Math.random() * (obj.items.length - 1))];
img.src = src; 
```

# c# - 以真实大小导出 PowerPoint 形状

> ID：14063556
> 
> 赞同：2
> 
> 时间：2012-12-28T01:43:39.107
> 
> 标签：c#, vsto, powerpoint

我需要将 PowerPoint 中选择的形状导出为具有真实形状大小的 png 图像。我使用此代码进行导出：

```
var args = new object[] { filePath, Microsoft.Office.Interop.PowerPoint.PpShapeFormat.ppShapeFormatPNG, 0, 0, Microsoft.Office.Interop.PowerPoint.PpExportMode.ppRelativeToSlide };
objectShape.GetType().InvokeMember("Export", System.Reflection.BindingFlags.InvokeMethod, null, objectShape, args); // Export to file on disk 
```

在磁盘上，我的图像比例和高度/宽度不正确。我尝试了 PpExportMode 枚举参数的不同值，以防万一我将 PP 中的缩放更改为 100%。但我没有正确的结果。对于基于矩形的形状，它可以正常工作。但例如对于星形或标注形状，实际尺寸不等于形状的高度/宽度属性。这是因为形状底部的舌头很小。

![在此处输入图像描述](../Images/d0e8c4036ea5528815dbe10cbe238f0e.png)

有人知道如何正确导出这些形状吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T05:16:55.067

检查形状的 .Adjustments.Count 属性。

```
If Adjustments.Count > 0 Then
For x = 1 to Adjustments.Count
  '  Store the value of Adjustments(x) somewhere
  '  so you can reset it later
  .Adjustments(x) = 0
Next 
```

现在导出形状，然后将其调整重置为以前的值。

或者只是复制形状，将其调整设置为 0，将其导出，然后将其删除。

# wordpress - Wp 函数在列表中显示页面模板

> ID：14063557
> 
> 赞同：-1
> 
> 时间：2012-12-28T01:43:38.150
> 
> 标签：wordpress, function

我需要帮助为 wp 编写一个函数，以便我可以在每个 li 中显示一个页面模板。例如，我有一个模板 home-page.php Id 像这样显示在中央列表中。和page-1.php & page-2.php在首页的左右。

```
<div class="slidewrap2">
    <ul class="slider" id="sliderName">
        <li class="slide" style="background-color:salmon">
            <?php echo get_my_page(4); ?>
        </li>
        <li class="slide" style="background-color:grey">
            <?php echo get_my_page(58); ?>  
        </li>
        <li class="slide" style="background-color:black">
            <?php echo get_my_page(24); ?>  
        </li>

    </ul>   
</div> 
```

功能：

```
function get_my_page($id){
$post = get_post($id);
$content = $post->post_content; 
$content = apply_filters('the_content', $content);
$content = str_replace(']]>', ']]>', $content);
return $content;
} 
```

但是，这会返回服务器错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T04:25:49.607

查看[获取邮政法典](http://codex.wordpress.org/Function_Reference/get_post)

> $post_id (integer) (required) 您要获取的帖子的 ID。**您必须传递一个包含整数的变量**（例如$id）。文字整数（例如 get_post(7)）将导致致命错误（只能传递变量以供引用或不能通过引用传递参数 1）。

我知道，这似乎是一个愚蠢的解决方案，但是 C'est la vie：

```
function get_my_page($id){
    $pid = $id; //derp
    $post = get_post($pid);
    $content = $post->post_content; 
    $content = apply_filters('the_content', $content);
    $content = str_replace(']]>', ']]>', $content);
    return $content;
} 
```

让我知道它是如何工作的。

# php - Mysql，选择按不同列分组的ID（为每个唯一域选择所有ID）

> ID：14063558
> 
> 赞同：1
> 
> 时间：2012-12-28T01:43:49.963
> 
> 标签：php, mysql, select

所以我有一个 MySQL 表：

```
Table Data:

id | domain     | title                | Full Url to Page | ... etc ...
1  | place.com  | Place Something      | http://place.com/1...
2  | place.com  | Place Something Else | http://place.com/2...
3  | place.com  | Some Other Place     | http://place.com/3...
4  | pets.com   | Cats Dogs Oh My      | http://pets.com/2....
5  | pets.com   | Bird Edition         | http://pets.com/3.... 
```

我需要（在 PHP / JQuery 中）是为每个唯一域获取一个 id 数组。所以我想要上表的最终输出是：

```
$finalArray = array('place.com' => array(1, 2, 3), 'pets.com' => array(4, 5)); 
```

我目前的解决方案是获取按域排序的所有行，这是 MySQL 语句：

```
SELECT `id`, `domain` FROM `gsort_linkdata` ORDER BY `domain` 
```

返回：

```
1  | place.com
2  | place.com
3  | place.com
4  | pets.com
5  | pets.com 
```

然后我循环遍历 PHP 中的行并将它们分解为数组。我宁愿从数据库中提取已经分解的数据。那可能吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T01:47:48.017

你可以使用`GROUP_CONCAT`：

```
SELECT GROUP_CONCAT(`id`), `domain` FROM `gsort_linkdata` GROUP BY `domain` 
```

（注意[group_concat_max_len](http://dev.mysql.com/doc/refman/5.5/en/server-system-variables.html#sysvar_group_concat_max_len)。）

但是因为没有办法将数组从 MySQL 传递给 PHP，你需要在 PHP 或 JS 中拆分生成的字符串，所以我认为你当前的方法是更好的方法。您的方法是安全的，并且实际上只是 PHP 中的一种，其他任何东西（包括 GROUP_CONCAT）都更复杂。

# ruby - 为什么我必须 .read() 一个我写的文件才能将内容实际输出到终端？

> ID：14063559
> 
> 赞同：3
> 
> 时间：2012-12-28T01:44:00.820
> 
> 标签：ruby

我正在学习 Ruby，现在正在搞乱读/写文件。当我创建文件“文件名”时，我可以使用 .write() 方法对其进行写入。但是，在运行 .read() 之后，如果不重新打开它，我就无法将内容输出到终端（参见第 8 行：）`puts write_txt.read()`。我曾多次尝试运行第 8 行，但所做的只是输出更多的空白行。没有第 8 行，`puts txt.read()`只输出一个空行。以下代码也可以`puts`在没有第 8 行的情况下工作（简单`write_txt.read()`）

```
# Unpacks first argument to 'filename'
filename = ARGV.first

# Lets write try writing to a file
write_txt = File.new(filename, 'w+')
write_txt.write("OMG I wrote this file!\nHow cool is that?")
# This outputs a blank line THIS IS THE LINE IN QUESTION
puts write_txt.read()

txt = File.open(filename)
# This actually outputs the text that I wrote
puts txt.read() 
```

为什么这是必要的？为什么已经明确写入的文件被读取为空白，直到它被读取为空白至少一次后重新打开？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-28T02:03:41.787

当您读取或写入文件时，有一个称为“光标”的内部指针可以跟踪您当前在文件中的位置。当您写入文件时，光标会设置在您写入的最后一个字节之后的位置，因此如果您执行其他写入，它们会发生在您之前的写入之后（而不是在它之上）。当您执行读取时，您正在从当前位置读取到文件末尾，其中包含...什么都没有！

您可以打开一个文件（光标位置 0），然后写入字符串“Hello”（光标位置 6），尝试从光标读取将导致 Ruby 说“哦，嘿，这个文件中没有更多内容超过光标位置6"，并且只会返回一个空白字符串。

您可以倒回文件光标 以`IO#rewind`将光标重置到文件的开头。然后您可以正常读取文件（将从光标读取到文件末尾）。

请注意，如果您在倒带后执行任何写入，您将覆盖之前写入的内容。

```
# Unpacks first argument to 'filename'
filename = ARGV.first

# Lets write try writing to a file
write_txt = File.new(filename, 'w+')
write_txt.write("OMG I wrote this file!\nHow cool is that?")

write_txt.rewind
puts write_txt.read() 
```

但是请注意，通常认为同时读取和写入同一文件句柄是不好的做法。您通常会打开一个文件句柄用于读取和一个用于写入，因为将两者混合可能会产生令人讨厌的后果（例如通过倒回光标进行读取意外覆盖现有内容，然后执行写入！）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T01:57:23.837

输出不一定立即写入文件。此外，指针位于文件末尾，如果您想在读写模式下读取，则必须重置它。`close`如果您想重新打开它以供阅读，您可以简单地。尝试：

```
write_txt.write("OMG I wrote this file!\nHow cool is that?")
# This outputs a blank line THIS IS THE LINE IN QUESTION
write_txt.close
txt = File.open(filename)
puts txt.read() 
```

# javascript - 如何覆盖以前设置的 jquery 事件处理程序？

> ID：14063564
> 
> 赞同：7
> 
> 时间：2012-12-28T01:44:28.120
> 
> 标签：javascript, jquery, event-handling

在我的代码中，设置了一个元素的事件处理程序，该处理程序将该元素的 css 高度更改为 100px。在其他地方，如果满足某些条件，我希望运行不同的事件处理程序，它应该覆盖以前的事件处理程序并将其高度更改为 200px。

有没有办法做到这一点，或者清除所有先前为元素设置的事件处理程序？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-12-28T01:46:08.173

是的，只需使用[`.off()`](http://api.jquery.com/off/)，比如

```
$('selector').off('eventname') 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-28T01:58:02.860

这有点像黑客，但听起来你正试图破解别人的代码，而无法直接更改它，所以这可能是你不得不求助的。

如果您只需要在它们之后调用某些东西`document.ready()`并且您不控制`document.ready()`语句的顺序，那么您可以在 document.ready 处理程序中像这样将一些代码放入一个短暂的超时中：

```
$(document).ready(function() {
    setTimeout(function() {
        $('selector').off('eventname').on(your event handler here);
    }, 1);
}); 
```

将`setTimeout()`在所有 document.ready() 处理程序运行后运行。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-07-06T21:26:08.017

另一种方式：

```
$(window).on('load', function() {
   $('selector').off('eventname').on(your event handler here);
}); 
```

文件准备好后执行加载

# iphone - 每天更新一次申请徽章

> ID：14063565
> 
> 赞同：1
> 
> 时间：2012-12-28T01:44:34.080
> 
> 标签：iphone, objective-c, ios, nsdate

这是我拥有的代码，我将日期放在应用程序徽章中。我想知道如何每天重新加载这个号码而不进入应用程序重新加载它。提前致谢！

```
NSDate *today = [NSDate date];
NSCalendar *cal = [NSCalendar currentCalendar];
NSDateComponents *comp = [cal components:NSDayCalendarUnit fromDate:today];
NSInteger day = [comp day];
[UIApplication sharedApplication].applicationIconBadgeNumber = day; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T02:53:11.317

一种相对简单的方法是将设置徽章的代码放在后台。您可以`[UIApplication beginBackgroundTaskWithExpirationHandler]`为此目的使用或相关的调用。唯一的问题是这种执行有 10 分钟的限制。话虽如此，有一些技巧可以用来规避这个限制。这是一个讨论此主题的出色线程：[在后台运行应用程序超过 10 分钟](https://stackoverflow.com/questions/9738488/run-app-for-more-than-10-minutes-in-background)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T04:27:12.527

我有以下代码：

```
NSDate *fireTime = [[NSDate date] addTimeInterval:3600*24];
notification.fireDate = fireTime;
notification.alertBody = @"Your Message!";
notification.applicationIconBadgeNumber = 1;
[[UIApplication sharedApplication] scheduleLocalNotification:notification]; 
```

如果您在模拟器上进行测试，那么这可能就是您没有得到输出的原因。在设备上测试它，看看它是否工作。

# xaml - XAML 将背景的组合框样式设置器绑定到内存对象的字段值

> ID：14063567
> 
> 赞同：1
> 
> 时间：2012-12-28T01:44:43.573
> 
> 标签：xaml, data-binding, combobox, setter

我有一个组合框，绑定到一个对象列表。我可以让对象很好地填充下拉列表。我正在尝试为下拉项目列表中的每个对象设置背景颜色。我可以在下面的样式代码中轻松地为所有这些设置任何颜色。

我想要做的是将背景颜色值绑定到我的 Key 对象的 KeyColorValue 字段。

这是我的 XAML：

```
 DisplayMemberPath="Name" 
              HorizontalAlignment="Left" 
              Margin="300,103,0,0" 
              VerticalAlignment="Top"
              Width="186" 
              SelectionChanged="roleBoundSelector_SelectionChanged" >
        <ComboBox.ItemContainerStyle>
            <Style TargetType="ComboBoxItem">
                <Setter Property="Background"
                Value = "{Binding Path=KeyColorValue}" /> 
```

（如果我在这里输入颜色，它就可以正常工作......需要绑定到 MyKeys 对象的 KeyColorValue。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T20:55:41.677

在你的风格中试试这个：

```
<Setter Property="Background">
    <Setter.Value>
        <Binding RelativeSource="{RelativeSource Self}" Path="DataContext.KeyColorValue"/>
    </Setter.Value>
</Setter> 
```

每个 ComboBoxItem 的 DataContext 是一个包含在列表中的对象，该对象为 ComboBox 的 ItemsSource 提供数据。

让我知道这是否有帮助，问候！

# jquery - jQuery when().then() 在 AJAX 调用期间显示加载

> ID：14063570
> 
> 赞同：2
> 
> 时间：2012-12-28T01:45:43.430
> 
> 标签：jquery, ajax, loading

我正在使用 jQuery 在 CodeIgniter 上开发一个 Web 应用程序，并且我正在尝试制作一个 javascript 函数来在 ajax 调用期间显示一个 ajax 加载图像。在我的示例中，ajax 调用成功但加载从未显示，所以我认为问题是“when”中的第一个函数未执行。有人可以帮助我吗？谢谢

[http://jsfiddle.net/fEnPz/8/](http://jsfiddle.net/fEnPz/8/)

HTML

```
<div id="form"></div>​ 
```

CSS

```
#form {
  height: 300px;
  width: 350px;
}

.loadingOverlay {
  border: 1px solid #EFEFEF;
  background-color: #D8DCDF;
  -webkit-border-radius: 5px;
  -moz-border-radius: 5px;
  border-radius: 5px;
  position: absolute;
  padding: 10px;
  z-index: 1;
  -moz-opacity: 0.50;
  opacity: 0.50;
  -ms-filter:"progid:DXImageTransform.Microsoft.Alpha"(Opacity=50);
}​ 
```

Javascript

```
function displayLoading(Container, Callback) {
    var height = Container.height();
    var width = Container.width();
    $.when(function() {
      Container.append('<div class="loadingOverlay" style="width: '+ width +'px; height: '+ height +'px;"><img class="ajaxLoading" src="http://www.ajaxload.info/images/exemples/2.gif" /></div>');
      Container.find(".loadingOverlay").position({
          "my": "center center",
          "at": "center center",
          "of": Container
      });
      Container.find(".ajaxLoading").position({
          "my": "center center",
          "at": "center center",
          "of": Container
      });
    }, Callback()).then(function() {
      Container.find(".loadingOverlay").hide().remove();
    });
}

displayLoading($("#form"), function() {
    $.ajax({
      url: 'http://search.twitter.com/search.json',
      dataType: 'jsonp',
      data: {
            q: 'ConceptionAb6'
      },
      success: function(results) {
        // Only for testing the loading
        setTimeout(function() {
          alert(results.max_id);
        }, 2000);
      },
      error: function() {
        alert("error!");
      }
    });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-17T00:49:30.953

为了制作 ajax 加载动画，只需执行以下操作：

```
$("<img src='loading.gif'/>").bind({
    ajaxStart: function() { $(this).show(); },
    ajaxStop: function() { $(this).hide(); }
}); 
```

它利用 jQuery 的内置全局 ajax 事件，在`$.ajax()`调用发生时触发并将它们绑定到您的动画元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T02:27:12.983

问题似乎在于将 ajax 调用包装在一个函数中。这工作正常：

```
function displayLoading(Container, Callback) {
    var height = Container.height();
    var width = Container.width();

      Container.append('<div class="loadingOverlay" style="width: '+ width +'px; height: '+ height +'px;"><img class="ajaxLoading" src="/img/ajax-loader.gif" /></div>');
      Container.find(".loadingOverlay").position({
          "my": "center center",
          "at": "center center",
          "of": Container
      });
      Container.find(".ajaxLoading").position({
          "my": "center center",
          "at": "center center",
          "of": Container
      });

    $.when($.ajax({
      url: 'http://search.twitter.com/search.json',
      dataType: 'jsonp',
      data: {
            q: 'ConceptionAb6'
      },
      success: function(results) {
        setTimeout(function() {
          alert(results.max_id);
        }, 2000);
      },
      error: function() {
        alert("error!");
      }
    })).then(function() {
      Container.find(".loadingOverlay").hide().remove();
    });
}

displayLoading($("#form"));
​ 
```

我已经阅读了延迟对象在 jQuery 中的工作原理，并找到了一种不同的方法。[http://colonelpanic.net/2011/11/jquery-deferred-objects/](http://colonelpanic.net/2011/11/jquery-deferred-objects/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-28T02:35:55.760

在我看来 $.when 在使用多个异步请求时更常见。在你的情况下，我会使用：

```
$.ajax({
    beforeSend: function() {
        var Container = $("#form");
        var height = Container.height();
        var width = Container.width();
        Container.append('<div class="loadingOverlay" style="width: '+ width +'px; height: '+ height +'px;"><img class="ajaxLoading" src="/img/ajax-loader.gif" /></div>');
        Container.find(".loadingOverlay").position({
            "my": "center center",
            "at": "center center",
            "of": Container
        });
        Container.find(".ajaxLoading").position({
            "my": "center center",
            "at": "center center",
            "of": Container
        });
    },
    url: 'http://search.twitter.com/search.json',
    dataType: 'jsonp',
    data: {
        q: 'ConceptionAb6'
    },
    success: function(results) {
        alert(results.max_id);
    },
    error: function() {
        alert("error!");
    },
    complete: function() {
        $("#form").find(".loadingOverlay").hide().remove();
    }
});
​ 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-28T02:38:45.527

剥离`displayLoading()`到我得到的骨头......

```
function displayLoading(Container, Callback) {
    ...
    $.when(function(){...}, Callback()).then(function() {
        ...
    });
} 
```

...揭示`$.when()`没有正确使用。

`$.when()`期望它的所有论点都是承诺，这不是任何一个论点的情况。

*   第一个参数：从未调用过的函数。
*   第二个参数：一个被调用但不返回承诺的函数。

此外，`$.when()`这是不必要的，因为只涉及一个 promise（由 $.ajax() 返回的 jqXHR）。

我认为你想要的模式是这样的：

```
function displayLoading(container, promise) {
    //create a spinner in container if not already created
    //show spinner
    //hide other content
    promise.done(function() {
        //hide spinner
        //show other content
    });
}

displayLoading($("#form"), $.ajax({
    //ajax options
}); 
```

# javascript - 如何防止 Markdowndeep 中的 HTML 输入？

> ID：14063571
> 
> 赞同：0
> 
> 时间：2012-12-28T01:45:52.560
> 
> 标签：javascript, asp.net, markdown, markdowndeep

我正在寻找一个简单的选项来禁止任何 HTML 条目。我想防止用户复制+粘贴他们在网络上找到的外部 HTML，因为它总是会导致问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T02:06:15.490

这是跨浏览器的一项肮脏工作。对于 safari 和 chrome，您可以使用粘贴事件。例如：

```
document.querySelector("div[contenteditable]").addEventListener("paste", function(e) {
    e.preventDefault();
    var text = e.clipboardData.getData("text/plain");
    var temp = document.createElement("div");
    temp.innerHTML = text;
    document.execCommand("insertHTML", false, temp.textContent);
});​ 
```

使用 onbeforepaste 和/或 onpaste 的 IE 也是如此。但主要问题是，您无法在 Firefox 中访问剪贴板。一些项目使用隐藏的文本区域并捕获 CTRL+V 之类的键盘组合，但据我所知，这些解决方案并不是很令人满意。

# c# - 共享对象和线程

> ID：14063572
> 
> 赞同：3
> 
> 时间：2012-12-28T01:45:58.457
> 
> 标签：c#, multithreading

我设计了一个类`MemoryBlock`。就像名字所说的那样，它是一块（非托管）内存。我只是这样做`var x = new MemoryBlock (1024, 16)`，它给了我 1kB 的内存（也对齐到 16 个字节）。所以现在一些线程想要使用不安全的上下文读/写这个块。我做了类似`SyncRoot`属性的事情来同步线程。所以我`lock (myMemoryBlock.SyncRoot)`用记忆做一些事情。我不知道它好不好，但我在收藏中看到了这样的东西。
这种简单的机制不允许多个线程访问该对象。写作可以，但阅读不够。我想要这样的东西：

1）如果线程正在写入对象，则没有其他线程可以访问该对象
2）如果线程正在从对象读取，许多其他线程可以从该对象读取，但不能写入它
3）如果使用对象并且线程要写入, 线程等待直到对象空闲
4) 专家模式：如果一些线程正在读取对象，而另一个线程想要写入它，它会等待直到对象空闲但也告诉对象停止允许访问要读取的新线程从这个对象（队列）。

我会很高兴得到简单的提示，不需要代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T02:32:13.523

您应该使用[ReaderWriterLockSlim](http://www.albahari.com/threading/part4.aspx#_Reader_Writer_Locks)。

下面是这个类的常见用法：

```
public class SomeClass
{
    private MemoryBlock block = new MemoryBlock(1024, 16);

    private ReaderWriterLockSlim blockSyncObjcect = new ReaderWriterLockSlim();

    public void SomeRead()
    {
        blockSyncObjcect.EnterReadLock();

        // Safe reading from the block

        blockSyncObjcect.ExitReadLock();
    }

    public void SomeWrite()
    {
        blockSyncObjcect.EnterWriteLock();

        // Safe writing to the block

        blockSyncObjcect.ExitWriteLock();
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T02:13:23.193

看看**ReaderWriterLockSlim**。基本上它有利于许多读者需要同时阅读但任何作家都应该阻止所有读者的情况。如果您的读/写比率为 50:50，则使用常规 lock(obj){}

示例：ReadWriteLockSlim 适用于缓存，即每秒有许多读者，但缓存每 5 分钟更新一次。

[http://msdn.microsoft.com/en-us/library/system.threading.readerwriterlockslim.aspx](http://msdn.microsoft.com/en-us/library/system.threading.readerwriterlockslim.aspx)

# ios - 输入长文本时如何调整文本视图的大小？

> ID：14063576
> 
> 赞同：0
> 
> 时间：2012-12-28T01:46:17.220
> 
> 标签：ios, textview, autosize

我在 tableview 的最后一个单元格中有一个文本字段。文本字段一开始是一行，当我输入超过一行的文本时，我需要更改文本字段的高度才能查看所有文本。我怎样才能做到这一点？

编辑1：我尝试过文本视图，它可以输入多行文本，但我怎么知道它什么时候从一行变成两行？因为我也需要调整单元格高度。

编辑 1 的答案 [UITextView Auto Height](https://stackoverflow.com/questions/7237449/uitextview-auto-height)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-28T01:50:03.997

你不能用 UITextField 做这样的事情，因为它只是一个字段，你不能改变它的高度。否则，请查看可以根据需要设置的 UITextView、它的框架等...您只需将其设置为`editable`可以在其中写入文本。

# python - 优化python代码以提高性能

> ID：14063577
> 
> 赞同：2
> 
> 时间：2012-12-28T01:46:29.310
> 
> 标签：python, performance, optimization

假设这首歌`i`已经播放了`f`[i]次，但 Zipf 定律预测它会播放`z`[i]次。然后你定义歌曲的质量为`i`i `q`[=] i `f`[/] i `z`[。你的软件应该选择]`q`[i] 值最高的歌曲。

输入的第一行包含两个整数`n`和`m`( `1 <= n < 50 000`, `1 <= m <= n`)，专辑中歌曲的数量，以及要选择的歌曲数量。然后按照`n`线路。这些行中的第`i`' 行包含一个整数`f`[i]和字符串`s`[i]，其中`0 <= f`[i]`< 10^12` 是第`i`' 首歌曲被收听的次数，而`s`[i]是歌曲的名称。每首歌曲名称最长为 30 个字符，并且仅包含字符`a-z`、`0-9`和下划线 ( `_`)。

输出质量最高的 m 首歌曲的列表`q`[i]，按质量降序排列。如果两首歌曲质量相同，则优先考虑专辑中最先出现的那首（大概制作人有理由将那首歌曲放在另一首之前）。

```
sample input 
4 2
30 one
30 two
15 three
25 four

sample output
four
two 
```

我对python很陌生，我正在尝试解决这个难题我想我得到了正确的答案，但我必须做得更快，有什么建议吗？

```
from __future__ import division

def main():
    import sys
    from operator import itemgetter

    data = sys.stdin.readlines()
    line1 = data[0].split(" ")
    numberofselect = line1[1]

    qualitydict = {};
    songdict = {};
    a = 0

    for x in range(1, len(data)):
        item = data[x].split(" ");
        item1 = item[1].split("\n");
        f = float(item[0])
        z = float(1/x)
        qualitydict[item1[0]] = (f/z)
        if ((f/z) in songdict.keys()):
            songdict[(f/z)].append(item1[0])
        else:
            songdict[(f/z)] = [item1[0]]

    items = songdict.items()
    items.sort(key = itemgetter(0), reverse=True)

    for key, value in items:
            for element in value:
                if (a < int(numberofselect)):
                    print element
                    a = a + 1

main(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T07:51:14.303

您可以在可读性和性能方面进行许多改进[未测试]：

```
from __future__ import division
import sys
from operator import itemgetter
from collections import defaultdict

def main():

    line1 = sys.stdin.readline().split(" ")
    numberofselect = int(line1[1])

    qualitydict = {}
    songdict = defaultdict(list)

    for x, line in enumerate(sys.stdin, start=1):
        tokens = line.split()
        val = float(tokens[0]) * x
        qualitydict[tokens[1]] = val
        songdict[val].append(tokens[1])

    items = songdict.items()
    items.sort(key=itemgetter(0), reverse=True)
    a = 0
    for key, value in items:
            for element in value:
                if a < numberofselect:
                    print element
                    a += 1

main() 
```

尤其：

*   使用一个`defaultdict`for `songdict`。`list`如果键不存在，它将自动创建一个新值。另外：**不要`key in your_dict.keys()`用于查看键是否在字典**中，因为该检查是`O(n)`. 使用`key in your_dict`需要`O(1)`时间。请注意，使用 a`defaultdict`您根本不必进行检查，它已经为您完成了。

*   你定义`z`as`1/x`然后你 do `f/z`，但这和 do 是一样的`f * x`，唯一的区别是后者会更精确（`x`是一个整数，所以do`1/x`会失去一些精度）。

*   我想知道是否有必要使用`op.itemgetter(0)`. 我的意思是，元素是元组，因此它们将首先按第一个键排序，然后按第二个键排序，结果将是您想要按质量**和**字母顺序排序的歌曲（当不止一首歌曲的质量相同时） . 请注意，即使您可能认为排序`op.itemgetter(0)`会更快，但我认为这不一定是正确的，因为您为每个元素添加了一个函数调用，python 必须使用一些空间来保留键值。

事实上，如果我们检查时间：

```
>>> timeit.timeit('L.sort()', 'import random;L = [(random.randint(0, 100), i) for i in range(3000)]', number=10000)
1.3252038955688477
>>> timeit.timeit('L.sort(key=operator.itemgetter(0))', 'import random;import operator;L = [(random.randint(0, 100), i) for i in range(3000)]', number=10000)
2.926893949508667 
```

增加`itemgetter`版本的性能会提高大小，但是您必须仔细检查它在什么时候变得更好，因为即使使用`50000`元素：

```
>>> timeit.timeit('L.sort()', 'import random;L = [(random.randint(0, 1000), i) for i in range(50000)]', number=1000)
13.771193027496338
>>> timeit.timeit('L.sort(key=operator.itemgetter(0))', 'import random;import operator;L = [(random.randint(0, 1000), i) for i in range(50000)]', number=1000)
21.419496059417725 
```

*   `line.split()`没有在任何空格上拆分的参数。

例如：

```
>>> 'A string with   some    space,\ttabs and \n\n newlines'.split()
['A', 'string', 'with', 'some', 'space,', 'tabs', 'and', 'newlines'] 
```

这与以下内容完全不同：

```
>>> 'A string with   some    space,\ttabs and \n\n newlines'.split(' ')
['A', 'string', 'with', '', '', 'some', '', '', '', 'space,\ttabs', 'and', '\n\n', 'newlines'] 
```

# html - 受使用字体影响的表格布局

> ID：14063583
> 
> 赞同：0
> 
> 时间：2012-12-28T01:47:03.403
> 
> 标签：html, css, fonts, html-table

显然，谷歌的 Dosis 字体搞砸了表格布局：

```
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
    <head>
        <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8" />
        <title>Test</title>
        <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Dosis" />
        <style type="text/css">
            table {
                width: 100%;
            }

            td {
                outline: 1px solid red;
            }

            #test {
                font-family: "Dosis";
            }
        </style>
    </head>
    <body>
        <table id="test">
            <tr>
                <td>1</td>
                <td>2</td>
                <td>3</td>
                <td>4</td>
                <td>5</td>
            </tr>
        </table>
        <table id="control">
            <tr>
                <td>1</td>
                <td>2</td>
                <td>3</td>
                <td>4</td>
                <td>5</td>
            </tr>
        </table>
    </body>
</html> 
```

在上面的设置中，设置 Dosis 的表格中的单元格间距不均匀，而没有设置字体系列的表格中的单元格与预期的一样。

令人惊讶的是，不正确的行为在 Firefox、Chrome 和 Opera 中完全一致。

谁能解释一下，并可能给出解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T02:50:25.750

我想是因为1,2,3,4,5的宽度不一样，为什么我会这样想？尝试使用相同的文本：

```
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
    <head>
        <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8" />
        <title>Test</title>
        <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Dosis" />
        <style type="text/css">
            table {
                width: 100%;
            }

            td {
                outline: 2px solid red;
            }

            #test {
                  font-family: 'Dosis';

            }
        </style>
    </head>
    <body>
        <table id="test">
            <tr>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
            </tr>
        </table>
        <table id="control">
            <tr>
                <td>1</td>
                <td>2</td>
                <td>3</td>
                <td>4</td>
                <td>5</td>
            </tr>
        </table>
    </body>
</html>​​​​​​ 
```

您可以使用 css 来固定 td 标签的宽度。或 javascript 使宽度动态分配。

# user-interface - PyQt：用图像创建简单的男人

> ID：14063585
> 
> 赞同：1
> 
> 时间：2012-12-28T01:47:43.853
> 
> 标签：user-interface, focus, pyqt4, imagebutton, qlabel

我正在使用 PyQt4 创建一个带有 2X3 ImageButtons 的简单 GUI 菜单。它应该看起来像这样，除了应该有图像而不是文本：

![应该有图片而不是文字](../Images/83e64e2decdd9bd004be16bc46f66716.png)

我遵循了本教程：[http](http://popdevelop.com/2010/05/an-example-on-how-to-make-qlabel-clickable/) : //popdevelop.com/2010/05/an-example-on-how-to-make-qlabel-clickable/ 用于从 QLabels 创建图像按钮，并将它们放在网格布局中。

它工作正常，但我的问题是我的应用程序应该使用键盘箭头（没有鼠标），所以我想在被选中之前显示哪个标签被聚焦。

可以在 PyQt 中做吗？提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T21:25:29.133

捕获键盘事件的一种方法是在您的应用程序中安装一个[事件过滤器](http://doc.qt.digia.com/4.7-snapshot/qobject.html#installEventFilter)`installEventFilter ( QObject * filterObj )`，然后使用以下内容进行过滤：

```
if event.type() == QEvent.KeyPress:
    print "Key pressed!" 
```

# c++ - 使用 Visual C++ 对串口 arduino 进行编程

> ID：14063588
> 
> 赞同：0
> 
> 时间：2012-12-28T01:48:04.993
> 
> 标签：c++, serial-port, arduino

我想从 arduino 读取模拟传感器到我的电脑。

Arduino程序是：

```
void setup() {
  // initialize serial communications at 9600 bps:
  Serial.begin(9600); 
}

void loop() {
char request[1];
if(Serial.available()){
request[0]=Serial.read();
Serial.print(analogRead(atoi(request)));
Serial.print("\n\r");
};
delay(2);                     
} 
```

和我的视觉 C++

```
#include <windows.h>
#include "stdafx.h"
#include "SerialClass.h"

char buffer[20];
char buf0[200];

int _tmain(int argc, _TCHAR* argv[])
{
   Serial oSerial("COM6:");

while(1){
sprintf_s(buffer,"0");    
    oSerial.WriteData(buffer,1); 
Sleep(1000);
oSerial.ReadData(buf0,4);
printf("Sensor 0: %s \n",buf0);
Sleep(1000); }
} 
```

我的程序结果不稳定，我在input0中输入了5V，所以它必须是1023：

```
sensor 0 :
sensor 0 : 10230
sensor 0:
100
sensor 0: 23
0
sensor 0: 10230 
```

我尝试在我的 arduino 中使用串行监视器，程序正在运行。所以可能问题出在c ++程序中

有人知道吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T17:58:36.740

我相信问题是因为您的 PC 正在寻找 4 个字符而 Arduino 每个请求发送 3-6 个字符。

我建议您将字符接收到缓冲区中，直到您收到 Arduino 发送的回车符 (\r)。然后就可以输出完整的字符串了。您将需要处理控制字符。

未经测试的例子：

代替

```
oSerial.ReadData(buf0,4); 
```

和

```
int x=0;
int char_rev;

while(buf0[x]!='\r') {

    char_rev = oSerial.ReadData(buf0[x],1);
    if (char_rev==1) {
        x++;
    }
}
buf0[x]=0; 
```

# jquery - 请帮助 jQuery 只为第一段执行

> ID：14063591
> 
> 赞同：1
> 
> 时间：2012-12-28T01:48:18.643
> 
> 标签：jquery

下面的一些 jquery 代码可以正常工作，就像在段落中添加元素一样。我的问题是它只显示第一段和正文中多少段的重复次数。只需检查下面的代码。

```
<!DOCTYPE html>
<html> 
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<body>
<script type="text/javascript">
$(document).ready(function() {
$('p.content').each(function() {
var content = $(this).html();    
var beforeContent = "<em>";
var afterContent = "</em>";
$(this).html(beforeContent+content+afterContent)
});
})
</script>
<p class="content">Hex value of white is #FFFFFF;</p>
<p class="content">Hex value of black is #000000;</p>
<p class="content">Hex value of blue is #0000FF;</p>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T01:56:38.127

`ID`应该是唯一的。您不能`ID`在其他元素上使用相同的。而是使用`class`

如果您只需要第一个元素来获取更新，请使用[`.first()`](http://api.jquery.com/first/)

例如：

```
$('p#content').first().html(getX+beforeContent+theRest+afterContent) 
```

这是完整的代码，（更改`id`为`class`）

```
<!DOCTYPE html>
<html> 
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<body>
<script type="text/javascript">
$(document).ready(function() {
  var content = $('p.content').html();
  var X = /\b\w*x/; 
  var Y = /\b(\w*x)\b(.*)$/; 
  var getX = X.exec(content); 
  var getY = Y.exec(content); 
  var theFirst = getY ? getY[1]:null; 
  var theRest = getY ? getY[2]:null; 
  var beforeContent = "<em>";
  var afterContent = "</em>";
  $('p.content').first().html(getX+beforeContent+theRest+afterContent)
})
</script>
  <p class="content">Hex value of white is #FFFFFF;</p>
  <p class="content">Hex value of black is #000000;</p>
  <p class="content">Hex value of blue is #0000FF;</p>
</body>
</html>​ 
```

演示：http: [//jsfiddle.net/qpBaS/](http://jsfiddle.net/qpBaS/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T01:58:31.667

如果你想做所有这些，你需要遍历 p-tags

```
<script type="text/javascript">
    $(document).ready(function() {
        $('p.content').each(function() {
            var content = $(this).html();
            var X = /\b\w*x/; 
            var Y = /\b(\w*x)\b(.*)$/; 
            var getX = X.exec(content); 
            var getY = Y.exec(content); 
            var theFirst = getY ? getY[1]:null; 
            var theRest = getY ? getY[2]:null; 
            var beforeContent = "<em>";
            var afterContent = "</em>";
            $(this).html(getX+beforeContent+theRest+afterContent)
        });
    })
</script> 
```

然后更改`id`为`class`

```
<p class="content">Hex value of white is #FFFFFF;</p>
<p class="content">Hex value of black is #000000;</p>
<p class="content">Hex value of blue is #0000FF;</p> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T01:54:53.203

改变这个

```
var content = $('p#content').html();
$('p#content').html(getX+beforeContent+theRest+afterContent)
<p id="content">Hex value of white is #FFFFFF;</p>
<p id="content">Hex value of black is #000000;</p>
<p id="content">Hex value of blue is #0000FF;</p> 
```

至

```
 <p class="content">Hex value of white is #FFFFFF;</p>
<p class="content">Hex value of black is #000000;</p>
<p class="content">Hex value of blue is #0000FF;</p>
var content = $('.content').html();
$('.content').html(getX+beforeContent+theRest+afterContent) 
```

# java - 如何从记录列表插入数据库？

> ID：14063593
> 
> 赞同：0
> 
> 时间：2012-12-28T01:48:38.613
> 
> 标签：java

请看下面的代码。

```
private void printToConsole(List cellDataList) {
    for (int i = 1; i < cellDataList.size(); i++) {
        List cellTempList = (List) cellDataList.get(i);
        System.out.println(cellTempList);
    }
} 
```

如何从上面的代码中获取数据以插入数据库。

```
String sql2 = "INSERT INTO Daily_Report (field1,field2,field3,field4,field5,field6,field7,field8,field9,field10,field11,field12,field13,field14) values(?,?,?,?,?,?,?,?,?,?,?,?,?,?)";
                        preparedstatement = con3.prepareStatement(sql2);
                        //Statement stmt = con3.createStatement();
                        System.out.println("1");
                        preparedstatement.setString(1, field1);
                        preparedstatement.setString(2, field2);
                        preparedstatement.setString(3, field3);
                        preparedstatement.setString(4, field4);
                        preparedstatement.setString(5, field5);
                        preparedstatement.setString(6, field6);
                        preparedstatement.setString(7, field7);
                        preparedstatement.setString(8, field8);
                        preparedstatement.setString(9, field9);
                        preparedstatement.setString(10, field10);
                        preparedstatement.setString(11, field11);
                        preparedstatement.setString(12, field12);
                        preparedstatement.setString(13, field13);
                        preparedstatement.setString(14, field14);
                        preparedstatement.executeUpdate(); 
```

您能否提一些建议...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T05:55:12.767

```
String sql2 = "INSERT INTO Daily_Report (field1,field2,field3,field4,field5,field6,field7,field8,field9,field10,field11,field12,field13,field14) values(?,?,?,?,?,?,?,?,?,?,?,?,?,?)";
preparedstatement = con3.prepareStatement(sql2);

for (int i = 1; i < cellDataList.size(); i++) {
        List cellTempList = (List) cellDataList.get(i);
        for (int i = 0; i <14; i++) {
            preparedstatement.setString(i+1, cellTempList.size() > i ? cellTempList.get(i) : "");        
        }
} 
```

假设 ：

1.  `cellDataList`是您正在阅读的 excel 中所有行的列表。
2.  `cellTempList`是表示行内容的列表

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T01:55:13.437

就像是？

```
for (int i = 0; i < rowDataList.size() && i <14; i++) {
    preparedstatement.setString(i+1, rowDataList.get(i));        
}
for (int i = rowDataList.size()+1; i <=14; i++) {
    preparedstatement.setString(i+1, "");        
}
preparedstatement.executeUpdate(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T04:00:01.883

写这个；

```
 for (int i = 0; i < cellDataList.size(); i++){
          stmt.executeUpdate ((String) cellDataList.get (i));
    } 
```

# c# - 从 Web 服务获取数据时 WPF 崩溃

> ID：14063595
> 
> 赞同：0
> 
> 时间：2012-12-28T01:48:49.953
> 
> 标签：c#, wpf, web-services

我正在做一个 WPF 应用程序，应用程序需要从 web 服务中获取数据。这些应用程序可以在我的 Visual Studio 中运行，但数据抓取需要 5 秒以上。但是，在我发布它并在另一台电脑上尝试之后，只要我点击搜索按钮，应用程序就会崩溃。我需要实现 try & catch 方法吗？有什么建议吗？

搜索按钮的代码片段：

```
private void serachBtn_Click(object sender, RoutedEventArgs e)
{
    StoreApi.WebService myApi = new StoreApi.WebService();
    var dbs = myApi.GetStorageInfo(0);
    var query = from p in dbs
                select new
                {
                    Name = p.ProductName,
                    Price = p.ProductPrice,                     
                };

    myProductDataGrid.ItemsSource = query;  
} 
```

崩溃程序的图像：

![在此处输入图像描述](../Images/cb296a5467b136d34033ac7026a3442f.png)

问题详情：

```
 Problem Event Name:   CLR20r3 
  Problem Signature 01: beaconproject.exe  
  Problem Signature 02: 1.0.0.0  
  Problem Signature 03: 50dc1b77  
  Problem Signature 04: mscorlib 
  Problem Signature 05: 4.0.30319.17929 
  Problem Signature 06: 4ffa561c
  Problem Signature 07: 2f1a
  Problem Signature 08: 23
  Problem Signature 09: System.FormatException
  OS Version:   6.1.7601.2.1.0.256.4
  Locale ID:    1033
  Additional Information 1: 0a9e
  Additional Information 2: 0a9e372d3b4ad19135b953a78882e789
  Additional Information 3: 0a9e
  Additional Information 4: 0a9e372d3b4ad19135b953a78882e789
  Read our privacy statement online:
  http://go.microsoft.com/fwlink/?linkid=104288&clcid=0x0409 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T04:43:30.557

尝试保留一个错误记录器，记录代码中的每个步骤。可以是txt文件。写入每行执行后的状态。最好也有try-catch。因此，您也可以获得有关错误的更多详细信息。

# assembly - 为什么 x86(-64) 上的有符号和无符号乘法指令不同？

> ID：14063599
> 
> 赞同：28
> 
> 时间：2012-12-28T01:49:08.083
> 
> 标签：assembly, x86, x86-64, twos-complement

我认为 2 的补码的全部意义在于，对于有符号和无符号数字，操作可以以相同的方式实现。[Wikipedia 甚至专门将乘法列为受益的操作之一](http://en.wikipedia.org/wiki/2%27s_complement)。那么为什么 x86 对每个都有单独的指令，`mul`并且`imul`？x86-64 仍然如此吗？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-12-28T02:00:39.787

加法和减法是相同的，乘法的低半部分也是如此。然而，完全乘法不是。简单的例子：

在 32 位二进制补码中，-1 与无符号量 2**32 - 1 具有相同的表示。但是：

```
-1 * -1 = +1
(2**32 - 1) * (2**32 - 1) = (2**64 - 2**33 + 1) 
```

（请注意，两个结果的低 32 位是相同的；这就是我说“乘法的低半部分”相同时的意思）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-02-09T00:47:41.020

两个 16 位数字相乘产生 32 位结果。即使其中一个数字是“1”，处理器也会有效地将另一个数字扩展到 32 位。将数字扩展到更长位长度的过程是有符号和无符号值不同的操作之一（符号重要的另一个重要操作是幅度比较，这也是除法的重要部分）。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-03-07T01:13:27.923

对于 2 和 3 操作数版本，结果将相同，只是 mul 和 imul 指令在设置 CF 和 OF 标志（进位和溢出）的方式上有所不同。

考虑两种情况：-1 * -1 与 0xFFFFFFFF * 0xFFFFFFFF 在溢出方面，你会明白的。

# objective-c - 我可以从 NSRunningApplication 获取实际的菜单栏吗？

> ID：14063601
> 
> 赞同：1
> 
> 时间：2012-12-28T01:49:26.580
> 
> 标签：objective-c, macos, key-value-observing, nsapplication, nsrunningapplication

我正在尝试访问`NSRunningApplication`OS X 中对象的菜单。它有一个`ownsMenuBar`@property，但是没有实际菜单栏的实例（这是有道理的）。相反，我很好奇如何访问`NSRunningApplication`知道何时存在的菜单栏。也许是KVO？`NSRunningApplication`an和 an之间是否有任何（甚至很小的）关系`NSApplication`？

谢谢！

- - -编辑 - - -

djai djan，您非常乐于助人，这是我根据您的建议设法完成的代码！

```
tell application "System Events"
    return menu bar of first process where frontmost is true
end tell 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T01:59:37.003

`NSRunningApplication`和之间没有关系`NSApplication`

但是你可以通过applescript（你可以桥接到可可）得到它**需要UI脚本**

脚本例如：

```
tell application "System Events"
    set m to menu bar 1 of application process "Notification Center"
end tell 
```

见：[https ://developer.apple.com/documentation/Cocoa/Conceptual/ScriptingBridgeConcepts/index.html](https://developer.apple.com/documentation/Cocoa/Conceptual/ScriptingBridgeConcepts/index.html)

# qt - 为什么我无法使用 winEvent 虚函数捕获 WIndows 本机消息？

> ID：14063602
> 
> 赞同：0
> 
> 时间：2012-12-28T01:49:35.457
> 
> 标签：qt, message

我编写了一个简单的 Qt 应用程序来使用 Qt GUI 框架捕获 Windows 本机消息。我在我的 MainFrame 类中覆盖了 QCoreApplication::winEvent(MSG *, LONG ) 虚拟函数，但是当我启动应用程序时，winEvent 无法正常工作，代码如下：

```
 MainFrame.h
class MainFrame : public QMainWindow 
{
    public:
        MainFrame(QWidget *parent = NULL);
        ~MainFrame();
    private:
        virtual bool winEvent(MSG *, LONG);
};
MainFrame.cpp
bool MainFrame::winEvent(MSG *msg, LONG lResult)
{
    QMessageBox::information(NULL, NULL, "winEvent");

    return(true);
} 
```

谁能告诉我如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-04T11:25:42.693

签名不对：

```
virtual bool winEvent(MSG *, LONG *); 
```

# ruby - 如何在机架/测试中设置 env['SERVER_NAME']？

> ID：14063604
> 
> 赞同：5
> 
> 时间：2012-12-28T01:49:48.927
> 
> 标签：ruby, rspec, sinatra, rack, webmock

在 Sinatra 测试中，`env['SERVER_NAME']`默认为`www.example.com`. 如何将其设置为任意域？

Capybara 有`.default_host`方法，但不使用 Capybara。

或者，是否可以更改 env[ `DEFAULT_HOST`]？

使用 RSpec、Sinatra、WebMock。

编辑：添加`env['SERVER_NAME'] = 'www.foo.com'`到 RSpec 测试会引发异常：

`NameError: undefined local variable or method 'env' for #<RSpec::Core::ExampleGroup::Nested_1::Nested_1:0x007fe6ce3b5ff8>`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T19:58:35.427

`env`助手只能在 Sinatra 应用程序中访问。

更改它的一种方法是在发出请求时：

```
get "/blah", {}, {'HTTP_SERVER_NAME' => 'www.foo.com' } 
```

机架/测试的第三个参数`get`或者`post`是标头哈希。

# qt - 为什么从不同的类调用时我的主窗口会自动关闭？

> ID：14063614
> 
> 赞同：0
> 
> 时间：2012-12-28T01:53:26.950
> 
> 标签：qt, qmainwindow

我似乎无法弄清楚出了什么问题，所以我在这里问你。我制作了一个名为 BOBSNetworkSessionManager 的简单类，定义如下。它是一个继承 QOBject 的简单类，因此我可以使用信号和插槽，但它没有对话框或与之关联的任何类型的窗口。它最终会调用一个登录对话框并使用凭据连接到我创建的 tcp 服务器。这个类作为一个层来管理程序的连接状态，因为它只有在连接到服务器时才能正常运行，并且由于 pci 合规性而在 15 分钟内使用而不会中断。如果这些条件不成立，该类将锁定窗口并强制重新登录。截至目前，我只是尝试任意打开主窗口，就好像凭据已经通过并且我已连接到服务器一样。问题是当我打开主窗口时它会立即消失。我似乎无法弄清楚它为什么会消失。我已经包含了我的所有文件。

BOBSDCNetworkSessionManager .h 头文件

```
#ifndef BOBSDCNETWORKSESSIONMANAGER_H
#define BOBSDCNETWORKSESSIONMANAGER_H

#include <QObject>
#include <QSettings>

class BOBSDCNetworkSessionManager : public QObject
{
    Q_OBJECT
public:
    explicit BOBSDCNetworkSessionManager(QObject *parent = 0);

protected:
    void destroyed(QObject *);

signals:

public slots:

private:
void readSettings();
void writeSettings();
QSettings networkSettings;

};

#endif // BOBSDCNETWORKSESSIONMANAGER_H 
```

* * *

BOBSDCNetworkSessionManager 实现 .cpp 文件

```
#include "bobsdcnetworksessionmanager.h"
#include "bobsmainwindow.h"

 BOBSDCNetworkSessionManager::BOBSDCNetworkSessionManager(QObject *parent) :
    QObject(parent)
{
    BOBSMainWindow w;
    w.show();
} 
```

* * *

Main.cpp 文件

```
#include "bobsdcnetworksessionmanager.h"

#include <QApplication>

int main(int argc, char *argv[])
{
    QApplication a(argc, argv);
    a.setApplicationName("Enterprise Management Suite");
    a.setApplicationVersion("Beta Version: 0.0.0.01");
    a.setOrganizationName("Enigma Web Consulting");
    a.setOrganizationDomain("http://www.EnigmaWebCo.com");

    BOBSDCNetworkSessionManager netMgr;

    return a.exec();
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T02:14:00.593

问题在这里：

```
{
    BOBSMainWindow w;
    w.show();
} 
```

`w.show()`不是阻塞调用。所以你正在创建一个窗口，显示它，然后当它超出范围时它会立即被破坏。您应该声明`w`为成员变量或在堆上构造它：

```
BOBSMainWindow *w = new BOBSMainWindow(this); 
```

# java - 将 OneToMany 提交给 NEW-Statement 构造函数

> ID：14063616
> 
> 赞同：0
> 
> 时间：2012-12-28T01:53:56.943
> 
> 标签：java, jpa, jpql

我有以下课程

```
@NamedQueries({
        @NamedQuery(name = "User.FindByFilter", query = "SELECT NEW myPkg.SimpleUser(u.name , u.email, u.roles) FROM User u WHERE UPPER(u.name) LIKE :filter AND  ORDER BY u.name")
 })
@Entity
@Table(name = "Users")
public class User implements Serializable, UserDetails {
    @Id
    private String email;
    @Basic
    private String name;
    @OneToMany(cascade = { CascadeType.REFRESH, CascadeType.PERSIST }, fetch = FetchType.EAGER)
    private Set<Authority> roles;
...
} 
```

和

```
@Entity
public class Authority implements GrantedAuthority {
//just @Id and @Basic here no specific mapping back to user
...
} 
```

我当然知道这个查询

```
@NamedQuery(name = "User.FindByFilter", query = "SELECT NEW myPkg.SimpleUser(u.name , u.email, u.roles) FROM User u WHERE UPPER(u.name) LIKE :filter AND  ORDER BY u.name") 
```

错了，因为`u.roles`是`@OneToMany`。
所以我的问题是将角色字段传递给const的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T05:12:42.710

从[JPA 2.0 规范](http://download.oracle.com/otndocs/jcp/persistence-2.0-fr-eval-oth-JSpec/)中，它分别使用`single_valued_object_field`和`collection_valued_field`来表示单个实体字段和集合实体字段：

> **single_valued_object_field**由**一对一**或**多对一**关系中的关联字段或可嵌入类类型的字段的名称指定。single_valued_object_field 的类型是相关实体或可嵌入类的抽象模式类型。
> 
> **collection_valued_field由****一对多**或**多对多**关系 中的关联字段的名称或元素集合字段的名称指定。collection_valued_field 的类型是相关实体或元素类型的抽象模式类型的值的集合。

然后它定义了 SELECT 子句，语法如下：

> *   constructor_expression ::= 新的 constructor_name (constructor_item {, constructor_item}* )
>     
>     
> *   constructor_item ::= single_valued_pa​​th_expression | 标量表达式 | 聚合表达式 | 识别变量

`constructor_item`可以接受`single_valued_path_expression`但不能接受，我`collection_valued_field`认为`new()`不能接受集合字段参数。

您必须使用 fetch 连接来检索`User`实例及其 `Authority`集合，然后手动将其转换为`myPkg.SimpleUser`

# python - 为什么这个正则表达式不起作用？也许是因为双重后视？

> ID：14063624
> 
> 赞同：1
> 
> 时间：2012-12-28T01:55:04.227
> 
> 标签：python, regex, python-3.x

我有这个正则表达式：`(?<![A-Z])(?<=[.!?])\s(?=[A-Z])` 它将一个段落分成句子（基于每个空格）。

我在本段中使用了它：`Did he know that J. Smith is a name? The term is most commonly applied to the placing of a warship in active duty with its country's military forces. The ceremonies involved are Often rooted in centuries old naval tradition. I.D. is a wonderful word.`

它打破了“J. Smith”，因为它认为“。” 代表一个句子的结束。

我正在使用 re.split() 并打印出数组，用换行符分隔值

这是上一段的输出：

```
Did he know that J.
Smith is a name?
The term is most commonly applied to the placing of a warship in active duty with its
country's military forces. (no newline at beginning of sentence)
The ceremonies involved are Often rooted in centuries old naval tradition.
I.D. is a wonderful word.` 
```

它适用于“ID”，但为什么不适用于“J. Smith”？逻辑上应该...

我希望它在字符串中检测到这个结构：

无大写字母+句点/?/!+空格+大写字母

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-28T02:27:01.760

向后看（或向前看）是一个零宽度的断言——也就是说，它在断言为真的任何点匹配一个零长度的字符串。

特别是，这意味着，如果您的正则表达式中有两个连续的后向（或前向）断言，则它们只有在它们都*在同一点*匹配时才会匹配。

因此，`(?<![A-Z])(?<=[.!?])`如果前一个字符不是范围内的大写字母`A-Z` *并且*它是字符之一，则匹配`.!?`。显然，后一个断言暗示了前一个，所以`(?<![A-Z])`你的正则表达式部分没有实际效果。

看起来您*要*断言的是前一个字符是 of`.!?`并且它*之前*的字符不是大写字母。如果是这样，一种解决方案是替换`(?<![A-Z])`为`(?<![A-Z].)`.

* * *

附言。您的原始正则表达式没有拆分“ `I.D. is`”的原因是第一个点之后没有空格`\s`来匹配，并且第二个句点之后的空格后面没有按照您的前瞻断言所要求的大写字母。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-28T02:26:51.687

除了@unutbu 的观点之外，它可能没有按照您的预期进行，因为您在同一个角色上断言两个后视，*即*您说，“前一个角色不是`[A-Z]`，它*是* `[.!?]`。” 也许你的意思是嵌套它们，*例如*

```
(?<=(?<![A-Z])[.!?])\s(?=[A-Z]) 
```

# c# - 相对于 x 和 y 客户位置，笔在哪里绘制

> ID：14063633
> 
> 赞同：2
> 
> 时间：2012-12-28T01:56:33.387
> 
> 标签：c#, winforms, graphics, drawing, rectangles

当用一定宽度的笔画一条线时，笔的宽度是如何相对于 xy 坐标分配的？

如果我的开始 x 为 10，结束 x 为 50，开始 y 为 10，结束 y 为 10，笔为 20。如果我想在 y 11 处画一条线，笔宽会向上或向下绘制 20 ? 笔的 20px 会作为边框并位于 y 的顶部，还是会充当盒子模型并绘制到盒子中？

在绘制矩形时我也有同样的问题。如果我绘制一个宽度为 100 像素 x 100 像素的矩形和一支 20 像素的笔，这会使我的矩形为 120 像素 x 120 像素，还是我的矩形是 100 像素 x 100 像素，在矩形内部绘制 20 像素？

请参阅我提供的图像。

![在此处输入图像描述](../Images/5f61e6a04faac086063ad9bb9042ae83.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T22:02:15.660

笔画在标称位置的两边，所以加减`width/2`求出线的内外边缘。

[MSDN](http://msdn.microsoft.com/en-us/library/3bssbs7z.aspx)上显示了一个示例。

![长方形](../Images/e3b0566ff5767013abcd861f21ce2aa6.png)

这也可以通过设置`.Alignment`属性来改变。

![插入矩形](../Images/a63f1cf9a717809c0dfa79ee3b5a77a0.png)

# javascript - 如何显示使用 AJAX 动态生成的隐藏元素？

> ID：14063636
> 
> 赞同：0
> 
> 时间：2012-12-28T01:56:52.170
> 
> 标签：javascript, jquery, ajax

下面的图像元素位于 AJAX 脚本中。这个图像是隐藏的，只有在触发 ajax 后才会生成，所以当我使用 JQuery 显示它时，它不起作用，因为元素还不存在。

有一个名为 的布尔变量`isTouchScreen`。我试图展示这个元素，如果`isTouchScreen`值为`true`.

我是 Javascript 新手，由于它是动态生成的，我很难显示隐藏元素。有人可以帮我解决这个问题吗？提前谢谢了。

我尝试了什么：

```
if(isTouchScreen===true){
   $('.add-item').show();
} 
```

使用 AJAX 动态生成的图像元素：

```
<img class="add-item" style="display:none" src="add-item.png"> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T02:12:31.880

尝试将条件放入 AJAX 回调中：

```
$.ajax({
  ...
  success: function() { // This runs if the request was succesful
    var $img = $('<img class="add-item" src="add-item.png">');
    $('yourContainer').append( $img.hide() ); // append and hide by default
    if ( isTouchScreen ) { // true is truthy, no need to compare
      $('.add-item').hide();
    }
  }
}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T02:07:17.003

过去我遇到过类似的问题，我通过在尝试调用动态引入 DOM 的元素上的方法之前引入短暂的延迟来解决这些问题。

也许这样的事情会有所帮助：

```
if (isTouchScreen===true) {
    setTimeout(function() {
        $('.add-item').show();
    }, 500);
} 
```

其中`500`值以毫秒为单位。

有关详细信息，请参阅[window.setTimeout 。](https://developer.mozilla.org/en-US/docs/DOM/window.setTimeout)

# visual-studio-2010 - 如何在 Visual Studio 中发布母版页？

> ID：14063640
> 
> 赞同：1
> 
> 时间：2012-12-28T01:57:26.100
> 
> 标签：visual-studio-2010, visual-studio, visual-studio-2012, master-pages, publishing

如何在 Visual Studio 中发布母版页？Visual Studio 2010 或 2012 似乎都没有通过我的 ftp 配置文件发布母版页，因此需要在 ftp 客户端中手动传输母版页。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T02:13:06.100

确保将母版页设置为内容。

# php - 如何防止重复导入图像？

> ID：14063648
> 
> 赞同：0
> 
> 时间：2012-12-28T01:58:17.050
> 
> 标签：php, magento

对不起，我是 php 的新手。下面的代码是允许您为每个产品导入多个图像。只需在导入文件中添加一个“图库”列，并用分号分隔每个图像。导入数据来自.csv 文件。但有一个错误。如果我已经导入了图像，当我再次导入时，它仍然会再次导入。当然，产品有很多重复的图像。如果产品已经导入了图像，如何防止它再次导入。

```
try {
                    $galleryData = explode(';',$importData["gallery"]);
                    foreach($galleryData as $gallery_img)
                    /**
                     * @param directory where import image resides
                     * @param leave 'null' so that it isn't imported as thumbnail, base, or small
                     * @param false = the image is copied, not moved from the import directory to it's new location
                     * @param false = not excluded from the front end gallery
                     */
                    {
                            $product->addImageToMediaGallery(Mage::getBaseDir('media') . DS . 'import' . $gallery_img, null, false, false);
                    }
                }
            catch (Exception $e) {} 
```

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T02:01:02.333

检查是否[file_exists()](http://php.net/manual/en/function.file-exists.php)。如果不导入：

```
try {
    $galleryData = explode(';',$importData["gallery"]);
    foreach($galleryData as $gallery_img){

        if(!file_exists(Mage::getBaseDir('media') . DS . 'import' . $gallery_img)){
            $product->addImageToMediaGallery(Mage::getBaseDir('media') . DS . 'import' . $gallery_img, null, false, false);
        }

    }
}catch (Exception $e) {} 
```

**注意：**这将大大减慢进程，因为它每次都必须与服务器联系以检查文件。

# javascript - JavaScript 正则表达式帮助：文本字符串中以“在某日某日，其他一些东西写道：”开头的行

> ID：14063649
> 
> 赞同：0
> 
> 时间：2012-12-28T01:58:21.877
> 
> 标签：javascript, regex

在收到的电子邮件中，第一行的格式为：

> ** 来自“Doug、Mon 和 Monta - 测试组”的新更新：在此行上方回复以发表评论 **

当有人回复时，在服务器端，我可以通过简单的`indexOf()`检查去掉那些传入的行。

问题是一些邮件客户端（比如我自己的 Apple Mail）在回复表单时在该行上方添加了额外的文本：

> 2012 年 12 月 28 日上午 10:19，“XYZ 社区 - Doug、Mon 和 Monta - 测试组”写道：

我尝试用这样的正则表达式来捕获它：

```
var rx1 = new RegExp('on.*wrote:', 'ig'); 
```

虽然这在大多数情况下都有效，但不幸的是，它也捕获了一个人可能会在早些时候回复包含“on”的文本的情况，例如：

> 在那个站点上，我认为我们感兴趣的是此页面上描述的 AgroTagger 服务，其中...

在某些情况下，会找到上述文本中的“on”，之后的所有内容都会被我的代码修剪。

我试图通过包含行首字符并添加多行修饰符来缩小正则表达式的范围，如下所示：

```
var rx1 = new RegExp('^on.*wrote:', 'igm'); 
```

但在这种情况下，根本找不到该行并包含在文本中。我猜一行开头的 ^ 元字符对于 JavaScript 字符串中间的一行实际上不起作用？

无论如何，任何建议将不胜感激。基本上，我使用`indexOf()`. 对于邮件客户端在该行上方添加更多不需要的文本的情况，我需要在此之后进行额外检查。

谢谢，

道格

ps 如果有人能告诉我如何在此处发布回复时收到电子邮件通知，我将非常感激。到目前为止，我没有尝试过任何工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T03:06:53.503

对于您描述的文字，这在我的测试中有效......

```
emailBody = emailBody.replace(new RegExp("^On .+ wrote:$[.\\r\\n]*", "im"), ""); 
```

...这非常像您的正则表达式 - 所以我不确定为什么您的完全不匹配。

我确实在收件箱中的一些电子邮件中注意到，行首有空格。也许这就是你遇到的问题？在这种情况下，这将解决它：

```
emailBody = emailBody.replace(new RegExp("^\\s*On .+ wrote:\\s*$[.\\r\\n]*", "im"), ""); 
```

# mysql - 完整性约束违规：1452 无法添加或更新子行：

> ID：14063652
> 
> 赞同：95
> 
> 时间：2012-12-28T01:58:29.817
> 
> 标签：mysql, sql

我正在尝试将值插入到我的评论表中，但出现错误。它说我不能添加或更新子行，我不知道这意味着什么。

我的架构看起来像这样

```
-- ----------------------------
-- Table structure for `comments`
-- ----------------------------
DROP TABLE IF EXISTS `comments`;
CREATE TABLE `comments` (
  `id` varchar(36) NOT NULL,
  `project_id` varchar(36) NOT NULL,
  `user_id` varchar(36) NOT NULL,
  `task_id` varchar(36) NOT NULL,
  `data_type_id` varchar(36) NOT NULL,
  `data_path` varchar(255) DEFAULT NULL,
  `message` longtext,
  `created` datetime DEFAULT NULL,
  `modified` datetime DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `fk_comments_users` (`user_id`),
  KEY `fk_comments_projects1` (`project_id`),
  KEY `fk_comments_data_types1` (`data_type_id`),
  CONSTRAINT `fk_comments_data_types1` FOREIGN KEY (`data_type_id`) REFERENCES `data_types` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  CONSTRAINT `fk_comments_projects1` FOREIGN KEY (`project_id`) REFERENCES `projects` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  CONSTRAINT `fk_comments_users` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION
) ENGINE=InnoDB DEFAULT CHARSET=utf32;

-- ----------------------------
-- Records of comments
-- ----------------------------

-- ----------------------------
-- Table structure for `projects`
-- ----------------------------
DROP TABLE IF EXISTS `projects`;
CREATE TABLE `projects` (
  `id` varchar(36) NOT NULL,
  `user_id` varchar(36) NOT NULL,
  `title` varchar(45) DEFAULT NULL,
  `description` longtext,
  `created` datetime DEFAULT NULL,
  `modified` datetime DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `fk_projects_users1` (`user_id`),
  CONSTRAINT `fk_projects_users1` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION
) ENGINE=InnoDB DEFAULT CHARSET=utf32;

-- ----------------------------
-- Records of projects
-- ----------------------------
INSERT INTO `projects` VALUES ('50dcbc72-3410-4596-8b71-0e80ae7aaee3', '50dcbc5c-d684-40bf-9715-0becae7aaee3', 'Brand New Project', 'This is a brand new project', '2012-12-27 15:24:02', '2012-12-27 15:24:02'); 
```

我试图做的mysql语句看起来像这样

```
INSERT INTO `anthonyl_fbpj`.`comments` (`project_id`, `user_id`, `task_id`, `data_type_id`, `message`, `modified`, `created`, `id`) 
VALUES ('50dc845a-83e4-4db3-8705-5432ae7aaee3', '50dcbc5c-d684-40bf-9715-0becae7aaee3', '1', '50d32e5c-abdc-491a-a0ef-25d84e9f49a8', 'this is a test', '2012-12-27 19:20:46', '2012-12-27 19:20:46', '50dcf3ee-8bf4-4685-aa45-4eb4ae7aaee3') 
```

我得到的错误看起来像这样

> SQLSTATE [23000]：完整性约束违规：1452 无法添加或更新子行：外键约束失败（`anthonyl_fbpj`. `comments`, CONSTRAINT `fk_comments_projects1` FOREIGN KEY ( `project_id`) REFERENCES `projects`( `id`) ON DELETE NO ACTION ON UPDATE NO ACTION）

* * *

## 回答 #1

> 赞同：140
> 
> 时间：2012-12-28T02:03:34.350

它只是意味着您插入`project_id`的 table 上 column 的值在 table`comments`上不存在`projects`。请记住， column `project_id`on table`comments`的值取决于 on `ID`table的值`Projects`。

`50dc845a-83e4-4db3-8705-5432ae7aaee3`您为 column 插入的值`project_id`在 table 上不存在`projects`。

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2015-08-24T06:55:41.880

确保您拥有模型`project_id`的`fillable`属性`Comment`。

我有同样的问题，这就是原因。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2019-10-23T11:30:32.103

如果您要向现有表添加新的外键并且列不为空且未分配默认值，您将收到此错误，

要么你需要做，要么`nullable`解决它。`assign default value``delete all the existing records`

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2015-11-17T03:10:46.020

还要确保您添加的外键与原始列的类型相同，如果您引用的列的类型不同，它也会失败。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2019-07-25T08:28:40.723

我希望我的决定会有所帮助。我在 Laravel 中遇到了类似的错误。我在错误的表中添加了一个外键。
错误代码：

```
Schema::create('comments', function (Blueprint $table) {
$table->unsignedBigInteger('post_id')->index()->nullable();
...
$table->foreign('post_id')->references('id')->on('comments')->onDelete('cascade');
    });

Schema::create('posts', function (Blueprint $table) {
    $table->bigIncrements('id');
    ...
    }); 
```

请注意上面的 on('comments') 函数。正确的代码

```
 $table->foreign('post_id')->references('id')->on('posts')->onDelete('cascade'); 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2020-07-09T13:35:46.627

这意味着您插入的表上列的值`project_id`不仅**在**`comments`表`doesn't exist`项目上， 而且 可能**没有默认值**。例如，在我的情况下，我将其设置为 NULL。**`project_id`**

 ****至于 Laravel，您可以将此表达式视为迁移 php 文件的代码块，例如：

```
class ForeinToPhotosFromUsers extends Migration 
```

`{ /** * Run the migrations. * * @return void */`

```
public function up()
{
    Schema::table('users', function (Blueprint $table) {
    $table->unsignedBigInteger('photo_id')->nullable();// ! ! ! THIS STRING ! ! !
    $table->foreign('photo_id')->references('id')->on('photos');
});
} 
```

`}`

显然，您必须在所有这些旁边创建模型类（在我的情况下是照片）。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2018-06-27T07:26:24.460

首先删除约束“fk_comments_projects1”及其索引。之后重新创建它。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2020-07-22T10:04:07.767

如果您没有按正确的顺序创建和填充表，您也会收到此错误。例如，根据您的架构，Comments 表需要`user_id`、`project_id`和。这意味着table、table、table 和table*必须已经退出并在其中包含值，*然后您才能引用它们的 id 或任何其他列。`task_id``data_type_id``Users``Projects``Task``Data_Type`

 *在 Laravel 中，这意味着以正确的顺序调用数据库播种器：

```
class DatabaseSeeder extends Seeder
{
    /**
     * Seed the application's database.
     *
     * @return void
     */
    public function run()
    {
        $this->call(UserSeeder::class);
        $this->call(ProjectSeeder::class);
        $this->call(TaskSeeder::class);
        $this->call(DataTypeSeeder::class);
        $this->call(CommentSeeder::class);
    }
} 
```

这就是我解决类似问题的方法。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2019-07-10T12:42:19.057

也许您在表中有一些您想要创建 de FK 的行。

使用 foreign_key_checks OFF 运行迁移 仅插入那些在目录表中具有相应 id 字段的记录。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2017-03-02T12:00:10.243

万一有人在使用 Laravel 并遇到此问题。我也得到了这个，问题在于我在数据透视表中插入 id（即外键）的顺序。

具体来说，在下面找到一个多对多关系的示例：

wordtokens <-> wordtoken_wordchunk <-> wordchunks

```
// wordtoken_wordchunk table
Schema::create('wordtoken_wordchunk', function(Blueprint $table) {
        $table->integer('wordtoken_id')->unsigned();
        $table->integer('wordchunk_id')->unsigned();

        $table->foreign('wordtoken_id')->references('id')->on('word_tokens')->onDelete('cascade');
        $table->foreign('wordchunk_id')->references('id')->on('wordchunks')->onDelete('cascade');

        $table->primary(['wordtoken_id', 'wordchunk_id']);
    });

// wordchunks table
Schema::create('wordchunks', function (Blueprint $table) {
        $table->increments('id');
        $table->timestamps();
        $table->string('text');
    });

// wordtokens table
Schema::create('word_tokens', function (Blueprint $table) {
        $table->increments('id');
        $table->string('text');
}); 
```

现在我的模型如下所示：

```
class WordToken extends Model
{
   public function wordchunks() {
      return $this->belongsToMany('App\Wordchunk');
   }
}

class Wordchunk extends Model
{

    public function wordTokens() {
        return $this->belongsToMany('App\WordToken', 'wordtoken_wordchunk', 'wordchunk_id', 'wordtoken_id');
    }
} 
```

我通过在 Wordchunk 模型中交换 'wordchunk_id' 和 'wordtoken_id' 的顺序解决了这个问题。

对于代码完成，这是我持久化模型的方式：

```
private function persistChunks($chunks) {
    foreach ($chunks as $chunk) {
        $model = new Wordchunk();
        $model->text = implode(' ', array_map(function($token) {return $token->text;}, $chunk));
        $tokenIds = array_map(function($token) {return $token->id;}, $chunk);
        $model->save();
        $model->wordTokens()->attach($tokenIds);
    }
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-05-20T04:11:08.803

当我不小心在我的孩子记录中使用了错误的“uuid”时，我遇到了这个问题。发生这种情况时，约束会从子记录到父记录，以确保链接正确。当我已经将模型装配为自动生成时，我是手动生成的。所以我的解决方法是：

```
$parent = Parent:create($recData); // asssigning autogenerated uuid into $parent 
```

然后当我调用我的子类来插入子类时，我传递了这个 var 值：

```
$parent->uuid 
```

希望有帮助。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2020-08-26T22:49:48.577

我有同样的错误，问题是我试图将`role_id`外部添加到`users`表中，但`role_id`没有默认值，所以数据库不允许我插入列，因为我已经有一些用户并且它没有知道如何将列添加到它们。因为我在开发中，所以我只使用了`migrate:fresh`，但如果我在生产中，我可能会为 设置一个默认值，`role_id`并且在我在数据库上拥有相应的角色之前不会使其不受约束。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2021-07-09T11:49:34.497

问题可能是因为在您尝试添加的 project_id 的数据库中找不到项目记录...

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-03-19T14:47:27.970

可能是您插入的外键值与主键的值不匹配。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-08-17T15:36:55.640

我有一张桌子，上面有一些带有死外国人钥匙的条目。一旦我清理了桌子，我就可以添加一个新的约束。

```
DELETE FROM `table_with_bad_entries` WHERE `expected_foreign_key` not in (select `id` from `the_referenced_table`); 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-12-09T18:54:32.230

就我而言，它不起作用，因为我在模型中的一个名称中留下了一个空格。

[![图片](../Images/7b0e7497404ab0cd46e64f875d490b99.png)](https://i.stack.imgur.com/tAIW8.jpg)

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2021-02-13T17:16:50.833

我刚刚导出了已删除的表，然后再次导入它，它对我有用。这是因为我删除了父表（用户）然后重新创建它，子表（喜欢）具有父表（用户）的外键。*****

# graph - 图：节点依赖

> ID：14063656
> 
> 赞同：0
> 
> 时间：2012-12-28T01:59:11.917
> 
> 标签：graph, dependencies

我有一个这样的图表：![在此处输入图像描述](../Images/5069db4cd917bab5289ca259ffc2eba6.png)

例如，我想知道节点 8 的依赖关系是： 1,2,3,5 。有人可以给我一些代码或者可能是伪代码来解决这个问题吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T09:16:48.483

依赖结构是一个[偏序集](http://en.wikipedia.org/wiki/Partially_ordered_set)。我有类似的案例，我用 2 种方法（在 python 中）介绍了它：

*   `nodes_to_update( to_proc )`参数是一组开始的节点（例如 set([8])）。返回两组节点：给定节点所依赖的所有节点集和叶节点集。想法是递归访问依赖访问节点的所有节点。
*   `sequence_to_update( to_proc )`参数如上。返回（有序）节点列表，以便列表中的节点仅依赖于列表中之前的节点。它是通过将叶节点添加到有序列表中并更新要处理的节点集（所有和叶节点）来完成的。

依赖节点是 get with 方法`down_nodes(o_id)`，依赖的节点是 get with `up_nodes(o_id)`。

```
def nodes_to_update(self, to_proc):
    all_to_update, first_to_update = set(), set()
    while to_proc:
        n = to_proc.pop()
        all_to_update.add(n)
        ds = self.down_nodes(n)  # nodes on which n depends
        if not ds:
            first_to_update.add(n)
        else:
            to_proc.update(ds)
    return all_to_update, first_to_update

def sequence_to_update(self, to_proc):
    all_to_update, first_to_update = self.nodes_to_update(to_proc)
    update_in_order = []
    while first_to_update:
        n_id = first_to_update.pop()
        all_to_update.discard(n_id)
        update_in_order.append(n_id)
        # nodes which depend on n_id (intersection of upper nodes and all nodes to update)
        for up_id in (self.up_nodes(n_id) & all_to_update):
            if all(d not in all_to_update for d in self.down_nodes(up_id)):
                first_to_update.add(up_id)
    return update_in_order 
```

# javascript - Facebook分享按钮不带元信息

> ID：14063657
> 
> 赞同：1
> 
> 时间：2012-12-28T01:59:18.500
> 
> 标签：javascript, html, facebook, metadata, meta

分享按钮要求我把元数据放到特定的信息上来分享。但是，它不起作用。

> 从 facebook 对象调试器
> 
> 响应码： 503
> 
> 必须修复的错误
> 
> 缺少必需属性： 'og:url' 属性是必需的，但不存在。

**头**

```
<head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <meta property="og:url" content="http://www.yahoo.com">
        <meta property="og:image" content="http://ia.media-imdb.com/rock.jpg">
        <meta property="og:image" content="http://static.adzerk.net/Advertisers/bd294ce7ff4c43b6aad4aa4169fb819b.jpg">

        <title>FlipBook</title>

        <style>
        /* Close icon for popup window */
        #close {
        width:44px;
        }
        </style> 
        <link rel="stylesheet" href="cssv3/style.css" type="text/css">
        <link rel="stylesheet" href="cssv3/jquery-ui-1.9.2.custom.min.css" type="text/css">
        <link href="http://fonts.googleapis.com/css?family=Play:400,700" rel="stylesheet" type="text/css">

        <!--[if IE]>
        <script src="js/html5.js" type="text/javascript"></script>
        <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js" type="text/javascript"></script>
        <![endif]-->

        <script>
            if (navigator.userAgent.match(/Android/i)
                || navigator.userAgent.match(/webOS/i)
                || navigator.userAgent.match(/iPhone/i)
                || navigator.userAgent.match(/iPad/i)
                || navigator.userAgent.match(/iPod/i)
                || navigator.userAgent.match(/BlackBerry/i)
                || navigator.userAgent.match(/Windows Phone/i)) {
                window.location.replace("flipV5_mobile.html");
            }
        </script>

        <!--[if IE]><script src="js/selectivizr.js"></script><![endif]-->
        <script src="jsv3/jquery-1.8.3.js"></script>
        <script src="jsv3/turn.min.js"></script>
        <script src="jsv3/onload.js"></script>
        <script src="jsv3/jquery-ui-1.9.2.custom.min.js"></script>
        <script src="jsv3/jquery.viewport.min.js"></script>
        <script src="jsv3/jquery.scraggable.js"></script>
        <script src="jsv3/jquery.jqprint-0.3.js"></script>

</head> 
```

以及初始化共享按钮的代码，除了多个图像无法共享外，一切正常，所以我不得不兄弟元的问题。（应该是共享多个图像的唯一方法吗？）

**身体**

```
<a id = "facebook" onclick="return fbs_click()" target="_blank"  title="Share on Facebook"></a> 
```

**javascript**

```
 function fbs_click() {
        u=location.href;
        t=document.title;

        window.open("http://www.facebook.com/sharer.php?s=100&p[url]=" + u + "&p[title]=" + t + "&p[summary]=paagraphhhhhh",'sharer','toolbar=0,status=0,width=626,height=436');
        return false;
    } 
```

是否有必要使用元名称来共享多个图像？如果是，如何解决问题？谢谢。

# group-by - 如何使用hbase协处理器实现groupby？

> ID：14063658
> 
> 赞同：3
> 
> 时间：2012-12-28T01:59:24.747
> 
> 标签：group-by, hbase, endpoint

最近学了hbase协处理器，我用endpoint来累积hbase表的一列。比如名为“pendings”的hbase表，它的族是“asset”，我把“asset:amount”的值全部累积起来。该表还有其他列，例如“asset:customer_name”。我要做的第一件事是通过“asset:customer_name”累积“asset:amount”组的值。但是我发现没有groupby的API，或者我没有找到。你知道如何实现 GROUPBY 或者如何使用 HBASE 提供的 API 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-25T16:41:28.883

您应该使用端点来完成这项工作。

您在本文中有一个总结示例：[https](https://blogs.apache.org/hbase/entry/coprocessor_introduction) ://blogs.apache.org/hbase/entry/coprocessor_introduction 。

您基本上需要添加的是附加您的行键和客户名称以形成您的新键“MyKey”。您应该保留最后一次看到的 MyKey 的变量，并且当当前的 MyKey 与前一个不同时，您应该发出前一个及其总和并将前一个 MyKey 覆盖为当前的。

您必须确保在客户端执行聚合，就像在 URL 中提供的示例中所做的那样，因为您可能在两个不同区域的边缘有一个客户。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-07T02:29:42.820

使用端点协处理器可以做到。你要做的就是：首先定义相关的接口（减少）协议扩展 CoprocessorPotocol，然后实现它，最后编写客户端逻辑。

# sql - 访问查询 - 如果字段为空不输出？

> ID：14063662
> 
> 赞同：3
> 
> 时间：2012-12-28T01:59:59.810
> 
> 标签：sql, ms-access, ms-access-2003

我有一个访问查询（2003）：

```
SELECT [User] [100], [101], [102], [103], [104], [105], [106], [107], [108], [109], [110]
FROM [Access_Count>1] 
```

我得到的结果如下所示：

```
[User], [100], [101], [102], [103], [104], [105], [106], [107], [108], [109], [110]
UserA,100,101,,,,,,,,,
UserB,,,,,,,,109,110 
```

有什么办法可以从输出中排除空白列/字段？所以我的结果是这样的：

```
[User], [100], [101], [109], [110]
UserA,100,101,,
UserB,,,109,110 
```

我今天通过谷歌进行了大规模的搜索，在其他地方发现了一个类似的问题，但从未解决。

样本数据：[http ://db.tt/rM2JUvNR](http://db.tt/rM2JUvNR)

干杯，

迈克尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T03:22:34.340

输出必须是表格吗？这些值可以连接成一个字符串吗？

如果是这样，您可以执行以下操作：

```
select t.[user],
       mid((iif(Keep100 = 'Y', ','&[100])&
            iif(Keep101 = 'Y', ','&[101])&
            . . .
           ), 2)
from [AccessCount>1],
     (select t, iif(max([100]) is null, 'N', 'Y') as Keep100,
             iif(max([101]) is null, 'N', 'Y') as Keep101,
             . . .
      from [AccessCount>1]
     ) tkeep 
```

这个想法是用逗号作为分隔符构建一个字符串。该`mid`语句只是删除字符串中的第一个字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T22:12:21.383

我必须分成 2 个查询，当我尝试执行所有 200 个查询时，它会将 Access 列作为#error 抛出。

非常感谢 Gordon Linoff，我希望这对未来的人有所帮助:)

```
select Access_Count_1.[Name],Access_Count_1.[Manager],
mid((iif(Keep100 = 'Y', ','&[100])&
iif(Keep101 = 'Y', ','&[101])&
iif(Keep102 = 'Y', ','&[102])&
iif(Keep103 = 'Y', ','&[103])&
iif(Keep104 = 'Y', ','&[104])&
iif(Keep105 = 'Y', ','&[105])&
iif(Keep106 = 'Y', ','&[106])&
iif(Keep107 = 'Y', ','&[107])&
iif(Keep108 = 'Y', ','&[108])&
iif(Keep109 = 'Y', ','&[109])&
iif(Keep110 = 'Y', ','&[110])&
iif(Keep111 = 'Y', ','&[111])&
iif(Keep112 = 'Y', ','&[112])&
iif(Keep113 = 'Y', ','&[113])&
iif(Keep114 = 'Y', ','&[114])&
iif(Keep115 = 'Y', ','&[115])&
iif(Keep116 = 'Y', ','&[116])&
iif(Keep117 = 'Y', ','&[117])&
iif(Keep118 = 'Y', ','&[118])&
iif(Keep119 = 'Y', ','&[119])&
iif(Keep120 = 'Y', ','&[120])&
iif(Keep121 = 'Y', ','&[121])&
iif(Keep122 = 'Y', ','&[122])&
iif(Keep123 = 'Y', ','&[123])&
iif(Keep124 = 'Y', ','&[124])&
iif(Keep125 = 'Y', ','&[125])&
iif(Keep126 = 'Y', ','&[126])&
iif(Keep127 = 'Y', ','&[127])&
iif(Keep128 = 'Y', ','&[128])&
iif(Keep129 = 'Y', ','&[129])&
iif(Keep130 = 'Y', ','&[130])&
iif(Keep131 = 'Y', ','&[131])&
iif(Keep132 = 'Y', ','&[132])&
iif(Keep133 = 'Y', ','&[133])&
iif(Keep134 = 'Y', ','&[134])&
iif(Keep135 = 'Y', ','&[135])&
iif(Keep136 = 'Y', ','&[136])&
iif(Keep137 = 'Y', ','&[137])&
iif(Keep138 = 'Y', ','&[138])&
iif(Keep139 = 'Y', ','&[139])&
iif(Keep140 = 'Y', ','&[140])&
iif(Keep141 = 'Y', ','&[141])&
iif(Keep142 = 'Y', ','&[142])&
iif(Keep143 = 'Y', ','&[143])&
iif(Keep144 = 'Y', ','&[144])&
iif(Keep145 = 'Y', ','&[145])&
iif(Keep146 = 'Y', ','&[146])&
iif(Keep147 = 'Y', ','&[147])&
iif(Keep148 = 'Y', ','&[148])&
iif(Keep149 = 'Y', ','&[149])&
iif(Keep150 = 'Y', ','&[150])
), 2) As Access
from [Access_Count_1],
(select 
iif(max([100]) is null, 'N', 'Y') as Keep100,
iif(max([101]) is null, 'N', 'Y') as Keep101,
iif(max([102]) is null, 'N', 'Y') as Keep102,
iif(max([103]) is null, 'N', 'Y') as Keep103,
iif(max([104]) is null, 'N', 'Y') as Keep104,
iif(max([105]) is null, 'N', 'Y') as Keep105,
iif(max([106]) is null, 'N', 'Y') as Keep106,
iif(max([107]) is null, 'N', 'Y') as Keep107,
iif(max([108]) is null, 'N', 'Y') as Keep108,
iif(max([109]) is null, 'N', 'Y') as Keep109,
iif(max([110]) is null, 'N', 'Y') as Keep110,
iif(max([111]) is null, 'N', 'Y') as Keep111,
iif(max([112]) is null, 'N', 'Y') as Keep112,
iif(max([113]) is null, 'N', 'Y') as Keep113,
iif(max([114]) is null, 'N', 'Y') as Keep114,
iif(max([115]) is null, 'N', 'Y') as Keep115,
iif(max([116]) is null, 'N', 'Y') as Keep116,
iif(max([117]) is null, 'N', 'Y') as Keep117,
iif(max([118]) is null, 'N', 'Y') as Keep118,
iif(max([119]) is null, 'N', 'Y') as Keep119,
iif(max([120]) is null, 'N', 'Y') as Keep120,
iif(max([121]) is null, 'N', 'Y') as Keep121,
iif(max([122]) is null, 'N', 'Y') as Keep122,
iif(max([123]) is null, 'N', 'Y') as Keep123,
iif(max([124]) is null, 'N', 'Y') as Keep124,
iif(max([125]) is null, 'N', 'Y') as Keep125,
iif(max([126]) is null, 'N', 'Y') as Keep126,
iif(max([127]) is null, 'N', 'Y') as Keep127,
iif(max([128]) is null, 'N', 'Y') as Keep128,
iif(max([129]) is null, 'N', 'Y') as Keep129,
iif(max([130]) is null, 'N', 'Y') as Keep130,
iif(max([131]) is null, 'N', 'Y') as Keep131,
iif(max([132]) is null, 'N', 'Y') as Keep132,
iif(max([133]) is null, 'N', 'Y') as Keep133,
iif(max([134]) is null, 'N', 'Y') as Keep134,
iif(max([135]) is null, 'N', 'Y') as Keep135,
iif(max([136]) is null, 'N', 'Y') as Keep136,
iif(max([137]) is null, 'N', 'Y') as Keep137,
iif(max([138]) is null, 'N', 'Y') as Keep138,
iif(max([139]) is null, 'N', 'Y') as Keep139,
iif(max([140]) is null, 'N', 'Y') as Keep140,
iif(max([141]) is null, 'N', 'Y') as Keep141,
iif(max([142]) is null, 'N', 'Y') as Keep142,
iif(max([143]) is null, 'N', 'Y') as Keep143,
iif(max([144]) is null, 'N', 'Y') as Keep144,
iif(max([145]) is null, 'N', 'Y') as Keep145,
iif(max([146]) is null, 'N', 'Y') as Keep146,
iif(max([147]) is null, 'N', 'Y') as Keep147,
iif(max([148]) is null, 'N', 'Y') as Keep148,
iif(max([149]) is null, 'N', 'Y') as Keep149,
iif(max([150]) is null, 'N', 'Y') as Keep150     
from [Access_Count_1]
) tkeep 
```

# android - ScrollView 及其子项如何控制滚动

> ID：14063664
> 
> 赞同：2
> 
> 时间：2012-12-28T02:00:19.850
> 
> 标签：android, canvas, scrollview

嗨，我现在正在开发一个 android 应用程序，它是一个简单的 meme 制造商。为了向画布添加元素（图片），我使用了这样的自定义视图作为画布......

```
<RelativeLayout>
    <CustomScrollView....
      <LinearLayout....
         <CanvasView.....
         </CanvasView>
      </LinearLayout>
    </CustomScrollView>
</RelativeLayout> 
```

所有元素都将添加到 CanvasView，并且运行良好。当我在 CanvasView 中添加拖放到元素时，它有一个问题，很难在垂直方向上拖动元素（水平很好），我认为是因为 CustomScrollView，所以我将其删除，它工作得很好。

但是 CanvasView 以前比屏幕尺寸的高度长，所以我需要 CanvasView 可以向上滚动和向下滚动，只是我认为 ScrollView 很好，我该如何解决“触摸事件”之间的冲突问题滚动视图和画布视图？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T02:37:17.570

我已经尝试了一段时间并在这里得到了解决方案：

```
public class CanvasContainerScrollView extends ScrollView {
    public boolean enableScrollView = true;

    public CanvasContainerScrollView(Context context, AttributeSet attrs) {
        super(context, attrs);
        // TODO Auto-generated constructor stub
    }

    @Override
    public boolean onTouchEvent(MotionEvent event) {
        android.util.Log.v ("scrollview", "touched");
        if (enableScrollView) {
            return super.onTouchEvent(event);
        } 

        return false;
    }

    @Override
    public boolean onInterceptTouchEvent(MotionEvent event) {
        if (enableScrollView) {
            return super.onInterceptTouchEvent(event);
        } 
        return false;
    }
} 
```

设置 enableScrollView 将启用滚动或虎钳。在 CanvasView onTouchEvent -

```
@Override
    public boolean onTouchEvent(MotionEvent ev) {
        final int action = ev.getAction();

        android.util.Log.v("canvasView", "touched");
        switch (action) {
        case MotionEvent.ACTION_DOWN: {

            final float x = ev.getX();
            final float y = ev.getY();

            int i = 2;
            for (i = goList.size() - 1; i >= 0; --i) {
                if (currentObjectLayer == -1 && goList.get(i).inHitArea(x, y)) {

                    parent.enableScrollView = false;
                    if (currentObjectLayer != -1) {
                        continue;
                    }
                    goList.get(i).selected();
                    currentObjectLayer = i;
                    // break;
                } else {
//                  if (goList.get(i).inHitArea(x, y)) {
//                      parent.enableScrollView = false;
//                  } else {
//                      parent.enableScrollView = true;
//                  }
                    goList.get(i).unselected();
                }
            }

            if (currentObjectLayer == -1) {
                parent.enableScrollView = true;
            }
            // Remember where we started
            lastTouchX = x;
            lastTouchY = y;
            break;
        }

        case MotionEvent.ACTION_MOVE: {
            final float x = ev.getX();
            final float y = ev.getY();

            // Calculate the distance moved
            final float dx = x - lastTouchX;
            final float dy = y - lastTouchY;

            // Move the object
            posX += dx;
            posY += dy;

            // Remember this touch position for the next move event
            lastTouchX = x;
            lastTouchY = y;

            // android.util.Log.v("image", "dx=" + dx + ":dy=" + dy);
            if (currentObjectLayer != -1) {
                goList.get(currentObjectLayer).left += dx;
                goList.get(currentObjectLayer).top += dy;
                goList.get(currentObjectLayer).dx = dx;
                goList.get(currentObjectLayer).dy = dy;
            }

            // Invalidate to request a redraw
            invalidate();
            break;
        }

        case MotionEvent.ACTION_UP:
        case MotionEvent.ACTION_CANCEL:
            // goList.get(currentObjectLayer).objectType = 0;
            currentObjectLayer = -1;
            parent.enableScrollView = true;
            break;
        }

        invalidate();
        return true;
    } 
```

# php - 比较运算符在 WAMP 上的 mysqli 准备语句中无法正常工作

> ID：14063667
> 
> 赞同：-1
> 
> 时间：2012-12-28T02:00:53.583
> 
> 标签：php, mysqli, wamp, wampserver

我的网站在托管站点上，一切正常，除了我正在检查允许的 cpu 使用率。我将我的网站和数据库迁移到安装了 WAMP 的本地计算机上。

**老主机：** Apache版本 *2.2.23* PHP版本 *5.3.18* MySQL版本 *5.1.66-cll*

**WAMP：** Apache *2.4.2* PHP *5.4.3* MYSQL *5.5.24*

由于某种原因，小于和大于比较运算符在我的 mysqli 准备语句中停止工作。如果我删除了 sql 语句的以下部分，那么它将返回一切正常。我还尝试手动输入日期，其中？是，并且也正确返回。

**不工作** `where last_update > ?`

**有效** `where last_update > '1991-09-26 01:25:10'`

这是我拥有的代码：

```
<?php

session_start();

$output = "You must log in to see users.";

if (isset($_SESSION['status'])){

    $status = $_SESSION['status'];
    $myUsername = $_SESSION['username'];

    if ($status == 1){

        $output = "";

        require_once __DIR__ . '/db_connect.php';
        $mysqli = new DB_CONNECT();

        $currentTime2 = date( 'Y-m-d H:i:s', strtotime('-15 seconds'));

        if ($stmt = $mysqli->prepare("select username from users where last_update > ? order by username")){

            $stmt->bind_param("s", $currentTime2);

            $username = "";

            $stmt->execute();

            $stmt->bind_result($username);

            while ($stmt->fetch()){
                if ($username != $myUsername){
                    $output = $output . "<div class='user'><div class='user-pic'></div><div class='user-name'>" . $username . "</div></div>";
                }
            }

            $stmt->close();

        }
    }
}

echo $output;

?> 
```

我从该 php 文件中得到的唯一错误是：

```
SCREAM: Error suppression ignored for
( ! ) Strict standards: Declaration of DB_CONNECT::connect() should be compatible with mysqli::connect($host = NULL, $user = NULL, $password = NULL, $database = NULL, $port = NULL, $socket = NULL) in C:\wamp\www\db_connect.php on line 31
Call Stack
#   Time    Memory  Function    Location
1   0.0002  254240  {main}( )   ..\onlineUsers.php:0 
```

这是 db_connect.php 文件：

```
<?php

class DB_CONNECT extends mysqli{

    function __construct() {

        $this->connect();
    }

    function __destruct() {

        $this->close();
    }

    function connect() {

        require_once __DIR__ . '/db_config.php';

        parent::__construct(DB_SERVER, DB_USER, DB_PASSWORD, DB_DATABASE);

        if (mysqli_connect_errno()) {
            printf("connect failed: %s\n", mysqli_connect_error());
            exit();
        }
    }

    function close() {

    }

}

?> 
```

请注意，如果我使用 bind_param 或只是手动输入日期时间，我会得到这个，所以这可能不是这里的原因。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T14:47:23.720

我自己解决了这个问题。从 $currentTime2 回显时间后，我注意到它是未来 5 小时。我在 UTC-0:500 时间，所以我在 date.timezone 行更改了我的 php.ini 文件。

`date.timezone = "America/New_York"`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T05:24:01.017

> .1。我还尝试手动输入日期，其中？是，并且也正确返回。
> 
> .2\. 请注意，如果我使用 bind_param 或只是手动输入日期时间，我会得到这个，所以这可能不是这里的原因。

... 看起来每个都矛盾，是吗？

自 1991-09-26 01:25:10 和 15 秒以来经过的时间似乎略有不同。我有一种感觉，如果它符合如此严格的条件，你必须仔细检查你的*数据。*

# windows-8 - 如何使用 Ink 和 WinRT 识别基本形状

> ID：14063676
> 
> 赞同：1
> 
> 时间：2012-12-28T02:02:44.823
> 
> 标签：windows-8, windows-runtime, shape, microsoft.ink

有没有一种简单的方法可以使用 WinRT 进行形状识别？
使用 WPF 很简单，我可以只使用 InkAnalysis，但它似乎在 WinRT(?) 中不可用。我希望能够绘制圆形、矩形和正方形的基本形状，并且我希望能够识别它们。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T09:47:20.400

开箱即用的[GestureRecognizer](http://msdn.microsoft.com/library/windows/apps/BR241937)类仅支持各种标准 Windows 8 控件中使用的简单手势。[对于您的场景，您可以尝试我在上一个问题](https://stackoverflow.com/questions/13731996/does-winrt-have-a-gesture-builder)中链接到的 1$/n$ 识别器。

# javascript - 使用 Javascript 禁用元素时，它不应用样式

> ID：14063680
> 
> 赞同：3
> 
> 时间：2012-12-28T02:03:28.323
> 
> 标签：javascript, css

在我的 CSS 中，我尝试`input`使用以下内容设置一些 s 的样式：

```
input[disabled="disabled"], input[disabled="true"] {
    [... styles ...]
} 
```

当我直接添加到 HTML 时，这很好`disabled="disabled"`用，但是当我运行以下 JS 时：

```
document.getElementById('id').disabled = true; 
```

表单域被禁用（即不能聚焦它），但样式没有改变。为什么是这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T02:07:06.523

使用以下内容：

```
input[disabled] {
  /* styles */
} 
```

它在这里工作正常：http: [//jsbin.com/asfih/1/edit](http://jsbin.com/asifih/1/edit)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T02:09:39.763

`document.getElementById('id').disabled = true;`只添加关键字属性`disabled`，而css正在寻找属性`disabled=true`。

# php - 在 PHP 类中使用 MYSQLi 准备好的语句

> ID：14063681
> 
> 赞同：0
> 
> 时间：2012-12-28T02:03:33.110
> 
> 标签：php, mysqli, prepared-statement

> **可能重复：**
> [如何在另一个页面上访问另一个类中的 mysqli 连接？](https://stackoverflow.com/questions/11113080/how-to-access-mysqli-connection-in-another-class-on-another-page)

我有一个用于连接到 MYSQLi 数据库的 PHP 类，我想在另一个类中使用这个类来创建准备好的语句并显示来自数据库的一些信息。

这可能吗？

```
<?php 

    class database {

        public $host = "localhost";
        public $user = "root";
        public $password = "root";
        public $name = "store";

        public function connect() {

            $connect = new mysqli($this->host, $this->user, $this->password, $this->name);

            if($connect->connect_errno > 0){
                die('Unable to connect to database [' . $connect->connect_error . ']');
            }

        }

    }

    class products {

    // In here I want to use a MYSQLi prepared statment to show some information
    // from the database details in the class above

    }

    $database = new database();
    $database->connect(); 

    ?> 
```

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T06:07:21.813

您必须在引导程序中连接某处，而不是连接到另一个类，将类实例放入变量中。然后，您将能够将此变量传递给构造函数参数或简单使用

```
global $db;
$this->db = $db; 
```

在构造函数中

顺便说一句，我认为单独的 connect() 方法没有用。为什么不在构造函数中直接连接？
另外让我建议您不要使用`die()`but `trigger_error()`（或例外）。

# tridion - 工作流程实施

> ID：14063685
> 
> 赞同：3
> 
> 时间：2012-12-28T02:03:38.727
> 
> 标签：tridion, tridion-2011

在哪里可以找到工作流实施的示例？实际上，我们无法将工作流定义附加到页面或组件。当我们打开页面并转到显示“审批状态：未定义”的“工作流程”选项卡时，我们为页面和组件创建了新的工作流程定义

我们最近从 Tridion 5.3 升级到 Tridion 2011 SP1，我们已经执行了升级手册“升级现有默认工作流程过程定义”中提到的步骤

根据我在工作流选项卡下的理解，我们应该能够选择页面或组件要遵循的工作流定义

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-28T02:53:18.030

对于页面，工作流程过程附加到结构组（您将能够在结构组的工作流程选项卡中选择流程定义）。当附加到 SG 时，您在该 SG 中创建或编辑的任何页面都将启动该项目的工作流程。请注意，结构组不继承此设置，因此您必须将流程附加到每个 SG。

对于组件，工作流程过程附加到架构（您将能够在架构的工作流程选项卡中选择流程定义）。当架构具有工作流时，使用该架构创建或编辑的任何组件都将被放入工作流中。

请注意，子出版物不会自动让组件和页面进入工作流程。例如，如果您的带有附加流程定义的模式处于 010 级别，而您的组件处于 020 级别，则您必须转到 020 级别的发布属性中的工作流选项卡并确保选中“启用共享模式和结构组中的工作流程过程关联”。

希望有帮助！

# python - 对函数中的返回感到困惑

> ID：14063687
> 
> 赞同：1
> 
> 时间：2012-12-28T02:03:41.980
> 
> 标签：python

好的，我的第一个程序有问题。如果你看下这两个函数，我想要的是如果“cur”值不在最小值和最大值之间，它将目标变量更改为“0”，这样我就可以在程序中使用它了。 .但它似乎没有这样做......我使用“return”错误吗？基本上，函数需要`target`从`1`变为`0`，以便`ri_fit`更改为 0，以便我的最后一个`if`事情触发......

对不起，糟糕的代码，我才刚刚开始！

```
#Clearance calculator
#clearances are in clearances.txt

targets = open("clearances.txt", "r")
lines = targets.readlines()   #get target clearances from file

in_min_target = float(lines[2])     #minimum intake clearance
in_max_target = float(lines[4])     #maximum intake clearance

ex_min_target = float(lines[8])    #miminum exhaust clearances
ex_max_target = float(lines[10])   #maximum exhaust clearances
targets.close

target_intake = (in_min_target + in_max_target) / 2     #find the ideal intake
target_exhaust = (ex_min_target + ex_max_target) / 2    #find the ideal exhaust

print "Intake Min: ", in_min_target
print "Intake Max: ", in_max_target
print "Exhaust Min: ", ex_min_target
print "Exhaust Max: ", ex_max_target
print """Target intake: %r
Target Exhaust: %r""" % (target_intake, target_exhaust)

print""
print "Enter current RIGHT side Intake clearance"
cur_r_in = float(raw_input(">"))
print ""
print "Enter current RIGHT side Exhaust clearance"
cur_r_ex = float(raw_input(">"))
print ""
print "Enter current LEFT side Intake clearance"
cur_l_in = float(raw_input(">"))
print ""
print "Enter current LEFT side Exhaust clearance"
cur_l_ex = float(raw_input(">"))

target = 1

def in_range(min, max, cur, valve, target):  #figures if intake valves are correct
    if min <= cur <= max:
        print "%r is in range." % valve
        target=1

    else:
        print "%r is OUT OF RANGE." %valve
        target=0

    return target

def ex_range(min, max, cur, valve, target):   #figures if exhaust valves are correct
    if min <= cur <= max:
        print "%r is in range." % valve
        target=1

    else:
        print "%r is OUT OF RANGE." %valve
        target=0
    return target

ri_fit = 1
re_fit = 1        #Assumes all valves are right, until further notice...
li_fit = 1
le_fit = 1

valve = "Right Intake"
print in_range(in_min_target, in_max_target, cur_r_in, valve, target)
print target
if target == 0:
    ri_fit = 0

print ""

valve = "Right Exhaust"
print ex_range(ex_min_target, ex_max_target, cur_r_ex, valve, target)

print ""

valve = "Left Intake"
print in_range(in_min_target, in_max_target, cur_l_in, valve, target)

print ""

valve = "Left Exhaust"
print ex_range(ex_min_target, ex_max_target, cur_l_ex, valve, target)

print ri_fit

if ri_fit==0:
    print "Right intake is out of range."
    print "Enter current right intake shim size."
    ri_cur_shim = int(raw_input(">"))

if re_fit==0:
    print "Right exhaust is out of range."
    print "Enter current right exhaust shim size."
    re_cur_shim = int(raw_input(">"))

if li_fit==0:
    print "Right intake is out of range."
    print "Enter current right intake shim size."
    li_cur_shim = int(raw_input(">"))

if le_fit==0:
    print "Right exhaust is out of range."
    print "Enter current right exhaust shim size."
    le_cur_shim = int(raw_input(">")) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T02:12:04.583

当您在其中一个函数中分配给目标时，您正在替换其中名为目标的参数的值，而不是触及全局参数的值。所以如果你想让你的函数分配给全局目标，你不能在函数中定义一个新的目标。

但是如果你不想改变你的函数，你可以使用 return 返回一个值的事实（你似乎理解，因为你打印它）。如果不是打印它，而是将其分配给目标，那么您将在所需的位置获得所需的值，并且无论计算出的值最终注定要去哪里，您的函数都将起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T02:09:08.033

`return`从函数返回一个值。您可以将结果存储在变量中。

在您的代码中，您尝试将`target`其作为参数传递，然后设置其值，但由于整数是不可变的，您将无法`target`在函数内进行更改。

在您的情况下，我会将您的代码更改为以下内容：

```
def ex_range(min, max, cur, valve):  # You don't need `target` here
    if min <= cur <= max:
        print "%r is in range." % valve
        target=1

    else:
        print "%r is OUT OF RANGE." %valve
        target=0
    return target

target = ex_range(...)  # Store the results in a variable 
```

更好的是，使用布尔值：

```
def ex_range(min, max, cur, valve):  # You don't need `target` here
    if min <= cur <= max:
        print "%r is in range." % valve
        return True

    else:
        print "%r is OUT OF RANGE." %valve
        return False 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-28T02:15:07.377

我认为问题在于您将`target`其作为值传递，而不是作为参考传递。在您的函数中，您应该删除`target`参数，而是编写：

```
def ex_range(min, max, cur, valve):
    global target
    # ...
    # rest of your code 
```

这样，解释器会识别出您正在尝试设置全局`target`变量，而不是本地实例。

否则，您可以执行以下操作：

```
def in_range(min, max, cur, valve):  #figures if intake valves are correct
    if min <= cur <= max:
        print "%r is in range." % valve
        return 1

    else:
        print "%r is OUT OF RANGE." %valve
        return 0

target = in_range(...) # fill in args
print target 
```

请参阅[此](https://stackoverflow.com/questions/423379/using-global-variables-in-a-function-other-than-the-one-that-created-them)相关问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-28T02:23:18.233

首先，我想你需要`()`after `close`：

```
target.close() 
```

第二： `in_range`和`ex_range`完全一样！

第三，无论如何都可以，因此可以正确运行：

```
in_range(1,10,7,'Right Intake',1)
in_range(1,10,17,'Right Intake',1) 
```

输出：

```
>>> 'Right Intake' is in range.
>>> 'Right Intake' is OUT OF RANGE. 
```

因此，可能是您传递给函数的参数**不**正确！检查您是否从文件中正确读取它们。

最后，避免使用`min`,`max`作为参数，因为它们是`built-in`Python 函数。

# javascript - 在使用 Android WebView 加载 html 之前注入 JavaScript

> ID：14063690
> 
> 赞同：6
> 
> 时间：2012-12-28T02:04:07.377
> 
> 标签：javascript, android, webview

我正在使用 Android WebView 加载一个简单的 HTML 页面。HTML 依赖于一小段 Javascript 代码。

我需要在加载 html 之前注入 Javascript。所以我这样做：

```
public class MainActivity extends Activity {

    WebView mWebView;
    Button mButton;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        mWebView = (WebView)findViewById(R.id.webview);
        mWebView.getSettings().setJavaScriptEnabled(true);
        mWebView.setWebChromeClient(new WebChromeClient(){
            @Override
            public boolean onJsAlert(WebView view, String url, String message,JsResult result) {
                return super.onJsAlert(view, url, message, result);
            }
        });

        mButton = (Button)findViewById(R.id.button);
        mButton.setOnClickListener(new myListener());
    }

    class myListener implements OnClickListener{

        int mCount = 1;

        @Override
        public void onClick(View arg0) {
            System.out.println("Load test page=>"+mCount+" times");
            mWebView.loadUrl("javascript:var output='This string is defined before html loaded.'");
            mWebView.loadUrl("file:///android_asset/test.html");
            mCount++;
        }
    }
} 
```

HTML 代码：

```
<html>

<head>
<script>
alert(output);
</script>
<head>

<body>
</body>

</html> 
```

**当我第一次单击按钮时，JS 和 HTML 工作正常。但是当我单击按钮再次执行加载时，它失败了。**

日志：

```
Load test page=>1 times
Load test page=>2 times
Uncaught ReferenceError: output is not defined at file:///android_asset/test.html:5
Load test page=>3 times
Uncaught ReferenceError: output is not defined at file:///android_asset/test.html:5 
```

有什么建议吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2014-03-14T21:28:16.633

这似乎是一种冗长的方法，但是您可以让您的 android 代码将 js 代码写入文件，然后在您的 html 文件中引用该文件吗？

# virtualenv - 如何在生产中始终保持 virtualenv 开启？

> ID：14063692
> 
> 赞同：0
> 
> 时间：2012-12-28T02:04:20.693
> 
> 标签：virtualenv, production-environment

我使用 virtualenv 在本地维护项目的环境。我也使用 virtualenvwrapper，所以我可以使用在环境之间切换

```
workon project1 
```

但是，在使用 virtualenv 时，您需要激活虚拟环境。我刚刚在 ec2 实例上安装了 virtualenv，但是如何确保环境保持活动状态？我现在最好的尝试就是将正确的 virtualenv 命令放在 .bashrc 中。但是，我完全确定这部分是如何工作的……如果服务器重新启动，.bashrc 会运行吗？

本质上，让 virtualenv 始终在生产服务器上的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T01:03:47.360

“激活 virtualenv”基本上意味着您正在更改`$PATH`环境变量。

如果您希望*始终*激活 virtualenv，请将您的 virtualenv`bin`路径添加到`$PATH`在命令运行之前执行的环境变量（`~/.bashrc`是一个选项）。

示例（使用`~/.bashrc`）：

```
export PATH=/path/to/myenv/bin:$PATH 
```

（假设`/path/to/myenv`是放置我的 virtualenv 的位置）

`~/.bashrc`仅在您启动新的 bash shell 时执行（即使在重新启动后）。如果您从不启动 bash shell，则`~/.bashrc`永远不会被执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-21T19:48:13.790

如果您希望您`virtualenv`的项目真正永久存在，您可以将以下两行直接填充到您的代码中：

```
activate_this = 'this_is_my_project/bin/activate_this.py'
execfile(activate_this, dict(__file__=activate_this)) 
```

# linux - 来自笔记本电脑的 ubuntu 服务器上的 Apache 子域

> ID：14063694
> 
> 赞同：0
> 
> 时间：2012-12-28T02:04:24.193
> 
> 标签：linux, apache, ubuntu, virtualhost

我在我的笔记本电脑上，我想为我的网络上的服务器创建子域。在我的笔记本电脑上，我修改了我的主机文件，以便我可以使用地址访问我的服务器`myserver`

如果我访问`myserver`，我会得到默认的 apache 服务器 html 页面说“它有效”。

在我的服务器上，默认的文档根目录是`/var/www/`

我想为用户创建一个子域，以便我可以在以下位置键入`user.myserver`和访问文件`/home/user/Websites/`

现在，我修改了服务器上的 httpd.conf 以添加：

```
<VirtualHost *>
        ServerName *
        DocumentRoot "/var/www/"
</VirtualHost>

<VirtualHost *>
        ServerName user.localhost
        DocumentRoot "/home/user/Websites/"
</VirtualHost> 
```

此外，我的服务器上的主机文件被修改为：

```
127.0.0.1 user.localhost 
```

如果我放在`user.myserver`笔记本电脑上，我的浏览器会说找不到服务器。

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T02:09:36.847

1.  您无需修改​​服务器上的 hosts 文件，它仅用于服务器解析，apache 只会监听`Host`它将收到的标头。
2.  您需要修改笔记本电脑上的主机文件以`user.myserver`指向服务器的 IP。

# wordpress - 当在body标签中给出样式时，如何更改wordpress中的字体？

> ID：14063696
> 
> 赞同：0
> 
> 时间：2012-12-28T02:04:40.707
> 
> 标签：wordpress

我想更改我的 wordpress 博客的字体系列。但是，修改 css 不起作用，因为生成的 HTML 如下所示：

```
<body style="font-family:'Helvetica', Helvetica, sans-serif" class=...> 
```

我认为这种风格具有最高优先级，那么如何覆盖它呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T02:08:47.203

您可以通过添加来覆盖它`!important`：

```
body {
  font-family: tahoma !important;
} 
```

但是，我会研究为什么您的 HTML 完全有内联样式 - 使用 !important 经常会让人头疼。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T02:14:16.097

您可能正试图覆盖 !important 属性。确保文件中是否有 !important 语句。您不能使用 !important 语句覆盖属性。

# wordpress - WordPress wp_schedule_event 未触发

> ID：14063698
> 
> 赞同：2
> 
> 时间：2012-12-28T02:04:51.980
> 
> 标签：wordpress

我正在尝试创建一个每五分钟查找一次触发器的调度程序。

当我初始化插件时，我得到了一个初始响应，但我没有像我试图完成的那样每五分钟触发一次。这是我的代码：

```
add_filter('cron_schedules', 'add_scheduled_interval');

function add_scheduled_interval($schedules) {
    $schedules['minutes_5'] = array('interval'=>300, 'display'=>'Once 5 minutes');
    return $schedules;
    global $schedules;
  }
if (!wp_next_scheduled('sms_cron')) {
    wp_schedule_event(time(), 'minutes_5', 'sms_cron');
    }

add_action('sms_cron', 'send_text_alerts');

function send_text_alerts() {
    //My function
    } 
```

我的问题是，我错过了什么？有什么明显的跳出来吗？提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-19T11:27:13.390

您需要将以下内容添加到操作中：

```
if (!wp_next_scheduled('sms_cron')) {
wp_schedule_event(time(), 'minutes_5', 'sms_cron');
} 
```

所以是这样的：

```
add_action( 'wp', 'setup_schedule' );
function setup_schedule() {
if (!wp_next_scheduled('sms_cron')) {
wp_schedule_event(time(), 'minutes_5', 'sms_cron');
}
} 
```

# android - 从 Android 使用 VDF Web 服务

> ID：14063700
> 
> 赞同：1
> 
> 时间：2012-12-28T02:04:57.960
> 
> 标签：android, web-services, dataflex

我正在尝试使用从 Android 应用程序中以 Visual Dataflex (VDF) 完成的 Web 服务。我阅读了很多教程，其中包含 Java 或 .Net Web 服务的示例，并且与我在 VDF 中的 Web 服务略有不同。

这是我在 Android 应用程序中的代码

```
import android.os.Bundle;
import android.app.Activity;
import android.view.Menu;

import android.widget.TextView;

import org.ksoap2.SoapEnvelope;
import org.ksoap2.serialization.SoapObject;
import org.ksoap2.serialization.SoapPrimitive;
import org.ksoap2.serialization.SoapSerializationEnvelope;
import org.ksoap2.transport.HttpTransportSE;

public class MainActivity extends Activity {

//Constantes para la invocacion del web service
    private static final String NAMESPACE = "http://tempuri.org/";
    private static final String URL = "http://192.168.1.12/Workspace_Casa/webServicePrueba.wso";
    private static final String METHOD_NAME = "dameMiNombre";
    private static final String SOAP_ACTION = "http://tempuri.org/dameMiNombre";

    TextView textView;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    textView =  (TextView)findViewById(R.id .tview);

    try {

           System.out.println("1\. Modelara :D");
           //Modelo el request
           SoapObject request = new SoapObject(NAMESPACE, METHOD_NAME);
           System.out.println("2\. Le dara cosas al sobre :D");
           //Modelo el Sobre
           SoapSerializationEnvelope sobre = new SoapSerializationEnvelope(SoapEnvelope.VER12);
           System.out.println("3\. Metera el request en el sobre");
           //sobre.dotNet = true;
           sobre.setOutputSoapObject(request);

           System.out.println("4\. Metera la URL en el transporte");
           //Modelo el transporte
           HttpTransportSE transporte = new HttpTransportSE(URL);

           System.out.println("5\. El transporte llamara al soap_action");
           //Llamada
           transporte.call(SOAP_ACTION, sobre);

           System.out.println("6\. Obtendra el resultado");
           //Resultado
           SoapPrimitive resultado = (SoapPrimitive) sobre.getResponse();

           System.out.println("7\. Imprimira el resultado");
           textView.setText("" + resultado.toString());

           } 
          catch (Exception e)
           {
              System.out.println("Entro al Error :(");
              e.printStackTrace();
           }

}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
} 
```

}

给我错误的行是 transporte.call(SOAP_ACTION, sobre); 错误是：org.xmlpull.v1.XmlPullParserException

我不知道发生了什么，也许我没有给 SOAP_ACTION 或 METHOD_NAME 提供正确的数据：/

这是 Web 服务的 WSDL...

```
<?xml version="1.0" encoding="UTF-8"?>
    <definitions xmlns="http://schemas.xmlsoap.org/wsdl/" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" xmlns:tns="http://tempuri.org/" name="webServicePrueba" targetNamespace="http://tempuri.org/">
      <types>
        <xs:schema elementFormDefault="qualified" targetNamespace="http://tempuri.org/">
          <xs:element name="dameMiNombre">
            <xs:complexType>
              <xs:sequence/>
            </xs:complexType>
          </xs:element>
          <xs:element name="dameMiNombreResponse">
            <xs:complexType>
              <xs:sequence>
                <xs:element name="dameMiNombreResult" type="xs:string"/>
              </xs:sequence>
            </xs:complexType>
          </xs:element>
        </xs:schema>
      </types>
      <message name="dameMiNombreSoapRequest">
        <part name="parameters" element="tns:dameMiNombre"/>
      </message>
      <message name="dameMiNombreSoapResponse">
        <part name="parameters" element="tns:dameMiNombreResponse"/>
      </message>
      <portType name="webServicePruebaSoapType">
        <operation name="dameMiNombre">
          <documentation>1 String</documentation>
          <input message="tns:dameMiNombreSoapRequest"/>
          <output message="tns:dameMiNombreSoapResponse"/>
        </operation>
      </portType>
      <binding name="webServicePruebaSoapBinding" type="tns:webServicePruebaSoapType">
        <soap:binding style="document" transport="http://schemas.xmlsoap.org/soap/http"/>
        <operation name="dameMiNombre">
          <soap:operation soapAction="" style="document"/>
          <input>
            <soap:body use="literal"/>
          </input>
          <output>
            <soap:body use="literal"/>
          </output>
        </operation>
      </binding>
      <service name="webServicePrueba">
        <documentation>Web Service Chevere</documentation>
        <port name="webServicePruebaSoap" binding="tns:webServicePruebaSoapBinding">
          <soap:address location="http://localhost/Workspace_Casa/webServicePrueba.wso"/>
        </port>
      </service>
    </definitions> 
```

有人知道它有什么问题吗？非常感谢

# iphone - keysSortedByValueUsingSelector 崩溃但 sortedArrayUsingSelector 运行良好

> ID：14063703
> 
> 赞同：3
> 
> 时间：2012-12-28T02:06:14.830
> 
> 标签：iphone, objective-c, ios, xcode, nsmutabledictionary

我自己找到了一种解决方法，但仍然试图理解这个问题。

我使用 uitableview 创建了一个自动完成文本字段，在编辑文本字段之前它是隐藏的。UI 部分工作正常。问题在于搜索结果部分。我声明了一个本地 NSMutableDictionary 来存储我的结果，因为我希望结果按键的值排序。

如果我直接在字典上调用 keysSortedByValueUsingSelector，它会崩溃。但是，如果我首先通过 [dict allKeys] 获取密钥，然后调用 sortedArrayUsingSelector，它可以正常工作：

```
// This commented out line will crash
//    NSArray *sortedKeysArray = [dict keysSortedByValueUsingSelector:@selector(compare:)];

    // The next two lines runs fine.
        NSArray *keyArray = [dict allKeys];
        NSArray *sortedKeysArray = [keyArray sortedArrayUsingSelector:@selector(compare:)]; 
```

以下是搜索方法的完整源代码：

```
- (void)searchAutocompleteEntriesWithSubstring:(NSString *)substring
{
    // Put anything that starts with this substring into the autocompleteUrls array
    // The items in this array is what will show up in the table view
    [autocomplete_symbol_array removeAllObjects];
    rRSIAppDelegate *appDelegate = (rRSIAppDelegate *)([[UIApplication sharedApplication]    delegate]);
    NSString *input_str = [substring uppercaseString];

NSMutableDictionary *dict = [[NSMutableDictionary alloc] init];
    int i = 0;
    for(SymbolInfo *symbol_info in appDelegate.m_symbol_info_array)
    {
        i++;
        NSString *info_str = [[[symbol_info.m_symbol uppercaseString] stringByAppendingString:@"|"] stringByAppendingString:[symbol_info.m_company_name uppercaseString]];
        NSUInteger pos = [info_str rangeOfString:input_str].location;
        if (pos != NSNotFound)
        {
            int tmp = pos * 10000 + i;
            NSNumber *map_key = [[NSNumber alloc] initWithInt:tmp];
            [dict setObject:symbol_info forKey:map_key];
        }
    }

// This commented out line will crash
//    NSArray *sortedKeysArray = [dict keysSortedByValueUsingSelector:@selector(compare:)];

// The next two lines runs fine.
    NSArray *keyArray = [dict allKeys];
    NSArray *sortedKeysArray = [keyArray sortedArrayUsingSelector:@selector(compare:)];

    for (NSNumber *key in sortedKeysArray)
    {
        SymbolInfo *symbol_info = [dict objectForKey:key];
        [autocomplete_symbol_array addObject:symbol_info];
    }

//    NSLog(@"everything added: %d", [autocomplete_symbol_array count]);
    [autocompleteTableView reloadData];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T02:34:29.930

NSMutableDictionary 的方法是：

```
- (void)setObject:(id)anObject forKey:(id < NSCopying >)aKey; 
```

这意味着密钥应该实现[NSCopying 协议](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Protocols/NSCopying_Protocol/Reference/Reference.html)。

# c# - MVC 4 中的自定义 MembershipProvider

> ID：14063705
> 
> 赞同：5
> 
> 时间：2012-12-28T02:06:26.580
> 
> 标签：c#, asp.net, asp.net-mvc, asp.net-mvc-4

我开始学习MVC4。作为第一步，我需要执行登录，因为自定义数据库在数据库中只有三个角色。

是否真的有必要实现自定义会员提供程序？我对此提出疑问，因为我正在阅读这篇文章，而他正在做另一种方式： http: [//patrickdesjardins.com/blog/asp-net-membership-with-mvc4](http://patrickdesjardins.com/blog/asp-net-membership-with-mvc4)

我只需要从自定义数据库中获取用户并确定角色。

确定规则，是一个相当简单的。我有两张表，名为 Student 和 Teachers。每个都有自己的 ID，登录 ID 和公共属性密码也是如此。

```
if (db.Students.Where(x => x.StudentId == x && x.Password == y) return "student"
if (db.Teachers.Where(x => x.TeacherId == x && x.Password == y) return "teacher"

// does not exist 
```

你能告诉我如何在 ASP.NET 中实现这些功能吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-28T03:29:20.557

> **注意：以下可能不适用于 .NET Core 或 ASP.NET Core**

在开始研究之前，请注意 ASP.NET MVC4 中的成员资格和角色管理已更改。（如果您使用 Visual Studio 中的“Internet 应用程序”模板）

请阅读 Jon Galloway 的[博客文章](http://weblogs.asp.net/jgalloway/archive/2012/08/29/simplemembership-membership-providers-universal-providers-and-the-new-asp-net-4-5-web-forms-and-asp-net-mvc-4-templates.aspx)，了解发生了什么变化。

New`Simple Membership Provider`旨在扩展和克服旧成员和角色管理系统中的问题（仍然支持，因为它是 ASP.NET 的一部分）

两种实现都支持角色管理，您可以自由选择任何一种实现，也可以自己动手。有关于哪个更好的争论，一些开发人员更喜欢自己实现，因为两者都有局限性。（我不会详细说明，因为它可能会产生偏见）

这是一个帮助您入门的教程。[[链接](http://www.asp.net/mvc/tutorials/mvc-music-store/mvc-music-store-part-7)]..**请注意，教程解释的是旧的会员系统，而不是新的 SimpleMembership/WebSecurity 方法。**

**更新**

就在您认为自己拥有足够的身份验证框架时，Microsoft 宣布[**了 OWIN** - *Open Web Interface for .NET*](http://owin.org/)。

OWIN 是一组用于 .NET 的开放式和可插拔接口，其中包括身份验证。有关如何使用 MVC 5 OWIN 表单身份验证的信息，请参阅这篇文章 [[链接]。](http://blogs.msdn.com/b/webdev/archive/2013/07/03/understanding-owin-forms-authentication-in-mvc-5.aspx)

# jquery - 如何关闭 JQuery 对话框？

> ID：14063706
> 
> 赞同：1
> 
> 时间：2012-12-28T02:06:39.963
> 
> 标签：jquery, jquery-ui

我有以下加载 displayRecords.php 的对话框。我在对话框上有关闭按钮，但我正在努力让它工作。

```
$(document).ready(function() { 

     var dlg=$('#ticketDetails').dialog({
        title: 'Ticket Details',
        resizable: false,
        autoOpen:false,
        modal: true,
        hide: 'fade',
        buttons:{ "Close": function() { $(this).dialog("close"); } },
        close: function(e, i) { $(this).hide(); },
        width: 1300

     });

    $('a.view').click(

    function(e) 
    {    

         dlg.load('displayRecord.php?id='+this.id, function(){ 
         dlg.dialog('open');

     });

    });

}); 
```

我对 JQuery 比较陌生。有人可以指出上面看起来有什么问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T02:55:09.527

```
var dlg = '';
$(document).ready(function() { 

     dlg=$('#ticketDetails').dialog({
        title: 'Ticket Details',
        resizable: false,
        autoOpen:false,
        modal: true,
        hide: 'fade',
        buttons:{ "Close": function() { $(this).dialog("close"); } },
        close: function(e, i) { $(this).hide(); },
        width: 1300   
     });

    $('a.view').click(

    function(e) 
    {    

         dlg.load('displayRecord.php?id='+this.id, function(){ 
         dlg.dialog('open');

     });

    });

 $('a.closeDialog').click(function(){dlg.dialog('close');});
}); 
```

一些小的调整，这可能在概念上起作用。我给出的想法是`dlg`在函数外部声明为某种全局变量，剩余的函数可以重用

# python - python：为什么不能腌制文件对象？

> ID：14063712
> 
> 赞同：0
> 
> 时间：2012-12-28T02:07:23.740
> 
> 标签：python, django

我试图理解为什么在将 django`InMemoryUploadedFile`对象作为 celery 任务的参数发送时不能腌制它，`Can't pickle <type 'cStringIO.StringO'>: attribute lookup cStringIO.StringO failed`. 因此，我尝试了该`File`对象，但效果不佳，但是`StringIO`可以。

需要一些傻瓜的指导来理解 3 之间的区别。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-28T02:13:36.640

Python 也不允许对某些函数进行酸洗，因为如果允许的话，存在安全问题。（这取决于 - 有一些方法可以通过引用来腌制一些功能）

在 python 的特性线程中多次请求提取文件对象，最好的推理是因为它通过允许运行时注入潜在的恶意事件，为 python 的安全进程打开了额外的黑客向量。

以多种方式拥有它会非常方便，但它似乎是一种安全限制。

# java - 如何使用外部 CSS 文件正确设置 HTML 样式？

> ID：14063715
> 
> 赞同：-7
> 
> 时间：2012-12-28T02:08:05.650
> 
> 标签：java, html, css, swing, jeditorpane

我希望能够从 Internet 加载 HTML 文档，在 JEditorPane 中显示它，并使用外部 CSS 文件和/或任何`<style>...</style>`标签在 Java 中对其进行样式设置。我现在正在做的是使用`jEditorPane.setPage(URL);`并且样式不正确。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T03:02:53.857

基于 JavaDoc - jEditorPane 支持最*前沿的* [HTML 3.2](http://docs.oracle.com/javase/7/docs/api/javax/swing/JEditorPane.html)和[CSS1](http://www.w3.org/TR/REC-CSS1/)，所以简短的回答是，您真的不想尝试用它渲染现代网页。

但是，您可以这样做：

```
import javax.swing.text.html.HTMLEditorKit;
import javax.swing.text.html.StyleSheet;

HTMLEditorKit kit = new HTMLEditorKit();
jEditorPane.setEditorKit(kit);

URL url = new URL(location of your stylesheet);
StyleSheet styleSheet = new StyleSheet();
styleSheet.importStyleSheet(url)
kit.setStyleSheet(styleSheet); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T03:01:58.560

我不认为您可以使用`JEditorPane`. 从[文档](http://docs.oracle.com/javase/7/docs/api/javax/swing/JEditorPane.html)：

> 默认情况下，以下类型的内容是已知的：
> 
> ...
> 
> **文本/html**
> 
> > HTML 文本。本例中使用的工具包是`javax.swing.text.html.HTMLEditorKit`提供 HTML 3.2 支持的类。

[上个世纪定义的HTML 3.2](http://www.w3.org/TR/REC-html32)，即没有 CSS/CSS2。

正如我们现在所知，您可以使用外部库来呈现 HTML。一点点谷歌工作会出现几个选项，或者你可以看看[这里](https://stackoverflow.com/questions/2315726/how-to-embed-ie-in-swing-application)。

# c++ - GCC 4.7.2 中的 std::unique_ptr 损坏

> ID：14063717
> 
> 赞同：1
> 
> 时间：2012-12-28T02:08:34.240
> 
> 标签：c++, c++11, unique-ptr

我正在尝试使用`std::unique_ptr`以将整数句柄存储到一些不透明的对象。为此，我定义了一个自定义删除器类型，`typedef int pointer`以便将原始指针类型覆盖为`int`而不是`int*`. 此过程在本网站的最后一节中进行了描述：http: [//asawicki.info/news_1494_unique_ptr_in_visual_c_2010.html](http://asawicki.info/news_1494_unique_ptr_in_visual_c_2010.html)

这是一些示例代码，可以更好地说明我正在尝试做的事情：

```
#include <memory>
#include <iostream>

static void close(int p)
{
    std::cout << p << " has been deleted!" << std::endl;
}

struct handle_deleter
{
    typedef int pointer;
    void operator()(pointer p) { close(p); }
};

typedef std::unique_ptr< int, handle_deleter> unique_handle;

int main(int argc, char *argv[])
{
    unique_handle handle(1);

    return 0;
} 
```

当我使用 GCC 4.7.2 编译此代码时，我收到以下错误：

```
In file included from /usr/lib/gcc/x86_64-redhat-linux/4.7.2/../../../../include/c++/4.7.2/memory:86:0,
                 from unique_ptr_test.cpp:1:
/usr/lib/gcc/x86_64-redhat-linux/4.7.2/../../../../include/c++/4.7.2/bits/unique_ptr.h: In instantiation of ‘std::unique_ptr<_Tp, _Dp>::~unique_ptr() [with _Tp = int; _Dp = handle_deleter]’:
unique_ptr_test.cpp:19:23:   required from here
/usr/lib/gcc/x86_64-redhat-linux/4.7.2/../../../../include/c++/4.7.2/bits/unique_ptr.h:172:2: error: invalid operands of types ‘int’ and ‘std::nullptr_t’ to binary ‘operator!=’ 
```

该`~unique_ptr`过程的代码如下：

```
// Destructor.
~unique_ptr() noexcept
{
    auto& __ptr = std::get<0>(_M_t);
    if (__ptr != nullptr)
      get_deleter()(__ptr);
    __ptr = pointer();
} 
```

据我说，对 nullptr 的检查没有意义，因为原始指针类型是`int`（而不是`int*`由于在 中覆盖它`HandleDeleter`）。奇怪的是，这段代码在 GCC 4.6.1 下编译没有错误。执行后，示例显示“1 已被删除！” 正如预期的那样。

我想知道是否有任何我忽略的细节，或者它是否真的是 GCC 的 unique_ptr 的 STL 实现中的错误。

谢谢，

PMJ

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-28T10:05:22.723

正如我在评论中所说，如果您传递的删除器类型具有嵌套的`pointer`typedef，它必须满足*NullablePointer* 要求：

`20.7.1.2 [unique.ptr.single] p3`

> 如果类型`remove_reference<D>::type::pointer`存在，`unique_ptr<T, D>::pointer`则应是 的同义词`remove_reference<D>::type::pointer`。否则`unique_ptr<T, D>::pointer`应为 的同义词`T*`。**型式`unique_ptr<T, D>::pointer`应满足`NullablePointer`(17.6.3.3)**的要求。

然后`§17.6.3.3`列出类型必须满足的所有要求才能成为 NullablePointer。表中列出了某些语义，其中：

> `u`表示标识符，`t`表示类型的非常量左值`P`，表示类型的值（可能）`a`，表示类型的值（可能）。`b``const``P``np``const``std::nullptr_t`

```
Expression    Return type                         Operational semantics
P u(np);                                          post: u == nullptr
P u = np;
P(np)                                             post: P(np) == nullptr
t = np        P&                                  post: t == nullptr
a != b        contextually convertible to bool    !(a == b)
a == np       contextually convertible to bool    a == P()
np == a
a != np       contextually convertible to bool    !(a == np)
np != a 
```

现在，最简单的解决方案是将您包装`int`在提供这些语义的类型中：

```
#include <cstddef> // std::nullptr_t

struct handle{
  handle() : value(0){}
  handle(std::nullptr_t) : value(0){}
  /*explicit*/ handle(int v) : value(v){} // make it explicit if you need it
  // special members can be generated

  handle& operator=(std::nullptr_t){ value = 0; return *this; }

  // contextual conversion to bool
  explicit operator bool() const{ return value != 0; }

  int value;
};

bool operator==(handle lhs, handle rhs){ return lhs.value == rhs.value; }
bool operator!=(handle lhs, handle rhs){ return lhs.value != rhs.value; }
// comparision against 'nullptr' is handled by the above operators
// since 'nullptr' can be implicitly converted to 'handle' 
```

# list - Umbraco XSLT 按最新版本列出编号值

> ID：14063720
> 
> 赞同：1
> 
> 时间：2012-12-28T02:08:49.997
> 
> 标签：list, xslt, media, umbraco

我正在创建一个下载宏，并通过选择它们上传到的媒体文件夹来列出媒体部分中的项目。

我创建了一个媒体类型 Asset，它具有潜在的子节点 Asset Version。

我可以创建任意数量的资产版本，但我只想在我的下载宏中显示最新的资产版本。我为我的资产版本添加了一个标签 versionNumber，它添加了在同一资产中创建的数字值。

例如

*   资产
    *   资产版本 - versionNumber = 1
    *   资产版本 - versionNumber = 2
    *   资产版本 - versionNumber = 3

目前，这仅列出了 versionNumber = 1 的资产版本：

```
<xsl:for-each select="$files/Asset/AssetVersion[@nodeTypeAlias = 'AssetVersion' and versionNumber= '1']">
  <xsl:sort select="./versionNumber" data-type="number" order="descending"/>
  <xsl:call-template name="Documents" />
</xsl:for-each> 
```

我只想在我的列表中显示最新的资产版本，并且只显示那个版本。

我的下载宏可以列出多个资产，但应该只为每个显示一个 AssetVersion。

例如下载宏

*   资产 1
    *   资产 1 - 资产版本 - versionNumber = 3
*   资产 2
    *   资产 2 - 资产版本 - versionNumber = 1
*   资产 3
    *   资产 3 - 资产版本 - versionNumber = 6

有人可以帮忙吗？

干杯合资企业

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T04:12:32.083

**使用**：

```
<xsl:for-each select="$files/Asset">
  <!-- output here the Asset number /id -->
  <xsl:for-each select="AssetVersion[@nodeTypeAlias = 'AssetVersion']">
    <xsl:sort select="versionNumber" data-type="number" order="descending"/>

    <xsl:if test="position()=1">
      <xsl:call-template name="Documents" />
    </xsl:if> 
  </xsl:for-each>
</xsl:for-each> 
```

# scripting - 自动化 loadui

> ID：14063723
> 
> 赞同：0
> 
> 时间：2012-12-28T02:09:24.087
> 
> 标签：scripting, automated-tests, loadui

我正在使用 Windows 操作系统。我通过 loadui 网站了解了自动化过程。由于我对这个软件很陌生，我什至不明白如何运行某些命令。例如，有这样的命令“loadUI-Agent-1_5_0.exe -c”需要在命令行中运行。

我尝试将其粘贴到命令提示符中，但无法识别。有人知道该怎么做吗？如果你们能给我提供从零开始学习的链接，我可以一步一步地使用 loadui 自动化负载测试。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T10:40:00.887

您必须使用`loadui-cmd.bat`，它可以在 LoadUI 安装目录中找到。

您还应该使用最新版本的 LoadUI，即 2.1.1。

来源：LoadUI 文档中的[自动化入门。](http://loadui.org/Load-Test-Automation/load-test-automation-getting-started.html)

# php - 附加数组并打印 php

> ID：14063732
> 
> 赞同：1
> 
> 时间：2012-12-28T02:11:08.853
> 
> 标签：php, arrays, string, printing, append

此代码将不起作用任何人都可以创建解决方案吗？

```
<?php
  //Assigns 10 to test1\. 20 to test2\. 30 to test3.
  $array1 = array(10 => "test1", 20 => "test2", 30 => "test3");  
  //Creates a blank array.
  $blank = new ArrayObject(array()); 

  $blank->append(array("20")); //Adds the value 20, to the blank array.
  $blank->append(array("30")); //Adds the value 30, to the blank array.

  print($array1[$blank[0]]); // should print "test2"
  print($array1[$blank[1]]); // should print "test3"
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T02:13:22.340

您是否在寻找：

```
<?php
  //Assigns 10 to test1\. 20 to test2\. 30 to test3.
  $array1 = array(10 => "test1", 20 => "test2", 30 => "test3");  
  //Creates a blank array.
  $blank = new ArrayObject();

  $blank->append(array("20")); //Adds the value 20, to the blank array.
  $blank->append(array("30")); //Adds the value 30, to the blank array.

  print($array1[$blank[0][0]]); // should print "test2"
  print($array1[$blank[1][0]]); // should print "test3"
?> 
```

在这里，`$blank`将是多维的。

见[http://ideone.com/XsgnSz](http://ideone.com/XsgnSz)

或者更有可能：

```
<?php
  //Assigns 10 to test1\. 20 to test2\. 30 to test3.
  $array1 = array(10 => "test1", 20 => "test2", 30 => "test3");  
  //Creates a blank array.
  $blank = new ArrayObject();

  $blank->append("20"); //Adds the value 20, to the blank array.
  $blank->append("30"); //Adds the value 30, to the blank array.

  print($array1[$blank[0]]); // should print "test2"
  print($array1[$blank[1]]); // should print "test3"
?> 
```

见[http://ideone.com/eyXL6v](http://ideone.com/eyXL6v)

# lotusscript - 使用 Lotus 脚本从其他代理重用函数

> ID：14063733
> 
> 赞同：0
> 
> 时间：2012-12-28T02:11:18.293
> 
> 标签：lotusscript

我们可以通过使用 lotusscript 重用同一数据库中另一个代理的函数吗？

例如，我在“运行报告”代理中有函数 getManager，我想在同一数据库中的“发送电子邮件”代理中使用 getManager。

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-28T06:15:33.447

将函数移动到[脚本库](http://www-12.lotus.com/ldd/doc/domino_notes/rnext/help6_designer.nsf/f4b82fbb75e942a6852566ac0037f284/cbc2ce08be9a486c85256c54004ba66b?OpenDocument)。然后在两个代理中放置一个[Use Statement](http://www-12.lotus.com/ldd/doc/domino_notes/rnext/help6_designer.nsf/f4b82fbb75e942a6852566ac0037f284/fd30ce5a9e41a5f385256c54004ba682?OpenDocument)以引用该库。两个代理都可以使用相同的功能。

# php - Mod重写基本URL

> ID：14063734
> 
> 赞同：0
> 
> 时间：2012-12-28T02:11:33.227
> 
> 标签：php, .htaccess, routing

我有几个域，我想全部重写到一个域。我不希望它重定向，因为我希望 URL 看起来像用户输入的内容。例如，如果他们输入 www.example.com，我希望它从 www.sample.com/default.php 加载页面?from=example

如果您有 www.site.com/var1/var2 使其加载 www.site.com/index.php?one=var1&two=var2，我已经进行了一些重写

是否可以通过 .htaccess 文件来做我正在寻找的事情？我试着环顾四周，却找不到我要找的东西

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T02:42:33.347

如果站点托管在不同的服务器上或不共享公共文档根目录，那么您将不得不依赖 mod_proxy 并且可以使用`P`重写规则标志。例如，在`www.example.com`的文档根目录中的 htaccess 文件中的这些规则：

```
RewriteCond %{HTTP_HOST} ([^.]+)\.com$ [NC]
RewriteRule ^/?$ http://www.sample.com/default.php?from=%1 [L,P] 
```

将接受请求`http://www.example.com/`并无形地将其代理到`http://www.sample.com/default.php?from=example`. 浏览器的 URL 地址栏将保持不变`http://www.example.com/`。

请注意，该规则仅与请求 URI 匹配`/`。如果你想做更多，你必须创建正确的正则表达式和分组。

如果您在 sample.com 站点上有重定向，则需要使用[`ProxyPassReverse`](http://httpd.apache.org/docs/2.2/mod/mod_proxy.html#proxypassreverse)重写重定向。另请查看`ProxyPassReverseCookieDomain`是否`ProxyPassReverseCookiePath`涉及 cookie。

如果您可以在 vhost 或服务器配置中执行此操作，那么请考虑简单地使用`ProxyPass`而不是 mod_rewrite。该`ProxyPass`指令在 htaccess 文件中不起作用。

* * *

编辑：

看到所有内容都在同一个文档根目录中，您不需要代理任何内容。简单地：

```
RewriteCond %{HTTP_HOST} !^www\.sample\.com$ [NC]
RewriteCond %{HTTP_HOST} ([^.]+)\.com$ [NC]
RewriteRule ^/?$ /default.php?from=%1 [L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T02:33:24.347

我使用在线生成器。使用这个生成器：[mod-rewrite](http://www.generateit.net/mod-rewrite/)

# php - 使用 php 将字符串日期时间转换为时间戳

> ID：14063735
> 
> 赞同：1
> 
> 时间：2012-12-28T02:11:37.813
> 
> 标签：php, mysql

我在将字符串日期时间转换为 php 中的时间戳时遇到问题。

```
$time = strtotime('2012-12-28 01:02:43');

echo $time; //it returns 1356627763 
```

当我将该整数值转换回日期时间时，它不正确（28/12/2012 00:02:43）。基本上，已经晚了1个小时。

```
my_format_datetime(strtotime('2012-12-28 01:02:43')); 
```

下面是我的 my_format_datetime 函数：

```
> function my_format_datetime($unix)
>         {
>             if ($unix == '' || !is_numeric($unix))
>             {
>                     $unix = strtotime($unix);
>             }
>             else
>             {
>                 $timezone = 3600*(DEFAULT_GMT + date("0"));
>                 $unix = gmdate("d/m/Y H:i:s", $unix + $timezone);
>             }
>             
>             return $unix;
>         } 
```

但是当我使用 time() 函数进行转换时，它是正确的。

请帮我。非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T02:37:49.487

设置您当地的时区。您可以使用`date_default_timezone_set()`.http://php.net/manual/en/function.date-default-timezone-set.php在 php 脚本中执行此操作

或者您可以`php.ini`通过更改`date.timezone`默认为 UTC 的值在配置中执行此操作。

# javascript - 在谷歌地图上画线

> ID：14063743
> 
> 赞同：1
> 
> 时间：2012-12-28T02:12:40.837
> 
> 标签：javascript, google-maps-api-3

我尝试在谷歌地图中画一条线，我尝试了这段代码，但没有任何反应，只有标记没有这条线，我已经阅读了一些参考资料，如[https://developers.google.com/maps/documentation/javascript/v2/ overlays#Icons_overview](https://developers.google.com/maps/documentation/javascript/v2/overlays#Icons_overview) 并尝试代码，但行仍然没有出来，任何人都可以帮助我吗？下面是我的代码，假设地址是数组

```
for (var i = 0; i < address.length; i++) {
    geocoder.geocode({ 'address': address[i] }, function (results, status) {
        if (status == google.maps.GeocoderStatus.OK) {

            if (i == 2) {
                var pos1 = results[0].geometry.location;
                alert(pos1);
            }

            else if (i == 2) {
                var pos2 = results[0].geometry.location;
                alert(pos2);
            }

            map.setCenter(results[0].geometry.location);
            var marker = new google.maps.Marker
            (
                {
                    position: results[0].geometry.location,
                    map: map,
                    title: 'click me'
                }
            );
            var infowindow = new google.maps.InfoWindow
            (
                {
                    content: '<img src="http://wallpaperscraft.com/image/child_girl_emotion_sweet_face_25641_100x100.jpg"> Welcome to origineit'
                }
            );
            var flightPlanCoordinates = [
                new google.maps.LatLng(pos1),
                new google.maps.LatLng(pos2)
              ];

            if (i == 2) {

                var polyline = new google.maps.Polyline
                ({
                    path: flightPlanCoordinates,
                    strokeColor: '#FF0000',
                    strokeOpacity: 0.8,
                    strokeWeight: 3
                });
                polyline.setMap(map);
            }

            google.maps.event.addListener(marker, 'click', function () {
                // Calling the open method of the infoWindow 
                infowindow.open(map, marker);
            });
        }
        else {
            alert('Geocode was not successful for the following reason: ' + status);
        }
    });
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-28T02:25:24.370

这里的问题是，除了来自 V2 的折线之外，您对所有内容都使用 Google Maps V3（您应该这样做）。您应该阅读[Google Maps V3 的 API 文档](https://developers.google.com/maps/documentation/javascript/reference#Polygon)。

对于 Google Maps V3，它应该如下所示：

**编辑**

在测试您的代码时（而不仅仅是从头顶写一个答案），我还注意到您遇到了一些范围界定问题（您未能解决检查`if(i == 2)`更新代码的问题，我建议您阅读[这篇文章](http://robertnyman.com/2008/10/09/explaining-javascript-scope-and-closures/)了解有关该问题的更多信息），因此我也对其进行了更改。下面的代码经过测试可以工作（[http://jsfiddle.net/YMyc9/](http://jsfiddle.net/YMyc9/)），但确实应该对其进行一些重构以使其更易于理解。

```
var pos1 = null; // These need to be declared outside of the geocode-callback
var pos2 = null; // so we also remove 'var' from the assignment inside of that function
for (var i = 0; i < address.length; i++) {
    geocoder.geocode({'address': address[i]}, function(results, status) {
        if (status == google.maps.GeocoderStatus.OK) {

            // We can't use 'i' here since this happens in a callback and the loop will already
            // have progressed and 'i' is (with my two test addresses) always 2 here.
            if (pos1 == null) {
                pos1 = results[0].geometry.location;
            }
            else if (pos2 == null) {
                pos2 = results[0].geometry.location;
            }
            else {
                /* We already got two so maybe quit? */
                return;
            }

            map.setCenter(results[0].geometry.location);
            var marker = new google.maps.Marker({
                position: results[0].geometry.location,
                map: map,
                title: 'click me'
            });
            var infowindow = new google.maps.InfoWindow({
                content: '<img src="http://wallpaperscraft.com/image/child_girl_emotion_sweet_face_25641_100x100.jpg"> Welcome to origineit'
            });

            /* NEW CODE HERE */
            if (pos2 != null) {
                var polyline = new google.maps.Polygon({
                    paths: [pos1, pos2],
                    strokeColor: '#FF0000',
                    strokeOpacity: 0.8,
                    strokeWeight: 3,
                    fillColor: '#FF0000',
                    fillOpacity: 0.35
                });

                polyline.setMap(map);
            } /* BACK TO THE OLD CODE HERE */

            google.maps.event.addListener(marker, 'click', function() {
                // Calling the open method of the infoWindow 
                infowindow.open(map, marker);
            });
        }
        else {
            alert('Geocode was not successful for the following reason: ' + status);
        }
    });
} 
```

# wcf - 在 BizTalk 2010 中公开 wcf 服务

> ID：14063746
> 
> 赞同：2
> 
> 时间：2012-12-28T02:13:01.663
> 
> 标签：wcf, biztalk, biztalk-2010

过去几周我遇到了这个问题，但我仍然不知道为什么。

我有一个 BizTalk 业务流程，它接收 BizTalk 消息，对其进行处理并最终将其写入文件。为简单起见，假设我们的目标是获取消息（实际上是一项调查）并将其按原样保存到文件夹中。我创建了一个公共接收端口来捕获味精和一个发送端口来将结果写入磁盘。

我已成功部署该项目并已成功将其发布到 IIS。我能够在 IIS 中看到 WCF 服务并将其设置为使用 Framework 4.0。我已经设置了所有相关的接收和发送端口，并从 BizTalk 管理控制台成功启动了应用程序。（接收位置是我发布 wcf 服务时自动创建的，发送位置是位于计算机文件夹中的 FILE 类型）

从 IIS 中的 DefaultSite，我可以看到我的 WCF。但是，当我尝试时，`http://localhost/TestSurvey/TestSurvey_Orchestration_1_getSurveyPort.svc,` 出现以下错误：

```
Server Error in '/TestSurvey' Application.
--------------------------------------------------------------------------------

Login failed for user 'Domain\ComputerName$'. 
Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. 

Exception Details: System.Data.SqlClient.SqlException: Login failed for user 'ACAD1\DENBIZDEV$'.

Source Error: 

An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.  

Stack Trace: 

[SqlException (0x80131904): Login failed for user 'Domain\ComputeName$'.]

[TargetInvocationException: Exception has been thrown by the target of an invocation.]
   Microsoft.BizTalk.TransportProxy.Interop.IBTTransportProxy.RegisterIsolatedReceiver(String url, IBTTransportConfig callback) +0
   Microsoft.BizTalk.Adapter.Wcf.Runtime.WcfIsolatedReceiver`2.RegisterIsolatedReceiver(Uri uri) +1028
   Microsoft.BizTalk.Adapter.Wcf.Runtime.WebServiceHostFactory`3.CreateServiceHost(String constructorString, Uri[] baseAddresses) +363
   System.ServiceModel.HostingManager.CreateService(String normalizedVirtualPath) +1413
   System.ServiceModel.HostingManager.ActivateService(String normalizedVirtualPath) +50
   System.ServiceModel.HostingManager.EnsureServiceAvailable(String normalizedVirtualPath) +1172

[ServiceActivationException: The service '/TestSurvey/TestSurvey_Orchestration_1_getSurveyPort.svc' cannot be activated due to an exception during compilation.  The exception message is: Exception has been thrown by the target of an invocation..]
   System.Runtime.AsyncResult.End(IAsyncResult result) +901424
   System.ServiceModel.Activation.HostedHttpRequestAsyncResult.End(IAsyncResult result) +178638
   System.Web.AsyncEventExecutionStep.OnAsyncEventCompletion(IAsyncResult ar) +107

--------------------------------------------------------------------------------
Version Information: Microsoft .NET Framework Version:4.0.30319; ASP.NET Version:4.0.30319.272 
```

我的问题是：BizTalk 试图登录的是什么？Domain\ComputerName$ 绝对不是用户。我没有尝试从编排访问任何数据库。我相信我的 IIS 设置正确，因为我从 VS2010 创建了一个快速而肮脏的 wcf 服务测试并将其发布到我的 IIS，然后成功创建了一个简单的客户端来使用 wcf 服务测试。直接创建wcf服务测试时没有遇到同样的问题。

非常感谢任何帮助或提示！

**编辑**

我设法解决了这个问题：它不是由 BizTalk 创建的 Web 配置。我必须创建一个特殊的应用程序池并将我的应用程序绑定到使用它。在应用程序池中，我必须使用 BizTalk 正在使用的自定义凭据。使用内置凭据导致了我遇到的问题。我的菜鸟错误！使用 BizTalk 登录凭据后，一切顺利。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-28T08:32:27.823

引发 SQL 异常的数据库是 BizTalk 数据库之一，可能是管理数据库或 SSO DB。

该错误几乎可以肯定是由 IIS 的设置引起的，无论是应用程序池标识还是网站安全设置。

正在发生的事情是，当您第一次调用该服务时，IIS 正在编译您的服务，为此它显然需要访问其中一个 BizTalk 数据库，但由于某种原因，此调用未经过身份验证。

这可能是因为应用程序池用户必须是*BizTalk 独立主机用户*组的成员（根据 BizTalk 的设置方式，该组的名称可能有所不同。

# apache-flex - 为什么需要在其处理程序中删除创建完整侦听器？

> ID：14063748
> 
> 赞同：1
> 
> 时间：2012-12-28T02:13:17.237
> 
> 标签：apache-flex

我从这个开源项目[Loading Spinner中找到了以下代码片段](https://www.adobe.com/cfusion/exchange/index.cfm?event=extensionDetail&extid=1219018)

```
public function Spinner() {
    super();
    addEventListener(FlexEvent.CREATION_COMPLETE, handleCreationComplete);
}

private function handleCreationComplete(e:FlexEvent):void {
    removeEventListener(FlexEvent.CREATION_COMPLETE, handleCreationComplete);
    if (autoPlay) {
        play();
    }
} 
```

为什么需要 removeEventListener 行？这是否意味着一个 creationComplete 事件将被触发超过 1 次？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T02:39:36.840

删除侦听器的唯一原因是：
只要事件侦听器附加到类的实例，该侦听器永远不会被“垃圾收集”，直到它从调度程序中删除，或者直到调度程序也有资格垃圾收集。即，只要应用程序运行，它就会一直存在于内存中，即使您将其从舞台上移除并且您明确将其设置为`null`.
这就是为什么在不再需要事件侦听器时始终清理它们是一种很好的做法。您可以避免内存泄漏。

# c# - while(true) / while(1) 与 for(;;)

> ID：14063753
> 
> 赞同：6
> 
> 时间：2012-12-28T02:13:36.813
> 
> 标签：c#, c++, c, loops, infinite-loop

> **可能重复：**
> [for ( ; ; ) 或 while ( true ) - 哪个是正确的 C# 无限循环？](https://stackoverflow.com/questions/1401159/for-or-while-true-which-is-the-correct-c-sharp-infinite-loop)
> [为什么选择 for (;;){} 而不是 while(1)？](https://stackoverflow.com/questions/13545237/why-choosing-for-over-while1)

`while(true)`,`while(1)`和 和有什么区别`for(;;)`？它们都是 C# 和 C/C++ 等语言中的无限循环。但是一个比另一个更好吗？有任何想法吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-28T02:16:46.533

程序编译后就没有区别了。

以下是三个 C 程序的一些摘录以及所有这些程序的相应生成程序集。

让我们先试试`for`循环：

```
#include <stdio.h>
int main(){
   for(;;)
      printf("This is a loop\n");
   return 0;
} 
```

现在我们将尝试`while`循环：

```
#include <stdio.h>
int main(){
   while(1)
      printf("This is a loop\n");
   return 0;
} 
```

一个糟糕的解决方案，`goto`循环：

```
#include <stdio.h>
int main(){
   alpha:
      printf("This is a loop\n");
      goto alpha;
   return 0;
} 
```

现在，如果我们使用命令检查生成的程序集，`gcc -S loop.c`它们看起来都是这样的（我没有看到任何单独发布它们的理由，因为它们是相同的）：

```
 .file "loop.c"
   .section .rodata
.LC0:
   .string  "This is a loop"
   .text
.globl main
   .type main, @function
main:
   leal  4(%esp), %ecx
   andl  $-16, %esp
   pushl -4(%ecx)
   pushl %ebp
   movl  %esp, %ebp
   pushl %ecx
   subl  $4, %esp
.L2:
   movl  $.LC0, (%esp)
   call  puts
   jmp   .L2
   .size main, .-main
   .ident   "GCC: (GNU) 4.2.4 (Ubuntu 4.2.4-1ubuntu4)"
   .section .note.GNU-stack,"",@progbits 
```

这部分是循环。它声明一个标签，将地址复制到字符串到寄存器中，调用一个名为 的例程`puts`，然后跳回标签：

```
.L2:
   movl  $.LC0, (%esp)
   call  puts
   jmp   .L2 
```

由于它们都做完全相同的事情，显然它们中的任何一个都没有技术优势（至少如果您使用的是`gcc`）。

然而，人们有自己的观点，并且无论出于何种原因，他们都可能偏爱其中的一个。由于`for(;;)`只有七个字符长，因此更容易输入（这是我的偏好）。另一方面，`while(1)`给人一种测试总是评估为 的错觉`true`，有些人可能会觉得这更直观。只有少数疯狂的人最喜欢这个`goto`解决方案。

编辑：显然，某些编译器可能会产生警告，`while(1)`因为条件始终为真，但可以轻松禁用此类警告并且对生成的程序集没有影响。

# amazon-swf - 适用于长期运行的业务工作流程的 Amazon SWF

> ID：14063757
> 
> 赞同：4
> 
> 时间：2012-12-28T02:15:02.320
> 
> 标签：amazon-swf

我正在评估 Amazon SWF 作为构建分布式工作流系统的选项。主要语言将是 Java，因此 Flow 框架是一个显而易见的选择。只有一件事让我感到困惑，在我推荐它作为我们架构中的关键组件之前，我会得到一些其他的意见：

这些示例都是关于在确定的、相对较短的时间段（即几分钟后）后产生结果的任务。在我们现实生活中的业务工作流程中，事情看起来有所不同，这里我们的任务可能需要数周才能完成。我已经检查了计算器，工作流程持续 30 天左右不会导致成本爆炸，所以他们似乎已经考虑到了这种可能性。

有人在这样的场景中使用过 SWF 并且可以分享任何经验吗？是否有任何建议，最佳实践如何设计这样的工作流程？Flow在这里是正确的选择吗？

在我看来，Activity 实现最终有望同步返回一个值，但是，对于长时间运行的事务，我们宁愿使用消息异步发回工作人员结果。

任何有用的反馈表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T21:17:47.553

从[Amazon Simple Workflow Service](http://aws.amazon.com/swf/)的角度来看，活动执行是一对 API 调用：`PollForActivityTask`它们`RespondActivityTaskCompleted`共享一个任务令牌。这些调用不需要来自同一个线程、进程甚至主机。

默认情况下， [AWS Flow Framework](http://aws.amazon.com/swf/flow/)同步执行活动。使用`@ManualActivityCompletion`注解表示活动方法返回时活动未完成。此类活动应使用提供的明确完成（或失败）`ManualActivityCompletionClient`。

以下是摘自[AWS Flow Framework 开发人员指南](http://docs.aws.amazon.com/amazonswf/latest/awsflowguide/activityimpl.html)的示例：

```
@ManualActivityCompletion
public String getName() {
    ActivityExecutionContext executionContext = contextProvider.getActivityExecutionContext();
    String taskToken = executionContext.getTaskToken();
    sendEmail("abc@xyz.com", 
         "Please provide a name for the greeting message and close task with token: " + taskToken);
    return "This will not be returned to the caller";
}

public class CompleteActivityTask {

    public void completeGetNameActivity(String taskToken) {

        AmazonSimpleWorkflow swfClient = new AmazonSimpleWorkflowClient(…); //pass in user credentials
        ManualActivityCompletionClientFactory manualCompletionClientFactory = new ManualActivityCompletionClientFactoryImpl(swfClient);
        ManualActivityCompletionClient manualCompletionClient 
       = manualCompletionClientFactory.getClient(taskToken);
        String result = "Hello World!";
        manualCompletionClient.complete(result);
    }

    public void failGetNameActivity(String taskToken, Throwable failure) {        
        AmazonSimpleWorkflow swfClient
           = new AmazonSimpleWorkflowClient(…); //pass in user credentials
        ManualActivityCompletionClientFactory manualCompletionClientFactory 
           = new ManualActivityCompletionClientFactoryImpl(swfClient);
        ManualActivityCompletionClient manualCompletionClient 
           = manualCompletionClientFactory.getClient(taskToken);
        manualCompletionClient.fail(failure);
    }
} 
```

使用实现活动是`@ManualActivityCompletion`实现细节。工作流代码通过相同的接口调用它，并且与同步实现的任何活动没有区别。

# html - 带 Div 的中心网页

> ID：14063761
> 
> 赞同：1
> 
> 时间：2012-12-28T02:15:32.017
> 
> 标签：html, web

让我在这个问题的开头警告我是一个自学成才的（业余）Web 开发人员（而且不是一个很好的开发人员）。我一直在尝试找到一种使用 AP Divs 使网页居中的有效方法。我试过设置“边距：0自动；” 我试过设置“margin-left：auto;”。两者都适用于那个 div。但是我必须使用它作为包装器在其中进行设计，所以当我在其中放置更多 div 时，它们不会居中。

我可能完全接近这个错误；如果是这样，请纠正我。我想要做的基本版本的代码（不工作）如下。如果您运行该代码，如果我要在 apDiv1 中放置一个图像，它会很好地缩放到页面大小；但 apDiv2 中的文本没有。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Test Page</title>
<style type="text/css">
#apDiv1 {
    margin: 0 auto;
    width:600px;
}
#apDiv2 {
    position:absolute;
    width:50px;
    height:24px;
    z-index:1;
    left: 47px;
    top: 29px;
}
</style>
</head>

<body>
<div id="apDiv1">
  <div id="apDiv2">Hello</div>
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T03:10:11.157

在我自己看来，使用 appdivs 并不好（因为这取决于您在设计中如何定位它）。你可以自己做（居中的东西），检查这个：

[居中（简单示例）](http://jsfiddle.net/Vainglory07/46FJr/)

```
<style>
#header {
margin:auto;
width:600px;
background:#000;
padding:5px;
}
#title {
width:50px;
margin:auto;
background:#CCC;
padding:5px;
}
</style>

<div id="header">
   <div id="title">Hello World</div>
</div> 
```

自定义 AppDivs 添加了额外的样式，这并不是真正需要的:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T02:21:36.950

**[更新示例](http://jsfiddle.net/RdscG/2/)**

好的，经过一些猜测和戳戳，我认为您的意思是您希望将元素绝对定位在居中对齐的包装器内。

`position: absolute`除非父母有`position: relative`.

```
#apDiv1 {
    margin: 0 auto;
    width:600px;
    position:relative;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T02:21:49.947

`margin-left:auto;`我可以使用and将一个 div 居中在另一个 div 中`margin-right:auto;`：

**工作示例：http: [//jsfiddle.net/xjKhT/](http://jsfiddle.net/xjKhT/)**

# mysql - 尝试在 mysql 数据库上进行 POST 时，Curl 挂起

> ID：14063765
> 
> 赞同：1
> 
> 时间：2012-12-28T02:16:21.160
> 
> 标签：mysql, json, curl, http-post

我正在使用 CURL 发出 POST 请求并发送 JSON 来填充 mysql 数据库。当我发出此命令时，curl 挂起的问题。如果我将 RESTClient 与 firefox 一起使用，它可以完美运行，并且我可以使用传递的 json 填充数据库。只有当我发出 CURL 时才会发生这种情况。

如果我在 POST 中删除我的实现并只做一个简单的 System.Out.Print，这工作得很好。

这是我的 curl 命令：

```
curl -i -H "Content-Type: application/json" -X POST -d '{"Time":"Dec 27, 2012 15:44:12","firstName":"John","lastName":"Doe",
"totalSalary":"10000"}' http://localhost:8080/Person/people/ 
```

请让我知道我哪里出错了。

谢谢，杰克

# php - 如何从网站下载 html 的副本？

> ID：14063769
> 
> 赞同：1
> 
> 时间：2012-12-28T02:16:59.653
> 
> 标签：php, mysql, curl, file-get-contents

如何从具有语言检测（例如 google、youtube）和重定向的网站下载 html 副本？我试过 file_get_contents 但它是有限的。

我正在尝试在 php 中使用 curl 从 www.google.com 获取 html，但它检测到我来自英国并向我发送 302 重定向到 www.google.co.uk。

我尝试了许多不同的事情，但没有快乐，这可能吗？像 www.markosweb.com 这样的网站可以做到。

我的代码：

```
$ch  = curl_init( "http://www.google.com/" );    

// $userAgent = "Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)";
//  $userAgent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; .NET CLR 1.1.4322)';

$userAgent = 'Googlebot/2.1 (http://www.googlebot.com/bot.html)';

$header = array(
         "Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5",
         "Accept-Language: en-US,us;q=0.7,en-us;q=0.5,en;q=0.3",
         "Accept-Charset: windows-1251,utf-8;q=0.7,*;q=0.7",
         "Keep-Alive: 300");

curl_setopt($ch,CURLOPT_RETURNTRANSFER,TRUE); //TRUE to return the transfer as a string of the return value of curl_exec() instead of outputting it out directly.
curl_setopt($ch,CURLOPT_CONNECTTIMEOUT,5); //The number of seconds to wait while trying to connect. 

curl_setopt($ch, CURLOPT_USERAGENT, $userAgent); //The contents of the "User-Agent: " header to be used in a HTTP request.
curl_setopt($ch, CURLOPT_FAILONERROR, TRUE); //To fail silently if the HTTP code returned is greater than or equal to 400.
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1); //To follow any "Location: " header that the server sends as part of the HTTP header.
curl_setopt($ch, CURLOPT_AUTOREFERER, TRUE); //To automatically set the Referer: field in requests where it follows a Location: redirect.
curl_setopt($ch, CURLOPT_TIMEOUT, 10); //The maximum number of seconds to allow cURL functions to execute.  
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE);
curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, FALSE);

curl_setopt($curl, CURLOPT_REFERER, $url);

curl_setopt($ch, CURLOPT_HTTPHEADER, 0);

$content = curl_exec( $ch );    
$err     = curl_errno( $ch );    
$errmsg  = curl_error( $ch );    
$header  = curl_getinfo( $ch );    
curl_close( $ch );    
$header['errno']   = $err;    
$header['errmsg']  = $errmsg;    
$header['content'] = $content;    
return $header; 
```

我尝试将用户代理更改为很多东西，尝试使用和不使用标题详细信息。如果我使用标题信息，我设法得到一些东西：“Accept-Language: ru-ru,ru;q=0.7,en-us;q=0.5,en;q=0.3”但它是俄语或其他东西。

谢谢你的帮助。卡尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T02:34:53.263

试试这个代理脚本：

```
// Change these configuration options if needed, see above descriptions for info.
$enable_jsonp    = false;
$enable_native   = false;
$valid_url_regex = '/.*/';

// ############################################################################

$url = $_GET['url'];

if ( !$url ) {

  // Passed url not specified.
  $contents = 'ERROR: url not specified';
  $status = array( 'http_code' => 'ERROR' );

} else if ( !preg_match( $valid_url_regex, $url ) ) {

  // Passed url doesn't match $valid_url_regex.
  $contents = 'ERROR: invalid url';
  $status = array( 'http_code' => 'ERROR' );

} else {
  $ch = curl_init( $url );

  if ( strtolower($_SERVER['REQUEST_METHOD']) == 'post' ) {
    curl_setopt( $ch, CURLOPT_POST, true );
    curl_setopt( $ch, CURLOPT_POSTFIELDS, $_POST );
  }

  if ( $_GET['send_cookies'] ) {
    $cookie = array();
    foreach ( $_COOKIE as $key => $value ) {
      $cookie[] = $key . '=' . $value;
    }
    if ( $_GET['send_session'] ) {
      $cookie[] = SID;
    }
    $cookie = implode( '; ', $cookie );

    curl_setopt( $ch, CURLOPT_COOKIE, $cookie );
  }

  curl_setopt( $ch, CURLOPT_FOLLOWLOCATION, true );
  curl_setopt( $ch, CURLOPT_HEADER, true );
  curl_setopt( $ch, CURLOPT_RETURNTRANSFER, true );

  curl_setopt( $ch, CURLOPT_USERAGENT, $_GET['user_agent'] ? $_GET['user_agent'] : $_SERVER['HTTP_USER_AGENT'] );

  list( $header, $contents ) = preg_split( '/([\r\n][\r\n])\\1/', curl_exec( $ch ), 2 );

  $status = curl_getinfo( $ch );

  curl_close( $ch );
}

// Split header text into an array.
$header_text = preg_split( '/[\r\n]+/', $header );

if ( $_GET['mode'] == 'native' ) {
  if ( !$enable_native ) {
    $contents = 'ERROR: invalid mode';
    $status = array( 'http_code' => 'ERROR' );
  }

  // Propagate headers to response.
  foreach ( $header_text as $header ) {
    if ( preg_match( '/^(?:Content-Type|Content-Language|Set-Cookie):/i', $header ) ) {
      header( $header );
    }
  }

  print $contents;

} else {

  // $data will be serialized into JSON data.
  $data = array();

  // Propagate all HTTP headers into the JSON data object.
  if ( $_GET['full_headers'] ) {
    $data['headers'] = array();

    foreach ( $header_text as $header ) {
      preg_match( '/^(.+?):\s+(.*)$/', $header, $matches );
      if ( $matches ) {
        $data['headers'][ $matches[1] ] = $matches[2];
      }
    }
  }

  // Propagate all cURL request / response info to the JSON data object.
  if ( $_GET['full_status'] ) {
    $data['status'] = $status;
  } else {
    $data['status'] = array();
    $data['status']['http_code'] = $status['http_code'];
  }

  // Set the JSON data object contents, decoding it from JSON if possible.
  $decoded_json = json_decode( $contents );
  $data['contents'] = $decoded_json ? $decoded_json : $contents;

  // Generate appropriate content-type header.
  $is_xhr = strtolower($_SERVER['HTTP_X_REQUESTED_WITH']) == 'xmlhttprequest';
  header( 'Content-type: application/' . ( $is_xhr ? 'json' : 'x-javascript' ) );

  // Get JSONP callback.
  $jsonp_callback = $enable_jsonp && isset($_GET['callback']) ? $_GET['callback'] : null;

  // Generate JSON/JSONP string
  $json = json_encode( $data );

  print $jsonp_callback ? "$jsonp_callback($json)" : $json;

} 
```

确保执行如下请求： [http ://example.com/script?url=http://whateverurl.com/](http://example.com/script?url=http://whateverurl.com/)

哦，这个 PHP 脚本将以 JSON 格式显示结果。从那里，您可以使用 jQuery 解析它。

就像我使用这个 jQuery 代码一样：

```
 <script type="text/javascript">
$(document).ready(function(){
var url='+++++URL WHICH THE PHP PROXY SCRIPT IS IN++++++';
$(window).load(function(){
        $.getJSON(url,function(json){
               $("#resu").append(""+json.contents+"");
        });
    });
});
</script> 
```

**编辑：**这个脚本不是真正的代理，因为它确实伪造了一个 IP 地址。对困惑感到抱歉。

# regex - EMACS 正则表达式，如何仅在指定的几行中工作

> ID：14063771
> 
> 赞同：0
> 
> 时间：2012-12-28T02:17:08.727
> 
> 标签：regex, emacs

例如，我只是希望它在 1-10 行中工作，如何做到这一点。菜鸟，谢谢帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T02:38:15.457

您可以使用窄模式，它只会显示前 10 行，隐藏其余行。

# ruby-on-rails-3 - RSpec 请求规范和路由规范偶尔会在 CI 中失败

> ID：14063774
> 
> 赞同：2
> 
> 时间：2012-12-28T02:17:39.390
> 
> 标签：ruby-on-rails-3, rspec, jenkins, rspec-rails

我们将 Jenkins 用作 CI 服务器，并且没有任何我可以确定的模式，有时请求和路由规范会失败 - 但仅在 CI 服务器上，从不在开发机器上。

它目前使用 Selenium 作为 Capybara 驱动程序，我之前曾看到过该配置存在问题，但路由规范偶尔失败让我感到困惑。任何人都可以对要检查的事情提出任何建议吗？

更新：

我现在偶尔发生一个故障：

```
NoMethodError: undefined method `to_a' for false:FalseClass
(in /blah/app/assets/stylesheets/application.css.scss)

/home/paul/.rvm/gems/ruby-1.9.3-p374/gems/sass-3.2.5/lib/sass/selector/simple_sequence.rb:153:in `block in to_a' 
```

这绝对是我以前见过的相同错误消息，但我之前从未见过这条线......正在调查。

# c# - 排序算法 - C#

> ID：14063779
> 
> 赞同：2
> 
> 时间：2012-12-28T02:18:47.333
> 
> 标签：c#, linq, sorting

我有以下未排序的列表：

```
List<string> myUnsortedList = New List<string>();

myUnsortedList.Add("Alpha");
myUnsortedList.Add("(avg) Alpha");
myUnsortedList.Add("Zeta");
myUnsortedList.Add("Beta");
myUnsortedList.Add("(avg) Beta");
myUnsortedList.Add("(avg) Zeta"); 
```

我想按字母顺序对列表进行排序，然后在正常值之后使用 (avg) 的值：

> 最终结果：Zeta, (avg) Zeta, Beta, (avg) Beta, Alpha, (avg) Alpha

我的应用程序是写的`C#`，我想用它`LINQ`来完成排序

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-28T02:29:14.583

这应该可以满足您的需要，假设“（avg）”是唯一的特殊前缀

这将对不包括“（avg）”的所有字符串进行降序排序，然后它将按字符串长度排序，这样带有“（avg）”前缀的字符串将排在没有前缀的字符串之后

```
var result = myUnsortedList.OrderByDescending(x => x.Replace("(avg) ", "")).ThenBy(x => x.Length); 
```

最后结果：

*   泽塔
*   （平均）泽塔
*   贝塔
*   （平均）测试版
*   Α
*   （平均）阿尔法

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-28T03:19:29.560

以下是使用 LINQ 实现这一目标的几种方法，同时如果它们以不同于您提供的顺序出现，也可以正确排序值。例如，如果“(avg) Zeta”出现在“Zeta”之前，那么后者在排序后仍应排在第一位。

这是示例列表，重新排序以匹配我上面描述的内容：

```
var myUnsortedList = new List<string>
{
    "Alpha",
    "(avg) Alpha",
    "(avg) Zeta",
    "Zeta",
    "Beta",
    "(avg) Beta"
}; 
```

## Lambda 语法

```
string prefix = "(avg)";
var result = myUnsortedList.Select(s => new
                           {
                               Value = s,
                               Modified = s.Replace(prefix, "").TrimStart(),
                               HasPrefix = s.StartsWith(prefix)
                           })
                           .OrderByDescending(o => o.Modified)
                           .ThenBy(o => o.HasPrefix)
                           .Select(o => o.Value); 
```

## 邮编/聚合

```
string prefix = "(avg)";
var avg = myUnsortedList.Where(o => o.StartsWith(prefix))
                        .OrderByDescending(o => o);
var regular = myUnsortedList.Where(o => !o.StartsWith(prefix))
                            .OrderByDescending(o => o);
var result = regular.Zip(avg, (f, s) => new { First = f, Second = s })
                    .Aggregate(new List<string>(), (list, o) =>
                                   new List<string>(list) { o.First, o.Second }); 
```

## 查询语法和字符串拆分

这类似于 lambda 语法，只是我没有使用`prefix`来确定哪个字符串有前缀。相反，我在一个空间上拆分，如果拆分结果有多个项目，那么我假设它有一个前缀。接下来，我根据值和前缀的可用性进行排序。

```
var result = from s in myUnsortedList
             let split = s.Split(' ')
             let hasPrefix = split.Length > 1
             let value = hasPrefix ? split[1] : s
             orderby value descending, hasPrefix
             select s; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-28T02:49:25.433

将列表拆分为两个列表，一个正常，一个平均。对它们进行排序。

然后，进行手动“拉链合并”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-28T02:52:24.140

您可能应该创建自己的自定义[`IComparer<T>`](http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx)：

```
class MyCustomComparer : IComparer<string>
{
    private readonly StringComparison StringComparer;

    public static readonly MyCustomComparer Ordinal =
        new MyCustomComparer(StringComparison.Ordinal);
    public static readonly MyCustomComparer OrdinalIgnoreCase =
        new MyCustomComparer(StringComparison.OrdinalIgnoreCase);
    // etc.

    private MyCustomComparer(StringComparison stringComparer)
    {
        StringComparer = stringComparer;
    }

    public int Compare(string x, string y)  
    {  
        bool isMatchedX = IsMatchedPattern(x);
        bool isMatchedY = IsMatchedPattern(y);

        if (isMatchedX&& !isMatchedY ) // x matches the pattern.
        {
            return String.Compare(Strip(x), y, StringComparer);
        }
        if (isMatchedY && !isMatchedX) // y matches the pattern.
        {
            return String.Compare(Strip(y), x, StringComparer);
        }

        return String.Compare(x, y, StringComparison.Ordinal);
    }

    private static bool isMatchedPattern(string str)
    {
        // Use some way to return if it matches your pattern.
        // StartsWith, Contains, Regex, etc.
    }

    private static string Strip(string str)
    {
        // Use some way to return the stripped string.
        // Substring, Replace, Regex, etc.
    }
} 
```

* * *

检查*x*和*y*是否与您的模式匹配。如果两者都不做，则使用标准比较操作。基本上，如果一个（并且只有一个）与模式匹配，您只需要自定义比较操作。

如果*x*与模式匹配而*y*不匹配，则剥离*x*并使用操作检查*x*的剥离版本与*y*`String.Compare(...)`是否匹配。如果*y*与模式匹配而*x*不匹配，则剥离*y*并使用操作检查*y*的剥离版本与x*的*`String.Compare(...)`对比。

我更新了我的答案，以展示如何`StringComparison`通过为案例/区域性选项公开自定义比较器的静态只读实例来复制工作方式。

最后，将 LINQ 与您的自定义比较器一起使用：`myList.OrderBy(x => x, MyCustomComparer.Ordinal);`

* * *

最后一点......如有必要，请随时优化。这是我心血来潮的未经测试的代码。逻辑在那里，我希望。但是，可能出现了拼写错误。

希望有帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-28T02:29:32.820

另一种方法是实现一些比较器说`MyComparer`，实现`IComparer<string>`然后：

```
var result = myUnsortedList.OrderBy(x => x, new MyComparer()); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-28T02:42:24.860

我觉得您为此使用了错误的数据结构。为什么不使用 SortedDictionary 并将其设为“name => avg”

未经测试，可能工作的代码：

```
SortedDictionary<string, int> dict = new SortedDictionary<string, int>();
dict.Add("Alpha", 10);
dict.Add("Beta", 20);
dict.Add("Zeta", 30);

foreach(string key in dict.Keys.Reverse())
{
   int avg = dict[key];
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-28T02:56:39.807

要在 linq 排序中使用您自己的逻辑，您应该实现自己的比较器并将其实例用作`OrderBy`或`OrderByDescending`linq 方法中的第二个参数，如下所示：

```
namespace ConsoleApplication71
{
    public class AVGComparer : IComparer<string>
    {
        public int Compare(string x, string y)
        {
            // Null checkings are necessary to prevent null refernce exceptions
            if((x == null) && (y == null)) return 0;
            if(x == null) return -1;
            if(y == null) return 1;

            const string avg = @"(avg) ";

            if(x.StartsWith(avg) || y.StartsWith(avg))
            {
                return x.Replace(avg, string.Empty).CompareTo(y.Replace(avg, string.Empty));
            }

            return x.CompareTo(y);
        }
    }

    class Program
    {
        static void Main(string[] args)
        {
            List<string> myUnsortedList = new List<string>();

            myUnsortedList.Add("Alpha");
            myUnsortedList.Add("(avg) Alpha");
            myUnsortedList.Add("Zeta");
            myUnsortedList.Add("Beta");
            myUnsortedList.Add("(avg) Beta");
            myUnsortedList.Add("(avg) Zeta");

            var mySortedList = myUnsortedList.OrderByDescending(s => s, new AVGComparer());

            foreach (string s in mySortedList)
            {
                Console.WriteLine(s);
            }
        }
    }
} 
```

输出是：

```
Zeta
(avg) Zeta
Beta
(avg) Beta
Alpha
(avg) Alpha 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-12-28T03:32:34.220

在一行中：

```
var sorted = myUnsortedList.OrderByDescending(x => x.Replace("(avg) ", "")).ThenBy(x=> x.Contains("(avg)")).ToList(); 
```

这是一个通过测试（nunit）：

```
[Test]
public void CustomSort()
{
    var myUnsortedList = new List<string> { "Zeta", "Alpha", "(avg) Alpha", "Beta", "(avg) Beta", "(avg) Zeta" };
    var EXPECTED_RESULT = new List<string> { "Zeta", "(avg) Zeta", "Beta", "(avg) Beta", "Alpha", "(avg) Alpha" };

    var sorted = myUnsortedList.OrderByDescending(x => x.Replace("(avg) ", "")).ThenBy(x=> x.Contains("(avg)")).ToList();

    for (int i = 0; i < myUnsortedList.Count; i++)
    {
        Assert.That(sorted[i], Is.EqualTo(EXPECTED_RESULT[i]));
    }
} 
```

# arrays - 如何在awk中初始化一个数组？

> ID：14063783
> 
> 赞同：31
> 
> 时间：2012-12-28T02:19:23.460
> 
> 标签：arrays, awk, initialization

是否可以在 AWK 中初始化这样的数组？

```
Colors[1] = ("Red", "Green", "Blue")
Colors[2] = ("Yellow", "Cyan", "Purple") 
```

然后有一个二维数组，其中 Colors[2,3]="Purple"。

* * *

从[另一个线程](https://stackoverflow.com/questions/5400228/use-array-variable-in-awk)我了解到这是不可能的（“遗憾的是，没有办法在不滥用 split() 的情况下一次设置一个数组”）。无论如何，我想 100% 确定，并且我确信还有其他人有同样的问题。

我正在寻找最简单的方法来初始化像上面这样的数组，如果写得好的话会很好。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-28T04:41:34.667

如果有`GNU awk`，您可以使用[真正的多维数组](http://www.gnu.org/software/gawk/manual/html_node/Arrays-of-Arrays.html#Arrays-of-Arrays)。尽管此答案使用了该`split()`功能，但它肯定不会滥用它。像这样运行：

```
awk -f script.awk 
```

内容`script.awk`：

```
BEGIN {

    x=SUBSEP

    a="Red" x "Green" x "Blue"
    b="Yellow" x "Cyan" x "Purple"

    Colors[1][0] = ""
    Colors[2][0] = ""

    split(a, Colors[1], x)
    split(b, Colors[2], x)

    print Colors[2][3]
} 
```

结果：

```
Purple 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-12-28T03:12:02.360

您可以很容易地创建一个二维数组。AFAIK，您不能做的是在单个操作中对其进行初始化。正如[dmckee](https://stackoverflow.com/users/2509/dmckee)在评论中暗示的那样，无法初始化数组的原因之一是对下标的类型没有限制，因此不需要它们是纯数字。您可以按照下面的脚本进行多项分配。下标由变量 SUBSEP 指定的晦涩字符正式分隔，默认值为 034 (U+001C, FILE SEPARATOR)。显然，如果其中一个索引包含此字符，则会出现混乱（但您最后一次在字符串中使用该字符是什么时候？）。

```
BEGIN {
    Colours[1,1] = "Red"
    Colours[1,2] = "Green"
    Colours[1,3] = "Blue"
    Colours[2,1] = "Yellow"
    Colours[2,2] = "Cyan"
    Colours[2,3] = "Purple"
}
END {
    for (i = 1; i <= 2; i++)
        for (j = 1; j <= 3; j++)
            printf "Colours[%d,%d] = %s\n", i, j, Colours[i,j];
} 
```

示例运行：

```
$ awk -f so14063783.awk /dev/null
Colours[1,1] = Red
Colours[1,2] = Green
Colours[1,3] = Blue
Colours[2,1] = Yellow
Colours[2,2] = Cyan
Colours[2,3] = Purple
$ 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-12-28T03:36:58.183

感谢您的回答。无论如何，对于那些想要初始化一维数组的人，这里有一个例子：

```
SColors = "Red_Green_Blue"
split(SColors, Colors, "_")
print Colors[1] " - " Colors[2] " - " Colors[3] 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-03-31T14:02:00.420

^(现有的答案很有帮助，并且涵盖了所有方面，但我想我会给出一个更集中的总结。)

这个问题把两个方面混为一谈：

*   通常在 Awk 中初始化数组
*   这样做是为了特别填充*二维*数组

### 数组初始化：

awk***没有*数组字面量（初始化器）语法。**

最简单的**解决方法**是：

*   将数组元素表示为*单个字符串*，并且
*   使用该`split()`函数将该字符串拆分为数组的元素。

```
$ awk 'BEGIN { n=split("Red Green Blue", arr); for (i=1;i<=n;++i) print arr[i] }'
Red
Green
Blue 
```

^(这就是 OP 在[他们自己的有用答案](https://stackoverflow.com/a/14064269/45375)中所做的。)

如果元素本身包含空格，请使用不属于数据的自定义分隔符，`|`在此示例中：

```
$ awk 'BEGIN { n=split("Red (1)|Green (2)", arr, "|"); for (i=1;i<=n;++i) print arr[i] }'
Red (1)
Green (2) 
```

* * *

### 二维数组的初始化：

*   **根据 POSIX**，Awk**没有*真正*的多维数组，只有***使用*一维数组来****模拟***它，其索引与内置变量的值隐式连接`SUBSEP`以形成*单个键*（索引；请注意，*所有*Awk 数组都是*联想*）。*

     **   `arr[1, 2]`实际上与 相同`arr[1 SUBSEP 2]`，其中`1 SUBSEP 2`是构建键值的*字符串连接。*
    *   因为没有真正的多维——只有一个复合键的平面数组——你不能用 单独枚举（伪）维`for (i in ...)`，例如只获取主（伪）维的所有子索引`1`。
    *   的默认值`SUBSEP`是[“INFORMATION SEPARATOR ONE”字符](http://www.fileformat.info/info/unicode/char/1f/index.htm)，一个很少使用的控制字符，不太可能出现在日期中；在 ASCII 和 UTF-8 中，它表示为单字节`0x1f`；如果需要，您可以更改该值。* 
**   相比之下，作为非标准扩展的***GNU* Awk***确实*支持**真正的多维数组**。

    *   **重要提示：您必须始终***单独*指定索引；例如，`arr[1,2]`您必须使用`arr[1][2]`.*

 ***符合 POSIX 的示例**（类似于[TrueY 的有用答案](https://stackoverflow.com/a/16147087/45375)）：

```
awk 'BEGIN {
  n=split("Red Green Blue", arrAux); for (i in arrAux) Colors[1,i] = arrAux[i]
  n=split("Yellow Cyan Purple", arrAux); for (i in arrAux) Colors[2,i] = arrAux[i]
  print Colors[1,2]
  print "---"
  # Enumerate all [2,*] values - see comments below.
  for (i in Colors) { if (index(i, 2 SUBSEP)==1) print Colors[i] }
}'
Green
---
Yellow
Cyan
Purple 
```

请注意，使用复合键模拟具有一维数组的多维数组具有以下**不便之处**：

*   需要辅助数组`auxArr`，因为您不能直接填充数组的给定（伪）维度。

*   您不能只枚举*一个*（伪）维度`for (i in ...)`，您只能枚举*所有*索引，跨越（伪）维度。

    *   `for (i in Colors) { if (index(i, 2 SUBSEP)==1) print Colors[i] }` 上面显示了如何通过枚举*所有*键然后仅匹配第一个组成索引为的键来解决此问题`2`，这意味着键值必须以 开头`2`，然后是`SUBSEP`。

***GNU* Awk 示例**（类似于[Steve 的有用答案](https://stackoverflow.com/a/14064658/45375)，通过[Ed Morton 的](https://stackoverflow.com/users/1745001/ed-morton)评论进行了改进）：

GNU Awk 对真正的多维数组的（非标准）支持**消除了（大部分）符合 POSIX 的解决方案的不便**
（不过，GNU Awk 也没有数组初始化器）：

```
gawk 'BEGIN {
  Colors[1][""]; split("Red Green Blue", Colors[1])
  Colors[2][""]; split("Yellow Cyan Purple", Colors[2])
  # NOTE: Always use *separate* indices: [1][2] instead of [1,2]
  print Colors[1][2]
  print "---"
  # Enumerate all [2][*] values
  for (i in Colors[2]) print Colors[2][i]
}' 
```

笔记：

*   **重要提示**：如前所述，要寻址多维数组中的特定元素，请始终使用*单独*的索引；例如，`[1][2]`而不是`[1,2]`.

    *   如果您使用`[1,2]`，您将获得标准的 POSIX 强制行为，并且您将错误地*创建*一个带有 (string-concatenated) value 的新的单一索引 (key) `1 SUBSEP 2`。
*   `split()`可以方便地用于直接填充子数组。

*   但是，作为先决条件，必须初始化二维目标数组：

    *   `Colors[1][""]`并`Colors[2][""]`做到这一点。
    *   虚拟索引`[""]`只是用来创建一个二维数组；`split()`稍后填充该维度时将其丢弃。
*   支持枚举特定维度`for (i in ...)`：

    *   `for (i in Colors[2]) ...`方便地仅枚举 的子索引`Colors[2]`。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-04-22T12:26:20.340

类似的解决方案。`SUBSEP=":"`不是真的需要，只需设置为演示的任何可见字符：

```
awk 'BEGIN{SUBSEP=":"
split("Red Green Blue",a); for(i in a) Colors[1,i]=a[i];
split("Yellow Cyan Purple",a); for(i in a) Colors[2,i]=a[i];
for(i in Colors) print i" => "Colors[i];}' 
```

或者更神秘一点的版本：

```
awk 'BEGIN{SUBSEP=":"
split("Red Green Blue Yellow Cyan Purple",a); 
for(i in a) Colors[int((i-1)/3)+1,(i-1)%3+1]=a[i];
for(i in Colors) print i" => "Colors[i];}' 
```

输出：

```
1:1 => Red
1:2 => Green
1:3 => Blue
2:1 => Yellow
2:2 => Cyan
2:3 => Purple 
```*

# bash - 将字符串分配给Bash中的数组元素，语法错误？

> ID：14063784
> 
> 赞同：0
> 
> 时间：2012-12-28T02:19:32.070
> 
> 标签：bash, syntax, scripting

循环中的这一行应该将三个字符串加在一起

```
for each $drivecount
${drives[$drivecount]}=${info[$count+1]}" "${info[$count+2]}" "${info[$count+3]} 
```

这是我得到的错误：

```
./erasehd.sh: line 17: =/dev/sda: 80.0 GB: No such file or directory 
```

看起来它包含 = 作为第一个字符串的一部分？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T02:52:26.763

```
./erasehd.sh: line 17: =/dev/sda: 80.0 GB: No such file or directory 
```

不，它忽略了前面未声明的变量并尝试`=/dev/sda...`作为命令执行。;-） .... 你要

```
for each $drivecount
drives[$drivecount]=${info[$count+1]}" "${info[$count+2]}" "${info[$count+3]} 
```

设置变量时，您永远不需要在变量上使用前导“$”，或者换一种说法，通常您不希望在“=”赋值的左侧使用“$”。

我不熟悉`for each`bash 中的构造。你确定这是对的吗？我希望像

```
for drivecount in 1 2 3 ; do
 .... 
```

最后，您包含的语法用于引用与赋值无关的数组元素。

```
for dc in 1 2 3 ; do
  echo ${drives[$dc]}
done 
```

IHTH。

# xcode - 咆哮框架 osx 和沙盒

> ID：14063787
> 
> 赞同：2
> 
> 时间：2012-12-28T02:20:12.887
> 
> 标签：xcode, macos, growl, sandbox

我打算在旧项目的基础上构建一个新项目。因此，当我尝试运行旧版本时，我从 XCode 收到了这条消息：

![XCode 消息](../Images/fcb1a3329883619ce2a51cb6c6ceaac0.png)

但是应用程序正常启动并且咆哮通知按预期工作：
![咆哮通知](../Images/576a5de4de76d5a04c48810fe3c9a559.png)

旧项目（沙盒）通过了应用商店审核，自 2012 年 10 月 23 日起处于销售状态。
您认为这里有什么问题还是我应该忽略 XCode 消息并在我的新项目中使用旧代码？其他人也有同样的问题，你是如何解决的？
我使用 osx 10.7 和 XCode 4.5.2

# browser - Watir-webdriver 64bit windows7 无法打开任何浏览器，出现错误意外响应，代码 = 502，内容类型 = "text/html"

> ID：14063790
> 
> 赞同：1
> 
> 时间：2012-12-28T02:21:05.170
> 
> 标签：browser, windows-7, 64-bit, watir-webdriver

环境 - 64 位 Windows 7
ruby​​ 1.9.2- P290 ruby
​​gems 1.8.24
Watir 4.0.2

尝试创建浏览器（Chrome 或 IE）实例时，将失败并出现以下错误
尝试创建 Firefox 实例时，它将打开 Firefox，然后自动关闭并出现相同的错误。

```
irb(main):001:0> require 'rubygems'  
=> true  
irb(main):002:0> require 'watir-webdriver'  
=> true  
irb(main):003:0> ie = Watir::Browser.new:chrome  
Started ChromeDriver  
port=9515  
version=23.0.1240.0  
log=C:\Users\y93529\chromedriver.log  
Selenium::WebDriver::Error::WebDriverError: unexpected response, code=502, conte
nt-type="text/html"
<HEAD><TITLE>Connection refused</TITLE></HEAD>
<BODY BGCOLOR="white" FGCOLOR="black"><H1>Connection refused</H1><HR>
<FONT FACE="Helvetica,Arial"><B>
Description: Connection refused</B></FONT>
<HR>
<!-- default "Connection refused" response (502) -->
</BODY>
    from C:/ruby/lib/ruby/gems/1.9.1/gems/selenium-webdriver-2.27.2/lib/sele
nium/webdriver/remote/http/common.rb:66:in `create_response'
    from C:/ruby/lib/ruby/gems/1.9.1/gems/selenium-webdriver-2.27.2/lib/sele
nium/webdriver/remote/http/default.rb:66:in `request'
    from C:/ruby/lib/ruby/gems/1.9.1/gems/selenium-webdriver-2.27.2/lib/sele
nium/webdriver/remote/http/common.rb:40:in `call'
    from C:/ruby/lib/ruby/gems/1.9.1/gems/selenium-webdriver-2.27.2/lib/sele
nium/webdriver/remote/bridge.rb:615:in `raw_execute'
    from C:/ruby/lib/ruby/gems/1.9.1/gems/selenium-webdriver-2.27.2/lib/sele
 nium/webdriver/remote/bridge.rb:92:in `create_session'
    from C:/ruby/lib/ruby/gems/1.9.1/gems/selenium-webdriver-2.27.2/lib/sele
 nium/webdriver/remote/bridge.rb:68:in `initialize'
    from C:/ruby/lib/ruby/gems/1.9.1/gems/selenium-webdriver-2.27.2/lib/sele
nium/webdriver/chrome/bridge.rb:29:in `initialize'
    from C:/ruby/lib/ruby/gems/1.9.1/gems/selenium-webdriver-2.27.2/lib/sele
nium/webdriver/common/driver.rb:37:in `new'
    from C:/ruby/lib/ruby/gems/1.9.1/gems/selenium-webdriver-2.27.2/lib/sele
nium/webdriver/common/driver.rb:37:in `for'
    from C:/ruby/lib/ruby/gems/1.9.1/gems/selenium-webdriver-2.27.2/lib/sele
nium/webdriver.rb:67:in `for'
    from C:/ruby/lib/ruby/gems/1.9.1/gems/watir-webdriver-0.6.2/lib/watir-we
bdriver/browser.rb:46:in `initialize'
    from (irb):3:in `new'
    from (irb):3
    from C:/ruby/bin/irb:12:in `<main>' 
```

补充一点 - 32 位 windows 7 中的相同环境，一切正常。我怀疑64位win7和32位win7对webdriver的支持是否有区别

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T03:35:42.060

解决了！我的网络有代理，当我尝试安装watir时，我用代理配置了命令行，所以命令行可以下载安装watir。安装后，我没有删除我配置的代理，它仍然在环境变量中。这就是为什么每次我尝试使用 watir-webdriver 启动浏览器时它都会失败。删除此代理，一切正常。

感谢你们参与解决这个问题。

# c++ - queue::push 后双重释放或损坏

> ID：14063791
> 
> 赞同：53
> 
> 时间：2012-12-28T02:21:06.830
> 
> 标签：c++, runtime-error, delete-operator

```
#include <queue>
using namespace std;

class Test{
    int *myArray;

        public:
    Test(){
        myArray = new int[10];
    }

    ~Test(){
        delete[] myArray;
    }

};

int main(){
    queue<Test> q
    Test t;
    q.push(t);
} 
```

运行此程序后，我收到运行时错误“双重释放或损坏”。如果我摆脱析构函数内容（`delete`），它工作正常。怎么了？

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2012-12-28T02:37:51.047

## 让我们谈谈在 C++ 中复制对象。

`Test t;`，调用默认构造函数，它分配一个新的整数数组。这很好，你的预期行为。

当您`t`使用`q.push(t)`. 如果您熟悉 Java、C# 或几乎任何其他面向对象的语言，您可能希望将您之前创建的对象添加到队列中，但 C++ 不是这样工作的。

当我们查看[`std::queue::push`method](http://www.cplusplus.com/reference/queue/queue/push/)时，我们会看到添加到队列中的元素“初始化为 x 的副本”。它实际上是一个全新的对象，它使用复制构造函数复制原始`Test`对象的每个成员以创建一个新的`Test`.

默认情况下，您的 C++ 编译器会为您生成一个复制构造函数！这非常方便，但会导致指针成员出现问题。在您的示例中，请记住这`int *myArray`只是一个内存地址；当 的值`myArray`从旧对象复制到新对象时，您现在将有两个对象指向内存中的同一个数组。这本质上并不是坏事，但是析构函数会尝试删除同一个数组两次，因此会出现“双重释放或损坏”运行时错误。

## 我如何解决它？

第一步是实现一个*复制构造函数*，它可以安全地将数据从一个对象复制到另一个对象。为简单起见，它可能看起来像这样：

```
Test(const Test& other){
    myArray = new int[10];
    memcpy( myArray, other.myArray, 10 );
} 
```

现在，当您复制 Test 对象时，将为新对象分配一个新数组，并且该数组的值也将被复制。

不过，我们还没有完全摆脱麻烦。编译器为您生成的另一种方法可能会导致类似的问题 - 分配。不同之处在于，通过赋值，我们已经有了一个需要适当管理其内存的现有对象。这是一个基本的赋值运算符实现：

```
Test& operator= (const Test& other){
    if (this != &other) {
        memcpy( myArray, other.myArray, 10 );
    }
    return *this;
} 
```

这里重要的部分是我们将数据从另一个数组复制到这个对象的数组中，保持每个对象的内存分开。我们还检查了自我分配；否则，我们会从自己复制到自己，这可能会引发错误（不确定它应该做什么）。如果我们要删除并分配更多内存，自分配检查会阻止我们删除需要从中复制的内存。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-12-28T06:02:52.930

问题是您的类包含一个托管的 RAW 指针，但没有实现三规则（C++ 11 中的五）。结果，由于复制，您（预期）得到了双重删除。

如果你正在学习，你应该学习如何[实施三（五）规则](https://stackoverflow.com/q/255612/14065)。但这不是解决这个问题的正确方法。您应该使用标准容器对象，而不是尝试管理自己的内部容器。确切的容器将取决于您要执行的操作，但 std::vector 是一个很好的默认值（如果不是最佳的，您可以更改后记）。

```
#include <queue>
#include <vector>

class Test{
    std::vector<int> myArray;

    public:
    Test(): myArray(10){
    }    
};

int main(){
    queue<Test> q
    Test t;
    q.push(t);
} 
```

您应该使用标准容器的原因是`separation of concerns`. 您的课程应该关注业务逻辑或资源管理（而不是两者）。假设`Test`您正在使用某个类来维护程序的某些状态，那么它是业务逻辑，它不应该进行资源管理。另一方面，如果`Test`应该管理一个数组，那么您可能需要更多地了解标准库中可用的内容。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-28T02:30:20.547

您将获得**双重释放或损坏**，因为第一个析构函数用于对象**q**在这种情况下，由**new**分配的内存将是空闲的。下一次为对象**t**调用析构函数时，内存已经空闲（为 q 完成）因此当在析构函数中**delete[] myArray;** 将执行它会抛出**双重释放或损坏**。原因是两个对象共享相同的内存，因此定义了 \copy、赋值和相等运算符，如上述答案中所述。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-12-28T02:23:14.973

你需要定义一个拷贝构造函数、赋值、操作符。

```
class Test {
   Test(const Test &that); //Copy constructor
   Test& operator= (const Test &rhs); //assignment operator
} 
```

推送到队列中的副本指向与原始内存相同的内存。当第一个被破坏时，它会删除内存。第二个破坏并尝试删除相同的内存。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-08-18T07:23:09.840

您还可以尝试在删除之前检查 null 这样

```
if(myArray) { delete[] myArray; myArray = NULL; } 
```

或者您可以像这样以安全的方式定义所有删除操作：

```
#ifndef SAFE_DELETE
#define SAFE_DELETE(p) { if(p) { delete (p); (p) = NULL; } }
#endif

#ifndef SAFE_DELETE_ARRAY
#define SAFE_DELETE_ARRAY(p) { if(p) { delete[] (p); (p) = NULL; } }
#endif 
```

然后使用

```
SAFE_DELETE_ARRAY(myArray); 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-12-28T02:45:09.667

嗯，析构函数不应该调用delete，而不是delete[]？

# sap - 误删除 PSA 中的信息包后重新启动我的增量加载

> ID：14063792
> 
> 赞同：1
> 
> 时间：2012-12-28T02:21:08.017
> 
> 标签：sap, business-intelligence

在这里我有一个问题。请有人帮我解决这个问题。

我试图将一些数据提取到 DS 0FI_AP_6...

然后在 InfoPackage Monitor 我可以看到..

> -->请求（消息）：一切正常
> 
> -->提取（消息）：一切正常
> 
> -->Transfer（IDocs 和 TRFC）：缺少消息或警告
> 
> -->Info IDoc 2：已发送，未到达；IDoc 准备发送（ALE 服务）
> 
> ```
>  Data Package 1 : 23752 Records arrived in BW
> 
>      Data Package 2 : 15216 Records arrived in BW
> 
>      Request IDoc : Application document posted
> 
>      Info IDoc 1 : Application document posted
> 
>      Info IDoc 3 : Application document posted
> 
>      Info IDoc 4 : Application document posted 
> ```
> 
> -->处理中（数据包）：一切OK
> 
> ```
>  Data Package 1 ( 38672 Records ) : Everything OK 
> ```

在状态菜单中，我收到类似...的消息

> PSA 表缺少数据包
> 
> 诊断
> 
> PSA 表中缺少数据包。BI 处理不返回任何错误。从源系统到 BI 的数据传输可能不正确。
> 
> 程序
> 
> 检查源系统中的 tRFC 概述。
> 
> 您可以使用向导或按照菜单路径“Environment -> Transact. RFC -> Source System”访问此日志。
> 
> 错误处理：
> 
> 如果 tRFC 不正确，请解决此处列出的错误。
> 
> 检查源系统是否正确连接到 BI。特别是，检查 BI 中的远程用户权限。

请建议我如何解决此问题...

提前感谢您的帮助，非常感谢您的快速回复。

**但是最糟糕的是我错误地删除了PSA中的信息包。在正常情况下，如果我再次重复该过程，增量负载会正常，但现在增量负载仍然是错误的。**

大师们，

**1\. 如何正确重启我的增量加载？**

**2.我想修改delta表中的时间戳，但是怎么做呢？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T18:41:22.023

转到源系统中的 T-Code RSA7。这将告诉您增量设置为的日期/时间戳。如果日期更改为不再有效的范围，那么您将需要在 BW 系统端重新初始化数据源。但是，Delta 日期可能仍然没问题，因为由于连接问题，当您尝试首次加载时它可能从未更改过。

您可以创建一个新的信息包并将更新设置为使用数据传输初始化数据源。这实际上将从数据源运行完全加载，然后将增量指针日期/时间戳重置为您运行它的时间。这样，您将捕获您需要的所有数据，并且应该覆盖 PSA 中已经存在的任何数据。

另请注意，您应该删除先前请求中可能包含 PSA 中的错误数据的请求状态或将请求状态设置为红色。

从最初的错误来看，您似乎在数据源和 BW 之间遇到了 RFC 连接问题。请联系您的 BASIS 支持并让他们检查连接以确保连接良好。为确保您的数据源正确提取，您可以在源系统中对其运行 t-code RSA3。这将确保数据的提取工作正常。

# batch-file - 将变量回显到文件中

> ID：14063793
> 
> 赞同：2
> 
> 时间：2012-12-28T02:21:21.010
> 
> 标签：batch-file, cmd

我正在尝试制作一个简单的统计程序，它只计算它运行了多少次。当我将时间结果变量回显到大于 1 的跟踪文件时，就会出现问题。是否不可能将变量回显到文件上？我错过了什么？：/

```
if not exist statistic_files (
mkdir statistic_files
)
cd statistic_files

if exist %username%-use_tracking (
FOR /F %%G IN (%username%-use_tracking) DO set /A uses=%%G+1
:: THE PROBLEM IS BELOW
echo %uses% > %username%-use_tracking
cd ..
)

if not exist %username%-use_tracking (
echo 1 > %username%-use_tracking
cd ..
) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T05:36:26.800

当文件已经存在时，您的代码将失败，因为您正在设置一个变量值，然后在同一个带括号的代码块中访问该值；`%uses%`解析行时展开，一次性解析整个代码块。因此，您要回显的值是执行 FOR 循环之前存在的值 - 不是您想要的。

您可以通过使用 启用延迟扩展`setlocal enableDelayedExpansion`，然后使用`!uses!`而不是`%uses%`. `help set`从命令提示符键入以获取更多信息。*从“最后，添加了对延迟环境变量扩展的支持......”*开始的段落开始阅读，大约在帮助进行到一半的时候。

但是有一种更简单的方法可以避免延迟扩展的需要。您只需在 IF 块内设置值。您可以稍后在 IF 块之外访问它。

您目前正在避免另一个问题，但您应该注意：`1>filename`并`>filename`做同样的事情 - 它们是将标准输出（stdout）重定向到文件的指令。1 是标准输出的 id，当没有明确给出数字时，它是默认值。`2>filename`将标准错误 (stderr) 重定向到文件。您避免将数字解释为流 id，因为数字和`>`. 但是，如果您不小心，总有一天您会没有空格，并且对为什么没有打印数字感到困惑。您可以通过将重定向放在前面而不是末尾来避免这个问题。`>filename echo %uses%`

所以这是一个完整的工作解决方案。

```
@echo off
setlocal
if not exist statistic_files mkdir statistic_files
cd statistic_files
set "file=%username%-use_tracking"

set "uses=1"
if exist %file% for /f %%G IN (%file%) do set /A uses=%%G+1
>%file% echo %uses% 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T05:30:06.893

您的问题与延迟变量扩展直接相关。要解决它，请在程序的开头插入这一行：

```
setlocal EnableDelayedExpansion 
```

*并将在 IF 块中修改*的变量用感叹号而不是百分比括起来：

```
echo !uses! > %username%-use_tracking 
```

更多详情，请在本论坛中搜索“延迟扩展”；关于这个话题有很多答案，比如这个：

[在for语句中将变量设置为另一个变量](https://stackoverflow.com/questions/9837318/set-the-variable-to-another-variable-in-the-for-statement/9857943#9857943)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-28T02:36:34.950

测试您当前的文件（只需删除顶部创建文件夹的块，以便它输出到我的当前目录，两`cd ..`行，并`set username=ken`在顶部添加）产生：

*   第一次正确的内容（单行`1`）。
*   第二次包含单行的文件`ECHO is on`。
*   第三次报错。

你得到那个输出是因为`ECHO`打开了，第二次运行是`ECHO`设置第二次运行批处理文件。

您需要`echo`在批处理文件的顶部关闭。（这不会阻止使用该`echo`命令；它只是阻止您的批处理文件本身被输出。）

这对我有用（进行我上面提到的更改）：

```
@echo off
set username=ken

if exist %username%-use_tracking (
FOR /F %%G IN (%username%-use_tracking) DO set /A uses=%%G+1
:: THE PROBLEM IS BELOW
echo %uses% > %username%-use_tracking
)

if not exist %username%-use_tracking (
echo 1 > %username%-use_tracking
) 
```

结果是：

*   第一次正确的内容（单行`1`）。
*   第二次包含单行的文件`2`。
*   `3`第三次包含单行的文件。（等等更多的运行。）

如果您想保留文件中的每一行，请将第一行更改`echo %uses% > %username%-use_tracking`为`echo %uses% > %username%-use_tracking`（注意 double `>>`）。一种`>`表示覆盖，两种表示附加到当前内容的末尾。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-28T02:29:40.810

你用单`>`

IE。：`echo "Bla" > file.xyz`

single`>`只是覆盖文件中的任何内容

尝试`>>`

```
echo "Blabla" >> file.xyz 
```

double `>>`在文件末尾追加内容

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-28T14:22:46.227

好的，我已经意识到 for 命令以一种奇怪的方式影响变量，我必须使用延迟扩展。感谢大家陈述这些。我已经设法让它正常工作，正是我想要的，这里是：

```
@echo off
setlocal EnableDelayedExpansion

if not exist statistic_files (
mkdir statistic_files
cd statistic_files
goto skip
)
cd statistic_files
:skip
set "file=%username%-use_tracking"
set "uses=1"

if not exist %file% (
>%file% echo 1
cd ..
)
if exist %file% (
for /f %%G IN (%file%) do set /A uses=%%G+1
>%file% echo !uses!
cd ..
) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-28T06:34:47.923

1.  使用`>>`而不是`>`重定向（附加模式）。
2.  如果要更改其间的目录，请使用日志文件的绝对路径，而不是相对路径。

# javascript - 通过ajax创建的html调用时，javascript替换方法不适用于innerHTML

> ID：14063794
> 
> 赞同：0
> 
> 时间：2012-12-28T02:21:35.297
> 
> 标签：javascript, replace

我现在花了几天时间尝试在 javascript 中调试一个简单的替换，这让我发疯。将不胜感激任何帮助。

当我在标题中创建一个带有 javascript 函数的简单 html 文件并在正文中调用函数时，我可以获取元素的内容并使用替换方法替换 innerHTML 的某些字符，例如换行符。我也可以用 jsfiddle 做到这一点。

```
toedit = toedit.replace(/\n/g, '<br />'); 
```

但是，在我想使用它的实际应用程序中，脚本位于页面的标题中，而 html 通过一些 ajax 放置在页面上的 div 中，它失败了。谁能发现问题？

以下适用于 HTML 页面或 JSFiddle

```
<html>
    <head>
    <script type="text/javascript">
    function editText(editThis)
      {
    alert(editThis);
    //alert("hi");
    var toedit = document.getElementById(editThis).innerHTML;
 //       alert(toedit);
    toedit = toedit.replace(/\n/g, '<br />');
    alert(toedit);
      }
    </script>
    </head>
    <body>
    <textarea id="text" name="text" rows=9 cols=30 placeholder="Type Notes">A whole bunch
     of text with
     line breaks goes here</textarea><a href="#" onclick="editText('text');return false;">edit</a>
    </body>
    </html> 
```

以下脚本不会在 id 旁边有 * 的行中运行。是否适用于删除该行。仅注释掉行时脚本中断。

在页眉中：

```
 <script type="text/javascript">
    function editText(editThis)
      {
         alert(editThis);
         //alert("hi");
         var toedit = document.getElementById(editThis).innerHTML;
         alert(toedit);
         toedit = toedit.replace(/\n/g, '<br />'); //****problem line
         alert(toedit);
      }
    </script> 
```

//从页面调用的以下函数，用包含指向上述js的链接的html填充div

```
function loadSteps(id) 
{
var xmlhttp;
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    document.getElementById("stepsDiv").innerHTML=xmlhttp.responseText;
    }
  }
xmlhttp.open("GET","getsteps.php?id="+id,true);
xmlhttp.send();
} //end function 
```

从上面的js函数调用getsteps.php

```
echo '<textarea id="text" rows=9 cols=30 placeholder="Type text">'.$text.'</textarea><a href="#" onclick="editText(\'text\');return false">edit</a> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T03:22:48.037

您的问题在于以下行：

```
var toedit = document.getElementById(editThis).innerHTML; 
```

您正在抓取 DOM 对象的 innerHTML，即 id 为“text”的文本区域。此对象的 innerHTML 尚未更新。相反，您需要的是文本区域的**值**，它将为您提供在文本区域中键入的实际文本。将上述行更改为以下内容：

```
var toedit = document.getElementById(editThis).value; 
```

那应该可以解决您的问题！快乐编码！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T03:05:13.890

您正在设置一个变量，它是 innerHTML 的副本，您需要直接更新 innerHTML

```
 document.getElementById(editThis).innerHTML=toedit;//once you've done your replace 
```

但是为什么在进行
替换之前在 onreadystatechange 中设置 innerHTML(/\n/g, '
')

一旦它在 HTML 中，它可能不会保留换行符。

```
.responseText.replace(/\n/g, '<br />') 
```

或者

```
.responseText.replace(/\r\n/g, '<br />') 
```

# javascript - https://www.google-analytics.com/ga.js 和 https://ssl.google-analytics.com/ga.js 有什么区别？

> ID：14063798
> 
> 赞同：3
> 
> 时间：2012-12-28T02:21:57.730
> 
> 标签：javascript, optimization, google-analytics

我正在优化我的[外部 Google Analytics 脚本](http://git.io/ga-ext)，现在我想知道：

`https://www.google-analytics.com/ga.js`和有区别`https://ssl.google-analytics.com/ga.js`吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-28T02:25:04.780

不，`ssl.google-analytics.com`只是一面镜子`www.google-analytics.com`。唯一的区别是，如果您从 HTTP 连接，Google Chrome 会重定向`ssl.google-analytics.com`到。`https://`

# web-applications - 如何知道 JBoss 的加载过程是否成功完成？

> ID：14063800
> 
> 赞同：0
> 
> 时间：2012-12-28T02:22:10.200
> 
> 标签：web-applications, jboss, war

All.在我的软件部署中，我的JBoss部署了很多war，版本是4.2.3.GA。

我曾经想过一个解决方案，在某场战争中添加一个 http 服务，它只是返回

`true/false`表示整个加载完成。

但我不能确定是否可以在加载序列结束时加载这场战争。所以我希望有人可以

告诉我是否有可能改变集装箱中的战争装载顺序。我也不确定我是

以正确的方式修复它。

如果我错过了什么或走错了路，请告诉我。

我会很感激的。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T20:00:32.853

jboss 根据目录顺序部署战争 - 所以如果你 ls 你的部署目录，那将是部署顺序。据我所知，更改该顺序的唯一方法是重命名工件，有两种方法可以做到这一点，按简单的字母顺序（不要忘记爆炸的战争将首先部署）或重命名它们并取消注释 PrefixDeploymentSorter 属性在 conf/jboss-service.xml 中（我认为这在版本 5 中不可用）。我自己没有这样做，但是在[这篇](https://stackoverflow.com/questions/2515235/can-i-make-a-war-depend-on-a-jndi-entry-in-jboss-5-1)文章中有人成功地在 jboss5 中使用它，也许它可以适应在 jboss4 中工作而无需重命名。

# javascript - jQuery - 如果未禁用，则仅选择元素

> ID：14063806
> 
> 赞同：2
> 
> 时间：2012-12-28T02:23:28.000
> 
> 标签：javascript, jquery, checkbox

以下代码将遍历一组给定的复选框并将`checked`属性设置为 false：

```
function select_none_com(){
$("[name=file_com_appeal].com-checkbox").each( function() {   
    $(this).attr('checked', false);
});     
} 
```

我想修改此代码，使其仅适用于未禁用的复选框。（某些`com-checkbox`元素已启用，而其他元素未启用）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-28T02:24:59.837

像这样？

```
function select_none_com(){
  $("[name=file_com_appeal].com-checkbox:not(:disabled)").each( function() {   
    $(this).attr('checked', false);
  });     
} 
```

# c++ - QApplication::sendEvent() 到 QListView 崩溃应用程序

> ID：14063808
> 
> 赞同：3
> 
> 时间：2012-12-28T02:23:54.957
> 
> 标签：c++, qt, qt5

通过 QApplication::sendEvent() 向 QListView 发送事件时，我的应用程序崩溃。

```
void MyQWidget::keyPressEvent(QKeyEvent * event)
{
    if (event->key() == Qt::Key_Up || event->key() == Qt::Key_Down) {
        QApplication::sendEvent(this->view,event);  // this.view being the QListView
    }

    QWidget::keyPressEvent(event);
} 
```

有人知道原因吗？

# html - 删除奇怪的空间

> ID：14063820
> 
> 赞同：4
> 
> 时间：2012-12-28T02:25:09.327
> 
> 标签：html, css

**问题：**

我如何摆脱第一张图片中显示的空间？

**更多信息和代码：**

我有一个我想要排列在另一个之上的联系人列表。当用户将鼠标悬停在联系人姓名上时，会弹出联系人卡片。在联系人卡片上，我想要一个电子邮件图标。

当电子邮件图标位于右上角时 - 没有问题。但是，当我添加填充以将其移动到联系人卡片的右下角时，页面首次加载时联系人姓名之间会出现一个奇怪的空格。但是，当我将鼠标悬停并出现联系人卡片后，奇怪的空间消失了，联系人列表以我希望的方式出现

这是我的代码： **html：**

```
<div id="ball">
      <div id="thisisatest" onmouseover="showIt('/images/em.png', 'tomJustice')" onmouseout="hideIt('tomJustice')" >       
            <img src="/images/bluesquare.png" height="15" width="15" ></img>     tom Justice
            <img src="" id="tomJustice" style="margin-left: auto; overflow:hidden; padding-top: 20%" onclick="showIt('/images/card22.png', 'tomJustice2')" onmouseout="hideIt('tomJustice2')">
            <img src="" id="tomJustice2" style="display:none"></img>
            </br>
      </div>
... other contacts
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T02:51:15.780

你为什么不只是给一个

```
position:absolute; 
```

和

```
right: 0; bottom: 0; 
```

你可以只定位在一个 div 内

# javascript - 防止 JavaScript 在大循环中锁定浏览器

> ID：14063822
> 
> 赞同：7
> 
> 时间：2012-12-28T02:25:21.760
> 
> 标签：javascript, user-interface

我有一个循环需要在浏览器中运行 2 亿次。这是一个需要多人定期使用的模拟器。运行大约需要 15 分钟，但在此期间，浏览器会频繁弹出“此脚本运行时间过长”等警告，并在运行期间完全挂起 Firefox。这也意味着该页面不会更新我的状态指示器（这只是一个数字）。

我搜索了“javascript yield”并阅读了前 4 页的点击量。有些人讨论了一个新的“yield”关键字，但只有一个描述和示例，我觉得难以理解，例如“包含yield关键字的函数是一个生成器。当你调用它时，它的形参绑定到实际参数，但是它的身体实际上并没有被评估”。是否`yield`屈服于 UI？

我确实找到的少数解决方案之一是这篇旧帖子，它使用已弃用的被调用者参数和一个计时器来调用自己： [http ://www.julienlecomte.net/blog/2007/10/28/](http://www.julienlecomte.net/blog/2007/10/28/)

但是，上面的示例不包含任何循环变量或状态，当我添加它们时它会崩溃，我的最终结果始终为零。

它也不进行分块，但我发现了一些其他示例，这些示例在每次迭代中都使用“index % 100 == 0”进行分块。但是，这似乎是一种缓慢的方法。例如这个：

[如何阻止激烈的 Javascript 循环冻结浏览器](https://stackoverflow.com/questions/714942/how-to-stop-intense-javascript-loop-from-freezing-the-browser)

但它没有任何更新进度的方法，也不会屈服于 UI（所以仍然会挂起浏览器）。这是一个在执行期间挂起浏览器的测试版本：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<script>
var spins = 1000000
var chunkSize = 1000;
var chunk;
function Stats() {this.a=0};
var stats = new Stats();               
var big;

var index = 0;

var process = function() {
  for (; index < spins; index++) {
    stats.a++;
    big = (big/3.6)+ big * 1.3 * big / 2.1;
    console.write(big);
    // Perform xml processing
    if (index + 1 < spins && index % 100 == 0) {
        document.getElementById("result").innerHTML = stats.a;
        setTimeout(process, 5);
    }
  }
  document.getElementById("result").innerHTML = stats.a;
};

</script>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>
</head>

<body  onload="process()">
<div id=result>result goes here.</div>
</body>
</html> 
```

这是另一个`stats.a`总是为零的尝试（所以我认为存在一些范围问题）：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<script>
var spins = 1000000
var chunkSize = 1000;
var chunk;
function Stats() {this.a=0};
var stats = new Stats();               

function doIt() {
    function spin() {
       for (spinIx=0; (spinIx<chunkSize) && (spinIx+chunk < spins); spinIx++) {
           stats.a++;
       }
    }        

    for (chunk =0; chunk < spins; chunk+=chunkSize){
        setTimeout(spin, 5);
            document.getElementById("result").innerHTML = stats.a;
        }
      document.getElementById("result").innerHTML = stats.a;
}

</script>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>
</head>

<body  onload="doIt()">
<div id=result>result goes here.</div>
</body>
</html> 
```

我花了 48 个小时试图让这个工作——要么我很笨，要么这很难。有任何想法吗？

有几个人建议使用网络工作者。我尝试了几天让他工作，但我找不到一个类似的例子，它传递了一个数字等。下面的代码是我最后一次尝试让它工作，但是当它应该是 100000 时结果总是 0。即它失败了就像我上面的第二个例子失败一样。

spinMaster.html：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
</head>
<body>
<script>
if(typeof(Worker)==="undefined") {
  document.write("<h1>sorry, your browser doesnt support web workers, please use firefox, opera, chorme or safari</h1>");
  } 
var worker =new Worker("spinWorker.js");

worker.postMessage({times:1000000});

worker.onmessage=function(event){
document.getElementById("result").innerHTML=event.data;
}; 
</script>

<div id="result">result goes here</div>
</body>
</html> 
```

spinWorker.js

```
function State() {
    this.a=0;
}

var state = new State();

self.addEventListener('message', spin, false);

function spin(e) {
    var times, i;

    times = e.data.times;
//times = 1000000; // this doesnt work either.

    for(i;i<times;i++) {
        state.a++;
    }

    self.postMessage(state.a);
} 
```

结果输出：0

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-28T02:42:40.337

网络工作者听起来是更好的解决方案。

我写得很快，所以我不知道它是否会起作用。性能会很差...

编辑：更改为与海报相同的格式。经过测试

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<script>
    var spins = 1000000
    var chunkSize = 1000;
    var chunk;
    function Stats() {this.a=0};
    var stats = new Stats();        
    var big = 0.0;

    var index = 0;

    function workLoop() {

        index += 1;

        stats.a++;
        big = (big/3.6)+ big * 1.3 * big / 2.1;
        console.log(big);
        // Perform xml processing
        document.getElementById('result').innerHTML = stats.a;
        if (index < spins) {
            setTimeout(workLoop, 5); 
        }   

    }   

</script>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>
</head>

<body onload="workLoop()">
<div id="result">result goes here.</div>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T02:40:16.367

由于 JS 通常是单线程的，我认为没有办法解决它。但是，如果您只支持较新的浏览器，您可能需要研究 web worker，它可以产生一个新线程来工作：http: [//developer.mozilla.org/en-US/docs/DOM/Using_web_workers](http://developer.mozilla.org/en-US/docs/DOM/Using_web_workers)

我能想到的唯一缺点是我读过很难调试 Web Worker，因为开发工具（Chrome 开发工具，除非运行开发通道，萤火虫）不支持对其进行分析。

这是一个很好的教程，可以帮助您入门： http: [//net.tutsplus.com/tutorials/javascript-ajax/getting-started-with-web-workers/](http://net.tutsplus.com/tutorials/javascript-ajax/getting-started-with-web-workers/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-28T02:57:44.490

您在第一次测试中接近了一个工作示例，但我确实看到了一个逻辑错误。在您的 if() 中，您需要从函数返回，否则它将始终运行多个竞争该线程的函数。

```
var process = function() {
  for (; index < spins; index++) {
    stats.a++;
    big = (big/3.6)+ big * 1.3 * big / 2.1;
    console.write(big);
    // Perform xml processing
    if (index + 1 < spins && index % 100 == 0) {

document.getElementById("result").innerHTML = stats.a;
        setTimeout(process, 5);
        //!!!!!
        return;//without this it'll keep iterating through the for loop without waiting for the next 5ms
        //!!!!!
    }
  }

document.getElementById("result").innerHTML = stats.a;
}; 
```

两个样本都不会等待下一个 setTimeout （在您的第二个示例中，您将继续迭代您的 for 循环，直到 for 循环完成，但在每个块大小您为后续迭代设置超时。所有这些都是延迟整个序列持续 5 毫秒，从你的 for 循环开始迭代起，它们仍然会堆积并执行 5 毫秒）

总而言之，您似乎走在了正确的轨道上，两个示例中都只有很小的逻辑错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-06T18:43:54.863

github 上有一个库可用于这种类型的大循环，无需锁定浏览器/线程，也无需使用 web-workers。

有点实验性，并支持大递归循环，但它可能对你有用。依赖 q.js 来解决 Promise。

[https://github.com/sterpe/stackless.js](https://github.com/sterpe/stackless.js)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-12-28T02:45:46.593

这应该做你想要的：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<script>
var spins = 1000000
var chunkSize = 1000;
var stats = {a:0,spins:0};              

function doIt() {
    for (var chunk = 0; chunk < chunkSize; chunk++) {
        stats.a++;
    }
    document.getElementById("result").innerHTML = stats.a;
    if(++stats.spins < spins) setTimeout(doIt,5);

}

</script>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>
</head>

<body  onload="doIt()">
<div id=result>result goes here.</div>
</body>
</html> 
```

# html - 一页网站 - 按钮 .show 和 .hide 文本但如何链接到特定的“页面”？

> ID：14063827
> 
> 赞同：1
> 
> 时间：2012-12-28T02:26:03.467
> 
> 标签：html, css, button, hyperlink

我制作了一个单页网站，上面只有文本和按钮，其唯一目的是更改容器中的文本。现在，当我完成所有内容时，我忘记了如果有人想链接到我的网站的特定“页面”/文本怎么办。最好的方法是什么？因此，当有人单击按钮时，每个段落的地址都会更改，如果有人指向该地址，特定段落将出现/特定按钮功能将完成其工作。

这是按钮的 jquery 代码，因此您可以更好地理解：

```
$(document).ready(function () { 
    $('[id*=txt]').hide();              
    $('[id*=home]').show();
    $('#btnhome').css({'background-color':'#555', 'opacity':"0.5"});    

    $('.button').click(function (){
        $('[id*=txt]').hide();
        $('.button').css({'background':'transparent', 'opacity':'1'});
        $(this).css({'background-color':'#555', 'opacity':'0.5'});
   });          

    $('#btnhome').click(function () {   
        $('[id*=home]').show();             
    });     

    $('#btnabout').click(function () {              
        $('[id*=about]').show();        
    });    

    $('#btncontact').click(function () {        
        $('[id*=contact]').show();  
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T02:38:47.250

您必须在 URL 中添加一个参数。像`http://mysite.com?page=1`

然后你必须解析出参数。[这是一个可以帮助您的网站](http://jquery-howto.blogspot.com/2009/09/get-url-parameters-values-with-jquery.html)。

最后，您将在函数中提供`page`参数`document.ready`。您可以为此使用[switch 语句](http://www.w3schools.com/js/js_switch.asp)。

# python - 在python的堆模块中合并元组

> ID：14063828
> 
> 赞同：3
> 
> 时间：2012-12-28T02:26:03.803
> 
> 标签：python

我想知道`heap.merge()`. 合并元组列表时，heapq.merge() 如何决定顺序？

我得到了两个列表，每个列表都有一个 3 元组，

```
A = [(a, b, c)]
B = [(x, y, z)] 
```

其中 3 元组的类型为`(int, int, str)`。我想合并这两个列表。我正在使用`heapq.merge()`操作，因为它高效且针对大型列表进行了优化。A 和 B 可以包含数百万个三元组。

是否保证`heap.merge()`会在给定两个元组的情况下输出一个订单，

```
a >= x and b >= y and c >= z? 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T02:42:12.980

Python 按[字典顺序](http://docs.python.org/2/tutorial/datastructures.html#comparing-sequences-and-other-types)对元组进行排序：

> 首先比较前两项，如果它们不同，则确定比较的结果；如果它们相等，则比较接下来的两项，依此类推，直到任一序列用完。

* * *

举个例子，

```
In [33]: import heapq    
In [34]: A = [(1,100,2)]    
In [35]: B = [(2,0,0)]

In [40]: list(heapq.merge(A,B))
Out[40]: [(1, 100, 2), (2, 0, 0)]

In [41]: (1, 100, 2) < (2, 0, 0)
Out[41]: True 
```

因此，不一定正确

```
a >= x and b >= y and c >= z 
```

* * *

可以`heapq`在任何可排序对象集合上使用，包括自定义类的实例。使用自定义类，您可以安排任何您喜欢的排序规则。例如，

```
class MyTuple(tuple):
    def __lt__(self, other):
        return all(a < b for a, b in zip(self, other))
    def __eq__(self, other):
        return (len(self) == len(other)
                and all(a == b for a, b in zip(self, other)))
    def __gt__(self, other):
        return not (self < other or self == other)            
    def __le__(self, other):
        return self < other or self == other
    def __ge__(self, other):
        return not self < other

A = [MyTuple((1,100,2))]
B = [MyTuple((2,0,0))]
print(list(heapq.merge(A,B)))
# [(2, 0, 0), (1, 100, 2)] 
```

但是请注意，尽管这改变了我们对`<`for的概念`MyTuple`，但不能保证返回的结果`heapq.merge`满足

```
a <= x and b <= y and c <= z 
```

为此，我们必须首先删除所有相互不可排序的项目`A`。`B`

# drawimage - 使用 drawImage 绘制一个填充的矩形

> ID：14063829
> 
> 赞同：1
> 
> 时间：2012-12-28T02:26:47.797
> 
> 标签：drawimage

如果我想画一个填充的矩形，我可以做

```
g.fillRect(0, 0, 100, 100) 
```

但是如果我想用drawImage绘制同样的填充矩形，我该怎么办？我尝试了以下方法：

```
g.drawImage(null, 0,0,100, 100, Color.BLACK, null); 
```

它不起作用。我不打算使用图像，但图像必须仍然是非空的吗？这样做的正确方法是什么？

# android - 如何使用 USB On The Go 来安装 USB 驱动器而无需生根？

> ID：14063836
> 
> 赞同：3
> 
> 时间：2012-12-28T02:28:03.520
> 
> 标签：android

已经有一个 Nexus Media Importer 应用程序，但我想确定如何为自己做这件事，作为了解协议的一种方式。我将如何开始？我需要做什么？

我浏览了 AndroidDevelopers 指南的 USB 主机部分，但无法确定如何浏览 USB 设备本身上的文件夹或文件。

我的目标设备是 Android 4.2 上的 Nexus 7，如果有帮助的话。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T04:31:23.427

我没有在我的 Nexus 7 上完成主机模式，但在我的华硕上，USB 驱动器只会安装`/mnt/usbdisk_1`或类似的。只是看看，`/mnt`看看你发现了什么。

# javascript - 防止控制器中的文本提交失败

> ID：14063840
> 
> 赞同：1
> 
> 时间：2012-12-28T02:29:13.990
> 
> 标签：javascript, html, forms, angularjs

我正在 Angular 的主页上运行一个简单的示例，其中涉及一个待办事项列表。我想阻止用户在输入字段为空白时提交待办事项。问题是当我加载页面时，我要做的第一件事是在输入字段内单击并按 Enter，然后将空白待办事项添加到待办事项列表中。但是，之后验证工作。我知道还有其他方法可以做到这一点，但我想知道为什么存在这个错误以及如何修复它。

我的html下面

```
<form ng-submit="addTodo()">
  <input ng-model="todoText" placeholder="Add a todo here" type="text" />
  <input class="button" type="submit" value="add">
</form> 
```

我的.js文件

```
$scope.addTodo = function() {
  var text = $scope.todoText;
  if (text != "") {
    $scope.todos.push({text:$scope.todoText, done:false});
    $scope.todoText = '';
  }
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T02:47:08.307

`$scope.todoText`是`undefined`，所以它通过你的条件，然后设置为空字符串`''`，基于你的模型的变量

要么做`if (!$scope.todoText) {`，要么将其初始化为空字符串`$scope.todoText = '';`

在控制器中：

```
$scope.todoText = '';

$scope.addTodo = function() {
  if ($scope.todoText != "") {
    $scope.todos.push({text:$scope.todoText, done:false});
    $scope.todoText = '';
  }
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T11:10:16.153

您是否尝试过`required`在输入中使用该属性？

```
<input type="text"
       ng-model="todoText"
       required <------------- prevents submission and marks the view as invalid
       size="30"
       placeholder="add new todo here" /> 
```

试试[http://jsfiddle.net/hbulhoes/uBXfN/](http://jsfiddle.net/hbulhoes/uBXfN/)

# c# - 如何将多个文件添加到播放列表

> ID：14063843
> 
> 赞同：7
> 
> 时间：2012-12-28T02:29:25.943
> 
> 标签：c#, playlist, windows-media-player, axwindowsmediaplayer

我有一个`OpenFileDialog`具有`Multiselect = true`. 现在我想将每个文件添加到 Windows 媒体播放器播放列表，但我不知道如何做到这一点，并且互联网上没有很好的例子。

```
if (ofdSong.ShowDialog() == DialogResult.OK)
{
    foreach (string file in ofdSong.FileNames)
    {
        //Code to add file to the playlist
    }
} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-28T02:59:15.373

在给我示例链接的[DJ KRAZE](https://stackoverflow.com/users/955076/dj-kraze)[和](https://stackoverflow.com/users/65403/jayjay)编写该示例的 JayJay 的帮助下，这里是解决方案。

```
WMPLib.IWMPPlaylist playlist = wmp.playlistCollection.newPlaylist("myplaylist");
WMPLib.IWMPMedia media;
if (ofdSong.ShowDialog() == DialogResult.OK)
{
    foreach (string file in ofdSong.FileNames)
    {
        media = wmp.newMedia(file);
        playlist.appendItem(media);
    }
}
wmp.currentPlaylist = playlist;
wmp.Ctlcontrols.play(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-05-04T05:23:36.127

```
private void openToolStripMenuItem_Click(object sender, EventArgs e)
{
  var myPlayList =  axWindowsMediaPlayer1.playlistCollection.newPlaylist("MyPlayList");
  OpenFileDialog open = new OpenFileDialog();
  open.Multiselect =true;
  open.Filter = "All Files|*.*";

  if(open.ShowDialog() == System.Windows.Forms.DialogResult.OK)
   {
     foreach(string file in open.FileNames)
       {
         var mediaItem = axWindowsMediaPlayer1.newMedia(file);
         myPlayList.appendItem(mediaItem);
       }
   }

  axWindowsMediaPlayer1.currentPlaylist = myPlayList;
 } 
```

播放多个项目：复制和粘贴并享受

# php - 在编码的 PHP 包含中覆盖 CSS

> ID：14063848
> 
> 赞同：0
> 
> 时间：2012-12-28T02:29:57.157
> 
> 标签：php, css, include

我买了一个离子立方编码的脚本。这是我网站上的一个文件，它是从 php 包含调用的，但文本很大，比如 38px。完全不能接受。供应商说没有办法减小这个字体大小，它来自编码文件中的 CSS。是否有某种代码可以围绕 php 包含来覆盖样式设置？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T02:39:17.820

至少可以有两种方式：

*   即时替换您想要更改的规则（`preg_replace`例如）
*   就在你插入 CSS 的地方之后，插入你自己的块

    `.your-element-class { font-size: 24px !important; }`在里面

# c# - 几次 Process.Getprocess 调用后，热键停止工作

> ID：14063852
> 
> 赞同：0
> 
> 时间：2012-12-28T02:32:03.757
> 
> 标签：c#, process, timer

我正在使用 user32.dll 中的“RegisterHotKey”注册一个热键按下热键将触发一个事件，该事件执行 Console.WriteLine("HOTKEY");

正常工作，但我遇到了一个问题，大约 5 秒后它停止工作。事件不再触发。通过注释掉，我将其缩小到 1 行代码： Process[] p = Process.GetProcessesByName("notepad"); 即获取进程名称（名称无关紧要，记事本或任何东西）

此 GetProcessesByName 在 System.Timers 计时器上每秒调用一次。就像我说的，大约 5 秒后（有时是 3 或 4 秒，它是随机的）热键停止工作。

我怎样才能解决这个问题？

下面是我正在使用的代码（[来自这个网站](http://www.liensberger.it/web/blog/?p=207)）

问题可能与 RegisterHotKey 的第一个参数有关吗？（一个 HWND）我必须有一个活跃的表格来注册热键吗？

```
 public class HotkeyController {

    public HotkeyController() {
        KeyboardHook k = new KeyboardHook();
        k.RegisterHotKey(0, Keys.Subtract);
        k.KeyPressed += new EventHandler<KeyPressedEventArgs>(k_KeyPressed);
    }

    void k_KeyPressed(object sender, KeyPressedEventArgs e) {
        Console.WriteLine("HOTKEY");
    }
}

public sealed class KeyboardHook : IDisposable {
    // Registers a hot key with Windows.
    [DllImport("user32.dll")]
    private static extern bool RegisterHotKey(IntPtr hWnd, int id, uint fsModifiers, uint vk);
    // Unregisters the hot key with Windows.
    [DllImport("user32.dll")]
    private static extern bool UnregisterHotKey(IntPtr hWnd, int id);
    /// <summary>
    /// Represents the window that is used internally to get the messages.
    /// </summary>
    private class Window : NativeWindow, IDisposable {
        private static int WM_HOTKEY = 0x0312;

        public Window() {
            // create the handle for the window.
            this.CreateHandle(new CreateParams());
        }

        /// <summary>
        /// Overridden to get the notifications.
        /// </summary>
        /// <param name="m"></param>
        protected override void WndProc(ref Message m) {
            base.WndProc(ref m);

            // check if we got a hot key pressed.
            if (m.Msg == WM_HOTKEY) {
                // get the keys.
                Keys key = (Keys)(((int)m.LParam >> 16) & 0xFFFF);
                ModifierKeys modifier = (ModifierKeys)((int)m.LParam & 0xFFFF);

                // invoke the event to notify the parent.
                if (KeyPressed != null)
                    KeyPressed(this, new KeyPressedEventArgs(modifier, key));
            }
        }

        public event EventHandler<KeyPressedEventArgs> KeyPressed;

        #region IDisposable Members

        public void Dispose() {
            this.DestroyHandle();
        }

        #endregion
    }

    private Window _window = new Window();
    private int _currentId;

    public KeyboardHook() {
        // register the event of the inner native window.
        _window.KeyPressed += delegate(object sender, KeyPressedEventArgs args) {
            if (KeyPressed != null)
                KeyPressed(this, args);
        };
    }

    /// <summary>
    /// Registers a hot key in the system.
    /// </summary>
    /// <param name="modifier">The modifiers that are associated with the hot key.</param>
    /// <param name="key">The key itself that is associated with the hot key.</param>
    public void RegisterHotKey(ModifierKeys modifier, Keys key) {
        // increment the counter.
        _currentId = _currentId + 1;

        // register the hot key.
        if (!RegisterHotKey(_window.Handle, _currentId, (uint)modifier, (uint)key))
            throw new InvalidOperationException("Couldn’t register the hot key.");
    }

    /// <summary>
    /// A hot key has been pressed.
    /// </summary>
    public event EventHandler<KeyPressedEventArgs> KeyPressed;

    #region IDisposable Members

    public void Dispose() {
        // unregister all the registered hot keys.
        for (int i = _currentId; i > 0; i--) {
            UnregisterHotKey(_window.Handle, i);
        }

        // dispose the inner native window.
        _window.Dispose();
    }

    #endregion
}

/// <summary>
/// Event Args for the event that is fired after the hot key has been pressed.
/// </summary>
public class KeyPressedEventArgs : EventArgs {
    private ModifierKeys _modifier;
    private Keys _key;

    internal KeyPressedEventArgs(ModifierKeys modifier, Keys key) {
        _modifier = modifier;
        _key = key;
    }

    public ModifierKeys Modifier {
        get { return _modifier; }
    }

    public Keys Key {
        get { return _key; }
    }
}

/// <summary>
/// The enumeration of possible modifiers.
/// </summary>
[Flags]
public enum ModifierKeys : uint {
    Alt = 1,
    Control = 2,
    Shift = 4,
    Win = 8
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T11:28:35.800

谢谢亚历克斯，你给了我一个想法，让我用一个表格（就像我过去使用的那样）来尝试这个，现在它工作得很好。

在我发布的代码中，它制作了一个这样的窗口（这是什么以及它与表单有何不同？） `private Window _window = new Window();`

也许`Process.GetProcesses`找到这个“窗口”并杀死它？从而阻止热键工作？谁知道？？我不是大师...

无论如何，我可以制作一个看不见的形式，这已经足够了。

这是我正在使用的“热键表单”代码：

```
public partial class HotkeyForm : Form {
    public HotkeyForm() {
        InitializeComponent();

        RegisterHotKey(this.Handle, 0, 0, (int)Keys.Subtract);

    }

    protected override void WndProc(ref Message m) {
        if (m.Msg == 0x0312) {
            switch (m.WParam.ToInt32()) {
                case 0: //numpad minus.
                    //Environment.Exit(0);
                    Console.WriteLine("FORM HOTKEY");
                    break;

            }

        }

        base.WndProc(ref m);
    }

} 
```

# .net - 关于 StackOverflowException 的快速（希望）

> ID：14063853
> 
> 赞同：-1
> 
> 时间：2012-12-28T02:32:07.297
> 
> 标签：.net, vb.net, stack-overflow

我正在写一个.net 网络蜘蛛。虽然它在我的一个站点（大约 20 页）上运行良好，但它在我管理的另一个站点（大约 500 页）上用 System.StackOverflowException 轰炸。

我正在使用 8g 内存、128g hyperx ssd 且没有交换文件的 win7 64 位 i3 笔记本电脑上开发它。

我的问题是......我是否因为没有交换文件而引发了这个异常？

cpu 使用率（vs2010 调试过程）仅达到 34% 左右，内存使用率仅为 74-75m。

如果是这种情况，我如何确保它不会发生？

这是没有递归的。

代码：

```
Imports System.Reflection
Imports System.Net
Imports Superstar.Html.Linq

Public Class Downloader
Implements IDisposable

''' <summary>
''' Get the returned downloaded string
''' </summary>
''' <value></value>
''' <returns></returns>
''' <remarks></remarks>
Public ReadOnly Property ReturnString As String
    Get
        Return _StrReturn
    End Get
End Property
Private Property _StrReturn As String

''' <summary>
''' Get the returned downloaded byte array
''' </summary>
''' <value></value>
''' <returns></returns>
''' <remarks></remarks>
Public ReadOnly Property ReturnBytes As Byte()
    Get
        Return _FSReturn
    End Get
End Property
Private Property _FSReturn As Byte()

Private Property _UserAgent As String = "Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.2.13) Gecko/20101203 Firefox/3.6.13"
Private Property DataReceived As Boolean = False

''' <summary>
''' Download a string, but do not block the calling thread
''' </summary>
''' <param name="_Path"></param>
''' <remarks></remarks>
Public Sub DownloadString(ByVal _Path As String, Optional ByVal _Worker As ComponentModel.BackgroundWorker = Nothing)
    SetAllowUnsafeHeaderParsing20()
    Using wc As New Net.WebClient()
        With wc
            Dim _ct As Long = 0
            DataReceived = False
            .Headers.Add("user-agent", _UserAgent)
            .DownloadStringAsync(New System.Uri(_Path))
            AddHandler .DownloadStringCompleted, AddressOf StringDownloaded
            Do While Not DataReceived
                If _Worker IsNot Nothing Then
                    _ct += 1
                    ReportProgress(_ct, _Worker)
                End If
            Loop
        End With
    End Using
End Sub

''' <summary>
''' Download a file, but do not block the calling thread
''' </summary>
''' <param name="_Path"></param>
''' <remarks></remarks>
Public Sub DownloadFile(ByVal _Path As String, Optional ByVal _Worker As ComponentModel.BackgroundWorker = Nothing)
    SetAllowUnsafeHeaderParsing20()
    Using wc As New Net.WebClient()
        With wc
            Dim _ct As Long = 0
            DataReceived = False
            .Headers.Add("user-agent", _UserAgent)
            .DownloadDataAsync(New System.Uri(_Path))
            AddHandler .DownloadDataCompleted, AddressOf FileStreamDownload
            Do While Not DataReceived
                If _Worker IsNot Nothing Then
                    _ct += 1
                    ReportProgress(_ct, _Worker)
                End If
            Loop
        End With
    End Using
End Sub

''' <summary>
''' Download a parsable HDocument, for using HtmlToLinq
''' </summary>
''' <param name="_Path"></param>
''' <returns></returns>
''' <remarks></remarks>
Public Function DownloadHDoc(ByVal _Path As String, Optional ByVal _Worker As ComponentModel.BackgroundWorker = Nothing) As HDocument
    Try
        '
        '
        '
        '
        '
        '
        'StackOverFlowException Occurring Here!
        DownloadString(_Path, _Worker)
        Return HDocument.Parse(_StrReturn)
    Catch soex As StackOverflowException
        'put some logging in here, with the path attempted
        Return Nothing
    Catch ex As Exception
        SetAllowUnsafeHeaderParsing20()
        Return HDocument.Load(_Path)
    End Try
End Function

#Region "Internals"

Private Sub SetAllowUnsafeHeaderParsing20()
    Dim a As New System.Net.Configuration.SettingsSection
    Dim aNetAssembly As System.Reflection.Assembly = Assembly.GetAssembly(a.GetType)
    Dim aSettingsType As Type = aNetAssembly.GetType("System.Net.Configuration.SettingsSectionInternal")
    Dim args As Object() = Nothing
    Dim anInstance As Object = aSettingsType.InvokeMember("Section", BindingFlags.Static Or BindingFlags.GetProperty Or BindingFlags.NonPublic, Nothing, Nothing, args)
    Dim aUseUnsafeHeaderParsing As FieldInfo = aSettingsType.GetField("useUnsafeHeaderParsing", BindingFlags.NonPublic Or BindingFlags.Instance)
    aUseUnsafeHeaderParsing.SetValue(anInstance, True)
End Sub

Private Sub FileStreamDownload(ByVal sender As Object, ByVal e As DownloadDataCompletedEventArgs)
    If e.Cancelled = False AndAlso e.Error Is Nothing Then
        DataReceived = True
        _FSReturn = DirectCast(e.Result, Byte())
    Else
        _FSReturn = Nothing
    End If
End Sub

Private Sub StringDownloaded(ByVal sender As Object, ByVal e As DownloadStringCompletedEventArgs)
    If e.Cancelled = False AndAlso e.Error Is Nothing Then
        DataReceived = True
        _StrReturn = DirectCast(e.Result, String)
    Else
        _StrReturn = String.Empty
    End If
End Sub

#End Region

#Region "IDisposable Support"
Private disposedValue As Boolean ' To detect redundant calls

' IDisposable
Protected Overridable Sub Dispose(disposing As Boolean)
    If Not Me.disposedValue Then
        If disposing Then
        End If
        _StrReturn = String.Empty
        _FSReturn = Nothing
    End If
    Me.disposedValue = True
End Sub

Public Sub Dispose() Implements IDisposable.Dispose
    Dispose(True)
    GC.SuppressFinalize(Me)
End Sub
#End Region

End Class 
```

以及在stackoverflow发生的地方调用它的代码

```
Private Function PopulateSEOList(Optional ByVal _Worker As ComponentModel.BackgroundWorker = Nothing) As List(Of Typing.SEO)
    Dim _L = LinkList, _Ct As Long = 0
    Dim _NL As New List(Of Typing.SEO)
    Dim _EL As Typing.SEO.Elements = Nothing
    Dim _Doc As HDocument = Nothing, _Keywords As String = String.Empty, _Description As String = String.Empty, _Content As HElement = Nothing
    For i As Long = 0 To _L.Count - 1
        Try
            _Ct += 1
            Using _HDoc As New Downloader
                With _HDoc
                    _Doc = .DownloadHDoc(_L(i).SiteUrl)
                End With
            End Using
            Tasks.Parallel.Invoke(Sub()
                                      'Keywords
                                      For Each Item In _Doc.Descendants("meta")
                                          If Item.Attribute("name") = "keywords" Then
                                              _Keywords = Item.Attribute("content").Value
                                              'Exit For
                                          End If
                                      Next
                                  End Sub,
                                  Sub()
                                      'Description
                                      For Each Item In _Doc.Descendants("meta")
                                          If Item.Attribute("name") = "description" Then
                                              _Description = Item.Attribute("content").Value
                                              'Exit For
                                          End If
                                      Next
                                  End Sub,
                                  Sub()
                                      If _Doc.Descendants("body") IsNot Nothing Then
                                          _Content = _Doc.Descendants("body").FirstOrDefault
                                      End If
                                  End Sub,
                                  Sub()
                                      _EL = New Typing.SEO.Elements() With {
                                        .H1 = If(_Doc.Descendants("h1") IsNot Nothing, (From n In _Doc.Descendants("h1").AsParallel()
                                                 Select n.Value).ToList(), Nothing),
                                        .H2 = If(_Doc.Descendants("h2") IsNot Nothing, (From n In _Doc.Descendants("h2").AsParallel()
                                                 Select n.Value).ToList(), Nothing),
                                        .H3 = If(_Doc.Descendants("h3") IsNot Nothing, (From n In _Doc.Descendants("h3").AsParallel()
                                                 Select n.Value).ToList(), Nothing),
                                        .H4 = If(_Doc.Descendants("h4") IsNot Nothing, (From n In _Doc.Descendants("h4").AsParallel()
                                                 Select n.Value).ToList(), Nothing),
                                        .H5 = If(_Doc.Descendants("h5") IsNot Nothing, (From n In _Doc.Descendants("h5").AsParallel()
                                                 Select n.Value).ToList(), Nothing),
                                        .H6 = If(_Doc.Descendants("h6") IsNot Nothing, (From n In _Doc.Descendants("h6").AsParallel()
                                                 Select n.Value).ToList(), Nothing),
                                        .UL = If(_Doc.Descendants("ul") IsNot Nothing, (From n In _Doc.Descendants("ul").AsParallel()
                                                 Select n.Value).ToList(), Nothing),
                                        .OL = If(_Doc.Descendants("ol") IsNot Nothing, (From n In _Doc.Descendants("ol").AsParallel()
                                                 Select n.Value).ToList(), Nothing),
                                        .STRONG = If(_Doc.Descendants("strong") IsNot Nothing OrElse _Doc.Descendants("b") IsNot Nothing,
                                                     (From n In _Doc.Descendants("strong").AsParallel()
                                                     Select n.Value).Union(From n In _Doc.Descendants("b").AsParallel()
                                                     Select n.Value).ToList(), Nothing),
                                        .BLOCKQUOTE = If(_Doc.Descendants("blockquote") IsNot Nothing, (From n In _Doc.Descendants("blockquote").AsParallel()
                                                 Select n.Value).ToList(), Nothing),
                                        .EM = If(_Doc.Descendants("em") IsNot Nothing OrElse _Doc.Descendants("i") IsNot Nothing,
                                                 (From n In _Doc.Descendants("em").AsParallel()
                                                 Select n.Value).Union(From n In _Doc.Descendants("i").AsParallel()
                                                 Select n.Value).ToList(), Nothing),
                                        .A = If(_Doc.Descendants("a") IsNot Nothing, (From n In _Doc.Descendants("a").AsParallel()
                                            Select New Typing.SEO.Elements.Links() With {
                                                .Content = n.Value,
                                                .Title = If(n.Attribute("title") IsNot Nothing,
                                                            n.Attribute("title").Value,
                                                            Nothing),
                                                .Target = If(n.Attribute("target") IsNot Nothing,
                                                            n.Attribute("target").Value,
                                                            Nothing),
                                                .Rel = If(n.Attribute("rel") IsNot Nothing,
                                                            n.Attribute("rel").Value,
                                                            Nothing),
                                                .Href = If(n.Attribute("href") IsNot Nothing,
                                                            n.Attribute("href").Value,
                                                            Nothing)
                                            }).ToList(), Nothing),
                                        .IMG = If(_Doc.Descendants("img") IsNot Nothing,
                                                  (From n In _Doc.Descendants("img").AsParallel()
                                                   Select New Typing.SEO.Elements.Images() With {
                                                       .Alt = If(n.Attribute("alt") IsNot Nothing,
                                                            n.Attribute("alt").Value,
                                                            Nothing),
                                                       .Source = If(n.Attribute("src") IsNot Nothing,
                                                            n.Attribute("src").Value,
                                                            Nothing),
                                                       .Title = If(n.Attribute("title") IsNot Nothing,
                                                            n.Attribute("title").Value,
                                                            Nothing)
                                                   }).ToList(),
                                                Nothing)
                                      }
                                  End Sub)
            _NL.Add(New Typing.SEO() With {
                    .Link = _L(i).SiteUrl,
                    .Title = _Doc.Descendants("title").First().Value,
                    .Keywords = _Keywords,
                    .Description = _Description,
                    .Content = _Content,
                    .ContentElements = _EL
                })
            _L.RemoveAt(i)
            _EL = Nothing : _Doc = Nothing
            ReportProgress((_Ct / _L.Count) * 100, _Worker)
        Catch ex As Exception
            'Put logging in here
        End Try
    Next
    Return _NL
End Function 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T02:39:15.730

您可能知道，此错误很可能是由于代码中的错误导致递归算法中的无限循环。尽管您说您不使用递归，但您可能无意中发生了递归。

找出原因的最简单方法是附加调试器，配置 Visual Studio 以中断异常，并在应用程序中触发错误。

当错误发生并且调试器中断时，请查看调用堆栈 - 希望您会看到问题所在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T02:39:46.353

我的猜测是可能是软件问题。StackOverflowException 通常在递归算法出现问题时发生（尽管您提到您不使用一个）。另一个常见的原因是属性实现或相等比较中的错误。例如：

```
public string Name
{
  set
  {
    Name = value;
  }
} 
```

# chef-infra - 无法访问子菜谱属性文件中默认厨师菜谱的属性

> ID：14063856
> 
> 赞同：4
> 
> 时间：2012-12-28T02:33:01.183
> 
> 标签：chef-infra, vagrant, cubrid

我的[cubrid](https://github.com/kadishmal/cubrid-chef)食谱中有几个食谱，我用它们在 Vagrant 盒子上安装[CUBRID 数据库。](http://www.cubrid.org)每个配方都有自己的属性文件。例如：

```
# attributes/default.rb for recipe/default.rb
default['cubrid']['home'] = "/opt/cubrid" 
```

然后：

```
# attributes/demodb.rb for recipe/demodb.rb
set['cubrid']['demodb_dir'] = "#{node['cubrid']['home']}/databases/demodb" 
```

然后在我的*recipe/demodb.rb*我指的是它的属性，如：

```
include_recipe "cubrid"

CUBRID_DEMODB_DIR = "#{node['cubrid']['demodb_dir']}"

# create a "demodb" directory if it doesn't exist
directory "#{CUBRID_DEMODB_DIR}" do
  user "vagrant"
  action :create
  not_if "test -d #{CUBRID_DEMODB_DIR}"
end 
```

以上应创建**/opt/cubrid/databases/demodb**目录。但它失败了，因为它试图创建**/databases/demodb**目录，这意味着**#{node['cubrid']['home']}**没有设置。

**如何正确引用父属性文件中设置的属性？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-28T09:25:47.633

查看[Chef Wiki](http://wiki.opscode.com/display/chef/Attributes+Cookbook) => **Cookbook 属性文件排序**

利用

```
include_attribute 'cubrid' 
```

在你的属性/demodb.rb

# java - ConcurrentHashSet 对 HashSet 谁的性能更好？

> ID：14063858
> 
> 赞同：0
> 
> 时间：2012-12-28T02:33:14.317
> 
> 标签：java

ConcurrentHashSet 与 HashSet 在并发环境下谁的性能更好？

```
//package com.google.code.yanf4j.util;

import java.io.Serializable;
import java.util.AbstractSet;
import java.util.Collection;
import java.util.Iterator;
import java.util.Map;
import java.util.Set;
import java.util.concurrent.ConcurrentHashMap;
import java.util.concurrent.ConcurrentMap;

/**
 * A {@link ConcurrentHashMap}-backed {@link Set}.
 * 
 * @author The Apache MINA Project (dev@mina.apache.org)
 * @version $Rev: 597692 $, $Date: 2007-11-23 08:56:32 -0700 (Fri, 23 Nov 2007)
 *          $
 */
public class ConcurrentHashSet<E> extends MapBackedSet<E> {

  private static final long serialVersionUID = 8518578988740277828L;

  public ConcurrentHashSet() {
    super(new ConcurrentHashMap<E, Boolean>());
  }

  public ConcurrentHashSet(Collection<E> c) {
    super(new ConcurrentHashMap<E, Boolean>(), c);
  }

  @Override
  public boolean add(E o) {
    Boolean answer = ((ConcurrentMap<E, Boolean>) map).putIfAbsent(o,
        Boolean.TRUE);
    return answer == null;
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T02:39:05.873

在任何环境`HashSet`下的表现都会优于`ConcurrentHashSet`。当并发写入和读取开始发生时，就会出现问题。

因此，对于并发环境来说，最好的一个是`ConcurrentHashSet`.

但是，如果您使用`HashSet`用于存储仅在启动时加载的某些配置等（仅在初始写入后发生读取操作），则可以。在我看来...

# javascript - 没有线连接和笔划宽度的画布三角形

> ID：14063860
> 
> 赞同：0
> 
> 时间：2012-12-28T02:33:20.867
> 
> 标签：javascript, html, html5-canvas

我有一个圆角的三角形，但我正在使用`arcTo`：

```
context.moveTo(140, 0);
context.arcTo(180, 100, 100, 100, 4);
context.arcTo(100, 100, 140, 0, 4);
context.arcTo(140, 0, 180, 100, 4); 
```

如您所见，顶角看起来有点乱。任何想法如何解决它？似乎需要对初始值进行一些计算，`moveTo(x, y)`但`140, 0`它应该从哪里开始。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T06:11:27.730

我刚刚摆脱了`moveTo`它们并将它们相互连接起来。第一部分从 174 开始，176（180-4 半径）工作，但 174 根本没有重叠。

**[现场演示](http://jsfiddle.net/loktar/XeqTr/)**

```
​var canvas = document.getElementsByTagName("canvas")[0],
    ctx = canvas.getContext("2d");

canvas.width = canvas.height = 400;

ctx.beginPath();
ctx.arcTo(174, 100, 100, 100, 4);
ctx.arcTo(100, 100, 140, 0, 4);
ctx.arcTo(140, 0, 180, 100, 4);
ctx.arcTo(180, 100, 100, 100, 4);
ctx.stroke();
​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T17:45:51.907

这是我想出的：

```
var r = 8;
var offset = (6 * r / 4) - 1;

context.arcTo((180 - offset), 100, 100, 100, r);
context.arcTo(100, 100, 140, 0, r);
context.arcTo(140, 0, 180, 100, r);
context.arcTo(180, 100, 100, 100, r); 
```

使用 Loktar 提供的部分内容，我对其稍作修改，以使用我所知道的适用于给定直径的比率，并将其用作偏移量。直径为 4，我知道 6 个作品。

似乎应该有更好的方法，但我对此很满意。

# javascript - 用 santa.gif 在我的网页上制作新年动画 :)

> ID：14063862
> 
> 赞同：0
> 
> 时间：2012-12-28T02:33:31.617
> 
> 标签：javascript, jquery

[这](http://www.fatihtoprak.com)是我的个人网页。

我用这个 html 标签来移动 PozSanta.gif

```
<div id="animatedImage" style="position:fixed;padding-top:550px;z-index:99;left:1px;bottom:1px;">
 <img src="http://www.fatihtoprak.com/wp-content/themes/PozWhite/assets/img/Poz_Santa.gif" alt="animatedImage" />
</div>
<script type="text/javascript" src="http://www.fatihtoprak.com/wp-content/themes/PozWhite/assets/js/PozSanta.js"></script> 
```

我想为此改变一些东西，例如当 Pozsanta.gif 来到屏幕的末尾时，应该回来（从右到左）？如果是这样的话，这可能吗？

js文件：

[http://www.fatihtoprak.com/wp-content/themes/PozWhite/assets/js/PozSanta.js](http://www.fatihtoprak.com/wp-content/themes/PozWhite/assets/js/PozSanta.js)

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T04:47:15.640

这是您的代码，需要一个简单的 css 来翻转图像，无论是 gif 还是 jpg 或任何其他格式，我们总是可以将翻转应用于图像。

在这里检查你的**工作示例[小提琴](http://jsfiddle.net/842tu/1/)**

**注意：**图像将在需要时移动屏幕宽度，请复制并在您的桌面上检查

```
<!DOCTYPE html>
<html>
<style>
.left {
        -moz-transform: scaleX(-1);
        -o-transform: scaleX(-1);
        -webkit-transform: scaleX(-1);
        transform: scaleX(-1);
        filter: FlipH;
        -ms-filter: "FlipH";
}
.right {
        -moz-transform: scaleX(1);
        -o-transform: scaleX(1);
        -webkit-transform: scaleX(1);
        transform: scaleX(1);
        filter: FlipH;
        -ms-filter: "FlipH";
}

</style>
<body>
<div id="animatedImage" style="position:fixed;padding-top:550px;z-index:99;left:1px;bottom:1px;">
 <img id="img1" src="http://www.fatihtoprak.com/wp-content/themes/PozWhite/assets/img/Poz_Santa.gif" alt="animatedImage" />
</div>
<script>
var distanceBall=0; 
var directionBall=1; 
document.getElementById('animatedImage').style.top = 10;
document.getElementById('animatedImage').style.left = 10;
var timerToggle=null; 
animateBall();
var setting = 0;          

  function animateBall() {   
  document.getElementById("animatedImage").style.left=distanceBall + "px";

  distanceBall+=directionBall;

  if (distanceBall>window.screen.width - 70) { 
  document.getElementById('animatedImage').style.top = 10;
  document.getElementById('animatedImage').style.left = 10;
  directionBall = -1;
  document.getElementById('img1').className = 'left';
  }

  if (distanceBall<0) {
  directionBall = 1;
  document.getElementById('img1').className = 'right';
  }

  timerToggle=setTimeout(function() { animateBall(); },1);
  }
</script>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T02:48:16.220

在这一行添加一个额外的条件：

```
 if (0 > distanceBall && directionBall == 1) 
  { 
    directionBall=0; 
  }
  else if (distanceBall == 0 && directionBall == 0) 
  { 
    directionBall = 1; 
    distanceBall = 1;
  } 
```

然后换个方向：

```
 if (directionBall == 1) 
  { 
     distanceBall += 1;
  }
  else
  {
     distanceBall -= 1;
  } 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-28T02:50:18.503

翻转图像是一回事，当它是平面图像时，但动画 gif 是一系列图像排成一行，一个接一个地播放，如果你愿意，可以想象一个电影卷轴，然后将你的 gif 的每个动作都成像为相同的事物。所以问题不在于翻转图像，而在于翻转其中的整行图像，我很确定这是不可能的，而不是通过javascript或我能想到的任何基于服务器/客户端的语言脱手。

但是，您可以考虑的一件事是从 gif 中提取所有帧，并将它们制作成精灵样式的图像，并通过一些巧妙的脚本动画书逐帧遍历屏幕上的精灵图像。

并不是说我已经测试过这个特定的软件，而是通过谷歌提取 gif 帧的第一个结果是[http://www.addictivetips.com/windows-tips/how-to-extract-frames-from-gif-animation -image/](http://www.addictivetips.com/windows-tips/how-to-extract-frames-from-gif-animation-image/)或许可以帮助您入门。

# ipad - iPad Ibooks Javascript Canvas DrawImage 不起作用

> ID：14063864
> 
> 赞同：2
> 
> 时间：2012-12-28T02:33:49.717
> 
> 标签：ipad, canvas, epub, drawimage, ibooks

我有一个下面的脚本，它在我的 Windows 浏览器中工作。但此代码在 Epub 电子书中不起作用（在我的 iPad iBooks 中）

```
<canvas id="e" width="177" height="113"></canvas>
<script>
    var canvas = document.getElementById("e");
    var context = canvas.getContext("2d");
    var myImg = new Image();
    myImg.src = "../Images/box.jpg";
    myImg.onload = function() {
        context.drawImage(myImg, 0, 0); 
    };
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-02T04:46:11.407

对，那是正确的。似乎 iBooks 支持很多画布，但不支持 drawImage 功能。我在一两个月前将此提交给 Apple，但尚未收到关于这是错误还是预期行为的回复。可能有一些安全原因这不起作用，但考虑到它在移动 Safari 中起作用，这似乎很奇怪。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-04T01:56:59.823

*首先，向 Derrick Schultz 提出一个问题。你是如何向 Apple 提交错误报告的？*

好吧，这是我自己的发现。

**平台**：iPad iBooks。电子版。Javascript。

# 帆布。绘制图像（）函数。

不工作。即使页面“刷新”（或重新分页？通过旋转 iPad）也不会。这个解决方案是完全不行的。

以前的解决方案现在似乎是唯一的部分解决方法。

所以，是的。Canvas 和 drawImage() 在 iPad 中不起作用。

# 隐藏元素，首先呈现在屏幕上

我为我想*通过交互（Javascript）显示*的所有图像创建了元素。

**关键一步**。我确保首先在屏幕上渲染（可见）所有图像。我必须为此做一个 setTimeout() 。

*问题：什么是 iBooks 事件让我知道所有图像都在屏幕上呈现？`windows.onLoad`不起作用。即使`onLoad`对于所有单独的图像也不起作用。*

然后我隐藏（`display: none`）所有图像，并在用户输入时显示它们。

作品。

唯一的问题是不能全部显示在屏幕上的大图片（因为我必须先显示它们*）*不起作用。它们不会呈现在屏幕上。您可以通过打开`Scrolling View`iBooks 来验证这一理论。启用时`Scrolling View`，所有图像，无论多大，都可以在屏幕上呈现。

PS：*哇。Stackoverflow 不允许对答案发表评论（寻求澄清）（需要 50 声望点）。但它允许我发布答案？*

# android - 不允许将 FragmentTransaction 添加到 backstack

> ID：14063867
> 
> 赞同：2
> 
> 时间：2012-12-28T02:34:31.053
> 
> 标签：android, fragment, back-stack

我正在尝试将片段添加到后台堆栈，但它不起作用，我不断收到：`java.lang.IllegalStateException: This FragmentTransaction is not allowed to be added to the back stack.`

我正在使用 actionbar sherlock，在我的主要活动中，我收听标签

```
private class MyTabListener implements ActionBar.TabListener{

        @Override
        public void onTabSelected(Tab tab, FragmentTransaction ft){

//to hide keyboard
            final InputMethodManager imm = (InputMethodManager)getSystemService(Context.INPUT_METHOD_SERVICE);
            imm.hideSoftInputFromWindow(myView.getWindowToken(), 0);
            getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_ADJUST_RESIZE);

            if(tab.equals(tabData))
            {
                ft.setCustomAnimations(R.anim.animation_fragment_out, R.anim.animation_fragment_switch);

                ft.replace(android.R.id.content, dataFrag);
                imm.hideSoftInputFromWindow(myView.getWindowToken(), 0);
                //ft.setTransition(R.anim.animation_fragment_switch);

                curTab = tabData;
                ft.addToBackStack(null);
                //ft.commit();
                //ft.commit();

            }
            else if(tab.equals(tabComp))//new competition
            {
                ft.setCustomAnimations(R.anim.animation_fragment_out, R.anim.animation_fragment_switch);

                ft.replace(android.R.id.content, teamsFrag);

                //ft.setTransition(R.anim.animation_fragment_switch);
                //ft.commit();

                actionBar.removeTab(tabData);
                actionBar.removeTab(tabComp);
                actionBar.addTab(tabMatches);
                actionBar.addTab(tabRed);
                actionBar.addTab(tabBlue);

                curTab = tabComp;
                ft.addToBackStack(null);
            }

        }

        @Override
        public void onTabUnselected(Tab tab, FragmentTransaction ft){

        }

        @Override
        public void onTabReselected(Tab tab, FragmentTransaction ft){
        }

    } 
```

# android - 从具有多个相关条目的多个 SQL 表中检索数据

> ID：14063870
> 
> 赞同：2
> 
> 时间：2012-12-28T02:35:11.250
> 
> 标签：android, sqlite, android-sqlite

我有一个包含三个表的数据库，与外键相关：

行程：

```
ID
Number
Date 
```

天：

```
ID
TripID (Foreign key to ID column in trips)
Date
Start
End 
```

腿：

```
ID
DayID (Foreign key to ID column in days)
Origin
Destination 
```

在我的应用程序中，我有一个与每个表对应的 Trip 类、Day 类和 Leg 类。每个行程都有一个关联天的列表，每个天都有一个关联的腿列表。目前，我通过对所需行程运行查询来加载数据库中的数据。然后我运行另一个查询来获取与该旅行相关的所有日期并添加它们，然后我为每一天运行一个查询以获取相关的腿并添加它们。

在我看来，应该有一种更有效的方法来实现这一点。我唯一的其他选择是对三个表进行三重连接并获得一个游标，其中每条腿都有一行，还包含该腿的全天和行程数据？有更好的方法吗？我对 SQL 查询不太熟悉。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T02:43:41.960

加入是显而易见的答案：

```
SELECT * FOM Trips t JOIN Days d
ON t.Id = d.TripId
JOIN Legs l 
ON d.Id = l.DayId
WHERE t.Id = tripId
```

您需要替换`tripId`为您要查找的行程的 ID。一个好主意是也替换`*`为您需要返回到应用程序的实际列。

# c# - Button 的 FlatStyle 悬停时为系统，单击时为标准

> ID：14063871
> 
> 赞同：0
> 
> 时间：2012-12-28T02:35:15.970
> 
> 标签：c#, visual-studio

我见过很多表单，比如 Windows 的设置/选项表单，当鼠标悬停在按钮上时，按钮的 FlatStyle 是 System。但是当您单击按钮时，FlatStyle 会更改为 Standard。这可以在 Windows 的 Skype 选项表单的“保存”和“取消”按钮上找到。

顺便说一句，我希望代码用 C# 编写，因为我在我的项目中使用 C#。

我已经尝试了一些事情来实现这一点，但它从来没有奏效。

如果你在 Windows 上但没有 Skype，那么你可以在许多 Windows 的设置表单中找到我所说的内容——比如 Windows 的“播放设备”表单。

您还可以注意到，如果所选选项卡是按钮本身，则按钮不会发生这种情况。

必须编写代码/示例来实现这一点会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T02:54:26.237

您需要为按钮单击和 MouseHover 事件连接一个事件处理程序，如下面的代码。然后使用 FlatStyle 类来改变外观：

```
 private void button1_MouseHover(object sender, EventArgs e)
        {
            button1.FlatStyle = FlatStyle.System;
        }

        private void button1_Click(object sender, EventArgs e)
        {
            button1.FlatStyle = FlatStyle.Standard;
        } 
```

希望这对你有帮助！如果它确实将其标记为答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T05:24:21.007

你需要的是 MouseEnter 而不是 MouseHover，所以使用这个：

```
 private void button1_MouseEnter(object sender, EventArgs e)
 {
    button1.FlatStyle = FlatStyle.System;
 }

 private void button1_Down(object sender, EventArgs e)
 {
    button1.FlatStyle = FlatStyle.Standard;
 } 
```

调试：

```
 int i = 0;
 private void button1_MouseEnter(object sender, EventArgs e)
 {
    button1.FlatStyle = FlatStyle.System;
    i++;
    Console.WriteLine(i.ToString());
 }

 private void button1_Down(object sender, EventArgs e)
 {
    button1.FlatStyle = FlatStyle.Standard;
 } 
```

# php - URL 中的尾随斜杠

> ID：14063872
> 
> 赞同：1
> 
> 时间：2012-12-28T02:35:48.487
> 
> 标签：php, phalcon

因此，我一直在尝试在网上查找有关它的内容，但文档中的任何地方都没有关于 URL 中的斜杠的任何内容。这是我的问题。

我希望所有 URL 都以斜杠结尾，如果不这样做，可能会重定向它们。现在，我的代码可以使用和不使用斜杠，但是当我得到两个不同的结果时`var_dump( $this->dispatcher->getParams() );`

这是我的路线代码

```
<?php
    // for brevities sake, it's only the route

    $router->add('/:controller/:action/:id/', array(
        'controller'    => 1,
        'action'        => 2,
        'id'            => 3
    )); 
```

现在，我那里的那个斜线并没有真正做任何事情，所以我就离开了它。对于 URL **/user/view/13/**，这里是 var_dump `$this->dispatcher->getParams()`：

```
array(2) {
  [0]=>
  string(2) "13"
  [1]=>
  string(0) ""
} 
```

如果我运行 URL **/user/view/13**（不带斜杠），这是**var_dump**的 `$this->dispatcher->getParams()`：

```
array(2) {
  [0]=>
  string(2) "13"
} 
```

本质上，有没有一种方法可以让 phalcon 在斜杠处结束，以便得到相同的结果？还是我可能必须编写一个自定义路由类？任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T15:43:10.923

对于 <= 0.7.0 的版本，您可以在每个路由的正则表达式中添加可选的 /：

```
$router->add('/:controller/:action/:id[/]{0,1}', array(
    'controller'    => 1,
    'action'        => 2,
    'id'            => 3
)); 
```

注意： :id 不是 Mvc\Router 中的有效占位符，您可以使用 :int

从 0.8.0 开始，您可以启用尾部斜线的自动更正：

```
$router->removeExtraSlashes(true); 
```

# mongodb - MongoDB 中错误的 MapReduce 结果

> ID：14063875
> 
> 赞同：0
> 
> 时间：2012-12-28T02:35:56.853
> 
> 标签：mongodb, mapreduce

我有一个包含许多列的集合：col1、col2、WebsiteCode、CreatedDate、col3....、coln。

我想在 CreatedDate 范围内按 WebsiteCode 分组。

所以我这样做：

地图 ：

```
function Map() {
         var key={WebsiteCode:this.WebsiteCode};
         val={Count: 1};
         emit(key,val);
 } 
```

减少 ：

```
function Reduce(key, values) {
var res = {Total:0};
values.forEach(function(value) {
res.Total += value.Count;
});
return res;
} 
```

及查询范围DateTime：

`{ "CreatedDate" : { "$gte" : dateFrom , "$lte" : dateTo } }`

最后，我运行这个 mapreduce 命令。结果返回的结果不是我所期望的，许多行都有`Total = NaN` Ex：`{_id:{WebsiteCode:"websitecode1"}}, {value:{Total:NaN}}`

但是当我运行 count 命令时：

`db.collect.find({ "WebsiteCode" : "websitecode1", "CreatedDate" : { "$gte" : dateFrom), "$lte" : dateTo } }).count();`

结果返回：**927**

你能向我解释我做错了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T03:13:30.553

您的 reduce 函数必须返回一个与发出的值具有相同形状的值。所以你不能`Count`在 map 和`Total`reduce 中使用。

试试这个：

```
function Reduce(key, values) {
    var res = {Count:0};
    values.forEach(function(value) {
        res.Count += value.Count;
    });
    return res;
} 
```

# php - PHP - 如何检查进程是否使用多个参数运行

> ID：14063876
> 
> 赞同：1
> 
> 时间：2012-12-28T02:35:56.757
> 
> 标签：php

我知道如何检查一个进程实例是否正在运行，但我如何检查一个使用不同参数运行的特定进程，例如

```
/usr/local/bin/foo --config /home/config1.txt
/usr/local/bin/foo --config /home/config2.txt 
```

以下代码仅检查进程名称，如何检查进程是否使用特定参数运行？

```
function is_process_running ($process_name) {
    $result = array();
    exec("/sbin/pidof {$process_name}", $result);
    if(is_array($result) && isset($result[0]) && $result[0] >= 1) {
        return true; 
    }
    return false;
}

 is_process_running('/usr/local/bin/foo --config /home/config1.txt') returns true
 is_process_running('/usr/local/bin/foo --config /home/config3.txt') returns false 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T02:51:06.793

```
function is_process_running ($process_name) {
    $result = array();
    exec("ps -Af | grep {$process_name}", $result);

    // A loop that checks for your result and also checks 
    // that the result isn't the grep command called

    // ps -ax | grep firefox asdfasd
    // returns grep --color=auto firefox asdfasd

    return false;
} 
```

试试看。标志 'f' 修改输出，因此包括完整的调用。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-28T02:43:32.370

试试这个 bash 命令以获取有关进程的更多详细信息：

```
ps ax | grep YourProcesName 
```

我知道至少 java 进程应该它的参数

# python - Python中“全局”变量的意外行为

> ID：14063877
> 
> 赞同：2
> 
> 时间：2012-12-28T02:36:12.053
> 
> 标签：python

```
prev, prev_re = '', (None) # these are globals

def find(h, p='', re=None):
    print h, p, re
    #global prev, prev_re
    if p == '' and prev == h: return prev_re
    prev, prev_re = h, re
    return re
print find ("abc") 
```

导致此错误：

```
 if p == '' and prev == h: return prev_re
UnboundLocalError: local variable 'prev' referenced before assignment
$ 
```

**但**如果我评论前最后一行`find`，

```
prev, prev_re = '', (None)

def find(h, p='', re=None):
    print h, p, re
    #global prev, prev_re
    if p == '' and prev == h: return prev_re
    #prev, prev_re = h, re
    return re
print find ("abc") 
```

代码按预期正确运行，没有错误。

我的问题是为什么在第一种情况下它没有找到全局变量 `prev`，为什么在第二种情况下它确实在`if`-condition 中找到了全局变量？

编辑：请帮助我了解环境结构的详细信息，以了解解释器为什么找不到变量。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-28T02:47:15.260

## 问题与解决方案

正如 MAK 所提到的，`prev`被视为本地，因为您为其分配了值（在您检查值之后）。解决方案是将这两个变量显式声明为全局变量：

```
prev, prev_re = '', (None) # these are globals

def find(h, p='', re=None):
    global prev, prev_re
    print h, p, re
    #global prev, prev_re  # basically what you have done before commenting this
    if p == '' and prev == h: return prev_re
    prev, prev_re = h, re
    return re
print find ("abc") 
```

## 回答您的问题

> 为什么在第一种情况下它没有找到全局变量 prev

它找到了它，但随后它找到了之前没有`global`声明的赋值。因此，该变量被视为*local*。取消注释该行，`global`它将被修复。或者使用不同的变量进行局部赋值。您还可以将值保存为函数的属性（函数也是对象！）。

> 为什么在第二种情况下它确实在 if 条件中找到了全局变量

它将它视为全局（因为您只读取它并且没有在函数中定义它，因此它不会被局部变量遮蔽）。

## 更多阅读

当提到此行为时，您要求在文档中的位置。我没有找到任何地方明确说明错误的含义以及为什么会发生这种特定情况，但是[对执行模型有很好的解释](http://docs.python.org/2/reference/executionmodel.html#naming-and-binding)可能就足够了：

> **如果名称绑定操作发生在代码块中的任何位置，则块中名称的所有使用都被视为对当前块的引用。如果在绑定之前在块中使用名称，这可能会导致错误。** ***这个规则很微妙。Python 缺少声明，并允许名称绑定操作在代码块中的任何位置发生。代码块的局部变量可以通过扫描块的整个文本以进行名称绑定操作来确定。***
> 
> 如果 global 语句出现在一个块中，则该语句中指定的名称的所有使用都指的是该名称在顶级名称空间中的绑定。通过搜索全局命名空间（即包含代码块的模块的命名空间）和内置命名空间（模块的命名空间）来解析顶级命名空间中的名称`__builtin__`。首先搜索全局命名空间。如果在那里找不到名称，则搜索内置名称空间。**该`global`语句必须在名称的所有使用之前**。

所以基本上：

*   如果分配发生在特定函数中，则变量被视为*local*，除非...
*   如果变量的使用前面有`global`语句，则变量被视为*local*，
*   如果没有赋值，首先在本地命名空间中查找变量，然后在全局命名空间中查找，然后在`__builtin__`模块中查找，

另请注意，Python 3 有`nonlocal`一条语句告诉解释器该变量来自外部范围（不是当前范围，但不一定是全局范围）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-28T02:49:33.573

您没有声明`prev`为全局。如果您只对变量执行读取操作，python 将尝试将变量视为全局变量。但是，因为您进行了赋值，python 会检测到这一点并创建`prev`一个局部变量。

有关详细信息，请参阅[http://docs.python.org/2/reference/simple_stmts.html#assignment-statements](http://docs.python.org/2/reference/simple_stmts.html#assignment-statements)。具体来说，说明以下内容的部分：

> 将对象分配给单个目标的递归定义如下。
> 
> 如果目标是标识符（名称）：
> 
> *   如果名称没有出现在当前代码块中的全局语句中：名称绑定到当前本地命名空间中的对象。
> *   否则：名称绑定到当前全局命名空间中的对象。

如果您打算让变量名引用全局变量，则应使用语句将其声明为全局变量`global`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-28T02:50:51.647

该[`global`语句](http://docs.python.org/2/reference/simple_stmts.html#the-global-statement)使全局变量在函数范围内可用。如果您不声明全局的东西，Python 无法知道您指的是全局还是创建新的本地。

The error you're getting just means that Python has recognized you're using a variable before setting it; you'd get the same error even if the global variables weren't defined at all.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-28T02:41:02.973

IINM，Python 解释器检测到该变量在函数的后面被分配，因此将其视为本地变量。

一种解决方法是使用一个类并将 prev 和 prev_re 作为类的实例变量。

# php - 显示属于特定类别的帖子 - Wordpress

> ID：14063878
> 
> 赞同：0
> 
> 时间：2012-12-28T02:36:13.807
> 
> 标签：php, wordpress

我无法让这个工作。有人可以为类别模板提供一个快速片段，该模板显示属于名为“产品 A”的类别的帖子。在过去的 3 个小时里，我一直在使用试错法，但没有成功。

谢谢！

这是我一直在玩的东西-

```
<?php
/*
Template Name: yadayada
*/
?>

<?php get_header(); ?>
<?php get_sidebar(); ?>

<?php query_posts('cat=32&showposts=5'); ?>
<div class="post">

<?php if ( have_posts() ) : while ( have_posts() ) : the_post(); ?>

<div <?php post_class() ?> id="post-<?php the_ID(); ?>">
<div class="post-description">
<h2><?php the_title(); ?></h2>
<?php the_content(); ?>
</div>
</div>

<?php endwhile; else: ?>
<p><?php _e('Sorry, no posts matched your criteria.'); ?></p>

</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T02:56:35.287

您可以使用 WP_Query 类。我之前做过的一种方法是首先创建一个 Product-A 的类别名称并将 slug 'product-a' 全部小写。

然后实例化一个新的类实例。传入 'category_name=product-a' 的参数 你不用这个参数传入类别名称，而是传入 slug 名称。一旦你这样做了，你应该能够使用 WP_Query 如下：

```
<?php $my_query = new WP_Query( 'category_name=product-a' ); ?>
    <?php if ($my_query->have_posts() ) : ?>
        <?php while ( $my_query->have_posts()) :  $my_query->the_post()  ?>  
            <article <?php post_class() ?> id="post-<?php the_ID(); ?>">
                <h2><?php the_title(); ?></h2>
                <div class="product-excerpt"><?php the_content(); ?> </div>
            </article>
        <?php endwhile; ?>           
        <?php else : ?>
            <h2>Not Found</h2>       
    <?php endif; ?> 
```

几乎所有内容都与常规循环相同，但不仅仅是

```
<?php if(have_post()) : while(have_post()) : the_post() ?> 
```

您将使用对象表示法来引用此特定查询。

```
<?php if($my_query->have_post()) : while($my_query->have_post()) : $my_query->the_post() ?> 
```

希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T02:46:45.843

首先获取您的产品 A 类别 ID；（如果您使用，您的自定义查询中的猫 id 它将完美地工作而不是类别名称。）

```
<?php
query_posts('cat=1');
while (have_posts()) : the_post();
the_content();
endwhile;
?> 
```

# c++ - 为什么这个 proto/phoenix 玩具示例会崩溃？

> ID：14063880
> 
> 赞同：5
> 
> 时间：2012-12-28T02:36:32.430
> 
> 标签：c++, boost-phoenix, boost-proto

我正在试验 proto 和 phoenix，我的第一个玩具示例崩溃是什么，我不知道应该在哪里看。由于#boost IRC 频道上的某个人告诉我要确保首先深度复制 phoenix 表达式树（以便在构造时没有悬空引用`x`），因此我将表达式包装为`boost::proto::deep_copy`. 然而[，这并不完全奏效](http://liveworkspace.org/code/3Rdg5D%240)。`-O2`使用标志编译时它仍然崩溃，并且[在省略它时工作正常](http://liveworkspace.org/code/3IkaIU%241)。

```
#include <boost/phoenix/phoenix.hpp>
#include <boost/proto/deep_copy.hpp>
#include <iostream>

namespace bpr = boost::proto;

int main(int argc, char **argv) {
   using namespace boost::phoenix;
   using namespace placeholders;

   auto x = bpr::deep_copy(
   switch_(arg1)[
      case_<1>(std::cout << val("hello")),
      case_<2>(std::cout << val("bye")),
      default_(std::cout << val("default"))
   ]);

   x(1);
   x(2);
} 
```

我希望这能输出`hellobye`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T19:02:57.043

看起来这是[Phoenix 中的一个已知错误](https://svn.boost.org/trac/boost/ticket/7356)。`phoenix::switch_`在排序之前，我会避免使用。不幸的是，Phoenix 的维护者这几天似乎忙于其他事情。:-(

# html - 将绝对 div 定位在相对 div 旁边

> ID：14063882
> 
> 赞同：0
> 
> 时间：2012-12-28T02:36:33.910
> 
> 标签：html, css, position

我正在尝试将绝对对象放置在相对对象旁边。初始对象导致相对 div 换行到下一行。

除了强制标题移动到新“行”的徽标外，一切都按应有的方式工作。如果我将#logo div 更改为`position:absolute`我可以解决定位问题，但是我的徽标悬停将停止运行。

编辑：这是一个现场演示：http: [//vaer.ca/warm-forest-8234/](http://vaer.ca/warm-forest-8234/)

这是我的 HTML：

```
<div id="container">

        <a href="index.html" id="logo"></a>

        <div id="header">

            <h2><a href="index.html">Collectif</a></h2>

        </div>  

        <div id="nav">
            <ul>
                <li><a href="#">About</a></li>
                <li><a href="#">Services</a></li>
                <li><a href="#">Work</a></li>
            </ul>
        </div> 
```

这是我的CSS：

```
#container {
    width: 980px;
    margin: 0 auto;
    position: relative;
    }

#header {
    height: 75px;
    text-align: right;
    position: relative;
    }

#header h2 {
    font-size: 2.5em;
    font-weight: 400;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    padding-top: 15px;
    }

#header a {
    text-decoration: none;
    color: #000000;
    -o-transition:.5s;
    -ms-transition:.5s;
    -moz-transition:.5s;
    -webkit-transition:.5s;
    transition:.5s;
    }

#header a:hover {
    color: #7acfdd;
    }

#logo {
    position: relative;
    display: block;
    margin-top: 10px;
    margin-left: 10px;
    background: url('../img/logo.png') no-repeat;
    width: 60px;
    height: 60px;
    -o-transition:.5s;
    -ms-transition:.5s;
    -moz-transition:.5s;
    -webkit-transition:.5s;
    transition:.5s;
    }

#logo:hover {
    position: relative;
    background: url('../img/logo-hover.png') no-repeat;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T02:44:44.510

我会说 ：

```
#logo {
    float: left;
    position: relative;
}

#header {
    height: 75px;
    text-align: right;
    position: relative;
    clear:both;
} 
```

使用浮点数就好了：left; 和位置：相对；（当我需要将 div 浮动在另一个 div 之上时，我总是使用它，因为当您使用 position: relative；您可以应用 z-index）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T02:41:14.380

尝试：

```
#logo {
    float: left;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T02:58:57.747

您已将`#logo`链接设置为`display:block`强制`<a>`元素占用整个空间。使用开发人员工具查看它。您可以执行以下操作来修复所有问题，并使其更具语义化。

```
#logo{
display:inline-block;
}
#header{
display:inline-block;
float:right
} 
```

这些更改将为您带来您想要的结果。

# codeigniter - 针对关键字优化 PyroCMS 代码

> ID：14063892
> 
> 赞同：0
> 
> 时间：2012-12-28T02:37:52.983
> 
> 标签：codeigniter, optimization, module, keyword, pyrocms

我按照 blog 模块中的 tagged() 方法构建了这个方法

```
public function genres($genre = null)
{
    $this->db->order_by('name', 'ASC');
    $result = $this->db->get('keywords');
    $genres = $result->result();

    if($genre)
    {
        $this->load->model('genres_m');
        // decode encoded cyrillic characters
        $genre = rawurldecode($genre) OR redirect('generos');

        $time[] = time();
        // Count total blog posts and work out how many pages exist
        $pagination = create_pagination(lang('ebooks:routes:genres') . '/' . $genre, $this->genres_m->count_genres_by($genre, array('entry_active' => 1)), NULL, 4);

        $time[] = time();
        // Get the current page of blog posts
        $books = $this->genres_m
            ->limit($pagination['per_page'])
            ->order_by('info_title', 'ASC')
            ->get_genres_by($genre, array('entry_active' => 1));

        $time[] = time();
        foreach ($books AS &$book)
        {
            $book->books_info_genre = Keywords::get($book->books_info_genre, 'blog/tagged');
            $book->url = site_url(lang('ebooks:routes:ebook') . '/' . $book->info_title . '/' . $book->id);
        }

        $time[] = time();
        // Set meta description based on post titles
        //$meta = $this->_posts_metadata($books);

        $name = str_replace('-', ' ', $genre);

        // Build the page
        $this->template
            ->title($this->_template_title(lang('ebooks:of').' '.$name))
            ->set_metadata('description', $this->_template_title(lang('ebooks:of').' '.$name))
            ->set_metadata('keywords', $this->_template_title(lang('ebooks:of').' '.$name))
            ->set('genres', $genres)
            ->set('books', $books)
            ->set('genre', $genre)
            ->set('time', $time)
            ->set('pagination', $pagination)
            ->build('genres-list');
    }
    else
    {
        $this->template->title($this->_template_title(lang('ebooks:genres_by')))
            ->set_metadata('description', $this->_template_title(lang('ebooks:genres_by')))
            ->set_metadata('keywords', $this->_template_title(lang('ebooks:genres_by')))
            ->set('genres', $genres)
            ->build('genres-list');
    }
} 
```

而且，这是模型：

```
public function count_genres_by($genre, $params)
{
    return $this->db->select('*')
        ->from('downloads_books_book_info')
        ->join('keywords_applied', 'keywords_applied.hash = downloads_books_book_info.books_info_genre')
        ->join('keywords', 'keywords.id = keywords_applied.keyword_id')
        ->where('keywords.name', str_replace('-', ' ', $genre))
        ->where($params)
        ->count_all_results();
}

    public function get_genres_by($genre, $params)
{
    return $this->db->select('*')
        ->from('downloads_books_book_info')
        ->join('keywords_applied', 'keywords_applied.hash = downloads_books_book_info.books_info_genre')
        ->join('keywords', 'keywords.id = keywords_applied.keyword_id')
        ->where('keywords.name', str_replace('-', ' ', $genre))
        ->where($params)
        ->get()
        ->result();
} 
```

正如您在代码的第一部分中看到的那样，我得到了 time() 四次，给出了延迟：

18:49 - 19:03 - 19:41 - 19:41

我有一个大约 5K 条目的数据库。如何优化此代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T17:41:40.853

您可以使用 2.2.0-beta1 并利用搜索系统，它将所有关键字存储为文本并为您的查询敲出一些连接。

否则，您可以使用博客事件构建自己的索引表，该索引表将存储博客 ID 旁边的关键字。

主要问题是您正在对每个返回的项目运行 SQL 查询，而一次计算所有关键字会更快。即使是 SQL 子查询也会稍微快一些。

# php - Symfony2 多个错误页面

> ID：14063910
> 
> 赞同：1
> 
> 时间：2012-12-28T02:39:45.823
> 
> 标签：php, templates, symfony, twig

我的大部分 Symfony 应用程序都在每个捆绑包的控制器“前端”和“后端”的两个子目录中分开。我想要做的是为前端和后端 404 错误提供 2 个不同的错误页面。覆盖通用树枝错误模板很容易，但我想知道确定它是否应该呈现前端或后端错误模板的最佳方法是什么。我是否必须为此重写 Twig 异常处理，或者有一些内置功能可以实现这一点。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T13:16:04.070

后端用户会只使用后端还是他们也可能使用前端？如果经过身份验证的用户只使用后端，那么您可以在 404 模板中添加一个 if 语句。

```
{% if is_granted('ROLE_ADMIN') %}
    {# authenticated 404 markup #}
    ...
{% else %}
    {# standard 404 markup #}
    ...
{% endif %} 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2015-01-03T13:05:47.730

我为该功能制作了一个捆绑包，它适用于“kernel.exception_listener”侦听器和“kernel.exception”事件，如文档中所述（[http://symfony.com/doc/current/cookbook/controller/ error_pages.html#use-kernel-exception-event](http://symfony.com/doc/current/cookbook/controller/error_pages.html#use-kernel-exception-event)）。

使用此捆绑包，您可以：

1.  从您想要的路线的正则表达式更改树枝异常模板
2.  仅更改某些 http 状态代码的 twig 异常模板
3.  启用/禁用调试模式的自定义模板

链接到捆绑包（MIT 许可证）：[https ://github.com/Kwrz/TwigException](https://github.com/Kwrz/TwigException)

希望有帮助！

# python - 在 SymPy 中生成变量列表

> ID：14063912
> 
> 赞同：1
> 
> 时间：2012-12-28T02:39:50.053
> 
> 标签：python, list, variables, sympy

> **可能重复：**
> [SymPy - 任意数量的符号](https://stackoverflow.com/questions/9492944/sympy-arbitrary-number-of-symbols)

我正在尝试创建一个通过迭代形成的方程组。每个方程生成：

`summation(binomial(n,i) * (1-t) ** (n-i) * t ** i * **P[i]**) - V[j]`

所有`V[j]`都作为输入给出。这个想法是使用周围创建的方程组`P[i]`来解决每个问题，`P[i]`但要这样做，它们必须是 sympy 符号对象，我不知道如何生成这样的列表。

是否可以有一个无名列表或生成一个符号列表？

如果问题需要澄清，请告诉我，我很难用语言表达。

提前致谢 ：）

# ruby - 单引号与双引号

> ID：14063914
> 
> 赞同：2
> 
> 时间：2012-12-28T02:40:16.417
> 
> 标签：ruby, string, escaping, quotes, double-quotes

我试图用三个连续的换行符（`"\n\n\n"`）分割一个字符串。我正在尝试`str.split('\n\n\n')`，但没有用，但是当我更改为 时`str.split("\n\n\n")`，它开始起作用。谁能向我解释为什么会发生这种行为？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-28T02:50:16.717

单引号中的字符串是**原始**字符串。`'\n\n\n'`三个反斜杠和三个`n`，而不是您预期的三个换行符也是如此。只有双引号字符串可以正确转义。

```
puts 'abc\nabc'  # => abc\nabc
puts "abc\nabc"  # => abc
                 #    abc 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-28T02:58:03.333

单引号字符串具有实际/文字内容，例如

```
1.9.3-p194 :003 > puts 'Hi\nThere'
Hi\nThere
 => nil 
```

而双引号字符串“插入”特殊字符（\n）并进行换行，例如

```
1.9.3-p194 :004 > puts "Hi\nThere"
Hi
There
 => nil 
1.9.3-p194 :005 > 
```

最佳实践建议：

*   尽可能选择单引号而不是双引号（根据需要使用双引号进行插值）。
*   将“引号”嵌套在某处时，将双引号放在单引号内

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T02:53:53.300

在单引号字符串文字中，反斜杠不需要加倍

```
'\n' == '\\n' 
```

# jquery - 具有从对象数组创建的方向的 JQuery .animate()，但是

> ID：14063917
> 
> 赞同：2
> 
> 时间：2012-12-28T02:40:35.760
> 
> 标签：jquery, arrays, object, animation

我想使用`.animate()`具有从数组创建的方向的 JQuery 创建一个连续的动画效果。到目前为止，这是我成功的做法：

```
var animation = [{"top":80},{"left":130},{"top":200},{"left":0},{"top":0}];

$.each(animation, function(i) {
    $('div').animate(animation[i], 1000);
}); 
```

但是，我想将数组保存在每个元素属性中，如下所示：

```
<div data-animation='[{"top":80},{"left":130},{"top":200},{"left":0},{"top":0}]'></div>
<div data-animation='[{"top":50},{"left":-30},{"top":100},{"left":80},{"top":75}]'></div>
<div data-animation='[{"top":10},{"left":-30},{"top":100}]'></div> 
```

...所以我希望我可以为不同方向的多个元素制作动画。但我不知道如何将属性值转换为对象数组（我希望我可以在没有插件的情况下做到这一点）：

```
$('div').each(function() {

    var animation = $(this).data('animation'), // How to convert this into an array?
        $animatedbox = $(this);

    $.each(animation, function(i) {
        $animatedbox.animate(animation[i], 1000);
    });

}); 
```

**这是一个演示：http:** [//jsfiddle.net/wthLR/](http://jsfiddle.net/wthLR/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T02:51:10.283

试试这个：

```
$('div').each(function(){
    var $div = $(this);
    var animation = eval($div.attr('data-animation'));
    $.each(animation, function(i) {
        $div.animate(animation[i], 1000);
    });
}); 
```

[JSFiddle 示例](http://jsfiddle.net/wthLR/12/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-28T03:10:24.717

```
$('div').each(function() {

    var animation = eval($(this).attr('data-animation')),
        $animatedbox = $(this);

    $.each(animation, function(i) {
        $animatedbox.animate(animation[i], 1000);
    });

}); 
```

这有效

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-28T03:50:24.667

如果您不想使用 evil`eval`功能，可以使用它：

```
$('div').each(function () {
    var $div = $(this);
    var data = $div.data('animation').replace(/[[\]]/g,'');
    var dataArray = data.split(',');
    var animations = {};

    for (var i = 0; i < dataArray.length; i++) {
        var trimBrackets = dataArray[i].replace(/[{\}]/g,'');
        var keyValues = trimBrackets.split(':');
        var key = keyValues[0].replace(/\'/g, '');
        var value = parseInt(keyValues[1], 10);

        animations[i] = {};
        animations[i][key] = value;
    }

    $.each(animations, function (i, v) {
        $div.animate(v, 1000);
    });
}); 
```

工作演示：http: [//jsfiddle.net/fewds/tZMmy/](http://jsfiddle.net/fewds/tZMmy/)

# c++ - 在 iOS 中使用 std::atomic

> ID：14063921
> 
> 赞同：0
> 
> 时间：2012-12-28T02:41:21.473
> 
> 标签：c++, ios, std, atomic

> **可能重复：**
> [iOS 中的联锁操作？](https://stackoverflow.com/questions/4862308/interlocked-operations-in-ios)

如何在 iOS 中使用 std::atomic？

我收到错误时 `#include <atomic>`

或者我应该包括什么？或者有其他选择吗？

谢谢。

编辑：用法在 .cpp 文件中，但在 iOS 项目中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T02:45:43.910

将您的 .m 文件编译为 objc++ - 最简单的方法：将它们重命名为 .mm

还可以在您的项目设置 > 构建阶段 > 与框架链接下链接 libstdc++

# mysql - Entity Framework Reverse Engineer Code First 可以和MySql一起使用吗？

> ID：14063923
> 
> 赞同：2
> 
> 时间：2012-12-28T02:41:31.640
> 
> 标签：mysql, visual-studio, entity-framework

我在 Win 7 Ultimate SP1 和[EF Power Tools](http://visualstudiogallery.msdn.microsoft.com/72a60b14-1581-4b9b-89f2-846072eff19d)上使用 MS Visual Studio 2012 Update 1 。

我正在尝试在 MySql DB 上使用实体框架的逆向工程师代码优先功能。我可以成功连接到数据库，但是当它尝试完成代码生成时，我收到以下错误：

```
System.NullReferenceException: Object reference not set to an instance of an object.
   at Microsoft.DbContextPackage.Extensions.ProjectExtensions.InstallPackage(Project project, String packageId)
   at Microsoft.DbContextPackage.Handlers.ReverseEngineerCodeFirstHandler.ReverseEngineerCodeFirst(Project project)

One or more errors occurred while processing template 'Entity.tt'.
C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\IDE\Extensions\Microsoft\Entity Framework Tools\Templates\Includes\EF.Utility.CS.ttinclude(1,4) : error : A processor named 'T4VSHost' could not be found for the directive named 'CleanupBehavior'. The transformation will not be run.  The following Exception was thrown:
System.InvalidOperationException: Cannot find processor for directive 'T4VSHost'.
   at Microsoft.DbContextPackage.Utilities.EfTextTemplateHost.Microsoft.VisualStudio.TextTemplating.ITextTemplatingEngineHost.ResolveDirectiveProcessor(String processorName)
   at Microsoft.VisualStudio.TextTemplating.Engine.ProcessCustomDirectives(ITextTemplatingEngineHost host, TemplateProcessingSession session, IEnumerable`1 directivesToBeProcessed) 
```

我一直无法使用我的 google foo 找到任何信息。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-04T15:37:18.823

这目前是实体框架的一个**活动**错误。可以在[此处查看](http://connect.microsoft.com/VisualStudio/feedback/details/769934/entityframework-bug-in-vs2012-update-1-ctp)错误详细信息。

目前有两种解决方法，我使用的一种方法如下。

打开 C# 文件：

```
C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\IDE\Extensions\Microsoft\Entity Framework Tools\Templates\Includes\EF.Utility.CS.ttinclude 
```

或者对于 VB.net：

```
C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\IDE\Extensions\Microsoft\Entity Framework Tools\Templates\Includes\EF.Utility.VB.ttinclude 
```

并删除第一行：

```
<#@ CleanupBehavior Processor="T4VSHost" CleanupAfterProcessingTemplate="true" #> 
```

# java - jvmti 和 Spring AOP 冲突

> ID：14063925
> 
> 赞同：1
> 
> 时间：2012-12-28T02:42:12.073
> 
> 标签：java, spring, aop, jvmti

背景：我正在做一些加密Java .class 文件，并在加载.class 文件时使用jvmti agentlib 解密源数据。当我为 Java SE 执行此操作时，它正在工作。

但是当我使用 Spring AOP 为 java web 项目执行此操作时会引发一些异常。

```
Exception sending context initialized event to listener instance of class
org.springframework.web.context.ContextLoaderListener
org.springframework.beans.factory.BeanDefinitionStoreException:Failed to read candidate component class 
```

.class 文件可以被读取`ContextLoaderListener`，当然它是加密的，但是为什么 AOP 不使用 jvmti agentlib 加载它呢？

似乎 Spring AOP 在没有 jvmti agentlib 的情况下加载 .class 文件

jvmti和AOP之间有什么关系吗？我想更多地了解这个问题。

# java - 根据权限禁用 Android 按钮

> ID：14063929
> 
> 赞同：0
> 
> 时间：2012-12-28T02:42:30.733
> 
> 标签：java, android

**我有一个使用“ CALL_PHONE** ”权限的安卓应用。这个简单的应用程序将只包含一个按钮，该按钮将使用呼叫意图呼叫特定号码。我想在平板电脑和手机上安装这个应用程序，但是当它安装在平板电脑上时，我希望在运行时禁用该按钮，这样当用户尝试使用没有通话功能的平板电脑拨打电话时不会显示错误.

目前，我正在使用`setEnabled()`and`setClickable()`方法，`MainActivity.java`并在用户第一次单击按钮时将其设置为 false。我的问题是是否可以禁用按钮并在运行时或首次打开应用程序时（在平板电脑中）更改文本，以便用户不必先单击按钮以显示“**呼叫**”按钮应该被禁用且无法点击？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T04:43:14.673

参考[这个](https://stackoverflow.com/a/11301036/1777090)

这将帮助您确定您的应用程序正在平板电脑上运行。现在至于禁用你的按钮，我会建议这样的事情：

```
onCreate()
{
     setContentView(R.layout.main);
     boolean isTablet = checkDevice();
     callBtn = (Button) findViewById(R.id.call);
     if (isTablet)
     {
        callBtn.setEnabled(false);
        callBtn.setText("Not allowed to make a call");
     }

     callBtn.setOnClickListener( new onClickListener(){
           //Make a call
     });

}

public boolean isTablet()
{

    //Code for identifying. Return true if application is running on tablet
    //return false otherwise

} 
```

因此，您不必等待用户单击“呼叫”按钮即可在平板电脑中禁用它。希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T03:12:57.993

用于`button.setEnabled(false);`使**可见**但用户无法单击
`button.setVisibility(View.GONE);`并使按钮**不可见**。以及`button.setText("YOUR_NEW_TEXT");`更改按钮文本运行**时**

**这不取决于屏幕的大小。**

这是你想要的吗？？或者对您的问题更具体。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T02:55:47.420

> ...文本在运行时更改？

您可以使用 setText(); 方法。

关于问题的另一部分，您首先需要定义“什么是平板电脑？”。它是 7"、8"、10" 屏幕吗？它是 mdpi、hdpi、xhdpi 屏幕吗？它是能够打电话的设备吗？什么是平板电脑适合您或您的项目？取决于您的答案，您可以过滤您的代码（[或文件夹中的 xml](http://developer.android.com/guide/practices/screens_support.html)）以使它们以您想要的方式工作。

# php - 在数据库 PDO 中使用 $dsn 字符串变量作为参数

> ID：14063932
> 
> 赞同：0
> 
> 时间：2012-12-28T02:43:22.260
> 
> 标签：php, pdo, connection-string, dsn

**目标：**简单地从 MySQL 数据库中获取数组。

**问题：**我在 PDO 语句中使用 $dsn“字符串变量”作为参数，但似乎有一个未捕获的异常，它与调用驱动程序或 (PDO->__construct) 有关 - 我不是当然。您对如何修复 $dsn 字符串变量或此代码的其他可能导致其失败的区域有任何想法吗？提前致谢。

// 定义数据库参数

```
 $dbhost = "localhost";
    $dbname = "x";
    $dbuser = "y";
    $dbpass = "z"; 
```

## // 调用驱动程序（作为变量字符串）

```
 $dsn = "mysql:host=$dbhost;dbname=$dbname"; 
```

// 连接到新创建的 db 对象

```
 $dbh = new PDO($dsn, $dbuser, $dbpass); 
```

// 设置 PDO 错误模式以启用异常

```
 $dbh->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
    $dbh->setAttribute(PDO::ATTR_EMULATE_PREPARES, false); 
```

// 执行对数据库的查询

```
 $sql = "SELECT * FROM a_aif_remaining";
    $sth = $dbh->prepare($sql);
    $sth->execute(); 
```

// 显示查询结果

```
 print("PDO::FETCH_ASSOC: ");
    print("Return next row as an array indexed by column name");
    $result = $sth->fetch(PDO::FETCH_ASSOC);
    print_r($result);
    print("");
    return $results; 
```

// 关闭数据库连接

```
 $dbh = NULL;

    ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T02:51:26.203

将您的代码放在 try catch 块中。并查看报告的错误信息。下面的一个例子：

```
try
{
  if ( !class_exists( 'PDO' ) )
    throw new Exception( 'PHP without PDO' );
  if ( array_search( PDO::getAvailableDrivers(), 'mysql' ) === false )
    throw new Exception( 'PHP without PDO mysql driver' );
  $dbh = new PDO( ... );
  ...
}
catch ( PDOException $e )
{
  print $e->getMessage();
}
catch ( Exception $e )
{
  print $e->getMessage();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T05:43:21.893

在你寻找它的地方不可能有任何问题。用变量替换字符串是可以的，不会导致任何问题。所以，它在别的地方。幸运的是 PHP 报告了它，但奇怪的是，您并没有太多关注该报告。

> 似乎有一个未捕获的异常

未捕获的异常通常包含错误消息。
大多数 PHP 错误消息都非常有用。必须通读它们才能得到问题的解释。毕竟，它是您**唯一**的信息来源。除了服务器本身，没有人能告诉你服务器出了什么问题。如果您在解释错误消息时遇到困难 -**必须**将其与您的问题一起发布，让人们为您解释它。因此，您收到的每条错误消息都应该完整且完整地发布在您的问题中。简单但非常重要的规则。

# java - 为什么 65.12 - 2 在 java 中不等于 63.12？

> ID：14063936
> 
> 赞同：0
> 
> 时间：2012-12-28T02:43:48.123
> 
> 标签：java, floating-point, subtraction

> **可能重复：**
> [浮点运算在 Java 中不产生精确结果](https://stackoverflow.com/questions/1661273/floating-point-arithmetic-not-producing-exact-results-in-java)

我最近在做一个项目时遇到了一个奇怪的错误。

当从 65.12 中减去 2 时，该值大于（不等于）63.12。

这是简化的代码： `System.out.println(65.12-2);`

以及控制台中的输出： `63.120000000000005`

我不确定为什么会这样，如果有人知道一个简单的修复/解决方法会很棒！

谢谢。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-28T02:45:54.933

它与计算机处理浮点值的方式有关。完全理解该主题的推荐文本是：[What Every Computer Scientist Should Know About Floating-Point Arithmetic](http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html)

# html - 在内部具有特定元素的元素上设置 CSS 属性

> ID：14063937
> 
> 赞同：0
> 
> 时间：2012-12-28T02:44:14.380
> 
> 标签：html, css

我想在 element1 上应用规则，如果它包含 element2。是否可以？

```
<element1>

  ...

  <element2> ... </element2>

</element1> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T02:52:06.110

不，没有办法为父元素设置样式。在 CSS 中没有像**<**那样的运算符。您只能使用**>**设置直接子代的样式，或者用空格分隔后代的样式。

有关更多信息，请参阅类似的问题[Is there a CSS parent selector?](https://stackoverflow.com/questions/1014861/is-there-a-css-parent-selector) .

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T03:02:10.283

这仅适用于 Jquery

比你需要使用这样的东西

```
 $("div").each(function(){

            if(jQuery(this).attr('class') != undefined && jQuery(this).hasClass('myclass')) {
              jQuery(this).css({"background-color":"green"});
         } else {
              jQuery(this).css({"background-color":"red"});
         }
    });​ 
```

# php - 致命错误：在非对象上调用成员函数 db()

> ID：14063938
> 
> 赞同：0
> 
> 时间：2012-12-28T02:44:18.293
> 
> 标签：php, mysql, database, class

请任何人帮助解决此错误

**致命错误：在非对象上调用成员函数 db()**

```
in /hermes/bosoraweb075/b2180/...../shop/inc/db/db.class.php on line 8 
```

这是我的代码

```
<?php

switch ($db_type) {
    case "mysql":
        require_once($includepath . "db/mysql.php");
}
$Var_144->db($db_host, $db_user, $db_pass, $db_db, false);
$db = $Var_144;
if (!$db->db_connect_id) {
    site_error("Can not connect to database");
}
?> 
```

这是错误链接

```
$Var_144->db($db_host, $db_user, $db_pass, $db_db, false); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T02:48:33.703

它是说那`$Var_144`不是一个对象。确保在调用`$Var_144`之前初始化。`db()`

# c# - 创建基于编译器的“字典”的非静态版本，其中键是类型

> ID：14063940
> 
> 赞同：4
> 
> 时间：2012-12-28T02:44:29.807
> 
> 标签：c#, .net, generics, dictionary, compile-time

有一个非常简单的技巧可以创建一个类似字典的结构，其中键是类型。该结构的作用类似于`Dictionary<Type, T?>`其中键是`Type`对象，值是相应类型的实例。

这个奇妙的结构与变量或数组一样快，因为“查找”只由编译器/JITter 完成一次，并且正确的值引用被编译到您的程序中。

```
 public static class MyDict<T> {
        public static T Value { get; set; }
    } 
```

您可以像这样使用该结构：

```
MyDict<string>.Value = MyDict<int>.Value.ToString(); 
```

问题是这个“字典”是全球性的。创建不同字典的唯一方法是创建不同的类。

如何创建一个类似的（最快的“查找”，没有装箱）非静态结构？（没有代码生成。）

简单地说：我想拥有多个`Dictionary<Type, object>`类似的对象，而不需要查找成本、铸造和装箱。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T04:10:34.640

这是一种扩展问题中描述的方法的方法：

```
public class TypeDict
{
    public T Get<T>()
    {
        return MyDict<T>.Values[this];
    }
    public void Set<T>(T value)
    {
        MyDict<T>.Values[this] = value;
    }
    private static class MyDict<T>
    {
        public static Dictionary<TypeDict, T> Values { get; private set; }

        static MyDict()
        {
            Values = new Dictionary<TypeDict, T>();
        }
    }
} 
```

现在我们可以像这样使用 TypeDict：

```
void X()
{
    var a = new TypeDict();
    var b = new TypeDict();

    a.Set<int>(1);
    a.Set<double>(3.14);
    a.Set("Hello, world!");

    //Note that type inference allows us to omit the type argument
    b.Set(10);          
    b.Set(31.4);  
    b.Set("Hello, world, times ten!");

    Console.WriteLine(a.Get<int>());
    Console.WriteLine(a.Get<double>());
    Console.WriteLine(a.Get<string>());

    Console.WriteLine();
    Console.WriteLine(b.Get<int>());
    Console.WriteLine(b.Get<double>());
    Console.WriteLine(b.Get<string>());
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T02:59:42.723

Ark-kun 使用泛型本质上在编译时生成唯一类型。对于泛型类型，任何静态成员对于特定的封闭泛型类型都是唯一的。这样，它的处理速度与标准静态成员查找一样快。

上面的用法等价于这样的：

```
public static class MyDict_String 
{
    public static string Value { get; set; }
}

public static class MyDict_Int32
{
    public static int Value { get; set; }
}

MyDict_String.Value = MyDict_Int32.Value.ToString(); 
```

AFAIK，类型是“静态的”（因为你不能以这种方式定义多个）所以我不知道有一种方法可以绕过这个并保持静态编译的成员查找的相同性能。

否则（我认为）你最好的选择是创建一个通用实例类型，它包装自己的字典，`System.Type`用于其键和`System.Object`值，在插入/检索值时必须对其执行装箱/转换。

编辑：这是一个包装字典的简单实现：

```
public class MyTypedDict
{
    private Dictionary<Type, object> Values = new Dictionary<Type, object>();

    public T Get<T>()
    {
        object untypedValue;
        if (Values.TryGetValue(typeof(T), out untypedValue))
            return (T)untypedValue;
        return default(T);
    }

    public void Set<T>(T value)
    {
        Values[typeof(T)] = value;
    }
} 
```

多想一想，有可能通过一些愚蠢的行为使用`ExpandoObject`（[http://msdn.microsoft.com/en-us/library/system.dynamic.expandoobject.aspx](http://msdn.microsoft.com/en-us/library/system.dynamic.expandoobject.aspx)）来实现更像属性的语法，但我感觉这将是非常滥用的，我只能假设非常容易出现运行时错误。（另外它在编译时不会给你任何东西）

EDITx2：如果你真的想要*不同的值集*，你*可以将*它嵌套在另一个泛型类型中：

```
public static class ValueSets<T>
{
    public static class MyDict<U>
    {
        public static U Value { get; set; }
    }
} 
```

使用如下：

```
ValueSets<int>.MyDict<string>.Value = "Hello ";
ValueSets<bool>.MyDict<string>.Value = "World!";

string helloworld = ValueSets<int>.MyDict<string>.Value + ValueSets<bool>.MyDict<string>.Value;
Console.WriteLine(helloworld);//Hello World! 
```

但是在这种情况下，初始类型变得“神奇”`int`并且`bool`没有意义，而且您需要为每个想要使用的不同值集提供唯一类型。另外，您不能将其传递并修改为实例变量，而是可以静态访问（只要您有权使用 type `T`）。因此，也许您可​​以声明以含义命名的最小可见类型并使用它们：

```
internal class MyFirstWords {}
internal class MySecondWords {}

ValueSets<MyFirstWords>.MyDict<string>.Value = "Hello ";
ValueSets<MySecondWords>.MyDict<string>.Value = "World!";

string helloworld = ValueSets<MyFirstWords>.MyDict<string>.Value + ValueSets<MySecondWords>.MyDict<string>.Value;
Console.WriteLine(helloworld);//Hello World! 
```

无论如何，我认为这很古怪，我不会推荐它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-28T03:18:23.097

一个更复杂的版本。不知道是不是更近：

定义一个通用字典：

```
public class MyDictionary<T>
{
    Dictionary<string, T> dict;

    public MyDictionary()
    {
        dict = new Dictionary<string, T>();
    }

    public T this[string name]
    {
        get
        {
            if (dict.ContainsKey(name))
                return dict[name];
            else
                return default(T);//or throw
        }
        set
        {
            dict[name] = value;
        }
    }
} 
```

然后是存储这些字典的存储库：

```
public class MyRepository
{
    List<object> repo;

    public MyRepository()
    {
        repo = new List<object>();
    }

    public void Add<T>(string name, T value)
    {
        if (!repo.OfType<MyDictionary<T>>().Any())
            repo.Add(new MyDictionary<T>());
        var dict = repo.OfType<MyDictionary<T>>().FirstOrDefault();
        dict[name] = value;
    }

    public T GetValue<T>(string name)
    {
        if (!repo.OfType<MyDictionary<T>>().Any())
            return default(T);//or throw
        else
        {
            var dict = repo.OfType<MyDictionary<T>>().FirstOrDefault();
            return dict[name];
        }
    }
} 
```

最后你可以使用这个存储库：

```
 MyRepository repo = new MyRepository();
        repo.Add("A", 1);
        repo.Add("B", 1);
        int i = repo.GetValue<int>("A") + repo.GetValue<int>("B"); 
```

在此示例中，左侧有`MyDictionary<T>`拳击。`object`

另一方面，如果您使用某些特定类型，则可能根本不使用存储库类。但使用单独的词典。

```
MyDictionary<int> intDict = new MyDictionary<int>();
intDict["A"] = 1;
intDict["B"] = 2;
int i = intDict["A"] + intDict["B"]; 
```

但是，它与使用相同

```
Dictionary<string, int> intDict = new Dictionary<string, int>(); 
```

因此`MyRepository`可以编辑该类以使用`Dictionary<string, T>`而不是`MyDictionary<T>`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-28T03:48:14.620

@Konstantin 的回答让我想起实际上有一种非常快速的查找方法——数组索引。这个粗略的 PoC 代码显示了所需结构的变体。

```
 public class TypeDictionary {
        static int _maxId = 0;
        int _id;

        static class Store<T>{
            internal static List<T> Values = new List<T>();
        }

        public TypeDictionary() {
            _id = _maxId++;
        }

        public T GetValue<T>() {
            return Store<T>.Values[_id];
        }

        public void SetValue<T>(T value) {
            while(Store<T>.Values.Count < _id) {
                Store<T>.Values.Add(default(T));
            }
            Store<T>.Values[_id] = value;
        } 
    } 
```

此代码可按如下方式使用：

```
 var dict1 = new TypeDictionary();
        dict1.SetValue("my string");
        string result = dict1.GetValue<string>(); 
```

这个解决方案的问题是它的内存使用是由存储库不稀疏引起的。这也使得首次值设置更加昂贵。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-28T03:05:41.430

试试这个：

```
public class MyDictionary
{
    List<object> values;

    public MyDictionary()
    {
        values = new List<object>();
    }

    public T GetValue<T>()
    {
        return values.OfType<T>().FirstOrDefault();
    }

    public bool Add<T>(T value)
    {
        if (values.OfType<T>().Any())
            return false;
        else
        {
            values.Add(value);
            return true;
        }
    }
} 
```

并使用它：

```
var md = new MyDictionary();
md.Add("!!!");
string s = md.GetValue<string>(); 
```

此类最多可存储一个 type 值`T`。但是我猜可能存在派生类和接口的极端情况。您可以检查它是否适合您的需要，并可能根据需要对其进行修改，如果它接近您的总体需要。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-03T06:16:21.137

您正在寻找的东西在 C# 中是不可能的。该语言不支持可以存储多个不同类型对象的容器，但提供了一种不涉及强制转换、装箱或拆箱的查找方法。您可以使用 C++ 中的宏或通过 javascript 之类的语言来完成类似的操作，其中类型的结构可以在运行时更改。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-12-10T17:57:14.713

`ConditionalWeakTable<TKey,TValue>`您描述的用例与添加到 .NET 4.0的目的非常吻合。出于您描述的目的，您将在静态泛型类中包含这样一个表，然后对于应该包含对特定类型的项目的引用的每个类对象，您将在该类型的表中存储对应该的对象的引用包含项目以及对项目的引用，或者对简单项目持有者对象的引用（请注意，`ConditionalWeakTable`当对象不再存在时，条目将消失，但在其他方面是不可变的，所以如果你想要一个可变关联您需要创建一个对象来保存它）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-04-24T17:56:24.843

以@phoog 的示例和@supercat 的建议为基础

```
public class TypeDict
{
    public T Get<T>() where T : class
    {
        T value;
        InnerDict<T>.Values.TryGetValue(this, out value);
        return value;
    }
    public void Set<T>(T value) where T : class
    {
        var cwt = InnerDict<T>.Values;
        // lock+remove+add https://github.com/dotnet/coreclr/issues/4545
        lock (cwt)
        {
            cwt.Remove(this);
            cwt.Add(this, value);
        }
    }
    private static class InnerDict<T> where T : class
    {
        public static ConditionalWeakTable<TypeDict, T> Values { get; private set; }

        static InnerDict()
        {
            Values = new ConditionalWeakTable<TypeDict, T>();
        }
    }
} 
```

# loops - [JAVA无限循环，同时需要填写空白字段

> ID：14063945
> 
> 赞同：0
> 
> 时间：2012-12-28T02:45:11.790
> 
> 标签：loops, while-loop, field, fill, infinite

我一直在尝试使用 while 循环来处理程序中可能出现的错误，以显示消息对话框说“填充空”，但它会无限地这样做。简而言之，当我尝试添加某些内容（例如联系人）并且某些字段必须全部填写时，我该如何确保这一点？

这是我的代码，可以很好地找到未填充的字段，但它可以无限运行！

```
 public void createContact(){
    final JFrame addContact = new JFrame("Add Contact");
    addContact.setSize(400,300);
    addContact.setLayout(new BorderLayout());
    addContact.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
    JPanel info = new JPanel(new GridLayout(6,2));
    JButton add = new JButton("Add");
    JLabel title = new JLabel("Title: ");
    JLabel firstname = new JLabel("FIRST NAME: ");
    JLabel lastname = new JLabel("LAST NAME: ");
    JLabel adress = new JLabel("Adress: ");
    JLabel email = new JLabel("Email: ");
    JLabel company = new JLabel("Company Name: ");
    final JTextField title1 = new JTextField(20);
    final JTextField firstname1 = new JTextField(20);
    final JTextField lastname1 = new JTextField(20);
    final JTextField adress1 = new JTextField(20);
    final JTextField email1 = new JTextField(20);
    final JTextField company1 = new JTextField(20);
    info.add(title);
    info.add(title1);
    info.add(firstname);
    info.add(firstname1);
    info.add(lastname);
    info.add(lastname1);
    info.add(adress);
    info.add(adress1);
    info.add(email);
    info.add(email1);
    info.add(company);
    info.add(company1);
    addContact.add(info,BorderLayout.NORTH);
    addContact.add(add,BorderLayout.SOUTH);

    add.addActionListener(new ActionListener(){
        public void actionPerformed(ActionEvent ae){
            while(title1.getText().length() == 0 || firstname1.getText().length() == 0 || firstname1.getText().length() == 0 || adress1.getText().length() == 0 || email1.getText().length() == 0 ||company1.getText().length() ==0){
            JOptionPane.showMessageDialog(null,"Please fill the empty fields.");
            }
            Contact newContact = new Contact(title1.getText(),firstname1.getText(),lastname1.getText(),adress1.getText(),email1.getText(),company1.getText());
            contactList.add(newContact);
            JOptionPane.showMessageDialog(null,"Contact has been added successfuly!");
            addContact.setVisible(false);

        }
    });
    addContact.pack();
    addContact.setVisible(true);

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T03:20:57.097

由于它在一个while块中，它总是会连续运行（因为总是满足条件）。但是你不能修改任何东西，因为一旦你确认消息，我会再次弹出。尝试使用 'if' 代替：

```
add.addActionListener(new ActionListener(){
    public void actionPerformed(ActionEvent ae){
        if (title1.getText().length() == 0 || firstname1.getText().length() == 0 || firstname1.getText().length() == 0 || adress1.getText().length() == 0 ||    email1.getText().length() == 0 ||company1.getText().length() ==0){
            JOptionPane.showMessageDialog(null,"Please fill the empty fields.");
        } else {
            Contact newContact = new Contact(title1.getText(),firstname1.getText(),lastname1.getText(),adress1.getText(),email1.getText(),company1.getText());
            contactList.add(newContact);
            JOptionPane.showMessageDialog(null,"Contact has been added successfuly!");
            addContact.setVisible(false);
        }
    }
} 
```

# python - GAE/P - 安排停机时间进行维护

> ID：14063961
> 
> 赞同：2
> 
> 时间：2012-12-28T02:47:53.020
> 
> 标签：python, google-app-engine, maintenance

我正在对我的实体进行一些重构，并且我想暂时关闭对我的应用引擎应用程序的所有访问（管理员除外），以防止用户在我执行维护时修改任何实体。

什么是一个简单的方法来做到这一点？我能想到的唯一简单方法是创建一个新`app.yaml`文件，其中所有页面都需要管理员。这样做的一个缺点是，我无法向用户发出友好的信息，即访问权限将很快恢复。

有更好的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T06:32:47.900

使用管理控制台的应用程序设置选项卡“禁用数据存储写入”：[https ://developers.google.com/appengine/docs/adminconsole/applicationsettings#Disable_Datastore_Writes](https://developers.google.com/appengine/docs/adminconsole/applicationsettings#Disable_Datastore_Writes)

这会将您的数据存储设置为只读模式并阻止任何用户进行更改。

编辑：这里有一篇关于如何修改您的应用程序以在停机期间优雅降级的文章：[https ://developers.google.com/appengine/docs/python/howto/maintenance](https://developers.google.com/appengine/docs/python/howto/maintenance)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T15:54:27.260

我通过修改 WSGIApplication 创建了维护模式。

我`main.py`现在看起来像这样：

```
import webapp2
import views

maintenance_mode = False

# These routes need to be always available
routes = [
    # Static pages
    (r'/(|about|contact|help|faq|terms|privacy|users|methods)', 
     views.Static),
    # Other routes that should always be available here
]

if maintenance_mode:
    routes += [(r'/.*', views.Maintenance)] # Displays a maintenance message
    application = webapp2.WSGIApplication(routes)

else:
    routes += [
        # Routes that are not available in maintenance mode
    ]
    application = webapp2.WSGIApplication(routes) 
```

`views.py`具有以下内容：

```
class Maintenance(webapp2.RequestHandler):
    def get(self):
        self.response.write (
            "My app is down for maintenance and should be back up shortly.")
    def post(self):
        self.response.write (
            "My app is down for maintenance and should be back up shortly.") 
```

这似乎是一个简单而安全的解决方案，但如果您发现这种方法有任何缺陷，请告诉我。

# sql - 更新语句以重新排序表队列

> ID：14063966
> 
> 赞同：3
> 
> 时间：2012-12-28T02:48:21.183
> 
> 标签：sql, sql-server-2008, tsql

有一个表有以下测试数据

```
PKId         EqId    Worker     Queue
1             1      Worker1      1
3             1      Worker3      3
2             1      Worker2      4
4             1      Worker4      7 
```

需要更新将轮换工人的表，以便在更新语句之后数据如下所示

```
PKId         EqId   Worker  Queue
1             1     Worker1   7
3             1     Worker3   1
2             1     Worker2   3
4             1     Worker4   4 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T02:59:35.173

您几乎可以通过加入来做到这一点：

```
select pkid, eqid, worker, queue, tprev.queue as newqueue
from t left outer join
     t tprev
     on t.pkid = tprev.pkid + 1 
```

但是，对于 PkID = 1，您最终会得到 NULL。因此，我们需要将其添加到：

```
select pkid, eqid, worker, queue, coalesce(tprev.queue, lastone.queue) as newqueue
from t left outer join
     t tprev
     on t.pkid = tprev.pkid + 1 cross join
     (select top 1 queue from t order by pkid desc) as lastone 
```

如果你真的想更新，那么我们可以把它放在一个更新语句中：

```
update t
    set queue = newqueue
    from (select pkid, eqid, worker, queue,
                 coalesce(tprev.queue, lastone.queue) as newqueue
          from t left outer join
               t tprev
               on t.pkid = tprev.pkid + 1 cross join
               (select top 1 queue from t order by pkid desc) as lastone
         ) newt
    where t.pkid = newt.pkid 
```

我意识到您的主键可能有孔。在这种情况下，请从以下查询开始：

```
select t.*, newQueue
from (select t.*,
             (select top 1 queue from t t2 where t2.pkid < t.pkid order by t2.pkid desc
             ) as newQueue
      from t
     ) t 
```

在更新声明中：

```
update t
    set queue = newqueue
    from (select pkid, eqid, worker, queue,
                 coalesce(Newqueue, lastone.queue) as newqueue
          from (select t.*,
                       (select top 1 queue from t t2 where t2.pkid < t.pkid order by t2.pkid desc
                       ) as newQueue
                from t
               ) t cross join
               (select top 1 queue from t order by pkid desc) as lastone
        ) newt
    where t.pkid = newt.pkid 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T04:50:08.057

尝试：

```
DECLARE @q TABLE (
  PKId INT, 
  EqID INT, 
  Worker VARCHAR(50), 
  [Queue] INT
) 

INSERT @q 
SELECT 1,1,'Worker1', 1 UNION ALL
SELECT 3,1,'Worker3', 3 UNION ALL 
SELECT 2,1,'Worker2', 4 UNION ALL 
SELECT 4,1,'Worker4', 7 

;WITH t AS (
SELECT
  PKId,
  [Queue],
  ROW_NUMBER() OVER (ORDER BY [Queue]) AS rn
FROM @q 
)
UPDATE q 
SET [Queue] = q2.NewQueue
FROM @q q 
JOIN ( 
  SELECT
    t1.PKId,
    COALESCE(t2.[Queue], 
      (SELECT TOP 1 [Queue] FROM t ORDER BY [Queue] DESC)) AS NewQueue
  FROM t t1
  LEFT JOIN t t2
  ON t1.rn = t2.rn + 1
) q2 
  ON q.PKId = q2.PKId 
```

# c++ - 通过 Code::Block 加 MinGW 编译但使用标准 Windows 库的程序？

> ID：14063969
> 
> 赞同：0
> 
> 时间：2012-12-28T02:48:55.887
> 
> 标签：c++, mingw, codeblocks

每个人。

我是 c++ 的新手，我对 c# 有一些经验。我想创建一个纯 c++ 开发环境，并使用标准 c++ 库。我的操作系统是Windows。

我选择code::block+MinGW在Windows上搭建一个纯开发环境。我直接选择集成MinGW的Code::Block安装包。然后我开始开发我的第一个学习项目。在这个项目中，我使用函数“stat”从标准库中获取文件信息。我通过了编译。但是在运行这个程序的过程中，我检查了“调用堆栈”。并找到从文件“C:\WINDOWS\system32\msvcrt.dll”中调用的函数“stat”。我从互联网上检查了这个 dll，发现这个文件是一个 microsoft windows 库文件。所以很明显，这个dll文件没有函数“stat”，但有函数“_stat”。

那么我该如何解决这个问题呢？我想使用标准 c++ 库，而不是 microsoft windows 库。因为后来，我想把这个项目搬到linux环境下。所以总的来说，我如何构建开发环境来满足我的需求。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T06:06:38.227

如果要为 Windows 构建，则必须使用 Windows 系统库。您只需根据目标系统链接一个或另一个。这些库仅提供底层实现，这与一个操作系统不同。

在您的具体示例中， stat 是由标准系统标头定义的函数，但其​​底层实现因系统而异。整个函数可能是从 msvcrt 中提取的，但我的猜测是 msvcrt 恰好实现了一个伴随函数，该函数处理所有特定于系统的东西。

# android - 我应该将图像放在哪个可绘制文件夹中？

> ID：14063985
> 
> 赞同：1
> 
> 时间：2012-12-28T02:50:45.877
> 
> 标签：android

我有一个要上传到 googleplay 市场的应用程序。我还有一个基本问题。我应该将图像放在哪个可绘制文件夹上？我认为 hdpi、mdpi 和 ldpi 旨在针对具有不同屏幕尺寸和分辨率的手机。但是可以将我的图像副本放在所有三个可绘制文件夹中还是全部放在 hdpi 中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T02:55:12.397

那么答案是：你应该把你的图像放在所有的上面，但你必须有三种不同的图像尺寸。如果您只有一种图像尺寸，则必须将其放在 hdpi 文件夹中。

我也强烈建议您阅读此链接：

[http://developer.android.com/training/multiscreen/index.html](http://developer.android.com/training/multiscreen/index.html)

[http://developer.android.com/guide/practices/ui_guidelines/icon_design_menu.html](http://developer.android.com/guide/practices/ui_guidelines/icon_design_menu.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T02:55:23.427

您可以根据设备进行选择。

```
res/drawable-mdpi/my_icon.png        // bitmap for medium density
res/drawable-hdpi/my_icon.png        // bitmap for high density
res/drawable-xhdpi/my_icon.png       // bitmap for extra high density 
```

**欲了解更多信息，请访问**

[http://developer.android.com/guide/practices/screens_support.html](http://developer.android.com/guide/practices/screens_support.html)

***如果只为一个屏幕大小的设备开发应用程序，那么您可以在res/drawable***中创建自己的文件夹并将所有图像文件放在那里

# c - setenv() 更新 PATH 环境变量

> ID：14063992
> 
> 赞同：0
> 
> 时间：2012-12-28T02:51:19.080
> 
> 标签：c, linux, setenv

我想编写一个 C 程序来将字符串附加到 PATH 环境变量。类似于“导出 PATH=$PATH:$HOME/mylib”

我有这样的C代码

setenv("PATH", "$PATH:$HOME/mylib",1); **//这不起作用。**

我认为的其他工作是使用 getenv() 获取 PATH 和 HOME，并在堆中创建一个内存，然后使用 strcat() 附加它们。

我可能不得不在我的代码中多次更新 PATH：所以这是一个令人厌烦的过程。

有什么选择吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T05:02:53.717

语法扩展为带有 name的`$FOO`环境变量的值`FOO`，是 shell 的一个特性；它在 C 中不直接可用。

您的系统可能会提供[wordexp()](http://linux.die.net/man/3/wordexp)函数，它在 C 中为您提供类似的功能。

但是由于您只是用固定名称 (`"HOME"`和`"PATH"`) 扩展两个环境变量，因此使用可移植`getenv()`函数和一些字符串处理更有意义。（您可以考虑使用`sprintf`or`snprintf`而不是`strcat`。）

注意：如果您只`$PATH`在程序内部使用更新，您可以在此处停止阅读。

希望您不希望`$PATH`在程序完成运行后在命令行上可以进行任何更改。您正在运行的 C 程序很可能是交互式 shell 的子进程。环境变量由子进程继承；它们不会传播回父进程。

如果这就是你想要做的，你可以让你的程序将新`PATH`值打印到标准输出，然后让 shell 评估它：

```
PATH=`your-program` 
```

或者它可以打印命令来设置一个或多个环境变量：

```
eval `your-program` 
```

（在 bash 中，您可以使用`$(your-program)`以及``your-program``。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T03:10:05.797

不，别无选择。您必须构建文字字符串并将其传递给 setenv。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-28T03:11:40.877

没有其他立即可用的选项。如果您需要多次执行此操作，您可以编写一个单独的函数来处理此问题。

# parameters - 获取来自 TabContainer Dojo 中 HREF 属性的参数

> ID：14063994
> 
> 赞同：0
> 
> 时间：2012-12-28T02:51:34.987
> 
> 标签：parameters, tabs, dojo, lazy-loading

我已经开始在 DOJO 中使用 TabContainer，但我正在使用动态选项卡和动态内容。为了生成我的选项卡，我访问了一个 REST，它为我提供了带有每个选项卡名称的 JSON 数据。

之后，当用户单击指定选项卡时，我需要调用另一个 REST 以将信息带到选项卡的容器中。当您使用 HREF 属性时，默认的“延迟”加载对我来说是完美的，因为我无法在第一时间加载所有内容......而且我还需要将参数传递给另一个文件（teste.html?idTable =123)。

当我通过浏览器直接访问文件 teste.html?idTable=123 时，我可以捕获参数，但是当我使用 HREF 属性时，它不起作用。

如何获取来自 HREF 属性的参数？还有另一种更好的方法吗？（我需要延迟加载）

主.js

data.table 是一个 JSON...

```
var tc = new TabContainer({
   style: "height: 100%; width: 100%;"
}, "tc1-prog");

for(var i=0; i<data.table.length; i++){

   var cp = new ContentPane({

      id: data.table[i].id,
      title: data.table[i].name,
      //content: "teste - "+i
      href: 'tables/teste.html?idTable='+data.table[i].id

   });

   tc.addChild(cp);

}

tc.startup(); 
```

teste.html

```
require([
   'dojo/io-query',
   'dojo/domReady!'
], function (ioQuery) {

   var uri = window.location.search;
   //var uri = "http://some.server.org/somecontext/?foo=bar&foo=bar2&bit=byte";
   var query = uri.substring(uri.indexOf("?") + 1, uri.length);
   var queryObject = ioQuery.queryToObject(query);

   console.log('idTable: ', queryObject.idTable);

}); 
```

# groovy - 使用 Griffon 捕捉关键事件

> ID：14063995
> 
> 赞同：1
> 
> 时间：2012-12-28T02:51:39.417
> 
> 标签：groovy, griffon

我正在构建一个 Griffon 应用程序，我希望能够对按键事件做出反应，以便用户可以轻松地通过按键向前和向后导航。是否有任何示例向我们展示如何使用 Griffon 监听关键事件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T10:25:50.947

请记住，Griffon 总是为您提供选择，在这种情况下，您可以下拉一级并在目标组件上注册 KeyEventListeners。另一种选择是使用`keyStrokeAction`SwingBuilder 公开的节点，就像这里的`slideware`插件所示[https://github.com/griffon/griffon-slideware-plugin/blob/master/griffon-app/views/griffon/plugins/ slideware/DeckPlayerView.groovy](https://github.com/griffon/griffon-slideware-plugin/blob/master/griffon-app/views/griffon/plugins/slideware/DeckPlayerView.groovy)

```
keyStrokeAction(component: deck,
    keyStroke: shortcut('UP'),
    condition: 'in focused window',
    action: lookupAction) 
```