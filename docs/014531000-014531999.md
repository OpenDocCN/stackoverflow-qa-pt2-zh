# StackOverflow 问答 14531000-14531999

# javascript - 从选择框中删除选定的选项

> ID：14531003
> 
> 赞同：0
> 
> 时间：2013-01-25T21:58:34.553
> 
> 标签：javascript

如何从选择框（下拉列表）中删除选定的选项（突出显示的选项）？

预期结果：从选择框中进行选择后，单击“删除”按钮即可选择所选选项。

```
<!DOCTYPE html>

<html>

<head>

</head>

<body>
<select id="drop1" id="choices">
  <option value="Red">Red</option>
  <option value="Blue">Blue</option>
  <option value="Yellow">Yellow</option>
  <option value="Green">Green</option>
    <option value="Orange">Orange</option>
    <option value="Black">Black</option>
</select>
<input type="button" value="Delete" name="delete">

</body>

</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T22:05:32.823

使用 jQuery 非常容易。我建议您使用该库。给你的删除按钮一个 ID：

```
$('#deletebtn').on('click', function(){
    $('#drop1').find(':selected').remove();
}); 
```

[http://jsfiddle.net/rWcne/](http://jsfiddle.net/rWcne/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T22:07:35.120

一种 jquery-less 方式 -> 使用选择框对象的 remove 方法和 selectedIndex。

[http://www.w3schools.com/jsref/met_select_remove.asp](http://www.w3schools.com/jsref/met_select_remove.asp)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T22:07:38.460

您可以添加一个javascript函数：

```
<input type="button" onclick="removeOptionSelected();" value="Delete" name="delete">

  function removeOptionSelected()
{
  var elSel = document.getElementById('drop1');
  var i;
  for (i = elSel.length - 1; i>=0; i--) {
    if (elSel.options[i].selected) {
      elSel.remove(i);
    }
  }
} 
```

# push-notification - iOS 应用拒绝询问是否要注册推送通知

> ID：14531016
> 
> 赞同：0
> 
> 时间：2013-01-25T21:59:24.457
> 
> 标签：push-notification, apple-push-notifications

这是该应用程序第一次安装在此设备上，并且从未注册过推送通知，但它拒绝询问。我使用以下代码，但无论我清理项目多少次，删除派生数据，在我的设备上卸载并重新安装应用程序，它都不会问我是否要接收推送通知。

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    [[UIApplication sharedApplication]
     setStatusBarStyle:UIStatusBarStyleBlackOpaque animated:YES];

    self.window = [[[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]] autorelease];

 // Override point for customization after application launch.
    self.viewController = [[[ViewController alloc] initWithNibName:@"ViewController" bundle:nil]autorelease];

 [[UIApplication sharedApplication] registerForRemoteNotificationTypes:
     UIRemoteNotificationTypeBadge |
     UIRemoteNotificationTypeAlert | UIRemoteNotificationTypeSound];

     self.window.rootViewController = self.viewController;
    [self.window makeKeyAndVisible];

    return YES;
} 
```

为什么它不会要求我注册通知？我检查了设置中的通知，这个应用程序没有列出。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T22:26:14.173

模拟器不支持推送通知，您只能在 iOS 设备上尝试。

1.  确保在您的 iOS 配置中为您的*appID*启用推送通知。

2.  权利 plist 必须在开发时将密钥`aps-environment`和值`development`作为字符串包含`production`在提交到*AppStore*之前或使用*ADHOC 证书*签名之前的值。

为确保您已注册推送通知，请将其包含在您的代码中以测试其是否正常工作

```
(void)application:(UIApplication *)app didRegisterForRemoteNotificationsWithDeviceToken:(NSData *)devToken
{
NSString *token = [[devToken description] stringByTrimmingCharactersInSet:[NSCharacterSet characterSetWithCharactersInString:@"<> "]];
NSLog(token);
} 
```

如果这不起作用，请尝试本[教程](http://mobile.tutsplus.com/tutorials/iphone/iphone-sdk_apns/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-19T10:20:58.273

**在 iOS 上重置推送通知权限警报**

首次启用推送的应用程序注册推送通知。iOS 会询问用户是否希望接收该特定应用的远程通知。一旦用户对此警报做出响应，它就不会一次又一次地出现，除非设备已恢复或应用程序已被卸载至少一天。

如果你想模拟你的应用程序的首次运行，你可以让应用程序卸载一天。您可以按照以下步骤实现后者，而无需实际等待一天：

```
1.Delete your app from the device.
2.Turn the device off completely and turn it back on.
3.Go to Settings > General > Date & Time and set the date ahead a day or more.
4.Turn the device off completely again and turn it back on. 
```

有关更多详细信息，请参阅：[https ://developer.apple.com/library/ios/technotes/tn2265/_index.html](https://developer.apple.com/library/ios/technotes/tn2265/_index.html)

# ios - 获取一对多关系值核心数据

> ID：14531019
> 
> 赞同：1
> 
> 时间：2013-01-25T21:59:45.677
> 
> 标签：ios, core-data

我正在尝试使用谓词从核心数据中获取值，这是我模型的一部分 ![在此处输入图像描述](../Images/dbeb1c8fd66b533db74869f1d4c105ab.png)

这是我正在使用的谓词：

```
NSPredicate *predicate = 
[NSPredicate predicateWithFormat:@"idPartida == %@ AND obra.idObra == %@",
[NSNumber numberWithInt:[[reportePartida valueForKey:@"idPartida"] intValue]],IdObra]; 
```

它返回 0，但是如果我尝试仅使用`idPartida`它来发出请求，并且如果我使用 Obra 作为实体发出请求，并且`idObra`在谓词上使用它也可以，但是尝试通过关系访问 Obra.idObra 是行不通的。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T09:30:09.440

您想要一个特定的`Partida`并拥有`idPartida`，这就是您所需要的一切。谓词的所有其他部分都是多余且不必要的。

# vb.net - 试图将变量的名称作为字符串 VB.NET

> ID：14531021
> 
> 赞同：8
> 
> 时间：2013-01-25T22:00:07.663
> 
> 标签：vb.net, variables, reflection, tostring, var

我正在尝试将变量的名称作为字符串返回。

所以如果变量是var1，我想返回字符串“var1”。

有什么办法可以做到这一点吗？我听说反射可能是在正确的方向。

编辑：

我本质上是在尝试使有组织的树视图的实现更简单。我有一个方法，你给出两个字符串：rootName 和 subNodeText。rootName 恰好是一个变量的名称。对此方法的调用是从该变量的 with 块中调用的。我希望用户能够调用 Method(.getVariableAsString, subNodeText) 而不是 Method("Variable", subNodeText)。想要以编程方式获取它的原因是可以简单地复制和粘贴此代码。我不想每次变量被命名为异常时都对其进行调整。

```
Function aFunction()
   Dim variable as Object '<- This isn't always "variable".
   Dim someText as String = "Contents of the node"

   With variable '<- Isn't always "variable". Could be "var", "v", "nonsense", etc
      'I want to call this
      Method(.GetName, someText)
      'Not this
      Method("Variable",someText)

   End With
End Function 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-25T22:14:02.463

这现在可以从 VB.NET 14 开始（[更多信息在这里](https://msdn.microsoft.com/en-us/library/dn986596.aspx)）：

```
Dim variable as Object
Console.Write(NameOf(variable)) ' prints "variable" 
```

* * *

编译代码时，您分配的所有变量名称都会更改。无法在运行时获取局部变量名称。但是，您可以使用 System.Reflection.PropertyInfo 获取类属性的名称

```
 Dim props() As System.Reflection.PropertyInfo = Me.GetType.GetProperties(BindingFlags.Public Or _
                                                                                     BindingFlags.Instance Or BindingFlags.DeclaredOnly)

 For Each p As System.Reflection.PropertyInfo In props
     Console.Write(p.name)
 Next 
```

# asp.net-mvc - pro ASP.NET MVC SportsStore 第 7-9 章 Error Ninject

> ID：14531026
> 
> 赞同：0
> 
> 时间：2013-01-25T22:00:50.517
> 
> 标签：asp.net-mvc, ninject

我正在尝试从 book pro ASP.NET MVC 3 运行 SportsStore。我做了安装 Ninject 的每一步，但在以下代码的最后一行出现错误，上面写着 ..
'ninjectControllerFactory' 找不到（您是否缺少 using 指令或 assebly 参考）

我究竟做错了什么？

我尝试运行下载的正确版本，但它说由于 Visual Studio 版本错误，体育商店域不可用。

我尝试了 express 2010 和 2012 (MVC 3)

有任何想法吗？

```
protected void Application_Start()
    {
        AreaRegistration.RegisterAllAreas();

        // Use LocalDB for Entity Framework by default
        Database.DefaultConnectionFactory = new SqlConnectionFactory(@"Data Source=(localdb)\v11.0; Integrated Security=True; MultipleActiveResultSets=True");

        RegisterGlobalFilters(GlobalFilters.Filters);
        RegisterRoutes(RouteTable.Routes);
        ControllerBuilder.Current.SetControllerFactory(new NinjectControllerFactory());
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T01:46:03.677

Ninject ASP.NET MVC3 包不使用控制器工厂，而是使用 IDependencyResolver 接口。因此，您要么必须实现自己的 ControllerFactory，要么更好地使用 Ninject.Web.MVC3，如 wiki 中所述：

[https://github.com/ninject/ninject.web.mvc/wiki/MVC3](https://github.com/ninject/ninject.web.mvc/wiki/MVC3)

# java - JSON + Java 字符解码

> ID：14531033
> 
> 赞同：0
> 
> 时间：2013-01-25T22:01:17.240
> 
> 标签：java, json, encoding

我下面的代码是使用 Java 的 URLConnection 来 ping 一个 RESTful API，它会返回一个 JSON 字符串。我返回的 JSON 字符串似乎完全有效，但在 JSONLint 和下面的最后一行代码中都失败了。

返回的 JSON 是：

> {“rowId”：“1-12C-1494”}

错误信息是：

> 第 2 行的解析错误：...rowId": "1-12C-1494" ------------------------------------^ 期待 '}', ': ', ',', ']'

代码是：

```
StringBuilder responseBuilder = new StringBuilder();

URLConnection connection = url.openConnection();
InputStream cin = connection.getInputStream();
int bytesRead = -1;
byte[] buffer = new byte[1024];

while ((bytesRead = cin.read(buffer)) >= 0) {
    responseBuilder.append(new String(buffer, "UTF-8"));
}

String response = responseBuilder.toString();

JsonObject jsonObject = new JsonParser().parse(response).getAsJsonObject(); 
```

如果我从浏览器 ping RESTful API 并将那里的 JSON 复制到 JSONLint 中，它验证就好了。我能说的最好的就是某种字符/空格编码问题。有没有其他人遇到过它并有任何指导？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T22:24:28.883

好的，这与我从 Stream 到 String 的方式有关。上面示例中的方法在 JSON 中间留下了约 1000 字节的间隙。JSONLint 将其视为无法解释甚至呈现的空白字符。

故事的寓意...不要使用我从 InputStream 转到 String 的方法。这效果更好：

```
InputStream cin = connection.getInputStream();

java.util.Scanner s = new java.util.Scanner(cin).useDelimiter("\\A");
(StringBuilder)responseBuilder.append(s.hasNext() ? s.next() : ""); 
```

请[参阅将 InputStream 读取/转换为字符串](https://stackoverflow.com/questions/309424/read-convert-an-inputstream-to-a-string)以进行讨论

# c# - 字典中的 C# 动态 SMTP 实例和线程

> ID：14531034
> 
> 赞同：0
> 
> 时间：2013-01-25T22:01:20.257
> 
> 标签：c#, multithreading, dynamic, dictionary, smtp

我撞到了另一面墙。请在此处查看我之前关于多线程和 SMTP 的[问题](https://stackoverflow.com/questions/14518482/c-sharp-sending-smtp-using-system-threading)

无论如何，我试图在运行时动态创建线程并调用 Start() 方法，但收到 KeyNotFoundException。对此的任何见解将不胜感激。如果我的代码不在这里，基本上我希望完成的是根据用户输入（计数）创建一个在单个线程上运行的唯一 SMTP 实例，并同时运行每个线程。

```
//count is user input (number of messages)  

int instanceCount = 0;

        var vartable = new Dictionary<string, SmtpClient>();
        var vartable2 = new Dictionary<string, Thread>();

        for (int i = 0; i < count; ++i)
        {
            vartable[instanceCount.ToString()] = new SmtpClient
            {
                Host = txtBxSenderHost.Text,
                Port = 587,
                EnableSsl = true,
                DeliveryMethod = SmtpDeliveryMethod.Network,
                UseDefaultCredentials = false,
                Credentials = new NetworkCredential(strSenderAddress, strSenderPassword)
            };

            vartable2[instanceCount.ToString()] = new Thread(delegate()
            {
                using (var message = new MailMessage(senderAdrress, toAddress)
                {
                    Subject = strSubject,
                    Body = strBody
                })

                {
                    {
                        ((SmtpClient)vartable[instanceCount.ToString()]).Send(message);
                    }
                }
            });

            instanceCount++;
        } 
```

只是为了测试，我用“0”来查看是否工作

```
 vartable2["0"].Start(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T22:23:41.257

当您在委托内存储循环变量时，您需要在委托外声明一个单独的变量，以避免接收到迭代的最后一个值。

如果您进行打印语句，您将看到每个线程试图访问的值都是相同的，无论 count 的值是多少。只需在委托语句上方添加一个变量：

```
 int tempInstanceCount = instanceCount;
        vartable2[instanceCount.ToString()] = new Thread(delegate()
        {
            using (var message = new MailMessage(senderAdrress, toAddress)
            {
                Subject = strSubject,
                Body = strBody
            })

            {
                {
                    ((SmtpClient)vartable[tempInstanceCount.ToString()]).Send(message);
                }
            }
        }); 
```

# jquery - jQuery 加载（）；- 找到 html 部分而不是 div？

> ID：14531036
> 
> 赞同：0
> 
> 时间：2013-01-25T22:01:53.950
> 
> 标签：jquery

我有以下 jquery 代码。

```
<div id="result"> <script>
$('#result').load('http://www.mystie.com/speicificpage  #uniqueid li:lt(3)');</script> </div> 
```

到目前为止效果很好。有没有办法对带有 h2 标签的内容执行此操作？意思不是匹配一个ID，你可以匹配一个h2里面的东西吗？

```
<div id="result"> <script>
    $('#result').load('http://www.mystie.com/speicificpage <h2> unique title</h2> li:lt(3)');</script> </div> 
```

我有一个页面是一系列 ul 并且每个都有一个标题。我有单独的页面需要在特定的 ul 中调用（因为它们已更新。）我可以指定或匹配 h2 标题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T22:07:19.217

您可以在 URL 之后使用任何 jQuery 选择器。例如，要加载`h2`with text的内容`unique1`，您可以使用：

```
$('#result').load('http://www.mystie.com/speicificpage h2:contains(unique1)'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T22:08:49.213

你可以，但你必须放弃`.load()`并手动编写一些代码：

```
$.get('http://www.mysite.com/specificpage',
      function(html) {
          var $target = $(html).find("h2")
                               .filter(function() { 
                                   return $(this).text() == 'unique title';
                               })
                               .find("li:lt(3)");
          $('#result').html($target.html());
      }); 
```

This works by getting the HTML and manually filtering it before inserting the target fragment into your page; doing it manually enabled full jQuery functionality, which allows precisely matching the desired header.

# asp.net-mvc - Web 部署重置处理程序映射的 IIS 设置

> ID：14531039
> 
> 赞同：2
> 
> 时间：2013-01-25T22:02:05.287
> 
> 标签：asp.net-mvc, iis, publishing, webdeploy

我正在使用 web deploy 发布一个 MVC4 项目，每次发布它时，我的处理程序映射都会重置，我必须添加一个新的。

有没有办法可以将此设置包含在发布中，或者将其设置为不刷新处理程序映射？

默认情况下，我有我的发布设置，其中未选中“包括 IIS Express 中配置的 IIS 设置”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T11:17:20.313

Web 部署只是部署您的 Web.config，可能会应用转换。它总是会替换服务器上的 web.config，因此您可能需要检查项目中的 web.config 是否正确。

# c# - 如何测试是否检查了 TreeView 节点和/或节点子项？

> ID：14531041
> 
> 赞同：3
> 
> 时间：2013-01-25T22:02:17.430
> 
> 标签：c#, winforms, loops, treeview, nodes

我有一个包含节点和子节点的 TreeView 列表的程序。这些都启用了复选框属性。我需要知道如何检查检查了哪些节点/节点子节点。到目前为止，我已经能够成功测试父节点，但没有子节点使用：

```
//this  will turn black any node that is checked, doesn't affect the children though
    TreeNodeCollection nodes = this.treeView1.Nodes;
                foreach (TreeNode n in nodes)
                {
                    if (n.Checked)
                    {
                        n.BackColor = Color.Black;   
                    }
                } 
```

如何让它检查父节点以及子节点？我已经搜索并没有找到任何可以为我解决这个问题的东西。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-25T22:09:26.977

您可以定义一个递归函数来标记所有选定的项目：

```
private static void MarkSelectedNodes(TreeNodeCollection nodes)
{
    foreach (TreeNode n in nodes)
    {
        if (n.Checked)
            n.BackColor = Color.Black;

        MarkSelectedNodes(n.Nodes);
    }
} 
```

并这样称呼它：

```
MarkSelectedNodes(treeView1.Nodes); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T22:21:33.867

您还可以“展开”递归以提高性能并避免堆栈溢出：

```
private static void MarkSelectedNodes(TreeNodeCollection nodes)
{
    Stack<TreeNode> toProcess =
        new Stack<TreeNode>(nodes.OfType<TreeNode>());

    while (toProcess.Count != 0)
    {
        TreeNode node = toProcess.Pop();
        if (node.Checked)
            node.BackColor = Color.Black;

        foreach (TreeNode child in node.Nodes)
            toProcess.Push(child);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T22:08:52.740

您需要在子节点中再降一层。相同的代码，只是另一个循环：

```
TreeNodeCollection nodes = this.treeView1.Nodes;
        foreach (TreeNode n in nodes)
        {
            foreach (TreeNode c in n.Nodes)
            {
                if (c.Checked)
                {
                    c.BackColor = Color.Gray;
                }
            }
            if (n.Checked)
            {
                n.BackColor = Color.Black;
            }
        } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T22:20:55.730

```
 public static IEnumerable<TreeNode>
                           GetAllCheckedChildNodes(TreeNode node)
    {
        foreach (TreeNode tmpNode in node.Nodes)
        {
            if (tmpNode.Checked)
            {
                yield return tmpNode;
            }

            foreach (var x in GetAllCheckedChildNodes(tmpNode))
            {
                yield return x;
            }
        }
    }

    private void button1_Click(object sender, EventArgs e)
    {
        var checkedNodes = GetAllheckedChildNodes(MyRootNode);
        foreach (TreeNode checkedNode in checkedNodes)
        {
            checkedNode.BackColor = Color.Black;
        }
    } 
```

# arrays - 如何交换数组元素？

> ID：14531046
> 
> 赞同：0
> 
> 时间：2013-01-25T22:02:27.980
> 
> 标签：arrays, sorting, unity3d, swap, unityscript

我有一个数组（在 Unity3D 的 UnityScript 文件中），它具有作为游戏对象的检查点，我正在尝试编写一个函数来交换它们。所以我有

```
public var cps: GameObject[]; //Initializes correctly

function swap(o1:GameObject,o2:GameObject)
{
    var TempGO:GameObject = o1;
    o1=o2;
    o2=TempGO;
}

swap(cps[0],cps[1]); // nothing happens here. 
```

我应该使用指针（不确定它们是否存在于 js 中）还是其他东西？

ps：我实际上是在尝试根据它们到某个点的距离在它们之间进行排序，所以任何其他建议也将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T22:04:06.587

如果要交换数组中的两个元素，则需要传递数组 + 两个索引。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T22:06:50.480

Javascript通过值传递一切，你不能通过引用传递事物，并且没有指针。因此，如果你想交换两个元素，你需要给它数组和索引：

```
function swap(var arr:GameObject[], var i, var j) {
    var temp:GameObject = arr[i];
    arr[i] = arr[j];
    arr[j] = temp;
} 
```

并称它为

```
swap(cps, 0, 1); 
```

# json.net - json.net , 将对象转换为 json 属性中的 xml 数据

> ID：14531048
> 
> 赞同：0
> 
> 时间：2013-01-25T22:02:31.597
> 
> 标签：json.net

我正在尝试找到一种使用 json.net 将对象序列化为 json 的方法。我试图序列化的对象有一个 XElement 属性，我想保持原样。

有没有办法在 json.net 中做到这一点？或者在 json 对象中传输 xml 数据的机制是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T22:06:11.990

你可以这样做

```
 //convert XML node contained in string xml into a JSON string   
 XmlDocument var = new XmlDocument();
 var.LoadXml(xml);
 string jsonsting = JsonConvert.SerializeXmlNode(var); 
```

[请参阅此链接以获取更多帮助](http://ajaxian.com/archives/jsonnet-11-converting-between-xml-and-json)

# git - git flow release 以包含空格的消息结束

> ID：14531054
> 
> 赞同：7
> 
> 时间：2013-01-25T22:03:10.663
> 
> 标签：git, git-flow

我怎样才能提供一个真实的消息`git flow release finish`？

这就是我的尝试，它的输出如下所示：

```
> git flow release finish -m 'Release 0.0.4 - Fixing a bug' 0.0.4
flags:FATAL the available getopt does not support spaces in options 
```

我可以让它工作的唯一方法是当我不在消息中使用任何空格时。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-28T20:40:07.467

我有同样的问题，但得到不同的错误信息：

```
$ git flow release finish -m 'Release 0.0.4 - Fixing a bug' 0.0.4
fatal: too many params
Tagging failed. Please run finish again to retry. 
```

设法想出了一个非常难看的解决方法，但似乎对我有用，这使得它可以在脚本中使用。

这个想法是：

1.  使用标签消息填充文件
2.  将 git 编辑器命令设置为简单的移动命令（git 为我们提供了目标目的地）
3.  完成 git flow 发布
4.  取消设置 git 编辑器命令

不知道您使用的是哪个操作系统，但这是我在 Ubuntu 上使用的序列。

```
$ echo 'Release 0.0.4 - Fixing a bug' > .git/MY_TAGMSG
$ git config core.editor "mv .git/MY_TAGMSG"
$ git flow release finish 0.0.4
$ git config --unset core.editor 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-05-11T15:08:07.340

尝试命令“git flow version”。

如果你有类似 0.X 的东西，让这个工作的简单方法是使用新的 CLI for git-flow

你可以在这里找到它：

[https://github.com/petervanderdoes/gitflow/wiki](https://github.com/petervanderdoes/gitflow/wiki)

所以对我来说（在 MacOsX 上）解决方案是：

```
sudo brew unlink git-flow 
sudo brew install git-flow-avh 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-28T01:12:53.467

你有最新的 gitflow 吗？您的版本似乎不支持 get-opt 选项中的空格。您应该尝试以下解决方法：

安装最新的 gitflow：

> $ git clone git://github.com/nvie/gitflow.git
> 
> $ cd gitflow
> 
> $ git svn clone -r HEAD [http://shflags.googlecode.com/svn/trunk/source/1.0](http://shflags.googlecode.com/svn/trunk/source/1.0) shFlags
> 
> $ sudo 安装

从 Homebrew 安装 gnu-opt：

> $ brew install gnu-getopt
> 
> $ echo 'export FLAGS_GETOPT_CMD="$(brew --prefix gnu-getopt)/bin/getopt"' >> ~/.bashrc
> 
> $ . ~/.bashrc # 注意句点然后 ~/.bashrc 或者只是启动一个新终端
> 
> $ 回声 $FLAGS_GETOPT_CMD

应该返回以“bin/getopt”结尾的东西，然后试试你的命令。. .

# assembly - 磁盘信息上 INT 13h 的汇编帮助

> ID：14531056
> 
> 赞同：0
> 
> 时间：2013-01-25T22:03:12.263
> 
> 标签：assembly, x86, bios

我正在使用 DOSBox 和 nasm，尝试使用 int 13 来获取硬盘信息，例如序列号等。 Int 13 需要：

```
 AH=25h
    DL=(80h,81h) and 
    ES:BX-> 512 byte buffer for reply packet. 
```

我根本不明白最后一行的要求。有什么帮助吗？

一个例子将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T02:49:57.093

寄存器`es`并`bx`提供缓冲区的远地址来接收数据，缓冲区长512字节。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T03:02:17.633

如您所知`es`，并且`bx`是 16 位寄存器。

`es`是段，`bx`而是偏移量。

如果将它们连接起来`[es:bx]`，您将获得指向“缓冲区”的完整 32 位地址（AKA 指针），数据将从磁盘设备复制到该缓冲区。

这是一个适合您的片段：

```
xor ax,ax
mov ah,25h
mov dl,80; 81h is for write probably
mov bx,0h
mov es,0800h
int 13 
```

# algorithm - 如何根据严格规范的多边形剪裁线

> ID：14531057
> 
> 赞同：0
> 
> 时间：2013-01-25T22:03:14.720
> 
> 标签：algorithm, graphics, clipping

我需要在一个非常规范的多边形上剪下一条线。多边形将始终是一个矩形，沿欧几里得轴定向，并且可能有“截断”的角。看看这张照片，看看我的意思。

![在此处输入图像描述](../Images/c531d875c450719986433dee805e843e.png)

可以切割拐角，以便在其中一个边缘形成一个点，但不会更多。在某些情况下（实际上，大多数情况下）不会切角，我已经实现了 Cohen-Sutherland 算法来处理这些情况，但是当切角时我不知道该怎么做。我想有一些通用算法可以根据多边形剪裁一条线，但我对此知之甚少。此外，对于我的情况，这可能是矫枉过正。我正在处理的多边形总是简单的、凹的和单调的。有什么好的（最好是简单的）算法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T22:17:47.130

这是一种方法：

```
For each side of a convex polygon
  p = the intersection point between line and the polygon side
  if p lies between the endpoints of the polygon side, save point p
  if there are two saved points then exit the loop
next 
```

在两点之间画一条线作为答案。小心线是否穿过多边形顶点——舍入错误可能会导致问题。

# jquery - 选项卡的后退/前进按钮 - JQuery

> ID：14531059
> 
> 赞同：0
> 
> 时间：2013-01-25T22:03:33.510
> 
> 标签：jquery

好的，所以我有一组选项卡，单击它们时会更改主要内容区域中的内容。这就是这里的代码：

```
var $items = $('.itembox');
$items.click(function() {
    $items.removeClass('current');
    $(this).addClass('current');

    var index = $items.index($(this));
    $('.currentbox').hide().eq(index).show();

}).eq(0).click(); 
```

但是，我也有一个*后退*/*forward* 按钮可以在选项卡之间切换，但我不确定如何实现这些按钮以及如何使用这些选项卡。

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T22:34:18.680

这是一个概念证明，可以帮助您入门。如果您在最后一个选项卡上并按下一步，它将转到第一个选项卡。

[http://jsfiddle.net/AraYd/1/](http://jsfiddle.net/AraYd/1/)

一些重要的代码：

```
 $('#next').click(function(){
     if(index+1 <= $items.length-1) {
        $items[index+1].click(); 
     } else {
       $items[0].click();   
     }
});

   $('#prev').click(function(){
     if(index-1 >= 0) {
   $items[index-1].click(); 
     } else {
     $items[$items.length-1].click();   
     }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T22:52:10.637

这是另一种方式，存储当前（奖励是单击第一个上的“返回”，将您带到最后一个），并且您始终可以从按钮查询数据:)

```
 var $items = $('.itembox');
 $items.click(function () {
     $items.removeClass('current');
     $(this).addClass('current');
     var index = $items.index($(this));
     $('#back').data("currentIndex", index - 1);
     $('#forw').data("currentIndex", index + 1);
     $('.currentBox').hide().eq($(this).index()).show();
 }).eq(0).click();
 $('#back, #forw').click(function () {
     $items.eq($(this).data("currentIndex")).click();
 }); 
```

工作样本：http: [//jsfiddle.net/gXpa3/](http://jsfiddle.net/gXpa3/)

# backbone.js - Slim 框架路由参数设置

> ID：14531061
> 
> 赞同：0
> 
> 时间：2013-01-25T22:03:37.300
> 
> 标签：backbone.js, routes, slim

**我正在尝试使用 Slim 框架进行路由，为网上商店构建实时聊天。**

我的消息数据库表有一个名为

```
 message_key 
```

这包含一个生成的 md5。

每次当用户决定聊天时，他/她都会使用生成的 md5 字符串向该表发布一条消息。这样我可以返回所有具有相同值的消息

```
 message_key 
```

**当我打电话给我的路线时：**

```
/api/msgs/60f0c8ce4733094b68af71c471cf1139 
```

它给我一个错误：

```
{"error":{"text":SQLSTATE[42S22]: Column not found: 1054 Unknown column
 '60f0c8ce4733094b68af71c471cf1139' in 'where clause'}} 
```

但是当我将`message_key`列的值更改为数字时，我没有收到错误：

```
 /api/msgs/7272 
```

然后我得到漂亮的 JSON 作为回报。

这是怎么发生的？

**有没有办法可以使用各种字符作为路由参数？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T00:27:06.710

要回答这个问题，我们需要更多信息。从错误中可以清楚地看出，至少在某些时候消息键被设置为 SQL 中的列名。

您是否为 message_key... '/api/msgs(/:message_key)' 或只是 '/api/msgs' 定义了一个带有段的路由？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T21:42:07.720

每当你遇到这样的问题时，这意味着你试图匹配一个列而不是一个值。在这种情况下，需要将 VALUE 包装在 WHERE 子句中：

```
 WHERE message_key = '$key'; 
```

在我尝试这样做之前：

```
 WHERE message_key = $key; 
```

...这会导致查询尝试匹配名为 60f0c8ce4733094b68af71c471cf1139 的列

_**所以总是检查你是否匹配 VALUES 或 COLUMNS _**

# php - .htaccess 和 HTTP_COOKIE 值

> ID：14531062
> 
> 赞同：0
> 
> 时间：2013-01-25T22:03:44.280
> 
> 标签：php, apache, .htaccess, cakephp

在我的 .htaccess 文件中：
对于正确的 Cookie，我使用它，如果我检查是否存在 cookie 就可以了。

```
 RewriteCond %{HTTP_COOKIE} (my\_cookie) [NC] 
```

但是当我尝试检查零值并使用这些选项时，它无法匹配案例：

```
RewriteCond %{HTTP_COOKIE} ^.*my\_cookie=0.*$ [NC]
RewriteCond %{HTTP_COOKIE} my\_cookie=0 [NC]
RewriteCond %{HTTP_COOKIE} (my\_cookie=0) [NC] 
```

当我做`print_r ( $_COOKIE );`我得到这个：

```
Array
(
    [analytics] => true
    [CakeCookie] => Array
        (
            [my_cookie] => 0
            [newuser] => 1
        )
) 
```

我如何检查这种情况下的 cookie 值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T22:31:59.147

我对句柄语言使用相同的解决方案：

```
RewriteEngine On
RewriteBase /
RewriteCond %{HTTP_COOKIE} lang=([^;]+) [NC]
RewriteRule ^(.*)$ /$1?lang=%1 [NC,L,QSA] 
```

但我检查 php 文件中的值。我希望它对你有帮助；）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T11:11:03.460

经过太多的试用，这解决了我的问题：

```
RewriteCond %{HTTP_COOKIE} CakeCookie.*my\_cookie.*=0 
```

我仍然不知道确切的模式是什么，`.*`
但是这个有效。

# xml - 如何执行两部分 XSLT

> ID：14531064
> 
> 赞同：0
> 
> 时间：2013-01-25T22:03:46.580
> 
> 标签：xml, xslt

我将如何改变这个

```
<CHAPT>
  <CHAPTNO>1.1</CHAPTNO>
  <SUBJ>Introduction</SUBJ>
  <P>foo text</P>
  <P>foo text</P>  .. and so on
</CHAPT> 
```

对此：

```
<p class="chapheader"><span class="chapnumbers">1.1 </span>Introduction</p>
<P>foo text</P>
<P>foo text</P> 
```

***但是***，只有`<CHAPTNO>`直接在 .. 之前`<SUBJ>` 还有其他`<SUBJ>`不遵循 a 的`<CHAPTNO>`，我不希望将那些独立的主题行格式化为章节标题。

我是 XSLT 的新手，被我的第二个模板卡住了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T22:51:52.230

尝试这个。这是我的示例 XML（我添加了一个根元素只是为了测试）：

```
<root>
<CHAPT>
  <CHAPTNO>1.1</CHAPTNO>
  <SUBJ>Introduction1111</SUBJ>
  <P>foo text</P>
  <P>foo text</P>  
</CHAPT>
<CHAPT>
  <SUBJ>Introduction2222</SUBJ>
  <P>foo text</P>
  <P>foo text</P>  
</CHAPT>
<CHAPT>
  <CHAPTNO>3333</CHAPTNO>
  <SUBJ>Introduction3333</SUBJ>
  <P>foo text</P>
  <P>foo text</P>  
</CHAPT>
</root> 
```

XSLT：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output method="html" encoding="utf-8" indent="no"/>
 <xsl:template match="/">
        <xsl:for-each select="root/CHAPT">
        <xsl:if test="SUBJ[count(../CHAPTNO)=1]">
           <p class="chapheader"> 
           <span class="chapnumbers"><xsl:value-of select="CHAPTNO"/></span>
                     <xsl:value-of select="SUBJ"/>
             </p>
        </xsl:if>
     </xsl:for-each>
 </xsl:template>
</xsl:stylesheet> 
```

结果输出：

```
<p class="chapheader"><span class="chapnumbers">1.1</span>Introduction1111</p>
<p class="chapheader"><span class="chapnumbers">3333</span>Introduction3333</p> 
```

# python - 如何计算图像中的错误？

> ID：14531072
> 
> 赞同：12
> 
> 时间：2013-01-25T22:05:11.130
> 
> 标签：python, image-processing, computer-vision

我有一张像下面这样的图片，我想计算用 Python 显示在上面的错误（颜色/灰色的连续斑点）的数量。我怎样才能做到最好？

![嘈杂背景中的臭虫](../Images/763606ea47bdd8365509f00098199006.png)

到目前为止，我已经看过 ImageChops、SciPy 和 PIL，但我不确定我可以/应该使用什么......

我想我可以使用`ndimage.gaussian_filter()`，然后`scipy.ndimage.measurements.label()`只是不确定如何使用后者来计算高斯化图像中的蓝点……它看起来像![在此处输入图像描述](../Images/f47c0c1fd43cb918fed500dc31395210.png)

* * *

好的，

有了上面的图片，我现在得到了这个代码：

```
#! /usr/bin/python

import numpy as np
import scipy
import pylab
import pymorph
import mahotas
from PIL import Image
import PIL.ImageOps
from scipy import ndimage

image = Image.open('bugs.jpg')   
inverted_image = PIL.ImageOps.invert(image)    
inverted_image.save('in_bugs.jpg')
dna = mahotas.imread('in_bugs.jpg')
#pylab.imshow(dna)
pylab.gray()
#pylab.show()
T = mahotas.thresholding.otsu(dna)
pylab.imshow(dna > T)
#pylab.show()
dnaf = ndimage.gaussian_filter(dna, 8)
T = mahotas.thresholding.otsu(dnaf)
pylab.imshow(dnaf > T)
#pylab.show()
labeled,nr_objects = ndimage.label(dnaf > T)
print nr_objects
pylab.imshow(labeled)
pylab.jet()
pylab.show() 
```

问题是，这给我返回了一个数字 5，这并不是那么糟糕，但我需要让它更准确，我想看到两个。我怎样才能做到这一点？在应用高斯滤波器之前模糊图像是否有帮助？

感谢帮助！

罗恩

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-26T02:00:01.380

您的高斯滤波已经很好了，但是您正在考虑比任务所需的半径要大。例如，让我们以半径为 15 的内核为例。这是我们得到的表示：

![在此处输入图像描述](../Images/e9bf4d4d3d0b2d72e96ef9507efcfd63.png)

有两个清晰的谷（是的，显示为峰值），过滤图像的直方图显示大部分可用数据现在接近可能的最大值。

![在此处输入图像描述](../Images/3b346b35db9c6289e608572620079b01.png)

只考虑直方图的一部分，我们可以更好地看到我们感兴趣的数据部分：较暗的点。

![在此处输入图像描述](../Images/a35255c896be3064bcaa6ea2731908f4.png)

因此，使用一个简单的阈值`0.5`就是结果（与错误所在的位置相匹配）：

![在此处输入图像描述](../Images/d882ce610be44056429bb520b8a1c70a.png)

根据您实现（或您使用的库实现）相关功能的方式，此阈值会有所不同。但是通过查看直方图，您将能够发现一个好的阈值。现在，如果您不想通过查看直方图来猜测这个阈值，那么您需要在高斯滤波之外对图像进行预处理。通过以良好的方式执行此步骤，您的图像变得足够简单，以至于像 Otsu 给出的方法可以自动找到您所追求的阈值。执行形态关闭，然后执行形态打开，然后由 Otsu 二值化，这是我们得到的结果：

![在此处输入图像描述](../Images/d7a77688bc91526695e5ec75ed3a50cd.png)

形状更接近最初的形状，因为我们没有依赖线性低通滤波器，它充其量只会模糊轮廓。

编辑：

由于问题现在包含一些代码，我觉得有必要解释为什么使用 Otsu 作为代码是错误的。Otsu 给出的阈值方法实际上期望数据是双峰的，但正如上面的直方图所示，这里的情况并非如此。Otsu 将提供一个太接近右侧巨大峰值的阈值，而 0.5 的好点则离那里很远。要复制此答案中显示的第一个结果，这里有一些基本代码：

```
import sys
import numpy
from PIL import Image
from scipy.ndimage import gaussian_filter, label

img = Image.open(sys.argv[1]).convert('L')
im = numpy.array(img)

im_g = gaussian_filter(im, 3)
im_norm = (im_g - im_g.min()) / (float(im_g.max()) - im_g.min())
im_norm[im_norm < 0.5] = 0
im_norm[im_norm >= 0.5] = 1

result = 255 - (im_norm * 255).astype(numpy.uint8)
print u"Objects: %d" % label(result)[1]

Image.fromarray(result).save(sys.argv[2]) 
```

请注意，此代码使用`sigma = 3`（最初使用 7.5）用于高斯内核，从`scipy`内部构建一个半径比它大 4 倍的窗口。对于这个特定的图像，`sigma`从 2 到 10 的大量作品也应该给出相同的结果——检测到 2 个对象。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-25T22:20:09.343

这是计算机视觉的一项任务，您可以使用流行的[OpenCV](http://opencv.willowgarage.com/documentation/python/index.html)来解决。

您可能需要考虑使用一些形态学操作（例如[opens](http://en.wikipedia.org/wiki/Opening_%28morphology%29)）来处理图像以消除噪声。也许那时您可以计算面积超过某个阈值的连续斑点的数量。

* * *

一些要研究的资源：

*   [物体识别（维基百科）](http://en.wikipedia.org/wiki/Object_recognition)
*   [计算机视觉（维基百科）](http://en.wikipedia.org/wiki/Computer_vision)
*   [OpenCV 食谱](http://opencv.willowgarage.com/documentation/python/cookbook.html)

# php - 表单后发布到用户墙

> ID：14531073
> 
> 赞同：0
> 
> 时间：2013-01-25T22:05:17.340
> 
> 标签：php, facebook, facebook-php-sdk

首先谢谢你！感谢这个社区编辑 FB 应用程序也为我提供了一些可能。其次，对不起我的英语不好。

这是我的问题：我想在用户的墙上发布一条消息，但前提是他们想要。所以我设置了一个表单，用户可以选择是否在他们的墙上发布内容。问题是当用户发送表单时，我收到一条错误消息：OAuthException: (#200) 用户尚未授权应用程序执行此操作。所以我确定它与访问令牌有关，但我不明白出了什么问题。这是我的代码：

```
<?php
require_once "fb_app/facebook.php";
$facebook = new Facebook(array(
    'appId'  => '***',
    'secret' => '***',
    'cookie' => true
));
function grokSignedRequest() {
    if (isset($_REQUEST['signed_request'])) {
      $encoded_sig = null;
      $payload = null;
      list($encoded_sig, $payload) = explode('.', $_REQUEST['signed_request'], 2);
      $sig = base64_decode(strtr($encoded_sig, '-_', '+/'));
      $data = json_decode(base64_decode(strtr($payload, '-_', '+/'), true));
      return $data;
    }
    return false; }
$userID = $facebook->getUser(); 
$sr_dati = grokSignedRequest();
$firendsWall=$_POST['firendsWall'];
$likeStatus=$_POST['likeStatus'];
if ($sr_dati->page->liked==1 or $likeStatus==1) {
if ($userID) { // Checks if there is already a logged in user
  try {
    // Proceed knowing you have a logged in user who's authenticated.
    $user_profile = $facebook->api('/me');
  } catch (FacebookApiException $e) {
    // Will throw the very first time as the token is not valid
    error_log($e);
    $userID = null;
   }
}

if(empty($userID)) {  
    # There's no active session, let's generate one  
    $login_url = $facebook->getLoginUrl(array(  
        "response_type"=>"token", //Can also be "code" if you need to 
        "scope" => 'email,user_birthday,status_update,publish_stream,user_photos,user_videos,photo_upload,user_status' , 
        "redirect_uri"=> "http://www.facebook.com/pages/V....." //Your app callback url 
    ));  
    echo "<script type='text/javascript'>top.location.href = '" . $login_url. "';</script>";  
    exit;  
} 
//pubblico contenuto sulla bacheca di un utente
if ($firendsWall==1){
    try {$args = array(
    'message'   => 'Hello',
    'link'      => 'aaaa',
    'caption'   => 'vvvvvv!'
);
$post_id = $facebook->api("/".$userID."/feed", "post", $args);}
 catch (FacebookApiException $f) {
    // Will throw the very first time as the token is not valid
    echo $f;} }}
?> 
```

# iphone - 如何以标签栏控制器的视图作为根视图创建一个新的基于最小 nib 的 iPhone 应用程序？

> ID：14531082
> 
> 赞同：0
> 
> 时间：2013-01-25T22:05:47.913
> 
> 标签：iphone, ios6, uitabbarcontroller, xcode4.5

我正在尝试了解“基于经典 nib”和“基于故事板”的 iPhone 开发工作流程之间的区别，以及它们各自的编码风格和方法。

因此，我在 XCode 4.5 中创建了一个新的空 iPhone 应用程序，使用 iOS -> Application -> SingleView Application 作为我的模板。我希望了解如何将其转换为以标签栏控制器作为根控制器和我的应用程序的根视图的应用程序。

我删除了 iPhone 笔尖中的空根视图，并尝试用 TabBarController 的视图替换该视图：

![在此处输入图像描述](../Images/03f7e009706e47fb93bfc2bd7219fedd.png)

在运行时，我得到这个异常并且应用程序中止：

```
"A view can only be associated with at most one view controller at a time" 
```

很明显，我在这里违反了一条规则，并且不允许将 TabBarController 与 View 关联，然后使该 View 也成为 File's Owner 连接指向的视图。那么执行此操作的正常惯用方法是什么？把原来的空视图留在原地，然后在运行时让tabbarcontroller视图变成一个子视图？还是其他什么技术？

注意：我不是要求选择不同的模板，也不是如果这种方式涉及故事板，如何最容易地做到这一点。我在问如何做到这一点，没有故事板，只有经典的笔尖，我想了解笔尖实例化的“股票 ui 选项卡控制器”对象如何工作。

更新：我可以通过摆脱默认的模板生成单视图模板的视图控制器对象来摆脱错误。现在我有一个应用程序，它链接和运行一个黑色的空窗口，没有可见的根视图。我尝试使用 Interface Builder 将 IUTabBarController 连接到应用程序委托的属性：

```
@property (strong, nonatomic )IBOutlet UIViewController *viewController; // I added IBOutlet 
```

在我的应用委托中：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    _window.rootViewController = _viewController;
} 
```

然后我将该插座连接到 nib 实例化的 UITabBarController 对象：

![在此处输入图像描述](../Images/a913bb3b694240227c6cda29a30ba67d.png)

在我看来，这应该奏效。我可以运行，但我没有根视图。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T15:02:25.430

标题中的问题很容易回答；为基于选项卡的用户界面选择 iOS 模板，然后取消选中“使用情节提要”。

然而，上面的基本问题，我试图在这里自我回答的是，如果我取消选中“使用故事板”并选择“选项卡式用户界面”，新用户需要了解 XCode 将生成的样板代码，使用模板我应该使用的，足够我自己写的。

我的问题是我不了解视图控制器类的关系以及它们是如何实例化的，并且我忽略了 appcontroller.m 文件中的样板代码。我把它放在我面前，但我没有看到它。

1.  为每个页面创建一个视图控制器类。

2.  Apple 演示不直接使用 UITabBarController 子视图，它们在运行时将它的父级放到一个空白的 nib 视图上：

    ```
     [self.window addSubview:self.tabs.view]; 
    ```

当然，苹果样本来自 iOS 4.0 时代。

优秀的示例代码，用于参考使用标签栏控制器作为根 UI 小部件的简单应用程序：[Apple 的简单 FTP 示例](http://developer.apple.com/library/ios/#samplecode/SimpleFTPSample/Introduction/Intro.html)，但它不是一个完美的示例，因为苹果示例为标签栏控制器中的每个页面使用不同的 nib，并且需要更多样板代码，因为它来自 iOS 3.0 时代。

## 然而，这个答案并不完美，因为它没有回答“使用当前框架，iOS 6.0/6.1 时代的原生和预期习语是什么”这个问题。

# c# - 使用 C# devkit，我如何访问发票行的 ItemId、UnitPrice 和 Qty

> ID：14531083
> 
> 赞同：0
> 
> 时间：2013-01-25T22:05:56.793
> 
> 标签：c#, intuit-partner-platform

我正在尝试使用标准 AnyWhere C# SDK 将新发票行插入 QB。
但是当我尝试以下操作时，未定义 ItemId、UnitPrice 和 Qty（不是对象 InvoiceLine 的元素）。

```
Intuit.Ipp.Data.Qbo.InvoiceLine  InvLine  = new Intuit.Ipp.Data.Qbo.InvoiceLine();

InvLine.ItemId     =     17;
InvLine.Desc       = "DEMO";
Invline.UnitPrice  = 100.00;
InvLine.Qty        =      4;
InvLine.Amount     = 400.00;
...    
Intuit.Ipp.Data.Qbo.Invoice  results_set = commonService.Add(Invoice); 
```

我看到了另一个非常相似的帖子，但我似乎遇到了相反的问题。
有谁知道我做错了什么（他们可能以不同的名字出现）？
（要温柔——我是两天新手）
谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T22:39:19.057

某些属性是通过 Items/ItemsElementName 属性设置的。

```
Intuit.Ipp.Data.Qbo.InvoiceLine  InvLine  = new Intuit.Ipp.Data.Qbo.InvoiceLine();
InvLine.Desc = "DEMO";
InvLine.Amount = 400.0m;
InvLine.AmountSpecified = true;
InvLine.ItemsElementName = new Intuit.Ipp.Data.Qbo.ItemsChoiceType2[]
                                {
                                    Intuit.Ipp.Data.Qbo.ItemsChoiceType2.ItemId,
                                    Intuit.Ipp.Data.Qbo.ItemsChoiceType2.Qty,
                                    Intuit.Ipp.Data.Qbo.ItemsChoiceType2.UnitPrice
                                };
InvLine.Items = new object[]
                    {
                        new IdType(){idDomain=idDomainEnum.QB, Value="17"},
                        4m,
                        100m
                    }; 
```

跟你是新手没关系。DevKit 是直接从 IDS 服务模式构建的，因此具有此限制。如果你像我一样直接进入编码领域，这并不容易弄清楚。

这是我的 PasteBin 以及更多示例： [http ://pastebin.com/u/IDNPeterL](http://pastebin.com/u/IDNPeterL)

# delphi - 我需要 Delphi 的组件来创建一个可以通过皮肤美化的 Web 应用程序

> ID：14531084
> 
> 赞同：2
> 
> 时间：2013-01-25T22:06:00.643
> 
> 标签：delphi, vcl, intraweb, raudus

在 C# 中。NET 是目前的 WPF，它允许您创建桌面应用程序，而无需更改源代码也可以作为 IIS 的 Web 应用程序工作。对于 Delphi，我发现只有 unigui.com 和 raudus.com 可能不太稳定。它可以作为普通的 VCL、WebServer Embedded 和 IIS 或 Apache Win32 的 ISAPI 工作。您是否使用过或至少听说过其他类似的 Delphi 库？（或者在 XE2 或 XE3 中可能有类似的东西）

我需要这些组件来创建一个可以通过皮肤美化的 Web 应用程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T10:54:25.210

如果必须是 Delphi，那么在桌面上运行 Web 应用程序（在浏览器中）是否足以作为“桌面应用程序”？
在这种情况下，我建议使用 Delphi 附带的 Intraweb。您可以制作两个使用相同单元/表单的项目：一个使用内置网络服务器运行的 EXE，以及一个可以安装在 IIS 上的 ISAPI DLL。
这两个程序将有不同的项目文件，并且您必须在整个代码中使用一些 IFDEF，具体取决于您正在编译的版本（例如，在定义文件位置时）。

至于皮肤：Intraweb 页面带有一个设置（将 TIWTemplateProcessorHTML 设置为表单 LayoutMgr 属性），页面渲染必须在“外部”完成，因此您可以依赖正确的 HTML/CSS 渲染；并且更新外观和感觉可能就像更改 CSS 文件一样简单。

缺点是 Intraweb 的学习曲线相当陡峭，并且所有表单组件都必须是 Intraweb 组件——这可能会限制您可以做的事情（查看 IDE 中的 Intraweb 面板）。
[Intraweb 文档仍然不足](https://forums.embarcadero.com/thread.jspa?threadID=71709&tstart=0)，我不知道它现在如何（并且您可能需要[更新到标准版或专业版](http://docs.atozed.com/docs.dll/technical%20information/Feature%20Matrix%20And%20Supported%20enviroments.html)）。[幸运的是，从Embarcadero 论坛等帖子](https://forums.embarcadero.com/forum.jspa?forumID=93)
来看，仍然有相当多的人在构建 Intraweb 应用程序，甚至有像[TMS 这样的公司提供额外的组件](http://www.tmssoftware.com/site/tmsiwpro.asp)。 （我不再是其中之一，但这与 Intraweb 无关）

# mysql - 为什么在 MySQL 中使用 CAST 时会出现语法错误？

> ID：14531087
> 
> 赞同：10
> 
> 时间：2013-01-25T22:06:29.037
> 
> 标签：mysql, sql, mysql-workbench

我正在使用 MySQL 工作台 v5.2.44 CE。我正在针对本地 MySQL 5.5 安装运行它。

我正在尝试使用该`CAST`功能，但不断收到以下错误：

> 语法错误，意外的 INT_SYM

源日期类型和目标日期类型无关紧要。唯一没有给我错误的是目标数据类型是`DECIMAL`. 这是一个例子：

```
SELECT CAST(IFNULL(comboCount, 1) * COUNT(partID) AS INT) INTO comboCount
FROM productOption 
```

我已经尝试了一切，但似乎没有任何效果。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-25T22:07:56.683

试着在外面做数学：

```
SELECT CAST(IFNULL(comboCount, 1) AS INT) * COUNT(partID) INTO comboCount
FROM productOption 
```

如果这不起作用，请尝试`CAST`as `UNSIGNED`; 不是`INT`。

# magento - Magento 相关产品总是可以销售的吗？

> ID：14531088
> 
> 赞同：1
> 
> 时间：2013-01-25T22:06:41.820
> 
> 标签：magento

我在 Magento 中有一个分组产品。在显示与组关联的项目之前，我想确保每个关联的产品都是可销售的。我正在通过在简单产品的管理员中切换“启用/禁用”状态进行测试。

```
$sku = 'SKU1234'; // grouped product
$cpm = Mage::getModel('catalog/product');

$grouped_product = $cpm->load($cpm->getIdBySku($sku));
$associated = $cpm->getTypeInstance(true)->getAssociatedProducts($grouped_product);

foreach ($associated as $a_p) echo $a_p->isSaleable(); 
```

无论关联产品的禁用/启用状态如何，上面总是为每个关联产品打印一个“1”，而我希望“禁用”为“2”。

我错过了什么？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T21:00:20.993

有时该`echo`命令在输出页面上无法正常工作。

尝试在后端启用日志系统并使用 log 命令：

```
Mage::log($a_p->isSaleable()); 
```

还尝试记录 $associated 数组以获取有关返回类的更多信息。也许你不能使用

```
$a_p->isSaleable(); 
```

你必须使用

```
$a_p->getProduct()->isSaleable(); 
```

# android - 主题继承在 Android 中究竟是如何工作的？

> ID：14531093
> 
> 赞同：10
> 
> 时间：2013-01-25T22:07:02.033
> 
> 标签：android

我有以下主题`res/values/styles.xml`：

```
<?xml version="1.0" encoding="utf-8"?>
<resources xmlns:android="http://schemas.android.com/apk/res/android">
    <style name="AppBaseTheme" parent="@android:style/Theme.NoTitleBar">
    </style>

    <style name="AppTheme" parent="AppBaseTheme">
        <item name="android:windowNoTitle">true</item>
    </style>
</resources> 
```

如果我删除该`<item name="android:windowNoTitle">true</item>`行，我的活动就会有标题栏。但是，如果我将那条线保留在那里，那么它们就没有标题栏（这是我想要的）。

我很好奇为什么`parent="@android:style/Theme.NoTitleBar"`似乎没有效果？`parent`不做我认为的事情？我认为它是这样工作的：

```
@android:style/Theme.NoTitleBar --> AppBaseTheme --> AppTheme
^                                   ^                ^
|                                   |                |
|                                   |                Has everything AppBaseTheme
|                                   |                does, unless it's overridden
|                                   |
|                                   Has everything @android:style/Theme.NoTitleBar
|                                   does, unless it's overridden (which I'm not
|                                   doing)
|
Sets whatever it needs to to not have a title, which I assume
is done by setting <item name="android:windowNoTitle">true</item> 
```

但是，我也发现如果我设置`<item name="android:windowNoTitle">true</item>`它`AppBaseTheme`也没有效果；我必须将它设置在`AppTheme`. 那么指定父级到底有什么意义呢？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-25T22:14:26.930

我想我刚刚想通了。事实证明，当我创建项目时，Android 创建了一个`res/values-14/styles.xml`文件，里面是`<style name="AppBaseTheme" parent="android:Theme.Holo.Light.DarkActionBar">`.

It turns out that the `res/values-14/styles.xml` file was overriding my default `res/values/styles.xml` because the device I was testing on has API level 14, and thus it preferred the files in `values-14` than the default `values`.

Inheritance does seem to work like I thought it did; I just wasn't realizing things were being overridden by the files created when I first made my project.

# asp.net-mvc - 带有输出缓存的 RenderAction 和 Partials

> ID：14531098
> 
> 赞同：2
> 
> 时间：2013-01-25T22:07:31.547
> 
> 标签：asp.net-mvc, asp.net-mvc-4, renderaction, output-caching

我目前正在设置我的 mvc4 Web 应用程序，并且有一个关于使用局部视图和渲染操作的问题。

如果我将输出缓存应用于控制器操作方法，那么在使用 RenderAction 时会保存对操作方法的请求吗？

如果我有一个包含多个部分的视图，是否可以将输出缓存应用于主视图中的一些但不是所有部分？或者我是否需要每个视图的控制器操作并将输出缓存应用于此类？我想设置它以实现最佳性能。

# ios - iOS Dismissing a popover that is in a UINavigationController

> ID：14531099
> 
> 赞同：0
> 
> 时间：2013-01-25T22:07:33.107
> 
> 标签：ios

I've been learning a lot about popovers and found out how to get them to dismiss gracefully using delegates. The issue I have now is that there is a popup in my program that is controlled with a `UINavigationController`.

When the user presses a button on my parent `ViewController`, the popover comes up as it should and the user can navigate through 3 scenes using tables. Everything works fine until it comes time to dismiss the pop over.

On the final scene I would like to dismiss the popover whenever the user presses an index. If I didn't have the `UINavigationController` attached to these views it would be easy. I don't know how to implement the delegate.

I tried making a delegate in my `UINavigationController` implementation, but XCode tells me that `UINavigationController` already has a delegate. Is there some way to use the delegate that is already there?

Any help would be greatly appreciated.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T01:11:20.213

i think using a notification might be better in this case, since your controller from which you want to start the dismissal is far removed from the popover controller which should do the dismissal (so it would be hard to set the delegate). If you're using a popover segue in a storyboard, you can get a reference to the popover controller from the segue object. From the controller which initiates the popover segue, I put this code:

```
@implementation ViewController {
    UIPopoverController *pop;
}

- (void)viewDidLoad {
    [super viewDidLoad];
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(dismissPopover) name:@"DismissPopoverNotification" object:nil];
}

-(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
    pop = [(UIStoryboardPopoverSegue *)segue popoverController];
}

-(void)dismissPopover {
    [pop dismissPopoverAnimated:YES];
} 
```

And in the last controller, where choosing a row in a table causes the popover to be dismissed, you could have this code in the didSelectRowAtIndexPath method:

```
[[NSNotificationCenter defaultCenter] postNotificationName:@"DismissPopoverNotification" object:self]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T13:40:47.280

I use notifications quite a bit to relay data back and forth. This additional line, I was unaware of...

pop = [(UIStoryboardPopoverSegue *)segue popoverController];

Yet, I do want to point out one tiny detail that was missed...

```
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(dismissPopover:) name:@"DismissPopoverNotification" object:nil]; 
```

There should be a colon after dismissPopover... see above. Without it, the compiler was crashing.

Other than that... I want to say thanks for this! It helped with one dismissal issue, and I'm going to try it on another.

# ios - 带有省略号数组参数的子类化方法？

> ID：14531100
> 
> 赞同：4
> 
> 时间：2013-01-25T22:07:33.937
> 
> 标签：ios, objective-c

我想子类化一个在 init 标头中具有省略号语法的对象。IE

```
-(void) initObjectWith:(NSString*)argument arguments:(NSString*)someArgument,...; 
```

在这种情况下，我不确定如何传递参数数组。我怀疑它会是这样的：

```
- (void) initObjectWithCustomInitializer:(NSString*)argument additionalArgument:(NSString*)additionalArgument argument:(NSString*) someArgument,... {
  self = [super initObjectWith:argument arguments:someArgument,...];
  if (self) {
     //custom init code here
  }
  return self
} 
```

这可以编译，但以 nil 结尾的“参数”数组只得到第一个参数。如何传递零终止数组的对象？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-25T22:18:40.563

声明可变参数初始化器的超类也*应该*声明一个接受 a 的非可变参数`va_list`（例如，类似于 how `printf`has `vprintf`）。假设这种情况，超类同时具有：

```
-(void)init:(id)a arguments:(id)b, ...; 
```

和

```
-(void)init:(id)a arguments:(id)b variadicArgs:(va_list)args; 
```

你会做这样的事情：

```
- (void)myInit:(id)a newArg:(id)c arguments:(id)b, ...
{
    va_list v;
    va_start(v, b);

    self = [super init:a arguments:b variadicArgs:v];
    if (self) {
        //custom init code here
    }

    va_end(v);
    return self;
} 
```

当然，您也应该确保拥有新初始化程序的非可变版本！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-26T05:10:53.083

`...`由于 varargs 的实际实现方式以及 C 语言的限制，如果没有-taking函数来调用，则不可能将 args 传递到调用链`va_list`中，除非您：

1.  使用适用于您的代码可能运行的每个平台的汇编语言
2.  了解编译器如何实现`va_list`等的详细信息，或
3.  尝试编写一个函数，以某种方式计算参数类型的每种可能组合并手动传递它们。

在这些选项中，(3) 在任何实际情况下显然是不切实际的，(2) 可能随时更改，恕不另行通知。这给我们留下了（1），用于您的代码运行的每个平台的汇编语言。

在内部，可变参数以特定于 ABI 的方式为每个架构实现。从概念上讲，`...`“我将传递我想要的所有参数，就好像我正在调用一个接受这些参数的函数一样，由你决定从哪里获取每个参数。” 让我们以在堆栈上传递其所有参数的架构为例，例如`i386`在 OS X 和 iOS 模拟器上。

给定以下函数原型和调用：

```
void f(const char * const format, ...);
/* ... */
f("lUf", 0L, 1ULL, 1.0); 
```

编译器将生成以下程序集（由我编写；真正的编译器可能会产生一些不同的调用序列，但效果相同）：

```
leal L_str, %eax
pushl %eax
movl $0x3f800000, %eax
pushl %eax
movl $0x00000000, %eax
pushl %eax
movl $0x00000001, %eax
pushl %eax
movl $0x00000000, %eax
pushl %eax
call _f 
```

这样做的效果是将每个参数以相反的顺序压入堆栈。这是秘诀：*如果这样声明，编译器也会做同样的事情`f()`：*

```
void f(const char * const format, long arg1, unsigned long long arg2, float arg3); 
```

这意味着如果您的函数可以复制堆栈的参数区域并调用 vararg-taking 函数，则 args 将简单地通过。问题：没有通用的方法来计算这个参数区域有多大！On `i386`，在具有帧指针的函数中，该函数也从具有帧指针的函数调用，您可以作弊和复制`rbp - *rbp`字节，但这效率低下并且不适用于所有情况（尤其是带`struct`参数或返回`struct`s 的函数）。

然后你有像`armv6`and这样的架构`armv7`，其中大多数参数在必须小心保存的`x86_64`寄存器中传递，其中参数在寄存器中传递*并且*`xmm`寄存器计数被传递`%al`，并且`ppc`，其中堆栈位置和寄存器*都*映射到参数！

在不使用 a 的情况下转发参数的唯一防弹方法`va_list`是使用每个架构的程序集在代码中重新实现整个架构 ABI 逻辑，就像编译器一样。

这也是本质上`objc_msgSend()`解决的相同问题。

“所以等等！” 你现在说。“我为什么不能直接打电话`objc_msgSend`而不是这样乱组装？！”

回答：因为你无法告诉编译器，“不要破坏堆栈上的任何东西，也不要清除任何你看不到我使用的寄存器”。您仍然必须编写一个汇编例程，将调用转发到超类实现 -*在您的子类实现中执行任何工作之前*- 然后返回到您的，同时注意相同的事情`objc_msgSend()`，例如需要`_stret`和`_fpret`变体和在至少三种架构上实现（`armv7`, `i386`, `x86_64`- 并且取决于您对向后和向前兼容性的需要，也可能`ppc`是 , `ppc64`,`armv6`和`armv7s`）。

对于普通的可变参数，编译器在创建`va_list`. C 不能直接访问任何此类信息。并且`objc_msgSend()`是 Objective-C 编译器和运行时再次重做这一切，因此您可以编写方法调用而无需`va_list`一直使用。（此外，在某些架构上，能够将参数传递给已知调用列表比使用可变参数约定更有效）。

因此，不幸的是，如果不付出比可能值得付出更多的努力，您就无法做到这一点。类实现者，让这成为你的一个教训 -**每当你提供一个接受可变参数的方法时，也提供一个接受 a`va_list`代替`...`**的相同方法的版本。`NSString`是一个很好的例子，使用`initWithFormat:`and `initWithFormat:arguments:`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T22:35:02.700

我想出了一个答案，对于任何好奇的人！长话短说，我使用了 stock 'init' 初始化器，然后通过常规 NSArray 传递参数并使用超类设置器。

```
- (id) initWithCustomInitializer:(NSString *)argument arguments:(NSArray*)moreArguments {

    self = [super init];
    if (self) {
        self.argument = argument;

        for (int i = 0; i < [moreArguments count]; i++) {
            [self addArgument:[moreArguments objectAtIndex:i]];
        }
    }
    return self;
} 
```

这被称为：

```
NSArray *moreArguments = [NSArray arrayWithObjects:@"argument0", @"argument1", @"argument2", nil];

CustomObject *myObject = [[CustomObject alloc] initWithCustomInitializer:@"argument" arguments:moreArguments]; 
```

注意：卡尔在下面提出了一些很好的观点。这个解决方案可能不是通用的，简单的 init 并不总是像 initWith... 方法那样做额外的初始化。不过，这个解决方案对我有用。

# javascript - 从 chrome.storage.sync 保存和检索

> ID：14531102
> 
> 赞同：58
> 
> 时间：2013-01-25T22:07:35.750
> 
> 标签：javascript, google-chrome, google-chrome-extension

我正在尝试将数据对象保存在 chrome 同步存储中，然后检索它，但是 get() 函数总是返回一个空对象。我正在使用的代码是，

```
function storeUserPrefs() {
    var key='myKey', testPrefs = {'val': 10};
        chrome.storage.sync.set({key: testPrefs}, function() {console.log('Saved', key, testPrefs);});
}

function getUserPrefs() {
    chrome.storage.sync.get('myKey', function (obj) {
        console.log('myKey', obj);
    });
} 
```

有人可以告诉我我在这里做错了什么吗？

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2013-01-26T03:06:35.030

问题在于`chrome.storage.sync.set({key: testPrefs}`

您的数据存储为

```
{
    key: "{"val":10}"
} 
```

因此，您的代码`chrome.storage.sync.get('myKey')`返回**undefined\empty object**。

# 解决方案一

使用字符串`"key"`作为您的密钥

```
chrome.storage.sync.get("key", function (obj) {
    console.log(obj);
}); 
```

或者

# 解决方案二

`"myKey"`通过Key设置数据。

```
chrome.storage.sync.set({"myKey": testPrefs}) 
```

**PS**：不要忘记`chrome.storage.sync`永久存储 API，在任何进一步测试之前使用[chrome.storage.sync.clear](https://developer.chrome.com/extensions/storage.html#method-StorageArea-clear)以查看更改

# 参考

*   [存储 API](https://developer.chrome.com/extensions/storage.html)

# 编辑 1

使用此代码在 Chrome.storage 中设置变量值

```
function storeUserPrefs() {
    var key = "myKey",
        testPrefs = JSON.stringify({
            'val': 10
        });
    var jsonfile = {};
    jsonfile[key] = testPrefs;
    chrome.storage.sync.set(jsonfile, function () {
        console.log('Saved', key, testPrefs);
    });

} 
```

它生成以下输出

```
Object{
    myKey: "{"val":10}"
} 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2019-01-18T21:20:31.030

一种更奇特的方法，它也可以处理错误：

```
const getStorageData = key =>
  new Promise((resolve, reject) =>
    chrome.storage.sync.get(key, result =>
      chrome.runtime.lastError
        ? reject(Error(chrome.runtime.lastError.message))
        : resolve(result)
    )
  )

const { data } = await getStorageData('data')

const setStorageData = data =>
  new Promise((resolve, reject) =>
    chrome.storage.sync.set(data, () =>
      chrome.runtime.lastError
        ? reject(Error(chrome.runtime.lastError.message))
        : resolve()
    )
  )

await setStorageData({ data: [someData] }) 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2017-05-16T14:24:45.437

```
function storeUserPrefs() {
    var key='myKey', testPrefs = {'val': 10};
    chrome.storage.sync.set({[key]: testPrefs}, function() {
      console.log('Saved', key, testPrefs);
    });
} 
```

您可以在保存时强制使用 [key] 评估变量键。这种方式很容易动态设置您的密钥。希望有帮助。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-06-28T12:35:28.193

由于 chrome.storage.sync 可以存储 JS 对象，你可以这样做：

```
var save = {};
save["myKey"] = testPrefs;

chrome.storage.sync.set(save, function() {
    console.log('Settings saved');
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-11-21T18:36:10.600

```
testPrefs = JSON.stringify({
            'val': 10
        });
    var jsonfile = {};
    jsonfile[key] = testPrefs;
    chrome.storage.sync.set(jsonfile, function () {
        console.log('Saved', key, testPrefs) 
```

# javascript - Javascript/Python - 无法点击按钮

> ID：14531109
> 
> 赞同：0
> 
> 时间：2013-01-25T22:07:48.293
> 
> 标签：javascript, python, forms, button

我正在使用 Python 的 Spynner 模块来创建社交网络应用程序，其中一项功能是能够直接在应用程序中创建 Tumblr 帐户，而无需加载 Web 浏览器。使用在浏览器中运行 javascript 代码的能力，我试图点击一个动态按钮，除了我使用的任何想法似乎根本没有点击它。按钮的代码看起来像这样，漂亮而简单。

```
<button id="signup_forms_submit">
        <span class="account_btn">Démarrer</span>
        <span class="birthday_btn">Suivant</span>
        <span class="captcha_btn"><span>Terminé !</span></span>
        <span class="login_btn">Connexion</span>
</button> 
```

我试过以下没有结果，按钮就是不会点击。

```
browser.runjs("""$(document.elementFromPoint(393, 373)).click();  """)
browser.runjs("""$('.account_btn').click();""")
browser.click("input[id=signup_forms_submit]", wait_load=True,  timeout=30) 
```

老实说，我被困住了。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-04T09:36:54.743

在单击元素之前设置确认回调：

[https://pythonhosted.org/spynner/spynner.browser.Browser-class.html#set_javascript_confirm_callback](https://pythonhosted.org/spynner/spynner.browser.Browser-class.html#set_javascript_confirm_callback)

# winforms - XNA 使用 WinForms：构建内容？

> ID：14531110
> 
> 赞同：0
> 
> 时间：2013-01-25T22:07:48.570
> 
> 标签：winforms, xna, directory, output

我目前正在尝试在 WinForms 中使用 XNA，并且在构建/加载内容时遇到了一些麻烦。

使用关于如何在 WinForm 中使用 XNA 的[Microsoft 示例](http://xbox.create.msdn.com/en-US/education/catalog/sample/winforms_series_1 "WinForms 系列一：图形设备")，我已经实现了一个目前运行良好的用户控件。然后，我尝试使用新的“空内容项目”和“Windows 游戏库”来设置 ContentManager，就像示例一样。

但是，在将 SpriteFont 添加到 Content Project(Root Directory = "Content") 并尝试加载它之后，我收到了找不到文件的错误。我查看了 Debug 文件夹，找不到应该包含已编译 SpriteFont 的 Content 文件夹，尽管我在 ContentLibrary 的 Content 文件夹中找到了它。

我现在的问题是，我将如何设置我的项目以始终在 Debug/Release 文件夹中构建内容？我在示例中找不到与此相关的任何内容。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T22:09:35.683

听起来您还没有将 Windows XNA 项目中的内容引用添加到您的内容项目中。它位于右键菜单中，您可以在其中添加普通样式参考。

# java - 如何使用 Diffie-Hellman 密钥交换来保护客户端和服务器之间的数据传输？

> ID：14531113
> 
> 赞同：0
> 
> 时间：2013-01-25T22:07:56.250
> 
> 标签：java, diffie-hellman

我是初学者程序员。我被要求通过使用 Diffie-Hellman 密钥交换来保护客户端和服务器之间的数据传输。我在这个问题上进行了很多搜索，但我刚刚找到了一些示例代码，可以找到大整数`p`和`g`.

问题是我不知道如何使用这些号码来确保信息传输的安全。我想通过客户端和服务器之间的连接传输“字符串”，而不是整数。这些数字对我有什么用处？我正在接近我正在学习的课程的这个项目的最后期限，并且真的可以使用一些帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T22:23:56.247

我建议阅读和理解这个：[http ://en.wikipedia.org/wiki/Diffie%E2%80%93Hellman_key_exchange](http://en.wikipedia.org/wiki/Diffie%E2%80%93Hellman_key_exchange)

这是一个 PHP 代码片段，它可以帮助...

GENERATOR=2 和 PRIME（300 位素数）是常数

```
 // generate server secret
        $privateKey = 0;

        for ($i=0; $i<100; $i++) {
            if ($i==0) {
                $privateKey = mt_rand(1, 9);
            } else {
                $privateKey .= mt_rand(0, 9);
            }
        }

        // output server public key
        echo gmp_strval(gmp_powm(GENERATOR, $privateKey, PRIME));

        // calculate server secret key
        $secretKey = md5(
            gmp_strval(
                gmp_powm($_POST['public_key'], $privateKey, PRIME)
            )
        ); 
```

# python - 通过另外两个常用字符串生成一个新字符串

> ID：14531114
> 
> 赞同：0
> 
> 时间：2013-01-25T22:08:01.230
> 
> 标签：python, string, list

通过其他两个常见字符串生成一个新字符串，但我自己的 Python 代码有问题。代码是：

```
string1 = "doesnt matter"
string2 = "doesnt matter too"
listt = []
n = 0
while n < len(string1) or len(string2):
    if string1[n] in string2:
        listt.append(string1[n])
    n += 1 
```

当我运行代码时，我收到此错误：

```
Traceback (most recent call last):
  File "<pyshell#121>", line 2, in <module>
    if string1[n] in string2:
IndexError: string index out of range 
```

我不知道为什么字符串索引超出范围，如果`n = 0`和字符串大于0。

提前致谢，

@viddhart4d8

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T23:33:44.397

这里实际上有两个问题。

首先，正如迈克所指出的，`n < len(string1) or len(string2)`相当于`(n < len(string)) or len(string2)`. 换句话说，只要`len(string2)`不为零，这将*始终*为真。要解决此问题，请将其更改为`n < len(string1) or n < len(string2)`.

但是当你解决这个问题时，什么都不会改变；你仍然会得到一个`IndexError`. 这里的问题是，你不仅没有正确地实现你的逻辑，而且逻辑首先是错误的。`len(string1)`是 13，`len(string2)`是 17。那么，当`n`13 时会发生什么？嗯，`n < 13 or n < 17`显然是真的，所以你仍然要点击下一行并尝试做`string1[n]`.

您可以将其更改`or`为 an`and`来解决此问题。

但实际上，最好编写一开始就更难出错的代码。

首先，您可以这样做：

```
while n < min(len(string1), len(string2)): 
```

其次，每当你编写一个以 开头的循环，在 上`n = 0`执行一个`while`循环`n < <something>`，然后在执行一个`n += 1`时，你可以并且应该将它重写为`for`一个范围上的循环：

```
for n in range(min(len(string1), len(string2))): 
```

同时，如果您考虑一下，我认为如果`string2`短于`string1`. 所以真的，你想要的是：

```
for n in range(len(string1)): 
```

每当你发现自己在循环`range(len(<something>))`，然后在`<something[n]>`循环内做，你真的只想`<something>`直接循环：

```
for ch in string1: 
```

让我们把它放在一起：

```
string1 = "doesnt matter"
string2 = "doesnt matter too"
listt = []
for ch in string1:
    if ch in string2:
        listt.append(ch) 
```

这更具可读性——更重要的是，对于新手来说，更难出错。即使是有经验的程序员也经常`<`在他们应该使用的时候使用`<=`，或者在复杂的`if`语句中弄错括号等。但是如果你一开始就不必编写那个逻辑，你就不会犯那些错误。

事实上，你可以更进一步，因为这种模式正是列表推导所做的（或者，`filter`函数），所以：

```
string1 = "doesnt matter"
string2 = "doesnt matter too"
listt = [ch for ch in string1 if ch in string2] 
```

但在这一点上，我们并没有消除出错的机会。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T22:13:15.813

试试这个，使用[列表理解](http://docs.python.org/2/tutorial/datastructures.html#list-comprehensions)：

```
string1 = "doesnt matter"
string2 = "doesnt matter too"
listt = [x for x in string1 if x in string2] 
```

上面的代码更简单，避免了在手动循环输入字符串时需要处理索引等——事实上，这是在 Python 中解决问题的首选方式。

或者，如果您想显式使用循环，这是您的代码的固定版本 - 特别是，请注意条件只需要使用`len(string1)`，无需询问`string2`'s 长度：

```
listt = []
n = 0
while n < len(string1):
    if string1[n] in string2:
        listt.append(string1[n])
    n += 1 
```

前面的循环可以像这样更惯用地编写，注意不需要使用索引来迭代列表 - 这就是[for 循环](http://docs.python.org/2/reference/compound_stmts.html#for)的用途：

```
for x in string1:
    if x in string2:
        listt.append(x) 
```

三种解法是等价的，现在结果如预期：

```
listt
=> ['d', 'o', 'e', 's', 'n', 't', ' ', 'm', 'a', 't', 't', 'e', 'r'] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-25T22:13:23.913

我想你想要这个：

```
while n < len(string1) or n < len(string2): 
```

你正在做的是归结为：

```
while (n < len(string1)) or (len(string2)) 
```

您的陈述是两件事或在一起，这意味着如果其中任何一个为真，那么整个条件为真。在这种情况下`len(string2)`，它是 no-0，因此无论在`n`做什么，它都是“真实的”。

而且，正如 abarnert 指出的那样，“或”无论如何都不是正确的检查。长度 13 或长度 17 仍然会溢出长度 13（因为 < 17 检查将使您继续前进，就像`len(string2)`让您继续前进一样）。

我觉得最快的解决方案就是`or`用`and`.

```
while (n < len(string1)) and (n < len(string2)) 
```

这现在将停止运行一次`n`是`>=`任一字符串的长度（在本例中较短的 13）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T22:13:25.560

您需要更改`n < len(string1) or len(string2)`为：

```
n < len(string1) or n < len(string2) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-25T23:33:30.223

我认为这就是你想要做的：

```
string1 = "doesnt matter"
string2 = "doesnt matter too"
listt = []
n = 0
while n<len(string1) and n<len(string2):
    if string1[n] in string2:
        listt.append(string1[n])
    n += 1 
```

注意以下之间的区别：

```
while n<len(string1) and n<len(string2):
                     ^^^ ^^ 
```

与你所拥有的：

```
while n<len(string1) or len(string2):
                     ^^ 
```

如果你想使用`or`你需要否定整个共轭以获得：

```
while not(n>=len(string1) or n>=len(string2)): 
```

我认为这并不容易阅读。你也可以使用一个看起来像这样的 Python 形式：

```
while all(n<len(s) for s in (string1,string2)): 
```

它以同样可读的方式适用于任意数量的字符串。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2013-01-25T22:16:47.803

string1 为 4 个字符（上限 3） string2 为 6 个字符（上限 5）

即使您修复了循环条件，仍然存在问题您的循环条件是 while n < (4 or 6)

这意味着 this 在 n<6 时循环。在某些时候，n 将是 4,5 和 6，所有这些都超出了 string1[n] 的范围索引。我不确定您要在输出方面达到什么目标。也许您正在提取常见字符？C＃

```
string s1="xz";
string s2="xyz";
string combined="";

//loop through s1 letter by letter
for (int i=0; i<len(s1); i++){
     s1[i] represents x when i=0

     //loop through s2
     for (int j=0; j<len(s2); j++){
          //if s1[i] (x when i=0) s2[j] (s2[0]=x s2[1]=y s2[2]=z)

          //if they are equal append them to a string named combined and move to the next s1[i] iteration
          if (s1[i]==s2[j]){
            combined+=s1[i];
            break;
          }
     }
} 
```

组合现在应该是 xz

# windows-phone-8 - API 来获取您的 Windows Phone 8 设备的友好名称？

> ID：14531121
> 
> 赞同：5
> 
> 时间：2013-01-25T22:08:45.713
> 
> 标签：windows-phone-8, device-name

有没有办法得到你手机的名字？您在 Windows 资源管理器属性中看到的名称作为设备名称？

我看过**Microsoft.Phone.Info.DeviceStatus.DeviceName**但这似乎有所不同。我已经查看了**DeviceExtendedProperties**，但现在大多已弃用。

电话会在设置过程中提示您输入此名称。我还可以在 WinRT App for WP8 首选项中看到并更改此名称。但我没有看到通过 API 获取它的方法。

（我想要这个名称，以便可以将其传递给显示设备列表的 Web 服务）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-12-19T19:06:36.490

Windows.Networking.Proximity.PeerFinder.DisplayName 会给你用户给手机的名字

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T22:46:20.583

我认为基本 API 没有任何东西可以让你这样做，可能是出于安全考虑！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-11-11T18:53:01.483

这将为您提供制造商和型号名称。对于我的诺基亚 Lumia 930，这会记录“NOKIA RM-1045_1044”，这不是最友好的名称，但它可以让您区分设备。

```
var deviceInformation = new Windows.Security.ExchangeActiveSyncProvisioning.EasClientDeviceInformation();
console.log(deviceInformation.systemSku); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T22:48:46.143

没有公共的 WP8 API 来检索用户友好的设备名称。如果您希望唯一标识手机的使用[ANID2](https://stackoverflow.com/questions/13972829/im-not-able-to-get-my-anid)。

# wpf - 工具箱中的用户控件默认名称

> ID：14531128
> 
> 赞同：1
> 
> 时间：2013-01-25T22:09:14.263
> 
> 标签：wpf, visual-studio-2010, xaml

在开发一些供内部使用的用户控件时，我遵循了 MSDN [http://msdn.microsoft.com/en-us/library/vstudio/ee712573(v=vs.100).aspx中的这个例子](http://msdn.microsoft.com/en-us/library/vstudio/ee712573(v=vs.100).aspx)

我遇到的问题是，将工具拖出工具箱并拖到工作区时，不会自动生成默认名称。

拖出一个按钮会提供以下信息：

```
<Button Content="Button" Height="23" HorizontalAlignment="Left" Margin="41,157,0,0" Name="button1" VerticalAlignment="Top" Width="75" /> 
```

当我把我的拖出来时，我得到：

```
<my:MyUserControl HorizontalAlignment="Left" Margin="101,105,0,0" VerticalAlignment="Top" /> 
```

默认情况下，控件不会被命名。这个和其他设置是否可以在控件代码的某个地方控制？我原以为它会被命名为`Name="MyUserControl1"`

# ios - tablecell 在 IOS 6.0 中工作，但在 IOS 5.1 中不工作

> ID：14531139
> 
> 赞同：0
> 
> 时间：2013-01-25T22:10:05.133
> 
> 标签：ios, tablecell

我更新了我的应用程序并添加了一些功能，但我的表格视图发生了一些奇怪的事情。让我解释：

我有一个表格视图，当按下一行时，我想打开一个新的视图控制器。

我正在使用故事板和segues，这就是我所拥有的：

![故事板](../Images/153254fe1c127852dfdc99f0b10e7c6f.png)并且当按下该行时会打开视图控制器。

每行的内容都在一个单独的 .xib 文件中（如果保持不变，我会在 IOS 6.0 中强制关闭，或者我可以处理内容，无论我添加了什么）。

所以我的 EachCell.xib 是这样的： ![每个单元格.xib](../Images/b44426aa998a3286240343d01834563d.png)

这是我每个单元格的代码：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *simpleTableIdentifier=@"EachCell";
    //this is the identifier of the custom cell
    EachCell *cell = (EachCell *)[tableView dequeueReusableCellWithIdentifier:simpleTableIdentifier];

    tableView.backgroundColor=[UIColor clearColor];
    tableView.opaque=NO;
    tableView.backgroundView=nil;

    if (cell == nil)
    {
        NSArray *nib = [[NSBundle mainBundle] loadNibNamed:@"EachCell" owner:self options:nil]; ######HERE IS THE SIGBART PROBLEM
        cell = [nib objectAtIndex:0];
    }
   /*** bla bla bla**/

    return cell;
} 
```

这是为了按下并打开新的视图控制器：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
/..rest of code ../
[self performSegueWithIdentifier:@"nameofsegue" sender:tableView];
        } 
```

我已经提到了 SIGBART 问题在哪里。

EachCell 是 .h,.m,.xib 文件的名称和我的自定义单元格的重用标识符。我只在情节提要中插入了表格单元，以便我可以设置我的转场。

奇怪的是它在 IOS 6.0 中播放，但在 IOS 5.1 中没有。

这就是我在 ios5.1 中遇到的错误：

```
NSInternalInconsistencyException, the Nib data is invalid. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T23:58:25.853

听起来您的自定义单元格 Xib 文件上启用了自动布局。在笔尖内确保自动布局框在其属性中未选中。默认情况下，此框处于选中状态。自动布局是 iOS6 的一项功能，因此您可能需要调整该单元格的布局

![在此处输入图像描述](../Images/f3e5d77b364154ac98f2ff88af6baf66.png)

# c# - How to use RegistryKey.SetValue

> ID：14531142
> 
> 赞同：6
> 
> 时间：2013-01-25T22:10:17.000
> 
> 标签：c#, registrykey

I'm trying to create a new registry key using following code and getting this error:

```
Cannot write to the registry key. 
```

Where am I going wrong???

```
var rs = new RegistrySecurity();
string user = Environment.UserDomainName + "\\" + Environment.UserName;
rs.AddAccessRule(new RegistryAccessRule(user,
                                        RegistryRights.WriteKey | RegistryRights.SetValue,
                                        InheritanceFlags.None,
                                        PropagationFlags.None,
                                        AccessControlType.Allow));
RegistryKey key;
key = Registry.LocalMachine.CreateSubKey(@"Software\Microsoft\Windows\CurrentVersion\Policies\System", RegistryKeyPermissionCheck.ReadSubTree, rs);
key.SetValue("kashif", 1, RegistryValueKind.DWord);
key.Close(); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-25T22:15:19.740

You need to open the newly created key for read/write access:

```
key = Registry.LocalMachine.CreateSubKey(
    @"Software\Microsoft\Windows\CurrentVersion\Policies\System",
    RegistryKeyPermissionCheck.ReadWriteSubTree, // read-write access
    rs); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-02-23T15:12:19.810

You don't need the `rs` part unless you are trying to assign specific permissions to the key you are creating.

You need to:

1.  Open the key where you want to create your subkey and assign it to a `RegistryKey` variable. Add a `true` Boolean to mark it as writeable.
2.  Create your subkey using that variable, and assign that back to the same variable.
3.  Set the value using your `RegistryKey` variable.

Example:

```
RegistryKey key = Registry.LocalMachine.OpenSubKey(@"Software\Microsoft\Windows\CurrentVersion\Policies\System", true);
key = key.CreateSubKey("MyNewKey");
key.SetValue("kashif", 1, RegistryValueKind.DWord); 
```

If you just want to edit an existing key, as `System` is, you don't use `CreateSubKey`, because the key already exists. That is only for creating new keys. You use `OpenSubKey`.

```
RegistryKey key = Registry.LocalMachine.OpenSubKey(@"Software\Microsoft\Windows\CurrentVersion\Policies\System", true);
key.SetValue("kashif", 1, RegistryValueKind.DWord); 
```

# ruby-on-rails-3 - 用户中的 ActionView::MissingTemplate#show

> ID：14531145
> 
> 赞同：1
> 
> 时间：2013-01-25T22:10:50.470
> 
> 标签：ruby-on-rails-3

我的`ActionView::MissingTemplate in Users#show`应用程序出现错误。

我有以下代码，它呈现了一个名为`_meta.html.erb`. 该文件位于`app/views/users/_meta.html.erb`并包含以下代码：

```
<%= image_tag("user_pic.png", alt: @user.name, :class => "profile_pic" ) %>
</br>
<h2 class="user_profile"><%= @user.name %>&nbsp;<%= @user.surname %></h2>
<h3 class="user_location"><%= @user.city %>,&nbsp;<%= @user.state %></h3>
... 
```

我的`users#show`代码如下：

```
<div id="leftbar">
  <%= render '_meta' %>
</div> 
```

我尝试过`<%= render '/_meta' %>`, `<%= render 'users/_meta' %>`,`<%= render '/users/_meta' %>`等，但似乎没有任何效果。

这可能是一个 Noob 错误，但我被卡住了。有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T22:14:27.593

使用`render 'meta'`. 您不需要添加`_`到部分名称。[这](http://guides.rubyonrails.org/layouts_and_rendering.html#using-render)是关于在 Rails 中渲染的指南。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T22:12:30.453

以下是渲染部分的方法：

```
<%= render partial: 'meta' %> 
```

[部分文档](http://api.rubyonrails.org/classes/ActionView/PartialRenderer.html)

# db2 - HADR 环境中的 CONNECT_PROC 导致 -1776 DB2 错误

> ID：14531147
> 
> 赞同：0
> 
> 时间：2013-01-25T22:11:05.003
> 
> 标签：db2

我们有一个似乎非常独特的 DB2/HADR 场景。

我们使用 connect_proc 来监控数据库的登录，并根据有效主机名表反弹连接的主机名。如果主机名在该列表中，则授予并记录访问权限，如果主机名不在该列表中，则返回 20001 错误并显示“ACCESS RESTRICTED”。

我们的问题是连接到数据库：

假设我们的连接字符串是这样的：jdbc:db2://host3:1000/vpcdb:clientRerouteAlternateServername=host3,host2,host1;clientRerouteAlternatePortNumber=1000,1000,100;queryCloseImplicit=2;enableSeamlessFailover=yes;enableClientAffinitiesList=yes;blockingReadConnectionTimeout= 1200;

如果 host1 是主 HADR DB，我们会收到 1776，如果 host3 是主 HADR DB，我们将获得访问权限。

如果使用以下方法禁用触发器： update db cfg using connect_proc NULL@ 访问被授予

已专门使用了多个 DB2 驱动程序：4.14.111 和 4.13.80。这里另一个有趣的事情是，上面的任何一种配置都可以在 Squirrel 中使用触发器激活，但在用作 activemq 或我们任何其他应用程序中的连接器时不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T21:38:03.253

您是否已验证`CONNECT_PROC`在辅助服务器 (host3) 上也已按预期设置了配置参数？

并非所有对数据库配置的更改都通过 HADR 复制，因此您还需要手动更新备用主机上的配置。

# jquery - 数学：从文本输入中添加总数并找到百分比

> ID：14531148
> 
> 赞同：2
> 
> 时间：2013-01-25T22:11:15.263
> 
> 标签：jquery, math

我有两种类型的文本输入，积极的和可疑的。在将输入到两种类型的输入中的所有数字相加后，我需要显示多组这些输入的总数。例如：2 阳性 + 2 可疑 = 总数：4

然后，我需要从该总数中找出阳性与可疑的百分比。例如：50% 的肯定和 50% 的可疑。

我想在用户输入时实时添加这些总数和百分比。

到目前为止，我没有得到任何地方。关于最好的方法的任何想法？我应该使用 .blur 还是 .each？

jsfiddle：http: [//jsfiddle.net/infatti/UjU4a/](http://jsfiddle.net/infatti/UjU4a/)

这是我到目前为止所拥有的，但它不起作用：

```
<label>How many positive?</label>
<input type="text" name="positive" class="observationPositive">
<br />

<label>How many questionable?</label>
<input type="text" name="questionable" class="observationQuestionable">
<br />

<hr />

<label>How many positive?</label>
<input type="text" name="positive" class="observationPositive">
<br />

<label>How many questionable?</label>
<input type="text" name="questionable" class="observationQuestionable">
<br />

<hr />

<h4><span  id="observationTotal"></span> Total</h4>
<h4><span  id="observationQuestionablePercentage"></span>% Questionable</h4>
<h4><span  id="observationPositivePercentage"></span>% Positive</h4>

$('.observationPositive').blur(function () {
    var sum = 0;
    $('.observationPositive').each(function() {
        sum += Number($(this).val());
    });
});​​​​​​​​​
$('#observationTotal').text(sum); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T22:38:24.517

假设您的意思是“值的平均值”。但是，我可以更多地了解您想要实现的目标 - 您可能希望将每个积极的输入与有问题的输入配对......

```
$('.observationPositive, .observationQuestionable').on("change", function () {
    var sumP = 0,
        sumQ = 0,
        countP = 0,
        countQ = 0;
    $('.observationPositive').each(function(){
        countP++;
        sumP += Number($(this).val());
    });
    $('.observationQuestionable').each(function(){
        countQ++;
        sumQ += Number($(this).val());
    });

    var percentP = 100/(1 + (sumQ/sumP));
    var percentQ = 100 - percentP;

    $("#observationTotal").text(sumP + sumQ);
    $("#observationQuestionablePercentage").text(percentQ.toFixed(2));
    $("#observationPositivePercentage").text(percentP.toFixed(2));
}); 
```

# c# - C# 错误中数组元素的访问器

> ID：14531168
> 
> 赞同：3
> 
> 时间：2013-01-25T22:12:16.190
> 
> 标签：c#, arrays, accessor

我的班级中有两个数组，并尝试通过以下方式访问它们。第一个适用于 theta，但第二个无法为 delta_theta 编译。不使用这个做第二个数组的正确方法是什么？

错误说： 错误 1 ​​错误的数组声明符：要声明托管数组，排名说明符位于变量标识符之前。要声明一个固定大小的缓冲区字段，请在字段类型之前使用 fixed 关键字。

```
protected double[] theta = null;
protected double[] delta_theta = null;
public double this[int index] {
        get { return theta[index]; }
        set { theta[index] = value; }
}
public double Delta_Theta[int index]
{
        get { return delta_theta[index]; }
        set { delta_theta[index] = value; }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T22:17:10.460

您不能在纯 C# 代码中为索引器指定名称，也不能创建多个具有相同参数类型的索引器并按名称区分它们。

*您可以为要使用的其他*语言（支持命名索引器）指定一个名称，[`DefaultMemberAttribute`](http://msdn.microsoft.com/en-us/library/system.reflection.defaultmemberattribute.defaultmemberattribute.aspx)但您不能自己使用该名称。（COM 组件除外，然后仅在 C# 4 及更高版本中。）

相反，您必须公开某种类型的属性，该属性*本身会*公开相关的索引器。现在，如果您想要获取和设置，您可以将数组公开为只读属性，可能为`IList<double>`：

```
// Names changed to be more conventional
public IList<double> DeltaTheta
{
    get { return deltaTheta; }
} 
```

然后客户仍然可以使用：

```
foo.DeltaTheta[10] = 5.5; 
```

例如。

对于只读版本，您可以公开`ReadOnlyCollection<double>`：

```
public ReadOnlyCollection<double> DeltaTheta
{
    get { return new ReadOnlyCollection<double>(deltaTheta); }
} 
```

或者为了避免每次都这样做，您可以为包装器设置一个字段：在构造函数中对其进行初始化，然后每次都返回相同的包装器引用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T22:16:21.583

在同一个类中没有办法做到这一点 - 索引器必须是形式`this(arguments)`，所以你不能有 2 个使用相同类型的索引。

您可以做的是创建内部类，以将索引重定向到您的数组并`Delta_Theta`返回此类。

```
public IndexRedirector Delta_Theta 
{ 
  get { return new IndexRedirector { RedirectedArray:delta_theta }; 
}

class IndexRedirector
{ 
  public double[] RedirectedArray;
  public double this[int index] {
    get { return RedirectedArray[index]; }
    set { RedirectedArray[index] = value; }
  }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-25T22:28:03.247

您可以创建一个包装索引器：

```
protected double[] theta = null;
protected double[] delta_theta = null;

public double this[int index] {
        get { return theta[index]; }
        set { theta[index] = value; }
}

public Indexer DeltaTheta { 
      // can be optimized according to delta_theta lifecycle
      get {return new Indexer(delta_theta);} 
}

// internal indexere wrapper
public class Indexer{
      double [] _data;
      public DoubleIndexer(double[] data ){   
          _data = data;
      }

      public double this[int index] {
            get { return _data[index]; }
            set { _data[index] = value; }
      }
} 
```

并像这样使用：

```
obj[2]               // -> theta[2]
obj.DeltaTheta[5]    // -> delta_theta[5] 
```

# ruby - 为 Hash 的子类扩展 to_json

> ID：14531169
> 
> 赞同：0
> 
> 时间：2013-01-25T22:12:17.817
> 
> 标签：ruby, json

我有一个 Hash 的子类，它添加了一个新字段 f。我希望 JSON 序列化和反序列化 f 以及散列本身的内容，但还没有弄清楚如何做到这一点：

```
Class ExtendedHash < Hash
  attr_accessor :f
end 
```

当然，正如所写，`ExtendedHash#to_json`不保留 f 字段：

```
>> c = ExtendedHash[{:a => 1, :b => 2}]
=> {:a=>1, :b=>2}
>> c.f = 123
=> 123
>> c.to_json
=> "{\"a\":1,\"b\":2}" 
```

那么什么是正确的定义：

```
 def to_json(*a)
    ...
  end
  def self.load_from_json(str)
    ...
  end
end 
```

? （我看过[“如何在子类中使用 Ruby 的 to_json 并包含 super 的 json？”](https://stackoverflow.com/questions/9636509/how-can-i-use-rubys-to-json-in-a-subclass-and-include-supers-json)，但这似乎不是正确的方法。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T22:17:06.980

你能做这个吗：

```
class ExtendedHash < Hash
  attr_accessor :f

  def to_json(*args)
    Hash[self].merge(:f => f).to_json(*args)
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T23:06:50.343

以下是正确的：

```
require 'json'

class ExtendedHash<Hash
  attr_accessor :f

  def to_json(*a)
    {
      'json_class' => self.class.name,
      'f' => f,
      'super' => super
    }.to_json(*a)
  end

  def self.json_create(s)
    self[JSON.load(s["super"])].tap {|o| o.f = s["f"]}
  end

end 
```

它的工作原理是这样的：

```
> x = ExtendedHash["a", 1, "b", 2]
=> {"a"=>1, "b"=>2}
> x.f = 123
=> 123
> s = x.to_json
=> "{\"json_class\":\"ExtendedHash\",\"f\":123,\"super\":\"{\\\"a\\\":1,\\\"b\\\":2}\"}"
> y = JSON.load(s)
=> {"a"=>1, "b"=>2}
> y.f
=> 123 
```

唯一奇怪的是底层哈希是“双重json”，即转换为JSON字符串，然后再次通过JSON运行。这会创建许多额外的转义字符，并且需要`JSON.load`在`json_create()`方法中显式调用。

我可以忍受，但也许有更好的方法。

# jaxb - 当元素位于命名空间中时，无法取消对 Java Map 的编组

> ID：14531172
> 
> 赞同：1
> 
> 时间：2013-01-25T22:12:36.020
> 
> 标签：jaxb, xml-namespaces

我正在尝试使用 JAXB 将一些 XML 解组为 Java Map。

我相信我正在使用 Sun/Oracle 提供的 JAXB 参考实现（com.sun.xml.internal.bind ...

这是来自实例文件的相关 XML 的（缩写）部分：

```
<Report 
    xmlns="http://www.escholar.com/eReports" 
    path="Books" reportName="BooksRead" eTag="eTag value">

    <SelectList>
        <entry>
           <key>DOC</key>
           <value>Microsoft Word (DOC)</value>
        </entry>
        <entry>
           <key>PDF</key>
           <value>Adobe Portable Document Format (PDF)</value>
        </entry>
    </Selectlist>
.
.
.
</Report> 
```

如您所见，所有元素都在一个命名空间中。

这是 selectList 的带注释的 Java 字段：

```
@XmlAccessorType(XmlAccessType.FIELD)
@XmlType(name = "InputSelectionType", namespace=ReportJAXB.NAMESPACE, propOrder = {
"selectList"
})

public class InputSelectionTypeJAXB extends InputParameterTypeJAXB 
                                    implements InputSelectionType
    {
    @XmlElementWrapper(name="SelectList", namespace=ReportJAXB.NAMESPACE)
    protected LinkedHashMap<String, String> selectList; 
```

这是 ReportJAXB.NAMESPACE 的定义（与实例文件 @xmlns 中的相同）：

```
 protected final static String NAMESPACE = "http://www.escholar.com/eReports"; 
```

除了 selectList 映射最终没有元素之外，应用程序中的所有内容都可以正常工作。

还值得一提的是，在我添加命名空间之前，这一切都很好。

我猜这个问题与**entry**、**key**和**value**标签有关。这些不是我选择的标签名称。这些是 JAXB 在解组到 Java Map 时似乎假定的标记名称。在引入命名空间之前，我通过检查编组输出发现了它们。

所以我最好的猜测是这不起作用的原因是因为这些标签在实例文件的命名空间中，但是我在 @XmlElementWrapper 注释中提供的命名空间没有被那些隐含的标签继承。

如果这是其他集合（如列表），您可以使用 @XmlElement 注释分组列表元素的直接子元素。但是地图有这些隐含的子结构/子元素。

我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T19:21:15.830

[**JAXB (JSR-222)**](http://jcp.org/en/jsr/detail?id=222)实现将`java.util.Map`其视为一种域对象（如`Customer`、`Address`等）而不是集合类（如`java.util.List`）。这意味着它只为它创建一个映射。因此，它不会从您的域模型继承命名空间限定，也不是命名空间限定。如果您创建模型的实例并将其编组出来，您将了解这意味着什么。

如果您希望 的 XML 表示`Map`符合命名空间，那么您可以利用 an`XmlAdapter`来执行此操作。

*   [http://blog.bdoughan.com/2010/07/xmladapter-jaxbs-secret-weapon.html](http://blog.bdoughan.com/2010/07/xmladapter-jaxbs-secret-weapon.html)

# java - Java JNDI 内部结构

> ID：14531173
> 
> 赞同：2
> 
> 时间：2013-01-25T22:12:36.793
> 
> 标签：java, datasource, jndi

我正在尝试了解 JNDI，但我无法深入了解。据我了解，JNDI 是一种接口，它使您能够根据某些配置从文件系统中检索对象。

我经常看到`DataSource`用参数定义的例子， in`web.xml`或 as `<Resource>`in `Tomcat`。然后，Java 应用程序可以通过资源定义中指定的名称获取此`DataSource`对象实例。`initialContext`

但我想了解的是，在后台发生了什么？怎么`JVM`知道在哪里搜索这些资源？例如，如果在 tomcat 中定义，我想它会以某种方式导出它们。但它怎么`JVM`知道它应该向 Tomcat 索要它们呢？而且，如果是`DataSource`，可以从 JNDI 查找中检索实际对象，并使用从资源定义中设置的参数（连接字符串等）... 什么组件设置它们？`Tomcat`? `JVM`? 我感到很困惑...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T22:30:46.590

在 Java 代码中使用 JNDI 资源查找可以让您的应用程序不知道配置细节，例如 SMTP 服务器的地址或数据库的用户名/密码。相反，您决定每个资源的名称，该名称必须由部署您的应用程序的人员正确配置。这种环境特定设置的分离使您的应用程序更具可移植性，这通常是一件好事。

Tomcat 中的 JNDI 资源配置在各种 XML 文件（server.xml、web.xml、context.xml）中，详情请参阅 Tomcat 文档：http: [//tomcat.apache.org/tomcat-7.0-doc/jndi-resources -howto.html](http://tomcat.apache.org/tomcat-7.0-doc/jndi-resources-howto.html)。当您进行 JNDI 查找时，Tomcat 服务器知道读取这些文件并将配置的对象提供给您的应用程序。

# f# - 如何使用基础值定义枚举常量

> ID：14531175
> 
> 赞同：7
> 
> 时间：2013-01-25T22:12:45.217
> 
> 标签：f#, enums, constants

这个 C# 的 F# 等价物是什么：

```
const MyEnum None = (MyEnum)1; 
```

这不起作用：

```
[<Literal>]
let None : MyEnum = enum 1 //ERROR: not a valid constant expression 
```

不过，奇怪的是，在属性构造函数中是可以的：

```
[<MyAttribute(enum 1)>]
type T = class end 
```

这种差异似乎很奇怪。

### 更新

这已在 v3.1 中修复，并按预期工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T20:24:08.800

我相信观察到的编译器行为是有意的，并且完全符合对具有[F# Language Spec $10.2.2](http://research.microsoft.com/en-us/um/cambridge/projects/fsharp/manual/spec.html)`[<Literal>]`定义的属性的值的限制：

> 右边的表达式必须是一个**文字**常量表达式，由以下任一组成：
> 
> *   一个简单的常量表达式，除了 ()、本机整数文字、无符号本机整数文字、字节数组文字、BigInteger 文字和用户定义的数字文字。—或者—</li>
> *   对另一个字面量的引用

考虑

```
type MyEnum =
| Case1 = 1
| Case2 = 2 
```

然后

```
[<Literal>]
let Valid: MyEnum = MyEnum.Case1 // Literal enumeration case on the right 
```

会很高兴地编译，但是

```
[<Literal>]
let Invalid: MyEnum = enum<MyEnum>(1) // Expression on the right
                                      // generating constant value, which
                                      // potentially might be completely off
                                      // legit MyEnum cases 
```

不会，尽管在`[<Literal>]`上下文之外，这两个语句都将编译成完全相同的 IL。

假设该`[<Literal>]`属性是使 C#`const`等效的唯一 F# 方法，定义枚举文字值的唯一选项将是在`let`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T23:39:27.587

差异是由于 C#`(MyEnum)0` *确实*是文字，但 F#`enum`是 type 的函数`int32 -> 'T`。
我相信 F# 团队为这个构造添加特殊处理并不难，但不幸的是它还没有。

尽管如此，有一种方法可以完成您的需要，但仅是为了`0`价值：

```
type MyEnum =
    | None = 0
    | Foo = 1

[<Literal>]
let X = MyEnum() 
```

# javascript - ListView 不显示数据

> ID：14531177
> 
> 赞同：1
> 
> 时间：2013-01-25T22:12:48.763
> 
> 标签：javascript, windows-8, expression-blend, windows-store-apps

[我正在学习使用 JavaScript 构建 Windows 8 应用程序](https://rads.stackoverflow.com/amzn/click/com/0321861280)开头的教程。我的 ListView 根本没有显示数据，我不知道该转向哪里。看起来很简单，但我一定错过了一些东西。当我运行应用程序（或在 Blend 中查看它）时，**除了 ListView 数据之外，我看到了所有内容。知道我错过了什么吗？**

**这是结果：**

![在此处输入图像描述](../Images/af1c5842f2ae699a8d6450ba0aba148e.png)

**这是 HTML：**

```
<body>
    <div class="fragment homepage">
        <header aria-label="Header content" role="banner">
            <button class="win-backbutton" aria-label="Back" disabled type="button"></button>
            <h1 class="titlearea win-type-ellipsis">
                <span class="pagetitle">Bob's RSS Reader</span>
            </h1>
        </header>
        <section aria-label="Main content" role="main">
            <div>List of feeds:</div>
            <div data-win-control="WinJS.UI.ListView" data-win-options="{itemDataSource:feeds.dataSource}"></div>
        </section>
    </div>
</body> 
```

**这是 home.js 文件：**

```
(function () {
    "use strict";

    window.feeds = [
        { title: "Brandon Satrom",
            url: "http://feeds.feedburner.com/userinexperience/tYGT" },
        { title: "Chris Sells",
            url: "http://sellsbrothers.com/posts/?format=rss" },
        { title: "Channel 9",
            url: "http://channel9.msdn.com/Feeds/RSS" },
    ];

    WinJS.UI.Pages.define("/pages/home/home.html", {
        // This function is called whenever a user navigates to this page. It
        // populates the page elements with the app's data.
        ready: function (element, options) {

        }
    });
})(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T23:24:11.393

[通过使用此处](http://msdn.microsoft.com/en-us/library/windows/apps/hh465496.aspx)的指南，我能够使其正常工作。此解决方案创建一个命名空间以使数据公开可用。虽然这可行，但我不明白为什么我的原始代码不起作用。我认为 HTML 可以使用 window.feeds ......猜不出来。

HTML：

```
<div data-win-control="WinJS.UI.ListView" data-win-options="{itemDataSource: DataExample.itemList.dataSource}"></div> 
```

JavaScript：

```
(function () {
    "use strict";

    var dataArray = [
        { title: "Brandon Satrom",
            url: "http://feeds.feedburner.com/userinexperience/tYGT" },
        { title: "Chris Sells",
            url: "http://sellsbrothers.com/posts/?format=rss" },
        { title: "Channel 9",
            url: "http://channel9.msdn.com/Feeds/RSS" },
    ];

    var dataList = new WinJS.Binding.List(dataArray);

    // Create a namespace to make the data publicly accessible. 
    var publicMembers =
    {
        itemList: dataList
    };

    WinJS.Namespace.define("DataExample", publicMembers);

    WinJS.UI.Pages.define("/pages/home/home.html", {
        // This function is called whenever a user navigates to this page. It
        // populates the page elements with the app's data.
        ready: function (element, options) {

        }
    });
})(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-28T02:22:18.007

它不起作用的原因是您没有将其设置为绑定列表。普通的 javascript 数组不包含 dataSource 属性。另外，不要忘记使用“新”关键字。我忘记了，花了相当多的时间试图弄清楚它失败的原因。

```
window.feeds = new WinJS.Binding.List([
        { title: "Brandon Satrom",
            url: "http://feeds.feedburner.com/userinexperience/tYGT" },
        { title: "Chris Sells",
            url: "http://sellsbrothers.com/posts/?format=rss" },
        { title: "Channel 9",
            url: "http://channel9.msdn.com/Feeds/RSS" },
    ]); 
```

# datagrid - 具有可编辑 DateTextBox 的 Dojo Datagrid 获得不一致的默认值

> ID：14531178
> 
> 赞同：1
> 
> 时间：2013-01-25T22:13:00.073
> 
> 标签：datagrid, dojo, date-format

我有一个带有日期类型列的数据网格。它可以使用 dijit 的 DateTextBox 进行编辑。问题是当它被实例化时，它将值作为实际值-1day。

我有一个 jsfiddle 在[这里](http://jsfiddle.net/gVbS8/9/)演示这个问题。

我只能以“yyyy-MM-dd”这种格式获取日期。

这是带有日期的列的结构：

```
{
  name:'Start Date', field:'startdate', 
  editable:true, relWidth: 100,
  type: dojox.grid.cells.DateTextBox,
  constraint:{datePattern:'yyyy-MM-dd', selector:'date', locale: 'en-us'},
  formatter:function (d) {
     if(typeof(d) === "string"){
        d = dojo.date.stamp.fromISOString(d)
      }
      return dojo.date.locale.format(d, this.constraint)
   }
 } 
```

# java - 图像生成期间pdfbox中的线程问题

> ID：14531179
> 
> 赞同：1
> 
> 时间：2013-01-25T22:13:01.320
> 
> 标签：java, multithreading, pdfbox

我正在尝试使用 pdfbox 为嵌入在 pdf 中的图像提取图像元数据（和图像）。我有以下问题，

```
for each page i:
 for each image j in page i:
  extract metadata, output
  create the image file in separate thread 
```

现在，我有以下用于创建图像文件的代码，该文件包含在实现类中调用的方法`generate_image()`中。此方法从 调用。代码如下：`FileWriting``Runnable``run()`

```
try {
    File F=new File(figurename);
    item.getImage().write2file( F );

} catch (Exception e) {
    e.printStackTrace();
} 
```

where`item.getImage()`返回一个`PDXObjectImage`对象。如果我在不创建单独线程的情况下执行此操作，它可以正常工作，但是当我创建一个线程来执行此任务时，它会显示以下错误：

```
java.lang.IndexOutOfBoundsException: Index: 5, Size: 0
at java.util.ArrayList.rangeCheck(ArrayList.java:604)
at java.util.ArrayList.get(ArrayList.java:382)
at org.apache.pdfbox.io.RandomAccessBuffer.seek(RandomAccessBuffer.java:84)
at org.apache.pdfbox.io.RandomAccessFileInputStream.read(RandomAccessFileInputStream.java:96)
at java.io.BufferedInputStream.fill(BufferedInputStream.java:235)
at java.io.BufferedInputStream.read1(BufferedInputStream.java:275)
at java.io.BufferedInputStream.read(BufferedInputStream.java:334)
at java.io.FilterInputStream.read(FilterInputStream.java:107)
at org.apache.pdfbox.pdmodel.graphics.xobject.PDCcitt$TiffWrapper.read(PDCcitt.java:468)
at org.apache.pdfbox.io.IOUtils.copy(IOUtils.java:68)
at org.apache.pdfbox.pdmodel.graphics.xobject.PDCcitt.write2OutputStream(PDCcitt.java:184)
at org.apache.pdfbox.pdmodel.graphics.xobject.PDXObjectImage.write2file(PDXObjectImage.java:165)
at extractor.FileWriting.generate_image(FileWriting.java:136) 
```

谁能指出我哪里出错了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T22:15:33.583

我怀疑您的问题是您在多个线程中使用相同的 pdfbox 类。

旧版本的 PDFBox 在他们的常见问题页面中有这个：

> **PDFBox 线程安全吗？**
> 
> 不！一次只有一个线程可以访问一个文档。您可以有多个线程，每个线程都访问它们自己的 PDDocument 对象。

但是，在 2.0+（也许？）[PDFBox 常见问题页面](https://pdfbox.apache.org/2.0/faq.html#is-pdfbox-thread-safe)现在说：

> PDFBox对来自不同线程的同一 PDDocument 的只读操作具有**实验性支持。**

鉴于目前（2019 年 6 月）的讨论，这似乎并不乐观。因此，除非您想生活在边缘，否则您仍然应该考虑使用 a`ThreadLocal`并保留一个`PDDocument`或任何您正在使用的类。就像是：

```
private ThreadLocal<PDDocument> localPdDocument = new ThreadLocal<PDDocument>() {
    @Override
    protected PDDocument initialValue() {
        return new PDDocument();
    }
};

...
PDDocument doc = localPdDocument.get();
... 
```

# php - 检查按钮是否被按下（html -> jquery -> php）

> ID：14531184
> 
> 赞同：0
> 
> 时间：2013-01-25T22:13:23.093
> 
> 标签：php, jquery, ajax

我有这个设置：带有提交按钮的HTML表单->检查是否在jquery中按下了按钮->然后通过`$.post`（jquery）将输入发送到php页面。

如果有人真的按下了 HTML 表单中的按钮，我如何在 php 代码中判断？我想阻止用户在不通过我的表单的情况下向 php 页面提交 $_POST 值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T22:19:59.703

我会做以下事情：

1.  以基于当前日期/时间生成随机散列令牌的形式具有隐藏的帖子值。
2.  首次提交表单时保存此令牌。（数据库）
3.  每次有人尝试提交表单时，随机令牌都会更新，它将是唯一的，因为它将基于时间戳。因此，如果用户仅通过复制令牌和 POST 数据而不通过表单来提交表单，则您的代码应在 PHP 端检查该令牌是否已存在于数据库中。如果它确实提示用户友好的错误消息或重定向。如果没有，则更新旧令牌以保存新令牌。

令牌可以保存在 DB 或 Session 中，具体取决于您想对它们做什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T22:21:42.290

您基本上是要防范[CSRF](http://en.wikipedia.org/wiki/Cross-site_request_forgery)。正如 GGio 所说，基于会话的令牌是实现这一目标的最佳方式。

```
if (!isset($_SESSION['token'])) {
    $token = sha1(uniqid(rand(), true) . $_SESSION['user_id']);
    $_SESSION['token'] = $token;
    $_SESSION['token_time'] = time();
}
else{
    $token = $_SESSION['token'];
} 
```

在您的表单元素中：

```
<input type = "hidden" name = "token" value = "<?php echo $token; ?>" > 
```

在处理表格之前：

```
if(isset($_SESSION['token']) && isset($_POST['token']) && $_POST['token'] === $_SESSION['token']){
    //user submitted the form correctly
}
else{
    //something isn't right
} 
```

# zend-framework - 自定义视图助手未在服务器上加载

> ID：14531188
> 
> 赞同：0
> 
> 时间：2013-01-25T22:13:25.693
> 
> 标签：zend-framework, view-helpers

我的 Zend Framework 项目中有一些使用自定义视图助手的自定义表单元素。它们被加载并在开发机器上正常工作，但是当我将项目移动到我的 EC2 服务器时，它们没有被加载。

来自 application.ini：

```
resources.view.helperPath.Custom_View_Helper_ = APPLICATION_PATH "/../library/Custom/View/Helper/" 
```

服务器返回的错误：

```
Warning: Exception caught by form: Plugin by name 'Multiselect' was not found in the registry; 
used paths: 
Application_Views_Helpers_Fields_: /home/user/hippo/application/views/helpers/fields/ 
Application_Views_Helpers_: /home/user/hippo/application/views/helpers/ 
Custom_View_Helper_: /home/user/hippo/application/../library/Custom/View/Helper/ 
Zend_View_Helper_: Zend/View/Helper/:/home/user/hippo/application/views/helpers/ Stack 
Trace: 
#0 /home/user/hippo/library/Zend/View/Abstract.php(1182): Zend_Loader_PluginLoader->load('Multiselect') 
#1 /home/user/hippo/library/Zend/View/Abstract.php(618): Zend_View_Abstract->_getPlugin('helper', 'multiselect') 
#2 /home/user/hippo/library/Zend/Form/Decorator/ViewHelper.php(241): Zend_View_Abstract->getHelper('multiselect') 
#3 /home/user/hippo/library/Zend/Form/Element.php(2043): Zend_Form_Decorator_ViewHelper->render('') 
#4 /home/user/hippo/library/Zend/Form/Decorator/FormElements.php(111): Zend_Form_Element->render() 
#5 /home/user/hippo/library/Zend/ in /home/user/hippo/library/Zend/Form.php on line 2925 
```

什么可能导致它在我的开发机器上工作但在 EC2 上不工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T23:04:43.887

我解决了这个问题。我的开发机器是 Mac，EC2 运行的是 Linux。我必须更改`public $helper='multiselect'`为，`public $helper='multiSelect'`以便搜索文件名`MultiSelect.php`而不是`Multiselect.php`搜索视图助手时。

# c# - 撤消 Excel 插件的操作

> ID：14531189
> 
> 赞同：6
> 
> 时间：2013-01-25T22:13:38.640
> 
> 标签：c#, excel, interop, add-in

撤消在 Interop.excel 中如何工作？C# - 在 VS 中制作插件

我想象以下内容：

1.  我在堆栈上注册了一个撤消方法（由我实现）。
2.  我保存当前状态...在哪里？

当用户使用 undo (ctrl-z) 时，我的 undo 方法被调用，我用我存储的数据恢复以前的状态。

虽然无法获得任何关于此的好信息。也许它的工作方式完全不同？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-29T16:08:54.960

您可以查看 NetOffice [http://netoffice.codeplex.com/](http://netoffice.codeplex.com/)它们是如何创建自己的加载项的教程。您可以使用 VSTO，下载您需要编写自己的 Excel 加载项的 NetOffice .dll，并根据需要进行设计并实现您的功能。

# lua - Lua 参数问题

> ID：14531190
> 
> 赞同：2
> 
> 时间：2013-01-25T22:13:43.447
> 
> 标签：lua, type-conversion, minecraft

这个 lua 代码有什么问题，无论我输入什么，我的参数都不会转换为数字或识别为数字？

我也尝试了“距离 = tonumber(arg[0]) 或 0”。

```
--Args

local args = {...}

--Variables

local distance = 0
if #args > 0 and type(args[0])=="string" then args[0] = tonumber(args[0]) end
if #args > 0 and type(args[0])=="number" then distance = args[0] end
print("Distance: "..distance) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-25T22:50:43.620

Lua 对其数组使用基于 1 的索引。`args[0]`是`nil`，因此具有类型`"nil"`。

顺便说一句，这个条件是完全没有必要的。`tonumber`将检查它的参数是否是一个数字，并在需要时简单地返回它。`nil`如果参数不能转换为数字，它将返回。所以只需使用：

```
distance = tonumber(args[1]) 
```

您甚至不需要检查 ; 的长度`args`。如果没有提供参数，它将是`nil`，并且`tonumber`将返回`nil`。因此，只需检查是否`distance`为`nil`.

# c# - 从SharpGL中的文本输入画线

> ID：14531203
> 
> 赞同：1
> 
> 时间：2013-01-25T22:14:47.280
> 
> 标签：c#, opengl

我想在 SharpGl 中画线，但这段代码不起作用！

```
void Line_DDA(OpenGL gl,int X0, int Y0, int Xend, int Yend)
    {

        gl.LineWidth(2.5f);
        gl.Color(1.0, 0.0, 0.0);
        gl.Begin(OpenGL.GL_LINES);

        int dx = Xend - X0;
        int dy = Yend - Y0;
        int steps, k;
        float Xinc, Yinc;
        float x = X0;
        float y = Y0;

        if (Math.Abs(dx) > Math.Abs(dy))
            steps = Math.Abs(dx);
        else
            steps = Math.Abs(dy);

        float fdx = (float)dx;
        float fdy = (float)dy;
        float fsteps = (float)steps;
        Xinc = fdx / fsteps;
        Yinc = fdy / fsteps;

        gl.Vertex((int)x, (int)y);

        for (k = 0; k < steps; k++)
        {
            x += Xinc;
            y += Yinc;
            gl.Vertex((int)x, (int)y);
        }

        gl.End();

    } 
```

当我使用

```
 gl.Vertex(10, 100);
             gl.Vertex(110, 110); 
```

这是工作！

**编辑：**

这是我的代码中的调用块：

```
private void openGLControl_OpenGLDraw(object sender, PaintEventArgs e)
    {
        //  Get the OpenGL object.
        OpenGL gl = openGLControl.OpenGL;

        //  Clear the color and depth buffer.
        gl.Clear(OpenGL.GL_COLOR_BUFFER_BIT | OpenGL.GL_DEPTH_BUFFER_BIT);

        //  Load the identity matrix.
        gl.LoadIdentity();

        Line_DDA(gl, int.Parse(txtLineX1.Text), int.Parse(txtLineY1.Text), int.Parse(txtLineX2.Text), int.Parse(txtLineY2.Text));
        //drawLine(gl, 110, 120, 100, 100);
    } 
```

为什么会这样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T09:35:56.860

使用 绘制线时`GL_LINES`，需要为每个线段提供 2 个顶点。相反，您的代码为每个线段提供一个顶点，就好像该线应该与前一个顶点相连。

实际上，解决方案是将绘制模式设置为`GL_LINE_STRIP`或为每个线段提供两个顶点。

但是，我不明白为什么要在只需要两个点的情况下绘制具有多个顶点的直线。

# jquery - jQuery Mobile 正在删除我的课程

> ID：14531210
> 
> 赞同：0
> 
> 时间：2013-01-25T22:15:25.793
> 
> 标签：jquery, html, css, jquery-mobile

我有以下一段 HTML：

```
<footer data-role="footer" data-position="fixed" data-fullscreen="true">
    <div class="top-row">
        <div class="content">
            <img src="images/default-user.gif" width="45" height="45" alt="" class="avatar left">
            <a href="#" id="expand-footer" data-role="none">Expand</a>
        </div>
    </div>
</footer> 
```

和扩展页脚的 JS：

```
toggleFooter: function(e) {
        e.preventDefault();
        var $footer = $('footer');

        if(footer_expanded) {
            $footer.animate({height:'50px'}, 500, function() {
                $('#expand-footer').toggleClass('expanded');
            });
        } else {
            $footer.animate({height:'550px'}, 500, function() {
                $('#expand-footer').toggleClass('expanded');
            });
        }
        footer_expanded = !footer_expanded;
    } 
```

toggleFooter 函数由此调用：

```
$('#expand-footer').on('click', events.toggleFooter); 
```

我遇到的问题是，一旦添加了扩展类，JQuery Mobile 就会将其删除。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T23:15:58.590

我最终这样做了，因为我没有时间真正深入研究这个问题：

```
toggleButton: function() {
        var $btn = $('#expand-footer');

        if(footer_expanded) {
            $btn.css({'background-position':'left bottom'});
        } else {
            $btn.css({'background-position':'left top'});
        }
    } 
```

这行得通，因为 jQuery Mobile 没有要删除的类:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T23:22:11.800

我已经根据您的问题构建了一个[JSFiddle](http://jsfiddle.net/6m54r/)。`expanded`此代码*不会*删除该类。必须有其他东西（其他代码）触发这个，如果`expanded`真的被删除了。

# java - 如何在 Apache Wink Web 服务中为 Wink 类打开调试日志记录？

> ID：14531213
> 
> 赞同：1
> 
> 时间：2013-01-25T22:15:43.653
> 
> 标签：java, logging, apache-wink

我有一个基于 Apache Wink (1.1.3) 构建的 Web 服务，在 Tomcat 下运行，从 Eclipse 启动以进行调试。如何为某些 Wink 课程启用完全登录？

首先，我只是尝试在 Tomcat conf 目录的 logging.properties 文件中为所有 Wink 启用它：

```
org.apache.wink.level = FINEST
org.apache.wink.handlers = java.util.logging.ConsoleHandler 
```

我还尝试将这些行放在另一个文件中，并使用`-Djava.util.logging.config.file=....`这些都不起作用引用该文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T07:10:14.263

Apache Wink 使用[slf4j](http://www.slf4j.org/)进行日志记录。这意味着您应该使用您最喜欢的记录器对其进行配置。
例如，将 slf4j-jdk14.jar 添加到您的类路径会将日志发送到 JDK 的本机记录器。

我建议您阅读[slf4j 两页手册](http://www.slf4j.org/manual.html)。

# java - 如何更新数据库表中的稀疏值？

> ID：14531215
> 
> 赞同：0
> 
> 时间：2013-01-25T22:16:03.733
> 
> 标签：java, sql, jdbc, relational-database

当并非所有值都存在时，最有效地更新表记录（在我的情况下使用主键）的最佳实践是什么？

想象：

```
PRIMARY_KEY1, COLUMN_2, COLUMN_3, COLUMN_4, COLUMN_5, COLUMN_6, ... 
```

我总是得到类似`(PRIMARY_KEY1, COLUMN_5, COLUMN_4)`or的元组，`(PRIMARY_KEY1, COLUMN_2, COLUMN_6, COLUMN_3)`并且只想以最快的方式更新它们，而无需在数据库中查找所有其他值。

由于我必须非常快，因此我想对准备好的语句使用批处理之类的东西，以防止大量的数据库请求。

感谢所有回复！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T00:51:06.390

您可以通过期望 SQL 在行访问时填写值来“作弊”。例如，这种类型的语句：

```
UPDATE MyTable SET (column_1, column_2, ..., column_6)
                      = (COLAESCE(@suppliedValue1, column_1),
                         COLAESCE(@suppliedValue2, column_2),
                         ...,
                         COLAESCE(@suppliedValue6, column_6))
WHERE primary_Key1 = @primaryKey 
```

然后，在填写参数时，只需留下任何未提供的东西`null`......你应该很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T22:19:45.177

您不需要在 SQL 中更新整行。只需使用 UPDATEs SET 语法。

```
UPDATE table SET COLUMN_5 = 'foo', COLUMN_4 = 'goo' WHERE PRIMARY_KEY1 = 'hoo'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T00:15:49.377

在这里看到这个帖子，

[JDBC 批量插入性能](https://stackoverflow.com/questions/2993251/jdbc-batch-insert-performance?rq=1)

阅读。然后在页面右栏的相关链接下查看其他类似帖子您应该立即找到您需要的所有答案。

# c++ - luabind : 从 lua 访问无效的 c++ 对象会导致访问冲突

> ID：14531216
> 
> 赞同：1
> 
> 时间：2013-01-25T22:16:07.743
> 
> 标签：c++, lua, luabind

如果对导出的类（对象）的成员函数调用是针对有效对象的，luabind 是否有可能进行检查？

假设我有一个使用 luabind 暴露给 lua 的名为 Actor 的类。我从 C++ 调用一个 lua 函数，并以一个 actor 对象作为参数。现在在函数完成之前，脚本编写会将actor对象放在全局lua引用中，以便稍后访问。

稍后，从 C++ 站点中删除了 actor 对象，调用了另一个函数来尝试访问无效的 actor 对象（其中的任何方法） - 显然，由于它已被删除，它会导致崩溃（访问冲突）

样本：

```
local myObjRef = nil

function doSomethingWithActor(actor)
 -- save, still valid object
 actor:Say("hello")
 myObjRef = actor
end

function calledAfterActorWasDeleted()
  --- will crash if the c++ object has been deleted meanwhile, works fine if it still exists
  myObjRef:Say("Crash...")
end 
```

NIL 检查在这里没有帮助，这可以在 luabinds 网站上检查吗？这些函数使用 lua_pcall(....) 执行，堆栈跟踪显示 luabinds call.hpp results = maybe_yield(L, lua_gettop(L) - arguments, (Policies*)0) 处的错误；

如果没有，是否有另一种解决方案来确保编写脚本的人无法创建这些问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T22:46:20.023

> 现在在函数完成之前，脚本编写会将actor对象放在全局lua引用中，以便稍后访问。

那就是你的问题来自哪里。如果您希望 Lua 代码*拥有*该对象（即保留该对象的存在），那么您需要使用 Luabind 机制告诉 Luabind 您想要这样做。否则，如果你传递一个指向某个 Lua 函数的指针，Luabind 将假定该函数不会试图获得它的所有权。

如果您希望在 Lua 和 Luabind 之间*共享*所有权，那么您应该将对象包装在 a 中`boost::shared_ptr`，并使用 Luabind 的智能指针机制来执行此操作。

您也可以简单地更好地隔离您的脚本。如果您有一些对特定参与者进行操作的脚本，那么该脚本及其包含的任何函数都应该与对象一起被销毁（即：丢失对它的所有引用）。这需要在 C++ 端进行适当的编码纪律。它还要求您使用 Lua 环境正确封装脚本的每个实例，这样它们就不能通过全局变量偷偷摸摸。最后，您需要让 C++ 完全控制何时调用脚本以及何时不调用脚本。

否则，所有权是您的脚本编写者必须了解和小心的事情。他们不能像对待任何旧的 Lua 值一样对待 C++ 参数。

* * *

如果您无法进行严格的编程实践或不切实际，那么您只需不将实际的 C++ 对象传递给 Lua。相反，您需要向 Lua 传递一些代理对象，它是对原始对象的引用。boost::weak_ptr 是这样一个对象的一个​​很好的例子（尽管你不会将它完全传递给 Lua）。代理会将调用转发到实际对象。如果对象已被删除，代理将检测到这一点并失败或不做任何事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T11:05:12.397

我通过以下方式解决了我的问题：

当我要删除一个对象时，我会遍历 C++ 中的所有 lua 函数（我将它们放在一个列表中，它们每个都绑定到特定的 actor 对象）。然后我检查每个上值（全局/本地变量可访问一个函数） - 然后我将用户数据指针与我即将删除的对象进行比较 - 如果它们匹配（及其类）并且 NIL 上值。或者，我可以删除那个有问题的功能，因为它无论如何都不能正常工作了。

所以下一次调用函数时，我只是得到一个软 lua 错误“试图访问 xxx 一个 nil 值......” - 没有更多的访问冲突。

I know people would say "dont use lua_getupvalue/lua_setupvalue - they are only for debugging!" - but there is actually no documented or spoken side effect - and in my case its perfectly safe and works well - also there isnt the issue with left over proxy objects i could not delete.

# vba - 在具有断开连接的 ADO 记录集的 Access 表单中，筛选器仅工作一次

> ID：14531218
> 
> 赞同：2
> 
> 时间：2013-01-25T22:16:15.543
> 
> 标签：vba, ms-access, ms-access-2007

感谢对上一个问题的出色回答[（](https://stackoverflow.com/questions/14402828/in-access-forms-add-a-control-without-modifying-the-underlying-table)感谢 Hansup 和 Remou），我制作了一个基于 ADODB 记录集的 Access 表单，该记录集在运行时拉取。这使它有一个仅在内存中的复选框。复选框很好。

我现在被要求将“客户”的下拉过滤器添加到表单中。很容易。我做了下拉框，对控件源做了一点查询，在 After_Update 事件中，添加了这段代码：

```
Private Sub Combo_PickClient_AfterUpdate()
    Me.Filter = "Client='" & Combo_PickClient.Value & "'"
    Me.FilterOn = True
    Me.Refresh
End Sub 
```

出于测试目的，我选择了 2 个客户端。当我打开表单时，它显示了两个客户的数据（好）。当我选择一个客户端时，它成功过滤了数据（也很好）。当我选择第二个客户时，它什么也没做（不太好）

为什么这个过滤器只能工作一次？它不会抛出任何错误。屏幕只是刷新，仅此而已。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T16:22:21.223

我最好的猜测是，当您尝试修改或删除非空`.Filter`属性时，Access 会尝试从数据提供者重新加载表单的记录集。由于断开连接的记录集没有提供程序，因此该尝试失败。在我的测试中，我实际上触发了错误 #31，“*无法初始化数据提供者*”。

在您的第一次尝试（成功）中，该`.Filter`属性事先是空的。我看到了相同的行为，我猜 Access 可以将 a`.Filter`应用于未过滤的记录集，而无需重新访问数据提供者。

对猜测感到抱歉。不幸的是，这是我能提供的最好的解释。

无论如何，我放弃了尝试使用表单的`.Filter`属性来完成我认为你想要的。我发现根据在其子句中包含您的`.Filter`字符串的查询来简单地重新加载断开连接的记录集更容易。`WHERE`代码更改很小，运行时性能成本可以忽略不计……重新加载的记录集在更改组合框选择后立即显示。

首先，我将构建断开连接的记录集的代码移到了`Form_Open`一个单独的函数中，该函数的签名是......

```
Private Function GetRecordset(Optional ByVal pFilter As String) _
    As ADODB.Recordset 
```

该函数将一个非空`pFilter`参数合并到查询的`WHERE`子句中，该子句`SELECT`提供断开的记录集。

然后我改成`Form_Open`一种说法...

```
Set Me.Recordset = GetRecordset() 
```

因此，如果您的组合框和断开连接的记录集都在同一个表单上，则组合的更新后过程可能是......

```
Private Sub Combo_PickClient_AfterUpdate()
    Set Me.Recordset = GetRecordset("Client='" & _
        Me.Combo_PickClient & "'")
End Sub 
```

就我而言，断开连接的记录集显示在子窗体中，组合框位于其父窗体上。所以我在子表单代码模块中创建了一个包装过程，并从组合的更新后调用它：

```
Call Me.SubFormControlName.Form.ChangeRecordset("Client='" & _
    Me.Combo_PickClient & "'") 
```

包装程序非常简单，但我发现它很方便......

```
Public Sub ChangeRecordset(Optional ByVal pFilter As String)
    Set Me.Recordset = GetRecordset(pFilter)
End Sub 
```

# validation - Grails 日期验证

> ID：14531220
> 
> 赞同：0
> 
> 时间：2013-01-25T22:16:22.317
> 
> 标签：validation, date, grails, groovy, gsp

我是 Grails/GSP 的新手，想在 Grails 中实现日期验证。验证应针对文本字段中的输入文本，因为所需格式为 mm/dd/yyyy。任何指导表示赞赏。如果有人知道，也请给我一些好的 Grails 和 GSP 教程。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T23:47:24.400

要为日期输入要求特定的日期格式，您可以使用自定义属性编辑器。

`src/groovy/`您可以添加一个类来注册将在数据绑定中使用的自定义编辑器。

```
class CustomPropertyEditorRegistrar implements PropertyEditorRegistrar {
    void registerCustomEditors(PropertyEditorRegistry registry) {
        def format = 'MM/dd/yyyy'
        def dateFormat = new SimpleDateFormat(format)
        dateFormat.setLenient(false)
        registry.registerCustomEditor(Date, new CustomDateEditor(dateFormat, true, format.size()))
    }
} 
```

并将 bean 注册到`resources.groovy`

```
beans = {
    customPropertyEditorRegistrar(CustomPropertyEditorRegistrar)
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T12:47:32.473

Grails 有一个在脚手架中使用的默认日期和时间选择器，您可以使用它，但如果您希望文本框输入日期，您可以使用 jQuery 或 javascript 验证格式，然后使用以下方法将字符串解析为日期：

```
try{
    SimpleDateFormat format = new SimpleDateFormat("yyyy-MM-dd hh:mm");
    date = format.parse(stringDate);
}catch (Exception e) {
    //something
} 
```

您可以使用带有 javascript 的正则表达式来验证视图中输入日期的格式。[这](https://stackoverflow.com/questions/5465375/javascript-date-regex-dd-mm-yyyy)可能对此有用。

# git - 如何将 git 中的每个提交导出到其自己的编号存档中？

> ID：14531226
> 
> 赞同：3
> 
> 时间：2013-01-25T22:16:52.877
> 
> 标签：git

我开始使用 git 对二进制文件（.ai 和 .indd）进行版本控制。我想知道如何导出其中一个文件（或整个 repo）的每个提交，以便之后我会有一个图像序列，我可以用它来制作像这样一个[moxie doxy](http://www.youtube.com/watch?v=zkbijkA47Ag&feature=youtu.be&hd=1)的视频，它是由文件制作的保存为字体（n），字体（n++）...。

所以我想我想要实现的是这样的：

git archive -o export iterateOverAllCommits EXPORTS_TO（第一次提交）archive0001.zip，（第二次提交）archive0002.zip…</p>

之后，扩展/准备视频文件就没有问题了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T23:10:39.527

通过结合`git archive`和`git rev-list`一点点 bash，你可以做到这一点。

```
COUNT=0
for commit in `git rev-list --reverse HEAD`; do
  git archive $commit --format=zip -o archive$COUNT.zip
  COUNT=$((COUNT + 1))
done 
```

`git rev-list --reverse HEAD`打印出从第一个提交开始到 HEAD 结束的提交哈希。

`git archive $commit --format=zip -o archive$COUNT.zip`创建由来自 的提交哈希指定的提交的 zip 存档`rev-list`。

两者`rev-list`都有`archive`很多选项，可以帮助您进一步完善档案以包含您只需要的信息。

[使用 printf](http://jonathanwagner.net/2007/04/zero-padding-in-bash/)您可以轻松地修改上面的内容以对计数进行零填充。

# forms - 长格式确认消息的可用性

> ID：14531227
> 
> 赞同：0
> 
> 时间：2013-01-25T22:17:01.237
> 
> 标签：forms, usability

我的可用性术语，我想知道显示我的确认消息的最佳解决方案是什么。

我的表格很长，在小屏幕上我看不到表格的顶部。当我提交表单时，我的消息“您的信息已保存”的最佳位置在哪里？

*   在表单的顶部，我添加了一个自动向上滚动？
*   在靠近保存按钮的底部？
*   在对话框中？
*   其他解决方案？

我试图在互联网上找到它，但没有什么真正有趣的。如果您对我有答案，请引用您的消息来源。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T19:54:13.747

如果这是您的应用程序中唯一具有此功能的地方，那就没关系了；如果您已经在其他地方以一种或另一种方式工作，那么一致性是最重要的。

用户下一步需要导航到哪里？如果导航位于顶部，则将它们自动滚动到顶部并在那里显示一条消息可能是合适的。

如果导航在左侧，自动滚动会失去用户在页面中的位置，这会使导航变得更加困难。在这种情况下，请在提交按钮旁边告诉他们。

如果他们只能导航到下*一个*地方，请跳过 AJAX 并做一个插页式“成功！” 屏幕也将他们带到他们想要导航的下一个地方。

但最重要的是？与您的应用程序的其余部分保持一致。

# java - ANTLR 从 Java 反编译

> ID：14531230
> 
> 赞同：2
> 
> 时间：2013-01-25T22:17:14.543
> 
> 标签：java, antlr, antlr3, antlr4

我在 .java 文件中有 ANTLR 3 的 Parser 和 Lexer 的 Java 源代码，并希望查看所有规则等背后的实际语法。

甚至可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T22:31:50.070

不是通过某些自动化工具（AFAIK）。但是生成的源文件在其注释中包含原始语法的解析器和词法分析器规则，因此您可以自己合理地轻松地对它们进行逆向工程。

例如，采用这个虚拟语法：

```
grammar T;

parse
 : foo
 | bar
 | OTHER
 ;

foo : INT ;
bar : ALPHA ;

INT   : '0'..'9'+ ;
ALPHA : ('a'..'z' | 'A'..'Z')+ ;
OTHER : . ; 
```

如果您从中生成词法分析器和解析器，则解析器将如下所示：

```
public class TParser extends Parser {

    // $ANTLR start "parse"
    // T.g:3:1: parse : ( foo | bar | OTHER );
    public final void parse() throws RecognitionException {
        ...
    }
    // $ANTLR end "parse"

    // $ANTLR start "foo"
    // T.g:9:1: foo : INT ;
    public final void foo() throws RecognitionException {
        ...
    }
    // $ANTLR end "foo"

    // $ANTLR start "bar"
    // T.g:10:1: bar : ALPHA ;
    public final void bar() throws RecognitionException {
        ...
    }
    // $ANTLR end "bar"
} 
```

和这样的词法分析器：

```
public class TLexer extends Lexer {

    // $ANTLR start "INT"
    public final void mINT() throws RecognitionException {
        // T.g:12:7: ( ( '0' .. '9' )+ )
        ...
    }
    // $ANTLR end "INT"

    // $ANTLR start "ALPHA"
    public final void mALPHA() throws RecognitionException {
        // T.g:13:7: ( ( 'a' .. 'z' | 'A' .. 'Z' )+ )
        ...
    }
    // $ANTLR end "ALPHA"

    // $ANTLR start "OTHER"
    public final void mOTHER() throws RecognitionException {
        // T.g:14:7: ( . )
        ...
    }
    // $ANTLR end "OTHER"
} 
```

如您所见，所有语法规则都在 .java 源文件的注释中。

# c - 如何在递归中找到索引

> ID：14531231
> 
> 赞同：0
> 
> 时间：2013-01-25T22:17:16.637
> 
> 标签：c, recursion, indexing

（在 c 编程中）如果您不介意，我还有另一个索引问题。

我使用此函数来查找整数数组中的最大数：

```
int Find_max(int *array,int n){
    if(n==1) return array[0];
    int num1=Find_max(array,n/2);
    int num2=Find_max(array+n/2,n-n/2);
    if(num1>num2) return num1;
    return num2;
} 
```

如何获取我找到的号码的索引？我不允许使用任何类型的循环。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T22:25:48.497

几乎相同的代码（保留样式）：

```
int Find_max_index(int *array,int n){
    if(n==1) return 0;
    int index1=Find_max_index(array,n/2);
    int index2=n/2+Find_max_index(array+n/2,n-n/2);
    if(array[index1]>array[index2]) return index1;
    return index2;
} 
```

# node.js - 如何在几个模块中使用 Winston？

> ID：14531232
> 
> 赞同：69
> 
> 时间：2013-01-25T22:17:20.910
> 
> 标签：node.js, winston

我有几个模块 - 比如说 server.js、module1.js、...、moduleN.js。

我想在我的 server.js 中定义日志文件：

```
winston.add(winston.transports.File, { filename: 'mylogfile.log' }); 
```

然后在我的所有模块中使用它。

最好的方法是什么？我可以`exports.winston=winston;`在每个模块中，然后在 server.js 中设置它，但是有没有更好的解决方案？

先感谢您！

* * *

## 回答 #1

> 赞同：108
> 
> 时间：2013-07-19T03:24:31.300

默认记录器概念很好地处理了这个问题。

Winston 定义了一个默认记录器，任何对 winston 的直接要求（和后续要求）都将检索该记录器。因此，您只需配置这个默认记录器一次，它就可以通过 vanilla require('winston') 在其经过调整的多传输模式下供后续模块使用。

例如，这是我完整的日志记录设置，它定义了 3 个传输。我有时将 Loggly 换成 MongoDB。

## 服务器.js

```
var logger=require('./log.js'); 
// requires winston and configures transports for winstons default logger- see code below. 
```

## 所有其他 .js 文件

```
var logger=require('winston'); // this retrieves default logger which was configured in log.js
logger.info("the default logger with my tricked out transports is rockin this module"); 
```

## log.js - 这是默认记录器的一次性配置

```
var logger = require('winston');
var Loggly = require('winston-loggly').Loggly;
var loggly_options={ subdomain: "mysubdomain", inputToken: "efake000-000d-000e-a000-xfakee000a00" }
logger.add(Loggly, loggly_options);
logger.add(winston.transports.File, { filename: "../logs/production.log" });
logger.info('Chill Winston, the logs are being captured 3 ways- console, file, and Loggly');
module.exports=logger; 
```

或者，对于更复杂的场景，您可以使用 winston 容器并从其他模块中的命名容器中检索记录器。这个我没用过。

我唯一的问题是我的部署主机上缺少日志目录，这很容易修复。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-01-25T23:02:25.387

我所做的（这可能不是最好的方法）是使用一个“全局”模块，在其中导出我通过我的应用程序使用的所有东西。例如：

```
//Define your winston instance
winston.add(winston.transports.File, { filename: 'mylogfile.log' });
exports.logger = winston;

exports.otherGlobals = .... 
```

现在只需要从你的其他模块中使用这个全局使用的模块

```
var Global = require(/path/to/global.js); 
```

因为文件在第一次加载后被缓存（您可以通过在全局中包含一条日志语句来验证；它只会记录一次），再次包含它的开销很小。将它们全部放入一个文件也比在每一页上要求所有全局使用的模块更容易。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2014-04-27T23:00:50.550

我想使用自定义颜色和级别。

所以我删除了默认的控制台传输并设置了一个彩色的

这是我的**logger.js**

```
var logger = require('winston');

logger.setLevels({
    debug:0,
    info: 1,
    silly:2,
    warn: 3,
    error:4,
});
logger.addColors({
    debug: 'green',
    info:  'cyan',
    silly: 'magenta',
    warn:  'yellow',
    error: 'red'
});

logger.remove(logger.transports.Console);
logger.add(logger.transports.Console, { level: 'debug', colorize:true });

module.exports = logger; 
```

**从 app.js 加载：**

```
var logger = require('./lib/log.js'); 
```

**从其他模块加载：**

```
 var logger = require('winston'); 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2015-06-02T02:48:52.380

稍微偏离主题（正如 OP 询问温斯顿），但我喜欢 Bunyan 的“儿童记录器”方法：

```
var bunyan = require('bunyan');
var log = bunyan.createLogger({name: 'myapp'});

app.use(function(req, res, next) {
  req.log = log.child({reqId: uuid()});
  next();
});

app.get('/', function(req, res) {
  req.log.info({user: ...});
}); 
```

它解决了 OP 的问题，因为记录器可通过 req 对象使用（因此每个模块中不需要“require（log）”）。此外，属于特定请求的所有日志条目都将具有将它们连接在一起的唯一 ID。

```
{"name":"myapp","hostname":"pwony-2","pid":14837,"level":30,"reqId":"XXXX-XX-XXXX","user":"...@gmail.com","time":"2014-05-26T18:27:43.530Z","v":0} 
```

我不确定温斯顿是否也支持这一点。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2018-07-13T22:31:18.560

我现在正在开发**Winston 3.0.0**。似乎配置默认记录器的方式发生了一些变化。对我有用的方式如下：

**log.js** // 全局记录器的设置

```
const winston= require('winston');

winston.configure({
  level:"debug",
  format: winston.format.combine(
    winston.format.colorize(),
    winston.format.simple()
  ),
  transports: [
    new winston.transports.Console()
  ]
}); 
```

另一部分是一样的。在您应用程序的开头`require('log.js')`，以及`require ('winston'),` 在所有其他文件中，只需`require('winston')`

.

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2017-08-29T10:14:20.527

我正在创建一个新的 Winston 记录器。

**日志.js**

```
'use strict';

const winston = require('winston');

module.exports = new(winston.Logger)({
    transports: [
        new(winston.transports.Console)({
            level: 'info'
        })
    ]
}); 
```

**一个.js**

```
const log = require('./log');

log.info("from a.js"); 
```

**b.js**

```
const log = require('./log');

log.info("from b.js"); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2020-05-02T09:37:57.007

这是我的记录器配置，winston 版本是`3.2.1`.

它将日志存储在`application.log`文件中并用于我正在使用的错误堆栈跟踪以及在错误情况下打印堆栈跟踪的函数中的`errors({ stack: true })`小技巧。`printf`

### 配置

```
const {format, transports} = require('winston');
const { timestamp, colorize, printf, errors } = format;
const { Console, File } = transports;
LoggerConfig = {
        level: process.env.LOGGER_LEVEL || 'debug',
        transports: [
            new Console(),
            new File({filename: 'application.log'})
        ],
        format: format.combine(
            errors({ stack: true }),
            timestamp(),
            colorize(),
            printf(({ level, message, timestamp, stack }) => {
                if (stack) {
                    // print log trace 
                    return `${timestamp} ${level}: ${message} - ${stack}`;
                }
                return `${timestamp} ${level}: ${message}`;
            }),
        ),
        expressFormat: true, // Use the default Express/morgan request formatting
        colorize: false, // Color the text and status code, using the Express/morgan color palette (text: gray, status: default green, 3XX cyan, 4XX yellow, 5XX red).
        ignoreRoute: function (req, res) {
            return false;
        } // optional: allows to skip some log messages based on request and/or response
} 
```

### 宣布

我`express-winston`也在通用日志中使用相同的配置。我`__logger`在全局声明了对象，这样您就不需要每次都在每个文件中导入。通常在节点 js 中，所有全局变量前缀都带有 2 个下划线（`__`），因此最好遵循这一点。

服务器.js

```
const winston = require('winston');
const expressWinston = require('express-winston');

/**
 * winston.Logger
 * logger for specified log message like console.log
 */
global.__logger = winston.createLogger(LoggerConfig);
/**
 * logger for every HTTP request comes to app
 */
app.use(expressWinston.logger(LoggerConfig)); 
```

### 采用

`__logger`是全球性的，因此您可以在任何地方使用它，例如：

blog.controller.js

```
function save(req, res) {
  try {
    __logger.debug('Blog add operation');
    .
    .
    return res.send(blog);
  } catch (error) {
    __logger.error(error);
    return res.status(500).send(error);
  }
} 
```

希望这会有所帮助！

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2020-05-11T21:44:14.743

我使用工厂函数并传入模块名称，以便可以将其添加到元数据中：

logger-factory.js

```
const path = require('path');
const { createLogger, format, transports } = require('winston');
const { combine, errors, timestamp } = format;

const baseFormat = combine(
  timestamp({ format: 'YYYY-MM-DD HH:mm:ss' }),
  errors({ stack: true }),
  format((info) => {
    info.level = info.level.toUpperCase();
    return info;
  })(),
);

const splunkFormat = combine(
  baseFormat,
  format.json(),
);

const prettyFormat = combine(
  baseFormat,
  format.prettyPrint(),
);

const createCustomLogger = (moduleName) => createLogger({
  level: process.env.LOG_LEVEL,
  format: process.env.PRETTY_LOGS ? prettyFormat : splunkFormat,
  defaultMeta: { module: path.basename(moduleName) },
  transports: [
    new transports.Console(),
  ],
});

module.exports = createCustomLogger; 
```

app-harness.js（这样我就可以运行导出的索引模块）

```
const index = require('./index');

// https://docs.aws.amazon.com/lambda/latest/dg/with-s3.html
const sampleEvent = {
  "Records": [
    {
      "eventVersion": "2.1",
      "eventSource": "aws:s3",
      "awsRegion": "us-east-2",
      "eventTime": "2019-09-03T19:37:27.192Z",
      "eventName": "ObjectCreated:Put",
      "userIdentity": {
        "principalId": "AWS:AIDAINPONIXQXHT3IKHL2"
      },
      "requestParameters": {
        "sourceIPAddress": "205.255.255.255"
      },
      "responseElements": {
        "x-amz-request-id": "D82B88E5F771F645",
        "x-amz-id-2": "vlR7PnpV2Ce81l0PRw6jlUpck7Jo5ZsQjryTjKlc5aLWGVHPZLj5NeC6qMa0emYBDXOo6QBU0Wo="
      },
      "s3": {
        "s3SchemaVersion": "1.0",
        "configurationId": "828aa6fc-f7b5-4305-8584-487c791949c1",
        "bucket": {
          "name": "lambda-artifacts-deafc19498e3f2df",
          "ownerIdentity": {
            "principalId": "A3I5XTEXAMAI3E"
          },
          "arn": "arn:aws:s3:::lambda-artifacts-deafc19498e3f2df"
        },
        "object": {
          "key": "b21b84d653bb07b05b1e6b33684dc11b",
          "size": 1305107,
          "eTag": "b21b84d653bb07b05b1e6b33684dc11b",
          "sequencer": "0C0F6F405D6ED209E1"
        }
      }
    }
  ]
};

index.handler(sampleEvent)
  .then(() => console.log('SUCCESS'))
  .catch((_) => console.log('FAILURE')); 
```

index.js

```
const logger = require('./logger-factory')(__filename);
const app = require('./app');

exports.handler = async function (event) {
  try {
    logger.debug('lambda triggered with event', { event });
    await app.run(event);
    logger.debug(`lambda finished`);
  } catch(error) {
    logger.error('lambda failed: ', error);
    // rethrow the error up to AWS
    throw error;
  }
} 
```

应用程序.js

```
const logger = require('./logger-factory')(__filename);

const run = async (event) => {
  logger.info('processing S3 event', event);
  try {
    logger.info('reading s3 file')
    // throws because I used "Record" instead of "Records"
    const s3 = event.Record[0].s3;
    // use s3 to read the file
  } catch (error) {
    logger.error('failed to read from S3: ', error);
    throw error;
  }
};

module.exports = { run }; 
```

当我在本地运行应用程序时`WARN`：

```
~/repos/ghe/lambda-logging (master * u=)> LOG_LEVEL=warn node -r dotenv/config ./src/app-harness.js
{
  module: 'app.js',
  level: 'ERROR',
  message: "failed to read from S3: Cannot read property '0' of undefined",
  stack: "TypeError: Cannot read property '0' of undefined\n" +
    '    at Object.run (/Users/jason.berk/repos/ghe/lambda-logging/src/app.js:8:28)\n' +
    '    at Object.exports.handler (/Users/jason.berk/repos/ghe/lambda-logging/src/index.js:7:15)\n' +
    '    at Object.<anonymous> (/Users/jason.berk/repos/ghe/lambda-logging/src/test-harness.js:44:7)\n' +
    '    at Module._compile (internal/modules/cjs/loader.js:1158:30)\n' +
    '    at Object.Module._extensions..js (internal/modules/cjs/loader.js:1178:10)\n' +
    '    at Module.load (internal/modules/cjs/loader.js:1002:32)\n' +
    '    at Function.Module._load (internal/modules/cjs/loader.js:901:14)\n' +
    '    at Function.executeUserEntryPoint [as runMain] (internal/modules/run_main.js:74:12)\n' +
    '    at internal/main/run_main_module.js:18:47',
  timestamp: '2020-05-11 17:34:06'
}
{
  module: 'index.js',
  level: 'ERROR',
  message: "lambda failed: Cannot read property '0' of undefined",
  stack: "TypeError: Cannot read property '0' of undefined\n" +
    '    at Object.run (/Users/jason.berk/repos/ghe/lambda-logging/src/app.js:8:28)\n' +
    '    at Object.exports.handler (/Users/jason.berk/repos/ghe/lambda-logging/src/index.js:7:15)\n' +
    '    at Object.<anonymous> (/Users/jason.berk/repos/ghe/lambda-logging/src/test-harness.js:44:7)\n' +
    '    at Module._compile (internal/modules/cjs/loader.js:1158:30)\n' +
    '    at Object.Module._extensions..js (internal/modules/cjs/loader.js:1178:10)\n' +
    '    at Module.load (internal/modules/cjs/loader.js:1002:32)\n' +
    '    at Function.Module._load (internal/modules/cjs/loader.js:901:14)\n' +
    '    at Function.executeUserEntryPoint [as runMain] (internal/modules/run_main.js:74:12)\n' +
    '    at internal/main/run_main_module.js:18:47',
  timestamp: '2020-05-11 17:34:06'
} 
```

当我在`DEBUG`水平运行时：

```
~/repos/ghe/lambda-logging (master * u=)> LOG_LEVEL=debug node -r dotenv/config ./src/test-harness.js 
{
  module: 'index.js',
  event: {
    Records: [
      {
        eventVersion: '2.1',
        eventSource: 'aws:s3',
        awsRegion: 'us-east-2',
        eventTime: '2019-09-03T19:37:27.192Z',
        eventName: 'ObjectCreated:Put',
        userIdentity: { principalId: 'AWS:AIDAINPONIXQXHT3IKHL2' },
        requestParameters: { sourceIPAddress: '205.255.255.255' },
        responseElements: {
          'x-amz-request-id': 'D82B88E5F771F645',
          'x-amz-id-2': 'vlR7PnpV2Ce81l0PRw6jlUpck7Jo5ZsQjryTjKlc5aLWGVHPZLj5NeC6qMa0emYBDXOo6QBU0Wo='
        },
        s3: {
          s3SchemaVersion: '1.0',
          configurationId: '828aa6fc-f7b5-4305-8584-487c791949c1',
          bucket: {
            name: 'lambda-artifacts-deafc19498e3f2df',
            ownerIdentity: { principalId: 'A3I5XTEXAMAI3E' },
            arn: 'arn:aws:s3:::lambda-artifacts-deafc19498e3f2df'
          },
          object: {
            key: 'b21b84d653bb07b05b1e6b33684dc11b',
            size: 1305107,
            eTag: 'b21b84d653bb07b05b1e6b33684dc11b',
            sequencer: '0C0F6F405D6ED209E1'
          }
        }
      }
    ]
  },
  level: 'DEBUG',
  message: 'lambda triggered with event',
  timestamp: '2020-05-11 17:38:21'
}
{
  module: 'app.js',
  Records: [
    {
      eventVersion: '2.1',
      eventSource: 'aws:s3',
      awsRegion: 'us-east-2',
      eventTime: '2019-09-03T19:37:27.192Z',
      eventName: 'ObjectCreated:Put',
      userIdentity: { principalId: 'AWS:AIDAINPONIXQXHT3IKHL2' },
      requestParameters: { sourceIPAddress: '205.255.255.255' },
      responseElements: {
        'x-amz-request-id': 'D82B88E5F771F645',
        'x-amz-id-2': 'vlR7PnpV2Ce81l0PRw6jlUpck7Jo5ZsQjryTjKlc5aLWGVHPZLj5NeC6qMa0emYBDXOo6QBU0Wo='
      },
      s3: {
        s3SchemaVersion: '1.0',
        configurationId: '828aa6fc-f7b5-4305-8584-487c791949c1',
        bucket: {
          name: 'lambda-artifacts-deafc19498e3f2df',
          ownerIdentity: { principalId: 'A3I5XTEXAMAI3E' },
          arn: 'arn:aws:s3:::lambda-artifacts-deafc19498e3f2df'
        },
        object: {
          key: 'b21b84d653bb07b05b1e6b33684dc11b',
          size: 1305107,
          eTag: 'b21b84d653bb07b05b1e6b33684dc11b',
          sequencer: '0C0F6F405D6ED209E1'
        }
      }
    }
  ],
  level: 'INFO',
  message: 'processing S3 event',
  timestamp: '2020-05-11 17:38:21'
}
{
  message: 'reading s3 file',
  level: 'INFO',
  module: 'app.js',
  timestamp: '2020-05-11 17:38:21'
}
{
  module: 'app.js',
  level: 'ERROR',
  message: "failed to read from S3: Cannot read property '0' of undefined",
  stack: "TypeError: Cannot read property '0' of undefined\n" +
    '    at Object.run (/Users/jason.berk/repos/ghe/lambda-logging/src/app.js:8:28)\n' +
    '    at Object.exports.handler (/Users/jason.berk/repos/ghe/lambda-logging/src/index.js:7:15)\n' +
    '    at Object.<anonymous> (/Users/jason.berk/repos/ghe/lambda-logging/src/test-harness.js:44:7)\n' +
    '    at Module._compile (internal/modules/cjs/loader.js:1158:30)\n' +
    '    at Object.Module._extensions..js (internal/modules/cjs/loader.js:1178:10)\n' +
    '    at Module.load (internal/modules/cjs/loader.js:1002:32)\n' +
    '    at Function.Module._load (internal/modules/cjs/loader.js:901:14)\n' +
    '    at Function.executeUserEntryPoint [as runMain] (internal/modules/run_main.js:74:12)\n' +
    '    at internal/main/run_main_module.js:18:47',
  timestamp: '2020-05-11 17:38:21'
}
{
  module: 'index.js',
  level: 'ERROR',
  message: "lambda failed: Cannot read property '0' of undefined",
  stack: "TypeError: Cannot read property '0' of undefined\n" +
    '    at Object.run (/Users/jason.berk/repos/ghe/lambda-logging/src/app.js:8:28)\n' +
    '    at Object.exports.handler (/Users/jason.berk/repos/ghe/lambda-logging/src/index.js:7:15)\n' +
    '    at Object.<anonymous> (/Users/jason.berk/repos/ghe/lambda-logging/src/test-harness.js:44:7)\n' +
    '    at Module._compile (internal/modules/cjs/loader.js:1158:30)\n' +
    '    at Object.Module._extensions..js (internal/modules/cjs/loader.js:1178:10)\n' +
    '    at Module.load (internal/modules/cjs/loader.js:1002:32)\n' +
    '    at Function.Module._load (internal/modules/cjs/loader.js:901:14)\n' +
    '    at Function.executeUserEntryPoint [as runMain] (internal/modules/run_main.js:74:12)\n' +
    '    at internal/main/run_main_module.js:18:47',
  timestamp: '2020-05-11 17:38:21'
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-01-07T11:45:15.133

如果你想让记录器成为一个全局变量 - 你必须专门通过将它分配给全局变量来做

logger.js

```
var winston = require('winston')

var winston = winston.createLogger({
transports: [
  new (winston.transports.Console)(),
  new (winston.transports.File)({
    filename: './logs/logger.log'
  })
]
});
module.exports=winston; 
```

应用程序.js

```
let logger  = require('./logger')
global.__logger = logger 
```

someController.js

```
__logger.info('created log successfully') 
```

注意：最好为每个全局变量分配一个前缀，这样您就会知道这是一个全局变量。我使用 __ 作为前缀（双低破折号）

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-12-15T17:27:55.270

只需创建 logger.js 并放入

```
const winston = require('winston');

const logger = winston.createLogger({
  level: 'info',
  format: winston.format.combine(
    winston.format.colorize(),
    winston.format.simple()
  ),
  transports: [
    new winston.transports.Console()
  ]
});

module.exports = logger 
```

然后你可以在任何地方请求和使用它，因为 logger 现在是单例的。

```
const logger = require('./utils/logger');
logger.info('Hello!'); 
```

如果需要，这甚至可以让您选择交换日志库。接受的答案是完全错误的，离意大利面条代码更近了一步。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-02-11T09:49:21.917

在我的团队中，我们创建了一个包含所有默认配置的私有 npm 包（如您在之前的答案中所示）

我只有一个问题：将记录器对象声明为全局对象以避免在每个模块中导入是一种好习惯吗？

# java - 在java中，使用byte或short而不是int和float而不是double更有效吗？

> ID：14531235
> 
> 赞同：104
> 
> 时间：2013-01-25T20:22:12.277
> 
> 标签：java, performance, int, double, primitive-types

我注意到我总是使用 int 和 doubles，无论数字需要多大或多小。`byte`那么在java中，使用or`short`代替`int`and`float`代替更有效`double`吗？

所以假设我有一个包含大量整数和双打的程序。如果我知道这个数字合适，是否值得通过并将我的整数更改为字节或短裤？

我知道java没有无符号类型，但是如果我知道这个数字只是正数，我还能做些什么吗？

我所说的高效主要是指处理。我假设如果所有变量都是一半大小，那么垃圾收集器会快得多，并且计算也可能会更快一些。（我想因为我正在使用android，所以我也需要有点担心ram）

（我假设垃圾收集器只处理对象而不是原始对象，但仍会删除废弃对象中的所有原始对象，对吧？）

我用我拥有的一个小型 android 应用程序进行了尝试，但并没有真正注意到有什么不同。（虽然我没有“科学地”测量任何东西。）

我认为它应该更快、更高效是错误的吗？我不想经历并改变一个庞大的程序中的所有内容，以发现我浪费了我的时间。

当我开始一个新项目时，从一开始就值得吗？（我的意思是我认为每一点都会有所帮助，但如果是这样，为什么似乎没有人这样做。）

* * *

## 回答 #1

> 赞同：122
> 
> 时间：2013-01-26T00:08:19.787

> 我认为它应该更快、更高效是错误的吗？我不想经历并改变一个庞大的程序中的所有内容，以发现我浪费了我的时间。

## 简短的回答

是的，你错了。在大多数情况下，它在使用的空间方面*几乎没有什么区别*。

不*值得*尝试优化...除非您有明确的证据表明需要优化。如果您确实*需要*特别优化对象字段的内存使用，您可能需要采取其他（更有效的）措施。

## 更长的答案

Java 虚拟机使用（实际上）是 32 位原始单元大小的倍数的偏移量对堆栈和对象字段进行建模。因此，当您将局部变量或对象字段声明为（例如） a`byte`时，变量/字段将存储在 32 位单元格中，就像 a 一样`int`。

这有两个例外：

*   `long`和`double`值需要 2 个原始 32 位单元
*   原始类型的数组以打包形式表示，因此（例如）一个字节数组每个 32 位字包含 4 个字节。

因此，*可能*值得优化使用`long`and `double`... 和大型基元数组。但总的来说没有。

^(理论上，JIT*可能*能够优化这一点，但在实践中，我从未听说过这样的 JIT。一个障碍是 JIT 通常在创建正在编译的类的实例之后才能运行。如果 JIT 优化了内存布局，您可能有两个（或更多）同一类对象的“风味”......这将带来巨大的困难。)

* * *

## 重访

查看@meriton 答案中的基准测试结果，似乎使用`short`and`byte`代替`int`会导致乘法性能下降。事实上，如果你孤立地考虑这些操作，惩罚是巨大的。（你不应该孤立地考虑它们......但这是另一个话题。）

我认为解释是 JIT 可能在每种情况下都使用 32 位乘法指令进行乘法运算。但是在`byte`and`short`情况下，它会执行*额外的*指令来将中间 32 位值转换为 a `byte`or`short`在每个循环迭代中。（理论上，可以在循环结束时进行一次转换......但我怀疑优化器是否能够解决这个问题。）

无论如何，这确实指出了切换到`short`和`byte`作为优化的另一个问题。它可能会使性能*更差*......在算术和计算密集型算法中。

* * *

## 次要问题

> 我知道java没有无符号类型，但是如果我知道这个数字只是正数，我还能做些什么吗？

不，无论如何都不是在性能方面。`Integer`（在,等中有一些方法可以将,`Long`等处理为无符号的。但这些并没有带来任何性能优势。这不是他们的目的。）`int``long`

> （我假设垃圾收集器只处理对象而不是原始对象，但仍会删除废弃对象中的所有原始对象，对吧？）

正确的。对象的字段是对象的*一部分*。当对象被垃圾收集时，它就会消失。同样，当收集阵列时，阵列的单元格就会消失。当字段或单元格类型是原始类型时，该值将存储在字段/单元格中......它是对象/数组的一部分......并且已被删除。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2013-01-26T00:50:25.870

这取决于 JVM 的实现以及底层硬件。大多数现代硬件不会从内存（甚至从第一级缓存）中获取单个字节，即使用较小的原始类型通常不会减少内存带宽消耗。同样，现代 CPU 的字长为 64 位。他们可以对更少的位执行操作，但这通过丢弃额外的位来工作，这也不是更快。

唯一的好处是较小的原始类型可以导致更紧凑的内存布局，尤其是在使用数组时。这节省了内存，可以提高引用的局部性（从而减少缓存未命中的数量）并减少垃圾收集开销。

然而，一般来说，使用较小的原始类型并不快。

为了证明这一点，请看以下基准：

```
public class Benchmark {

    public static void benchmark(String label, Code code) {
        print(25, label);

        try {
            for (int iterations = 1; ; iterations *= 2) { // detect reasonable iteration count and warm up the code under test
                System.gc(); // clean up previous runs, so we don't benchmark their cleanup
                long previouslyUsedMemory = usedMemory();
                long start = System.nanoTime();
                code.execute(iterations);
                long duration = System.nanoTime() - start;
                long memoryUsed = usedMemory() - previouslyUsedMemory;

                if (iterations > 1E8 || duration > 1E9) { 
                    print(25, new BigDecimal(duration * 1000 / iterations).movePointLeft(3) + " ns / iteration");
                    print(30, new BigDecimal(memoryUsed * 1000 / iterations).movePointLeft(3) + " bytes / iteration\n");
                    return;
                }
            }
        } catch (Throwable e) {
            throw new RuntimeException(e);
        }
    }

    private static void print(int desiredLength, String message) {
        System.out.print(" ".repeat(Math.max(1, desiredLength - message.length())) + message);
    }

    private static long usedMemory() {
        return Runtime.getRuntime().totalMemory() - Runtime.getRuntime().freeMemory();
    }

    @FunctionalInterface
    interface Code {
        /**
         * Executes the code under test.
         * 
         * @param iterations
         *            number of iterations to perform
         * @return any value that requires the entire code to be executed (to
         *         prevent dead code elimination by the just in time compiler)
         * @throws Throwable
         *             if the test could not complete successfully
         */
        Object execute(int iterations);
    }

    public static void main(String[] args) {
        benchmark("long[] traversal", (iterations) -> {
            long[] array = new long[iterations];
            for (int i = 0; i < iterations; i++) {
                array[i] = i;
            }
            return array;
        });
        benchmark("int[] traversal", (iterations) -> {
            int[] array = new int[iterations];
            for (int i = 0; i < iterations; i++) {
                array[i] = i;
            }
            return array;
        });
        benchmark("short[] traversal", (iterations) -> {
            short[] array = new short[iterations];
            for (int i = 0; i < iterations; i++) {
                array[i] = (short) i;
            }
            return array;
        });
        benchmark("byte[] traversal", (iterations) -> {
            byte[] array = new byte[iterations];
            for (int i = 0; i < iterations; i++) {
                array[i] = (byte) i;
            }
            return array;
        });

        benchmark("long fields", (iterations) -> {
            class C {
                long a = 1;
                long b = 2;
            }

            C[] array = new C[iterations];
            for (int i = 0; i < iterations; i++) {
                array[i] = new C();
            }
            return array;
        });
        benchmark("int fields", (iterations) -> {
            class C {
                int a = 1;
                int b = 2;
            }

            C[] array = new C[iterations];
            for (int i = 0; i < iterations; i++) {
                array[i] = new C();
            }
            return array;
        });
        benchmark("short fields", (iterations) -> {
            class C {
                short a = 1;
                short b = 2;
            }

            C[] array = new C[iterations];
            for (int i = 0; i < iterations; i++) {
                array[i] = new C();
            }
            return array;
        });
        benchmark("byte fields", (iterations) -> {
            class C {
                byte a = 1;
                byte b = 2;
            }

            C[] array = new C[iterations];
            for (int i = 0; i < iterations; i++) {
                array[i] = new C();
            }
            return array;
        });

        benchmark("long multiplication", (iterations) -> {
            long result = 1;
            for (int i = 0; i < iterations; i++) {
                result *= 3;
            }
            return result;
        });
        benchmark("int multiplication", (iterations) -> {
            int result = 1;
            for (int i = 0; i < iterations; i++) {
                result *= 3;
            }
            return result;
        });
        benchmark("short multiplication", (iterations) -> {
            short result = 1;
            for (int i = 0; i < iterations; i++) {
                result *= 3;
            }
            return result;
        });
        benchmark("byte multiplication", (iterations) -> {
            byte result = 1;
            for (int i = 0; i < iterations; i++) {
                result *= 3;
            }
            return result;
        });
    }
} 
```

在我的 Intel Core i7 CPU @ 3.5 GHz 上使用 OpenJDK 14 运行，这将打印：

```
 long[] traversal     3.206 ns / iteration      8.007 bytes / iteration
      int[] traversal     1.557 ns / iteration      4.007 bytes / iteration
    short[] traversal     0.881 ns / iteration      2.007 bytes / iteration
     byte[] traversal     0.584 ns / iteration      1.007 bytes / iteration
          long fields    25.485 ns / iteration     36.359 bytes / iteration
           int fields    23.126 ns / iteration     28.304 bytes / iteration
         short fields    21.717 ns / iteration     20.296 bytes / iteration
          byte fields    21.767 ns / iteration     20.273 bytes / iteration
  long multiplication     0.538 ns / iteration      0.000 bytes / iteration
   int multiplication     0.526 ns / iteration      0.000 bytes / iteration
 short multiplication     0.786 ns / iteration      0.000 bytes / iteration
  byte multiplication     0.784 ns / iteration      0.000 bytes / iteration 
```

如您所见，唯一显着的速度节省发生在遍历大型数组时；使用较小的对象字段产生的好处可以忽略不计，并且在小数据类型上计算实际上稍微慢一些。

总的来说，性能差异很小。优化算法远比选择原始类型重要。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-05-12T13:41:43.677

如果您大量使用它们，使用`byte`而不是可以提高性能。`int`这是一个实验：

```
import java.lang.management.*;

public class SpeedTest {

/** Get CPU time in nanoseconds. */
public static long getCpuTime() {
    ThreadMXBean bean = ManagementFactory.getThreadMXBean();
    return bean.isCurrentThreadCpuTimeSupported() ? bean
            .getCurrentThreadCpuTime() : 0L;
}

public static void main(String[] args) {
    long durationTotal = 0;
    int numberOfTests=0;

    for (int j = 1; j < 51; j++) {
        long beforeTask = getCpuTime();
        // MEASURES THIS AREA------------------------------------------
        long x = 20000000;// 20 millions
        for (long i = 0; i < x; i++) {
                           TestClass s = new TestClass(); 

        }
        // MEASURES THIS AREA------------------------------------------
        long duration = getCpuTime() - beforeTask;
        System.out.println("TEST " + j + ": duration = " + duration + "ns = "
                + (int) duration / 1000000);
        durationTotal += duration;
        numberOfTests++;
    }
    double average = durationTotal/numberOfTests;
    System.out.println("-----------------------------------");
    System.out.println("Average Duration = " + average + " ns = "
            + (int)average / 1000000 +" ms (Approximately)");

} 
```

}

此类测试创建新`TestClass`. 每个测试执行 2000 万次，有 50 次测试。

这是测试类：

```
 public class TestClass {
     int a1= 5;
     int a2= 5; 
     int a3= 5;
     int a4= 5; 
     int a5= 5;
     int a6= 5; 
     int a7= 5;
     int a8= 5; 
     int a9= 5;
     int a10= 5; 
     int a11= 5;
     int a12=5; 
     int a13= 5;
     int a14= 5; 
 } 
```

我已经`SpeedTest`上课了，最后得到了这个：

```
 Average Duration = 8.9625E8 ns = 896 ms (Approximately) 
```

现在我将 ints 更改为 TestClass 中的字节并再次运行它。结果如下：

```
 Average Duration = 6.94375E8 ns = 694 ms (Approximately) 
```

我相信这个实验表明，如果您要实例化大量变量，使用 byte 代替 int 可以提高效率

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-26T00:17:44.833

byte 一般认为是 8 位。short 通常被认为是 16 位。

在一个“纯”的环境中，它不是 java 的所有字节和长、短和其他有趣的东西的实现通常对你隐藏，字节可以更好地利用空间。

但是，您的计算机可能不是 8 位的，也可能不是 16 位的。这意味着特别是要获得 16 或 8 位，它需要诉诸“诡计”，这会浪费时间来假装它有能力在需要时访问这些类型。

在这一点上，这取决于硬件是如何实现的。但是，我一直认为，最好的速度是通过将东西存储在适合您的 CPU 使用的块中来实现的。64 位处理器喜欢处理 64 位元素，而任何低于此值的东西通常需要“工程魔法”来假装它喜欢处理它们。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-09-19T11:51:59.550

short/byte/char 性能较差的原因之一是缺乏对这些数据类型的直接支持。通过直接支持，这意味着 JVM 规范没有提及这些数据类型的任何指令集。存储、加载、添加等指令具有 int 数据类型的版本。但他们没有短/字节/字符的版本。例如考虑下面的java代码：

```
void spin() {
 int i;
 for (i = 0; i < 100; i++) {
 ; // Loop body is empty
 }
} 
```

同样被转换为机器代码，如下所示。

```
0 iconst_0 // Push int constant 0
1 istore_1 // Store into local variable 1 (i=0)
2 goto 8 // First time through don't increment
5 iinc 1 1 // Increment local variable 1 by 1 (i++)
8 iload_1 // Push local variable 1 (i)
9 bipush 100 // Push int constant 100
11 if_icmplt 5 // Compare and loop if less than (i < 100)
14 return // Return void when done 
```

现在，考虑将 int 更改为 short ，如下所示。

```
void sspin() {
 short i;
 for (i = 0; i < 100; i++) {
 ; // Loop body is empty
 }
} 
```

对应的机器码会变化如下：

```
0 iconst_0
1 istore_1
2 goto 10
5 iload_1 // The short is treated as though an int
6 iconst_1
7 iadd
8 i2s // Truncate int to short
9 istore_1
10 iload_1
11 bipush 100
13 if_icmplt 5
16 return 
```

如您所见，要操作 short 数据类型，它仍然使用 int 数据类型指令版本，并在需要时将 int 显式转换为 short。现在，由于这个原因，性能会降低。

现在，引用不提供直接支持的原因如下：

> Java 虚拟机对 int 类型的数据提供了最直接的支持。这部分是因为对 Java 虚拟机的操作数堆栈和局部变量数组的高效实现的预期。它还受到典型程序中 int 数据频率的推动。其他整数类型的直接支持较少。例如，没有字节、字符或短版本的存储、加载或添加指令。

引用自[此处](https://docs.oracle.com/javase/specs/jvms/se8/jvms8.pdf)提供的 JVM 规范（第 58 页）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-25T21:00:01.670

差别几乎看不出来！这更多的是设计、适当性、统一性、习惯等问题……有时只是品味问题。当您关心的只是您的程序启动并运行并且用 a`float`代替 an`int`不会损害正确性时，我认为选择一个或另一个没有任何优势，除非您可以证明使用任何一种类型都会改变性能。根据 2 或 3 字节不同的类型调整性能确实是您最不应该关心的事情；Donald Knuth 曾经说过：“过早的优化是万恶之源”（不确定是他，如果你有答案，请编辑）。

# c# - 如何在我的 C# 游戏中控制加速和减速

> ID：14531238
> 
> 赞同：6
> 
> 时间：2013-01-25T22:17:33.200
> 
> 标签：c#, xna

我正在构建一个驾驶游戏。视图是一个透视图，玩家的视角是从向前行驶的汽车后面。当汽车向前行驶时，它周围的所有环境都向下移动并缩放（现在看起来相当不错），这给人一种汽车向前行驶的印象。现在，我想要一些逼真的驾驶控制，让汽车加速，然后在释放向上箭头时逐渐减速。目前，当按下向上箭头时，我会调用几个精灵的所有移动函数。我正在寻找一种方法来控制它，以便在汽车慢等时不经常调用这些函数。到目前为止我的代码是：

```
 protected void Drive()
    {
        KeyboardState keyState = Keyboard.GetState();

        if (keyState.IsKeyDown(Keys.Up))
        {
            MathHelper.Clamp(++TruckSpeed, 0, 100);
        }
        else
        {
            MathHelper.Clamp(--TruckSpeed, 0, 100);
        }

        // Instead of using the condition below, I want to use the TruckSpeed
        // variable some way to control the rate at which these are called 
        // so I can give the impression of acceleration and de-acceleration.

        if (keyState.IsKeyDown(Keys.Up))
        {
            // Lots of update calls in here
        }
   } 
```

我认为这应该很容易，但由于某种原因，我无法理解它。真的很感激这里的一些帮助！谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T22:24:45.967

第一个建议，不要使用`++`and `--`。使您的`TruckSpeed`增长速度乘以`Delta Time`. 这意味着您的加速和减速将在越来越慢的计算机上运行，​​并且将独立于帧速率提升。您还可以有不同的增加和减少率，以更好地控制您的游戏玩法。

类似于以下内容：

```
protected void Drive(GameTime gameTime) // Pass your game time
{
    KeyboardState keyState = Keyboard.GetState();
    if (keyState.IsKeyDown(Keys.Up))
    {
        TruckSpeed += AccelerationRatePerSecond * gameTime.ElapsedGameTime.TotalSeconds;
    }
    else
    {
        TruckSpeed -= DecelerationRatePerSecond * gameTime.ElapsedGameTime.TotalSeconds;
    }
    MathHelper.Clamp(TruckSpeed, 0, 100);
    ... 
```

此外，您可能可以更换

```
if (keyState.IsKeyDown(Keys.Up)) 
```

经过

```
if (TruckSpeed > 0) 
```

将相机连接到模型并在环境中移动它可能更简单，而不是在卡车周围移动整个环境......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T22:31:38.810

最简单和正确的方法是将键盘控制与物理分离。您希望以更改/每单位时间而不是更改/每次按钮单击来测量加速度。比每次迭代都需要根据自上次更新以来经过的时间修改速度...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T22:31:40.257

加速度不是线性的。因此，我建议不要使用 ++ 或 -- 运算符。而是调用一个函数来计算速度随时间的变化（delta V）/时间。如果你想要一种真正的加速感觉，你可能会考虑一些类似的东西。

# git - `git flow release finish` 非交互方式

> ID：14531243
> 
> 赞同：29
> 
> 时间：2013-01-25T22:17:48.710
> 
> 标签：git, command-line, git-flow

如何`git flow release finish`以不要求合并提交消息的方式使用？正如我所料，该`-m`标志没有提供此功能。

当然，目标是能够以不需要交互的方式编写脚本。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2013-01-27T23:18:26.787

你可以设置环境变量

```
export GIT_MERGE_AUTOEDIT=no

git flow release finish -m 'Merge Message' release_branch_name

unset GIT_MERGE_AUTOEDIT 
```

合并时它不会调用编辑器。

如果您切换到我的 fork [git-flow AVH 版](https://github.com/petervanderdoes/gitflow-avh)，您可以将此选项设置为仅在您使用 git-flow 时有效。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-11-26T22:13:48.457

我在使用 -m 标志时遇到了问题。但是，如果您提供没有空格的消息，它会起作用。一定是个bug。

```
git flow release finish -m 'my_message_with_no_spaces' 1.2.3 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-26T07:21:47.763

`git flow`（或多或少）只是`git`命令的包装。弹出`git-flow-*.sh`你选择的打开，复制 git 命令，然后弄乱它们。在这种情况下，添加`--no-edit`到`git merge`. 这种方法用一块石头杀死两只鸟：您可以将这些行复制到您的自动化脚本中。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2020-11-09T15:24:52.167

我已经完成了：

```
git flow release finish -m "New release:$releaseVersion" -T
$releaseVersion -S $releaseVersion 
```

哪里`-m`是提交消息，`-T`是标签消息，`-S`是壁球提交。现在一切都会自动运行:)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-01-26T04:19:20.643

不幸的是，当前版本的 git-flow 没有开箱即用的方法来实现这一点。

通过查看[源代码](https://github.com/nvie/gitflow/blob/develop/git-flow-release)，用于合并的git命令是

```
git merge --no-ff 
```

并且没有办法将`--no-edit`标志传递给它。

你可以做几件事：

*   fork 项目并插入此功能（可能作为可选标志）
*   将其作为一项功能提出并等待开发人员实施

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-07-12T03:00:30.037

您可以传递`-m`标志以在命令行上指定标记消息。

合并仍有可能发生冲突，但标签操作不会尝试打开标签消息的编辑器。

```
git flow release finish -m "my awesome release" 1.2.3 
```

[https://github.com/nvie/gitflow/wiki/Command-Line-Arguments#git-flow-release-finish--fsumpkn-version](https://github.com/nvie/gitflow/wiki/Command-Line-Arguments#git-flow-release-finish--fsumpkn-version)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-01-26T04:02:34.537

我不知道`git flow`，但如果它支持标准 git 标志，您可以使用该`--no-edit`标志来避免在自动设置中[合并提交消息。](https://stackoverflow.com/a/11744469/877115)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-12-25T13:52:06.500

最后我通过这段代码得到了这个作品：

```
export GIT_MERGE_AUTOEDIT=no
git flow release finish "$newVer" -m "$newVer" -T "$newVer"
unset GIT_MERGE_AUTOEDIT 
```

# xcode - CGRectMake 恢复到原来的位置？

> ID：14531244
> 
> 赞同：0
> 
> 时间：2013-01-25T22:17:53.530
> 
> 标签：xcode, nslayoutconstraint, cgrectmake

我使用以下命令将 UIView 从其原始位置移动到我的 XIB/Storyboard 上：-(void)myMovingViewAction{

```
[UIView animateWithDuration:.15
                 animations:^{
                     [theView setFrame:CGRectMake(0, 40, theView.frame.size.width, theView.frame.size.height)];
                 }
 ];

} 
```

我遇到的问题是让 UIView 回到我的 Storyboard UIViewController/XIB 上的原始位置。

我知道我可以使用与上面相同的代码，其中包含原始坐标，但是这些坐标在不同的设备上是不同的。在这个例子中，约束让我的 UIView 紧贴我的 UIViewController 底部的原始位置。

有没有办法可以将此视图发送回“默认”位置？

提前致谢！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T22:22:26.333

创建一个 CGRect 类型的实例 var theFrame，将其设置为 viewDidAppear 上的 theView.frame。当你想把它移回原来的位置时，你可以做

```
[UIView animateWithDuration:.15
                 animations:^{
                     [theView setFrame:theFrame];
                 }
 ];

} 
```

# java - Java 类中的多个构造函数

> ID：14531247
> 
> 赞同：0
> 
> 时间：2013-01-25T22:18:01.050
> 
> 标签：java, constructor, static-members

我对构造函数有一些疑问。

有一个类“Foo”可以创建为三种不同的“状态”，我们可以称它们为“年轻”、“成人”和“老”。

我想强调它们不能被视为不同的类，因为对象会进化，如果它被创建为“年轻”，它将变成“成人”，然后是“老”等等。

**我的问题是：如何定义一个或多个构造函数来使这三种类型多样化？**

我看到了一些可能性，但没有一个是“优雅”的解决方案。

**1)**创建一个以 int 为输入的构造函数

```
public Foo(int i)
{
    switch (i)
    {
         case 0:
         .
         .
         .
         case 1:
         .
         .
         .
         case 2:
         .
         .
         .
    }
} 
```

但我不喜欢它，因为如果其他人看到此代码，则不太清楚。

**2）**创建一个空白构造函数，然后创建三个不同的方法，如

```
public Foo()
{

}

public void setYoungFoo()
{
    .
    .
    .
}

public void setAdultFoo()
{
    .
    .
    .
}

public void setOldFoo()
{
    .
    .
    .
} 
```

这可能是解决问题的明确方法，但我会在构造函数中解决这个问题..

**3）**静态变量在这种情况下有用吗？

```
public static final String "YOUNG";
public static final String "ADULT";
public static final String "OLD";

public Foo(String field)
{

} 
```

我不知道如何填充这个构造函数，因为我从未使用过静态最终变量（我已经看到它们在一些 Java 类中使用，例如 Calendar，即使没有在构造函数中使用）。

**您能否评论这三个选项以强调它们的缺点是什么，**因为我很确定它们不是一个好的解决方案。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-25T22:22:42.707

使用方法 1，但使用枚举而不是 int。您甚至可以在类中内联枚举，只需将其设为公共静态即可。

```
class Foo {
    public static enum fooState {
       young, adult, old;
    }

    public Foo(fooState i) {
        switch(i) {
        case young: ... break;
        case adult: ... break;
        case old: ... break;
        default: throw new InvalidStateException();
    }
    ...
} 
```

**编辑**：您就您的 3 个选项征求意见，这是我的：

1.  选项 1 在技术上与我的版本相同，但使用幻数（即没有指定名称的数字），这使得它更难理解（对于其他人和你未来的自己）
2.  选项 2 在创建对象和调用 set*Foo() 之间使类处于未定义甚至无效状态。如果您可以随时转换到 Young/Adult/Old，则可以选择在构造函数中将 Object 设置为例如 Young 状态，并让用户使用已经必要的功能来切换到另一个状态。如果这是一个不错的选择，则取决于具体情况，但它是一个有效的选择。
3.  选项 3 与选项 1 基本相同，只是速度较慢，因为它涉及字符串比较。如果您调用“new Foo(Foo.YOUNG)”，则代码更易于阅读，但您必须以这种方式编写它并不直观。此外，可以编写“new Foo("Alligator")”，这在最好的情况下会产生运行时错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T23:18:10.973

你真的不应该为 Young、Adult 和 Old 三个类，并且它们都可以实现一个通用接口或扩展一个抽象类以将它们联系在一起吗？

在创建所需子类的对象并将其返回的父抽象类中创建一个静态工厂方法？你为什么不想做三个班？它们将从父类的引用类型中引用，因此它们“看起来”像同一个类。

# jsf - 进度条的 Primefaces 动态标签

> ID：14531248
> 
> 赞同：7
> 
> 时间：2013-01-25T22:18:04.700
> 
> 标签：jsf, primefaces, progress-bar

嗨，我正在使用带有 Primefaces 的 JSF。我有一个很长的任务，在此期间我想向用户显示一个进度条，以进度（int）和状态（String）作为指示器。这两个参数映射到后端 bean 的两个字段。如果我使用`<p:poll>`，我可以同时更新两者，如以下代码所示：

```
<p:progressBar id="progress" ajax="false" value="#{backendBean.progress}" widgetVar="pbAjax"
  labelTemplate="{value}%: #{backendBean.statusMessage}" style="width:400px; font-size:12px"/>
<p:poll interval="1" id="poll" autoStart="false" update="progress" widgetVar="pbPoll"/> 
```

一旦用户按下按钮，`pbPoll.start()`. 这工作正常。现在我有两个问题：

(1) 最初是否可以隐藏进度条？我知道我可以将 display:none 放在 css 中，并在单击按钮时让它显示出来。但是投票更新会再次隐藏进度条。也许使用渲染。如果是这样，请告诉我如何。

(2) 由于 progressBar 本身具有 ajax 功能，我可以不使用 poll 吗？请注意，我在上面的代码中设置了 ajax=false。[在他们的网站上，它说添加了“动态进度标签”](http://blog.primefaces.org/?p=1765)。我试过但不知何故标签只显示`"{value}%"`没有状态消息。我想知道这是否是因为`#{statusMessage}`需要另一个提取，因此被忽略，而两者都是在民意调查中检索的。

**感谢！**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-27T06:51:37.063

1.  是的你可以。这真的很容易。将您包装`<p:progressBar/>`在一个面板中`<h:panelGrid/>`，并将进度条上的属性设置`rendered`为支持 bean 中的布尔值

    ```
     <h:panelGrid id="progressBarPanel">
                    <p:progressBar id="progress" interval="100"  rendered="#{backendBean.progressBarRendered}" ajax="true" value="#{backendBean.progressMonitor}" widgetVar="pbAjax" labelTemplate="{value}%: #{backendBean.progressMonitor}" style="width:300px; font-size:12px"/>
     </h:panelGrid> 
    ```

    然后使用按钮（或其他东西）来切换布尔值并更新**面板**

    ```
     <p:commandButton value="Test Progress Bar" action="#{addressUpdate.progressBarControl}" oncomplete="pbAjax.start();" update="progressBarPanel"/> 
    ```

    您需要注意的一件事是，切换进度条可见性的同一个按钮不应使用`onclick`事件，而是`oncomplete`启动进度条，原因是`onclick`在请求到达服务器之前触发，当时，进度条在 DOM 中不存在，因此`start()`将是未定义的。

2.  你是对的。如果您查看您的开发者控制台，您会看到以下关于进度条的 ajax 响应

    ```
     "thePanel:progress_value":20 
    ```

    这几乎总结了进度条在更新期间关心的内容，即进度条上的值绑定。如果这是您的必备品，请坚持使用您现在拥有的东西。

# java - 线程“主”StackoverFlow 错误中的异常

> ID：14531250
> 
> 赞同：3
> 
> 时间：2013-01-25T22:18:27.120
> 
> 标签：java, class

我正在编写一个程序来验证密码是否满足适当的要求。我已经编写了所有代码，我觉得它应该可以工作，但是我收到以下错误：

```
Exception in thread "main" java.lang.StackOverflowError
at java.lang.String.length(String.java:623)
at PasswordVerifier.isValid(PasswordVerifier.java:5)
at PasswordVerifier.isValid(PasswordVerifier.java:6) 
```

然后它会在很长一段时间内重复错误的最后一行。我一直在环顾四周，似乎无法弄清楚我的问题。我知道有些东西在不断循环，我不想这样做，但我无法解决这个问题。这是我的代码

```
 public class PasswordVerifier{
  private static int MIN_PASSWORD_LENGTH = 6;

  public static boolean isValid(String str){
     if (str.length() >= MIN_PASSWORD_LENGTH){
        if (PasswordVerifier.isValid(str) == true){
           if (PasswordVerifier.hasUpperCase(str) == true){
              if (PasswordVerifier.hasLowerCase(str) == true){
                 if (PasswordVerifier.hasDigit(str) == true){
                    return true;
                 }
              }
           }
        }
     }
        return false;
  }

  private static boolean hasUpperCase(String str){
     for (char c : str.toCharArray()){
        if (Character.isUpperCase(c)){
           return true;
        }
     }
     return false;
  }

  private static boolean hasLowerCase(String str){
     for (char c : str.toCharArray()){
        if (Character.isLowerCase(c)){
           return true;
        }
     }
     return false;
  }

  private static boolean hasDigit(String str){
     for (char c : str.toCharArray()){
        if (Character.isDigit(c)){
           return true;
        }
     }
     return false;
  }
 } 
```

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-25T22:20:15.643

```
public static boolean isValid(String str){
    // ...
        if (PasswordVerifier.isValid(str) == true){
        // ...
        }
    // ...
} 
```

您是`isValid(String)`从自身内部调用的，这会导致无限~~循环~~递归。

我将大胆猜测并说这就是您想要的：

```
public static boolean isValid(String str){
    if (str.length() >= MIN_PASSWORD_LENGTH){
        // Removed call to .isValid(String)
        if (PasswordVerifier.hasUpperCase(str)){
            if (PasswordVerifier.hasLowerCase(str)){
                if (PasswordVerifier.hasDigit(str)){
                    return true;
                }
            }
        }
    }
    return false;
} 
```

# java - 在切换案例中访问视图 ID 不适用于 Android 应用程序

> ID：14531255
> 
> 赞同：0
> 
> 时间：2013-01-25T22:18:45.463
> 
> 标签：java, android, switch-statement, android-view

请看一下这个简单的代码 -`clear.getId();`无论我在哪里声明`clear`按钮，我都无法使用开关内部。在我发布的代码中，它被声明在`onCreate`. 我知道我可以编写/硬编码 id 并且没问题，但我想以正确的方式编码。

代码：

```
public class AddProduct extends Activity implements OnClickListener {

    Button sendInfo, clear, cancel;
    EditText name, quantity;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_add_product);
        initializeVars();
    }

    @Override
    public void onClick(View v) {
        switch (v.getId()) {
            // *** --> case (clear.getid()) : break; // *** This doesnt work
            //  case  R.id.bClear : break;
        }
    }

    public void initializeVars() {
        sendInfo = (Button) findViewById(R.id.bAddProduct);
        clear = (Button) findViewById(R.id.bClear);
        cancel = (Button) findViewById(R.id.bCancel);
        name = (EditText) findViewById(R.id.etName);
        quantity = (EditText) findViewById(R.id.etEnterQuantity);
        sendInfo.setOnClickListener(this);
        clear.setOnClickListener(this);
        cancel.setOnClickListener(this);
    }
} 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T22:28:38.000

[`switch`](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/switch.html)在语句中需要类型`char`为 、`byte`或`short`或`int`枚举类型和字符串的常量 Java 基元。`case`可以自动装箱为基元（字符、字节、短整数和整数）的数值也可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T23:57:21.877

这有点混乱，但您可以扩展每个 View 类并添加一个公共 int 字段。初始化视图构造函数中的字段。

```
public class ButtonWithID extends Button {

    public final int id;

    public MyExtendedView(Context context){
        this(context, null);
    }

    public MyExtendedView(Context context, AttributeSet attrs){
        this(context, attrs, 0);
    }

    public MyExtendedView(Context context, AttributeSet attrs, int defaultStyle){
        super(context, attrs, defaultStyle);
        this.id = this.getId();
    } 
```

然后

```
case (clear.id) 
```

# excel - 在 Excel 中使用带日期（十进制数据）的 Mode 函数

> ID：14531257
> 
> 赞同：1
> 
> 时间：2013-01-25T22:19:07.367
> 
> 标签：excel

我在 Excel 中有一列日期，并且该列中总是只有两个日期。我想要一个公式来返回最存在的日期（所以如果 1/23/13 出现 24 次，1/24/13 出现 72 次，我希望公式返回 1/24/13）。

我在整个范围内使用了 MODE 公式，这连续几天有效，但今天它不起作用。经过进一步审查，我意识到 Excel 确实将日期视为十进制数字，我想这就是问题所在。

我可以通过插入一个新列并`=TRUNC(cell)`为该范围内的所有单元格填充它，然后将 MODE 公式应用于新列来获得我需要的内容，但我希望可能有一种方法可以在不引入的情况下做到这一点新列或公式。有可能做类似的事情`=MODE(TRUNC(range))`吗？那个特定的公式不起作用，但我希望有类似的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T22:47:02.817

是的，您建议的公式应该可以工作......但它是一个“数组公式”，这意味着您需要使用特定的组合键输入它。

将公式粘贴到单元格中，然后按 F2 键选择公式，然后按住 CTRL + SHIFT 键并按 ENTER。如果操作正确，则会在公式栏中的公式周围放置像 { 和 } 这样的花括号。

如果范围内有任何空白，则结果可能会偏斜

`=MODE(TRUNC(range))`

所以你可以把它改成

`=MODE(IF(range<>"",TRUNC(range)))`

# jquery - 小立方体的圆角图像

> ID：14531260
> 
> 赞同：0
> 
> 时间：2013-01-25T22:19:27.880
> 
> 标签：jquery, html, jquery-ui, css, lightbox

如何在小立方体圆角中显示图像....灯箱中的图像是圆角....实际图像在这里

[http://www.defie.co/designerImages/inventoryControl.png](http://www.defie.co/designerImages/inventoryControl.png)

[http://jsfiddle.net/ZrpLT/91/](http://jsfiddle.net/ZrpLT/91/)

在下面提供我的代码

```
 <script type="text/javascript">
        Gallery.setOptions({
            size:     150,
            lightbox: true,
            //animation:  'drop'
            //speed:      500,
            //closeOnEsc: true,
            //slideshow:  false,
            //slideshow_speed: 3000,
            //cube_speed: 1000
        });
    </script>
    <style>
        body {
            background: #AAAAAA;
        }
    </style>
</head>
<body>
        <div class="row">
            <div class="span10">
                <div class="melonhtml5_gallery">
                                <div data-caption="&lt;a style='margin-left: 92px; font-size: 18px;' href='http://www.w3schools.com/' &gt;Create&lt;/a&gt; &lt;div&gt; &lt;a style='margin-left: 92px; font-size: 18px;' &gt;View/Edit&lt;/a&gt; &lt;/div&gt; &lt;a style='margin-left: 92px; font-size: 18px;' &gt;Labels&lt;/a&gt;" data-image="http://www.defie.co/designerImages/inventoryControl.png"></div>

            </div>
        </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T07:33:11.140

如果我理解正确，您希望旋转立方体具有圆角，类似于图像但为 3D。

你可以给它*一种*圆角的感觉，但由于立方体旋转时背景中有图层，所以效果会失败。

```
div.melonhtml5_gallery div.cube div,
div.melonhtml5_gallery div.cube div img {
    border-radius: 10px;
} 
```

这是 CSS3 中准圆角的类似尝试：http: [//3dcube.pixelass.com/](http://3dcube.pixelass.com/)

CSS3 变换仅限于二维盒子上的矩阵变换，因此创建看起来像 3D 的对象通常是通过一些巧妙的技巧或幻觉来实现的。在这种情况下，当角落变圆时，这种错觉就会失败。要获得真正圆形的旋转立方体，我认为您必须使用 WebGL 之类的东西。

# sql - WHERE 子句中的 NHibernate 本机 SQL

> ID：14531265
> 
> 赞同：2
> 
> 时间：2013-01-25T22:19:59.267
> 
> 标签：sql, nhibernate, geospatial

我在 SQL Server 的表中有一个地理列，并且想过滤具有特定几何类型的行，例如几何类型为“点”的所有记录

SQL 查询看起来像

```
select * from GeometryTable g where g.Geography.STGeometryType() = 'Point' 
```

我怎样才能为此创建一个标准？该标准将与其他标准一起使用

```
criteria.Add(Restrictions.Add(<Geography.STGeometryType()>, some.Value) 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T06:31:31.243

使用此语法：

```
var criteria = session.CreateCriteria<Geometry>();
criteria.Add
(
  Expression.Sql(" {alias}.[Geography].STGeometryType() = ? "
  , "Point"                               // a place for your parameter
  , NHibernate.NHibernateUtil.String)
);
var list = criteria.List<Geometry>(); 
```

# jquery - jQuery Mobile：无法让 Mobiscroll 演示工作

> ID：14531266
> 
> 赞同：0
> 
> 时间：2013-01-25T22:20:03.710
> 
> 标签：jquery, css, jquery-mobile, mobiscroll, scrollwheel

我正在使用 Mobiscroll Select Scroller Demo 中的代码，但 Safari、Firefox 和 Chrome 浏览器中的结果是下拉列表，而不是滚轮选择器。我检查了现有的问题/答案无济于事。我添加了 jQuery 和 jQuery Mobile 脚本以及 css，但这并没有太大的区别。

```
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">

    <title>Mobiscroll - Select Scroller</title>

    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
<script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
<script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>

    <!--Includes-->
    <link href="css/mobiscroll.core-2.3.1.css" rel="stylesheet" type="text/css" />
    <link href="css/mobiscroll.ios-2.3.css" rel="stylesheet" type="text/css" />
    <script src="js/mobiscroll.select-2.3.1.js" type="text/javascript"></script>
    <script src="js/mobiscroll.core-2.3.1.js" type="text/javascript"></script>
    <script src="js/mobiscroll.ios-2.3.js" type="text/javascript"></script>

    <style type="text/css">
        body {
            font-family: arial, verdana, sans-serif;
            font-size: 12px;
        }

    </style>

    <script type="text/javascript">

      $(function(){
          $('#demo').mobiscroll().select({
              theme: 'ios',
              display: 'inline',
              mode: 'scroller',
              inputClass: 'i-txt',
              width: 200
          });
      });

</script>

</head>

<body>
    <select name="States" id="sel">
        <option value="0">AL Alabama</option>
        <option value="1">AK Alaska</option>
        <option value="2">AR Arkansas</option>
        <option value="3">AZ Arizona</option>
        <option value="4">CA California</option>
        <option value="5">CO Colorado</option>
        <option value="6">CT Connecticut</option>
        <option value="7">DE Delaware</option>
        <option value="8">FL Florida</option>
        <option value="9">GA Georgia</option>
        <option value="10">HI Hawaii</option>
        <option value="11">ID Idaho</option>
        <option value="12">IL Illinois</option>
        <option value="13">IN Indiana</option>
        <option value="14">IA Iowa</option>
    </select>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-26T09:36:07.760

## 解决方案

您的代码中几乎没有错误：

1.  **`mobiscroll.js`**需要初始化，没有它这个代码示例将无法工作。**`mobiscroll.js`**必须在和**之后** 初始化。**`jQuery`****`jQuery Mobile`**

2.  错误**`SELECT`**用于**`mobiscroll`**初始化：

    ```
    $('#demo').mobiscroll().select({ 
    ```

    它应该是：

    ```
    $('#sel').mobiscroll().select({ 
    ```

3.  **`jQuery Mobile`**不应用于**`$(function(){`**初始化附加代码。要了解有关此主题的更多信息以及如何通过页面事件解决它，请查看**[我](http://www.gajotres.net/document-onpageinit-vs-document-ready/)**的**`personal blog`**.

4.  **`DIV`**如果**`jQuery Mobile`**要在此示例中使用，内容必须在页面内。

## 例子

工作示例： **[jsFiddle](http://jsfiddle.net/Gajotres/dqT9m/)**

**HTML：**

```
 <!DOCTYPE html>
    <html>
    <head>
        <title>jQM Complex Demo</title>
        <meta name="viewport" content="width=device-width"/>
        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
        <link rel="stylesheet" href="http://www.fajrunt.org/css/mobiscroll-2.4.custom.min.css" />    
        <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
        <script src="http://www.fajrunt.org/js/mobiscroll-2.4.custom.min.js"></script>    
    </head>
    <body>
        <div data-role="page" id="index">
            <div data-theme="a" data-role="header">
                <h3>
                    First Page
                </h3>
                <a href="#second" class="ui-btn-right">Next</a>
            </div>

            <div data-role="content">
                <select name="States" id="sel">
                    <option value="0">AL Alabama</option>
                    <option value="1">AK Alaska</option>
                    <option value="2">AR Arkansas</option>
                    <option value="3">AZ Arizona</option>
                    <option value="4">CA California</option>
                    <option value="5">CO Colorado</option>
                    <option value="6">CT Connecticut</option>
                    <option value="7">DE Delaware</option>
                    <option value="8">FL Florida</option>
                    <option value="9">GA Georgia</option>
                    <option value="10">HI Hawaii</option>
                    <option value="11">ID Idaho</option>
                    <option value="12">IL Illinois</option>
                    <option value="13">IN Indiana</option>
                    <option value="14">IA Iowa</option>
                </select>
            </div>

            <div data-theme="a" data-role="footer" data-position="fixed">

            </div>
        </div>   
    </body>
    </html> 
```

**JS：**

```
 $(document).on('pagebeforeshow','#index',function(e,data){    
        $('#sel').mobiscroll().select({
            theme: 'ios',
            display: 'inline',
            mode: 'scroller',
            inputClass: 'i-txt',
            width: 200
        });  
    }); 
```

## 更多信息：

如果您想了解更多关于 jQuery Mobile 日期选择器的信息，请查看这篇**[文章](http://www.gajotres.net/10-life-saving-jquery-mobile-plugins/)**。

# c# - DateTimeZone 到/从数据库

> ID：14531271
> 
> 赞同：6
> 
> 时间：2013-01-25T22:20:34.787
> 
> 标签：c#, nodatime

我正在尝试使用 Jon Skeet（和其他人）的[Noda Time](https://code.google.com/p/noda-time/)框架。

如何存储**DateTimeZone**并从数据库中检索它。我认为**Id**属性值可能是要设置到数据库的值，但是由于 DateTimeZone 是一个抽象类，如何从 Id 创建一个 DateTimeZone ？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-25T22:23:43.420

存储 ID 很好，您可以使用相关[`IDateTimeZoneProvider`](http://noda-time.googlecode.com/hg-history/1.0.x/docs/api/html/T_NodaTime_IDateTimeZoneProvider.htm)及其[indexer](http://noda-time.googlecode.com/hg-history/1.0.x/docs/api/html/P_NodaTime_IDateTimeZoneProvider_Item.htm)取回它，通常通过[`DateTimeZoneProviders`](http://noda-time.googlecode.com/hg-history/1.0.x/docs/api/html/T_NodaTime_DateTimeZoneProviders.htm). 例如：

```
var london = DateTimeZoneProviders.Tzdb["Europe/London"]; 
```

当然，您确实需要知道您使用了哪个提供者——ID 仅有效地限定于提供者。

# parameters - reportviewer 参数列表格式不正确

> ID：14531272
> 
> 赞同：1
> 
> 时间：2013-01-25T22:20:35.013
> 
> 标签：parameters, webforms, reporting-services

在我的 webforms reportviewer 中，多下拉参数列表的文本显示在复选框下方，而不是值的右侧。

我的 ssrs rpt 显示右侧的值，但是当通过我的 webform 应用程序从服务器访问 ssrs rpt 时，它们出现在彼此下方。

如何设置文本显示在右侧而不是彼此下方的位置？

例子：

```
checkbox
AAA
checbox
BBB
checkbox
CCC

checkbox AAA
checkbox BBB
checkbox CCC 
```

我的 reportviewer 标记设置如下：rsweb:ReportViewer ID="ReportViewer1"

```
runat="server" Font-Names="Tahoma" 
    Font-Size="10pt" InteractiveDeviceInfos="(Collection)" ProcessingMode="Remote" 
    WaitMessageFont-Names="Tahoma" WaitMessageFont-Size="10pt" Height="667px" 
    Width="1241px" ShowFindControls="true" ShowExportControls="true" ShowPrintButton="true">
    <ServerReport ReportPath="/wms_reports/crewzfone_sales" 
        ReportServerUrl="http://ojuscluster01/reportserver" />
</rsweb:ReportViewer> 
```

我在网页上放置了以下覆盖样式，但似乎没有发生：

```
<style type="text/css">
    #ctl00_MainContent_Chart1_rptViewerCrewzFoneSales_ctl04_ctl03_divDropDown
    {
        text-align: left !important;
        overflow: visible;
    }
</style> 
```

页面源如下...您可以看到DIV标签上的下拉列表以及之后的表格数据。每个都是一个复选框（这很好），但就像我提到的那样，相关数据出现在每个复选框的顶部，而不是立即在复选框的右侧。

除了我在上面的页面中所做的之外，似乎根本没有任何方法可以通过任何属性来更改报告查看器的样式。如果有人遇到同样的问题并解决了它，我将非常感谢您的来信。

```
<div id="ctl00_MainContent_Chart1_rptViewerCrewzFoneSales_ctl04_ctl03_divDropDown" onclick="event.cancelBubble=true;" onactivate="event.cancelBubble=true;" style="display:inline-block;border-color:DarkGray;border-width:1px;border-style:Solid;font-family:Tahoma;font-size:8pt;height:150px;overflow:auto;background-color:window;display:none;position:absolute;z-index:11;">
                <table cellpadding="0" cellspacing="0" style="background-color:window;">
                    <tr>
                        <td nowrap="nowrap"><span style="font-family:Tahoma;font-size:8pt;"><input id="ctl00_MainContent_Chart1_rptViewerCrewzFoneSales_ctl04_ctl03_divDropDown_ctl00" type="checkbox" name="ctl00$MainContent$Chart1$rptViewerCrewzFoneSales$ctl04$ctl03$divDropDown$ctl00" onclick="$get(&#39;ctl00_MainContent_Chart1_rptViewerCrewzFoneSales_ctl04_ctl03&#39;).control.OnSelectAllClick(this);" /><label for="ctl00_MainContent_Chart1_rptViewerCrewzFoneSales_ctl04_ctl03_divDropDown_ctl00">(Select All)</label></span></td>
                    </tr><tr>
                        <td nowrap="nowrap"><span style="font-family:Tahoma;font-size:8pt;"><input id="ctl00_MainContent_Chart1_rptViewerCrewzFoneSales_ctl04_ctl03_divDropDown_ctl01" type="checkbox" name="ctl00$MainContent$Chart1$rptViewerCrewzFoneSales$ctl04$ctl03$divDropDown$ctl01" onclick="$get(&#39;ctl00_MainContent_Chart1_rptViewerCrewzFoneSales_ctl04_ctl03&#39;).control.OnValidValueClick(this, $get(&#39;ctl00_MainContent_Chart1_rptViewerCrewzFoneSales_ctl04_ctl03_divDropDown_ctl00&#39;));" /><label for="ctl00_MainContent_Chart1_rptViewerCrewzFoneSales_ctl04_ctl03_divDropDown_ctl01">AZM</label></span></td>
                    </tr><tr>
                        <td nowrap="nowrap"><span style="font-family:Tahoma;font-size:8pt;"><input id="ctl00_MainContent_Chart1_rptViewerCrewzFoneSales_ctl04_ctl03_divDropDown_ctl02" type="checkbox" name="ctl00$MainContent$Chart1$rptViewerCrewzFoneSales$ctl04$ctl03$divDropDown$ctl02" onclick="$get(&#39;ctl00_MainContent_Chart1_rptViewerCrewzFoneSales_ctl04_ctl03&#39;).control.OnValidValueClick(this, $get(&#39;ctl00_MainContent_Chart1_rptViewerCrewzFoneSales_ctl04_ctl03_divDropDown_ctl00&#39;));" /><label for="ctl00_MainContent_Chart1_rptViewerCrewzFoneSales_ctl04_ctl03_divDropDown_ctl02">CCL</label></span></td>
                    </tr><tr>
                        <td nowrap="nowrap"><span style="font-family:Tahoma;font-size:8pt;"><input id="ctl00_MainContent_Chart1_rptViewerCrewzFoneSales_ctl04_ctl03_divDropDown_ctl03" type="checkbox" name="ctl00$MainContent$Chart1$rptViewerCrewzFoneSales$ctl04$ctl03$divDropDown$ctl03" onclick="$get(&#39;ctl00_MainContent_Chart1_rptViewerCrewzFoneSales_ctl04_ctl03&#39;).control.OnValidValueClick(this, $get(&#39;ctl00_MainContent_Chart1_rptViewerCrewzFoneSales_ctl04_ctl03_divDropDown_ctl00&#39;));" /><label for="ctl00_MainContent_Chart1_rptViewerCrewzFoneSales_ctl04_ctl03_divDropDown_ctl03">CEL</label></span></td>
                    </tr><tr>
                        <td nowrap="nowrap"><span style="font-family:Tahoma;font-size:8pt;"><input id="ctl00_MainContent_Chart1_rptViewerCrewzFoneSales_ctl04_ctl03_divDropDown_ctl04" type="checkbox" name="ctl00$MainContent$Chart1$rptViewerCrewzFoneSales$ctl04$ctl03$divDropDown$ctl04" onclick="$get(&#39;ctl00_MainContent_Chart1_rptViewerCrewzFoneSales_ctl04_ctl03&#39;).control.OnValidValueClick(this, $get(&#39;ctl00_MainContent_Chart1_rptViewerCrewzFoneSales_ctl04_ctl03_divDropDown_ctl00&#39;));" /><label for="ctl00_MainContent_Chart1_rptViewerCrewzFoneSales_ctl04_ctl03_divDropDown_ctl04">CRY</label></span></td>
                    </tr><tr> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T07:19:35.103

我从来没有在 xml 源代码中玩过，但在报告中的参数框是自动设置和格式化的。

我不相信你会把这个弄出来。:( 我希望我错了，因为我希望能够格式化参数框。

有关详细信息，请参阅此[链接](http://technet.microsoft.com/en-us/library/dd220464.aspx "报告参数")。

# java - WSIT 配置文件加载次数过多

> ID：14531274
> 
> 赞同：0
> 
> 时间：2013-01-25T22:20:38.253
> 
> 标签：java, glassfish, wsit

我在**Glassfish (v3.0.1)**应用服务器上部署了一个 Web 服务。今天，许多访问者（大约 300-400 人）访问了我们的网页，不幸的是我们的服务器宕机了。我们正在努力找出问题并尽快解决。

我们使用 SoapUI 进行的负载测试是成功的，但我们不明白问题出在哪里。我们计划为数万用户提供服务，因此只有 30 万用户应该没有任何问题。当我检查服务器日志时，我看到**WSIT**配置文件被加载了很多次（数千次甚至更多次）。我猜，每次用户访问时，都会加载这个文件。每次都加载它是正常的（并在服务器日志中看到数千次消息）还是应该只加载一次？即使它应该只加载一次，它是否会给服务器带来如此大的负担，以至于没有人可以登录页面？

这是日志中的完整消息：

```
Loaded WSIT configuration from file: file:/home/appuser/glassfish-3.0.1/glassfish/domains/domain1/applications/uupf2onyuz/WEB-INF/classes/META-INF/wsit-client.xml. 
```

对于服务器故障的原因，我将不胜感激任何其他建议。

我正在尝试编辑 Glassfish 设置。我更改了 JVM 设置并添加了以下行：

> MaxPermSize=512m
> 
> Xmx35g
> 
> Xms32g
> 
> Dsun.net.client.defaultConnectTimeout=2
> 
> Dsun.net.client.defaultReadTimeout=10

另外，我已经更改了线程池设置，如下所示：

> 最大队列大小：4096
> 
> 最大线程池大小：4000
> 
> 最小线程池大小：64
> 
> 空闲线程超时：900

是否可以有这样的配置来处理许多同时线程，或者我应该使用不同的自定义。我正在尝试优化 Glassfish 以处理许多线程。

# concurrency - GPar 的数据并行性

> ID：14531276
> 
> 赞同：2
> 
> 时间：2013-01-25T22:20:48.810
> 
> 标签：concurrency, groovy, parallel-processing, gpars

我在这里找到了这个例子[数据并行](http://www.gpars.org/1.0.0/guide/guide/dataParallelism.html#dataParallelism_asynchronousInvocation)

```
GParsPool.withPool() {
    Closure longLastingCalculation = {calculate()}
    Closure fastCalculation = longLastingCalculation.async()
    Future result=fastCalculation()
    //do stuff while calculation performs …
    println result.get()
} 
```

我觉得它有点广泛。有没有办法缩短它？
也许：

```
GParsPool.withPool() {
    Future result = calculate().async()
    //do stuff while calculation performs …
    println result.get()
} 
```

那行得通吗？
如果没有，还有其他方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T23:58:48.910

认为您需要：

```
Future result = { calculate() }.async()() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-26T00:00:49.920

`calculate().async()`将立即启动`calculate`方法。我敢打赌

```
GParsPool.withPool() {
    Future result = {calculate()}.async().call()
    //do stuff while calculation performs …
    println result.get()
} 
```

因为`async()`返回一个闭包。我不确定是否`({calculate()}.async())()`有效，我稍后会测试

# javascript - 使用 jQuery 按字母顺序对列表项进行排序 - 然后按数字对特殊项进行排序

> ID：14531277
> 
> 赞同：1
> 
> 时间：2013-01-25T22:20:51.197
> 
> 标签：javascript, jquery

> **可能重复：**
> [如何使用 jQuery 按字母顺序对列表进行排序？](https://stackoverflow.com/questions/1134976/how-may-i-sort-a-list-alphabetically-using-jquery)

我正在使用 jQuery 来拯救有限的 CMS 设置。

我需要按字母顺序对有序列表进行排序，但随后我还需要能够将“特殊”列表项放在列表顶部，并再次仅对那些按“可选”数值降序的特殊项进行排序。

例如，如果这是我的原始标记：

```
<ul>
    <li class=" ">C</li>
    <li class=" ">A</li>
    <li class=" ">B</li>
    <li class=" ">E</li>
    <li class=" ">D</li>
    <li class="3">Z</li>
    <li class="6">Y</li>
    <li class="14">X</li>
</ul> 
```

...我希望 jQuery 对其进行排序，因此这将是生成的 DOM 内容：

```
<ul>
    <li class="14">X</li>
    <li class="6">Y</li>
    <li class="3">Z</li>
    <li class=" ">A</li>
    <li class=" ">B</li>
    <li class=" ">C</li>
    <li class=" ">D</li>
    <li class=" ">E</li>
</ul> 
```

如果无法按类值排序或过于复杂，也许我可以使用以下标记结构：

```
<ul>
    <li><span class="numerical">3</span><span class="alphabetical">B</span></li>
</ul> 
```

有谁知道什么 jQuery 代码可以让我这样做？我是否需要运行一系列嵌套的“每个”操作以及以某种方式比较值的“insertAfter”和“insertBefore”函数？我认为有更好的方法，但我不确定从哪里开始我的研究。

我愿意接受任何和所有建议。与此同时，我也会尝试自己解决这个问题，但我仍然是一个 jQuery 新手，所以我怀疑我是否会自己找到正确的代码:)

谢谢！！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T22:34:34.167

您需要一个比较器功能，以及一种重新排列元素的方法。插件是可用的，因为前者将为您做后者，尽管如果元素是单亲的唯一孩子，这很容易（见下文）。

对于你的比较器，你需要一些可以给你一对`<li>`元素的东西，并告诉你哪个先出现：

```
function myCompare(a, b) {
    var cls_a = parseInt(a.classList, 10);
    var cls_b = parseInt(b.classList, 10);

    cls_a = cls_a || -1 ;   // make blank class == -1
    cls_b = cls_b || -1 ;   //   ditto

    if (cls_a === cls_b) {
        var str_a = a.innerText || a.textContent;
        var str_b = b.innerText || b.textContent;
        return str_a.localeCompare(str_b);
    } else {
        return cls_a - cls_b;  // numeric descending sort
    }
} 
```

并重新排列：

```
var $el = $('li');
var $ul = $('ul');
$el.sort(myCompare);  // from above
$el.each(function() {
    $ul.append(this);
}); 
```

循环的`.each`工作方式是获取每个已排序的项目，并将其添加到`<ul>`- 的末尾，当没有剩余时，它就完成了。

上述的较短版本是可能的，例如：

```
$('li').sort(myCompare).appendTo($('ul')); 
```

[看到这个jsfiddle](http://jsfiddle.net/alnitak/hgchJ/)

# c# - C# 位图图像

> ID：14531281
> 
> 赞同：0
> 
> 时间：2013-01-25T22:21:10.747
> 
> 标签：c#

我用位图创建了一个图像：

```
Graphics GFX = CreateGraphics();
Bitmap bitmap = new Bitmap(@"C:\C#\slideplace.png");
GFX.DrawImage(bitmap, 319, 69, 149, 20); 
```

我有两个问题：

*   我怎样才能获得`GFX`位置，因为我想让它移动（如picturebox.location）。
*   这是鼠标悬停在图像上时的图像事件，单击并按住，就像一个图片框事件（mousedown 和 mouseup）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T22:23:42.283

`Graphics`并且`Bitmap`没有 UI 组件，因此它们没有`Location`属性。您需要使用一个`PictureBox`或一些其他 UI 控件来呈现您的位图

# javascript - 用确认框停止我的 while 循环

> ID：14531282
> 
> 赞同：0
> 
> 时间：2013-01-25T22:21:16.330
> 
> 标签：javascript, while-loop

这是我的代码。当用户从 window.confirm 框中选择“取消”时，我无法弄清楚如何停止此循环

我真的很生疏，从来没有深入研究过任何人的编程哈哈——我已经习惯了 C++，所以我不确定除了 window.confirm 之外是否还有更好的函数可以调用。

代码：

```
alert( "1 = 10, 2 = 20, 3 = 30, 4 = 40, 5 = 50" );

var myArray = [0, 10, 20, 30, 40, 50];
var askAgain = true;
var pickOne;
var pickTwo;
var answer;
var numOne;
var numTwo;

while (askAgain = true){

    numOne = prompt( "Select a number by entering the associated slot #:");
    numTwo = prompt( "Select a number to be added to the first number by            

        entering the associated slot #:" );

    pickOne = myArray[numOne];
    pickTwo = myArray[numTwo];

    pickOne.Number;
    pickTwo.Number;

    answer = pickOne + pickTwo;

    alert("You picked " + pickOne + " and " + pickTwo + ", combined they equal: "       

        + answer);

    window.confirm( "Would you like to go again?" );
    if (confirm == true){
        askAgain = true;
    } else {
        askAgain = false;
    }
} 
```

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-25T22:30:19.143

代码中的小错误：

```
while (askAgain = true){ 
```

应该：

```
while (askAgain == true){ 
```

= 赋值 == 检查它们是否相等

另一个问题是您需要像这样分配确认：

```
var confirm = window.confirm( "Would you like to go again?" ); 
```

# javascript - 用户登录时如何让登录部分消失？

> ID：14531296
> 
> 赞同：0
> 
> 时间：2013-01-25T22:22:27.843
> 
> 标签：javascript, html, css

我希望在我的用户登录后对他们隐藏“登录块”。仍然看到登录部分非常令人困惑。我的用户认为他们的登录实际上不起作用，他们已成功登录。我尝试将以下内容插入到我的 CSS 块中，但我需要一个条件以使其在用户未登录时可见。

```
display: none; 
```

这是我在本节的 HTML 代码：

```
 <DIV id="hp-content">
        <DIV id="hp-left-column">
            <DIV id="hp-sign-header">
            </DIV>
            <DIV id="hp-sign">
                <input type="textbox" class="ui-txt-general medium required" id="swsignin-txt-username" />
                <input type="password" class="ui-txt-general medium required" id="swsignin-txt-password" />
                <a title="Sign into my site." onclick="joelSignIn();" class="" id="swsignin-btn-submit"><img src="/cms/lib06/CA01000567/Centricity/Template/2/signin.png" alt="Sign In" /></a>
            </DIV> 
```

这是本节的 CSS 代码：

```
 #hp-sign-header{
        width: 288px;
        height: 27px;
        margin: 20px 0px 10px 0px;
        background: transparent url(/cms/lib06/CA01000567/Centricity/Template/2/sign-header.png) no-repeat scroll top center;
        }

    #hp-sign{
        width: 218px;
        height: auto;
        margin-left: 35px;
        }

    #swsignin-txt-username, #swsignin-txt-password {
        border: 1px solid #0C304E;
        color: #6994B9;
        font-family: "Trebuchet MS",Arial,Helvetica,sans-serif;
        font-weight: bold;
        font-size: 15px;
        line-height: 15px;
        height: 47px;
        margin: 0px 0px 10px 0px;
        padding: 0px;
        text-align: center;
        width: 221px;
        }

    #swsignin-txt-username {
        background: transparent url(/cms/lib06/CA01000567/Centricity/Template/2/username.png) no-repeat scroll top left;
        }

    #swsignin-txt-password {
        background: transparent url(/cms/lib06/CA01000567/Centricity/Template/2/password.png) no-repeat scroll top left;
        } 
```

这是本节的 JAVASCRIPT 代码：

```
 function joelSignIn(){
    var data = "{Username: '" + addslashes($('#swsignin-txt-username').val()) + "',Password: '" + addslashes($('#swsignin-txt-password').val()) + "'} ";
    var success = "window.location.reload()";
    var failure = "if (result[0].reason === 'TOU') { DisplayTOU(); } else { CallControllerFailure(result[0].errormessage); }";
    var callPath = "../site/SiteController.aspx/SignIn";
    CallController(callPath, data, success, failure);
    } 
```

所以我的问题是，我是否需要插入 HTML 代码、CSS 代码和/或 JAVASCRIPT 代码才能完成这项工作？我需要插入什么代码以及在哪里插入？我曾尝试研究和玩耍，但无济于事。任何建议将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T22:29:03.197

您不能单独使用 javascript 登录。Javascript 是一种[客户端](https://en.wikipedia.org/wiki/Client-side)语言，这意味着它只能在用户的计算机上运行。“登录”表明您的访问者有一些东西可以*登录*。这通常是在您用来托管网站的计算机上运行的数据库，通常称为服务器。这只能在[服务器端](https://en.wikipedia.org/wiki/Server-side)完成。

# c# - 包含附件的 SmtpClient.Send 是否会锁定附件？

> ID：14531297
> 
> 赞同：4
> 
> 时间：2013-01-25T22:22:34.360
> 
> 标签：c#, email, smtp, smtpclient

[我目前正在调试一个问题，但在MSDN 文档](http://msdn.microsoft.com/en-us/library/vstudio/system.net.mail.mailmessage.attachments%28v=vs.100%29.aspx)中找不到这个问题的答案

我有以下代码：

```
if(attachmentFileName != null && File.Exists(attachmentFileName))
{
    mail.Attachments.Add(new Attachment(attachmentFileName, MediaTypeNames.Application.Octet));
}

using(SmtpClient smtp = new SmtpClient { UseDefaultCredentials = true })
{
    try
    {
        smtp.Send(mail);
    }
    catch(SmtpException ex)
    {
        if(attachmentFileName != null && ex.StatusCode == SmtpStatusCode.ExceededStorageAllocation)
        {
            //Need to still send the mail. Just strip out the attachment & add footer saying that attachment has been stripped out.
            mail.Attachments.Clear();
            mail.Body += "\n\nNote: Please note that due to outbound size limitations, attachments to this email have been stripped out.\n";
            smtp.Send(mail);
        }
        else
        {
            throw;
        }
    }
} 
```

在更高级别（此方法的调用者），我有以下内容：

```
try
{
    SendEmail(recipients, alertTitle, body, alertID, subjectPrefix, merchantIDValue, attachmentFilePath);
}
finally
{
    if(tempFile != null)
    {
        File.Delete(tempFile);
    }
} 
```

我将代码部署到我们的测试环境中，现在我的错误日志中出现以下异常：

```
System.IO.IOException: The process cannot access the file 'C:\fileName.zip' because it is being used by another process.
   at System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
   at System.IO.File.Delete(String path)
   at AlertDelivery.CreateAttachmentFile(String attachmentData, String merchantID, String reportTitle) in d:\svn\trunk\Solution\Alerting\AlertDelivery.cs:line 143
   at AlertDelivery.TrySendAlert(String merchantID, String reportTitle, Int32 alertID, String alertTitle, String attachmentData, String attachmentFilePath, String body, Boolean isReport, String subjectPrefix, List`1 recipients) in d:\svn\trunk\Solution\Alerting\AlertDelivery.cs:line 110
   at AlertingService.ProcessAlertEvents(Object parameters) in d:\svn\trunk\Solution\Alerting\AlertingService.cs:line 174 
```

第 174`File.Delete(tempFile);`行是调用者代码中的行。

`SmtpClient.Send`SmtpClient 是否在调用后对附件保持异步锁定？还有什么明显的问题吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-25T22:26:59.930

尝试`mail`使用 using 语句封装
您的变量

```
public void SendEmail(...)
{
    using(MailMessage mail = new MailMessage())
    {

      .... your code above
    }

} 
```

这将强制对 MailMessage 对象进行 dispose 调用，并且该调用还会释放任何附件。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-25T22:24:49.130

确实如此，直到您处理掉 MailMessage 对象。

# ios - iOS (cs193p)：使用 MapViewController 中的委托以使用来自另一个控制器的不同线程获取图像的问题

> ID：14531299
> 
> 赞同：1
> 
> 时间：2013-01-25T22:22:44.723
> 
> 标签：ios, xcode, cs193p

我正在关注关于 iOS 5.0 开发的优秀 CS193P 讲座：http:
[//www.stanford.edu/class/cs193p/cgi-bin/drupal/](http://www.stanford.edu/class/cs193p/cgi-bin/drupal/)

我现在在分配#5，要求的任务#5b。当我单击地图上的注释时，我需要在其中显示带有缩略图的标注。

我设法用以下代码（使用 Flickr）毫无问题地做到了这一点。

MapViewController.h：

```
@class MapViewController;

@protocol MapViewControllerDelegate <NSObject>

- (UIImage *)mapViewController:(MapViewController *)sender imageForAnnotation:(id <MKAnnotation>)annotation;

@end

@interface MapViewController : UIViewController

@property (nonatomic, strong) NSArray *annotations; // of id <MKAnnotation>
@property (nonatomic, weak) id <MapViewControllerDelegate> delegate;

@end 
```

MapViewController.m：

```
- (void)mapView:(MKMapView *)mapView didSelectAnnotationView:(MKAnnotationView *)annotationView
{
    if ([annotationView.leftCalloutAccessoryView isKindOfClass:[UIImageView class]]) {
        UIImage *image = [self.delegate mapViewController:self imageForAnnotation:annotationView.annotation];
        [(UIImageView *)annotationView.leftCalloutAccessoryView setImage:image];
    }
} 
```

PhotoListTableViewController.m:

```
@interface PhotoListTableViewController() <MapViewControllerDelegate>

- (UIImage *)mapViewController:(MapViewController *)sender imageForAnnotation:(id <MKAnnotation>)annotation
{
    UIImage *image = nil;
    if ([annotation isKindOfClass:[FlickrAnnotation class]]) { // make sure the annotation is a FlickrAnnotation
        FlickrAnnotation *flickrAnnotation = (FlickrAnnotation *)annotation;
        NSURL *photoUrl = [FlickrFetcher urlForPhoto:flickrAnnotation.photo format:FlickrPhotoFormatSquare];
        image = [UIImage imageWithData:[NSData dataWithContentsOfURL:photoUrl]];
    }
    return image;
}

@end 
```

我在 MapViewController 的 mapView:didSelectAnnotationView: 方法中使用一个委托来从另一个控制器 PhotoListTableViewController 检索图像（以确保我有一个通用的 MapViewController）。

它工作正常......但我需要修改此代码以在另一个线程中调用 Flickr。所以我为此修改了 mapViewController:imageForAnnotation: 方法：

```
- (UIImage *)mapViewController:(MapViewController *)sender imageForAnnotation:(id <MKAnnotation>)annotation
{
    __block UIImage *image = nil;
    if ([annotation isKindOfClass:[FlickrAnnotation class]]) { // make sure the annotation is a FlickrAnnotation
        FlickrAnnotation *flickrAnnotation = (FlickrAnnotation *)annotation;
        dispatch_queue_t downloadQueue = dispatch_queue_create("ThumbnailDownloader", NULL);
        dispatch_async(downloadQueue, ^{
            NSURL *photoUrl = [FlickrFetcher urlForPhoto:flickrAnnotation.photo format:FlickrPhotoFormatSquare];
            dispatch_async(dispatch_get_main_queue(), ^{ // execute on the main thread
                image = [UIImage imageWithData:[NSData dataWithContentsOfURL:photoUrl]];
            });
        });
        dispatch_release(downloadQueue);
    }
    return image;
} 
```

但是，使用此代码时，不会显示缩略图。我知道这是因为当方法“返回图像”时，图像仍然为零导致 downloadQueue 线程尚未完成。我试图像这样在块内“返回图像”：

```
return [UIImage imageWithData:[NSData dataWithContentsOfURL:photoUrl]]; 
```

但编译器不喜欢这样：

> 将“UIImage *(^)(void)”传递给“disptach_block_t”类型参数的不兼容块指针类型（又名“void (^)(void)”）

我知道块开头的^{表示无效，但是可以将其更改为返回UIImage吗？还是我从一开始就做错了？

我只是不知道如何将 PhotoListTableViewController 中的图像返回给 MapViewController。这应该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T18:38:51.233

我正在做同样的任务。我在调用 tableview 控制器委托时切换了线程，而不是等到 table view 控制器获取图像，这对我有用。

在代码中：

-(void)mapView:(MKMapView *)mapView didSelectAnnotationView:(MKAnnotationView *)view { // NSLog(@"Annotation selected, getting thumbnail");

```
dispatch_queue_t downloadQueue = dispatch_queue_create("flickr download", NULL);
dispatch_async(downloadQueue, ^{
    UIImage *image = [self.delegate thumbNailImageForAnnotation:view.annotation sender: self];

    dispatch_async(dispatch_get_main_queue(), ^{

        [(UIImageView *)view.leftCalloutAccessoryView setImage:image];

    });

}); 
```

}

# javascript - 如何使这段代码与 IE7 兼容？

> ID：14531304
> 
> 赞同：0
> 
> 时间：2013-01-25T22:23:16.933
> 
> 标签：javascript, jquery

此代码适用于除旧版 IE 之外的所有浏览器。用户可以访问它，其中一些用户仍在使用 IE7。我不是编码员，作者要到下周才能找到，所以我不知道如何重构它，以便所有浏览器只显示`chk`.

```
 for (var x=1;x<5;x++){
      var st='select[name="Score_'+x+'e"] option';
      $(st).each(function(){
        var chk=',0,1,2,3,4,5,,,,,,--,';
        var sn=','+$.trim(this.innerHTML)+',';
        if (chk.indexOf(sn)==-1){$(this).hide();}
      });
      st='#tableScoringInfoBox'+x+' strong';
      $(st).html('1-10 Ratings explained');
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T22:29:03.150

一个快速的解决方法是简单地替换`.hide()`为`.remove()`，尽管如果不查看更多代码就无法知道这是否会影响其他内容。

# azure - 使用 azure 网站通过 webapi 上传文件

> ID：14531305
> 
> 赞同：1
> 
> 时间：2013-01-25T22:23:21.703
> 
> 标签：azure, asp.net-web-api

我正在尝试使用托管为 azure 网站的 webapi 上传文件。我收到 400 错误请求错误。

失败的请求跟踪告诉我，模块 ManagedPipelineHandler 给出 400 状态，通知为 128。

谷歌搜索表明这取决于文件大小限制。

已`MultipartFormDataStreamProvider`成功将文件保存到 azure 上的临时文件夹中，并且我知道代码“在我的机器上运行”，所以我怀疑这是一个配置问题（文件目前在一个 meg 下）

我已经尝试将`maxRequestLength`配置更改为相当高的值，但这并没有解决问题，而且我真的看不到 webapi 本身有任何改变。

任何建议都会很棒！

塔

罗斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T02:48:23.793

避免将文件上传到 Azure 网站的本地存储。而是将文件上传到集中式 Azure blob 存储。

# gradle - 如何在使用 gradle 时将 jar/war 依赖项添加到 ant 文件集？

> ID：14531306
> 
> 赞同：0
> 
> 时间：2013-01-25T22:23:23.837
> 
> 标签：gradle, enunciate

我有一个 gradle 配置，它执行我对战争的编译和打包。

我有一个 ant 脚本，我想在战后调用[enunciate.codehaus.org](http://enunciate.codehaus.org)。ant 脚本需要访问捆绑到战争中的罐子。

摇篮配置：

```
apply plugin: 'java'
apply plugin: 'eclipse'
apply plugin: 'war'

repositories {
    mavenCentral()
}

dependencies {
    compile "javax.ws.rs:jsr311-api:1.1.1"

    compile 'com.sun.jersey:jersey-server:1.16'
    compile 'com.sun.jersey:jersey-core:1.16'
    compile 'com.sun.jersey:jersey-client:1.16'
    compile 'com.sun.jersey:jersey-servlet:1.16'
    compile 'com.sun.jersey:jersey-json:1.16'

    testCompile "junit:junit-dep:4.10"
}

ant.importBuild 'ant-builds/enunciate/targets.xml' 
```

发音 ant 文件的一部分：

```
<path id="enunciate.classpath">
    <!--this pulls in enunciate library files to be used to generate documentation -->
    <fileset dir="${enunciate.home}/lib">
        <include name="*.jar"/>
    </fileset>

    <!-- this pulls in some java framework libraries used to generate documentation -->
    <fileset dir="${java.home}">
        <include name="lib/tools.jar"/>
    </fileset>
</path> 
```

如何将战争的依赖项添加到此文件集中？当 gradle 编译战争时，罐子（即依赖项然后打包到战争中）是否放在我可以参考的地方？

我认为它与使用依赖项或配置类有关，但似乎无法将它们结合在一起。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T23:57:50.783

例如，从 gradle build 中，您可以设置 ant 属性。可以在 gralde build 中设置以下目标中的 ant 类路径。

```
<enunciate basedir="${enunciate.baseSourceDirectory}" configFile="enunciate.xml">
<include name="**/*.java"/>
<classpath refid="enunciate.classpath"/>
<classpath>
    <pathelement path="${enunciate.dependencies}"/>
</classpath>
<export artifactId="docs" destination="${enunciate.destinationDirectory}/some-icd.tar"/> 
```

在 build.gradle 中，“enunciate.dependencies”可以设置为 ant.properties['enunciate.dependencies']=configurations.runtime.asPath

我希望这有帮助。

# sitecore - 如何在 Sitecore 中停止对引用项目的归档（计划）？

> ID：14531308
> 
> 赞同：1
> 
> 时间：2013-01-25T22:23:30.750
> 
> 标签：sitecore, sitecore6

当我手动归档一个被其他项目引用的项目时，Sitecore 弹出对话框，其中包含操作 - 如何处理链接。

如果项目配置为使用“设置归档日期”进行自动归档并且已归档，Sitecore 似乎默认选择了“离开链接”操作，因此指向归档项目的所有链接都将被破坏。

我如何/在哪里可以连接以停止归档其他项目引用的项目（计划归档）？我想停止存档并建立一些关系，说明存档不成功。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T11:50:23.470

为了防止 Sitecore 归档链接项目，您需要覆盖 2 个类。首先是**ArchiveItem**，因此它会在归档之前检查项目是否已链接：

```
namespace My.Assembly.And.Namespace
{
    public class MyArchiveItem : Sitecore.Tasks.ArchiveItem
    {
        public MyArchiveItem(System.DateTime taskDate) : base(taskDate)
        {
        }

        public override void Execute()
        {
            using (new Sitecore.SecurityModel.SecurityDisabler())
            {
                lock (SyncRoot)
                {
                    Sitecore.Data.Items.Item item = GetItem();
                    if (item != null && HasLink(Sitecore.Globals.LinkDatabase, item))
                    {
                        Sitecore.Diagnostics.Log.Error(string.Format(
                            "Item {0} or one of its descendants are linked from other items. "
                            + "Remove link before scheduling archive.", item.Paths.FullPath), this);
                        // uncomment next line if you don't want to retry archiving attempt
                        //Sitecore.Globals.TaskDatabase.Remove(this);
                        return;
                    }
                }
            }
            base.Execute();
        }

        private static bool HasLink(Sitecore.Links.LinkDatabase linkDatabase, Sitecore.Data.Items.Item item)
        {
            Sitecore.Links.ItemLink[] referrers = linkDatabase.GetReferrers(item);
            if (referrers.Length > 0)
            {
                if (referrers.Any(link => link.SourceFieldID != Sitecore.FieldIDs.Source))
                {
                    return true;
                }
            }
            foreach (Sitecore.Data.Items.Item item2 in item.Children)
            {
                if (HasLink(linkDatabase, item2))
                {
                    return true;
                }
            }
            return false;
        }
    }
} 
```

您需要覆盖的第二个类是**SqlServerTaskDatabase**，因此它会安排被覆盖的**MyArchiveItem**任务而不是原始的 Sitecore **ArchiveItem**：

```
namespace My.Assembly.And.Namespace
{
    public class MySqlServerTaskDatabase : Sitecore.Data.SqlServer.SqlServerTaskDatabase
    {
        public MySqlServerTaskDatabase(string connectionString) : base(connectionString)
        {
        }

        public override void UpdateItemTask(Sitecore.Tasks.Task task, bool insertIfNotFound)
        {
            Sitecore.Data.Sql.SqlBatch batch = new Sitecore.Data.Sql.SqlBatch(true);
            BindTaskData(task, batch);
            string sql = GetUpdateSql() + 
                " WHERE [ItemID] = @itemID AND [Database] = @databaseName AND [taskType] = @taskType";
            batch.AddSql(sql);
            if (insertIfNotFound)
            {
                AddInsertTask(batch, true);
            }
            batch.Execute(ConnectionString);
        }

        protected new virtual void BindTaskData(Sitecore.Tasks.Task task, 
            Sitecore.Data.Sql.SqlBatch batch)
        {
            System.DateTime taskDate = task.TaskDate;
            if (taskDate == System.DateTime.MinValue)
            {
                taskDate = (System.DateTime)System.Data.SqlTypes.SqlDateTime.MinValue;
            }
            batch.AddParameter("taskID", task.ID);
            batch.AddParameter("nextRun", taskDate);
            if (task is Sitecore.Tasks.ArchiveItem)
            {
                batch.AddParameter("taskType",
                    Sitecore.Reflection.ReflectionUtil.GetTypeString(typeof(MyArchiveItem)));
            }
            else
            {
                batch.AddParameter("taskType", ReflectionUtil.GetTypeString(task.GetType()));
            }
            batch.AddParameter("parameters", task.Parameters);
            batch.AddParameter("recurrence", task.RecurrencePattern);
            batch.AddParameter("itemID", task.ItemID);
            batch.AddParameter("databaseName", task.DatabaseName);
            if (string.IsNullOrEmpty(task.InstanceName))
            {
                batch.AddParameter("instanceName", System.DBNull.Value);
            }
            else
            {
                batch.AddParameter("instanceName", task.InstanceName);
            }
        }
    }
} 
```

您需要做的最后一件事是更新 Sitecore 配置以指向**MySqlServerTaskDatabase**：

```
<TaskDatabase type="My.Assembly.And.Namespace.MySqlServerTaskDatabase, My.Assembly">
    <param connectionStringName="core"/>
</TaskDatabase> 
```

有关归档尝试失败的信息将存储在日志文件中。您可能需要更新此部分以将其存储在您的自定义报告中。

* * *

*以下是您的原始问题所不需要的附加信息。*

您还可以在按如下所述设置计划之前进行挂钩，以通知用户该项目不会被存档。

首先创建将覆盖**ArchiveDateForm**类的类：

```
namespace My.Assembly.And.Namespace
{
    public class MyArchiveDateForm
        : Sitecore.Shell.Applications.Dialogs.ArchiveDate.ArchiveDateForm
    {
        protected override bool SetItemArchiveDate
            (Sitecore.Data.Items.Item item, string value)
        {
            if (HasLink(Sitecore.Globals.LinkDatabase, item))
            {
                Sitecore.Web.UI.Sheer.SheerResponse.Alert(
                    "Item or one of its descendants are linked from other items. "
                    + "Remove link before scheduling archive.", new string[0]);
                return false;
            }
            return base.SetItemArchiveDate(item, value);
        }

        private static bool HasLink(Sitecore.Links.LinkDatabase linkDatabase,
            Sitecore.Data.Items.Item item)
        {
            Sitecore.Links.ItemLink[] referrers = 
                linkDatabase.GetReferrers(item);
            if (referrers.Length > 0)
            {
                if (referrers.Any(
                    link => link.SourceFieldID != Sitecore.FieldIDs.Source))
                {
                    return true;
                }
            }
            foreach (Sitecore.Data.Items.Item item2 in item.Children)
            {
                if (HasLink(linkDatabase, item2))
                {
                    return true;
                }
            }
            return false;
        }

    }
} 
```

然后找到文件**/sitecore/shell/applications/dialogs/archive item/archive date.xml**。**将第 6 行**更改为指向新类：

```
<CodeBeside Type="My.Assembly.And.Namespace.MyArchiveDateForm,My.Assembly" /> 
```

就是这样。每当尝试安排对链接项目的归档时，Sitecore 都会显示该项目无法归档的信息。

# c# - 一点到这条曲线的最短距离

> ID：14531309
> 
> 赞同：6
> 
> 时间：2013-01-25T22:23:40.917
> 
> 标签：c#, geometry, linear-programming

我需要找到多个点到以下形式的曲线的距离：`f(x) = a^(k^(bx))`

我的第一个选择是使用它的导数，使用具有导数倒数的形式的线，给它坐标`Point`并与原始曲线相交。最后，我们用简单的几何图形计算点之间的距离。

这就是我通常遵循的数学过程。我需要节省时间（因为我正在做一个遗传算法程序）所以我需要一种有效的方法来做到这一点。想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T22:33:51.427

点 (c,d) 和曲线之间的距离是函数的最小值

```
sqrt((c-x)^2 + (d-a^(k^(bx)))^2) 
```

为了找到它的最小值，我们可以忘记`sqrt`并查看一阶导数。找出它是 0 的位置（它必须是最小距离，因为没有最大距离）。这为您提供了曲线上最近点的 x 坐标。要获得距离，您需要计算y坐标，然后计算到该点的距离（您可以在那个处计算距离函数`x`，这是同一回事）。

重复你的每个点。

不幸的是，距离函数的一阶导数是一种婊子。使用[Wolfram 的 derivator](http://library.wolfram.com/webMathematica/Education/WalkD.jsp)，结果是有*希望*的（如果我没有犯任何复制错误）：

```
dist(x)/dx = 2(b * lna * lnk * k^(bx) * a^(k^(bx)) * (a^(k^(bx)) - d) - c + x) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T22:38:15.787

要找到从点到曲线的距离，这不是一项简单的任务，因为您需要找到函数的全局，![在此处输入图像描述](../Images/b26fbabc79a0b04fa1e2fc04b3bc702d.png)其中 f(x) 是确定曲线的函数。

为此，您可以使用：
[Simplex method](http://en.wikipedia.org/wiki/Simplex_algorithm)
[Nelder_Mead_method](http://en.wikipedia.org/wiki/Nelder%E2%80%93Mead_method)
[gradient_descent](http://en.wikipedia.org/wiki/Gradient_descent)

此方法在[Solver Foundation](http://archive.msdn.microsoft.com/solverfoundation)、[NMath](http://www.centerspace.net/products/nmath/)等许多库中实现。

# php - 为框架实现语言翻译

> ID：14531321
> 
> 赞同：0
> 
> 时间：2013-01-25T22:24:14.033
> 
> 标签：php, codeigniter, codeigniter-2

我正在规划我的电子商务解决方案，现在最后一个问题是如何实现语言系统。

过去，我使用过 Magento、eCommerce 和 OpenCart 等电子商务解决方案，但我想避免使用他们的方法，因为它很糟糕，最终会减慢整个应用程序的速度。

以 Magento 为例，它将语言文件保存在单独的文件夹中，然后代码从该文件夹中的文件加载语言。语言文件有超过 10k 行，并且对于不同的模块，许多单词和句子会重复，并且必须在每次加载时读取文件。

我有一个 HMVC 架构，并且正在考虑扩展作为解决方案一部分的每个模块都有自己的语言文件，但是这是 Magentos 方法，它不是最好的解决方案。

我希望我的语言文件系统尽可能简单，并在其中保留按钮名称和标签名称，并允许任何想要翻译它的人轻松完成。因为我有一个 HMVC 架构，所以我想扩展它并使每个模块都有自己的语言文件/类，这样你只需要翻译那些你实际使用的模块，而不是应用程序来一次加载所有翻译甚至对于未显示的模块。

但我觉得保持这样的翻译可能会在性能和简单性方面出现问题。我确实查看了 GoogleTranslate 插件选项，虽然它相当不错，但我认为它还没有准备好，也没有合适的解决方案。

这里最好的方法是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T22:44:20.183

如果您的 HMVC 架构使用某种 PHP 框架，它可能具有处理翻译问题的 API。例如，在 CodeIgniter 中你可以使用[Language Class](http://ellislab.com/codeigniter/user-guide/libraries/language.html)，在 CakePHP 中你可以使用[i18n class](http://api21.cakephp.org/class/i18n)。

请注意，CodeIgniter 目前使用纯 PHP 文件来加载语言，因此它可能不如 CakePHP 高效（可以从 .po/.mo 文件或数据库加载文件）。

如果您当前没有使用，可以尝试 Zend Framework 的[翻译模块](http://framework.zend.com/manual/2.0/en/modules/zend.i18n.translating.html)。请注意，您不需要使用所有 Zend 框架（因为它也是高度模块化的）。如果您仍然不希望它弄乱您的项目空间，您可以使用普通的[gettext()](http://es2.php.net/manual/es/function.gettext.php)。

# ios - 更新 UIImageView 会导致内存泄漏

> ID：14531322
> 
> 赞同：0
> 
> 时间：2013-01-25T22:24:26.807
> 
> 标签：ios, xcode, uiimage, imageview

我研究了数百个帖子，但仍然无法弄清楚我的问题出在哪里。我有一组图像名称，我正在尝试随机选择图像并更新事件的图像视图。在我的设备上运行时，它会在 12-15 张图像后崩溃。

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    self.predictionArray = [[NSArray alloc]  initWithObjects:@"IMG_0006.JPG",
                        @"IMG_0007.JPG",
                        @"IMG_0008.JPG",
                        @"IMG_0034.jpg",
                        @"IMG_0036.jpg",
                        @"IMG_0043.jpg",
                        @"IMG_0062.JPG",
                        @"IMG_0069.JPG",
                        @"IMG_0076.jpg",
                        @"IMG_0093.jpg",
                        @"IMG_0096.jpg",
                        @"IMG_0168.jpg",
                        @"IMG_0240.jpg",
                        @"IMG_0251.jpg",
                        @"IMG_0262.jpg",
                        @"IMG_0264.jpg",
                        @"IMG_0310.jpg",
                        @"IMG_0351.jpg",
                        @"IMG_0355.jpg",
                        @"IMG_0391.jpg",
                        @"IMG_0404.jpg",
                        @"IMG_0417.jpg",
                        @"IMG_0428.jpg",
                        @"IMG_0461.jpg",
                        @"IMG_0471.jpg",
                        @"IMG_0485.jpg",
                        @"IMG_0492.jpg",
                        @"IMG_0550.jpg",
                        @"IMG_0568.jpg",
                        @"IMG_0822.jpg", nil];

    [self makePrediction];
}

- (void) makePrediction {
    NSUInteger index = arc4random_uniform(self.predictionArray.count);

    [self.pageImage setImage:[UIImage imageNamed:[self.predictionArray objectAtIndex:index ]]];

}

-(void) touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event {
    [self makePrediction];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T06:57:20.650

您正在使用**imageNamed:**方法来设置 imageview 的图像。但问题是**imageNamed:**方法具有自己的缓存机制，您无法对其进行任何控制。因此，我们不知道何时何地释放分配的内存.所以不要使用**imageNamed:**方法，而是使用以下方法来设置图像。

```
NSString* imgpath= [ [ NSBundle mainBundle] pathForResource:@"sample" ofType:@"png"];

imgviw.image = [ UIImage imageWithContentsOfFile: imgPath]; 
```

使用**imageWithContentsOfFile:**方法的主要优点是该方法不会缓存图像，因此不会导致保留大图像时出现任何内存问题。此外，在将图像应用到 imageview 之前，您可以设置`imgviw.image = nil`& 然后设置图像以避免内存泄漏问题

# python - 基于表达式的django表格单元格颜色

> ID：14531332
> 
> 赞同：2
> 
> 时间：2013-01-25T22:24:55.433
> 
> 标签：python, django

python 2.6，在 Redhat 6.3 上使用 Django 1.3.1

在 Django 中，我将如何根据其值更改表格单元格的背景颜色，例如超过 10 为红色，7 到 9 之间为橙色，低于 7 为绿色等。

数据来自非 Django 数据库/模型。

我正在使用标准模板来迭代表，但为此使用自定义模板没有问题。

我看到以下内容

[关联](https://stackoverflow.com/questions/2834618/set-background-color-for-a-field-depending-on-its-value)

它处理更改单元格颜色，但它似乎基于单元格中的具体值，而不是在一个范围内。

使用以下测试代码查看

```
def dashboard(request):
  if request.user.is_authenticated():
      user = request.user.first_name
  else:
      return redirect('/bcpm/login')

  table_headers = ['Colmun1','Column2','Column3']
  table_data = [['test1',2,3],['test2',2,4],['test3',5,5]]
  page_title = 'Dashboard'

  template_dict = {'header_list':table_headers, 'page_title':page_title,
                         'results':table_data,'username':user}
  return render_to_response('dashboard.html',template_dict)enter code here 
```

和以下通用表格模板：

```
<table border=1 width=98% style="margin-left:12px;">
        <tr>
            {% for item in header_list %}
            <th>{{ item }}</th>
            {% endfor %}
        </tr>

            {% for row in results %}
            <tr>
                {% for line in row %}
                <td>{{line}}</td>
                {% endfor %}
            </tr>
            {% endfor %}

    </table> 
```

谢谢。

* * *

几乎解决了；

在下面的 brianbuck 的帮助下，我想出了以下观点：

```
def dashboard(request):
    if request.user.is_authenticated():
        user = request.user.first_name
    else:
       return redirect('/login'

    table_headers = ['Column1','Column2','Column3']
    table_data = [['name','thing',8],['name','thing',5]]
    page_title = 'Dashboard'

    template_dict = {'header_list':table_headers, 'page_title':page_title,
                         'results':table_data,'username':user}
    return render_to_response('dashboard.html',template_dict) 
```

在模板中；

```
<table border=1 width=68% style="margin-left:12px;">
        <tr>
            {% for item in header_list %}
            <th>{{ item }}</th>
            {% endfor %}
        </tr>

            {% for element in results %}
          <tr>
            <td> {{ element.0 }} </td>
            <td> {{ element.1 }} </td>
            {% if element.3 > 7 %} <td class="red"> {{ element.3 }} </td> 
            {% else %} <td class="green"> {{ element.3 }} </td> {% endif %}
          </tr>
            {% endfor %}

    </table>
{% endif %} 
```

当我尝试将其设置为执行时，我真的无法让它执行 {% if 或 %}

“大于或等于 7 或小于或等于 8”

对于大于 7 的数字，它总是会计算为这个表达式，即使第一个 if 语句对于大于 9 的任何东西都应该为真。

我正在使用 Django 1.3，我认为 if/else 和多重评估可能存在一些限制，无论哪种方式，我都有 80% 使用红色/绿色两个值，目前这已经足够了。

谢谢你们。

* * *

让它像这样工作；

```
{% for element in results %}
            <tr>
            <td> {{ element.0 }} </td>
            <td> {{ element.1 }} </td>
            <td> {{ element.2 }} </td>
            <td> {{ element.3 }} </td>
            {% if element.4 > 8 %} <td class="red"> {{ element.4 }} </td>
            {% else %}{% if element.4 > 8 or element.4 >= 5 %} <td class="orange"> {{ element.4 }} </td>
            {%else %}{% if element.4 < 5 %}<td class="green"> {{ element.4 }} </td>
            {% endif %}{% endif %}{% endif %}

            <td> {{ element.5 }} </td> 
```

如果您有支持 elif 的 Django 版本，或者您添加了一些可用于扩展 django 安装的 django 片段，则不需要这样做。

欢呼。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T22:30:25.777

这假设您有三个名为：

```
td.red {
    backgroundColor: red;
}
td.orange {
    backgroundColor: orange;
}
td.green {
    backgroundColor: green;
} 
```

...

Django 1.3 没有，`elif`所以你可能不得不做的更笨重一些。

```
<td class="
    {% if val >= 10 %}red{% endif %}
    {% if val >= 7 or val <= 9 %}orange{% endif %}
    {% if val < 7 %}green{% endif %}">
    {{ val }}
</td> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-11-03T02:15:26.303

我只想在 admin.py 中执行此操作。

*   假设您的专栏被称为`col`：
*   如果列的值大于 0，则您希望将列设置为绿色，如果相反，则将其设置为红色。

```
def TableAdmin(admin.ModelAdmin)
    def col_(self, obj):
        green_style = "<script>document.querySelectorAll('.green_table_elem').forEach(elem => { elem.parentElement.style.background = 'green'; })</script>"
        red_style = "<script>document.querySelectorAll('.red_table_elem').forEach(elem => { elem.parentElement.style.background = 'red'; })</script>"

        if obj.col > 0:
            return mark_safe(f'<div class="green_table_elem">{obj.col}</div> {green_style}')
        else:
            return mark_safe(f'<div class="red_table_elem">{obj.col}</div> {red_style}')

    list_display = ('col_',) 
```

这会为`td`（列）本身着色，而不是像某些答案那样为添加的 div 着色。

# mysql - mysql 中的任何命令都相当于 Oracle 的 autotrace 用于性能转向

> ID：14531333
> 
> 赞同：2
> 
> 时间：2013-01-25T22:24:56.027
> 
> 标签：mysql, performance

在 oracle sql plus 中，在做性能测试时，我会做

```
set autotrace traceonly: 
```

这将显示查询计划和统计信息而不打印实际结果。mysql中有什么等价的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T00:24:51.423

不，在 MySQL 中没有可用的等价物，至少在社区版中没有。

MySQL 没有实现 Oracle 在其代码中的那种“工具”；所以没有等同于事件 10046 的跟踪。

您可以在 SELECT 语句前加上`EXPLAIN`关键字，这将产生输出，其中包含有关 MySQL 将用于运行该语句的执行计划的信息，但这只是一个估计，而不是对实际执行的监控。

您还可以在服务器上启用慢查询日志，以捕获执行时间超过`long_query_time`几秒的 SQL 语句，但这实际上只识别长时间运行的查询。这将为您提供 SQL 文本，以及经过的时间和检查的行数。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-25T22:47:08.420

要获取查询计划，只需添加`EXPLAIN`到`SELECT`查询的开头。

```
EXPLAIN SELECT * FROM table 
```

如果这就是您所说的统计信息，它还会估计要读取的行数。

# javascript - Infinity-Scroll [Wordpress, Origin Theme, Shadowbox 插件]

> ID：14531334
> 
> 赞同：0
> 
> 时间：2013-01-25T22:25:03.690
> 
> 标签：javascript, jquery, wordpress, infinite-scroll, shadowbox

我从来没有做过Javascript，

在网站上，我在帖子中添加了 rel="shadowbox" 以拉出帖子的灯箱。该模板内置了无限滚动，我已经看到您必须使用回调来使 shadowbox 在新帖子上工作。问题是我在哪里放置代码以及如何放置？

例子：

```
$("#container").on("focusin", function(){ $("a.ajaxFancyBox").fancybox({ // fancybox API options here 'padding': 0 }); // fancybox }); // on 
```

我是否将其放在脚本标签的头部？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T01:02:04.710

如果您愿意，可以将它包含在您网站的头部......这样的事情可能对您有用：

```
<script>
$(function(){

    $("#container").on("focusin", function(){ $("a.ajaxFancyBox").fancybox({ 
         // fancybox API options here 'padding': 0 
        }); // fancybox 
    }); 

});
</script> 
```

如果您不是程序员，并且想要一个一流的模态插件（灯箱），我建议您查看 Easy Fancybox。它工作并且看起来很棒。 [http://wordpress.org/extend/plugins/easy-fancybox/](http://wordpress.org/extend/plugins/easy-fancybox/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T11:13:08.900

从头开始，完全取出 Shadowbox 和 Easy FancyBox。

用过的 Wordpress 内置于Thickbox

上面添加的帖子

```
<?php add_thickbox(); ?> 
```

添加一个类

```
class="thickbox" 
```

在链接末尾添加，因为它是 iframe

```
?KeepThis=true&TB_iframe=true&height=400&width=600 
```

我认为它是自己的回调（我找不到是否放入）如果是这样，请将以下内容添加到 header.php

```
<script> tb_init( $('a.thickbox, area.thickbox, input.thickbox',this) );</script> 
```

就像我说的，我认为它不需要它。

不过感谢您的帮助。

# ruby - 根据文件中的不同部分从独特的逻辑制作 ruby 哈希

> ID：14531337
> 
> 赞同：1
> 
> 时间：2013-01-25T22:25:15.200
> 
> 标签：ruby, file, parsing, hash

我有一个大文件，其中的“部分”由`***`. 我必须为每个部分创建一个散列和一个新文件，其中每个部分都以新格式写入（我可能为部分编写多个文件）。每个部分都需要独特的逻辑来转换为哈希（由“”或“\n”或“=”或“/某些模式/”分割）。
我正在寻找一种方法来识别部分并应用适当的逻辑将部分转换为哈希。我可以编写单独的逻辑片段，但它们是基于模式调用的单独方法或类吗？

由于文件很大，我试图逐行读取、操作和写入。我已经看到了在部分之间使用全局线的方法，但并不特别关心这种类型的解决方案。我对如何在部分之间抓取线条并在适当的时候逐行应用不同的逻辑有点困惑。

任何方向表示赞赏。谢谢！

这是一些输入文件：

```
 *** Summary ***

 Job Name = test   Date created: Mon Jan 14 15:48:33 2013

 *** Analysis Information 
 Steady State is ON
 Turbulent Incompressible Flow is ON 
 Static Temperature Equation is ON
 Mixed Convection is ON

 *** Field Variable Results Summary For Iteration 300

  Var      Mean          at      Max          at      Min
 Vx Vel  +5.71519e+002 1320103 +3.02718e+004 1319857 -2.66582e+004 mm/s
 Vy Vel  +3.40035e+002 158922 +2.79257e+004 1319731 -1.42855e+004 mm/s
 Vz Vel  -7.17959e+002 1318038 +1.62986e+004 1319053 -2.21582e+004 mm/s
 Press  -2.05980e+001  50858 +5.19412e+003  50905 -1.44865e+003 N/m^2
 Temp  +4.60000e+001  10965 +4.60000e+001 315867 +4.60000e+001 C
 TurbK  +1.19616e+006 1319490 +1.44421e+008  10966 +1.81700e-008 mm^2/s^2
 TurbD  +1.71412e+009 1319490 +2.88554e+011 233065 +5.37798e-004 mm^2/s^3
 Scal1  +0.00000e+000  10965 +0.00000e+000 315867 +0.00000e+000  
 PTotl  -5.91285e+000  50858 +5.19412e+003  50905 -1.44865e+003 N/m^2
 EVisc  +2.52037e-004 1320370 +1.14488e-002   2229 +0.00000e+000 g/mm-s
 ECond  +1.05355e-002 1352833 +5.88890e-002   2229 +0.00000e+000 W/mm-K
 Dens  +2.34793e-004  58024 +3.43080e-003 315867 +1.20473e-006 g/mm^3
 Visc  +1.62605e-005  10965 +1.81700e-005   2229 +0.00000e+000 g/mm-s
 Cond  +2.50840e-002   2229 +2.04000e-001 315867 +2.56300e-005 W/mm-K
 SpecH  +1.01202e+000  38432 +1.81000e+000  10249 +1.00500e-003 J/g-K
 Emiss  +8.94911e-001  10965 +1.00000e+000   2229 +0.00000e+000  
 Transmiss  +0.00000e+000      0 +0.00000e+000      0 +0.00000e+000  
 WRough  +0.00000e+000  10965 +0.00000e+000 315867 +0.00000e+000 mm
 SeeBeck  +0.00000e+000      0 +0.00000e+000      0 +0.00000e+000 V/K
 GenT  +1.11977e+003 223286 +1.18027e+005 584515 +3.19558e-013 1/s

*** Openings ***

         *** Outlet 1 ***

  Surface ID = 2329

  Node near Minimum X,Y,Z of opening = 11761

  Minimum X,Y,Z of opening = 369.964000, 11.275438, -98.433898

     Mass Flow Out            = -1.55703 g/s
  Volume Flow Out            = -1.29242e+006 mm^3/s
     Reynolds Number         = 1303.45
     Outlet Bulk Pressure    = -0 N/m^2
     Outlet Bulk Temperature = 46 C
     Outlet Mach Number      = 0.00734951

         *** Outlet 2 ***

  Surface ID = 2332

  Node near Minimum X,Y,Z of opening = 11125

  Minimum X,Y,Z of opening = 369.964000, 73.727289, -114.615876

     Mass Flow Out            = -20.4612 g/s
  Volume Flow Out            = -1.6984e+007 mm^3/s
     Reynolds Number         = 11182.5
     Outlet Bulk Pressure    = -0 N/m^2
     Outlet Bulk Temperature = 46 C
     Outlet Mach Number      = 0.0079087

         *** Outlet 3 ***

  Surface ID = 2335

  Node near Minimum X,Y,Z of opening = 10924

  Minimum X,Y,Z of opening = 369.964000, 164.751344, 40.640056

     Mass Flow Out            = -32.8714 g/s
  Volume Flow Out            = -2.72852e+007 mm^3/s
     Reynolds Number         = 17965
     Outlet Bulk Pressure    = -0 N/m^2
     Outlet Bulk Temperature = 46 C
     Outlet Mach Number      = 0.00750077

*** Fluid Energy Balance Information:
  MdotIn x Cp x (TOut - TIn) =       663.69 Watts
 (Numerical) Energy Out  -  Energy In =      0.36447 Watts
     Heat Transfer from Wall To Fluid =       761.35 Watts
Heat Transfer Due to Sources In Fluid =            0 Watts

*** Solid Energy Balance Information:
 Heat Transfer from Exterior To Solid =            0 Watts
Heat Transfer Due to Sources In Solid =          761 Watts
    Heat Transfer From Fluid To Solid =      -761.31 Watts

*** Sum of Fluid Forces on Walls ***
   ShearX, PressX =        68651         78199   microNewtons
   ShearY, PressY =        39030   6.9349e+006   microNewtons
   ShearZ, PressZ =       -19749  -4.1017e+006   microNewtons

*** Data for internal fans 

Fan Part Id = 16 Fan Name = fname1
Operating Pressure Rise = 0.46945 Inches of Water
Operating FlowRate = 36.0109 CFM

Fan Part Id = 94 Fan Name = fname2
Operating Pressure Rise = 0.309645 Inches of Water
Operating FlowRate = 2.33407 CFM

Fan Part Id = 95 Fan Name = fname3
Operating Pressure Rise = 0.267133 Inches of Water
Operating FlowRate = 8.78264 CFM

*** Analysis Statistics: 

 Input:              461 seconds 
 Analysis:         12686 seconds 
 Output:             179 seconds 
 Total:            13326 seconds 
```

到目前为止，这是我所拥有的：

```
sum_file = File.new('sum_file.sum', 'r')
sum_file_hashed = File.new('sum_file_hashed', 'w')

inSection = false #flag when in or out of a section?

    while (line = sum_file.gets ) #while reading lines
        case line
        when /\*{3}/ #Found Sections by ***
            inSection = true #in a section
            l = line.gsub('*', '').strip
            sum_file_hashed.puts('Found a section: ' + l ) #write section name
        end

        ### I'm not sure how to introduce specific logic when in a certain type of section ###

    end

sum_file.close
sum_file_hashed.close 
```

我现在正在尝试类似的东西：

```
while /found section/
  if /match pattern a/
    call parsera
  if /match pattern b/
    call parserb
end

parsera 
while =! /a section/
do stuff
return? 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T05:19:04.550

Ruby 的 Enumerable contains[`slice_before`](http://ruby-doc.org/core-1.9.3/Enumerable.html#method-i-slice_before)非常适合这种任务，它根据某些标记将文件分解为块。

```
require 'pp'

blocks = DATA.readlines.map(&:strip).reject{ |l| l == '' }.slice_before(/\A\*{3}/)
pp blocks.to_a

__END__
  *** Summary ***

 Job Name = test   Date created: Mon Jan 14 15:48:33 2013

 *** Analysis Information 
 Steady State is ON
 Turbulent Incompressible Flow is ON 
 Static Temperature Equation is ON
 Mixed Convection is ON

 *** Field Variable Results Summary For Iteration 300

  Var      Mean          at      Max          at      Min
 Vx Vel  +5.71519e+002 1320103 +3.02718e+004 1319857 -2.66582e+004 mm/s
 Vy Vel  +3.40035e+002 158922 +2.79257e+004 1319731 -1.42855e+004 mm/s
 Vz Vel  -7.17959e+002 1318038 +1.62986e+004 1319053 -2.21582e+004 mm/s
 Press  -2.05980e+001  50858 +5.19412e+003  50905 -1.44865e+003 N/m^2
 Temp  +4.60000e+001  10965 +4.60000e+001 315867 +4.60000e+001 C
 TurbK  +1.19616e+006 1319490 +1.44421e+008  10966 +1.81700e-008 mm^2/s^2
 TurbD  +1.71412e+009 1319490 +2.88554e+011 233065 +5.37798e-004 mm^2/s^3
 Scal1  +0.00000e+000  10965 +0.00000e+000 315867 +0.00000e+000  
 PTotl  -5.91285e+000  50858 +5.19412e+003  50905 -1.44865e+003 N/m^2
 EVisc  +2.52037e-004 1320370 +1.14488e-002   2229 +0.00000e+000 g/mm-s
 ECond  +1.05355e-002 1352833 +5.88890e-002   2229 +0.00000e+000 W/mm-K
 Dens  +2.34793e-004  58024 +3.43080e-003 315867 +1.20473e-006 g/mm^3
 Visc  +1.62605e-005  10965 +1.81700e-005   2229 +0.00000e+000 g/mm-s
 Cond  +2.50840e-002   2229 +2.04000e-001 315867 +2.56300e-005 W/mm-K
 SpecH  +1.01202e+000  38432 +1.81000e+000  10249 +1.00500e-003 J/g-K
 Emiss  +8.94911e-001  10965 +1.00000e+000   2229 +0.00000e+000  
 Transmiss  +0.00000e+000      0 +0.00000e+000      0 +0.00000e+000  
 WRough  +0.00000e+000  10965 +0.00000e+000 315867 +0.00000e+000 mm
 SeeBeck  +0.00000e+000      0 +0.00000e+000      0 +0.00000e+000 V/K
 GenT  +1.11977e+003 223286 +1.18027e+005 584515 +3.19558e-013 1/s 
```

我缩短了数据，因为样本太多了。

运行代码输出：

```
[[“*** 概括 ***”，
  "职位名称 = 测试创建日期：2013 年 1 月 14 日星期一 15:48:33"],
 ["***分析信息",
  “稳态开启”，
  “湍流不可压缩流开启”，
  “静态温度方程为 ON”，
  "混合对流开启"],
 ["*** 迭代 300 的字段变量结果摘要",
  “最小值处最大值处的方差均值”，
  “Vx 速度 +5.71519e+002 1320103 +3.02718e+004 1319857 -2.66582e+004 毫米/秒”，
  "Vy Vel +3.40035e+002 158922 +2.79257e+004 1319731 -1.42855e+004 mm/s",
  “Vz 速度 -7.17959e+002 1318038 +1.62986e+004 1319053 -2.21582e+004 毫米/秒”，
  "按-2.05980e+001 50858 +5.19412e+003 50905 -1.44865e+003 N/m^2",
  "温度 +4.60000e+001 10965 +4.60000e+001 315867 +4.60000e+001 C",
  "TurbK +1.19616e+006 1319490 +1.44421e+008 10966 +1.81700e-008 mm^2/s^2",
  "涡轮 D +1.71412e+009 1319490 +2.88554e+011 233065 +5.37798e-004 mm^2/s^3",
  "标度1 +0.00000e+000 10965 +0.00000e+000 315867 +0.00000e+000",
  "PTotl -5.91285e+000 50858 +5.19412e+003 50905 -1.44865e+003 N/m^2",
  "EVisc +2.5203​​7e-004 1320370 +1.14488e-002 2229 +0.00000e+000 g/mm-s",
  "ECond +1.05355e-002 1352833 +5.88890e-002 2229 +0.00000e+000 W/mm-K",
  "密度 +2.34793e-004 58024 +3.43080e-003 315867 +1.20473e-006 g/mm^3",
  "粘度 +1.62605e-005 10965 +1.81700e-005 2229 +0.00000e+000 g/mm-s",
  "条件 +2.50840e-002 2229 +2.04000e-001 315867 +2.56300e-005 W/mm-K",
  “规格 H +1.01202e+000 38432 +1.81000e+000 10249 +1.00500e-003 J/gK”，
  "发射 +8.94911e-001 10965 +1.00000e+000 2229 +0.00000e+000",
  "传输 +0.00000e+000 0 +0.00000e+000 0 +0.00000e+000",
  "WRough +0.00000e+000 10965 +0.00000e+000 315867 +0.00000e+000 mm",
  "SeeBeck +0.00000e+000 0 +0.00000e+000 0 +0.00000e+000 V/K",
  "GenT +1.11977e+003 223286 +1.18027e+005 584515 +3.19558e-013 1/s"]]

```

该文件已转换为数组数组。前导和尾随空格，以及换行符和回车符被剥离，空白行被删除。

进一步处理文件是使用外部数组上的循环和查看每个子数组的第一行以确定如何处理该块的测试来完成的。这样的事情将是一个起点：

```
hash = {}
blocks.each do |block|
  case block.shift
  when /Summary/
    # process the summary information

  when /Analysis Information/
    # process the analysis information
    hash[:analysis_information] = Hash[block.map{ |r| r.split(/ +is +/) }]

  when /Field Variable Results/
    # process the field variable results

  end
end 
```

这个想法是，当代码完成时，`hash`将包含散列散列或数组散列中的解析数据，准备好写出来。我建议使用 YAML，因为它可以缩短将数据序列化为文件的工作。

我不会添加更多内容，因为这个问题听起来很像家庭作业，而且解析这些行并不难。将文件分成块是一项更大的任务，这部分已经为您完成了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T00:10:02.393

您可以将部分中的所有行添加到数组中。如果下一部分开始或您位于文件末尾，则使用此数组作为参数调用特定于部分的方法。这样您就不必在检测部分时处理部分逻辑。

**编辑：** 未经测试，但这应该给出一个想法：

```
def parse_section_name(name)
  name.gsub!(/\*/, '') # remove *'s
  return name.strip # remove whitespace from both sides
end

def call_section_logic(name, lines)
  case name
  when ...
  ...
  else # unknown name
  end
end

section_lines = []
lines = file.readlines + ['***'] # add last section, too
lines.each do |line|
  if line =~ /^\s*\*{3}/ # detect section
    call_section_logic(section_name, section_lines)
    section_name = parse_section_name(line)
    section_lines.clear
  else
    section_lines << line # add line to array
  end
end 
```

# stata - Stata移动产品

> ID：14531341
> 
> 赞同：1
> 
> 时间：2013-01-25T22:25:44.420
> 
> 标签：stata

使用 Stata，我想要一个公式（代码行），它获取给定单元格中给定组 G 的所有先前条目，并返回该单元格及以上所有值的乘积。例如：

```
G    X    Y
1    1    1
1    2    2
1    6    12
1    3    36
2    2    2
2    4    8
3    2    2
4    2    2
4    11   22 
4    7    154 
```

G = 组 ID，X = 价值，Y = 移动产品

我一直这样做的方式很长，并且涉及创建大量变量。Stata 中必须有一种方法可以让它按组 ID (G) 进行移动产品。

任何见解都是有帮助的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T23:06:22.047

这是解决方案：

```
sort G 
by G: gen moving_product = exp(sum(ln(X))) 
```

这应该使 X = Y

# python - 如何将文本添加到矩形中？

> ID：14531346
> 
> 赞同：26
> 
> 时间：2013-01-25T22:25:56.307
> 
> 标签：python, matplotlib, label, rectangles

我有一个在图像顶部绘制数百个小矩形的代码：

![例子](../Images/9939ca552c15868d04295afabc968b70.png)

矩形是

```
 matplotlib.patches.Rectangle 
```

我想在这些矩形中输入一个文本（实际上是一个数字），但我没有办法做到这一点。matplotlib.text.Text 似乎允许插入由矩形包围的文本，但是我希望矩形处于精确的位置并具有精确的大小，我认为这不能用 text() 来完成。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2013-01-26T01:26:21.810

我认为您需要使用轴对象的注释方法。

您可以使用矩形的属性来了解它。这是一个玩具示例：

```
import matplotlib.pyplot as plt
import matplotlib.patches as mpatch

fig, ax = plt.subplots()
rectangles = {'skinny' : mpatch.Rectangle((2,2), 8, 2),
              'square' : mpatch.Rectangle((4,6), 6, 6)}

for r in rectangles:
    ax.add_artist(rectangles[r])
    rx, ry = rectangles[r].get_xy()
    cx = rx + rectangles[r].get_width()/2.0
    cy = ry + rectangles[r].get_height()/2.0

    ax.annotate(r, (cx, cy), color='w', weight='bold', 
                fontsize=6, ha='center', va='center')

ax.set_xlim((0, 15))
ax.set_ylim((0, 15))
ax.set_aspect('equal')
plt.show() 
```

![带注释的矩形](../Images/2041e24ab6f4c09ed37504b662c89e91.png)

# android - 如何使用 android，以编程方式向连接的蓝牙设备发送振动命令？

> ID：14531355
> 
> 赞同：1
> 
> 时间：2013-01-25T22:26:39.330
> 
> 标签：android, bluetooth, vibration

我正在努力实现这个目标：我有一个蓝牙设备连接到我的安卓手机。鉴于此设备可以振动，是否可以向设备发送振动命令？

我已经研究了 android 开发者网站上的蓝牙 api 和振动 api，但没有什么能明确回答我的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T06:08:35.930

在蓝牙 HFP（免提）规范中，没有命令（AT 命令）向对等设备发送振动。根据手环“来电振动提示”的技术规范，一旦从手机向手环发送AT指令指示来电，手环会在本地产生振动，手机不会询问/请求振动。

如果你想让对端设备振动，可能你必须使用你自己定义的命令（AT命令），命令被对端设备识别。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-02-20T15:17:00.683

我正在摆弄同样的问题。经过几天的反复试验，我终于让它工作了。我认为这取决于您回答 HF 命令的速度，以及正确的行尾（[13][10]“COMMAND”[13][10]）。

这是我的 DroidScript，它有效。它没有清理干净，但它可以工作。

[https://gist.github.com/t-oster/68a568ac4c4e133f67ac](https://gist.github.com/t-oster/68a568ac4c4e133f67ac)

适用于我的手镯的确切顺序是：

CR 是 ASCII 码 13，LF 是 ASCII 码 10

```
> AT+BRSF=0<cr>
< <cr><lf>+BRSF:0<cr><lf>
< <cr><lf>OK<cr><lf>
> AT+CIND=?<cr>
< <cr><lf>+CIND: ("service",(0,1)),("call",(0,1))<cr><lf>
< <cr><lf>OK<cr><lf>
> AT+CIND?<cr>
< <cr><lf>+CIND: 1,0<cr><lf>
< <cr><lf>OK<cr><lf>
> AT+CMER=3,0,0,1<cr>
> <cr><lf>OK<cr><lf> 
```

从那时起我可以发送

```
<cr><lf>RING<cr><lf> 
```

使其振动。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T01:57:12.510

我很高兴更新这个线程，我能够以编程方式使用 AT 命令以正确的方式振动 BT 手镯。所以我的应用程序基于 Android 示例中的蓝牙聊天应用程序。以下是我遵循的步骤：

1.  将设备连接到手机
2.  设备遵循 BT 免提配置文件规范。这需要通过 AT 命令“握手”。所以我模仿了这种命令交换（对手镯的命令进行硬编码响应）
3.  握手完成后，我根据 BT Hands-Free profile 规范向 RING 和 +CLIP 发送 AT 命令：
4.  在收到应用程序的最后一组响应时，手镯会振动。

这看起来很简单，但如果不了解 BT Hands-Free 配置文件规范和示例 AT 命令，这几乎是不可能的。

@bt_user：感谢您的指点，让我走上了研发的正确轨道。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-20T12:55:28.353

我使用 Thomas Oster 的部件和我在网上找到的一个示例开发了一个 java android 版本

[https://gist.github.com/shimondoodkin/a582d910045ab06ab68c](https://gist.github.com/shimondoodkin/a582d910045ab06ab68c)

# mongodb - MongoDB批量插入不适用于Java驱动程序

> ID：14531358
> 
> 赞同：0
> 
> 时间：2013-01-25T22:26:47.427
> 
> 标签：mongodb

我正在尝试 mongoDB，这是我用来连接和插入记录的代码。

```
import com.mongodb.*;

import java.net.UnknownHostException;
import java.util.LinkedList;
import java.util.List;

public class MongoConnect {

    public static void main(String[] args) throws UnknownHostException, InterruptedException {
        MongoClient mongoClient = new MongoClient("localhost");
        DB db = mongoClient.getDB("mydb");
        DBCollection collection = db.getCollection("emails");
        long currentTime = System.currentTimeMillis();

        long totalRecords = 120L;
        long batchInsert = 0;

        long insertedRecords = 0L;
        List<DBObject> basicDBObjects = new LinkedList<DBObject>();
        while (insertedRecords < totalRecords) {
            System.out.println("adding: "+insertedRecords);

            basicDBObjects.add(new BasicDBObject("email", "amar+" + insertedRecords + "@gmail.com"));
            insertedRecords++;
            batchInsert++;
            if (batchInsert == 5) {
                System.out.println("inserting: "+(insertedRecords-5));
                collection.insert(basicDBObjects);

                System.out.println("Inserted: *******"+insertedRecords);
                //Thread.sleep(200);
                batchInsert = 0;
                basicDBObjects = new LinkedList<DBObject>();
            }
        }

        long endTime = System.currentTimeMillis();
        System.out.println("Total time taken :"+((endTime-currentTime)/1000));
        //long currentTime = System.currentTimeMillis();
        DBCursor email = collection.find(new BasicDBObject("email", "amar+3@gmail.com"));
        int count = email.count();
        System.out.println("count = "+count);
        System.out.println("Total time taken: "+String.valueOf(System.currentTimeMillis()-currentTime));

    }
} 
```

我可以看到创建了带有“电子邮件”的集合，它显示为的一部分`show collections` 但是当我`db.mydb.emails.find({})`没有结果时。我尝试重新启动 mongo 服务，甚至尝试`db.dropDatabase()`似乎没有任何效果。谁能指出这个问题？仅供参考，通过控制台插入工作正常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-31T06:27:04.600

```
This code is working with mongoDB Version 2.2.3

So Pleae install this version and check your db

First Perform following command

show dbs
use mydb
show collections

when you perform these three command then you will see list of collection for mydb

then perform 

db.emails.find() which will give you will get Record

Here below i have paste command that i have fire it and check it dear 

C:\dhananjay\mongoDB\mongodb\bin>mongo.exe

MongoDB shell version: 2.2.3
connecting to: test

> show dbs
blog    0.203125GB
course  0.203125GB
local   (empty)
m101    0.203125GB
mydb    0.203125GB
school  0.203125GB
students        0.203125GB
test    0.203125GB

> use mydb
switched to db mydb

> show collections
emails
system.indexes

> db.emails.find()

{ "_id" : ObjectId("51a83f22fdb3f79d6a713e71"), "email" : "amar+0@gmail.com" }
{ "_id" : ObjectId("51a83f22fdb3f79d6a713e72"), "email" : "amar+1@gmail.com" }
{ "_id" : ObjectId("51a83f22fdb3f79d6a713e73"), "email" : "amar+2@gmail.com" }
{ "_id" : ObjectId("51a83f22fdb3f79d6a713e74"), "email" : "amar+3@gmail.com" }
{ "_id" : ObjectId("51a83f22fdb3f79d6a713e75"), "email" : "amar+4@gmail.com" } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T00:03:49.757

我只是更改`MongoClient mongoClient = new MongoClient("localhost");`为`Mongo mongo = new Mongo();`，一切都按您的预期进行。

您使用的是哪个版本的 mongo 驱动程序？我使用的是 mongo 2.9.1，这里是 maven 依赖项：

```
<dependency> 
<groupId>org.mongodb</groupId>
<artifactId>mongo-java-driver</artifactId> 
<version>2.9.1</version>
</dependency>

<dependency> 
<groupId>org.mongodb</groupId>
<artifactId>bson</artifactId> 
<version>2.9.1</version> 
</dependency>

Mongo mongo = new Mongo();
        DB db = mongo.getDB("example");
        DBCollection collection = db.getCollection("sampleCollection");
        List<DBObject> basicDBObjects = Lists.newArrayList();
        long currentTime = System.currentTimeMillis();
        long totalRecords = 120L;
        long batchInsert = 0;

        long insertedRecords = 0L;
        while (insertedRecords < totalRecords) {
            System.out.println("adding: "+insertedRecords);

            basicDBObjects.add(new BasicDBObject("email", "amar+" + insertedRecords + "@gmail.com"));
            insertedRecords++;
            batchInsert++;
            if (batchInsert == 5) {
                System.out.println("inserting: "+(insertedRecords-5));
                collection.insert(basicDBObjects);

                System.out.println("Inserted: *********"+insertedRecords);
                Thread.sleep(200);
                batchInsert = 0;
                basicDBObjects = Lists.newArrayList();
            }
        }

        long endTime = System.currentTimeMillis();
        System.out.println("Total time taken :"+((endTime-currentTime)/1000));
        //long currentTime = System.currentTimeMillis();
        DBCursor email = collection.find(new BasicDBObject("email", "amar+3@gmail.com"));
        int count = email.count();
        System.out.println("count = "+count);
        System.out.println("Total time taken: "+String.valueOf(System.currentTimeMillis()-currentTime)); 
```

# c# - 从滴答声中及时生成实例的有效表示

> ID：14531374
> 
> 赞同：2
> 
> 时间：2013-01-25T22:28:25.843
> 
> 标签：c#, date, datetime, random

我正在尝试使用[DateTime 构造函数（Int64）](http://msdn.microsoft.com/en-us/library/z2xf7zzk.aspx)`DateTime`生成随机实例，如下所示：

```
string date = new DateTime(ticks).ToString("dd/mm/yyyy") 
```

它们是（2010/01/25 刻度）和（2015/01/26 刻度）之间的`ticks`随机数。`633999744000000000``635578272000000000`

输出：

```
date       ticks
----       -----
13/37/2013 634963486624182148
27/58/2010 634158395314391599
20/49/2011 634442033950650720
21/15/2013 634943637106398216
10/30/2014 635380290170226984
10/07/2012 634881676490509687
27/43/2012 634711201999181055
15/13/2012 634726699845971038
01/59/2010 634241843691014848 
```

但是，上述结果并不代表及时的有效实例。

如何使用 生成`DateTime`代表*有效*日期的随机实例`ticks`？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-25T22:29:45.117

值很好 -这`DateTime`是您的格式错误。您想要`MM`而不是`mm`在您的格式字符串中。`mm`是*几分钟*。

有关详细信息，请参阅MSDN 中的[“自定义日期和时间格式字符串”](http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-25T22:31:32.170

您的日期时间格式错误，您需要使用格式：“dd/MM/yyyy”

```
string date = new DateTime(ticks).ToString("dd/MM/yyyy") 
```

* * *

[DateTime 格式列表](http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx)

# objective-c - 将我的应用程序添加到 Finder 的上下文菜单？

> ID：14531377
> 
> 赞同：5
> 
> 时间：2013-01-25T22:28:43.553
> 
> 标签：objective-c, xcode, operating-system, finder

我正在开发一个处理任何类型文件的应用程序。我希望用户能够在 Finder 中右键单击*任何类型的文件*并显示我的菜单选项。我知道您必须将您的应用程序添加为服务才能执行此操作，但是，无论我在 Info.plist 中的服务设置中添加什么内容都不起作用。我确实将我的应用程序注册为 OS X 的服务，并且我知道它可以工作，因为在服务首选项下，我的应用程序的服务出现了。但是，我认为我没有传递正确类型的参数，因为我无法通过右键单击文件来激活我的服务。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T22:52:05.177

你看过[苹果文档](http://developer.apple.com/library/mac/#documentation/cocoa/conceptual/SysServices/introduction.html)吗？

此外，这可能很有用：[为 Finder.app 编写雪豹服务](https://stackoverflow.com/questions/3732142/writing-a-snow-leopard-service-for-finder-app)

# ios - 将日期范围转换为 NSDate

> ID：14531381
> 
> 赞同：-1
> 
> 时间：2013-01-25T22:29:39.077
> 
> 标签：ios, nsstring, nsdate

我正在解析 RSS，由于不同的因素，不得不求助于 NSScanner 并且不得不从 NSString 中删除日期并转换为日期。这工作得很好，除了一件小事。如果日期范围保持在同一天，则返回 NSDate 作为开始日期就可以了。但是，如果 NSString 显示不同的日期，则 NSDate 返回为 null。我需要的是转换

> 2013 年 9 月 28 日星期四至 2013 年 9 月 29 日星期五

进入 NSDate 的

> 2013 年 9 月 28 日星期四

此外，并非所有条目都有一个范围，有些只是 2013 年 9 月 28 日星期四......所以它限制了我真正可以做的事情来剥离之后的所有内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T22:35:28.610

您可以使用以下内容剪切字符串的可选第二部分：

```
NSString *firstPart = [[dateString componentsSeparatedByString:@" to "] objectAtIndex:0]; 
```

然后，使用适当的设置`NSDateFormatter`，您可以转换为`NSDate`.

# mysql - 避免插入与选择相结合的 SQL 死锁

> ID：14531385
> 
> 赞同：0
> 
> 时间：2013-01-25T22:30:03.753
> 
> 标签：mysql, sql, insert, database-deadlocks

我正在尝试将页面插入带有排序列的表中，我以这种方式自动递增 2000：

```
INSERT INTO pages (sort,img_url,thumb_url,name,img_height,plank_id)
SELECT IFNULL(max(sort),0)+2000,'/image/path.jpg','/image/path.jpg','name',1600,'3'
FROM pages WHERE plank_id = '3' 
```

问题是我在上传图片时触发了这些插入，所以这些查询中有 5-10 个几乎同时运行。由于某种原因，这会触发某些文件的死锁。

知道发生了什么吗？

编辑：我正在运行 MySQL 5.5.24 和 InnoDB。排序列有一个索引。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T16:41:37.017

我为自己所做的是设置`sort`为`0`插入，检索`id`插入的行并设置`sort`为`id*2000`. 但是，您也可以尝试使用事务：

```
BEGIN;
INSERT INTO pages (sort,img_url,thumb_url,name,img_height,plank_id)
SELECT IFNULL(max(sort),0)+2000,'/image/path.jpg','/image/path.jpg','name',1600,'3'
FROM pages WHERE plank_id = '3';
COMMIT; 
```

请注意，并非所有 MySQL 客户端库都支持多查询，因此您可能必须单独执行它们，但要在一个连接的流中执行。

另一种方法是在执行时锁定整个表`INSERT`，但这会导致查询队列增加，因为它们必须等到执行插入

# css - 在网站上缩放切片图像

> ID：14531395
> 
> 赞同：0
> 
> 时间：2013-01-25T22:30:47.217
> 
> 标签：css, scaling

我一直在与一位图形艺术家合作，他坚持认为他的网站图形表示的外观正是它在网站上的外观，并且它应该可以扩展到所使用的任何屏幕分辨率。他合并了太多层，这使我无法将许多层用作元素。在向平面设计师（为客户工作）和他的老板解释这一点时，他们决定要对网站进行切片。我已经在 Fireworks 中对图像进行了切片，显然，没有任何缩放，一切都很好。我从代码中提取了所有的表格标签（`<table>`、`<th>`、`<tr>`、`<td>`等），并一直在排列图像元素。我将主要设置`<div>`为`95%`. 我试过`max-size`在设置的图像上使用`100%`，我已经尝试过`px`，`%`对于`margin`s。有没有办法真正扩大规模？或者这是徒劳的练习？

# python - 在 Pyramid Framework 中，默认未加密会话工厂和手动设置 cookie 有什么区别？

> ID：14531396
> 
> 赞同：2
> 
> 时间：2013-01-25T22:31:07.120
> 
> 标签：python, python-2.7, pyramid

`request.response.set_cookie(..)`与使用and相比，我不明白设置未加密会话工厂以设置 cookie 之间的区别`request.cookies[key]`。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-26T17:15:28.793

`UnencryptedCookieSessionFactory`管理*一个*cookie，即已*签名*。这意味着客户端可以读取¹ cookie 中的内容，但不能*更改*cookie 中的值。

如果直接使用 设置cookie `response.set_cookie()`，客户端不仅可以读取cookie，还可以更改cookie的值，您将无法检测到内容被篡改。

此外，`UnencryptedCookieSessionFactory`让我们存储任何 python 结构，它会负责对这些结构进行编码以适应 cookie 的限制；您必须手动使用`.set_cookie()`.

^(1[您必须对 cookie 进行 base64 解码，然后使用`pickle`模块对内容进行解码。因为 cookie 是经过加密签名的，所以通常适用的安全问题得到了`pickle`缓解。])

# constants - const 成员函数应该返回 const 还是非常量？

> ID：14531406
> 
> 赞同：0
> 
> 时间：2013-01-25T22:32:18.677
> 
> 标签：constants, d

```
struct Type
{
  auto opBinary(string op)(Type other) const {
    return Type();         // #1 return type is Type
    return typeof(this)(); // #2 return type is const(Type)
  }
}

unittest
{
  Type t1, t2;
  auto t3 = t1 + t2;
} 
```

在`t1.opBinary!("+")(t2)`,`t1`成为一个常量，而`t2`保持非常量。`opBinary`的返回类型应该是or `Type`，`const(Type)`为什么？

`const(T)`是一个超类型，所以也许它应该返回 a `const`，但我在实践中几乎没有看到过。当处理使用这些类型或被这些类型使用的类型和函数的层次结构时，事情也会变得相当复杂。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T22:40:22.960

由于这里的返回值是一个新对象，我会说它是非常量的。作为新的，它可以安全地修改，所以没有理由用 const 不必要地限制它。

如果要返回现有对象的一部分，则需要使用 inout 而不是 const。inout 表示对象的 constness 也会去返回值。

```
inout(Type) opBinary(string op)(Type other) inout {
    return whatever;
} 
```

现在，如果您使用 const(Type) 对象，则返回也将是 const，如果在可变对象上调用它，则返回也是可变的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T11:44:51.000

*返回类型应该是 T 还是 const(T)？*任何人都会做。

*哪一个更好？*取决于您的预期行为。

**opBinary 上的const**限定符仅表示隐藏的“this”参数是**const**。仅此而已，仅此而已。它并不暗示有关返回类型的任何内容。这一切都归结为非常简单的选择：

```
struct Type
{
    int a;
    auto opBinary(string op)(Type other) const
           if (op == "+")
    {
        return Type(this.a + other.a);
    }
}

void main()
{
    Type first, second;
    (first + second).a = 42; // Do you want to allow this?
                             // Yes -> return non-const
                             // No -> return const
} 
```

如果要保留参数的限定符，请使用**inout**（请参阅 Adams 答案）或手动检查限定符以获得更复杂的选择。

无论哪种选择，请记住自动类型扣除：

```
auto third = first + second;
third.a = 42; // Error if returns const

Type fourth = first + second;
fourth.a  = 42; // Fine in both cases, struct was copied 
```

最后，它是关于您作为类型设计师的意图，类/结构应该如何表现。

# iphone - UIDatePicker 问题

> ID：14531407
> 
> 赞同：1
> 
> 时间：2013-01-25T22:32:20.897
> 
> 标签：iphone, ios, ios6, uidatepicker

我正在**XCode 4.5.2中编写一个 iPhone** **iOS 6.0**应用程序。 我的视图上有 3 个 UITextField，一个用于显示缩略图的 UIImageView 和一个默认隐藏的 UIDatePicker，在 Interface Builder 中设置。

 **我的视图是使用故事板创建的。

其中一个文本字段用于日期选择器，因此当点击时，通过将隐藏字段设置为 NO，日期选择器将显示在屏幕底部。当您点击任何其他文本字段时，日期选择器会消失并显示键盘。

当您点击图像视图时，它使用 UIActionSheet 允许用户从您的库中选择照片或拍照。

问题是当您点击日期选择器的文本字段，然后点击图像视图以选择要在委托方法后显示的图像时

```
- (void)imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info 
```

结束程序崩溃并显示以下错误消息

> ***由于未捕获的异常“NSGenericException”而终止应用程序，原因：“无法在视图上安装约束。约束是否引用了视图子树之外的内容？那是违法的。约束：视图：；层 = ; 内容偏移：{0, 0}>'

如果您从其他文本字段之一转到图像视图，它工作正常，所以我知道问题出在日期选择器上。

起初我以为是由于日期选择器仍然显示，所以在显示操作表之前点击图像视图我隐藏了日期选择器

```
dobDatePicker.hidden = NO; 
```

我还在视图上设置了编辑以将焦点从文本字段中移开

```
[self.view endEditing:YES]; 
```

它在使用 iPhone 5 长度屏幕的 iOS 6 模拟器和我的 iPhone 5 上都崩溃了。

任何人都可以对此有所了解吗？

提前致谢

编辑：

在视图的 ViewDidLoad 方法中，我有这段代码

```
self.dob.inputView = self.dobDatePicker 
```

似乎评论说 out 已经停止了崩溃，但现在它同时显示了键盘和日期选择器......不过猜想更近了**

# c# - Where() 返回重复的行

> ID：14531408
> 
> 赞同：0
> 
> 时间：2013-01-25T22:32:31.087
> 
> 标签：c#, .net, linq, where

我有一个简单的表/模型：

```
public class Note
{
    public Guid Id { get; set; }
    public string note { get; set; }
    public DateTime? DateCreated { get; set; }
    public Guid InvestorId { get; set; }
} 
```

我可以用

```
db.Database.SqlQuery<Note>("SELECT * FROM Notes WHERE InvestorId = '" + id + "'").ToList() 
```

并按预期返回该 ID 的所有注释。我尝试使用 LINQ 来做到这一点：

```
db.Notes.Where(x => x.InvestorId == id).ToList() 
```

我得到了相同数量的行，但所有的笔记都是第一个的重复。在不返回重复项的情况下在 LINQ 中执行此操作的正确方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T23:01:23.127

我发现了问题。我一直在尝试不同的技术，并且在 Notes 中使用相同的数字填充了 Id（不是 InvestorId）。显然 Sql 查询并不关心这一点，但 LINQ 不喜欢它。

# asp.net - VBScript 运行时错误 '800a0034' - 错误的文件名或编号 - 尝试写入服务器端文本文件时

> ID：14531409
> 
> 赞同：1
> 
> 时间：2013-01-25T22:32:57.040
> 
> 标签：asp.net, vbscript

我试图简单地写入一个文本文件，以供以后使用从各个页面上的输入元素收集的数据。诚然，我可能错过了明显的，但我尝试过的变体，甚至我在许多示例中发现的一些示例代码，我总是得到同样的错误。

**代码：**

```
<%
  Dim currentDirectoryPath, outFile, objFSO, objTextStream

  Const fsoForWriting = 2

  'Get and assign current directory path
  currentDirectoryPath = Server.MapPath(".")

  'Assign file name to be used
  outFile = "\accdata.txt\"

  Set objFSO = Server.CreateObject("Scripting.FileSystemObject")

  'Open the text file
  Set objTextStream = objFSO.OpenTextFile(currentDirectoryPath & outFile, fsoForWriting, True)

  'Write new line to text file
  objTextStream.WriteLine "output this as one line of text"

  'Close the file and clean up
  objTextStream.Close
  Set objTextStream = Nothing
  Set objFSO = Nothing
%> 
```

**结果：**

Microsoft VBScript 运行时错误“800a0034”

错误的文件名或编号

/asp/accounting/datacollect.asp，第 23 行

（代码第23行是：）

```
Set objTextStream = objFSO.OpenTextFile(currentDirectoryPath & outFile, fsoForWriting, True) 
```

这远不是我的第一语言，因此我没有大量的经验，因此非常感谢任何帮助或建议。

# css - 为什么 Internet Explorer 忽略正文字体大小？

> ID：14531410
> 
> 赞同：0
> 
> 时间：2013-01-25T22:33:15.100
> 
> 标签：css, internet-explorer

我正在构建 Magento 网站，它在 Firefox 和 Chrome 中运行良好，但在 IE9、IE8 中无法正确显示。

正文字体大小设置为`12px`但 IE 似乎完全忽略了它。

这是body元素的CSS：

```
body {
  background: url(../images/background/bkgd.gif) repeat-x scroll left top #FFFFFF;
  font: 12px/1.55 arial, helvetica, sans-serif;
  color: #444;
  text-align: center;
} 
```

这是[网站](http://no1pizza.com/cottridgehomw/)。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T22:48:53.107

您的 HTML/模板中有内联样式。查看源代码并搜索我在第 99 行找到的 20px，如下所示：

```
<div a align="right">
            <span style="font-weight:bold; font-size:12pt;">Your local No1Pizza is <span style="font-weight:bold; font-size:20px;"><a href="/pizza.html">Wolverhampton.<span/>
            <a style="font-weight:bold; font-size:8pt;" href="/index.php/emptybasket/ ">
            (Not your desired shop?)
            </a>
            </div>       </div> 
```

你真的需要清理代码。还要注意`<span/>`上面错误的结束标签。

# jquery - 单击标签时显示 TD 内的 div，关闭其他标签

> ID：14531413
> 
> 赞同：1
> 
> 时间：2013-01-25T22:33:18.973
> 
> 标签：jquery

我有 TD 元素，其中包含锚标记和我希望在单击锚标记时显示的 div。另外，我希望其他人在单击其中任何一个时关闭，如果它已经打开的话。

HTML：

```
<td>
<a href="#"><img src="images/1.jpg" /></a>
<div class="test"><p>test</p></div>
</td>

<td>
<a href="#"><img src="images/1.jpg" /></a>
<div class="test"><p>test</p></div>
</td> 
```

我尝试使用此 JQuery，但由于某种原因，我必须单击两次才能第一次显示 div，如果然后单击第二个，则第一个不会关闭。我不需要添加任何课程。

```
<script type="text/javascript">
$(document).ready(function() {
    $('.test').hide();
    $('td a').on('click', function() {
        var state = $(this).next('.test').is('.open');
        if (state) {
            $(this).removeClass('active').next('.test').removeClass('open').show();
        }else{
            $(this).addClass('active').next('.test').addClass('open').hide()
                   .siblings('.test').removeClass('open').show().end()
                   .siblings('.test').not(this).removeClass('active');
        }
    });
});
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T22:41:37.950

这样做：

```
$(document).ready(function() {
    $('td a').on('click', function() {
        $(this).closest('tr').find('td div.test.open').removeClass('open');
        $(this).next('div.test').addClass('open');
    });
}); 
```

在你的 CSS 中，有

```
div.test { display:none; }
div.test.open { display:'block'; } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T22:46:18.807

您可以在不保存状态的情况下使用[**toggleClass()**](http://api.jquery.com/toggleClass/)切换`.active`类并使用[**toggle()**](http://api.jquery.com/toggle/)显示/隐藏当前测试`div`。

```
$('.test').hide();

$('td a').on('click', function () {
  var $target = $(this).next('.test'); 

  $('.test').not($target).hide();
  $target.toggleClass('.active').toggle();
}); 
```

此外，我还使用[**not()**](http://api.jquery.com/not/)隐藏所有其他`test divs`不是当前的。

* * *

[**演示**](http://jsfiddle.net/w99a3/)- 切换 div

* * *

我在 DEMO 中使用了以下 HTML

```
<table>
  <tbody>
    <tr>
      <td> <a href="#"><img src="http://placehold.it/100x50" /></a>

        <div class="test">
          <p>test</p>
        </div>
      </td>
      <td> <a href="#"><img src="http://placehold.it/100x50" /></a>

        <div class="test">
          <p>test</p>
        </div>
      </td>
    </tr>
  </tbody>
</table> 
```

# css - 用更少的声明覆盖 CSS

> ID：14531415
> 
> 赞同：0
> 
> 时间：2013-01-25T22:33:42.703
> 
> 标签：css, twitter-bootstrap, overriding

我正在尝试从引导程序中覆盖 css。我要设计没有颜色的导航栏。

```
.navbar-inner {
  min-height: 40px;
  padding-right: 20px;
  padding-left: 20px;
  background-color: #fafafa;
  background-image: -moz-linear-gradient(top, #ffffff, #f2f2f2);
  background-image: -webkit-gradient(linear, 0 0, 0 100%, from(#ffffff), to(#f2f2f2));
  background-image: -webkit-linear-gradient(top, #ffffff, #f2f2f2);
  background-image: -o-linear-gradient(top, #ffffff, #f2f2f2);
  background-image: linear-gradient(to bottom, #ffffff, #f2f2f2);
  background-repeat: repeat-x;
  border: 1px solid #d4d4d4;
  -webkit-border-radius: 4px;
     -moz-border-radius: 4px;
          border-radius: 4px;
  filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#ffffffff', endColorstr='#fff2f2f2', GradientType=0);
  *zoom: 1;
  -webkit-box-shadow: 0 1px 4px rgba(0, 0, 0, 0.065);
     -moz-box-shadow: 0 1px 4px rgba(0, 0, 0, 0.065);
          box-shadow: 0 1px 4px rgba(0, 0, 0, 0.065);
} 
```

和

```
.navbar-inner {
  min-height: 40px;
  padding-right: 20px;
  padding-left: 20px;

} 
```

我删除了在引导程序 .css 中替换它的背景颜色。

是否可以用另一个值覆盖它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-25T23:47:46.563

简短回答：**是的**

长答案如下

CSS 的工作方式称为特异性。样式应用于元素是有顺序的。将其视为 4 个单独的数字，每个数字的默认值为 0。所以 0,0,0,0 是默认值

*   第一个数字代表内联样式，例如，`<span style="color: red">I'm Red</span>`
*   第二个数字代表 ID，例如，`#IdSelector`
*   第三个数字代表类别，例如，`.ClassSelector`
*   第四个数字代表元素和伪选择器，例如，`div`和`:first-child`

这些规则的应用顺序是内部样式表首先，外部样式表其次。如果定义了适用于您的元素的 ANYWHERE 规则并且您没有使用具有更高特异性的选择器覆盖它，那么它将保持不变。

以下将覆盖

```
.navbar-inner {
    background-image: none;
} 
```

回到特异性。

如果你的元素是`<div id="mainNav" class="navbar-inner"></div>`

```
#mainNav {
    background-image: none;
}
.navbar-inner {
    background-image: url(img.png);
} 
```

然后图像将设置为无。ID选择器的特异性为0,1,0,0，类扇区的特异性为0,0,1,0。

即使您添加了 11 个类，该 ID 仍然会获胜，这种情况下的特异性将是 0,0,11,0

最后一个数字，一个隐藏的数字。所以 0,0,0,0,0 前面的代表`!important`，可以在任何样式声明之后添加，使其无论如何都适用。如果您列出了两个冲突的声明`!important`，它会退回到内联、嵌入式和外部的顺序。一般来说，你应该不惜一切代价避免 !important ，除非它绝对有意义。

# ! 有意义的重要示例。

```
.hide {
    display: none !important;
} 
```

# php - 在codeigniter中发布后多选不保留价值

> ID：14531416
> 
> 赞同：3
> 
> 时间：2013-01-25T22:33:47.693
> 
> 标签：php, codeigniter, codeigniter-form-helper

我的应用程序中有一个带有多选的表单。我正在使用 CI 的表单助手来构建我的表单，因此元素的构建如下所示：

```
return form_multiselect('authors[response][]', $faculty->get_all_for_multiselect(), 
                         $pre_selected, $additional_attributes); 
```

如果项目在数据库中，这一切都很好（$pre_selected 获取现有响应）。但是，我也在通过 CI 的表单验证运行表单，当这种情况发生时，如果验证失败，那么多选会丢失已选择的值。

我敢肯定，这很简单，我只是在看，所以希望有人可以在这里帮助我。

**添加更多信息**

该字段被标记为必填，因此它正在通过验证器（尽管它总是会通过，因为我会自动选择当前用户）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-25T04:49:58.430

（我假设 $pre_selected 是一个值数组？）

您可以在表单提交失败后使用 $_POST 数组重置所选值。

由于您已经在使用 $pre_selected，您应该能够使用以下内容：

```
return form_multiselect('authors[response][]', $faculty->get_all_for_multiselect(), 
                         array_unique(array_merge($pre_selected, $_POST['response'])), $additional_attributes); 
```

# javascript - 如何在 Amazon Beanstalk 和 Tomcat 上启用 HTML/JavaScript/CSS 的 gzip

> ID：14531421
> 
> 赞同：18
> 
> 时间：2013-01-25T22:34:05.323
> 
> 标签：javascript, amazon-web-services, amazon-ec2, gzip, amazon-elastic-beanstalk

我想在我的战争中对 JavaScript、HTML、CSS 进行 gzip 压缩，然后再通过网络。标准的网络东西。Beanstalk 使用 AMI 进行扩展。

我看到了有关如何创建新 AMI 的说明，但我什至看不到 Tomcat 的位置。在撰写本文时，当前的 AMI 是 ami-1a249873，用于 Tomcat 7 部署。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-28T14:43:56.917

我会自己回答这个问题。所有人都很清楚，您可以连接到您的 EC2 实例，即使它们是由 beanstalk 管理的。这很有帮助，因为您可以查看物品的位置。在这种情况下，我不知道 Apache 被用作 tomcat 的网络服务器，因此必须搜索它，但您可以像今天一样在这里找到它：

/etc/httpd

一旦找到这样的信息，就进行更改：http:
[//docs.aws.amazon.com/elasticbeanstalk/latest/dg/customize-containers.html](http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/customize-containers.html)

如果您在项目的根目录下创建一个名为 .elasticbeanstalk 的文件夹，然后创建一个名为 myapp.config 的文件。

设置阿帕奇：

```
cp conf/httpd/conf.d/enabledeflate.conf /etc/httpd/conf.d/enabledeflate.conf 
```

然后使用以下内容创建 enabledeflate.conf：

```
SetOutputFilter DEFLATE
# mod_deflate configuration
<IfModule mod_deflate.c>
    # Restrict compression to these MIME types
    AddOutputFilterByType DEFLATE text/plain
    AddOutputFilterByType DEFLATE text/html
    AddOutputFilterByType DEFLATE application/xhtml+xml
    AddOutputFilterByType DEFLATE text/xml
    AddOutputFilterByType DEFLATE application/xml
    AddOutputFilterByType DEFLATE application/xml+rss
    AddOutputFilterByType DEFLATE application/x-javascript
    AddOutputFilterByType DEFLATE text/javascript
    AddOutputFilterByType DEFLATE text/css
    <IfModule mod_headers.c>
        # Make sure proxies don't deliver the wrong content
        Header append Vary User-Agent env=!dont-vary
    </IfModule>
</IfModule> 
```

几点注意事项：
您可能需要在第一次部署时重新启动 apache。
确保将 .elasticbeanstalk 放在您的战争文件（或 git repo）的根目录中

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2016-05-19T15:20:22.340

添加到詹姆斯的答案

更简洁的方法是创建一个配置文件

`.ebextensions/wsgi_custom.config`

把它放在那里

```
files:
  "/etc/httpd/conf.d/wsgi_custom.conf":
    mode: "000644"
    owner: root
    group: root
    content: |
      WSGIPassAuthorization On

      LoadModule deflate_module modules/mod_deflate.so

      SetOutputFilter DEFLATE

      # mod_deflate configuration
      <IfModule mod_deflate.c>
          # Restrict compression to these MIME types
          AddOutputFilterByType DEFLATE text/plain
          AddOutputFilterByType DEFLATE text/html
          AddOutputFilterByType DEFLATE application/xhtml+xml
          AddOutputFilterByType DEFLATE text/xml
          AddOutputFilterByType DEFLATE application/xml
          AddOutputFilterByType DEFLATE application/xml+rss
          AddOutputFilterByType DEFLATE application/x-javascript
          AddOutputFilterByType DEFLATE text/javascript
          AddOutputFilterByType DEFLATE text/css
          <IfModule mod_headers.c>
              # Make sure proxies don't deliver the wrong content
              Header append Vary User-Agent env=!dont-vary
          </IfModule>
      </IfModule> 
```

我还添加了 WSGIPassAuthorization On 以防您需要使用 jwt auth 将其用于 django-rest-framework

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-03-03T10:39:25.140

没有比[http://www.tonmoygoswami.com/2013/05/how-to-enable-gzip-on-amazon-elastic.html更好的地方了](http://www.tonmoygoswami.com/2013/05/how-to-enable-gzip-on-amazon-elastic.html)

为您解答

[您可以从https://console.aws.amazon.com/elasticbeanstalk/](https://console.aws.amazon.com/elasticbeanstalk/)重新启动服务器

单击应用程序名称，然后从右上角单击操作下拉按钮并“重新启动服务器”

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-02-13T13:58:37.560

似乎有几种方法可以做到这一点，但没有完整的复制和粘贴解决方案。所以这是我的，工作没有任何问题。

创建文件`.ebextensions/01-environment.config`

添加了以下内容：

```
# Enable Server-side Compression
files:
  "/etc/httpd/conf.d/enable_mod_deflate.conf":
    mode: "000644"
    owner: root
    group: root
    content: |
        <IfModule mod_deflate.c>
            AddOutputFilterByType DEFLATE text/plain
            AddOutputFilterByType DEFLATE text/html
            AddOutputFilterByType DEFLATE application/xhtml+xml
            AddOutputFilterByType DEFLATE text/xml
            AddOutputFilterByType DEFLATE application/xml
            AddOutputFilterByType DEFLATE application/xml+rss
            AddOutputFilterByType DEFLATE application/x-javascript
            AddOutputFilterByType DEFLATE text/javascript
            AddOutputFilterByType DEFLATE text/css

            DeflateCompressionLevel 9

            BrowserMatch ^Mozilla/4 gzip-only-text/html
            BrowserMatch ^Mozilla/4\.0[678] no-gzip
            BrowserMatch \bMSI[E] !no-gzip !gzip-only-text/html

            <IfModule mod_headers.c>
                # Make sure proxies don't deliver the wrong content
                Header append Vary User-Agent env=!dont-vary
            </IfModule>

        </IfModule>

container_commands:
  02_restart_apache:
    command: sudo apachectl restart 
```

**这是做什么的？**

1.  创建`/etc/httpd/conf.d/enable_mod_deflate.conf`具有正确权限的文件
2.  在文件中添加压缩内容
3.  最后创建一个（链接到 this 和 command [here](https://stackoverflow.com/a/40096352/2205754)`container_commands`之间的区别），重新启动 apache 服务器。这是显示效果所必需的，并且也很重要，就像您正在自动缩放并且启动另一个实例一样，这也会创建此文件，然后在新实例上重新启动 apache。如果没有这个，实例将不会重新启动，并且需要手动重新启动。

# ruby-on-rails - 如何将 Ransack 搜索保存到数据库？

> ID：14531426
> 
> 赞同：5
> 
> 时间：2013-01-25T22:34:35.993
> 
> 标签：ruby-on-rails, ransack

我正在尝试将 Ransack 搜索保存到数据库中。我相信我应该能够只存储该`params[:q]`值，然后在我想召回搜索时将其附加到搜索 URL。不过，我不知道如何保存`params[:q]`价值。

Ransack 创建的 URL 是这样的：

```
http://site.com/search?utf8=%E2%9C%93&q%5Bone%5D=something&q%5Btwo%5D=&q%5Bthree%5D=&q%5Blow_number%5D=0&q%5Bhigh_number%5D=300000&q%5Bfour%5D=&commit=Search 
```

我将保存搜索的操作的路线是：

```
match 'users/:id/saved_search_add' => 'users#saved_search_add', :as => :saved_search_add 
```

如果我在视图中使用此代码：

```
<%= link_to('Save Search', saved_search_add_path(current_user, :q => params[:q])) %> 
```

在控制器中使用此代码：

```
 def saved_search_add
    @saved_search = Search.create(:query => params[:q].to_hash, :user_id => @user.id)

    respond_to do |format|
      if @saved_search.save
        format.html { redirect_to(:back) }
      else
        format.html { redirect_to(:back) }
      end
    end
  end 
```

那么存储的数据是：

```
--- !ruby/hash:ActiveSupport::HashWithIndifferentAccess
one: ''
two: ''
three: ''
low_number: '0'
high_number: '300000'
four: '' 
```

所以，我需要在数据进入数据库时​​以某种方式对其进行格式化（也许在它出来的时候？）......我读过一些关于序列化它的东西，但我没有太多运气让它工作。

我怎样才能`params[:q]`进入我的数据库，以便以后重新创建完整的搜索 URL？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-27T23:03:34.663

我最终只是使用`request.fullpath`而不是`params[:q]`.

将查询保存到数据库的代码在`Users`Controller 中：

```
def saved_search_add
  @saved_search = Search.create(:query => params[:q], :user_id => current_user.id)

  respond_to do |format|
    if @saved_search.save
      format.html { redirect_to(:back) }
    else
      format.html { redirect_to(:back) }
    end
  end
end 
```

我在视图中用于将搜索查询发送到`Users`控制器的代码是：

```
<%= link_to('Save Search', saved_search_add_path(current_user, :q => request.fullpath)) %> 
```

查询值在数据库中存储为：

```
/search?utf8=%E2%9C%93&q%5Bone%5D=something&q%5Btwo%5D=&q%5Bthree%5D=&q%5Blow_number%5D=0&q%5Bhigh_number%5D=300000&q%5Bfour%5D=&commit=Search 
```

我在视图中创建了指向该已保存搜索的链接：

```
<%= link_to "Saved Search", search.query %> 
```

# r - 如何删除ggplot geom_bar图例的横杆？

> ID：14531427
> 
> 赞同：4
> 
> 时间：2013-01-25T22:34:42.347
> 
> 标签：r, legend, ggplot2

我一直在 WEB 上搜索以删除下面 ggplot barplot 的图例中的横杆。但是，没有成功。你能帮我解决这个问题吗？请参阅下面的数据“temp”和我正在使用的代码。您能否也让我知道如何在条形图上使用模式？谢谢你。

```
temp:
    type    var value
    A   k1  20
    A   l1  30
    B   k1  10
    B   l1  15

    ggplot(temp,aes(type, value)) + geom_bar(stat="identity", aes(group=var, fill=type, facets=var),colour="blue1", position="identity") + facet_grid(.~var) + theme_bw() 
```

![在此处输入图像描述](../Images/a3f2ff2f9ed0a16a252b77255c25defe.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-25T22:45:51.177

我知道的唯一方法是做`geom_bar`两层，一层有蓝色，但没有图例，一层没有蓝色，但有图例：

```
ggplot(temp,aes(type, value)) + 
    geom_bar(stat="identity", aes(group=var, fill=type, facets=var),color = "blue1", position="identity",legend = "none") +
    geom_bar(stat="identity", aes(group=var, fill=type, facets=var), position="identity") +
    facet_grid(.~var) + 
    theme_bw() 
```

![在此处输入图像描述](../Images/d18296c33406de8ab7bd39ab853a4d9a.png)

推测一下，我怀疑这并不容易的原因是包作者作为设计决策，希望图例与图层中的内容完全匹配。大多数时候，你可能对这种行为很满意，但伴随着极大的便利，偶尔也会出现尴尬。

# bash - 如何同时运行多个 bash 脚本？

> ID：14531428
> 
> 赞同：2
> 
> 时间：2013-01-25T22:34:41.870
> 
> 标签：bash, unix

我正在为 Unix 课程学习 Bash，我试图弄清楚如何运行脚本，然后在第一个脚本运行时运行第二个脚本并让两者交互。为了澄清，脚本如下所示：

```
#!/bin/bash

num = 1
trap exit 0 SIGINT SIGTERM
trap "{ echo &num ; num++; }" SIGUSR1

while :
do
    sleep 2
done 
```

第二个：

```
#!/bin/bash

if ps | grep "$1" > /dev/null
then
    kill -SIGUSR1 $1
else
    echo "Process doesn't exist"
fi

exit 0 
```

如果代码不正确，一般的想法是让第一个脚本循环直到它收到 SIGINT 或 SIGTERM，并在收到 SIGUSR1 时回显并增加一个数字。第二个脚本将 pid 作为参数并检查它是否存在，并将 SIGUSR1 发送到给定进程。问题是，当我运行第一个脚本时，除非我用 ctrl-z 将它移到后台，否则我什么都做不了，但是当它在那里时，它似乎除了终止信号之外没有响应任何信号。关于如何使这项工作的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T22:51:40.063

您可以使用`mycommand &`在后台运行脚本。`Ctrl-Z`停止脚本，但您可以使用`bg`它让它在后台运行。在任何一种情况下，您都可以使用`fg`它再次将其带到前台。

另请注意，`=`in 分配周围不能有空格，您可以使用它`let num++`来增加 num。您还应该单引号中的命令`trap`，以防止 "$num" 扩展。

总而言之：

```
#!/bin/bash

num=1
trap exit 0 SIGINT SIGTERM
trap '{ echo $num ; let num++; }' SIGUSR1

while :
do
    sleep 2
done 
```

最后，您可以更轻松地通过使用来检查 pid 是否存在`kill -0 pid`，或者只是尝试 sigusr1 并检查结果，以避免 grep "123" 匹配 pid "1234" 的子字符串等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T22:51:46.387

您需要让第一个脚本在后台运行。当您按 Ctrl+Z 时，它会暂停。然后你可以输入“bg”让它在后台运行（如果它试图从标准输入读取，它会再次停止，让你用“fg”命令切换回它）。

另一种方法是在后台启动 script1，如下所示：

```
$ ./script1 & 
```

& 符号在后台启动一项工作，并立即将您返回到提示符。

查看“JOB CONTROL”下的 bash 手册页（[这里](http://linux.die.net/man/1/bash)有一份副本）以获取有关其工作原理的更多信息。从交互式 shell 处理作业的关键命令是“jobs”、“fg”和“bg”。

# unix - 在 Unix 中使用 Grep 查找 $10.00-$99.99 之间的美元值

> ID：14531431
> 
> 赞同：1
> 
> 时间：2013-01-25T22:34:57.177
> 
> 标签：unix, escaping, grep

尝试编写正确的`grep`命令来搜索文件中出现的任何美元值，范围从`$10.00`到`$99.99`. 我主要关心的是`$`符号是否需要转义`\`。到目前为止我有这个

```
grep '$[1-9][0-9]\.[0-9][0-9]' file 
```

只是想知道是否应该

```
grep '\$[1-9][0-9]\.[0-9][0-9]' file 
```

反而。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T22:37:26.613

$ 和 . 由于 . 将需要逃生。作为贪婪的字符匹配器。

# javascript - 表上的选择器 jquery

> ID：14531433
> 
> 赞同：0
> 
> 时间：2013-01-25T22:35:04.633
> 
> 标签：javascript, jquery

如何从创建动态行的表“xTable”中选择元素特定的href

```
$('#xTable >a').click(function(){

//do something
}); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-25T22:37:52.060

您需要使用`.on`特定的语法。见下文，

```
$('#xTable').on('click', 'a[href="myhref"]', function(){

    alert(this.href);
}); 
```

1.  以上称为**事件委托**方法。执行此脚本时，处理程序实际上绑定到 dom 中存在的父元素，然后 jQuery 内部过滤并仅在找到匹配的选择器时执行处理程序。

2.  要选择具有特定 href 的元素，您需要使用[属性等于选择器](http://api.jquery.com/attribute-equals-selector/)。见上面的例子。

# php - 一个mysql查询中有两个不同的限制是可能的吗？（多数组结果）

> ID：14531445
> 
> 赞同：0
> 
> 时间：2013-01-25T22:36:28.843
> 
> 标签：php, mysql

## 我的桌子

```
id Category Name
1  Sports   name1
2  Food     name2
3  Sports   name3
4  Social   name4
5  TV       name5
6  Food     name6
7  Sports   name7
8  TV       name8 
```

如您所见，每个元素名称都有一个类别，目前我的查询是：

```
SELECT * FROM interests ORDER BY category DESC; 
```

然后在 PHP 中，我会按类别分组，然后用它们各自的名称字段计算前 3 个。我想在 MySQL 中做同样的事情（如果可能的话），因为现在我有很多数据，我不想每次都查询所有表，我想将类别数量限制在前 3 和名称为 2。

我试过：`SELECT *,COUNT(*) as catnumber FROM interests GROUP BY category ORDER BY catnumber DESC`LIMIT 5 但只给我前 5 个类别，其中包含一个名称元素（如果可用，我最多需要两个类别）。所以结果应该类似于多数组结果：

```
Categories = array('Sports' => array('name1', 'name3','name7'), 'Food' => array('name2','name6'), 'TV' => array('name5','name8')) 
```

这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T00:48:37.813

您不能直接从 MySQL 查询中获取多维数组。如果我了解您的表结构和您对所需输出的描述，您可以使用以下内容近似您的数组：

```
SELECT id,
       Category,
       (SELECT 
        GROUP_CONCAT(Name SEPARATOR ',') 
        FROM interests AS sint 
        WHERE sint.Category = interests.Category) as Name,
       (SELECT 
        COUNT(Name) 
        FROM interests AS csint 
        WHERE csint.Category = interests.Category) as count
FROM interests 
GROUP BY Category
HAVING count >= 2
ORDER BY count DESC,CATEGORY
LIMIT 3 
```

这给了你这个：

```
id  Category    Name           count
1   Sports    name1,name3,name7     3
2   Food      name2,name6           2
5   TV        name5,name8           2 
```

要按照下面评论中的要求对整个表格进行排序，请使用：

```
SELECT id,
       Category,
       Name,
       (SELECT 
        COUNT(Name) 
        FROM interests AS csint 
        WHERE csint.Category = interests.Category) as count
FROM interests 
ORDER BY count DESC,Category 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T00:28:06.183

您可以使用 GROUP_CONCAT 来执行此操作并在`,`

```
SELECT `category`,
       count(id) AS entries,
       GROUP_CONCAT(NAME)
FROM `interests` l1
GROUP BY `category`
ORDER BY entries DESC LIMIT 3; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T00:18:05.320

MySQL 不会返回“多数组”结果。

但是您可以使用如下查询获得三个类别，每个类别最多两个名称：

```
SELECT c.category
     , (SELECT n1.name
          FROM interests n1
         WHERE n1.category = c.catetory
         ORDER BY n1.name
         LIMIT 0,1
       ) AS n1
     , (SELECT n2.name
          FROM interests n2
         WHERE n2.category = c.catetory
         ORDER BY n2.name
         LIMIT 1,1
       ) AS n2
  FROM ( SELECT t.category
              , COUNT(1) AS cnt
           FROM interests t
          GROUP BY t.category
          ORDER BY cnt DESC
              , t.category
          LIMIT 3
       ) c 
```

那应该返回一个像这样的结果集：

```
    类别 n1 n2
    -------- ---- ----
    运动名称1 名称3
    食物名称2名称6
    电视名称5 name8

```

也可以在不同的行上获取名称，但查询要复杂一些：

```
SELECT c.category
     , CASE WHEN i.i = 1 THEN 
       (SELECT n1.name
          FROM interests n1
         WHERE n1.category = c.catetory
         ORDER BY n1.name
         LIMIT 0,1
       ) ELSE
       (SELECT n2.name
          FROM interests n2
         WHERE n2.category = c.catetory
         ORDER BY n2.name
         LIMIT 1,1
       ) END AS `name`
  FROM ( SELECT t.category
              , COUNT(1) AS cnt
           FROM interests t
          GROUP BY t.category
          ORDER BY cnt DESC
              , t.category
          LIMIT 3
       ) c
 CROSS
  JOIN (SELECT 1 AS i UNION ALL SELECT 2) i
 ORDER BY c.cnt DESC, t.category, i.i 
```

为避免返回 NULL 值，可以在 ORDER BY 之前添加 HAVING 子句

```
HAVING n IS NOT NULL 
```

那应该返回：

```
    n 类
    -------- ----
    运动名称1
    运动名称3
    食品名称2
    食品名称6
    电视名称5
    电视名称8

```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-26T02:33:54.793

尝试这个：

```
 SELECT a.category, SUBSTRING_INDEX(GROUP_CONCAT(distinct(a.NAME)   SEPARATOR ', '),",",2) AS `Top names`
    FROM MyTable AS A JOIN 
        (SELECT category 
        FROM MyTable 
        GROUP BY category 
        ORDER BY count(category) DESC 
        LIMIT 3) AS C
    ON A.category = C.category 
    GROUP BY a.category 
    ORDER BY  count(a.category) DESC, count(A.name)  DESC ; 
```

[SQL FIDDLE 演示](http://www.sqlfiddle.com/#!2/bfcc53/1)

类别顶部大小当前为 3，名称的顶部大小当前为 2。通过更改值，您可以调整顶部的大小。请注意，当类别和名称抽签时，不会显示第二个类别或名称。

# xcode - 在配置设置中使用 .xcconfig 文件的路径

> ID：14531447
> 
> 赞同：3
> 
> 时间：2013-01-25T22:36:35.567
> 
> 标签：xcode, macos, configuration, settings

我想使用 .xcconfig 文件为我的项目加载一些预定义的设置，主要是我要链接的库、附加的链接器路径和头文件搜索路径。我正在寻找一种解决方案，我可以使用 xcconfig 文件的路径并从那里添加相对路径。

所以像：

```
HEADER_SEARCH_PATHS=$(CURRENT_PATH)/../includes/ 
```

`$(CURRENT_PATH)`xcconfig 文件的路径在哪里。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T00:44:32.767

.xcconfig 文件的路径不会作为配置设置公开。这样做不符合 Xcode 配置设置的当前评估模型。

# jquery - 使用 SignalR 检测“服务器离线”

> ID：14531450
> 
> 赞同：5
> 
> 时间：2013-01-25T22:36:47.003
> 
> 标签：jquery, asp.net-mvc, signalr

我们正在尝试在低带宽环境中使用 SignalR，在该环境中与后端服务器的连接可以随机进出，并且我们希望我们的 Web 应用程序能够做出适当的响应。

看起来这个连接 API 在过去一年中一直在变化，但根据最新的文档，我尝试连接到 $.connection.hub.stateChanged 以检测连接状态的变化，我得到了一些点击启动时客户端从断开连接 -> 连接 -> 连接，但是当我停止服务器时，事件处理程序不会触发，当我再次启动服务器时，实时消息传递不再起作用。

为了测试这个场景，我在 Windows 7 上运行 IIS 中的 ASP.NET Web 服务器，Web 客户端在 Google Chrome 中运行。一旦站点运行并交换消息，我在 IIS 中终止该网站，消息停止但客户端没有收到任何通知。

这是一个快速片段（使用 TypeScript）：

```
$.connection.hub.stateChanged((change) => {
   console.log("state changed...");
   console.log(change);

   if (change.newState === $.signalR.connectionState.reconnecting) {
      this.raise('action:disconnected');
   }
   else if (change.newState === $.signalR.connectionState.connected) {
      this.raise('action:connected');
   }
}); 
```

任何指导将不胜感激，谢谢！

-杰里米

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-26T19:16:33.647

您使用的是什么版本的 SignalR？在最新的（和之前的）中，立即检测到服务器离线，并使用重新连接标志引发状态更改。

要杀死服务器，我假设您的意思是关闭 IIS。例如 iisreset。在 inetmgr 中停止网站*不会*关闭网站，它只是删除该端口的 Http.sys 绑定。有关更多信息，请参阅[https://github.com/SignalR/SignalR/issues/1148](https://github.com/SignalR/SignalR/issues/1148)。

如果要模拟服务器宕机，请杀死 w3wp。

# delphi - 使用 Indy 测试代理

> ID：14531451
> 
> 赞同：1
> 
> 时间：2013-01-25T22:36:54.473
> 
> 标签：delphi, testing, proxy, delphi-xe2, indy

我广泛依赖 Indy 10 下载/上传文件（通过 https 发送）

我的代码如下所示（我使用的是**Delphi XE2**）：

```
IdHTTP               := TIdHTTP.Create(nil);

with IdHTTP do
begin
     HTTPOptions     := [hoForceEncodeParams, hoNoParseMetaHTTPEquiv];
     AllowCookies    := True;
     HandleRedirects := True;
     ProtocolVersion := pv1_1;

     IOHandler       := ASSL;
     Compressor      := ACompressor;
     CookieManager   := ACookieManager;

{$ifdef DebugProxy}
     ProxyParams.ProxyServer := '127.0.0.1';
     ProxyParams.ProxyPort   := 8888;
{$else}
     if (TheProxyServer <> '') then
     begin
          with ProxyParams do
          begin
               ProxyServer   := TheProxyServer;    // DNS name of the proxy server or its IP address
               ProxyPort     := TheProxyPort;      // Port the HTTP the HTTP proxy listens on
               ProxyUsername := TheProxyUsername;  // Username if the proxy requires authentication
               ProxyPassword := TheProxyPassword;  // Password if the proxy requires authentication
          end;    // with
     end;
{$endif} 
```

TheProxy** ***** *****变量全部由最终用户定义。

我需要确保我的应用程序适用于各种代理设置，但我对代理几乎一无所知:(

我怎样才能做到这一点？在本地设置代理是否足够（或使用 Fiddler 之类的东西，或针对[IE / WinInet 中定义的代理信息进行](http://www.scalabium.com/faq/dct0161.htm)测试），在本地测试说我很好？公司/用户是否使用某种流行/事实上的标准代理工具？（我的应用程序针对消费者和企业）

**PS。这是一个严重的问题！**虽然我远非新手，但我几乎*从不需要*处理代理（除了可能一到两次，很久以前，足以忘记它的一切）

# css - 为什么div不能显示在中心？

> ID：14531453
> 
> 赞同：-2
> 
> 时间：2013-01-25T22:37:17.520
> 
> 标签：css

我尝试了以下代码：

```
#my_div {
    margin-left: auto;
    margin-right: auto;
    width:700px;
    background-color:red;
} 
```

[代码](http://jsfiddle.net/kwcSc/)

据我所知，margin-left 和 margin-right 设置为 auto 将使 div 居中。但它怎么不这样工作呢？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T22:39:31.833

确实如此，您只需要确保您的窗口宽度超过 700 像素即可。这是一个宽度为 200px 的工作示例：

```
#my_div {
    margin-left: auto;
    margin-right: auto;
    width:200px;
    background-color:red;
} 
```

[JSFiddle](http://jsfiddle.net/kaygee79/8QEkE/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T22:41:07.493

这可能是一个特异性问题。尝试将 !important 添加到您的声明中：

```
#my_div {
    margin-left: auto !important;
    margin-right: auto !important;
    width:700px;
    background-color:red;
} 
```

# jquery - Chrome 中的 Nicescroll touchbehavior 错误

> ID：14531454
> 
> 赞同：0
> 
> 时间：2013-01-25T22:37:19.883
> 
> 标签：jquery, google-chrome

我有一个非常基本的 nicescroll 实现，如下所示：

```
 <script src="../javascript/jquery-1.8.3.min.js" type="text/javascript"></script>
 <script src="../javascript/jquery.nicescroll3.min.js" type="text/javascript"></script>

 <script type="text/javascript">
     $(function () {
         $("#scrolldiv").niceScroll({touchbehavior:true});
     });
 </script>

</head>
<body>
    <form id="form1" class="input-form" runat="server">
        <asp:ScriptManager ID="thescriptmanager" runat="server"/>
        <div id="scrolldiv" style="height:200px;width:200px;">
            ..long content..
        </div>
    </form>
</body> 
```

问题是“投掷”功能在 Chrome 24 中不再起作用（拖动和释放以逐渐停止。）而是突然停止。它曾经在我开始开发时工作，后来我升级到 jquery 1.8 和 nicescroll 3.0。它可以在 IE、FF 和 Safari 中正常工作。我尝试重新启动并重新安装 Chrome 无济于事。有没有其他人经历过这种情况或知道会发生什么？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-31T21:39:54.930

如果其他人有这个问题，我可以通过卸载 Chrome，重新启动，然后重新安装来解决这个问题。在顶部重新安装不起作用！

# mysql - MySQL：从多个表连接时重复值

> ID：14531457
> 
> 赞同：1
> 
> 时间：2013-01-25T22:37:34.267
> 
> 标签：mysql, sql, database, left-join

我正在尝试从我的数据库中获取一些新闻文章，并使用它获取相关项目。数据库结构如下所示：

```
news               (id, article        )
newsItemsRelation  (id, newsId,  itemId)
newsAuthorRelation (id, newsId,  userId)
items              (id, itemTitle      ) 
```

然后我还有一个项目表和用户数据表。

当我运行下面的查询时，如果我有同一篇文章的多个作者，我会得到重复的项目，如果我有同一篇文章的多个项目，我会得到重复的作者。

```
SELECT
        article,
        GROUP_CONCAT(name) AS author,
        GROUP_CONCAT(itemTitle) AS item
    FROM news
    LEFT JOIN newsItemsRelation ON
        newsItemsRelation.newsId = news.id
    LEFT JOIN items ON
        items.id = newsItemsRelation.itemId
    LEFT JOIN newsAuthorsRelation ON
        newsAuthorsRelation.newsId = news.id
    LEFT JOIN profiles ON
        profiles.id = newsAuthorsRelation.userId
    GROUP BY news.id 
```

**编辑 1**

我的结果如下所示：

文章：文章在这里

作者：沃尔特·怀特、德克斯特·摩根、沃尔特·怀特、德克斯特·摩根

项目：绝命毒师，德克斯特，绝命毒师，德克斯特

**编辑 2**

做`GROUP_CONCAT(DISTINCT name)`OR`GROUP_CONCAT(DISTINCT itemTitle)`并不能解决我的问题，因为多个项目可以具有相同的 itemTitle 但不同的 ID。作者也是如此。这意味着我的结果可能看起来像“Dexter，Dexter”，但现在看起来像“Dexter，Dexter，Dexter，Dexter”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T23:39:06.460

您的问题是您的项目和您的作者之间没有关联。因此，对于每个作者和每个项目，您都会得到重复的结果。

尝试这样的事情：

```
 SELECT
        article,
        author,
        item
    FROM news
    LEFT JOIN (
      SELECT 
           News.Id as NewsId,
           GROUP_CONCAT(itemTitle) AS item
       FROM news
       LEFT JOIN newsItemsRelation ON
           newsItemsRelation.newsId = news.id
       LEFT JOIN items ON
           items.id = newsItemsRelation.itemId
       GROUP BY News.Id
      ) items on news.Id = items.NewsId
    LEFT JOIN (
       SELECT 
           News.Id as NewsId,
           GROUP_CONCAT(Name) AS Author
       FROM news
       LEFT JOIN newsAuthorsRelation ON
           newsAuthorsRelation.newsId = news.id
       LEFT JOIN profiles ON
           profiles.id = newsAuthorsRelation.userId
       GROUP BY News.Id
      ) Authors on news.Id = Authors.NewsId 
```

还有[SQL 小提琴](http://sqlfiddle.com/#!2/90fa0/12)。

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T22:40:24.763

尝试按文章分组并对名称进行 DISTINCT

```
SELECT
        article,
        GROUP_CONCAT(DISTINCT name) AS author,
        GROUP_CONCAT(DISTINCT itemTitle) AS item
    FROM news
    LEFT JOIN newsItemsRelation ON
        newsItemsRelation.newsId = news.id
    LEFT JOIN items ON
        items.id = newsItemsRelation.itemId
    LEFT JOIN newsAuthorsRelation ON
        newsAuthorsRelation.newsId = news.id
    LEFT JOIN profiles ON
        profiles.id = newsAuthorsRelation.userId
    GROUP BY article 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-25T23:32:39.990

当我遇到这个问题时，我所做的就是使查询成为子查询并从那里过滤。另一种方法是列子查询方法（讨厌这种方法，因为它非常昂贵）。

# c# - iOS：缺少 Bar Style 外观的 Monotouch 绑定？

> ID：14531463
> 
> 赞同：4
> 
> 时间：2013-01-25T22:38:15.403
> 
> 标签：c#, iphone, ios, xamarin.ios, uinavigationbar

我正在尝试将其转换为 Monotouch C#：

```
[[UINavigationBar appearance] setBarStyle:UIBarStyleBlackOpaque]; 
```

但是在外观对象上似乎没有条形样式。

是否有解决方法或替代接入点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-25T23:00:42.307

此属性`UI_APPEARANCE_SELECTOR`在 Objective-C 头文件中没有修饰。最初的 MonoTouch 外观工作基于该文档（但随着时间的推移我们添加了更多案例）。

然而，Apple 实现它的外观支持的方式允许许多*未记录*的东西可以工作（如果 Apple 改变它的内部表示，希望继续工作）。

无论如何，这意味着您可以稍微解决一下这个问题，例如通过执行以下操作：

```
IntPtr handle = UINavigationBar.Appearance.Handle;
var appearance = new UINavigationBar (handle);
appearance.BarStyle = UIBarStyle.BlackOpaque; 
```

# iphone - iOS中的路由跟踪模拟

> ID：14531468
> 
> 赞同：2
> 
> 时间：2013-01-25T22:38:34.163
> 
> 标签：iphone, ios, maps, simulation

我正在沿着在 iOS 中绘制的路线移动地图注释，但我希望它遵循为方向提供的路径。所以要清楚，我想要模拟用户沿着地图的路线而不实际做路线。我试过做研究，是的，我看过面包屑教程，但我真的不确定如何按照描述的路线走。有没有办法将路线分解为点/数据？

任何帮助或链接表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T22:58:54.267

沿坐标数组更改注释的坐标并为其设置动画。但这要求您将“路线”作为坐标序列。您不会获得作为坐标的苹果路线。
您可以使用`OpenStreetMap`获取基于矢量的路线（坐标）。

# vb.net - VbMyResourcesResXFileCodeGenerator 生成 System.OutOfMemoryException

> ID：14531470
> 
> 赞同：0
> 
> 时间：2013-01-25T22:38:44.873
> 
> 标签：vb.net, visual-studio-2010, build, resources, out-of-memory

最近我的 VB.Net 项目在构建时失败了，引发了一个对话框（大约）：

```
External Tool: VbMyResourcesResXFileCodeGenerator failed due to a System.OutOfMemoryException 
```

我将这个问题和答案作为公共服务发布给未来有同样问题的搜索者 - 特别是因为它不容易弄清楚。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T22:45:29.120

寻找解决问题的线索将我引向这个问题：[Visual Studio 2010 - (OutOfMemoryException) & (Memory increase in Ideal State)](https://stackoverflow.com/a/14337772/149060) - 以及尝试使用[解决方案负载管理器](http://visualstudiogallery.msdn.microsoft.com/66350dbe-ed01-4120-bea2-5564eff7b0b2/)以减少内存使用的建议。仅加载失败的项目后，在启动 VS2010 后，我可以从解决方案资源管理器上下文菜单中成功地对 resx 文件执行“运行自定义工具”，然后构建应用程序。

然而，不久之后，构建开始默默地失败，就像这张海报的情况一样：[Visual Studio 2010 IDE 构建神秘地失败，没有错误或警告](https://stackoverflow.com/questions/11277841/visual-studio-2010-ide-build-fails-mysteriously-with-no-errors-or-warnings?lq=1) 在对他问题的评论中，我找到了我的救赎：

> 您必须转到 Visual Studio 选项对话框并导航到项目和解决方案 | 构建并运行。将 MSBuild 项目构建输出详细程度更改为详细或诊断，然后分析输出。这应该给你暗示什么是根本原因。

一旦我这样做了，我就可以再次看到无法构建 resource.resx 文件。

最终的问题是一个被遗忘的文件资源。我之前将一个文件作为资源嵌入，随后通过添加几个屏幕截图显着增加了该文件的大小。尽管我不再在代码中使用该文件，但我并没有将其作为项目资源删除。正是这个文件的大小最终导致了`System.OutOfMemoryException`我看到的构建失败。一旦我从资源中删除了文件，就可以按预期构建解决方案。

# perl - 将由 < > 分隔的子字符串分配给数组

> ID：14531476
> 
> 赞同：0
> 
> 时间：2013-01-25T22:39:24.127
> 
> 标签：perl

是否可以将由 . 分隔的文本块的部分分配给数组`< >`。例如，

```
sometexthere <email@email.com> more text
more text moretext <another@email.com> 
```

应该产生

```
@array = qw(email@email.com another@email.com); 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T22:42:00.517

```
my @array = $text =~ /<([^<>]+)>/g; 
```

# ruby-on-rails-3 - 是否有用于关联一致性的 ActiveModel 验证

> ID：14531479
> 
> 赞同：0
> 
> 时间：2013-01-25T22:39:36.870
> 
> 标签：ruby-on-rails-3, validation, activemodel

举例：

*   A`Place`属于`User`。
*   一个`Event`属于一个`User`。
*   An`Event`属于（但不是必须拥有） a `Place`。

我想验证 an总是与`Event`它本身相同。`Place``User``Place`

这种形式的验证似乎相当普遍，但我总是最终编写自己的验证器。为了完整起见，我将在下面包含我的版本，但我觉得应该有一个约定。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T22:45:10.943

如果 an`Event` *总是*与 相同`User`，`Place`也许您应该像这样对关联进行建模：

```
User
  has_many :places
  has_many :events, through: :places

Place
  has_many :events
  belongs_to :user

Event
  belongs_to :place
  has_one :user, through: :place 
```

那么你不需要验证；协会的结构免费强制执行。

**更新**：虽然`Place`是可选的，但我仍然会像这样构建关联！听起来您可能想要打破[Null Object](http://en.wikipedia.org/wiki/Null_Object_pattern)模式。有几种方法可以实现它；也许[单表继承](http://api.rubyonrails.org/classes/ActiveRecord/Base.html#label-Single+table+inheritance)是合适的。

本质上，您将创建一个子类`NullPlace < Place`，它会有一些特殊的行为（它`name`可能是一些占位符，如“未指定”），但就关联而言，它的行为就像一个常规的`Place`，所以不需要验证！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T22:39:36.870

在我的`Event`模型里面：

```
validate :user_consistency

def user_consistency
  errors.add :place, 'must belong to same user as event' unless place.nil? or place.user == user
end 
```

# python - 了解python中的lambda函数

> ID：14531483
> 
> 赞同：1
> 
> 时间：2013-01-25T22:40:00.690
> 
> 标签：python, function, lambda

我是 python 新手，我创建了一个脚本来对来自 cisco 路由器的“显示 IP 记帐”信息进行排序。该脚本读取一个文件并将每一行分解为一个列表，然后创建每行的列表。所以我最终得到了一个列表列表：

```
list a = [[192.168.0.1,172.16.0.1,3434,12222424],[192.168.2.1,172.12.0.1,33334,12667896722424]] 
```

我希望能够按列表中列表的第三列或第四列进行排序。

我可以使用 lambda 函数来做到这一点，但我的问题是如何使用标准函数来复制它？

这是我的代码如下：

```
from sys import argv

script, option, filename = argv
a=[]
b=[]

def openfile(filename):
  file = open(filename)
  for line in file:
    if not line.startswith("  "):
      a.append((line.split()))
  return a

def sort(a,num):
  b = sorted(a, reverse=True, key=lambda x: int(x[num]))
  return b

def top5(b):
  print "Source     Destination Packets     Bytes"
  for i in b[:4]: 
    print i[0]+"    "+i[1]+"    "+i[2]+"        "+i[3]

def main(option):
  a = openfile(filename)
  if option == "--bytes":
    b = sort(a,3)
    top5(b)
  elif option == "--packets":
    b = sort(a,2)
    top5(b)
  else:
    print """
    Not a valid switch, 
    --bytes to sort by bytes 
    --packets to sort by packets."""

main(option) 
```

所以我的问题是如何将 lambda 函数复制为标准的自定义排序函数？我试图弄清楚这是如何工作的。

`b = sorted(a, reverse=True, **key=lambda x: int(x[num])**)`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T22:41:26.040

> 如何将 lambda 函数复制为标准自定义排序函数？

你是这个意思吗：

```
def sort(a, num):
  def key(x):
    return int(x[num])
  return sorted(a, reverse=True, key=key) 
```

或者这个：

```
from functools import partial

def key(num, x):
  return int(x[num])

def sort(a, num):
  return sorted(a, reverse=True, key=partial(key, num)) 
```

?

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T22:49:35.507

Python 提供了[operator.itemgetter](http://docs.python.org/2/library/operator.html#operator.itemgetter)来做这种事情：

```
def sort(a, num):
    return sorted(a, reverse=True, key=operator.itemgetter(num)) 
```

编辑

正如@NPE 指出的那样，这不会将键转换为`int`用于排序的键。为此，您最好坚持使用 lambda。

# iphone - 故事板上的 ZXing 图书馆

> ID：14531485
> 
> 赞同：4
> 
> 时间：2013-01-25T22:40:18.210
> 
> 标签：iphone, ios, ios6, zxing

首先，我是 IOS 新手，并尝试在我的一个项目中使用 ZXing 库，但我使用的是故事板和自动内存管理。所以我很难转换库源代码附带的示例测试代码。

我已经完成了将库包含到我的项目中的步骤，但我真的不知道如何使用该库。我试图转换库附带的示例代码，但它没有自动内存管理，也没有情节提要。我不熟悉 .xib 文件，因此转换效果不佳。有没有什么地方可以找到用于自动内存管理和情节提要的示例代码？或者，如果有人可以帮助我进行转换，那就太好了。我试图这样做两天，但仍然在同一点。

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-24T02:13:03.363

我遇到了同样的问题，但我发现了一个更好、更容易实现的条码和二维码扫描库，名为 ZBar，请查看[http://zbar.sourceforge.net/download.html](http://zbar.sourceforge.net/download.html) :)

# php - .htaccess 重写规则忽略 GET

> ID：14531490
> 
> 赞同：0
> 
> 时间：2013-01-25T22:40:37.760
> 
> 标签：php, apache, .htaccess, mod-rewrite, url-rewriting

我有重写规则：

```
RewriteRule ^ajax/favourite/([^/]*)$ ajax/favourite/user/index.php?user=$1 [L] 
```

哪个工作正常，但这条规则：

```
RewriteRule ^ajax/favourite/remove/([^/]*)$ ajax/favourite/remove/index.php?user=$1 [L] 
```

始终将 index.php 作为链接中的用户返回。我已经测试了 ?user 正在设置，即使 URL 是 ../remove/username 它也不会将用户名显示为 ?user 信息，它会显示“index.php”。

我不明白为什么这不能像以前一样工作，除了一个目录，它工作正常。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T22:49:06.177

我建议将您的重写更改为：

```
RewriteRule ^/ajax/favourite/([^/]+)$ /ajax/favourite/user/index.php?user=$1 [L]

RewriteRule ^/ajax/favourite/remove/([^/]+)$ /ajax/favourite/remove/index.php?user=$1 [L] 
```

请注意**，我`/`在您的正则表达式前面**`*`添加了一个，并在反向引用中进行了更改`+`，因为在这两者中，您都应该期望至少有一个字符作为用户名。

我还可以建议，如果您无法弄清楚为什么您的重写规则没有按预期工作，您可以在 apache 配置中启用重写日志。您的虚拟主机应该是放置此内容的最佳位置：

```
RewriteLogLevel 9
RewriteLog /var/log/http/yourserver.log 
```

重写日志将向您显示 apache 在请求处理期间采取的所有假设和操作。你会看到你的重写规则到底有什么问题。

**请注意，此日志应在生产中禁用。**

我还在我的环境中复制了您的案例，这是您应该在正确匹配重写规则时看到的日志：

```
(2) init rewrite engine with requested uri /ajax/favourite/remove/provola
(3) applying pattern '^/ajax/favourite/([^/]+)$' to uri '/ajax/favourite/remove/provola'
(3) applying pattern '^/ajax/favourite/remove/([^/]+)$' to uri '/ajax/favourite/remove/provola'
(2) rewrite '/ajax/favourite/remove/provola' -> '/ajax/favourite/remove/index.php?user=provola'
(3) split uri=/ajax/favourite/remove/index.php?user=provola -> uri=/ajax/favourite/remove/index.php, args=user=provola
(2) local path result: /ajax/favourite/remove/index.php
(2) prefixed with document_root to /opt/local/apache2/htdocs/ajax/favourite/remove/index.php
(1) go-ahead with /opt/local/apache2/htdocs/ajax/favourite/remove/index.php [OK] 
```

**更新**

那么为什么你的配置有如此奇怪的行为（工作与否）？如果没有更多信息（即您的暂定的完整重写日志），我无法给出答案。

一开始我还没有得到这个，你的配置（第一个问题和第二个评论）都不能工作，因为它们`/`在每个重写前面都错过了一个。

这个假设的证据在 rewrite log 中，在第四行，有一个成功的匹配。`/`如果没有第一个重写模式，该匹配是不可能的。从这一点开始，所有剩余的日志行都描述了成功匹配的行为。

# hadoop - 替换 HDFS Hadoop

> ID：14531491
> 
> 赞同：2
> 
> 时间：2013-01-25T22:40:40.520
> 
> 标签：hadoop, hdfs

用其他 NoSQL 数据库替换 hadoop 中的 HDFS 需要付出什么努力。这涉及到多少工作？有没有人有任何好的维基或描述它的链接？是否像为该数据库实现 FileSystem 接口一样简单？

我发现了几篇关于其他人如何修改 hadoop 以生成自定义发行版的文章，但还没有找到替换 HDFS 的指南。

谢谢， 帕思

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T07:34:29.177

实现自己的 DFS 接口并使其与 hadoop 一起工作相对简单。您所需要的只是文件和目录的文件系统概念与您的存储之间的某种逻辑映射。
在 NoSQL 的情况下（如果我假设 KeyValue），您应该决定如何表示目录。您可以做一些特殊的节点，也可以将路径放入键中。
另一个决策点 - 决定您是否关心数据局部性
关于文档，我认为 s3n DFS 实现的来源是最好的起点。
我认为关闭的例子是 DataStax [http://www.datastax.com/](http://www.datastax.com/)
完成的 Hadoop over Cassandra 另一个例子（我们最近做过的事情）是 hadoop 与 OpenStack Swift 的集成。 [http://bigdatacraft.com/archives/349](http://bigdatacraft.com/archives/349)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-26T13:57:26.537

实际上不久前我就这样做了，因为 HDFS 上存在磁盘空间限制，这限制了我们的备份和存储策略，所以我们讨论了使用 S3N 作为 HDFS 的替代品，看起来这是一个非常标准的操作。

您需要在 hadoop-site.xml 或 hdfs-site.xml 中添加以下属性：

```
<property>
  <name>fs.default.name</name>
  <value>s3://BUCKET</value>
</property>

<property>
  <name>fs.s3.awsAccessKeyId</name>
  <value>ID</value>
</property>

<property>
  <name>fs.s3.awsSecretAccessKey</name>
  <value>SECRET</value>
</property> 
```

[您可以在此处](http://wiki.apache.org/hadoop/AmazonS3)找到有关设置的更多详细信息。需要注意的一件有趣的事情是，由于在这种情况下数据存储在 Amazon S3 上，因此需要获取它，因为它不再是本地的，但是对性能的影响似乎并不像我最初担心的那样显着。

我没有尝试过但你绝对应该寻找 HDFS 的替代品的东西是[QFS](http://quantcast.github.com/qfs/) fron Quantcast，我听说过一些好东西，基准测试似乎使它比 HDFS 更快。

# c - C 执行管道： execlp 有效，而 execvp 无效

> ID：14531495
> 
> 赞同：0
> 
> 时间：2013-01-25T22:41:06.743
> 
> 标签：c, exec, fork, pipe, gnu

有人可以向我解释为什么这会产生正常行为（ls | cat）

```
int fd[2]; pipe(fd);
pid_t pid = fork();
if(pid > 0) {
    close(fd[0]);
    close(STDOUT_FILENO);
    dup2(fd[1],STDOUT_FILENO);
    execlp("ls","ls",NULL);
} else if (pid == 0) {
    close(fd[1]);
    close(STDIN_FILENO);
    dup2(fd[0],STDIN_FILENO);
    execlp("cat","cat",NULL);
} else {
    error(1, errno, "forking error");
} 
```

但是当我将 execlp 更改为 execvp 突然没有输出并且退出状态为 255 时？代码：

```
int fd[2]; pipe(fd);
pid_t pid = fork();
if(pid > 0) {
    close(fd[0]);
    close(STDOUT_FILENO);
    dup2(fd[1],STDOUT_FILENO);
    char **args = {"ls", NULL};
    execvp("ls",args);
} else if (pid == 0) {
    close(fd[1]);
    close(STDIN_FILENO);
    dup2(fd[0],STDIN_FILENO);
    char **args = {"cat", NULL};
    execvp("cat",args);
} else {
    error(1, errno, "forking error");
} 
```

我真的很想使用 execvp 因为我将使用可变长度的 arg 列表执行命令。帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T22:48:07.170

`char **args = {"ls", NULL};`应该是`char *args[] = {"ls", NULL};`，并且对于第二个`args`（对于`cat`）相同。

（这里太晚了，所以我想不出第一个*编译*的原因。至少它给出了警告）。

# ios - 表格单元格中的 segue 每次都会被调用

> ID：14531500
> 
> 赞同：2
> 
> 时间：2013-01-25T22:41:53.437
> 
> 标签：ios, tableview, segue, uistoryboardsegue

我有一个 tableview，我在它的单元格中插入了一个 segue。我想给定一个条件，启用或禁用单元格。

这是我里面的代码`didSelectRowAtIndexpath`

```
if (condition) {
    NSLog(@"Nothing);
} else {
    [self performSegueWithIdentifier:@"segueName" sender:tableView];
} 
```

但是 segue 每次都会被调用，即使我确实看到了`NSLog`打印。

这里的一些答案说我应该将segue放在视图控制器中，但在情节提要中我不能这样做，我只能将它放入单元格中。

我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T22:46:30.817

您是否也有从单元格到界面生成器中的下一个场景的转场？如果是这样，无论做什么，都会调用`didSelectRowAtIndexPath`它。

有两种可能的方法：

1.  如果iOS 6-only，你可以`didSelectRowAtIndexPath`完全消除，在单元格和下一个场景之间放置segue，然后实现[`shouldPerformSegueWithIdentifier`](http://developer.apple.com/library/ios/documentation/uikit/reference/UIViewController_Class/Reference/Reference.html#//apple_ref/occ/instm/UIViewController/shouldPerformSegueWithIdentifier:sender:)并将你的条件逻辑放在那里，例如

    ```
    - (BOOL)shouldPerformSegueWithIdentifier:(NSString *)identifier sender:(id)sender
    {
        if ([identifier isEqualToString:@"segueName"])
        {
            if (condition)
                return NO;
        }
        return YES;
    } 
    ```

2.  如果您需要与 iOS 5 兼容，您应该删除单元格和下一个场景之间的 segue，但让它在视图控制器之间移动（即，您`control`- 从场景底部栏中的第一个视图控制器图标拖动到下一个场景）。这样，segue 被定义，但没有连接到单元格。您`didSelectRowAtIndexPath`可以使用您在问题中建议的条件逻辑：

    ![场景之间的切换](../Images/2608762740048e70008303c75791e0bb.png)

# jquery - 结合 jQuery ui 日期选择器和同位素数据过滤器

> ID：14531504
> 
> 赞同：0
> 
> 时间：2013-01-25T22:42:05.490
> 
> 标签：jquery, html, jquery-isotope

我目前正在使用 jQuery ui datepicker，我试图弄清楚是否可以将日历与同位素插件，更具体地说是数据过滤器结合起来，即从 datepicker 中选择一个日期并过滤掉相关事件（在该日期）。
这是我的一些html：

```
<div id="datepicker"></div>

<div id="block-wrap">
    <div class="blocks">1</div>
    <div class="blocks">3</div>
    <div class="blocks">2</div>
    <div class="blocks">2</div>
    <div class="blocks">3</div>
    <div class="blocks">1</div>
    <div class="blocks">3</div>
    <div class="blocks">2</div>
    <div class="blocks">1</div>    
</div> 
```

[这里也是关于 jsfiddle 的工作演示](http://jsfiddle.net/Deqvz/3/)
那么是否可以使用 datepicker 过滤掉编号的块？
任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T23:05:47.753

我确实又看了一遍。

您可以使用 datepicker 的[**onSelect()**](http://api.jqueryui.com/datepicker/#option-onSelect)方法并附上这个：

```
onSelect: function (dateText, inst) {
  var date = $(this).datepicker('getDate');
  //var dayValue = date.getDate(); // or
   var dayValue = inst.selectedDay;

  $blocks.show();

  $blocks.filter(function () {
    if (this.innerHTML != dayValue) {
      $(this).hide();
    }
  });
} 
```

您可以使用第一个函数参数来保存您单击的日期的字符串版本，或者您可以使用第二个参数，它是 datepicker 对象的实例，具有日期元素的有用属性值。

* * *

[**DEMO 01**](http://jsfiddle.net/gEzNE/) - 仅显示与日历中单击的数字匹配的框

* * *

我玩了一下，`filter`同位素的选项必须是一个选择器。据我所知，您无法生成 jQuery 选择器询问值或 innerHTML。

但是，您可以为每个包含相同值的块添加自定义属性，类似于：

```
<div class="blocks" data-value="1">1</div>
<div class="blocks" data-value="3">3</div>
<div class="blocks" data-value="2">2</div> 
```

`filter`现在，您可以为 datepicker的方法中的生成一个有效的选择`OnSelect`器，如下所示：

```
onSelect: function (dateText, inst) {
  var date = $(this).datepicker('getDate');
  var dayValue = inst.selectedDay;

  $container.isotope({
    filter: '[data-value="' + dayValue + '"]'
  });
} 
```

* * *

[**DEMO 02**](http://jsfiddle.net/YcnEB/) - 使用数据属性将日期选择器连接到同位素过滤器

* * *

在链接腐烂的情况下来自演示的代码：

* * *

**DEMO-01：HTML**

```
<div id="datepicker"></div>
<div id="block-wrap">
  <div class="blocks">1</div>
  <div class="blocks">3</div>
  <div class="blocks">2</div>
  <div class="blocks">2</div>
</div> 
```

**DEMO-01：脚本**

```
var $blocks = $("div.blocks", "#block-wrap");

$(function () {
  $('#datepicker').datepicker({
    inline: true,
    //nextText: '&rarr;',
    //prevText: '&larr;',
    showOtherMonths: true,
    //dateFormat: 'dd MM yy',
    dayNamesMin: ['S', 'M', 'T', 'W', 'T', 'F', 'S'],
    //showOn: "button",
    //buttonImage: "img/calendar-blue.png",
    //buttonImageOnly: true,
    onSelect: function (dateText, inst) {
      var date = $(this).datepicker('getDate');
      var dayValue = date.getDate();

      $blocks.show();

      $blocks.filter(function () {
        if (this.innerHTML != dayValue) {
          $(this).hide();
        }
      });
    }
  });
});

var $container = $('#block-wrap');

$container.imagesLoaded(function () {
  $container.isotope({
    itemSelector: '.blocks',
    animationEngine: 'css',
    masonry: {
      columnWidth: 5
    }

  });
}); 
```

**DEMO-02：HTML**

```
<div id="datepicker"></div>
<div id="block-wrap">
  <div class="blocks" data-value="1">1</div>
  <div class="blocks" data-value="3">3</div>
  <div class="blocks" data-value="2">2</div>
  <div class="blocks" data-value="2">2</div>
  <div class="blocks" data-value="1">1</div>
</div> 
```

**DEMO 02 - 脚本（与 DEMO 01 脚本相比，仅 onSelect 发生了变化）**

```
onSelect: function (dateText, inst) {
  var date = $(this).datepicker('getDate');
  var dayValue = inst.selectedDay;
  $container.isotope({
    filter: '[data-value="' + dayValue + '"]'
  });
} 
```

**两个演示的 CSS 相同**

```
#datepicker {
  position: absolute;
  left: 5px;
  top: 5px;
  z-index: 9999;
}
#block-wrap {
  position: absolute;
  padding-left: 230px;
  top: 10px;
  width: auto;
}
.blocks {
  position: relative;
  width: 40px;
  height: 40px;
  background-color: silver;
  float: left;
  margin-right: 5px;
  margin-bottom: 5px;
}
.isotope-item {
  z-index: 2;
}
.isotope-hidden.isotope-item {
  z-index: 1;
}
.isotope, .isotope .isotope-item {
  /* change duration value to whatever you like */
  -webkit-transition-duration: 0.5s;
  -moz-transition-duration: 0.5s;
  -ms-transition-duration: 0.5s;
  -o-transition-duration: 0.5s;
  transition-duration: 0.5s;
}
.isotope {
  -webkit-transition-property: height, width;
  -moz-transition-property: height, width;
  -ms-transition-property: height, width;
  -o-transition-property: height, width;
  transition-property: height, width;
}
.isotope .isotope-item {
  -webkit-transition-property: -webkit-transform, opacity;
  -moz-transition-property: -moz-transform, opacity;
  -ms-transition-property: -ms-transform, opacity;
  -o-transition-property: -o-transform, opacity;
  transition-property: transform, opacity;
}
/**** disabling Isotope CSS3 transitions ****/
 .isotope.no-transition, .isotope.no-transition .isotope-item, .isotope .isotope-item.no-transition {
  -webkit-transition-duration: 0s;
  -moz-transition-duration: 0s;
  -ms-transition-duration: 0s;
  -o-transition-duration: 0s;
  transition-duration: 0s;
} 
```

# mysql - 我无法通过终端访问 mac os x 上的 mysql

> ID：14531510
> 
> 赞同：1
> 
> 时间：2013-01-25T22:42:49.677
> 
> 标签：mysql, macos, xampp, glassfish-3

*   我有一个 mac os x。

*   我用 Glassfish 安装 Netbeans 7.2

*   我安装 XAMPP

Glassfish 很好，XAMPP 有绿灯，netbeans 正在工作。

我想将 MySQL 与使用 Glassfish 的 Java 应用程序一起使用。我没有成功从终端启动mysql。即使在将 XAMPP 的 mysql 添加到路径之后

```
 export PATH=$PATH:/Applications/XAMPP/xamppfiles/bin/mysql 
```

我仍然无法从终端访问 mysql。有人会帮忙吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-25T22:49:47.870

$PATH 包含包含命令的目录，而不是可执行文件本身。它应该是：

```
export PATH=$PATH:/Applications/XAMPP/xamppfiles/bin 
```

# javascript - jQuery CORS 和重定向

> ID：14531515
> 
> 赞同：7
> 
> 时间：2013-01-25T22:44:03.550
> 
> 标签：javascript, jquery, ajax, cors

使用 jQuery 1.8.2

我正在从一个 AppServer ( *Front* ) 向另一个 AppServer ( *Back* ) 服务器向应用程序发出 CORS 请求。*当我从Front*进行以下 Ajax 调用时，来自*Back*的 302 响应（安全检查）得到尊重，但未存储我的 JSESSIONID cookie：

```
$.ajax({
    url : url,
    dataType : 'html',
    success : function(data, status, xhr) {
    $(dataContainer).append(data);
    },
    complete: function(xhr, status, error) {
    if (xhr.status != 200) {
        $.logger(xhr.getResponseHeader('Location'));
        }
    }
}); 
```

现在，如果我进行相同的调用，但添加 withCredentials，我的 JSESSIONID 被正确存储，但 302 重定向被丢弃。Chrome 和 Firefox（两者的最新版本）都只是停止处理请求。

```
$.ajax({
    xhrFields: { withCredentials: true },
    url : url,
    dataType : 'html',
    success : function(data, status, xhr) {
    $(dataContainer).append(data);
    },
    complete: function(xhr, status, error) {
    if (xhr.status != 200) {
        $.logger(xhr.getResponseHeader('Location'));
        }
    }
}); 
```

我试图从 xhr 对象中获取重定向位置标头，但它是空的。

我正在对来自*Back*的所有响应设置以下内容：

```
response.setHeader("Access-Control-Allow-Origin", "*");
response.setHeader("Access-Control-Allow-Methods", "GET,POST,OPTIONS");
response.setHeader("Access-Control-Max-Age", "1728000");
response.setHeader("Access-Control-Allow-Headers", "Cookie,X-Requested-With");
response.setHeader("Access-Control-Allow-Credentials", "true");
response.setHeader("Access-Control-Expose-Headers", "Location"); 
```

显然，当/如果我能让它工作时，我会限制原点。

有谁知道使用 JQuery 需要什么？是 JQuery 问题，还是所有 Ajax+CORS 请求都遇到过的问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-26T04:52:35.743

不能`Access-Control-Allow-Origin: *`与 结合使用`Access-Control-Allow-Credentials: true`。当 Access-Control-Allow-Credentials 设置为 true 时，Access-Control-Allow-Origin 的值必须是 Origin 标头的值：

```
response.setHeader("Access-Control-Allow-Origin", request.getHeader("Origin")); 
```

或者，您可以删除`Access-Control-Allow-Credentials: true`标题（连同`withCredentials = true`JS 代码）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T06:21:31.320

尝试在 ajax 设置中添加 crossDomain。

```
$.ajax({
    xhrFields: { withCredentials: true },
    url : url,
    dataType : 'html',
    crossDomain: true, 
    success : function(data, status, xhr) {
    $(dataContainer).append(data);
    },
    complete: function(xhr, status, error) {
    if (xhr.status != 200) {
        $.logger(xhr.getResponseHeader('Location'));
        }
    }
}); 
```

也使用

```
jQuery.support.cors = true; 
```

在调用 $.ajax 之前。

在 Firebug->Net->All 选项卡中，您看到 GET 请求还是 OPTIONS 请求？

# jquery - jQuery appendTo()

> ID：14531521
> 
> 赞同：0
> 
> 时间：2013-01-25T22:44:54.533
> 
> 标签：jquery, dom

我正在尝试将表行从一个表移动到另一个表，附加到表中的最后一行。

```
function transfer()
{
  $('#gallery_' + galleryID).fadeOut(function(){
      $(this).appendTo('#tbl_proofed tr:last').fadeIn();
  });
} 
```

这是将它附加在最后一个标签中，我该如何进行附加。可能只需要使用另一种方法，但尝试这样做是因为它复制了所有元素及其子元素。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-25T22:46:13.520

只需替换`.append()`并[`.after()`](http://api.jquery.com/after)添加`.next()`到目标移动的行。

```
function transfer()
{
  $('#gallery_' + galleryID).fadeOut(function(){
      $(this).after('#tbl_proofed tr:last').next().fadeIn();
  });
} 
```

编辑：我可能误解了你的问题。如果您希望副本朝另一个方向发展，那就是：[`.insertAfter()`](http://api.jquery.com/insertAfter)

```
function transfer()
{
  $('#gallery_' + galleryID).fadeOut(function(){
      $(this).insertAfter('#tbl_proofed tr:last').fadeIn();
  });
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T22:50:04.970

您可以删除`tr:last`和 appendTo 表

```
function transfer()
{
  $('#gallery_' + galleryID).fadeOut(function(){
      $(this).appendTo('#tbl_proofed').fadeIn();
  });
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T22:53:33.300

只需使用 .after() 方法，例如：

```
function transfer()
{
  $('#gallery_' + galleryID).fadeOut(function(){
      $(this).after('#tbl_proofed tr:last').fadeIn();
  });
} 
```

[http://api.jquery.com/after/](http://api.jquery.com/after/)

# ruby-on-rails - Heroku ActionView::Template::Error 预编译错误

> ID：14531524
> 
> 赞同：2
> 
> 时间：2013-01-25T22:45:12.160
> 
> 标签：ruby-on-rails, heroku, twitter-bootstrap, twitter-bootstrap-rails

一天多来，我一直在为我的一个网站解决这个问题。我已经将几个站点推送到 Heroku，但是这个（在本地运行良好）经常给我一个“我们很抱歉，但是出了点问题”。Heroku 上的消息。

当我查看 Heroku 日志时，我看到的是：

```
 2013-01-25T20:29:42+00:00 app[web.1]: => Booting WEBrick
    2013-01-25T20:29:42+00:00 app[web.1]: => Rails 3.2.11 application starting in production on http://0.0.0.0:24385
    2013-01-25T20:29:42+00:00 app[web.1]: => Ctrl-C to shutdown server
    2013-01-25T20:29:42+00:00 app[web.1]: Connecting to database specified by DATABASE_URL
    2013-01-25T20:29:42+00:00 app[web.1]: => Call with -d to detach
    2013-01-25T20:29:42+00:00 app[web.1]: [2013-01-25 20:29:42] INFO  WEBrick 1.3.1
    2013-01-25T20:29:42+00:00 app[web.1]: [2013-01-25 20:29:42] INFO  WEBrick::HTTPServer#start: pid=2 port=24385
    2013-01-25T20:29:42+00:00 app[web.1]: [2013-01-25 20:29:42] INFO  ruby 1.9.2 (2011-07-09) [x86_64-linux]
    2013-01-25T20:29:42+00:00 heroku[web.1]: State changed from starting to up
    2013-01-25T20:29:43+00:00 heroku[web.1]: Stopping remaining processes with SIGKILL
    2013-01-25T20:29:43+00:00 heroku[web.1]: Error R12 (Exit timeout) -> At least one process failed to exit within 10 seconds of SIGTERM
    2013-01-25T20:29:45+00:00 heroku[web.1]: Process exited with status 137
    2013-01-25T20:30:50+00:00 app[web.1]: Started GET "/" for 198.207.185.100 at 2013-01-25 20:30:50 +0000
    2013-01-25T20:30:50+00:00 app[web.1]: Processing by PeopleController#index as HTML
    2013-01-25T20:30:51+00:00 app[web.1]:   Rendered people/index.html.erb within layouts/application (40.2ms)
    2013-01-25T20:30:51+00:00 app[web.1]:   app/views/people/index.html.erb:25:in `_app_views_people_index_html_erb__54318736437858219_34439980'
    2013-01-25T20:30:51+00:00 app[web.1]: Completed 500 Internal Server Error in 299ms
    2013-01-25T20:30:51+00:00 app[web.1]: 
    2013-01-25T20:30:51+00:00 app[web.1]:     37:                                   <button type="button" class="close" data-dismiss="lightbox" aria-hidden="true">&times;</button>
    2013-01-25T20:30:51+00:00 app[web.1]:     42:                           </div>
    2013-01-25T20:30:51+00:00 app[web.1]: ActionView::Template::Error ( isn't precompiled):
    2013-01-25T20:30:51+00:00 app[web.1]:     38:                               </div>
    2013-01-25T20:30:51+00:00 app[web.1]:     39:                               <div class='lightbox-content'>
    2013-01-25T20:30:51+00:00 app[web.1]:   app/views/people/index.html.erb:40:in `block in _app_views_people_index_html_erb__54318736437858219_34439980'
    2013-01-25T20:30:51+00:00 app[web.1]:     40:                                   <%=image_tag person.map %>
    2013-01-25T20:30:51+00:00 app[web.1]:     43:                           <!-- end lightbox code -->
    2013-01-25T20:30:51+00:00 app[web.1]:   app/controllers/people_controller.rb:7:in `index'
    2013-01-25T20:30:51+00:00 app[web.1]:   app/views/people/index.html.erb:25:in `each'
    2013-01-25T20:30:51+00:00 app[web.1]: 
    2013-01-25T20:30:51+00:00 app[web.1]: 
    2013-01-25T20:30:51+00:00 app[web.1]:     41:                               </div> 
```

我在上面看到的关键问题是“ActionView::Template::Error”

我跑了

```
RAILS_ENV=production bundle exec rake assets:precompile 
```

并多次编译我的资产。（包括删除我的公共资产目录的内容。

我已经读到 twitter-bootstrap-rails gem 应该从我的 Gemfile 的 Assets 部分中移出，所以我已经移动了它并删除了我的 Gemfile.lock 并运行包更新。

我还通过运行重新安装了 twitter-bootstrap-rails

```
rails g bootstrap:install 
```

我还确保 application.css 文件有

```
*= require bootstrap_and_overrides 
```

以上

```
*= require_tree . 
```

我真的很难过。有人对我能做些什么来解决这个问题有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T21:57:55.213

尝试`config/environments/production.rb`将这一行从 false 更改为 true：

```
 # Don't fallback to assets pipeline if a precompiled asset is missed
  config.assets.compile = true 
```

添加、提交和推送更改。

# batch-file - 使用批处理文件检索文件的驱动器号

> ID：14531534
> 
> 赞同：0
> 
> 时间：2013-01-25T22:45:55.407
> 
> 标签：batch-file

因此，众所周知，根据我插入闪存驱动器的端口/计算机，它会被识别，并且驱动器号不同。我需要代码来找到我的闪存驱动器名称并向我报告驱动器的字母。这就是我所拥有的，因此您可以查看它并尝试找出我做错了什么。

```
set DriveLabel=JERRYG225

for %%a in (a b c d e f g h i j k l m n o p q r s t u v w x y z) do (
pause
 for /f "tokens=6 delims= " %%i in ('vol %%a: ^|find "drive"') do (
  pause
  echo %%i | find /i "%DriveLabel%" > nul
 )
) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T00:03:18.583

有一种更好的方法可以找到分配的驱动器号和卷名。

`C:`使用带有卷名的给定可用硬盘分区`DriveC`，`D:`带有卷名，以及带有卷名`DataDrive`的 USB 磁盘驱动器，`E:``BackupDisk`

```
wmic logicaldisk get caption^, volumename 
```

产生（在命令提示符下）：

```
Caption VolumeName
C:      DriveC
D:      DataDrive
E:      BackupDisk 
```

在批处理文件中使用它并删除列名：

```
for /f "skip=1 tokens=1* delims= " %%x in ('wmic logicaldisk get caption^, volumename') do (
  echo %%x %%y
) 
```

我将留给您弄清楚如何匹配`%%y`并`DRIVELABEL`保存匹配项（`%%x`如果找到）。:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T19:21:12.130

我为我的日常任务写了一个类似的函数，它不依赖于`WNIC`，它需要管理权限。我使用了 USB 驱动器的序列号，因为标签不可靠。

```
:GetDriveLetter %SerialNumber% DriveLetter
    setlocal EnableDelayedExpansion
    set "Letters=ABCDEFGHIJKLMNOPQRSTUVWXYZ"
    for /L %%I in (0,1,25) do (
        set Drive=!Letters:~%%I,1!:
        if exist !Drive! (
            dir !Drive!|findstr /L "%~1" >NUL
            if not ERRORLEVEL 1 (
                set Result=!Drive!
                goto :GetDriveLetterRet
            )
        )
    )
    :GetDriveLetterRet
    endlocal &set "%2=%Result%" &goto :EOF 
```

要获取 USB 驱动器的驱动器号，请执行如下调用：

```
call GetDriveLetter ABCD-1234 Drive
if defined Drive (
    pushd !Drive! 2>NUL && (
        REM do things here
    )
) else echo Can't find USB drive^^! & pause >NUL 
```

**编辑：**要获取 USB 驱动器的序列号，只需在该驱动器上执行一个`DIR`或一个`VOL`命令。

# python - IPython + Pandas 中的 Matplotlib：找不到 ImportError 符号：_png_create_info_struct

> ID：14531544
> 
> 赞同：1
> 
> 时间：2013-01-25T22:46:38.937
> 
> 标签：python, macos, matplotlib, pandas, ipython

我已经在 Python 中构建了 Matplotlib，这样当我导入它或它的任何部分时，它可以正常工作并且图形也很好。

但是，当我运行以下命令时，我一直在阅读“用于数据分析的 Python”，以及在 Ch.2 的 IPython 名称趋势演练中……

```
total_births.plot(title='Total births by sex and year') 
```

我得到...

```
ImportError: dlopen(/Library/Python/2.7/site-packages/matplotlib/_png.so, 2): Symbol not found: _png_create_info_struct 
```

我在 Web 上找到的大多数修复程序都使用 Matplotlib 解决了 Python 中的问题，但特别是在 IPython 中没有解决。

下面是整个 IPython 输出：

```
ImportError                               Traceback (most recent call last)
<ipython-input-27-08d014b1a776> in <module>()
----> 1 total_births.plot(title='Total births by sex and year')

/Library/Python/2.7/site-packages/pandas/tools/plotting.pyc in plot_frame(frame, x, y,     subplots, sharex, sharey, use_index, figsize, grid, legend, rot, ax, style, title, xlim, ylim, logx, logy, xticks, yticks, kind, sort_columns, fontsize, secondary_y, **kwds)
   1453                      logy=logy, sort_columns=sort_columns,
   1454                      secondary_y=secondary_y, **kwds)
-> 1455     plot_obj.generate()
   1456     plot_obj.draw()
   1457     if subplots:

/Library/Python/2.7/site-packages/pandas/tools/plotting.pyc in generate(self)
    732         self._args_adjust()
    733         self._compute_plot_data()
--> 734         self._setup_subplots()
    735         self._make_plot()
    736         self._post_plot_logic()

/Library/Python/2.7/site-packages/pandas/tools/plotting.pyc in _setup_subplots(self)
    781         else:
    782             if self.ax is None:
--> 783                 fig = self.plt.figure(figsize=self.figsize)
    784                 ax = fig.add_subplot(111)
    785                 ax = self._maybe_right_yaxis(ax)

/Library/Python/2.7/site-packages/pandas/lib.so in pandas.lib.cache_readonly.__get__ (pandas/lib.c:27324)()

/Library/Python/2.7/site-packages/pandas/tools/plotting.pyc in plt(self)
    859     @cache_readonly
    860     def plt(self):
--> 861         import matplotlib.pyplot as plt
    862         return plt
    863 

/Library/Python/2.7/site-packages/matplotlib/pyplot.py in <module>()
     24 from matplotlib.cbook import dedent, silent_list, is_string_like, is_numlike
     25 from matplotlib import docstring
---> 26 from matplotlib.figure import Figure, figaspect
     27 from matplotlib.backend_bases import FigureCanvasBase
     28 from matplotlib.image import imread as _imread

/Library/Python/2.7/site-packages/matplotlib/figure.py in <module>()
     30 
     31 from matplotlib import _image
---> 32 from matplotlib.image import FigureImage
     33 
     34 import matplotlib.colorbar as cbar

    /Library/Python/2.7/site-packages/matplotlib/image.py in <module>()
         20 # For clarity, names from _image are given explicitly in this module:
         21 import matplotlib._image as _image
    ---> 22 import matplotlib._png as _png
         23 
         24 # For user convenience, the names from _image are also imported into

ImportError: dlopen(/Library/Python/2.7/site-packages/matplotlib/_png.so, 2): Symbol not found: _png_create_info_struct
  Referenced from: /Library/Python/2.7/site-packages/matplotlib/_png.so
  Expected in: flat namespace
 in /Library/Python/2.7/site-packages/matplotlib/_png.so 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T22:55:19.983

我通过这个线程找到了一个解决方案：[ipython reads wrong python version](https://stackoverflow.com/questions/9386048/ipython-reads-wrong-python-version)

@minrk 关于之间不匹配的观点`which python`并`which ipython`导致我重写我的 /usr/local/bin/ipython 文件的第一行。

# javascript - 如何从未加载的 wordpress 帖子中检索 img src 值？

> ID：14531545
> 
> 赞同：0
> 
> 时间：2013-01-25T22:46:41.447
> 
> 标签：javascript, mysql, css, wordpress

我在这里要做的基本上是制作循环帖子的 div background-image 的背景。

伪代码如下所示：

```
 if this.post has an img tag {
  store the img tag's src into a var,
  then use that img src var as the background-image of the div which holds the permalink to the post
 } 
```

这有意义吗？我在想我必须从 WPDB 中检索 src，但我真的不知道如何不仅从 WPDB 中获取该数据，而且将其放入一个 var 中，然后可以在 div 中使用背景图像...

我知道，这是一个相当高的要求，对我来说可能是一个很大的学习曲线。但这就是我们正确学习的方式！:)

提前谢谢大家。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T00:11:13.113

您可以使用帖子的“特色图片”。首先，通过将其添加到您的`functions.php`文件来激活帖子缩略图：

```
add_theme_support( 'post-thumbnails' ); 
```

然后，您可以使用以下代码检索特色图像：

```
$image_src = wp_get_attachment_image_src( get_post_thumbnail_id($post->ID)); 
```

然后将其应用于您的 div：

```
<div style="background-image: url(<?php echo $image_src; ?>);"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T09:18:00.997

如果您使用的是 jQuery，您可以在 javascript 中执行以下操作：

```
$(document).ready(function(){
  $('img').each(function(){
    var $containingDiv = $(this).parent();
    $containingDiv.css('background-image', 'url(' + $(this).attr('src'));
  });
}); 
```

您必须更改`$(this).parent()`以指向应获得背景的实际元素。`$(this).parent()`是 img 元素的父元素。

注意：这将处理 html 文档中的所有图像。您可能希望限制图像选择器中的范围。例如，如果作为图像父级的 html 元素具有类名“post”，则可以执行以下操作：

```
$('.post > img').each(function(){ 
```

要找到您真正需要的内容，您可能需要查看选择器的 jQuery 文档：http: [//api.jquery.com/category/selectors/](http://api.jquery.com/category/selectors/)。

# php - 为对象动态添加方法

> ID：14531546
> 
> 赞同：2
> 
> 时间：2013-01-25T22:46:56.980
> 
> 标签：php

为了好玩，我试图让它能够为数组提供一些选项，然后将数组内爆成一个可以与 WideImage 类一起使用的字符串。但我遇到了麻烦。好像实际上是不可能的。

我的代码如下：

```
$options = array('resize'=>'50,50');

$actions = implode('->', $options);
$img = WideImage::load($image) . $actions . ';'; 
```

这将使字符串如下：

```
WideImage::load('../images/photo.jpg')->resize(50,50); 
```

我从你们那里寻找的是告诉我这是否可能。

**更新**

当我使用 eval() 时，我收到一个错误，即提供给 wideimage 类的方法是未定义的属性。

这是我的代码：

```
$actions = 'resize(50,50)';
return eval('WideImage::load($image)->$actions->saveToFile('path/to/file')'); 
```

这给了我一个未定义属性的错误，并说 saveToFile() 是非对象的成员。但是，如果我对调整大小进行硬编码并且不使用 $actions 它实际上正在工作。我在这里做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T23:55:30.787

call_user_func_array 非常适合这个，但你需要重构一些东西。

```
$options = array('method' => 'resize', 'parameters' => array(50, 50));
$obj = WideImage::load($image);
call_user_func_array(array($obj, $options['method']), $options['parameters']); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T23:57:19.333

你是关于方法链的。是的，有可能。首先，您必须通过创建新对象来更改静态调用，然后每个方法都必须返回该对象。在你的例子中：

```
<?php
class WideImage
{
    public function load($filepath){
        // your code
        return $this;
    }
    public function resize($width, $height){
        // your code
        return $this;
    }
}
$objWide = new WideImage();
$objWide -> load('../images/photo.jpg') -> resize(50,50); 
```

# .net - 使用最少的代码行从 DataSet 导出 JSON

> ID：14531558
> 
> 赞同：2
> 
> 时间：2013-01-25T22:48:13.180
> 
> 标签：.net, json, dictionary, dataset, webmethod

随着 AJAX 变得越来越普遍，它对报告的好处是巨大的，无论是动态分页还是具有动态值的巨大静态 html 表，我总是需要一种简单的方法将我`DataSet`的 s 直接转储到 JSON 导出中（特别是因为你不能只是`Return`一个`WebMethod`，一个急需的“功能”）。

如何才能做到这一点？

# sql - 使用 PIVOT 将数据从宽翻转到高

> ID：14531560
> 
> 赞同：6
> 
> 时间：2013-01-25T22:48:26.590
> 
> 标签：sql, sql-server-2008, tsql, pivot, unpivot

我有一张相当宽的桌子，我想把它改成高的。目前的数据是这样的：

```
VEND   YEAR   I1_DOLS   I1_QTY   I2_DOLS   I2_QTY   I3_DOLS   I3_QTY ...
1234   2011   101587    508      203345    334      105938    257
1234   2012   257843    587      235883    247      178475    456
1011   2010   584737    432      587274    356      175737    563
1011   2011   517774    356      483858    456      481785    354 
```

我想将其转换为如下所示的表：

```
VEND   YEAR   MONTH   DOLS     QTY
1234   2011   1       101587   508
1234   2011   2       203345   334
1234   2011   3       105938   257
1234   2012   1       257843   587
1234   2012   2       235883   247
.
.
. 
```

我认为 PIVOT 是我需要的，但我似乎无法弄清楚这一点。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-25T22:52:57.413

您可以*使用*`CROSS APPLY (VALUES)`. 这是一篇文章来解释这是如何完成的：

[http://www.sqlservercentral.com/articles/CROSS+APPLY+VALUES+UNPIVOT/91234/](http://www.sqlservercentral.com/articles/CROSS+APPLY+VALUES+UNPIVOT/91234/)

基本上代码是：

```
SELECT vend,
  year,
  month,
  dols, 
  qty
FROM YourTable t
CROSS APPLY 
(
    VALUES
        (1, I1_DOLS, I1_QTY),
        (2, I2_DOLS, I2_QTY),
        (3, I3_DOLS, I3_QTY)
) x (month, dols, qty); 
```

请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!3/6cfa6/1)

或者您可以使用`UNION ALL`查询：

```
select vend, year, 1 month, [I1_DOLS] Dols, [I1_QTY] Qty
from yourtable
union all
select vend, year, 2 month, [I2_DOLS] Dols, [I2_QTY] Qty
from yourtable
union all
select vend, year, 3 month, [I3_DOLS] Dols, [I3_QTY] Qty
from yourtable 
```

请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!3/6cfa6/2)

或者您甚至可以同时应用`UNPIVOT`和`PIVOT`函数来转换数据：

```
select *
from
(
  select vend,
    year,
    replace(replace(replace(col, 'I', ''), '_Dols', ''), '_Qty', '') month,
    case when col like '%Dols%' then 'dols' else 'qty' end col_name,
    value
  from 
  (
    select vend, year, [I1_DOLS], [I1_QTY], [I2_DOLS], [I2_QTY], [I3_DOLS], [I3_QTY]
    from yourtable
  ) src
  unpivot
  (
    value
    for col in ([I1_DOLS], [I1_QTY], [I2_DOLS], [I2_QTY], [I3_DOLS], [I3_QTY])
  ) un
) unp
pivot
(
  max(value)
  for col_name in (dols, qty)
) piv 
```

请参阅[SQL Fiddle with Demo](http://www.sqlfiddle.com/#!3/6cfa6/9)。

这三个都会给出相同的结果：

```
| VEND | YEAR | MONTH |   DOLS | QTY |
--------------------------------------
| 1234 | 2011 |     1 | 101587 | 508 |
| 1234 | 2011 |     2 | 203345 | 334 |
| 1234 | 2011 |     3 | 105938 | 257 |
| 1234 | 2012 |     1 | 257843 | 587 |
| 1234 | 2012 |     2 | 235883 | 247 |
| 1234 | 2012 |     3 | 178475 | 456 |
| 1011 | 2010 |     1 | 584737 | 432 |
| 1011 | 2010 |     2 | 587274 | 356 |
| 1011 | 2010 |     3 | 175737 | 563 |
| 1011 | 2011 |     1 | 517774 | 356 |
| 1011 | 2011 |     2 | 483858 | 456 |
| 1011 | 2011 |     3 | 481785 | 354 | 
```

# salesforce - Apex 组件控制器无法从 apex:inputText/inputField 获取值

> ID：14531561
> 
> 赞同：0
> 
> 时间：2013-01-25T22:48:36.670
> 
> 标签：salesforce, apex-code, soql

我有一个简单的自定义组件，我想用它来发送电子邮件。结构是这样的：

```
<apex:form>
    <apex:actionFunction action="{!sendEmail}" name="sendEmail" />
    <apex:inputField value="{!To}"/>
    <button type="button" onClick="sendEmail();"/>
</apex:form> 
```

和这样的控制器：

```
public with sharing class emailComponent{
    public string To { get; set; } 

    public void sendEmail(){
        system.debug(logginglevel.info,To);
    }
} 
```

现在，当我触发 actionFunction 时，会调用正确的方法，但“To”的值将始终为空。即使我在调用方法时在构造函数中设置了值，该值也将为空。我不知道这是否与它是一个自定义组件控制器有关，或者我是否还缺少其他东西..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T06:49:43.790

将“重新渲染”属性添加到 apex:actionFunction 并且它应该开始工作

# ios - 按字母顺序对 NSArray 进行排序，避免某些字符

> ID：14531568
> 
> 赞同：1
> 
> 时间：2013-01-25T22:48:58.880
> 
> 标签：ios, objective-c, nsmutablearray, nssortdescriptor

我有一个 NSArray 对象（不是 NSStrings，而是自定义对象）。每个对象都有一个值`obj.name` ，我知道如何按名称对 NSMutableArray 进行排序，如下所示

```
 NSSortDescriptor *sort = [NSSortDescriptor sortDescriptorWithKey:@"name" ascending:YES];
 [array sortUsingDescriptors:[NSArray arrayWithObject:sort]]; 
```

但是，有些名称以“The”、“A”或“An”开头，如果它们出现，我想跳到名称中的下一个单词。有没有办法避免这三种情况并在出现时自动转移到下一个单词？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-25T23:27:09.433

如果我敢与迄今为止发布的所有答案相反，那么对您的文字问题的最简单答案是在您的自定义类上实现一个 getter，该类返回调整后的字符串：

```
- (NSString *)canonicalName
{
    if([self.name rangeOfString:@"The "].location == 0)
        return [self.name subStringFromIndex:4];

    // etc, etc
} 
```

然后通过将“canonicalName”指定给排序描述符进行排序。

However, you should first consider following the advice in [QA1159](http://developer.apple.com/library/mac/#qa/qa1159/_index.html) and just using `NSString`'s inherent ability to order itself as per the same rules applied by the Finder, which I think supersets the rules you're trying to implement. So you want to end up comparing strings via `localizedCompare:`, which has been available on iOS since the beginning. You're otherwise pretty much reinventing a non-trivial wheel.

E.g.

```
[array sortUsingComparator:
    ^NSComparisonResult(YourObjectType *obj1, YourObjectType *obj2)
    {
         return [obj1.name localizedCompare:obj2.name];
    }]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-25T22:54:49.693

我建议执行“sortUsingSelector”，这将允许您编写自己的排序方法。然后，您将能够对这些条件进行三项检查，然后返回比较的两个字符串。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-25T22:56:38.093

您可以使用`sortedArrayUsingSelector`. 查看[NSArray 类参考](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSArray_Class/NSArray.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-25T23:00:22.947

你必须实现自己的比较函数，像这样（它很粗糙，可以做得更优雅，但只是作为概念证明）：

```
static NSInteger myCompare(NSString *obj1, NSString *obj2, void *context)
{
  NSString *str1;
  if ([obj1 hasPrefix:@"A "]) str1 = [obj1 substringFromIndex:2];
  else if ([obj1 hasPrefix:@"An "]) str1 = [obj1 substringFromIndex:3];
  else if ([obj1 hasPrefix:@"The "]) str1 = [obj1 substringFromIndex:4];
  else str1 = obj1;

  NSString *str2;
  if ([obj2 hasPrefix:@"A "]) str2 = [obj2 substringFromIndex:2];
  else if ([obj2 hasPrefix:@"An "]) str2 = [obj2 substringFromIndex:3];
  else if ([obj2 hasPrefix:@"The "]) str2 = [obj2 substringFromIndex:4];
  else str2 = obj2;

  return [str1 compare:str2];
} 
```

然后你调用`sortedArrayUsingFunction`它：

```
sortedArray = [array sortedArrayUsingFunction:myCompare context:NULL]; 
```

# git - 如何使用 git 从另一个目录添加文件？

> ID：14531580
> 
> 赞同：2
> 
> 时间：2013-01-25T22:50:11.667
> 
> 标签：git, github

我使用浏览器直接在 GitHub 上创建了一个 repo，而不是使用 git bash 将 repo 克隆到我的机器上，我能够使用 bash 使用自述文件进行测试提交。

我不断致命：运行 git --work-tree=yourSrcFolder add 时，此操作必须在工作树中运行。

在[这里](https://stackoverflow.com/questions/7555551/how-to-add-files-to-github-repo)和[这里](https://stackoverflow.com/questions/9262801/fatal-this-operation-must-be-run-in-a-work-tree)寻找一些线索，但在 4 小时后准备放弃使用 Git。

如果您查看第一个链接，我在这个问题中给出了 4 个赞成的答案，我试图完全按照他所说的去做：“那样，您将初始源文件夹与 Git 工作树分开。”，即为什么我要尝试使用 --work-tree=yourSrcFolder add，所以我希望这能给反对者一些我动机背后的理由。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2017-05-10T09:54:44.293

我的解决方案是创建指向放置在另一个目录中的文件的硬链接。

您可以使用[`ln`](https://stackoverflow.com/q/185899/5091346)命令（[`mklink`在 Windows 上](https://superuser.com/a/255734)）来实现此目的（假设您当前位于存储库目录中）：

```
# this will add file with the same name to current directory and same inode
ln ../../filename . 
```

然后将其添加到 git index：

```
git add filename 
```

如果需要，请提交：

```
git commit -m "add file from another directory" 
```

请参阅[inode](https://en.wikipedia.org/wiki/Inode)，[ln](https://www.gnu.org/software/coreutils/manual/html_node/ln-invocation.html#ln-invocation)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T23:01:46.127

只需将您希望添加的任何文件移动到 repo 目录，然后将它们添加到 git 跟踪。

示例：假设您想将一个名为的文件添加`test.txt`到您的 git 存储库中。

1.  将其移动到您的存储库目录
2.  跑`git add test.txt`
3.  使用提交文件`git commit -m "Added test file to the repo"`
4.  将您的修改推送到远程服务器`git push`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-10-07T22:17:31.840

（**Windows 版本**）只需为 Directory Junction添加一个`mklink /j`或`/J`

在你的 git 目录：

```
mklink /j DirName "C:\location\SourceDir\" 
```

# java - Android 自定义 url 方案打开新的浏览器选项卡以及本机应用程序

> ID：14531581
> 
> 赞同：2
> 
> 时间：2013-01-25T22:50:12.297
> 
> 标签：java, javascript, android

我们有一个在 Android 设备中处理自定义 URL 方案的应用程序。如果设备中未安装应用程序，则来自网页的请求应重定向到信息页面（具有指向 google play 市场的链接）。当我们尝试从网页启动应用程序时，它会在我们的应用程序中启动并在浏览器窗口中打开信息，这不是预期的行为。我们需要在不打开另一个浏览器选项卡的情况下启动应用程序。我尝试按照您的一个论坛中的建议使用 webkitHidden 属性。但是它解决了 Chrome 浏览器的问题。如果您能提出在其他浏览器中处理此问题的解决方案，我将不胜感激也像互联网浏览器（在三星 Galaxy Tab 中找到）和 Firefox。

# javascript - 用名称识别 UIAutomation 中的单元格

> ID：14531589
> 
> 赞同：2
> 
> 时间：2013-01-25T22:51:40.023
> 
> 标签：javascript, ios-ui-automation

我正在尝试如何使用 UIAutomation 框架使用名称来识别表格视图中的单元格。这是仪器编辑器视图的屏幕截图。

![在此处输入图像描述](../Images/c0b7bad963f36b36ad3e3233582f85e2.png)

我尝试了以下方法，但还没有成功。什么是正确或好的方法。一般来说，withName 可以与任何 UIAElement 一起使用吗？

1.  mainWindow().withName("11:00 AM")
2.  target.frontMostApp().mainWindow().tableViews()[0].cells() [1](https://i.stack.imgur.com/gyayO.png) .tableViews()[0].cells()["11:00 am"]

请注意，使用硬编码位置标识元素是有效的。像下面

target.frontMostApp().mainWindow().tableViews()[0].cells().tableViews()[0].cells()[2]

苹果文档中提到了 withName - [http://developer.apple.com/library/ios/#documentation/ToolsLanguages/Reference/UIAElementClassReference/UIAElement/UIAElement.html#//apple_ref/javascript/cl/UIAElement#withName](http://developer.apple.com/library/ios/#documentation/ToolsLanguages/Reference/UIAElementClassReference/UIAElement/UIAElement.html#//apple_ref/javascript/cl/UIAElement#withName)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T23:12:01.530

为了澄清起见，`withName()`方法 on`UIAElement`是测试元素是否具有该名称。如果是则返回元素，否则返回 a `UIAElementNil`。

您正在考虑的是`withName()`on `UIAElementArray`，它将元素数组的结果过滤为仅具有给定名称的那些。

你调用`withName()`了窗口，它不起作用。这些查询方法不会对元素树进行深度遍历来查找内容。您需要像在第 2 行中那样进行遍历。

不过，我不太确定它为什么坏了。看起来您正在正确遍历。我的预感是该名称可能隐藏了额外的空白字符或 unicode，而简单的字符串“11:00 am”不匹配。

我有几个建议来追踪这一点。为您的内部表格视图创建一个中间变量。输入这些建议对我来说会更容易。

```
var innerTableView = target.frontMostApp().mainWindow().tableViews()[0].cells().tableViews()[0]; 
```

现在试试这两个建议，让我知道它说的是什么：

1.  记录第二个单元格名称的全文以查看它是什么：`UIALogger.logMessage("Name is '" + innerTableView.cells()[2].name() + "'");`
2.  如果这不能帮助您解决问题，请尝试与谓词匹配：`innerTableView.cells().firstWithPredicate("name contains '11:00 am'").logElement();`

当您运行其中任何一个建议时会发生什么？

# hadoop - dfs.namenode.servicerpc-address 或 dfs.namenode.rpc-address 未配置

> ID：14531590
> 
> 赞同：11
> 
> 时间：2013-01-25T22:51:40.840
> 
> 标签：hadoop, hdfs

我试图用一个名称节点和四个数据节点配置 hadoop。我能够在一台机器上成功配置名称节点和作业跟踪器并启动它。

但是在要配置数据节点的机器上，我执行了以下操作：

*   `hadoop-2.0.0-cdh4.1.2.tar.gz`我将and解压缩`mr1-2.0.0-mr1-cdh4.1.2.tar.gz`到一个文件夹中，并使用 master 和 slave 设置配置。
*   在`master`文件中，我设置了配置为名称节点的机器的 IP 地址。
*   在从机中，我设置了解压缩 tar 球的机器的 IP 地址。

当我尝试使用命令启动数据节点时

```
hdfs datanode 
```

我收到此错误：

```
java.io.IOException: Incorrect configuration: namenode address dfs.namenode.servicerpc-address or dfs.namenode.rpc-address is not configured. 
```

我需要做什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-29T00:07:12.247

该`masters`文件的名称具有误导性。它应该包含 SecondaryNameNode 的地址，并由 NameNode 本身读取。DataNodes 与文件没有任何关系`masters`。您需要`fs.default.name`在`core-site.xml`配置文件上进行配置。

您看到的错误也[具有误导性](https://issues.apache.org/jira/browse/HDFS-2595)，并将您指向错误的配置参数。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-03-02T20:33:13.560

这些步骤为我解决了问题：

1.  导出 HADOOP_CONF_DIR="$HADOOP_HOME/etc/hadoop"
2.  回声 $HADOOP_CONF_DIR
3.  hdfs 名称节点格式
4.  hdfs getconf -namenodes
5.  开始-dfs.sh

然后，Hadoop就可以正常启动了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-02-26T13:17:39.660

在 hdfs-site.xml 中为名称节点添加 rpc-address 将像这样工作

```
<property>
<name>dfs.namenode.rpc-address</name>
<value>dnsname:port</value>
</property> 
```

也在 core-site 添加属性

`<property> <name>fs.defaultFS</name> <value>dnsname:port</value> </property>`

# visual-studio-2010 - Visual Studio 2010 连接到 Windows Server 2008 R2 上的 db2

> ID：14531592
> 
> 赞同：0
> 
> 时间：2013-01-25T22:51:44.247
> 
> 标签：visual-studio-2010, ssis, db2-connect

我已经从 ibm 企业连接包中安装了 db2 驱动程序。当我以管理员模式打开 Visual Studio 并打开集成包时，我能够连接到 db2 数据源（系统 dsn）。但是当我以非管理员模式打开 Visual Studio 时，我得到一个 sqlstate 58031。我错过了什么？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T20:49:42.243

我现在已经开始工作了。需要将用户添加到 db2users 组，并授予用户对 programData 下 db2 目录的完全访问权限。（至少这是我认为解决的问题）

# c++ - 为什么C++有有符号和无符号

> ID：14531598
> 
> 赞同：1
> 
> 时间：2013-01-25T22:52:12.230
> 
> 标签：c++

多年来，我一直在通过专业地做 JavaScript 来学习 C++。我知道 和 之间的区别`signed`，`unsigned`但我不确定我是否理解它们*为什么*存在。是为了表演还是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-25T22:55:06.233

因为他们需要。

`signed`类型的存在是因为有时想要使用负数。

`unsigned`类型的存在是因为对于某些操作，例如按位逻辑和移位，它们使用起来更干净（例如，您不必担心符号位的表示方式等）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-25T22:55:11.833

您可以争辩说，与等效的有符号类型相比，使用无符号值可以获得更大的正范围，但主要原因是它们允许在负数几乎没有意义或没有意义的域中映射概念。例如，容器的大小永远不能为负数。通过使用在类型中变得显式的无符号类型。

话又说回来，两者的存在以及隐式转换带来了一系列完全不同的问题......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-25T22:55:13.977

对于需要描述显然不能为负数的长度的低级别情况，它会派上用场。例如文件大小。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T23:02:01.860

它们的存在是因为要处理的数学可能不同。

考虑将两个 32 位值相乘以获得 64 位值。根据操作数的符号，有符号乘法和无符号乘法的高 32 位可能不同。开始组装，这就是 x86 上有 IMUL 和 MUL 指令的原因。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-26T01:06:54.610

C 被设计为一种高级语言，但也能够轻松完成低级工作，例如使用 _ASM 关键字将汇编语言代码直接插入源代码。汇编语言直接与 CPU 寄存器一起工作，而算术指令则与有符号和无符号整数一起工作。变量类型可能是这样设计的，使得值可以在 CPU 寄存器和变量之间传输，而无需任何转换。从 C 扩展而来的 C++ 也继承了这个特性。毕竟，在 C/C++ 发明的那个时候，大部分程序员也是硬件工程师。

# c# - 列表 使用 FIleUpload 处理程序时发布后为空

> ID：14531601
> 
> 赞同：2
> 
> 时间：2013-01-25T22:52:29.187
> 
> 标签：c#, asp.net-mvc

我正在尝试将 HttpPostedFileBase 对象的 IList 和“发布”对象传递给操作。我收到 Post 对象就好了，但我的 IList 总是空的。

请参阅下面的代码...

控制器动作：

```
[HttpPost]
public ActionResult Create(Post post, IList<HttpPostedFileBase> attachments)
{
    if (ModelState.IsValid)
    {
        var attachmentCounter = attachments.Count;

        post.SubmissionDateTime = DateTime.Now;
        db.Posts.AddObject(post);
        db.SaveChanges();
        return RedirectToAction("Index", new { category = post.Category });
    }

    return View(post);
} 
```

看法：

```
@using (Html.BeginForm("Create", "Posts", FormMethod.Post, new { enctype = "multipart/form-data" }))
{
    @Html.ValidationSummary(true)

    <fieldset>
        <legend>Post</legend>

        @Html.HiddenFor(model => model.Category)

        @Html.HiddenFor(model => model.Author)

        <div class="editor-label">
            <label>Photo Attachments:&nbsp;&nbsp;
                <span style="color:#666; font-size:12px; font-weight:normal;">(Optional)</span>
            </label>

        </div>
        <div class="editor-field">
        @Html.Raw(FileUpload.GetHtml(
            name: "attachments",
            initialNumberOfFiles: 1,
            allowMoreFilesToBeAdded: true,
            includeFormTag: false,
            addText: "Add another photo...",
            uploadText: "").ToString().Replace("<input value\"\" type=\"submit\" />", ""))
        </div>

        <br />

        <p>
            <input type="submit" value="Create" class="createButton" style="font-weight:normal;" /> | 
            @Html.ActionLink("Back to List", "Index", null, new { category = Model.Category }, null)
        </p>
    </fieldset>
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T00:30:53.043

我试图重现您的问题，但在我的环境中一切正常。但无论如何，再次检查您在 FileUpload 中的**name**属性是否与控制器中的第二个参数属性完全相同（甚至更好地复制粘贴它）。您需要检查的第二件事是您上传到服务器的文件的大小。如果它大于您的网络配置中允许的请求大小，则值将为空。

您也可以检查您的方法值`Request.Files`是否为空，这意味着您的文件甚至没有上传到服务器。如果文件可用，您可以从那里得到它。

# joomla3.0 - 使用 jdatabase 更新数据库中的记录

> ID：14531603
> 
> 赞同：3
> 
> 时间：2013-01-25T22:52:47.627
> 
> 标签：joomla3.0

如何使用 jdatabase 更新 Joomla3 中的记录。这是我到目前为止所拥有的。

```
$db =& JFactory::getDBO();
$query = $db->getQuery(true);
$query->update('#__test AS h');
$query->set('h.name = 'apple', h.description= 'orange', h.url = 'bannana'');
$query->where('h.id=1');    
$db->setQuery($query); 
```

我错过了一些简单的东西吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T21:50:17.143

我也花了一天的时间把头撞在墙上。你非常接近，但你只需要一些小的调整。

```
$query->set('h.name = 'apple', h.description= 'orange', h.url = 'bannana''); 
```

应该是（注意引号）：

```
$query->set('h.name = "apple", h.description= "orange", h.url = "bannana"'); 
```

还：

```
$db =& JFactory::getDBO(); 
```

将在开发者模式下抛出“严格标准”警告。只需删除＆符号。

缺失的部分：

```
try {
    $result = $db->execute();
} catch (Exception $e) {
    die($e->getMessage());
} 
```

PS我意识到这个答案有点晚了，所以我希望你现在已经解决了你的问题。我将这个答案发布给那些后来遇到它并且在 Joomla 的糟糕文档中找不到解决方案的人。

# snmp - 关于 SNMP MIB 陷阱组织的建议

> ID：14531608
> 
> 赞同：2
> 
> 时间：2013-01-25T22:53:19.870
> 
> 标签：snmp, mib

我正在寻找有关 SNMP MIB 陷阱组织或最佳实践的建议。我还没有找到任何描述现实世界使用和期望的材料。

过去我只短暂地使用过 SNMP，而且大多只是获取/设置，我以前从未处理过陷阱。

让我解释...

我最近加入了一家公司，需要查看他们的 MIB，但其中的陷阱不是我所期望的。

对于每个引发警报条件的陷阱（例如，“超过 X 阈值”- 严重性严重，ID 100）都有一个完全独立的用于清除的陷阱（“超过 X 阈值清除”- 严重性清除，ID 134）。每个陷阱都有一个任意分配给它的“trap-id”，其中没有编码任何意义或关系信息。知道陷阱 134 清除陷阱 100 的唯一方法是查看陷阱的文本名称。这似乎不正确。

例如，风扇故障陷阱如下（为简洁而编辑）：

```
 fooTrapFanFailure NOTIFICATION-TYPE
        OBJECTS {StampID, SerialNumber, Name, TrapID, Severity}
        DESCRIPTION   "Fan failure, trap-id 105, severity major"
        ::= { fooTraps 8 }

    fooTrapFanFailureClear NOTIFICATION-TYPE
        OBJECTS {StampID, SerialNumber, Name, TrapID, Severity}
        DESCRIPTION  "Fan failure clear, trap-id 132, severity informational"
        ::= { fooTraps 11 } 
```

我知道 132 清除 105 的唯一方法是手动读取 MIB 或以编程方式扫描 MIB 并根据陷阱名称构建表。这个案例更加愚蠢，因为清除陷阱显示为“信息”严重性。

我预计当“超过 X 阈值”trap-id 100 被提高时，它会被发送，其严重性设置为“关键”，当它清除时，相同的 trap-id 100 将以“清除”的严重性发送'。

或者，如果只有一个包含陷阱 ID 和严重性的通用警报陷阱，而不是我的 65 个左右的独特陷阱，那就更好了。

所以，简而言之，问题是：

**这种“两个陷阱，一个提高，一个清除”正常吗？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T23:06:14.413

这不正常，但没关系。我明白他们为什么会这样做，很容易根据 OID 在 HP OV NNM 中分配颜色（不知道确切的版本，但它在 2000 年有效）。否则，您可能必须解析数据包以在管理器/管理站上显示颜色。

通常，最好将陷阱状态用作陷阱绑定的一部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-14T11:34:06.993

我将我的 Mib 文件与 SNMPc 一起使用。我的文件只有一个陷阱 EventOccured 和由 SNMPc 过滤器生成的所有其他逻辑（相关性）。我使用 Severity='CL' 来清除陷阱。所以不明白在“fooTrapFanFailureClear”陷阱中需要一个严重性变量是什么？

# positioning - css inline-block div定位

> ID：14531609
> 
> 赞同：1
> 
> 时间：2013-01-25T22:53:27.717
> 
> 标签：positioning, css

我正在尝试解决响应式设计中的定位问题。

我有一个容器 div，包含 4 个（但可能或多或少）显示为 inline-block 的 div。我想知道在调整页面大小时如何控制每行 div 的数量（如果可能的话，使用 CSS）。例如，当 4 个容器不再适合容器时，最后一个被移动到第二行。在这种情况下，我希望第一行有 2 个容器，第二行有 2 个容器。我不知道该怎么做。欢迎您的帮助！

编辑：它也可以是 6 个容器，如果布局是： - 1 行 6 个块（如果适合） - 2 行 3 个块 - 3 行 2 个块 - 6 行 1 个

收容者的数量是可变的。我只想每行有相同数量的容器

的HTML：

```
<div class="container"> 
   <div class="containee"></div>
   <div class="containee"></div>
   <div class="containee"></div>
   <div class="containee"></div>
</div> 
```

的CSS：

```
.containee {
  width:200px;
  height:200px;
  display:inline-block;
  background-color:tomato
} 
```

该示例可以在这里看到： http: [//cssdesk.com/uGLbq](http://cssdesk.com/uGLbq)

（PS：我试图在网上找到解决方案，但我真的不知道与这个主题相关的好关键字）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T01:01:05.163

你不能使用 CSS (AFAIK)。

您可以使用 Javascript 实时动态地进行“数学运算”。

在你的情况下，

*   你知道一个街区的宽度（在*那*一刻），
*   您可以轻松获得窗口宽度（在*那*一刻），
*   你知道你的区块编号（在*那*一刻）；

只需在以下代码中应用（（1）第一次打开页面，（2）每次块数变化，或（3）分辨率变化）算法：

```
// EXAMPLE OF INPUT
var windowWidth    = 1400;  // read it...
var blockWidth     = 200;   // read it or use const...
var numberOfBlocks = 10;    // read it... 

// Calculate the maximum number of blocks per row
var maxBlocksPerRow;
for (var i=0; i < numberOfBlocks; i++) {
   if ( (blockWidth * (i + 1)) > windowWidth){
      maxBlocksPerRow = i;
      break; 
   }
}

// Check the highest 0 module combination while iterating backwards
var magicNumberForMatchingBlocks = 1; // if not found, it will be 1.
for (var i = maxBlocksPerRow; i > 0 ; i--) {
   if ( (numberOfBlocks % i) == 0){
      magicNumberForMatchingBlocks = i;
      break;
   }
}

alert("With " + numberOfBlocks + " blocks, each one wide " + 
      blockWidth + " pixels, and a window wide " + windowWidth + " pixels, 
      the number of blocks per row for having always 
      the same number of block in any row is: " + magicNumberForMatchingBlocks); 
```

然后使用该数字使用 Javascript 填充或重新排列元素，或者使用 jQuery 之类的 Javascript 库更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T23:00:27.777

html:

```
<div class="container">
    <div class="grouped">
        <div class="containee"></div>
        <div class="containee"></div>
    </div>
    <div class="grouped">
        <div class="containee"></div>
        <div class="containee"></div>
    </div>
</div> 
```

CSS：

```
.containee {
  width:200px;
  height:200px;
  display:inline-block;
  background-color:tomato
}
.grouped {
  float:left;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T22:57:05.277

试试这个：

```
.container
{
  min-width: 410px;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T22:58:01.703

如果页面适合 4，则给出`.containee`a `float:left;`，它们将彼此并排放置，否则，您将有另一行 div。如果你有另一行，你也可以给它，`margin-top:5px;`第二行的 div 不会粘在第一行的 div 上。请注意，使用这种方法，它不必`.containee`在每行中具有相同的数量，如果你有 4，那么你重新调整大小，你将有 3 - 1，然后是 2 - 2 ......等等。

# .htaccess - 将所有子页面重定向到新 URL 上的相同位置

> ID：14531610
> 
> 赞同：0
> 
> 时间：2013-01-25T22:53:32.093
> 
> 标签：.htaccess, redirect

我想将博客从一个域重定向到另一个域。我已经设置了 URL 结构，因此它匹配所有页面。本质上，它将从 olddomain.com 到 newdomain.com/blog/（例如[http://www.olddomain.org/2013/01/blog-name/](http://www.olddomain.org/2013/01/blog-name/)到[http://www.newdomain.org/blog/ 2013/01/博客名称/](http://www.newdomain.org/blog/2013/01/blog-name/)）。通过 .htaccess 执行此操作的最佳方法是什么？我尝试了一些我在网上找到的选项，但它们似乎只重定向主页而不是所有子页面。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T01:06:24.393

弄清楚了。它是这样工作的：

```
RewriteEngine on 
RewriteRule ^(.*)$ http://www.newdomain.org/blog/$1 [R=301,L] 
```

# forms - 提交时动态更改表单发布操作

> ID：14531612
> 
> 赞同：0
> 
> 时间：2013-01-25T22:53:47.390
> 
> 标签：forms

一旦用户按下提交，我正在尝试根据下拉列表中的选择动态更改表单更改发布操作。一旦做出选择，我已经让它工作了，但这会覆盖我的验证规则。

我正在处理的网站的网址是 instaloan.glidewebdesign.com

根据“汽车标题状态”下拉列表中的选择，我希望它根据答案提交不同的发布操作。

在此先感谢您的任何帮助！！！！！！！

```
function set_form_action()
{
    if (page == 'clear_title')
    {
        window.location = 'https://secure.leads360.com/Import.aspx?   Provider=TMXFinance&Client=TMXFinance&CampaignId=1034&Url=http://instaloan.glidewebdesign.com/index.php/thank-you';
    }
    else if (page == 'lien_on_title')
    {
        window.location = 'https://secure.leads360.com/Import.aspx?Provider=TMXFinance&Client=TMXFinance&CampaignId=1034&Url=http://instaloan.glidewebdesign.com/index.php/thank-you2';
    }
    else if (page == 'no_title')
    {
        window.location = 'https://secure.leads360.com/Import.aspx?Provider=TMXFinance&Client=TMXFinance&CampaignId=1034&Url=http://instaloan.glidewebdesign.com/index.php/thank-you3';
    }
}

<form name="homeform" >

            <fieldset>
                            <input name="first" type="text" class="name" placeholder="&nbsp;First Name" maxlength="10" onkeyup="checkInput2(this)" required="required" />
                            <input name="last" type="text" class="name" placeholder="&nbsp;Last Name" maxlength="15" onkeyup="checkInput2(this)" required="required" /></br>
                            <input name="phone" type='tel'    pattern='^\(?([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})$' title='Phone Number (Format:  (999) 999-9999)' class="name" placeholder="&nbsp;Phone Number" maxlength="10"     onkeyup="checkInput(this)" required="required" />
                            <input name="zip" type="text"     name="zipCode" value=""
   pattern="[0-9]{5}([-][0-9]{4})?" placeholder="&nbsp;Zip Code" class="name"     maxlength="5" onkeyup="checkInput(this)" required="required"  /></br>
                            <select name="amount" class="dropdown" value="Amount Requested">
                                <option value="0">Amount</option>
                                <option value="$100-$499">$100 - $499</option>
                                <option value="$500-$999">$500 - $999</option>
                                <option value="$1000-$1999">$1,000 - $1,999</option>
                                <option value="$2000-$2999">$2,000 - $2,999</option>
                                <option value="$3000+">$3,000+</option>
                        </select>
                            </br>
                            <select name="status" class="dropdown" value="Car Title Status" >
                                <option value="smt">Car Title Status</option>
                                <option value="clear_title">I have a clear car title</option>
                                <option value="lien_on_title">There&#8242;s a lien against my car title</option>
                                <option value="no_title">I don&#8242;t have a car title</option>
                            </select>
                            </br>
                            <input name="submit" type="submit" class="submit" value="Find Out Now" />
                    </fieldset>

    </form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T19:46:07.600

好的...拔掉我留下的小头发后，我明白了...我所做的完全错误，因为无论如何我都在努力完成。这是我的最终工作代码：

```
$("#homeform").submit(function(){
    if($("#status").val() == "clear_title"){
        $(this).attr("action","https://secure.leads360.com/Import.aspx?    Provider=TMXFinance&Client=TMXFinance&CampaignId=1034&Url=http://instaloan.glidewebdesign.co    m/index.php/thank-you");   
    }
   else if($("#status").val() == "lien_on_title"){
        $(this).attr("action","https://secure.leads360.com/Import.aspx?    Provider=TMXFinance&Client=TMXFinance&CampaignId=1034&Url=http://instaloan.glidewebdesign.co    m/index.php/thank-you2");   
    } 
    else if($("#status").val() == "no_title"){
        $(this).attr("action","https://secure.leads360.com/Import.aspx?    Provider=TMXFinance&Client=TMXFinance&CampaignId=1034&Url=http://instaloan.glidewebdesign.co    m/index.php/thank-you3");  
    }
}); 
```

HTML：

```
<form id="homeform" name="homeform" method="post" action="">

                <fieldset>
                            <input name="first" type="text" class="name" placeholder="&nbsp;First Name" maxlength="10" onkeyup="checkInput2(this)" required="required" />
                            <input name="last" type="text" class="name" placeholder="&nbsp;Last Name" maxlength="15" onkeyup="checkInput2(this)" required="required" /></br>
                            <input id="phone" name="phone" type='tel' pattern='^\(?([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})$' title='Phone Number (Format: (999) 999-9999)' class="name" placeholder="&nbsp;Phone Number" maxlength="10"  required="required" />
                            <input name="zip" type="text" name="zipCode" value=""
   pattern="[0-9]{5}([-][0-9]{4})?" placeholder="&nbsp;Zip Code" class="name"     maxlength="5" onkeyup="checkInput(this)" required="required"  /></br>
                        <select name="amount" class="dropdown" value="Amount Requested">
                            <option value="0">Amount</option>
                            <option value="$100-$499">$100 - $499</option>
                            <option value="$500-$999">$500 - $999</option>
                            <option value="$1000-$1999">$1,000 - $1,999</option>
                            <option value="$2000-$2999">$2,000 - $2,999</option>
                            <option value="$3000+">$3,000+</option>
                        </select>
                        </br>
                        <select id="status" name="status" class="dropdown" value="Car Title Status" >
                            <option value="smt">Car Title Status</option>
                            <option value="clear_title">I have a clear car title</option>
                            <option value="lien_on_title">There&#8242;s a lien against my car title</option>
                            <option value="no_title">I don&#8242;t have a car title</option>
                        </select>
                        </br>
                        <input name="submit" type="submit" class="submit" value="Find Out Now" />
                </fieldset>

</form> 
```

# c++ - 我怎样才能有一个地图数组？

> ID：14531615
> 
> 赞同：1
> 
> 时间：2013-01-25T22:54:05.813
> 
> 标签：c++

我如何在我的游戏中加载关卡，因为第 1 层是对象，第 2 层是角色等等。我只需要 3 层，它们都将被叠放在一起。即有一个透明背景的花放在下面图层的草地或泥土上。我也想从同一个文件中读取。我该怎么做呢？任何帮助，将不胜感激。

我从一个关卡文件加载地图，这些文件只是与图块表中的图块相对应的数字。

这是解释它的代码

```
void LoadMap(const char *filename, std::vector< std::vector <int> > &map)
{
    std::ifstream openfile(filename); 
    if(openfile.is_open())
    {
        std::string line, value;
        int space;

        while(!openfile.eof())
        {
            std::getline(openfile, line);

            if(line.find("[TileSet]") != std::string::npos)
            {
                state = TileSet;
                continue;
            }
            else if (line.find("[Layer1]") != std::string::npos)
            {
                state = Map;
                continue;
            }

            switch(state)
            {
            case TileSet:
                if(line.length() > 0)
                    tileSet = al_load_bitmap(line.c_str());
                break;
            case Map: 

                std::stringstream str(line);
                std::vector<int> tempVector;

                while(!str.eof())
                {
                    std::getline(str, value, ' ');
                    if(value.length() > 0)
                                 tempVector.push_back(atoi(value.c_str()));
                }
                map.push_back(tempVector);
                break;
            }
        }
    }
    else
    {
  }
  } 
```

这就是它绘制地图的方式。瓷砖表也是 1280 x 1280，tilesizeX 和 tilesizeY 是 64

```
void DrawMap(std::vector <std::vector <int> > map)
{    
    int mapRowCount = map.size();

    for(int i, j = 0; i < mapRowCount; i ++)
    {
        int mapColCount = map[i].size();

        for (int j = 0; j < mapColCount; ++j)
        {
              int tilesetIndex = map[i][j];
              int tilesetRow = floor(tilesetIndex / TILESET_COLCOUNT);
              int tilesetCol = tilesetIndex % TILESET_COLCOUNT;    
              al_draw_bitmap_region(tileSet, tilesetCol * TileSizeX, tilesetRow * TileSizeY, TileSizeX, TileSizeY, j * TileSizeX, i * TileSizeX, NULL);
        }
    }
} 
```

编辑：http: [//i.imgur.com/Ygu0zRE.jpg](http://i.imgur.com/Ygu0zRE.jpg)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T23:02:29.147

看起来您需要多个二维数组。

尝试这样的事情：

```
unsigned int map[3][8][8];
#define OBJECTS_LAYER 0
#define CHARACTER_LAYER 1
#define FLOWER_ID 2

//...

map[OBJECTS_LAYER][3][4] = FLOWER_ID; 
```

## 编辑 1

根据 OP 的描述，层是一个 8 x 8 的二维数组，可以表示为：

```
unsigned int layer[8][8]; 
```

Th OP 的地图有多个图层。这转化为层的容器。
一种方法是使用数组的另一个维度。很像分层蛋糕或建筑物中的地板。

```
unsigned int map[/* maximum layers */][8 /* from layer above */][8 /* from layer above */]; 
```

要访问第 1 层的位置 [3,4]，表达式将是：

```
map[0][3][4] 
```

由于 C++ 中的索引是从零开始的，因此第一层的索引为零。

要进入建筑物的第 3 层第 2 行第 7 列，可以使用以下命名法：

```
empire_state_building[2][1][6] 
```

# c# - 在单页加载时加载所有数据

> ID：14531617
> 
> 赞同：-5
> 
> 时间：2013-01-25T22:54:20.213
> 
> 标签：c#, javascript, asp.net, ajax, json

嗨，我必须创建一个在页面加载时加载数据的网站，这样网站才能正常工作，而无需再次将其重定向到服务器。这意味着当人们打开网站时，只会加载所有数据，然后在用户刷新 url 之前不会执行回发。

但是使用这种方法会使网站的加载速度很慢任何人都可以帮助我如何加快这个过程或提高我网站的速度

我在 asp.net framework 3.5 中创建了这个网站

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T23:06:11.417

做了几个猜测，他在网站的 JavaScript 中将大量数据存储为数组，并试图在没有回发的情况下操作 DOM……在不了解 AJAX/JSON 的情况下，这似乎不太可能完成，但我猜这就是他正在寻找的答案。

基本上：如果您想要一种允许您在没有回发的情况下更新页面的模式，并且由于数据太多而不想预先填充数据，那么您可以使用 AJAX。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T23:01:57.323

您可以在页面加载时使用 Javascript 加载数据。这不需要回发，但会改变您加载数据的方式。您需要创建某种形式的服务来使用 Javascript，但页面加载会立即发生。

最后，您将受制于要加载的内容。我建议首先尝试调整它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T23:12:55.727

如果我正确理解了这个问题。听起来有几个选择：

1）不要使用一页并用大量数据填充它。尝试将信息拆分到其他页面。如果您要为单个页面查询大量数据，那么是的，这可能需要一段时间，特别是如果您正在谈论数千个数据。但我不知道你的数据集的大小。

2) 某种分页...例如在结果中显示前 20 个，然后单击按钮以获取下一个 20，依此类推。

在单个页面上加载大量数据对最终用户来说可能是危险的。我对它不是很熟悉，但 pagify.js 可能值得一看。

AJAX 和 JSON 也是非常有用的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T23:37:14.747

您实际上是在问如何像 100kb 一样加载 100mb。无法完成。如果您有很多数据要显示给用户，无论您如何获取它，或者将其缓存在您的 html 页面中，返回到浏览器的响应数据总是很大。对不起，但你想要的是不可能的。当用户需要查看它们时更改您的设计并加载数据段，或者重新考虑您的页面的整个使用

# php - 无法通过ajax向php发送数据

> ID：14531619
> 
> 赞同：0
> 
> 时间：2013-01-25T22:54:30.290
> 
> 标签：php, html, ajax

大家好，我是 ajax 新手，我正在尝试从 php 代码中获取数据，这是我的 ajax 代码：

```
function blodvotingview(contentid)
{
    var xmlhttp;    
    xmlhttp=GetXmlHttpObject();
    if (xmlhttp==null)
    {
        alert ("Your browser does not support XMLHTTP!");
        return;
    }
    var url="index.php";
    url=url+"?hp=1";
    url=url+"&m=blogenvoting";
    url=url+"&contentid="+contentid;
    xmlhttp.onreadystatechange=stateChanged;
    xmlhttp.open("GET",url,true);
    xmlhttp.send(null);
}

function stateChanged()
{
    if (xmlhttp.readyState==4)
    {
        document.getElementById("txtHint").innerHTML=xmlhttp.responseText;
    }
}

function GetXmlHttpObject()
{
    if (window.XMLHttpRequest)
    {
        // code for IE7+, Firefox, Chrome, Opera, Safari
        return new XMLHttpRequest();
    }
    if (window.ActiveXObject)
    {
        // code for IE6, IE5
        return new ActiveXObject("Microsoft.XMLHTTP");
    }
    return null;
} 
```

这是我的 html 代码 {entry_id} 是数字参数：

```
<a href="" onclick="blodvotingview({entry_id});return false;" title="Vote Up">view</a>
<p>Suggestions: <span id="txtHint"></span></p> 
```

这是我要回显的 php 代码：

```
 <?php
showcomment()

function showcomment()
{

    echo "yes";
}
?> 
```

但它不起作用，请帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T23:01:52.457

如果您考虑使用 jQuery 和 jquery.serialize 插件，您可以通过以下示例轻松做到这一点：

```
$.post('URL', $('#form_id').serialize(), function(r) {
   console.log(r);
}); 
```

或者

```
$.post('URL', $('#form_id').serialize(), function(r) {
   console.log(r);
},'json'); // to parse response as JSON 
```

或者

```
$.get('URL', function(r) {
   console.log(r);
},'json'); // to parse response as JSON 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T14:01:04.230

尝试这个

```
function blodvotingview(contentid)
{

  var xmlhttp;    
  if (str==""){
      document.getElementById("txtHint").innerHTML="";
      return;
  }
  if (window.XMLHttpRequest){// code for IE7+, Firefox, Chrome, Opera, Safari
      xmlhttp=new XMLHttpRequest();
  }else{// code for IE6, IE5
      xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
  xmlhttp.onreadystatechange=function(){
    if (xmlhttp.readyState==4 && xmlhttp.status==200){
      document.getElementById("txtHint").innerHTML=xmlhttp.responseText;
    }
  }
  xmlhttp.open("GET","index.php?hp=1q="+str,true);
  xmlhttp.send();
} 
```

应该可以正常工作，Wezy

# c# - 关于 IEnumerable 的延迟执行

> ID：14531620
> 
> 赞同：1
> 
> 时间：2013-01-25T22:54:33.187
> 
> 标签：c#, linq, ienumerable, deferred-execution

在下面的代码中，我理解第二个初始化打印一个“外部”和三个“内部”。但是为什么第一个根本不打印，我希望它在“外面”打印一个。

```
 DeferExecution a = new DeferExecution(); // prints nothing 
        DeferExecution b = new DeferExecution(null); // print one "outside" and three "inside".

 class DeferExecution
{
    public IEnumerable<string> Input;

    public DeferExecution()
    {
        Input = GetIEnumerable();
    }

    public DeferExecution(string intput)
    {
        Input = GetIEnumerable().ToArray();
    }

    public IEnumerable<string> GetIEnumerable()
    {
        Console.WriteLine("outside");  
        var strings = new string[] {"a", "b", "c"};
        foreach (var s in strings)
        {
            Console.WriteLine("inside");  
            yield return s;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-25T22:57:43.497

返回的可枚举实现为[迭代器块](http://msdn.microsoft.com/en-us/library/dscyy5s0.aspx)（即，使用 的方法`yield`）。

迭代器块中的代码在第一次被枚举之前不会真正执行，因此如果您实际上没有对`IEnumerable`.

# django - Django - 如何拒绝用户对自己的对象进行投票？

> ID：14531622
> 
> 赞同：1
> 
> 时间：2013-01-25T22:54:38.603
> 
> 标签：django, django-voting

我是 Django 新手，对如何做到这一点有一些疑问。我已经安装了一个名为 Django-voting 的 APP，[https://github.com/jezdez/django-voting/](https://github.com/jezdez/django-voting/)

这个APP允许用户对自己的对象进行投票。我需要否认这一点，但不知道该怎么做。我如何知道对象的所有者？

我要覆盖的代码是这个视图：

```
def vote_on_object(request, model, direction, post_vote_redirect=None,
    object_id=None, slug=None, slug_field=None, template_name=None,
    template_loader=loader, extra_context=None, context_processors=None,
    template_object_name='object', allow_xmlhttprequest=False):
    """
    Generic object vote function.

    The given template will be used to confirm the vote if this view is
    fetched using GET; vote registration will only be performed if this
    view is POSTed.

    If ``allow_xmlhttprequest`` is ``True`` and an XMLHttpRequest is
    detected by examining the ``HTTP_X_REQUESTED_WITH`` header, the
    ``xmlhttp_vote_on_object`` view will be used to process the
    request - this makes it trivial to implement voting via
    XMLHttpRequest with a fallback for users who don't have JavaScript
    enabled.

    Templates:``<app_label>/<model_name>_confirm_vote.html``
    Context:
    object
        The object being voted on.
    direction
        The type of vote which will be registered for the object.
    """
    if allow_xmlhttprequest and request.is_ajax():
    return xmlhttprequest_vote_on_object(request, model, direction,
                                         object_id=object_id, slug=slug,
                                         slug_field=slug_field)

    if extra_context is None:
    extra_context = {}
    if not request.user.is_authenticated():
    return redirect_to_login(request.path)

    try:
    vote = dict(VOTE_DIRECTIONS)[direction]
    except KeyError:
    raise AttributeError("'%s' is not a valid vote type." % direction)

    # Look up the object to be voted on
    lookup_kwargs = {}
    if object_id:
    lookup_kwargs['%s__exact' % model._meta.pk.name] = object_id
    elif slug and slug_field:
    lookup_kwargs['%s__exact' % slug_field] = slug
    else:
    raise AttributeError('Generic vote view must be called with either '
                         'object_id or slug and slug_field.')
    try:
    obj = model._default_manager.get(**lookup_kwargs)
    except ObjectDoesNotExist:
    raise Http404('No %s found for %s.' %
                  (model._meta.app_label, lookup_kwargs))

    if request.method == 'POST':
    if post_vote_redirect is not None:
        next = post_vote_redirect
    elif 'next' in request.REQUEST:
        next = request.REQUEST['next']
    elif hasattr(obj, 'get_absolute_url'):
        if callable(getattr(obj, 'get_absolute_url')):
            next = obj.get_absolute_url()
        else:
            next = obj.get_absolute_url
    else:
        raise AttributeError('Generic vote view must be called with either '
                             'post_vote_redirect, a "next" parameter in '
                             'the request, or the object being voted on '
                             'must define a get_absolute_url method or '
                             'property.')
    Vote.objects.record_vote(obj, request.user, vote)
    return HttpResponseRedirect(next)
    else:
    if not template_name:
        template_name = '%s/%s_confirm_vote.html' % (
            model._meta.app_label, model._meta.object_name.lower())
    t = template_loader.get_template(template_name)
    c = RequestContext(request, {
        template_object_name: obj,
        'direction': direction,
    }, context_processors)
    for key, value in extra_context.items():
        if callable(value):
            c[key] = value()
        else:
            c[key] = value
    response = HttpResponse(t.render(c))
    return response 
```

我想我必须在这里添加某种验证，

```
Vote.objects.record_vote(obj, request.user, vote) 
```

关于这个主题的任何线索？

最好的祝福，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T00:06:54.040

此应用程序不管理 a 是否`user`是他可以投票的任何`object`地方的所有者，因此您需要在每个代表可以投票的实体的模型中保留此控制权。例如，如果您有一个模型`A`并且您希望知道哪个用户是所有者，`A`您应该`user`与模型建立关系以`A`跟踪模型所有者用户。我们可以通过一个例子来表示：

```
from django.contrib.auth.models import User
from django.db import models
from django.contrib import messages

class A(models.Model):
    owner_user = models.ForeignKey(User) 
```

因此，在代码的任何位置（在视图或验证方法中），您都可以执行以下操作：

```
# I will call `user_who_votes`  the user who is making the action of voting
# if you are in a view or have a `request` instance, you can access to its instance,
# as surely you already know, with `user_who_votes = request.user`, always checking  
# this user is authenticated (`if request.user.is_authenticated():`).
try:
    # Checking if the user who is voting is `A`'s owner,
    # if he is, so you can register a message and show it
    # to the user when you estimate (it is only an idea,
    # maybe you can have a better option, of course). 
    a = A.objects.get(owner_user=user_who_votes)
    messages.add_message(request, messages.ERROR, 'You can not vote on your own entities.'))
except A.DoesNotexist:
    # In this point you are sure at all that `user_who_votes`
    # isn't the owner of `A`, so this user can vote.
    Vote.objects.record_vote(a, user_who_votes, vote) 
```

希望这可以帮到你。

# php - 使用自定义标题访问图像

> ID：14531623
> 
> 赞同：0
> 
> 时间：2013-01-25T22:54:40.197
> 
> 标签：php, javascript, xmlhttprequest, base64, restful-authentication

我通过仅使用标头中的有效访问令牌自动处理 HTTP 请求来保护我的 RESTful php API。我在所有 AJAX 请求中添加了带有令牌的标头：

```
 $.ajaxSetup headers:
     auth_token: auth_token 
```

为了保护图像访问，我想使用相同的逻辑并在请求标头中添加令牌。显然，我只能使用 AJAX 请求和 Base64 图像数据来做到这一点：

```
 $.get url, (imageData) =>
     $image.attr src: "data:image/jpeg;base64," + imageData 
```

我不确定性能？因为我的图像大小在 12 字节和 4mb 之间，而且我想要完整的移动支持。

我发现的另一种方法是使用查询字符串：

```
 $image.attr src: 'image/12.jpg?auth_token=' + token 
```

它工作得很好，除了我的图像在令牌更改时不会被缓存。

剩下什么选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T22:58:45.540

你可以使用cookie。第一个请求设置您签名的 cookie（如会话 cookie），因此它不会被伪造。然后对于图像请求或任何其他与此相关的请求，请检查浏览器发送的带有正确代码的 cookie，您可以链接到原始请求。这样你只需要第一个请求的令牌。

# c# - NodaTime 的 Instant.Now

> ID：14531627
> 
> 赞同：39
> 
> 时间：2013-01-25T22:55:06.917
> 
> 标签：c#, nodatime

我正在尝试使用 Jon Skeet（和其他人）的[Noda Time](https://code.google.com/p/noda-time/)框架。

我正在尝试存储当前（即时）。Instant 是从长滴答声中创建的，但是当前滴答声的计数是多少？

是吗：

```
Instant now = new Instant(DateTime.Now.ToUniversalTime().Ticks); 
```

或者？

```
Instant now = Instant.FromDateTimeUtc(DateTime.Now.ToUniversalTime()); 
```

他们是等价的吗，我这样做对吗？

PS，如果乔恩回答是这个 - 我想提出一个 Instant.Now 属性。

PS2 我知道标题包含一个标签，但它不会让我有一个简短的“Instant.Now”标题。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2013-01-25T23:24:12.707

我做了一些研究，似乎 NodaTime 的方式是根据[时钟获取](https://nodatime.org/2.2.x/api/NodaTime.IClock.html)*现在*的时刻。

如果您想使用系统时钟获取当前时间，只需使用`SystemClock.Instance.GetCurrentInstant()`.

但是，`SystemClock.Instance`与其直接在代码中使用，不如`IClock`在时间感知类中注入依赖项。

这将允许您：

*   在运行时为类提供`SystemClock.Instance`，因此代码将使用正确的时间
*   在单元测试期间提供一个虚假的实现，`IClock`以允许您根据需要调整时间以测试各种场景（如时间的流逝）。有一个 NodaTime.Testing 项目提供了这样一个类，称为`FakeClock`.

我觉得这非常有用。我认为拥有类似`new Instant()`或`Instant.Now`返回当前时间的东西会更容易硬编码幕后的用法`SystemClock`，因此错过了 NodaTime 提供的测试优势。

有关使用 NodaTime 进行单元测试的更多信息，请参阅[此链接](http://nodatime.org/1.2.x/userguide/testing.html)。

* * *

关于您的代码示例：它们不等效。

*   `Instant.FromDateTimeUtc(DateTime.Now.ToUniversalTime())`确实会为您提供 UTC 的当前时刻。
*   `new Instant(DateTime.Now.ToUniversalTime().Ticks)`会在很远的将来给你一个错误的日期，因为 BCL[`DateTime.Ticks`](http://msdn.microsoft.com/en-us/library/system.datetime.ticks.aspx)代表自 以来的滴答数`1/1/0001`，而 NodaTime[`Instant.Ticks`](http://noda-time.googlecode.com/hg/docs/api/html/P_NodaTime_Instant_Ticks.htm)代表自以来的滴答数（请参阅[此处](http://noda-time.googlecode.com/hg/docs/api/html/M_NodaTime_Instant__ctor.htm)`1/1/1970`的注释）。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-01-25T23:23:29.073

[`SystemClock.Now`](http://noda-time.googlecode.com/hg/docs/api/html/P_NodaTime_SystemClock_Now.htm)将当前时间作为`Instant`值返回：

```
Instant now = SystemClock.Instance.Now; 
```

但是您可能需要注意[`IClock`](http://nodatime.org/1.1.x/api/html/T_NodaTime_IClock.htm)接口文档中的注释：

> **IClock**旨在用于您需要访问当前时间的任何地方。尽管直接调用并非完全不正确`SystemClock.Instance.Now`，但与调用[UtcNow](http://msdn2.microsoft.com/en-us/library/89w2e3y3)的方式相同，但出于生产代码的风格问题，强烈建议不要这样做。我们建议为任何需要它的对象提供一个**IClock实例，它允许您使用 NodaTime.Testing 程序集（或您自己的实现）中的存根时钟编写测试。**

作为一个简单的示例，假设您有一个`Logger`需要当前时间的类。`SystemClock`不要直接访问，而是使用`IClock`通过其构造函数提供的实例：

```
public class Logger
{
    private readonly IClock clock;

    public Logger(IClock clock)
    {
        this.clock = clock;
    }

    public void Log(string message)
    {
        Instant timestamp = this.clock.Now;
        // Now log the message with the timestamp... 
    }
} 
```

当你`Logger`在生产代码中实例化 a 时，你可以给它`SystemClock.Instance`. 但是在`Logger`类的单元测试中，你可以给它一个[`FakeClock`](http://nodatime.org/1.1.x/api/html/T_NodaTime_Testing_FakeClock.htm).

# php - php mysql mysql_connect 和关闭的连接

> ID：14531632
> 
> 赞同：0
> 
> 时间：2013-01-25T22:55:34.547
> 
> 标签：php, mysql, mysql-connect

> **可能重复：**
> [关闭mysql连接重要吗？](https://stackoverflow.com/questions/880885/is-closing-the-mysql-connection-important)

编辑-以上不是同一个问题，在这里没有回答我的问题。在这里，我特别谈到您不要对打开的连接发出查询的情况，我进一步询问是什么控制了这种关闭，上述答案都没有解决。

如果您使用 mysql_connect 连接到数据库，那么几分钟内不要对数据库发出查询，连接是否会自动关闭？如果是这样，是什么控制了这种关闭？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T23:03:16.607

是的，连接将在脚本结束时关闭。

来自 php.net

> 通常不需要使用 mysql_close()，因为非持久打开的链接会在脚本执行结束时自动关闭。

# sql - 用于确定是否正在导入 CRM 2011 解决方案的 SQL 脚本

> ID：14531633
> 
> 赞同：2
> 
> 时间：2013-01-25T22:55:35.430
> 
> 标签：sql, dynamics-crm-2011

是否有任何方法可以通过 SQL 确定 CRM 数据库当前是否由于解决方案导入而正在更新？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-06-20T12:39:22.607

[为复制本·威廉姆斯的部分答案而道歉。我试图编辑他的，但我的编辑似乎没有被批准。]

ImportJob 视图将向您显示有关组织中发生的所有解决方案导入的信息。

如果您使用 SDK 开始导入，您可以根据 ID 查询作业，否则通过您选择的任何方法。

有一个进度列显示导入完成的百分比，此外，数据列中有 XML 数据可以解析为状态。

此查询（来自[http://sachindgmits.blogspot.co.uk/2012/09/sql-query-to-get-progress-of-importing.html](http://sachindgmits.blogspot.co.uk/2012/09/sql-query-to-get-progress-of-importing.html)）显示了最近的工作：

```
Use <<OrgName_MSCRM>>
Go

SELECT TOP 1
    progress                                 [Progress%],
    Solutionname                             [SolutionName],
    DATEADD(hh, 5.5, startedon)              [StartedOnPST],
    DATEADD(hh, 5.5, completedon)            [CompletedOnPST],
    DATEDIFF(second,startedon,completedon)   [TimeTakenInSec],
    DATEDIFF(minute,startedon,completedon)   [TimeTakenInMin],
    createdbyname                            [ImportedBy],
    OrganizationIdName                       [OrgName],
    Data                                     [ImportOutput]
FROM
    importjob IJ (NOLOCK)
ORDER BY
    IJ.startedon DESC 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-27T21:19:32.683

ImportJob 视图将向您显示有关组织中发生的所有解决方案导入的信息。

如果您使用 SDK 开始导入，您可以根据 ID 查询作业，否则通过您选择的任何方法。

有一个进度列显示导入完成的百分比，此外，数据列中有 XML 数据可以解析为状态。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-26T23:32:46.790

不确定查询，但您可以尝试使用 sql profiler 查看是否有任何查询在您的数据库上实时运行。

# javascript - 为什么窗口高度不能调整到页面上最高元素的高度以下？

> ID：14531635
> 
> 赞同：0
> 
> 时间：2013-01-25T22:55:48.553
> 
> 标签：javascript, jquery

好的，我有一个独特的情况，首先我`<li>`使用 jQuery 创建 10 s `append()`。然后我将每个的高度调整为`<li>`窗口高度/10，以便它们作为一个整体填充整个屏幕高度。我的 html 只包含`<div class="wrapper"></div>`. 这是我的js：

```
// Create The Tree:

$('.wrapper').append('<ul>');
for (var x = 1; x <= 10; x++)
{
    $('.wrapper > ul').append('<li>Root Option ' + x + '</li>');
}

// Script The Tree:

var $winHeight = document.documentElement.clientHeight;
console.log($winHeight);
var $liNumber = $('.wrapper > ul > li').size();
var $liHeight = $winHeight / $liNumber;
$('.wrapper > ul > li').css('height', $liHeight);

var $win = $(window)
$win.on('resize', update);
function update () {
    console.log(document.documentElement.clientHeight);
} 
```

我的问题是，如果您查看控制台，您会发现它没有准确地更新窗口的高度。当您调整窗口大小时，它不会记录低于您上次刷新页面时的值！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T23:27:07.637

你是这个意思吗？[http://jsfiddle.net/reKSm/2/](http://jsfiddle.net/reKSm/2/)

```
var n = 20

$(document).ready(function (){
    $('.wrapper').append('<ul>');
    for (var x = 1; x <= n; x++)
        $('.wrapper > ul').append('<li>Root Option ' + x + '</li>');

    update_size();

    $(window).resize(function(){
    update_size();
    }); 
});

function update_size(){
    // Script The Tree:
    var $winHeight = $(window).height();
    var $liNumber = $('.wrapper > ul > li').length;
    var $liHeight = $winHeight / n;
    $('.wrapper > ul > li').css('height', $liHeight + 'px');    
}; 
```

此外，**您必须定义*doctype***。放置`<!doctype html>`在您的 html 文件的开头，它将起作用。

并且也不要将上面的 JS 代码放到另一个 $(document).ready() 函数中。At 已经有一个了:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T23:22:23.367

我对您的格式和结构进行了一些修改，但我相信这可以满足您的所有需求。[http://jsfiddle.net/ZBwa2/](http://jsfiddle.net/ZBwa2/)

```
//Default, global values.
var numLi = 10;

$(document).ready(function(){

  // Create The Tree:
    $('.wrapper').append('<ul />');        
    for (var x = 1; x <= numLi; x++) {
        $('.wrapper > ul').append('<li class="option">Root Option ' + x + '</li>');
    }

  // Call the update function on doument ready and window resize
    update();
    $(window).on('resize', update);
});

function update () {
    var $winHeight = document.documentElement.clientHeight,
        $liHeight = $winHeight / numLi;

    $('.wrapper .option').css('height', $liHeight);

    console.log(": Window Resized :");
    console.log("Window Height = "+$winHeight);
    console.log("Li Height = "+$liHeight);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-25T23:12:22.640

我在您的代码中没有看到任何 PX，所以我猜：

```
var $liNumber = $('.wrapper > ul > li').length;  // jquery.size() is deprecated (1.8)
var $liHeight = $winHeight / $liNumber;
$('.wrapper > ul > li').css('height', $liHeight + 'px'); 
```

* * *

为了更新窗口调整大小，您必须在调整大小时调用更新函数...并且实际上让这个函数做一些事情而不是 console.log()：

```
var n = 20

$(document).ready(function (){
    // Update when window resized
    $(window).on('resize', update);
    // Add <ul> & <li>
    $('.wrapper').append('<ul>');
    for (var x = 1; x <= n; x++)
        $('.wrapper > ul').append('<li>Root Option ' + x + '</li>');
    // Update once
    update();
});

function update () {
    var $winHeight = document.documentElement.clientHeight;
    var $liNumber = $('.wrapper > ul > li').length;
    var $liHeight = $winHeight / n;
    $('.wrapper > ul > li').css('height', $liHeight + 'px');
} 
```

在 jsfiddle 中预览：http: [//jsfiddle.net/reKSm/1/](http://jsfiddle.net/reKSm/1/)

# sorting - 有序链表

> ID：14531638
> 
> 赞同：0
> 
> 时间：2013-01-25T22:56:17.383
> 
> 标签：sorting, linked-list

我想建立一个有序的链表。

如果我在向链表中插入项目时对链表进行排序会更快（即，见`method #1`下文），还是只插入所有项目然后稍后对它们进行排序会更快？

**方法#1**

```
Rough pseudo - code:
for each node in the list
    if newNode is greater than current node
       continue;
    else
       insert the node here; 
```

**方法#2**

```
Insert all items.
Sort the list at the end (using QuickSort) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T23:03:06.900

这在很大程度上取决于您插入的数据。如果您以大致降序添加节点，那么显然在插入它们时对它们进行排序会更快，但如果相反，它会更慢。

如果在完成后对其进行排序，它还取决于您使用的排序算法。

一般来说，当涉及到排序算法的选择时，双向链表有更多的选择。

此外，在某些应用程序中，始终保持列表排序是很实用的，这样您就可以随时查询它。如果您总是添加到列表的头部（或尾部），则每次添加内容时都必须重新排序。

您可能还需要考虑其他结构，例如保持自身排序的二叉树以及添加/查找节点的时间与树的大小成对数相关而不是线性相关（如链表）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-13T16:02:37.577

理论上它们是相同的。

如果您首先选择（添加时放置正确的空间）来找到合适的索引，则使用二进制搜索将花费 O(log n)。考虑插入 n 个元素，最终会花费 O(n log n) 时间。

在第二个选项中，在插入所有 O(n) 元素后，您将使用合并排序或快速排序在 O(n log n) 时间内对数组进行排序，这意味着 O(n) + O(n log n) = O( n日志 n)。

所以它们的成本相同，但我更喜欢第一个以避免额外的插入时间成本。

# asp.net-mvc - 强制页面发布

> ID：14531641
> 
> 赞同：0
> 
> 时间：2013-01-25T22:56:45.977
> 
> 标签：asp.net-mvc, cross-domain

这可能是一个非常不寻常的问题，但基本上另一个域上的页面（我可以查看，但不能编辑/更改）有一个按钮。单击该按钮时，它会生成一些唯一键。

我需要使用我的 Web 服务提取这些唯一键（使用 ASP .NET MVC3）我可以获得页面的初始 HTML，但是如何强制页面“单击”按钮，以便我可以在之后获取值邮政？

通常，我会重用代码自己生成密钥，但我无权访问逻辑。

我希望这是有道理的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T21:06:36.103

使用例如 firebug 查看随表单发送的 POST 参数，然后从您的代码中进行相同的 POST。为此，您可以使用`WebRequest`或`WebClient`。请参阅此 SO 问题，这将帮助您如何做到这一点：

*   [带有 post 的 HTTP 请求](https://stackoverflow.com/questions/4015324/http-request-with-post)
*   [像网页一样在 C# 中发送 POST 请求？](https://stackoverflow.com/questions/6377339/send-post-request-in-c-sharp-like-a-web-page-does)
*   [如何在 C# 中模拟浏览器 HTTP POST 请求并捕获结果](https://stackoverflow.com/questions/2071321/how-to-simulate-browser-http-post-request-and-capture-result-in-c-sharp)

然后只需使用您选择的技术解析响应（如果响应是格式良好的 XML，我将使用正则表达式 - [Regex或 LinqToXml）。](http://msdn.microsoft.com/en-us/library/30wbz966%28v=vs.71%29.aspx)

*注意：请记住，您的代码将依赖于您未维护的某些服务。因此，当服务不可用、中断或 POSTed 表单或响应的格式将被更改时，您可能会遇到问题。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T23:21:15.973

这实际上取决于目标站点上的技术。

如果页面是简单的 HTML 表单，那么您可以轻松地发送 POST。您需要将预期的数据发送到 POST。然后就可以解析数据了。

如果它不是那么直截了当，您将需要研究自动点击的方法。检查硒。此外，如果结果页面一团糟，您可能需要使用报废。

# c# - TextBoxFor() 不生成验证标记

> ID：14531644
> 
> 赞同：1
> 
> 时间：2013-01-25T22:56:53.457
> 
> 标签：c#, .net, asp.net-mvc-4, entity-framework-5

我有一个 SQL Server 2012，其中有包含两列 TITLE 和 MONTH 的 AWARD 表。TITLE 是 varchar(256)，不能为 NULL。MONTH 是 int，可以为 NULL。

在 VS2012 Ultimate 和 EF 5.0.0 中，MVC4 应用程序中的 TextBoxFor 助手不会 `(data-val="required" and data-val-required="required message")`为上面的 TITLE 列生成验证，但在同一个视图中，MONTH 正在获得正确的验证标记。.edmx 设计器确实显示 TITLE 是 NonNullable，但是，自动生成的 AWARD.cs 文件没有`[Required]` TITLE 列的属性。

我可以尝试什么？

```
@model MyProject.Models.AWARD

@{
    ViewBag.Title = "Add Award";
    Layout = "~/Views/Shared/_EditorLayout.cshtml";
}

@using (Html.BeginForm()) {
    @Html.ValidationSummary(true)
    <fieldset>
        <legend>Add Award</legend>
        <table>
            <tr>
                <td>
                    @Html.LabelFor(model => model.TITLE)
                </td>
                <td>
                    @Html.TextAreaFor(model => model.TITLE)
                    <br />@Html.ValidationMessageFor(model => model.TITLE)
                </td>
            </tr>
        <tr>
            <td>
                @Html.LabelFor(model => model.MONTH)
            </td>
            <td>@Html.DropDownListFor(model => model.MONTH, new SelectList(MyProject.Models.Helpers.Months, "key","value"), "[Not Selected]")
                <br />@Html.ValidationMessageFor(model => model.MONTH)
            </td>
        </tr>

            <tr>
                <td>
                    <input type="submit" value="Add" />
                </td>
                <td>
                    @Html.ActionLink("Cancel", "Index", null, new { @class = "cancel-button" })</td>
            </tr>
        </table>
    </fieldset>
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T23:17:50.910

您不应该真正将您的视图直接绑定到您的数据映射实体。您应该创建**视图模型**类来包装传入和传出视图的数据，然后从控制器填充数据对象。

然后，您可以在视图模型上执行所需的验证，而不会影响生成的映射类。

**模型**

```
public class AwardViewModel
{
    [Required, StringLength(30)]
    public string Title { get; set; }
    ....
} 
```

**看法**

```
@model AwardViewModel

@using (Html.BeginForm()) {
    @Html.EditorFor(m => m.Title)
    @Html.ValidationMessageFor(m => m.Title)
    ...
} 
```

**控制器**

```
[HttpPost]
public ActionResult Create (AwardViewModel model)
{
    /* Create new AWARD in entity context, populate
       with relevant fields from model and commit. */
} 
```

# sql-server - Perl DBI 中 MS SQL Server 存储过程的绑定参数问题

> ID：14531645
> 
> 赞同：1
> 
> 时间：2013-01-25T22:57:00.370
> 
> 标签：sql-server, perl

从 perl 执行存储过程时出错。我可以毫无问题地从 perl 连接到 MS SQL 服务器。但是当我使用以下绑定参数执行该过程时，我收到了错误

> [Microsoft][ODBC SQL Server Driver][SQL Server]'@id' 附近的语法不正确。(SQL-42000)

这个'id'是第一个参数。当我查看程序时，它很好。有人对此错误有任何想法吗？

代码

```
#GetStatusDescription(?, ?, ?) - id - LONG, status - VARCHAR, description - VARCHAR
my $sth = $dbh -> prepare('exec GetStatusDescription(?, ?, ?)');
my $str1, my $str2;
my $intid = 11122;
use DBI qw(:sql_types);
$sth->bind_param(1, $intid, DBI::SQL_INTEGER); 
$sth->bind_param_inout(2, \$str1, DBI::SQL_VARCHAR); 
$sth->bind_param_inout(3, \$str2, DBI::SQL_VARCHAR); 
$sth->execute() or die $dbh -> errstr; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T23:50:17.393

如果您正在调用存储过程，则这些在 SQL Server 中不带括号。也就是说，你想要：

```
my $sth = $dbh -> prepare('exec GetStatusDescription ?, ?, ?'); 
```

# ssl - 如何使用 MAMP PRO 在 localhost 本身（而不是虚拟主机）上设置 SSL

> ID：14531649
> 
> 赞同：0
> 
> 时间：2013-01-25T22:57:21.763
> 
> 标签：ssl, localhost, mamp

如何使用 MAMP PRO 在 localhost ITSELF（而不是任何虚拟主机）上设置 SSL？

我需要这样做，以便我可以在我的 iPhone 上预览我正在创建的网站，该网站使用相同的 Wi-Fi IP 地址。

（为此，我只需在 iPhone 浏览器的地址栏中输入 WiFi 的 IP 地址）。

首先十分感谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T23:18:01.757

您可以查看这些文章：[Getting MAMP working with SSL on Mac OS](http://blog-en.mamp.info/2009/10/getting-mamp-working-with-ssl-on-os-x.html) X。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T13:32:27.703

听起来您对*localhost*是什么感到困惑。本地主机始终是本地的：这是机器本身，具有`127.x.x.x`IP 地址（通常是`127.0.0.1`）。如果您在 Mac 上运行 MAMP，`localhost`则从您的 iPhone 或任何其他设备连接将毫无用处。就您的 iPhone 而言，`localhost`就是 iPhone 本身。

如果你想在你的 LAN 中运行一个测试服务器，它可能使用[私有地址](http://en.wikipedia.org/wiki/Private_network)（通常`192.168.0.x`是网络偏好）。

就 Apache Httpd 而言，这必须在`VirtualHost`（匹配该 LAN IP 地址）中进行配置。目前还不太清楚你在追求什么：这就是 Apache Httpd 的配置方式。

您将遇到的问题是您的证书需要对该 IP 地址有效。事实上，分配主机名通常更简单（例如，一些路由器为它们还运行 DHCP 服务的机器提供小型 DNS 服务），而且通常更有意义。不过，您可以使用 IP 地址主题备用名称 (SAN) 条目生成对 IP 地址有效的证书（如[本答案](https://stackoverflow.com/a/8444863/372643)中所述，请参阅 OpenSSL 部分）。这也意味着您需要使用自己的自签名证书或自己的迷你证书颁发机构，并且您必须以某种方式将其导入您的 iPhone 以使服务器证书受到信任。

# javascript - 让 JavaScript 方法返回 jQuery AJAX 调用的结果

> ID：14531652
> 
> 赞同：1
> 
> 时间：2013-01-25T22:57:39.367
> 
> 标签：javascript, jquery, ajax

> **可能重复：**
> [如何从函数的 AJAX 调用返回响应？](https://stackoverflow.com/questions/14220321/how-to-return-the-response-from-an-ajax-call-from-a-function)

```
function Run(someJsonObject) {
    $.ajax({
        type: "post",
        contentType: "application/json; charset=utf-8",
        url: "/MyWebService",
        data: JSON.stringify(someJsonObject),
        dataType: "json",
        success: function (data) {
            var parsedJson = jQuery.parseJSON(data.d);
            // Do some magic...

            return true; // success!
        },
        error: function (jqXHR, textStatus, errorThrown) {
            return false;
        }
    });

}

var result = Run({dummy:'dummy'}); 
```

如果我没记错的话，上面的函数不会返回 true 或 false，而是未定义。我想返回 AJAX 调用的结果，我更愿意让它同步（我意识到我正在使用*AJAX*）。我将如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T23:02:41.880

你倒退了，让你的ajax先运行。

```
$(function () {
    $.ajax({
        type: "post",
        contentType: "application/json; charset=utf-8",
        url: "/MyWebService",
        data: JSON.stringify(someJsonObject),
        dataType: "json",
        success: function (data) {
            var parsedJson = jQuery.parseJSON(data.d);
            // Do some magic...
            DoStuffWithResult(data.d);
            return true; // success!
        },
        error: function (jqXHR, textStatus, errorThrown) {
            return false;
        }
    });
});

function DoStuffWithResult(result){
    //time to rock, i have my result
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T23:06:59.703

如果您将`async`选项添加到您的 jquery 调用中，它将停止异步。

话虽如此，这通常是一个坏主意，可能可以用更好的方式处理。通常，这是通过首先进行 ajax 调用并在成功函数中处理数据来完成的。

但是，如果您真的坚持要这样做，那么这就是您想要的：

```
function Run(someJsonObject) {
     var result;
     $.ajax({
        async: false,
        type: "post",
        contentType: "application/json; charset=utf-8",
        url: "/MyWebService",
        data: JSON.stringify(someJsonObject),
        dataType: "json",
        success: function (data) {
            var parsedJson = jQuery.parseJSON(data.d);
            // Do some magic...

            result = true; // success!
        },
        error: function (jqXHR, textStatus, errorThrown) {
            result = false;
        }
    });
    return result;
}

var result = Run({dummy:'dummy'}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T23:14:49.920

你可以简化

```
$.post('/MyWebService', JSON.stringify(someJsonObject), function(r) {
   if(r.success) {
       // do something (1)
   } else {
       // do else something (2)
   } 
},'json').error(function() { 
   alert('comunication error');
 }); 
```

如果你得到任何这样的回应

```
{ "success": true, data: "my_data" } 
```

执行某事 (1) 否则 (2)

如果不是有效的 json 或超时触发器 .error()

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T23:10:53.210

如果您想在 jquery 中同步发出 ajax 请求并将其作为返回值`Run`：

```
function Run(someJsonObject) {
    var returnValue;
    $.ajax({
        type: "post",
        async: false,
        contentType: "application/json; charset=utf-8",
        url: "/MyWebService",
        data: JSON.stringify(someJsonObject),
        dataType: "json",
        success: function (data) {
            var parsedJson = jQuery.parseJSON(data.d);
            // Do some magic...

            returnValue = true; // success!
        },
        error: function (jqXHR, textStatus, errorThrown) {
            returnValue = false;
        }
    });
    return returnValue;

} 
```

我添加`async: false`到 ajax 选项并使用局部变量（成功和错误处理程序可访问）作为返回值。

你不能只返回`$.ajax(/* snip */)`，因为它返回一个 promise 对象。

# cocoa - NSArrayController 重新分配数组？

> ID：14531655
> 
> 赞同：0
> 
> 时间：2013-01-25T22:57:52.960
> 
> 标签：cocoa, nsarraycontroller

我有一个 NSCollectionView，其内容绑定到 NSArrayController 的排列对象。当我调用`addObject:`数组控制器时，它似乎重新分配了底层数组——我可以观察到指针改变地址。对于我的特定情况，这不是可接受的行为，因为其他对象也依赖于数组。

这是正常行为还是我做错了什么？我见过一些替代解决方案，例如直接修改数组并在控制器上调用`willChangeValueforKey:`and `didChangeValueForKey:`，但这似乎不是最优雅的解决方案。

我对 Objective-C 和 Cocoa 还很陌生，所以请放轻松。:)

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T00:53:21.733

```
@interface NSArrayController : NSObjectController {
@private
    void *_reserved4;
    id _rearrangementExtensions;
    NSMutableArray *_temporaryWorkObjects;
    NSUInteger _observedIndexHint;
    NSMutableIndexSet *_selectionIndexes;
    NSMutableArray *_objects;
    NSIndexSet *_cachedSelectedIndexes;
    NSArray *_cachedSelectedObjects;
    NSArray *_arrangedObjects;
} 
```

如果您查看 NSArrayController 的标头，arrangedObject 的实例变量是一个 NSArray，因此无论何时添加新对象，它都必须创建一个新数组，这是正常行为。

# java - 随着我增加循环迭代次数，平均运行时间会减少吗？

> ID：14531656
> 
> 赞同：2
> 
> 时间：2013-01-25T22:57:54.150
> 
> 标签：java

使用几种不同的方法（二进制搜索、嵌套循环等），我测量了在两个数组之间查找公共元素的平均运行时间。但是，当我增加它循环的时间时（我将运行时间除以最后的循环数），每次迭代的平均运行时间会减少。也就是说，它变得更快。

我在我的 main 方法中发现了导致这种情况的行，所以我不会发布 main 的其余部分：

```
int intersection=studentList.intersectionSizeNestedLoops(firstList1,secondList1); 
```

**我查看了每次迭代的运行时间，而不是最后的平均值，我注意到了为什么。出于某种原因，前几次迭代总是花费更长的时间（取决于列表大小，但例如，前几次迭代需要 500 000 ns，之后的所有迭代需要 20 000 ns，所以当你有更多的迭代和因此更多的 20 000 ns 迭代）。**

虽然不可能是任何算法，所以它必须是学生列表方法。

生成列表：

```
public studentList(int size, String course) {
int IDrange = 2*size;
studentID = new int[size];
boolean[] usedID = new boolean[IDrange];

for (int i = 0; i < IDrange; i++) 
        usedID[i] = false;

for (int i=0;i<size;i++) {
    int t;

    do {
        t = (int) (Math.random()*IDrange);
    } while (usedID[t]);

    usedID[t] = true;
    studentID[i] = t;
}

courseName = course;
numberOfStudents = size;
} 
```

谢谢你。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-25T22:59:34.303

这是完全正常的。程序变得更快，因为[即时编译器](http://en.wikipedia.org/wiki/Just-in-time_compilation)启动并编译部分代码。

您可以通过使用 启动 JVM 来验证这一点`-XX:+PrintCompilation`。

为 Java 代码计时可能很棘手。请参阅[如何在 Java 中编写正确的微基准测试？](https://stackoverflow.com/questions/504103/how-do-i-write-a-correct-micro-benchmark-in-java)进行良好的讨论。

# vb.net - 事务范围错误

> ID：14531660
> 
> 赞同：0
> 
> 时间：2013-01-25T22:58:12.463
> 
> 标签：vb.net, transactions

当我尝试在下面的代码中打开第二个连接时看到以下错误：分布式事务管理器 (MSDTC) 的网络访问已被禁用。请使用组件服务管理工具在 MSDTC 的安全配置中启用 DTC 以进行网络访问。

```
Public Function Test()
        Using Scope = New TransactionScope
            getMailServer()
            getMailServer()
        End Using
    End Function

    Private Function getMailServer() As String
        Dim objCommand As SqlCommand, objCommand2 As SqlCommand
        Dim objCon As SqlConnection
        Dim intDeleteCount As Integer
        Dim objDR As SqlDataReader
        Dim strServer As String
        Try
            objCommand = New SqlCommand
            objCommand2 = New SqlCommand
            objCon = New SqlConnection(_ConString) 'taken from web.config
            objCon.Open()
            objCommand.Connection = objCon
            Using objCon
                Using objCommand
                    objCommand2.Connection = objCon
                    objCommand2.CommandText = "SELECT SMTPServer FROM dbServer"
                    objDR = objCommand2.ExecuteReader
                    Do While objDR.Read
                        strServer = objDR("SMTPServer")
                    Loop
                    objDR.Close()
                End Using
            End Using
            Return strServer
        Catch ex As Exception
            Throw
        Finally

        End Try

    End Function 
```

请注意，我花了一些时间在谷歌上搜索这个，我已经尝试了在这个网站上发布的一些东西，例如重新启动服务中的分布式事务协调器。我还在某处读到过，分布式事务（具有多个连接对象的事务）应避免使用 TransactionScope。我不确定这是否属实。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T23:01:59.373

您可以`TransactionScope`用于分布式事务。事实上，通过引入`TransactionScope`.NET 2.0，微软让 COM+ 摆脱了困境。这是一个非常好的举措，COM+ 很糟糕。

您需要在参与事务的所有机器上配置 DTC 以进行网络访问 - 运行您的代码的机器以及运行数据库的机器（或您可能正在使用的其他资源，例如 MSMQ）。

下面[介绍如何启用 DTC 网络访问](http://technet.microsoft.com/en-us/library/cc753510%28v=ws.10%29.aspx)。

# php - WordPress：如果没有要填充的数据库数据，则隐藏页面元素

> ID：14531661
> 
> 赞同：0
> 
> 时间：2013-01-25T22:58:24.927
> 
> 标签：php, javascript, wordpress

希望这很容易解决。我有一些元素将以前输入到数据库中的表单数据拉入，这些元素作为自定义字段添加到帖子中。我使用这样的 php 查询来提取它：

```
<a href="<?php echo get_post_meta($post->ID, 'societywebsite', true); ?>" target="_blank" >Website</a> 
```

显然，这出现在循环（content.php）中，并将被添加到任何适当的帖子中。但是，有时由于用户选择不将网站输入到表单上的“societywebsite”字段中，因此不会有任何数据。发生这种情况时，就没有必要提供指向“网站”的链接，因为它不会去任何有用的地方。

我想知道的是如何有一个 If 子句来检查数据是否存在，然后仅在存在时才显示链接。我不介意 javascript，但解决方案越干净、越不“hacky”越好，因为 content.php 会为搜索结果运行多次。

非常感谢您提供的任何帮助或建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T23:39:27.470

根据Wordpress Codex，另一种方法是以下......

```
$societywebsite = get_post_meta($post->ID, 'societywebsite', true);

if ($societywebsite != '') {
    echo '<a href="' . $societywebsite . '" target="_blank" >Website</a>';
} 
```

您可以在此末尾添加“else”以进行调试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T23:03:14.107

假设该字段是 url 的字符串，您可以执行类似的操作。

```
if (strlen(get_post_meta($post->id, 'societywebsite', true)) < 1) {
    echo '<a href="' . get_post_meta($post->ID, 'societywebsite', true) . '" target="_blank" >Website</a>';
} 
```

这将非常简单地检查该字段是否具有超过 1 个字符的字符串。如果超过 1 个字符，则会显示链接。如果没有......它不会做任何事情。

# spring-data - GraphRepository 关键字示例

> ID：14531662
> 
> 赞同：0
> 
> 时间：2013-01-25T22:58:38.437
> 
> 标签：spring-data, spring-data-neo4j

GraphRepository 的方法名称是否有触发器的位置或资源？我知道你可以做`XYZById`Or `XYZByNameAndId`，但是有什么资源可以做这些吗？我想做类似的事情，`XYZByIdBetween(int start, int end)`但这不适用于 Spring-data 2.1.0-RELEASE 目前。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T13:52:27.893

您可以查看官方 spring 数据文档中的以下[URL](http://static.springsource.org/spring-data/commons/docs/current/reference/html/repositories.html#repositories.query-methods.details)，其中解释了如何格式化方法名称。

# c++ - 为什么调用已删除对象成员后没有错误？

> ID：14531667
> 
> 赞同：0
> 
> 时间：2013-01-25T22:59:01.087
> 
> 标签：c++, delete-operator

我不应该在“main.cpp”的第 8 行收到错误吗？

*   我没有使用析构函数。
*   我认为这与“const”关键字有关。

主.cpp：

```
#include "stack.hpp"
int main() {
    node* firstnode = new node(NULL, 5);
    std::cout << firstnode -> getvariable() << std::endl;
    node* secondnode = new node(NULL, 10);
    std::cout << secondnode -> getvariable() << std::endl;
    delete firstnode;
    std::cout << firstnode -> getvariable() << std::endl;
    return 0;
} 
```

堆栈.hpp：

```
#ifndef stack_hpp
#define stack_hpp
#include <iostream>
class node {
public:
    node(node* nextnode, int variablevalue);
    void setvariable(const int variablevalue);
    const int getvariable() const;
private:
    node* nextnodelink;
    int variable;
};
#endif 
```

堆栈.cpp：

```
#include "stack.hpp"
node::node(node* nextnode, int variablevalue)
: nextnodelink(nextnode), variable(variablevalue) {
}

const int node::getvariable() const {
    return variable;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T23:09:30.767

当您删除一个对象时，该对象占用的内存将被放回“可用”状态。为了使计算机快速运行，“使其可用”的设计使得它除了将释放的对象添加到链接列表或类似的东西之外并没有做太多事情。例如，它不会用废话填充它以使其变得无法使用。C++ 的关键在于它的速度很快 - 使`delete`对象的每次填充都是无意义的，只是为了确保以后不能使用它会减慢它的速度。

当然，也有可能是，如果你做一些其他的分配，对象的内容确实是“坏的”。这就是它“未定义”的原因。标准没有说明会发生什么，几乎任何事情都可能发生。计算机着火是不太可能的，但 C 标准本身并没有任何措辞说“它不能导致计算机着火”或任何类似的东西。

一个好的经验法则是，如果您想让代码安全，请在删除指针后将其设置为 NULL。这样，当使用指针时，您的 prgram 很可能会崩溃。

例如：

```
delete firstnode;
firstnode = NULL;
std::cout << firstnode -> getvariable() << std::endl; 
```

现在，当您调用“getvariable”时，您的程序应该会崩溃。并不是 100% 肯定会一直这样做。例如，如果您有一个返回常量的函数，它可能仍然“工作”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T23:04:38.740

你得到未定义的行为，这（在这种情况下）仍然有效（可能）由于你只返回一个值的原因。

`firstnode->getvariable()`在您的情况下，只会告诉您的 CPU 获取存储在的值`firstnode + x`，其中 x 只是基于您的类结构的偏移量。

只要您不尝试对该变量（或指针`firstnode`）执行某些操作，例如将其解释为字符串或其他任何内容，这很可能会工作而不会导致任何直接的问题或错误，因为`firstnode`仍将指向有效内存，只是不再分配（即“不要使用它”）。

但是，编译器可能会为调试构建添加一些开销代码（不一定是您的编译器），如果您尝试这样做会导致异常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T23:04:54.277

为了得到错误，生成的代码需要跟踪您创建的内容和删除的内容，并每次检查操作是否合法。这不是免费的，但会产生时间和空间上的成本。因此它没有完成。C++ 通常避免引入会导致运行时开销的检查。

因此，您有责任不诱发未定义的行为。

# javascript - d3.js foreach 在 svg 中包含的所有路径上循环

> ID：14531671
> 
> 赞同：4
> 
> 时间：2013-01-25T22:59:31.770
> 
> 标签：javascript, jquery, svg, d3.js

我有一个由 d3.js 生成的 svg，如下所示：

```
<svg height="1094" width="1254">
    <g id="countries" stroke-width="1px" transform="">
        <path d="M100,519.150,200,250" fill="rgba(100,100,100,0.8)"
        stroke="rgba(200,200,200,0.5)" id="id1" class="1"></path>
        <path d="M100,519.150,200,250" fill="rgba(100,100,100,0.8)"
        stroke="rgba(200,200,200,0.5)" id="id2" class="1"></path>
        <path d="M100,519.150,200,250" fill="rgba(100,100,100,0.8)"
        stroke="rgba(200,200,200,0.5)" id="id3" class="3"></path>
        <path d="M100,519.150,200,250" fill="rgba(100,100,100,0.8)"
        stroke="rgba(200,200,200,0.5)" id="id4" class="1"></path>
    </g>
</svg> 
```

我想做这样的事情：

```
foreach(path in #countries){
    if(this.class === 3){dostuff}
} 
```

我试过jquery方式：

```
$('#countries').find('path').each(function( index ) {
    console.log(this);
}); 
```

... 不记录任何内容

我尝试了 d3.js 方式（国家初始化如下：）`countries = svg.append('svg:g').attr('id', 'countries')`：

```
countries.select('path').each(console.log(this));
countries.selectAll('path').each(console.log(this)); 
```

记录窗口对象（wtf？）

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-01-26T01:52:44.807

方法[selection.each](https://github.com/mbostock/d3/wiki/Selections#wiki-each)需要一个函数作为参数：

```
countries.selectAll('path').each(function(d,i) { console.log(this); }); 
```

# java - Android位图：将透明像素转换为颜色

> ID：14531674
> 
> 赞同：20
> 
> 时间：2013-01-25T23:00:11.263
> 
> 标签：java, android, image

我有一个 Android 应用程序将图像加载为位图并将其显示在 ImageView 中。问题是图像似乎具有透明背景；这会导致图像上的一些黑色文本在黑色背景下消​​失。

如果我将 ImageView 背景设置为白色，则可以使用，但我会在图像上得到丑陋的大边框，它被拉伸以适合父级（实际图像在中间缩放）。

所以 - 我想将位图中的透明像素转换为纯色 - 但我不知道该怎么做！

任何帮助将不胜感激！

谢谢克里斯

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2013-01-25T23:46:14.490

如果您将图像作为资源包含在内，最简单的方法是自己在[gimp](http://www.gimp.org/)之类的程序中编辑图像。你可以在那里添加你的背景，并确定它会是什么样子，并且不需要在每次加载时修改图像的处理能力。

如果您自己无法控制图像，则可以通过执行类似的操作来修改它，假设您的`Bitmap`被称为`image`.

```
Bitmap imageWithBG = Bitmap.createBitmap(image.getWidth(), image.getHeight(),image.getConfig());  // Create another image the same size
imageWithBG.eraseColor(Color.WHITE);  // set its background to white, or whatever color you want
Canvas canvas = new Canvas(imageWithBG);  // create a canvas to draw on the new image
canvas.drawBitmap(image, 0f, 0f, null); // draw old image on the background
image.recycle();  // clear out old image 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-25T23:03:38.087

您可以遍历每个像素并检查它是否透明。

像这样的东西。（未经测试）

```
 Bitmap b = ...;
        for(int x = 0; x<b.getWidth(); x++){
            for(int y = 0; y<b.getHeight(); y++){
                if(b.getPixel(x, y) == Color.TRANSPARENT){
                    b.setPixel(x, y, Color.WHITE);
                }
            }
        } 
```

# php - 从 PHP 中的小数中删除无用的零位

> ID：14531679
> 
> 赞同：182
> 
> 时间：2013-01-25T23:00:41.393
> 
> 标签：php, numbers, decimal

我试图找到一种快速的方法来`zero decimals`从这样的数值中删除：

```
echo cleanNumber('125.00');
// 125

echo cleanNumber('966.70');
// 966.7

echo cleanNumber(844.011);
// 844.011 
```

是否存在一些优化的方法来做到这一点？

* * *

## 回答 #1

> 赞同：397
> 
> 时间：2013-01-25T23:08:43.690

`$num + 0`成功了。

```
echo 125.00 + 0; // 125
echo '125.00' + 0; // 125
echo 966.70 + 0; // 966.7 
```

在内部，这相当于使用`(float)$num`or强制转换为浮动，`floatval($num)`但我发现它更简单。

* * *

## 回答 #2

> 赞同：117
> 
> 时间：2013-01-25T23:05:52.407

你可以只使用这个`floatval`功能

```
echo floatval('125.00');
// 125

echo floatval('966.70');
// 966.7

echo floatval('844.011');
// 844.011 
```

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2014-11-17T19:06:10.243

这就是我使用的：

```
function TrimTrailingZeroes($nbr) {
    return strpos($nbr,'.')!==false ? rtrim(rtrim($nbr,'0'),'.') : $nbr;
} 
```

注意这假设`.`是小数分隔符。它的优点是它可以处理任意大（或小）的数字，因为没有浮点数。它也不会将数字转换为科学记数法（例如 1.0E-17）。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2014-02-07T13:48:20.240

简单地添加`+`到您的字符串变量将导致类型转换为**(float)**并删除零：

```
var_dump(+'125.00');     // double(125)
var_dump(+'966.70');     // double(966.7)
var_dump(+'844.011');    // double(844.011)
var_dump(+'844.011asdf');// double(844.011) 
```

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2015-11-15T19:14:23.770

对于来到此站点的每个人都遇到与逗号相同的问题，请更改：

```
$num = number_format($value, 1, ',', ''); 
```

至：

```
$num = str_replace(',0', '', number_format($value, 1, ',', '')); // e.g. 100,0 becomes 100 
```

如果要删除**两个零**，则更改为：

```
$num = str_replace(',00', '', number_format($value, 2, ',', '')); // e.g. 100,00 becomes 100 
```

更多信息：[PHP 数字：小数点仅在需要时可见](https://stackoverflow.com/q/4113200/1066234)

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2017-02-27T22:36:52.167

如果要删除之前的零位以显示在页面或模板上。

您可以使用[sprintf()](http://php.net/manual/en/function.sprintf.php)函数

```
sprintf('%g','125.00');
//125

‌‌sprintf('%g','966.70');
//966.7

‌‌‌‌sprintf('%g',844.011);
//844.011 
```

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2013-01-25T23:07:49.237

您应该将您的数字转换为浮点数，这将为您执行此操作。

```
$string = "42.422005000000000000000000000000";
echo (float)$string; 
```

这将是您正在寻找的输出。

> 42.422005

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2015-02-12T10:52:30.940

```
$x = '100.10'; 
$x = preg_replace("/\.?0*$/",'',$x); 
echo $x; 
```

There is nothing that can't be fixed with a simple regex ;)

[http://xkcd.com/208/](http://xkcd.com/208/)

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2016-08-03T13:25:41.797

类型转换为`float`.

```
$int = 4.324000;
$int = (float) $int; 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2018-01-19T15:07:08.347

小心添加 +0。

```
echo number_format(1500.00, 2,".",",")+0;
//1 
```

结果是1。

```
echo floatval('1,000.00');
// 1

echo floatval('1000.00');
//1000 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2017-12-18T08:22:59.523

由于这个问题是旧的。首先，我对此感到抱歉。

问题是关于数字 xxx.xx 但如果它是 x,xxx.xxxxxx 或差异小数分隔符，例如 xxxx,xxxx，这可能更难找到并从十进制值中删除零位。

```
/**
 * Remove zero digits from decimal value.
 * 
 * @param string|int|float $number The number can be any format, any where use in the world such as 123, 1,234.56, 1234.56789, 12.345,67, -98,765.43
 * @param string The decimal separator. You have to set this parameter to exactly what it is. For example: in Europe it is mostly use "," instead of ".".
 * @return string Return removed zero digits from decimal value.
 */
function removeZeroDigitsFromDecimal($number, $decimal_sep = '.')
{
    $explode_num = explode($decimal_sep, $number);
    if (is_array($explode_num) && isset($explode_num[count($explode_num)-1]) && intval($explode_num[count($explode_num)-1]) === 0) {
        unset($explode_num[count($explode_num)-1]);
        $number = implode($decimal_sep, $explode_num);
    }
    unset($explode_num);
    return (string) $number;
} 
```

这是测试代码。

```
$numbers = [
    1234,// 1234
    -1234,// -1234
    '12,345.67890',// 12,345.67890
    '-12,345,678.901234',// -12,345,678.901234
    '12345.000000',// 12345
    '-12345.000000',// -12345
    '12,345.000000',// 12,345
    '-12,345.000000000',// -12,345
];
foreach ($numbers as $number) {
    var_dump(removeZeroDigitsFromDecimal($number));
}

echo '<hr>'."\n\n\n";

$numbers = [
    1234,// 12324
    -1234,// -1234
    '12.345,67890',// 12.345,67890
    '-12.345.678,901234',// -12.345.678,901234
    '12345,000000',// 12345
    '-12345,000000',// -12345
    '12.345,000000',// 12.345
    '-12.345,000000000',// -12.345
    '-12.345,000000,000',// -12.345,000000 STRANGE!! but also work.
];
foreach ($numbers as $number) {
    var_dump(removeZeroDigitsFromDecimal($number, ','));
} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2019-05-14T10:36:45.643

我发现这个解决方案是最好的：

```
public function priceFormat(float $price): string
{
    //https://stackoverflow.com/a/14531760/5884988
    $price = $price + 0;
    $split = explode('.', $price);
    return number_format($price, isset($split[1]) ? strlen($split[1]) : 2, ',', '.');
} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2017-11-23T15:00:50.140

```
$str = 15.00;
$str2 = 14.70;
echo rtrim(rtrim(strval($str), "0"), "."); //15
echo rtrim(rtrim(strval($str2), "0"), "."); //14.7 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2021-10-06T07:51:01.257

Example 1

```
$value =81,500.00;
{{rtrim(rtrim(number_format($value,2),0),'.')}} 
```

> **output**
> 
> 81,500

Example 2

```
$value=110,763.14;
{{rtrim(rtrim(number_format($value,2),0),'.')}} 
```

> **output**
> 
> 110,763.14

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-01-25T23:17:36.077

复杂的方式但有效：

```
$num = '125.0100';
$index = $num[strlen($num)-1];
$i = strlen($num)-1;
while($index == '0') {
   if ($num[$i] == '0') {
     $num[$i] = '';
     $i--;
   }

   $index = $num[$i];
}

//remove dot if no numbers exist after dot
$explode = explode('.', $num);
if (isset($explode[1]) && intval($explode[1]) <= 0) {
   $num = intval($explode[0]);
}

echo $num; //125.01 
```

上述解决方案是最佳方式，但如果您想拥有自己的解决方案，您可以使用它。该算法的作用是从字符串的末尾开始并检查其是否为**0**，如果是，则将其设置为空字符串，然后从后面转到下一个字符，直到最后一个字符**> 0**

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2018-09-11T15:57:47.863

这是我的解决方案。我想保留添加千位分隔符的能力

```
 $precision = 5;    
    $number = round($number, $precision);
    $decimals = strlen(substr(strrchr($number, '.'), 1));
    return number_format($number, $precision, '.', ','); 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-02-28T07:50:05.647

下面就简单多了

```
if(floor($num) == $num) {
    echo number_format($num);
} else {
    echo $num;
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-08-27T19:23:27.977

我使用这个简单的代码：

```
define('DECIMAL_SEPARATOR', ','); //To prove that it works with different separators than "."

$input = "50,00";

$number = rtrim($input, '0');                // 50,00 --> 50,
$number = rtrim($number, DECIMAL_SEPARATOR); // 50,   --> 50

echo $number; 
```

似乎有点太容易成为*真正*正确的解决方案，但它对我来说效果很好。在使用它之前，您应该对将获得的输入进行一些测试。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-10-20T07:39:36.010

您可以使用：

```
print (floatval)(number_format( $Value), 2 ) ); 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2019-08-28T07:34:14.720

简单准确！

```
function cleanNumber($num){
    $explode = explode('.', $num);
    $count   = strlen(rtrim($explode[1],'0'));
    return bcmul("$num",'1', $count);
} 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2016-09-16T14:11:33.537

那是我的小解决方案......可以包含在一个类中并设置变量

私人 $dsepparator = '.'; // 小数 private $tsepparator= ','; // 千

这可以由构造函数设置并更改为用户语言。

```
class foo
{
    private $dsepparator;
    private $tsepparator;

    function __construct(){
        $langDatas = ['en' => ['dsepparator' => '.', 'tsepparator' => ','], 'de' => ['dsepparator' => ',', 'tsepparator' => '.']];
        $usersLang = 'de'; // set iso code of lang from user
        $this->dsepparator = $langDatas[$usersLang]['dsepparator'];
        $this->tsepparator = $langDatas[$usersLang]['tsepparator'];
    }

    public function numberOmat($amount, $decimals = 2, $hideByZero = false)
    {
        return ( $hideByZero === true AND ($amount-floor($amount)) <= 0 ) ? number_format($amount, 0, $this->dsepparator, $this->tsepparator) : number_format($amount, $decimals, $this->dsepparator, $this->tsepparator);
    }
    /*
     * $bar = new foo();
     * $bar->numberOmat('5.1234', 2, true); // returns: 5,12
     * $bar->numberOmat('5', 2); // returns: 5,00
     * $bar->numberOmat('5.00', 2, true); // returns: 5
     */

} 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2017-09-25T06:05:33.483

```
$value = preg_replace('~\.0+$~','',$value); 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2019-01-16T11:42:57.677

这是一个使用 rtrim 的简单单行函数，保存分隔符和小数点：

```
function myFormat($num,$dec)
 {
 return rtrim(rtrim(number_format($num,$dec),'0'),'.');
 } 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2019-12-10T16:19:31.880

终极解决方案：唯一安全的方法是使用正则表达式：

```
echo preg_replace("/\.?0+$/", "", 3.0); // 3
echo preg_replace("/\d+\.?\d*(\.?0+)/", "", 3.0); // 3 
```

它适用于任何情况

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2020-12-27T12:32:25.200

您可以尝试以下方法：

```
rtrim(number_format($coin->current_price,6),'0.') 
```

* * *

## 回答 #26

> 赞同：-2
> 
> 时间：2017-04-03T08:58:38.190

## 此代码将删除点后的零，并且仅返回两位小数。

$数字=1200.0000；
str_replace('.00', '',number_format($number, 2, '.', ''));

**输出为：1200**

# loops - 用常见的 lisp 'loop' 宏对向量求和

> ID：14531685
> 
> 赞同：2
> 
> 时间：2013-01-25T23:00:58.437
> 
> 标签：loops, lisp, common-lisp

我需要实现这样的事情：

```
(loop for i from 1 to N sum (f i)) 
```

除了累积值表示像 (1 2 3) 这样的数字列表并且它们是按元素添加的。换句话说，我想用 (zerov N) 初始化求和并使用 (v+) 添加后续元素：

```
(defun v+ (a b) (mapcar '+ a b))
(defun zerov (n) (loop for i from 1 to n collect 0)) 
```

可以用循环宏做这样的事情吗？我可以将它实现为一个单独的函数，但我想使用循环或类似循环的宏来表达。也许有一种方法可以为这种情况定义简单的类似循环的宏？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T23:37:19.770

```
(loop with accum = (make-list n :initial-element 0)
      for i from 1 to n
    do (setq accum (v+ accum (f i)))
  finally (return accum)) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T23:37:45.183

`LOOP`Common Lisp 标准中定义的那样是不可扩展的。

我会用普通的 LOOP 功能编写它：

```
(let ((result (zerov n)))
  (loop for i from 1 to N
        do (setf result (v+ result (f i))))
  result) 
```

我会把它写成一个函数：

```
(defun sum (n f init sum)
  (let ((result (funcall init n)))
    (loop for i from 1 to n
          do (setf result (funcall sum result (funcall f i))))
    result)) 
```

如果你想要一个像循环宏的直接语言特性这样的功能，那么一个替代方案是[ITERATE](http://common-lisp.net/project/iterate/)宏，它比 LOOP 宏更强大，而且它也是可扩展的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T08:43:25.277

```
(reduce #'v+ (loop for i from 1 to n collect (f i))
        :initial-value (zerov n)) 
```

请注意，Common Lisp 具有适当的“向量”（即同质类型的元素序列，允许更紧凑的表示和有效的随机访问），所以也许，

```
(defun v+ (a b) (map-into a #'+ a b))
(defun zerov (n) (make-array n :initial-element 0))
(defun fn (i n) (let ((v (zerov n))) (setf (aref v i) 1) v))
(defun gn (n)
  (loop for v = (zerov n) then (v+ v (fn i n)) for i below n
        finally (return v))) 
```

# opengl - OpenGL基元的基于时间的变化/动画

> ID：14531686
> 
> 赞同：0
> 
> 时间：2013-01-25T23:01:19.440
> 
> 标签：opengl, animation, glsl, shader, point

> **可能重复：**
> [如何在顶点着色器中使用计时器来为 OpenGL 中的点大小设置动画](https://stackoverflow.com/questions/14187346/how-to-use-a-timer-inside-a-vertex-shader-to-animate-point-sizes-in-opengl)

我想在 OpenGL 中实现一个动画效果，其中我的点图元的大小和透明度会随着时间的推移而变化，具体取决于与每个顶点关联的值。此数据存储在 VBO 中并传递给顶点着色器。

我不清楚如何实现这样的动画效果的整个过程，所以我希望得到一个描述动画如何完成以及需要哪些步骤的答案。

我之前问过这个问题，但没有得到满意的答案，这就是我再次发布这个问题的原因：可以在[这里找到上一个问题的链接](https://stackoverflow.com/questions/14187346/how-to-use-a-timer-inside-a-vertex-shader-to-animate-point-sizes-in-opengl)

我正在使用 OpenGL 4.2，如果你能告诉我如何在空间中渲染一个大小和 alpha 值不同的点，我会非常高兴！

# entity-framework - 具有类似实体框架的 ORM 的通用存储库模式 + UOW 模式有什么优势

> ID：14531688
> 
> 赞同：4
> 
> 时间：2013-01-25T23:01:25.290
> 
> 标签：entity-framework, repository-pattern

让我们从总结这个问题的两句话开始：“包装 DbContext 是一个泄漏的抽象。无论如何，您最终会在服务/控制器层中对 EF 产生某种依赖。” [引用 ref](https://codereview.stackexchange.com/questions/11785/ef-code-first-with-repository-unitofwork-and-dbcontextfactory) 和第二个引用：

“DbContext 类

表示工作单元和存储库模式的组合，使您能够查询数据库并将更改组合在一起，然后将这些更改作为一个单元写回存储。” [MSDN](http://msdn.microsoft.com/en-us/library/system.data.entity.dbcontext%28v=vs.103%29.aspx)

请不要说存储库模式允许您简单地换出数据库，它不允许。有没有人用成熟的应用程序做到这一点？也请不要回答存储库模式不应该公开 IQueryable，我认为这只是另一种表示您不信任与您一起工作的人的方式。

我完全支持封装、代码覆盖率/可测试性，但由于这种流行的 EF 回购模式暴露了 IQueryable，因此不再需要这种模式：

```
 public interface IRepository<T> where T : class
    {
    IQueryable<T> GetAll();
    T GetById(int id);
    IEnumerable<T> Get(Expression<Func<T, bool>> filter = null,Func<IQueryable<T>,IOrderedQueryable<T>> orderBy = null, string includeProperties = "");
    void Add(T entity);
    void Update(T entity);
    void Delete(T entity);
    void Delete(int id);
} 
```

存储库模式与 UOW 模式相结合的唯一好处是： 1\. 轻松启用依赖注入模式以提高可测试性/代码覆盖率 2\. 封装外部集成存在的复杂性（对不同供应商的 Web 服务调用、Web API、数据库， ETC..）

那么我得到了什么封装，我没有通过使用 MyDbContext 得到什么：DbContext 类？我的 ORM 是抽象的 当然，我通过工作的 UOW 和常见的查询（如添加和删除）获得了一些控制器的一致性，但这真的值得付出努力。我不能只相信我的开发人员是统一的，当他们以自己的方式做事时，不要让强迫症。并且由于控制器可以编写它想要的任何查询，这难道不是面对单元测试吗？并且（甚至更大的上限大声笑）如果我要调用第三方 API，我可以在控制器的 MyDbContext 类中使其可访问，因此它看起来只是对控制器的另一个数据调用。

我再说一遍，为什么不直接使用 ORM，它是数据抽象！

以下是一些反对存储库模式的论据：

[http://ayende.com/blog/4784/architecting-in-the-pit-of-doom-the-evils-of-the-repository-abstraction-layer](http://ayende.com/blog/4784/architecting-in-the-pit-of-doom-the-evils-of-the-repository-abstraction-layer)

[http://ayende.com/blog/3955/repository-is-the-new-singleton](http://ayende.com/blog/3955/repository-is-the-new-singleton)

[http://lostechies.com/jimmybogard/2012/09/20/limiting-your-abstractions/](http://lostechies.com/jimmybogard/2012/09/20/limiting-your-abstractions/)

[http://lostechies.com/jimmybogard/2012/10/08/favor-query-objects-over-repositories/](http://lostechies.com/jimmybogard/2012/10/08/favor-query-objects-over-repositories/)

这是存储库模式的正确论据（虽然不够令人信服）： http: [//www.sapiensworks.com/blog/post/2012/10/10/Do-We-Need-The-Repository-Pattern.aspx](http://www.sapiensworks.com/blog/post/2012/10/10/Do-We-Need-The-Repository-Pattern.aspx)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-26T08:11:20.720

如果我再看到 Ayende 的帖子，我想我会发疯的。让我们慢慢来：

1.  通用存储库的适用性有限。就个人而言，我仅将它用于域存储库，并且仅在我以序列化形式存储聚合根时使用。对于其余的事情（阅读：查看模型、报告），我将有一个存储库，专为满足需要这些模型的层的需求而设计。

2.  IQueryable 几乎是一个查询生成器。您不告诉存储库**如何**构建某些东西（IQUeryable），您只是从中询问一些东西。如果您使用的是 IQueryable，那么您已经完成了存储库工作的一部分（破坏了更高层的 SRP）。同样暴露 IQueryable 意味着高层必须知道用于创建查询的 pocos/entities。如果您的老板决定从现在开始您将从 Web 服务中获取数据，那么您将如何处理所有散布在各处的 IQueryable 和 ORM 实体？还是 RDBMS 太慢了，所以让我们使用 Document Db？是的，它可能支持 linq，但你确定你会定义相同的实体吗？

3.  不要相信你的开发者。相信一个适当的架构，一个你不混合层职责并且尊重 SRP（单一职责原则）的架构。如果您正在设计，假设视图模型是根据数据在 db 中的存储方式而不是根据您在视图中的需要，那么您将遇到紧密耦合问题。

4.  因为不需要更改 ORM 或存储技术而不使用 repo 的原因是恕我直言，原因类似于：为什么使用 DI 容器或接口，这些类很有可能会改变，我们可以手动进行反正注射。

5.  使用存储库意味着您不必关心**如何**以及**从何处**检索模型。存储库公开了业务友好的语义 (GetTopSellingProducts)。使用 orm，您必须构建查询（每个人都喜欢在 linq 中进行连接和子查询），了解实体，进行投影等。为什么更高层要关心这些细节？这是“问，不说如何”的原则 (j/k)

毕竟，这都是关于可维护代码的，我希望我的代码易于理解。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-25T23:23:04.620

> 我再说一遍，为什么不直接使用 ORM，它是数据抽象！

它是*数据*抽象而不是*数据*抽象。

如果您需要将其切换出来，它是关于抽象您的 ORM。不是关于通用回购可以直接通过 DbContext 提供什么好东西。如果您确实需要切换 EF 和 DbContext 并且它是高度耦合的，您将需要编辑使用 DbContext 的代码的所有部分，或者被迫在您切换到的任何 ORM 上实现 DbContext 接口。

在说我认为在大多数应用程序中切换 ORM 的可能性很小，并且直接使用 DbContext 的便利性超过了耦合到 EF 的风险。但是，我仍然明白为什么有些人会根据应用程序要求和寿命来这样做。

# plugins - 将插件复制到 jenkins/plugins 目录时出现问题。

> ID：14531689
> 
> 赞同：0
> 
> 时间：2013-01-25T23:01:39.523
> 
> 标签：plugins, jenkins, perforce

我在 Ubuntu 上工作。并且需要将 perforce 插件文件复制到 jenkins/plugins 目录。由于该目录归 jenkins 用户所有；我想以 jenkins 用户身份登录以在此目录中执行任何工作。如何获取 jenkins 用户的密码？我是否朝着正确的方向前进？一般来说，将文件复制到当前用户不拥有的 Ubuntu 目录的首选方法是什么。

perforce 插件不会出现在插件管理器页面上；因此走下载+复制路线。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T00:19:30.583

要以 jeknins 用户身份登录，我不能简单地使用`su jenkins`，因为我没有 jeknins 用户的密码。所以我用：

```
$ sudo su jenkins 
```

此外，在我再次查看“管理插件”页面后，我发现了 perforce 插件。不知何故，我在第一次通过时错过了它。

# matlab - Matlab 矩阵允许多少个索引？

> ID：14531690
> 
> 赞同：1
> 
> 时间：2013-01-25T23:01:43.527
> 
> 标签：matlab, matrix, octave

我正在学习 Matlab（实际上是 Octave），有些事情让我很困惑：

```
octave:14> a = [2 3 4]
                          a =

                             2   3   4

octave:15> a(1)
                          ans =  2
octave:16> a(1,1)
                          ans =  2
octave:17> a(1,1,1)
                          ans =  2
octave:18> a(1,1,2)
    error: A(I,J,...): index to dimension 3 out of bounds; value 2 out of bound 1

octave:18> a(2,1,1)
    error: A(I,J,...): index to dimension 1 out of bounds; value 2 out of bound 1 
```

我预计`a(1, 1, 1)`是非法的，但这让我感到困惑......矩阵允许多少个索引？

我说的时候是什么*意思*`a(1, 1, 1)`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T23:08:23.183

在数组中，只要数组不为空，则始终定义第一行、第一列、第一页等。

因此，如果

```
a = 3;

a(1) %# works
a(1,1) %# works
a(1,1,1) %# works
a(1,1,1,1) %# works 
```

`a`因为理论上的大小是`[1,1,1,1,1,1,....]`

为方便起见，标量的大小表示为`[1,1]`，即未提及长度为 1 的其他维度。

# ios - NSFetchedResultsController 不再更新

> ID：14531698
> 
> 赞同：0
> 
> 时间：2013-01-25T23:01:59.383
> 
> 标签：ios, core-data, nsfetchedresultscontroller

我有一个 IOS 项目，我曾经在我的 AppDelegate 中设置我的核心数据堆栈，并按照 Apple 的示例传递托管对象上下文。我尝试将其更改为 Github 中的 CoreDataStack 项目（https://github.com/adamgit/CoreDataStack）。我做了我认为正确的更改，但现在我的 NSFetchedResults 控制器没有正确更新。

该应用程序使用一个屏幕将玩家添加到数据存储，然后将用户返回到应该显示所有现有玩家以及刚刚添加的玩家的表格视图。调试显示新添加的播放器的数据是“故障”。但是，如果我重新启动应用程序，则新播放器会在表格视图中可见。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T17:42:07.047

通常在显示刷新的表格视图时调用它就足够了：

```
[_fetchedResultsController performFetch:
     _fetchedResultsController.fetchRequest error:nil]; 
```

一个更昂贵但通常也是可行的操作是

```
_fetchedResultsController = nil;
[self.tableView reloadData]; 
```

# python - 如何在 Python 中删除 Riak 存储桶？

> ID：14531708
> 
> 赞同：6
> 
> 时间：2013-01-25T23:03:06.713
> 
> 标签：python, riak

我想删除一个 Riak 存储桶，以便从我的系统中清除旧数据。我知道没有单一的 Riak API 可以执行此操作，而是[删除了 bucket 中的所有密钥](http://docs.basho.com/riak/latest/references/apis/http/#Bucket-Operations)，这有效地删除了它。Riak 确实提供了一个 API 来获取所有密钥，所以这相当简单。

我在[网上找到了一些代码](https://github.com/cmurphycode/riak-delete-bucket)来做到这一点，但它是用 JavaScript 编写的，并且在 Node.js 下运行。我想要一些 Python 的东西。这可能是一件简单的事情。有没有人有任何例子？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-25T23:15:13.897

就像我在问题中所说的那样，我认为这很简单，尤其是[请求](http://docs.python-requests.org/en/latest/)库，所以我开发了一个脚本来执行此操作。我从 Riak `keys=true`（即非分块）[模式](http://docs.basho.com/riak/latest/references/apis/http/HTTP-List-Keys/#Request)开始，但在我较大的存储桶上失败了。我切换到分块模式`keys=stream`（`{...}{...}...{...}`并按顺序处理。还不错。这是代码：

```
#!/usr/bin/python
# script to delete all keys in a Riak bucket

import json
import re
import requests
import sys

def processChunk(chunk):
    global key_count
    obj = json.loads(chunk.group(2))
    if 'keys' in obj:
        for key in obj['keys']:
            r = requests.delete(sys.argv[1] + '/' + key)
            print 'delete key', key, 'response', r.status_code
            key_count += 1

if len(sys.argv) != 2:
    print 'Usage: {0} <http://riak_host:8098/riak/bucket_name>'.format(sys.argv[0])
    print 'Set riak_host and bucket_name appropriately for your Riak cluster.'
    exit(0)

r = requests.get(sys.argv[1] + '?keys=stream')
content = ''
key_count = 0

for chunk in r.iter_content():
    if chunk:
        content += chunk

re.sub(r'(?=(^|})({.*?})(?={|$))', processChunk, content)

print 'Deleted', key_count, 'keys' 
```

虽然此时我的问题已基本解决，但我怀疑还有更好的解决方案。我欢迎人们在此页面上添加它们。除非几周后没有提供替代方案，否则我不会接受我自己的答案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-08-13T11:52:41.137

如果您可以选择使用 python riak-client，则可以使用更少的代码来实现：

```
#!/usr/bin/python
import riak

riak_handle = riak.RiakClient(pb_port=8087, protocol='pbc')
riak_bucket = riak_handle.bucket('default')

for keys in riak_bucket.stream_keys():
    for key in keys:
        print('Deleting %s' % key)
        riak_bucket.delete(key) 
```

如果这是您的主要用例，您可以调整它以使用参数。

# servicestack - ServiceStack - .Net MVC 应用程序中的自定义 CredentialsAuthProvider

> ID：14531712
> 
> 赞同：3
> 
> 时间：2013-01-25T23:03:22.627
> 
> 标签：servicestack

我正在尝试按照此处的示例对 MVC 和 ServiceStack 进行身份验证 - [https://github.com/ServiceStack/ServiceStack.UseCases/tree/master/CustomAuthenticationMvc](https://github.com/ServiceStack/ServiceStack.UseCases/tree/master/CustomAuthenticationMvc)。我的问题是，在我对帐户/登录的初始请求中，我无法针对 ServiceStack 成功进行身份验证。

AccountController的LogOn方法中ServiceStack相关代码：

```
var apiAuthService = AppHostBase.Resolve<AuthService>();
apiAuthService.RequestContext = System.Web.HttpContext.Current.ToRequestContext();
var apiResponse = apiAuthService.Authenticate(new Auth
                                                    {
                                                        UserName = model.UserName,
                                                        Password = model.Password,
                                                        RememberMe = false
                                                    }); 
```

我有一个自定义身份验证提供程序，它是 CredentialsAuthProvider 的子类。我在 AppHost 类中配置如下：

```
var appSettings = new AppSettings();

Plugins.Add(new AuthFeature(() => new CustomUserSession(),
    new IAuthProvider[] {
      new ActiveDirectoryAuthProvider(), 
    })); 
```

* * *

```
public override bool TryAuthenticate(ServiceStack.ServiceInterface.IServiceBase     authService, string userName, string password)
{
    //class to authenticate against ActiveDirectory        
    var adAuthentication = new ActiveDirectoryAuthenticationService();

    if (!adAuthentication.Authenticate(userName, password))
            return false;

    var session = (CustomUserSession)authService.GetSession(false);
    session.IsAuthenticated = true;
    session.UserAuthId = session.UserAuthName;
    authService.SaveSession(session, SessionExpiry);

    return true;
} 
```

我认为我的问题是**session.Id**此时为空，并且将会话保存为“urn：iauthsession：”到“SessionCache”。但是，我不确定如何正确填充**session.Id**。此外，这可能是也可能不是问题，但初始登录请求是由 MVC 处理的帐户/登录。因此，在 AccountController 中的 AuthService.Authenticate() 调用之前没有对 ServiceStack 的请求。

我想出的一个可能的解决方案已添加到我的 CredentialsAuthProvider 子类中。

```
public override bool TryAuthenticate(ServiceStack.ServiceInterface.IServiceBase     authService, string userName, string password)
{
    //class to authenticate against ActiveDirectory        
    var adAuthentication = new ActiveDirectoryAuthenticationService();

    if (!adAuthentication.Authenticate(userName, password))
            return false;

    var session = (CustomUserSession)authService.GetSession(false);

    //A possible solution???
    if(session.Id == null)
    {
        var req = authService.RequestContext.Get<IHttpRequest>();
        var sessId = HttpContext.Current.Response.ToResponse().CreateSessionIds(req);
        session.Id = sessId;
        req.SetItem(SessionFeature.SessionId, sessId);
    }
    //end possible solution
    session.IsAuthenticated = true;
    session.UserAuthId = session.UserAuthName;
    authService.SaveSession(session, SessionExpiry);

    return true;
} 
```

是否有我缺少的配置或调用来在 MVC 中“连接”ServiceStack 身份验证？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T02:03:47.527

我在 TryAuthenticate 中所做的唯一事情是验证用户名、密码并在有效时返回 true。

我有另一个名为 OnAuthenticated 的覆盖方法，我在其中保存会话信息。OnAuthenticated 将 Auth Service 和 Session 作为参数传递，因此您只需：

```
public override void OnAuthenticated(IServiceBase authService, IAuthSession session,.....
{
  session.IsAuthenticated = true;
  session.....
  authService.SaveSession(session, SessionExpiry);
} 
```

只要我注册了 ICacheClient，这似乎就存储了我的会话信息。

# android - Android解析数据很慢

> ID：14531713
> 
> 赞同：0
> 
> 时间：2013-01-25T23:03:22.940
> 
> 标签：android, rss-reader

我正在尝试制作一个解析 RSS 提要的应用程序。我运行我的应用程序，但是虽然源链接 ( [http://api.androidhive.info/music/music.xml](http://api.androidhive.info/music/music.xml) ) 非常快，但数据的获取**速度非常慢。**

我需要我的应用程序快速响应。

我的应用程序代码：

```
package com.sta.map;

import java.util.ArrayList;
import java.util.HashMap;

import org.w3c.dom.Document;
import org.w3c.dom.NodeList;
import org.w3c.dom.Element;

import android.app.Activity;
import android.app.ProgressDialog;
import android.os.AsyncTask;
import android.os.Bundle;
import android.widget.ListView;
import android.widget.TextView;

public class POSTS extends Activity {
    static final String KEY_ARTIST = "artist";
    static final String KEY_THUMB_URL = "thumb_url";

    ListView list;
    WbAdapter adapter;

    static String URL = "http://api.androidhive.info/music/music.xml";

    ProgressDialog pDialog;

    ArrayList<HashMap<String, String>> songsList = new ArrayList<HashMap<String, String>>();
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.posts);

        new ParseXMLTask().execute();
    }

    class ParseXMLTask extends AsyncTask<String, String, String> {
        protected void onPreExecute() {
            // Showing progress dialog before sending http request
            pDialog = new ProgressDialog(POSTS.this);
            pDialog.setMessage("Please wait..");
            pDialog.setIndeterminate(true);
            pDialog.setCancelable(false);
            pDialog.show();
        }
        @Override
        protected String doInBackground(String... unused) {
           XMLParser parser = new XMLParser();
           String xml = parser.getXmlFromUrl(url); // getting XML from URL
            return xml;
        }

        @Override
        protected void onPostExecute(String result) {
            pDialog.dismiss();
            XMLParser parser = new XMLParser();
            Document doc = parser.getDomElement(result); // getting DOM element

            NodeList nl = doc.getElementsByTagName("song");
            // looping through all song nodes <song>
            for (int i = 0; i < nl.getLength(); i++) {
                // creating new HashMap
                HashMap<String, String> map = new HashMap<String, String>();
                Element e = (Element) nl.item(i);
                // adding each child node to HashMap key => value
                map.put(KEY_ARTIST, parser.getValue(e, KEY_ARTIST));
                map.put(KEY_THUMB_URL, parser.getValue(e, KEY_THUMB_URL));

                // adding HashList to ArrayList
                songsList.add(map);
            }

            list=(ListView)findViewById(R.id.list);
            adapter= new WbAdapter(POSTS.this, songsList);        
            list.setAdapter(adapter);
        }   
    }
} 
```

`XMLParser`班级 ：

```
package com.sta.map;

import java.io.IOException;
import java.io.StringReader;
import java.io.UnsupportedEncodingException;

import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;
import javax.xml.parsers.ParserConfigurationException;

import org.apache.http.HttpEntity;
import org.apache.http.HttpResponse;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.util.EntityUtils;
import org.w3c.dom.Document;
import org.w3c.dom.Element;
import org.w3c.dom.Node;
import org.w3c.dom.NodeList;
import org.xml.sax.InputSource;
import org.xml.sax.SAXException;

import android.util.Log;

public class XMLParser {

    // constructor
    public XMLParser() {

    }

    /**
     * Getting XML from URL making HTTP request
     * @param url string
     * */
    public String getXmlFromUrl(String url) {
        String xml = null;

        try {
            // defaultHttpClient
            DefaultHttpClient httpClient = new DefaultHttpClient();
            HttpPost httpPost = new HttpPost(url);

            HttpResponse httpResponse = httpClient.execute(httpPost);
            HttpEntity httpEntity = httpResponse.getEntity();
            xml = EntityUtils.toString(httpEntity);

        } catch (UnsupportedEncodingException e) {
            e.printStackTrace();
        } catch (ClientProtocolException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
        // return XML
        return xml;
    }

    /**
     * Getting XML DOM element
     * @param XML string
     * */
    public Document getDomElement(String xml){
        Document doc = null;
        DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
        try {

            DocumentBuilder db = dbf.newDocumentBuilder();

            InputSource is = new InputSource();
                is.setCharacterStream(new StringReader(xml));
                doc = db.parse(is); 

            } catch (ParserConfigurationException e) {
                Log.e("Error: ", e.getMessage());
                return null;
            } catch (SAXException e) {
                Log.e("Error: ", e.getMessage());
                return null;
            } catch (IOException e) {
                Log.e("Error: ", e.getMessage());
                return null;
            }

            return doc;
    }

    /** Getting node value
      * @param elem element
      */
     public final String getElementValue( Node elem ) {
         Node child;
         if( elem != null){
             if (elem.hasChildNodes()){
                 for( child = elem.getFirstChild(); child != null; child = child.getNextSibling() ){
                     if( child.getNodeType() == Node.TEXT_NODE  ){
                         return child.getNodeValue();
                     }
                 }
             }
         }
         return "";
     }

     /**
      * Getting node value
      * @param Element node
      * @param key string
      * */
     public String getValue(Element item, String str) {     
            NodeList n = item.getElementsByTagName(str);        
            return this.getElementValue(n.item(0));
        }
} 
```

**编辑1：**在清单中我发现了这段代码：

```
<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="16" /> 
```

我删除了这部分`android:targetSdkVersion="16"`，解析变得非常快

为什么 ？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T23:38:53.600

我发现在大文件上，XMLParser 的性能很差，而且非常消耗内存。特别是如果 xml 中的一个节点非常大，例如编码位图。想想看，它必须一次将整个字符串加载到内存中。我切换到自己解析文件，因为我只寻找一个特定部分并使用 BufferedInputStream 读取数据以避免内存峰值。

这可能不是您的问题，但要知道对于非常大的文件，XMLParser 不可用。

# javascript - 在 processing.js 中更改画布大小

> ID：14531714
> 
> 赞同：0
> 
> 时间：2013-01-25T23:03:23.157
> 
> 标签：javascript, html, canvas, processing, processing.js

我的 html 文件中有代码：

```
 <p><canvas id="canvas1" width="1000" height="200"></canvas></p> 
```

但改变宽度和高度根本不会影响画布大小。为什么是这样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T23:31:45.050

您也可以在 css 和 javascript 中定义画布的尺寸。

Processing.js 的文档显示了一个名为 setup() 的函数：http: [//processingjs.org/reference/size_/](http://processingjs.org/reference/size_/)

找到您的脚本调用它的位置并设置您自己的值。

# c# - 在 ByteTagVisualization 上引发 ArgumentException

> ID：14531718
> 
> 赞同：3
> 
> 时间：2013-01-25T23:03:43.527
> 
> 标签：c#, pixelsense, argumentexception

我是在 stackoverflow 上发帖的新手，也是在 C# 中为 Microsoft Surface 编码的新手——但是我继承了别人的代码来适应。

尝试设置 ByteTagVisualizationDefinition 的源时出现以下错误

```
'markup://1/file:///C:/Users/PJ/Documents/Visual Studio 2010/Projects/Rememo/Rememo/SurfaceWindow1.xaml%230/reminderTags.xaml' is not a valid value for property 'Source'.

at System.Windows.DependencyObject.SetValueCommon(DependencyProperty dp, Object value, PropertyMetadata metadata, Boolean coerceWithDeferredReference, Boolean coerceWithCurrentValue, OperationType operationType, Boolean isInternal) at 

Microsoft.Expression.Platform.WPF.WpfDependencyPropertyImplementation.SetValue(Object target, Object valueToSet) at 
Microsoft.Expression.DesignModel.Metadata.DependencyPropertyReferenceStep.SetValue(Object target, Object valueToSet) at 
Microsoft.Expression.DesignModel.Core.InstanceBuilderOperations.SetValue(Object target, IProperty propertyKey, Object value) at 
Microsoft.Expression.DesignModel.InstanceBuilders.ClrObjectInstanceBuilder.ModifyValue(IInstanceBuilderContext context, ViewNode target, IProperty propertyKey, Object value, PropertyModification modification) at 
Microsoft.Expression.DesignModel.InstanceBuilders.DependencyObjectInstanceBuilderBase`1.ModifyValue(IInstanceBuilderContext context, ViewNode target, IProperty propertyKey, Object value, PropertyModification modification) at 
Microsoft.Expression.DesignModel.InstanceBuilders.ClrObjectInstanceBuilder.UpdateProperty(IInstanceBuilderContext context, ViewNode viewNode, IProperty propertyKey, DocumentNode valueNode) 
```

随着

```
Error 1 'markup://1/file:///C:/Users/PJ/Documents/Visual Studio 2010/Projects/Rememo/Rememo/SurfaceWindow1.xaml%230/reminderTags.xaml' 
is not a valid value for property 'Source'. C:\Users\PJ\Documents\Visual Studio 2010\Projects\Rememo\Rememo\SurfaceWindow1.xaml 
```

我试图访问此源的代码是：

```
<Grid Background="{StaticResource WindowBackground}">
  <s:TagVisualizer>
      <s:TagVisualizer.Definitions>
         <s:ByteTagVisualizationDefinition Value="0xC0" Source="reminderTags.xaml" />
      </s:TagVisualizer.Definitions>
  </s:TagVisualizer> 
```

当我编译代码并在 Surface Simulator 上运行它时，它会成功运行 - 我不知道为什么会出现这个错误？我正在按照微软教程进入这个阶段，现在对出了什么问题感到有些茫然。

# c# - C# 客户端 - php web 服务器 - couchbase db - 如何在它们之间传递数据？

> ID：14531719
> 
> 赞同：-1
> 
> 时间：2013-01-25T23:03:50.607
> 
> 标签：c#, php, web-services, couchbase

我试图了解一个系统的基本流程，包括：

1.  `C#`客户端/程序/应用程序将查询`PHP`服务器。
2.  `PHP`服务器。
3.  `Couchbase`上运行的服务器`Linux`。

在客户端，我有一些课程，`class MyClass {int,string,list etc}`.

根据其他问题和答案，流程应如下所示：

`C#`客户端类->序列化到`JSON`->作为字符串发布到`PHP`页面->（在`PHP`页面上）将`JSON`字符串反序列化到`PHP`类->发布到`Couchbase`->获取结果->序列化到`JSON`->作为`JSON`字符串发布并返回到`C#`客户端->等

1.  那是对的吗？有什么建议么？
2.  什么是最好的工具/包，最简单的从`JSON`和到序列化`JSON`的方法`PHP`？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T23:12:05.990

我不会使用 XML。XML 仍然有它的用途，但是对于这种设置，行业正在转向 JSON。C# 客户端将对您希望发送到 PHP 服务的数据使用某种 JSON 序列化方法。然后 PHP 应用程序可以反序列化它并执行适当的操作。从那里你像往常一样写入你的数据库。

.Net 附带 JavascriptSerializer，它适用于基本情况，但您可能应该考虑使用 JSON.Net，因为它提供了更多的灵活性。

PHP 也有一些内置的 JSON 序列化的东西，但我没有使用它，所以我不能说它的工作情况。然而这篇文章是由 JSON.org 链接的，所以它应该给你一个很好的主意：[http ://gggeek.altervista.org/sw/article_20061113.html](http://gggeek.altervista.org/sw/article_20061113.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T00:02:17.710

Couchbase 2.0 是一个允许您直接存储文档的数据库。获得 JSON 字符串后，您可以使用 PHP 客户端 SDK 将其存储到 Couchbase。

也就是说，如果您有一个 PHP 对象并且您可以使用 PHP 中可用的 json_encode()/json_decode() 函数。

您可以查看 Couchbase 的入门和教程：- [http://www.couchbase.com/docs/couchbase-sdk-php-1.1/tutorial.html](http://www.couchbase.com/docs/couchbase-sdk-php-1.1/tutorial.html)

您还可以查看这个感兴趣的库，它允许您轻松地使用 PHP 和 Couchbase 进行开发：- [https://github.com/Basement/Basement](https://github.com/Basement/Basement) 您可以查看使用它，或者查看它如何使用 PHP 和 JSON。

# .net - 有没有办法模拟没有公共构造函数的 DB2Exception？

> ID：14531722
> 
> 赞同：1
> 
> 时间：2013-01-25T23:04:17.243
> 
> 标签：.net, unit-testing, mocking, db2

我正在编写单元测试，我想模拟`DB2Exception`抛出 a 的场景。

问题是它没有公共构造函数，所以我不能创建它，而且大多数单元测试框架（我使用带有 nunit 的 Rhino Mocks）也不能为它们创建存根。

我是否坚持无法测试这种交互？

（详细信息：这是在- 版本 8.1.2.1中`DB2Exception`定义的）`IBM.Data.DB2.dll`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T23:11:54.260

我希望`DB2Exception`有一些派生类，但可惜 - 不，它是密封的。[这是类描述](http://publib.boulder.ibm.com/infocenter/db2luw/v9r5/index.jsp?topic=%2Fcom.ibm.swg.im.dbclient.adonet.ref.doc%2Fdoc%2FDB2ExceptionClass.html)。

由于 DB2Exceptions 显然是由某人抛出的，因此可能有一个`internal`构造函数。您必须借助反射才能使用它。曾经有一个 .NET Reflector 可以分析 MSIL 并生成 C# 代码，但现在它需要花钱。你可以在这里找到一些[替代品](https://stackoverflow.com/questions/2425973/open-source-alternatives-to-reflector)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T23:39:28.943

**编辑**我以前的帖子根本没有帮助，这是我的第二次尝试。虽然您可能仍想在此执行一些模拟元素，但无需查看您的代码，我不知道这种方法的哪些元素会起作用，哪些不会。无论如何，这是我在尝试测试 catch 块或一般异常时采用的一种方法：

```
public class A
{
    public void ExecuteDB2Query(string query, DB2Connection connection)
    {
        try
        {
            // Code for executing the DB2 query
        }
        catch(DB2Exception ex)
        {
            // Catch block you are trying to test
        }
    }

    // Actual method
    public void MyMethod()
    {
        var query = "Select * FROM TableInApplication";
        var connection = new DB2Connection("DATABASE=GOODDB");
        ExecuteDB2Query(query, connection);
    }
}

[Test]
public void MyMethod_CallsExecutDB2Query()
{
    // Test that MyMethod is calling ExecuteDB2Query   
}

// Intentionally pass it bad data to test your catch block
// under the notion that the code that executes in the application 
// will be using the same method and thus the same catch block
[Test]
public void ExecuteDB2Query_Handles_Exception()
{
    var queryString = "Select* FROM NonExistentTable";
    var connection = new DB2Connection("DATABASE=BADDB");
    var aClass = new A();
   Assert.Throws<DB2Exception>(() => aClass.ExecuteDB2Query(queryString, connection));
} 
```

这不是处理这个问题的最优雅的方法，但如果你不能排除异常，那么我猜想，通过触发异常来分开代码的职责并分别测试每个部分是下一个最好的事情。

# ruby - 匹配条件的数组的第一个元素的 Ruby 抓取索引

> ID：14531731
> 
> 赞同：1
> 
> 时间：2013-01-25T23:05:07.947
> 
> 标签：ruby, arrays, indexing

我遇到了这个问题，想知道是否有更好的方法来做到这一点。

给定数组：

```
options = [
  SelectItem.new(-1, "String 1"),
  SelectItem.new(0, "String 2"),
  SelectItem.new(7, "String 3"),
  SelectItem.new(14, "String 4")
] 
```

获取与特定条件匹配的第一个元素的索引的最佳方法是什么？

我的解决方案是：

```
my_index = 0
options.each_with_index do |o, index|
  if o.value == some_value
    my_index = index
    break
  end
end 
```

**还有另一种方法可以做到这一点吗？** `Enumerable#find`返回满足条件的第一个对象，但我想要返回满足条件的第一个对象的索引。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-25T23:09:00.990

```
a=[100,200,300]
a.index{ |x| x%3==0 }   # returns 2 
```

对于您的情况：

```
options.index{ |o| o.value == some_value } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T23:13:21.670

采用`Array#index`

```
> a = ['asdf', 'qwer', '1234']
> a.index { |e| e =~ /\d/ }
=> 2 
```

# php - 使用 PHP 重定向 post 请求

> ID：14531743
> 
> 赞同：0
> 
> 时间：2013-01-25T23:06:35.103
> 
> 标签：php, http, post, get

我需要一个 PHP 脚本来获取 POST 请求并将其作为 GET 请求重定向到另一个页面，其中包含 URL 中的所有参数。

这可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-25T23:11:24.697

您可以使用该函数[`http_build_query()`](http://php.net/manual/function.http-build-query.php)从`$_POST`.

然后将其附加到重定向 URL 并使用[`header()`](http://php.net/manual/function.header.php)Location 进行重定向，例如：

```
$newURL = 'http://example.com/script.php?' . http_build_query($_POST);
header("Location: {$newURL}"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T23:11:37.050

```
$URL = "http://thatpage.com/thatpage.php?";
foreach($_POST as $key=>$value) {
    $URL +="$key=$value&";
} 
```

然后打开那个 $URL 页面

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T23:09:50.133

您需要解析 $_POST 变量才能创建完整的 GET URL

这个问题可以帮助您解析 $_POST 数组 [PHP Parse $_POST Array?](https://stackoverflow.com/questions/12021817/php-parse-post-array)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T23:15:21.867

就像是：

```
foreach($_POST as $k => $v)
{
    $getString .= $k . '=' . $v . '&';
} 
```

应该以正确的格式格式化 POSTed 变量。

# scala - Scala 寻找更优雅的方式

> ID：14531745
> 
> 赞同：2
> 
> 时间：2013-01-25T23:06:52.703
> 
> 标签：scala, functional-programming

我是 Scala 和函数式编程的新手。

我正在解决你必须阅读数字，然后是整数的问题。之后，您应该计算所有整数中所有数字的总和。

这是我的代码

```
def sumDigits(line: String) = 
    line.foldLeft(0)(_ + _.toInt - '0'.toInt)

  def main(args: Array[String]) {
    val numberOfLines = Console.readInt
    val lines = for (i <- 1 to numberOfLines) yield Console.readLine   
    println(lines.foldLeft(0)( _ + sumDigits(_)))
  } 
```

有没有更优雅或更高效的方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-25T23:13:09.200

`sumDigits()`可以通过以下方式更轻松地实现`sum`：

```
def sumDigits(line: String) = line.map(_.asDigit).sum 
```

第二个`foldLeft()`也可以替换为`sum`：

```
lines.map(sumDigits).sum 
```

这将我们带到了最终版本（注意没有`main`，而是用 extend `App`）：

```
object Main extends App {

    def sumDigits(line: String) = line.map(_.asDigit).sum

    val lines = for (_ <- 1 to Console.readInt) yield Console.readLine   
    println(lines.map(sumDigits).sum)

} 
```

或者如果你真的想在一行中尽可能地挤压，内联`sumDigits`（不推荐）：

```
lines.map(_.map(_.asDigit).sum).sum 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-25T23:38:07.430

我喜欢紧凑的代码，所以我可能会（如果我真的想简洁的话）

```
object Reads extends App {
  import Console._
  println( Seq.fill(readInt){readLine.map(_ - '0').sum}.sum )
} 
```

它设置内联的行数并随时进行处理。但是，没有错误检查。您可以`.filter(_.isDigit)`在 the 之后添加一个权利，`readLine`以至少丢弃非数字。您也可以`def p[A](a: A) = { println(a); a }`将读取内容包装起来，`p`以便查看输入的内容（默认情况下，在某些平台上，至少屏幕没有回声）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-25T23:36:34.633

单线答案：

```
 Iterator.continually(Console.readLine).take(Console.readInt).toList.flatten.map(_.asDigit).sum 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T23:18:33.327

`line`首先，您必须对现有的十进制整数子字符串进行某种解析：

```
val numbers = "5 1 4 9 16 25"
val ints = numbers.split("\\s+").toList.map(_.toInt) 
```

然后你想把第一个作为计数，其余的保持解码和求和：

```
val count :: numbers = ints 
```

然后使用内置的 sum 方法：

```
val sum = numbers.sum 
```

总共在 REPL 中：

```
scala> val numbers = "5 1 4 9 16 25"
numbers: String = 5 1 4 9 16 25

scala> val ints = numbers.split("\\s+").toList.map(_.toInt)
ints: List[Int] = List(5, 1, 4, 9, 16, 25)

scala> val count :: numbers = ints
count: Int = 5
numbers: List[Int] = List(1, 4, 9, 16, 25)

scala> val sum = numbers.sum
sum: Int = 55 
```

如果你想对前导数做一些事情，你可以验证它是否正确：

```
scala> assert(count == numbers.length) 
```

由于断言通过，因此不会产生任何输出。

# hadoop - 存在多个 dfs.data.dir 时如何将数据复制到 HDFS

> ID：14531749
> 
> 赞同：0
> 
> 时间：2013-01-25T23:07:23.680
> 
> 标签：hadoop, hdfs

`dfs.data.dir`允许datanode存储数据块的目录不止一个。将数据复制到 HDFS 时，数据如何跨目录分布？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T23:07:23.680

当`dfs.data.dir`有多个值时，数据以循环方式复制到 HDFS。如果其中一个目录的磁盘已满，则将在其余目录上继续循环数据复制。

# ios - 为什么我的 UIToolbar 在旋转时改变宽度而不是高度？

> ID：14531750
> 
> 赞同：0
> 
> 时间：2013-01-25T23:07:24.023
> 
> 标签：ios, objective-c, rotation

我在 iOS6 中工作，当设备旋转时，我的 UIToolbar 的高度并没有变薄，尽管它正在扩大以覆盖增加的长度。这是我的代码：

```
-(void)loadToolBar:(NSString *)t {

            //Creates a toolbar.

[bar removeFromSuperview];
if (UIDeviceOrientationIsLandscape([[UIDevice currentDevice] orientation])) {
    bar = [[UIToolbar alloc] initWithFrame:CGRectMake(0, 0, 480, 32)];
}
else bar = [[UIToolbar alloc] initWithFrame:CGRectMake(0, 0, 320, 44)];
bar.autoresizingMask=UIViewAutoresizingFlexibleWidth;
bar.autoresizingMask=UIViewAutoresizingFlexibleHeight;
bar.autoresizingMask=UIViewAutoresizingFlexibleBottomMargin;
} 
```

我还从[UIToolbar height on device rotation](https://stackoverflow.com/questions/5219833/uitoolbar-height-on-device-rotation)添加了这个方法，但似乎没有什么不同：

```
- (void) layoutForInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
// Adjust the toolbar height depending on the screen orientation
CGSize toolbarSize = [bar sizeThatFits:self.view.bounds.size];
bar.frame = (CGRect){CGPointMake(0.f, CGRectGetHeight(self.view.bounds) - toolbarSize.height), toolbarSize};
webV.frame = (CGRect){CGPointZero, CGSizeMake(CGRectGetWidth(self.view.bounds), CGRectGetMinY(bar.frame))};
} 
```

关于我做错了什么有什么想法吗？

# nservicebus - nservicebus，天蓝色和事务范围

> ID：14531753
> 
> 赞同：0
> 
> 时间：2013-01-25T23:07:32.937
> 
> 标签：nservicebus, sql-server-2012, azure-worker-roles

我发生了一件奇怪的事情，我怀疑这与 nservicebus 中的事务范围有关，但我认为在我走错方向之前应该问一下。

这是我的问题：我有一个托管在 azure worker 角色中的端点，与 azure queues 进行通信。我正在我的一些处理程序中使用针对 sql server 2012 的实体框架 5 进行非常简单的数据库写入。一切都很好并且一切正常，直到我将工作角色扩展到多个实例。

当我这样做时，我开始出现零星的死锁错误：错误 1205：事务（进程 ID）与另一个进程在资源上死锁，并被选为死锁受害者。重新运行事务。

我应该考虑更改端点中的默认隔离级别，还是我在这里看错了方向。

我对所有语句都进行了解释，所以我确信没有完整的扫描，并且数据库没有负载；似乎导致这种情况的唯一变量是在 azure 中使用更多实例水平扩展。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T17:00:04.530

将默认隔离模式更改为已提交读取解决了该问题。谢谢！

# asp.net-web-api - asp.net webapi 路由；字符串参数被映射

> ID：14531754
> 
> 赞同：0
> 
> 时间：2013-01-25T23:07:39.893
> 
> 标签：asp.net-web-api, url-routing

我想要一个像这样的网址

```
/foo/bar/1.2.3 
```

映射到动作

```
public void Get(string barValue, string version) 
```

在一个名为 FooController 的控制器中。

我定义了以下路线

```
config.Routes.MapHttpRoute(
    name: "FooRoute",
    routeTemplate: "foo/{barValue}/{version}",
    defaults: new { controller = "Foo", action = "Get" }
); 
```

适用于`foo/bar/121`或`/foo/bar/qwerty`但不适用于`/foo/bar/1.2/`

我如何修复它以映射到字符串的第二个参数中的任何内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T20:54:18.023

asp.net 文件处理程序可能正在拦截带有点的请求，例如 /foo/bar/1.2/。您可以通过添加禁用此行为

```
<system.webServer>
   <modules runAllManagedModulesForAllRequests="true" />
</system.webServer> 
```

到您的 web.config。

# mysql - Mysql 虚拟列在 WHERE

> ID：14531763
> 
> 赞同：2
> 
> 时间：2013-01-25T23:08:56.820
> 
> 标签：mysql

我有以下 MySQL 查询：

```
SELECT from_unixtime( `lastlogin` ) AS `last`
FROM `players` WHERE `lastlogin` <> 0 AND `last` < '2012-10-01 00:00:00'; 
```

我得到以下结果：

# 1054 - 'where 子句'中的未知列'last'

`last`不能在 WHERE 语句中使用，因为这当然是一个虚拟列并且不存在。“lastlogin”包含一个 UNIX 时间戳。

但是，有没有在 where 语句中使用虚拟列的正确方法？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T23:49:02.723

**TL;博士**

所选答案中的查询“应该有效”；用平凡的集合表现很好。但对于大型集，这将是地狱般的表现。

为了获得最佳性能，我们希望使用在范围条件中引用裸列的查询。像这样的东西：

```
SELECT from_unixtime( `lastlogin` ) AS `last`
  FROM `players`
 WHERE `lastlogin` > 0
   AND `lastlogin` < UNIX_TIMESTAMP('2012-10-01 00:00:00') 
```

**原始答案**

列别名`last`（在您的查询中）不能在 WHERE 子句（您的查询）中引用。这是一条 MySQL 语法规则。（基本上，该规则的原因是该别名引用的表达式在处理 WHERE 子句中的谓词时不可用。）

`HAVING`但是可以在子句的谓词中引用该列别名。该`HAVING`子句几乎在执行计划结束时得到处理。这可行，但从性能的角度来看是有问题的：

```
SELECT from_unixtime( `lastlogin` ) AS `last`
  FROM `players` WHERE `lastlogin` <> 0 
 HAVING `last` < '2012-10-01 00:00:00'; 
```

其执行计划几乎等同于使用内联视图（创建派生表）并针对派生表运行 SELECT（从性能角度来看这也是有问题的）：

```
SELECT d.*
  FROM (
         SELECT from_unixtime( `lastlogin` ) AS `last`
         FROM `players` WHERE `lastlogin` <> 0 
       ) d
WHERE `last` < '2012-10-01 00:00:00'; 
```

列别名`last`可以在这里引用，因为内部查询（别名为 d 的内联视图）首先运行，结果集存储为 MyISAM 表。然后外部查询针对 MyISAM 表运行。在这个查询中，`last`它引用了表中的列名，因此可以在 WHERE 子句中引用它。

重要的提示：

所以那种回答你问的问题。但，

你真的不想那样做！

这种方法对于大型集合会表现出问题的性能，因为此查询本质上是创建表的副本，然后在副本上运行查询。将对表中的每一行执行 from_unixtime 函数（除了 lastlogin 为 NULL 或等于 0 的行。）

从性能的角度来看，使用单个查询（无内联视图）并在 WHERE 子句中的裸列上使用谓词要好得多。

理想情况下，`lastlogin`将存储为 DATETIME 或 TIMESTAMP 数据类型。但是，如果该列是整数，那么将谓词中的文字常量转换为整数，然后将其与裸列进行比较会更好（性能方面）。这将允许 MySQL 至少考虑对具有`lastlogin`作为前导列的索引进行范围扫描，而不是`from_unixtime`对每一行执行函数，以与文字进行比较。

MySQL 提供了一个方便的`UNIX_TIMESTAMP()`函数来将 DATETIME 转换为整数值（它基本上是函数的逆`FROM_UNIXTIME()`函数，但有一些注意事项。

为了获得最佳性能，我们需要以下形式的查询：

```
SELECT from_unixtime( `lastlogin` ) AS `last`
  FROM `players`
 WHERE `lastlogin` <> 0
   AND `lastlogin` < UNIX_TIMESTAMP('2012-10-01 00:00:00') 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-25T23:10:42.750

这应该有效：

```
SELECT a.`last`
FROM   (SELECT From_unixtime(`lastlogin`) AS `last` 
        FROM   `players` 
        WHERE  `lastlogin` <> 0) a 
WHERE  a.`last` < '2012-10-01 00:00:00'; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-25T23:20:23.873

如果在子查询中定义列别名，则可以引用列别名，但这效率不高，因为子查询必须为*所有*行生成临时结果集，只是为了让它们被外部查询中的条件丢弃。尽早将结果集减少为匹配行会更有效。

如果您的`lastlogin`列是 unixtime 格式，您可以将其与 WHERE 子句中的常量表达式进行比较：

```
SELECT FROM_UNIXTIME( `lastlogin` ) AS `last`
FROM `players` WHERE `lastlogin` < UNIX_TIMESTAMP('2012-10-01 00:00:00'); 
```

这可以从该列上的索引中受益并减少结果集的大小。

我取出了，`lastlogin <> 0`因为无论如何你都不应该存储零日期。如果您使用零作为表示“无价值”的特殊值，那么您应该使用 NULL 来代替。

* * *

重新评论：是的，正确的函数名称是[UNIX_TIMESTAMP()](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_unix-timestamp)。感谢您的更正，我已经编辑了上面的内容。

# c++ - std::move 模板参数是如何推导出来的？

> ID：14531766
> 
> 赞同：10
> 
> 时间：2013-01-25T23:09:13.670
> 
> 标签：c++, templates, c++11

假设我们有：

```
foo(A&& a); 
```

如果你这样做

```
A a;
foo(a); 
```

它不会编译并且抱怨不能将左值绑定到 A&&。这很好。

然而，鉴于 std::move 的签名，

```
template<class T> typename remove_reference<T>::type&& std::move(T&& a); 
```

看起来它需要一个右值引用，就像在 foo 中一样，为什么下面的代码符合？

```
A a;
std::move(a); 
```

不是`a`左值吗？

此外，据说编译将实例化：

```
typename remove_reference<A&>::type&& std::move(A& && a); 
```

我不明白为什么不是：

```
typename remove_reference<A>::type&& std::move(A && a); 
```

在我看来`a`是类型`A`，不是`A&`。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-25T23:10:07.857

不`move`，不采用右值引用，它采用被社区称为*通用引用的东西。*被类型推导的模板参数的行为根据*引用折叠*的规则。这表示：

*   如果`T`是`K`，那么`T&&`将只是`K&&`；
*   如果`T`是`K&`，那么`T&&`将崩溃到`K&`；
*   如果`T`是`K&&`的话，`T&&`就会崩溃到`T&&`。

这就像0 和1的逻辑`&`与：`&&``&``&&`

```
 &    &&
   |-----------|
&  |  &  |  &  |
   |-----|-----|
&& |  &  | &&  |
   |-----------| 
```

这就是`move`右值和左值的工作方式。

例子：

```
template<typename T>
void f(T&&);

f<int>   // T is int;   plugging int into T makes int&& which is just int&&
f<int&>  // T is int&;  plugging int& into T is int& && which collapse to int&
f<int&&> // T is int&&; plugging int&& into T is int&& && which collapse to int&& 
```

请注意，引用折叠只发生在模板参数上；你不能直接输入`int&& &&`并期望它编译。当然，您不会像那样手动指定类型。这些只是为了显示引用折叠到什么。

所以你真的会这样称呼它：

```
int i;

f(i); // T is int&;  int& && collapses to int&
f(4); // T is int&&; int&& && collapses to int&& 
```

引用折叠也是`move`不返回 a的原因：如果是左值引用，`T&&`引用将折叠并仅返回左值引用。您确实要获得非引用类型，以便真正表示“右值引用”。`T``move``remove_reference``&&`

您可以在这里了解更多信息：http: [//isocpp.org/blog/2012/11/universal-references-in-c11-scott-meyers](http://isocpp.org/blog/2012/11/universal-references-in-c11-scott-meyers)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-25T23:13:56.163

`T&&` *类型推导上下文中*的句法形式（包括*模板参数推导*，但例如也推导声明为的变量的类型`auto`）并不*表示*右值引用，而是斯科特迈耶斯所说的[*通用引用*]。请注意，只有非常特殊的*句法形式* `T&&`表示通用引用，而其他类似的形式不被视为如此。例如：

```
template<typename T> 
void foo(T&& t); <-- T&& is a universal reference

template<typename T> 
void foo(T const&& t); <-- T const&& is NOT a universal reference

template<typename T> 
void foo(S<T>&& t); <-- S<T>&& is NOT a universal reference

template<typename T> 
struct S { void foo(T&& t); }; <-- T&& is NOT a universal reference 
```

通用引用可以绑定到左值和右值。如果`A`绑定了类型的左值，则`T`推断为 be并且由于*引用折叠*规则（变为） `A&`，参数的类型解析为（左值引用）。如果绑定了类型的右值，则推断为，并且参数的类型解析为（右值引用）。`A&`*`A& &&``A&``A``T``A``A&&`*

 *[**注意**：*引用折叠规则可能看起来很复杂，但实际上非常简单：引用 Stephan T. Lavavej 的话，“左值引用具有传染性”，这意味着当表单`T&& &`、`T& &`或`T& &&`被实例化时，它们总是解析为`T&`- 只有表单`T&& &&`被解析为`T&&`*]

这就是为什么当参数是**左值**`std::move`时函数模板将被实例化如下（推导为 be ）：**`T``T&`**

 **```
typename remove_reference<A&>::type&& std::move(A& && a); 
```

**而当参数是右值**时，它将被实例化如下（`T`推导为`A`）

```
typename remove_reference<A>::type&& std::move(A&& a); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-25T23:46:26.323

尽管其他人说了什么，但该标准只讨论了右值引用。

这对 std::move 起作用的关键是模板参数推导规则中的一个明确的特殊规则：

> [...] 如果 [声明的函数参数类型] 是对 cv 非限定模板参数的右值引用，并且参数是左值，则使用类型“对 A 的左值引用”代替 A 进行类型推导。 [ ...]

另一部分是参考折叠的规则，它说

> 如果 [...] 类型模板参数 [...] 表示类型 TR 是对类型 T 的引用，则尝试创建类型“对 cv TR 的左值引用”会创建类型“对 T 的左值引用”，而尝试创建类型“对 cv TR 的右值引用”会创建类型 TR。

现在在`template<class T> typename remove_reference<T>::type&& std::move(T&& a);`函数参数中 a 匹配上述规则（“对 cv 非限定模板参数的右值引用”），因此如果参数是左值，推导的类型将是对参数类型的左值引用。在您的情况下，这导致 T = A&。

将其代入移动收益率声明

```
remove_reference<A&>::type&& std::move<A&>(A& && a); 
```

使用 remove_reference 的定义和引用折叠规则（对 TR => TR 的右值引用），可以做到这一点：

```
A&& std::move<A&>(A& a); 
```

正如其他答案中提出的， Scott Meyer 的*通用引用*概念是一种有用的方式来记住类型推导规则和引用折叠规则组合的这种令人惊讶的效果：对推导类型的右值引用可能最终成为左值引用（如果该类型可以推断为左值引用）。但是标准中没有*通用参考*。正如斯科特迈耶斯所说：这是一个谎言——但一个比真相更有帮助的谎言......

请注意，std::forward 对此主题有所不同：它使用额外的间接来防止参数推导（因此必须明确给出类型），但还使用引用折叠将左值作为左值转发，将右值作为右值转发。***

# javascript - 引导弹出窗口不显示？

> ID：14531767
> 
> 赞同：0
> 
> 时间：2013-01-25T23:09:24.983
> 
> 标签：javascript, jquery, node.js, twitter-bootstrap

这个输入在jade制作的代码中

```
input(type='hidden',id='latitud',name='lat',rel='popover', data-content='Marque en el mapa la ubicacion en el mapa.') 
```

我用脚本配置了一个引导弹出框

```
$('#latitud').popover({placement:'bottom',trigger: 'manual',selector:'#map'}); 
```

为什么弹出窗口显示偏移容器而不是 div `#map`？

我用 jquery.validator 验证了

```
$('#latitud').valid() 
```

我应用这条规则

```
lat:{required:true}, 
```

# android - Android-PullParser 返回不同的字符串类型？

> ID：14531769
> 
> 赞同：1
> 
> 时间：2013-01-25T23:09:39.350
> 
> 标签：android, string, if-statement, xmlpullparser

这是我的代码：

```
String Attr = parser.getAttributeValue(null, "name");
            String Text = parser.getText();
            if (Attr == "id"){
                parser.nextTag();
            }else if(Attr == "Lektion"){
                vocable.setUnit(Text);
                parser.nextTag();
            }else if(Attr == "Russisch"){
                vocable.setRussian(Text);
                parser.nextTag();
            }else if(Attr == "Umschrift"){
                vocable.setTranscript(Text);
                parser.nextTag();
            }else if(Attr == "Einzelwort"){
                int tf = Integer.parseInt(Text);
                Boolean bool = null;
                    switch (tf){
                    case 0:
                        bool= false;
                        break;
                    case 1:
                        bool= true;
                        break;
                    }
                vocable.setSingleWord(bool);
                parser.nextTag();
            }else if(Attr == "Deutsch"){
                vocable.setGerman(Text);
                parser.nextTag();
            } 
```

我的xml文件的结构：

```
 <database name="russisch">
    <table name="vokabel">
        <column name="Lektion">1</column>
        <column name="id">1</column>
        <column name="Russisch">Как дела?</column>
        <column name="Umschrift">kak dilá</column>
        <column name="Deutsch">Wie geht’s?</column>
        <column name="Einzelwort">0</column>
    </table>
    <table name="vokabel">
        <column name="id">2</column>
        <column name="Lektion">1</column>
        <column name="Russisch">Очень хорошо!</column>
        <column name="Umschrift">ótschin charaschó</column>
        <column name="Deutsch">Sehr gut!</column>
        <column name="Einzelwort">0</column>
    </table>
</database> 
```

如果我试图将属性值与给定的值进行比较，它永远不会返回 true，因此 if 语句永远不会被执行。我尝试手动设置 sring 并且它有效。因此我假设我只需要格式化返回的字符串，但我不知道如何。我真的希望有人可以提供帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T23:47:26.693

您不能将字符串与等号运算符进行比较：

```
Attr == "Einzelwort" 
```

因为 String 是一个对象。equals 运算符测试两个对象是否是同一个对象，因此您将 Attr 与不是同一个对象的“Einzelwort”进行比较。

相反，请使用比较字符串的字符串值的 equals() 方法。

```
Attr.equals("Einzelwort") 
```

# jquery - jQuery 到 HTML 内联样式声明的 FadeOut 背景图像

> ID：14531772
> 
> 赞同：2
> 
> 时间：2013-01-25T23:09:59.773
> 
> 标签：jquery, html, styles, inline, fadeout

我一直在尝试`fadeOut`仅将 Jquery 用于通过内联样式而不是 CSS 声明的 div 中的背景图像。例如：

```
<div class="big-video-wrap-image" style="background:url(images/image1.jpg) repeat;"> 
```

我应该如何对 div 类的背景样式应用淡出效果，以便 div 保留但只有背景图像消失（通过淡出）。

* * *

可能不必要的信息：分享我想做的事情会带来一些额外的问题，但我希望分享这些细节将描绘出我正在做的事情的完整画面。

我在用着：

*   jQuery 1.8.3
*   现代化 2.6.2
*   周期 2.9
*   缓和 1.3
*   漂亮的照片
*   BigVideo.js 与所有依赖库。

[BigVideo.js](http://dfcb.github.com/BigVideo.js/)在网站（或理论上任何 div）的背景中显示动态大小的视频。

但它不适用于移动设备。所以我使用 Modernizr 来检查设备，所以运行 BigVideo.js 的脚本设置如下：

```
var BV = new $.BigVideo();
if (Modernizr.touch) {
} else {
    BV.init();
    BV.show($('.big-video-play').attr('data-video'),{altSource:$('.big-video-play').attr('data-video2')});
    $(".big-video-wrap-image").attr('[style*="background"]') /*No idea what should be on this line*/

} 
```

像这样的html：

```
<div class="big-video-wrap big-video-play" data-video="vids/vid1.mp4" data-video2="">
<div class="big-video-wrap-image" style="background:url(images/ally1.jpg) repeat;"> 
```

和外部CSS：

```
.big-video-wrap {
position: relative;
height: 100%;
width: 100%;
overflow: hidden;
}
.big-video-wrap-image {
position: relative;
height: 100%;
width: 100%;
overflow: hidden;
} 
```

这被用于响应式网站布局。这就是它现在的设置方式，bigvideo.js 都将视频扔到主体 div 的顶部，而不是正确的 div 类，当然，在视频加载时使第一帧/移动图像褪色也不起作用。

非常感谢您的帮助。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T23:22:51.057

一种方法是创建一个图像以定位在 div 上。然后去掉背景样式，淡出图像。

```
var $imageDiv = $(".big-video-wrap-image"),
    bgUrl     = $imageDiv.css('background-image').split('(')[1].replace(')', '') //Should probably be done in another way, feel free to fill in anyone,
    imgDummy  = new Image();

imgDummy.onload = function () {
    $(this).addClass('dummyImg').insertBefore($imageDiv).fadeOut();
    $imageDiv.removeAttr('style');
};

imgDummy.src = bgUrl; 
```

[http://jsfiddle.net/tbleckert/SkQ2Y/1/](http://jsfiddle.net/tbleckert/SkQ2Y/1/)

# php - 将用户购物篮连接到他们的用户帐户？PHP

> ID：14531774
> 
> 赞同：0
> 
> 时间：2013-01-25T23:10:08.947
> 
> 标签：php, mysql, e-commerce, shopping-cart

我对如何做到这一点感到困惑。假设用户在我的电子商务网站上创建了一个帐户，然后开始将产品添加到他们的购物篮中。如果我将用户的用户名和密码存储在数据库表中，并使用会话/cookie 来管理他们购物篮中的产品，我需要做什么才能将用户购物篮连接到他们的帐户，以便他们登录时在他们将能够看到他们以前存储的项目？

我是否首先允许用户登录，查询他们是否登录成功，然后为他们的用户名创建一个会话/cookie 变量？或者我是否必须将用户购物车项目存储在数据库中并将其与用户帐户表连接？

我对如何将购物篮物品存储到桌子上感到困惑。这甚至是正确的方法吗？

还没有代码，我想在开始编码之前正确创建数据库，只需要一些建议。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T23:30:56.090

如果您有两张表，一张用于用户，一张用于商品，您可以执行以下操作。

通过将 item_ids 添加和删除到序列化数组中来管理当前购物篮项目，您可以将其同时存储在用户表和会话中，使它们保持同步。例如，如果用户第一次访问您的商店（未登录，并且购物篮为空），您可以像这样创建会话。

```
session_start(); 
```

我们开始会议。

```
if (isset($_SESSION['current_basket']) {
    $current_basket = unserialize($_SESSION['current_basket']);
} else {
    $current_basket = array();
} 
```

因为这是我们的访问者第一次访问我们的页面，会话变量**current_basket**不会被设置，这意味着上面的 if 语句*不会*运行，而是在一个名为**current_basket**的变量中创建一个空的 PHP 数组。

现在，当访问者将商品添加到购物篮时，我们只需要数据库中的商品 ID 并将其添加到**current_basket**数组中。

```
$current_basket[] = $item_id; 
```

然后我们立即使用新数组更新会话变量，并在此过程中对其进行序列化。

```
$_SESSION['current_basket'] = serialize($current_basket); 
```

您现在有一个适当的、可用的数组，其中包含该人购物篮的所有产品 ID。

现在，让我们假设用户已登录。我们会检查这一点，然后再添加一个步骤。

```
$sql = "UPDATE users SET current_basket=" . serialize($current_basket) . " WHERE id=$user_id"
// Execute that query. 
```

在那里，现在相同的数组在数据库中，然后您可以在用户登录时将其拉取并设置为会话变量。

每次添加或删除产品时，您都可以运行这一系列步骤，从而在会话和数据库中保持更新。

为了解释，这显然是一个非常淡化的概念。显然，您需要更好地管理阵列。例如，如果产品已经存在，则不将其添加到购物篮中，从阵列中删除项目......等等。

关键是序列化数组，并始终存储在会话中，如果用户已登录，则存储在用户表中。

然后，当用户返回并登录时，您可以使用数据库中的数组为他们设置会话中的数组，从他们上次访问您的站点开始。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T23:27:19.883

我将拥有购物车表 cart_id / user_id / date_time_created，然后在购物车 ID 上建立一个项目表。

还添加了一种在这么多小时或几天后将 cart_id 和项目从表中转储的方法，否则您的数据库将变得庞大。

并让您的最终用户知道这些项目将在 x 时间后被转储。

# solr - 在实时网站中向客户公开 solr 查询的安全威胁

> ID：14531779
> 
> 赞同：1
> 
> 时间：2013-01-25T23:10:41.067
> 
> 标签：solr, security

我要建立一个网站，我打算使用 solr 进行搜索集成。它是一个电子商务网站。我想知道将 solr 查询格式暴露给本网站的用户是否有任何问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-28T21:08:31.733

你想让你的搜索应用程序查询 Solr，或者使用代理，这样 URL 就不会暴露给 Web 用户。只要网络用户不能通过查询发送它们，我就不太关心查询语法和参数是否可见。但是，您肯定希望确保只有 Web 应用程序可以访问 Solr 服务器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-28T21:50:50.933

即使您锁定了 RequestHandlers 以便只能通过 Web 进行搜索，您的索引中仍然可能存在您不想向客户公开的内容。

例如，如果两个项目在搜索中得分相同，您希望提升利润率较高的项目。为了做到这一点，您需要在您的索引中有利润，这意味着它可供您的所有客户和竞争对手查看。

JSON 响应编写器对于编写轻量级搜索应用程序非常方便。至少您需要在浏览器和 Solr 之间实现过滤代理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T16:40:10.013

您绝对不想将 Solr 直接暴露给用户。您也不想在不评估的情况下通过格式。

Solr 支持的一件事是[通过查询删除](https://stackoverflow.com/questions/8719860/how-to-delete-solr-indexed-data-by-query-with-curl)。还有其他可能性。您必须清理查询的内容。

# android - Android - 使用 configuration.locale 强制应用程序语言不会更改启动器中的 app_name

> ID：14531783
> 
> 赞同：2
> 
> 时间：2013-01-25T23:11:07.487
> 
> 标签：android, locale

我有以下代码强制使用英语作为应用程序语言。

```
Configuration configuration =
    getApplicationContext().getResources().getConfiguration();

configuration.locale = Locale.ENGLISH;

getApplicationContext().getResources().updateConfiguration(
    configuration, getApplicationContext().getResources().getDisplayMetrics()); 
```

问题是它在活动内部工作，但是`name in launcher`并`app_name on titlebar`没有改变，它们与系统语言环境保持一致。

我怎样才能更改这些名称呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T23:13:13.993

> 我怎样才能更改这些名称呢？

用户可以进入设置并更改他们的语言环境。

作为开发人员，您可以`updateConfiguration()`用来欺骗 Android*为您自己的进程*使用不同语言的资源。您不能以这种方式影响其他应用程序，并且主屏幕是另一个应用程序。

# vim - 如何为 Vim 中的不同键绑定重新分配 ctags？

> ID：14531787
> 
> 赞同：1
> 
> 时间：2013-01-25T23:11:31.860
> 
> 标签：vim, ctags, cscope

我正在使用 Vim，Cscope 的默认绑定与 Ctags ( `Ctrl`- `]`) 相同，但我想将`Ctrl`-分配`[`给 Ctags，将`Ctrl`-分配给`]`Cscope，以便我可以使用一个查找定义，另一个用于引用。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T23:19:07.080

`Esc`和`Ctrl`+`[`在终端上使用相同的转义序列，因此 vim 将无法区分两者。

有关更多信息，请参阅：

```
:h escape 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T09:07:19.913

不，`<C-]>`不是 cscope 和 ctags 的默认绑定。只有当你明确告诉 Vim 使用`set cscopetag`.

`:h cscope-suggestions`作为给你的一些好建议。

# ios - 我的单例设置是否正确？

> ID：14531790
> 
> 赞同：0
> 
> 时间：2013-01-25T23:11:46.277
> 
> 标签：ios, objective-c, singleton

> **可能重复：**
> [我的 Objective-C 单例应该是什么样的？](https://stackoverflow.com/questions/145154/what-should-my-objective-c-singleton-look-like)

我试图了解单例的使用。我有红色要小心他们，而且他们可以有他们的积极用途。

我的场景：

目前我已经建立了一个测试项目。一个 ViewController 有一个需要执行操作的按钮。

FirstViewController 上有一个 UIWebView 。

我正在使用 Storyboard 和 ContainerView，所以我可以同时看到两个 ViewController。

在第一个 ViewController 中，我的 .m 文件中有以下代码：

```
static FirstViewController *sharedController = nil;

+ (FirstViewController *)sharedController {

    UIStoryboard *storyboard = [UIStoryboard storyboardWithName:@"MainStoryboard" bundle:nil];
    //BBCSermonTabBarViewController *myVC = (BBCSermonTabBarViewController *)[storyboard instantiateViewControllerWithIdentifier:@"BBCNews"];

    if(sharedController == nil)
        sharedController = (FirstViewController *)[storyboard instantiateViewControllerWithIdentifier:@"firstViewController"];

    return sharedController;
} 
```

而且我还有一种方法可以像这样更改 alpha：

```
-(void)hideWebView
{
    _webView.alpha = 0.3;
} 
```

现在在我的第二视图控制器中，我有以下代码：

```
-(IBAction)hideWebViewFromAnotherViewController
 {
   [[FirstViewController sharedController] hideWebView];
 } 
```

该操作按钮现在应该更改另一个 ViewController 中 webView 的 alpha 吗？

如果不是我做错了什么？

提前致谢：-）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T00:16:23.433

为了安全起见，并且因为使用 libdispatch 非常简单，您应该使用 dispatch_once() 调用来保护单例创建者，而不是执行 if() 检查。

```
+ (FirstViewController *)sharedController {

    UIStoryboard *storyboard = [UIStoryboard storyboardWithName:@"MainStoryboard" bundle:nil];

    static dispatch_once_t token;
    dispatch_once(&token, ^{

    sharedController = (FirstViewController *)[storyboard instantiateViewControllerWithIdentifier:@"firstViewController"];
    });

    return sharedController;
} 
```

就像信号量一样使用`token`来保护块并确保它在程序运行期间只被调用一次；它不受竞争和同时读取的影响。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T00:43:33.240

我很欣赏你更好地理解单例的目标，但我建议除非你必须这样做，否则不要使用单例。

我认为在大多数 UI 场景（我从来不需要）中拥有单例是不合适的。我建议使用以下方法之一在对象之间进行通信：

*   保存对要与之通信的对象的引用。只需添加一个属性并保存对稍后需要调用的类的引用。如果它适用于您的场景，您可以将其设为弱参考。

*   使用 iOS/Objective-c 应用程序中常见的委托模式。和上面一样，除了定义一个协议。通常调用该属性`delegate`。这允许其他视图使用通用接口进行通信。

*   使用通知中心。在大多数情况下，我不喜欢这个选项，但是如果有很多视图可能需要了解的事件，并且您不想处理传递对对象的引用，那么它可能是一个不错的选择。

根据我的经验，单例最适合非 UI 代码，当您实际上需要依赖于在首次使用时实例化类的单例行为时。在您的情况下，您使用单例的唯一原因似乎是使该视图控制器可在整个应用程序中访问。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T23:17:34.827

它应该工作。潜在问题：_webView 为 nil，[FirstViewController sharedController] 未返回有效引用。在 hideWebViewFromAnotherViewController 上设置断点并逐步执行，确保所有内容都在您认为的时候定义。

# c# - 通过变量更改 Brushes.Color？

> ID：14531791
> 
> 赞同：0
> 
> 时间：2013-01-25T23:11:48.070
> 
> 标签：c#, .net, winforms, graphics, brush

pSo，我将如何更改方法使用的 Brushes.Color ？假设我们通过控制台输入将变量设置为黑色，然后将其更改为红色？我将如何在我的代码中执行此操作，我已将颜色大写以注意我想要在方法中更改的位置和内容。

```
graphics.DrawString(cmd.AllArguments, arialFont, Brushes.COLOR, secondLocation); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T23:16:41.790

声明一个 Color 类型的变量，比如：

```
private Color foreColor; 
```

然后您只需为该颜色创建一个画笔：

```
using (var brush = new SolidBrush(foreColor)) {
    graphics.DrawString(cmd.AllArguments, arialFont, brush, secondLocation);
} 
```

从字符串转换颜色的最佳方法是使用 ColorConverter 类，与“属性”窗口中使用的相同：

```
foreColor = (Color)new ColorConverter().ConverFrom(str); 
```

# css - 在所有浏览器中覆盖占位符字体 css

> ID：14531799
> 
> 赞同：3
> 
> 时间：2013-01-25T23:12:30.983
> 
> 标签：css, placeholder, pseudo-element

我正在尝试使用以下代码覆盖我网站上所有标题、输入、选择、文本区域和输入占位符的字体：

```
h1, h2, h3, h4, h5, h6,
button, input, select, textarea,
:-ms-input-placeholder,
::-moz-placeholder,
:-moz-placeholder,
::-webkit-input-placeholder {
    font-family:some font name;
} 
```

问题是，由于某种原因，它无法在 Chrome 上运行。如果我删除`:-moz`and`:-ms`引用，那么 chrome 工作正常，这让我相信 Chrome 出于某种原因不喜欢伪类？我很难过，因为我不明白为什么与 Chrome 无关的伪类会使它不起作用！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-25T23:19:57.677

您需要单独声明它才能在所有浏览器中工作，否则冲突会导致这样的不良结果。

```
h1, h2, h3, h4, h5, h6,
button, input, select, textarea {
    font-family: somefont;
}
::-webkit-input-placeholder {
    font-family: somefont;
}
:-moz-placeholder {
    font-family: somefont;
}
::-moz-placeholder {
    font-family: somefont;
}
:-ms-input-placeholder {
    font-family: somefont;
} 
```

# json - Java过滤器：将对象写入具有“编组”格式的响应

> ID：14531800
> 
> 赞同：0
> 
> 时间：2013-01-25T23:12:39.003
> 
> 标签：json, spring, marshalling, servlet-filters

在传递给 Controller 之前，我正在使用 Spring Delegating 代理过滤器在 Filter 类中进行一些验证。在验证失败时，我打算以 json 格式返回用户定义的“ErrorMessage”对象，从过滤器返回 json 的最佳方法是什么？可能吗？我尝试通过在输出中写入字符串来返回字符串，它工作正常，但我似乎无法弄清楚如何以 json 格式返回对象

代码片段：

```
application context xml -
<bean class="com.company.rest.ValidationFilter" id="validationFilter" />

ValidationFilter -

public class ValidationFilter implements Filter {
@Override
public void init(final FilterConfig filterConfig) throws ServletException {
}

@Override
public void doFilter(final ServletRequest request, final ServletResponse response, final FilterChain chain)
        throws IOException, ServletException {
    final HttpServletRequest httpServletRequest = (HttpServletRequest) request;
    final HttpServletResponse httpServletResponse = (HttpServletResponse) response;

    final String acceptHeader = httpServletRequest.getHeader("Accept");
    if (PAYLOAD_FORMATS.jsonp.getContentType().equalsIgnoreCase(acceptHeader)) {
        final OutputStream outputStream = httpServletResponse.getOutputStream();
        final GenericResponseWrapper wrapper = new GenericResponseWrapper(httpServletResponse);

    //Some validation
        if (ifValidationFails) {
            httpServletResponse.setStatus(400);
            httpServletResponse.addHeader("cause", "Required String parameter is not present.");   
            //Need to return this object in response
            final ExceptionWrapper exception = new ExceptionWrapper();
            exception.setErrorMessage("Required String parameter is not present");
            //Returning string works fine 
            outputStream.write(new String("Required String parameter is not present").getBytes());
        } else {
            chain.doFilter(request, wrapper);

            outputStream.write(new String("test" + "(").getBytes());
            outputStream.write(wrapper.getData());
            outputStream.write(new String(");").getBytes());
        }
        wrapper.setContentType("text/javascript;charset=UTF-8");
        outputStream.close();
    } else {
        chain.doFilter(request, response);
    }

}

@Override
public void destroy() {
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T23:32:49.383

过滤器是相当低级的 Servlet API 的一部分——Spring MVC 建立在该标准之上。你没有得到 Spring 家伙为自动序列化 POJO 而编写的所有好东西。尽管我认为可以手动将必要的组件连接在一起。

我建议查看使用 Spring MVC 中的 @Valid 注释存在的声明性验证：http: [//static.springsource.org/spring/docs/current/spring-framework-reference/html/validation.html#validation-beanvalidation](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/validation.html#validation-beanvalidation)

# android - 有可能获得总存储容量吗？

> ID：14531806
> 
> 赞同：5
> 
> 时间：2013-01-25T23:13:34.773
> 
> 标签：android, storage, sd-card

我知道如何获得内部存储器和外部存储的可用容量。

但我想知道内部存储器的最大容量和外部存储的最大容量，但我在谷歌上找不到任何相关信息

有可能实现吗？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-08-14T15:55:02.427

API 18 中引入了一些新方法。这是我用来获取总存储（内部 + 外部）的代码。

`private static final long KILOBYTE = 1024;`

```
StatFs internalStatFs = new StatFs( Environment.getRootDirectory().getAbsolutePath() );
long internalTotal;
long internalFree;

StatFs externalStatFs = new StatFs( Environment.getExternalStorageDirectory().getAbsolutePath() );
long externalTotal;
long externalFree;

if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.JELLY_BEAN_MR2) {
    internalTotal = ( internalStatFs.getBlockCountLong() * internalStatFs.getBlockSizeLong() ) / ( KILOBYTE * KILOBYTE );
    internalFree = ( internalStatFs.getAvailableBlocksLong() * internalStatFs.getBlockSizeLong() ) / ( KILOBYTE * KILOBYTE );
    externalTotal = ( externalStatFs.getBlockCountLong() * externalStatFs.getBlockSizeLong() ) / ( KILOBYTE * KILOBYTE );
    externalFree = ( externalStatFs.getAvailableBlocksLong() * externalStatFs.getBlockSizeLong() ) / ( KILOBYTE * KILOBYTE );
}
else {
    internalTotal = ( (long) internalStatFs.getBlockCount() * (long) internalStatFs.getBlockSize() ) / ( KILOBYTE * KILOBYTE );
    internalFree = ( (long) internalStatFs.getAvailableBlocks() * (long) internalStatFs.getBlockSize() ) / ( KILOBYTE * KILOBYTE );
    externalTotal = ( (long) externalStatFs.getBlockCount() * (long) externalStatFs.getBlockSize() ) / ( KILOBYTE * KILOBYTE );
    externalFree = ( (long) externalStatFs.getAvailableBlocks() * (long) externalStatFs.getBlockSize() ) / ( KILOBYTE * KILOBYTE );
}

long total = internalTotal + externalTotal;
long free = internalFree + externalFree;
long used = total - free; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-25T23:15:48.733

```
StatFs stat = new StatFs(Environment.getExternalStorageDirectory().getPath());
long bytesAvailable = (long)stat.getBlockSize() * (long)stat.getBlockCount();
long megAvailable = bytesAvailable / 1048576; 
```

[资源](https://groups.google.com/forum/?fromgroups=#!topic/android-developers/7O3plkY6QFg)

此外，将其用于内部尺寸。

```
StatFs stat = new StatFs(Environment.getDataDirectory().getPath()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-04-01T23:30:57.660

**[StatFs](https://developer.android.com/reference/android/os/StatFs.html)** - 检索有关文件系统空间的整体信息。这是 Unix statvfs() 的包装器。

从 API 级别 18 我们使用

```
long getTotalBytes - The total number of bytes supported by the file system. 
```

对于较旧的 API 使用

```
int getBlockCount ()
int getBlockSize ()

StatFs stat = new StatFs(**path**);
long bytesAvailable = (long)stat.getBlockSize() *(long)stat.getBlockCount(); 
```

作为路径 您使用[Environment.getExternalStorageDirectory](https://developer.android.com/reference/android/os/Environment.html#getExternalStorageDirectory()) ()，请查看此值。在具有多个共享/外部存储目录的设备中，此目录表示用户将与之交互的主存储。

您需要使用这样的路径字符串值：“/mnt/external_sd/”“/mnt/extSdCard/”

您可以检索所有**/mnt/**设备的列表并使用其中一个值。

```
File allMounted = new File("/mnt/");
if(allMounted.isDirectory()){ 
String[] dirs = allMounted.list();...} 
```

或类似的东西

```
var myfile=new Java.IO.File("storage/");
var listOfStorages=myfile.ListFiles(); 
```

或者

```
String[] externals = System.getenv("SECONDARY_STORAGE").split(":"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-22T22:20:16.453

此方法不适用于所有手机，大多数手机返回用户可用的内存总量，较少的系统内存。您可以尝试在使用 NDK 的 c++ 方法中使用 'df -h' linux 命令，但有些手机仅将其设为系统 (su) 命令。所以总而言之，你不能。

# c# - 使用 Servicestack.Text 重构类型对象的属性

> ID：14531815
> 
> 赞同：2
> 
> 时间：2013-01-25T23:14:36.880
> 
> 标签：c#, json, servicestack

我正在使用 Servicestack.Text 包对 JSON 对象进行序列化和反序列化。我的一个对象具有对象类型 (System.Object) 的属性。它是三件事之一：一个长的，一个双的，一个字符串。但是，当我使用 JsonSerializer.DeserializeFromString 时，它总是被反序列化为字符串。我需要将它反序列化为序列化时的类型。我尝试使用 JsConfig.IncludeTypeInfo = true; 包含类型信息 但是，这似乎只适用于类级别，而不适用于属性级别。我该如何进行这项工作？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-26T00:11:27.043

[这在ServiceStack JSON Serializer](https://github.com/ServiceStack/ServiceStack.Text)中不受支持，它查看它正在反序列化的目标类型以获取有关如何强制 JSON 值的信息。

因为您使用的是`object`属性，所以没有类型信息，因此它会回退并查找该信息是否存在**__type**属性，但 ServiceStack 从不发出 ValueTypes 的 __type 信息，因为它会大大膨胀有效负载。

在没有类型信息的情况下，序列化程序只是将值作为一个对象作为字符串保留。

我建议避免使用接口、后期绑定对象类型等，这[在 DTO 上是个坏主意](https://stackoverflow.com/a/10759250/85785)，但为此您可以创建一个扩展方法来检查字符串值并根据返回正确类型的实例内容，例如：

```
var dto = new WildCard { AnyObject = 1 };

dto.AnyObject.AsJsonValue(); //Extension method that

"1" -> int 1
"true" -> bool true
"anything else" -> string "anything else" 
```

唯一的问题是无法发送包含数字或布尔值的字符串文字，因为它总是被强制转换为各自的类型。

# javascript - JS 和 jQuery - 遍历文本框并存储值

> ID：14531819
> 
> 赞同：0
> 
> 时间：2013-01-25T23:15:06.567
> 
> 标签：javascript, jquery

这是检查表单是否完整的函数。

所以，我想做的是：

1.  如果未选择收音机，则抛出一条消息。
2.  如果 radio 为“yes”，但没有输入文本，则抛出错误。
3.  如果 radio 为“no”但输入了文本，则将文本设为空。
4.  如果一切正常，将内容添加到 `allResponses

表单显示5次，输入如下：

```
Yes a1

No

Yes a3

No

Yes 
```

现在，这个输入应该显示一个错误，因为在第 5 种情况下，选择了“是”，但在文本框中没有输入任何内容。

但是，我明白了：

[http://i.imgur.com/ya2CUp0.png](http://i.imgur.com/ya2CUp0.png)

此外，文本没有像第一种和第三种情况那样更新。

我对 JS 不太了解，所以请尽可能向我提供解释性的回复。

编辑：完整代码： http: [//pastebin.com/scNSNM2H](http://pastebin.com/scNSNM2H)

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T00:06:05.293

你有这个循环：

```
var exaggerationPart = document.getElementById('exaggeration').value 
```

然后你检查以确保它对每个项目都有一个值。但是你每次都会得到相同的值。

您正在创建具有相同 id 的多个输入，“夸张”。这是无效的 HTML。Id 必须是唯一的。要更正此问题，您可以像使用其他元素（例如，`input[name='response"+thisJokeIndex+"']`）一样增加 id。

```
var exaggerationPart = document.getElementById('exaggeration' + thisJokeIndex).value 
```

```
tipTD2.append("<input type='text' name='exaggeration' id='exaggeration" + tipIndex + "' size='70'>") 
```

**工作演示：** [jsfiddle.net/svvge/2](http://jsfiddle.net/svvge/2/)

**编辑：**要清除文本框的值，您必须更改`value`文本框元素的属性。现在你只是在改变一个变量的值。

```
var exaggerationInput = document.getElementById('exaggeration' + thisJokeIndex).value;
var exaggerationPart = exaggerationInput.value; 
```

```
exaggerationInput.value = ''; 
```

# java - 带有一些引用元素和其他未引用元素的 opencsv 写入文件

> ID：14531827
> 
> 赞同：4
> 
> 时间：2013-01-25T23:15:42.760
> 
> 标签：java, opencsv

有没有人有在 Java 中使用 opencsv 编写 csv 文件的经验，其中只有一些元素需要双引号？我要测试的所需输出是制作一个文件，内容如下：

`1,"two",three`

但是当我尝试以下代码时

```
writer = new CSVWriter(new FileWriter("yourfile.csv"), ',',CSVWriter.NO_QUOTE_CHARACTER);
String[] entries = {"1","\"two\"","three"};
writer.writeNext(entries);
writer.close(); 
```

出现以下输出

`1,""two"",three`

想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-25T23:46:47.333

这些额外的引号是`OpenCSV`. 您需要使用允许您关闭这些的[重载构造函数：](http://opencsv.sourceforge.net/apidocs/au/com/bytecode/opencsv/CSVWriter.html#CSVWriter%28java.io.Writer,%20char,%20char,%20char%29)

```
writer = new CSVWriter(new FileWriter("yourfile.csv"), ',', 
           CSVWriter.NO_QUOTE_CHARACTER, CSVWriter.NO_ESCAPE_CHARACTER);
... 
```

输出：

```
1,"two",three 
```

# c++ - 卡在一个while循环c

> ID：14531829
> 
> 赞同：1
> 
> 时间：2013-01-25T23:15:54.680
> 
> 标签：c++, while-loop

我正在为我的 C++ 课做作业。在这个作业中，我需要编写一个程序，它从 cin 读取数字然后对它们求和，当使用 while 循环输入 0 时停止。

我已经编写了代码并得到了我需要的结果。但是，我陷入了一个持续重新打印结果的 while 循环中。任何人都可以在打印一次结果后给我一些建议来结束这个循环吗？

这是我的代码：

```
int main ()
{
int i(1), sum(0);
int sum2(0);
const int max(10);

cout << "Enter numbers, one per line. Enter 0 to end:" << endl;

while (i!=0)
{
    cin >> i; 
    sum += i; //add current value of i to sum
    sum2 += 1;
}
while (i==0)
{   
    if (sum < 100) // If total is less than 100
        cout << "Thank you. The total was " << sum << endl 
                 << "The total number of inputs reads: " << sum2 << endl
                 << "The total is less than 100." << endl ;
    else // Else total is greater than 100
            cout << "Thank you. The total was " << sum << endl 
                 << "The total number of inputs reads: " << sum2 << endl 
                 << "The total is greater than 100." << endl ;
}
} //End of Int Main 
```

希望结果没问题。抱歉，我不确定如何在每行上发布数字。我还尝试将 while (i==0) 更改为 if 语句 if (i==0) 但这会在输入 0 时关闭程序。有人有有用的建议吗？我会很感激。^_^

更新：对不起，我忘了提到我还必须包括一个跟踪输入数量的循环计数器，一个确定总值是否小于或大于 100 的注释，以及一个确定总输入数的语句输入。这就是最后的 if else 语句的原因。我尝试取出最后一个 while 语句，因为我知道这是无限循环的原因，但是当我这样做时它不会显示结果。我将代码更改为：

```
int main ()
{
    int i(1), sum(0);
    int sum2(0);
    const int max(10);

cout << "Enter numbers, one per line. Enter 0 to end:" << endl;

    while (i!=0)
    {
        cin >> i; 
        sum += i; //add current value of i to sum
        sum2 += 1;
    }   
if (sum < 100) // If total is less than 100
            cout << "Thank you. The total was " << sum << endl 
                     << "The total number of inputs reads: " << sum2 << endl
                     << "The total is less than 100." << endl ;
        else // Else total is greater than 100
                cout << "Thank you. The total was " << sum << endl 
                     << "The total number of inputs reads: " << sum2 << endl 
                     << "The total is greater than 100." << endl ;

} //End of Int Main 
```

我的输出应该是

```
Enter numbers, one per line. Enter 0 to end:
7
8
6
5
5
9
8
0
Thank you. The total was 48.
The total number of inputs read: 8
The total is less than 100. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T23:19:16.273

`i``0`退出第一个循环后，它一直停留在并且永远不会改变。不要使用另一个`while`循环，只需在之后打印结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T23:19:17.337

删除`while (i==0)`. 这将永远是真的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-25T23:19:34.330

你的问题是你第二次`while loop`循环`while (i==0)`，但`i`在循环内永远不会改变。

```
while (i==0)  // Infinite loop, i is never change inside the block. 
{   
    if (sum < 100)    // If total is less than 100
        cout << "Thank you. The total was " << sum << endl 
                 << "The total number of inputs reads: " << sum2 << endl
                 << "The total is less than 100." << endl ;
    else            // Else total is greater than 100
            cout << "Thank you. The total was " << sum << endl 
                 << "The total number of inputs reads: " << sum2 << endl 
                 << "The total is greater than 100." << endl;
} 
```

这里根本不需要循环构造。

**编辑：**你想要的是：

```
#include <iostream>
using namespace std;

int main(int argc, const char* argv[]) {
  int i, sum, count;

  cout << "Enter numbers, one per line. Enter 0 to end:" << endl;

  while (i!=0) {
    cin >> i; 
    sum += i;
    count++;
  }   

  cout << "Thank you. The total was " << sum << endl 
       << "The total number of inputs reads: " << count << endl;

  if (sum < 100)
    cout << "The total is less than 100." << endl;
  else
    cout << "The total is greater than 100." << endl;

  return 0;
} 
```

演示：

```
$ ./a.out 
Enter numbers, one per line. Enter 0 to end:
1000
100
10
0
Thank you. The total was 1110
The total number of inputs reads: 4
The total is greater than 100.

$ ./a.out 
Enter numbers, one per line. Enter 0 to end:
1
2
3
0
Thank you. The total was 6
The total number of inputs reads: 4
The total is less than 100. 
```

请注意，计数包括终止`0`，因此您可能想要报告`count-1`。

# android - 我无法调试应用程序 - ADB 没有响应

> ID：14531830
> 
> 赞同：0
> 
> 时间：2013-01-25T23:15:57.660
> 
> 标签：android, intellij-idea, adb

我在 Windows 8 上使用 Intellij IDEA 12.0.2，但在调试应用程序时遇到问题。我无法在手机或模拟器上运行我的应用程序，因为我一直收到警报：等待 ADB 或 ADB 没有响应。

我试过：重新启动 IDEA 杀死 adb.exe 杀死并启动服务器编辑运行配置以管理员身份启动 IDEA

没有任何效果。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T23:20:26.947

尝试禁用防火墙或您可能拥有的任何其他 A/V 解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T23:24:31.507

检查以确保您的平台工具是最新的，我听说这在低于 18 版的版本中很常见。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-16T20:59:05.053

您也可以尝试以管理员身份运行 IntelliJ - 立即为我工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-28T23:30:02.223

我有类似的问题。原因是我有一个实用软件已经在运行 adb。卸载该软件解决了这个问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-04-24T02:57:08.873

首先我运行命令“netstat -ano | findstr "5037" 来查找使用端口 5037 的程序。然后使用 "taskkill /F /PID xxxx" 杀死该程序。

“adb start-server” 启动 adb 服务器。

最后，重新启动您的 Intellij Idea。

我只是将解决方案放在我的博客中，在[此处输入链接描述](http://www.textworld.me/intellij-adb-not-response/)

# node.js - 使用 mongoose 处理 $in

> ID：14531832
> 
> 赞同：1
> 
> 时间：2013-01-25T23:16:03.493
> 
> 标签：node.js, mongodb, express, mongoose

这是代码：

```
usermodel.findOne({ user: req.session.user }, function (err, user){

   usermodel.find({ _id: {$in: user.follow } }, { user: true }, function (err, users){

         usermodel.find({ author: { $in: users.user }}, function (err, images){

          console.log(users);
          console.log(images);

        });
     }); 
```

这是架构：

var usersschema = new mongoose.Schema({

```
 user: String,
  follow: [String],
  message: [{ 

              title: String,
              author: String,
              message: String

           }],

}); 
```

该`follow`数组包含`_id`实际用户关注的用户的 s。用第一个`usermodel.find`y 得到`follow`数组。使用第二个`usermodel.find`，我得到用户名：

```
[ { _id: 50fd9c7b8e6a9d087d000006, user: 'Mrmangado' },
  { _id: 50fd9d3ce20da1dd7d000006, user: 'kirbo' } ] 
```

而且，对于第三个也是最后一个`usermodel.find`，我正在尝试获取用户的信息。我在前面得到了用户的名字`usermodel.find`，并且`author`消息的值与创建它的用户的值相同。问题是我获取用户名的方式，我想我必须像这样拥有用户名：

```
[{ user: 'Mrmangado' },
 { user: 'kirbo' }] 
```

如果我收到这样的数组，则该`$in`语句将完美运行。有没有办法得到这样的输出......？

谢谢提前！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T00:30:09.250

你确定那是你想要的吗？该`author`字段是用户名，而不是它的`_id`? 如果是这样，您可以只映射结果对象以获取名称。

```
var usernames = users.map(function(u) { return u.user; });
//= ["Mrmangado", "kirbo"] 
```

# c# - 如何比较多个日期时间是否在确定的时间间隔内发生？

> ID：14531833
> 
> 赞同：0
> 
> 时间：2013-01-25T23:16:09.510
> 
> 标签：c#, linq, oop, datetime, compare

我正在使用 C# 中的对象列表，每个对象都包含一个 DateTime 属性，我需要知道*n*个对象是否在一小时内发生。

我必须比较每个对象吗？有更快的方法吗？我不知道，这可以用Linq完成吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T23:20:06.120

你可以使用`Where`+ `Count`：

```
// for example today between 12 and 13 o'clock
DateTime startHour = DateTime.ToDay.AddHours(12)
DateTime endHour = startHour.AddHours(1);
var inHour = collection.Where(o => o.DateTimeProperty >= startHour 
                                && o.DateTimeProperty <= endHour);
int count = inHour.Count(); 
```

当然这和一个简单的循环是一样的。但这是你必须走的路。

你也可以使用`GroupBy`，但我不明白你为什么需要它。

```
var hourGroup = collection
   .GroupBy(o => o.DateTimeProperty.AddMinutes((-1) * o.DateTimeProperty.Minute))
   .FirstOrDefault(g => g.Key == startHour);
if(hourGroup != null)
{
    int count = hourGroup.Count();
} 
```

# httpwebrequest - 替换可移植类库中的 PreAuthenticate

> ID：14531837
> 
> 赞同：4
> 
> 时间：2013-01-25T23:16:24.757
> 
> 标签：httpwebrequest, credentials, portable-class-library

我正在将库移植到 PCL，并且必须找到管理 HTTP 请求凭据的解决方案。我拿走了像 CredentialCache（不可移植）这样的具体凭据类，现在只使用 ICredentials，因此客户端应用程序可以创建正确的凭据并仅发送接口引用。

然而，还有一件事需要解决。在某些平台上，HttpWebRequest 有一个简洁的 PreAuthenticate 属性来处理初始握手。没有它，客户端需要捕获并响应 401 响应。但是 PreAuthenticate 不是大多数 PCL 配置文件的一部分，我想知道是否有任何解决方案，或者客户端需要自己实现替换逻辑（这很愚蠢，因为这是一段标准代码）。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T19:26:05.810

您需要自己编写代码来处理这个问题。一个 API 只有在所有目标平台上都可用时才可移植。在这种情况下，PreAuthenticate 是 .NET 4.5 和 Windows Store 应用程序中的一个新 API，因此如果您针对任何其他平台（即 .NET 4、Silverlight 或 Windows Phone），它在可移植类库中将不可用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-22T16:10:45.007

我有同样的问题。我尝试将 Credentials 设置为单个 NetworkCredental(user, pass)，但它在 WinRT 中不起作用，尽管它在 Windoes Phone 中起作用。到目前为止，使其在 WinRT 中工作的唯一方法是通过反射创建 CredentialCache。

```
var credCacheType = Type.GetType("System.Net.CredentialCache, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089");
var credCache = credCacheType.GetConstructor(new Type[0]).Invoke(new object[0]);
var addMethod = credCacheType.GetMethod("Add", new Type[] { typeof(Uri), typeof(string), typeof(NetworkCredential) });
addMethod.Invoke(credCache, new object[] { new Uri(_server), "Digest", Credential });
request.Credentials = (ICredentials)credCache; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-19T10:38:35.167

PreAuthenticate 可以使用 HttpClient 作为参数构造函数接受的 HttpClienHandler 进行设置，例如：

```
HttpClientHandler handler = new HttpClientHandler()
{
    UseDefaultCredentials = true,
    PreAuthenticate = true
};
HttpClient client = new HttpClient(handler); 
```

# javascript - 同一类的多个实例的事件处理 - 需要澄清

> ID：14531838
> 
> 赞同：1
> 
> 时间：2013-01-25T23:16:34.300
> 
> 标签：javascript, jquery

我需要一些指导来理解为什么这些功能正在做他们正在做的事情......

1.) 在我的网页上，我有三个使用 Slider 功能的不同面板，它使用下一个和上一个锚链接创建一个具有滑块功能的无序列表。请看下面的代码：

```
function Slider(id) {
    var _this = this;
    this.id = id;
    if (!id) return false;
    this.index = 0;
    this.slider = $(this.id);
    this.length = this.slider.children().length;
    this.width = $(this.id).outerWidth();
    this.totalWidth = this.length * this.width;
    $(id).addClass('slideWrapper').wrap('<div class="slideViewport">').after('<div class="sliderNav"><a href="#" class="prev">Previous</a><a href="#" class="next">Next</a></div>').css({
      'width': this.totalWidth
  }).children().addClass('slide').css({
      'width': this.width
  });

  $('.slideViewport a.next').click(function(e) {
    e.preventDefault();
    return _this.next();
  });

  $('.slideViewport a.prev').on(function(e) {
    e.preventDefault();
    return _this.prev();
  });
} 
```

如果我尝试在一个页面上运行多个这样的 Slider 实例，单击 .next 锚点将导致单击的元素及其下方的任何元素在其幻灯片中更多到下一个列表元素。转到第二个面板将导致除第一个面板之外的所有面板运行，第三个面板导致除第一个和第二个面板之外的所有面板运行，依此类推。我希望处理程序仅针对我单击的事件而不是所有实例运行之后的课程，因为我`this`在我的活动中使用。任何关于这里发生的事情的解释都会非常有帮助。

2.) 现在，我一直在尝试让所有 Slider 事件在我单击页面上的任何 a.next 锚点时都运行 next()，而不是只为我的锚点运行一个事件已点击。我发现这段代码有效：

```
$('.slideshow').on("click", "a.next", function(e) {
   e.preventDefault();
   return _this.prev();
}); 
```

但我说实话，我不确定为什么这是有效的。我的理解是，JQuery 只是查看是否单击了 a.next 锚点，然后将处理函数传递给 $('.slideshow') 选择器，这让我假设它正在选择 $( 'slideshow') 并为所有这些运行 .next() 函数。这是正确的思考方式吗？

3.) 为什么下面的代码片段会导致所有幻灯片运行 next() 函数两次，而不是一次？我真的不喜欢这没有返回任何东西，所以我真的不想使用这段特殊的代码，但我只想更好地理解它......

```
$('.slideViewport a.next').on("click", function(e) {
   e.preventDefault();
   $('.slideshow').each(function() {
     _this.prev();
   }
}); 
```

帮助理解任何此代码将不胜感激。在这种情况下，我真的很想更好地了解 DOM 在传播方面发生的事情，但是我尝试阅读的所有内容都让我感到更加困惑。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T23:41:25.930

这段代码将单击处理程序附加到文档中的**所有**.slideshow 元素。

```
$('.slideshow').click(function(e) {
    e.preventDefault();
    return _this.prev();
}); 
```

您可能想要的是将处理程序仅附加到作为滑块后代的 .slideshow 元素：

```
this.slider.find('.slideshow').click(function(e) {
    // ... handle event here ...
}); 
```

现在，关于你的`on()`陈述：

```
$('.slideshow a.next').on("click", function(e) {
   e.preventDefault();
   $('.slideshow').each(function() {
     _this.prev();
   }
}); 
```

您在这里所做的是将单击事件处理程序绑定到所有`.slideshow a.next`元素，并且处理程序所做的是`_prev()`在所有元素上运行。但是**您已经有另一个处理程序绑定到`.slideshow`**您调用时的**元素**`$('.slideshow').click()`。当“on”处理程序完成时，事件继续向上传播 DOM 树，在向上的过程中触发所有点击处理程序，包括您绑定到`.slideshow`元素的处理程序。当然，该处理程序也调用`_prev()`.

如果你想停止事件传播，你有两个选择。

1.  称呼`e.stopPropagation()`
2.  从您的事件处理程序返回 false （这告诉 jQuery 停止传播并阻止默认操作）。

`click()`您可能会问自己，“和之间有什么区别`on('click', ...)`。该`on()`方法允许您使用[事件委托](https://stackoverflow.com/questions/1687296/what-is-dom-event-delegation)。基本上，这意味着使用附加到一个 DOM 节点的单个事件处理程序来处理许多后代元素上的事件。

例如，假设您有一个 div，其中包含任意数量的图像，并且每当单击图像时您都需要执行一些操作。您可以 (a) 将单击事件处理程序绑定到每个图像或 (b) 将处理程序绑定到 div，该处理程序将处理所有图像的所有单击事件，因为这些事件在 DOM 树中冒泡。

```
$('#imageDiv').on('click', 'img', function(evt) {
    // ... "this" is the image that was clicked ...
}); 
```

委托具有额外的好处，您可以在容器中添加和删除图像，并且委托将继续工作。

# aggregation - AggCat 帐户数据 - 刷新所需时间

> ID：14531843
> 
> 赞同：0
> 
> 时间：2013-01-25T23:16:57.807
> 
> 标签：aggregation, intuit-partner-platform, intuit, customer-account-data-api

我在开发环境中使用 Intuit AggCat Beta 并注意到当我发现新帐户时，它们通常不包含重要信息，例如余额、当前利率和其他关键数据。即使在调用 getAccountTransactions 或 getCustomerAccounts 之类的函数（不仅仅是discoverAndAddNewAccounts）之后也是如此。

但是，几个小时后，我刷新帐户并显示此信息。新帐户在发现过程中包含这些数据非常重要，我想检查这是否是使用开发环境的问题（例如，在生产中会消失的东西？）或者其他用户是否有这个问题

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-28T16:43:07.693

这就是它在开发和生产环境中的工作方式。在账户发现过程中，由于网站布局/数据限制，可能无法获取某些金融机构的部分账户的所有信息。

刷新调用将获取这些信息。因此，最佳做法是在尝试获取这些信息之前刷新帐户。

# if-statement - Knockout JS 使用 IF 语句和 With 语句监听点击事件

> ID：14531845
> 
> 赞同：0
> 
> 时间：2013-01-25T23:17:05.390
> 
> 标签：if-statement, knockout.js, onclicklistener

页面加载时输入字段应为空。

当用户单击“编辑帖子”时，我调用 KO 单击和“选择”功能（所有工作）.. 当我这样做时，所选行被正确绑定。

当前代码在页面加载时自动绑定，因此第一条记录位于输入字段中。

```
<div data-bind="with: Selected">
    <input type="text" data-bind="value: Name" />
</div>
<i title="Edit Post" data-bind="click: $parent.select"></i> 
```

**示例黑客**

```
<div data-bind="if **click: $parent.select then** with: Selected">
    <input type="text" data-bind="value: Name" />
</div>

<i title="Edit Post" data-bind="click: $parent.select"></i> 
```

如果“单击”然后执行“使用：选择”，我该如何编写数据绑定？

**更新**

添加示例代码：http: [//jsfiddle.net/uC8Vt/70/](http://jsfiddle.net/uC8Vt/70/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T02:47:01.467

通常，您只希望它可以从`Selected`可观察到的情况下工作。如果未填充，则不会渲染该区域。如果它被聚合，那么任何`Selected`持有的对象都将被使用。

所以，当你打电话时，`$parent.select`你会想要填充`Selected`你的对象。

事实上，可观察对象是函数，因此除非您需要运行其他逻辑，否则您甚至可以走捷径，`click`直接将您的对象绑定`Selected`到可观察对象。当前数据作为第一个参数传递，它设置 observable 的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T08:12:38.257

您将根据单击的项目更改 Selected 属性...

所以一个示例 viewModel 可能就像......

```
var items = [{ Name: 'item1' }, { Name: 'item2' }];

var viewModel = {
    items: items,
    Selected: ko.observable(items[0])
}

viewModel.select = function(selectedItem) {
    // The first arg is the context of the item clicked
    // Selected in an observable
    viewModel.Selected(selectedItem);
}; 
```

然后，随着 Selected 的变化......您的 Name 绑定将自动更新。

# asp.net - 使用 requireSSL=true 的表单身份验证不返回具有 Secure 属性的 cookie

> ID：14531853
> 
> 赞同：12
> 
> 时间：2013-01-25T23:18:11.783
> 
> 标签：asp.net, asp.net-mvc, iis, security

现在我们已经将主机从 Win2K3/IIS6 升级到 Win2k8R2/IIS7.5，我看到来自 IIS 站点的奇怪响应。ASP.Net 4.0 版

我们有一个非常复杂和成熟的 Web 应用程序，它使用带有以下配置的表单身份验证：

```
<authentication mode="Forms">
  <forms loginUrl="~/Login" timeout="2000" domain="xx.xx.com" requireSSL="true" />
</authentication> 
```

登录 URL 指向正确配置为 SSL 的 ASP.Net MVC 3 页面。

该站点在 IIS6 中按预期运行，但自从主机迁移***后，成功登录后，响应标头中的 auth cookie 缺少 Secure 和 HttpOnly 属性***。这是有问题的，因为我们有一个包含许多 HTTP 页面的混合内容站点。auth cookie 现在在每个请求中发送，而不仅仅是在通过 HTTPS 的请求中，并且现在对会话窃取漏洞开放。

我们的注销链接成功发送了一个包含 Secure 和 HttpOnly 属性的零长度 cookie。

这是从 Fiddler 成功登录和注销后的原始响应，经过编辑以保护无辜者 :)

```
Login Response:

HTTP/1.1 200 OK
Cache-Control: private
Content-Type: application/json; charset=utf-8
Set-Cookie: .ASPXAUTH=83FCCA...102D; domain=xx.xx.com; path=/
Date: Fri, 25 Jan 2013 22:53:31 GMT
Content-Length: 84

{...}

Logoff Response:

HTTP/1.1 302 Found

Cache-Control: private
Content-Type: text/html; charset=utf-8
Location: http://xx.xx.com/?...
Set-Cookie: .ASPXAUTH=; domain=xx.xx.com; expires=Tue, 12-Oct-1999 04:00:00 GMT; path=/; secure; HttpOnly
Set-Cookie: logoff=; path=/
Set-Cookie: ...
Date: Fri, 25 Jan 2013 22:57:01 GMT
Content-Length: 64053

<html><head><title>... 
```

更改应用程序池的集成管道设置无效。

以下是 cookie 创建代码的重要部分：

```
 var ctx = HttpContextFactory.Current;

    var cookie = new HttpCookie(
        FormsAuthentication.FormsCookieName,
        FormsAuthentication.Encrypt(
            new FormsAuthenticationTicket(
                SessionId,
                false,
                Convert.ToInt32(FormsAuthentication.Timeout.TotalMinutes)
            )
        )
    ) { Domain = domain };

    ctx.Response.Cookies.Add(cookie); 
```

关于从哪里开始寻找导致这种情况的任何想法？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-26T17:50:04.697

当您发出表单身份验证 cookie 时，您所设置的只是域名。我看不到您在任何地方设置安全标志。因此，如果您希望使用安全和 httponly 标志设置 cookie，请确保在创建此 cookie 时已指定它们：

```
var cookie = new HttpCookie(
    FormsAuthentication.FormsCookieName,
    FormsAuthentication.Encrypt(
        new FormsAuthenticationTicket(
            SessionId,
            false,
            Convert.ToInt32(FormsAuthentication.Timeout.TotalMinutes)
        )
    )
) 
{ 
    Domain = domain,
    HttpOnly = true,
    Secure = FormsAuthentication.RequireSSL
}; 
```

由于您是手动创建表单身份验证 cookie（而不是使用`FormsAuthentication.SetAuthCookie`或`FormsAuthentication.GetAuthCookie`内置方法），因此 web.config 中的设置无效。您需要明确设置它们，如我的示例所示。

# java - 如何将 curl 调用翻译成 java

> ID：14531854
> 
> 赞同：0
> 
> 时间：2013-01-25T23:18:12.113
> 
> 标签：java, curl

我有这个卷曲电话

```
 curl -d "variable1=text1&variable2=text2&variable3=text3" -d information='{"id":"1234567489", "token":"AAACSweqPLFPrf8F6r1sux2AZDZD"}' https://localhost:8080/token 
```

我正在尝试将其转换为 Java 调用，但我不知道如何管理这两种类型的字段（url 编码和 json）

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T23:28:00.177

如果你想用 Java 做 URL/HTTP 的东西，你会想看看[Apache HTTP 客户端库。](http://hc.apache.org)

如果您尝试解析 JSON，那么您将需要[JSON 库。](http://json-lib.sourceforge.net) 或者，如果您想亲自动手，可以使用 java.net.URL 和/或 java.net.URLConnection：

```
URL url = new URL("http://stackoverflow.com");
BufferedReader reader = null;

try {
    reader = new BufferedReader(new InputStreamReader(url.openStream(), "UTF-8"));

for (String line; (line = reader.readLine()) != null;) {
    System.out.println(line);
}
} finally {
if (reader != null) try { reader.close(); } catch (IOException ignore) {}
} 
```

另请参阅Oracle关于该主题[的简单教程。](http://docs.oracle.com/javase/tutorial/networking/urls/readingWriting.html)然而，它有点冗长。

迅速

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-11T01:28:44.333

我实际上想通了，只需要对调用的 JSON 部分进行 URL 编码，然后我就能够使用常规的 Apache HTTP 客户端使用整个 url 编码的主体进行调用。

# c# - 如何在每次迭代后通过 LINQ 查询创建和附加多列列表？

> ID：14531858
> 
> 赞同：0
> 
> 时间：2013-01-25T23:18:42.240
> 
> 标签：c#, wpf, linq, list, iteration

我正在尝试创建一个包含 3 列的列表（我不需要查看列表，临时列表很好）。当前 Button1 被按下并且 Button1.Content 存储在 ListBox1 中。然后按下 Button2 并将 Button2.Content 发送到同一个 ListBox1。这些按钮有很多，所以这个动作可能会发生很多次。
在 ListBox1 具有这些按钮（单列）的内容后，我按下 ExportButton，它将 ListBox1 的内容发送到生成列表的 LINQ 查询。

```
public void SelectPropertyInfo(string Content)
    {
        using (Context con = new Context())
        {
           var query =
                     from o in con.O_TABLEs
                     join p in con.P_TABLEs on o.PN equals p.PN
                     where p.PZ == Content
                     select new
                     {
                         customerFirstName = o.CustomerFirstName,
                         customerLastName = o.CustomerLastName,
                         propertyAddress = p.PropertyAddress
                      }; 
```

此时，我将此数据发送到 XML 文件。

```
XElement PropertyList =
                new XElement("customers",
                            (from q in query.ToList()
                             select new XElement("customer",
                             new XElement("CustomerFirstName", q.customerFirstName),
                             new XElement("CustomerLastName", q.customerLastName),
                             new XElement("Address", q.propertyAddress))));
PropertyList.Save("S:/customers.xml");
       }
} 
```

只要我从 ListBox1 发送一行，这一切都很好，但是如果我发送多行，最后一个查询会覆盖所有以前的数据，这是有道理的。我不知道如何通过 LINQ 查询在每次迭代后存储数据。我知道我需要在发送 ListBox1 的每一行之后存储数据，然后在发送 ListBox1 的所有行之后，我想将数据发送到 XML 文件。我认为实现此目的的另一种方法是创建一个可以从 LINQ 查询发送数据的方法，但我仍然不知道每次运行 LINQ 查询时如何存储数据。

```
public void CreateXMLList (string CustomerFirstName, string CustomerLastName, string  PropertyAddress)           
       {
         XElement PropertyList = new XElement("customers",
                                 new XElement("CustomerFirstName", CustomerFirstName),
                                 new XElement("CustomerLastName", CustomerLastName),
                                 new XElement("Address", PropertyAddress));

            PropertyList.Save("S:/customers.xml");
       } 
```

我将不胜感激对此事的任何帮助或见解。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T23:23:50.753

显然，如果您想在一个 XML 文件中存储多个客户，您需要在 XML 文件中存储多个客户，而不仅仅是一个。

在列表框行的循环之外创建`PropertyList`，让它包含一个名为 的元素`Customers`，然后在每个列表框行迭代中添加一个`Customer`元素（每个列表框行一个元素）。

然后，循环结束后，将 XML 保存到文件中。

另外，请注意，在您当前的代码中，您将一个客户存储在一个名为*customers*的元素中。这很令人困惑。

# java - 如何用 Java 编写“for x in list”？

> ID：14531867
> 
> 赞同：5
> 
> 时间：2013-01-25T23:19:18.133
> 
> 标签：java, list, syntax, for-loop, foreach

我想知道如何在 Java 中表达某种类型的 for 循环。

在 Python 中，我会使用：

```
for x in lst1:
       return 10 
```

我将如何在 Java 中做到这一点？

```
I know for the range for-loops, I use
for(int i=0; i<100; j++) {
   return "asdf"
} 
```

我只想知道如何做其他类型的循环

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-25T23:20:17.453

```
int[] myints = {1, 2, 3, 4, 5};
for(int i : myints) {
    System.out.println(i);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-28T18:15:49.237

```
int[] lst1 = {1,2,4,5,6,7,8,9};    
for (int x : lst1){
    return 10;
} 
```

那是-据我所知-您的python代码的确切转换。我最近做了一个[关于遍历列表的视频教程](https://youtu.be/6e6IueITWp4?t=407)，您和其他人很可能会从观看中受益。

祝你好运！

# android - Android opengl问题（奇怪）

> ID：14531868
> 
> 赞同：6
> 
> 时间：2013-01-25T23:19:24.123
> 
> 标签：android, opengl-es, textures

这是一个奇怪的。我有一个基本应用程序（仪表板，...）和一个 GLSurfaceview，我在其中绘制 3D 对象和纹理。一切都很顺利，但是当我回到其他活动时，嗯，截图胜过文字：

这是之前的仪表盘

![前](../Images/dc01ea283a62a8db7c835a52e7ef4672.png)

这是opengl： ![opengl](../Images/f89e7d5256df3e16f604f5cf5624fa77.png)

当我回击时，这是我的仪表板： ![在此处输入图像描述](../Images/89694480cf69a6009bdc27ac993e7ebc.png)

如您所见，图像消失了，文字也消失了。我在 4.0+ 上运行，所以我想这是因为 android 使用 opengl 绘制元素，因为它在我的 2.2 设备上没有这样做。

你知道是什么原因造成的吗？顺便说一句，当我不使用纹理时，它不会发生。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-26T14:52:06.067

好的，我发现我有什么问题。我通过调用我的片段来删除**UI Thread上的纹理**`mTextureManager.deleteAllTextures()``onPause();`

我通过删除我的纹理来解决它

```
mSurfaceView.queueEvent(new Runnable(){
    //delete all textures here
} 
```

希望这会帮助其他人......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-25T23:24:40.917

如果您正在使用纹理和顶点缓冲区，我相信当您离开视图时它们会被清除。如果您收到 SurfaceDestoyed 或 SurfaceCreated 调用，那么我相信您必须重新创建纹理和 vbo 并将它们重新加载到显卡。

有一次我遇到了类似的问题，我引入了一个搞砸了 open gl 状态的错误。然后，当我进行另一项活动（硬件加速）时，该活动也一团糟。就我而言，我必须找到我制作的 open gl 错误并修复它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-08-16T22:03:31.753

你的问题可能和我的有关吗？阅读以确保它不是：[在 Galaxy S3 上暂停 GLSurfaceView 后仅显示文本 - 移动时文本模糊。没有按钮背景](https://stackoverflow.com/questions/18243966/text-only-thing-visible-after-pausing-glsurfaceview-on-galaxy-s3-text-blur-whe/18282765#18282765)

我的问题是在 UI 线程上执行 openGL 功能，这破坏了用于硬件加速的 openGL 上下文。

如果要测试：在 android 清单中禁用硬件加速应用程序范围。如果你的问题消失了，那很可能是我遇到的同样的问题。阅读我对自己问题的回答，了解如何在保持硬件加速的同时解决此问题。

```
<application android:hardwareAccelerated="false" ...> 
```

# wpf - WPF PathGeometry 渲染

> ID：14531871
> 
> 赞同：3
> 
> 时间：2013-01-25T23:19:41.407
> 
> 标签：wpf, performance, profiling, rendering, hardware-acceleration

我有一个包含一条折线的 PathGeometry，并以固定的间隔向该线添加一个新点（以绘制波形）。使用 Perforator 工具时，我可以看到每次向线条添加一个点时，WPF 都会将整个 PathGeometry 标记为“脏”，从而导致重新渲染整个形状。

我希望它只会重绘单个像素。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T07:07:37.453

最简洁的答案是不..

WPF 在更改时弄脏整个几何图形是正确的，因为它考虑了当前路径值也发生更改的情况。

如果将其分解，则可以使用行列表而不是路径。但是，
这意味着每次用户调整绘图区域的大小以保持比例时，您都必须更新行值。

所以要处理这个你可能会写一些代码说：
“如果用户调整大小 - 脏所有行”..

另一个问题是当您添加另一条线时，
您可能想要挤压所有线以适合您的绘图区域，
因此您可能会编写一些代码说：
“如果新线添加 - 脏所有线”..

现在，它使路径几何行为与您的迷你引擎具有 1 比 1 的相似性。

如果您不需要或不想在新行中处理调整大小或改装，
只需使用行列表即可。

# javascript - scaleApp.js 框架中定义的沙盒方法（如 sb.getContainer() 、 sb.getModel() ）在哪里？

> ID：14531873
> 
> 赞同：0
> 
> 时间：2013-01-25T23:19:58.620
> 
> 标签：javascript, model-view-controller

我有一个关于这个伟大的 js 框架[http://www.scaleapp.org](http://www.scaleapp.org)的基本问题。我无法找到代码中使用的沙盒（sb）对象的代码（我是 coffeescript 的新手）。

框架的源代码 - [https://github.com/flosse/scaleApp](https://github.com/flosse/scaleApp)

演示测试的源代码 - [https://github.com/flosse/FAST/blob/master/modules/box/box.js](https://github.com/flosse/FAST/blob/master/modules/box/box.js)

任何帮助都会很棒！如果您需要更多详细信息，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T08:20:33.413

你介意编辑你的问题更精确吗？

你可以在这里找到沙盒类：

```
https://github.com/flosse/scaleApp/blob/master/src/Sandbox.coffee 
```

还可以查看自述文件中的[快速入门部分。](https://github.com/flosse/scaleApp/blob/master/README.markdown#quick-start)

# c# - 类型“System.Data.Linq.Binary”在未引用的程序集中定义

> ID：14531883
> 
> 赞同：0
> 
> 时间：2013-01-25T23:20:38.457
> 
> 标签：c#, linq-to-sql

这似乎应该是一个简单的解决方案，但我似乎没有得到任何地方。我正在使用 Linq to SQL，在我的主应用程序中，我定义了一个名为 EventArgs 的类，其中包含指向三个表的链接。

我正在使用引用主项目的插件中的此类。到目前为止它工作得很好，但是当我添加第三个表时，我开始收到这个错误。代码如下：

```
results.BinaryTable.file = File.ReadAllBytes(Path);
results.BinaryTable.lprocessed = !isInvalid;
results.BinaryTable.type = "CAD_V"; 
```

问题出在第一行（引用 VarBinary(MAX)）。如果我将其注释掉，一切正常。但是，在尝试为其分配值时，我收到错误消息，“类型'System.Data.Linq.Binary'是在未引用的程序集中定义的。我尝试添加引用，但 System.Data 没有一个 Linq 库，仅仅添加 System.Data 并不能解决问题。

此后，我将“文件”类型更改为图像并重新加载了 DataContext，但属性中的类型仍然是二进制的，我仍然遇到同样的错误。我知道我需要做一个参考，但我不确定我从哪里得到这个参考。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T23:26:25.080

System.Data.Linq.Binary 在 dll System.Data.Linq.dll 中（不是 System.Data.dll）

确保您有对程序集的引用

看：

[http://msdn.microsoft.com/en-us/library/system.data.linq.binary.aspx](http://msdn.microsoft.com/en-us/library/system.data.linq.binary.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T23:25:59.360

它应该在程序集“System.Data.Linq.dll”中

# ruby-on-rails - 为 rails 中的控制器添加默认的后备操作

> ID：14531886
> 
> 赞同：1
> 
> 时间：2013-01-25T23:20:55.400
> 
> 标签：ruby-on-rails, ruby-on-rails-3, routing

我有一个带有单个索引操作的控制器。相同的资源有一些不需要控制器中的任何东西的静态资产。曾经有一些其他的现在已经消失了，但是网络上到处都是挥之不去的链接。

有没有一种方法可以匹配任何`/resource/*`没有在控制器中定义的操作或命名视图中的请求`app/views/resources/____`并将其路由到默认值（`resource#index`在这种情况下会很好）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T23:50:20.940

```
class MyConstraint
  BYPASSED_ROUTES = ['anything']

  def matches?(request)
    BYPASSED_ROUTES.map {|r| request.path.include?(r)}.empty?
  end
end

MyApp::Application.routes.draw do
  # Insert other routes before the catch-all one
  match "/resource/*path" => "resource#index", :constraints => MyConstraint.new
end 
```

# asp.net-mvc - 存储库模式和单元测试 ASP.NET Web API

> ID：14531888
> 
> 赞同：7
> 
> 时间：2013-01-25T23:21:20.907
> 
> 标签：asp.net-mvc, unit-testing, asp.net-web-api, repository-pattern

我刚刚开始深入研究单元测试，并且刚刚开始掌握存储库模式和 IoC。然而，我不认为我完全理解它，因为它的某些部分似乎有点傻。让我解释。

我的控制器：

```
public class UserProfileController : ApiController
{
    private IUserProfileRepository repository;

    // Optional constructor, passes repository, allows dependency injection
    public UserProfileController(IUserProfileRepository userProfileRepository)
    {
        this.repository = userProfileRepository;
    }

    // GET api/UserProfile
    // Returns a list of all users
    public IEnumerable<UserProfile> Get()
    {
        // Only Admins can see a list of users
        if (Roles.IsUserInRole("Admin"))
        {
            return repository.Get();
        }
        else
        {
            throw new HttpResponseException(
                new HttpResponseMessage(HttpStatusCode.Forbidden)
                {
                    ReasonPhrase = "Administrator access required"
                });
        }
    }

// Other methods, etc. 
```

（请注意，我有一个依赖项 Roles.IsUserInRole("Admin") 我无法弄清楚如何抽象，这会导致一些问题）。

我的典型回购界面：

```
public interface IUserProfileRepository : IDisposable
{
    IEnumerable<UserProfile> Get();
    // Other methods, etc.
} 
```

回购：

```
public class UserProfileRepository : IUserProfileRepository, IDisposable
{
    private OfootContext context;

    public UserProfileRepository(OfootContext context)
    {
        this.context = context;
    }

    public IEnumerable<UserProfile> Get()
    {
        return context.UserProfiles.AsEnumerable();
    }

// ... More code 
```

所以一切看起来都很好，我已经从我的业务逻辑中抽象出我的业务访问层，现在我可以创建一个假存储库来运行单元测试。

假回购：

```
public class FakeUserProfileRepository : IUserProfileRepository, IDisposable
{
    private List<UserProfile> context;

    public FakeUserProfileRepository(List<UserProfile> context)
    {
        this.context = context;
    }

    public IEnumerable<UserProfile> Get()
    {
        return context.AsEnumerable();
    } 
```

和测试：

```
[TestMethod]
public void GetUsers()
{
    // Arrange
    var items = new List<UserProfile>()
    {
        new UserProfile
        {
            UserId = 1,
            Username = "Bob",
        },
        new UserProfile
        {
            UserId = 2,
            Username = "Bob2",
        }
    };

    FakeUserProfileRepository repo = new FakeUserProfileRepository(
        items);
    UserProfileController controller = new UserProfileController(
        repo);

    // Act
    IEnumerable<UserProfile> result = controller.Get();

    // Assert
    Assert.IsNotNull(result);
} 
```

现在我们在同一页面上（并且随时指出任何“代码气味”），这是我的想法：

1.  假存储库要求我重新实现我的所有实体框架逻辑并将其更改为处理 List 对象。这是我需要调试的更多工作和链中的更多链接。
2.  如果单元测试确实通过了，它不会说明我的访问 EF 的代码，所以我的应用程序仍然可能失败。这只是意味着我需要单独测试我的 EF 代码并让它访问数据库。
3.  从 #1 开始，如果单元测试没有测试 EF 代码，那么它只是在我的控制器中处理我的身份验证、授权和用户创建代码。它不能，因为 WebSecurity 和 Roles 类访问了我的数据库。
4.  如果我要使用数据库来测试 EF 代码（第 2 点）并且需要一个数据库来测试控制器代码（用于身份验证和授权，第 3 点），那么为什么还要费心使用存储库进行抽象。为什么我不只是抽象上下文（使用 IContext 或其他东西？）并连接到使用 DropCreateDatabaseAlways 类填充的测试数据库中？

如果我确实找到了一种将用户帐户垃圾抽象出来的方法，我仍然只是在改组代码并创建更多代码（甚至可能是两倍？因为我需要创建假货），我可以在其中替换 Context。

我的问题是：我错过了什么？它是一个整体概念还是特定的东西？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-26T00:10:54.590

你在正确的轨道上。启动和运行总是很痛苦，但你会发现它在路上得到了回报。

[我建议使用像Moq](https://code.google.com/p/moq/)这样的框架，而不是创建“假”对象。它允许您在测试时设置所需的行为，而不是重新实现整个接口。例如，在您的测试中，您可以简单地编写：

```
 Mock<IUserProfileRepository> mockUserRepo = new Mock<IUserProfileRepository>();
    var items = new List<UserProfile>()
    {
        new UserProfile
        {
            UserId = 1,
            Username = "Bob",
        },
        new UserProfile
        {
            UserId = 2,
            Username = "Bob2",
        }
    };
   mockUserRepo.Setup(m => m.Get().Returns(items.AsEnumerable());
   UserProfileController controller = new UserProfileController(
        mockUserRepo.Object);

    // Act
   IEnumerable<UserProfile> result = controller.Get();
   //Now you can keep varying the mock response by changing the Setup(), so now 
   //check for null response handling, 0 items, exceptions etc... 
```

所有这些努力的最终结果是您已经将测试完全隔离到您的控制器，没有数据库依赖项，您可以轻松更改输入而无需编写类，而是使用模拟设置。

如果您遵循这种简单的架构模式，您将获得出色的可测试性和清晰的关注点分离。随着系统中的事情变得越来越复杂，您可以利用像 Unity 这样的 DI 容器。

在身份验证部分，我建议创建可以用来装饰方法的属性，例如 ASP.Net MVC 使用：[Authorization(Roles="Admin")] 作为示例。这创建了另一种有用的横切模式，使 Auth 内容与控制器中的业务逻辑分离。

# android - ListView 行中的 ViewFlipper

> ID：14531897
> 
> 赞同：1
> 
> 时间：2013-01-25T23:22:52.863
> 
> 标签：android, android-listview, viewflipper

我有一个 ListView，每行都有一个 XML 视图。

每一行都有一个 ViewFlipper 和一个 Button，目的是按下按钮并在 ViewFlipper 上翻阅视图。

问题是我无法让按钮翻转正确的 ViewFlipper。我在 ListView 适配器中设置行，所以我认为这是我应该处理按钮单击的地方。

尽管正在处理单击，但被“翻转”的 ViewFlipper 位于不同的行上。我认为这是因为适配器正在回收视图 - 我只是不知道如何解决这个问题。

我的代码是

```
public View getView(int position, View convertView, ViewGroup parent) {

    if (convertView == null) {
        convertView = mLayoutInflater.inflate(mLayout, null);

        viewHolder = new ViewHolder();
        viewHolder.flipper = (ViewFlipper) convertView.findViewById(R.id.viewConfFlipper1);
        viewHolder.v2FieldName = (TextView) convertView.findViewById(R.id.tvLongName);
        viewHolder.button01 = (ImageButton) convertView.findViewById(R.id.imageButton1);

        viewHolder.button01.setOnClickListener(new OnClickListener() {
            public void onClick(View v) {
                viewHolder.flipper.showNext();
            }
        });

        convertView.setTag(viewHolder);

    } else {
        viewHolder = (ViewHolder) convertView.getTag();
    }

    viewHolder.v2FieldName.setText(items.get(position).get("name"));

    return convertView;
} 
```

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T21:49:09.333

设法让它现在工作，代码是

```
public View getView(int position, View convertView, ViewGroup parent) {

    final ViewFlipper flipperTemp;

    if (convertView == null) {
        convertView = mLayoutInflater.inflate(mLayout, null);

        viewHolder = new ViewHolder();
        viewHolder.flipper = (ViewFlipper) convertView.findViewById(R.id.viewConfFlipper1);
        viewHolder.flipper.setDisplayedChild(0);
        viewHolder.v2FieldName = (TextView) convertView.findViewById(R.id.tvLongName);
        viewHolder.button01 = (ImageButton) convertView.findViewById(R.id.imageButton1);    
        convertView.setTag(viewHolder);

    } else {
        viewHolder = (ViewHolder) convertView.getTag();
        viewHolder.flipper.setDisplayedChild(0);
    }

    flipperTemp = (ViewFlipper) convertView.findViewById(R.id.viewConfFlipper1);

    viewHolder.v2FieldName.setText(items.get(position).get("name"));        
    viewHolder.button01.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {
            flipperTemp.showNext();
        }
    });

    return convertView;
} 
```

# c++ - 是否正在收集我的 Lua 对象？

> ID：14531901
> 
> 赞同：1
> 
> 时间：2013-01-25T23:23:14.567
> 
> 标签：c++, memory-leaks, lua

**警告：**

我现在确信问题在于[这里解释](https://stackoverflow.com/questions/7166124/find-all-references-to-an-object-in-lua)的 luatraverse 脚本不能像宣传的那样工作，并且没有找到对对象的所有引用。在我的示例中，我找到了对象被引用的位置，从而阻止了它的收集，但脚本没有报告这一点。

因此，这个问题的基本前提有些缺陷。

**背景：**

我正在努力增强游戏[Bitfighter](http://bitfighter.org)中的脚本引擎。我不相信内存正在被正确释放。所以我以下面脚本的形式构建了一个测试。

它打印 3 列用户数据。第 1 列是我希望在其他任何地方都不会使用的用户数据，因此应该被 collectgarbage 函数销毁。第 2 列和第 3 列是我认为不应该收集的对象，因为我正在处理它们。

**问题：**

第 1 列中的用户数据永远不会改变，所以我怀疑它没有被收集（第 2 列和第 3 列的行为符合预期）。为了进一步澄清情况，我使用了[这个问题](https://stackoverflow.com/questions/7166124/find-all-references-to-an-object-in-lua)中提到的 luatraverse 脚本，这似乎证实了对 obj100 的引用只有一个，即存储在 obj100 本身中的那个。我尝试在运行 countreferences (local x = obj100) 之前添加一个赋值，并且正如预期的那样，countreferences 报告了该对象被引用了两次。

**问题：**

1）我是否正确地解释了这个输出，而且 obj100 真的从来没有收集过吗？还是有可能一遍又一遍地重复使用相同的内存地址？

2) 有没有比 luatraverse 脚本更好的方法来查看引用特定 Lua 对象的内容？

**编码：**

```
 -- Every 2 seconds, find two objects with ids 100 and 200, and print their addrs
 -- No reference is kept for object 100, so its userdata might change over time
 -- Object 200 is held by objHolder, so its userdata should remain constant

 -- Obj200 should remain constant over time; obj100 can vary.  
 -- objHolder should be constant, obviously

 local ltraverse = require("luatraverse")

 function printIds()
    local obj100 = levelgen:findObjectById(100)
    local obj200 = levelgen:findObjectById(200)
    print("Obj 100:" .. tostring(obj100) .. " Obj 200:" .. 
           tostring(obj200) .. " Held:" .. tostring(objHolder))

    print(ltraverse.countreferences(obj100))

    obj100 = nil
    obj200 = nil

    collectgarbage()
 end

 function main()
    -- levelgen:findObjectById is a local game command that
    -- creates a userdata for an object
    local obj100 = levelgen:findObjectById(100)
    objHolder    = levelgen:findObjectById(200)     -- not local, global

    assert(obj100)
    assert(objHolder)

    print("Column 1 can vary; 2 and 3 should be constant")
    print("=============================================")

    print("Obj 100:" .. tostring(obj100) .. " Obj 200:" .. 
         tostring(objHolder) .. " Held:" .. tostring(objHolder))

    obj100 = nil

    -- Run a function every 2 seconds
    Timer:scheduleRepeating(printIds, 2000)
 end 
```

**输出：**

```
 Column 1 can vary; 2 and 3 should be constant
 =============================================
 Obj 100:userdata: 02FC9700 Obj 200:userdata: 02FAD280 Held:userdata: 02FAD280

 Obj 100:userdata: 02FC9700 Obj 200:userdata: 02FAD280 Held:userdata: 02FAD280
 1
 Obj 100:userdata: 02FC9700 Obj 200:userdata: 02FAD280 Held:userdata: 02FAD280
 1
 Obj 100:userdata: 02FC9700 Obj 200:userdata: 02FAD280 Held:userdata: 02FAD280
 1
 Obj 100:userdata: 02FC9700 Obj 200:userdata: 02FAD280 Held:userdata: 02FAD280
 1
 Obj 100:userdata: 02FC9700 Obj 200:userdata: 02FAD280 Held:userdata: 02FAD280
 1
 ... and onward to infinity ... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T23:35:33.547

我不知道 Bitfighter，但我假设您在这里测量错误：

这一行将创建一个新的 Lua userdata 对象，它本质上指向真正的 C++(?) 对象：

```
local obj100 = levelgen:findObjectById(100) 
```

稍后在以下行将打印 Lua 指向该用户数据（`obj100`而不是实际数据）的引用数量：

```
print(ltraverse.countreferences(obj100)) 
```

这将始终为 1，因为您刚刚使用一个引用创建了该对象。

引用/Lua 对象很可能已被收集，您不会看到。实际的用户数据（指针）总是相同的，因为您请求的是相同的对象 ID。因此，此值不得更改，除非相关数据被其他代码移动/重新分配。

但最后，我想说这真的取决于`levelgen:findObjectById()`回报。如果您尝试以下几行会发生什么？

```
local temp
local obj100 = temp = levelgen:findObjectById(100) 
```

# javascript - 您如何模拟作为函数的 Angular 服务？

> ID：14531904
> 
> 赞同：2
> 
> 时间：2013-01-25T23:23:24.507
> 
> 标签：javascript, unit-testing, angularjs, jasmine

我们有一个我们称之为 a 的东西`CORShttpService`，它基本上是`$http`服务的包装器，但封装了一些我们需要的 CORS 功能。我现在正在为已`CORShttpService`注入的服务编写一些测试。该服务的代码如下：

```
CORShttpService({method: requestMethod, url: getUrl(path), data: data}).
    success(function(data, status, headers) {
        //do success stuff
    }).
    error(function(data, status, headers) {
       //do error stuff
    }); 
```

我想模拟对 的调用`CORShttpService`，但我不知道该怎么做。我正在使用 Jasmine，它的`spyOn`功能需要一个对象来模拟对象上的功能。My`CORShttpService`没有附加到任何对象，所以我不知道如何去嘲笑它。是的，我可以`$httpBackend`用来模拟最终在 中设置的请求`CORShttpService`，但我不希望它首先进入该服务。我想隔离单元测试并简单地模拟外部调用。有什么方法可以模拟这个只是一个功能的服务吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-28T19:08:36.587

当我更多地考虑这一点时，该`$httpBackend`服务确实为测试请求提供了很多功能。由于 my`CORShttpService`基本上是一个包装器，我决定如果我对简单的实现`$http`进行模拟实现，我可能会获得最大的收益。使用[此文档](http://docs.angularjs.org/api/AUTO.%24provide)来帮助我，我的规范中有以下内容：`CORShttpService``$http`

```
beforeEach(module(function($provide) {
    $provide.provider('CORShttpService', function() {
        this.$get = function($http) {
            return $http;
        };
    });
})); 
```

因此，我的任何想要`CORShttpService`注入的服务现在基本上都只是`$http`注入了，因此我可以使用所有`$httpBackend`功能而无需担心`CORShttpService`自身中发现的额外功能。

这适用于我的具体情况，但就模拟只是一个函数的服务的一般解决方案而言，可能可以`jasmine.createSpy`像 zbynour 的回答中提到的那样做同样的事情。就像是：

```
beforeEach(module(function($provide) {
    $provide.provider('MyService', function() {
        this.$get = function() {
            return jasmine.createSpy("myService");
        };
    });
})); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-26T12:04:59.977

是的，正如您所写的，`spyOn`可以存根一个函数，但它必须是已经存在的对象的属性。我也同意最好隔离单位。:)

你需要的是`jasmine.createSpy`. 这样，您可以创建一个裸间谍并像往常一样定义其行为（使用`andReturn`、`andCallFake`等）。

我认为像下面的代码（也带有`jasmine.createSpyObj`）云是你想要的：

```
it ('should do sth', function() {

    var res = jasmine.createSpyObj('res', [ 'success', 'error' ]);
    res.success.andReturn(res);
    res.error.andReturn(res);
    var corsHttpService = jasmine.createSpy().andReturn(res);

    // call the service using corsHttpService
    anotherService(corsHttpService);

    // assert
    expect(corsHttpService).toHaveBeenCalledWith({
        method: requestMethod, 
        url: url,
        data: data});
    expect(res.success).toHaveBeenCalledWith(jasmine.any(Function));
    expect(res.error).toHaveBeenCalledWith(jasmine.any(Function));
}); 
```

如果您想走得更远，而不是简单

```
res.success.andReturn(res); 
```

您可以存储传入的回调

```
var succCallback;
res.success.andCallFake(function(callback) {
        succCallback = callback;
        return res;
    }); 
```

稍后在规范中，您可以调用回调来模拟来自以下的成功结果`corsHttpService`：

```
succCallback('a-data', 'a-status', 'a-header'); 
```

然后可以测试测试服务的“成功的东西”......

# php - call_user_method_array 函数已弃用，用什么代替它？

> ID：14531910
> 
> 赞同：4
> 
> 时间：2013-01-25T23:23:49.133
> 
> 标签：php

> **可能重复：**
> [推荐替换已弃用的 call_user_method？](https://stackoverflow.com/questions/782846/recommended-replacement-for-deprecated-call-user-method)
> [不推荐使用 PHP 中的函数，我现在应该使用什么？](https://stackoverflow.com/questions/2151125/function-in-php-deprecated-what-should-i-use-now)

该`call_user_method_array`功能已弃用，那么我应该使用什么来实现相同的结果？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-25T23:25:51.970

从[手册](https://www.google.com/search?q=call_user_method_array&oq=call_user_method_array&sourceid=chrome&ie=UTF-8)：

> 示例 #1`call_user_method_array()`替代方案

```
 <?php
 call_user_func_array(array($obj, $method_name), $params);
 call_user_func_array(array(&$obj, $method_name), $params); // PHP 4
 ?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T23:34:10.740

call_user_method_array() 函数自 PHP 4.1.0 起已弃用。

现在您可以使用**call_user_func_array** (callable $callback, array $parameters)，其中 $callback 或字符串函数名或数组 ( $object, $function_name )。

[http://php.net/manual/en/function.call-user-func-array.php](http://php.net/manual/en/function.call-user-func-array.php)

# ios - 在 iOS 设备上本地存储图像

> ID：14531912
> 
> 赞同：44
> 
> 时间：2013-01-25T23:24:03.770
> 
> 标签：ios, objective-c, uiimageview, uiimage, nsfilemanager

一些 iOS 与照片相关的应用程序将使用该应用程序创建的图像存储在照片库以外的位置。例如，Fat Booth 显示了在应用启动时使用应用创建的照片的滚动列表。请注意，这些照片不会被用户明确保存到照片库中。**在 iOS 应用程序中保存和持久化图像的最简单方法是什么？**

我熟悉的唯一持久存储是 NSUserDefaults 和密钥链。但是，我从未听说过这些用于存储更大的数据，例如图像。现在我想知道核心数据是否是最简单的方法。

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2013-01-25T23:36:18.813

最简单的方法是将其保存在应用程序的 Documents 目录中，并使用 NSUserDefaults 保存路径，如下所示：

```
NSData *imageData = UIImagePNGRepresentation(newImage);

NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:0];

NSString *imagePath =[documentsDirectory stringByAppendingPathComponent:[NSString stringWithFormat:@"%@.png",@"cached"]];

NSLog(@"pre writing to file");
if (![imageData writeToFile:imagePath atomically:NO]) 
{
    NSLog(@"Failed to cache image data to disk");
}
else
{
    NSLog(@"the cachedImagedPath is %@",imagePath); 
} 
```

然后将 imagePath 保存在 NSUserDefaults 中的某个字典中，或者您想要的任何内容中，然后检索它只需执行以下操作：

```
 NSString *theImagePath = [yourDictionary objectForKey:@"cachedImagePath"];
 UIImage *customImage = [UIImage imageWithContentsOfFile:theImagePath]; 
```

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2014-11-25T10:46:40.257

对于斯威夫特：

```
let imageData = UIImagePNGRepresentation(selectedImage)
let paths = NSSearchPathForDirectoriesInDomains(.DocumentDirectory, .UserDomainMask, true)[0] as String
let imagePath = paths.stringByAppendingPathComponent("cached.png")

if !imageData.writeToFile(imagePath, atomically: false)
{
   println("not saved")
} else {
   println("saved")
   NSUserDefaults.standardUserDefaults().setObject(imagePath, forKey: "imagePath")
} 
```

对于 Swift 2.1：

```
let imageData = UIImagePNGRepresentation(selectedImage)
let documentsURL = NSFileManager.defaultManager().URLsForDirectory(.DocumentDirectory, inDomains: .UserDomainMask)[0]
let imageURL = documentsURL.URLByAppendingPathComponent("cached.png")

if !imageData.writeToURL(imageURL, atomically: false)
{
    print("not saved")
} else {
    print("saved")
    NSUserDefaults.standardUserDefaults().setObject(imageData, forKey: "imagePath")
} 
```

`stringByAppendingPathComponent`在 Swift 2.1 中不可用，因此您可以在此处使用`URLByAppendingPathComponent.` 获取更多信息[。](https://stackoverflow.com/a/32120582/1655378)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-01-25T23:30:43.617

您**可以**通过存储二进制数据来处理核心数据，**但不建议**这样做。有一个更好的方法 - 特别是对于照片。您的应用程序有一个只有您的应用程序可以访问的文档/文件目录。我建议从这里开始了解概念以及如何访问它。它相对简单。您可能希望将其与核心数据相结合以存储文件路径、元数据等。[http://developer.apple.com/library/mac/#documentation/FileManagement/Conceptual/FileSystemProgrammingGUIide/FileSystemOverview/FileSystemOverview.html](http://developer.apple.com/library/mac/#documentation/FileManagement/Conceptual/FileSystemProgrammingGUide/FileSystemOverview/FileSystemOverview.html)

# java - 从命令行启动 Minecraft - 用户名和密码作为前缀

> ID：14531917
> 
> 赞同：23
> 
> 时间：2013-01-25T23:24:16.180
> 
> 标签：java, terminal, cmd, launcher, minecraft

我正在尝试制作一个简单的自定义 Minecraft 启动器。

根据[Launcher 的 Minecraft Wiki 页面](http://www.minecraftwiki.net/wiki/Minecraft_launcher)，应该可以使用命令行中的用户名和密码前缀运行 Minecraft 启动器，并直接进入游戏而不是通过启动器。

我尝试了各种版本的`java -cp -u=username -p=password minecraft.jar net.minecraft.LauncherFrame`，它说的是旧方法：

```
java -cp minecraft.jar net.minecraft.LauncherFrame <username> <password> 
```

旧方法打开 minecraft 启动器，就像我双击 jar 文件一样，但它不会直接进入菜单屏幕。

新方法（使用密码和用户名作为前缀）给我一条错误消息，说`prefix -u=username or -p=password don't exist`.

对此有什么帮助吗？我真的被困住了。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-03-22T03:44:51.747

你**可以**这样做，你只需要绕过启动器。

在`%appdata%\.minecraft\bin`（或`~/.minecraft/bin`在 unixy 系统上），有一个 minecraft.jar 文件。这是真正的游戏 - 启动器运行它。

像这样调用它：

```
java -Xms512m -Xmx1g -Djava.library.path=natives/ -cp "minecraft.jar;lwjgl.jar;lwjgl_util.jar" net.minecraft.client.Minecraft <username> <sessionID> 
```

将工作目录设置为`.minecraft/bin`.

要获取会话 ID，请 POST（请求此页面）：

```
https://login.minecraft.net?user=<username>&password=<password>&version=13 
```

你会得到这样的回应：

```
1343825972000:deprecated:SirCmpwn:7ae9007b9909de05ea58e94199a33b30c310c69c:dba0c48e1c584963b9e93a038a66bb98 
```

第四个字段是会话 ID。[更多细节在这里](http://wiki.vg/Authentication#Login)。**阅读这些细节，这个答案已经过时了**

[这是一个使用 C# 登录 minecraft.net 的示例](https://github.com/ddevault/Craft.Net/blob/master/source/Craft.Net.Client/Session.cs)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2018-11-23T17:14:37.990

使用 Forge 运行 Minecraft（更改`C:\Users\nov11\AppData\Roaming/.minecraft/`为您的 MineCraft 路径 :) [仅适用于有点懒得在 Google 上搜索的人...] 特别感谢 ammarx用于创建此命令的[TagAPI_3（Github） 。](https://github.com/ammarx/TagAPI_3)参数被逐行分隔，以便更容易找到有用的参数。

```
java
-Xms1024M
-Xmx1024M
-XX:HeapDumpPath=MojangTricksIntelDriversForPerformance_javaw.exe_minecraft.exe.heapdump
-Djava.library.path=C:\Users\nov11\AppData\Roaming/.minecraft/versions/1.12.2/natives
-cp
C:\Users\nov11\AppData\Roaming/.minecraft/libraries/net/minecraftforge/forge/1.12.2-14.23.5.2775/forge-1.12.2-14.23.5.2775.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/net/minecraft/launchwrapper/1.12/launchwrapper-1.12.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/org/ow2/asm/asm-all/5.2/asm-all-5.2.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/org/jline/jline/3.5.1/jline-3.5.1.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/net/java/dev/jna/jna/4.4.0/jna-4.4.0.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/com/typesafe/akka/akka-actor_2.11/2.3.3/akka-actor_2.11-2.3.3.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/com/typesafe/config/1.2.1/config-1.2.1.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/org/scala-lang/scala-actors-migration_2.11/1.1.0/scala-actors-migration_2.11-1.1.0.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/org/scala-lang/scala-compiler/2.11.1/scala-compiler-2.11.1.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/org/scala-lang/plugins/scala-continuations-library_2.11/1.0.2/scala-continuations-library_2.11-1.0.2.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/org/scala-lang/plugins/scala-continuations-plugin_2.11.1/1.0.2/scala-continuations-plugin_2.11.1-1.0.2.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/org/scala-lang/scala-library/2.11.1/scala-library-2.11.1.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/org/scala-lang/scala-parser-combinators_2.11/1.0.1/scala-parser-combinators_2.11-1.0.1.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/org/scala-lang/scala-reflect/2.11.1/scala-reflect-2.11.1.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/org/scala-lang/scala-swing_2.11/1.0.1/scala-swing_2.11-1.0.1.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/org/scala-lang/scala-xml_2.11/1.0.2/scala-xml_2.11-1.0.2.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/lzma/lzma/0.0.1/lzma-0.0.1.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/net/sf/jopt-simple/jopt-simple/5.0.3/jopt-simple-5.0.3.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/java3d/vecmath/1.5.2/vecmath-1.5.2.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/net/sf/trove4j/trove4j/3.0.3/trove4j-3.0.3.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/org/apache/maven/maven-artifact/3.5.3/maven-artifact-3.5.3.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/com/mojang/patchy/1.1/patchy-1.1.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/oshi-project/oshi-core/1.1/oshi-core-1.1.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/net/java/dev/jna/jna/4.4.0/jna-4.4.0.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/net/java/dev/jna/platform/3.4.0/platform-3.4.0.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/com/ibm/icu/icu4j-core-mojang/51.2/icu4j-core-mojang-51.2.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/net/sf/jopt-simple/jopt-simple/5.0.3/jopt-simple-5.0.3.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/com/paulscode/codecjorbis/20101023/codecjorbis-20101023.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/com/paulscode/codecwav/20101023/codecwav-20101023.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/com/paulscode/libraryjavasound/20101123/libraryjavasound-20101123.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/com/paulscode/librarylwjglopenal/20100824/librarylwjglopenal-20100824.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/com/paulscode/soundsystem/20120107/soundsystem-20120107.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/io/netty/netty-all/4.1.9.Final/netty-all-4.1.9.Final.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/com/google/guava/guava/21.0/guava-21.0.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/org/apache/commons/commons-lang3/3.5/commons-lang3-3.5.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/commons-io/commons-io/2.5/commons-io-2.5.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/commons-codec/commons-codec/1.10/commons-codec-1.10.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/net/java/jinput/jinput/2.0.5/jinput-2.0.5.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/net/java/jutils/jutils/1.0.0/jutils-1.0.0.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/com/google/code/gson/gson/2.8.0/gson-2.8.0.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/com/mojang/authlib/1.5.25/authlib-1.5.25.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/com/mojang/realms/1.10.22/realms-1.10.22.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/org/apache/commons/commons-compress/1.8.1/commons-compress-1.8.1.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/org/apache/httpcomponents/httpclient/4.3.3/httpclient-4.3.3.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/commons-logging/commons-logging/1.1.3/commons-logging-1.1.3.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/org/apache/httpcomponents/httpcore/4.3.2/httpcore-4.3.2.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/it/unimi/dsi/fastutil/7.1.0/fastutil-7.1.0.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/org/apache/logging/log4j/log4j-api/2.8.1/log4j-api-2.8.1.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/org/apache/logging/log4j/log4j-core/2.8.1/log4j-core-2.8.1.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/org/lwjgl/lwjgl/lwjgl/2.9.4-nightly-20150209/lwjgl-2.9.4-nightly-20150209.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/org/lwjgl/lwjgl/lwjgl_util/2.9.4-nightly-20150209/lwjgl_util-2.9.4-nightly-20150209.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/org/lwjgl/lwjgl/lwjgl-platform/2.9.4-nightly-20150209/lwjgl-platform-2.9.4-nightly-20150209.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/org/lwjgl/lwjgl/lwjgl/2.9.2-nightly-20140822/lwjgl-2.9.2-nightly-20140822.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/org/lwjgl/lwjgl/lwjgl_util/2.9.2-nightly-20140822/lwjgl_util-2.9.2-nightly-20140822.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/com/mojang/text2speech/1.10.3/text2speech-1.10.3.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/com/mojang/text2speech/1.10.3/text2speech-1.10.3.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/ca/weblite/java-objc-bridge/1.0.0/java-objc-bridge-1.0.0.jar;C:\Users\nov11\AppData\Roaming/.minecraft/libraries/ca/weblite/java-objc-bridge/1.0.0/java-objc-bridge-1.0.0.jar;C:\Users\nov11\AppData\Roaming/.minecraft/versions/1.12.2/1.12.2.jar
net.minecraft.launchwrapper.Launch
--width
854
--height
480
--username
Ishikawa
--version
1.12.2-forge1.12.2-14.23.5.2775
--gameDir
C:\Users\nov11\AppData\Roaming/.minecraft
--assetsDir
C:\Users\nov11\AppData\Roaming/.minecraft/assets
--assetIndex
1.12
--uuid
N/A
--accessToken
aeef7bc935f9420eb6314dea7ad7e1e5
--userType
mojang
--tweakClass
net.minecraftforge.fml.common.launcher.FMLTweaker
--versionType
Forge 
```

就在其他解决方案不起作用时。accessToken 和 uuid 可以从 Mojang 服务器获取，详情请查看其他回答者。

编辑 (26.11.2018)：我还在 C# (.NET Framework 3.5) 中创建了 Launcher Framework，您还可以查看启动器应该如何工作 [在这里可用](https://gitlab.com/TitanumIchigo/minelan)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2021-01-27T22:45:23.547

对于任何想要为不同的 Minecraft 版本更可靠地执行此操作的人，我有一个 Python 脚本（改编自[minecraft-launcher-lib](https://gitlab.com/JakobDev/minecraft-launcher-lib)的部分内容）可以很好地完成这项工作

除了在函数之后的顶部附近设置一些基本变量之外，它还调用一个`get_classpath`读取 example 的函数`~/.minecraft/versions/1.16.5/1.16.5.json`，并循环遍历属性`libraries`数组，检查每个对象（数组内）是否应该添加到类路径（`cp`变量）。是否将此库添加到 java 类路径由`should_use_library`函数控制，根据计算机的体系结构和操作系统确定。最后，一些特定于平台的 jarfile 在它们前面添加了额外的东西（例如`natives-linux`in `org/lwjgl/lwjgl/3.2.1/lwjgl-3.2.1-natives-linux.jar`）。这个额外的前置字符串由处理，`get_natives_string`如果它不适用于当前库，则为空

在 Linux 上测试，分发 Arch Linux

```
#!/usr/bin/env python3

import json
import os
import platform
from pathlib import Path
import subprocess

"""
Debug output
"""
def debug(str):
    if os.getenv('DEBUG') != None:
        print(str)

"""
[Gets the natives_string toprepend to the jar if it exists. If there is nothing native specific, returns and empty string]
"""
def get_natives_string(lib):
    arch = ""
    if platform.architecture()[0] == "64bit":
        arch = "64"
    elif platform.architecture()[0] == "32bit":
        arch = "32"
    else:
        raise Exception("Architecture not supported")

    nativesFile=""
    if not "natives" in lib:
        return nativesFile

    if "windows" in lib["natives"] and platform.system() == 'Windows':
        nativesFile = lib["natives"]["windows"].replace("${arch}", arch)
    elif "osx" in lib["natives"] and platform.system() == 'Darwin':
        nativesFile = lib["natives"]["osx"].replace("${arch}", arch)
    elif "linux" in lib["natives"] and platform.system() == "Linux":
        nativesFile = lib["natives"]["linux"].replace("${arch}", arch)
    else:
        raise Exception("Platform not supported")

    return nativesFile

"""
[Parses "rule" subpropery of library object, testing to see if should be included]
"""
def should_use_library(lib):
    def rule_says_yes(rule):
        useLib = None

        if rule["action"] == "allow":
            useLib = False
        elif rule["action"] == "disallow":
            useLib = True

        if "os" in rule:
            for key, value in rule["os"].items():
                os = platform.system()
                if key == "name":
                    if value == "windows" and os != 'Windows':
                        return useLib
                    elif value == "osx" and os != 'Darwin':
                        return useLib
                    elif value == "linux" and os != 'Linux':
                        return useLib
                elif key == "arch":
                    if value == "x86" and platform.architecture()[0] != "32bit":
                        return useLib

        return not useLib

    if not "rules" in lib:
        return True

    shouldUseLibrary = False
    for i in lib["rules"]:
        if rule_says_yes(i):
            return True

    return shouldUseLibrary

"""
[Get string of all libraries to add to java classpath]
"""
def get_classpath(lib, mcDir):
    cp = []

    for i in lib["libraries"]:
        if not should_use_library(i):
            continue

        libDomain, libName, libVersion = i["name"].split(":")
        jarPath = os.path.join(mcDir, "libraries", *
                               libDomain.split('.'), libName, libVersion)

        native = get_natives_string(i)
        jarFile = libName + "-" + libVersion + ".jar"
        if native != "":
            jarFile = libName + "-" + libVersion + "-" + native + ".jar"

        cp.append(os.path.join(jarPath, jarFile))

    cp.append(os.path.join(mcDir, "versions", lib["id"], f'{lib["id"]}.jar'))

    return os.pathsep.join(cp)

version = '1.16.5'
username = '{username}'
uuid = '{uuid}'
accessToken = '{token}'

mcDir = os.path.join(os.getenv('HOME'), '.minecraft')
nativesDir = os.path.join(os.getenv('HOME'), 'versions', version, 'natives')
clientJson = json.loads(
    Path(os.path.join(mcDir, 'versions', version, f'{version}.json')).read_text())
classPath = get_classpath(clientJson, mcDir)
mainClass = clientJson['mainClass']
versionType = clientJson['type']
assetIndex = clientJson['assetIndex']['id']

debug(classPath)
debug(mainClass)
debug(versionType)
debug(assetIndex)

subprocess.call([
    '/usr/bin/java',
    f'-Djava.library.path={nativesDir}',
    '-Dminecraft.launcher.brand=custom-launcher',
    '-Dminecraft.launcher.version=2.1',
    '-cp',
    classPath,
    'net.minecraft.client.main.Main',
    '--username',
    username,
    '--version',
    version,
    '--gameDir',
    mcDir,
    '--assetsDir',
    os.path.join(mcDir, 'assets'),
    '--assetIndex',
    assetIndex,
    '--uuid',
    uuid,
    '--accessToken',
    accessToken,
    '--userType',
    'mojang',
    '--versionType',
    'release'
]) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-04-29T22:33:54.723

这个答案将简要解释如何在最新的启动器上处理本机文件。

自 2017 年 4 月 29 日起，适用于 Windows 的 Minecraft 启动器会提取所有本机文件并将它们放在信息 %APPDATA%\Local\Temp{random folder} 中。该文件夹是临时的，一旦 javaw.exe 进程完成（当 Minecraft 关闭时）就会被删除。该临时文件夹的位置必须在启动参数中作为

```
-Djava.library.path= 
```

此外，最新的启动器 (2.0.847) 不会向您显示启动参数，因此如果您需要自己检查它们，您可以在任务管理器下进行（只需启用命令行选项卡并展开它）或使用`WMIC`实用程序[作为在这里解释](https://superuser.com/a/519802/420434)。

希望这可以帮助一些在 2017 年仍然有兴趣这样做的人。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-07-21T08:48:20.573

只需在您的游戏目录中创建此批处理命令文件。Bat 文件采用一个参数 %1 作为用户名。

另外，我使用闪屏来制作漂亮的。您将无法在线玩游戏，但谁在乎呢。

调整您的内存使用量以适合您的机器（-Xmx 和 -Xmns）。

注意：这是截至 2016 年 6 月 27 日的我的世界版本

```
@ECHO OFF
SET DIR=%cd%
SET JAVA_HOME=%DIR%\runtime\jre-x64\1.8.0_25
SET JAVA=%JAVA_HOME%\bin\java.exe
SET LOW_MEM=768M
SET MAX_MEM=2G
SET LIBRARIES=versions\1.10.2\1.10.2-natives-59894925878961
SET MAIN_CLASS=net.minecraft.client.main.Main
SET CLASSPATH=libraries\com\mojang\netty\1.6\netty-1.6.jar;libraries\oshi-project\oshi-core\1.1\oshi-core-1.1.jar;libraries\net\java\dev\jna\jna\3.4.0\jna-3.4.0.jar;libraries\net\java\dev\jna\platform\3.4.0\platform-3.4.0.jar;libraries\com\ibm\icu\icu4j-core-mojang\51.2\icu4j-core-mojang-51.2.jar;libraries\net\sf\jopt-simple\jopt-simple\4.6\jopt-simple-4.6.jar;libraries\com\paulscode\codecjorbis\20101023\codecjorbis-20101023.jar;libraries\com\paulscode\codecwav\20101023\codecwav-20101023.jar;libraries\com\paulscode\libraryjavasound\20101123\libraryjavasound-20101123.jar;libraries\com\paulscode\librarylwjglopenal\20100824\librarylwjglopenal-20100824.jar;libraries\com\paulscode\soundsystem\20120107\soundsystem-20120107.jar;libraries\io\netty\netty-all\4.0.23.Final\netty-all-4.0.23.Final.jar;libraries\com\google\guava\guava\17.0\guava-17.0.jar;libraries\org\apache\commons\commons-lang3\3.3.2\commons-lang3-3.3.2.jar;libraries\commons-io\commons-io\2.4\commons-io-2.4.jar;libraries\commons-codec\commons-codec\1.9\commons-codec-1.9.jar;libraries\net\java\jinput\jinput\2.0.5\jinput-2.0.5.jar;libraries\net\java\jutils\jutils\1.0.0\jutils-1.0.0.jar;libraries\com\google\code\gson\gson\2.2.4\gson-2.2.4.jar;libraries\com\mojang\authlib\1.5.22\authlib-1.5.22.jar;libraries\com\mojang\realms\1.9.3\realms-1.9.3.jar;libraries\org\apache\commons\commons-compress\1.8.1\commons-compress-1.8.1.jar;libraries\org\apache\httpcomponents\httpclient\4.3.3\httpclient-4.3.3.jar;libraries\commons-logging\commons-logging\1.1.3\commons-logging-1.1.3.jar;libraries\org\apache\httpcomponents\httpcore\4.3.2\httpcore-4.3.2.jar;libraries\it\unimi\dsi\fastutil\7.0.12_mojang\fastutil-7.0.12_mojang.jar;libraries\org\apache\logging\log4j\log4j-api\2.0-beta9\log4j-api-2.0-beta9.jar;libraries\org\apache\logging\log4j\log4j-core\2.0-beta9\log4j-core-2.0-beta9.jar;libraries\org\lwjgl\lwjgl\lwjgl\2.9.4-nightly-20150209\lwjgl-2.9.4-nightly-20150209.jar;libraries\org\lwjgl\lwjgl\lwjgl_util\2.9.4-nightly-20150209\lwjgl_util-2.9.4-nightly-20150209.jar;versions\1.10.2\1.10.2.jar
SET JAVA_OPTIONS=-server -splash:splash.png -d64 -da -dsa -Xrs -Xms%LOW_MEM% -Xmx%MAX_MEM% -XX:NewSize=%LOW_MEM% -XX:+UseConcMarkSweepGC -XX:+CMSIncrementalMode -XX:-UseAdaptiveSizePolicy -XX:+DisableExplicitGC -Djava.library.path=%LIBRARIES% -cp %CLASSPATH%  %MAIN_CLASS%

start /D %DIR% /I /HIGH %JAVA% %JAVA_OPTIONS% --username %1 --version 1.10.2 --gameDir %DIR% --assetsDir assets --assetIndex 1.10 --uuid 2536abce90e8476a871679918164abc5 --accessToken 99abe417230342cb8e9e2168ab46297a --userType legacy --versionType release --nativeLauncherVersion 307 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-25T23:43:39.270

这些都是在文本框中使用这些凭据启动标准我的世界启动器的所有方法。

曾经有一种方法可以在没有启动器的情况下使用命令行登录我的世界，但它已经被修补了。

如果您想使用命令行制作自定义启动器，那么祝您好运，登录 minecraft jar 的唯一方法（IE：启动器的方式）是向[https://login.minecraft 发送一个发布请求。 net/](https://login.minecraft.net/)带有用户名、密码、启动器版本和 RSA 密钥。然后它解析伪 Json，并使用其中的会话令牌从命令行使用大量参数对 jar 进行身份验证。

如果你正在尝试制作一个 minecraft 启动器并且你不了解 java、http 请求或 json，那么你就没有机会了。

迅速

# jenkins - 来自 jenkins api 的节点标签

> ID：14531919
> 
> 赞同：5
> 
> 时间：2013-01-25T23:24:32.717
> 
> 标签：jenkins

有什么方法可以从 jenkins API 中提取节点标签？[标准](https://wiki.jenkins-ci.org/display/JENKINS/Remote+access+API "标准")：_

```
{base_url}/computer/{node}/api 
```

似乎没有任何标签信息。是在别的地方吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-25T23:32:30.310

显然，节点标签是节点配置的一部分，因此它们存在于

```
{base_url}/computer/{node_str}/config.xml 
```

这是我通过python jenkinsapi（类似于作业配置）访问它的技巧，来自`node_str`

```
import xml.etree.ElementTree as ET
from jenkinsapi.jenkins import Jenkins

j = Jenkins(...)
n = j.get_node(node_str)
response = n.jenkins.requester.get_and_confirm_status( "%(baseurl)s/config.xml" % n.__dict__)
_element_tree = ET.fromstring(response.text)
node_labels = _element_tree.find('label').text 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-19T06:40:13.147

[ruby 客户端](https://github.com/arangamani/jenkins_api_client)提供了一种通过调用获取配置 XML 文件的方法。然后可以处理该文件以提取标签信息。

```
require "rubygems"
require "jenkins_api_client"

# Initialize the client by passing in the server information
# and credentials to communicate with the server
client = JenkinsApi::Client.new(
  :server_ip => "127.0.0.1",
  :username => "awesomeuser",
  :password => "awesomepassword"
)

# Obtain the XML of the desired node
xml = client.node.get_config("nodename")

# Extract label information
xml =~ /<label>(.*)<\/label)/

# As we can have multiple space-separated labels, we need to split them
labels = []
$1.split(" ").each { |label| labels << label } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-05-06T22:56:53.540

如果您不介意使用 BeautifulSoup 和 urllib2，您可以这样做来创建一个由节点名称键入的标签列表字典。诚然，脆弱和骇人听闻，但与 Jenkins 版本一起工作。1.512

```
JENKINS_URL = "http://jenkins.mycompany.com"

from jenkinsapi import jenkins
from BeautifulSoup import BeautifulSoup
from urllib2 import urlopen

node_labels = dict()
jenkins_obj = jenkins.Jenkins(JENKINS_URL)
node_names = jenkins_obj.get_node_dict().keys()
for node_name in node_names:
    if node_name is not "master":
        req = urlopen('{}/computer/{}/'.format(JENKINS_URL,node_name))
        soup = BeautifulSoup(req.read())
        node_labels[node_name] = [tag.text for tag in soup.findAll("a", {"class":"tag0 model-link"})] 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2020-01-17T09:38:48.117

这里的 Python 解决方案通常似乎不再起作用（`jenkinsapi`我可以在 PyPI 上找到的没有一些预期的方法），无论如何，它需要我无法轻易获得的身份验证令牌。

[https://jenkins.internal/computer/api/json?pretty=true](https://jenkins.internal/computer/api/json?pretty=true)会给我一个所有节点的列表以及每个节点的`assignedLabel`结构。这对我来说已经足够了（我只需要一份我们使用的标签的清单——如果它们也有描述就好了，但唉，大多数都没有）。

```
jq -r '.computer[].assignedLabels[].name' jenkins-labels.json | sort -u 
```

以纯文本形式获取标签列表。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-07-03T06:13:32.760

我认为这可以：http://{JENKINS_URL}/label/{LABEL_NAME}/api/json?pretty=true

# java - 从 Jar 文件中提取内容

> ID：14531922
> 
> 赞同：0
> 
> 时间：2013-01-25T23:24:48.117
> 
> 标签：java

我正在寻找一种从 jar 文件中提取数据的方法。我需要的是有关某个类文件的信息，包括： - 构造函数名称 - 公共方法（getter、setter 和操作。） - 如果包含 javadoc

例如，在 Eclipse 中，当您键入变量并按下“.”时 在它后面，它给出了一个完整的方法列表，所以我猜应该有一种方法可以找到这些数据。（我只需要方法的名称，而不是实际的代码。）

一些实际代码、伪代码、指令或其他任何东西都值得赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T23:32:17.653

使用 ZipFile 将 jar 提取为简单的 zip，如本页所示： [http ://www.java-examples.com/extract-zip-file-subdirectories-using-command-line-argument-example](http://www.java-examples.com/extract-zip-file-subdirectories-using-command-line-argument-example)

然后，对于找到的每个 .class 文件，使用 ClassParser：[http ://commons.apache.org/bcel/apidocs/org/apache/bcel/classfile/ClassParser.html](http://commons.apache.org/bcel/apidocs/org/apache/bcel/classfile/ClassParser.html)

**更快的方法：**

同样使用 ClassParser 的构造函数[ClassParser(String zipFile, String fileName)](http://commons.apache.org/bcel/apidocs/org/apache/bcel/classfile/ClassParser.html#ClassParser%28java.lang.String,%20java.lang.String%29)你可以得到你想要的关于`fileName`类的所有信息`zipFile`

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-26T00:13:14.570

您可以使用 JD-GUI（反编译器）查看 jar 文件中的类型。或者您可以像使用 zip 文件一样提取 jar 文件。然后可以使用 javap 查看类的成员。

# c++ - Qt5 -static x64 和链接噩梦

> ID：14531924
> 
> 赞同：2
> 
> 时间：2013-01-25T23:24:51.977
> 
> 标签：c++, windows, visual-studio-2010, qt, qt5

我正在尝试使用 -static 选项在 Windows 7 64 位下编译 Qt5 64 位。

这是我所做的：

1) 下载 Qt 源并将它们解压缩到 C:\Qt5\5.0src 目录 2) 按照此处的所有步骤[http://www.geometrian.com/programming/tutorials/setup_Qt.txt](http://www.geometrian.com/programming/tutorials/setup_Qt.txt)设置环境变量和.conf 文件静态构建 3) 启动配置

```
configure -debug-and-release -opensource -confirm-license -platform win32-msvc2010 -nomake tests -nomake examples -opengl desktop 
```

需要 opengl 桌面参数，因为 -no-opengl 有一个错误，我无法编译角度。

终于启动了 jom.exe -j5 /p

我得到了这个我不知道如何解决的错误

```
moc_qwindowsinputcontext.cpp
        lib /NOLOGO  /OUT:..\..\..\..\plugins\platforms\qwindows.lib @C:\Users\Mark\AppData\Local\Temp\qwindows.lib.3796.29562.jom
        cd qtsvg\ && ( if not exist Makefile C:\Qt\5.0src\qtbase\bin\qmake C:\Qt\5.0src\qtsvg\qtsvg.pro -o Makefile ) && C:\Qt\5.0src\j
om.exe -f Makefile
        cd src\ && ( if not exist Makefile C:\Qt\5.0src\qtbase\bin\qmake C:\Qt\5.0src\qtsvg\src\src.pro -o Makefile ) && C:\Qt\5.0src\j
om.exe -f Makefile
        cd svg\ && ( if not exist Makefile C:\Qt\5.0src\qtbase\bin\qmake C:\Qt\5.0src\qtsvg\src\svg\svg.pro -o Makefile ) && C:\Qt\5.0s
rc\jom.exe -f Makefile
        C:\Qt\5.0src\jom.exe -f Makefile.Debug all
Error: dependent 'C:\Qt\5.0src\qtbase\lib\Qt5Widgetsd.lib' does not exist.
jom: C:\Qt\5.0src\qtsvg\src\svg\Makefile [debug-all] Error 2
jom: C:\Qt\5.0src\qtsvg\src\Makefile [sub-svg-make_first-ordered] Error 2
jom: C:\Qt\5.0src\qtsvg\Makefile [sub-src-make_first] Error 2
jom: C:\Qt\5.0src\Makefile [module-qtsvg-make_first] Error 2 
```

似乎“Qt5Widgetsd.lib”不存在......这是为什么呢？为什么还没有建成？

帮助将不胜感激

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-27T16:35:23.683

我无法解决它，但我发现 -no-opengl 与 Qt5 有问题，所以我切换到 Qt4 并解决了我的问题

# python - 用于音乐视频的 Plex 插件 - Python

> ID：14531925
> 
> 赞同：1
> 
> 时间：2013-01-25T23:24:52.473
> 
> 标签：python, video, plugins, metadata

我正在尝试为 Plex 编辑 LastFM 音乐插件，以使其与音乐视频一起使用。我几乎在那里，有很多谷歌搜索和一些问题，但我坚持艺术家似乎聚集在一起的事实。

我的视频采用“艺术家 - Title.ext”格式，我已将其设置为元数据标题，但它似乎仍然分组。

即使我在将视频分组后拆分为 Plex，它们都具有第一个视频的名称。

我不确定这是否是正确的地方，但这里是代码。如果有人可以提供帮助，将不胜感激。

```
 import lastfm, re, time, os, urllib

GOOGLE_JSON = 'http://ajax.googleapis.com/ajax/services/search/web?v=1.0&userip=%s&rsz=large&q=%s+site:last.fm+inurl:music'

def Start():
  HTTP.CacheTime = CACHE_1WEEK

def GetPublicIP():
  return HTTP.Request('http://plexapp.com/ip.php').content.strip()

def GetGoogleArtist(artist):
  try:
    url = GOOGLE_JSON % (GetPublicIP(), String.Quote(artist.encode('utf-8'), usePlus=True))
    jsonObj = JSON.ObjectFromURL(url, headers={'Referer' : 'http://www.plexapp.com'}, sleep=0.5)
    if jsonObj['responseData'] != None:
      jsonObj = jsonObj['responseData']['results']
      if len(jsonObj) > 0:
        result = jsonObj[0]
        url = result['unescapedUrl'].replace('+','%20')
        return re.findall('/music/([^/]+)', url)[0]
  except:
    pass

  return None

def CallWithRetries(fun, *args):
  tries = 10
  while tries > 0:
    try:
      return fun(*args)
    except:
      tries = tries - 1
      if tries > 0:
        Log('Call failed, retrying')
        time.sleep(2)
      else:
        raise

class LastFmAgent(Agent.Movies, Agent.Artist):
  name = 'Music Video'
  languages = [Locale.Language.English, Locale.Language.Korean]

  def safe_strip(self, ss):
    """
      This method strips the diacritic marks from a string, but if it's too extreme (i.e. would remove everything,
      as is the case with some foreign text), then don't perform the strip.
    """
    s = String.StripDiacritics(ss)
    if len(s.strip()) == 0:
      return ss
    return s

  def search(self, results, media, lang):

    path = media.filename
    path = urllib.unquote(path)
    filename = os.path.splitext(os.path.basename(path))[0]
    Log(filename)
    artist = filename.split(' - ')[0]
    artist = artist.lower()
    Log(artist)

    Log("Search for artist")
    CallWithRetries(self.findArtists, lang, results, media, artist)

    Log("If the artist starts with 'The', try stripping.")
    if artist.startswith('the '):
      try: CallWithRetries(self.findArtists, lang, results, media, artist[4:])
      except: pass

    Log("If the artist has an '&', try with 'and'.")
    if artist.find(' & ') != -1:
      try: CallWithRetries(self.findArtists, lang, results, media, artist.replace(' & ', ' and '))
      except: pass

    Log("If the artist has an 'and', try with '&'.")
    if artist.find(' and ') != -1:
      try: CallWithRetries(self.findArtists, lang, results, media, artist.replace(' and ', ' & '))
      except: pass

    try: highest_score = max([x.score for x in results])
    except: highest_score = 0

    if len(results) == 0 or highest_score < 85:
      artist_id = GetGoogleArtist(artist)
      google_artist = CallWithRetries(lastfm.ArtistInfo, artist_id)
      if google_artist:
        (url, name, image, listeners) = google_artist
        Log("Google said 'you should try %s' (ID: %s)." % (name, artist_id))
        if listeners > 250:
          results.Append(MetadataSearchResult(id=artist_id, name=name, thumb=image, lang=lang, score = 100-Util.LevenshteinDistance(name.lower(), artist.lower())))

    Log("Finally, de-dupe the results.")
    toWhack = []
    resultMap = {}
    for result in results:
      if not resultMap.has_key(result.id):
        resultMap[result.id] = True
      else:
        toWhack.append(result)
    for dupe in toWhack:
      results.Remove(dupe)

  def findArtists(self, lang, results, media, artist):
    score = 90
    for r in lastfm.SearchArtists(artist,limit=5)[0]:
      id = r[0]
      Log(id)

      # Skip artists without many listeners, they're probanly wrong.
      if r[3] < 1000 and id.find('+noredirect') == -1:
        Log("Skipping %s with only %d listeners." % (r[1], r[3]))
        continue

      if id.find('+noredirect') == -1:
        id = r[1]
        dist = Util.LevenshteinDistance(r[1].lower(), artist.lower())
        albumBonus = self.bonusArtistMatchUsingAlbums(media, artistID=id, maxBonus=5)
        id = String.Quote(id.encode('utf-8'))
        Log('artist: ' + artist + ' albumBonus: ' + str(albumBonus))
        Log('Artist result: ' + r[1] + ' id: ' + id + ' score: ' + str(score) + ' thumb: ' + str(r[2]))
        results.Append(MetadataSearchResult(id = id.replace('%2B','%20'), name = r[1], thumb = r[2], lang  = lang, score = score + albumBonus - dist))
      else:
        # Get a correction.
        Log('Getting correction to artist.')
        correctArtists = lastfm.CorrectedArtists(artist)
        for result in correctArtists:
          id = String.Quote(result[0].encode('utf-8'))
          dist = Util.LevenshteinDistance(result[0].lower(), artist.lower())
          results.Append(MetadataSearchResult(id = id.replace('%2B','%20'), name = result[0], lang  = lang, score = score - dist + 5))

      score = score - 2

  def bonusArtistMatchUsingAlbums(self, media, artistID, maxBonus=5):
    Log('bonusArtistMatchUsingAlbums')
    lastFM_artistAlbums = []
    for album in lastfm.ArtistAlbums(artistID):
      (name, artist, thumb, url) = album
      lastFM_artistAlbums.append(name.lower())
    if len(lastFM_artistAlbums) == 0: return 0 #no last.fm albums for the artist, so abort!
    bonus = 0
    for a in media.children:
      album = a.title.lower()
      for lfa in lastFM_artistAlbums:
        score = Util.LevenshteinDistance(lfa, album)
        #Log(lfa, album, score)
        if score <= 2: #pretty solid match
          bonus += 1
          if bonus == maxBonus: break
      if bonus == 0 and album[-1:] == ')': #if we got nothing, let's try again without anything in paranthesis [e.g.'limited edition'] 
        album = album[:album.rfind('(')].strip()
        for lfa in lastFM_artistAlbums:
          score = Util.LevenshteinDistance(lfa, album)
          #Log(lfa, album, score)
          if score <= 2: #pretty solid match
            bonus += 1
            if bonus == maxBonus: break
    return bonus

  def update(self, metadata, media, lang):
    artist = CallWithRetries(XML.ElementFromURL, lastfm.ARTIST_INFO % String.Quote(String.Unquote(metadata.id), True))[0]
    summary = artist.xpath('//bio/content')[0]
    metadata.title = String.Unquote(artist.xpath('//artist/name')[0].text, True)
    Log(metadata.title)
    filename = media.items[0].parts[0].file.decode('utf-8')
    cleanname = os.path.splitext(os.path.basename(filename))[0]
    Log(cleanname)
    metadata.title = cleanname
    Log(metadata.title)
    Log("QWERTY")
    if summary.text:
      metadata.summary = decodeXml(re.sub(r'<[^<>]+>', '', summary.text))
    try:
      url = artist.xpath('//artist/image[@size="mega"]//text()')[0]
      if url not in metadata.posters:
        metadata.posters[url] = Proxy.Media(HTTP.Request(url))
    except:
      pass     
    metadata.genres.clear()
    for genre in artist.xpath('//artist/tags/tag/name'):
      metadata.genres.add(genre.text.capitalize())

def decodeXml(text):
  trans = [('&amp;','&'),('&quot;','"'),('&lt;','<'),('&gt;','>'),('&apos;','\''),('\n ','\n')]
  for src, dst in trans:
    text = text.replace(src, dst)
  return text 
```

# jquery - 点击后显示一个div

> ID：14531927
> 
> 赞同：0
> 
> 时间：2013-01-25T23:25:18.580
> 
> 标签：jquery, css

我对一个脚本有问题。我相信这很简单，不幸的是对我来说不是那么简单。我想要做的是显示一个 div （点击后出现）。当您单击“产品”时，它应该会发生。我到目前为止是这样的：

```
 <div id="header">

    <div id="headcont"> 

            <div id="main-menu">
                <a href="#" id="button-products">Products</a>
            </div>

            <div id="products-menu">
                <a href="#">Jackleg units</a>
                <a href="#">Antivandal units</a>
                <a href="#">Storage containers</a>
            </div>

    </div>
</div> 
```

和CSS：

```
 body{

    background-color:#666;

}

#header{
    position:absolute;
    top:0px;
    background-color: rgba(0, 0, 0, .9);
    width:100%;
    height:70px;
    border-bottom:1px #999 solid;
    padding:15px 0;
    z-index:200;
}

#headcont{
    overflow:hidden;
    width: 480px;
    margin: 0 auto;
}

#main-menu{
    margin-top:55px;
    float:right;
}

#main-menu a{
    display:block;
    width: auto;
    font-size:1.7em;
    float:left;
    margin: 0 10px;
    color:#eee;
}

#products-menu{
    overflow:hidden;
    background-color: rgba(255, 255, 255, .8);
    width:980px;
    display: none;
}

#products-menu a{
    display:block;
    width: auto;
    background-color:rgba(0, 0, 0, .6);
    padding: 5px;
    margin: 2px 5px 2px 0;
    text-decoration:none;
    font-size:1.7em;
    float:left;
    color:#eee;
} 
```

*   主要的事情 - jquery：

    ```
    $(function() {
        $('#button-products').on('click', function() {
            $('#products-menu').css("display:","block");
        });
    }); 
    ```

它有点长，所以我使用 jsfiddle 来帮助您理解我正在尝试做的事情：[JSFIDDLE](http://jsfiddle.net/tucado/7tbsR/3/)。非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T23:27:34.340

```
$("#products-submenu").click(function(){

    $("#products-menu").show(); //.fadeIn(600) //Nice Effect

}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T23:29:32.840

由于您设置的 CSS 属性末尾的冒号，您的代码不起作用：

```
$('#products-menu').css("display:","block");
// remove this -----------------^ 
```

删除它，它的工作原理：http: [//jsfiddle.net/7tbsR/4/](http://jsfiddle.net/7tbsR/4/)

（请注意，您的小提琴没有在左侧面板中选择 jQuery，因此这也无济于事。）

另请注意，jQuery 提供了一些方法来显示隐藏元素，包括普通方法[`.show()`](http://api.jquery.com/show/)和几种[动画方法](http://api.jquery.com/category/effects/)，这些方法可以将隐藏的项目淡入或滑动到视图中。（对于您的菜单[`.slideDown()`](http://api.jquery.com/slideDown/)效果很好：http: [//jsfiddle.net/7tbsR/7/](http://jsfiddle.net/7tbsR/7/)）

# matlab - 有没有办法在matlab中进行隐式微分

> ID：14531928
> 
> 赞同：3
> 
> 时间：2013-01-25T23:25:25.497
> 
> 标签：matlab

我经常使用 matlab 来帮助我解决数学问题。

现在我正在寻找一种在matlab中进行隐式微分的方法。例如，我想区分`y^3*sin(x)+cos(y)*exp(x)=0`.`dy/dx`

我知道如何通常使用数学方法来做到这一点，但我一直在努力寻找使用 matlab 的简单方法。当我需要正态微分（从 f(x) 中找到微分）时，我使用了符号数学工具箱并做了这样的事情：

```
syms x
y = myfunctionOf(x)
diff(y) 
```

我查看`doc diff`并在符号工具箱中进行了快速查找，但没有发现对上述案例有帮助。但我就是不相信matlab没有这么简单的功能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-12-02T15:57:57.243

这里有一些代码可以做你想做的事，所有的解释都在注释中，注意这个代码假设你希望 Matlab 为你做几乎所有的数学思考。

```
%// Firstly you need to define a function `f` in terms of `x` and `y`. 
syms x y;
f = y^3*sin(x)+cos(y)*exp(x);

%// Then you need to tell Matlab that y is a function of x,
%// you do this by replacing y with y(x)
yOfx = sym('y(x)');
f_yOfx = subs(f, y, yOfx);

%// Then you need to differentiate with respect to x
df = diff(f_yOfx, x);

%// df will have diff(y(x), x) terms in it, 
%// we want to solve for this term, 
%// to make it easier we should first replace it with a variable
%// and then solve
syms Dy;
df2 = subs(df, diff(yOfx, x), Dy);
dyOver_dx = solve(df2, Dy);

%// Finally if we do not want all of the y(x) terms, 
%// then replace them with y
dyOver_dx = subs(dyOver_dx, yOfx, y) 
```

当然，如果我们不介意做一些文书工作，我们可以从中`dy/dx = -(partial f/partail x)/(partial f/partial y)`得到更短的代码

```
%// Implicit differentiation identity
also_dyOver_dx = -diff(f, x)/diff(f, y); 
```

这是检查两个答案是否相同。

```
simplify(dyOver_dx - also_dyOver_dx) %// == 0 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-02-16T07:30:42.947

最好的方法永远是最简单的！

```
syms x y(x)
f = y^3*sin(x)+cos(y)*exp(x);
diff(f,x) 
```

您也可以包含漂亮的命令以获得更好的可视化！

```
pretty(ans)  %"Pretty print" output 
```

此外，还有另一种方式：

```
syms x y f
f = y^3*sin(x)+cos(y)*exp(x);
-diff( f, x )/diff( f, y )
pretty(ans)  %"Pretty print" output 
```

好好享受！

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-26T00:54:39.250

您可以尝试使用：

```
diff(expr, sym('v')) //This differenciates the expression respect to v 
```

# asp.net-mvc - 方法“Bundle.Include”（在与 ASP.NET MVC 一起使用的 System.Web.Optimization 中）是否可以抛出异常而不是静默忽略丢失的文件？

> ID：14531934
> 
> 赞同：19
> 
> 时间：2013-01-25T23:26:05.507
> 
> 标签：asp.net-mvc, bundle

如果缺少 javascript 或 css 文件，是否有可能引发异常？

我已经尝试过使用下面的代码，但它永远不会引发异常......

```
 public class BundleConfig {
    public static void RegisterBundles(BundleCollection bundles) {  
        ....

        bundles.Add(new ScriptBundle("~/bundles/something").Include("~/Scripts/nonExistingFile.js"));
        // I would like the above usage of Include method with 
        // a non-existing file  to throw an exception to make it 
        // obvious that an expected file is missing ...
        // but since it does not I tried to implement a method as below ...
        ...
        AssertThatAllFilesExist(bundles);
        // but unfortunately an exception is never thrown but when 
        // iterating the files in the method below, 
        // the non-existing file seems to never become retrieved ...
    }   

    private static void AssertThatAllFilesExist(BundleCollection bundles) {
        HttpContext currentHttpContext = HttpContext.Current;
        var httpContext = new HttpContextWrapper(currentHttpContext);
        foreach (var bundle in bundles) {
            var bundleContext = new BundleContext(httpContext, bundles, bundle.Path);
            IEnumerable<FileInfo> files = bundle.EnumerateFiles(bundleContext);
            foreach (var file in files) {
                if (!file.Exists) {
                    // if this problem would occur then it should 
                    // indicate that one of the arguments of the 
                    // method "Bundle.Include" does not 
                    // correspond to an existing file ...
                    throw new ArgumentException("The following file does not exist: " + file.FullName);
                }
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-07-17T19:45:34.897

我使用这个类而不是`ScriptBundle`：

```
public class ScriptBundleWithException : ScriptBundle
{
    public ScriptBundleWithException( string virtualPath ) : base( virtualPath ) {}
    public ScriptBundleWithException( string virtualPath, string cdnPath ) : base( virtualPath, cdnPath ) {}

    public override Bundle Include( params string[] virtualPaths )
    {
        foreach ( var virtualPath in virtualPaths ) {
            Include( virtualPath );
        }
        return this;
    }

    public override Bundle Include( string virtualPath, params IItemTransform[] transforms )
    {
        var realPath = System.Web.Hosting.HostingEnvironment.MapPath( virtualPath );
        if ( !File.Exists( realPath ) ) {
            throw new FileNotFoundException( "Virtual path not found: " + virtualPath );
        }
        return base.Include( virtualPath, transforms );
    }
} 
```

然后在配置中：

```
bundles.Add( new ScriptBundleWithException( "~/bundles/something" ) //... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-11-22T09:14:33.890

如果您查看 Bundle 类的源代码，您会发现 .Include 只是默默地不添加文件，如果它不存在。因此，您的断言不起作用。

我最终使用了一组脚本文件名并在添加到捆绑包之前手动检查它们。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-02-18T02:01:32.297

我遇到了这个，并认为我会提交我的解决方案。正如其他人提到的那样，将不存在的文件添加到捆绑包中会被忽略。

示例代码：

```
string[] jsFiles = { "~/js/file1.js", "~/js/file2.js" };
string[] cssFiles = { "~/css/file1.css", "~/css/file2.css" };
List<string> allFiles = new List<string>();
allFiles.AddRange(jsFiles);
allFiles.AddRange(cssFiles);
var server = HttpContext.Current.Server;
foreach(var file in allFiles) {
    if(!File.Exists(server.MapPath(file))
        throw new FileNotFoundException("File " + file + " was not found.");
} 
```

然后将您的捆绑包定义为正常，使用数组`.Include`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-09-11T10:13:05.697

请在此处查看我的答案：[Asp.Net MVC Bundling, best way to detect missing file](https://stackoverflow.com/questions/23802800/asp-net-mvc-bundling-best-way-to-detect-missing-file/25784663#25784663)。它支持 ASP.NET 在路径中的通配符。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-26T00:00:42.043

我使用[T4MVC](http://t4mvc.codeplex.com/)：

```
var bundleJsLayout = new ScriptBundle("~/bundle/js").Include(
    "~" + Links.Scripts.jquery_1_9_0_js,
    "~" + Links.Scripts.modernizr_2_6_2_js,
    "~" + Links.Scripts.jquery_unobtrusive_ajax_min_js
    );

bundleJsLayout.Transforms.Add(new JsMinify());
bundles.Add(bundleJsLayout); 
```

# magento - Magento 1.5 中的自定义模块在浏览网格时挂起

> ID：14531937
> 
> 赞同：0
> 
> 时间：2013-01-25T23:26:12.843
> 
> 标签：magento, magento-1.5

我已经安装了 Magento 1.5 并且正在编写本教程[http://www.magentocommerce.com/wiki/5_-_modules_and_development/0__-_module_development_in_magento/custom_module_with_custom_database_table](http://www.magentocommerce.com/wiki/5_-_modules_and_development/0_-_module_development_in_magento/custom_module_with_custom_database_table)

在后端和前端工作后，我开始添加属于自定义模块的自定义对象。对象添加得很好。可以很好地编辑、保存和删除对象。但是，当尝试搜索或浏览超出第一页时，请等待加载程序出现在屏幕上并挂起。在加载器后面可以看到下一页/搜索结果页面正在加载对象并正确显示它们，但是加载器不会关闭并且它使页面无法访问。Firebug 的控制台没有报告任何错误，当我在控制台中检查发布信息时，它显示了正在返回的表、行和对象的正确 html。

我已经检查了服务器的错误日志以及 magento 的错误日志，并且没有显示任何错误（除了让教程首先工作的过去错误之外）。

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-25T11:53:52.257

我遇到了同样的问题，现在已经解决了。

步骤1。将以下代码添加到 Grid.php

```
 /**
     * Define row click callback
     */
    public function getGridUrl()
    {
        return $this->getUrl('*/*/grid', array('_current'=>true));
    } 
```

第2步。将以下代码添加到 yourController.php（即 adminhtml 控制器）

```
 /**
     * Render grid
     */
    public function gridAction()
    {
        $this->loadLayout();
        $this->renderLayout();
    } 
```

第2步。将以下代码添加到 layout.xml（即 adminhtml 布局）

```
 <adminhtml_yourContoller_grid>
        <remove name="root"/>
        <block type="yourModule/adminhtml_yourBlock_grid" name="name_grid" output="toHtml"/>
    </adminhtml_yourContoller_grid> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T17:37:10.757

删除 __construct 中的 useAjax 并从 Grid.php 中删除 getGridUrl 函数。从管理控制器中删除 gridAction 以停止该 ajax 调用。

# google-maps - 谷歌地图 API v3 MarkerCluster 不执行集群

> ID：14531944
> 
> 赞同：1
> 
> 时间：2013-01-25T23:26:46.077
> 
> 标签：google-maps

我正在使用 Google Map v3 API 为项目的自定义网站编写自定义地图。

目前我有一堆标记分散在周围，因为其中有超过 100 个，我希望将它们放在 MarkerCluster 中，但是在查看许多教程和已经提出的问题时，我现在已经设法让自己明白了我的所有标记都消失了，或者只显示了 1 个，而缩放其他标记时则不会出现。

这是我第一次使用 Google API，所以一切对我来说都是新的，任何帮助都非常感谢！

```
 <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?key=AIzaSyDINxXHHp6_arevhHdyZZ5W3ty0mEWjzd4&sensor=true">
    </script>
    <script type="text/javascript" src="http://google-maps-utility-library-v3.googlecode.com/svn/trunk/markerclusterer/src/markerclusterer.js"></script>
    <script type="text/javascript">
    //declare map and map type (zoom level and where to centre the map on loading)
function initialize() {
  var mapOptions = {
    zoom: 17,
    panControl: true,
    zoomControl: true,
    mapTypeControl: true,
    scaleControl: true,
    streetViewControl: true,
    overviewMapControl: true,
    draggable: true,
    center: new google.maps.LatLng(53.403938,-2.987954),
    mapTypeId: google.maps.MapTypeId.HYBRID
  }

  var map = new google.maps.Map(document.getElementById("map_canvas"),
                                mapOptions);

   var mcOptions = {gridSize: 50, maxZoom: 25};
  setMarkers(map, wifimaplocation);

}

var wifimaplocation = [
  ['BT Openzone Business Hub', 53.410133,-2.980967, 4],
  ['BT Openzone Business Hub 2', 53.410581,-2.98513, 5],
  ['BT Openzone Business Hub 3', 53.410341,-2.986254, 3],
  ['Wireless Outdoor Coverage (L1 6ER)', 53.408816,-2.983669, 2],
  ['Yates Bros Wine Lodge', 53.407319,-2.98397, 1],
  ['BT Openzone Business Hub 4', 53.408373,-2.982217, 6],
  ['BT Openzone Business Hub 5', 53.408926,-2.983751, 7],
  ['Liverpool Marriot Hotel',53.408926,-2.983751, 8],
  ['Wireless Outdoor Coverage (L1 1 St Johns Lane', 53.408563,-2.982344, 9],
  ['Wireless Outdoor Coverage (L1 1 Roe St)', 53.407407,-2.981337, 10],
  ['BT Openzone Business Hub 6', 53.40701,-2.981944, 11],
  ['McDonald&#39s St Johns Precinct', 53.407121,-2.980573, 12],
  ['BT Openzone Business Hub 7', 53.406705,-2.980839, 13],
  ['BT Openzone Business Hub 8', 53.406859,-2.980066, 14],
  ['Network Rail - Liverpool Lime Street', 53.408688,-2.9788, 15],
  ['Wetherspoons', 53.405942,-2.979522, 16],
  ['Crown', 53.406484,-2.978754, 17],
  ['BT Openzone Business Hub 9', 53.406574,-2.978513, 18],
  ['BT Openzone Business Hub 10', 53.406574,-2.978513, 19],
  ['BT Openzone Business Hub 11', 53.406488,-2.978749, 20],
  ['Wireless Outdoor Coverage (L3 5 Bolton St)', 53.405898,-2.97773, 21],
  ['BT Openzone Business Hub 12', 53.408026,-2.977398, 22],
  ['Wireless Outdoor Coverage (Skelhorne St)', 53.416157,-2.988889, 23],
  ['McDonald&#39s (Ranelagh Street)', 53.404594,-2.977877, 24],
  ['Wireless Outdoor Coverage (Renshaw St)', 53.404639,-2.977296, 25],
  ['Wetherspoons', 53.405183,-2.980989, 26],
  ['BT Openzone Business Hub 13', 53.405339,-2.979956, 27],
  ['BT Openzone Business Hub 14', 53.404869,-2.97993, 28],
  ['BT Openzone Business Hub 15', 53.403862,-2.979275, 29],
  ['Brew Tea Bar', 53.403862,-2.979275, 30],
  ['Starbucks Coffee', 53.404054,-2.980643, 31],
  ['BT Openzone Business Hub 16', 53.404054,-2.980643, 32],
  ['Office (Holmes Building Wood Street)', 53.404223,-2.981673, 33],
  ['BT Openzone Business Hub 17', 53.403512,-2.980543, 34],
  ['Djandos-Riff', 53.403512,-2.980543, 35],
  ['Bar Liverpool Ltd', 53.403512,-2.980543, 36],
  ['O Neills', 53.404174,-2.981809, 37],
  ['BT Openzone Business Hub 18', 53.405538,-2.98094, 38],
  ['Currys/PC World', 53.404789,-2.982451, 39],
  ['BT Pay Phone (Church Street)', 53.405506,-2.982687, 40],
  ['BT Openzone Business Hub 19', 53.406759,-2.98384, 41],
  ['BT Openzone Business Hub 20', 53.406686,-2.984221, 42],
  ['BT Openzone Business Hub 21', 53.406775,-2.98454, 43],
  ['Cafe Nero', 53.407034,-2.98483, 44],
  ['Ice', 53.406795,-2.98491, 45],
  ['BT Openzone Business Hub 22', 53.406142,-2.984355, 46],
  ['WiFi Pod Office', 53.402954,-2.984422, 47],
  ['BT Openzone Business Hub 23', 53.403424,-2.984184, 48],
  ['BT Openzone Business Hub 24', 53.404203,-2.984097, 49],
  ['BT Openzone Business Hub 25', 53.404697,-2.985109, 50],
  ['BT Openzone Business Hub 26', 53.403798,-2.985541, 51],
  ['BT Openzone Business Hub 27',53.406863,-2.98583, 52],
  ['McDonalds', 53.405218,-2.986485, 53],
  ['WELKIN (Wetherspoons)', 53.405998,-2.985895, 54],
  ['BT Openzone Business Hub 28', 53.405237,-2.98648, 55],
  ['BT Openzone Business Hub 29', 53.405741,-2.986495, 56],
  ['1Pco Lord Street Liverpool', 53.405183,-2.98649, 57],
  ['BT Openzone Business Hub 30', 53.405132,-2.987064, 58],
  ['BT Openzone Business Hub 31', 53.403868,-2.987311, 59],
  ['BT Openzone Business Hub 32', 53.403894,-2.98648, 60],
  ['Liverpool Moat House', 53.401345,-2.985981, 61],
  ['Wireless Outdoor Coverage (Paradise Street)', 53.401345,-2.985981, 62],
  ['Starbucks 2', 53.402583,-2.986039, 63],
  ['John Lewis', 53.402963,-2.986796, 64],
  ['BT Openzone Business Hub 33', 53.402986,-2.98442, 65],
  ['Cafe Nero', 53.404462,-2.984958, 66],
  ['BT Openzone Business Hub 34', 53.406296,-2.99516, 67],
  ['BT Openzone Business Hub 35', 53.404654,-2.991283, 68],
  ['Wireless Outdoor Coverage (James Street)', 53.404654,-2.991283, 69],
  ['BT Openzone Business Hub 36', 53.405285,-2.99319, 70],
  ['BT Openzone Business Hub 37', 53.405608,-2.99139, 71],
  ['BT Openzone Business Hub 38', 53.405682,-2.991801, 72],
  ['Brunswick Street', 53.40619,-2.992869, 73],
  ['Wireless Outdoor Coverage (Brunswick Street)', 53.40619,-2.992869, 74],
  ['Heywood House Hotel', 53.406695,-2.988615, 75],
  ['BT Openzone Business Hub 39', 53.406657,-2.990288, 76],
  ['BT Openzone Business Hub 40', 53.408013,-2.988277, 77],
  ['BT Openzone Business Hub 41', 53.408262,-2.98766, 78],
  ['Premier Inn - Liverpool City Centre', 53.409174,-2.988051, 79],
  ['BT Openzone Business Hub 42', 53.409295,-2.987504, 80],
  ['BT Openzone Business Hub 43', 53.409577,-2.988051, 81],
  ['BT Openzone Business Hub 44', 53.409922,-2.987174, 82],
  ['Liverpool - Hatton Garden / Tithebarn Street', 53.410632,-2.987276, 83],
  ['BT Openzone Business Hub 45', 53.410302,-2.98627, 84],
  ['Wireless Outdoor Coverage - Liverpool (Hatton Garden)', 53.410302,-2.98627, 85],
  ['BT Openzone Business Hub 46', 53.410993,-2.986823, 86],
  ['BT Openzone Business Hub 47', 53.410542,-2.985216, 87],
  ['Brunswick Vaults', 53.410376,-2.989443, 88],
  ['BT Openzone Business Hub 48', 53.410168,-2.98884, 89],
  ['BT Openzone Business Hub 49', 53.410389,-2.989615, 90],
  ['BT Openzone Business Hub 50', 53.408943,-2.990245, 91],
  ['Railway', 53.408969,-2.990422, 92],
  ['BT Openzone Business Hub 51', 53.408787,-2.991678, 93],
  ['BT Openzone Business Hub 52', 53.408774,-2.994178, 94],
  ['BT Openzone Business Hub 53', 53.405682,-2.978199, 95],
  ['Brew Tea Bar', 53.410159,-2.993776, 96],
  ['BT Openzone Business Hub 54', 53.410159,-2.993776, 97],
  ['Cross Keys Public House', 53.409916,-2.993743, 98],
  ['BT Openzone Business Hub 55', 53.404812,-2.977298, 99],
  ['BT Openzone Business Hub 56', 53.404313,-2.976676, 100],
  ['BT Openzone Business Hub 57', 53.404697,-2.976611, 101],
  ['stayCity Liverpool Mount Pleasant', 53.405183,-2.976314, 102],
  ['BT Openzone Business Hub 58', 53.405132,-2.976547, 103],
  ['BT Openzone Business Hub 59', 53.404275,-2.973522, 104],
  ['BT Openzone Business Hub 60', 53.404646,-2.972556, 105],
  ['BT Openzone Business Hub 61', 53.404518,-2.972341, 106],
  ['BT Openzone Business Hub 62', 53.404607,-2.971161, 107],
  ['Wireless Outdoor Coverage (Brownlow Hill)', 53.403878,-2.97129, 108],
  ['BT Openzone Business Hub 63', 53.40526,-2.967471, 109],
  ['Starbucks', 53.41154,-2.965196, 110],
  ['BT Openzone Business Hub 64', 53.410888,-2.967041, 111],
  ['Liverpool - London Road', 53.409455,-2.97659, 112],
  ['BT Openzone Business Hub 65', 53.41012,-2.969573, 113],
  ['Wireless Outdoor Coverage (Pembroke Place)', 53.409238,-2.971505, 114]

];

function setMarkers(map, locations) {
  // Add markers to the map

  // Marker sizes are expressed as a Size of X,Y
  // where the origin of the image (0,0) is located
  // in the top left of the image.

  // Origins, anchor positions and coordinates of the marker
  // increase in the X direction to the right and in
  // the Y direction down.
  var infowindow = new google.maps.InfoWindow();
   var image = new google.maps.MarkerImage('image.png',
  //     // This marker is 20 pixels wide by 32 pixels tall.
       new google.maps.Size(40, 35),
  //     // The origin for this image is 0,0.
      new google.maps.Point(0,0),
  //     // The anchor for this image is the base of the flagpole at 0,32.
       new google.maps.Point(0, 0));
   var shadow = new google.maps.MarkerImage('shadow.png',
  //     // The shadow image is larger in the horizontal dimension
  //     // while the position and offset are the same as for the main image.
       new google.maps.Size(62, 35),
       new google.maps.Point(0,0),
       new google.maps.Point(0, 0));
  //     // Shapes define the clickable region of the icon.
  //     // The type defines an HTML <area> element 'poly' which
  //     // traces out a polygon as a series of X,Y points. The final
  //     // coordinate closes the poly by connecting to the first
  //     // coordinate.
  var shape = {
      coord: [1, 1, 1, 20, 18, 20, 18 , 1],
      type: 'poly'
  };

  for (var i = 0; i < wifimaplocation.length; i++) {
    var wifi = wifimaplocation[i];
    var myLatLng = new google.maps.LatLng(wifi[1], wifi[2], wifi[3]);
    var marker = new google.maps.Marker({
        position: myLatLng,
        map: map,
        shadow: shadow,
        icon: image,
        shape: shape,
        title: wifi[0],
        zIndex: wifi[3]

    });

    markers.push(wifimaplocation);

   var mc = new MarkerCluster(map, mcOptions, wifimaplocation);

    google.maps.event.addListener(marker, 'click', (function(marker, i) {
      return function() {
        infowindow.setContent(wifimaplocation[i][0]);
        infowindow.open(map, marker);
      }
    })(marker, i));

}
  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T13:49:59.803

您将错误的参数传递给 MarkerClusterer 构造函数并且拼错了 MarkerClusterer（注意额外的“er”）。需要是这样的：

```
var mc = new MarkerClusterer(map,markers,mcOptions); 
```

此外，如果要将映射值传递给集群器，请不要在新的 Marker 构造函数中分配它。

[工作小提琴](https://stackoverflow.com/questions/23919606/google-maps-markerclusters-not-working-for-some-locations)

您需要将*[google.maps.Marker](https://developers.google.com/maps/documentation/javascript/reference#Marker)*对象推送到标记数组中。

# c - 链表事物警告：来自不兼容指针类型的赋值

> ID：14531955
> 
> 赞同：3
> 
> 时间：2013-01-25T23:28:14.797
> 
> 标签：c, incomplete-type

我有一个链表类型的结构，其骨架代码如下所示。但是，当我编译代码时，我得到“警告：来自不兼容指针类型的赋值”操作 temp = temp-> next。我只是想知道为什么以及是否应该担心。提前致谢！

```
typedef struct data {
    size_t size;
    struct data_t* next;
} data_t;

void* dmalloc(size_t numbytes) {
    while(temp!=NULL){
        if(temp->size>=numbytes) {
            //do something
        }
    temp = temp->next; //problem line
    }
return NULL;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T23:31:53.410

您不能在 typedef 创建之前使用它。将您的结构更改为：

```
typedef struct data {
    size_t size;
    struct data* next;
} data_t; 
```

# javascript - Ember.js v2 路由器中的多个插座

> ID：14531956
> 
> 赞同：4
> 
> 时间：2013-01-25T23:28:19.370
> 
> 标签：javascript, ember.js

我刚刚开始使用 Ember.js，似乎很有希望的一件事是多个插座将多个模板混合在一起以产生复杂但模块化的布局的想法。

不过，我无法让它工作。几个月前（2012 年年中）似乎有很多问题、答案和示例，但在 3 月到 1.0 时，他们最近（2012 年 12 月/2013 年 1 月）将路由器重写为“v2”API。这些文档擅长他们所描述的内容，但省略了很多大背景，而且我还没有找到一个端到端的例子。

这是我读过的：

*   [路由指南](http://emberjs.com/guides/routing/)下的所有内容（最新，但并不详尽）
*   [“出口”模板助手 api 参考](http://emberjs.com/api/classes/Ember.Handlebars.helpers.html#method_outlet)（这可能已经过时了？我每次尝试调用都`controller.connectOutlet()`失败了`Uncaught TypeError: Object <(generated animals.cats controller):ember170> has no method 'connectOutlet'`.
*   [Ember.js 路由器 API v2](https://gist.github.com/3981133)的公告。特别是底部的一对评论（多个网点的问答）。是的，这个要点被标记为“警告；过时；有关最新信息，请参阅路由指南”。但是当前的路由指南似乎并没有完全描述这种行为。指南的[渲染模板](http://emberjs.com/guides/routing/rendering-a-template/)部分展示了如何渲染到已经存在的不同插座（我可以让它工作），但我不知道如何连接额外的插座或实例化额外的模板。

什么对我有用：

*   设置嵌套路由（嗯，嵌套资源；你不能嵌套路由；但你可以为嵌套资源自定义路由），以及嵌套模板和根据路由自动实例化的出口。

我无法弄清楚如何完成：

*   手动实例化模板并将它们连接到插座。如果您想使用多个出口，或者如果您想要构建与您的路线不同的出口/模板关系，这似乎是必要的。（下面会有一个例子。基本上我想要做的是使用模板作为混合，我可以将它嵌入到任何我想要的地方。）

对我来说似乎很有希望但失败的事情是

*   覆盖路由的控制器（使用扩展路由`App.WhateverRoute = Ember.Route.extend()`，提供我自己的`setupController`方法）并`controller.connectOutlet`在此处调用。如上所述，这失败了；传递给此方法的控制器对象没有`connectOutlet`方法。

示例（[此处为 jsFiddle](http://jsfiddle.net/metamatt/CP5QU/1/)，或以下为自包含 html 文档，其中嵌入了 CSS 和脚本并从 https 链接加载 Ember 和依赖项，因此您应该能够保存到本地文件并在浏览器中打开如果您想试试）：

```
<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Ember.js Router Example</title>
    <style>
      .outlet {
        border: 1px solid black;
        padding: 5px;
      }
    </style>
  </head>

  <body>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
    <script src="https://raw.github.com/wycats/handlebars.js/1.0.rc.2/dist/handlebars.js"></script>
    <script src="https://raw.github.com/emberjs/ember.js/release-builds/ember-1.0.0-pre.4.js"></script>

    <script type="text/x-handlebars" data-template-name="index">
      <p>Root index template. You should not see this because we redirect App.IndexRoute elsewhere.</p>
    </script>

    <script type="text/x-handlebars" data-template-name="about">
      <p>About this demo.</p>
    </script>

    <script type="text/x-handlebars" data-template-name="guide">
      <p>Guide to this demo.</p>
    </script>

   <script type="text/x-handlebars" data-template-name="animals">
      <p>Animals. You have selected:</p>
      <div class='outlet'>{{ outlet }}</div>
    </script>

    <script type="text/x-handlebars" data-template-name="animals/index">
      <!-- you will not see this unless you disable App.AnimalsIndexRoute redirect. -->
      <p>No animal selected.</p>
    </script>

    <script type="text/x-handlebars" data-template-name="animals/cats">
      <p>Cat. I can meow. Like all animals, I
        <span class='outlet'>{{ outlet }}</span>
      </p>
    </script>

    <script type="text/x-handlebars" data-template-name="animals/dogs">
      <p>Dog. I can bark. Like all animals, I
        <span class='outlet'>{{ outlet }}</span>
      </p>
    </script>

    <script type="text/x-handlebars" data-template-name="animal_mixin">
      <p>am alive.</p>
    </script>

    <script type="text/x-handlebars" data-template-name="application">
      <div class="container">
        <p>
          Select contents for my outlet:
          {{#linkTo "index"}}/ (root){{/linkTo}}
          {{#linkTo "about"}}/about{{/linkTo}}
          {{#linkTo "guide"}}/guide{{/linkTo}}
          {{#linkTo "animals"}}/animals{{/linkTo}}
          {{#linkTo "animals.cats"}}/animals/cats{{/linkTo}}
          {{#linkTo "animals.dogs"}}/animals/dogs{{/linkTo}}
        </p>

        <div class='outlet'>
          {{ outlet }}
        </div>
      </div>
    </script>

    <script>
      App = Ember.Application.create();
      App.Router.map(function() {
        this.resource("about");
        this.resource("guide");
        this.resource("animals", function() {
          this.route("cats");
          this.route("dogs");
        })
      });
      App.IndexRoute = Ember.Route.extend({
        redirect: function() {
          this.transitionTo('about');
        }
      });
      App.AnimalsIndexRoute = Ember.Route.extend({
        redirect: function() {
          this.transitionTo('animals.cats');
        }
      });
      App.AnimalsCatsRoute = Ember.Route.extend({
        setupController: function(controller, model) {
          // BUG: this controller object has no connectOutlet method
          // (uncomment to see this yourself)
          // controller.connectOutlet('animal_mixin');
        }
      });
      App.initialize();
    </script>

</html> 
```

本质上，animal_mixin 是一大块样板文件，我想重复使用它作为 mixin，通过在此处放置一个插座并将其连接到此模板，将其放置在任何我想要的地方。我意识到这个例子是人为的，因为我可以使用嵌套结构提供的“继承”来做到这一点：animal_mixin 的内容可以直接进入“动物”模板，我不需要在动物/猫和动物/狗。如果我想在所有动物中使用它会很好，但是假设我有另一个 /animals 的子路径，我不想包含这个片段。同样，这个例子是人为的，但我希望问题和意图是明确的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-26T01:21:06.967

您可以使用多个命名的插座。这是一个 jsfiddle 示例：http: [//jsfiddle.net/W2dE4/6/](http://jsfiddle.net/W2dE4/6/)。

```
<script type="text/x-handlebars" data-template-name="application">
    {{outlet header}}
    {{outlet body}}
    {{outlet navBar}}
</script> 
```

另请参阅[此答案](https://stackoverflow.com/questions/14456215/ember-js-pre4-how-to-do-the-previous-pre2-connectoutlet-stuff)以了解其他一些技术。

```
events: {
    showModal: function(){
        this.render('modal', {
            into: 'index',
            outlet: 'modalOutlet',
            controller: this.controllerFor('modal')
        }); 
    }
} 
```

# sql - 带有 SQL 查询的 DateDiff

> ID：14531957
> 
> 赞同：-3
> 
> 时间：2013-01-25T23:28:20.303
> 
> 标签：sql, datediff

我想知道是否有人能够指出以下代码的问题。特别是 dateDiff 部分。我要做的是找出发送发票和存款日期之间的差异（以天为单位）。如果存款日期为空，我想使用今天的日期。很简单，我还以为...

```
$rs = mysql_query("SELECT i.dateSent
    , i.dateDeposit
    , i.invoiceID
    , i.gstValue
    , i.invoiceValue AS invoiceTotal
    , p.projectValue
    , i.invoiceNumber
    , p.projectName
    , p.projectNumber
    , p.projectID
    , c.clientName
    , c.clientCode
    , c.clientID
    , DATEDIFF(i.dateSent, CASE WHEN i.dateDeposit IS Null Then GetDate() ELSE i.dateDeposit) as numbDays

FROM cms_invoices i

LEFT JOIN cms_projects p ON p.projectID = i.projectID
LEFT JOIN cms_clients c ON p.clientID = c.clientID

ORDER BY i.dateDeposit ASC, c.clientName ASC
"); 
```

在这个阶段，结果是没有结果。dateDiff 行中断查询。精氨酸。

谢谢，@rrFive

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T23:29:15.163

好像你错过了一个`END`：

```
... DATEDIFF(i.dateSent, 
    CASE
        WHEN i.dateDeposit IS NULL
            THEN GetDate()
        ELSE i.dateDeposit
     END) AS numbDays 
```

# c - C - 使用 memcpy 直接从内存中复制

> ID：14531958
> 
> 赞同：1
> 
> 时间：2013-01-25T23:28:25.623
> 
> 标签：c, memory, memcpy

这纯粹是一个家庭作业问题，因为我知道你真的不应该在现实生活中尝试这样做。但我一直在努力解决这个问题。假设我们知道要复制的永久起始位置以及要复制的内存块的确切大小。假设我们的源是从 0x28000 到 0x2C0000 的堆栈。堆栈向下增长，因此我们得到了一个指向堆栈顶部的指针（0x2C0000）。我们想将 STACK_SIZE 字节复制到第二个堆栈，其顶部位于 0x30000。基本上是这样的：

```
 Stack 1            Stack 2
       /--+-------------------+-------------------+--/
          |        ABXLQPAOSRJ|                   |
       /--+-------------------+-------------------+--/
      0x280000           0x2C0000            0x300000
                              ^                   ^
                              |                   |
                         Top of stack 1     Top of Stack 2 
```

如果我们必须使用 memcpy，我们必须从 0x28000 开始，对吗？（我不完全确定 memcpy 读取的方向；从较高地址到较低地址，反之亦然）这是正确的吗？

```
void* s = (void *)source_stack_bottom      //where source_stack_bottom is 0x280000 in this case
void* d = (void *)dest_stack_bottom    //which is 0x2C0000
memcpy(d, s, STACK_SIZE)          //STACK_SIZE is just a variable with the stack size 
```

我想不出为什么它不应该工作，但话又说回来，我仍然对 C 有时如何分配内存感到困惑，所以......

编辑:: 哎呀，变量混乱。现在修好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T23:32:30.480

一个天真的实现`memcpy()`将是这样的：

```
void naive_memcpy(void *destt, void *sourcet, size_t size)
{
   char *source = (char *)sourcet;
   char *dest = (char *)destt;
   for(size_t s = 0; s < size; s++){ *dest++ = *source++; }
} 
```

所以是的，它从和开始向上`source`计数`dest`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T23:29:54.633

是的，`memcpy()`从您传递给它的基地址开始计数。

如果您最终为嵌入式系统编写“裸机”类型的无操作系统软件，或者您自己实现操作系统或内核，您可能非常需要这样做。

# asp.net-mvc-3 - 如何获得不显眼的验证以清除电子邮件输入所需的验证？

> ID：14531960
> 
> 赞同：2
> 
> 时间：2013-01-25T23:28:33.610
> 
> 标签：asp.net-mvc-3, html, jquery-validate, unobtrusive-validation

我有一个正在用 ASP.Net MVC3 编写的移动应用程序（使用 JQuery 不显眼的验证）。作为其中的一部分，我正在收集用户的姓名和电子邮件信息。我的模型包括以下字段：

```
 [Required] public String Name {get; set;}
  [Required] public String Email {get; set;} 
```

在我看来，我有以下形式的输入元素：

```
@Html.EditorFor(m => m.Name);
@Html.EditorFor(m => m.Email, "Email"); 
```

其中字符串编辑器模板和电子邮件编辑器模板是相同的，除了电子邮件模板明确将类型属性设置为“电子邮件”。

当我最初提交表单而不输入任何数据时，我会得到客户端验证，说明这两个字段都是必需的。当我开始在名称字段中输入时，验证警告立即消失。当我开始在电子邮件字段中输入时，验证仍然存在。

然后我可以单击提交，尽管“电子邮件字段是必需的”，但表单仍会正确提交。验证消息仍然可见。

如果我修改电子邮件编辑器模板以设置 type="text" 而不是 type="email"，验证会清除我期望的方式（但移动用户不会获得电子邮件专用键盘）。

两个问题：（1）它为什么会这样？(2) 我怎样才能让它表现得“正确”（即，当输入电子邮件时，“必需的”验证消失了）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-28T15:38:09.170

我认为您之所以会出现这种行为，是因为您使用的是旧版本的 jQuery 验证。从 1.9.0 开始的插件处理包括电子邮件在内的 HTML5 类型的输入元素的 keyup、聚焦和聚焦。MVC3 应用程序的标准模板带有 jquery validate 1.8.0，它不会。

所以你的答案：

1.  jQuery 验证版本 < 1.9.0 不处理 html 输入元素类型（例如 type=email）的 keyup、focusin 和 focusout 事件

2.  升级您的 jquery-validate.js - 1.9.0 或更高版本

# ruby-on-rails - 生成控制器时仪表板会变成仪表板吗？

> ID：14531963
> 
> 赞同：4
> 
> 时间：2013-01-25T23:28:40.217
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.1

用户控制器之所以命名为 UsersController，原因很简单，因为它控制多个用户，但实际上它不是只更改特定用户的几个参数吗？

因此，对我来说最合乎逻辑的事情是控制器名称 Dashboard 应该命名为 DashboardsController 因为它控制多个 PC 上的多个 Dashboards 并且由于在呈现页面后某些特定字段的微小变化，因此它应该被命名仪表板。就像用户被命名为用户而不是用户......

这让我回到了起点。我如何决定选择什么；复数还是单数？仪表板只是应用程序中的一个特定事物，而用户并不仅仅控制他们自己的东西，但是当用户名在页面上呈现时，仪表板都是不同的，以及特定的用户喜欢的标签。

最好的做法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T23:42:22.990

我倾向于将演示者模式用于仪表板。仪表板是对象的混合体，很难将其视为显示或索引页面。我将创建一个虚拟对象来处理关联对象的查询和聚合。它确实清理了控制器代码，即使您决定使用 DashboardsController。

但是，我建议在路由中添加 resources.users。

```
collection do 
  get :dashboard
end 
```

然后在 UsersController 下添加一个操作仪表板

```
def dashboard
  @presenter = UserDashboardPresenter.new(user)
end 
```

在视图中使用@presenter。

如果你搜索它，你会发现更多关于演示者模式的信息。它非常适合缓存、代码重用、测试和性能增强。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T23:41:58.867

rails 约定是使用复数定义控制器名称（例如/dashboards）。这不是一成不变的，您可以根据自己的需要进行更改，但是如果您询问最佳实践是什么，那么最好的选择是坚持使用 rails 约定，特别是如果您刚刚开始带导轨。它会让你的生活变得更简单。

如果你真的想为你的控制器使用一个单数术语（例如 /dashboard），你可以在你的 routes.rb 文件中指定它（这假设你正在使用 RESTful 路由并将仪表板定义为资源）

```
resource :dashboard, :controller => 'dashboard' 
```

另请注意，如果您决定使用单数，则需要相应地调整 rails 为 RESTful 路由创建的辅助方法，所以

```
 dashboards_path # will no longer work, you must use
  dashboard_path 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-25T23:42:07.883

为控制器使用复数名称只是 Rails 约定之一。你应该偏离约定吗？我认为如果你坚持下去会更好。

正如您提到的用户，复数名称通常听起来更自然。我确信您的 DashboardsController 将有多个操作，因此它可以追溯到多元化的概念。

我的建议坚持复数惯例。

# visual-studio-2010 - 将视图添加到 LinqToSql 图表不会创建方法/属性

> ID：14531964
> 
> 赞同：1
> 
> 时间：2013-01-25T23:28:47.667
> 
> 标签：visual-studio-2010, linq-to-sql

我正在使用 VS 2010 和 LinqToSql。当我将视图拖到图表上并设置我的关系时，XML 会更新，但类不会使用支持的方法和属性进行更新。

在我完成此操作之前，我会得到这样的属性：

```
 [global::System.Data.Linq.Mapping.AssociationAttribute(Name="Question_QuestionAggregatesView", Storage="_QuestionAggregatesView", ThisKey="Id", OtherKey="Id", IsUnique=true, IsForeignKey=false)]
    [global::System.Runtime.Serialization.DataMemberAttribute(Order=38, EmitDefaultValue=false)]
    public QuestionAggregatesView QuestionAggregates
    {
        get
        {
            if ((this.serializing 
                        && (this._QuestionAggregatesView.HasLoadedOrAssignedValue == false)))
            {
                return null;
            }
            return this._QuestionAggregatesView.Entity;
        }
        set
        {
            QuestionAggregatesView previousValue = this._QuestionAggregatesView.Entity;
            if (((previousValue != value) 
                        || (this._QuestionAggregatesView.HasLoadedOrAssignedValue == false)))
            {
                this.SendPropertyChanging();
                if ((previousValue != null))
                {
                    this._QuestionAggregatesView.Entity = null;
                    previousValue.Question = null;
                }
                this._QuestionAggregatesView.Entity = value;
                if ((value != null))
                {
                    value.Question = this;
                }
                this.SendPropertyChanged("QuestionAggregates");
            }
        }
    } 
```

但是 LinqToSql 并没有为我新添加的视图创建这种类型的属性。

这是VS2010中的错误还是我做错了什么？

非常感谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T16:05:07.513

经过一些复杂的搜索引擎查询操作后找到了答案：

[http://www.bartlannoeye.com/blog/linq-to-sql-not-generating-code-for-association](http://www.bartlannoeye.com/blog/linq-to-sql-not-generating-code-for-association)

感谢 Bart Lannoeye 的有用帖子。简而言之，因为我在图表中添加了一个视图，所以默认情况下没有添加主键。我必须为图中的视图指定主键，之后一切正常。

# asp.net - 加载 ASPX 文件的 jQuery UI 选项卡 - 按下 ASP 按钮后 - 显示“找不到资源”。

> ID：14531976
> 
> 赞同：0
> 
> 时间：2013-01-25T23:30:11.403
> 
> 标签：asp.net, jquery-ui, jquery, jquery-ui-tabs

我是 jQuery/AJAX 的新手，并且在使用 jQuery ui 选项卡时遇到问题。基本上在每个选项卡中，我都会加载它们单独的 .aspx 页面并尝试进行常规处理工作。（它加载正确）我的问题是我在加载的选项卡上有一个按钮，每当单击该按钮时，它都会尝试处理请求（我想在不重新加载整个页面的情况下处理选项卡） - 但现在的第一个问题是我收到一条错误消息...“'/' 应用程序中的服务器错误。（.aspx 页面位于它们自己的文件目录中 - 这可能是错误？）下面是我当前使用的代码。任何帮助或想法将不胜感激！谢谢！

```
<div id="tabs">
    <ul>
        <li><a href="/MemberPages/tab1/tab1.aspx">TAB1</a></li>
        <li><a href="/MemberPages/tab2/tab2.aspx">TAB2</a></li>
        <li><a href="/MemberPages/tab3/tab3.aspx">TAB3</a></li>
        <li><a href="/MemberPages/tab4/tab4.aspx">TAB4</a></li>
        <li><a href="/MemberPages/tab5/tab5.aspx">TAB5</a></li>
        <li><a href="/MemberPages/tab6/tab6.aspx">TAB6</a></li>
    </ul>
    <br />
</div>

<script type="text/javascript" src="scripts/jquery-1.9.0.js"></script>
<script type="text/javascript" src="scripts/script.js"></script>
<script type="text/javascript" src="scripts/jquery-ui-1.10.0.custom.min.js"></script>
<script type="text/javascript">
    $(function () {
        $("#tabs").tabs({
            beforeLoad: function (event, ui) {
                ui.jqXHR.error(function () {
                    ui.panel.html(
        "Couldn't load this tab. We'll try to fix this as soon as possible. " +
        "If this wouldn't be a demo.");
                });
            }
        });
    }); 
```

------采购aspx后端

```
Protected Sub tp_btn_Process_Click(ByVal sender As Object, ByVal e As EventArgs) Handles tp_btn_Process.Click

'database code for insertion

End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T23:43:31.600

您不能通过 ajax 加载 aspx 页面，并等待函数、JavaScript 和按钮工作，就像您单独运行它一样。

为什么 ？因为您有一个带有表单标签的基本页面，并且在其中您可以使用新表单完全加载另一个不同的页面-现在完整的结构一团糟，您有两个视图状态，一个在另一个内部发布表单以及其他内容，例如那。

现在，如果您进行任何回发，则回发数据是一团糟，后面的代码将不接受它。

如果您仍想在选项卡中加载整个页面，另一种方法是使用 iframe 而不是 ajax。iframe 就像一个页面中的一个完整页面，没有将一个帖子与另一个帖子混合在一起。

类似：[如何在 jquery ui 标签中使用 iframe 而不是 div？](https://stackoverflow.com/questions/9042065/how-to-use-iframe-instead-of-div-with-jquery-ui-tabs)

# c - 用C画简单的图片

> ID：14531977
> 
> 赞同：0
> 
> 时间：2013-01-25T23:30:20.543
> 
> 标签：c, loops, parameters

我是 C 新手，刚刚开始学习如何使用它。3\. 我需要编写一个程序，提示用户输入一个整数（范围 1-8）来确定图片大小，然后使用调用 writePattern 的函数来绘制以下每张图片。

我之前创建了一个必须制作的矩形“评论”框，但这些简单的图纸更复杂，我不确定如何制作它们。我也是 StackOverflow 的新手，所以我会将我的代码发布到一个 pastebin 链接而不是把代码放在这里，因为我不知道如何正确地这样做。

这是我正在处理的代码：http: [//pastebin.com/up7Rg9ZX](http://pastebin.com/up7Rg9ZX)

在代码中可以看到，drawBox、drawSlantRight、drawSlantLeft、drawTriangle、drawX、drawXmasTree都需要我来完成。我觉得他们可能都有类似的联系。它可能涉及一堆循环，但是我不知道如何设置它。如果有人可以告诉我其中一个是如何完成的，那么我觉得我将能够得到其余的。希望你能帮忙。听说这是一个很棒的编程帮助网站。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T00:16:27.283

这些函数是经典的入门函数，用于习惯使用循环和简单的编程逻辑。由于您不知道如何执行它们，因此我将向您展示如何执行第一个功能。你会知道需要做什么，我建议你亲自尝试其他的。这是您学习的唯一方法！

```
/* draws a square box with chars '*' and '.'.  For example if the
   parameter value is 3, the following box would be drawn.
   *..
   **.
   ***
*/

    void drawBox(int size)
    {
        int line_counter;
        for (line_counter = 1; line_counter < size+1; line_counter ++)
        {
         int star_counter;
         for (star_counter = 0; star_counter < line_counter; star_counter ++)
         {
          printf("*"); 
         }

         int dot_counter;
         for (dot_counter = line_counter; dot_counter < size; dot_counter ++)
         {
          printf("."); 
         }

        printf("\n");
        }

    } 
```

试试看，应该可以的。所以基本上有它的要点。就像我说的，你需要处理 for 循环、计数器和打印语句。

自从您开始使用以来，我列出了一些您可能感兴趣的资源。有关 C 的良好教程，请尝试此[站点](http://www.iu.hio.no/~mark/CTutorial/CTutorial.html)。此外，如果您想在这项研究中投入更多资金，我强烈建议您购买 The C [Programming Language](https://rads.stackoverflow.com/amzn/click/com/0131103628)，可在所有好书店购买（无意做商业广告）。它由 Dennis M. Ritchie（C 的创造者）共同编写。

# c++ - C++ 继承 - getClass() 等效？

> ID：14531978
> 
> 赞同：11
> 
> 时间：2013-01-25T23:30:40.247
> 
> 标签：c++, inheritance

以下面的 C++ 为例。

```
vector<Animal> listAnimal;

class Fish : Animal ...
class Mammal : Animal ...
class Bird : Animal ... 
```

如果我然后将它们全部添加到列表中，然后任意将它们从列表中取出，我将不知道我正在处理哪个子类。我在 Java 中可以做`getClass()`或`thefish instanceof Fish`. 我如何在 C++ 中做到这一点？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-25T23:37:08.543

你不需要知道你正在处理什么类型的子类。如果您需要检查您正在处理的类的类型，那么您就没有正确地进行多态性。多态性的全部意义在于减少 if 并使您的代码更加灵活。

在某些情况下您需要知道，您可以使用[RTTI](http://en.wikipedia.org/wiki/Run-time_type_information)。但是我建议不要这样做，特别是如果您需要大量性能（例如游戏或图形程序）。

使用`typeid`运算符获取有关类的信息，并确定类是否为特定类型。

例如：

```
Animal* animal1 = new Cat;

if(typeid(animal1) == typeid(Cat))
{
     cout << "animal1 is a: " << typeid(Cat).name();
} 
```

然后使用 a`static_cast`将其向下转换层次结构。

```
Animal* animal1 = new Cat;

if(typeid(animal1) == typeid(Cat))
{
     Cat* cat = static_cast<Cat*>(animal1);
     cat->scratchTheLivingHellOutOfYou();
} 
```

或者，您可以使用`dynamic_cast`比 typeid/static_cast 更安全但慢得多的 a。像这样：

```
Animal* animal1 = new Cat;

if(Cat* cat = dynamic_cast<Cat*>(animal1)
{
     cat->scratchTheLivingHellOutOfYou();
} 
```

## **编辑：**

`dynamic_cast`速度较慢仅仅是因为它必须做一些额外的工作，而不仅仅是测试它是否是特定类型和强制转换。ie`dyanmic_cast`不等于`typeid/static_cast`，但几乎是。

想象一个深度超过 2 层的层次结构，例如：

```
class Animal { /* ... */ }; // Base
class Cat : public Animal { /* ... */ }; // 2nd level
class Tiger : public Cat { /* ... */ }; // 3rd level 
```

假设在 Cat 类中，调用了特定于所有 Cat 的方法：`scratchTheLivingHellOutOfYou()`。还可以这样说：我有一个 Animals 列表，我想调用`scratchTheLivingHellOutOfYou()`列表中的每个 Cat（这包括派生自 Cat 类的类）。如果使用`typeid`and 运算符`static_cast`，这将无法实现所需的功能，因为`typeid`只检查当前类型而不关心层次结构。为此，您必须使用 a `dynamic_cast`，因为它会检查一个类是否派生自基类，然后相应地向上/向下转换层次结构。

[您可以在此处](http://ideone.com/4annRR)查看这个简单的 C++ 示例。这是程序的输出：

```
USING TYPEID

*scratch*
meoyawnn!
RAWR

USING DYNAMIC_CAST

*scratch*
meoyawnn!
*scratch*
RAWR 
```

因此，您可以清楚地看到，它比简单的and`dynamic_cast`做了更多的工作。由于查找层次结构以查看它*是否*是特定类型。简单地说......可以*上下*层级。而 a and只能将层次结构向下转换为特定类型。`typeid``static_cast``dynamic_cast`*`dynamic_cast`*`typeid``static_cast`**

 **我想我会提到，如果`dynamic_cast`失败，它将返回一个 NULL 指针，或者如果您将它与引用一起使用，则抛出异常。

## **笔记：**

1.  如果您确实需要性能并且需要检查多态对象的类型，我建议您找到 RTTI 的替代方法，例如使用模板/宏或其他任何方法来识别类。
2.  `dynamic_cast`仅当您不确定对象是否是您要转换的类型时才应使用。如果你，作为一个程序员，知道你正在铸造的任何东西都是 100% 将是那种类型，那么使用`static_cast`，例如，如果你知道 animal1*将*是 a`Cat`那么`static_cast`更合适。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T23:32:04.220

容器仅存储固定类型的元素，您需要指向对象的指针。

```
#include <memory>
#include <vector>

std::vector<std::unique_ptr<Animal>> animal_list;

animal_list.emplace_back(new Fish);
animal_list.emplace_back(new Mammal);
animal_list.emplace_back(new Bird ); 
```

将派生类型推入 listAnimal 时`Animal`，会导致在向量中存储类型。`object slice`

```
 vector<Animal> listAnimal;
 listAnimal.push_back(Fish);  // Fish is sliced to Animal, no fish for you. 
```

编辑：

要知道衍生动物是什么类型，您可以将其存储在成员中

```
Enum AnimalType
{
  FISH,
  MAMAL,
  BIRD
};

class Animal
{
public:
  Animal(AnimalType animal_type) : type(animal_type) {}
  AnimalType GetType() const { return type; }
private:
  AnimalType type;   
}; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-25T23:47:53.120

我通常创建一个纯虚函数，每个派生类都实现它来告诉你它的身份。例子：

```
enum AnimalType
{
   Fish = 0,
   Mammal,
   Bird
}

class Animal
{
   virtual AnimalType GetType() const = 0;
}

...

AnimalType Bird::GetType()
{
   return Bird;
} 
```

然后你可以做这样的事情：

```
if (animal.GetType() == Bird)
{
   // ...
} 
```**

# mysql - 原则：特殊字符不保存到数据库字符串字段中

> ID：14531981
> 
> 赞同：5
> 
> 时间：2013-01-25T23:30:54.593
> 
> 标签：mysql, symfony, doctrine, diacritics

我正在尝试使用学说（在 symfony2 中）保存到字符串字段（mysql 数据库）中：

```
$blogpost->setTitle = "Test !§$%&/()=? äöü ÄÖÜ :D";

$em = $this->getDoctrine()->getManager();
$em->persist($blogpost);
$em->flush(); 
```

但它救了我：“测试！” （其余的都不见了）

实体是：

```
/**
 * @ORM\Column(type="string")
 */
protected $Title; 
```

mysql 数据库是 utf8_general_ci。

（当我使用 phpmyadmin 手动添加实体时，它可以正常工作。）

我需要有德语变音符号。希望您能够帮助我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T07:20:52.967

您必须为您的实体管理连接字符串设置编码：

```
doctrine:
    dbal:
        driver: %database_driver%
        host: %database_host%
        port: %database_port%
        dbname: %database_name%
        user: %database_user%
        password: %database_password%
        charset: UTF8 
```

这样，您可以在数据库中的所有列上使用 UTF8 字符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-26T07:01:37.307

在这个文件中 `vendor/doctrine/dbal/lib/Doctrine/DBAL/Platforms/MySqlPlatform.php`

他们有

```
if ( ! isset($options['collate'])) {
  $options['collate'] = 'utf8_unicode_ci';
} 
```

尝试将其更改为 `utf8_general_ci`

也看看这里

[http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/faq.html#how-do-i-set-the-charset-and-collat​​ion-for-mysql-tables](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/faq.html#how-do-i-set-the-charset-and-collation-for-mysql-tables)

# java - 重复深度优先搜索算法

> ID：14531984
> 
> 赞同：4
> 
> 时间：2013-01-25T23:31:38.983
> 
> 标签：java, algorithm, duplicates, graph-algorithm

我正在用 Java 编写一个程序，我必须实现三个搜索算法，其中三个是深度优先图形搜索算法。我的程序遍历由邻接矩阵内部表示的连通图，并使用每个算法的边界和探索集。

边界存储扩展父节点的未探索子节点，探索集存储实际已扩展的节点。探索集的目的是避免重复，从而避免无限循环。

我的边界是使用链接的阻塞双端队列实现的，而我的探索集是使用链接的哈希集实现的。

然而，在测试这个算法实现的初始版本时，我注意到仍然有少量重复，特别是当目标节点不存在并且算法肯定必须访问图中的每个节点时。最终我意识到这是因为当一个节点被扩展时，它的所有子节点都被添加到边界，但只有一个被探索。因为图是连接的，所以节点可能存在其他路径，这可能导致节点在它被扩展并因此添加到探索集之前被多次遇到。

这引出了我的问题，我要解决它吗？

深度优先搜索应该首先探索由图形成的树的一侧，然后回溯，这意味着即使它在树的一侧遇到不太理想的目标节点，它也应该返回那个而不是（更优) 一个以前遇到但尚未探索的问题。

但是，如果我为了避免重复而实施探索集，那么在某些情况下我允许它们似乎是矛盾的。

我相信真正的错误可能在于对算法缺乏透彻的理解，我真诚地希望得到一些帮助，在此先感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T23:48:43.433

通常称为深度优先搜索的算法*不需要*您所说的“边界”。然而，这个概念用于 A* 图形搜索（它通常在那里被称为“开放集”）。

对于标准深度优先搜索，您只需要一堆节点：将初始节点压入堆栈，然后在每一步中从堆栈中弹出一个节点，检查它并将其所有邻居（*）压入堆栈顶部。然后，重复。

（*）记住将您推送到堆栈上的所有节点标记为已访问（我相信您在问题中将此称为“已探索集”）并且不要推送已访问过的节点。

通过使用堆栈，您可以避免您描述的问题。

如果您确实想维护该边界/开放集，请确保它从不包含重复项：使用不允许重复的数据结构（例如 a `set`）。

（旁注：如果您的图形节点具有自然编号，并且您希望您的 DFS 访问大多数注释，那么您也可以使用`array`/`vector`作为您的探索集/封闭集。）

# ruby-on-rails-3 - 在 Rails 中使用 Geocoder 对 ActiveRecord 关系进行排序

> ID：14531985
> 
> 赞同：2
> 
> 时间：2013-01-25T23:31:42.023
> 
> 标签：ruby-on-rails-3, sorting, rails-activerecord, rails-geocoder

我正在将 Geocoder gem 与一个名为 Breve 的模型一起使用。Geocoder 提供了一个方法 near([latitude, longitude], radius) 返回一个包含参考点半径中所有“breves”的关系。我想创建一个视图，其中将有 2 个 breves 列表，1 个按上次更新时间的倒序排列，1 个基于与给定参考点的接近程度（在下面的代码中，它是巴黎的中心）。

```
Breve.near(@reference_point,10) 
```

当我测试那条线时，关系实际上是从离参考点最近到最短的地方排序的。但是，当我通过控制器将它传递给视图时，它会像其他列表一样按时间倒序显示。

我已经尝试了几件事，但到目前为止我无法弄清楚。下面是控制器和视图的代码，以及 Breve 模型：

```
controllers/static_pages_controller

require 'will_paginate/array'

class StaticPagesController < ApplicationController
def home
    @update_ordered = Breve.paginate(page: params[:page])
    @reference_point = [48.85, 2.35]
    ordered = Breve.near(@reference_point,10)
    #binding.pry
    @location_ordered = Breve.near(@reference_point,10).paginate(page: 
                                                      params[:page])
end

def content
end

def contribute
end
end 
```

视图views/static_pages/home.html.erb

```
<div class="span5 pull-left">
<h3>Liste classée par date de dernière modification</h3>
<ul class="list">
    <%= render @update_ordered, detail: 'time_update' %>
</ul>
<%= will_paginate @update_ordered %>
</div>
<div class="span5 pull-right">
<h3>Liste classée par distance au centre de Paris</h3>
<ul class="list">
    <%= render @location_ordered, detail: 'distance' %>
</ul>
<%= will_paginate @location_ordered %>
</div> 
```

和模型 models/breve.rb

```
class Breve < ActiveRecord::Base
attr_accessible :description, :title, :location, :source_name, :source_URL, 
                        :latitude,:longitude
has_paper_trail
reverse_geocoded_by :latitude, :longitude

validates :title, presence: true
validates :title, :length => { :maximum => 100 }

validates :location, :length => { :maximum => 100 }
validates :description, :length => { :maximum => 2000 }
validates :source_name, :length => { :maximum => 100 }

validates :latitude, presence: true
validates :latitude, numericality: true
validates :latitude, :numericality => {
    :greater_than => -90,
    :less_than => 90
}

validates :longitude, presence: true
validates :longitude, numericality: true
validates :longitude, :numericality => {
    :greater_than => -180,
    :less_than => 180
}

default_scope order: 'breves.updated_at DESC'
end
end 
```

# c++ - lambda函数可以递归吗？

> ID：14531993
> 
> 赞同：82
> 
> 时间：2013-01-25T23:32:00.443
> 
> 标签：c++, recursion, c++11, lambda

> **可能重复：**
> [c++0x 中的递归 lambda 函数](https://stackoverflow.com/questions/2067988/recursive-lambda-functions-in-c0x)

这是一个普通的旧递归函数：

```
int fak(int n)
{
    return (n <= 1) ? 1 : n * fak(n - 1);
} 
```

我将如何编写这样的递归函数作为 lambda 函数？

```
[](int n) { return (n <= 1) ? 1 : n * operator()(n - 1); }
// error: operator() not defined

[](int n) { return (n <= 1) ? 1 : n * (*this)(n - 1); }
// error: this wasn't captured for this lambda function 
```

是否有任何表示当前 lambda 的表达式，以便它可以递归地调用自己？

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2013-01-25T23:38:18.797

是的他们可以。您可以将它存储在一个变量中并引用该变量（尽管您不能将该变量的类型声明为`auto`，但您必须改用一个`std::function`对象）。例如：

```
std::function<int (int)> factorial = [&] (int i) 
{ 
    return (i == 1) ? 1 : i * factorial(i - 1); 
}; 
```

否则，不，您不能`this`从 lambda 的主体内部引用指针。