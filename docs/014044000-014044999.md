# StackOverflow 问答 14044000-14044999

# android - Android 刷新 Spinner

> ID：14044000
> 
> 赞同：0
> 
> 时间：2012-12-26T17:33:47.677
> 
> 标签：android, dataset, refresh, spinner

如何刷新微调器的数据集？这是我的代码：

```
mCategory = (Spinner) rootView.findViewById(R.id.detail_categoryType);
    String[] mCategoryProjection = { DailyTables.TABLE_CATEGORIES_COLUMN_ID, DailyTables.TABLE_CATEGORIES_COLUMN_TITLE };
    int[] to = new int[] {  android.R.id.text1, android.R.id.text1 };
    Cursor mCategoryCursor = getActivity().getContentResolver().query(DailyContentProvider.CATEGORIES_CONTENT_URI, mCategoryProjection, null, null, null);
    SimpleCursorAdapter adapter = new SimpleCursorAdapter(getActivity(), android.R.layout.simple_spinner_item, mCategoryCursor, mCategoryProjection, to, 0 );
    adapter.setDropDownViewResource( android.R.layout.simple_spinner_dropdown_item );
    mCategory.setAdapter(adapter);
    mCategory.setOnLongClickListener(new AdapterView.OnLongClickListener() { 
        public boolean onLongClick(View v) { 
            Cursor currentItem = (Cursor) mCategory.getSelectedItem();
            if( currentItem != null ) {
                 Log.d("", currentItem.getString(currentItem.getColumnIndexOrThrow(DailyTables.TABLE_CATEGORIES_COLUMN_TITLE)) + " is long clicked");
                 DialogFragment newFragment = SpinnerEditCategoryDialogFragment.newInstance( currentItem.getInt(currentItem.getColumnIndexOrThrow(DailyTables.TABLE_CATEGORIES_COLUMN_ID)) );
                 newFragment.show(getActivity().getSupportFragmentManager(), "dialog");
            }
            ((SimpleCursorAdapter) mCategory.getAdapter()).notifyDataSetChanged();
            return true; 
        } 
     }); 
```

如果我长按微调器，则会打开一个对话框，该对话框会重命名微调器中的项目。因此，如果它能显示正确的值，那就太好了。 `notifyDataSetChanged()`不做这项工作。怎么了？

# java - LogCat 条目含义 2

> ID：14044001
> 
> 赞同：-5
> 
> 时间：2012-12-26T17:33:50.373
> 
> 标签：java, android, logcat, android-logcat

我现在不明白这个 LogCat 条目的含义。有人能帮我吗？

```
12-26 18:33:09.651: E/AndroidRuntime(26038): FATAL EXCEPTION: main
12-26 18:33:09.651: E/AndroidRuntime(26038): java.lang.NullPointerException
12-26 18:33:09.651: E/AndroidRuntime(26038):    at android.widget.ArrayAdapter.createViewFromResource(ArrayAdapter.java:394)
12-26 18:33:09.651: E/AndroidRuntime(26038):    at android.widget.ArrayAdapter.getView(ArrayAdapter.java:362)
12-26 18:33:09.651: E/AndroidRuntime(26038):    at android.widget.AbsListView.obtainView(AbsListView.java:2090)
12-26 18:33:09.651: E/AndroidRuntime(26038):    at android.widget.ListView.measureHeightOfChildren(ListView.java:1485)
12-26 18:33:09.651: E/AndroidRuntime(26038):    at android.widget.ListView.onMeasure(ListView.java:1348)
12-26 18:33:09.651: E/AndroidRuntime(26038):    at android.view.View.measure(View.java:12937)
12-26 18:33:09.651: E/AndroidRuntime(26038):    at android.widget.RelativeLayout.measureChild(RelativeLayout.java:579)
12-26 18:33:09.651: E/AndroidRuntime(26038):    at android.widget.RelativeLayout.onMeasure(RelativeLayout.java:392)
12-26 18:33:09.651: E/AndroidRuntime(26038):    at android.view.View.measure(View.java:12937)
12-26 18:33:09.651: E/AndroidRuntime(26038):    at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:5045)
12-26 18:33:09.651: E/AndroidRuntime(26038):    at android.widget.FrameLayout.onMeasure(FrameLayout.java:293)
12-26 18:33:09.651: E/AndroidRuntime(26038):    at android.view.View.measure(View.java:12937)
12-26 18:33:09.651: E/AndroidRuntime(26038):    at android.widget.LinearLayout.measureVertical(LinearLayout.java:812)
12-26 18:33:09.651: E/AndroidRuntime(26038):    at android.widget.LinearLayout.onMeasure(LinearLayout.java:553)
12-26 18:33:09.651: E/AndroidRuntime(26038):    at android.view.View.measure(View.java:12937)
12-26 18:33:09.651: E/AndroidRuntime(26038):    at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:5045)
12-26 18:33:09.651: E/AndroidRuntime(26038):    at android.widget.FrameLayout.onMeasure(FrameLayout.java:293)
12-26 18:33:09.651: E/AndroidRuntime(26038):    at com.android.internal.policy.impl.PhoneWindow$DecorView.onMeasure(PhoneWindow.java:2180)
12-26 18:33:09.651: E/AndroidRuntime(26038):    at android.view.View.measure(View.java:12937)
12-26 18:33:09.651: E/AndroidRuntime(26038):    at android.view.ViewRootImpl.performTraversals(ViewRootImpl.java:1227)
12-26 18:33:09.651: E/AndroidRuntime(26038):    at android.view.ViewRootImpl.handleMessage(ViewRootImpl.java:2700)
12-26 18:33:09.651: E/AndroidRuntime(26038):    at android.os.Handler.dispatchMessage(Handler.java:99)
12-26 18:33:09.651: E/AndroidRuntime(26038):    at android.os.Looper.loop(Looper.java:156)
12-26 18:33:09.651: E/AndroidRuntime(26038):    at android.app.ActivityThread.main(ActivityThread.java:5099)
12-26 18:33:09.651: E/AndroidRuntime(26038):    at java.lang.reflect.Method.invokeNative(Native Method)
12-26 18:33:09.651: E/AndroidRuntime(26038):    at java.lang.reflect.Method.invoke(Method.java:511)
12-26 18:33:09.651: E/AndroidRuntime(26038):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
12-26 18:33:09.651: E/AndroidRuntime(26038):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
12-26 18:33:09.651: E/AndroidRuntime(26038):    at dalvik.system.NativeStart.main(Native Method)
12-26 18:33:11.691: D/Process(26038): killProcess, pid=26038
12-26 18:33:11.691: D/Process(26038): dalvik.system.VMStack.getThreadStackTrace(Native Method)
12-26 18:33:11.691: D/Process(26038): java.lang.Thread.getStackTrace(Thread.java:599)
12-26 18:33:11.691: D/Process(26038): android.os.Process.killProcess(Process.java:813)
12-26 18:33:11.691: D/Process(26038): com.android.internal.os.RuntimeInit$UncaughtHandler.uncaughtException(RuntimeInit.java:104)
12-26 18:33:11.701: D/Process(26038): java.lang.ThreadGroup.uncaughtException(ThreadGroup.java:693)
12-26 18:33:11.701: D/Process(26038): java.lang.ThreadGroup.uncaughtException(ThreadGroup.java:690)
12-26 18:33:11.701: D/Process(26038): dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T17:38:40.033

```
java.lang.NullPointerException
    at android.widget.ArrayAdapter.createViewFromResource(ArrayAdapter.java:394) 
```

```
ArrayAdapter<Comment> adapter = 
    new ArrayAdapter<Comment>(this, android.R.layout.simple_list_item_1, values); 
```

`values`至少有一个空对象，你不能有。

* * *

您可以阅读[源代码](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.1.1_r1/android/widget/ArrayAdapter.java#ArrayAdapter.createViewFromResource%28int%2Candroid.view.View%2Candroid.view.ViewGroup%2Cint%29)并在此处看到这种情况：

```
T item = getItem(position);
if (item instanceof CharSequence) {
    text.setText((CharSequence)item);
} else {
    text.setText(item.toString()); // Line 394, when item is null this throws an NPE
} 
```

# fullscreen - gVim 7.3 全屏模式

> ID：14044004
> 
> 赞同：7
> 
> 时间：2012-12-26T17:34:04.967
> 
> 标签：fullscreen, vim

我正在使用从这里下载的脚本以全屏方式打开 gVim：http: [//www.vim.org/scripts/script.php](http://www.vim.org/scripts/script.php?script_id=2596) ?script_id=2596 。

我还在启动设置中添加了这一行：

```
:call libcallnr("gvimfullscreen.dll", "ToggleFullScreen", 0) 
```

使用此设置运行 gVim 时，出现以下错误：

```
Error detected while processing _virmc:
E364: Library call failed for "ToggleFullScreen()" 
```

我还需要处理该脚本中的文件吗？如果我需要以某种方式编译它，希望有人指导我完成该过程，因为我对 Vim 还很陌生。谢谢！

编辑：我正在运行 Windows 7

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T13:36:14.397

我猜你的意思是`~/.vimrc`或`~/.gvimrc`“启动设置”。执行该操作时，GUI 尚未初始化。尝试使用 autocmd 延迟执行：

```
:autocmd GUIEnter * call libcallnr("gvimfullscreen.dll", "ToggleFullScreen", 0) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T10:43:12.023

[通过Vundle](https://github.com/gmarik/vundle)安装此脚本时，我遇到了同样的问题。
它解决了这个问题：

> 将 DLL 复制到 GVIM.EXE 所在的文件夹。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-28T10:43:30.757

如果您将该`call`行放在您的`vimrc`. 它应该在 Vim 完成加载后调用。我建议使用自述文件中的映射：

```
map <F11> <Esc>:call libcallnr("gvimfullscreen.dll", "ToggleFullScreen", 0)<CR> 
```

它对我有用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-06-07T00:30:24.483

这不是一个直接的答案，但是在寻找了很长一段时间的解决方案之后，我决定在 Windows 上运行 Vim 的最漂亮方法是通过 Cygwin，通过（捆绑的）mintty 终端。它有一个真正的全面屏甚至透明胶片！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-02-15T16:23:04.940

将 复制到可执行目录的另一种方法`gvimfullscreen.dll`是指定文件路径，如下所示：

```
call libcallnr(expand("$VIM") . "/bundle/gvimfullscreen_win32/gvimfullscreen.dll", "ToggleFullScreen", 0) 
```

在此示例中，我使用`$VIM`的是`bundle`目录，但您可以将其更改为完整路径，或使用另一个更适合您的变量/路径。

# php - 正则表达式匹配PHP中的格式化文本

> ID：14044008
> 
> 赞同：0
> 
> 时间：2012-12-26T17:34:15.507
> 
> 标签：php, regex

我有这样的格式化文本：

```
Record
name=aaa
age=16
info=blabla bla

Record
name=bbb
age=15
info=foo bar foo bar 
```

想在 PHP 中使用正则表达式将其转换为数组。到目前为止，我已经尝试过：

```
preg_match_all("/Record.*\n(?m:^(.+)=(.+)$)+/",$text,$matches); 
```

但它只会抓住`"Record name=aaa"`并`"Record name=bbb"` 想知道为什么`+`在这种情况下不起作用。那么我应该如何在这里形成我的模式呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T17:39:08.560

您在第一个之后没有匹配换行符。移动部分`\n`内部`(?m:...)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T17:47:19.863

这样[就可以了](http://codepad.viper-7.com/92Y4Rx)。

```
$data = array_values(array_map(
    function($e){
        preg_match_all('/(.*?)=([^\r\n]*)/', $e, $m); 
        return array_combine($m[1], $m[2]);
    }, 
    array_filter(explode("Record", $text))
)); 
```

`Record`首先，它使用[explode](http://php.net/explode)和[array_filter](http://php.net/array_filter)将整个数据拆分为分隔符。[然后对于每个块，它使用preg_match_all](http://php.net/preg_match_all)提取键值对并构造一个关联数组（通过[array_combine](http://php.net/array_combine)）。

# push-notification - GCM API 密钥与发件人 ID

> ID：14044017
> 
> 赞同：15
> 
> 时间：2012-12-26T17:35:22.997
> 
> 标签：push-notification, google-cloud-messaging

我对 GCM 发件人 ID 和 API 密钥感到困惑。我负责构建将向 Android 应用发送通知的第 3 方服务器。

我必须在服务器端存储哪个？API 密钥或发件人 ID？谁负责创建这两​​者，Android 开发人员还是我？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-12-30T18:27:50.120

我自己有点想通了：

1.  API 密钥在控制台上生成，并由第 3 方服务器用于向 GCM 进行身份验证/授权。
2.  Android 应用程序使用发件人 ID 向 GCM 注册物理设备，以便能够从特定 3rd 方服务器接收来自 GCM 的通知。
3.  注册 ID 是使用 Sender ID 将物理设备注册到 GCM 的结果。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-27T16:02:34.303

这取决于您的第三方服务器将如何工作，但通常它是这样工作的：

1.  该应用程序将一个或多个作为 Google 项目编号的发件人 ID 发送到 GCM 服务器。
2.  GCM 返回一个注册 ID，应用程序使用它向服务器注册。
3.  服务器使用注册 ID 和 API 密钥通过 GCM 向设备发送消息。
4.  发送消息时，GCM 将确保 Google 项目编号和 API 密钥匹配并匹配用于创建注册 ID 的内容。如果他们这样做，它会发送消息。

有关开发人员如何获取此信息的信息，请参阅 GCM 文档：http: [//developer.android.com/google/gcm/gs.html](http://developer.android.com/google/gcm/gs.html)

根据您的需要，可以使用第三方商业服务器解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-26T20:00:35.283

GCM 进程依赖于两个键或 ID。一种是在 Android 应用程序端创建并发送到 API 密钥已存储的服务器应用程序的 registrationID。使用注册 ID 和 API 密钥的组合将消息推送到设备。

注册 ID 由 GCM 服务器在 android 应用程序向它们发出请求时生成。保留已创建的项目 ID（在 Google 开发控制台中）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-07-31T22:12:09.013

GCM 发件人 ID 也可能指的是：

来源：[https ://firebase.google.com/docs/cloud-messaging/js/client](https://firebase.google.com/docs/cloud-messaging/js/client)

[![在此处输入图像描述](../Images/8dbdad9b29af7976e2885e2637879a2a.png)](https://i.stack.imgur.com/lxBfG.png)

# c# - 在 C# 中从网络驱动器加载程序集 (dll)

> ID：14044019
> 
> 赞同：2
> 
> 时间：2012-12-26T17:35:43.853
> 
> 标签：c#, dll

我正在尝试从我的 C# exe 中的网络文件夹加载一个 dll。

System.Reflection.Assembly 程序集 = System.Reflection.Assembly.LoadFile(xPath + "\" + t[0] + ".dll");

我收到以下错误 -

```
 RefusedSet=""
       Url=file://<network drive>/folder/raterType.dll
       StackTrace:
            at raterType.raterType.raterTypeCode(String a)
       InnerException: 
```

我必须做哪些程序集设置，才能完全信任我的 exe 中的 dll，因此它可以在没有任何限制的情况下加载它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T17:41:08.440

这是由于 CAS[政策](http://blogs.msdn.com/b/shawnfa/archive/2009/06/08/more-implicit-uses-of-cas-policy-loadfromremotesources.aspx)。您需要给予完全信任许可。

如果在此之后仍然无法正常工作，请尝试先将文件加载到内存中（字节数组，使用 System.IO.File.ReadAllBytes()），然后使用[Assembly.Load()](http://msdn.microsoft.com/en-us/library/h538bck7.aspx)从内存文件数据中加载程序集超载。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-26T17:40:30.967

您需要对尝试从网络位置加载的程序集给予“完全信任”。这是一个[分步指南](http://support.microsoft.com/kb/832742)。

# sql-server - 在 joomla 中更改 URL

> ID：14044022
> 
> 赞同：1
> 
> 时间：2012-12-26T17:35:50.153
> 
> 标签：sql-server, database, url, joomla2.5

我已经查看了答案，但我不确定哪个对我有用，所以我再次写下这个问题，希望得到一个可能有用的回复。这里： http: [//norstore-trd-bio0.hpc.ntnu.no/tfcp/](http://norstore-trd-bio0.hpc.ntnu.no/tfcp/) 我在服务器上有一个数据库，我正在使用 Joomla 创建网站和管理数据库。这是一个测试版本，现在我想自己拥有数据库，但使用由 godaddy.com 购买的网站[http://tfcheckpoint.org/的新 URL。](http://tfcheckpoint.org/)

根据godaddy的说法，我试图首先掩盖有点重定向tfcheckpoint.org到原始站点的网站，如下所述：http: [//support.godaddy.com/help/article/422/forwarding-or-masking-your-domain -name](http://support.godaddy.com/help/article/422/forwarding-or-masking-your-domain-name) 但是，这会导致一些链接被破坏并且不再可以访问，因为外部 URL 是固定的。

其次，我寻找其他解决方案并尝试获取 mysql 转储并在任何地方用新 url 替换旧 url 并再次导入 sql 文件，但没有任何改变。可能是因为新站点被屏蔽了，我必须取消屏蔽它。或者我应该重新安装 Joomla 并使用新的 URL 从头开始​​。

但是有没有合适的方法来做到这一点。我不认为将数据库移动到新的托管服务器是解决方案，因为许多人在使用这些花哨的域名时将数据保存在本地服务器上。如果有标准程序，请指导我。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-29T12:28:05.247

据我从您的问题中可以看出，您只是试图将 Joomla 站点从一个托管服务商的服务器移动到另一个托管服务商？您甚至可能在主持人之间移动……我的回答仍然有效。

首先，我听说 GoDaddy for Joomla 网站存在许多问题。但这可能是另一个问题的答案。

在移动您的测试站点并将其“转变”为新服务器上的实时站点方面，这可以使用 Akeeba Backup 之类的第 3 方工具来完成。

对于新位置的 Joomla 设置，您需要更改详细信息以适应新主机的数据库和文件位置详细信息。这是通过站点恢复过程完成的（在 Akeeba 中非常容易）。您还设置了 LiveSite 设置，需要在 /newlocation of your files/joomla install/configuration.php 中手动更改。

在 DNS 设置方面，您的新域应该指向新主机的服务器，并且针对指向新域的旧域的 301 重定向应该涵盖所有基础。

我希望这能回答你的问题。如果不是，我建议重写问题以更清楚。你可能会得到更多的答案

# grails - Grails 2.1.2 - 未解决的依赖项错误

> ID：14044027
> 
> 赞同：1
> 
> 时间：2012-12-26T17:36:25.697
> 
> 标签：grails

我在 Windows 7 64 位系统上使用 Grails 2.1.2，在编译时它给出了以下错误，请帮助我如何解决这个问题。

```
 ::::::::::::::::::::::::::::::::::::::::::::::

 ::          UNRESOLVED DEPENDENCIES         ::

 ::::::::::::::::::::::::::::::::::::::::::::::

 :: org.grails.plugins#mail;1.0-SNAPSHOT: not found

 :: org.grails.plugins#tomcat;1.3.2: not found

 :: org.grails.plugins#hibernate;1.3.2: not found

 :: org.grails.plugins#csl-rest-lib;1.0: not found

 :::::::::::::::::::::::::::::::::::::::::::::: 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T20:55:48.077

在 BuildConfig.groovy 中，尝试声明依赖项：

```
dependencies {
    compile 'org.grails.plugins:mail:1-0-SNAPSHOT'
    compile 'org.grails.plugins:tomcat:1.3.2'
    ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T22:15:18.280

如果您的应用程序是从 grails 1.3 (<2\. *) 更新或从 grails 2\. 创建的*，您需要检查[grails plugins](http://grails.org/plugins/)上的插件版本 例如，当前版本的邮件插件是 1.0.1[邮件插件](http://grails.org/plugin/mail) 您还需要检查此依赖项位于 conf/BuildConfig.groovy。它必须有这样的部分：

```
plugins {
        build ":tomcat:$grailsVersion"

        runtime ":hibernate:${grailsVersion}"
        runtime ":resources:1.1.6"
... 
```

部分描述你的插件`plugins`。你需要检查最新的插件库并像这样描述它：

```
dependencies {
        // specify dependencies here under either 'build', 'compile', 'runtime', 'test' or 'provided' scopes eg.

        compile('org.apache.poi:poi:3.7',
                'org.apache.poi:poi-contrib:3.6',
                'org.apache.poi:poi-ooxml:3.7',
                'antlr:antlr:2.7.6',
                'org.apache.ant:ant-apache-log4j:1.7.1'
.. 
```

# mobile - 查询对象 where function filter

> ID：14044029
> 
> 赞同：2
> 
> 时间：2012-12-26T17:36:36.427
> 
> 标签：mobile, service, azure

我正在尝试在 Azure 层中实现我的业务逻辑，但我只是没有掌握 Insert 上的这种 node.js 样式的脚本。

我有适用于此的 T-SQL

```
declare @latitude decimal(23,20)
declare @longitude decimal(23,20)
declare @timeStamp datetime

set @latitude = 37.7858340000000012537
set @longitude = -122.4064170000000046911
set @timeStamp = '2012-12-25 02:58:23'

select longitude, latitude, userid
from blah.actions ba
where 
(
    datediff(second, ba.TimeStamp, @timeStamp) < 5 and
    (ba.longitude - 0.0001 <= @longitude and ba.longitude + 0.0001 >= @longitude) and
    (ba.latitude - 0.0001 <= latitude and ba.latitude + 0.0001 >= latitude) 
) 
```

问题是，如何使用函数来过滤插入时 Azure 脚本中的表查询？

所以多做一点工作。我想出了如何使用函数进行过滤（但我仍在努力调试 Azure 脚本）。我的插入中有以下内容。我让它“工作”，事实上我不再收到“内部服务器错误”，但我不知道如何记录结果或查看它们（非常感谢有关此 Azure 内容的任何提示）。我开始意识到我还需要在这个应用程序上做多少工作。

```
function dateDiff(date1, date2) 
{
    return date1.getTime() - date2.getTime() / 1000;
}

function insert(item, user, request) {

    request.execute();

    var actionsTable = tables.getTable('BlahActions');

    actionsTable.where(function(currentLat, currentLon, currentTime)
    {
        return (this.Latitude - 0.0001 <= currentLat && this.Latitude + 0.0001 >= currentLat) &&
               (this.Longitude - 0.0001 <= currentLon && this.Longitude + 0.0001 >= currentLon) &&
               (this.TimeStamp == currentTime);
               //(dateDiff(this.TimeStamp, currentTime) <= 5);
    }, item.Latitude, item.Longitude, item.TimeStamp)
    .read(
    {
        success:function(results)
        {
        }
    });
} 
```

使用 getTime() 时，上述脚本的问题是 Azure 呕吐。我需要抓取所有接近相同纬度和经度并且在过去 X 秒内发生的条目（是的，本质上是重新发明“凹凸”）。这是我目前卡住的地方。当/如果我通过这部分时，我会更新。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T19:35:26.130

在这里学到了一些教训。首先，可以通过移动服务根目录顶部的菜单查看日志文件，其中显示“LOGS”...#epicFacePalm。其次，现在我可以从我的 XCode IDE 中看到实际的错误消息，而不是一般的错误消息

*   where 方法的谓词中的 return 语句必须只进行简单的比较——你不能调用另一个方法并检查条件语句中的返回值——这让我很生气。
*   另一个技术细节是将我的 TimeStamp 列从 DateTime 更改为 double ——完全简化了时间戳的减法，无需转换——简单

话虽如此，我现在在 where 方法中有这个

```
 actionsTable.where(function(currentLat, currentLon, currentTime)
    {
        return (this.Latitude - 0.0001 <= currentLat && this.Latitude + 0.0001 >= currentLat) &&
            (this.Longitude - 0.0001 <= currentLon && this.Longitude + 0.0001 >= currentLon) &&
           (currentTime - this.TimeStamp <= 5);
    }, item.Latitude, item.Longitude, item.TimeStamp) 
```

在成功回调中过滤结果之前过滤结果

```
.read(
{
    success:function(results)
    {            
       for (var i = 0; i < results.length; i++)
       {
            var obj = results[i];

            for(var key in obj)
            {
                if (key === "id" && 
                    distance(obj.Longitude, obj.Latitude, item.Longitude, item.Latitude) < 30)
                {                        
                }
            }
       }
    }
} 
```

语法清晰的整个事情

```
function insert(item, user, request) {
request.execute();

var actionsTable = tables.getTable('blahActions');
console.log("Inserting new action '%j'", item);

actionsTable.where(function(currentLat, currentLon, currentTime)
{
    return (this.Latitude - 0.0001 <= currentLat && this.Latitude + 0.0001 >= currentLat) &&
           (this.Longitude - 0.0001 <= currentLon && this.Longitude + 0.0001 >= currentLon) &&
           (currentTime - this.TimeStamp <= 5);
}, item.Latitude, item.Longitude, item.TimeStamp)
.read(
{
    success:function(results)
    {            
       for (var i = 0; i < results.length; i++)
       {
            var obj = results[i];

            for(var key in obj)
            {
                if (key === "id" && 
                    distance(obj.Longitude, obj.Latitude, item.Longitude, item.Latitude) < 30)
                {                        
                }
            }
       }
    }
}); 
```

}

# flume - 无法使用 hdfs 作为水槽中的接收器在 hdfs 目录中获取输出

> ID：14044030
> 
> 赞同：-1
> 
> 时间：2012-12-26T17:36:44.393
> 
> 标签：flume

我正在尝试将普通文本文件提供给水槽，因为源和接收器是 hdfs，源、通道和接收器显示已注册并已启动，但 hdfs 的输出目录中没有任何内容。 ？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T10:11:46.740

水槽 .conf 文件的 Conf 是

```
agent12.sources = source1
agent12.channels = channel1
agent12.sinks = HDFS

agent12.sources.source1.type = exec
agent12.sources.source1.command = tail -F /usr/sap/sample.txt

agent12.sources.source1.channels = channel1
agent12.sinks.HDFS.channels = channel1

agent12.sinks.HDFS.type = hdfs

agent12.sinks.HDFS.hdfs.path= hdfs://172.18.36.248:50070:user/root/xz

agent12.channels.channel1.type =memory
agent12.channels.channel1.capacity = 1000 
```

代理开始使用

```
/usr/bin/flume-ng agent -n agent12 -c usr/lib//flume-ng/conf/sample.conf -f /usr/lib/flume-ng/conf/flume-conf.properties.template 
```

# linux - 将一个文件的内容插入另一个文件（在发送的文件的特定行中）-BASH/LINUX

> ID：14044032
> 
> 赞同：14
> 
> 时间：2012-12-26T17:37:02.630
> 
> 标签：linux, bash, shell

我尝试使用它，`cat`然后在键入我添加的第二个文件后`| head -$line | tail -1`，它不起作用，因为它`cat`首先执行。

有任何想法吗？我需要用`cat`其他东西来做。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-12-26T17:51:37.430

我可能会`sed`用于这项工作：

```
line=3
sed -e "${line}r file2" file1 
```

如果您要覆盖`file1`并且拥有 GNU `sed`，请添加该`-i`选项。否则，写入临时文件，然后将临时文件复制/移动到原始文件上，必要时进行清理（即`trap`下面的内容）。注意：将临时文件复制到文件上会保留链接；移动不会（但更快，尤其是在文件很大的情况下）。

```
line=3
tmp="./sed.$$"
trap "rm -f $tmp; exit 1" 0 1 2 3 13 15
sed -e "${line}r file2" file1 > $tmp
cp $tmp file1
rm -f $tmp
trap 0 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-26T18:19:05.227

只是为了好玩，也只是因为我们都喜欢`ed`标准编辑器，这里有一个`ed`版本。它非常高效（`ed`是一个*真正的*文本编辑器）！

```
ed -s file2 <<< $'3r file1\nw' 
```

如果行号存储在变量中，`line`则：

```
ed -s file2 <<< "${line}r file1"$'\nw' 
```

只是为了取悦 Zack，这是一个较少 bashism 的版本，以防你不喜欢 bash（就我个人而言，我不喜欢管道和 subshel​​ls，我更喜欢 herestrings，但是嘿，正如我所说，这只是为了取悦 Zack）：

```
printf "%s\n" "${line}r file1" w | ed -s file2 
```

或（为了取悦 Sorpigal）：

```
printf "%dr %s\nw" "$line" file1 | ed -s file2 
```

正如 Jonathan Leffler 在评论中提到的那样，如果您打算在脚本中使用此方法，请使用 heredoc（它通常是最有效的）：

```
ed -s file2 <<EOF
${line}r file1
w
EOF 
```

希望这可以帮助！

`ed`PS 如果您觉得需要表达自己关于驾驶方式的标准编辑器，请不要犹豫发表评论。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-26T17:39:54.747

```
cat file1 >>file2 
```

将file1的内容附加到file2。

```
cat file1 file2 
```

将连接 file1 和 file2 并将输出发送到终端。

```
cat file1 file2 >file3 
```

将通过 file1 和 file2 的连接创建或覆盖 file3

```
cat file1 file2 >>file3 
```

将 file1 和 file2 的连接附加到 file3 的末尾。

**编辑**：

对于添加 file1 之前的中继 file2：

```
sed -e '11,$d' -i file2 && cat file1 >>file2 
```

或制作一个 500 行的文件：

```
n=$((500-$(wc -l <file1)))
sed -e "1,${n}d" -i file2 && cat file1 >>file2 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-26T20:21:48.227

有很多方法可以做到，但我喜欢选择一种涉及制作工具的方法。

一、搭建测试环境

```
rm -rf /tmp/test
mkdir /tmp/test
printf '%s\n' {0..9} > /tmp/test/f1
printf '%s\n' {one,two,three,four,five,six,seven,eight,nine,ten} > /tmp/test/f2 
```

现在让我们制作工具，在这第一遍中，我们将糟糕地实现它。

```
# insert contents of file $1 into file $2 at line $3
insert_at () { insert="$1" ; into="$2" ; at="$3" ; { head -n $at "$into" ; ((at++)) ; cat "$insert" ; tail -n +$at "$into" ; } ; } 
```

然后运行该工具以查看惊人的结果。

```
$ insert_at /tmp/test/f1 /tmp/test/f2 5 
```

但是等等，结果在标准输出上！覆盖原来的怎么办？没问题，我们可以为此制作另一个工具。

```
insert_at_replace () { tmp=$(mktemp) ; insert_at "$@" > "$tmp" ; mv "$tmp" "$2" ; } 
```

并运行它

```
$ insert_at_replace /tmp/test/f1 /tmp/test/f2 5
$ cat /tmp/test/f2 
```

“你的实施很糟糕！”

我知道，但这就是制作简单工具的美妙之处。让我们替换`insert_at`为 sed 版本。

```
insert_at () { insert="$1" ; into="$2" ; at="$3" ; sed -e "${at}r ${insert}" "$into" ; } 
```

并`insert_at_replace`继续工作（当然）。的实现`insert_at_replace`也可以更改为减少错误，但我将把它作为练习留给读者。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-07-17T17:25:18.687

如果您不介意管理新文件`head`，我喜欢这样做：`tail`

```
head -n 16 file1 >  file3 &&
cat        file2 >> file3 &&
tail -n+56 file1 >> file3 
```

> 如果你愿意，你可以把它折叠成一行。然后，如果您真的需要它来覆盖 file1，请执行以下操作`mv file3 file1`：（可选地包含`&&`在命令之间）。

笔记：

*   `head -n 16 file1`表示 file1 的前 16 行
*   `tail -n+56 file1`表示 file1 从第 56 行开始到结尾
*   因此，我实际上跳过了 file1 的第 17 行到第 55 行。
*   当然，如果您可以将 56 更改为 17，则不会跳过任何行。
*   我更喜欢混合简单`head`和`tail`命令，然后尝试一个魔术`sed`命令。

# ruby-on-rails - 将 gem 中的 Rake 任务包含到我的引擎中

> ID：14044034
> 
> 赞同：4
> 
> 时间：2012-12-26T17:37:04.530
> 
> 标签：ruby-on-rails, ruby, gem, rake, rails-engines

我正在创建一个 Rails 引擎，我已经在其中编写了一些 rake 任务。我的 rake 任务在 3rd-party gem 中调用 rake 任务，我已将其作为依赖项包含在我的 gemspec 中。

当我尝试运行我的 rake 任务时，它无法说明它无法从 3rd 方 gem 中找到任务。考虑到`Rake -T`我的任务是有道理的，但不是第 3 方的。

如果我在我的应用程序 gemfile 中包含第 3 方 gem，一切都很完美，但我不想这样做。

我猜我需要在我的引擎`rake_tasks do`块中添加另一个包含，但不知道要包含什么。我尝试了多种路径，但似乎都没有奏效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-11-16T10:44:40.880

```
# lib/my_gem.rb
module MyGem
  ROOT_PATH = File.expand_path "../../", __FILE__
  # :: before of the module name it is not to encapsulate the module "My Gem"
  module ::Rails
    class Application
      rake_tasks do
        Dir[File.join(ROOT_PATH, "/lib/tasks/", "**/*.rake")].each do |file|
          load file
        end
      end
    end
  end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-02T18:19:13.460

听起来您的第三方 gem 可能没有设置 railtie。来自 gem 的 rake 任务不会自动包含在 Rails 应用程序中。这里有两个很好的资源可以帮助解释如何设置 Rail tie，您可以从中创建一些代码来手动包含第三方 gem 的 rake 任务：

[包括宝石中的耙任务](https://stackoverflow.com/questions/1878640/including-rake-tasks-in-gems)

[http://blog.nathanhumbert.com/2010/02/rails-3-loading-rake-tasks-from-gem.html](http://blog.nathanhumbert.com/2010/02/rails-3-loading-rake-tasks-from-gem.html)

# c# - 如何在 ASP.NET MVC4 中渲染特定模型的视图？

> ID：14044035
> 
> 赞同：3
> 
> 时间：2012-12-26T17:37:04.310
> 
> 标签：c#, asp.net, asp.net-mvc, razor, asp.net-mvc-4

我正在学习 ASP.NET MVC4，这是我在 Web 开发中的第一次体验。

我正在处理一种情况。在我的一个控制器中，我将 a 返回`IEnumerable<BaseClass>`到视图。

```
public class TestController : Controller
{
    public ActionResult Index()
    {
        return View(Models);
    }

    // this static method is just for demo
    static List<BaseModel> Models()
    {
        ...
    }
} 
```

现在想象一下，我们在 BaseModels 中有 6 个具体的类。

```
public class ConcreteModel1 : BaseModel { .. }  // Must show view1
public class ConcreteModel2 : BaseModel { .. }  // Must show view2
public class ConcreteModel3 : BaseModel { .. }  // and so on..
public class ConcreteModel4 : BaseModel { .. }
public class ConcreteModel5 : BaseModel { .. }
public class ConcreteModel6 : BaseModel { .. } 
```

当我想显示数据时，每个`ConcrenteModel`都有自己的`View`. 如下图所示。

![在此处输入图像描述](../Images/2f194ecb2663dd4ff6a260f068b5308e.png)

我怎样才能做到这一点？如果我不是很清楚，请告诉我谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-26T17:56:37.830

这是一个完整的解决方案：

## 楷模

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;

namespace MvcApplication1.Models
{
    public abstract class BaseModel
    {
        public string Content { get; set; }
    }

    public class ConcreteModel1 : BaseModel { }
    public class ConcreteModel2 : BaseModel { }
    public class ConcreteModel3 : BaseModel { }
} 
```

## 复合视图

```
@model System.Collections.Generic.List<MvcApplication1.Models.BaseModel>
@{
    ViewBag.Title = "CompositeView";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<h2>
    CompositeView</h2>
@foreach (var model in Model)
{
    Html.RenderPartial(string.Format("_{0}", model.GetType().Name), model);
} 
```

## 具体视图

### _ConcreteModel1.cshtml

```
@model MvcApplication1.Models.ConcreteModel1

<h1>Concrete Model 1</h1>
@Model.Content 
```

### _ConcreteModel2.cshtml

```
@model MvcApplication1.Models.ConcreteModel2

<h1>Concrete Model 2</h1>
@Model.Content 
```

### _ConcreteModel3.cshtml

```
@model MvcApplication1.Models.ConcreteModel3

<h1>Concrete Model 3</h1>
@Model.Content 
```

## 控制器

```
public ActionResult CompositeView()
{
    List<BaseModel> model = new List<BaseModel>();
    model.Add(new ConcreteModel1() { Content = "This is model 1." });
    model.Add(new ConcreteModel2() { Content = "This is model 2." });
    model.Add(new ConcreteModel3() { Content = "This is model 3." });

    return View(model);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-26T17:44:04.823

您可以有一个复合视图，`TestView`然后为每个较小的视图渲染部分视图。为了实现这一点，需要从传递给复合视图的模型中获得较小视图的模型。

像这样的东西：（TestView.cshtml）

```
@model ParentViewModel

@Html.RenderPartial("View1", Model.SubModel1)
@Html.RenderPartial("View2", Model.SubModel2)
@Html.RenderPartial("View3", Model.SubModel3) 
```

然后您有单独的视图，例如：（View1.cshtml）

```
@model SubViewModel1

<!-- Whatever --> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T17:53:00.543

我实际上会创建一个自定义模型，其内容是您的`IEnumerable<BaseModel>`，它有自己的内置方法，用于按类型检索特定模型。这样，您可以渲染部分视图并将`ConcreteModel`正确输入的特定类型发送到其中。也许是这样的：

```
public class UltraModel
{
    // I recommend using an interface rather than a base class
    // to avoid potentially confusing types
    public IBaseModel Models { get; set; }

    public T getModelByType<T>()
    {
        return (T)Models.Where(x => x is T).FirstOrDefault();
    }
} 
```

然后在您的全局视图中，您可以使用以下方式渲染部分：

```
RenderPartial("ConcreteViewName", Model.getModelByType<ConcreteModel1>()); 
```

*注意：将以上内容视为伪代码。它可能需要进行调整才能正常工作。*

# c - 找到最长的非递减子序列

> ID：14044036
> 
> 赞同：2
> 
> 时间：2012-12-26T17:37:16.370
> 
> 标签：c, sequence

给定一个字符串只包含 0 和 1 说**10101**
如何找到最长的非递减子序列的长度？
例如，

> 对于字符串，
> 10101

最长的非递减子序列是

*   111
*   001
    所以你应该输出 3

> 对于字符串
> 101001

最长的非递减子序列是

*   0001

所以你应该输出 4
如何找到这个？

> > 当我们受到限制时，如何做到这一点。**限制之间的序列**
> > 例如
> > 101001
> > 限制 [3,6]
> > 最长的非递减子序列是
> > 
> > *   001
> >     所以你应该输出 3

**这可以在 o(strlen) 中实现吗**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T17:58:25.413

使用[动态规划](http://en.wikipedia.org/wiki/Dynamic_programming)。从左到右遍历字符串，并跟踪两个变量：

*   `zero`: 以 0 结尾的最长子序列的长度
*   `one`: 以 1 结尾的最长子序列的长度

如果我们看到一个 0，我们可以将它附加到任何以 0 结尾的前缀，所以我们增加`zero`. 如果我们看到一个 1，我们可以将它附加到以 0 或 1 结尾的前缀上，因此我们设置`one`最长的那个。在 C99 中：

```
int max(int a, int b) {
  return a > b ? a : b;
}

int longest(char *string) {
  int zero = 0;
  int one = 0;
  for (; *string; ++string) {
    switch (*string) {
      case '0':
        ++zero;
        break;
      case '1':
        one = max(zero, one) + 1;
        break;
    }
  }
  return max(zero, one);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T17:52:24.257

> 这可以实现`O(strlen)`吗？

是的。观察到非递减子序列将具有以下三种形式之一：

```
0........0 // Only zeros
1........1 // Only ones
0...01...1 // Some zeros followed by some ones 
```

前两种形式可以很容易地`O(1)`通过计数全零和计数全1来签入。

最后一个有点难：你需要遍历字符串，保持你到目前为止看到的零计数器，以及你`0...01...1`迄今为止发现的最长形式字符串的长度。在您在字符串中看到的每一步，`1`第三种形式的最长子序列的长度是零的数量加 1 或`0...01...1`您迄今为止看到的最长序列加 1 中的较大者。

以下是上述方法在 C 中的实现：

```
char *str = "10101001";
int longest0=0, longest1=0;
for (char *p = str ; *p ; p++) {
    if (*p == '0') {
        longest0++;
    } else { // *p must be 1
        longest1 = max(longest0, longest1)+1;
    }
}
printf("%d\n", max(longest0, longest1)); 
```

`max`定义如下：

```
#define max( a, b ) ( ((a) > (b)) ? (a) : (b) ) 
```

这是[ideone 上演示的链接](http://ideone.com/aQVmGx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T18:07:56.203

```
do {
    count++;
    if (array[i] < prev) {
        if (count > max)
            max = count;
        count = 0;
    }
    prev = array[i];
} while (++i < length); 
```

单程。甚至可以处理任何数字，而不仅仅是 1 和 0。

对于限制 - 设置`i`为起始编号，使用结束而不是数组长度。

# matlab - MATLAB 如何对这些 for 循环进行矢量化？

> ID：14044037
> 
> 赞同：2
> 
> 时间：2012-12-26T17:37:16.483
> 
> 标签：matlab, vectorization

我搜索了很多，但没有找到任何解决我的问题的方法，你能帮我矢量化（或者只是一种让它更快的方法）这些循环吗？

```
% n is the size of C
h = 1/(n-1)
dt = 1e-6;
a = 1e-2;

F=zeros(n,n);
F2=zeros(n,n);
C2=zeros(n,n);

t = 0.0;

for iter=1:12000

    F2=F.^3-F;
    for i=1:n
        for j=1:n
             F2(i,j)=F2(i,j)-(C(ij(i-1),j)+C(ij(i+1),j)+C(i,ij(j-1))+C(i,ij(j+1))-4*C(i,j)).*(a.^2)./(h.^2);
        end
    end
    F=F2;
    for i=1:n
        for j=1:n
            C2(i,j)=C(i,j)+(F(ij(i-1),j)+F(ij(i+1),j)+F(i,ij(j-1))+F(i,ij(j+1))-4*F(i,j)).*dt./(h^2);
        end
    end
    C=C2;
    t = t + dt;

end

function i=ij(i) %Just to have a matrix as loop (the n+1 th cases are the 1 th and 0 the 0th are nth)
if i==0
    i=n;
    return 
elseif i==n+1
    i=1;
end 
return 
end 
```

多谢

编辑：找到答案，这太荒谬了，我搜索得太远了

```
%n is still the size of C
h = 1/((n-1))
dt = 1e-6;
a = 1e-2;

F=zeros(n,n);
var1=(a^2)/(h^2); %to make a bit less calculus
var2=dt/(h^2); % the same

t = 0.0;

for iter=1:12000

    F=C.^3-C-var1*(C([n 1:n-1],1:n) + C([2:n 1], 1:n) + C(1:n, [n 1:n-1]) + C(1:n, [2:n 1]) - 4*C);
    C = C + var2*(F([n 1:n-1], 1:n) + F([2:n 1], 1:n) + F(1:n, [n 1:n-1]) + F(1:n,[2:n 1]) - 4*F);
    t = t + dt;

end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T19:12:56.530

找到了答案，这太荒谬了，我搜索得太远了

```
%n is still the size of C
h = 1/((n-1))
dt = 1e-6;
a = 1e-2;

F=zeros(n,n);
var1=(a^2)/(h^2); %to make a bit less calculus
var2=dt/(h^2); % the same

prev = [n 1:n-1];
next = [2:n 1];

t = 0.0;

for iter=1:12000

    F = C.*C.*C - C - var1*(C(:,next)+C(:,prev)+C(next,:)+C(prev,:)-4*C);
    C = C + var2*(F(:,next)+F(:,prev)+F(next,:)+F(prev,:)-4*F);
    t = t + dt;

end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T17:43:09.300

内部循环的行为看起来像一个二维循环卷积。这与 FFT 域中的乘法相同。减法在 FFT 等线性运算中是不变的。

您将需要使用`fft2`and`ifft2`函数。

一旦你这样做了，我想你会发现重复卷积可以通过将卷积核（逐元素）提高到幂来消除`iter`。如果该优化是正确的，我预测将加速 5 个数量级。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T18:03:33.887

例如`C(ij(i-1),j)`，您可以使用`circshift(C,[1,0])`or替换`circshift(C,[1,0])`（我不知道两个中的一个是正确的）

[http://www.mathworks.com/help/matlab/ref/circshift.htm](http://www.mathworks.com/help/matlab/ref/circshift.htm)

# arrays - 回显数组的“部分”（从 JSON 解码）

> ID：14044046
> 
> 赞同：0
> 
> 时间：2012-12-26T17:38:14.877
> 
> 标签：arrays, echo

我对 JSON 和更“高级”的数组很陌生。所以我不知道我应该搜索什么......

我有这个“JSON 数组”（你怎么称呼它？）：

```
{
   "id": "321123321",
   "statuses": {
      "data": [
         {
            "message": "testmessage",
            "updated_time": "2012-12-25T16:33:29+0000",
            "id": "123321123"
         }
      ],
      "paging": {
         "previous": "1",
         "next": "1"
      }
   }
}​ 
```

我想从名为 $message 的“消息”创建一个变量，并从名为 $updated 的“up_datedtime”创建一个变量。

要获得 id 我很简单： $json_a=json_decode($string,true); $id $json_a['id'];

对于状态： $json_a=json_decode($string,true); $status = $json_a['id']['statuses'];

但是当我尝试获取“消息”时，我得到“不能将字符串偏移量用作数组”：$message = $json_a['id']['statuses']['data']['message'];

如何以正确的方式从数组中获取 $message？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T17:47:45.887

你可以这样

```
$message = $json_a['id']['statuses']['data'][0]['message']; 
```

或者你可以从循环中获取

```
$dataArr = $json_a['id']['statuses']['data'];

foreach ($dataArr as $val) {
    echo "message".$val['message'];
} 
```

# javascript - IE 9 渲染但不显示由 MVC 3 生成的 HTML。其他浏览器有

> ID：14044050
> 
> 赞同：0
> 
> 时间：2012-12-26T17:38:45.073
> 
> 标签：javascript, asp.net-mvc-3, firefox, internet-explorer-9

我对此感到非常困惑。我以为这将是一个五分钟的问题，变成了一个三天的问题。

这就是交易。

我有一个 MVC 3 应用程序。它在所有浏览器中都能完美呈现，但 IE 9 根本不显示任何内容。

现在，检查一下。很重要。

当我打开 Firefox (Firebug 1.11.1) 和 IE9 (F12) 的“浏览器调试器”时，我发现了一些奇怪的东西。

检查我的附件...

当我右键单击两个浏览器并询问查看源代码时，我可以在那里看到整个预期的 HTML，但在“调试器”中，IE9 显示主体为空（我猜实际显示的是渲染的最终结果？）。

非常重要，请查看查看源代码截图，这...

```
<!DOCTYPE html>
<!--[if lt IE 8 ]><html lang="en" class="no-js ie ie7"><![endif]-->
<!--[if IE 8 ]><html lang="en" class="no-js ie"><![endif]-->
<!--[if (gt IE 8)|!(IE)]><!--><html lang="en" class="no-js"><!--<![endif]-->
<head>
    <title>LogOn</title>
.....

    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <script type="text/javascript" src="/Scripts/standard.js"></script>
    <!--[if lte IE 8]><script type="text/javascript" src="/Scripts/standard.ie.js"></script><![end if]-->
....

</head> 
```

我什至不知道在这里具体问什么。这些 [if lte...] 语句是否适用于每个浏览器？我不知道这里发生了什么。

有谁曾经走过死亡之谷？？？

谢谢

编辑：

我正在使用我在 themeforest.net 上购买的模板。他们的示例（纯 HTML）在所有浏览器中都能正常工作。当我单击 ViewSource 时，它​​们与我的代码（当然是标题部分）看起来也是一样的。这就是为什么我假设与我如何从 MVC 渲染有关。

![在此处输入图像描述](../Images/b897ed4f7fae6514f44be5079da0b7a3.png) ![在此处输入图像描述](../Images/d4ebc57812fb338708562cfed97c5061.png) ![在此处输入图像描述](../Images/c7bc9632a36978faf9aaf9355a8eae09.png) ![在此处输入图像描述](../Images/887807687e51831a80f6e1ba2a273fa2.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T19:21:40.107

回答我自己的问题......

它与这条线有关

```
<!--[if lte IE 8]><script type="text/javascript" src="@Url.Content("~/Scripts/standard.ie.js")"></script><![endif]--> 
```

它被错误地渲染。现在一切都很好。

# vbscript - VBScript：将精度扩展到 16 位小数以规避科学记数法？

> ID：14044057
> 
> 赞同：1
> 
> 时间：2012-12-26T17:39:23.037
> 
> 标签：vbscript, precision, scientific-notation

我已经搜索了这个答案，但找不到 VBS 的任何内容。

例如：

```
dim num
num = 1234567890123456 'a 16 digit number
msgbox num 
```

以`num`任何方式使用都会导致数字以科学计数法显示。

我怎样才能避免这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T17:42:22.077

如果您不喜欢号码的默认文本表示，请明确请求。

```
msgbox FormatNumber(num, 2) 
```

（[参考](http://msdn.microsoft.com/en-us/library/ws343esk%28v=vs.84%29.aspx)）

[然而，这与数字的实际存储](http://msdn.microsoft.com/en-us/library/9e7a57cf%28v=vs.84%29.aspx)方式无关（作为 a `double`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T17:44:21.437

VBScript将 16 位数字更改为 a `Double`，因为既不`Int`，也不`Long`可以存储该数字。您可以使用[FormatNumber](http://www.devguru.com/technologies/vbscript/quickref/formatnumber.html)函数将其显示为整数：

> FormatNumber（表达式，NumDigitsAfterDecimal，IncludeLeadingDigit，UseParensForNegativeNumbers，GroupDigit）

```
num = 1234567890123456
msgbox FormatNumber(num, 0, -2, -2, false) 
```

# actionscript-3 - 如何在actionscript3上使颜色透明

> ID：14044058
> 
> 赞同：0
> 
> 时间：2012-12-26T17:39:29.643
> 
> 标签：actionscript-3, png, transparency

我有一个主要有两种颜色作为背景的png。我想知道 as3 是否提供了选择颜色以使其透明的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T20:46:21.113

一种选择是使用 BitmapData 方法 threshold ：

[http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/BitmapData.html#threshold%28%29](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/BitmapData.html#threshold%28%29)

```
public function threshold(sourceBitmapData:BitmapData, sourceRect:Rectangle, destPoint:Point, operation:String, threshold:uint, color:uint = 0, mask:uint = 0xFFFFFFFF, copySource:Boolean = false):uint 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T17:50:48.443

看一下 BitmapData 类。

您可以[获取](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/BitmapData.html#getPixel%28%29)每个像素的颜色并为其中一些[设置透明度。](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/BitmapData.html#setPixel32%28%29)

# python - NameError：名称“游戏”未定义，但它是

> ID：14044060
> 
> 赞同：1
> 
> 时间：2012-12-26T17:39:36.163
> 
> 标签：python, python-2.7

我正在使用《*Learn python the hard way* 》这本书来学习 python 。我正在做一项练习，其中包含许多 if 循环。我遇到了一个`Game`未定义的错误，但我之前确实定义了它。任何人的想法？

```
from sys import exit

from random import randint

class Game(object):

    def __init__(self, start):
        self.quips = [
             "You died. You kinda suck at this.",
             "Nice job, you died ... jackass.",
             "Such a luser.",
             "I have a small puppy that's better at this."]
        slef.start = start

    def play(self):
        next = self.start

        while True:
            print "\n-------"
            room = getattr(self, next)
            next = room()

    def death(self):
        print self.quips[randint(0, len(quips)-1)]
        exit(1)

    def central_corridor(self):
        print "The Gothons of Planet Percal #25 have invaded your ship and destroyed"
        print "your entire crew. You are the last surviving member and your last"
        print "mission is to get the neutron destrut bomb from the Weapons Armory,"
        print "put it in the bridge, and blow the ship up after getting into an "
        print "escapr pod."
        print "\n"
        print "You're running down the central corridor to the Weapons Armory when"
        print "a Gothon jumps out, red scaly skin, dark grimy teeth, and evil clown costume"
        print "flowing around his hate filled body. He's blocking the door to thr"
        print "Armory and about to pull a weapon to blast you."

        action =raw_input("> ")

        if action == "shoot!":
            print "Quick on the draw you yank out your blaster and fire it at the Gothan."
            print "His clown costume is flowing and moving around his body, which throws"
            print "off your aim. Your laser hits new costume but misses him entirely. This"
            print "completely ruins his brand new costumr his mother bought him, which"
            print " makes him fly into an insane rage and blast you repeatedly in the face until"
            print "you are dead. Then he eats you."
            return 'death'

        elif action =="dodge!":
            print "Like a world class boxer you dodge, weave, slip and slide right"
            print "as the Gothon's blaster cranks a laser past your head."
            print "In the middle of your artful dodge your foot slips and you"
            print "You wake up shortly after only to die as the Gothon stomps on"
            print "your head and eats you."
            return 'death'

        elif action =="tell a joke":
            print "Lucky for you they made you learn Fothon insults in the acsdemy."
            print "You tell teh one Gothon k=joke you know:"
            print "Lbhe zbgure vf fb sng, jura fur fvgf nebhag gur ubhfr, fur fvgf nrbhaq"
            print "The Gothon stops, tries not to laugh, then busts out laughing and can't"
            print "While he's laughing you run up and shoot him square in the head"
            print "putting hm down, then jump through the Weapon Armory door."
            return 'laser_weapon_asmory'

        else:
            print "DOES NOT COMPUTE!"
            return 'central_corridor'

    def laser_weapon_armory(self):
        print " You do a dive roll into the Weapon Armory, crough and scan the room"
        print "for more Gothans that might be hiding. It's dead quiet, too quiet."
        print "You stand up and run to the far side of the room and find the"
        print "neutron bomb in its container. There's a keypad lock on the code"
        print "and you need the code to get the bomb out. If you get the code"
        print "wrong 10 times then the lock closes forever and you can't"
        print "get the bomb. The code is 3 digits."
        code = "%d%d%d" % (randint(1,9), randint(1,9), randint(1,9))
        guess = raw_input("[keypad]> ")
        guesses = 0

        while guess != code and guesses < 10:
            print "BZZZZEDDD!"
            guesses += 1
            guess = raw_input("[keypad]> ")

        if guess == code:
            print "The container clicks open and the seal breaks, letting gas out."
            print "You grab the neutron bomb and run as fast as you can to the"
            print "bridge where you must place it in the right spot."
            return 'the_bridge'

        else:
            print "The lock buzzes one last time and then you hear s sickening"
            print "melting sound as teh mechanism is fused together."
            print "You decide to sit there, and finally the Gothons blow up the"
            return 'death'

    def the_bridge(self):
        print "You burst onto the Brisge with the netron destruct bomb"
        print "under your arm and surprise 5 Gothon who are trying to"
        print "take control of the ship. Each of them has an even uglier"
        print "clown costume than the last. They haven't pulled their"
        print "weapons out yet, as they see the active bomb under your"
        print "arm and don't want to see it off."

        action = raw_input("> ")

        if action == "throw the bomb":
            print "In a panic you throw the bomb at the group of Gothons"
            print "and make a leap for the door. Right as you drop it a"
            print "Gothon shoots you right in the back kiling you."
            print "As you die you see another Gothon frantically try to disarm"
            print "the bomb. You die knowing they will probably blow up when"
            print "it goes off."
            return 'death'

        elif action == "slowly place the bomb":
            print "You point your blaster at teh bomb under your arm"
            print "and the Gothons put their hand up and start to sweat."
            print "You inch backwark to the door, open it, and then carefully"
            print "place the bomb on the floor, pointing your blaster at it."
            print "You then jump back through the door, punch the close button"
            print "and blast the lock so the Gothons can't get out."
            print "Now that the bomb is placed you run to the escape pod to"
            print "get off this tin can."
            return 'escapr_pod'
        else:
            print "DOES NOT COMPUTE!"
            return "the_brigde"

    def escape_pad(self):
        print "You rush through the ship desperately trying to make it to"
        print "the escape pod before the whole ship explodes. It seemd like"
        print "hardly any Gothons are on the ship, so your run is clear of"
        print "interference. YOu get to the chamber with the excape pod, and"
        print "now need to pick one to take. Some of them could be damaged"
        print "but you don't have time to look. There's 5 pots, which one"
        print "do you take?"

        good_pod = randint(1,5)
        guess = raw_input("[pod #]> ")

        if int(guess) != good_pod:
            print "You jump into pod %s and hit the eject button." % guess
            print "The pod escaped out into the void of space, then"
            print "implodes as the hull ruptures, crushing your body"
            print "into jam jelly."
        else:
            print "You jump into pod %s and hit the eject button." % guess
            print "The pod eadily slides out into space heading to"
            print "the planet below. As it flies to the planet, you look"
            print "back and see your ship implode then explode like a"
            print "bright star, taking out the Gothon ship at the same"
            print "time. You won!"
            exit(0)

    a_game = Game("central_corridor")
    a_game.play() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T17:48:56.840

我认为这是缩进错误的结果。在您发布的代码中，您有

```
class Game(object):

    def __init__(self, start):

    [...]

            print "time. You won!"
            exit(0)

    a_game = Game("central_corridor")
    a_game.play() 
```

这样您就可以在类`a_game` *内部*`Game`进行定义，何时`Game`尚未定义。将其向左移动以将其移出`Game`范围，即

```
a_game = Game("central_corridor")
a_game.play() 
```

（与 同级`class Game(object):`）。

# java - Java Runtime#halt() 不会停止 JVM

> ID：14044061
> 
> 赞同：2
> 
> 时间：2012-12-26T17:39:45.320
> 
> 标签：java, halt

这是一个使用 RMI 的客户端/服务器应用程序。一旦服务器收到一个用于destroy() 的RMI 请求——我需要中止VM。我正在`Runtime.getRuntime().halt(0)`为此目的使用。但是在调用 halt() 之后，VM 仍然存在，我可以杀死它的唯一方法是`Force Kill`在 OSX 上使用。

调用线程的堆栈跟踪如下：

```
"RMI TCP Connection(3)-192.168.1.4" daemon prio=5 tid=7f99a7103000 nid=0x11d467000 runnable [11d464000]
   java.lang.Thread.State: RUNNABLE
    at java.lang.Shutdown.halt0(Native Method)
    at java.lang.Shutdown.halt(Shutdown.java:95)
    - locked <7f44c90d0> (a java.lang.Shutdown$Lock)
    at java.lang.Runtime.halt(Runtime.java:256)
    at net.sourceforge.marathon.runtime.JavaRuntime.destroy(JavaRuntime.java:178)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at net.sourceforge.rmilite.impl.RemoteInvocationHandlerImpl.invoke(RemoteInvocationHandlerImpl.java:70)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:303)
    at sun.rmi.transport.Transport$1.run(Transport.java:159)
    at java.security.AccessController.doPrivileged(Native Method)
    at sun.rmi.transport.Transport.serviceCall(Transport.java:155)
    at sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:535)
    at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:790)
    at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:649)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
    at java.lang.Thread.run(Thread.java:680) 
```

可能是什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T07:34:24.570

我尝试了多种方法来完成这项工作。

1.  添加`Runtime#runFinalization`在调用 halt() 之前
2.  调用`halt()`于`SwingUtilities.invokeAndWait`
3.  调用`halt()`于`SwingUtilities.invokeLater`

这些都不起作用。最后，

1.  `halt()`使用在计时器任务中调用`Timer#schedule`

这有效并且一直有效到现在。感谢大家的回复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-03T10:17:04.393

当您收到 destroy() 命令时，您应该：

1.  取消导出所有远程对象。
2.  取消导出任何注册表。
3.  清除对远程对象和注册表的任何静态引用。

然后 JVM 将自动退出，除非您有任何非守护线程正在执行。

# javascript - 使用 require.js 和 jasmine 模拟 Google 地球事件

> ID：14044064
> 
> 赞同：0
> 
> 时间：2012-12-26T17:39:52.890
> 
> 标签：javascript, requirejs, jasmine, google-earth

我有以下模块，但在我的茉莉花测试期间（即 - 在我的测试工具内部）设置它以进行模拟时遇到困难。特别是，我想知道我将/应该如何在测试工具的上下文中替换 async!https://www.google.com/jsapi 调用（或硬编码的 url 引用），以及哪些事件我是否会在“google.load”和“google.earth.createInstance”的测试中进行spyOn，以便在我的测试中正确触发回调？在下面的示例代码中， uiSelector 参数将是加载地球地图的 div id。

在此先感谢您的时间。

```
define('googleearthloader',
[ "async!https://www.google.com/jsapi" ],
function() {

return {
        init: function(uiSelector, callbackSuccess,callbackError) {
            google.load("earth", "1", { 'callback': function() { google.earth.createInstance(uiSelector, callbackSuccess, callbackError); } });
            }

       };

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T18:18:11.513

你可以这样做：

```
var spy = sinon.stub(google, 'load');
.....your init call
expect(spy).toHaveBeenCalledWith("earth1", "1"); 
```

你可以用这个间谍存根调用来测试你想要的东西。

# r - 将 x 轴对齐到绘图以与网格保持一致

> ID：14044066
> 
> 赞同：1
> 
> 时间：2012-12-26T17:39:54.437
> 
> 标签：r, csv, histogram

我正在尝试使用[此处](http://exoplanet.eu/catalog/?f=%22radial%22%20IN%20detection)提供的数据构建直方图。我正在使用该数据库的 CSV 版本来显示每年发现的外植体数量。一个简单的脚本是

```
bulkdata <- read.csv('file.csv',head=1,sep=',')
pdf(file="yearcount.pdf",family="Times")
bins <- seq(min(bulkdata$discovered,na.rm=T),max(bulkdata$discovered,na.rm=T),by=1)
hist(bulkdata$discovered,breaks=bins,col='gray',ylab="Discovered",xlab="Year",main="",ylim=c(0,100),axes=FALSE)
axis(1, at=seq(1989,2012,by=1))
axis(2, at=seq(0,100,by=10))
grid(nx=10)
hist(bulkdata$discovered,breaks=bins,col='gray',ylab="Discovered",xlab="Year",main="", add=TRUE)
dev.off() 
```

问题是与 的点`xaxis` **不**对齐。这是一个问题，因为绘制的线*没有任何意义*，因为它们没有与刻度对齐！我尝试添加更正选项，但这样轴被正确*绘制*，但网格从轴*下方*开始。也许需要一个非标准包？`0``yaxis``grid()` *`axis(1, at=seq(1989,2012,by=1))``line=-1`*

 **** * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T17:48:05.063

`?grid`说：

> 如果需要更多的微调，直接使用'abline(h = ., v = .)'。

所以这里有一个建议：

```
par(las=1,bty="l")
h <- hist(bulkdata$discovered,breaks=bins,
     col='gray',ylab="Discovered",xlab="Year",main="",
     ylim=c(0,100),axes=FALSE)
yrs <- 1989:2012
yvals <- seq(0,100,by=10)
axis(1, at=yrs)
axis(2, at=yvals)
abline(h=yvals,v=yrs,col="gray",lty=3)
hist(bulkdata$discovered,breaks=bins,
     col='gray',ylab="Discovered",xlab="Year",main="", add=TRUE) 
```

我会考虑让网格线稍微稀疏一点（例如每 5 年一次？）

![在此处输入图像描述](../Images/7a8bc33c9e82815a4a96b7f77859f744.png)***

# jquery - jquery查找动态创建的Id和wireup函数

> ID：14044070
> 
> 赞同：1
> 
> 时间：2012-12-26T17:40:15.867
> 
> 标签：jquery, .net

我有一个 jquery 函数来按 id 展开和折叠 div：

```
<script type="text/javascript">
$(function(){
    $('#mySlideContent').css('display','none');
    $('#mySlideToggler').click(function(){
        $('#mySlideContent').slideToggle('fast');
        return false;
    });
});
</script> 
```

我想要多个 slideContent div，每个都连接到各自的 slideToggler div。然而，slideContent 和 slideToggler div 的数量是在页面上动态创建的，并带有“for each”，如下所示。

```
<% For Each c In Contacts%>
    <li id="grid_<%= c.ContactId %>" class="grid">
        <div class="inner">
            <div class="col">
                <div id="mySlideToggler">
                    <label>Name</label> 
                </div>
                <div id="mySlideContent" class="col-inner">
                    <%= c.Name%>
                </div>
            </div>
        </div>
    </li>
<%Next%> 
```

如何传入我的 div 的动态创建的 id，以便我可以重用我的函数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T17:47:06.920

您的 .net 代码会创建无效的 html，因为它会创建多个具有相同`mySlideToggler`和`mySlideContent`id 的元素..（*并且 id 必须是唯一的*）

如果您将其更改为创建有效的 html（*改用类*）

```
<% For Each c In Contacts%>
    <li id="grid_<%= c.ContactId %>" class="grid">
        <div class="inner">
            <div class="col">
                <div class="mySlideToggler">
                    <label>Name</label> 
                </div>
                <div class="col-inner mySlideContent">
                    <%= c.Name%>
                </div>
            </div>
        </div>
    </li>
<%Next%> 
```

然后使用脚本

```
<script type="text/javascript">
$(function(){
    $('.mySlideContent').hide();
    $('.mySlideToggler').click(function(){
        $(this).next().slideToggle('fast');
        return false;
    });
});
</script> 
```

# sorting - 在 Elastic 中对结果进行排序

> ID：14044074
> 
> 赞同：0
> 
> 时间：2012-12-26T17:40:35.010
> 
> 标签：sorting, elasticsearch

现在尝试对查询结果进行排序。以下查询均无效：

```
{
  "sort": [
    {
      "name": {
        "order": "asc"
      }
    }
  ],
  "query": {
    "match_all": {}
  }
}

{
  "query": {
    "match_all": {}
  },
  "sort": [
    {
      "name": {
        "order": "asc"
      }
    }
  ]
} 
```

[根据（文档](http://www.elasticsearch.org/guide/reference/api/search/sort.html)），即使它们似乎是有效的。我在这里想念什么？顺便说一句，查询部分的顺序在 Elastic 中是否重要？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-27T10:11:53.390

我遇到了同样的情况。如果您的姓名字段映射为字符串并进行了分析，那么查询将永远无法正常工作。使用多字段类型，您可以在其中映射名称两次，一次为字符串并已分析，另一次为字符串且未分析。对于前

```
'user_id' =>array('type'=>'integer'),
'name' =>array(
     'type'=>'multi_field',
     'fields'=>array(
          'name'=>array('type'=>'string','index'=>'analyzed'),
          'sort_name'=>array('type'=>'string','index'=> 'not_analyzed')
      )
   ) 
```

使用上面的映射，您可以搜索名称字段，您可以使用 sort_name 进行排序。

```
{
 'query': {
  'query_string':{'query':'user_name*','fields':['name']}
  },
  'sort':[
  {
    'name.sort_name': {
    'order': 'asc'
    }
  }
  ]
} 
```

参考链接：1) [http://awesomism.co.uk/536336#](http://awesomism.co.uk/536336#) 2) [http://blog.wiercinski.net/2011/uncategorized/elasticsearch-sorting-on-string-types-with-more-than-one -每个文档的值或每个字段的多个令牌/](http://blog.wiercinski.net/2011/uncategorized/elasticsearch-sorting-on-string-types-with-more-than-one-value-per-doc-or-more-than-one-token-per-field/)

# java - Selenium：如何使用相同的类名选择第 n 个按钮

> ID：14044075
> 
> 赞同：2
> 
> 时间：2012-12-26T17:40:34.200
> 
> 标签：java, selenium, screen-scraping

我正在尝试使用 css 类“btnProceed”选择第三个按钮

```
 <input type="button" class="btnProceed" value=" " onclick="SecuritySubmit(false,'https://somewebsite.com/key=xxyyzz');return false;"> 
```

我的代码如下：

```
 WebElement query_enquirymode = driver.findElement(By.className("btnProceed"));
    query_enquirymode.click(); 
```

我只能使用“btnProceed”选择第一个元素

有没有办法选择第三个按钮？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-26T17:43:15.730

像这样：

```
List<WebElement> buttons = driver.findElements(By.className("btnProceed"));
WebElement query_enquirymode = buttons.get(2);
query_enquirymode.click(); 
```

# java - 用于渲染 OpenGL VBO 的 for 循环

> ID：14044076
> 
> 赞同：0
> 
> 时间：2012-12-26T17:40:35.867
> 
> 标签：java, opengl, game-engine, vbo

我已经设法使用 VBO 在 OpenGL 中渲染了一个立方体。我的下一个目标实际上是创建一个 for 循环来创建多个立方体。不过，我被困在这一部分上，我是否输入了以下代码：

```
GL11.glEnableClientState(GL11.GL_VERTEX_ARRAY);
    ARBVertexBufferObject.glBindBufferARB(ARBVertexBufferObject.GL_ARRAY_BUFFER_ARB, vertexBufferID);
    GL11.glVertexPointer(3, GL11.GL_FLOAT, 0, 0);
    GL11.glDrawArrays(GL11.GL_QUADS, 0, 24);
    GL11.glDisableClientState(GL11.GL_VERTEX_ARRAY); 
```

进入for循环？我不是必须使用某种 glPopMatrix 命令和翻译功能吗？我几乎不明白如何在 VBO 中创建一个立方体，如果它明显出了什么问题，我很抱歉。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T18:20:15.643

您可以使用以下方式：

```
GL11.glEnableClientState(GL11.GL_VERTEX_ARRAY);
ARBVertexBufferObject.glBindBufferARB(ARBVertexBufferObject.GL_ARRAY_BUFFER_ARB, vertexBufferID);
GL11.glVertexPointer(3, GL11.GL_FLOAT, 0, 0);

for (int i = 0; i < cubeCount; i++) {
  GL11.glPushMatrix();
  // do translation/rotation for cube no i
  GL11.glDrawArrays(GL11.GL_QUADS, 0, 24);
  GL11.glPopMatrix();
}

GL11.glDisableClientState(GL11.GL_VERTEX_ARRAY); 
```

请注意`glPushMatrix`/`glPopMatrix`方式在较新的 openGl 版本中已被弃用。对您来说，它应该可以工作，因为您正在使用`GL11`.

# iphone - 防止 UINavigationController 中的 UIBarButtonItem 动画

> ID：14044079
> 
> 赞同：0
> 
> 时间：2012-12-26T17:40:46.777
> 
> 标签：iphone, objective-c, ipad

我正在使用一个很好的自定义转换，使用我在此处阅读的类别：

[更改 UINavigationController 动画样式](http://www.davidhamrick.com/2011/12/31/Changing-the-UINavigationController-animation-style.html)

这很棒，但是当我按下后退按钮时，后退按钮会动画向右滑动和淡出。

我根本不希望它动画。我看到了该属性`popNavigationItemAnimated`，但似乎无法使其正常工作。

有人有办法做到这一点吗？

# python - 两次反转字典时没有得到相同的结果

> ID：14044080
> 
> 赞同：2
> 
> 时间：2012-12-26T17:40:46.407
> 
> 标签：python, dictionary

我正在尝试反转一个简单的字典，例如：

```
{'a' : 1, 'b' : 2, 'c' : 3, 'd' : 4} 
```

我正在使用这个功能：

```
def invert(d):
    return dict([(x,y) for y,x in d.iteritems()]) 
```

现在，当我翻转字典时，一切正常。但是，当我将其反转两次时，我得到：

```
{'a': 1, 'c': 3, 'b': 2, 'd': 4} 
```

这与我开始使用的字典的顺序不同。我的反转功能有问题吗？抱歉，我对python有点陌生，但感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T17:41:50.587

没错，字典在python中是无序的

从[另一个所以回答](https://stackoverflow.com/questions/2928686/how-to-print-unsorted-dictionary-in-python)答案：

> CPython 实现细节：键和值以非随机的任意顺序列出，因 Python 实现而异，并且取决于字典的插入和删除历史。

来自[文档](http://docs.python.org/2/tutorial/datastructures.html#dictionaries)：

> 最好将字典视为一组无序的键：值对，并要求键是唯一的（在一个字典中）。一对大括号创建一个空字典：{}。在大括号内放置一个逗号分隔的键：值对列表，将初始键：值对添加到字典中；这也是在输出上编写字典的方式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-26T17:42:38.140

Python 字典没有按设计排序。

`collections.OrderedDict`如果你真的需要这种行为，你可以改用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-26T17:45:16.073

尝试运行此代码：

```
d = {
    'a' : 1, 'b' : 2, 
    'c' : 3, 'd' : 4
}

def invert(d):
    return dict([(x,y) for y,x in d.iteritems()])

print d

d = invert(d)

print d

d = invert(d)

print d 
```

这是输出：

```
{'a'：1，'c'：3，'b'：2，'d'：4}
{1：'a'，2：'b'，3：'c'，4：'d'}
{'a'：1，'c'：3，'b'：2，'d'：4}

```

如您所见，从技术上讲，它*是*同一个字典，但是当您声明它时，它是无序的。

# java - SQLite 多个连接。爪哇

> ID：14044083
> 
> 赞同：2
> 
> 时间：2012-12-26T17:40:50.643
> 
> 标签：java, multithreading, sqlite

我目前在服务器端的 Java 聊天应用程序中使用 SQLite，当我使用一个连接时一切正常，但是因为在服务器端我有很多线程我想使用连接池。这样做的问题是数据库在更新后被锁定，并且不能被来自另一个线程的任何其他连接访问。临时我将池中的连接限制为 1。有没有办法让 SQLite 在 Java 中处理多个连接。我正在使用 JDBC 驱动程序`org.sqlite.JDBC`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T18:20:52.673

看[这里](https://stackoverflow.com/questions/10707434/sqlite-in-a-multithreaded-java-application)

您可以选择 H2 数据库，它可以作为嵌入式数据库（如 SQLLite）运行，但支持良好的多线程和客户端/服务器通信。

# r - 绑定两个数据框

> ID：14044085
> 
> 赞同：0
> 
> 时间：2012-12-26T17:40:59.680
> 
> 标签：r

我正在尝试合并我拥有的两个数据框，另一个是从 1 到 6 (A) 的一长串数字，另一个是具有数字 1 到 6 的向量并为每个数字命名 (B)。如何将 B 合并到 A 以便 A 中的数字列表将具有 B 中相应数字的名称？

最好的问候， Hlynur T

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T18:32:06.477

如果这复制了您的情况，那么`merge`答案是：

```
 dfB <- data.frame(numb = 1:6, nams = LETTERS[1:6])
 dfA <- data.frame(nums = sample(1:6, 30, repl=TRUE))
 merge(dfA, dfB, by.x="nums", by.y="numb") 
```

（过去这个问题已经被问过很多次了。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T18:23:25.890

使用匹配（）。假设您有以下两个数据框：

```
A <- data.frame(num=sample(1:6,100,replace=TRUE))
B <- data.frame(num=1:6,myname=letters[1:6]) 
```

然后为数据框 A 创建一个新列“myname”：

```
A[,'myname'] <- B[match(A[,'num'],B[,'num']),'myname'] 
```

正如其他人所提到的，如果您使用 rownames() 而不是为名称创建列，情况会发生轻微变化，但是无论具体情况如何，这种一般构造都应该进行一些调整。

# jsf - JSF facelet 应用程序在 jboss AS 7 中不起作用

> ID：14044087
> 
> 赞同：2
> 
> 时间：2012-12-26T17:41:05.730
> 
> 标签：jsf, jsf-2, jboss7.x

我正在尝试在我的 Windows 7 机器上为 Java/JSF 应用程序设置环境。我正在使用 eclipse juno 和从 eclipse 市场下载的 Jboss AS 7。我也在使用JDK 1.7。我创建了一个非常简单的应用程序，其中仅包含 ah:outputLabel 标记。在部署和运行之前，一切看起来都很好，但是标签没有呈现。我的意思是我得到一个空白页。我为 JSF 包含的 jar 包是：jsf-api-2.1、jsf-impl-2.1.0-b03.jar、jsf-facelets-1.1.14.jar。还有通常的公地和 jstl 罐子。

没有错误或任何异常。我在这里错过了什么吗？如果它太简单，请原谅我，但这只是花费太多时间。

编辑：我自动创建的 faces-config xml：

```
<?xml version="1.0" encoding="UTF-8"?>

   <faces-config
    xmlns="http://java.sun.com/xml/ns/javaee"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://java.sun.com/xml/ns/javaee         http://java.sun.com/xml/ns/javaee/web-facesconfig_2_0.xsd"
version="2.0">

</faces-config> 
```

我的网络 xml：

```
 <?xml version="1.0"?>
<web-app version="3.0" xmlns="http://java.sun.com/xml/ns/javaee"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"     xsi:schemaLocation="http://java.sun.com/xml/ns/javaee     http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd">
    <display-name>test</display-name>
   <welcome-file-list>
   <welcome-file>NewFile.xhtml</welcome-file>
   </welcome-file-list>
 <servlet>
 <servlet-name>Faces Servlet</servlet-name>
 <servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
 <load-on-startup>1</load-on-startup>
</servlet>
<servlet-mapping>
 <servlet-name>Faces Servlet</servlet-name>
    <url-pattern>*.jsf</url-pattern>
</servlet-mapping>
<servlet-mapping>
 <servlet-name>Faces Servlet</servlet-name>
 <url-pattern>*.faces</url-pattern>
</servlet-mapping>
<servlet-mapping>
 <servlet-name>Faces Servlet</servlet-name>
  <url-pattern>/faces/*</url-pattern>
</servlet-mapping>
 </web-app> 
```

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-26T20:40:53.470

> 我为 JSF 包含的 jar 包是：jsf-api-2.1、jsf-impl-2.1.0-b03.jar、jsf-facelets-1.1.14.jar。还有通常的公地和 jstl 罐子。

这里有很多错误。首先，您不需要甚至不应该包含 JSF jar。这些已经是由 JBoss AS 7 实现的 Java EE 的一部分。

其次，您绝对不需要也绝对不应该将单独的 Facelets jar 与 JSF 2.x 结合使用。Facelets 已经是 JSF 2.x 的一部分。

您也不应该包含 JSTL jar。Java EE/Jboss AS 也提供了那个。如果使用 commons jars 你的意思是 Apache commons，那么这些都很好，但 JSF 不需要它们。仅当您想在应用程序代码中直接使用它们时才包含它们。

如果您需要这些罐子中的任何一个（您不需要，但假设），如果您刚刚开始，最好采用最新的罐子。从版本号来看，您似乎只是随机选择了一个旧版本。但同样，您不需要任何这些罐子。它们由 Java EE/JBoss AS 7 提供。

> 我自动创建的 faces-config xml：

您不需要空的 faces-config.xml。如果您刚刚开始，最好删除您不需要的所有内容。如果以后有需要配置的东西，您可以随时添加它。

> 我的网络 xml：

对于 JSF，您实际上并不需要将 映射`FacesServlet`到您使用的扩展。这些已经是默认值了。如果省略整个 web.xml，则可以通过将 .xhtml 扩展名更改为 .jsf 或 .faces 来请求 Facelets (.xhtml) 页面。例如，如果您的页面是“NewFile.xhtml”，您可以使用`localhost:8080/NewFile.jsf`“localhost:8080/NewFile.faces”或“localhost:8080/faces/NewFile.xhtml”来请求它。

不幸的是， JSF 2.1 没有默认提供**唯一**（恕我直言）有用的映射，为此您需要在 web.xml 中添加一个映射条目：

```
<servlet>
    <servlet-name>facesServlet</servlet-name>
    <servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
</servlet>
<servlet-mapping>
    <servlet-name>facesServlet</servlet-name>
    <url-pattern>*.xhtml</url-pattern>      
</servlet-mapping> 
```

因为您的欢迎页面是`NewFile.xhtml`，所以您需要此 *.xhtml 映射，或者您可以完全删除映射并将`welcome-file`内容更改为 例如`NewFile.jsf`。

**更新：**

如果欢迎页面仍然没有显示，那么您的项目中肯定还有一些您不了解自己或没有向我们展示的内容。

尝试从一个非常简单的项目重新开始，看看它是否在那里工作：

1.  在 Eclipse 中，创建一个新的动态 Web 项目
2.  使用项目名称：welcome 和目标运行时：JBoss 7.1 Runtime
3.  删除 WebContent/META-INF 和 WebContent/WEB-INF/lib
4.  [将http://arjan-tijms.omnifaces.org/2011/08/minimal-3-tier-java-ee-app-without-any.html](http://arjan-tijms.omnifaces.org/2011/08/minimal-3-tier-java-ee-app-without-any.html)中的 3 个文件复制到您的项目中。之后，您的工作区应该看起来与图片中的完全一样。
5.  添加具有以下内容的 WebContent/WEB-INF/web.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app version="3.0" xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd">

    <servlet>
        <servlet-name>facesServlet</servlet-name>
        <servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>facesServlet</servlet-name>
        <url-pattern>*.xhtml</url-pattern>
    </servlet-mapping>

    <welcome-file-list>
        <welcome-file>page.xhtml</welcome-file>
    </welcome-file-list>

</web-app> 
```

仔细检查您的整个“欢迎”项目中有 4 个文件，不多也不少。

将您的项目部署到 JBoss AS 7.1。可以肯定的是，右键单击 Servers 视图中的运行时服务器，然后单击“Clean...” 启动您的服务器并请求`localhost:8080/welcome`或`localhost:8080/welcome/`.

我刚刚使用我概述的完全相同的步骤在本地测试了它，并且它有效。

# java-me - Midlet 在调用蓝牙 API 时崩溃

> ID：14044091
> 
> 赞同：1
> 
> 时间：2012-12-26T17:41:26.197
> 
> 标签：java-me, bluetooth, midp, jsr82

当我在手机上运行以下代码时，我得到黑屏，说有未捕获的异常，但整个块被包裹在 try/catch 块中，所以这很奇怪，无论如何，当我继续执行代码时，只会进入“获取设备..”所以它显然在这条线上失败了：

```
 LocalDevice local = LocalDevice.getLocalDevice(); 
```

这是整个方法：

```
 public void startBT() 
            {
            try 
                    {
                        f.append("Getting device..");
                        LocalDevice local = LocalDevice.getLocalDevice();
                        f.append("Got local device..");
                        DiscoveryAgent agent = local.getDiscoveryAgent();
                        f.append("Got local discovery agent..");
                        connString = agent.selectService(new UUID(
                                "86b4d249fb8844d6a756ec265dd1f6a3", false),
                                ServiceRecord.NOAUTHENTICATE_NOENCRYPT, false);
                        f.append("Got connection string - >" + connString);
            } 
                    catch (Exception ex) 
                    {
                        Alert message = new Alert("info");
                        message.setString(ex.getMessage());
                        Display.getDisplay(this).setCurrent(message);
            }
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T18:36:45.087

看起来我使用的设备不支持 JSR-82，它是 J2ME 蓝牙 API（这是内置在手机中，无法“安装”它）需要使用来自 J2ME Midlets 的蓝牙，这是应该检查 JSR-的片段82 支持：

```
 public static boolean IsBtJsrComaptible() {
        try {
            Class.forName("javax.bluetooth.LocalDevice");
            return true;
        } catch (Exception e) {
            return false;
        }
    } 
```

请注意，我在尝试在代码片段上方运行时遇到了未捕获的异常，但也许它可以在其他设备上运行。

# iphone - 颜色叠加 UIButton 图像

> ID：14044094
> 
> 赞同：3
> 
> 时间：2012-12-26T17:41:41.320
> 
> 标签：iphone, objective-c, ios, ipad

尝试用颜色覆盖`UIButton`'s时遇到此问题。`Image`

覆盖颜色出现在`Image`.

这是我的`drawRect`方法中的代码（我有子类化`UIButton`）：

```
(void)drawRect:(CGRect)rect
{
    CGRect bounds = self.imageView.bounds;
    CGContextRef context = UIGraphicsGetCurrentContext();
    CGContextSetFillColorWithColor(context, [UIColor redColor].CGColor);
    CGContextTranslateCTM(context, 0.0, self.imageView.image.size.height);
    CGContextScaleCTM(context, 1.0, -1.0);
    CGContextClipToMask(context, bounds, [self.imageView.image CGImage]);
    CGContextFillRect(context, bounds);
} 
```

关于如何在顶部获得红色的任何想法`Image`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T18:16:41.217

成功使用了这个 hacky 代码：

```
- (void)drawRect:(CGRect)rect
{
    UIImage* img = [self imageForState:UIControlStateNormal];
    [self setImage:nil forState:UIControlStateNormal];
    CGRect bounds = self.imageView.bounds;
    CGContextRef context = UIGraphicsGetCurrentContext();
    CGContextSetFillColorWithColor(context, [UIColor colorWithRed:1 green:0 blue:0 alpha:0.2].CGColor);
    CGContextDrawImage(context, bounds, img.CGImage);
    CGContextFillRect(context, bounds);
} 
```

似乎图像是在 drawRect 之后绘制的，所以除非你将它设为 nil，否则它会在你在那里绘制的任何内容之上。

这是解决方案不是最终的。我将用接下来的内容对其进行编辑。

编辑：正确的解决方案是在图像顶部添加一个半透明的 UIView，如下所示：

```
- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        UIView* tintView = [[UIView alloc] initWithFrame:self.bounds];
        tintView.backgroundColor = [UIColor colorWithRed:1 green:0 blue:0 alpha:0.2];
        tintView.userInteractionEnabled = NO;
        [self addSubview:tintView];
    }
    return self;
}

- (id)initWithCoder:(NSCoder *)aDecoder
{
    self = [super initWithCoder:aDecoder];
    if (self) {
        UIView* tintView = [[UIView alloc] initWithFrame:self.bounds];
        tintView.backgroundColor = [UIColor colorWithRed:1 green:0 blue:0 alpha:0.2];
        tintView.userInteractionEnabled = NO;
        [self addSubview:tintView];
    }
    return self;
} 
```

注意：您应该在 UIButton 子类中执行此操作。

# weka - weka中预处理选项卡中的属性选择有什么作用？

> ID：14044095
> 
> 赞同：1
> 
> 时间：2012-12-26T17:41:47.800
> 
> 标签：weka

我似乎无法找出预处理选项卡中的属性选择过滤器的作用？有人可以用简单的语言告诉我，因为我是 weka 的新手

当我将它应用到我的数据集时，它似乎删除了几个属性，但我不确定为什么

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T18:01:49.317

一个真实的数据集可能包含许多属性。在这个数据集上应用任何数据挖掘过程（例如寻找集群、生成分类模型......）可能需要很长时间。

取而代之的是，我们可以选择一些称为 的属性（维度）`the most discriminative attributes`。这些属性几乎可以描述具有较少属性的数据集，这将加快对数据进行的任何处理。

属性选择选项卡包含许多用于选择这些属性的不同方法。其中之一是[CFS 特征集评估](http://www.opentox.org/dev/documentation/components/cfsfeatsel)此过滤器为您提供与类标签具有更高相关性的属性，这使它们成为区分属性。

# iphone - 开始制作我的应用程序，现在需要故事板

> ID：14044100
> 
> 赞同：1
> 
> 时间：2012-12-26T17:42:07.273
> 
> 标签：iphone, xcode

所以开始制作我的第一个应用程序，它只是一个单视图应用程序，但现在我意识到启用故事板功能可能很有用（现在我知道我可以用它做什么）。我开始的时候没有打勾。

启用它是否为时已晚？将我的应用程序移动到启用情节提要的文件中的最简单方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-26T17:49:06.310

不，现在还不算晚

右键单击您的代码并选择`New File`-> 下 `IOS`-> `User Interface`-> `Storyboard`-> Iphone -> 另存为`Storyboard`

![在此处输入图像描述](../Images/35881e554544b8d924c7fe6af6097632.png)

![在此处输入图像描述](../Images/d25da0cae728d38acbf13da4269d45bf.png)

![在此处输入图像描述](../Images/fe9786ee39b6b70a5909b49673c7671d.png)

![在此处输入图像描述](../Images/7b884e4f94a03938329df62fdc27e35d.png)

现在找到您的 Info.plist（它应该在您的资源或支持的文件中）右键单击并选择 add row find `Main storyboard file base name` on value`Storyboard`

![在此处输入图像描述](../Images/a5945c3809cc749bc525e9924350e0f5.png)

在您的应用程序中，didfinishlaunchingwithoptions 返回 yes

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{

        return YES;

} 
```

现在转到您的故事板并添加 Uiviewcontrollers、导航控制器等...

确保您的第一个 uiviewcontroller 设置为初始视图控制器

![在此处输入图像描述](../Images/93fd4866e0e03c6e6bdac3e10866fecf.png)

# javascript - 如何使用 jQuery 动态添加组合框

> ID：14044104
> 
> 赞同：3
> 
> 时间：2012-12-26T17:42:26.377
> 
> 标签：javascript, jquery, combobox

我有这个工作代码，它正在创建**一个**组合框：

你可以看到它在这里工作：**[jsfiddle](http://jsfiddle.net/JaVVe/6/)**

```
$('body').on('change', '.combo', function() {
    var selectedValue = $(this).val();

    if ($(this).find('option').size() > 2) {
        var newComboBox = $(this).clone();
        var thisComboBoxIndex = parseInt($(this).attr('data-index'), 10);
        var newComboBoxIndex = thisComboBoxIndex + 1;

        $('.parentCombo' + thisComboBoxIndex).remove();

        if (selectedValue !== '') {
            newComboBox.attr('data-index', newComboBoxIndex);
            newComboBox.attr('id', 'combo' + newComboBoxIndex);
            newComboBox.addClass('parentCombo' + thisComboBoxIndex);
            newComboBox.find('option[val="' + selectedValue + '"]').remove();
            $('body').append(newComboBox);
        }
    }
}); 
```

这导致了这样的结果，每次我填充一个组合框时，都会打开下一个。

![仅一个组合框](../Images/f60b318eb96a813c63c3487e9a5fabd0.png)

我怎样才能改变那个代码来拥有这个？这意味着打开了两个组合框（请忘记*样式*）

![这意味着两个组合框效果](../Images/efe580e8f5b55afc791ef99f863e465e.png)

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T18:01:55.407

如果您只想将组合框的数量加倍，您可以使用 for 循环并根据计数器变量的值设置它们的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T22:08:26.050

我不完全确定您的意图，但似乎您希望拥有两个`select`元素的组，然后在用户选择一个值时添加一个新组。

在这种情况下，我建议将您的两个`select`s 分组为`fieldset`：

```
<fieldset>
  <select id="combo1" class="combo" data-index="1">
    <option></option>
    <option val="Opt1">Opt1</option>
    <option val="Opt2">Opt2</option>
    <option val="Opt3">Opt3</option>
  </select>
  <select id="combo2" class="combo" data-index="2">
    <option></option>
    <option val="Opt1">Opt1</option>
    <option val="Opt2">Opt2</option>
    <option val="Opt3">Opt3</option>
  </select>
</fieldset> 
```

​然后查找该父`fieldset`级并像这样克隆它：

```
$('body').on('change', '.combo', function() {
  var selectedValue = $(this).val();

  var fieldset = $(this).parents('fieldset');

  if ($(this).find('option').size() > 2) {
    var newFieldset = fieldset.clone();
    var newComboBox = $(fieldset).children('.combo:first');
    var thisComboBoxIndex = parseInt($(this).attr('data-index'), 10);
    var newComboBoxIndex = thisComboBoxIndex + 1;

    $('.parentCombo' + thisComboBoxIndex).remove();

    if (selectedValue !== '') {
        newComboBox.attr('data-index', newComboBoxIndex);
        newComboBox.attr('id', 'combo' + newComboBoxIndex);
        newComboBox.addClass('parentCombo' + thisComboBoxIndex);
        newComboBox.find('option[val="' + selectedValue + '"]').remove();
        $('body').append(newFieldset);
    }
  }     
});​ 
```

有些细节可能并不完全符合您的需要，但总的来说这是我推荐的方法。

在这里找到更新的小提琴：http: [//jsfiddle.net/JaVVe/8/](http://jsfiddle.net/JaVVe/8/)

# java - 读取文件 NoSuchElementException

> ID：14044105
> 
> 赞同：-4
> 
> 时间：2012-12-26T17:42:31.253
> 
> 标签：java, file

我正在尝试读取带有双打的文件。我发现当我尝试读取十进制数字时会出现该问题。而在整数的情况下，一切正常。我收到`NoSuchElementException`异常。关于如何解决我的问题的任何想法？我的代码：

```
public class readd {

protected Formatter output;
protected Scanner input = new Scanner(System.in);
private Scanner in = new Scanner(System.in);
protected FileWriter out;
protected BufferedWriter out1;
private String ss;
public int r=1,c=1;
public double[][] output_matrix = null;
public double[][] output_matrix2 = null;
public double[] lap_time = null;

public readd() {
}

public void OpenFileRead(String fileName) {         //anoigma tou arxeiou gia diavasma
    try {
        input = new Scanner(new File(fileName));
        System.out.println(fileName);
    } catch (FileNotFoundException e) {           //sfalma kata tin evresi kai to anoigma tou arxeiou
        System.err.println("Sfalma kata to anoigma toy arxeioy");
        System.exit(0);                          //eksodos
    }
}

public void  Load() {            //anagnwsi dedomenwn apo arxeio

   // double[][] w1 = null;
    int count = 0;
    int row = 0, col = 0;
    // double [][] w1=null;

    try {

        while (input.hasNext()) {       //oso tha iparxei apothikeumeni eggrafi

            count++;
            if (count == 1) {

                row = input.nextInt();
                r = row;
              //  System.out.println(row);
                continue;
            } else if (count == 2) {
                col = input.nextInt();
               // System.out.println(col);
                c = col;
                continue;
            } else {
               //        System.out.println("col="+col);

                output_matrix = new double[row][col];

                for (int i = 0; i < row; i++) {
                    for (int j = 0; j < col; j++) {

                        output_matrix[i][j] = input.nextDouble();

                        //String ss=new Integer(input.nextInt()).toString();
                        //w1[i][j]=Double.parseDouble(ss.trim());

                        // String s1 = new Integer(input.nextInt()).toString();
                        //double v = Double.parseDouble(s1.trim());                                         

                        //String s2 = new Integer(input.nextInt()).toString();
                        //int s = Integer.parseInt(s2.trim());          

                       // System.out.print(output_matrix[i][j]+" ");

                    }
                    // System.out.println(" ");
                }

                //System.out.print(col);
                //System.out.print(row);
            }

        }

    } catch (NoSuchElementException e) {
        System.err.println("Sfalma kata ti tropopoisisi toy arxeioy");
        System.err.println(e.getMessage());       //emfanisi tou minimatos sfalmatos
        input.close();
        System.exit(0);
    } catch (IllegalStateException e) {
        System.err.println("Sfalma kata ti anagnosi toy arxeioy");
        System.exit(0);
    }

}

 }
public static void main(String[] args) {
    // TODO code application logic here
     double[][] wa1;

    readd w = new readd();
    w.OpenFileRead("W1.txt");
    w.Load();
    wa1 = w.output_matrix;
}here 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T17:57:24.930

有个想法

```
Scanner sc = new Scanner("1.0");
sc.nextDouble();
sc.nextDouble(); 
```

抛出 java.util.NoSuchElementException

正如 API Scanner.nextDouble 所说

```
 * @throws NoSuchElementException if the input is exhausted 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-26T17:48:46.967

我还想了解更多信息。

一般： [http ://docs.oracle.com/javase/1.4.2/docs/api/java/util/NoSuchElementException.html](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/NoSuchElementException.html)

这是枚举器的结尾。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T21:25:59.237

我不明白我在我的 txt 文件中用逗号更改点并且一切正常！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-26T18:17:14.167

```
enter package read;

       import java.util.*;
       import java.io.File;
       import java.io.BufferedWriter;
       import java.io.IOException;
       import java.io.FileWriter;
       import java.io.FileNotFoundException; 
```

/** * * @author zenitis */ public class readd {

```
protected Formatter output;
protected Scanner input = new Scanner(System.in);
private Scanner in = new Scanner(System.in);
protected FileWriter out;
protected BufferedWriter out1;
private String ss;
public int r=1,c=1;
public double[][] output_matrix = null;
public double[][] output_matrix2 = null;
public double[] lap_time = null;

public readd() {
}

public void OpenFileRead(String fileName) {        
    try {
        input = new Scanner(new File(fileName));
        System.out.println(fileName);
    } catch (FileNotFoundException e) {         
        System.err.println("Sfalma kata to anoigma toy arxeioy");
        System.exit(0);                        
    }
}

public void  Load() {            

    int count = 0;
    int row = 0, col = 0;

    try {

        while (input.hasNext()) {       

            count++;
            if (count == 1) {

                row = input.nextInt();
                r = row;
                continue;
            } else if (count == 2) {
                col = input.nextInt();

                c = col;
                continue;
            } else {

                output_matrix = new double[row][col];

                for (int i = 0; i < row; i++) {
                    for (int j = 0; j < col; j++) {

                        output_matrix[i][j] = input.nextDouble();      

                    }

                }

            }

        }

    } catch (NoSuchElementException e) {
        System.err.println("Sfalma kata ti tropopoisisi toy arxeioy");
        System.err.println(e.getMessage());       //emfanisi tou minimatos sfalmatos
        input.close();
        System.exit(0);
    } catch (IllegalStateException e) {
        System.err.println("Sfalma kata ti anagnosi toy arxeioy");
        System.exit(0);
    }
}

   public static void main(String[] args) {
     double[][] wa1;
    readd w = new readd();
    w.OpenFileRead("W1.txt");
    w.Load();
    wa1 = w.output_matrix;
} 
```

}这里

# oracle - “WHERE”子句中的 Oracle 和可能的常量谓词

> ID：14044107
> 
> 赞同：3
> 
> 时间：2012-12-26T17:42:35.587
> 
> 标签：oracle, null, where, procedure, recompile

在以下示例代码中，我对 ORACLE 有一个常见问题：

```
create or replace procedure usp_test
(
  p_customerId number,
  p_eventTypeId number,
  p_out OUT SYS_REFCURSOR
)
as
begin

  open p_out for
    select e.Id from eventstable e
    where 
      (p_customerId is null or e.CustomerId = p_customerId)
      and
      (p_eventTypeId is null or e.EventTypeId = p_eventTypeId)
    order by Id asc;

end usp_test; 
```

"(p_customerId is null or e.CustomerId = p_customerId)" 中的 "OR" 会破坏程序性能，因为优化器不会在 "CustomerId" 列上最佳地使用索引（我希望索引搜索），从而导致扫描而不是搜索。“CustomerId”上的索引有很多不同的值。

使用 MSSQL 2008 R2（最新 SP）或 MSSQL 2012 时，我可以使用“选项（重新编译）”提示查询，这将：

1.  仅重新编译此查询
2.  解析所有变量的值（在调用 sproc 后它们是已知的）
3.  用常量替换所有解析的变量并消除常量谓词部分

例如：如果我通过 p_customerId = 1000，那么“1000 is null”表达式将始终为假，因此优化器将忽略它。这会增加一些 CPU 开销，但它主要用于很少调用的海量报告程序，所以这里没有问题。

有没有办法在 Oracle 中做到这一点？动态 SQL 不是一个选项。

## 添加

没有“p_customerId 为空”和“p_eventTypeId 为空”的相同程序运行约 0.041 秒，而上一个运行约 0.448 秒（我有约 5.000.000 行）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T19:32:16.773

```
CREATE INDEX IX_YOURNAME1 ON eventstable (NVL(p_customerId, 'x'));
CREATE INDEX IX_YOURNAME2 ON eventstable (NVL(p_eventTypeId, 'x'));

create or replace procedure usp_test
(
  p_customerId number,
  p_eventTypeId number,
  p_out OUT SYS_REFCURSOR
)
as
begin

  open p_out for
    select e.Id from eventstable e
    where 
        (NVL(p_customerId, 'x') = e.CustomerId OR NVL(p_customerId, 'x') = 'x')
    AND (NVL(p_eventTypeId, 'x') = e.EventTypeId OR NVL(p_eventTypeId, 'x') = 'x')
    order by Id asc;
end usp_test; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T18:14:04.507

一列索引无济于事，因为它没有存储在索引定义中。是否允许在 (customer id, event id, id ) 上创建索引？这样所有需要的列都在索引中......

# c# - 在 C# WebForm 上反序列化动态 JSON 数组

> ID：14044109
> 
> 赞同：4
> 
> 时间：2012-12-26T17:42:55.553
> 
> 标签：c#, json, dictionary, datatable, deserialization

嗨，我正在我的 API 上生成一个 JSON，我试图在我的 Web 应用程序中的代码隐藏 C# 上使用它，但我不能很好地反序列化。

我的 JSON 有一个带有 JSON 数组的对象，并且数组中的元素是动态的，所以我不能用这些项目创建一个固定的类，因为我的 JSON 可以有 N 个项目。

```
{
    "MAINOBJET": [{
        "ITEM1": "23800",
        "ITEM2": "Dahl; Police",
        "ITEM3": "test@test.net"
    },
    {
        "ITEM1": "23802",
        "ITEM2": "Steve ; Police",
        "ITEM3": "test2@test.net"
    }]
} 
```

那么如何将其反序列化为 DataTable、列表或字典？谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-26T17:56:47.953

在这里你可以做一些类似下面的事情这个例子应该能够让你开始..用你的Jason Text替换结构/例子

假设我的 JSON 脚本如下所示

```
{
    "some_number": 253.541, 
    "date_time": "2012-26-12T11:53:09Z", 
    "serial_number": "SN8675309"
    "more_data": {
        "field1": 1.0
        "field2": "hello JSON Deserializer" 
    }
} 
```

将您的 JSON jsonText 分配给一个变量并将其传递给以下 C# 代码

```
using System.Web.Script.Serialization;

var jsonSerialization = new JavaScriptSerializer();
var dictObj = jsonSerialization.Deserialize<Dictionary<string,dynamic>>(jsonText);
Console.WriteLine(dictObj["some_number"]); //outputs 253.541
Console.WriteLine(dictObj["more_data"]["field2"]); //outputs hello JSON Deserializer 
```

# php - 如何从两个不同的 HTML 文本框中获取值？

> ID：14044110
> 
> 赞同：1
> 
> 时间：2012-12-26T17:42:56.197
> 
> 标签：php

我在使用 PHP 时遇到问题`$_POST['something'];`。

我在 HTML 正文中有两个文本框，如下所示：

```
<form method="post">
    <div class="style7">
        Data Base username
        <input name="uname" type="text" style="width: 136px" /></div>
</form>

<form method="post">
    <div class="style7">
        Password:<input name="pass" type="password" style="width: 202px" /></div>
</form> 
```

我想从这些文本框中获取值，所以我这样做：

```
<?php
    $uname = $_POST['uname'];
    $pass = $_POST['pass'];
    echo $pass;
    echo $uname;
?> 
```

当我只在第一个文本框中输入一个值时，它只打印第一个。当我只在第二个文本框上放一个值时，也会发生同样的情况。但是，当我同时在每个文本框中输入值然后点击`Enter`时，它只打印第二个值。

有没有办法使用 PHP 同时从两个 HTML 文本框中获取值？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-26T17:43:37.993

你需要把它们放在同一个`<form>`.

```
<form method="post">
    <div class="style7">
        Data Base username
        <input name="uname" type="text" style="width: 136px" />
    </div>
    <div class="style7">
        Password
        <input name="pass" type="password" style="width: 202px" />
    </div>
</form> 
```

# php - 计算复选框上多个值的第一个值

> ID：14044111
> 
> 赞同：0
> 
> 时间：2012-12-26T17:43:05.350
> 
> 标签：php

我试图制作一个计算机订购系统。我的问题是如何计算复选框上的第一个值。复选框上的第二个值将发布在订单摘要上。

一旦我检查了所有这三个，它将计算菜单的总量并在订单摘要上显示所选菜单。但我不知道如何显示总金额。

任何人都可以指导我如何计算复选框上我的第一个值的总数吗？

```
<form method="post">
    <input name='ts[]' type='checkbox' value='40 |Tosilog'/> Tosilog
    <br>
    <input name='cs[]' type='checkbox' value='40 |Chiksilog'/>Chiksilog
    <br>
    <input name='ps[]' type='checkbox' value='45 |Porksilog'/>Porksilog
    <br>
    <input type="submit" name="go" value= "Total">
</form>

<?php 
//tosilog
    $ts = $_POST['ts'];
    $value = explode("|",$ts[0]);
    echo $value[0];
    echo $value[1];

//chiksilog
    $cs = $_POST['cs'];
    $value = explode("|",$cs[0]);
    echo $value[0];
    echo $value[1];

//porksilog
    $ps = $_POST['ps'];
    $value = explode("|",$ps[0]);
    echo $value[0];
    echo $value[1];

?>
    <!-- compute for the 1st value on checkbox -->  
 <?php

            $ts=$_POST['ts[0]'];
            $cs=$_POST['cs[0]'];
            $ps=$_POST['ps[0]'];

?>

    <?php $compute = $ts[0] + $cs[0] + $ps[0];?>

    <?php echo "$compute " ; ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T18:26:06.877

请参阅[http://www.laprbass.com/RAY_temp_miggy.php](http://www.laprbass.com/RAY_temp_miggy.php)
这可能更符合我的做法。脚本知道 HTML 中的内容，并且确切地知道 POST 请求中的内容。添加或删除不同的输入很容易。这些类型的输入通常来自数据库表。

```
<?php // RAY_temp_miggy.php
error_reporting(E_ALL);

$total  = 0;

// EXPECTED INPUTS
$inputs = array
( 'Tosilog'   => 40
, 'Chiksilog' => 40
, 'Porksilog' => 45
)
;

if (!empty($_POST))
{
    // ACTIVATE THIS TO SEE WHAT WAS SUBMITTED
    // var_dump($_POST);

    // SUM OF THE ELEMENTS
    $total = array_sum($_POST);
    echo "TOTAL: $total";

    // SUM OF THE EXPECTED INPUTS
    $expect = array_sum($inputs);
    if ($total != $expect) echo " BUT THERE MAY BE INCOMPLETE INPUTS!";

// END OF THE ACTION SCRIPT
}

// CREATE THE FORM
$checkboxes = NULL;
foreach ($inputs as $name => $value)
{
    $checkboxes
    .= '<input name="'
    . $name
    . '" type="checkbox" value="'
    . $value
    . '" />'
    . $name
    . '<br/>'
    . PHP_EOL
    ;
}
$form = <<<ENDFORM
<form method="post">
$checkboxes
<input type="submit" value= "Total">
</form>
ENDFORM;
echo $form; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T17:45:35.133

如果你得到一个复选框元素的数组，并且它们是数字的，你可以使用 array_sum()。不确定我是否理解您建议的结构，但我将根据现有的表单结构在此处为您提供代码示例。然后我会再发一点来让你更简单。执行摘要：您不需要此表单结构创建的所有变量。

```
<?php // RAY_temp_user193.php
error_reporting(E_ALL);

$total  = 0;
$inputs = array();
$errors = array();
if (!empty($_POST))
{
    if (!empty($_POST['ts']))
    {
        foreach ($_POST['ts'] as $ts)
        {
            $inputs[] = current(explode(' |', $ts));
        }
    }
    else
    {
        $errors[] = 'Tosilog';
    }

    if (!empty($_POST['cs']))
    {
        foreach ($_POST['cs'] as $cs)
        {
            $inputs[] = current(explode(' |', $cs));
        }
    }
    else
    {
        $errors[] = 'Chiksilog';
    }

    if (!empty($_POST['ps']))
    {
        foreach ($_POST['ps'] as $ps)
        {
            $inputs[] = current(explode(' |', $ps));
        }
    }
    else
    {
        $errors[] = 'Porksilog';
    }

    // IF ERRORS
    if (!empty($errors))
    {
        echo 'UNABLE TO PRINT COMPLETE TOTAL.  MISSING: ' . implode(',', $errors);
    }
    $total = array_sum($inputs);
    if ($total) echo "<br/>TOTAL: $total <br/>" . PHP_EOL;

// END OF THE ACTION SCRIPT
}

// CREATE THE FORM
$form = <<<ENDFORM
<form method="post">
<input name='ts[]' type='checkbox' value='40 |Tosilog'/> Tosilog
<br>
<input name='cs[]' type='checkbox' value='40 |Chiksilog'/>Chiksilog
<br>
<input name='ps[]' type='checkbox' value='45 |Porksilog'/>Porksilog
<br>
<input type="submit" value= "Total">
</form>

ENDFORM;
echo $form; 
```

# python - 如何使用 __len__ 方法说唱歌手，Python 3.x

> ID：14044119
> 
> 赞同：0
> 
> 时间：2012-12-26T17:43:47.663
> 
> 标签：python, xml, python-3.x, xml-parsing

我正在解析一个`XML`文件，其中我使用元素，当前我的元素名称是 `__word__` 在元素中我有一个名为的属性`__attrs__`，当我调试时我可以看到它`__attrs__`有一个名为的方法包装器`__len__` 我想使用它来了解长度，`_attrs`但我想我不知道怎么做。我试过 ：

```
word._attrs.__len__

word._attrs.len()

len(word._attrs) 
```

我想你知道它没有用:)

谢谢 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T17:45:28.740

`len(word._attrs)`如果您想要任何内容​​的长度，这是要走的路`_attrs`。

`word._attrs.__len__()`也可以，但是您不应该直接调用这些魔术方法。

# c - 在优化方面，定义带参数和不带参数的函数指针有什么区别

> ID：14044120
> 
> 赞同：0
> 
> 时间：2012-12-26T17:43:48.547
> 
> 标签：c, function, pointers

我知道以这种方式定义函数指针

```
struct handler_index {
    const char *name;
   int (*handler)();
}; 
```

允许对任何具有未指定（但非可变）数量和类型的参数的函数使用处理程序指针。

但我想知道与此相比，这个定义是否会影响代码或内存或执行时间的优化：

```
struct handler_index {
    const char *name;
    int (*handler)(int a, int b);
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T17:58:12.043

如果您想知道向函数指针添加更多参数如何具体影响函数*指针*- 它不会。无论参数数量如何，函数指针的大小都相同。

如果您想知道*调用*此类函数指针的效率：添加更多参数将导致生成代码以传递参数。所以是的，它会稍微影响调用的代码大小，并且可能会影响执行时间，具体取决于您的 CPU 在传递这些参数时可以拉出多少 ILP。

现代调用约定通常在寄存器中传递一些参数，因此您可能会或可能不会增加堆栈使用量。

要准确了解每次调用生成的代码之间的区别，请阅读[调用约定](http://en.wikipedia.org/wiki/X86_calling_conventions)（这里列出的太多了！）并检查从代码生成的 asm。但实际上，添加更多参数（在合理范围内）可能会产生非常小的影响，以至于它根本不重要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T18:39:34.413

正如 Cory 所说，它是函数指针还是只是一个常规的基本函数并不真正相关[除非在常规函数被内联的情况下，当然，函数指针通常不能——尽管如果情况足够具体，我已经看到编译器实际上弄清楚了“啊，我们总是在这里调用函数 X，所以让我们内联 X”——通常当函数指针是函数的参数时，而不是在结构中说）。

一般而言，将有所作为的是向函数调用添加参数。处理器必须将这些参数放在某个地方，即使它们进入寄存器，也可能需要额外的指令才能将值放入 RIGHT 寄存器。

但是，您的第一个示例非常糟糕，因为没有检查您的代码是否在做正确的事情。

此外，您需要一些非常病态的情况来使将参数传递给函数的开销大部分时间都在调用函数指针 - 希望您的函数不仅仅将一个数字添加到另一个数字。

话虽如此，传递很多论点，尤其是“难以获得”的论点可能真的很糟糕。我正在研究图形芯片模拟器，部分像素着色器处理单元中间有一个调试打印，很少打印，但它需要 7 或 8 个参数（除了调试级别 1000 或其他它是）。从各自的结构中找出这些参数并将它们粘贴到堆栈上需要相当长的时间，并放置一个“if (debuglevel >= 1000) ...”以便仅在实际需要时进行调用，制作代码该功能的速度提高了约 40%。

# internet-explorer - 通过 SignalR 在 IE 中缺少原型方法

> ID：14044126
> 
> 赞同：5
> 
> 时间：2012-12-26T17:44:59.813
> 
> 标签：internet-explorer, prototype, signalr

我遇到了处理原型方法消失的问题（在本例中为 Array.prototype 方法），仅在 IE 中并且仅当数组通过 SignalR 时才消失。

我写了一个小/愚蠢但简单的概念验证网络应用程序来演示这个问题（代码都在下面）。请注意，当您单击“更新所有客户端”然后单击“包含字母 'r' 的水果”时，_list 中的原型方法丢失导致异常。在这种情况下，数组来自 SignalR。现在，当您单击“重置”并将数组重置为硬编码值时，“包含字母'r'的水果”按钮突然起作用-原型方法又回来了。请记住，这个问题只发生在 IE 中。

提示：当我第一次编写概念证明时，我无法重现该问题。当数组通过 SignalR 来时，IE 仍然有原型方法，但是当页面加载时我确实遇到了另一个错误。我不小心包含了 jQuery 两次。当我取出冗余脚本以包含第二个 jQuery 时，它修复了该错误（显然），但现在可以重现该问题。然后，IE 缺少我创建的数组原型方法，但只有当数组来自 SignalR 时。

myExtensions.js：

```
Array.prototype.where = function (del)
{
    var ret = new Array();
    for (var i = 0; i < this.length; i++)
    {
        if (del(this[i])) ret.push(this[i]);
    }
    return ret;
}

Array.prototype.select = function (del)
{
    var ret = new Array();
    for (var i = 0; i < this.length; i++)
    {
        ret.push(del(this[i]));
    }
    return ret;
} 
```

_Layout.cshtml

```
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title>@ViewBag.Title - My ASP.NET MVC Application</title>
        <link href="~/favicon.ico" rel="shortcut icon" type="image/x-icon" />
        <meta name="viewport" content="width=device-width" />

        @Styles.Render("~/Content/css")

        @Scripts.Render("~/Scripts/myExtensions.js")
        @Scripts.Render("~/bundles/modernizr")
        @Scripts.Render("~/Scripts/jquery-1.7.1.js")
        @Scripts.Render("~/Scripts/jquery.signalR-1.0.0-rc1.js")
        <script src="~/signalr/hubs"></script>

    </head>
    <body>
        <header>
            <div class="content-wrapper">
                <div class="float-left">
                    <p class="site-title">@Html.ActionLink("IE/SignalR error POC", "Index", "Home")</p>
                </div>
            </div>
        </header>
        <div id="body">
            @RenderSection("featured", required: false)
            <section class="content-wrapper main-content clear-fix">
                @RenderBody()
            </section>
        </div>
        <footer>
            <div class="content-wrapper">
                <div class="float-left">
                    <p>&copy; @DateTime.Now.Year - My ASP.NET MVC Application</p>
                </div>
            </div>
        </footer>
        @*@Scripts.Render("~/Scripts/myExtensions.js")*@
    </body>
</html> 
```

ListHub.cs

```
using System.Linq;
using Microsoft.AspNet.SignalR.Hubs;

namespace SignalR_Bug_POC.Hubs
{
    public class ListHub : Hub
    {
        public void RunTest()
        {
            Clients.All.updateList(new string[]
                {
                    "apple", "pear", "grape", "strawberry", "rasberry", "orange", "watermelon"
                }.Select(f => new { Name = f }).ToList());
        }
    }
} 
```

索引.cshtml

```
@{
    ViewBag.Title = "Home Page";
}

@if(false)
{
    @Scripts.Render("~/Scripts/jquery.signalR-1.0.0-rc1.js")
    @Scripts.Render("~/Scripts/myExtensions.js")
    <script src="~/signalr/hubs"></script>
}

<script type="text/javascript">

    var _fruits = ["blueberry", "grape", "orange", "strawberry"].select(function (f) { return { "Name": f } });
    var _list;

    var conn = $.connection.listHub;
    $.connection.hub.start();

    conn.client.updateList = function (data)
    {
        _list = data;
        $("#theList").html("");
        for (var i = 0; i < _list.length; i++)
        {
            $("#theList").append("<li>" + _list[i].Name + "</li>");
        }
    }

    $(document).ready(function ()
    {
        $("#cmdUpdateClients").click(function ()
        {
            conn.server.runTest();
        });
        $("#cmdReset").click(function ()
        {
            conn.client.updateList(_fruits);
        });
        $("#cmdRunTest").click(function ()
        {
            var message = "";
            var fruitsContaining = _list
                .where(function (f) { return f.Name.indexOf('r') >= 0 })
                .select(function (f) { return f.Name });
            for (var i = 0; i < fruitsContaining.length; i++)
            {
                message += " - " + fruitsContaining[i] + "\n";
            }
            alert(message);
        });
        conn.client.updateList(_fruits);
    });

</script>

<input type="button" id="cmdUpdateClients" value="Update All Clients" />
<input type="button" id="cmdReset" value="Reset" />
<input type="button" id="cmdRunTest" value="Fruits containing the letter r." />
<ul id="theList"></ul> 
```

我不确定这是我在代码中做错了什么（即我做错了顺序）还是 IE 错误或 SignalR 错误。例如，当我在 conn.client.updateList JS 方法的第一行设置断点并跟踪调用堆栈到最顶部时，即使在“数据”对象中的数组（在 SignalR 接收方法中）也没有没有我的原型方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-05-03T06:48:32.973

我遇到了同样的问题：当我使用 SignalR 将数组从 C# 传递到 Angular 应用程序时，我无法使用`Array.prototype`在接收到的对象上定义的方法。此外，这些对象确实是“类似数组的”，因为[这里](https://stackoverflow.com/questions/4775722/check-if-object-is-array)描述的一些数组测试会失败。例如，`arr instanceof Array`会返回`false`，但`Array.isArray(arr)`会返回`true`。

当 Web 应用程序托管在没有 WebSockets 支持的 IIS 中时，问题就开始了。在这种情况下，[SignalR](http://www.asp.net/signalr/overview/getting-started/introduction-to-signalr)在 Chrome 和 Firefox 中默认为 serverSentEvents，在 Internet Explorer 和 Edge 中默认为 ForeverFrame。

[正如这个问题所表明](https://stackoverflow.com/questions/31578626/signalr-deserializes-my-objects-incorrectly-in-iis-7-5-and-edge-ie-foreverframe)的，ForeverFrame 导致数组被错误地反序列化。这是因为 ForeverFrame 使用不同的帧来维护 SignalR 连接，并且不同帧中的数组是使用不同的`Array`对象创建的。

这里有很多解决方案：

1.  如果可能，[请为 IIS 启用 WebSockets](http://www.iis.net/learn/get-started/whats-new-in-iis-8/iis-80-websocket-protocol-support)。这可以从 IIS 8 和 Windows Server 2012 开始。
2.  如果 WebSockets 不可用，[可以](https://stackoverflow.com/questions/31578626/signalr-deserializes-my-objects-incorrectly-in-iis-7-5-and-edge-ie-foreverframe)在`$.connection.hub.start()`参数中指定 ForeverFrame 不应该使用，IE 和 Edge 上默认为 LongPolling。
3.  您可以将自己的 JSON 解析器提供给 ForeverFrame，并调用`window.JSON`：

    ```
    $.connection.hub.json = {
        parse: function(text, reviver) {
            console.log("Parsing JSON");
            return window.JSON.parse(text, reviver);
        },
        stringify: function(value, replacer, space) {
            return window.JSON.stringify(value, replacer, space);
        }
    }; 
    ```

4.  而且，正如皮特的回答所建议的那样，您可以调用`Array.prototype.slice`接收到的对象，将其转换为`Array`同一帧的。对于从 SignalR 接收到的任何数组都必须这样做，因此它不像其他两个选项那样可扩展。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T14:10:22.330

通过以下修改，它对我来说很好：

```
var fruitsContaining = _list
    .where(function (f) { return f.indexOf('r') >= 0 })
    .select(function (f) { return f}); 
```

where 和 select 实际上在那里，它是 f.Name 不是，因为数组成员是字符串。

**更新：**

好吧，忽略上面的。这是修复：

```
var list = list
if (navigator.appName == 'Microsoft Internet Explorer') {
    list = Array.prototype.slice.call(_list);
}
var fruitsContaining = list
    .where(function (f) { return f.Name.indexOf('r') >= 0 })
    .select(function (f) { return f.Name });
for (var i = 0; i < fruitsContaining.length; i++) {
    message += " - " + fruitsContaining[i] + "\n";
} 
```

我不完全理解这个问题，但我相信它可能是 jquery 中的一个错误。虽然问题有点不同，但我从这个问题中窃取了解决方案： [为什么对 Array 原型的这种更改在我的 jQuery 插件中不起作用？](https://stackoverflow.com/questions/9053536/why-does-this-change-to-the-array-prototype-not-work-in-my-jquery-plugin)

**额外更新**

添加了 IE 检查。

# php - Doctrine DBAL：如何获取非整数数组键

> ID：14044127
> 
> 赞同：0
> 
> 时间：2012-12-26T17:45:08.083
> 
> 标签：php, doctrine

我想遍历[Doctrine DBAL](http://docs.doctrine-project.org/projects/doctrine-dbal/en/latest/reference/data-retrieval-and-manipulation.html#fetcharray)返回的结果，只返回每个数组的字符串/非整数键。使用以下内容，Doctrine 返回字符串键（映射到数据库列名）和以整数为键的重复值。如何使用迭代方法并仅检索字符串/非整数键？

```
$stmt = $app['db']->prepare('SELECT * FROM table');
$stmt->execute();

while ($row = $stmt->fetch()) {
    print_r($row['track_name']);
} 
```

返回

```
Array
(
    [field1] => foo1
    [0] => foo1
    [field2] => bar1
    [1] => bar1
)
Array
(
    [field1] => foo2
    [0] => foo2
    [field2] => bar2
    [1] => bar2
)
... 
```

我想得到

```
Array
(
    [field1] => foo1
    [field2] => bar1
)
Array
(
    [field1] => foo2
    [field2] => bar2
)
... 
```

无需求助

```
$fields = array('field1', 'field2');
while ($row = $stmt->fetch()) {
    foreach ($row as $key => $val) {
        if (in_array($key, $fields)) {
            print_r($row[$key]);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T15:54:42.093

换线

`while ($row = $stmt->fetch()) {`

至

`while ($row = $stmt->fetch(\Doctrine\ORM\Query::HYDRATE_ARRAY)) {`

您还可以使用 PDO:FETCH_ASSOC （似乎 Doctrine 使用相同的常量值）。其他有效值为：

*   HYDRATE_OBJECT
*   HYDRATE_SCALAR
*   HYDRATE_SINGLE_SCALAR
*   HYDRATE_SIMPLEOBJECT

# php - 如何制作实时 PHP 表单？

> ID：14044128
> 
> 赞同：-5
> 
> 时间：2012-12-26T17:45:10.360
> 
> 标签：php, javascript, html, ajax

我想知道如何制作一个实时 PHP 页面，即当我们提交表单的详细信息时它不会刷新/加载。

使用它的例子：

1.  堆栈溢出（提交帖子时）
2.  Facebook（更新状态时） 在 facebook 上，状态已发布且页面未重新加载。

我想知道我必须学习/使用哪种语言来创建这样的表单页面。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T17:46:40.363

您可以使用 Javascript/JQuery 轻松完成此操作

**例子：**

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.0/jquery.min.js"></script> 
<script> 
var auto_refresh = setInterval(
function()
{
$('#loaddiv').fadeOut('slow').load('reload.php').fadeIn("slow");
}, 20000);
</script> 
```

它每 20000 毫秒 -> 20 秒将“reload.php”文件加载到 div id“loaddiv”中。分区：

```
<div id="loaddiv"> 
</div> 
```

然后编辑“reload.php”文件。

祝你好运！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-26T17:51:11.293

试试下面的代码：

```
<form id="myForm" action="comment.php" method="post"> 
    Name: <input type="text" name="name" /> 
    Comment: <textarea name="comment"></textarea> 
    <input type="submit" value="Submit Comment" /> 
</form>

<html> 
<head> 
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.js"></script> 
    <script src="http://malsup.github.com/jquery.form.js"></script> 

    <script> 
        // wait for the DOM to be loaded 
        $(document).ready(function() { 
            // bind 'myForm' and provide a simple callback function 
            $('#myForm').ajaxForm(function() { 
                alert("Thank you for your comment!"); 
            }); 
        }); 
    </script> 
</head> 
... 
```

代码取自[此链接](http://malsup.com/jquery/form/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T17:49:00.007

您需要使用[AJAX](http://en.wikipedia.org/wiki/Ajax_%28programming%29)。

[jQuery 有一个很好的 AJAX 引擎](http://api.jquery.com/jQuery.ajax/)。

# html - 在 html5 视频上覆盖 iframe

> ID：14044135
> 
> 赞同：1
> 
> 时间：2012-12-26T17:45:45.027
> 
> 标签：html, video, iframe

我是新人！也许是一个愚蠢的问题。

有没有办法在 html5 视频上显示 iframe。我想在视频上添加一些内容，例如按钮、图像等。（不是播放、停止按钮）。我找到了一个如何在视频上添加图像的示例，但是如何添加更多内容？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T18:05:20.713

该`<video>`元素可以像大多数其他 HTML 元素一样设置样式

例如，如果您有一个绝对定位的视频元素

```
<video style='position:absolute; top:40px; left:40px; '></video> 
```

您可以在其上放置任何其他元素，例如这个绝对定位的 iframe

```
<iframe style='position:absolute; top:50px; left:50px;' src='/something.html'></iframe> 
```

这里的工作示例：

[http://jsfiddle.net/Y4Y3u/](http://jsfiddle.net/Y4Y3u/)

# ruby-on-rails-3 - db:migrate 创建文件 db/development.sqlite3

> ID：14044137
> 
> 赞同：1
> 
> 时间：2012-12-26T17:45:58.067
> 
> 标签：ruby-on-rails-3, sqlite, rake, postgis

如果 rails 应用程序使用 sqlite，则 db:migrate 创建文件 db/development.sqlite3。在部署到 Heroku 之前，我更喜欢使用 postgresql 进行开发和生产。

我的 database.yml 文件的一部分：

```
development:
adapter: postgresql
encoding: unicode
host: localhost
database: app-development
username: postgres
password: ******* 
```

当我运行 bundle exec rake db:migrate 时，我应该期待一个像 db/development.postgresql 这样的文件吗？因为在 db 目录中没有创建文件，也没有产生错误。

```
$ bundle exec rake db:migrate
==  CreateUsers: migrating ====================================================
-- create_table(:users)
NOTICE:  CREATE TABLE will create implicit sequence "users_id_seq" for serial column "
users.id"
NOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index "users_pkey" for table
"users"
-> 0.2060s
==  CreateUsers: migrated (0.2070s) =========================================== 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T18:00:46.330

嗯，`postgresql`是非常非常不同的`sqlite`。尝试阅读这篇文章，以便您发现主要区别：

[http://saaientist.blogspot.com.br/2007/07/choice-of-databases-or-postgres-vs.html](http://saaientist.blogspot.com.br/2007/07/choice-of-databases-or-postgres-vs.html)。

关于您的问题的问题是 sqlite 使用应用程序文件夹中的数据库文件，而 postgres 不能以这种方式工作。有很多关于 postgresql 如何与 Rails 一起工作的资源，我建议你阅读一些并尝试理解。

# android - 如何在页面标题条中放置更多视图？

> ID：14044138
> 
> 赞同：0
> 
> 时间：2012-12-26T17:45:59.287
> 
> 标签：android, android-layout

我正在尝试使用页面标题条，我需要在我的一个片段中放置三个搜索栏。这是我的代码：

```
public class MainActivity extends FragmentActivity {

/**
 * The {@link android.support.v4.view.PagerAdapter} that will provide
 * fragments for each of the sections. We use a
 * {@link android.support.v4.app.FragmentPagerAdapter} derivative, which
 * will keep every loaded fragment in memory. If this becomes too memory
 * intensive, it may be best to switch to a
 * {@link android.support.v4.app.FragmentStatePagerAdapter}.
 */
SectionsPagerAdapter mSectionsPagerAdapter;

/**
 * The {@link ViewPager} that will host the section contents.
 */
ViewPager mViewPager;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    // Create the adapter that will return a fragment for each of the three
    // primary sections of the app.
    mSectionsPagerAdapter = new SectionsPagerAdapter(
            getSupportFragmentManager());

    // Set up the ViewPager with the sections adapter.
    mViewPager = (ViewPager) findViewById(R.id.pager);
    mViewPager.setAdapter(mSectionsPagerAdapter);

}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}

/**
 * A {@link FragmentPagerAdapter} that returns a fragment corresponding to
 * one of the sections/tabs/pages.
 */
public class SectionsPagerAdapter extends FragmentPagerAdapter {

    public SectionsPagerAdapter(FragmentManager fm) {
        super(fm);
    }

    @Override
    public Fragment getItem(int position) {
        // getItem is called to instantiate the fragment for the given page.
        // Return a DummySectionFragment (defined as a static inner class
        // below) with the page number as its lone argument.
        Fragment fragment = null;
        Bundle args = new Bundle();
        switch (position) {
        case 0:
            fragment = new Page1();
            args.putInt(Page1.ARG_SECTION_NUMBER, position + 1);
            break;
        case 1:
            fragment = new Page2();
            args.putInt(Page2.ARG_SECTION_NUMBER, position + 1);
            break;
        case 2:
            fragment = new Page3();
            args.putInt(Page3.ARG_SECTION_NUMBER, position + 1);
            break;
        }
        fragment.setArguments(args);
        return fragment;
    }

    @Override
    public int getCount() {
        // Show 3 total pages.
        return 3;
    }

    @Override
    public CharSequence getPageTitle(int position) {
        switch (position) {
        case 0:
            return getString(R.string.title_section1).toUpperCase();
        case 1:
            return getString(R.string.title_section2).toUpperCase();
        case 2:
            return getString(R.string.title_section3).toUpperCase();
        }
        return null;
    }
}

/**
 * A dummy fragment representing a section of the app, but that simply
 * displays dummy text.
 */
public static class Page1 extends Fragment {
    /**
     * The fragment argument representing the section number for this
     * fragment.
     */
    public static final String ARG_SECTION_NUMBER = "section_number";

    public Page1() {
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        // Create a new TextView and set its text to the fragment's section
        // number argument value.
        // TextView textView = new TextView(getActivity());
        // textView.setGravity(Gravity.CENTER);
        // textView.setText(Integer.toString(getArguments().getInt(
        // ARG_SECTION_NUMBER)));
        SeekBar sb1 = new SeekBar(getActivity());
        SeekBar sb2 = new SeekBar(getActivity());
        SeekBar sb3 = new SeekBar(getActivity());
        return sb1;
    }
}

public static class Page2 extends Fragment {
    /**
     * The fragment argument representing the section number for this
     * fragment.
     */
    public static final String ARG_SECTION_NUMBER = "section_number";

    public Page2() {
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        // Create a new TextView and set its text to the fragment's section
        // number argument value.
        TextView textView = new TextView(getActivity());
        textView.setGravity(Gravity.LEFT);
        textView.setText("Second tab");
        return textView;
    }
}

public static class Page3 extends Fragment {
    /**
     * The fragment argument representing the section number for this
     * fragment.
     */
    public static final String ARG_SECTION_NUMBER = "section_number";

    public Page3() {
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        // Create a new TextView and set its text to the fragment's section
        // number argument value.
        TextView textView = new TextView(getActivity());
        textView.setGravity(Gravity.CENTER_HORIZONTAL | Gravity.RIGHT);
        textView.setText("third tab");
        return textView;
    }
}
} 
```

这实际上有效，但我在第一页只有一个搜索栏。何我可以放他们三个？？？谢谢！！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T18:41:16.053

在这段代码上：

```
 SeekBar sb1 = new SeekBar(getActivity());
    SeekBar sb2 = new SeekBar(getActivity());
    SeekBar sb3 = new SeekBar(getActivity());
    return sb1; 
```

您正在创建 3 个 SeekBars 但只返回第一个。在返回语句之后，其他两个正在被快速收集。在该`onCreateView`方法中，您必须创建一个 GroupView，该组将具有 3 个 SeekBar 或您需要的任何布局。最好/最简单的方法是创建一个 XML 布局并使用`LayoutInflater`在函数上传递的。类似于：

```
@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
        Bundle savedInstanceState) {
    return inflater.inflate(R.layout.frag_page1, null);
} 
```

# ruby - Rails 3 - 更灵活的 time_ago_in_words

> ID：14044144
> 
> 赞同：1
> 
> 时间：2012-12-26T17:46:25.917
> 
> 标签：ruby, ruby-on-rails-3

我认为这是：`Due <%= time_ago_in_words(todo.due) %>`

但与 time_ago_in_words 的大多数用例不同，我需要支持 time AGO 和 time AHEAD。由于到期日可能已过期（时间前）和即将到来（提前时间），我如何有条件地显示它，所以如果它已过期，上面的代码将输出“Due x days ago”，如果它在未来到期输出“在 x 天内到期”？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T18:09:57.877

从外观上看，您正在使用 erb 模板引擎，您可以通过省略 = 符号来执行视图逻辑中的 if 条件所以您可以执行类似这样的操作

```
<% if time_ago < Time.now %>
<%= time_ago_in_words(todo.due) %>
<% else %>
<%= time_ahead_in_words(todo.due) %>
<% end %> 
```

应该让你知道该怎么做。虽然我相信更好的做法可能是将其移至 Rails 应用程序的模型部分。我常见的公理是 Fat Models 瘦控制器，但这更多的是建议而不是规则。

**编辑**

亚历克斯是否在下面的评论中提到这可能应该使用辅助方法而不是应用程序的模型部分

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T18:19:27.360

您可以像这样创建自己的助手：

```
def time_diff_in_words(from_time)
  # compute days difference from now
  days_delta = (Time.now - from_time) / (24 * 60 * 60)  
  # render text
  days = pluralize(days_delta, 'day')
  days_delta > 0 ? "Due #{days} ago" : "Due in #{days}"       
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-26T18:16:58.697

在您的模型中有：

```
class Someclass < ActiveRecord::Base

attr_reader :time_diff

def time_diff
    time_difference = 
      if todo.due > Time.new()
        todo - Time.new()
      else
        Time.new() - todo.due
      end
    end
    time_difference.strftime("%I:%M%p")  # This gets returned.  
end 
```

在您看来：

```
<%= time_in_words(@db_record.time_diff) %>

Where @db_record is a row in the database table for the model in question. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-26T19:49:33.233

如果您确实处理自然语言日期时间解析，我推荐[慢性宝石](https://github.com/mojombo/chronic)

它有多种日期时间解析方式

高温高压

# prolog - Prolog 中的检查列表

> ID：14044146
> 
> 赞同：1
> 
> 时间：2012-12-26T17:46:50.083
> 
> 标签：prolog

我正在尝试做一个在 Prolog 中有限制的时间表。调度将基于两个约束。同一学期的课程和同一名教师教授的课程不能安排在同一时间段。

`course(ceng123,1).` 课程代码和学期课程。

`slot(monday,1).` 一天一小时。

`teaches(jack,ceng123).` 教师和课程代码。

```
 course(cse111,1).
 course(cse112,1).
 course(cse113,1).
 course(cse114,1).
 course(cse115,2).
 course(cse116,2).
 course(cse117,2).
 course(cse118,2).
 slot(monday,1).
 slot(monday,2).
 slot(tuesday,1).
 slot(tuesday,2).
 teaches(erkan,cse111).
 teaches(erkan,cse112).
 teaches(erkan,cse113).
 teaches(erkan,cse114).
 teaches(merkan,cse115).
 teaches(merkan,cse116).
 teaches(kan,cse117).
 teaches(kan,cse118). 
```

我期望的答案是：

```
 ?- schedule([cse111,cse112,cse113,cse114,cse115,cse116,cse117,cse118],X).
 X = [cse111, monday, 1, cse112, monday, 2, cse113, tuesday, 1, cse114, tuesday, 2, cse115, monday, 1, cse116, monday, 2, cse117, tuesday, 1, cse118, tuesday, 2] 
```

我写了一个没有约束的代码：

```
 course(cse111,1).
 course(cse112,1).
 course(cse113,1).
 course(cse114,1).
 course(cse115,2).
 course(cse116,2).
 course(cse117,2).
 course(cse118,2).
 slot(monday,1).
 slot(monday,2).
 slot(tuesday,1).
 slot(tuesday,2).
 teaches(erkan,cse111).
 teaches(erkan,cse112).
 teaches(erkan,cse113).
 teaches(erkan,cse114).
 teaches(merkan,cse115).
 teaches(merkan,cse116).
 teaches(kan,cse117).
 teaches(kan,cse118).

 schedule([],[]).
 schedule([Course|CourseTail],[Course,Day,Slot|ScheduleTail]):-
     slot(Day,Slot),schedule(CourseTail,ScheduleTail). 
```

没有问题，但是当我尝试这个时；

```
 course(cse111,1).
 course(cse112,1).
 course(cse113,1).
 course(cse114,1).
 course(cse115,2).
 course(cse116,2).
 course(cse117,2).
 course(cse118,2).
 slot(monday,1).
 slot(monday,2).
 slot(tuesday,1).
 slot(tuesday,2).
 teaches(erkan,cse111).
 teaches(erkan,cse112).
 teaches(erkan,cse113).
 teaches(erkan,cse114).
 teaches(merkan,cse115).
 teaches(merkan,cse116).
 teaches(kan,cse117).
 teaches(kan,cse118).     

 schedule([],[]).
 schedule([Course|CourseTail],[Course,Day,Slot|ScheduleTail]):-
     schedule(CourseTail,ScheduleTail), check(Course,Day,Slot,ScheduleTail).

 check(_, _, _,[]).
 check(Course,Day,Slot,[Course2,Day2,Slot2|Tail]):- check(Course,Day,Slot,Tail),
     course(Course,Semester1),course(Course2,Semester2),Semester1=\=Semester2, 
     slot(Day,Slot),slot(Day2,Slot2). 
```

我试图写约束，但我出错了。

```
 uncaught exception: error(syntax_error('user_input:1 (char:4) . or operator expected           after expression'),read_term/3) 
```

你能看出错误吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T18:10:37.203

单例变量是在程序中只提到一次的变量：[参见 wiki](http://en.wikipedia.org/wiki/Singleton_variable)。你得到了第 27 行的内容，我认为是这个： `check(Course,Day,Slot,[])`. 您可以将其替换为 `check(_, _, _,[])`. （'_' 表示任何变量。这意味着您可以普遍量化变量。）

您不会收到错误消息。Prolog 说不只是意味着无法满足您的约束。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T14:19:17.320

您应该首先明确定义您的约束。从您的评论中，我读到： **一个小时内的两门课程不能有相同的学期编号，同一位老师的课程不会在同一小时内。**

因此，您可以在课程满足这些要求时为其分配时间表，暗示您必须知道哪些作业已经发布。因此，您可以创建一个保留当前计划的程序，并且仅在满足您的要求时添加新分配。

因此，首先定义您的`schedule/2`过程，该过程调用一个`schedule/3`带有空列表的新过程：

```
schedule(Courses,Schedule):-
   schedule(Courses, [], Schedule). 
```

现在，此过程在第一个参数上具有要分配时间表的课程列表，将当前作业与第二个参数保持一致，并将第三个参数与最终时间表（使用您需要的数据，即课程、日期和时段）统一起来. 我将使用一个结构来表示每个分配`schedule(Course, Day, Slot)`，因为将这些数据混合在一个列表中并不是一个好主意。

```
schedule([], _, []).
schedule([Course|CourseTail], Courses, [schedule(Course,Day,Slot)|ScheduleTail]):-
% Two courses in an hour cannot have same semester number and same teacher's courses will not be in same hour.
     course(Course, Semester),
     teaches(Teacher, Course),
     slot(Day, Slot),
     \+ member(s(Day, Slot, Semester, _), Courses),
     \+ member(s(Day, Slot, _, Teacher), Courses),
     schedule(CourseTail, [s(Day, Slot, Semester, Teacher)|Courses], ScheduleTail). 
```

第一个子句是基本情况。它指出，当输入列表中没有更多课程时，时间表将为空。

第二个子句从输入列表中获取第一门课程，并为该课程计算可能的学期、教师和日/时段，然后检查是否满足约束条件。它测试是否已经有该日/时段/学期的时间表，以及在该日/时段是否已经有教师的作业。如果满足要求，则我们将此分配添加到当前分配列表中并继续递归。

返回后，我们将课程/天/时段添加到最终时间表的列表中。

# python - 来自几张图像的动画精灵

> ID：14044147
> 
> 赞同：15
> 
> 时间：2012-12-26T17:46:58.677
> 
> 标签：python, animation, pygame, sprite, pygame-surface

我一直在寻找一些关于使用 Pygame 从 Python 中的少量图像制作简单精灵动画的好教程。我还没有找到我要找的东西。

我的问题很简单：如何从几张图像制作动画精灵（例如：制作几张尺寸为 20x20px 的爆炸图像作为一个但动画）

有什么好主意吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2017-02-02T22:05:27.320

有两种类型的动画：**frame-dependent**和**time-dependent**。两者都以类似的方式工作。

* * *

## 在主循环之前

1.  将所有图像加载到列表中。
2.  创建三个变量：
    1.  `index`，跟踪图像列表的当前索引。
    2.  `current_time`或者`current_frame`自上次索引切换以来跟踪当前时间或当前帧。
    3.  `animation_time`或者`animation_frames`定义在切换图像之前应该经过多少秒或帧。

* * *

## 在主循环期间

1.  增加`current_time`自我们上次增加它以来经过的秒数，或增加`current_frame`1。
2.  检查是否`current_time >= animation_time`或`current_frame >= animation_frame`。如果为真，请继续 3-5。
3.  重置`current_time = 0`或`current_frame = 0`。
4.  增加索引，除非它等于或大于图像的数量。在这种情况下，重置`index = 0`.
5.  相应地更改精灵的图像。

* * *

## 一个完整的工作示例

```
import os
import pygame
pygame.init()

SIZE = WIDTH, HEIGHT = 720, 480
BACKGROUND_COLOR = pygame.Color('black')
FPS = 60

screen = pygame.display.set_mode(SIZE)
clock = pygame.time.Clock()

def load_images(path):
    """
    Loads all images in directory. The directory must only contain images.

    Args:
        path: The relative or absolute path to the directory to load images from.

    Returns:
        List of images.
    """
    images = []
    for file_name in os.listdir(path):
        image = pygame.image.load(path + os.sep + file_name).convert()
        images.append(image)
    return images

class AnimatedSprite(pygame.sprite.Sprite):

    def __init__(self, position, images):
        """
        Animated sprite object.

        Args:
            position: x, y coordinate on the screen to place the AnimatedSprite.
            images: Images to use in the animation.
        """
        super(AnimatedSprite, self).__init__()

        size = (32, 32)  # This should match the size of the images.

        self.rect = pygame.Rect(position, size)
        self.images = images
        self.images_right = images
        self.images_left = [pygame.transform.flip(image, True, False) for image in images]  # Flipping every image.
        self.index = 0
        self.image = images[self.index]  # 'image' is the current image of the animation.

        self.velocity = pygame.math.Vector2(0, 0)

        self.animation_time = 0.1
        self.current_time = 0

        self.animation_frames = 6
        self.current_frame = 0

    def update_time_dependent(self, dt):
        """
        Updates the image of Sprite approximately every 0.1 second.

        Args:
            dt: Time elapsed between each frame.
        """
        if self.velocity.x > 0:  # Use the right images if sprite is moving right.
            self.images = self.images_right
        elif self.velocity.x < 0:
            self.images = self.images_left

        self.current_time += dt
        if self.current_time >= self.animation_time:
            self.current_time = 0
            self.index = (self.index + 1) % len(self.images)
            self.image = self.images[self.index]

        self.rect.move_ip(*self.velocity)

    def update_frame_dependent(self):
        """
        Updates the image of Sprite every 6 frame (approximately every 0.1 second if frame rate is 60).
        """
        if self.velocity.x > 0:  # Use the right images if sprite is moving right.
            self.images = self.images_right
        elif self.velocity.x < 0:
            self.images = self.images_left

        self.current_frame += 1
        if self.current_frame >= self.animation_frames:
            self.current_frame = 0
            self.index = (self.index + 1) % len(self.images)
            self.image = self.images[self.index]

        self.rect.move_ip(*self.velocity)

    def update(self, dt):
        """This is the method that's being called when 'all_sprites.update(dt)' is called."""
        # Switch between the two update methods by commenting/uncommenting.
        self.update_time_dependent(dt)
        # self.update_frame_dependent()

def main():
    images = load_images(path='temp')  # Make sure to provide the relative or full path to the images directory.
    player = AnimatedSprite(position=(100, 100), images=images)
    all_sprites = pygame.sprite.Group(player)  # Creates a sprite group and adds 'player' to it.

    running = True
    while running:

        dt = clock.tick(FPS) / 1000  # Amount of seconds between each loop.

        for event in pygame.event.get():
            if event.type == pygame.QUIT:
                running = False
            elif event.type == pygame.KEYDOWN:
                if event.key == pygame.K_RIGHT:
                    player.velocity.x = 4
                elif event.key == pygame.K_LEFT:
                    player.velocity.x = -4
                elif event.key == pygame.K_DOWN:
                    player.velocity.y = 4
                elif event.key == pygame.K_UP:
                    player.velocity.y = -4
            elif event.type == pygame.KEYUP:
                if event.key == pygame.K_RIGHT or event.key == pygame.K_LEFT:
                    player.velocity.x = 0
                elif event.key == pygame.K_DOWN or event.key == pygame.K_UP:
                    player.velocity.y = 0

        all_sprites.update(dt)  # Calls the 'update' method on all sprites in the list (currently just the player).

        screen.fill(BACKGROUND_COLOR)
        all_sprites.draw(screen)
        pygame.display.update()

if __name__ == '__main__':
    main() 
```

* * *

## 什么时候选哪个

**时间相关**动画允许您以相同的速度播放动画，无论帧速率有多慢/快或您的计算机有多慢/快。这允许您的程序在不影响动画的情况下自由更改帧率，即使计算机无法跟上帧率，它也将保持一致。如果程序滞后，动画将赶上它本应处于的状态，就好像没有发生滞后一样。

虽然，动画周期可能与帧速率不同步，使动画周期看起来不规则。例如，假设我们每 0.05 秒更新一次帧，每 0.075 秒更新一次动画切换图像，那么循环将是：

1.  第一帧；0.00 秒；图 1
2.  第 2 帧；0.05 秒；图 1
3.  第 3 帧；0.10 秒；图 2
4.  第 4 帧；0.15 秒；图 1
5.  第 5 帧；0.20 秒；图 1
6.  第 6 帧；0.25 秒；图 2

等等...

**如果您的计算机能够始终如一地处理帧速率，则**取决于帧的看起来会更流畅。**如果发生延迟，它将在当前状态下暂停并在延迟停止时重新启动，这使得延迟更加明显。这种替代方案更容易实现，因为您只需要`current_frame`在每次调用时递增 1，而不是处理增量时间 ( `dt`) 并将其传递给每个对象。**

 **## 精灵

[![在此处输入图像描述](../Images/f168ed8dc60fff1e712a555f3a302660.png)](https://i.stack.imgur.com/AlT2O.png) [![在此处输入图像描述](../Images/8aed3e50f4c87154f97978d9ee9abc4d.png)](https://i.stack.imgur.com/KMT7R.png) [![在此处输入图像描述](../Images/4352353e35bdeb83bdf18d3991e67246.png)](https://i.stack.imgur.com/kKgeU.png) [![在此处输入图像描述](../Images/b43fb352dfe82ff6c2c307d6c507dcb3.png)](https://i.stack.imgur.com/hhznj.png) [![在此处输入图像描述](../Images/9e6eec7ee8f3bc3f4d088df37c168113.png)](https://i.stack.imgur.com/qg2wI.png) [![在此处输入图像描述](../Images/d84176116a56b8ef269b6c2fc6dc2e53.png)](https://i.stack.imgur.com/smXwB.png)

## 结果

[![在此处输入图像描述](../Images/099a436a333458db94eca08c87c5c196.png)](https://i.stack.imgur.com/Th7Fg.gif)

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-12-26T17:53:00.247

您可以尝试修改您的精灵，以便将其图像换成内部的不同图像`update`。这样，当精灵被渲染时，它会看起来是动画的。

**编辑**：

这是我绘制的一个简单示例：

```
import pygame
import sys

def load_image(name):
    image = pygame.image.load(name)
    return image

class TestSprite(pygame.sprite.Sprite):
    def __init__(self):
        super(TestSprite, self).__init__()
        self.images = []
        self.images.append(load_image('image1.png'))
        self.images.append(load_image('image2.png'))
        # assuming both images are 64x64 pixels

        self.index = 0
        self.image = self.images[self.index]
        self.rect = pygame.Rect(5, 5, 64, 64)

    def update(self):
        '''This method iterates through the elements inside self.images and 
        displays the next one each tick. For a slower animation, you may want to 
        consider using a timer of some sort so it updates slower.'''
        self.index += 1
        if self.index >= len(self.images):
            self.index = 0
        self.image = self.images[self.index]

def main():
    pygame.init()
    screen = pygame.display.set_mode((250, 250))

    my_sprite = TestSprite()
    my_group = pygame.sprite.Group(my_sprite)

    while True:
        event = pygame.event.poll()
        if event.type == pygame.QUIT:
            pygame.quit()
            sys.exit(0)

        # Calling the 'my_group.update' function calls the 'update' function of all 
        # its member sprites. Calling the 'my_group.draw' function uses the 'image'
        # and 'rect' attributes of its member sprites to draw the sprite.
        my_group.update()
        my_group.draw(screen)
        pygame.display.flip()

if __name__ == '__main__':
    main() 
```

它假定您调用了两个图像`image1.png`，并且`image2.png`在代码所在的同一文件夹中。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-26T18:02:08.223

您应该将所有精灵动画放在一个大“画布”上，因此对于 3 个 20x20 的爆炸精灵帧，您将拥有 60x20 的图像。现在您可以通过加载图像的一个区域来获得正确的帧。

在你的精灵类中，很可能在更新方法中你应该有这样的东西（为了简单起见，我更喜欢有单独的类来负责选择正确的动画帧）。`self.f = 0`上`__init__`。

```
def update(self):
    images = [[0, 0], [20, 0], [40, 0]]
    self.f += 1 if self.f < len(images) else 0
    self.image = your_function_to_get_image_by_coordinates(images[i]) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-11-03T19:01:49.603

对于动画*Sprite*[`pygame.Surface`](https://www.pygame.org/docs/ref/surface.html) ，必须生成图像（对象）列表。列表的不同图片显示在每一帧中，就像电影图片一样。这给出了动画对象的外观。
获取图像列表的一种方法是加载动画[*GIF*（图形交换格式）](https://de.wikipedia.org/wiki/Graphics_Interchange_Format)。不幸的是，PyGame 不提供加载动画 GIF 帧的功能。但是，有几个 Stack Overflow 答案可以解决这个问题：

*   [如何加载动画 GIF 并获取 PyGame 中的所有单独帧？](https://stackoverflow.com/questions/29571399/how-can-i-load-an-animated-gif-and-get-all-of-the-individual-frames-in-pygame)
*   [如何在pygame中将精灵制作为gif？](https://stackoverflow.com/questions/64179680/how-do-i-make-a-sprite-as-a-gif-in-pygame/64182074#64182074)
*   [Pygame 和 Numpy 动画](https://stackoverflow.com/questions/54415196/pygame-and-numpy-animations)

一种方法是使用流行的[Pillow](https://pillow.readthedocs.io/en/stable/)库（[*pip install Pillow*](https://pypi.org/project/Pillow/)）。以下函数加载动画*GIF*的帧并生成`pygame.Surface`对象列表：

```
from PIL import Image, ImageSequence 
```

```
def loadGIF(filename):
    pilImage = Image.open(filename)
    frames = []
    for frame in ImageSequence.Iterator(pilImage):
        frame = frame.convert('RGBA')
        pygameImage = pygame.image.fromstring(
            frame.tobytes(), frame.size, frame.mode).convert_alpha()
        frames.append(pygameImage)
    return frames 
```

创建一个[`pygame.sprite.Sprite`](https://www.pygame.org/docs/ref/sprite.html#pygame.sprite.Sprite)维护图像列表的类。实现一个更新方法，在每一帧中选择不同的图像。
将图像列表传递给类构造函数。添加一个`index`属性，指示当前图像在列表中的索引。增加`Update`方法中的索引。如果索引大于或等于图像列表的长度，则重置索引（或使用模 ( `%`) 运算符）。通过订阅从列表中获取当前图像：

```
class AnimatedSpriteObject(pygame.sprite.Sprite):
    def __init__(self, x, bottom, images):
        pygame.sprite.Sprite.__init__(self)
        self.images = images
        self.image = self.images[0]
        self.rect = self.image.get_rect(midbottom = (x, bottom))
        self.image_index = 0
    def update(self):
        self.image_index += 1
        if self.image_index >= len(self.images):
            self.image_index = 0
        self.image = self.images[self.image_index] 
```

另请参阅[加载动画 GIF](https://stackoverflow.com/questions/14044147/animated-sprite-from-few-images/64668964#64668964)和[Sprite](https://github.com/Rabbid76/PyGameExamplesAndAnswers/blob/master/documentation/pygame/pygame_sprite_and_sprite_mask.md)

GIF 示例（来自[Animated Gifs, Animated Image](https://www.animatedimages.org/)）：

[![](../Images/7eaff7295935fa94fd1d8400e71dbc96.png)](https://i.stack.imgur.com/4QLTx.gif)

最小的例子：`[![](../Images/1046507529a28f50314afc43ea70d681.png) repl.it/@Rabbid76/PyGame-SpriteAnimation](https://repl.it/@Rabbid76/PyGame-SpriteAnimation#main.py)`

[![](../Images/4a221e573987e4e52520b2d2e680da91.png)](https://i.stack.imgur.com/SzKwL.gif)

```
import pygame
from PIL import Image, ImageSequence

def loadGIF(filename):
    pilImage = Image.open(filename)
    frames = []
    for frame in ImageSequence.Iterator(pilImage):
        frame = frame.convert('RGBA')
        pygameImage = pygame.image.fromstring(
            frame.tobytes(), frame.size, frame.mode).convert_alpha()
        frames.append(pygameImage)
    return frames

class AnimatedSpriteObject(pygame.sprite.Sprite):
    def __init__(self, x, bottom, images):
        pygame.sprite.Sprite.__init__(self)
        self.images = images
        self.image = self.images[0]
        self.rect = self.image.get_rect(midbottom = (x, bottom))
        self.image_index = 0
    def update(self):
        self.image_index += 1
        self.image = self.images[self.image_index % len(self.images)]
        self.rect.x -= 5
        if self.rect.right < 0:
            self.rect.left = pygame.display.get_surface().get_width()

pygame.init()
window = pygame.display.set_mode((300, 200))
clock = pygame.time.Clock()
ground = window.get_height() * 3 // 4

gifFrameList = loadGIF('stone_age.gif')
animated_sprite = AnimatedSpriteObject(window.get_width() // 2, ground, gifFrameList)    
all_sprites = pygame.sprite.Group(animated_sprite)

run = True
while run:
    clock.tick(20)
    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            run = False

    all_sprites.update()

    window.fill((127, 192, 255), (0, 0, window.get_width(), ground))
    window.fill((255, 127, 64), (0, ground, window.get_width(), window.get_height() - ground))
    all_sprites.draw(window)
    pygame.display.flip()

pygame.quit()
exit() 
```**

# javascript - 计算后总值不变

> ID：14044149
> 
> 赞同：1
> 
> 时间：2012-12-26T17:47:09.613
> 
> 标签：javascript, jquery, html

我在[这里](http://jsfiddle.net/fCuXE/5/)有一个 jsfiddle 。

在小提琴中有许多标记文本框。在文本框中输入一个数字，然后继续单击添加问题按钮。您将看到剩余的总分相等`10`，但不会改变。剩余的标记数应通过减去附加行中的每个数字来改变。

例如，如果剩余总分是`10`并且您附加四行，每行包含 的分数`1`，那么剩余总分应该是`6`。( `10 - 4 = 6`.) 但是为什么它没有改变剩余的分数呢？

这是它执行计算的函数：

```
function calculateTotal()
{
   var totalweight = totalmarks;
   $("#qandatbl td.weight input").each(function (i, elm){
        totalweight = totalweight - Number($(elm).val(), 10);
    });

    $("#total-weight").text(totalweight);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T18:00:10.070

对于您的具体问题，您似乎想从中获取值`table#qandatbl_onthefly`not `table#qandatbl`。

```
function calculateTotal() {
    var totalweight = totalmarks;
    $("#qandatbl_onthefly td.weight input").each(function(i, elm) {
        totalweight = totalweight - Number($(elm).val(), 10);
    });
    $("#total-weight").text(totalweight);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T18:00:16.217

根据您的 jsfiddle，您在 table#quandatbl 中没有输入。尝试将功能更改为

```
function calculateTotal()
{
   var totalweight = totalmarks;
   $("#qandatbl_onthefly_container td.weight input").each(function (i, elm){
        totalweight = totalweight - Number($(elm).val(), 10);
    });

    $("#total-weight").text(totalweight);
} 
```

# php - 在php中对mysql查询进行排序

> ID：14044151
> 
> 赞同：-2
> 
> 时间：2012-12-26T17:47:23.343
> 
> 标签：php, mysql

我按顺序从 db 行获取 10、12、13、21、06、02、08

我需要这样排序：02、06、08、10、12、13、21

按字段排序 ASC 不起作用我需要。我尝试删除零然后对数组进行排序，但没有结果。有什么想法吗？

欧梅里

sort(ARRAY) 成功了

```
$sql = "SELECT DISTINCT l, item, l, s FROM tr WHERE s = '".$_POST['size']."'  AND type = '".$type."' ORDER BY l ASC";
            $res = mysql_query($sql,$this->conn);
            $type = '<option selected="selected" disabled="disabled"></option>';

            while($row = mysql_fetch_array($res)){
                 $caption[] = $row;
            }
            sort($caption);
            foreach($caption as $row) {     

                    $length = substr($row['item'], strrpos($row['item'], '-') + 1);

                    $type .= '<option value="'.$length.'">'.$length.'</option>';
            } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T17:53:18.467

将这些数字的列类型更改为`INT`然后让它们排序。我想你现在有你的`CHAR`柱子`VARCHAR`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T18:54:32.823

@Eric Petroelje 我会使用：

`SELECT * FROM table ORDER BY CAST(col AS SIGNED) ASC`

或者在所有数字前添加零。例如，1 变成 0001，2 变成 0002，这样你就会得到零，它们也会排序。哦，我看到你在下面评论说你也在使用 02 和 2。所以你可以忽略这个。

或者以正确的顺序添加一个额外的 INT 列。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T17:52:17.207

排序应通过 MySQL 服务器完成。如果您没有得到正确的顺序，那么您的查询可能是错误的。另一个问题可能是您将数字存储为文本或其他数据类型？

但是，要删除开头的 0，您可以将变量显式转换为整数：

`$numstring = (int)$realint;`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-26T17:57:31.447

听起来数据以 CHAR 或 VARCHAR 形式存储在 MySQL 中，因此当对列进行排序时，它会像字符串而不是数字一样对其进行排序。

除了将列的类型更改为 INT 之外，您还可以强制 MySQL 将其视为整数以进行排序（假设列中的所有值都是数字），如下所示：

```
SELECT fields
FROM mytable
ORDER BY CAST(col AS SIGNED) 
```

# php - 构建自定义 RESTful API 还是使用 apify？

> ID：14044152
> 
> 赞同：0
> 
> 时间：2012-12-26T17:47:25.813
> 
> 标签：php, api, rest, laravel

我刚刚被分配了为开发的 Web 应用程序实现 API 服务的任务，建议我在开始编写代码以构建自定义 api 之前检查[apify 。](http://apifydoc.com/)

该应用程序是基于 Laravel 构建的，所以，你有什么建议？我应该去apify吗？我会节省那么多时间和工作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T21:11:12.643

您是否正在实施 RESTful API？如果你使用 Laravel，也许这个包就是你需要的 - [http://bundles.laravel.com/bundle/rest_service_api](http://bundles.laravel.com/bundle/rest_service_api)

另外，看看这里 - [http://laravel.com/docs/controllers#restful-controllers](http://laravel.com/docs/controllers#restful-controllers)

# ruby-on-rails - Rails 更新操作的路由助手是什么？

> ID：14044160
> 
> 赞同：3
> 
> 时间：2012-12-26T17:48:06.547
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rest

我想在我的表单助手中放置一个路由助手来执行`update`操作：

```
<%= s3_uploader_form post: <route helper goes here>, as: "shop[logo_ori]" do %>
  <%= file_field_tag :file %>
<% end %> 
```

但是当我跑步时，`rake routes`我看不到帮助者`PUT`：

```
shops     GET    /shops(.:format)                     shops#index
          POST   /shops(.:format)                     shops#create
new_shop  GET    /shops/new(.:format)                 shops#new
edit_shop GET    /shops/:id/edit(.:format)            shops#edit
shop      GET    /shops/:id(.:format)                 shops#show
          PUT    /shops/:id(.:format)                 shops#update 
```

有问题的表单助手来自 Railscasts#383's [source](https://github.com/railscasts/383-uploading-to-amazon-s3/blob/master/gallery-jquery-fileupload/app/helpers/upload_helper.rb)。我发现上传器表单对于创建新模型对象非常有用，但我很难让它用于更新模型对象。

当我尝试 route helper`shops_url`时，它运行失败的`POST`操作：

```
Started POST "/shops" for 127.0.0.1 at 2012-12-27 01:10:22 +0800
Processing by ShopsController#create as */*
Parameters: {"shop"=>{"logo_ori"=>"https://bucket.s3.amazonaws.com/example.gif"}}
User Load (0.4ms)  SELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1
(0.1ms)  BEGIN
(0.1ms)  ROLLBACK
<additional output redacted> 
```

有什么帮助吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-26T18:13:18.347

虽然 HTTP 和 rack 支持使用 PUT 方法，但浏览器不支持。因此，为了欺骗 put 请求，您需要向您`_method=put`发布的 url 添加一个参数。

rails 中的链接看起来像：

```
<%= link_to "update me", "/link/to/resource", method: :put %> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-26T17:58:51.000

与 show - "shop_path" 相同，因为它指的是相同的 URL。不同的只是方法。Theese Rails 路由助手只指向 url，而不是它的方法，这就是为什么在这种情况下它们是相同的。顺便说一句 - 方法应该是“put:”，而不是“post:”（作为表单助手的参数）

# django - 如何实施投票验证系统？

> ID：14044162
> 
> 赞同：2
> 
> 时间：2012-12-26T17:48:13.330
> 
> 标签：django, validation, voting, voting-system

我正在尝试创建一个简单的限制系统，因此用户不能在一个简单的投票中投票两次（主要像 django 教程中的示例投票）我似乎无法找到我喜欢的方法。

我最喜欢的是在 Choice 模型中有一个 User FK 并在那里添加用户，如下所示：

模型.py

```
vote = models.ForeignKey(User) 
```

视图.py

```
def vote(request):
    # Some validations and stuff...
    vote.add(request.user) 
```

这样我可以将每个选项的投票限制为 1，但我想将每个投票限制为 1。想象一下这样的情况：你有一个有 5 个选项的投票，通过这个验证，用户只能投票 1 次，但每个选项只能投票 1 次，这意味着他/她可以投票 5 次。

对于制作一个每次投票只允许 1 票的系统，您有什么建议？我你需要模型或者我会粘贴它们的东西，这是一个开源项目。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T19:59:16.373

在您的 Poll 模型上，向 User 添加一个 ManyToManyField，表示哪些用户在哪些投票中投票。对于您要显示的每个民意调查，检查该民意调查是否在当前用户的民意调查列表中。如果是，不要让他们投票。

当当前用户在投票中投票时，将该投票添加到当前用户的投票列表中。

# android - 从网络服务获取数据并放在地图上

> ID：14044164
> 
> 赞同：0
> 
> 时间：2012-12-26T17:48:15.200
> 
> 标签：android, json, web-services, rest, maps

我正在 Android 上做一个从 web 服务获取位置并将其放在地图上的应用程序。该应用程序应该每 15 秒执行一次。最好的方法是什么？与 web 服务的通信是使用 REST 架构进行的，并且 web 服务返回一个 JSON。我应该使用服务还是异步任务？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T18:37:10.327

你肯定会在这里看到关于这个主题的不同意见，但我已经使用[ExecutorServices](http://developer.android.com/reference/java/util/concurrent/ScheduledExecutorService.html)有一段时间了，它们工作得非常好。不要忘记在活动暂停时停止它。

其余：如果应用程序应该是一个始终运行的东西（例如 GPS 导航，或某种基于位置的社交游戏），那么您可能想要使用一个也将使用 ExecutorService 的服务，并且不要忘记放置一个通知让用户知道它仍在运行，如果他们愿意，他们可以取消。

# php - 需要丢弃具有空值的数组

> ID：14044165
> 
> 赞同：3
> 
> 时间：2012-12-26T17:48:19.647
> 
> 标签：php, arrays

给定，在输入表单中，用户可以用换行符分隔一些特定的名称，我将这些名称保存在一个数组中。然后我打印这些名字，最后说“谢谢你的名字”。

```
 $var = "name1 

name2

        ";
    $your_array = explode("\n", $var);

        for($i=0; $i<(sizeof($your_array));$i++) {
          echo ($your_array[$i]);  
        }
echo "Thank you for the names" 
```

但问题是，如果有人在一个名字之前或之后输入多个换行符，那么下一个名字会在一段距离后显示，如下所示

```
 name1

    name2

Thank you for the names 
```

如何逃避这个并输出如下

```
name1
name2
Thank you for the names 
```

我尝试使用 array_filter() 但它在这里不起作用。

**更新：**

```
If someone input
$var = "name1\nname2\n\n\n

           name3                     

name4"; 
```

输出应该像

```
name1
name2
               name3
name4 
```

但是所有的答案都像

```
name1
name2
name3
name4 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T18:04:54.123

为简单起见，让我们使用 foreach 循环......

1）我们需要遍历新数组和`trim`名称，所以我们会丢失所有空格。

2) 当且仅当名称的长度为 1 或更多时，我们才回显名称。

3）我们添加一个`<br>`标签，使每个名字出现在一个新的行上。

```
<?php

$var = "name1\nname2\n\n\n";

$your_array = explode("\n", $var);

foreach($your_array as $name)
{
    if(preg_match("/[a-zA-Z0-9]{1,}/i", $name)) {
        $name = trim($name);
        echo (strlen($name) > 1) ? sprintf('%s<br>', $name) : '';
    }
}

echo "Thank you for the names";
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T18:04:10.167

```
$your_array = explode(PHP_EOL, $var);

$names = array();

for ($i = 0; $i < count($your_array); $i ++ )
{
    // trim clean spaces and newlines surrounding each line
    // resulting value is assigned to $test
    // if this value is not empty the conditional is a true proposition
    // so is assigned to $names
    if ($test    = trim($your_array[$i]))
        $names[] = $test;
}

echo implode(PHP_EOL, $names) . PHP_EOL;
echo 'Thank you for the names.'; 
```

**编辑**：使用`foreach`

```
$your_array = explode(PHP_EOL, $var);

foreach ($your_array as $name)
{
    if ($test    = trim($name))
        $names[] = $test;
}

if ($names)
{
    // echo implode(PHP_EOL, $names) . PHP_EOL;
    echo implode('<br />', $names) . '<br />';
    echo 'Thank you for the names.';
}
else
    echo 'Names missing.'; 
```

**编辑 2**

`trim`接受一个 charlist 来显式删除，所以如果你想保持空格，用`newlines`and `carriage return`only 创建一个列表。

```
trim($name, "\r\n"); 
```

* * *

注意：PHP_EOL 是正确的换行符，具体取决于服务器（unix 或 windows）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-26T18:19:46.717

[成为更好的 PHP 开发人员](http://jason.pureconcepts.net/2012/08/better-php-developer/)并使用原生 PHP 数组函数：

```
$raw_arr = array('    trim  ', 'fine', '    ');

array_walk($raw_arr, function(&$value) {
  $value = trim($value);
});

$reduced_arr = array_filter($raw_arr);

print_r($reduced_arr); 
```

**注意：**我使用了闭包。如果您正在运行 PHP < 5.3，则需要将其移动到 UDF。

### 更新

似乎您不希望修剪用户输入。因此，您可以放下`array_walk`并关闭它。

```
$raw_arr = array('    trim  ', 'fine', '');
$reduced_arr = array_filter($raw_arr);

print_r($reduced_arr); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-26T18:06:08.680

```
for($i=0; $i<(sizeof($your_array));$i++) {
    if (empty($your_array[$i])) continue;
          echo ($your_array[$i]);  
        }
echo "Thank you for the names" 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-26T19:58:20.927

您可以使用`array_filter`++`array_map`丢弃`trim`空白空间

```
$var = "name1 

name2

        ";

$array = array_filter(array_map("trim",explode("\n", $var)));
echo implode(PHP_EOL, $array) , PHP_EOL;
echo "Thank you for the names"; 
```

或者只是使用 `preg_match_all`

```
preg_match_all("/\S?([a-z0-9]+)\S?/", $var,$array);
echo implode(PHP_EOL, $array[0]),PHP_EOL;
echo "Thank you for the names"; 
```

两者都会输出

```
name1
name2
Thank you for the names 
```

# c++ - 我可以在 OpenFrameworks 中调用 testApp 以外的应用程序吗？

> ID：14044166
> 
> 赞同：1
> 
> 时间：2012-12-26T17:48:20.473
> 
> 标签：c++, visual-studio-2010, openframeworks

我第一次使用 OpenFrameworks（我对 C++ 也很生疏）。

我正在尝试使用 OFX 构建一个应用程序，并且我想将我的应用程序称为 testApp 以外的名称。我正在构建 openCVExample 代码，我已经用新名称替换了任何地方的 testApp 并将文件`testApp.{h,cpp}`从`newname.{h,cpp}`.

但是，当我尝试构建时（使用 Microsoft Visual C++ 2010 Express，如果这会有所不同），我看到`testApp.cpp`文件正在生成，其中包含 src/ 文件夹中的内容`newname.cpp`并将其放入我的 src/ 文件夹中。我也被构建所困扰，说 testApp`newname.cpp`在我试图调用或定义成员函数的所有行上都不是有效的命名空间（我正在使用`newname::functionName`）。

我查看了构建命令行，它似乎没有在寻找`testApp.cpp`；我还查看了链接器和其他东西，但没有看到那里提到它。这是 OpenFrameworks 的一些奇怪的功能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T17:31:57.917

在 openframeworks 目录中，有一个项目创建者应用程序将为您执行此操作。

D:\workspace\of_v0073_vs2010_release\projectGenerator\projectGenerator.exe

它还将设置您下载的插件。

注意:: 它为 VS 2010 创建解决方案，我假设这可以通过 Express 打开？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T00:23:42.403

您需要在几个地方将“testApp”的实例更改为“newname”：

1.  在 testApp.h 中，您需要更改应用的类名。这可能是第 5 行，看起来像`class testApp : public ofBaseApp`

2.  在 testApp.cpp 中，您需要更改所有函数定义以使用“newname”命名空间。这些都是看起来像的线条`void testApp::setup()`

3.  在 main.cpp 中，您需要将参数`ofRunApp()`从更改`new testApp()`为`new newname()`

您实际上*不必*从 testApp.{h,cpp} 更改文件的名称，尽管从组织的角度来看这仍然是一个好主意。

# tfs - TFS 2008 WIT - 限制 System.AssignedTo 基于其他字段中的组选择

> ID：14044167
> 
> 赞同：1
> 
> 时间：2012-12-26T17:48:28.200
> 
> 标签：tfs, schema, tfs-workitem

我正在尝试创建一个字段 ALLOWEDVALUES 规则来限制基于另一个字段的用户分配。举个例子。

用户组

[项目]\开发人员
[项目]\项目经理

在 TFS 工作项跟踪表单中，我有两个字段

受让人组：
受让人[System.AssignedTo]：

根据 Assignee Group 中的值，我想将 System.AssignedTo 中的用户列表限制为所选组中的任何用户。

想法？我似乎找不到与我正在寻找的答案相匹配的答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T05:41:57.190

打开电动工具选择项目，选择工作项类型，打开工作流程，然后选择您要限制用户的状态

```
work item=task
state=propose
assign to=developers

what u have to do for that simply go on the state propose select new> add assign to >add new rule>valid user>select the developers group. 
```

现在，当您创建一个任务并且它的状态是建议时，那么只有开发人员将显示在分配给字段中。如果有帮助，请投票回答。随时寻求任何帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T19:33:35.813

您可能会发现这篇文章很有帮助[TFS“分配给”显示了太多用户](https://stackoverflow.com/questions/11771030/tfs-assign-to-is-showing-too-many-users)

在您的情况下，请确保添加`for`属性以将规则应用于特定用户组。检查架构参考： http: [//msdn.microsoft.com/en-US/library/aa337646 (v=vs.80).aspx](http://msdn.microsoft.com/en-US/library/aa337646(v=vs.80).aspx)

# jquery - 使用 jquery fileupload basic 以编程方式删除文件

> ID：14044168
> 
> 赞同：17
> 
> 时间：2012-12-26T17:48:34.393
> 
> 标签：jquery, jquery-plugins, file-upload, blueimp

我正在使用 blueimp 文件上传插件（基本版）来实现多文件上传。我正在尝试实现允许用户删除排队文件以进行上传的功能。我无法弄清楚如何正确访问文件数组。每次在添加回调中，索引为 0，文件数组长度为 1（它只包含用户单击删除的文件）。我正在为每个排队到 div 的文件添加一个链接，该链接是可单击的，如果单击，则应删除该文件。

我的想法是创建一个带有文件索引的删除链接并将其从数组中删除，但由于上述问题，索引永远不会正确。我也尝试过文件名，但“on”回调中的文件名始终是第一个选择上传的文件——我必须弄清楚一些闭包范围。

如何以编程方式从上传队列中删除文件？

HTML：

```
<div id="fileBrowserWrapper">
    <form id="myForm" action="#" method="post" enctype="multipart/form-data">
        <input id="uploadDocBrowse" type="file" name="files[]" multiple/>                                                    
    </form>
</div>
<div id="inputFilesBox"></div>
<div id="uploadFilesBox"></div> 
```

和文件上传JavaScript：

```
$('#myForm').fileupload({
    url: "/SomeHandler",
    dataType: 'html',
    autoUpload: false,
    singleFileUploads: false,
    replaceFileInput: false,
    add: function (e, data) {
        console.log("Number of files: " + data.files.length);

        $.each(data.files, function (index, file) {                                       
            $('#uploadFilesBox').append("<div class='uploadBox' id='fileDiv_" + file.name + "'><div class='leftEle'><a href='#' id='link_" + index + "' class='removeFile'>Remove</a></div><div class='midEle'>" + file.name + "</div></div>")
            .on('click', { filename: file.name, files: data.files }, function(event) {                            
                var uploadFilesBox = $("#uploadFilesBox");
                var remDiv = $("#fileDiv_" + event.data.filename);
                remDiv.remove();
                event.data.files.splice(0, 1);                              
            }
        });
    });

    data.context = $('#myButton')
    .click(function () {
        data.submit();
    });              
}); 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-26T21:36:45.027

我解决了这个问题。这是带有描述的解决方案：

在对它进行了更多修改后，我找到了我的解决方案。关键是要记住我正在回电。因此，在删除功能的事件处理程序中，我只是将 data.files 数组清零，在该处理程序的提交中，我仅在 files 数组的长度大于 0 时提交。我清理了事件处理程序函数，所以眼睛更容易。HTML 不变。

新的 JavaScript 处理代码：

```
 $('#myForm').fileupload({
            url: "/SomeUrl",
            dataType: 'html',            
            add: function (e, data) {
                $.each(data.files, function (index, file) {
                    var newFileDiv = $("<div class='uploadBox' id='fileDiv_" + file.name + "'><div class='leftEle'><a href='#' id='link_" + index + "' class='removeFile'>Remove</a></div><div class='midEle'>" + file.name + "</div></div>");
                    $('#uploadFilesBox').append(newFileDiv);

                    newFileDiv.find('a').on('click', { filename: file.name, files: data.files }, function (event) {                        
                        event.preventDefault();
                        var uploadFilesBox = $("#uploadFilesBox");
                        var remDiv = $(document.getElementById("fileDiv_" + event.data.filename));
                        remDiv.remove();                        
                        data.files.length = 0;    //zero out the files array                                     
                    });

                    data.context = newFileDiv;
                });

                $('#myButton')
                    .click(function () {
                        if (data.files.length > 0) {     //only submit if we have something to upload
                            data.submit();
                        }                                                    
                    });
            }
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-05-05T06:18:49.337

感谢@Furynation。

我所做的与您的方法相似。对于我选择的每个文件，我都会在表格中添加一行（上传前提交）。我将此行分配给 data.context 以供以后使用。

见： [https ://github.com/blueimp/jQuery-File-Upload/issues/3083](https://github.com/blueimp/jQuery-File-Upload/issues/3083)

我的代码片段在添加回调处理程序中：

```
 $("#upload").click(function () {
                 if (data.files.length > 0) { 
                     data.submit();
                 }
            });
            data.context.find('a').on('click',function (event) {  
                event.preventDefault();
                data.context.remove();   
                data.files.length = 0;   
            }); 
```

这将删除表格行并重置数组。

如果有更清洁的方法，请告诉我。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-24T22:31:21.367

**适用于多个文件**`.splice()`- 它检查所有文件并且当有错误的文件是所有文件中间的一个（喜欢或`.lenght=0`做）时不会中断。**想法是：**进行验证**->**如果错误：将文件索引标记为错误**->**在所有文件之后/上传之前：删除/删除错误的索引/文件`$.grep()` **->**一起上传好文件`singleFileUploads: false`。

```
$(this).fileupload({
        // ...
        singleFileUploads: false,   // << send all together, not single
        // ...
        add: function (e, data) {

            // array with all indexes of files with errors
            var error_uploads_indexes = [];

            // when add file - each file
            $.each(data.files, function(index, file) {

                // array for all errors - in example is only one: size
                var uploadErrors = [];

                // ... validation

                        // check size
                        if(data.files[index]['size'] > 1048576) {
                            uploadErrors.push('Filesize is too big');
                        };
                // ...

                // when errors
                if(uploadErrors.length > 0) {

                    // mark index of error file
                    error_uploads_indexes.push(index);
                    // alert error
                    alert(uploadErrors.join("\n"));

                };

            }); // << each

            // remove indexes (files) with error
            data.files = $.grep( data.files, function( n, i ) {
                return $.inArray(i, error_uploads_indexes) ==-1;
            });

            // if are files to upload
            if(data.files.length){
                // upload by ajax
                var jqXHR = data.submit().done(function (result, textStatus, jqXHR) {
                        //...
                     alert('done!') ;
                        // ...
                });
            } // 

        },
        // ...
    }); // << file_upload 
```

# java - 在 mvn 中定义 $JAVA_HOME

> ID：14044169
> 
> 赞同：1
> 
> 时间：2012-12-26T17:48:38.307
> 
> 标签：java, shell, maven

我的`mvn`脚本定义`JAVA_HOME`如下：

```
 53 case "`uname`" in
 54   CYGWIN*) cygwin=true ;;
 55   MINGW*) mingw=true;;
 56   Darwin*) darwin=true
 57            if [ -z "$JAVA_HOME" ] ; then
 58              JAVA_HOME=/path/to/java/home
 59            fi
 60            ;;
 61 esac 
```

`$JAVA_HOME`据我了解，如果未在其他地方设置，则上述内容将设置。

现在..这怎么可能`$JAVA_HOME`是未定义的`.zshrc`，我很清楚

```
 34 JAVA_HOME=/path/to/java/home 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T17:50:08.953

也许，它需要`export`在你的 .zshrc 中：

```
export JAVA_HOME=/path/to/java/home 
```

# c# - 我想在 Windows 商店应用程序中添加图像作为网格的背景，但我有一个错误

> ID：14044175
> 
> 赞同：0
> 
> 时间：2012-12-26T17:49:13.907
> 
> 标签：c#, .net

我有一个像 URI 格式异常这样的异常，为什么它会发生，尽管它是正确的

```
ImageBrush img1 = new ImageBrush();
img1.ImageSource = new BitmapImage(new Uri("/Assets/new.jpg")); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T22:55:52.693

该 URI 不适用于 Windows 应用商店应用程序 (RT/Metro)。

尝试这个：

```
new Uri("ms-appx:///assets/new.jpg"); 
```

# javascript - JS 或 Jquery 创建唯一的 span ID

> ID：14044178
> 
> 赞同：8
> 
> 时间：2012-12-26T17:49:20.507
> 
> 标签：javascript, jquery, html

我正在创建一个内部有跨度的 li 项目。我在 span 中构建了一个 onclick 函数来获取父 li 的 ID 以传递给 JSON 获取请求。我不确定如何创建唯一 ID 并在 JS 函数中读取它。由于这是动态构建的，我没有构建开关，但我觉得我错过了另一个选择。这里的问题是我无法捕获 Li ID。我已经尝试过了，也尝试过基于班级，但似乎都失败了。

Li 对象创建：

```
$("#jdLists").append('<li class="bigger" id = "' + item.ID + '">'+ 
  item.GROUP_NAME + 
  '<span title="Remove from list" class=" Sp icon icon-color icon-plus" style="float: right; vertical-align: middle;" '+
  'onclick="spAdd()"></span>' + 
  '</li>'); 
```

点击功能：

```
function spAdd() {
  $(this).closest("li").attr('id');
} 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-12-26T18:02:21.297

试试这样：

```
// Should work for most cases
function uniqId() {
  return Math.round(new Date().getTime() + (Math.random() * 100));
}

// Create elements properly and attach click event
// before appending to DOM so it delegates the event
var $li = $('<li/>', {
  'class': 'bigger',
  id: uniqId()
});

var $span = $('<span/>', {
  'class': 'Sp icon icon-color icon-plus',
  title: 'Remove from list',
  text: 'I\'m a span',
  click: function() { 
    alert( $(this).parent().attr('id') );
  }
});

$('#jsLists').append( $li.append( $span ) ); 
```

它应该在点击时提醒 li 的随机 ID。也代替内联 css，为这些样式添加另一个类；更好，更简单，更容易。

**演示： http:** [//jsbin.com/avevim/1/edit](http://jsbin.com/avevim/1/edit)（ctrl+enter刷新并获取新id）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-26T18:32:42.660

下划线为[`uniqueId`](http://underscorejs.org/docs/underscore.html#section-128)这种情况提供了一个功能。它不会对日期和随机数感到棘手，而是保留一个全局计数器并在每次调用函数时递增它：

```
var idCounter = 0;
_.uniqueId = function(prefix) {
  var id = '' + ++idCounter;
  return prefix ? prefix + id : id;
}; 
```

# visual-studio-2010 - 虚拟路径 ... 映射到另一个应用程序，这是不允许的。Team Foundation Server 构建失败

> ID：14044186
> 
> 赞同：0
> 
> 时间：2012-12-26T17:50:25.103
> 
> 标签：visual-studio-2010, web, continuous-integration

我有一个在本地运行时成功构建的网站项目。我正在尝试在 TFS (Visual Studio 2010) 中为此网站设置持续构建 - 当构建运行时，它会因此错误而失败 -

虚拟路径“/abc/MasterPages/abc.master”映射到另一个应用程序，这是不允许的。

在我的构建代理中，我什至没有尝试将它发布到 IIS - 我配置它要做的只是运行构建并将输出复制到特定文件夹。

谁能告诉我如何在 TFS 中解决这个问题，因为相同的代码在所有开发人员的工作站上都​​成功运行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T03:07:00.053

您是否将发布信息集作为项目的一部分？如果是这样删除它。作为 tfs 构建的一部分，发布步骤需要以另一种方式完成

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T18:53:49.420

解决方法是在所有相对 URL 中添加前缀 ~ - 例如：'/abc/MasterPages/abc.master' 将是 '~/abc/MasterPages/abc.master'

这似乎解决了我的问题。

# matlab - 对数据集行中的值进行排名

> ID：14044187
> 
> 赞同：2
> 
> 时间：2012-12-26T17:50:31.200
> 
> 标签：matlab

我有一个名为“股票”的股票价格数据集。每列是不同的股票。每行是股票价格的日期。

如何对给定日期的股票价格进行排名？

我试过

```
 tiedrank(stocks.yhoo) 
```

并成功对YHOO股票价格进行排名。但是，我想按行而不是按列排名。

另外，当我尝试

```
tiedrank(stocks(1,:)) 
```

或删除第 1 列中的日期列

```
tiedrank(stocks(1,2:3)) 
```

我收到错误消息：数据集数组下标必须是二维的。

难道我做错了什么？还是我最好使用矩阵？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T21:21:20.320

如果我理解正确，您想根据给定日期的价格对股票进行排名，其中日期是行，股票是列。要跨行使用`tiedrank`，您需要将数据集的那部分转换为`double`，然后使用输出索引列表进行排序：

```
%# create index for sorting
idx = tiedrank( double( stocks(1,:) ));

%# reorder columns with index
sortedStocks = stocks(:,idx); 
```

# php - 将 Base64 字符串转换为图像（使用 JSON 从 android 发送）并使用 PHP 在 MySQL 中另存为 BLOB

> ID：14044192
> 
> 赞同：-1
> 
> 时间：2012-12-26T17:50:58.877
> 
> 标签：php, android, mysql, json, base64

实际上，我已经从我的 android 项目中的 JSON 中获取了图像字符串。字符串图像成功传递给使用 HTTPPOST。现在，我面临在 php 的 mysql 数据库中将图像保存为 blob 类型的问题。如何转换我得到的字符串图像，以便它可以保存为 mysql 数据库中的 blob 类型？如果有人知道方法请指教。

谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-26T18:01:16.037

只需[base64_decode()](http://php.net/manual/en/function.base64-decode.php)数据：

```
$blob = base64_decode($json_64_encoded_string); 
```

然后将其写入数据库。如果您需要帮助从`POST`数组中获取编码字符串，请查看 PHP`json_decode`函数： http: [//php.net/manual/en/function.json-decode.php](http://php.net/manual/en/function.json-decode.php)

```
$json_obj = json_decode($_POST[post_key]); //replace 'post_key' with whatever you use
$blob = base64_decode($json_obj->blob); //replace 'blob' with whatever you use 
```

# c# - C# 返回自定义类数组

> ID：14044195
> 
> 赞同：0
> 
> 时间：2012-12-26T17:51:27.867
> 
> 标签：c#, arrays, class

我定义了一个自定义类：

```
class Car
{
    public string a;
    public string b;
    public string c;

    public static void GetCar()
    {
        var car = new Car[4];
        for(int i=0; i<4; ++i)
        {
            novica[i]= new Novica();
            novica[i].a="abc";
            novica[i].b="abc";
            novica[i].c="abc";
        }

    }
} 
```

这会用值填充数组，现在我想在不属于此类的函数中使用该数组及其获取的值（从 HTML 加载字符串）。有可能吗？如果可以，怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-26T17:54:13.183

为了在其他地方使用它，您需要从函数中返回数组，如下所示：

```
public static Car[] GetCar()
    {
        var car = new Car[4];
        for(int i=0; i<4; ++i)
        {
            car[i]= new Novica();
            car[i].a="abc";
            car[i].b="abc";
            car[i].c="abc";
        }

        return car;
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-26T17:53:58.340

你不能。你的方法实际上并没有返回任何东西。

如果您要更改方法签名以返回该方法创建的数组：

```
public static Car[] GetCar()
{
    // Body

    return car;
} 
```

调用将变得如此简单：

```
var cars = Car.GetCar(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T18:16:25.280

我建议稍微不同的结构。提供一个包含所有汽车的数组作为静态属性

```
public class Car
{
    public static Car[] AllCars { get; private set; }

    public Car()
    {
        // Class and constructor somewhat simplyfied.
        AllCars = new Car[4];
        for (int i = 0; i < 4; ++i) {
            AllCars[i] = new Novica();
        }
    }
} 
```

现在你可以使用这样的汽车了

```
foreach (Car car in Car.AllCars) {
    // do something with car
} 
```

或访问特定的汽车

```
string a = Car.AllCars[i].a; 
```

# javascript - 一般关于.split

> ID：14044198
> 
> 赞同：0
> 
> 时间：2012-12-26T17:51:51.207
> 
> 标签：javascript, jquery

标记::

```
<td class="info2 gensmall">
<span class="new1">In total there is <strong>1</strong> user online :: 1 Registered, 0 Hidden and 0 Guests </span>
 <span class="new2">We have <strong>4</strong> registered users</span>
<span class="new3">The newest registered user is <strong><a href="/u5">cldtomhil</a></strong></span>
<span class="new4">Our users have posted a total of <strong>12</strong> messages</span>
</td> 
```

好的，尝试学习 jQuery 的人`.split`

```
$(document).ready(function(){
    var a = $('td .info2 .new1');
    var b = $('td .info2 .new2');
    var c = $('td .info2 .new3');
    var d = $('td .info2 .new4');
    var w = a.split("<strong>");
    var x = b.split("<strong>");
     var y = c.split("<strong>");
     var z = d.split("<strong>");
$('.new1').html('<span>"w"</span>&nbsp;Users Online');
$('.new2').html('<span>"x"</span>&nbsp;Total Users');
$('.new3').html('<span>"y"</span>&nbsp;Newest Member');
$('.new4').html('<span>"z"</span>&nbsp;Total Messages')
    }); 
```

好吧，我知道我做错了只是看看它。虽然我不知道如何使用拆分功能，但我正在尝试获取`<strong>`标签内的信息。然后，一旦我有了它，我想基本上用我发布的新数据来更改innerHTML`.html`

是的，我知道它有很多变数，但是你能做什么，我还不是一个很好的编码器，而且还在学习一些东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T17:54:54.973

以下是您获得价值的方法：

```
$('td.info2 .new1 strong').text(); // returns "1"
$('td.info2 .new3 strong').text(); // returns "cldtomhil", not "<a href="/u5">cldtomhil</a>" 
```

等等。话虽如此，[String.split](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/split)是一个 JavaScript 函数，它在给定分隔符的情况下拆分字符串。您尝试做的是获取 HTML 元素的内容。无需使用字符串函数来执行此操作。使用[DOM 函数](https://developer.mozilla.org/en-US/docs/DOM)（或 jQuery）来操作 DOM。

# shell - 可恢复脚本的最佳选择

> ID：14044199
> 
> 赞同：3
> 
> 时间：2012-12-26T17:51:54.503
> 
> 标签：shell, unix

我正在编写一个脚本，它按顺序执行大约 10 个后端进程，具体取决于前一个进程是否在没有任何错误的情况下执行。

现在让我们假设这样的场景，假设第 5 个进程失败并且脚本出来了。但是我想以这样的方式对其进行编码，当用户下次运行它时（在删除了上次退出的脚本导致的错误之后），他应该能够从第 5 个进程开始运行，而不是从第一个进程开始运行。

更具体地说，假设以下是脚本：

```
Script Starts
Process1
if [ $? -eq 0 ] then
Process2
if [ $? -eq 0 ] then
Process3
if [ $? -eq 0 ] then
..
..
..
..
if [ $? -eq 0 ] then
Process10
else
exit 
```

因此，如果任何一个进程未能以状态 0 完成，则脚本将随时退出。同样，如果 process5 失败，并且用户纠正了问题并重新启动脚本，脚本应该再次以 process5 开始，而不是 process1 或至少在那里如果他想恢复脚本或从头开始重新启动它，应该是用户的一个选项，即 process1。

我们可以编写这种脚本的所有可能方式，也请记住，我不允许使用临时数据库，我可以在其中存储每个进程的状态。

我需要在 unix 中用 sh（shell 脚本）编写代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T18:02:59.363

一个简单的解决方案是编写戳文件：

```
#/bin/sh

set -e  # Automatically abort if any simple command fails

if ! test -f cmd1-stamp; cmd1; fi
touch cmd1-stamp
if ! test -f cmd2-stamp; cmd2; fi
touch cmd2-stamp 
```

当脚本执行时，如果`cmd1-stamp`存在，`cmd1`则不执行。否则，`cmd1`被执行。如果脚本失败，脚本将中止。请注意，编写起来*非常*诱人`test -f cmd1-stamp || cmd1`，这似乎可行（在 bash 中），但是 shell 规范指出，如果简单命令失败`is not a part of an AND or OR list`，shell 将中止，我怀疑这是 bash 的（又一个）实例不符合规范。（虽然它似乎没有指定如果失败的命令是 AND 或 OR 列表的一部分，则 shell 不应中止。）

# inversion-of-control - Ninject 作用域 - 在正在构建的整个图中使用相同的实例

> ID：14044202
> 
> 赞同：15
> 
> 时间：2012-12-26T17:52:04.243
> 
> 标签：inversion-of-control, ninject

假设我有以下要使用 Ninject 构建的类，箭头显示依赖关系。

```
A > B > D
A > C > D 
```

我想配置 Ninject 使得 A 是瞬态作用域的，即每次你向 Ninject 询问 A 时，你都会得到一个新的 A。我也希望 B 和 C 是暂时的，每次你要求 A 时都会得到一个新的。但我希望*D*在 B 和 C 之间重复使用。所以每次我要求 A 时，我都想要 Ninject构造每个对象一个，而不是两个 D。但我不希望 Ds 在不同的 As 中重复使用。

使用 Ninject 进行设置的最佳方法是什么？

**更新：**
经过更多研究，Unity 似乎有一个 PerResolveLifetimeManager 可以满足我的需求。是否有 Ninject 等价物？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-26T18:36:47.357

[Ninject 支持四种开箱即用的](https://github.com/ninject/ninject/wiki/Object-Scopes)内置对象作用域：Transient、Singleton、Thread、Request。

所以没有任何类似的范围，但您可以通过使用该方法`PerResolveLifetimeManager`注册自定义范围来轻松实现它。`InScope`

事实证明，有一个现有的 Ninject 扩展：[`ninject.extensions.namedscope`](https://github.com/ninject/ninject.extensions.namedscope)它提供了`InCallScope`您正在寻找的方法。

但是，如果您想自己做，您可以使用自定义`InScope`委托。您可以在其中使用`IRequest`类型的主要对象将`A`其用作范围对象：

```
var kernel = new StandardKernel();
kernel.Bind<A>().ToSelf().InTransientScope();
kernel.Bind<B>().ToSelf().InTransientScope();
kernel.Bind<C>().ToSelf().InTransientScope();
kernel.Bind<D>().ToSelf().InScope(
    c =>
        {
            //use the Request for A as the scope object                         
            var requestForA = c.Request;
            while (requestForA != null && requestForA.Service != typeof (A))
            {
                requestForA = requestForA.ParentRequest;
            }
            return requestForA;
        });

var a1 = kernel.Get<A>();    
Assert.AreSame(a1.b.d, a1.c.d);

var a2 = kernel.Get<A>();    
Assert.AreSame(a2.b.d, a2.c.d);

Assert.AreNotSame(a1.c.d, a2.c.d); 
```

样本类在哪里：

```
public class A
{
    public readonly B b;
    public readonly C c;
    public A(B b, C c) { this.b = b; this.c = c; }
}

public class B
{
    public readonly D d;
    public B(D d) { this.d = d; }
}

public class C
{
    public readonly D d;  
    public C(D d) { this.d = d; }
}

public class D { } 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-26T20:22:35.133

我找到了解决我的具体问题的方法，即 ninject.extensions.namedscope 扩展提供的 [InCallScope](https://github.com/ninject/ninject.extensions.namedscope)。这与 Unity PerResolveLifetimeManager 概念的行为相同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-26T20:08:46.667

一种替代方法是自己构建依赖项。

```
var kernel = new StandardKernel();
kernel.Bind<A>().ToMethod(ctx =>
{
    var d = new D();
    var c = new C(d);
    var b = new B(d);
    var a = new A(b, c);
    return a;
}); 
```

这可能不是首选方法，但它总是会构造一个`A`使用 , 和 的新实例的新实例`B`（`C`但`D`会重复使用`D`for`B`和的相同实例`C`）。您可以添加对 的调用`InTransientScope()`，但这不是必需的，因为它是默认范围。

# java - System.out.println 从多个 java 源文件中删除/注释

> ID：14044205
> 
> 赞同：5
> 
> 时间：2012-12-26T17:52:24.217
> 
> 标签：java, refactoring

我想`System.out.println`从我的 java 代码中删除/注释所有出现的 。这`System.out.println`可能在里面，，，，或`if`任何地方。由于源代码文件很大，我无法手动完成。`if else``for``while`

请帮我自动化这个过程。是否有任何重构工具可用于此任务？我可以为此使用 eclipse JDT 吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-26T17:54:01.513

**更新**

如此处所述[，](https://stackoverflow.com/questions/572134/how-to-remove-system-out-printlns-from-codebase/572222#572222)创建一个 NullOutPut

```
public final DevNull { 
    public final static PrintStream out = new PrintStream(new OutputStream() {
        public void close() {}
        public void flush() {}
        public void write(byte[] b) {}
        public void write(byte[] b, int off, int len) {}
        public void write(int b) {}

    } );
} 
```

并替换`System.out.print`为`DevNull.out.print`

然后切换到日志框架，让您轻松处理事情

* * *

**链接**

*   [如何从代码库中删除 System.out.println](https://stackoverflow.com/questions/572134/how-to-remove-system-out-printlns-from-codebase/572222#572222)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-26T18:02:25.210

你*可以*使用源代码文件中的原始查找/替换功能来注释掉（或删除）语句，但是任何正则表达式都可以很容易地被破坏，所以也许您最好注意像 log4j 或 slf4j 这样的日志框架。

首先是大图：而不是使用通常的`System.out.println()`，您最终将使用如下代码行：

```
logger.debug("Just entered main"); 
```

日志框架可以配置[一个简单的属性文件](http://zybnet.com/java-logging-with-log4j/)，因此您可以拥有多个附加程序（控制台、文件、数据库等）并根据需要分别关闭每个附加程序（例如控制台附加程序）。要切换到日志 API，您仍然必须对源文件执行原始查找/替换，并且可能手动修复一些事情，无论是在您的 IDE 中，还是使用如下命令：

```
find src/ -name '*.java' | \
xargs sed -i -e 's/System.out.println/logger.verbose/g' 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-26T17:57:31.097

如果您不使用 IDE，在 Linux 上：

```
sed '/System.out.println/d' %YOUR_PROJ_DIR%/*.java 
```

在 Windows 上，如果你安装了 cygwin，你也可以这样做。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-26T18:03:49.337

正如 Jigar Joshi 所说，使用*查找和替换*方法可能会对您有很大帮助，特别是如果您不干扰除了`System.out.println`.

*如果您不需要编辑/更改*源代码，我会提出不同的解决**方案**。您可以在驱动程序中**禁用**`System.out`流，然后这些语句不会打印任何内容。您只需要像这样设置它：

```
System.setOut(new PrintStream(new OutputStream() {
    public void write(int b) {
        // No operation.
    }
    public void close() {}
    public void flush() {}
    public void write(byte[] b) {}
    public void write(byte[] b, int off, int len) {}
    public void write(int b) {}
})); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-26T18:08:14.567

我已经使用 jEdit 文本编辑器来完成这样的任务。可能还有其他文本编辑器可以做到这一点，重要的功能是通过目录/子目录进行查找和替换搜索。

1.  打开查找和替换对话框。
2.  确保检查了搜索文件夹和子目录选项。 **同样，这是在整个项目中处理事情的关键。**
3.  在查找字段中写入“System.out.println”。编写一个正则表达式来处理参数。
4.  在替换字段中写入 //System.out.println 或更安全的“/*System.out.println*/”（或者如果更可取，则将其留空）。使用正则表达式匹配来替换函数的原始参数。
5.  我建议您手动替换前几次出现以确保一切按预期进行。一旦你确信它是，点击全部替换并庆祝。

我不是 Java 程序员，但这个解决方案应该适用于任何语言。希望有帮助。祝你好运！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-26T18:14:09.610

您可以使`System.out.println`应用程序中的所有内容不在控制台中打印任何内容。创建一个类，如：

```
import java.io.PrintStream;

public class MyStream extends PrintStream {
   private static final MyStream INSTANCE = new MyStream();

   public static void init() {
      System.setOut(INSTANCE);
   }

   private MyStream() {
      super(System.out);
   }

   @Override
   public void println(Object x) {
      return;
   }

   @Override
   public void println(String x) {
      return;
   }
} 
```

将其用作：

```
public class Test {

    public static void main(String... args) {
        MyStream.init();
        System.out.println("This line will not print");
    }
} 
```

将不再打印。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-26T17:54:14.580

做一个简单的查找和替换。应该这样做。

# codeigniter - codeigniter 从控制器中的模型中获取返回的数据变量并在条件语句中使用它

> ID：14044208
> 
> 赞同：1
> 
> 时间：2012-12-26T17:52:45.343
> 
> 标签：codeigniter

我的搜索实现有什么问题，这是我希望实现的。

查看页面（表单）-> 控制器（表单数据变量）-> 模型（查询数据库并传递给控制器​​）​​如果有结果返回 TRUE 否则返回 FALSE -> 控制器（从模型中获取数据）如果为真则在表中显示数据 else if FALSE 显示没有返回结果的消息。

这是我的页面：

```
view:  
<form action="<?php echo site_url('retrieve')?>" method="post"> 
<input type="text" name="id">  
.... 
</form>

model:
public function retrieve($id)
{

$search = "SELECT *  FROM table";
    $result = $this->db->conn_id->prepare($search);
    $result->execute();     

    if($result->rowCount()>0){
    return  $query_result = $result->fetchAll(PDO::FETCH_ASSOC);
    }
}  

controller:  
public function retrieve_info()
{
   $id = $this->input->post('id'),

   $this->load->model('search_model');
   $this->search_model->retrieve($id);      
   $data['query_result'] = $this->search_model->retrieve($id);    
   $this->load->view('display',$data);          

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T20:25:36.177

首先，表单操作链接到控制器中的检索功能。但是，从您的示例中，您的控制器中没有检索功能，只有您的模型中。

看法：

```
 <form action="<?php echo site_url('retrieve')?>" method="post"> 
    <input type="text" name="id">  
    .... 
    </form> 
```

模型：

```
public function retrieve($id)
{

$search = "SELECT *  FROM table";
    $result = $this->db->conn_id->prepare($search);
    $result->execute();     

    if($result->rowCount()>0){
    return  $query_result = $result->fetchAll(PDO::FETCH_ASSOC);
    }
} 
```

控制器：

```
public function retrieve()
{

   if($_POST){
       $id = $this->input->post('id'),

      $this->load->model('search_model');      
      $data['query_result'] = $this->search_model->retrieve($id);    
      $this->load->view('display',$data);          
   }else {
     //form failed to submit via post
   }

} 
```

# c++ - 实现具有多重继承的纯虚函数

> ID：14044222
> 
> 赞同：5
> 
> 时间：2012-12-26T17:54:17.577
> 
> 标签：c++, inheritance, multiple-inheritance, pure-virtual

假设有这个接口：

```
class A{  
 public:  
  virtual foo()=0;  
}; 
```

还有一个`B`实现这个接口的类：

```
class B:public A{    
 public:   
  virtual foo(){} //Foo implemented by B   
} 
```

最后，一个`C`具有类`A`和`B`基类的类：

```
Class C : public A, public B {
}; 
```

我的问题是，有一种方法可以告诉编译器的实现`foo`是来自类的实现，`B`而无需显式调用`B::foo()`?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T18:20:25.593

正如@BenVoigt 在评论中指出的那样，以下答案仅由于 g++ 中的错误而有效（这意味着它不能保证继续工作，而且它绝对不可移植）。因此，尽管如果您使用特定的（有缺陷的）编译器，它可能会做您想做的事，但它不是您应该使用的选项。

*一定要*使用[虚拟继承](https://stackoverflow.com/q/21558/1214731)。

* * *

这不完全是问题中的*代码*所暗示的场景，而是句子

> 我的问题是，有一种方法可以告诉编译器 foo 的实现是来自 B 类的实现，而无需显式调用 B::foo()？

似乎要求语法来区分函数的多个基本版本而不使用`::`限定符。

您可以使用`using`指令执行此操作：

```
#include <iostream>
class A {
public:
A(){}
virtual void foo(){std::cout<<"A func";}
};

class B: virtual public A {
  public:
  B(){}
  virtual void foo(){std::cout<<"B func";}
};
class C:virtual public A, virtual public B {
    public:
    C(){}
    using A::foo; // tells the compiler which version to use
                   // could also say using B::foo, though this is unnecessary
};

int main() {
    C c;
    c.foo(); // prints "A func"
    return 0;
} 
```

当然，正如其他答案所指出的那样，问题中的代码本身根本不需要这样做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-26T18:07:29.247

只需使用虚拟继承，以便`A`提供的子`B`对象与`C`.

或者写`class C : public B`...无论如何，它都可以`A`通过基类隐式使用`B`。

* * *

在编辑问题之前：

`B::foo`不兼容`A::foo`。

所需的签名是

```
ReturnType /* missing from question */ foo(A* const this /* this parameter is implicit */); 
```

但是`B::foo`有签名

```
ReturnType foo(B* const this); 
```

将传递给虚函数的 An`A*`不是`B*`实现所需的 a 。如果`B`继承自`A`，则编译器将生成`B::foo`以接受并从该子对象指针中`A* const subobject`查找对象。`B* const this`但`B::foo`对中的关系一无所知`C`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T17:58:54.630

由于您的示例中有两个基类（这可能是设计问题/设计气味，我会回顾一下），您必须明确调用您所追求的实现，无论是它`A::foo()`还是`B:foo()`.

如果 B 所做的只是提供的实现，`foo()`我会考虑将实现移到 A 中（您可以为纯虚函数提供实现），但即使在这种情况下，您也必须通过其限定名称来调用它。

# python - wxPython：如何正确选择 ListCtrl 项？

> ID：14044223
> 
> 赞同：2
> 
> 时间：2012-12-26T17:54:27.503
> 
> 标签：python, wxpython, wxwidgets

我的 Windows 8 上安装了带有 wxWidgets 2.8.11.0 的 python 2.7。如果我执行以下代码：

```
import wx

app = wx.App( redirect = False )
wnd = wx.Frame( parent = None )
widget = wx.ListCtrl( parent = wnd, style = wx.LC_REPORT )
widget.InsertColumn( 0, "items" )
widget.InsertStringItem( 0, "foo" )
widget.InsertStringItem( 1, "bar" )
widget.InsertStringItem( 2, "baz" )
widget.Select( 1 )
wnd.Show()
app.MainLoop() 
```

我看到了一个包含 3 个项目列表的窗口，第二个被选中。但是，如果我按“向下”键 -选择了**第一**项！是否可以选择项目，所以按“向上”和“向下”键将移动现有选择并且不会跳转到第一个项目？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-26T18:18:34.783

一起使用`Select`（突出显示）和`Focus`（使该行成为当前行）：

```
........
widget.Focus(1)
widget.Select(1)
.......... 
```

# c - 缓存写入是否需要更长的时间才能使更多缓存失效？

> ID：14044228
> 
> 赞同：2
> 
> 时间：2012-12-26T17:54:58.910
> 
> 标签：c, parallel-processing, cpu-cache

你能帮我看看当有更多的核心/缓存持有该行的副本时，缓存写入是否需要更长的时间才能完成。我还想测量/量化实际需要多长时间。

我在谷歌上找不到任何有用的东西，而且我自己测量它并解释我测量的东西时遇到了麻烦，因为现代处理器上可能发生很多事情。（重新排序、预取、缓冲和天知道是什么）

**细节：**

我测量它的基本过程大致如下：

```
write soemthing to the cacheline on processor 0
read it on processors 1 to n.

rdtsc
write it on process 0
rdtsc 
```

我什至不确定在进程 0 上实际使用哪些指令进行读/写，以确保在最终时间测量之前完成写/无效。

目前我摆弄一个原子交换（__sync_fetch_and_add()），但似乎线程数本身对于这个操作的长度很重要（不是要失效的线程数）——这可能不是我想要的测量？！。

我还尝试了读取，然后写入，然后是内存屏障（__sync_synchronize()）。这看起来更像我期望看到的，但在这里我也不确定在最终 rdtsc 发生时写入是否完成。

你可以猜到我对 CPU 内部的了解是有限的。

很感谢任何形式的帮助！

ps: * 我使用 linux、gcc 和 pthreads 进行测量。* 我想知道这一点，以便为我的并行算法建模。

**编辑：**

大约一周后（明天去度假），我会做更多的研究并发布我的代码和注释并将其链接到此处（以防有人感兴趣），因为我可以花在这方面的时间是有限的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T18:29:16.270

我开始写一个很长的答案，准确描述它是如何工作的，然后意识到，我可能对确切的细节知之甚少。所以我会做一个简短的回答......

So, when you write something on one processor, if it's not already in that processors cache, it will have to be fetched in, and after the processor has read the data, it will perform the actual write. In doing so, it will send a cache-invalidate message to ALL other processors in the system. These will then throw away any content. If another processor has "dirty" content, it will in itself write out the data, and ask for an invalidation - in which case the first processor will have to RELOAD the data before finishing its write (otherwise, some other element in the same cacheline may get destroyed).

Reading it back into the cache will be required on every other processor that is interested in that cache-line.

The __sync_fetch_and_add() wilol use a "lock" prefix [on x86, other processors may vary, but the general idea on processors that support "per instruction" locks is roughtly the same] - this will issue a "I want this cacheline EXCLUSIVELY, everyone else please give it up and invalidate it". Just like the first case, the processor may well have to re-read anything that another processor may have made dirty.

A memory barrier will not ensure that data is updated "safely" - it will just make sure that "whatever happened (to memory) before now is visible to all processors by the time this instructon finishes".

The best way to optimize the use of processors is to share as little as possible, and in particular, avoid "false sharing". In a benchmark many years ago, there was a structure like [simplifed] this:

```
struct stuff {
    int x[2];
    ... other data ... total data a few cachelines. 
} data;

void thread1()
{
    for( ... big number ...)
        data.x[0]++;
}

void thread2()
{
    for( ... big number ...)
        data.x[1]++;
}

int main()
{
    start = timenow();

    create(thread1);
    create(thread2);

    end = timenow() - start;   
} 
```

Since EVERY time thread1 wrote to the x[0], thread2's processor had to get rid of it's copy of x[1], and vice versa, the result is was that the SMP test [vs just running thread1] was running about 15 times slower. By altering the struct like this:

```
struct stuff {
    int x;
    ... other data ... 
} data[2]; 
```

and

```
void thread1()
{
    for( ... big number ...)
        data[0].x++;
} 
```

we got 200% of the 1 thread variant [give or take a few percent]

Right, so the processor has queues of buffers where write operations are stored when the processor is writing to memory. A memory barrier (mfence, sfence or lfence) instruction is there to ensure that any outstanding read/write, write or read type operation has completely been finished before the processor proceeds to the next instruction. Normally, the processor would just continue on it's jolly way through any following instructions, and eventualy the memory operation becomes fulfilled some way or another. Since modern processors have a lot of parallel operations and buffers all over the place, it can take quite some time before something ACTUALLY trickles through to where it eventually will end up. So, when it's CRITICAL to make sure that something has ACTUALLY been done before proceeding (for example, if we have written a bunch of instructions to the video memory, and we now want to kick off the run of those instructions, we need to make sure that the 'instruction' writing has actually finished, and some other part of the processor isn't still working on finishing that. So use an `sfence` to make sure that the write has really happened - that may not be a very realistic example, but I think you get the idea.)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-27T00:07:08.117

Cache writes have to get line-ownership before dirtying the cache line. Depending on the cache coherence model implemented in the processor architecture, the time taken for this step varies. The most common coherence protocols that I know are:

*   Snooping Coherence Protocol: all caches monitor address lines for cached memory lines i.e. all memory requests have to be broadcast to all cpus i.e. non-scalable as cpus increase.
*   Directory-based Coherence Protocol: all cache lines shared among many cpus is kept in a directory; so, invalidating/gaining ownership is a point-to-point cpu request rather than a broadcast i.e. more scalable, but latency suffers because the directory is a single point of contention.

Most cpu architectures support something called PMU (perf monitoring unit). This unit exports counters for many things like: cache hits, misses, cache write latency, read latency, tlb hits, etc. Please consult the cpu manual to see if this info is available.

# sql-server - TSQL 分组计算

> ID：14044229
> 
> 赞同：2
> 
> 时间：2012-12-26T17:55:06.923
> 
> 标签：sql-server, math, group-by

我得到了这张表和一些数据：

```
SELECT Id, SubId, N1, N2, N3 FROM table1 WHERE Id = 2

Id          SubId    N1          N2          N3
----------- -------- ----------- ----------- ----------------------
2           1        94917       97030       0
2           2        35087       41306       0
2           3        189671      194224      0
2           4        44905       46218       0
2           5        65760       70959       0
2           6        620         2395        0
2           7        60336       69531       0
2           8        65517       70666       0 
```

我运行这个查询

```
UPDATE table1
SET N3 = CASE WHEN N1 = 0 THEN 0 ELSE (( N2 * 1.0 / N1 ) -1) * 100 END

Id          SubId    N1          N2          N3
----------- -------- ----------- ----------- ----------------------
2           1        94917       97030       2.2261554832
2           2        35087       41306       17.7245133525
2           3        189671      194224      2.4004723969
2           4        44905       46218       2.9239505622
2           5        65760       70959       7.9060218978
2           6        620         2395        286.2903225806
2           7        60336       69531       15.2396579156
2           8        65517       70666       7.8590289543 
```

因此，当我按 Id 对表进行分组时，我得到了以下数据：

```
SELECT  Id, 
        SUM(N1) AS N1, 
        SUM(N2) AS N2, 
        CAST(0 AS NUMERIC(10,2)) AS N3
INTO table2
FROM table1
GROUP BY Id

UPDATE table2
SET N3 = CASE WHEN N1 = 0 THEN 0 ELSE (( N2 * 1.0 / N1 ) -1) * 100 END

SELECT Id, N1, N2, N3 FROM table2 WHERE Id = 2

Id          N1          N2          N3
----------- ----------- ----------- ----------------------
2           556813      592329      6.38 
```

问题是当我按 ID（6.38）分组而不重新计算字段（第二次更新）时，如何获得相同的 N3 值，我试图应用反向计算（（N3/100）+1）并对 N3 求和场，但没有工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T18:05:37.987

只需将`N1`and分别替换`N2`为`SUM(N1)`and `SUM(N2)`..

```
SELECT  Id, 
        SUM(N1) AS N1, 
        SUM(N2) AS N2, 
        N3 = CAST(CASE WHEN SUM(N1) = 0 THEN 0 ELSE (( SUM(N2) * 1.0 / SUM(N1) ) -1) * 100 END AS NUMERIC(10,2))
FROM table1
GROUP BY Id 
```

**演示在** [http://sqlfiddle.com/#!3/de849/4/0](http://sqlfiddle.com/#!3/de849/4/0)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T18:11:24.257

```
SELECT  Id,
        SUM(N1) AS N1,
        SUM(N2) AS N2,
        CAST(CASE WHEN SUM(N1) = 0 THEN 0 ELSE (( SUM(N2) * 1.0 / SUM(N1) ) -1) * 100 END AS NUMERIC(10,2))) as N3
FROM temp
GROUP BY Id 
```

N3 需要将 Sum(N1) 和 Sum(N2) 作为值而不是 N1 和 N2，因为您是基于聚合而不是单个值计算 N3。

# android - 过滤列表后 OnItemClickListener 中的 id 不正确

> ID：14044230
> 
> 赞同：1
> 
> 时间：2012-12-26T17:55:16.113
> 
> 标签：android, filter, android-listview, onitemclicklistener

我正在使用 ListView 显示 mysql 表中的一些数据，并使用 SimpleAdapter 填充。我添加了 onItemClickListener，以便在用户按下列表中的某个项目时能够打开新活动。这工作得很好，但是当您选择一个选项来搜索列表时，textfilter 可以过滤条目，但 onItemClick 没有向新活动发送正确的“id”。我搜索了解决方案，每个人都用“adapter.notifyDataSetChanged”解决了这个问题，但它对我不起作用。这是代码，也许有人可以提供帮助。

```
list.setTextFilterEnabled(true);
                myFilter.addTextChangedListener(new TextWatcher() {
                    public void afterTextChanged(Editable s) {
                    }
                    public void beforeTextChanged(CharSequence s, int start,int count, int after) {
                    }
                    public void onTextChanged(CharSequence s, int start, int before, int count) {
                        mSchedule.getFilter().filter(s.toString());

                    }

                });

                list.setOnItemClickListener(new OnItemClickListener() {

                    public void onItemClick(AdapterView<?> parent, View view,
                            int position, long id) {
                        try {

                            String ajdi = jArray.getJSONObject(position).getString("id").toString();
                            Intent i = new Intent(Predlozi.this, PesmaPrikaz.class);
                            Bundle bandl = new Bundle();
                            bandl.putString("id", ajdi);
                            i.putExtras(bandl);
                            startActivity(i);

                        } catch (JSONException e) {
                            ;
                        }
                    }

                }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T18:26:32.513

> 但是当您选择一个选项来搜索列表时，textfilter 可以过滤条目，但 onItemClick 没有将正确的“id”发送到新活动。

这是正常行为，因为您很可能直接从用于填充适配器的 list/json 结构中获取 id。如果您随后过滤列表并且过滤删除的项目比位置将不正确，因为您将在列表中拥有更少的元素。

相反，您应该从适配器获取行数据并`id`从那里获取，假设您确实将它放在那里（您绝对应该这样做）：

```
public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
      HashMap<Something, Something> rowData = (HashMap<Something, Something>)((SimpleAdapter)parent.getAdapter()).getItem(position); // I don't know what you pass to the adapter so edit this
      // get the id from the `HashMap` above
      // if you don't store the id in there, then edit your code to do this:
      String id = rowData.get("the_key_for_the_Id");
      // send the Intent 
} 
```

# jquery - 而asp.net mvc4升级jquery datepicker错误

> ID：14044233
> 
> 赞同：1
> 
> 时间：2012-12-26T17:55:26.223
> 
> 标签：jquery, asp.net, asp.net-mvc-3, jquery-ui, asp.net-mvc-4

当我将我的 mvc3 项目升级到 mvc4 时，我遇到了一个关于 JQuery datepicker 的问题。

MVC3 项目正在使用

*   jQuery-1.6.3
*   jquery-ui-1.8.11

MVC4 项目正在使用

*   jQuery-1.7.1
*   jquery-ui-1.8.20

JQuery datepicker 在 mVC3 上工作，但在 mvc4 上发生错误。

![在此处输入图像描述](../Images/877e13a439fbff08bb3dbf96c5ee01dc.png)

我的模型是这个

```
public class Reservation
{
    public string Name { get; set; }
    public DateTime? Date { get; set; }
} 
```

我的 EditorTemplate 在这里。

```
model DateTime?

Html.TextBox("", Model.HasValue ? Model.Value.ToShortDateString() : string.Empty,  new { data_datepicker = true }) 
```

我像这样在模型中应用了数据属性，但没有奏效。

```
 [DataType(DataType.Date)]
    [DisplayFormat(DataFormatString = "{0:dd.mm.yyyy}")]
    public DateTime? Date { get; set; } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T13:45:07.060

尝试将您的模型更改为

`[UIHint("DateTemplateYouAreUsing")]`
`public DateTime? Date { get; set; }`

和你的编辑器模板
`$.validator.methods.date = function (value, element) {`
`!isNaN(Globalize.parseDate(value)); return this.optional(element) ||`
`}`

 ``@model DateTime`
`@Html.TextBox("", String.Format("{0:dd.MM.yyyy}", Model.ToShortDateString()),`
`new { @class = "newdate" })`

并将您的脚本更改为：
`$(document).ready(function () {`
`$('.newdate').datepicker({ dateFormat: 'dd.mm.yy'});`
`Globalize.culture('de-AT');`
`});`

不要忘记添加从[https://github.com/jquery/globalize](https://github.com/jquery/globalize)
下载这些文件

希望这有效！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T05:39:28.810

可能是您的问题是 jQuery 引用。尝试直接从**Google CDN**引用下面的点赞（这些是最新版本）。

```
<link rel="stylesheet" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.9.2/themes/base/jquery-ui.css"
            type="text/css" media="all" />
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.9.2/jquery-ui.min.js"></script> 
```

我希望这对你有帮助。`

# c# - 修改线程时遇到问题

> ID：14044234
> 
> 赞同：0
> 
> 时间：2012-12-26T17:55:29.890
> 
> 标签：c#, .net, multithreading, visual-studio-2010, treeview

> **可能重复：**
> [跨线程操作无效：从线程访问的控件不是在它创建时创建的](https://stackoverflow.com/questions/142003/cross-thread-operation-not-valid-control-accessed-from-a-thread-other-than-the)
> [线程 跨线程操作无效](https://stackoverflow.com/questions/5037470/cross-thread-operation-not-valid)

这是我的方法：（我已经看到了其他几个与跨线程相关的答案，但我不理解这些解决方案如何适合我的特定情况。）

```
private void live_refresh()
{
    while (true)
    {
            viewBackup.Nodes.Clear();
            Control.storage.refresh_files_list();
            viewBackup.Nodes.Add(Control.storage.get_files_node());

            List<FileInfo> list = Control.sched.get_difference();
            this.viewCopy.Items.Clear();
            foreach (FileInfo file in list)
                this.viewCopy.Items.Add(file.FullName.Substring(Control.filer.get_path().Length + 1));
        }
    }
} 
```

抛出异常：“跨线程操作无效：控件'viewBackup'从创建它的线程以外的线程访问。”

any1 可以帮我解决这个问题吗？除了 Invoke() 还有什么办法吗？我不明白。。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T17:58:42.617

使用[Invoke](http://msdn.microsoft.com/en-us/library/zyzhdc6b.aspx)从非 UI 线程更新 UI。要确定 UI 线程，请使用[InvokeRequired](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.invokerequired.aspx)

```
// Invoke version of your code sample:

private void live_refresh()
{
  if(viewBackup.InvokeRequired)
  {
    viewBackup.Invoke(new MethodInvoker(live_refresh));
    return ;
  }
  while(true)
  ....
  .....
} 
```

# c# - 使用按钮从 SQL DB 检索不同的图像

> ID：14044236
> 
> 赞同：0
> 
> 时间：2012-12-26T17:55:35.370
> 
> 标签：c#, sql, image

我正在尝试从我的 sql 数据库中检索图像，我只是这样做了：

```
cs.Open(); // open the connection
string sqlquery = "SELECT Pic_path FROM Picture WHERE ID='" + Land_ID + "'";
SqlCommand command = new SqlCommand(sqlquery, cs);
SqlDataReader sdr = command.ExecuteReader();
while (sdr.Read())
{ 
    Panel1.BackImageUrl = sdr["Pic_path"].ToString(); 
}
cs.Close(); 
```

但是我现在想知道，每当我单击一个按钮（例如下一个按钮）时，如何从图片表中检索不同的图像？

任何人都可以尽快帮助我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T17:58:04.073

您的按钮单击事件处理程序只需要递增`Land_ID`到下一个有效 ID，然后再次运行查询。

而且，另一方面，请不要构建这样的动态查询。它们让您对各种有趣的攻击持开放态度。您应该改用[参数化查询](http://www.codinghorror.com/blog/2005/04/give-me-parameterized-sql-or-give-me-death.html)。

# java - 来自 LogCat 的 NullPointerExceptiom

> ID：14044238
> 
> 赞同：-2
> 
> 时间：2012-12-26T17:55:49.443
> 
> 标签：java, android, nullpointerexception, android-arrayadapter

> **可能重复：**
> [LogCat 条目含义 2](https://stackoverflow.com/questions/14044001/logcat-entry-meaning-2)

LogCat 说问题出在数组适配器上，它有一个 NullPointerException。我怎么解决这个问题？如果我按下按钮添加，应用程序会崩溃。

```
package com.example.to_doliste;

import java.util.List;
import android.app.ListActivity;
import android.os.Bundle;
import android.view.View;
import android.widget.ArrayAdapter;
import android.widget.EditText;

public class MainActivity extends ListActivity {
    private CommentsDataSource datasource;

      @Override
      public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        datasource = new CommentsDataSource(this);
        datasource.open();

        List<Comment> values = datasource.getAllComments(); 
```

阵列适配器获取构建

```
 ArrayAdapter<Comment> adapter = new ArrayAdapter<Comment>(this,
            android.R.layout.simple_list_item_1, values);
        setListAdapter(adapter);
      } 
```

它在这里使用

```
 public void onClick(View view) {
        @SuppressWarnings("unchecked")
        ArrayAdapter<Comment> adapter = (ArrayAdapter<Comment>) getListAdapter();
        Comment comment = null;
        switch (view.getId()) {
        case R.id.add:

          String comments;
            EditText Feld1 = (EditText)findViewById(R.id.editText1);

            if (Feld1.getText().toString().length() == 0)
                    {
                return;
                    }

            comments = (Feld1.getText().toString());

            Feld1.setText(String.valueOf(comments));

          adapter.add(comment);
          break;
        case R.id.delete:
          if (getListAdapter().getCount() > 0) {
            comment = (Comment) getListAdapter().getItem(0);
            datasource.deleteComment(comment);
            adapter.remove(comment);
          }
          break;
        }
        adapter.notifyDataSetChanged();
      } 
```

适配器在这里停止

```
 @Override
      protected void onResume() {
        datasource.open();
        super.onResume();
      }

      @Override
      protected void onPause() {
        datasource.close();
        super.onPause();
      }

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T17:59:27.537

这里

```
Comment comment = null; 
```

您正在尝试向适配器添加评论，但评论为空。在将注释初始化为 null 后，您不会更新注释中的任何新值，因此请在从适配器中添加或删除之前更新它。

# objective-c - Objective C中具有相同间隔的多个计时器是否相互干扰？

> ID：14044239
> 
> 赞同：1
> 
> 时间：2012-12-26T17:55:55.333
> 
> 标签：objective-c, nstimer

我`NSTimers`在 Objective-C 中有两个。其中之一是使物体在 iPhone 屏幕上缓慢移动，而另一个是得分计时器，每 0.5 秒增加一分。将对象向上移动到屏幕上的计时器也有 0.5 秒的间隔。这些计时器在按下按钮时被调用/激活。按下按钮时，对象会在屏幕上缓慢移动 0.5 秒。0.5 秒后，得分加一分，运行正常。

然而，问题在于，在 0.5 秒后，对象立即移回屏幕底部的原始位置。然后它再次开始向上移动 0.5 秒，并立即移回屏幕底部。计分计时器完美运行，每 0.5 秒加 1 分。

## 代码

```
-(IBAction)play:(id)sender{

    gametimer1 = [NSTimer scheduledTimerWithTimeInterval:0.05f target:self selector:@selector(gameLoop) userInfo:nil repeats:YES];

    scoretimer = [NSTimer scheduledTimerWithTimeInterval:0.05f target:self selector:@selector(scorechange) userInfo:nil repeats:YES];
}

-(void)scorechange{

    score = score + 1;
    scorelab.text = [NSString stringWithFormat:@"%i", score];

}

-(void)gameLoop{

    balstarted = YES;
    bal.center = CGPointMake(bal.center.x, bal.center.y - balspeed);

} 
```

再一次，我的对象 bal 并没有按照应有的方式向上移动屏幕，而是仅向上移动了几个像素（在 0.5 秒内），然后将自身重置到之前的位置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T19:40:41.713

## 修改

您启用了自动布局。当您更改`scorelab.text`时，`UILabel`通知自动布局系统其固有内容大小已更改，这会导致自动布局重置每个视图的位置和大小。由于您没有更改 上的约束`bal`，因此自动布局会重置其位置。

您可以[关闭 autolayout](https://stackoverflow.com/a/13201690/77567)，也可以修改`bal`的约束而不是`center`直接设置它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T18:03:04.010

选择器都在您安排计时器的同一线程中执行。只要您从同一个线程调度两个计时器，就没有任何干扰。如果在调度的方法中使用共享对象，则没有竞争条件。
仅当您从不同线程调度计时器并且它们使用共享对象时，才会存在竞争条件。

# android - Android：使用异步任务读取原始数据文件

> ID：14044240
> 
> 赞同：0
> 
> 时间：2012-12-26T17:56:08.473
> 
> 标签：android, file

我目前需要读取大量以这种方式组织的数据行：

```
> *Name *IndexNumber *LocationA *LocationB *LocationC
> 
> 
> Barrel 4315124 2 3 43       > 
> car 414124 2 4 41           | 
> Red box 4315124 1 2 77      |--> actual file. 
> Glass cup 4515124 4 7 10    |
> Iron cup 4515124 4 7 9      >
> 
> ...
> --and so on--- 
```

在 Asynctask 中读取它的最佳方式是什么？谢谢 :) 我知道我需要使用 I/O 流，但我也知道有很多方法可以读取数据，所以我的问题是最好使用什么以及如何使用。:)

# c++ - 有没有双向管道之类的东西？我希望输入和输出在两个简单程序之间进行交互

> ID：14044241
> 
> 赞同：3
> 
> 时间：2012-12-26T17:56:16.387
> 
> 标签：c++, shell, io-redirection

我想写一个程序来解决一个简单的猜谜游戏。我正在学习命令行管道和重定向，所以我想知道这是否可能。

基本上我希望一个的输出成为另一个的输入，然后那个的输出成为另一个的输入。

这只是为了好玩，所以我可以学习，我知道我可以更改猜谜游戏的源代码并包含求解算法，但只是为了好玩让我们假设我没有源代码。

这甚至可能吗？这是我的代码：

```
//GuessingGame.cc    

#include <cstdlib>
#include <iostream>

using namespace std;

int main() {
    srand(time(NULL));
    int number = rand()%100; 
    int guess = -1;
    int trycount = 0;

    while(guess != number && trycount < 8) {

        cout << "Please enter a guess: ";
        cin >> guess;

        if(guess < number)
            cout << "Too low" << endl;

        else if(guess > number)
            cout << "Too high" << endl;

        trycount++;
    }

    if(guess == number)
        cout << "You guessed the number!";

    else 
        cout << "Sorry, the number was: " << number;

    return 0;
} 
```

**求解器.cc**

```
#include <iostream>
#include <fstream>

using namespace std;

int main(int argc, char* argv[]) {

    string prompt;
    int high = 100;
    int low = 0;
    int guess = 50;

    getline(cin,prompt);
    if(prompt == "Please enter a guess: ")
        cout << guess;

    while(true) {
        getline(cin,prompt);
        if(prompt == "Too low")
            low = guess;

        else if(prompt == "Too high")
            high = guess;

        else if(prompt == "You guessed the number!")
            return 0;

        guess = (low+high)/2;
        cout << guess;
    }
} 
```

我希望你明白我在做什么，我不太关心这个程序，它只是一个例子。主要问题是您是否可以使用重定向和管道等与两个不同的程序进行交互。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T17:59:07.553

根据定义，管道是一种单向通信设备。然而，它可以通过使用两根管道来解决，每个方向一根。问题是它不能通过外壳轻松完成，您必须编写一个程序来设置管道，为您的程序创建进程，然后使用设置为正确输入/输出通道的管道执行它们。

我可以考虑如何通过 shell 实现这一点的唯一方法是使用[`mkfifo`](http://linux.die.net/man/1/mkfifo)命令创建两个管道。在后台启动一个程序，输入和输出从/到正确的管道重定向，然后对另一个程序执行相同的操作，但使用另一个管道作为输入和输出。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-26T18:12:16.220

管道是单向的。如果你用你选择的编程语言打开一个管道，你必须自己处理创建两个管道。

Korn shell 系列提供的双向 I/O 的传统抽象是协同进程。名称中带有“ksh”的 shell 的语法大多是可移植的。

ksh93 / mksh / 其他 pdkshes：

```
{ cmd1...; } |& cmd2 <&p >&p 
```

Bash 和 Zsh 尽管有许多相同的特性，但有不同的、不兼容的语法。例如，Bash 添加了一个额外的关键字并将 FD 分配给一个数组。

```
coproc { cmd1; }; cmd2 <&"${COPROC[0]}" >&"${COPROC[1]}" 
```

协同进程的主要替代方案是进程替换、普通管道和命名管道，但它们本身不是双向的。

# javascript - 在 IE 和 Chrome 中动态加载 jQuery

> ID：14044248
> 
> 赞同：5
> 
> 时间：2012-12-26T17:56:52.297
> 
> 标签：javascript, jquery, html, internet-explorer, google-chrome

我正在创建一个使用 jQuery 的外部小部件，而不是让用户单独包含它，我想检查它是否已加载，如果没有则动态加载它。

问题是我需要等到它被加载才能执行脚本的其余部分，这需要 IE 和 FF/Chrome 以不同方式处理的事件处理程序。

如果我这样做，它在 IE8 中可以正常工作：

```
<div id="test">
<p>This is a test.</p>
</div>

<script>
if (typeof jQuery == 'undefined') {
    s = document.createElement("script");
    s.src = "//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js";
    if (s.addEventListener) {
        s.addEventListener("load", runScript, false);
    } else if (s.readyState) {
        s.onreadystatechange = runScript;
    }

} else {
    runScript();
}

function runScript() {
    document.getElementsByTagName('head')[0].appendChild(s);
    $('#test').css('font-size', '50px');

}
</script> 
```

但这在 Chrome 中不起作用。但是，如果我之前附加脚本，它可以在 Chrome 中运行，但不能在 IE 中运行：

```
<div id="test">
<p>This is a test.</p>
</div>

<script>
if (typeof jQuery == 'undefined') {
    s = document.createElement("script");
    s.src = "//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js";
    document.getElementsByTagName('head')[0].appendChild(s);
    if (s.addEventListener) {
        s.addEventListener("load", runScript, false);
    } else if (s.readyState) {
        s.onreadystatechange = runScript;
    }

} else {
    runScript();
}

function runScript() {

    $('#test').css('font-size', '50px');

}
</script> 
```

关于如何使用适用于 IE 和 Chrome 的事件处理程序动态加载 jQuery 的任何想法？

**编辑：**将 appendChild 目标从 test 更改为 head。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T18:04:43.290

在第一个代码中，您在完成时将脚本附加到您正在调用的函数中！

什么元素是测试？

```
document.getElementsByTagName('test')[0].appendChild(s);  <-- looking for element
<div id="test">  <-- test is an id 
```

代码应该看起来像

```
if (typeof jQuery == 'undefined') {
    var s = document.createElement("script");
    s.src = "//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js";
    if (s.addEventListener) {
        s.addEventListener("load", runScript, false);
    } else if (s.readyState) {
        s.onreadystatechange = runScript;
    }
    document.getElementsByTagName('head')[0].appendChild(s);
} else {
    runScript();
}

function runScript() {
    $('#test').css('font-size', '50px');
} 
```

运行示例：http: [//jsfiddle.net/5986T/](http://jsfiddle.net/5986T/)

# jquery - 获取拖动克隆Jquery的位置

> ID：14044250
> 
> 赞同：0
> 
> 时间：2012-12-26T17:57:13.850
> 
> 标签：jquery

我正在尝试使用克隆和拖动元素的位置更新元素（命名报告）。但是迷失了为什么它不起作用。到目前为止，我有：

```
 var b1h;
 var b1w;
 var b1p;
 var b1X;
 var b1Y;
 var inc = 0;

$('.drag').draggable({helper: "clone"}); $('.drag').bind('dragstop', function(event, ui) { $(this).after($(ui.helper).clone().draggable());
$(this).attr("id",'dragged'+inc);      inc++; console.log($(this).attr("id"));  console.log($(this).offset()); $(this).addClass("drug").appendTo('#container');  }); 
```

然后稍后：

```
$('.drug').click(function(){
b1h = $('.drug').height(); 
b1w = $('.drug').width(); 
b1p = $('.drug').position(); 
b1X = b1p.left;
b1Y = b1p.top;
$('.report').html(b1h+'x'+b1w + ' Y =' + b1Y + ' X =' + b1X ); }); 
```

类药物工作的现有元素，但不是克隆的。知道我能做些什么来让克隆的工作正常吗？

编辑：好的，没有人回应，所以让我看看我是否可以更好地解释。如果我克隆一个元素并拖动它，我如何从同一元素的后续拖动中获取位置？

到目前为止，我只能从第一次拖动中获得位置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T22:06:20.833

在您的 dragstop 事件中，“this”是调用该事件的放置目标。您似乎正在为“this”添加属性。我认为您打算将 id 属性添加到被拖动的内容中。那将是 ui.draggable。

# r - 从数据框中提取因子列

> ID：14044255
> 
> 赞同：1
> 
> 时间：2012-12-26T17:58:02.220
> 
> 标签：r, dataframe

当我从因子列中提取一些行时，我的数据框正在中断：

```
data.df = data.frame(x = factor(letters[1:10]))
data.temp = data.df[1:3, ]
print(data.temp) 
```

我怎样才能避免这种情况？我还需要保留列名。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T18:03:54.323

您可以添加参数`drop=FALSE`以将数据保留为数据框。

```
 data.df = data.frame(x = factor(letters[1:10]))     
 data.temp = data.df[1:3, ,drop=FALSE]
 print(data.temp)
  x
1 a
2 b
3 c 
```

# javascript - 用于添加表格行 onclick 事件的 JavaScript

> ID：14044257
> 
> 赞同：2
> 
> 时间：2012-12-26T17:58:09.610
> 
> 标签：javascript

我是 Javascript 的新手。我想将 onclick 事件添加到表行。我没有使用 JQuery。

我遍历行并使用闭包来确保我拥有每一行的外部函数的状态。循环工作。使用警报，我看到为每次迭代分配的功能。但是当我单击该行时，不会显示任何警报。下面是可以加载的 HTML 和代码。

为什么表格行事件不起作用？

```
<!doctype html>
<html lang="en">
<body>
<script>
function example4() {
    var table = document.getElementById("tableid4");
    var rows = table.getElementsByTagName("tr");
    for (var i = 0; i < rows.length; i++) {
        var curRow = table.rows[i];
        //get cell data from first col of row
        var cell = curRow.getElementsByTagName("td")[0];
        curRow.onclick = function() {
            return function() {
                alert("row " + i + " data="+ cell.innerHTML);
            };
        };
    }
}
function init() { example4(); }
window.onload = init;   
</script>
<div>
Use loop to assign onclick handler for each table row in DOM. Uses Closure.
    <table id="tableid4" border=1>
      <tbody>
        <tr><td>Item one</td></tr>
        <tr><td>Item two</td></tr>
        <tr><td>Item three</td></tr>
      </tbody>
    </table>
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-26T18:04:47.747

这似乎是规范的方式

[演示](http://jsfiddle.net/mplungjan/duXGs/)

```
function example4() {
    var table = document.getElementById("tableid4");
    var rows = table.rows; // or table.getElementsByTagName("tr");
    for (var i = 0; i < rows.length; i++) {
        rows[i].onclick = (function() { // closure
            var cnt = i; // save the counter to use in the function
            return function() {
              alert("row"+cnt+" data="+this.cells[0].innerHTML);
            }    
        })(i);
    }
}
window.onload = function() { example4(); }​ 
```

更新：@ParkerSuperstar 建议不需要 (i) 中的 i。我没有对此进行测试，但他的[小提琴](http://jsfiddle.net/ParkerSuperstar/pa8j3mhd/)似乎有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T18:03:23.947

我不太清楚你为什么在这里使用闭包，你能更详细一点吗？

您没有看到所需警报的原因是在 onclick 函数中，您正在返回另一个函数。IE：

```
window.onload = function() {
    return function() {
        alert("Closure... why?");
    };
}; 
```

像这样的东西不会真正起作用，因为你从来没有调用嵌套函数......在不使用闭包的情况下尝试它，或者评论解释你为什么想要一个闭包，因为你的解释对我来说没有多大意义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T18:10:19.633

你只需要删除一个额外的函数，脚本就会像这样

```
<script>
 function example4() {
    var table = document.getElementById("tableid4");
cells = table.getElementsByTagName('td');

 for (var i=0,len=cells.length; i<len; i++){
 cells[i].onclick = function(){
    alert(this.innerHTML);

}
 }
}
 function init() { example4(); }
 window.onload = init;   
 </script> 
```

# asp.net-mvc-3 - 自定义验证消息

> ID：14044267
> 
> 赞同：1
> 
> 时间：2012-12-26T17:58:51.237
> 
> 标签：asp.net-mvc-3, validation, custom-data-attribute

我在验证某些数据类型时遇到问题。除字符串外，还有 int、short、DateTime 等。假设我的视图模型类中有以下属性

```
public int? LineNumber { get; set; } 
```

当我输入不正确的值时，我得到 mvc 错误“值 'balblabl' 对 LineNumber 无效。”

但是，如果我只想输出“值不正确”之类的内容怎么办？或者如果我想使用其他语言怎么办？我不知道该怎么做（当然我可以使用 string 而不是 int 但这是一种痛苦的解决方法）

我已经尝试过 dataannotationsextensions `[DataAnnotationsExtensions.Integer(ErrorMessage = "Please enter a valid number.")]`属性。它不工作。我不能使用自定义验证属性，因为在活页夹转换之后，我在所有情况下都得到了空值，并且值不正确。我只是不能做我自己的验证。我可以编写自己的活页夹，但它看起来像个笑话。真的，我认为自定义验证消息是必须具备的功能之一，我不能相信 asp.net mvc 没有简单的方法来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T09:42:24.957

在我看来，我想添加另一种简单的方法来添加和维护自定义错误消息。使用[FluentValidation](http://nuget.org/packages/FluentValidation.MVC4) NuGet 包。
它很容易与 mvc 连接，看看[这里](http://fluentvalidation.codeplex.com/wikipage?title=mvc&referringTitle=Documentation)

您可以轻松地为模型指定大量规则并显示可以使用资源文件的自定义错误消息，例如：

```
public class CreateProductCommandValidator : AbstractValidator<CreateProductCommand>
    {
        public CreateAgendaPointCommandValidator()
        {
            RuleFor(cmd => cmd.price)
                .NotEmpty()
                .WithMessage(Translations.CreateProduct_Price)

        }
    }
} 
```

文档：[FluentValidationDocumentation](http://fluentvalidation.codeplex.com/documentation)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T20:38:32.630

当默认模型绑定器无法将输入字符串解析为其目标类型时，这些错误会自动添加。它们不像数据注释，您可以在其中指定资源而不是硬编码的字符串错误消息。

但是，您可以使用自己的资源文件，请参阅this [other question](https://stackoverflow.com/questions/1538873/how-to-replace-the-default-modelstate-error-message-in-asp-net-mvc-2/2115065#2115065)。创建资源文件后，您将更新 global.asax 以供默认模型绑定器使用它：

```
DefaultModelBinder.ResourceClassKey = "MyResources"; 
```

在默认模型绑定器的属性 ResourceClassKey 中设置自定义资源文件后，将根据以下标准解析值[（根据 MSDN）](http://msdn.microsoft.com/es-es/library/system.web.mvc.defaultmodelbinder.resourceclasskey%28en-us,VS.90%29.aspx)：

1.  如果未设置该属性，则 MVC 使用标准 MVC 资源。

2.  如果该属性设置为无效的类键（例如不存在的资源文件），则 MVC 将引发异常。

3.  如果设置了属性并且类键存在但文件中的资源名称在应用程序中不存在，则 MVC 使用标准 MVC 资源。

4.  如果设置了属性并且指定的资源可用，则 MVC 使用文件中的资源。

如果您需要知道特定消息的键值，[请检查此](https://github.com/ASP-NET-MVC/ASP.NET-Mvc-3/blob/master/mvc3/src/SystemWebMvc/Mvc/Resources/MvcResources.resx)。对于消息*值“{0}”对于 {1} 无效。*，您将需要使用键 DefaultModelBinder_ValueInvalid 添加一个值

# android - 我仍然在 Android MapView 中获得灰色瓷砖？

> ID：14044282
> 
> 赞同：0
> 
> 时间：2012-12-26T18:00:34.713
> 
> 标签：android, eclipse, api, android-mapview

我正在使用谷歌地图 MapView 开发和应用程序，当我将它加载到我的模拟器上时，我得到一个灰色瓷砖网格，我已经搜索了很多，大多数答案都说它是 API 密钥，但我确定我的是对的，因为我以前用过它并且它有效，我该怎么办？清单.xml

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.example.yearb"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="15" />
<uses-permission android:name="android.permission.INTERNET"/>

<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
      <uses-library android:name="com.google.android.maps" />
    <activity
        android:name=".MainActivity"
        android:label="@string/title_activity_main" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
</application> 
```

MainActivity.java

```
package com.example.yearb;

import com.google.android.maps.MapActivity;
import com.google.android.maps.MapView;

import android.os.Bundle;
import android.app.Activity;
import android.view.Menu;

public class MainActivity extends MapActivity {

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    MapView map = (MapView) findViewById(R.id.mvMain);

}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}

@Override
protected boolean isRouteDisplayed() {
    // TODO Auto-generated method stub
    return false;
}
} 
```

activity_main.xml

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent" >

<com.google.android.maps.MapView
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:apiKey="0bwuRHiU6fZBoh9d0Z8taP6UvPiMybshuXzWioQ"
    android:clickable="true"
    android:enabled="true" 
    android:id="@+id/mvMain"/>

</RelativeLayout> 
```

请帮助我，我已经完成了我的作业，搜索了大量的问题和答案，但找不到原因。谢谢你。

**已编辑** 问题出在我的模拟器上，它在设备上运行良好，但在模拟器上运行良好，但是当我更改模拟器的 API 级别时，它显示得很好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T18:34:19.447

您的**uses-library**必须介于 和 之间。用这个替换你的清单：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.example.yearb"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
android:minSdkVersion="8"
android:targetSdkVersion="15" />
<uses-permission android:name="android.permission.INTERNET"/>

<application
android:icon="@drawable/ic_launcher"
android:label="@string/app_name"
android:theme="@style/AppTheme" >
 <activity
    android:name=".MainActivity"
    android:label="@string/title_activity_main" >
    <intent-filter>
        <action android:name="android.intent.action.MAIN" />

        <category android:name="android.intent.category.LAUNCHER" />
    </intent-filter>
 <uses-library android:name="com.google.android.maps" />
 </activity>
 </application> 
```

# c# - 使用 Single/First 方法在 linq 或 lambda 表达式中返回多个值

> ID：14044283
> 
> 赞同：1
> 
> 时间：2012-12-26T18:00:36.993
> 
> 标签：c#, linq, lambda

考虑以下示例，在所有这些示例中，我试图将具有已知 ID 的省/州的代码和名称放入单个字符串变量中，其格式类似于“CA-California”：

```
string stateName = _repository.States.Single(s => s.StateId == stateId).Name;
string stateCode = _repository.States.Single(s => s.StateId == stateId).Code;
string stateCodeName = stateCode + "-" + stateName; 
```

```
var state = _repository.States.Single(s => s.StateId == stateId);
string stateCodeName = state.Code + "-" + state.Name; 
```

```
string stateCodeName = _repository.States.Where(s => s.StateId == stateId)
                                         .Select(s => s.Code + "-" + s.Name)
                                         .First(); 
```

在第一个示例中，只检索状态所需的属性，但代价是运行两个不同的查询。第二个示例只运行一个查询，但它检索状态的所有属性。第三个例子似乎没问题，但我的问题是，是否有一种方法可以使用 Single 和 First 方法从对象（或表中的列）中检索任意数量的属性，而不是全部或仅获取它们一次一个？

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T18:06:28.373

> 我的问题是，是否有一种方法可以使用 Single 和 First 方法从对象（或表中的列）中检索任意数量的属性，而不是一次获取所有属性或仅获取一个属性？

您可以使用匿名类型来执行此操作：

```
var state = _repository.States.Where(s => s.StateId == stateId)
     .Select(s => new { Code = s.Code, Name = s.Name })
     .First(); 
```

这将返回一个具有两个属性的匿名类型：`Code`和`Name`。

（如果有多个匹配项，您是否使用`First()`或`Single()`取决于您希望程序的行为方式。如果有多个匹配项，`Single()`则会引发异常。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T18:03:18.753

`First()`如果您要在第三个示例中更改 to 的使用`Single()`，您将得到您正在寻找的查询。

该查询将仅返回您期望的单个结果，并且只会返回您感兴趣的字段（已连接）。

# python - Django模板重组意外结果

> ID：14044285
> 
> 赞同：0
> 
> 时间：2012-12-26T18:00:44.823
> 
> 标签：python, django, django-templates, django-views

我有一个看起来像这样的视图：

```
def CarteleraPeliculaToday(request, slugpelicula):
    city = request.session["ciudad"]
    today = (datetime.utcnow() - timedelta(hours=5)).date()  # date: Ecuador time zone
    pelicula = Pelicula.objects.get(slug=slugpelicula)
    espanol_3d_gtmax = Funcion.objects.filter(fecha_inicio__lte=today, fecha_fin__gte=today, idpelicula__slug=slugpelicula, idciudad=city, visible=1, idioma="Espanol", tipo_3d=1, gtmax=1)
    espanol_3d = Funcion.objects.filter(fecha_inicio__lte=today, fecha_fin__gte=today, idpelicula__slug=slugpelicula, idciudad=city, visible=1, idioma="Espanol", tipo_3d=1)
    espanol_3d_vip = Funcion.objects.filter(fecha_inicio__lte=today, fecha_fin__gte=today, idpelicula__slug=slugpelicula, idciudad=city, visible=1, idioma="Espanol", tipo_3d=1, vip=1)
    espanol_3d_xd = Funcion.objects.filter(fecha_inicio__lte=today, fecha_fin__gte=today, idpelicula__slug=slugpelicula, idciudad=city, visible=1, idioma="Espanol", tipo_3d=1, xd=1)
    espanol_gtmax = Funcion.objects.filter(fecha_inicio__lte=today, fecha_fin__gte=today, idpelicula__slug=slugpelicula, idciudad=city, visible=1, idioma="Espanol", gtmax=1)
    espanol = Funcion.objects.filter(fecha_inicio__lte=today, fecha_fin__gte=today, idpelicula__slug=slugpelicula, idciudad=city, visible=1, idioma="Espanol")
    espanol_vip = Funcion.objects.filter(fecha_inicio__lte=today, fecha_fin__gte=today, idpelicula__slug=slugpelicula, idciudad=city, visible=1, idioma="Espanol", vip=1)
    espanol_xd = Funcion.objects.filter(fecha_inicio__lte=today, fecha_fin__gte=today, idpelicula__slug=slugpelicula, idciudad=city, visible=1, idioma="Espanol", xd=1)
    subtitulada_3d_gtmax = Funcion.objects.filter(fecha_inicio__lte=today, fecha_fin__gte=today, idpelicula__slug=slugpelicula, idciudad=city, visible=1, idioma="Subtitulada", tipo_3d=1, gtmax=1)
    subtitulada_3d = Funcion.objects.filter(fecha_inicio__lte=today, fecha_fin__gte=today, idpelicula__slug=slugpelicula, idciudad=city, visible=1, idioma="Subtitulada", tipo_3d=1)
    subtitulada_3d_vip = Funcion.objects.filter(fecha_inicio__lte=today, fecha_fin__gte=today, idpelicula__slug=slugpelicula, idciudad=city, visible=1, idioma="Subtitulada", tipo_3d=1, vip=1)
    subtitulada_3d_xd = Funcion.objects.filter(fecha_inicio__lte=today, fecha_fin__gte=today, idpelicula__slug=slugpelicula, idciudad=city, visible=1, idioma="Subtitulada", tipo_3d=1, xd=1)
    subtitulada_gtmax = Funcion.objects.filter(fecha_inicio__lte=today, fecha_fin__gte=today, idpelicula__slug=slugpelicula, idciudad=city, visible=1, idioma="Subtitulada", gtmax=1)
    subtitulada = Funcion.objects.filter(fecha_inicio__lte=today, fecha_fin__gte=today, idpelicula__slug=slugpelicula, idciudad=city, visible=1, idioma="Subtitulada")
    subtitulada_vip = Funcion.objects.filter(fecha_inicio__lte=today, fecha_fin__gte=today, idpelicula__slug=slugpelicula, idciudad=city, visible=1, idioma="Subtitulada", vip=1)
    subtitulada_xd = Funcion.objects.filter(fecha_inicio__lte=today, fecha_fin__gte=today, idpelicula__slug=slugpelicula, idciudad=city, visible=1, idioma="Subtitulada", xd=1)

    #Creating a dictionary of all types of funciones querysets
    funciones = {'espanol': espanol, 'subtitulada': subtitulada, 'espanol_3d': espanol_3d, 'subtitulada_3d': subtitulada_3d, 'espanol_3d_gtmax': espanol_3d_gtmax,
'espanol_vip': espanol_vip, 'espanol_xd': espanol_xd, 'subtitulada_3d_gtmax': subtitulada_3d_gtmax,  'subtitulada_3d_vip': subtitulada_3d_vip,  'espanol_3d_vip': espanol_3d_vip, 'espanol_3d_xd': espanol_3d_xd, 'espanol_gtmax': espanol_gtmax,
'subtitulada_3d_xd': subtitulada_3d_xd, 'subtitulada_gtmax': subtitulada_gtmax, 'subtitulada_vip': subtitulada_vip, 'subtitulada_xd': subtitulada_xd}

    #Removing empty element from funciones dictionary
    for x in list(funciones.keys()):
        if not (funciones[x]).exists():
            del funciones[x]

    context = {'pelicula': pelicula, 'funciones': funciones}
    return render_to_response('cartelera-pelicula.html', context, context_instance=RequestContext(request)) 
```

示例（来自 ipdb）：

```
(Pdb) funciones
{'espanol_3d_gtmax': [<Funcion: ted, Funcion #15: Sebas el Genio>], 'espanol_3d_vip': [<Funcion: ted, Funcion #15: Sebas el Genio>], 'espanol_3d_xd': [<Funcion: ted, Funcion #15: Sebas el Genio>], 'espanol_xd': [<Funcion: ted, Funcion #15: Sebas el Genio>], 'espanol_vip': [<Funcion: ted, Funcion #15: Sebas el Genio>], 'espanol_3d': [<Funcion: ted, Funcion #15: Sebas el Genio>], 'espanol': [<Funcion: American Junkie, Funcion #9: Sebas el Genio>, <Funcion: ted, Funcion #15: Sebas el Genio>], 'espanol_gtmax': [<Funcion: ted, Funcion #15: Sebas el Genio>]}
<type 'dict'> 
```

现在访问一个值：

```
funciones['espanol']
[<Funcion: American Junkie, Funcion #9: Sebas el Genio>, <Funcion: ted, Funcion #15: Sebas el Genio>]
type(funciones['espanol'])
<class 'django.db.models.query.QuerySet'> 
```

最后从查询集中访问一个项目：

```
(Pdb) funciones['espanol'][0]
<Funcion: American Junkie, Funcion #9: Sebas el Genio>
type(funciones['espanol'][0])
<class 'core_app.models.Funcion'> 
```

现在，我的模板如下所示：

```
{% for key,value in funciones.items %}
    {% regroup value by idcine as cine_list %}
    <ul>
        {% for c in cine_list %}
        <li>{{ c.grouper }}</li>
        <ul>
            {% for item in cine_list %} 
               <li>{{key}}:{{item}}</li>   
            {% endfor %}    
        </ul></li>  
        {% endfor %}
    </ul>
    {% endfor %} 
```

我得到的输出：

```
Supercines Quicentro Sur

espanol_3d_gtmax:{'list': [<Funcion: Supercines Quicentro Sur, Funcion #27: Intouchables>], 'grouper': <Cine: Supercines Quicentro Sur>}

Supercines Quicentro Sur

espanol_3d_vip:{'list': [<Funcion: Supercines Quicentro Sur, Funcion #27: Intouchables>], 'grouper': <Cine: Supercines Quicentro Sur>}

Supercines Quicentro Sur

espanol_3d_xd:{'list': [<Funcion: Supercines Quicentro Sur, Funcion #27: Intouchables>], 'grouper': <Cine: Supercines Quicentro Sur>}

Multicines CCI
espanol_3d:{'list': [<Funcion: Multicines CCI, Funcion #16: Intouchables>], 'grouper': <Cine: Multicines CCI>}
espanol_3d:{'list': [<Funcion: Supercines Quicentro Sur, Funcion #27: Intouchables>], 'grouper': <Cine: Supercines Quicentro Sur>}

Supercines Quicentro Sur
espanol_3d:{'list': [<Funcion: Multicines CCI, Funcion #16: Intouchables>], 'grouper': <Cine: Multicines CCI>}
espanol_3d:{'list': [<Funcion: Supercines Quicentro Sur, Funcion #27: Intouchables>], 'grouper': <Cine: Supercines Quicentro Sur>}

Multicines Recreo
subtitulada_vip:{'list': [<Funcion: Multicines Recreo, Funcion #28: Intouchables>], 'grouper': <Cine: Multicines Recreo>}

Multicines CCI
espanol:{'list': [<Funcion: Multicines CCI, Funcion #16: Intouchables>], 'grouper': <Cine: Multicines CCI>}
espanol:{'list': [<Funcion: Supercines Quicentro Sur, Funcion #27: Intouchables>], 'grouper': <Cine: Supercines Quicentro Sur>} 
```

而我会得到的是这样的：

```
Supercines Quicentro Sur
espanol_3d_gtmax:{'list': [<Funcion: Supercines Quicentro Sur, Funcion #27: Intouchables>], 'grouper': <Cine: Supercines Quicentro Sur>}
espanol_3d_vip:{'list': [<Funcion: Supercines Quicentro Sur, Funcion #27: Intouchables>], 'grouper': <Cine: Supercines Quicentro Sur>}
espanol_3d_xd:{'list': [<Funcion: Supercines Quicentro Sur, Funcion #27: Intouchables>], 'grouper': <Cine: Supercines Quicentro Sur>}

Multicines CCI
espanol_3d:{'list': [<Funcion: Multicines CCI, Funcion #16: Intouchables>], 'grouper': <Cine: Multicines CCI>}
espanol:{'list': [<Funcion: Supercines Quicentro Sur, Funcion #27: Intouchables>], 'grouper': <Cine: Supercines Quicentro Sur>}

Multicines Recreo
subtitulada_vip:{'list': [<Funcion: Multicines Recreo, Funcion #28: Intouchables>], 'grouper': <Cine: Multicines Recreo>} 
```

关于我应该改变什么以获得我想要的输出的任何想法？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T19:19:20.140

对于您的`regroup`线路，请先尝试`dictsort`：

```
{% regroup value|dictsort:"idcine" by idcine as cine_list %} 
```

# mongodb - 对 MongoDB 架构设计的建议

> ID：14044287
> 
> 赞同：8
> 
> 时间：2012-12-26T18:00:45.660
> 
> 标签：mongodb, nosql

假设您想对某些情况进行建模。公司可以有一个或多个分支机构。这些分支机构的员工可以在不同的公司（甚至同一公司的两个不同的分支机构）工作。这当然只是一个例子。

我们还假设大多数搜索/查询将在员工和公司集合上完成。

第一种（天真的）方法是嵌入所有内容（公司有分支机构，分支机构有员工）：

```
{
    name: "Company name",
    // other company data
    branches : [
        { 
            name: "Branch name",
            // other branch data
            Employees: [
                {
                    // employee1 data
                },
                {
                    // employee data
                },
            ]
        }
    ]
} 
```

但是当人们对检索员工信息感兴趣时，这将是非常低效的（必须检索公司，然后遍历每个分支机构以查找所需的员工）。

另一方面，可以使用引用并模仿 RDBMS（会有 Company、Branch 和 Employee 集合），但这意味着更多的查询。

第三个选项（我最接近）是将 Employee 作为一个单独的集合，然后在 Branches 中有一个对它的引用数组。此外，为了允许更快的查询，例如：“具有特定名称的员工，为特定公司和特定分支机构工作”，Company ObjectId 可以存储在 Employee 集合中：

```
{
    company_id: "some id",
    first_name: "First name",
    last_name: "Last name",
    //
} 
```

因此，在这种情况下，要搜索为特定公司和特定分支机构工作的具有特定姓名的所有员工，必须进行两次查询。第一个查询将返回满足“公司条件”（公司名称和分支机构名称）的公司，然后对 Employee 集合的第二个查询将返回所有具有指定名称且在其 id 在第一个查询中返回的公司工作的员工。

你会以其他方式做到这一点吗？有没有其他“推荐”的方式来做到这一点？你会添加一些改进吗？

更重要的是，当这两个查询返回的结果集有小的交集时怎么办？在这种情况下如何提高性能？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-27T13:09:13.503

**我认为您大多朝着正确的方向前进。**

虽然在某些情况下，MongoDB 中的非规范化并不像关系数据库中那样邪恶，但实际上是正确的做法，但这里有一个案例，您应该使用多个集合。这是因为 MongoDB 文档的上限为 16MB。当你有一家非常大的公司，有很多分支机构，有很多员工，并且员工子文档变得更加复杂时，你可以很容易地突破这个限制。

让员工向公司推荐是个好主意。但是你应该考虑不要使用公司的_id字段，而是使用公司名称和分公司名称，只要你能保证它们的每个组合在公司集合中都是唯一的（比如在这两个上使用唯一的复合索引字段）。原因是当您查找员工时，您通常还需要公司和分支机构的名称。当您只有 _id 时，您将不得不进行额外的查询以获取该信息。

你说你在分支机构和员工之间没有1：n的关系，而是一种：m的关系。在这种情况下，我建议您为每个员工添加一个“分配”数组，其中包含具有两个字段的对象，company_name 和 company_branch（也许您想添加第三个字段“职位”，说明他或她在做什么那里）。

您的员工文件将如下所示：

```
{
    first_name: "First name",
    last_name: "Last name",
    //
    assignments: [
        { company:"Aperture Science", branch:"R&D", position:"test subject" },
        { company:"Black Mesa", branch:"security", position:"leader of blue shift" }
    ]
} 
```

请注意，您可以在这里使用无模式数据库的优势：您可以很容易地拥有不仅有分支机构，而且还有更多层次结构级别（如部门和组）的公司，而其他公司则没有。

**但是当我想重命名公司或分支机构时怎么办？**

In that case you would have to update each employee document which references the renamed company/branch. Yes, it wouldn't be the most efficient schema for that case. But remember that MongoDB schemas should always be optimized for the most common use-cases. What do you think will happen more frequently: a) a company or branch is renamed or b) someone wants to look up an employee?

# ruby - 使用 Ruby 将 SSH 自动化到 Windows

> ID：14044289
> 
> 赞同：8
> 
> 时间：2012-12-26T18:00:46.683
> 
> 标签：ruby, windows, ssh, jenkins

我有 13 个运行 Jenkins Slaves 的 Windows 服务器。出于某种原因（Windows 更新？），Jenkins slave 会定期退出工作，并且需要重新启动 Jenkins Slave 服务。如果我手动 SSH 到机器（cygwin ssh 服务器正在运行），我只需输入：

```
net stop "Jenkins Slave"
net start "Jenkins Slave" 
```

这（几乎）总能解决问题。

所以我写了一个 Ruby 脚本来自动化这个。

这是：

```
#!/usr/bin/env ruby
require 'rubygems'
require 'net/ssh'

USER = 'Administrator'
PASS = 'PASSWORD'
hosts = [:breckenridge, :carbondale, :crestone, :denali, :gunnison, :sneffels, "mammoth", "whitney", "snowmass", "firestone",  "avon", :grizzly, :silverton]

hosts.each {|host|
    puts "SSHing #{host} ..." 
    Net::SSH.start( HOST, USER, :password => PASS ) do |ssh|
        puts ssh.exec!('net stop "Jenkins Slave"')
        puts ssh.exec!('net start "Jenkins Slave"')
        puts "Logging out..."
    end
} 
```

该脚本在所有机器上执行，我看到服务已启动的输出。但是，这*永远*行不通。当我 ssh 回到机器时，服务还没有启动。

可悲的是，我不能使用 Linux——我无法控制这些机器。

关于为什么手动执行的 SSH 有效但脚本无效的任何想法？

谢谢菲尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T21:06:21.190

我在 Pry 中试了一下，发现了两个问题：

1.  HOST 未定义，应该是`host`因为这是传递到块中的变量。
2.  SSH.start 期望参数是`STRING`类，所以添加`.to_s`如下所示。

此外，我将它切换为`do...end`当块超过 1 行时使用的惯用 Ruby 模式。

```
hosts.each do |host|
    puts "SSHing #{host} ..." 
    Net::SSH.start( host.to_s, USER, :password => PASS ) do |ssh|
        puts ssh.exec!('date')
        puts "Logging out..."
    end
end 
```

我在 Pry 中对此进行了测试，现在可以正常工作了。我希望这有帮助。

# php - 使用 VichGeographicalBundle 在 Symfony2 中单击时未显示 Google 地图信息窗口

> ID：14044290
> 
> 赞同：4
> 
> 时间：2012-12-26T18:01:11.027
> 
> 标签：php, symfony, google-maps-api-3, google-maps-markers, symfony-2.1

我已成功设置[VichGeographicalBundle](https://github.com/dustin10/VichGeographicalBundle/blob/master/Resources/doc/index.md)以在 Google 地图中显示一堆地点。一切正常，除了点击时不显示的信息窗口。

`$this->setShowInfoWindowsForMarkers(true);`已设置但似乎不起作用。

有任何想法吗 ？

**编辑：**

```
class allShopsMap extends Map
{
    /**
     * Constructs a new instance of LocationMap.
     */
    public function __construct(EntityManager $em)
    {
        parent::__construct();

        // configure your map in the constructor 
        // by setting the options

        $this->setShowZoomControl(true);
        $this->setZoom(13);
        $this->setAutoZoom(false);
        $this->setContainerId('map_canvas');
        $this->setWidth(980);
        $this->setHeight(360);
        $this->setShowInfoWindowsForMarkers(true);
        $this->setCenter(23.232323,23.232323);
        $this->setShowMapTypeControl(true);

        $query = $em->createQuery("SELECT st
                       FROM acme\ShopBundle\Entity\Shop sh 
                       WHERE sh.published = 1 ");
        $shops = $query->getResult();

        foreach ($shops as $shop) {
            $this->addMarker(new MapMarker($shop->getLatitude(), $shop->getLongitude(),$icon='images/map_marker.png'));
        }
    }
} 
```

从树枝模板调用：

```
{{ vichgeo_map('allShops') }} 
```

配置.yml

```
vich_geographical:
    db_driver: orm 
    query_service: vich_geographical.query_service.default
    map_renderer: vich_geographical.map_renderer.google
    templating:
        engine: twig
        info_window: msgrShopBundle:Map:infoWindow.html.twig

services:
    msgr.map.allShops:
        class: msgr\ShopBundle\Map\allShopsMap  
        tags:
           -  { name: vichgeo.map, alias: allShops }
        arguments: 
            entityManager: "@doctrine.orm.entity_manager" 
```

生成的 HTML 代码：http `{{ vichgeo_map('allShops') }}`: [//pastebin.com/jqvzG67N](http://pastebin.com/jqvzG67N)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T10:54:17.700

试试这个：

```
class allShopsMap extends Map
{
    /**
     * Constructs a new instance of LocationMap.
     */
    public function __construct(EntityManager $em, $infoWindowBuilder)
    {
        parent::__construct();

        // configure your map in the constructor 
        // by setting the options

        $this->setShowZoomControl(true);
        $this->setZoom(13);
        $this->setAutoZoom(false);
        $this->setContainerId('map_canvas');
        $this->setWidth(980);
        $this->setHeight(360);
        $this->setShowInfoWindowsForMarkers(true);
        $this->setCenter(23.232323,23.232323);
        $this->setShowMapTypeControl(true);

        $query = $em->createQuery("SELECT st
                       FROM acme\ShopBundle\Entity\Shop sh 
                       WHERE sh.published = 1 ");
        $shops = $query->getResult();

        foreach ($shops as $shop) {
            $marker = new MapMarker($shop->getLatitude(), $shop->getLongitude(),$icon='images/map_marker.png');
            $marker->setInfoWindow($infoWindowBuilder->build($marker)); 
            $this->addMarker($marker);
        }
    }
} 
```

infoWindowBuilder 是`vich_geographical.info_window_builder`容器中可用的服务。

并修改您的配置：

```
services:
    msgr.map.allShops:
        class: msgr\ShopBundle\Map\allShopsMap  
        tags:
           -  { name: vichgeo.map, alias: allShops }
        arguments: 
            entityManager: "@doctrine.orm.entity_manager" 
            infoWindowBuilder: "@vich_geographical.info_window_builder" 
```

# java - JFileChooser 在全屏 JFrame 之外显示

> ID：14044298
> 
> 赞同：3
> 
> 时间：2012-12-26T18:02:19.203
> 
> 标签：java, swing, jframe, fullscreen, jfilechooser

```
import java.awt.DisplayMode;
import java.awt.GraphicsDevice;
import java.awt.GraphicsEnvironment;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.JButton;
import javax.swing.JFileChooser;
import javax.swing.JFrame;
import javax.swing.JPanel;

public class Sample {
    public static String audioName;
    /**
     * @param args the command line arguments
     */
    public static void main(String[] args) {
        final JFrame frame = new JFrame();
        frame.setTitle("Frame");
        frame.setSize(800, 600);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        GraphicsDevice device = GraphicsEnvironment.getLocalGraphicsEnvironment().getDefaultScreenDevice();
        device.setFullScreenWindow(frame);
        device.setDisplayMode(new DisplayMode(800, 600, 32, 60));
        frame.setVisible(true);

        JButton btn = new JButton();
        btn.setText("Button");
        JPanel panel = new JPanel();

        panel.add(btn);
        frame.add(panel);
        btn.addActionListener(new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent e) {
                JFileChooser chooser = new JFileChooser();
                int returnName = chooser.showOpenDialog(frame);
                if (returnName == JFileChooser.APPROVE_OPTION) {
                    System.out.println("Sample");
                }
            }
        });
    }
} 
```

如何在全屏内显示 JFileChooser？我不熟悉 JInternalFrame/JDesktopPane，你认为这会解决这个问题还是有其他方法可以解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T18:19:54.283

在`JFileChooser`装有 Java 6 的 Windows XP 计算机上，它位于框架的中心。我将框架移动到两个显示器上的不同位置。

我注释掉了更改显示设置的行，并修复了一些其他问题。

```
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.JButton;
import javax.swing.JFileChooser;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.SwingUtilities;

public class Sample implements Runnable {
    public static String    audioName;

    public void run() {
        final JFrame frame = new JFrame();
        frame.setTitle("Frame");
        frame.setSize(800, 600);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
//      GraphicsDevice device = GraphicsEnvironment
//              .getLocalGraphicsEnvironment().getDefaultScreenDevice();
//      device.setFullScreenWindow(frame);
//      device.setDisplayMode(new DisplayMode(800, 600, 32, 60));

        JButton btn = new JButton();
        btn.setText("Button");
        JPanel panel = new JPanel();

        panel.add(btn);
        frame.add(panel);
        frame.setExtendedState(
                frame.getExtendedState() | JFrame.MAXIMIZED_BOTH);
        btn.addActionListener(new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent e) {
                JFileChooser chooser = new JFileChooser();
                int returnName = chooser.showOpenDialog(frame);
                if (returnName == JFileChooser.APPROVE_OPTION) {
                    System.out.println("Sample");
                }
            }
        });
        frame.setVisible(true);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Sample());
    }
} 
```

如果你想最大化你的，你可以在你的方法`JFrame`之前的某处添加以下语句。`setVisible`

```
frame.setExtendedState(frame.getExtendedState() | JFrame.MAXIMIZED_BOTH); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-17T17:20:40.943

我建议不要使用弹出窗口，而是将其嵌入`JFileChooser`到您的应用程序中。它会使您的代码更长一点，但从我的角度来看，在无窗口应用程序中弹出窗口并没有什么意义（就我个人而言，我不太喜欢弹出窗口）。

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class FullScreenApp {

    public static void main(String[] args) {
        final JFrame frame = new JFrame();
        frame.setTitle("Frame");
        frame.setSize(800, 600);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        GraphicsDevice device = GraphicsEnvironment.getLocalGraphicsEnvironment().getDefaultScreenDevice();
        device.setFullScreenWindow(frame);
        device.setDisplayMode(new DisplayMode(800, 600, 32, 60)); // Ugh.
        frame.setVisible(true);

        final Box panel = Box.createVerticalBox();
        JButton btn = new JButton();
        btn.setText("Button");

        panel.add(btn);
        frame.add(panel);

        final CustomFileChooser chooser = new CustomFileChooser(panel);

        btn.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {
               chooser.show();
            }
        });
    }

    public static class CustomFileChooser extends JFileChooser{
         /** Node this chooser should be added to.
          *  There's likely a better way of doing this, 
          *  but it was convenient for a quick example */
        Container parent;

        public CustomFileChooser(Container parent){
            super();
            this.parent = parent;
            //Make configurations for your file chooser
            setApproveButtonText("Open");
        }

        @Override
        public void approveSelection(){
            super.approveSelection();
            //Perform accept action here
            System.out.println(getSelectedFile().getAbsolutePath());
            parent.remove(CustomFileChooser.this);
            parent.repaint();
        }

        @Override
        public void cancelSelection(){
            super.cancelSelection();
            //Perform cancel action here
            System.out.println("Canceled");
            parent.remove(CustomFileChooser.this);
            parent.repaint();
        }

        @Override
        public void show(){
             rescanCurrentDirectory();
             parent.add(this);
             revalidate();
             repaint();
        }

        @Override
        public Dimension getMaximumSize(){
            //Not necessary - But I felt the chooser should have a maximum size
            return new Dimension(500,300);
        }
    }
} 
```

# java - 不需要的泛型参数

> ID：14044302
> 
> 赞同：5
> 
> 时间：2012-12-26T18:02:27.537
> 
> 标签：java, generics, coding-style

假设需要使用特定的泛型接口，但这种情况不需要使用泛型参数之一。

假设我需要一个[`Callable<T>`](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/Callable.html)（它必须`T`从它的`call()`方法返回一个），但是在这种情况下我不需要返回结果，我只想提交一些代码来`ExecutorService`“做某事”

该类型的最佳选择是`T`什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-26T18:07:13.680

您可以使用特殊[`Void`](http://docs.oracle.com/javase/7/docs/api/java/lang/Void.html)类型：

```
Callable<Void> callable = new Callable<Void>() {
    @Override
    public Void call() throws Exception {
        // do stuff
        return null;
    }
}; 
```

该`return`语句是退出方法所必需的。编译器接受的唯一值是`null`. 很方便！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T18:04:08.410

使用`Void`.

30char30char30char，对不起，没有太多要补充的：P

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T18:17:11.597

实际上，您也可以将 a 提交`Runnable`给`ExecutorService`没有返回类型的 。

# javascript - 避免不必要的表单提交

> ID：14044305
> 
> 赞同：1
> 
> 时间：2012-12-26T18:03:00.847
> 
> 标签：javascript, html, forms, submit

当我想使用一个按钮切换到另一个页面并使用另一个按钮关闭窗口（弹出窗口）时，我遇到了问题

无论我点击哪个按钮，表单都会提交。我能做些什么来避免这种情况（除了`</form>`在两个按钮之间切换）？

编码：

```
<form action="name.php" method="post">
                <input type="hidden" name="number" value="<?php echo $id;?>">
                <input type="hidden" name="position" value="<?php echo $pos;?>">
<button type="submit">Yes</button> <button onclick="window.close()">No</button>
</form> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-26T18:08:32.087

您可以`return false`在 onclick 的末尾添加第二个按钮：

```
<button onclick="window.close(); return false"> 
```

# php - Javascript 删除 JSON 元素

> ID：14044306
> 
> 赞同：3
> 
> 时间：2012-12-26T18:03:01.920
> 
> 标签：php, javascript, json

我在 PHP 页面中有这个 JSON 字符串：

```
{
  "elements": [{
    "type": "pie",
    "alpha": 0.3,
    "animate": [{
      "type": "fade"
    }, {
      "type": "bounce",
      "distance": 5
    }],
    "start-angle": 0,
    "tip": "#val# de #total# #percent#",
    "colours": ["#d01f3c", "#356aa0", "#C79810"],
    "values": [{
      "value": 1,
      "label": "procesador amd sempron 140"
    }, {
      "value": 1,
      "label": "procesador sempron le130"
    }, {
      "value": 1,
      "label": "procesador amd a4-3300 x2"
    }, {
      "value": 1,
      "label": "procesador intel celeron g530"
    }]
  }],
  "title": {
    "text": "Procesadores, Reinicio",
    "style": "color: #356aa0; font-size: 20px"
  },
  "bg_colour": "#FFFFFF",
  "x_axis": null
} 
```

我这样称呼它：

```
$.getJSON("restart_proce.php", function(json)
{    
console.log(json); 
```

我需要将其转换为：

```
[{\"value\": 1, \"label\": \"procesador amd sempron 140\" }, { \"value\": 1, \"label\": \"procesador sempron le130\" }, { \"value\": 1, \"label\": \"procesador amd a4-3300 x2\" }, { \"value\": 1, \"label\": \"procesador intel celeron g530\" } ] 
```

我正在尝试删除这样的元素：

```
delete json.elements[3]; 
```

但它不会删除任何东西。我怎样才能让它工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T18:05:31.860

试试这个：

```
json.elements.splice(3, 1); 
```

请参阅：[Array.splice](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/splice)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-26T18:07:36.210

**从数组中删除一个项目：**

有几种方法。**[拼接](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/splice)**方法是最通用的：

```
data.items.splice(3, 1); // Removes three items starting with the 2nd, 
```

splice 修改原始数组，并返回您删除的项目的数组。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-26T18:11:11.413

直接修改之前的值`console.log(json)`

```
json= json.elements[0].values 
```

或者在`restart_proce.php`php页面中只是回显

```
echo json_encode($data['elements'][0]['values']); // if associative array is used. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-26T18:12:39.800

试试这个：

```
var data = {"result":[
  {"FirstName":"Test1","LastName":"User","Email":"test@test.com","City":"ahmedabad","State":"sk","Country":"canada","Status":"False","iUserID":"23"},
  {"FirstName":"user","LastName":"user","Email":"u@u.com","City":"ahmedabad","State":"Gujarat","Country":"India","Status":"True","iUserID":"41"},
  {"FirstName":"Ropbert","LastName":"Jones","Email":"Robert@gmail.com","City":"NewYork","State":"gfg","Country":"fgdfgdfg","Status":"True","iUserID":"48"},
  {"FirstName":"hitesh","LastName":"prajapti","Email":"hitesh.prajapati@phptalent.com","City":"","State":"","Country":"","Status":"True","iUserID":"78"}
  ]
}
alert(data.result);
delete data.result[3];
alert(data.result); 
```

工作[JSFiddle](http://jsfiddle.net/Djc4h/)

或者您可以使用[splice](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/splice)从数组中删除元素。

# android - 在 Android 中维护会话

> ID：14044308
> 
> 赞同：0
> 
> 时间：2012-12-26T18:03:05.010
> 
> 标签：android, session, sharedpreferences

我正在开发一个应用程序，当用户输入用户名和密码时，我们会得到一个访问令牌和到期时间

```
{"Access_token":"abcdef","Expiry":"2012-12-27T05:15:27.4044337Z"} 
```

会话过期时如何将用户重定向到登录页面。

我的实际问题是如何检测到期时间是否到达，以便我可以重定向到登录页面。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T18:05:38.783

服务器应响应会话过期并重定向。通常不取决于客户。

否则保存过期时间（如果您想要一个简单的持久存储，则作为共享首选项）并为每个请求将当前时间与此时间进行比较（在发出请求之前无需检查此时间）。

# python - 表单输入中未显示字段的清理值（仅显示旧值）

> ID：14044309
> 
> 赞同：0
> 
> 时间：2012-12-26T18:03:17.507
> 
> 标签：python, django, django-forms

我有以下表格：

```
class SourceForm(forms.ModelForm):
    class Meta:
        model = Source
        widgets = {
            'category_re': forms.TextInput(),
            'thumb_re': forms.TextInput(),
            'movie_re': forms.TextInput()
        }

    def clean_url(self):
        data = self.cleaned_data['url']
        return helpers.url_fix(data) 
```

和以下观点：

```
def source_form(request, id):
    source = get_object_or_404(Source, pk=id)
    form = SourceForm(request.POST or None, instance=source)

    if form.is_valid():
        form.save()

    return render_to_response('source/form.html', {'form': form, 'source': source},
        context_instance=RequestContext(request)) 
```

我有问题。字段的清理值`url`未显示在表单中。我只看到旧的，没有修改过的值，但后来我尝试`{{ form.cleaned_data }}`在模板中添加 - 它显示了正确的值。为什么会这样？我该如何解决？

蒂亚！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T18:58:34.853

这是因为您`form`使用的是`request.POST`数据而不是`cleaned_data`. 尝试`form`在您之后重新分配您的变量`save()`：

```
def source_form(request, id):
    source = get_object_or_404(Source, pk=id)
    form = SourceForm(request.POST or None, instance=source)

    if form.is_valid():
        source = form.save()
        form = SourceForm(instance=source)

    return render_to_response('source/form.html', {'form': form, 'source': source},
        context_instance=RequestContext(request)) 
```

# ruby - 如何使用 FactoryGirl 创建没有模型的序列？

> ID：14044313
> 
> 赞同：0
> 
> 时间：2012-12-26T18:03:28.567
> 
> 标签：ruby, rspec, tdd, bdd, factory-bot

我想创建一个序列而不创建模型`Foo`：

```
let( :foo_id ){ sequence...? } 
```

以下代码有效，但创建了一个模型`Foo`。

工厂：

```
FactoryGirl.define do
  sequence :id do |i| 
    i 
  end

  factory :foo do
    id
    text { 'Text'}
  end
end 
```

在规格中：

```
let( :foo ){ create :foo )
...
# Using foo.id 
```

如何在没有模型的情况下创建数字序列？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T12:01:24.560

FactoryGirl 不支持这一点，但[Fabrication](http://www.fabricationgem.org/)支持。

看看[这个文档](http://www.fabricationgem.org/#!sequences)。

```
Fabricate.sequence
# => 0
# => 1
# => 2 
```

如果你在你的 中放置这样的语句`let`，你每次都会得到一个新的数字：

```
let( :foo ){ Fabricate.sequence(:my_id) ) 
```

# c++ - 当 const 方法是公共的并且非常量方法受到保护时，为什么 C++ 不强制转换为 const？

> ID：14044315
> 
> 赞同：13
> 
> 时间：2012-12-26T18:03:42.577
> 
> 标签：c++, constants

我创建了一个有两个 get 方法的类，一个 const 和一个非常量。const 方法是公共的，因此用户可以查询向量。非常量方法是受保护的，所以我可以用它来修改我需要的数据。

但是，当我尝试使用该类并调用 get 方法时，编译器会抱怨非常量方法受到保护。相反，我必须使用 const_cast 将对象强制转换为 const，这样我才能获得公共方法。

有没有办法解决这个问题？既然有公共方法，为什么编译器不自己进行强制转换？如果我删除受保护的版本并只保留 const 版本，它可以正常工作，因此在这种情况下它会进行强制转换。转换为 const 总是安全的。它消除了 constness 是一个问题。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-26T18:10:32.513

成员访问控制是调用成员函数时发生的最后一件事。它发生在名称查找、模板参数推导、重载解析等之后。之所以最后完成，是因为决定更改成员的访问控制不应该突然改变客户端代码的执行。

想象一下在重载解析之前检查了访问，并且您使用了一个库和该库中的某个成员函数。然后库作者将该函数设为私有。突然，您的代码开始使用不同的重载并且以完全不同的方式运行。库作者可能打算让任何使用该函数重载的人停止使用它，但他们并不打算更改每个人的代码。但是，随着标准的实际定义，您的代码现在将开始为您提供使用私有成员的错误，而不是表现不同。

解决方案是简单地更改受保护的成员函数的名称，以便不考虑它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-26T18:11:58.527

编译器在决定要调用哪个成员函数*后考虑可访问性。*也就是说，protected 和 private 函数仍然*可见*，即使它们不可*访问*。

为什么？一个原因是，如果您使重载决议忽略了不可访问的函数，您可以通过更改其可访问性来更改调用的函数。使用当前的规则，你只能导致编译代码无法编译，或者导致当前无法编译的代码，或者在不影响代码含义的情况下更改某些内容。您不能更改访问说明符并静默导致调用不同的函数。

作为一个人为的例子，这是一个非常糟糕的类接口：

```
public:
    // Returns the amount of change tendered for this transaction.
    MoneyAmount change() const;

private:
    // Account for a change of currency. Charges standard moneychanger's fee.
    MoneyAmount change(Currency toCurrency = Currency::USD); 
```

如果从重载解决方案中删除了不可访问的函数，则客户端代码可以`change()`正常调用。如果稍后`change(Currency)`公开第二个函数并删除第一个函数，该代码会突然默默地调用另一个具有完全不同目的的函数。当前规则防止访问说明符的更改改变编译程序的行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T18:07:54.100

在 C++ 中，方法选择（重载解决方案）发生在考虑公共/私有访问控制之前。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-26T18:09:43.787

使用受保护的 setter 方法（或数据成员）而不是非 const getter 方法。

如果你有 s.th 也没关系。像

```
class A {
    SomeType foo_;
protected:
    SomeType& foo() { return foo_; }

public:
    const SomeType& foo() const { return foo_; }
}; 
```

或者

```
class A {
protected:
    SomeType foo_;

public:
    const SomeType& foo() const { return foo_; }
}; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-26T19:03:47.917

这就是 C++ 的本质行为，如果调用者代码类的对象是非常量的，那么就是非转换，这被定义为受保护的。您需要将类的对象定义为 const 或对类的对象使用 const-cast，这将导致调用 const 版本的方法。

```
#include <iostream>
class Foo {
    public:
        const void bar() const { std::cout << " const version called\n";}  
    protected:
        void bar() { std::cout << " non const version called\n";}  
};

int main(int argc, char** argv)
{
    const Foo c;
    c.bar(); // -> work

    Foo c1;
    c1.bar(); // compiler complain -> void Foo::bar() is protected
    const_cast<const Foo&>(c1).bar(); // fine 
} 
```

# java - 将 Math.max 用于 BankAccount 类

> ID：14044316
> 
> 赞同：1
> 
> 时间：2012-12-26T18:03:45.573
> 
> 标签：java

我有一个家庭作业问题，我必须为银行账户中的每笔交易扣除超过分配的免费交易数量的费用。我的问题是我`Math.max`没有为`deductMonthlyCharge`班级工作，而不是仅在交易超过分配金额时才收取费用，该程序对每笔交易收取费用。我不知道如何解决这个问题。另外，我应该在每个月之后重置交易计数。我不知道该怎么做。如果有人可以将我推向正确的方向，将不胜感激，谢谢。

这是我的银行帐户代码：

```
public class BankAccount
{  
   private double balance;
   private double fee;
   private double freeTransactions;
   private double transactionCount;

   public BankAccount()
   {   
      balance = 0;
      fee = 5;
      freeTransactions = 5;
      transactionCount = 0;
   }

   public BankAccount(double initialBalance)
   {   
      balance = initialBalance;
      transactionCount = 0;
   }

   public void deposit(double amount)
   {  
      double newBalance = balance + amount;
      balance = newBalance;
      transactionCount++;
   }

   public void withdraw(double amount)
   {   
      double newBalance = balance - amount;
      balance = newBalance;
      transactionCount++;
   }

   public double getBalance()
   {   
      return balance;
   }    

   public void setTransFee(double amount)
   { 
       balance = amount+(balance-fee);
       balance = balance;
   }

   public void setNumFreeTrans(double amount) 
   {
       amount = freeTransactions;
   }

   public double deductMonthlyCharge()
   {
       double transCount = Math.max(transactionCount, freeTransactions);
       double fee = 2.00 * (transCount - freeTransactions);
       return fee;
   }
} 
```

这是我的 BankAccountTester 代码：

```
public class BankAccountTester
    {
        private BankAccount rockdown;
        public static void main(String[] args) {
            BankAccount rockdown = new BankAccount(1000.0);
            rockdown.deposit(1000);
            rockdown.withdraw(500);
            rockdown.withdraw(400);
            rockdown.deposit(200);
            System.out.println(rockdown.getBalance()- rockdown.deductMonthlyCharge());

            rockdown.deposit(1000);
            rockdown.withdraw(500);
            rockdown.withdraw(400);
            rockdown.deposit(200);
            rockdown.deposit(500);
            System.out.println(rockdown.getBalance()- rockdown.deductMonthlyCharge());

            rockdown.deposit(1000);
            rockdown.withdraw(500);
            rockdown.withdraw(400);
            rockdown.deposit(200);
            rockdown.deposit(500);
            rockdown.withdraw(1000);
            System.out.println(rockdown.getBalance()- rockdown.deductMonthlyCharge());
        }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T18:10:24.987

你从来没有`freeTransactions`在你的*非默认*构造函数中设置，所以它默认为`0`：

```
public BankAccount(double initialBalance) 
```

您可以像这样从重载的构造函数中调用默认构造函数：

```
public BankAccount(double initialBalance) {   
   super();
   balance = initialBalance;
} 
```

以便`freeTransactions = 5;`调用该语句。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-26T18:12:44.077

您的一个构造函数中缺少几行代码。

```
 public BankAccount()
   {   
      balance = 0;
      fee = 5;
      freeTransactions = 5;
      transactionCount = 0;
   }

   public BankAccount(double initialBalance)
   {   
      balance = initialBalance;
      fee = 5;
      freeTransactions = 5;
      transactionCount = 0;
   } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T18:37:54.860

我会这样写而不是尝试使用数学。

```
if (transactionCount <= freeTransactions)
   return 0;
return 2 * (transactionCount - freeTransactions); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-26T18:16:04.460

`Math.max(a,b)`是正确的并返回更大的值。您可能希望将您的方法更改为仅计算费用，如果需要计算费用，因此没有剩余的免费交易。

顺便提一句。`freeTransactions`并`fee`应通过声明或在构造中设置。

```
public double deductMonthlyCharge()
   {
       double transCount = Math.max(transactionCount, freeTransactions) - freeTransactions;
       double fee = 0;
       if (transCount > 0) fee = 2.00 * transCount;
       return fee;
   } 
```

还是我错了？

# sql - 使用查询来确定表之间的关系

> ID：14044322
> 
> 赞同：0
> 
> 时间：2012-12-26T18:04:09.833
> 
> 标签：sql, relational-database

我想知道是否有一种方法可以通过查看查询来确定表之间的父子关系。

```
select...
from table1
where
oid in (
select oid from table2
where mid = ? and  goid = ? and table1_number = ? )
union
select 0 , oid from table2 where mid=? and  goid=? and is_default=\'Y\'
) order by priority desc '; 
```

我还能弄清楚它是 1 -> many 1 -> 1 还是多对多？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T18:08:56.803

所有数据库都有一个[*目录*](http://en.wikipedia.org/wiki/Database_catalog)，它是一系列系统控制的表，用于存储元数据——*关于*数据的数据。

您还没有说您正在使用哪个数据库，并且每个数据库都有自己的方法，但是其中一个表将包含有关数据库中外键约束的数据。您可以查询该表，根据需要与其他目录表连接，以获得所需的内容。

# java - 获取日期时间 dayOfWeek/dayOfMonth 作为字符串

> ID：14044324
> 
> 赞同：5
> 
> 时间：2012-12-26T18:04:15.093
> 
> 标签：java, jodatime

如何以字符串形式获取星期几或月份？无需执行以下操作：

```
 DateTime now = DateTime.now();
        String dayOfWeek = null;
        switch(now.getDayOfWeek()) {
            case DateTimeConstants.MONDAY:
                dayOfWeek = "Monday";
                break;
            case DateTimeConstants.TUESDAY:
                dayOfWeek = "Tuesday";
                break;
            case DateTimeConstants.WEDNESDAY:
                dayOfWeek = "Wednesday";
                break;
            case DateTimeConstants.THURSDAY:
                dayOfWeek = "Thursday";
                break;
            case DateTimeConstants.FRIDAY:
                dayOfWeek = "Friday";
                break;
            case DateTimeConstants.SATURDAY:
                dayOfWeek = "Saturday";
                break;
            case DateTimeConstants.SUNDAY:
                dayOfWeek = "Sunday";
                break;
        } 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-26T18:06:09.403

好吧，显然它就像[这里](http://www.joda.org/joda-time/apidocs/org/joda/time/field/AbstractReadableInstantFieldProperty.html#getAsText%28%29)`dateTime.dayOfWeek().getAsText();`记录的那样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T18:07:56.783

您可以使用上述逻辑创建 DateTime 扩展方法，并在需要的地方使用，而无需重复整个逻辑。

# c# - 尝试恢复数据库中列的当前值时出错

> ID：14044332
> 
> 赞同：4
> 
> 时间：2012-12-26T18:04:36.220
> 
> 标签：c#, sql

我的表中有一个名为`AllowComent`. 此列具有位数据类型。

在我的 C# 代码中，我尝试恢复值

```
protected string RecoverAllowComent(string id)
{
    try
    {
        using(SqlConnection conexao = new SqlConnection(_conexao))
        {
            SqlCommand comando = new SqlCommand();
            comando.CommandText = "SELECT AllowComent FROM San_Blog WHERE Id = @Id";
            comando.Parameters.Add(new SqlParameter("@Id", id));
            comando.CommandType = CommandType.Text;
            comando.Connection = conexao;
            conexao.Open();
            comando.ExecuteNonQuery();

            SqlDataAdapter da = new SqlDataAdapter(comando);
            DataTable dt = new DataTable();
            da.Fill(dt);

            if (dt.Rows.Count > 0)
            {
                return dt.Rows[0].ItemArray[0].ToString();
            }
            else                    
                return "False";
         }
     }
     catch
     {
         return "False";
     }
} 
```

但我得到了错误 `Conversion failed when converting the nvarchar value ''1'' to data type int.`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T18:06:52.607

您正在传递`id`具有字符串类型的传递。你需要传递`int`给`parameter`id。

改变

```
comando.Parameters.Add(new SqlParameter("@Id", id)); 
```

至

```
comando.Parameters.Add(new SqlParameter("@Id", int.Parse(id))); 
```

*如果可能，您可以将 RecoverAllowComent 的参数 ID 的类型更改为 int，以摆脱将类型转换为 int 的字符串。*

# ffmpeg - 关键帧不是关键帧吗？AV_PKT_FLAG_KEY 不解码为 AV_PICTURE_TYPE_I

> ID：14044335
> 
> 赞同：6
> 
> 时间：2012-12-26T18:04:48.227
> 
> 标签：ffmpeg, libavcodec, libav, libavformat

在解码标志中包含 AV_PKT_FLAG_KEY 的数据包后，我期待得到 I 帧，但我得到了 P 帧：

致电后：

```
avcodec_decode_video2(codecCtx, frame, &frameFinished, &packet); // mpeg2 video 
```

我打印出以下内容作为健全性检查：

```
 printf("packet flags: %d picture type: %c\n", packet.flags,
            av_get_picture_type_char(frame->pict_type)); 
```

返回输出：

```
 packet flags: 1 picture type: P 
```

当我期待：

```
 packet flags: 1 picture type: I 
```

其中“1”== AV_PKT_FLAG_KEY。'I' 指的是 AV_PICTURE_TYPE_I，

这种行为正确吗？（我正在解码 MPEG2 视频）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-28T18:07:58.433

我得到了 ffmpeg bugtracker 的回复：

[https://ffmpeg.org/trac/ffmpeg/ticket/2074](https://ffmpeg.org/trac/ffmpeg/ticket/2074)

> 我怀疑您缺少编解码器延迟。您输出的视频帧通常根本不是基于您刚刚发送的数据包。对于多线程解码尤其如此，但即使没有，由于 B 帧的工作方式，通常也不可能。

而且，实际上我在 3 帧后打印出 ->pict_type “图片类型”，有一个 I 帧在几帧后弹出，并在 3 帧后出现“延迟”。就我而言，我有一台四核计算机，因此可能为我计算机上的每个内核分配了一个线程来进行编码。

# raphael - 如何允许在 raphael 对象中输入文本，比如 rect？

> ID：14044337
> 
> 赞同：2
> 
> 时间：2012-12-26T18:05:08.870
> 
> 标签：raphael

我创建了一个 Raphael 矩形，如下所示： `var rect1 = paper.rect(100,100,100,100)`

现在，我希望当我单击矩形时会出现一个光标，并且允许用户键入/键入一些文本

我对 JS 和 Raphael 非常陌生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T19:05:27.703

这不是拉斐尔的自然用途。主要将其视为绘图库。如果您查看[SVG 规范](http://en.wikipedia.org/wiki/Scalable_Vector_Graphics)或 RaphaelJS 页面上的任何[演示](http://raphaeljs.com/)，您就会明白这一点。

但 Raphael 自然地与原生 Javascript 或 jQuery 集成。我会在您的矩形顶部放置一个无边框文本区域，并在用户单击该空间时激活（并聚焦）它，如下所示：

```
var paper = Raphael("canvas", 300, 300),
    rect1 = paper.rect(100,100,100,100).attr({fill: "#FFF"});

rect1.click(function(e) {
   $('#text').show(); 
   $('#text').focus(); 
});
​ 
```

[http://jsfiddle.net/NtKKZ/](http://jsfiddle.net/NtKKZ/)

（请注意，您需要用白色填充矩形才能触发 click 事件。）

# javascript - 如何在 Chrome 扩展程序中操作新窗口？

> ID：14044338
> 
> 赞同：4
> 
> 时间：2012-12-26T18:05:12.720
> 
> 标签：javascript, google-chrome, google-chrome-extension

我正在编写一个 chrome 扩展程序，以允许用户从单个页面登录社交媒体网站。我能够创建一个新的隐身窗口，但无法操作我创建的窗口内的任何内容。我想为新窗口创建一个 onload 函数来执行 jquery。感谢您让我指出正确的方向！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-27T05:40:30.213

请参阅以下演示以操作创建的新隐身[窗口](https://developer.chrome.com/extensions/windows.html#type-Window)并将一些 jquery 注入其中。

## `References`

*   [视窗](https://developer.chrome.com/extensions/windows.html)API
*   [选项卡](https://developer.chrome.com/extensions/tabs.html)API
*   [背景页面](https://developer.chrome.com/extensions/background_pages.html)
*   [内容脚本](https://developer.chrome.com/extensions/content_scripts.html)
*   [清单文件](https://developer.chrome.com/extensions/manifest.html)。

### `manifest file`

这用于绑定权限并将后台页面注册到扩展程序。确保它具有所需的所有权限。

```
{
"name":"Hanlder for Incognito window",
"description":"http://stackoverflow.com/questions/14044338",
"version":"1",
"manifest_version":2,
"background":{
    "scripts":["background.js"]
},
"permissions":["tabs","http://www.google.co.in/"]
} 
```

### `background.js`

从后台页面将 jquery 注入新的隐身窗口。

```
var _tabId_To_Look_For;

// Create a new incognito Window with some arbitary URL and give it focus
chrome.windows.create({
    "url": "http://www.google.co.in/",
    "focused": true,
    "incognito": true
}, function (window) {
    // Trace tab id which is created with this query 
    _tabId_To_Look_For = window.tabs[0].id
});

// Add an event Listener for new tab created
chrome.tabs.onUpdated.addListener(function (tabId, changeInfo, tab) {
    // Inject script into chosen tab after it is loaded completely
    if (tabId == _tabId_To_Look_For && changeInfo.status == "complete") {
        // Inject Jquery and in current tab
        chrome.tabs.executeScript(tabId, {
            "file": "jquery.js"
        }, function () {
            // I am in call back
            console.log("Injected some jquery ");
        });
    }
}); 
```

确保您已启用隐身访问。

![在此处输入图像描述](../Images/38cd3c898b7ded4de8a94353eee8fc1f.png)

## `Output`

您将看到一个注入 jquery 的新窗口。

# vb.net - Visual Studio 2012 - 自定义先决条件未出现在“属性”>“先决条件”对话框中

> ID：14044340
> 
> 赞同：3
> 
> 时间：2012-12-26T18:05:25.617
> 
> 标签：vb.net, visual-studio, visual-studio-2012, vsto, bootstrapper

我使用 Visual Studio 创建了我的第一个 Office 加载项。它针对 4.0 .Net 框架并使用新的 VS 2012 创建。我需要在办公室周围的各种 32 位 XP 和 64 位 Windows 7 计算机上分发/安装这个项目。所以我将项目配置为安装在 XP 上（这是我的第一个减速带，因为我没有意识到 VS 2012 需要更新才能制作与 XP 兼容的解决方案）。现在我有一个有效的 win32 应用程序，我收到另一个错误：

尝试安装“C:\filepath...\Import Contacts.vsto”时发生以下错误：“没有应用程序与此操作的指定文件关联。”

经过一番挖掘，我想我需要在客户端计算机上安装 Microsoft Visual Studio Tools for Office Runtime。为此，我想使用项目的先决条件属性。因此，我阅读了使用一些值得注意的站点创建自定义先决条件（例如，[创建引导程序包](http://msdn.microsoft.com/en-us/library/ms165429.aspx)、[应用程序部署先决条件](http://msdn.microsoft.com/en-us/library/h4k032e1.aspx)、[添加自定义先决条件](http://msdn.microsoft.com/en-us/library/ms165429%28v=vs.80%29.aspx)和[在 Visual Studio 2012 中为 Office 2013 创建引导程序包](http://blogs.msdn.com/b/vsto/archive/2012/12/21/creating-a-bootstrapper-package-for-an-office-2013-vsto-add-in-with-visual-studio-2012.aspx)）。**我根据最后一个 URL 创建了文件**（即使我不确定它是否与我需要的包有关），**但它没有出现在 Project > Properties > Publish > Prerequisites 下的对话框中**

如果你阅读了这篇文章，它说一旦我重新启动 VS 2012，VS 先决条件对话框应该会自动更新，我这样做了但无济于事。我知道我将来需要再次使用这个功能，所以我真的很想知道我做错了什么并解决这个问题。请帮忙！我保证会迅速将 ACCEPT 授予帮助我解决此问题的任何人！先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-16T14:59:47.433

对于那些仍然可能面临类似问题的人，我认为我找到了这个问题的原因。似乎使用自定义引导程序包（以及其中的所有必要文件）复制文件夹不会“刷新”可用包的列表。只有当我完成此演练并在 %Programfiles%\Microsoft SDKs\Windows\v7.0A\Bootstrapper\Packages\ 中手动创建文件夹以获取此演练中的示例包时，我的包才显示

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T19:28:52.087

按照网页中给出的说明，我没有遇到任何问题，并将引导程序添加到先决条件对话框中。但是，有很多可能的方法可以弄错。一些可能性：

*   三重检查您将这些文件添加到的文件夹。确保您选择`Program Files (x86)`的是 64 位版本的 Windows 而不是`Program Files`. 并确保您现在看到添加的 VSTOR40 文件夹以及其他现有的引导程序文件夹，如 ReportViewer 和 VBPowerPacks。
*   您没有对该文件夹的写入权限，UAC 会阻止在那里复制文件。确保您设法从提升的命令提示符处复制它们。右键单击命令提示符快捷方式，然后单击“以管理员身份运行”。
*   如果您使用记事本创建了 .xml 文件，请确保您没有意外使用 .txt 扩展名保存它们。如有必要，将资源管理器置于“程序员模式”，以便查看文件扩展名。控制面板+文件夹选项，查看选项卡，取消选中“隐藏已知文件类型的扩展名”复选框。如果您现在看到 product.xml.txt，则将文件重命名为 product.xml，与 package.xml.txt 相同
*   如果您使用记事本创建了 .xml 文件，请确保以 UTF-8 编码保存文件。文件 + 另存为，编码组合框。

# javascript - 停止/暂停它并在点击时重新启动它

> ID：14044350
> 
> 赞同：0
> 
> 时间：2012-12-26T18:06:28.363
> 
> 标签：javascript, jquery, slideshow

```
$(function(){
    $('.fadein img:gt()').hide();
    setInterval(function(){
      $('.fadein :first-child').fadeOut()
         .next('img').fadeIn()
         .end().appendTo('.fadein');}, 
      6800);
}); 
```

我希望停止单击按钮并在单击同一按钮时启动它。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T18:10:06.820

尝试这个：

```
$(function(){
    $('.fadein img:gt()').hide();
    var active = true;
    setInterval(function(){
      if(active) {
        $('.fadein :first-child').fadeOut()
           .next('img').fadeIn()
           .end().appendTo('.fadein');
      }
    }, 6800);

    $('#buttonId').click(function(){ active = !active; });
}); 
```

感谢 Rikonator，这里有更好的答案：

```
$(function(){
    $('.fadein img:gt()').hide();
    var active = true;
    var interval = setInterval(intervalFunction, 6800);

    $('#buttonId').click(function(){ 
       if(!active) 
          interval = setInterval(intervalFunction, 6800)
       else
          clearInterval(interval);
    });

    function intervalFunction(){
        $('.fadein :first-child').fadeOut()
           .next('img').fadeIn()
           .end().appendTo('.fadein');
    }
}); 
```

# testing - Haskell 测试框架 (HTF) 和多个模块中的测试定义

> ID：14044356
> 
> 赞同：4
> 
> 时间：2012-12-26T18:06:55.437
> 
> 标签：testing, haskell, htf

HTF 有一个[示例项目](https://github.com/skogsbaer/HTF/tree/master/sample)，展示了如何使用测试框架。模块 MyPkg.A 定义了一些测试，MyPkg.B 定义了一些测试。是否可以编写新模块 MyPkg.C 来聚合来自模块 A 和 B 的测试（并且不定义新测试本身）？

我不想从 A 和 B （在我的测试运行程序 Main 模块中）导入测试，而是从单个 C 模块导入测试。

我这样实现 MyPkg.C

```
{-# OPTIONS_GHC -F -pgmF htfpp #-}
module MyPkg.C (htf_importedTests) where

import Test.Framework
import {-@ HTF_TESTS @-} MyPkg.A
import {-@ HTF_TESTS @-} MyPkg.B 
```

我的主要测试运行模块是这样的：

```
{-# OPTIONS_GHC -F -pgmF htfpp #-}
module Main where

import Test.Framework
import Test.Framework.BlackBoxTest
import {-@ HTF_TESTS @-} MyPkg.C

main = htfMain htf_importedTests 
```

当我尝试编译此代码时，出现错误：

```
TestMain.hs:23:5:
Not in scope: `htf_MyPkg_C_thisModulesTests'
Perhaps you meant `htf_Main_thisModulesTests' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T23:05:46.243

HTF 似乎并不直接支持这种操作模式。但是，您可以通过一些骇客来实现目标：

**A.hs**

```
{-# OPTIONS_GHC -F -pgmF htfpp #-}
module A where
import Test.Framework

funA :: Int -> Int
funA x = x + 1

test_funA = assertEqual (funA 41) 42 
```

**B.hs**

```
{-# OPTIONS_GHC -F -pgmF htfpp #-}
module B where
import Test.Framework

funB :: Int -> Int
funB x = x + 1

test_funB = assertEqual (funB 41) 42 
```

**C.hs**

```
module C where
import Test.Framework.TestManager

import A  
import B

htf_C_thisModulesTests =
   makeAnonTestSuite $ map testSuiteAsTest                  
     [ htf_A_thisModulesTests
     , htf_B_thisModulesTests
     ] 
```

**测试主.hs**：

```
{-# OPTIONS_GHC -F -pgmF htfpp #-}
module TestMain where
import Test.Framework
import {-@ HTF_TESTS @-} C

main = htfMain htf_importedTests 
```

这可行，但问题是我们必须将模块名称硬编码在`C.hs`. 我认为一个好主意是引入一个新的`delegate_`测试定义语句，允许您将测试委托给另一个`TestableHTF`，以便我们可以`htf_importedTests`作为单个测试导出。也许您可以针对该问题或不同的解决方案打开功能请求。

# ruby - 文件系统爬虫 - 迭代错误

> ID：14044357
> 
> 赞同：2
> 
> 时间：2012-12-26T18:06:59.927
> 
> 标签：ruby, regex, spreadsheet, web-crawler

我目前正在使用以下代码构建文件系统爬虫：

```
require 'find'
require 'spreadsheet'
Spreadsheet.client_encoding = 'UTF-8'

count = 0

Find.find('/Users/Anconia/crawler/') do |file|           
  if file =~ /\b.xls$/                                            # check if filename ends in desired format
    contents =  Spreadsheet.open(file).worksheets
    contents.each do |row|
      if row =~ /regex/
        puts file
        count += 1
      end
    end
  end
end

puts "#{count} files were found" 
```

我收到以下输出： `0 files were found`

正则表达式经过测试并且正确 - 我目前在另一个有效的爬虫中使用它。

的输出`row.inspect`是

`#<Spreadsheet::Excel::Worksheet:0x003ffa5d418538 @row_addresses= @default_format= @selected= @dimensions= @name=Sheet1 @workbook=#<Spreadsheet::Excel::Workbook:0x007ff4bb147140> @rows=[] @columns=[] @links={} @merged_cells=[] @protected=false @password_hash=0 @changes={} @offsets={} @reader=#<Spreadsheet::Excel::Reader:0x007ff4bb1f3b98> @ole=#<Ole::Storage::RangesIOMigrateable:0x007ff4bb126fa8> @offset=15341 @guts={} @rows[3]>`- 当然没有什么可以迭代的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T23:30:35.580

正如 Diego 提到的，我应该一直在迭代内容 - 非常感谢您的澄清！还应注意，`row`必须在任何迭代发生之前将其转换为字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T23:17:37.313

尝试这个：

```
content = Spreadsheet.open(file)
sheet = content.worksheet 0 
sheet.each do |row|
... 
```

# html - 显示两个选择框的标签

> ID：14044361
> 
> 赞同：0
> 
> 时间：2012-12-26T18:07:28.483
> 
> 标签：html, css, razor

我在我的 asp.net mvc Web 应用程序中有以下视图：-

```
@using (Html.BeginForm("CustomersDetails", "Home"))
{
    <strong>Available Customers</strong>
    <select id="SelectLeft" multiple="multiple">
    @foreach (var item2 in Model.OrderBy(a => a.ORG_NAME))
    {
        <option value = "@item2.ORG_ID" >@item2.ORG_NAME</option>
    }
    </select>      
    <input id="MoveRight" type="button" value=" Add >> " />
    <input id="MoveLeft" type="button" value=" << Remove " /> 
    <strong>Customer to be Exported</strong>
    <select id="SelectRight" name="SelectRight" multiple="multiple">           
    </select>
    <p><button type="submit" id ="nextpage">Next Page >></button></p>
} 
```

页面的布局不像我期望的那样，我面临这些问题：-

1.  两个粗体标签“Avilable customer”和“Customer to be Exported”显示在选择框旁边而不是它们上方。

2.  “添加>>”和“<<删除”按钮彼此并排显示，但我需要将它们显示在彼此上方。任何人都可以建议我可以遵循的方法以使布局更加用户友好吗？BR

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T18:12:01.370

尝试这样的事情：

```
@using (Html.BeginForm("CustomersDetails", "Home"))
{
    <text>
        <strong>Available Customers</strong>
        <br style='clear:both;' />
        <select id="SelectLeft" multiple="multiple">
        @foreach (var item2 in Model.OrderBy(a => a.ORG_NAME))
        {
            <option value = "@item2.ORG_ID" >@item2.ORG_NAME</option>
        }
        </select>      

        <input id="MoveRight" type="button" value=" Add >> " />
        <br style='clear:both;' />
        <input id="MoveLeft" type="button" value=" << Remove " /> 

        <strong>Customer to be Exported</strong>
        <br style='clear:both;' />
        <select id="SelectRight" name="SelectRight" multiple="multiple">           
        </select>
        <p>
            <button type="submit" id ="nextpage">Next Page >></button>
        </p>
    </text>
} 
```

如果您使用`float`css 属性，它们将显示在旁边。尝试使用（断线）标记`clear`中的属性清除（浮动）两侧。`br`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T18:23:05.123

当您说“但我需要将它们显示在彼此上方”时很难修复按钮，这是不可能的。使用块元素作为标题是常见的做法。`<strong>`是内联的，所以不会自然中断。如果你能解释你想要的按钮，这个 jsfiddle 可以编辑以适应。

[http://jsfiddle.net/fzp4p/1/](http://jsfiddle.net/fzp4p/1/)

（删除了 ASP.net 位，因此它可以工作，直到正确的显示工作）

```
<h2>Available Customers</h2>
<select id="SelectLeft" multiple="multiple">

</select>      
<input id="MoveRight" type="button" value=" Add &gt;&gt; " />
<input id="MoveLeft" type="button" value=" &lt;&lt; Remove " /> 
<h2>Customer to be Exported</h2>
<select id="SelectRight" name="SelectRight" multiple="multiple">           
</select>
<p><button type="submit" id ="nextpage">Next Page &gt;&gt;</button></p> 
```

​</p>

```
input[type="button"]
{
    display:block;
    clear:both;
}​ 
```

# c# - 温莎城堡的菜鸟并尝试创建我的接口的实现

> ID：14044364
> 
> 赞同：2
> 
> 时间：2012-12-26T18:07:36.197
> 
> 标签：c#, .net, castle-windsor

我创建了自己的项目，但我无法使用城堡启动我的接口的实现！我添加了我的`ControllersInstaller`,`WindsorControllerFactory`类，如下所示。我的控制器是下面的最后一段代码。请帮忙！谢谢，詹姆斯

```
public class WindsorControllerFactory : DefaultControllerFactory
{
    private readonly IKernel kernel;

    public WindsorControllerFactory(IKernel kernel)
    {
        this.kernel = kernel;
    }

    public override void ReleaseController(IController controller)
    {
        kernel.ReleaseComponent(controller);
    }

    protected override IController GetControllerInstance(RequestContext requestContext, Type controllerType)
    {
        if (controllerType == null)
        {
            throw new HttpException(404, string.Format("The controller for path '{0}' could not be found.", requestContext.HttpContext.Request.Path));
        }
        return (IController)kernel.Resolve(controllerType);
    }
}

public class ControllersInstaller : IWindsorInstaller
{
    public void Install(IWindsorContainer container, IConfigurationStore store)
    {
        container.Register(Classes.FromThisAssembly()
                        .BasedOn<IController>()
                        .LifestyleTransient());
    }
}

 public class HomeController : Controller
{
    public IMemberMapper _memberMapper;

    public HomeController()
    {
    }

    public HomeController(IMemberMapper memberMapper)
    {
        _memberMapper = memberMapper;
    }

    public ActionResult Index()
    {
        var model = _memberMapper.Map();
        return View(model);
    }
} 
```

// 全局文件

```
public class MvcApplication : System.Web.HttpApplication
{
    protected void Application_Start()
    {
        AreaRegistration.RegisterAllAreas();

        WebApiConfig.Register(GlobalConfiguration.Configuration);
        FilterConfig.RegisterGlobalFilters(GlobalFilters.Filters);
        RouteConfig.RegisterRoutes(RouteTable.Routes);
        BundleConfig.RegisterBundles(BundleTable.Bundles);
        AuthConfig.RegisterAuth();
    }

    private static IWindsorContainer container;

    private static void BootstrapContainer()
    {
        container = new WindsorContainer()
            .Install(FromAssembly.This());
        var controllerFactory = new WindsorControllerFactory(container.Kernel);
        ControllerBuilder.Current.SetControllerFactory(controllerFactory);
    }

    protected void Application_End()
    {
        container.Dispose();
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T18:36:42.563

你注册`WindsorControllerFactory`为你的现任了`ControllerFactory`吗？

这通常在 Globals.asax.cs 中完成。如果你没有这样做，看看这个例子：[https ://github.com/kkozmic/ToBeSeen/blob/master/src/ToBeSeen/Global.asax.cs](https://github.com/kkozmic/ToBeSeen/blob/master/src/ToBeSeen/Global.asax.cs)

更具体地说，查看`BootstrapContainer()`方法及其调用位置。这指示 ASP.NET MVC 尝试使用您新定义的工厂创建它可能需要的任何控制器。如果没有这一步，你只是在使用内置的控制器工厂。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T11:07:05.920

您必须在`IMemberMapper`某处注册您的服务。最好的地方是为此目的的另一个安装程序类。

# web-applications - Web 应用程序缓存错误事件

> ID：14044375
> 
> 赞同：0
> 
> 时间：2012-12-26T18:08:42.273
> 
> 标签：web-applications, iis-7.5, woff

我有一个带有应用程序缓存的 HTML5 Web 应用程序。我通过了 28 个显式缓存项，但在这一项上失败了（来自 Chrome 23.0.1271.97 m 的日志）

```
Application Cache Error event: Resource fetch failed (404) http://localhost/Toby/Kendo/styles/images/KendoUI.woff 
```

Firefox 也没有缓存（我假设是因为这个错误，但 FireBug 没有提供信息）。

我已验证 WOFF 文件是否存在。如果我从清单中注释掉这一行，那么它会在 svg 文件中失败：

```
 http://localhost/Toby/Leaflet.Locate/images/locate.svg 
```

我在 win7 机器上运行 IIS 7.5。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T18:17:33.720

知道了。

IIS 没有以下 MIME 类型：

```
AddType application/x-font-woff woff
AddType text/cache-manifest appcache
AddType image/svg+xml svg 
```

我进入 IIS 控制台并将这些添加为等效项。

顺便说一句，我应该将 appcache (offline.appcache) 输出 Chaching 值设置为什么？Rigt 现在没有了。（用户模式？内核模式？

现在，我看到缓存和内核缓存已启用。

# assembly - 带空格的 MIPS 反转字符串

> ID：14044378
> 
> 赞同：0
> 
> 时间：2012-12-26T18:09:02.693
> 
> 标签：assembly, mips

如何在输入单词的每两个字符之间添加一个空格，然后打印出来。

在我的程序中，它可以反转字符串

```
Loop:

        sub     $t2, $t2, 1     #this statement is now before the 'load address'
        la      $t0, buffer($t2)   #loading value
        lb      $a0, ($t0)
        syscall

        bnez    $t2, Loop       

        li      $v0, 10              #program done: terminating
        syscall
        jr $ra 
```

我的结果

输入字符串：`Hello`

原来的：`Hello`

反转：`olleH`

但是如何在输入单词的每两个字符之间添加一个空格

输入字符串：`Hello`

原来的：`H e l l o`

反转：`o l l e H`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T18:33:53.083

您提供的代码正在打印存储在缓冲区中的反转字符串，但反转的字符串没有存储回来。如果这是您的意图，那么您只需要在打印每个字符后打印一个空格即可。

`bnez $t2, Loop`这是通过在打印每个字符的系统调用之后（在 之前）添加这两行来完成的

```
 li $a0, ' '
  syscall 
```

# android - 无法将 Parcel 实现的类从一个活动检索到另一个活动

> ID：14044385
> 
> 赞同：-1
> 
> 时间：2012-12-26T18:09:45.273
> 
> 标签：android, android-intent, parcel, android-4.2-jelly-bean

我有一个`Weekly Result`实现 Parcel 接口的类。当我将包裹对象传递给另一个活动时，我在检索包裹对象时遇到问题。

这是我的`weeklyResult`课：

```
public class WeeklyTopicResult implements Parcelable {

public String ID;
public MultiLingual Title = new MultiLingual();
public MultiLingual Text = new MultiLingual();
public String ImageUrl;
public String PublishOn;
public Bitmap ImageSource;

public WeeklyTopicResult(Parcel in) {
    // Reads the obj value
    ReadFromParcel(in);

}

public WeeklyTopicResult() {
    // TODO Auto-generated constructor stub
}

@Override
public int describeContents() {
    // TODO Auto-generated method stub
    return 0;
}

@Override
public void writeToParcel(Parcel dest, int flags) {
    // TODO Auto-generated method stub
    Log.v("WeekData", "WriteToParcel..." + flags);
    dest.writeString(ID);
    dest.writeString(ImageUrl);
    dest.writeString(PublishOn);
    dest.writeParcelable(Title, flags);
    dest.writeParcelable(Text, flags);
    dest.writeParcelable(ImageSource, flags);

}

public void ReadFromParcel(Parcel obj) {
    Log.v("WeeklyClaas",
            "ParcelData(Parcel source): time to put back parcel data");
    ID = obj.readString();
    Title = (MultiLingual) obj.readParcelable(MultiLingual.class
            .getClassLoader());
    Text = (MultiLingual) obj.readParcelable(MultiLingual.class
            .getClassLoader());
    ImageUrl = obj.readString();
    PublishOn = obj.readString();
    ImageSource = (Bitmap) obj
            .readParcelable(Bitmap.class.getClassLoader());

}

public class WeeklyTopicResultParcelCreater implements
        Parcelable.Creator<WeeklyTopicResult> {

    @Override
    public WeeklyTopicResult createFromParcel(Parcel source) {
        // TODO Auto-generated method stub
        return new WeeklyTopicResult(source);
    }

    @Override
    public WeeklyTopicResult[] newArray(int size) {
        // TODO Auto-generated method stub
        return new WeeklyTopicResult[size];
    }
}
} 
```

这是我的`Multilinqual`课：

```
public class MultiLingual implements Parcelable {

public String ArbicValue;

public String EnglishValue;

public MultiLingual(Parcel in) {
    ReadFromParcel(in);
}

public MultiLingual() {
    // TODO Auto-generated constructor stub
}

@Override
public int describeContents() {
    // TODO Auto-generated method stub
    return 0;
}

@Override
public void writeToParcel(Parcel dest, int flags) {
    // TODO Auto-generated method stub
    dest.writeString(ArbicValue);
    dest.writeString(EnglishValue);

}

private void ReadFromParcel(Parcel Obj) {

    ArbicValue = Obj.readString();
    EnglishValue = Obj.readString();
}

public class MyMultiLingualParcelCreator implements
        Parcelable.Creator<MultiLingual> {

    @Override
    public MultiLingual createFromParcel(Parcel source) {
        // TODO Auto-generated method stub
        return new MultiLingual(source);
    }

    @Override
    public MultiLingual[] newArray(int size) {
        // TODO Auto-generated method stub
        return new MultiLingual[size];
    }

}
} 
```

这是我发送意图的对象的地方：

```
public void GoToWeeklyTopic(View v) {
    Intent intent = new Intent();
    intent.setClass(HomeActivity.this, Topic_of_the_week.class);

    Bundle b = new Bundle();
    WeeklyTopicResult w = weeks;

    // Puts the weeklyresult parcel class into bundle
    b.putParcelable("WeeklyContent", w);

    intent.putExtras(b);
    startActivity(intent);
} 
```

这是我试图接收包裹对象的活动类：

```
ImageView weekImg;
TextView title;
TextView ContentText;
WeeklyTopicResult week= new WeeklyTopicResult();

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_topic_of_the_week);

    Bundle extras = getIntent().getExtras();
            //Here I am receiving an error
    week =extras.getParcelable("WeeklyContent");

    weekImg = (ImageView) findViewById(R.id.imageView1);
    title = (TextView) findViewById(R.id.txt_MainTitle);
    ContentText = (TextView) findViewById(R.id.txt_page_content_topicweek);

    title.setText(week.Title.EnglishValue);
    ContentText.setText(week.Text.EnglishValue);
    weekImg.setImageBitmap(week.ImageSource);
    // String FullPath = RetrieveData_Preference("WeeklyTopicUrl") + Url;
    // getImage(FullPath);

} 
```

我什至尝试将对象投回，但仍然出现错误。Logcat 错误向我显示了此错误，但我已经为每周结果实现了一个创建者类

LogCat 错误：

> 致命异常：主要
> java.lang.RuntimeException：无法启动活动
> 
> ComponentInfo{com.example.laysapp/com.example.laysapp.AdminPage.Topic_of_the_week}： android.os.BadParcelableException：Parcelable 协议需要在类 com.example.laysapp.ParsingLogic.WeeklyTopicResult E/AndroidRuntime
> 上名为 CREATOR 的Parcelable.Creator 对象（
> 1231)：
> 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2180)
> 在 android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
> 在 android.app.ActivityThread.access$600(ActivityThread.java:141)
> 在android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234)
> 在 android.os.Handler.dispatchMessage(Handler.java:99)
> 在 android.os.Looper.loop(Looper.java:137) 在 android.app.ActivityThread.main(ActivityThread.java:5039) 在 java.lang.reflect.Method.invokeNative(Native Method) 在 java.lang.reflect .Method.invoke(Method.java:511) 在 com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793) 在 com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560) ) 在 dalvik.system.NativeStart.main(Native Method) 引起：android.os.BadParcelableException：Parcelable 协议需要一个 Parcelable.Creator 对象，在 android.os.Parcel 的类 com.example.laysapp.ParsingLogic.WeeklyTopicResult 上称为 CREATOR。 readParcelable(Parcel.java:2086) 在 android.os.Parcel.readValue(Parcel.java:1965) 在 android.os.Parcel.readMapInternal(Parcel.java:2226）在android.os.Bundle.unparcel（Bundle.java:223）在android.os.Bundle.getParcelable（Bundle.java:1165）在com.example.laysapp.AdminPage.Topic_of_the_week.onCreate（Topic_of_the_week.java:40 ) 在 android.app.Activity.performCreate(Activity.java:5104) 在 android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1080) 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2144) ... 11更多的callActivityOnCreate(Instrumentation.java:1080) 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2144) ... 11 更多callActivityOnCreate(Instrumentation.java:1080) 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2144) ... 11 更多

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T18:24:31.467

从文档中：

> 实现 Parcelable 接口的类还必须有一个名为 CREATOR 的静态字段，它是一个实现 Parcelable.Creator 接口的对象。

因此，将此字段添加到您的`MultiLingual`课程中：

```
public static final MyMultiLingualParcelCreator CREATOR = new MyMultiLingualParcelCreator(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T18:25:17.007

你总是必须按照你写的顺序阅读：

```
@Override
public void writeToParcel(Parcel dest, int flags) {
    // TODO Auto-generated method stub
    Log.v("WeekData", "WriteToParcel..." + flags);
    dest.writeString(ID);
    dest.writeString(ImageUrl);
    dest.writeString(PublishOn);
    dest.writeParcelable(Title, flags);
    dest.writeParcelable(Text, flags);
    dest.writeParcelable(ImageSource, flags);

}

public void ReadFromParcel(Parcel obj) {
    Log.v("WeeklyClaas",
            "ParcelData(Parcel source): time to put back parcel data");
    ID = obj.readString();
    //these were lower
    ImageUrl = obj.readString();
    PublishOn = obj.readString();
    Title = (MultiLingual) obj.readParcelable(MultiLingual.class
            .getClassLoader());
    Text = (MultiLingual) obj.readParcelable(MultiLingual.class
            .getClassLoader());
    ImageSource = (Bitmap) obj
            .readParcelable(Bitmap.class.getClassLoader());
} 
```

# c# - 使用 BindingSource 将 DataSet 链接到 DataGridView，但没有数据

> ID：14044386
> 
> 赞同：0
> 
> 时间：2012-12-26T18:09:55.610
> 
> 标签：c#, ado.net, dataset, bindingsource

这是我第一次使用 DataSets 和 BindingSources，所以请对我温柔一点。

作为更复杂的报告系统的一部分（我已将其提炼为基本的化身，但它仍然无法正确运行），我正在尝试使用有问题的 DataSet 从数据库中提取数据（即，未设置通过设计师）。这是我到目前为止的代码：

```
// pull the data set
var dsReportData = new Reports2.ReportTest2();
dsReportData.BeginInit();
dsReportData.SchemaSerializationMode = SchemaSerializationMode.IncludeSchema;

// bind tha data set
BindingSource bsReportBinding = new BindingSource();
((ISupportInitialize)bsReportBinding).BeginInit();
bsReportBinding.DataMember = dsReportData.Tables[0].TableName;
bsReportBinding.DataSource = dsReportData;
bsReportBinding.ResetBindings(true);

// test this stuff
dgvTester.DataSource = bsReportBinding;

dsReportData.EndInit();
((ISupportInitialize)bsReportBinding).EndInit(); 
```

在通过设计器设置绑定后，我基于我在 .designer.cs 文件中看到的代码。dgvTester 只是一个具有在设计器中创建的默认属性的 DataGridView。

ReportTest2 数据集只有一个 TableAdapter，是通过设计器添加的。

现在，如果我在 VS 中转到 Data -> Preview Data 并预览`ReportTest2.payments.Fill,GetData ()`对象，它返回的数据就好了，就像我在 SQL Server Management Studio 中运行用于创建 TableAdapter 的查询一样。

但是，运行实际代码会导致 DataGridView 从查询结果中获取列名，而不是实际数据。调试器显示`dsReportData.payments.Rows.Count == 0`（是的，dsReportData.Tables[0] 是付款）。

我最终打算使用 BindingSource 向 ReportViewer 提供数据，但首先要确保在调试报告之前检索数据没有问题。

希望我在这里遗漏了一些明显的东西。但愿如此...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T18:29:22.777

经过一些试验和错误后想通了。这是我缺少的部分：

```
var TableAdapter = new Reports2.ReportTest2TableAdapters.paymentsTableAdapter();
TableAdapter.Fill(dsReportData.payments); 
```

我在我引用的代码中没有看到它，因为设计者将它偷偷放入 .cs 文件而不是 .designer.cs 文件中。这使得数据出现。

# c# - DataTable 中的行总和 - 无效转换？

> ID：14044393
> 
> 赞同：1
> 
> 时间：2012-12-26T18:10:27.890
> 
> 标签：c#

1.) ***好的，所以我有从 Excel 电子表格导入的 DataTable 并已填充。我想筛选 DataTable 并对每一行求和。我必须跳过第一列和第一行，因为它们是标签。我试图到达表中的每一行并将其汇总并输出到“行总计”列。当我尝试分配“数字”变量以尝试对每个单元格求和时，我得到一个“指定的无效强制转换”价值。

示例：
Row(0) --------ItemA......ItemB.......ItemC........ ......行总计

第 (1) 栏 公司 A .....12 ....12..................10........ ......34

2.）另外，我还没有达到它 - 我试图将它输出到 DataTable 中的最后一列存在潜在问题。

注明： ***dr[dt.Columns.Count - 1] = Convert.ToInt32(sum);***

有什么想法或建议吗？

```
 DataRow dr = dt.NewRow();

            int sum = 0;
            dt.Columns.Add("Row Totals", typeof(int));

         for (int i = 0; i < dt.Columns.Count; i++)
            {
                if (dt.Columns[i].ColumnName == "Client")
                {
                    dt.Columns.Cast<DataColumn>().Skip(1);
                }
                else
                {
                    for (int j = 0; j < dt.Rows.Count - 1; j++)
                    {
                        dt.Rows.Cast<DataRow>().Skip(1);

                       int number =0;

                       number = (dt.Rows[j].Field<int>(i));

                        sum += number;

                        dr[dt.Columns.Count - 1] = Convert.ToInt32(sum);

               Console.WriteLine("Row : {0} , Column : {1} , Value : {2}", i,j, dt.Rows[i][j].ToString());
                        Console.WriteLine(sum);
                    }
                    Console.ReadLine();
                }
            } 
```

更新：12/27/12 ***** ** *** ** *** ** *** ****

所以，我正在尝试的一个解决方案是跳过我知道是文本的行和列。当它尝试过滤每个单元格并将其求和时，我仍然得到“指定的强制转换无效”。还有什么建议吗？

先感谢您。

```
 DataRow dr = dt.NewRow();

            int sum = 0;
            int number = 0;

            for (int i = 0; i < dt.Columns.Count-1; i++)
            {
                if (dt.Columns[i].ColumnName == "column1")
                {
                    dt.Columns.Cast<DataColumn>().Skip(0);

                }
                if (dt.Columns[i].ColumnName == "column2")
                {
                    dt.Columns.Cast<DataColumn>().Skip(1);
                }
                else
                {

                    for (int j = 0; j < dt.Rows.Count; j++)
                    {
                        dt.Rows.Cast<DataRow>().Skip(0);
                        dt.Rows.Cast<DataRow>().Skip(1);

                        //if (number != -1 && number != 0)
                        //{

                            number = (dt.Rows[j].Field<int>(i));
                            sum += number;
                            dr[dt.Rows.Count] = Convert.ToInt32(sum);
                        //}
                        //else
                        //{
                        //    number = 0;
                        //}

                        Console.WriteLine("Row : {0} , Column : {1} , Value : {2}", i, j, dt.Rows[i][j].ToString());
                        Console.WriteLine(sum);

                    }
                    Console.ReadLine();

                   dataGridView1.DataSource = dt;
                } 
```

*** *更新 12/27 下午 1:30 我已经刮掉了所有以前的代码，并正在尝试测试表和输出。它似乎正在工作，但现在当我将它们添加到最后一行时，我似乎无法将它们总计。我被困在代码的“其他”部分。

```
 for (int i = 0; i < dt.Columns.Count - 2; i++)
        {

            for (int j = 0; j < dt.Rows.Count - 1; j++)
            {
                string value = dt.Rows[i][j].ToString();
                int num = 0;
                bool res = int.TryParse(value, out num);
                if (res == false)
                {
                    num = 0;
                }
                else
                {
                    int sum = 0;

                    sum += num;
                    DataRow dr;
                   dr["Totals"] = sum;
                   dt.Rows.Add(dr);
                }
            }

            dataGridView1.DataSource = dt;
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T18:20:43.870

One possibility is that there is a blank value in your data table - you can't cast a null object to an integer, so the Field extension method may be failing.

# javascript - 如何通过单击同一个按钮多次更改网页背景颜色？

> ID：14044409
> 
> 赞同：0
> 
> 时间：2012-12-26T18:11:24.533
> 
> 标签：javascript, jquery

我是 JavaScript/jQuery 的绝对初学者。

我想知道是否可以通过多次单击同一个按钮来实现可以连续切换网页的多种背景颜色的效果。

这是我在网上找到的脚本：

```
<script>
  $("#change-colour").click(function(){ 
  $("body").css("background-color","red");
  });
</script> 
```

但是，使用它我只能更改一次背景颜色。我希望通过单击同一个按钮多次更改背景颜色，例如：

点击>>红色>>点击>>蓝色>>点击>>绿色>>点击>>然后返回红色

任何帮助将非常感激。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T18:13:26.010

您需要将颜色存储在某个地方，例如数组，然后只需使用递增变量来获取下一个颜色等，如下所示：

```
var colors = ['red', 'blue', 'green', 'cyan'],
    i = 0;

$("#change-colour").click(function(){ 
    $("body").css("backgroundColor", colors[i++]);
    if (i >= colors.length)
        i = 0;

});​ 
```

[**小提琴**](http://jsfiddle.net/adeneo/TZEqL/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T18:21:51.910

```
var colours = ['red', 'blue', 'green'];
var colourIndex = 0;

$('#change-colour').click(function () {
    // Get the current colour from the array
    var colour = colours[colourIndex];
    // Set the background colour
    $('body').css('background-color', colour);
    // Move the counter along to the next index
    colourIndex = colourIndex + 1;
    // If the counter is pointing past the end of
    // the array, repoint it at the beginning
    if(colourIndex >= colours.length) {
        colourIndex = 0;
    }
}); 
```

# php - 使用 mysqli 准备语句返回多维关联数组

> ID：14044412
> 
> 赞同：0
> 
> 时间：2012-12-26T18:11:37.953
> 
> 标签：php, mysql, mysqli

我正在尝试从我的 MySql 数据库中返回一个多维关联数组，其格式为

```
$array[0]['user']
$array[0]['dateCompleted']
$array[0]['etc']
$array[1]['user']
$array[1]['dateCompleted']
$array[1]['etc'] 
```

...

这是我的代码：

```
$mysqli = new mysqli(DBHOST, DBUSER, DBPASSWORD, DBDATABASE);
//Clean input
$idUser = trim($_SESSION['tmp01']);
/* create a prepared statement */
$stmt = $mysqli->prepare("SELECT user, dateCompleted, workType, workPrice FROM workDone WHERE user=? ORDER BY dateCompleted DESC");

/* bind parameters for markers */
$stmt->bind_param("i", $idUser);

$stmt->execute();

$data = $stmt->result_metadata();
$fields = array();
$row = array();
$rows = array();

$fields[0] = &$stmt;
$count = 1;

// this dynamically creates an array where each key is the name of the field. 
while ($field = mysqli_fetch_field($data)) {
    $fields[$count] = &$row[$field->name];
    $count++;
}

// this calls bind_result() to each member of this $row array  
call_user_func_array(array($stmt, 'bind_result'), $row);       //<--problem                      
while ($stmt->fetch())
    array_push($rows, $row);

$results = (count($rows) == 0) ? false : $rows;
//print_r($results);
return $results;

$stmt->close(); 
```

当我使用 SQL 语句时它可以工作`"SELECT * FROM users ...")`，但是这样做会超出我的服务器内存。相反，我使用上面的代码，但它的作用是为我拥有的每一行返回一个相同的实例。

换句话说，如果我的 MySQL 数据库中有四个不同的行，它将返回第一行四次。

附言

我的服务器没有启用 mysqlnd。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T20:23:46.920

您的方法看起来是正确的，但您似乎将不正确的参数传递给`call_user_func_array`. 试试这个：

```
$data = $stmt->result_metadata();
$fields = array();
$currentrow = array();
$results = array();

// Store references to keys in $currentrow
while ($field = mysqli_fetch_field($data)) {
  $fields[] = &$currentrow[$field->name];
}

// Bind statement to $currentrow using the array of references
call_user_func_array(array($stmt,'bind_result'), $fields);

// Iteratively refresh $currentrow array using "fetch", store values from each row in $results array
$i = 0;
while ($stmt->fetch()) {
  $results[$i] = array(); //this is supposed to be outside the foreach
  foreach($currentrow as $key => $val) {
    $results[$i][$key] = $val;
  }
  $i++;
}

return $results; 
```

# php - 使用 PHP 为时间戳添加时间？

> ID：14044414
> 
> 赞同：2
> 
> 时间：2012-12-26T18:11:48.963
> 
> 标签：php, foreach, str-replace

我有一些文件在其内容中有时间戳，但不够准确。

所以，我在想，PHP 是否可以将不固定数量的时间戳转换为准确的时间戳，同时不触及其他内容。

例如，转换这个

> 1 00:00:00,232 --> 00:00:05,665 文本 1
> 
> 2 00:00:05,966 --> 00:00:08,909 文本 2
> 
> 3 00:00:10,948 --> 00:00:14,550 文本 3
> 
> 4 00:00:23,086 --> 00:00:25,817 文本 4
> 
> 5 00:00:34,033 --> 00:00:35,847 文本 5
> 
> 6 00:01:06,237 --> 00:01:07,716 文本 6

对此

> 1 00:00:00,732 --> 00:00:06,165 文本 1
> 
> 2 00:00:06,466 --> 00:00:09,409 文本 2
> 
> 3 00:00:11,448 --> 00:00:15,050 文本 3
> 
> 4 00:00:23,586 --> 00:00:26,317 文本 4
> 
> 5 00:00:34,533 --> 00:00:36,347 文本 5
> 
> 6 00:01:06,737 --> 00:01:08,216 文本 6

因此，在这种情况下，为每个时间戳添加 0.5 秒。我知道这是可能的，但如何？

```
$amount = $_POST['amount'];
$content = $_POST['text'];
$timestamp = ?
$newtime = $timestamp.$amount
$replacetime = str_replace($timestamp,$newtime,$content);
foreach(what to put here){
$replacetime;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T19:06:02.893

看来您想将时间转移到字幕上。虽然它可以由视频播放器完成，但您仍然可以在 PHP 中完成。

首先读取文件。

```
$c = file_get_contents("...file.srt"); 
```

提取内容

```
preg_match_all("|(\d+)[\r\n]+([\d,:]+) --> ([\d,:]+)[\r\n]+(.*)|", $c, $m); 
```

现在`0.5`为每个时间添加秒

```
$len = count($m[1]);
for($i=0;$i<$len; $i++){
    list($st, $sm)=explode(",", $m[2][$i]); // start time and milisecond
    // add 0.5 sec
    $sm+=500;
    if($sm>1000){
        $di = new DateInterval("P0000-00-00T$st");
        $di->add("P1S");
        $sm = $sm%1000;
        $st = $di->format("%H:%i:%s");
    }
    // store it back
    $m[2][$i] = "$st,$sm";
} 
```

同样的方式你必须为结束时间做。您也可以在同一个循环中执行此操作。

之后将其放回原始文件。先尝试其他文件进行测试

```
for($i=0;$i<$len; $i++){
    fprintf($fh, "$m[1][$i]\n");
    fprintf($fh, "$m[2][$i] --> $m[3][$i]\n");
    fprintf($fh, "$m[3][$i]\n\n");
} 
```

# ember.js - 用于数组绑定的 Ember js

> ID：14044418
> 
> 赞同：0
> 
> 时间：2012-12-26T18:12:06.283
> 
> 标签：ember.js

我正在开发一个应用程序，我通过外部 api 获取所有类别。

所以现在我需要获取每个类别的所有子类别。

我有控制器

```
 CategoriesController = Ember.ArrayController.extend

   #return all categories hits an api/categories
   categories: (->

     App.Category.find()

   ).property() 
```

所以现在我需要获取每个类别的所有子类别。

基本上，我们从每个类别的外部 api 获取子类别。

所以结构是

```
 {"subcategories": [id: "1", name:"ss".. } 
```

为此，我创建了另一种方法来获取每个类别的子类别。

```
 subcategories: ( ->

    @get('categories').forEach (category) =>

     ##Get subcategories from external api

     subcategories = App.Subcategory.find(category.id)

     ##making an array of objects

     result = Ember.A()

     result.pushObject({ 

        category: categorys

       subcategories: subcategories
     )}

  ).property('@categories','@each') 
```

所以当我检查子类别时，它总是空白的。它有什么问题？

谢谢

# ruby - 新遗物与歌利亚的整合

> ID：14044419
> 
> 赞同：2
> 
> 时间：2012-12-26T18:12:12.353
> 
> 标签：ruby, ruby-on-rails-3, newrelic, goliath

我已经用 goliath 配置了 New Relic，如此[处所述](https://github.com/adamlwatson/goliath/tree/master/examples/newrelic_stats)

我正在使用`gem 'newrelic_rpm'`，但没有获得 newrelic 服务的统计信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T18:34:17.097

我们必须在应用程序的开头添加手动启动

```
NewRelic::Agent.manual_start({:env => Goliath.env.to_s})
class NewrelicStatsExample < Goliath::API
  # Stuff ... 
```

手动启动中有一个错误，刚刚用最新的 gem 修复。

还要确保针对您在`newrelic.yml`文件中测试的环境将 monitor_mode 设置为 true：

```
production:
  <<: *default_settings
  app_name: New Relic Example App (Production)
  monitor_mode: true 
```

# iphone - XMLParser iPhone SDK

> ID：14044424
> 
> 赞同：0
> 
> 时间：2012-12-26T18:12:32.260
> 
> 标签：iphone, objective-c, ios, nsxmlparser

我正在创建一个需要读取[XML 文件的 iPhone 应用程序](http://feeds.feedburner.com/Pebkacfr?format=xml.xml)

## 特性

```
@property (nonatomic, strong) NSString *name;
@property (nonatomic, strong) NSString *fileName;
@property (nonatomic, strong) NSString *description;
@property (nonatomic, strong) NSString *date;
@property (nonatomic, strong) NSString *link; 
```

* * *

## 搜索标签（此处仅用于“标题”）

```
-(void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName attributes:(NSDictionary *)attributeDict{

    // FIRST TAG XML
    if([elementName isEqualToString:@"title"]){
        // GET DATA FROM XML 
        getData = YES; // getData is a bool which is NO initialy
        NSLog(@"Found");
    }
    else
        NSLog(@"Not Found");

} 
```

* * *

## 获取数据

```
-(void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string{

    if(getData)
    {
        // CREATION DE L OBJET DEPUIS LE XML
        NSLog(@"This is your desired data = %@",string);
        NSLog(@"Object creation ...");
        Pebkac *peb = [[Pebkac alloc] init];
        NSLog(@"Setup the name ...");
        [peb setName:@"Pebkac"];
        NSLog(@"Small descrption ...");
        [peb setDescription:string];
        [pebkacs addObject:peb];
    }
} 
```

* * *

## 结束标签

```
-(void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName{

    // XML END TAG
    if ([elementName isEqualToString:@"title"]){
        getData = NO;
    }
} 
```

* * *

我观察到的错误是，有时它无法获取标签之间的所有文本。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-26T18:24:07.890

`foundChars`可以调用N次。您总是将字符串设置为您到达那里的字符。你必须一次又一次地附加字符，当你`endTag`接到电话时，你必须设置结果。

```
-(void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string{
    if(!foundChars)
        foundChars = [[NSMutableString alloc] init];
    [foundChars appendString:string];
} 
```

然后在最后使用它 -**编写示例以适合您的问题**

```
-(void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName {
    if(getData)
    {
        // CREATION DE L OBJET DEPUIS LE XML
        NSLog(@"This is your desired data = %@",string);
        NSLog(@"Object creation ...");
        Pebkac *peb = [[Pebkac alloc] init];
        NSLog(@"Setup the name ...");
        [peb setName:@"Pebkac"];
        NSLog(@"Small descrption ...");
        [peb setDescription:foundChars];
        [pebkacs addObject:peb];
    }

    //reset
    foundChars = nil;

    // XML END TAG
    if ([elementName isEqualToString:@"title"]){
        getData = NO;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T18:23:22.387

## 方法

```
-(void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string 
```

每个元素可以被多次调用。每次调用此方法时，您需要将`string`每个标签附加在一起，然后将其设置在对象上：

```
-(void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName{ 
```

参考此[问题/答案](https://stackoverflow.com/questions/4705588/nsxmlparser-example)以获取有关如何正确完成使用的简明示例`NSXMLParser`

# delphi - 如何在执行 Anydac Query 时保持程序响应？

> ID：14044428
> 
> 赞同：2
> 
> 时间：2012-12-26T18:12:51.093
> 
> 标签：delphi, delphi-xe2, anydac

使用[sdac](http://www.devart.com/sdac/)，我可以让程序响应用户输入：

```
while Query.Executing do
begin
  Application.ProcessMessages;
  Sleep(1);
end; 
```

如何使用[anydac](http://www.da-soft.com/anydac/)查询实现相同的代码（没有类似的功能）？

我正在使用 delphi xe2 和 anydac v6。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-28T14:41:46.640

AnyDAC 支持不同的执行模式。要检查当前操作状态，请使用`ADQuery1.Command.State`. 这是伪代码（我这里没有 Delphi）：

```
ADQuery1.ResourceOptions.CmdExecMode := amAsync;
ADQuery1.Open;
while ADQuery1.Command.State = csExecuting do
begin
    // This is NOT RECOMMENDED
    Application.ProcessMessages;
    Sleep(1);
end; 
```

但是，由于您在`while`块中所做的唯一事情是处理 GUI 消息，我认为您最好的选择是使用`amNonBlocking`模式，它将等待查询完成（从而避免`while`块）但不会阻止 GUI（它确实忽略键盘和鼠标事件，想。）

```
ADQuery1.ResourceOptions.CmdExecMode := amNonBlocking;
ADQuery1.Open; 
```

有关详细信息，请参阅开发人员网站中的文档：[异步执行](http://www.da-soft.com/anydac/docu/frames.html?frmname=topic&frmfile=Asynchronous_Execution.html)。

# spring-mvc - Spring MVC - 控制器方法没有被调用

> ID：14044429
> 
> 赞同：4
> 
> 时间：2012-12-26T18:13:06.990
> 
> 标签：spring-mvc, configuration, controller

Spring3 MVC - 控制器类被调用，但不是控制器方法。

**控制器：**

```
package com.quizat.controller;

@Controller
public class QuizatController {
    public QuizatController(){
        System.out.println("in controller");
    }
    @RequestMapping("/")    
    @ResponseBody
    public String home(Model model) throws Exception {
        System.out.println("home is running");
        return "success";
    }
} 
```

**我的 web.xml**

```
<display-name>Spring3Example</display-name>
<servlet>
<servlet-name>dispatcher</servlet-name>
<servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
  <init-param>
  <param-name>contextConfigLocation</param-name>
  <param-value>/WEB-INF/dispatcher-servlet.xml</param-value>
  </init-param>
<load-on-startup>1</load-on-startup>
</servlet>
<servlet-mapping>
<servlet-name>dispatcher</servlet-name>
<url-pattern>/*</url-pattern>
</servlet-mapping>
</web-app> 
```

**我的调度程序-servlet.xml**

```
<mvc:annotation-driven />
<context:annotation-config />
<context:component-scan base-package="com.quizat" />
<bean id="viewResolver"
class="org.springframework.web.servlet.view.InternalResourceViewResolver">
<property name="viewClass">
  <value>org.springframework.web.servlet.view.JstlView</value>
  </property>
<property name="prefix">
<value>/view/</value>
</property>
<property name="suffix">
<value>.jsp</value>
</property>
</bean> 
```

我的控制器的构造函数运行。但是我在 Controller 中的方法没有被调用。我犯了什么错误？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T18:19:45.873

您正在将**/**映射到控制器的方法。相反，您应该映射**/home**或**/***之类的字符串。

```
@RequestMapping("/home") 
@ResponseBody
public String home(Model model) throws Exception {
} 
```

同样在控制器中，您可以使用`@RequestMapping(value = "/*")`该`home()`方法。

[注意：由于SPR-7064](https://jira.springsource.org/browse/SPR-7064)，您还应该使用 Spring >= v3.0.3

参考：[如何将 Spring MVC 控制器映射到带有和不带有斜杠的 uri？](https://stackoverflow.com/questions/12043618/how-do-i-map-spring-mvc-controller-to-a-uri-with-and-without-trailing-slash)

# mysql - MYSQL：为后续连接保存查询结果

> ID：14044436
> 
> 赞同：1
> 
> 时间：2012-12-26T18:13:43.040
> 
> 标签：mysql, join

我正在为我的大学开发一个应用程序，用户将能够定义一个过滤器并查看符合过滤条件的学生的帖子。

最初，MYSQL 将查询`user_id`所有符合过滤参数（年份、专业等）的学生。然后它将使用此结果查询并找到`user_id`通过 JOIN 链接到这些的相应帖子/事件。

问题：

由于相同`user_id`的 's 多次用于单独的 JOIN 查询（​​事件、帖子等），我想知道是否可以将结果内部存储在 mysql 中以加快使用数据的后续 JOIN 查询。

被拒绝的解决方案：

1.  使用 MySQL 查询缓存 - 不适用，因为每次查询都不相同；初始连接序列是相同的，但随后将不同的连接参数应用于每个查询。
2.  将数据拉入 API (php)，然后使用 long 发送查询`where user_id = IN(#, #, #...)`。可能有 10,000 个用户 ID 要发送回 MYSQL。查询会很大，它会抵消 JOIN 的节省。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T18:18:25.343

不要解决不存在的性能问题。也就是说，首先尝试各种查询。如果它们满足应用程序的性能标准，请继续执行其他操作。用户对更多功能和更高稳定性更感兴趣，而不是从内部循环中挤出微秒。

也就是说，正常进程是一个临时表。但是，如果您的连接被正确索引并且结果集很小（也就是说，您没有进行全表扫描），那么性能提升可能可以忽略不计。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T18:35:25.717

`create or replace view database.foo_query_view as select id from students where [match-criteria]`. 请注意，[视图是只读的](http://dev.mysql.com/doc/refman/5.5/en/create-view.html)。但是，鉴于您似乎只想做选择，应该没问题。

# php - 结束一个没有 die() 或 exit() 的 php 标签

> ID：14044438
> 
> 赞同：6
> 
> 时间：2012-12-26T18:13:46.773
> 
> 标签：php, function, tags

我想知道 PHP 是否具有允许我在进程到达“？>”标记之前结束进程的功能，例如：

```
<?php

    echo 'first';

    endphptag();

    echo 'second';

?>

third

<?php

    echo 'fourth';

?> 
```

那么输出应该是：

```
first

third

fourth 
```

我知道有些人认为这是无用的，但我想为 iframe 上的验证脚本而不是使用`die`or`exit`函数，因为它会杀死整个脚本，我只想结束它的一部分。

通常我使用它`if - else`，但我想避免它们，因为进程很大，我想要一些更具可读性的东西，顺便说一下我`if - die`在我的 ajax 脚本中使用的方式，我也想在我的 iframe 中使用类似的东西，谢谢！

* * *

好吧，我只是想知道 PHP 是否已经有一个合适的函数（似乎没有），所以我想我会把它留给 if - elses，因为真的不值得使用更多的过程来让它“更具可读性” "（例如：try - catches 占用了太多资源，我也不打算去）。我的怀疑只是为了这个，我只会使用 die 函数在我的 ajax 文件中使用这个过程（我不知道是否推荐，但我认为没有问题，因为 PHP 出于某种原因应该有它）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T18:17:09.227

例外是您正在寻找的：

```
try {
    // code
} catch (Exception $e) {
    // handling
} 
```

您将代码放在 try 块中，并以 结束它并抛出异常`throw new Exception();`，并且它仅退出 try 块中的其余代码。

您的代码将是：

```
<?php
    try {
        echo 'first';
        throw new Exception();
        echo 'second';
    } catch (Exception $e) {}
?>
third
<?php
    echo 'fourth';
?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-26T18:22:26.573

我要把它扔在那里然后躲避，但如果你真的需要这样做，那么`goto`实际上不是一个糟糕的选择：

```
<?php

    echo 'first';

    goto endofblock;

    echo 'second';

endofblock:

?> 
```

或者，您可以使用人造循环避免 goto 的“邪恶”。对编译器来说，它们看起来基本相同，但其他程序员不会因为使用而将你打死`goto`

```
<?php
do {
    echo 'first';

    break;

    echo 'second';
} while (false)        
?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-26T18:17:04.277

为什么不使用开关和外壳？

*   [http://php.net/manual/en/control-structures.switch.php](http://php.net/manual/en/control-structures.switch.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-26T18:41:20.270

PHP 解释器将文件作为一个单元工作，`<?php`标签只是指定要忽略的文本部分（标签外），就像注释一样。该标记不与代码的任何部分接壤。因此，就您而言，我认为该`goto`声明可能是正确的选择。或者，如果您可以将代码放入 中`function`，则可以使用`return`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-26T18:33:18.663

如果我是你，我会省略 end-php 标记。大多数编码标准都建议不要这样做，原因在这里无法解释。

但除此之外，继续使用 if/else 或 switch/case 控制结构。如果您使用 OOP，则从内联代码中取出大部分验证过程并将它们打包到函数或类方法中。

另请参阅有关 GOTO 的注释；-) [http://xkcd.com/292/](http://xkcd.com/292/)

# jquery - 如何在 jquery 中获取对象属性的值？

> ID：14044439
> 
> 赞同：1
> 
> 时间：2012-12-26T18:14:00.187
> 
> 标签：jquery, object

我的页面上有一组对象。我想得到第一个，所以我这样做：

```
var tmpLi = li.first();
console.dir(tmpLi); 
```

这很好用；它在萤火虫中返回：

![在此处输入图像描述](../Images/796e9858052eb32bd540c621d8a3e4c0.png)

我需要返回 outerHTML 元素的值，但似乎无法弄清楚如何获取它。我试过了：

```
var tmpLi = li.first().data("outerHTML"); 
```

和

```
var tmpLi = li.first().attr("outerHTML"); 
```

两者都返回“未定义”。帮助？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T18:15:45.947

您需要`DOM`对象`outerHTML`而不是 jQuery 对象`convert`，以便 DOM 对象访问 outerHTML 属性。

**[现场演示](http://jsfiddle.net/TtNkK/)**

```
var tmpLi = li.first()[0].outerHTML; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T18:16:42.383

它返回一个对象，因此您必须像下面这样访问它。
`li.first()[0].outerHTML`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-26T18:17:19.673

您要么需要使用获取底层对象属性值的[`prop`方法](http://api.jquery.com/prop)：

```
li.first().prop('outerHTML'); 
```

...或从 jQuery 选择中解开 DOM 对象：

```
li[0].outerHTML 
```

# ios - 使用 NSNotifications 从 TableViewController 导航回 UIViewController

> ID：14044441
> 
> 赞同：0
> 
> 时间：2012-12-26T18:14:03.243
> 
> 标签：ios, exception, uiscrollview, delegates, uinavigationcontroller

我有一个这样的例外：

```
Thread 1: EXC_Breakpoint (code = EXC_I386_BPT,subcode=0x0) 
```

在我的故事板中，我有 3 个控制器。导航控制器、UIViewController 和 tableviewcontroller。当应用程序首次启动时，会显示 UIViewController。我在 Core Data DB 中添加了一些东西。然后在这个控制器本身上我有一个“检查记录”栏按钮。我单击它并移动到第三个控制器 tableviewcontroller。在这里我可以看到我那天添加的记录。我单击刚刚添加的那个，然后使用 NSNotifications 回到 UIviewcontroller 屏幕，如下所示：

```
//This code is in tableviewcontroller.didSelectRowAtIndexPath

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
ITMAppDelegate *appDelegate = [[UIApplication sharedApplication] delegate];
    appDelegate.salesOrderObject = [self.salesOrdersArray objectAtIndex:indexPath.row];

    NSNotification *notification =[NSNotification notificationWithName:@"reloadRequest"
                                                                object:self];
    [[NSNotificationCenter defaultCenter] postNotification : notification];

    [self.navigationController popViewControllerAnimated:YES];
} 
```

在我的 ViewController viewDidLoad 中，我编写了这段代码来收听通知。

```
[[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(newReloadData)
                                             name:@"reloadRequest"
                                           object:nil];

-(void)newReloadData
{
self.salesOrder =  self.appDelegate.salesOrderObject; //self.reloadedSOObject; //appDelegate.salesOrderObject;

if(self.salesOrder !=nil)
{
//I add UItextviews,textfields,buttons etc here to a scrollview.
ITMCustomView *cView = [[ITMCustomView alloc] initWithFrame:CGRectMake(187, 660, 400, 400)
                                                     andOrderedItem:@"New"
                                                             andTag:self.tagNumber
                                                      withFoldArray:self.foldTypeArray
                                                      withRollArray:self.rollTypeArray];

        cView.tag =self.tagNumber;
        NSLog(@"Assigned tag is %d",cView.tag);

        cView.delegate = self;

        //[self.scrollView addSubview:customView];

        //self.scrollView.contentSize = CGRectMake(187, 660, 400, 400).size;

        CGPoint scrollPoint = CGPointMake(0.0, (cView.frame.origin.y/500)*400);
        [self.scrollView setContentOffset:scrollPoint animated:YES];

        [self.scrollView addSubview:cView];

        CGFloat scrollViewHeight = 0.0f;
        for (UIView *view in self.scrollView.subviews)
        {
            scrollViewHeight += view.frame.size.height;
        }

        CGSize newSize = CGSizeMake(320,scrollViewHeight);
        //CGRect newFrame = (CGRect){CGPointZero,newSize};
        [self.scrollView setContentSize:newSize];
        NSLog(@"750 the tag number is %d",self.tagNumber);
        NSLog(@"the scroll view height is %f",scrollViewHeight);
        self.currentCGRectLocation = cView.frame;
}
} 
```

我在想如果在向滚动视图中添加一些东西时发生异常。或者在堆栈溢出时查看更多可能是因为委托或 NSnotification。我无法弄清楚异常发生的原因和位置。编写这行代码是否会给我这个异常？

```
[self.navigationController popViewControllerAnimated:YES]; 
```

这个问题是这个问题的扩展 [将Customview添加到UIScrollview会导致滚动时卡屏](https://stackoverflow.com/questions/13999786/adding-customview-to-uiscrollview-results-in-stuck-screen-when-scrolling)

我不知道它在哪里/如何得到这个异常。如果您需要更多信息，请询问。谢谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T19:17:40.473

一件事可能是当你打电话`newReloadData` 通知通知中心时，哪个类有`@"reloadRequest"`字符串 `newReloadData`方法应该运行它，所以你需要先弹出视图然后调用通知

只需尝试更改线路顺序先调用`[self.navigationController popViewControllerAnimated:YES];`然后调用`[[NSNotificationCenter defaultCenter] postNotification : notification];`

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
ITMAppDelegate *appDelegate = [[UIApplication sharedApplication] delegate];
    appDelegate.salesOrderObject = [self.salesOrdersArray objectAtIndex:indexPath.row];

    NSNotification *notification =[NSNotification notificationWithName:@"reloadRequest"
                                                                object:self];
    //here first pop view
    [self.navigationController popViewControllerAnimated:YES];

    //then send notification before scopes end
    [[NSNotificationCenter defaultCenter] postNotification : notification];

} 
```

# ubuntu - 以 root 身份运行 Meteor.js

> ID：14044444
> 
> 赞同：0
> 
> 时间：2012-12-26T18:14:05.317
> 
> 标签：ubuntu, permissions, root, meteor

我想以 root 身份运行 Meteor.js 的原因只是我需要在 root 拥有的目录中正确执行 Meteor 的 mongod 进程。

我在 VirtualBox 中有 ubuntu 服务器 VM，它与主机有一个共享文件夹。我的 Meteor.js 应用程序位于此文件夹中。共享文件夹中文件的所有者是 root。

当我通过用户或 root (sudo) 运行流星时，mongod 进程声称一个错误。错误来自错误的执行权限。

这就是为什么我需要以 root 身份执行 Meteor.js。

> ***须藤流星***不起作用

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T20:23:16.430

我不确定，但根据您的描述，您可能遇到了 Mongo 与 NFS 共享文件夹有关的问题。[有关详细信息和解决方法，请参阅此问题](https://stackoverflow.com/questions/13676868/issues-with-meteor-app-on-vagrant-share)

# ruby-on-rails - Rails 在渲染时过滤 JSON 对象？

> ID：14044449
> 
> 赞同：0
> 
> 时间：2012-12-26T18:14:59.190
> 
> 标签：ruby-on-rails, json, parsing, filter

我有一个 JSON 字符串，我使用：

```
objJson = JSON.parse(jsonString)

respond_to do |format|
  format.html { render :json => objJson.to_json(:include =>  [:ID, :Name]) }
end 
```

问题是`to_json`它只适用于模型，所以它只是忽略了我的过滤器。

这是我的 JSON：

```
{
 "count":29,
 "results":
 [
   {"ID":556036109,"Name":"Mojos", "Url":"https://mojos/id300751949","currency":"USD"},
   {"ID":556036110,"Name":"Asav", "Url":"https://asav/id300751949","currency":"USD"}
 ]
} 
```

有没有办法在渲染时过滤 JSON 对象？

* * *

## 更新：

我使用*了 ssorallen*代码：

```
KEYS_TO_KEEP = ['ID', 'Name']
objJson = JSON.parse(jsonString)

respond_to do |format|
  format.html {render :json => objJson['results'].keep_if {|k, v| KEYS_TO_KEEP.include?(k)}}
end 
```

问题是 objJson['results'] 返回一个 Array 到 Hashes 而不是一个 Hash。

所以正确的做法是：

```
objJson = objJson['results'].each { |x| x.keep_if {|k, v| KEYS_TO_KEEP.include?(k)} } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T18:25:28.017

您可以在 Ruby 哈希上使用其中一种方法，例如[`keep_if`](http://www.ruby-doc.org/core-1.9.3/Hash.html#method-i-keep_if)：

```
KEYS_TO_KEEP = ['ID', 'Name']
objJson['results'] =
  objJson['results'].keep_if {|k, v| KEYS_TO_KEEP.include?(k)}

format.html {render :json => objJson} 
```

# spring - 初学者春季：如何处理网址

> ID：14044450
> 
> 赞同：2
> 
> 时间：2012-12-26T18:15:11.997
> 
> 标签：spring

所以基本上我已经制作了一个具有以下 url 的 webapp `www.foo.com/foo`（当在本地部署时，我的应用程序具有以下 url `localhost:8080/foo/`）。但是，我想`www.foo.com`改用。我该怎么做呢？谢谢！我有一个 apache2 web 服务器和 tomcat 7。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T18:23:55.157

这与 Spring、Apache 或 Tomcat 无关。这都是关于[名称解析](http://en.wikipedia.org/wiki/Domain_Name_System)的，它是由操作系统中的较低级别的东西完成的。您可以通过修改主机文件中的 localhost 行来强制 www.foo.com 解析到您的本地计算机，使其看起来像：

```
127.0.0.1 localhost www.foo.com 
```

在 Linux 上，这是在`/etc/hosts`. 在 Windows 上，您可以在以下位置找到它`C:\Windows\System32\drivers\etc\hosts`（感谢 @JBNizet 提供此内容）。但是请注意，如果您这样做，您将无法再访问*真正的*www.foo.com，因为它总是会解析到您的本地计算机。

如果您尝试这样做是因为您的应用程序内部引用了“www.foo.com”并且需要正确解析才能正常工作，那么您尝试以错误的方式解决该问题。您应该将这些值提取到某种外部配置中，以便可以将它们适当地设置为应用程序运行的环境。

**更新：**如果这只是关于部署到 tomcat 的根上下文，那么已经多次回答了，例如[Tomcat 6: How to change the ROOT application](https://stackoverflow.com/questions/715506/tomcat-6-how-to-change-the-root-application)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T18:26:08.533

```
ProxyPass        / http://www.abc.com:8080/myApp/
ProxyPassReverse / http://www.abc.com:8080/myApp/ 
```

或与

```
<VirtualHost X.X.X.X:80>
   ServerName tomcatpage.yourdomain.com
   ServerAlias tomcatpage.yourdomain.com
   Redirect permanent / http://tomcatpage.yourdomain.com:8080/
</VirtualHost> 
```

阅读有关[mod_proxy](http://httpd.apache.org/docs/2.2/mod/mod_proxy.html)的更多信息。

# android - 将高分记录插入 SQLite 数据库，nullpointer - Android (java)

> ID：14044451
> 
> 赞同：0
> 
> 时间：2012-12-26T18:15:13.607
> 
> 标签：android, database, sqlite, sqliteopenhelper

我已经修剪了代码以尝试仅包含所需的片段。我正在制作一个琐事游戏，当游戏完成时，Results.java 会显示当前游戏的统计数据，并将完成的游戏发送到高分（SQLite 数据库）。当调用 Results.java 类时，它会给出一个空指针异常（我在 NP 结果的位置进行了评论）。

这是我第一次尝试在我的项目中创建和实施 SQLite 数据库。非常感谢任何其他关于代码结构或我的数据库代码看起来有问题的其他建议！

数据库助手.java

```
public class DatabaseHelper extends SQLiteOpenHelper { 

    //variables

    public DatabaseHelper(Context context) { 
        super(context, DB_NAME, null, DATABASE_VERSION); 
        myDB = getWritableDatabase();
    }

    public void createDatabase() throws IOException {
        boolean dbExist = checkDatabase();
        if(dbExist) {
            //Do nothing - DB already exists.
        } else {
            myDB.execSQL("CREATE TABLE " + TABLE + " ("
                            + RANK + " INTEGER,"
                            + SCORE + " LONG,"
                            + PERCENTAGE + " INTEGER"
                            + ");");
        }
    }

    //Insert new record.
    public long insert(int rank, long score, int percentage) {
        ContentValues values = new ContentValues();
        values.put(RANK, rank);
        values.put(SCORE, score);
        values.put(PERCENTAGE, percentage);

        return myDB.insert(DB_NAME, null, values);  //Line 56
    }

                //other methods...

    public void onCreate(SQLiteDatabase db) {}
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {}
} 
```

结果.java

```
public class Results extends Activity {

    DatabaseHelper dh;

    int rank;
    long score;

    @Override
    public void onCreate(Bundle savedInstanceState) {

                    //...
                    dh = new DatabaseHelper(this);
                    score = getIntent().getLongExtra("score", -1);

                    //...
    }

    public void showResults() {

        //...

        percentage = 10 * cAnswers;

                          //...

        dh.insert(1, score, percentage);  //Line 100
    }

    public void restart() {
        //...
    }
} 
```

编辑： NullPointer 错误消失了，但正在显示一个新的 LogCat 输出，可以在下面找到。

LogCat 输出

```
12-18 19:47:48.280: E/SQLiteLog(1527): (1) no such table: highscoresDatabase
12-18 19:47:48.370: E/SQLiteDatabase(1527): Error inserting percentageX=30 scoreX=827 rankX=1
12-18 19:47:48.370: E/SQLiteDatabase(1527): android.database.sqlite.SQLiteException: no such table: highscoresDatabase (code 1): , while compiling: INSERT INTO highscoresDatabase(percentageX,scoreX,rankX) VALUES (?,?,?)
12-18 19:47:48.370: E/SQLiteDatabase(1527):     at android.database.sqlite.SQLiteConnection.nativePrepareStatement(Native Method)
12-18 19:47:48.370: E/SQLiteDatabase(1527):     at android.database.sqlite.SQLiteConnection.acquirePreparedStatement(SQLiteConnection.java:882)
12-18 19:47:48.370: E/SQLiteDatabase(1527):     at android.database.sqlite.SQLiteConnection.prepare(SQLiteConnection.java:493)
12-18 19:47:48.370: E/SQLiteDatabase(1527):     at android.database.sqlite.SQLiteSession.prepare(SQLiteSession.java:588)
12-18 19:47:48.370: E/SQLiteDatabase(1527):     at android.database.sqlite.SQLiteProgram.<init>(SQLiteProgram.java:58)
12-18 19:47:48.370: E/SQLiteDatabase(1527):     at android.database.sqlite.SQLiteStatement.<init>(SQLiteStatement.java:31)
12-18 19:47:48.370: E/SQLiteDatabase(1527):     at android.database.sqlite.SQLiteDatabase.insertWithOnConflict(SQLiteDatabase.java:1467)
12-18 19:47:48.370: E/SQLiteDatabase(1527):     at android.database.sqlite.SQLiteDatabase.insert(SQLiteDatabase.java:1339)
12-18 19:47:48.370: E/SQLiteDatabase(1527):     at com.example.test.DatabaseHelper.insert(DatabaseHelper.java:56)
12-18 19:47:48.370: E/SQLiteDatabase(1527):     at com.example.test.Results.showResults(Results.java:100)
12-18 19:47:48.370: E/SQLiteDatabase(1527):     at com.example.test.Results.onCreate(Results.java:50)
12-18 19:47:48.370: E/SQLiteDatabase(1527):     at android.app.Activity.performCreate(Activity.java:5008)
12-18 19:47:48.370: E/SQLiteDatabase(1527):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1079)
12-18 19:47:48.370: E/SQLiteDatabase(1527):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2023)
12-18 19:47:48.370: E/SQLiteDatabase(1527):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2084)
12-18 19:47:48.370: E/SQLiteDatabase(1527):     at android.app.ActivityThread.access$600(ActivityThread.java:130)
12-18 19:47:48.370: E/SQLiteDatabase(1527):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1195)
12-18 19:47:48.370: E/SQLiteDatabase(1527):     at android.os.Handler.dispatchMessage(Handler.java:99)
12-18 19:47:48.370: E/SQLiteDatabase(1527):     at android.os.Looper.loop(Looper.java:137)
12-18 19:47:48.370: E/SQLiteDatabase(1527):     at android.app.ActivityThread.main(ActivityThread.java:4745)
12-18 19:47:48.370: E/SQLiteDatabase(1527):     at java.lang.reflect.Method.invokeNative(Native Method)
12-18 19:47:48.370: E/SQLiteDatabase(1527):     at java.lang.reflect.Method.invoke(Method.java:511)
12-18 19:47:48.370: E/SQLiteDatabase(1527):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
12-18 19:47:48.370: E/SQLiteDatabase(1527):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
12-18 19:47:48.370: E/SQLiteDatabase(1527):     at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T18:18:47.623

你不能放

```
DatabaseHelper dh = new DatabaseHelper(this); 
```

在字段声明空间中。`this`这是因为您至少直到`onCreate`或其他 Activity 方法都无法访问上下文。尝试移动引用`this`inside的行`onCreate`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-26T18:18:53.740

您只能在`onCreate()`调用后使用您的 Activity 的上下文，否则它还无效。只需将您的代码更改为：

```
DatabaseHelper db;

@Override
public void onCreate(Bundle savedInstanceState) {
    ...
    db = new DatabaseHelper(this); 
```

* * *

**添加**

```
no such table: highscoresDatabase 
```

您使用了错误的字符串，使用`TABLE`而不是`DB_NAME`第 56 行：

```
return myDB.insert(TABLE, null, values); // Line 56 
```

# aop - AOP for MVC Mini Profiler

> ID：14044452
> 
> 赞同：2
> 
> 时间：2012-12-26T18:15:31.157
> 
> 标签：aop

我正在使用 mvc mini profiler 来分析 NUnit 测试套件。我只是好奇是否可以使用 mvc mini profiler 的分析机制作为一个方面，即，而不是让那些 using 语句，我不能以某种方式在我想要分析的方法之上提供一些属性吗？我知道这会破坏我们使用迷你分析器获得的那种粒度，但在某些情况下，使用 AOP 方法更合适。

想法？建议？

谢谢一堆。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T02:26:38.923

您需要编织代码，因此您必须查看[PostSharp](http://www.sharpcrafters.com/)、[Roslyn](http://www.mindscapehq.com/blog/index.php/2011/10/20/in-bed-with-roslyn/)或其他一些[IL 编织](https://stackoverflow.com/questions/189359/what-is-il-weaving)机制。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-11T06:34:47.707

是的，这是完全可能的。就我而言，我使用的是[Autofac](http://code.google.com/p/autofac/)，它使用 Castle 的 DynamicProxy 实现拦截。

但是一个非常基本的分析拦截器看起来像这样（在 C# 中）：

```
public class ProfilerInterceptor : IInterceptor
{
    #region Implementation of IInterceptor

    public void Intercept(IInvocation invocation)
    {
        using (MiniProfiler.Current.Step(invocation.TargetType.Name + "." + invocation.Method.Name))
        {
            invocation.Proceed();
        }
    }

    #endregion
} 
```

**注意**：我知道您的偏好是编织而不是通过代理拦截，但我发布它以防其他人发现它有用。

# php - 如何正确删除与记录相关的文件

> ID：14044453
> 
> 赞同：0
> 
> 时间：2012-12-26T18:15:30.280
> 
> 标签：php, cakephp

如果新闻被删除，我需要删除与当前新闻相关的图标文件。我看到了两种方法。

第一的：

```
public function admin_delete ($id = null, $icon = null) {
    if ($this->request->is('get')) {
        throw new MethodNotAllowedException();
    }
    if ($this->News->delete($id)) {
        unlink(WWW_ROOT . 'img/icons/news/' . $icon);
        $this->Session->setFlash('ok!');
        $this->redirect(array('action' => 'index'));
    }
} 
```

我需要从视图中将记录 ID 和文件名传递给此操作。对我来说，它看起来有点难看，也可能导致 Nginx 相关问题。

第二个：

```
public function admin_delete ($id = null) {
    if ($this->request->is('get')) {
        throw new MethodNotAllowedException();
    }
    $icon = $this->News->read('icon', $id);
    if ($this->News->delete($id)) {
        unlink(WWW_ROOT . 'img/icons/news/' . $icon['icon']);
        $this->Session->setFlash('ok!');
        $this->redirect(array('action' => 'index'));
    }
} 
```

但我不确定这是一个好方法，我应该使用`read`or `find('first')`。我希望你能给我一些建议，告诉我如何以更正确的方式去做。提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T19:33:54.033

这些东西都不应该在控制器中。`find('first')`使用模型获取记录`beforeDelete()`并将文件名保存在模型属性中。然后在`afterDelete()`删除你缓存的文件名中删除文件`beforeDelete()`。

# rest - 使用 Jersey 和 Spring 进行授权和身份验证

> ID：14044458
> 
> 赞同：1
> 
> 时间：2012-12-26T18:16:07.167
> 
> 标签：rest, authentication, spring-security, authorization, jersey

我正在使用 jersey 和 Spring 3（包括 spring-security）编写一个 RESTfull 服务，并试图弄清楚如何实现身份验证和授权。
我是 jersey 和 Spring 的新手，所以这有点令人困惑......
用户及其角色在 DB 中定义。（并且未在 web.xml 或 tomcat-users 中定义）

以下是我对**授权**部分的看法：
由于我的服务不一定为 web 应用程序提供服务，因此授权应该在 REST 资源上完成（而不是在页面上） ） - 我该怎么做呢？我看到有 @RolesAllowed 注释，但它似乎太简单了，我需要更多逻辑。我想我必须以某种方式从那里激活 Spring Security 才能使用他们提供的授权功能。

对于**身份验证**部分，我似乎应该使用 spring security 的 AuthenticationManager 和 SessionManagement，但我不确定如何将其连接到 REST API：
1\. 获取身份验证请求的 API 应该是什么样子？
2\. 如果 Spring 处理我的会话，我如何在我的 REST 资源上添加授权？

如果您能帮我清理一下，我将不胜感激...

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T21:40:23.400

抱歉，但如果您还处于 Spring Security 专业知识的早期阶段，我必须建议您先完成[出色的教程](http://static.springsource.org/spring-security/site/start-here.html)。我相信您的问题将得到自动回答，并且您将在此过程中学到很多有价值的东西。

# c++ - 为什么我的套接字停止传输？

> ID：14044460
> 
> 赞同：1
> 
> 时间：2012-12-26T18:16:10.643
> 
> 标签：c++, sockets, networking, tcp, connection

好吧，让我说清楚。我正在使用 TCP，这意味着除非关闭或由于网络问题，否则连接不应中断。

所以这是我的问题：

**使用我的插座效果很好。**

在 5 到 10 分钟不活动后，它们停止响应（连接仍然存在 [使用 netstat -n 检查]）。

它告诉我数据已发送（但对方没有收到它，我确定它正在等待它。）

如果我继续发送，最终它会给我 WSA 错误 10038（无效的套接字句柄）。

**再次尝试发送后进行编辑，它给了我错误 10058（已建立的连接被主机中的软件中止。）**

我完全糊涂了。除了不活动之外，我没有关闭套接字也没有对它做任何事情。如果我不间断地使用它 10 - 20 分钟，它会完美运行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T19:21:20.213

使用错误 10058，实际上可以确定网关（代理、防火墙或路由器，有或没有 NAT）正在超时其连接中继。

基本上，你与你的同伴没有直接联系。相反，网关介于两者之间，并在其与您的连接和与您的对等方的连接之间显式传输数据。由于套接字是一种有限的资源，网关有一个驱逐策略，它会关闭看起来不活动的连接。如果你看起来死了，砰，你死了。

您唯一的选择是保持活动状态，这通常意味着在您的应用程序协议中使用某种“心跳”。讨厌，但他们是休息时间。

除非你真的知道自己在做什么，否则**不要**玩弄 TCP 的 SO_KEEPALIVE。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T18:20:10.277

NAT 防火墙可能会在不通知您的情况下占用您[的连接。](http://tldp.org/HOWTO/html_single/TCP-Keepalive-HOWTO/#preventingdisconnection)尝试启用[TCP keepalive](http://tldp.org/HOWTO/html_single/TCP-Keepalive-HOWTO/)。

# file-upload - 使用 Dart 将文件上传到服务器

> ID：14044461
> 
> 赞同：2
> 
> 时间：2012-12-26T18:16:20.357
> 
> 标签：file-upload, dart

我在测试中使用这样的东西：

```
_sendFormData(final File file) {
    final HttpRequest httprequest = new HttpRequest();
    final String filename = file.name;

    httprequest.open('POST', "http://localhost:8080/api/file/upload");
    httprequest.on.readyStateChange.add((e) {
      if (httprequest.readyState == 4 && httprequest.status == 200) {
        window.alert("upload complete");
      }
    });

    print("Filename: ${filename}");

    final FormData formData = new FormData();
    formData.append('file', null, filename);
    httprequest.send(formData);
} 
```

是的，我知道这只是我要发送的文件名，但是如何将整个文件发送到服务器？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-26T21:15:04.430

您应该能够上传`file`：

```
formData.append('file', file); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-06-03T09:52:01.337

他们引入了一个新函数来附加具有给定文件名的文件：

```
FormData.appendBlob(String name, Blob value, [String filename]) 
```

# java - 在java中使用正则表达式进行模式搜索

> ID：14044464
> 
> 赞同：1
> 
> 时间：2012-12-26T18:16:33.297
> 
> 标签：java, regex, pattern-matching, matcher

```
public static void main(String args[]) {
    Pattern p = Pattern.compile("ab");  // Case 1
    Pattern p = Pattern.compile("bab");  // Case 2
    Matcher m = p.matcher("abababa");
    while(m.find()){
        System.out.print(m.start());
    }
} 
```

当我使用**Case 1**时，输出为**024**正如预期的那样。但是，当我使用**案例 2**时，输出为**1**，但我预期为**13**。因此，任何人都可以向我解释，是否有任何异常规则`regex`会导致此输出，如果没有的话。然后，为什么我得到这个输出。

帮助赞赏！

**注：**案例 1 和案例 2 独立使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T18:18:51.763

匹配*消耗*输入，因此在上一个匹配结束*后*找到下一个匹配：

每次匹配前“bab”匹配器指针的位置为：

1.  `|abababa`
2.  `abab|aba`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T18:19:09.283

对于案例 2：

这是因为，在它搜索之后`bab`，它不会考虑已经搜索过的 char(b 在这种情况下是索引 3)，因此你只会得到 1。

```
Input:  abababa
Search for bab, 
 find's a match starting at index 1 and ending at index 3, next the search would start at index 4(aba) 
```

# c# - windows.open 的 WF 行为

> ID：14044465
> 
> 赞同：0
> 
> 时间：2012-12-26T18:16:35.233
> 
> 标签：c#

我知道这是一个非常广泛的问题，但我无法弄清楚如何解决这个问题。我研究过互联网，但没有重要的建议。

我们有两台服务器，一台运行 IIS7，另一台运行 IIS6。同一个网站部署到他们两个。当我们访问网站时，预期的行为是按照以下代码在全屏单独窗口中打开登录页面：

```
window.open("Login.aspx?from=default", "login", "scrollbars=yes,resizable=yes,status=yes,height=" + xheight + ",width=" + xwidth) 
```

该网站在 IIS6 服务器上的行为不同，因为登录页面在同一个窗口中打开，而不是单独打开。似乎无法理解为什么。任何有关如何处理此问题的指示或任何解释都将不胜感激。

谢谢你。

# sendmail - 在消息驱动 Bean 中发送邮件

> ID：14044472
> 
> 赞同：0
> 
> 时间：2012-12-26T18:17:03.913
> 
> 标签：sendmail, message-driven-bean

我是全新的`javamail`，我想知道它是否是从`MDB`Java EE 应用程序内部发送邮件的正确方法。

我的目的只是在用户注册后发送异步邮件（一次只能发送一封邮件）。

另外，我想知道`javamail`一次发送 500 多封邮件是否足够高效（例如，从数据库中选择所有邮件地址以发送时事通讯）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T13:57:50.753

是的，您可以使用 javamail 从 MDB 发送邮件。它也足够有效。

# python - Python unittest - setUpClass() 给我带来了麻烦 - 为什么我不能这样继承？

> ID：14044474
> 
> 赞同：49
> 
> 时间：2012-12-26T18:17:06.270
> 
> 标签：python, unit-testing

我有如下的单元测试代码：

```
import unittest

class MyUnitTest(unittest.TestCase):
    def setUpClass(self):
        do_something_expensive_for_all_sets_of_tests()

class MyFirstSetOfTests(MyUnitTest):
    def setUpClass(self):
        super(MyFirstSetOfTests, self).setUpClass()
        do_something_expensive_for_just_these_first_tests()

    def test_one(self):
        ...

    def test_two(self):
        ...

class MySecondSetOfTests(MyUnitTest):
    def setUpClass(self):
        super(MySecondSetOfTests, self).setUpClass()
        do_something_expensive_for_just_these_second_tests()

    def test_one(self):
        ...

    def test_two(self):
        ...

if __name__ == '__main__':
    unittest.main() 
```

当我尝试运行此代码时，我收到如下错误：

```
======================================================================
ERROR: setUpClass (__main__.MyFirstSetOfTests)
----------------------------------------------------------------------
TypeError: unbound method setUpClass() must be called with MyFirstSetOfTests instance as first argument (got nothing instead)

---------------------------------------------------------------------- 
```

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2012-12-26T18:27:25.930

`setUpClass` *必须*是类方法。从[文档](http://docs.python.org/library/unittest.html#unittest.TestCase.setUpClass)中：

> 在单个类运行测试之前调用的类方法。`setUpClass`以类作为唯一参数调用，并且必须装饰为`classmethod()`：
> 
> ```
> @classmethod
> def setUpClass(cls):
>     ... 
> ```
> 
> 有关更多详细信息，请参见[类和模块装置](http://docs.python.org/library/unittest.html#class-and-module-fixtures)。

您的版本缺少[`@classmethod`装饰器](https://docs.python.org/library/functions.html#classmethod)：

```
class MyUnitTest(unittest.TestCase):
    @classmethod
    def setUpClass(cls):
        do_something_expensive_for_all_sets_of_tests()

class MyFirstSetOfTests(MyUnitTest):
    @classmethod
    def setUpClass(cls):
        super(MyFirstSetOfTests, cls).setUpClass()
        do_something_expensive_for_just_these_first_tests() 
```

抛出错误是因为在*class*`MyFirstSetOfTests.setUpClass()`上调用，而不是在实例上调用，但是您没有将方法标记为 a ，因此它没有在自动参数中传递。在上面我使用的更新代码中，以反映名称引用了类对象。*`classmethod``self``cls`*

# java - 具有某些限制的不同实现的模式

> ID：14044480
> 
> 赞同：0
> 
> 时间：2012-12-26T18:17:19.173
> 
> 标签：java, android, design-patterns, libraries

我正在编写一个库来简化 Android 中 Http 请求的使用，并且我编写了两种不同的实现（一种使用 Apache 库，另一种使用 HttpUrlConnection）和一个通用接口。

我可以那样做，但我正在寻找一种可以更好地代表以下行为/限制的模式：
1\. 实现类是单例的。
2\. 该库应仅用于每个程序中的一个实现。
3\. 实现之间必须易于更改。

我已经想出了如何在没有设计模式的情况下做到这一点，但我更喜欢使库成为最“标准”的库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T18:25:32.040

也许你应该看看[策略模式](http://en.wikipedia.org/wiki/Strategy_pattern)。

在设计库时，尽量远离单例可能会更好（请参阅单例[有什么不好？](https://stackoverflow.com/questions/137975/what-is-so-bad-about-singletons)

# ruby-on-rails - 无法使用 RailsInstaller 找到 RubyGem railties (>= 0) (Gem::LoadError)

> ID：14044488
> 
> 赞同：1
> 
> 时间：2012-12-26T18:18:16.873
> 
> 标签：ruby-on-rails, rubygems, installation, railtie

[在 Ruby on Rails 中，我尝试按照http://railsinstaller.org/windows](http://railsinstaller.org/windows)中指示的分步说明将其安装在我的 Windows 机器上

在第 7 步，它说我们应该输入以下命令：

```
$ rails g controller welcome index 
```

所以我这样做：

```
PS C:\Sites\railsinstaller_demo> rails g controller welcome index 
```

我得到这个错误：

```
C:/Program Files/ruby-1.9.2/lib/ruby/site_ruby/1.9.1/rubygems.rb:926:in 
  `report_activate_error': Could not find RubyGem railties (>= 0) (Gem::LoadError)
  from C:/Program Files/ruby-1.9.2/lib/ruby/site_ruby/1.9.1/rubygems.rb:244:in 
      `activate_dep'
  from C:/Program Files/ruby-1.9.2/lib/ruby/site_ruby/1.9.1/rubygems.rb:236:in `activate'
  from C:/Program Files/ruby-1.9.2/lib/ruby/site_ruby/1.9.1/rubygems.rb:1307:in `gem'
  from C:/RailsInstaller/Ruby1.9.3/bin/rails:18:in `<main>' 
```

我用谷歌搜索了这个错误并读到解决方案是安装 de DevKit，所以我这样做了，但问题仍然存在。

是什么导致了这些错误？

编辑：

这是我运行 gem list 时出现的内容：

```
PS C:\Sites\railsinstaller_demo> gem list

*** LOCAL GEMS ***

actionmailer (3.2.9)
actionpack (3.2.9)
activemodel (3.2.9)
activerecord (3.2.9)
activeresource (3.2.9)
activesupport (3.2.9)
arel (3.0.2)
builder (3.0.4)
erubis (2.7.0)
foreman (0.60.2)
hike (1.2.1)
i18n (0.6.1)
journey (1.0.4)
mail (2.4.4)
mime-types (1.19)
minitest (1.6.0)
multi_json (1.5.0)
polyglot (0.3.3)
rack (1.4.1)
rack-cache (1.2)
rack-ssl (1.3.2)
rack-test (0.6.2)
rake (0.8.7)
rdoc (2.5.8)
rest-client (1.6.7)
sequel (3.20.0)
sinatra (1.0)
sprockets (2.2.2)
taps (0.3.24)
thor (0.16.0)
tilt (1.3.3)
treetop (1.4.12)
tzinfo (0.3.35) 
```

正如@EricLeschinski 所建议的，我尝试了 tu run "gem install rails" 但出现了这个错误：

```
PS C:\Sites\railsinstaller_demo> gem install rails
ERROR:  Error installing rails:
    The 'json' native gem requires installed build tools.

Please update your PATH to include build tools or download the DevKit
from 'http://rubyinstaller.org/downloads' and follow the instructions
at 'http://github.com/oneclick/rubyinstaller/wiki/Development-Kit' 
```

最终编辑：

最后，我并没有搞砸我的初始安装有多糟糕，但我发现这个 Youtube 视频[http://www.youtube.com/watch?v=WUdDdiu8kBs](http://www.youtube.com/watch?v=WUdDdiu8kBs)原来是安装所有东西的最清晰的方法我需要并且按照她的指示完全没有问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-04-01T05:17:47.393

> 找不到 RubyGem railties

此错误是由于您使用的 rails 版本与 Gemfile 中定义的版本不同造成的。

尝试`rails -v`检查 rails 版本。

参考：[https ://www.railstutorial.org/book/toy_app](https://www.railstutorial.org/book/toy_app)

# jquery - jquery计算json中的项目

> ID：14044503
> 
> 赞同：1
> 
> 时间：2012-12-26T18:19:11.730
> 
> 标签：jquery

我有一个如下所示的 JSON：

```
({
    "type": "FeatureCollection",
    "features": [
        {
            "type": "Feature",
            "properties": {
                "wkb_geometry": null,
                "code": "type 1",
                "code2": "type 3",
                "code3": "type 5",
                "updated_at": "2012-10-29T12:38:00.037Z"
            }, 
        },
        {
            "type": "Feature",
            "properties": {
                "wkb_geometry": null,
                "code": "type 1",
                "code2": "type 5",
                "code3": "type 7",
                "updated_at": "2012-10-29T12:38:00.037Z"
            },

        },
        {
            "type": "Feature",
            "properties": {
                "wkb_geometry": null,
                "code": "type 2",
                "code2": "type 3",
                "code3": "type 5",
                "activity_type": "children's play area",
                "updated_at": "2012-10-29T12:38:00.037Z"
            },

        }... 
```

基本上我想计算这个 Json 中的所有代码，即类型 5 出现 3 次。

到目前为止，我有一个循环可以挑选出所有类型 1 代码，但我不确定如何让循环对项目进行计数：

```
$.each(geojson.features, function(i, v) {
    if (v.properties.code.search(new RegExp(/type 1/i)) != -1) {
        console.log(v.properties.activity_type_code);
    }
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T18:31:02.560

您只需要在 if 语句中增加一个计数器：

```
var count = 0;
$.each(geojson.features, function (i, v) {
    if (v.properties.code.search(new RegExp(/type 1/i)) != -1) {
        count++;
    }
});
console.log(count); 
```

# php - 无法使用 ajax 从 codeigniter 函数获取数据

> ID：14044514
> 
> 赞同：0
> 
> 时间：2012-12-26T18:20:10.803
> 
> 标签：php, jquery, ajax, codeigniter

这是我到目前为止所得到的：

这个从模型返回数据的函数：

```
function get_user2()
{
    $this->load->model('my_model');
    $id=$this->input->post('users1');
    $users2=$this->my_model->get_relations($id);
    return $users2;
} 
```

模型功能：

```
function get_relations($usr)
{
        $this->db->where('id',$usr);
        $rel=$this->db->get('relacion');

    if($rel->num_rows!=0)
    {
        $relacion=array();
        foreach ($rel->result_array() as $row) 
        {
            $relacion[]=array(
                            'id'=>$row['id'],
                            'username1'=>$row['username1'],
                            'username2'=>$row['username2'],
                        );
        }
        return $relacion;
    }else{
        return false;
    }
} 
```

在我看来：

```
<select name="users1" id="drop1">
<?php
    if($opciones!=false){
        foreach ($opciones as $row) {
            echo '<option value="'.$row['user_id'].'">'.$row['username'].'</option>';
        }

    }
?>
</select>
<script src="jquery.js"></script>
<script type="text/javascript">
$("#drop1").change(function(){
    $.ajax({
                type: "POST",
                url: "example.com/CI/index.php/evaluation/get_user2",
                data: "users1="+$('#drop1').val(),
                success: function(){
                    alert('it works!');
                }
            });
});
</script> 
```

我想用控制器函数返回的选项填充第二个下拉列表，但是 ajax 请求没有做任何事情，所以我什至没有到达那部分。有人可以帮我找出问题所在吗？我已经测试了控制器和模型的功能并且它们可以工作。你能告诉我如何填写第二个下拉菜单的选项吗？非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T19:23:29.993

好吧，我在一个项目中有一个非常相似的代码，可以根据用户选择的岛屿获得一些城市。因此，选择更改，加载城市并启用第二个选择。主要区别在于您传递数据的方式。

```
<script type="text/javascript">
$("#idisla").change(function(){
        if($("#idisla").val()!=""){
            var dato=$("#idisla").val();
            $.ajax({
                type:"POST",
                dataType:"html",
                url:base_url+"admin/centros/municipios_select",
                data:"idislajs="+dato,
                success:function(msg){
                    $("#idmunicipio").empty().removeAttr("disabled").append(msg);
                    callback();
                }
            });
        }else{
            $("#idmunicipio").empty().attr("disabled","disabled");
        }
});
</script> 
```

该函数仅从选定的小岛 (id) 中查找城市

```
 function municipios_select()
    {
        //el idIsla viene dado por el value del combo islas
        $isla = $this->input->post('idislajs');
        $data['municipios'] = $this->municipios_model->obtenMunicipios($isla);
        echo $this->load->view("site/municipios_select",$data, TRUE);
    } 
```

# html - 将 div 移动到浮动元素的右侧，但在另外两个下方

> ID：14044516
> 
> 赞同：0
> 
> 时间：2012-12-26T18:20:14.473
> 
> 标签：html, css, xhtml, width

这是一个让我难以接受的 CSS 问题。下面是我目前拥有的代码，我希望描述文本位于蓝色框的右侧（即标题下方），但要在“按钮”下方继续。我尝试了各种组合，但它们要么从当前位置开始，要么在标题下方但按其宽度缩进。

非常感谢任何帮助

```
<html>
    <head>
        <style>
            body { background-color: #fff; color: white; }
            .outer { width: 850px; height: 400px; background-color: #000; }
            .logo {float: left; width:150px;height:150px;background-color: #00f;}
            .button {float: right; height: 60px; width: 80px; background-color: #f00; }
            .title { font-size: 60px; float:left;}
            .desc {clear:both;}
        </style>
    </head>
    <body>
        <div class="outer">
            <div class="head">
                <div class="logo">oo</div>
                <div>
                    <div class="title">Title</div>
                    <div class="button">button</div>
                    <div class="desc">description text description text description text description text description text description text description text description text description text description text description text description text</div>
                </div>
            </div>
        </div>
    </body>
</html> 
```

![例子](../Images/2d6ab83e7bf38fcf434dc9d32f1ddc96.png)

文本应该是上图中白框所在的位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T18:39:17.687

现在这应该很简单吧？只需将它浮动到左边并给它一个宽度......

[**演示**](http://jsfiddle.net/wYQmd/)

CSS

```
.desc {
    float: left;
    width: 650px;
    padding: 10px;
} 
```

# android - 确定应用程序是否在前台 - 这是否令人不悦？

> ID：14044523
> 
> 赞同：3
> 
> 时间：2012-12-26T18:20:54.340
> 
> 标签：android, activity-lifecycle, application-lifecycle

检测应用程序是否在前台有很多原因。例如 - 作为 GCM/C2DM 推送通知的触发器 - 当应用程序处于前台和后台时，许多应用程序将有充分的理由实施不同的行为。其他原因可能是 - 关闭消耗宝贵资源的服务，例如在后台任务中查询服务器。

为了清楚起见：**后台应用程序的定义（如我所见）是**：
应用程序没有任何活动被调用该`onStart()`方法，并且还没有调用该`onStop()`方法。那是因为只有在那个时候，用户才能在它的生命周期中看到活动。

从另一方面 -

*   似乎谷歌不希望应用程序对主页按钮做出反应（它不是 API 的一部分）

*   对“root / main”活动做出反应`onBackPressed()`作为离开的指标`Activity`肯定不是好主意（因为很多用户使用主页按钮，而不是返回按钮）

*   API中没有方法可以确定应用程序是否是前台（根据我的定义..）

如果我没有错过 API 中的某些内容，而且确实如此 -**为什么没有为什么可以轻松确定应用程序是否在前台？？？？？？！！！！！！**

**我知道我可以做些什么**来确定应用程序是否是前台在此线程中进行了描述-[如何检测 Android 应用程序何时进入后台并返回前台](https://stackoverflow.com/questions/4414171/how-to-detect-when-an-android-app-goes-to-the-background-and-come-back-to-the-fo)

但正如@Emil 所说 - 它需要特殊许可，或者需要一些棘手的逻辑，这些逻辑很快就会变得难以维护，而且它闻起来像是不好的方法（尽管这就是我现在正在做的事情，因为我没有更好的主意。 ..)

**我的问题基本上是**：

*   是否有充分的理由没有这样的 API 方法？

*   是否考虑应用程序是否是前台是一种不好的方法？

*   有没有其他方法可以知道应用程序是否在前台？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-26T18:34:06.093

> 是否考虑应用程序是否是前台是一种不好的方法？

考虑前景与背景是合理的。

> 有没有其他方法可以知道应用程序是否在前台？

您可以将其大致分为两组：

1.  希望在前台/后台状态发生变化时立即采取行动的情况

2.  发生其他事件（`AlarmManager`警报、传入系统广播等）的情况，此时您希望根据您是否在前台采取不同的操作

在前一种情况下，`onUserLeaveHint()`是您最可靠的简单选择。我不能保证它会涵盖所有情况，但它应该处理 HOME 场景，例如。也欢迎您在静态数据成员中维护已启动活动的引用计数，并尝试使用它。

在后一种情况下，[有序广播](http://commonsware.com/blog/2010/08/11/activity-notification-ordered-broadcast.html)可能很有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-04-02T07:34:56.870

借助新的 Android 架构组件，您可以轻松了解您的应用是在前台还是后台。

就像活动范围生命周期所有者一样，有一个通用流程生命周期所有者，您可以订阅并获取生命周期更新。

例如：

添加此代码以注册为生命周期观察者

```
ProcessLifecycleOwner.get().lifecycle.addObserver(lifecycleListener) 
```

而这段代码是为了接收相关的回调

```
@OnLifecycleEvent(Lifecycle.Event.ON_START)
public void onApplicationOnStartEvent() {

}

@OnLifecycleEvent(Lifecycle.Event.ON_STOP)
public void onApplicationOnStopEvent() {

} 
```

不需要时不要忘记删除观察者

```
ProcessLifecycleOwner.get().getLifecycle().removeObserver(lifecycleListener); 
```

更多信息和示例可以在这篇优秀的文章中找到：

[https://proandroiddev.com/detecting-when-an-android-app-backgrounds-in-2018-4b5a94977d5c](https://proandroiddev.com/detecting-when-an-android-app-backgrounds-in-2018-4b5a94977d5c)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T18:34:22.383

我遇到过同样的问题。当我的活动不处于前台模式时，我想显示推送通知。请通过以下代码，您将得到答案。

```
 Context ctx = context.getApplicationContext();

    ActivityManager am = (ActivityManager) context
            .getSystemService(ACTIVITY_SERVICE);

    // get the info from the currently running task
    List<ActivityManager.RunningTaskInfo> taskInfo = am.getRunningTasks(1);

    PackageManager pm = this.getPackageManager();

    try {
        /**
         * take fore ground activity name
         */
        ComponentName componentInfo = taskInfo.get(0).topActivity;
        if (printLog == true) {
            Log.d("Home", "CURRENT Activity ::"
                    + taskInfo.get(0).topActivity.getClassName());
            Log.d("Home", "Number Of Activities : "
                    + taskInfo.get(0).numRunning);
            Log.d("Home",
                    "Componenet Info : " + componentInfo.getPackageName());
            Log.d("Home",
                    "Componenet Info : " + componentInfo.getClassName());
        }
        /**
         * All activities name of a package to compare with fore ground
         * activity. if match found, no notification displayed.
         */
        PackageInfo info = pm.getPackageInfo(
                "<PackageName>",
                PackageManager.GET_ACTIVITIES);
        ActivityInfo[] list = info.activities;

        for (int i = 0; i < list.length; i++) {
              Log.d("TAG","Activity : "+list[i].name);
        }

    } catch (NameNotFoundException e) {
        e.printStackTrace();
    } 
```

要使用它，您必须在您的`manifest`文件中获得许可。

*使用权限 android:name="android.permission.GET_TASKS"*

如果我不能回答你的问题，请原谅我。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-28T17:08:59.087

如果您需要知道应用程序是在后台运行的服务的后台还是前台（否则没有意义），那么您可以使用绑定，即 - 在所有活动上绑定到它 onResume , 并解除对所有活动 onPause 的绑定。然后在您的服务中，您不仅可以管理您的应用程序对用户的可见性，还可以随时管理哪些活动是打开的。当您使用 android 的 API 并依赖于 android 操作系统代码本身的正确性时，它也比静态变量（如果需要可以清理）更防泄漏和更稳定。

# php - PHP 站点使用 ./dir/ 包含文件

> ID：14044525
> 
> 赞同：0
> 
> 时间：2012-12-26T18:21:20.363
> 
> 标签：php, apache, .htaccess

我继承了一个使用 ./ 表示法作为包含目录的站点，并且在本地工作，所有链接都已损坏。

我可以对我的 OS X AMP 设置做些什么来使 ./ 符号适用于相对文档路径？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T19:43:58.620

你没有使用`./`但绝对地址。在 php 中，如果你想使用绝对路径，你必须使用`dirname(__FILE__)`或`__DIR__`在路径之前使你的地址成为绝对的。

`./`不是根目录而是当前目录。

例如，`include('/inc/head.php');`您可以使用：

```
include(__DIR__.'/inc/head.php'); 
//or
include(dirname(__FILE__).'/inc/head.php');//if you haven't got php 5.3 
```

在这段代码中，我假设目录“inc”位于站点根目录。

# wpf - c# wpf Binding Command - 从命令访问文本框的值

> ID：14044526
> 
> 赞同：0
> 
> 时间：2012-12-26T18:21:23.720
> 
> 标签：wpf, xaml, mvvm, command

我想调用一个简单的命令，它将我的 GUI 中的值添加到数据库中。

我的命令：

```
private ICommand addSpeechCommand;
public ICommand AddSpeechCommand
{
  get
  {
    if (addSpeechCommand == null)
    {
      addSpeechCommand = new RelayCommand(param => AddSpeech());
    }
    return addSpeechCommand;
  }
}

public void AddSpeech()
{
  // TODO add 
OrganizerBL.InsertSpeech(new Speech(maxSpeechId, currentSpeech.Title, currentSpeech.Summary, currentSpeech.Start, currentSpeech.End, currentSpeech.TrackId, currentSpeech.SpeakerId, currentSpeech.ConferenceId, currentSpeech.Room));
  this.LoadSpeeches();
} 
```

-- 这个注释掉的行显示了当我的数据网格的一行被选中时我是如何处理它的。但我希望它在没有 currentSpeech 的情况下工作

我的 XAML：

```
 <Label x:Name ="lblTitle" Content="Title"/>
        <TextBox x:Name="txtTitle" Text="{Binding CurrentSpeech.Title, Mode=TwoWay}" Margin="2,144,0,0" Height="20" VerticalAlignment="Top"/> 
```

和其他文本框...

我真的不知道如何从命令中访问文本框的值来调用我的 insertSpeech 方法......

对不起我的英语不好 ：）

更新：我得到一个空引用异常，因为我的 currentSpeech 为空。有没有办法在没有 currentSpeech 的情况下解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T18:27:41.183

怎么做
1\. 将 TextBox.Text 绑定到视图模型属性
2\. 在命令处理程序中使用视图模型属性。

* * *

在您的情况下，您已绑定`TextBox.Text`到`CurrentSpeech.Title`，但使用`this.Title`.

在您的命令中，更改`this.Title`为`currentSpeech.Title`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T22:58:17.270

您得到 NullReferenceException 的原因可能是因为它在属性本身中被实例化。当您创建绑定时，它会在该阶段创建到属性。当它为 NULL 时，您将绑定到该属性。IT 实际上是在属性内部创建的，但绑定永远不会知道这一点。

首先，我会从属性中删除所有逻辑。我还将在类中实现 INotifyPropertyChanged，并在属性的“集合”中调用 PropertyChanged。这意味着 UI 将知道该属性的任何更改。然后，如果它在任何 Binding ot XAML 中使用，我将为该属性创建一个依赖属性。

最后，我将在类的构造函数中实例化该命令。

逻辑（在我的书中）不属于属性。

# vb.net - 无法启动解决方案：MyApp 配置为使用 IIS。找不到 Web 服务器“http://localhost:64646/”

> ID：14044530
> 
> 赞同：1
> 
> 时间：2012-12-26T18:21:39.227
> 
> 标签：vb.net, visual-studio-2010, iis

尝试启动解决方案时，我收到以下错误：

错误：Web 应用程序项目 MyApp 配置为使用 IIS。找不到 Web 服务器“http://localhost:64646/”。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T20:07:22.967

我打开 IIS 并将默认网站上的 TCP 端口设置为 64646，并且项目加载没有错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T18:26:33.617

您需要[在开发机器上安装 IIS](http://technet.microsoft.com/en-us/library/cc725762.aspx)。

使用 IIS，您还需要在管理员模式下运行 Visual Studio。

建议您使用[IIS Express](http://weblogs.asp.net/scottgu/archive/2010/06/28/introducing-iis-express.aspx)，因为它允许您在没有管理员权限的情况下运行 VS。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-16T17:22:50.857

您必须安装 IIS 并在 IIS 中使用匹配的端口号创建网站。其他人创建了 Visual Studio Web 项目以使用 IIS 并在他们的计算机上对其进行配置。每个打开解决方案的人都必须在 IIS 中手动配置所有网站。

您可能会考虑创建一个在源存储库中自动创建它们的脚本。您可以使用 AppCmd.exe（ADD SITE、ADD APPPOOL、LIST APPPOOL、LIST SITE）（%windir%\system32\inetsrv\AppCmd.exe）来完成。

# unix - 如何将第二行打印为第二列 unix

> ID：14044531
> 
> 赞同：0
> 
> 时间：2012-12-26T18:21:38.320
> 
> 标签：unix

如何将每隔一行打印为制表符分隔的第二列，如下所示。提前谢谢。

输入

```
wex
2
cr_1.b
4 
```

输出

```
wex 2
cr_1.b 4 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T18:34:40.697

假设您的输入文件中没有空行，这应该可以解决问题：

```
awk 'length(f) > 0 { print f $0; f = "" } length(f) == 0 { f = $0 }' file 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T19:16:58.023

这是另一个不依赖于行长的选项：

```
awk '{ if (NR % 2 == 1) tmp=$0; else print tmp, $0; }' <filename> 
```

如果你真的想要一个制表符分隔符，请`printf "%s\t%s\n",tmp,$0;`改用。

# string - 一系列字符串的最长公共子序列

> ID：14044532
> 
> 赞同：4
> 
> 时间：2012-12-26T18:21:41.160
> 
> 标签：string, algorithm, optimization, data-structures

对于 2 个字符串的[最长公共](http://en.wikipedia.org/wiki/Longest_common_subsequence_problem)子序列，我在网上找到了很多示例，我相信我理解了解决方案。
我不明白的是，将这个问题应用于`N`字符串的正确方法是什么？是否以某种方式应用了相同的解决方案？如何？解决方案不同吗？什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T19:36:13.033

当输入具有任意数量的字符串时，此问题变得[NP-hard 。](http://en.wikipedia.org/wiki/NP-hard)**只有**当输入具有固定数量的字符串时，这个问题才变得容易处理。如果输入有 k 个字符串，我们可以通过使用 ak 维数组来应用相同的 DP 技术来存储子问题的最优解。

参考：[最长公共子序列问题](http://en.wikipedia.org/wiki/Longest_common_subsequence_problem#cite_note-1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-19T13:13:50.753

要找到 2 个字符串 A 和 B 的最长公共子序列 (LCS)，您可以对角线遍历二维数组，如您发布的[链接中所示。](http://en.wikipedia.org/wiki/Longest_common_subsequence_problem)数组中的每个元素都对应于寻找子串 A' 和 B' 的 LCS 的问题（A 被它的行号切割，B 被它的列号切割）。这个问题可以通过计算数组中所有元素的值来解决。您必须确定，当您计算数组元素的值时，计算该给定值所需的所有子问题都已解决。这就是你对角遍历二维数组的原因。

该解决方案可以缩放以找到 N 个字符串之间的最长公共子序列，但这需要一种通用方法来迭代 N 维数组，以便仅当元素需要解决方案的所有子问题都已解决时才能到达任何元素。

除了以特殊顺序迭代 N 维数组，您还可以递归地解决问题。对于递归，保存中间解决方案很重要，因为许多分支将需要相同的中间解决方案。我写了一个小例子`C#`来做到这一点：

```
string lcs(string[] strings)
{
    if (strings.Length == 0)
        return "";
    if (strings.Length == 1)
        return strings[0];
    int max = -1;
    int cacheSize = 1;
    for (int i = 0; i < strings.Length; i++)
    {
        cacheSize *= strings[i].Length;
        if (strings[i].Length > max)
            max = strings[i].Length;
    }
    string[] cache = new string[cacheSize];
    int[] indexes = new int[strings.Length];
    for (int i = 0; i < indexes.Length; i++)
        indexes[i] = strings[i].Length - 1;
    return lcsBack(strings, indexes, cache);
}
string lcsBack(string[] strings, int[] indexes, string[] cache)
{
    for (int i = 0; i < indexes.Length; i++ )
        if (indexes[i] == -1)
            return "";
    bool match = true;
    for (int i = 1; i < indexes.Length; i++)
    {
        if (strings[0][indexes[0]] != strings[i][indexes[i]])
        {
            match = false;
            break;
        }
    }
    if (match)
    {
        int[] newIndexes = new int[indexes.Length];
        for (int i = 0; i < indexes.Length; i++)
            newIndexes[i] = indexes[i] - 1;
        string result = lcsBack(strings, newIndexes, cache) + strings[0][indexes[0]];
        cache[calcCachePos(indexes, strings)] = result;
        return result;
    }
    else
    {
        string[] subStrings = new string[strings.Length];
        for (int i = 0; i < strings.Length; i++)
        {
            if (indexes[i] <= 0)
                subStrings[i] = "";
            else
            {
                int[] newIndexes = new int[indexes.Length];
                for (int j = 0; j < indexes.Length; j++)
                    newIndexes[j] = indexes[j];
                newIndexes[i]--;
                int cachePos = calcCachePos(newIndexes, strings);
                if (cache[cachePos] == null)
                    subStrings[i] = lcsBack(strings, newIndexes, cache);
                else
                    subStrings[i] = cache[cachePos];
            }
        }
        string longestString = "";
        int longestLength = 0;
        for (int i = 0; i < subStrings.Length; i++)
        {
            if (subStrings[i].Length > longestLength)
            {
                longestString = subStrings[i];
                longestLength = longestString.Length;
            }
        }
        cache[calcCachePos(indexes, strings)] = longestString;
        return longestString;
    }
}
int calcCachePos(int[] indexes, string[] strings)
{
    int factor = 1;
    int pos = 0;
    for (int i = 0; i < indexes.Length; i++)
    {
        pos += indexes[i] * factor;
        factor *= strings[i].Length;
    }
    return pos;
} 
```

我的代码示例可以进一步优化。许多被缓存的字符串是重复的，有些是重复的，只添加了一个额外的字符。当输入字符串变大时，这会使用比必要更多的空间。

输入时：`"666222054263314443712", "5432127413542377777", "6664664565464057425"`

返回的 LCS 是`"54442"`

# c++ - 如何在 MFC 对话框上绘制/创建 GDI+

> ID：14044536
> 
> 赞同：2
> 
> 时间：2012-12-26T18:21:51.147
> 
> 标签：c++, mfc, gdi+

我有一个基于对话框的 MFC 应用程序。我使用[这个](http://www.codeproject.com/Articles/3537/Loading-JPG-PNG-resources-using-GDI)从资源创建了一个 GDI+ 对象。

我的Dlg.cpp：

```
BOOL CSetupDlg::OnInitDialog()
{
    Gdiplus::GdiplusStartupInput gdiplusStartupInput;
    Gdiplus::GdiplusStartup(&m_gdiplusToken, &gdiplusStartupInput, NULL);
        ...
} 
```

无效我的函数（）：

```
CGdiPlusBitmapResource* pBitmap = new CGdiPlusBitmapResource;
if (pBitmap->Load(ID_SPL_LG))
{
    CPaintDC dc(this);
    Gdiplus::Graphics graphics(dc);
    graphics.DrawImage(*pBitmap, 0, 0);
    //It is loaded . I checked with messagebox and its in here.
}
Invalidate(); //Not sure if necessary. 
```

现在，Form/Dialog 什么也没有显示。没有插入或附加图像。

现在，我尝试了几件事来将此图像添加到对话框中，但我无法做到。

我尝试的是`GDIObject.Create()`，`CStatic.Create()`和`PictureControl.Create()`

我要做的就是将此图像插入对话框。

任何想法或显示路径表示赞赏。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-26T18:32:09.383

您将需要覆盖`OnPaint`响应`WM_PAINT`对话框中消息的方法。通常你不需要这样做，因为对话框不需要绘制任何东西，它只是让包含在它上面的控件自己绘制。

将您显示的代码移动到 OnPaint 处理程序中。

不要从您自己的处理程序*中*调用默认 OnPaint。

不要从 OnPaint 处理程序中调用，*否则*`Invalidate`会出现无限循环。

# c++ - 并行使用 std::thread？

> ID：14044539
> 
> 赞同：5
> 
> 时间：2012-12-26T18:22:11.190
> 
> 标签：c++, c++11, parallel-processing, std-function, stdthread

我是 std::thread 的新手，我尝试编写一个`parallel_for`. 我编码了以下内容：

```
// parallel_for.cpp
// compilation: g++ -O3 -std=c++0x parallel_for.cpp -o parallel_for -lpthread
// execution: time ./parallel_for 100 50000000 
// (100: number of threads, 50000000: vector size)
#include <iostream>
#include <iomanip>
#include <cstdlib>
#include <vector>
#include <thread>
#include <cmath>
#include <algorithm>
#include <numeric>
#include <utility>

// Parallel for
template<typename Iterator, class Function>
void parallel_for(const Iterator& first, const Iterator& last, Function&& f, const int nthreads = 1, const int threshold = 1000)
{
    const unsigned int group = std::max(std::max(1, std::abs(threshold)), (last-first)/std::abs(nthreads));
    std::vector<std::thread> threads;
    for (Iterator it = first; it < last; it += group) {
        threads.push_back(std::thread([=](){std::for_each(it, std::min(it+group, last), f);}));
    }
    std::for_each(threads.begin(), threads.end(), [=](std::thread& x){x.join();});
}

// Function to apply
template<typename Type>
void f1(Type& x)
{
    x = std::sin(x)+std::exp(std::cos(x))/std::exp(std::sin(x)); 
}

// Main
int main(int argc, char* argv[]) {

    const unsigned int nthreads = (argc > 1) ? std::atol(argv[1]) : (1);
    const unsigned int n = (argc > 2) ? std::atol(argv[2]) : (100000000);
    double x = 0;
    std::vector<double> v(n);
    std::iota(v.begin(), v.end(), 0);

    parallel_for(v.begin(), v.end(), f1<double>, nthreads);

    for (unsigned int i = 0; i < n; ++i) x += v[i];
    std::cout<<std::setprecision(15)<<x<<std::endl;
    return 0;
} 
```

但这不起作用：（来自 g++ 4.6 的错误代码）

```
parallel_for.cpp: In instantiation of ‘parallel_for(const Iterator&, const Iterator&, Function&&, int, int) [with Iterator = __gnu_cxx::__normal_iterator<double*, std::vector<double> >, Function = void (&)(double&)]::<lambda()>’:
parallel_for.cpp:22:9:   instantiated from ‘void parallel_for(const Iterator&, const Iterator&, Function&&, int, int) [with Iterator = __gnu_cxx::__normal_iterator<double*, std::vector<double> >, Function = void (&)(double&)]’
parallel_for.cpp:43:58:   instantiated from here
parallel_for.cpp:22:89: erreur: field ‘parallel_for(const Iterator&, const Iterator&, Function&&, int, int) [with Iterator = __gnu_cxx::__normal_iterator<double*, std::vector<double> >, Function = void (&)(double&)]::<lambda()>::__f’ invalidly declared function type 
```

如何解决这个问题呢 ？

编辑：这个新版本编译但没有给出好的结果：

```
// parallel_for.cpp
// compilation: g++ -O3 -std=c++0x parallel_for.cpp -o parallel_for -lpthread
// execution: time ./parallel_for 100 50000000 
// (100: number of threads, 50000000: vector size)
#include <iostream>
#include <iomanip>
#include <cstdlib>
#include <vector>
#include <thread>
#include <cmath>
#include <algorithm>
#include <numeric>
#include <utility>

// Parallel for
template<typename Iterator, class Function>
void parallel_for(const Iterator& first, const Iterator& last, Function&& f, const int nthreads = 1, const int threshold = 1000)
{
    const unsigned int group = std::max(std::max(1, std::abs(threshold)), (last-first)/std::abs(nthreads));
    std::vector<std::thread> threads;
    for (Iterator it = first; it < last; it += group) {
        threads.push_back(std::thread([=, &f](){std::for_each(it, std::min(it+group, last), f);}));
    }
    std::for_each(threads.begin(), threads.end(), [](std::thread& x){x.join();});
}

// Function to apply
template<typename Type>
void f(Type& x)
{
    x = std::sin(x)+std::exp(std::cos(x))/std::exp(std::sin(x)); 
}

// Main
int main(int argc, char* argv[]) {

    const unsigned int nthreads = (argc > 1) ? std::atol(argv[1]) : (1);
    const unsigned int n = (argc > 2) ? std::atol(argv[2]) : (100000000);
    double x = 0;
    double y = 0;
    std::vector<double> v(n);

    std::iota(v.begin(), v.end(), 0);
    std::for_each(v.begin(), v.end(), f<double>);
    for (unsigned int i = 0; i < n; ++i) x += v[i];

    std::iota(v.begin(), v.end(), 0);
    parallel_for(v.begin(), v.end(), f<double>, nthreads);
    for (unsigned int i = 0; i < n; ++i) y += v[i];

    std::cout<<std::setprecision(15)<<x<<" "<<y<<std::endl;
    return 0;
} 
```

结果是：

```
./parallel_for 1 100
155.524339894552 4950 
```

并行版本返回 4950，而顺序版本返回 155..... 问题出在哪里？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-26T19:57:32.440

您需要在 (last-first) 进行强制转换或类型转换。原因是在模板参数推导期间从不进行类型转换。

这工作得很好（也解决了 DeadMG 和 Ben Voigt 发现的问题）。两个版本都给出 156608294.151782，n=100000000。

```
template<typename Iterator, class Function>
void parallel_for(const Iterator& first, const Iterator& last, Function&& f, const int nthreads = 1, const int threshold = 1000)
{
    const unsigned int group = std::max(std::max(ptrdiff_t(1), ptrdiff_t(std::abs(threshold))), ((last-first))/std::abs(nthreads));
    std::vector<std::thread> threads;
    threads.reserve(nthreads);
    Iterator it = first;
    for (; it < last-group; it += group) {
        threads.push_back(std::thread([=,&f](){std::for_each(it, std::min(it+group, last), f);}));
    }
    std::for_each(it, last, f); // last steps while we wait for other threads

    std::for_each(threads.begin(), threads.end(), [](std::thread& x){x.join();});
} 
```

由于步骤`for_each(it, last, f)`比其他步骤小，我们不妨在等待其他结果的同时使用调用线程完成该步骤。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T18:42:45.920

*   您必须通过引用来捕获函数。

    `[=, &f] () { /* your code */ };`

*   看代码。

    ```
    #include <iostream>

    template <class T>
    void foo(const T& t)
    {
        const int a = t;
        [&]
        {
            std::cout << a << std::endl;
        }();
    }

    int main()
    {
        foo(42);
        return 0;
    } 
    ```

    clang 给出 output `42`，但 g++ 抛出 warning:`‘a’ is used uninitialized in this function`和 prints `0`。看起来像一个错误。

    **解决方法**：使用`const auto`（用于代码中的变量`group`）。

    **UPD**：我想，就是这样。[http://gcc.gnu.org/bugzilla/show_bug.cgi?id=52026](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=52026)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-26T19:26:46.813

一个问题是这`it += group`可能是`last`合法的，但最终创造价值是未定义的行为。仅仅检查`it < last`为时已晚，无法解决这个问题。

您需要改为测试`last - it`while`it`仍然有效。（既不`it + group`也不`last - group`一定是安全的，虽然后者应该是由于`group`计算方式所致。）

例如：

```
template<typename Iterator, class Function>
void parallel_for(const Iterator& first, const Iterator& last, Function f, const int nthreads = 1, const int threshold = 100)
{
    const unsigned int group = std::max(std::max(1, std::abs(threshold)), (last-first)/std::abs(nthreads));
    std::vector<std::thread> threads;
    threads.reserve(nthreads);
    Iterator it = first;
    for (; last - it > group; it += group) {
        threads.push_back(std::thread([=, &f](){std::for_each(it, it+group, last), f);}));
    }
    threads.push_back(std::thread([=, &f](){std::for_each(it, last, f);}));

    std::for_each(threads.begin(), threads.end(), [](std::thread& x){x.join();});
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-26T18:57:01.300

你给`std::min(it+group, last)`，`std::for_each`但总是`group`加到最后。这意味着如果`last`不是`group`on from的倍数`it`，您将移动`it`过去`last`，即 UB。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-26T18:57:11.570

您需要通过引用捕获，并且您需要在（最后一个）进行强制转换或类型转换。原因是在模板参数推导期间从不进行类型转换。

此外，修复 DeadMG 发现的问题，最终得到以下代码。

它工作得很好，两个版本都给出了 n=100000000 的 156608294.151782。

```
template<typename Iterator, class Function>
void parallel_for(const Iterator& first, const Iterator& last, Function&& f, const int nthreads = 1, const int threshold = 1000)
{
    const unsigned int group = std::max(std::max(ptrdiff_t(1), ptrdiff_t(std::abs(threshold))), ((last-first))/std::abs(nthreads));
    std::vector<std::thread> threads;
    Iterator it = first;
    for (; it < last-group; it += group) {
        threads.push_back(std::thread([=,&f](){std::for_each(it, std::min(it+group, last), f);}));
    }
    std::for_each(it, last, f); // use calling thread while we wait for the others
    std::for_each(threads.begin(), threads.end(), [](std::thread& x){x.join();});
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-01-08T15:56:34.517

vc11 解决方案，如果它不适用于 gcc，请告诉我。

```
template<typename Iterator, class Function>
void parallel_for( const Iterator& first, const Iterator& last, Function&& f, const size_t nthreads = std::thread::hardware_concurrency(), const size_t threshold = 1 )
{
    const size_t portion = std::max( threshold, (last-first) / nthreads );
    std::vector<std::thread> threads;
    for ( Iterator it = first; it < last; it += portion )
    {
        Iterator begin = it;
        Iterator end = it + portion;
        if ( end > last )
            end = last;

        threads.push_back( std::thread( [=,&f]() {
            for ( Iterator i = begin; i != end; ++i )
                f(i);
        }));
    }
    std::for_each(threads.begin(), threads.end(), [](std::thread& x){x.join();});
} 
```

# php - 执行查询时发生错误

> ID：14044540
> 
> 赞同：0
> 
> 时间：2012-12-26T18:22:18.477
> 
> 标签：php, mysql, sql-update

我试图通过弹出窗口更新我的网站内容。我根据 ID 显示了内容，但是当我尝试提交时，弹出窗口出现错误

> 执行查询时发生错误。请将此错误通知网络开发人员。
> 
> 注意：您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的“WHERE textID=16”附近使用正确的语法

而且我似乎找不到错误。你能看见它吗？

这是我的完整代码：

```
 <!-- PHP -->
<?
    include('global.php');

    if(isset($_REQUEST['textID']))
        $textID = $_REQUEST['textID'];      
    if(isset($_REQUEST['textContent']))
        $textContent = $_REQUEST['textContent'];

            if($_POST){
            $query = "UPDATE text_tb SET ";
            $query = $query."textContent='".$textContent."', ";
            $query = $query."WHERE textID=".$textID.""; 
            //echo $query;
            ExecuteQuery($query);
            echo "<script type=\"text/javascript\">
                <!--
                window.close();
                //-->
                </script>";
            }
?>

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Full featured example</title>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<!-- TinyMCE -->
<script type="text/javascript" src="../jscripts/tiny_mce/tiny_mce.js"></script>
<script type="text/javascript">
    tinyMCE.init({
        // General options
        mode : "textareas",
        theme : "advanced",
        plugins : "autolink,lists,pagebreak,style,layer,table,save,advhr,advimage,advlink,emotions,iespell,inlinepopups,insertdatetime,preview,media,searchreplace,print,contextmenu,paste,directionality,fullscreen,noneditable,visualchars,nonbreaking,xhtmlxtras,template,wordcount,advlist,autosave,visualblocks",

        // Theme options
        theme_advanced_buttons1 : "newdocument,|,bold,italic,underline,strikethrough,|,justifyleft,justifycenter,justifyright,justifyfull,styleselect,fontselect,fontsizeselect",
        theme_advanced_buttons2 : "bullist,numlist,|,undo,redo,|,link,unlink,|,forecolor",
        theme_advanced_toolbar_location : "top",
        theme_advanced_toolbar_align : "left",
        theme_advanced_statusbar_location : "bottom",
        theme_advanced_resizing : false,

        // Example content CSS (should be your site CSS)
        content_css : "css/content.css",

        // Drop lists for link/image/media/template dialogs
        template_external_list_url : "lists/template_list.js",
        external_link_list_url : "lists/link_list.js",
        external_image_list_url : "lists/image_list.js",
        media_external_list_url : "lists/media_list.js",

        // Style formats
        style_formats : [
            {title : 'Bold text', inline : 'b'},
            {title : 'Red text', inline : 'span', styles : {color : '#ff0000'}},
            {title : 'Red header', block : 'h1', styles : {color : '#ff0000'}},
            {title : 'Example 1', inline : 'span', classes : 'example1'},
            {title : 'Example 2', inline : 'span', classes : 'example2'},
            {title : 'Table styles'},
            {title : 'Table row 1', selector : 'tr', classes : 'tablerow1'}
        ],
    });
</script>
<!-- /TinyMCE -->

</head>
<body role="application">

<form method="post" action="<?php $_PHP_SELF ?>">
    <div>
                <!-- Gets replaced with TinyMCE, remember HTML in a textarea should be encoded -->
        <div>
            <textarea id="textContent" name="textContent" rows="15" cols="80" style="width: 80%">
            <?
            $result = mysql_query("SELECT * FROM text_tb WHERE textID ='".$textID."'");
                                while($row = mysql_fetch_array($result)){
                                    echo $row['textContent'];
                                }
            ?>
            </textarea>
        </div>

        <!-- Some integration calls
        <a href="javascript:;" onclick="tinyMCE.get('textContent').show();return false;">[Show]</a>
        <a href="javascript:;" onclick="tinyMCE.get('textContent').hide();return false;">[Hide]</a>-->
        <br />
        <input type="submit" name="save" value="Submit" />
        <input type="reset" name="reset" value="Reset" />
    </div>
</form>

<!--<script type="text/javascript">
if (document.location.protocol == 'file:') {
    alert("The examples might not work properly on the local file system due to security settings in your browser. Please use a real webserver.");
}
</script>-->
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T18:27:23.823

问题是集合末尾的逗号。更改此行：

```
 $query = $query."textContent='".$textContent."', "; 
```

至：

```
 $query = $query."textContent='".$textContent."' "; 
```

# java - JAVA DOM：重复的属性

> ID：14044542
> 
> 赞同：0
> 
> 时间：2012-12-26T18:22:48.323
> 
> 标签：java, dom, attributes, html-parsing

我正在为 JAVA 使用 DOM 库，一些 XHTML 条目遇到了这个问题：

[致命错误] tree.xml:238:185：已经为元素“span”指定了属性“itemprop”。

这是有问题的 XHTML 部分：

```
<span class='fn' itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person' itemprop='name'>Rodrigo</span> 
```

是否存在允许 DOM 中重复属性的选项？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T19:02:00.163

我的理解是，[Microdata 规范](http://www.whatwg.org/specs/web-apps/current-work/multipage/microdata.html#microdata)只允许每个 HTML 元素使用一个 itemprop，这意味着您使用的 DOM 库正确地将其标记为无效标记。如果要指定多个值，则需要用空格分隔，如下所示：

```
<span class='fn' itemprop='author name' itemscope='itemscope' itemtype='http://schema.org/Person'>Rodrigo</span> 
```

顺便说一下，class 属性的工作方式相同。

# html - 高度：可滚动页面上的 100%

> ID：14044543
> 
> 赞同：1
> 
> 时间：2012-12-26T18:22:50.600
> 
> 标签：html, css

我正在创建一个博客页面，我需要一个 DIV 来占用所有可用宽度和高度的 100%。 ![在此处输入图像描述](../Images/ecb0e68265ccefd25608208988626294.png)

当我尝试使用`Height : 100%`时，DIV 只占用可见区域。所以，如果屏幕分辨率是 1920x1080，网站是 900x16000 大.... Height:100% 只给出 1080。在发布之前，我在这里看到了很多答案，但还没有设法让它发挥作用。

CSS：

```
#parent
{
    position : absolute;
    background: green;        
    height : 100%;
    width : 100%;
}
.child
{
   position: relative;
    float:left;
   background: red;
   height : 400px;
   width : 500px;
   border : 1px solid yellow;
   margin: 10px 10px 10px 10px;
} 
```

HTML：

```
<div id="parent">
    <div class="child"> Some text </div>
    <div class="child"> Some text </div>
    <div class="child"> Some text </div>
    <div class="child"> Some text </div>
    <div class="child"> Some text </div>
</div>
​ 
```

看看这个 JSFiddle： http: [//jsfiddle.net/acJVw/21/](http://jsfiddle.net/acJVw/21/) 我需要的是绿色区域占用所有可用空间，直到（可滚动）页面的最底部。​ 编辑：

**编辑：** 我必须稍微改变一下问题，因为答案适用于我提供的示例，但不适用于渐变背景。这是一个带有渐变和最小高度的新 JSFiddle：http: [//jsfiddle.net/acJVw/27/](http://jsfiddle.net/acJVw/27/)

渐变不会一直到页面底部，而是停止！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T18:37:48.173

使用最小高度而不是高度。即使它比可见屏幕大，它也会占用内容的空间。看看这个[小提琴](http://jsfiddle.net/acJVw/24/)

```
<div id="parent">
<div class="child"> Some text </div>
<div class="child"> Some text </div>
<div class="child"> Some text </div>
<div class="child"> Some text </div>
</div> 
```

和CSS

```
 #parent
{
position : absolute;
background: green;        
min-height : 100%;
width : 100%;
}
.child
{
position: relative;
float:left;
background: red;
height : 100px;
width : 500px;
border : 1px solid yellow;
margin: 10px 10px 10px 10px;
} 
```

**​编辑** ：如果您的内容大于您的屏幕宽度，那么您也可以尝试

> 最小宽度：100%；

**问题编辑后** 您的渐变正在停止，因为您没有在[小提琴](http://jsfiddle.net/acJVw/27/)中使用 min-height:100% 试试这个[小提琴](http://jsfiddle.net/acJVw/29/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T18:30:59.453

尝试;

在我的屏幕上它需要 100%？

```
 <style>
* {
    height: 100%;
    width: 100%;
    padding: 0;
    margin: 0;
}
#parent
{
    position : absolute;
    background: green;        
    min-height: 100%;
    min-width: 1024px;
    width: 100%;
    height: auto;

}
.child
{
   position: relative;
   float:left;
   background: red;
   height : 100px;
   width : 500px;
   border : 1px solid yellow;
   margin: 10px 10px 10px 10px;
}
​
</style>

<div id="parent">
    <div class="child"> Some text </div>
    <div class="child"> Some text </div>
    <div class="child"> Some text </div>
    <div class="child"> Some text </div>
</div> 
```

# c++ - Qt EnumProcess - 未解决的外部

> ID：14044546
> 
> 赞同：0
> 
> 时间：2012-12-26T18:23:13.783
> 
> 标签：c++, visual-studio-2010, qt, linker

我正在尝试使用以下专业文件编译 Qt 应用程序：

```
#-------------------------------------------------
#
# Project created by QtCreator 2012-12-26T16:41:05
#
#-------------------------------------------------

QT       += core gui

greaterThan(QT_MAJOR_VERSION, 4): QT += widgets

TARGET = AutoROP
TEMPLATE = app

SOURCES += main.cpp\
        mainwindow.cpp

HEADERS  += mainwindow.h

FORMS    += mainwindow.ui

LIBS += "D:/Program Files/Microsoft SDKs/Windows/v7.1/Lib/Psapi.Lib" 
```

我还在我的代码中包含了 windows.h 和 psapi.h 头文件，并尝试调用 EnumProcess（我在 win32 环境中）但我收到“在..中引用的未解析的外部符号 EnumProcess”，我不能解决这个问题。我尝试使用-lpsapi，尝试反转正斜杠和反斜杠.. 没有任何效果。

我哪里错了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T10:02:58.960

Solved with pragma directives.

# algorithm - 是否有可能开发一种算法来解决图同构？

> ID：14044550
> 
> 赞同：0
> 
> 时间：2012-12-26T18:23:25.600
> 
> 标签：algorithm, graph-theory

或者我需要为每个独特的图开发一个算法吗？给用户一种图，然后他们应该使用该界面将节点和边添加到初始图。然后他们提交图，算法应该确认用户的图是否与给定的图匹配。

该算法不仅需要确认每个节点的邻居，还需要确认每个节点和每条边都有正确的值。初始图总是有一个根节点，这是算法可以开始的地方。

我想知道我是否可以在一般意义上为这种算法开发逻辑，或者我是否需要为每个唯一图实际编写一个唯一算法。如果是后一种情况，这没什么大不了的，因为我只有大约 20 个独特的图表。

谢谢。我希望我很清楚。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T19:59:55.947

[图同构问题](http://en.wikipedia.org/wiki/Graph_isomorphism_problem)可能并不难。但是很难证明这个问题并不难。

这个问题有三种可能。
1\. 图同构问题是[NP-hard](http://en.wikipedia.org/wiki/NP-hard)。
2.图同构问题具有多项式时间解。
3.图同构问题既不是NP-hard也不是P。

如果两个图是同构的，那么这个同构存在一个排列。以这个排列为证明，我们可以证明这两个图在多项式时间内彼此同构。因此，图同构位于 NP 集的范围内。然而，30 多年来没有人能够证明这个问题是 NP-hard 还是 P。因此，尽管问题描述很简单，但这个问题本质上是困难的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T18:45:13.727

If I understand the question properly, you can have ONE single algorithm, which will work by accepting one of several *reference* graphs as its input (in addition to the input of the unknown graph which isomorphism with the reference graph is to be asserted).

It appears that you seek to assert whether a given graph is *exactly* identical to another graph rather than asserting if the graphs are isomorph relative to a particular set of operations or characteristics. This implies that the algorithm be supplied some *specific* reference graph, rather than working off some set of "abstract" rules such as whether neither graphs have loops, or both graphs are fully connected etc. even though the graphs may differ in some other fashion.

**Edit**, following confirmation that:
*Yeah, the algorithm would be supplied a reference graph (which is the answer), and will then check the user's graph to see if it is isomorphic (including the values of edges and nodes) to the reference*

In that case, **yes, it is quite possible to develop a relatively simple algorithm** which would assert isomorphism of these two graphs. Note that the considerations mentioned in other remarks and answers and relative to the fact that the problem may be ***NP-Hard*** are merely indicative that a simple algorithm [or *any* algorithm for that matter] may not be sufficient to solve the problem *in a reasonable amount of time* for graphs which size and complexity are too big. However, assuming relatively small graphs and taking *advantage* (!) of the requirement that the weights of edges and nodes also need to match, the following algorithm should generally be applicable.

**General idea**:
For each sub-graph that is disconnected from the rest of the graph, identify one (or possibly several) node(s) in the user graph which must match a particular node of the reference graph. By following the paths from this node [in an orderly fashion, more on this below], assert the identity of other nodes and/or determine that there are some nodes which cannot be matched (and hence that the two structures are not isomorphic).

***Rough*** **pseudo code**:
1\. For both the reference and the user supplied graph, **make the the list of their** [***Connected Components***](http://en.wikipedia.org/wiki/Connected_component_%28graph_theory%29) i.e. the list of sub-graphs therein which are disconnected from the rest of the graph. Finding these connected components is done by following either a breadth-first or a depth-first path from starting at a given node and "marking" all nodes on that path with an arbitrary [typically incremental] element ID number. Once a given path has been fully visited, repeat the operation from any other non-marked node, and do so until there are no more non-marked nodes.

2\. Build a **"database" of the characteristics of each graph**. This will be useful to identify matching candidates and also to determine, early on, instances of non-isomorphism. Each "database" would have two kinds of "records" : node and edge, with the following fields, respectively: - node_id, Connected_element_Id, node weight, number of outgoing edges, number of incoming edges, sum of outgoing edges weights, sum of incoming edges weight. node - edge_id, Connected_element_Id, edge weight, node_id_of_start, node_id_of_end, weight_of_start_node, weight_of_end_node

3\. Build a **database of the Connected elements** of each graph
Each record should have the following fields: Connected_element_id, number of nodes, number of edges, sum of node weights, sum of edge weights.

4\. [optionally] **Dispatch the easy cases of non-isomorphism**:
  4.a mismatch of the number of connected elements
  4.b mismatch of of number of connected elements, grouped-by all fields but the id (number of nodes, number of edges, sum of nodes weights, sum of edges weights)

5\. For each connected element in the reference graph
5.1 Identify candidates for the matching connected element in the user-supplied graph. The candidates must have the same connected element characteristics (number of nodes, number of edges, sum of nodes weights, sum of edges weights) *and* contain the same list of nodes and edges, again, counted by grouping by all characteristics but the id.
5.2 For each candidate, finalize its confirmation as an isomorph graph relative to the corresponding connected element in the reference graph. This is done by starting at a candidate node-match, i.e. a node, hopefully unique which has the exact same characteristics on both graphs. In case there is not such a node, one needs to disqualify each possible candidate until isomorphism can be confirmed (or all candidates are exhausted). For the candidate node match, walk the graph, in, say, breadth first, and by finding matches for the other nodes, on the basis of the direction and weight of the edges and weight of the nodes.

The main tricks with this algorithm is are to keep proper accounting of the candidates (whether candidate connected element at higher level or candidate node, at lower level), and to also remember and mark other identified items as such (and un-mark them if somehow the hypothetical candidate eventually proves to not be feasible.)

I realize the above falls short of a formal algorithm description, but that should give you an idea of what is required and possibly a starting point, would you decide to implement it.

You can remark that the requirement of matching nodes and edges weights may appear to be an added *difficulty* for asserting isomorphism, effectively *simplify* the algorithm because the underlying node/edge characteristics render these more unique and hence make it more likely that the algorithm will a) find unique node candidates and b) either quickly find other candidates on the path and/or quickly assert non-isomorphism.

# inversion-of-control - SimpleIoc.Default.GetInstance 和 ServiceLocator.Current.GetInstance 之间有区别吗

> ID：14044551
> 
> 赞同：9
> 
> 时间：2012-12-26T18:23:28.213
> 
> 标签：inversion-of-control, mvvm-light

我正在使用适用于 Windows 8 的 MVVM Light 第 4 版；它包括 SimpleIOC。在各种示例中，我有时会看到基于 SimpleIoc 请求对象的代码......有时它基于 ServiceLocator......

示例包括：

userToken = SimpleIoc.Default.GetInstance();

mainVM = ServiceLocator.Current.GetInstance();

使用 SimpleIoc.Default.GetInstance 和 ServiceLocator.Current.GetInstance 有什么区别？

如果没有区别，ServiceLocator 是否只是让我可以选择改变我对要使用的 IOC 库的想法？如果我对 SimpleIoc 感到满意，ServiceLocator 是否只是提供了一个无关紧要的附加抽象层？或者，ServiceLocator 是否执行了其他一些对我们 IOC 新手来说并不明显的有用魔法？

感谢您的洞察力！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-02T14:41:22.647

在您的 ViewModelLocator 类中，您可能有以下代码行：

```
public ViewModelLocator()
{
  ServiceLocator.SetLocatorProvider(() => SimpleIoc.Default); 
```

`SimpleIoc`实现`IServiceLocator`接口，这意味着`ServiceLocator`调用时将使用它作为 DI 源。

编辑：

好的，人们想要“全脂且不放过奶油”的答案。开始了！

`ServiceLocator`基本上是一个外壳。服务定位器的代码是：

```
public static class ServiceLocator
{
  private static ServiceLocatorProvider currentProvider;

  public static IServiceLocator Current
  {
    get
    {
      return ServiceLocator.currentProvider();
    }
  }

  public static void SetLocatorProvider(ServiceLocatorProvider newProvider)
  {
    ServiceLocator.currentProvider = newProvider;
  }
} 
```

是的，就是这样。

是什么`ServiceLocatorProvider`？它是一个委托，它返回一个实现`IServiceLocator`.

`SimpleIoc`实现`IServiceLocator`。所以当我们这样做时：

```
ServiceLocator.SetLocatorProvider(() => SimpleIoc.Default); 
```

我们将`SimpleIoc`对象放入`ServiceLocator`. 您现在可以使用其中任何一个，因为无论您调用`ServiceLocator.Current`还是`SimpleIoc.Default`返回相同的对象实例。

那么，两者之间有什么区别吗？

```
userToken = SimpleIoc.Default.GetInstance();

mainVM = ServiceLocator.Current.GetInstance(); 
```

?

没有。没有任何。两者都是暴露静态属性的单例，该属性是`IServiceLocator`. 如上所述，`IServiceLocator`无论您调用哪个，您都将返回相同的对象实例。

`ServiceLocator.Current.GetInstance()`您可能想要使用而不是使用的唯一原因`SimpleIoc.Default.GetInstance()`是，在将来的某个时候您可能会更改 DI 容器，如果您使用`ServiceLocator`，则不必更改代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-28T08:58:00.417

根据 Bugnion 先生在 MSDN 上的[文章](http://msdn.microsoft.com/en-us/magazine/jj991965.aspx)（在“注册类的各种方法”一节中），我假设 IoC 提供程序的可互换性是使用 ServiceLocator 的唯一原因。

正如@FasterSolutions 所说，SimpleIoc 实现了 IServiceLocator，所以我*怀疑*与您关于抽象层的说法相反的是正确的。我认为您应该使用 ServiceLocator，但这没有经验证据；也许有人可以证明我错了（？）

# ruby-on-rails - 管理员在显示前批准回形针图像

> ID：14044556
> 
> 赞同：0
> 
> 时间：2012-12-26T18:23:55.097
> 
> 标签：ruby-on-rails, ruby-on-rails-3, paperclip, activeadmin

Rails：如何添加管理员批准功能，其中用户上传的图像必须在其个人资料中显示之前获得批准？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T19:03:43.710

如何在用户头像上添加一列，上面写着`admin_approved`或类似的东西？由于您使用的是 ActiveAdmin，因此它应该选择该列（除非您另有指定）。然后在显示图像之前添加一个检查：

```
<%= user_images.each do |image| %>
   <% if image.admin_approved %>
     <%= image_tag image.url %>
   <% end %>
<% end %> 
```

# android - SQL Android 错误：没有这样的表

> ID：14044558
> 
> 赞同：0
> 
> 时间：2012-12-26T18:24:17.093
> 
> 标签：android, sql

因此，每次我在位于 AddContacts 类中的 EditText 字段中输入数据时，我的对话框都会说我已经成功添加了信息，但是在日志 cat 中它说没有这样的表：contactsTable。我认为错误在我的数据库类中的 onCreate 和 onUpdate 方法中，但我不知道该怎么做

代码：

```
package com.example.myfirstapp;

import android.content.ContentValues;
import android.content.Context;
import android.database.Cursor;
import android.database.SQLException;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteOpenHelper;

public class DatabaseTable {
private static final String TAG = "ContactsDatabase";

//The columns we'll include in the contacts table
public static final String COL_ID = "ID";
public static final String COL_NAME = "NAME";
public static final String COL_EMAIL = "EMAIL";

private static final String DATABASE_NAME = "CONTACT";
private static final String DATABASE_TABLE = "contactsTable";
private static final int DATABASE_VERSION = 1;
private Context ourContext;
private DbHelper DBHelper;
private SQLiteDatabase db;
private static final String DATABASE_CREATE = 
        "CREATE TABLE " + DATABASE_TABLE + " (" +
         COL_ID + " INTEGER PRIMARY KEY AUTOINCREMENT, " +
         COL_NAME + " TEXT NOT NULL, " + 
         COL_EMAIL + " TEXT NOT NULL);";

    private static class DbHelper extends SQLiteOpenHelper {

        DbHelper(Context context) {
            super(context, DATABASE_NAME, null, DATABASE_VERSION);
        }

        public void onCreate(SQLiteDatabase db) {
            try {
                db.execSQL(DATABASE_CREATE);
            } catch (SQLException e) {
                e.printStackTrace();
            }
    }

        @Override
        public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
            db.execSQL("DROP TABLE IF EXISTS " + DATABASE_TABLE);
            onCreate(db);
        }
    }

        public DatabaseTable(Context context) {
            ourContext = context;
        }

        public DatabaseTable open() throws SQLException {
            DBHelper = new DbHelper(ourContext);
            db = DBHelper.getWritableDatabase();
            return this;
        }

        public void close() {
            DBHelper.close();
        }

        public long insertContact(String name, String email) {
            ContentValues initialValues = new ContentValues();
            initialValues.put(COL_NAME, name);
            initialValues.put(COL_EMAIL, email);
            return db.insert(DATABASE_TABLE, null, initialValues);
        }

        public void deleteRecord(long rowId)
        {
            db.delete(DATABASE_TABLE, COL_ID + "=" + rowId, null);
        }

        public Cursor getAllRecords() {
            return db.query(DATABASE_TABLE, new String[] {COL_ID, COL_NAME, COL_EMAIL}, null, 
                    null, null, null, null);
        }

        public Cursor getRecord(long rowId) throws SQLException {

            Cursor cursor = db.query(true, DATABASE_TABLE, new String[] {COL_ID, COL_NAME,
                    COL_EMAIL}, COL_ID + "=" + rowId, null, null, null, null, null);

            if (cursor != null)
                cursor.moveToFirst();

            return cursor;
            }

        public boolean updateRecord(long rowId, String name, String email) {
            ContentValues content = new ContentValues();
            content.put(COL_NAME, name);
            content.put(COL_EMAIL, email);
            return db.update(DATABASE_TABLE, content, COL_ID + "=" + rowId, null) > 0;
        } 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T18:35:55.033

你`DATABASE_TABLE`在运行你的应用程序至少一次后改变了吗？如果是这样，您需要更新 SQLite 架构，最简单的方法是 make `DATABASE_VERSION = 2;`。另外Android对主键很讲究，应该`COL_ID`改成`"_id"`.

`DATABASE_VERSION`将来，每次更改`CREATE_TABLE`语句时都必须递增。否则 SQLite 将没有当前信息。

# internet-explorer - 是否可以从浏览器运行 VBScript 文件（.vbs）？

> ID：14044561
> 
> 赞同：4
> 
> 时间：2012-12-26T18:24:34.240
> 
> 标签：internet-explorer, vbscript

我有 10 个 .vbs 文件并将它们合并到一个 .vbs 文件中，即 Main.vbs。现在，如果我双击 main.vbs，我的脚本开始运行。但无论如何我都在寻找可以从网络浏览器运行 .vbs 文件吗？这样就没有人需要去 Main.vbs 保存的目录并双击它。

我的 Main.VBS 内容：

```
Dim oShell : Set oShell = WScript.CreateObject ("WScript.Shell")
Dim FSO : Set FSO = CreateObject("Scripting.FileSystemObject")
oShell.CurrentDirectory = FSO.GetFile(Wscript.ScriptFullName).ParentFolder
oShell.run "A.VBS", 1, True
oShell.run "B.VBS", 1, True
oShell.run "C.VBS", 1, True
oShell.run "D.VBS", 1, True 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-26T18:51:03.020

是的，如果您使用 Internet Exlorer，您可以，但您必须将 IE 安全设​​置保持在较低水平才能运行它，即使这样您也可能会收到确认提示。这一切都取决于 Windows 的版本和 SP、安全更新、IE 的版本以及 IE 中的设置。

我建议再看一下为什么要以这种方式启动本地脚本。您可以轻松制作和分发启动脚本的快捷方式，而无需麻烦的设置和提示。

如果您需要一个用户界面，您可以使用内置 Vbscript，或者您可以使用 .HTA 文件而不是 .html 或 .asp 文件，这些文件的安全性问题较少。

示例：test.html

```
<script type="text/vbscript" src="c:\temp\test.vbs"></script> 
```

和 test.vbs

```
Const ForReading = 1, ForWriting = 2
Set fso = CreateObject("Scripting.FileSystemObject")
Set writefile = fso.OpenTextFile("c:\temp\output.txt", ForWriting, True)
writefile.write "test"
writefile.close 
```

当我加载 test.html 时，我得到两个提示，当我确认时，我在 c:\temp 中得到 output.txt

最后这里是一个带有 .hta 文件的示例，将其保存为例如 test.hta，在使用 ActiveX 或 Vbscript 时总是使用 IE

```
<HTML>
<HEAD>
<SCRIPT language="VBScript">
<!--
Const ForReading = 1, ForWriting = 2
Set fso = CreateObject("Scripting.FileSystemObject")
Set writefile = fso.OpenTextFile("c:\temp\output.txt", ForWriting, True)
writefile.write "test"
writefile.close
'-->
</SCRIPT>
</HEAD>
<BODY>
</BODY>
</HTML> 
```

或者

```
<HTML>
<HEAD>
<script type="text/vbscript">
  sub test
    const runminimized = 7
    const dont_wait_for_end = false
    Set wshShell = CreateObject("WScript.Shell")
    WshShell.Run "c:\temp\test.vbs",runminimized, dont_wait_for_end
  end sub
</script>
</HEAD>
<BODY>
  these are the instructions
  <button onclick="vbscript:test" >Run the script</button>
</BODY>
</HTML> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T18:29:42.213

您可以公开一个包含脚本文件的经典 ASP 页面，执行它们并向浏览器报告结果。

Asp 页面由 IIS 提供服务（取决于您可能需要配置 ASP 设置的版本），并且可以从任何浏览器运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T18:54:27.063

对于 VBSlover 的目的，最好的方法是编写一个[HTML 应用程序](http://msdn.microsoft.com/en-us/library/ms536496%28v=vs.85%29.aspx)（不需要网络服务器的额外复杂性，没有像普通客户端 .html 脚本那样的安全问题）。当然，仅仅围绕现有的 VBScript 代码包装一些 HTML 代码将是致命的，您必须设计一个有用的 GUI 并将现有功能分发到合适的事件处理程序中。绝对不是一个可以通过在此处发布一连串问题来解决的项目-您自己的一些仔细研究是**必要**的起点/先决条件。

# jquery - 粘性导航隐藏在页面顶部

> ID：14044562
> 
> 赞同：0
> 
> 时间：2012-12-26T18:24:49.887
> 
> 标签：jquery, navigation, hide, sticky

我正在寻找一段将我的粘性导航隐藏在页面顶部的脚本。因此，当您向下滚动进入该站点时，它应该开始可见。

这是我正在建设的网站：http: [//kmnew.kadushimarketing.com/index.php](http://kmnew.kadushimarketing.com/index.php)

这是我目前正在使用的脚本：

```
$(function() {

    // grab the initial top offset of the navigation 
    var sticky_navigation_offset_top = $('#sticky_navigation').offset().top;

    // our function that decides weather the navigation bar should have "fixed" css position or not.
    var sticky_navigation = function(){
        var scroll_top = $(window).scrollTop(); // our current vertical position from the top

        // if we've scrolled more than the navigation, change its position to fixed to stick to top, otherwise change it back to relative
        if (scroll_top > sticky_navigation_offset_top) { 
            $('#sticky_navigation').css({ 'position': 'fixed', 'top':0, 'left':0 });
        } else {
            $('#sticky_navigation').css({ 'position': 'relative' }); 
        }   
    };

    // run our function on load
    sticky_navigation();

    // and run it again every time you scroll
    $(window).scroll(function() {
         sticky_navigation();
    });

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T19:11:34.293

我知道了。我将脚本更改为：

```
$(document).ready(function(){

    // hide #sticky_navigation first
    $("#sticky_navigation").hide();

    // fade in #sticky_navigation
    $(function () {
        $(window).scroll(function () {
            if ($(this).scrollTop() > 100) {
                $('#sticky_navigation').fadeIn();
            } else {
                $('#sticky_navigation').fadeOut();
            }
        });

    });

}); 
```

然后我还添加了位置：固定到我的 css。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T18:34:48.487

我不确定这是否是你要找的。如果滚动顶部大于您的窗口高度，则显示并将其放在顶部

```
$(function() {

    // grab the initial top offset of the navigation 
    var sticky_navigation_offset_top = $('#sticky_navigation').offset().top;

    // our function that decides weather the navigation bar should have "fixed" css position or not.
    var sticky_navigation = function(){
        var scroll_top = $(window).scrollTop(); // our current vertical position from the top
        var windowHeight = $(window).height();

        // if we've scrolled more than the navigation, change its position to fixed to stick to top, otherwise change it back to relative
        if (scroll_top > windowHeight) { 
            $('#sticky_navigation').css({ 'position': 'fixed', 'top':0, 'left':0, 'display': 'block' });
        } else {
            $('#sticky_navigation').css({ 'position': 'relative', 'display': 'none' }); 
        }   
    };

    // run our function on load
    sticky_navigation();

    // and run it again every time you scroll
    $(window).scroll(function() {
         sticky_navigation();
    });

}); 
```

# android - 连接免提时如何将录音源设置为设备麦克风？

> ID：14044563
> 
> 赞同：2
> 
> 时间：2012-12-26T18:25:02.513
> 
> 标签：android, audiorecord

在[这个问题](https://stackoverflow.com/questions/12578972/android-audio-recording-using-phone-microphone-when-handsfree-is-attached)之后，我`AudioRecord`用来从内部设备麦克风录制如下：

```
 recorder = new AudioRecord(AudioSource.MIC, sRate,
                AudioFormat.CHANNEL_IN_MONO,
                AudioFormat.ENCODING_PCM_16BIT, N); 
```

连接耳机时，我需要从**内部麦克风**录制（而不是耳机的麦克风）。`setParameters()`, `setRouting()`,`setMode()`方法`AudioRecord`有用吗？

# java - Applet jna.jar - java.lang.UnsatisfiedLinkError：无法加载库

> ID：14044564
> 
> 赞同：0
> 
> 时间：2012-12-26T18:25:16.487
> 
> 标签：java, jna, japplet

下面是我的 HTML 代码

```
<html>
<head>
<title></title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
</head>
<body>
<applet codebase ="." code="CallApplet.class"
        archive="CallApplet.jar,jna.jar,platform.jar"
        height="100" width="100"/>
</body>
</html> 
```

以上html文件和所有jar都在同一个文件夹中

我在这里做错了什么，我收到错误 java.lang.NoClassDefFoundError: com/sun/jna/Library

如果您想查看我的小程序代码，请转到[Applet 在 eclipse 中运行但不在浏览器中运行 - java security](https://stackoverflow.com/questions/14037271/applet-runs-in-eclipse-but-not-in-browser-java-security)

更新

我需要签署所有外部 jar 文件 [jna 和平台]

现在我收到错误 - java.lang.UnsatisfiedLinkError：无法加载库“TSCLIB”：找不到指定的模块。

基本上这个错误是因为它试图访问放置在 system32 文件夹中的 DLL 文件。有人可以帮忙吗

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-27T07:31:50.597

我想我通过小程序学到了一些关于 JNA 的知识

1.  首先使用 jarsigner 验证所有 jar 是否都已正确签名。

2.  在我的情况下，eclipse 使用 64 位 JVM 运行（因此 applet 在其中运行良好）而 chrome 使用 32 位运行，所以我不得不为不同的 JVM 使用不同的 dll。我也将dll文件放在system32之外，比如c：并通过System.load使用绝对路径加载它（我相信这可以是动态的）。

希望这会在使用 JNA 开发小程序时对其他人有所帮助

# java - 无法调试 intellij 插件 - 初始堆大小无效

> ID：14044572
> 
> 赞同：2
> 
> 时间：2012-12-26T18:26:12.340
> 
> 标签：java, intellij-idea, jvm-arguments

我正在开发一个 intellij 插件，当我尝试运行插件（或调试它）时，我不断收到以下错误：

> 无法创建Java虚拟机。无效的初始堆大小：-Xms128m

Run\Debug 配置中的 JVM 参数是（默认情况下）：

> -Xms128m -Xmx512m -XX:MaxPermSize=250m -XX:ReservedCodeCacheSize=64m -XX:+UseCodeCacheFlushing -ea -Dsun.io.useCanonCaches=false

所以最终我无法调试或运行我的代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-03-25T10:49:52.447

JVM 很不高兴，因为选项之间有换行符。*您可以通过将VM 选项*复制粘贴到文本编辑器中来确认这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T16:17:48.360

我今天遇到了同样的问题。我通过勾选并选择IDEA Plugin Sdk解决了这个问题。我的Idea版本是11.1.5。你可以试试..

# c++-cli - Form.cpp(16)：错误 C2061：语法错误：标识符“Form1”

> ID：14044578
> 
> 赞同：1
> 
> 时间：2012-12-26T18:26:39.063
> 
> 标签：c++-cli, windows-forms-designer

我正在尝试开始使用 Windows 窗体...并且我尝试通过课程制作程序...但它不起作用，我不明白为什么。如果有人可以帮助我，那就太好了。

### 我的错误：

```
1>ClCompile:
1>  stdafx.cpp
1>  AssemblyInfo.cpp
1>  Form.cpp
1>Form.cpp(16): error C2872: 'Form1' : ambiguous symbol
1>          could be 'Form1'
1>          or       'c:\users\mizuru\documents\visual studio 2010\projects\form\form\Form1.h(15) : Form1::Form1'
1>Form.cpp(16): error C2061: syntax error : identifier 'Form1'
1>  Generating Code...
1>
1>Build FAILED. 
```

### 表格.cpp

```
// Form.cpp : main project file.
    #include "stdafx.h"
    #include "Form1.h"

    using namespace Form1;

    [STAThreadAttribute]
    int main(array<System::String ^> ^args)
    {
        // Enabling Windows XP visual effects before any controls are created
        Application::EnableVisualStyles();
        Application::SetCompatibleTextRenderingDefault(false); 

        // Create the main window and run it
        Application::Run(gcnew Form1());
        return 0;
    } 
```

### 表格1.h

```
#pragma once

namespace Form1 {

    using namespace System;
    using namespace System::ComponentModel;
    using namespace System::Collections;
        using namespace System::Windows::Forms;
        using namespace System::Data;
        using namespace System::Drawing;

        /// <summary>
        /// Summary for Form1
        /// </summary>
        public ref class Form1 : public System::Windows::Forms::Form
        {
        public:
            Form1(void)
            {
                InitializeComponent();
                //
                //TODO: Add the constructor code here
                //
            }

        protected:
            /// <summary>
            /// Clean up any resources being used.
            /// </summary>
            ~Form1()
            {
                if (components)
                {
                    delete components;
                }
            }
        private: System::Windows::Forms::Button^  button1;
        protected: 
        private: System::Windows::Forms::Label^  label1;
        private: System::Windows::Forms::TextBox^  textBox1;

        private:
            /// <summary>
            /// Required designer variable.
            /// </summary>
            System::ComponentModel::Container ^components;

    #pragma region Windows Form Designer generated code
            /// <summary>
            /// Required method for Designer support - do not modify
            /// the contents of this method with the code editor.
            /// </summary>
            void InitializeComponent(void)
            {
                this->button1 = (gcnew System::Windows::Forms::Button());
                this->label1 = (gcnew System::Windows::Forms::Label());
                this->textBox1 = (gcnew System::Windows::Forms::TextBox());
                this->SuspendLayout();
                // 
                // button1
                // 
                this->button1->Location = System::Drawing::Point(113, 181);
                this->button1->Name = L"button1";
                this->button1->Size = System::Drawing::Size(75, 23);
                this->button1->TabIndex = 0;
                this->button1->Text = L"button1";
                this->button1->UseVisualStyleBackColor = true;
                this->button1->Click += gcnew System::EventHandler(this, &Form1::button1_Click);
                // 
                // label1
                // 
                this->label1->AutoSize = true;
                this->label1->Location = System::Drawing::Point(104, 13);
                this->label1->Name = L"label1";
                this->label1->Size = System::Drawing::Size(35, 13);
                this->label1->TabIndex = 1;

        this->label1->Text = L"label1";
            // 
            // textBox1
            // 
            this->textBox1->Location = System::Drawing::Point(113, 110);
            this->textBox1->Name = L"textBox1";
            this->textBox1->Size = System::Drawing::Size(100, 20);
            this->textBox1->TabIndex = 2;
            this->textBox1->TextChanged += gcnew System::EventHandler(this, &Form1::textBox1_TextChanged);
            // 
            // Form1
            // 
            this->AutoScaleDimensions = System::Drawing::SizeF(6, 13);
            this->AutoScaleMode = System::Windows::Forms::AutoScaleMode::Font;
            this->ClientSize = System::Drawing::Size(284, 262);
            this->Controls->Add(this->textBox1);
            this->Controls->Add(this->label1);
            this->Controls->Add(this->button1);
            this->Name = L"Form1";
            this->Text = L"Form1";
            this->ResumeLayout(false);
            this->PerformLayout();

        }
#pragma endregion
    private: System::Void textBox1_TextChanged(System::Object^  sender, System::EventArgs^  e) {
                 label1->Text="";
             }
    private: System::Void button1_Click(System::Object^  sender, System::EventArgs^  e) {
                 label1->Text=textBox1->Text;
             }
    };
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T18:30:47.997

手头的问题是您的命名空间和表单类都共享名称`Form1`。您必须通过指定它是命名空间中的类来消除符号的歧义。

```
Application::Run(gcnew ::Form1::Form1()); 
```

# c++ - 使用从具体类的继承来实现纯虚方法 C++

> ID：14044583
> 
> 赞同：2
> 
> 时间：2012-12-26T18:27:09.440
> 
> 标签：c++, interface, multiple-inheritance, pure-virtual

我想使用具体类提供的实现从接口实现纯虚拟方法，而不必显式调用具体类中的方法。例子：

```
class InterfaceA{  
public:  
    virtual void foo() = 0;  
};

class InterfaceB:public InterfaceA{  
public:  
   virtual void bar() = 0;  
};

class ConcreteA : public InterfaceA{  
public:  
   virtual void foo(){}//implements foo() from interface  
};

class ConcreteAB: public InterfaceB, public ConcreteA{  
public:  
    virtual void bar(){}//implements bar() from interface  
}; 
```

在这种情况下，编译器要求在 ConcreteAB 类中实现 foo()，因为 InterfaceB 没有实现它并且它继承自 InterfaceA。

有一种方法可以告诉编译器使用来自 ConcreteA 的实现，而不使用调用 ConcreteA::foo() 的包装器？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-26T18:46:53.697

创建`InterfaceA`一个虚拟基类。

```
class InterfaceB : public virtual InterfaceA {  
public:  
   virtual void bar() = 0;  
};

class ConcreteA : public virtual InterfaceA {  
public:  
   virtual void foo(){}//implements foo() from interface  
}; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-26T18:58:05.623

你需要[虚拟继承](http://www.parashift.com/c++-faq/virtual-inheritance-where.html)。

位于层次结构顶部的接口 A 实际上应该由所有直接子类继承。

```
class InterfaceB:public virtual InterfaceA{  
public:  
   virtual void bar() = 0;  
};

class ConcreteA : public virtual InterfaceA{  
public:  
   virtual void foo(){}//implements foo() from interface  
}; 
```

# sockets - FreeBSD 内核模块中的 Socket 示例代码

> ID：14044586
> 
> 赞同：0
> 
> 时间：2012-12-26T18:27:35.257
> 
> 标签：sockets, kernel, freebsd

我需要一个简单的例子，比如作为 FreeBSD 内核模块（或系统调用）的 echo 服务器。我看过[OpenKETA](http://openketa.sourceforge.net/)，但是它的代码很大，理解和使用起来太难了。有一个简单的例子吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-14T07:13:09.863

您可能想查看 sosend(9) 系列函数的文档（man 9 sosend）。这些是在套接字上操作的内核例程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T02:04:31.297

不确定您要完成什么，而不是做广告，但根据这个问题，我建议您获取一份[Designing BSD Rootkits](http://nostarch.com/rootkits.htm) and [FreeBSD Device Drivers](http://nostarch.com/bsddrivers.htm)。我都读过，我认为它们会对你有所帮助。

# android - 当我点击返回按钮时，前一个活动中的值丢失了，但在调用 this.finish() 时没有

> ID：14044588
> 
> 赞同：5
> 
> 时间：2012-12-26T18:27:50.767
> 
> 标签：android, android-intent, android-activity, extra

所以我有一个奇怪的问题。我有 2 项活动正在进行。其中一个活动显示了一个 ListView，它的数据是通过一个长的 Extra 抓取的，我使用它通过 database.query 中的 WHERE 子句获取结果。当单击 ListView 项时调用另一个 Activity，允许某人为 ListView 添加一些内容到数据库中。

活动名称是`DaysActivity.java`（带有列表视图的活动）和`DayAddActivity.java`（允许某人添加一天的活动，然后显示在列表视图中`DaysActivity.java`）。

我遇到的问题是，当我`finish()` `DayAddActivity.java`返回`DaysActivity`并且 ListView 仍然完全填充时。但是，如果我点击后退按钮`DayAddActivity.java`（带有我的应用程序图标的操作栏中标题左侧的按钮），当它返回 DaysActivity.java 时，ListView 为空/消失。

这是两者的代码：

DaysActivity.java：

```
package com.gauvion.gfit;

import android.annotation.SuppressLint;
import android.app.ListActivity;
import android.content.Intent;
import android.content.SharedPreferences;
import android.database.Cursor;
import android.os.Bundle;
import android.view.Menu;
import android.view.MenuInflater;
import android.view.MenuItem;
import android.widget.SimpleCursorAdapter;
import android.widget.Toast;

public class DaysActivity extends ListActivity {

    private DaysDataSource datasource;
    private SimpleCursorAdapter dataAdapter;
    private boolean isEditing = false;
    private Toast toast_deleted;
    private String[] columns = new String[] { MySQLiteHelper.COLUMN_NAME, MySQLiteHelper.COLUMN_DAY };
    private int[] to;
    private long routineDataID;
    private String routineDataName;

    @SuppressLint("ShowToast")
    @Override
    public void onCreate(Bundle savedInstanceState) {       
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_days); 

        routineDataID = getIntent().getLongExtra("routineDataID", 0);
        routineDataName = getIntent().getStringExtra("routineDataName");
        setTitle(routineDataName);

        toast_deleted = Toast.makeText(this, "", Toast.LENGTH_SHORT);
        datasource = new DaysDataSource(this);
        datasource.open();

        Cursor cursor = datasource.fetchAllDays(routineDataID);
        to = new int[] { R.id.listitem_day_name, R.id.listitem_day_day };
        dataAdapter = new SimpleCursorAdapter(this, R.layout.listitem_day, cursor, columns, to, 0);
        setListAdapter(dataAdapter);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {     
        MenuInflater inflater = getMenuInflater();
        inflater.inflate(R.menu.activity_days, menu);
        return true;        
    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {     
        Cursor cursor = datasource.fetchAllDays(routineDataID);
        switch (item.getItemId()) {
        case R.id.button_days_add:
            Intent startDayAdd = new Intent(this, DayAddActivity.class);
            startDayAdd.putExtra("routineDataID", routineDataID);
            this.startActivity(startDayAdd);
            return true;

        case R.id.button_days_edit:
            to = new int[] { R.id.listitem_day_edit_name, R.id.listitem_day_edit_day };
            dataAdapter = new SimpleCursorAdapter(this, R.layout.listitem_day_edit, cursor, columns, to, 0);
            setListAdapter(dataAdapter);

            isEditing = true;
            invalidateOptionsMenu();
            return true;

        case R.id.button_days_edit_done:
            to = new int[] { R.id.listitem_day_name, R.id.listitem_day_day };
            dataAdapter = new SimpleCursorAdapter(this, R.layout.listitem_day, cursor, columns, to, 0);
            setListAdapter(dataAdapter);

            isEditing = false;
            invalidateOptionsMenu();
            return true;

        default:
            return super.onOptionsItemSelected(item);
        }
    }

    @Override
    public boolean onPrepareOptionsMenu(Menu menu) {
        super.onPrepareOptionsMenu(menu);

        menu.findItem(R.id.button_days_edit).setVisible(!isEditing);
        menu.findItem(R.id.button_days_edit_done).setVisible(isEditing);

        return true;
    }

    @Override
    protected void onResume() {
        datasource.open();
        Cursor cursor = datasource.fetchAllDays(routineDataID);
        dataAdapter.changeCursor(cursor);

        super.onResume();
    }

    @Override
    protected void onPause() {
        datasource.close();
        super.onPause();
    }

} 
```

DayAddActivity.java:

```
package com.gauvion.gfit;

import android.os.Bundle;
import android.app.Activity;
import android.view.Menu;
import android.view.MenuItem;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.Spinner;
import android.widget.Toast;
import android.support.v4.app.NavUtils;

public class DayAddActivity extends Activity {
    private RoutinesDataSource datasource;
    private EditText dayName;
    private Spinner dayDay;
    private Button saveButton;
    private long routineDataID;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_day_add);
        routineDataID = getIntent().getLongExtra("routineDataID", 0);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_day_add, menu);
        return true;
    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
        switch (item.getItemId()) {
        case android.R.id.home:
            NavUtils.navigateUpFromSameTask(this);
            return true;
        }
        return super.onOptionsItemSelected(item);
    }

    public void cancelDay(View view) {
        this.finish();
    }

} 
```

`cancelDay()`当在 中单击“取消”按钮时调用该函数`activity_day_add.xml`。就像我说的，当我单击 内部的“取消”按钮时`DayAddActivity.java`，它会返回`DaysActivity.java`并且 ListView 很好。所有数据都在那里。但是，如果我按下操作栏中的后退按钮（包含后退箭头的按钮和 Activity 标题旁边的我的应用程序图标）ListView 为`DaysActivity.java`空/消失，并且标题也是空的（因为这也生成通过一个额外的字符串值）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T19:13:44.457

您的游标不受活动管理，这可能导致内存泄漏甚至 ANR。您应该考虑使用加载器来使用游标填充列表。你可以在这里找到一个例子：http: [//developer.android.com/guide/components/loaders.html](http://developer.android.com/guide/components/loaders.html)。

加载器工作得更好，因为它们不会在获得与数据库的连接时冻结应用程序，并且它们将从您的活动的一个实例传递到另一个实例，从而防止内存泄漏和重用资源。

但同样，正如您之前的帖子：[Extras 似乎丢失了 onResume()](https://stackoverflow.com/questions/14041362/extras-seem-to-be-lost-onresume/14041421#comment19404459_14041421)，您应该了解 onSaveInstanceState 和 onCreate 之间的联系，以便将参数传递给您活动的未来自我。看这个帖子，得分最高的答案：[onSaveInstanceState() 和 onRestoreInstanceState()](https://stackoverflow.com/questions/4096169/onsaveinstancestate-and-onrestoreinstancestate)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T20:03:32.287

看来您的上下文在“this.startActivity(startDayAdd);”中有一些问题 线。尝试使用“DaysActivity.this.startActivity(startDayAdd);”。如果它不起作用，则使用断点逐行查看执行情况。

# java - Java do-while 循环不起作用

> ID：14044591
> 
> 赞同：0
> 
> 时间：2012-12-26T18:28:08.000
> 
> 标签：java, loops, do-while

我希望我的程序一直问这个问题，直到它得到它可以使用的响应，特别是从 0 到 20 的数字。我在这门课上有很多其他的东西，所以这里有一小段摘录，其中 do-while 是（我已经命名了变量以及所有内容）。

```
public static void main(String[] args) {
    do {
        halp = 1;
        System.out.println("What level is your fort?");
        Scanner sc = new Scanner(System.in);

        try { 
            fortLevel = Integer.parseInt(sc.nextLine()); 
        }
        catch(NumberFormatException e){System.out.println("Numbers only, 0-20"); halp = 0;
    }

    if(halp < 1) {
        work = false;
    }

    if(halp > 1) {
        work = true;
    }

    while(work = false);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T18:28:53.310

```
while(work = false); // here you are assigning false to work 
```

应该

```
while(work == false); //here you are checking if work is equal to false 
```

*   `=`用于赋值的赋值运算符
*   `==`一个相等运算符，用于检查两个操作数是否具有相同的值。

由于工作是布尔值，您甚至可以使用它：

```
while(!work) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-26T18:29:02.907

您在`while`表达式中使用了赋值：

```
while(work = false); 
```

您可以替换为

```
while(work == false); 
```

或更好

```
while(!work); 
```

* * *

如果变量`halp`并且`work`未在其他任何地方使用，则可以消除它们，从而为您提供：

```
do {
   System.out.println("What level is your fort?");
   Scanner sc = new Scanner(System.in);
   try {
    fortLevel = Integer.parseInt(sc.nextLine());
   } catch (NumberFormatException e) {
     System.out.println("Numbers only, 0-20");
   }

} while (fortLevel < 0 || fortLevel > 20); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T19:04:07.843

你也可以这样做：

```
if(!work) {break;} 
```

# css - 任何 iOS 网络浏览器是否都通过 CSS 支持 OpenType 字体功能？

> ID：14044593
> 
> 赞同：3
> 
> 时间：2012-12-26T18:28:34.337
> 
> 标签：css, fonts, webfonts, opentype

当前版本的桌面 Chrome 通过 CSS 支持 OpenType 功能。

1) 我的测试表明 iOS 5 上的 Safari 和 Chrome 都不支持 OpenType 功能。那正确吗？（我知道我有正确的`-webkit-font-feature-settings`CSS 标签，因为 OpenType 功能在桌面 Chrome 中运行良好。）

2) iOS 6 上的情况是否不同？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T13:17:37.293

[根据此页面](http://caniuse.com/font-feature)， iOS 似乎仅部分支持 OpenType 字体功能，但我不知道这些功能在多大程度上受支持，因为我链接的页面没有详细说明，而且我没有任何 iOS 设备。

# android - 在 Drawable 中使用位图时出现内存不足错误

> ID：14044594
> 
> 赞同：0
> 
> 时间：2012-12-26T18:28:38.097
> 
> 标签：android, sqlite, bitmap, drawable, out-of-memory

我正在开发墙纸应用程序。我将所有图像都存储在 Drawable 文件夹中。

`OutOfMemoryError`当我添加超过 30 张壁纸时，我得到了。我想知道如何克服这一点。

我应该保存我所有的图像`SQLite Database`然后从那里加载还是我必须做其他事情。

我尝试通过调整位图大小，`Decode Bitmap Factory`但由于图像质量降低，它没有达到我的目的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T18:34:45.533

在解码时调整图像大小只会让您`OutOfMemoryError`及时前进。该错误意味着您的应用程序泄漏了内存，或者试图使用比可用内存更多的内存。在 Android 上处理位图时，这种情况经常发生，因为限制设置在 25MB 左右，并且高分辨率屏幕越来越普遍。

您必须重新设计您的应用程序。没有必要在内存中保留 30 张图像，因为它们无法容纳在单个屏幕中 - 好吧，如果它们是缩略图大小，则在解码时调整它们的大小，并且内存中的像素总数与一张大图，这样您就不会耗尽内存。

`recycle()`当位图不可见时，您必须找到一种方法。如果您更好地描述您的应用程序，我们可以帮助您找到合适的时机，还可以预加载图像以获得响应式应用程序和更好的用户体验。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T08:47:10.333

我认为您需要做的是`Thumbnails`在屏幕上显示而不是可绘制的图像。您可以根据您的尺寸要求生成[缩略图和显示。](http://developer.android.com/reference/android/media/ThumbnailUtils.html#extractThumbnail%28android.graphics.Bitmap,%20int,%20int,%20int%29)并且每当用户单击时`Thumb`，只需采用原始路径并设置壁纸。

另一种选择是您可以使用[通用图像加载器](https://github.com/nostra13/Android-Universal-Image-Loader)，它可以帮助您将图像缓冲在磁盘中（如`SD card`或您的应用程序的`Internal memory`）。这样问题`Out of Memory`就可以解决了。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-29T08:55:47.567

如果您想控制应用程序的崩溃，请在**Exception**块中编写代码：

```
try {

    ...

    }
    catch(OutOfMemoryError error)  {
        //decide what to do when there is not more memory available
    } 
```

也请这个链接：

[关联](https://stackoverflow.com/questions/1955188/java-lang-outofmemoryerror-bitmap-size-exceeds-vm-budget-android-how-many-i)

# java - StringBuilder 和正则表达式解析

> ID：14044595
> 
> 赞同：2
> 
> 时间：2012-12-26T18:28:41.873
> 
> 标签：java, regex, stringbuilder

我有一个`StringBuilder`用于构建一个大字符串的`StringBuilder`对象，使用`"\n"`字符分隔对象中的字符串，如何在不拆分字符串并执行循环的情况下有效地围绕该对象构建正则表达式？

例如说我有以下正则表达式：

```
private static final regexPattern = "(([a-z[1-9]]+)||([1-9[a-z]]+))" 
```

如果我有这个：

```
String[] myStringList = aStringList.split("\n"); 
```

我正在尝试使用 regexPattern 和 myStringList 中的每个字符串构建一个有效的正则表达式。

```
Pattern p = Pattern.compile(regexPattern + myStringList[i]); 
```

有没有办法做到这一点而不将我的 stringBuilder 分成一个循环并检查每个字符串？我能以某种方式围绕整个 StringBuilder 对象构建一个大模式吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T18:40:05.787

这将从您的输入中构建一个大的“或”正则表达式，预先挂`regexPattern`在输入字符串的每个部分：

```
String bigRegex = "(" + regexPattern + aStringList.replace("\n", ")|(" + regexPattern) + ")"; 
```

这里有一些代码显示你得到了什么：

```
public static void main(String[] args) {
    String aStringList = "foo\nbar\nbaz";
    String bigRegex = "(" + regexPattern + aStringList.replace("\n", ")|(" + regexPattern) + ")";
    System.out.println(bigRegex);
    // Pattern p = Pattern.compile(bigRegex);
} 
```

输出：

```
((([a-z[1-9]]+)||([1-9[a-z]]+))foo)|((([a-z[1-9]]+)||([1-9[a-z]]+))bar)|((([a-z[1-9]]+)||([1-9[a-z]]+))baz) 
```

# java - 什么我无法从我的 jsp 连接到 mysql？

> ID：14044596
> 
> 赞同：0
> 
> 时间：2012-12-26T18:28:48.217
> 
> 标签：java

我无法从我的 jsp 连接到数据库。代码如下

```
 <% 
        try {
        /* Create string of connection url within specified format with machine name, 
        port number and database name. Here machine name id localhost and 
        database name is usermaster. */ 
        String connectionURL = "jdbc:mysql://localhost:3306/test"; 

        // declare a connection by using Connection interface 
        Connection connection = null; 

        // Load JBBC driver "com.mysql.jdbc.Driver" 
        Class.forName("com.mysql.jdbc.Driver").newInstance(); 

        /* Create a connection by using getConnection() method that takes parameters of 
        string type connection url, user name and password to connect to database. */ 
        connection = DriverManager.getConnection(connectionURL, "root", "pass");

        // check weather connection is established or not by isClosed() method 
        if(!connection.isClosed())
        %>
        <font size="+3" color="green"></b>
        <% 
        out.println("Successfully connected to " + "MySQL server using TCP/IP...");
        connection.close();
        }
        catch(Exception ex){
        %>
        </font>
        <font size="+3" color="red"></b>
        <%
        out.println("Unable to connect to database.");
        }
        %> 
```

我连接到数据库和事件搜索查询可能是什么问题？我只是从源代码 c/p 并放入我的 jsp。密码和用户名是真实的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T20:16:53.800

MySQL驱动jar文件必须放在你部署的webapp的WEB-INF/lib目录下。

另请注意：

*   JSP 不应访问数据库。这应该在由 servlet 调用的服务中完成。
*   连接应始终在 finally 块中关闭。如果您有任何异常，不这样做会使连接保持打开状态，并且会很快使系统崩溃
*   webapp 应该使用连接池。阅读您的应用服务器或 Web 容器文档，了解如何设置连接池。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T19:38:25.807

将异常消息添加到您自己创建的错误输出中：

out.println("无法连接数据库："+ex.getMessage());

# r - 交叉验证季节性线性模型

> ID：14044599
> 
> 赞同：2
> 
> 时间：2012-12-26T18:28:54.040
> 
> 标签：r, regression, forecasting, cross-validation

我正在尝试对我的线性模型执行 CV，该模型具有季节性虚拟变量，所以我不能随机抽样。

```
y = rnorm(120,0,3) + 20*sin(2*pi*(1:120)/12) 
x = months(ISOdate(2012,1:12,1))
reg.data = data.frame(y, x)
model = lm(y ~ x, data = reg.data) 
```

我的简历功能是：

```
cross.valid = function(model, min.fit = as.integer(nrow(model$model)*0.7), h = 1)
{
  dados = model$model
  n.rows = nrow(dados)

  results = data.frame(pred = numeric(), actual = numeric())

  for (i in seq(1, n.rows - min.fit - h + 1, by = h))
  {
   dados.train = dados[1:(i + min.fit - 1), ]
   model <- update(model, data = dados.train)

   dados.pred = dados[(i + min.fit):(i + min.fit + h - 1), -1, drop = FALSE]

   predic = predict(model, newdata = dados.pred, interval = 'prediction')
   actual = dados[(i + min.fit):(i + min.fit + h - 1), 1]
   results = rbind(results, data.frame(pred = predic[1:h, 'fit'], actual = actual))
  }

  results
} 
```

例子：

```
cv1 = cross.valid(model, h = 1)
mae = with(cv1, mean(abs(actual - pred )))
print(mae) 
```

*不同视野 ( h* )的 MAE 值太接近。代码本身是否有效？有没有更好的解决方案/包来做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T05:14:04.813

我认为您的功能没有任何不妥之处。调查`forecast`包裹；我怀疑它将提供您需要的许多功能。

我已经简洁地重写了你的函数：

```
set.seed(1)
y = rnorm(120,0,3) + 20*sin(2*pi*(1:120)/12) 
x = months(ISOdate(2012,1:12,1))
reg.data = data.frame(y, x)

pred.set<-function(i,h) {
  train<-reg.data[1:(i + min.fit - 1),]
  test<-reg.data[(i + min.fit):(i + min.fit + h - 1),]
  pred<-predict(lm(y~x, data=train), newdata=test)
  abs(test$y - pred)
}

pred.by.horiz<-function(h) 
               mean(sapply(seq(1, nrows - min.fit - h + 1, by = h),pred.set,h=h)) 
```

`pred.by.horiz`与您的函数（和后处理）的输出完全匹配。

正如您所提到的，地平线似乎不会影响 MAE：

```
mae.by.h<-sapply(seq(nrows-min.fit),pred.by.horiz)
plot(mae.by.h,type='l',col='red',lwd=2,xlab='Horizon',ylab='Mean absolute error') 
```

![地平线上的 MAE](../Images/f0ff39802d3e25667c131787718b902d.png)

也许您预计平均误差会随着预测范围的增加而增加。对于许多时间序列模型，这将是正确的，但在您的几个月的线性模型中，*添加更多数据并不能帮助您预测系列中的下一个点*（除非您添加 12 个月或更长时间）。

例如，考虑`h`1 时会发生什么。您从 84 个月的数据开始，每个月有 7 个数据点。现在，您添加一个数据点，即明年 1 月，并尝试预测 2 月的结果。但是您的额外数据点只会帮助您预测明年*一月*，这就是您的线性函数的工作方式。看模型总结：

```
lm(y ~ x, data = reg.data)
Coefficients:
(Intercept)      xAugust    xDecember    xFebruary     xJanuary  
   17.11380    -32.74962    -17.81076     -0.03235     -6.63998  
      xJuly        xJune       xMarch         xMay    xNovember  
  -26.69203    -17.41170      2.96735     -7.11166    -25.43532  
   xOctober   xSeptember  
  -33.56517    -36.93474 
```

每个预测仅基于两个变量，即截距和预测月份。所以预测提前一分并不比预测提前五分容易。这就是为什么 MAE 没有随着视野的增加而上升的原因是问题出在您对数据建模的方式上，而不是 MAE 函数。

关于您的功能，我不完全了解的一件事是为什么您决定`h`在每次迭代时增加训练集的大小。看看当你尝试增加 1 时会发生什么是很有启发性的：

```
# Code to increment by 1
pred.by.horiz2<-
  function(h) mean(sapply(seq(1, nrows - min.fit - h + 1, by = 1),pred.set,h=h))
mae.by.h2<-sapply(seq(nrows-min.fit),pred.by.horiz2)
plot(mae.by.h2,type='l',col='red',lwd=2,xlab='Horizon',ylab='Mean absolute error') 
```

![将 h 增加 1 时按水平方向的 MAE](../Images/e11064ecc8bc1596f183dab35c13c801.png)

这里的模式很复杂，但您会注意到 MAE 从 12 开始下降，此时地平线足够大，可以使用下一个点。

# iphone - 为什么 Xcode 可以在设备上构建和运行，但不能在设备上构建和运行 Profile？

> ID：14044605
> 
> 赞同：0
> 
> 时间：2012-12-26T18:29:26.613
> 
> 标签：iphone, ios, xcode, code-signing, provisioning

Build & run 在我的 iPhone 5 和 Xcode 4.5.2 上运行良好。

但是当我尝试在设备上配置文件时，我收到了这个错误：

```
Code Sign error: Provisioning profile 'CG82BAAB-492F-5973-322F-F185257EA26B' 
can't be found 
```

我尝试在构建设置的调试代码签名部分取消设置并重新设置开发人员团队配置文件，但这并没有解决问题。

这是我从旧的 Snow Leopard Mac 拖到新的 Mountain Lion mac 上的项目。这是一个旧的 iPhone 4 项目，我正在尝试迁移到 iPhone 5。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T18:45:27.153

> This is a project I dragged over to my new Mountain Lion mac from an old Snow Leopard Mac. It's a old iPhone 4 project which I am trying to migrate to iPhone 5.

It is likely that you did not transfer your developer certificates and profiles from the old computer. Check in Xcode organizer what you have installed there... also, you can sync from Xcode with your developer account, so you can avoid manually copying the profiles over, but you need to install the developer certificates at least...

# android - 监听片段交易

> ID：14044608
> 
> 赞同：1
> 
> 时间：2012-12-26T18:29:59.210
> 
> 标签：android, android-fragments

我需要知道何时添加/删除/替换片段（以及哪些片段），尤其是从后台弹出时。我希望在交易发生之前和之后都收到通知，因为我有时想延迟交易以更改底层布局。所以总的来说，我想在事务之前和之后运行一些代码，并最终延迟事务。我已经考虑过为此目的使用自定义动画，但事务只接受 id，不接受对象/类。并且可能有一个我目前想不出的更好的解决方案。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T19:05:48.810

我已经使用这些片段有一段时间了，如果你想要开箱即用的东西，那你就不走运了。

唯一可用的侦听器是 the `addOnBackStackChangedListener`，仅此而已。

但请记住，创建和提交片段事务的每个调用都是由您直接通过代码或间接通过在 XML 布局上实例化的片段或通过操作栏选项卡传递给您的。因此，基于此，您应该能够以某种方式组织代码以始终通过包装器调用，但这肯定是一项艰巨的工作。

# android - 我的应用程序安装在内存中，android:installLocation="preferExternal"

> ID：14044610
> 
> 赞同：-6
> 
> 时间：2012-12-26T18:30:14.413
> 
> 标签：android, android-manifest, google-play

当我从 Google PLAY 安装时，我无法将我的应用程序移动到内部存储器。但是，从 Eclipse 中，我在开发时可以移动它，如果我也直接从 .apk 安装。

我在 SD 卡中安装了其他应用程序。

```
 <manifest xmlns:android="http://schemas.android.com/apk/res/android"
     package="com.pedrera.ginTonic"
     android:versionCode="14"
     android:versionName="2.7" 
     android:installLocation="preferExternal">

<uses-sdk android:minSdkVersion="8" /> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T18:35:26.280

引用[文档](http://developer.android.com/guide/topics/manifest/manifest-element.html#install)：

> 该应用程序更喜欢安装在外部存储（SD 卡）上。无法保证系统会遵守此请求。如果外部媒体不可用或已满，或者应用程序使用前向锁定机制（外部存储不支持），则应用程序可能安装在内部存储上。

# php - mysql mysql_num_rows($result); 备择方案

> ID：14044612
> 
> 赞同：3
> 
> 时间：2012-12-26T18:30:15.920
> 
> 标签：php, mysql

是否有更快的查询来计算使用 WHERE 语句的行数？我在 PHP 中使用的当前查询是：

```
$result = mysql_query("SELECT SQL_NO_CACHE id FROM users WHERE user = '$tnuser'");
$total = mysql_num_rows($result); 
```

表引擎是 InnoDB，ID 是主键，用户是索引的。此查询每秒运行 300+，因此任何性能提升都会很好。总数总是在变化，用户被删除/添加的频率很高。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T18:38:01.513

通常使用 SQL 的聚合函数来计算一些东西会更快。例如，您可以尝试

```
SELECT COUNT(*) FROM users WHERE user = '$tnuser' 
```

# ruby-on-rails - 带有选择参数的表单

> ID：14044613
> 
> 赞同：1
> 
> 时间：2012-12-26T18:30:22.687
> 
> 标签：ruby-on-rails, forms

**Yoshiji 先生和我解决了它，请参阅我们上面对他的回答的评论**

我添加了我的`_form.html.erb`代码的一部分。

我想要三样东西：

1）@admin_mail 将是要求用户填写的 admin_mail（我不想显示“admin_mail”选项，但 admin_mail 将是：@admin_mail）

2）有选项可以选择user_mail。我希望将选择插入到 user_mail 中。

3) 'done' 将由 false 自动显示（并且不显示）。

```
<div class="field">
    <%= @admin_mail %>
    <%= f.label :admin_mail %><br />
    <%= f.text_field :admin_mail %>
</div>

<div class="field">
   <select>
     <% @workers.group_by(&:email).each do |email, tasks| %>
        <option value="<%= email %>"><%= email %></option>
     <% end %>
   </select>
   <%= f.label :worker_mail %><br />
   <%= f.text_field :worker_mail %>
</div>

<div class="field">
  <%= f.label :task %><br />
  <%= f.text_area :task %>
</div>

<div class="field">
  <%= f.label :done %><br />
  <%= f.check_box :done %>
</div>

<div class="actions">
  <%= f.submit %>
</div> 
```

我认为为了设置默认完成的复选框（false），我必须定义：

```
t.boolean :done, :default => false 
```

并从表单中删除下一行：

```
<div class="field">
  <%= f.label :done %><br />
  <%= f.check_box :done %>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T19:01:12.960

# 2):

您可以使用[`f.select`](http://apidock.com/rails/ActionView/Helpers/FormOptionsHelper/select)生成选择框和选项：

```
f.select :worker_mail, @workers.map{ |c| [c.email, c.email] } 
```

而不是这部分代码：

```
<select>
  <% @workers.group_by(&:email).each do |email, tasks| %>
    <option value="<%= email %>"><%= email %></option>
  <% end %>
</select> 
```

# 3):

**在创建时将属性“完成”设置为 false**：您可以使用`[after_create][2]`回调（[通常链接到回调文档](http://api.rubyonrails.org/classes/ActiveRecord/Callbacks.html)）。它是这样使用的回调：

```
class Task < ActiveRecord::Base
  # ...
  after_create :set_done_to_false

  def set_done_to_false
    self.update_attributes(done: false)
  end
end 
```

那么您就不需要显示与 done 属性有关的表单部分。

# 1):

而不是您的代码：

```
<div class="field">
    <%= @admin_mail %>
    <%= f.label :admin_mail %><br />
    <%= f.text_field :admin_mail %>
</div> 
```

使用值 = @admin_email 的 hidden_​​field：

```
 f.hidden_field :admin_mail, :value => @admin_mail 
```

# groovy - 给定值，在地图中查找键

> ID：14044614
> 
> 赞同：12
> 
> 时间：2012-12-26T18:30:28.787
> 
> 标签：groovy, map

嗨，我有一张这样的地图：

```
[this:0, is:1, a:2, file:3, anotherkey:4, aa:5] 
```

我希望我能找到`key`给定的`value`地图。例如，如果`5`给出了值，我需要`aa`从地图返回。

那可能吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-12-26T19:02:18.150

我不知道是否有直接的方法来获取给定值的键，但是使用[`Map#find`](http://groovy.codehaus.org/groovy-jdk/java/util/Map.html#find%28groovy.lang.Closure%29)来获取地图条目然后获取它的值就足够了：

```
def keyForValue(map, value) {
    map.find { it.value == value }?.key
}

def map = [a: 1, b: 2, c: 3]
assert keyForValue(map, 2) == 'b'
assert keyForValue(map, 42) == null 
```

一般来说，映射不需要在它们的条目之间有顺序关系，但是 Groovy 的文字映射的默认实现是 LinkedHashMap，它*是*有序的，因此`keyForValue`在使用这些映射时总是会产生值的第一个键。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-28T12:58:50.703

没有具体的命令。

幸运的是，如此处所示[，](http://groovy.codehaus.org/JN1035-Maps)您可以轻松获取映射中特定值的键：

```
def myMap = [this:0, is:1, a:2, file:3, fix:4, aa:5]
def myValue = 5 
```

你可以做：

```
def myKey = myMap.find{ it.value == myValue }?.key
// 'aa' 
```

如果您想要所有密钥，请执行以下操作：

```
def myMap = [this:0, is:1, a:2, file:3, fix:4, aa:5, bb:5]
def myValue = 5

def myKeys = []
myMap.findAll{ it.value == myValue }.each{myKeys << it?.key}
// ['aa', 'bb'] 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-08-03T15:19:58.567

您可以反转地图，如下所示：

```
Map m = [a: '1', b: '2']
Map mInvert = m.collectEntries { e -> [(e.value): e.key] }

assert mInvert == ['1':'a', '2':'b']

assert mInvert['2'] == 'b'
assert m['b'] == '2' 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-26T18:37:48.153

您可能必须自己遍历[条目集](http://docs.oracle.com/javase/6/docs/api/java/util/Map.html#entrySet%28%29)并尝试找到具有匹配[值](http://docs.oracle.com/javase/6/docs/api/java/util/Map.Entry.html#getValue%28%29)的条目。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-27T07:23:39.287

```
def expect = 5
def m = ['this':0, is:1, a:2, file:3,  aa:5]
def r = m.collectMany{ k,v -> (v == expect) ? [k] : []}

// Result: [aa] 
```

# java - 当有人输入字母作为菜单选项时输出错误消息？

> ID：14044615
> 
> 赞同：0
> 
> 时间：2012-12-26T18:30:28.620
> 
> 标签：java

该程序运行良好，但我想让该程序告诉用户不应使用字母，只有选项 1 到 5。有人可以帮我弄清楚吗？

```
public class Main {

Scanner input = new Scanner ( System.in );

/**
* @param args the command line arguments
*/

public static void main(String[] args) {
int UserIn=0;
double numberInputA;
double numberInputB;
double Answer;

Scanner input = new Scanner( System.in );

while (UserIn!=5){ //this starts while loop when user input is not equal to 5
System.out.println ("What type of calculation would you like to perform?");
System.out.println ( "1\. Add\n2\. Subtract\n" +
"3\. Multiply\n4\. Divide\n5\. Exit");//shows the menu
UserIn = input.nextInt();//ask user to input integer of choice

if (UserIn>5){
System.out.println( "ERROR choose the numbers on the menu" );
}else if (UserIn<1){
    System.out.println("ERROR choose the numbers on the menu");
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T18:51:14.397

```
public static void main(String[] args) {
    // TODO code application logic here
    int UserIn = 0;
    double numberInputA;
    double numberInputB;
    double Answer;

    while (UserIn != 5) { //this starts while loop when user input is not equal to 5
        System.out.println("What type of calculation would you like to perform?");
        System.out.println("1\. Add\n2\. Subtract\n"
                + "3\. Multiply\n4\. Divide\n5\. Exit");//shows the menu
        UserIn = getUserInput();
    }
}

private static int getUserInput() {
    int UserIn = 0;
    Scanner input = new Scanner(System.in);
    try {
        UserIn = input.nextInt();//ask user to input integer of choice
        if (UserIn > 5) {
            System.out.println("ERROR choose the numbers on the menu");
            return -1;
        } else if (UserIn < 1) {
            System.out.println("ERROR choose the numbers on the menu");
            return -1;
        }
        return UserIn;
    } catch (Exception ex) {
        System.out.println("ERROR only numbers are allowed");
        return -1;
    }
} 
```

# php - 重写 URL .htaccess

> ID：14044616
> 
> 赞同：0
> 
> 时间：2012-12-26T18:30:31.097
> 
> 标签：php, url-rewriting

我有一个在不同目录中有许多 html 页面和 .htaccess 文件的站点

```
 http://mysite.com/index.html 
.
.
.
http://mysite.com/design/index.html
.
.
.
http://mysite.com/doc/ui/index.html
.
.
. 
```

我想将所有 index.html 页面重写为：

```
http://mysite.com/doc.php 
.
.
.
http://mysite.com/design/doc.php
.
.
.
http://mysite.com/doc/ui/doc.php
.
.
. 
```

我有一个单页 doc.php 并且我想将我的所有 index.html 页面重写到这个页面，我可以获得查询字符串 url 并在 doc.php 中获取页面值和 $echo

我怎样才能做到这一点 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T18:37:35.663

如果您只是想使用除`index.html`Directroy Index 页面之外的其他内容，那么您根本不需要重新编写 URL。

只需将此配置选项放在您的 Apache 主机配置中：

```
DirectoryIndex doc.php index.html index.htm 
```

`doc.php`当您仅使用目录名称访问服务器时，这将优先考虑您。换句话说，带有 URL 的请求`http://mysite.com`或`http://mysite.com/design`将转到`doc.php`这些目录中的文件而不是 index.html。如果目录没有`doc.php`文件，则服务器将查找`index.html`文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T18:32:34.513

使用该`DirectoryIndex`命令，您可以轻松更改索引。如果前一个文件不可用，您可以附加多个文件供服务器尝试，方法是在同一行用空格分隔不同的文件名。如果没有必要，尽量不要使用重写。

```
DirectoryIndex doc.php 
```

将前一个`.htaccess`文件放在根目录中的文件中，它应该使您的目录索引 doc.php 而不是 index.php/html。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-26T18:34:26.763

嗨，在 stackoverflow 中遇到同样的问题，或者您可以从这个 url 获取帮助

[使用 htaccess 重写 PHP url](https://stackoverflow.com/questions/4976809/php-url-rewriting-using-htaccess)

# sql - 捕获 Linq 到对象查询

> ID：14044617
> 
> 赞同：1
> 
> 时间：2012-12-26T18:30:37.473
> 
> 标签：sql, asp.net-mvc-3, nhibernate, linq-to-objects

由于应用程序中的性能问题，我们在我的一个项目中使用内存方法，其中我们以通用集合的形式将所有表加载到 RAM 中（使用 nhibernate）。

问题是，当我们使用简单的 linq to sql 方法时，测试和 QA 团队可以轻松地使用他们正在查看的页面的 sql 配置文件获取 sql 查询。

但是使用新方法（内存中），我们一次性加载集合中的所有数据，然后使用 linq 从该集合中获取数据，因此测试和 QA 团队无法获取 sql 查询来验证业务逻辑和验证错误。

请建议任何可以在这种情况下提供帮助的解决方案，我认为不可能将 sql 从 linq 获取到对象（因为所有数据都已经在收集中）。请建议任何可以帮助我的解决方案/方法/工具，以生成针对集合或任何其他好的解决方案运行的那些 linq 的 sql。

注意：我知道从 linq to sql 中获取 sql 是不可能的，我正在寻找可以帮助我的 QA 和测试团队验证查询/业务逻辑的建议（就像他们之前通过捕获 sql 所做的那样）。如果可能的话，将 linq 查询记录为字符串，可以进一步用于运行/分析。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T18:43:02.447

在这种情况下运行的唯一 SQL 语句是将数据加载到内存中的初始 SELECT 查询。完成这些操作后，您将不再运行“查询”，而是执行 .NET Framework 调用。

鉴于您已经从根本上改变了应用程序的架构，您需要将这一点传达给测试和 QA 团队——他们将无法像以前那样“看到”应用程序现在在后台做什么。如果这种“深入研究”能力是您的测试团队的要求，那么您的架构可能需要进一步修改。

# c# - ASP.NET MVC 和多个属性的多个复选框，该怎么做？

> ID：14044620
> 
> 赞同：0
> 
> 时间：2012-12-26T18:30:51.697
> 
> 标签：c#, asp.net-mvc, razor, checkbox

我有这样的事情：

```
public class MyClass
{
    public int Id {get;set;}
    public bool First {get;set;}
    public bool Second {get;set;}
    public bool Third {get;set;}
} 
```

现在，我想生成一些东西，它会显示这个：

```
First - [checkbox] 
Second - [checkbox] 
Third - [checkbox]
[Submit] 
```

我希望这些复选框从这些属性中只选择一项，我该怎么做？

**编辑：对不起，伙计们，我真的不需要复选框，我需要的是单选按钮。如果有人有任何示例代码显示如何使用单选按钮解决我的问题，我将不胜感激。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T18:47:42.027

If I understand your question correctly, you only want one of the items (First, Second or Third) to be selected. For this behavior use a radiobutton. Checkboxes allow each item to be selected regardless if the other item is selected. A radiobutton will only allow one of the items to be selected at a time.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-26T18:48:24.820

只是为了回答您有关复选框的问题：

```
@Html.LabelFor(m => m.First, "First -") @Html.CheckBoxFor(m => m.First)
@Html.LabelFor(m => m.First, "Second -") @Html.CheckBoxFor(m => m.Second)
@Html.LabelFor(m => m.First, "Third -") @Html.CheckBoxFor(m => m.Third) 
```

包装文本和复选框，允许用户单击标签并选择/取消选择复选框。或者，不要用标签包装复选框和文本，只需使用`LabelFor`.

现在...要实现用户应该只检查其中一个，请为此使用 RadioButtons。

在此处查看更详细的答案：[https ://stackoverflow.com/a/5621200/7720](https://stackoverflow.com/a/5621200/7720)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-26T19:20:09.640

使用 RadioButtonFor。您的模型中只需要一个属性。

模型：

```
public byte MyOption { get; set; } 
```

看法：

```
@Html.RadioButtonFor(m => model.MyOption, 1) 1
@Html.RadioButtonFor(m => model.MyOption, 2) 2
@Html.RadioButtonFor(m => model.MyOption, 3) 3 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-26T18:44:01.380

You can simply use the "CheckBoxFor" Html helper and bind to each property. Then, when you post, you can call TryUpdateModel() on your model.

```
@using (Html.BeginForm())
{
    @HtmlHiddenFor(m => m.Id)
    <div>First - @Html.CheckBoxFor(m => m.First)</div>
    <div>Second - @Html.CheckBoxFor(m => m.Second)</div>
    <div>Third - @Html.CheckBoxFor(m => m.Third)</div>
    <input type="submit">
}

[HttpPost]
public ActionResult SomeActionMethod(int id)
{
    var model = new MyClass(); // build your model however you like
    TryUpdateModel(model);
} 
```

# c# - 无法进入 WCF 服务

> ID：14044622
> 
> 赞同：0
> 
> 时间：2012-12-26T18:30:59.863
> 
> 标签：c#, asp.net, wcf, sharepoint

由于某种原因，我无法进入我的 WCF 服务。它位于与客户一起的解决方案中。我看过[这个](https://stackoverflow.com/questions/9986861/wcf-beginner-tutorial-unable-to-debug-step-into)，但它并没有解决我的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-15T15:40:07.783

您可以`System.Diagnostics.Debugger.Launch()`在代码中添加该行后启动该服务。这将弹出一个窗口，要求您选择要使用的调试器。

如果它没有弹出窗口，那么您肯定没有运行您认为的代码。通常可能是因为配置不匹配或参数被误解

# java - 安全例外：尝试将沙盒 jar 作为可信库打开

> ID：14044624
> 
> 赞同：3
> 
> 时间：2012-12-26T18:31:03.083
> 
> 标签：java, security, jar, jogl

我正在尝试通过网页运行小程序，但这样做会给我错误：

```
java.lang.reflect.InvocationTargeException
       at com.sun.deploy.util.DeployAWTUtil.invokeAndWait(DeployAWTUtil.java:116)
       at sun.plugin2.applet.Plugin2Manager.runOnEDT(Plugin2Manager.java:3520)
       at sun.plugin2.applet.Plugin2Manager.createApplet(Plugin2Manager.java:3051)
       at sun.plugin2.applet.Plugin2Manager$AppletExecutionRunnable.run(Plugin2Manager.java:1497)
       at java.lang.Thread.run(Thread.java:662)
Caused by:java.lang.SecurityExcption: attempted to open sandboxed jar file :/home/daniel/workspace/project/jars/jogl/jogl.all.jar as a Trusted-Library
       at com.sun.deploy.security.CPCallbackHandlers$ParentElement.checkResources(CPCallbackHandler.java:358)
       at com.sun.deploy.security.DeployURLClassPath$JarLoader.checkResource(DeployURLClassPath:852)
       ....more stuff I don't want to have to retype but I can if necessary 
```

我不明白为什么。我试图用我的小程序来处理几个罐子，但这是唯一导致问题的罐子（至少目前是这样）。我查看了[这个类似的问题](https://stackoverflow.com/questions/7093935/java-webstart-attempt-to-sandboxed-jar-as-trusted-library)，但是由于我没有额外的库（除非 applet.class 计数我还没有签名），这似乎不适用于这里。我查看了[Mixing Signed and Unsigned Code](http://docs.oracle.com/javase/6/docs/technotes/guides/jweb/mixed_code.html#manifest)，但是单击了“启用 - 如果需要则显示警告”，“Trusted-Library: true”在 MANAFEST 文件中，并且我正在运行 firefox 3.6.24（特定于 Linux 机器我有）。我很感激你的帮助。

jogl.all.jar 的 MANAFEST 文件：

```
Manifer-Version: 1.0
Ant-Version: Apache Ant 1.8.2
Created-By: 1.6.0_24-b07 (Sun Microsystems Inc.)
Specification-Title: Java Bindings for OpenGL API Specification
Specification-Version: 2.0
Specificaiton-Vender: JogAMp Community
Implementation-Title: Java Bindings for OpenGL Runtime Environment
Implementation-Version: 2.0-b23-20110303
Implementation-Branch: rc
Implementation-Commit: bcf5d6ac871a29398b441df617923d3dd2cf35c1
Implementation-Vendor: JogAmp Community
Implementation-URL: http://jogamo.org/
Extension-Name: javax.media.opengl
Implementation-Vendor-Id: com.jogamp
Trusted-Library: true 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T19:11:51.737

看起来好像您还没有对 jar 签名（因此是“沙盒”位）。

编写可以被不受信任的代码安全使用的受信任的 Java 代码是*非常**非常*困难的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-14T16:34:43.787

我有类似的问题 - 根本原因是 Java JRE 安装为 32 位和 64 位版本 - 基本上在“控制面板/添加或删除程序”列表中有 2 个单独的应用程序条目可见。

显然，这是我的网络浏览器 (IE) 和/或 java 插件的配置。从系统中删除两个 JRE 版本，然后从头开始安装最新的 JRE 解决了这个问题。

我的问题出现在 Java 7u25 上。

# python - python的subprocess.Popen跳过输入

> ID：14044625
> 
> 赞同：3
> 
> 时间：2012-12-26T18:31:05.377
> 
> 标签：python, subprocess

我发现 subprocess.Popen() 在特定情况下会跳过输入字节。为了演示这个问题，我编写了以下（无意义的）程序：

```
import sys 
from subprocess import Popen

skip = int(sys.argv[1])
fin = sys.stdin
fin.read(skip)
cmd = 'wc -c'.split()
Popen(cmd, stdin=fin).wait() 
```

该程序跳过输入的指定字节数，然后`wc`计算剩余字节数。

现在尝试使用`dd`生成输入的程序：

```
# skipping 0, everything works fine:
$ dd if=/dev/zero bs=1 count=100 2>/dev/null | python wc.py 0
100

$ # but skipping more than 0 yields an unexpected result.
$ # this should return 99:
$ dd if=/dev/zero bs=1 count=100 2>/dev/null | python wc.py 1
0

$ # I noticed it skips up to the 4k boundary.
$ # this should return 8191:
$ dd if=/dev/zero bs=1 count=8192 2>/dev/null | python wc.py 1
4096 
```

谁能解释这种意外行为？一个已知问题？应该提交的错误？“你做错了”？

FWIW，我最终通过使用标准输入管道解决了这个问题，然后一次输入一个数据块：

```
p = Popen(cmd, stdin=PIPE)
chunk = fin.read(CHUNK_SIZE)
while chunk:
    p.stdin.write(chunk)
    chunk = fin.read(CHUNK_SIZE)
p.stdin.close()
p.wait() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T18:34:41.187

`.read()`on 函数在Python`sys.stdin`内部进行缓冲。因此，当您读取一个字节时，Python 实际上会读取整个缓冲区，并期望您很快会再次执行相同的操作。但是，读取缓冲区已满（在您的情况下为 4096）意味着操作系统认为输入已被读取并且不会将其传递给`wc`.

[`os.read()`](http://docs.python.org/2/library/os.html#os.read)您可以通过使用跳过必要的输入字节数来避免此问题。这会直接调用操作系统，并且不会在您的进程中缓冲数据：

```
os.read(fin.fileno(), skip) 
```

# javascript - JS运行环境

> ID：14044626
> 
> 赞同：0
> 
> 时间：2012-12-26T18:31:12.563
> 
> 标签：javascript, coffeescript, tdd, client-side, spine.js

我是 JavaScript 新手，如果这个问题不值得问，请原谅。我需要一个具有一些特性的 JavaScript 运行时环境：

*   命令行界面
*   咖啡脚本兼容性
*   单元测试的可能性（顺便问一下，你对单元测试框架有什么看法？）

我的操作系统是 ubuntu 12.04，我不确定 node.js 是否值得安装（也许应该使用它？）。我已经阅读了关于 google's [V8](http://code.google.com/p/v8/)的信息，但我不确定它是否以这种方式使用。

PS 我将使用咖啡和 Spine 开发客户端 sctipts。服务器是 Python(Django,WebPy) 或 PHP(Symfony2, Silex)。

非常感谢提前。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T18:36:35.053

安装**node.js**，**npm**，然后**是 coffee-script**。

`coffee`现在您可以通过可执行文件在命令行运行 coffeescript 。在没有命令的情况下运行它以获得交互式提示，或者给它一个文件名来执行`.coffee`文件。

至于测试，任何 JS 测试框架都可以。有一堆。[摩卡](http://visionmedia.github.com/mocha/)是我的最爱之一。

# xpages - 如何仅为一个 xsp 渲染或隐藏主题资源

> ID：14044628
> 
> 赞同：1
> 
> 时间：2012-12-26T18:31:15.837
> 
> 标签：xpages

我有一个在所有 xpages 中加载许多 CSS 和 METAS 的应用程序主题。

我的应用程序只需要 index.xsp 中的所有这些 css，其余页面由 AJAX 加载，我需要在没有 CSS 的情况下加载这些页面，基本上没有主题。

有人知道是否可以在 RESOURCES 中添加“渲染”属性或添加条件以加载一个 CSS 或其他？我知道我可以在没有主题的情况下从其他 NSF 加载其他页面，但我最好只有一个 NSF

```
<resource>
    <content-type>text/css</content-type>
    <href>css/reset.css</href>
</resource>
<resource>
    <content-type>text/css</content-type>
    <href>css/style.css</href>
</resource>
<resources>
<metaData>
        <name>MobileOptimized</name>
        <content>320</content>
    </metaData>
    <metaData>
        <name>viewport</name>
        <content>width=device-width, initial-scale=1.0,
            maximum-scale=1.0, user-scalable=no</content>
    </metaData>
</resources> 
```

例如，我有这个用于 FORM 控件，这个条件对我的应用程序有效。

```
<control mode="override">
<name>Form</name>
<property>
    <name>styleClass</name>
    <value>#{javascript:(view.getPageName() == '/index.xsp')?'block wizard same-height':'xspForm'}</value> 
</property> 
```

非常感谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-26T19:50:26.773

您确实可以将渲染用于主题中的资源。你可以这样做，例如：

```
<resource rendered="#{javascript:view.getPageName() == '/index.xsp'}">
    <content-type>text/css</content-type>
    <href>css/reset.css</href>
</resource> 
```

# zen-cart - Zen - 购物车、谷歌钱包与状态列表集成

> ID：14044634
> 
> 赞同：0
> 
> 时间：2012-12-26T18:31:50.613
> 
> 标签：zen-cart, android-pay

我在使用 google checkout 贡献将 google checkout 集成到 zencart 时遇到问题。 [http://www.zen-cart.com/downloads.php?do=file&id=206](http://www.zen-cart.com/downloads.php?do=file&id=206) 这里的主要问题是谷歌不断返回错误。

“解析 XML 时出错；来自解析器的消息是：checkout-shopping-cart/checkout-flow-support/merchant-checkout-flow-support/shipping-methods/flat-rate-shipping/shipping 中允许区域正文的值无效-限制：必须是美国的 2 个字母的邮政编码或州名”

以下是有问题的付款方式之一的摘录，我不知道也无法弄清楚出了什么问题。任何帮助将不胜感激。

原谅我糟糕的英语。

```
 <flat-rate-shipping name="Table: Vary by Weight/Price">
      <price currency="USD">0</price>
      <shipping-restrictions>
        <allow-us-po-box>false</allow-us-po-box>
        <allowed-areas>
          <us-state-area>
            <state>AL</state>
          </us-state-area>
          <us-state-area>
            <state>AS</state>
          </us-state-area>
          <us-state-area>
            <state>AZ</state>
          </us-state-area>
          <us-state-area>
            <state>AR</state>
          </us-state-area>
          <us-state-area>
            <state>AA</state>
          </us-state-area>
          <us-state-area>
            <state>AE</state>
          </us-state-area>
          <us-state-area>
            <state>AM</state>
          </us-state-area>
          <us-state-area>
            <state>AP</state>
          </us-state-area>
          <us-state-area>
            <state>CA</state>
          </us-state-area>
          <us-state-area>
            <state>CO</state>
          </us-state-area>
          <us-state-area>
            <state>CT</state>
          </us-state-area>
          <us-state-area>
            <state>DE</state>
          </us-state-area>
          <us-state-area>
            <state>DC</state>
          </us-state-area>
          <us-state-area>
            <state>FL</state>
          </us-state-area>
          <us-state-area>
            <state>GA</state>
          </us-state-area>
          <us-state-area>
            <state>ID</state>
          </us-state-area>
          <us-state-area>
            <state>IL</state>
          </us-state-area>
          <us-state-area>
            <state>IN</state>
          </us-state-area>
          <us-state-area>
            <state>IA</state>
          </us-state-area>
          <us-state-area>
            <state>KS</state>
          </us-state-area>
          <us-state-area>
            <state>KY</state>
          </us-state-area>
          <us-state-area>
            <state>LA</state>
          </us-state-area>
          <us-state-area>
            <state>ME</state>
          </us-state-area>
          <us-state-area>
            <state>MH</state>
          </us-state-area>
          <us-state-area>
            <state>MD</state>
          </us-state-area>
          <us-state-area>
            <state>MA</state>
          </us-state-area>
          <us-state-area>
            <state>MI</state>
          </us-state-area>
          <us-state-area>
            <state>MN</state>
          </us-state-area>
          <us-state-area>
            <state>MS</state>
          </us-state-area>
          <us-state-area>
            <state>MO</state>
          </us-state-area>
          <us-state-area>
            <state>MT</state>
          </us-state-area>
          <us-state-area>
            <state>NE</state>
          </us-state-area>
          <us-state-area>
            <state>NV</state>
          </us-state-area>
          <us-state-area>
            <state>NH</state>
          </us-state-area>
          <us-state-area>
            <state>NJ</state>
          </us-state-area>
          <us-state-area>
            <state>NM</state>
          </us-state-area>
          <us-state-area>
            <state>NY</state>
          </us-state-area>
          <us-state-area>
            <state>NC</state>
          </us-state-area>
          <us-state-area>
            <state>ND</state>
          </us-state-area>
          <us-state-area>
            <state>MP</state>
          </us-state-area>
          <us-state-area>
            <state>OH</state>
          </us-state-area>
          <us-state-area>
            <state>OK</state>
          </us-state-area>
          <us-state-area>
            <state>OR</state>
          </us-state-area>
          <us-state-area>
            <state>PA</state>
          </us-state-area>
          <us-state-area>
            <state>RI</state>
          </us-state-area>
          <us-state-area>
            <state>SC</state>
          </us-state-area>
          <us-state-area>
            <state>SD</state>
          </us-state-area>
          <us-state-area>
            <state>TN</state>
          </us-state-area>
          <us-state-area>
            <state>TX</state>
          </us-state-area>
          <us-state-area>
            <state>UT</state>
          </us-state-area>
          <us-state-area>
            <state>VT</state>
          </us-state-area>
          <us-state-area>
            <state>VI</state>
          </us-state-area>
          <us-state-area>
            <state>VA</state>
          </us-state-area>
          <us-state-area>
            <state>WA</state>
          </us-state-area>
          <us-state-area>
            <state>WV</state>
          </us-state-area>
          <us-state-area>
            <state>WI</state>
          </us-state-area>
          <us-state-area>
            <state>WY</state>
          </us-state-area>
        </allowed-areas>
      </shipping-restrictions>
    </flat-rate-shipping> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T17:26:08.093

免责声明 - 我不是 Zen 开发者/用户。

我怀疑这与武装部队州法典有关。看看删除它们是否可以修复错误。

但是，使用其中任何一个可能会更好

*   [`us-country-area`](https://developers.google.com/checkout/developer/Google_Checkout_XML_API_Flat_Rate_Shipping#tag_us-country-area)， 或者，
*   与其列出您发货的州，不如定义您不发货*的州*[`excluded-areas`](https://developers.google.com/checkout/developer/Google_Checkout_XML_API_Tag_Reference#tag_excluded-areas)

嗯...

# database - 来自数据库模式的 Solr 模式映射工具

> ID：14044635
> 
> 赞同：0
> 
> 时间：2012-12-26T18:31:55.920
> 
> 标签：database, solr, lucene, schema

是否有`schema.xml`从数据库模式创建 Solr 的工具或库？我们试图避免定义和维护成百上千的字段，并使索引表的过程更加流畅。

我们正在寻找类似的东西：

```
table
(
    id INTEGER NOT NULL,
    type INTEGER NOT NULL,
    name VARCHAR(255) NOT NULL
); 
```

至，

```
<field name="id" type="integer" indexed="true" stored="true" multiValued="true"/>
<field name="type" type="integer" indexed="true" stored="true" multiValued="true"/>
<field name="name" type="string" indexed="true" stored="true" multiValued="true"/> 
```

或者，如果不存在任何类型的东西，那么将大表映射到 Solr 的好策略是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T10:18:17.017

The problem with database to Solr mapping is that there are too many different databases and lack of standards on DB types (just look at frameworks like Hibernate which attempt to handle every corner case).

On top of that you have all sorts of Solr-specific complexities (analyzers, filters, sorting, etc.) which makes it quite hard to make a generic mapping tool.

Anyway, I believe that few major types should cover most of the cases:

*   LongField (signed 64 bit long)
*   IntField (signed 32 bit int)
*   StrField (single string)
*   TextField (text)
*   DoubleField (64-bit IEEE floating point)
*   BoolField (boolean)

For a complete list of Solr types, refer to [the manual](http://lucidworks.lucidimagination.com/display/solr/Field+Types+Included+with+Solr).

# c# - 上午和下午 12 小时的时间正则表达式

> ID：14044643
> 
> 赞同：1
> 
> 时间：2012-12-26T18:32:27.137
> 
> 标签：c#, regex

我做了这个正则表达式

```
 ^(00|0[0-9]|1[012]):[0-5][0-9]? ((a|p)m|(A|P)M)$ 
```

但问题是它正在接受 00:00 am 我不想像这样如何忽略？我希望时间采用这种格式 12:12 am 它不应该采用这种格式 00:21 am 我正在使用此代码进行验证

```
 private bool valtime()
    {
        Regex regex = new Regex("^(00|0[0-9]|1[012]):[0-5][0-9]? ((a|p)m|(A|P)M)$");
        if (regex.IsMatch(textBox1.Text))
        {
            return false;
        }
        else
        {
            return true;
        }
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-26T18:41:21.200

你可以使用：

```
Regex.IsMatch(input, @"^(0[1-9]|1[0-2]):[0-5][0-9] [ap]m$", RegexOptions.IgnoreCase); 
```

# php - PHP 中的内存友好 JSON 验证

> ID：14044648
> 
> 赞同：3
> 
> 时间：2012-12-26T18:33:04.453
> 
> 标签：php, validation, json

`JSON`我正在尝试验证in的一大块`PHP`。

不需要使用实际数据，我只需要验证它。

我不能使用`json_decode`，因为它超出了内存限制。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T18:37:52.160

我希望您可以计算控制结构（方括号和大括号），如果打开/关闭结构的数量相同，您可以部分赌 JSON 没问题。有很多方法仍然可能是错误的，比如不正确的嵌套，但我认为验证字符串的唯一真正好的方法是解码它。您可能会考虑提高内存限制，或者让 JSON 的作者发送子集，以便您可以解码子集并验证对象的每个部分组件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T21:07:38.430

这是关于使用正则表达式进行验证的讨论（不解析内容）正则 [表达式来验证 JSON](https://stackoverflow.com/questions/2583472/regex-to-validate-json)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T03:25:40.147

正确的方法是构建解析器。查看[这篇文章](http://www.codediesel.com/php/building-a-simple-parser-and-lexer-in-php/)或对构建解析器的过程进行一些研究。基本上，这意味着为 JSON 定义一个语法（在[http://JSON.org](http://JSON.org)上已经为您完成了很多工作），然后构建函数来检查相应的机器来处理每种类型的令牌。这将减少执行处理所需的内存量（在理想的实现中，它可能会下降到最大 JSON 值的大小）。

在 Google 上进行一些搜索以确保您没有重新发明轮子可能是值得的。

# android - Android服务未启动

> ID：14044649
> 
> 赞同：1
> 
> 时间：2012-12-26T18:33:05.403
> 
> 标签：android

我正在开发一个带有服务的应用程序（继承自[Service](http://developer.android.com/reference/android/app/Service.html)）。该服务通过清单启动：

```
<application ...>
  ...
  <service android:enabled="true" android:name=".NotificationService" />
</application> 
```

这曾经奏效。现在，突然（代码没有明显变化），它停止了工作。当我调试我的应用程序时，**服务根本没有启动**。

*   是的，该服务与主要活动在同一个包中。
*   是的，`service`标签在`application`标签内。
*   是的，我已经卸载了我的应用程序以确保我有一个干净的环境。
*   是的，我已经多次重启我的设备。
*   不，`Debug.waitForDebugger()`服务中的 a 不会触发。

我已经清理了项目。我已经重新启动了 Eclipse。不知道我还能尝试什么。请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T14:27:06.727

`startService`从未被调用。因此，我的代码中有一个错误。然而，我的问题确实指出了一些可能被证明有用的陷阱:)

# php - mysql - php - 在插入时删除 url 的第一部分

> ID：14044651
> 
> 赞同：0
> 
> 时间：2012-12-26T18:33:15.483
> 
> 标签：php, mysql, url, file-upload

我正在使用 Mysql 数据库和 PHP 做一个图片库 CMS。我是新手。

我有路径问题。

这是我的文件结构：this php doc - `root/php/upload_portrait.php`. 我的图像存储在这里 - `root/images/portrait_gallery/`

所以我添加了`../`保存图像的`root/images/portrait_gallery/` 效果很好。

但在数据库中，url 与 ../ 一起存储，并且该路径不正确，因为它们是从根索引文件中调用的。所以没有图像显示。

如何删除数据库中的`../`on `INSERT INTO`？

我试过替换和更新，但不知道怎么做。

这是我的代码

```
$portrait_url= $_FILES['upload'];

// 2\. connect to database: 
include 'connect.php';

// 4\. handle moving image from temp location to images folder (using the function billedupload)
$billedurl = billedupload($portrait_url);       
if($billedurl == false){        
    die("Something is wrong");
}

// 5\. Insert imageupload in database:
$query = "INSERT INTO portrait (portrait_id, portrait_url) VALUES ('$portrait_id', '$billedurl')";
$result = mysqli_query($dblink, $query) or die( "Forespørgsel 2 kunne ikke udføres: " . mysqli_error($dblink) );

// 6\. close connection
mysqli_close($dblink);

function billedupload($filearray){      
    if($filearray['type']=='image/jpeg' or $filearray['type']=='image/png'){
        $tmp_navn = $filearray['tmp_name'];             
        $filnavn = $filearray['name'];          
        $url = '../images/portrait_gallery/' . time() . $filnavn;           
        move_uploaded_file($tmp_navn, $url);            
    return $url;    
    } 
    else{           
        return false;       
    }   
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T18:42:18.107

我相信你有两个选择。

1.  更改 billed upload() 的 $url 行并删除 ../ 那里，因为您知道在阅读时不需要它。
2.  更改从数据库读取的函数并删除 ../ 那里。

str_replace() 可能是您需要的功能，如之前的海报所述。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T18:38:59.620

如果您只需要删除 '/..' - 那么，

`str_replace`是 PHP 中的一个函数，它允许您动态删除/更改部分字符串，因此，在您的代码中，

代替

`$billedurl = billedupload($portrait_url);`

和

`$billedurl = str_replace('/..','',billedupload($portrait_url));`

# jquery - JQuery AutoComplete Firing，但每行只有一个字母

> ID：14044654
> 
> 赞同：0
> 
> 时间：2012-12-26T18:33:35.813
> 
> 标签：jquery, autocomplete

[我在这里](https://stackoverflow.com/questions/4525279/jqueryui-autocomplete-only-one-character-is-displayed-per-list-item)看到了一个类似的问题，但答案对我没有帮助。

我称之为：

```
$("#Location" ).autocomplete({
    source: function(request, response) {
        $.ajax({ url: "searchAutoComplete.asp?Location=all",
            data: { term: $("#Location").val()},
            dataType: "TEXT",
            type: "POST",
            success: function(data){
            response(data);
            //response(eval('[' + data + ']');
            //alert(data);
        }
    });
    },
    minLength: 2
}); 
```

我的结果最终看起来像这样：

```
A
P
P
L
E  
,
B
A
N
A
N
A 
```

我该如何解决这个问题？提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T18:47:51.433

源回调需要使用字符串数组调用，而不是字符串。如果您的响应包含逗号分隔的字符串，则应将其拆分并将结果数组传递给`response`：

```
response(data.split(",")); 
```

# ruby-on-rails - Nginx、Rails 和 Oauth。上游过早关闭的连接

> ID：14044659
> 
> 赞同：16
> 
> 时间：2012-12-26T18:34:07.653
> 
> 标签：ruby-on-rails, http, nginx

我有一个奇怪的问题，只有在我使用 nginx 和 unicorn 时才会出现在生产环境中。当我在没有 nginx 的情况下使用独角兽时，它不会发生。

问题。我有一个简单的 oauth 身份验证，允许用户通过 GitHub 注册。在 GitHub 的授权页面上按“允许”后，用户将被重定向到回调路由。然后，他/她得到`302 Bad Gateway`错误。Nginx 日志向我显示此错误（键被替换为“...”）

> 2012/12/26 18:03:08 [错误] 1467#0: *1 上游过早关闭连接，同时从上游读取响应标头，客户端：10.0.2.2，服务器：_，请求：“GET /auth/github/callback ?code=&state=... HTTP/1.1", 上游: "http://unix:/tmp/unicorn.tm.sock:/auth/github/callback?code=...&state=...",主机：“本地主机：3000”

这是我的 nginx 配置。

```
upstream unicorn {
  server unix:/tmp/unicorn.tm.sock fail_timeout=0;
}

server {
  listen 80 default deferred;

  client_max_body_size 4G;
  server_name _;

  keepalive_timeout 75s;

  proxy_connect_timeout 60s;
  proxy_read_timeout 60s;

  root /vagrant/public;

  try_files $uri/index.html $uri.html $uri @app;

  location @app {
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header Host $http_host;

    proxy_redirect off;

    proxy_pass http://unicorn;

    proxy_buffer_size 16k;
    proxy_busy_buffers_size 16k;
  }

  error_page 500 502 503 504 /500.html;
} 
```

所以我的问题是为什么会发生这种情况，是否有任何可能的解决方法？

我已经在谷歌上搜索了一段时间，但没有运气。

更新

感谢您的评论，我刚刚尝试设置`fail_timeout=30s`并且它确实有帮助，但是请求大约需要 40 秒才能完成。但无论如何，谢谢，我会尝试使用这个参数过期。

根据建议，我稍微更新了配置，但仍然出现相同的错误。

此外，这是独角兽错误日志。似乎它会杀死需要超过 30 秒的请求，但我猜来自 oauth 站点的重定向不可能那么长......

```
(github) Request phase initiated.
(github) Callback phase initiated.
E, [2012-12-26T19:33:13.058183 #6002] ERROR -- : worker=0 PID:6005 timeout (31s > 30s), killing
E, [2012-12-26T19:33:13.067011 #6002] ERROR -- : reaped #<Process::Status: pid 6005 SIGKILL (signal 9)> worker=0
I, [2012-12-26T19:33:13.067198 #6002]  INFO -- : worker=0 spawning...
I, [2012-12-26T19:33:13.068631 #6012]  INFO -- : worker=0 spawned pid=6012
I, [2012-12-26T19:33:13.068726 #6012]  INFO -- : Refreshing Gem list
I, [2012-12-26T19:33:17.140948 #6012]  INFO -- : worker=0 ready 
```

独角兽配置

```
rails_env = ENV['RAILS_ENV'] || 'production'

worker_processes 1

listen "/tmp/unicorn.tm.sock", :backlog => 64
listen 8080, :tcp_nopush => true

timeout 30

pid "/tmp/unicorn.pid"

stderr_path "/tmp/unicorn.log"
stdout_path "/tmp/unicorn.log"

check_client_connection false 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-12-26T20:30:21.240

```
ERROR -- : worker=0 PID:6005 timeout (31s > 30s), killing 
```

不用说，你只需要在你的独角兽配置中设置超时超过 30

至少试试

```
timeout 60 
```

[http://unicorn.bogomips.org/Unicorn/Configurator.html#method-i-timeout](http://unicorn.bogomips.org/Unicorn/Configurator.html#method-i-timeout)

# javascript - Javascript 的标准时间单位是什么？

> ID：14044668
> 
> 赞同：0
> 
> 时间：2012-12-26T18:34:40.730
> 
> 标签：javascript, jquery, slideshow, pagespeed

嘿，我想弄清楚这是用什么时间单位来衡量的，有人知道吗？我认为这将是所有 JavaScript 的标准，所以我认为这就是您需要的所有信息。

非常感谢提前！

```
$('.slider-text-image').flexslider({
        animation: "fade",
        slideshowSpeed: 4000,
        animationDuration: 600,
        controlNav: true,
        keyboardNav: true,
        directionNav: false,
        pauseOnHover: true,
        pauseOnAction: true  

}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-26T18:38:08.660

通常，毫秒。

```
4000 // 4 seconds
600  // 0.6 seconds 
```

尽管在我自己的程序/动画中，我倾向于将它们存储为秒，因为我发现它更容易使用。仅在需要时转换为毫秒，因为这是某些函数所期望的`(time * 1000)`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-26T18:38:33.953

根据[此处](http://www.woothemes.com/flexslider/)的文档*：

*   **幻灯片速度**

    -- 整数：设置幻灯片循环的速度，*以毫秒为单位*

*   **动画速度**

    -- Integer：设置动画的速度，*以毫秒为单位*

*这个答案来自一个简单的谷歌搜索[jquery flexslider](https://www.google.com/?q=jquery%20flexslider#hl=en&tbo=d&output=search&sclient=psy-ab&q=jquery+flexslider&oq=jquery+flexslider&fp=546ed266f63f375)的第一个结果。请对未来的问题进行一些研究。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T18:37:42.513

没关系算出它的毫秒数，所以“4000”是 4 秒，因为一秒有 1000 毫秒。

# powershell - 通过 cygwin 运行 powershell

> ID：14044671
> 
> 赞同：1
> 
> 时间：2012-12-26T18:34:51.550
> 
> 标签：powershell, cygwin

从 cygwin 窗口运行此命令失败，因为 powershell 找不到对象“Get-EventLog”：

```
 echo "\n" | powershell.exe Get-EventLog System | Where-Object { $_.EventID -match "6009" } 
```

Get-EveneLog Systerm 查询在 Powershell 控制台上工作得很好，所以我知道这不是语法问题。我已经包含了 powershell 路径。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T18:47:28.840

After a brief trial and error session I discovered that if the query is encased in single quotes it will work :

```
powershell.exe 'Get-EventLog System | Where-Object { $_.EventID -match "6009" }' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-08T22:05:25.170

powershell.exe -command '获取事件日志系统 | Where-Object { $_.EventID -match "6009" }'

# logic - 语义推理器的健全性是什么意思？

> ID：14044673
> 
> 赞同：2
> 
> 时间：2012-12-26T18:34:59.033
> 
> 标签：logic, semantics, semantic-web

许多关于语义推理器的文章，将健全性称为推理器或推理算法的特性。但是，根据维基百科 (http://en.wikipedia.org/wiki/Soundness) 的健全性定义，我了解健全性是我的模型的一个属性，并且独立于我应用于它的推理算法。例如模型：

```
All organisms with wings can fly. 
Penguins have wings. 
```

导致以下有效（可证明？）但不合理的结果：

```
Penguins can fly. 
```

因此，当我将此模型提供给一个例如基于 Tableaux 的算法或 KAON2 推理器时，它们都被认为是合理的，它们仍然会给我这个不合理的结果。那么你能向我描述一下究竟什么是健全性吗？如果它是模型或建模语言或推理方法的特征，还是仅仅是推理结果？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T12:38:15.073

它基本上意味着正确。声音意味着推理器将仅返回正确的结果，即在知识库中明确显示或从其内容中包含的结果。不健全意味着推理器返回的结果在您的知识库中既不明确，也不包含任何公理，即不正确的结果。

完成意味着它返回*所有*答案。您可以在不完整的情况下保持健全，即返回所有正确答案的子集。在某些用例中，这可能是可取的。

你也可以是完整的，但不健全；您返回所有正确的答案，以及一些不正确的答案。

在您的示例中，结果对您来说只是不合理的，因为您有知识库没有的信息，即企鹅不能飞。从推理者的角度来看，这是一个合理的结果。它不能证实它所提供的事实的真实性，它只是用它们来暗示新的事实。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T18:49:16.550

论证是有效的，但前提之一是不正确的。所以这个论点是不成立的。

我认为推理者无法确定您的前提是否正确-如果可以，那将是非常具有革命性的:)

# java - Java 7 看似奇怪的行为，在调试消息中放置了空字符串

> ID：14044678
> 
> 赞同：1
> 
> 时间：2012-12-26T18:35:34.127
> 
> 标签：java, debugging

在我的程序中，至少对我来说，我注意到奇怪的行为。

输出错误：

```
public static void main(String[] args)
    {
        while(count < 3)
        {
            System.out.println("Count: " + count);
            System.out.println("" +(count*2)+1);
            count++;
        }
    } 
```

产生以下打印语句：

```
Count: 1
21
Count: 2
41 
```

而这个程序：

```
public static void main(String[] args)
    {
        while(count < 3)
        {
            System.out.println("Count: " + count);
            System.out.println((count*2)+1 + "");
            count++;
        }
    } 
```

产生这个输出：

```
Count: 1
3
Count: 2
5 
```

我的问题是，当您将空字符串 , 放在算术表达式的前面时，Java 7 是否会做一些特殊的事情，`""`而当空字符串跟随该算术表达式时它不会做一些特殊的事情？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-26T18:36:40.427

`+`运算符有两种含义。
`number + number`表示加法；`string + anything`表示字符串连接。

`+`运算符是左结合的。
因此，`"" + a + b"`被解析为`("" + a) + b`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-26T18:39:49.060

你的括号有问题。

```
("" +(count*2)) + 1 
```

和

```
(count*2 + 1) + "" 
```

不一样。

# model-view-controller - 胖模型和瘦控制器听起来像是在创造上帝模型

> ID：14044681
> 
> 赞同：104
> 
> 时间：2012-12-26T18:36:02.607
> 
> 标签：model-view-controller, design-patterns, architecture, god-object

我一直在阅读很多提倡*胖模型和瘦控制器*方法的博客，尤其是。Rails 营地。结果，路由器基本上只是弄清楚在什么控制器上调用什么方法，而所有控制器方法所做的就是调用模型上的相应方法，然后调出视图。所以我在这里有两个我不明白的问题：

1.  控制器和路由器实际上并没有做太多不同的任务，只是在基于路由的上帝模型上调用一个方法。
2.  模特做的太多了。发送电子邮件、创建关系、删除和修改其他模型、排队任务等。基本上，现在您拥有神一样的对象，它们应该完成所有可能与建模和处理数据有关的事情。

你在哪里画线？这不就是掉入神模式了吗？

* * *

## 回答 #1

> 赞同：165
> 
> 时间：2012-12-26T19:53:50.653

> [将 Rails 视为 MVC 设计模式的主要内容可能不是最好的主意。[所述框架存在一些固有的缺点（我在另](https://stackoverflow.com/a/11984678/727208)一篇文章中对此进行了详细阐述），而社区直到现在才开始解决后果。您可以将 DataMapper2[开发](http://www.youtube.com/watch?v=MU4RvuvpT8w)视为第一个主要步骤。]

### 一些理论

给出这种建议的人似乎受到了一个非常普遍的误解的困扰。因此，让我首先澄清一下：**在现代 MVC 设计模式中，模型不是类或对象。**模型是一层。

MVC 模式背后的核心思想是[*关注点分离，*](https://en.wikipedia.org/wiki/Separation_of_concerns)其中的第一步是表示层和模型层之间的划分。就像表示层分解为控制器（实例，负责处理用户输入）、视图（实例，负责 UI 逻辑）和模板/布局一样，模型层也是如此。

模型层由以下主要部分组成：

*   [领域对象](http://c2.com/cgi/wiki?DomainObject)

    也称为域实体、业务对象或模型对象（我不喜欢后一个名称，因为它只会增加混乱）。这些结构就是人们通常错误地称为“模型”的东西。他们负责包含业务规则（特定领域逻辑单元的所有数学和验证）。

*   存储抽象：

    通常使用[数据映射器](http://martinfowler.com/eaaCatalog/dataMapper.html)模式实现（不要与滥用此名称的[ORM混淆）。](https://en.wikipedia.org/wiki/Object-relational_mapping)这些实例的任务通常是从域对象中存储和检索信息。每个域对象可以有多个映射器，就像有多种存储形式（DB、缓存、会话、cookie、/dev/null）一样。

*   服务：

    负责应用程序逻辑的结构（即域对象之间的交互以及域对象与存储抽象之间的交互）。它们应该充当表示层与模型层交互的“接口”。这通常是在类 Rails 代码中最终出现在控制器中的内容。

在这些组之间的空间中也可能存在几种结构：[DAO](http://www.oracle.com/technetwork/java/dataaccessobject-138824.html)、[工作单元](http://martinfowler.com/eaaCatalog/unitOfWork.html)和[存储库](http://martinfowler.com/eaaCatalog/repository.html)。

> [哦……当我们（在网络环境中）谈论与 MVC 应用程序交互的*用户*时，它不是人类。“用户”实际上是您的网络浏览器。]

### 那么神器呢？

控制器应该与服务交互，而不是使用一些可怕的单体模型。您将数据从用户输入传递到特定服务（例如`MailService`或`RecognitionService`）。通过这种方式，控制器改变了模型层的状态，但它是通过使用清晰的 API 来完成的，并且不会弄乱内部结构（这会导致抽象泄漏）。

此类更改可能会立即引起一些反应，或仅影响视图实例从模型层请求的数据，或两者兼而有之。

每个服务都可以与任意数量（尽管通常只有少数）域对象和存储抽象进行交互。例如，`RecogitionService`对文章的存储抽象不太关心。

### 结束语

通过这种方式，您可以获得可以在任何级别进行单元测试的应用程序，具有低耦合（如果正确实现）并且具有清晰易懂的架构。

不过，请记住：MVC 不适用于小型应用程序。如果您正在使用 MVC 模式编写留言簿页面，那么您做错了。此模式用于在大规模应用程序中执行*法律和秩序。*

> [对于使用 PHP 作为主要语言的人，[这篇文章](https://stackoverflow.com/a/5864000/727208)可能是相关的。这是对模型层的更长描述，带有一些代码片段。]

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-26T19:08:24.107

如果“模型”类的实现很差，是的，您的担忧是相关的。模型类不应该做电子邮件（基础设施任务）。

真正的问题是 MVC 中的模型意味着什么。它不限于具有几种方法的 POCO 类。MVC 中的模型意味着数据和业务逻辑。将其视为经典核心 POCO 模型的超集。

**视图 ==== 控制器 ==== 模型 ---> 业务流程层 --> 核心模型**

投入基础设施程序集和数据访问层并使用注入将其传递给 BPL，然后您的流程将按预期使用 MVC。

BPL 可以调用 UoW / Respository 模式，并通过注入的对象或接口模式执行业务规则和调用基础设施功能。

所以建议保持控制器瘦身并不意味着经典Core模型中的“人”类应该有50个方法，并且直接调用Email。你认为这是错误的是对的。

如果直接调用，控制器可能仍需要实例化基础设施类并将其注入 BPL 或核心层。应该有一个业务层或至少有一个类来编排跨经典对象模型类的调用。好吧，这就是我的“观点”；-)

对于 MVC 的通用性，wiki 描述[http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller)

一个关于 MVC 中“M”的小博客。[http://www.thedeveloperday.com/skinny-controllers/](http://www.thedeveloperday.com/skinny-controllers/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-26T18:54:30.170

我认为您可以区分单个胖模型（可能命名为 App 或应用程序）和分解为逻辑组（业务、客户、订单、消息）的几个胖模型。后者是我构建应用程序的方式，每个模型大致对应于关系数据库中的数据库表或文档数据库中的集合。这些模型处理创建、更新和操作构成模型的数据的所有方面，无论是与数据库通信还是调用 API。控制器非常负责调用适当的模型和选择模板。

# javascript - 使用 Highcharts 构建仪表板

> ID：14044682
> 
> 赞同：2
> 
> 时间：2012-12-26T18:36:05.013
> 
> 标签：javascript, highcharts, dashboard

我想用 Highcharts 构建一个轻量级的仪表板。首先，看看这张图[http://jsfiddle.net/jerryvermanen/Zr7zE/](http://jsfiddle.net/jerryvermanen/Zr7zE/)。

我想用这个可视化制作一个仪表板。单击某个点时，我想在可视化下方显示其他信息。例如，我想展示一张图片 (.jpg)、关于这一点的更多信息以及指向特定来源的 URL。

```
$(function () {
var chart;
$(document).ready(function() {
    chart = new Highcharts.Chart({
        exporting: {
        enabled: false
        },
        chart: {
            renderTo: 'container',
            type: 'scatter',
            zoomType: 'xy'
        },
        title: {
            text: 'DAYS BETWEEN RELEASE AND CEREMONY',
    style: {
            fontSize: '22px'
        }
        },
        subtitle: {
            text: ''
        },
        xAxis: {
            min: 0,
    reversed: true,
            title: {
                enabled: true,
                text: 'Days difference'
            },
            startOnTick: true,
            endOnTick: true,
           showLastLabel: true,
     plotLines: [{
            color: 'black',
            dashStyle: 'longdashdot',
            width: 1,
            value: 365,
            label: {
                text: 'ONE YEAR',
        y: 580,
        rotation: 0,
                textAlign: 'left',
            }            
        }]
        },
        yAxis: {
            min: 1929,
    max: 2012,
            title: {
                text: 'Year'
            },
            labels: {
                formatter: function() {
                    return this.value;
                }
            }
        },
        tooltip: {
            formatter: function() {
                    return '<b>'+ this.series.name +'</b><br/>'+
                    'In<b>'+this.y +'</b>this movie was released<br/><b>'+ this.x +'</b>days from the ceremony.';
            }
        },
        legend: {
    enabled: false
        },
        credits: {
    enabled: false
    },
        plotOptions: {
            scatter: {
                marker: {
                    radius: 4,
                    states: {
                        hover: {
                            enabled: true,
                            lineColor: 'rgb(100,100,100)'
                        }
                    }
                },
                states: {
                    hover: {
                        marker: {
                            enabled: false
                        }
                    }
                }
            }
        },
        series: [{
            name: 'Nominees',
            marker: {
                symbol: 'circle'
            }, 
```

谁能帮我完成这个项目？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T19:06:23.013

您可以使用以下代码将单击事件绑定到该点。

```
plotOptions: {
    scatter: {
        point: {
            events: {
                click: function() {
                    // do what you want
                    // you can get the point reference using `this`
                }
            }
        }
    }
} 
```

[**演示**](http://jsfiddle.net/Zr7zE/2/)

# php - 如何使用 PHP 在文本文件中添加数字？

> ID：14044684
> 
> 赞同：1
> 
> 时间：2012-12-26T18:36:08.347
> 
> 标签：php, addition

我目前有一个如下所示的文本文件：

```
Test1 = 120827 = December 23, 2012:
Test2 = 147203 = December 23, 2012:
Test3 = 11806 = December 23, 2012:
Test4 = 11806 = December 23, 2012:
Test5 = 0 = December 23, 2012: 
```

我想要做的是将第二列中的所有数字加在一起。我怎样才能用 PHP 做到这一点？我的实际文件比这个大得多。

```
Test1 = *120827 = December 23, 2012:
Test2 = *147203 = December 23, 2012:
Test3 = *11806 = December 23, 2012:
Test4 = *11806 = December 23, 2012:
Test5 = *0 = December 23, 2012: 
```

*我要补充的。

任何帮助将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T18:43:21.440

PHP：

```
$sum = 0;
foreach (file($filename) as $line) {
   list(,,$num) = explode(' ', $line);
   $sum += $num;
} 
```

如果文件太大，请使用`fopen`+`fgets`而不是`file`.

重击：

```
cut -d' ' -f3 filename | paste -sd+ | bc 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T18:58:32.913

```
<?php
$pattern = '/(?<=\=\s)([0-9]+)(?=\s\=)/';
$total = 0;
$matches;
$filename = "add.txt";
$handle = @fopen($filename, "r");

if ($handle) {
    while (($buffer = fgets($handle, 4096)) !== false) {        
        if(preg_match($pattern, $buffer, $matches))
        {
            $total += intval($matches[0]);  
        }       
    }
    if (!feof($handle)) {
        echo "Error: unexpected fgets() fail\n";
    }
    fclose($handle);
}

?> 
```

# ruby-on-rails - rails：accepts_nested_attributes_for和属性修改ajax

> ID：14044687
> 
> 赞同：1
> 
> 时间：2012-12-26T18:36:37.707
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我正在为 has_many 关系上具有 accept_nested_attributes_for 的实体构建修改表单。我希望在修改单个输入时，使用 ajax 将信息发送到服务器。

假设我们拥有一个实体用户，与帖子有关系

使用 jquery 我可以修改主要实体属性：

```
$.post("/user/1", data={"_method":"put", "user[name]":"My New name"}) 
```

但是，当我使用：

```
$.post("/user/1", data={"_method":"put", "user[posts_attributes][0][text]":"my modified post"}); 
```

帖子未修改，但使用给定文本创建了一个新帖子。我需要包含帖子ID吗？

谢谢

# c# - 测试“Base-64 字符串中的无效字符”

> ID：14044708
> 
> 赞同：0
> 
> 时间：2012-12-26T18:38:12.480
> 
> 标签：c#, .net, base64, html-encode

我在我的应用程序日志中经常看到“Base-64 字符串中的无效字符”错误。我已经阅读了一系列可能出现的不同原因以及一些潜在的修复方法。问题是我无法在本地重现错误。

我相信它会在`HttpUtility.HtmlEncode`电话中出现，但我不确定。

这是我的 StackTrace 错误：

```
at System.Convert.FromBase64String(String s)     
at System.Web.UI.ObjectStateFormatter.Deserialize(String inputString)     
at System.Web.UI.Util.DeserializeWithAssert(IStateFormatter formatter, String serializedState)     
at System.Web.UI.HiddenFieldPageStatePersister.Load() 
```

错误发生在电子邮件提交表单上；用户输入姓名、电子邮件地址和消息，然后通过 SMTP 将其发送到每个指定的电子邮件地址。

我正在寻找一些可以尝试并强制此错误发生的方法，以便我可以修复它。

代码段如下：

```
 var emailMessage = new MailMessage();
    emailMessage.From = new MailAddress(emailAddress, name);
    emailMessage.Subject = "Subject";
    emailMessage.Body = HttpUtility.HtmlEncode(message);
    emailMessage.To.Add(new MailAddress(contactEmailAddress, contactName));
    var smtpClient = new SmtpClient(ConfigurationManager.AppSettings["SMTPServer"]);
    smtpClient.Send(emailMessage); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T21:49:00.690

像任何好的标准一样，Base64 也有很多可供选择。这篇[维基百科文章](http://en.wikipedia.org/wiki/Base64#Variants_summary_table)列出了常见的变体，其中一些将被 .NET 方法拒绝。麻烦的是索引 63 和 64 的字符，.NET 编码器使用 + 和 /。并且需要填充，但这会产生另一个异常。

您需要改进您的错误日志记录才能真正了解您正在处理的内容。

# string - 用 JRE 库替换 StrSubstitutor

> ID：14044715
> 
> 赞同：9
> 
> 时间：2012-12-26T18:38:55.923
> 
> 标签：string, text, java

目前我正在使用`org.apache.commons.lang.text.StrSubstitutor`：

```
Map m = ...
substitutor = new StrSubstitutor(m);

result = substitutor.replace(input); 
```

鉴于我想`commons-lang`从我的项目中删除依赖项，`StrSubstitutor`使用标准 JRE 库的工作和简约实现是什么？

**注意**：

`StrSubstitutor`像这样工作：

```
Map map = new HashMap();
map.put("animal", "quick brown fox");
map.put("target", "lazy dog");
StrSubstitutor sub = new StrSubstitutor(map);
String resolvedString = sub.replace("The ${animal} jumped over the ${target}."); 
```

yielding resolvedString = "那只敏捷的棕色狐狸跳过了那只懒狗。"

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-26T19:47:35.853

~~如果性能不是优先级，~~您可以使用[类的](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/regex/Matcher.html#appendReplacement%28java.lang.StringBuffer,%20java.lang.String%29)[`appendReplacement`方法`Matcher`](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/regex/Matcher.html#appendReplacement%28java.lang.StringBuffer,%20java.lang.String%29)：

```
public class StrSubstitutor {
    private Map<String, String> map;
    private static final Pattern p = Pattern.compile("\\$\\{(.+?)\\}");

    public StrSubstitutor(Map<String, String> map) {
        this.map = map;
    }

    public String replace(String str) {
        Matcher m = p.matcher(str);
        StringBuilder sb = new StringBuilder();
        while (m.find()) {
            String var = m.group(1);
            String replacement = map.get(var);
            m.appendReplacement(sb, replacement);
        }
        m.appendTail(sb);
        return sb.toString();
    }
} 
```

一个性能更高但更丑的版本，只是为了好玩:)

```
 public String replace(String str) {
        StringBuilder sb = new StringBuilder();
        char[] strArray = str.toCharArray();
        int i = 0;
        while (i < strArray.length - 1) {
            if (strArray[i] == '$' && strArray[i + 1] == '{') {
                i = i + 2;
                int begin = i;
                while (strArray[i] != '}') ++i;
                sb.append(map.get(str.substring(begin, i++)));
            } else {
                sb.append(strArray[i]);
                ++i;
            }
        }
        if (i < strArray.length) sb.append(strArray[i]);
        return sb.toString();
    } 
```

根据我的测试，它比正则表达式版本快 2 倍，比 apache commons 版本快 3 倍。所以普通的正则表达式实际上比 apache 版本更优化。当然通常不值得。只是为了好玩，让我知道您是否可以使其更优化。

**编辑**：正如@kmek 指出的那样，有一个警告。Apache 版本将传递解析。例如，如果`${animal}`映射到`${dog}`和`dog`映射到`Golden Retriever`，apache 版本将映射`${animal}`到金毛猎犬。正如我所说，您应该尽可能使用库。仅当您有一个不允许您使用库的特殊约束时，才使用上述解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T18:49:39.000

我知道 JRE 中没有这样的东西，但是写一个很简单。

```
Pattern p = Pattern.compile("${([a-zA-Z]+)}";
Matcher m = p.matcher(inputString);
int lastEnd = -1;
while (m.find(lastEnd+1)) {
   int startIndex = m.start();
   String varName = m.group(1);
   //lookup value in map and substitute
   inputString = inputString.substring(0,m.start())+replacement+inputString.substring(m.end());
   lastEnt = m.start() + replacement.size();
} 
```

这当然是非常低效的，您可能应该将结果写入 StringBuilder 而不是一直替换 inputString

# php - 使用 HTML 下拉菜单中的值调用 PHP 函数

> ID：14044717
> 
> 赞同：2
> 
> 时间：2012-12-26T18:39:00.807
> 
> 标签：php, html, drop-down-menu

我正在创建一个包含购物车功能的网站，并且遇到了从 HTML/Javascript 到 PHP 来回传递变量的问题。我知道这些语言根本不同，希望有人能提供一些指导。我已经看到了几个关于类似主题的问题，但不幸的是还没有找到适合我情况的解决方案。

我在 php 中创建了一个多维产品数组，并希望从下拉菜单中捕获值以调用一个函数，其中下拉菜单的值对应于产品数组中的一行。我的产品列表出现在 HTML 表格中。我已经尝试过 $_GET 和 $_POST，但没有任何运气。另外，我想避免添加提交按钮，因为 print_wp_cart_button_for_product 函数会输出添加到购物车按钮。print_wp_cart_button_for_product 还会在侧边栏上创建购物车。

```
<TD>
  <form action="<?php echo $_SERVER['PHP_SELF'];?>" method="get">
  <select id="productcat1" name="productcat1">
    <option value="$">--Please Select--</option>
    <option value="1">Product # 1 - $1.99</option>
    <option value="2">Product # 2 - $1.99</option>
    <option value="3">Product # 3 - $9.99</option>
    <option value="4">Product # 4 - $9.99</option>
  </select>
  </form>
</TD>
<TD>    
  <?php $currentrow = 0; ?>
  <?php $currentrow = $_GET["productcat1"]; ?>
  <?php echo print_wp_cart_button_for_product($products[$currentrow]["Product"], $products[$currentrow]["Price"]); ?>
</TD> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T18:54:54.070

由于 PHP 是一种服务器端语言，它无法知道客户端发生了什么（即用户浏览器中正在发生的事情，例如他们选择了哪个下拉菜单）。您必须使用 javascript/ajax 来完全运行您的函数，或者将选定的选项传回服务器以运行 PHP 函数。或者，您可以通过提交表单与没有 javascript/ajax 的服务器进行通信，但您说您不想这样做。

祝你好运！

# javascript - toFixed 挂起我的代码

> ID：14044718
> 
> 赞同：2
> 
> 时间：2012-12-26T18:39:03.633
> 
> 标签：javascript

我正在练习练习并遇到了这个问题。

这个问题问：

> “提示输入大于 1 且保留 4 位小数的数字。使用 toFixed() 方法将数字格式化并写入显示的页面，仅显示小数点后 2 位数字。（例如 12.35，而不是 12.3453）
> 
> 由于此方法非常新，因此在旧浏览器中不起作用。看看你是否可以在不使用 toFixed() 的情况下只显示小数点后 2 位数字。”</p>

我通过这里的档案 Math.round(n*100)/100 找到了困难部分的答案。感谢那。但是当我尝试“简单”的方法时，我什么也得不到。我的工作是在[jsFiddle](http://jsfiddle.net/QYBHU/)，但简而言之：

```
var num = prompt("Give me a number greater than one, with 4 decimal places.");
var num2 = prompt("Great! Do one more, please!");

num = Math.round(num*100)/100;
num2 = num2.toFixed(2);

alert(num);
alert(num2); 
```

该练习没有要求第二个数字，但我想在不同的事件中使用这两种方法。当我运行它时，它不会发出任何警报。我知道它挂在 toFixed 语句上，因为当我将其注释掉时，它会按预期提示 num1 的小数点后 2 位和提示的 num2（即 1.2345）。

所以这是我到目前为止所做的：

Mozilla 的开发者页面显示这种格式：n.toFixed(1);// Returns "12345.7": note rounding

似乎正是我在做什么。

我将所有内容复制并粘贴到我的 Sublime 中，确保我在结束 body 标记之前调用了 .js 文件，以确保它不是我不理解的加载问题。

加上各种小调整。

很抱歉一直问这些问题，但是由于我是自学的，我还有其他地方可以去！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T18:43:31.660

你需要使用`parseFloat`. 使用该函数会将字符串转换为浮点类型变量，从而使`toFixed`函数能够正常工作。

```
num2 = parseFloat(num2).toFixed(2); 
```

# c++ - Windows 8 上的 C++ 在启动后立即关闭程序

> ID：14044719
> 
> 赞同：2
> 
> 时间：2012-12-26T18:39:09.527
> 
> 标签：c++, windows, eclipse, macos

我安装了 minGW 和 eclipse CDT，控制台一直在做一些奇怪的事情。该程序的代码是

```
using namespace std;
#include <iostream>

int main() {
    cout << "Hello, windows (8, c++)" << endl;
    //system("PAUSE");
    return 0;
} 
```

大家都知道，它是Hello World 程序。现在，当我运行它时，Eclipse 控制台会显示一些关于构建的内容，然后变为空白。当我在资源管理器中导航到 HelloWorldProgram.exe 并运行它时，一个窗口会闪现并显示“hello world”，然后立即关闭。当我在 Mac OSX 上执行此操作时，没有问题，并且窗口会一直打开，直到我决定关闭它。现在我知道有一个命令

```
system("PAUSE") //I dont know what I need to import to use this. Could you tell me that too? 
```

这会给我或多或少相同的效果，但我想知道为什么 Windows 的做法与 OSX 不同，以及我能做些什么来修复它（这让我很恼火）。期待您的回复！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T18:44:48.003

这发生在 Windows 上，因为这只是 Windows 控制台的行为。如果您不希望在程序执行后自动关闭窗口，则必须手动打开控制台，然后通过打开的控制台运行程序。

你可能想看看这些：

[解决控制台关闭问题的最佳实践是什么？](https://stackoverflow.com/questions/1173208/what-is-the-best-practice-for-combating-the-console-closing-issue)

[https://superuser.com/questions/186562/how-can-i-keep-the-terminal-open](https://superuser.com/questions/186562/how-can-i-keep-the-terminal-open)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T18:45:25.673

不要使用`system("pause")`，由于多种原因，它是错误的（[在此处](https://stackoverflow.com/questions/1107705/systempause-why-is-it-wrong)阅读更多信息）。

放在`cin.get()`前面`return`，窗口将保持打开状态，直到您按 Enter。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-26T18:46:02.647

如果你只想运行你的控制台程序，你应该打开一个控制台，然后运行它。

显然，Eclipse 的 OSX 版本被配置为打开控制台并运行程序，而不是关闭它。也许你也可以配置 Win 版本。

您**不应该干预您的程序以在另一个平台上表现不同**，而是将其包装成“适应”行为的东西。

或许，您可以告诉 eclipse 使用“ [cmd /c](http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/cmd.mspx?mfr=true) 'yourprogram.exe && pause'”来打开命令窗口并让它执行您的程序，然后暂停。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-14T07:06:51.580

只需`getch();`在返回之前添加，然后添加`#include <conio.h>`.

# c# - 通过 ftp 上传文本文件，但文件为空白/空

> ID：14044723
> 
> 赞同：1
> 
> 时间：2012-12-26T18:39:24.057
> 
> 标签：c#, .net, ftp

以下是将 txt 文件从某个位置复制到 ftp 路径的代码片段：

```
WebRequest WRequest = WebRequest.Create(FtpPath + OriginalfileName);
WRequest.Method = WebRequestMethods.Ftp.UploadFile;
WRequest.Credentials = new NetworkCredential("myusername", "FtpPassword");
FileStream stream = File.OpenRead(OriginalFilePath);
byte[] buffer = new byte[stream.Length];
Stream RStream = WRequest.GetRequestStream();
RStream.Write(buffer, 0, buffer.Length);
RStream.Close(); 
```

但是在 ftp 目的地复制的文件总是空的。为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T18:42:15.887

您没有使用文件的内容填充缓冲区。您只是在以下代码行中设置长度：

```
byte[] buffer = new byte[stream.Length]; 
```

而且您也没有在其他任何地方填充文件的内容，因此您只是将空数据发送到 FTP 服务器。字节可能有一定的长度，但都是空字节。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-26T18:53:25.770

作为一个简单的解决方案，您可以使用[WebClient](http://msdn.microsoft.com/en-us/library/tt0f69eh.aspx)类

```
WebClient client = new WebClient();
client.Credentials = new NetworkCredential("username", "password");
client.UploadFile(uriString,fileName); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-26T18:49:36.867

您可以在写入字节时应用相同类型的逻辑，但在我的情况下，我传入了初始大小

```
public static void CopyStream(Stream input, Stream output)
{

    byte[] buffer = new byte[1024];

    int bytesRead;
    while ((bytesRead = input.Read(buffer, 0, buffer.Length)) > 0)
    {
        output.Write(buffer, 0, bytesRead);
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-26T18:55:02.763

这应该有效：

```
WebRequest WRequest = WebRequest.Create(FtpPath + OriginalfileName);
WRequest.Method = WebRequestMethods.Ftp.UploadFile;
WRequest.Credentials = new NetworkCredential("myusername", "FtpPassword");
using (FileStream stream = File.OpenRead(OriginalFilePath)) {
  using (Stream RStream = WRequest.GetRequestStream()) {
    stream.CopyTo(RStream);
  }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-09-29T10:55:50.793

这是asp.net core 2.1中使用IFormFile上传文件的解决方案

```
// Get the object used to communicate with the server.
                FtpWebRequest request = (FtpWebRequest)WebRequest.Create("*******/site/wwwroot/wwwroot/images/" + TempFileName);
                request.Method = WebRequestMethods.Ftp.UploadFile;
                request.UseBinary = true;
                request.KeepAlive = false;
                request.Method = "STOR";
                request.Credentials = new NetworkCredential("***", "****");

                // Copy the contents of the file to the request stream.
                byte[] fileContents = null;

                if (vehicle.FileUpload.Length > 0)
                {
                    using (var ms = new MemoryStream())
                    {
                        await vehicle.FileUpload.CopyToAsync(ms);
                        var fileBytes = ms.ToArray();
                        fileContents = fileBytes;
                    }
                }
                request.ContentLength = fileContents.Length;

                using (Stream requestStream = request.GetRequestStream())
                {
                    requestStream.Write(fileContents, 0, fileContents.Length);
                } 
```

这是文件的视图模型

```
public class VehicleSeriesViewModel
    {
        public Guid VehicleBadgeId { get; set; }
        public Guid VehicleSeriesId { get; set; }
        public string Name { get; set; }
        public DateTime CreatedAt { get; set; }
        public DateTime? UpdatedAt { get; set; }
        public IFormFile FileUpload { get; set; }
        public string PictureUrl { get; set; }
    } 
```

# vb.net - 如何从给定的 DataTable 列中删除字符？

> ID：14044727
> 
> 赞同：0
> 
> 时间：2012-12-26T18:39:41.913
> 
> 标签：vb.net, datatable

我有一列`TOTAL_DOLLARS`包含`String`要转换为的值`Decimal`。但是，这些值`$`前面也有一个字符（因为它们是美元金额）。我想删除这个`$`字符，虽然我找不到这样做的方法。

这是我正在尝试的：

```
For Each row As DataRow In myTable.Rows
    Replace(row.Item("TOTAL_DOLLARS"), "$", "")
Next 
```

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T18:51:41.760

假设您的 TOTAL_DOLLARS 列包含作为字符串的值，则应该执行以下操作：

```
For Each row As DataRow In myTable.Rows
    Dim dollarsInRow As Decimal
    dollarsInRow = Convert.ToDecimal(row.Item("TOTAL_DOLLARS").Replace("$", String.Empty))
Next 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T18:56:45.780

假设您想在“TOTAL_DOLLARS”列上保持数据完整性，只需添加所需类型的新列并循环填充它：

```
myTable.Columns.Add("Total", GetType(Decimal))
For Each row As DataRow In myTable.Rows
    row("Total") = Convert.ToDecimal(row("TOTAL_DOLLARS").ToString.Replace("$", ""))
Next 
```

或像这样（保留NULL）：

```
myTable.Columns.Add("Total", GetType(Decimal))
For Each row As DataRow In myTable.Rows
    If Not IsDBNull(row("TOTAL_DOLLARS")) Then
        row("Total") = Convert.ToDecimal(row("TOTAL_DOLLARS").ToString.Replace("$", ""))
    Else
        row("Total") = System.DBNull.Value
    End If
Next 
```

# iphone - 具有左右 Y 轴的核心绘图图

> ID：14044734
> 
> 赞同：4
> 
> 时间：2012-12-26T18:40:12.700
> 
> 标签：iphone, core-plot

我已经四处寻找（甚至找到了）一些关于如何做到这一点的例子，但我似乎无法让它发挥作用。无论我做什么，我都无法让另一个轴显示在图表的右侧。我觉得这可能是我错过的一件愚蠢的事情。

这是用于生成图表的所有代码。我正在绘制一天中几个小时的值。最终每个 Y 轴都会有不同的比例，但目前我只想显示另一个轴。

```
CPTXYGraph *graph = [[CPTXYGraph alloc] initWithFrame:CGRectZero xScaleType:CPTScaleTypeDateTime yScaleType:CPTScaleTypeLinear];

CPTTheme *theme = [CPTTheme themeNamed:@"CustomTheme"];
[graph applyTheme:theme];

graph.paddingLeft = 2.0;
graph.paddingTop = 2.0;
graph.paddingRight = 2.0;
graph.paddingBottom = 2.0;

graph.plotAreaFrame.paddingLeft = 30.0;
graph.plotAreaFrame.paddingTop = 20.0;
graph.plotAreaFrame.paddingRight = 15.0;
graph.plotAreaFrame.paddingBottom = 30.0;

UIColor *darkTextColor = [UIColor colorWithRed:0.325 green:0.322 blue:0.333 alpha:1.000];

CPTMutableTextStyle *textStyle = [CPTMutableTextStyle textStyle];
textStyle.color = [CPTColor colorWithCGColor:[darkTextColor CGColor]];
textStyle.fontSize = 10.0;
graph.titleTextStyle = textStyle;
graph.titleDisplacement = CGPointMake(0.0f, -10.0f);
graph.titlePlotAreaFrameAnchor = CPTRectAnchorTop;

// Setup plot space
CPTXYPlotSpace *plotSpace = (CPTXYPlotSpace *)graph.defaultPlotSpace;
plotSpace.allowsUserInteraction = NO;
plotSpace.xRange = [CPTPlotRange plotRangeWithLocation:CPTDecimalFromFloat(0.0) length:CPTDecimalFromFloat(24.0 * D_HOUR)];
plotSpace.yRange = [CPTPlotRange plotRangeWithLocation:CPTDecimalFromFloat(0.0) length:CPTDecimalFromFloat(400.0)];

CPTXYPlotSpace *plotSpace2 = [[CPTXYPlotSpace alloc] init];
plotSpace2.xRange = plotSpace.xRange;
plotSpace2.yRange = [CPTPlotRange plotRangeWithLocation:CPTDecimalFromFloat(0.0) length:CPTDecimalFromFloat(400.0)];
[graph addPlotSpace:plotSpace2];

// Set axis styles
CPTXYAxis *leftY = [(CPTXYAxisSet *)graph.axisSet yAxis];
CPTXYAxis *x = [(CPTXYAxisSet *)graph.axisSet xAxis];

CPTXYAxis *rightY = [(CPTXYAxis *)[CPTXYAxis alloc] initWithFrame:CGRectZero];
rightY.coordinate = CPTCoordinateY;
rightY.plotSpace = plotSpace2;
rightY.orthogonalCoordinateDecimal = CPTDecimalFromFloat(24.0 * D_HOUR);

graph.axisSet.axes = @[x,leftY,rightY];

x.visibleRange = [CPTPlotRange plotRangeWithLocation:CPTDecimalFromFloat(0.0) length:CPTDecimalFromFloat(24.0 * D_HOUR)];
x.majorIntervalLength = CPTDecimalFromInt(D_HOUR * 2);
x.labelOffset = 3.0f;
x.titleOffset = 25.0f;
NSDateFormatter *rawFormatter = [[NSDateFormatter alloc] init];
[rawFormatter setDateFormat:@"ha"];
CPTTimeFormatter *timeFormatter = [[CPTTimeFormatter alloc] initWithDateFormatter:rawFormatter];
x.labelFormatter = timeFormatter;

leftY.visibleRange = [CPTPlotRange plotRangeWithLocation:CPTDecimalFromFloat(0.0) length:CPTDecimalFromFloat(400.0)];
leftY.gridLinesRange = x.visibleRange;
leftY.majorIntervalLength = CPTDecimalFromInt(40);
leftY.titleLocation = CPTDecimalFromFloat(20.0);
leftY.titleOffset = 14.0f;
NSNumberFormatter *noDecimalFormatter = [[NSNumberFormatter alloc] init];
[noDecimalFormatter setNumberStyle:NSNumberFormatterNoStyle];
leftY.labelFormatter = noDecimalFormatter;

// Skin right y
rightY.labelingPolicy = CPTAxisLabelingPolicyFixedInterval;
rightY.majorIntervalLength = CPTDecimalFromInt(50);
rightY.minorTicksPerInterval = 2;
rightY.orthogonalCoordinateDecimal = CPTDecimalFromDouble(0.0);
rightY.tickDirection = CPTSignNegative;
rightY.majorTickLineStyle = leftY.majorTickLineStyle;
rightY.minorTickLineStyle = nil;
rightY.axisLineStyle = leftY.axisLineStyle;
rightY.majorTickLength = 2.0;
rightY.minorTickLength = 1.0;
rightY.labelTextStyle = leftY.labelTextStyle;
rightY.titleTextStyle = leftY.titleTextStyle;
rightY.majorGridLineStyle = leftY.majorGridLineStyle;
rightY.visibleRange = [CPTPlotRange plotRangeWithLocation:CPTDecimalFromFloat(0.0) length:CPTDecimalFromFloat(400.0)];
rightY.gridLinesRange = x.visibleRange;
rightY.majorIntervalLength = CPTDecimalFromInt(40);
rightY.labelFormatter = noDecimalFormatter;

// Create plot
CPTScatterPlot *hourlyPlot = [[CPTScatterPlot alloc] initWithFrame:graph.bounds];
CPTMutableLineStyle *dataStyle = [hourlyPlot.dataLineStyle mutableCopy];
dataStyle.lineWidth = 2.0f;
dataStyle.lineColor = [CPTColor colorWithCGColor:[darkTextColor CGColor]];
hourlyPlot.dataLineStyle = [dataStyle copy];
hourlyPlot.dataSource = self;
[graph addPlot:hourlyPlot]; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T20:37:30.320

您正在设置`orthogonalCoordinateDecimal`右侧 y 轴的两次。第二次，它移回到另一个顶部的左侧。

# c++ - 如何从 C++ 中的内部联合访问类成员

> ID：14044738
> 
> 赞同：2
> 
> 时间：2012-12-26T18:41:10.390
> 
> 标签：c++, class, struct, unions

我有一个小问题：

```
class A {
     public:
     enum _type {TYPE1=0,TYPE2,TYPE3} type;
     union U{
         struct _type1 {
             //somme data
         } type1;

         struct _type2 {
            //some other data
            std::vector<int> v;
         } type2;

         struct _type3 {
            // some other data
         } type3;

         U() { //constuctor
            switch(type){ // access to A::type => not accept at compile time
               case TYPE1 : /*init type1*/ break;
               case TYPE2 : /* init type2 */; new(&v) std::vector<int>; break;
               case TYPE3 : /* init type3 */ break;
               default : break;
         }

         ~U(){ //I need it to delete placement new
             switch(type)
             {
                  //same probleme
                  case TYPE2: v.~vector<int>(); break;
                  default : break;
             }
        }
     }
 }; 
```

错误：

> 无效使用非静态数据成员

如您所见，我只需要在联合构造函数中访问主类的数据。我需要这个来处理“无限制的联合”（联合的数据成员实际上是对象）所以我真的需要使用联合而不是其他类。

编辑：最后，我为这种情况找到了解决方案：

```
class A {
    public:
        A(int t); // <= add U() code here
        ~A(); // <= add ~U()  code here
    union {
        //same union data
    }; //move to anonymous union
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T18:43:54.550

您必须将 A 的实例传递给构造函数，就像其他任何事情一样。在 A 内部声明联合这一事实是无关紧要的。

编辑：顺便说一句，你只是在重新发明`boost::variant`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-26T19:05:49.317

您的对象内部实际上没有任何“内部联合”`A`对象。您所做的只是在另一个类型中声明一个类型。`A`这会影响命名和访问权限，但不会在和之间创建其他关系`U`。

如果您真的想在物理上将类型对象作为类型`U`对象的成员，则必须在 class`A` 中声明类型成员。这将在对象与其类型的成员之间创建物理关系。C++ 语言没有提供从数据成员中确定所有者地址的标准方法，但可以通过一些半合法的 hack 来实现。`U``A``A``U`

例如，如果您声明

```
class A {
public:
  union U {
    ...
  };
  ...
  U u;
}; 
```

您将能够通过以下方式访问整个`A`内部方法`U`

```
A *pa = static_cast<A *>((void *) ((char *) this - offsetof(A, u))); 
```

这显然是一个相当不雅的hack，依赖`u`于类成员的硬编码名称。但技术上的可能性仍然存在。

或者您可以简单地将指向封装对象的指针/引用传递给`A`对象`U`并通过该指针/引用执行访问。

* * *

但是，您的示例存在另一个性质的问题。您似乎试图从成员子对象的*构造函数*和*析构函数访问所有者类。*成员子对象在所有者对象*之前构造。*并且成员子对象在所有者对象*之后*被破坏。这意味着您将从`U`s 构造函数和析构函数中看到的不是尚未构造的对象，就是已经被破坏的类型的对象`A`。在这种情况下尝试访问所有者对象的其他成员（尤其是非平凡的成员）不是一个好主意。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T19:02:57.003

您的构造函数和析构函数位于错误的位置。将它们从联合移动到`class A`.

# python - 使用 django-tastypie 使用服务层

> ID：14044747
> 
> 赞同：0
> 
> 时间：2012-12-26T18:41:46.483
> 
> 标签：python, django, tastypie

几天来我一直在使用 sweetpie，我必须说它对于 CRUD 操作来说非常棒。我已经实现了验证器来进行一些基本的业务验证，但现在我需要做一些额外的事情......

创建模型后，我必须做一些记录、发送电子邮件和其他额外的东西。所以，从我的角度来看，我希望有一个服务层并且能够在模型被持久化后调用一个方法。

从我的角度来看，这不应该属于脱水方法......那么，我怎样才能在美味派中添加业务处理？

除此之外，我还有另一个业务部门，我必须提供一个 API 来公开已创建的非 CRUD 服务。它返回系统数据，但没有关联模型。美味派适合这个吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T23:58:38.403

是的，您可以将美味派用于任何资源。

这是带有非orm资源的tastepie的文档：

[http://django-tastypie.readthedocs.org/en/latest/non_orm_data_sources.html](http://django-tastypie.readthedocs.org/en/latest/non_orm_data_sources.html)

另一个例子：

[https://github.com/fatiherikli/tastypie-mongodb-resource/blob/master/tastypie_mongodb/resources.py](https://github.com/fatiherikli/tastypie-mongodb-resource/blob/master/tastypie_mongodb/resources.py)

# eclipse - 调试从 Eclipse 中的外部工具运行的程序

> ID：14044748
> 
> 赞同：1
> 
> 时间：2012-12-26T18:41:46.353
> 
> 标签：eclipse, debugging

我有一个从批处理文件运行的 java 应用程序。我为此使用了外部工具。

但是，我无法通过 Eclipse 调试此应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T08:55:46.867

您必须使用[远程调试选项](http://www.ibm.com/developerworks/opensource/library/os-eclipse-javadebug/index.html)启动您的 java 应用程序。

然后，您可以在 Eclipse 中创建远程调试配置以附加该 jvm 进程。

# jquery - jquery 不启用/禁用基于其他下拉选项的下拉选项

> ID：14044755
> 
> 赞同：1
> 
> 时间：2012-12-26T18:42:17.170
> 
> 标签：jquery

我正在使用以下 jquery 代码以发生以下情况

```
if remote_server is "yes" 
     allow all fields under FTP
else remote_server is "no"
     disable all fields under FTP 
```

我遇到的问题是将“remote_server”更改为 no 不会禁用“ftp_mode”下拉选项，但会禁用所有文本框。如果我将“remote_server”设置为yes，则所有框都启用，“ftp_mode”下拉选项除外

JQ码

```
var e = document.getElementsByName("remote_server")[0]
var strUser = e.options[e.selectedIndex].value;

$('select[name=remote_server]').change(function(){
   var inputs = $('input[name^=ftp_],select[name^=ftp_]');
   $(this).val() == "0" ? inputs.attr("disabled", "disabled") : inputs.removeAttr("disabled");
}).change() 
```

这是两个选项的 HTML：

远程服务器：

```
<select name="remote_server" class="required">
<option></option>
<option value="1" <?php if($remote=="1") echo 'selected="selected"'; ?>>Yes</option>
<option value="0" <?php if($remote=="0") echo 'selected="selected"'; ?>>No</option>
</select> 
```

ftp_mode

```
<select name="ftp_mode" class="required">
<option></option>
<option value="1" <?php if($ftpmode=="1") echo 'selected="selected"'; ?>>Active</option>
<option value="0" <?php if($ftpmode=="0") echo 'selected="selected"'; ?>>Passive</option>
</select> 
```

# signalr - SignalR 客户端获取 System.Net.WebException

> ID：14044757
> 
> 赞同：2
> 
> 时间：2012-12-26T18:42:18.120
> 
> 标签：signalr, signalr.client

所以我刚开始玩 SignalR，但无法通过最基本的设置来让它工作。

我可以在下面的控制器中放置断点并查看客户端连接，但是客户端只是立即收到一个 WebException ，而没有任何关于问题所在的有用消息。这个简单的用法看起来有什么问题吗？

```
public class LiveController : PersistentConnection
{
    public override Task ProcessRequestAsync(HostContext context)
    {
        return base.ProcessRequestAsync(context);
    }

    protected override Task OnConnectedAsync(IRequest request, string connectionId)
    {
        return base.OnConnectedAsync(request, connectionId);
    }

    protected override Task OnReceivedAsync(IRequest request, string connectionId, string data)
    {
        return base.OnReceivedAsync(request, connectionId, data);
    }

    protected override Connection CreateConnection(string connectionId, IEnumerable<string> signals, IEnumerable<string> groups)
    {
        return base.CreateConnection(connectionId, signals, groups);
    }
} 
```

这是客户端：

```
var connection = new Connection("http://192.168.0.102/live/");
connection.Start().ContinueWith(task =>
    {
        dispatcher.BeginInvoke(() =>
        {
            if (task.IsFaulted)
            {
                MessageBox.Show("Connection failed!");
            }
            else
            {
                MessageBox.Show("Success!");
            }
        });
    }); 
```

还有一个例外：

```
System.Net.WebException occurred
  HResult=-2146233079
  Message=Exception of type 'System.Net.WebException' was thrown.
  Source=System.Windows
  StackTrace:
       at System.Net.Browser.AsyncHelper.BeginOnUI(SendOrPostCallback beginMethod, Object state)
       at System.Net.Browser.ClientHttpWebRequest.EndGetResponse(IAsyncResult asyncResult)
       at Microsoft.AspNet.SignalR.Client.Http.HttpHelper.<>c__DisplayClass2.<GetHttpResponseAsync>b__0(IAsyncResult ar)
  InnerException: System.Net.WebException
       HResult=-2146233079
       Message=Exception of type 'System.Net.WebException' was thrown.
       Source=System.Windows
       StackTrace:
            at System.Net.Browser.ClientHttpWebRequest.InternalEndGetResponse(IAsyncResult asyncResult)
            at System.Net.Browser.ClientHttpWebRequest.<>c__DisplayClasse.<EndGetResponse>b__d(Object sendState)
            at System.Net.Browser.AsyncHelper.<>c__DisplayClass1.<BeginOnUI>b__0(Object sendState)
       InnerException: 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-24T06:11:02.517

尝试使用 * 或 + 而不是 localhost 请参阅[https://github.com/SignalR/SignalR/issues/684](https://github.com/SignalR/SignalR/issues/684)

# javascript - 谷歌地图中心在左上角

> ID：14044758
> 
> 赞同：10
> 
> 时间：2012-12-26T18:42:22.433
> 
> 标签：javascript, google-maps, google-maps-api-3

我一直在查看许多不同的示例、问题和其他有关此的事情，但我似乎找不到任何东西，所以我最后会问一个问题。

我拥有的地图没有使标记居中，甚至没有显示它。指向它的最左上角。见这里：http: [//i.imgur.com/Cc1ZK.png](https://i.imgur.com/Cc1ZK.png)

我有一个用于联系信息的标签系统。当有人单击选项卡时，地图和信息会向下滑动并显示正确的标记（4 个单独的地图），但是我无法让第一个工作，所以我无法复制/粘贴它。

这是我的代码：

脚本：

```
var latlng = new google.maps.LatLng(42.3535727, -83.0591444);
var options = {  
      zoom: 14,  
      center: latlng,  
      mapTypeId: google.maps.MapTypeId.ROADMAP,
    };
var map = new google.maps.Map(document.getElementById('detroit_map'), options);
marker1 = new google.maps.Marker({  
            position: new google.maps.LatLng(42.3535727, -83.0591444),
            map: map
          }); 
map.setCenter(latlng); 
```

html:

```
<div id="detroit_map" style="width:270px;height:170px;"></div> 
```

PS，我在 chrome 开发人员工具中没有错误。

希望我忽略了一些非常简单的事情。

谢谢

**为未来的观众找到答案**：

事实证明，我的标签导致了块之间的显示，没有一个让我的地图加载很奇怪。我为每个函数做了一个初始化函数，并调用了 setTimout('functionName', 1000); 调用要加载的地图。

我稍微更改了我的地图代码，但我们可以在 w3schools 的教程下找到所有内容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-09-23T09:40:07.430

单击选项卡后初始化地图。当在选项卡内使用时，这也适用于 iframe 谷歌地图。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-26T18:45:46.657

Tell your map to resize..

```
google.maps.event.trigger(map, 'resize'); 
```

map is the map instance that is returned by

```
map = new google.maps.Map(document.getElementById("map_canvas"), {
     mapTypeId: google.maps.MapTypeId.ROADMAP
}); 
```

# javascript - 如何使用 JS 将页面中的所有声音静音？

> ID：14044761
> 
> 赞同：25
> 
> 时间：2012-12-26T18:42:36.340
> 
> 标签：javascript, html, flash, audio, mute

如何使用 JS 将页面上的所有声音静音？

`<audio>`这应该使 HTML5和`<video>`标签以及 Flash 和朋友静音。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2016-05-13T20:03:30.840

这可以在 vanilla JS 中轻松完成：

```
// Mute a singular HTML5 element
function muteMe(elem) {
    elem.muted = true;
    elem.pause();
}

// Try to mute all video and audio elements on the page
function mutePage() {
    var elems = document.querySelectorAll("video, audio");

    [].forEach.call(elems, function(elem) { muteMe(elem); });
} 
```

或者在 ES6 中：

```
// Mute a singular HTML5 element
function muteMe(elem) {
    elem.muted = true;
    elem.pause();
}

// Try to mute all video and audio elements on the page
function mutePage() {
    document.querySelectorAll("video, audio").forEach( elem => muteMe(elem) );
} 
```

当然，这仅适用于`<video>`or`<audio>`元素，因为 Flash 或 JS 初始化音频等项目通常无法限制。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-26T20:20:23.617

规则 #1：永远不要在页面加载时启用音频自动播放。

无论如何，我将使用 jQuery 展示 HTML5：

```
// WARNING: Untested code ;)

window.my_mute = false;

$('#my_mute_button').bind('click', function(){

    $('audio,video').each(function(){

        if (!my_mute ) {

            if( !$(this).paused ) {
                $(this).data('muted',true); //Store elements muted by the button.
                $(this).pause(); // or .muted=true to keep playing muted
            }

        } else {

            if( $(this).data('muted') ) {
                $(this).data('muted',false);
                $(this).play(); // or .muted=false
            }

        }
    });

    my_mute = !my_mute;

}); 
```

Flash Media Players 依赖于暴露给 JavaScript 的自定义 API（希望如此）。

但是你明白了，遍历媒体，检查/存储播放状态，静音/取消静音。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-11-15T11:37:58.007

我是这样做的：

```
[].slice.call(document.querySelectorAll('audio')).forEach(function(audio) {
    audio.muted = true;
}); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2021-03-10T10:23:28.930

你可以做

```
[...document.querySelectorAll('audio, video')].forEach(el => el.muted = true) 
```

或者

```
Array.from(document.querySelectorAll('audio, video')).forEach(el => el.muted = true) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-07-15T08:00:58.870

@zach-saucier

```
function muteMe(elem) {elem.muted = false;elem.pause();}// Try to mute all video and audio elements on the page
function mutePage() {
    var elems = document.querySelectorAll("video, audio");

    [].forEach.call(elems, function(elem) { muteMe(elem); });
} 
```

这对我有用

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-26T14:52:16.090

保留对数组中所有音频/视频元素的引用，然后创建一个函数，在设置`.muted=true`.

# php - MySQL 查询委托/传输

> ID：14044762
> 
> 赞同：1
> 
> 时间：2012-12-26T18:42:45.047
> 
> 标签：php, mysql, zend-framework, replication, master-slave

MySQL 是否有用于主/从复制的查询委托系统。或者有什么方法可以实现相同的编程。

我想让 SELECT 查询转到 SLAVE，其他的都转到 MASTER。

我正在使用 Zend PHP，它在站点的任何地方都使用来自 Registry 的 DB 对象。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T18:52:33.960

不，Zend 框架不直接支持查询委托。

去年 10 月，我在 Zend 会议上讨论了这个问题，在那里我谈到了读/写拆分用例，并演示了一个 Doctrine2 类来处理读/写拆分。

*   [使用 MySQL 和 PHP 进行读/写拆分](http://www.slideshare.net/billkarwin/read-write-split)

还有一个 PHP mysqlnd 驱动插件，它有一个用于读/写分离的插件。这可能相对容易集成到 ZF 应用程序中。

*   [http://pecl.php.net/package/mysqlnd_ms](http://pecl.php.net/package/mysqlnd_ms)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T18:53:32.900

您应该在应用程序层执行此操作，因为 PHP 对此没有内置支持。

[MySQL 代理](http://dev.mysql.com/doc/refman/5.1/en/mysql-proxy.html)也可能做你想做的事。

# ruby-on-rails - 使用 rake 任务时检查电子邮件是否发送一次的最佳方法是什么？

> ID：14044764
> 
> 赞同：3
> 
> 时间：2012-12-26T18:42:45.827
> 
> 标签：ruby-on-rails, ruby, rake, scheduled-tasks, mailer

我有一个简单的邮件程序，它向用户发送每周摘要和 rake 任务，它向所有用户发送这封电子邮件，并且它被固定到 heroku 调度程序。

我想每周向用户发送此电子邮件，但每周只发送一次，无论我运行多少次`rake send_weekly_digest`

*梅勒*

```
class DigestMailer < ActionMailer::Base
  include Resque::Mailer
  default from: "company@email.com"

  def weekly_digest(user_id)
    @user = User.find(user_id)

    mail :to => @user.email, :subject => "Weekly Digest"
  end
end 
```

*耙任务*

```
desc "Send weekly email digest"
task send_weekly_digest: :environment do
  User.all.each do |user|
    DigestMailer.weekly_digest(user.id).deliver
  end
end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-26T19:31:17.430

在您的用户表中添加一个名为 last_emailed_at 或类似名称的列，然后在您发送每周摘要时使用时间戳更新该列。

然后在你的 rake 任务中，而不是说 User.all，只获取上周未通过电子邮件发送的用户：

```
User.where("last_emailed_at < ?", 1.week.ago) 
```

# git - git .BACKUP .BASE .LOCAL .REMOTE 文件

> ID：14044765
> 
> 赞同：22
> 
> 时间：2012-12-26T18:42:57.090
> 
> 标签：git, file, merge, git-merge

我们在这里为一个项目安装了 git，我正在和另一个同事一起玩它。

我一直在解决一些精心设计的合并冲突，但最终得到了一堆我不想要的额外文件。它们是 .BACKUP .BASE、.LOCAL 和 .REMOTE 文件。根据这些名称，它们似乎来自解决我的合并。我得到的一些确切文件名是：

*   index.shtml.BACKUP.16908.shtml
*   index.shtml.BASE.16908.shtml
*   index.shtml.LOCAL.16908.shtml
*   index.shtml.REMOTE.16908.shtml
*   我还有另一组上述文件，但以 .21384 结尾，假设来自另一次合并尝试

是否可以不保存这些文件？可以想象，现在有 9 个版本的 index.shtml 有点烦人。我正在使用 git 的内置合并工具 tortoisemerge。

我通过运行 git log 遇到了类似的问题，它显然创建了一个“df”文件。只需将其包含在 .gitignore 文件中即可轻松处理。不过，我不想只是在整个项目中积累像上面这样的文件。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2016-05-26T22:57:11.163

正如另一个答案所提到的，这些文件似乎是由 Git 的合并工具在解决冲突时创建的。默认的 Git 设置会留下这些额外的文件，即使在冲突解决后也是如此，但当前版本的 Git 允许您设置一个[配置变量](https://git-scm.com/docs/git-config)，以使 Git 在完成合并后始终删除这些临时文件。

您可以在 Git Bash 中使用以下命令执行此操作...

```
git config --global mergetool.keepBackup false 
```

当然，该`--global`参数是可选的，并控制此设置是此用户本地（全局）还是当前存储库。

更多信息[在这里](https://www.git-scm.com/docs/git-mergetool)。向下滚动到底部的临时文件部分。

* * *

**编辑**：即使启用了此设置，如果您的 repo 在您尝试通过硬重置中止来修复的 MERGE 期间最终处于未解决状态，这些文件也可以累积和保留。

例如，在我使用 Qt Creator 4.7.x 的某些配置时，这种情况发生了好几次，直到我意识到发生了什么并`mergetool`在我的机器上正确配置了 Git。

* * *

***注意****：我有一个类似的问题并最终来到这里。尽管当前的答案最终使我找到了正确的解决方案，但我认为它并没有回答问题，并且更新的答案是有序的。*

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-06-06T18:30:27.857

在 Tortoise 中，转到设置并取消选中“备份原始文件”（一次操作）下次打开它时可以进行常规合并，Tortoise 将创建 .base、.backup、.local、.remote，但是当你保存merge Tortoise 会自动删除这个文件。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2020-03-31T16:45:52.300

要删除未跟踪的文件和目录，请键入：

```
git clean -df 
```

# c# - 以编程方式声明变量时出现“必须声明标量变量”错误

> ID：14044771
> 
> 赞同：1
> 
> 时间：2012-12-26T18:43:22.837
> 
> 标签：c#, sql-server, visual-studio, gridview, visual-studio-2012

这是一个令人头疼的问题（至少对我而言）。

我有一个 GridView，用户可以在页脚中为很多数据字段输入信息。通常，它们遵循以下格式：

```
<asp:TemplateField HeaderText="Date" ItemStyle-HorizontalAlign="Center">
<FooterTemplate>
    <asp:TextBox ID="NewDate" runat="server" Width="25px" Height="10px" Font-Size="Smaller" ValidateRequestMode="Disabled"></asp:TextBox>
    <asp:RequiredFieldValidator ID="RequiredFieldValidator1" runat="server" ControlToValidate="NewDate" Display="Dynamic" ErrorMessage="You must enter a  valid date (MM/DD/YYYY) before submitting...">*</asp:RequiredFieldValidator>
</FooterTemplate>
<ItemTemplate>
    <asp:Label ID="Label1" runat="server" Text='<%# Bind("WeekOf","{0:MM/dd}") %>'></asp:Label>
</ItemTemplate> 
```

InsertCommand 看起来像这样（通用）：

```
InsertCommand="INSERT INTO [Table] (WeekOf,User,OtherData)
      VALUES (Convert(Date,@WeekOf,101), @User, @OtherData)"> 
```

@User 由运行良好的 InsertParameter 控制（我知道这一点，因为它与我的功能 SelectCommand / SelectParameter 完全相同）。

无论如何，由于这些字段在gridview中，我不能为它们分配静态InsertParameters，因为它们在GridView的页脚中，由于行数的变化而变化（我知道......关于如何做到这一点的任何启示都会太棒了），所以我试图以编程方式声明这样的变量[，](http://www.aspdotnetfaq.com/Faq/How-to-insert-row-in-GridView-with-SqlDataSource.aspx)但是我得到一个“必须声明标量变量“@WeekOf”错误。这是我的 GridView_RowCommand 函数的一般概念：

```
 TextBox WeekOfin = SalesReportingGridView.FooterRow.FindControl("NewDate") as TextBox;
 TextBox OtherDatain = SalesReportingGridView.FooterRow.FindControl("NewOtherData") as TextBox;

 SqlParameter WeekOf = new SqlParameter("@WeekOf", SqlDbType.VarChar, 30);
 WeekOf.Direction = ParameterDirection.Input;
 WeekOf.Value = WeekOfin.Text;
 insertParameters.Add(WeekOf);

 SqlParameter OtherData = new SqlParameter("@OtherData", SqlDbType.Int);
 OtherData.Direction = ParameterDirection.Input;
 OtherData.Value = OtherDatain.Text;
 insertParameters.Add(OtherData);

 SqlDataSource2.Insert(); 
```

这是完整的相关代码-

```
 private List<SqlParameter> insertParameters = new List<SqlParameter>();

    protected void SqlDataSource2_Inserting(object sender, SqlDataSourceCommandEventArgs e)
    {
        e.Command.Parameters.Clear();
        foreach (SqlParameter p in insertParameters)
            e.Command.Parameters.Add(p);

    }

    protected void SalesReportingGridView_RowCommand(object sender, GridViewCommandEventArgs e)
    {
        if (e.CommandName == "Insert" && Page.IsValid)
        {
            TextBox WeekOfin = SalesReportingGridView.FooterRow.FindControl("NewDate") as TextBox;
            TextBox Data1in = SalesReportingGridView.FooterRow.FindControl("NewData1") as TextBox;
            TextBox Data2in = SalesReportingGridView.FooterRow.FindControl("NewData2") as TextBox;
            TextBox Data3in = SalesReportingGridView.FooterRow.FindControl("NewData3") as TextBox;
            TextBox Data4in = SalesReportingGridView.FooterRow.FindControl("NewData4") as TextBox;
            TextBox Data5in = SalesReportingGridView.FooterRow.FindControl("NewData5") as TextBox;
            TextBox Data6in = SalesReportingGridView.FooterRow.FindControl("NewData6") as TextBox;
            TextBox Data7in = SalesReportingGridView.FooterRow.FindControl("NewData7") as TextBox;
            TextBox Data8in = SalesReportingGridView.FooterRow.FindControl("NewData8") as TextBox;
            TextBox Data9in = SalesReportingGridView.FooterRow.FindControl("NewData9") as TextBox;
            TextBox Data10in = SalesReportingGridView.FooterRow.FindControl("NewData10") as TextBox;
            TextBox Data11in = SalesReportingGridView.FooterRow.FindControl("NewData11") as TextBox;
            TextBox Data12in = SalesReportingGridView.FooterRow.FindControl("NewData12") as TextBox;
            TextBox Data13in = SalesReportingGridView.FooterRow.FindControl("NewData13") as TextBox;
            TextBox Data14in = SalesReportingGridView.FooterRow.FindControl("NewData14") as TextBox;
            TextBox Data15in = SalesReportingGridView.FooterRow.FindControl("NewData15") as TextBox;
            TextBox Data16in = SalesReportingGridView.FooterRow.FindControl("NewData16") as TextBox;
            TextBox Data17in = SalesReportingGridView.FooterRow.FindControl("NewData17") as TextBox;
            TextBox Data18in = SalesReportingGridView.FooterRow.FindControl("NewData18") as TextBox;
            TextBox Data19in = SalesReportingGridView.FooterRow.FindControl("NewData19") as TextBox;
            TextBox Data20in = SalesReportingGridView.FooterRow.FindControl("NewData20") as TextBox;
            TextBox Data21in = SalesReportingGridView.FooterRow.FindControl("NewData21") as TextBox;

            SqlParameter WeekOf = new SqlParameter("@WeekOf", SqlDbType.VarChar, 30);
            WeekOf.Direction = ParameterDirection.Input;
            WeekOf.Value = WeekOfin.Text;
            insertParameters.Add(WeekOf);

            SqlParameter Data1 = new SqlParameter("@Data1", SqlDbType.Int);
            Data1.Direction = ParameterDirection.Input;
            Data1.Value = Data1in.Text;
            insertParameters.Add(Data1);

            SqlParameter Data2 = new SqlParameter("@Data2", SqlDbType.Int);
            Data2.Direction = ParameterDirection.Input;
            Data2.Value = Data2in.Text;
            insertParameters.Add(Data2);

            SqlParameter Data3 = new SqlParameter("@Data3", SqlDbType.Int);
            Data3.Direction = ParameterDirection.Input;
            Data3.Value = Data3in.Text;
            insertParameters.Add(Data3);

            SqlParameter Data4 = new SqlParameter("@Data4", SqlDbType.Int);
            Data4.Direction = ParameterDirection.Input;
            Data4.Value = Data4in.Text;
            insertParameters.Add(Data4);

            SqlParameter Data5 = new SqlParameter("@Data5", SqlDbType.Int);
            Data5.Direction = ParameterDirection.Input;
            Data5.Value = Data5in.Text;
            insertParameters.Add(Data5);

            SqlParameter Data6 = new SqlParameter("@Data6", SqlDbType.Int);
            Data6.Direction = ParameterDirection.Input;
            Data6.Value = Data6in.Text;
            insertParameters.Add(Data6);

            SqlParameter Data7 = new SqlParameter("@Data7", SqlDbType.Int);
            Data7.Direction = ParameterDirection.Input;
            Data7.Value = Data7in.Text;
            insertParameters.Add(Data7);

            SqlParameter Data8 = new SqlParameter("@Data8", SqlDbType.Int);
            Data8.Direction = ParameterDirection.Input;
            Data8.Value = Data8in.Text;
            insertParameters.Add(Data8);

            SqlParameter Data9 = new SqlParameter("@Data9", SqlDbType.Int);
            Data9.Direction = ParameterDirection.Input;
            Data9.Value = Data9in.Text;
            insertParameters.Add(Data9);

            SqlParameter Data10 = new SqlParameter("@Data10", SqlDbType.Int);
            Data10.Direction = ParameterDirection.Input;
            Data10.Value = Data10in.Text;
            insertParameters.Add(Data10);

            SqlParameter Data11 = new SqlParameter("@Data11", SqlDbType.Int);
            Data11.Direction = ParameterDirection.Input;
            Data11.Value = Data11in.Text;
            insertParameters.Add(Data11);

            SqlParameter Data12 = new SqlParameter("@Data12", SqlDbType.Int);
            Data12.Direction = ParameterDirection.Input;
            Data12.Value = Data12in.Text;
            insertParameters.Add(Data12);

            SqlParameter Data13 = new SqlParameter("@Data13", SqlDbType.Int);
            Data13.Direction = ParameterDirection.Input;
            Data13.Value = Data13in.Text;
            insertParameters.Add(Data13);

            SqlParameter Data14 = new SqlParameter("@Data14", SqlDbType.Int);
            Data14.Direction = ParameterDirection.Input;
            Data14.Value = Data14in.Text;
            insertParameters.Add(Data14);

            SqlParameter Data15 = new SqlParameter("@Data15", SqlDbType.Int);
            Data15.Direction = ParameterDirection.Input;
            Data15.Value = Data15in.Text;
            insertParameters.Add(Data15);

            SqlParameter Data16 = new SqlParameter("@Data16", SqlDbType.Int);
            Data16.Direction = ParameterDirection.Input;
            Data16.Value = Data16in.Text;
            insertParameters.Add(Data16);

            SqlParameter Data17 = new SqlParameter("@Data17", SqlDbType.Int);
            Data17.Direction = ParameterDirection.Input;
            Data17.Value = Data17in.Text;
            insertParameters.Add(Data17);

            SqlParameter Data18 = new SqlParameter("@Data18", SqlDbType.Int);
            Data18.Direction = ParameterDirection.Input;
            Data18.Value = Data18in.Text;
            insertParameters.Add(Data18);

            SqlParameter Data19 = new SqlParameter("@Data19", SqlDbType.Int);
            Data19.Direction = ParameterDirection.Input;
            Data19.Value = Data19in.Text;
            insertParameters.Add(Data19);

            SqlParameter Data20 = new SqlParameter("@Data20", SqlDbType.Int);
            Data20.Direction = ParameterDirection.Input;
            Data20.Value = Data20in.Text;
            insertParameters.Add(Data20);

            SqlParameter Data21 = new SqlParameter("@Data21", SqlDbType.Int);
            Data21.Direction = ParameterDirection.Input;
            Data21.Value = Data21in.Text;
            insertParameters.Add(Data21);

            SqlDataSource2.Insert();
        }
    }
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T00:51:29.823

看看这个关于如何添加参数的例子，并按照这个作为模板，我将粘贴一些代码让你开始，你必须填写其余的..

**根据您计算 WeekOf 的方式，我将在 using 语句之外放置或获取该值，并将其传递到您尝试执行 Convert(Date,@WeekOf, 101) 的位置**

```
using (SqlConnection connection = new SqlConnection(connectionString))
{
    SqlCommand cmd = new SqlCommand("InsertCommand="INSERT INTO [Table] WeekOf,User,OtherData)
  VALUES (Convert(Date,@WeekOf,101), @User, @OtherData)"");
    cmd.CommandType = CommandType.Text;
    cmd.Connection = connection;
    cmd.Parameters.AddWithValue("@WeekOf", WeekOfin.Text);
    cmd.Parameters.AddWithValue("@User", YourUser.Text);
    cmd.Parameters.AddWithValue("@OtherData", txtAddress.Text);
    ...
    ...
    connection.Open();
    try
    {
      cmd.ExecuteNonQuery();
    }
    catch (SqlException ex)
    {
      //MessageDlg.Show(ex.Message); //do what ever kind of logging or error trapping here that you want.. 
    }
    //You will need to explain how you are populating or getting
    // the MM/YY for WeekOf 
    //Personally I would refactor this code it's a bit unorthodox 
} 
```

# php - php：在运行 INSERT 查询之前检查变量是否不为空

> ID：14044774
> 
> 赞同：0
> 
> 时间：2012-12-26T18:43:46.973
> 
> 标签：php, forms, validation, post

我为我的婚礼网站构建了一个歌曲请求表单，并想在将表单输入存储到数据库之前检查我存储表单输入的变量是否为空。我的目标很简单，防止在触发 for 时将空白行添加到 mysql db。

```
 <?php 
// extract data from form; store in variable
$artist =  $_POST["artist"];
$song = $_POST["song"];

// connect to server 
$conn = mysql_connect('host', 'user', 'pass');

// check if you can connect; if not then die

if (!$conn) {
    echo "<center>";
    die('Could Not Connect: ' . mysql_error());
    echo "</center>";
    }

// check if you can select table; in not then die

$db = mysql_select_db('database', $conn);

if (!$db) {
    echo "<center>";
    die('Database Not Selected: ' . mysql_error());
    echo "</center>";
    }

// Define the query to inser the song request
$insert = mysql_query("INSERT INTO Songs (Artist, Song) VALUES ('$artist', '$song')");  

// check if above variables are empty 
if (!empty($artist) and !empty($song)) {
    echo "<center>";
    echo "Insert was succesful<br>";
    echo "<a href='index.html' target='_self' >Back</a>";
    echo "</center>";
}
else {
    echo "<center>";
    die("Please fill in at least the artist name");
    echo "</center>";
}

// close the connection to the server
mysql_close($conn);
?> 
```

我在一个名为 insert.php 的文件中有上述内容，该文件在提交索引页面上的表单时被触发。表单正在使用 POST 提交并且工作得很好，但是我想防止发生空白提交。

对编程非常陌生，想学习如何正确地做到这一点。

谢谢你的耐心。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T18:46:53.760

> [**请不要`mysql_*`在新代码中使用函数**](https://stackoverflow.com/q/12859942/)。它们不再被维护[并被正式弃用](https://wiki.php.net/rfc/mysql_deprecation)。看到[**红框**](https://www.php.net/manual/en/function.mysql-connect.php)了吗？改为了解[*准备好的语句*](https://en.wikipedia.org/wiki/Prepared_statement)，并使用[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli) -[本文](https://php.net/manual/en/mysqlinfo.api.choosing.php)将帮助您决定使用哪个。如果您选择 PDO，[这里有一个很好的教程](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)。

但是，作为对您问题的直接回答：不是在插入结果之后进行验证，而是在之前进行验证。 **此外，如果您确实使用 mysql_* 函数，请记住清理（使用`mysql_real_escape_string`）您插入数据库的任何内容。**清理输入将防止[SQL 注入](http://www.unixwiz.net/techtips/sql-injection.html#finduser "SQL注入")并消除一些漏洞问题。

```
if($errors) {
    // there are errors, don't submit to database
    // run through error display process

} else {
    // submit to database
    $insert = mysql_query("INSERT INTO Songs (Artist, Song) VALUES ('$artist', '$song')");
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-26T18:48:41.903

你是如此接近！您所要做的就是在检查艺术家和歌曲是否填写后插入插入！

```
<?php 
    // extract data from form; store in variable
    $artist =  $_POST["artist"];
    $song = $_POST["song"];

    // connect to server 
    $conn = mysql_connect('host', 'user', 'pass');

    // check if you can connect; if not then die

    if (!$conn) {
        echo "<center>";
        die('Could Not Connect: ' . mysql_error());
        echo "</center>";
    }

    // check if you can select table; in not then die

    $db = mysql_select_db('database', $conn);

    if (!$db) {
        echo "<center>";
        die('Database Not Selected: ' . mysql_error());
        echo "</center>";
    }

    // check if above variables are empty 
    if (!empty($artist) and !empty($song)) {
        // Define the query to inser the song request
        $insert = mysql_query("INSERT INTO Songs (Artist, Song) VALUES ('$artist', '$song')");  

        if($insert) {
          echo "<center>";
          echo "Insert was succesful<br>";
          echo "<a href='index.html' target='_self' >Back</a>";
          echo "</center>";
        }
    }
    else {
        echo "<center>";
        die("Please fill in at least the artist name");
        echo "</center>";
    }

    // close the connection to the server
    mysql_close($conn); 
```

就是这样！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T18:46:44.163

使用空应该就足够了。也有 isset

[http://php.net/manual/en/function.isset.php](http://php.net/manual/en/function.isset.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-26T18:50:08.407

好吧，您已经通过`empty`. 只需在插入之前移动它并采取相应的行动

```
if (empty($artist)) {
    echo "<center>";
    die("Please fill in at least the artist name");
    echo "</center>";
} 
```

或同时检查

```
if (empty($artist) or empty($song)) {
...
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-26T18:57:26.587

首先通过函数或使用 if 语句来验证变量

```
if (!empty($artist) && !empty($song))
 { $insert = mysql_query("INSERT INTO Songs (Artist, Song) VALUES ('$artist', '$song')");} 
```

# tfs - MS Project 2013 and TFS 2010 integration

> ID：14044777
> 
> 赞同：2
> 
> 时间：2012-12-26T18:44:05.433
> 
> 标签：tfs, integration, ms-project

I am trying to import TFS items to a MS Project file. It works perfectly for almost all use cases except the case when "Duration" field is empty or less than **1**. So, as a result I cannot import not estimated items. However when I import items with duration > 0, I can set them to 0 in MS project and push back to TFS. Any ideas how to solve the issue with importing items where duration = 0?

Here is the error message:

![enter image description here](../Images/7f25bf27b5991ad3acf443186621fa00.png)

And here is mapping:

![enter image description here](../Images/ab32af5a08e8450be602bb91bd3994cf.png)

And here is the trace output for MS project:

```
[Verbose, PID 7160, TID 5012, 2012/12/26 18:17:11.175, 59906 ms, General] --> ConvertRegularQueryResult()
[Verbose, PID 7160, TID 5012, 2012/12/26 18:17:11.175, 59906 ms, General] resultsElement: <QueryIds xmlns=""></QueryIds>
[Verbose, PID 7160, TID 5012, 2012/12/26 18:17:11.175, 59906 ms, General] <-- ConvertRegularQueryResult()
WINPROJ.EXE Information: 0 : [Info, PID 7160, TID 5012, 2012/12/26 18:17:11.176, 59907 ms, General] >>> Query 0
WINPROJ.EXE Error: 0 : [Error, PID 7160, TID 5012, 2012/12/26 18:17:11.306, 60037 ms, General] 
{
Exception:  {
Exception Message: The argument value is not valid. (type COMException)
Exception Stack Trace:    at Microsoft.Office.Interop.MSProject.Task.SetField(PjField FieldID, String Value)
   at Microsoft.TeamFoundation.OfficeIntegration.Client.ProjectWorkItem.set_Item(String fieldReferenceName, Object value)
 }
}
WINPROJ.EXE Error: 0 : [Error, PID 7160, TID 5012, 2012/12/26 18:17:11.341, 60072 ms, General] 
{
Exception:  {
Exception Message: TF400481: One or more imported work items are not refreshing correctly because they contain field values that Microsoft Project does not allow. The first failing item, work item ID 118301 corresponding to Project task ID 1, contains an invalid value in field 'NSight.Workstation.TS.Fields.EstimatedManDays'. To make sure that all project plan data refreshes correctly, update the work item field values in Team Foundation Server and then refresh your project plan. (type OfficeDisplayableException)
Exception Stack Trace: 

Inner Exception Details:

Exception Message: The argument value is not valid. (type COMException)
Exception Stack Trace:    at Microsoft.Office.Interop.MSProject.Task.SetField(PjField FieldID, String Value)
   at Microsoft.TeamFoundation.OfficeIntegration.Client.ProjectWorkItem.set_Item(String fieldReferenceName, Object value)
   at Microsoft.TeamFoundation.OfficeIntegration.Client.ProjectWorkItemDictionary.UpdateFrom(WorkItemDictionaryBase currituckWorkItemDictionary, Boolean setCalculations, Boolean updateWorkItems)
 }
}
WINPROJ.EXE Information: 0 : [Info, PID 7160, TID 5012, 2012/12/26 18:17:11.344, 60075 ms, General] <<< Page 1 items, 2 columns, 0 longtext
WINPROJ.EXE Information: 0 : [Info, PID 7160, TID 5012, 2012/12/26 18:17:12.139, 60870 ms, General] >>> Page
WINPROJ.EXE Information: 0 : [Info, PID 7160, TID 5012, 2012/12/26 18:17:12.139, 60870 ms, General] <<< Page 1 items, 2 columns, 0 longtext
WINPROJ.EXE Information: 0 : [Info, PID 7160, TID 5012, 2012/12/26 18:17:12.945, 61675 ms, General] >>> Page
WINPROJ.EXE Information: 0 : [Info, PID 7160, TID 5012, 2012/12/26 18:17:12.945, 61675 ms, General] <<< Page 1 items, 2 columns, 0 longtext
WINPROJ.EXE Information: 0 : [Info, PID 7160, TID 5012, 2012/12/26 18:17:13.751, 62481 ms, General] >>> Page
WINPROJ.EXE Information: 0 : [Info, PID 7160, TID 5012, 2012/12/26 18:17:13.752, 62482 ms, General] <<< Page 1 items, 2 columns, 0 longtext
WINPROJ.EXE Information: 0 : [Info, PID 7160, TID 5012, 2012/12/26 18:17:14.704, 63434 ms, General] >>> Page
WINPROJ.EXE Warning: 0 : [Warning, PID 7160, TID 5012, 2012/12/26 18:21:18.229, 306960 ms, General] UIHost.ShowMessageBox: result=OK caption='Microsoft Office Project' text='TF400481: One or more imported work items are not refreshing correctly because they contain field values that Microsoft Project does not allow. The first failing item, work item ID 118301 corresponding to Project task ID 1, contains an invalid value in field 'NSight.Workstation.TS.Fields.EstimatedManDays'. To make sure that all project plan data refreshes correctly, update the work item field values in Team Foundation Server and then refresh your project plan.' 
```

TFS field definition:

```
<FIELD name="Est Man Days" refname="NSight.Workstation.TS.Fields.EstimatedManDays" type="Double" reportable="measure" formula="sum">
    <HELPTEXT>The estimated Man Days to complete task.</HELPTEXT>
</FIELD> 
```

# ios - 在 UIWebView iOS 中处理身份验证。这是如何工作的？

> ID：14044781
> 
> 赞同：1
> 
> 时间：2012-12-26T18:44:33.483
> 
> 标签：ios, authentication, cookies, ios-simulator

我有一个要求，我必须处理站点的身份验证并将其加载到 UIWebview 中。在搜索网络后，我创建了一个新的 NSURLConnection 并处理了身份验证质询（如链接[如何在 UIWebView 中显示身份验证质询？](https://stackoverflow.com/questions/1769888/how-to-display-the-authentication-challenge-in-uiwebview) ) 使用它

一切正常，但我不明白下面的代码。

```
- (void)connection:(NSURLConnection *)connection
didReceiveResponse:(NSURLResponse *)response
{

        NSHTTPURLResponse *httpResponse = (NSHTTPURLResponse *) response;
        NSString *newUrl = [NSString stringWithFormat:@"%@", response.URL];

        // cancel the connection. we got what we want from the response,
        // no need to download the response data.
        [connection cancel];

        //Start loading the new request in webView
        NSURL *url =[NSURL URLWithString:newUrl];
        NSMutableURLRequest *urlRequest=[NSMutableURLRequest requestWithURL:url];

        [webView loadRequest:urlRequest];

} 
```

这里 webview 只是再次加载请求而不重新发送 cookie 中的任何身份验证信息。然后我明白**iOS 会自动处理 cookie 管理**。但是当我尝试访问 cookie 并在身份验证后打印它时，它什么也没提供。我使用了以下一段代码来检索所有的cookies。

```
[[NSHTTPCookieStorage sharedHTTPCookieStorage] cookies] 
```

那么这是如何工作的呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-30T06:28:41.573

当时这是模拟器的一些问题。我能够在设备上运行应用程序时打印 cookie。

# java - 如何在游戏框架中的视图中获取 ORM 后关系的非欠方的完整信息？

> ID：14044782
> 
> 赞同：0
> 
> 时间：2012-12-26T18:44:33.763
> 
> 标签：java, scala, jpa, orm, playframework

我有两个类：Author 和 Book，定义了两者之间的关系，正确的 JPA 注释。我在 Play Framework 中使用 MVC 架构。在控制器类（应用程序）ORM 工作中，我有关于作者（idA 和 nameA）的完整信息，但在视图中，字段 nameA 看起来像空字符串（idA 是正确的）。

下面我将解释我的意思：

在作者：

```
public class Autor extends Model {

    @Id
    public Long idA;

    @Required
    public String nameA;

    @ManyToMany(mappedBy = "authors")
    public Set<Book> books;
    } 
```

在书籍中：

```
public class Book extends Model {

    @Id
    public Long idB
    @ManyToMany
    @JoinTable(
              name = "creates",
              joinColumns = @JoinColumn(name = "id_b", referencedColumnName = "id_b"),
              inverseJoinColumns = @JoinColumn(name = "id_a", referencedColumnName = "id_a")
          )
    public Set<Autor> authors;
    }

    public static Finder<Long, Book> find = new Finder<Long, Book>(Long.class, Book.class);

    public static List<Book> all()
    {
    return find.all();
    } 
```

作为 GET 请求的效果，我试图与所有作者一起获得书籍。我已添加到路由文件行：

```
GET     /books/                 controllers.Application.booksShow() 
```

并在 Application 类中创建了方法：

```
public static Result booksShow(Long)
  {
      return  ok(views.html.booksInfo.render(Book.all()));
  } 
```

Scala 中的视图片段如下所示：

```
 @for(book <- Books) {
        <li> 
            @book.title
            @book.authors.size()
            @for(author <- book.authors) {
                    <li>@author.nameA</li>
                }
        </li>
    } 
```

在浏览器中获取请求后，我得到如下信息：

```
Title1 2
[empty line]
[empty line]
Title2 1
[empty line] 
```

但应该是：

```
Title1 2
Author1
Author2
Title2 1
Author2 
```

我试图将 booksShow 方法更改为：

```
 public static Result booksShow(Long id)
  {
      List<Books> b = Books.all();
      System.out.println(b.get(0).title);
      System.out.println(b.get(0).authors.iterator().next().nameA);
      return  ok(views.html.booksInfo.render(Ksiazka.all()));
  } 
```

在我的控制台中出现了：

```
Title1
 Author1 
```

但是在网站上，作者仍然是空的；

当我在 Scala 中进行更改时：

```
@for(author <- book.authors) {
    <li>@author.nameA</li>
} 
```

为了：

```
@for(author <- book.authors) {
    <li>@author.idA</li>
} 
```

我得到正确的（非零，非空白）ID。

任何的想法？我很困惑，我得到了 idA 和 Authors 集合的大小，但 nameA 是空白的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T18:52:12.463

你有一些解决这个问题的选择。您可以将您的关系设置为 FetchType.EAGER 以填充您的所有关系。这是最简单的方法。最终可能会出现性能问题，但暂时会这样做。

对于未来，想想什么时候需要什么信息，并在会话关闭之前填充所需的字段，只需对它们执行“get”。这将触发延迟加载并填充字段以供以后访问。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T20:47:48.327

我找到了另一种解决问题的方法（不完全解决，但我得到了我想要的结果）：

我没有使用 find.all()，而是通过连接查看查询结果：

在书中：

```
public static List<Books> allWithAuthors()
{
    return find.fetch("authors").findList();
} 
```

并在应用程序中：

```
public static Result booksShow()
{
    return  ok(views.html.booksInfo.render(Book.allWithAuthors()));
} 
```

# digital-signature - private key protection for Online signatures

> ID：14044783
> 
> 赞同：0
> 
> 时间：2012-12-26T18:44:38.717
> 
> 标签：digital-signature, sha1, sha, private-key, sha256

Let's say we have a group of id/signature pairs like:

```
https://picasaweb.google.com/${ID1}?authkey=${SIGNATURE1}
https://picasaweb.google.com/${ID2}?authkey=${SIGNATURE2}
https://picasaweb.google.com/${ID3}?authkey=${SIGNATURE3}
https://picasaweb.google.com/${ID4}?authkey=${SIGNATURE4}
.... 
```

It is one way picasa shares the links, so they are all persistent.

If we can collect thousands or millions of those id/signature pairs, does it make the private key vulnerable? That we can generate signature for any new ID?

( Assuming the encryption method is sha1 or sha256\. What if there is a salt or not?)

( picasa is just an example, please don't target at picasa. It is a general question as we saw many sites are using this method. )

( Let's say the signature is generated by this method: [HMAC SHA1 Signature in Java](https://stackoverflow.com/questions/10859526/hmac-sha1-signature-in-java) )

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T19:13:05.160

所以问题真正归结为一个签名的哈希是否真的“泄露”了关于用于签名哈希的密钥的任何信息。假设一个强密钥和一个好的散列函数，即使明文是已知的，HMAC 也不应该泄露任何关于密钥的信息。

这是一个关于密码学 stackexchange 的类似问题的链接，有一个很好的答案：

[https://crypto.stackexchange.com/questions/2538/is-my-hmac-secure-if-i-have-a-complete-series-of-hmacd-prefix-strings](https://crypto.stackexchange.com/questions/2538/is-my-hmac-secure-if-i-have-a-complete-series-of-hmacd-prefix-strings)

# css - 来自 data-* 属性的 CSS 规则

> ID：14044786
> 
> 赞同：0
> 
> 时间：2012-12-26T18:44:57.013
> 
> 标签：css, html, attributes

假设我的 HTML 文件的一部分如下所示：

```
<div data-w="20px">
    <p>this is some text this is some text this is some text</p>
</div> 
```

并且`<div>`的宽度应该等于`data-w`，如下图所示。

```
div { width:[data-w]; } 
```

我知道我可以`[attribute]`用作选择器，但老实说，这不是替代方案：

```
div[data-w=1px]{ width:1px; }
div[data-w=2px]{ width:1px; }
div[data-w=3px]{ width:1px; }
div[data-w=4px]{ width:1px; }
div[data-w=5px]{ width:1px; }
div[data-w=1px]{ width:1px; }
div[data-w=1px]{ width:1px; }
        (...) 
```

想法？

## 编辑

我发现了一个[可能的重复项](https://stackoverflow.com/questions/9523197/css-values-using-html5-data-attribute?rq=1)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T19:00:40.570

我想最简单的方法是使用 jQuery。

**[小提琴](http://jsfiddle.net/mqJqW/1)**。

```
$("div").each(function() {
    var w = $(this).data("w");
    var $this = $(this);

    $this.width(w);
});​ 
```

正如评论中所说，这在单纯的 CSS 中是不可能的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T20:27:16.273

我想，因为您正在对宽度进行硬编码，所以最好使用：

```
<div style="width:20px">
    <p>this is some text this is some text this is some text</p>
</div> 
```

# android - Android SQLite Issues

> ID：14044788
> 
> 赞同：2
> 
> 时间：2012-12-26T18:45:19.853
> 
> 标签：android, sqlite

Very new to android and have just done a database tutorial and run into the following issues. can anyone see any blinding issues to get me on my way to fixing this?

Heres my three classes:

first class is the main activity class:

```
package com.example.sqlite;

import android.app.ListActivity;
import android.content.Intent;
import android.database.Cursor;
import android.os.Bundle;
import android.view.ContextMenu;
import android.view.ContextMenu.ContextMenuInfo;
import android.view.Menu;
import android.view.MenuInflater;
import android.view.MenuItem;
import android.view.View;
import android.widget.SimpleCursorAdapter;
import android.widget.AdapterView.AdapterContextMenuInfo;

public class MainActivity extends ListActivity {

private DBAdapter mDBHelper;
private static final int REQUEST_ADD = 1;
private static final int REQUEST_EDIT = 2;
private Cursor mC;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

mDBHelper = new DBAdapter(this);
mDBHelper = mDBHelper.open();

refreshList();
registerForContextMenu(getListView());

}
// Option menu first
@Override
public boolean onCreateOptionsMenu(Menu menu) {

    MenuInflater inflater = getMenuInflater();
    inflater.inflate (R.menu.mymenu, menu);
    return true;

}
@Override
public boolean onOptionsItemSelected(MenuItem item) {

    switch(item.getItemId())
    {

    case R.id.miAdd:
        Intent i = new Intent ();
        i.setClass(this, Input.class);
        i.putExtra(DBAdapter.COL_ID, 0);
        startActivityForResult(i, REQUEST_ADD);
        return true;

    case R.id.miClear:

    mDBHelper.deleteAllBookmark();
    refreshList();
    return true;

    default:
    return super.onOptionsItemSelected(item);
}
}

@Override
public boolean onContextItemSelected(MenuItem item) {

    AdapterContextMenuInfo info = (AdapterContextMenuInfo) item.getMenuInfo();
    int position = info.position;
    long id = info.id;
    switch(item.getItemId())
    {

    case R.id.miEdit:

        Cursor c = mC;
        c.moveToPosition(position);

        Intent i  = new Intent();
        i.setClass(this, Input. class);
        i.putExtra(DBAdapter.COL_ID, id);
        i.putExtra(DBAdapter.COL_TITLE, c.getString(c.getColumnIndexOrThrow(DBAdapter.COL_TITLE)));
        i.putExtra(DBAdapter.COL_URL, c.getString(c.getColumnIndexOrThrow(DBAdapter.COL_URL)));

        startActivityForResult(i, REQUEST_EDIT);
        return true;

    case R.id.miDelete:
        mDBHelper.deleteBookmark(id);
        refreshList();
        return true;

        default:
        return super.onContextItemSelected(item);
    }
}
@Override
public void onCreateContextMenu(ContextMenu menu, View v,
        ContextMenuInfo menuInfo) {
    super.onCreateContextMenu(menu, v, menuInfo);

MenuInflater inflater = getMenuInflater();

inflater.inflate(R.menu.contextmenu, menu);

}
private void refreshList() 
{
    mC = mDBHelper.GetAllBookmarks();
    startManagingCursor(mC);

    SimpleCursorAdapter adapter = new SimpleCursorAdapter(this, R.layout.row,
            mC, new String[] {DBAdapter.COL_TITLE,DBAdapter.COL_URL},
            new int[] {R.id.txtText1, R.id.txtText2});

    setListAdapter(adapter);
}

@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {

    switch(requestCode)

    {
    case REQUEST_ADD:

        String url = data.getStringExtra(DBAdapter.COL_URL);
        String title = data.getStringExtra(DBAdapter.COL_TITLE);
        mDBHelper.createBookmark(title, url);
        refreshList();
        break;

    case REQUEST_EDIT:

        String editUrl = data.getStringExtra(DBAdapter.COL_URL);
        String editTitle = data.getStringExtra(DBAdapter.COL_TITLE);
        long updateId = data.getLongExtra(DBAdapter.COL_ID, 0);

        mDBHelper.updateBookmark(updateId, editTitle, editUrl);

        break;

        default:

            super.onActivityResult(requestCode, resultCode, data);
    }

}

} 
```

2nd class is the Database adapter class:

```
package com.example.sqlite;

import android.content.ContentValues;
import android.content.Context;
import android.database.Cursor;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteOpenHelper;

public class DBAdapter {

private static final String DB_NAME = "Bookmark";
private static final String DB_TABLE = "Bookmark";
private static final int DB_VERSION = 1;

private static final String DB_CREATE = 
        "CREATE TABLE Bookmark (" +
        "_id integer PRIMARY KEY AUTOINCREMENT," + 
        "Title text," +
        "url text);";

private static final String DB_UPGRADE = "DROP TABLE IF EXCISTS Bookmark";

public static final String COL_TITLE = "Title";
public static final String COL_URL = "url";
public static final String COL_ID = "id";

private SQLiteDatabase mDB;
private DBHelper mDBHelper;
private Context mCtx;

private static class DBHelper extends SQLiteOpenHelper
{
    public DBHelper (Context context)
    {

        super (context, DB_NAME, null, DB_VERSION);

    }

public void onCreate(SQLiteDatabase db)
{

    db.execSQL(DB_CREATE);

}

public void onUpgrade(SQLiteDatabase db, int newVersion, int oldVersion)
{

    db.execSQL(DB_UPGRADE);

}

}

public DBAdapter(Context ctx)
{
    mCtx = ctx;
}

public DBAdapter open()
{
    mDBHelper = new DBHelper(mCtx);
    mDB = mDBHelper.getWritableDatabase();
    return this;
}

public DBAdapter close()
{
    mDBHelper.close();
    return this;
}

public long createBookmark(String title, String url)
{
    ContentValues v = new ContentValues();
    v.put(COL_TITLE, title);
    v.put(COL_URL, url);
    return mDB.insert(DB_TABLE, null, v);
}

public boolean deleteBookmark(long id)
{
    return mDB.delete(DB_TABLE, COL_ID + "=" + id, null)>0;

}

public boolean deleteAllBookmark()
{
    return mDB.delete(DB_TABLE,null,null)>0;
}

public Cursor GetAllBookmarks()
{
    return mDB.query(DB_TABLE, 
                    new String[] {COL_ID, COL_TITLE, COL_URL}, 
                    null, null, null, null, null);
}

public Cursor GetBookmark(long id)

{
    Cursor mCursor = mDB.query(true, DB_TABLE,
            new String[] {COL_ID, COL_TITLE, COL_URL},
            COL_ID + "=" + id,
            null, null, null, null, null);
    if (mCursor != null)

        mCursor.moveToFirst();
        return mCursor;

}

public boolean updateBookmark(long id, String title, String url)
{
    ContentValues v = new ContentValues();
    v.put(COL_TITLE, title);
    v.put(COL_URL, url);
    return mDB.update(DB_TABLE, v, COL_ID + "=" + id, null)>0;

}

} 
```

The 3rd class is the input class:

```
package com.example.sqlite;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;

public class Input extends Activity {

private EditText txtTitle;
private EditText txtURL;
private Button btnOK;
private long id;
private boolean bUpdateMode = false;

protected void onCreate(Bundle savedInstanceState) {

    super.onCreate(savedInstanceState);

    setContentView(R.layout.input);

    txtTitle = (EditText) findViewById(R.id.txtTitle);
    txtURL = (EditText) findViewById(R.id.txtURL);
    btnOK = (Button) findViewById(R.id.btnOK);

    Intent i = this.getIntent();

    id = i.getLongExtra(DBAdapter.COL_ID, 0);

    if (id == 0)
    {
        bUpdateMode = false;
    }

    else
    {
        bUpdateMode = true;
        String title = i.getStringExtra(DBAdapter.COL_TITLE);
        String url = i.getStringExtra(DBAdapter.COL_URL);
        txtTitle.setText(title);
        txtURL.setText(url);

    }

    btnOK.setOnClickListener(new View.OnClickListener() 
    {

        public void onClick (View V) 
        {
            Intent i = new Intent ();
            i.putExtra(DBAdapter.COL_URL,    txtURL.getText().toString());
            i.putExtra(DBAdapter.COL_TITLE,  txtTitle.getText().toString());

            if(bUpdateMode)
                i.putExtra(DBAdapter.COL_ID,  id);

            setResult(RESULT_OK, i);
            finish();
        }
    });
}

} 
```

Logcat:

```
12-26 18:25:20.360: I/Database(271): sqlite returned: error code = 1, msg = no such   column: id
12-26 18:25:20.379: D/AndroidRuntime(271): Shutting down VM
12-26 18:25:20.379: W/dalvikvm(271): threadid=1: thread exiting with uncaught exception (group=0x4001d800)
12-26 18:25:20.419: E/AndroidRuntime(271): FATAL EXCEPTION: main
12-26 18:25:20.419: E/AndroidRuntime(271): java.lang.RuntimeException: Unable to start   activity ComponentInfo{com.example.sqlite/com.example.sqlite.MainActivity}:   android.database.sqlite.SQLiteException: no such column: id: , while compiling: SELECT id,  Title, url FROM Bookmark
12-26 18:25:20.419: E/AndroidRuntime(271):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2663)
12-26 18:25:20.419: E/AndroidRuntime(271):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
12-26 18:25:20.419: E/AndroidRuntime(271):  at android.app.ActivityThread.access$2300(ActivityThread.java:125)
12-26 18:25:20.419: E/AndroidRuntime(271):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
12-26 18:25:20.419: E/AndroidRuntime(271):  at android.os.Handler.dispatchMessage(Handler.java:99)
12-26 18:25:20.419: E/AndroidRuntime(271):  at android.os.Looper.loop(Looper.java:123)
12-26 18:25:20.419: E/AndroidRuntime(271):  at android.app.ActivityThread.main(ActivityThread.java:4627)
12-26 18:25:20.419: E/AndroidRuntime(271):  at java.lang.reflect.Method.invokeNative(Native Method)
12-26 18:25:20.419: E/AndroidRuntime(271):  at java.lang.reflect.Method.invoke(Method.java:521)
12-26 18:25:20.419: E/AndroidRuntime(271):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
12-26 18:25:20.419: E/AndroidRuntime(271):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
12-26 18:25:20.419: E/AndroidRuntime(271):  at dalvik.system.NativeStart.main(Native Method)
12-26 18:25:20.419: E/AndroidRuntime(271): Caused by: android.database.sqlite.SQLiteException: no such column: id: , while compiling: SELECT id, Title, url FROM Bookmark
12-26 18:25:20.419: E/AndroidRuntime(271):  at android.database.sqlite.SQLiteCompiledSql.native_compile(Native Method)
12-26 18:25:20.419: E/AndroidRuntime(271):  at android.database.sqlite.SQLiteCompiledSql.compile(SQLiteCompiledSql.java:91)
12-26 18:25:20.419: E/AndroidRuntime(271):  at android.database.sqlite.SQLiteCompiledSql.<init>(SQLiteCompiledSql.java:64)
12-26 18:25:20.419: E/AndroidRuntime(271):  at android.database.sqlite.SQLiteProgram.<init>(SQLiteProgram.java:80)
12-26 18:25:20.419: E/AndroidRuntime(271):  at android.database.sqlite.SQLiteQuery.<init>(SQLiteQuery.java:46)
12-26 18:25:20.419: E/AndroidRuntime(271):  at android.database.sqlite.SQLiteDirectCursorDriver.query(SQLiteDirectCursorDriver.java:42)
12-26 18:25:20.419: E/AndroidRuntime(271):  at android.database.sqlite.SQLiteDatabase.rawQueryWithFactory(SQLiteDatabase.java:1345)
12-26 18:25:20.419: E/AndroidRuntime(271):  at android.database.sqlite.SQLiteDatabase.queryWithFactory(SQLiteDatabase.java:1229)
12-26 18:25:20.419: E/AndroidRuntime(271):  at android.database.sqlite.SQLiteDatabase.query(SQLiteDatabase.java:1184)
12-26 18:25:20.419: E/AndroidRuntime(271):  at android.database.sqlite.SQLiteDatabase.query(SQLiteDatabase.java:1264)
12-26 18:25:20.419: E/AndroidRuntime(271):  at com.example.sqlite.DBAdapter.GetAllBookmarks(DBAdapter.java:105)
12-26 18:25:20.419: E/AndroidRuntime(271):  at com.example.sqlite.MainActivity.refreshList(MainActivity.java:141)
12-26 18:25:20.419: E/AndroidRuntime(271):  at com.example.sqlite.MainActivity.onCreate(MainActivity.java:33)
12-26 18:25:20.419: E/AndroidRuntime(271):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
12-26 18:25:20.419: E/AndroidRuntime(271):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
12-26 18:25:20.419: E/AndroidRuntime(271):  ... 11 more
12-26 18:25:32.789: I/Process(271): Sending signal. PID: 271 SIG: 9 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T18:48:13.963

```
SQLiteException: no such column: id: , while compiling: SELECT id,  Title, url FROM Bookmark 
```

您正在尝试选择`"id"`，但您的列名为`"_id"`：

```
private static final String DB_CREATE = 
        "CREATE TABLE Bookmark (" +
        "_id integer PRIMARY KEY AUTOINCREMENT," + 
        "Title text," +
        "url text);"; 
```

您需要更改`COL_ID`以包含下划线：

```
public static final String COL_ID = "_id"; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-26T18:50:21.823

正如日志所说：

> 引起：android.database.sqlite.SQLiteException：没有这样的列：id：，编译时：SELECT id，Title，url FROM Bookmark

表示“`id`当前表中不存在列。更改您的

```
public static final String COL_ID = "id"; 
```

至

```
public static final String COL_ID = "_id"; 
```

# java - MVC should buttons go in Controller or View

> ID：14044790
> 
> 赞同：4
> 
> 时间：2012-12-26T18:45:21.290
> 
> 标签：java, model-view-controller

Hello I have read an example that I found on my school database about MVC in Java. there is this example where the buttons go into the Controller part. but isn't it correct that the buttons need to be in the VIEW because everything that the user can see must be in the view or am I understanding it wrong and is it different in Java?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T19:09:15.100

[此图像是来自 Wikipedia 上的 Model-View-Controller](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller)页面的 MVC 的概括：

![在此处输入图像描述](../Images/da5c230a004b2727401209264efe0cb6.png)

一般来说，如果您正在处理绘制/渲染 UI 元素，那属于**view**。让用户与按钮交互的动作/事件将属于**控制器**（并且可以根据需要将功能委托给服务）。

您不想在控制器中放置任何绘制/呈现按钮的代码 - 这会将控制器与特定视图紧密耦合，这违背了使用此设计模式的原则。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-26T19:17:05.603

你说按钮属于视图是正确的。但是，在某些特定情况下，您必须在控制器中定义按钮。例如，在动态 UI 的情况下，可能需要根据条件在控制器中实例化按钮。

视图/控制器分离的一个主要原因是使视图“哑”，并成为不需要测试的 UI 表示。UI 组件通常是重量级的，必须抽象出来进行测试。这是通过将其替换为反映原始组件界面的轻量级模拟并将其呈现给控制器的测试来完成的。

如果涉及条件或业务逻辑，代码应该针对不同的场景进行测试，因此属于控制器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T19:31:22.610

我给你的建议 - 看看[PureMVC Project](https://github.com/PureMVC/puremvc-java-standard-framework/wiki)的 Java 的 MVC 实现。你会发现这是一件了不起的事情！基础设施是根据[此处](http://en.wikipedia.org/wiki/PureMVC)描述的 MVC 架构实现的。

# java - Programmatic access to MultiPartConfig in Servlet 3.0

> ID：14044793
> 
> 赞同：6
> 
> 时间：2012-12-26T18:45:30.870
> 
> 标签：java, jakarta-ee, multipartform-data, servlet-3.0

I use Servlet 3 `@MultiPartConfig` annotation to implement file upload in my application. I need set multipart-config location parameter at the runtime (not hardcode in annotaion parameter). Is there any API for programmatic access to multipart-config of servlet?

Thanks

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-10-13T02:02:18.980

@MultiPartConfig 实际上只是容器的标记接口。当 servlet 初始化时，提供的注释值通过代理对象映射到它。当传入的请求是 multipart/form-data 时，上传的部分将映射到请求，并且容器根据注释中的值和请求中的部分执行必要的工作。您无法拦截此过程，因为这一切都发生在容器的内部。但是，还有一种选择。它需要第二次执行文件系统操作。由于您拥有所有部分，因此您可以重建文件并将其“重新上传”到您选择的位置。它可能看起来像下面的方法。

```
@Override
protected void doPost(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse)
        throws ServletException, IOException {

    httpServletResponse.setContentType("text/html");
    PrintWriter printWriter = httpServletResponse.getWriter();

    InputStream inputStream;
    FileOutputStream fileOutputStream;

    for (Part part : httpServletRequest.getParts()) {

        inputStream = httpServletRequest.getPart(part.getName()).getInputStream();
        int i = inputStream.available();
        byte[] b = new byte[i];
        inputStream.read(b);
        String fileName = "";

        for (String temp : part.getHeader("content-disposition").split(";")) {
            if (temp.trim().startsWith("filename")) {
                fileName = temp.substring(temp.indexOf('=') + 1).trim().replace("\"", "");
            }
        }

        String uploadDir = "/temp";
        fileOutputStream = new FileOutputStream(uploadDir + "/" + fileName);
        fileOutputStream.write(b);
        inputStream.close();
        fileOutputStream.close();

        printWriter.write("Uploaded file " + uploadDir + "/" + fileName + ".");
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-08T05:04:53.163

我也遇到了同样的问题，解决方案很简单：标准 Servlet 3.0 文件上传是不够的：只需从 Apache FileUpload Commons 获取 jar 即可

看看这个带有 Streaming API 的清晰示例

```
 ServletFileUpload upload = new ServletFileUpload();

   // Parse the request
    FileItemIterator iter = upload.getItemIterator(request);
    while (iter.hasNext()) {
      FileItemStream item = iter.next();
      String name = item.getFieldName();
      InputStream stream = item.openStream();
      if ( item.isFormField() == false) 
          System.out.println("File field " + name + " with file name "
            + item.getName() + " detected."); 
          FileOutputStream fos = new FileOutputStream("your_location"); 
          Streams.copy ( stream,  fos, true);

       }
    } 
```

# sql - SQL Query to get all names having (whole or part of) searched name

> ID：14044795
> 
> 赞同：1
> 
> 时间：2012-12-26T18:45:37.687
> 
> 标签：sql, sqlite, android-sqlite

I'm using sqlite right now and wants to know if any SQL query exists to get all the names having searched name as whole or some part of name. I have saved all names in one column i.e. "name" column and wants to get like if I have saved "abc", "xyz" and "abc xyz" as names and searched abc then it should give results like: "abc" and "abc xyz" and similar for for other names....

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T19:45:24.753

如果搜索词可以在`name`列的任何部分，请用通配符 ('%') 将搜索词括起来并使用`LIKE`运算符：

```
WHERE
    name LIKE '%abc%' 
```

如果你想要所有以“abc”**开头**`name`的s ：

 **```
WHERE
    name LIKE 'abc%' 
```

或者所有`name`以“abc”**结尾的：**

```
WHERE
    name LIKE '%abc' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T18:54:23.383

对于这种情况，您需要使用 Like 运算符

```
 SELECT  * 
    FROM table  
    WHERE Name  LIKE '%abcd' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T19:16:39.400

SQLite3 [supports regular expressions](https://stackoverflow.com/questions/5071601/how-do-i-use-regex-in-a-sqlite-query), merely need to put `where name REGEXP 'abc'` as your where clause. Hope that helps...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-26T19:41:36.310

If you want:

```
"abc", "xyz" and "abc xyz" as names
search by "abc" 
results like: "abc" and "abc xyz" 
```

You should use `field like "abc%"`**

# java - jsp read filename from servlet impossible?

> ID：14044797
> 
> 赞同：0
> 
> 时间：2012-12-26T18:45:55.147
> 
> 标签：java, jsp, servlets, filechooser

I've got a really simple problem.

I'm not able to read the file name from the (jsp) file-chooser in servlet. Normally I can get any input data with request.getParameter("name");

Can anybody tell me the shortest way please? this is my code:

```
<form method="post" enctype="multipart/form-data" action="ImportServlet"> 
<td> <input type="file" size=20 name="fname"> </td> 
<td> <input type="Submit" value="Upload"> </td> </form> 
```

thanks

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T06:43:37.720

用这个

```
request.getParameter("fname") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T18:55:58.977

```
 MultipartRequest multiPartFile =new MultipartRequest(request,"targetDirectory");
  Enumeration files = multiPartFile.getFileNames();
  while(files.hasMoreElements() ){
      String fileName = (String)files.nextElement();
      System.out.println(fileName);
      String fileSystemName= multiPartFile.getFilesystemName(fileName );
      System.out.println(fileSystemName);
    } 
```

# java - Extract overlapping matches using split

> ID：14044800
> 
> 赞同：3
> 
> 时间：2012-12-26T18:46:28.593
> 
> 标签：java, regex, split

How can I extract overlapping matches from an input using `String.split()`?

For example, if trying to find matches to `"aba"`:

```
String input = "abababa";
String[] parts = input.split(???); 
```

Expected output:

```
[aba, aba, aba] 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-26T19:07:16.940

`String#split`不会给你重叠的比赛。因为字符串的特定部分，只会包含在获得的数组的唯一索引中，而不包含在两个索引中。

你应该在这里使用`Pattern`和`Matcher`类。你可以使用这个正则表达式： -

```
Pattern pattern = Pattern.compile("(?=(aba))"); 
```

并使用`Matcher#find`方法获取所有重叠匹配，并`group(1)`为其打印。

上面的正则表达式匹配每个空字符串，后面跟着`aba`，然后只打印第一个捕获的组。现在因为`look-ahead`是*零宽度*断言，所以它不会消​​耗匹配的字符串。因此，您将获得所有重叠的匹配项。

```
String input = "abababa";
String patternToFind = "aba";

Pattern pattern = Pattern.compile("(?=" + patternToFind + ")");
Matcher matcher = pattern.matcher(input);

while (matcher.find()) {
    System.out.println(patternToFind + " found at index: " + matcher.start());
} 
```

**输出： -**

```
aba found at index: 0
aba found at index: 2
aba found at index: 4 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-26T19:28:18.760

我会使用 indexOf。

```
for(int i = text.indexOf(find); i >= 0; i = text.indexOf(find, i + 1))
   System.out.println(find + " found at " + i); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T19:04:49.937

这不是正确使用`split()`. 从[javadocs](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/String.html#split%28java.lang.String%29)：

> 围绕给定正则表达式的匹配拆分此字符串。

在我看来，您不是在尝试拆分字符串，而是在字符串中查找正则表达式的所有匹配项。为此，您必须使用[Matcher](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/regex/Matcher.html)和一些额外的代码，这些代码在 上循环`Matcher`以查找所有匹配项，然后创建数组。

# mysql - How insert in to two table with same auto increment id

> ID：14044807
> 
> 赞同：-1
> 
> 时间：2012-12-26T18:47:25.693
> 
> 标签：mysql, database

I need to insert data from a flat_table into two tables client_data client_contact.

```
flat_table
    f_name
    l_name
    client_id
    phone
    address

client_data
    id AI
    f_name
    l_name
    ...
    ... 

client_contact
    client_id
    phone
    address
    ...
    ... 
```

I was thinking of using mysql_last_id somehow but I don't know even where to start.

there are other questions like this but they don't answer my question.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T18:51:40.353

1.  假设没有两个客户端共享相同的`f_name`和`l_name`：

    ```
    INSERT INTO client_data (f_name, l_name)
      SELECT DISTINCT f_name, l_name
      FROM   flat_table;

    INSERT INTO client_contact (client_id, phone, address)
      SELECT d.id, f.phone, f.address
      FROM   flat_table f JOIN client_data d USING (f_name, l_name); 
    ```

2.  假设所有记录`flat_table`对应不同的客户端：

    ```
    CREATE TEMPORARY TABLE flat_table2 (
      id SERIAL
    ) SELECT * FROM flat_table;

    INSERT INTO client_data (id, f_name, l_name)
      SELECT DISTINCT id, f_name, l_name
      FROM   flat_table2;

    INSERT INTO client_contact (client_id, phone, address)
      SELECT id, phone, address
      FROM   flat_table2;

    DROP TEMPORARY TABLE flat_table2; 
    ```

3.  如果不同的客户端可能共享相同的记录`f_name`，`l_name`但并非每条记录都`flat_table`对应一个唯一的客户端，则您需要找到某种方法来识别哪些记录对应于哪些客户端。

# javascript - JavaScript 函数在 IE 中不执行（称为 onhashchange），在 Chrome、Firefox 中有效

> ID：14044812
> 
> 赞同：0
> 
> 时间：2012-12-26T18:47:54.820
> 
> 标签：javascript, internet-explorer, internet-explorer-9, hashchange

这个网站： http: [//jcorps.org/jsuite](http://jcorps.org/jsuite)在 Chrome 中工作，根据 HASH CHANGE 更改内容，IE9 似乎正在处理 onHashChange，但是......

IE9 根本不执行“UpdatePage()”函数或在 IE 的开发人员/调试控制台中产生任何类型的错误消息，所以我看不到它在哪里“中断”。有什么想法吗？

谢谢！阿里

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T18:57:32.380

您的页面上没有[doctype](http://www.w3.org/QA/2002/04/valid-dtd-list.html)，因此 IE9 以 quirks 模式呈现它，该模式不支持 hashchange 事件。添加正确的文档类型将允许 IE9 以正确的模式呈现您的页面，从而启用 hashchange 事件。

另请参阅这个类似的问题：[onhashchange with IE 9](https://stackoverflow.com/questions/4984319/onhashchange-with-ie-9)

# ms-access-2003 - ms-access 2003 countif in a report

> ID：14044814
> 
> 赞同：0
> 
> 时间：2012-12-26T18:47:56.753
> 
> 标签：ms-access-2003

I have a report that displays all office employees. I am trying to give a summary of employee by type in the foother of the report and I receive an #Error as a result.

```
Report Detail
Name    DOH    UserID    Position

Page Footer
Text Box with "=Count(IIf([Position] Like "CS",0))"
I have also tried "=Count(IIf([Position]="CS",0))" 
```

Both Return #Error

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T19:16:42.867

Through Trial and error I found the following to work

```
=Count(IIf([Position]="CS",1,0)) 
```

# sql - Using union multiple times with distinct on top of the final results

> ID：14044815
> 
> 赞同：4
> 
> 时间：2012-12-26T18:48:00.887
> 
> 标签：sql, sql-server, distinct, union

I cannot figure out how to merge 4 different columns from 2 different tables together into just one single column of all possible results, with duplicates removed. The actual names are different, but suppose I have the following two tables

**Table1**

1.  Field1
2.  Field2
3.  SomethingElse

**Table2**

1.  Field1
2.  Field2
3.  SomethingElse

Now in the end, I would like to merge all 4 of these fields together into one large field, and then use *distinct* on top of that to eliminate any duplicates, as there are many of them. The final result should be just one single column containing every possible value found in all 4 columns, without any duplicated.

When I was working with just one single table with two fields, I had it working fine:

```
select distinct(Field1) from Table1 where SomethingElse = SomeVal
union
(select distinct(Field2) from Table1 where SomethingElse = SomeVal)
order by 1 
```

(of course I wished to have run `distinct` around the final result rather than each field)

Now I needed to add 2 more fields from another table. Nothing I have tried has even run, can't get the syntax right.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-26T18:52:51.903

这是一种方法：

```
select distinct val
from ((select field1 as val from table1 where somethingelse = someval) union all
      (select field2 from table1 where somethingelse = someval) union all
      (select field1 from table2 where somethingelse = someval) union all
      (select field2 from table2 where somethingelse = someval)
     ) t 
```

我使用合并子查询`union all`，然后只`distinct`在外层执行一次。

因为我想知道的下一件事是这些值的使用位置，所以这里是查询：

```
select val, SUM(t1f1), SUM(t1f2), SUM(t2f1), SUM(t2f2)
from ((select field1 as val, 1 as t1f1, 0 as t1f2, 0 as t2f1, 0 as t2f2 from table1 where somethingelse = someval) union all
      (select field2, 0 as t1f1, 1 as t1f2, 0 as t2f1, 0 as t2f2 from table1 where somethingelse = someval) union all
      (select field1, 0 as t1f1, 0 as t1f2, 1 as t2f1, 0 as t2f2 from table2 where somethingelse = someval) union all
      (select field2, 0 as t1f1, 0 as t1f2, 0 as t2f1, 1 as t2f2 from table2 where somethingelse = someval)
     ) t
group by val 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T18:57:07.257

```
select distinct(Field1) from 
(
select Field1 [Field1] from Table1 where SomethingElse = SomeVal
union all
select Field2 [Field1] from Table1 where SomethingElse = SomeVal
) rawResults
order by 1 
```

像这样的东西应该工作。只需将您的选择组合在一起并将其放在一个内联视图中，然后将您的独特和排序放在外面。我使用 union all 因为无论如何你都要在外面做一个不同的一次

# css - Zurb Foundation 中的重叠 div

> ID：14044816
> 
> 赞同：3
> 
> 时间：2012-12-26T18:48:12.090
> 
> 标签：css, html, css-position, zurb-foundation, grid-layout

我今天刚开始使用 Zurb 的 Foundation，到目前为止我非常喜欢它。它使建立网站非常快。我已经看到了如何使用我喜欢的列数和嵌套列来创建行。现在我有一个问题。在使用 Foundation 之前，我正在开发一个网站，该网站由一个包装器组成，该包装器包含一个带有导航菜单的标题和一个带有图像滑块的 div，该滑块与标题重叠并部分重叠显示主要内容的网站的下划线部分。我通过使用具有固定像素的相对定位来做到这一点。现在使用 Foundation 我可以重新创建相同的定位吗？到目前为止，我正在与 Foundation 合作的网站是响应式的，所以我想保持响应性。我想我不能使用像素，那么我应该使用百分比来定义 div 的顶部和右侧的属性吗？我不知道该怎么做，因为网格是由列组成的。我附上我想要获得的图像，以使其更清晰。这只是一个简单的模型，但您应该能够理解。

![在此处输入图像描述](../Images/ca9aed6301d3d3e273f3925c1069a948.png)

这是正在使用 Foundation 开发的页面：

![在此处输入图像描述](../Images/7c16a54add695c8f9262d997ba2bb436.png) ![在此处输入图像描述](../Images/a9eb63ba51a7df87cf91be88f69ca52c.png)

使用 Foundation 开发的页面的 Html：

```
<!DOCTYPE html>

<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
  <meta charset="utf-8" />

  <!-- Set the viewport width to device width for mobile -->
  <meta name="viewport" content="width=device-width" />

  <title>Welcome to Foundation | Homepage</title>

  <!-- Included CSS Files (Uncompressed) -->
  <!--
  <link rel="stylesheet" href="stylesheets/foundation.css">
  -->

  <!-- Included CSS Files (Compressed) -->
  <link rel="stylesheet" href="stylesheets/foundation.min.css">
  <link rel="stylesheet" href="stylesheets/app.css">

  <script src="javascripts/modernizr.foundation.js"></script>
</head>
<body>

  <!-- Header and Nav -->

  <div class="row">
    <div class="three columns">
      <h1><img src="images/logo.png" /></h1>
    </div>
    <div class="nine columns">
      <ul class="nav-bar right">
        <li><a href="#">Home</a></li>
        <li><a href="#">Il centro</a></li>
        <li><a href="#">Lo staff</a></li>
        <li><a href="#">Mappa</a></li>
        <li><a href="#">Contatti</a></li>
      </ul>
    </div>
  </div>

  <!-- End Header and Nav -->

  <!-- First Band (Slider) -->
  <!-- The Orbit slider is initialized at the bottom of the page by calling .orbit() on     #slider -->

  <div class="row">
    <div class="three columns">
      <span class="secondary label" style="font-size:26px;">Servizi</span>
      <ul class="nav-bar vertical accordion">
        <li>
          <div class="title">
            <h5>Chinesiterapia</h5>
          </div>
          <ul class="content">
            <li><a href="#">Riabilitazione perineale</a></li>
            <li><a href="#">Fisiokinesiterapia segmentaria</a></li>
            <li><a href="#">Chinesiterapia globale</a></li>
            <li><a href="#">Ginnastica correttiva</a></li>
            <li><a href="#">Recupero post traumatico</a></li>
            <li><a href="#">Ginnastica di gruppo per adulti</a></li>
            <li><a href="#">Rieducazione posturale globale</a></li>
          </ul>
        </li>
        <li>
          <div class="title">
            <h5>Massoterapia</h5>
          </div>
          <ul class="content">
            <li><a href="#">Massaggio manuale</a></li>
            <li><a href="#">Linfodrenaggio</a></li>
            <li><a href="#">Massaggio connettivale</a></li>
          </ul>
        </li>
        <li>
          <div class="title">
            <h5>Terapia fisica</h5>
          </div>
          <ul class="content">
            <li><a href="#">Elettroterapia galvanica</a></li>
            <li><a href="#">Elettroterapia faradica</a></li>
            <li><a href="#">Elettroterapia interferenziale</a></li>
            <li><a href="#">Correnti diadinamiche</a></li>
            <li><a href="#">Elettrostimolazioni</a></li>
            <li><a href="#">Ionoforesi</a></li>
            <li><a href="#">Radarterapia</a></li>
            <li><a href="#">Ultrasuoni</a></li>
            <li><a href="#">Magnetoterapia</a></li>
            <li><a href="#">Laserterapia CO2</a></li>
            <li><a href="#">Test muscolare</a></li>
            <li><a href="#">Tecarterapia</a></li>
            <li><a href="#">Horizontal therapy</a></li>
          </ul>
        </li>
      </ul>
    </div>
    <div class="six columns">
      <div id="slider">
        <img src="images/1.png" />
        <img src="images/2.png" />
        <img src="images/3.png" />
        <img src="images/4.png" />
      </div>

      <hr />
    </div>
  </div>

  <!-- Three-up Content Blocks -->

  <div class="row">
    <div class="nine columns">
      <img src="http://placehold.it/400x300&text=[img]" />
      <h4>This is a content section.</h4>
      <p>Bacon ipsum dolor sit amet nulla ham qui sint exercitation eiusmod commodo, chuck   duis velit. Aute in reprehenderit, dolore aliqua non est magna in labore pig pork biltong.   Eiusmod swine spare ribs reprehenderit culpa. Boudin aliqua adipisicing rump corned beef.  </p>
    </div>

    <div class="three columns">
      <img src="http://placehold.it/400x300&text=[img]" />
      <h4>This is a content section.</h4>
      <p>Bacon ipsum dolor sit amet nulla ham qui sint exercitation eiusmod commodo, chuck duis velit. Aute in reprehenderit, dolore aliqua non est magna in labore pig pork biltong. Eiusmod swine spare ribs reprehenderit culpa. Boudin aliqua adipisicing rump corned beef.  </p>
    </div>
  </div>

  <!-- Call to Action Panel -->
  <div class="row">
    <div class="twelve columns">

      <div class="panel">
        <h4>Get in touch!</h4>

        <div class="row">
          <div class="nine columns">
            <p>We'd love to hear from you, you attractive person you.</p>
          </div>
          <div class="three columns">
            <a href="#" class="radius button right">Contact Us</a>
          </div>
        </div>
      </div>

    </div>
  </div>

   <!-- Footer -->

   <footer class="row">
     <div class="twelve columns">
      <hr />
      <div class="row">
        <div class="six columns">
          <p>&copy; Copyright no one at all. Go to town.</p>
        </div>
        <div class="six columns">
          <ul class="link-list right">
            <li><a href="#">Link 1</a></li>
            <li><a href="#">Link 2</a></li>
            <li><a href="#">Link 3</a></li>
            <li><a href="#">Link 4</a></li>
          </ul>
        </div>
      </div>
     </div> 
   </footer>

   <!-- Included JS Files (Uncompressed) -->
   <!--
    <script src="javascripts/jquery.js"></script>
    <script src="javascripts/jquery.foundation.mediaQueryToggle.js"></script>
    <script src="javascripts/jquery.foundation.forms.js"></script>
    <script src="javascripts/jquery.foundation.reveal.js"></script>
    <script src="javascripts/jquery.foundation.orbit.js"></script>
    <script src="javascripts/jquery.foundation.navigation.js"></script>
    <script src="javascripts/jquery.foundation.buttons.js"></script>
    <script src="javascripts/jquery.foundation.tabs.js"></script>
    <script src="javascripts/jquery.foundation.tooltips.js"></script>
    <script src="javascripts/jquery.foundation.accordion.js"></script>
    <script src="javascripts/jquery.placeholder.js"></script>
    <script src="javascripts/jquery.foundation.alerts.js"></script>
    <script src="javascripts/jquery.foundation.topbar.js"></script>
    <script src="javascripts/jquery.foundation.joyride.js"></script>
    <script src="javascripts/jquery.foundation.clearing.js"></script>
    <script src="javascripts/jquery.foundation.magellan.js"></script>
    -->

    <!-- Included JS Files (Compressed) -->
    <script src="javascripts/jquery.js"></script>
    <script src="javascripts/foundation.min.js"></script>

    <!-- Initialize JS Plugins -->
    <script src="javascripts/app.js"></script>

    <script type="text/javascript">
   $(window).load(function() {
       $('#slider').orbit();
   });
    </script>

  </body>
</html> 
```

将此 html 文件与最新版本的 Foundation (3.2.2) 一起检查。从这里下载：http: [//foundation.zurb.com/download.php](http://foundation.zurb.com/download.php)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T19:43:49.150

You can use [css clearfix](http://www.webtoolkit.info/css-clearfix.html) before your content div:

```
<div class="clearfix"></div> 
```

or, with the header div:

```
<div id="header" class="clearfix"> 
```

This will give your header a dynamic height and push down your content.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-09T18:59:10.890

框架中没有“clearfix”类只有“clearing”

# c++ - 无法在头文件中使用自定义对象？

> ID：14044821
> 
> 赞同：0
> 
> 时间：2012-12-26T18:48:35.863
> 
> 标签：c++, class

我正在头文件（声明）和 .cpp 文件（定义）中构建一个类。在“私人”部分，我有一个

```
string m_name 
```

当我尝试编译它时，编译器给了我一个错误。如果我用 char* 替换字符串，它可以正常工作。但是，我确实需要一个字符串，而不是 char*。我应该在某处或某处添加字符串标题吗？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T18:49:50.827

确保您`#include <string>`位于头文件的顶部，并记住它位于`std`命名空间：`std::string m_name;`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T19:06:51.937

如果你想使用字符串，你基本上需要包含它`#include <string.h>`的 C 或`#include <cstring>`C++ 的头文件，否则你会得到错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-26T18:50:38.733

我怀疑有两个问题：一个，“我应该在某处添加字符串标题吗？” - 你应该

```
#include <string> 
```

二，如果你不是`using namespace std;`，那么你必须使用类的完全限定名，即 is`std::string`而不仅仅是`string`.

# git - 我可以在 git 中分离一个项目吗？

> ID：14044824
> 
> 赞同：2
> 
> 时间：2012-12-26T18:48:47.203
> 
> 标签：git

我有一个由几个小应用程序组成的项目。是否有可能将它们分开并在一些工作后将更改带回主要位置？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T19:01:50.280

正确的方法是使用[submodules](http://git-scm.com/book/en/Git-Tools-Submodules)。它们与大多数 git 一样，非常灵活，应该能够适应您的工作流程。虽然你可以扭曲 git 的分支来做类似的事情，但子模块的存在是有原因的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T18:56:38.370

每个应用程序都有一个单独的分支，然后一旦完成，您可以在完成后将它们合并回主分支。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T18:59:26.733

如果您的意思是将它们拆分到 git 存储库中。是的，这是可能的。为每个部分初始化一个新的存储库并将它们放在那里。完成后，您可以使用拉取请求将它们合并在一起。

但我会尝试分支，所以看看 Egryan 的回答。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-26T21:05:55.313

创建和处理主题和长期运行的分支，在它们之间合并并删除它们。查看更多详细信息[http://git-scm.com/book/en/Git-Branching-Basic-Branching-and-Merging](http://git-scm.com/book/en/Git-Branching-Basic-Branching-and-Merging)

# jquery - 基于主干/下划线中的另一个字段对一个数据库字段求和的函数

> ID：14044830
> 
> 赞同：1
> 
> 时间：2012-12-26T18:49:38.780
> 
> 标签：jquery, backbone.js, underscore.js

我目前正在使用主干整理一个简单的库存管理应用程序。我的数据库中有一个包含模型和数量的表；这是对象的 stigify 版本：

var invt =

[ {
"id":1,
"model":"Canon SX230",
"qty":10,
"price":"150.50"
},
{
"id":2,
"model":"Canon Rebel T3i",
"数量”：25，
“价格”：“450.50”，
}，
{
“id”：3，
“型号”：“Canon Rebel T2”，
“数量”：10，
“价格”：“250.00”
}，
{
“id ":4,
"型号":"Canon Rebel T2i",
"数量":15,
"价格":"275.00"
},
{
"id":5,
"型号”：“佳能 SX230”，
“数量”：5，
“价格”：“125.00”
}]

如何过滤以根据模型对数量求和。创建具有相似模型的新对象总计数量。

本质上，结果将是：
[{
"id":1,
"model":"Canon SX230",
"qty":15,
"price":"275.00"
},
{
"id":2,
"model":" Canon Rebel T3i",
"qty":25,
"price":"450.50"
}]
等...

我一直在尝试使用以下循环：

变量总和 = {};

```
 for (var i = 0; i < invt.length; i++) { 
        var record = invt[i];

        sum.model = record.model + (sum.model);
    }; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T18:54:44.243

```
Select sum(quantity)
From yourtable
Group by model; 
```

这应该这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T19:04:12.463

由于您只使用了与 JS 相关的标签，我猜您想在客户端执行此操作。

你可以这样做：

```
var records = [
    {
        id: 1,
        model: "A",
        quantity: 6
    }, {
        id: 1,
        model: "A",
        quantity: 4
    }, {
        id: 1,
        model: "B",
        quantity: 3
    }, {
        id: 1,
        model: "B",
        quantity: 2
    }
];

var sum = {};
for(var i = 0; i < records.length; i++) {
    var record = records[i];
    sum[record.model] = record.quantity + (sum[record.model] || 0);
}
document.body.innerHTML = JSON.stringify(sum);​ 
```

演示：http: [//jsfiddle.net/Dhsm5/](http://jsfiddle.net/Dhsm5/)

将此对象转换为您想要的格式将是微不足道的。

# php - mail() 函数和 Microsoft 365

> ID：14044831
> 
> 赞同：1
> 
> 时间：2012-12-26T18:49:44.723
> 
> 标签：php, email

我正在使用 PHP 的`mail()`函数向管理员发送“忘记密码”链接和报告。当我使用 Gmail 对其进行测试时，一切正常。但是，当我将电子邮件发送到 Microsoft 365 邮箱时，即使在垃圾文件夹中，邮件也不会出现。

我应该怎么办？

UPD

我尝试使用标题和“返回路径”附加参数。我的代码如下所示：

```
 $to      = 'my_email@corporate_domain.com';
        $subject = 'test';
        $message = 'test';
        $headers  = 'MIME-Version: 1.0' . "\r\n";
        $headers .= 'Content-type: text/html; charset=iso-8859-1' . "\r\n";
        $headers .= "To: Tamara <my_email@corporate_domain.com>" . "\r\n";
        $headers .= 'From: Sender <sender@domain.com>' . "\r\n";
        $headers .= 'Reply-To: Sender <sender@domain.com>'. "\r\n";
        $headers .=  "Return-Path:<Sender@domain.com>"."\r\n";

        mail($to, $subject, $message, $headers, "-r sender@domain.com"); 
```

我终于收到了退回邮件，上面写着：

暂停服务; 客户端主机 [5.166.*.68] 被阻止使用阻止列表 1，来自 IP 的邮件被禁止；要请求从此列表中删除，请将此邮件转发至 delist@messaging.microsoft.com 并附上您的 IP 地址。

但是没有邮件发送到这封电子邮件，甚至发送到这个域。我的 IP 怎么可能已经被封禁了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T19:26:03.800

尝试使用以下方法发送测试电子邮件：

```
$to      = 'myemail@company-domain.com';
$subject = 'test';
$message = 'test';
$headers = 'From: yourValidEmail@example.com' . "\r\n" .
           'Reply-To: yourValidEmail@example.com' . "\r\n" .
           'X-Mailer: PHP/' . phpversion();

mail($to, $subject, $message, $headers); 
```

如果这可行并且您现在在*垃圾邮件/垃圾邮件*文件夹中看到您的电子邮件，我建议您查看设置[PTR 记录](http://en.wikipedia.org/wiki/List_of_DNS_record_types)并确保您的域名具有正确的反向 dns 设置以指向您的服务器 IP 地址。请参阅[反向 DNS](http://en.wikipedia.org/wiki/Reverse_DNS_lookup)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T19:03:57.417

我的第一个建议是首先删除 headers 参数中的任何自定义内容，并查看是否只有普通电子邮件首先通过。如果它失败并且您正在发送纯文本电子邮件，我建议检查邮件服务器发送地址上的 PTR 记录。您应该能够在您在 gmail 中收到的电子邮件的标题中看到这一点。

# iphone - 什么会导致 Core Animation 产生僵尸？

> ID：14044838
> 
> 赞同：1
> 
> 时间：2012-12-26T18:50:13.117
> 
> 标签：iphone, ios, memory-management, core-animation

我在制作动画时遇到了僵尸，而 Zombies 工具并没有多大帮助。这就是它的意思：

![在此处输入图像描述](../Images/63cc3241414f241906d616cd80bc29de.png)

发出动画的代码是一个实用程序，它接收一个动画块并将其传递给 Core Animation：

![在此处输入图像描述](../Images/3328272d96d8c63e9fe70bc222657c9b.png)

我猜它与动画块中受影响的视图有关，该视图在动画期间以某种方式消失。

我一辈子都想不通Core Animation为什么要制作僵尸。什么会导致这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T02:00:46.373

我已经多次使用那些 animateWithDuration 视图调用并且从未有过僵尸。

在我看来，您正在处理 Core Animation（或 UIView 动画代码）一个自动释放（如果您使用手动引用计数）或非强引用（如果您使用 ARC）的对象。

发布创建动画块的代码，并描述您正在制作动画的视图以及您在动画块中引用的任何对象的生命周期。

选择一个动画块开始。您很可能在其他动画中犯了同样的错误。

# java - 原始图像尺寸 VS 显示图像尺寸

> ID：14044839
> 
> 赞同：1
> 
> 时间：2012-12-26T18:50:20.433
> 
> 标签：java, android

我正在尝试获取屏幕上显示的图像大小，而不是图像的原始大小。

我已经对此进行了一些研究，并且在两年前未解决[的帖子上发现了同样的问题，所以我想也许现在有一种新的方法可以做到这一点。](https://stackoverflow.com/questions/3855218/trying-to-get-the-display-size-of-an-image-in-an-imageview)

我尝试了这 3 个解决方案：

```
//Get the same result for all my images (whereas images have difference sizes)
imageView.getWidth() + imageView.getHeight()

//Get the original size of the images  
imageView.getDrawable().getIntrinsicWidth() + imageView.getDrawable().getIntrinsicHeight()
bitMap.getWidth() + bitMap.getHeight() 
```

我的 xml：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:padding="1dip" >

<ImageView
android:id="@+id/image"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:layout_gravity="center"
android:adjustViewBounds="true"
android:contentDescription="@string/descr_image"
android:layout_alignParentBottom="true" />

<ProgressBar
android:id="@+id/loading"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:layout_gravity="center"
android:visibility="gone" />

<WebView  xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/webView1"
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:layout_alignParentBottom="true"
/>
</RelativeLayout> 
```

**更新 1**

```
ViewTreeObserver viewTreeObserver = imageView.getViewTreeObserver();
if (viewTreeObserver.isAlive()) {
     viewTreeObserver.addOnGlobalLayoutListener(new OnGlobalLayoutListener() {
       @SuppressWarnings("deprecation")
       public void onGlobalLayout() {      
           imageView.getViewTreeObserver().removeGlobalOnLayoutListener(this)               
           System.out.println("TEST :" + imageView.getWidth() + " " + imageView.getHeight());
        }
    });
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T18:55:11.627

在你的`ImageView`你有宽度和高度设置为

```
android:layout_width="fill_parent"
android:layout_height="fill_parent" 
```

图像视图将填充父级，`getWidth()`并且`getHeight()`将为您提供这些值。

您将需要以`ImageView`某种方式包装以使其正确显示，但要给出`ImageView`宽度/高度值，例如

```
android:layout_width="wrap_content"
android:layout_height="wrap_content" 
```

还有一个关于[ImageView 位图比例尺寸](https://stackoverflow.com/questions/5033723/imageview-bitmap-scale-dimensions)的答案，似乎也解决了这个问题。

从[https://stackoverflow.com/users/321697/kcoppock](https://stackoverflow.com/users/321697/kcoppock)的回答：

```
ImageView iv = (ImageView)findViewById(R.id.imageview);
int scaledHeight, scaledWidth;
iv.getViewTreeObserver().addOnPreDrawListener(
    new ViewTreeObserver.OnPreDrawListener() {
    @Override
    public boolean onPreDraw() {
        Rect rect = iv.getDrawable().getBounds();
        scaledHeight = rect.height();
        scaledWidth = rect.width();
        iv.getViewTreeObserver().removeOnPreDrawListener(this);
        return true;
    }
}); 
```

# css - 如何防止内联 div 跳转到父级中的下一行？

> ID：14044843
> 
> 赞同：13
> 
> 时间：2012-12-26T18:50:44.410
> 
> 标签：css, html

我有两个内联 div，它们的宽度超过了父级的宽度。因此第二个 div 跳转到下一行：http: [//jsfiddle.net/uVqG6/2/](http://jsfiddle.net/uVqG6/2/)

如何将两个 div 保持在同一行？

添加`overflow:hidden;`到 div.a 只是隐藏了第二个 div。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-26T18:54:59.407

有几种方法可以做到这一点。首先，您可以使用`display: inline-block;`or`float: left;`让 div 并排放置。它们的工作方式不同，因此请务必为您的情况使用正确的。

其次，除非包含的 div (a) 大到足以在同一行包含两个 div，否则这些都不起作用。或者，您可以`overflow: hidden;`在包含的 div (a) 上使用。

**编辑：**

我已经更新了你的例子：http: [//jsfiddle.net/uVqG6/11/](http://jsfiddle.net/uVqG6/11/)

我不得不使用`white-space: nowrap;`，因为内部 div 正在包装。

这是另一个答案，它也回答了您的问题：[CSS：如何阻止文本占用超过 1 行？](https://stackoverflow.com/questions/572298/css-how-to-stop-text-from-taking-up-more-than-1-line)

请记住 using`display: inline-block`基本上将元素视为文本，因此大多数文本格式的 css 属性都将应用于它。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-26T18:55:11.643

您可以使用`position: absolute;`它，否则除了增加容器 div 宽度或制作它之外别无他法`nowrap`

[**演示**](http://jsfiddle.net/uVqG6/9/)

使用`z-index` [**演示**](http://jsfiddle.net/uVqG6/10/)

CSS

```
.a {
    width: 100px;
    height: 50px;
    border: solid 1px #345;
    position: relative;
}

.b {
    width: 60px;    
    height: 50px;
    background-color: red;
}
.c {
    width: 50px;    
    height: 50px;
    background-color: green;
    position: absolute;
    right: 0;
    top: 0;
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-12-26T18:54:46.830

内联元素的行为方式与文本非常相似。如果您想阻止它们换行，请删除您用于格式化的空格，或添加`white-space:nowrap;`到`.a`.

这是一个演示：http: [//jsfiddle.net/bfkgT/](http://jsfiddle.net/bfkgT/)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-12-26T18:53:13.023

```
.a {
width: 100px;
height: 50px;
border: solid 1px #345;
white-space: nowrap;
overflow:hidden; } 
```

这是做你想做的吗？

# c# - 使用 SocketAsyncEventArgs 每秒接收 20 次

> ID：14044852
> 
> 赞同：11
> 
> 时间：2012-12-26T18:52:10.827
> 
> 标签：c#, windows, sockets, asynchronous, socketasynceventargs

TCP 服务器是使用 SocketAsyncEventArgs 开发的，它是作为 Windows 服务的异步方法。我在 Main 的开头有这 2 行代码：

```
ThreadPool.SetMaxThreads(15000, 30000);
ThreadPool.SetMinThreads(10000, 20000); 
```

并且两者都返回 true（记录返回值）。现在有 2000 到 3000 个客户端开始向该服务器发送消息，并且它开始接受连接（我计算了连接数，它符合预期 - 有一个连接池）。服务器进程的线程数将增加到 ~2050 到 ~3050。到现在为止还挺好！

现在有一个 Received 方法，该方法将在 ReceiveAsync 返回 true 后或通过 SocketAsyncEventArgs 的 Completed 事件调用。

问题就从这里开始了：无论连接了多少客户端，发送了多少消息，Received 最多在一秒钟内被调用 20 次！随着客户数量的增加，这个数字（20）下降到约 10。

环境：在同一台机器上模拟 TCP Server 和客户端。我在 2 台机器上测试了代码，一台有 2 核 CPU 和 4GB RAM，另一台有 8 核 CPU 和 12GB RAM。没有数据丢失（还），有时我在每个接收操作中收到超过 1 条消息。没关系。但是如何才能增加接收操作的数量呢？

关于实现的附加说明：代码很大，包含许多不同的逻辑。总体描述是：我有一个 SocketAsyncEventArgs 用于接受新连接。它工作得很好。现在，对于每个新接受的连接，我都会创建一个新的 SocketAsyncEventArgs 来接收数据。我把这个（为接收创建的 SocketAsyncEventArgs）放在一个池中。它不会被重用，但它的 UserToken 被用于跟踪连接；例如，那些断开的连接或那些 7 分钟没有发送任何数据的连接将被关闭和处置（SocketAsyncEventArgs 的 AcceptSocket 将被关闭（两者）、关闭和处置，SocketAsyncEventArgs 对象本身也是如此）。

```
class Sudo
{
    Socket _listener;
    int _port = 8797;

    public Sudo()
    {
        var ipEndPoint = new IPEndPoint(IPAddress.Any, _port);
        _listener = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
        _listener.Bind(ipEndPoint);

        _listener.Listen(100);

        Accept(null);
    }

    void Accept(SocketAsyncEventArgs acceptEventArg)
    {
        if (acceptEventArg == null)
        {
            acceptEventArg = new SocketAsyncEventArgs();
            acceptEventArg.Completed += AcceptCompleted;
        }
        else acceptEventArg.AcceptSocket = null;

        bool willRaiseEvent = _listener.AcceptAsync(acceptEventArg); ;

        if (!willRaiseEvent) Accepted(acceptEventArg);
    }

    void AcceptCompleted(object sender, SocketAsyncEventArgs e)
    {
        Accepted(e);
    }

    void Accepted(SocketAsyncEventArgs e)
    {
        var acceptSocket = e.AcceptSocket;
        var readEventArgs = CreateArg(acceptSocket);

        var willRaiseEvent = acceptSocket.ReceiveAsync(readEventArgs);

        Accept(e);

        if (!willRaiseEvent) Received(readEventArgs);
    }

    SocketAsyncEventArgs CreateArg(Socket acceptSocket)
    {
        var arg = new SocketAsyncEventArgs();
        arg.Completed += IOCompleted;

        var buffer = new byte[64 * 1024];
        arg.SetBuffer(buffer, 0, buffer.Length);

        arg.AcceptSocket = acceptSocket;

        arg.SocketFlags = SocketFlags.None;

        return arg;
    }

    void IOCompleted(object sender, SocketAsyncEventArgs e)
    {
        switch (e.LastOperation)
        {
            case SocketAsyncOperation.Receive:
                Received(e);
                break;
            default: break;
        }
    }

    void Received(SocketAsyncEventArgs e)
    {
        if (e.SocketError != SocketError.Success || e.BytesTransferred == 0 || e.Buffer == null || e.Buffer.Length == 0)
        {
            // Kill(e);
            return;
        }

        var bytesList = new List<byte>();
        for (var i = 0; i < e.BytesTransferred; i++) bytesList.Add(e.Buffer[i]);

        var bytes = bytesList.ToArray();

        Process(bytes);

        ReceiveRest(e);

        Perf.IncOp();
    }

    void ReceiveRest(SocketAsyncEventArgs e)
    {
        e.SocketFlags = SocketFlags.None;
        for (int i = 0; i < e.Buffer.Length; i++) e.Buffer[i] = 0;
        e.SetBuffer(0, e.Buffer.Length);

        var willRaiseEvent = e.AcceptSocket.ReceiveAsync(e);
        if (!willRaiseEvent) Received(e);
    }

    void Process(byte[] bytes) { }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-26T19:45:57.747

它变慢的原因是因为这些线程中的每一个都需要进行上下文切换，这是一项相对昂贵的操作。您添加的线程越多，您的 CPU 的更大百分比仅用于上下文切换，而不是用于您的实际代码。

您以一种相当奇怪的方式遇到了每个客户端一个线程的瓶颈。服务器端异步的全部意义在于*减少*线程的数量——每个客户端没有一个线程，但理想情况下，系统中的每个逻辑处理器只有一个或两个。

您发布的异步代码看起来不错，所以我只能猜测您的`Process`方法有一些容易忽略的非异步阻塞 I/O，即数据库或文件访问。`Process`当 I/O 阻塞时，.NET 线程池会检测到这一点并自动启动一个新线程——它基本上在这里以 I/O作为瓶颈而失控。

异步管道确实需要 100% 异步才能从中获得任何显着的好处。Half-in 会让您编写复杂的代码，其性能与简单的同步代码一样差。

如果您绝对不能使该`Process`方法完全异步，那么您可能会幸运地伪造它。让事情在队列中等待由一个小型的、有限大小的线程池处理。

# c - GtkTreeView 同构列宽

> ID：14044855
> 
> 赞同：2
> 
> 时间：2012-12-26T18:52:14.553
> 
> 标签：c, gtk, gtktreeview

有没有办法让 GtkTreeView 中的所有列都具有相同的宽度，无论是通过编程还是使用 Glade/GtkBuilder？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-11-03T18:15:43.293

更好的方法是使用[`gtk_tree_view_column_set_expand`](https://developer.gnome.org/gtk3/unstable/GtkTreeViewColumn.html#gtk-tree-view-column-set-expand).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T04:13:56.617

这是一个有 6 列的示例，它假设您使用 gtk_widget_set_size_request 作为树视图小部件。我在这里也完成了窗口的大小请求，因此树视图宽度等于窗口的宽度，以下对我有用：

```
gint width = 650;
gtk_widget_set_size_request (window, width, 550);
gtk_widget_set_size_request (treeview, width, -1);
for (gint i = 0; i < 6; i++) {
  gtk_tree_view_column_set_sizing (columns[i], GTK_TREE_VIEW_COLUMN_FIXED);
  gtk_tree_view_column_set_fixed_width (columns[i], width / 6);
} 
```

如果您调整窗口大小，您将不得不再次计算大小，因此您需要使用信号捕获窗口的大小调整事件。

gtk_widget_get_preferred_size() 没有为我返回确切的宽度，只是一个近似值。

# javascript - 匹配两个电子表格中的值，如果相同，则从 1 复制单元格并粘贴到 2nd

> ID：14044856
> 
> 赞同：0
> 
> 时间：2012-12-26T18:52:25.337
> 
> 标签：javascript, google-apps-script, google-sheets

我使用[费用报告教程](https://developers.google.com/apps-script/articles/expense_report_approval)来生成我的大部分代码。

我更改的主要内容是费用报告 ID 不是行号，而是我将其设置为随机数 (ll-nnnn)。我想使用报表 ID 作为费用报表表和费用审批表之间的标识符，所以我在报表表中添加了一个报表 ID 列。我希望脚本从批准表单中获取报告 ID，并在报告表 ID 列中搜索具有该 ID 的行，然后输入它是被批准还是被拒绝，以及经理在相应行中的任何评论M 和 N 列。在 VBA 中，我将使用的代码是带有匹配条件的 if 语句。我是 java 脚本的新手，所以我不知道该怎么做。***我已经使用 fooby 提供的内容编辑了我的代码。当我运行它时，我收到错误“范围的坐标或尺寸无效”。上线：“ poSheet.getRange(rowToUpdate, 2, 1, 13).setValues(updateInfo);” 任何建议将不胜感激！

```
 var PO_SPREADSHEET_ID= "0At0Io3p64FeddFVCV2lJdEpLY09MYWNkVS05NDhzWkE";
    var ss = SpreadsheetApp.getActiveSpreadsheet();
    var sheet = ss.getSheets()[0];
    var poSs = SpreadsheetApp.openById(PO_SPREADSHEET_ID);
    var poSheet = poSs.getSheets()[0];

    function updatePOSheet() {
    // Get IDs from Approval Sheet
    var row = sheet.getRange(2, 1, sheet.getLastRow()-1,sheet.getLastColumn()).getValues();
    // Get IDs from Report Sheet, flatten it into a 1D array
    var poId = poSheet.getRange(2,1,poSheet.getLastRow()-1,1).getValues().reduce(flatten_);
   // For each row in the Approval Sheet update the coresponding report row
   // reportIds is passed a "this" in the forEach function, see below
      row.forEach(updateReportRow_,poId);

      }

   // Checks to see if the status of a row is either "Approved" or "Denied
  // then updated the correct row in the reports sheet with manager's comments
     function updateReportRow_(row) {
     var id = row[2];
     var status = row[3];
     var comments = row[4];

  // Get row in reports sheet from reportIds (it was passed as 'this')
     var rowToUpdate = this.indexOf(id) + 1; 

  // Put info into spreadsheet friendly array
     var updateInfo = [[status,comments]];

     if (status == "Approved" || status == "Denied") {
     poSheet.getRange(rowToUpdate, 2, 1, 13).setValues(updateInfo);
       }
     }

  // Returns a piece of an array concatenated with the element on to it's right
  // will make [[0],[1],[2]...]] into [0,1,2,...]
  function flatten_(a,b) {
  return a.concat(b);
  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T17:17:35.870

我一直在使用这种技术，在这里我试着解释一下，但效果并不好。因此，我尽我所能整理了一份演示表，说明如何实现自己的愿望。在我开始之前，这里是该方法的一般要点和未注释的代码。

1.  使用`onFormSubmit()`触发器。
2.  从目标工作表中获取 Ids 列。
3.  将生成的二维数组展平为一维数组以便于搜索 (indexOf)
    *   我使用了 JS 迭代函数`reduce()`和一个名为`flatten_(a,b)`
    *   [您可以在MDN](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array#Iteration_methods)找到更多详细信息。
4.  组织来自事件的信息。
5.  更新目标工作表中的相应行。

关于演示表的一些注意事项：

*   它们是可编辑的；所以，请尝试一下，但要友善。
*   报告表（目标表）有一些硬编码值。OP 正在用我没有构建的表格填写此内容。
*   审批表不智能，你必须写一个现有的ID。最终，需要一个定制的 GUI 才能使这变得非常流畅。
*   您可以在此处找到电子表格[报告表](https://docs.google.com/spreadsheet/ccc?key=0Amf6KahEwgTbdG5vMHFMVkQyaTFRZnNpdy1vQXBxbnc#gid=1)| [审批表](https://docs.google.com/spreadsheet/ccc?key=0Amf6KahEwgTbdEplcDNsMXhkc1R5VXpoeGNpR1ozTkE#gid=1)

这是未注释的代码：

```
function updateReportRow(approvalInfo) {
  var id = approvalInfo.namedValues.ID;
  var status = approvalInfo.namedValues.Status;
  var comments = approvalInfo.namedValues.Comments;
  var reportSheet = SpreadsheetApp.openById("SheetID").getSheetByName("Report Sheet");
  var reportIds = reportSheet.getRange(1,1,reportSheet.getLastRow(),1).getValues().reduce(flatten_);
  var rowToUpdate = reportIds.indexOf(id.toString())+1;
  if (rowToUpdate < 2) {
    // Something went wrong...email someone!
  } else {
    if (status == "Approved") {
      var updateInfo = [[status,comments,"STATE_APPROVED"]];
      reportSheet.getRange(rowToUpdate, 5, 1, updateInfo[0].length).setValues(updateInfo);
    } else if (status == "Denied") {
      var updateInfo = [[status,comments,"STATE_DENIED"]];
      reportSheet.getRange(rowToUpdate, 5, 1, updateInfo[0].length).setValues(updateInfo);
    }
  }
}

function flatten_(a,b) {
  return a.concat(b);
} 
```

# c++ - 尝试使用 operator[] 访问 std::map 元素时出现编译器错误

> ID：14044862
> 
> 赞同：2
> 
> 时间：2012-12-26T18:53:17.357
> 
> 标签：c++, data-structures, map, compiler-errors, typedef

我正在尝试按键访问地图数据结构的元素，但出现编译器错误。我已经使用 typedefs 定义了我的地图数据结构，以简化地图实例化的语法。如您所见，键是类型`string`，数据是自定义`GameComponent`对象：

```
typedef map<string, GameComponent*> ComponentMap;
typedef map<string, GameComponent*>::iterator ComponentMapIter;
typedef map<string, GameComponent*>::const_iterator ComponentMapCIter; 
```

在 的派生类中`GameComponent`，我正在为存储在我的地图中的每个唯一 GameComponent 对象创建标准复合模式方法以及访问器。但是，使用数组下标运算符访问访问器中的对象会导致编译器错误：

```
void Character::add(const string& key, GameComponent* comp)
{
    m_components->insert( make_pair(key, comp) );
}

void Character::remove(const string& key)
{
    m_components->erase(key);
}

Armor* Character::getArmor() const
{
    // ERROR:
    return static_cast<Armor*>(m_components["Armor"]);
}

Weapon* Character::getWeapon() const
{
    // ERROR:
    return static_cast<Weapon*>(m_components["Weapon"]);
}

Attributes* Character::getAttributes() const
{
    // ERROR:
    return static_cast<Attributes*>(m_components["Attributes"]);
} 
```

编译器错误的输出显示“无效类型”错误，这让我摸不着头脑：

```
/Users/Dylan/Desktop/RPG/character.cpp: In member function 'Armor* Character::getArmor() const':
/Users/Dylan/Desktop/RPG/character.cpp:66: error: invalid types 'ComponentMap* const[const char [6]]' for array subscript
/Users/Dylan/Desktop/RPG/character.cpp: In member function 'Weapon* Character::getWeapon() const':
/Users/Dylan/Desktop/RPG/character.cpp:71: error: invalid types 'ComponentMap* const[const char [7]]' for array subscript
/Users/Dylan/Desktop/RPG/character.cpp: In member function 'Attributes* Character::getAttributes() const':
/Users/Dylan/Desktop/RPG/character.cpp:76: error: invalid types 'ComponentMap* const[const char [11]]' for array subscript 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-26T18:55:31.937

由于`operator[]`在 a `std::map`is not`const`中，您不能在`const`方法中使用它（当然是在成员上）。

在 C++11 之前使用`at`(C++11) 或`find`& 迭代器。

相关：[为什么 std::map 没有 const 访问器？](https://stackoverflow.com/questions/13902742/why-does-stdmap-not-have-a-const-accessor)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-26T19:04:17.470

似乎`m_components`是 type `ComponentMap*`。当您编写`m_components["Armor"]`编译器时，编译器会将其解释为对 s`"Armor"`的动态数组的第 - 个元素的访问`ComponentMap`，这没有任何意义。

你想要的是`(*m_components)["some string"]`. 这将调用`operator[]`of `ComponentMap`，但正如 Luchian Grigore 和 Olaf Dietsche 所提到的，`std::map::operator[]`没有 const 重载，所以这也会失败。剩下的唯一选择是使用`find`.

简化版将是：

```
Armor* Character::getArmor() const
{
    return static_cast<Armor*>(m_components->find("Armor")->second);
}

Weapon* Character::getWeapon() const
{
    return static_cast<Weapon*>(m_components->find("Weapon")->second);
}

Attributes* Character::getAttributes() const
{
    return static_cast<Attributes*>(m_components->find("Attributes")->second);
} 
```

此代码与原始示例的行为不同，如果`m_components`没有`"Armor"`,`"Weapon"`和`"Attributes"`元素，则会失败。我们能得到的最接近的是显式处理元素的缺失并返回`0`，或者`nullptr`如果您使用 C++11。

最终正确的 C++03 兼容版本：

```
Armor* Character::getArmor() const
{
    ComponentMapCIter i = m_components->find("Armor");
    if (i != m_components->end())
        return static_cast<Armor*>(i->second);
    return 0;
}

Weapon* Character::getWeapon() const
{
    ComponentMapCIter i = m_components->find("Weapon");
    if (i != m_components->end())
        return static_cast<Weapon*>(i->second);
    return 0;
}

Attributes* Character::getAttributes() const
{
    ComponentMapCIter i = m_components->find("Attributes");
    if (i != m_components->end())
        return static_cast<Attributes*>(i->second);
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-26T18:56:03.153

`getArmor()`,`getWeapon()`和`getAttributes()`已定义`const`，但[`m_components[]`](http://en.cppreference.com/w/cpp/container/map/operator_at) 可能会修改`m_components`. 所以你要么不定义你的方法`const`，要么[`std::map::find`](http://en.cppreference.com/w/cpp/container/map/find)改用它。

```
Armor* Character::getArmor() const
{
    auto i = m_components->find("Armor");
    if (i != m_components->end())
        return static_cast<Armor*>(i->second);

    return nullptr;
} 
```

# javascript - 不同设备的身体居中

> ID：14044866
> 
> 赞同：0
> 
> 时间：2012-12-26T18:53:44.860
> 
> 标签：javascript, jquery, html, css

我正在尝试使具有不同屏幕尺寸的所有设备以身体为中心

白色背景部分应居中

[http://jsfiddle.net/ymnkg/1/](http://jsfiddle.net/ymnkg/1/)

[http://jsfiddle.net/ymnkg/1/embedded/result/](http://jsfiddle.net/ymnkg/1/embedded/result/)

在下面提供我的代码

```
<body class="home">

    <div id="redColor">
        <header style="background-color: white; width: 1224px; margin-left: 339px;">
            <div class="inner clearfix"><div class="logo">
              <a href="">          
                  <img alt="Splitwise" class="defieLogo" src="http://www.defie.co/designerImages/defie_logo.png">
              </a>
            </div>

        </header>
        <div id="banner" class="clearfix" style="border-bottom: 5px solid #C3C3C3; width: 1223px;">
            <div class="bx-wrapper" style="width:1227px; position:relative; margin-top: 0px;">
                <div class="bx-window" style="position:relative; overflow:hidden; width:1227px;">
                    <ul id="slider1" style="width: 999999px; position: relative; left: -1227px;">
                        <li style="width: 1227px; float: left; list-style: none;" class="pager">
                                <a href=""><img src="http://www.defie.co/designerImages/frontpage_rotate1.png" alt="banner 1" border="0"></a>
                            </li>
                            <li style="width: 1227px; float: left; list-style: none;" class="pager">
                                <a href=""><img src="http://www.defie.co/designerImages/frontpage_rotate2.png" alt="banner 2" border="0"></a>
                            </li>
                            <li style="width: 1227px; float: left; list-style: none;" class="pager">
                                <a href=""><img src="http://www.defie.co/designerImages/frontpage_rotate3.png" alt="banner 3" border="0"></a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>
        <section id="main" style="background-color: #646464; padding: 0px;">
            <div class="inner clearfix" style="background-color: white; width: 1223px;">
                <span style="color: #06546a; font-weight: bold; font-size: 14px; background-color: white;">Defie Cloud Buisness Solution offers features and functionality for business - today and tomorrow</span>
                <div id="primary">
                    <section class="primary">
                        <ul style="width: 800px;">
                            <li style="padding-bottom: 5px; list-style: none; font-size: 13px;">
                                <img alt="squareList" style="margin-right: 10px;" id="logo" src="http://www.defie.co/designerImages/square_list.png">
                                    <span style="color: red;">Accounting and Finance:</span> Sales and Customer Management
                            </li>
                            <li style="padding-bottom: 5px; list-style: none; font-size: 13px;">
                                <img alt="squareList" style="margin-right: 10px;" id="logo" src="http://www.defie.co/designerImages/square_list.png">
                                    <span style="color: red;">Buisness Operation Package:</span> Purchasing and Vendor Management, Inventory Management, Build of Materials, Real-Time Production, Product Life Cycle, QA Management
                            </li>
                            <li style="padding-bottom: 5px; list-style: none; font-size: 13px;">
                                <img alt="squareList" style="margin-right: 10px;" id="logo" src="http://www.defie.co/designerImages/square_list.png"><span style="color: red;">Customer Relationship Management</span>
                            </li>
                            <li style="padding-bottom: 5px; list-style: none; font-size: 13px;">
                                <img alt="squareList" style="margin-right: 10px;" id="logo" src="http://www.defie.co/designerImages/square_list.png">
                                <span style="color: red;">Cloud File and Document Apps:</span> Store, Manage, Share, Access and Modify anytime, anywhere on any devices
                            </li>
                            <li style="padding-bottom: 5px; list-style: none;">
                                <img alt="squareList" style="margin-right: 10px; font-size: 13px;" id="logo" src="http://www.defie.co/designerImages/square_list.png">
                                <span style="color: red;">Cloud Buisness Management:</span> From Front to Back Office, z from Hardware to Software, from Desktops to Servers Solution and Support
                            </li>
                        </ul>
                    </section>
                </div>

            </div>
        </section>
        <ul id="eM" style="width: 1228px; margin-left: 80px; background-color:#646464;">
            <li id="eMli"><a id="eMlia" href="#home">Product</a></li>
            <li id="eMli"><a id="eMlia" href="#news">Solutions</a></li>
            <li id="eMli"><a id="eMlia" href="#contact">Solutions</a></li>
            <li id="eMli"><a id="eMlia" href="#about">Partners</a></li>
            <li id="eMli"><a id="eMlia" href="#news">About</a></li>
            <li id="eMli"><a id="eMlia" href="#contact">Home</a></li>
            <li id="eMli"><a id="eMlia" href="#about">Login</a></li>
        </ul>
    </div>

</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T18:57:25.050

您可以使用百分比而不是像素。或者您可以使用在这方面大放异彩的[Repsonsive Booststrap 。](http://twitter.github.com/bootstrap/scaffolding.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T19:14:07.950

> i am trying to make the body centered for all devices with different screen sizes

All devices have different resulotions. So dont use pixels, use percentages. So that it will acquire only the available width.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T19:30:22.330

你可以使用这样的东西：

```
.home{
    width: 85%; //Give a width so you can see it is centered
    margin: 0 auto; //This is for centering the page
    overflow-x: hidden;
} 
```

您可以编写[css 媒体查询](http://css-tricks.com/css-media-queries/)以使其在小屏幕上看起来不错。

# c# - 只想查找 X 过去几天的文件

> ID：14044867
> 
> 赞同：2
> 
> 时间：2012-12-26T18:53:54.453
> 
> 标签：c#, winforms

我想搜索目录并查找最近 x 天的文件，目前我的函数返回所有时间相同的文件（谁在 2 天前创建），即使我搜索超过 2 天。

```
decimal days = nudDays.Value; 
//read the number from NumericUpDown comtrol

private void setDays() 
//each change in NumericUpDown comtrol will change days variable
{
    if (nudDays.Value != 0)
    {
        days = nudDays.Value;    
    }
    else
    {
        days = decimal.MaxValue;
    }            
} 
```

检查我的文件是否在过去 x 天创建（天变量）：

```
public bool checkFileCreationDate(FileInfo fileInfo)
{
    double num = (double)nudDays.Value * -1;
    if (fileInfo.CreationTime > DateTime.Now.AddDays(num))
    {
        return true;
    }

    return false;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T19:07:20.300

这可以使用您要查找的日期值中的 linq 传递来完成

```
Date somedate;
var filterFiles = from file in directoryInfo.GetFiles() 
            where file.CreationTime > somedate
            select file; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-26T19:24:10.590

基于此声明：

> 目前，即使我搜索超过 2 天，我的函数也会始终返回相同的文件（2 天前创建的文件）。

我相信你想要做的是改变这一行：

```
if (fileInfo.CreationTime > DateTime.Now.AddDays(num)) 
```

对此：

```
if (fileInfo.CreationTime == DateTime.Now.AddDays(num)) 
```

但是，我不得不承认，您要寻找的*确切内容还不是很清楚，所以我希望我的解释正确。*

## 更新

如果您想要在过去`n`几天内创建的所有文件（即如果`n`是 6，那么它将返回 1-6 天前的任何文件），然后使用这个：

```
public bool checkFileCreationDate(FileInfo fileInfo)
{
    double num = (double)nudDays.Value;
    if (DateTime.Now.Subtract(fileInfo.CreationTime).TotalDays <= num)
    {
        return true;
    }

    return false;
} 
```

如果您想要所有`n`天前的文件（即，如果`n`是 6，那么它将返回正好 6 天前的任何文件），然后使用这个：

```
public bool checkFileCreationDate(FileInfo fileInfo)
{
    double num = (double)nudDays.Value;
    if (DateTime.Now.Subtract(fileInfo.CreationTime).TotalDays == num)
    {
        return true;
    }

    return false;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T19:08:23.050

如果您的时间范围超过两天，则两天前创建的文件将被包括在内。没关系，因为“四天”实际上转化为间隔 [now-4d .. now]

要排除您的测试文件，您必须将天数减少到一。

请注意，fileInfo.CreationTime 和 fileInfo.LastWriteTime 在许多情况下是不同的。您可能想要过滤 LastWriteTime。

# php - php Composer windows安装奇怪的目录错误

> ID：14044895
> 
> 赞同：4
> 
> 时间：2012-12-26T18:55:42.540
> 
> 标签：php, windows, directory, installation, composer-php

好的，我是 Windows 的一个非常大的菜鸟，今天我想第一次安装 Composer，当我为 php.exe 选择我的 php 路径时遇到了奇怪的目录错误

![在此处输入图像描述](../Images/c0d4f55b8c831ed0a0bb917fd20d8c40.png)

![在此处输入图像描述](../Images/9d7d002853f29851695dcfec98206868.png)

![在此处输入图像描述](../Images/d8c4f57a3973eefb7319d64b0b81c719.png)

并且它继续进行，还有更多 8 个其他扩展。

所以我正在运行`easyphp`，正确选择了php exe文件夹，从`C:\EasyPHP\php\php546x121016161819\php.exe`安装easyphp的位置选择

我在谷歌上搜索硬核，但找不到任何解决这个问题的方法，所以如果有人能帮我解决这个问题或给我一个提示，那就太棒了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T08:02:48.813

找到了解决方案，这不是一个错字，easyphp 自行安装并带有默认错误，我不得不做出一些变通方法才能使其正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T19:04:50.020

看起来你的路径中有错字。如果您的 php 文件夹是 C:\EasyPHP\php\php546x121016161819\，则您的路径不应指向 c:\Program Files\Broadcom\Broadcom 802.11\Driver\php\php546...

它应该是 ...c:\Program Files\Broadcom\Broadcom\802.11\Driver **\;c:** \php\php546...

# asp.net - Delphi 2007 - ASP.net - 窗口已注册为放置目标/未能找到事件

> ID：14044896
> 
> 赞同：1
> 
> 时间：2012-12-26T18:55:50.677
> 
> 标签：asp.net, delphi, windows-7, delphi-2007, delphi.net

我有一个需要在 Delphi 2007 中维护的大型 ASP.net 项目。当我打开任何 ASP.net 项目（包括 Hello World 项目）时，我立即收到一条错误消息，提示“此窗口已注册为放置目标."。在 IDE 中打开项目后，我会立即收到此消息。当我尝试访问对象事件（例如按钮的单击事件）时，我收到一条错误消息，提示“找不到事件”。

我有一台完全打补丁的 Windows 7 专业版（32 位）机器。我在家里使用完全修补过的 XP Proffesional (SP3) 机器时遇到了同样的问题。我们有几个开发人员都有同样的问题。

有没有其他人看到这个问题或知道任何故障排除步骤？Windows 事件日志中没有显示任何感兴趣的内容。我注意到的另一件事是，我无法再更改按钮文本或大小......当我在设计模式下进行更改时，不会对基础 .aspx 文件进行更改。错误详细信息有点冗长，如下所示：

放置目标错误详情：

```
[2004474C]{rtl100.bpl} ComObj.OleError（第 1269 行，“common\ComObj.pas”+ 1）+ 11 美元
[2004475B]{rtl100.bpl} ComObj.OleCheck（第 1276 行，“common\ComObj.pas”+ 0）+ 7 美元
[070A5945]{htmide100.bpl} HTMLBaseFrame.EnableMultipleSelection（第 740 行，“HTMLBaseFrame.pas”+ 1）+ $2A
[070A5B1A]{htmide100.bpl} HTMLBaseFrame.THTMLBaseFrameWindow.InitializeDocumentEditingOptions（第 791 行，“HTMLBaseFrame.pas”+ 32）+ 1 美元
[07A7ADD6]{dotnetaspide100.bpl} ASPEditorFrm.TASPEditorFrame.InitializeViewLinkDocumentEditingOptions（第 1821 行，“ASPEditorFrm.pas”+ 1）+ 18 美元
[07A7AD1E]{dotnetaspide100.bpl} ASPEditorFrm.TASPEditorFrame.InitializeViewLinkDocumentsEditingOptions（第 1806 行，“ASPEditorFrm.pas”+ 8）+ 8 美元
[07A7AC96]{dotnetaspide100.bpl} ASPEditorFrm.TASPEditorFrame.InitializeLoadedDocumentEditingOptions（第 1789 行，“ASPEditorFrm.pas”+ 4）+ 9 美元
[070A5C4D]{htmide100.bpl} HTMLBaseFrame.THTMLBaseFrameWindow.WebBrowserEx1DocumentComplete（第 857 行，“HTMLBaseFrame.pas”+ 46）+ 4 美元
[07A7C9C9]{dotnetaspide100.bpl} ASPEditorFrm.TASPEditorFrame.WebBrowserEx1DocumentComplete（第 2518 行，“ASPEditorFrm.pas”+ 15）+ $B
[201CC182]{vcl100.bpl}OleCtrls.TOleControl.InvokeEvent（第 1612 行，“OleCtrls.pas”+ 46）+ $0
[4080756A]{vcliex100.bpl} WebBrowserEx.TWebBrowserEx.InvokeEvent（第 2583 行，“WebBrowserEx.pas”+ 1）+ 4 美元
[201C9D6B]{vcl100.bpl}OleCtrls.TEventDispatch.Invoke（第 471 行，“OleCtrls.pas”+ 3）+ $9
[201625E8]{vcl100.bpl } Forms.TApplication.ProcessMessage（第 8103 行，“Forms.pas”+ 21）+ 1 美元
[2016262A]{vcl100.bpl} Forms.TApplication.HandleMessage（第 8124 行，“Forms.pas”+ 1）+ 4 美元
[2016291F]{vcl100.bpl } Forms.TApplication.Run（第 8223 行，“Forms.pas”+ 20）+ 3 美元
[0042297A]{bds.exe } bds.bds（第 195 行，“”+ 7）+ 7 美元

```

///////////////

找不到活动详情：

```
[21E2C06F]{dotnetcoreide100.bpl} DotNetPropInsp.TDotNetProperty.Edit（第 891 行，“DotNetPropInsp.pas”+ 1）+ 39 美元
[2000A455]{rtl100.bpl} System.@CheckAutoResult（第 18047 行，“sys\system.pas”+ 6）+ $0
[21E2C06F]{dotnetcoreide100.bpl} DotNetPropInsp.TDotNetProperty.Edit（第 891 行，“DotNetPropInsp.pas”+ 1）+ 39 美元
[20AB55BC]{coreide100.bpl} PropInsp.TPropertyInspector.PropListEditDblClick（第 853 行，“PropInsp.pas”+ 18）+ $1C
[20E0ED7D]{vclide100.bpl} IDEInspListBox.TInspListBox.DoEditDblClick（第 967 行，“ideinsplistbox.pas”+ 2）+ $A
[20E10602]{vclide100.bpl} IDEInspListBox.TInspListBox.EditDblClick（第 1538 行，“ideinsplistbox.pas”+ 0）+ $2
[2013CA49]{vcl100.bpl} Controls.TControl.DblClick（第 5234 行，“Controls.pas”+ 1）+ 14 美元
[2013CBAC]{vcl100.bpl} Controls.TControl.WMLButtonDblClk（第 5275 行，“Controls.pas”+ 4）+ $C
[2013C527]{vcl100.bpl} Controls.TControl.WndProc（第 5146 行，“Controls.pas”+ 83）+ 6 美元
[2132827C]{vclactnband100.bpl} ActnMenus.CallWndHook（第 703 行，“ActnMenus.pas”+ 12）+ $F
[201406A7]{vcl100.bpl} Controls.TWinControl.WndProc（第 7304 行，“Controls.pas”+ 111）+ 6 美元
[2003203C]{rtl100.bpl} Classes.TThreadList.UnlockList（第 3359 行，“common\Classes.pas”+ 0）+ $4
[200EBAA8]{vcl100.bpl} Graphics.FreeMemoryContexts（第 5060 行，“Graphics.pas”+ 12）+ 5 美元
(0002E348){CnWizards_D11.dll} [080EF348]
[20140158]{vcl100.bpl}Controls.TWinControl.IsControlMouseMsg（第 7176 行，“Controls.pas”+ 9）+ 25 美元
[201406A7]{vcl100.bpl} Controls.TWinControl.WndProc（第 7304 行，“Controls.pas”+ 111）+ 6 美元
[20E0DF4B]{vclide100.bpl} IDEInspListBox.TPropInspEdit.WndProc（第 430 行，“ideinsplistbox.pas”+ 7）+ 4 美元
[2013FDD0]{vcl100.bpl} Controls.TWinControl.MainWndProc（第 7073 行，“Controls.pas”+ 3）+ 6 美元
[20040E4C]{rtl100.bpl} Classes.StdWndProc（第 11583 行，“common\Classes.pas”+ 8）+ $0
[20163691]{vcl100.bpl}Forms.TApplication.StopHintTimer（第 8673 行，“Forms.pas”+ 3）+ 6 美元
[201625E8]{vcl100.bpl } Forms.TApplication.ProcessMessage（第 8103 行，“Forms.pas”+ 21）+ 1 美元
[2016262A]{vcl100.bpl} Forms.TApplication.HandleMessage（第 8124 行，“Forms.pas”+ 1）+ 4 美元
[2016291F]{vcl100.bpl } Forms.TApplication.Run（第 8223 行，“Forms.pas”+ 20）+ 3 美元
[0042297A]{bds.exe } bds.bds（第 195 行，“”+ 7）+ 7 美元

```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-07-02T21:25:36.157

就我而言，当我没有在我的配置文件中配置我的 ldap 服务器时，我遇到了这个问题。

向我添加正确的 ldap 服务器为我`AppSettings.config`解决了这个问题。

# javascript - Javascript 相当于 Python 的 urlparse.parse_qs()？

> ID：14044897
> 
> 赞同：2
> 
> 时间：2012-12-26T18:55:54.817
> 
> 标签：javascript, python, urlencode, netsuite, urlparse

我正在使用 python 生成一个查询字符串，然后由 javascript 解析。

考虑一个相当“复杂”的数据：

```
import urllib

params = {
         'record': 'customer',
         'filters': [
                 ('id', '>', 5),
                 ('name', 'startswith', 'Jean Luc')
         ]
}

urllib.urlencode(params)
'record=customer&filters=%5B%28%27id%27%2C+%27%3E%27%2C+5%29%2C+%28%27name%27%2C+%27startswith%27%2C+%27Jean+Luc%27%29%5D'

urllib.unquote(urllib.urlencode(params))
"record=customer&filters=[('id',+'>',+5),+('name',+'startswith',+'Jean+Luc')]" 
```

在 python 中，我可以使用`urlparse.parse_qs()`该 url 编码的查询字符串并重建 Python 结构。

是否有 Javascript 的等价物？是否有人编写了一个知道如何解析此类查询字符串的库？

顺便说一句，这个 Javascript 不是在浏览器中运行的——它是一个名为“Netsuite”的包中的内部脚本功能——所以使用外部 javascript 库有点困难（尽管如果需要的话，最终还是可行的。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T19:00:43.190

[jQuery.deparam](http://benalman.com/code/projects/jquery-bbq/examples/deparam/)可能是您正在寻找的。如果您不能在 Netsuite 中使用 jQuery，应该很容易查看他的源代码并弄清楚如何做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-05T06:25:59.707

Netsuite 端最好使用 XML 或[JSON形式的数据。](http://www.json.org/)

和 Netsuite 脚本在这里是纯 javascript，不支持 JQuery，但可以使用 JSON.Parse 将 JSON 和 XML 数据解析回对象，您可以继续使用那里的数据。

干杯！！！

# git - 在一个 git 存储库中维护多个相关项目的最佳方法？

> ID：14044902
> 
> 赞同：2
> 
> 时间：2012-12-26T18:56:17.303
> 
> 标签：git, version-control, repository, multi-project

作为个人项目的一部分，我已经开始使用 git 而不是 subversion，也许我正在从中学到一些新东西。

设置存储库相当容易，配置我的 Web 服务器以提供 git 文件就像一个魅力；提交，克隆，这里没问题。

但是，我在存储库中的项目设置存在一些问题。目前它看起来像这样：

```
project.git
\- mobileapp
\- artwork
\- backend
\- website 
```

`website`并且`mobileapp`应该在`backend`一切正常后进行通信。

我现在的问题是部署：当我想`backend`在我的服务器上部署时，目前我需要检查整个存储库并将内容复制`backend`到我的 webroot 目录。

由于似乎没有办法只检查 的内容`project.git/backend`，我正在考虑将四个子项目分成四个 git 存储库，并增加维护四个存储库的开销。

有没有更简单的方法来解决我的问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T19:04:48.410

您是对的，没有特别简单的方法可以签出部分 Git 存储库。（从 1.7.0 开始，Git 支持[稀疏检出](http://schacon.github.com/git/git-read-tree.html#_sparse_checkout)，但这可能无法满足您的需求。）

典型的建议是将每个逻辑上独立的模块放入单独的存储库中。管理这些模块之间的关系有些困难。

一种方法是使用[Git 子模块](http://git-scm.com/book/en/Git-Tools-Submodules)。这会在父 Git 存储库中添加元数据，该存储库教 Git 如何签出子存储库的适当版本。然后，您通过进行会影响元数据的单个提交来管理关系。

另一种是使用外部工具，如 Android 的[repo](http://source.android.com/source/version-control.html)工具。Repo 也针对多个子存储库维护自己的状态，但与非常关注修订的子模块不同，它`repo`更关注分支。

这两种方法都是可行的，并且在如何考虑模块之间的关系方面表现出哲学上的差异。当然，这不一定是解决问题的“更简单”的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T18:59:43.267

使用`submodule`：

```
$ git submodule -h 
```

例如

```
$ git submodule add git@github.com:<username>/backend.git backend 
```

然后您也可以将`backend`其视为一个单独的项目。

# php - HTML 响应标头在 firefox/chrome 中为空，但在 IE 中有效

> ID：14044920
> 
> 赞同：0
> 
> 时间：2012-12-26T18:57:39.850
> 
> 标签：php, javascript, jquery, html, response

我使用了一个简单的脚本从 PHP 页面获取响应，但响应头在 Firefox 和 chrome 中为空，但在 IE 中没有。我的脚本片段是：

```
var request = makeHttpObject();
request.open("GET", url, true); 
request.withCredentials = "true"; 
request.send(); 
if (request.status == 200 && request.readyState == 4)
   {
     alert(request.getAllResponseHeader());
   } 
```

当我在调试的“网络”选项卡下检查 HTTP 对象中的响应标头时，我可以看到所有内容。

谁能告诉我的脚本中缺少什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T19:02:14.520

[`getAllResponseHeaders`](http://msdn.microsoft.com/en-us/library/ie/ms536428%28v=vs.85%29.aspx)特定于 IE。要获取特定的响应标头，请`getResponseHeader`改用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T19:45:29.760

您使用的进程特定于 Internet Explorer。尝试将 jquery 用于其他一些 Ajax 库，它适用于大多数浏览器。

示例代码：

```
 $.ajax({
      url: 'ajax/test.php?id=sampleId',
      success: function(data) {
        $('.result').html(data);
        alert('Load was performed.');
        alert(data);
      }
    }); 
```

现在在 test.php 页面上，您可以编写服务器脚本。这将在大多数启用了 javascript 的浏览器上运行。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-12-26T19:03:46.973

我记得，对于普通的 HTTP 请求，您必须为每个浏览器创建一个。您仅使用一种方式，因此它不适用于所有浏览器，因为并非所有浏览器都理解该方式。也许你可以看看[JQuery](http://jquery.com/)。它简单、快速，适用于所有市长浏览器。

# linux - 从字符串中删除一个字符

> ID：14044921
> 
> 赞同：3
> 
> 时间：2012-12-26T18:57:54.067
> 
> 标签：linux, bash, sed, awk, cut

我只是想`%`从变量中删除一个符号，所以我可以对结果进行数学计算。我已经尝试了几件事，但它们似乎都不起作用：

```
$ output="23%"
# usep=$(echo $output | awk '{print $1}' | cut -d '%' -f 1)
# usep=`echo $output | sed 's/\%//g`
# usep=`echo $output | head -c 2` 
```

变量`usep`仍然包含`%`字符。有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-26T19:01:43.210

您可以使用 POSIX 参数替换：

```
$ output="23%"
$ usep=${output%%\%}
$ echo $usep
23 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-26T19:01:52.307

指定`output`为

```
output="23%" 
```

你错过了第二`'`个

```
usep=`echo $output | sed 's/%//g'` 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-26T19:01:52.553

不知道为什么使用的方法`cut`对你不起作用，但这里有一个对我来说非常有用：

```
#!/bin/bash

output="23%"
usep=`echo $output | cut -d '%' -f 1`
echo $usep 
```

# ruby-on-rails - Ruby on Rails 更改应用程序的时区

> ID：14044924
> 
> 赞同：1
> 
> 时间：2012-12-26T18:58:22.180
> 
> 标签：ruby-on-rails, ruby, activerecord, timezone, mongoid

我的应用程序在 UTC 时区运行了 6 个月以上。这意味着所有 ActiveRecord 和 MongoDB 对象都已在 UTC 时区创建。很好奇，如果我继续更改 application.rb 中的适用设置：

```
config.time_zone = 'Eastern Time (US & Canada)' 
```

这会将在 UTC 中创建的记录转换为 EST 时区吗？MongoDB 记录呢？（我使用 Mongoid 作为我的 Ruby 驱动程序）。是否像在 application.rb 中翻转开关一样简单，仅此而已？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T19:26:24.383

无论怎么`config.time_zone`说，ActiveRecord 都会以 UTC 存储所有内容；我很难找到关于此的权威参考，到目前为止我发现的最好的是[`ActiveRecord::Timestamp`](http://api.rubyonrails.org/classes/ActiveRecord/Timestamp.html)文档。[MongoDB 还应该将所有内容存储在 UTC 中](http://docs.mongodb.org/manual/core/document/#date)：

> **日期**
> 
> BSON Date 是一个 64 位整数，表示自 Unix 纪元（1970 年 1 月 1 日）以来的毫秒数。官方 BSON 规范将 BSON Date 类型称为 UTC *datetime*。

因此，您的数据库中的任何内容都不应更改或需要更改。该`config.time_zone`设置仅用于 Rails 方面，它与数据库中使用的时区无关，因此您不必担心。

# android - android 相机意图在某些手机上崩溃应用程序（约 20%）

> ID：14044925
> 
> 赞同：9
> 
> 时间：2012-12-26T18:58:26.660
> 
> 标签：android, android-camera, android-camera-intent

我对这个问题做了很多研究，看到了一些很好的反应，并找到了一些很好的资源来解决这个问题。然而不幸的是，我仍然在某些设备上遇到很多应用程序崩溃。崩溃发生在有人拍照后，相机意图应该将信息传递回调用活动。就我的应用程序而言，我只是用新拍摄的照片覆盖任何现有照片，因此我几乎可以使用文件位置的静态路径。这就是我所说的意图：

```
 Intent intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);
        // get the file path from an external class (necessary for galaxy nexus)
        imageFileAndPath = ImageServices.getOutputImageFileUri(cont);
        intent.putExtra(MediaStore.EXTRA_OUTPUT, imageFileAndPath);
        startActivityForResult(intent, CAMERA_REQUEST_CODE); 
```

imageFileAndPath 只是一个 URI 变量，我从一个单独的类中创建它，因为这解决了另一个问题，即按下“完成”或复选标记或在特定设备上关闭相机意图没有做任何事情几种设备类型。通过从一个单独的类创建 URI，它解决了一些未知原因的问题。

我的 onActivityResult 看起来像这样：

```
@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    if(resultCode == Activity.RESULT_OK)
    {
        if (requestCode == CAMERA_REQUEST_CODE) {
            setupImageView();
    imageView = (ImageView) findViewById(R.id.image_view);
            webView.setVisibility(View.GONE);
            imageView.setVisibility(View.VISIBLE);
            button.setVisibility(View.GONE);
            reTakePicButton.setVisibility(View.VISIBLE);
            rl.setVisibility(View.VISIBLE);    
        }
    }
} 
```

因为我不需要动态路径来保存我的照片（因为它会覆盖现有照片），所以我只需在我的活动中调用另一个方法来调整照片大小并相应地旋转它。该方法如下：

```
private void setupImageView() {     
    imageLocation = Environment.getExternalStorageDirectory().getAbsolutePath() + "/myappphoto/myappphoto.jpg";

    // Get the dimensions of the View
    Display display = getWindowManager().getDefaultDisplay();
    Point size = getDisplaySize(display);
    int targetW = size.x;

    // Get the dimensions of the bitmap
    BitmapFactory.Options bmOptions = new BitmapFactory.Options();
    bmOptions.inJustDecodeBounds = true;

    BitmapFactory.decodeFile(imageLocation, bmOptions);
    int photoW = bmOptions.outWidth;
    int photoH = bmOptions.outHeight;

    // Determine how much to scale down the image
    int scaleFactor = Math.min(photoW / targetW, photoH / targetW);

    // Decode the image file into a Bitmap sized to fill the View
    bmOptions.inJustDecodeBounds = false;
    bmOptions.inSampleSize = scaleFactor;
    bmOptions.inPurgeable = true;

    Bitmap bitmap = BitmapFactory.decodeFile(imageLocation, bmOptions);
    int rotationForImage = getRotationForImage(imageLocation);
    if (rotationForImage != 0) {
        int targetWidth = rotationForImage == 90 || rotationForImage == 270 ? bitmap.getHeight() : bitmap.getWidth();
        int targetHeight = rotationForImage == 90 || rotationForImage == 270 ? bitmap.getWidth() : bitmap.getHeight();

        Bitmap rotatedBitmap = Bitmap.createBitmap(targetWidth, targetHeight, bitmap.getConfig());
        Canvas canvas = new Canvas(rotatedBitmap);
        Matrix matrix = new Matrix();
        matrix.setRotate(rotationForImage, bitmap.getWidth() / 2, bitmap.getHeight() / 2);
        canvas.drawBitmap(bitmap, matrix, new Paint());

        bitmap.recycle();
        bitmap = rotatedBitmap;

    }

    Bitmap resized;

    if(bitmap.getWidth() >= 900 || bitmap.getHeight() >=900)
    {
        int newWidth = Math.round(bitmap.getWidth()/2);
        int newHeight = Math.round(bitmap.getHeight()/2);
        resized = Bitmap.createScaledBitmap(bitmap, newWidth, newHeight, true);
    }
    else
    {
        resized = bitmap;
    }
    //bitmap.recycle();
    bitmap = resized;

    ByteArrayOutputStream bytes = new ByteArrayOutputStream();
    bitmap.compress(Bitmap.CompressFormat.JPEG, 70, bytes);

    try
    {
        File f = new File(imageLocation);
        f.createNewFile();
        //write the bytes in file
        FileOutputStream fo = new FileOutputStream(f);
        fo.write(bytes.toByteArray());
        fo.close();
    }
    catch(java.io.IOException e){}
    imageView.setImageBitmap(bitmap);

} 
```

您可以在该方法的顶部看到从相机意图保存的图像文件的静态路径。

我想调整大小、旋转方法可能会导致崩溃，但我不明白为什么会这样，这对我来说都是非常标准的 java 编码。

任何人都可以看到我在这里所做的事情有什么明显的错误吗？正如我在这个线程的标题中所说，我的代码导致大约 20% 的运行它的设备崩溃，这是不可接受的。我可以处理 5% 但不能处理 20%。

我意识到 android 开发在这方面有点像一场噩梦，因为你必须考虑这么多不同的设备类型（制造商、android 版本等），但我认为相机活动应该比这更好地标准化。正如我在该线程顶部所说的那样，我已经对这个问题进行了很多研究，并且看到几个人遇到了与我类似的问题，但没有涵盖大多数设备的良好解决方案。我真的不想从零开始写（我也不认为我应该写）我自己的相机。Android设备上必须有一个更好的默认内置摄像头意图实现......我只是还没有找到它。如您所见，我什至不关心动态创建图像，这应该会使这个项目变得更容易。

TIA

编辑：根据下面的评论，我添加了来自故障相机的堆栈跟踪。它看起来像一个空指针异常。我拍了大约 6 张照片，然后继续使用调用相机意图的按钮返回，直到最终失败。这是堆栈跟踪：

```
STACK_TRACE
"java.lang.RuntimeException: Unable to resume activity {com.myapp/com.myapp.MyActivity}: java.lang.RuntimeException: Failure delivering result ResultInfo{who=null, request=904, result=-1, data=null} to activity {com.myapp/com.myapp.MyActivity}: java.lang.NullPointerException
    at android.app.ActivityThread.performResumeActivity(ActivityThread.java:2124)
    at android.app.ActivityThread.handleResumeActivity(ActivityThread.java:2139)
    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1672)
    at android.app.ActivityThread.handleRelaunchActivity(ActivityThread.java:2836)
    at android.app.ActivityThread.access$1600(ActivityThread.java:117)
    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:939)
    at android.os.Handler.dispatchMessage(Handler.java:99)
    at android.os.Looper.loop(Looper.java:130)
    at android.app.ActivityThread.main(ActivityThread.java:3687)
    at java.lang.reflect.Method.invokeNative(Native Method)
    at java.lang.reflect.Method.invoke(Method.java:507)
    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:842)
    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:600)
    at dalvik.system.NativeStart.main(Native Method)
Caused by: java.lang.RuntimeException: Failure delivering result ResultInfo{who=null, request=904, result=-1, data=null} to activity {com.myapp/com.myapp.MyActivity}: java.lang.NullPointerException
    at android.app.ActivityThread.deliverResults(ActivityThread.java:2536)
    at android.app.ActivityThread.performResumeActivity(ActivityThread.java:2111)
    ... 13 more
Caused by: java.lang.NullPointerException
    at com.myapp.MyActivity.onActivityResult(EnterContest.java:257)
    at android.app.Activity.dispatchActivityResult(Activity.java:3908)
    at android.app.ActivityThread.deliverResults(ActivityThread.java:2532)
    ... 14 more
java.lang.RuntimeException: Failure delivering result ResultInfo{who=null, request=904, result=-1, data=null} to activity {com.myapp/com.myapp.MyActivity}: java.lang.NullPointerException
    at android.app.ActivityThread.deliverResults(ActivityThread.java:2536)
    at android.app.ActivityThread.performResumeActivity(ActivityThread.java:2111)
    at android.app.ActivityThread.handleResumeActivity(ActivityThread.java:2139)
    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1672)
    at android.app.ActivityThread.handleRelaunchActivity(ActivityThread.java:2836)
    at android.app.ActivityThread.access$1600(ActivityThread.java:117)
    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:939)
    at android.os.Handler.dispatchMessage(Handler.java:99)
    at android.os.Looper.loop(Looper.java:130)
    at android.app.ActivityThread.main(ActivityThread.java:3687)
    at java.lang.reflect.Method.invokeNative(Native Method)
    at java.lang.reflect.Method.invoke(Method.java:507)
    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:842)
    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:600)
    at dalvik.system.NativeStart.main(Native Method)
Caused by: java.lang.NullPointerException
    at com.myapp.MyActivity.onActivityResult(EnterContest.java:257)
    at android.app.Activity.dispatchActivityResult(Activity.java:3908)
    at android.app.ActivityThread.deliverResults(ActivityThread.java:2532)
    ... 14 more
java.lang.NullPointerException
    at com.myapp.MyActivity.onActivityResult(EnterContest.java:257)
    at android.app.Activity.dispatchActivityResult(Activity.java:3908)
    at android.app.ActivityThread.deliverResults(ActivityThread.java:2532)
    at android.app.ActivityThread.performResumeActivity(ActivityThread.java:2111)
    at android.app.ActivityThread.handleResumeActivity(ActivityThread.java:2139)
    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1672)
    at android.app.ActivityThread.handleRelaunchActivity(ActivityThread.java:2836)
    at android.app.ActivityThread.access$1600(ActivityThread.java:117)
    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:939)
    at android.os.Handler.dispatchMessage(Handler.java:99)
    at android.os.Looper.loop(Looper.java:130)
    at android.app.ActivityThread.main(ActivityThread.java:3687)
    at java.lang.reflect.Method.invokeNative(Native Method)
    at java.lang.reflect.Method.invoke(Method.java:507)
    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:842)
    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:600)
    at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T15:46:22.757

也许是一个猜测，但我认为我遇到了同样的问题，我修复了它在新的 AsyncTask 中读取位图，而不是在 UI 线程中。

异常发生（显然以随机方式）调用

```
getContentResolver().notifyChange(selectedImage, null); 
```

其中 selectedImage 是之前设置的 URI

```
intent.putExtra(MediaStore.EXTRA_OUTPUT, Uri.fromFile(photo)); 
```

你在 com.myapp.MyActivity.onActivityResult(EnterContest.java:257) 中调用了什么？

我有一个用 ACRA 收集的堆栈跟踪：

```
java.lang.RuntimeException: Unable to resume activity {com.infonair.meetme.app/com.infonair.meetme.activity.photo.TakePhotoActivity}: java.lang.RuntimeException: Failure delivering result ResultInfo{who=null, request=7898789, result=-1, data=Intent { dat=content://media/external/images/media/9 }} to activity {com.infonair.meetme.app/com.infonair.meetme.activity.photo.TakePhotoActivity}: java.lang.NullPointerException
at android.app.ActivityThread.performResumeActivity(ActivityThread.java:2126)
at android.app.ActivityThread.handleResumeActivity(ActivityThread.java:2141)
at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1674)
at android.app.ActivityThread.handleRelaunchActivity(ActivityThread.java:2838)
at android.app.ActivityThread.access$1600(ActivityThread.java:117)
at android.app.ActivityThread$H.handleMessage(ActivityThread.java:935)
at android.os.Handler.dispatchMessage(Handler.java:99)
at android.os.Looper.loop(Looper.java:130)
at android.app.ActivityThread.main(ActivityThread.java:3737)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:507)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:894)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:652)
at dalvik.system.NativeStart.main(Native Method)
Caused by: java.lang.RuntimeException: Failure delivering result ResultInfo{who=null, request=7898789, result=-1, data=Intent { dat=content://media/external/images/media/9 }} to activity {com.infonair.meetme.app/com.infonair.meetme.activity.photo.TakePhotoActivity}: java.lang.NullPointerException
at android.app.ActivityThread.deliverResults(ActivityThread.java:2538)
at android.app.ActivityThread.performResumeActivity(ActivityThread.java:2113)
... 13 more
Caused by: java.lang.NullPointerException
at android.os.Parcel.readException(Parcel.java:1328)
at android.os.Parcel.readException(Parcel.java:1276)
at android.content.IContentService$Stub$Proxy.notifyChange(IContentService.java:458)
at android.content.ContentResolver.notifyChange(ContentResolver.java:912)
at android.content.ContentResolver.notifyChange(ContentResolver.java:898)
at com.infonair.meetme.activity.photo.TakePhotoActivity.onActivityResult(TakePhotoActivity.java:154)
at android.app.Activity.dispatchActivityResult(Activity.java:3908)
at android.app.ActivityThread.deliverResults(ActivityThread.java:2534)
... 14 more
java.lang.RuntimeException: Failure delivering result ResultInfo{who=null, request=7898789, result=-1, data=Intent { dat=content://media/external/images/media/9 }} to activity {com.infonair.meetme.app/com.infonair.meetme.activity.photo.TakePhotoActivity}: java.lang.NullPointerException
at android.app.ActivityThread.deliverResults(ActivityThread.java:2538)
at android.app.ActivityThread.performResumeActivity(ActivityThread.java:2113)
at android.app.ActivityThread.handleResumeActivity(ActivityThread.java:2141)
at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1674)
at android.app.ActivityThread.handleRelaunchActivity(ActivityThread.java:2838)
at android.app.ActivityThread.access$1600(ActivityThread.java:117)
at android.app.ActivityThread$H.handleMessage(ActivityThread.java:935)
at android.os.Handler.dispatchMessage(Handler.java:99)
at android.os.Looper.loop(Looper.java:130)
at android.app.ActivityThread.main(ActivityThread.java:3737)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:507)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:894)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:652)
at dalvik.system.NativeStart.main(Native Method)
Caused by: java.lang.NullPointerException
at android.os.Parcel.readException(Parcel.java:1328)
at android.os.Parcel.readException(Parcel.java:1276)
at android.content.IContentService$Stub$Proxy.notifyChange(IContentService.java:458)
at android.content.ContentResolver.notifyChange(ContentResolver.java:912)
at android.content.ContentResolver.notifyChange(ContentResolver.java:898)
at com.infonair.meetme.activity.photo.TakePhotoActivity.onActivityResult(TakePhotoActivity.java:154)
at android.app.Activity.dispatchActivityResult(Activity.java:3908)
at android.app.ActivityThread.deliverResults(ActivityThread.java:2534)
... 14 more
java.lang.NullPointerException
at android.os.Parcel.readException(Parcel.java:1328)
at android.os.Parcel.readException(Parcel.java:1276)
at android.content.IContentService$Stub$Proxy.notifyChange(IContentService.java:458)
at android.content.ContentResolver.notifyChange(ContentResolver.java:912)
at android.content.ContentResolver.notifyChange(ContentResolver.java:898)
at com.infonair.meetme.activity.photo.TakePhotoActivity.onActivityResult(TakePhotoActivity.java:154)
at android.app.Activity.dispatchActivityResult(Activity.java:3908)
at android.app.ActivityThread.deliverResults(ActivityThread.java:2534)
at android.app.ActivityThread.performResumeActivity(ActivityThread.java:2113)
at android.app.ActivityThread.handleResumeActivity(ActivityThread.java:2141)
at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1674)
at android.app.ActivityThread.handleRelaunchActivity(ActivityThread.java:2838)
at android.app.ActivityThread.access$1600(ActivityThread.java:117)
at android.app.ActivityThread$H.handleMessage(ActivityThread.java:935)
at android.os.Handler.dispatchMessage(Handler.java:99)
at android.os.Looper.loop(Looper.java:130)
at android.app.ActivityThread.main(ActivityThread.java:3737)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:507)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:894)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:652)
at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T11:21:17.723

为解决这个问题而苦苦挣扎，我注意到在某些设备中拍摄的照片太大，甚至无法在 ImageView 上显示（有一个警告说图像对于纹理来说太宽了），所以我开始着手将其调整为服务器的大小——可用尺寸。

我将发布整个代码（至少是关于拍摄和处理图片的代码）以防万一

这是调用意图的代码

```
 public void takePhoto() {

      String directoryPath = DCIM_PATH;
      this.pictureFileName = Long.toHexString(System.currentTimeMillis())+".jpg";
      String filePath = directoryPath + pictureFileName ;
      File directory = new File(directoryPath);

      if (!directory.exists()) {
          directory.mkdirs();
       }

       this.imageUri = Uri.parse(filePath);
       Intent intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);
       intent.putExtra( 
             MediaStore.EXTRA_OUTPUT,Uri.fromFile( new File(filePath) )
       );

       startActivityForResult(intent, TAKE_PICTURE);

 } 
```

在`onActivityResult`我调用一个方法来处理新拍摄的图片

```
 @Override
 public void onActivityResult(int requestCode, int resultCode, Intent data) {
        super.onActivityResult(requestCode, resultCode, data);
        switch (requestCode) {
            case TAKE_PICTURE:
               if (resultCode == Activity.RESULT_OK) {
                           loadImageJustTaken(imageUri);
               }
            break;
        }
 } 
```

**这是说的方法**

```
public void loadImageJustTaken(Uri selectedImage) {

        mActivity.getApplicationContext().getContentResolver().notifyChange(selectedImage, null);
        /*
         * process image to make its wide equals IMG_WIDTH constant, so that larger images will fit in ImageView
         */

         Bitmap b = BitmapHelper.decodeFileToScaledBitmap(new File(imageUri.getPath()), Tapabook.IMG_WIDTH);
        ivPicture.setImageBitmap(b);
        ivPicture.setVisibility(View.VISIBLE);
        System.gc(); 
 } 
```

**这是我** `BitmapHelper` **班级的代码**

```
public class BitmapHelper {

    private static final String LOGTAG = "BitmapHelper";

    public static File scaleBitmapFile(File f, int WIDTH) throws IOException{
            Log.d(LOGTAG, "scaleBitmapFile to WIDTH: " + WIDTH);

            Bitmap b2 = decodeFileToScaledBitmap( f, WIDTH);
            ByteArrayOutputStream outStream = new ByteArrayOutputStream();
            Log.d(LOGTAG, "scaleBitmapFile compress bitmap to jpg ");
            b2.compress(Bitmap.CompressFormat.JPEG,70 , outStream);

            File scaledBitmapFile = new File(Environment.getExternalStorageDirectory()
            + File.separator + "temp.jpg");
            Log.d(LOGTAG, "scaleBitmapFile file: temp.jpg" );
            scaledBitmapFile.createNewFile();
            Log.d(LOGTAG, "scaleBitmapFile file CREATED" );
            //write the bytes in file
            FileOutputStream fo = new FileOutputStream(scaledBitmapFile);
            fo.write(outStream.toByteArray());
            Log.d(LOGTAG, "scaleBitmapFile file WRITTEN" );
            // remember close de FileOutput
            fo.close();
            Log.d(LOGTAG, "scaleBitmapFile file CLOSED" );

            return scaledBitmapFile;
    }

    public static Bitmap decodeFileToScaledBitmap(File f, int WIDTH){
            Log.d(LOGTAG, "decodeFileToScaledBitmap to WIDTH: " + WIDTH);
            try{
                    //Decode image size
                    BitmapFactory.Options o = new BitmapFactory.Options();
                    o.inJustDecodeBounds = true;
                    BitmapFactory.decodeStream(new FileInputStream(f),null,o);

                    //The new size we want to scale to
                    final int REQUIRED_WIDTH=WIDTH;

                    final int ORIG_WIDTH  = o.outWidth;
                    final int ORIG_HEIGHT = o.outHeight;
                    Log.d(LOGTAG, "decodeFileToScaledBitmap original width: [" + ORIG_WIDTH + "] original height: [" + ORIG_HEIGHT+ "]");
                    final int REQUIRED_HEIGHT = ORIG_HEIGHT/( ORIG_WIDTH / REQUIRED_WIDTH ) ;

                    //Decode with scaled height
                    Log.d(LOGTAG, "decodeFileToScaledBitmap returning scaled bitmap ");
                    return Bitmap.createScaledBitmap(
                                    BitmapFactory.decodeFile(f.getAbsolutePath()), 
                                    REQUIRED_WIDTH, 
                                    REQUIRED_HEIGHT, 
                                    false);
            }catch (FileNotFoundException e) {
                    Log.e(LOGTAG, "decodeFileToScaledBitmap FileNotFoundException: " +e.getMessage());
            }
            return null;
    }

    public static Bitmap scaleBitmap(Bitmap b, int WIDTH){
            final int REQUIRED_WIDTH=WIDTH;

            final int ORIG_WIDTH  = b.getWidth();
            final int ORIG_HEIGHT = b.getHeight();
            Log.d(LOGTAG, "scaleBitmap original width: [" + ORIG_WIDTH + "] original height: [" + ORIG_HEIGHT+ "]");
            final int REQUIRED_HEIGHT = ORIG_HEIGHT/( ORIG_WIDTH / REQUIRED_WIDTH ) ;
            Log.d(LOGTAG, "scaleBitmap returning scaled bitmap ");
            return Bitmap.createScaledBitmap(
                            b, 
                            REQUIRED_WIDTH, 
                            REQUIRED_HEIGHT, 
                            false); 
    }
} 
```

使用它，我在使用三星设备拍照时不再有问题，无论是像 SG3/Apollo 这样的旧手持设备还是像 SGTab 10.1 这样的新平板电脑，希望它有所帮助:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-01-19T16:19:06.367

在此处查看此帖子 [内容 uri 在 Android KitKat 上使相机崩溃](https://stackoverflow.com/questions/40087944/content-uri-crashes-camera-on-android-kitkat)

一些较旧的相机应用程序不正确支持 content:// URI，并且在传递不是 file:// URI 的 EXTRA_OUTPUT 时会崩溃。在更新我的代码以支持 Android N+ 中的 FileProviders 时，我注意到了这个错误。如果您将 URI 更改为 SDK 小于 Android N 的应用程序的 file:// URI，您应该能够解决此问题。

# python - 类和异常

> ID：14044940
> 
> 赞同：0
> 
> 时间：2012-12-26T18:59:46.907
> 
> 标签：python, class, exception, raise

我在下面用构造函数构建了一个类。这个想法是，如果未指定等级和/或花色，则默认情况下应随机生成 PlayingCard 对象。如果指定了无效的花色或等级，则不应创建对象。我相信这是有效的，但我不知道该怎么做。我想验证在无效等级或套装的情况下抛出的唯一异常是我指定的异常。我很困惑为什么会有一个“NameError”说该实例没有属性“suit”，因为我在编写 raise 语句时没有指定这一点。

另外，我想让类变得灵活，以便在创建实例时不需要将用户定义的等级和西装作为字符串传递，但我似乎无法让它工作。如果有人能指出我正确的方向或解释我为什么不想这样做，将不胜感激。

```
class PlayingCard:
    ranks = ['2','3','4','5','6','7','8','9','10','J','Q','K','A']
    suits = ['Spades', 'Hearts', 'Clubs', 'Diamonds']

    def __init__(self, rank = None, suit = None):
        if rank is None: self.rank = PlayingCard.ranks[rand.randint(0,12)]
        elif rank in PlayingCard.ranks: self.rank = rank

        if suit is None: self.suit = PlayingCard.suits[rand.randint(0,3)]
        elif suit in PlayingCard.suits: self.suit = suit

        if self.rank not in PlayingCard.ranks or self.suit not in PlayingCard.suits: raise NameError('Invalid Suit or Rank')

>>> c1 = PlayingCard('15','Diamonds')

Traceback (most recent call last):
  File "<pyshell#63>", line 1, in <module>
    c1 = PlayingCard('15','Diamonds')
  File "C:\Python27\poker.py", line 26, in __init__
    if self.rank not in PlayingCard.ranks or self.suit not in PlayingCard.suits: raise NameError('Invalid Suit or Rank')
AttributeError: PlayingCard instance has no attribute 'rank'

>>> c2 = PlayingCard('A', 'Swords')

Traceback (most recent call last):
  File "<pyshell#64>", line 1, in <module>
    c2 = PlayingCard('A', 'Swords')
  File "C:\Python27\poker.py", line 26, in __init__
    if self.rank not in PlayingCard.ranks or self.suit not in PlayingCard.suits: raise NameError('Invalid Suit or Rank')
AttributeError: PlayingCard instance has no attribute 'suit' 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-26T19:02:23.383

when `rank`is not`None`和 also not in `ranks`，`self.rank`从不设置等等

```
if self.rank not in PlayingCard.ranks 
```

行不通；`self.rank`不存在。也一样`suit`。您可以更具体地处理错误并立即解决问题：

```
def __init__(self, rank = None, suit = None):
    if rank is None: self.rank = PlayingCard.ranks[rand.randint(0,12)]
    elif rank in PlayingCard.ranks: self.rank = rank
    else: raise NameError('Invalid rank')

    if suit is None: self.suit = PlayingCard.suits[rand.randint(0,3)]
    elif suit in PlayingCard.suits: self.suit = suit
    else: raise NameError('Invalid suit') 
```

# sqlite - 如何使用 XCode 4 调试 SQLite 扩展

> ID：14044941
> 
> 赞同：0
> 
> 时间：2012-12-26T18:59:54.507
> 
> 标签：sqlite, xcode4

我正在使用 XCode 4 为 SQLite 开发一个[虚拟表](http://www.sqlite.org/vtab.html)实现作为 C 中的[可加载扩展](http://www2.sqlite.org/cvstrac/wiki?p=LoadableExtensions)。我可以启动 SQLite shell 并加载我的扩展，但我不知道如何在 XCode 中使用调试器来调试该过程。

如果这是不可能的，有没有人有调试我的代码的提示？

# javascript - Javascript将字符串变量添加到响应

> ID：14044942
> 
> 赞同：0
> 
> 时间：2012-12-26T19:00:01.550
> 
> 标签：javascript, string, node.js, text, response

所以我对我正在使用的 node.js 程序有这个响应

```
'Content-Disposition': 'attachment; filename="tts.mp3"' 
```

我有一个名为 textToConvert 的变量，而不是 tts.mp3。如何添加`textToConvert.slice(0,10)`, 并将 .mp3 添加到它的末尾以将其作为 mp3 文件的名称而不是 tts.mp3？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T19:05:10.777

```
'Content-Disposition': 'attachment; filename="' + textToConvert.slice(0, 10) + '.mp3"' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T19:05:18.633

```
newResponse = response.replace(
    /(filename=")(\w+\.mp3)(")/, '$1' + textToConvert.slice(0, 10) + '.mp3$3'); 
```

# android - AsyncTask 中的httpClient 需要wakeLock 吗？

> ID：14044944
> 
> 赞同：4
> 
> 时间：2012-12-26T19:00:06.063
> 
> 标签：android, android-asynctask

我在 AsyncTask 中执行 httpClient 但在此之前另一个 AsyncTask 用于生成一些数据，这可能需要很长时间。如果设备在执行 httpClient 之前进入睡眠状态，会发生什么？对于 httpClient 请求，我是否需要 wakeLock？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T19:05:14.697

如果设备进入睡眠状态，`onPause()`则会调用您的活动。如果您不以某种奇特的方式取消/终止后台任务，则不会发生任何事情。`AsyncTask`运行在与主应用程序不同的线程中，因此没有什么可以阻止它们。曾经。

我不明白你的设计：两个单独`AsyncTask`的 s 的目的是什么？如果收集数据以填充 HTTP 请求会消耗时间，则应使用单个`AsyncTask`并在其中执行所有操作`doInBackground()`，以确保不会发生竞争条件。否则，您必须将任务链接起来，或者在第一个任务中触发第二个任务，这听起来不正确。

HTTP 客户端只是一个套接字库，不是神话中的野兽 :)

# java - 我这样做正确吗？

> ID：14044946
> 
> 赞同：10
> 
> 时间：2012-12-26T19:00:09.030
> 
> 标签：java, audio, byte, bytebuffer, short

![在此处输入图像描述](../Images/e7c9f7d67c164e0a851335826d744c16.png)

* * *

在我寻求帮助之前，让我告诉你我做了什么：假设我的**采样率为 8000Hz**，**样本大小为 16 位（2 字节）**，在第二秒结束时，我需要 16000 字节或 8000 字节。
现在我有一个**10fps**的记录速度，然后对于每个 fps 我需要 16000/10 = 1600 字节。
所以，故事是这样发展的：

### 声明的变量：

```
byte[] eachPass = new byte[1600]; //used to store data from TargetDataLine for each pass
byte[] backingArray = new byte[16000]; //the complete data for one second
ByteBuffer buffer = ByteBuffer.wrap(backingArray); //buffer which stores the complete data
short[] audioSample = new short[16000/2]; //audio samples to be encoded
int passCounter = 0; /* After 10th pass, convert the byte[] to short[]
                      * using ByteBuffer */
int seconds = 0; // used to store the position of the packet 
```

### byte[] 到 short[] 的循环和后续转换

```
while(keepCapturing == true){
    -- set up the java.awt.Robot and TargetDataLine before entering the loop --
    -- use java.awt.Robot to record the screen --
    -- do some other stuff, if needed --
    fromMic.read(eachPass,0,eachPass.length); // read data from microphone
    buffer.put(eachPass); //put it in  a bigger buffer

    if(passCounter!=0 && passCounter%10==0){ // is it 10th frame?
        passCounter = 0; //reset counter
        seconds++;
        buffer.asShortBuffer.get(audioSamples); //get short[] in BigEndian format
        -- encode the audio at position (seconds-1) --
        buffer.clear();
    }else{
        passCounter++;
    } 
```

### 问题

*   即使在语句`buffer.position()`中返回 16000 ，我也会得到一个`if``BufferUnderflowException``buffer.asShortBuffer.get(audioSamples);`
*   我曾经`java.util.Arrays.toString()`看到我的`eachPass`和`audioSamples`包含的内容，我在 eachPass 中得到了一些数字，例如 -107、0、32 等，在 audioSamples 中得到了全零。为什么？

## 退伍军人，请您帮我确定此代码吗？我不知道发生了什么事。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-26T19:18:47.620

您忘记在读取数据之前[翻转](http://docs.oracle.com/javase/7/docs/api/java/nio/Buffer.html#flip%28%29)缓冲区，这就是为什么没有写入`audioSamples`.

```
buffer.flip();
buffer.asShortBuffer.get(audioSamples); 
```

# android - 如何在android中中止BroadcastReceiver

> ID：14044952
> 
> 赞同：8
> 
> 时间：2012-12-26T19:00:39.203
> 
> 标签：android, broadcastreceiver, android-pendingintent, smsmanager

我正在制作一个短信日程应用程序，它只需要用户的时间、短信和号码，并在给定时间发送此短信。我正在使用`PendingIntent`. 这是我的示例代码。

当用户创建计划时，它只是调用此方法。

```
private void SendMessages()
    {
        Intent intent = new Intent(this, SMSBroadcastReceiver.class);
        PendingIntent pendingIntent = PendingIntent.getBroadcast(
                this.getApplicationContext(), 234324243, intent, 0);

        AlarmManager alarmManager = (AlarmManager) getSystemService(ALARM_SERVICE);
        alarmManager.set(AlarmManager.RTC_WAKEUP, Timemilli, pendingIntent);
    } 
```

这是“SMSBroadcastReceiver.java”文件

```
public class SMSBroadcastReceiver extends BroadcastReceiver
{
    @Override
    public void onReceive(Context context, Intent intent)
    {
        Toast.makeText(context, "SMS Sent !!!!.", Toast.LENGTH_LONG)
                .show();
        // //Sms Sending

        try
        {
            SmsManager smsManager = SmsManager.getDefault();
            for (int i = 0; i < SMSScheduleContactsActivity.SelectedContacts.length; i++)
            {
                smsManager.sendTextMessage(
                        SMSScheduleContactsActivity.SelectedContacts[i], null,
                        AddNewSmsSchedule.Message, null, null);
            }

            Log.d("testllllllllllllllll", "Message Sent");
        }
        catch (Exception e)
        {   
            e.printStackTrace();
        }
    }

} 
```

我的问题是：当用户编辑时间表时，我怎样才能取消该广播并发送一个新的？由于可以有多个时间表，如何找到具体的更改/中止？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-07T15:43:58.257

> 当用户编辑时间表时，我如何取消该广播并发送一个新的？

`cancel()`使用与您用于设置时间表`AlarmManager`的等效项进行调用：`PendingIntent`

```
Intent intent = new Intent(this, SMSBroadcastReceiver.class);
PendingIntent pendingIntent = PendingIntent.getBroadcast(this, 234324243, intent, 0);
AlarmManager alarmManager = (AlarmManager) getSystemService(ALARM_SERVICE);

alarmManager.cancel(pendingIntent); 
```

> 由于可以有多个时间表，如何找到具体的更改/中止？

您的实施中只有一个警报。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-26T19:12:00.080

如果您有对待处理 Intent 的引用，那么您可以[取消](http://developer.android.com/reference/android/app/PendingIntent.html#cancel%28%29)该 Intent。如果要中止当前广播，可以使用[abortBroadcast](http://developer.android.com/reference/android/content/BroadcastReceiver.html#abortBroadcast%28%29)。

也可以看看：

1)[如何获取和取消 PendingIntent？](https://stackoverflow.com/questions/4347950/how-to-get-and-cancel-a-pendingintent)

2)[停止未决意图](https://stackoverflow.com/questions/5754199/stop-pending-intent)

3)[中止/取消广播](https://stackoverflow.com/questions/5191020/aborting-cancelling-broadcasts)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T21:44:42.130

*   public final void abortBroadcast()

在 API 级别 1 中添加 设置指示此接收器应中止当前广播的标志；仅适用于通过 Context.sendOrderedBroadcast 发送的广播。这将阻止任何其他广播接收器接收广播。它仍然会调用Context.sendOrderedBroadcast的调用者传入的BroadcastReceiver的onReceive(Context, Intent)。

此方法不适用于无序广播，例如使用 Context.sendBroadcast 发送的广播

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T02:37:26.877

如果你只是改变`Timemilli`，你可以再次调用你的`sendMessage()`函数。

```
alarmManager.set(AlarmManager.RTC_WAKEUP, Timemilli, pendingIntent); 
```

只要pendingIntent相同，AlarmManager.set()函数就会自动取消之前的告警；它不必是同一个实例，但需要根据 Intent.filterEquals()“匹配”：

> 由于这种行为，重要的是要知道两个 Intent 何时被认为是相同的，以便检索 PendingIntent。人们犯的一个常见错误是创建多个 PendingIntent 对象，其 Intent 仅在其“额外”内容上有所不同，期望每次都获得不同的 PendingIntent。这不会发生。Intent 中用于匹配的部分与 Intent.filterEquals 定义的部分相同。如果您使用两个根据 Intent.filterEquals 等效的 Intent 对象，那么您将获得相同的 PendingIntent 对象。

[http://developer.android.com/reference/android/app/AlarmManager.html#set(int](http://developer.android.com/reference/android/app/AlarmManager.html#set(int) , long, android.app.PendingIntent)

[http://developer.android.com/reference/android/app/PendingIntent.html](http://developer.android.com/reference/android/app/PendingIntent.html) http://developer.android.com/reference/android/content/Intent.html#filterEquals(android.content.Intent)

# node.js - express-session-mongo 与自己滚动的优势

> ID：14044962
> 
> 赞同：0
> 
> 时间：2012-12-26T19:01:53.197
> 
> 标签：node.js, mongoose, session-management

我是 nodejs/mongo 的新手，所以我最终推出了自己的会话中间件，因为我不知道[express-session-mongo](https://github.com/davglass/express-session-mongo)。

在我的中间件中，我将用户 ID 存储在会话中（通过 express 的会话中间件），然后在每个请求上加载登录的用户对象。我还允许用户将他们的用户/通行证存储在 httpOnly cookie 中以实现“记住我”功能。

该 npm 的文档页面有一些不足之处。

**我的问题是**：该模块与我写的相比有什么优势？我在做傻事吗？他们做的比我做的好在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T19:15:04.173

Your technique is highly insecure. If I just need to know the ID of a user record in your database, and I can use that in my session cookie to become any arbitrary user, that's a massive vulnerability. Session IDs should be pseudorandom tokens that in and of themselves do not contain any data. They are just unguessable numbers used to look up data on the server side. They should also be unique for each session across time, which a user ID is not.

# java - Android教程报错：edit_message无法解析或不是字段

> ID：14044968
> 
> 赞同：2
> 
> 时间：2012-12-26T19:02:16.270
> 
> 标签：java, android, eclipse, string, android-activity

我尝试按照 android 教程进行操作，但是在尝试运行代码后会出现此错误。这是我的主要活动。

```
 package com.example.menuexample;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.EditText;

public class MainActivity extends Activity {
    public final static String EXTRA_MESSAGE="com.example.menuexample.MESSAGE";

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }
    public void sendMessage(View view){ 
        Intent intent = new Intent(this, DisplayMessageActivity.class); 
        EditText editText= (EditText) findViewById(R.id.edit_message);  --HERE
        String message = editText.getText().toString();
        intent.putExtra(EXTRA_MESSAGE, message);
        startActivity(intent); 
    }

} 
```

我已经进入了 activity_main ：

```
<EditText
    android:id="@+id/editText1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:hint="@string/edit_message" >

</EditText> 
```

此外，strings.xml 有：

```
<string name="edit_message">Test</string> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-26T19:04:45.927

改变

```
EditText editText= (EditText) findViewById(R.id.edit_message); 
```

到

```
EditText editText= (EditText) findViewById(R.id.editText1); 
```

因为您已经在 xml 布局中声明了带有 editText1 id 的 Edittext，但是您试图找到不存在的控件 id

# mysql - MySQL，如何以 thos 格式获取日期范围：YYYY-MM-DD HH

> ID：14044971
> 
> 赞同：1
> 
> 时间：2012-12-26T19:02:33.237
> 
> 标签：mysql, sql

我在 mysql 中有一个日期时间字段。

我需要以这种格式 YYYY-MM-DD HH 在这两个日期范围之间进行选择

“2012-12-20 10”和“2012-12-23 15”

我如何在 mysql 中执行此操作，其中 utcdt 是我的日期时间字段？

```
SELECT DISTINCT utcdt
FROM rtb
WHERE 
utcdt>=UNIX_TIMESTAMP("2012-12-20 10") and utcdt<=UNIX_TIMESTAMP("2012-12-23 15") 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-26T19:07:13.047

使用`BETWEEN`和`STR_TO_DATE`如下：

```
 SELECT DISTINCT utcdt
 FROM rtb
 WHERE 
 utcdt BETWEEN STR_TO_DATE('2012-12-20 10', '%Y-%m-%d %h') 
       and STR_TO_DATE('2012-12-23 15', '%Y-%m-%d %h') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-26T19:17:25.017

有很多方法可以做到这一点。[Yogendra Singh](https://stackoverflow.com/questions/14044971/mysql-how-to-get-daterange-in-thos-format-yyyy-mm-dd-hh#14045023)已经展示了一种选择。你也可以这样做：

```
SELECT DISTINCT utcdt
FROM rtb
WHERE 
UNIX_TIMESTAMP( utcdt ) BETWEEN
    UNIX_TIMESTAMP("2012-12-20 10") AND
    UNIX_TIMESTAMP("2012-12-23 15"); 
```

... 例如。或者，你甚至可以这样做：

```
SELECT DISTINCT utcdt
FROM rtb
WHERE 
utcdt BETWEEN
    "2012-12-20 10" AND
    "2012-12-23 15"; 
```

...换句话说，甚至不需要先转换为 unix 时间戳。

因此，以您尝试过的相同方式，甚至：

```
SELECT DISTINCT utcdt
FROM rtb
WHERE 
utcdt >= "2012-12-20 10" AND
utcdt <= "2012-12-23 15"; 
```

# android - Android Section ListView Japaness 字符问题

> ID：14044973
> 
> 赞同：0
> 
> 时间：2012-12-26T19:02:39.573
> 
> 标签：android, listview, android-listview

我正在使用[http://code.google.com/p/android-section-list/](http://code.google.com/p/android-section-list/)。当我使用英文字母时，它工作得很好。但是当我尝试使用日语文本时。它不能正常工作。

问题在于日文文本，当我滚动一点时，它会将粘性标题更改为下一节文本。

这是我的部分列表适配器

```
public class GreetingsSectionListAdapter extends BaseAdapter implements ListAdapter, ItemClickListener {
private final DataSetObserver dataSetObserver = new DataSetObserver() {
    @Override
    public void onChanged() {
        super.onChanged();
        updateSessionCache();
    }

    @Override
    public void onInvalidated() {
        super.onInvalidated();
        updateSessionCache();
    };
};

private final ListAdapter linkedAdapter;
private final Map<Integer, String> sectionPositions = new LinkedHashMap<Integer, String>();
private final Map<Integer, String> sectionPositions1 = new LinkedHashMap<Integer, String>();
private final Map<Integer, String> imageSection = new LinkedHashMap<Integer, String>();
private final Map<Integer, Integer> itemPositions = new LinkedHashMap<Integer, Integer>();
private final Map<View, String> currentViewSections = new HashMap<View, String>();
private int viewTypeCount;
protected final LayoutInflater inflater;

private View transparentSectionView;

private OnItemClickListener linkedListener;
Context c;

public GreetingsSectionListAdapter(final LayoutInflater inflater,
        final ListAdapter linkedAdapter, Context c) {
    this.linkedAdapter = linkedAdapter;
    this.inflater = inflater;
    this.c = c;
    linkedAdapter.registerDataSetObserver(dataSetObserver);
    updateSessionCache();
}

private boolean isTheSame(final String previousSection,
        final String newSection) {
    if (previousSection == null) {
        return newSection == null;
    } else {
        return previousSection.equals(newSection);
    }
}

private synchronized void updateSessionCache() {
    int currentPosition = 0;
    sectionPositions.clear();
    itemPositions.clear();
    viewTypeCount = linkedAdapter.getViewTypeCount() + 1;
    String currentSection = null;
    final int count = linkedAdapter.getCount();
    for (int i = 0; i < count; i++) {
        final GreetingsSectionListItem item = (GreetingsSectionListItem) linkedAdapter
                .getItem(i);
        if (!isTheSame(currentSection, item.title)) {
            sectionPositions.put(currentPosition, item.title);
            sectionPositions1.put(currentPosition, item.profile);
            imageSection.put(currentPosition, item.imagename);
            currentSection = item.title;
            currentPosition++;
        }
        itemPositions.put(currentPosition, i);
        currentPosition++;
    }
}

@Override
public synchronized int getCount() {
    return sectionPositions.size() + itemPositions.size();
}

@Override
public synchronized Object getItem(final int position) {
    if (isSection(position)) {
        return sectionPositions.get(position);
    } else {
        final int linkedItemPosition = getLinkedPosition(position);
        return linkedAdapter.getItem(linkedItemPosition);
    }
}

public synchronized boolean isSection(final int position) {
    return sectionPositions.containsKey(position);
}

public synchronized String getSectionName(final int position) {
    if (isSection(position)) {
        return sectionPositions.get(position);
    } else {
        return null;
    }
}

@Override
public long getItemId(final int position) {
    if (isSection(position)) {
        return sectionPositions.get(position).hashCode();
    } else {
        return linkedAdapter.getItemId(getLinkedPosition(position));
    }
}

protected Integer getLinkedPosition(final int position) {
    return itemPositions.get(position);
}

@Override
public int getItemViewType(final int position) {
    if (isSection(position)) {
        return viewTypeCount - 1;
    }
    return linkedAdapter.getItemViewType(getLinkedPosition(position));
}

private View getSectionView(final View convertView, final String title,
        final String profile, final String imagename) {
    View theView = convertView;
    if (theView == null) {
        theView = createNewSectionView();
    }

    setSectionText(title, profile, imagename, theView);
    replaceSectionViewsInMaps(title, theView);
    return theView;
}

//
protected void setSectionText(final String title, final String profile,
        final String imagename, final View sectionView) {

    final TextView textView = (TextView) sectionView
            .findViewById(R.id.greetingTitle);
    textView.setText(title);

    // //Example of setting any other's value
    final TextView textView1 = (TextView) sectionView
            .findViewById(R.id.txtProfile);
    textView1.setText(profile);

    final ImageView greetingImage = (ImageView) sectionView
            .findViewById(R.id.imageView1);

    if (!imagename.equals("")) {
        File filesDir = c.getFilesDir();
        File imageFile = new File(filesDir, imagename);
        Resources res = c.getResources();
        Bitmap bitmap = BitmapFactory.decodeFile(imageFile.getPath());
        BitmapDrawable bd = new BitmapDrawable(res, bitmap);
        greetingImage.setImageDrawable(bd);
    }

}

protected synchronized void replaceSectionViewsInMaps(final String section,
        final View theView) {
    if (currentViewSections.containsKey(theView)) {
        currentViewSections.remove(theView);
    }
    currentViewSections.put(theView, section);
}

protected View createNewSectionView() {
    return inflater.inflate(R.layout.greetings_section_view, null);
}

@Override
public View getView(final int position, final View convertView,
        final ViewGroup parent) {
    if (isSection(position)) {
        return getSectionView(convertView, sectionPositions.get(position),
                sectionPositions1.get(position), imageSection.get(position));
    }
    return linkedAdapter.getView(getLinkedPosition(position), convertView,
            parent);
}

@Override
public int getViewTypeCount() {
    return viewTypeCount;
}

@Override
public boolean isEnabled(final int position) {
    if (isSection(position)) {
        return true;
    }
    return linkedAdapter.isEnabled(getLinkedPosition(position));
}

//
public void makeSectionInvisibleIfFirstInList(final int firstVisibleItem) {
    final String section = getSectionName(firstVisibleItem);
    // only make invisible the first section with that name in case there
    // are more with the same name
    boolean alreadySetFirstSectionIvisible = false;

    String tmp1 = "", tmp2 = "", tmpImageName = "";
    for (final Entry<Integer, String> entry1 : sectionPositions1.entrySet()) {
        if (entry1.getKey() > firstVisibleItem + 1) {
            break;
        }
        tmp1 = entry1.getValue();
    }
    for (final Entry<Integer, String> entry : sectionPositions.entrySet()) {
        if (entry.getKey() > firstVisibleItem + 1) {
            break;
        }
        tmp2 = entry.getValue();
    }

    for (final Entry<Integer, String> entry2 : imageSection.entrySet()) {
        if (entry2.getKey() > firstVisibleItem + 1) {
            break;
        }
        tmpImageName = entry2.getValue();
    }
    setSectionText(tmp2, tmp1, tmpImageName, getTransparentSectionView());
}

public synchronized View getTransparentSectionView() {
    if (transparentSectionView == null) {
        transparentSectionView = createNewSectionView();
    }
    return transparentSectionView;
}

protected void sectionClicked(final String section) {
    // do nothing
}

@Override
public void onItemClick(final AdapterView<?> parent, final View view,
        final int position, final long id) {
    if (isSection(position)) {
        sectionClicked(getSectionName(position));
    } else if (linkedListener != null) {
        linkedListener.onItemClick(parent, view,
                getLinkedPosition(position), id);
    }
}

public void setOnItemClickListener(final OnItemClickListener linkedListener) {
    this.linkedListener = linkedListener;
} 
```

}

这是我的活动代码：

```
GreetingsSectionListItem[] greetingArray = { // Comment to prevent re-format
new GreetingsSectionListItem("Test 1 - A", "D","te",""), //
        new GreetingsSectionListItem("Test 2 - D", "D","te",""), //
        new GreetingsSectionListItem("Test 3 - D", "D","te",""), //
        new GreetingsSectionListItem("Test 4 - D", "D","te",""), //
        new GreetingsSectionListItem("Test 5 - D", "D","te",""), //
        new GreetingsSectionListItem("Test 6 - B", "B","te",""), //
        new GreetingsSectionListItem("Test 7 - B", "B","te",""), //
        new GreetingsSectionListItem("Test 8 - B", "B","te",""), //
        new GreetingsSectionListItem("Test 9 - Long", "Long section","te1",""), //
        new GreetingsSectionListItem("Test 10 - Long", "Long section","te1",""), //
        new GreetingsSectionListItem("Test 11 - Long", "Long section","te1",""), //
        new GreetingsSectionListItem("Test 12 - Long", "Long section","te1",""), //
        new GreetingsSectionListItem("Test 13 - Long", "Long section","te1",""), //
        new GreetingsSectionListItem("Test 14 - A again", "A","te2",""), //
        new GreetingsSectionListItem("Test 15 - A again", "A","te2",""), //
        new GreetingsSectionListItem("Test 16 - A again", "A","te2",""), //
        new GreetingsSectionListItem("Test 17 - B again", "B","te3",""), //
        new GreetingsSectionListItem("Test 18 - B again", "B","te3",""), //
        new GreetingsSectionListItem("Test 19 - B again", "B","te3",""), //
        new GreetingsSectionListItem("Test 20 - B again", "B","te3",""), //
        new GreetingsSectionListItem("Test 21 - B again", "B","te3",""), //
        new GreetingsSectionListItem("Test 22 - B again", "B","te3",""), //
        new GreetingsSectionListItem("Test 23 - C", "C","te4",""), //
        new GreetingsSectionListItem("Test 24 - C", "C","te4",""), //
        new GreetingsSectionListItem("Test 25 - C", "C","te4",""), //
        new GreetingsSectionListItem("Test 26 - C", "C","te4",""), //
};

private StandardArrayAdapter arrayAdapter;

private GreetingsSectionListAdapter sectionAdapter;

private GreetingsSectionListView listView;

@Override
public void onCreate(final Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.greetings_main);
    arrayAdapter = new StandardArrayAdapter(this, R.id.txt_sub_belong_to,
            greetingArray);

    sectionAdapter = new GreetingsSectionListAdapter(getLayoutInflater(),
            arrayAdapter,getApplicationContext());

    listView = (GreetingsSectionListView) findViewById(getResources().getIdentifier(
            "greetings_section_list_view", "id",
            this.getClass().getPackage().getName()));
    listView.setAdapter(sectionAdapter);
} 
```

当我尝试将 greetingArray 更改为以下时出现问题

```
GreetingsSectionListItem[] greetingArray = { // Comment to prevent re-format
        new GreetingsSectionListItem("挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。", "第１回 ○○学会総会の開催にあたって","te",""), //

                new GreetingsSectionListItem("挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。", "第１回 ○○学会総会の開催に寄せて","te1",""), //

                new GreetingsSectionListItem("挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。挨拶文が入ります。", "第１回 ○○学会総会の開催について","te2",""), //

        }; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T13:28:55.550

这是我的错误，我在那里做 +1 所以它现在几乎解决了。

# memory - OpenCL 中的流式传输

> ID：14044977
> 
> 赞同：1
> 
> 时间：2012-12-26T19:03:05.033
> 
> 标签：memory, stream, opencl

我将编写一个 OpenCL 程序，它在任务级别处理大量数据（无法进一步并行，但数据量足够高）数据​​本身是从文件中读取的，结果应该写入另一个文件. 现在我认为让 1 个线程读取文件并将数据推送到内核，而另一个线程获取完成的数据并将其写入文件可能是最好的（最快的）。所以我实际上需要类似 ReadData->CopyToDevice->ExecuteKernel->CopyToHost->WriteData

有没有什么例子，如何做到最好？我会从一个大约 10 个（队列、InputMemory、OutputMemory、Events）的数组开始。第一个线程：读取数据，等待下一个事件条目为空，填充此数组，下一个
第二个线程：事件！=null->waitforevent，写入数据，将事件设置为空或者可能使用 10-Semaphore 而不是检查无效的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T01:05:34.497

此外，使用单独的 OpenCL 命令队列进行上传、处理和下载，并使用 clEvents 在它们之间创建依赖关系。这将允许硬件在 GPU 支持时重叠这些操作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T11:17:22.870

我正在为图像处理做[类似](http://ufo.kit.edu/repos/ufo-core)的事情，但在考虑做任何事情之前，你应该实际分析一下瓶颈在哪里。我不知道您的内核的计算密集程度如何，但您不应低估 I/O。

首先：是的，总共使用三个线程可能是隐藏 I/O 延迟的好主意。但是十个命令队列太多了，每个 GPU 一个就绰绰有余了。此外，如果你只有一个 GPU，那么如果它只能处理一个，那么给它提供十个不同的缓冲区是没有意义的。所以你最好使用双缓冲策略和阻塞读写。

# architecture - 哪些服务被视为基础设施服务？

> ID：14044978
> 
> 赞同：0
> 
> 时间：2012-12-26T19:03:06.297
> 
> 标签：architecture, n-tier-architecture

[从：](http://lostechies.com/jimmybogard/2008/08/21/services-in-domain-driven-design/)

> Infrastructure Service 类似于我们的 IEmailSender，它直接与外部资源通信，例如文件系统、注册表、SMTP、数据库等。NHibernate 之类的东西会出现在 Infrastructure 中。

[从：](https://stackoverflow.com/questions/1933351/if-you-are-forced-to-use-an-anemic-domain-model-where-do-you-put-your-businessInfrastructure%20Services)

> 用于抽象技术问题（例如 MSMQ、电子邮件提供商等）

a）*持久性对象*（即存储库/ DAL）是否也被视为*基础设施服务*（根据上面的引用它们是）？

b) 是否所有与外部资源通信且不属于主要问题域的服务（即删除它们会影响应用程序，但不会影响核心域问题）是否考虑了*基础设施服务*？

c) 除了那些直接与外部资源通信的服务之外，是否还有其他类型的服务也属于*基础设施服务*的范畴？

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T12:05:43.180

只需使用

> 用于抽象技术问题（例如 MSMQ、电子邮件提供商等）

作为主要规则。**基础设施服务是隐藏底层技术细节的东西。**当您从一种技术转移到另一种技术（特定的邮件客户端库；消息队列实现、数据存储、日志记录例程等，直至整个 .net 框架和计算机体系结构）时，它基本上会发生变化。

所以 - 存储库/dal 接口是域的一部分，因为它们从持久状态构造对象。他们的实现（有时是可插拔的）是基础设施的一部分。

（很抱歉，但我假设 b）和 c）是更多的理论问题，仅考虑特定应用才能回答）。

# java - Gps LocationListener for GoogleMaps V2 in android

> ID：14044979
> 
> 赞同：0
> 
> 时间：2012-12-26T19:03:15.047
> 
> 标签：java, android, eclipse, google-maps

我试图了解 googlemaps`LatLng`和`Location class`. 它们可以转换吗？我在用

> 谷歌地图 v2

在我的应用程序中，如何使用我的 GPS 在地图上定位我的位置

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T19:21:56.143

如果你愿意，你可以打电话`setMyLocationEnabled(true)`给你`GoogleMap`，然后`getMyLocation()`定期打电话。否则，除了调用`setMyLocationEnabled(true)`，您还可以：

第 1 步：设置`LocationListener`使用`LocationManager`.

步骤#2：调用`setLocationSource()`你的`GoogleMap`，提供一个`LocationSource`实现

步骤#3：在`LocationSource`实现中，保持提供给您的侦听器对象`activate()`

步骤#4：当位置修正进入你的`LocationListener`，将它们传递给你提供的监听器`activate()`

这是一个演示这个[的示例项目。](https://github.com/commonsguy/cw-omnibus/tree/master/MapsV2/Location)

# javascript - 评论系统计时器问题

> ID：14044980
> 
> 赞同：1
> 
> 时间：2012-12-26T19:03:19.733
> 
> 标签：javascript, jquery, ajax, comments

我的评论系统的评论代码遇到了这个奇怪的问题。我添加了一个功能，您必须在每条评论后等待 10 秒。它以前工作得很好，但现在我稍微更改了代码，我遇到了问题。当您发表评论时，即使这是您发布的第一条评论，也会出现错误，这应该是因为计时器甚至不应该处于活动状态。

完整的代码是：

```
1    var h = 0,
2       i, j = 10;
3    $(".comment").click(function () {
4       if (h == 0) {
5           var a = $(this).attr("data-post"),
6               b = $(".comname-" + a).text(),
7               c = $(".combody-" + a).val();
8           if ($.trim(b) == "") {
9               alertBox("Missing Field", "Please Enter a Name to Comment.", "Close")
10          }
11          else if ($.trim(c) == "") {
12              alertBox("Missing Field", "Please Enter a Comment.", "Close")
13          }
14          else {
15              var d = true;
16              if (c.length > 54) {
17                  if ($$.string(c).count(" ") < 3) {
18                      d = false
19                  }
20              }
21              if (d == true) {
22                  $.post("post.php?action=comment", {
23                      id: a,
24                      name: b,
25                      com: c
26                  }, function (b) {
27                      var c = $$.string(b).found(/\[[0-9]\] => (.+)/g, 2);
28                      $(".no-" + a).hide();
29                      $(".comname-" + a + ", .combody-" + a).val("");
30                      $(".comholder-" + a).append('<div class="commenthold comment-' + c[3] + '"><span class="content-' + c[3] + '">' + c[1] + '</span> <br> <span class="name cname-' + c[3] + '">' + c[0] + '</span><span class="comment-timeago" style="float:right" title="' + c[2] + '"></span><img src="/img/edit.png" class="edit tip" title="Edit Comment" style="cursor:pointer" data-id="' + a + '" onclick="openEdit(' + c[3] + ')"/><img src="/img/edited.png" title="This comment has be edited 0 times" class="times-' + c[3] + '" style="display:none;cursor:pointer;width: 13px;  height: 13px;  position: absolute;  top: 0px;  right: -17px;"><div style="color:red;position:absolute;top:2px;right:4px;cursor:pointer" title="Delete Comment" data-id="' + a + '" onclick="delO(' + a + ',' + c[3] + ')" class="tip"><img class="width" src="/img/remove.png" /></div></div><br>');
31                      $(".tip").tipsy({
32                          gravity: "sw"
33                      });
34                      $(".comment-timeago").timeago();
35                      var d = parseInt($(".show-" + a).text().replace(/[^0-9]/g, "")) + 1;
36                      $(".show-" + a).text(d + " Comment" + (d !== 1 ? "s" : ""))
37                  });
38                  h = 1;
39                  i = setTimeout(function () {
40                      h = 0
41                  }, j * 1e3);
42              }
43              else {
44                  alertBox("Error", "You must have at least 4 words considering the length of this comment.", "Close")
45              }
46          }
47      }
48      else {
49          clearTimeout(i);
50          i = setTimeout(function () {
51              h = 0
52          }, j * 1e3);
53          alertBox("Timer Warning", "Must wait " + j + " seconds before commenting again. Timer Reset.", "Close")
54      }
55    }); 
```

奇怪的是，如果我在开始之前添加一个警报，`if (h == 0)`那么它可以正常工作并且它不会显示计时器的错误框。

但是，如果我将 console.log 记录`h`为等于它将记录两次，这意味着它正在运行代码两次。即使它似乎只运行一次警报。

控制台（萤火虫）：

![控制台](../Images/d2ac7167c1c02c29fa16cfcd4aa0377f.png)

看？

## 代码解释。

我知道仅仅看代码会使理解代码有点困难。我想让你更轻松。

**第 1-2 行**：定时器的变量。`h`是状态，0 = 你可以评论；1 = 定时器仍未结束。`i`是 setTimeout 将被存储的变量。`j`是您可以再次评论之前的秒数。
**第 4 行**：开始`if`确保计时器结束。
**第 5-7 行**：获取帖子 ID（data-post）、评论者姓名（comnam）和获取实际评论（combody）的更多变量
**第 8-13 行**：确保名称并且评论中有内容。
**第 15 行**：对于另一种类型的错误。
**第 16-20 行**：如果评论超过 55 个字符，则检查它是否超过 3 个单词。如果不`d`== false 这将触发错误。
**第 27 行**：这个变量包含一个特殊的函数，它使用一个小的 RegExp 来获取所有信息`b`（来自 PHP 的信息，例如时间戳）。
**第 28 行**：隐藏“还没有评论！成为第一个！” 如果还没有评论。
**第 29 行**：清除名称和注释字段。
**第 30 行**：将评论附加到评论区域。
**第 35-36 行**：更新告诉您有多少评论的文本。
**第 39-41 行**：启动计时器，10000 毫秒（10 秒）后变`h`回 0，以便您可以继续评论。
**第 50-52 行**：重置计时器

我真的不明白问题是什么以及为什么它运行代码两次。我的代码中没有任何内容可以再次运行它。

感谢您的帮助，我希望我的问题对您来说已经足够清楚了。

# android - 更改 ImageButton 的背景

> ID：14044982
> 
> 赞同：1
> 
> 时间：2012-12-26T19:03:30.090
> 
> 标签：android, background, imagebutton

我计划将 Activity 的背景（可绘制）替换为`ImageButton`. 我该如何进行？

这是一天背景和一夜背景。当我点击按钮时，它应该总是改变。或者我如何检查当前活动的背景是什么？我不需要完全编程的代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T20:13:52.233

在 XML 文件中定义 StateListDrawable。根据按钮的状态使用不同的图像。这是 XML 的示例。我建议你谷歌一个教程的完整细节

此文件名为 button_active.xml

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">

  <item android:drawable="@drawable/button_pressed"
    android:state_pressed="true" />
  <item android:drawable="@drawable/button_checked"
    android:state_checked="true" />
  <item android:drawable="@drawable/button_default" />

</selector> 
```

从引用 statelist 可绘制文件的视图 xml 文件中提取

```
 android:background="@drawable/button_active"      

   /> 
```

# machine-learning - 混合模型的 MAP 期望最大化

> ID：14044983
> 
> 赞同：3
> 
> 时间：2012-12-26T19:03:35.217
> 
> 标签：machine-learning, statistics, expectation-maximization

在伯努利分布混合的情况下，我正在尝试写下 EM 的 MAP 更新。

我知道对于 ML 估计，我们有：

```
E-step: compute P(Z|X,p,t)
M-Step: (p,t)<-argmax sum(over Z): p(Z|X,p,t)log p(X,Z|p,t) 
```

其中 p 是每个类的向量参数（其中 K 个，每个大小为 D，其中 K 是类数，D 是特征数），t 是每个类的多项式参数。

但是我如何获得 MAP 估计值？p(X) 会是什么...？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T10:28:48.443

根据 Kevin P. Murphy 第 350 页的“机器学习 - 概率视角”：

在 M 步骤中，我们针对 theta 优化 Q 函数（辅助函数）：

```
theta^t = argmax_theta Q(theta,theta^{t-1}) 
```

这是 ML，为了执行 MAP 估计，我们将 M 步骤修改如下

```
theta^t = argmax_theta Q(theta,theta^{t-1})+log(p(theta)) 
```

theta 是参数，theta^{t-1} 是参数的先前近似值，theta^t 是当前参数。

Q 在哪里

```
Q(theta,theta^{t-1}) = E[logL(theta)|Data,theta^{t-1}] 
```

E步保持不变

所以基本上 ML 和 MAP 之间的区别在于您在 argmax 中添加 log(p(theta)) ，这是您的参数的先验日志。

对于先验 p(theta) 是 beta(alpha,beta) 分布的特定示例，我可以在这里参考最后一个作业答案：[assignment](https://github.com/Jim-Holmstroem/dd2447/blob/master/homework/assignment2/doc.pdf?raw=true)

使用您的优先级或将其保留在一般优先级应该是直截了当的。

# antlr - 根据上下文发出令牌

> ID：14044993
> 
> 赞同：0
> 
> 时间：2012-12-26T19:04:48.643
> 
> 标签：antlr, antlr3

我正在使用 antlr 2.7.4 创建词法分析器。我被困在以下情况：

*   如果冒号 (':') 后跟 C1 类中的字符，则应发出冒号令牌，后跟令牌 C1

*   如果冒号后面是字符类 C2 中的字符，则冒号应作为 C2 的一部分并应发出标记 C2。

假设 C1 类是 {1,2,3} 并且 C2 类是 {A,B,C} 那么 :13 应该标记为 COLON 后跟 C1。但是 :AB 应该被标记为 C2。

更具体地说，我有一种语言的语法，它有两种结构：

*   Identifier : Type // 它有三个标记： IDENT COLON IDENT 。类似 Pascall 的类型注解
*   :: // 这是一个标识符。有一类字符可以用作标识符。冒号可以用作标识符，前提是它与类的其他字符一起使用

一些例子：

*   myvar : Int // IDENT 冒号 IDENT
*   :: // 标识
*   :$ // 标识
*   &:& // 标识

一个后续问题：是否可以检查某个前瞻字符是否属于某个 Token 类？任何建议将不胜感激。

## 编辑

我想我是 antlrv2 的唯一用户。我很高兴在 antlrv3 中有一个解决方案，看看我是否可以在 antlrv2 中破解它。

# java - 使用 Bukkit / 类路径

> ID：14044997
> 
> 赞同：1
> 
> 时间：2012-12-26T19:04:59.803
> 
> 标签：java, jar, classpath, external

我将尝试在这个问题中尽可能描述，因为它很难解释..

开始。我有两个 jar 文件。一个（我自己的）和一个（The Bukkit jar）。bukkit jar，我喜欢在“./Server/bukkit.jar”中访问我正在运行的 bukkit jar 实例中的方法“org.bukkit.Bukkit.getServer()”，该实例由我自己的 processbuilder 启动罐..

所以在这里..

我自己的罐子代码：

```
public class Fukkit {
  public static void main(String[] args){
    ProcessBuilder pb = new ProcessBuilder("java", "-cp", "bukkit.jar", "org.bukkit.craftbukkit.Main");
    pb.directory(new File(new File(".").getPath() + File.separator + "Server"));
    try {
        pb.start();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    //I now want to access that instance of bukkit.jar, and use the method
    org.bukkit.Bukkit.getServer();
    //From inside the jar..

    //I cannot add it as a library, because the jar may be swapped out 
    //for another more updated version of bukkit.jar.. 
    //But that method will always be present. Can someone help me out..?
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T19:23:52.613

这种方法**行不通**。您正在尝试引用在单独的[系统进程中](https://en.wikipedia.org/wiki/Process_%28computing%29)加载​​的 Java 类- 它是否是您当前进程的子进程并不重要。从 Java 的角度来看，它是一个独立的 Java 虚拟机，两者之间没有特定于 Java 的通信。

你需要做的是：

1.  将 bukkit.jar 添加到您的类路径（[此处为示例](https://stackoverflow.com/questions/8893337/putting-a-jar-file-in-classpath)）。
2.  在**您的**主要方法中`Fukkit.main()`，执行`org.bukkit.craftbukkit.Main.main(new String [] {"your arguments here"})`.
3.  然后你应该能够参考`org.bukkit.Bukkit.getServer()` 和其他方法。

完成这个快速回答后，我现在才注意到您关于 JAR 可能正在更新的评论。好吧，有一些在运行时重新加载 JAR 的高级方法，但我建议在发生此类更新时简单地重新启动**程序**。

另外，Bukkit 没有插件架构吗（我假设我们正在谈论 Minecraft Bukkit 服务器）？**也许您正试图以迂回的方式进行，这导致了问题？尝试检查 Bukkit 的 API 是否不支持做你想做的事。**

# lua - Lua 设置错误

> ID：14044998
> 
> 赞同：4
> 
> 时间：2012-12-26T19:05:00.193
> 
> 标签：lua, ubuntu-12.04

嗨我已经下载了lua并解压它并尝试制作它

```
sg1@kalanamith:~/lua-5.2.1$ make linux test 
```

在那之后嗯得到这个错误

```
ar rcu liblua.a lapi.o lcode.o lctype.o ldebug.o ldo.o ldump.o lfunc.o lgc.o llex.o     lmem.o lobject.o lopcodes.o lparser.o lstate.o lstring.o ltable.o ltm.o lundump.o lvm.o     lzio.o lauxlib.o lbaselib.o lbitlib.o lcorolib.o ldblib.o liolib.o lmathlib.o loslib.o     lstrlib.o ltablib.o loadlib.o linit.o 
ranlib liblua.a
gcc -O2 -Wall -DLUA_COMPAT_ALL -DLUA_USE_LINUX    -c -o lua.o lua.c    
gcc -o lua   lua.o liblua.a -lm -Wl,-E -ldl -lreadline -lncurses 
/usr/bin/ld: cannot find -lncurses
collect2: ld returned 1 exit status
make[2]: *** [lua] Error 1
make[2]: Leaving directory `/home/sg1/lua-5.2.1/src'
make[1]: *** [linux] Error 2   
make[1]: Leaving directory `/home/sg1/lua-5.2.1/src'
make: *** [linux] Error 2 
```

这是我使用 Lua 的第一天，所以如果有人可以帮助我，我会很开心。先感谢您

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-26T19:09:50.393

看起来你错过了`ncurses`图书馆。确保您已安装所有依赖项，例如通过使用`sudo apt-get install libncurses-dev`（可能取决于您的系统/版本）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-26T23:08:35.857

应用用于编译 Debian/Ubuntu 软件包的补丁：

```
Index: lua5.2-5.2.0.obsolete.0.298371916710497/src/Makefile
===================================================================
--- lua5.2-5.2.0.obsolete.0.298371916710497.orig/src/Makefile   2012-05-04 16:27:35.000000000 +0200
+++ lua5.2-5.2.0.obsolete.0.298371916710497/src/Makefile    2012-05-04 16:27:35.000000000 +0200
@@ -103,7 +103,7 @@
 generic: $(ALL)

 linux:
-   $(MAKE) $(ALL) SYSCFLAGS="-DLUA_USE_LINUX" SYSLIBS="-Wl,-E -ldl -lreadline -lncurses"
+   $(MAKE) $(ALL) SYSCFLAGS="-DLUA_USE_LINUX" SYSLIBS="-Wl,-E -ldl -lreadline"

 macosx:
    $(MAKE) $(ALL) SYSCFLAGS="-DLUA_USE_MACOSX" SYSLIBS="-lreadline" 
```

原始来源： http: [//patch-tracker.debian.org/patch/series/view/lua5.2/5.2.1-3/no-ncurses-dependency.patch](http://patch-tracker.debian.org/patch/series/view/lua5.2/5.2.1-3/no-ncurses-dependency.patch)

干杯