# StackOverflow 问答 14025000-14025999

# php - 在专用服务器上使用 Wordpress 的 PHP 高服务器 CPU 负载

> ID：14025002
> 
> 赞同：1
> 
> 时间：2012-12-24T19:21:29.047
> 
> 标签：php, mysql, wordpress, cpanel, dedicated-server

我在专用服务器上运行两个博客，一个每天有 500 个独立访问者，另一个每天有 18.000 个独立访问者，在 cPanel 中我看到 PHP 的 CPU 负载高达 99%，我已经尝试了很多事情，但没有解决负载。

服务器变慢了 250 人在线，500 人启动数据库连接问题，当然网站变得太慢wwwwwwwwwwww。

我也尝试停用所有插件，但似乎其中任何一个都是问题所在。

这些是服务器规格：

```
CPU: AMD Athlon™ II X4 - 4x 2.3 GHz 4 Cores
Memory: 8GB Memory DDR3 ECC
Disk Controller: RAID 1 Software
First Hard Drive: 1000GB SATA Drive (7200 RPM)
Second Hard Drive: 1000GB SATA Drive (7200 RPM)
Uplink/Port Speed: 100 Mbps Uplink Port
Public Bandwidth: Unmetered 100Mbps
Operating System: Cent OS 6.2 64 bit
Control Panel Software: cPanel/WHM 
```

[PHP] httpd.conf：

```
StartServers 5
MinimumSpareServers 5
MinimumSpareServers 10
ServerLimit 256
MaxClients 256
MaxRequestsPerChild 10000
KeepAlive Off
Timeout 60 
```

WordPress 插件：

```
Akismet
AZIndex
BackWPup
BulletProof Security
Category Templates Two
Contact Form 7
Easy FancyBox
leenk.me
qTranslate
Really Simple CAPTCHA
Search Everything
SI CAPTCHA Anti-Spam
Stealth Update
Verve Meta Boxes
W3 Total Cache
WordPress File Monitor Plus
WP-PostRatings
WP Total Hacks 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T19:33:20.643

检查正在使用的内存，`top`看看它是否达到限制并交换到磁盘。如果一切配置正常，您应该会看到使用的交换接近于零。

对于 PHP，添加一个操作码缓存器，例如 APC、memcached、eaccelerator 等。这将减轻很多负担。

另外，检查 MySQL。如果您不更改出厂默认设置，您可能会丢弃大型服务器。有关此问题的一些想法，请参见[此处](http://www.mysqlperformanceblog.com/2006/09/29/what-to-tune-in-mysql-server-after-installation/)。我会为此推荐[JetProfiler](http://www.jetprofiler.com/)。检查查询缓存等以查看它是否被使用。缓存命中率低意味着它们太小。还要检查全表扫描。很多意味着您需要优化索引（使用[此站点](http://use-the-index-luke.com/)来执行此操作），以便慢查询不是问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T10:18:46.423

我们遇到了类似的问题。事实证明，在我们的案例中，它似乎是联系表格 7 / 真正简单的验证码的组合。尝试禁用那些 WP 插件。

如果可行，请重新启用它并清除验证码/tmp 目录和上传/验证码目录。插件似乎没有清理它的垃圾。

如果您已经拥有这些插件的最新版本（最新版本会清理），那么您可能像我一样在 Windows 中运行。在 Windows 中，验证码文件被创建为只读（Windows 文件系统属性），因此清理失败。

因此，如果您使用的是最新版本的插件并且您在 Windows 中工作，那么编辑文件真的简单-captcha.php ...您将在第 67 行附近看到

```
$this->file_mode = 0440; 
```

和

```
$this->answer_file_mode = 0444; 
```

**将0440**和**0444**都更改为**0666**。这将修复清理机制。

完成此操作后，不要忘记手动删除现有的 tmp 文件，或者至少删除它们的“只读”Windows 文件系统属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-24T19:25:31.063

您应该考虑为您的高负载站点添加缓存，例如使用 memcached。这很可能会为您节省大量资源。

### 进一步阅读：

*   [WordPress 的 Memcached 对象缓存插件](http://wordpress.org/extend/plugins/memcached/)
*   [配置 WordPress 以使用 Memcached](http://technology.mattrude.com/2011/11/configuring-wordpress-to-use-memcached/)

# actionscript-3 - ActionScript 3.0 中没有图层概念？！那么 Flash IDE 层会怎样呢？

> ID：14025006
> 
> 赞同：2
> 
> 时间：2012-12-24T19:22:03.340
> 
> 标签：actionscript-3, flash, layer, addchild, displayobject

我试图通过 AS3 动态地通过图层名称访问图层。但后来我发现 AS3 API 中的层上没有任何内容（或者我搜索得不够多）。

如果这是真的，在 IDE 中命名层对代码来说完全没有意义吗？

发生什么了？`DisplayObject`它们会在运行时转换为一堆索引的 s 吗？

我是否总是必须参考孩子的索引位置才能在两者之间堆叠（呃）一个新孩子？

没有那些命名层，我觉得这一切都杂乱无章……我只是希望我模棱两可。**：秒**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-24T19:29:21.773

简单的答案是，是的，一旦 FLA 被编译，层信息就会丢失。绝对没有办法在运行时获取有关它们的任何信息。在这方面，您无能为力。

您最好的选择可能是将曾经位于图层上的对象组放入容器 MovieClips 中。然后，您可以给这些 MovieClips 实例名称，它可以很容易地对应于图层名称。

否则，我不确定你能做多少。不幸的是，层是一个完全特定于 Flash IDE 的概念，并且基本上在编译时就被破坏了。

# eclipse-rcp - 在 Eclipse 更新站点项目中为插件定义自动启动

> ID：14025012
> 
> 赞同：2
> 
> 时间：2012-12-24T19:22:39.783
> 
> 标签：eclipse-rcp, eclipse-plugin, update-site

我为我的产品创建了一个更新站点，其中包含一组 Eclipse 插件。我希望在安装产品后启动 Eclipse 时自动启动一些插件。

实际上我知道 Eclipse 在 configuration\org.eclipse.equinox.simpleconfigurator\bundles.info 文件中保存了已安装插件的自动启动属性，并在插件安装后手动修改此文件工作正常。但我想要一种自动化的方法来提供用户友好的安装过程。

有没有办法指定插件在基于特性的 Eclipse 更新站点项目中自动启动？（例如类似于 Eclipse 产品配置的东西）。

正如我在谷歌上搜索的那样，有一些基于 maven 的安装工具，但我正在寻找一种通过标准 Eclipse 插件开发功能更简单的方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-09-08T00:25:34.980

您可以创建*插件/META-INF/p2.inf*文件：

```
instructions.configure = \
    setStartLevel(startLevel:4); \
    markStarted(started: true); 
```

另请参阅：

[http://git.eclipse.org/c/equinox/rt.equinox.bundles.git/tree/bundles/org.eclipse.equinox.weaving.caching/META-INF/p2.inf](http://git.eclipse.org/c/equinox/rt.equinox.bundles.git/tree/bundles/org.eclipse.equinox.weaving.caching/META-INF/p2.inf)

[http://chamibuddhika.wordpress.com/2011/05/18/installing-configuration-files-with-p2-inf-feature-installation/](http://chamibuddhika.wordpress.com/2011/05/18/installing-configuration-files-with-p2-inf-feature-installation/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T13:22:25.713

当您使用标准*产品配置编辑器打开产品文件时，您可以在**启动级别*部分的*配置*选项卡上配置自动启动设置。

 *将本产品导出/包含到更新站点时，用户安装产品时应考虑该设置。

不支持独立于产品设置自动启动。*

# android - Android & Maps v2：如何获取用户位置？

> ID：14025014
> 
> 赞同：3
> 
> 时间：2012-12-24T19:22:45.990
> 
> 标签：android, android-maps

在完成之前我有很多事情要做，在连续工作了 8 个小时之后，我需要寻求帮助。我已经设法在 Android 上设置了 V2 地图，它们可以在我的设备上运行，我不知道在哪里可以找到可以帮助我将其构建为更高级的地图应用程序的资源，我什至无法让用户位置显示。我正在有互联网的 Android 手机上调试。我已经阅读了 10 多个关于 Stack Overflow 的问题，并通读了 Google 上的一些文档。

到目前为止，这是我的课程：

```
import com.google.android.gms.maps.GoogleMap;
import com.google.android.gms.maps.SupportMapFragment;
import com.google.android.gms.maps.model.LatLng;
import com.google.android.gms.maps.model.MarkerOptions;

import android.location.Location;
import android.os.Bundle;
import android.support.v4.app.FragmentActivity;
import android.view.Menu;

public class MainActivity extends FragmentActivity  {

  private GoogleMap mMap;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
     setUpMapIfNeeded();

}

  @Override
    protected void onResume() {
        super.onResume();
        setUpMapIfNeeded();
    }

  private void setUpMapIfNeeded() {
        // Do a null check to confirm that we have not already instantiated the map.
        if (mMap == null) {
            // Try to obtain the map from the SupportMapFragment.
            mMap = ((SupportMapFragment) getSupportFragmentManager().findFragmentById(R.id.map))
                    .getMap();
            // Check if we were successful in obtaining the map.
            if (mMap != null) {
                setUpMap();
            }
        }
    }

  private void setUpMap() {

      mMap.setMyLocationEnabled(true);
      mMap.getMyLocation();

    }
} 
```

我需要建立获取用户位置，然后允许用户搜索地点并存储它们，有人认为这在 V2 地图中是可能的吗？

非常感谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-24T19:33:53.857

> 我需要建立获取用户位置，然后允许用户搜索地点并存储它们，有人认为这在 V2 地图中是可能的吗？

您需要通过 查找用户的位置`LocationManager`，就像在任何 Android 应用程序中一样。或者，您可以通过调用`setLocationSource()`您的`GoogleMap`.

**更新**

如果您使用`setMyLocationEnabled(true)`on ，您可以通过on`GoogleMap`检索位置。这比滚动您自己的位置跟踪更简单，但您没有获得太多控制（例如，您不知道移动）。`getMyLocation()``GoogleMap`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-01T06:15:47.307

今天收到一封来自 Google Maps 的邮件，里面提到获取当前位置在新的 Google Maps API v2 上，

自上个月以来，包括我在内的许多开发人员都发现在新的 Google Maps API v2 上获取当前位置存在问题或不便。

那个问题是

> " 使用 GoogleMap 并使用 setMyLocationEnabled(true) 启用我的位置。使用默认/内置 LocationSource 无法通知位置更改（我的意思是没有适当的方法，因为没有回调）。应该有一个通知用户/我的位置变化的方式。API v1 有办法做到这一点。没有它需要构建一个可能与 GoogleMap 当前显示的内容不同步的复杂算法。

上述问题在此处链接。[http://code.google.com/p/gmaps-api-issues/issues/detail?id=4644](http://code.google.com/p/gmaps-api-issues/issues/detail?id=4644)

然后今天谷歌地图团队给很多开发者发了一封邮件：

> “这个问题将在 Maps Android API 的下一个版本中得到解决。”

就是这样。。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-02T20:30:20.910

它有。请参阅 Google Maps V2 的位置 API。 [http://developer.android.com/training/location/index.html](http://developer.android.com/training/location/index.html)

# android - 带有图像的 ListView

> ID：14025017
> 
> 赞同：1
> 
> 时间：2012-12-24T19:24:04.277
> 
> 标签：android, android-listview, android-imageview

我有一个自定义数组适配器，我想在 ListView 中有一个图像视图。这只发生在 2.2 和 2.3.X 设备上。

我的行模板如下

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:orientation="horizontal" >

    <ImageView
        android:id="@+id/place_category_icon"
        android:layout_width="48dp"
        android:layout_height="48dp"
        android:layout_alignParentLeft="true"
        android:layout_marginRight="8dp"
        android:background="@drawable/photo1"
        android:scaleType="centerCrop" >
    </ImageView>

    <TextView
        android:id="@+id/place_name"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_centerVertical="true"
        android:layout_toLeftOf="@+id/list_timestamp"
        android:ellipsize="end"
        android:singleLine="true"
        android:text="Harsha Mallikarjun Vantagudi"
        android:textStyle="bold" >
    </TextView>

    <TextView
        android:id="@+id/place_distance"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_centerVertical="true"
        android:padding="6dp"
        android:paddingLeft="30dp"
        android:singleLine="true"
        android:text="2 hours" >
    </TextView>

</LinearLayout> 
```

当我加载列表时。图像已显示，但当我尝试滚动文本时文本消失，文本随机重新出现并消失。

![在此处输入图像描述](../Images/f79f763f36796735df37b0de340b2278.png)

![在此处输入图像描述](../Images/078f43391a6cb6f4cf14b35a38fec4ba.png)

适配器

```
public class PlacesListAdapter extends ArrayAdapter<Place> implements
        Filterable {
    public Context context;
    private List<Place> places;

    public PlacesListAdapter(Context context, List<Place> places) {
        super(context, R.layout.list_item_place, places);
        this.context = context;
        this.places = places;

    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {

        View view = convertView;

        if (view == null) {
            LayoutInflater inflater;
            inflater = LayoutInflater.from(getContext());
            view = inflater.inflate(R.layout.list_item_place, null);
        }

        Place place = places.get(position);

        if (place != null) {

            TextView place_title = (TextView) view
                    .findViewById(R.id.place_name);
            TextView place_distance = (TextView) view
                    .findViewById(R.id.place_distance);

            if (place_title != null) {
                place_title.setText(place.getPlaceName());
            }

            if (place_distance != null) {
                place_distance.setText(place.getPlaceDistance());
            }
        }

        return view;
    }

} 
```

[在 2.X 设备上测试 APK](http://play.mink7.com/Nomad.apk)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T19:38:11.400

我错了，我用的是充气机：）

这段代码肯定可以在 android 2.3 中运行，并且有图像和文本并且是可滚动的。

```
 @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        LayoutInflater inflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        View rowView = inflater.inflate(R.layout.list_row, parent, false);

        ImageView imgThumb = (ImageView) rowView.findViewById(R.id.thumbnail);
        TextView tvDate = (TextView) rowView.findViewById(R.id.tvDate);
        TextView tvHeadline = (TextView) rowView.findViewById(R.id.tvHeadline);
        // Button btDetail = (Button)rowView.findViewById(R.id.btDetail);

        NewsHeadline newsHeadline = values.get(position);
        if (newsHeadline != null) {
            imgThumb.setImageBitmap(newsHeadline.getThumbnail());
            DateFormat df = SimpleDateFormat.getDateInstance();
            tvDate.setText(df.format(newsHeadline.getDate()));
            tvHeadline.setText(newsHeadline.getTitle());
        }
        return rowView;
    } 
```

调用/设置代码：

```
protected void onPostExecute(String result) {
        Log.d("ReloadTask", "Done");

        newsListActivity.getListView().setAdapter(new               NewsDataArrayAdapter(newsListActivity, MyApplication.getListNewsHeadline())); 
```

和布局：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="fill_parent"
    android:layout_height="86dp"
    android:background="#363C4A"
    android:orientation="horizontal"
  >

    <!-- ListRow Left sied Thumbnail image -->

    <ImageView
        android:id="@+id/thumbnail"
        android:layout_width="80dip"
        android:layout_height="67dip"
        android:layout_alignLeft="@+id/lineBottom"
        android:layout_centerVertical="true"
        android:layout_marginRight="5dip" />

    <!-- Date -->

    <TextView
        android:id="@+id/tvDate"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignTop="@+id/thumbnail"
        android:layout_marginLeft="10dp"
        android:layout_toRightOf="@+id/thumbnail"
        android:text="12.07.2012"
        android:textColor="#747474"
        android:textSize="11dip"
        android:textStyle="normal"
        android:typeface="sans" />

    <!-- headline -->

    <TextView
        android:id="@+id/tvHeadline"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_below="@id/tvDate"
        android:layout_marginLeft="10dp"
        android:layout_marginTop="1dip"
        android:layout_toLeftOf="@+id/tvDetail"
        android:layout_toRightOf="@+id/thumbnail"
        android:text="Just gona stand there and ... is multilined?"
        android:textColor="#d4d4d4"
        android:textSize="14dip"
        android:textStyle="bold" />

    <!-- Rightend Arrow -->

    <TextView
        android:id="@+id/tvDetail"
        android:layout_width="13dp"
        android:layout_height="19dp"
        android:layout_alignParentRight="true"
        android:layout_centerVertical="true"
        android:background="@drawable/arrow" />

    <!-- Bottom Arrow -->

    <ImageView
        android:id="@+id/lineBottom"
        android:layout_width="288dip"
        android:layout_height="3dip"
        android:layout_alignParentBottom="true"
        android:layout_centerHorizontal="true"
        android:src="@drawable/line" />

</RelativeLayout> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-18T14:30:53.690

好吧，我知道我的响应可能有点晚了，但是我通过将其添加到 TextView 来修复它。

```
android:background="@android:color/transparent" 
```

# asp.net - css 更改在 Visual Studio 中不起作用

> ID：14025018
> 
> 赞同：9
> 
> 时间：2012-12-24T19:24:07.330
> 
> 标签：asp.net, css, visual-studio-2010

最近遇到一个奇怪的问题：Visual Studio 时不时会忽略我在 .css 中所做的更改。**只有当我与另一个重新创建 .css 时！名称更改变得可见。**当我清除解决方案并删除 .css 视觉仍然呈现！删除 .css 。有没有人有同样的问题，或者只是我的错误？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-24T19:32:34.907

首先，确保在您的项目中禁用 Web 缓存，尽管 Visual Studio 会自动禁用此机制。此外，如果支持，您可以在浏览器中尝试隐身/私人浏览机制。另一个原因可能是使用未更改的 css 文件。尝试清除浏览数据以了解导致问题的原因。

# iphone - 添加子视图或新视图控制器

> ID：14025020
> 
> 赞同：1
> 
> 时间：2012-12-24T19:24:53.420
> 
> 标签：iphone, ios, uiviewcontroller, ios6, subview

我一直在从事几个项目，但我总是不知道何时最好添加子视图或使用推送新的视图控制器。

更具体地说，假设我有一个主用户界面（视图控制器），其中包含许多项目，例如图像视图、文本视图和选择器视图。我没有在一个长滚动视图中显示所有这些东西，而是一直在推送单独的视图控制器并将它们的选择、文本等值存储在一个单例中，以便合并到 pop 的主视图中。

所以我的问题是什么时候使用子视图而不是视图控制器更好的编程实践，为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T22:59:58.313

一般来说，很难回答这个问题，但这里是我使用的考虑因素：

1.  最小化用户界面的深度（不要强制很多级别）；
2.  把相似的东西放在一起，把不同的东西分开（按有意义的小组组织）；
3.  保持用户界面简单（在一页上不要太多）。

显然，这些考虑相互冲突——这是一个优化问题。使用您的判断并与真实用户进行测试。

# mysql - 按标签使用的帖子数量排序标签？

> ID：14025022
> 
> 赞同：2
> 
> 时间：2012-12-24T19:25:06.010
> 
> 标签：mysql, sql, join

我有两张表，一张称为`Tags`，另一张称为`Posts_Tags`多对多关系。`Posts_Tags`包含两列，`postid`和`tagid`。`Tags`数据库还包含一个列`id`，它对应`tagid`于联合表中的 。

我想获取要向用户显示的标签名称列表，按使用次数排序。使用这些信息，我构建了一个将两个表连接在一起的查询：

```
SELECT Tags.name FROM `Tags` LEFT JOIN `Posts_Tags` ON Tags.id = Posts_Tags.tagid 
```

这为我提供了一个标签名称列表，但显然，它不仅仅只是从`Tags`表中选择数据。我知道我需要在`ORDER BY`某处添加一个子句（可能还有一个`GROUP BY`，但我不确定如何构造查询。

我应该在此查询中添加什么才能成功按每个标签使用的帖子数对我的结果进行排序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T19:27:57.160

使用`Group By`计算每个标签的使用次数。这假设您的标签名称是唯一的，如果不是，您将希望对 id 进行分组。

```
Select
  t.Name,
  Count(*) as TagUse
From
  Tags t
    Left Join
  Post_Tags p
    On t.Id = p.TagID
Group By
  t.Name
Order By
  TagUse Desc 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-24T19:28:42.290

假设一个标签只能在帖子上使用一次，您可以执行以下操作：

```
SELECT Tags.ID, Tags.name, count(*) as NumPosts
FROM Tags
  LEFT JOIN Posts_Tags ON Tags.id = Posts_Tags.tagid
Group by Tags.ID, Tags.name
Order by 3 desc 
```

# jsp - JSP / STRUTS2: < display:table > : 如何从嵌套列表创建表？

> ID：14025023
> 
> 赞同：0
> 
> 时间：2012-12-24T19:25:11.533
> 
> 标签：jsp, struts2

我很难在具有 3 层嵌套列表的 JSP 页面上生成 display:table：

我的主要课程是“ExpenditureTotalsByRegions”，其中有一个“ExpenditureTotalsByTypes”列表“ExpenditureTotalsByTypes”有一个“ExpenditureTotalsByProjects”列表

**主要问题是：此表中的行数和列数可能会有所不同：** 区域数会有所不同；类型的数量可能会有所不同/地区；项目数量不同/类型

JSP 页面获取“ExpenditureTotalsByRegions”列表，应如下所示：

```
Region 1
----------------------------------------------------------
Types |  Project 1 | Project 2
----------------------------------------------------------
type1 | $1,000     | $2,000
type2 | $2,000     | $2,500

Region 2
----------------------------------------------------------
Types |  Project 1 | Project 3  |Project 4
----------------------------------------------------------
type3 | $3,000     | $4,000     | $5,000
type4 | $3,500     | $4,500     | $5,500
type5 | $3,550     | $4,550     | $5,550 
```

**（在上面的例子中：'Region 1'，Region 2'是区域的名称，'type 1'，'type 2'等是类型的名称，'Project 1'，'Project2'等是名称的项目和 $ 支出是在项目中花费的实际金额）**

主要类：

```
public class ExpenditureTotalsByRegions {

    protected String fRegion = null;
    protected List<ExpenditureTotalsByTypes> fTypeExpenditures = new ArrayList<ExpenditureTotalsByTypes>();

    public ExpenditureTotalsByRegions(String region,List<ExpenditureTotalsByTypes> typeExpenditures) {
        fRegion = region;
        fTypeExpenditures = typeExpenditures;
    }

    public String getRegion() {
        return fRegion;
    }

    public void setRegion(String region) {
        fRegion = region;
    }

    public List<ExpenditureTotalsByTypes> getTypeExpenditures() {
        return fTypeExpenditures ;
    }

    public void setTypeExpenditures( List<ExpenditureTotalsByTypes> typeExpenditures) {
    fTypeExpenditures = typeExpenditures;
    }

    } 
```

现在，“ExpenditureType”类看起来像：

```
 public class ExpenditureTotalsByTypes{

    protected String fTypeName;
    protected List<ExpenditureTotalsByProjects> fProjectExpenditures = new ArrayList<ExpenditureTotalsByProjects>();

    public String getTypeName() {
    return fTypeName;
    }

    public void setTypeName(String typeName) {
        fTypeName= typeName;
    }

    public List<ExpenditureTotalsByProjects> getProjectExpenditures() {
        return fProjectExpenditures;
    }

    public void setProjectExpenditures( List<ExpenditureTotalsByProjects> projectExpenditures) {
        fProjectExpenditures = projectExpenditures;
    }

} 
```

现在“ExpenditureTotalsByProjects：类看起来像：

```
public class ExpenditureTotalsByProjects {

    protected String fProjectName;
    protected Double fProjectExpenditure;

    public ExpenditureTotalsByProjects( String projectName, Double projectExpenditure)   {
        fProjectName = projectName;
        fProjectExpenditure = projectExpenditure;        
    }

    public String getProjectName() {        
        return fProjectName;
    }      

    public void setProjectName( String projectName ) {        
        fProjectName = projectName;
    }

    public Double getProjectExpenditure() {        
        return fProjectExpenditure;
    }      

    public void setProjectExpenditure( Double projectExpenditure ) {        
        fProjectExpenditure = projectExpenditure;
    }

} 
```

我的动作课看起来像：

```
public class ExpendituresTotalsReportByRegionsAction extends ActionBase {

    protected List<ExpenditureTotalsByRegions> fTableData = new ArrayList<ExpenditureTotalsByRegions>();

    public ExpendituresTotalsReportByRegionsAction(JpaTransactionManager transactionManager) {
        super(transactionManager);
    }

    @Override
    public String execute() throws Exception {
        if (fYear != 0) {
             fTableData = reportDao.getExpenditureTotalsReportByRegions(fYear);
         }

        return SUCCESS;
    }

    public List<ExpenditureTotalsByRegions> getTableData() {
        return fTableData;
    }

} 
```

现在这是我试图在 JSP 页面上构建表格并获得运行时错误的方式：

```
<body>
<div class="container">
<div class="prepend-1"><br>
    <display:table id="reportTable"
                   name="tableData"
                   requestURI=""
                   cellspacing="0px"
                   export="true"
                   class="displaytagTable">
        <display:setProperty name="decorator.media.html"
                             value="gov.doi.expenditures.decorator.TotalSpeciesDecorator"/>
        <display:setProperty name="decorator.media.rtf"
                             value="gov.doi.expenditures.decorator.ItextTotalSpeciesDecorator"/>
        <display:setProperty name="decorator.media.pdf"
                             value="gov.doi.expenditures.decorator.ItextTotalSpeciesDecorator"/>

            <display:caption class="titleText ">${reportTable.region}</display:caption>

            <c:forEach items="${reportTable.typeExpenditures}" var="typeList"> 

                <display:column title="Types" property="${typeList}.typeName"/>

                <c:forEach items="${typeList.projectExpenditures}" var="projectList">
                    <display:column title="${projectList}.projectName" property="${projectList}.projectExpenditure"/>
                </c:forEach>

            </c:forEach> 

    </display:table>
</div>
</div>

</body> 
```

测试数据：

```
 List<ExpenditureTotalsByProjects> projectExpenditures = new ArrayList<ExpenditureTotalsByProjects>();
         List<ExpenditureTotalsByTypes> TypesExpenditures = new ArrayList<ExpenditureTotalsByTypes>();
         List<ExpenditureTotalsByRegions> regionExpenditures = new ArrayList<ExpenditureTotalsByRegions>();

         //Test data for reg1 
         projectExpenditures.add(new ExpenditureTotalsByProjects("project1",1000.00) );
         projectExpenditures.add(new ExpenditureTotalsByProjects("project2",2000.00) );

         //1st Types with 2 projects in reg1
         ExpenditureTotalsByTypes sp1 = new ExpenditureTotalsByTypes();
         sp1.setTypes("Types1");
         sp1.setProjectExpenditures(projectExpenditures);
         TypesExpenditures.add(sp1);

         //2nd Types with 2 projects in reg1
         projectExpenditures = new ArrayList<ExpenditureTotalsByProjects>();
         projectExpenditures.add(new ExpenditureTotalsByProjects("project1",1500.00) );
         projectExpenditures.add(new ExpenditureTotalsByProjects("project2",2500.00) );

         ExpenditureTotalsByTypes sp2 = new ExpenditureTotalsByTypes();
         sp2.setTypes("Types2");
         sp2.setProjectExpenditures(projectExpenditures);
         TypesExpenditures.add(sp2);

         //regionExpenditures.add(new ExpenditureTotalsByRegions("reg1",TypesExpenditures));

         tableData.add(new ExpenditureTotalsByRegions("reg1",TypesExpenditures));

         //Test data for reg2 
         TypesExpenditures = new ArrayList<ExpenditureTotalsByTypes>();

         projectExpenditures = new ArrayList<ExpenditureTotalsByProjects>();
         projectExpenditures.add(new ExpenditureTotalsByProjects("project3",3000.00) );
         projectExpenditures.add(new ExpenditureTotalsByProjects("project4",4000.00) );
         projectExpenditures.add(new ExpenditureTotalsByProjects("project5",5000.00) );

         sp1 = new ExpenditureTotalsByTypes();
         sp1.setTypes("Types3");
         sp1.setProjectExpenditures(projectExpenditures);
         TypesExpenditures.add(sp1);

         projectExpenditures = new ArrayList<ExpenditureTotalsByProjects>();
         projectExpenditures.add(new ExpenditureTotalsByProjects("project3",3500.00) );
         projectExpenditures.add(new ExpenditureTotalsByProjects("project4",4500.00) );
         projectExpenditures.add(new ExpenditureTotalsByProjects("project5",5500.00) );

         sp2 = new ExpenditureTotalsByTypes();
         sp2.setTypes("Types4");
         sp2.setProjectExpenditures(projectExpenditures);
         TypesExpenditures.add(sp2);

         projectExpenditures = new ArrayList<ExpenditureTotalsByProjects>();
         projectExpenditures.add(new ExpenditureTotalsByProjects("project3",3550.00) );
         projectExpenditures.add(new ExpenditureTotalsByProjects("project4",4550.00) );
         projectExpenditures.add(new ExpenditureTotalsByProjects("project5",5550.00) );

         ExpenditureTotalsByTypes sp3 = new ExpenditureTotalsByTypes();
         sp3.setTypes("Types5");
         sp3.setProjectExpenditures(projectExpenditures);
         TypesExpenditures.add(sp3);

         tableData.add(new ExpenditureTotalsByRegions("reg2",TypesExpenditures)); 
```

出现错误：“java.lang.RuntimeException：java.lang.RuntimeException：javax.servlet.jsp.JspException：查找属性时出错”但我还需要使用“forEach”构建表的帮助。请帮忙

如果您需要更多信息，请与我们联系。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T20:51:52.613

一种方法是：

```
<body>
<div class="container">
<div class="prepend-1"><br>
    <c:forEach items="${tableData}" var="regionList"> 
        <display:table id="TypeExpenditures"
                    name="${regionList.typeExpenditures}"
                    requestURI=""
                    cellspacing="0px"
                    export="true"
                    class="displaytagTable">

                <display:caption class="titleText ">${regionList.region}</display:caption>
                <display:column title="Types" property="typeName"/>

                <c:forEach items="${TypeExpenditures.projectExpenditures}" var="projectList"> 
                    <display:column title="${projectList.projectName}"  class='alignRight'>
                       $ ${projectList.projectExpenditure}
                    </display:column>
                </c:forEach>

        </display:table>
    </c:forEach>
</div>
</div>

</body> 
```

# java - 使用 JNI 为简单的基本程序编译 dll 时出现 gcc 错误

> ID：14025032
> 
> 赞同：0
> 
> 时间：2012-12-24T19:26:45.133
> 
> 标签：java, c, gcc, java-native-interface

这在前一段时间有效，我真的不知道发生了什么，但现在它不再有效了。

这是一个使用 JNI 的简单基本程序。
它有6个类：

*主JNI*

```
public class MainJNI {
    static {
        System.loadLibrary("W36Lib");
    }

    public static void main(String[] args) {
        double x = 7.0;
        double y =2.0;
        double sumResult = NativeMethods.sum(x, y);

        System.out.println("Sum = " + sumResult);
    }
} 
```

*NativeMethods.java*

```
public class NativeMethods {
    public static native double sum(double x, double y);
} 
```

*NativeMethods.c*

```
#include "NativeMethods.h"
#include "legacy.h"
#include <stdio.h>

JNIEXPORT jdouble JNICALL Java_NativeMethods_sum
    (JNIEnv *env, jclass cls, jdouble x, jdouble y) {
    return dSum(x, y);
} 
```

*NativeMethods.h - 通过命令“javah NativeMethods”使用 cygwin 生成*

```
/* DO NOT EDIT THIS FILE - it is machine generated */
#include <jni.h>
/* Header for class NativeMethods */

#ifndef _Included_NativeMethods
#define _Included_NativeMethods
#ifdef __cplusplus
extern "C" {
#endif
/*
 * Class:     NativeMethods
 * Method:    sum
 * Signature: (DD)D
 */
JNIEXPORT jdouble JNICALL Java_NativeMethods_sum
  (JNIEnv *, jclass, jdouble, jdouble);

#ifdef __cplusplus
}
#endif
#endif 
```

*遗留.c*

```
#include "legacy.h"

double dSum(double x, double y) {
    double result = x + y;
    return result;
} 
```

*遗留.h*

```
double dSum(double x, double y); 
```

该程序应该计算 2 个数字的总和。一件容易的事。但是当我尝试通过以下命令在 cygwin 中编译程序的 .dll 时：

```
 gcc -Wl,--add-stdcall-alias -mno-cygwin -shared 
-I"/cygdrive/c/jdk1.7.0_09/include" 
-I"/cygdrive/c/jdk1.7.0_09/include/win32" -o W36Lib.dll NativeMethods.c 
```

（命令被分成 3 行，但实际上是一行。它被拆分只是为了在这里看起来不错）

我现在必须告诉你，这个命令在几天前运行良好。我不知道发生了什么，但是在发送之后，我收到了这个错误：

```
/tmp/ccOvXYYS.o:NativeMethods.c:(.text+0x14): undefined reference to `_dSum'
collect2: ld returned 1 exit status 
```

我真的不知道出了什么问题以及为什么会收到此错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T19:53:54.373

您忘记包含`legacy.c`在编译中：

```
gcc -Wl,--add-stdcall-alias -mno-cygwin -shared 
-I"/cygdrive/c/jdk1.7.0_09/include" 
-I"/cygdrive/c/jdk1.7.0_09/include/win32" -o W36Lib.dll NativeMethods.c legacy.c 
```

# c++ - c++循环编译器优化

> ID：14025033
> 
> 赞同：1
> 
> 时间：2012-12-24T19:27:20.887
> 
> 标签：c++, optimization, loops

```
double var = 0.;
for(int i = 0; i < 1000000 ; i++)
{
    var += sqrt(2.0);
}
std::cout << var << std::endl; 
```

在 MSVC2012 下，是否有可能在打开优化的版本下， sqrt(2.0) 将被替换为 call 的值，而不是调用它 1*10^6 次？

asm 看起来像这样，不确定它的解释：

```
; Line 6
    push    ebp
    mov ebp, esp
    sub esp, 84                 ; 00000054H
    push    ebx
    push    esi
    push    edi
; Line 8
    movsd   xmm0, QWORD PTR __real@0000000000000000
    movsd   QWORD PTR _var$[ebp], xmm0
; Line 9
    mov DWORD PTR _i$1[ebp], 0
    jmp SHORT $LN3@main
$LN2@main:
    mov eax, DWORD PTR _i$1[ebp]
    add eax, 1
    mov DWORD PTR _i$1[ebp], eax
$LN3@main:
    cmp DWORD PTR _i$1[ebp], 1000000        ; 000f4240H
    jge SHORT $LN1@main
; Line 11
    sub esp, 8
    movsd   xmm0, QWORD PTR __real@4000000000000000
    movsd   QWORD PTR [esp], xmm0
    call    _sqrt
    add esp, 8
    fstp    QWORD PTR tv85[ebp]
    movsd   xmm0, QWORD PTR tv85[ebp]
    addsd   xmm0, QWORD PTR _var$[ebp]
    movsd   QWORD PTR _var$[ebp], xmm0
; Line 12
    jmp SHORT $LN2@main 
```

编辑：

对不起，上面是调试版本....

```
; Line 7
    push    ebp
    mov ebp, esp
    and esp, -8                 ; fffffff8H
; Line 11
    movsd   xmm0, QWORD PTR __real@4000000000000000
    call    __libm_sse2_sqrt_precise
    movsd   xmm2, QWORD PTR ?var@@3NA
    mov eax, 1000000                ; 000f4240H
$LL3@main:
    movapd  xmm1, xmm0
    addsd   xmm2, xmm1
    dec eax
    jne SHORT $LL3@main
    movsd   QWORD PTR ?var@@3NA, xmm2
; Line 13
    mov esp, ebp
    pop ebp
    ret 0 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-24T19:38:21.370

如果我正确读取了该程序集转储，则编译器`sqrt`会在调试构建中留在循环中，并在优化构建中将其移出。但它本可以更具侵略性。您显示的代码可能会合法地优化为

```
std::cout << "1414213.56238\n" << std::flush; 
```

[as-if 规则](https://stackoverflow.com/a/2307021/388520)允许编译器做*任何*不改变程序“可观察行为”的事情——并且执行时间不计入可观察行为。还允许编译器“了解”所有标准库函数的功能并在此基础上进行优化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T19:35:20.027

它显然是按预期调用的：

```
movsd   QWORD PTR [esp], xmm0
call    _sqrt 
```

编辑：我能想到的一种强制编译器不优化调用而不更改优化标志的方法是在命令行上传递传递给的值`sqrt()`或从以下位置读取它`stdin`：

```
double var = 0.;
double x;
cin >> x;
for(int i = 0; i < 1000000 ; i++) {
    var += sqrt(x);
} 
```

我相信这应该使优化调用变得不可能，因为在编译时该值是未知的，循环可能仍会被优化，但您也可以传递计数器值。

# c# - 在指定时间限制互联网访问

> ID：14025034
> 
> 赞同：3
> 
> 时间：2012-12-24T19:27:22.503
> 
> 标签：c#

我正在尝试做一个家长控制软件项目。我阻止了特定网站并使用主机文件解除了阻止。后来，我尝试通过以编程方式禁用和启用 LAN 连接来禁用/启用 Internet 访问。有没有办法在 C# 中的特定时间阻止 Internet 访问，例如`8 January 2013`在`20.00`-`23.00`小时之间。日期和时间由父母选择。如何通过在 C# 中使用用户计算机的时间来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T19:33:33.490

您可以创建一个[Windows 服务](http://www.codeproject.com/Articles/14353/Creating-a-Basic-Windows-Service-in-C)，该服务将定期检查计算机时间并相应地执行您选择的任何任务。

另一种选择是安排将在特定时间运行的任务。

您似乎已经研究过*如何*做到这一点，禁用 LAN 或更改主机都是影响用户使用互联网能力的两种方式......禁用 LAN 连接将提供一个完整的块，而修改 HOST 实际上只是一个*[黑名单](http://www.schneier.com/blog/archives/2011/01/whitelisting_vs.html)*...

# meteor - Meteorjs 嵌套条件模板

> ID：14025041
> 
> 赞同：4
> 
> 时间：2012-12-24T19:27:56.820
> 
> 标签：meteor

可以通过在会话变量更改时重新渲染然后直接操作 DOM 来渲染不同的模板并将它们放置在容器模板中。然而，这并不像 Meteor 的方式。是否有处理 DOM 更新的惯用方式？

客户端.js

```
if (Meteor.isClient) {

    var getContainerContents = function() {
        console.info('get container contents');
        var active = Session.get('active') == 'foo' ? 'foo' : 'bar';
        return Meteor.render(Template[active]());
    };

    Template.foo.contents = function() {
        console.info('foo contents');
        return 'The foos.';
    };

    Template.bar.contents = function() {
        console.info('bar contents');
        return 'The bars.';
    };

    Meteor.startup(function() {
        console.info('startup');

        Meteor.autorun(function() {
            console.info('autorun');
            $('#container').html(getContainerContents());
        });
    });

} 
```

客户端.html

```
<head>
  <title>conditional templates</title>
</head>

<body>
  {{> main }}
</body>

<template name="main">
  <section id="container"></section>
</template>

<template name="foo">
  <h2>Foos</h2>
  {{ contents }}
</template>

<template name="bar">
  <h2>Bars</h2>
  {{ contents }}
</template> 
```

更新：也可以为此目的使用模板助手。解决方案是从 template() 函数返回未渲染的字符串内容，并在 Handlebars 中将它们标记为安全，如下所示：

html

```
<template name="main">
  {{ contents }}
</template> 
```

js

```
var getContainerContents = function() {
    console.info('get container contents');
    var active = Session.get('active') == 'foo' ? 'foo' : 'bar';
    return Template[active]();
};

Template.main.contents = function() {
    return new Handlebars.SafeString(getContainerContents());
};

// Remove the startup and autorun code. Not necessary now. 
```

有两个问题可能使它不太理想。

1.  在主模板内呈现的任何嵌套模板也必须标记为 SafeString。否则内容将被 Handlebars 转义。这可能会导致一些膨胀，因为每个嵌套模板都需要 SafeString 代码。
2.  通过将字符串标记为安全（即未转义），开发人员现在有责任记住在将任何可能不安全的字符串插入页面之前对其进行转义。您拥有的这些越多，就越有可能造成安全漏洞。（有关文档，请参见[http://handlebarsjs.com/](http://handlebarsjs.com/)）

所以，在我看来，这个问题仍然悬而未决。但我会听从编辑的意见。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-25T03:46:41.150

使用 Handlebars 条件：

```
<template name="main">
  {{#if active}}
    {{> foo}}
  {{else}}
    {{> bar}}
  {{/if}}
 </template> 
```

在您的 Meteor JavaScript 代码中：

```
Template.main.active = function () {
  return Session.get("active");
} 
```

如果 foo 和 bar 共享内容，您可以使用 Helper，或者让 foo 和 bar 使用相同的部分（即。

> {{> 内容}}

) 取决于您的需要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-25T10:57:55.157

这是我正在使用的设置

客户端/client.js

```
Template.page.display_content = function () {
    var page_index = Handlebars.Utils.escapeExpression(Session.get('page'));

    if (Template[page_index]) {
        return Template[page_index]();
    } else {
        return Template['page_not_found']();
    }
}; 
```

客户端/template.html

```
<template name="page">
    {{{display_content}}}
</template> 
```

我只需要执行 Session.set("page", "xyz") 来更改页面，并且由于**{{{**它会自动标记为 SafeString。

1.模板“xyz”内的嵌套模板不需要标记为SafeString，它们都是在转义之前渲染的

到 2\. 你不必这样做，因为如果你输出一些像 {{text}} 这样的数据，它会再次自动转义，它不会再次被转义

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-06T15:42:28.123

您使用存储在公开变量（在模板助手中）中的名称引用模板：

```
{{> Template.dynamic template=varHandlingTemplateName }} 
```

这是 meteorjs 在其最新版本（截至今天）中解决动态模板情况的方式。

问候，格雷格

# java - 使用 Java 的一致发件人通过 g-mail 将文本消息发送到 At&t 电话

> ID：14025043
> 
> 赞同：0
> 
> 时间：2012-12-24T19:28:18.657
> 
> 标签：java, gmail

我有下面的代码，现在可以满足我的需要（使用 java 向手机发送短信）。

现在我的问题更具体一点，我不确定它意味着什么，或者它是否可能。

问题如下：

1 - 当我发送这封电子邮件时，每次创建一个通用（临时？）发件人（大概在 gmail 端），看起来总是像`"1 (410) 000-00x"`，其中 x 似乎向上/向下迭代（我只做了几个测试）。现在，下面的这段代码是实时日内电子邮件机制的一部分，用于将数据传达给人类，让他们采取某种行动。

2 - 因此，最好让发件人成为我的样本`abc@gmail.com`，但这不会发生。有没有办法强迫这种情况发生？我应该使用gmail以外的东西吗？

任何指针表示赞赏。

笔记：

我认为这可能会出现，所以我现在只想说：这个动作对时间非常敏感。这样一来，电子邮件的响应速度就不够了，而短信却会立即收到。我同意发送电子邮件会立即解决问题。

```
 public static void sendIT() throws AddressException, MessagingException, javax.mail.MessagingException
    {

    String host = "smtp.gmail.com";
    String from = "abc@gmail.com";
    String pass = "test";
    Properties props = System.getProperties();
    props.put("mail.smtp.starttls.enable", "true"); // added this line
    props.put("mail.smtp.host", host);
    props.put("mail.smtp.user", from);
    props.put("mail.smtp.password", pass);
    props.put("mail.smtp.port", "587");
    props.put("mail.smtp.auth", "true");

    String[] to = {"5555555555@txt.att.net"};

    Session session = Session.getDefaultInstance(props, null);
    MimeMessage message = new MimeMessage(session);
    message.setFrom(new InternetAddress(from));

    InternetAddress[] toAddress = new InternetAddress[to.length];

    //message.setFileName(g.destFileTracker);
    // To get the array of addresses
    for( int i=0; i < to.length; i++ ) { // changed from a while loop
        toAddress[i] = new InternetAddress(to[i]);
    }
    System.out.println(Message.RecipientType.TO);

    for( int i=0; i < toAddress.length; i++) { // changed from a while loop
        message.addRecipient(Message.RecipientType.BCC, toAddress[i]);
    }

    message.setSubject("Activity");
    message.setText("test");
    Transport transport = session.getTransport("smtp");
    transport.connect(host, from, pass);
    transport.sendMessage(message, message.getAllRecipients());
    transport.close();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T20:04:07.740

您应该尝试使用 mms 网关而不是 txt 网关。彩信网关将保留电子邮件地址。因此，不是 txt.att.net，而是 mms.att.net。

但是，如果这对时间敏感，您可能应该坚持使用 SMS 解决方案并使用第三方，因为我发现 MMS 在速度方面并不可靠。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T19:46:43.887

我很确定问题不在谷歌方面。Google 只是将一封电子邮件从您的 gmail 帐户发送到 at-t 网关。然后，AT-T网关以自己的方式将电子邮件地址转换为手机号码，无法控制。

我有几个建议。

1.  您可以将“发件人”消息包含到文本本身中。

2.  您可以使用不同的 SMS 网关，但请记住，它们中的大多数都不是免费的。

# c++ - 删除基于数组的列表中的项目

> ID：14025045
> 
> 赞同：0
> 
> 时间：2012-12-24T19:29:00.207
> 
> 标签：c++, arrays

在基于数组的列表的程序中，我有一个调用以下 3 次的函数：

```
list->remove(1) 
```

我的问题是，当它打印出来时，它说它正在删除原始的第一项 3 次，而不是转到下一个新的第一项。

具体来说，当调用此代码时`test.cpp`：

```
for (int i = 1; i <= 3 && ! list->isEmpty(); i++) {
        cout << "Deleting item " << i << "." << endl;
        try {
                cout << "Deleted item " << list->remove(1) << endl;
        }
        catch (int e) {
                cout << "*** Error deleting from position " << i << " ***" << endl;
        }
} 
```

它返回以下内容：

> 删除项目 1.
> 删除项目 1
> 删除项目 2.
> 删除项目 1
> 删除项目 3.
> 删除项目 1

这是`ABList`我创建的课程。我认为错误出在我的`remove`方法中，但我不知道在哪里：

```
#ifndef _ABLIST_H_
#define _ABLIST_H_

#define LIST_MAX 10

#include <iostream>
#include "ABCList.hpp"

using namespace std;

template <class T>
class ABList : public ABCList<T> {

    private:
        T    a[LIST_MAX];
        int  size;

    public:
        ABList ();
        ~ABList ();
        virtual bool isEmpty ();
        virtual int  getLength ();
        virtual void insert (int pos, T item);
        virtual T    remove (int pos);
        virtual T    retrieve (int pos);
};

template <class T>
ABList<T>::ABList () {
    size = 0;
}

template <class T>
bool ABList<T>::isEmpty () {
    if (size == 0)
        return true;
    return false;
}

// returns size, which is updated whenever the list is lengthened or shortened
template <class T>
int ABList<T>::getLength() {
    return size;
}

template <class T>
void ABList<T>::insert(int pos, T item) {

    try {
        // if list is at maximum size
        if (size >= LIST_MAX)
            throw "Size is greater than or equal to LIST_MAX\n";
        // if "pos" is a negative number
        if (pos < 0)
            throw "Pos must be greater than 0\n";
        // if "pos" is outside the bounds of the existing list
        if (pos > size + 1)
            throw "Pos must be less than or equal to list size\n";

        //shift all items at indices > pos one index up
        for (int i = size; i >= pos; --i) {
            a[i] = a[i-1];
        }
        //insert new item
        a[pos-1] = item;
        //increment size
        size++;

    } catch (char* message) {
        cout << "Error: " << message;
        throw 1; // any int will do, to catch exception flag in test.cpp
    }
}

template <class T>
T ABList<T>::remove(int pos) {

    try {
        if (pos < 1)
            throw "Pos cannot be less than 1";
        if (pos > size)
            throw "Pos cannot be greater than size";
        //find T to be removed, to return later
        T temp = retrieve(pos);
        //shift all items greater than pos down one index
        for (int i = pos + 1; i <= size; i++)
            a[i] = a[i+1];
        // decrement size
        size--;
        return temp;
    } catch (char* message) {
        cout << "Error: " << message;
        throw 1;
    }
}

template <class T>
T ABList<T>::retrieve(int pos) {
    try {
        //check that pos is valid
        if (pos < 1 || pos > size)
            throw "Position is outside bounds of ABList\n";

        return a[pos-1];

    } catch (char* message) {
        cout << "Error: " << message;
    }
}

#endif 
```

这是主程序。（为了这个问题，我不得不假设它是不可变的）：

```
int main () {
    // Testing the List implmenetations; first, get a list:
    ABCList<string> * list = getList();

    // Test "insert"
    cout << "Let's populate the list with a few items." << endl;
    for (int i = 1; i <= TEST_SIZE; i++) {
        int pos = getPos(i); // Randomise "i" to test
        string input;

        cout << "Enter a word to place into the list at position " << pos << ": ";
        cin >> input;

        try {
            list->insert(pos, input);
            cout << "Successfully inserted at position " << pos << "." << endl;
        }
        catch (int e) {
            cout << "*** Error inserting at position " << pos << " ***" << endl;
        }
}

    // Test "retrieve" & "getLength"
    cout << "List is as follows: \n\t";
    for (int i = 1; i <= list->getLength(); i++) {
        cout << list->retrieve(i) << " ";
    }
    cout << endl;

    // Test "delete" and "isEmpty"
    for (int i = 1; i <= 3 && ! list->isEmpty(); i++) {
        cout << "Deleting item " << i << "." << endl;
        try {
            cout << "Deleted item " << list->remove(1) << endl;
        }
        catch (int e) {
            cout << "*** Error deleting from position " << i << " ***" << endl;
        }
    }

    // Done. Let the destructor handle the rest.
    delete list;

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T19:42:02.953

在删除期间，您在获得项目后执行此操作`(1)`（这实际上是项目在`a[0]`：

```
for (int i = pos + 1; i <= size; i++)
    a[i] = a[i+1]; 
```

现在`pos`输入这个是什么时候？是的`(1)`，所以你正在将列表从`(2)`到`size`，将所有内容从`3..(size+1)`到`2...(size)`。“位置” 1 处的项目（同样，它实际上位于`0`数组中的插槽中，永远不会被覆盖，因此它始终是报告的返回项目。

这不仅是不正确的，而且当阵列完全填充时，它也是 UB（未定义的行为），您将在最后一个可行位置之后的一个插槽中访问数据。

您想在 处丢弃该项目`pos`，这是基于 1 的（您的设计；不是我的）。它的底层元素位于`a[pos-1]`数组中的位置。所以试试这个：

```
for (int i = pos; i < size; ++i)
    a[i-1] = a[i]; 
```

如果您检查以确保始终或更大，这*应该*是安全的（实际上，您似乎这样做了）。就我个人而言，我会坚持使用从零开始的索引系统，但我敢肯定，你有你的设计原因。`pos``1`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T19:46:50.777

在 remove 方法中，您错误地向下移动了一个索引。它应该是这样的：

```
for (int i = pos + 1; i <= size; i++)
    a[i-1] = a[i]; // instead of a[i] = a[i+1]; 
```

另一种方式可能是

```
for (int i = pos; i <= size; i++)
    a[i] = a[i+1]; 
```

请检查它是否有效。

# javascript - Mongoose 展开默认验证

> ID：14025049
> 
> 赞同：4
> 
> 时间：2012-12-24T19:29:35.127
> 
> 标签：javascript, node.js, mongodb, mongoose

我想在猫鼬模式验证规则中构建“minLength”和“maxLength”，目前的解决方案是：

```
var blogSchema = new Schema({
  title: { required: true, type: String }
});

blogSchema.path('title').validate(function(value) {
  if (value.length < 8 || value.length > 32) return next(new Error('length'));
}); 
```

但是我认为这应该通过添加自定义模式规则来简化，如下所示：

```
var blogSchema = new Schema({
    title: {
        type: String,
        required: true,
        minLength: 8,
        maxLength: 32
    }
}); 
```

我该怎么做，这甚至可能吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-24T20:14:44.687

查看库[mongoose-validator](https://github.com/leepowellcouk/mongoose-validator)。它以与您描述的非常相似的方式集成了节点验证器库，以便在 mongoose 模式中使用。

具体来说，[节点验证器](https://github.com/chriso/node-validator#list-of-validation-methods) **len**或**min**和**max**方法应该提供您需要的逻辑。

尝试 ：

```
var validate = require('mongoose-validator').validate;

var blogSchema = new Schema({
 title: {
    type: String,
    required: true,
    validate: validate('len', 8, 32)
 }
}); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-07-22T04:24:24.667

maxlength 和 minlength 现在存在。您的代码应该如下工作。

```
 var mongoose = require('mongoose');
    var blogSchema = new mongoose.Schema({
        title: {
             type: String,
             required: true,
             minLength: 8,
             maxLength: 32
        }
    }); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-17T22:05:47.157

我有相同的功能要求。不知道，为什么 mongoose 不为 String 类型提供最小值/最大值。您可以扩展 mongoose 的字符串模式类型（我刚刚从数字模式类型中复制了 min / max 函数并将其调整为字符串 - 对我的项目来说效果很好）。确保在创建架构/模型之前调用补丁：

```
var mongoose = require('mongoose');
var SchemaString = mongoose.SchemaTypes.String;

SchemaString.prototype.min = function (value) {
  if (this.minValidator) {
    this.validators = this.validators.filter(function(v){
      return v[1] != 'min';
    });
  }
  if (value != null) {
    this.validators.push([this.minValidator = function(v) {
      if ('undefined' !== typeof v)
        return v.length >= value;
    }, 'min']);
  }
  return this;
};

SchemaString.prototype.max = function (value) {
  if (this.maxValidator) {
    this.validators = this.validators.filter(function(v){
      return v[1] != 'max';
    });
  }
  if (value != null) {
    this.validators.push([this.maxValidator = function(v) {
      if ('undefined' !== typeof v)
        return v.length <= value;
    }, 'max']);
  }
  return this;
}; 
```

PS：由于这个补丁使用了一些猫鼬的内部变量，您应该为您的模型编写单元测试，以注意补丁何时损坏。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-05-29T03:13:00.203

最小值和最大值已更改

```
var breakfastSchema = new Schema({
  eggs: {
    type: Number,
    min: [6, 'Too few eggs'],
    max: 12
  },
  bacon: {
    type: Number,
    required: [true, 'Why no bacon?']
  },
  drink: {
    type: String,
    enum: ['Coffee', 'Tea'],
    required: function() {
      return this.bacon > 3;
    }
  }
}); 
```

[https://mongoosejs.com/docs/validation.html](https://mongoosejs.com/docs/validation.html)

# ruby-on-rails - 如何在 ubuntu 12.04 上启动 rails server localhost:3000

> ID：14025052
> 
> 赞同：6
> 
> 时间：2012-12-24T19:30:41.587
> 
> 标签：ruby-on-rails, ruby, linux, ubuntu, command

我是 ruby​​ on rails 的初学者。

我在官方页面上做了所有事情。(http://rubyonrails.org/download)

我尝试开始新项目，但 localhost 在 ubuntu 12.04 上不起作用。

我使用这些命令：

```
rails new /home/mehmet/Desktop/test/ 
```

这是控制台输出：

```
create  
  create  README.rdoc
  create  Rakefile
  create  config.ru
  create  .gitignore
  create  Gemfile
  create  app
  create  app/assets/images/rails.png
  create  app/assets/javascripts/application.js
  create  app/assets/stylesheets/application.css
  create  app/controllers/application_controller.rb
  create  app/helpers/application_helper.rb
  create  app/mailers
  create  app/models
  create  app/views/layouts/application.html.erb
  create  app/mailers/.gitkeep
  create  app/models/.gitkeep
  create  config
  create  config/routes.rb
  create  config/application.rb
  create  config/environment.rb
  create  config/environments
  create  config/environments/development.rb
  create  config/environments/production.rb
  create  config/environments/test.rb
  create  config/initializers
  create  config/initializers/backtrace_silencers.rb
  create  config/initializers/inflections.rb
  create  config/initializers/mime_types.rb
  create  config/initializers/secret_token.rb
  create  config/initializers/session_store.rb
  create  config/initializers/wrap_parameters.rb
  create  config/locales
  create  config/locales/en.yml
  create  config/boot.rb
  create  config/database.yml
  create  db
  create  db/seeds.rb
  create  doc
  create  doc/README_FOR_APP
  create  lib
  create  lib/tasks
  create  lib/tasks/.gitkeep
  create  lib/assets
  create  lib/assets/.gitkeep
  create  log
  create  log/.gitkeep
  create  public
  create  public/404.html
  create  public/422.html
  create  public/500.html
  create  public/favicon.ico
  create  public/index.html
  create  public/robots.txt
  create  script
  create  script/rails
  create  test/fixtures
  create  test/fixtures/.gitkeep
  create  test/functional
  create  test/functional/.gitkeep
  create  test/integration
  create  test/integration/.gitkeep
  create  test/unit
  create  test/unit/.gitkeep
  create  test/performance/browsing_test.rb
  create  test/test_helper.rb
  create  tmp/cache
  create  tmp/cache/assets
  create  vendor/assets/javascripts
  create  vendor/assets/javascripts/.gitkeep
  create  vendor/assets/stylesheets
  create  vendor/assets/stylesheets/.gitkeep
  create  vendor/plugins
  create  vendor/plugins/.gitkeep
     run  bundle install
/usr/lib/ruby/gems/1.9.1/gems/railties-3.2.9/lib/rails/generators/app_base.rb:254: warning: Insecure world writable dir /home/mehmet/.rvm/bin in PATH, mode 040777
/usr/lib/ruby/gems/1.9.1/gems/bundler-1.2.3/lib/bundler.rb:263: warning: Insecure world writable dir /home/mehmet/.rvm/bin in PATH, mode 040777
Fetching gem metadata from https://rubygems.org/...........
Fetching gem metadata from https://rubygems.org/..
Using rake (10.0.3) 
Using i18n (0.6.1) 
Using multi_json (1.5.0) 
Using activesupport (3.2.9) 
Using builder (3.0.4) 
Using activemodel (3.2.9) 
Using erubis (2.7.0) 
Using journey (1.0.4) 
Using rack (1.4.1) 
Using rack-cache (1.2) 
Using rack-test (0.6.2) 
Using hike (1.2.1) 
Using tilt (1.3.3) 
Using sprockets (2.2.2) 
Using actionpack (3.2.9) 
Using mime-types (1.19) 
Using polyglot (0.3.3) 
Using treetop (1.4.12) 
Using mail (2.4.4) 
Using actionmailer (3.2.9) 
Using arel (3.0.2) 
Using tzinfo (0.3.35) 
Using activerecord (3.2.9) 
Using activeresource (3.2.9) 
Using bundler (1.2.3) 
Using coffee-script-source (1.4.0) 
Using execjs (1.4.0) 
Using coffee-script (2.2.0) 
Using rack-ssl (1.3.2) 
Using json (1.7.5) 
Using rdoc (3.12) 
Using thor (0.16.0) 
Using railties (3.2.9) 
Using coffee-rails (3.2.2) 
Using jquery-rails (2.1.4) 
Using rails (3.2.9) 
Using sass (3.2.4) 
Using sass-rails (3.2.5) 
Using sqlite3 (1.3.6) 
Using uglifier (1.3.0) 
Your bundle is complete! Use `bundle show [gemname]` to see where a bundled gem is installed. 
```

你有什么主意吗？我如何创建一个新项目以及如何查看 localhost:3000 ？

编辑：

我想，我的问题是关于服务器。

我使用**rails 的**命令来启动服务器，它需要一些错误：

```
/usr/lib/ruby/gems/1.9.1/gems/railties-3.2.9/lib/rails/script_rails_loader.rb:11: warning: Insecure world writable dir /home/mehmet/.rvm/bin in PATH, mode 040777
/usr/lib/ruby/gems/1.9.1/gems/bundler-1.2.3/lib/bundler/runtime.rb:197: warning: Insecure world writable dir /home/mehmet/.rvm/bin in PATH, mode 040777
/usr/lib/ruby/gems/1.9.1/gems/execjs-1.4.0/lib/execjs/runtimes.rb:51:in `autodetect': Could not find a JavaScript runtime. See https://github.com/sstephenson/execjs for a list of available runtimes. (ExecJS::RuntimeUnavailable)
    from /usr/lib/ruby/gems/1.9.1/gems/execjs-1.4.0/lib/execjs.rb:5:in `<module:ExecJS>'
    from /usr/lib/ruby/gems/1.9.1/gems/execjs-1.4.0/lib/execjs.rb:4:in `<top (required)>'
    from /usr/lib/ruby/gems/1.9.1/gems/coffee-script-2.2.0/lib/coffee_script.rb:1:in `require'
    from /usr/lib/ruby/gems/1.9.1/gems/coffee-script-2.2.0/lib/coffee_script.rb:1:in `<top (required)>'
    from /usr/lib/ruby/gems/1.9.1/gems/coffee-script-2.2.0/lib/coffee-script.rb:1:in `require'
    from /usr/lib/ruby/gems/1.9.1/gems/coffee-script-2.2.0/lib/coffee-script.rb:1:in `<top (required)>'
    from /usr/lib/ruby/gems/1.9.1/gems/coffee-rails-3.2.2/lib/coffee-rails.rb:1:in `require'
    from /usr/lib/ruby/gems/1.9.1/gems/coffee-rails-3.2.2/lib/coffee-rails.rb:1:in `<top (required)>'
    from /usr/lib/ruby/gems/1.9.1/gems/bundler-1.2.3/lib/bundler/runtime.rb:68:in `require'
    from /usr/lib/ruby/gems/1.9.1/gems/bundler-1.2.3/lib/bundler/runtime.rb:68:in `block (2 levels) in require'
    from /usr/lib/ruby/gems/1.9.1/gems/bundler-1.2.3/lib/bundler/runtime.rb:66:in `each'
    from /usr/lib/ruby/gems/1.9.1/gems/bundler-1.2.3/lib/bundler/runtime.rb:66:in `block in require'
    from /usr/lib/ruby/gems/1.9.1/gems/bundler-1.2.3/lib/bundler/runtime.rb:55:in `each'
    from /usr/lib/ruby/gems/1.9.1/gems/bundler-1.2.3/lib/bundler/runtime.rb:55:in `require'
    from /usr/lib/ruby/gems/1.9.1/gems/bundler-1.2.3/lib/bundler.rb:128:in `require'
    from /home/mehmet/Desktop/testtt/config/application.rb:7:in `<top (required)>'
    from /usr/lib/ruby/gems/1.9.1/gems/railties-3.2.9/lib/rails/commands.rb:53:in `require'
    from /usr/lib/ruby/gems/1.9.1/gems/railties-3.2.9/lib/rails/commands.rb:53:in `block in <top (required)>'
    from /usr/lib/ruby/gems/1.9.1/gems/railties-3.2.9/lib/rails/commands.rb:50:in `tap'
    from /usr/lib/ruby/gems/1.9.1/gems/railties-3.2.9/lib/rails/commands.rb:50:in `<top (required)>'
    from script/rails:6:in `require'
    from script/rails:6:in `<main>'
mehmet@vefanet:~/Desktop/testtt$ rails s -p 3005 
/usr/lib/ruby/gems/1.9.1/gems/railties-3.2.9/lib/rails/script_rails_loader.rb:11: warning: Insecure world writable dir /home/mehmet/.rvm/bin in PATH, mode 040777
/usr/lib/ruby/gems/1.9.1/gems/bundler-1.2.3/lib/bundler/runtime.rb:197: warning: Insecure world writable dir /home/mehmet/.rvm/bin in PATH, mode 040777
/usr/lib/ruby/gems/1.9.1/gems/execjs-1.4.0/lib/execjs/runtimes.rb:51:in `autodetect': Could not find a JavaScript runtime. See https://github.com/sstephenson/execjs for a list of available runtimes. (ExecJS::RuntimeUnavailable)
    from /usr/lib/ruby/gems/1.9.1/gems/execjs-1.4.0/lib/execjs.rb:5:in `<module:ExecJS>'
    from /usr/lib/ruby/gems/1.9.1/gems/execjs-1.4.0/lib/execjs.rb:4:in `<top (required)>'
    from /usr/lib/ruby/gems/1.9.1/gems/coffee-script-2.2.0/lib/coffee_script.rb:1:in `require'
    from /usr/lib/ruby/gems/1.9.1/gems/coffee-script-2.2.0/lib/coffee_script.rb:1:in `<top (required)>'
    from /usr/lib/ruby/gems/1.9.1/gems/coffee-script-2.2.0/lib/coffee-script.rb:1:in `require'
    from /usr/lib/ruby/gems/1.9.1/gems/coffee-script-2.2.0/lib/coffee-script.rb:1:in `<top (required)>'
    from /usr/lib/ruby/gems/1.9.1/gems/coffee-rails-3.2.2/lib/coffee-rails.rb:1:in `require'
    from /usr/lib/ruby/gems/1.9.1/gems/coffee-rails-3.2.2/lib/coffee-rails.rb:1:in `<top (required)>'
    from /usr/lib/ruby/gems/1.9.1/gems/bundler-1.2.3/lib/bundler/runtime.rb:68:in `require'
    from /usr/lib/ruby/gems/1.9.1/gems/bundler-1.2.3/lib/bundler/runtime.rb:68:in `block (2 levels) in require'
    from /usr/lib/ruby/gems/1.9.1/gems/bundler-1.2.3/lib/bundler/runtime.rb:66:in `each'
    from /usr/lib/ruby/gems/1.9.1/gems/bundler-1.2.3/lib/bundler/runtime.rb:66:in `block in require'
    from /usr/lib/ruby/gems/1.9.1/gems/bundler-1.2.3/lib/bundler/runtime.rb:55:in `each'
    from /usr/lib/ruby/gems/1.9.1/gems/bundler-1.2.3/lib/bundler/runtime.rb:55:in `require'
    from /usr/lib/ruby/gems/1.9.1/gems/bundler-1.2.3/lib/bundler.rb:128:in `require'
    from /home/mehmet/Desktop/testtt/config/application.rb:7:in `<top (required)>'
    from /usr/lib/ruby/gems/1.9.1/gems/railties-3.2.9/lib/rails/commands.rb:53:in `require'
    from /usr/lib/ruby/gems/1.9.1/gems/railties-3.2.9/lib/rails/commands.rb:53:in `block in <top (required)>'
    from /usr/lib/ruby/gems/1.9.1/gems/railties-3.2.9/lib/rails/commands.rb:50:in `tap'
    from /usr/lib/ruby/gems/1.9.1/gems/railties-3.2.9/lib/rails/commands.rb:50:in `<top (required)>'
    from script/rails:6:in `require'
    from script/rails:6:in `<main>'
mehmet@vefanet:~/Desktop/testtt$ rails s
/usr/lib/ruby/gems/1.9.1/gems/railties-3.2.9/lib/rails/script_rails_loader.rb:11: warning: Insecure world writable dir /home/mehmet/.rvm/bin in PATH, mode 040777
/usr/lib/ruby/gems/1.9.1/gems/bundler-1.2.3/lib/bundler/runtime.rb:197: warning: Insecure world writable dir /home/mehmet/.rvm/bin in PATH, mode 040777
/usr/lib/ruby/gems/1.9.1/gems/execjs-1.4.0/lib/execjs/runtimes.rb:51:in `autodetect': Could not find a JavaScript runtime. See https://github.com/sstephenson/execjs for a list of available runtimes. (ExecJS::RuntimeUnavailable)
    from /usr/lib/ruby/gems/1.9.1/gems/execjs-1.4.0/lib/execjs.rb:5:in `<module:ExecJS>'
    from /usr/lib/ruby/gems/1.9.1/gems/execjs-1.4.0/lib/execjs.rb:4:in `<top (required)>'
    from /usr/lib/ruby/gems/1.9.1/gems/coffee-script-2.2.0/lib/coffee_script.rb:1:in `require'
    from /usr/lib/ruby/gems/1.9.1/gems/coffee-script-2.2.0/lib/coffee_script.rb:1:in `<top (required)>'
    from /usr/lib/ruby/gems/1.9.1/gems/coffee-script-2.2.0/lib/coffee-script.rb:1:in `require'
    from /usr/lib/ruby/gems/1.9.1/gems/coffee-script-2.2.0/lib/coffee-script.rb:1:in `<top (required)>'
    from /usr/lib/ruby/gems/1.9.1/gems/coffee-rails-3.2.2/lib/coffee-rails.rb:1:in `require'
    from /usr/lib/ruby/gems/1.9.1/gems/coffee-rails-3.2.2/lib/coffee-rails.rb:1:in `<top (required)>'
    from /usr/lib/ruby/gems/1.9.1/gems/bundler-1.2.3/lib/bundler/runtime.rb:68:in `require'
    from /usr/lib/ruby/gems/1.9.1/gems/bundler-1.2.3/lib/bundler/runtime.rb:68:in `block (2 levels) in require'
    from /usr/lib/ruby/gems/1.9.1/gems/bundler-1.2.3/lib/bundler/runtime.rb:66:in `each'
    from /usr/lib/ruby/gems/1.9.1/gems/bundler-1.2.3/lib/bundler/runtime.rb:66:in `block in require'
    from /usr/lib/ruby/gems/1.9.1/gems/bundler-1.2.3/lib/bundler/runtime.rb:55:in `each'
    from /usr/lib/ruby/gems/1.9.1/gems/bundler-1.2.3/lib/bundler/runtime.rb:55:in `require'
    from /usr/lib/ruby/gems/1.9.1/gems/bundler-1.2.3/lib/bundler.rb:128:in `require'
    from /home/mehmet/Desktop/testtt/config/application.rb:7:in `<top (required)>'
    from /usr/lib/ruby/gems/1.9.1/gems/railties-3.2.9/lib/rails/commands.rb:53:in `require'
    from /usr/lib/ruby/gems/1.9.1/gems/railties-3.2.9/lib/rails/commands.rb:53:in `block in <top (required)>'
    from /usr/lib/ruby/gems/1.9.1/gems/railties-3.2.9/lib/rails/commands.rb:50:in `tap'
    from /usr/lib/ruby/gems/1.9.1/gems/railties-3.2.9/lib/rails/commands.rb:50:in `<top (required)>'
    from script/rails:6:in `require'
    from script/rails:6:in `<main>' 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-24T19:32:35.690

```
cd /home/mehmet/Desktop/test/

bundle install

rails s 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-24T20:49:42.750

你已经有了答案：

/usr/lib/ruby/gems/1.9.1/gems/execjs-1.4.0/lib/execjs/runtimes.rb:51:in `autodetect'：找不到 JavaScript 运行时。有关可用运行时的列表，请参阅[https://github.com/sstephenson/execjs](https://github.com/sstephenson/execjs)。(ExecJS::RuntimeUnavailable)

最简单的修复方法 - 只需在你的盒子上安装 nodejs -`apt-get install nodejs`在 ubuntu 上。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-24T19:34:48.397

用这个：

使用以下命令在默认端口**3000中运行**

```
bundle install
rails s 
```

如果要在特定端口号中运行，请使用以下命令，

```
rails s -p 3005 
```

# wpf - WPF 的 Bing 地图，MapLayers/Pushpins 的 ZIndex？

> ID：14025054
> 
> 赞同：4
> 
> 时间：2012-12-24T19:31:06.797
> 
> 标签：wpf, silverlight, xaml, z-index, bing-maps

只是一个前言，我意识到我正在以非 WPF 友好的方式执行我的解决方案。在一个完美的世界里，我会使用 MapItemsControl。

好的，所以我正在为 WPF 使用 Bing Maps 控件。这是我的 Bing 地图 XAML

```
<m:Map CredentialsProvider="12345" 
           x:Name="myMap" UseInertia="True" Loaded="Map_Loaded"
           Width="1920" Height="990" Canvas.Top="110" ZoomLevel="5" Center="39.8282,-98.5795">
    <m:MapLayer x:Name="MyPushPinLayer">                
        <Canvas x:Name="ContentPopup" Visibility="Collapsed" Width="250">
            <Border Background="White" BorderThickness="1" BorderBrush="Gray" Width="250" Padding="5">
                <StackPanel Canvas.Left="20" Canvas.Top="10">
                    <TextBlock x:Name="ContentPopupText" FontSize="18" FontWeight="Bold" Foreground="#CF0000" Width="240" TextWrapping="Wrap">
                        </TextBlock>
                    <TextBlock x:Name="ContentAddress" FontSize="13" Foreground="Black" Width="240"  TextWrapping="Wrap"/>
                    <TextBlock x:Name="ContentQuestions" FontSize="13" Foreground="Black" Width="240" TextWrapping="Wrap" />
                </StackPanel>
            </Border>
        </Canvas>
    </m:MapLayer>
</m:Map> 
```

基本上，这会绘制一张地图，并且我有一个地图播放器，单击时将保存工具提示信息。在我后面的代码中，我从服务中提取数据并按程序将图钉添加到地图中，如下所示：

```
Pushpin pin = new Pushpin();
pin.Location = new Microsoft.Maps.MapControl.WPF.Location(location.latitude, location.longitude);
pin.Content = location.name;
pin.Template = LGPushPinTemplate;

pin.MouseDown += new MouseButtonEventHandler(pin_MouseDown);
myMap.Children.Add(pin); 
```

很简单。但是，因为我在加载地图后在 XAML 和子项中定义弹出层，所以图钉最后出现在地图的子结构中，因此模式信息框出现在任何图钉下方。有没有办法重新排列这些项目的 z 顺序，而无需从地图的子集合中添加/删除所有内容？|

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T03:26:16.053

**这个问题是可以解决的。**我在四处搜索时找到了一些可能的解决方案。见下文。希望您会找到适合您的代码/情况的东西。

1.  你能在最后动态创建弹出层吗？类似于您生成图钉的方式。
2.  将弹出窗口设置`Canvas.ZIndex`为较大的数字。以下是 ZIndex 的更多解决方案：[silverlight control：如何管理 ZIndex？](http://social.msdn.microsoft.com/Forums/en/vemapcontroldev/thread/477b6654-b851-4a68-bb5d-492c8cad3028)

    > zindex 是父画布的附加属性。
    > 
    > 例如，我们在[http://deepearth.codeplex.com](http://deepearth.codeplex.com)中为 Bing 地图 Silverlight 控件创建了一个“enhancedMapLayer”，并将 zindex 添加为如下属性：
    > 
    > ```
    > public int ZIndex
    > {
    >     get { return zIndex; }
    >     set
    >     {
    >         zIndex = value;
    >         if (Parent != null)
    >         {
    >             SetValue(Canvas.ZIndexProperty, zIndex);
    >         }
    >      }
    >  } 
    > ```
    > 
    > 在我们的 infogeometry 类（为所有 OGC 几何类型、点、线串、多边形、多面体等提供标签、气球）中，当我们启动气球时，我们这样做：
    > 
    > ```
    >  var layer = (EnhancedMapLayer) Parent;
    >    if (layer != null)
    >    {
    >        //set to top z-order
    >        prevZIndex = layer.ZIndex;
    >        layer.ZIndex = 1000;
    >        SetValue(Canvas.ZIndexProperty, 1000);
    >        applyTranslations();
    >        balloonShowStoryboard.Begin();
    >        balloonContainer.Visibility = Visibility.Visible;
    >        OnBalloon(new BalloonEventArgs { LayerID = layer.ID, ItemID = ItemID });
    >    } 
    > ```
    > 
    > 通过存储层的前一个`ZIndex`，我们可以在隐藏气球时将其恢复为正确的顺序。
    > 
    > 为了在层之间进行通信，我们使用了 Silverlight 的命令模式，因此我们只需调用：
    > 
    > `Commands.ClosePopupCommand.Execute();`
    > 
    > 要关闭所有其他气球，然后订阅该事件： `Commands.ClosePopupCommand.Executed += ClosePopupCommand_Executed;`

3.  [这个 stackoverflow 答案](https://stackoverflow.com/a/10418942/1085891)提供了一个很好的方法，包括提到[Microsoft 的 Interactive Map SDK](http://www.microsoft.com/maps/isdk/silverlight/#MapControlInteractiveSdk.Tutorials.UIElements.TutorialPositionLocation)。基本上，尝试分离图层。

    ```
     <m:Map CredentialsProvider="Your Key">
            <m:MapLayer>
                <m:MapItemsControl x:Name="ListOfItems"
                            ItemTemplate="{StaticResource LogoTemplate}"
                            ItemsSource="{Binding MyLocalizedEntities}">
                </m:MapItemsControl>
            </m:MapLayer>
            <m:MapLayer>
                <!-- You can have content in multiple layers: Latter layers are infront of former ones. -->
            </m:MapLayer>
        </m:Map> 
    ```

4.  其他可能有帮助的类似 stackoverflow 问题。

    *   [WP7 bing 地图控件中图钉的 ZIndex](https://stackoverflow.com/questions/8148585/zindex-of-pushpins-in-wp7-bing-map-control)
    *   [Bing Maps (Silverlight) 地图 - 通过 XAML 将画布指定为前景](https://stackoverflow.com/questions/4299426/bing-maps-silverlight-maps-specifying-canvas-to-be-at-foreground-through-xam)

# go - 为什么我的 Go Reader 不工作？

> ID：14025056
> 
> 赞同：4
> 
> 时间：2012-12-24T19:31:18.760
> 
> 标签：go

我试图`io.Reader`在 Go 中实现一个非常简单的：

```
package main

import (
    "io"
    "os"
    "strings"
)

type rot13Reader struct {
    r io.Reader
}

// Very trivial function I implemented.
func (r *rot13Reader) Read(p []byte) (int, error) {
    return 5, nil // Return some trivial values for now.
}

func main() {
    s := strings.NewReader(
        "Lbh penpxrq gur pbqr!")
    r := rot13Reader{s}
    io.Copy(os.Stdout, &r)
} 
```

最后，我想`rot13Reader`将[ROT13](http://en.wikipedia.org/wiki/ROT13)应用于它正在读取的字符串，但现在，我只是想创建一个`io.Reader`与正确接口匹配的非常简单的方法。

当我运行这个程序时，它永远不会停止。为什么？我在哪里有无限循环？

* * *

更新：我尝试`data`通过下面的 for 循环改变拼接，但它似乎并没有真正改变拼接。我需要以某种方式复制`data`吗？

```
package main

import (

    "io"
    "os"
    "strings"
)

type rot13Reader struct {
    r io.Reader
}

func (r *rot13Reader) Read(data []byte) (int, error) {
    bytesRead, err := r.r.Read(data)

    // Try to alter data... only without this for loop, text prints in standard output... odd.
    for i := 0; i < bytesRead; i++ {
        data[i] += 13   
    }

    return bytesRead, err
}

func main() {
    s := strings.NewReader(
        "Lbh penpxrq gur pbqr!")
    r := rot13Reader{s}
    io.Copy(os.Stdout, &r)
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-24T19:40:12.493

io.Copy 连续调用您的 Read() 方法。

从文档：

“将副本从 src 复制到 dst，直到在 src 上达到 EOF 或发生错误。它返回复制的字节数和复制时遇到的第一个错误，如果有的话。”

您需要发送 EOF 或返回错误。

这是一个不会无限循环的更新版本。

[http://play.golang.org/p/UCfcw4S8yf](http://play.golang.org/p/UCfcw4S8yf)

```
package main

import (
    "io"
    "os"
    "strings"
    "fmt"
)

type rot13Reader struct {
    r io.Reader
}

// Very trivial function I implemented.
func (r *rot13Reader) Read(p []byte) (int, error) {
    return 5, io.EOF // Return some trivial values for now.
}

func main() {
    s := strings.NewReader(
        "Lbh penpxrq gur pbqr!")
    r := rot13Reader{s}
    io.Copy(os.Stdout, &r)
    fmt.Printf("Done copying...\n")
} 
```

如果您想实际将字符串复制到输出。您需要从 rot13Reader.r 中读取并将其复制到 Read() 方法中的 p 中。

[http://play.golang.org/p/dSCauz0uTw](http://play.golang.org/p/dSCauz0uTw)

```
package main

import (
    "io"
    "os"
    "strings"
    "fmt"
)

type rot13Reader struct {
    r io.Reader
}

// Very trivial function I implemented.
func (r *rot13Reader) Read(p []byte) (int, error) {
    i, err := r.r.Read(p)
    return i, err
}

func main() {
    s := strings.NewReader("Lbh penpxrq gur pbqr!")
    r := rot13Reader{s}
    io.Copy(os.Stdout, &r)
    fmt.Printf("\nDone copying...\n")
} 
```

# asp.net - Ninject 太侵入性？

> ID：14025060
> 
> 赞同：0
> 
> 时间：2012-12-24T19:32:13.090
> 
> 标签：asp.net, ninject

我想将 Ninject for IoC 用于 ASP.NET MVC Web 应用程序。我有以下代码示例：

```
// resides in a MyApplication.Web assembly
public class SomeController { 
  ...
  public ActionResult myControllerAction() {
    Service service = <--- should this be instantiated by Ninject?
    service.doSomeLogic();
    ... 
  }
}

// resides MyApplication.Common assembly
public class Service {
  public void doSomeLogic() {
     ...
  }
} 
```

我担心的是，如果可能的话，我不希望两个程序集都依赖于 Ninject。在我看来，我想让 .Web 项目依赖于 Ninject，而不是 .Common 程序集。

在这里使用什么策略？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-24T19:42:46.360

正在创建的服务不需要依赖于 Ninject。只有网络项目需要这个。您可能应该在控制器（和服务，如果它也有依赖项）上使用构造函数注入。您可以将它们连接到您的 web 项目的 global.asax 中，或者更可能是从那里调用的配置类。使用[MVC 的 Ninject NuGet 包](http://nuget.org/packages/Ninject.MVC3)，按照[示例](http://www.ninject.org/)配置您的服务。

```
public class SomeController { 

  private readonly Service _service;

  public SomeController(Service service)
  {
      _service = service;
  }

  public ActionResult myControllerAction() {
    _service.doSomeLogic();
    ... 
  }
} 
```

# c# - 夹具创建

> ID：14025065
> 
> 赞同：0
> 
> 时间：2012-12-24T19:32:41.093
> 
> 标签：c#, algorithm

从上一篇关于[使用 LINQ（夹具列表）形成锦标赛表的帖子开始](https://stackoverflow.com/questions/7838168/forming-a-tournament-table-with-linq-fixture-list?lq=1)

添加数字列表时，例如

```
var fixture = ListMatches(new List<string> { "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16" }); 
```

当我运行代码时，数字 1 总是第二。例如

```
Round 1
9 v 1

Round 2
10 v 1

Round 3
11 v 1 
```

我正在努力弄清楚如何修改代码，以便每个“回合”中的数字都会从“家庭”和“离开”交替出现。因此，如果 1 是第 2 名，那么在下一轮它将是第 1 名。如果 16 在第 1 轮中是第 1 名，那么它将在第 2 轮中获得第 2 名。

```
Round 1
9 v 1

Round 2
1 v 10

Round 3
11 v 1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T19:40:14.707

这可能是一个愚蠢的建议，但您可以切换偶数轮的游戏顺序。

```
List<List<Tuple<string, string>>> fixture = 
  ListMatches(new List<string> { "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16" });

bool switchOrder = false;
foreach (round in fixture)
{
  if (switchOrder)
  {
     foreach (var tuple in round)
     {
         string temp = tuple.Item1;
         tuple.Item1 = tuple.Item2;
         tuple.Item2 = temp;
     }
  }
  switchOrder = !switchOrder
} 
```

# android - 如何修复缓慢的 Android 模拟器？

> ID：14025068
> 
> 赞同：4
> 
> 时间：2012-12-24T19:33:08.310
> 
> 标签：android, android-emulator

拥有配备 8 GB 内存的 Intel Core i7 笔记本电脑。这是我第一次使用模拟器，AVG 的最佳设置是什么？我希望它很快。

![在此处输入图像描述](../Images/ca39742a30742edeacddad7038357eba.png)

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-24T19:37:40.923

`Intel x86 Emulator Accelator (HAXM)`安装Android SDK Manager 附带的额外内容。安装后：

![在此处输入图像描述](../Images/8a4a67723e6015162a27914f522a80ea.png)

您可以在以下位置找到它：

```
.\android-sdks\extras\intel\Hardware_Accelerated_Execution_Manager\IntelHaxm.exe 
```

![在此处输入图像描述](../Images/fe36ff04c05870b6ce24f2c052c66eb5.png)

如图所示：

> 英特尔 HAXM 需要具有某些硬件功能的英特尔处理器，包括英特尔虚拟化技术 (VT)。

通常，启用 VT 是从 BIOS 完成的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T19:40:21.513

请注意，Android 处理器的架构是 ARM (RISC) 类型而不是 Intel(CISC)，但您可以安装大量功率，例如更大的时钟速率和内存以更快地模拟，最后它与您的功率无关个人电脑。可能对您有用的另一件事是，您可以在每次需要启动时无需关闭模拟器即可进行调试过程。模拟器将在调试期间考虑对测试应用程序的更改。

# javascript - 在jQuery中爆炸字符串

> ID：14025070
> 
> 赞同：47
> 
> 时间：2012-12-24T19:33:17.530
> 
> 标签：javascript, jquery

我通过ajax得到以下结果。

```
row=Shimla|1|http://vinspro.org/travel/ind/ 
```

我想从中获得[http://vinspro.org/travel/ind/ 。](http://vinspro.org/travel/ind/)我使用了查找和拆分功能，但它不起作用。请让我知道我怎样才能得到它？

```
var result=$(row).split('|');
    alert(result); 
```

chrome显示以下错误

```
Uncaught Error: Syntax error, unrecognized expression: Shimla|1|http://vinspro.org/travel/ind/ 
```

* * *

## 回答 #1

> 赞同：130
> 
> 时间：2012-12-24T19:35:47.083

该[`split`方法](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/split)将创建一个数组。所以你需要在你的情况下访问第三个元素..

[（*数组索引为 0*）](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array#Accessing_array_elements)您需要访问`result[2]`以获取 url

```
var result = $(row).text().split('|');
alert( result[2] ); 
```

* * *

您没有给我们足够的信息来确切地知道`row`是什么。因此，根据您获取变量的方式`row`，您可能需要执行以下操作之一。

*   如果`row`是一个字符串那么`row.split('|');`
*   如果它是一个 DOM 元素，那么`$(row).text().split('|');`
*   如果它是一个`input`元素，那么`$(row).val().split('|');`

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-24T19:34:26.063

拆分创建一个数组。您可以使用索引访问各个值。

```
var result=$(row).val().split('|')[2]
alert(result); 
```

**或者**

```
var result=$(row).val().split('|');
alert(result[2]); 
```

如果它是**输入元素**，那么您需要使用`$(row).val()`来获取值..

否则，您将需要使用`$(row).text()`或`$(row).html()`

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-12-24T19:43:38.917

split 函数使用您提供的分隔符分隔文本的每个部分，并且您提供了“|”。所以结果将是一个包含“Shimla”、“1”和“http://vinspro.org/travel/ind/”的数组。你可以操纵它来获得第三个，“http://vinspro.org/travel/ind/”，这是一个例子：

```
var str="Shimla|1|http://vinspro.org/travel/ind/";
var n = str.split('|');
alert(n[2]); 
```

如其他答案所述，此代码会有所不同，具体取决于它是字符串 ($(str).split('|');)、文本框输入 ($(str).val().split('|' );) 或 DOM 元素 ($(str).text().split('|');)。

您也可以使用纯 JavaScript 来获取 9 个字符后的所有内容，即“http://vinspro.org/travel/ind/”。这是一个例子：

```
var str="Shimla|1|http://vinspro.org/travel/ind/";
var n=str.substr(9);
alert(n); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-12-24T19:35:27.857

什么是行？

这些都可能是正确的。

1）我假设您在 javascript 变量“行”中捕获您的 ajax 响应。如果是这样的话，这将成立。

```
var result=row.split('|');
    alert(result[2]); 
```

否则

2) 使用 this where`$(row)`是一个`jQuery`对象。

```
var result=$(row).val().split('|');
    alert(result[2]); 
```

[如另一个答案中所述，您可能必须使用`$(row).val()`or`$(row).text()`或`$(row).html()`等，具体取决于 $(row) 是什么。]

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-01-22T10:05:58.490

如果您输入的 id 如下

```
<input type='text'  id='kg_row1' > 
```

然后你可以在jquery中使用以下split函数来分解/拆分上面的内容

```
 var kg_id = $(this).attr("id");
  var getvalues =kg_id.split("_");
  var id = getvalues[1]; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-07-15T06:47:14.317

**尝试这个**

```
var data = 'allow~5'; 
var result=data.split('~'); 
```

**结果**

```
alert(result[0]); 
```

# c# - 如何使用 Moq 构建此表达式而不会出现方法组错误？

> ID：14025071
> 
> 赞同：5
> 
> 时间：2012-12-24T19:33:18.837
> 
> 标签：c#, testing, fluent-nhibernate, moq, mspec

我需要在给定集合上运行表达式以确定代码中的表达式是否正确编写。出于示例的目的，我将省略一些不必要的上下文，但如果有人需要它，只需发表评论，我将编辑问题并添加您需要的任何内容。

假设我有以下内容：

```
public interface IRepository
{
    IQueryable<T> Query<T>(Expression<Func<T, bool>> expression);
}

public class Repository : IRepository
{
    public IQueryable<T> Query<T>(Expression<Func<T, bool>> expression)
    {
        return _session.Query<T>(expression);
    }
} 
```

我想写一个如下的规范：

```
internal class when_executing_some_query : given_some_repository_context
{
    Establish context = () => 
    {
         IQueryable<SomeObject> objects = new List<SomeObject>
         {
             SomeObject1,
             SomeObject2,
             SomeObject3,
         }.AsQueryable();

         _expectedList = new List<SomeObject>
         {
             SomeObject1,
             SomeObject2,
         };

         MockedRepository.Setup(x => x.Query<SomeObject>(Moq.It.IsAny<Expression<Func<SomeObject, bool>>>)
             .Callback<Expression<Func<SomeObject, bool>>>(expression => _actualExpression = expression);
    }

    Because of = () => _actualList = objects.Select(_actualExpression).ToList();

    It should_execute_on_queryable_and_return_the_expected_items = () => //compare _expectedList with _actualList
} 
```

但是，我`Moq.It.IsAny<Expression<Func<SomeObject, bool>>>`说的构建错误

> 'Project.Domain.IRepository.Query(System.Linq.Expressions.Expression>)' 的最佳重载方法匹配有一些无效参数

和

> 参数 1：无法从“方法组”转换为
> “System.Linq.Expressions.Expression>”`

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-24T19:59:12.917

要修复这样的错误，您需要调用该方法，而不是将其作为参数传递。只需将您的电话更改为：

```
Moq.It.IsAny<Expression<Func<SomeObject, bool>>> 
```

至：

```
Moq.It.IsAny<Expression<Func<SomeObject, bool>>>() 
```

注意括号。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-24T20:01:51.043

基于[这个答案](https://stackoverflow.com/a/2751981/135114)，看起来你`()`以后需要，例如`It.IsAny<Expression<Func<SomeObject, bool>>>()`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-24T20:15:52.380

您在上面包含了一个具体的存储库，但它从未在本规范中使用，所以我相信它只是为了举例。此外，该规范有一个模拟存储库和一个设置查询方法，但它从未被执行。该规范应该测试使用存储库的具体事物。然后您可以比较传入查询方法的表达式。

表达式很棘手，但使用模拟更是如此。我所做的是使用 Moq 的验证，然后使用 Moq 的 Moq.It.Is<> 来确保验证仅在表达式匹配时通过。这是一个例子：

```
_repo.Verify(x=>x.Query(Moq.It.Is<Expression<Func<SomeObject, bool>>>(exp=>exp.Compile().Invoke(_exampleSomeObject))); 
```

基本上，我在这里告诉 Moq，只有在给定的实际表达式适用于 _exampleSomeObject 时，验证才会通过。

我在我的 Iphone 上打字，所以如果代码没有立即编译，我深表歉意。

只是一个建议：你的因为部分应该表达一些导致结果的动作。现在，它看起来像你因为总线只处理以前的结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-24T20:25:35.463

在您的设置中，您正在传递 SomeObject。
在您的回调中，您要求提供 InstanceHealthReport。

即使 InstanceHealthReport 是 SomeObject 的子类，我相信它们需要在设置和回调中匹配。

希望有帮助。

科林

# php - 如果页面被访问超过 5 次而忽略某些页面，则将访问者重定向到不同的 URL。

> ID：14025077
> 
> 赞同：1
> 
> 时间：2012-12-24T19:33:51.127
> 
> 标签：php, redirect, count

好的，我正在使用页数来计算用户访问 profile.php 的时间。如果他们没有登录，他们只能查看 5 个用户的个人资料。

每个配置文件都有一个 profile.php 的扩展名，例如 profile.php?id=1 或 id=2 等。

页数工作正常，基本上，如果用户尝试点击超过 5 个配置文件，它会将他们重定向到 limit.php 页面，该页面告诉用户他们已达到限制并登录以查看更多信息。

我已将其设置为排除下面列出的一些配置文件。

基本上问题出在哪里，如果用户单击排除的配置文件，例如 99999 或 99998，它不会将用户重定向到 limit.php 页面。这很好，因为我希望它排除这些配置文件，但是，如果用户单击另一个配置文件（例如 1 或 8 等）并且用户尝试重新访问 99999 或 99998，那么它不会让它们重定向它们吗？

谁能告诉我如何编辑脚本以仍然允许用户访问配置文件 99999 或 99998，即使在他们访问其他配置文件之后或期间他们访问其他配置文件而不重定向它们？

希望这很清楚。谢谢

```
 <?php 

    !session_id() ? session_start() : null;
    if(!isset($_SESSION['page_access_count'])){
        $_SESSION['page_access_count'] = 1;
    }elseif($_SESSION['page_access_count'] >= 6){
        // redirect to signup page
        header('Location: limit.php');
        exit;
    }

      $free_profiles = array(99999,99998,99997,99996,99995,99994,99993); // array of profile IDs to exclude

    if (! in_array($_GET['id'], $free_profiles)) {
      $_SESSION['page_access_count']++;
    }

        ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T19:42:47.037

我将限制验证逻辑包装在一个名为`verify_profile_visit_limit`. 现在我们可以使用（因为它是一个查询字符串）获取页面的“id”，并通过使用 function退出函数来`$_GET`跳过限制检查它是否在数组中 。`$free_profile``verify_profile_visit_limit``return`

```
!session_id() ? session_start() : null;

verify_profile_visit_limit();

function verify_profile_visit_limit(){
    $free_profiles = array(99999,99998,99997,99996,99995,99994,99993);

    if(in_array($_GET["id"], $free_profiles)) return;

    if(! isset($_SESSION["page_access_count"])){
        $_SESSION["page_access_count"] = 0;
    }

    $_SESSION["page_access_count"]++;

    if($_SESSION["page_access_count"] > 5){
        header("Location: limit.php");
        exit();
    }
} 
```

# c# - 带标签的拖放面板

> ID：14025083
> 
> 赞同：1
> 
> 时间：2012-12-24T19:34:46.383
> 
> 标签：c#, winforms

我正在使用具有拖放功能的 WinForms。现在它是基于事件的，我可以毫无问题地拖动面板并将标签保持在面板上。但是，当我单击**label**时，在本例中是一个数字，我无法让它同时引发标签和面板的拖放事件，因此无法移动任何内容。

我解决此问题的想法是将标签（.Text 始终为 1-9）的坐标绑定到标签坐标。

我的另一个想法是创建一个自定义 UI 组件，该组件将具有像 Tile(string labelText) 这样的构造函数，它会“隐藏”标签存在的事实，所以我只需要使用面板的拖放事件。

处理这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T19:39:52.400

也许是**这样的**：

```
private void label1_MouseDown(object sender, MouseEventArgs e)
{
    panel1_MouseDown(null, null);
} 
```

# cakephp - 基于 SaaS 的 CakePHP 动态数据库登录的最佳方法

> ID：14025086
> 
> 赞同：1
> 
> 时间：2012-12-24T19:34:48.990
> 
> 标签：cakephp, cakephp-2.0, cakephp-2.1

我正在尝试决定使用 CakePHP 应用程序设计基于 SaaS 的系统的最佳方法。我目前正在使用基于 Croogo 的 CakePHP 应用程序。我们一直在简单地为每个客户端部署一个应用程序。我们想要做的是设置一个单一的环境，在该环境中，基于初始登录，使用不同的（客户端）数据库。因此，理想情况下，CakePHP 应用程序将显示一个登录屏幕（使用默认的客户端数据库）。基于登录，根据返回结果动态切换正在使用的数据库。这样它是一个应用程序，没有子域或文件夹。我什至不确定这是否可能。

我认为这会发生在UsersController“登录后”挂钩的某个地方，切换数据库......？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T13:46:19.493

那么你应该注意到有一个类 ConnectionManager 处理模型和数据库之间的链接。此类使用 config/database.php 文件的 DATABASE_CONFIG 类中提供的数据。

我会说一个不错的选择是在建立连接之前读取会话。例如在 DATABASE_CONFIG 的 __construct 上。就像是：

```
class DATABASE_CONFIG {

public $default = array(
    'datasource' => 'Database/Mysql',
    'persistent' => false,
    'host' => 'localhost',
    'login' => 'root',
    'password' => 'password',
    'database' => 'database',
    'prefix' => '',
    //'encoding' => 'utf8',
);

public $test = array(
    'datasource' => 'Database/Mysql',
    'persistent' => false,
    'host' => 'localhost',
    'login' => 'user',
    'password' => 'password',
    'database' => 'test_database_name',
    'prefix' => '',
    //'encoding' => 'utf8',
);
public __construct(){
    App::uses('CakeSession');
    $database = CakeSession::read('Auth.User.database');
    if ($database){
        $this->default['database'] = $database;
    }

}

} 
```

# c++ - 使用标准模板库列表或矢量和多图创建电话目录

> ID：14025087
> 
> 赞同：0
> 
> 时间：2012-12-24T19:34:51.860
> 
> 标签：c++

我有一个简单的电话簿，但我想修改它，以便我可以搜索姓氏的列表，它应该返回具有相同姓氏的名字。一个人可以有多个号码，一个号码可以属于不止一个人（家庭成员）。一般情况下，电话号码可以包含非数字字符，例如，如果我有一个如下所示的姓名列表

```
john williams
smart williams
hendrix james
drey williams 
```

如果我输入 williams 或搜索 williams 它应该返回

```
john williams
smart willams
drey williams 
```

我想用`Map<String,List<String>>.`

```
class name {
  string str;
public:
  name() { 
      str = ""; 
  }
  name(string s) { 
      str = s; 
  }
  string get() { 
      return str; 
  }
};

// Define less than relative to name objects.
bool operator<(name a, name b){
   return a.get() < b.get();
}

class surname {
  string str;
public:
  surname() { 
      str = ""; 
  }
  surname(string s) { 
      str = s; 
  }
  string get() { 
      return str; 
  }
};

int main()
{
  map<name, surname> directory;

  directory.insert(pair<name, surname>(name("James"), surname("williams")));
  directory.insert(pair<name, surname>(name("Coz"), surname("williams")));
  directory.insert(pair<name, surname>(name("James"),  surname("trues")));
  directory.insert(pair<name, surname>(name("Tni"),surname("mutton")));

  // given a name, find number
  string str;
  cout << "Enter name: ";
  cin >> str;

  map<name, surname>::iterator p;

  p = directory.find(name(str));
  if(p != directory.end()) 
    cout << "surname: " <<  p->second.get();
  else
    cout << "Name not in directory.\n";
    system("pause");

  return 0;
} 
```

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T20:49:09.310

该地图是一个键/值对容器，这意味着您必须定义什么是您的键和什么是您的值，在这种特殊情况下，您希望姓氏作为键，以及与该姓氏相关的名称列表一个值。正如您已经注意到的那样，您可以使用向量图来实现这一点，其中向量是您的值：

```
std::map<std::string, std::vector <std::string> > directory; 
```

这是您想要实现的一个工作示例（我将名称和姓氏结构替换为字符串，因为我看不到使用它们的意义，但您可以根据需要将其更改回来）

```
#include <string>
#include <map>
#include <vector>
#include <ostream>
#include <iostream>

int main()
{
    std::map<std::string, std::vector <std::string> > directory;

    directory["williams"].push_back("James");
    directory["williams"].push_back("Coz");
    directory["trues"].push_back("James");
    directory["mutton"].push_back("Tni");

    // given a name, find number
    std::string str;
    std::cout << "Enter surname: ";
    std::cin >> str;

    std::map<std::string, std::vector <std::string> >::iterator p;

    p = directory.find(str);
    if(p != directory.end())
    {
      std::string key = p->first;
      std::vector<std::string> names = p->second;

      for (int i = 0; i < names.size(); ++i)
         std::cout << key << " " << names[i] << std::endl;

    }
    else
    {
        std::cout << "Name not in directory.\n";
    }

    return 0;
} 
```

对于输入威廉姆斯，这将输出：

> ```
> Enter surname: williams
> williams James
> williams Coz 
> ```

要为“williams”添加更多名称，您只需将名称推回该向量：

```
 directory["williams"].push_back("Luis");
    directory["williams"].push_back("Pedro");
    directory["williams"].push_back("Juan"); 
```

希望能帮助到你。

# c++ - 在 C++ 中使优先级队列限制其内存

> ID：14025088
> 
> 赞同：2
> 
> 时间：2012-12-24T19:34:55.923
> 
> 标签：c++, stl, priority-queue, stdvector

我`priority_queue<unsigned long,vector<unsigned long>,greater<unsigned long> >`在 C++ 中使用 a 并且我的内存限制为 16MB。我的程序只需要 10MB，但一旦达到 8653464 字节，它就会尝试将其容量翻倍并抛出`bad_alloc`.

有没有办法使用我当前的实现来阻止这种情况？`priority_queue`如果我切换到`deque`[from a `vector`] ，a还能有 log(n) 时间吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-24T19:47:09.110

切换到`deque`是非常明智的方法。它按固定数量增长，而不是 x2 增长`vector`。并且复杂性应该保留`O(log N)`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T19:44:03.550

当然。 `priority_queue`是一个容器适配器，默认基于`vector`. 我认为解决您的问题的最简单方法是创建一个向量的子类，该子类拒绝变得太大并且在接近极限时不会加倍，而只是达到极限。您也可以使用常规向量类，但使用自定义分配器，但这可能需要更多工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-24T19:50:25.447

`vector`提供比 更糟糕的复杂性`deque`，并且`deque`的增长更加可预测和可控。如果您不需要在上帝的绿色地球和几个蓝色地球上绝对最快的迭代（或对 C 阵列的兼容性），那么`deque`它是适用于所有用途的卓越容器。

# c++ - 我对这个赋值运算符错误的假设是否正确？

> ID：14025089
> 
> 赞同：2
> 
> 时间：2012-12-24T19:34:57.000
> 
> 标签：c++, memory-leaks, assignment-operator

Richard Gillam 在他的[“赋值运算符的剖析”中，](http://icu-project.org/docs/papers/cpp_report/the_anatomy_of_the_assignment_operator.html)当他在论文的开头说了以下内容时，他可能做出了错误的陈述：

“这个问题的一个正确答案应该是这样的：”

```
TFoo&TFoo::operator=(const TFoo& that)
{
    if (this != &that)
    {
        TBar* bar1 = 0;
        TBar* bar2 = 0;

        try
        {
            bar1 = new TBar(*that.fBar1);
            bar2 = new TBar(*that.fBar2);
        }
        catch (...)
        {
            delete bar1;
            delete bar2;
            throw;
        }

        TSuperFoo::operator=(that);
        delete fBar1;
        fBar1 = bar1;
        delete fBar2;
        fBar2 = bar2;
    }
    return *this;
} 
```

我认为作者是错误的，因为如果`TSuperFoo::operator=()`抛出，`bar1`并且`bar2`会泄漏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T19:48:59.890

如果它看起来像这样，就不会有内存泄漏：

```
Tbar* pBar = NULL;

try
{
    pBar = new Tbar();
}
catch (...)
{
    delete pBar;    // clean memory if it was allocated
    throw;          // error was not handled properly, throw it to caller
}

delete pBar;        // no exception was caught, clean the memory 
```

但是，如果在 last 之前`delete`，还有另一个可能引发异常的代码，那么您是对的，并且确实存在导致内存泄漏的可能路径，因为在这种情况下，分配的内存将永远不会被清理。

令人遗憾的是，人们编写的代码没有使用这种语言提供的强大功能来避免这种丑陋的内存管理。通常，具有自动存储持续时间的对象就足够了，并且您会发现自己遵循[RAII](http://en.wikipedia.org/wiki/Resource_Acquisition_Is_Initialization)习惯用法，或者在需要动态分配的情况下，最好将这些裸指针与一些对象包装起来......智能指针有很大帮助。

# android - 如何在同一请求中上传带有文本的照片？

> ID：14025095
> 
> 赞同：2
> 
> 时间：2012-12-24T19:35:38.983
> 
> 标签：android, facebook, sdk

我正在使用 Eclipse / Android - Facebook SDK，我需要在同一请求中上传带有文本的照片。SDK中有一个示例，但它发布的照片​​没有任何文字来解释图片。

任何机构都知道如何做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-26T22:40:10.733

我在一周内对 android 和 facebook sdk 进行编程，由于没有人回答我的问题并包括对我的帖子投反对票，我自己解决了 SDK 限制，并添加了一种方法来实现带有标题的照片的 ulpload。下面是解决方案：

将此代码插入 com.facebook -> request.java

```
public static Request newMyUploadPhotoRequest(Session session,  Bitmap image, String caption,String description,
        Callback callback)  {
    Bundle parameters = new Bundle(3);
    parameters.putParcelable(PICTURE_PARAM, image);
    parameters.putString("caption",caption);
    parameters.putString("description",description );

    return new Request(session, MY_PHOTOS, parameters, HttpMethod.POST, callback);

} 
```

从您的活动中调用方法

```
 Bitmap image = BitmapFactory.decodeFile(picturePath);
        Request request = Request.newMyUploadPhotoRequest(Session.getActiveSession(), image,"Teste Caption", "teste description", new Request.Callback() {
            @Override
            public void onCompleted(Response response) {
                showPublishResult(getString(R.string.photo_post), response.getGraphObject(), response.getError());
            }
        });
        Request.executeBatchAsync(request); 
```

# objective-c - 将日期格式从 12/12/12 更改为 2012-12-12 ios6

> ID：14025097
> 
> 赞同：2
> 
> 时间：2012-12-24T19:36:00.187
> 
> 标签：objective-c, ios, ios6, nsdate, nsdateformatter

我试过了 ：

```
 NSDateFormatter *dateFormatter = [[NSDateFormatter alloc]init];
  [dateFormatter setDateFormat:@"MM/dd/yyyy"];
  NSDate *dateCheck = [dateFormatter dateFromString:@"12/12/12"];
  NSLog(@"Date = %@", dateCheck); 
```

输出值为：`Date = 2012-12-11 18:30:00 +0000`

我应该如何实现上述结果我不知道问题出在哪里。请帮助。我将非常感谢您的帮助。在此先感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-24T19:40:50.440

试试这个，

```
NSDateFormatter *dateFormatter = [[NSDateFormatter alloc]init];
[dateFormatter setDateFormat:@"MM/dd/yy"];
NSDate *dateCheck = [dateFormatter dateFromString:@"12/12/12"];
NSLog(@"Date = %@", dateCheck);

[dateFormatter setDateFormat:@"yyyy-MM-dd"];
NSString *dateString = [dateFormatter stringFromDate:dateCheck];
NSLog(@"dateString = %@", dateString); 
```

**输出：**

```
dateString = 2012-12-12 
```

`@"MM/dd/yyyy"`代表 12/12/2012 而不是 12/12/12。如果要转换为2012-12-12，则需要将日期格式设置为`@"yyyy-MM-dd"`，然后再转换为字符串，如上图所示。

有关日期格式的更多详细信息，请查看此[Unicode 日期格式模式。](http://unicode.org/reports/tr35/tr35-6.html#Date_Format_Patterns)

这里的第一次转换是将字符串更改为日期，然后我们`@"yyyy-MM-dd"`用于以所需格式再次转换为字符串。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-24T19:42:34.760

如果您想要以特定方式格式化日期，您可以继续使用`NSDateFormatter`. 只需添加. 另外，正如 ACB 所指出的，如果要使用，则需要转换 from ，否则需要使用`[dateFormatter setDateFormat:@"yyyy-MM-dd"];
NSString *string = [dateFormatter stringFromDate:dateCheck];
NSLog(@"Date = %@", string);`

`@"12/12/2012"``MM-dd-yyyy``MM-dd-yy`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-24T19:42:49.197

您需要两个格式化程序。一个将原始字符串转换为`NSDate`（就像您现在一样），第二个将原始字符串转换`NSDate`为具有所需格式的新字符串。

请注意，当您登录为 时`NSDate`，它将始终以您所看到的格式显示。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-24T19:47:49.590

```
`Date = 2012-12-11 18:30:00 +0000` 
```

从

```
NSDateFormatter *dateFormatter = [[NSDateFormatter alloc]init];
[dateFormatter setDateFormat:@"MM/dd/yy"];
NSDate *dateCheck = [dateFormatter dateFromString:@"12/12/12"];
NSLog(@"Date = %@", dateCheck);

[dateFormatter setDateFormat:@"yyyy-MM-dd"];
NSString *dateString = [dateFormatter stringFromDate:dateCheck];
NSLog(@"dateString = %@", dateString); 
```

你得到正确的日期。由于时间戳和语言环境不同，因此您无法看到 2012-12-12...

# windows - 在富编辑控件中搜索文本（winapi 'riched20.dll'）

> ID：14025098
> 
> 赞同：0
> 
> 时间：2012-12-24T19:36:04.053
> 
> 标签：windows, winapi

我正在使用`'riched20.dll'`Windows 内置库为 WIN32 程序制作丰富的编辑控件。该程序只是一个文本编辑器，我现在必须实现查找文本功能。我要解决的问题是如何遍历富编辑控件中的文本。我想在控件中找到匹配的文本并突出显示它（即用蓝色背景选择它，就像用鼠标或 shift 键选择它一样）。我已经在网上搜索但没有成功。

我可以轻松地在 C#.NET 中完成所有这些任务。我现在被Win32困住了。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T19:46:51.520

对于 Win32 富编辑控件，要搜索文本，您需要使用[`EM_FINDTEXT`](http://msdn.microsoft.com/en-us/library/windows/desktop/bb788009.aspx)或[`EM_FINDTEXTEX`](http://msdn.microsoft.com/en-us/library/windows/desktop/bb788011.aspx)。或者，如果您使用的是 Unicode，则带有`W`后缀的变体。

要选择文本，请使用[`EM_SETSEL`](http://msdn.microsoft.com/en-gb/library/windows/desktop/bb761661.aspx)消息。

Rich Edit 控件的[参考文档](http://msdn.microsoft.com/en-us/library/windows/desktop/ff486019.aspx)列举了该控件的全部功能。

# c++ - DAWG 与基数树？

> ID：14025103
> 
> 赞同：1
> 
> 时间：2012-12-24T19:36:42.980
> 
> 标签：c++, data-structures

哪种数据结构更适合创建基于字典的文本编辑器？DAWG 还是基数树？请根据创建的难易程度和速度进行分析；如果可以的话，还提供任何关于我如何创建这些的链接？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T19:44:12.410

这取决于您要达到的目标，尽管：-

DAWG 具有内存利用率的优势。

基数树在 O(k) 时间内执行插入、删除和搜索，在平衡树中是 O(logn)。

# php - 除了使用 include_once/require_once 之外，防止 PHP 类重新定义的最有效方法是什么？

> ID：14025104
> 
> 赞同：1
> 
> 时间：2012-12-24T19:36:59.750
> 
> 标签：php, class

或者换句话说，是否有用于完成此任务的 C++ 指令#ifndef、#define 的 PHP 等效项？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T20:30:00.193

好吧，如果您真的喜欢条件包括来减少“PHP 符号表”，您可以像这样编写 C 预处理器指令：

```
IF ( !defined( 'MY_CONSTANT' ):
  define( 'MY_CONSTANT', 'PHP C like defined' );
ENDIF;

IF ( !defined( 'header_php' ):
  define( 'header_php', 'PHP "header" defined' );
  include( 'header.php' );
ENDIF;

// you can do this for class, functions, variables etc 
```

但最后将有额外的 cosntants 符号定义为空。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-24T19:49:22.057

我认为这会起作用：

```
<?php

if(!class_exists("MyClass")):

class MyClass
{
    ...
}

endif;

?> 
```

这避免了 require_once/include_once 函数带来的开销。

# ruby-on-rails - 使用黄瓜并模拟重定向到贝宝并返回

> ID：14025106
> 
> 赞同：1
> 
> 时间：2012-12-24T19:37:30.390
> 
> 标签：ruby-on-rails, paypal, cucumber, webmock

我有一个黄瓜测试，测试用户添加贝宝预先批准。在我的控制器中，我重定向到贝宝预批准网址。

```
if @payment_method.valid?
  key = @payment_method.preapprove_paypal
  redirect_to URI.encode("#{Rails.configuration.paypal.preapproval_link}#{key}")
end 
```

因此，在我的黄瓜测试中，我想将重定向存根（使用 Webmock）以避免在我的测试中依赖于贝宝网站，并让它像成功一样回到我的应用程序。

```
stub_request(:any, /.*paypal.*/).to_return{current_url} 
```

但是，这似乎给了我一个超时。我不太确定我接近它的方式是否正确。有什么想法我可能做错了吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-25T01:28:31.917

所以我通过将重定向移动到一个单独的方法来解决它：

```
def redirect_to_paypal_preapproval(key)
 redirect_to URI.encode("#{Rails.configuration.paypal.preapproval_link}#{key}") 
end 
```

然后在我的黄瓜测试中我放了：

```
PaymentMethodsController.stub(:redirect_to_paypal_preapproval)
  .and_return(visit payment_methods_path) 
```

这似乎将它自己重定向回我的应用程序，就好像批准成功一样

# iphone - 在 iOS 上以 pkcs#1 格式导出公钥？

> ID：14025110
> 
> 赞同：3
> 
> 时间：2012-12-24T19:38:11.540
> 
> 标签：iphone, objective-c, ios, encryption, public-key-encryption

`SecKeyGeneratePair`如何导出以 pkcs#8 格式生成的 RSA 公钥？

我目前正在编写一个 iOS 应用程序，该应用程序需要能够生成 RSA 私钥/公钥对、签署一段内容并以 pkcs#8 格式导出公钥以发送到服务器。到目前为止，我正在使用 生成我的配对`SecKeyGeneratePair`，使用 检索我的公钥和私钥`SecItemCopyMatching`并使用 签名`SecKeyRawSign`，这一切似乎都工作正常，并且签名正在验证用于测试`SecKeyRawVerify`。但不幸的是，我对如何在 pkcs#8 中正确导出公钥一无所知。

预先感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T21:21:48.690

根据经验，如果您需要做一些看起来不受 iOS 安全框架支持的事情，那么构建您自己的 OpenSSL 副本并将其链接到您的项目中。尽管 iOS 显然在内部使用了 OpenSSL，但很少向应用程序开发人员公开。

抓住许多 OpenSSL-for-iOS 项目之一，例如[这个](http://atastypixel.com/blog/easy-inclusion-of-openssl-into-iphone-app-projects/)，然后开始吧。

[直接使用 OpenSSL 有许多优点，其中一些是http://openssl.org](http://openssl.org)上的大量示例代码和在线文档，您几乎可以做任何与加密相关的事情。

**更新**：现在有多个版本的 OpenSSL 可通过 Cocopods 获得：[OpenSSL](https://github.com/CocoaPods/Specs/blob/master/OpenSSL/1.0.1/OpenSSL.podspec)和[OpenSSL-Universal](https://github.com/CocoaPods/Specs/blob/master/OpenSSL-Universal/1.0.1.f/OpenSSL-Universal.podspec)，这将使将 OpenSSL 导入您的 iOS 或 OSX 项目变得更加容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-26T04:10:45.437

[http://blog.wingsofhermes.org/?p=42](http://blog.wingsofhermes.org/?p=42)上描述的过程允许轻松导出格式正确的 rsa 公钥，而无需添加外部库。简而言之，iOS 做得很好，只是它在没有正确编码的情况下导出密钥。

这不是最容易找到的帖子，因此希望此链接可以在将来节省一些时间。

# ruby-on-rails - 我应该如何更好地组织 Rails 应用程序中的相关数据表？

> ID：14025114
> 
> 赞同：1
> 
> 时间：2012-12-24T19:38:48.657
> 
> 标签：ruby-on-rails

我有一个用设计生成的用户模型。

现在我希望每个用户都有其他列

```
- balance
- paperclip logo
- website
- address
- phone
etc 
```

组织此类数据的最佳方式是什么？

我应该制作单独的表（如电话表、地址表、用户徽标表等）并建立一对一的关系吗？

我听说把所有东西都放在一张桌子上很糟糕。

很高兴听到一些意见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T20:02:33.687

**把所有东西放在一张桌子上：**

*   好处：无需join即可获取用户模型，节省查询时间
*   缺点：用户模型会包含大量数据，所以如果你持有一个包含 1000 个用户的数组，他们会消耗内存

**分离属性：**

*   好处：用户模型将消耗很少的内存（只有电子邮件、姓名等基础知识......）
*   缺点：有很多连接来获取有关用户的信息

我认为您的选择很大程度上取决于您的应用程序的功能，因此如果您总是需要有关用户的所有信息，那么将所有内容放在一个表中，否则您可以分离数据。无论如何，您可以同时使用这两种方法，这样您就可以将`user`模型和另一个模型命名为`user_data`，并且该模型将保存所有额外信息，例如`phone`,`address`等......这样您就可以从这两种方法中获得好处。

# css - 处理阿拉伯语网站的 LTR 和 RTL（国际化）

> ID：14025117
> 
> 赞同：4
> 
> 时间：2012-12-24T19:39:00.667
> 
> 标签：css, wordpress, right-to-left, qtranslate

我正在 Wordpress 中创建一个网站，它基本上是一个英文网站，但是当用户点击翻译时，它会将其翻译成阿拉伯语。有问题`ltr`，`rtl`我该如何解决。我现在正在使用 qtranslate 插件。情况也是如此与乌尔都语，库尔德语。任何可以帮助我的人请查看附件图片![在此处输入图像描述](../Images/972b4b3c087e250aba0a02fa8ff9e5d8.png) 谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T20:47:28.837

`<html>`这个 wordpress 插件似乎在标签中插入了语言方向和名称。像这样：

```
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US"> 
```

或者

```
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="ar-AR"> 
```

如果我了解您，该插件不会为语言呈现正确`direction`的属性。`ltr`

## 第一个选项

一种选择是使用 javascript 来解决这个问题。简单地我们`rtl`通过它们的 ISO 代码检测语言（这里是`ar`阿拉伯语）并向`body`标签添加一个类

```
jQuery(function(){

    jQuery("html[lang=ar]").attr("dir", "rtl")
            .find("body").addClass("right-to-left");

}); 
```

现在您可以通过像这样为该类添加前缀来设置主题 css 文件中的元素样式`right-to-left`：（这只是一个示例）

```
body.right-to-left my-element li {
    float:right;
    direction: rtl;
} 
```

.

## 第二种选择

正如其他答案所建议的那样，使用 php 将该类名插入到`body`页面的标签中。在您的主题中打开您的`header.php`文件并编辑此行：

```
<body class=" <?php if($_GET["lang"] == "ar") echo "right-to-left"; ?> "> 
```

现在使用相同的 css 来设置元素的样式

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T20:42:30.457

一种简单但低效的方法是在主题的头文件中使用 PHP 检查语言，如果它是阿拉伯语或其他 RTL 语言，您可以将 dir="rtl" 添加到 HTML 或任何您想要的标签中。我意识到 qTranslate 有一个 GET 方法模式，并`?lang=ar`在 URL 中添加了类似的东西。所以你可以很容易地用PHP检查它：`if ($_GET["lang"]=='ar') ...`

**编辑**

您可以在主题的头文件中添加类似的内容。（您可以从 path_to_wordpress/wp-content/themes/your_theme/header.php 找到此文件），它可以称为**header.php**或类似的名称。

找到`<body>`标签并将这一行添加到末尾（在**>**符号之前）：

```
<?php if($_GET["lang"] == "ar") echo "dir='rtl'"; ?> 
```

# php - 如何添加到 SimpleXML 对象

> ID：14025118
> 
> 赞同：0
> 
> 时间：2012-12-24T19:39:19.467
> 
> 标签：php, simplexml

尝试使用下面的代码将产品添加到 $products SimpleXML 对象时，我收到错误警告：文件中存在非法偏移类型，无法找出问题所在。

```
 $fields = array(
            $o->order_id => 'order_id',
            $o->order_address_id => 'order_address_id',
            $o->price_ex_tax => 'price_ex_tax' ,
            'DISCS' => 'sku',
             '1' => 'quantity'
        );                            

        $products->addChild('product');
        array_walk_recursive($fields, array ($products, 'addChild')); 
```

这是我对 $products 使用 print_r 的 SIMPLEXML 对象：

```
SimpleXMLElement Object
(
    [product] => Array
    (
        [0] => SimpleXMLElement Object
            (
                [id] => 23
                [order_id] => 110
                [product_id] => 63477
                [order_address_id] => 11
                [name] => Dead Sea Treasures Foot Cream
                [sku] => 703
                [type] => physical
                [base_price] => 20.0000
                [price_ex_tax] => 20.0000
                [price_inc_tax] => 20.0000
                [price_tax] => 0.0000
                [base_total] => 40.0000
                [total_ex_tax] => 40.0000
                [total_inc_tax] => 40.0000
                [total_tax] => 0.0000
                [weight] => 0.5
                [quantity] => 2
                [base_cost_price] => 0.0000
                [cost_price_inc_tax] => 0.0000
                [cost_price_ex_tax] => 0.0000
                [cost_price_tax] => 0.0000
                [is_refunded] => false
                [refund_amount] => 0.0000
                [return_id] => 0
                [wrapping_name] => SimpleXMLElement Object
                    (
                    )

                [base_wrapping_cost] => 0.0000
                [wrapping_cost_ex_tax] => 0.0000
                [wrapping_cost_inc_tax] => 0.0000
                [wrapping_cost_tax] => 0.0000
                [wrapping_message] => SimpleXMLElement Object
                    (
                    )

                [quantity_shipped] => 0
                [event_name] => NULL
                [event_date] => SimpleXMLElement Object
                    (
                    )

                [fixed_shipping_cost] => 0.0000
                [ebay_item_id] => SimpleXMLElement Object
                    (
                    )

                [ebay_transaction_id] => SimpleXMLElement Object
                    (
                    )

                [option_set_id] => NULL
                [parent_order_product_id] => NULL
                [is_bundled_product] => false
                [bin_picking_number] => SimpleXMLElement Object
                    (
                    )

                [applied_discounts] => SimpleXMLElement Object
                    (
                        [discount] => SimpleXMLElement Object
                            (
                                [id] => 1
                                [amount] => 4
                            )

                    )

                [product_options] => SimpleXMLElement Object
                    (
                    )

                [configurable_fields] => SimpleXMLElement Object
                    (
                    )

            )

        [1] => SimpleXMLElement Object
            (
                [id] => 24
                [order_id] => 110
                [product_id] => 63398
                [order_address_id] => 11
                [name] => Naot Matai
                [sku] => 11410-37-577
                [type] => physical
                [base_price] => 166.0000
                [price_ex_tax] => 166.0000
                [price_inc_tax] => 166.0000
                [price_tax] => 0.0000
                [base_total] => 166.0000
                [total_ex_tax] => 166.0000
                [total_inc_tax] => 166.0000
                [total_tax] => 0.0000
                [weight] => 2
                [quantity] => 1
                [base_cost_price] => 0.0000
                [cost_price_inc_tax] => 0.0000
                [cost_price_ex_tax] => 0.0000
                [cost_price_tax] => 0.0000
                [is_refunded] => false
                [refund_amount] => 0.0000
                [return_id] => 0
                [wrapping_name] => SimpleXMLElement Object
                    (
                    )

                [base_wrapping_cost] => 0.0000
                [wrapping_cost_ex_tax] => 0.0000
                [wrapping_cost_inc_tax] => 0.0000
                [wrapping_cost_tax] => 0.0000
                [wrapping_message] => SimpleXMLElement Object
                    (
                    )

                [quantity_shipped] => 0
                [event_name] => NULL
                [event_date] => SimpleXMLElement Object
                    (
                    )

                [fixed_shipping_cost] => 0.0000
                [ebay_item_id] => SimpleXMLElement Object
                    (
                    )

                [ebay_transaction_id] => SimpleXMLElement Object
                    (
                    )

                [option_set_id] => 32446
                [parent_order_product_id] => NULL
                [is_bundled_product] => false
                [bin_picking_number] => SimpleXMLElement Object
                    (
                    )

                [applied_discounts] => SimpleXMLElement Object
                    (
                    )

                [product_options] => SimpleXMLElement Object
                    (
                        [option] => Array
                            (
                                [0] => SimpleXMLElement Object
                                    (
                                        [id] => 57
                                        [option_id] => 49564
                                        [product_option_id] => 36782
                                        [display_name] => Womens Shoe Size
                                        [display_value] => 37 (US6)
                                        [value] => 277224
                                        [type] => SimpleXMLElement Object
                                            (
                                            )

                                        [name] => SimpleXMLElement Object
                                            (
                                            )

                                        [display_style] => SimpleXMLElement Object
                                            (
                                            )

                                    )

                                [1] => SimpleXMLElement Object
                                    (
                                        [id] => 58
                                        [option_id] => 49565
                                        [product_option_id] => 36783
                                        [display_name] => Shoe Color
                                        [display_value] => Copper/Wine Suede
                                        [value] => 277232
                                        [type] => SimpleXMLElement Object
                                            (
                                            )

                                        [name] => SimpleXMLElement Object
                                            (
                                            )

                                        [display_style] => SimpleXMLElement Object
                                            (
                                            )

                                    )

                            )

                    )

                [configurable_fields] => SimpleXMLElement Object
                    (
                    )

            )

    ) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T08:01:52.310

您将数组作为第二个参数传递给 array_walk_recursive。

来自 PHP 文档：

```
bool array_walk_recursive ( array &$input , callable $funcname [, mixed $userdata = NULL ] ) 
```

第二个参数必须是一个可调用函数名，它接受两个参数，数组的值和键，如果您将它作为第三个参数包含到 array_walk_recursive，则传递第三个可选参数。

换句话说，您将不得不调用类似：

```
array_walk_recursive($fields, 'funcname', 'addChild'); 
```

你可以在这里阅读：http: [//php.net/manual/en/function.array-walk-recursive.php](http://php.net/manual/en/function.array-walk-recursive.php)

# java - Interactive Brokers Java API 获取所有职位？

> ID：14025123
> 
> 赞同：1
> 
> 时间：2012-12-24T19:40:14.490
> 
> 标签：java, api, interactive, broker

我浏览了 IB 的 java API，并没有看到任何用于获取我的投资组合中所有当前股票/期权头寸的功能。我想要做的是：获取我的投资组合中的所有当前/活动头寸（头寸可能会或可能不会从 API 发送），然后遍历列表以关闭符合我的条件的那个。有没有办法做到这一点？

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T14:04:30.397

使用该`reqAccountUpdates(true)`方法开始接收有关帐户的事件。然后你通过`updatePortfolio()`事件方法获得所有位置。如果您不希望定期订阅帐户事件，请致电`reqAccountUpdates(false)`结束订阅。

# android - LayoutInflater 添加多个视图

> ID：14025126
> 
> 赞同：3
> 
> 时间：2012-12-24T19:40:27.593
> 
> 标签：android, layout-inflater

对于我的应用程序，我必须使用复选框和文本视图动态创建许多水平线性布局。目前我在 for 循环中动态创建这些。为了性能和易用性，我认为使用 layoutinflater 会是一种更好的方法，因此使用正确的格式定义一个水平线性布局，然后将它们添加到某种循环中，但是我遇到了麻烦。我也愿意接受是否有更好的方法来实现我所追求的（或者如果我目前的方法确实对性能更好等）

```
//my main layout
LinearLayout main = (LinearLayout) findViewById(R.id.main);
LayoutInflater inflate = getLayoutInflater();
//inflating the layout containing the horizontal
LinearLayout l = (LinearLayout) inflate.inflate(R.layout.inflater, main, false);
//adding the view
main.addView(l); 
```

问题是我不能把它放在任何类型的 for 循环中。以下是重复 addView 命令的错误日志。

```
12-24 19:37:18.668: E/AndroidRuntime(8780): java.lang.RuntimeException: Unable
to start activity ComponentInfo{com.example.test1/com.example.test1.MainActivity}: 
java.lang.IllegalStateException: The specified child already has a 
parent. You must call removeView() on the child's parent first. 
```

我还考虑将布局添加到主线性布局，然后获取并复制它，然后添加更多。你们能帮我学习如何做到这一点吗？

非常感谢你！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-24T19:57:46.450

```
LinearLayout l = (LinearLayout) inflate.inflate(R.layout.inflater, main, false); 
```

我怀疑问题是您指定`main`为`ViewGroup`参数。

尝试设置`attachToRoot`参数，`true`然后删除该`main.addView(l)`行。

或者将`ViewGroup`参数设置为`null`并保留该`main.addView(l)`行。

# ruby-on-rails - Rails - 如何从我的付款模型中为我的用户表添加价值？

> ID：14025130
> 
> 赞同：2
> 
> 时间：2012-12-24T19:41:10.447
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord, stripe-payments

我已经尝试了几个小时来解决这个问题。我可以在我的付款模型 payment.rb 中使用此代码成功付款：

```
def save_with_payment
if valid?
  customer = Stripe::Customer.create(description: email, card: stripe_card_token)
  self.stripe_customer_token = customer.id
  save!

  Stripe::Charge.create(
      :amount => (total * 100).to_i, # in cents
      :currency => "usd",
      :customer => customer.id
  )
end
rescue Stripe::InvalidRequestError => e
logger.error "Stripe error while creating customer: #{e.message}"
errors.add :base, "There was a problem with your credit card."
false
end 
```

我想在我的用户模型中将 Stripe 的 customer.id 保存到我的用户表属性 customer_id 但上面的代码在我的付款模型中，我该怎么做？

Stripe 的帮助部分说，通过执行以下操作很容易：

```
save_stripe_customer_id(user, customer.id) 
```

然后稍后：

```
customer_id = get_stripe_customer_id(user)

Stripe::Charge.create(
:amount => 1500, # $15.00 this time
:currency => "usd",
:customer => customer_id
) 
```

我在 save_stripe_customer_id 中输入了什么代码？我把那个代码放在哪里？上面为我工作的生成 Stripe 的 customer.id 的方法在 Payment 模型中，但我想将其保存为我的 User 模型中的一个属性，这样我就可以稍后向用户收费，而不必重新输入他们的信用卡。如何将 Payment 模型中生成的内容保存到我的 users 表中？

编辑：

付款.rb

```
belongs_to :user 
```

用户.rb

```
has_many :payments 
```

我想作为 customer_id 添加到我的用户表中的属性已经在我的支付表中作为 stripe_customer_token，我只是不知道如何在其中使用它或如何将其转移到我的用户表中。

更多的：

付款控制器.rb：

```
def create
if current_user
  @payment = current_user.payments.new(params[:payment])
else
  @payment = Payment.new(params[:payment])
end
respond_to do |format|
  if @payment.save_with_payment
    format.html { redirect_to @payment, notice: 'Payment was successfully created.' }
    format.json { render json: @payment, status: :created, location: @payment }
  else
    format.html { render action: "new" }
    format.json { render json: @payment.errors, status: :unprocessable_entity }
  end
end
  end 
```

可能的原因

```
self.user.update_attribute(customer_id, customer.id) 
```

是否因为涉及用户而为 customer_id 抛出一个未定义的方法与 Devise 有某种关联？我的路线文件中是否需要更改某些内容？

路线.rb

```
devise_for :users, :path => 'accounts' do
get 'users', :to => 'store#index', :as => :user_root
end

resources :users

resources :payments

match ':controller(/:action(/:id))(.:format)' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T20:26:20.797

试试这个

```
def save_with_payment
if valid?
  customer = Stripe::Customer.create(description: email, card: stripe_card_token)
  self.stripe_customer_token = customer.id
  self.user.update_attribute(:customer_id, customer.id) #this will update your user
  save!

  Stripe::Charge.create(
      :amount => (total * 100).to_i, # in cents
      :currency => "usd",
      :customer => customer.id
  )
end
rescue Stripe::InvalidRequestError => e
logger.error "Stripe error while creating customer: #{e.message}"
errors.add :base, "There was a problem with your credit card."
false
end 
```

# java - 持久化对象在 Hibernate 架构中意味着什么？

> ID：14025136
> 
> 赞同：40
> 
> 时间：2012-12-24T19:42:11.390
> 
> 标签：java, hibernate, orm, persistence

> ## Hibernate 是一个持久化框架，用于将数据从 Java 环境持久化到数据库。

我很困惑..如果我们将一个对象持久化到数据库中，那么为什么Hibernate Architecture在下图中的Application和Hibernate中间描绘了持久化对象？

[![一只忙碌的猫](../Images/32ff55130fd1df24a198f6ed37ae513f.png)](https://i.stack.imgur.com/xC7bv.png)
[（来源：[viralpatel.net](https://img.viralpatel.net/2011/11/hibernate-architecture-mini.png)）]

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-12-26T05:29:04.930

我会让它更清楚。持久对象是您创建的 POJO 类的实例，它们表示数据库中表中的行。根据[hibernate-doc](http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/objectstate.html)，表示数据库中表的POJO类的实例经历了3种状态，其中持久化是其中之一。

当 POJO 实例在会话范围内时，它被称为是持久的，即休眠检测对该对象所做的任何更改，并在我们关闭或刷新会话时将其与数据库同步。

关于 hibernate.properties 和 XML 映射 @Ken Chan 是对的。通过[hibernate-doc](http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/objectstate.html)了解更多关于 hibernate 对象的说明。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2016-09-08T05:18:02.427

首先您需要了解 Hibernate 对象的三种状态，即 Transient、Persistent、Detached。

瞬态：如果一个对象刚刚使用 new 运算符实例化并且在数据库中没有它的引用，即它不代表数据库中的任何行，则该对象处于瞬态。

持久状态：如果一个对象在数据库中有一些引用，即它表示数据库中的某些行并且为其分配了标识符值，则该对象处于持久状态。如果对对象进行了任何更改，那么 hibernate 将检测到这些更改，并且影响将存在于数据库中，这就是名称 Persistent 的原因。这些更改是在会话关闭时进行的。持久对象在会话范围内。

分离状态：一个已经持久化并且不再在会话范围内的对象。hibernate 不会检测到对此对象所做的任何更改。它可以再次连接到会话以使其再次持久化。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-12-24T19:55:53.347

根据该图，您配置`hibernate.properties`或一些`XML mapping`将数据库表映射到被调用的 java 对象`persistent object`。

然后在您`application`的 .`persistent object`作为一个普通的 java 对象来操作它的状态。您可以传递`persistent object`给hibernate。然后Hibernate 将生成并向DB 发出必要的SQL 以同步其状态`persistent object`及其相应的数据库记录。这有意义吗？

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-09-05T06:01:20.523

持久对象通常是那些存在于内存中的对象，甚至超出了创建它的进程的持续时间。然后将这些对象存储在数据库中。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2014-08-07T12:14:34.730

持久对象只不过是 POJO 类的一个实例。而 POJO 类只不过是一个代表表的类。而且 Hibernate 总是监视那个持久对象。每当您操作该对象或对该对象进行任何更改时，Hibernate 都会在该表中执行相同的操作（由 POJO 类表示）。这一切都由hibernate处理。所以总的来说这是hibernate框架的特点之一。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-12-24T19:44:06.713

持久对象是程序中在数据库中有表示的类。

例如，如果您有一个具有 NumberPlate、Fuel 属性的 Car 类。NHibernate 配置会将其映射到例如数据库中名为 Car 的表，并且这些列对应于 Car 类属性。

# google-chrome - 动态 html iframe 中的内容脚本和操作 chrome 函数

> ID：14025147
> 
> 赞同：0
> 
> 时间：2012-12-24T19:43:16.633
> 
> 标签：google-chrome, iframe, google-chrome-extension, content-script

我一直在开发一个 chrome 扩展，它从我的服务器获取 html 内容，在页面中创建一个 iframe 并将 html 注入其中。因此，没有“src”属性，因此，我的内容脚本没有被注入。

**清单.js**：

```
"background": { "scripts":["background.js"] },
"content_scripts":
 [
  {"js": ["toolbar.js"], "matches": ["http://*/*"]},
  {"js": ["frame.js"], "matches": ["<all_urls>"], "all_frames":true}
 ],
"web_accessible_resources": [ "loader.gif","frame.js" ],
"permissions": [ "browsingData", "history", "storage", "tabs", "management", "<all_urls>" ] 
```

**背景.js**：

```
chrome.extension.onMessage.addListener(function(details)
{
  if(details.message.sendBack)
  {
    chrome.tabs.sendMessage(details.sender.tab.id,details.message.data);
  }
}); 
```

**框架.js**：

```
some function...
if...()
{
  chrome.extension.sendMessage({ sendBack: true,data: data });
} 
```

**工具栏.js**：

```
function setContent(data)
{
  iframe.contentDocument.open('text/html');
  iframe.contentDocument.write(data);
  iframe.contentDocument.close();
} 
```

现在，iframe 拥有一个工具栏，其中包含与浏览器相关的功能，例如清除历史记录等。用 HTML 来说，有一个锚点，onclick 应该向扩展发送消息，发送“clearHistory”命令。这些功能需要 chrome 扩展访问 chrome.history 和 chrome.management，所以我需要在 html 对象和父扩展之间传递消息。

问题是 iframe 没有注入 frame.js 脚本，即使它的 src 设置为某个本地文件。也许我做错了什么，但我找不到注入脚本的方法。我什至不确定注入脚本会允许这种机制。

我试图获取脚本的相对 url (chrome.tab.getURL) 并且脚本实际上被注入了，但是 console.log(chrome) 没有显示扩展对象或我可以使用的任何方法（我相信这是由于手动注入）

你怎么看？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T20:55:18.237

iframe 的内容来自您的服务器，对吗？如果是这样，那么不要使用`iframe.contentDocument`写框架。让您的服务器直接为 iframe 提供服务。例如：

```
$("body").append ('<iframe src="http://YOUR_SERVER.com/YOUR_PATH?urlParams=ifAny" id="extIframe1"></iframe>'); 
```

[Chrome 扩展在 JS 生成的 iframe 上效果不佳](http://code.google.com/p/chromium/issues/detail?id=76429)。

然后将清单行调整为：

```
{"js": ["frame.js"], "matches": ["http://YOUR_SERVER.com/YOUR_PATH*"], "all_frames":true} 
```

# github - 如何在 travis 中排除 git 分支？

> ID：14025148
> 
> 赞同：16
> 
> 时间：2012-12-24T19:43:26.243
> 
> 标签：github, travis-ci

我有一个正在用 travis 构建的 github 项目。 [https://travis-ci.org/emmby/greenDAO/branches](https://travis-ci.org/emmby/greenDAO/branches)

我希望 travis 构建该项目中的大部分分支，但我特别希望排除其中一个分支。

所以我`.travis.yml`在我的`master`分支上添加了以下内容：

```
branches:
  except:
    - mvn-repo 
```

但是，这并没有禁用分支的构建。所以在阅读[文档](http://about.travis-ci.org/docs/user/build-configuration/#Specify-branches-to-build)时，我发现了这个注释：

> 请注意，目前（出于历史原因），.travis.yml 需要出现在项目的所有活动分支上。

所以，我继续在包含相同部分`.travis.yml`的分支中创建了一个文件。然而，travis 仍然坚持建立和失败我的分支。`mvn-repo``branches``mvn-repo`

为什么 travis 试图建立一个我标记为排除的分支？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-16T06:59:19.580

你还有这个问题吗？正如您所描述的，这听起来像是一个错误，因此请在[我们的问题跟踪器](https://github.com/travis-ci/travis-ci/issues/new)中报告此问题，我们会为您查找。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-03-25T16:34:30.717

更新：目前，travis-ci 有一个开关，可以决定是否构建不包含 .travis.yml 文件的分支。

# iphone - 我应该在 ARC 中使用 nil

> ID：14025149
> 
> 赞同：1
> 
> 时间：2012-12-24T19:43:35.637
> 
> 标签：iphone, ios, ios5, automatic-ref-counting

我已经阅读了很多文章，但是当我实际阅读时，我认为我错过了一些东西。

我有一个应用程序，我正在为模块设置一个单例对象，该模块呈现在其他视图控制器上。这个单例对象实例化其他子对象。完成任务后，我**关闭控制器**并将 nil 设置为单例对象。但在仪器中它显示我的这个模块创建的许多对象仍然*存在*。

**我的第一个问题是**- 是否解除控制器释放其所有子对象？或者我必须明确将其设置为零。

我的应用程序仍在运行，当这些对象将来被释放时（它们不是泄漏，因为它们没有被仪器泄漏显示并且没有保留周期）或者我必须通过将它们设置为 nil 来明确强制，因为我不需要它们它们正在浪费内存。

为什么当我释放了它的超级父对象（即单对象对象）时，这些强大的属性和两个或三个实例变量仍然存在。

还有一些对象列表中的工具显示的对象有名称`<x06...>`或`malloc`由我的代码方法分配。我应该担心这些对象分配吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T19:59:10.403

第一个问题：不，它只是调用 release: 引用计数减 1，但是当引用计数等于 0 时释放。

只需检查谁在解除控制器后对活着的对象进行引用。

该控制器必须获取对将与其一起释放的所有对象的所有引用，并且只有这个控制器，没有其他人。

**关于在 ARC 中设置为零。**是的，这是一个很好的做法。例如，所有**出口**自动（当您将其从 IB 拖动到具有右键的代码时）被创建为（非原子，弱）。**弱**- 意味着当对象被释放时它将被设置为**nil 。**

此外，关于 ARC、nils 等：[http ://www.raywenderlich.com/5677/beginning-arc-in-ios-5-part-1](http://www.raywenderlich.com/5677/beginning-arc-in-ios-5-part-1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T19:51:21.430

`is dismissing a controller deallocate all its child object or not? or i have to explicitly set it to nil.`

是的，它调用释放。之后分配`nil`给他们只是一件事。

`nil`确保在释放旧对象后不再指向任何垃圾。将 nil 分配给对象或将 NULL 分配给内存指针是类似的。

并且`release`-ing 并不意味着该内存将从那一刻开始可用。如果在那里停留了很长时间，并且如果操作系统无法找到足够的内存，那么这些`release`-d 内存就会被操作系统占用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-25T00:49:16.020

> 解散控制器是否释放其所有子对象？

本质上不是，不是。这取决于。在您的应用程序中不再有对它的强引用后，该对象将被释放。

因此，例如，如果您有一个强大的实例变量引用您的控制器，则解除它不会导致释放，因为您仍然对它有一个强引用。但是，如果您将其设置为`nil`之后，并且没有对该对象的其他强引用，*那么*它将被释放。

另一方面，如果您的代码中没有对它的强引用，则对它的唯一强引用来自呈现视图控制器，因此当它关闭它时，您的应用程序中将没有对它的强引用, 所以它会在它被解雇后被释放。

> 为什么当我释放了它的超级父对象（即单对象对象）时，这些强大的属性和两个或三个实例变量仍然存在。

您在这里混淆了您的术语。没有“超级父母”这样的东西。有超类和超视图，但不清楚你是否指的是它们中的任何一个。如果您有无法摆脱的持久对象，请发布您正在使用的代码。

# php - 返回特定行或所有行结果

> ID：14025151
> 
> 赞同：0
> 
> 时间：2012-12-24T19:43:43.737
> 
> 标签：php, codeigniter

我开发了这个功能来帮助我快速从数据库中获取有关我的用户的信息。我的问题是，当我只需要一个用户时，最好只返回一行，或者当我需要多个用户时返回结果。

```
/**
 * get_users function.
 * 
 * @access public
 * @param array $params (default: array();) 
 * possible array keys:  
 * user_ids - either an array of user ids or a single user id
 * user_status_ids - either an array of user status ids or a single user status id
 * user_role_ids - either an array of user role ids or a single user role id
 * 
 * @return object/NULL
 * Should return user_id, username, CONCAT(users.first_name, users.last_name, email_address, lock_date, user_status_name, user_role_name
 */
public function get_users($params = array())
{
    $this->db->select('users.user_id');
    $this->db->select('users.username');
    $this->db->select('CONCAT(users.first_name, " ", users.last_name) AS full_name', FALSE);
    $this->db->select('users.password');
    $this->db->select('users.password_hash');
    $this->db->select('users.email_address');
    $this->db->select('users.lock_date');
    $this->db->select('users.user_status_id');
    $this->db->select('users.user_role_id');
    $this->db->select('user_statuses.user_status_name');
    $this->db->select('user_roles.user_role_name');

    $this->db->from('users');
    $this->db->join('user_statuses', 'user_statuses.user_status_id = users.user_status_id');
    $this->db->join('user_roles', 'user_roles.user_role_id = users.user_role_id');

    //checking to see if any $params are attempting to be passed
    if (count($params) > 0)
    {
        //start title specific selection
        if (isset($params['user_ids']))
        {
            //if you only have one integer.
            if (is_numeric($params['user_ids']))
            {
                $this->db->where('users.user_id', $params['user_ids']);
            }
            else
            {
                if (is_array($params['user_ids']))
                {
                    $a = 0;
                    foreach($params['user_ids'] as $user_id)
                    {
                        if ($a == 0)
                        {
                            $this->db->where('users.user_id', $user_id);
                        }
                        else
                        {
                            $this->db->or_where('users.user_id', $user_id);
                        }
                        $a++;
                    }
                }
            }
        }

        //start title specific selection
        if (isset($params['usernames']))
        {
            //if you only have one integer.
            if (is_string($params['usernames']))
            {
                $this->db->where('users.username', $params['usernames']);
            }
            else
            {
                if (is_array($params['usernames']))
                {
                    $a = 0;
                    foreach($params['usernames'] as $username)
                    {
                        if ($a == 0)
                        {
                            $this->db->where('users.usernames', $username);
                        }
                        else
                        {
                            $this->db->or_where('users.username', $username);
                        }
                        $a++;
                    }
                }
            }
        }

        //start title specific selection
        if (isset($params['user_status_ids']))
        {
            //if you only have one integer.
            if (is_numeric($params['user_status_ids']))
            {
                $this->db->where('users.user_status_id', $params['user_status_ids']);
            }
            else
            {
                if (is_array($params['user_status_ids']))
                {
                    $a = 0;
                    foreach($params['user_status_ids'] as $user_status_id)
                    {
                        if ($a == 0)
                        {
                            $this->db->where('users.user_status_id', $user_status_id);
                        }
                        else
                        {
                            $this->db->or_where('users.user_status_id', $user_status_id);
                        }
                        $a++;
                    }
                }
            }
        }

        //start title specific selection
        if (isset($params['user_role_ids']))
        {
            //if you only have one integer.
            if (is_numeric($params['user_role_ids']))
            {
                $this->db->where('users.user_role_id', $params['user_role_ids']);
            }
            else
            {
                if (is_array($params['user_role_ids']))
                {
                    $a = 0;
                    foreach($params['user_role_ids'] as $user_role_id)
                    {
                        if ($a == 0)
                        {
                            $this->db->where('users.user_role_id', $user_role_id);
                        }
                        else
                        {
                            $this->db->or_where('users.user_role_id', $user_role_id);
                        }
                        $a++;
                    }
                }
            }
        }           
    }

    $query = $this->db->get();
    return $query->result();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T20:23:36.273

更好地将您的函数拆分为几个函数，这些函数执行易于更正理解的小查询。使用一个参数创建一个函数，例如：

```
/**
 * Return user that match given ids
 * @param array $uids the list of users to find
 * @return array - the users that matched the list
 * @throws DatabaseException on any error
 */
public function listUserById( array $uids )
{

}

/**
 * Return user that match given id and status
 * @param array $uids the list of users to find
 * @param array $status the list of user status to also find
 * @return array - the users that matched the list
 * @throws DatabaseException on any error
 */
public function listUserByIdAndStatus( array $uids, array $status )
{
  ///code
} 
```

或者您可以更新文档以指示您的函数返回“列表”（始终为数组）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T21:41:20.920

所以我建议看看你方法的这一部分

```
 //checking to see if any $params are attempting to be passed
if (count($params) > 0)
{
    //start title specific selection
    if (isset($params['user_ids']))

 ETC ETC 
```

将所有这些放在一个单独的方法中，该方法在调用 get_users() 之前运行。基本上弄清楚你在搜索什么——然后搜索它。将更容易回退相关错误和用户消息。还有我的菜鸟意见——当你到达 IF / Then 的第三个嵌套级别时——是时候考虑重构了。

# c# - 下载txt文件问题

> ID：14025161
> 
> 赞同：1
> 
> 时间：2012-12-24T19:44:52.597
> 
> 标签：c#, asp.net, download, response

我是 .Net 开发的新手。我尝试启用下载txt文件：

我使用这段代码：

```
protected void Page_Load(object sender, EventArgs e)
    {
                string str = "Test information";
                byte[] bytes = new byte[str.Length * sizeof(char)];
                System.Buffer.BlockCopy(str.ToCharArray(), 0, bytes, 0, bytes.Length);
                MemoryStream mem = new MemoryStream();
                mem.Write(bytes, 0, str.Length);

                Stream outStream = Response.OutputStream;
                Response.ContentType = "application/text/plain";
                Response.AppendHeader("Connection", "keep-alive");
                Response.AppendHeader("Content-Disposition", " attachment; filename = " + "test.txt");
                mem.WriteTo(outStream);
                outStream.Close();
     } 
```

但是我得到的文本文件包含错误的第一个字符串（编码问题）和许多其他包含有关当前页面信息的字符串。

**更新：** 这是我得到的文件

```
Bad string
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head><title>
    ASP.NET AJAX Web Services: Web Service Sample Page
</title>
    <script src="../Scripts/jquery-1.3.2.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $("#MainContent_RegisterUser_CreateUserStepContainer_UserName").blur(function (event) {
                $.ajax({
                    type: "POST",
                    url: "../About.aspx/validateUser",
                    contentType: "application/json; charset=utf-8",
                    data: "{'username': '" + $(this).val() + "'}",
                    dataType: "json",
                    success: AjaxSucceeded,
                    error: AjaxFailed
                });
            });
        });
        function AjaxSucceeded(result) {
            if (result.d == "true") {
                $("#LoginSpan").text("РўР°РєРѕР№ РїРѕР»СЊР·РѕРІР°С‚РµР»СЊ СѓР¶Рµ СЃСѓС‰РµСЃС‚РІСѓРµС‚");
            }
            else {
                $("#LoginSpan").text("");
            }
        }
        function AjaxFailed(result) {
            alert(result.status + ' ' + result.statusText);
        }  
  </script>  
    <link href="Styles/Site.css" rel="stylesheet" type="text/css" />
</head>
<body>
    <form method="post" action="BuyingSuccess.aspx?id=19" id="form1">
<div class="aspNetHidden">
<input type="hidden" name="__EVENTTARGET" id="__EVENTTARGET" value="" />
<input type="hidden" name="__EVENTARGUMENT" id="__EVENTARGUMENT" value="" />
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwULLTE1MjQ5ODA0NjlkGAIFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYCBSljdGwwMCRIZWFkTG9naW5WaWV3JEhlYWRMb2dpblN0YXR1cyRjdGwwMQUpY3RsMDAkSGVhZExvZ2luVmlldyRIZWFkTG9naW5TdGF0dXMkY3RsMDMFE2N0bDAwJEhlYWRMb2dpblZpZXcPD2QCA2THchHerzY1rr1yLcH18X4YPCuH2pX6++6OU9oOftLDQg==" />
</div>

<script type="text/javascript">
//<![CDATA[
var theForm = document.forms['form1'];
if (!theForm) {
    theForm = document.form1;
}
function __doPostBack(eventTarget, eventArgument) {
    if (!theForm.onsubmit || (theForm.onsubmit() != false)) {
        theForm.__EVENTTARGET.value = eventTarget;
        theForm.__EVENTARGUMENT.value = eventArgument;
        theForm.submit();
    }
}
//]]>
</script>

<script src="/Shop3/WebResource.axd?d=gJqNbXOsVujM8wR8-hfUcLtWhOiTVJCVfh9Lo7jgFFHsWxINU3DVAgCd3VVMHS94GhZGb8YTI_r4HUkshGHWuB2iNiNOHXsKESFMdk577mE1&amp;t=634669639690714017" type="text/javascript"></script>
<div class="aspNetHidden">

    <input type="hidden" name="__EVENTVALIDATION" id="__EVENTVALIDATION" value="/wEWAgL4/Z3vDgLC0ZzyCk29Agd/VrCau7HXz2AM6rx2j8z5dvoBoXKKKc+infsA" />
</div>
    <div class="page">
        <div class="header">
            <div class="title">
                <h1>
                    РРЅСЃС‚СЂСѓРєС†РёРё
                </h1>
            </div>
            <div class="loginDisplay">

                                <span class="bold">
                                <span id="HeadLoginView_HeadLoginName">usert</span>
                                </span>
                                <a id="HeadLoginView_HeadLoginStatus" href="javascript:__doPostBack(&#39;ctl00$HeadLoginView$HeadLoginStatus$ctl00&#39;,&#39;&#39;)">Р’С‹Р№С‚Рё&lt;/a>

            </div>
            <div class="clear hideSkiplink">
                <a href="#NavigationMenu_SkipLink"><img alt="Skip Navigation Links" src="/Shop3/WebResource.axd?d=qlxWJrbukMv20w9xY1h0SQe9L8dtSGVTDQ606-0jsJTHpyJh9XQcnnSaKyQTCktjR9G7_qlWhTXAgZB4Ay9LLv-RUiwbYud3LVU-Sm9I6hQ1&amp;t=634669639690714017" width="0" height="0" style="border-width:0px;" /></a><div class="menu" id="NavigationMenu">
    <ul class="level1">
        <li><a class="level1" href="Default.aspx">РРЅСЃС‚СЂСѓРєС†РёРё&lt;/a></li><li><a class="level1" href="About.aspx">Рћ РїСЂРѕРµРєС‚Рµ&lt;/a></li>
    </ul>
</div><a id="NavigationMenu_SkipLink"></a>
            </div>
        </div>
        <div class="main">

    <span id="MainContent_Label1">Р’С‹ РєСѓРїРёР»Рё РёРЅСЃС‚СЂСѓРєС†РёСЋ, РїРѕР·РґСЂР°РІР»СЏРµРј!</span>

        </div>
        <div class="clear">
        </div>
    </div>
    <div class="footer">

    </div>

<script type='text/javascript'>new Sys.WebForms.Menu({ element: 'NavigationMenu', disappearAfter: 500, orientation: 'horizontal', tabIndex: 0, disabled: false });</script></form>
</body>
</html> 
```

如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T19:54:27.000

将 ContentType 更改为`application/octet-stream`以确保文件将通过所有浏览器下载。

例如将其更改为：

```
Response.Clear();
Response.Charset = "";
Response.AddHeader("content-disposition", "attachment;filename=" + fileName);
Response.ContentType = "application/octet-stream";
Response.Write(mem.ToArray());
Response.End(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-25T08:15:14.527

在 outStream.Close() 之后的 Page_load 事件末尾添加以下行；陈述

```
Response.End(); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-24T22:25:00.587

也许它也是使用 System.Net.WebClient 从 Web 资源下载字符串、字节或文件的好方法。

```
WebClient client = new WebClient();
byte[] imageAsBytes = client.DownloadData(uri);
String webSource = client.DownloadString(uri);
client.DownloadFile(uri, "C:\\myfile.txt"); 
```

它还支持异步下载。

# java - 窗口改变时如何动态调整小程序组件的大小？

> ID：14025162
> 
> 赞同：0
> 
> 时间：2012-12-24T19:44:52.553
> 
> 标签：java, applet

我尝试使用以下代码在小程序上显示图像，但是当我尝试更改小程序窗口的大小时，加载的图像没有调整大小，为什么会发生这种情况？

```
import java.applet.*;
import java.awt.*;

public class ImageViewer extends Applet
{
    Image image;
    int imageX, imageY;
    MediaTracker mt;

    public void init()
    {
        showStatus("Getting image...");
        mt = new MediaTracker(this);
        image = getImage(getDocumentBase(), "fruits.jpg");
        mt.addImage(image, 0);
    }

    public void start()
    {
        showStatus("Loading image...");
        try
        {
            mt.waitForAll();
        } catch(Exception e)
        {
            e.printStackTrace();
        }
        while(!mt.checkAll(true)){}
        imageX = image.getWidth(this);
        imageY = image.getHeight(this);
        showStatus("Resizing Applet image size: " + imageX + "x" + imageY);
        resize(imageX, imageY);
    }

    public void paint(Graphics g)
    {
        showStatus("Drawing image...");
        g.drawImage(image, 0, 0, this);
    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-24T20:08:31.093

`Graphics.drawImage`当您使用使用图像自身大小而不是`Applet`容器大小的方法时，图像不会调整大小

```
g.drawImage(image, 0, 0, this); 
```

您可以将其替换为

```
g.drawImage(image, 0, 0, getWidth(), getHeight(), this); 
```

也别忘了打电话

```
super.paint(g); 
```

绘制任何子组件，包括容器背景。

* * *

顺便说一句：`java.awt.Applet`现在已经被[JApplet](http://docs.oracle.com/javase/7/docs/api/javax/swing/JApplet.html)取代了。这是[Java Swing](http://docs.oracle.com/javase/tutorial/uiswing/)的一部分，它使用轻量级资源并具有更多功能。

# android - 如何在没有未决意图的情况下在android中发送短信？

> ID：14025170
> 
> 赞同：0
> 
> 时间：2012-12-24T19:45:53.423
> 
> 标签：android, sms, android-pendingintent

我想从我使用此代码的 android 设备发送短信；

```
PendingIntent pi = PendingIntent.getActivity(this, 0, new Intent(this,
ViewPagerFragmentActivity.class), 0);
SmsManager sms = SmsManager.getDefault();
sms.sendTextMessage(phoneNumber, null, message, pi, null); 
```

但这让我`ViewPagerFragmentActivity`不断地在上面打开。如何操纵我的代码以不允许这样做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T19:53:44.573

我解决了自己的问题

```
private void prepareandsendSMS(String phoneNumber, String message) {
    SmsManager sms = SmsManager.getDefault();
    sms.sendTextMessage(phoneNumber, null, message, null, null);
} 
```

通过这种操作。

# android - 我无法修改我的 android 项目的 java 路径

> ID：14025174
> 
> 赞同：0
> 
> 时间：2012-12-24T19:46:38.263
> 
> 标签：android, eclipse, import, gps, r.java-file

我从另一台机器转移了一个 Android 项目。我想学习，如何正确编辑我的 Android 项目的 Java 文件上的 /Gen 文件夹。

首先，我导入现有代码并选择`buildautomaticly`模式。

“属性选择 googleapis 2.2\. API 8”和“未在库中使用 ..”

当我尝试修复错误时，我在`r.java`. 但是如果`buildautomaticly`模式打开，它就不起作用 - 我的更改被刷新，我失去了我的 ids 布局和彼此再次。

如果我尝试取消选择`buildautomaticly`模式，我不会收到错误消息，但它不适用于 gps 的调试和模拟。

我每次都尝试清洁，但没有帮助。

[PLS LOOKUP 我的 android 项目的捕获](http://i.stack.imgur.com/Spgy0.jpg)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-25T06:42:36.157

首先，通过一一选择不同的方式，尝试识别您的项目需要哪个API级别。并且不要担心 R 类 id，因为每当您构建您的项目时，它们总是由自己生成。如果你自己建立它很好。如果没有生成 R 类 ID，则重新启动您的 Eclipse ID，并允许 SDk 再次加载。可能这些步骤可以解决您的问题

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-25T06:37:32.053

不要修改 R.java。可能您正在使用的库之一未安装到新机器上。尝试使用 Android Sdk 管理器对其进行配置。

# perl - 我是否必须释放使用 newHV 创建的 HV*？

> ID：14025175
> 
> 赞同：8
> 
> 时间：2012-12-24T19:46:40.430
> 
> 标签：perl, memory-leaks, perl-xs

如果我编写了一些 XS 代码，其中包含我从未期望返回到 perl 的哈希值，我是否必须释放它？如果是这样，怎么做？

我想出的最接近的是 hv_undef，但据我所知，这只是清除散列的内容，而不是散列本身。

```
HV* hash = newHV();
...
use the hash
...
hv_undef(hash); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-24T21:46:55.247

`newHV`（如`newSV`,`newAV`等）将新创建的值的引用计数设置为 1。要释放它，[您只需将其递减为 0](http://perldoc.perl.org/perlguts.html#Reference-Counts-and-Mortality)。对于 HV，没有特殊功能，所以只需使用`SvREFCNT_dec`：

```
HV* hash = newHV();
/*
 * use the hash
 */
SvREFCNT_dec((SV *) hash); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-25T04:50:03.387

`newHV`返回`HV`一个引用计数 (refcnt) 为 1 的 ，表示您的代码持有该`HV`. 完成后`HV`，您必须通过减少它的 refcnt 来释放对它的持有。有三种常见的方法来做到这一点。

1.  在这里和现在完成它。

    ```
    SvREFCNT_dec((SV*)hv);
    // hv is no longer safe to use here. 
    ```

    `AV`并且`HV`是 的“子类” `SV`。

2.  在调用者有机会引用它之后完成它。（实际上并不适用于哈希。）

    ```
    return sv_2mortal(sv); 
    ```

3.  所有权转让”。

    ```
    rv = newRV_noinc((SV*)hv); 
    ```

    这是缩写

    ```
    rv = newRV((SV*)hv);
    SvREFCNT_dec((SV*)hv); 
    ```

    请注意，您必须`rv`在完成后同样释放对它的保留，因此您经常会看到以下内容：

    ```
    return sv_2mortal(newRV_noinc((SV*)hv)); 
    ```

# r - 使用 R 仅查找一个点（不是整个矩阵）的 k 最近邻

> ID：14025176
> 
> 赞同：5
> 
> 时间：2012-12-24T19:46:40.360
> 
> 标签：r, knn

是否有一个包或一种简单的方法可以使用 R 为一个点搜索 k 最近邻居（特别是使用 kd 树）？所有提供此功能的包（例如 RANN 或 FNN ...）计算矩阵中所有点的 knn，我只需要为一个点计算。

例如，我有一个包含 10 个点“A”到“E”的矩阵，我想为“A”找到其他 4 个点（“B”到“E”）之间的 2 个最近邻居，而不对所有点进行相同的计算数据集中的行（不计算“B”、“C”、“D”、“E”的 knn）

我希望我的问题很清楚，我的英语不好。

谢谢你的帮助，

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-24T21:37:44.903

如果我理解正确，您可以使用 FNN 包执行此操作：

```
> library(FNN)
> X <- matrix(runif(100), 5, 5)
> X
          [,1]      [,2]      [,3]      [,4]      [,5]
[1,] 0.7475301 0.6725876 0.2511358 0.5048512 0.1196027
[2,] 0.5777907 0.6337206 0.8334608 0.5067914 0.6410024
[3,] 0.5488786 0.9613076 0.2217271 0.6906149 0.7396482
[4,] 0.8230380 0.8596784 0.6348114 0.6211107 0.3089131
[5,] 0.6531433 0.8682462 0.2555402 0.2443061 0.5292509
> knnx.dist(X[-1,], X[1, , drop=FALSE], k=2)
          [,1]     [,2]
[1,] 0.4870996 0.531889
> knnx.index(X[-1,], X[1, , drop=FALSE], k=2)
     [,1] [,2]
[1,]    3    4 
```

请注意，knnx.index 的结果与传递给函数的矩阵有关，因此 3 和 4 实际上表示第 4 行和第 5 行是原始数据集。

# php - PHP函数问题中的PDO查询

> ID：14025178
> 
> 赞同：-1
> 
> 时间：2012-12-24T19:46:44.127
> 
> 标签：php, mysql, function, pdo

我有以下代码：

```
function user_name($id) {
    $eqpt_name1 = $this->sql->query("SELECT `f_val` FROM `profiles` WHERE `u_id` = $id AND `f_id` = 1");
    $eqpt_name1_2 = $eqpt_name1->fetch();
    $name1 = $eqpt_name1_2['f_val'];

    $eqpt_name2 = $this->sql->query("SELECT `f_val` FROM `profiles` WHERE `u_id` = $id AND `f_id` = 2");
    $eqpt_name2_2 = $eqpt_name2->fetch();
    $name2 = $eqpt_name2_2['f_val'];

    $name3 = $name1 . " " . $name2;

    return $name3;
} 
```

它所做的是获取提供的用户 ID ($id) 并获取用户的名字 ($name1) 和姓氏 ($name2)，然后输出它。

我通过执行以下操作来调用它

```
$username = user_name($_SESSION['user_id']); 
```

`$_SESSION['user_id']`是`1`，例如。

当我手动将代码放入 PHP 文件时，它工作正常。但是当我使用一个函数以便可以在整个站点上全局使用它时，我不必在每个页面上都有那么长的查询代码，Apache 给了我这个错误：

> PHP 致命错误：在非对象上调用成员函数 query()

我以前从来没有写过一个有查询的函数，也不知道我做错了什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T19:50:26.337

从你如何称呼它来看，这只是一个全局函数；`$this`不会被定义，所以你不能使用`$this->sql`. 如果您有一个名为 的全局变量`$sql`，请告诉 PHP 您正在使用它：

```
function user_name($id) {
    global $sql;

    $eqpt_name1 = $sql->query("SELECT `f_val` FROM `profiles` WHERE `u_id` = $id AND `f_id` = 1");
    $eqpt_name1_2 = $eqpt_name1->fetch();
    $name1 = $eqpt_name1_2['f_val'];

    $eqpt_name2 = $sql->query("SELECT `f_val` FROM `profiles` WHERE `u_id` = $id AND `f_id` = 2");
    $eqpt_name2_2 = $eqpt_name2->fetch();
    $name2 = $eqpt_name2_2['f_val'];

    $name3 = $name1 . " " . $name2;

    return $name3;
} 
```

另外，您正在使用 PDO，那么为什么不使用准备好的语句呢？你也可以进一步简化一些事情：

```
function user_name($id) {
    global $sql;

    $query = $sql->prepare('SELECT `f_val` FROM `profiles` WHERE `u_id` = :id AND `f_id` IN (1, 2) ORDER BY `f_id`;');
    $query->execute(array(':id' => $id));

    return implode(' ', $query->fetchAll(PDO::FETCH_COLUMN));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T20:11:37.100

构造**$this->**应该在对象内部使用以指示对“self”实例的引用。

函数内部没有**$this**。您可能使用作为 PDO 类实例的全局变量。您应该使用 $GLOBALS['varname'] 尽管 $this 或在您的函数中创建 PDO 的本地实例。

```
function name()
{
    $pdo = new PDO( /* args */ ); // or use a global one 
    //$pdo = $GLOBALS['pdo'];
    $statement = $pdo->sql->query( "SELECT `f_val` FROM `profiles` WHERE `u_id` = ".$pdo->quote( $id )." AND `f_id` = 1" );
    $statement->execute();
    return $statement->fetchColumn(); // return first column
} 
```

还注意到你做了两个语句来连接一个名字。您可以将所有这些事情直接放入一个 SQL 查询中，以获取知识。

# php - 为什么这个 php 爬虫不起作用？

> ID：14025184
> 
> 赞同：1
> 
> 时间：2012-12-24T19:47:20.090
> 
> 标签：php, web-crawler

## 在我的本地主机文档根目录中：

爬行.html

```
<html>
<body>
<p>
<form action="welcome.php" method="get">
Site to crawl: <input type="text" name="crawlThis">
<input type="submit">
</form>
</p>

</body>
</html> 
```

欢迎.php

```
 <html>
 <body>

 <?php 
 include ("crawler.php");

 echo $crawl = new Crawler($_GET["crawlThis"]);

 $images = $crawl->get("images");

 $links = $crawl->get("links"); 

 echo $links;
 echo $images;

 ?>
 <br>

</body>
</html> 
```

和 crawler.php

```
<?php

class Crawler {

protected $markup = '';

public function __construct($uri) {

$this->markup = $this->getMarkup($uri);

}

public function getMarkup($uri) {

return file_get_contents($uri);

}

public function get($type) {

$method = "_get_{$type}";

if (method_exists($this, $method)){

return call_user_method($method, $this);

}

}

protected function _get_images() {

if (!empty($this->markup)){

preg_match_all('/<img([^>]+)\/>/i', $this->markup, $images);

return !empty($images[1]) ? $images[1] : FALSE;

}

}

protected function _get_links() {

if (!empty($this->markup)){

preg_match_all('/<a([^>]+)\>(.*?)\<\/a\>/i', $this->markup, $links);

return !empty($links[1]) ? $links[1] : FALSE;

}

}

}

/*$crawl = new Crawler($);

$images = $crawl->get('images');

$links = $crawl->get('links');*/

?> 
```

结果页面只是空的。无法弄清楚我是否无法回显 $images，或者我的逻辑是否错误。我期待一个图像列表，然后是一个链接列表。

另外，我必须包含 crawler.php 还是 php 会在其容器目录中搜索同名的类？

抱歉，从 Java 转到 PHP 有点令人费解。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T21:44:49.143

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T19:55:14.687

我完全赞成自己编写，但是有很多记录在案的示例可以做到这一点。这是您可以遵循或使用的一个很好的示例：

[爬虫示例](http://phpcrawl.cuab.de/example.html)

# c++ - 使用不完整的 C++ 类无效？

> ID：14025188
> 
> 赞同：0
> 
> 时间：2012-12-24T19:48:21.373
> 
> 标签：c++, forward-declaration

我被这段代码困住了。我必须声明一个具有对象数组作为属性的类，并且该对象还具有先前的类作为属性。

我得到：错误：不完整类型“struct Tarjeta”的无效使用错误：“struct Tarjeta”的前向声明|

Tarjeta.h

```
#include "../include/Categoria.h"

 class Tarjeta{
    public:

    ~Tarjeta();
    //constructor por defecto
    Tarjeta();

    //constructor parametrizado
    Tarjeta(string);

    //Función para asignar categoria a la tarjeta
    void asignarCategoria(Categoria);

    //Función que devuelve la categoría en la que está incluida la tarjeta
    Categoria obtenerCategoria();

    void desAsignar();
protected:
    Categoria categoria;
    string descripcion;
    //identificador booleano para distinguir si una tarjeta del estudo ha sido asignada a una categoria
    bool asiganda;
private:
}; 
```

Tarjeta.cpp

```
#include "../include/Tarjeta.h"

Tarjeta::~Tarjeta()
{
  //dtor
}

/** @brief desAsignar
*
* @todo: Funcion utlizada para sacar una tarjeta de una categoria
*/
void Tarjeta::desAsignar(){
 categoria=NULL;
}

/** @brief obtenerCategoria
*
* @todo: devuelve la categoria en la que esta incluida la tarjeta
*/
Categoria Tarjeta::obtenerCategoria(){
  return categoria;
}

/** @brief asignarCategoria
*
* @todo: asigna una categoria a la tarjeta
*/
void Tarjeta::asignarCategoria(Categoria cat){
   categoria=cat;
   asiganda=true;
}

/** @brief Tarjeta
 *
 *  @todo: constructor parametrizado.
 *        inicalizamos categoria a null para da la posibilidad de crear tarjetas sin             
 */
 Tarjeta::Tarjeta(string des):descripcion(des){
    categoria=NULL;
 }

 /** @brief Tarjeta
  *
  * @todo: constructor por defecto
  */
  Tarjeta::Tarjeta(){
     categoria=NULL;
     descripcion="";
  } 
```

分类.h

```
#ifndef CATEGORIA_H
#define CATEGORIA_H

#include <string>
#define MAXTARJETAS 50

 using namespace std;

 //declaracion adelantada de Tarjeta para poder utilzarla en la clase Categoria
 class Tarjeta;

 class Categoria
 {
    public:
      virtual ~Categoria();

      //Constructor por defecto de la clase Categoria
      Categoria();

    //construcotr parametrizado de la clase Categoria
    Categoria(string,string);

    //Función que inicializa el arrayTarjetas poniendo las todas a null
    void incializaArrayTarjetas();

    //Función que introduce una nueva tarjeta en la coleccion de tarjetas
    void introducirTarjeta(Tarjeta);

    //Busca en el array de tarjetas la tarjeta en cuestion y la devuelve. Si llega al final y no encuentra nada devuelve nill
    Tarjeta consultaTarjeta(string);

    //Busca en el array de tarjetas y la elimina del array, no del estudio
    void elminarTarjeta(string);
protected:
    string nombre;
    string descripcion;
    Tarjeta *arrayTarjetas;

private:
};

#endif // CATEGORIA_H 
```

分类.cpp

```
 #include "../include/Categoria.h"
#include <string>
#define MAXTARJETAS 50

using namespace std;

/** @brief elminarTarjeta
  *
  * Busca en el array de tarjetas y la elimina del array, no del estudio
  */
void Categoria::elminarTarjeta(string descripcion)
{
    int i=0;
    bool encontrado=false;
    while(arrayTarjetas[i].descripcion!=descripcion && i<MAXTARJETAS){
        i++;
    }
    if(arrayTarjetas[i].descripcion==descripcion){
        encontrado=true;
    }
    int j=i+1;
    while(i<MAXTARJETAS){
        if(j<MAXTARJETAS){
            arrayTarjetas[i]=arrayTarjetas[j];
        }
        i++;
        j++;
    }
    if(encontrado){
        arrayTarjetas[MAXTARJETAS-1]=NULL;
    }
}

/** @brief consultaTarjeta
  *
  * Busca en el array de tarjetas la tarjeta en cuestion y la devuelve. Si llega al final y no encuentra nada devuelve null
  */
Tarjeta Categoria::consultaTarjeta(string descripcion)
{
    int i=0;
    while(arrayTarjetas[i].descripcion!=descripcion && i<MAXTARJETAS){
        i++;
    }
    if(arrayTarjetas[i].descripcion==descripcion){
        return arrayTarjetas[i];
    }
    return NULL;
}

/** @brief introducirTarjeta
  *
  * Función que introduce una nueva tarjeta en la coleccion de tarjetas
  * introduciremos la tarjeta en la primera posición libre que encontremos en el array
  */
void Categoria::introducirTarjeta(Tarjeta tarjeta)
{
    for(int i=0;i<MAXTARJETAS;i++){
        if(arrayTarjetas[i]==NULL){
            arrayTarjetas[i]=tarjeta;
            //la tarjeta que introducimos le asignamos la categoria
            //tarjeta.asignarCategoria(this); Lo hacemos en el main
            break;
        }
    }
}

/** @brief incializaArrayTarjetas
  *
  * Función que inicializa el arrayTarjetas poniendo las todas a null
  */
void Categoria::incializaArrayTarjetas()
{
    for(int i=0;i<MAXTARJETAS;i++){
        arrayTarjetas[i]=NULL;
    }
}

/** @brief Categoria
  *
  * constructor parametrizado de la clase Categoria
  * creamos el array vacio y lo inicializamos de esta
  * forma podemos empezar a meter tarjetas en las diferentes categorias
  */
Categoria::Categoria(string nom, string des):nombre(nom),descripcion(des){
    arrayTarjetas=new Tarjeta[MAXTARJETAS];
    incializaArrayTarjetas();
    cout<<"Constructor categoria"<<endl;
}

/** @brief Categoria
  *
  * Constructor por defecto de la clase Categoria
  */
Categoria::Categoria()
{
    nombre="";
    descripcion="";
    arrayTarjetas=new Tarjeta[MAXTARJETAS];
    incializaArrayTarjetas();
    cout<<"constructor categoria"<<endl;
}

/** @brief (one liner)
  *
  * (documentation goes here)
  */
 Categoria::~Categoria()
{
    delete arrayTarjetas;

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T19:50:41.943

在`Categoria.cpp`你必须`#include "Tarjeta.h"`。

标题很好，但是在`cpp`您实际使用该类的文件中 - 前向声明是不够的，您需要包含。

# opencv - 检测斯诺克台球

> ID：14025192
> 
> 赞同：0
> 
> 时间：2012-12-24T19:48:50.843
> 
> 标签：opencv

我正在使用 OpenCV 开始一个项目，以准确检测斯诺克球（台球）的位置和轮廓。

这些是球：![绿色台球桌，三角形 15 个台球，外加 1 个白色母球](../Images/cb17a0771adebcf9c147bc65f351d49c.png)

我已经尝试了一些算法，但无济于事。这是我到目前为止所做的：

- **HoughCircles**：这几乎不起作用。即使将参数调整到毫米分辨率也只能检测到几个球，并且无法准确检测到球的中心。

- **Canny**：在这里，如果球彼此不靠近，我只能检索球的轮廓。

-**按颜色 HSV 的阈值**：因为球不是一种颜色，所以这是行不通的。

我想尝试其他算法，如 HaarCascadeDetection 或 SURF。

你们怎么看？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T20:04:24.740

我不是 100% 认为它会起作用，但试一试。我认为如果相机不动，您可以通过快速傅立叶变换来完成此操作。请查看[http://en.wikipedia.org/wiki/Convolution_theorem](http://en.wikipedia.org/wiki/Convolution_theorem)。你应该做什么：

1.  我假设相机不动
2.  创建一个与图片大小相同的圆圈图案图像
3.  对图像和图片进行二维傅里叶变换
4.  将谐波乘以谐波变换
5.  进行逆变换
6.  找到具有最高强度的点

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-27T02:08:38.323

仅使用霍夫圆变换（在使用参数一段时间后）我得到了一些很好的结果。我想诀窍是结合使用足够小的 param2（以允许更多检测）和限制搜索半径（以过滤掉误报）。

```
circles = cv2.HoughCircles(img,cv2.cv.CV_HOUGH_GRADIENT,1,5, 
            param1=100,param2=10,minRadius=6,maxRadius=10) 
```

我也删除了阴影，但我不确定你的情况是否需要它。这是一些测试结果。

![在此处输入图像描述](../Images/a204cc8dc62bbdb77cedcc3a73c6f5ea.png)

![在此处输入图像描述](../Images/894ac3f9ffdfc08618b8008ee5a4380d.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-25T00:13:45.697

我认为最好的选择是检查像素颜色是否在同一范围内 - 使用[inrange](http://docs.opencv.org/modules/core/doc/operations_on_arrays.html?highlight=inrange#inrange "在范围内")函数（注意它需要 HSV 图像）。在这种情况下，球的中心可能只是一个光反射点（或非常接近该点的某个地方），通常是球的最亮点。

您也可以尝试扔掉表格（阈值或范围内），然后分析剩下的所有内容。

# firefox - Mac OSX 上 Firefox 驱动程序/Selenium Webdriver 的鼠标悬停事件不起作用

> ID：14025200
> 
> 赞同：1
> 
> 时间：2012-12-24T19:49:49.837
> 
> 标签：firefox, selenium, webdriver

在到处搜索之后，我似乎找不到让鼠标悬停事件在 Mac OSX 上与 Firefox 16.0.2 和 Selenium 2.28 一起工作的解决方案（我相信这应该是 Mac OSX 特有的问题，但这段代码应该在 Windows 机器上工作）。我有以下悬停在 objectOnScreen 上的内容，它应该显示一些 ElseOnScreen：

```
//set enable native events is suggested by another post to make these native events work
FirefoxProfile prof = new FirefoxProfile(); 
prof.setEnableNativeEvents(true); 
WebDriver driver = new FirefoxDriver(prof);

// Hover over objectOnScreen which should reveal somethingElseOnScreen
Action builder;
Actions hover = new Actions(driver);
WebElement objectOnScreen = driver.findElement(By.xpath("//..."))
hover.moveToElement(objectOnScreen);
builder = hover.build();
builder.perform();

// Click something new that should appear on screen
By somethingElseOnScreen = By.xpath("//...");
WebDriverWait wait = new WebDriverWait(driver, 5L);
wait.until(ExpectedConditions.visibilityOfElementLocated(somethingElseOnScreen));
driver.findElement(somethingElseOnScreen).click(); 
```

此代码适用于 Chrome，但不适用于 Firefox。在 Firefox 中，somethingElseOnScreen 永远不会出现（我在 wait.until... 行得到 NoSuchElementException），当我观看浏览器时，我从来没有看到悬停工作。

我也尝试了这两件事，但都没有解决问题：

*   使用悬停和单击操作构建构建器操作
*   使用 EventFiringMouse 并将鼠标悬停在屏幕上的该点上，但这在 Firefox 上也不起作用（但在 Chrome 上很好）。

有没有人有解决这个问题的方法？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T16:32:41.747

我的解决方法是手动`display`将元素的 css 属性更改为`inline`（或`block`- 取决于您的 HTML 代码）隐藏并应出现在“鼠标悬停”上（或调用添加所需元素的 JavaScript，甚至取决于您的HTML 代码）。

我可以具体告诉你你可以写什么代码，如果你能告诉我 3 件事：

1.  Selenium 使用什么语言
2.  之前元素的 HTML/css 属性`mouseover`
3.  之后元素的 HTML/css 属性`mouseover`

# r - ff 包写入错误

> ID：14025202
> 
> 赞同：2
> 
> 时间：2012-12-24T19:50:05.073
> 
> 标签：r, ff, ffbase

我正在尝试使用 R 处理 1909x139352 数据集。由于我的计算机只有 2GB 的 RAM，因此数据集对于传统方法来说太大（500MB）。所以我决定使用这个`ff`包。但是，我遇到了一些麻烦。该函数`read.table.ffdf`无法读取第一块数据。它崩溃并出现下一个错误：

```
txtdata <- read.table.ffdf(file="/directory/myfile.csv", 
                           FUN="read.table", 
                           header=FALSE, 
                           sep=",", 
                          colClasses=c("factor",rep("integer",139351)), 
                          first.rows=100, next.rows=100, 
                          VERBOSE=TRUE)

  read.table.ffdf 1..100 (100)  csv-read=77.253sec
  Error en  ff(initdata = initdata, length = length, levels = levels, ordered = ordered,  : 
   write error 
```

有谁知道发生了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-25T11:57:21.063

此错误消息表明您有太多打开的文件。在 ff 中，您的 ffdf 中的每一列都是一个文件。您只能打开有限数量的文件 - 而您已经达到了该数量。[请参阅我关于如何调试此 FF 错误](https://stackoverflow.com/questions/12283203/any-ideas-on-how-to-debug-this-ff-error)的任何想法的回复？.

因此，在您的情况下，仅使用 read.table.ffdf 将不起作用，因为您有 139352 列。但是，可以将其导入 ff，但在打开列时需要小心，同时在 RAM 中获取数据以避免此问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-25T00:03:35.387

你的数据集真的没有那么大。如果你说一下你想用它做什么，它可能会有所帮助。这可能会有所帮助：[增加 R 中的可用内存，](https://stackoverflow.com/questions/1395229/increasing-the-memory-available-to-r-processes) 或者如果这不起作用，则 data.table 包非常快，并且在使用 := 运算符操作 data.tables 时不会占用内存。
至于 read.table.ffdf，请查看.. [read.table.ffdf 教程](http://www.inside-r.org/packages/cran/ff/docs/read.table.ffdf)，如果您仔细阅读，它会提供有关使用 gc() 等命令优化内存使用的提示和详细信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-12-02T16:29:38.787

我最近在一个大约有 3,000 列的数据框中遇到了这个问题。解决此问题的最简单方法是调整允许为您的用户帐户打开的最大文件数。典型系统设置为 ~ 1024，这是一个非常保守的限制。 **请注意，它设置为防止服务器上的资源耗尽。**

### 在 Linux 上：

将以下内容添加到您的`/etc/security/limits.conf`文件中。

`youruserid hard nofile 200000 # you may enter whatever number you wish here youruserid soft nofile 200000 # whatever you want the default to be for each shell or process you have running`

### 在 OS X 上：

`/etc/sysctl.con`在您的文件 中添加或编辑以下内容。 `kern.maxfilesperproc=200000 kern.maxfiles=200000`

您需要注销并重新登录，但原始发帖人将能够使用 ffdf 打开他的 139352 列数据框。

我在[这里发布了更多关于我与此限制的磨合的信息](http://ctownsen357.github.io/posts/r-ff-many-columns/)。

# ruby-on-rails - 检查 validates_presence_of 以获取可变属性集

> ID：14025203
> 
> 赞同：1
> 
> 时间：2012-12-24T19:50:08.177
> 
> 标签：ruby-on-rails, validation

我有一个对象产品，具有类别和其他一些属性。不同的类别需要不同的属性。每个属性作为 required_attributes 的数组。我应该如何实现这个？我试过这样的事情：

```
validates_presence_of lambda { *self.category.required_properties } 
```

我也试过这个：

```
def validate(record)
    if record.category == nil
       record.errors[:category] << "Has no Category"
    else
       recors.category.required_properties.each do |x|
        .........?????  
       end
    end
end 
```

这样做最干净的方法是什么？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T19:58:45.440

试试这个：

```
validates :name, :presence => true 
```

或者

```
validates :name, :presence => {:message => 'Name cannot be blank, Task not saved'} 
```

我们可以检查使用**if record.category.present?**

```
def validate(record)
  if record.category.present?
      record.category.required_properties.each do |x|
       .........?????  
      end
  else
      record.errors[:category] << "Has no Category"
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-25T06:44:32.943

您可以为每个属性设置条件验证，检查它是否包含在当前类别的列表中：

```
[:attribute1, :attribute2, :attribute3].each do |attribute|
  validates attribute, :presence => true,
    :if => Proc.new { |product| product.category.required_properties.include?(attribute) }
end 
```

# c# - 如何在 C# 中实现八叉树？

> ID：14025211
> 
> 赞同：4
> 
> 时间：2012-12-24T19:51:00.543
> 
> 标签：c#, xna, octree

第一次在这里发帖，但我已经阅读该网站几年了。我正在尝试在 C# 中实现一个简单的泛型八叉树（使用一些 XNA 包括）。我已经进行了彻底的研究并且我理解了这个概念，但我似乎无法让它发挥作用。四处搜索会产生一些其他语言的实现，但它们似乎都是针对特定应用程序定制的；我还没有真正理解这些。

下面是到目前为止我的八叉树类，Vector3、BoundingBox 和 ContainmentType 来自 XNA。我输入最大和最小点，以及边界内的点列表。然而，实际上没有一个点被添加到树中。任何帮助将非常感激！

```
public class Octree<T> : ISerializable
{   
    Vector3 max;
    Vector3 min;
    OctreeNode head;

    public Octree(Vector3 min, Vector3 max, List<Vector3> values)
    {
        this.max = max;
        this.min = min;
        head = new OctreeNode( min, max,  values);           
    }

    public Octree() { }

    public Octree(SerializationInfo info, StreamingContext context)
    {
    }

    public void GetObjectData(SerializationInfo info, StreamingContext context)
    {            
    }

    internal class OctreeNode
    {            
        Vector3 max;
        Vector3 min;
        Vector3 center;
        public Vector3 position;
        public T data;

        public BoundingBox nodeBox;
        public List<OctreeNode> subNodes;
        public OctreeNode( Vector3 min, Vector3 max,List<Vector3> coords)
        {
            nodeBox = new BoundingBox(min, max);
            subNodes = new List<OctreeNode>();

            this.min = min;
            this.max = max;
            center = (min + ((max - min) / 2));

            nodeBox = new BoundingBox(min, max);
            if (coords.Count == 0)
            { return; }
            subNodes.Add(new OctreeNode(center, max));
            subNodes.Add(new OctreeNode(new Vector3(min.X, center.Y, center.Z), new Vector3(center.X, max.Y, min.Z)));
            subNodes.Add(new OctreeNode(new Vector3(min.X, center.Y, max.Z), new Vector3(center.X, max.Y, center.Z)));
            subNodes.Add(new OctreeNode(new Vector3(center.X, center.Y, max.Z), new Vector3(max.X, max.Y, center.Z)));

            subNodes.Add(new OctreeNode(new Vector3(center.X, min.Y, center.Z), new Vector3(max.X, center.Y, min.Z)));
            subNodes.Add(new OctreeNode(new Vector3(min.X, min.Y, center.Z), new Vector3(center.X, center.Y, min.Z)));
            subNodes.Add(new OctreeNode(new Vector3(min.X, min.Y, max.Z), center));
            subNodes.Add(new OctreeNode(new Vector3(center.X,min.Y,max.Z), new Vector3(max.X,center.Y,center.Z)));

            List<List<Vector3>> octants = new List<List<Vector3>>();
            for (int i = 0; i < 8; i++)
            {
                octants.Add(new List<Vector3>());
            }
            foreach (Vector3 v in coords)
            {
                int i = 0;
                foreach(OctreeNode n in subNodes)
                {
                    ContainmentType t = n.nodeBox.Contains(v);

                    if (t.Equals(ContainmentType.Contains))
                    {
                        octants[i].Add(v);
                    }
                    i++;
                }
            }

            for (int i=0;i<subNodes.Count;i++)
            {
                if (octants[i].Count > 0)
                {
                    Vector3 v = octants[i][0];
                    octants[i].Remove(v);
                    subNodes[i] = new OctreeNode(subNodes[i].min, subNodes[i].max, octants[i]);
                }
            }
        }

        public OctreeNode(Vector3 min, Vector3 max)
        {
            nodeBox = new BoundingBox(min, max);
        }            
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-15T22:27:39.653

我将您的代码粘贴到 Visual Studio 中的一个新项目中，并`Octree`使用几个点值调试了调用构造函数。这里有一些简单的选择可以帮助你让你的八叉树工作。

1.  在`OctreeNode(Vector3 min, Vector3 max, List<Vector3> coords)`中，一些`subNodes`没有合理的最小和最大界限。例如，`new Vector3(min.X, min.Y, max.Z), center`从`max.Z`到`center.z`。上限总是小于下限。尝试系统地列出节点以减少此类错误的可能性，如下所示：

    ```
    subNodes.Add(new OctreeNode(new Vector3(min.X,    min.Y,    min.Z),    new Vector3(center.X, center.Y, center.Z)));
    subNodes.Add(new OctreeNode(new Vector3(min.X,    min.Y,    center.Z), new Vector3(center.X, center.Y, max.Z)));
    subNodes.Add(new OctreeNode(new Vector3(min.X,    center.Y, min.Z),    new Vector3(center.X, max.Y,    center.Z)));
    subNodes.Add(new OctreeNode(new Vector3(min.X,    center.Y, center.Z), new Vector3(center.X, max.Y,    max.Z)));
    subNodes.Add(new OctreeNode(new Vector3(center.X, min.Y,    min.Z),    new Vector3(max.X,    center.Y, center.Z)));
    subNodes.Add(new OctreeNode(new Vector3(center.X, min.Y,    center.Z), new Vector3(max.X,    center.Y, max.Z)));
    subNodes.Add(new OctreeNode(new Vector3(center.X, center.Y, min.Z),    new Vector3(max.X,    max.Y,    center.Z)));
    subNodes.Add(new OctreeNode(new Vector3(center.X, center.Y, center.Z), new Vector3(max.X,    max.Y,    max.Z))); 
    ```

2.  在构造函数`OctreeNode(Vector3 min, Vector3 max)`中，您不会初始化字段`min`、`max`和`center`。结果，当最后`OctreeNode`的 s 的下限和上限始终设置为零时

    ```
     subNodes[i] = new OctreeNode(subNodes[i].min, subNodes[i].max, octants[i]); 
    ```

3.  在同一行上，您将所有点作为节点值传入，*但*实际上位于节点范围内的点除外。局部变量`v`是位于范围内的值。它被删除，`octants`之后`octants`作为节点值传递。

4.  传递给`OctreeNode`构造函数的值实际上并没有存储在任何地方，但是创建的节点总是被分割成更小的节点，并且这些值被传递给子节点。因此修复上述三个问题将导致代码无限递归。要中断递归，您需要实现一个停止条件。通常在八叉树中，条件是如果节点内的值数量足够少，则该节点不会拆分为子节点，而是将值存储在节点中。只有当节点包含足够多的值时，节点才会被拆分，并且它的值会分布在新的子节点中。

# xml - 将数据添加到 xml 的结束标记

> ID：14025215
> 
> 赞同：0
> 
> 时间：2012-12-24T19:51:47.010
> 
> 标签：xml, xml-parsing

我正在研究一种用于计时数据的架构，我正在考虑将`XML`其用于此目的。数据格式如下：

```
operation start: name, type
operation end: timing data 
```

数据可以嵌套。`XML`在某些方面自然适合这个，但是虽然我可以将开始数据存储在开始标签中，但看起来我不能对结束标签做同样的事情。或者我可以吗？

感谢您的时间。

编辑：
抱歉耽搁了，很难用移动应用程序输入这些数据......数据看起来像这样：

操作：开始：获取
操作：开始：计算
操作：结束：计算计时数据
操作：开始：回调
操作：结束：回调计时数据
操作：结束：获取计时数据

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T20:14:05.113

考虑使用以下内容：

```
<operation>
    <start>
        <name>value</name>
        <type>value</type>
    </start>
    <end>
        <timingData>value</timingData>
    </end>
</operation> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T20:36:54.883

我将使用以下之一作为基本结构：

```
<operation name="" type="">
     <!--Nested Operations -->
     <timing starttime="" endtime=""/>
</operation> 
```

或者

```
<operation name="" type="">
     <operations>
         <!--Nested Operations -->
     </operations>
     <timing starttime="" endtime=""/>
</operation> 
```

我更喜欢第一个，但 XML 数据结构往往有多个标签来表示相同标签的列表。取决于您的需求/偏好。

然后您的嵌套结构可能如下所示：

```
<operation name="" type="">
    <operation name="" type="">
    <!--Nested Operations -->
        <timing starttime="" endtime=""/>
    </operation>
    <operation name="" type="">
    <!--Nested Operations -->
        <timing starttime="" endtime=""/>
    </operation>
    <timing starttime="" endtime=""/>
</operation> 
```

或者，使用复数标记约定：

```
<operation name="" type="">
    <operations>
        <operation name="" type="">
            <operations>
                <!--Nested Operations -->
            </operations>
            <timing starttime="" endtime=""/>
        </operation>
        <operation name="" type="">
            <operations>
                <!--Nested Operations -->
            </operations>
            <timing starttime="" endtime=""/>
        </operation>
        <operation name="" type="">
            <operations>
                <!--Nested Operations -->
            </operations>
            <timing starttime="" endtime=""/>
        </operation>
    </operations>
    <timing starttime="" endtime=""/>
</operation> 
```

无论哪种方式，这只是一种方式，对于每个操作，使用填充了一些信息的开始块和结束块。

就个人而言，我认为其中任何一个都非常清楚。或者更确切地说，像 XML 一样清晰。但归根结底，您的用例（人类与计算机读取、转换、索引和报告需求）将决定您的数据结构。

# python - 检查目录和子目录中每个文件中的某些确切行

> ID：14025220
> 
> 赞同：1
> 
> 时间：2012-12-24T19:52:58.707
> 
> 标签：python, python-2.7

我正在尝试执行以下操作并遇到错误，出了什么问题？

1.根据参数打开目录和子目录中的每个文件

2.检查每个文件的版权信息是否恰好是 3 行

```
 Copyright (c) 2012 Company, Inc. 
 All Rights Reserved.
 Company Confidential and Proprietary. 
```

编码：

```
import os
import sys
userstring="Copyright (c) 2012 Company, Inc.\nAll Rights Reserved.\nCompany Confidential and Proprietary."
print len(sys.argv)
print sys.argv[1]
if len(sys.argv) < 2:
    sys.exit('Usage: python.py <build directory>')
for r,d,f in os.walk(sys.argv[1]):
    for files in f:
        with open(os.path.join(r, files), "r") as file:
            if ''.join(file.readlines()[:3]).strip() != userstring:
                print files 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T20:07:29.230

也许通过改变这些行：

```
file = open(files, "r")
if userstring not in line:  #check if each file contains the lines
    print file 
```

对这些：

```
with open(os.path.join(r, files), "r") as file:
    if ''.join(file.readlines()[:3]).strip() != userstring:
        print files 
```

你实现了你的目标。但是当你处理文件时，你应该注意坏文件坏格式和异常处理等等。

# python - 基于整数创建多个变量

> ID：14025221
> 
> 赞同：0
> 
> 时间：2012-12-24T19:53:30.583
> 
> 标签：python, variables

我想根据我定义的数字创建多个变量。
目前，我有一个客户端和一个服务器正在运行，每次客户端加入时，我都希望服务器创建一个变量。每个用户都分配了一个号码：

```
list_of_addr = []
user_num = 0
recv_verf, addr = server_socket.recvfrom(2048)
if(recv_verf == 'connect'):
    recv_user, addr = server_socket.recvfrom(2048)
    list_of_addr.append('User:' + recv_user + ' # ' + str(user_num) + '\n')
    user_num = user_num + 1
    print 'User:' + recv_user + ' # ' + str(user_num) + ' connected' 
```

我想根据这个数字在这里创建一个变量。类似于 user_(user_num) = 0。
我不知道该怎么解释。对不起，这是模糊的。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-24T20:00:19.583

不要这样做。如果您希望有一组由名称指向的动态项目，这就是 a`dict`的用途。如果您只想按特定顺序列出项目，这就是 a`list`的用途。

变量名称应保留为程序员在代码中实际编写的内容。另一条路是疯狂。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T20:07:49.650

dict 将是一个合适的解决方案：

```
list_of_addr = []
user_num = 0
recv_verf, addr = server_socket.recvfrom(2048)
if(recv_verf == 'connect'):
    recv_user, addr = server_socket.recvfrom(2048)
    list_of_addr.append(dict(user=recv_user, number=user_num))
    user_num = user_num + 1
    print 'User: {0} # {1} connected'.format(list_of_addr[-1]['user'], list_of_addr[-1]['number'] 
```

# azure - Azure 存储入门：Blob、表和 SQL Azure

> ID：14025224
> 
> 赞同：30
> 
> 时间：2012-12-24T19:53:44.357
> 
> 标签：azure, azure-sql-database, azure-blob-storage, azure-table-storage

这是一个相当大的话题，*blob vs tables vs SQL*，尽管到目前为止我读过所有内容，但我仍然无法找到一些关于何时使用的正确推理。

我们有一个多租户 SaaS Web 应用程序，我们即将迁移到 Azure。我们使用 SQL Server 2008 数据库。我们存储文档和属于文档的日志信息。有点像保管箱。

论坛指出，在考虑“大型”对象时，最好使用 Azure Tables。我们通常为每个用户存储数百个文档，其中文档的大小从 5kb 到 30mb 不等，其中绝大多数将在 1MB 左右？

何时使用 Blob、表和 Sql 是否有一些基本规则？我已经知道我不应该将我的文档存储在 SQL 中，因为它太贵了。但是什么时候将文档存储在 Blob 中会变得“有益”，什么时候我会更好地使用表格？是否有某种公式，例如：

`if (objects * MB/object * objectrequested > y) then blobs, else tables`

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-12-25T16:03:09.700

我认为 Igorek 已经解决了您对 SQL Azure 的担忧。不过，您似乎仍然对 Tables vs Blobs 有疑问。

在您的情况下，使用表存储会很烦人。ATS 中的每个属性/列最多为 64KB，因此您必须将文档拆分为多个属性，然后重新组合它们。每个实体也有 4MB 的限制，这将是一个问题。Blob 存储没有这些限制。

当您拥有具有许多需要单独存储和查询的属性的小型实体时，我倾向于使用 Azure 表存储。因此，它适用于存储对象或具有大量元数据的小型文档。

Blob 存储更适合没有大量元数据的事物。这对于可能作为文件系统上的文件运行良好的东西很有用。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-12-25T01:50:49.833

我会将文档本身存储在 Azure Blob 存储（而不是表存储）中。除了将文档存储在 SQL Azure 数据库中（每兆收费一美分（或更少，具体取决于数量））非常昂贵之外，SQL 数据库通常不是存储文档的好地方。SQL 是一种关系数据库，它提供了执行查询、连接等能力的好处。在 SQL 数据库中存储大型文档或图像通常没有任何好处，尤其是当有一个高度可扩展的中央存储系统并且存储起来非常便宜时/使用权。

现在，如果您需要搜索文档本身，我会使用类似 Lucene.NET 的工具来为基于文档的存储库提供搜索功能。

高温高压

# django - 使用 request.user 创建对象会产生不可预测的结果

> ID：14025236
> 
> 赞同：0
> 
> 时间：2012-12-24T19:55:34.327
> 
> 标签：django

我有一个模型，其外键到用户名为`ActivityEntryItem`. 一个名为的类`Logger`为创建这些模型提供了一个简化的接口。以下是一些摘录`Logger`：

```
def __init__(self, organization=None, user=None):
    result = super(Logger,self).__init__()
    if user:
        self.user = user
    if organization:
        self.organization = organization
    return result

def log(self, **kwargs):
    # Snip for the sake of brevity
    kwargs_subset['user'] = self.user
    entry = ActivityLogEntry.objects.create(**kwargs_subset) 
```

`user`使用 . 从视图传递到`__init__`as 。`request.user``Logger`

似乎一切正常。然后，我在应用程序中注册为新用户，并在设置密码和身份验证后，作为最近注册的用户触发了此代码。在这种情况下导致的`ActivityEntryItem`对象指向我之前登录的用户，而不是我在触发代码时登录的用户。

每次我重复这个过程（即邀请新用户、注册为受邀用户、触发代码）时，新创建的 ActivityLogEntry 引用的用户指向最后登录的用户，而不是实际登录的用户在。

我怀疑这与 request.user 在`SimpleLazyObject`评估之前有关。所以，我改变了`__init__`so call`self.user.pk`之后`self.user = user`。这似乎解决了这个问题。我还注意到重新启动服务器会使这个问题消失。

我怀疑这是 Django (1.4) 中的一个错误，但我想先在这里检查一下，看看是否有人对为什么会发生这种情况有任何想法。谢谢。

**编辑：**此 mixin 用于需要进行日志记录的视图中。这显示了记录器是如何实例化的，以及它最终是如何记录的。

```
class LoggerMixin(object):
    def dispatch(self, request, *args, **kwargs):
        self.logger = Logger(user=request.user)
        return super(LoggerMixin, self).dispatch(request, *args, **kwargs) 
```

# perl - 将 C 函数转换为 Perl

> ID：14025240
> 
> 赞同：1
> 
> 时间：2012-12-24T19:55:52.037
> 
> 标签：perl, binaryfiles

我在尝试转换程序[cng2jpg.c中提到的 C 函数 convertCNGFileToJPGFile 时卡住了](http://diplograph.net/files/2012-06/cng2jpg.c)

我一直在尝试在 Perl 中编写相同的内容，但对 hex、pack 和 unpack 函数没有足够的了解。

如果有人可以在 Perl 中编写类似的代码，如下所述，我将不胜感激。

```
while ((bytesRead = fread(buffer, 1, kBufferSize, inputFile))) {
    if (!isValidCNG) {
        if (bytesRead < 11 || strncmp("\xa5\xa9\xa6\xa9", (char *)(buffer + 6), 4)) {
            fprintf(stderr, "%s does not appear to be a valid CNG file\n", inputFileName);
            return 0;
        }
        isValidCNG = 1;
    }
    for (size_t i = 0; i < bytesRead; i++)
        buffer[i] ^= 0xEF;
    size_t bytesWritten = fwrite(buffer, 1, bytesRead, outputFile);
    if (bytesWritten < bytesRead) {
        fprintf(stderr, "Error writing %s\n", outputFileName);
        return 0;
    }
} 
```

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-24T21:07:27.310

如果我正确地阅读代码，它所做的一切（除了有效性检查）就是将文件中的每个字节与字节 0xEF 进行异或运算（即翻转除每个字节的第五个最低位之外的所有位）。在 Perl 中，您可以通过以下方式实现：

```
local $/ = \(2**16);  # ignore line breaks, read in 64 kiB chunks
while (<>) {
    $_ ^= "\xEF" x length;
    print;
} 
```

有效性检查只是检查输出是否实际上是一个有效的 JPEG 文件——具体来说，输出文件的第 7 到第 10 个字节是否包含魔法字[`"JFIF"`](http://en.wikipedia.org/wiki/JPEG_File_Interchange_Format)（`"\xa5\xa9\xa6\xa9"`当与 0xEF 异或时会变成魔法字）。通常，除非您希望经常在实际上不是 CNG 文件的文件上运行此代码，否则我不会为此烦恼，因为事后检查输出的有效性会更容易。（此外，如果解码的文件实际上是[Exif](http://en.wikipedia.org/wiki/Exif) JPEG 图像，则检查将失败，而该图像具有魔术词`"Exif"`。）

如果您*确实*想包含支票，应该这样做：

```
local $/ = \(2**16);  # ignore line breaks, read in 64 kiB chunks
while (<>) {
    $_ ^= "\xEF" x length;
    die "Not a valid CNG file" if $. == 1 and not /^.{6}(JFIF|Exif)/s;        
    print;
} 
```

附言。如果此代码运行速度太慢，我建议进行两个可能的改进：1) 使用更大的缓冲区，以及 b) 预先分配 0xEF 字节的掩码，而不是每次都即时重建它：

```
local $/ = \(2**20);  # ignore line breaks, read in 1 MiB chunks
my $mask = "\xEF" x $$/;
while (<>) {
    $_ ^= substr($mask, 0, length);
    die "Not a valid CNG file" if $. == 1 and not /^.{6}(JFIF|Exif)/s;        
    print;
} 
```

# sql - 使用同一选择语句中的 N 动态选择前 N

> ID：14025242
> 
> 赞同：2
> 
> 时间：2012-12-24T19:55:56.230
> 
> 标签：sql, sql-server, tsql, sql-server-2005

我有一个程序尝试在每个代理的表中插入样本，每个代理的样本数根据某些计算而变化

```
Declare @samplesize int
Declare @Top int
set @samplesize=0

;WITH DataToInsert AS
(
    Select AgentID, Surveys, LOB,(case when day(getdate())<4 then 3 else (day(getdate())) - (Surveys*3) end) SampleSize from Current_Agent_SurveyCount_HSI Where surveys<8 
)

--Insert Into Survey_Source_New (LOB, CenterName, CallDate, AgentZid, TN, Ticket, RecordingID, Cycle, [TimeStamp])  
--Select top 5 ss.LOB, CenterName, CallDate, AgentZid, TN, Ticket, RecordingID, Cycle, [TimeStamp]  
--From Survey_source_Level1 ss
--inner join DataToInsert du on ss.AgentZID=du.agentID
--where flag is null and du.samplesize>6
--order by newid()

Insert Into Survey_Source_New (LOB, CenterName, CallDate, AgentZid, TN, Ticket, RecordingID, Cycle, [TimeStamp])  
Select top (@Top) @Top=du.samplesize,ss.LOB, CenterName, CallDate, AgentZid, TN, Ticket, RecordingID, Cycle, [TimeStamp]  
From Survey_source_Level1 ss
inner join DataToInsert du on ss.AgentZID=du.agentID
where flag is null and du.samplesize<7
order by newid() 
```

我在这里得到的错误是

> *消息 4115，级别 15，状态 1，第 4 行
> TOP 子句的参数中不允许引用列“samplesize”。此处仅允许引用外部范围内的列或独立表达式和子查询。*

有解决方法吗？

任何帮助表示赞赏。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T20:31:41.580

你可以`row_number()`用来做基本上相同的事情：

```
WITH DataToInsert AS
(
    Select AgentID, Surveys, LOB,(case when day(getdate())<4 then 3 else (day(getdate())) - (Surveys*3) end) SampleSize from Current_Agent_SurveyCount_HSI Where surveys<8 
)
Insert Into Survey_Source_New (LOB, CenterName, CallDate, AgentZid, TN, Ticket, RecordingID, Cycle, [TimeStamp])  
    select LOB, CenterName, CallDate, AgentZid, TN, Ticket, RecordingID, Cycle, [TimeStamp]
    from (Select ss.LOB, CenterName, CallDate, AgentZid, TN, Ticket, RecordingID, Cycle, [TimeStamp],
                 row_number() over (order by newid()) as seqnum
          From Survey_source_Level1 ss inner join
               DataToInsert du on ss.AgentZID=du.agentID
          where flag is null and du.samplesize<7
         ) t
    where seqnum <= du.sample_size 
```

您也许可以简化一下，但我不知道`flag`是来自 du 还是 ss。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T05:44:58.437

我对同一个问题有一个额外的场景。我对现有解决方案进行了一些更改，场景是：我每天都会得到一个代理列表，并且必须向每个代理发送一组随机调查，计数取决于每个代理的一些计算。

```
--Get Agent List
;WITH AgentsList AS    
(    
    Select AgentID, Surveys, LOB,(case when day(getdate())<4 then 3 else (day(getdate())) - (Surveys*3) end) SampleSize     
    from Current_Agent_SurveyCount_FIOS Where surveys<8     
)
--Get All the Surveys for each Agent
, AgentSurveys AS
(
    select ss.LOB, ss.CenterName, ss.CallDate, ss.AgentZid, ss.TN, ss.Ticket, ss.RecordingID, ss.Cycle, ss.[TimeStamp],ss.Flag,AL.samplesize 
    from Survey_Source_Level1_Sri ss
    inner join AgentsList AL on ss.AgentZID=AL.agentID
    where flag is null 
    GROUP BY ss.LOB, ss.CenterName, ss.CallDate, ss.AgentZid, ss.TN, ss.Ticket, ss.RecordingID, ss.Cycle, ss.[TimeStamp],ss.Flag,AL.samplesize
)
--Mark random ranking for each survey
Select LOB, CenterName, CallDate, AgentZid, TN, Ticket, RecordingID, Cycle, [TimeStamp],samplesize,    
             rank() over (partition by agentzid order by newid()) as seqnum    
      From AgentSurveys
      group by LOB, CenterName, CallDate, AgentZid, TN, Ticket, RecordingID, Cycle, [TimeStamp],samplesize      
      order by agentzid,seqnum,tn 
```

现在从最后一个查询中我得到一个像

![在此处输入图像描述](../Images/434fc4d26bd5cbbe194b1cb91c57d524.png)

我需要 N 来自 SampleSize 列的每个组的 N 行数。

# asp.net - .ascx 上的控件在 .ascx.cs 中为空

> ID：14025245
> 
> 赞同：0
> 
> 时间：2012-12-24T19:56:22.630
> 
> 标签：asp.net

我正在创建一个自定义 Web 控件，但是当我在 .cs 文件中引用它时，我在 .ascx 文件上的控件为空。我错过了什么吗？

.ASCX

```
<asp:Table runat="server" BorderWidth="0" BorderStyle="None">
<asp:TableRow VerticalAlign="Middle" BorderWidth="0">
    <asp:TableCell HorizontalAlign="Center" BorderWidth="0" BorderStyle="None">
        <asp:Button ID="button" runat="server" Text="Button" />
    </asp:TableCell>
</asp:TableRow>

<asp:TableFooterRow BorderWidth="0" BorderStyle="None">
    <asp:TableCell HorizontalAlign="Center" ID="caption" Font-Size="12pt" Height="80px" VerticalAlign="Top" BorderWidth="0" BorderStyle="None" BorderColor="Transparent" />
</asp:TableFooterRow>
</asp:Table> 
```

.ASCX.CS

```
public void Process()
{
    button.Text = "ok"; //it fails here because it's null;
} 
```

测试.aspx

```
MyButton button = new MyButton();
button.Process(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T20:13:44.017

在以下情况下，控件可以为空：

1.  在 a 内`PlaceHolder`，您可以通过以编程方式将其删除来更改控件
2.  正在缓存中，asp.net 使用缓存的渲染数据而不是再次创建它
3.  在 a 内`ContentPlaceHolder`，您可以使用其他内容更改该内容
4.  一般来说，可以在运行时添加、删除和删除控件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-25T05:38:15.503

每当您想从后面的代码中添加动态控件时，您都必须在您的任何 aspx 或 ascx html 控件中添加该控件。

代码应该是这样的。：

```
Button btnNew = new MyButton();
btnNew.Process();
btnNew.Controls.Add(pnlTest); 
```

其中“pnlTest”应该是您在 ascx 页面中定义的任何 html 控件。

**更新**

这是您帖子的更新答案

```
Button btnNew = new Button();

btnNew.Click += new EventHandler(btnNew_Click);    
btnNew.ID = "btnNew";
void btnNew_Click(object sender, EventArgs e)
{
    Process();
}
btnNew.Controls.Add(pnlTest); 
```

它会为你工作。

# vim - 让 Vim 仅在插入模式下使用 Dvorak 键绑定？

> ID：14025247
> 
> 赞同：11
> 
> 时间：2012-12-24T19:56:42.037
> 
> 标签：vim, key-bindings, dvorak

我想在输入 Vim 时使用 Dvorak 布局。但是，我希望我的所有快捷方式都保持不变（就像键盘在命令模式下是 Qwerty 一样）。我试过用这个：

```
set langmap=q',e.,rp,ty,yf,ug,ic,or,pl,[/,]=,aa,so,de,fu,gi,hd,jh,kt,ln,\\;s,'-,z\\;,xq,cj,vk,bx,nb,mm,.v,/z,-[,=],Q\\",W<,E>,RP,TY,YF,UG,IC,OR,PL,{?,}+,AA,SO,DE,FU,GI,HD,JH,KT,LN,:S,"_,Z:,XQ,CJ,VK,BX,NB,MM,<W,>V,?Z 
```

在插入模式下将我的 qwerty 键映射到 dvorak，但我发现它干扰了我的一些快捷方式。我想这样做，同时将我的键盘映射到我的操作系统（Windows 7）的其余部分上的 qwerty。我怎样才能用 Vim 做到这一点？langmap 实际上是做什么的？（很难找到文档）

如果键盘在搜索模式下是 dvorak 那就太好了，但这更像是一个额外的好处。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-25T19:01:59.483

> 我想这样做，同时在我的操作系统的其余部分（Windows 7）上将我的键盘映射到 qwerty

– 所以只需使用`:set keymap=dvorak`（dvorak.vim 可以在 Ubuntu 的默认 Vim 配置中找到`vim73/keymap/`，它必须在 Windows 上也可用）。它按照您的描述进行：Dvorak 方法用于插入模式和搜索模式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-25T12:42:30.437

可以在以下位置找到 langmap 的文档

> :help 语言映射
> 
> [..] 当您在插入模式下键入文本时，字符会直接插入。在命令模式下，'langmap' 选项负责将这些特殊字符转换为键的原始含义。[..]

但如果您使用的是 qwerty 键并且只希望 dvorak 处于插入模式，则可能必须改用 keymap

# c# - 是否可以使用 arraylist 来公开 Web 服务的功能

> ID：14025248
> 
> 赞同：0
> 
> 时间：2012-12-24T19:56:46.607
> 
> 标签：c#, .net, wcf, web-services

我的应用程序被开发为将 Web 服务方法的功能公开为数组列表。当非 dotnet 客户端将其作为 Arraylist 仅以对象形式存储任何内容时，是否会出现任何并发症。此外，如果我使用通用列表而不是 arraylist 来公开功能，它是否会提高我的 Web 服务的性能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-24T20:24:24.087

主要问题`ArrayList`是它是一种过时的类型，不应该用于新的开发。请改用通用列表。

您的客户不需要了解通用列表，因为他们永远不会看到它。请记住，Web 服务*从不*公开 .NET 类型——它们公开 XML。客户端将看到具有整数内容的重复 XML 元素序列。如果您返回`List<int>`，那么他们将看到一个整数序列。如果您返回`List<complexType>`，那么他们将看到具有复杂内容的 XML 元素序列。

# php - Zend Framework 2 实现会话的最佳方式

> ID：14025252
> 
> 赞同：1
> 
> 时间：2012-12-24T19:57:27.263
> 
> 标签：php, session, implementation, zend-framework2

我有这样的代码：

```
 $sessionOptions = new SessionDbSavehandlerOptions();
        $sessionOptions->setDataColumn('data')
                       ->setIdColumn('id')
                       ->setModifiedColumn('modified')
                       ->setLifetimeColumn('lifetime')
                       ->setNameColumn('name');
        $application    = $event->getApplication();
        $serviceManager = $application->getServiceManager();
        $dbAdapter = $serviceManager->get('Zend\Db\Adapter\Adapter');
        $sessionTableGateway = new TableGateway('zf2_sessions', $dbAdapter);
        $sessionGateway = new DbTableGateway($sessionTableGateway, $sessionOptions);
        $config = $serviceManager->get('Configuration');
        $sessionConfig = new SessionConfig();
        $sessionConfig->setOptions($config['session']);
        $sessionManager = new SessionManager($sessionConfig);
        $sessionManager->setSaveHandler($sessionGateway);
        $sessionManager->start();
        Container::setDefaultManager($sessionManager); 
```

效果很好，但此代码在文件中的`onBootstrap()`方法中。`Module.php`有没有更好的方法（地点？）来实现会话？控制器插件是用于控制器的，那么这些是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-24T21:08:31.270

我的建议是使它成为一个专用的低级模块。您可以将完整的配置和实例化封装到一个简单的模块中，您可以依赖于您的进一步应用程序。

[这与我们处理邮件](https://github.com/soflomo/mail)、[日志记录](https://github.com/soflomo/log)和[缓存](https://github.com/soflomo/cache)完全相同（尽管缓存尚未完成）。在这些情况下，我们创建可以注入应用程序服务的服务。在您的情况下，我会将其设置为一个侦听器（是否封装在专用类中），您可以在`onBootstrap()`方法中对其进行初始化。

一个小例子：

```
namespace MySession;

use Zend\Session\Container;

class Module
{
    public function onBootstrap($e)
    {
        $app = $e->getApplication();
        $sm  = $app->getServiceManager();

        $manager = $sm->get('session_manager');
        $manager->start();

        Container::setDefaultManager($manager);
    }

    public function getServiceConfig()
    {
        return array(
            'factories' => array(
                'session_manager' => 'MySession\Service\SessionManagerFactory'
            ),
        );
    }
} 
```

您将会话管理器的工厂逻辑封装在工厂类中：

```
namespace MySession\Service;

use Zend\ServiceManger\FactoryInterface;
use Zend\ServiceManager\ServiceLocatorInterface;

// Your imports further here

class SessionManagerFactory implements FactoryInterface
{
    public function createService(ServiceLocatorInterface $sl)
    {
        $sessionOptions = new SessionDbSavehandlerOptions();
        $sessionOptions->setDataColumn('data')
                       ->setIdColumn('id')
                       ->setModifiedColumn('modified')
                       ->setLifetimeColumn('lifetime')
                       ->setNameColumn('name');
        $application    = $event->getApplication();
        $serviceManager = $application->getServiceManager();
        $dbAdapter = $serviceManager->get('Zend\Db\Adapter\Adapter');
        $sessionTableGateway = new TableGateway('zf2_sessions', $dbAdapter);
        $sessionGateway = new DbTableGateway($sessionTableGateway, $sessionOptions);
        $config = $serviceManager->get('Configuration');
        $sessionConfig = new SessionConfig();
        $sessionConfig->setOptions($config['session']);
        $sessionManager = new SessionManager($sessionConfig);
        $sessionManager->setSaveHandler($sessionGateway);

        return $sessionManager;
    }
} 
```

# sql-server - 如何为每个组选择前 x 条记录

> ID：14025255
> 
> 赞同：2
> 
> 时间：2012-12-24T19:57:58.280
> 
> 标签：sql-server, select, group-by, having

我尝试过这样的事情

```
select Id,UserId from myTable group by Id,UserId having COUNT(UserId)<7 
```

现在我想做的是为每个用户 ID 选择 6 条记录。但我的方法失败了。

那么正确的语法是什么？

id 是主键聚集索引

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T20:35:16.600

这应该让你非常接近

```
WITH    r ( userid, rnk )
      AS ( SELECT   userid, RANK() OVER ( PARTITION BY id ) AS rnk
           FROM     MyTable 
           GROUP BY userid)
SELECT  r.*
FROM    r
WHERE   r.Rank <= 6 
```

# java - Android屏幕方向处理问题

> ID：14025256
> 
> 赞同：5
> 
> 时间：2012-12-24T19:58:17.613
> 
> 标签：java, android, andengine, screen-orientation, live-wallpaper

我正在开发 android 动态壁纸应用程序，需要正确处理屏幕方向更改。

目前我`onConfigurationChanged`用于此目的（在这种方法中，我需要更改 LWP 屏幕元素的坐标。我使用`andengine`）。在模拟器和我的测试手机上一切正常，但我的一些使用**三星 Galaxy Note2 (t03g)**、**LG 惊险 (LGE LG-P925) 的客户**报告了在屏幕方向更改期间应用程序工作不正确的问题。

我手头没有这些电话，但可以假设问题与`onConfigurationChanged`未被呼叫有关。

使用方法是否正确`onConfigurationChanged`？也许我需要使用`onSurfaceChanges`或类似的东西？您能否建议我解决此问题的正确方法？

阿洛斯，我已添加`android:configChanges="keyboardHidden|orientation"`到我的`AndroidManifest.xml`：

```
<activity
            android:name=".WallpaperSettings"
            android:configChanges="keyboardHidden|orientation"
            android:exported="true" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.PREFERENCE" />
            </intent-filter>
        </activity> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-24T20:17:52.153

在我处理方向变化的动态壁纸中，我使用该`onConfigurationChange()`方法来检查方向变化，但我对这两款手机没有任何直接经验，尽管我从未收到任何关于它们的投诉。我的方法看起来类似于：

```
 @Override
   public void onConfigurationChanged(Configuration newConfig) {
       super.onConfigurationChanged(newConfig);

       // Checks the orientation of the screen  
       if (newConfig.orientation == Configuration.ORIENTATION_LANDSCAPE) {
         rotated = true;
       }
       else {
         rotated = false;
       }
   } 
```

在`draw()`方法中，我检查`rotated`布尔值。当方向改变时，还有额外的检查`onSurfaceChanged()`来纠正分辨率的变化。

我的清单文件中根本没有`android:configChanges="keyboardHidden|orientation"`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-24T20:14:26.580

```
 android:configChanges="orientation|screenSize" 
```

> 注意：从 Android 3.2（API 级别 13）开始，当设备在纵向和横向之间切换时，“屏幕尺寸”也会发生变化。因此，如果您想在为 API 级别 13 或更高级别（由 minSdkVersion 和 targetSdkVersion 属性声明）进行开发时防止由于方向更改而导致运行时重新启动，则除了“orientation”值之外，还必须包含“screenSize”值。也就是说，您必须声明 android:configChanges="orientation|screenSize"。但是，如果您的应用程序以 API 级别 12 或更低级别为目标，那么您的 Activity 始终会自行处理此配置更改（此配置更改不会重新启动您的 Activity，即使在 Android 3.2 或更高版本的设备上运行时也是如此）。

# mongodb - MongoDB 恢复适用于 CLI，但不适用于 BASH

> ID：14025257
> 
> 赞同：0
> 
> 时间：2012-12-24T19:58:18.853
> 
> 标签：mongodb

我不知道为什么在命令行中运行正常的命令会在 bash 脚本中出现错误。

> mongorestore -h XXXX.mongohq.com:10025 -u USER -p PASS -db pr4 DIC24/pr4

这在 CLI 上工作正常，但在 bash 脚本中我得到：

12 月 24 日星期一 19:48:52 错误：不知道如何处理文件 [DIC24/pr4]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T20:10:24.590

我发现 BASH 在另一行中更改了工作目录（我正在编辑由其他人创建的 bash 文件），因此脚本在另一个目录中运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T20:09:18.230

如果不知道连接屏幕的所有细节，很难说，但要注意特殊的 bash 字符。在自动化我通过 Bash 脚本运行的一些控制台命令时，我遇到了问题，因为其中一个凭据包含一个感叹号。

另一个想法：你是从它存储的目录执行脚本吗？

# powershell - 使用 Powershell 在网络上创建多个 RDP

> ID：14025260
> 
> 赞同：1
> 
> 时间：2012-12-24T19:58:24.893
> 
> 标签：powershell, rdp

我有一个看似简单的任务要完成——在网络上的多台机器上创建一个（或多个）远程桌面连接文件。我们的员工每天都连接到几台服务器中的一台，并且每次我们雇用新员工时都进入设置每个 .RDP 文件可能会变得非常耗时。因此，我试图通过让 powershell 在每台机器上为我创建 .RDP 文件来简化此操作。（如果它还没有）

我使用这个[人的](http://everydaynerd.com/microsoft/create-multiple-rdp-files-with-powershell)教程和代码让它在我的机器上运行。我在 powershell 中运行代码，它会在我的机器上创建我想要的 RDP 连接文件。

但是，现在我正试图弄清楚如何拥有它，以便我可以从一台机器（最好是主服务器）执行此操作，并在该个人的机器上使用正确的用户名设置每个 .RDP 文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T01:35:23.327

Powershell 的架构师写了[一篇博客文章](http://blogs.msdn.com/b/powershell/archive/2008/09/14/rdp-file-generation-use-of-here-strings.aspx)来回复您链接的教程。下面的脚本遵循了他的一些建议，并对您的需求做出了一些假设。

假设用户 Joe、Sally 和 Frank 将定期 rdp 连接到 3 个服务器，即 TS1、TS2 和 TS3。Joe 的工作站称为 CLTCOMP1，Sally 的工作站称为 CLTCOMP2，Frank 的工作站称为 CLTCOMP3。该脚本假定用户使用其域帐户登录到服务器和工作站，并创建名为 targetServer-username.rdp 的输出文件，然后将它们复制到每个工作站上用户的 Documents 文件夹中。副本假定客户端工作站运行 Vista 或更高版本，并且您可以看到并写入该目标作为 UNC 路径。为 XP 客户端调整 $destPath 将是微不足道的。在您的教程中，为了整体简单起见，我省略了有关屏幕分辨率和子文件夹的逻辑。如果需要，该逻辑可能会被重新添加，而不会有太多麻烦。

该脚本从 rdpList.csv 导入，内容如下：

```
USERNAME,COMP
joe,CLTCOMP1
sally,CLTCOMP2
frank,CLTCOMP3 
```

这是脚本：

```
$targetServers = "TS1","TS2","TS3"
$resWidth = 1024
$resHgt = 768
$domain = "DOMAIN"
#####################

$hereString = @"

audiomode:i:2
authentication level:i:0
autoreconnection enabled:i:1
bitmapcachepersistenable:i:1
compression:i:1
disable cursor setting:i:0
disable full window drag:i:1
disable menu anims:i:1
disable themes:i:1
disable wallpaper:i:1
displayconnectionbar:i:1
keyboardhook:i:2
redirectclipboard:i:1
redirectcomports:i:0
redirectdrives:i:0
redirectprinters:i:0
redirectsmartcards:i:0
session bpp:i:16
prompt for credentials:i:0
promptcredentialonce:i:1
"@

$list = import-csv rdpList.csv
forEach ($ts in $targetServers) {
 forEach ($item in $list) {
  $out = @()
  $out += "full address:s:" + $ts
  $out += "screen mode id:i:1"
  $out += "desktopwidth:i:" + $resWidth
  $out += "desktopheight:i:" + $resHgt
  $out += "username:s:" + $domain + "\" + $item.username
  $out += $hereString
  $outFileName = ".\" + $ts + "-" + $item.username + ".rdp"
  $out | out-file $outFileName
  $destPath = "\\" + $item.comp + "\c$\users\" + $item.username + "\documents\"
  copy-item $outFileName $destPath  
 } #closes foreach item
} #closes foreach ts 
```

# c++ - 可以使用 DAWG 存储单词相关信息吗？

> ID：14025262
> 
> 赞同：2
> 
> 时间：2012-12-24T19:58:39.437
> 
> 标签：c++, data-structures, dawg

是否可以使用 DAWG 存储与每条路径相关的辅助信息，例如英语中单词的频率？如果是，那我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T20:29:12.390

是的，一般来说，有向无环加权图 (DAWG) 可以通过节点、边或更复杂的结构进行注释，例如给定路径，我将采用一系列节点和边。您可以对现有结构进行子类化以包含此信息，或者如果这不可能，您可以从结构散列到注释。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-24T21:38:19.250

通常，您不能像在 trie 或其他数据结构中那样在 DAWG 中存储每个单词的信息。这样做的原因是 DAWG 中的多个不同单词可能都共享节点，因此一个单词的信息可能会“泄漏”到其他单词的信息中。

举个简单的例子，假设我们有一个 DAWG 用于单词“is”、“as”、“i”和“a”。在这种情况下，DAWG 将如下所示：

```
 START
                  a /     \ i
                   ACC    ACC
                 s  \     / s                        
                      ACC 
```

请注意，表示单词“as”和“is”的节点是完全相同的节点。因此，如果您要尝试用信息来注释单词“as”，那么保存该信息的节点也将与“is”的节点相同，这意味着“as”和“is”都会选择相同的信息集。

您可以尝试通过在节点中存储“as”和“is”的映射来解决此问题，该映射从以该节点结尾的单词映射到有关该单词的额外信息，但这会大大增加 DAWG 的内存使用量。您现在将每个字符存储在单词中，因此您的内存使用量将大幅增加（请记住，DAWG 的全部目的是减少存储一组单词所需的内存使用量）。你最好只存储一个从单词映射到信息的哈希表。

您可能尝试存储此信息的另一种选择是将通过 DAWG 的每条路径扩展到其自己的分支，以便不同单词的节点始终不同。但是，这种方法的问题在于，您正在有效地将 DAWG 转换回 trie，这会显着增加所涉及的内存使用量。

简而言之，没有直接的方法可以在不大大增加内存使用的情况下使用元信息来注释 DAWG 中的单词。如果必须这样做，最好使用不同的数据结构。

希望这可以帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-12-08T05:10:56.430

是的你可以。从 dawg 开始到单词结尾的每条路径都是唯一的，并且该路径可以索引为整数。然后可以将该索引号映射到辅助信息。

在此处查看论文：http: [//www.ic.unicamp.br/~reltech/1992/92-01.pdf](http://www.ic.unicamp.br/~reltech/1992/92-01.pdf)在此处 查看良好的实现：[https ://github.com/WojciechMula/pyDAWG/blob/master/ dawg_mph.c#L37](https://github.com/WojciechMula/pyDAWG/blob/master/dawg_mph.c#L37)

# java - 我无法从使用 Eclipse（Juno）上的 JavaCV 的人脸检测和识别代码示例代码中获得任何输出。

> ID：14025265
> 
> 赞同：1
> 
> 时间：2012-12-24T19:58:53.257
> 
> 标签：java, image-processing, opencv, face-detection, javacv

我在 Eclpise Juno 上的 JavaCv 上使用 Java 练习一些人脸识别和检测代码。问题是我试图运行下面的示例代码，但我无法获得预期的结果或输出。示例代码如下

```
 import com.googlecode.javacpp.Loader;
 import com.googlecode.javacv.*;
 import com.googlecode.javacv.cpp.*;
 import static com.googlecode.javacv.cpp.opencv_core.*;
 import static com.googlecode.javacv.cpp.opencv_imgproc.*;
 import static com.googlecode.javacv.cpp.opencv_calib3d.*;
 import static com.googlecode.javacv.cpp.opencv_objdetect.*;

public class Demo {
  public static void main(String[] args) throws Exception {
     String classifierName = null;
     if (args.length > 0) {
         classifierName = args[0];
     } else {
         System.err.println("C://opencv/data/haarcascades\"haarcascade_frontalface_alt.xml\".");
         System.exit(1);
  }

  // Preload the opencv_objdetect module to work around a known bug.
  Loader.load(opencv_objdetect.class);

  // We can "cast" Pointer objects by instantiating a new object of the desired class.
  CvHaarClassifierCascade classifier = new CvHaarClassifierCascade(cvLoad(classifierName));
  if (classifier.isNull()) {
     System.err.println("Error loading classifier file \"" + classifierName + "\".");
     System.exit(1);
  }

// CanvasFrame is a JFrame containing a Canvas component, which is hardware accelerated.
// It can also switch into full-screen mode when called with a screenNumber.
CanvasFrame frame = new CanvasFrame("Some Title");

// OpenCVFrameGrabber uses opencv_highgui, but other more versatile FrameGrabbers
// include DC1394FrameGrabber, FlyCaptureFrameGrabber, OpenKinectFrameGrabber,
// PS3EyeFrameGrabber, VideoInputFrameGrabber, and FFmpegFrameGrabber.
FrameGrabber grabber = new OpenCVFrameGrabber(0);
grabber.start();

// FAQ about IplImage:
// - For custom raw processing of data, getByteBuffer() returns an NIO direct
//   buffer wrapped around the memory pointed by imageData.
// - To get a BufferedImage from an IplImage, you may call getBufferedImage().
// - The createFrom() factory method can construct an IplImage from a BufferedImage.
// - There are also a few copy*() methods for BufferedImage<->IplImage data transfers.
IplImage grabbedImage = grabber.grab();
int width  = grabbedImage.width();
int height = grabbedImage.height();
IplImage grayImage    = IplImage.create(width, height, IPL_DEPTH_8U, 1);
IplImage rotatedImage = grabbedImage.clone();

// Let's create some random 3D rotation...
CvMat randomR = CvMat.create(3, 3), randomAxis = CvMat.create(3, 1);
// We can easily and efficiently access the elements of CvMat objects
// with the set of get() and put() methods.
randomAxis.put((Math.random()-0.5)/4, (Math.random()-0.5)/4, (Math.random()-0.5)/4);
cvRodrigues2(randomAxis, randomR, null);
double f = (width + height)/2.0;        randomR.put(0, 2, randomR.get(0, 2)*f);
                                        randomR.put(1, 2, randomR.get(1, 2)*f);
randomR.put(2, 0, randomR.get(2, 0)/f); randomR.put(2, 1, randomR.get(2, 1)/f);
System.out.println(randomR);

// Objects allocated with a create*() or clone() factory method are automatically released
// by the garbage collector, but may still be explicitly released by calling release().
// You shall NOT call cvReleaseImage(), cvReleaseMemStorage(), etc. 
//on objects allocated    this way.
CvMemStorage storage = CvMemStorage.create();

// We can allocate native arrays using constructors taking an integer as argument.
CvPoint hatPoints = new CvPoint(3);

// Again, FFmpegFrameRecorder also exists as a more versatile alternative.
FrameRecorder recorder = new OpenCVFrameRecorder("output.avi", width, height);
recorder.start();

while (frame.isVisible() && (grabbedImage = grabber.grab()) != null) {
    cvClearMemStorage(storage);

    // Let's try to detect some faces! but we need a grayscale image...
    cvCvtColor(grabbedImage, grayImage, CV_BGR2GRAY);
    CvSeq faces = cvHaarDetectObjects(grayImage, classifier, storage,
            1.1, 3, CV_HAAR_DO_CANNY_PRUNING);
    int total = faces.total();
    for (int i = 0; i < total; i++) {
        CvRect r = new CvRect(cvGetSeqElem(faces, i));
        int x = r.x(), y = r.y(), w = r.width(), h = r.height();
        cvRectangle(grabbedImage, cvPoint(x, y), cvPoint(x+w, y+h), CvScalar.RED, 1, CV_AA, 0);

        // To access the elements of a native array, use the position() method.
        hatPoints.position(0).x(x-w/10)   .y(y-h/10);
        hatPoints.position(1).x(x+w*11/10).y(y-h/10);
        hatPoints.position(2).x(x+w/2)    .y(y-h/2);
        cvFillConvexPoly(grabbedImage, hatPoints.position(0), 3, CvScalar.GREEN, CV_AA, 0);
    }

    // Let's find some contours! but first some thresholding...
    cvThreshold(grayImage, grayImage, 64, 255, CV_THRESH_BINARY);

    // To check if an output argument is null we may call either isNull() or equals(null).
    CvSeq contour = new CvSeq(null);
    cvFindContours(grayImage, storage, contour, Loader.sizeof(CvContour.class),
            CV_RETR_LIST, CV_CHAIN_APPROX_SIMPLE);
    while (contour != null && !contour.isNull()) {
        if (contour.elem_size() > 0) {
            CvSeq points = cvApproxPoly(contour, Loader.sizeof(CvContour.class),
                    storage, CV_POLY_APPROX_DP, cvContourPerimeter(contour)*0.02, 0);
            cvDrawContours(grabbedImage, points, CvScalar.BLUE, CvScalar.BLUE, -1, 1, CV_AA);
        }
        contour = contour.h_next();
    }

    cvWarpPerspective(grabbedImage, rotatedImage, randomR);

    frame.showImage(rotatedImage);
    recorder.record(rotatedImage);
    }
   recorder.stop();
   grabber.stop();
   frame.dispose();
 }
 } 
```

我得到的输出是一条以红色打印的行等。

C://opencv/data/haarcascades“haarcascade_frontalface_alt.xml”。

任何人都可以显示我错过了什么？我是图像处理的新手，所以请谁能告诉我在哪里可以获得好的教程和示例源代码，可以教我如何掌握 JavaCv 中的所有内置函数及其功能？我正在做我最后一年的项目，真的需要你的帮助。非常尊重西赛

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T13:55:58.947

该演示希望您将级联文件作为参数提供给它。它只是停止，如果它没有得到一个。

也许您想像这样更改开头：

```
public class Demo {
  public static void main(String[] args) throws Exception {
     String classifierName = "C:/opencv/data/haarcascades/haarcascade_frontalface_alt.xml";
     if (args.length > 0) {
         classifierName = args[0];
     } 
```

像这样，如果存在，它会从 cmdline 获取一个 arg，否则它会使用默认值

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T11:00:57.770

haarcascade_frontalface_alt.xml 是用于检测正面的经过训练的分类器。它通常存在于 opencv_installation_folder/opencv/data/haarcascade 文件夹中。您可以提供分类器的直接路径，而不是从命令行获取它

```
classifierName = opencv_installation_folder/opencv/data/harcascade/haarcascade_frontalface_alt.xml 
```

# cordova - Firebase with Phonegap - 在 index.html 页面上完美运行，同时在其他页面上部分工作

> ID：14025266
> 
> 赞同：1
> 
> 时间：2012-12-24T19:58:58.253
> 
> 标签：cordova, firebase

我已经开始使用 Firebase 和 Phonegap（目前仅适用于 Android，使用 Adob​​e 的在线构建工具）。我从他们的网站上获取了 Firebase 聊天示例，并将其几乎“按原样”粘贴到 index.html 页面，并与 phonegap config.xml 所需的捆绑在一起。在我的 android 手机上运行带有单个 index.html 的应用程序时 - 它运行 100%。当我将它移动到链接到 index.html 的某个内部页面（即 chat.html）时，我可以接收传入的聊天，但没有一个出去。即使相同的代码出现在 index.html 上时，它看起来也没有正确加载。

我的猜测是它与我所说的参考文献、它们的顺序和位置有关。

以下是我的代码片段，如果需要，我可以说明更多：

在 config.xml 上：

```
<feature name="http://api.phonegap.com/1.0/device" />
<feature name="http://api.phonegap.com/1.0/notification"/>
<access origin="*" /> 
```

在 index.html 上：

```
<script type="text/javascript" charset="utf-8" src="cordova-2.2.0.js"></script>
<script type="text/javascript" src="firebase.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript" src="my.js"></script>
<script type="text/javascript" src="https://ajax.aspnetcdn.com/ajax/jquery.mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script> 
```

在 chat.html 我评论了所有的脚本标签（当然也尝试了所有这些标签都存在（未注释），结果相同）。

my.js（完整）：

```
 $(document).on("mobileinit", function () {
    // Make your jQuery Mobile framework configuration changes here!

    $.support.cors = true;
    $.mobile.allowCrossDomainPages = true;
});

$(document).ready(function () {
    // Get a reference to the root of the chat data.
    var messagesRef = new Firebase('https://alon.firebaseio.com/');

    $('.send-action').click(function () {
        var name;
        if (navigator.platform == 'Win32') {
            name = 'me';
        } else {
            name = device.name + ' (' + device.uuid + ')'; //$('#nameInput').val();
        }
        var text = $('#messageInput').val();
        messagesRef.push({ name: name, text: text });
        $('#messageInput').val('');
    });

    // Add a callback that is triggered for each chat message.
    messagesRef.on('child_added', function (snapshot) {
        var message = snapshot.val();
        $('<div/>').text(message.text).prepend($('<em/>').text(message.name + ': ')).appendTo($('#messagesDiv'));
        $('#messagesDiv')[0].scrollTop = $('#messagesDiv')[0].scrollHeight;
        if (message.name != device.name + ' (' + device.uuid + ')') {
            navigator.notification.beep(1);
        }
    });
}); 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T23:14:32.630

这可能有点晚了，您可能已经意识到了 - 但是当您将所有代码移到另一个页面时，firebase 停止工作的原因是您将它移到的页面可能在根文件夹之外（即 - /chat/index.html)。

您在上面有两个脚本引用，其中源是“firebase.js”和“my.js”。这些是“相对 URL”，这意味着它们相对于包含这些文件的文档所在的位置。所以——如果你把这段代码原样放在 URL /chat/index.html 的页面上，你对这两个 js 文件的引用真的是在寻找“http://yourdomain.com/chat/firebase.js”和“http://yourdomain.com/chat/my.js”...但是如果您没有将这些文件复制到 /chat/ 目录，它们将出现 404 错误（或未找到）并且脚本不会工作。为这两个实例解决此问题的正确方法是改用“绝对 URL”。通过在每个脚本引用中添加“/”，您将使其成为绝对的，因此将“my.js”改为“/my.js”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T20:34:40.167

你在监听 deviceready 事件吗？您需要在任何使用 PhoneGap 设备 API 的页面上。我看到您正在使用 JQM，这意味着您的页面*通常会*通过 AJAX 加载，这使我的建议无效，但是如果您覆盖了它（JQM 允许您这样做），那么这将是一个问题。

# c# - 为什么我要在基类变量中实例化一个对象？

> ID：14025270
> 
> 赞同：2
> 
> 时间：2012-12-24T19:59:20.947
> 
> 标签：c#, oop

```
BaseClass obj = new SubClass(); // Subclass : BaseClass 
```

这在 OOP 中意味着什么？我什么时候想这样做而不是仅仅创建一个 SubClass 对象？如果有人能给我一个真实的例子，我真的很感激。

obs：我知道关于虚拟方法和东西有一些副作用，但我在这里真正感到困惑的是它的概念和用途。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-24T20:03:31.757

我能想到的最常见原因是在可以将多种类型的子类分配给该变量的范围内：

```
Vehicle myWheels;

if (iHaveALicense) {
    myWheels = new Car();
} else {
    myWheels = new Bus();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-24T20:02:27.597

一个非常简单的例子是考虑一个工厂类。如果一个类依赖于 some `Factory<T>`，您可以使用继承注入“具体”版本。消费类不关心具体版本*如何*工作，只关心它实现了一些契约。

“这在 OOP 中是什么意思？” - 在 C# 中，这意味着`SubClass`继承所有关于`BaseClass`并可以访问其中的所有内容`BaseClass`，减去私有成员。通过这样做，在任何`BaseClass`需要 a 的地方，`SubClass`都可以使用 a 来代替它。在我的示例中，您可以通过公开抽象基类来定义工厂应该做什么。然后继承类可以自由地实现该行为，而无需任何消费者关心工作是如何完成的。

（这只是一个例子——继承，当不被滥用时，是一种非常强大的工具。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-24T20:03:46.000

假设您有另一个继承 BaseClass 的类：

```
public class NewSubClass : BaseClass 
```

当您按照显示的方式初始化对象时，您可以这样做：

```
BaseClass obj = new SubClass();
obj = new NewSubClass(); 
```

另一方面是这样的：

```
SubClass obj = new SubClass();
obj = new NewSubClass(); 
```

根本不会编译。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-24T20:16:11.317

那将被称为多态性。

假设有一个以基类为参数的函数。

```
void my_function(Animal ani)
{
  Console.WriteLine(ani.makeSound());
} 
```

现在，如果您在基类中创建虚拟方法并在派生类中覆盖它们，然后将任何从动物派生的对象传递给函数。然后 makeSound 会根据你传递的派生对象生成声音。

这样你就不必为每一种产生声音的动物都创建这个函数。

# c++ - sqllite更新语句不起作用

> ID：14025274
> 
> 赞同：-1
> 
> 时间：2012-12-24T20:00:00.593
> 
> 标签：c++, sqlite

我对 Sqllite 更新语句有问题，它不起作用。我不知道为什么，因为一切似乎都很好。错误代码为 0

```
char *q; // query
char fp[MAX_PATH];
q="UPDATE search SET ustat=1 WHERE fpath=?";
for(int i=0; i<=6; i++){
    if(sqlite3_prepare_v2(db, q, strlen(q), &pointer, 0) == SQLITE_OK){
        //cout<<"\n\n inside loop i values is "<<i<<"\n\n";
        snprintf(fp,MAX_PATH,xbx[i].fpaths,0);
        sqlite3_bind_text(pointer, 1,  fp, strlen(fp), 0); // file name
        sqlite3_step(pointer);   // prepare statemnt Ready
        sqlite3_finalize(pointer);   
    }
} 
```

我在绑定文本语句中使用结构然后我认为问题可能是由于结构然后我将其更改为本地缓冲区但没有成功。

更新：我尝试删除循环并手动设置，但更新语句仍然没有任何问题?????? 错误代码 0

```
if(sqlite3_prepare_v2(db, q, strlen(q), &pointer, 0) == SQLITE_OK){
                        sqlite3_bind_text(pointer, 1,  xbx[0].fpaths, sizeof(xbx[0].fpaths), 0); // file name
                        sqlite3_bind_text(pointer, 1,  xbx[1].fpaths, sizeof(xbx[1].fpaths), 0);
                        sqlite3_bind_text(pointer, 1,  xbx[2].fpaths, sizeof(xbx[2].fpaths), 0);
                        sqlite3_bind_text(pointer, 1,  xbx[3].fpaths, sizeof(xbx[3].fpaths), 0);
                        sqlite3_bind_text(pointer, 1,  xbx[4].fpaths, sizeof(xbx[4].fpaths), 0);
                        sqlite3_step(pointer);   // prepare statemnt Ready   
                        sqlite3_finalize(pointer);  // delete  prepared statement
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T08:44:03.333

好的，我找到了由于 sqlite finalize 语句引起的解决方案....检查您可能错过的所有程序，并且没有放置 sqlite finalize 语句..所以问题解决了:)

```
if(sqlite3_prepare_v2(db, q, strlen(q), &pointer, 0) == SQLITE_OK){
    //cout<<"\n\n inside loop i values is "<<i<<"\n\n";
    snprintf(fp,MAX_PATH,xbx[i].fpaths,0);
    sqlite3_bind_text(pointer, 1,  fp, strlen(fp), 0); // file name
    sqlite3_step(pointer);   // prepare statemnt Ready 
    sqlite3_reset(pointer);
}
    sqlite3_finalize(pointer); 
```

}

# android - 手机上缺少 SherlockActionBar 下拉菜单，适用于模拟器

> ID：14025278
> 
> 赞同：0
> 
> 时间：2012-12-24T20:00:23.717
> 
> 标签：android, android-emulator, actionbarsherlock

我将 SherlockActionBar 添加到我的项目中，添加了一些菜单项，它在模拟器 (4.0.3) 中运行良好，但在我的手机 (Galaxy S3) 上不起作用；它只是没有出现。

我的目标是 15，清单中的最低 sdk 版本为 9：

```
<uses-sdk
    android:minSdkVersion="9"
    android:targetSdkVersion="15" />
<application
    android:icon="@drawable/dimmiicon"
    android:label="@string/app_name"
    android:theme="@style/Theme.Sherlock.Light.DarkActionBar" > 
```

代码相当简单，但也许我遗漏了一些东西。相关位...

```
import com.actionbarsherlock.app.ActionBar;
import com.actionbarsherlock.app.SherlockFragmentActivity;
import com.actionbarsherlock.view.MenuItem;

public class Launcher extends SherlockFragmentActivity  implements  OnUserAuthenticatedListener, OnDialogChatterListener, OnAnimationCompleteListener {

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.activity_launcher);

    final ActionBar ab = getSupportActionBar();
    ab.setDisplayOptions(ActionBar.DISPLAY_SHOW_CUSTOM);
    ab.setCustomView(R.layout.title_bar);

    ab.setStackedBackgroundDrawable(getResources().getDrawable(R.drawable.titlebarbackground));
    TextView txt = (TextView) findViewById(R.id.myTitle1);  
    Typeface font = Typeface.createFromAsset(getAssets(), "caviar_dreams_bold.ttf");
    txt.setTypeface(font);
    TextView txt2 = (TextView) findViewById(R.id.myTitle2);  
    Typeface font2 = Typeface.createFromAsset(getAssets(), "caviardreams.ttf");
    txt2.setTypeface(font2); 
}  
@Override
public boolean onCreateOptionsMenu(com.actionbarsherlock.view.Menu menu) {
    getSupportMenuInflater().inflate(R.menu.commonmenus, menu);
    return true;
}

@Override
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
    case android.R.id.home:

        return false;
    case R.id.search_for_product:
        performProductReview(findViewById(android.R.id.content));
        return true;
    case R.id.search_for_business:
        performCompanyReview(findViewById(android.R.id.content));
        return true;
    case R.id.search_for_service:
        performServiceReview(findViewById(android.R.id.content));
        return true;
    case R.id.search_for_person:
        performPersonReview(findViewById(android.R.id.content));
        return true;

    default:
        return super.onOptionsItemSelected(item);
    }
} 
```

和 commonmenus.xml

```
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android" >

<item
    android:id="@+id/menu_settings"
    android:orderInCategory="100"
    android:showAsAction="never"
    android:title="@string/menu_settings"/>
<item android:id="@+id/search_for_product" android:showAsAction="never" android:orderInCategory="10" android:title="@string/menu_search_for_product"></item>
<item android:id="@+id/search_for_business" android:showAsAction="never" android:orderInCategory="11" android:title="@string/menu_search_for_business"></item>
<item android:id="@+id/search_for_service" android:showAsAction="never" android:orderInCategory="12" android:title="@string/menu_review_service"></item>
<item android:id="@+id/search_for_person" android:showAsAction="never" android:orderInCategory="14" android:title="@string/menu_review_person"></item>
<item android:id="@+id/view_my_reviews" android:showAsAction="never" android:orderInCategory="15" android:title="@string/menu_view_my_reviews"></item>

</menu> 
```

我正在使用 sherlock 操作栏使用一些自定义字体来自定义标题，并且在模拟器和手机上都可以使用，但菜单只显示在模拟器上。我确实尝试使用注释掉的自定义字体代码，它没有任何区别。

只是我很清楚：3个菜单点甚至没有出现。

在花了几个小时搜索和寻找线索之后，我不知所措。任何见解将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T21:59:25.713

对于带有 Android Honeycomb+ 的设备，`ActionBarSherlock`将使用库存`ActionBar`功能，这意味着您只剩下官方的 ActionBar，它只会将旧版菜单按钮放在非常特定的场景中，请参阅此处： [http://android-developers.blogspot.co。 il/2012/01/say-goodbye-to-menu-button.html](http://android-developers.blogspot.co.il/2012/01/say-goodbye-to-menu-button.html)

在“旧版应用的操作溢出按钮”下：

> 如果您的应用在没有专用菜单按钮的设备上运行，系统会根据您在清单元素中声明支持的 API 级别来决定是否将操作溢出添加到导航栏。逻辑归结为：
> 
> 如果将 minSdkVersion 或 targetSdkVersion 设置为 11 或更高，系统将不会添加旧版溢出按钮。
> 
> 否则，系统会在 Android 3.0 或更高版本上运行时添加旧版溢出按钮。
> 
> 唯一的例外是，如果您将 minSdkVersion 设置为 10 或更低，将 targetSdkVersion 设置为 11、12 或 13，并且您不使用 ActionBar，则在 Android 4.0 或更高。

# python - Celeryd时间限制错误

> ID：14025279
> 
> 赞同：4
> 
> 时间：2012-12-24T20:00:25.600
> 
> 标签：python, django, celery, django-celery, celeryd

运行状态命令时出现以下错误：-

```
Am using rabbitmq as the messaging broker 
```

我正在关注这个[博客](http://docs.celeryproject.org/en/latest/tutorials/daemonizing.html#generic-init-scripts)

```
 sudo /etc/init.d/celeryd status
Error: No nodes replied within time constraint 
```

如何调试此错误？

我也检查了这个问题。那里的答案没有帮助。

[django/celery - 芹菜状态：错误：没有节点在时间限制内回复](https://stackoverflow.com/questions/13575711/django-celery-celery-status-error-no-nodes-replied-within-time-constraint)

编辑：-

检查 celery beat 的日志后，我发现了以下错误

```
celerybeat raised exception <class 'gdbm.error'>: error(13, 'Permission denied') 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T17:01:46.953

这可能是由于 celery 没有`celerybeat-schedule`文件的写权限引起的。您链接到的文档显示配置为`/var/run/celerybeat-schedule`用作 celery beat schedule 文件的 celery。

您的进程是否对该文件具有写入权限？如果该目录由`root`（应该是）所有并且您的进程以`root`用户以外的任何身份运行，则可能导致权限被拒绝错误。

检查您的权限是否正确，然后尝试删除该文件，然后重新启动所有内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-21T07:25:16.850

使用以下命令查找问题：

```
C_FAKEFORK=1 sh -x /etc/init.d/celeryd start 
```

这通常是因为您的源项目中存在问题（权限问题、语法错误等）

如芹菜文档中所述：-

> 如果工作人员以“OK”开始但之后几乎立即退出并且日志文件中没有任何内容，则可能存在错误，但由于守护程序标准输出已经关闭，您将无法在任何地方看到它们。对于这种情况，您可以使用 C_FAKEFORK 环境变量来跳过守护程序步骤

祝你好运

资料来源：[芹菜文档](http://celery.readthedocs.org/en/latest/tutorials/daemonizing.html#troubleshooting)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-09T16:52:24.207

我有同样的问题。重启rabbitmq修复它：

```
sudo systemctl restart rabbitmq-server 
```

奇怪的是我需要等待至少 100 秒。对我来说，我认为存在磁盘问题。

# c++ - 从文件中读取字节到短/长整数

> ID：14025280
> 
> 赞同：2
> 
> 时间：2012-12-24T20:00:31.160
> 
> 标签：c++, integer, byte

大家好！我正在尝试读取文件的前 4 个字节并将它们存储在整数变量中。这就是我正在做的事情：

```
#include <iostream>
#include <fstream>
#include <iomanip>
#include <cstring>

using namespace std;

int main(){
    ifstream is;
    is.open ("binary_file.dat", ios::binary );
    char file_version[4];
    is.read(file_version, 4);
    int fv_int;
    memcpy(&fv_int, file_version, sizeof(fv_int));
    cout << fv_int;
} 
```

但结果并不是我想的那样。程序将文件的第一个字节复制到正确的位置，但将其余字节视为 0。例子：

我的文件的前 4 个字节：

```
10101010 00101100 00101100 00101100 
```

程序执行后fv_int的内容是什么：

```
10101010 00000000 00000000 00000000 
```

有没有办法访问特定的整数字节？或者也许是从文件中读取字节的更好方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T20:03:49.823

istream::read 不完全读取 4 个字节，它返回读取的字节数。检查返回值，你的文件可能太短了

附加提示：您可以`is.read(reinterpret_cast<char*>(&fv_int), size_of(fv_int));`减少代码量并增加详细程度

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T20:12:09.693

如果我为您的程序提供前 4 个字节的文件，它会完美地读取并显示它们。如需进一步诊断，请将最后一个 cout 更改为：`cout <<sizeof(int)<<" "<<hex<<fv_int<<endl;`

# sql-server - SSDT - 数据库参考

> ID：14025281
> 
> 赞同：1
> 
> 时间：2012-12-24T20:00:33.610
> 
> 标签：sql-server, sql-server-data-tools

我在 Visual Studio 2012 中有一个数据库项目，需要通过链接服务器访问不是我设计的数据库。

我最初的方法是在 4 部分 [server].[database].[schema].[table] 中编写对数据库的访问脚本。这种方法会引发 SQL71562a 和 SQL71501 警告/错误。

通过研究，我注意到我需要做的是创建一个数据库引用。我的问题将围绕这个过程。

我认为正确的做法是从服务器上存在的其他供应商的数据库生成 DACPAC - 但我无法生成 DACPAC，因为它在 SSMS 中失败（我认为是由于加密）。

我的下一个想法是创建一个项目，该项目具有我需要从该数据库定义的架构，然后引用它（我还没有尝试过，因为起初猜测它可能是错误的方式）。

对此的任何帮助将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-16T14:08:57.553

SSMS 在提取 DACPAC 文件时非常迂腐。但是，您可以为此使用 SqlPackage 实用程序：

```
SqlPackage /Action:Extract /SourceServerName:YourServerNameHere /SourceDatabaseName:YourDatabaseNameHere /TargetFile:YourDatabaseNameHere.dacpac 
```

我遇到了一个类似的问题，解决了这个问题，并将其记录在：

[http://tangodude.wordpress.com/2014/02/05/referencing-the-sql-server-data-collectors-management-data-warehouse-in-your-ssdt-database-project/](http://tangodude.wordpress.com/2014/02/05/referencing-the-sql-server-data-collectors-management-data-warehouse-in-your-ssdt-database-project/)

虽然创建一个虚拟/存根项目确实有效，但使用 DACPAC 文件引用要简单得多。

# java - 如何退出 Java Swing 应用程序，避免从 setInputVerifier 生成消息

> ID：14025282
> 
> 赞同：3
> 
> 时间：2012-12-24T20:00:34.690
> 
> 标签：java, swing, jtextfield, documentfilter, inputverifier

我有一个文本字段，在 InputVerifier 的帮助下，我在输入数据中施加了一些约束。约束是如果文本字段为空，则会弹出错误消息。当应用程序启动时，光标停留在文本字段上 (text_field.requestFocusInWindow())。

现在，如果在任何时候单击退出按钮，应用程序应立即终止。但如果文本字段仍然为空，它会显示错误消息并且不会退出。如何解决这个问题呢？

退出代码：

```
dispose();
System.exit(0); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T20:29:24.610

好的，假设您的文本字段位于 JFrame 中。然后在框架上注册一个 WindowEventListener。捕获关闭窗口的事件并从所有文本字段中删除 InputVerifiers。然后调用 System.exit()。

# visual-c++ - 工具栏 - 图标的深度颜色

> ID：14025289
> 
> 赞同：1
> 
> 时间：2012-12-24T20:01:12.260
> 
> 标签：visual-c++, mfc, visual-studio-2005, toolbar

我想制作一个大工具栏，支持比 Visual Studio 中的默认颜色深度更多的图标。我正在使用 Visual Studio 2005，工具栏位于 CDialog 上。

我使用了找到的代码：[here](https://stackoverflow.com/questions/261559/higher-color-depth-for-mfc-toolbar-icons "这里") 但没有用。

```
int CSalariesForm::OnCreate(LPCREATESTRUCT lpCreateStruct)
{
    if (CDialog::OnCreate(lpCreateStruct) == -1)
        return -1;

    HBITMAP hBitmap = (HBITMAP) ::LoadImage(AfxGetInstanceHandle(),
        MAKEINTRESOURCE(IDR_MAINFRAME1), IMAGE_BITMAP,
        0,0, LR_CREATEDIBSECTION | LR_LOADMAP3DCOLORS);

    CBitmap bm;
    bm.Attach(hBitmap);

    CImageList m_imagelist;
    m_imagelist.Create(20, 20, ILC_COLOR8, 4, 4);
    m_imagelist.Add(&bm, (CBitmap*) NULL);

    cToolBar.Create(this);
    cToolBar.GetToolBarCtrl().SetImageList(&m_imagelist);

    cToolBar.ShowWindow(SW_SHOW);
    cToolBar.SetBarStyle(CBRS_TOOLTIPS | CBRS_FLOATING | CBRS_ALIGN_TOP | CBRS_FLYBY);
    RepositionBars(AFX_IDW_CONTROLBAR_FIRST, AFX_IDW_CONTROLBAR_LAST, 0);
    return 0;
} 
```

当我调用对话框时，没有显示工具栏。代码是什么？

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T23:20:03.643

将图像列表分配给工具栏不会创建任何工具栏按钮。此外，您的图像列表应该是类成员，而不是局部变量。

```
// header file
private:
    CImageList m_imagelist;
    CToolBar   m_toolbar; 
```

```
// source file
enum { width = 20, height = 20 }; // width and height of one button image

m_toolbar.Create(this);

// create the image list
m_imagelist.Attach(
    ImageList_LoadImage(
        AfxGetInstanceHandle(), MAKEINTRESOURCE(IDB_BITMAP1), width, 4, 
        CLR_DEFAULT, IMAGE_BITMAP, LR_CREATEDIBSECTION | LR_LOADTRANSPARENT )
);

// set button and image sizes (copied from CToolBar::LoadToolBar)
m_toolbar.SetSizes(CSize(width+7,height+7), CSize(width,height));

// set image list
m_toolbar.GetToolBarCtrl().SetImageList(&m_imagelist);

// define command ids for each button
const UINT cmdIds[] = { 
    IDOK,
    0,        // separator
    IDCANCEL,
};

// assign ids to the toolbar
m_toolbar.SetButtons(cmdIds, sizeof(cmdIds)/sizeof(UINT));

RepositionBars(AFX_IDW_CONTROLBAR_FIRST, AFX_IDW_CONTROLBAR_LAST, 0); 
```

`IDB_BITMAP1`是一个 40x20 24 位彩色位图（两个 20x20 按钮）。如果您需要对按钮的创建进行更多控制，则可以[`CToolBarCtrl::SetButtons()`](http://msdn.microsoft.com/en-us/library/bdabdzxd%28v=vs.80%29.aspx)改用。[`ImageList_LoadImage`](http://msdn.microsoft.com/en-us/library/windows/desktop/bb761557%28v=vs.85%29.aspx)有关加载图像列表的更多详细信息，请参阅。

# c++ - 使用 C++ 读取 Excel 文件的建议

> ID：14025291
> 
> 赞同：1
> 
> 时间：2012-12-24T20:01:47.737
> 
> 标签：c++, excel, csv

我正在编写一个程序，它使用从 POS 系统导出的 Excel 文档。我想从 excel 文档中读取信息，然后进行必要的计算。

我在这里遇到的问题是从 excel 文件中读取信息。我对将其转换为 CSV 持开放态度，尽管不这样做会更容易。

这是需要阅读的文档示例：

```
//sale1

35204       Sales       180.19      Cash        5

3453        arnova  child pad       92709               1

//sale2

35205       Sales       614.78      Credit Card     7

3637        panasonic fz60      96409               1

2797        Bower SCB650        9309                1

2599        Dane-Elec 16GB SDHC     9709                1 
```

我需要为第一次销售读取这些数据：例如：1.35204、2.180.19、3.Cash、4.'5'、5.92709、6.Cash

我应该提到我是一名二年级程序员，所以请保持基本！感谢任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T23:00:46.653

我在这里看到三个选项。

1.  尽可能转换为 CSV。
2.  使用一些 3rd 方 Excel 阅读器，如用于 Perl5的[Spreadsheet::ParseExcel或用于 Python 的](http://search.cpan.org/~jmcnamara/Spreadsheet-ParseExcel-0.59/lib/Spreadsheet/ParseExcel.pm)[xlrd](http://www.python-excel.org/)来转换为您的 C++ 应用程序可以消化的任何格式。
3.  通过其 COM 或 .NET（首选、更简单） [接口](http://msdn.microsoft.com/en-us/library/vstudio/wss56bz7.aspx)使用 Excel 。

# c# - JIT & 循环优化

> ID：14025300
> 
> 赞同：16
> 
> 时间：2012-12-24T20:02:42.537
> 
> 标签：c#, optimization, jit

```
using System; 

namespace ConsoleApplication1
{ 
    class TestMath
    {  
        static void Main()
        {
            double res = 0.0;

            for(int i =0;i<1000000;++i)
                res +=  System.Math.Sqrt(2.0);

            Console.WriteLine(res);

            Console.ReadKey();  
        }
    }
} 
```

通过将此代码与 c++ 版本进行基准测试，我发现性能比 c++ 版本慢 10 倍。我对此没有任何问题，但这导致我提出以下问题：

似乎（经过几次搜索）JIT 编译器无法像 c++ 编译器那样优化此代码，即只需调用一次 sqrt 并在其上应用 *1000000。

有没有办法强制 JIT 这样做？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-24T22:02:55.390

我重现，我将 C++ 版本计时为 1.2 毫秒，C# 版本计时为 12.2 毫秒。如果您查看 C++ 代码生成器和优化器发出的机器代码，原因很容易看出。它像这样重写循环（使用 C# 等效项）：

```
double temp = Math.Sqrt(2.0);
for (int i = 0; i < 1000000; ++i) {
    res += temp;
} 
```

这是两种优化的组合，称为“不变代码运动”和“循环提升”。换句话说，C++ 编译器对 sqrt() 函数有足够的了解，知道它的返回值不受周围代码的影响，因此可以随意移动。然后值得将该代码移出循环并创建一个额外的局部变量来存储结果。并且计算 sqrt() 比添加要慢。听起来很明显，但这是必须内置到优化器中并且必须考虑的规则，是许多规则之一。

是的，抖动优化器错过了那个。它无法花费与 C++ 优化器相同的时间量，这是在严重的时间限制下运行的。因为如果花费的时间太长，那么程序启动时间就会太长。

开玩笑：C# 程序员需要比代码生成器更聪明一点，并自己认识到这些优化机会。这是一个相当明显的问题。好吧，现在你无论如何都知道了：）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-24T20:17:07.450

要进行您想要的优化，编译器必须确保函数**`Sqrt()`**将始终为某个输入返回相同的值。

编译器可以做各种检查函数没有使用任何其他“外部”变量来查看它是否是无状态的。但这并不总是意味着它不会受到副作用的影响。

当一个函数在循环中被调用时，它应该在每次迭代中被调用（想想多线程环境，看看为什么这很重要）。因此，如果他想要这种优化，通常由用户决定是否将不断的东西排除在循环之外。

回到 C++ 编译器——编译器可能对其库函数进行了某些优化。许多编译器尝试优化数学库等重要库，因此这可能是特定于编译器的。

另一个很大的不同是在 C++ 中，你通常会从头文件中包含一些东西。这意味着编译器可能拥有决定函数调用在调用之间是否不变所需的所有信息。

.Net 编译器（在编译时 - Visual Studio）并不总是有所有要解析的代码。大多数库函数已经编译（进入 IL - 第一阶段）。因此考虑到第 3 方 dll，可能无法进行深度优化。在 JIT（运行时）编译中，跨程序集进行这种优化可能成本太高。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-12-24T21:41:45.700

如果`Math.Sqrt`注释为[`[Pure]`](http://msdn.microsoft.com/en-us/library/system.diagnostics.contracts.pureattribute.aspx). 然后，假设函数的参数在您的示例中是恒定的，则可以将值的计算提升到循环之外。

更重要的是，这样的循环可以合理地转换为代码：

```
double res = 1000000 * Math.Sqrt(2.0); 
```

理论上，编译器或 JIT 可以自动执行此操作。但是我怀疑它会针对实际代码中很少发生的模式进行优化。

我打开了[ReSharper 的功能请求](http://youtrack.jetbrains.com/issue/RSRP-336827)，建议设计时工具建议进行这样的重构。

# mysql - MySQL - 在更新两个表的插入触发器之后？

> ID：14025301
> 
> 赞同：2
> 
> 时间：2012-12-24T20:02:49.220
> 
> 标签：mysql, triggers, insert-update

我的 MySQL 触发器有问题。我有 3 张表**客户**、**产品**和**销售**。在**销售**中，我引用**客户**和**产品**，我想在插入新销售后更新**产品**和**客户的一些计数。**以下触发器无法更新两个表......我无法弄清楚我做错了什么。

```
DELIMITER $
CREATE TRIGGER OnSalesInsert AFTER INSERT ON Sales
FOR EACH ROW BEGIN
 UPDATE Products SET Products.sold=Products.sold+NEW.amount WHERE Products.id=NEW.product_id;
 UPDATE Customers SET Customers.amount=Customers.amount+NEW.amount WHERE Customers.id=NEW.customer_id;
END $
DELIMITER ; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T14:59:34.267

试试这个：

```
DELIMITER $$

CREATE
    /*!50017 DEFINER = 'root'@'%' */
    TRIGGER `OnSalesInsert` BEFORE INSERT ON `Sales` 
    FOR EACH ROW BEGIN

       UPDATE Products 
       SET sold = sold + new.amount 
       WHERE id = new.product_id; 

       UPDATE Customers 
       SET amount = amount + new.amount 
       WHERE id = new.customer_id;
    END;
$$

DELIMITER ; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-26T13:31:52.140

```
DELIMITER $$
create trigger UpdateAvail after insert on product_details
for each row
Begin
 Declare a1 INT;
Declare d1 VARCHAR(1);
Declare d2 VARCHAR(100);
Select count(0) INTO a1 from prod_available where P_Id=new.P_Id;
Select P_Name,P_Brand INTO d1,d2 from product where P_Id=new.P_Id;
IF a1>0 THEN
Update prod_available set P_quantity=P_quantity+new.quantity where P_Id=new.P_Id;
ELSE
insert into prod_available (P_Id,P_Name,P_Brand,P_quantity)   values                     (new.P_Id,d1,d2,new.quantity);
  END IF;
  END;
  $$
DELIMITER ; 
```

# node.js - Mongoose 条件查找

> ID：14025304
> 
> 赞同：2
> 
> 时间：2012-12-24T20:03:08.153
> 
> 标签：node.js, mongoose

我有一家商店，有些产品可以未发布 - 在前面查看时，它们是 404。但是，如果 url 中给出了“preview=1”，我想预览它们。我正在寻找一种优雅的单行方式将其插入到我的 find 函数中：

```
var preview = req.param('preview');
Product.findOne({ _id: req.params.id, publish: TRUE_OR_ANY_IF_PREVIEW_SET)}).populate('categories').exec(function(err, product) { } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-24T20:37:10.677

这不是一个单行，但这是典型的方法：

```
var query = {_id: req.params.id};
if (!preview) {
    query.publish: true
}
Product.findOne(query).populate('categories').exec(function(err, product) { } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T21:08:53.673

```
Product.findOne({
  _id: req.param('id')
  publish: req.param('preview') ? true: false
}).populate('categories').exec(function(err, product) { }); 
```

# r - 减少 R 中的列表以匹配另一个列表。

> ID：14025309
> 
> 赞同：2
> 
> 时间：2012-12-24T20:03:48.970
> 
> 标签：r, list, match

假设我有一个数据框'H'，就像这样

```
C1  C2  
a   1
b   1
c   2
d   3
e   4
f   4
g   5 
```

和一个列表 X (as.factor) 去

```
"1" "2" "4" 
```

使用 match 命令，

```
X2=H[match(X,H$C2),] 
```

仅将 H 减少到三行，并且 X 的每个元素仅存在一个实例 (a,c,e)。我应该使用什么命令将 H 简化为 X 以使在 X 中找到的所有元素实例都存在（即简化表应包含 a、b、c、e、f）？

干杯。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-24T20:22:37.550

```
> H[H$C2 %in% X,]
  C1 C2
1  a  1
2  b  1
3  c  2
5  e  4
6  f  4 
```

# java - 如何有效地为扫描仪编写带有时间戳的过滤器

> ID：14025312
> 
> 赞同：1
> 
> 时间：2012-12-24T20:03:53.650
> 
> 标签：java, hbase

我有一个 hbase 表，其中所有键都具有以下结构 ID、DATE、OTHER_DETAILS 例如：

```
10,2012-05-01,"some details"
10,2012-05-02,"some details"
10,2012-05-03,"some details"
10,2012-05-04,"some details" 
```

...

如何编写扫描以获取所有早于某个日期的行？例如 2012-05-01 和 2012-05-02 早于 2012-05-03。

```
 Scan scan = new Scan();
 Filter f = ???   
 scan.setFilter(f);
 scan.setCaching(1000);
 ResultScanner rs = table.getScanner(scan); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-25T07:35:42.313

您可以创建自己的[Filter](http://hbase.apache.org/apidocs/org/apache/hadoop/hbase/filter/Filter.html)并实现方法[filterRowKey](http://hbase.apache.org/apidocs/org/apache/hadoop/hbase/filter/Filter.html#filterRowKey%28byte%5B%5D,%20int,%20int%29)。为了使扫描更快，您还可以实现方法[getNextKeyHint](http://hbase.apache.org/apidocs/org/apache/hadoop/hbase/filter/Filter.html#getNextKeyHint%28org.apache.hadoop.hbase.KeyValue%29)，但这有点复杂。这种方法的缺点是您需要将带有过滤器的 jar 文件放入 HBase 类路径并重新启动集群。

这个过滤器的近似实现。

```
@Override
public void reset() {
    this.filterOutRow = false;
}

@Override
public Filter.ReturnCode filterKeyValue(KeyValue v) {
    if(this.filterOutRow) {
        return ReturnCode.SEEK_NEXT_USING_HINT;
    }
    return Filter.ReturnCode.INCLUDE;
}

@Override
public boolean filterRowKey(byte[] data, int offset, int length) {
    if(startDate < getDate(data) && endDate > getDate(data)) {
        this.filterOutRow = true;
    }
    return this.filterOutRow;
}

@Override
public KeyValue getNextKeyHint(KeyValue currentKV) {
    if(getDate(currentKV) < startDate){   
         String nextKey = getId(currentKV)+","+startDate.getTime();
         return KeyValue.createFirstOnRow(Bytes.toBytes(nextKey));
    }
    if(getDate(currentKV) > endDate){   
         String nextKey = (getId(currentKV)+1)+","+startDate.getTime();
         return KeyValue.createFirstOnRow(Bytes.toBytes(nextKey));
    }
    return null;  
}

@Override
public boolean filterRow() {
    return this.filterOutRow;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T20:54:28.343

将第一行的密钥存储在某处。它会始终存在于您的最终结果集中，作为“第一”行，这使得它比所有其他行都旧（我正确吗？？）

现在获取日期，您要使用它来过滤结果并使用该日期创建一个带有 RegexStringComparator 的 RowFilter。这将给出匹配指定条件的行。现在，使用您之前存储的这一行和第一行进行范围查询。

如果您有多行具有相同的日期，请说：

```
10,2012-05-04,"some details"
10,2012-05-04,"some new details" 
```

取最后一行，你会在 RowFilter 之后得到，并使用相同的技术。

高温高压

我想说你可以使用范围查询来实现这一点。其中“startrowkey”将是表格的第一行。作为第一行，它将始终是最旧的行，这意味着您的结果中将始终包含这一行。范围查询的“stoprowkey”将是包含给定日期的行。要找到停止键，您可以使用“RegexStringComparator”设置“RowFilter”。

```
byte[] startRowKey = FIRST_ROW_OF_THE_TABLE;
Scan scan = new Scan();
Filter rowFilter = new RowFilter(CompareFilter.CompareOp.EQUAL,new RegexStringComparator("YOUR_REGEX"));
scan.setFilter(filter);
ResultScanner scanner1 = table.getScanner(scan);
for (Result res : scanner1) {
    byte[] stopRowKey = res.getRow();
}
scanner1.close();

scan.setStartRow(startRowKey);
scan.setStopRow(stopRowKey);
ResultScanner scanner2 = table.getScanner(scan);
for (Result res : scanner2) {
    //you final result
} 
```

# c# - 为动态创建的数据表隐藏gridview中的列

> ID：14025316
> 
> 赞同：0
> 
> 时间：2012-12-24T20:04:13.627
> 
> 标签：c#, asp.net

我正在动态创建数据表，这意味着我的数据表列字段可能会根据存储过程返回的列而有所不同。当我使用存储过程返回数据时，我需要强制返回“ID”字段。但是当我将数据表绑定到gridview时，我不想在gridview中显示这个“ID”字段。如何使这个“ID”字段隐藏以显示gridview？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T09:21:21.640

将 gridview 的 autogenerate columns 属性保持为 false，然后将此数据表绑定到 gridview。

# vba - 需要区分大小写的格式 (Excel)

> ID：14025326
> 
> 赞同：0
> 
> 时间：2012-12-24T20:05:21.583
> 
> 标签：vba, excel

```
Sub test(sToken As String)
    Cells.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, Formula1:=sToken
    Cells.FormatConditions(Cells.FormatConditions.Count).SetFirstPriority
    With Cells.FormatConditions(1).Interior
        .Pattern = xlPatternLightVertical
        .PatternColorIndex = 4
        .ColorIndex = 10
    End With
    Cells.FormatConditions(1).StopIfTrue = False
End Sub 
```

上面代码的问题是，当我使用**Call test("a")**（例如）时，我得到了带有“a”和“A”的格式化单元格，但我只想要一个“a”。
有什么建议么？

PS：不熟练VBA和英文，请不要杀=）

* * *

好的，这里是完整的宏，以便更好地理解问题（用我蹩脚的编码技能=P）

```
Sub FormatTokens()
    Call FormatReset   'Clear formatting
    Call SetFormatting("d", xlPatternNone, 1, 44)
    Call SetFormatting("h", xlPatternCrissCross, 46, 44)
    Call SetFormatting("t", xlPatternLightVertical, 4, 10) ' Here the 1st conflict token 
    Call SetFormatting("p", xlPatternNone, 1, 10)
    Call SetFormatting("T", xlPatternNone, 4, 10) ' And here another
    Call SetFormatting("v", xlPatternGray16, 49, 24)
' Blah, blah, blah in the same style...
End Sub
Private Sub SetFormatting(sToken As String, oPat As XlPattern, iPatCol As Integer, iCol As Integer)
    Cells.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, Formula1:=sToken
    Cells.FormatConditions(Cells.FormatConditions.Count).SetFirstPriority
    With Cells.FormatConditions(1).Interior
        .Pattern = oPat
        .PatternColorIndex = iPatCol
        .ColorIndex = iCol
    End With
    Cells.FormatConditions(1).StopIfTrue = False
End Sub 
```

宏可以完成这项工作，但不能使用“t”和“T”标记

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T20:10:09.173

明确指定`Upper Case`,`Lower Case`格式。

添加要检查的条件，

```
if UCase(range.value) = UCase(sToken) then 
// do formatting
end if 
```

**编辑**

这有效：

```
Cells.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
Formula1:="=EXACT($B1,""a"")" 
```

但这不会：

```
sToken = "=EXACT($A1, """"" & sToken & """"")"
Cells.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
Formula1:=sToken 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T23:06:57.227

采用： `Formula1:= "=EXACT(A1;""" & sToken & """)"`

或者：

`Formula1:="=EXACT(" & Cells(1, 1).Address(False, False, xlA1) & ";""" & sToken & """)"`

如果你想应用到一个子范围，你可以简单地改变那个部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T00:17:11.857

好吧，在深入阅读了几个论坛之后，我找到了我需要的东西。
这里的解决方案，适用于许多不同的情况：设置自定义事件处理程序 =)从 VBA
设置事件的步骤： 1\. 创建类模块，这将是您的事件处理程序（在我的例子中命名） 2\. 给他编码：`Worksheet`
`clsWorksheetEventHandler`

```
Option Explicit

Public WithEvents WorksheetEvents As Worksheet 'As an object whose events should be handled

Private Sub WorksheetEvents_Change(ByVal Target As Range) 'Event to handle
    'Some code You need to handle this event
End Sub 
```

3\. 在您的工作模块中添加子程序来初始化和终止处理：

```
Option Explicit

Dim oWorksheetEventHandler As clsWorksheetEventHandler 'Ref for Your class
Dim colWorksheetEventHandlers As Collection 'For all referrals

Sub WorksheetEventHandlers_initialize()
    'Create new Collection to store ours handlers
    Set colWorksheetEventHandlers = New Collection 
    'Loop through worksheets
    For Each Worksheet In Worksheets
        'Create new instance of the event handler class
        Set WorksheetEventHandler = New clsWorksheetEventHandler 
        'Set it to handle events in worksheet
        Set WorksheetEventHandler.WorksheetEvents = Worksheet
        'And add it to our collection
        colWorksheetEventHandlers.Add WorksheetEventHandler
    Next Worksheet
End Sub

Sub WorksheetEwentHandlers_terminate()
    'Loop through our collection
    For Each WorksheetEventHandler In colWorksheetEventHandlers
    'Clear event handler
    Set WorksheetEventHandler = Nothing
Next WorksheetEventHandler
'And finally clear memory
Set colWorksheetEventHandlers = Nothing
End Sub 
```

4.?????????????????????
5\. 利润！！！！！！

我希望你喜欢 =)

* * *

PS：这里有一些对我有很大帮助的链接
[如何在 Excel 中创建应用程序级事件处理](http://support.microsoft.com/kb/213566/en-us)
[程序控制用户窗体上的多个文本框](http://www.ozgrid.com/forum/showthread.php?t=80631)

# r - 重要性抽样 - 蒙特卡洛积分

> ID：14025327
> 
> 赞同：1
> 
> 时间：2012-12-24T20:05:23.107
> 
> 标签：r, integration, simulation, probability, montecarlo

我正在尝试使用重要性采样来实现蒙特卡洛积分。我创建了一个简单的示例 - 我希望整合 h(x)，它具有学生 t 分布（mu = 1，sigma = 1，df = 100），但我们放大了 4 倍 - 我想在区间 [-2,2] 上积分 - f(x)，我的 h(x) 的 pdf，然后是 t(1,1,100) - 我的建议分布是 g(x)，正常 (0,1)

我无法完成这项工作......我对如何实现重要性采样以及如何使用 h(x) 的概率密度函数和建议分布 g(x) 感到困惑。我确定我的实现是错误的。我希望有人可以帮助我吗？

```
xtemp<-rnorm(100000) 
x<-xtemp[which(xtemp>=-2 & xtemp<=2)] 
hx<-dt(x,100)*4
fx<-dt(x,100) 
gx<-dnorm(x) 

IntMC<-sum(hx*fx/gx)/length(hx) 
IntAn <-(pt(2,100)-pt(-2,100))*4 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-25T21:24:33.007

由于您是从*截断*的正态分布中采样，因此不应使用正态分布的概率密度函数（`dnorm`在您的示例中），而是使用*截断的正态分布*（例如，`dtnorm`来自包`msm`）来计算权重。

尝试以下操作，它会为您提供预期的结果：

```
library(msm)  # provides the pdf of the truncated normal distribution

xtemp <- rnorm(100000) 
x <- xtemp[which(xtemp>=-2 & xtemp<=2)] 

hx <- dt(x,100)*4
gx <- dtnorm(x, lower=-2, upper=2) 

IntMC <- mean(hx/gx) 
IntAn <- (pt(2,100)-pt(-2,100))*4 
```

# c# - C# 等价于 C++ 中的 const 指针/指向 const 的指针

> ID：14025329
> 
> 赞同：4
> 
> 时间：2012-12-24T20:05:38.707
> 
> 标签：c#, c++, clr, constants

我正在学习来自 .NET 世界 (C#) 的 C++ 基础知识。

我发现有趣的一个主题是**const**关键字及其与指针的用法（const 指针/指向 const 的指针）。

我想知道是否有任何 C# 语言等效于 C++ 的 const 指针/指向 const 的指针？（我知道 C# 没有指针，我正在考虑将引用作为 C# 中的类指针类型）。

另外，出于兴趣，如果没有这样的等价物，那么不包括这样的功能背后的决定是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-24T20:29:02.943

在 C# 中没有直接等同于将引用作为“const”传递，但有其他方法可以实现其目的。最常见的方法是让你的引用类要么完全不可变（一旦构建，它的状态就永远不会改变），或者将它作为不可变的公共接口传递。后者最接近 'const' 参数合同的意图（我给你一个参考，以便你可以使用它，但我要求你不要更改它。）表现不佳的客户可能'当然，将公共接口抛弃为可变形式，但它仍然清楚地表明了意图。您也可以在 C++ 中“抛弃” const，认为这很少是一个好主意。

* * *

C++ 中的另一件事是，当您知道要传递的引用的生命周期在范围内受到限制时，您通常更愿意将其作为 const 传递。C++ 通常遵循在方法范围内的堆栈上创建和销毁对象的模式，因此对这些对象的任何引用都不应该在该范围之外持久化（因为在它们超出范围后使用它们可能会导致非常讨厌的堆栈损坏崩溃。） const 引用不应该被改变，因此强烈暗示将其存储在某个地方以供以后引用将是一个坏主意。带有 const 参数的方法承诺传递这些作用域引用是安全的。由于 C# 不允许在堆栈上（参数之外）存储对对象的引用，所以这不是一个问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-24T20:28:11.627

C#（或Java）中的常量对象（即`readonly`）的概念大致对应`object *const`于C++，即指向非常量对象的常量指针。

它有几个原因 - 因为`const`正确指定并使其在语言中有用是相当困难的。以 c++ 为例，您必须定义很多方法两次，只需对签名进行很小的更改，还有 const_cast、const 仅应用于浅层的事实等。

因此，C# 采用了一种简单的解决方案来使语言更简单——`D`按照我的理解，通过传递 const 的正确性等等采取了另一种方式（从来没有在 D 中写过一行，所以请谨慎对待）。

C#/Java 中通常的解决方案是拥有不可变的类，可能使用构建器模式，或禁止更改的简单包装器（例如，所有不可修改的集合包装另一个集合并为诸如 add 之类的变异方法抛出异常）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-09-10T16:46:19.850

8,000,000 年后，但 C# 7.2 使用类似于 const 的“in”关键字。它告诉编译器通过引用（如 ref 或 out）传递结构或原始变量，但该方法不会修改变量。

```
public void DoSomething(in int variable){
    //Whatever
} 
```

在功能上等同于 C++ 的

```
void Foo::DoSomething(int& const  variable){
    //Whatever
} 
```

甚至可以说

```
void Foo::DoSomething(int const * const variable){
    //Whatever
} 
```

根据 MSDN，在 C# 中这样做的主要原因是告诉编译器它可以通过引用传递变量，因为它不会被修改。这允许在传递大型结构时可能获得更好的性能

关于常量指针，请参阅此答案：[const 之间的区别。指针和参考？](https://stackoverflow.com/questions/2336230/difference-between-const-pointer-and-reference/2336251#2336251)

换句话说，C++ 中的引用与大多数应用程序的 const 指针非常相似。但是，C# 中的引用更接近于 C++ 中关于如何使用它们的指针。

在 C# 中作为参数传递给方法的引用对象可以重新实例化（例如，从对象实例 A 到对象实例 B），但是 B 的生命周期仅在方法范围内，并且一旦返回给调用者就被处理掉（因为指针本身是按值传递）并且调用者的引用始终指向 A。从这个意义上说，您可以在 C# 中自由地传递引用，并且知道它们不能指向不同的对象（除非使用 ref/out 关键字）。

C# 示例 -

```
class Foo
{
    //Stateful field
    public int x;

    //Constructor
    public Foo()
    {
        x = 6;  
    }
}

public class Program
{
    public static void Main()
    {
        var foo = new Foo();
        foo.x = 8;

        VarTestField(foo);      
        Console.WriteLine(foo.x);

        RefTestField(ref foo);
        Console.WriteLine(foo.x);       
    }   

    //Object passed by reference, pointer passed by value
    static void VarTestField(Foo whatever){

        whatever = new Foo();
    }
    //Object passed by reference, pointer passed by reference
    static void RefTestField(ref Foo whatever){
        whatever = new Foo();
    }
} 
```

输出：

> 8
> 
> 6

所以不，你不能在 C# 中声明一个常量指针。尽管如此，明智地使用经过验证的设计模式、算法和 OOP 基础知识，以及语言的内置语法，您可以实现所需的行为。

# java - 如何在实现BundleActivator的eclipse插件中获取getStateLocation()？

> ID：14025335
> 
> 赞同：0
> 
> 时间：2012-12-24T20:07:33.253
> 
> 标签：java, eclipse, eclipse-plugin, eclipse-rcp

我有一个扩展 AbstractUIPlugin 的插件

```
package lsclipse;
public class LSclipse extends AbstractUIPlugin { 
```

有了它，我可以使用以下代码获取状态位置目录。

```
public static final String baseDir = \
     lsclipse.LSclipse.getDefault().getStateLocation().toOSString(); 
```

这个目录映射到`WORKSPACE/.metdata/.plugin/PROJECT`哪个方便 ![在此处输入图像描述](../Images/369dbed84e82d43a55df48415a31d9ea.png)

但是，使用实现 BundleActivator 的插件

```
package lsclipse;
public class Activator implements BundleActivator { 
```

我无法获得状态位置（）。

![在此处输入图像描述](../Images/188af2316d689bcfd2ad1ef28af68920.png)

我可以`Platform.getLocation().toFile().toString();`用来获取此插件的工作区，但它是 . 的基本目录`WORKSPACE`，而不是`WORKSPACE/.metdata/.plugin/PROJECT`.

如何从 Activator 获取状态位置？我的插件是无头 RCP，所以我不想（或不能）从 AbstarctUIPlugin 继承。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T00:57:37.107

```
org.eclipse.core.runtime.Platform.java
public static IPath getStateLocation(Bundle bundle) 
```

should give you data area for the bundle.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T03:16:36.157

只需扩展没有任何 ui 依赖项但具有您提到的相同方法的 Plugin 而不是 AbstractUIPlugin。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-24T22:59:12.290

`getEnvironmentInfo()`如果您的 Activator 类支持它，唯一的选择是尝试。通过返回的 EnvironmentInfo 实例，您可以找到调用 Eclipse 时传入的任何参数。如果您正在无头运行，则可以将插件状态存储位置的可接受目录路径作为参数传入。

# asp.net - 如何将类或 id 应用于 asp:Menu 中的特定项目

> ID：14025337
> 
> 赞同：2
> 
> 时间：2012-12-24T20:08:12.470
> 
> 标签：asp.net, menu, styles, menuitem

> **可能重复：**
> [asp.net 将类添加到当前 menuItem](https://stackoverflow.com/questions/6826760/asp-net-adding-class-to-current-menuitem)

如何使用“id”或“class”属性“标记”自定义菜单项？我需要它来为其应用自定义样式。例如查看 stackoverflow 菜单 - 最后一项（问问题）有另一种风格（左边距）。

**编辑**

这是我的 .css

```
div.menu ul
{ 
list-style: none;
margin: 0px;
padding: 0px;
width: auto;
}

div.menu ul li a, div.menu ul li a:visited
{
background-color: #660000;
border: 1px #4e667d solid;
display: block;
padding: 4px 20px;
margin-left  :0px;
margin-right  :20px;
text-decoration: none;
white-space: nowrap;
color:White;
}

div.menu ul li a:hover
{
background-color: #cc0000;
color: White;
text-decoration: none;
}

div.menu ul li a:active
{
background-color: #465c71;
color:White;
text-decoration: none;
} 
```

这里来自 .master 的代码

```
 <asp:Menu ID="NavigationMenu" runat="server" CssClass="menu"EnableViewState="false" IncludeStyleBlock="false" Orientation="Horizontal"></asp:Menu> 

    protected void Page_Load(object sender, EventArgs e)
    {
        NavigationMenu.Items.Add(new MenuItem("Home",null,null,"~/Default.aspx"));
        NavigationMenu.Items.Add(new MenuItem("Home", null, null, "~/Default.aspx"));
        NavigationMenu.Items.Add(new MenuItem("Home", null, null, "~/Default.aspx"));
        NavigationMenu.Items.Add(new MenuItem("Home", null, null, "~/Default.aspx"));
        NavigationMenu.Items.Add(new MenuItem("Home", null, null, "~/Default.aspx"));

    } 
```

# android - 如何确保 Android 中的数字十进制键盘？

> ID：14025340
> 
> 赞同：13
> 
> 时间：2012-12-24T20:09:16.647
> 
> 标签：android, keyboard

我有一个需要无符号十进制输入的 EditText。

如果我使用：

```
setInputType(InputType.TYPE_CLASS_NUMBER | InputType.TYPE_NUMBER_FLAG_DECIMAL);
setKeyListener(NumericDigitsKeyListener.getInstance(false, true)); 
```

然后它在美国工作得很好，但我的欧洲客户不能使用它，因为它似乎不允许逗号作为小数点。

另一方面，如果我使用：

```
setInputType(InputType.TYPE_CLASS_NUMBER | InputType.TYPE_NUMBER_FLAG_DECIMAL);
setKeyListener(DigitsKeyListener.getInstance("01234567890.,")); 
```

那么它在美国和欧洲都可以正常工作，但在某些设备（如 Galaxy S3）上，出现的软键盘是严格数字的（没有逗号或句点）。

如何强制使用数字键盘访问适合区域设置的小数分隔符？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T00:22:27.937

一个可能的解决方案/解决方法是提供[您自己的键盘](https://stackoverflow.com/questions/9577304/how-to-make-a-android-custom-keyboard)。计算器应该很容易实现

# javascript - Javascript 不运行

> ID：14025341
> 
> 赞同：-1
> 
> 时间：2012-12-24T20:09:21.307
> 
> 标签：javascript

当用户按下提交按钮并且输入框中没有文本时，我希望出现一个错误窗口。我正在使用 JSF 为脚本创建网页和 JS。由于某种原因，脚本没有运行。

这是整个页面代码：

```
 <?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      > 
    <link rel="stylesheet" href="testcss.css" />

    <h:head>
        <title>Print to Uni</title>

        <meta http-equiv="content-type" content="text/html; charset=windows-1252" />
        <link rel="stylesheet" type="text/css" href="style.css" title="style" />
    </h:head>

    <body>
        <div id="main">
            <div id="header">

                <div id="logo">
                    <div id="logo_text">
                        <h1><a href="index.xhtml">Remote<span class="logo_colour">Printing</span></a></h1>
                        <h2>This is a web app that allows users to print to University</h2>
                    </div>
                </div>
            </div>

        </div>
    </body>
    <div id="site_content">
        <div id="content">
            <h:body>

                <h:form onsubmit="return required();">

                    Please enter your username:
                    <h:inputText id="Username" value="#{user.id}"
                                 size="20" required="true" label="Username">

                    </h:inputText><br></br><br></br>

                    To print a piece of text, please press the submit button below to upload the text:<br/><br/>
                    <h:commandButton type="Submit" value="Submit" onclick="return username_validation()" action="upload/uploadText" styleClass="Submit"/>

                </h:form>

            </h:body>
        </div>
    </div>
    <script type="text/javascript"> 

        function username_validation(){  //cannot get this to work
            if (document.getElementById("Username").value.length == 1) 
            {   
                alert("Please enter a username");        
                return false;   
            }       
            return true;   
        }

        function show_alert() { 
            var msg = "Thank you";
            alert(msg); 
        }

    </script> 
</html> 
```

这是我在用户按下提交时尝试运行的代码：

```
 function username_validation(){  //cannot get this to work
        if (document.getElementById("Username").value.length == 1) 
        {   
            alert("Please enter a username");        
            return false;   
        }       
        return true; 
```

继承人 hform ：

```
 Please enter your username:
            <h:inputText id="Username" value="#{user.id}"
                         size="20" required="true" label="Username">

            </h:inputText><br></br><br></br>

            To print a piece of text, please press the submit button below to upload the text:<br/><br/>
            <h:commandButton type="Submit" value="Submit" onclick="return username_validation()" action="upload/uploadText" styleClass="Submit"/>

        </h:form> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-24T20:16:17.293

问题是这一行：

```
if (document.getElementById("Username").value.length == 1) 
```

只有当用户名正好是一个字符时才会失败。

如果要验证用户名是否存在，请改为执行以下操作：

```
if (document.getElementById("Username").value.length < 1) 
```

# android - Android 始终在 Orientation.portrait 中显示输入

> ID：14025342
> 
> 赞同：1
> 
> 时间：2012-12-24T20:09:28.430
> 
> 标签：android

我想始终显示输入`((InputMethodManager)context.getSystemService(Context.INPUT_METHOD_SERVICE))`

当我在：

```
Configuration.ORIENTATION_LANDSCAPE mode 
```

单击输入后或单击输入后发送。

我试过这个：

```
if (event != null && 
    event.getKeyCode() == KeyEvent.KEYCODE_ENTER && 
    event.getAction() == KeyEvent.ACTION_DOWN) {
    if (Screen.getScreenOrientation(mycontext) == Configuration.ORIENTATION_LANDSCAPE) 
        Utils.hideInput(mycontext, EditTextSend);
    else
        Utils.showInput(mycontext, EditTextSend); 
```

但这对我不起作用。*是否可以仅在用户单击返回*时才隐藏输入？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-12T18:05:30.433

我的解决方案很简单：

```
return true; 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-24T21:52:12.823

您可以控制键盘的可见性`Activity`，`manifest`请查看：http: [//developer.android.com/guide/topics/manifest/activity-element.html#wsoft](http://developer.android.com/guide/topics/manifest/activity-element.html#wsoft)

要显示键盘，请*始终*使用：

```
<activity android:windowSoftInputMode="stateAlwaysVisible" ... /> 
```

# c# - 在 3 个实体之间创建导航属性

> ID：14025346
> 
> 赞同：2
> 
> 时间：2012-12-24T20:10:33.573
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, entity-framework, linq-to-entities

我有 3 个实体，我正在尝试在它们之间创建映射。

```
[Table("ContentItem")]
public class ContentItem
{
    [Key]
    [DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    public int ID { get; set; }

    public virtual Page Page { get; set; }

    [Column("PageID")]
    public int PageID { get; set; }

    public virtual ContentType ContentType { get; set; }

    [Column("ContentTypeID")]
    public int ContentTypeID { get; set; }

    public int ItemID { get; set; }
}

[Table("ContentType")]
public class ContentType
{
    [Key]
    [DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    public int ID { get; set; }

    public string Name { get; set; }

    [ForeignKey("ID")]
    public virtual HTMLContent HtmlContent { get; set; }    
 }

[Table("HTMLContent")]
public class HTMLContent
{
    [Key]
    [DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    [Column("ID")]
    public int ID { get; set; }

    public string Content { get; set; }

    public int SortOrder { get; set; }

    [Column("PageID")]
    public int PageID { get; set; }

    [Column("ContentTypeID")]
    public int ContentTypeID { get; set; }

    public virtual ContentType ContentType { get; set; }
} 
```

我目前使用 Fluent API 映射了 ContentType 和 HTMLContent 之间的关系，如下所示：

```
protected override void OnModelCreating(DbModelBuilder modelBuilder)
{
    // http://weblogs.asp.net/shijuvarghese/archive/2011/10/06/removing-edmmetadata-table-in-ef-code-first.aspx
    // We don't need the EdmMetadata table in the DB
    modelBuilder.Conventions.Remove<IncludeMetadataConvention>();

    modelBuilder.Entity<ContentType>().HasRequired(b => b.HtmlContent);

} 
```

现在使用 Linq 访问 HTMLContent，如下所示：

`var contentItems = cmsUnitOfWork.ContentItems.Find().Where(x => x.PageID == 1).ToList();`

我可以在我的视图中访问 HTMLContent：

```
@model IEnumerable<H2O.Domain.CMS.Models.ContentItem>

@foreach(var x in Model)
{
    <div id="ContentItem@(x.ID)">
    <strong>@x.ContentType.HtmlContent.Content
    </div>
} 
```

但是，它只给了我数据库中的第一个 HTMLContent 行。我希望它返回 ID 对应于 ContentItem 实体中的 ItemID 成员的 HTMLContent。由于 ItemID 可能来自 HTMLContent 以外的其他 ID，因此我无法映射直接外键。我怎样才能用实体做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T21:02:00.423

我自己是这个 MVC 的新手，但我想我可以看到你需要做什么。您可能想查看创建视图模型。与其尝试访问我还没有想到的 MVC 中的嵌套对象，不如构建一个针对您的特定需求量身定制的类。

像这样的东西：-

```
 public class ViewHtmContentAndContentItem
    {
      public ContentItem contentItems {get; set;}
      public HTMLContent HtmlContentItems {get; set;}
    } 
```

现在，当您执行 Linq 查询时，您可以在两个表中加入两个`PageId`表并将此对象返回到您的视图。

在那里您可以访问您需要的任何属性。

希望这可以帮助。

# javascript - 无法使用 jQuery 检查井字游戏方块是否为空

> ID：14025350
> 
> 赞同：0
> 
> 时间：2012-12-22T07:57:27.207
> 
> 标签：javascript, jquery

我正在编写井字游戏，但我用来检查用户是单击空方块还是已填充方块的代码对我不起作用。请找出我的错误。

```
function startgame(){
    var $board=$('#board');
    $('div.square').remove();

    for(var i=0;i<9;i++)
        $board.append($('<div/>').addClass('square').addClass('empty'));

    $('div.square.empty').click(function(){
        $this=$(this);

        if($('div.square.empty').length==0){

            displayendmsg();
        }
        else {
            $this.removeClass('empty');

            if(currentplayer=="X")
                $this.append($('<div><img src="cross.jpg">        </div>').addClass('cross').css('visibility','visible'));
            else
                $this.append($('<div><img src="circle.jpg">  </div>').addClass('circle').css('visibility','visible'));

            flipturn();
        }

    });
}; 
```

即使单击已经占用的方块，我也会进入处理程序，但我不知道为什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T09:28:55.917

[`.click()`](http://api.jquery.com/click/)在调用时将事件处理程序附加到与选择器匹配的所有元素。即使元素稍后与选择器不匹配，事件处理程序仍然存在。

相反，用于[`.on()`](http://api.jquery.com/on/)检查选择器在触发时是否仍适用于您的事件处理程序：

```
$(document).on("click", "div.square.empty", function(){ alert("Clicked an empty square!"); }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T11:37:16.120

您的问题是您仅在调用`.click(..)`函数时为与选择器匹配的元素绑定事件处理程序。但是，您希望将它绑定在所有元素上，但仅在元素具有正确的类时才触发该函数。

您可以通过使用*委托*来做到这一点。在最近的 jQuery 版本中，您可以使用以下[`.on()`](http://api.jquery.com/on/)方法执行此操作：

```
$('div.square').on('click', '.empty', function() {
    // your code here
}); 
```

# iphone - ios中的日期格式

> ID：14025356
> 
> 赞同：1
> 
> 时间：2012-12-24T20:11:49.667
> 
> 标签：iphone, ios, nsdateformatter

我想问我如何在我喜欢的设备设置 am/pm 或 24 小时什么时间和什么格式设置设备日期和时间格式？？？就像我使用这种格式

```
NSDateFormatter *formatter = [[NSDateFormatter alloc] init];
[formatter setDateFormat:@"mm-dd-yyyy"];
insertCmd = [insertCmd stringByAppendingString:formatter setDateFormat:@"MM.dd.yyyy"]; 
```

它设置了日期格式，但我想在设备中设置用户设置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T20:22:26.430

尝试这个，

```
NSDate *date = [NSDate date];
NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
[dateFormatter setTimeStyle:NSDateFormatterShortStyle];
[dateFormatter setDateStyle:NSDateFormatterShortStyle];
NSLog(@"date = %@",[dateFormatter stringFromDate:date]); 
```

这是用于将当前日期转换为字符串。它应该基于`currentLocale`设备的。你不必设置任何东西。但是，我不确定您问题中的代码是什么意思。

这是[文档](https://developer.apple.com/library/mac/#documentation/CoreFoundation/Reference/CFDateFormatterRef/Reference/reference.html#//apple_ref/doc/c_ref/kCFDateFormatterShortStyle)中提到的，

> 这些日期和时间样式的格式并不准确，因为它们取决于区域设置、用户首选项设置和操作系统版本。如果您想要精确的格式，请不要使用这些常量，例如，如果您正在解析包含固定格式的日期信息的外部数据文件。格式有几种不同的“长度”：

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T22:28:27.950

或者：

```
NSDate* date = [NSDate date];
NSDateFormatter* formatter = [[NSDateFormatter alloc] init];
[formatter setFormat:@"mm-dd-yyyy"];
NSString* dateString = [formatter stringFromDate:date];
insertCmd = [insertCmd stringByAppendingString:dateString]; 
```

# jquery - ajax 的 XMLHttpRequest 异常 101 错误

> ID：14025359
> 
> 赞同：2
> 
> 时间：2012-12-24T20:12:22.697
> 
> 标签：jquery, jquery-mobile, console

我在 Jquery 移动网站中使用此代码。但是，它给我一个错误

```
 {readyState: 0, status: 0, statusText: "Error: NETWORK_ERR: XMLHttpRequest Exception 101"} 
```

我卡在这里，无法找出问题所在！我没有找到一个好的答案。

```
$(function () {
    calldata();
});

function calldata() {
var url = "http://www.mywebsite.com/json.php" ;

var json = (function () {
    var json = null;
    $.ajax({
        'async': false,
        'global': false,
        'url': url,
        'error': function (data) { console.log(data); },
        'success': function (data) {
            json = data;
            console.log(data);
        }
    });
    return json;
})(); 

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-24T20:44:56.750

解决=P

```
 $.ajax({
        'async': false,
        'global': false,
        'dataType': 'JSON', // this line was missing
        'url': url,
        'error': function (data) { console.log(data); },
        'success': function (data) {
            json = data;
            console.log(json);
        }
    }); 
```

# html - 为什么这在 IE 10 上不起作用？

> ID：14025362
> 
> 赞同：2
> 
> 时间：2012-12-24T20:12:52.330
> 
> 标签：html

此示例代码在 IE 10 中无法按预期工作（内表没有获得剩余空间）。我去掉 .css 和其他元素只是为了突出我的问题。

我想使用内表来获取顶部 50px 线和底部 30px 线之间的所有空间。在另一个 doctype 中它可以工作，但我必须在我的项目中使用这个 doctype。

```
<!DOCTYPE html>

<html style="height: 100%">
<body style="height: 100%">
    <table style="height: 100%">
        <tr style="height: 50px">
            <td>
                &nbsp;
            </td>
        </tr>
    <tr>
            <td>
                <table style="height: 100%; background: #f00">
                    <tr>
                        <td>
                            &nbsp;
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
    <tr style="height: 30px">
            <td>
                &nbsp;
            </td>
        </tr>
    </table>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T08:34:35.290

实际上这在 IE9 中也不起作用。这不是错误，它是 IE 渲染引擎的预期行为。你的内表没有被拉伸，因为它忽略了`height:100%`. 这是因为 DOM 元素必须`height`在某些单元中具有具有指定 CSS 属性的直接父级（`height: auto`不计算在内）。如果您在`TD`（inner 的父级`TABLE`）上指定高度，则它将起作用。但是你不能指定`height: 100%-50px-30px`for `TD`，所以这个标记不适合你想要实现的布局。

您的布局是一个经典的页眉-正文-页脚，具有固定的页眉和页脚高度以及自动拉伸的正文。这是网络中非常流行的布局。有很多方法可以让它跨浏览器工作（IE、Chrome、Firefox、Safari）。我最喜欢的让它跨浏览器工作的选项（包括 IE7）：

*   使用三个 DIV，对于页眉和页脚明确指定高度，对于 body make `position:absolute; top:<header-height>; bottom:<foooter-height>`。此外，所有三个 DIV 都需要包装在一个绝对定位的容器中。

# iphone - 无法在自动布局“打开”的情况下移动 UILabel 的 Y 位置

> ID：14025368
> 
> 赞同：8
> 
> 时间：2012-12-24T20:14:22.597
> 
> 标签：iphone, objective-c, ios, autolayout

我一定在这里遗漏了一些非常明显的东西，但这是一个让我沮丧了好几天的问题。

在 xcode 4.5 上的 iOS 项目中，我在一个 XIB 中有几个标签，一个在另一个之上，在一个`UIScrollView`占据`UIView`. 每个标签都与视图一样宽，每个标签都比下一个高 20 px。有时，其中一个标签没有任何信息，因此它被设置为不可见，并且它下面的标签应该向上移动以占据空白空间。

问题是，如果在视图上选中“关闭”自动布局，标签会完全按照它们应该的方式向上移动，尽管`UIScrollView`不再滚动。如果它是**on**，无论如何标签都不会移动。

这是代码......我基本上只是使用一个快速功能将每个标签向上移动不可见标签的高度。

```
[self moveObjectBy: self.festNameLabel moveByY:-(yearsLabel.frame.size.height-2)];

// this just quickly moves a label. 
- (void)moveObjectBy:(UIView *)lbl moveByY:(int)byHeight {
    CGRect newFrame = lbl.frame;
    NSLog(@"%f, %d", newFrame.origin.y, byHeight);
    newFrame.origin.y += byHeight; //yearsLabel.frame.size.height;
    lbl.frame = newFrame;
} 
```

当它运行时，`NSLog`显示它的 Y 已经移动，但它不会在屏幕上移动。我确定它与垂直空间约束有关，但它不会让我删除约束，也不会让我将其更改为视图顶部空间以外的任何内容。就像我说的，我确定我错过了一些东西，但我已经用尽了我所知道的一切......

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-24T23:53:57.907

如果您只有一个可能被隐藏的标签，您可以将其下方的标签移至以下位置：

```
 -(void)contract {
    self.label2.hidden = YES;
    self.con2To1.constant = -34;
} 
```

顶部标签对滚动视图的顶部有一个约束，所有其他标签对它们上方和下方的标签都有 20 点的垂直距离约束。在这个例子中，我隐藏了 label2。标签都是 34 点高，因此将约束常数从 20 更改为 -34 会将现在隐藏的标签移动到其上方的标签的正上方。

要将此方法与可以隐藏的多个标签一起使用，您需要为要隐藏的每个标签及其对上面标签的约束设置一个出口。实际上，您可以在没有约束条件的情况下做到这一点，但我不知道它是否会那么健壮（它可能会选择错误的约束条件）。我可以通过遍历约束来找到与特定标签一起使用的约束，并且是该标签顶部的约束，从而可以做同样的事情：

```
-(void)hideLabel:(UILabel *) label {
    label.hidden = YES;
    for (NSLayoutConstraint *con in self.scroller.constraints) {
        if (con.firstItem == label  && con.firstAttribute == NSLayoutAttributeTop) {
            con.constant = -34;
        }
    }
} 
```

如果您愿意，可以修改相同的方法以使用动画——以下代码片段淡出您要隐藏的标签，同时为所有较低标签的上移设置动画。

```
 -(void)hideLabel:(UILabel *) label {
    for (NSLayoutConstraint *con in self.scroller.constraints) {
        if (con.firstItem == label  && con.firstAttribute == NSLayoutAttributeTop) {
            con.constant = -34;
            [UIView animateWithDuration:.5 animations:^{
                label.alpha = 0;
                [self.scroller layoutIfNeeded];
            }];
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-24T21:02:15.780

使用自动布局，您不能在子视图上设置框架 - 充其量，它会暂时工作，直到发生下一个布局传递。此时，您的约束定义的布局将重新建立。

您需要做的是修改视图上的约束。在您的情况下，在每个标签上设置特定的引脚到高度约束是明智的。然后，您可以为这些约束中的每一个创建出口。对于零高度标签，您需要将相关约束上的常量设置为零。然后下面的标签将向上移动。

根据您要移除的标签，这可能会给您留下两倍宽的间隙。您可以通过修改间距约束来删除它，或者您可以完全摆脱间距约束，只是让每个标签高一点，但彼此相邻 - 标签的内容无论如何都会垂直居中。

主要信息是您没有设置框架。您改为修改、添加和/或删除约束。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-04-28T10:53:02.833

### 如果您想快速执行此操作：

```
for item in self.view.constraints
{
    if item.firstItem .isKindOfClass(UITextField)
    {
        let newField = item.firstItem as! UITextField
        if newField == answerTextField && item.firstAttribute == NSLayoutAttribute.Top
        {
            item.constant = answerFrame.origin.y
            self.view .layoutIfNeeded()
        }
    }
    if item.firstItem .isKindOfClass(UIButton)
    {
        let newField = item.firstItem as! UIButton
        if newField == submitButton && item.firstAttribute == NSLayoutAttribute.Top
        {
            item.constant = submitFrame.origin.y
            self.view .layoutIfNeeded()
        }
    }
} 
```

# opencv - 使用 JavaCV 显示来自相机的实时图像

> ID：14025380
> 
> 赞同：1
> 
> 时间：2012-12-24T20:15:51.557
> 
> 标签：opencv, live, javacv

我正在使用 JavaCV 从网络摄像头进行动态图像处理。效果很好！我可以在图片中定义一个感兴趣的区域并在显示之前裁剪每个图像，它仍然可以每秒完成整整 30 帧而没有问题。好的！

但是，我使用 CanvasFrame 对象来显示实时图像。它工作得很好（而且很容易），但对于包含在应用程序中是完全没用的。我想将实时图像放在面板（或画布或其他任何东西）上，作为我的应用程序窗口的一个元素。

问题： CanvasFrame 存在于它自己的框架中，当我的窗口获得焦点时消失在我的窗口后面，并且当我移动我的窗口时也不会移动。

如何将实时图像放到可以与普通 UI 元素集成的元素上？

同样，我需要在 JavaCV 中替换 CanvasFrame。TIA。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T16:47:14.747

我启动了一个相机线程，它循环抓取并在 CanvasFrame 上绘制，直到按下 UI 按钮。这很好用。

作为对 UI 按钮按下的响应，我停止了线程（触发了grabber.stop）。然后我拍摄最后一张图像，并将该图像显示在面板上。这很好用（我知道如何显示图像，谢谢）。除了 CanvasFrame 是一个有点糟糕的单独窗口之外，我已经完成了。

因此，我想启动一个循环抓取并且不在 CanvasFrame 上绘制的相机线程。相反，它只保留最后一张图像的内部副本。然后为了在我的 UI 上显示，我设置了一个计时器（它可以正确触发）并在我的面板上显示最新的图像。这不起作用——面板保持空白。然而，这个案例与有效的案例有何不同？唯一的区别是相机线程中的抓取器尚未停止。当相机不在其抓取循环中时很好，但在循环时不会显示。而且我很小心地对传递给 UI 的图像进行 cvCopy，因此内存争用没有问题。

我还要说，循环显示在 CanvasFrame 上似乎会触发我的 Logitech C920 自动对焦，而只是抓取单个图像并显示它（只要抓取器停止，我就可以轻松完成）似乎不会自动-重点。

结果是 CanvasFrame 似乎在背景中做了很多棘手的事情，这些事情无法通过仅使用grabber.start、grabber.grab、grabber.stop 来匹配，然后显示在您自己的面板上。

Sam，我在 CanvasFrame 源代码中看到了你的名字，所以你应该比任何人都清楚我的 2 个场景之间的区别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T17:51:01.330

我一直在寻找可以在任何 UI 中使用的 CanvasFrame 的替代品，现在我有了。这是一个可以显示实时（或静止）图像的摇摆元素：

```
import java.awt.Graphics;
import java.awt.image.*;

import javax.swing.JPanel;

public class CamImagePanel extends JPanel {

    private BufferedImage image;

    public CamImagePanel() {
        super();
        // Note that at this point, image = null
        // so be sure to call setImage() before setVisible(true)
    }

    protected void paintComponent(Graphics g) {
        super.paintComponent(g);
        if (image != null)      // Not efficient, but safer.
            g.drawImage(image, 0, 0, this);
    }

    public void setImage(BufferedImage img) {
        image = img;
        repaint();
    }
} 
```

然后，我在主事件线程中设置了一个定时器，每秒唤醒 20 到 30 次（30-50 毫秒），在闹钟回调方法中，我只需调用 mypanel.setImage(latestPhoto); 它就像一个实时图像。

我有一个控制器对象，它有自己的线程，它尽可能快地用来自相机的图像填充缓冲区，我只是向控制器询问最新的图像。这样，不需要同步，我实际上可以要求比相机更快或更慢的图像，而且我的逻辑仍然可以正常工作。

UI 上的一个按钮会停止计时器，我可以将最终图像留在面板上，或者使用 setVisible(false) 完全关闭面板。

# c# - 实体框架代码优先不保存数据

> ID：14025386
> 
> 赞同：0
> 
> 时间：2012-12-24T20:16:51.400
> 
> 标签：c#, ef-code-first, entity-framework-5

我正在尝试通过 split Person | 完成表格拆分模式 PersonData 与 Entity Framework 5 建立 1:1 关系。我正在使用代码优先方法，因为出于某种原因，EF 5.0 不喜欢 1:1 关系作为模型优先的关系，恕我直言，这很糟糕。

两者都`Person`将`PersonData`它们的`ID`列设置为 SQL Server 中的标识，如下所示：

**人员**表：

```
|ID|
|Name|
|.....| 
```

**人员数据**表：

```
|ID|
|ID_Person|
|.....| 
```

就在`SaveChanges()`命令 SQL 返回后，我无法在表中插入标识列的显式值。

然后我改变了我的`PersonData`地图文件：

```
this.HasKey(t => t.ID).Property(p =>
p.ID).HasDatabaseGeneratedOption(DatabaseGeneratedOption.Identity); 
```

并再次尝试。现在我明白了

> *a 中的依赖属性`ReferentialConstraint`映射到存储生成的列。列：'ID'。*

我应该改变什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-25T19:48:38.510

您必须将`PersondData`主键作为外键映射到`Person`. `ID_Person`在这种情况下不能使用，因为它会导致一对多的关系（EF 不支持唯一性约束并且没有唯一性它不能建立一对一的关系）。

# string - 我想打开一个文件并替换 perl 中字符串的最后出现模式

> ID：14025387
> 
> 赞同：1
> 
> 时间：2012-12-24T20:17:00.210
> 
> 标签：string, perl, replace, pattern-matching, last-occurrence

到目前为止我已经这样做了，但它仍然无法正常工作。

```
open (GOOD_FILE,"<$pre.XXX.XXX$post") or die "Cannot open XXX";

# temporarily undefine the input line separator to read the entire file at once:
my $text = do { local $/; <GOOD_FILE> };
close GOOD_FILE or die $!;
#File name to replace XXXX.XXXXX.XXXX.XXXX.CCCC where last CCCC can be     anything 
$text =~ s/^(.*\n)?XXXX\.XXXX\.XXXX\.[^\n]*/$1myname/s;

open (GOOD_FILE,"<$pre.XXXX.XXXX$post") or die "Cannot open XXXX";
print GOOD_FILE $text;
close GOOD_FILE or die $!; 
```

输入文件如下所示：

```
I am tester testing
I am still learning.
XXXX.XXXX.XXXX.XXXX.CCCC
I am tester.
XXXX.XXXX.XXXX.XXXX.PPPP 
```

它应该产生这个输出：

```
I am tester testing
I am still learning.
XXXX.XXXX.XXXX.XXXX.CCCC
I am tester.
myname. 
```

但我得到的是空文件。

谢谢你们，我能够使用变量来解决问题，我只是将正则表达式作为变量，它工作正常。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-24T20:43:14.103

当您[打开文件](http://perldoc.perl.org/functions/open.html)以使用该模式写入时`>`，它会自动截断为零长度。

可以使用该模式同时打开一个文件进行读取和写入，而无需截断它，*但*`+<`实际上修改这样的文件有点棘手，因为它需要[seek](http://perldoc.perl.org/functions/seek.html)。

相反，有两种简单的方法可以完成您想要的。如果您知道文件总是相对较短，您可以将其读入内存，修改并写回：

```
my $filename = 'filename.txt';

open my $in, '<', $filename or die $!;
# temporarily undefine the input line separator to read the entire file at once:
my $text = do { local $/; <$in> };
close $in or die $!;

$text =~ s/^(.*\n)?MY\.FILE\.NAME\.[^\n]*/$1myname/s;

open my $out, '>', $filename or die $!;
print $out $text;
close $out or die $!; 
```

对于大文件，另一种解决方案是将输出写入临时文件，然后在完成后将临时文件移到原始文件上。这或多或少是[perl 的`-i`开关](http://perldoc.perl.org/perlrun.html#Command-Switches)所做的，它允许您逐行编辑任意长的文件（只要您有足够的磁盘空间来存储副本）。不幸的是，在您的情况下，使用此方法匹配文件中特定字符串的*最后一次*出现会有点棘手。

（我想你*可以*使用[File::ReadBackwards](http://search.cpan.org/~uri/File-ReadBackwards-1.05/ReadBackwards.pm)，但不幸的是没有 File:: *Write* Backwards 模块来配合它（由于操作系统文件 I/O 接口的限制，编写一个非常困难），所以你'基本上必须以相反的顺序将输出行写入临时文件，然后再执行第二次以将它们以正确的顺序复制回原始文件。这应该是可能的，但有点复杂。）

# javascript - 关于何时将参数传递给方法或让方法从类中获取所需的数据，是否有任何良好的实践/规则？

> ID：14025390
> 
> 赞同：0
> 
> 时间：2012-12-24T20:17:11.987
> 
> 标签：javascript, class, variables, methods

我的意思更确切地说：

```
var MyClass = function(){
    return {
        init: function(a, b, c){
            this.__a = a;
            this.__b = b;
            this.__c = c;
        }
        ,doSomething: function(){
            // when to use this:
            this.__subThingType1();
            // or this?
            this.__subThingType2(this.__a, this.__b, this.__c);
        }
        ,__subThingType1: function(){
            var a = this.__a;
            var b = this.__b;
            var c = this.__c;
            // do dirty things with a, b and c
        }
        ,__subThingType2: function(a, b, c){
            // do dirty things with a, b and c
        }
}​ 
```

什么时候应该使用 type1 或 type2？我想不出一个规则，我发现我的代码是两者之间的混合，因为有时我想我会从这个类中删除那个方法并将它放在一个库中。但这不是一个好的规则，因为有时我将方法留在课堂上，所以会发生很多混合。

*   此外，该方法应该返回一个值还是更改实例变量？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T23:39:45.067

*在实例中存储内在数据；传入外部数据作为参数。*例如，您的班级代表一个圆圈。将其中心和半径存储为内在数据。但是您的方法`intersectionWith`需要一个参数`anotherCircle`并返回相交区域。

内在和外在之间的区别并不总是那么明显，但编码并不总是那么明显。用你的判断。

更一般地说，如果您对这类事情感到困惑，您可能想了解更多有关[面向对象编程](http://en.wikipedia.org/wiki/Object-oriented_programming)范式的信息。

# ios - 在 UIImageView 中的现有图像下方添加图像

> ID：14025391
> 
> 赞同：2
> 
> 时间：2012-12-24T20:17:15.317
> 
> 标签：ios, uiimageview, subview

我将 UIImageView 子类化以创建精灵，它们在我正在开发的应用程序中在屏幕上移动。我有一个新要求，即在原始视图下方向视图添加另一个图像。如果我从头开始构建它，我会将它们合成为公共视图的子视图，并使用`sendSubviewToBack`包含需要返回到后面的图像的子视图的方法。如果必须，我会以这种方式重新设计东西，但如果在现有的 UIImageView 中有办法做到这一点，我宁愿这样做。

将新图像视为原始图像的阴影或光束。它们一起移动，但原始图像需要位于顶部。

视图将始终包含原始图像，但它可能包含也可能不包含新图像。

# c++ - 如何将二维向量中的对象设置为空指针 [C++]

> ID：14025393
> 
> 赞同：0
> 
> 时间：2012-12-24T20:17:35.020
> 
> 标签：c++

想象

```
std::vector<std::vector<Objekt>> m_pole; 
```

我们想将每个对象设置为 nullptr。但以下代码会产生 2 个错误。变量 row 和 col 未声明。

```
 std::vector<std::vector<Objekt>>::std::iterator row;
    std::vector<Objekt>::std::iterator col;

    for(row = m_pole.begin(); row != m_pole.end(); row++) {
        for(col = row->begin(); col != row->end(); col++) {
            m_pole[row][col] = nullptr;
        }
    } 
```

任何想法如何解决这个问题？谢谢你的回答，MK。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T20:24:35.357

你似乎混淆了很多事情。

首先：你有一个对象向量的向量。那挺好的！但是，它是对象，而不是指针（这很好），因此它不能为空，因为只有指针可以为空（最后一次，这很好，没有无效的内存访问，空指针异常......）。如果要处理可选元素，则必须在不同的策略之间做出决定：

1.  不将它们插入您的结构中
2.  使用指针并将它们设置为空（如果你这样做，请使用智能指针）
3.  使用 boost::optional

其次：您混淆了指针和索引

```
std::vector<std::vector<Objekt>>::iterator row_it; // where does this std came from ?
std::vector<Objekt>::iterator element_it; // the iterator points to an element

for(row_it = m_pole.begin(); row_it != m_pole.end(); ++row_it) { // Get the habit to pre-increment
    for(element_it = row_it->begin(); element_it != row->end(); ++element_it) {
        *element_it = nullptr; // This won't work, as it's an object, not a pointer
    }
} 
```

第三：c++11 有很好的迭代器（否则使用 BOOST_FOREACH）：

```
for(auto & row : m_pole) // reference is importante !
    for(auto & element : row)
        element = nullptr; // again, can't work because it's an object 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T20:29:04.153

您正在混淆迭代器和索引。使用运算符取消引用迭代器`*`。

```
for(row = m_pole.begin(); row != m_pole.end(); row++) 
{
  for(col = row->begin(); col != row->end(); col++)
    *col = nullptr;
} 
```

这是假设它`Objekt`是一个指针的 typedef 或者它有一个可以接受的赋值运算符`nullptr`。否则你需要使用`Objekt*`

但是您可以省去编写初始化循环的麻烦，只需使用`std::vector`构造函数即可。

```
std::vector<std::vector<Objekt> > m_poles(numrows, std::vector<Objekt>(numcols, nullptr)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-24T20:23:57.020

你应该使用指针：

```
std::vector<std::vector<Objekt*>> m_pole;
std::vector<std::vector<Objekt*>>::std::iterator row;
std::vector<Objekt*>::std::iterator col;

for(row = m_pole.begin(); row != m_pole.end(); row++) {
    for(col = row->begin(); col != row->end(); col++) {
        *col = nullptr;
    }
} 
```

# javascript - 加载脚本时有时会收到解析错误

> ID：14025396
> 
> 赞同：2
> 
> 时间：2012-12-24T20:17:43.813
> 
> 标签：javascript, php

我不知道你们中的一些开发人员以前是否发生过这种情况，但有时当我在浏览器上重新加载脚本时，我会收到以下**PHP**错误：

> 解析错误：语法错误，意外 $end in /.../ on ...

每次它出现时它都会指向我的脚本上的不同行号，如果我在浏览器上重新加载脚本，那么它会成功加载页面而没有错误。

我的问题是，为什么当我在浏览器上加载脚本时有时会出现此错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T20:24:07.180

`Parse error: syntax error, unexpected $end in /`手段：

你**忘**了用`}`标签关闭你的 PHP 脚本。

检查您是否在某处打开了脚本。如果你愿意，你总是可以数所有的`{`和`}`，你会发现至少有一个或多或少。:) 取决于你如何看待它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-24T20:58:27.437

我在开发网站时经常遇到这种情况，通常是因为文件没有完全通过 FTP 上传。

如果是这种情况，请尝试在浏览器中访问该页面之前稍等片刻。

# android - ORMLite 更改 onUpgrade 中的 allowGeneratedIdInsert

> ID：14025400
> 
> 赞同：0
> 
> 时间：2012-12-24T20:18:13.033
> 
> 标签：android, database, sqlite, orm, ormlite

我在我的应用程序中使用 ORMLite。`allowGeneratedIdInsert`我必须为类（表）的一个字段（行）启用标志。我通过注释做到了这一点。

现在我还需要为将更新应用程序的用户执行此操作。这意味着我需要增加数据库版本并在我的`onUpgrade`方法中执行相同的操作。

有没有一种简单的方法可以做到这一点？还是我必须复制我的数据，删除表，然后使用重新创建它`TableUtils`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T21:34:23.900

不幸的是， [ORMLite](http://ormlite.com/)对这种字段转换没有帮助。您当然可以使用 raw-update 方法来更改方法中的架构`onUpdate(...)`：

> [http://ormlite.com/docs/raw-update](http://ormlite.com/docs/raw-update)

有关升级架构的信息，请参阅文档：

> [http://ormlite.com/docs/upgrade-schema](http://ormlite.com/docs/upgrade-schema)

# facebook - facebook php sdk 自动注销用户

> ID：14025401
> 
> 赞同：2
> 
> 时间：2012-12-24T20:18:28.743
> 
> 标签：facebook, facebook-javascript-sdk, facebook-php-sdk

我正在尝试将 facebook 登录集成到我的网站中。我面临一个奇怪的问题，其中用户几乎每 10 分钟从我的网站上退出一次，尽管他仍然登录到 facebook：

我对错误的原因没有太多线索，但这可能会有所帮助。我的 javascript 代码中有一些错误，因为在那段时间里，javascript 没有被执行，我不知何故保持登录状态。

为了实现facebook登录，我在php中使用geloginUrl和getLogoutUrl函数，我还添加了一些代码以在javascript中发布在朋友的墙上等。

据我所知，这就是所有相关信息。如果可能需要任何其他详细信息才能正确回答此问题，请告诉我。

这就是我的代码的样子：

```
 $user = $facebook->getUser();

  if ($user) {
       try {
          $user_profile = $facebook->api('/me');
       } catch (FacebookApiException $e) {
          $user = 0;
       }
  } 

  if ($user) { 
    setcookie('uid', $user, time()+36000, '/', 'mywebsite.com');
    setcookie('uname', $user_profile['name'], time()+36000, '/', 'mywebsite.com');
  } else {
    setcookie('uid', $user, time()+36000, '/', 'mywebsite.com');
    setcookie('uname', $user_profile['name'], time()+36000, '/', 'mywebsite.com');
  }

  $loginUrlParams = array(
    'scope' => 'email,user_activities,friends_activities,friends_interests,user_interests',
    'redirect_uri' => 'http://mywebsite.com/getfbToken.php'
  );

  $loginUrl = "";
  $logoutUrl = "";
  $logoutUrlParams = array( 'next' => 'http://mywebsite.com/logout.php' );
  // getting login url from facebook if user is invalid
  if (!$user)
    $loginUrl = $facebook->getLoginUrl($loginUrlParams);
  else
    $logoutUrl = $facebook->getLogoutUrl($logoutUrlParams); 
```

# iphone - 如何添加用户输入的 URL？

> ID：14025410
> 
> 赞同：0
> 
> 时间：2012-12-24T20:20:28.267
> 
> 标签：iphone, objective-c, ios, xcode, uitextfield

我有一个`textField`并且`textView`我需要用户输入的 URL 是`hyperlinked`（IE），当用户输入一个网站地址时，它变得可点击，将您带到该网站，我发现很多关于如何嵌入链接的文章，而不是关于如何编码的文章用户输入网址。（如果我正在使用它很重要`coreData`）我已经选择了检测链接，`xib`但它不起作用。对此的任何帮助将不胜感激，在此先感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T21:33:48.323

UITextView 只能通过数据检测器做到这一点，即使链接是原始文本，您也无法控制用户离开应用程序。

让链接完全在您的控制之下的最简单方法是使用 DTCoreText 中的 UI 类。那些有链接的按钮，你可以做任何你喜欢的事情。

[https://github.com/Cocoanetics/DTCoreText](https://github.com/Cocoanetics/DTCoreText)

# c# - 表单在不应该关闭时关闭

> ID：14025411
> 
> 赞同：5
> 
> 时间：2012-12-24T20:20:30.483
> 
> 标签：c#, winforms

我的申请中有两个表格。我打电话的方式`Form 2`是这样的：

表格一：

```
private void btnTest_Click(object sender, EventArgs e)
{
    DialogResult result = new System.Windows.Forms.DialogResult();
    Add_Link addLink = new Add_Link();
    result=addLink.ShowDialog();

    if (result == System.Windows.Forms.DialogResult.OK)
    {
        //
    }
} 
```

表格 2：

```
private void btnAdd_Click(object sender, EventArgs e)
{            
    if(validURL(txtSubLink.Text))
    {
        HyperLink add = new HyperLink(txtSubLink.Text,txtSubText.Text,"URL");
        this.build = add;                 
    }
    else
    {
        MessageBox.Show("Valid URL Needed! " + txtSubLink.Text, "ERROR");
    }             
} 
```

我的问题是，如果用户单击`Add`按钮，则会显示错误消息（因为数据无效或文本框为空）**但**它会关闭表单。如果两个文本框包含正确的数据，我只希望用户关闭表单并将数据传回。如果两个文本框不包含正确的数据**或**为空，则当用户单击添加时，应显示错误消息，并且`Form 2`应保持打开状态，我该如何实现...？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-24T20:24:07.300

我怀疑您`btnAdd`的`DialogResult`属性设置为`OK`. 取消设置，然后`this.DialogResult = DialogResult.OK`在您对输入满意时添加事件处理程序。

```
private void btnAdd_Click(object sender, EventArgs e)
{

    if(validURL(txtSubLink.Text))
    {
         HyperLink add = new HyperLink(txtSubLink.Text,txtSubText.Text,"URL");
         this.build = add;
         this.DialogResult = DialogResult.OK;

    }
    else
    {
        MessageBox.Show("Valid URL Needed! " + txtSubLink.Text, "ERROR");
    }

} 
```

# backbone.js - Backbone Model.fetch 返回数据但不更新模型

> ID：14025415
> 
> 赞同：6
> 
> 时间：2012-12-24T20:21:59.377
> 
> 标签：backbone.js

从服务器获取我的模型时遇到问题。我在 chrome 开发工具中看到从服务器返回的正确 JSON，但模型没有使用返回的值进行更新。

```
var listtemplate = new ListTemplateModel.Model({id: id});
listtemplate.fetch();
```

此时我在 Chrome 开发工具中看到了正确的数据。以下是从服务器返回的内容：

```
{
  "title": "模板一",
  "id": "template_one",
  “脚步”： [
    {
      “描述”：“我喜欢它”，
      “身份证”：1，
      “created_at”：“2012-12-24T18:01:48.402Z”
    },
    {
      "description": "这是垃圾！",
      “身份证”：1，
      “created_at”：“2012-12-24T18:01:48.402Z”
    }
  ],
  “created_at”：“2012-12-24T18:01:48.402Z”
}

```

但是记录 JSON 的控制台只显示默认值和模型创建期间传入的 id。

```
console.log(listtemplate.toJSON());
```

这会返回：

```
{id：“template_one”，标题：“”，步骤：数组[0]}

```

我的模型看起来像这样（我使用的是 Require.js，因此模型已重命名为上面的 ListTemplateModel）

```
var 模型 = B.Model.extend({
        默认值：{
            标题： ''，
            编号：0，
            脚步： []
        },
        urlRoot: 'xxx'
    });

```

有任何想法吗？

**编辑** @Amulya 的回答让我走上了正轨，然后我发现了“then”。希望这可以帮助遇到同样问题的人：

```
listtemplate.fetch().then(function(){
   //更新视图
});
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-24T20:39:07.417

原因可能是因为您没有等待获取完成。试试这个：

```
var listtemplate = new ListTemplateModel.Model({id: id});
listtemplate.fetch({
    success: function() {
        // fetch successfully completed
        console.log(listtemplate.toJSON());
    },
    error: function() {
        console.log('Failed to fetch!');
    }
}); 
```

# jquery - 如何向我的内容滑块添加项目符号导航？

> ID：14025418
> 
> 赞同：0
> 
> 时间：2012-12-24T20:22:17.003
> 
> 标签：jquery, navigation, slider

我是一个 jQuery 初学者，我一直在根据我最近看到的一些教程构建一个内容滑块。

问题是：我不知道如何构建一个子弹导航来完成它。

到目前为止，这是我的代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
   <html xmlns="http://www.w3.org/1999/xhtml">
      <head>
         <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
         <title>My content slider</title>    
         <style type="text/css">
            body {
               margin: 0 0 0 0;
            }
           .slider {
              width: 100%;
              height: 400px;
              overflow: hidden;
           }
           .slider div {
              width: 100%;
              height: 400px;
              display: none;
           }
           .img {
              width: 100%;
              height: 400px;
           }
           h1 {
              text-align: center;
              color:#F00;
              margin: auto;
              padding-top: 45px;
           }
        </style>
        <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
        <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.9.2/jquery-ui.min.js"></script>
        <script type="text/javascript">
           function Slider() {
              $(".slider #1").show("fade", 500);
              $(".slider #1").delay(5500)
                 .hide("slide", {direction: "left"}, 500);

              var sc=$(".slider div").size();
              var count=2;

              setInterval(function (){
                 $(".slider #"+count).show("slide", {direction: "right"}, 500);
                 $(".slider #" + count).delay(5500).hide("slide", {direction: "left"}, 500);

                 if(count==sc){
                    count=1;
                 } else {
                    count = count + 1;
                 }

              }, 6500);
           }
        </script>
     </head>
     <body onload="Slider();">
        <div class="slider">
           <div class="img" id="1" style="background-color:#0F0;">
              <h1>My text is here</h1>
           </div>
           <div class="img" id="2" style="background-color:#000;">
              <h1>My text is here</h1>
           </div>
           <div class="img" id="3" style="background-color:#FF0;">
              <h1>My text is here</h1>
           </div>
        </div>
     </body>
  </html> 
```

请有人帮我解决这个问题吗？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T21:00:06.853

你想要[http://www.w3schools.com/html/html_lists.asp](http://www.w3schools.com/html/html_lists.asp)吗？

你可以试试这个：

```
 <ul type="square">
     <li>Your text goes here</li>
    </ul>
    <ul type="circle">
     <LI>Your text goes here</li>
     <LI>Your text goes here</li>
     <LI>Your text goes here</li>
    </ul>
    <ul type="disc">
     <li>Your text goes here</li>
     <li>Your text goes here</li>
    </ul> 
```

您还可以使用 CSS 使用您自己的手动要点：

```
 <style>
      ul { 
       list-style-image: url(/images/tick.gif); 
      } 
     </style> 
```

通过使用嵌套锚标记 (< a >)，您也可以将 URL 链接到它，也可以用于导航菜单。

```
 <ul type="disc">
     <li><a href="#">Your linked text goes here </a></li>
     <li><a href="#">Your linked text goes here </a></li>
    </ul> 
```

# blackberry-webworks - 如何在黑莓剧本上部署带有调试令牌的应用程序？

> ID：14025419
> 
> 赞同：0
> 
> 时间：2012-12-24T20:22:19.890
> 
> 标签：blackberry-webworks, blackberry-playbook, blackberry-10

我可以`t deploy an unsigned bar to my playbook device , because the of : failure 881 application author does not match debug token author. How can I fix this ? I`使用 bb10 sdk 安装调试令牌，所以在我的设备上，在我的安全 >> 开发模式选项卡中，我有：调试令牌......。安装有效............是的作者............ - 到期 Thu Jan 17 2013 04:19:43 PM

我尝试使用/不使用标签进行 2 次部署

配置文件

```
<?xml version="1.0" encoding="UTF-8"?>
<widget xmlns="http://www.w3.org/ns/widgets"
xmlns:rim="http://www.blackberry.com/ns/widgets"
version="1.0.0.0"
>

<name>AppDev2.0</name>
<author>-</author> <!-- and without <></> and still pops me the failure 881 author problem -->
<icon src="assets/icon.png"/>

<content src="index.html"/>

<rim:permissions>
    <rim:permit>access_location_services</rim:permit>
</rim:permissions>

<!-- for flickr search data (json) -->
<access uri="http://api.flickr.com" />
<!-- for flickr images from farm1\. to farm9\.  -->
<access uri="http://staticflickr.com/" subdomains="true" />

<!-- for google image search data (json) -->
<access uri="https://ajax.googleapis.com" />
<!-- for google images from t0\. to t3\. -->
<access uri="http://gstatic.com" subdomains="true"/>

<!-- for weather data (xml) from free. and icons from www. -->
<access uri="http://worldweatheronline.com/" subdomains="true"/>

<!-- used to create dialogs (location-details.js, splash.js, saved-locations.js-->
<feature id="blackberry.ui.dialog"/>
<!-- to enable the application to invoke the browser -->
<feature id="blackberry.invoke"/>
<!-- to trap the onswipedown event -->
<feature id="blackberry.app"/>

</widget> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-24T22:37:40.037

“我有类似的问题。检查 blackbery-tablet.xml 和字段是否正确。

要为这些字段获取正确的值，只需将打包的 .bar 文件重命名为 .zip，然后将其解压缩。META-INF 文件夹中会有 manifest.mf 文件。用记事本打开它。从那里获取价值并重建您的应用程序。如果这没有帮助，则重建调试令牌并确保将其安装在设备上。调试令牌需要有正确的设备引脚。

如果此评论对您有所帮助，请单击“竖起大拇指”图标！如果您的问题得到解决，请单击解决方案上的解决方案按钮！” -source [http://supportforums.blackberry.com/t5/Web-and-WebWorks-Development/Failure-881-Application-Author-does-not-匹配调试令牌作者/mp/2055935#M32567](http://supportforums.blackberry.com/t5/Web-and-WebWorks-Development/Failure-881-Application-Author-does-not-match-debug-token-author/m-p/2055935#M32567)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-02T07:50:53.453

我有类似的问题。**这不是“作者”问题**：我试图在调试模式下部署，但设备上没有安装 debugToken。

debugToken 必须在设备上，这样部署才能工作。您可以使用以下方式上传 debugToken：

```
blackberry-deploy -installDebugToken debugtoken.bar -device 169.254.0.1 -password 
```

希望这可以帮助 ：）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-03T10:10:39.453

作者标签的值必须与您在创建 BlackBerry 签名密钥期间提供的公司名称相匹配。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-12T10:23:08.317

用文本编辑器打开文件`blackberry-tablet.xml`，文件在你的`<BlackBerry WebWorks SDK Tablet install folder>\bbwp\AirAppTemplates\src\`.

您应该会看到类似以下内容的部分：

```
<publisher>Sample Inc.</publisher>
<category>core.internet</category> 
```

在本节之后，您必须添加

```
<author>*replace with your author name info*</author>
<authorId>*replace with your author id info*</authorId> 
```

您必须从您上传到 PlayBook 的调试令牌中获取您的作者和作者 ID 信息。您应该在您的计算机上拥有调试令牌，将 .bar 重命名为 .zip 并解压缩。使用文本编辑器在 MANIFEST.MF 文件的 META-INF 文件夹中查找实际字符串值的值，`Package-Author:`然后`Package-Author-Id:`是实际字符串值。

希望这可以帮助。

# javascript - 加载 Ajax 内容后使用 jQuery

> ID：14025420
> 
> 赞同：0
> 
> 时间：2012-12-24T20:22:22.337
> 
> 标签：javascript, jquery, ajax, drupal, drupal-behaviors

在将 ajax 内容添加到页面后，我无法实现对正在加载的 DOM 元素的影响。我的 console.log 打印出下面代码中显示的项目数，打印出 0，但是当我`console.log($('.user-alert').length);`在 firebug 上运行它时，它打印出 2，这是正确的，因为我在页面上填充了 2 个元素。

这是我的代码：

```
 ( function($) {

  Drupal.behaviors.alerts = { 
    attach: function (context) {

      var InfiniteRotator =
      {
          init: function()
          {
              //initial fade-in time (in milliseconds)
              var initialFadeIn = 1000;

              //interval between items (in milliseconds)
              var itemInterval = 5000;

              //cross-fade time (in milliseconds)
              var fadeTime = 2500;

              //count number of items
              var numberOfItems = $('.user-alert').length;
              console.log(numberOfItems);

              //set current item
              var currentItem = 0;

              //show first item
              $('.user-alert').eq(currentItem).fadeIn(initialFadeIn);

              //loop through the items
              var infiniteLoop = setInterval(function(){
                  $('.user-alert').eq(currentItem).fadeOut(fadeTime);
                  if(currentItem == numberOfItems -1){
                      currentItem = 0;
                  }else{
                      currentItem++;
                  }
                  $('.user-alert').eq(currentItem).fadeIn(fadeTime);

              }, itemInterval);
          }
      };
      InfiniteRotator.init();
    }
  };

}( jQuery )); 
```

这是我试图定位的 html：

```
<div class="block block-user-alert contextual-links-region block-user-alert block-user-alert-user-alert odd" id="block-user-alert-user-alert">
<div id="user-alert-45" class="user-alert">
   <div class="user-alert-close"><a href="javascript:;" rel="45">x</a></div>
   <div class="user-alert-message"><span class="user-label">User Alert:</span> Test Alert 2</div>
</div>

<div id="user-alert-43" class="user-alert" style="display: none;">
   <div class="user-alert-close"><a href="javascript:;" rel="43">x</a></div>
   <div class="user-alert-message"><span class="user-label">User Alert:</span> Test Alert 3</div>
</div>
</div> 
```

这是 ajax，还请记住，此代码来自贡献的 Drupal 模块，不应修改：

```
(function ($) {

  Drupal.behaviors.user_alert_get_message = {
    attach: function(context) {
      $.ajax({
        type: 'GET',
        url: Drupal.settings.basePath + Drupal.settings.user_alert.url_prefix + 'js/user-alert/get-message',
        success: function(response) {
          var id = $('.block-user-alert').attr('id');
          $('#' + id).html(response[1].data);
        }
      });

      $('body').delegate('div.user-alert-close a', 'click', function() {
        id = $(this).attr('rel');
        $.ajax({
          type: 'GET',
          data: 'message=' + id,
          url: Drupal.settings.basePath + Drupal.settings.user_alert.url_prefix + 'js/user-alert/close-message',
          success: function(response) {
            $('#user-alert-' + id).fadeOut('slow');
          }
        });
      });
    }
  };
}(jQuery)); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T20:26:33.920

您需要`InfiniteRotator.init();`在将 ajax 图像添加到页面后调用。

# python - 在 SQLAlchemy 中多次查询同一个表

> ID：14025424
> 
> 赞同：2
> 
> 时间：2012-12-24T20:22:40.293
> 
> 标签：python, sqlalchemy, pyramid

我在 Pyramid 应用程序中使用 SQLAlchemy 并有以下一对表。

```
from sqlalchemy.ext.declarative import declarative_base
Base = declarative_base()

class User(Base):
    __tablename__ = 'users'
    id          = Column(Integer, primary_key=True)
    name        = Column(String, nullable=False, default='', unique=True)
    manager     = Column(Integer, nullable=False, default=-1)

class MyStats(Base):
    __tablename__ = 'my_stats'
    id          = Column(Integer, primary_key=True)
    agent       = Column(Integer, ForeignKey("users.id"), nullable=False, index=True)
    manager     = Column(Integer, ForeignKey("users.id"), nullable=False, index=True)

    kpi_one     = Column(Integer)
    kpi_two     = Column(Integer) 
```

MyStats 存储当时代理的经理（因此我们可以根据他们的经理是谁或我们喜欢的独立于他们的经理来查看他们的绩效如何变化）。

我想运行一个查询，我得到以下信息：

```
Agent  Manager  KPI1   KPI2
Bob    Fred     1      1.1
Alice  Owain    1.2    0.9 
```

等等等等。现在仅使用代理名称或仅使用我可以执行的经理名称来提取它：

```
DBSession.query(User.name, MyStats.kpi_one, MyStats.kpi_two).filter(User.id == MyStats.agent) 
```

我不能做的是同时查询两者。我一天中大部分时间都在努力解决这个问题，但做不到。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-24T22:23:10.430

您需要创建[别名表](http://docs.sqlalchemy.org/en/rel_0_8/orm/tutorial.html#using-aliases)：

```
from sqlalchemy.orm import aliased

agent = aliased(User, name='agent')
manager = aliased(User, name='manager')
DBSession.query(
        agent.name, manager.name, MyStats.kpi_one, MyStats.kpi_two
    ).filter(
        agent.id == MyStats.agent,
        manager.id == MyStats.manager
    ) 
```

# c# - 该进程无法访问该文件，因为它正被另一个进程使用 #2

> ID：14025428
> 
> 赞同：-1
> 
> 时间：2012-12-24T20:23:05.000
> 
> 标签：c#

我正在制作一个小备份工具...而且我有一个小问题，不知道如何解决这个问题。所以我在这里问... 代码：

```
strDirectoryData = dlg1.SelectedPath;
strCheckBoxData = "true";
clsCrypto aes = new clsCrypto();
aes.IV = "MyIV";     // your IV
aes.KEY = "MyKey";    // your KEY      
strDirectoryEncryptedData = aes.Encrypt(strDirectoryData, CipherMode.CBC);
strCheckBoxEncryptedData = aes.Encrypt(strCheckBoxData, CipherMode.CBC);

StreamWriter dirBackup = new StreamWriter(dirBackupPath, false, Encoding.UTF8);
StreamWriter checkBackup = new StreamWriter(autoBackupPath, false, Encoding.UTF8);
dirBackup.WriteLine(strDirectoryEncryptedData, Encoding.UTF8);
dirBackup.Close();
checkBackup.WriteLine(strCheckBoxData, Encoding.UTF8);
checkBackup.Close();' 
```

每次都出错 - 该进程无法访问该文件，因为它正被另一个进程使用...

我也有这个在 Form1_Load

```
if (!Directory.Exists(folderPath))
{
    Directory.CreateDirectory(folderPath);
    string strCheckBoxData;
    string strDirectoryData;
    string strCheckBoxEncryptedData;
    string strDirectoryEncryptedData;
    strDirectoryData = "Nothing here";
    strCheckBoxData = "false";
    clsCrypto aes = new clsCrypto();
    aes.IV = "MyIV";     // your IV
    aes.KEY = "MyKey";    // your KEY      
    strDirectoryEncryptedData = aes.Encrypt(strDirectoryData, CipherMode.CBC);
    strCheckBoxEncryptedData = aes.Encrypt(strCheckBoxData, CipherMode.CBC);

    StreamWriter dirBackup = new StreamWriter(dirBackupPath, false, Encoding.UTF8);
    StreamWriter checkBackup = new StreamWriter(autoBackupPath, false, Encoding.UTF8);
    dirBackup.WriteLine(strDirectoryEncryptedData);
    dirBackup.Close();
    checkBackup.WriteLine(strCheckBoxEncryptedData);
    checkBackup.Close();
}
else
{
    string strCheckBoxDecryptedData;
    string strDirectoryDecryptedData;

    StreamReader dirEncrypted = new StreamReader(dirBackupPath);
    StreamReader checkEncrypted = new StreamReader(autoBackupPath); 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-24T20:24:56.310

您没有正确关闭资源。您无法打开文件进行写入，因为您已经打开它进行读取但您没有再次关闭它。

使用完对象后，您需要处理`StreamReader`它们。该类`StreamReader`实现`IDisposable`. 我建议你使用一个`using`块，这样即使出现异常，文件也将始终关闭。

```
using (StreamReader dirEncrypted = new StreamReader(dirBackupPath)) {
     // read from dirEncrypted here
} 
```

**有关的**

*   [C#“使用”块](https://stackoverflow.com/questions/4761198/c-sharp-using-blocks)

# php - Angularjs - Mysql - CRUD 操作和安全性

> ID：14025435
> 
> 赞同：2
> 
> 时间：2012-12-24T20:24:07.887
> 
> 标签：php, mysql, facebook-javascript-sdk, angularjs

我正在使用 angularjs、mysql、facebook java SDK 和 php 开发一个网站应用程序。该应用程序需要定期执行一些 crud 操作，但我认为使用 javascript 框架来执行这些操作会给您带来一个重大的安全漏洞。

所有代码/查询/存储过程都是用客户端编写的。所以，我在徘徊使用 anjularjs 进行安全 crud 操作的选项是什么？

我在某处读到设置 RESTful 服务器并使用身份验证机制可以解决问题，但由于完全不了解安全性，我不太确定。

谁能给我指个方向？

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-26T01:18:22.717

好吧，您不会直接在客户端公开您的安全凭证或编写 SQL 查询。一般来说，使用 AngularJS，您将对后端（我认为是 PHP 服务器）执行 GET/POST json。PHP 将处理后端的所有 CRUD 操作。

您将从后端提取的 json 数据示例：

```
$scope.getAuctions = function() {
    $http.get("/auctions/auctions.json").success(function(data) {
        $scope.auctions = data;
    });

} 
```

# javascript - 引导弹出窗口未显示在所有元素之上

> ID：14025438
> 
> 赞同：130
> 
> 时间：2012-12-24T20:24:34.237
> 
> 标签：javascript, html, twitter-bootstrap, popover

我在一个引导站点上工作，在从 2.0 更新到引导 2.2 之后，除了弹出框之外，一切都正常工作。

弹出框仍然显示得很好，但它们并没有出现在所有其他元素之上。

```
<div> // this sits on top of the popover. this did not happen before cleaning up scripts.
     <div>  //popover shows on top of this
          <div> //popover shows on top of this
               //link here with popover in it.
          </div>
     </div>
</div> 
```

任何人都知道为什么弹出框的行为会发生变化，或者我该如何解决？谢谢。

* * *

## 回答 #1

> 赞同：373
> 
> 时间：2013-04-12T22:37:26.900

我能够通过设置`data-container="body"`html 元素来解决问题

*`HTML`例子：*

```
<a href="#" data-toggle="tooltip" data-container="body" title="first tooltip">
    hover over me
</a> 
```

*`JavaScript`例子：*

```
$('your element').tooltip({ container: 'body' }) 
```

从此链接发现：[https ://github.com/twitter/bootstrap/issues/5889](https://github.com/twitter/bootstrap/issues/5889)

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2015-03-11T08:19:08.013

这对我有用

```
$().popover({container: 'body'}) 
```

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2013-04-12T17:01:02.247

我刚刚遇到了与此类似的情况，涉及启用了滚动的 DataTables JQuery 库。

结果证明与 Z 索引无关，而是与将 CSS 溢出属性设置为隐藏的封闭 div 之一有关。

我通过向我的元素添加一个触发弹出框的事件来修复它，这也将负责的 div 的溢出属性更改为可见。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2012-12-25T03:17:33.373

最可能的原因是弹出框上显示的内容具有较高的`z-index`. 如果没有精确的代码/样式，我可以提供两种选择：

您应该尝试使用网络检查器（通常在您最喜欢的浏览器上按 F12）查明确切的元素并检查它们的实际`z-index`.

如果你找到这个值，你可以将它设置为低于**默认的弹出**[`z-index: 1010;`框](https://github.com/twitter/bootstrap/blob/v2.2.2/less/variables.less#L145)

* * *

或者另一种不太好的方法是增加`z-index`弹出框的 。您可以使用`@zindexPopover`Less 文件中的 或直接通过覆盖来执行此操作

```
.popover {
    z-index: 1010; /* A value higher than 1010 that solves the problem */
} 
```

* * *

如果您找不到解决方案，您应该尝试在类似[这个 jsfiddle](http://jsfiddle.net/Sherbrow/vdWDQ/)中重现错误- 您可能会在尝试获取错误时解决问题。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2014-08-25T08:53:48.037

我在 2 个固定元素上遇到了类似的问题 - 即使 z-index heirachy 是正确的，引导工具提示也隐藏在 z-index 较低的一个元素后面。

添加`data-container="body"`解决了这个问题，现在可以按预期工作。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2015-12-19T03:35:14.387

如果 data-container="body" 不起作用，请尝试其他两个属性：

```
data-container="body" style="z-index:1000; position:relative" 
```

z-index 应该是最大限制。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2017-08-04T16:07:09.307

```
<div class="testDiv">
<a tabindex = "-1" id="testPop" title="stuff" data-toggle="popover" data-trigger="focus" data-placement="bottom" data-container=".testDiv">
 <i class="fa fa-info-circle"></i>
</a>

</div> 
```

上面的答案很有帮助，因为在 data-container 中设置值可以完成这项工作，但是如果我设置 data-container="body" 那么在我的情况下它不能正确对齐。所以我指定了popover的父div的类，它工作得很好。

html

数据容器=".testDiv"

js

$("#testPop").popover({container: '.testDiv'})

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-03-27T19:15:41.743

如果您使用 angular uib-bootsrap，最好的解决方案是对 $uibTooltipProvider 使用依赖注入，您可以更改所有工具提示的工具提示和弹出框的默认行为方式。

```
$uibTooltipProvider.options({
  appendToBody: true
}); 
```

**$uibTooltipProvider** 通过 $uibTooltipProvider，您可以更改工具提示和弹出框默认的行为方式；上述属性始终优先。可以使用以下方法：

**setTriggers** (obj)（示例：{ 'openTrigger': 'closeTrigger' }） - 使用您自己的映射扩展上述默认触发器映射。

**options** (obj) - 为某些工具提示和弹出框属性提供一组默认值。目前支持带有 C 标志的那些。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2019-05-23T17:38:59.183

许多年后，但像我一样，其他人可能会搜索这个。考虑到所有更新，所有这些都可以通过 JavaScript 中的正确初始化选项来解决。

```
$('.tip').tooltip({
    boundary: 'viewport',
    placement: 'top',
    container:'body',
    sanitize: true,
    appendToBody: true
}); 
```

这些设置解决了所有可能的问题。我的工具提示闪烁，仅显示页面上一半的项目，从上到左不断跳跃，各种奇怪。但是有了这些设置，一切都解决了。希望它对任何寻找的人有所帮助。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-07-15T10:05:22.697

```
 $('[data-toggle="popover"]').popover({
        placement: 'top',
        boundary: 'viewport',
        trigger: 'hover',
        html: true,
        content: function () {
            let content = $(this).attr("data-popover-content");
            return $(content).html();
        }
    });,

`placement`: 'top',
`boundary`: 'viewport'
both needed 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2021-04-01T16:57:27.197

giving my 2 cents, My issue was NOT the container nor the z-index like other solution above, but the opacity set in a transition.

```
.popover{opacity:1} 
```

solved my issue.

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-12-22T08:31:24.620

只是使用

```
$().popover({container: 'body'}) 
```

在 BootstrapDialog 模式上显示弹出框时可能还不够，该模式也使用 body 作为容器并具有更高的 z-index。

我附带了这个使用 Bootstrap3 内部的修复程序（可能不适用于 2.x / 4.x），但大多数现代 Bootstrap 安装都是 3.x。

```
self.$anchor.on('shown.bs.popover', function(ev) {
    var tipCSS = self.$anchor.data('tipCSS');
    if (tipCSS !== undefined) {
        self.$anchor.data('bs.popover').$tip.css(tipCSS);
    }
    // ...
}); 
```

这样不同的popovers可能有不同的z-index，一些在BootstrapDialog模式下，而另一些在它上面。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-01-10T13:15:04.517

在我的情况下，我必须使用 popover 模板选项并将我自己的 css 类添加到模板 html 中：

```
 $("[data-toggle='popover']").popover(
          {
            container: 'body',
            template: '<div class="popover top-modal" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'
       }); 
```

CSS：

```
.top-modal {
  z-index: 99999;
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-09-03T13:45:16.310

`data-container="body"`用and解决了问题`z-index`：

```
<div class="button btn-align"
     data-container="body"  
     data-toggle="popover"
     data-placement="top"
     title="Top"
     data-trigger="hover"
     data-title-backcolor="#fff"
     data-content="A top aligned popover is a really boring thing in the real life."
>Top</div> 
```

```
.ggpopover.in {
    z-index: 9999 !important;
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-11-22T10:12:18.063

当父元素上的某些样式会干扰弹出框时，您需要指定一个自定义容器，以便弹出框的 HTML 出现在该元素中。

例如说弹出框的父级是 body 然后你可以使用。

```
 <a href="#" data-toggle="tooltip" data-container="body"> Popover One </a> 
```

Other case might be when popover is placed inside some other element and you want to show popover over that element, then you'll need to specify that element in data-container. ex: Suppose, we have popover inside a bootstrap modal with id as 'modal-two', then you'll need to set 'data-container' to 'modal-two'.

```
 <a href="#" data-toggle="tooltip" data-container="#modal-two"> Popover Two </a> 
```

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2012-12-24T20:31:30.840

它可能与 variables.less 上的 z-index 主列表有关。通常，请确保您的 variables.less 文件是正确且最新的。

# firefox - f5 和 t keydown/keypress 键码

> ID：14025439
> 
> 赞同：1
> 
> 时间：2012-12-24T20:24:34.653
> 
> 标签：firefox

当我得到按键的按键代码时，我将按键代码输出到控制台。我记录了两个键码：keydown 和 keypress。

当我按**F5**时，我得到以下键码：

```
keydown = 84 ("T")
keypress = 116 ("t") 
```

当我按**t**时，我得到以下键码：

```
keydown = 116 ("t")
keypress = 116 ("t") 
```

这只发生在 Firefox 中。当按下的原始键不一样时，为什么 keypress 键码相同，并且 keydown 码相似？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T03:36:38.343

你确定你没有混淆`keyCode`吗`charCode`？

使用[QuirksMode](http://www.quirksmode.org/js/keys.html)底部的结果，我得到

*   **F5**
    *   keydown：keyCode 为 116；字符代码为 0
    *   keypress：keyCode 为 116；字符代码为 0
*   **吨**
    *   keydown：keyCode 为 84；字符代码为 0
    *   按键：keyCode 为 0；字符代码为 116
*   **吨**
    *   keydown：keyCode 为 84；字符代码为 0
    *   按键：keyCode 为 0；字符代码为 84

`keyCode`表示用户实际按下的键盘键，而`charCode`表示字符的代码点。例如，键**t**和**T**相同`keyCode`，因为它们来自相同的键，而它们不同`charCode`，因为它们代表不同的字符。

所以要回答你的问题，你得到的**F5** keydown 的输出是 84，插入时`String.fromCharCode()`给出“T”，而 keypress 是 116，对应于使用`String.fromCharCode()`.

简而言之，不要使用`String.fromCharCode()`on `keyCode`，因为结果是荒谬的。只在`charCode`. 同样来自[QuirksMode](http://www.quirksmode.org/js/keys.html)，在“特殊键”下

> 如果您需要检测这些键，请帮自己一个忙并在 onkeydown/up 上搜索它们的 keyCode，并忽略 onkeypress 和 charCode。

# wordpress - 如何在日期自动移动 wordpress 中不同类别的帖子？

> ID：14025443
> 
> 赞同：0
> 
> 时间：2012-12-24T20:24:58.457
> 
> 标签：wordpress

有没有办法在未来自动移动不同类别的帖子？示例：Category1 中的 Post1，我想在 31.12.2012 00:00 时间自动移至 Category2。也是 Category3 中的 Post2，我想在 2012 年 12 月 31 日 00:00 时间将其自动移动到 Category4。

我怎样才能在wordpress上制作它？有任何想法吗？（顺便说一句，我尝试使用内容调度器插件，但它只是将帖子移动到一个类别。我需要自动将帖子移动到每个帖子的特定类别。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-25T05:02:32.373

尝试使用 cron 作业功能。 [http://wordpress.org/extend/plugins/wpematico/](http://wordpress.org/extend/plugins/wpematico/)

您需要做一些研究以找到需要工作的表。

# java - 严重：null java.sql.SQLException

> ID：14025445
> 
> 赞同：0
> 
> 时间：2012-12-24T20:25:08.457
> 
> 标签：java, sqlite, jtable, sqlexception

> **可能重复：**
> [连接到 SQLite 数据库失败](https://stackoverflow.com/questions/4917855/connecting-to-sqlite-database-fails)

我是 Java 初学者

当我想从 SQLite 获取输出到`JTable`GUI 界面时，我得到了这个异常：

> 严重：null java.sql.SQLException：找不到适用于 jdbc:sqlite:C:\Users\Amr\Documents\NetBeansProjects\Project\BillsDataBase.sqlite 的驱动程序在 java.sql.DriverManager.getConnection(DriverManager.java:604) 在java.sql.DriverManager.getConnection(DriverManager.java:243) 在 NewClass.(NewClass.java:22) 在 NewClass$5.run(NewClass.java:342) 在 java.awt.event.InvocationEvent.dispatch(InvocationEvent.java :251) 在 java.awt.EventQueue.dispatchEventImpl(EventQueue.java:721) 在 java.awt.EventQueue.access$200(EventQueue.java:103) 在 java.awt.EventQueue$3.run(EventQueue.java:682)在 java.awt.EventQueue$3.run(EventQueue.java:680) 在 java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:76) 在 java.security.AccessController.doPrivileged(Native Method) 在 java.awt。EventQueue.dispatchEvent(EventQueue.java:691) 在 java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThread.java:242) 在 java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.java:161) 在 java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThread .java:150) 在 java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:146) 在 java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:138) 在 java.awt.EventDispatchThread.run(EventDispatchThread.java:91)150) 在 java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:146) 在 java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:138) 在 java.awt.EventDispatchThread.run(EventDispatchThread.java:91)150) 在 java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:146) 在 java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:138) 在 java.awt.EventDispatchThread.run(EventDispatchThread.java:91)

代码：

```
public class NewClass extends javax.swing.JFrame {
    Connection conn = null;
    ResultSet rs = null;
    PreparedStatement pst = null;

    public NewClass() {     
        initComponents(); 
        try {
            conn = DriverManager.getConnection("jdbc:sqlite:C:\\Users\\Amr\\Documents\\NetBeansProjects\\Project\\BillsDataBase.sqlite");
        } catch (SQLException ex) {
            Logger.getLogger(NewClass.class.getName()).log(Level.SEVERE, null, ex);
        }

    }

    private void Update_table(){
        try {
            String sql ="SELECT Amount, Type,Invoice FROM BillsDataBase";
            pst=conn.prepareStatement(sql);
            rs=pst.executeQuery();
            Table_Bills.setModel(DbUtils.resultSetToTableModel(rs));
        }
        catch(SQLException e){
            JOptionPane.showMessageDialog(null, e);
        }
    } 
```

在休息时，有一张桌子叫做`Table_Bills`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T21:28:26.353

您是否成功完成：

```
Class.forName("org.sqlite.JDBC"); 
```

# linux - Bash 脚本对两个但相反的字符串测试都返回 true

> ID：14025447
> 
> 赞同：5
> 
> 时间：2012-12-24T20:25:22.217
> 
> 标签：linux, bash, ubuntu, centos, boolean-logic

在我运行我输入的脚本之前

```
# export CPIC_MAX_CONV=500 
```

下面是test1.script文件

```
#!/bin/bash

function cpic () {
  var="`export | grep -i "CPIC_MAX_CONV" | awk '/CPIC_MAX_CONV/ { print $NF } '`"
  [[ $var=="" ]] && (echo "Empty String <<")
  [[ $var!="" ]] && (echo "$CPIC_MAX_CONV")
  echo "$var" ;
}

cpic 
```

输出是：

```
# test1.script  ---- Me running the file

Empty String <<
500
CPIC_MAX_CONV="500" 
```

无论我使用什么 "" 或 '' 或 [ 或 [[ 结果都是一样的。该`CPIC_MAX_CONV`变量由上述脚本找到。

我在 Linux/CentOS 6.3 上运行它。

这个想法很简单：查找是否`CPIC_MAX_CONV`在环境中定义并返回它的值。如果有一个空白空间，那么该变量当然不存在于系统中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-24T20:58:51.830

为什么你总是说实话？让我们先在你的终端上玩一点：

```
$ [[ hello ]] && echo "True" 
```

你认为输出是什么？（试试看！）还有以下内容？

```
$ [[ "" ]] && echo "True" 
```

（试试看！）。

好吧，看来非空字符串等价于真表达式，而空字符串（或未设置的变量）等价于假表达式。

您所做的是以下内容：

```
[[ $var=="" ]] 
```

和

```
[[ $var!="" ]] 
```

所以你给了一个非空字符串，这是真的！

为了执行测试，您实际上需要标记之间的空格：

```
[[ $var == "" ]] 
```

反而。现在，您的测试最好写成：

```
if [[ -z "$var" ]]; then
    echo "Empty String <<"
else
    echo "$CPIC_MAX_CONV"
fi 
```

（没有子外壳，只有一个测试）。

关于你的脚本风格还有很多话要说。没有冒犯，我会说这真的很糟糕：

*   不要使用反引号！请改用`$(...)`构造。因此：

    ```
    var="$(export | grep -i "CPIC_MAX_CONV" | awk '/CPIC_MAX_CONV/ { print $NF } ')" 
    ```

*   不要`function blah`用来定义函数。你的函数应该被定义为：

    ```
    cpic () {
        local var="$(export | grep -i "CPIC_MAX_CONV" | awk '/CPIC_MAX_CONV/ { print $NF } ')"
        if [[ -z "$var" ]]; then
            echo "Empty String <<"
        else
            echo "$CPIC_MAX_CONV"
        fi
    } 
    ```

哦，我使用了`local`关键字，因为我猜你不会`var`在函数之外使用变量`cpic`。

现在，函数的目的是什么`cpic`，特别是你定义变量的东西`var`？这很难描述（因为有很多你没有想到的案例）。（顺便说一句，你`grep`在这里似乎真的没用）。以下是您忽略的几个案例：

*   导出的变量被命名`somethingfunnyCPIC_MAX_CONVsomethingevenfunnier`
*   导出的变量在`CPIC_MAX_CONV`某处包含字符串，例如，

    ```
    export a_cool_variable="I want to screw up Randhawa's script and just for that, let's write CPIC_MAX_CONV somewhere here" 
    ```

好的，我不想描述你的行到底在做什么，但我猜你的目的是知道变量是否`CPIC_MAX_CONV`已设置并标记为导出，对吗？在这种情况下，您最好这样做：

```
cpic () {
    if declare -x | grep -q '^declare -x CPIC_MAX_CONV='; then
        echo "Empty String <<"
    else
        echo "$CPIC_MAX_CONV"
    fi
} 
```

它将更有效，更健壮。

哦，我现在正在阅读您的帖子的结尾。如果您只想判断变量`CPIC_MAX_CONV`是否已设置（设置为某个非空值 - 似乎您不在乎它是否标记为导出，如果我错了请纠正我），它甚至更简单（它会是效率更高）：

```
cpic () {
    if [[ "$CPIC_MAX_CONV" ]]; then
        echo "Empty String <<"
    else
        echo "$CPIC_MAX_CONV"
    fi
} 
```

也会这样做！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T21:48:17.680

Do you really care whether CPIC_MAX_CONV is an environment variable versus just 'it is a variable that might be an environment variable'? Most likely, you won't, not least because if it is a variable but not an environment variable, any script you run won't see the value (but if you insist on using aliases and functions, then it might matter, but still probably won't).

It appears, then, that you are trying to test whether CPIC_MAX_CONV is set to a non-empty value. There are multiple easy ways to do that — and then there's the way you've tried.

```
: ${CPIC_MAX_CONV:=500} 
```

This ensures that CPIC_MAX_CONV is set to a non-empty value; it uses 500 if there previously wasn't a value set. The `:` (colon) command evaluates its arguments and reports success. You can arrange to export the variable after it is created if you want to with `export CPIC_MAX_CONV`.

If you must have the variable set (there is no suitable default), then you use:

```
: ${CPIC_MAX_CONV:?} 
```

or

```
: ${CPIC_MAX_CONV:?'The CPIC_MAX_CONV variable is not set but must be set'} 
```

The difference is that you can use the default message ('CPIC_MAX_CONV: parameter null or not set') or specify your own.

If you're only going to use the value once, you can do an 'on the fly' substitution in a command with:

```
cpic_command -c ${CPIC_MAX_CONV:-500} ... 
```

This does not create the variable if it does not exist, unlike the `:=` notation which does.

In all these notations, I've been using a colon as part of the operation. That enforces 'null or not set'; you can omit the colon, but that allows an empty string as a valid value, which is probably not what you want. Note that a string consisting of just a blank is 'not empty'; if you need to validate that you've got a non-empty string, you have to work a little harder.

* * *

I'm not dissecting your misuse of the `[[` command; [gniourf_gniourf](https://stackoverflow.com/users/1815797/gniourf-gniourf) has provided an excellent [deconstruction](https://stackoverflow.com/a/14025644/15168) of that, but overlooked the simpler notations available to do what seems to be the job.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-25T19:03:26.927

尝试这个：

```
#!/bin/bash
function cpic () {    
  var="`export | grep -i "CPIC_MAX_CONV"`"
  [ "$var" = "" ] && (echo "Empty String <<")
  [ "$var" != "" ] && echo "$CPIC_MAX_CONV"
}  
cpic 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-12-24T22:02:02.250

你需要在你的条件空间。

```
#!/bin/bash

function cpic () {
    var="`export | grep -i "CPIC_MAX_CONV" | awk '/CPIC_MAX_CONV/ { print $NF } '`"
    [[ $var == "" ]] && (echo "Empty String <<")
    [[ $var != "" ]] && (echo "$CPIC_MAX_CONV")
    echo "$var" ;
}

cpic 
```

# ios - 知道 textField 背景颜色是否为默认颜色

> ID：14025448
> 
> 赞同：0
> 
> 时间：2012-12-24T20:25:31.467
> 
> 标签：ios, uitextfield, uicolor

我想比较 a 的背景颜色`UITextField`是否为默认颜色。

就像是：

```
if ([blankField.backgroundColor isEqual:nil] 
       && [colorField.backgroundColor isEqual:nil])
{
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T22:40:39.423

您可以尝试对每个文本字段的一部分进行采样，并判断它们是否彼此相同。查看此链接：[如何在 iPhone 上将一张图像与另一张图像进行比较以查看它们是否在一定百分比上相似？](https://stackoverflow.com/questions/6488732/how-does-one-compare-one-image-to-another-to-see-if-they-are-similar-by-a-certai)此链接讨论如何比较两个图像以查看它们是否相似。希望这可以帮助。

# asp.net-mvc - 在 Windows 8 中的 IIS 8 上使用 .NET 4.5 的 MVC 4 网站给出 403.14 禁止错误

> ID：14025455
> 
> 赞同：39
> 
> 时间：2012-12-24T20:26:37.803
> 
> 标签：asp.net-mvc, iis, windows-8, asp.net-mvc-4, iis-8

我有一个使用 MVC 4 和 .NET 框架 4.5 在 Visual Studio 2012 中构建的网站。当我尝试在运行 Windows 8 Pro 的机器上通过 IIS 8 运行它时，我收到 403.14 错误。它说

“禁止 Web 服务器配置为不列出此目录的内容。

最可能的原因：没有为请求的 URL 配置默认文档，并且服务器上没有启用目录浏览。”

以下是我尝试过的一些无效的方法：

*   在此目录和 Framework64 目录中运行 %windir%\Microsoft.NET\Framework\v4.0.30319\aspnet_regiis.exe **-i**和 %windir%\Microsoft.NET\Framework\v4.0.30319\aspnet_regiis.exe **-ir 。**这会导致此错误：“此版本的操作系统不支持此选项。管理员应使用“打开/关闭 Windows 功能”对话框、服务器管理器管理工具或dism.exe 命令行工具。有关详细信息，请参阅[http://go.microsoft.com/fwlink/?LinkID=216771](http://go.microsoft.com/fwlink/?LinkID=216771)。该链接转到有关 Windows Server 2012 的页面，但该页面无济于事。我在 iis 8 的“打开或关闭 Windows 功能”对话框中找不到特定设置。与 .net 4 相关的所有内容。
*   添加到 Web.config 中。这会产生错误：“此配置部分不能在此路径中使用。当该部分在父级别锁定时会发生这种情况。锁定是默认情况下 (overrideModeDefault="Deny")，或者由具有 overrideMode 的位置标记显式设置="Deny" 或旧的 allowOverride="false"。"

我已经确保在服务器上安装了 .net 4.5（安装程序说它内置在 Windows 8 中，不需要安装）。应用程序池是使用 .net 4.0 集成管道的默认池，启用了 32 位应用程序。我正在发布到默认目录 (inetpub\wwwroot)，并且那里的默认站点运行良好。HTTP 重定向在“打开或关闭 Windows 功能”中打开

谁能提供更多见解？

编辑：嗯，当然，在我发布这个之后，我发现了一些有用的东西。去搞清楚。

在“打开或关闭 Windows 功能”中，在 Internet 信息服务 -> 万维网服务 -> 应用程序开发功能下，确保 .NET Extensibility 3.5、.NET Extesibility 4.5、ASP.NET 3.5、ASP.NET 4.5、ISAPI扩展和 ISAPI 过滤器被选中。

这在这里概述：[http](http://www.iis.net/learn/get-started/whats-new-in-iis-8/iis-80-using-aspnet-35-and-aspnet-45#TOC301258515) ://www.iis.net/learn/get-started/whats-new-in-iis-8/iis-80-using-aspnet-35-and-aspnet-45#TOC301258515但因为指的是 server 2012 而不是 windows 8 我找不到这些设置的正确位置。

希望这可以帮助任何有类似问题的人。谢谢阅读。

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2013-03-13T16:10:56.470

在“打开或关闭 Windows 功能”中，在 Internet 信息服务 -> 万维网服务 -> 应用程序开发功能下，确保 .NET Extensibility 3.5、.NET Extesibility 4.5、ASP.NET 3.5、ASP.NET 4.5、ISAPI扩展和 ISAPI 过滤器被选中。

这在这里概述：[http](http://www.iis.net/learn/get-started/whats-new-in-iis-8/iis-80-using-aspnet-35-and-aspnet-45#TOC301258515) ://www.iis.net/learn/get-started/whats-new-in-iis-8/iis-80-using-aspnet-35-and-aspnet-45#TOC301258515但因为指的是 server 2012 而不是 windows 8 我找不到这些设置的正确位置。

*注意：添加答案以清除未回答的问题*

# forms - 带有登录表单的 Twitter bootstrap 淹没按钮（表单未保持打开状态）

> ID：14025457
> 
> 赞同：1
> 
> 时间：2012-12-24T20:26:44.293
> 
> 标签：forms, drop-down-menu, login, twitter-bootstrap

我研究了stackoverflow，以使登录表单的下拉按钮在完成表单时保持打开状态。现在，只要您尝试输入，登录表单就会关闭。这是我的代码：

```
<div class="top-nav">
<div class="btn-group pull-right dropdown-toggle"> <a class="btn btn-login"  href="#"><i class="icon-user icon-white"></i> Login</a> <a class="btn btn-login dropdown-toggle" data-toggle="dropdown" href="#"><span class="caret"></span></a>
<form class="form-horizontal dropdown-menu">
  <div class="control-group">
    <label class="control-label" for="inputEmail">Email</label>
    <div class="controls">
      <input type="text" id="inputEmail" placeholder="Email">
    </div>
  </div>
  <div class="control-group">
    <label class="control-label" for="inputPassword">Password</label>
    <div class="controls">
      <input type="password" id="inputPassword" placeholder="Password">
    </div>
  </div>
  <div class="control-group">
    <div class="controls">
      <label class="checkbox">
        <input type="checkbox">
        Remember me </label>
      <button type="submit" class="btn">Sign in</button>
    </div>
  </div>
</form> 
```

在我的代码末尾，就在 body 标记之前，我输入了这个脚本：

```
 <script src="http://code.jquery.com/jquery-latest.js"></script> 
    <script type="text/javascript" src="js/bootstrap.min.js"></script>
    <script language="javascript">
       $('.dropdown-toggle').dropdown();
       $('.dropdown-menu').find('form').click(function (e) {
       e.stopPropagation();
      });
  </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T04:54:39.550

我能够使用您的代码重现该问题。`.find('form')`从 JavaScript 中删除解决了这个问题。

# javascript - 将新点添加到点数组中的正确位置

> ID：14025464
> 
> 赞同：8
> 
> 时间：2012-12-24T20:28:48.353
> 
> 标签：javascript, jquery, algorithm, graphics, canvas

我有一个带有几个点的多边形，必须添加一个新点。现有点存储在一个数组中：

```
var points = [
    {x: 0, y:0},
    {x: 100, y: 0},
    {x: 100, y: 100},
    {x: 0, y: 100}
]; 
```

您如何确定`newPoint`应将其添加到数组的哪个位置？

**尝试：**我遍历所有现有点并计算`newPoint`与它们的距离，并将现有点排序到包含这些点的索引的数组中，以增加距离`newPoint`。

按照我目前尝试的方法，下一步将检查两个最近的点是否相邻。如果是，则将它们`newPoint`之间的值添加到`points`数组中。如果它们不相邻，那么我有点卡在这里:) 你如何检查这两个点是否相邻？

非常感谢任何帮助！

**jsfiddle：http:** [//jsfiddle.net/y3kmm/](http://jsfiddle.net/y3kmm/)

* * *

顺序之所以重要，是因为形状通常以顺时针方式绘制。`points`这是一个 jsfiddle，其中蓝色多边形在正确的位置添加了一个点，而红色多边形在数组末尾添加了一个点。

**jsfiddle：http:** [//jsfiddle.net/TyQXV/](http://jsfiddle.net/TyQXV/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-24T20:58:34.130

正如我之前所说，您实际上不必使用排序来增加程序的复杂性：只需存储两个初始点，认为它们是最接近的，然后在迭代另一个点时替换它们。

**但是**，您的问题有不止一种可能的解决方案；您必须为其定义更多约束。

例如，考虑四个点形成一个正方形：

```
·-------·
|       |
|       |
|       |
·-------· 
```

现在，将一个点添加到多边形内的随机位置：

```
·-------·
|       |
| ·     |
|       |
·-------· 
```

仍然有两个以上可能的顺序可以保持多边形凸：

```
·-------·
 \      |
  ·     |
 /      |
·-------·

·   ____·
|\ /    |
| ·     |
|       |
·-------· 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-25T17:08:20.917

好吧，让我们仔细看看多边形。

![泰德](../Images/009a360cb53899ced29efeb37bac1973.png)

我们叫他泰德。当泰德（或一般的多边形）看到一个点时，他会尝试在自己内部吸收它。为了同化，他决定让他的众多**方面**之一有幸伸出援手并**抓住这一点**。现在，泰德正忙于更重要的事情，所以**双方**需要自己决定哪一方会做好事。我再说一遍；**双方**。

![在此处输入图像描述](../Images/ee0e72b47eb1493f35072059a8c6d120.png)

我们走了，泰德附近有一个点，幸福地没有意识到它很快就会被恶毒地消耗掉。那么，泰德的一方如何决定哪一方将抢夺这一点呢？好吧，它需要是公平的游戏。感觉到从它到该点的**垂直距离**最短的一侧将是执行此操作的一侧。**最短**的。**垂直**。**距离**。

![在此处输入图像描述](../Images/fbc2427f027df51547e47fbc089a6e5a.png)

同化完成！

要记住的另一件事是，像 Ted 这样的多边形重视生存而不是同化。与该点垂直距离最短的一侧只有在它**不穿过其他一侧**时才开始同化。因此，仅考虑**有效**同化的方面。否则，**坏事就会发生**。

![在此处输入图像描述](../Images/bb7d1ee4ef0739bea7d4c5bfca1e8738.png)

我不必要的言辞中有两点很重要；

*   我们添加点的**一侧应该与该点有****最短的垂直距离**。
*   除了与点的垂直距离最短外，将点添加到这一侧应该是**有效**的。这很重要，毕竟，我们不想进行大规模多边形谋杀。

所以，这里有一些伪代码；

```
For each side S in polygon P
Do
    d := perpendicularDistanceFromSide(S, point);
    If d is less than shortestPerpendicularDistance
    Do
        If additionIsValid(S, point, P)
        Do
            shortestPerpendicularDistance := d;
            index = S.index;
        End If
    End If
End For 
```

从侧面找到垂直距离很容易；

```
var perpendicularDistance = function(side, point) {
    //Find direction vector of side
    var dir = {x: side.p2.x - side.p1.x, y: side.p2.y - side.p1.y};
    var m = Math.sqrt(dir.x*dir.x + dir.y*dir.y);
    if(m !== 0) {
        d.x = d.x/m;
        d.y = d.y/m;
    }

    //Find position vector of point, from side
    var pVec = {x: point.x - side.p1.x, y: point.y - side.p1.y};

    //Absolut of cross product of dir and pVec. 
    //It's essentially |pVec|*Sin(q), q is the angle between
    //dir and pVec.
    return Math.abs(dir.x*pVec.y - dir.y*pVec.x);
}; 
```

现在，让我们看看有效性。如果在将点添加到多边形之后，新的边穿过任何其他边，那么小家伙就结束了。我们需要确保我们的算法考虑到这一点。

我为此想了两个版本；一便宜一贵。

**方法一**：

如果多边形中几乎没有凹面，则此方法非常有效。此方法仅检查新边不与旧边相邻的边相交。

说我们有一方`S`。它的两个相邻边是`Sprev`和`Snext`。两个新的边是`S1p`和`S2p`。`S1p`并且`Sprev`有`S.p1`共同点。`S2p`并且`Snext`有`S.p2`共同点。

根据这种方法，当且仅当以下之间不存在交集时，加法才有效：

*   `Sprev`和`S2p`
*   `Snext`和`S1p`

因此，此方法适用于拒绝。如果我们找不到任何交点，边`S`可以有效地添加点。

**[方法 1 演示](http://jsfiddle.net/un6Qj/7/)**

**方法二**：

随着多边形的凹度增加，方法 1 失败。因此，我们需要做进一步的检查以确保有效的加点。

This method is really an extension of Method 1\. After finding that the pairs `Sprev` and `S2p`, and `Snext` and `S1p` are not intersecting, we check if the new sides are intersecting with all the other sides of the polygon (apart from `Sprev` and `Snext`, of course).

If the addition is not rejected after all the sides are checked, we are completely sure that this addition is valid.

The problem is, that while rejection is quick enough, reaching acceptance takes a long time, making this method quite expensive.

Furthermore, the complexity depends on the number of sides of the polygon. As the polygon complexity increases, checking validity will take more and more time.

**[Method 2 Demo](http://jsfiddle.net/uaLGe/5/)**

我必须注意，我用于检查线段相交的算法取自[如何检测两条线段相交的位置？](https://stackoverflow.com/questions/563198/how-do-you-detect-where-two-line-segments-intersect). 这太棒了。

这就是我所拥有的。这是一种方法，我必须说。可能还有另一种更好的方法还没有让我印象深刻。我希望你不要太介意泰德。另外，感谢您提出一个好问题，我很喜欢。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-24T21:01:27.443

我相信您的计算不会解决您遇到的问题。例如，取以下两个多边形：

```
var poly3 = new Kinetic.Polygon({
    x: 200,
    y: 100,
    points: [0,25,25,0,150,100,75,125],
    fill: 'green',
    stroke: 'black',
    strokeWidth: 0,
    name: 'poly',
    draggable: false
});
group.add(poly3);

var poly4 = new Kinetic.Polygon({
    x: 300,
    y: 100,
    points: [0,25,25,0,75,125,150,100],
    fill: 'yellow',
    stroke: 'black',
    strokeWidth: 0,
    name: 'poly',
    draggable: false
});
group.add(poly4); 
```

最近的点不一定是接下来应该绘制的点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-25T00:44:24.483

`The reason why the order matters is because Shapes are usually drawn in a clockwise manner.`

你刚刚回答了你的问题。添加新点的位置取决于您想要的形状，因此与距离无关。您只需在要绘制的位置添加点。

比如说，您是否已经知道形状应该是什么，或者您是否必须根据用户单击鼠标的位置来猜测形状？如果您必须猜测，您可能必须设置默认行为。否则，给你的用户一个额外的参数。

# android - 在 Android 应用程序中，资源何时加载到内存中？

> ID：14025468
> 
> 赞同：17
> 
> 时间：2012-12-24T20:29:09.940
> 
> 标签：android, android-resources, performance

我在 res/drawable 文件夹中添加了大约 35 个图像，在 res/raw 文件夹中添加了另外 30 个声音文件。现在我的应用程序需要多花 5 秒才能启动，即使只有 1 个图像和 1 个声音资源用于启动屏幕。这让我问：我的图像资源何时加载到内存中？

它们是在应用程序启动时加载还是在我第一次使用时加载？（例如：当我调用 ImageView.setImageResource(myResId);）

如果它们在应用程序启动时全部加载，我该如何避免这种情况？如果每个都是按需加载的，为什么我的应用程序需要更长的时间才能启动？

有关应用程序的信息以获取洞察力：使用 ViewPager 的单个活动。每个视图页面使用一个图像资源，它是一个分辨率为 700x400 像素 (~50K) 的 jpeg 文件和一个声音文件，它是一个 <5 秒 (~60K) 的 mp3 文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T23:02:16.770

它们是位图吗？我在 android 开发网站上找到了这个：

[http://developer.android.com/training/displaying-bitmaps/process-bitmap.html](http://developer.android.com/training/displaying-bitmaps/process-bitmap.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-01-20T19:54:11.813

这可能会回答您的问题[https://stackoverflow.com/a/40282371/1603602](https://stackoverflow.com/a/40282371/1603602)。

基于此链接中的信息的简短回答是：所有资源都加载到内存中，无论您是否使用它们。

# android - 带有 ViewPager 和框架布局的 ActionBar 选项卡

> ID：14025471
> 
> 赞同：4
> 
> 时间：2012-12-24T20:29:23.300
> 
> 标签：android, android-viewpager

我想使用 ActionBar 选项卡和 ViewPager 来实现选项卡之间的滑动。我已经成功地使用了这里的例子：

[http://developer.android.com/reference/android/support/v4/view/ViewPager.html](http://developer.android.com/reference/android/support/v4/view/ViewPager.html)

但是，我还想在 xml 中的 ViewPager 之外添加一个框架布局：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/LinearLayout1"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    tools:context=".MainActivity" >

    <android.support.v4.view.ViewPager
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/FrameLayout1"
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_weight="1">
    </android.support.v4.view.ViewPager>   

    <FrameLayout
        android:id="@+id/frame_layout"
        android:name="com.banagas.calculator.ButtonFragment"
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_weight="1" />

</LinearLayout> 
```

如果我使用 ViewPager 和 Frame Layout 将 setContentView() 设置为我的布局，则 ViewPager 将停止运行：

```
@Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        Log.i("MainActivity", "onCreate");  
        mViewPager = new ViewPager(this);
        mViewPager.setId(R.id.FrameLayout1);
        ActionBar bar = getSupportActionBar();
        mViewPager.setOffscreenPageLimit(4);

        bar.setDisplayHomeAsUpEnabled(false);
        bar.setDisplayShowTitleEnabled(false);
        bar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);
        mTabsAdapter = new TabsAdapter(this, mViewPager);

        mTabsAdapter.addTab(bar.newTab().setText("Display"), DisplayFragment.class, null);
        mTabsAdapter.addTab(bar.newTab().setText("Y="), YFragment.class, null);
        mTabsAdapter.addTab(bar.newTab().setText("Graph"), GraphFragment.class, null);
        mTabsAdapter.addTab(bar.newTab().setText("Table"), TableFragment.class, null);

        if (findViewById(R.id.frame_layout) != null) 
        {
            if (savedInstanceState != null) 
            {
                return;
            }
            getSupportFragmentManager().beginTransaction().add(R.id.frame_layout, new ButtonFragment()).commit();
            Log.i("MainActivity", "add.ButtonFragment");
        }
    } 
```

我可以在 ViewPager 中看到选项卡，而没有其他任何内容。不过，我的框架布局工作得很好。我如何让 ViewPager 使用它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T01:25:29.877

为什么你要做 mViewPager = new ViewPager(this); mViewPager.setId(R.id.FrameLayout1); ?

ViewPager 已经在您的布局中。

应该做类似 mViewPager = (ViewPager)findViewById(R.id.FrameLayout1);

从示例代码中，他们在运行时创建控件，而您将它们放在 xml 中。

# spring - Hibernate，未绑定到表的类属性

> ID：14025473
> 
> 赞同：1
> 
> 时间：2012-12-24T20:29:37.983
> 
> 标签：spring, hibernate, spring-mvc, orm

我有这样的问题：我在 Test 类中有一个属性，它不应该映射到表的列（我在加载我的 Test 对象后使用它来确定是否应该删除 Test 对象）。在我的情况下，这个属性是布尔删除：

```
@Entity
@Table(name = "[NewMVC].[dbo].[Tests]")
public class Test {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @Column(name = "id")
    private int id; 

    @Column(name = "testQuestion")
    private String testQuestion;

    @Column(name = "optionOne")
    private String optionOne;

    @Column(name = "optionTwo")
    private String optionTwo;

    @Column(name = "optionThree")
    private String optionThree;

    @Column(name = "subjectType")
    private int subjectType;

    @Column(name = "correctOptionNumber")
    private int correctOptionNumber; 

    private boolean delete = false;
.... 
```

我应该如何告诉休眠我的属性删除未映射到列？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T20:32:30.723

使用@Transient 注解：

```
@Transient
private boolean delete; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T20:34:07.370

您可以使用 @Transient 注释对其进行注释：

```
@Transient
private boolean delete = false; 
```

这告诉 Hibernate 跳过这个属性而不是生成列。

# python - 根据特定顺序重新排序字典

> ID：14025479
> 
> 赞同：0
> 
> 时间：2012-12-24T20:30:24.157
> 
> 标签：python

我有以下键值格式的字典：

```
PairDict= {(19, 6): 13, (2, 29): 10, (38, 8): 20, (38, 5): 5} 
```

键是一个包含两个元素的元组，值表示循环数。

我需要根据元组第一个元素的给定排序顺序将字典重新排序为列表，例如

```
SortOrder= [(38, 25), (19, 13), (2, 10)] 
```

其中，上面 SortOrder 中元组的第一个元素表示 PairDict 中元组键的第一个元素。SortOrder 中元组的第二个元素表示 PairDict 中第一个元素的循环数之和

如果 PairDict 有多个具有相同第一个元素的元组，则无论如何它的排序顺序都可以，例如需要首先对 38 进行排序，在 PictDict 中有两个以 38 开头的元组，即`(38, 8)`和`(38, 5)`​​ 。它的顺序可以是`[(38, 8): 20, (38, 5): 5]`或`[(38, 5): 5, (38, 8): 20]`。

基于 SortOrder 的排序 PairDict 的预期输出可以是，

```
SortedPairDict= [((38, 8), 20), ((38, 5), 5), ((19, 6), 13), ((2, 29), 10)], 
```

或者

```
SortedPairDict= [((38, 5), 5), ((38, 8), 20), ((19, 6), 13), ((2, 29), 10)], 
```

试图搜索，我能得到的最接近的例子是，

参考：[在python中任意重新排序字典列表](https://stackoverflow.com/questions/3301406/reordering-list-of-dicts-arbitrarily-in-python)

但是用那个例子来实现我的代码作为我的关键是一个元组。

如果有任何我可以阅读的示例，请您指出我，或者指导我如何处理这个问题的最佳方法。

感谢你的帮助。圣诞节快乐 ：-）

谢谢。

**更新：timeit 分析 Amber 和 Ashwini 的解决方案**

```
PairDict= {(19, 8): 13, (2, 29): 10, (38, 8): 20, (2, 18): 10, (43, 8): 20, (5, 13): 15, (6, 21): 9, (7, 25): 11, (8, 19): 15, (44, 4): 20, (0, 10): 9, (0, 36): 9, (21, 6): 19, (30, 4): 17, (24, 0): 11, (3, 14): 21, (6, 12): 9, (7, 20): 11, (20, 7): 10, (5, 23): 15, (11, 5): 15, (37, 6): 13, (34, 8): 20, (18, 2): 10, (0, 24): 9, (12, 6): 13, (8, 38): 15, (39, 5): 18, (42, 5): 17, (26, 7): 22, (10, 0): 9, (31, 0): 14, (3, 27): 21, (6, 37): 9, (36, 0): 17, (0, 33): 9, (41, 0): 18, (5, 39): 15, (5, 42): 15, (6, 40): 9, (5, 11): 15, (9, 3): 21, (25, 7): 13, (7, 28): 11, (3, 9): 21, (29, 2): 4, (32, 4): 22, (0, 41): 9, (40, 6): 10, (28, 7): 20, (6, 15): 9, (17, 4): 23, (23, 5): 18, (16, 5): 23, (8, 34): 15, (5, 16): 15, (8, 22): 15, (8, 43): 15, (4, 17): 19, (13, 5): 23, (4, 30): 19, (7, 26): 11, (15, 6): 13, (4, 44): 19, (22, 8): 18, (0, 31): 9, (35, 5): 23, (14, 3): 20, (33, 0): 12, (5, 35): 15, (27, 3): 16, (4, 32): 19}

SortOrder= [(5, 105), (4, 76), (8, 75), (3, 63), (0, 54), (6, 45), (7, 44), (13, 23), (16, 23), (17, 23), (35, 23), (26, 22), (32, 22), (9, 21), (2, 20), (14, 20), (28, 20), (34, 20), (38, 20), (43, 20), (44, 20), (21, 19), (22, 18), (23, 18), (39, 18), (41, 18), (30, 17), (36, 17), (42, 17), (27, 16), (11, 15), (31, 14), (12, 13), (15, 13), (19, 13), (25, 13), (37, 13), (33, 12), (24, 11), (18, 10), (20, 10), (40, 10), (10, 9), (29, 4)] 
```

在 [5] 中：%timeit amber() 10000 次循环，最好的 3 次：每个循环 71.1 us

在 [6] 中：%timeit ashwc() 1000 个循环，最好的 3 个：每个循环 753 us

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-24T20:33:17.363

```
sortkeys = dict((x[0], index) for index,x in enumerate(SortOrder))
SortedPairDict = sorted(PairDict.iteritems(),
                        key=lambda x: sortkeys[x[0][0]]) 
```

这里的想法是我们真的不想重新发明排序，所以我们希望有一种可以使用 Python 内置`sorted()`函数的格式。

为此，我们需要采用`sorted()`可接受的格式的订购信息。最简单的方法是定义一个 Python 已经知道如何排序的“键”，例如一组有序整数。

在这种情况下，我们通过将 SortOrder 列表中的值映射到它们在该列表中的位置来做到这一点。然后我们定义我们的 key 函数来简单地查找与元组键的第一个元素对应的 SortOrder 位置。

* * *

```
>>> sortkeys = dict((x[0], index) for index,x in enumerate(SortOrder))
>>> SortedPairDict = sorted(PairDict.iteritems(),
...                         key=lambda x: sortkeys[x[0][0]])
>>> SortedPairDict
[((38, 5), 5), ((38, 8), 20), ((19, 6), 13), ((2, 29), 10)] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-25T08:09:50.463

我发现`itertools.groupby`在这些情况下非常有用，所以我认为我应该只提一个替代方案。（实际上，我发现`itertools`在很多情况下都非常有用，但我有很多函数式编程的历史。）这里的优点是您不必构建单独的字典，这可能会或可能不会提高性能。

```
 from itertools import groupby

    PairDict= {(19, 6): 13, (2, 29): 10, (38, 8): 20, (38, 5): 5}
    key = lambda i: i[0][0]
    SortedPairDict = groupby(sorted(PairDict.iteritems(), key=key), key=key) 
```

然后`SortOrder`应该可以使用以下方法计算：

```
 SortOrder = [ (k, sum(v[1] for v in g)) for k, g in SortedPairDict ] 
```

我注意到上面较长示例中的列表没有任何特定的顺序，所以不确定我是否误解了任何东西。

# google-closure - 初始化拖放源后如何添加新的放置目标

> ID：14025481
> 
> 赞同：1
> 
> 时间：2012-12-24T20:30:44.703
> 
> 标签：google-closure, google-closure-library

如何在初始化拖放源后添加新的放置目标。我试图将它添加到源中，然后在新目标上调用 init。但它没有用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-25T11:52:27.310

这不是一个真正的答案，但我只是想让你知道我最终引入了 jQuery 和 jQuery UI 进行拖放和排序。我发现该软件包附带的拖放`goog.ui`功能太有限而且不是很灵活。并不是说 jQuery UI 中的那个没有限制和灵活，但至少它的行为更加流畅和流畅。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T04:05:04.373

作为参考，您不需要再次初始化源。只需初始化新目标并添加事件处理程序。

# silverlight - 不支持 VS2012 Silverlight Web 项目

> ID：14025484
> 
> 赞同：0
> 
> 时间：2012-12-24T20:31:50.507
> 
> 标签：silverlight, visual-studio-2012

我刚刚将包含 WPF 和 Silverlight 项目的 VS2010 解决方案升级到 VS2012，并收到此错误消息：

![在此处输入图像描述](../Images/62f28cc15d6739b69544f732e79e59a8.png)

> 此版本的 Visual Studio 未安装或不支持以下项目类型

这是VS2012 Ultimate。我是否需要框架或 SDK 才能打开 Silverlight Web 项目？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T20:35:17.610

很抱歉这么快回答我自己的问题-我很愚蠢。迁移报告有一个完美的错误消息。我需要安装 Web 开发者工具：0

![在此处输入图像描述](../Images/a462e3db9f641e9c20c286433a063ba9.png)

# c# - 正则表达式结果未显示在 C# 中？

> ID：14025485
> 
> 赞同：1
> 
> 时间：2012-12-24T20:32:16.230
> 
> 标签：c#

我试图解析来自谷歌的查询，该查询来到我的网站，但它没有出现，但根据[http://derekslager.com/blog/posts/2007/09/a-better-dotnet-regular-expression-tester.ashx](http://derekslager.com/blog/posts/2007/09/a-better-dotnet-regular-expression-tester.ashx)和与正则表达式伙伴一起，我的正则表达式是正确的。但是当我尝试使用实时开发时，它没有出现....

它是我要解析的字符串：

```
imgurl=http://www.blabla.com/products/W7i5W4Pw4fH22Mih/P_500.jpg&q=ASUS+Rampage+II+Extreme+LGA1366+Intel+X58+DDR3-1600+ATX+Motherboard&imgrefurl=http://www.blabla.com/Mboards/Intel/Rampage_II_Extreme/&usg=__4HSriQuFeVXg5AWsOGlZlsAmMmg=&h=500&w=500&sz=37&hl=en&start=1&zoom=1&tbnid=9ImqgVuzVz5ThM:&tbnh=130&tbnw=130&ei=MKrYUNm9MI6zrAfWi4GQBw&um=1&itbs=1&ptbm=isch 
```

这是我的代码。

```
string Website = url; //url
string regularExpressionPattern = @"&q=(.*?)&imgrefurl";

MatchCollection matches = Regex.Matches(Website, regularExpressionPattern);

foreach (Match m in matches)
{
    MessageBox.Show(m.Groups[1].Value);
}
System.Diagnostics.Debugger.Break(); 
```

即使使用调试器也没有结果？注意：我使用 Microsoft Visual C# 2008，windows xp 2

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T20:37:17.430

这对我来说可以：

![程序运行截图](../Images/4d5ce4139bb48db01e0fa121815caf80.png)

我怀疑该字符串不包含您认为它包含的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T20:45:41.020

我终于找到了自己的答案...

当我使用 HttpWebRequest 将其添加到我的应用程序中**时** 之后**&**

所以网址看起来像这样......

```
imgurl=http://www.blabla.com/products/W7i5W4Pw4fH22Mih/P_500.jpg&amp;q=ASUS+Rampage+II+Extreme+LGA1366+Intel+X58+DDR3-1600+ATX+Motherboard&amp;imgrefurl=http://www.blabla.com/Mboards/Intel/Rampage_II_Extreme/&amp;usg=__4HSriQuFeVXg5AWsOGlZlsAmMmg=&amp;h=500&amp;w=500&amp;sz=37&amp;hl=en&amp;start=1&amp;zoom=1&amp;tbnid=9ImqgVuzVz5ThM:&amp;tbnh=130&amp;tbnw=130&amp;ei=MKrYUNm9MI6zrAfWi4GQBw&amp;um=1&amp;itbs=1&amp;ptbm=isch 
```

有点奇怪？

# android - ProGuard 没有与 Windows 中使用的 Joda Time 一起编译

> ID：14025487
> 
> 赞同：8
> 
> 时间：2012-12-24T20:32:52.743
> 
> 标签：android, proguard, jodatime, class-reference

实际上，这是一个答案，不再是问题：我确实在 Windows 上使用 JodaTime 花了很多时间，以便使用 ProGuard 将其包含在我的 Android 项目中

Proguard 配置：

```
-libraryjars C:\Users\Reto\Documents\GitHub\advanceIT\LoveClockPAY\libs\joda-time-2.1.jar 
```

我有以下错误：

1.  ProGuard 没有找到我的 JAR 并说：

    `Can't read [C:\Users\Reto\Documents\GitHub\advanceIT\LoveClockPAY\libs\joda-time-2.1.jar] (No such file or directory)`

    **解决方案**

    `-libraryjars libs/joda-time-2.1.jar`

2.  ProGuard 不想编译并抛出许多这样的错误：

    `Warning: org.joda.time.base.AbstractDuration can't find referenced class org.joda.convert.ToString`

    **解决方案**

    `# Exclude those 2 dependency classes, cause otherwise it wont compile`

    `-dontwarn org.joda.convert.FromString`

    `-dontwarn org.joda.convert.ToString`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-19T18:40:27.207

或者作为问题 2 的解决方案。您可以添加包含在*joda-convert-xxx.jar*中的实现。可以[在 joda-convert 主页上找到](http://joda-convert.sourceforge.net/)

然后只需在您的 proguard 配置中添加以下行：

```
-libraryjars YOUR_DIR_WITHS_JARS/joda-convert-1.3.1.jar 
```

# clojure - 测试返回布尔值的函数

> ID：14025490
> 
> 赞同：3
> 
> 时间：2012-12-24T20:33:39.760
> 
> 标签：clojure

对于 Clojure 新手来说，我可能遇到了最简单的测试失败，并带有一条相当令人困惑的消息。

```
(ns leiningen.booltest
  (:use clojure.test))

(with-test
  (defn bool-function [] 
    (true))

  (is (= (bool-function) true))
)

ERROR in (bool-function) (booltest.clj:10)
expected: (= (bool-function) true)
  actual: java.lang.ClassCastException: java.lang.Boolean cannot be cast to clojure.lang.IFn 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-24T20:42:54.150

您将 true 作为函数调用：`(true)`在`with-test`表达式的第 3 行。它应该是`true`，不带括号。

您可以进一步简化您的表达式，因为`bool-function`已经返回`true`：

```
 (with-test
      (defn bool-function [] 
        true)
      (is (bool-function))) 
```

# iframe - 如何对齐 iframe 中的内容？

> ID：14025498
> 
> 赞同：3
> 
> 时间：2012-12-24T20:34:57.497
> 
> 标签：iframe

您的浏览器不支持 iframe

如何在此 iframe 中对齐内容？例如。我很酷在 iframe 中，我想将它对齐在 iframe 的中心。有什么建议么？

# xml - XQuery：仅在需要时进行迭代的最有效方式？

> ID：14025501
> 
> 赞同：2
> 
> 时间：2012-12-24T20:35:29.903
> 
> 标签：xml, for-loop, xquery, exist-db

这是我的示例：例如，如果我有一个包含 500.000 个条目的非常大的 XML 文件，如下所示：

```
<entries>
  <entry id="1">...</entry>
  <entry id="2">...</entry>
  <entry id="3">...</entry>
  ...
  <entry id="500000">...</entry>
</entries> 
```

但我只想保留 id 介于两者之间的条目，例如 500 和 1000。当然我会这样做：

```
let $entries := //entry[(xs:integer(./@id) >= 500) and (xs:integer(./@id) <= 1000)] 
```

但我想通过这个请求，我将通过 500.000 个条目继续寻找 #1000 条目。当我到达此条目 #1000 时，这是一种停止搜索的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T00:13:38.770

**如果`entry`元素按其`id`属性排序（如在提供的文档中），大多数 XPath（和 XQuery）实现应该有效地评估这一点**：

```
/*/entry[position() le 1000 and position() ge 500] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-25T06:02:03.757

由于您在评论中指出您正在使用 eXist-db，因此让我提供一些 eXist-db 特定的指导：

1.  subsequence() 函数将比大于/小于方法执行得更好。有关这方面的讨论，请参阅 Wolfgang Meier 在 eXist-db 邮件列表上的帖子，主题为“优化位置谓词以进行快速分页”： http: [//markmail.org/message/aoe5wmy2gmf3aaqh](http://markmail.org/message/aoe5wmy2gmf3aaqh)。所以在你的情况下：

    ```
    let $entries := subsequence(//entry, 500, 500) 
    ```

    这将为您提供 500-1000 个条目。

2.  如果您确实需要进行比较查询（大于/小于），您可能需要在 @id 上添加范围索引。有关范围索引以及如何设置它们的更多信息，请参阅范围索引的 eXist-db 文档页面：http: [//exist-db.org/exist/apps/doc/indexing.xml#rangeidx](http://exist-db.org/exist/apps/doc/indexing.xml#rangeidx)。

请随时加入 eXist-db 邮件列表；我们总是很乐意讨论优化查询性能的方法。在[https://lists.sourceforge.net/lists/listinfo/exist-open加入，或在](https://lists.sourceforge.net/lists/listinfo/exist-open)[http://exist.markmail.org/](http://exist.markmail.org/)搜索档案。

# hashmap - 如何覆盖 HashMap.java 中的一些函数

> ID：14025503
> 
> 赞同：1
> 
> 时间：2012-12-24T20:35:44.717
> 
> 标签：hashmap, overriding

1）阅读[HashMap.java](http://www.docjar.com/html/api/java/util/HashMap.java.html)的代码。在第 762 行，注释说*子类覆盖它以改变 put 方法的行为*。但是，函数*void addEntry(int,K,V,int)*是私有函数。它如何被子类覆盖？

```
 /**
  758        * Adds a new entry with the specified key, value and hash code to
  759        * the specified bucket.  It is the responsibility of this
  760        * method to resize the table if appropriate.
  761        *
  762        * Subclass overrides this to alter the behavior of put method.
  763        */
  764       void addEntry(int hash, K key, V value, int bucketIndex) {
  765           Entry<K,V> e = table[bucketIndex];
  766           table[bucketIndex] = new Entry<>(hash, key, value, e);
  767           if (size++ >= threshold)
  768               resize(2 * table.length); 
```

2) 在第 746 行和第 753 行，*recordAccess*和*recordRemoval*这两个函数保持为空。那么子类如何覆盖这两个函数呢？

```
 static class Entry<K,V> implements Map.Entry<K,V> {
  688           final K key;
  689           V value;
  690           Entry<K,V> next;
  691           final int hash;

                ...

                 /**
  742            * This method is invoked whenever the value in an entry is
  743            * overwritten by an invocation of put(k,v) for a key k that's already
  744            * in the HashMap.
  745            */
  746           void recordAccess(HashMap<K,V> m) {
  747           }
  748   
  749           /**
  750            * This method is invoked whenever the entry is
  751            * removed from the table.
  752            */
  753           void recordRemoval(HashMap<K,V> m) {
  754           }
  755       } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T20:44:14.553

这些方法*都不* `private`是。

未指定时的可访问性称为“包私有”。特别是，这些方法*可以*被*同一个包中*的其他类覆盖。原因*可能*是 Java 作者希望确保他们可以随时更改/重命名/替换此方法而不会破坏任何应用程序。当您不确定 API 是否良好时，将这些部分保持为“包私有”是很有意义的，收集一些以这种方式扩展类的经验，一旦您确定 API 将保持这种方式，您以后仍然可以将它们公开。但是，您不能制作它们`private`，否则您自己的类也将不允许扩展它们！

要获得*真正* `private`的方法，您应该使用关键字`private`。没有任何规范，默认就是所谓的“包私有”，对于公共接口，当没有指定时它甚至是公共的。

如果您使用的是 Eclipse，请在方法名称上尝试 Ctrl+T 以查看是否有任何类覆盖它们。

# python - 如何从 Python 中的内部函数更改外部函数局部变量？

> ID：14025504
> 
> 赞同：1
> 
> 时间：2012-12-24T20:35:44.607
> 
> 标签：python

> **可能重复：**
> [从python中的内部函数修改函数变量](https://stackoverflow.com/questions/13985671/modify-the-function-variables-frominner-function-in-python)

说我有这个 python 代码

```
def f():
    x=2
    def y():
        x+=3
    y() 
```

这引发了：

```
UnboundLocalError: local variable 'x' referenced before assignment 
```

那么，如何`local variable 'x'`从内部函数“修改”？在内部函数中将 x 定义为全局也会引发错误。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-24T20:37:24.027

您可以在 Python 3中使用[`nonlocal`语句：](http://docs.python.org/3.0/reference/simple_stmts.html#nonlocal)

```
>>> def f():
...     x = 2
...     def y():
...         nonlocal x
...         x += 3
...         print(x)
...     y()
...     print(x)
...

>>> f()
5
5 
```

在 Python 2 中，您需要将变量声明为外部函数的属性以实现相同的目的。

```
>>> def f():
...     f.x = 2
...     def y():
...         f.x += 3
...         print(f.x)
...     y()
...     print(f.x)
...

>>> f()
5
5 
```

或使用我们也可以使用 a`dictionary`或 a `list`：

```
>>> def f():
...     dct = {'x': 2}
...     def y():
...         dct['x'] += 3
...         print(dct['x'])
...     y()
...     print(dct['x'])
...

>>> f()
5
5 
```

# java - JavaFX - Media("File://derp") 以异常终止：MEDIA_INNACCESSIBLE

> ID：14025505
> 
> 赞同：5
> 
> 时间：2012-12-24T20:36:04.020
> 
> 标签：java, media-player, javafx-2, javafx

我试图通过以下方式在我的程序运行时运行一个简单的 mp3：

```
Media med = new Media("file://C:/Users/hariklia-elsa/workspace/PokerApp/src/intro.mp3");
MediaPlayer mPlayer = new MediaPlayer(med);
mPlayer.play(); 
```

但我遇到了问题。运行程序以异常终止`Exception in thread "main" MediaException: MEDIA_INACCESSIBLE : C`，参考上面代码段的第一行，即调用 Media() 构造函数的那一行。

我以前没有使用 javafx 或在代码中播放媒体的经验，有人知道为什么它会认为文件不可访问吗？我做错了什么简单的事情吗？

*该文件当然很好。我可以在无数不同的媒体播放器中打开它，这很好。*

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-25T01:30:34.877

这样它将起作用：

```
Media med = new Media("file:///C:/Users/hariklia-elsa/workspace/PokerApp/src/intro.mp3"); 
```

注意 3 后的斜线`file:`。

原因如下：[https ://superuser.com/questions/352133/what-is-the-reason-that-file-urls-start-with-three-slashes-file-etc](https://superuser.com/questions/352133/what-is-the-reason-that-file-urls-start-with-three-slashes-file-etc)

# sql - ORA-04071: 缺少 BEFORE、AFTER 或 INSTEAD OF 关键字错误

> ID：14025510
> 
> 赞同：2
> 
> 时间：2012-12-24T20:37:03.470
> 
> 标签：sql, oracle, triggers

```
CREATE TRIGGER TRG_LOADMONEY
ON KIOSK
AFTER INSERT
AS
DECLARE @LOADEDCARDID INT
DECLARE @LOADEDAMOUNT INT

SELECT @LOADEDCARDID = LOADEDCARDID, @LOADEDAMOUNT = LOADEDAMOUNT FROM INSERTED
UPGRADE CARD SET CHARGE = CHARGE + @LOADEDAMOUNT
WHERE CARDID = @LOADEDCARDID 
```

我运行此代码，但出现错误“ORA-04071：缺少 BEFORE、AFTER 或 INSTEAD OF 关键字”。我有 AFTER 声明，我不明白问题出在哪里。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-24T20:59:11.340

您已经使用了用于 sql server 的语法。

尝试这个：

```
CREATE OR REPLACE TRIGGER TRG_LOADMONEY
AFTER INSERT
ON KIOSK FOR EACH ROW
/*  
 These variables are not required because Oracle triggers can reference the table's
 columns directly using the :OLD and :NEW prefixes.   
 DECLARE 
     LOADEDCARDID PLS_INTEGER;
     LOADEDAMOUNT PLS_INTEGER;
*/
BEGIN
   UPDATE CARD 
      SET CHARGE = CHARGE + :NEW.LOADEDAMOUNT
    WHERE CARDID = :NEW.LOADEDCARDID;
END; 
```

# actionscript-3 - 在 mc 的 X 轴上拖动手指，改变值 - AS3

> ID：14025516
> 
> 赞同：0
> 
> 时间：2012-12-24T20:37:25.867
> 
> 标签：actionscript-3, air

我有一个矩形 mc。当用户在mc上慢慢向右滑动手指时，需要增加一个值，如果向左移动，它会减少。1到100是极限。我怎么做？我不想要一个可见的滑块。手指在 mc 上的哪个位置无关紧要，只要手指在哪个方向移动即可。

编辑：我目前正在研究 touchEvent 并正在研究网络以寻找解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T15:59:29.953

您需要跟踪是否正在发生滑动，如果发生了，它从哪里开始。

```
var dragging:Boolean = false;
var startX:Number = 0.0; 
```

然后，您将使用简单的事件侦听器来跟踪此布尔值。

```
mc.addEventListener(MouseEvent.MOUSE_DOWN, mouseDown);
mc.addEventListener(MouseEvent.MOUSE_UP, mouseReleased); 
function mouseDown(event:MouseEvent):void 
{ 
    dragging = true;
    startX = event.localX;
} 
function mouseReleased(event:MouseEvent):void 
{ 
    dragging = false;
} 
```

然后你的`MOUSE_MOVE`触摸事件可以处理所有的逻辑：

```
stage.addEventListener(MouseEvent.MOUSE_MOVE, mouseMove); // Notice this event is on stage, not mc.
function mouseMove(event.MouseEvent):void
{
    value += event.localX - startX;
    if (value < 0) value = 0;
    if (value > 100) value = 100;
} 
```

节日快乐！

# android - setContentView 执行太晚

> ID：14025520
> 
> 赞同：2
> 
> 时间：2012-12-24T20:38:38.117
> 
> 标签：android

我有一个问题，我做了一个简单的应用程序来告诉你我的问题。我希望 setContentView 在执行 Sleep 之前执行并显示 .xml。我以为一切都会按顺序执行？有没有人能说我为什么不这样做？

```
public class MainActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        try {
            Thread.sleep(10000);
        } catch (InterruptedException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        // do something
    } 
```

非常感谢！

编辑：

这里是真正的OnCreate，似乎是一个更大的问题。

睡眠的一切工作正常，但使用 Connect 方法存在问题。

*public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState); setContentView(R.layout.activity_main);*

 *```
ConnectBluetooth();

} 
```* 

*在 ConnectBluetooth() 方法中，我只是创建一个新的 Socket 并尝试连接。*

 *使用 ned 线程或处理程序似乎不起作用，那我该怎么办？使用类似异步任务的东西？

非常感谢共同点！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T20:41:57.397

直到创建过程完成后才会显示布局，`onResume()`调用 after 。但是，显示布局时没有回调，但您可以使用 Handler 和 Runnable 来执行此操作。

* * *

创建几个字段变量：

```
Handler handler = new Handler();
Runnable delay = new Runnable() {
    @Override
    public void run() {
        // Do something 
    }
}; 
```

并`onCreate()`调用：

```
handler.postDelayed(delay, 10000); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T20:41:26.490

当您调用 时`sleep`，您正在暂停 UI 线程。这将阻止`onCreate`返回，这将阻止框架完成您的活动的初始化，包括显示您的视图层次结构。

你不应该像那样暂停 UI 线程。如果你想在 10 秒后做某事，你可以启动一个单独的线程，它会在正确的时间做这件事：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    new Thread() {
        @Override
        public void run() {
            try {
                Thread.sleep(10000);
                doSomething();
            } catch (InterruptedException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }
    }.start();
} 
```

更清洁的方法是使用`Handler`：

```
Handler mHandler;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    mHandler = new Handler();
    mHandler.postDelayed(new Runnable() {
        @Override
        public void run() {
            doSomething();
        }
    }, 10000);
} 
```*

# qt - 自定义 URL 协议处理程序 Qt 5

> ID：14025521
> 
> 赞同：10
> 
> 时间：2012-12-24T20:38:43.063
> 
> 标签：qt, url, qml, qt-quick, qiodevice

我想在我的应用程序中使用`Video`/ `MediaPlayer`QML 元素，并让它播放自定义流中的视频。`QMediaPlayer`似乎支持这一点，因为您可以告诉它从`QIODevice`可以做任何您想做的事情的 a 中读取。但`MediaPlayer`只支持一个 URL。

有什么方法可以注册我自己的使用我自己的流协议的 URL 方案？例如，说我想做`rtsp2://...`，我可以做一些模糊的事情，比如：

```
class Rtsp2 : public QIODevice
{
    // open, read, seek, close, etc.
}

QCoreApplication::registerUrlProtocol("rtsp2", Rtsp2); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-21T08:57:18.827

我还没有查看详细信息，但 QML 引擎有一个用于连接的 QNetworkAccessManager。您可以通过子类化和挂钩 createRequest 在 QNAM 层添加自己的协议。但是我怀疑 QMediaPlayer 可能不会使用此 QNAM 进行媒体加载，因为底层媒体层通常提供自己的 IO 抽象。

（此外，向 QNAM 添加自定义协议并非易事——理想情况下，这将是一个简单的“registerProtocolFor”调用，但遗憾的是事实并非如此）

# css - CSS侧边栏中的内部链接

> ID：14025524
> 
> 赞同：0
> 
> 时间：2012-12-24T20:39:54.483
> 
> 标签：css, html

我有一个带有“粘性”标题和侧边栏的网页。每个都有导航。我也有一个页脚。如何`nav`在侧边栏中放置内部链接？

当我尝试将内部或外部链接放入时，这`sidenav`两个链接都不起作用。

[jsfiddle](http://jsfiddle.net/247t1aW3b/wMZ8V/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T20:48:44.140

你有`z-index`的`#side_nav`设置为`-1`。负值将阻止元素被点击。将其更改为`0`或更高。

```
z-index: 0; 
```

[演示](http://jsfiddle.net/GmCde/)

# ios - Xcode 4.5.x 版本编辑器显示“无编辑器”消息

> ID：14025525
> 
> 赞同：0
> 
> 时间：2012-12-24T20:39:58.180
> 
> 标签：ios, xcode, git, version-control

我最近开始了一个没有什么不寻常的新项目。每当我使用版本编辑器时，我都会收到“无编辑器”的消息，通常会出现文本。更奇怪的是，除了项目本身之外，我的所有文件都是一样的。它实际上正确地显示了版本历史。

我对这个项目所做的与其他项目唯一不同的是使用 Cocos2D 和 BitBucket（使用 GIT）。其他一切都很香草。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-29T04:05:56.957

您应该选择文件并等待很长时间。有时我对项目文件有同样的问题。3-5 分钟后问题得到解决（编辑器已加载），我可以编辑冲突。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-25T00:51:42.693

版本编辑器一直很麻烦。

试试看`File -> Source Control -> Refresh Status`能不能解决。

# c# - 如何在 mvvm 中绑定鼠标双击命令

> ID：14025530
> 
> 赞同：19
> 
> 时间：2012-12-24T20:40:57.833
> 
> 标签：c#, wpf, mvvm

我有列表视图，我想在有人双击任何位置时显示新窗口。但是我有 mvvm 应用程序，我不想在 xaml 文件后面的代码中有任何功能，例如：[如何绑定命令以双击 DataGrid 中的一行](https://stackoverflow.com/questions/5808616/how-to-bind-a-command-to-double-click-on-a-row-in-datagrid)以及许多其他类似的示例。我想在 viewmodel 文件中有方法并像这样绑定它：

```
<ListView ... MouseDoubleClick="{Binding myfunction}"> 
```

谢谢

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-12-24T22:55:24.937

这是基于列表中单击的项目触发命令（在 ViewModel 中）的方法的工作示例。ViewModel 中的命令将获取“单击”项作为其参数。

我正在使用 Textblock.InputBindings，它可能是 Blachshma 链接的*Blend SDK*的一部分，但您不需要任何其他 DLL 即可工作。

在我的示例中，ViewModel 绑定到 UserControl 的 DataContext，这就是为什么我需要使用*RelativeSource FindAncestor*从我的 TextBlock 中查找 ViewModel。

**编辑**：通过将*TextBlock的**Width绑定到**ListBox*的*ActualWidth*来修复宽度问题。

 ***~~只是**一个**问题，即使列表本身更宽，双击也只会在您单击文本块中的文本时起作用。~~

```
 <ListView ItemsSource="{Binding Model.TablesView}"   Grid.Row="1" 
              SelectedItem="{Binding Model.SelectedTable, Mode=TwoWay}"  >
        <ListView.ItemTemplate>
            <DataTemplate>
                <TextBlock Text="{Binding Path=.}" 
                   Width="{Binding Path=ActualWidth, 
                             RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ListView}}}" >
                    <TextBlock.InputBindings>
                        <MouseBinding MouseAction="LeftDoubleClick" Command="{Binding DataContext.MoveItemRightCommand,
                                        RelativeSource={RelativeSource FindAncestor, 
                                        AncestorType={x:Type UserControl}}}"
                                      CommandParameter="{Binding .}"/>
                    </TextBlock.InputBindings>
                </TextBlock>
            </DataTemplate>
        </ListView.ItemTemplate>
    </ListView> 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-12-25T06:18:43.863

您可以使用[附加属性](http://msdn.microsoft.com/en-us/library/ms749011.asp)来绑定您想要的任何事件。

对于`MouseDoubleClick`：

```
namespace Behavior
{
public class MouseDoubleClick
{
    public static DependencyProperty CommandProperty =
        DependencyProperty.RegisterAttached("Command",
        typeof(ICommand),
        typeof(MouseDoubleClick),
        new UIPropertyMetadata(CommandChanged));

    public static DependencyProperty CommandParameterProperty =
        DependencyProperty.RegisterAttached("CommandParameter",
                                            typeof(object),
                                            typeof(MouseDoubleClick),
                                            new UIPropertyMetadata(null));

    public static void SetCommand(DependencyObject target, ICommand value)
    {
        target.SetValue(CommandProperty, value);
    }

    public static void SetCommandParameter(DependencyObject target, object value)
    {
        target.SetValue(CommandParameterProperty, value);
    }
    public static object GetCommandParameter(DependencyObject target)
    {
        return target.GetValue(CommandParameterProperty);
    }
    private static void CommandChanged(DependencyObject target, DependencyPropertyChangedEventArgs e)
    {
        Control control = target as Control;
        if (control != null)
        {
            if ((e.NewValue != null) && (e.OldValue == null))
            {
                control.MouseDoubleClick += OnMouseDoubleClick;
            }
            else if ((e.NewValue == null) && (e.OldValue != null))
            {
                control.MouseDoubleClick -= OnMouseDoubleClick;
            }
        }
    }
    private static void OnMouseDoubleClick(object sender, RoutedEventArgs e)
    {
        Control control = sender as Control;
        ICommand command = (ICommand)control.GetValue(CommandProperty);
        object commandParameter = control.GetValue(CommandParameterProperty);
        command.Execute(commandParameter);
    }
}
} 
```

在 Xaml 中：

```
 <ListBox Behavior:MouseDoubleClick.Command="{Binding ....}"
          Behavior:MouseDoubleClick.CommandParameter="{Binding ....}"/> 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-12-24T20:56:04.823

最简单的方法是使用`System.Windows.Interactivity`和`Microsoft.Expression.Interactions`（都可以通过[Blend SDK](http://www.microsoft.com/en-us/download/details.aspx?id=10801)免费获得）

因此，首先将以下命名空间添加到您的视图中

```
xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
xmlns:ei="http://schemas.microsoft.com/expression/2010/interactions" 
```

接下来，捕获 DoubleClick 事件并将其传递给命令：

```
<ListView ..... >
    <i:Interaction.Triggers>
        <i:EventTrigger EventName="MouseDoubleClick">
            <local:EventToCommand Command="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=DataContext.myfunction}" />
         </i:EventTrigger
    </i:Interaction.Triggers>
</ListView> 
```

注意：`EventToCommand`使用的是[MVVM Light Toolkit](http://mvvmlight.codeplex.com/)中的一个，可以在[这里](http://mvvmlight.codeplex.com/SourceControl/changeset/view/b922e8ccf674#GalaSoft.MvvmLight/GalaSoft.MvvmLight.Extras%20(NET4)/Command/EventToCommandVS10.cs)下载。它的作用是`myFunction`在事件触发后立即执行命令 ( )。

`myFunction`这是基于命令位于 ListView 用户的 DataContext 中的假设。否则，将 EventToCommand 的绑定修改为命令所在的位置。***

# java - 有关 ArrayList 的条件分配的范围问题

> ID：14025538
> 
> 赞同：2
> 
> 时间：2012-12-24T20:41:57.767
> 
> 标签：java, arraylist, conditional, variable-assignment

我试图根据从 HTTPRequest 对象中提取的属性来处理我的代码中的许多不同情况。问题是，不同的数据被拉取来填充依赖于请求内容的 ArrayList，但格式是相同的。

```
if (request.getAttribute("timePeriod").equals(null)) {
    ArrayList<ArrayList<MyWeirdObject>> HM = Test.getGlobalChallenge();
}
else {
    ArrayList<ArrayList<MyWeirdObject>> HM = Test.getGlobalChallengeByMonth(Test);
} 
```

如果我没有在赋值之前对其进行初始化，那么代码（在 JSP 中）会说——当然——它不能解析 HM 对象。

```
ArrayList<ArrayList<MyWeirdObject>> HM = new ArrayList<ArrayList<MyWeirdObject>>();
if (request.getAttribute("timePeriod").equals(null)) {
    ArrayList<ArrayList<MyWeirdObject>> HM = Test.getGlobalChallenge();
}
else {
    ArrayList<ArrayList<MyWeirdObject>> HM = Test.getGlobalChallengeByMonth(Test);
} 
```

但是如果我初始化它，它会抱怨重复的局部变量。如何将其设置为根据不同情况进行不同的初始化/分配？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-24T20:43:44.187

不要在 if 块内再次声明 ArrayList。

```
ArrayList<ArrayList<MyWeirdObject>> HM;
if ((request.getAttribute("timePeriod") == null) {
    HM = Test.getGlobalChallenge();
}
else {
    HM = Test.getGlobalChallengeByMonth(Test);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-24T20:44:05.630

试试这个：

```
ArrayList<ArrayList<MyWeirdObject>> HM;
if ((request.getAttribute("timePeriod") == null) {
    HM = Test.getGlobalChallenge();
}
else {
    HM = Test.getGlobalChallengeByMonth(Test);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-24T20:43:58.663

您不能重新声明该变量。见下文

```
ArrayList<ArrayList<MyWeirdObject>> HM = new ArrayList<ArrayList<MyWeirdObject>>();
if ((request.getAttribute("timePeriod") == null) {
    HM = Test.getGlobalChallenge();
}
else {
    HM = Test.getGlobalChallengeByMonth(Test);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-24T20:44:18.913

在 if/else 外部声明`HM`并初始化它，然后`null`在 if/else 内部使用它，如下所示：

```
ArrayList<ArrayList<MyWeirdObject>> HM=null;
    if ((request.getAttribute("timePeriod") == null) {
       HM = Test.getGlobalChallenge();
    }
    else {
     HM = Test.getGlobalChallengeByMonth(Test);
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-07-14T20:12:20.757

这是在我对变量范围和实例化了解很多之前。我有两个问题。

```
if (request.getAttribute("timePeriod").equals(null)) {
    ArrayList<ArrayList<MyWeirdObject>> HM = Test.getGlobalChallenge();
}
else {
    ArrayList<ArrayList<MyWeirdObject>> HM = Test.getGlobalChallengeByMonth(Test);
} 
```

在这里，变量只存在于各自的案例中；当然，在此上下文之外引用它们失败了，因为它们不存在于更广泛的范围内。

```
ArrayList<ArrayList<MyWeirdObject>> HM = new ArrayList<ArrayList<MyWeirdObject>>();
if (request.getAttribute("timePeriod").equals(null)) {
    ArrayList<ArrayList<MyWeirdObject>> HM = Test.getGlobalChallenge();
}
else {
    ArrayList<ArrayList<MyWeirdObject>> HM = Test.getGlobalChallengeByMonth(Test);
} 
```

而这个失败是因为我试图在 if/else 块中无意中实例化第二个 HM 值，这与第一个冲突。

```
ArrayList<ArrayList<MyWeirdObject>> HM = new ArrayList<ArrayList<MyWeirdObject>>();
if (request.getAttribute("timePeriod").equals(null)) {
    HM = Test.getGlobalChallenge();
}
else {
    HM = Test.getGlobalChallengeByMonth(Test);
} 
```

正确的方法是在更广泛的范围内实例化变量，并在更小的范围内引用它——而不是重新初始化它。

# sony - 生成 SmartWatch 图标

> ID：14025543
> 
> 赞同：0
> 
> 时间：2012-12-24T20:43:35.247
> 
> 标签：sony, sony-smartwatch

索尼是否有类似于以下链接的 SmartWatch 图标？

[http://android-ui-utils.googlecode.com/hg/asset-studio/dist/index.html](http://android-ui-utils.googlecode.com/hg/asset-studio/dist/index.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T19:24:16.187

没有为智能手表生成图标的工具，但我们确实有帮助开发人员生成正确图标的指南。

您可以在此处找到更多信息：http: [//developer.sonymobile.com/knowledge-base/tool-guides/download-the-new-smart-extension-sdk-and-create-smart-extras-apps/](http://developer.sonymobile.com/knowledge-base/tool-guides/download-the-new-smart-extension-sdk-and-create-smart-extras-apps/)

**更新：**索尼智能手表设计指南可在索尼附加文档工具包中获得或直接在此处获得： http: [//dl-developer.sonymobile.com/documentation/other/SmartWatch_products_2.pdf](http://dl-developer.sonymobile.com/documentation/other/SmartWatch_products_2.pdf)

# google-api - Google Drive API：列出没有父级的文件

> ID：14025546
> 
> 赞同：11
> 
> 时间：2012-12-24T20:43:52.517
> 
> 标签：google-api, google-drive-api, google-api-client

我管理的 Google 域中的文件已进入不良状态；根目录中有数千个文件。我想识别这些文件并将它们移动到“我的云端硬盘”下的文件夹中。

当我使用 API 列出这些孤立文件之一的父级时，结果是一个空数组。要确定文件是否为孤立文件，我可以遍历域中的所有文件，并请求每个文件的父级列表。如果列表为空，我知道该文件是孤立的。

但这非常慢。

无论如何使用Drive API来搜索没有父母的文件？

q 参数的“父母”字段似乎对此没有用，因为它只能指定父母列表包含一些 ID。

**更新：**

我试图找到一种快速的方法来定位真正位于文档层次结构根部的项目。也就是说，他们是“My Drive”的兄弟姐妹，而不是“My Drive”的孩子。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-26T18:04:14.307

在 Java 中：

```
List<File> result = new ArrayList<File>();
Files.List request = drive.files().list();
request.setQ("'root'" + " in parents");

FileList files = null;
files = request.execute();

for (com.google.api.services.drive.model.File element : files.getItems()) {
    System.out.println(element.getTitle());
} 
```

'root' 是父文件夹，如果文件或文件夹在根目录下

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-15T12:57:27.167

粗鲁，但简单，它的工作原理..

```
 do {
        try {
            FileList files = request.execute();

            for (File f : files.getItems()) {
                if (f.getParents().size() == 0) {
                        System.out.println("Orphan found:\t" + f.getTitle());

                orphans.add(f);
                }
            }

            request.setPageToken(files.getNextPageToken());
        } catch (IOException e) {
            System.out.println("An error occurred: " + e);
            request.setPageToken(null);
        }
    } while (request.getPageToken() != null
            && request.getPageToken().length() > 0); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-28T15:26:03.977

尝试在您的查询中使用它：

```
'root' in parents 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-04-26T23:48:18.353

**前提是：**

*   列出所有文件。
*   如果文件没有“父母”字段，则表示它是孤立文件。
*   因此，脚本将它们删除。

**在开始之前，您需要：**

*   创建[OAuth id](https://console.developers.google.com/apis/credentials?project=quantum-shard-275213)
*   然后，您需要将权限“../auth/drive”添加到您的 OAuth id，并[针对 google 验证您的应用程序](https://console.developers.google.com/apis/credentials/consent)，以便您拥有删除权限。

**准备复制粘贴演示**

```
from __future__ import print_function
import pickle
import os.path
from googleapiclient.discovery import build
from google_auth_oauthlib.flow import InstalledAppFlow
from google.auth.transport.requests import Request

# If modifying these scopes, delete the file token.pickle.
SCOPES = ['https://www.googleapis.com/auth/drive']

def callback(request_id, response, exception):
    if exception:
        print("Exception:", exception)

def main():
    """
   Description:
   Shows basic usage of the Drive v3 API to delete orphan files.
   """

    """ --- CHECK CREDENTIALS --- """
    creds = None
    # The file token.pickle stores the user's access and refresh tokens, and is
    # created automatically when the authorization flow completes for the first
    # time.
    if os.path.exists('token.pickle'):
        with open('token.pickle', 'rb') as token:
            creds = pickle.load(token)
    # If there are no (valid) credentials available, let the user log in.
    if not creds or not creds.valid:
        if creds and creds.expired and creds.refresh_token:
            creds.refresh(Request())
        else:
            flow = InstalledAppFlow.from_client_secrets_file(
                'credentials.json', SCOPES)
            creds = flow.run_local_server(port=0)
        # Save the credentials for the next run
        with open('token.pickle', 'wb') as token:
            pickle.dump(creds, token)

    """ --- OPEN CONNECTION --- """
    service = build('drive', 'v3', credentials=creds)

    page_token = ""
    files = None
    orphans = []
    page_size = 100
    batch_counter = 0

    print("LISTING ORPHAN FILES")
    print("-----------------------------")
    while (True):
        # List
        r = service.files().list(pageToken=page_token,
                                 pageSize=page_size,
                                 fields="nextPageToken, files"
                                 ).execute()
        page_token = r.get('nextPageToken')
        files = r.get('files', [])

        # Filter orphans
        # NOTE: (If the file has no 'parents' field, it means it's orphan)
        for file in files:
            try:
                if file['parents']:
                    print("File with a parent found.")
            except Exception as e:
                print("Orphan file found.")
                orphans.append(file['id'])

        # Exit condition
        if page_token is None:
            break

    print("DELETING ORPHAN FILES")
    print("-----------------------------")
    batch_size = min(len(orphans), 100)
    while(len(orphans) > 0):
        batch = service.new_batch_http_request(callback=callback)
        for i in range(batch_size):
            print("File with id {0} queued for deletion.".format(orphans[0]))
            batch.add(service.files().delete(fileId=orphans[0]))
            del orphans[0]
        batch.execute()
        batch_counter += 1
        print("BATCH {0} DELETED - {1} FILES DELETED".format(batch_counter,
                                                             batch_size))

if __name__ == '__main__':
    main() 
```

此方法不会删除根目录中的文件，因为它们具有字段 'parents' 的 'root' 值。如果没有列出您的所有孤立文件，则表示它们正在被 google 自动删除。此过程最多可能需要 24 小时。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-02-24T01:36:38.403

[文档](https://support.google.com/a/answer/6008339?hl=en)建议使用以下查询：`is:unorganized owner:me`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-07-08T19:44:27.980

Adreian Lopez，谢谢你的剧本。它真的为我节省了很多手工工作。以下是我为实现您的脚本所遵循的步骤：

1.  创建了一个文件夹`c:\temp\pythonscript\ folder`

2.  [使用https://console.cloud.google.com/apis/credentials](https://console.cloud.google.com/apis/credentials)创建了 OAuth 2.0 客户端 ID ，并将凭证文件下载到`c:\temp\pythonscript\ folder`.

3.  将以上内容重命名`client_secret_#######-#############.apps.googleusercontent.com.json`为`credentials.json`

4.  复制 Adreian Lopez 的 python 脚本并将其保存为`c:\temp\pythonscript\deleteGoogleDriveOrphanFiles.py`

5.  转到 Windows 10 上的“Microsoft Store”并安装 Python 3.8

6.  打开命令提示符并输入：`cd c:\temp\pythonscript\`

7.  跑`pip install --upgrade google-api-python-client google-auth-httplib2 google-auth-oauthlib`

8.  运行`python deleteGoogleDriveOrphanFiles.py`并按照屏幕上的步骤创建`c:\temp\pythonscript\token.pickle`文件并开始删除孤立文件。这一步可能需要相当长的时间。

9.  验证[https://one.google.com/u/1/storage](https://one.google.com/u/1/storage)

10.  根据需要再次运行第 8 步。

# python - 使用分层索引更改数据框中的数据

> ID：14025549
> 
> 赞同：7
> 
> 时间：2012-12-24T20:43:59.000
> 
> 标签：python, pandas, hierarchical

如何使用分层索引更改 DataFrame 中的每个元素？例如，也许我想将字符串转换为浮点数：

```
from pandas import DataFrame
f = DataFrame({'a': ['1,000','2,000','3,000'], 'b': ['2,000','3,000','4,000']})
f.columns = [['level1', 'level1'],['item1', 'item2']]
f
Out[152]:
        level1
     item1   item2
0    1,000   2,000
1    2,000   3,000
2    3,000   4,000 
```

我试过这个：

```
def clean(group):
    group = group.map(lambda x: x.replace(',', ''))
    return group
f.apply(clean)
Out[153]:
(level1, item1) (level1, item2)
0    1000    2000
1    2000    3000
2    3000    4000 
```

如您所见，它对分层索引进行了相当大的更改。我怎样才能避免这种情况？或者也许有更好的方法。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-24T20:51:27.357

将`axis`选项传递给`apply`函数：

```
In [265]: f.apply(clean, axis=1)
Out[265]:
  level1
   item1 item2
0   1000  2000
1   2000  3000
2   3000  4000 
```

当两个轴都有分层索引时，这是一种解决方法：

```
In [316]: f.index = [[1,2,3],[1,2,3]]

In [317]: f
Out[317]:
    level1
     item1  item2
1 1  1,000  2,000
2 2  2,000  3,000
3 3  3,000  4,000

In [314]: f.apply(clean, axis=1).reindex(f.index)
Out[314]:
    level1
     item1 item2
1 1   1000  2000
2 2   2000  3000
3 3   3000  4000 
```

# mpi - C MPI 多动态数组传递

> ID：14025558
> 
> 赞同：1
> 
> 时间：2012-12-24T20:45:02.487
> 
> 标签：mpi

我正在尝试`ISend()`两个数组：`arr1,arr2`和一个`n`大小为`arr1,arr2`. 我从这篇[文章](https://stackoverflow.com/questions/10419990/creating-an-mpi-datatype-for-a-structure-containing-pointers)中了解到，发送包含所有三个的结构不是一种选择，因为`n`仅在运行时才知道。显然，我需要`n`先被接收，否则接收过程将不知道要接收多少元素。在不使用 blkcing 的情况下实现这一目标的最有效方法是什么`Send()`？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-27T08:16:41.610

发送数组的大小是多余的（而且效率低下），因为 MPI 提供了一种无需接收即可探测传入消息的方法，这提供了足够的信息以正确分配内存。使用 执行探测`MPI_PROBE`，看起来很像`MPI_RECV`，除了它不接受与缓冲区相关的参数。探测操作返回一个状态对象，然后可以查询给定 MPI 数据类型的元素数量，这些元素可以从消息的内容中提取`MPI_GET_COUNT`，因此显式发送元素数量变得多余。

这是一个有两个等级的简单示例：

```
if (rank == 0)
{
    MPI_Request req;

    // Send a message to rank 1
    MPI_Isend(arr1, n, MPI_DOUBLE, 1, 0, MPI_COMM_WORLD, &req);
    // Do not forget to complete the request!
    MPI_Wait(&req, MPI_STATUS_IGNORE);
}
else if (rank == 1)
{
    MPI_Status status;

    // Wait for a message from rank 0 with tag 0
    MPI_Probe(0, 0, MPI_COMM_WORLD, &status);
    // Find out the number of elements in the message -> size goes to "n"
    MPI_Get_count(&status, MPI_DOUBLE, &n);
    // Allocate memory
    arr1 = malloc(n*sizeof(double));
    // Receive the message. ignore the status
    MPI_Recv(arr1, n, MPI_DOUBLE, 0, 0, MPI_COMM_WORLD, MPI_STATUS_IGNORE);
} 
```

`MPI_PROBE`也接受通配符等级`MPI_ANY_SOURCE`和通配符标签`MPI_ANY_TAG`。然后可以查阅状态结构中的相应条目，以找出实际的发件人等级和实际的消息标签。

探测消息大小的工作原理是每条消息都带有一个标头，称为*信封*。信封由发送者等级、接收者等级、消息标签和通信者组成。它还携带有关总消息大小的信息。信封作为两个通信进程之间初始握手的一部分发送。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-25T10:51:16.213

首先，您需要将内存（完整内存 = n = 元素）分配给排名为 0 的 arr1 和 arr2。即您的前端处理器。

根据编号将数组分成几部分。处理器。确定每个处理器的元素计数。

将此元素计数从等级 0 发送到其他处理器。

第二次发送用于数组，即 arr1 和 arr2

在其他处理器中，根据从主处理器接收到的元素计数，即rank = 0，分配arr1 和arr2。接收到元素计数后，接收分配的内存中的两个数组。

这是一个示例 C++ 实现，但 C 将遵循相同的逻辑。也只需将 Send 与 Isend 互换。

```
 #include <mpi.h>
    #include <iostream>

    using namespace std;

    int main(int argc, char*argv[])
    {
        MPI::Init (argc, argv);

        int rank = MPI::COMM_WORLD.Get_rank();
        int no_of_processors = MPI::COMM_WORLD.Get_size();
        MPI::Status status;

        double *arr1;

        if (rank == 0)
        {
            //  Setting some Random n
            int n = 10;

            arr1 = new double[n];

            for(int i = 0; i < n; i++)
            {
                arr1[i] = i;
            }

            int part = n / no_of_processors;
            int offset = n % no_of_processors;

            //  cout << part << "\t" << offset << endl;

            for(int i = 1; i < no_of_processors; i++)
            {
                int start   = i*part;
                int end     = start + part - 1;

                if (i == (no_of_processors-1))
                {
                    end += offset;
                }

                //  cout << i << " Start: " << start << "  END: " << end;

                //  Element_Count
                int e_count = end - start + 1;

                //  cout << " e_count: " << e_count << endl;
                //  Sending
                MPI::COMM_WORLD.Send(
                                        &e_count,
                                        1,
                                        MPI::INT,
                                        i,
                                        0
                                    );

                //  Sending Arr1
                MPI::COMM_WORLD.Send(
                                        (arr1+start),
                                        e_count,
                                        MPI::DOUBLE,
                                        i,
                                        1
                                    );
            }
        }
        else
        {
            //  Element Count
            int e_count;

            //  Receiving elements count
            MPI::COMM_WORLD.Recv (   
                                    &e_count,
                                    1,
                                    MPI::INT,
                                    0,
                                    0,
                                    status
                                 );

            arr1 = new double [e_count];
            //  Receiving FIrst Array
            MPI::COMM_WORLD.Recv (
                                    arr1,
                                    e_count,
                                    MPI::DOUBLE,
                                    0,
                                    1,
                                    status
                                 );

            for(int i = 0; i < e_count; i++)
            {
                cout << arr1[i] << endl;
            }
        }

        //  if(rank == 0) 
        delete [] arr1;

        MPI::Finalize();

        return 0;
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-01T11:11:38.753

@Histro 我想说的是，Irecv/Isend 是一些由 MPI lib 操作的函数。您提出的问题完全取决于您在发送/接收后所做的其余代码。有2种情况：

1.  **Master 和 Worker** 您将部分问题（比如数组）发送给工作人员（除 0=Master 之外的所有其他等级）。worker 做了一些工作（在数组上），然后将结果返回给 master。然后，主人将结果相加，并将新的工作传达给工人。现在，在这里您希望主人等待所有工人返回他们的结果（修改后的数组）。因此，您不能使用 Isend 和 Irecv，而是在我的代码和相应的 recv 中使用的多次发送。如果您的代码朝这个方向发展，您想使用 B_cast 和 MPI_Reduce。

2.  **懒惰** 的主人 主人分工，不关心工人的结果。假设您想为相同的数据编写不同类型的模式。就像给定某个城市的人口特征一样，你想计算出有多少人在 18 岁以上，有多少人有工作，有多少人在某家公司工作。现在这些结果彼此没有任何关系。在这种情况下，您不必担心工作人员是否收到数据。master可以继续执行剩下的代码。这是可以安全使用 Isend/Irecv 的地方。

# sqlite - 使用 SQlite 绑定 GroupedItems 模板但只获取 GroupNames

> ID：14025560
> 
> 赞同：0
> 
> 时间：2012-12-24T20:45:23.080
> 
> 标签：sqlite, xaml, data-binding, gridview, windows-8

此代码来自数据源类。我正在从 SQLite 数据库中获取客户列表并将其存储在`ObservableCollection`. 使用`GetGroups()`我创建基于某些属性的组：

```
public ObservableCollection<CustomerDetails> GetAllCustomers()
        {
            using (var con = new SQLiteConnection(app.DBPath))
            {
                ObservableCollection<CustomerDetails> newCol = new ObservableCollection<CustomerDetails>(con.Query<CustomerDetails>("Select * from CustomerDetails"));
                return newCol;
            }
        }

public IEnumerable<IGrouping<int,CustomerDetails>> GetGroups()
        {
            return GetAllCustomers().OrderBy(x=>x.CustomerName).GroupBy(x=>x.CustomerPropertyType);
        } 
```

这就是我绑定网格视图的方式

```
 CustomerImplementation objCustomerImp = new CustomerImplementation();
        var all = objCustomerImp.GetGroups();

        this.DefaultViewModel["Groups"] = all; 
```

XAML 文件：

`CustomerName`,`ContactNo1`和`EmailId`是里面的属性`DataSource`。所有这些都绑定在上面的代码中。

```
<CollectionViewSource
            x:Name="groupedItemsViewSource"
            Source="{Binding Groups}"
            IsSourceGrouped="true"/>

<GridView
            x:Name="itemGridView"
            IsItemClickEnabled="True"
            IsSwipeEnabled="True"
            Grid.RowSpan="2"
            Padding="116,136,116,46"
            ItemsSource="{Binding Mode=OneWay, Source={StaticResource groupedItemsViewSource}}"
            SelectionMode="Single"
            SelectedItem="0">
            <GridView.ItemTemplate>
                <DataTemplate>
                    <Grid HorizontalAlignment="Left" Width="320" Height="240">
                        <StackPanel VerticalAlignment="Bottom" Background="{StaticResource ListViewItemOverlayBackgroundThemeBrush}">
                            <TextBlock Text="{Binding CustomerName}" Foreground="{StaticResource ListViewItemOverlayForegroundThemeBrush}" Style="{StaticResource TitleTextStyle}" Height="48" Margin="15,0,15,0"/>
                            <TextBlock Text="{Binding ContactNo1}" Foreground="{StaticResource ListViewItemOverlayForegroundThemeBrush}" Style="{StaticResource TitleTextStyle}" Height="48" Margin="15,0,15,0"/>
                            <TextBlock Text="{Binding EmailId}" Foreground="{StaticResource ListViewItemOverlayForegroundThemeBrush}" Style="{StaticResource TitleTextStyle}" Height="48" Margin="15,0,15,0"/>
                        </StackPanel>
                    </Grid>
                </DataTemplate>
            </GridView.ItemTemplate>
                <GridView.ItemsPanel>
                <ItemsPanelTemplate>                        
                    <VirtualizingStackPanel Orientation="Horizontal"/>
                </ItemsPanelTemplate>
            </GridView.ItemsPanel>
            <GridView.GroupStyle>
                <GroupStyle>
                    <GroupStyle.HeaderTemplate>
                        <DataTemplate>
                            <Grid Margin="1,0,0,6">
                                <Button
                                    AutomationProperties.Name="Group Title"
                                    Style="{StaticResource TextPrimaryButtonStyle}">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="{Binding Key}" Margin="3,-7,10,10" Style="{StaticResource GroupHeaderTextStyle}" />
                                        <TextBlock Text="{StaticResource ChevronGlyph}" FontFamily="Segoe UI Symbol" Margin="0,-7,0,10" Style="{StaticResource GroupHeaderTextStyle}"/>
                                    </StackPanel>
                                </Button>
                            </Grid>
                        </DataTemplate>
                    </GroupStyle.HeaderTemplate>
                    <GroupStyle.Panel>
                        <ItemsPanelTemplate>
                            <VariableSizedWrapGrid Orientation="Vertical" Margin="0,0,80,0"/>
                        </ItemsPanelTemplate>
                    </GroupStyle.Panel>
                </GroupStyle>
            </GridView.GroupStyle>
        </GridView> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-05T08:35:11.207

我重新创建了您的解决方案，并在`DefaultViewModel`. 使用您自己的 DefaultViewModel 实现，或将其称为 MainViewModel，它实现了`INotifyPropertyChanged`，例如：

```
public class MainViewModel : INotifyPropertyChanged
{
   private IEnumerable<IGrouping<int, CustomerDetails>> groups = null;
   public IEnumerable<IGrouping<int, CustomerDetails>> Groups
   {
       get { return groups; }
       private set { Set(ref groups, value); }
   }

   #region INotifyPropertyChanged implementation
   public event PropertyChangedEventHandler PropertyChanged;
   private bool Set<T>(ref T storage, object value, [CallerMemberName] string propertyName = null)
   {
      if (object.Equals(storage, value))
         return false;
      storage = value;
      if (PropertyChanged != null)
      {
         PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
      } 
      return true;
   }
   #endregion
} 
```

然后将您的 Page 的 DataContext 设置为 MainViewModel 的一个实例，并使用您想要的数据设置 Groups 属性（也应该在 MainViewModel 中，例如，使用某种`LoadGroups`方法）。页面资源中的 CollectionViewSource 引用 MainViewModel 的 Groups 属性，您将在 GridView 中看到您的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T21:33:43.960

我相信 SQLite-net 是延迟实现的，因此在您尝试访问集合中的项目之前，查询实际上不会给出任何结果。尝试将 ToList() 放在 Query 调用的末尾：

```
public ObservableCollection<CustomerDetails> GetAllCustomers()
{
    using (var con = new SQLiteConnection(app.DBPath))
    {
        // add ToList() to query to instantiate the results
        ObservableCollection<CustomerDetails> newCol = new ObservableCollection<CustomerDetails>(con.Query<CustomerDetails>("Select * from CustomerDetails").ToList());

        return newCol;
    }
} 
```

# iphone - 视频搜索

> ID：14025563
> 
> 赞同：0
> 
> 时间：2012-12-24T20:45:42.880
> 
> 标签：iphone, objective-c, xcode

我正在为 iPhone 开发应用程序，用户单击按钮，从他的 iPhone 获取所有视频的列表并将所选视频上传到服务器。我知道如何将视频上传到服务器，但我不知道如何实现视频搜索。如何获取阵列中所有视频（在用户 iPhone 中）的路径？（目前我的 iPhone 无法使用，所以我也想知道如何在 iPhone Simulator 中测试视频搜索？）

亲切的问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T22:44:31.830

此链接显示如何仅访问照片卷中的视频，因为设备的所有视频都应存储在那里，您应该能够从那里访问它们：[在 OS 3.1 中使用 UIImagePickerController 从 PhotoLibrary 中挑选视频](https://stackoverflow.com/questions/1533180/picking-video-from-photolibrary-with-uiimagepickercontroller-in-os-3-1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-25T00:15:17.960

您需要使用[UIImagePickerController](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIImagePickerController_Class/UIImagePickerController/UIImagePickerController.html)组件，将其配置为在浏览库时仅显示视频。

您可以通过以这种方式设置`mediaTypes`选择器的属性来做到这一点：

```
myImagePickerController.mediaTypes =
   [[NSArray alloc] initWithObjects: (NSString *) kUTTypeMovie, nil]; 
```

然后如果你想在模拟器中测试它，你需要在上面保存一些视频，你可以使用该`UISaveVideoAtPathToSavedPhotosAlbum`功能来实现。查看这个[很棒的答案](https://stackoverflow.com/a/3046699/846273)以获取更详细的说明。

# javascript - 我可以在单击事件上触发多个功能吗？

> ID：14025565
> 
> 赞同：0
> 
> 时间：2012-12-24T20:46:14.403
> 
> 标签：javascript, function, events

我希望在 JavaScript 中的单击事件上触发两个函数。那可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T20:48:13.563

是的，您可以注册多个事件侦听器。

```
 yourElement.addEventListener("click", function1, false); 
 yourElement.addEventListener("click", function2, false); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T20:48:25.590

是的，只需创建一个在单击时调用的函数，该函数调用两个函数。

```
function clickHandlerFunction() {
    function1();
    function2();
} 
```

或者注册多个事件侦听器，以您喜欢的方式为准。它们都适用于不同的情况。

如果您希望能够添加或删除其中一个函数，那么注册为单独的侦听器将允许您稍后删除特定的侦听器。上面的方法将允许您调用所有或不调用任何函数。

# c++ - 样条拟合 - Douglas-Peucker 算法

> ID：14025575
> 
> 赞同：0
> 
> 时间：2012-12-24T20:47:41.583
> 
> 标签：c++, algorithm, haskell, bezier, spline

我计划使用 Douglas-Peucker 算法来减少点（除非有人知道更好的例子）。数据是一维的，正在构建的曲线是二维的

给出一个减少的点我需要一条穿过所有点的样条线（我认为拉格朗日插值可以做到这一点）

主要目标是解决类似 Hermite 曲线的切线手柄，使样条曲线尽可能与原始数据曲线匹配。

有谁知道解决此类问题的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T16:42:59.503

你解决了吗？穿过您的点的样条曲线很容易构建为 Catmull-Rom 样条曲线（映射到贝塞尔曲线，但表示插值的方式不同）。

# c++ - 如何在编译时间或代码初始化时间之前/期间自动更新数组中的条目？

> ID：14025582
> 
> 赞同：4
> 
> 时间：2012-12-24T20:48:28.523
> 
> 标签：c++, c, visual-studio-2012

好吧，我有一个从我的代码运行的抽象虚拟机（“ [PAWN](http://www.compuphase.com/pawn/pawn.htm) ”），脚本可以执行函数，这些函数从 C 代码注册到脚本，由我的 C++ 代码执行。

c++ 代码必须以以下形式提供一个数组

```
{ "name_i_want_the_function_to_have_in_the_script" , function_in_my_cpp_code } 
```

如果函数不在数组中，则无法执行。（因为它不“存在”）

所以这给我们带来了这个：

我的功能如下所示：

```
//Pawn Functions
#define PWNFUNC(a) static cell AMX_NATIVE_CALL a(AMX *amx, cell *params)

namespace PawnFunc
{
    PWNFUNC(GGV)
    {
        return pGameInterface->FindGameVersion();
    }
};//namespace PawnFunc 
```

并且具有脚本功能信息的数组位于另一个文件中，如下所示：

```
AMX_NATIVE_INFO custom_Natives[] =
{
    {   "GetGameVersion", PawnFunc::GGV   },
    {   0,0   }
}; 
```

现在的问题是：

是否可以使该数组自动更新？（在编译时或代码初始化时之前/期间）

至于现在我必须手动添加每个功能。这有时很烦人，更容易出错。

我想改变它，所以我可以这样做：

```
//Pawn Functions
#define PWNFUNC(a,b) ...?...

namespace PawnFunc
{
    PWNFUNC(GGV,GetGameVersion)//{ "GetGameVersion", PawnFunc::GGV }, is now added to "custom_Natives" array
    {
        return pGameInterface->FindGameVersion();
    }
};//namespace PawnFunc 
```

这可能吗？如果是，我怎么能做到这一点？

也许可以循环命名空间？

编辑：这里是一些伪代码：http: [//ideone.com/btG2lx](http://ideone.com/btG2lx)

还有一个注意事项：我可以在运行时完成，但必须在 DLLMain 完成（我的程序是一个 DLL）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T19:22:28.517

`#define`如果您使用 a`std::vector`作为脚本信息的存储，这将完成这项工作。

*（请注意，标准保证您仍会从 中获得 C 样式的数组`&custom_Natives[0]`）*

```
std::vector<AMX_NATIVE_INFO> custom_Natives;

#define PWNFUNC(NAME, FUNC) \
 struct IMPL_ ## FUNC { \
   IMPL_ ## FUNC() { \
     AMX_NATIVE_INFO entry = { NAME, PawnFunc::FUNC }; \
     custom_Natives.push_back( entry ); \
   } \
 } INSTANCE_ ## FUNC; \
 static cell AMX_NATIVE_CALL FUNC(AMX *amx, cell *params) 
```

现在这样的代码将定义函数**并将**脚本条目添加到`custom_Natives`.

```
PWNFUNC("GetGameVersion", GGV)
{
    return pGameInterface->FindGameVersion();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T21:10:16.040

我能想出什么（假设 C 风格的数组和 C 链接函数）：

```
AMX_NATIVE_INFO custom_natives[] =
{
    { "GetGameVersion", TheGGVFunc },
    { 0, 0 }
};

// here a function call named `GetGameVersion` was encountered,
// so let's look it up using a naive linear search
const char *toBeCalled = "GetGameVersion"; // obtain this somehow
void (*fptr)(void) = NULL;
for (int i = 0; i < sizeof(custom_natives) / sizeof(*custom_natives) - 1; i++) {
    const char *name = custom_natives[i].name;
    if (strcmp(toBeCalled, name) == 0) {
        fptr = custom_natives[i].func;
        break;
    }
}

if (fptr != NULL) {
    fptr();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-24T21:19:31.827

你可以近似它；这个想法是使用全局`std::vector`而不是 C 数组，并使用全局对象的构造函数来扩展向量。这样，您的数组将在`main()`开始执行时初始化。因此，`custom_Natives`您将拥有一个数组，而不是一个数组

```
std::vector<MethodArrayElementType> custom_Natives; 
```

向量（替换`MethodArrayElementType`为保存字符串的结构的名称 -> 函数指针映射）。您可以使用`&custom_Natives[0]`.

然后，在您定义的每个函数旁边，添加一个`Registrar`小类来注册该方法：

```
PWNFUNC(GGV) {
    // Your implementation goes here...
}

struct GGV_Registrar {
    GGV_Registrar() {
         MethodArrayElementType e = { "GetGameVersion", GGV };
        custom_Natives.push_back( e );
    };
} GGV_Registrar_instance; 
```

全局`GGV_Registrar_instance`构造函数的构造函数会在被调用之前`main()`被调用，并且会更新`custom_Natives`向量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-19T18:10:04.173

我们做这样的事情，但是我们使用链表而不是使用数组。所以你的例子会变成

```
namespace PawnFunc
{
    PWNFUNC(GGV)
    {
        return pGameInterface->FindGameVersion();
    }
    PawnRegister GGVfunc( "GetGameVersion", GGV );
};//namespace PawnFunc 
```

PawnRegister 的构造函数将所有对象（如 GVVfunc）添加到链表中。当您的脚本引擎想要查找函数时，它会遍历列表而不是扫描数组。我想您可以设置 PawnRegister 以将条目添加到数组中。

# php - Magento 在 php 脚本中使用 final_price

> ID：14025583
> 
> 赞同：1
> 
> 时间：2012-12-24T20:48:33.300
> 
> 标签：php, magento-1.7, magento

关于 Magento 的问题：我需要制作一个 PHP 脚本，在其中获取特定客户群的产品的“final_price”（应用类别和购物车价格规则后的价格），并在计算中使用它来填充特定的属性与结果。

例子：

*   产品“X”的“价格”属性在 Magento 中设置为 100 美元
*   应用客户组“CG”的类别价格规则后，该特定客户组的产品“X”的最终价格为 10 美元
*   接下来，我填充（自行创建的）属性“抓取的价格”=（产品组 CG 的最终价格）*（1.56）=15.60 美元
*   脚本需要对每个产品进行上述计算

我一直在到处搜索如何在 Magento CE 1.7.2 的 PHP 脚本中为特定客户组使用 final_price，但找不到合适的方法。这个想法是通过 cron 每晚调用脚本。

我可以完全访问 Magento、专用（Centos 5、LAMP）服务器和所有数据库。该数据库有 15000 个产品。

有人知道我如何最好地做到这一点吗？

问候，扬

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T23:08:50.320

产品中使用什么来确定客户群是

```
Mage::getSingleton('customer/session')->getCustomerGroupId(); 
```

因此，您要做的是确保在调用目录/产品模型上的 getFinalPrice() 方法之前在客户会话中设置客户组 ID。

# excel - Microsoft Excel 文件是否保存每个更新日期信息？

> ID：14025586
> 
> 赞同：-2
> 
> 时间：2012-12-24T20:48:57.290
> 
> 标签：excel

我需要检查每天更新的 excel 文件。我无法根据excel文件的内容来判断它是否每天更新。

我想知道当文件更新时excel是否会有“保存日志”来保存？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-24T22:45:03.793

默认情况下，Excel 不跟踪保存历史记录。如果您的特定 Excel 电子表格有一个确实会生成日志的 VBA 脚本，那么您将拥有历史记录。否则：运气不好。

如果文件位于经常备份的网络驱动器上，如果 IT 部门允许，您也可以查阅网络驱动器的备份。

验证是否完全遵循该过程的最终替代方法是拥有第二个来源并使用该来源检查部分或全部 excel 文件。但是，如果您有完整的源代码，则不需要 excel……但是部分检查可以给您足够的信心，尤其是当您看到某些值不匹配时，那么您肯定知道该过程并不总是被遵循。

# c++ - QGraphicsScene::itemAt() 中的 qtransform 是什么

> ID：14025588
> 
> 赞同：12
> 
> 时间：2012-12-24T20:49:14.187
> 
> 标签：c++, qt, qgraphicsitem, qgraphicsscene

我创建了一个自定义`QGraphicsItem`. 并覆盖`boundingRect()`and `paint()`。

```
QRectF myTile::boundingRect() const
{
  return QRectF(xPos*10, yPos*10, 10, 10);
}

void myTile::paint(QPainter *painter, const QStyleOptionGraphicsItem *option, QWidget *widget)
{
  QRectF rec = boundingRect();
  int gvi = value * 255;
  QColor gv(gvi, gvi, gvi, 255);
  QBrush brush(gv);
  painter->fillRect(rec, brush);
  painter->drawRect(rec);
} 
```

然后我使用`addItem()`将项目添加到场景中。现在我想通过它的位置从场景中得到它。我找到了`itemAt`功能。但问题是我不知道`const QTransform`&是什么`deviceTransform`。我应该使用什么`QTransform`？

因为我没有在`QGraphicsItem`. 这让我很困惑。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-25T13:55:25.990

```
QGraphicsItem * QGraphicsScene::itemAt ( const QPointF & position, const QTransform & deviceTransform ) const 
```

> 返回指定位置的最顶部可见项目，如果此位置没有项目，则返回 0。`deviceTransform`是应用于视图的转换，如果场景包含忽略转换的项目，则需要提供。这个函数是在 Qt 4.6 中引入的。

所以我想说，如果您需要转换某些项目并忽略其他项目，您可以简单地使用默认值`QTransform()`甚至更好的`QGraphicsView::transform() const`.

苏龙仔

# c++ - 链接时的 waf：“未定义的引用”错误

> ID：14025590
> 
> 赞同：1
> 
> 时间：2012-12-24T20:49:38.100
> 
> 标签：c++, compiler-errors, undefined-reference, waf

因此，在过去的 2 个小时里，我一直在努力解决这个编译器错误，并认为我会在这里发布代码，看看是否有人能解释我的错误。

我已经去掉了所有不相关的部分，留下了一个最小的程序（如下所示），据我所知，它应该可以编译和运行。如果我来了，但我看不到 main 中对 testFunc 的调用有什么问题，那么一切都会编译并运行良好。但是，通过调用 testFunc ，我得到以下信息：

```
$ ./waf -v --run abr-tool
Waf: Entering directory `/home/conor/workspace/msc/AdaptiveIPTV/Software/conor/ns3/ns-3.15/build'
[1665/1822] cxxprogram: build/src/abr-tools/examples/abr-tool.cc.4.o -> build/src/abr-tools/ns3.15-abr-tool-debug
19:04:19 runner ['/usr/bin/g++', '-L/usr/lib', '-lboost_iostreams', '-L/usr/lib', '-lboost_iostreams', '-pthread', 'src/abr-tools/examples/abr-tool.cc.4.o', '-o', '/home/conor/workspace/msc/AdaptiveIPTV/Software/conor/ns3/ns-3.15/build/src/abr-tools/ns3.15-abr-tool-debug', '-Wl,-Bstatic', '-Wl,-Bdynamic', '-Wl,--no-as-needed', '-L.', '-L.', '-L.', '-L.', '-L.', '-L.', '-lns3.15-point-to-point-debug', '-lns3.15-internet-debug', '-lns3.15-mpi-debug', '-lns3.15-bridge-debug', '-lns3.15-network-debug', '-lns3.15-core-debug', '-lrt']
src/abr-tools/examples/abr-tool.cc.4.o: In function `main':
/home/conor/workspace/msc/AdaptiveIPTV/Software/conor/ns3/ns-3.15/build/../src/abr-tools/examples/abr-tool.cc:7: undefined reference to `testFunc()'
collect2: ld returned 1 exit status 
```

正如您所看到的，下面的代码是作为一个更大的项目的一部分构建的，我知道错误可能来自构建过程，而不是我的代码问题，但无论哪种方式，我都遇到了障碍在我对这里发生的事情的理解中。我边走边学 c++，说实话，我觉得自己没有足够的经验，甚至无法自己编译这段代码，并且能够说“那肯定可以工作，但它不行”，这就是为什么我像这样呈现它。

可能相关的另外几点：

*   我可以使用 abr-tools.cc 中 abr-helper.h 中定义的宏，当我将 abr-tools.cc 放在与 abr-helper.h 相同的文件夹中并仅使用 '#include "abr-helper 时，问题仍然存在。H”'。

*   最初的错误是一样的，但是对于 abr-helper.h 中定义并在 abr-tools.cc 中使用的一堆其他东西

我将不胜感激你们可以提供的任何帮助，在此先感谢。

abr-helper.h：

```
#ifndef ABR_HELPER_H
#define ABR_HELPER_H
#include <iostream>

void testFunc();

#endif /* ABR_HELPER_H */ 
```

abr-helper.cc：

```
#include <iostream>
#include "abr-helper.h"

void testFunc(){
        std::cout << "this is all testFunc() does ..." << std::endl;
} 
```

abr-tool.cc:

```
#include <iostream>
#include "ns3/abr-helper.h"

int main (int argc, char *argv[]){

    std::cout << "in main()" << std::endl;
    testFunc();
    return 0;

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-24T20:52:50.817

看来该文件`abr-helper.cc`没有被编译。您可以通过添加

```
#error "Test" 
```

该文件的行。如果构建成功，则该文件没有被编译，您需要添加它。如何做到这一点取决于您的编译器或 IDE。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T20:53:18.137

您需要在编译中包含 abr-helper.cc，否则不会链接到实现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-24T20:55:19.550

我不知道waf，所以我无法给出解决方案。但这是发生的事情：

在编译期间，一切正常。链接期间出现问题（ld 错误）。

在以 : 19:04:19 runner 开头的行上，没有引用 abr-helper.o 或类似的东西。您一定忘记在 waf 配置中的某处添加 abr-helper.cc。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-24T21:31:39.920

除了其他答案（我也没有看到`abr-tool.cc`要编译的文件）之外，还`void testFunc`需要声明该函数`extern`。

# javascript - 如果尺寸太大，Canvas 无法执行填充

> ID：14025593
> 
> 赞同：0
> 
> 时间：2012-12-24T20:50:19.050
> 
> 标签：javascript, html, canvas, fill

在我将 HTML 中的画布设置为特定大小后，例如 800x600，脚本不会为我填充，但如果我将其设置为 150x150，它会。为什么会这样？可以修复吗？任何帮助，将不胜感激。

HTML：

```
<!DOCTYPE html>
<html>
    <head>
        <title>Let's Draw!</title>
        <link rel="stylesheet" type="text/css" href="style.css" />
        <script type="text/javascript" src="script.js"></script>
    </head>
    <body onload="drawShape();">
        <canvas id="my_canvas" width="800" height="600">
            This text is displayed if your browser does not support HTML5 Canvas.
        </canvas>
    </body>
</html> 
```

Javascript：

```
function drawShape(){
    var canvas = document.getElementById('my_canvas');

    if (canvas.getContext){

        var ctx = canvas.getContext('2d');  // ctx = context

        ctx.fillStyle = "red";

        // Filled triangle
        ctx.beginPath();
        ctx.moveTo(25,25);
        ctx.lineTo(105,25);
        ctx.lineTo(25,105);
        ctx.fill();

        // Stroked triangle
        ctx.beginPath();
        ctx.moveTo(125,125);
        ctx.lineTo(125,45);
        ctx.lineTo(45,125);
        ctx.closePath();
        ctx.stroke();

    } else {
        alert('You need Safari or Firefox 1.5+ to see this demo.');
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T08:57:22.227

800x600比较小，应该所有支持canvas的合理浏览器都支持。4 倍大小的画布应该可以工作。您使用的是什么浏览器/操作系统？

# ios - 我需要设置 Core Audio File Player Audio Unit 的 ASBD 吗？

> ID：14025594
> 
> 赞同：0
> 
> 时间：2012-12-24T20:50:35.477
> 
> 标签：ios, core-audio

我已经指定并实例化了两个音频单元：一个多声道混音器单元和一个 AudioFilePlayer 子类型的生成器。

我原以为我需要设置 filePlayer 输出的 ASBD 以匹配我为混音器输入设置的 ASBD。但是，当我尝试设置 filePlayer 的输出时，出现 kAudioUnitErr_FormatNotSupported (-10868) 错误。

这是我在混音器输入上设置的流格式（成功），我也在尝试在 filePlayer 上设置（它是从 Apple 的混音器主机示例项目复制的单流格式）：

```
Sample Rate:              44100
Format ID:                 lpcm
Format Flags:                 C
Bytes per Packet:             2
Frames per Packet:            1
Bytes per Frame:              2
Channels per Frame:           1
Bits per Channel:            16 
```

在对此进行故障排除的过程中，我查询了 filePlayer AU 的“本机”设置格式。这是返回的内容：

```
Sample Rate:              44100
Format ID:                 lpcm
Format Flags:                29
Bytes per Packet:             4
Frames per Packet:            1
Bytes per Frame:              4
Channels per Frame:           2
Bits per Channel:            32 
```

我找到的所有示例代码都将 filePlayer 单元的输出发送到效果单元，并设置 filePlayer 的输出以匹配为效果单元设置的 ASBD。鉴于我没有效果单元，似乎将 filePlayer 的输出设置为混音器输入的 ASBD 将是正确且必需的事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T23:22:13.183

你是如何配置 AUGraph 的？我可能需要查看一些代码来帮助您。

仅设置一次 AUMultiChannelMixer ASBD 的输出范围（如在 MixerHost 中）有效。但是，如果您有任何类型的效果，您将需要考虑它们的 ASBD 是在哪里定义的以及如何安排您的代码，这样 CoreAudio 就不会跳入并弄乱您的效果 AudioUnits ASBD。搞乱我的意思是将您的 ASBD 覆盖为默认的 kAudioFormatFlagIsFloat、kAudioFormatFlagIsPacked、2 个通道、非交错。起初这对我来说是一个很大的痛苦。

我会将效果 AudioUnits 设置为它们的默认 ASBD。假设您已经连接了 AUFilePlayer 节点，那么您可以稍后在程序中将其拉出，如下所示

> ```
> result =  AUGraphNodeInfo (processingGraph,
>                            filePlayerNode,
>                            NULL,
>                            &filePlayerUnit); 
> ```

然后继续设置

> ```
> AudioUnitSetProperty(filePlayerUnit, 
>                      kAudioUnitProperty_StreamFormat, 
>                      kAudioUnitScope_Output,
>                      0,    
>                      &monoStreamFormat, 
>                      sizeof(monoStreamFormat)); 
> ```

希望这会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-22T14:16:12.577

基本上我没有费心设置filePlayer ASBD，而是检索了它设置的“本机”ASBD，只更新了采样率和通道数。

同样，我没有在混音器上设置输入并让混音器确定它的格式。

# joomla - 智能搜索 Joomla One 结果

> ID：14025595
> 
> 赞同：0
> 
> 时间：2012-12-24T20:50:40.627
> 
> 标签：joomla

我刚刚启用了智能搜索插件，一切都很棒！

我只是想知道查询何时有一个结果，我喜欢 Joomla！将用户直接引导到此页面。:(

有人遇到这个问题并解决了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T10:21:53.977

在此文件`components\com_finder\views\search\view.html.php`中，在显示函数中添加以下行。在这条线之后 -`$this->assignRef('pagination', $pagination);`

```
if(count($results)==1){
    $app->redirect($results[0]->path);
} 
```

这是核心文件更改，因此请在必要时进行。

让我知道它是否不起作用。

# pagination - 液体和算术

> ID：14025597
> 
> 赞同：5
> 
> 时间：2012-12-24T20:51:22.643
> 
> 标签：pagination, jekyll, liquid

我正在处理一些分页，我想知道是否有办法告诉液体只显示 5 页。我正在寻找的输出是

<< 前 5 6 **7** 8 9 最后 >>

我目前采用的逻辑有效，但它显示了所有 30 个页面。

```
{% for count in (2..paginator.total_pages) %}
    {% if count == paginator.page %}
        <span class="current">{{ count }}</span>
    {% else %}
        <a href="/page/{{ count }}/" class="pagenavi-page" title="{{ count }}">{{ count }}</a>
    {% endif %}
{% endfor %} 
```

我希望能够使 2 和 paginator.total_pages 成为动态的，我已经尝试过

```
{% for count in ((paginator.page - 2)..(paginator.page + 2)) %} 
```

然而，这段代码实际上并没有做数学运算，如果 paginator.page = 5 那么循环是 5..5 并且不提供预期的结果。我可以弄清楚逻辑，使其不会达到负数并按预期工作，但是我该如何做数学方程式呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-25T17:23:13.760

您需要使用过滤器`paginator.total_pages`来进行算术运算，然后使用`capture`标签将结果捕获到变量中。一旦有了开始页和结束页，就可以`for`像往常一样编写循环：

```
{% capture page_start %}{{ paginator.page | minus: 2 }}{% endcapture %}
{% capture page_end %}{{ paginator.page | plus: 2 }}{% endcapture %}

{% for count in (page_start..page_end) %}
     {% comment %} ... do your thing ... {% endcomment %}
{% endfor %} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-14T13:39:26.513

我正在用 Jekyll 建立一个博客，我也遇到过类似的情况。根据我在[Liquid wiki](https://github.com/Shopify/liquid/wiki/Liquid-for-Designers#for-loops)`limit`中发现的内容，可以使用and遍历给定集合的子集`offset`。

以下示例反映了您的特定情况，并且*应该*在从第一页到最后一页的每一页中都能正常工作：

```
{% capture start %}{{ paginator.page | minus: 3 }}{% endcapture %}

{% for i in (1..paginator.total_pages) limit: 5 offset: start %}
    ...
{% endfor %} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-14T18:15:35.187

我正在为我的网站使用 Bootstrap 3.0.3。我使用以下代码进行分页。它具有您正在寻找的相同效果。我在上面发布的代码是您正在寻找的，但无论如何我都会在这里发布我的引导分页代码。

```
{% if paginator.total_pages != 1 %} 
{% if paginator.total_pages < 7 %}
        <div class="page-body col-md-12">
          <ul class="pagination pagination-centered">
            {% if paginator.total_pages >= 10 %} 
            {% if paginator.previous_page %}
                <li>
                  <a href="{{ site.url }}/">&laquo;&laquo;</a>
                </li>
            {% else %}
              <li class="disabled">
                <a>&laquo;&laquo;</a>
              </li>
            {% endif %}
            {% endif %}
            {% if paginator.previous_page %}
              {% if paginator.previous_page == 1 %}
                <li>
                  <a href="{{ site.url }}/">&laquo;</a>
                </li>
              {% else %}
                <li>
                  <a href="{{ site.url }}/page{{paginator.previous_page}}">&laquo;</a>
                </li>
              {% endif %}
            {% else %}
              <li class="disabled">
                <a>&laquo;</a>
              </li>
            {% endif %}
            {% if paginator.page == 1 %}
              <li class="active">
                <a>1</a>
              </li>
            {% else %}
              <li>
                <a href="{{ site.url }}/">1</a>
              </li>
            {% endif %}
            {% for count in (2..paginator.total_pages) %}
              {% if count == paginator.page %}
                <li class="active">
                  <a>{{count}}</a>
                </li>
              {% else %}
                <li>
                  <a href="{{ site.url }}/page{{count}}">{{count}}</a>
                </li>
              {% endif %}
            {% endfor %}
            {% if paginator.next_page %}
              <li>
                <a href="{{ site.url }}/page{{paginator.next_page}}">&raquo;</a>
              </li>
            {% else %}
              <li class="disabled">
                <a>&raquo;</a>
              </li>
            {% endif %}
            {% if paginator.total_pages >= 10 %} 
            {% if paginator.next_page %}
              <li>
                <a href="{{ site.url }}/page{{paginator.total_pages}}">&raquo;&raquo;</a>
              </li>
            {% else %}
              <li class="disabled">
                <a>&raquo;&raquo;</a>
              </li>
            {% endif %}
            {% endif %}
          </ul>
        </div>
{% else %}

{% assign page_start = paginator.page | minus: 2 %}
{% assign page_end = paginator.page | plus: 2 %}
{% if page_end > paginator.total_pages %}
{% assign page_end = paginator.total_pages %}
{% assign page_start = paginator.page | minus: 4 %}
{% endif %}
{% if page_start < 2 %}
{% assign page_end = paginator.page | plus: 3 %}
{% assign page_start = paginator.page | minus: 1 %}
{% endif %}
{% if page_start == 0 %}
{% assign page_end = paginator.page | plus: 4 %}
{% assign page_start = paginator.page %}
{% endif %}

<div class="page-body col-md-12">
    <ul class="pagination pagination-centered">
    {% if paginator.total_pages > 5 %} 
    {% if paginator.previous_page %}
        <li>
          <a href="{{ site.url }}/">&laquo;&laquo;</a>
        </li>
    {% else %}
      <li class="disabled">
        <a>&laquo;&laquo;</a>
      </li>
    {% endif %}
    {% endif %}
    {% if paginator.previous_page %}
      {% if paginator.previous_page == 1 %}
        <li>
          <a href="/">&laquo;</a>
        </li>
      {% else %}
        <li>
          <a href="/page{{paginator.previous_page}}">&laquo;</a>
        </li>
      {% endif %}
    {% else %}
      <li class="disabled">
        <a href="#">&laquo;</a>
      </li>
    {% endif %}
    {% if page_start == 1 %}
    {% assign page_end = paginator.page | plus: 4 %}
    {% assign page_start = 2 %}
    {% if paginator.page == 1 %}
      <li class="active">
        <a href="#">1</a>
      </li>
    {% else %}
      <li>
        <a href="/">1</a>
      </li>
    {% endif %}
    {% endif %}
    {% for count in (page_start..page_end) %}
      {% if count == paginator.page %}
        <li class="active">
          <a href="#">{{count}}</a>
        </li>
      {% else %}
        <li>
          <a href="/page{{count}}">{{count}}</a>
        </li>
      {% endif %}
    {% endfor %}
    {% if paginator.next_page %}
      <li>
        <a href="/page{{paginator.next_page}}">&raquo;</a>
      </li>
    {% else %}
      <li class="disabled">
        <a href="#">&raquo;</a>
      </li>
    {% endif %}
    {% if paginator.total_pages > 5 %} 
    {% if paginator.next_page %}
      <li>
        <a href="{{ site.url }}/page{{paginator.total_pages}}">&raquo;&raquo;</a>
      </li>
    {% else %}
      <li class="disabled">
        <a>&raquo;&raquo;</a>
      </li>
    {% endif %}
    {% endif %}
  </ul>
</div>
{% endif %}
{% endif %} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-14T18:02:08.243

试试这个

```
{% if paginator.total_pages < 7 %}
{% if paginator.page == 1 %}
        <span class="current bold">1</span>
{% else %}
        <a href="{{ site.url }}/">1</a>
{% endif %}
{% for count in (2..paginator.total_pages) %}
    {% if count == paginator.page %}
        <span class="current bold">{{ count }}</span>
    {% else %}
        <a href="/page{{ count }}/" class="pagenavi-page" title="{{ count }}">{{ count }}</a>
    {% endif %}
{% endfor %}
{% else %}
{% assign page_start = paginator.page | minus: 2 %}
{% assign page_end = paginator.page | plus: 2 %}
{% if page_end > paginator.total_pages %}
{% assign page_end = paginator.total_pages %}
{% assign page_start = paginator.page | minus: 4 %}
{% endif %}
{% if page_start < 2 %}
{% assign page_end = paginator.page | plus: 3 %}
{% assign page_start = paginator.page | minus: 1 %}
{% endif %}
{% if page_start == 0 %}
{% assign page_end = paginator.page | plus: 4 %}
{% assign page_start = paginator.page %}
{% endif %}
{% if page_start == 1 %}
{% assign page_end = paginator.page | plus: 4 %}
{% assign page_start = 2 %}
{% if paginator.page == 1 %}
        <span class="current bold">1</span>
{% else %}
        <a href="{{ site.url }}/">1</a>
{% endif %}
{% endif %}
{% for count in (page_start..page_end) %}
    {% if count == paginator.page %}
        <span class="current bold">{{ count }}</span>
    {% else %}
        <a href="/page{{ count }}/" class="pagenavi-page" title="{{ count }}">{{ count }}</a>
    {% endif %}
{% endfor %} 
{% endif %} 
```

# iphone - UICollectionViewCell 摇一摇

> ID：14025600
> 
> 赞同：28
> 
> 时间：2012-12-24T20:51:51.537
> 
> 标签：iphone, ios, ios6, uicollectionview

我创建了一个 UICollectionView 并希望所有单元格都像 iPhone 上跳板的编辑模式一样抖动。我已经创建了我的抖动代码，但不知道如何实现它。我有自定义单元格，所以我假设它在那里，但不知道它是如何实现的。谢谢你。

```
#define degreesToRadians(x) (M_PI * (x) / 180.0)
#define kAnimationRotateDeg 0.5
#define kAnimationTranslateX 1.0
#define kAnimationTranslateY 1.0

//startJiggling

int count = 1;
CGAffineTransform leftWobble = CGAffineTransformMakeRotation(degreesToRadians( kAnimationRotateDeg * (count%2 ? +1 : -1 ) ));
CGAffineTransform rightWobble = CGAffineTransformMakeRotation(degreesToRadians( kAnimationRotateDeg * (count%2 ? -1 : +1 ) ));
CGAffineTransform moveTransform = CGAffineTransformTranslate(rightWobble, -kAnimationTranslateX, -kAnimationTranslateY);
CGAffineTransform conCatTransform = CGAffineTransformConcat(rightWobble, moveTransform);

    self.transform = leftWobble;  // starting point

    [UIView animateWithDuration:0.1
                          delay:(count * 0.08)
                        options:UIViewAnimationOptionAllowUserInteraction | UIViewAnimationOptionRepeat | UIViewAnimationOptionAutoreverse
                     animations:^{ self.transform = conCatTransform; }
                     completion:nil]; 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-24T22:43:34.263

如果您将代码放在`startJiggling`自定义单元格中调用的方法中，则可以在控制器中调用此方法：

`[self.collectionView.visibleCells makeObjectsPerformSelector:@selector(startJiggling)];`

这确保了所有可见的单元格都将开始抖动。

然后我还会设置一些标志，指示您的单元格应该在`collectionView:cellForItemAtIndexPath:`. 如果是，则调用您的方法。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2019-05-30T14:58:35.080

**Swift 5** Easy 像这样

将这 2 个函数输入到您的 UICollectionViewCell 并在您想要动画/停止时调用它，例如：单元格渲染

```
func shake() {
    let shakeAnimation = CABasicAnimation(keyPath: "transform.rotation")
    shakeAnimation.duration = 0.05
    shakeAnimation.repeatCount = 2
    shakeAnimation.autoreverses = true
    let startAngle: Float = (-2) * 3.14159/180
    let stopAngle = -startAngle
    shakeAnimation.fromValue = NSNumber(value: startAngle as Float)
    shakeAnimation.toValue = NSNumber(value: 3 * stopAngle as Float)
    shakeAnimation.autoreverses = true
    shakeAnimation.duration = 0.15
    shakeAnimation.repeatCount = 10000
    shakeAnimation.timeOffset = 290 * drand48()

    let layer: CALayer = self.layer
    layer.add(shakeAnimation, forKey:"shaking")
}

func stopShaking() {
    let layer: CALayer = self.layer
    layer.removeAnimation(forKey: "shaking")
} 
```

[来自 Git 的帮助源](https://gist.github.com/vlchapaev/18443e73e6a087210b4e12f5cf6ea6a5)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-11-05T21:54:59.457

如果有人对如何在 Swift 2.0 中做到这一点感到好奇，那么下面应该是一个很好的起点。

```
let animationRotateDegres: CGFloat = 0.5
let animationTranslateX: CGFloat = 1.0
let animationTranslateY: CGFloat = 1.0
let count: Int = 1

func wobble() {
    let leftOrRight: CGFloat = (count % 2 == 0 ? 1 : -1)
    let rightOrLeft: CGFloat = (count % 2 == 0 ? -1 : 1)
    let leftWobble: CGAffineTransform = CGAffineTransformMakeRotation(degreesToRadians(animationRotateDegres * leftOrRight))
    let rightWobble: CGAffineTransform = CGAffineTransformMakeRotation(degreesToRadians(animationRotateDegres * rightOrLeft))
    let moveTransform: CGAffineTransform = CGAffineTransformTranslate(leftWobble, -animationTranslateX, -animationTranslateY)
    let conCatTransform: CGAffineTransform = CGAffineTransformConcat(leftWobble, moveTransform)

    transform = rightWobble // starting point

    UIView.animateWithDuration(0.1, delay: 0.08, options: [.AllowUserInteraction, .Repeat, .Autoreverse], animations: { () -> Void in
        self.transform = conCatTransform
        }, completion: nil)
}

func degreesToRadians(x: CGFloat) -> CGFloat {
    return CGFloat(M_PI) * x / 180.0
} 
```

当我想让我的细胞摇晃时，我会这样做：

```
for cell in collectionView.visibleCells() {
        let customCell: MyCustomCell = cell as! MyCustomCell
        customCell.wobble()
    } 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-02-17T22:43:27.043

**更新为 swift 3 语法：**

```
let animationRotateDegres: CGFloat = 0.5
let animationTranslateX: CGFloat = 1.0
let animationTranslateY: CGFloat = 1.0
let count: Int = 1

func wobble() {
    let leftOrRight: CGFloat = (count % 2 == 0 ? 1 : -1)
    let rightOrLeft: CGFloat = (count % 2 == 0 ? -1 : 1)
    let leftWobble: CGAffineTransform = CGAffineTransform(rotationAngle: degreesToRadians(x: animationRotateDegres * leftOrRight))
    let rightWobble: CGAffineTransform = CGAffineTransform(rotationAngle: degreesToRadians(x: animationRotateDegres * rightOrLeft))
    let moveTransform: CGAffineTransform = leftWobble.translatedBy(x: -animationTranslateX, y: -animationTranslateY)
    let conCatTransform: CGAffineTransform = leftWobble.concatenating(moveTransform)

    transform = rightWobble // starting point

    UIView.animate(withDuration: 0.1, delay: 0.08, options: [.allowUserInteraction, .autoreverse], animations: { () -> Void in
        self.transform = conCatTransform
    }, completion: nil)
}

func degreesToRadians(x: CGFloat) -> CGFloat {
    return CGFloat(M_PI) * x / 180.0
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-03-16T07:37:53.763

将这行代码放在两个地方：

```
[self.collectionView.visibleCells makeObjectsPerformSelector:@selector(startJiggling)]; 
```

1.  `-(void)collectionView:(UICollectionView *)collectionView didEndDisplayingCell:(UICollectionViewCell *)cell forItemAtIndexPath:(NSIndexPath *)indexPath`

2.  `-(void)scrollViewDidEndScrollingAnimation:(UIScrollView *)scrollView`

# java - 为什么不是所有方法都显示在 VisualVM 分析器中？

> ID：14025602
> 
> 赞同：9
> 
> 时间：2012-12-24T20:52:02.363
> 
> 标签：java, real-time, visualvm

我`VisualVM`用来查看我的应用程序在哪里运行缓慢。但它没有显示所有方法，可能没有显示延迟应用程序的所有方法。

我有一个实时应用程序（声音处理）并且在几百微秒内有时间不足。

是否有可能`VisualVM`隐藏本身快速的方法？

**更新 1**

我通过采样器和猜测找到了缓慢的方法。这是`toString()`从调试日志中调用的方法，该方法已关闭，但耗时。

`Settings`帮助，现在我知道如何看待它：这取决于`Start profiling from`选项。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-24T21:12:10.013

除了 Ryan Stewart 提到的过滤器之外，还有一些其他原因导致方法可能不会出现在分析器中：

*   采样配置文件本质上是*随机的：*每 N ms 对所有线程的当前堆栈进行一次采样。一些实际执行但在运行期间未在任何示例中捕获的方法将不会出现。这通常不会有太大问题，因为它们没有出现在任何样本中，这意味着这些方法很有可能不会占用您运行时的大部分时间。
*   在 visualvm 中使用基于检测的采样（称为“CPU 分析”）时，您需要定义分析方法的入口点（“开始分析从”选项）。我发现默认包中的方法会失败，并且在附加分析器时也不会在当前正在运行的方法中获取时间（在当前调用期间 - 它将获得以后的调用。这可能是因为在当前调用完成之前，不会交换检测方法。
*   采样受到基于堆栈跟踪的分析的潜在严重问题的影响，即仅在代码中的安全点进行采样。当请求跟踪时，每个线程都被强制到一个安全点，然后获取堆栈。在某些情况下，您的代码中可能存在不进行安全点轮询的热点（常见于简单循环，JIT 可以保证在固定次数的迭代后终止），并与一些确实具有安全点轮询的代码交错。您的堆栈将始终在安全点代码中显示您的进程，而不是在安全点免费代码中，即使后者可能占用大部分 CPU 时间。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-24T21:00:27.143

我现在没有它，但在你开始分析之前，有一个默认隐藏的设置窗格，允许你输入正则表达式来过滤掉方法。默认情况下，它会过滤掉很多核心的 JDK 内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-08T10:47:09.117

我的宠物项目也有同样的问题。我添加了一个`package`名字，问题就解决了。我不明白为什么。`VisualVM 1.4.1`,`jdk1.8.0_181`和`jdk-10.0.2`,`Windows 10`

# cakephp - php cake inflection.php - 为什么“cookie”在未变形词列表中？

> ID：14025603
> 
> 赞同：2
> 
> 时间：2012-12-24T20:52:12.687
> 
> 标签：cakephp

简单的问题 - 在 CAKE php 框架中 - 在 inflection.php（类屈折）

为什么术语列表中的“cookie”不适用复数形式？

```
uninflected' => array('.*[nrlm]ese', '.*deer', '.*fish', '.*measles', '.*ois', '.*pox', '.*sheep', 'people', 'cookie') 
```

我得到了所有其余的但“cookie”没有意义。例如复数是cookies。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T23:19:03.343

它可能错误地出现在该列表中。cookie/cookies 部分也可以在它实际所属的位置找到：在不规则单词部分。

但是这个词的变形仍然有效。你可以复数和单数 Cookie/Cookies 就好了（我使用当前的 2.3 头确认了它）。

我做了一个 PR（当然，你也可以这样做）来解决这个问题：[https ://github.com/cakephp/cakephp/pull/1048](https://github.com/cakephp/cakephp/pull/1048)

# php - php在2个变量中拆分字符串

> ID：14025604
> 
> 赞同：1
> 
> 时间：2012-12-24T20:52:16.357
> 
> 标签：php, regex

我是编程新手，我正在尝试构建一个供个人使用的小 php 价格比较脚本。我已经设法解析了一个网上商店的网站（使用简单的 dom 解析器），并获得了一个（某种）清理过的字符串，其中包含一个层级和一个价格。

我正在使用的字符串现在的格式如下：

```
" 50  27,00 "  //50 pieces of a product cost €27,00 (without the ""s)
"1000  26,60 " //1000 pieces of a product cost €26,60 
```

我想将字符串的第一部分抓取到 $tier，并将第二部分（包括逗号）抓取到字符串 $price。

你能帮我怎么做吗？有时，字符串开头的空格会有所不同（参见上面的示例。中间总是有 2 个空格。

如果我能像这样得到它（没有空格），数组也会很好：

```
$pricearray = array(50, "27,00"); //string to number will be my next problem to solve, first things first 
```

我想我必须使用 preg_split，但现在不要使用表达式。

谢谢你和我一起思考。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-24T20:56:54.320

最简单的方法是调用[explode](http://php.net/manual/en/function.explode.php)函数：

```
$string = '1000 26,60';
$pricearray = explode(' ', $string); 
```

但首先，你必须去掉所有不必要的空格：

```
$string = trim($string); // remove spaces at the beginning and at the end
$string = preg_replace('/\s+/', ' ', $string); // replace 1+ spaces with 1 space 
```

* * *

空间置换法取自[这个问题](https://stackoverflow.com/questions/2326125/remove-multiple-whitespaces-in-php)。谢谢，瘾君子！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T21:16:49.237

好吧，正则表达式引擎很难理解，但它们可以轻松地处理这些可选空间。

看看我在正则表达式模式中是否犯了错误：

```
$yourarray = array();
//just extract the pattern you want
preg_match( '/([0-9]+) + ([0-9]+,[0-9]+)/', " 50  27,00 ", $yourarray );
var_dump( $yourarray );
preg_match( '/([0-9]+) + ([0-9]+,[0-9]+)/', "1000  26,60 ", $yourarray );
var_dump( $yourarray );

// validate and extract the pattern you want
if ( !preg_match_all( '/^ *([0-9]+) +([0-9]+,[0-9]+) *$/', " 50  27,00 ", $yourarray ) )
  print "error";
else
  var_dump( $yourarray );
if ( !preg_match_all( '/^ *([0-9]+) + ([0-9]+,[0-9]+) *$/', "1000  26,60 ", $yourarray ) )
  print "error";
else
  var_dump( $yourarray );
if ( !preg_match_all( '/^ *([0-9]+) + ([0-9]+,[0-9]+) *$/', "1000 26 ", $yourarray ) )
  print "error";
else
  var_dump( $yourarray ); 
```

# php - WordPress php 小部件

> ID：14025607
> 
> 赞同：0
> 
> 时间：2012-12-24T20:52:47.847
> 
> 标签：php, wordpress, widget

我正在使用[wordpress php 小部件](http://wordpress.org/extend/plugins/php-code-widget/)，但我无法处理 Wordpress 简码 - php 只是呈现简码而不是处理它。这是我所做的

1.  在我的活动主题 function.php 文件中添加了过滤器

    ```
    add_filter('widget_text', 'shortcode_unautop');
    add_filter('widget_text', 'do_shortcode');

    // Allow shortcodes in php code widget
    add_filter('widget_execphp', 'shortcode_unautop');
    add_filter('widget_execphp', 'do_shortcode'); 
    ```

2.  将以下内容添加到 php 小部件

    ```
    <?php
    $id = get_the_ID();
    $amazon_product_asin_value = get_post_meta($id, 'amazon_product_asin', true);
      echo do_shortcode('<div> [amazon asin=' . $amazon_product_asin_value . '&template=buynowamazon_widget&chan=default] </div>');
    ?> 
    ```

我也试过没有 do_shortcode 和相同的结果。

2 正确输出的简码

```
[amazon asin=B008I20FT8&template=buynowamazon_widget&chan=default] 
```

如果我只是在标准文本小部件中输入它就可以了

我正在使用生成简码的 Amazon Link 插件

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-25T01:22:02.700

The asin parameter value might be confusing the shortcode processor; try putting quotes around it.

```
echo do_shortcode('<div> [amazon asin="' . $amazon_product_asin_value . '&template=buynowamazon_widget&chan=default"] </div>'); 
```

Alternatively, does the shortcode accept each argument to that parameter as a separate parameter?

```
echo do_shortcode('<div> [amazon asin="' . $amazon_product_asin_value . '" template="buynowamazon_widget" chan="default"] </div>'); 
```

Edit: Looking at the plugin's code, I don't think you need these lines:

```
add_filter('widget_execphp', 'shortcode_unautop');
add_filter('widget_execphp', 'do_shortcode'); 
```

They will try to process the shortcode, before the PHP is executed, and thus you won't get the shortcode correctly processed. Comment them out and see what the plugin does now.

# javascript - 选择选定选项卡内的元素以填充内容

> ID：14025610
> 
> 赞同：0
> 
> 时间：2012-12-24T20:53:12.343
> 
> 标签：javascript, jquery, jquery-ui, jquery-tabs

我有一个动态 jQuery 函数，我在其中动态添加 jquery 选项卡。它产生如下 HTML

```
<div id="chattabs" class="ui-tabs ui-widget ui-widget-content ui-corner-all">
    <ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">
        <li class="ui-state-default ui-corner-top" id="some_7"><a href="#ui-tabs-2"><span>Tsefolasha Sefolasha</span></a></li>
        <li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active" id="some_9"><a href="#ui-tabs-4"><span>Emaynor Maynor</span></a></li>
    </ul>
    <div id="ui-tabs-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide">
        <ul id="messagelist_7">
        </ul>
    </div>
    <div id="ui-tabs-4" class="ui-tabs-panel ui-widget-content ui-corner-bottom">
        <ul id="messagelist_9">
        </ul>
    </div>
    <input type="text" value=" " id="msg">
    <input type="button" value="send" id="send">
    <div id="ui-tabs-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom"></div>
    <div id="ui-tabs-3" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"></div>
</div> 
```

现在，当用户单击底部的发送按钮时，我需要向每个选项卡添加内容。就像是

```
$('#message_9').append('<li>' + message + '</li>'); 
```

我怎样才能做到这一点？

另外，我怎样才能从`chattabs`div 之外获取这个 id？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T21:18:22.960

您可以在初始化选项卡时使用激活事件。

```
$( "#chattabs" ).tabs({
    activate: function( event, ui ) {

        //Append something to the active tab
        ui.newPanel.append();

        //Get the active tab`s nested ul
        var ul = ui.newPanel.find('ul');

        //Get the id of the active tab's nested ul
        var ul_id = ul.attr('id');

    }
}); 
```

# c++ - getnameinfo 内存泄漏是否得到确认？

> ID：14025613
> 
> 赞同：12
> 
> 时间：2012-12-24T20:53:17.873
> 
> 标签：c++, c, memory-leaks, network-programming

根据问题，我遇到了一些由*getnameinfo*泄漏的内存。我正在使用带有 gcc*版本 4.6.3*的 Ubuntu 12.04（Linux scv 3.2.0-35-generic #55-Ubuntu SMP Wed Dec 5 17:42:16 UTC 2012 x86_64 x86_64 x86_64 GNU/Linux） 。
我正在将我的服务器可执行文件与*g++*链接，到目前为止 valgrind 还没有报告问题。然后，我添加了一个对*getnameinfo*的简单调用，以打印出连接客户端的网络名称和端口。
我得到以下信息：

```
==4425==
==4425== 堆摘要：
==4425== 在退出时使用：1 个块中的 10 个字节
==4425== 总堆使用量：4,508 分配，4,507 释放，134,939,153 字节分配
==4425==
==4425== 1 个块中的 10 个字节肯定丢失在丢失记录 1 of 1
==4425== 在 0x4C2B6CD：malloc（在 /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so 中）
==4425== 由 0x50D7D71: strdup (strdup.c:43)
==4425== 由 0x1484B861: ???
==4425== 0x515B871：gethostbyaddr_r@@GLIBC_2.2.5 (getXXbyYY_r.c:256)
==4425== 由 0x5161D06：getnameinfo (getnameinfo.c:223)
==4425== 由 0x404175: solsrv_run (solsrv.c:381)
==4425== by 0x404DAC: main (main.c:167)
==4425==
==4425== 泄漏摘要：
==4425== 肯定丢失：1 个块中的 10 个字节
==4425== 间接丢失：0 个块中的 0 个字节
==4425== 可能丢失：0 个块中的 0 个字节
==4425== 仍然可达：0 个块中的 0 个字节
==4425== 抑制：0 个块中的 0 个字节
==4425==
==4425== 对于检测到和抑制的错误计数，重新运行：-v
==4425== 错误摘要：来自 11 个上下文的 12 个错误（抑制：2 个来自 2）

```

我究竟做错了什么？
代码简单如下：

```
struct sockaddr addr;
socklen_t           addr_sz = sizeof(addr);
char        host[NI_MAXHOST],
            serv[NI_MAXSERV];
int infd = accept(srv_fd, (struct sockaddr*)&addr, &addr_sz);
if (infd == -1) {
    ... manage error on accept ...
}
if(getnameinfo((struct sockaddr *)&addr, addr_sz, host, NI_MAXHOST, serv, NI_MAXSERV, NI_NUMERICSERV)) {
    strncpy(host, "<unknown host>", NI_MAXHOST-1);
    strncpy(serv, "<unknown port>", NI_MAXSERV-1);
} 
```

你有泄漏......
我可以确认，泄漏正在**发生**：对于 6 个连接的客户端， *valgrind*发现 60 个字节泄漏（我猜客户端是从同一个主机连接的，所以如果它与主机名有关，增长是线性的正如预期的那样）。
任何的想法？

干杯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T10:34:29.673

终于找到了*真正的*漏洞。

连接到服务器套接字时，使用`name.local`而不是`localhost`和/或完全限定名称。
`getnameinfo()`然后会泄漏。

我可以在*x64*和*x86*`12.04`上重现该错误。 如果我连接指定它会泄漏的名称。`12.10` **`.local`**

 **干杯**

# visual-studio-2010 - ReSharper，dotCover 2.2 + xUnit

> ID：14025614
> 
> 赞同：1
> 
> 时间：2012-12-24T20:53:21.953
> 
> 标签：visual-studio-2010, resharper, xunit, dotcover

我正在尝试在 xunit 单元测试上运行 dotCover。无论我尝试涵盖哪个测试，它们都给了我相同的结果：

```
Inconclusive: Test wasn't run 
```

所以无论如何，dotCover 都找不到我的任何测试的覆盖范围。

我正在使用 ReSharper 的单元测试运行器，并且能够在`Unit Test Sessions`窗口内的 VS 中运行单元测试，因此我的所有单元测试都运行成功。

当我尝试覆盖单元测试时（我尝试使用测试左侧的图标、`Unit Test Sessions`窗口中的全部测试按钮、右键单击单元测试并`Cover Unit Tests`在同一个窗口中说），我总是得到同样的信息：`Inconclusive: Test wasn't run`。

我的设置：

*   视觉工作室 2010
*   ReSharper 7.1
*   dotCover 2.2
*   xunit 1.9.1.1600

我也设置了两者（http://xunitcontrib.codeplex.com/）

*   xunitcontrib-resharper 0.7（RS 7.1、6.1.1）
*   xunitcontrib-dotcover 0.7 (dotCover 2.0 - 2.2)

这样我应该能够在 VS 中使用 xunit 测试运行器。

任何有助于使代码覆盖率工作的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T13:58:03.747

“Inconclusive Test”意味着测试执行被安排在任务运行器中，但没有得到任何响应。这可能是 xUnitContrib 本身的问题。我可以要求您提供 dotCover 日志以检查是否真的使用 xUnit 插件从 UTR 调用了 dotCover？

# java - 根据条件将十六进制文件拆分为另一个文件

> ID：14025618
> 
> 赞同：0
> 
> 时间：2012-12-24T20:54:58.720
> 
> 标签：java, io, hex

我有一个十六进制文件，其值如下

> f0 01 05 00 00 00 00 00 00 3d 61 c1 c1 df 40 02 00 c0 00 00 09 18 16 00 ef 01 40 00 00 3f 20 f0 01 03 00 00 00 00 00 00 c7 a2 c1 c1 010 4 00 09 18 16 00 ef 01 40 00 00 3f 20 f0 01 02 00 00 00 00 00 00 50 e4 c1 c1 df 40 02 00 c0 02 00 09 79 09 04 c7 01 e1 4e 02 3f 00 f0 0 0 0 0 0 00 00 00 d9 25 c2 c1 df 40 02 00 c0 03 00 09 02 19 25 3c 00 22 6a 01 db 09 f0 04 05 00 00 00 00 00 00 62 67 c2 c1 df 40 02 00 c0 19 04 00 3c 09 02 22 6a 01 db 09 f0 01 07 00 00 00 00 00 ec a8 c2 c1 df 40 02 00 c0 05 00 13 7b 06 04 a4 0d 91 0c b6 c4 4e 02 3f 00 01 00 00 00 00 8 00 0 0 0 00 00 00 00 00 6b 13 c3 c1 df 40 02 00 c0 06 00 13 7b 2b 04 93 0d 43 13 b6 c4 2e 00 3f 00 01 00 00 00 00 00 00 f0 01 09 00 00 00 07 0 0 00 00 07 0 00 00 00 00 00 00 00 00 07 0 0 00 07 0 00 00 00 00 df 40 02 00 c0 07 00 13 7b 4f 04 d6 0d 2e fc b5 c4 2e 00 3f 00 01 00 00 00 00 00 00 f0 01 05 00 00 00 00 0000 68 e8 c3 c1 df 40 02 00 c0 08 00 13 7b 55 04 ca 0d 7b 10 b6 c4 29 00 3f 00 01 00 00 00 00 00 00 f0 01 06 00 00 00 00 00 df 00 e7 52 0 c4 c1 c0 09 00 13 7b 46 04 f1 0d c5 15 b6 c4 2e 00 3f 00 01 00 00 00 00 00 00

我希望每当我找到`f0`后跟复制这些模式以及`01`之后`01`的任何内容直到下一个`f0`等等，直到我拥有具有这些序列的所有模式并将其保存在文件中

并且每当我找到`f0`后跟复制这些模式以及`01`之后`02`的任何内容直到下一个`f0`等等，直到我拥有具有这些序列的所有模式并将其保存在另一个文件中

依此类推，`f0` `01` `03`直到`f0` `01` `09`

这是我试图做的

```
String filename = "C:\\tm09888.123";
FileInputStream in = null;
int readHexFile = 0; 
char hexToChar = ' ';
String[] bytes = new String[10];

try
{            
    in = new FileInputStream(filename); 

    while((readHexFile = in.read()) != -1)
    {       
        if (Integer.toHexString(readHexFile).equals("f0"))
        {
            System.out.print("\n\n\n");
        }
        System.out.print(Integer.toHexString(readHexFile) + " ");
    }
}
catch (IOException ex)
{
    Logger.getLogger(NARSSTest.class.getName()).log(Level.SEVERE, null, ex);
} 
```

}

我拆分了所有模式，但我怎么能告诉程序要`f0`照顾`f0``01` `01`

然后将所有这些模式保存在另一个文件中

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T21:18:26.787

我建议你研究[正则表达式](http://docs.oracle.com/javase/tutorial/essential/regex/)。它们是一种在数据中搜索模式的强大方法，因此它们非常适合您在此处尝试完成的任务。您可以使用它们在文件中搜索“ `f0 0\d 0\d`”并获取所有值，但不包括下一个“ `f0 0\d 0\d`”块。

# haskell - 从 Haskell 中的 intMap 中获取随机值

> ID：14025619
> 
> 赞同：1
> 
> 时间：2012-12-24T20:55:09.417
> 
> 标签：haskell, random

我在编写一个模拟掷骰子的函数时遇到了一些麻烦。所述骰子有6面，上面有1-5和W。1 值 1 分，2 值 2 分，以此类推。但是W值5分。我做了一个数据类型 Side，有一个 Char 值和一个 Int 点。我生成了一个 intMap 来保存所有六个面，然后我使用一个函数 rollDice，它应该返回一个随机面。

像这样：

```
module Dice where

import qualified Data.IntMap as IM
import System.Random

data Side = Side {
            value :: Char, 
            points :: Int
            } deriving Show

data Dice = Dice (IM.IntMap (Side))

dice = Dice $ IM.fromList[(0,Side '1' 1),(1,Side '2' 2),
                                        (2 ,Side '3' 3),(3,Side '4' 4),
                                        (4,Side '5' 5),(5,Side 'W' 5)]

throwDice :: Dice -> Side
throwDice (Dice (intMap)) = intMap IM.!(randomRIO (1,6 :: Int)) 
```

在尝试加载时返回以下错误：

```
Dice.hs:22:41:
    Couldn't match expected type `IM.Key' with actual type `IO a0'
    In the return type of a call of `randomRIO'
    In the second argument of `(IM.!)', namely
      `(randomRIO (1, 6 :: Int))'
    In the expression: intMap IM.! (randomRIO (1, 6 :: Int)) 
```

我在某处读到你应该只在 IO monad 中使用 RandomRIO，但我需要将抛出的一面附加到一个列表中，然后显示该列表中边的所有值，我完全不知道如何转换将 RandomRIO 函数的输出转换为可用格式。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T21:28:11.710

`randomRIO`有 type `Random a => (a, a) -> IO a`，表示结果值被困到 IO monad。IO monad 不能被转义，所以如果你想使用随机值，你的函数也必须返回一个 IO 绑定类型的值（如果相同的输入不产生相同的输出，函数就不能是纯的）。

我希望像

```
import Control.Monad (replicateM)
import System.Random 

main = do
    randList <- replicateM yourListSize (randomRIO (1,6))
    print randList 
```

将帮助您开始。

# ruby-on-rails - 我可以为所有属性的单个验证器指定默认错误消息格式吗？

> ID：14025627
> 
> 赞同：0
> 
> 时间：2012-12-24T20:56:15.337
> 
> 标签：ruby-on-rails, ruby-on-rails-3, validation, yaml

我知道你可以这样做：

```
# config/locales/en.yml
en:
  activerecord:
    attributes:
      user:
        email: "E-mail address"
    errors:
      models:
        user:
          attributes:
            email:
              blank: "is required" 
```

通过[https://stackoverflow.com/a/2859275/718050](https://stackoverflow.com/a/2859275/718050)

**问题 1**
是否可以为`blank`整个模型甚至整个站点指定消息，而不是进入每个模型`attribute`？

**问题 2**
另外，它似乎`blank`来自`:presence`模型，例如

```
validates :email, :presence => true 
```

因此，如果`:presence => true`错误翻译为`blank:`，我在哪里可以找到这些翻译的列表？我怎么知道`:unique => true`en.yml里面变成了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-24T21:01:55.107

这份清单在[这里](https://github.com/rails/rails/blob/master/activemodel/lib/active_model/locale/en.yml)和[这里](https://github.com/rails/rails/blob/master/activerecord/lib/active_record/locale/en.yml)

如您所见，您可以`blank`像这样重新定义错误：

```
en:
  errors:
    messages:
      blank: "can't be blank" 
```

# javascript - 初始化在 jQuery $.getJSON 回调函数之外声明的变量

> ID：14025628
> 
> 赞同：2
> 
> 时间：2012-12-24T20:56:38.067
> 
> 标签：javascript, jquery, ajax, json, scope

我的脚本通过 jQuery 发出 Ajax 请求。接收到的数据通过服务器端脚本 (php) 进行 json_encoded。这进一步，字符串化，然后使用 jQuery 解析 JSON 以产生一个记录集合。我循环遍历 recordCollection 并将其推送到记录数组，该变量在回调函数范围之外声明。

该函数如下所示：

```
var records = [] ;
$.getJSON(url, {id : recordid}, function(data) {

 var recordCollection = jQuery.parseJSON(JSON.stringify(data));

 $.each(recordCollection, function(){
  records.push(this);
 });
  console.log(records) // displays all the objects, thus, the above code is right
});  

console.log(records); // displays [] 
```

正如您在上面看到的，我第二次将记录记录到控制台时，它产生了一个空数组，这使我得出两个结论：

1.  Javascript 数组是按值传递的，因此回调函数范围之外的记录不会保留它的值。

2.  Ajax 是异步的，因此在 ajax 调用完成之前记录记录，因此它仍然保留空的未初始化记录数组的值并将其记录到控制台上。

现在如果 1 为真，我该如何初始化记录数组？

如果 2 是真的，我应该让这个 Ajax 调用同步吗？这将使javascript阻塞，直到返回值，因此第二次记录数组登录到控制台，它将显示数组的更新值？

第三是我完全错过了一个技巧，在这里做了一些非常愚蠢的事情。

我确实需要使用从 ajax 调用返回的数据来设置记录数组，因为它需要传递给脚本中的不同 javascript 函数，并且 DOM 基本上等待这个结果来加载数据。

多谢你们！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T21:06:35.300

你是对的，ajax 调用是异步的，因此`Asynchronous Javascript and XML`. 你可以让它同步，但你不应该这样做，因为你的阵列将可供任何人使用，这可能会导致一些大麻烦。

相反，一旦您的 ajax 调用完成，就会运行一个 init 调用。

```
function callback(records) {
  // do stuff with records.
}

$.getJSON(url, {id : recordid}, function(data) {

 var recordCollection = jQuery.parseJSON(JSON.stringify(data));
 callback(recordCollection); 
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T21:06:04.040

Ajax 代表[异步 JavaScript 和 XML](http://en.wikipedia.org/wiki/Ajax_%28programming%29)（忘记 XML 部分），所以我认为您可以猜到什么是正确的；-)

我添加了带有注释的执行顺序：

```
var records = [] ;

// 1\. send request and return immediately
$.getJSON(url, {id : recordid}, function(data) {

 // 3\. response from server is received
 var recordCollection = jQuery.parseJSON(JSON.stringify(data));    
 $.each(recordCollection, function(){
  records.push(this);
 });
  console.log(records)
});  

// 2\. print records
console.log(records); 
```

您不应尝试以任何方式使请求同步。如果您需要`records`在数据可用后做一些事情，您应该创建一个新函数并在将值推送到`records`.

# powershell - if 语句中的 if 语句

> ID：14025630
> 
> 赞同：0
> 
> 时间：2012-12-24T20:56:57.517
> 
> 标签：powershell

对于作业，我必须证明 if 语句可以放在 Powershell 脚本中的 if 语句中。因此，我制作了随附的脚本。但是，我不确定我的脚本是否描述了两个单独的 if 语句，或者是否会被视为 if 中的 if。

```
[int]$a = Read-host "Please input a number." 
if ($a –eq 5) { 
Write-Host “a is 5” } 
if ($a –ne 5) { 
Write-Host “a isn't 5” }
Read-host 
```

对这个有帮助吗？

* * *

谢谢您的回答。但是为什么这不起作用？

```
if ($a –lt 2) { 
    if ($a –lt 3) {       
        if ($a –lt 4) { 
             if ($a –lt 5) {  
             Write-Host “a is less than 5” }
        Write-Host “a is less than 4” } 
    Write-Host “a is less than 3” }
Write-Host “a is less than 2” } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T21:01:27.073

不，这是两个独立的 if 语句。嵌套将是：

```
if ($a –lt 5) { 
  if ($a –ne 2) { 
  Write-Host “a isn't 2” }
Write-Host “a is lt 5” } 
```

# entity-framework - 使用逆向工程代码优先时出现实体框架 Power Tools 错误

> ID：14025638
> 
> 赞同：2
> 
> 时间：2012-12-24T20:57:37.187
> 
> 标签：entity-framework

我有一个 Sql Server 2012 数据库，我正在尝试使用 EF Power Tools 2 的逆向工程师代码优先选项在 Visual Studio 2012 SP1 中生成代码优先 POCO/映射。

设置连接属性后，会产生以下错误。我已经研究了网络，但没有运气如何解决这个问题。任何帮助，将不胜感激。

> 编译转换：找不到类型或命名空间名称“EfTextTemplateHost”（您是否缺少 using 指令或程序集引用？）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-27T07:41:19.053

**编辑： [今天发布的 EF Power Tools Beta 3](http://blogs.msdn.com/b/adonet/archive/2013/01/30/ef-power-tools-beta-3-available.aspx)现在应该已修复该问题**

如果您在安装 VS 2012 Update1 后尝试使用 EF Power Tools，您将看到此异常。 [Rowan 在 EF Team 博客上的回复](http://blogs.msdn.com/b/adonet/archive/2012/04/09/ef-power-tools-beta-2-available.aspx#10374587)（在页面底部的评论中）如下：

*作为此问题的解决方法，您可以编辑 Program Files (x86)\Microsoft Visual Studio 11.0\Common7\IDE\Extensions\Microsoft\Entity Framework Tools\Templates\Includes\EF.Utility.CS.ttinclude 并删除第一行 (< #@ CleanupBehavior Processor="T4VSHost" CleanupAfterProcessingTemplate="true" #>)。这样做的唯一副作用是 EF 设计器将在您创建和编辑模型时使用更多虚拟内存。在大多数计算机上，这不是问题。*

我们正在努力发布新版本的 EF Power Tools，其中将包含此问题的修复程序。

**编辑： [Rowan 的博客](http://romiller.com/2013/03/21/processor-named-t4vshost-could-not-be-found-for-the-directive-named-cleanupbehavior/)包含有关如何手动解决该问题的更多详细信息，即使您安装了 Power Tools Beta 3，如果您仍然遇到该问题。**

* * *

## 回答 #2

> 赞同：-5
> 
> 时间：2012-12-24T21:34:27.250

尝试使用这个插件 [https://skydrive.live.com/?cid=456117cf53a42144&id=456117CF53A42144%21388](https://skydrive.live.com/?cid=456117cf53a42144&id=456117CF53A42144%21388) （但是它没有签名）有人抱怨@MSDN 电动工具被搞砸了（实际上整个 EF 是一团糟）。

安装这个后，当 VS 提示您输入数据库信息时，单击“高级”并将 Persist Security Info 设置为 True。

应该管用

EF 仍然存在大量错误，请避免将其用于关键环境。甚至不要考虑EF5。

# c++ - 关于 Safe 类是异常安全的声明的澄清

> ID：14025642
> 
> 赞同：1
> 
> 时间：2012-12-24T20:58:33.837
> 
> 标签：c++, memory-leaks, assignment-operator

[您将在本文档](http://www.stroustrup.com/3rd_safe.pdf)的第 937 页找到以下代码：

```
template<class T> class Safe
{
    T* p;  // p points to a T allocated using new
    public:
    Safe() : p(new T) {}
    ~Safe() { delete p; }
    Safe& operator=(const Safe& a) { *p = *a.p; return *this; }
    // ...
}; 
```

看起来， p 指向的对象将在上面的赋值运算符中泄漏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-24T21:02:02.527

这不是泄漏，因为他没有更改指针。如果他这样做了

```
Safe& operator=(const Safe& a) { p = a.p; return *this; } 
```

那么这将是一个内存泄漏。他正在对 p 指向的对象进行分配，而不是对 p 本身。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-24T21:01:31.013

不会。不会有泄漏，因为他没有改变指针。当然，它仍然缺少复制构造函数，但除此之外，没有错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-24T21:01:55.840

分配*不是*问题：分配的不是指针，而是指向的值。假设`T`' 的赋值是异常安全的，`Safe<T>`' 的复制赋值也是安全的。但是，该类缺少复制构造函数。

# vb.net - 使按钮单击工作一次

> ID：14025643
> 
> 赞同：0
> 
> 时间：2012-12-24T20:58:35.693
> 
> 标签：vb.net, button, checkbox, textbox, click

我如何告诉代码不要在每次单击按钮时将单词写入文本框？

当同时单击两个复选框时，必须按添加顺序写入文本，但是当我再次单击按钮时，文本不应加倍或相乘。

```
Public Class Form1

    Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
        If CheckBox1.Checked = True Then
            TextBox1.Text += ("hello ")
        End If
        If CheckBox2.Checked = True Then
            TextBox1.Text += ("please help")
        End If
    End Sub
End Class 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T21:10:39.107

为每个 if 语句（即每个复选框）使用一个布尔变量。最初将它们设置为 false 并将您的代码更改为如下所示

```
If CheckBox1.Checked = True And CheckBox1Bool = False Then
    TextBox1.Text += ("hello ")
    CheckBox1Bool = True
End If
If CheckBox2.Checked = True And CheckBox2Bool = False Then
    TextBox1.Text += ("please help")
    CheckBox2Bool = True
End If 
```

**编辑：**

```
Public Class Form1
    Dim Bool1 As Boolean
    Dim Bool2 As Boolean

    Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
        If CheckBox1.Checked = True And Not Bool1 Then
            TextBox1.Text += ("hello ")
            Bool1 = True
        End If
        If CheckBox2.Checked = True And Not Bool2 Then
            TextBox1.Text += ("please help")
            Bool2 = True
        End If
    End Sub
End Class 
```

这行得通，正如您所见，我没有更改仅添加在我向您建议的代码中的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-25T11:31:22.853

非常感谢您对我的问题的关心。在我检查了你的解决方案后，我上床睡觉了。我刚刚发布了stg，我要睡觉了，然后再次打开电脑，用这个东西解决了我的愚蠢问题..这对我来说很完美:)

```
 Public Class Form1

Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
    Textbox1.Text= ("")
    If CheckBox1.Checked = True Then
        TextBox1.Text += ("hello ")
    End If
    If CheckBox2.Checked = True Then
        TextBox1.Text += ("please help")
    End If
End Sub 
```

结束类

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-24T21:46:39.847

Just reset your Checkbox.Checked event in your Button Click event. That way it will not send the text again till you reselect it.

```
Private Sub Button1_Click(sender As System.Object, e As System.EventArgs) Handles Button1.Click
    If CheckBox1.Checked = True Then
        CheckBox1.Checked = False
        TextBox1.Text += ("hello ")
    End If
    If CheckBox2.Checked = True Then
        CheckBox2.Checked = False
        TextBox1.Text += ("please help")
    End If
End Sub 
```

# iphone - 使用静态单元格删除 UITableView 部分边框和背景颜色？

> ID：14025645
> 
> 赞同：2
> 
> 时间：2012-12-24T20:59:00.543
> 
> 标签：iphone, objective-c, ios, uitableview, ios5

我正在使用`UITableView`静态单元格来制作一个小表格。

我在其中添加了多个部分，`UITableView`但现在我必须删除显示“**登录**和**忘记密码**”按钮的部分的背景颜色和边框。

查看下面的屏幕截图。

![在此处输入图像描述](../Images/0f67fef233f9dd6ad5bbe37dd09ed9e9.png)

# 问题 1

如何删除背景颜色和边框？

# 问题2

无论如何也可以更改视图的背景颜色。此视图继承自`UITableViewController`. 我相信我需要更改部分或组的颜色。

我将标识符分配给单元格并删除背景颜色。

```
- (void)tableView:(UITableView *)tableView willDisplayCell:(UITableViewCell *)cell forRowAtIndexPath:(NSIndexPath *)indexPath
{

    if([cell.reuseIdentifier isEqualToString:@"ButtonsCell"])
    {
        cell.backgroundColor = [UIColor clearColor];

        NSLog(@"login buttons cells found");
    }

} 
```

这是图像：

![在此处输入图像描述](../Images/0f67fef233f9dd6ad5bbe37dd09ed9e9.png)

但边界仍然显示！

* * *

# 解决方案

奇怪但有效！

```
cell.backgroundView = nil; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T21:10:49.693

我认为您想根据您在 cellForRowAtIndexPath 中的部分进行切换。然后用透明的视图替换该行的背景。

```
switch (section)
    {
        case BACKGROUND_SECTION:
        {
            // Only way I could find to get row centered
            segmentCell.selectionStyle = UITableViewCellSelectionStyleNone;
        [segmentCell setAccessoryType:UITableViewCellAccessoryNone];
            // Make the cell background transparent
            UIView *backView = [[UIView alloc] initWithFrame:CGRectZero];
            backView.backgroundColor = [UIColor clearColor];
            segmentCell.backgroundView = backView;
        }
} 
```

# javascript - Chrome 扩展 - 在点击浏览器操作时将 css 注入页面

> ID：14025648
> 
> 赞同：2
> 
> 时间：2012-12-24T21:00:13.327
> 
> 标签：javascript, google-chrome, google-chrome-extension

我知道如何使用这种方法将 CSS 注入指定的 URLs [https://stackoverflow.com/a/7619104/1157283](https://stackoverflow.com/a/7619104/1157283)

但是，如果我只想在单击浏览器操作时将其注入这些页面怎么办？我正在阅读有关编程注入[http://developer.chrome.com/extensions/content_scripts.html#pi](http://developer.chrome.com/extensions/content_scripts.html#pi)的内容，这使得您似乎必须获取要注入 CSS 的所有页面的 tabID，然后循环遍历它们以为每个 tabID 注入 CSS？

这是需要的还是我在这里完全不合时宜？看起来它应该比我建议的更直接。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-24T23:16:42.310

不要害怕我的朋友，这是解决您问题的正确方法。

**manifest.json** 我们将指定要注入 css 的 url，以及权限指令中的选项卡。

```
"permissions":[
  "tabs",
  "https://google.com.mx/*"
], 
```

**background.js** 添加正确的 onClick 监听器。

```
chrome.browserAction.onClicked.addListener(browserListener); 
```

听众看起来像这样

```
var browserListener = function(tab) {
    var regexPage = new RegExp(/https:\/\/www.google.com.mx\//); // We use a regular expresion to check which page was given.
    var match = regexPage.exec(tab.url); // We then check if the given page matches our expression.
    // If it matches and the status of the tab is complete...
    if(match && tab.status === 'complete') {
        //We insert the css
        chrome.tabs.insertCSS(tab.id, {
            file: "css/test.css"
        });
    }
} 
```

如果您`https://*/*`在权限指令中请求对所有页面的权限，则可以跳过匹配部分。这使您对内容脚本具有更大的灵活性，它们仅通过匹配来触发；请记住，与任何 CSS 一样，您需要指定适当的规则来覆盖页面的规则以查看更改，这在大多数情况下意味着`important!`在您的 CSS 中使用标签。

# c# - asp.net 的正确参数化查询类 - c# 应用程序 - sql server

> ID：14025652
> 
> 赞同：2
> 
> 时间：2012-12-24T21:00:50.597
> 
> 标签：c#, asp.net, sql-server, class, parameterized

我开始将我的查询封装在一个参数化查询类中

现在您能否评估我的课程的性能安全性和其他可能的方面？

**你有什么建议吗 ？**

这是我的精选课

```
public static DataSet cmd_SelectQuery(string srCommandText, List<string> lstParameterNames, List<string> lstParameters)
{
    DataSet dsCmdPara = new DataSet();
    try
    {
        using (SqlConnection connection = new SqlConnection(DbConnection.srConnectionString))
        {
            using (SqlCommand cmd = new SqlCommand(srCommandText, connection))
            {
                cmd.CommandType = CommandType.Text;
                for (int i = 0; i < lstParameterNames.Count; i++)
                {
                    cmd.Parameters.AddWithValue(lstParameterNames[i], lstParameters[i]);
                }
                connection.Open();
                using (SqlDataAdapter sqlDa = new SqlDataAdapter(cmd))
                {
                    sqlDa.Fill(dsCmdPara);
                    return dsCmdPara;
                }
            }
        }
    }
    catch (Exception E)
    {
        csPublicFunctions.insertIntoTblSqlErrors(srCommandText + " " + E.Message.ToString());
    }
    return dsCmdPara;
} 
```

在这里我的更新，删除类

```
public static void cmd_UpdateDeleteQuery(string srCommandText, List<string> lstParameterNames, List<string> lstParameters)
{
    try
    {
        using (SqlConnection connection = new SqlConnection(DbConnection.srConnectionString))
        {
            using (SqlCommand cmd = new SqlCommand(srCommandText, connection))
            {
                cmd.CommandType = CommandType.Text;
                for (int i = 0; i < lstParameterNames.Count; i++)
                {
                    cmd.Parameters.AddWithValue(lstParameterNames[i], lstParameters[i]);
                }
                connection.Open();
                cmd.ExecuteNonQuery();
            }
        }
    }
    catch (Exception E)
    {
        csPublicFunctions.insertIntoTblSqlErrors(srCommandText + " " + E.Message.ToString());
    }
} 
```

非常感谢您的回答

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T21:14:36.100

自从我在手机上写这篇文章以来，有两个快速建议。

1.  接收对象，而不是字符串
2.  将 params object[] 作为参数列表可能会使您的方法更自然地使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T21:29:04.207

该代码是有效且正确的。你要求反馈，所以我有以下几点。

**(1)**在构建参数的代码中，最好指定数据类型。

```
for (int i = 0; i < lstParameterNames.Count; i++)
{
    var parameter = cmd.Parameters.AddWithValue(lstParameterNames[i], lstParameters[i]);
    parameter.SqlDbType = SqlDbType.NVarChar; // or whatever type you need
} 
```

**(2)**您不需要显式打开/关闭连接，因为 Fill 方法会为您执行此操作。

```
connection.Open();
using (SqlDataAdapter sqlDa = new SqlDataAdapter(cmd))
{
    sqlDa.Fill(dsCmdPara);
    connection.Close();
    return dsCmdPara;
} 
```

**(3)**如果您只打算拥有一个表，请使用 DataTable 而不是 DataSet。它将更快，更简单。

**(4)**这更像是一个风格点，但我发现明确关闭您的连接非常有帮助。如果关闭时出现异常，则具有行号（通过 pdb）非常有帮助。此外，它有助于确保您在忘记使用时不会泄漏连接。

* * *

**编辑**

我想澄清第 4 点。假设当连接关闭时，清理导致异常。如果您没有显式关闭连接，则会在 Dispose 方法中引发异常，这可能会做很多其他工作。这使得更难看出**我**做了什么导致问题。

举这个简单的例子。有一个底层资源需要清理（Dispose 的全部原因），它会引发异常。

```
public class Resource: IDisposable
{
    public void Close()
    {
        CleanupMemory();
    }

    private void CleanupMemory()
    {
        throw new Exception();
    }

    public void Dispose()
    {
        CleanupMemory();
    }
} 
```

两种不同方法的（清理后的）堆栈跟踪是：

```
using (var r = new Resource())
{
    r.Close();
}

   at ConsoleApplication1.Resource.CleanupMemory() in Program.cs:line 31
   at ConsoleApplication1.Resource.Close() in Program.cs:line 26
   at ConsoleApplication1.Program.Main(String[] args) Program.cs:line 16 
```

相对

```
using (var r = new Resource())
{

}

   at ConsoleApplication1.Resource.CleanupMemory() in Program.cs:line 35
   at ConsoleApplication1.Resource.Dispose() in Program.cs:line 40
   at ConsoleApplication1.Program.Main(String[] args) in Program.cs:line 18 
```

在第一个示例中，我知道我调用 Close 导致了异常，我有一个地方开始调试。如果我只知道抛出了异常，我需要完全依赖异常中的信息。我没有其他背景。而且大多数异常消息都不是特别清楚。:)

两者都是完全正确的，只是不同。

埃里克

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-12-25T15:33:44.763

```
public DataTable Get_DTable(String Query, Dictionary<String, String> Parameters)
    {
        try
        {
            using (con = new SqlConnection(cls_Connection.URL()))
            {
                if (con.State == 0)
                    con.Open();
                using (cmd = new SqlCommand(Query, con))
                {
                    foreach (KeyValuePair<string, string> item in Parameters)
                    {
                        cmd.Parameters.AddWithValue(item.Key, item.Value);
                    }

                    using (da = new SqlDataAdapter(cmd))
                    {
                        using (dt = new DataTable())
                        {
                            da.Fill(dt);
                            if (dt.Rows.Count > 0)
                            {
                                return dt;
                            }
                        }
                    }
                }
            }
        }
        catch (Exception exp)
        {
            MessageBox.Show(exp.Message,
                            "Information",
                            MessageBoxButtons.OK,
                            MessageBoxIcon.Information);
        }
        return null;
    } 
```

# python - int() 的 python 生成器无效文字

> ID：14025653
> 
> 赞同：2
> 
> 时间：2012-12-24T21:00:53.390
> 
> 标签：python, linux

我正在使用来自[http://www.dabeaz.com/generators/fieldmap.py的字段映射生成器功能](http://www.dabeaz.com/generators/fieldmap.py)

```
#!/usr/bin/env python

def field_map(dictseq, name, func):
    for d in dictseq:
        d[name] = func(d[name])
        yield d

if __name__ == '__main__':
    loglines = open("test.log")
    import re
    logpats = r'(\S+) (\S+) (\S+) (\S+) (\S+) \[(.*?)\] \"(.*?)\" (\S+) (\S+) \"(.*?)\" \"(.*?)\" (\S+) \"(.*?)\" \"(.*?)\" (\S+)'
    logpat = re.compile(logpats)
    groups = (logpat.match(line) for line in loglines)
    tuples = (g.groups() for g in groups if g)
    #for t in tuples:
    #    print t

    colnames = ('record_id', 'elapsed_time', 'client', 'username' , 'client_id','date',
                'http_method_url', 'status', 'size', 'http_referer','useragent', 'mime',
                'filter_name_reason', 'profiles', 'ipport')
    log = (dict(zip(colnames,t)) for t in tuples)
    log = field_map(log,"status",int)
    log = field_map(log,"size",lambda s: int(s) if s != '-' else 0)
    for x in log:
        print x 
```

它给出了这个错误，有什么想法吗？

```
[root@cumbria extended]# python fieldmap.py
Traceback (most recent call last):
  File "fieldmap.py", line 24, in <module>
    for x in log:
  File "fieldmap.py", line 4, in field_map
    for d in dictseq:
  File "fieldmap.py", line 5, in field_map
    d[name] = func(d[name])
ValueError: invalid literal for int() with base 10: 'status' 
```

test.log 有这种格式的数据

```
"1356313509.519-6-10.66.54.21-8080" 2089 10.112.151.213 "anonymous@10.112.151.213" "6" [24/Dec/2012:01:45:11] "GET http://apps.facebook.com:80/thesimssocial/?fb_source=bookmark_apps&ref=bookmarks&count=2&fb_bmpos=4_2" 200 58300 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.97 Safari/537.11 BMID/E679E9E153" text/html "- -" "M&B-112,HTTP,QUERIES,uncachable,antivirus,REDIRECT_THIS" "10.66.54.21:8080" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T21:25:56.803

test.log 中的第一行可能是包含字段名称而不是其值的标头。这就是为什么您会看到“状态”而不是“200”。

您可以使您的正则表达式更有选择性，以便更快地过滤掉不合适的行，例如，用于`\d+`匹配 http 状态。

# c++ - C++ 错误：名称后跟“::”必须是类或命名空间名称。DLL 中的 WindowsForm

> ID：14025655
> 
> 赞同：1
> 
> 时间：2012-12-24T21:01:07.150
> 
> 标签：c++, windows, forms, dll, visual-studio-2012

所以我在visual studio 2012中制作了一个windows32 C++ dll应用程序，然后我在头文件部分添加了一个windows窗体并将其命名为“UserInterface.h”。当我单击“添加”按钮时，我收到一个弹出窗口，提示“您正在将 CLR 组件添加到本机项目。您的项目将被转换为具有公共语言运行时支持。您希望继续吗？” 我点击是，它生成了文件“UserInterface1.cpp”和“UserInterface1.h”。

但是在“UserInterface1.h”中到处都是错误。以下是它的内容：

```
#pragma once

namespace AssultCubeDLL {

    //ERRORS HERE: ******************************************************
using namespace System;
using namespace System::ComponentModel;
using namespace System::Collections;
using namespace System::Windows::Forms;
using namespace System::Data;
using namespace System::Drawing;

/// <summary>
/// Summary for UserInterface
/// </summary>
    // ERROS HERE: *********************************************************
public ref class UserInterface : public System::Windows::Forms::Form
{
public:
    UserInterface(void)
    {
        InitializeComponent();
        //
        //TODO: Add the constructor code here
        //
    }

protected:
    /// <summary>
    /// Clean up any resources being used.
    /// </summary>
    ~UserInterface()
    {
        if (components)
        {
            delete components;
        }
    }

private:
    /// <summary>
    /// Required designer variable.
    /// </summary>
           // ERRORS HERE: ************************************************
    System::ComponentModel::Container ^components;

    #pragma region Windows Form Designer generated code
    /// <summary>
    /// Required method for Designer support - do not modify
    /// the contents of this method with the code editor.
    /// </summary>
    void InitializeComponent(void)
    {
        this->SuspendLayout();
        // 
        // UserInterface
        // ERRORS HERE: *******************************************************
        this->AutoScaleDimensions = System::Drawing::SizeF(6, 13);
        this->AutoScaleMode = System::Windows::Forms::AutoScaleMode::Font;
        this->ClientSize = System::Drawing::Size(284, 262);
        this->Name = L"UserInterface";
        this->Text = L"UserInterface";
        this->Load += gcnew System::EventHandler(this, &UserInterface::UserInterface_Load);
        this->ResumeLayout(false);

    }
    #pragma endregion
private: System::Void UserInterface_Load(System::Object^  sender, System::EventArgs^  e) {
         }
};
} 
```

我在弹出错误的地方添加了注释，例如“错误：名称后跟'::'必须是类或命名空间名称。” 有谁知道我为什么会遇到这些问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-11-11T17:15:20.003

您将需要创建一个混合模式应用程序。Microsoft对所需步骤有[明确的说明。](https://msdn.microsoft.com/en-us/library/ms235211.aspx)

MS 说明将解决 System 和 System::Collections 的问题，但不能解决 System::ComponentModel、System::Windows::Forms、System::Data 和 System::Drawing 的问题。

要进行编译，您必须将缺少的 DLL 的引用添加到应用程序中。您可以`using <System.Windows.Forms>`从 stdafx.h 文件中删除 。右键单击属性并选择`References...`，然后选择`Add New Reference`，然后检查以下 DLL

```
System
System.Data
System.Drawing
System.Windows.Forms 
```

代码现在将编译。

# powershell - 通过引用设置对象属性

> ID：14025656
> 
> 赞同：0
> 
> 时间：2012-12-24T21:01:11.577
> 
> 标签：powershell, reference

我有一个 PSObject 集合，我想对其进行迭代，设置组成成员的属性。我设置了一个`for`循环并通过引用一个函数来传递当前对象，但不知道如何访问对象属性。例子：

```
function create-object {
    $foo = new-object -TypeName PSObject -Prop `
        @{
            "p1" = $null
            "p2" = $null
        }
    $foo
}

$objCol = @()

foreach ($k in (1 .. 3)){$objCol += create-object} 

for ($i=0;$i -le $objCol.Length;$i++) {
    Write-Host "hi"
    reftest ([ref]$objCol[$i])
}

function reftest([ref]$input)
{
    $input.p1.value="property1"
}
$objCol 
```

... 返回`Property 'p1' cannot be found on this object`-- 如何通过引用从函数中设置 $object.p1？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-25T07:58:21.367

正如 Christian 所指出的，我已经重新格式化了您的示例，也将 of 更改为`$input`不同的名称， 。`$arg`以下作品：

```
function create-object {
    $foo = new-object PSObject -Property @{
        "p1" = $null
        "p2" = $null
    }
    $foo
}

function reftest($arg)
{
    $arg.p1="property1"
}

$objCol = @()

(1..3) | % {$objCol += create-object} 

for ($i=0;$i -lt $objCol.Length;$i++) {
    reftest $objCol[$i]
}

$objCol 
```

# asp.net-mvc-4 - 从 CLR 到 EDM 的“模糊”映射

> ID：14025657
> 
> 赞同：0
> 
> 时间：2012-12-24T21:01:25.433
> 
> 标签：asp.net-mvc-4, visual-studio-2012, entity-framework-4.3

我知道当您在不同的命名空间中有两个具有相同名称的类时，Code First 曾经有一个问题（或者可能仍然存在）。我发现了很多关于这个的帖子。我有点……不一样？

好吧，不管他们如何“修复”它，他们让情况变得更糟。我没有两个同名的班级，我只有一个班级。我向你保证，你没有看到双重。下面出现的类名是一模一样的，没有其他的类名。

CLR 类型到 EDM 类型的映射不明确，因为多个 CLR 类型与 EDM 类型“类名”匹配。以前找到的CLR类型'App.Domain.Classname'，新找到的CLR类型'App.Domain.Classname'。

当我尝试使用模板“具有读/写操作和视图的 MVC 控制器，使用实体框架”创建新控制器时，我多次收到此错误（对于不同的类名）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-09T16:00:39.413

如果您在同一模块中有多个 edmx 文件，则会出现此问题。即使在那些 edmx 中，它也可能存在相同类型的两个实体。这是 ef4 的框架问题。但它可以通过手动更改实体名称来解决。这是由 edmx 创建的。或者简单地在任何一个实体中添加一个转储列。在第一种方式中，我们应该对所有实体类以及引用实体类进行更多更改。

# php - 无法从数据库中获取要删除的消息行

> ID：14025662
> 
> 赞同：0
> 
> 时间：2012-12-24T21:01:30.233
> 
> 标签：php, mysql, codeigniter, activerecord

我正在尝试从我的数据库中删除消息行，作为大学项目的社交网站的一部分，但出现错误：严重性：通知消息：未定义的索引：在我的视图中的 id。非常感谢任何帮助！！！！

```
This is my method in the Model:

function delMessage($id)
  {

    $this->db->where(array('id' => $id));
    $this->db->delete('messages');

  }

This is my method in my Controller:

 function delMessage($id) {

    $this->messages->delMessage($id);

    redirect('message');

   }

And this is the code in my view:

 if(!empty($messages)){
           foreach($messages as $message):
           $delete = $message['id']; 
           var_dump($message); ?>
          <li><?=$message['from']?> says...: "<?=$message['message']?>"(<?=anchor("message/delMessage/$delete", 'delete')?>)</li>      
         <?php endforeach?> 
          <?php }else{ ?>

         <?php echo 'No Messages to View'; }?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T21:23:27.103

您编写此内容的方式是在不向其传递任何数据的情况下调用视图。如果要在视图中循环遍历数组，则必须从控制器传递数组。

您的控制器需要看起来更像以下内容：

```
function delMessage($username) {
    $this->load->model('messages_model');
    $data['messages'] = $this->messages->deleteUserMessage($username);
    $this->load->view('message', $data);
} 
```

为了使它起作用，您的模型必须做的不仅仅是删除。它还必须查询数据库并返回数组 $messages。

我可以尝试为您提供更多帮助，但是查看您的代码我无法弄清楚您要做什么。您已经分配了变量 $delete，但您从未使用过它。您在每个循环上转储数组，并且每次都在回显“来自”。在这一点上，这就像埃及象形文字。请提供更多信息。

根据提供的新信息进行更新：

```
function deleteUserMessage($username) {
    $this->db->where('from', $username);
    $this->db->or_where('to', $username); 
    $query = $this->db->get('messages');
    if ($query->num_rows() > 0){
        $messages = $query->result_array();
        $this->db->where('from', $username);
        $this->db->or_where('to', $username); 
        $this->db->delete('messages');
        return $messages;
    }
} 
```

# c++ - 为嵌入式系统在 C++ 中对有效和无效数字的数组进行排序

> ID：14025663
> 
> 赞同：2
> 
> 时间：2012-12-24T21:01:36.417
> 
> 标签：c++, c, algorithm, sorting, embedded

我正在用 C++ 编写一个程序，它将与 Windows Embedded Compact 7 一起使用。我听说在编写嵌入式代码时最好不要动态分配数组。我将跟踪 0 到 50 个对象，因此我最初分配 50 个对象。

```
Object objectList[50];
int activeObjectIndex[50];
static const int INVALID_INDEX = -1;
int activeObjectCount=0; 
```

activeObjectCount 告诉我实际使用了多少对象，activeObjectIndex 告诉我正在使用哪些对象。如果正在使用第 0、第 7 和第 10 个对象，我希望`activeObjectIndex = [0,7,10,-1,-1,-1,...,-1];`并且`activeObjectCount=3;` 随着不同的对象变为活动或不活动，我希望 activeObjectIndex 列表保持有序。

目前，我只是在每个循环结束时对值可能会更改的 activeObjectIndex 进行排序。

首先，有没有比我正在做的更好的方法来跟踪嵌入式系统中的对象（可能是活动的也可能不是活动的）？如果没有，是否有一种算法可以用来在每次添加或删除活动对象时保持对象排序？还是我应该定期做一个冒泡排序或其他东西来保持它们的顺序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T21:16:20.733

std::vector 的开销非常小。您可能遇到的问题是动态调整大小将分配比需要更多的内存。但是，因为您有 50 个元素，所以这根本不应该是一个问题。试一试，只有当你看到强烈的影响时才改变它。

如果您不能/不想从 std::vector 中删除未使用的对象，您可以向您的对象添加一个布尔值，指示它是否处于活动状态？这不需要比使用 activeObjectIndex 更多的内存（可能甚至更少，具体取决于对齐问题）。

要使用布尔值（最后不活动）对数据进行排序，请编写一个函数：

```
bool compare(const Object & a, const Object & b) {
    if(a.active && !b.active) return true;
    else return false;
}

std::sort(objectList,objectList + 50, &compare); // if you use an array
std::sort(objectList.begin(),objectList.end(), &compare); // if you use std::vector 
```

如果你想使用 activeObjectIndex 进行排序，它会更复杂。如果要使用始终有序的结构，请使用 std::set。但是它需要更多的内存（但对于 50 个元素，这不是问题）。

理想情况下，实现以下功能：

```
bool operator<(const Object & a, const Object & b) {
    if(a.active && !b.active) return true;
    else return false;
} 
```

这将允许直接使用 std::sort(objectList.begin(), objectList.end()) 或声明将保持排序的 std::set。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T21:22:40.487

跟踪活动/非活动的一种方法是让活动对象位于双向链表上。当一个对象从非活动状态变为活动状态然后添加到列表中，从活动状态到非活动状态从列表中删除。您可以将这些添加到对象

```
Object * next, * prev; 
```

所以这不需要内存分配。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-24T21:22:56.433

如果不允许动态内存分配，我会使用简单的 c-array 或`std::array`和一个指向 last+1 对象的索引。对象始终按排序顺序保存。

添加是通过将新对象插入到排序列表的正确位置来完成的。查找插入位置`lower_bound`或`find_if`可以使用。对于 50 个元素，第二个可能会更快。删除类似。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-24T21:26:19.880

您不应该担心对列表进行排序，因为编写一个方法来搜索索引列表中的活动是什么`O(N)`，并且在您的特定情况下，摊销到`O(1)`，因为您的数组似乎足够小额外的验证。

您可以维护检查的最后一个元素的索引，直到达到限制：

```
unsigned int next(const unsigned int& last) {

    for (unsigned int i = last + 1; i < MAX_ARRAY_SIZE; i++) {
        if (activeObjectIndex[i] != -1) {
            return i;
        }
    }

    return -1;

} 
```

但是，如果你真的想要一个边索引，你可以简单地把数组的大小加倍，为元素创建一个双链表：

```
activeObjectIndex[MAX_ARRAY_SIZE * 3] = {-1};
activeObjectIndex[i] = "element id";
activeObjectIndex[i + 1] = "position of the previous element";
activeObjectIndex[i + 2] = "position of the next element"; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-24T21:39:43.197

你有一个难题，答案需要对你的系统有相当多的了解。如果没有这些知识，我无法给出完整的答案。然而，15 年的嵌入式设计经验教会了我以下几点：

1.  你是对的，你通常**不想**在运行时分配对象。预分配所有对象，并将它们移动到活动/非活动队列。
2.  把事情整理好通常很难。也许你不需要。你没有提到它，但我敢打赌你真的只需要将你的对象保存在“使用”和“空闲”池中，并且你正在使用索引来快速查找/删除对象。

我提出以下解决方案。将您的对象更改为以下内容：

```
class Object {
  Object *mNext, *mPrevious;
public:
  Object() : mNext(this), mPrevious(this) { /* etc. */ }

  void insertAfterInList(Object *p2) {
    mNext->mPrev = p2;
    p2->mNext = mNext;
    mNext = p2;
    p2->mPrev = this;
  }

  void removeFromList() {
    mPrev->mNext = mNext;
    mNext->mPrev = mPrev;
    mNext = mPrev = this;
  }

  Object* getNext() {
    return mNext;
  }

  bool hasObjects() {
    return mNext != this;
  }
}; 
```

并使用您的对象：

```
#define NUM_OBJECTS (50)
Object gObjects[NUM_OBJECTS], gFree, gUsed;

void InitObjects() {
  for(int i = 0; i < NUM_OBJECTS; ++i) {
    gFree.insertAfter(&mObjects[i]);
  }
}

Object* GetNewObject() {
  assert(mFree.hasObjects());
  Object obj = mFree->getNext();
  obj->removeFromList();
  gUsed.insertAfter(obj);
  return obj;
}

void ReleaseObject(Object *obj) {
  obj->removeFromList();
  mFree.insertAfter(obj);
} 
```

编辑以修复一个小故障。现在应该可以工作了，虽然没有经过测试。:)

# c# - 使用 sql server 作业代理运行 .exe 时访问被拒绝

> ID：14025664
> 
> 赞同：4
> 
> 时间：2012-12-24T21:01:43.580
> 
> 标签：c#, .net, sql-server, console-application

我创建了 ac# 控制台应用程序，并尝试在 sql server 作业上运行它。

我将类型设置为“操作系统”，命令文本为：

```
"C:\Users\Admin\Documents\Visual Studio 2010\Projects\JobsApp\JobsApp\obj\x86\Release\JobsApp.exe" 
```

当我运行这项工作时，我得到了这个：

> *以用户身份执行：NT Service\SQLSERVERAGENT。未处理的异常：System.IO.FileLoadException：无法加载文件或程序集“FeedLibrary，Version=1.0.0.0，Culture=neutral，PublicKeyToken=null”或其依赖项之一。访问被拒绝。*

所以我让 SQLSERVERAGENT 访问 dll，但现在我得到了这个：

> *以用户身份执行：NT Service\SQLSERVERAGENT。无法为作业 0x3E702A92E3799D4995984DF6641604F2 的步骤 1 创建进程（原因：访问被拒绝）。步骤失败。*

我彻底糊涂了。是否有其他文件也需要访问？我究竟做错了什么？

我正在使用 SQL Server 2012 并使用 Visual C# Express 2010 创建了 exe。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-24T21:17:59.970

`Admin`您的应用程序位于 C:\Users\Admin 文件夹中（为什么？？？看来（谢天谢地）`SQLSERVERAGENT`没有以管理员权限运行。

# java - 用泛型签名覆盖抽象方法并调用它

> ID：14025672
> 
> 赞同：4
> 
> 时间：2012-12-24T21:02:39.083
> 
> 标签：java, generics

通用接口：

```
public interface Matcher<T> {
    public double getScore(T value1, T value2);
} 
```

两个实现类：

```
public StringMatcher implements Matcher<String> {
    public double getScore(String value1, String value2) {...}
}

public DateMatcher implements Matcher<Date> {
    public double getScore(Date value1, Date value2) {...}
} 
```

到目前为止一切都很好。替换或不是问题`T`。如下调用该方法也可以：`String``Date``getScore()`

```
Matcher<String> matcher = new StringMatcher();
matcher.getScore("hello", "world"); 
```

当我有一个`List`未知的`Matcher`并且我想使用该`getScore()`方法时，问题就开始了。

```
public void test() {
    List<Matcher<?>> list = new ArrayList<Matcher<?>>();
    list.add(new StringMatcher());
    list.add(new DateMatcher());

    for (Matcher<?> matcher : list) {
        Object value1;
        Object value2;
        //Setting values value1 & value2 appropriate to the current matcher
        matcher.getScore(value1, value2);
    }
} 
```

我不能打电话`matcher.getScore(value1, value2)`，因为它不能处理对象参数。在这一点上，我不知道如何解决这个问题。我想保留实现类的接口和签名及其具体类型。如果无法绕过类型转换或抛出异常，那也没关系。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-24T21:15:38.630

您在想要类型安全和不想要类型安全之间提出了冲突，因此您只需要在它们之间做出决定。`getScore`使用参数调用`Object`显然是类型不安全的。

现在，如果您只是想要一个类型不安全的技巧来解决编译器/运行时错误，您可以将列表声明为`List<Matcher>`，这意味着您将从其中检索原始`Matcher`s，然后您将被允许传入`Object`s。不过，您**将**收到*未经检查的强制转换*编译器警告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-25T00:01:32.843

最好使用捕获助手，这样您就可以使用匹配器的参数类型（例如`T`），`value1`并且`value2`将被声明为该类型`T`。

```
private <T> double helper(Matcher<T> matcher) {
    T value1;
    T value2;
    //Setting values value1 & value2 appropriate to the current matcher
    return matcher.getScore(val1, val2);
}

public void test()
{
    List<Matcher<?>> list = new ArrayList<Matcher<?>>();
    list.add(new StringMatcher());
    list.add(new DateMatcher());

    for (Matcher<?> matcher : list) {
        helper(matcher);
    }
} 
```

# maven - 如何从同一目录中的自定义 xml 文件中引用 pom.xml 文件？

> ID：14025674
> 
> 赞同：-1
> 
> 时间：2012-12-24T21:02:47.077
> 
> 标签：maven, pom.xml

我有 2 个 pom.xml 文件：父 pom.xml 文件（称为 pomp.xml）和默认的 pom.xml 文件。

C:\pomp.xml:

```
 <project ....>
          <modelVersion>4.0.0</modelVersion>

          <groupId>com.mycompany.app</groupId>
          <artifactId>app</artifactId>
          <version>test</version>
          <packaging>pom</packaging>

            <modules>
              <module>my-app</module>
            </modules>
          </project> 
```

C:\my-app\pom.xml

```
 <project ...>
            <modelVersion>4.0.0</modelVersion>

            <groupId>com.mycompany.app</groupId>
            <artifactId>my-app</artifactId>
            <version>1.0</version>
            <packaging>jar</packaging>
            <dependencies>
              <dependency>
                <groupId>junit</groupId>
                <artifactId>junit</artifactId>
                <version>4.8.2</version>
                <scope>test</scope>
              </dependency>
            </dependencies>
          </project> 
```

如果我运行“mvn package -f pomp.xml”，上述工作。但是，如果我将 pomp.xml 移动到与 pom.xml 相同的目录，它就不起作用。

我想要完成的事情可能吗？如果是这样，如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T21:12:21.340

设置父级的相对路径

```
<parent>
   ...
   <relativePath>./pomp.xml</relativePath>
</parent> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T21:34:36.300

我找到了一种无需修改子 xml 文件的方法。我刚刚在模块下输入了一个 . 来表示当前目录。

# android - 如何通过放大和缩小和拖动在android中的图像上画一条线

> ID：14025675
> 
> 赞同：-1
> 
> 时间：2012-12-24T21:02:49.693
> 
> 标签：android

我正在研究一个概念，我必须在 SurfaceView 上画一条线，并希望根据图像移动拖动、放大和缩小以及移动该线。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T22:54:18.170

我会看一下 android API 中的 canvas、paint 和 path 类。

# c# - 在 C# 中使用 Web 服务将用户添加到 SharePoint 组对我不起作用

> ID：14025676
> 
> 赞同：2
> 
> 时间：2012-12-24T21:03:32.533
> 
> 标签：c#, web-services, sharepoint-2010

我有一个托管在远程服务器上的 SharePoint 2010 站点，我想使用 C# 从另一台计算机自动将用户添加到其中一个 SharePoint 组。我尝试过使用互联网上提到的网络服务，如下所示：

```
class Program
{
    static void Main(string[] args)
    {
        SPUserGroupRef.UserGroup usrGrpService = new SPUserGroupRef.UserGroup();
        System.Net.NetworkCredential netCred = new System.Net.NetworkCredential(<my username>, <my password>, <my domain name>);
        usrGrpService.Credentials = netCred;
        usrGrpService.AddUserToGroup(<group name>, <new user full name>, <domain\new user name>, <new user email address>, <notes>);
    }
} 
```

注意： 1\. SPUserGroupRef 是对 http:///_vti_bin/usergroup.asmx 的 Web 服务引用 2\. 上述代码中所有带尖括号的实体都是字符串。

Main 中的第 3 行代码执行良好，但第 4 行失败，并显示“抛出 Microsoft.SharePoint.SoapServer.SoapServerException 类型的异常”。我对 SharePoint 很陌生，所以我可能在这里遗漏了一些东西。有人可以帮我弄清楚如何解决这个问题，或者可能会建议另一种可能有效的方法（但请记住，我的 SharePoint 网站托管在远程服务器上，而不是我的本地计算机上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T03:51:20.600

你为什么不使用 Sharepoint 2010 客户端对象模型，我没有测试下面的代码，但它应该可以工作。

```
namespace ClientObjectModel 
{ 
class Program 
{ 
static void Main(string[] args) 
{ 
// Add a new user to a particular group 

string siteURL = "http://serverName:1111/sites/SPSiteDataQuery/"; 
ClientContext context = new ClientContext(siteURL); 
GroupCollection groupColl = context.Web.SiteGroups; 
Group group = groupColl.GetById(7); 
UserCreationInformation userCreationInfo = new UserCreationInformation(); 
userCreationInfo.Email = ""; 
userCreationInfo.LoginName = @"DomainName\UserName"; 
userCreationInfo.Title = "SharePoint Developer"; 
User user = group.Users.Add(userCreationInfo); 
context.ExecuteQuery(); 
} 
} 
} 
```

Microsoft.SharePoint 和 Microsoft.SharePoint.Client 让我知道它是否有效？

# android - 按钮在 AVD/图形布局和实际手机上的显示不同

> ID：14025677
> 
> 赞同：1
> 
> 时间：2012-12-24T21:03:59.083
> 
> 标签：android, android-layout, android-button

我修改了我的按钮，使其看起来像一个微调器。在 AVD 和图形布局上，它看起来与微调器完全一样，但在我的手机上却完全不同。

AVD 上的按钮：

![在此处输入图像描述](../Images/19f63f1e6cb58f31578dc5c8951c99da.png)

我手机上的按钮：![在此处输入图像描述](../Images/0923a7345c6f183f6c41b91c504b90fc.png)

有人可以告诉我为什么会这样吗？

这是 XML 中的按钮布局：

```
<Button
    android:id="@+id/datebutton"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_marginTop="20dp"
    android:hint="@string/datebuttontxt"
    android:onClick="datepicker"
    android:gravity="center"
    style="@android:style/Widget.DeviceDefault.Light.Spinner" /> 
```

将按钮背景更改为不可见无济于事。 **另外**，如果我使用实际的微调器，它会正确显示，就像它在 AVD 上显示的那样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T21:45:30.570

`Widget.DeviceDefault.X`样式在不同设备之间变化，使用`@android:style/Widget.Holo.X`样式来获得一致的外观和感觉。

在你的情况下：

```
@android:style/Widget.Holo.Light.Spinner 
```

# c - 猜词：I/OC逻辑错误

> ID：14025679
> 
> 赞同：0
> 
> 时间：2012-12-24T21:04:51.447
> 
> 标签：c, string, io, fgets

很简单的程序：

```
int main (void)
    {
    int i = 0, length=0;
    char password[] = SECRET;
    char guess[10];

    for (i=0; i<3; i++){
        printf( "Enter the password: " );
        fgets (guess, 10, stdin );
        length=strlen(guess);
        guess[length]='\0';
        if(strcmp( guess, password ) == 0 ){
          printf("\aYou got it right!\n" );
          return 0;
          }
          else printf("You wrote %s Incorrect guess\n\n", guess);
    }
    puts("Sorry, you're all out of guesses");

    return 0;

} 
```

但它不起作用。

即使在我可以让程序说的奇怪情况下：“你猜是'黑色'。对不起，密码是'黑色'” 认为某些隐藏字符，空格，垃圾信息或其他任何东西可能存在问题字符串比较，但我似乎找不到它是什么！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-24T21:08:41.020

如果您学习使用调试器，您可能会看到返回的字符串`fgets()`包含换行符，这与您比较的字符串不匹配。

这段代码有什么意义：

```
length=strlen(guess);
guess[length]='/0'; 
```

首先，我只能假设您的意思是`\0`而不是`/0`. 其次，`strlen()`通过定位空终止符来工作。那么找到终止符然后在同一位置编写终止符有什么意义呢？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T21:59:36.003

而不是制作：

```
 length = strlen(guess);
 guess[length]='\0'; 
```

你应该这样做：

```
char *s = strchr(guess, '\n');
if (s) {  
    // new line is found  
    *s = 0;  
} else {  
    // user has exceeded max chars  
    guess[sizeof(guess) - 1] = 0;  
} 
```

我建议您使用 strncmp 而不是 strcmp 以避免缓冲区溢出攻击。

# android - 从后台服务调用 SmsReceiver

> ID：14025680
> 
> 赞同：1
> 
> 时间：2012-12-24T21:04:53.640
> 
> 标签：android, sms, broadcastreceiver, android-service

我想问个问题。
我制作了一个启动和停止后台服务的按钮。
我开设了一个`SmsReceiver`阅读传入短信的课程。
所以我想在服务开始时调用`Sms BroadcastReceiver`.
任何想法或任何其他想法如何阅读带有后台服务的短信？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T23:20:03.020

如果您已经可以`SmsReceiver`正常工作，您需要做的就是从 . 注册它。要`Service`做到这一点，您需要覆盖`Service`.`onCreate()`

您的服务应如下所示：

```
public class SmsService extends Service
{
  private SmsReceiver receiver; //global so we can unregister it when the time comes.
  public void onCreate ()
  {
    super.onCreate ();//call to super
    //make a new intent filter so that all incoming SMS get to you as well
    IntentFilter smsFilter = new IntentFilter("android.provider.Telephony.SMS_RECEIVED");
    receiver = new SmsReceiver(); //make a new SmsReceiver
    registerReceiver(receiver, smsFilter); //register the Receiver
  }

  public void onDestroy ()
  {
    unregisterReceiver (receiver); //unregisters the Receiver if Service is killed
    super.onDestroy();
  }
} 
```

在清单中，请务必包含必要的短信权限，并记得`Service`在清单中声明。

```
<service android:name=".SmsService" >
</service> 
```

# ios - ios 6：UITextField 中的 UIDatePicker

> ID：14025682
> 
> 赞同：4
> 
> 时间：2012-12-24T21:05:30.597
> 
> 标签：ios, ios6, datepicker, uitextfield

我在将日期选择器与文本字段连接时遇到问题。我已经尝试了 stackoverflow 的所有解决方案，但它们在 ios 6 中不起作用。你能描述一下如何制作吗，我想点击文本字段并通过 datepicker 选择日期。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-15T13:01:57.993

您应该使用您的`inputView`属性`UITextField`使选择器代替键盘显示。然后，iOS6 将为您处理所有事情（使用动画而不是键盘显示选取器等）。

*注意：您可能还想添加一些`inputAccessoryView`（通常`UIToolBar`带有一些“确定”按钮）以使用户能够关闭选择器（当然`IBAction`，您的“确定”按钮只会要求`[textField resignFirstResponder]`发生这种情况）因为`UIDatePicker`没有任何按钮来验证您的输入（而键盘有它的“返回键”）*

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-12-24T21:20:14.387

```
#import "TextfieldwithDatepickerViewController.h"

UIActionSheet *pickerViewPopup;

@implementation TextfieldwithDatepickerViewController
- (void)textFieldDidBeginEditing:(UITextField *)aTextField{  
    [aTextField resignFirstResponder];  

    pickerViewPopup = [[UIActionSheet alloc] initWithTitle:nil delegate:self cancelButtonTitle:nil destructiveButtonTitle:nil otherButtonTitles:nil];  

    UIDatePicker *pickerView = [[UIDatePicker alloc] initWithFrame:CGRectMake(0, 44, 0, 0)];  
    pickerView.datePickerMode = UIDatePickerModeDate;  
    pickerView.hidden = NO;  
    pickerView.date = [NSDate date];  

    UIToolbar *pickerToolbar = [[UIToolbar alloc] initWithFrame:CGRectMake(0, 0, 320, 44)];  
    pickerToolbar.barStyle = UIBarStyleBlackOpaque;  
    [pickerToolbar sizeToFit];  

    NSMutableArray *barItems = [[NSMutableArray alloc] init];  

    UIBarButtonItem *flexSpace = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemFlexibleSpace target:self action:nil];  
    [barItems addObject:flexSpace];  

    UIBarButtonItem *doneBtn = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemDone target:self action:@selector(doneButtonPressed:)];  
    [barItems addObject:doneBtn];  

    UIBarButtonItem *cancelBtn = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemCancel target:self action:@selector(cancelButtonPressed:)];  
    [barItems addObject:cancelBtn];  

    [pickerToolbar setItems:barItems animated:YES];  

    [pickerViewPopup addSubview:pickerToolbar];  
    [pickerViewPopup addSubview:pickerView];  
    [pickerViewPopup showInView:self.view];  
    [pickerViewPopup setBounds:CGRectMake(0,0,320, 464)];  
}  

-(void)doneButtonPressed:(id)sender{  
    //Do something here here with the value selected using [pickerView date] to get that value  

    [pickerViewPopup dismissWithClickedButtonIndex:1 animated:YES];  
}  

-(void)cancelButtonPressed:(id)sender{  
    [pickerViewPopup dismissWithClickedButtonIndex:1 animated:YES];  
} 
```

# entity-framework - 无法让实体框架连接

> ID：14025685
> 
> 赞同：1
> 
> 时间：2012-12-24T21:06:22.023
> 
> 标签：entity-framework, asp.net-mvc-4

我收到以下错误：

> *指定的命名连接在配置中未找到，不打算与 EntityClient 提供程序一起使用，或者无效。*

我刚刚创建了我的第一个 EF 项目。这是一个 MVC 应用程序，我在 MVC 项目中添加了实体模型。我还添加了一个 DataAccess 类和一个使用 NUnit 运行测试的类。最后，我将添加一个引用 DataAccess 类的服务类。所以，代码目前看起来像这样（我只是想进行一个测试来证明 EF 正在做它的事情）：

*   Text Fixture 调用 DataAccess 类
*   DataAccess 类调用实体框架
*   实体框架访问本地数据库

目前，我只是想从一张表中返回所有行/一列。请记住，所有这些文件都在一个项目中。我读过很多书，这个问题源于多个项目，但这似乎不适用于我的情况。我已经检查了“主要”web.config 文件。连接字符串看起来没问题。我也将相同的配置部分（即connectionStrings）复制到特定于调试的配置文件中，但这并没有什么不同。任何想法为什么我会看到这个错误？

谢谢，杰

![解决方案树的快照](../Images/f3f69506f3f72313f820b607cacae534.png)

**连接字符串：**

这是创建实体访问文件时对话框中的连接字符串（数据源是两个字符串中的句点[即本地主机]）：

> metadata=res:// */EntityDataModel.csdl|res://* /EntityDataModel.ssdl|res://*/EntityDataModel.msl;provider=System.Data.SqlClient;provider connection string="Data Source=.;初始目录=URIntake;集成安全=真"

这是来自 web.config 文件的连接字符串。出于所有实际目的，它们看起来是一样的：

> metadata=res:// */EntityDataModel.csdl|res://* /EntityDataModel.ssdl|res://*/EntityDataModel.msl;provider=System.Data.SqlClient;provider connection string="data source=.;初始目录=URIntake;集成安全=True;multipleactiveresultsets=True;App=EntityFramework"

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T10:10:23.087

**微软 Zlatko Michailov**说，

> app.config 不在 exe 所在的二进制目录中。请执行以下操作：
> 
> 1.  目视验证具有预期内容的 app.config 是否在编译 exe 的目录中。（在项目根目录中存在是不够的。）
>     
>     
> 2.  在您的应用程序中使用 System.Configuration.ConfigurationManager 来检查您的 exe 正在使用的 app.config 的内容。
>     
>     
> 
> 我也在查看连接字符串的内容，我可以说它可能无法在多项目环境中工作（除非您在每个项目中都复制了 EDM）。
> 
> 原因是“。” 解析为加载 exe 的目录。如果你想重复使用相同的 EDM，你至少必须在路径中后退几步，然后导航到 EDM 所在的项目，例如“......\Proj1\AdventureWorksModel”。
> 
> 此外，您可以考虑使用 |DataDirectory| 宏 - 当您加载 AppDomain 时，您可以设置 |DataDirectory| 指向 EDM 所在的确切目录，然后在连接字符串中使用该目录，例如“|DataDirectory|\AdventureWorksModel”。
> 
> 如果您正在处理 ASP.NET 项目，则可以使用“~”来表示项目根目录。在后一种情况下，您不能引用项目层次结构之外的模型。

欲了解更多信息，[**请点击此处**](http://social.msdn.microsoft.com/Forums/en/adodotnetentityframework/thread/f5904b4d-b2f8-421e-90de-339f93959533)

**更新 1：**

在这里您可以尝试以下提到的步骤

1.  清除**web.config**文件中的**连接字符串内容**，如下所示

     **![在此处输入图像描述](../Images/50b1d215528a0ed705a2d43b3c3d95fc.png)** 
***   然后从您的项目中删除您的***.edmx**文件

    *   **像下面一样重新创建**它（示例一）。不要忘记**勾选“将 web.config 中的实体连接设置保存为：”**** 

 **![在此处输入图像描述](../Images/f38e0aeb1655029ae09a4f566e8f6790.png)

**最后一步：**之后转到**web.config 文件**并检查您的连接字符串是否与上述步骤中**“实体连接字符串：”**上显示**的完全相同**（我在上图中的红色标记上显示了它）。

 **我希望这对你有帮助。****

# vb6 - 如何使用 DAO 将列添加到 FoxPro 文件

> ID：14025688
> 
> 赞同：0
> 
> 时间：2012-12-24T21:06:50.617
> 
> 标签：vb6, dao, foxpro

我需要在 VB6 中使用 DAO 将一些列添加到 FoxPro 2.6 DBF 文件中。

如果数据在 .MDB 文件中，我知道这会起作用。这是我用于 .MDB 的代码片段：

```
Set tdfCoParms = mDBParms.TableDefs(CoParms)
tdfCoParms.Fields.Append tdfCoParms.CreateField("CoName", dbText, 30) 
```

我不确定这是否适用于 FoxPro。（我没试过）

这可能吗？有一个可能的替代方案 - 我知道这会起作用，但不是那么方便 - 从正确结构的空表开始，然后使用来自此的 SELECT 的 INSERT 复制现有填充文件中的记录。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-25T14:53:56.577

谢谢@wqw，因为您的解决方案确实有效。

这是我的第一个替代方案，它有效：

1.  创建一个包含所需列的空文件/表。
2.  将此文件复制到“test.dbf”。
3.  将填充数据文件“链接”中的记录插入其中。

```
 Dim dbsWork As Database
    Dim qrd As DAO.QueryDef
    Dim szSqlString As String

    Set dbsWork = OpenDatabase(szWorkDir, False, False, "FoxPro 2.5")
    Dim szFieldList As String
    szFieldList = "field1, field2, field3"
    szSqlString = "INSERT INTO test SELECT " & szFieldList & " FROM link"
    Set qrd = dbsWork.CreateQueryDef("", szSqlString)
    qrd.Execute

    Set qrd = Nothing
    Set dbsWork = Nothing 
```

 `But the following based on @wqw's suggestion is much better, as no predefined file is required` 

```
Private Sub Test1()

    Dim dbsWork As Database
    Dim qrd As DAO.QueryDef
    Dim szSqlString As String

    Set dbsWork = OpenDatabase(MyDataBasPath, False, False, "FoxPro 2.5")
    Dim szFieldList As String
    szSqlString = "ALTER TABLE work.dbf ADD COLUMN fred VARCHAR(30)"
    Set qrd = dbsWork.CreateQueryDef("", szSqlString)
    qrd.Execute

    Set qrd = Nothing
    Set dbsWork = Nothing

End Sub 
```

# android - 如何在 Android 应用程序中从内存中卸载图像

> ID：14025690
> 
> 赞同：1
> 
> 时间：2012-12-24T21:07:04.933
> 
> 标签：android, android-resources, android-memory

在 Android 应用程序中，（对其他一些问题的回答表明）图像资源在首次使用时被加载到内存中，例如当我调用`ImageView.setImageResource(myResId)`.

如何强制从内存中卸载图像资源，以控制我的内存占用？

我有一个应用程序，一个带有 viewpager 的活动：资源中有许多图像，每个视图页面一个图像。创建页面时加载图像，我想在用户翻转到另一个页面时将其卸载。如果用户回来，图像可以再次加载。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T23:20:55.493

您不想专门从内存中卸载图像。最好的方法是在完成对象后调用 recycle()，并持有对该对象的弱引用。为此，您可以执行以下操作：

```
ImageView imageView = (ImageView) findViewById(R.id.imageview);
WeakReference<ImageView> imageViewRef = new WeakReference<ImageView>(imageView); 
```

每当您想访问图像时，都可以使用：

```
imageViewRef.get() 
```

这样，当应用程序需要更多内存时，它可以从内存中删除图像，因为它没有硬引用。

# asp.net - 如何在asp.net MVC 3中实现复杂模型的“编辑”方法

> ID：14025693
> 
> 赞同：1
> 
> 时间：2012-12-24T21:07:28.493
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3

在我的 mvc 3 网络商店应用程序中，我有这个模型：Items、Products、Shipping、Users 表，其中 1 个 Item 包含 1 个 Product、1 个 User 和 1 个 Shipping。我需要以某种方式创建和编辑项目。通过创建没有太多问题，因为我可以将“要填充的字段”作为参数传递给 Crete(Post) 方法。编辑存在一个问题 - 发生空引用异常。这是我的代码：（
控制器）：
我将模型（项目类型）作为参数传递给 Edit Post 方法并获取产品和运输，我希望），我填充了值。

```
 [HttpGet]
    public ViewResult Edit(int itemId)
    {
        Item target = _itemsRepository.GetItem(itemId);

        return View(target);
    }

    [HttpPost]
    public ActionResult Edit(Item model)
    {
        Product p = model.Product;
        Shipping s = model.Shipping;

        // here goes some validation stuff

        if (ModelState.IsValid)
        {
            _productRepository.UpdateProduct(p);
            _shippingRepository.UpdateShipping(s);
            return RedirectToAction("Content");
        }
        return View();
    } 
```

强类型视图（我填写表格的地方）：

```
@model WebStore.WebStoreModels.Item

@using (Html.BeginForm())
{
@Html.ValidationSummary(true)

<fieldset>
    <legend>Product</legend>
    @Html.HiddenFor(i => i.ItemId)

    <p>Name: </p>
    <p>
        @Html.EditorFor(i => i.Product.Name)
        @Html.ValidationMessageFor(i => i.Product.Name)
    </p>
   // and so on
</fieldset>

<fieldset>
    <legend>Shipping</legend>

    <p>Cost: </p>
    <p>
        @Html.EditorFor(i => i.Shipping.Cost)
        @Html.ValidationMessageFor(i => i.Shipping.Cost)
    </p>        
    // so on
</fieldset> 
<p>
    <input type="submit" value="Save"/>
</p> 
```

}

当我填写表格并单击“安全”按钮时，NullReferenceException 发生在 UpdateProduct() 方法的 ProductRepository 类中：

```
public class ProductRepository : IProductRepository
{
    private WebStoreDataContext _dataContext;

    public ProductRepository(WebStoreDataContext dataContext)
    {
        _dataContext = dataContext;
    }

    public Product GetProduct(int productId)
    {
        return _dataContext.Products.SingleOrDefault(p => p.ProductId == productId);
    }
    public void UpdateProduct(Product p)
    {
        var dbProduct = GetProduct(p.ProductId);
        dbProduct.Name = p.Name;   // here the exception occures
        dbProduct.Description = p.Description;
        dbProduct.Price = p.Price;
        dbProduct.Category = p.Category;
        dbProduct.SubCategory = p.SubCategory;
        _dataContext.SubmitChanges();
    } 
```

好像我不能使用这个作业：

```
Product p = model.Product; 
```

我也试过：（在视图中，然后在 Edit(Post) 方法中将其分配给 Product）

```
TempData["product"] = @Model.Product; 
```

还有：（在视图中）

```
@Html.Hidden("product", @Model.Product) 
```

并将其作为参数传递给 Edit(Post) 方法：

```
[HttpGet]
public ViewResult Edit(Product p, Shipping s) 
```

我认为问题与模型有关。
任何帮助都会很棒，对不起这么多代码）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T23:06:30.163

您需要在 View 的表单内添加隐藏的 ProductId 输入：

```
@using (Html.BeginForm())
{
    @Html.HiddenFor(i => i.Product.ProductId)
    ...
} 
```

您需要此行的原因是，当您提交表单时，模型绑定器会查看每个输入（包括隐藏输入）并将它们绑定到`Item model`您传递的`[HttpPost]`操作的属性。之前，当您没有此行时，仅填充了以下属性：

*   项目.ItemId
*   项目.产品.名称
*   货品.运费.成本

您的模型没有关于 Item.Product.ProductId 值的信息。这个属性是`int`，这意味着提交表单时它变为等于 0。在您的`_productRepository.UpdateProduct(p);`方法中，您试图通过 Id 获取产品，显然它找不到 id = 0 的产品，这就是为什么此调用返回`null`导致下一行出现空引用异常的原因。

# javascript - 在 iOS 上拖放 Javascript

> ID：14025694
> 
> 赞同：1
> 
> 时间：2012-12-24T21:08:04.463
> 
> 标签：javascript, html, drag-and-drop, ios6

大家好，我的拖放功能有以下代码。但是我需要调整它以在 iOS 上工作。作为 Javascript 的新手，我不太确定如何调整我已经阅读过的代码。

我的代码如下：

```
 function allowDrop(ev){
                            ev.preventDefault();
                    }

                    function drag(ev){
                            var drag = ev.dataTransfer.setData("content", ev.target.id);

                    }

                    function drop(ev){
                            ev.preventDefault();
                            var image= ev.dataTransfer.getData("content");
                          if ( image == ev.target.id) {
                            ev.target.appendChild(document.getElementById(image));
                            }
                          else {

                          }
                    } 
```

任何帮助都会很棒。我认为问题是我需要某种监听器来监听触摸事件？

# php - 如何在 XML 中插入 PHP 数组？

> ID：14025695
> 
> 赞同：0
> 
> 时间：2012-12-24T21:08:07.947
> 
> 标签：php, xml, arrays, foreach

大家好，我有一个小问题，我有一个这样的数组

```
$slike=array('1.jpg','2.jpg') 
```

另一个看起来像这样的 XML

```
<?xml version='1.0' encoding='UTF-8'?>
<settings>
<show_context_menu>yes</show_context_menu>
<hide_buttons_delay>2</hide_buttons_delay>
<thumbs_width>200</thumbs_width>
<horizontal_space_btween_buttons>0</horizontal_space_btween_buttons>
<buttons_margins>0</buttons_margins>
</settings> 
```

如何在该 XML 中插入 $slike，新的 XML 如下所示：

```
<?xml version='1.0' encoding='UTF-8'?>
<settings>
<show_context_menu>yes</show_context_menu>
<hide_buttons_delay>2</hide_buttons_delay>
<thumbs_width>200</thumbs_width>
<horizontal_space_btween_buttons>0</horizontal_space_btween_buttons>
<buttons_margins>0</buttons_margins>
<image>1.jpg</image>
<image>2.jpg</image>
</settings> 
```

提前 Txanks

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T22:24:11.977

不知道您确实遇到了哪个问题，但使用 XML 库非常简单，例如，即使在您的情况下使用 SimpleXML：

```
$slike = array('1.jpg','2.jpg');
$name = 'image';

$doc = new SimpleXMLElement($xml);
foreach($slike as $file) {
    $doc->addChild($name, $file);
}

echo $doc->asXML(); 
```

此`$xml`示例中的 xml 字符串来自您的问题。输出：

```
<?xml version="1.0" encoding="UTF-8"?>
<settings>
<show_context_menu>yes</show_context_menu>
<hide_buttons_delay>2</hide_buttons_delay>
<thumbs_width>200</thumbs_width>
<horizontal_space_btween_buttons>0</horizontal_space_btween_buttons>
<buttons_margins>0</buttons_margins>
<image>1.jpg</image><image>2.jpg</image></settings> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-25T11:29:34.520

[http://php.net/manual/en/book.simplexml.php](http://php.net/manual/en/book.simplexml.php)

对于您的示例，语法看起来像这样

```
<aaaa Version="1.0">
   <bbb>
     <cccc>
       <dddd Id="id:pass" />
       <eeee name="hearaman" age="24" />
     </cccc>
   </bbb>
</aaaa> 
```

```
 $xml = new SimpleXMLElement($xmlString);
    echo $xml->bbb->cccc->dddd['Id'];
    echo $xml->bbb->cccc->eeee['name'];
    // or...........
    foreach ($xml->bbb->cccc as $element) {
      foreach($element as $key => $val) {
       echo "{$key}: {$val}";
      }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-24T21:16:21.493

像这样的东西怎么样：

```
header("Content-Type: text/xml; charset=utf-8");  // added this line - that way the browser will render it as XML
$slike = array('1.jpg','2.jpg');

$xml = "<?xml version='1.0' encoding='UTF-8'?>
<settings>
<show_context_menu>yes</show_context_menu>
<hide_buttons_delay>2</hide_buttons_delay>
<thumbs_width>200</thumbs_width>
<horizontal_space_btween_buttons>0</horizontal_space_btween_buttons>
<buttons_margins>0</buttons_margins>";

foreach($slike as $s){
    $xml.= "<image>".$s."</image>"; // create a new <image> node for each image in array
}

$xml .= "</settings>";

print_r($xml); 
```

输出这个：

```
<?xml version='1.0' encoding='UTF-8'?>
<settings>
    <show_context_menu>yes</show_context_menu>
    <hide_buttons_delay>2</hide_buttons_delay>
    <thumbs_width>200</thumbs_width>
    <horizontal_space_btween_buttons>0</horizontal_space_btween_buttons>
    <buttons_margins>0</buttons_margins>
    <image>1.jpg</image>
    <image>2.jpg</image>
</settings> 
```

# jquery - jQuery - 使用 replaceWith 两次不起作用

> ID：14025696
> 
> 赞同：2
> 
> 时间：2012-12-24T21:08:14.733
> 
> 标签：jquery

我正在使用 jQuery 将 HTML 元素替换为另一个元素。第一次效果很好，但第二次就不行了。我不知道为什么它第二次不起作用。

有人知道吗？

这是问题的一个例子：http: [//jsfiddle.net/jfYLG/](http://jsfiddle.net/jfYLG/)

* * *

来自 jsfiddle 示例的代码：

```
<div class="blaat">
    <div>woot</div>
</div>

<button class="work" type="button">Work</button>

$(function() {
    $clone = $('.blaat').clone().addClass('test');

    $('.work').click(function() {
        $('.blaat').replaceWith($clone);
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T21:12:56.897

```
$(function() {
    $('.work').click(function() {
        $clone = $('.blaat').clone().addClass('test');
        $('.blaat').replaceWith($clone);
    });
}); 
```

# mysql - mysql，需要用随机日期更新列

> ID：14025698
> 
> 赞同：3
> 
> 时间：2012-12-24T21:08:35.670
> 
> 标签：mysql, sql

我的表中有一个名为 updated_date 的“时间戳”类型列。向表中添加列时，所有行都更新为相同的 updated_date。这不是一场灾难，因为我们仍在测试中，但它破坏了我们网站的功能（按更新日期的顺序显示）。

有没有办法可以将列中的所有 updated_date 值（但 id 低于 x）更改为某个随机日期（或增量日期）？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T21:23:07.677

这可能会解决您的问题：

```
UPDATE updated_table SET timestamp = FROM_UNIXTIME(1e9 + id) WHERE id < x; 
```

基本上它将日期设置为对应于 10 亿 + id 的 Unix 时间戳（1,000,000,000 个 unix 时间戳是 2001-09-08 21:46:40）。这样您就可以按 id 的顺序获得唯一的时间戳。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-24T21:24:34.167

嗯，你可以这样做

```
UPDATE table SET updated_time = NOW() WHERE id < x 
```

给定的 id 属于表

如果您想要过去的一些随机数据

```
UPDATE test2 SET update_time = NOW() - interval rand()*120 day - interval rand()*36000 second WHERE id < x 
```

根据您的需要进行调整

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-24T21:23:31.233

时间戳只是自纪元 (1970-01-01 00:00:01) 以来的秒数。如果您从基本时间戳开始，您可以从该数字开始添加随机秒数，并且您有随机日期。

# ruby-on-rails - 'bundle exec rake' 与 rake 有什么作用？

> ID：14025701
> 
> 赞同：27
> 
> 时间：2012-12-24T21:08:52.427
> 
> 标签：ruby-on-rails, ruby

做有什么区别：

```
bundle exec rake 
```

和

```
rake 
```

我看到人们两者都做，我从来没有`bundle`在我的命令之前做过，好奇这是什么原因？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-12-24T21:14:37.737

`bundle exec`在包的上下文中执行命令。该命令执行该命令，使所有`Gemfile`在 Ruby 程序中指定的 gem 可用。当您有许多应用程序使用不同版本的 gem 时非常有用。

请参阅文档以获取更多信息： http: [//gembundler.com/man/bundle-exec.1.html](http://gembundler.com/man/bundle-exec.1.html)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-12-24T21:17:14.800

`bundle exec`在 Bundler 环境中运行它之后的命令。因此，假设您在 Gemfile 中安装了 rake 0.9，但在 RubyGems 中安装了 rake 10。`bundle exec rake`将运行 rake 0.9 而不是 rake 10。

# ember.js - Ember.js 中的可枚举对象（键值映射）

> ID：14025706
> 
> 赞同：3
> 
> 时间：2012-12-24T21:09:10.023
> 
> 标签：ember.js, ember-data

Ember 中是否有支持 Ember.Array / Ember.Enumerable 的键值对象？

我想`{{#each}}`在我的 Handlebars 模板中迭代它们。

我的用例是显示来自服务器的任意 JSON（用户定义字段）（示例如下）。我可以从嵌套数组递归地创建视图（使用`each`助手），但我不能迭代一个对象。我的计划是找到（或编写）一个可以包装 JSON 对象并允许它们可枚举的对象。这样做的最佳方法是什么？

到目前为止，我的想法是将扩展/混合`Enumerable/Array/ArrayProxy/ObjectProxy`、将底层键值存储存储为`Ember.Array`以及添加一个`keys`字段来存储对象的键的组合。然后我可以使用`setUnknownProperty`and`unknownProperty`设置/获取基础值并保持`keys`同步。这种方法合理吗？

**来自服务器的 JSON 格式**

这是一个示例（用户记录他们自己的锻炼数据）。**请注意，这只是一个示例；格式是完全灵活的，所以我不能创建 Ember 数据模型来建模这些用户定义的字段**。总体而言，数据可以是任意复杂的 JSON（散列、数组、原语的任何嵌套程度）

```
{
   "bench_press":[
      {
         "weight":95,
         "repetitions":5,
         "tags":[
            "warmup"
         ]
      },
      {
         "weight":135,
         "repetitions":3,
         "tags":[
            "warmup"
         ]
      },
      {
         "weight":155,
         "repetitions":3,
         "tags":[
            "warmup"
         ]
      },
      {
         "weight":165,
         "repetitions":2,
         "tags":[
            "warmup"
         ]
      },
      {
         "weight":185,
         "repetitions":1,
         "tags":[
            "warmup"
         ]
      },
      {
         "weight":195,
         "repetitions":1,
         "tags":[
            "warmup",
            "overshoot"
         ]
      },
      {
         "weight":190,
         "repetitions":5,
         "tags":[

         ]
      },
      {
         "weight":190,
         "repetitions":5,
         "tags":[

         ]
      },
      {
         "weight":190,
         "repetitions":5,
         "tags":[

         ]
      },
      {
         "weight":190,
         "repetitions":3,
         "tags":[

         ]
      },
      {
         "weight":190,
         "repetitions":2,
         "tags":[
            "negatives"
         ]
      }
   ]
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T21:10:51.300

据我了解 Ember.js 的理念，声明性 Handlebars 模板足够保守，可以强调在模板中使用*更少的*逻辑。

在上述情况下，我建议您使用[ContainerView](http://emberjs.com/api/classes/Ember.ContainerView.html)提供 JSON 作为它的上下文。

# wordpress - Bitnami Stack：在域根目录的自己目录中访问 wordpress 安装

> ID：14025707
> 
> 赞同：0
> 
> 时间：2012-12-24T21:09:39.260
> 
> 标签：wordpress, subdirectory, bitnami

请多多包涵！！

我正在使用本教程[Giving Wordpress Its Own Directory](http://codex.wordpress.org/Giving_WordPress_Its_Own_Directory)（使用预先存在的子目录安装部分）通过使用 example.com 而不是 example.com/wordpress 来启动 wordpress（安装在名为 wordpress 的子文件夹中）。

现在它说将 index.php 复制到您的根文件夹并相应地更改 wp-blog-header.php 的相对路径，现在文件夹结构有点复杂，因此我附上了一张图片![这是图片](../Images/e7f225a2e308f6dcee3df0fab80113be.png)

现在要访问站点根目录，我要访问 example.com（明显），但要访问 wordpress，我必须访问 example.com/wordpress（如果有人想知道我为什么使用 bitnami wordpress stack AMI，因此一切都是预先配置的）

现在根据教程，我应该将 index.php 从 wordpress 根目录复制到站点根目录，并相应地更改 wp-blog-header.php 的相对位置。当 index.php 在同一目录中时，函数为`require('./wp-blog-header.php')`. 现在这个位置要改了

我已经尝试了所有我能想到的三个选项（我猜）

1) ../apps/wordpress/htdocs/wp-blog-header.php

2)./wordpress/htdocs/wp-blog-header.php

3)wordpress/htdocs/wp-blog-header.php

编辑：它是亚马逊 aws 上的 bitmani wordpress stack ami，这是我认为首先存在问题的原因。

但是访问域根目录会导致服务器错误。有什么建议吗？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T21:22:33.827

尝试`require ( $_SERVER['DOCUMENT_ROOT'] . '/wherever/wp-blog-header.php/is/located`它应该找到它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T22:08:13.293

这是答案[http://wiki.bitnami.org/Components/Apache#How_to_change_the_URL.3f](http://wiki.bitnami.org/Components/Apache#How_to_change_the_URL.3f) 这是因为 bitnami 而不是 wordpress 的错误

# c++ - 如何创建 DAWG？

> ID：14025709
> 
> 赞同：0
> 
> 时间：2012-12-24T21:09:57.557
> 
> 标签：c++, data-structures

如何创建**[DAWG](http://en.wikipedia.org/wiki/DAWG)**？我发现有两种方法；一个是将 trie 转换为 dawg，另一个是立即创建一个新的 DAWG？哪一个最容易？您能否详细说明两者并提供一些链接？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-24T21:14:31.433

考虑 DAWG 的一种方法是作为单词列表中所有单词的最低状态 DFA。因此，构建 DAWG 的传统算法如下：

1.  首先为单词集合构建一个 trie。
2.  将一个新节点添加到特里树中，所有输入的边都从自身到自身。
3.  对于 trie 中的每个缺失字母转换，添加从开始节点到这个新死节点的转换。
4.  （此时，您现在有一个（可能不是最小的）单词集的**[DFA](http://en.wikipedia.org/wiki/Deterministic_finite_automaton)**。）
5.  使用**[DFA 状态最小化的标准算法来最小化 DFA](http://en.wikipedia.org/wiki/DFA_minimization)**。

完成此操作后，您将得到一个 DAWG，用于您感兴趣的一组单词。

该算法的运行时间如下。构造初始 DFA 可以通过为所有原始单词构造一个 trie 来完成（这需要时间 O(n)，其中 n 是所有输入字符串中的字符总数），然后填充缺失的转换（这需要时间O(n|Σ|)，其中 |Σ| 是字母表中不同字符的数量）。从那里，最小化算法在时间 O(n ² |Σ|) 中运行。这意味着算法的整体运行时间为 O(n ² |Σ|)。

据我所知，没有直接的算法可用于增量构建 DAWG。通常，只有在您已经预先拥有所有单词的情况下，您才会为一组单词构建 DAWG。直观地说，这是正确的，因为插入一个在 DAWG 中已经存在一些后缀的新词可能需要对 DAWG 进行大量重组，以使某些旧的接受状态不接受，反之亦然。从理论上讲，这是因为插入一个新词可能会极大地改变 DFA 的可区分性关系的等价类，这可能需要对 DFA 的结构进行重大更改。

希望这可以帮助！

# winforms - infragistics winforms 控件无法扩展

> ID：14025714
> 
> 赞同：1
> 
> 时间：2012-12-24T21:10:23.900
> 
> 标签：winforms, .net-4.0, infragistics

我正在使用 Infragistics2.Win.v10.3.Design 中的一些控件。我知道这不是最新版本，但我们还没有迁移到更高版本。

问题是我有一个 Windows 窗体控件，在该控件上我有几个 UltraCalendarCombo 控件。当我将容器控件的 AutoScaleMode 更改为 Font 或 Dpi 时，它们不会缩放并且不会改变它们的位置。我应该用什么来缩放它们？实际上，这些控件中的字体可以很好地缩放。我应该手动调整它们的大小吗？

或者这个库中的控件可能是用于 .NET 1.1 FW 的，所以这就是它们不支持其父控件的 AutoScaleMode 属性的原因？我们的应用程序是为 .NET 4.0 FW 编译的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T21:31:41.927

我用 UserControl 对此进行了测试，但没有重现该行为。如果您创建的控件派生自 ContainerControl，那么您应该在 .NET 2.0 或更高版本中自动获得此行为。有关更多详细信息，请参阅[Windows 窗体中的自动缩放。](http://msdn.microsoft.com/en-us/library/ms229605%28v=vs.100%29.aspx)

# java - JavaFX：尝试通过 MediaPlayer 类播放 mp3 文件时未初始化“工具包”

> ID：14025718
> 
> 赞同：30
> 
> 时间：2012-12-24T21:10:49.153
> 
> 标签：java, media-player, javafx-2

我正在尝试使用以下内容在我的程序后台播放一个简单的 mp3：

```
Media med = new Media(getClass().getResource("intro.mp3").toExternalForm());
MediaPlayer mPlayer = new MediaPlayer(med);
mPlayer.play(); 
```

intro.mp3 文件与其他 .class 文件一起放在我的包的 bin 文件夹中。

问题是我的程序以以下方式终止：

```
Exception in thread "main" java.lang.IllegalStateException: Toolkit not initialized 
```

完整的终止日志是：

```
Device "Intel(R) HD Graphics Family" (\\.\DISPLAY1) initialization failed : 
WARNING: bad driver version detected, device disabled. Please update your driver to at least version 8.15.10.2302

Exception in thread "main" java.lang.IllegalStateException: Toolkit not initialized
    at com.sun.javafx.application.PlatformImpl.runLater(PlatformImpl.java:153)
    at com.sun.javafx.application.PlatformImpl.runLater(PlatformImpl.java:148)
    at javafx.application.Platform.runLater(Platform.java:52)
    at javafx.scene.media.MediaPlayer.init(MediaPlayer.java:450)
    at javafx.scene.media.MediaPlayer.<init>(MediaPlayer.java:365)
    at PokerApp.<init>(PokerApp.java:33)
    at PokerApp.main(PokerApp.java:105) 
```

根据问题的原因，有人有任何想法吗？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-12-24T21:52:03.600

`JavaFX`在启动时执行“隐藏”初始化。运行`MediaPlayer`不会触发初始化。

触发它的最简单方法是：

*   已`Application.launch()`执行
*   有`Application`基于由 fx [ant 任务](http://docs.oracle.com/javafx/2/deployment/javafx_ant_task_reference.htm)打包的 jar 运行的程序（例如，从 Netbeans JavaFX 项目构建）
*   已启动[JFXPanel](http://docs.oracle.com/javafx/2/api/javafx/embed/swing/JFXPanel.html)
*   调用[`Platform.startup(Runnable)`](https://docs.oracle.com/javase/10/docs/api/javafx/application/Platform.html#startup(java.lang.Runnable))（Java 9+）

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2017-04-07T11:49:58.347

为了避免初始化异常，您必须调用**Application.launch()**方法或简单地**实例化一个新的 JFXPanel() 类** **（即使它不用于任何事情）。**这将在应用程序启动时启动**JavaFxRuntime**

要实例化 JFXPanel，请在代码中添加以下行

```
 final JFXPanel fxPanel = new JFXPanel(); 
```

导入以下包

```
import javafx.embed.swing.JFXPanel; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-08-10T20:59:40.747

还有一种方法可以显式初始化工具包，方法是调用： `com.sun.javafx.application.PlatformImpl#startup(Runnable)`

由于使用了 *Impl，有点 hacky，但如果您不想使用`Application`或`JXFPanel`出于某种原因，它很有用。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-06-27T13:57:33.877

见[http://www.programcreek.com/java-api-examples/index.php?api=com.sun.javafx.application.PlatformImpl](http://www.programcreek.com/java-api-examples/index.php?api=com.sun.javafx.application.PlatformImpl)

```
com.sun.javafx.application.PlatformImpl.startup(()->{}); 
```

# mysql - Ruby/Rails 使用 MySQL 中的计算列计算范围内的对象

> ID：14025720
> 
> 赞同：2
> 
> 时间：2012-12-24T21:11:56.457
> 
> 标签：mysql, ruby-on-rails, ruby, scope

我不知道如何适当地计算范围内的对象。

对于此示例，我们假设产品（“skus”）具有 lat 和 lng，用户也是如此。

我有一个有效的 find_by_sql 示例：

```
 def self.with_max_distance(user, distance)
    Sku.find_by_sql(
    <<-eos
      SELECT *,
      ( 3959 * acos( cos( radians(#{user.lat}) ) * cos( radians( skus.lat ) )
      * cos( radians(skus.lng) - radians(#{user.lng})) + sin(radians(#{user.lat}))
      * sin( radians(skus.lat)))) AS distance
      FROM skus
      HAVING distance < #{distance}
    eos
    )
  end 
```

我能够使以下范围部分工作：

```
 scope :scope_with_max_distance, lambda { |user, distance|
    { :select => "skus.*, ( 3959 * acos( cos( radians(#{user.lat}) ) * cos( radians( skus.lat ) ) * cos( radians(skus.lng) - radians(#{user.lng})) + sin(radians(#{user.lat})) * sin( radians(skus.lat)))) AS distance",
      :having => "distance < #{distance}"
    }
  } 
```

范围似乎可以正确获取对象，虽然我没有对其进行广泛测试，但如果我将它与其他范围链接起来，它似乎可以工作。

但是，我无法处理`count()`这些对象，这真的很烦人。我知道我可以使用`length()`，但它不适用于 count 的事实让我想知道是否有更好的方法来做到这一点。

```
1.9.3p125 :048 > Sku.scope_with_max_distance(User.first, 50).limit(10).count
  User Load (0.5ms)  SELECT `users`.* FROM `users` LIMIT 1
   (0.6ms)  SELECT COUNT(count_column) FROM (SELECT 1 AS count_column FROM `skus` HAVING distance < 50 LIMIT 10) subquery_for_count 
ActiveRecord::StatementInvalid: Mysql2::Error: Unknown column 'distance' in 'having clause': SELECT COUNT(count_column) FROM (SELECT  1 AS count_column FROM `skus`  HAVING distance < 50 LIMIT 10) subquery_for_count 
```

我真的很感激任何建议或想法 - 我尝试了许多不同的方法，但无法找到一种完全有效的方法。如果问题需要更多澄清，请告诉我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-24T21:33:37.360

`count`将用`select`尽可能有效地构建计数所需的简单元素替换您的。它不会检查其他约束以确保 SQL 有效。您可以将`distance`别名替换为`having`您为解决此问题而选择的公式。另外，我建议您替换`having`为`where`以避免不可移植的隐式分组：

```
scope :scope_with_max_distance, lambda { |user, distance|
  distance_formula = "(3959 * acos( cos( radians(#{user.lat}) ) * cos( radians( skus.lat ) ) * cos( radians(skus.lng) - radians(#{user.lng})) + sin(radians(#{user.lat})) * sin( radians(skus.lat))))"
  { :select => "skus.*, #{distance_formula} AS distance",
    :where => "#{distance_formula} < #{distance}"
  }
} 
```

最后一件事，你在这`count`之后打电话`limit(10)`意味着 count 永远不会大于 10。这本质上不是错误的，但我不确定这是你的意思。

# php - 理解为什么 echo 在 php 类函数中不起作用

> ID：14025721
> 
> 赞同：3
> 
> 时间：2012-12-24T21:12:03.713
> 
> 标签：php, class, function, scope

我正在尝试调试一个类并使用 print_r 和 echo 在脚本进行时查看变量。

但是由于某种原因，我似乎无法从函数中获得任何输出，我已将函数声明为 public，但无法使用 print、echo 或 print_r 获得任何输出。

我在这里误解了一些基本的东西 - 任何人都可以帮忙。

这是我的代码的一些摘录：

此调用来自类中的公共函数：

```
$xml_data = $this->convert_to_xml($rs); 
```

该方法如下所示：

```
public function convert_to_xml($rs) {
    echo "test variable:";
    print_r($rs);
} 
```

print_r 纯粹是为了测试正在传递的值，但我根本没有得到任何输出

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T21:25:50.907

如果要返回值以将其分配给`$xml_data`，则必须实际返回它而不是回显它。`echo`将值直接发送到输出流，同时`return`从函数返回值，以便可以将其分配给变量或用于其他表达式：

```
public function convert_to_xml($rs) {
     return "test variable:";
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T21:33:11.287

如果您希望 echo/print_r 向 php 的 stdout 流输出某些内容（以便您在 Web 浏览器中看到它），但由于某种原因您实际上并没有看到它，那么很可能您打开了输出缓冲。

尝试

```
public function convert_to_xml($rs) {
    while (ob_get_level()) 
        ob_end_flush();
     echo "test variable:";
print_r($rs);
} 
```

您现在应该看到输出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-24T21:32:48.600

尝试这样的事情（添加一些 if else 语句）：

```
public function convert_to_xml($rs = NULL /* this is by default */ ) {
     if(isset($rs) && !empty($rs)){
        var_dump($rs);
     } else {
        echo 'Variable not passed or empty';
     }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-24T22:40:08.457

感谢您的输入。我已经完成并设法按预期获得了 print_r 输出 - 那部分是一个简单的语法错误......

我认为缺少的另一部分是变量的输出，它是一个 xml 字符串。这没有显示在页面上，我认为它是空白的，但是当我查看渲染页面的源代码时它就在那里

谢谢

# javascript - 如何调试肉桂小程序？

> ID：14025722
> 
> 赞同：19
> 
> 时间：2012-12-24T21:12:04.177
> 
> 标签：javascript, linux, debugging, ide, cinnamon

我想写一个肉桂小程序。这些是基于 JavaScript 的。我希望编写的代码更改服务（打开和关闭它们，类似于[WebDeveloperMenuApplet](https://bitbucket.org/infiniteshroom/cinnamon-webdevelopermenuapplet/src/e254b5bbd25b57864d9e04efb9ead9a1599dd2e1/web-developer-menu%40infiniteshroom/applet.js?at=master)）。我不希望服务启动/停止/重新启动的调试工作，但我想知道如何调试菜单项和对函数的调用。我还希望编写一个配置小程序，该小程序将涉及一些更复杂的编码或对外部服务器的调用。

是否可以将其加载到网络浏览器中，或者是否有更好的方法来调试它？我不知道导入命令在哪里拉，所以我不知道如何在网络浏览器中复制它。

目前使用 IntelliJ IDEA 作为 IDE，但很愿意为这个项目切换到任何东西。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2015-02-14T05:20:22.707

您最好的选择是向终端打印消息的旧技巧。使用`global.log(...)`它，这些行被发送到`~/.cinnamon/glass.log`文件中，观察它们只是这样做：

```
tail -f ~/.cinnamon/glass.log 
```

此外，正如[@elParaguayo 所述](https://stackoverflow.com/users/3087339/elparaguayo)，键入`Alt`+`F2`以显示 Cinnamon 提示符，键入`lg`并按下`ENTER`以显示“窥镜调试器”最顶部的对话框，您可以通过在`Exec:`输入框中键入表达式并查看选项卡中列出的结果来评估表达式`Results`。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-04-14T13:50:09.280

我知道这已经一岁多了，但是我在尝试编写自己的小程序时遇到了它，所以我想分享我的经验。

在调试方面，我不确定这些可以在浏览器中完成。我通过更新我的代码、在 Cinnamon 中重新激活小程序然后查看错误日志（`Alt`+`F2`然后键入`lg`）来调试我的。

根本不是一个很好的解决方案，但这是我找到的唯一解决方案。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-05-30T07:46:52.123

使用浏览器是不可能的。你需要阅读：

1.  `~/.xsession-errors`（因为如果您与其他系统应用程序交互，并非所有错误都会显示为 cinnamon 错误）或者您也可以读取 cinnamon 的终端输出（与 xsession-errors 相同，但会动态更新）。执行“cinnamon --replace”以启用输出模式，这可能需要执行多次。

2.  `~/.cinnamon/glass.log`或者你可以使用 Melange - Cinnamon Debugger。只需单击 cinnamon 面板、TroubleShoot 并找到该应用程序。

# c# - 使用按钮切换列表框的可见性？

> ID：14025725
> 
> 赞同：2
> 
> 时间：2012-12-24T21:12:21.883
> 
> 标签：c#, windows-phone-7

> **可能重复：**
> [如何在 wp7 中更改列表框项目的可见性属性？](https://stackoverflow.com/questions/9427695/how-can-i-change-listbox-items-visibility-property-in-wp7)

你能帮我用按钮切换列表框的可见性吗？

这就是我所拥有的：

```
private void button3_Click(object sender, RoutedEventArgs e)
{
    listbox1.Visibility = Visibility.Visible;
    if (listbox1.Visibility = Visibility.Collapsed) ;
    {
       Visibility.Visible = true;
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-24T21:25:24.667

这将完成这项工作，尽管不像 Scartag 的答案那样简洁，SilverLight 和 WPF 现在具有 Visibility 属性，使用 bool 设置可见性的日子已经一去不复返了。

```
private void button3_Click(object sender, RoutedEventArgs e)
{

    if (listbox1.Visibility == Visibility.Collapsed) 
    {
        listbox1.Visibility = Visibility.Visible ;
    }
    else
        listbox1.Visibility = Visibility.Collapsed;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-24T21:16:31.807

```
private void button3_Click(object sender, RoutedEventArgs e)
{
   listbox1.Visibility = listbox1.Visibility == Visibility.Visible? Visibility.Collapsed : Visibility.Visible;        
} 
```

# php - 如何对这个数组求和？

> ID：14025726
> 
> 赞同：0
> 
> 时间：2012-12-24T21:12:23.553
> 
> 标签：php, arrays, sum

我想汇总所有 [Suggested] 字段。请问我该怎么做？我用php。

```
Array
(
    [0] => Array
        (
            [Id] => 4
            [Suggested] => 1322
            [proximite_r] => 30924.8470655462
        )

    [1] => Array
        (
            [Id] => 7
            [Suggested] => 773
            [proximite_r] => 32229.1036975145
        )
) 
```

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-24T21:16:54.663

给你，伙计：[`array_reduce()`](http://php.net/manual/en/function.array-reduce.php)像老板一样

```
// PHP >= 5.3
$sum = array_reduce($items, function($sum, $item){
  return $sum += $item['Suggested'];
}, 0); 
```

* * *

```
// PHP 5.2
function _sum($sum, $item){
  return $sum += $item['Suggested'];
}
$sum = array_reduce($items, '_sum', 0); 
```

遗憾的是 PHP <= 5.2 不支持闭包，所以你必须单独定义函数。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-24T21:15:11.217

你可以试试这个：

```
$Sum = 0;
foreach ($row as $item) {
   $Sum += $item['Suggested']; // or else index
}
echo $Sum; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-24T21:14:59.517

```
$sum = array_sum(
              array_map(function($item) { return $item["Suggested"]; }, $items)
       ); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-24T21:20:23.423

鉴于[`array_column`](https://wiki.php.net/rfc/array_column)可能会在 PHP 5.5 中出现的功能：

```
function array_column($input, $key) {
    if (is_array($key) || !is_array($input)) return array();
    $array = array();
    foreach($input as $v) {
        if(array_key_exists($key, $v)) $array[]=$v[$key];
    }
    return $array;
} 
```

（来源：php.net）

你可以使用这个：

```
$sum = array_sum(array_column($items, 'Suggested')); 
```

当然，这有点矫枉过正，我只想指出，这也是实现它的一种方式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-25T19:08:25.943

遍历数组的另一种方法是使用 for 循环，假设它是 $arr：

```
<?php    
function getSumOfKey($arr, $key){
     $sum = 0;
     for ($i = 0; $i < count($arr); $i++){
      (is_numeric($arr[$i][$key]))? $sum += $arr[$i][$key] : continue;
     }
     return $sum;
    } 
?> 
```

要实现它：

```
echo 'The sum is: '.getSumOfKey($arr, 'Suggested'); 
```

# sql-server - 您能否根据插入、更新或删除的来源运行触发器？

> ID：14025728
> 
> 赞同：1
> 
> 时间：2012-12-24T21:12:38.267
> 
> 标签：sql-server, triggers

您能否根据插入、更新或删除的来源运行触发器？

**UPD**

也许我对上面的问题不太清楚。我希望触发器仅在插入来自特定表时运行。例如，我有两个插入 TABLE MAIN 的表。如果插入来自表 A，我只希望触发器运行。如果它来自表 B，则不要运行。

我想我可以使用表 A 的连接？以前从未以这种方式使用过触发器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T21:20:00.813

也许我不理解您的问题，但[触发器](http://msdn.microsoft.com/en-us/library/ms189799.aspx)是在数据库中发生事件时执行的过程。此事件发生在您已将触发器分配到的表上。

使用[本文](http://www.kodyaz.com/articles/sql-trigger-example-in-sql-server-2008.aspx)中的示例，假设您有这样的表：

```
CREATE TABLE Customers (
 CustomerId smallint identity(1,1),
 Name nvarchar(255),
 Priority tinyint
)

CREATE TABLE Sales (
 TransactionId smallint identity(1,1),
 CustomerId smallint,
 [Net Amount] int,
 Completed bit
) 
```

您可以创建一个类似于此的触发器，它将执行`AFTER INSERT, UPDATE and DELETE`：

```
CREATE TRIGGER dbo.Update_Customer_Priority
 ON dbo.Sales
AFTER INSERT, UPDATE, DELETE
AS

WITH CTE AS (
 select CustomerId from inserted
 union
 select CustomerId from deleted
)
UPDATE Customers
SET
 Priority =
  case
   when t.Total < 10000 then 3
   when t.Total between 10000 and 50000 then 2
   when t.Total > 50000 then 1
   when t.Total IS NULL then NULL
  end
FROM Customers c
INNER JOIN CTE ON CTE.CustomerId = c.CustomerId
LEFT JOIN (
 select
  Sales.CustomerId,
  SUM([Net Amount]) Total
 from Sales
 inner join CTE on CTE.CustomerId = Sales.CustomerId
 where
  Completed = 1
 group by Sales.CustomerId
) t ON t.CustomerId = c.CustomerId

GO 
```

# algorithm - 按正面和负面内涵对句子进行排名

> ID：14025730
> 
> 赞同：1
> 
> 时间：2012-12-24T21:12:53.390
> 
> 标签：algorithm, nlp

我正在寻找一种算法，通过它们所携带的内涵对句子进行排名。理想情况下，该算法可以为带有更多负面含义的句子返回更大的值。任何输入将不胜感激！

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-24T21:21:24.560

您正在寻找一系列称为**[情绪分析](http://en.wikipedia.org/wiki/Sentiment_analysis)**的技术。我不是该主题的专家，但通过 Google 快速搜索找到了一些可能对您有用的链接。例如，[这个 LingPipe 项目](http://alias-i.com/lingpipe/demos/tutorial/sentiment/read-me.html)似乎是一个情绪分析工具包，您可以将其用作起点。

希望这可以帮助！

# c# - 从 C# 中的复杂 JSON 结构中提取数据

> ID：14025732
> 
> 赞同：4
> 
> 时间：2012-12-24T21:13:09.500
> 
> 标签：c#, json, json.net

我有如下所示的 JSON 数据：

```
{
   "position":[
      {
         "top":[
            42,
            12
         ]
      },
      {
         "middle":[
            10,
            15
         ]
      },
      {
         "bottom":[
            5,
            201
         ]
      },
      {
         "axis":[
            {
               "X":[
                  901,
                  51,
                  67
               ]
            },
            {
               "Y":[
                  1474186,
                  561647
               ]
            },
            {
               "Z":[
                  911,
                  1296501
               ]
            },
            15,
            20
         ]
      }
   ],
   "validated":true,
   "metadata":{
      "uri":"/data/complex/",
      "session":[
         1818,
         14
      ],
      "private":false
   },
   "vists":0,
   "ok":true,
   "data":{
      "10":{
         "title":"Alpha",
         "author":"Justin X. Ample",
         "cover":"/f48hf58.tiff"
      },
      "901":{
         "title":"Tau",
         "author":"Felina Blank",
         "cover":"/45trthrref.tiff"
      }
   },
   "live":null
} 
```

从这些数据中，我想显示一个这样的列表：

```
Alpha, Justin X. Ample
Tau, Felina Blank 
```

请注意，键（在我的示例中为 10 和 901）是不可预测的。所以我想以某种方式创建一个表示“数据”结构的对象并对其进行迭代以获得每个条目的标题和作者。

使用基本的 JSON 结构，我成功地完成了这样的事情（使用 JSON.NET）：

```
public class Foo
    {
        public int bar { get; set; }
        public string baz { get; set; }
        public string quxx { get; set; }
    }

...

// json = {"bar": 1, "baz":"two", "quxx":"three"}
var result = await JsonConvert.DeserializeObjectAsync<Foo>(json);

return result.baz // "two" 
```

但我不知道我需要做什么才能使它与复杂的结构一起工作。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-24T21:24:39.770

```
var jObj = JsonConvert.DeserializeObject(json) as JObject;
var result = jObj["data"].Children()
                .Cast<JProperty>()
                .Select(x => new { 
                    Title = (string)x.Value["title"] ,
                    Author = (string)x.Value["author"],
                })
                .ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T22:16:17.827

您可以像以前一样使用它。您只需将您的实体类修改为如下所示：

```
public class MyVeryVeryUsefulObject
{

    public Position[] position { get; set; }
    public string baz { get; set; }
    public string quxx { get; set; }
}

public class Position
{
    public Int32[] top;
    public Int32[] middle;
    public Int32[] bottom;
} 
```

等等。您只需在代码中将 JSON 对象表示为实体类。

我前段时间找到了一个有用的链接，也许这会减少你实现这个json结构的工作量。 [http://json2csharp.com/](http://json2csharp.com/)

# django - Django 模型选择

> ID：14025733
> 
> 赞同：6
> 
> 时间：2012-12-24T21:13:17.157
> 
> 标签：django, django-south

几个小时以来，我一直被如何在我的模型中做出选择所困扰。

到目前为止，我在模型中的批准领域一直存在问题。我想被批准成为 3 个选择中的一个，但我似乎得到的是所有三个选择的元组。在'./manage.py shell'中，我得到

```
>>> listing.objects.all()[0].approved
((u'1', u'Awaiting'), (u'2', u'No'), (u'3', u'Yes')) 
```

我的模型：

```
from django.db import models

# Create your models here.
class directory(models.Model):
    name = models.CharField(max_length="50")

class listing(models.Model):
    name = models.CharField(max_length="50")
    directory = models.ForeignKey(directory)
    birthday = models.DateField()
    state = models.CharField(max_length="2") 
    owner = models.CharField(max_length="50")
    approved = (
        (u'1', u'Awaiting'),
        (u'2', u'No'),
        (u'3', u'Yes'),
    ) 
```

还有一个问题：但是每当我进行模型更改并尝试使用 South 迁移模式时，我的命令行都会冻结并且永远不会完成迁移模式。关于它为什么冻结的任何可能的建议？它可以检测到更改，但永远不会完成实施它们。因为它永远不会完成，所以当我单击模型进行更改时，我无法再通过管理面板访问我的模型，我永远无法加载页面。

```
The order in which I run the commands are
    ./manage.py convert_to_south myapp
    ./manage.py schemamigration southtut --auto
    ./manage.py migrate southtut ( never progresses on this command after the first few lines appear) 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-12-24T21:15:56.800

`approved`正如你所拥有的，它不是一个字段，它只是一个包含三个选项的类属性。选择需要是实际字段的属性：

```
APPROVAL_CHOICES = (
    (u'1', u'Awaiting'),
    (u'2', u'No'),
    (u'3', u'Yes'),
)
approved = models.CharField(max_length=1, choices=APPROVAL_CHOICES) 
```

# c# - VS2012断点没有被击中

> ID：14025734
> 
> 赞同：40
> 
> 时间：2012-12-24T21:13:22.557
> 
> 标签：c#, debugging, visual-studio-2012, visual-studio-debugging

我有一个看起来像这样的类：

```
public class MyService
{
    private MyService(){}
    public static string GetStuff()
    {
        var stuffDid = new MyService();
        return stuffDid.DoStuff();
    }
    private string DoStuff()
    {
        //do stuff
    }
    //other private helpers

} 
```

显然我遗漏了很多，但这是一般的外壳。

现在，我有一个单元测试：

```
[Test]
public void MyTest()
{

    var results = MyService.GetStuff();
} 
```

我在单元测试中设置了断点，我可以看到`results`有数据。但是，我从字面上设置了断点，`MyService`除非我把它们放在花括号上，否则什么都不会被击中。`results`由于有数据，我无法理解，我的`return`陈述`MyService`应该受到打击，对吗？

我错过了什么吗？我是否完全忘记了一些最基本的规则？怎么什么都没有`MyService`被击中？如果我用 手动进入它`F11`，它只会跳来跳去，甚至不会像我预期的那样遍历每一行。此外，当我手动单步执行时，我倾向于在最初应该点击某些代码之后点击它。并且任何`switch`语句似乎都默认为第一个选项，即使正在切换的值应该明确输入不同的`case`.

我什至尝试过制作`MyService`构造函数`public`并带走所有`static`方法，但它仍然不起作用。

我的测试和“核心”代码在同一个解决方案中，但不同的项目（分别是`Test`和）。`Core`其他测试在 中打断点没有问题`Core`，只有在特定测试中（唯一的测试是 testing `MyService`）。

我已经删除了我的 PDB 文件并清理了解决方案。依然没有。

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2012-12-28T19:59:35.960

一些想法。

1.  确保它是调试版本而不是发布
2.  关闭项目属性中的优化（如果它们已启用）
3.  尝试插入`Debugger.Break()`代码而不是 VS 中的断点
4.  确保断点已启用（Debug->Windows->Breakpoints 工具栏），并且断点符号应该是实心的
5.  执行您的应用程序。**加载调试->窗口->模块窗口。**检查您的程序集以查看是否已加载符号。如果没有，它可能会给出相关的状态消息。

您是否一直在调整计算机上的日期？这真的会搞砸构建过程。如果是这样，请手动删除所有 obj/bin 文件夹并重新编译。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-12-31T00:16:21.197

这可能是因为您只调试 1 个项目而不是`Test`两者`Core`

您可以将 VS 设置为一次调试多个项目，您可以通过`right-click your solution > Properties > Common Properties > StartUp Project`

在这里可以设置“多个启动项目” ![在此处输入图像描述](../Images/4cd5e683deb44e5bc3bace8f9a578ed0.png)

只需设置两者`Core`并`Test`开始。这可能会解决您的问题。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-02-05T19:48:04.167

事实证明这与代码覆盖率有关。

关闭它可以解决问题。

您可以通过以下链接了解如何禁用代码覆盖率

[禁用代码覆盖](https://stackoverflow.com/questions/13301817/how-can-i-disable-code-coverage-assembly-instrumentation-in-visual-studio-2012)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-12-22T08:41:29.020

我有一个非常具体的场景，导致明显的“断点未命中”问题。

由于这里没有其他答案提到它，因此我将添加我的答案，以帮助遇到同样问题的人。

就我而言，解决方案很愚蠢，并且使用尽可能多的 LINQ，我应该早点解决这个问题。当运行一个返回 IEnumerable 的方法时，其中包含的 return 语句实际上是`yield return`语句，那么当你调用它时，该方法将不会被执行。

当您从该 IEnumerable 对象调用另一个方法时，它实际上会被执行，例如`ToList()`or `Count()`。只有*这样*，该方法才会被执行并到达断点。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-12-31T05:53:12.207

我最近遇到了同样的问题，我的头撞到了墙上。

答案很愚蠢：不知何故，我的测试项目与主库项目不同步。我正在构建测试和库的调试版本，但测试项目从`bin/Release`文件夹中复制了库。我刚刚重新创建了项目参考，一切都已修复。

PS 更疯狂的是：调试器进入了一个库函数，但不知何故跳过了其中的一行。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-12-24T22:03:48.890

只需确保您已使用调试器符号构建程序集。

此选项必须填写“完整”：

右键单击包含代码文件且断点未命中的项目。选择“属性”。

打开项目属性后，选择“构建”选项卡。注意标签页底部的“高级...”按钮。（在“输出”组内）

单击此按钮并为“调试信息”属性选择“完整”。这应该是断点未命中的原因。Visual Studio 使用保存在 pdb 文件中的符号来查找断点的确切位置。如果未创建这些文件，则不会命中断点。也许您禁用了这些文件的创建以整理您的项目文件结构。这是我认识到我需要这些文件的情况。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-12-24T21:16:32.283

您需要将 DoStuff 设为静态。

```
private static string DoStuff()
{
    //do stuff
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-01-03T18:17:54.960

这听起来像您的测试沙箱中没有更新 pdb 文件。

1) 确保您处于调试模式。

2）您可以尝试明确包含 pdb 文件的部署项吗？

*   你说你可以在你的测试项目中附加一个调试点。
*   在测试项目中达到调试点后，请检查以确保具有最新时间戳的 pdb 文件存在于沙箱的 Out 文件夹中。

3）如果 1 和 2 失败，我发现有时 Visual Studio 需要重新启动 :)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-12-28T20:42:39.043

您的代码表示“服务”，它可以作为单独的进程运行。如果是这种情况，您可以加载程序集，因此断点将是实心红色圆圈，但程序集的另一个副本，在单独的进程中运行实际上正在处理请求。

*   检查任务管理器中可能的违规者（可能托管您的服务的进程）。在调试时杀死它们以确认调用失败。
*   尝试使用 Debugger.Break();
*   创建调试日志文件，在将输出加载到日志时输入进程和程序集名称。确保您的日志每次都是不同的文件以避免异步访问问题。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-09-17T06:33:31.313

1.  清理解决方案并重建并执行启动项目。

2.  您能否快速查看一下 BUILD > Configuration Manager，以确定设置了哪些配置属性。如果是开发，那么您可能需要调整项目属性 -> 单击高级设置 -> 在 [输出选项卡] 中将调试信息更改为“完整”。

3.  即使不是开发模式，您也可以执行第二步

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-06-16T00:48:53.890

我在 25 个项目中的 1 个项目中发生了这种情况，这些项目都在同一个解决方案中。其他项目尊重断点，但这个 1 没有。我从解决方案中删除了该项目（删除，而不是卸载），它破坏了对它的所有引用，然后将其添加回解决方案并且有效！

如果这不起作用，您可能需要从头开始重新创建问题项目并将该新项目添加到解决方案中。

除了纯粹的运气之外，我对为什么这有效的最好解释是，多年来我们将项目从一个版本的 VS 迁移到另一个版本很多很多次，也许其中一个迁移导致了这个问题。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-01-02T17:25:24.183

我从经验中知道，Visual Studio 没有明确的调试服务的方法，尤其是 Windows 服务。尝试将一些代码添加到 GetStuff 以打印到文本文件，这样您至少知道代码被命中了。在创建服务时，我经常使用这种方法进行测试。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-01-02T23:21:27.317

也许您的`Test`项目引用的是较旧的`Core`二进制文件，而不是`Core`（源代码）项目？

尝试在您的测试项目中重新添加引用：

转到您的`Test`项目并删除对该`Core`项目的引用。

现在选择 References 文件夹并右键单击它并选择菜单选项以添加新参考。在“参考管理器”对话框中时，请确保您选择`Solution`然后`Projects`在左侧。然后在 Reference Manager 对话框的中间，选择（检查）`Core`项目。

再次尝试调试，看看是否有帮助。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-01-02T06:05:30.363

如果它处于发布模式，请将其切换到调试模式。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-01-02T20:54:24.673

当 VS 使用源代码生成的 .pdb 文件时，它的行为与您所描述的完全一样（不击中断点，击中您不希望在单步执行时遇到的代码），该文件与调试时使用的代码有所不同. 我不能保证这是你的情况，但是当我需要进入作为预构建库提供的代码时，我已经多次观察到这种行为，该库是针对具有相同文件名的旧/不同代码生成的/符号。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-10-22T09:09:20.007

愚蠢的我没有设置测试项目：

![在此处输入图像描述](../Images/620495cc0c7246ae1047f7fdbeaa2b03.png)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2015-01-23T07:56:52.017

要逐步调试，您必须做两件事。首先必须设置断点，然后必须将调试器附加到运行代码的进程。如果您正在运行 IIS Express 并且您有 64 位计算机，那么您需要附加运行您的代码的**iisexpress.exe 。**如果按 CTRL + ALT + P，您将进入附加到进程窗口。附加后，如果代码匹配，则应命中断点。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2014-04-06T08:20:54.617

这个很晦涩：

确保您没有两个具有不同应用程序池的虚拟目录指向硬盘驱动器上的相同物理位置。在开发过程中，有时可能会因测试或错误而发生这种情况。

我对技术细节不是 100% 清楚，但我有两个 AppPools 和两个虚拟目录，并且没有遇到断点，因为我认为物理路径在 IIS/Visual Studio 中以某种方式映射到另一个应用程序池，而不是实际的那个执行。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2014-10-23T07:55:27.723

首先尝试通过鼠标右键单击项目> Rebuild来重建您的项目如果这不起作用，请尝试清理项目（鼠标右键单击项目>清理）

如果这不起作用，请检查：

```
Right mouse click your project
select [Properties]
select the [Build] tab
make sure [Define DEBUG constant] and [Define TRACE constant] are checked
Click the [Advanced] button at the bottom of the Build tabpage
Make sure that [Debug Info:] is set to [full]
Click [OK] and rebuild the project ;-) 
```

希望对你有用！（第 6 步生成 .pdb 文件，这些是调试符号）

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2012-12-31T07:27:54.907

您可以尝试添加一个`Thread.Sleep(5000)`in`GetStuff`方法并使用 Attach to Process

**Visual Studio > 工具 > 附加到进程**并查看该行下方的断点是否被命中。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2014-09-16T15:45:08.427

我有同样的问题。也许我的解决方案可以帮助您解决问题。只需在“附加到进程”选项“附加到”中选择值“Avtomatic：本机代码”。此致。

![图片](../Images/2d896b1e765f56bb90bd0dc01e27be2b.png)

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2013-01-02T20:14:44.017

我遇到了类似的问题。事实证明，对我来说，使用`*.testrunconfig`文件从 VS2010 迁移到 VS2012 是一个糟糕的迁移。我删除了旧的并设置了一个新的来解决这个问题。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2013-01-03T15:53:37.123

还有一些东西可以尝试：

*   检查加载的符号是否与调试的可执行文件匹配：
    打开 VS 命令提示符并 cd 到您调试的可执行文件所在的目录。然后执行`dumpbin /PDBPATH:VERBOSE MyServiceExecutable.exe`并扫描“PDB 年龄不匹配”的输出（参考：http: [//msdn.microsoft.com/en-us/library/44wx0fef.aspx](http://msdn.microsoft.com/en-us/library/44wx0fef.aspx)）

*   不确定 VS 2012，但旧版本的 VS 有一个错误，即显示错误的源文件，前提是您的项目中有两个同名的源文件，即使它们位于不同的文件夹中。因此，如果您的项目包含另一个同名的源文件，请查看重命名其中一个是否有帮助。（*更新：*似乎 VS 2012[也受到影响](https://stackoverflow.com/q/12416192/1097883)。）

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2016-01-26T15:56:31.597

在单元测试中，我没有遇到断点，并意识到我正在运行测试而不是调试测试。测试资源管理器的顶部是“全部运行”、“运行失败”、“运行通过”等选项。运行测试时，不会命中断点。要调试测试，请在测试资源管理器中右键单击测试或测试组，然后选择调试选定测试。

# c++ - 显示 Targa/TGA 的问题

> ID：14025735
> 
> 赞同：1
> 
> 时间：2012-12-24T21:13:23.510
> 
> 标签：c++, image, image-processing, tga

我的 Targa Reader 出现了非常轻微的问题。1 个像素关闭，2 个额外像素为黑色：S

我正在加载的 24 位 targa 文件如下所示： ![在此处输入图像描述](../Images/3f3e9910aea3eb5fc56a06aed6e4029f.png)

注意左上角的白色像素。左上角的第一个像素是白色的。

但是当我将文件像素保存为 24 位位图时，它看起来像： ![在此处输入图像描述](../Images/cde3e91c94c74f31b6d6998b21708020.png)

请注意，白色像素不知何故位于右上角以及其上方的 2 个黑色像素。

我一生都无法弄清楚为什么除此之外其他一切都是正确的。这让我很困扰，因为我非常接近能够加载 TGA。

知道我下面的代码有什么问题吗？我正在为使用 Photoshop 创建的 16、24 和 32 位 TGA 文件编写 TGA 阅读器。

```
typedef union RGB   //Struct which will hold all pixels.
{
    uint32_t Color;
    struct
    {
        unsigned char B, G, R, A;
    } RGBA;
} *PRGB;

class Tga    //My Targa class that will load the TGA file.
{
    private:
        std::vector<RGB> Pixels;
        uint32_t width, height, size, BitsPerPixel;

    public:
        Tga(const char* FilePath);
};

Tga::Tga(const char* FilePath)
{
    //Open the file for reading..
    std::fstream hFile(FilePath, std::ios::in | std::ios::binary);
    if (!hFile.is_open()){throw std::invalid_argument("File Not Found.");}

    //The header is 12 bytes. By reading it, I can tell if the TGA is compressed or not.

    byte Header[12] = {0};
    byte DeCompressed[12] = {0x0, 0x0, 0x2, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0};
    byte IsCompressed[12] = {0x0, 0x0, 0x10, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0};

    hFile.read(reinterpret_cast<char*>(&Header), sizeof(Header)); //Read the header.

    if (memcmp(DeCompressed, &Header, sizeof(Header)) == 0)  //If it is not compressed.
    {
        hFile.read(reinterpret_cast<char*>(&Header), sizeof(Header));

        BitsPerPixel = Header[4];              //Displays correctly.
        width  = Header[1] * 256 + Header[0];  //Displays correctly.
        height = Header[3] * 256 + Header[2];  //Displays correctly.
        size  = ((width * BitsPerPixel + 31) / 32) * 4 * height;  //Same algorithm for bitmaps. width * height * 3 OR width * height * 4\. Taken from MSDN.

        if ((BitsPerPixel != 24) && (BitsPerPixel != 32) && ((width < 1) || (height < 1)))
        {
            hFile.close();
            throw std::logic_error("Error: Invalid TGA File. Width And Height cannot be less than 0\. BitsPerPixel must be 24 or 32 bits.");
        }

        std::vector<unsigned char> ImageData(size);  //An array for holding the image data.
        hFile.read(reinterpret_cast<char*>(ImageData.data()), size);

        unsigned char* BuffPos = ImageData.data();
        Pixels.resize(width * height);  //A vector holding my structs that will hold the pxiels.

        //The following is supposed to flip the Image and copy it into my struct vector.
        for (int I = 0; I < height; I++)
        {
            for (int J = 0; J < width; J++)
            {
                Pixels[(height - 1 - I) * width + J].RGBA.B = *(BuffPos++);
                Pixels[(height - 1 - I) * width + J].RGBA.G = *(BuffPos++);
                Pixels[(height - 1 - I) * width + J].RGBA.R = *(BuffPos++);
                Pixels[(height - 1 - I) * width + J].RGBA.A = (BitsPerPixel > 24 ? *(BuffPos++) : 0xFF);
            }
            if(BitsPerPixel == 24)  //Has padding?
                BuffPos += (4 - ((width * 3) % 4)) % 4;
        }
    }
    else if (memcmp(IsCompressed, &Header, sizeof(Header)) == 0)  //The TGA is compressed..
    {
        hFile.read(reinterpret_cast<char*>(&Header), sizeof(Header));

        BitsPerPixel = Header[4];
        height  = Header[1] * 256 + Header[0];
        width = Header[3] * 256 + Header[2];
        size  = ((width * BitsPerPixel + 31) / 32) * 4 * height;

        if ((BitsPerPixel != 24) && (BitsPerPixel != 32) && ((width < 1) || (height < 1)))
        {
            hFile.close();
            throw std::logic_error("Error: Invalid TGA File. Width And Height cannot be less than 0\. BitsPerPixel must be 24 or 32 bits.");
        }

        RGB Pixel = {0};
        char* BuffPos = reinterpret_cast<char*>(&Pixel);
        int CurrentByte = 0, CurrentPixel = 0;
        int BytesPerPixel = (BitsPerPixel / 8);
        Pixels.resize(width * height * sizeof(RGB));
        do
        {
            byte ChunkHeader = 0;
            hFile.read(reinterpret_cast<char*>(&ChunkHeader), sizeof(byte));
            if (ChunkHeader < 128)
            {
                ++ChunkHeader;
                for (int I = 0; I < ChunkHeader; ++I)
                {
                    hFile.read(BuffPos, BytesPerPixel);
                    Pixels[CurrentByte].RGBA.B = Pixel.RGBA.B;
                    Pixels[CurrentByte].RGBA.G = Pixel.RGBA.G;
                    Pixels[CurrentByte].RGBA.R = Pixel.RGBA.R;
                    Pixels[CurrentByte].RGBA.A = (BitsPerPixel > 24) ? Pixel.RGBA.A : 0xFF;
                    CurrentByte += BytesPerPixel;
                    ++CurrentPixel;
                }
            }
            else
            {
                ChunkHeader -= 127;
                hFile.read(BuffPos, BytesPerPixel);
                for (int I = 0; I < ChunkHeader; ++I)
                {
                    Pixels[CurrentByte].RGBA.B = Pixel.RGBA.B;
                    Pixels[CurrentByte].RGBA.G = Pixel.RGBA.G;
                    Pixels[CurrentByte].RGBA.R = Pixel.RGBA.R;
                    Pixels[CurrentByte].RGBA.A = (BitsPerPixel > 24) ? Pixel.RGBA.A : 0xFF;
                    CurrentByte += BytesPerPixel;
                    ++CurrentPixel;
                }
            }
        } while(CurrentPixel < (width * height));
    }
    hFile.close();

    //I can guarantee nothing is wrong with the bitmap creator.

    Bitmap BMP(width, height, 24);  //Take the pixels structure and create a 24 bit bitmap. This works 100% of the time for PNG and Bitmap using the same structure.
    BMP.Set(Pixels);
    BMP.Save("C:/Foo.bmp");
}

int main()
{
    Tga F("C:/Foo.tga");
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T23:07:48.213

我认为您的标题大小错误。各种位定义如下；断言只是为了确保编译器正确打包结构。

```
typedef uint8_t byte;

enum class color_map_type : byte {
    absent  = 0,
    present = 1,
};

enum class image_type : byte {
    none             = 0,
    color_mapped     = 1,
    true_color       = 2,
    black_white      = 3,
    rle_color_mapped = 9,
    rle_true_color   = 10,
    rle_black_white  = 11,
};

struct color_map_spec {
    uint16_t first_entry_index;
    uint16_t length;
    byte     entry_size;
};
static_assert(sizeof(color_map_spec) == 5, "bad size");

struct image_descriptor {
    byte alpha    : 4;
    byte right    : 1;
    byte top      : 1;
    byte reserved : 2;
};
static_assert(sizeof(image_descriptor) == 1, "bad size");

struct image_spec {
    uint16_t         x_origin;
    uint16_t         y_origin;
    uint16_t         width;
    uint16_t         height;
    byte             depth;
    image_descriptor descriptor;
};
static_assert(sizeof(image_spec) == 10, "bad size");

struct header {
    byte           id_length;
    color_map_type color_map_type;
    image_type     image_type;
    color_map_spec color_map_spec;
    image_spec     image_spec;
};
static_assert(sizeof(header) == 18, "bad size");

struct footer {
    uint32_t ext_area_offset;
    uint32_t dev_dir_offset;
    char     signature[16];
    char     dot_terminator;
    char     null_terminator;
} 
```

# jsf - 在 JSF 和 WAS 中如何管理用户会话

> ID：14025737
> 
> 赞同：2
> 
> 时间：2012-12-24T21:13:33.823
> 
> 标签：jsf, websphere, websphere-8

我正在开发一个`JSF v1.2`将在`Websphere Application server 8.0`. 我们有一个外部安全管理器（SiteMinder）来提供身份验证和授权。

据我了解，JSF 将当前视图信息存储在会话中。我有一些关于如何在 JSF 和 WAS 中管理会话的问题。

1.  如果状态保存设置为，JSF 是否将匿名用户和登录用户的视图状态存储在会话中`serverside`？
2.  JSF 如何知道用户是否是登录用户？我们必须告诉 JSF 吗？
3.  是否有可能`Trusted Authentication Inceptor (TAI)`告诉 WAS 当前用户是有效用户？

我在这里找到了类似的帖子[检查会话是否存在 JSF](https://stackoverflow.com/questions/8144195/check-if-session-exists-jsf)

我不确定 WAS 是如何知道用户是否登录的。在代码中，有 userManager.isLoggedIn()。除非 WAS 知道用户是有效的，否则这将如何工作？

你能提供你的帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T23:44:40.037

> *如果状态保存设置为服务器端，JSF 是否会在会话中为匿名用户和登录用户存储视图状态？*

当然。会话不绑定到登录用户。相反，它通常是相反的：登录用户存储在会话中。

* * *

> *JSF 如何知道用户是否是登录用户？我们必须告诉 JSF 吗？*

它只是使用底层`HttpSession`对象，servletcontainer 已经创建并准备了很长时间。另请参阅[servlet 如何工作？实例化、会话、共享变量和多线程](https://stackoverflow.com/questions/3106452/how-do-servlets-work-instantiation-session-variables-and-multithreading)，用于深入解释内部工作原理。

* * *

> *是否有可能拥有一个可信的身份验证接收器 (TAI)，它告诉 WAS 当前用户是有效用户？*

在这一点上，这不是您关心的问题。

# haxe - 在 Haxe 中将函数作为参数传递

> ID：14025739
> 
> 赞同：14
> 
> 时间：2012-12-24T21:13:55.460
> 
> 标签：haxe

在 Haxe 编程语言中，是否可以将函数作为参数传递（就像在 JavaScript 中一样？）

例如，以下代码在 Haxe 中是否有效？

```
function a(){
    trace("This function is being used as a parameter!");
}

function b(theFunction){
    theFunction();
}

b(a); //is this equivalent to a(); ? 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-25T00:40:40.940

这绝对是可能的，并且是标准库中使用的一种模式，尤其是在[Lambda](http://haxe.org/api/lambda)类中：

```
class Test {
  static function main(){
    var arr = [0,1,2,3,4,5,6,7,8,9,10];
    var newArr = Lambda.filter(arr, function (num) { 
      return num % 2 == 0; 
    });
    for (i in newArr)
    {
      trace (i);
    }
  }
} 
```

（见[http://try.haxe.org/#C9dF3](http://try.haxe.org/#C9dF3)）

要定义自己的将函数作为参数的方法，请使用以下`(param1Type)->(param2Type)->(returnType)`语法：

```
function test1(myFn:String->Void) { myFn("hi"); }
test1(function (str) { trace(str); });

function test2(myFn:String->String) { var newStr = myFn("hi"); }
test2(function (str) { return str.toUpperCase(); });

function test3(myFn:Int->String->Array<Int>->Void) { myFn(3, "Jason", [1,2,3,4]); }
test3(function(num:Int, name:String, items:Array<Int>) { ... }); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-24T23:59:44.100

请亲自查看并尝试:)

[http://try.haxe.org/#CFBb3](http://try.haxe.org/#CFBb3)

# c++ - 将 SDL 窗口位置转换为 OpenGL 世界位置

> ID：14025740
> 
> 赞同：2
> 
> 时间：2012-12-24T21:14:13.727
> 
> 标签：c++, opengl, 2d, sdl, scaling

我正在为这个项目使用 SDL 和 OpenGL。我在程序启动时的屏幕是 640 x 480，我的 glOrtho 设置也是如此。所以程序开始同步。但是我的程序允许用户使用鼠标创建选择要放大的显示部分。例如，用户可以选择从 320,240 (_mouseStart) 到 640,480 (_mouseEnd) 的区域。然后将此选择区域传递给 glOrtho，以便它可以居中并放大所选区域。我的问题是当我尝试选择一个已经放大区域的区域时，因为 SDL 鼠标坐标在 0,0 到 640,480 的范围内，而不是选择的新区域，在这种情况下是 320、240 到 640,480。我需要一种方法来计算尝试选择并已放大区域时的实际鼠标位置。

我无法在这里发布图片，但我在 gamedev.net 上创建了一个帖子，如果您需要更多信息，可以参考。[http://www.gamedev.net/topic/636257-opengl-2d-selection-scaling-multiple-times/](http://www.gamedev.net/topic/636257-opengl-2d-selection-scaling-multiple-times/)

这是我在用户选择一个区域后计算所有鼠标位置的地方（现在是正确的）

```
// modify mouse coordinates to fit scaled image
            _mouseStart.x = ((_mouseStart.x / SCREEN_WIDTH) * (_portionEnd.x - _portionStart.x)) + _portionStart.x;
            _mouseStart.y = ((_mouseStart.y / SCREEN_HEIGHT) * (_portionEnd.y - _portionStart.y)) + _portionStart.y;
            _mouseEnd.x = ((_mouseEnd.x / SCREEN_WIDTH) * (_portionEnd.x - _portionStart.x)) + _portionStart.x;
            _mouseEnd.y = ((_mouseEnd.y / SCREEN_HEIGHT) * (_portionEnd.y - _portionStart.y)) + _portionStart.y; 
```

这是我将 glOrtho 重置为居中并显示所选区域的方法。

```
glLoadIdentity();
glOrtho(_portionStart.x, _portionEnd.x, _portionEnd.y, _portionStart.y, 1, -1); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-24T22:01:03.890

我创建了一个解释过程的图像（我希望）

*   蓝色矩形是您的（未缩放的）基本视口。
*   小绿色矩形是在基础视口中选择的区域
*   大的绿色矩形是新的缩放视口
*   在缩放的视口中选择了一个新的矩形（红色的）

红色矩形上的红色坐标是您应该从鼠标位置获得的坐标。您可以使用此坐标来计算当前缩放视口的值（绿色坐标）。要获得最终的未缩放坐标（蓝色值），您必须添加绿色矩形 (228,88) 的偏移量。

请注意，我的示例不是最好的，因为绿色矩形的偏移量和绿色矩形的高度相同（两个值都是 228）

![计算](../Images/1096adeac42611e288de6d7a9cf2d208.png)

# ruby - Ruby 浮点数比较错误？

> ID：14025748
> 
> 赞同：3
> 
> 时间：2012-12-24T21:15:10.857
> 
> 标签：ruby, floating-point

我有一个 ActiveRecord 对象：

```
 s = Show.find 3980 
```

Show 有一个`lng`Decimal 类型的列（精度 10，小数位数 7）。如果我打电话`lng`：`s`

```
s.lng
#=> #<BigDecimal:7fac9a12ff40,'-0.821975E2',18(18)> 
```

一切都很好。但如果我这样做：

```
s.lng == -82.1975
#=> false 
```

它回来了`false`！但是两者都是一样的！它与我的数据库列作为十进制有关吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-24T22:29:15.443

### 不要比较 FPU 十进制字符串分数是否相等

所以，在 1.8.7p330：

```
BigDecimal.new('-82.1975') == -82.1975
 => true 
```

但是在 1.9.3p194 它是`false.`

问题是浮点或双精度值与包含小数的十进制常量的比较充其量是不可靠的。

很少有十进制字符串分数在二进制 FP 表示中具有精确值。^*例如，在 0.01 和 0.99 之间，只有 0.25、0.50 和 0.75 具有不重复的精确二进制表示。这大约是 BigDecimal 存在的一半原因。（另一半原因是FP数据的固定精度。）

因此，将实际机器值与十进制字符串常量进行比较时得到的结果取决于二进制小数中的每一位……低至 1/2 ^(52) ……甚至需要四舍五入。

如果产生数字的过程、输入转换代码或其他任何涉及的过程有任何不完美的地方（呵呵，有点，抱歉），它们看起来不会完全相等。

可以提出一个论点，即比较*应该*总是失败，因为没有 IEEE 格式的 FPU 甚至可以准确地表示该数字。

多年来，MySQL 和 ActiveRecord 已经改变了处理带分数的数字的确切方式。

但是可以肯定的是，您不需要将浮点数与 BigDecimal 混合，即选择：

```
BigDecimal.new('-82.1975') 
```

并与之进行比较。

* * *

^(^*问题：机器编号是 x/2 ^n，但十进制常数是 x/(2 ^n * 5 ^m )。)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T21:43:32.593

请试试`s.lng.to_f == -82.1975`

# python - python中的字符串索引必须是整数错误，但索引是整数

> ID：14025755
> 
> 赞同：1
> 
> 时间：2012-12-24T21:15:56.500
> 
> 标签：python, string, indices

我正在编写一个程序来从表单的单行输入中添加两个数字：

号码 + 其他号码

我不断收到“字符串索引必须是整数”错误，但是当我对所有索引调用 type 时，它​​们都显示为整数。

我该如何解决？这是代码

```
S = input()
for position in range(0, len(S)):
   if '+'== position:
     break
a=int(position)
Sum = (S[0,a])+(S[a, len(S)])
print(Sum)
#print(position)   
#print(type(position))
#print(type(len(S)))
#print(type(0)) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-24T21:17:31.030

## 眼前的问题

您可能打算使用`S[0:a]`和`S[a:len(S)]`（切片）而不是逗号。

## 关于切片的注意事项...

您不必在`len(S)`此处指定前导零或尾随 - 它们是隐含的。所以你可以用`S[:a]`和`S[a:]`来表示同样的意思。

另请注意，`S[0:a] + S[a:len(S)]`相当于`S`. 您可能不想在`+`其中包含 ，因此您可能想`S[a+1:len(S)]`改用。

## 关于在字符串中查找字符位置的另一个注意事项

您不需要手动循环索引 - 已经有`.index()`字符串的方法可以做到这一点：

```
>>> "hello".index("e")
1 
```

# 实现总体目标的更简单方法

您可以只使用该`split()`函数来获取由字符分隔的字符串部分`+`：

```
S = input()
number_strings = S.split('+')
numbers = [int(n) for n in number_strings]
print sum(numbers) 
```

作为奖励，这将适用于任意数量的数字 -`1+2+3`会起作用，就像`4`.

第三行使用所谓的[列表推导](http://www.youtube.com/watch?v=pShL9DCSIUw)来对列表的每个元素进行操作并生成一个新元素——在这种情况下，获取一个字符串列表并制作一个整数列表。

第四行利用了 Python 的内置`sum()`函数，它会自动返回一系列项目的总和。

请注意，您还可以压缩上述行：

```
print sum(int(n) for n in input().split('+')) 
```

这是一种更整洁的形式；我只是在上面隔开，以便更容易解释。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T21:17:16.397

`0, a`是一个元组。您的意思是通过 对序列进行**切片**`S[0:a]`吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-24T21:19:48.917

您需要将 , 修改为：

```
Sum = (S[0:a])+(S[a: len(S)]) 
```

# asp.net-mvc - mvc应用本地化

> ID：14025756
> 
> 赞同：3
> 
> 时间：2012-12-24T21:16:07.143
> 
> 标签：asp.net-mvc, localization

我正在使用一个需要为大量国家/地区本地化的 MVC4 应用程序。因此我需要本地化视图、字符串等。本地化 mvc 应用程序的标准做法是什么？它是一个具有特定命名约定的资源文件来突出显示视图吗？还是每个视图 1 个资源文件？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-25T08:50:13.213

当您考虑**MVC App的****本地化**时，您应该考虑以下提到的场景。

 **1.  视图验证
2.  简单的文化切换机制
3.  模型验证消息本地化
4.  DisplayName 属性本地化
5.  输出缓存和本地化

有关上述方案的更多详细信息，请查看[**ASP.NET MVC 本地化完整指南**](http://adamyan.blogspot.com/2010/02/aspnet-mvc-2-localization-complete.html)

和[**Scott Hanselman 博客文章**](http://www.hanselman.com/blog/GlobalizationInternationalizationAndLocalizationInASPNETMVC3JavaScriptAndJQueryPart1.aspx)

我希望这对你有帮助。**

# java - 如何使用 JDOM 设置布尔字段

> ID：14025768
> 
> 赞同：1
> 
> 时间：2012-12-24T21:17:38.083
> 
> 标签：java, xml, boolean, setter, jdom

只是一个简单的问题，有没有人知道当您想在 java 中使用 JDOM 更改 xml 文件中的布尔字段的值时使用什么正确的方法？

例如，我知道如果我想改变一个字符串字段的值，我所要做的就是：

```
documentLevelFieldChild.getChild("Value").setText("This is the new text"); 
```

我试过了，

```
documentLevelFieldChild.getChild("Value").setValue(false); 
```

但这似乎不起作用。

我尝试查找 API 并找到了一个与获取 bool 值相关的方法，但与设置它无关。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T21:20:30.380

```
documentLevelFieldChild.getChild("Value").setText("false"); 
```

# java - 如何在 CharSequence 中获取 EXACT 字符？

> ID：14025769
> 
> 赞同：2
> 
> 时间：2012-12-24T21:17:41.677
> 
> 标签：java, android, charsequence

当我知道字符在其中的位置（或键）时，我只想提取**CharSequence中的确切字符！**

`For eg: In the CharSequence "HELLO" I want to Extract the letter in the position 2 which is "E" in this case`. *我怎样才能做到这一点？*

**更具体地说：** 我正在构建一个 Android 应用程序，我在其中使用 TextWatcher 获取人们在 TextEdit 字段中输入的文本，如下所示。

```
 EditText KeyLogEditText = (EditText) findViewById(R.id.editTextforKeyLog);
    KeyLogEditText.addTextChangedListener(new TextWatcher() {

        @Override
        public void onTextChanged(CharSequence s, int start, int before, int count) {
            // Here is where I need help!!
            // I have the "start" and "before" keys I have the position of the character inserted
            // I need to obtain the EXACT character from the CharSequence "s", How do I Do that?                

        }

        @Override
        public void beforeTextChanged(CharSequence s, int start, int count,
                int after) {
            // TODO Auto-generated method stub

        }

        @Override
        public void afterTextChanged(Editable s) {
            // TODO Auto-generated method stub

        }
    }); 
```

我的问题也在代码中进行了注释。

感谢任何人都可以提供的任何帮助。阿迪特

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-24T21:19:20.223

使用上[的`charAt()`方法](http://developer.android.com/reference/java/lang/CharSequence.html#charAt%28int%29)`CharSequence`。

# rsa - 电子密码本 (ECB) 密码链接

> ID：14025773
> 
> 赞同：0
> 
> 时间：2012-12-24T21:18:16.163
> 
> 标签：rsa, block, encryption, ecb

我需要使用 ECB（电子密码本）作为学校作业来实现 RSA 算法。我知道 ECB 很糟糕，我不应该在现实生活中使用这样的东西，但我在这里别无选择（我们最终会将它转为 CBC，然后转向 AES，但目前我需要使用 ECB）。

我偶然发现了链接加密块的问题：假设我有一个大小为 256 位的密钥，因此我将每个块大小设置为 256 位（块大小 = 密钥大小）。我还确保填充最后一个块，以防它的大小更小。问题是加密的块结果大小不同，所以我不知道如何链接结果，这样当我解密数据时，我会确切地知道一个块何时开始以及何时结束。在这种情况下，常见的做法是什么？我想过在每个块之间放置某种分隔符，但我认为这是一个糟糕的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T22:11:14.567

RSA 使用内部填充，因此您不需要填充输入。RSA 加密通常可以在两种不同的填充模式下执行：OAEP 和 PKCS#1.5 填充。*两者都为每个块*添加大量填充。这与例如 AES 填充不同，其中填充仅在要加密*的最后一个块上执行。*同样不同的是，RSA 的安全性严重依赖填充，因此*必须*执行。

现在，因为每个块都被填充，显然适合块的纯文本小于密钥大小（模数的大小）。换句话说，块大小小于密钥大小。在 PKCS#1.5 的情况下，它比密钥大小小 11 个字节（如果这至少在字节边界上）。尽管在安全性方面保持稍高（比如最多 19 个字节）的块大小会更好，但填充的 8 个字节应该是（安全的）随机字节。

使用 Java，您实际上可以从`Cipher`对象中询问块大小，而对于 RSA，它将正确地从密钥大小中减去开销。否则你将不得不自己计算。如前所述，您不需要填充最后一个块，块填充将为您填充最后一个块。

请注意，RSA PKCS#1 规范是免费下载的。因此，您可以自己计算（更严格的）OAEP 填充。不过，对于您的特定任务，我会保持 1.5 填充。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T21:37:18.343

ECB 是一种[分组密码操作模式](http://en.wikipedia.org/wiki/Block_cipher_modes_of_operation)。 [RSA](http://en.wikipedia.org/wiki/RSA_%28algorithm%29)是一种公钥加密方案，而不是[分组密码](http://en.wikipedia.org/wiki/Block_cipher)，因此“ECB 模式下的 RSA”实际上没有任何意义。我怀疑在您的原始作业和您在这里对它的描述之间一定有什么东西混淆了。

在任何情况下，实际分组密码的输出长度始终是恒定的（并且等于输入分组长度）。*可能*让您感到困惑的一件事是加密输出有时可能包含空字节，因此您不能将其视为以空字符结尾的字符串。只需将输出视为固定长度的二进制数据块，就可以了。

# php - PHP INT Array In WHERE 子句 - 数组到字符串的转换

> ID：14025774
> 
> 赞同：0
> 
> 时间：2012-12-24T21:18:16.597
> 
> 标签：php, arrays

*   使用 PHP 和 SQLSRV 驱动程序

我必须根据患者 ID 显示来自 SQL Server 数据库的二进制图像。患者 ID 和图像位于两个不同的数据库中。

从第一个数据库中，我根据输入的患者 ID 查询图像 ID，并将结果添加到 array() 中。然后我想使用这个 ID 数组从第二个数据库中获取图像。

问题：在我的 sql 语句的 WHERE 原因中使用数组时出现以下错误：

**注意：数组到字符串的转换...**

我真的很迷茫。

以下是我的代码：

```
<?php
// ------------------------------------------------------------
// SCANNED IMAGES SEARCH CLASS
// used to retreive binary images from sql server database
// ------------------------------------------------------------

class ScannedImages extends DbConnect {
    // ------------------------------------------------------------
    // PROPERTIES
    // ------------------------------------------------------------
    public $imageOutput = NULL;

    // ------------------------------------------------------------
    // GET SCANNED IMAGE IDS FROM RIS BASED ON PATIENT ID
    // ------------------------------------------------------------
    public function getImagesByPatientId($sentPatientId) {

        // ------------------------------------------------------------
        // 1\. GET IMAGE IDS AND PUT THEM IN AN ARRAY
        // ------------------------------------------------------------

        // connect to [[[FusionRIS]]] database
        $conn1 = $this->sqlSrvConnect_2();

        // get image IDs based on patient ID
        $sql1 = "SELECT DocMgtImageID FROM tbDocMgtImagesAffiliations WHERE PatientID = $sentPatientId";
        $stmt1 = sqlsrv_query($conn1, $sql1);

        // exit if there is problem retrieving the data
        if($stmt1 === false) {
            die(var_dump(sqlsrv_errors(), true));
        }

        // image id array
        $imageIdArray = array();

        // loop through the results
        while($row1 = sqlsrv_fetch_array($stmt1, SQLSRV_FETCH_ASSOC)) {
            $imageIdArray[] = $row1['DocMgtImageID'];
        }

        // ------------------------------------------------------------
        // 2\. GET IMAGES BASED ON ARRAY OF IMAGE IDS
        // ------------------------------------------------------------

        // connect to [[[DocMgmt]]] database
        $conn2 = $this->sqlSrvConnect_1();

        // get images based on ids in array 33482
        $sql2 = "SELECT ImageData FROM tbDocMgtImages WHERE DocMgtImageID IN ($imageIdArray)";
        $stmt2 = sqlsrv_query($conn2, $sql2);

        // exit if there is problem retrieving the data
        if($stmt2 === false) {
            die(var_dump(sqlsrv_errors(), true));
        }

        // convert binary to image
        function data_uri($file, $mime) {
            $base64 = base64_encode($file);
            return "data:$mime;base64,$base64";
        }

        // counter for image display
        $count = 0;

        // loop through the results
        while($row2 = sqlsrv_fetch_array($stmt2, SQLSRV_FETCH_ASSOC)) {
            $count++;
            $this->imageOutput .= '<a href="#"><img src="'. data_uri($row2['ImageData'], 'image/jpeg') .'" alt=""><span>'. $count .'</span></a>';
        }

        // free the statement and connection resources
        sqlsrv_free_stmt($stmt1);
        sqlsrv_close($conn1);

        sqlsrv_free_stmt($stmt2);
        sqlsrv_close($conn2);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T21:26:13.217

那是因为您试图将数组解释为字符串。您需要通过执行以下操作明确地将此转换为字符串：

```
$sql2 = "SELECT ImageData FROM tbDocMgtImages WHERE DocMgtImageID IN (" . implode(',', $imageIdArray) . ")"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T21:25:23.243

您正在将 $imageIdArray 传递到 sql 中，您应该先将其内爆

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-24T21:25:54.263

您可以在这样的查询中发送一个原始数组。您需要将其转换为预期的字符串，例如`1,2,3,...`.

```
$query = sprintf("SELECT ImageData FROM tbDocMgtImages WHERE DocMgtImageID IN (%s)", implode(',', $imageIdArray)); 
```

现在我假设这些不是用户输入，并且是另一个数据库中的 INTEGER 类型列，因此不需要引用，但在其他情况下，您需要确保在内爆之前转义每个值。

# visual-studio - 如何在 Visual Studio 2012 中跳过（跳过调试）具体程序集

> ID：14025779
> 
> 赞同：1
> 
> 时间：2012-12-24T21:19:42.597
> 
> 标签：visual-studio, visual-studio-2012, visual-studio-debugging

在我的解决方案中，我有消息传输程序集的来源。在调试时，我想跳过进入这个程序集的毛茸茸的源代码，但我仍然需要进入它调用的处理程序方法。是否可以以某种方式标记该程序集，以便调试器跳过进入它的内部内容？

我不适合更改该程序集的来源，设置特殊属性`[DebuggerStepThrough]`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-25T20:13:39.230

如果您转到“模块”窗口并确保未加载此程序集的符号，则调试器将不会进入其中。您可能让 Visual Studio 缓存符号，并且每次调试时，符号都会自动从缓存中加载。转到选项 -> 调试 -> 符号并确保没有加载缓存的符号，然后在不加载此特定模块的符号的情况下调试您的解决方案，您应该一切顺利。

# c++ - 在 Emacs 中运行 cpp 程序

> ID：14025781
> 
> 赞同：2
> 
> 时间：2012-12-24T21:19:59.323
> 
> 标签：c++, emacs

我开始在 windows 中使用 emacs 编辑器编写 cpp 程序。

我想知道我需要哪些其他软件才能完全在 emacs 中运行这些程序。我需要知道在哪里可以找到 cpp 程序中包含的常用 h 文件以及将它们放在哪里。

我迷失在谷歌搜索中，需要程序员的建议。之前，我在 CodeBlocks 工作，但现在我想切换到 emacs。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-24T21:23:39.550

使用 Emacs，您可以将 shell 执行到帧中。您只需使用 Cx 2 或 Cx 3 分割您的屏幕，然后键入 Mx shell 来启动 shell...在那里，您可以调用 gcc 来构建您的应用程序（或您的 Makefile），然后执行他（./a 。出去）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-24T21:22:03.030

使用“Mx shell”来启动一个shell，然后输入./a.out（或者你的程序被调用的任何东西）。如果您使用的是 linux 机器，则不需要额外的东西。

# actionscript-3 - Flash AS3 函数跟踪相同的值

> ID：14025783
> 
> 赞同：2
> 
> 时间：2012-12-24T21:20:04.143
> 
> 标签：actionscript-3, flash

有人可以解释为什么下面的跟踪返回数组的长度而不是数组项中“i”的值吗？

非常感谢，尼克

**AS3**

```
function createMarkers(mapLocations){
    var markerArray:Array = new Array();
    for(i=0; i<mapLocations.length; i++){
        markerArray.push(new marker());
        markerArray[i].x=mapLocations[i][1];
        markerArray[i].y=mapLocations[i][2];

        markerArray[i].markerText.text = mapLocations[i][0].toString();
        markerArray[i].addEventListener(MouseEvent.CLICK, function(e:MouseEvent){clickTarget(e,i);});
        bgImage.addChild(markerArray[i]);
    }
}

function clickTarget(e:MouseEvent,a){
    trace(a);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-24T22:55:01.097

这是处理 JavaScript/ActionScript 函数时的常见错误。您遇到了问题，因为函数是*闭包*，这意味着它们在定义函数时持有对范围内定义的变量的引用。

这意味着您的匿名处理函数在变量周围*关闭*`i`，但它存储对它的引用，而不是它的值。由于`i`变化，每个函数都持有对同一个变量的引用，该变量将只保存分配给它的最后一个值。

基本上，如果要关闭变量的特定值，则必须在函数范围内*声明*变量（使用语句）。`var`因此，这看起来应该可以工作：

```
for (var i:int = 0; i < 10; i++) {
    var scopedI:int = i;
    mc[i].addEventListener(MouseEvent.CLICK, function (e:MouseEvent) { trace(scopedI); });
} 
```

我们在循环的范围内声明了一个新变量 ，`scopedI`以专门关闭该值，因为该变量将在循环的每次迭代中重新声明为唯一值。不幸的是，ActionScript 和 JavaScript 一样，*没有*块级作用域，只有函数级作用域，所以所有的变量声明都被“提升”到了函数的顶部。

这几乎只是意味着您的类型与在该函数中声明的任何其他变量`scopedI`具有相同的范围。`i`那么，我们怎样才能创建一个新的范围呢？具有更多功能。请记住，在 ActionScript 中，函数是对象，因此我们可以做如下疯狂的事情：

```
(function (id) {
    return function () { trace(id); };
})(7); 
```

那段代码创建了一个函数，然后立即使用参数值执行`7`它`id`。这很有用，因为 now`id`的作用域是我们返回的内部函数，所以无论外部发生什么，该函数总是会打印“7”。

同样，我们可以使用它来限定`i`循环中的变量。您的代码可以更新为如下所示：

```
function createMarkers(mapLocations){
    var markerArray:Array = new Array();
    for(var i = 0; i < mapLocations.length; i++){
        markerArray.push(new marker());
        markerArray[i].x = mapLocations[i][1];
        markerArray[i].y = mapLocations[i][2];

        markerArray[i].markerText.text = mapLocations[i][0].toString();
        markerArray[i].addEventListener(MouseEvent.CLICK, (function (scopedI) {
                return function (e:MouseEvent) { clickTarget(e, scopedI); };
            })(i));
        bgImage.addChild(markerArray[i]);
    }
}

function clickTarget(e:MouseEvent, a){
    trace(a);
} 
```

现在，`scopedI`每次迭代都是唯一的。是的，语法有点混乱，但这最终成为语言的一个非常强大和富有表现力的特性。如果你能理解它，它会非常有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-25T04:04:50.540

除了亚历克西斯所说的，

由于您要添加点击事件，我假设该项目是一个显示对象。

与 Javascript 不同，您还可以命名项目并在处理程序中检索它，例如：

```
 ...
        markerArray[i].name = "marker" + i; 
        markerArray[i].addEventListener(MouseEvent.CLICK, clickTarget);
        bgImage.addChild(markerArray[i]);
    }
}

function clickTarget(e:MouseEvent){
    var a = e.currentTarget.name.substr(6);
    trace(a);
} 
```

当然，到目前为止，还假设 name 属性对您毫无用处。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-24T21:46:45.320

Because your inline mouse event is capturing the *variable* `i` (a reference) instead of its value.

Try this:

```
function createMarkers(mapLocations){
    var markerArray:Array = new Array();
    for(var i:Number = 0; i<mapLocations.length; i++){
        var thisI:Number = i;
        markerArray.push(new marker());
        markerArray[thisI].x=mapLocations[thisI][1];
        markerArray[thisI].y=mapLocations[thisI][2];

        markerArray[thisI].markerText.text = mapLocations[thisI][0].toString();
        markerArray[thisI].addEventListener(MouseEvent.CLICK,
            function(e:MouseEvent){
                clickTarget(e,thisI);
            });
        bgImage.addChild(markerArray[thisI]);
    }
} 
```

This should work because `thisI` is being recreated with each iteration of the loop.

# breeze - 没有服务器元数据的 Breezejs

> ID：14025788
> 
> 赞同：3
> 
> 时间：2012-12-24T21:20:38.277
> 
> 标签：breeze

和微风一起玩。这是一个代码：

```
var dataService = new breeze.DataService({
                    serviceName: "/api/articles",
                    hasServerMetadata: false
                });
                var ms = new breeze.MetadataStore();

                var manager = new breeze.EntityManager({
                    dataService: dataService,
                    metadataStore: ms
                });

                var query = new breeze.EntityQuery().from("Query");

                manager.executeQuery(query).then(function (data) {
                    // this fails
                    var articles = manager.executeQueryLocally(query);
                    console.log(articles);
                }).fail(function(e) {
                    alert(e);
                }); 
```

没有行**var 文章 = manager.executeQueryLocally(query);** 一切都好。它说“实体类型为空”。我想我需要添加实体类型但不确定如何添加？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T01:53:44.507

从 v 0.81.2 开始，现在有一个示例使用了没有服务器元数据的微风，针对内存中的服务器端数据存储运行。该示例称为 ToDo-NoEF，可从微风站点下载。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T18:28:43.780

EntityType 信息可以通过 AddEntityType 方法添加到 metadataStore。metadataStore 最容易通过 EntityManager 的 metadataStore 属性访问。

我们还将在下周左右使用没有服务器元数据的微风添加示例。但现在...

这是一个将实体类型添加到 metadataStore 的简单示例。这只是部分示例，因为还需要添加其他相关类型才能完成它。

```
 var et = new EntityType({
            shortName: "Person",
            namespace: "Sample_WebApi.Models"
        });
        et.addProperty( new DataProperty({
            name: "personId",
            dataType: DataType.Int32,
            isNullable: false,
            isPartOfKey: true,
        }));
        et.addProperty(new DataProperty({
            name: "firstName",
            dataType: DataType.String,
            isNullable: false,
        }));
        et.addProperty(new DataProperty({
            name: "lastName",
            dataType: DataType.String,
            isNullable: false,
        }));
        et.addProperty(new DataProperty({
            name: "birthDate",
            dataType: DataType.DateTime,
            isNullable: true
        }));
        et.addProperty(new NavigationProperty({
            name: "meals",
            entityTypeName: "Meal",
            isScalar: false,
            associationName: "personMeals"
        }));
        metadataStore.addEntityType(et); 
```

# symfony - 在 Symfony2 中限制多对多关系结果

> ID：14025789
> 
> 赞同：5
> 
> 时间：2012-12-24T21:20:39.017
> 
> 标签：symfony, doctrine-orm

我有两个实体问题和标签。它们之间存在多对多关系，并且生成了一个“tag_question”表（带有 question_id 和 tag_id 列）。

```
$questions = $tag->getQuestion(); 
```

当它被执行时，它返回所有结果，所有带有标签的问题。该方法由 Tag 实体中的 Doctrine2 自动生成。如何限制结果（添加分页等）？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-25T00:08:34.390

如果性能对您来说不是一个大问题，那么使用 Doctrine 获取对所有 Question 实体的引用并让 PHP 进行过滤（而不是让 MySQL 进行）应该不是什么大问题。请记住，默认情况下，Doctrine 不会返回完整的实体。相反，它返回一个代理对象（稍后可以通过对数据库的另一个查询来更充分地补充它）：

```
class Question
{
    public function getQuestions($offset = 0; $length = null)
    {
        return array_slice( $this->questions, $offset, $length );
    }
} 
```

但是，如果性能是一个问题，您可能需要考虑使用执行自定义 DQL 查询或 Doctrine 的 QueryBuilder 类的方法创建一个自定义存储库类：

```
class TagRepository
{
    public function findSomeByQuestion($question, $offset, $length)
    {
        $qb = $this->createQueryBuilder("tag")
            ->select("tag")
            ->join("tag.questions", "questions")
            ->where("question.id = :questionId")
            ->setParameter("questionId", $question->getId())
            ->setFirstResult($offset)
            ->setMaxResults($length);
        return $qb->getQuery()->getResult();
    }
} 
```

# c++ - 如何检测用户何时按下电源关闭按钮？

> ID：14025794
> 
> 赞同：8
> 
> 时间：2012-12-24T21:21:44.887
> 
> 标签：c++, c, linux, power-management

我有一个运行 Ubuntu 12.4.1 的街机鸡尾酒柜（没有键盘，只有一个操纵杆和按钮），当按下电源按钮时会出现一个弹出窗口并且系统正常关闭，但是当我的全屏游戏启动器菜单应用程序正在运行时然后按下按钮没有效果。我想在按下按钮时捕获事件，以便我的应用程序可以触发系统关闭。我的菜单应用程序是用 C++ 编写的，并且正在使用 SDL。关于如何捕获电源关闭按钮按下事件的任何想法？

感谢那些回复的人，这是我用来让它工作的实际代码：

**班级成员：**

```
int m_acpidsock;
sockaddr_un m_acpidsockaddr; 
```

**设置代码：**

```
/* Connect to acpid socket */
m_acpidsock = socket(AF_UNIX, SOCK_STREAM, 0);
if(m_acpidsock>=0)
{
    m_acpidsockaddr.sun_family = AF_UNIX;
    strcpy(m_acpidsockaddr.sun_path,"/var/run/acpid.socket");
    if(connect(m_acpidsock, (struct sockaddr *)&m_acpidsockaddr, 108)<0)
    {
        /* can't connect */
        close(m_acpidsock);
        m_acpidsock=-1;
    }
} 
```

**更新代码：**

```
/* check for any power events */
if(m_acpidsock)
{
    char buf[1024];
    int s=recv(m_acpidsock, buf, sizeof(buf), MSG_DONTWAIT);

    if(s>0)
    {
        buf[s]=0;
        printf("ACPID:%s\n\n",buf);
        if(!strncmp(buf,"button/power",12))
        {
            setShutdown();
            system("shutdown -P now");
        }
    }
} 
```

**关闭套接字代码：**

```
if(m_acpidsock>=0)
{
    close(m_acpidsock);
    m_acpidsock=-1;
} 
```

最后，我需要允许非 root 用户关闭，并且可以使用以下行：

```
sudo chmod u+s /sbin/shutdown 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-24T21:34:26.440

您可以只启动一个线程来读取`/proc/events/acpi`，并在那里解码消息。

但是如何使用`acpid`来做到这一点？你会听`/var/run/acpid.socket`，当你关心的消息进来时，做你必须做的。

见： [http ://www.linuxmanpages.com/man8/acpid.8.php](http://www.linuxmanpages.com/man8/acpid.8.php)

我希望这很有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-24T21:35:09.780

看看[acpid](http://linux.die.net/man/8/acpid)`/etc/acpi/` ，我认为您可以专门更改其中一个脚本`/etc/acpi/powerbtn.sh`以添加自定义命令。您也可以尝试`/proc/acpi/event`自己阅读。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-24T21:35:34.083

按下电源按钮会触发 ACPI 事件，acpid 会触发脚本以响应 /etc/acpi/events 中的配置。在这种情况下，您需要 /etc/acpi/powerbtn，它看起来像这样：

```
event=button[ /]power
action=/etc/acpi/powerbtn.sh 
```

您可以自定义 /etc/acpi/powerbtn.sh，或将其指向您选择的另一个脚本。

# android - 如何在 Intent 中将 PendingIntent 发送到我的服务

> ID：14025797
> 
> 赞同：7
> 
> 时间：2012-12-24T21:22:03.483
> 
> 标签：android

我想告诉我的服务在完成执行操作后要做什么。所以我想发送服务 a `PendingIntent`，所以它可以启动它（通过使用`PendingIntent.send()`）

```
PendingIntent pendingIntent;
Intent newInt;
newInt = new Intent(Intent.ACTION_SENDTO);
newInt.setData( Uri.parse( "sms:052373"));
newInt.putExtra("sms_body", "The SMS text");
pendingIntent = PendingIntent.getActivity(this, 0, newInt, 0); 
```

现在的问题是如何开始附加`pendingIntent`到`pendingIntent`?

我试过这个例如：

```
NewIntent.putExtra("pendingIntent",pendingIntent);
startService(NewIntent); 
```

但它不起作用。

在服务中：

```
PendingIntent pendingIntent = (PendingIntent) intent.getParcelableExtra("pendingIntent");
pendingIntent.send(); 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-24T22:07:55.360

我成功了！

看到这个：

```
PendingIntent pendingIntent;
Intent ownIntent;

ownIntent = new Intent(Intent.ACTION_SENDTO);
ownIntent.setData(Uri.parse("sms:0523737233"));
ownIntent.putExtra("sms_body", "The SMS text");
Log.e("abc", "7");
pendingIntent = PendingIntent.getActivity(this, 0, ownIntent, Intent.FLAG_ACTIVITY_NEW_TASK);
Log.e("abc", "9");

ownIntent.putExtra("pendingIntent", pendingIntent);
ownIntent.putExtra("uriIntent", ownIntent.toUri(0));
startService(ownIntent); 
```

并在服务中：

```
PendingIntent pendingIntent = (PendingIntent) intent.getParcelableExtra("pendingIntent");
pendingIntent.send(); 
```

# jquery - jQuery单击后退按钮时如何加载内容

> ID：14025801
> 
> 赞同：3
> 
> 时间：2012-12-24T21:22:55.537
> 
> 标签：jquery, ajax, jquery-load

单击链接时，我正在使用 jQuery 加载页面内容，

```
$(document).on('click', 'nav a', function (e) {
    e.preventDefault();

    var url = $(this).attr("href");
    window.history.pushState('', '', url);
    url += " #main_wrapper > *";

    $('#main_wrapper').load(url);

}); 
```

问题是当我单击“后退”按钮时，URL 发生变化，但什么也没有发生。单击“后退”按钮后，如何再次加载内容？

当单击新链接时，如何停止/取消现有加载？

谢谢。

编辑：

这就是我实现它的方式，您可以根据需要轻松修改它。

```
window.onpopstate = function(event) {

    $('aside nav a').removeClass('active');
    $('a[href="' + document.location + '"]').addClass('active')

    $('#main_wrapper').load(document.location +" #main_wrapper > *");

}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T21:29:57.997

> 单击后退按钮时如何再次加载内容？

您需要将事件处理程序分配给`popstate`事件以处理“后退”按钮按下，如此[处](https://developer.mozilla.org/en-US/docs/DOM/window.onpopstate)所述。使用此处理程序，您可以分析当前的历史状态并相应地扩充您的页面。

> 当单击新链接时，如何停止/取消现有加载？

不幸的是，您不能使用 来执行此操作`.load`，因为它会返回 'originator' jQuery 对象。但是，如果您将其转换为更底层的`$.ajax`调用（哪个`success`函数应该将响应加载到带有 的元素中`.html()`，您可以调用`.abort`返回的 jqXHR 对象。

# jsf - JSF 生命周期以验证结束

> ID：14025802
> 
> 赞同：0
> 
> 时间：2012-12-24T21:23:02.617
> 
> 标签：jsf, primefaces

我有一个`<p:commandButton action=#{bean.action} .../>`. 不调用操作方法。我读到[h:commandButton 没有被调用](https://stackoverflow.com/questions/2118656/hcommandlink-hcommandbutton-is-not-being-invoked)。No 1-2 被选中，No 4-11 不适用于我的。对于 No 3，我使用 AfterPhase 方法构建了一个 PhaseListener：

```
public void afterPhase(PhaseEvent event) {
    System.out.println("after Phase: "+event.getPhaseId());
    FacesContext f= event.getFacesContext();
    List<FacesMessage> ml = f.getMessageList();
    for (FacesMessage m:ml){
        System.out.println(m.getSummary()+": "+m.getDetail());
    }
} 
```

这表明循环以 PROCESS_VALIDATIONS(3) 阶段结束，但没有消息。我在调试模式下重新启动了我的 servlet 容器，并为捕获和未捕获的 ValidatorExceptions（包括其子类）设置了断点。但是 non 被抛出。

接下来我可以在哪里看？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T23:41:51.143

在最小化代码以发布 SSCCE 期间（请参阅上面的评论），我将 a 更改为`<p:commandButton>`导致`<h:commandButton>`a

`javax.el.PropertyNotFoundException: Target Unreachable, 'someField' returned null`

因为`<h:inputText value="#{someBean.someField.someOtherField}">`在表格中。在这种情况下，PrimeFaces CommandButton 不会呈现错误消息。

# visual-studio-2010 - 重新安装visual-studio 2010后，cvCaptureFromAVI/文件不起作用？

> ID：14025808
> 
> 赞同：0
> 
> 时间：2012-12-24T21:24:08.753
> 
> 标签：visual-studio-2010, opencv

当我调试程序时，上述所有函数都返回 null。文件路径正确。这发生在我重新安装 VS2010 之后。

我用这段代码检查...

```
int main() {
CvCapture *capture;
//capture = cvCaptureFromAVI("Cricketc1.avi"); //does not work
capture = cvCaptureFromFile("drawingroom.flv"); //does not work
//capture = cvCaptureFromCAM(0); //works
IplImage *image = NULL;
cvNamedWindow("video", 0);
    //while (1)
while (cvQueryFrame(capture)) {
    image = cvQueryFrame(capture);
    if (image)
        cvShowImage("video", image);
    cvWaitKey(40);
}
return 0;
} 
```

一旦控件进入while循环，窗口“视频”就会关闭......

甚至`cvLoadImage()`不工作。

我应该如何纠正它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-25T08:45:15.497

我之前使用的是 OpenCV 2.3，但在这个问题之后，我安装了 OpenCV 2.4，现在正在使用它。它现在工作正常，没有任何前所未有的错误......

谢谢大家！

# javascript - 具有隐藏功能的 Javascript 对象？

> ID：14025809
> 
> 赞同：2
> 
> 时间：2012-12-24T21:24:24.167
> 
> 标签：javascript, function, functional-programming

我想创建一个`foo.properties`返回的变量`{default:{x:undefined}}`。但是，您可能会注意到 properties 变量不可直接编辑，因此`__defineGetter__`用于使其可读但不可写。

问题是，如果您愿意，我还希望属性成为*getter*的一部分，而不是属性变量的一部分。然而，当您`foo.properties`在控制台中输入时，它会返回`{default:{x:undefined},attr:function(){ [native code] }}`. 如何阻止 attr 与属性变量关联？

```
var foo = new (function(){
    var properties = {
        default:{
            x:undefined
        }
    };
    this.__defineGetter__('properties',(function(){return properties;}).bind(this));
    this.properties.attr = (function(attr,value){
        var attr = attr.split('.');
        var recursive = function(attr,output,value){
            if(attr.length>1){
                return recursive(attr.slice(1),output[attr[0]],value);
            }else{
                if(value!=undefined){output[attr[0]] = value;};
                return output[attr[0]];
            };
        };
        return recursive(attr,properties,value || undefined);
    }).bind(this)
}); 
```

谢谢！

**编辑**

我认为当`this.properties.attr`设置*getter*时返回变量`properties`代替`this.properties`. 因此`properties`直接被编辑。也许可以使*getter*`properties`的返回值成为与实际变量分开的实体？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T02:58:42.110

好吧，让我直说吧。您有一个 getter，它返回 foo 范围内的变量。并且您只想将`.attr`属性添加到返回值，而不是更改 foo 范围内的变量？

如果这是正确的，那么你应该稍微不同地处理这个问题。您是正确的，它从 getter 返回值，这与变量相同。

所以，为了解决这个问题，我们首先需要克隆变量，分配`.attr`然后返回它。

这段代码可以解决问题：

```
var foo = new (function(){
    var properties = {
        default:{
            x:undefined
        }
    };
    this.__defineGetter__('properties',(function(){
      var temp = clone(properties);
      temp.attr = (function(attr,value){
            var attr = attr.split('.');
            var recursive = function(attr,output,value){
                if(attr.length>1){
                    return recursive(attr.slice(1),output[attr[0]],value);
                }else{
                    if(value!=undefined){output[attr[0]] = value;};
                    return output[attr[0]];
                };
            };
            return recursive(attr,properties,value || undefined);
        }).bind(this)
      return temp;
    }).bind(this));

});

function clone(obj){
    if(obj == null || typeof(obj) != 'object')
        return obj;

    var temp = obj.constructor();

    for(var key in obj)
        temp[key] = clone(obj[key]);
    return temp;
} 
```

这是一个演示[jsFiddle](http://jsfiddle.net/crzyman/sWn2s/1/)

希望有帮助！

# eclipse - 如何确定为什么 m2e 会减慢 Eclipse 构建速度？

> ID：14025812
> 
> 赞同：8
> 
> 时间：2012-12-24T21:24:35.697
> 
> 标签：eclipse, maven, m2e

我最近将项目构建从 ant 切换到 maven 和 m2e，这工作正常，现在突然每次我保存文件时，构建工作区都会占用大量时间，大约 5 到 10 秒，以前是当我刚刚保存一个文件时，我什至从未注意到 eclipse 做任何事情。

我猜测 m2e 在增量构建期间正在做一些事情，这会减慢速度。我不知道是什么导致了减速。我正在寻找可以尝试找出这种放缓的原因的东西。

我可以采取哪些选项或步骤来帮助我找出导致此问题的原因。

**更新：**这是一个多模块项目，包含 17 个模块、16 个罐子和一场战争。这是按照标准的 Maven 层次结构排列的。

**更新：**在非常快的机器上，Project clean all 需要大约 30 到 85 秒的挂钟时间。Web 项目本身需要大约 1 秒的时间来构建，我不知道问题出在 m2e 还是其他地方。

**更新：**保存 .java 文件会导致工作区重建，其长度可能为 0 到 15 秒，以不可预知的方式。

**更新：**我正在使用具有工作区工件分辨率的 m2e-wtp 扩展。

**更新：** m2e 日志文件的一些输出

```
2012-12-28 17:10:43,907 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping - Mojo execution key: org.apache.maven.plugins:maven-enforcer-plugin:1.2:enforce (execution: enforce-rules, phase: validate)
2012-12-28 17:10:43,907 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -     Action: ignore
2012-12-28 17:10:43,907 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping - Mojo execution key: pl.project13.maven:git-commit-id-plugin:2.1.2:revision (execution: default, phase: initialize)
2012-12-28 17:10:43,907 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -     Action: ignore
2012-12-28 17:10:43,907 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping - Mojo execution key: org.apache.maven.plugins:maven-resources-plugin:2.6:resources (execution: default-resources, phase: process-resources)
2012-12-28 17:10:43,908 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -     Action: execute
2012-12-28 17:10:43,908 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping - Mojo execution key: org.apache.maven.plugins:maven-compiler-plugin:2.5.1:compile (execution: default-compile, phase: compile)
2012-12-28 17:10:43,908 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -     Action: configurator
2012-12-28 17:10:43,908 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -         Project configurator id: org.eclipse.m2e.jdt.javaConfigurator
2012-12-28 17:10:43,908 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -         Project configurator: org.eclipse.m2e.jdt.internal.JavaProjectConfigurator
2012-12-28 17:10:43,908 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -     Action: configurator
2012-12-28 17:10:43,908 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -         Project configurator id: org.maven.ide.eclipse.configuration.wtp.webfragment.configurator
2012-12-28 17:10:43,908 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -         Project configurator: org.eclipse.m2e.wtp.WebFragmentProjectConfigurator
2012-12-28 17:10:43,908 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -     Action: configurator
2012-12-28 17:10:43,908 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -         Project configurator id: org.maven.ide.eclipse.configuration.wtp.utility.configurator
2012-12-28 17:10:43,908 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -         Project configurator: org.eclipse.m2e.wtp.UtilityProjectConfigurator
2012-12-28 17:10:43,908 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -     Action: configurator
2012-12-28 17:10:43,908 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -         Project configurator id: org.maven.ide.eclipse.configuration.wtp.java.unsupportedDependencyTypeConfigurator
2012-12-28 17:10:43,908 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -         Project configurator: org.eclipse.m2e.wtp.UnsupportedDependencyTypeProjectConfigurator
2012-12-28 17:10:43,908 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -     Action: configurator
2012-12-28 17:10:43,908 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -         Project configurator id: com.springsource.sts.ide.maven.core.springProjectConfigurator
2012-12-28 17:10:43,908 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -         Project configurator: org.springframework.ide.eclipse.maven.internal.core.SpringProjectConfigurator
2012-12-28 17:10:43,908 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping - Mojo execution key: org.apache.maven.plugins:maven-resources-plugin:2.6:testResources (execution: default-testResources, phase: process-test-resources)
2012-12-28 17:10:43,908 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -     Action: execute
2012-12-28 17:10:43,909 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping - Mojo execution key: org.apache.maven.plugins:maven-compiler-plugin:2.5.1:testCompile (execution: default-testCompile, phase: test-compile)
2012-12-28 17:10:43,909 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -     Action: configurator
2012-12-28 17:10:43,909 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -         Project configurator id: org.eclipse.m2e.jdt.javaConfigurator
2012-12-28 17:10:43,909 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -         Project configurator: org.eclipse.m2e.jdt.internal.JavaProjectConfigurator
2012-12-28 17:10:43,909 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -     Action: configurator
2012-12-28 17:10:43,909 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -         Project configurator id: org.maven.ide.eclipse.configuration.wtp.webfragment.configurator
2012-12-28 17:10:43,909 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -         Project configurator: org.eclipse.m2e.wtp.WebFragmentProjectConfigurator
2012-12-28 17:10:43,909 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -     Action: configurator
2012-12-28 17:10:43,909 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -         Project configurator id: org.maven.ide.eclipse.configuration.wtp.utility.configurator
2012-12-28 17:10:43,909 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -         Project configurator: org.eclipse.m2e.wtp.UtilityProjectConfigurator
2012-12-28 17:10:43,909 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -     Action: configurator
2012-12-28 17:10:43,909 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -         Project configurator id: org.maven.ide.eclipse.configuration.wtp.java.unsupportedDependencyTypeConfigurator
2012-12-28 17:10:43,909 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -         Project configurator: org.eclipse.m2e.wtp.UnsupportedDependencyTypeProjectConfigurator
2012-12-28 17:10:43,909 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -     Action: configurator
2012-12-28 17:10:43,909 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -         Project configurator id: com.springsource.sts.ide.maven.core.springProjectConfigurator
2012-12-28 17:10:43,909 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -         Project configurator: org.springframework.ide.eclipse.maven.internal.core.SpringProjectConfigurator
2012-12-28 17:10:43,909 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping - Mojo execution key: org.apache.maven.plugins:maven-surefire-plugin:2.12.4:test (execution: default-test, phase: test)
2012-12-28 17:10:43,909 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping - Mojo execution key: org.apache.maven.plugins:maven-war-plugin:2.3:war (execution: default-war, phase: package)
2012-12-28 17:10:43,909 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -     Action: configurator
2012-12-28 17:10:43,909 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -         Project configurator id: org.maven.ide.eclipse.configuration.wtp.configurator
2012-12-28 17:10:43,909 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -         Project configurator: org.eclipse.m2e.wtp.WTPProjectConfigurator
2012-12-28 17:10:43,909 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -         Build participant: org.eclipse.m2e.wtp.internal.filtering.ResourceFilteringBuildParticipant
2012-12-28 17:10:43,910 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -     Action: configurator
2012-12-28 17:10:43,910 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -         Project configurator id: org.maven.ide.eclipse.configuration.wtp.warmanifest.configurator
2012-12-28 17:10:43,910 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -         Project configurator: org.eclipse.m2e.wtp.internal.mavenarchiver.WarMavenArchiverConfigurator
2012-12-28 17:10:43,910 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -         Build participant: org.sonatype.m2e.mavenarchiver.internal.AbstractMavenArchiverConfigurator$1
2012-12-28 17:10:43,910 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -     Action: configurator
2012-12-28 17:10:43,910 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -         Project configurator id: org.maven.ide.eclipse.configuration.wtp.overlay.configurator
2012-12-28 17:10:43,910 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping -         Project configurator: org.eclipse.m2e.wtp.OverlayConfigurator
2012-12-28 17:10:43,910 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping - Mojo execution key: org.apache.maven.plugins:maven-install-plugin:2.4:install (execution: default-install, phase: install)
2012-12-28 17:10:43,910 [Worker-3] DEBUG o.e.m.c.p.c.AbstractCustomizableLifecycleMapping - Mojo execution key: org.apache.maven.plugins:maven-deploy-plugin:2.7:deploy (execution: default-deploy, phase: deploy) 
```

**更新：** 这原来是 Eclipse STS 中的弹簧工具错误且缓慢，摆脱弹簧项目性质解决了问题。似乎 Spring 源代码团队知道这些问题正在修复，请参阅下面的我的答案以获取一些链接。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-28T22:02:56.167

经过一番摸索，结果发现 Spring Tool Suite 3.1 是问题所在，一旦我从项目工作区中删除了弹簧性质，构建时间从 30 - 90 秒降至不到 3 秒。

*   [https://issuetracker.springsource.com/browse/STS-3036](https://issuetracker.springsource.com/browse/STS-3036)
*   [https://issuetracker.springsource.com/browse/STS-3017](https://issuetracker.springsource.com/browse/STS-3017)
*   [https://issuetracker.springsource.com/browse/STS-3054](https://issuetracker.springsource.com/browse/STS-3054)有许多与性能相关的问题的子任务。

当我更改它以打印出调试信息时，我发现它 `.metadata/.plugins/org.eclipse.m2e.logback.configuration/`包含用于 m2e 日志记录的配置文件`logback.1.2.0.20120903-1050.xml`

```
 <root level="DEBUG">
    <appender-ref ref="FILE" />
    <appender-ref ref="STDOUT" />
    <appender-ref ref="EclipseLog" />
    <appender-ref ref="MavenConsoleLog" />
  </root>

  <logger name="com.ning.http.client" level="DEBUG" /> 
```

我可以在此输出中获得输出，`.metadata/.plugins/org.eclipse.m2e.logback.configuration/0.log`该输出具有时间戳，并且当 .java 文件获取时，m2e 似乎不止一次运行。

我一直无法弄清楚如何使用日志文件中的信息来解决我的问题，我非常接近放弃 m2e。我在这里发布此信息，以防它可能对其他人有用。

# php - 裁剪本地图像文件

> ID：14025827
> 
> 赞同：5
> 
> 时间：2012-12-24T21:27:11.767
> 
> 标签：php, javascript, html

我有一个允许用户上传图像并裁剪它的表单我已经弄清楚了它的流程

1.用户上传图片
2.服务器处理并发送回浏览器
3.用户裁剪并发送到服务器
4.服务器处理并保存

有没有其他方法可以实现这一目标？
也许使用 javascript 加载图像，然后裁剪它，然后发送到服务器进行处理。
有办法吗？

**编辑** 我希望避免将这些图像发送到服务器进行处理。
可能使用 FileReader 加载文件。
我在谷歌上搜索它没有运气

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-25T06:32:38.110

您可以使用`FileReader`+`Canvas`读取本地文件，然后将其裁剪而不将其发送到服务器。

这是一个演示如何做到这一点。

```
<form><input type="file" id=f></form>
<canvas id=c width="600" height="600"></canvas>
<script>
var f = document.getElementById('f');
var canvas = document.getElementById('c');
var context = canvas.getContext('2d');
f.onchange = function() {
    var file = this.files[0];
    var reader = new FileReader();
    reader.onload = function(evt) {
        var img = new Image();
        img.onload = function() {
          context.drawImage(this, 0, 0, 100, 100, 0, 0, 100, 100);
          var pngUrl = canvas.toDataURL();
          //alert(pngUrl); // send this url to server to save the image
        }
        img.src = evt.target.result;
    }
    reader.readAsDataURL(file);
}
</script> 
```

你还需要做的是使用 jquery jcrop 插件来让用户选择裁剪区域，因为在这个演示中我只是硬编码了左上角 100x100 像素的裁剪。

看起来您需要使用[jcrops onSelect](http://deepliquid.com/content/Jcrop_Manual.html#Event_Handlers)事件来获取裁剪区域的原点 + 宽度 + 高度，并将这些值输入`context.drawImage`

希望你能处理剩下的，祝你好运

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T21:28:47.633

为此，[我会使用 jCrop](http://deepliquid.com/content/Jcrop.html)。确保您可以访问系统上的 ImageMagick 和/或 GD——您很可能需要它来进行处理。

编辑（2021 年 10 月 2 日）-原始链接/库似乎已被放弃。我还没有尝试过，但看起来它会起作用：[https ://jcrop.com/](https://jcrop.com/)

# yii - yii url manager 中的 URL 重写是什么

> ID：14025830
> 
> 赞同：0
> 
> 时间：2012-12-24T21:27:53.393
> 
> 标签：yii

我已经重写了网址

```
'compagnies' => 'site/compagnies', 
```

我想转换可以接受格式的url

```
http://www.example.com/compagnies-abc-def.com 
```

或者

```
http://www.example.com/compagnies-kdlsfj.com 
```

或者

```
http://www.example.com/compagnies-fdsf_sdf 
```

如何在 yii url manager 中编写它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T22:21:04.810

利用：

```
'compagnies-<identifier:.+>' => 'site/compagnies', 
```

然后，您将能够使用 访问*标识符*值`$_GET`，例如，如果 URL 是`compagnies-test`，您将能够访问 url 的“测试”部分，如下所示：

```
echo $_GET['identifier']; // echo's test 
```

# go - 存储切片的接口{}上的范围

> ID：14025833
> 
> 赞同：120
> 
> 时间：2012-12-24T21:28:44.347
> 
> 标签：go, reflection, slice, go-reflect

鉴于您有一个接受`t interface{}`. 如果确定`t`是一个切片，我如何`range`覆盖该切片？

```
func main() {
    data := []string{"one","two","three"}
    test(data)
    moredata := []int{1,2,3}
    test(data)
}

func test(t interface{}) {
    switch reflect.TypeOf(t).Kind() {
    case reflect.Slice:
        // how do I iterate here?
        for _,value := range t {
            fmt.Println(value)
        }
    }
} 
```

去游乐场示例：[http ://play.golang.org/p/DNldAlNShB](http://play.golang.org/p/DNldAlNShB)

* * *

## 回答 #1

> 赞同：163
> 
> 时间：2012-12-24T22:05:06.657

好吧，我使用`reflect.ValueOf`了，然后如果它是一个切片，您可以调用它`Len()`并`Index()`在值上获取`len`切片和元素的索引。我认为您无法使用范围操作来执行此操作。

```
package main

import "fmt"
import "reflect"

func main() {
    data := []string{"one","two","three"}
    test(data)
    moredata := []int{1,2,3}
    test(moredata)
} 

func test(t interface{}) {
    switch reflect.TypeOf(t).Kind() {
    case reflect.Slice:
        s := reflect.ValueOf(t)

        for i := 0; i < s.Len(); i++ {
            fmt.Println(s.Index(i))
        }
    }
} 
```

去游乐场示例：[http ://play.golang.org/p/gQhCTiwPAq](http://play.golang.org/p/gQhCTiwPAq)

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2018-06-11T16:48:31.693

如果您知道预期的类型，则不需要使用反射。您可以使用[类型 switch](https://golang.org/ref/spec#Type_switches)，如下所示：

```
package main

import "fmt"

func main() {
    loop([]string{"one", "two", "three"})
    loop([]int{1, 2, 3})
}

func loop(t interface{}) {
    switch t := t.(type) {
    case []string:
        for _, value := range t {
            fmt.Println(value)
        }
    case []int:
        for _, value := range t {
            fmt.Println(value)
        }
    }
} 
```

[查看操场上的代码](https://play.golang.org/p/b7b_-L1schG)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2021-01-09T06:14:58.980

扩展 masebase 提供的答案，您可以`interface{}`使用如下函数概括切片上的迭代：

```
func forEachValue(ifaceSlice interface{}, f func(i int, val interface{})) {
    v := reflect.ValueOf(ifaceSlice)
    if v.Kind() == reflect.Ptr {
        v = v.Elem()
    }
    if v.Kind() != reflect.Slice {
        panic(fmt.Errorf("forEachValue: expected slice type, found %q", v.Kind().String()))
    }

    for i := 0; i < v.Len(); i++ {
        val := v.Index(i).Interface()
        f(i, val)
    }
} 
```

然后，您可以像这样使用它：

```
func main() {
    data := []string{"one","two","three"}
    test(data)
    moredata := []int{1,2,3}
    test(data)
}

func test(sliceIface interface{}) {
    forEachValue(sliceIface, func(i int, value interface{}) {
      fmt.Println(value)
    }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2019-04-07T21:01:48.947

interface{} 的行为方式有一个例外，@Jeremy Wall 已经给出了指针。如果传递的数据最初被定义为 []interface{}。

```
package main

import (
    "fmt"
)

type interfaceSliceType []interface{}

var interfaceAsSlice interfaceSliceType

func main() {
    loop(append(interfaceAsSlice, 1, 2, 3))
    loop(append(interfaceAsSlice, "1", "2", "3"))
    // or
    loop([]interface{}{[]string{"1"}, []string{"2"}, []string{"3"}})
    fmt.Println("------------------")

    // and of course one such slice can hold any type
    loop(interfaceSliceType{"string", 999, map[int]string{3: "three"}})
}

func loop(slice []interface{}) {
    for _, elem := range slice {
        switch elemTyped := elem.(type) {
        case int:
            fmt.Println("int:", elemTyped)
        case string:
            fmt.Println("string:", elemTyped)
        case []string:
            fmt.Println("[]string:", elemTyped)
        case interface{}:
            fmt.Println("map:", elemTyped)
        }
    }
} 
```

输出：

```
int: 1
int: 2
int: 3
string: 1
string: 2
string: 3
[]string: [1]
[]string: [2]
[]string: [3]
------------------
string: string
int: 999
map: map[3:three] 
```

[试试看](https://play.golang.org/p/PsfWpRxVqYi)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-03-12T04:19:12.737

一个共同的功能

```
import (
    "fmt"
    "reflect"
)

func In(item interface{}, list interface{}) (ret bool, err error) {
    defer func() {
        if r := recover(); r != nil {
            ret, err = false, fmt.Errorf("%v", r)
        }
    }()
    itemValue, listValue := reflect.ValueOf(item), reflect.ValueOf(list)
    for i := 0; i < listValue.Len(); i++ {
        if listValue.Index(i).Interface() == itemValue.Interface() {
            return true, nil
        }
    }
    return false, nil
} 
```

不那么优雅但效果很好

```
fmt.Println(In(1, []int(2, 1, 3))) 
```

# android - 使用字符串选择数组

> ID：14025835
> 
> 赞同：0
> 
> 时间：2012-12-24T21:28:47.980
> 
> 标签：android, arrays, string, android-intent

我环顾四周，但找不到任何对我有帮助的东西。我的 android 应用程序使用选项卡导航，选项卡根据用户之前在活动中选择的部分而有所不同。因此，用户选择了一个项目，对应于所选项目的 id 将被转移到新活动中，并为每个可以选择的项目使用数组仅显示正确的选项卡。所以一个部分可能会导致五个标签，而另一个可能会导致三个标签。所以问题是我希望能够根据选择的 id 动态选择要使用的数组。

```
 String[] id1 = { "2", "4", "6", "8", "10", "12"};
    String[] id2 = { "1", "3", "5", "7", "9", "11"}; 

    Intent intent = getIntent();
    String idfromintent = intent.getStringExtra(PT_newspapers.INTENT_ID);   
    String arraysidname = "id"+idfromintent;

    for (int i = 0; i < arraysidname.length; i++) { 
        ActionBar.Tab tab = getSupportActionBar().newTab();
        tab.setText(arraysidname[i]);
        tab.setTabListener(this);
        getSupportActionBar().addTab(tab);

    } 
```

这是我遇到问题的地方，我知道这不是正确的方法，但是我找不到解决方法或找到有关如何使用要用于选择哪个数组的字符串（包含 id）的解决方案执行。任何见解将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T21:35:26.767

一个数组怎么样`String[]`：

```
String[][] id = {{ "2", "4", "6", "8", "10", "12"},{ "1", "3", "5", "7", "9", "11"}}; 
```

然后你可以直接通过索引引用。

# c# - 如何使用 C# 编辑网站中的文本字段？

> ID：14025836
> 
> 赞同：3
> 
> 时间：2012-12-24T21:29:00.367
> 
> 标签：c#, html, windows-phone

我是一名初学者 Windows Phone 开发人员，我想访问一个 url，使用字符串值（用于用户名和密码）登录网站并在下一个网页上检索数据。我会为此使用 webClient/WebBrowser 吗？我真的不明白我应该如何去“编辑”网页上的文本字段，填写我的用户名和密码等等。

一旦我设法登录到该网站，我希望在我的应用程序中显示一些数据，它们是文本值。我该怎么做呢？非常感谢所有帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-24T21:39:11.667

根据我的评论，我创建了一个方法，该方法接受一个 cookiejar（这允许跨请求的持久会话）一个 uri 和参数，并对 URI 进行发布。

```
 private static string PerformPostRequest(string uri, CookieContainer cookieJar, string parameters)
    {
        HttpWebRequest request = (HttpWebRequest)HttpWebRequest.Create(uri);
        request.ContentType = "application/x-www-form-urlencoded";
        request.Method = "POST";
        request.CookieContainer = cookieJar;

        byte[] bytes = Encoding.ASCII.GetBytes(parameters);
        Stream os = null;

        request.ContentLength = bytes.Length;  
        os = request.GetRequestStream();
        os.Write(bytes, 0, bytes.Length);

        if (os != null)
        {
            os.Close();
        }

        HttpWebResponse webResponse = (HttpWebResponse)request.GetResponse();
        StreamReader sr = new StreamReader(webResponse.GetResponseStream());

        return sr.ReadToEnd().Trim();
    } 
```

将所需的登录信息发布到登录页面后，您可以在下一页执行获取请求，并在那里解析数据。

```
 private static string PerformGetRequest(string uri, CookieContainer cookieJar)
    {
        HttpWebRequest request = (HttpWebRequest)HttpWebRequest.Create(uri);
        request.ContentType = "application/x-www-form-urlencoded";
        request.Method = "GET";
        request.CookieContainer = cookieJar;

        HttpWebResponse webResponse = (HttpWebResponse)request.GetResponse();
        StreamReader sr = new StreamReader(webResponse.GetResponseStream());

        return sr.ReadToEnd().Trim();
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-24T21:54:35.410

Stefan 的回答非常好。我将添加我认为缺少的概念部分。

文本字段或更通常称为 HTML 表单和输入标签/元素，只是人类使用键盘、鼠标和 javascript 事件填充所需的视觉表示。这些标签根本不需要在 Web 浏览器中进行编辑。不考虑 Ajax，简单的 Web 浏览器获取值并将它们格式化为请求（通常是 get 或 post）并将该请求发送到 http 服务器。使用 AJAX，请求还有一些必需的参数。

您真正需要的只是一个相当简单的两步过程。首先创建一个包含所需值的请求，然后将该请求发送到 http 服务器。这是对实际需要的一个非常笼统的想法。根据所讨论的网站，有一些警告可能会使这变得更加困难（例如，通常使用[CAPTCHA](http://en.wikipedia.org/wiki/CAPTCHA)来防止对某些请求进行这种类型的自动化）。

如果您可以控制网站或可以请求其他功能，我不会使用 HTML，而是强烈建议您使用 RESTful 或类似的 API 来访问您的应用程序。这将使您的应用程序中涉及的工作变得不那么复杂。

# android - Android ListView 文本颜色白色

> ID：14025839
> 
> 赞同：2
> 
> 时间：2012-12-24T21:30:15.067
> 
> 标签：android, listview

我有一个`listview`使用`adapter`具有备用背景颜色的自定义。问题是作为字符串的文本（超过 100 多个字符串）被设置为的颜色，`Color.BLACK`但`listview`在前几个字符串中是白色的，然后是黑色的。

```
@Override  
    public View getView(int position, View convertView, ViewGroup parent) {  
    View view = super.getView(position, convertView, parent);  
    TextView tv = (TextView) super.getView(position, convertView, parent);
    int colorPos = position % color.length; 
    tv.setTextColor(Color.BLACK);
    view.setBackgroundColor(color[colorPos]);  
    return view;  
} 
```

我无法检测到为什么第一个是白色然后其他是黑色的问题，是加载还是什么？因为我的文本（字符串）超过 100 个。

**更新**

这是列表视图代码：

```
MyAdapter adapter = new MyAdapter(this, 
    android.R.layout.simple_list_item_1,
    Strings.Advices);
setListAdapter(adapter); 
```

和字符串：

```
public class Strings {
    public static String Advices[] = {
       "advice",
       "advice",
       "adc",
       "add",
    };
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-24T21:35:28.560

你的 TextView 什么都不做。通常，您需要使用`findViewById()`在行布局中定位 TextView。由于您使用`android.R.layout.simple_list_item_1`的是 TextView 本身，我们可以跳过该步骤：

```
@Override  
public View getView(int position, View convertView, ViewGroup parent) {  
    View view = super.getView(position, convertView, parent);  
    TextView tv = (TextView) view;
    int colorPos = position % color.length; 
    tv.setTextColor(Color.BLACK);
    view.setBackgroundColor(color[colorPos]);  
    return view;  
} 
```

但是`getView()`任何内置的Adapter的方法都是非常通用的，因此速度很慢……你应该自己编写，以充分利用Adapter的回收器和ViewHolder的概念。请观看此 Google Talk [Turbo 为您的 UI](http://www.google.com/events/io/2009/sessions/TurboChargeUiAndroidFast.html)（和/或[ListView 世界](http://www.google.com/events/io/2010/sessions/world-of-listview-android.html)）充电，以帮助您编写高效的适配器。

> 问题是作为字符串的文本（超过 100+ 个字符串）被设置为 Color.BLACK 的颜色，但在列表视图中，前几个字符串是白色的，然后是黑色的

我假设当您滚动 ListView 时会发生这种变化，这与 View 回收器的行为方式*直接相关。*

# arrays - 记事本++添加到结束行

> ID：14025840
> 
> 赞同：2
> 
> 时间：2012-12-24T21:30:55.347
> 
> 标签：arrays, notepad++

我有一个包含名称列表的 txt 文件。

```
Tim
John
Steve
Melanie 
```

我想把列表变成：

```
Tim:"",
John:"",
Steve:"",
Melanie:"" 
```

如何`:"",`在这些名称的末尾添加/附加 。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-24T21:30:55.347

简单的。不要使用 notepad++ 正则表达式模式，而是使用扩展模式。

在 find what 字段中，放入`\r`并替换为字段 put`:"",`或您想要的键。

![在此处输入图像描述](../Images/cb2e16c2da16c065f630a602ab3231db.png)

# css - css - 机器特定的字体系列

> ID：14025845
> 
> 赞同：2
> 
> 时间：2012-12-24T21:31:48.230
> 
> 标签：css, font-family

我正在为自己编写一个示例网络应用程序，以便在我的计算机上运行。我想使用我的机器上存在的字体“Helvetica Neue UltraLight”。但是我无法让浏览器使用该字体。它可以使用“Helvetica Neue”，但不能使用 Ultralight 风味。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-25T00:07:25.097

您必须确定计算机中特定字体的名称并使用它。或者，您可以使用`@font-face`特定的字体文件名，前提是您使用正在使用的浏览器识别的字体格式。

如果字体的名称不容易猜到，您可能需要通过使用例如[DTL OTMaster Light](http://www.fontmaster.nl/)来分析字体的漫长路线。根据 CSS 规范，要使用的名称是 PostScript 名称或字体的全名。这些可以在名称表中与 nameID 值 6 和 4 对应的条目中找到。

或者您可以采取不同的方式并使用字体列表工具，例如[http://hasseg.org/stuff/fontList/example.html](http://hasseg.org/stuff/fontList/example.html)或[http://www.fileformat.info/info/unicode/font/fontlist.htm](http://www.fileformat.info/info/unicode/font/fontlist.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T21:39:33.993

根据您的操作系统，您必须在您的操作系统中安装字体并检查它的名称——它安装在系统中的位置，即不仅仅是字体的文件名。

作为一个更全球化和平台独立的解决方案，您可以使用网络字体，然后使用您的 CSS 实现它。以下网站将为您提供帮助：

[http://www.font2web.com/](http://www.font2web.com/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-24T21:44:38.297

从您的 CSS 文件中（或您定义样式的任何位置），您必须以下列方式引用该自定义字体：

```
@font-face {
    font-family: cool_font;
    src: url('cool_font.ttf');
} 
```

之后，您可以像使用普通 CSS 声明一样使用它：

```
p.custom_font{
    font-family: cool_font; /* no .ttf */
} 
```

通过这种方式，您可以在网站上使用尽可能多的自定义字体。

# android - Android WebView 打开 uTorrent

> ID：14025846
> 
> 赞同：-2
> 
> 时间：2012-12-24T21:32:25.623
> 
> 标签：android, webview

在手机上安装 utorrent 时，单击应用程序 webview 中的链接会打开 utorrent 而不是加载链接！

即使使用 javascript 也不能​​解决问题：

```
window.location.href='index.html' 
```

它仍然会带来 utorrent。

如果没有安装 utorrent 就没有问题。

我在网上找不到任何关于此的内容。

问题是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T21:42:58.863

当用户点击 a 中的普通链接时`WebView`，Android 默认会`ACTION_VIEW` `Intent`在链接中的 URL 上启动 an。通常，这会调出用户的默认 Web 浏览器，但在某些情况下，它可能会调出另一个应用程序，就像这里的情况一样。

如果您不想要默认行为，则需要创建一个`WebViewClient`子类的实例，在其中实现`shouldOverrideUrlLoading()`以执行其他操作而不是默认行为。然后将`WebViewClient`实例附加到`WebView`via `setWebViewClient()`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-24T21:43:01.097

您必须创建一个`WebViewClient`来防止这种行为：

```
public class webViewClient extends WebViewClient {
    @Override
    public boolean shouldOverrideUrlLoading(WebView view, String url) {
        view.loadUrl(url);
        return true;
    }
} 
```

然后`WebView`像这样设置它：

```
webview.setWebViewClient(new webViewClient()); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-24T21:39:01.027

uTorrent 应用程序可以指定一个可以由包含 html 链接的意图打开的活动。如果您没有其他可以打开链接的工具（即某种浏览器），或者如果您已将 uTorrent 设置为默认应用程序以启动链接，它将自动打开。

尝试转到设置 > 应用程序，然后单击 uTorrent。如果可以，请单击“清除默认值”按钮，然后尝试再次打开您的链接。

# android - ScrollView 正在捕捉谷歌地图的触摸事件

> ID：14025859
> 
> 赞同：8
> 
> 时间：2012-12-24T21:33:50.017
> 
> 标签：android, android-layout

我有一个包含视图组层次结构的水平滚动视图，最后是一个谷歌地图。我的问题是 HSV 正在捕捉地图上的左右阻力。我试过了

```
 hsv.requestDisallowInterceptTouchEvent(true); 
```

乃至

```
 mapView.getParent().requestDisallowInterceptTouchEvent(true); 
```

但无济于事。我在这里做错了什么吗？或者你能建议另一种解决方案吗？

我认为这应该是我最初的问题：如何在[ScrollView 中实现 Mapview](https://stackoverflow.com/questions/6546108/mapview-inside-a-scrollview)中发布的解决方案。具体来说，我将代码放在哪里？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-25T04:41:02.973

看来您的方式是正确的，但是您应该在每个触摸事件上调用 requestDisallowInterceptTouchEvent(true) 方法（请参阅[文档](http://developer.android.com/reference/android/view/ViewGroup.html#requestDisallowInterceptTouchEvent%28boolean%29)）。试试[这个解决方案](https://stackoverflow.com/questions/8122460/viewpager-intercepts-all-x-axis-ontouch-events-how-to-disable)

*更新：*

试试这个：

```
final HorizontalScrollView hsv = ...
final MapView mapView = ...

mapView.setOnTouchListener(new OnTouchListener() {
    @Override
    public boolean onTouch(View v, MotionEvent event) {
        switch (event.getAction()) {
            case MotionEvent.ACTION_MOVE:
                hsv.requestDisallowInterceptTouchEvent(true);
                break;
            case MotionEvent.ACTION_UP:
            case MotionEvent.ACTION_CANCEL:
                hsv.requestDisallowInterceptTouchEvent(false);
                break;
        }
        return mapView.onTouchEvent(event);
    }
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-02-10T05:18:09.507

对于谷歌地图 v2，按照[本教程的解决方案](http://www.londatiga.net/it/programming/android/how-to-make-android-map-scrollable-inside-a-scrollview-layout/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-04-17T05:34:20.910

您必须创建自定义 MapView。按照下面提供的代码片段

```
public class AppMapView extends MapView {

    public AppMapView(Context context, AttributeSet attrs) {
        super(context, attrs);
    }

    @Override
    public boolean dispatchTouchEvent(MotionEvent ev) {
        switch (ev.getAction()) {
            case MotionEvent.ACTION_UP:
               System.out.println("unlocked");
               this.getParent().requestDisallowInterceptTouchEvent(false);
               break;

            case MotionEvent.ACTION_DOWN:
               System.out.println("locked");
               this.getParent().requestDisallowInterceptTouchEvent(true);
               break;
       }
       return super.dispatchTouchEvent(ev);
   }
} 
```

在 XML 中遵循以下代码：

```
<com.tech.linez.brixlanepassenger.custom_views.AppMapView
   android:id="@+id/map_ride_route"
   android:layout_width="match_parent"
   android:layout_height="220dp"
   android:layout_margin="10dp"/> 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-12-24T22:14:00.043

尝试覆盖地图的 onTouch 并始终从中返回 true。

# mysql - PHP 使用 NOT IN 语句选择查询

> ID：14025868
> 
> 赞同：1
> 
> 时间：2012-12-24T21:35:52.590
> 
> 标签：mysql, sql

我在使用 SELECT 查询时遇到了一些困难，这应该很容易。这是简化的背景：

我的数据库中有两个表。一个名为 TABLE1 的表包含三个字段：[QuestionID]、[Question]、[Answer]。第二个表名为 TABLE2，包含两个字段：[UserID] 和 [QuestionID]。

基本上，页面的功能是当用户正确回答问题时，用户名和问题 ID 将插入到 TABLE2 中。TABLE2 将用于从页面中省略已回答的问题，以便用户只能回答尚未回答的问题。

因此，SELECT 查询应该通过“显示**TABLE1**中**不在 TABLE2**中的所有问题”来工作。这听起来很容易，但我无法弄清楚。

这是我的查询：

```
 $answered = mysql_query("SELECT QuestionID FROM TABLE2 WHERE Username='TESTING'");
 while ($answered1 = mysql_fetch_array($answered)) 
 {
 $QuestionsToDisplay = mysql_query("SELECT * FROM TABLE1 WHERE 'QuestionID' NOT IN ('$answered1')");
 }
 } 
```

我也试过：

```
$QuestionsToDisplay = mysql_query("SELECT * FROM TABLE1 WHERE 'QuestionID' !='$answered1'"); 
```

两个实例在应该显示 4 时都显示一个结果。

我将第一个查询放在“while”语句中，因为它返回了正确的数据（我在 TABLE2 中有两个条目用于测试目的，这就是 echo 语句显示的内容）。

所以知道我做错了什么吗？

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T21:37:45.287

为什么不只使用连接，我想知道？

```
 SELECT t2.QuestionID 
      FROM table2 t2 
INNER JOIN table1 t1 ON t1.QuestionID = t2.QuestionID
     WHERE t2.Username = 'TESTING' 
```

使用此查询，您将有效地从结果行集中排除所有`table2`没有相应行的记录。`table1`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T21:39:59.680

[**请不要`mysql_*`在新代码中使用函数**](https://stackoverflow.com/q/12859942/)。它们不再被维护[并被正式弃用](https://wiki.php.net/rfc/mysql_deprecation)。看到[**红框**](https://www.php.net/manual/en/function.mysql-connect.php)了吗？改为了解[*准备好的语句*](https://en.wikipedia.org/wiki/Prepared_statement)，并使用[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli) -[本文](https://php.net/manual/en/mysqlinfo.api.choosing.php)将帮助您决定使用哪个。如果您选择 PDO，[这里有一个很好的教程](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)。

您需要学习如何使用`JOIN`. 我也不确定你是如何使用`username`. 此查询将显示所有`TABLE1`不在的问题`TABLE2`。

```
SELECT a.QuestionID
FROM TABLE1 a
LEFT JOIN TABLE2 b ON b.QuestionID = a.QuestionID
WHERE b.QuestionID IS NULL 
```

## [看到它在行动](http://sqlfiddle.com/#!2/df2b6/1)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-24T21:42:01.813

我认为您应该考虑使用[`LEFT JOIN`](http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html)：

```
SELECT t1.* 
FROM TABLE1 t1
LEFT JOIN TABLE2 t2
    ON t1.QuestionID = t2.QuestionID
    AND T2.Username = 'TESTING'
WHERE t2.QuestionId is null 
```

这将返回`Table1`其中没有相应记录的所有内容`Table2`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-24T21:37:30.733

不要`QuestionID`加引号！否则 MySQL 将检查 中的文字值`'QuestionID'`，`TABLE2`而不是列值。

# emacs - 在 perl 模式 emacs 中关闭自动缩进

> ID：14025869
> 
> 赞同：4
> 
> 时间：2012-12-24T21:36:55.473
> 
> 标签：emacs, cygwin, elisp, indentation, cperl-mode

当我使用 Emacs 时，我会关闭任何自动缩进并使用自定义缩进方案（保持前一行的缩进，仅使用空格）。

在c模式下，我只是用来`C-c C-l`关闭电动模式。

但在 perl 模式下，我不确定如何实现相同的目标。

查看[http://mirror.fraunhofer.de/CPAN/misc/emacs/perl-mode.el](http://mirror.fraunhofer.de/CPAN/misc/emacs/perl-mode.el)。我可以看到

```
(defvar perl-mode-map ()
  "Keymap used in Perl mode.")
(if perl-mode-map
    ()
  (setq perl-mode-map (make-sparse-keymap))
  (define-key perl-mode-map "{" 'electric-perl-terminator)
  (define-key perl-mode-map "}" 'electric-perl-terminator)
  (define-key perl-mode-map ";" 'electric-perl-terminator)
  ... 
```

所以我尝试`M-x set-variable perl-mode-map`了，但我只得到`[No match]`。

这是因为我的 perl-mode.el 是预编译的吗？当我尝试`M-x find-function perl-mode`它时抱怨它找不到它 perl-mode.el 。不过，我确实有一个 perl-mode.elc 文件。

我正在通过 cygwin 上的控制台运行 emacs。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-25T01:09:01.963

在您的配置文件中添加以下代码（.emacs 或 ~/.emacs.d/init.el）

```
(defun perl-mode-disable-auto-indent ()
  (local-unset-key (kbd "{"))
  (local-unset-key (kbd "}"))
  (local-unset-key (kbd ";"))
  (local-unset-key (kbd ":")))

(add-hook 'perl-mode-hook 'perl-mode-disable-auto-indent) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-25T01:28:48.260

我的错。我没有意识到emacs中有普通变量和用户选项变量。

`(setq perl-mode-map (make-sparse-keymap))`在暂存缓冲区中运行然后重新加载 perl 模式为我禁用了电子缩进。

另外，感谢syohex的回答。

编辑：**重要的是重新加载 perl-mode 以使其正常工作。**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-31T05:49:55.557

关闭`electric-indent-mode`是`perl-mode`我的做法。我在我的`~/.emacs.d/init.el`

```
(defun perl-mode-disable-auto-indent()
    (electric-indent-mode -1))
(add-hook 'perl-mode-hook 'perl-mode-disable-auto-indent) 
```

[你可以在这里](https://stackoverflow.com/questions/27718310/emacs-version-24-4-new-obnoxious-loss-of-indentation-on-hitting-return)、[这里](https://emacs.stackexchange.com/questions/5939/how-to-disable-auto-indentation-of-new-lines)和[这里](https://stackoverflow.com/questions/4390238/disable-auto-indent-globally-in-emacs)找到类似的帖子

# jquery - Internet Explorer 导致布局问题

> ID：14025870
> 
> 赞同：4
> 
> 时间：2012-12-24T21:37:02.367
> 
> 标签：jquery, html, internet-explorer

我在 Internet Explorer 中的应用程序存在基本问题。在所有其他主流浏览器 Chrome、Safari、opera 和 Firefox 中，我在其他主流浏览器中没有遇到这个布局问题，但在 Internet Explorer 中我遇到了。

[打开应用程序 (Internet Explorer)](http://helios.hud.ac.uk/u0867587/Mobile_app/Text11.php)

问题

为什么最后一个表格列显示在下方而不是最后一个表格列旁边？下面是代码：

```
$outputform.=" 
<form action='QandATable.php' method='post' id='sessionForm'>
<table>
<tr>
<th>9: Room and Building:</th>
<th>Building: {$buildingHTML}</th>
<th>Room: {$roomHTML}</th>
</tr>
</table>

</form>
";

echo $outputform; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T23:38:33.303

IE 不喜欢 HTML 错误，如果您在 th 标记内有一个封闭的表单标记：

```
<form action='QandATable.php' method='post' id='sessionForm'>
<table>
<tr>
<th>9: Room and Building:</th>
<th>Building: <select name="buildings" id="buildingsDrop" onchange="getRooms();">
<option value="">Please Select</option>
<option value='Canalside East'>Canalside East</option>
<option value='Canalside West'>Canalside West</option>
</select></form></th>
<th>Room: <select name="rooms" id="roomsDrop">
<option value="">Please Select</option>
</select></th>
</tr>
</table>

</form> 
```

我说的是这个标签：

```
</select></form></th> 
```

删除多余的表单标签后，表格会很好。我已经用你的 HTML 源代码对其进行了测试。

# java - 反射性地获取与特定 url 匹配的 Spring MVC 控制器列表

> ID：14025872
> 
> 赞同：18
> 
> 时间：2012-12-24T21:37:18.663
> 
> 标签：java, spring, spring-mvc, reflection

如何反射性地获取所有控制器的列表（如果不仅有注释，而且在 xml 中指定，最好），匹配 Spring MVC 应用程序中的一些特定 url？

在仅带注释的情况下，

```
@Autowired
private ListableBeanFactory listableBeanFactory;
...
whatever() {
    Map<String,Object> beans = listableBeanFactory.getBeansWithAnnotation(RequestMapping.class);

    // iterate beans and compare RequestMapping.value() annotation parameters
    // to produce list of matching controllers
} 
```

可以使用，但是在更一般的情况下，当可以在 spring.xml 配置中指定控制器时该怎么办？以及如何处理请求路径参数？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-12-25T21:05:51.980

从 Spring 3.1 开始，有 class [`RequestMappingHandlerMapping`](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/web/servlet/mvc/method/annotation/RequestMappingHandlerMapping.html)，它提供有关[`RequestMappingInfo`](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/web/servlet/mvc/method/RequestMappingInfo.html)@Controller 类的映射 () 的信息。

```
@Autowired
private RequestMappingHandlerMapping requestMappingHandlerMapping;

@PostConstruct
public void init() {
    Map<RequestMappingInfo, HandlerMethod> handlerMethods =
                              this.requestMappingHandlerMapping.getHandlerMethods();

    for(Entry<RequestMappingInfo, HandlerMethod> item : handlerMethods.entrySet()) {
        RequestMappingInfo mapping = item.getKey();
        HandlerMethod method = item.getValue();

        for (String urlPattern : mapping.getPatternsCondition().getPatterns()) {
            System.out.println(
                 method.getBeanType().getName() + "#" + method.getMethod().getName() +
                 " <-- " + urlPattern);

            if (urlPattern.equals("some specific url")) {
               //add to list of matching METHODS
            }
        }
    }       
} 
```

*在定义控制器的 Spring 上下文中定义此 bean 很重要。*

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-28T13:16:04.867

您可以通过调用来获得映射的控制器`HandlerMapping.getHandler(HTTPServletRequest).getHandler()`。IoC 可以获取 HandlerMapping 实例。如果您没有 HTTPServletRequest，您可以使用 MockHttpServletRequest 构建您的请求。

```
@Autowired
private HandlerMapping mapping;

public Object getController(String uri) {
    MockHttpServletRequest request = new MockHttpServletRequest("GET", uri);
    // configure your request to some mapping
    HandlerExecutionChain chain = mapping.getHandler(request);
    return chain.getHandler();
} 
```

* * *

抱歉，我现在读到你想要一个 URL 的所有控制器。这将只为您提供一个完全匹配的控制器。这显然不是你需要的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-28T12:21:17.093

您可以尝试使用 ListableBeanFactory 接口来检索所有 bean 名称。

```
private @Autowired ListableBeanFactory beanFactory;

public void doStuff() {
    for (String beanName : beanFactory.getBeanDefinitionNames()) {
        if (beanName.startsWith("env")) { // or whatever check you want to do
            Object bean = beanFactory.getBean(beanName)
            // .. do something with it
        }
    }
} 
```

[请在此处](http://static.springsource.org/spring/docs/1.1.x/api/org/springframework/beans/factory/ListableBeanFactory.html)查看 ListableBeanFactory 的文档。该接口提供了几种方法，如 getBeansOfType()、getBeanDefinitionCount() 等。

如果此方法未列出 @Controller 注释的 bean ，[请访问此](https://stackoverflow.com/questions/10898056/how-to-find-all-controllers-in-spring-mvc)页面以查看如何完成。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-07T09:52:22.017

您需要在调度程序 servlet 中为 RequestMappingHandlerMapping 做一个条目

```
<bean name="requestHandlerMapping" class="org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping">
        <property name="useTrailingSlashMatch" value="true"></property>
    </bean> 
```

调度程序 servlet 将查看此映射并在您的应用程序中实例化一个 bean RequestMappingHandlerMapping

现在在您可以使用的任何控制器/类中

```
@Autowired
private HandlerMapping mapping; 
```

它应该可以正常工作。

注意：您需要注意添加 bean，如果您的任何 dispatcherservlet（在大型应用程序的情况下）包含此 bean，它将导致 noUniqueBean 异常并且应用程序将无法启动。

# jquery - jquery：如何访问 jquery 对象中的数组元素

> ID：14025873
> 
> 赞同：0
> 
> 时间：2012-12-24T21:37:26.893
> 
> 标签：jquery, arrays, object

这是问题所在。我正在构建一个 jquery 程序，它可以让我在绘图区域上创建和定位 div。我需要跟踪 div、它们的位置、CSS 属性和其他细节。所以，我正在创建一个对象，其中包含每个 div 的所有这些项目的数组。

这是创建对象的代码片段。

```
var divData= {items: [
{ID: "21", Block: "Block_01", posX : "450", posY : "540" },
{ID: "43", Block: "Block_02", posX : "250", posY : "440" },
{ID: "46", Block: "Block_03", posX : "50", posY : "54" },
{ID: "54", Block: "Block_04", posX : "140", posY : "210" },
{ID: "55", Block: "Block_05", posX : "900", posY : "820" },
{ID: "79", Block: "Block_06", posX : "380", posY : "520" }
]}; 
```

这是我为显示数组内容而编写的代码。

```
alert ('array length is : ' + divData.items.length); 
```

此语句返回正确的值 6，此外，我可以使用此语句将数据推送到数组中，警报语句现在显示为 7。

```
divData.items.push({ID: "266", Block: "Block_01", posX : "450", posY : "540" }); 
```

问题是当我尝试使用以下代码显示数组的内容时，没有任何反应。

```
for (var i=0;i<divData.items.length;i++)
{
document.write(divData.items[i] + "<br>");
} 
```

屏幕上的输出是这个 [object Object] 七次。

我究竟做错了什么？

任何帮助都感激不尽。

谢谢

克里斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T21:38:57.370

数组中的“项目”是对象。您不能直接在屏幕上输出对象。您必须指定要访问的对象的哪个属性：

```
for (var i = 0;i < divData.items.length; i++)
{
  document.write(divData.items[i].ID + "<br/>"); // access the OBJECT's property!
} 
```

*您可能*想要执行以下操作：

```
for (var i = 0;i < divData.items.length; i++)
{
  $("#container").append("<div class='positionedDiv' id='" + divData.items[i].ID + "' style='top: " + divData.items[i].posY + "px;left:" + divData.items[i].posX + "px;></div>");
} 
```

一些CSS：

```
.positionedDiv {
  position: absolute; 
} 
```

# python - 具有分层索引的 DataFrame 中的列中的断言错误

> ID：14025879
> 
> 赞同：12
> 
> 时间：2012-12-24T21:38:40.420
> 
> 标签：python, pandas, hierarchical

另一个熊猫问题：

我有这个带有分层索引的表：

```
In [51]:
from pandas import DataFrame
f = DataFrame({'a': ['1','2','3'], 'b': ['2','3','4']})
f.columns = [['level1 item1', 'level1 item2'],['', 'level2 item2'], ['level3 item1', 'level3 item2']]
f
Out[51]:
    level1 item1    level1 item2
                    level2 item2
    level3 item1    level3 item2
0         1              2
1         2              3
2         3              4 
```

碰巧选择`level1 item1`会产生以下错误：

```
In [58]: f['level1 item1']
AssertionError: Index length did not match values 
```

不过，这似乎和关卡的数量有些关系。当我将级别数减少到只有两个时，就没有这样的错误：

```
from pandas import DataFrame
f = DataFrame({'a': ['1','2','3'], 'b': ['2','3','4']})
f.columns = [['level1 item1', 'level1 item2'],['', 'level1 item2']]
f
Out[59]:
     level1 item1   level1 item2
                    level1 item2
0          1              2
1          2              3
2          3              4 
```

相反，前面的 DataFrame 给出了预期的系列：

```
In [63]:
f['level1 item1']
Out[63]:
0    1
1    2
2    3
Name: level1 item1 
```

用虚拟字符填充下面`level1 item1`的空白“修复”了这个问题，但这不是一个好的解决方案。

如何在不使用虚拟名称填充这些列的情况下解决此问题？

非常感谢！

* * *

### 原始示例：

![在此处输入图像描述](../Images/09ff5adc46eb2ec4397931b3b7cc2dea.png)

该表是使用以下索引生成的：

```
index = [np.array(['Size and accumulated size of adjusted gross income', 'All returns', 'All returns', 'All returns', 'All returns', 'All returns', 'Taxable returns', 'Taxable returns', 'Taxable returns', 'Taxable returns', 'Taxable returns', 'Taxable returns', 'Taxable returns', 'Taxable returns', 'Taxable returns', 'Taxable returns', 'Taxable returns', 'Taxable returns', 'Taxable returns', 'Taxable returns', 'Taxable returns']),
np.array(['', 'Number of returns', 'Percent of total', 'Adjusted gross income less deficit', 'Adjusted gross income less deficit', 'Adjusted gross income less deficit', 'Number of returns', 'Percent of total', 'Adjusted gross income less deficit', 'Adjusted gross income less deficit', 'Taxable income', 'Taxable income', 'Taxable income', 'Income tax after credits', 'Income tax after credits', 'Income tax after credits', 'Total income tax', 'Total income tax', 'Total income tax', 'Total income tax', 'Total income tax']),
np.array(['', '', '', '', '', '', '', '','', '', 'Number of returns', 'Amount', 'Percent of total', 'Number of returns', 'Amount', 'Percent of total', 'Amount', 'Percent of', 'Percent of', 'Percent of', 'Average total income tax (dollars)']),
np.array(['', '', '', 'Amount', 'Percent of total', 'Average (dollars)', 'Average (dollars)', 'Average (dollars)', 'Amount', 'Percent of total', 'Percent of total', 'Percent of total', 'Percent of total', 'Percent of total', 'Percent of total', 'Percent of total', 'Percent of total', 'Total', 'Taxable income', 'Adjusted gross income less deficit', 'Adjusted gross income less deficit'])]

df.columns = index 
```

这是 CSV 文件中某些数据的几乎完美副本，但您可以看到在“退货数量”、“占总收入的百分比”和“调整后的总收​​入减去赤字”下方存在差距。当我尝试选择退货数量时，该差距会产生此错误：

```
In [68]: df['Taxable returns']['Number of returns']
AssertionError: Index length did not match values 
```

我不明白这个错误。所以一个很好的解释将不胜感激。无论如何，当我使用这个索引填补这个空白时（注意第三个 numpy 数组中的第一个元素）：

```
index = [np.array(['Size and accumulated size of adjusted gross income', 'All returns', 'All returns', 'All returns', 'All returns', 'All returns', 'Taxable returns', 'Taxable returns', 'Taxable returns', 'Taxable returns', 'Taxable returns', 'Taxable returns', 'Taxable returns', 'Taxable returns', 'Taxable returns', 'Taxable returns', 'Taxable returns', 'Taxable returns', 'Taxable returns', 'Taxable returns', 'Taxable returns']),
np.array(['', 'Number of returns', 'Percent of total', 'Adjusted gross income less deficit', 'Adjusted gross income less deficit', 'Adjusted gross income less deficit', 'Number of returns', 'Percent of total', 'Adjusted gross income less deficit', 'Adjusted gross income less deficit', 'Taxable income', 'Taxable income', 'Taxable income', 'Income tax after credits', 'Income tax after credits', 'Income tax after credits', 'Total income tax', 'Total income tax', 'Total income tax', 'Total income tax', 'Total income tax']),
np.array(['1', '2', '3', '4', '5', '6', '7', '8','9', '10', 'Number of returns', 'Amount', 'Percent of total', 'Number of returns', 'Amount', 'Percent of total', 'Amount', 'Percent of', 'Percent of', 'Percent of', 'Average total income tax (dollars)']),
np.array(['', '', '', 'Amount', 'Percent of total', 'Average (dollars)', 'Average (dollars)', 'Average (dollars)', 'Amount', 'Percent of total', 'Percent of total', 'Percent of total', 'Percent of total', 'Percent of total', 'Percent of total', 'Percent of total', 'Percent of total', 'Total', 'Taxable income', 'Adjusted gross income less deficit', 'Adjusted gross income less deficit'])]

df.columns = index 
```

我得到正确的结果：

```
In [71]: df['Taxable returns']['Number of returns']
Out[71]:
7
Average (dollars)
0    90,660,104
1    3,495
... 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-27T19:46:05.930

我昨天对此进行了修复。这是 github master 上的新行为：

```
In [1]: paste
from pandas import DataFrame
f = DataFrame({'a': ['1','2','3'], 'b': ['2','3','4']})
f.columns = [['level1 item1', 'level1 item2'],['', 'level2 item2'], ['level3 item1', 'level3 item2']]
f

## -- End pasted text --
Out[1]: 
  level1 item1 level1 item2
               level2 item2
  level3 item1 level3 item2
0            1            2
1            2            3
2            3            4

In [2]: f['level1 item1']
Out[2]: 
  level3 item1
0            1
1            2
2            3 
```

# c++ - 字典的数据结构？

> ID：14025881
> 
> 赞同：0
> 
> 时间：2012-12-24T21:38:57.777
> 
> 标签：c++, data-structures

存储字典的最佳数据结构是什么？哈希表还是树？考虑以后可以将更多单词添加到字典中的可能性。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-24T21:40:22.183

`std::unordered_map`或将`std::map`是字典的最佳数据结构。`std::unordered_map`是哈希表的 C++11 等价物。While`std::map`是常规的关联容器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-24T21:42:43.310

这些数据结构中的任何一个都不比另一个“更好”。这完全取决于您的需求。

如果您主要对回答“字符串 X 是否存在于我的哈希表中？”这个问题感兴趣，则字符串的哈希表是很好的选择。它支持（通常）快速查找并且内存占用少；每个字符串只存储一次。然而，它依赖于一个好的散列函数的存在，容易受到病态输入的散列冲突的影响，并且不允许您进行诸如“哪个字符串最接近我的字符串？”之类的搜索。

trie 是一种用于存储字符串的良好数据结构，可提供良好的最坏情况查找（您只需查看输入字符串的每个字符一次）。它还有一个优点是可以紧凑地存储具有相似前缀的字符串。此外，trie 允许您搜索具有给定前缀的字符串，或有效地进行正则表达式搜索，或有效地查找附近的单词。它的缺点是，由于存储的指针数量，trie 的内存使用量往往比哈希表高得多。

除了这些之外，您还可以考虑其他数据结构。Radix Trys 和 Patricia Trees 给出了更简洁的 try 表示，但有一些额外的编程复杂性。 如果您主要对有效地查找“接近”某个初始字符串的所有字符串感兴趣，则可以使用[BK-trees 。](http://en.wikipedia.org/wiki/BK-tree)

简而言之，如果内存非常宝贵，或者您不需要进行“关闭字符串”搜索，那么哈希表是一个不错的选择。如果您需要查找附近的字符串或进行其他字符串操作，trie 可能是更好的选择。

希望这可以帮助！

# jquery - jQuery 1.7 - 稍后添加到文档中的绑定元素

> ID：14025889
> 
> 赞同：0
> 
> 时间：2012-12-24T21:39:40.537
> 
> 标签：jquery, ajax, binding

我知道我只是在阅读分配后感到困惑......

`As of jQuery 1.7, the .live() method is deprecated. Use .on() to attach event handlers. Users of older versions of jQuery should use .delegate() in preference to .live().`

有人可以描述我如何解决下面的代码。当页面是静态的时，它会按预期工作。当对我的代码进行一般改进的评论也受到赞赏时，它不起作用，`<!-- ajax fills this in -->`
因为我对 jquery 真的很陌生。

谢谢，圣诞快乐！

```
 <!DOCTYPE html> 
<head>
<script type="text/javascript" src="http://code.jquery.com/jquery-latest.js"></script>
<script type='text/javascript'>
     $(document).ready(function() {  
            $('form .edit').on( {
                mouseenter: function() {
                    $(this).css({cursor:'pointer', color: 'red'});
              },
                mouseleave: function() {
                    $(this).css({cursor:'default', color: 'rgb(204, 204, 204)'});
              },
              click: function() {
                    var $t = $(this).parents('table').attr('id');
                    var $tr = '#'+ this.id;
                    var tData = $($tr +' > td'); 
                    $(tData).each(function () { 
                          var td = '#'+ this.id;
                          var $th = $(td).closest('table').find('th').eq($(td).index()).text();
                          var html = $(this).html();
                          var input = $("<input id='"+$t+$tr+this.id+"' name='"+$t+"="+$th+"'  />");
                          input.val(html);
                          $(this).html(input);
                    });             
                    $('.edit').off();
                }
            });
     });  
</script>
</head>
<body>
<div>
<form id="userForm" method='get'>
<!-- ajax fills this in -->
    <table class='table' id='user'>
        <thead>
            <tr class='head'>
                <th>head 1</th>
                <th>head 2</th>
            </tr>
        </thead>
        <tfoot><tr></tr></tfoot>
        <tbody>
            <tr class='edit' id='1' title='click to edit'>
                <td id='1a'>content 1a</td>
                <td id='1b'>content 1b</td>
            </tr>
            <tr class='edit' id='0' title='click to edit'>
                <td id='0a'>content 0a</td>
                <td id='0b'>content 0b</td>
            </tr>
        </tbody>
    </table> 
<input class='ajaxSubmitAndReturn' type='submit' value='Submit' />
<input class='ajaxCancel' type='submit' value='Cancel' />
<!-- end of ajax -->
</form>
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T21:41:55.903

加载 ajax 内容后，您需要调用 jquery 代码块。

您可以将 jQuery 代码包装在一个函数中：

```
 function updateStuff() {
        $('form .edit').on( {
            mouseenter: function() {
                $(this).css({cursor:'pointer', color: 'red'});
          },
            mouseleave: function() {
                $(this).css({cursor:'default', color: 'rgb(204, 204, 204)'});
          },
          click: function() {
                var $t = $(this).parents('table').attr('id');
                var $tr = '#'+ this.id;
                var tData = $($tr +' > td'); 
                $(tData).each(function () { 
                      var td = '#'+ this.id;
                      var $th = $(td).closest('table').find('th').eq($(td).index()).text();
                      var html = $(this).html();
                      var input = $("<input id='"+$t+$tr+this.id+"' name='"+$t+"="+$th+"'  />");
                      input.val(html);
                      $(this).html(input);
                });             
                $('.edit').off();
            }
        });
    } 
```

然后在你 ajax 调用填充内容后，你可以简单地调用：

```
updateStuff(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T22:13:23.117

主要有两种使用方式`on()`。

一种方法是`$(selector).on(handler)`，如果在触发代码时选择器表示的元素存在，但不考虑将来添加到 DOM 的元素。

另一种是委托`on()`给页面中的永久资产。这可以是选择器的任何祖先，甚至可以是`document`

事件被绑定到祖先，并且您添加一个选择器参数作为事件的**目标**。

如果在您的情况下，如果表格是永久资产，您可以编写：

```
 /* if "form" is added by ajax, can use "document" or an ancestor of "form" that is permament in page*/
$('form').on( {
    mouseenter: function() {
                $(this).css({cursor:'pointer', color: 'red'});
      },
    mouseleave: function() {
                $(this).css({cursor:'default', color: 'rgb(204, 204, 204)'});
     },
     click: function() {/*...*/}
 }, '.edit'); 
```

将来添加到 DOM 的任何类`edit`元素都将包括在内。

在您的情况下，您使用的是`events map`. 当多个事件的处理程序相同时，事件也可以注册为空格分隔的字符串，（或仅注册事件）使用以下语法：

```
 $('form').on('myCustomEvent submit', '.edit', function(){
      doSomething()
}); 
```

现在查看文档，注意可选的选择器、事件映射等，`[]`并与这些示例和文档中的示例进行比较。

# javascript - 使用克隆拖放会产生圆斜线

> ID：14025892
> 
> 赞同：0
> 
> 时间：2012-12-24T21:40:04.710
> 
> 标签：javascript, asp.net, visual-studio-2010, drag

有问题的代码是用 Visual Studio 2010 asp.net 下的直接 javascript 编写的。

我正在将图形部分拖到图表上。我使用拖动克隆。当我单击其中一个图形时，代码会将拖动克隆定位在该图形上，然后使拖动克隆可见。

问题是我**第一次**尝试拖动**每个**拖动克隆，**如果我按下鼠标并快速拖动**，屏幕会在拖动关闭出现的同时产生一个斜线符号。然后，拖动克隆会有些行为不端。

我花了一点时间才弄明白，但仔细观察，我发现那道斜线出现在拖拽分身的前面。然后，下面的两条评论解释了我是如何解决它的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T22:22:57.487

我发现圆圈斜线是因为系统告诉我不能拖动静态“图表部分”图形，即拖动克隆复制的图形。

解决静态图形开始拖动并生成圆斜线问题的解决方案是使其成为具有 OnClientClick 属性的 ImageButton 以停止回发，如下所示。然后，这些输入不能像单独的那样拖动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-08T03:25:18.397

在 javascript 中使用 JQuery 进行拖放

# c - 新手迷失在递归函数中

> ID：14025893
> 
> 赞同：2
> 
> 时间：2012-12-24T21:40:14.023
> 
> 标签：c

我正在尝试从一本书中学习 C，但有些东西对我来说解释得不够清楚。

以下代码

1) 使用递归函数将啤酒瓶从 99 倒数到 0。2）一旦瓶子用完，它会打印“墙上没有瓶子了”，然后 3）将瓶子一一放入回收站

```
...       #more of same above
3 bottles of beer on wall, 3 bottles of beer 
Take one down, pass around, 2 bottls of beer 
2 bottles of beer on wall, 2 bottles of beer 
Take one down, pass around, 1 bottls of beer 
1 bottles of beer on wall, 1 bottles of beer 
Take one down, pass around, 0 bottls of beer 
There are no more bottles on the wall.
Put bottle in recycling, 1 empty bottles in bin 
Put bottle in recycling, 2 empty bottles in bin 
Put bottle in recycling, 3 empty bottles in bin 
....        #pattern continues 
```

我理解它是如何倒计时的，以及为什么它说不再有啤酒瓶，但我不明白将瓶子放入回收利用的代码（printf）是如何被调用的，因为它在条件的 else 部分，并且，一旦瓶子的数量达到 0，该函数就永远不会返回到条件的 else 部分。

问题，最终的 printf （“将瓶子放入回收中......”）如何被调用 99 次，它如何能够逐个增加瓶子？

代码

```
void singTheSong(int numberOfBottles)

{

    if(numberOfBottles == 0){
        printf("There are no more bottles on the wall.\n");
    }else {
        printf("%d bottles of beer on wall, %d bottles of beer \n", numberOfBottles,numberOfBottles);
        int oneFewer = numberOfBottles - 1;
        printf("Take one down, pass around, %d bottls of beer \n", oneFewer);
        singTheSong(oneFewer);
        printf("Put bottle in recycling, %d empty bottles in bin \n", numberOfBottles);

    }
}

int main(int argc, const char * argv[])
{

    singTheSong(99);
    return 0; 
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-24T21:44:39.297

这三行：

```
printf("Take one down, pass around, %d bottls of beer \n", oneFewer);
singTheSong(oneFewer);
printf("Put bottle in recycling, %d empty bottles in bin \n", numberOfBottles); 
```

打印歌曲的这些部分：

```
Take one down, pass around, n - 1 bottls of beer
/* The entire song for n - 1 */
Put bottle in recycling, n empty bottles in bin 
```

最后一行在`singTheSong`完成执行后打印，堆栈展开，顶层函数继续执行。如果您暂时忘记了递归调用，而只是将调用`singTheSong`视为一个神奇地工作的黑盒子，那么这三行代码的行为与任何其他调用的工作方式没有什么不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T21:44:34.950

这可能会有所帮助。考虑将第一次调用替换为函数的实际主体：

```
void singTheSong(int numberOfBottles)

{

    if(numberOfBottles == 0){
        printf("There are no more bottles on the wall.\n");
    }else {
        printf("%d bottles of beer on wall, %d bottles of beer \n", numberOfBottles,numberOfBottles);
        int oneFewer = numberOfBottles - 1;
        printf("Take one down, pass around, %d bottls of beer \n", oneFewer);
        singTheSong(oneFewer);
        printf("Put bottle in recycling, %d empty bottles in bin \n", numberOfBottles);

    }
}

int main(int argc, const char * argv[])
{
    int numberOfBottles=99;

    if(numberOfBottles == 0){
        printf("There are no more bottles on the wall.\n");
    }else {
        printf("%d bottles of beer on wall, %d bottles of beer \n", numberOfBottles,numberOfBottles);
        int oneFewer = numberOfBottles - 1;
        printf("Take one down, pass around, %d bottls of beer \n", oneFewer);
        singTheSong(oneFewer);
        printf("Put bottle in recycling, %d empty bottles in bin \n", numberOfBottles);

    }
    return 0; 
} 
```

在第一次调用时，当 numberOfBottles==99 时，The`if (numberOfBottles == 0)`会失败，只会执行 else 部分。它将打印两行，调用 singTheSong(98)，然后打印关于回收的行。

想象一下继续做这样的替换，你可能会看到它是如何工作的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-24T22:09:26.513

使用递归时，分为三个阶段： 1\. 终止条件（在这种情况下是“没有瓶啤酒”（可悲的情况！-但如果你从 99 开始，我想还不错）。没有这个，你会得到无限递归，这不是一件好事！ 2\. 递归调用。 3\. 到目前为止的递归步骤完成后你要做什么。

因此，就像真正的饮酒派对一样，在派对结束并且没有啤酒之前，没有人会打扫卫生。取而代之的是，我们从墙上再拿一瓶，唱歌，把瓶子传过来，当那瓶用完后，我们从墙上再拿一瓶，唱歌，喝酒，拿瓶子，唱歌，等等。一旦所有的瓶子用完了（0 个靴子），我们回来收拾东西（不再唱歌和喝酒，关门时间等）。当然，递归调用的“返回”从最深的调用级别开始（最后一瓶啤酒 = 1 瓶“左”），然后返回一个级别（2 瓶），然后再下降一个级别（3瓶）等。

有时人们谈论“尾递归”，那时递归的最后一步是调用函数本身。

# c# - Entity Framework 5.0 1:1 关系模型优先

> ID：14025896
> 
> 赞同：0
> 
> 时间：2012-12-24T21:40:38.563
> 
> 标签：c#, entity-framework

> **可能重复：**
> [EF Model First 的 1:1 关系问题](https://stackoverflow.com/questions/14016035/11-relationship-problems-with-ef-model-first)

有没有办法在实体框架 .edmx 上定义 1:1 关系，而不会让人讨厌：

> 错误 1 ​​运行转换：多重性在关系“FK_CPF_PES”中的角色“PESSOACPF”中无效。因为从属角色属性不是关键属性，所以从属角色的多重性的上限必须是*。

已经在我的桌子上将 FK 定义为 PK，删除了 pk，尝试重新创建项目超过 10 次，但完全没有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-25T09:06:41.987

您的**外键必须定义为 UNIQUE**。

强制执行 1:0 或 1:1 关系。

您可以像这样在 SQL DB 中创建表（让我们使用 Order 和 OrderDetails 表）：

```
CREATE TABLE OrderDetails (
    DetailsId INTEGER IDENTITY NOT NULL,
    orderId INTEGER NOT NULL UNIQUE,
    PRIMARY KEY (DetailsId),
    FOREIGN KEY (orderId) REFERENCES Order(orderId)
) 
```

有关更多详细信息[**在 SQL Server 中实现一对零或一关系**](https://stackoverflow.com/questions/7644156/implementing-one-to-zero-or-one-relation-in-sql-server)

我希望这对你有帮助。

# knockout.js - 更改应用 Knockout 绑定的顺序

> ID：14025902
> 
> 赞同：6
> 
> 时间：2012-12-24T21:41:58.143
> 
> 标签：knockout.js

我正在创建一个 Knockout 绑定，它将作为 jQuery 小部件的包装器。此小部件将事件处理程序应用于子元素。不幸的是，小部件的事件处理直接应用于子元素，而不是委托。问题是我`foreach`在同一个元素上有一个绑定，但我需要在应用绑定*后*`foreach`应用自定义绑定。

显然，正确的做法是修复 jQuery 插件，但目前这不是一个选项。我想知道是否有任何适合我的解决方法。例如，有没有办法执行以下任何操作？

1.  检测是否应用了特定绑定
2.  影响绑定应用的顺序
3.  安全地强制进行另一个绑定

**更新：**

我应该提到的一个方面是这个自定义和`foreach`绑定驻留在模板中。因此，直接修改 DOM 的解决方案对我不起作用，因为它实际上会修改模板。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-09-03T16:33:57.420

在您的 bindingHandler 上添加一个 after 属性，其中包含一组依赖项

```
ko.bindingHandlers.myHandler = {
    init: function(element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        // Actual code
    },
    update: function(element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        // Actual code
    },
    after:['foreach']
}; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-25T00:03:09.107

如果您的绑定依赖于 foreach 绑定，为什么不从您的自定义绑定中调用它呢？然后你甚至不需要在 data-bind 属性中提供它。前几天我帮助了另一个 SO 用户，检查我如何从自定义绑定中调用选项绑定

[http://jsfiddle.net/w9bsc/42/](http://jsfiddle.net/w9bsc/42/)

```
ko.applyBindingsToNode(element, { options: valueAccessor(), optionsCaption: caption, optionsText: optionsText  }, viewModel); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-24T22:52:34.397

我找到了一种解决方法，但它比我喜欢的更像是一种 hack。我仍然会等待更好的答案。

我所做的只是这样：

```
ko.bindingHandlers.myHandler = {
    init: function(element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        if (allBindingsAccessor().foreach) {
            setTimeout(doInit, 1);
        } else {
            doInit();
        }

        function doInit() {
            bindingContext.initializedMyHandler = true;
            // Actual code
        }
    },
    update: function(element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        if (bindingContext.initializedMyHandler) {
            doUpdate();
        } else {
            setTimeout(doUpdate, 1);
        }
        function doUpdate() {
            // Actual code
        }
    }
}; 
```

基本上我只是使用超时来推迟执行。这样，其余的绑定处理程序将首先执行。

# html - html页面“元素”的html和css定位

> ID：14025905
> 
> 赞同：0
> 
> 时间：2012-12-24T21:42:31.147
> 
> 标签：html, css

我有问题...我正在用一点点 css 编写简单的 html 页面。在 IE 中一切看起来都很好，但如果我用 chrome 启动它 - 菜单和我的 ContentPanel (iframe) 并不一致。

我该怎么办？我只能使用 HTML 和 CSS 之类的

我的 CSS 代码的一小段： 1\. 按钮菜单 - 2O%

```
ul#buttonmenu{
list-style-type: none;
margin: 0;
padding: 0;
width: 20%;
float: left;
} 
```

iframe - 因为我在 html 页面上的第二个元素的宽度为 80%。

```
iframe{
height:100%;
width:80%;
float: right;} 
```

在 IE 中它看起来不错，但在 chrome 中则不行....有任何一般规则如何解决它吗？

我的 html 的一部分看起来像：

```
 <div id="container" style="width:100%">

  <div id="header" style="background-color:#CDB4C8;",widht=100%>
<h1 style="margin-bottom:0;">Name</h1></div>

  <ul id="buttonmenu">
  <li class="current"><a href="first.html" target = "content">first page</a></li>
  <li><a href="second.html" target="content">Second page</a></li>
  <li><a href="third.html"  target="content">Third page</a></li>
  <li><a href="fourth.html" target="content">Fourth page</a></li>
  <li><a href="contact.html" target="content">Contact</a></li>
  </ul>

 <iFrame id="content" name="content" style="background-color:#EEEEEE;float:left;">
  </div> 
```

[这段代码的小提琴](http://jsfiddle.net/nKPWV/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T21:53:22.033

如果您将 iframe 宽度的宽度缩小到 79%，则它是并列的。

```
iframe{
    height:100%;
    width:79%;
    float: right;
} 
```

或者，您可以删除 iframe 的边框并保持 80% 的宽度：

```
iframe {
    height:100%;
    width:80%;
    border: 0;
    float: right;
} 
```

带有宽度的示例[jsfiddle：79%](http://jsfiddle.net/nKPWV/1/)或[带有边框的示例 jsfiddle：0](http://jsfiddle.net/nKPWV/2/)

另外，我认为您在这里搞砸了代码：

```
<div id="header" style="background-color:#CDB4C8;",widht=100%> 
```

我想你想把：

```
<div id="header" style="background-color:#CDB4C8; width: 100%;"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T22:12:54.533

取出 iframe 中的边框，然后我在它之后做了一个浮动清除，这样容器的高度就会被保留，以防你忘记:)

```
<html>
<head>
<title></title>
<style type="text/css">
body{margin:0; padding:0;}

ul#buttonmenu{
list-style-type: none;
margin: 0;
padding: 0;
width: 20%;
float: left;
}

#content{
height:100%;
width:80%;
float: right !important;
border:none;}
</style>
</head>
<body>
<div id="container" style="width:100%">

<div id="header" style="background-color:#CDB4C8;",widht=100%>
<h1 style="margin-bottom:0;">Name</h1></div>
<ul id="buttonmenu">
<li class="current"><a href="first.html" target = "content">first page</a></li>
<li><a href="second.html" target="content">Second page</a></li>
<li><a href="third.html"  target="content">Third page</a></li>
<li><a href="fourth.html" target="content">Fourth page</a></li>
<li><a href="contact.html" target="content">Contact</a></li>
</ul>

<iFrame id="content" name="content" style="background-  color:#EEEEEE;float:left;">
<div style="clear:both;"></div>
</div> 

</body>
</html> 
```

# javascript - 监控 JQuery 发出的所有 AJAX 请求？

> ID：14025908
> 
> 赞同：5
> 
> 时间：2012-12-24T21:42:51.283
> 
> 标签：javascript, jquery, ajax

有没有办法监视页面上使用 JQuery 发出的所有 ajax 请求，并使用每个请求的结果调用回调函数？

例如，我提出我的 ajax 请求：

```
$.get('foo', {foo: bar} );
$.get('bar', {bar: foo} ); 
```

然后每次完成任何这些 ajax 请求时我都会调用一个函数，其中包含引用的 url 以及请求的结果？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-24T21:48:18.080

Check out jQuery's "ajaxComplete"; it should be exactly what you're looking for:

[http://api.jquery.com/ajaxComplete/](http://api.jquery.com/ajaxComplete/)

Using it, you can register a handler and that handler will get invoked on every ajax call.

```
$.ajaxComplete(function() {
    alert('it worked');
});

$.get('foo', {foo: bar} ); // "it worked" would get alerted when this completes 
```

To see the response that came back, just use the XHR object that gets provided, like so:

```
$.ajaxComplete(function(e, xhr) {
    alert('it worked, and the response was:' + xhr.responseHTML);
});

$.get('foo', {foo: bar} ); 
```

And to check the URL you can use a third "settings" arg that gets provided:

```
$.ajaxComplete(function(e, xhr, settings) {
    alert('it worked, and the response was:' + xhr.responseHTML);
    alert('and the original URL was:' + settings.url);
});

$.get('foo', {foo: bar} ); 
```

**EDIT**

As Yusuf K. helpfully pointed out in the comments, if you're using one of the new versions of jQuery such as jQuery 3, things have moved around. `ajaxComplete` is no longer a static method, but is instead an instance method that you call on `document`:

```
$(document).ajaxComplete(function(e, xhr, settings) { // ... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-24T22:32:14.697

使用直接取自文档的 ...访问`url`任何请求的示例：`ajaxComplete`

[http://api.jquery.com/ajaxComplete/](http://api.jquery.com/ajaxComplete/)

```
$('.log').ajaxComplete(function(e, xhr, settings) {
  if (settings.url == 'ajax/test.html') {
    $(this).text('Triggered ajaxComplete handler. The result is ' +
                     xhr.responseHTML);
  }
}); 
```

如果你 console.log()`xhr`和`settings`对象到你的浏览器控制台，你可以看到你可以访问的所有数据`ajaxComplete`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-24T21:48:13.623

You can store the requests in an array and use the chained callbacks if that's what you mean:

```
function callback( data ) {
  // do something with the request
}

var requests = [];
requests.push( $.get('foo', { foo: bar }) ); // add to array and run request
requests.push( $.get('bar', { bar: foo }) );

requests.forEach(function( request ) {
  request.done(function( data ) {
    callback( data );
  });
}); 
```

# c# - 如何添加程序集参考？

> ID：14025912
> 
> 赞同：-2
> 
> 时间：2012-12-24T21:43:16.857
> 
> 标签：c#, compiler-errors

我添加`using Microsoft.VisualBasic`到我的代码中，但编译器报告错误 CS0234：

> 命名空间“Microsoft.VisualBasic”中不存在类型或命名空间名称“FileSystem”（您是否缺少程序集引用？）

这个“程序集参考”是什么以及如何添加一个？

图片中也显示了错误 [http://img16.imageshack.us/img16/6517/errorcup.jpg](http://img16.imageshack.us/img16/6517/errorcup.jpg)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-24T21:44:59.550

You've got a `using` directive for the `Microsoft.VisualBasic` namespace, but the fact that you're fully-qualifying the name [`Microsoft.VisualBasic.FileSystem`](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.filesystem.aspx) makes that irrelevant.

I suspect you just haven't added a reference to the `Microsoft.VisualBasic.dll` assembly. (Assemblies and namespaces are very different things.)

Personally I would attempt to avoid VB-specific assemblies in the first place, to be honest.

# objective-c - Xcode Textfield 输入不等于

> ID：14025913
> 
> 赞同：-2
> 
> 时间：2012-12-24T21:43:20.437
> 
> 标签：objective-c, textfield

> **可能重复：**
> [Objective-C 常量：NSString 比较使用 ==?](https://stackoverflow.com/questions/8979408/objective-c-constants-nsstring-comparison-using)

我有一个 textfiela nd 标签，希望标签在文本字段中显示某些文本时，这是我目前所拥有的

```
- (IBAction)Button {
if (Textfield1.text = @"A") {
    int text = arc4random() % 3;
    switch (text) {
        case 0:
            Label1.text = @"Red";
            break;
        case 1:
            Label1.text = @"Blue";
            break;
        case 2:
            Label1.text = @"Green";
            break;
        case 3:
            Label1.text = @"Yellow";
            break;

        default:
            break;
    }
} 
```

}

所发生的只是如果在文本字段中打印字母 a

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T21:46:00.320

You shouldn't compare directly with == between NSObjects (and currently you're assigning and not comparing, by using one equal-sign instead of two). Instead try the following:

```
if ([Textfield1.text isEqualToString:@"A"]) { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T21:45:43.127

You need to use isEqualToString

For example: `if ([[label text] isEqualToString:@"someString"]) { // whatever }`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-24T21:45:59.587

USE:

```
if([Textfield1.text isEqualToString:@"A") 
```

# php - 循环内自动递增

> ID：14025918
> 
> 赞同：-4
> 
> 时间：2012-12-24T21:43:55.810
> 
> 标签：php

`while`我需要在循环内自动增加一个数组值。如果数组值为`$Values[2]`，我需要它`$Values[3]`在下一个循环中。我所拥有的没有提供任何结果。

```
//select the top spread winners
$query_moline = "SELECT * FROM `highscore_leader` WHERE `game_id`=\"$game_id\" AND `leader_id`<>\"$curmemid\" AND `score`>\"$myscore\" AND `active`='Y' ORDER BY `score` DESC LIMIT \"$top_payout\"";
$moline = mysql_query($query_moline) or die(mysql_error());
$row_moline = mysql_fetch_assoc($moline);
$totalRows_moline = mysql_num_rows($moline);

$index=$top_payout;
static $i=2;

do {

$score_id=$row_moline['id'];
$player_id=$row_moline['leader_id'];

if($totalRows_moline>0){
foreach ($row_moline['id'] as $scoreid)
     {
        $i++;
     }
$player_comission=$values[$i];
//update payout tables
$strsql="UPDATE `ttourmember` SET `accountamount`=(`accountamount`+\"$player_comission\") WHERE `memberid`=\"$player_id\"";
mysql_query($strsql,$connect) or die(mysql_error());
$chkrow3=mysql_affected_rows($connect); 

}} while ($row_moline = mysql_fetch_assoc($moline)); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T22:11:44.420

```
//select the top spread winners

$query_moline = "SELECT * FROM `highscore_leader` WHERE `game_id`=\"$game_id\" AND `leader_id`<>\"$curmemid\" AND `score`>\"$myscore\" AND `active`='Y' ORDER BY `score` DESC LIMIT \"$top_payout\"";
$moline = mysql_query($query_moline) or die(mysql_error());
$totalRows_moline = mysql_num_rows($moline);

$index=$top_payout;
static $i=2;
$i = 0;

if($totalRows_moline>0)
{
    while($row_moline = mysql_fetch_assoc($moline)) 
    {    
        $score_id=$row_moline['id'];
        $player_id=$row_moline['leader_id'];

        $player_comission=$values[$i];
        //update payout tables
        $strsql="UPDATE `ttourmember` SET `accountamount`=  (`accountamount`+\"$player_comission\") WHERE `memberid`=\"$player_id\"";
        mysql_query($strsql,$connect) or die(mysql_error());
        $chkrow3=mysql_affected_rows($connect); 
        $i++;
    }
} 
```

抱歉格式化..在电话上！有人可以解决！

# android - Android Map API 2.0 - myLocation 更改的回调？

> ID：14025928
> 
> 赞同：0
> 
> 时间：2012-12-24T21:45:48.220
> 
> 标签：android, gps, google-maps-mobile, location-provider

我认为实际上不使用 LocationProvider 是不可能的，但我想我会看看是否有人有任何想法。

基本上我有一个应用程序，它有一个 PageView w/一个片段，其中包含一个新的 MapView 2.0

我可以通过 getMyLocation 从 GoogleMap 对象轻松提取我的位置。

我过去遇到过问题；在某些设备上，同时使用 NetworkLocation 和 GpsLocation 提供程序。因为我可以从 GoogleMap 中提取我的位置，所以我有一种简单的方法来检查我的位置。

我唯一的问题是我可以通过处理 onCameraChanged 来观察地图平移以更新地图，但它不处理地图内的位置变化。

我当前的实现是我有一个 MapView 和 LocationProvider.. 位置提供程序在服务中，并设置为根据用户确定的时间（1、5、10、15、30、60 秒）进行更新。活动通过 AIDL 连接到服务，如果连接的活动 >0，则启用 locationProvider，如果没有，则关闭。不过，这对谷歌地图确实没什么影响，如果我们不处理与谷歌地图相同的 GPS 信号丢失，我们得到的位置与谷歌地图不同。

我的 3 个选项中的第一个：获取提供者，并将其传递给我可以在位置更改时获得回调的地方（并不是真的想这样做）。这将涉及通过 LocationSource..

第二个选项获取我在当前服务中使用的当前位置提供程序，每次更新时，只需从地图中获取位置。我想这会起作用，但似乎有点多余，并且在屏幕关闭等时仍然存在管理 LocationProviders 的问题。（不必使用谷歌地图）

另一种选择是提供一个服务，该服务将接口传递给可以查询当前位置的地图对象。并且每隔 x 秒执行一次用户指示。我可以为此重用大部分服务，只需要设置它以继续调用。

我在想的另一件事可能只是使用被动提供程序来更新当前位置，而不是使用当前的 MapView。

我唯一的其他考虑是欺骗：我想尝试防止位置欺骗。我可以做到，所以我们不允许模拟位置。但这并不意味着它仍然不能被欺骗。

所以......任何想法将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T12:03:13.203

Google 引入了新的[`LocationClient`](https://developer.android.com/reference/com/google/android/gms/location/LocationClient.html)和关联[`LocationListener`](https://developer.android.com/reference/com/google/android/gms/location/LocationListener.html)的（之前引入的`OnMyLocationChangeListener`接口现在已弃用）。

# oracle - Oracle ADF 11.1.1.4 blind query triggered

> ID：14025932
> 
> 赞同：0
> 
> 时间：2012-12-24T21:46:05.493
> 
> 标签：oracle, session-timeout, oracle-adf

I am working/maintaining an application built on Oracle ADF 11.1.1.4 version migrated from 10g during developement phase itself. We are using BC4j to talk to Oracle 10g database. The application is very heavily data centric and so there are chances that the query triggered through GUI may be have bad plan based on the search criteria entered by the user. Most of the places we have marked few fields mandatory to search on where potentially we see a bad query to be formed.

Issue: Currently in production user open muliple tabs for different screens, one of which is a screen where we have made it mandatory to enter few search values before searching/Querying the data. In the corresponding view criteria of that View Object we have marked those fields as selective required. But somehow we see a blind query triggered even when user hasn't clicked on search button on that page It seems to comeup when the session expires on one of the pages opened and user clicks the OK. button

I am not sure is the framework triggereing some blind query when the page expires or else. There are many listeners on the page, but I am not sure why session timeeout can cause it.THe query is the same as that in the corresponding VO where we have maked few fields as selectively required. The long running query causes stuck thread on Weblogic server causing it to crash eventually after sometime.

Kindly anybody please advise if there has been an Oracle bug reported or any solution. We are seeing this on couple of pages where view criteria has few fields marked as selectively required.

Thanks

@Edit: The pages either jspx or page fragments jsff

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-25T23:51:01.873

您可能会遇到此处描述的效果[http://andrejusb.blogspot.ca/2012/08/adf-bc-passivationactivation-and-sql.html?m=1](http://andrejusb.blogspot.ca/2012/08/adf-bc-passivationactivation-and-sql.html?m=1) 您可以尝试我在这里展示的技术[https:// /tompeez.wordpress.com/2012/03/18/jdeveloper-preventing-return-of-large-row-sets-on-page-load-of-vo-using-bind-variable/](https://tompeez.wordpress.com/2012/03/18/jdeveloper-preventing-return-of-large-row-sets-on-page-load-of-vo-using-bind-variable/)以防止首先执行队列加载。

# javascript - KineticJS group.get('#id')[0] 在我的代码中不一致

> ID：14025934
> 
> 赞同：0
> 
> 时间：2012-12-24T21:46:33.727
> 
> 标签：javascript, html, canvas, get, kineticjs

我在我的程序中创建了一个类，它使用 KineticJS 作为 MVC 设计的“视图”部分。类中的一个实例变量是一个包含多个矩形对象的组。当我尝试通过 ID 选择该组中的特定矩形时，出现了我的问题。

我在 subMeasure 原型函数中使用 this.backgroundGroup.get('#id')[0] 没有问题，但是当我尝试在我的 drawMeasures 原型函数中使用它时，它会阻止我的画布绘制任何东西。Chrome 中的控制台显示“无法读取未定义的属性”ids“。

这些与使用 get 方法的唯一区别是 subMeasure 函数在“click”事件上被调用，而 drawMeasures 函数在 View 被实例化时被调用。

```
function View(){
    this.status = 0;
    this.stage;
    //layers
    this.backgroundLayer;
    this.lineLayer;
    this.noteLayer;
    this.scanLayer;
    this.editLayer;
    this.UILayer;
    //groups
    this.backgroundGroup;
    //edit buttons
    this.subMeas;
    this.addMeas;
    this.edit;

    this.backgroundArray;
    this.lineArray;
}

View.prototype.initialize = function(){
    //Initialize stage
    this.stage = new Kinetic.Stage({
    container: 'tab',
    width:1200,
    height: 400
    });

    //Initialize layers
    this.backgroundLayer = new Kinetic.Layer();
    this.lineLayer = new Kinetic.Layer();
    this.noteLayer = new Kinetic.Layer();
    this.scanLayer = new Kinetic.Layer();
    this.editLayer = new Kinetic.Layer();
    this.UILayer = new Kinetic.Layer();

    //Initialize edit layer
    this.edit = new Kinetic.Rect({
        x:0,
        y:5,
        width:40,
        height:20,
        fill: 'gray',
        stroke: 'black',
        strokeWidth: 2
    });
    this.subMeas = new Kinetic.Rect({
        x:40,
        y:5,
        width:40,
        height:20,
        fill: 'blue',
        stroke: 'black',
        strokeWidth: 2
    });
    this.addMeas = new Kinetic.Rect({
        x:80,
        y:5,
        width:40,
        height:20,
        fill: 'red',
        stroke: 'black',
        strokeWidth: 2
    });
    this.addEditButtonListeners();
    this.editLayer.add(this.edit);
    this.editLayer.add(this.subMeas);
    this.editLayer.add(this.addMeas);

    //Initialize Background Layer
    this.initBackgrounds();
    this.drawBackgrounds();
    this.backgroundLayer.add(this.backgroundGroup);

    //Initialize Line Layer
    this.initLines();
    //Initialize Note Layer
    this.initNotes();

    //Add everything to the stage and display
    this.stage.add(this.backgroundLayer);
    this.stage.add(this.lineLayer);
    this.stage.add(this.noteLayer);
    this.stage.add(this.scanLayer);
    this.stage.add(this.editLayer);
    this.stage.add(this.UILayer);
}    

View.prototype.initBackgrounds = function() {
    this.backgroundGroup = new Kinetic.Group({
        x:20,
        y:80
    });
    for(var i=0; i<controller.MAX_MEASURES; i++){
        this.backgroundGroup.add(new Kinetic.Rect({
            x: i*80,
            y:0,
            width:80,
            height:220,
            fill: 'gray',
            stroke: 'black',
            strokeWidth: 1,
            id: i + '',
            name: i + ''
        }));    
    }
    this.drawBackgrounds();
    this.backgroundLayer.add(this.backgroundGroup);
}

View.prototype.drawBackgrounds = function() {
    var temp;
    for (var i=0; i<numMeasures; i++){
        temp = this.backgroundGroup.get('#'+i)[0];
        temp.setVisible(true);
    }
    for ( i; i<controller.MAX_MEASURES; i++){
        temp = this.backgroundGroup.get('#'+i)[0];
        temp.setVisible(false);
    }
}

View.prototype.addEditButtonListeners = function() {
    this.edit.on('click', function(){
        controller.toggleEdit();
    });
    this.subMeas.on('click', function(){
        controller.subMeasure();
    });
    this.addMeas.on('click', function(){
        controller.addMeasure();
    });
}

View.prototype.toggleEdit = function() {
    if(isEdit){
        this.subMeas.setVisible(false);
        this.addMeas.setVisible(false);
        this.stage.draw();
        isEdit = 0;
    }else {
        this.subMeas.setVisible(true);
        this.addMeas.setVisible(true);
        this.stage.draw();
        isEdit = 1;
    }
}

View.prototype.subMeasure = function() {
    var temp;
    numMeasures--;
    temp = this.backgroundGroup.get('#'+numMeasures)[0];
    temp.setVisible(false);
    this.stage.draw();
} 
```

backgroundGroup 在 initBackgrounds 中被实例化为 KineticJS 组，其中添加了 8 个矩形，每个矩形的 id 为 0 到 7。

有问题的 get 调用发生在 drawBackgrounds 中。无问题的 get 调用发生在 subMeasure 中。

JSFiddle 链接：

[http://jsfiddle.net/7xfLq/7/](http://jsfiddle.net/7xfLq/7/)

编辑：我编写了一个解决方法 - 我创建了一个包含矩形的 backgroundArray，并在绘制背景方法中访问该数组。不过我不喜欢它，我宁愿只保留组中的矩形。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-25T03:07:56.643

您试图在元素添加到舞台之前调用 Kinetic 查找方法。

如果您使用 Chrome 开发人员工具并使用“{}”按钮，它将漂亮地打印缩小的代码，让您可以查看调用堆栈以找到违规代码的来源。在这种情况下`Stage`，当您尝试执行`get()`.

JSLint 是一个很好的工具。它在 JSFiddle 中运行时发现了代码的其他问题。

这是不会产生错误的代码的链接。

[http://jsfiddle.net/7xfLq/11/](http://jsfiddle.net/7xfLq/11/)

最后一件事 - 不要尝试执行尚未编码的代码，因为它会停止执行该块的代码。只需将未完成的方法调用注释掉即可。

# python - DeserializationError：调用 Python 对象时超出最大递归深度

> ID：14025940
> 
> 赞同：3
> 
> 时间：2012-12-24T21:47:02.083
> 
> 标签：python, django

我正在尝试通过将带有数据的 CSV 转换为 json 文件，然后使用 loaddata 将它们输入 Django 来将固定装置加载到我的 Django (1.4) 应用程序中。但我不断收到最大递归深度错误。我环顾四周，它似乎与 json 文件中的非 ASCII 字符有关。但是，我很确定我不会那样做？这是我的代码：

```
 def csv_to_json(self,csv,dest,model,keys,sub):
    #keys is a dict formatted x:f where x = index of value v;
    #don't include pk
    with open(csv) as f:
        l = f.readlines()
    right = len(l[0].split(","))
    out = []
    for x in xrange(1,len(l)):
        if sub:
            line = re.sub(", "," ",l[x])
        line = re.sub(r'(,[\'\"*.]+|[\'\"*.]+,)','',l[x])
        line = unicodedata.normalize('NFKD',unicode(line,'utf-8','ignore')).encode('ASCII','ignore')
        line.encode('ASCII')
        splt = line.split(",")
        print len(splt) 
        if len(splt) == right:
            for y in xrange(len(splt)):
                if re.match(r'\d{4}-\d{2}-\d{2}',str(splt[y])):
                    splt[y] = int(splt[y][:4])
                try:
                    if splt[y].isupper():
                        splt[y] = splt[y].title()
                    splt[y] = splt[y].rstrip()
                except AttributeError:
                    continue
                try:    
                    splt[y] = int(splt[y])
                except ValueError:
                    try:
                        splt[y] = float(splt[y])
                    except ValueError:
                        continue

            d = {}
            d["model"] = "dishes.%s"%(model)
            d["pk"] = splt[0]
            d["fields"] = {}
            for k,v in keys.items():
                print v,k
                try:
                    d["fields"][v] = splt[k]
                except IndexError:
                    continue
            out.append(d)
    with open(dest,"w") as f:
        json_out = simplejson.dump(out,f,separators=(",",":")) 
```

如您所见，我正在将 CSV 的内容简要转换为 UTF-8，以便使用 unicodedata 清除它们的变音符号（我必须这样做，因为我在尝试加载时收到“无效的延续字符”消息它们与loaddata），但随后我将所有内容都转换回ASCII。还是我？如果我是，那么导致递归问题的原因是什么？

ETA：这是完整的错误消息：

```
Problem installing fixture
'/Users/samuelraker/django/menus/menus/dishes/fixtures/Classification.json':                
Traceback (most recent call last):
File "/usr/local/Cellar/python/2.7.3/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django/core/management/commands/loaddata.py", line 190, in handle
for obj in objects:
File "/usr/local/Cellar/python/2.7.3/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django/core/serializers/json.py", line 47, in Deserializer
raise DeserializationError(e)
DeserializationError: maximum recursion depth exceeded while calling a Python object 
```

重新编辑以进一步添加：这是我尝试加载的 JSON 文件之一的片段。

```
[
{
    "pk":1,
    "model":"dishes.dish",
    "fields":{
        "name":"Consomme printaniere royal"
    }
},
{
    "pk":2,
    "model":"dishes.dish",
    "fields":{
        "name":"Chicken gumbo"
    }
},
{
    "pk":3,
    "model":"dishes.dish",
    "fields":{
        "name":"Tomato aux croutons"
    }
},
{
    "pk":4,
    "model":"dishes.dish",
    "fields":{
        "name":"Onion au gratin"
    }
},
{
    "pk":5,
    "model":"dishes.dish",
    "fields":{
        "name":"St. Emilion"
    }
},
{
    "pk":7,
    "model":"dishes.dish",
    "fields":{
        "name":"Radishes"
    }
},
{
    "pk":8,
    "model":"dishes.dish",
    "fields":{
        "name":"Chicken soup with rice"
    }
},
{
    "pk":9,
    "model":"dishes.dish",
    "fields":{
        "name":"Clam broth (cup)"
    }
},
{
    "pk":11,
    "model":"dishes.dish",
    "fields":{
        "name":"Clear green turtle"
    }
},
{
    "pk":13,
    "model":"dishes.dish",
    "fields":{
        "name":"Anchovies"
    }
},
{
    "pk":14,
    "model":"dishes.dish",
    "fields":{
        "name":"Fresh lobsters in every style"
    }
},
{
    "pk":15,
    "model":"dishes.dish",
    "fields":{
        "name":"Celery"
    }
},
{
    "pk":16,
    "model":"dishes.dish",
    "fields":{
        "name":"Pim-olas"
    }
},
{
    "pk":17,
    "model":"dishes.dish",
    "fields":{
        "name":"Caviar"
    }
},
{
    "pk":18,
    "model":"dishes.dish",
    "fields":{
        "name":"Sardines"
    }
},
{
    "pk":19,
    "model":"dishes.dish",
    "fields":{
        "name":"India chutney"
    }
},
{
    "pk":20,
    "model":"dishes.dish",
    "fields":{
        "name":"Pickles"
    }
},
{
    "pk":21,
    "model":"dishes.dish",
    "fields":{
        "name":"English walnuts"
    }
},
{
    "pk":22,
    "model":"dishes.dish",
    "fields":{
        "name":"Pate de foies-gras"
    }
},
{
    "pk":23,
    "model":"dishes.dish",
    "fields":{
        "name":"Pomard"
    }
},
{
    "pk":26,
    "model":"dishes.dish",
    "fields":{
        "name":"Clams"
    }
},
{
    "pk":27,
    "model":"dishes.dish",
    "fields":{
        "name":"Oysters"
    }
},
{
    "pk":28,
    "model":"dishes.dish",
    "fields":{
        "name":"Claremont planked shad"
    }
},
... 
```

编辑3：节日快乐！我只是将其中一个 JSON 文件的一小段粘贴到一个单独的文件中，通过 JSONLint 运行它以确保，然后将其传递给 loaddata ......我得到了同样的错误消息。我的模型可能有问题吗？

编辑 4：所以我尝试将我的数据编码为 YAML 而不是 JSON，但它不起作用。伙计们，我真的很难过。有人请帮忙！

编辑5：我什至尝试将我的数据库后端更改为django-mysql-pymysql（http://pypi.python.org/pypi/django-mysql-pymysql/0.1），但这也不起作用。任何人？请？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T18:04:11.820

事实证明，问题在于我的模型中有一个名为“pk”的字段，其中“primary_key=True”。如果有一个 Django 的“保留字”列表会很好，因为我的错误似乎很容易犯，而且，如果不使用 shell 进行调试，很难捕捉到。我也遇到了以“_id”结尾的手动定义字段的问题，AFAIK 也没有记录。

# list - Haskell — 从无限列表中获取多个值而不重新开始列表

> ID：14025941
> 
> 赞同：4
> 
> 时间：2012-12-24T21:47:05.677
> 
> 标签：list, haskell, lazy-evaluation

我目前正在实施[Project Euler 问题 40](https://projecteuler.net/problem=40)，并试图弄清楚如何从 Haskell 中的列表中获取多个项目，而无需重新开始列表。

目前，我有一个`champernowne`类型列表`Integral a => [a]`，它将返回一个无限的尚佩诺恩常数数字列表，然后我从这个序列中取出第一个、第十个等项并将它们相乘以获得答案。实际的代码是：

```
ans = (product . map (champernowne !!)) [0, 9, 99, 999, 9999, 99999] 
```

这个实现的问题是（我假设）Haskell 每次想要获得一个新术语时都会从序列的开头遍历列表。我怎样才能使haskell只遍历从元素1到1 000 000的序列，然后将这些术语从中间拉出来？我已经尝试过 scanl 希望惰性评估能帮助我，但它没有：

```
ans = (product . head . scanl (flip drop) champernowne) [10, 90, 900, 9000, 90000] 
```

只是为了澄清一下，第一段代码*确实*有效，但我正在努力改进我的实现以提高效率。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-24T21:59:20.003

解决该问题的有效方法是在不构造列表的情况下计算数字。

但是，如果您想要的索引是按升序给出的，您可以通过计算相对偏移量并`drop`ping 适当数量的项目以达到下一个所需索引，而无需从每个 fron 开始

```
-- supposes the list of indices in ascending order
indices :: [a] -> [Int] -> [a]
indices xs is = go xs offsets
  where
    offsets = zipWith (-) is (0:is)
    go ys (k:ks) = case drop k ys of
                     z:zs -> z : go (z:zs) ks
                     _    -> []
    go _ [] = [] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T13:17:23.657

你的第二个表达式只是有一个小错误：使用`map head`而不是`head`那里。

```
map (list !!) xs   -- [0, 9, 99, 999, 9999, 99999] ==

map head . tail . scanl (flip drop) list $ zipWith (-) xs (0:xs)
                   -- [9, 90, 900, 9000, 90000] 
```

# asp.net-mvc - 在局部视图中使用通用属性

> ID：14025945
> 
> 赞同：1
> 
> 时间：2012-12-24T21:48:00.120
> 
> 标签：asp.net-mvc, partial-views

我正在创建一个部分视图来显示记录的审计印章......即

*   创建于
*   由...制作
*   修改后
*   修改者

我目前在我的所有视图模型中创建了一个包含这些属性的 .AuditStamps 的新子类，将其填充到我的控制器中并将其传递给部分。

这是我的一个视图模型的示例。注意 AudiStamps 子类

```
public class ItemViewModel
    {
        public Item Item { get; set; }
        public AuditStampsViewModel AuditStamps { get; set; }
    } 
```

这是我的部分，起诉这个子类

```
@model OTIS.AppServ.Shared.AuditStampsViewModel

<hr />
<div class="twoColumn floatLeft">
    <div class="editor-field">
        <b>Created By:</b>
        @Html.DisplayFor(model => model.CreatedByName) on @Html.DisplayFor(model => model.CreatedOn)            
    </div>
</div>
<div class="twoColumn floatLeft">
    <div class="editor-field" style="text-align:right;">
        <b>Modified By:</b>
        @Html.DisplayFor(model => model.ModifiedByName) on @Html.DisplayFor(model => model.ModifiedOn)

    </div>
</div> 
```

但我想知道，既然我所有的类都会有这些共同的属性，我真的需要通过添加和填充这个子类。我唯一的原因是因为我不知道如何在部分中声明一个通用模型......我希望如果我没有声明模型，部分就可以工作，但它没有。我收到一个错误：

```
An expression tree may not contain a dynamic operation 
```

我怎样才能做到这一点？似乎接口仅使用类就可以解决的问题，但不确定是否使用 Partials 也适用相同的概念（即说明部分实现了 IAudiStamps 接口？？？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-26T18:34:27.760

最后，我将部分的模型设置为接口，然后确保我的类也实现了这样的接口：

创建 IAuditStamps 接口

```
public interface IAuditStamps
    {
        int CreatedById { get; set; }
        string CreatedByName { get; set; }
        DateTime CreatedOn { get; set; }
        int ModifiedById { get; set; }
        string ModifiedByName { get; set; }
        DateTime ModifiedOn { get; set; }
    } 
```

实现接口的我的类

```
public partial class Item : IEntityId, ICompanyId, IAuditStamps 
```

ItemViewModel（使用上面的类Item）

```
public class ItemViewModel
    {
        public Item Item { get; set; }
    } 
```

部分

```
@model OTIS.domain.IAuditStamps

<hr />
<div class="twoColumn floatLeft">
    <div class="editor-field">
        <b>Created By:</b>
        @Html.DisplayFor(model => model.CreatedByName) on @Html.DisplayFor(model => model.CreatedOn)            
    </div>
</div>
<div class="twoColumn floatLeft">
    <div class="editor-field" style="text-align:right;">
        <b>Modified By:</b>
        @Html.DisplayFor(model => model.ModifiedByName) on @Html.DisplayFor(model => model.ModifiedOn)

    </div>
</div> 
```

调用部分：

```
@Html.Partial("_AuditStamps", Model.Item) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T22:21:56.917

`ViewModel`这是所有视图模型都可以继承的基类的主要候选者：

```
public abstract class ViewModel 
{
    public DateTime CreatedOn { get; set; }
    public string CreatedBy { get; set; }
    public DateTime ModifiedOn { get; set; }
    public string ModifiedBy { get; set; }
}

public class ItemViewModel : ViewModel
{
    public Item Item { get; set; }
} 
```

然后，您的部分可以将其`ViewModel`作为模型类型来绑定到相关属性。任何需要该部分视图的视图都应该从基础 ViewModel 继承其模型，因此这些属性都可用于模型绑定。

# php - How to allow only 2 selection checkbox in a form with?

> ID：14025950
> 
> 赞同：1
> 
> 时间：2012-12-24T21:48:32.103
> 
> 标签：php, javascript

I want to put a form on my website for giving away 3 prizes. Each member to be able to select only 2 item on the list that they wish to win.

I have created the form and with JavaScript it works fine, but it's client side and can't be trusted.

What is the best way to implement such thing and be sure that each user can ONLY select 2 item? best way to do it with PHP?

Appreciate any help.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T21:57:10.953

为什么不使用单选按钮？

```
<form method="post">
     Price 1 <input type="radio" value="price 1" />
     Price 2 <input type="radio" value="price 2" />
     Price 3 <input type="radio" value="price 3" />
</form> 
```

如果您想允许多个奖品，只需切换到复选框

```
<form method="post">
     Price 1 <input type="checkbox" name="price[]" value="price 1" />
     Price 2 <input type="checkbox" name="price[]" value="price 2" />
     Price 3 <input type="checkbox" name="price[]" value="price 3" />
</form> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T22:00:28.647

jQuery 是老大，看看这里。

[http://gravitywiz.com/2012/06/11/limiting-how-many-checkboxes-can-be-checked/](http://gravitywiz.com/2012/06/11/limiting-how-many-checkboxes-can-be-checked/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-24T22:03:27.630

```
<form action="<?=$_SERVER['PHP_SELF']?>" method="post">
Price 1<input value="price1" type="checkbox" name="price[]">
Price 2<input value="price2" type="checkbox" value="price[]">
Price 3<input value="price3" type="checkbox" value="price[]">
<input type="submit" name="send" value="Send" />
</form> 
```

然后检查数组的大小`$_POST['price']`：

```
<? 
   if(isset($_POST['send'])) {
       if(sizeof($_POST['price']) == 2) {
           //here you go
       } else { 
          echo "error, pick exactly two prices!";
       } 
   }

?> 
```

# php - checking US-only website status using curl

> ID：14025951
> 
> 赞同：1
> 
> 时间：2012-12-24T21:48:38.613
> 
> 标签：php, curl, restriction

**[Problem]**

There is a website which works for US-citizens only (shows info "A" for US-citizens, info "B" for non-US citizens). I need to constantly monitor this webpage for changes ("A" info) - an email should be sent when something is changed! How do I do it? **The problem is that I live in Europe!**

**[Already accomplished]**

I have a linux server, daemon and curl PHP script which accomplishes the following task! It works great for all "non-US-only" websites.

**[Question]**

One way to solve the problem might be to rent a US server but that's not acceptable at all and it is going to cost a lot! I believe that another way to solve the problem might be - to use a US VPN on my server, but for some reasons I won't do that. Is there a way to run curl through proxy maybe? Any ideas?

Current code is the following:

```
function getrequest($url_site/*,$post_data*/) {
    $ch = curl_init();  
    curl_setopt($ch, CURLOPT_URL,$url_site);
    curl_setopt ($ch, CURLOPT_USERAGENT, 'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.0.3) Gecko/2008092417 Firefox/3.0.3');
    curl_setopt($ch, CURLOPT_FAILONERROR, 1);  
    curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER,1);
    curl_setopt($ch, CURLOPT_POST, 1);
    curl_setopt($ch, CURLOPT_COOKIEJAR, COOKIE_FILE);   // Cookie management.
    curl_setopt($ch, CURLOPT_COOKIEFILE, COOKIE_FILE);
    $result = curl_exec($ch); // run the whole process 
    curl_close($ch);

    return $result;
} 
```

and

```
 $sleep_time = 1;
 $login_wp_url = "http://www.mysite.com";
 set_time_limit(60*10);
 $result = getrequest($login_wp_url); 
```

How do I grab contents from US-only website?

P.S. to get the idea of what I mean - try visiting the Hulu from Europe countries. P.P.S. that's not a Hulu, not a homework.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T21:55:38.347

许多云服务提供商，例如 Heroku 和 Amazon，免费提供他们最小的实例。您可以简单地免费设置其中一个，确保您在位于美国的服务器上进行配置并在那里运行您的脚本。

另一种可能性是对这些请求使用（免费）代理。以下是免费代理服务器列表：[http](http://www.xroxy.com/proxy-country-US.htm) ://www.xroxy.com/proxy-country-US.htm 。

```
curl_setopt($ch, CURLOPT_PROXY, "http://160.76.xxx.xxx:8080");
curl_setopt($ch, CURLOPT_PROXYPORT, 8080);
curl_setopt ($ch, CURLOPT_PROXYUSERPWD, "xxx:xxx"); 
```

# r - Referring to variables by column names

> ID：14025953
> 
> 赞同：1
> 
> 时间：2012-12-24T21:50:29.560
> 
> 标签：r

I have a matrix, say `X`, whose columns I need to use in R. I named each column using the `colnames` command. However, when I type the name of a column, nothing comes up. To illustrate, I used a code like the one below:

```
colnames(X) <- c("column1","column2") 
```

When I type `X`, `column1` and `column2` appear at the top of the columns. However, when I type `column1` or `column2`, they cannot be found.

Does anyone know what needs to be done?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-24T22:20:02.003

这是一个相当基本的部分`R`，当你有一个列名、行名、列表元素名等时，你必须告诉`R`对象先看里面。

在您的情况下，您必须执行以下操作：

```
X[,"column1"] 
```

得到`column1`.

对您来说更好的选择是`data.frame`：

```
X <- data.frame(Column1 = c(....), Column2 = c(....))
X$Column1 #Returns "Column1" 
```

在这两种情况下，您现在都正确地告诉 R 查找名为`column1`inside`X`东西。

正如 Matthew 在下面所说，如果您需要在`column`不参考的情况下调用`X`，您可以`attach(X)`先使用。大多数人倾向于避免这种情况，因为它会创建元素的新副本——如果你最终改变它会变得混乱`column1`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-24T21:53:43.713

这是一个这样的矩阵：

```
X <- matrix(1:6, ncol=2)

colnames(X) <- c("column1","column2")
X
     column1 column2
[1,]       1       4
[2,]       2       5
[3,]       3       6

attach(as.data.frame(X))
column1
[1] 1 2 3 
```

# xquery - XQuery：特定字符出现多次之前/之后的子字符串？

> ID：14025958
> 
> 赞同：1
> 
> 时间：2012-12-24T21:51:58.743
> 
> 标签：xquery, xpath-2.0

我有这个字符串 ($str) : `67-89-90T`，我想保留`67-89`.

当然`substring-before($str,'-')`return `67`，但我该如何选择第二个破折号？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T22:37:59.347

XPath 2 解决方案是：

```
replace("67-89-90T", "(.*)-[^-]*$", "$1") 
```

（也可以，如果没有 -，那么它不匹配并且什么都不替换）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T23:59:02.520

**使用标记化的 XPath 2.0 解决方案可能比使用 RegEx 更易读和易懂：**

```
string-join(tokenize(concat($vStr,'-'), '-')
                                     [.][not(position() eq last())], 
            '-') 
```

**当使用 XQuery 处理器或 XPath 2.0 处理器运行时，表达式：**

```
string-join(tokenize(concat('-', '67-89-90T','-'), '-')
                                     [.][not(position() eq last())], 
            '-') 
```

**产生想要的正确结果：**

```
67-89 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-24T22:05:31.807

好的，我终于找到了`functx:substring-before-last`。不选择特定的破折号，但在这种情况下对我有用。

[http://www.xqueryfunctions.com/xq/functx_substring-before-last.html](http://www.xqueryfunctions.com/xq/functx_substring-before-last.html)

# oop - As an API developer, when should I expect base class implementation to be called?

> ID：14025960
> 
> 赞同：0
> 
> 时间：2012-12-24T21:52:01.603
> 
> 标签：oop

I am currently developing an API that uses abstract classes with default implementations. While I have done this in the past I have not really thought of the philosophical implications of calls back to base.SomeMethod() in the derived class since the APIs were not intended for public consumption. Since this API is intended to be publicly visible, I am wondering how I should handle calls back into the base class. Is it OK for me to assume that the base call will always happen first or last in the derived implementation and I simply document the assumption for the implementer? Or should the base class calls have no side effects, so it wouldn't matter when the implementer calls the base class? Is there a rule of thumb for this?

Thanks.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T14:00:57.930

恕我直言，这在很大程度上取决于您特定班级的需求。如果您想确保调用基本行为（甚至可能以特殊顺序），您可以使用[模板方法](http://www.oodesign.com/template-method-pattern.html)。我发现这种模式是一种以受控方式提供子类扩展点的非常优雅的方式，我认为这比给开发人员留下评论要好。

明显的缺点是，如果您选择错误的钩子，您可能会过多地限制其他开发人员。我记得有一两次不得不重写模板方法，因为钩子不允许我执行我需要的行为。

高温高压

# java - Map 的值是一个对象。我如何使用/遍历所有这些变量？（爪哇）

> ID：14025962
> 
> 赞同：0
> 
> 时间：2012-12-24T21:52:06.590
> 
> 标签：java, class, object, map, hashmap

我有描述人的数据——他们都有一个 ID、头发颜色、眼睛颜色、年龄等。一个 People 类包含这些值。我在另一堂课上做了这样的地图：

```
private static Map<Integer, People> people = new HashMap<Integer, People>(); 
```

我为它创建了一个 getPeople() 方法，所以我可以在其他地方使用它。

当我试图获取我的“人”地图的值时，我将它作为一个长字符串取回，比如 brownblue6 没问题，因为我得到了正确的值，但我需要一个一个地使用它们。

因此，假设我需要对这个人的 ID 做一些事情，或者如果那个人有蓝眼睛，我需要得到这个人的头发颜色。

如何遍历这些值或仅获取“eyeColor”字符串的值？我真的需要在这里使用 Map 还是有另一种更简单的方法？（描述人的东西必须放在一个单独的类中，我无法更改。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T21:54:15.273

目前尚不清楚您是否需要地图 - 甚至您正在使用什么键。除非您需要按键查找，否则您可能只需要一个`List<People>`- 并且您可能应该将您的类型重命名为`Person`if 它意味着每个实例代表一个*人*，这看起来更有可能。那时，您可以使用：

```
for (Person person : foo.getPeople() {
    String eyeColor = person.getEyeColor();
    // Do whatever you need
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T21:55:12.590

首先，*人*是指*人*。我怀疑你可能想要这样的东西：

```
private static Map<Integer, Person> people = new HashMap<Integer, Person>(); 
```

之后，您可以使用*enhanced-for-loop*来迭代地图。例如：

```
for(Map.Entry<Integer, Person> person: people.entrySet())
{
   String hair = person.getHairColor();
   //... You can retrieve other features as well.
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-24T21:57:57.237

由于您没有提供您的类代码，我将不得不猜测字段名称等，但这似乎应该完成您想要的：

```
// Get the people (which are values, as opposed to keys) of the map.
Collection<Person> people = getPeople().values();

// Iterate over each person.
for (Person somePerson : people) {
    // Do something with the eye color.
    System.out.println("This eye color is " + somePerson.eyeColor);
} 
```

# javascript - 强制 ASP.NET 为所有用户代理生成 JavaScript

> ID：14025964
> 
> 赞同：8
> 
> 时间：2012-12-24T21:52:38.133
> 
> 标签：javascript, asp.net, postback, dopostback

我最近在我的 ASP.NET Web 应用程序中注意到，如果我将用户代理设置为空字符串（使用 FireFox 插件来欺骗用户代理），那么 ASP.NET 将不会生成执行回发所需的 javascript。更具体地说，如果您尝试`__doPostBack(a, b)`从您的 javascript 调用该函数，您将收到一条错误消息，指出该函数未定义。

我知道每个浏览器都有一个用户代理，所以这种情况不会经常出现，但问题的本质仍然存在：在某些情况下，如果您依赖于无法识别或格式错误的用户代理，可能会使您的 Web 应用程序无法使用回发。

这类似于这个问题：[ASP.net not generate javascript for some User Agents](https://stackoverflow.com/questions/917688/asp-net-not-generating-javascript-for-some-user-agents)，但如果我没看错，看起来你会逐个修复每个无法识别的用户代理并将其屏蔽为另一个浏览器。我不太关心单个用户代理，更关心的是某些用户代理将无法使用我的应用程序并且我不知道这一点，因为错误发生在 javascript 中而不是服务器上。

有谁知道我可以强制 ASP.NET 始终生成所需的 javascript 的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-24T22:54:48.600

如果您将 User Agent 设置为空，或者如果您使用未知的 User Agent 字符串，则 asp.net 会`Default.browser`从目录中读取文件，`Browsers`您可以在其中定义您喜欢如何处理这种情况。

您需要更改并在这种情况下使用 javascript 的行是：

```
 <capability name="jscriptversion"       value="5.6" />
        <capability name="javascript"           value="true" />
        <capability name="javascriptversion"    value="1.5" /> 
```

默认情况下，如果为**false则为****javascript**行。我想在这里评论一下，我不太确定您是否真的需要更改它，如果有人欺骗了用户代理，那就让它去做吧。如果他喜欢你的网站并需要使用它，那么最好让你知道如何处理他使用的浏览器。另一方面，如果可能的话，您必须注意，您的网站即使在没有 javascript 的情况下也能正常工作，至少对于您执行的大多数操作而言。

 **最好避免使用链接按钮（使用 _doPostBack），例如使用回发按钮。我知道 GridView 和其他也使用 _doPostBack 进行分页...可以，但最好是一个即使没有 javascript 也能工作的好网站。

一些类似的问题：
[__doPostBack is undefined on DotNetNuke website for IE 10](https://stackoverflow.com/questions/13203792/dopostback-is-undefined-on-dotnetnuke-website-for-ie-10)

和这个博客：[错误和修复：ASP.NET 无法检测到 IE10 导致 _doPostBack 是未定义的 JavaScript 错误或保持 FF5 滚动条位置](http://www.hanselman.com/blog/BugAndFixASPNETFailsToDetectIE10CausingDoPostBackIsUndefinedJavaScriptErrorOrMaintainFF5ScrollbarPosition.aspx)**

# windows - mftraining 给出警告：在 CreateIntTemplates() 中没有 F 的原型/配置

> ID：14025965
> 
> 赞同：2
> 
> 时间：2012-12-24T21:52:48.837
> 
> 标签：windows, ocr, tesseract

**编辑：** mftraining 在标题中为 unicharset 中的所有字符提供警告（不仅是 F，还有 a、b、c、d 等）我如何创建这些原型/配置？

我正在关注[本](http://michaeljaylissner.com/blog/adding-new-fonts-to-tesseract-3-ocr-engine)教程

* * *

**现在解决的上一个问题：-**
错误：断言失败警告：在文件 ....\classify\trainingsampleset.cpp，第 622 行没有原型/分段错误
这是整个命令 + 输出：-

C:\training>mftraining -F font_properties -U unicharset -O eng.unicharset eng.impact.box.tr 警告：不存在形状表文件：shapetable 正在读取 eng.impact.box.tr ... 字体 id = -1/ 0，样本 0 上的类 id = 1/103 font_id >= 0 && font_id < font_id_map_.SparseSize():Error:Assert failed:in file....\classify\trainingsampleset.cpp，第 622 行

对于 unicharset 中的所有字符（实际上并不多），我已经查看了标题中此警告中可以找到的所有内容，因此不仅是 F，还有 a、b、c、d 等）如何我无法弄清楚问题是什么以及什么可以使它起作用。创建这些原型/配置？

我也尝试了 shapeclustering 命令，但这给了我同样的错误。此外，当我在 cygwin 上运行这些时，它会显示分段错误而不是断言错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T06:56:58.210

I was having the same problem, and it was indeed a problem with font_properties. However, in my case, it was solved by making sure that the font in font_properties matched exactly the font name in the .tr file. In my case, that was [fontname].exp0.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-03-08T18:39:00.333

我发现了这个问题的两个可能原因。

# 可能原因1：不正确的font_properties

font_properties 文件应包含以下描述的内容：

[https://github.com/tesseract-ocr/tesseract/wiki/Training-Tesseract-3.00%E2%80%933.02#font_properties-new-in-301](https://github.com/tesseract-ocr/tesseract/wiki/Training-Tesseract-3.00%E2%80%933.02#font_properties-new-in-301)

文件编码应满足以下要求：

[https://github.com/tesseract-ocr/tesseract/wiki/Training-Tesseract-3.00%E2%80%933.02#requirements-for-text-input-files](https://github.com/tesseract-ocr/tesseract/wiki/Training-Tesseract-3.00%E2%80%933.02#requirements-for-text-input-files)

这是互联网上最常见的答案。

（还要确保在 font_properties 中指定字体而不是语言。）

# 可能原因2：训练文件名错误

但是我发现尝试修复 font_properties 对我不起作用，并发现了另一个在我的案例中给出相同错误的原因。

文件 .tr 文件必须包含以下格式：

```
<language>.<fontname>.exp<num>.tr 
```

并不是：

```
<language>.<fontname>.exp<num>.box.tr 
```

（在一些教程中可以看到）

所以在我的情况下，这将不起作用：

```
tesseract eng.unknown.exp1.png eng.unknown.exp1.box nobatch box.train
unicharset_extractor eng.unknown.exp1.box
mftraining -F font_properties -U unicharset -O eng.unicharset eng.unknown.exp1.box.tr 
```

而这个小小的改变确实有效：

```
tesseract eng.unknown.exp1.png eng.unknown.exp1 nobatch box.train
unicharset_extractor eng.unknown.exp1.box
mftraining -F font_properties -U unicharset -O eng.unicharset eng.unknown.exp1.tr 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-29T16:24:41.907

我和你有同样的问题。这是因为 font_properties 的格式不正确。

font_properties 文件的每一行格式如下： fontname italic bold fixed serif fraktur

这里只需要字体名。当我将文件从 lang.fontname.exp0 0 0 0 0 0 更改为 fontname 0 0 0 0 0 时，我的问题已解决

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-01-23T10:50:13.837

我有同样的问题和改变

```
 fontname 0 0 0 0 0 
```

至

```
 fontname.exp0 0 0 0 0 0 
```

根据 .tr 文件中的字体名称修复它

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-25T05:49:03.010

您错过了一个 shapeclustering 步骤，这是[Tesseract 3.02 training](http://code.google.com/p/tesseract-ocr/wiki/TrainingTesseract3)中的新功能。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-10-01T19:15:26.867

我有同样的问题，并改变`font_properties`如下修复它：

从 - `batangche 1 0 0 0 0`

至 - `batangche.exp0 1 0 0 0 0`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-10-10T06:01:48.777

在我的例子中，font_properties 文件中的字体名称是大写的，而 .tr 文件中的字体名称是小写的。将它们更改为相同的情况解决了问题。

# matlab - 验证卷积定理

> ID：14025967
> 
> 赞同：1
> 
> 时间：2012-12-24T21:53:12.853
> 
> 标签：matlab, convolution, dft

我的主要目标是证明卷积定理有效（只是提醒一下：卷积定理意味着`idft(dft(im) .* dft(mask)) = conv(im, mask)`）。我正在尝试对此进行编程。

这是我的代码：

```
function displayTransform( im )
% This routine displays the Fourier spectrum of an image.
% 
% Input:      im - a grayscale image (values in [0,255]) 
% 
% Method:  Computes the Fourier transform of im and displays its spectrum,
%                    (if F(u,v) = a+ib, displays sqrt(a^2+b^2)).
%                    Uses display techniques for visualization: log, and stretch values to full range,
%                    cyclic shift DC to center (use fftshift).
%                    Use showImage to display and fft2 to apply transform.  

%displays the image in grayscale in the Frequency domain
imfft = fft2(im);
imagesc(log(abs(fftshift(imfft))+1)), colormap(gray);

% building mask and padding it with Zeros in order to create same size mask
b = 1/16*[1 1 1 1;1 1 1 1; 1 1 1 1; 1 1 1 1];
paddedB = padarray(b, [floor(size(im,1)/2)-2 floor(size(im,2)/2)-2]);
paddedB = fft2(paddedB);
C = imfft.*paddedB;
resIFFT = ifft2(C);

%reguler convolution
resConv = conv2(im,b);
showImage(resConv);

end 
```

我想比较`resIFFT`和`resConv`。我想我错过了一些铸造，因为如果我使用铸造来加倍，我会让矩阵中的数字更接近另一个。也许我在铸造或填充的地方有一些错误？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-25T16:42:25.753

1.  为了使用 DFT 计算线性卷积，您需要用零对两个信号进行后填充，否则结果将是[循环卷积](http://en.wikipedia.org/wiki/Circular_convolution)。您不必手动填充信号，[`fft2`](http://www.mathworks.com/help/matlab/ref/fft2.html)如果您向函数调用添加其他参数，可以为您完成，如下所示：

    ```
    fft2(X, M, N) 
    ```

    在进行变换之前，此填充（或截断）信号`X`以创建 M×N 信号。
    将每个维度中的每个信号填充到等于两个信号长度之和的长度，即：

    ```
    M = size(im, 1) + size(mask, 1);
    N = size(im, 2) + size(mask, 2); 
    ```

2.  只是为了良好的做法，而不是：

    ```
    b = 1 / 16 * [1 1 1 1; 1 1 1 1; 1 1 1 1; 1 1 1 1]; 
    ```

    你可以写：

    ```
    b = ones(4) / 16; 
    ```

无论如何，这是固定的代码（我生成了一个随机图像只是为了示例）：

```
im = fix(255 * rand(500));            % # Generate a random image
mask = ones(4) / 16;                  % # Mask

% # Circular convolution
resConv = conv2(im, mask);

% # Discrete Fourier transform
M = size(im, 1) + size(mask, 1);
N = size(im, 2) + size(mask, 2);
resIFFT = ifft2(fft2(im, M, N) .* fft2(mask, M, N));
resIFFT = resIFFT(1:end-1, 1:end-1);  % # Adjust dimensions

% # Check the difference
max(abs(resConv(:) - resIFFT(:))) 
```

你应该得到的结果应该是零：

```
ans =

    8.5265e-014 
```

足够接近。

# postgresql - Postgresql：如何使用 Mac OS X 查找 pg_hba.conf 文件

> ID：14025972
> 
> 赞同：72
> 
> 时间：2012-12-24T21:53:59.547
> 
> 标签：postgresql

嗨，我在使用 postgres 时遇到问题。我不记得我的 postgres 密码，也不知道如何更改密码。我猜我应该更改一个月前设置的 md5 密码设置，但我不知道如何找到该文件并使用我的终端打开它。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：113
> 
> 时间：2013-05-21T15:58:21.077

我最近学到的另一种方法是去终端并输入：

`ps aux | grep postgres`

它显示了您机器上运行的所有 postgres 进程。从列表中，您应该会看到一个格式为`... -D ...`. 例如：

```
root            4155   0.0  0.0  2432908     68   ??  S     6May13   0:00.01 sudo su postgres -c /opt/local/lib/postgresql84/bin/postgres -D /opt/local/var/db/postgresql84/defaultdb -p 5432 
```

-D 表示目录。在终端中，执行 a`sudo su`然后 cd 到该目录，您将找到 pg_hba.conf 文件。

还有一种方法：

转到您的终端并输入：`locate pg_hba.conf`。应该有一些结果。

* * *

## 回答 #2

> 赞同：78
> 
> 时间：2012-12-25T00:28:25.643

如果可以连接，请使用`SHOW hba_file;`.

如果无法连接，则需要找到数据目录。这将显示为启动 PostgreSQL 的or命令的`-D`参数，因此您通常可以使用.`postgres``pg_ctl``ps -ef | grep postgres`

# ruby-on-rails - ActiveRecord 与带有子选择的 SQL

> ID：14025978
> 
> 赞同：0
> 
> 时间：2012-12-24T21:54:36.940
> 
> 标签：ruby-on-rails, activerecord

如果使用 SQL 完成，我发现此查询更容易

```
select Topics.subject, shortcode, (select count(*) from votes where Votes.Topic_Id = Topics.Id ) as votes from Topics
where url like 'http://test.com%'
ORDER BY votes desc; 
```

使用 ActiveRecord，我认为应该有一个更优雅的......或者至少可能的方式来做到这一点。有什么建议么？

我从这个开始，它有效，但没有进入下一步，而是使用：

```
t = Topic.find(:all, :conditions => "url like 'http://test.com%'") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T03:49:25.987

要获得带票的主题：

```
Topic.where('url like :url', :url => 'http://test.com%').
      joins(:votes).
      select('topics.*, count(votes.id) as votes') 
```

请注意，这仅适用于 MySql。对于 PostgreSQL，您需要指定 group 子句：

```
Topic.where('url like :url', :url => 'http://test.com%').
      joins(:votes).
      group(Topic.column_names.map{|col| "topics.#{col}"}).
      select('topics.*, count(votes.id) as votes') 
```

# jqgrid - jqGrid数据加载问题

> ID：14025981
> 
> 赞同：0
> 
> 时间：2012-12-24T21:54:53.263
> 
> 标签：jqgrid

我无法让我的数据显示在 jqgrid 中。我正在使用与此工作示例完全相同的代码：

[jqgrid 不会加载 json 数据](https://stackoverflow.com/questions/9561532/jqgrid-wont-load-json-data?rq=1)

我的数据不同，但实质上并非如此：

```
{"records":95,"page":1,"total":1,"rows":[{"Report":"f_cn_08","File":"F_CONTR.PBL"},{"Report":"f_cn_08","File":"F_CONTR.PBL"},{"Report":"f_cn_08","File":"F_CONTR.PBL"},{"Report":"f_cn_08","File":"F_CONTR.PBL"},{"Report":"f_cn_08","File":"F_CONTR.PBL"},{"Report":"f_cn_08","File":"F_CONTR.PBL"},{"Report":"f_cn_08","File":"F_CONTR.PBL"},{"Report":"f_cn_08","File":"F_CONTR.PBL"},{"Report":"f_cn_08","File":"F_CONTR.PBL"},{"Report":"f_cn_08","File":"F_CONTR.PBL"}]} 
```

我讨厌重新打开同样的问题，但这对我来说非常令人沮丧。

编辑：这是我的代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>InfoMaker  Monitor</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <link rel="stylesheet" type="text/css" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/themes/redmond/jquery-ui.css" />
    <link rel="stylesheet" type="text/css" href="http://www.ok-soft-gmbh.com/jqGrid/jquery.jqGrid-4.3.1/css/ui.jqgrid.css" />
    <style type="text/css">
        html, body { font-size: 75%; }
    </style>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.js"></script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/jquery-ui.min.js"></script>
    <script type="text/javascript" src="http://www.ok-soft-gmbh.com/jqGrid/jquery.jqGrid-4.3.1/js/i18n/grid.locale-en.js"></script>
    <script type="text/javascript" src="http://www.ok-soft-gmbh.com/jqGrid/jquery.jqGrid-4.3.1/js/jquery.jqGrid.src.js"></script>

    <script type="text/javascript">
    //<!CDATA[
        jQuery(function () {
            'use strict';
            jQuery("#jsonmap").jqGrid({
            url: 'http://localhost:8888/nancy/readasjson'
            ,datatype: 'json'
            ,ajaxGridOptions: { contentType: 'application/json; charset=utf-8' }
            // see http://www.trirand.com/jqgridwiki/doku.php?id=wiki:retrieving_data
            ,jsonReader : {
                 page: "page"
                , total: "total"
                , records: "records"
                , rows: "rows"
                ,cell: "cell"
                ,id: "id",
                }
            ,colNames: ['Report','File']
            ,colModel :[ 
               {name:'Report'  ,index:'Report', width:55} 
              ,{name:'File',index:'File', width:55} 
            ]
            ,rowNum:10
            ,rowList:[10,20,30]
            ,viewrecords: true
            ,loadComplete: function() {
              console.log("Load Complete");
              //console.log("URI: " + jQuery("#jsonmap").jqGrid.datatype );
            }
            ,loadError: function(xhr,st,err) { 
                console.log(xhr.statusText);
                //$("#jsonmapMessage").html("Type: "+st+"; Response: "+ xhr.status + " "+xhr.statusText); 
            }
            ,width: '900'
            ,height: 'auto'//'300'
            ,caption: 'My first grid'
          }); 
          jQuery("#jsonmap").jqGrid('navGrid','#pjmap',{edit:true,add:false,del:false});
        });
    //]]>
    </script>
</head>
<body>
    <table id="jsonmap"><tr><td></td></tr></table>
    <div id="pjmap"></div>
</body>
</html> 
```

以下是数据现在的样子：

```
{"records":10,"page":1,"total":1,"rows":[{"id":61,"cell":{"Report":"f_cn_08","File":"F_CONTR.PBL"}},{"id":62,"cell":{"Report":"f_cn_08","File":"F_CONTR.PBL"}},{"id":63,"cell":{"Report":"f_cn_08","File":"F_CONTR.PBL"}},{"id":64,"cell":{"Report":"f_cn_08","File":"F_CONTR.PBL"}},{"id":65,"cell":{"Report":"f_cn_08","File":"F_CONTR.PBL"}},{"id":68,"cell":{"Report":"f_cn_08","File":"F_CONTR.PBL"}},{"id":77,"cell":{"Report":"f_cn_08","File":"F_CONTR.PBL"}},{"id":79,"cell":{"Report":"f_cn_08","File":"F_CONTR.PBL"}},{"id":80,"cell":{"Report":"f_cn_08","File":"F_CONTR.PBL"}},{"id":81,"cell":{"Report":"f_cn_08","File":"F_CONTR.PBL"}}]} 
```

我很想分叉 jqgrid 源并向它添加一些 console.log 消息！因为在没有消息的情况下神秘地失败是采用的一个巨大障碍。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-25T19:45:51.497

您使用的 JSON 数据具有[引用问题中的](https://stackoverflow.com/questions/9561532/jqgrid-wont-load-json-data?rq=1)*另一种*格式，因此 jqGrid 无法读取您的数据。选项描述了 jqGrig 的输入数据的格式。如果数组包含具有命名属性的对象，则应使用. 在这种情况下，参数应该具有带有和的列。`jsonReader``rows``jsonReader: {repeatitems: false}``colModel``name: "Report"``name: "File"`

JSON 数据的下一个问题 - 它没有`id`关于行项目的信息。在这种情况下，jqGrid 将使用整数值 1、2、3... 作为 rowid。这种自动生成的 id 仅适用于每页一个网格。第二个网格将有 id 重复项。因此，建议在 JSON 输入`id`数组的每个项目中包含附加属性。`rows`

# linux - Octave strcat 忽略添加的空格

> ID：14025985
> 
> 赞同：4
> 
> 时间：2012-12-24T21:55:46.680
> 
> 标签：linux, octave, spaces, strcat

**Octave 使用 strcat 添加空格**

在 Octave 中，我运行以下命令：

```
strcat ("hel", " ", "lo") 
```

我得到这个结果：

```
ans = hello 
```

而不是我所期望的：

```
ans = hel lo 
```

strcat 对我来说听起来像“连接字符串”。空格是有效字符，所以添加空格应该没问题。Matlab 具有相同的行为，因此可能是有意的。

我觉得它违反直觉。这种行为有意义吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-24T22:00:25.650

唔。它的工作原理是如何定义的：

“strcat 删除参数中的尾随空格（单元格数组中除外），而 cstrcat 保留空格不变。”

来自[http://www.gnu.org/software/octave/doc/interpreter/Concatenating-Strings.html](http://www.gnu.org/software/octave/doc/interpreter/Concatenating-Strings.html)

所以问题可能是：是否应该改变这种行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T21:58:26.383

strcat 接受输入参数并修剪**尾随**空格，但不修剪前导空格。如果您将参数作为一个或多个空格传递，它们将折叠为空白字符串。

这种行为体现了“cellstr”如何在末尾的空格被删除的情况下工作。

**工作 1**

如果你把空格放在'lo'上，它是一个前导空格，不会被删除。

```
strcat ("hel", " lo")

ans = hel lo 
```

**工作 2**

改用 cstrcat ：

```
cstrcat("hel", " ", "lo")

ans = hel lo 
```

**在 3 左右工作**

使用 sprintf，可以比 strcat 更快。

```
sprintf("%s%s%s\n", "hel", " ", "lo")

ans = hel lo 
```

# c# - udp 客户端绑定

> ID：14025987
> 
> 赞同：1
> 
> 时间：2012-12-24T21:56:07.550
> 
> 标签：c#, sockets, udp, client, bind

我有 UDP 客户端聊天，它将消息发送到服务器并返回响应。我有两个线程，一个用于发送，一个用于接收消息。我收到 ReceiveFrom() 方法的异常：“您必须在执行此操作之前调用 Bind 方法”。但这是一个客户，我不想绑定任何东西。例如这个客户端工作正常：

```
 byte[] data = new byte[30];
    string input, stringData;
    IPEndPoint servIPEP = new IPEndPoint(
            IPAddress.Parse("127.0.0.1"), 9050);
    EndPoint servEP = (EndPoint)servIPEP;
    Socket client = new Socket(AddressFamily.InterNetwork,
            SocketType.Dgram, ProtocolType.Udp);
    string welcome = "Hello, are you there?";
    data = Encoding.ASCII.GetBytes(welcome);
    client.SendTo(data, data.Length, SocketFlags.None, servEP);
    data = new byte[30];
    int recv = client.ReceiveFrom(data, ref servEP);    //works fine! 
```

接收没有绑定。但是当我创建两个线程时抛出错误：

```
 public ChatClient()
        {
            clientSock = new Socket(AddressFamily.InterNetwork, 
                               SocketType.Dgram, ProtocolType.Udp);
            servIPEP = new IPEndPoint(IPAddress.Parse("127.0.0.1"), 32000);
            servEP = (EndPoint)servIPEP;
        }

         public void ReceiveThread()
        {
            Thread receiveThread = new Thread(new ThreadStart(ReceiveData));
            receiveThread.Start();
        }

        public void ReceiveData()
        {
           while(true){
                clientSock.ReceiveFrom(buf, ref servEP); //Here I get ERROR
                string msg = Encoding.ASCII.GetString(buf).Trim();
                Console.WriteLine("New message: {0}",msg);
                }

        }

        public void SendThread()
        { 
            Thread sendThread = new Thread(new ThreadStart(SendData));
            sendThread.Start();
        }

        public void SendData()
        {
            while (true)
            {
                Console.WriteLine("Enter message to send: ");
                string msg = Console.ReadLine();
                buf = Encoding.UTF8.GetBytes(msg);
                clientSock.SendTo(buf, servEP);
            }
        }
    }

    static void Main(string[] args)
    {

        ChatClient client = new ChatClient();
        client.SendThread();
        client.ReceiveThread();
    }
} 
```

感谢您的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-25T00:42:08.937

显然 SendTo() 做了一个隐式绑定，而 ReceiveFrom() 没有。

在没有事先绑定的情况下开始接收至少设置您接收的端口号是没有多大意义的。否则，您将如何获得任何数据？

# servlets - PrimeFaces 文件上传

> ID：14025997
> 
> 赞同：3
> 
> 时间：2012-12-24T21:58:01.127
> 
> 标签：servlets, jsf-2, primefaces, jspx

我在一个项目中使用 jsp/Servlet，我决定使用 PrimeFaces 迁移到 JSF，我在尝试使用 PrimeFaces 文件上传控件上传文件时遇到了一个问题，然后当我将它配置到 web.xml 时它运行良好，问题现在所有旧的jsp文件上传方式都不起作用：

```
 DiskFileUpload upload = new DiskFileUpload();
 List items = upload.parseRequest(request); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-24T23:56:44.837

事实上，一个 HTTP 请求只能被解析一次。如果您需要解析两次，客户端不会再次发送它。您的问题表明 PrimeFaces 文件上传过滤器由于某种原因也在普通 JSP/Servlet 请求上调用，因此在普通 JSP/Servlet 有机会解析它以供自己使用之前解析 JSF 的上传。这不应该发生。

您需要仅将 PrimeFaces 文件上传过滤器映射到 JSF 请求，而不是简单的 JSP/Servlet 请求。您通常通过将其映射到`FacesServlet`.

```
<filter-mapping>
    <filter-name>PrimeFaces FileUpload Filter</filter-name>
    <servlet-name>Faces Servlet</servlet-name>
</filter-mapping> 
```

*（`<servlet-name>`必须与类`<servlet>`定义中使用的值完全相同`FacesServlet`；`<filter-name>`显然`<filter>`与文件上传过滤器类的定义中使用的值完全相同）*

或者，如果由于某些不明显的原因直接在 JSF 页面中使用旧的 JSP/Servlet 文件上传方法，那么您需要将 PrimeFaces 文件上传过滤器映射到更具体的 URL 模式，该模式仅覆盖包含 PrimeFaces 文件上传组件的页面.

```
<filter-mapping>
    <filter-name>PrimeFaces FileUpload Filter</filter-name>
    <url-pattern>/upload.xhtml</url-pattern>
</filter-mapping> 
```

*（例如，如果您映射了`FacesServlet`on`*.jsf`而不是`*.xhtml`，那么您显然应该将 URL 模式更改为`/upload.jsf`）*

请注意，您可以`<url-pattern>`在单个过滤器映射上指定多个条目，这对于您有多个包含 PrimeFaces 文件上传组件的页面的情况很有用。

```
<filter-mapping>
    <filter-name>PrimeFaces FileUpload Filter</filter-name>
    <url-pattern>/upload1.xhtml</url-pattern>
    <url-pattern>/upload2.xhtml</url-pattern>
    <url-pattern>/upload3.xhtml</url-pattern>
</filter-mapping> 
```

# java - 在 Java 中是否可以避免使用赋值？

> ID：14025998
> 
> 赞同：-3
> 
> 时间：2012-12-24T21:58:01.983
> 
> 标签：java, compiler-construction

在 Java 中是否可以避免使用赋值？在 lisp 中，通过尾递归、映射和通过绑定修改数据很容易将可能的赋值限制在迭代中，但 Java 并没有真正进行任何尾递归优化。java中有没有方法可以绑定到数据而无需赋值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T22:02:24.983

你可以编写自己的一堆类来模拟`Lisp`，但你不能用java本身来模拟它。