# StackOverflow 问答 16047000-16047999

# html - 水平滚动 DIV 内的内联 Span 元素

> ID：16047000
> 
> 赞同：1
> 
> 时间：2013-04-16T21:01:24.753
> 
> 标签：html

我希望这里有人可以帮助我完成这个简单的任务。我希望在水平滚动 DIV 中放置几个​​跨度元素。我最初在水平 DIV 中有 DIV，但被告知：

> CSS 渲染不适用于内联块元素。除非包含的 DIV 设置为足够大的宽度值以让所有内联块元素向左浮动，否则它们将始终换行。

我切换到元素，但我仍然无法包装它们。我被派到[这里](https://stackoverflow.com/questions/1321851/how-to-get-horizontal-scrolling-with-the-div-element)，导致我来到[这里](https://stackoverflow.com/questions/1015809/how-to-get-floating-divs-inside-fixed-width-div-to-continue-horizontally)，然后我自己找到了[这个](https://stackoverflow.com/questions/6431101/horizontal-scroll-in-div-with-many-small-divs-inside-no-text)。这些都不适合我。

有问题的页面在这里： http: [//melanie-patterson.com/fashion-bloggers/](http://melanie-patterson.com/fashion-bloggers/)

到目前为止，这是我的 HTML：

```
<div class="SpanContainer">
<span class="block">
<img src="http://melanie-patterson.com/wp-content/uploads/2012/10/dlsw4.png" alt="" />
<br>description</span>

<span class="block">
<img src="http://melanie-patterson.com/wp-content/uploads/2012/10/leprettystellar.png">
<br>DESCRIPTION</span>

<span class="block">
<img src="http://melanie-patterson.com/wp-content/uploads/2012/10/simonett.png" alt="" />
<br>DESCRIPTION
</span>
</div> 
```

这是我的CSS：

```
.format_text {
width:750px;
height: 600px;
overflow: auto;
white-space: nowrap;
}

#SpanContainer {
width:1000px;
height: 600px;
overflow-x: scroll;
overflow-y: hidden;
margin:auto;
float: left;
}

span.block {
display: inline-block;
width: 300px;
} 
```

我不知道为什么我有这么多问题！任何帮助都会很棒。另外，让我补充一下，我正在使用 Wordpress，特别是 DIYThemes 的“论文”主题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-06T10:02:01.167

那应该是`div id="SpanContainer"`
你使用了*class*而不是*id*

# c# - EnumerateFiles() 是如何工作的？

> ID：16047001
> 
> 赞同：3
> 
> 时间：2013-04-16T21:01:26.113
> 
> 标签：c#, file-io

我正在编写一个程序，当给定日期、文件夹路径和文件扩展名时，它将查看文件夹并查找从月初到当前日期具有最后访问时间的所有文件，并且只有文件使用传递的文件扩展名。

我要查找的文件始终位于文件夹树中的同一级别，因此我可以在程序中编写代码，挖掘多远才能找到文件。

目前我的程序一天大约需要一分钟，所以今天（16 号）大约需要十六分半钟。

我想制作一个程序来填充查找文件夹路径中某个日期范围的所有文件，并从文件中提取信息。我只是不想编写程序必须查看的深度，以防我的业务更改他们存储文件的方式。

我设法编写代码，如果给定一个文件夹，程序将显示日期范围内所有文件的名称，但这需要 25 分钟。这是代码

```
TimeSpan BeginningTime = DateTime.Now.TimeOfDay;
DateTime BeginningDate = new DateTime(DateTime.Now.Year, DateTime.Now.Month, 1);
DateTime EndingDate = DateTime.Now;
string[] FoldersToLookAt = { @"e:\", @"e:\Kodak Images\", @"e:\images\", @"e:\AFSImageMerge\" };
foreach (string FolderPath in FoldersToLookAt)
{
    for (DateTime Date = BeginningDate; Date <= EndingDate; Date = Date.AddDays(1))
    {
        string DateString = Date.ToString("yyMMdd");
        string FilePath = (FolderPath + DateString);
        DirectoryInfo FilesToLookThrough = new DirectoryInfo(FilePath);
        if (FilesToLookThrough.Exists)
        {
            foreach (var MyFile in FilesToLookThrough.EnumerateFiles("*.dat", SearchOption.AllDirectories))
            {
                if (MyFile.LastAccessTime >= BeginningDate)
                {
                    Console.WriteLine(MyFile.FullName);
                }
            }
        }
    }
} 
```

据我所知，这首先获取所有文件，然后遍历所有文件并打印出所有最后访问时间大于开始日期的文件。

他们在 C# 中是一种从文件中提取信息而不将其存储在列表中的方法吗？还是我必须从头开始构建程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T22:01:03.257

您的问题不是很清楚，但是查看您的代码以及您想要实现的目标，我建议您摆脱带您浏览日期文件夹的循环。只需使用每个顶级文件夹下的“AllDirectories”选项。它是递归的，所以它会通过尽可能多的层次。

```
TimeSpan BeginningTime = DateTime.Now.TimeOfDay;
DateTime BeginningDate = new DateTime(DateTime.Now.Year, DateTime.Now.Month, 1);
DateTime EndingDate = DateTime.Now;
string[] FoldersToLookAt = { @"e:\", @"e:\Kodak Images\", @"e:\images\", @"e:\AFSImageMerge\" };
foreach (string FolderPath in FoldersToLookAt)
{
    FilesToLookThrough = new DirectoryInfo(FolderPath);
    if (FilesToLookThrough.Exists)
    {
        foreach (var MyFile in FilesToLookThrough.EnumerateFiles("*.dat", SearchOption.AllDirectories))
        {
            if (MyFile.LastAccessTime >= BeginningDate)
            {
                Console.WriteLine(MyFile.FullName);
            }
        }
    }
} 
```

编辑：另一个答案很重要，因为您正在通过“e：\”，您可能不需要通过其他“FoldersToLookAt”，因为无论如何它们都会被搜索。您最终可能会得到同一个文件的多个列表。如果你把它们拿出来，它会运行得更快一些。

你看，你的代码一开始就非常接近。使用这种方法，您可以剪掉一个完整的循环，并且“AllDirectories”搜索选项将确保您递归地查看所有子文件夹。您还可以防止您的组织决定不将内容存储在按日期命名的文件夹中等，现在您的程序的运行时间仅与文件数量成正比。

现在，为了额外的功劳，可以通过不为每个项目使用 Console.WriteLine 来实现另一大性能改进。一种更快的方法是使用 StringBuilder，然后在最后吐出结果。

```
// At the top of your program
StringBuilder sb = new StringBuilder();
// BeginningTime, BeginningDate, etc...

// Before the first loop
Console.WriteLine("Working...");

// Inside the very inner if, where your Console.WriteLine was
sb.AppendLine(MyFile.FullName);

// After the end of the outer loop
Console.WriteLine(sb.ToString()); 
```

为什么这会让它变得更好？写入控制台的速度非常慢，实际上涉及将 Windows 发送到内核模式并返回，这真的非常非常慢。做一次，一个大块文本的事件，比做很多事情要快得多。现在，为什么要使用 StringBuilder 而不是只做一个好的旧的：

```
string output;

for(...)
{
     output += filename + Environment.NewLine;
} 
```

在 C# 中，将两个字符串相互添加会创建一个新字符串。一遍又一遍地这样做也很慢，尤其是当新字符串变大时。StringBuilder 只是维护所有字符串的列表，并在调用 ToString() 时创建一个新缓冲区并将它们全部复制一次。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T21:35:48.873

考虑到您的要求，您的程序看起来比它必须的要复杂得多。

```
string[] FoldersToLookAt = { @"e:\",
                             @"e:\Kodak Images\",    // do you really need these,
                             @"e:\images\",          // since you're already
                             @"e:\AFSImageMerge\" }; // going through e:\ ?
DateTime BeginningDate = new DateTime(DateTime.Now.Year, DateTime.Now.Month, 1);

foreach (string FolderPath in FoldersToLookAt)
{
    DirectoryInfo FilesToLookThrough = new DirectoryInfo(FolderPath);
    foreach (FileInfo MyFile in FilesToLookThrough.EnumerateFiles("*.dat",
                                                    SearchOption.AllDirectories))
    {
        if (MyFile.LastAccessTime >= BeginningDate)
        {
            Console.WriteLine(MyFile.FullName);
        }
    }
} 
```

这段代码不会循环几天，所以它应该有一个恒定的运行时间`BeginningDate`，这意味着无论你选择什么日期，它总是需要相同的时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T22:15:23.007

听起来，给定要搜索的目录列表，在要搜索的目录的某些子目录中查找与特定模式匹配并且在当月内被触及的所有文件。鉴于该问题陈述，您应该这样做：

```
static IEnumerable<FileInfo> FindFiles( IEnumerable<string> directories , string searchPattern )
{
  DateTime     dtNow       = DateTime.Now.Date                ; // current date
  DateTime     dtFrom      = dtNow.AddDays( dtNow.Day - 1 )   ; // compute the first of the month @ start-of-day
  DateTime     dtThru      = dtFrom.AddMonths(1).AddTicks(-1) ; // compute the last of the month @ end-of-day
  string       childPattern = dtFrom.ToString( "yyMM*") ;

  return directories.Select( x => new DirectoryInfo( x ) )
                    .Where( x => x.Exists )
                    .SelectMany( x => x.EnumerateDirectories( childPattern , SearchOption.TopDirectoryOnly )
                                       .Where( subDir => {
                                           int dd ;
                                           int.TryParse( subDir.Name.Substring(4,2) , out dd ) ;
                                           return dd >= dtFrom.Day && dd <= dtThru.Day ;
                                         })
                    )
                    .SelectMany( subDir => subDir.EnumerateFiles( searchPattern , SearchOption.TopDirectoryOnly )
                                                 .Where( file => file.LastAccessTime >= dtFrom && file.LastAccessTime <= dtThru )
                    )
                    ;

} 
```

解释这段代码的作用：

```
directories.Select( x => new DirectoryInfo( x ) ) 
```

获取提供的字符串目录路径的可枚举列表并将其转换为`DirectoryInfo`表示指定目录的可枚举对象列表

```
.Where( x => x.Exists ) 
```

排除任何不存在的目录

这给出了使用要搜索的根目录集。

下一个子句稍微复杂一些。`SelectMany()`获取可枚举的事物列表。列表中的每个项目都被转换为可枚举的事物列表（可能与原始对象类型相同，也可能不同。但是，每个这样的子列表必须属于相同类型。）

然后将生成的“列表列表”*展平*以生成单个可枚举列表。

考虑到这一点，

```
.SelectMany( x => x.EnumerateDirectories( childPattern , SearchOption.TopDirectoryOnly )
                   .Where( subDir => {
                     int dd ;
                     int.TryParse( subDir.Name.Substring(4,2) , out dd ) ;
                     return dd >= dtFrom.Day && dd <= dtThru.Day ;
                   })
                ) 
```

将每个根目录转换为子目录列表，其名称以指定的年份和月份 ( `yyMM*`) 开头，其第 4 和第 5 个字符是月份中的日期。然后将该子目录列表列表展平为单个子目录列表。

最后`SelectMany()`

```
.SelectMany( subDir => subDir.EnumerateFiles( searchPattern , SearchOption.TopDirectoryOnly )
                             .Where( file => file.LastAccessTime >= dtFrom
                                          && file.LastAccessTime <= dtThru
                                   )
 ) 
```

遍历从第一个产生的子目录列表`SelectMany()`，搜索每个名称与指定名称模式匹配的文件（`*.dat`在您的示例中）并且其最后访问时间在指定时间范围内。

FileInfo 对象列表的结果列表然后被展平为一个 FileInfo 对象列表，表示您感兴趣的文件。

然后您可以直接访问它们，例如

```
string[] searchDirs =
{ @"e:\"              ,
  @"e:\Kodak Images\" ,
  @"e:\images\"       ,
  @"e:\AFSImageMerge\"
} ;

foreach ( FileInfo fi in FindFiles( searchDirs , "*.dat" )
{
  do_something_with_interesting_file( fi ) ;
} 
```

# javascript - 如何使用动态内容制作可滚动的 div

> ID：16047002
> 
> 赞同：1
> 
> 时间：2013-04-16T21:01:28.830
> 
> 标签：javascript, jquery, html

当我单击添加按钮时，我正在尝试将图像添加到我的 div 内部底部到顶部。现在它正在工作，但我的问题是 div 不滚动。我做错了什么？

[**JSFiddle 链接**](http://jsfiddle.net/4Ftev/5/)

**HTML**

```
 <button id="add_content">Add</button>
 <div class="image_panel"></div> 
```

**CSS**

```
 .image_panel {
     width:100%;
     height:300px;
     border:1px solid red;
     overflow-y:scroll;
  }
  #add_content{
     float:left;
  } 
```

**JavaScript**

```
$(document).ready(function() {
  var smallimg_count=0;
  var bottom=0;
  $("#add_content").click(function() {
    smallimg_count++;
    bottom=bottom+20;      
    var insert_html_small = '<div id="imageGrid_' + smallimg_count + '"  class="imageGrid_small"  >
                               <img class="resize1" id="resize_' + smallimg_count + '" src="http://webbies.dk/assets/templates/SudoSlider/images/toolbox_designer.png" style="bottom:' + bottom + 'px;" />
                             </div>';
    $(insert_html_small).appendTo(".image_panel");
  });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T21:06:52.293

我看到的一个问题是您添加的图像具有绝对位置内联样式（来自您的 JSFiddle）

例如

```
style="bottom:' +   bottom + 'px; position: absolute;' 
```

因此，它与 div 处于不同的堆叠上下文中

删除它似乎使它工作：http: [//jsfiddle.net/4Ftev/12/](http://jsfiddle.net/4Ftev/12/)

例如

```
$(document).ready(function () {
    var smallimg_count = 0;
    var bottom = 0;
    $("#add_content").click(function () {
        smallimg_count++;
        bottom = bottom + 20;
        var insert_html_small = '<div id="imageGrid_' + smallimg_count + '"  class="imageGrid_small"  ><img   class="resize1" id="resize_' + smallimg_count + '" src="http://webbies.dk/assets/templates/SudoSlider/images/toolbox_designer.png" /></div>';
        $(insert_html_small).appendTo(".image_panel");
    });
}); 
```

如果你想自下而上添加它，那么你可以使用`prependTo`，见这个 JSFiddle

[http://jsfiddle.net/4Ftev/15/](http://jsfiddle.net/4Ftev/15/)

```
$(document).ready(function () {
    var smallimg_count = 0;
    var bottom = 0;
    $("#add_content").click(function () {
        smallimg_count++;
        bottom = bottom + 20;
        var insert_html_small = '<div id="imageGrid_' + smallimg_count + '"  class="imageGrid_small"  >' + smallimg_count + '<img   class="resize1" id="resize_' + smallimg_count + '" src="http://webbies.dk/assets/templates/SudoSlider/images/toolbox_designer.png" /></div>';
        $(insert_html_small).prependTo(".image_panel");
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T21:06:17.680

You are using an absolute positioned image, inside a div which is not relative positioned.

First of all, add `position:relative;` to the `.image_panel` class style

What you will notice now, is that the image is positioned relative to the div. If you want to test the scrollbar, i would recommend you to use a margin instead of the absolute positioning on your image.

Like, `margin-top:900px;`

**Css**

```
 .image_panel
    {
     width:100%;
     height:300px;
     border:1px solid red;
     overflow-y:scroll;
     position:relative;
     }
   #add_content{
     float:left;
    } 
```

**Javascript**

```
 $(document).ready(function(){
var smallimg_count=0;
var bottom=500;
$("#add_content").click(function(){
smallimg_count++;
bottom=bottom+20;      
var insert_html_small = '<div id="imageGrid_' +   smallimg_count + '"  class="imageGrid_small"  ><img   class="resize1" id="resize_' + smallimg_count + '" src="http://webbies.dk/assets/templates/SudoSlider/images/toolbox_designer.png" style="margin-top:' +   bottom + 'px;"    /></div>';
$(insert_html_small).appendTo(".image_panel");
});
}); 
```

[http://jsfiddle.net/3gzaW/](http://jsfiddle.net/3gzaW/)

Best regards. Jonas

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T21:07:30.170

您的图片：

```
<img class="resize1" id="resize_3" src="http://webbies.dk/assets/templates/SudoSlider/images/toolbox_designer.png" style="bottom:60px; position: absolute;;"> 
```

带走位置：绝对；（使其相对，或完全删除）

# vbscript - 获取调用QTP中注册函数的对象类型

> ID：16047008
> 
> 赞同：2
> 
> 时间：2013-04-16T21:01:54.647
> 
> 标签：vbscript, qtp

我正在尝试开发一个通用注册函数来验证给定对象的存在，然后在报告中添加一行来说明它是否被发现。

这是功能：

```
'@Description Reports in the test results whether the given object exists.
Public Function verifyExistence(ByRef test_object)
    If test_object.Exist(1) Then
        Reporter.ReportEvent micPass, "Verify that the page exists.", "Page exists."
    Else
        Reporter.ReportEvent micFail, "Verify that the page exists.", "Page does not exist."
    End If
End Function
RegisterUserFunc "Page", "verifyExistence", "verifyExistence" 
```

这适用于 Page 对象，但我如何“泛化”它以便它可以与任何对象类型一起使用？我意识到我需要为每个对象类型添加一个 RegisterUserFunc 行。

理想情况下，我会有一条如下所示的行：

```
typename = getType(test_object)
if typeName = "Page" Then
    objName = test_object.GetROProperty("title")
    ... 'and so on.
end if 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T07:36:25.223

尝试使用`test_object.GetTOProperty("micclass")`测试对象的名称。某些动态对象（例如从 中返回的对象`ChildObjects`）可能没有在 QTP 端设置此属性，在这种情况下您应该这样做`test_object.GetROProperty("micclass")`。

**RO**方法应该始终有效，但它比**TO方法要慢一些，而 TO 方法***几乎*应该始终有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T23:01:54.803

TypeName() 函数应该（几乎）返回对象的类型名称，例如 RegExp 的“IRegExp2”。

# java - 基于对象属性的对象数组的子集/索引

> ID：16047010
> 
> 赞同：1
> 
> 时间：2013-04-16T21:01:55.493
> 
> 标签：java, arrays, collections

假设我有一组对象，例如下面的 dummies[]。我想找到它们的属性等的数组对象的`a == 5`索引`a > 3`。

```
class Dummy{
  int a;
  int b;
  public Dummy(int a,int b){
    this.a=a;
    this.b=b;
  }
}
public class CollectionTest {
  public static void main(String[] args) {
       //Create a list of objects
      Dummy[] dummies=new Dummy[10];
      for(int i=0;i<10;i++){
          dummies[i]=new Dummy(i,i*i);
      }

      //Get the index of array where a==5
      //??????????????????????????????? -- WHAT'S BEST to go in here? 
  }
} 
```

除了迭代数组对象并检查条件之外，还有其他方法吗？在这里使用`ArrayList`或其他类型的`Collection`帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T21:06:53.997

```
// Example looking for a==5
// index will be -1 if not found
int index = -1;
for( int i=0; i<dummies.length; i++ ) {
   if( dummies[i].a == 5 ) {
      index = i;
      break;
   }
} 
```

# parsing - 使用子方法解析日期

> ID：16047012
> 
> 赞同：2
> 
> 时间：2013-04-16T21:02:01.400
> 
> 标签：parsing, time, go

我知道时间包以及如何根据日期/时间表示解析模板。我想知道的是如何在 stdLongMonth 前一个月解析 time.Now()。

IE

```
time.Now() // == April, 2013
// Output: March, 2013 
```

换句话说，是否可以使用 sub.stdLongMonth() 方法解析 time.now() ？任何人都可以足够友善并展示一些例子吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T21:27:13.457

例如，

```
package main

import (
    "fmt"
    "time"
)

func main() {
    y, m, _ := time.Now().Date()
    t := time.Date(y, m, 1, 0, 0, 0, 0, time.UTC)
    fmt.Println(t.Format("January, 2006"))
    t = time.Date(y, m-1, 1, 0, 0, 0, 0, time.UTC)
    fmt.Println(t.Format("January, 2006"))
} 
```

输出：

```
April, 2013
March, 2013 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-17T02:54:31.857

使用 time.AddDate() 因为这也将使您摆脱时区的考虑：

```
package main

import (
    "fmt"
    "time"
)

func main() {
    time := time.Now().AddDate(0,-1,0)
    fmt.Println(time.Format("January, 2006"))

} 
```

# javascript - 如何使用 Highchart 在双轴图表上获取 x 轴标志？

> ID：16047015
> 
> 赞同：0
> 
> 时间：2013-04-16T21:02:03.117
> 
> 标签：javascript, highcharts

如何在具有双轴的 Highchart 上放置标志？

我已经尝试了很多东西，但我无法让它渲染......

标志：[http ://www.highcharts.com/stock/demo/flags-placement](http://www.highcharts.com/stock/demo/flags-placement)

双轴：[http ://www.highcharts.com/demo/combo-dual-axes](http://www.highcharts.com/demo/combo-dual-axes)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T08:34:12.360

Yes it is possible [http://jsfiddle.net/MGzjk/](http://jsfiddle.net/MGzjk/)

```
 {
            type: 'flags',
            name: 'Flags on axis',
            data: [{
                x: Date.UTC(2011, 2, 1),
                title: 'On axis'
            }, {
                x: Date.UTC(2011, 3, 1),
                title: 'On axis'
            }],
            shape: 'squarepin'
        } 
```

# c# - 在 asp.net mvc 应用程序上打印内部版本号

> ID：16047017
> 
> 赞同：1
> 
> 时间：2013-04-16T21:02:05.103
> 
> 标签：c#, asp.net-mvc, tfs, msbuild, tfsbuild

我有一个 asp.net mvc 4 应用程序，它在标题中打印程序集号。我已将持续集成和部署设置为 azure。我已将内部版本号设置为：$(Date:yyyyMMdd)$(Rev:.r)

我也想在应用程序中打印该号码。现在我正在打印装配号：

```
@typeof(FullStackSampleApplication.MvcApplication).Assembly.GetName().Version 
```

![在此处输入图像描述](https://i.stack.imgur.com/QZkJs.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T10:03:01.497

要回答这个问题 - mvc 应用程序不了解来自构建的信息，因此您无权访问来自 mvc 应用程序的内部版本号值。您必须将此值从 build 传递到 version.txt 文件或烘焙到 AssemblyInfo.cs（例如 AssemblyInformationalVersion 属性）或您的应用程序稍后可以检索该值的任何其他位置（配置文件、数据库等）。

# linux - git: 'pull' 不是 git 命令 - CentOS VPS 服务器

> ID：16047025
> 
> 赞同：1
> 
> 时间：2013-04-16T21:02:29.290
> 
> 标签：linux, git, centos, vps

我最近设置了一个新的 VPS，并通过 yum 和 wget 等安装了 Git。一切似乎都很好——我可以添加、提交、设置远程并推送到 github。

但是，当我尝试从 github 中提取时：

```
user@domain.com [~]# git pull github master
git: 'pull' is not a git command. See 'git --help'.

Did you mean this?
    shell 
```

不，我不是说壳，我是说拉！

现在我用谷歌搜索了这件事——包括阅读 Stackoverflow 上的几篇文章：

[“git pull”坏了](https://stackoverflow.com/questions/1465398/git-pull-broken)

[git: 'pull' 不是 git 命令。见'git --help'](https://stackoverflow.com/questions/13473145/git-pull-is-not-a-git-command-see-git-help)

尽管大多数帖子似乎都是关于 Mac 问题（我在 CentOS 服务器上），但这似乎是 git exec 路径的问题，即

```
user@domain.com [~]# git --exec-path
/usr/local/libexec/git-core 
```

我尝试向 .bashrc 添加各种东西但没有成功。

关键是当我 cd 到 /usr/local/ 和 ls -l 时，我看不到 libexec 目录。

但是如果我以 root 身份登录，我可以 cd 到 /usr/local/ 并查看 libexec/，其中是 git-core。我也可以以 root 身份 git pull。

所以 - 我怀疑问题更多地与权限和服务器设置有关，而不是 git 本身。

我试过了

```
sudo chmod a+rx /usr/local/libexec 
```

但这也没有……

当我 ssh 到另一台服务器时，作为帐户用户，我可以 cd 到 /usr/local 并查看 libexec - 所以这个服务器设置有问题。

任何想法都非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-29T09:26:53.503

Solved it now - the server is using jailshell... Disabling jailshell and using 'normal' shell works a treat

# php - 更新 mySql 表中的某些列？

> ID：16047031
> 
> 赞同：1
> 
> 时间：2013-04-16T21:02:56.463
> 
> 标签：php, android, mysql

你好，我是 PHP 和 Mysql 的新手——我正在开发一个 android 应用程序，它将从服务器 mysql db 表中检索一些用户数据——数据，如用户名、名字、姓氏、地址等。用户可以选择编辑全部或部分...最后单击更新按钮将数据更新回mysql数据库。

所以问题是 - 我是否应该使用 POST['username']、POST['fname']、.... 等返回所有值（已编辑和未编辑的值） - 然后使用以下数据更新数据库更改和未更改 - 或者我应该只返回已编辑的数据，然后以某种方式更新表中的这些字段（但我不确定如何实现这一点 - 为每种类型的 POST ['fname'] 创建一个带有案例的 SWITCH 语句并用 POST 值更新每一列）

或者您是否知道一些更好的逻辑/模式 - 如果您知道，请粘贴一些带有示例/tuts 的链接？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T21:06:22.570

This works in PHP, although prepared statements are better:

```
$sql = "
UPDATE userData
    SET
";

if(isset($_POST['firstname'])
    $sql .= "`firstname` = '" . $_POST['firstname'] . "'";
if(isset($_POST['lastname'])
    $sql .= "`lastname` = '" . $_POST['lastname'] . "'";
// You get the picture

$sql .= "
WHERE userid = $id"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T21:48:57.060

您应该发送一个标志来指示已编辑的字段，并根据标志编写您的更新语句，例如，如果用户名和 fname 已更改，则发送一个标志 USERNAME_FNAME_CHANGED，然后预期从您的设备发送 2 个字段用户名和 fname。然后在服务器中执行一个switch语句来相应地编写更新语句。

# hardware - 如何通过 ipmitool 将条目写入系统事件日志 (SEL)？

> ID：16047034
> 
> 赞同：1
> 
> 时间：2013-04-16T21:03:02.620
> 
> 标签：hardware, ipmi, ipmitool

我在 ipmitool 中看到 sel 菜单中有一个“添加”命令。它想要一个文件，但它期望该文件的格式是什么？

```
> ipmitool sel add file.txt
> Invalid Event: 0000f8b601000000 
```

来自文档： http: [//man.he.net/man1/ipmitool](http://man.he.net/man1/ipmitool)

> 添加
> 
> ```
>  Read  event  entries from a file and add them to the SEL.
>                  New SEL entries area added onto the SEL  after  the  last
>                  record  in  the  SEL.   Record  added is of type 2 and is
>                  automatically timestamped. 
> ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-16T01:16:05.097

该文件的格式与输出相同，`ipmitool sel save {filename}`如下所示：

```
0x04 0x10 0x07 0x6f 0x02 0xff 0xff # Event Logging Disabled #0x07 Log area reset/cleared
0x04 0x12 0x83 0x6f 0x05 0x00 0xff # System Event #0x83 Timestamp Clock Sync
0x04 0x12 0x83 0x6f 0x05 0x80 0xff # System Event #0x83 Timestamp Clock Sync
0x04 0x09 0x01 0x6f 0x00 0xff 0xff # Power Unit #0x01 Power off/down
0x04 0x09 0x01 0xef 0x00 0xff 0xff # Power Unit #0x01 Power off/down
0x04 0x14 0x09 0x6f 0x00 0xff 0xff # Button #0x09 Power Button pressed 
```

将此加载到 SEL 中将记录具有当前日期/时间的事件。

比较 with 的输出`ipmitool sel save {filename}`以`ipimitool sel writeraw {filename}`确定上面的字节映射。

# php - pdo 语句中的 NOW() 问题

> ID：16047036
> 
> 赞同：-1
> 
> 时间：2013-04-16T21:03:07.610
> 
> 标签：php, pdo

我正在尝试根据日期（ymd）在数据库中设置员工的状态。如果是两周前，他们设置了 1 周的时间做某事，那么状态应该会改变。我是这样做的：

```
$newsql = "update csvdata set status =:newstatus where statuschangedate < NOW() - INTERVAL :atf DAY AND username =:mem";
                $newgetcsvuser = $DBH->prepare($newsql);
                $newgetcsvuser->execute(array(':newstatus' => $newStatus, ':atf' => $memATF, ':mem' => $csvusername)); 
```

由于某种原因，当我运行它时它不起作用。困惑为什么不呢？

编辑：

所以如果我`echo "working";`在最后添加，我的页面上会说错误，内部错误。

编辑：

这是整个事情......

```
$date = date("Y-m-d"); 
$newStatus = "Non-Active - Driver Chose Non-Compliance";

    $sql = "SELECT username,ATF FROM members";
    $getcsvuser = $DBH->prepare($sql);
    $getcsvuser->execute();
    while($row = $getcsvuser->fetch(PDO::FETCH_ASSOC)){

        $memusername = $row['username'];
        $memATF = $row['ATF'];

        if ($memATF != 0 || $memATF != "0")
        {

        $tsql = "SELECT username,status,memberview ,statuschangedate,customernotes FROM csvdata WHERE memberview =:user";
        $tgetcsvuser = $DBH->prepare($tsql);
        $tgetcsvuser->execute(array(':user' => $memusername));
        while($trow = $tgetcsvuser->fetch(PDO::FETCH_ASSOC)){

            $csvstatus = $trow['status'];
            $csvusername = $trow['username'];
            $csvdate = $trow['statuschangedate'];
            if($csvstatus == "Open" || $csvstatus == "Enrolled - Policyholder Follow-Up Required" || $csvstatus == "Enrolled - Employee Follow-Up Required" || $csvstatus == "Non-Active - Insurance Cancelled" || $csvstatus == "Non-Active, Unable to Monitor - Incidental Business use Exclusion" || $csvstatus == "Non-Active - Employee Not Covered Under Listed Policy" || $csvstatus == "Non-Active - PolicyHolder Cancelled Additional Interest")
            {
                $notes = $trow['customernotes'];
                $notes = $csvstatus . " - ATF. " . $notes;

                $tsql="UPDATE csvdata SET customernotes=:notes =:date WHERE username=:tusername";
                $tsth=$DBH->prepare($tsql);
                $tsth->execute(array(':notes' => $notes,':tusername' => $csvusername));

                $newsql = "update csvdata set status =:newstatus where username =:mem and statuschangedate < DATE_SUB(NOW(), INTERVAL :atf DAYS)";
                //$newsql = sprintf('update csvdata set status =:newstatus where statuschangedate < NOW() - INTERVAL %d DAY AND username =:mem', $memATF);
                $newgetcsvuser = $DBH->prepare($newsql);
                $newgetcsvuser->execute(array(':newstatus' => $newStatus, ':atf' => $memATF, ':mem' => $csvusername));
                echo "working";
                $ynewsql = "update csvdata set statuschangedate =:date where username =:mem";
                $ynewgetcsvuser = $DBH->prepare($ynewsql);
                $ynewgetcsvuser->execute(array(':date' => $date, ':mem' => $csvusername));

            }

        }
        }

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T21:07:26.560

如果我没记错的话，你不能在 PDO 中使用 INTERVAL .. DAY 的参数（不过我可能记错了）。

如果是这样，您将不得不使用`intval()`或其他任何方式对其进行清理，并将其包含在原始 SQL 中。

`sprintf('%d')`例如，使用强制`$memATF`整数进行消毒：

```
$newsql = sprintf('update csvdata set status =:newstatus where statuschangedate < NOW() - INTERVAL %d DAY AND username =:mem', $memATF); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T21:13:55.233

**尝试这个：**

```
$newsql = "update csvdata set status =:newstatus where username =:mem and statuschangedate < DATE_SUB(NOW(), INTERVAL :atf DAYS)"; 
```

我会更改这一行：（因为这可能意味着 $memATF 可能是 NULL 或字符串）

```
if ($memATF != 0 || $memATF != "0") 
```

至：

```
$memATF = intval($memATF);
if ($memATF >0) 
```

这将确保 $memATF 必须是一个整数，如果整数大于 zeo，代码将继续运行。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-16T21:39:46.747

嘿伙计们，我修好了它是因为：`$tsql="UPDATE csvdata SET customernotes=:notes =:date WHERE username=:tusername";`请注意，`...:notes =:date....`所以我刚刚取出了`=:date`它，它现在可以正常工作了 :)

# jquery - jQuery 通过单击父 div 选择复选框

> ID：16047037
> 
> 赞同：1
> 
> 时间：2013-04-16T21:03:07.827
> 
> 标签：jquery, checkbox, toggle

这是我想要发生的事情：当我单击`imageContainer`div 中的复选框时，该复选框应显示为选中状态。我还添加了一些类来更改选定框的背景颜色和标签颜色。这部分正在工作。

我可以单击`imageContainer`div 并选中该 div 内的复选框。但是当我直接单击复选框时，它不会在框中显示复选标记。我试过了`preventDefault`，`return false`但`stopPropagation`没有运气。

```
 <div class="imageContainer" id="question-container-7571">
        <img src="/rfs/servicerequest/taskImages/flooring_kitchen.jpg" alt="Flooring">
        <div class="l-top-space">
           <label for="id_7571_11491">Flooring</label>
           <div class="l-right"><input id="id_7571_11491" type="checkbox" name="7571" value="11491"></div>
           <input id="id_7571_11492" type="hidden" name="7571" value="11492">
        </div>
     </div> 
```

这是我正在使用的 jQuery：

```
 jQuery('.imageContainer').toggle(
     function(e) {
        var imgCont = jQuery(this);
        imgCont.find('input').prop('checked', true);
        imgCont.addClass('ic-checked');
        imgCont.find('label').addClass('ic-selected');
     },
     function(e) {
        var imgCont = jQuery(this);
        imgCont.find('input').prop('checked', false);
        imgCont.removeClass('ic-checked');
        imgCont.find('label').removeClass('ic-selected');
     }
  ); 
```

关于我所缺少的任何帮助或提示都会很棒！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T21:55:53.727

这是因为，您的点击会从复选框传播到容器，因此复选框将立即取消选中并重新选中。您可以添加以下绑定来防止这种情况：

```
jQuery('input:checkbox', '.imageContainer').click(function(e){
    e.stopPropagation();
}); 
```

但它不会触发容器中的 css 更改，因此我会将您的代码更改为：

```
function handleCheckbox(imgCont, checkbox, toggle) {
      var checked = checkbox.prop("checked");
      if (toggle)
      {
        checkbox.prop("checked", !checked);
        checked = !checked;
      }
      if (checked)
      {
        imgCont.addClass('ic-checked');
        imgCont.find('label').addClass('ic-selected');
      }
      else
      {
        imgCont.removeClass('ic-checked');
        imgCont.find('label').removeClass('ic-selected');
      }
}
jQuery('.imageContainer').click(function(e){
   var eventInitiator = jQuery(e.target);
   if (eventInitiator.is(":checkbox") || eventInitiator.is("label"))
      return;
   var imgCont = jQuery(this);
   handleCheckbox(imgCont, imgCont.find('input:checkbox'), true);
});
jQuery('input:checkbox', '.imageContainer').change(function(e){
   var checkbox = jQuery(this);
   handleCheckbox(checkbox.closest(".imageContainer"), checkbox, false);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-06T17:09:15.840

对不起，我花了这么长时间才回来。这是我最终得到的代码，它可以按我的需要工作。单击周围的 div、标签或复选框，然后选中复选框并更改周围 div 的背景。

```
jQuery('.imageContainer input:checkbox,.imageContainer label').bind("click",function(e) {
      e.stopPropagation();
   });
   jQuery("div.imageContainer input:checkbox").bind("click",function(){
      var imageContainerDiv = jQuery(this).closest("div.imageContainer");
      var imageContainerInput = jQuery(this);
      var triggerEl="";
      imageContainer(imageContainerDiv,triggerEl);
   });
   jQuery("div.imageContainer").bind("click",function(){
      var imageContainerDiv = jQuery(this);
      var triggerEl=imageContainerDiv;
      imageContainer(imageContainerDiv,triggerEl);
   });
   function imageContainer(imageContainerDiv,triggerElement){
      var imageContainer=jQuery(imageContainerDiv).children("input:checkbox");
      var imageCheckbox = jQuery(imageContainerDiv).find("input");
      if(triggerElement==imageContainerDiv){
         imageCheckbox.prop("checked", !imageCheckbox.prop("checked"));
      }
      jQuery(imageContainerDiv).toggleClass("ic-checked");
      jQuery(imageContainerDiv).find("label").toggleClass("ic-selected");
   }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T22:14:53.923

试试这个 jQuery 重写（如果在页面加载时可能会检查某些复选框，则只需要第一行）：

工作[小提琴](http://jsfiddle.net/SteevenSpangsdorf/dTAgf/)。

```
/*On page run*/
jQuery('.imageContainer input:checked').addClass("ic-checked");

/*On click*/
jQuery('.imageContainer').click(function(){

  var imgCont = jQuery(this);

  if(imgCont.is('.ic-checked')) {
    imgCont.find('input').prop('checked', false);
    imgCont.removeClass('ic-checked');
    imgCont.find('label').removeClass('ic-selected');

  } else {

    imgCont.find('input').prop('checked', true);
    imgCont.addClass('ic-checked');
    imgCont.find('label').addClass('ic-selected');

  }

}); 
```

`toogle`我没有使用这里似乎有点误用的 using ，而是简单地添加了一个单击事件处理程序。

这里最重要的一点是我不检查复选框是否被选中。这样做，会出现同样的问题（因为当您单击复选框时，它被选中，然后 jQuery 运行并发现它被选中，因此再次取消选中它）。相反，我检查是否存在您添加的类，您仅在 onCheck 时添加。

由于您已经在代码中执行了此 addClass，因此可以重用它并且不再添加其他类。

# javascript - Windows 8 Javascript 异步编程

> ID：16047045
> 
> 赞同：1
> 
> 时间：2013-04-16T21:03:43.670
> 
> 标签：javascript, windows, function, asynchronous

我想遍历一个列表并重命名 Windows 8 / Javascript 中的一些文件。因此，我编写了一个名为“renameFile”的函数，并在循环中调用该函数，如下所示：

```
 list.forEach(function (value, index, array) {
        var filename = index;
        var newfilename = index+1;
        renameFile(filename, newfilename);
    });

    function renameFile(filename, newfilename) {
    Windows.Storage.ApplicationData.current.localFolder.getFileAsync(filename).then(function (sampleFile) {
        sampleFile.renameAsync(newfilename).done(
            function complete(result) {
            },
            function error(error) {
                console.log("error" + error);
            }
            );
    });
} 
```

问题是：重命名函数是异步的，似乎有时重命名有效，有时无效：在大多数情况下，只有列表的第一个元素被重命名。我怎样才能告诉循环等待，直到列表中第一项的重命名过程完成，然后与第二个，第三个，......项目一起去？

干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T21:36:22.630

好吧，我进行了快速查找，但您不走运。似乎 StorageFolder 类仅具有您要查找的内容的 Asyn 函数。但这不是结束。

我必须做的最简单的解决方案是使用递归函数。并使用不同的索引调用函数。

```
function renameFile(filename, newfilename, list, index) {

    Windows.Storage.ApplicationData.current.localFolder.getFileAsync(filename).then(function (sampleFile) {
    sampleFile.renameAsync(newfilename).done(
        function complete(result) {
             renameList(list, index);
        },
        function error(error) {
            console.log("error" + error);
        }
    );
});

function renameList(list, index) {
    if(index >= list.length) return;
    renameFile(index, index+1, list, index+1);
}

renameList(list, 0); 
```

它不是很干净，但应该可以工作，这将强制代码同步，因为您是从回调中调用的。

# photoshop - Photoshop：网络颜色配置文件？

> ID：16047047
> 
> 赞同：1
> 
> 时间：2013-04-16T21:03:47.920
> 
> 标签：photoshop, color-profile

**颜色设置 --> 工作空间**

[可用性帖子](http://www.usabilitypost.com/2008/07/30/photoshop-color-profiles-for-web-images/)告诉我们

> 在“工作空间”部分并选择 sRGB IEC61966-2.1 配置文件

[粉碎杂志](http://www.smashingmagazine.com/2009/10/12/setting-up-photoshop-for-web-app-and-iphone-development/)告诉我们

> 将 RGB 的工作空间设置为 Monitor RGB。

[http://viget.com/](http://viget.com/inspire/the-mysterious-save-for-web-color-shift)也推荐

> 将顶部下拉菜单更改为监视器颜色。

我们应该使用什么？

**问题的第二部分：为网络保存：** 我们是否应该始终取消选中“转换为 sRGB”？关于这一点也有相互矛盾的教程。

非常感谢您！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-21T19:33:40.653

Web 图像应在不添加任何数据的情况下保存。没有颜色配置文件。许多浏览器读取他们想要的颜色配置文件。
sRGB IEC61966-2.1 或 Monitor RGB 在颜色设置中是相同的配置文件。您不需要检查转换为 rgb。尝试检查，但如果您已经使用 sRGB 颜色，您将看不到任何变化。

# javascript - jQuery Validation 验证错误的字段

> ID：16047049
> 
> 赞同：2
> 
> 时间：2013-04-16T21:03:48.653
> 
> 标签：javascript, jquery, validation

我无法让[jquery.validate.js](http://docs.jquery.com/Plugins/Validation)在一些字段上正常工作。这是代码：

```
$("#input_home_area").rules("add", {
    digits: true,
    maxlength: 3,
    minlength: 3
});

$("#input_home_prefix").rules("add", {
    digits: true,
    maxlength: 3,
    minlength: 3
});

$("#input_home_suffix").rules("add", {
    digits: true,
    maxlength: 4,
    minlength: 4
}); 
```

HTML：

```
<li id='' class='gfield sixth required'>
    <label class='gfield_label' for=''>Home Phone Area Code (ex: 954)</label>
    <div class='ginput_container'>
        <input name='' id='input_home_area' type='text' value='' class='medium' tabindex='6' placeholder="(ex: 954)" />
    </div>
</li>

<li id='' class='gfield sixth required'>
    <label class='gfield_label' for=''>Home Phone Prefix (ex: 555)</label>
    <div class='ginput_container'>
        <input name='' id='input_home_prefix' type='text' value='' class='medium' tabindex='6' placeholder="(ex: 555)" />
    </div>
</li>

<li id='' class='gfield sixth required'>
    <label class='gfield_label' for=''>Home Phone Suffix (ex: 1236)</label>
    <div class='ginput_container'>
        <input name='' id='input_home_suffix' type='text' value='' class='medium' tabindex='6' placeholder="(ex: 1236)" />
    </div>
</li> 
```

这个问题很难解释，但我会尽力而为。当我包含验证的脚本时`#input_home_suffix`，两者都`#input_home_area`得到`#input_home_prefix`验证，就好像它们在哪里一样`#input_home_suffix`。因此，即使我同时设置`#input_home_area`并`#input_home_prefix`要求输入 3 位数字，它们也会得到验证，就好像必须输入 4 位一样。即使我注释掉验证`#input_home_area`和的脚本位`#input_home_prefix`，它们仍然会得到验证，就好像它们实际上是`#input_home_suffix`

我完全不知道发生了什么。页面上的所有其他字段都经过完美验证，只是这些字段存在问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T21:14:16.750

使用验证插件时，您必须通过`name`属性调用输入，而不是它们的`id`.

# python - 如何使用 Django 进行有效的地理定位？

> ID：16047051
> 
> 赞同：6
> 
> 时间：2013-04-16T21:03:54.750
> 
> 标签：python, iphone, django, geolocation

我想做以下事情。

我想创建一个执行以下操作的应用程序

*   餐厅填写他们所在的地址。
*   人 A 打开应用程序，查看每家餐厅距离他/她当前位置的距离（按最近的位置排序）。

我怎样才能以最有效的方式做到这一点？

如果餐厅给了我他们的地址，我是否应该将该地址转换为经度/纬度点，然后以某种方式使用它来获取与人 A 当前位置的距离？但是我如何有效地做到这一点，以便如果数据库中有 1000 个地址，我可以有效地对所有这些地址进行排序 - 首先最接近人 A - 而不会花费太多时间？谢谢！

我正在使用 django。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T23:06:22.017

看看[GeoDjango](http://geodjango.org/)和[PostGIS](https://docs.djangoproject.com/en/dev/ref/contrib/gis/install/)。

GeoDjango 将使您能够存储地理信息和进行[距离查找](https://docs.djangoproject.com/en/dev/ref/contrib/gis/db-api/#distance-lookups)。

您还可以使用[OSMGeoAdmin](https://docs.djangoproject.com/en/dev/ref/contrib/gis/tutorial/#osmgeoadmin)或[django-location-field](https://github.com/codasus/django-location-field)来帮助您轻松填写位置字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T22:13:31.120

您可以简单地使用[Cloudmade 的地理编码 API](http://developers.cloudmade.com/projects/show/geocoding-http-api)从提供的地址定位餐厅。

然后您使用[Cloudmade 的 Routing API](http://developers.cloudmade.com/projects/show/routing-http-api)来查找距离。

# python - 使用多处理时输出不正确

> ID：16047052
> 
> 赞同：0
> 
> 时间：2013-04-16T21:03:58.640
> 
> 标签：python, python-2.7, numpy, parallel-processing, multiprocessing

我正在做梯度下降（准确地说是 100 次迭代）。每个数据点可以并行分析，有50个数据点。由于我有 4 个内核，因此我使用`multiprocessing.Pool`. 该程序的核心如下所示：

```
# Read the sgf files (total 50)
(intermediateBoards, finalizedBoards) = read_sgf_files()

# Create a pool of processes to analyze game boards in parallel with as 
# many processes as number of cores
pool =  Pool(processes=cpu_count())

# Initialize the parameter object
param = Param()

# maxItr = 100 iterations of gradient descent
for itr in range(maxItr):
    args = []
    # Prepare argument vector for each file
    for i in range(len(intermediateBoards)):
        args.append((intermediateBoards[i], finalizedBoards[i], param))
    # 4 processes analyze 50 data points in parallel in each iteration of 
    # gradient descent
    result = pool.map_async(train_go_crf_mcmc, args) 
```

现在，我没有包含函数的定义`train_go_crf`，但函数的第一行是打印语句。所以，当我执行这个函数时，打印语句应该被执行 100*50 次。但这不会发生。更重要的是，我得到不同数量的控制台输出不同的次数。

怎么了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T21:25:35.770

您的问题是您使用`map_async`的是`map`. 这意味着一旦所有工作都被外包到池中，它将继续循环，即使所有工作尚未完成。我不清楚下一个循环开始时仍在运行的工作会发生什么，但如果这些应该是迭代，我无法想象它a）很好 b）定义明确。

如果您使用`map`，它将阻塞循环，直到*所有*工作函数都完成，然后再继续下一步。我想你可以用 来做到这一点`sleep`，但这只会让事情变得更加复杂而无济于事。 `map`将等待让一切完成*所需*的最短时间。

# php - SplPriorityQueue 在临界情况下的意外行为

> ID：16047055
> 
> 赞同：1
> 
> 时间：2013-04-16T21:04:07.330
> 
> 标签：php, spl

这个问题与我前段时间问的[这个问题有关。](https://stackoverflow.com/questions/15851726/how-splpriorityqueue-works-when-priority-is-not-an-integer)

基本上它是关于在某些*临界*情况下出队如何工作的。例如：

```
$queue = new SplPriorityQueue();

$queue->insert('foo', 0);
$queue->insert('bar', 0);
$queue->insert('baz', '0'); 
```

我期待完全相同的顺序`foo` `bar` `baz`：

```
while ($queue->valid()) {
    var_dump($queue->current());
    $queue->next();
} 
```

原来是`foo` `baz` `bar`。你能解释一下为什么*先去*`baz`吗？ *`bar`*

 ** * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T21:13:02.883

由于 foo、bar 和 baz 都具有相同的优先级，它们的顺序是未定义的，因此它们可以以任何顺序出现。请参阅此处的注释[http://www.php.net/manual/en/splpriorityqueue.compare.php](http://www.php.net/manual/en/splpriorityqueue.compare.php)

> 笔记：
> 
> 具有相同优先级的多个元素将不按特定顺序出队。

以及同一页面上的顶级用户注释以获取建议的解决方案[http://www.php.net/manual/en/splpriorityqueue.compare.php#93999](http://www.php.net/manual/en/splpriorityqueue.compare.php#93999)

[Matthew Weier O'Phinney 的博客](http://www.mwop.net/blog/253-Taming-SplPriorityQueue.html)上还有一篇博文，您可能会发现它很有用。*

# d3.js - d3 color models v. philips hue

> ID：16047065
> 
> 赞同：0
> 
> 时间：2013-04-16T21:05:01.817
> 
> 标签：d3.js

the philips hue bulb supports three different color models (temperature in mireds, hue/saturation, and cie1931).

since cie1931 is the 'native' model used by the bulb, most of the time that's the model reported by the bulb.

my naive thinking was to use d3.lab(1, cie1931.x, cie1931.y).rgb(), but this isn't right (all the colors come out very close to black).

could a color model guru point me in the direction of mapping cie1931[x,y] to one of the models supported by d3 ?

thanks!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T08:55:48.110

适用于 iOS 的 Philips Hue SDK 有一个[应用说明](https://github.com/PhilipsHue/PhilipsHueSDKiOS/blob/master/ApplicationDesignNotes/RGB%20to%20xy%20Color%20conversion.md)，它解释了如何将 XY 值转换为 RGB。也许您可以根据自己的需要采用它。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-17T02:56:00.137

```
d3.cie1931 = {
// https://gist.github.com/AaronH/30c50aa4b161f8169c3d

  rgb : function(x, y) {
    var r, g, b, z;

    z = 1 - (x + y);

/*
   |R|   | X |   | 3.2333         -1.5262         0.2791 |
   |G| = | Y | * |-0.8268          2.4667         0.3323 |
   |B|   | Z |   | 0.1294          0.1983         2.0280 |
 */
    r =      (x *  3.2333) + (y * -1.5262) + (z * 0.2791);
    g =      (x * -0.8268) + (y *  2.4667) + (z * 0.3323);
    b =      (x *  0.1294) + (y *  0.1983) + (z * 2.0280);
    return d3.rgb (Math.max(0, Math.min(255, r * 255)),
                   Math.max(0, Math.min(255, g * 255)),
                   Math.max(0, Math.min(255, b * 255)));
  }
}; 
```

# ios - Google AdMobs 自定义点击事件不适用于不受支持的网络

> ID：16047066
> 
> 赞同：1
> 
> 时间：2013-04-16T21:05:06.707
> 
> 标签：ios, objective-c, admob, google-dfp, custom-events

我正在使用 Google AdMobs DFP 提供来自其他网络的中介横幅。我已经很好地添加了 Millennial 和 InMobi，但现在我需要添加一个没有 DFP 适配器的网络（YOC 组），因此我需要实现“自定义事件横幅”。我已阅读有关使用自定义事件实现不受支持的中介网络的指南和技术文档，但仍然无法理解它如何连接两个 SDK（Google AdMobs SDK 和中介网络的 SDK）。

如果我将 yoc 广告 ID（格式为“9A9A9AA99999999A999AA9A99AA99AAAA999A9AA”）硬编码到示例广告并发送请求，则没有适配器 (YOC) 的网络可以正常工作。横幅恢复正常并使用 YOC SDK 显示交互式/富媒体广告。

但是，在我的应用程序中，我只有一个 Google DFP 帐户 ID（格式为“/9999/company.app/channel”），我向 DFP 发送了使用 Google AdMobs SDK 的请求。然后，该请求返回一个带有特定中介广告网络的响应，以尝试从中请求横幅广告。我目前的设置是 YOC 在 DFP 中投放 100% 的广告。

**问题：**我收到从 YOC 广告网络返回的横幅广告，它显示在屏幕上。它注册页面展示次数（使用 DFP），但没有响应触摸/按下事件的工作方式，就像我硬编码 yoc 广告视图的初始化参数一样。但是，我无法硬编码 yoc 广告 ID（在初始化时），因为它仅适用于一个横幅广告，并且我需要为每个频道中的每个特定广告使用不同的横幅。

下面是我试图在登录到控制台并显示正在调用方法的方法中仅使用 NSLogs 来实现的示例代码。这是一个非常基本的应用程序，将所有代码放在一个地方以便于阅读。

AppDelegate.h

```
#import < UIKit/UIKit.h>
#import "GADBannerView.h"
#import "GADBannerViewDelegate.h"
#import "GADCustomEventBanner.h"
#import "GADCustomEventBannerDelegate.h"
#import < YOCAdSDK/YOCAdView.h>

@interface AppDelegate : UIResponder <UIApplicationDelegate, GADBannerViewDelegate, GADCustomEventBanner, GADCustomEventBannerDelegate, YOCAdViewDelegate>

@property (strong, nonatomic) UIWindow *window;

@property (strong, nonatomic) UIViewController *root;

@end 
```

AppDelegate.m

```
#import "AppDelegate.h"
#import "GADBannerView.h"
#import <YOCAdSDK/YOCAdSize.h>

@implementation AppDelegate

@synthesize root;
@synthesize delegate; // GADCustomEventBannerDelegate set on GADCustomEventBanner

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    CGRect bounds = [[UIScreen mainScreen] bounds];
    self.window = [[UIWindow alloc] initWithFrame:bounds];
    self.window.backgroundColor = [UIColor greenColor];

    GADBannerView *banner = [[GADBannerView alloc] initWithAdSize:kGADAdSizeLeaderboard origin:CGPointMake(0, 0)];
    self.root = [[UIViewController alloc] initWithNibName:nil bundle:nil];
    UIView *base = [[UIView alloc] initWithFrame:bounds];
    base.backgroundColor = [UIColor greenColor];
    self.root.view = base;

    // the adUnitID is always of our DFP account number of the format '/9999/company.app/aa_aa<channelName>_<channelName>app'
    banner.adUnitID = @"/9999/company.app/channel_specific_id";

    banner.delegate = self;
    banner.rootViewController = self.root;

    self.delegate = self;

    [base addSubview:banner];
    [base bringSubviewToFront:banner];
    [banner loadRequest:[GADRequest request]];

    [self.window setRootViewController:self.root];

    [[UIApplication sharedApplication] setStatusBarHidden:YES withAnimation:UIStatusBarAnimationNone];
    [self.window makeKeyAndVisible];
    return YES;
}

#pragma mark GADBannerViewDelegate

- (void)adViewDidReceiveAd:(GADBannerView *)view {
    NSLog(@" adViewDidReceiveAd ");
    NSLog(@" view: %@ ", [view description]);

    // for other ad networks here we get view.mediatedAdView = IMAdView (InMobi) or view.mediatedAdView = MMAdView (Millennial) but with YOC view.mediatedAdView = nil;

    [self.delegate customEventBanner:self didReceiveAd:view];
}

- (void)adView:(GADBannerView *)view didFailToReceiveAdWithError:(GADRequestError *)error {
    NSLog(@" didFailToReceiveAdWithError ");
    [self.delegate customEventBanner:self didFailAd:error];
}

- (void)adViewWillPresentScreen:(GADBannerView *)adView {
    NSLog(@" adViewWillPresentScreen ");
    [self.delegate customEventBanner:self clickDidOccurInAd:adView];
    [self.delegate customEventBannerWillPresentModal:self];
}

- (void)adViewWillDismissScreen:(GADBannerView *)adView {
    NSLog(@" adViewWillDismissScreen ");
    [self.delegate customEventBannerWillDismissModal:self];
}

- (void)adViewDidDismissScreen:(GADBannerView *)adView {
    NSLog(@" adViewDidDismissScreen ");
    [self.delegate customEventBannerDidDismissModal:self];
}

- (void)adViewWillLeaveApplication:(GADBannerView *)adView {
    NSLog(@" adViewWillLeaveApplication ");
    [self.delegate customEventBannerWillLeaveApplication:self];
}

#pragma mark GADCustomEventBanner

- (void)requestBannerAd:(GADAdSize)adSize
              parameter:(NSString *)serverParameter
                  label:(NSString *)serverLabel
                request:(GADCustomEventRequest *)request {
    NSLog(@" requestBannerAd ");

    // not sure if we initialiase the YOC tag here or how we would do this if can't hard code the yocTag to the format '9A9A9AA99999999A999AA9A99AA99AAAA999A9AA'
    // and we only have the banner view returned from DFP with the id '/9999/company.app/channel_specific_id)'

    YOCAdView *yocAdView = [[YOCAdView alloc] initWithYOCTag:serverParameter delegate:self size:kLeaderboard728x90 position:CGPointMake(0, 0)];
    yocAdView.delegate = self;
    [yocAdView load];

    [self.root.view addSubview:yocAdView];
}

#pragma mark GADCustomEventBannerDelegate

- (void)customEventBanner:(id<GADCustomEventBanner>)customEvent didReceiveAd:(UIView *)view {
    NSLog(@" [(GADBannerView *)view adUnitID]: %@ ", [(GADBannerView *)view adUnitID]);
    NSLog(@" [(GADBannerView *)view delegate]: %@ ", [(GADBannerView *)view delegate]);
    NSLog(@" [(id<YOCAdViewDelegate>)[customEvent delegate] viewControllerForPresentingYOCAdView]: %@ ", [(id<YOCAdViewDelegate>)[customEvent delegate] viewControllerForPresentingYOCAdView]);

    // not sure if we initialiase the YOC tag here or how we would do this if can't hard code the yocTag to '9A9A9AA99999999A999AA9A99AA99AAAA999A9AA"
    // and we only have the banner view returned from DFP with the id '/9999/company.app/channel_specific_id'
    [customEvent requestBannerAd:kGADAdSizeLeaderboard parameter:@"???" label:nil request:nil];

    // the key might be that the [customEvent delegate] is of type YOCAdViewDelegate and we can do code specific to YOC here...
    // but again not sure how to initialize the YOCAdView because we already have the banner view returned from DFP (with a different format account id)
    // [(id<YOCAdViewDelegate>)[customEvent delegate] yocAdViewDidInitialize:yocAdView];
}

- (void)customEventBanner:(id<GADCustomEventBanner>)customEvent didFailAd:(NSError *)error {
    NSLog(@" customEventBanner:didFailAd ");
}

- (void)customEventBanner:(id<GADCustomEventBanner>)customEvent clickDidOccurInAd:(UIView *)view {
    NSLog(@" customEventBanner:clickDidOccurInAd ");
}

- (void)customEventBannerWillPresentModal:(id<GADCustomEventBanner>)customEvent {
    NSLog(@" customEventBannerWillPresentModal ");
}

- (void)customEventBannerWillDismissModal:(id<GADCustomEventBanner>)customEvent {
    NSLog(@" customEventBannerWillDismissModal ");
}

- (void)customEventBannerDidDismissModal:(id<GADCustomEventBanner>)customEvent {
    NSLog(@" customEventBannerDidDismissModal ");
}

- (void)customEventBannerWillLeaveApplication:(id<GADCustomEventBanner>)customEvent {
    NSLog(@" customEventBannerWillLeaveApplication ");
}

#pragma mark YOCAdViewDelegate

- (UIViewController *)viewControllerForPresentingYOCAdView {
    NSLog(@" viewControllerForPresentingYOCAdView ");
    return self.root;
}

- (void)yocAdViewDidInitialize:(YOCAdView *)yocAdView {
    NSLog(@" yocAdViewDidInitialize ");
}

- (void)yocAdView:(YOCAdView *)yocAdView didFailWithError:(NSError *)error {
    NSLog(@" didFailWithError: %@ ", error);
}

- (void)yocAdViewDidHide:(YOCAdView *)yocAdView {
    NSLog(@" yocAdViewDidHide ");
}

- (void)yocAdViewDidReload:(YOCAdView *)yocAdView {
    NSLog(@" yocAdViewDidReload ");
}

- (void)yocAdViewWillPresentModalViewController:(YOCAdView *)yocAdView {
    NSLog(@" yocAdViewWillPresentModalViewController ");
}

- (void)yocAdViewWillDismissModalViewController:(YOCAdView *)yocAdView {
    NSLog(@" yocAdViewWillDismissModalViewController ");
}

@end 
```

请有人可以帮我尝试一下，并了解如何让 Google DFP 返回的广告横幅视图响应点击事件！？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T23:47:32.303

[这里](https://developers.google.com/mobile-ads-sdk/training/mediation/custom-events/banners)有一个关于如何开发自定义事件的指南。

如果您将 AdMob SDK 中介与广告单元一起使用`/9999/company.app/channel`，则此广告单元应`SDK Mediation creative`位于 DFP 内。您的网络之一应`Custom Event`具有以下设置：

```
Parameter: 9A9A9AA99999999A999AA9A99AA99AAAA999A9AA (or whatever your YOC tag is)
Label: YOC Group (This is just a label so you remember what this custom event is for)
Class Name: AppDelegate (You should really implement the custom event in it's own
                         class, and replace the class name with that class) 
```

然后在实现自定义事件时，您可以`serverParameter`像已有的一样引用 YOCTag。

你不想`GADCustomEventBannerDelegate`自己实现。通过您的班级实施`GADCustomEventBanner`并添加：

```
@synthesize delegate 
```

在实现的顶部，您可以通过以下方式访问此对象的实例：

```
self.delegate 
```

您需要使用该委托来告知自定义事件（以及 AdMob 中介）YOC 返回或未能返回广告。根据 YOC 委托，您的映射可能如下所示：

```
- (UIViewController *)viewControllerForPresentingYOCAdView {
  NSLog(@" viewControllerForPresentingYOCAdView ");
  return self.root;
}

- (void)yocAdViewDidInitialize:(YOCAdView *)yocAdView {
  NSLog(@" yocAdViewDidInitialize ");
  // Assuming this means the yocAdView was received.
  [self.delegate customEventBanner:self didReceiveAd:yocAdView];
}

- (void)yocAdView:(YOCAdView *)yocAdView didFailWithError:(NSError *)error {
  NSLog(@" didFailWithError: %@ ", error);
  [self.delegate customEventBanner:self didFailAd:error];
}

- (void)yocAdViewDidHide:(YOCAdView *)yocAdView {
  NSLog(@" yocAdViewDidHide ");
}

- (void)yocAdViewDidReload:(YOCAdView *)yocAdView {
  NSLog(@" yocAdViewDidReload ");
  [self.delegate customEventBanner:self didReceiveAd:yocAdView];
}

- (void)yocAdViewWillPresentModalViewController:(YOCAdView *)yocAdView {
  NSLog(@" yocAdViewWillPresentModalViewController ");
  [self.delegate customEventBanner:self clickDidOccurInAd:yocAdView];
  [self.delegate customEventBannerWillPresentModal:self];
  [self.delegate customEventBannerWillLeaveApplication:self];
}

- (void)yocAdViewWillDismissModalViewController:(YOCAdView *)yocAdView {
  NSLog(@" yocAdViewWillDismissModalViewController ");
  [self.delegate customEventBannerWillDismissModal:self];
} 
```

最后，您不想`GADCustomEventBannerDelegate`在`GADBannerViewDelegate`回调方法中调用方法。这些由 AdMob 调用，告诉您中介返回了广告。该`GADBannerViewDelegate`实现是您的主应用程序的一部分，并且应该远离您的自定义事件类的实现。

`GADBannerViewDelegate`我知道该指南在其实现中调用了自定义事件委托方法。不同之处在于指南正在编写自定义事件来实现 AdMob，因此在指南的上下文中，`GADBannerViewDelegate`它的行为与`YOCAdViewDelegate`您的示例中的一样。

# javascript - Replacing every third comma

> ID：16047069
> 
> 赞同：-2
> 
> 时间：2013-04-16T21:05:20.383
> 
> 标签：javascript, regex

This works to replace every other comma. What do I have to do to replace every third comma?

```
resultContent = resultContent.replace(/(,[^,]*),/g, '$1|'); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T21:07:38.807

```
resultContent = resultContent.replace(/((?:,[^,]*){2}),/g, '$1|'); 
```

# c# - 如何在Selenium Webdriver，C#下测试页面上的元素是否存在

> ID：16047070
> 
> 赞同：1
> 
> 时间：2013-04-16T21:05:21.677
> 
> 标签：c#, selenium-webdriver

我搜索了无数网页，但没有得到很好的答案。我使用 C# 在 Selenium 2.30 上。

我试过了

```
if (browser.FindElement(By.XPath("xpath")).Displayed) 
```

我试过了

```
if (browser.FindElements(By.XPath("xpath")).Count !=0) 
```

并且

```
IWebElement element = browser.FindElement(By.XPath("xpath"));
if (element.Displayed == true) 
```

它们仅在元素存在时起作用，但如果不存在，它将退出异常。但这不是必要的例外，我在 else{} 语句中有一些东西可以处理它，我不希望 webdriver 一开始就阻止我。

我现在正在做的是

```
IWebElement element = null;
try
{
   element = browser.FindElement(By.XPath("xpath"));
}
catch
{

}
if (element != null) 
```

这种方式到目前为止有效，但我认为这不是最好的解决方案。如果有人可以向我展示更好的方法，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T23:07:18.213

您执行此操作的方式是可以接受的，但有时您会在执行先前的操作（例如导航到页面）后尝试运行此操作，并且通常最好提供超时值并使用以下 WebDriverWait 方法：

```
WebDriverWait _wait = new WebDriverWait(_driver, new TimeSpan(0, 0, timeout));
element = _wait.Until(x => x.FindElement(By.XPath(searchAttribute.attributeValue))); 
```

这允许您等到页面上存在元素直到超时值（我在我测试的应用程序上使用 5 秒）。但是，很简单，您可以只使用您的代码，`if(element == null)`然后找不到它。如果您使用 WebDriverWait，如果您不希望它在超时后抛出，则必须捕获该异常。

# xml - XSLT：DB 过程输出到 XML 结构

> ID：16047071
> 
> 赞同：0
> 
> 时间：2013-04-16T21:05:26.913
> 
> 标签：xml, database, xslt, transformation, procedure

我在 XSLT 转换方面遇到了一点问题，我需要你的帮助。我从数据库过程中收到如下数据，我需要将其转换为较少冗余的结构。

输入数据的结构是：一级订单&产品&产品属性。这是一个例子：

```
<root>
    <Order>
        <order_id>1</order_id>
        <order_category>Internet Services</order_category>
        <product_id>14</product_id>
        <product_name>Mobile Internet - standard</product_name>
        <product_amount>1</product_amount>
        <product_price>9.99</product_price>
        <attribute_id>1</attribute_id>
        <attribute_name>Discount</attribute_name>
        <attribute_value>20%</attribute_value>
    </Order>
    <Order>
        <order_id>1</order_id>
        <order_category>Internet Services</order_category>
        <product_id>14</product_id>
        <product_name>Mobile Internet - standard</product_name>
        <product_amount>1</product_amount>
        <product_price>9.99</product_price>
        <attribute_id>4</attribute_id>
        <attribute_name>Additional service</attribute_name>
        <attribute_value>Night free</attribute_value>
    </Order>
    <Order>
        <order_id>1</order_id>
        <order_category>Internet Services</order_category>
        <product_id>17</product_id>
        <product_name>Activation</product_name>
        <product_amount>100</product_amount>
        <product_price>0</product_price>
        <attribute_id>1</attribute_id>
        <attribute_name>Volume</attribute_name>
        <attribute_value>GB</attribute_value>
    </Order>
    <Order>
        <order_id>2</order_id>
        <order_category>Device Services</order_category>
        <product_id>421</product_id>
        <product_name>Modem TS2.3</product_name>
        <product_amount>1</product_amount>
        <product_price>14.99</product_price>
        <attribute_id>4</attribute_id>
        <attribute_name>Model</attribute_name>
        <attribute_value>TS2.3</attribute_value>
    </Order>
    <Order>
        <order_id>2</order_id>
        <order_category>Device Services</order_category>
        <product_id>421</product_id>
        <product_name>Modem TS2.3</product_name>
        <product_amount>1</product_amount>
        <product_price>14.99</product_price>
        <attribute_id>17</attribute_id>
        <attribute_name>SATA</attribute_name>
        <attribute_value>4</attribute_value>
    </Order>
    <Order>
        <order_id>2</order_id>
        <order_category>Device Services</order_category>
        <product_id>16743</product_id>
        <product_name>Printer XLV 14</product_name>
        <product_amount>1</product_amount>
        <product_price>30.99</product_price>
        <attribute_id>4</attribute_id>
        <attribute_name>Duplex</attribute_name>
        <attribute_value>Y</attribute_value>
    </Order>
</root> 
```

上面的数据是多余的，因为只有两个订单（order_id=1 和 order_id=2），这些订单出现了 6 次。同样的问题也发生在产品上。输出的结构应该减少冗余：订单可能有多个产品之一，每个产品可能包含零个或多个属性。下面列出了示例输出：

```
<root>
    <Order>
        <order_id>1</order_id>
        <order_category>Internet Services</order_category>
        <products>
            <product>
                <id>14</id>
                <name>Mobile Internet - standard</name>
                <amount>1</amount>
                <price>9.99</price>
                <attributes>
                    <attribute>
                        <id>1</id>
                        <name>Discount</name>
                        <value>20%</value>
                    </attribute>
                    <attribute>
                        <id>4</id>
                        <name>Additional service</name>
                        <value>Night free</value>
                    </attribute>
                </attributes>
            </product>
            <product>
                <id>17</id>
                <name>Activation</name>
                <amount>100</amount>
                <price>0</price>
                <attributes>
                    <attribute>
                        <id>1</id>
                        <name>Volume</name>
                        <value>GB</value>
                    </attribute>
                </attributes>
            </product>
        </products>
    </Order>
    <Order>
        <order_id>2</order_id>
        <order_category>Device Services</order_category>
        <products>
            <product>
                <id>421</id>
                <name>Modem TS2.3</name>
                <amount>1</amount>
                <price>14.99</price>
                <attributes>
                    <attribute>
                        <id>4</id>
                        <name>Model</name>
                        <value>TS2.3</value>
                    </attribute>
                    <attribute>
                        <id>17</id>
                        <name>SATA</name>
                        <value>4</value>
                    </attribute>
                </attributes>
            </product>
            <product>
                <id>16743</id>
                <name>Printer XLV 14</name>
                <amount>1</amount>
                <price>30.99</price>
                <attributes>
                    <attribute>
                        <id>4</id>
                        <name>Duplex</name>
                        <value>Y</value>
                    </attribute>
                </attributes>
            </product>
        </products>
    </Order>
</root> 
```

问题是正确嵌套数据并删除冗余部分。我可以请你帮忙解决这个相当困难的问题吗？:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T21:41:05.723

您可以通过使用分组来完成此操作：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="xml" indent="yes" omit-xml-declaration="yes"/>
  <xsl:key name="kOrder" match="Order" use="order_id" />
  <xsl:key name="kOrderProd" match="Order" 
           use="concat(order_id, '+', product_id)"/>

  <xsl:template match="@* | node()">
    <xsl:copy>
      <xsl:apply-templates select="@* | node()"/>
    </xsl:copy>
  </xsl:template>

  <xsl:template match="/*">
    <xsl:copy>
      <xsl:apply-templates 
         select="Order[generate-id() = 
                       generate-id(key('kOrder', order_id)[1])]"/>
    </xsl:copy>
  </xsl:template>

  <xsl:template match="Order">
    <xsl:copy>
      <xsl:apply-templates select="order_id | order_category" />
      <products>
        <xsl:apply-templates
          select="key('kOrder', order_id)
                     [generate-id() =
                      generate-id(key('kOrderProd', 
                                      concat(order_id, '+', product_id))[1])]" 
          mode="product" />
      </products>
    </xsl:copy>
  </xsl:template>

  <xsl:template match="Order" mode="product">
    <product>
      <xsl:apply-templates select="*[starts-with(local-name(), 'product_')]" 
                           mode="stripPrefix" />
      <attributes>
        <xsl:apply-templates select="key('kOrderProd', 
                                         concat(order_id, '+', product_id))"
                             mode="attribute"/>
      </attributes>
    </product>
  </xsl:template>

  <xsl:template match="*" mode="stripPrefix">
    <xsl:element name="{substring-after(local-name(), '_')}">
      <xsl:apply-templates select="@* | node()" />
    </xsl:element>
  </xsl:template>

  <xsl:template match="Order" mode="attribute">
    <attribute>
      <xsl:apply-templates select="*[starts-with(local-name(), 'attribute_')]" 
                           mode="stripPrefix" />
    </attribute>
  </xsl:template>
</xsl:stylesheet> 
```

在您的示例输入上运行时，结果是：

```
<root>
  <Order>
    <order_id>1</order_id>
    <order_category>Internet Services</order_category>
    <products>
      <product>
        <id>14</id>
        <name>Mobile Internet - standard</name>
        <amount>1</amount>
        <price>9.99</price>
        <attributes>
          <attribute>
            <id>1</id>
            <name>Discount</name>
            <value>20%</value>
          </attribute>
          <attribute>
            <id>4</id>
            <name>Additional service</name>
            <value>Night free</value>
          </attribute>
        </attributes>
      </product>
      <product>
        <id>17</id>
        <name>Activation</name>
        <amount>100</amount>
        <price>0</price>
        <attributes>
          <attribute>
            <id>1</id>
            <name>Volume</name>
            <value>GB</value>
          </attribute>
        </attributes>
      </product>
    </products>
  </Order>
  <Order>
    <order_id>2</order_id>
    <order_category>Device Services</order_category>
    <products>
      <product>
        <id>421</id>
        <name>Modem TS2.3</name>
        <amount>1</amount>
        <price>14.99</price>
        <attributes>
          <attribute>
            <id>4</id>
            <name>Model</name>
            <value>TS2.3</value>
          </attribute>
          <attribute>
            <id>17</id>
            <name>SATA</name>
            <value>4</value>
          </attribute>
        </attributes>
      </product>
      <product>
        <id>16743</id>
        <name>Printer XLV 14</name>
        <amount>1</amount>
        <price>30.99</price>
        <attributes>
          <attribute>
            <id>4</id>
            <name>Duplex</name>
            <value>Y</value>
          </attribute>
        </attributes>
      </product>
    </products>
  </Order>
</root> 
```

# delphi - 使用 tcp 是否保证它会被发送/接收？

> ID：16047072
> 
> 赞同：1
> 
> 时间：2013-04-16T21:05:32.643
> 
> 标签：delphi, tcp, winsock

我一直在为一个朋友和我做一个简单的winsock文件传输来共享文件，而无需每次都上传到mediafire。但我遇到的一个问题是/曾经是（取决于你如何看待我当前的解决方案）我不能' t 在不损坏文件的情况下发送文件。目前我发送/接收的解决方案是：

```
procedure SenBuf(var buf;count:dword);
var
  a, c: pointer;
  cousend, tmp, left: dword;
begin
  a := @buf;
  cousend := 0;
  left := count;
  repeat
    c := ptr(dword(a) + cousend);
    tmp := Send(hSocket, c^, left, 0);
    inc(cousend, tmp);
    dec(left, tmp);
  until cousend = count;
end;

procedure RecvBuf(var buf;count:dword);
var
  a, c: pointer;
  cousend, tmp, left: dword;
begin
  a := @buf;
  cousend := 0;
  left := count;
  repeat
    c := ptr(dword(a) + cousend);
    tmp := Recv(hSocket, c^, left, 0);
    inc(cousend, tmp);
    dec(left, tmp);
  until cousend = count;
end; 
```

但是我使用的是 tcp 连接，为什么我需要检查正在发送/接收的字节并重新发送它们？（我知道原因是丢包，因为它在本地主机上完美运行）。

它如何监听连接：

```
 hServer := Socket(AF_INET,SOCK_STREAM,6);
 sAddr.sin_family      := AF_INET;
 sAddr.sin_port        := htons(wPort);
 sAddr.sin_addr.S_addr := INADDR_ANY;
 Bind(hServer, sAddr, SizeOf(sAddr));
 winsock.Listen(hServer,3);
 while not(Self.Terminated) do begin
   iSize:=SizeOf(cAddr);
   hClient:=Accept(hServer,@cAddr,@iSize);
   if (hClient <> INVALID_SOCKET) then begin
     sleep(50);
     Client := TClient.Create(True);
     Clients.Add(Client);
     with Client do begin
       hHost := inet_ntoa(cAddr.sin_addr);
       Resume();
     end;
 /// incomplete code? 
```

服务器 - 客户端：

```
 procedure TClient.Execute;
    var
      mode: integer;
      bytBuf: Array[0..255] of Char;
      iRecv: Integer;
    begin
      inherited;
      mode := 0;
      ZeroMemory(@bytbuf, 256);
      ioctlsocket(hSocket, FionBio, mode);
      repeat
        iRecv := Recv(hSocket, bytBuf, 256, 0);
        if (iRecv <= 0) and (iRecv <> EWOULDBLOCK) then 
          break;
        if not(bytbuf[0]=#0) then
          Process(bytBuf);
        ZeroMemory(@bytbuf,256);
      until 1=2; 
```

客户 - 客户：

```
procedure Start;
var
  mode: integer;
begin
  repeat
    mode := 0;//blocking mode.
    hSocket := Socket(AF_INET, SOCK_STREAM, 6);
    ioctlsocket(hSocket, FionBio, mode);
    Addr.sin_family := AF_INET;
    Addr.sin_port := htons(hport);
    Addr.sin_addr.S_addr := INET_ADDR(pchar(GetIPFromHost(cHost)));
    if (winsock.Connect(hSocket,Addr, SizeOf(Addr)) = 0) then begin
      SenStr('+');
      WaitForServAndProcess;
    end;
  Sleep(20000);
  lping:=GetTickCount;
  until 1 = 2;
end; 
```

有人会告诉我我的错误吗？或者给我一个非常好的winsock教程？（不必被勺子喂）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T02:31:38.840

您正在破坏您的文件数据，因为您在调用 WinSock`send()`和`recv()`函数时没有进行任何错误检查，例如：

```
procedure SenBuf(var buf; count:dword);
var
  a: PByte;
  tmp: Integer;
begin
  a := PByte(@buf);
  while count > 0 do begin
    tmp := send(hSocket, a^, count, 0);
    if tmp = SOCKET_ERROR then begin
      if WSAEWOULDBLOCK = WSAGetLastError() then begin
        // optionally use select() to detect when the socket is writable again...
        Continue;
      end;
      // error!!! Stop sending...
      Exit;
    end;
    inc(a, tmp);
    dec(count, tmp);
  end;
end;

procedure RecvBuf(var buf; count:dword);
var
  a: PByte;
  tmp: Integer;
begin
  a := PByte(@buf);
  while count > 0 do begin
    tmp := recv(hSocket, a^, count, 0);
    if tmp = SOCKET_ERROR then begin
      if WSAEWOULDBLOCK = WSAGetLastError() then begin
        // optionally use select() to detect when the socket is readable again...
        Continue;
      end;
      // error!!! Stop reading...
      Exit;
    end;
    if tmp = 0 then begin
      // disconnected!!! Stop reading...
      Exit;
    end;
    inc(a, tmp);
    dec(count, tmp);
  end;
end; 
```

.

```
procedure TClient.Execute;
var
  mode: integer;
  bytBuf: Array[0..255] of Char;
  iRecv: Integer;
begin
  mode := 0;
  ioctlsocket(hSocket, FionBio, mode);
  repeat
    iRecv := recv(hSocket, @bytBuf[0], SizeOf(bytBuf), 0);
    if iRecv <= 0 then begin
      // error or disconnected!!! Stop reading...
      Exit;
    end;
    Process(bytBuf, iRecv);
  until False;
end; 
```

# jakarta-ee - 创建忽略注释值（）的拦截器限定符

> ID：16047076
> 
> 赞同：6
> 
> 时间：2013-04-16T21:06:06.710
> 
> 标签：jakarta-ee, java-ee-6, cdi, jboss-weld, qualifiers

有没有办法创建一个拦截器限定符注释，忽略注释字符串值进行限定？

例如：

**日志.java**

```
@Inherited
@InterceptorBinding
@Target({ElementType.METHOD, ElementType.TYPE})
@Retention(RetentionPolicy.RUNTIME)
public @interface Log {
    String value() default ""; // <---- ignore this
} 
```

**日志拦截器.java**

```
@Log
@Interceptor
public class LogInterceptor implements Serializable {

    ...
} 
```

**用法.java**

```
@Log("message for this log")
public String interceptedMethod(String param) {
    ...
} 
```

这不起作用，因为注释`value("message for this log")`用作限定符，但我想使用`value()`不是作为限定符，而是消息日志。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-17T09:45:07.570

您可以为此目的使用 @Nonbinding 注释。您可以通过注释成员@Nonbinding 强制容器忽略限定符类型的成员。看下面的例子：

```
@Qualifier
@Retention(RUNTIME)
@Target({METHOD, FIELD, PARAMETER, TYPE})
public @interface PayBy {
   PaymentMethod value();
   @Nonbinding String comment() default "";
} 
```

在这里，当 @PayBy 限定符匹配 bean 时，注释将被忽略。可以在[此处](http://docs.jboss.org/weld/reference/latest/en-US/html/injection.html#d0e1309)找到对描述此内容的 CDI 文档的参考。

# jquery - Dropdown closes when another dropdown is clicked

> ID：16047079
> 
> 赞同：0
> 
> 时间：2013-04-16T21:06:15.697
> 
> 标签：jquery

I have an issue where I have a few dropdown elements. I need the others to collapse when one is clicked to expand.

The page can be viewed here:

[http://www.mniac.com/smartlessons/template.html](http://www.mniac.com/smartlessons/template.html)

This is the jQuery:

```
$('.advanced').click(function(){
    $('.drop-box.advanced-search').slideToggle();
});

$('#smart-lessons > a').click(function(){
    //$('.drop-box').hide();
    $('#smart-lessons a').toggleClass('open');
    $('#about a').removeClass('open');
    $('.drop-box.smart').slideToggle();
});

$('#about > a').click(function(){
    //$('.drop-box').hide();
    $('#about a').toggleClass('open');
    $('#smart-lessons a').removeClass('open');
    $('.drop-box.about').slideToggle();
}); 
```

I am trying to close all `.drop-box` elements before performing the script, but it just closes and reopens when the same link is clicked.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T21:22:09.487

尝试将上面的所有代码替换为：

```
$('.nav ul > li > a').click(function() {
    $('.drop-box').slideUp();
    if ($(this).parents('#search').length) {
        $('.advanced-search').slideDown();
    } else {
        $(this).next('.drop-box').slideDown();
    }
    return false;
}); 
```

# c# - 功能风格的实现方法

> ID：16047084
> 
> 赞同：3
> 
> 时间：2013-04-16T21:06:23.107
> 
> 标签：c#, linq

我有以下方法：

```
private List<string> CreateSegments(string virtualPath)
{
    List<string> segments = new List<string>();
    int i = virtualPath.IndexOf('/', 1);
    while (i >= 0 && i < virtualPath.Length)
    {
        var segment = virtualPath.Substring(0, i);
        if (!string.IsNullOrWhiteSpace(segment))
        {
            segments.Add(segment);
            segments.Add(VirtualPathUtility.Combine(segment, "default"));
        }
        i = virtualPath.IndexOf('/', i + 1);
    }
    segments.Add(virtualPath);
    segments.Add(VirtualPathUtility.Combine(virtualPath, "default"));

    return segments;
} 
```

基本上，它会创建路径段，我将使用这些路径段来检查文件是否存在于任何这些段中。像这样：

```
string[] extensions = GetRegisteredExtensions();
HttpServerUtilityBase server = HttpContext.Current.Server;
List<string> segments = CreateSegments(virtualPath);

// check if a file exists with any of the registered extensions
var match = extensions.SelectMany(x => segments.Select(s => string.Format("{0}.{1}", s, x)))
.FirstOrDefault(p => System.IO.File.Exists(server.MapPath(p))); 
```

上面所有的代码看起来都可以使用一些清理和优化，但我正在寻找一种方法来使用`LINQ`如果可能的话来生成段。

类似：`var segments = virtualPath.Split('/').SelectMany(...)`并得到类似于以下的结果：

```
/path
/path/default
/path/to
/path/to/default
/path/to/file
/path/to/file/default 
```

哪里`virtualPath`会包含价值`"/path/to/file"`

**编辑：**更改`string.Format("{0}/{1}", ...)`为`VirtualPathUtility.Combine(..., ...)`

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T21:20:19.887

一种方法是逐步选择路径段，然后用空字符串“加入”它并`"/default"`获得两种变体：

```
string path = @"/path/to/file";

string temp = "";

var query = path.Split('/')
                .Where(s => !string.IsNullOrEmpty(s))
                .Select((p) => {temp += ("/" + p); return temp;} )
                .SelectMany(s => new[]{"","/default"}.Select (d => s + d) ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T21:20:37.850

如果您首先定义这样的扩展方法：

```
public static IEnumerable<int> SplitIndexes(this string subject, char search)
{
    for(var i = 1; i < subject.Length; i++)
    {
        if(subject[i] == search)
        {
            yield return i;
        }
    }

    yield return subject.Length;
} 
```

然后你可以这样做：

```
var endings = new string[] { string.Empty, "/default" };
var virtualPath = "/path/to/file";
var results = 
    from i in virtualPath.SplitIndexes('/')
    from e in endings
    select virtualPath.Substring(0, i) + e; 
```

或者，如果您更喜欢查询语法：

```
var endings = new string[] { string.Empty, "/default" };
var virtualPath = "/path/to/file";
var results = virtualPath.SplitIndexes('/')
                         .SelectMany(i => endings.Select(e => virtualPath.Substring(0, i) + e)); 
```

结果将是：

```
/path
/path/default
/path/to
/path/to/default
/path/to/file
/path/to/file/default 
```

正如其他人所建议的那样，您可以通过使用以更独立于平台的方式进行此操作`Path.Combine`，如下所示：

```
var endings = new string[] { string.Empty, "default" }; // Note: no / before default
var results = 
    from i in virtualPath.SplitIndexes(Path.DirectorySeparatorChar)
    from e in endings
    select Path.Combine(virtualPath.Substring(0, i), e); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-16T23:54:06.260

这可能会奏效。它不是最简洁的代码，但对我来说似乎非常易读。它使用字符串连接，因为对于路径或 URL 等短字符串，它比任何替代方法都快。

**编辑：修复和测试。**

```
var query = path.Split(new[] {'/'}, StringSplitOptions.RemoveEmptyEntries)
    .Aggregate(new List<string>(), (memo, segment) => {

        memo.Add(memo.DefaultIfEmpty("").Last() + "/" + segment);

        return memo;

    }).Aggregate(new List<string>(), (memo, p) => {

        memo.Add(p);
        memo.Add(p + "/default");

        return memo;

    }); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-16T22:56:15.733

您正在寻找的高阶函数称为[scan](http://en.wikipedia.org/wiki/Prefix_sum)。普通 LINQ 中没有这样的功能，但您可以在[MoreLinq](http://code.google.com/p/morelinq/)中找到它。使用它，您的代码可能如下所示：

```
private List<string> CreateSegments(string virtualPath)
{
    return virtualPath.Split('/')
                      .Scan((s1, s2) => s1 + '/' + s2)
                      .Skip(1)
                      .SelectMany(p => new[] { p, p + "/default" })
                      .ToList();
} 
```

这假设您的路径将始终是一个以`/`. 对于相对路径，您需要删除该`.Skip(1)`部分。

如果您不想只为这种方法获取 MoreLinq，您可以将[其源代码](http://code.google.com/p/morelinq/source/browse/MoreLinq/Scan.cs)复制到您的项目中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-16T21:23:52.257

到目前为止提供的答案更简洁，但这就是我想出的：

```
public static IEnumerable<string> PossiblePaths(string basePath)
{
    return PossiblePaths(basePath.Split(new[] { "/" }, 
                         StringSplitOptions.RemoveEmptyEntries));
}

private static IEnumerable<string> PossiblePaths(IEnumerable<string> segments, 
                                                 string current = "/")
{
    if (segments.Count() == 0)
    {
        return new string[0];
    }
    else
    {
        string next = current + segments.First();
        return new[] { next, next + "/default" }
                         .Concat(PossiblePaths(segments.Skip(1), next + "/"));
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-16T21:40:07.527

像这样的东西：

```
public static IEnumerable<string> EnumerateSegments( this IEnumerable<string> segments )
{
  StringBuilder sb = new StringBuilder() ;
  foreach ( string segment in segements )
  {
    sb.Append( Path.DirectorySeparatorChar ).Append( segment ) ;
    yield return sb.ToString() ;
    int n = sb.Length ;
    sb.Append( Path.DirectorySeparatorChar ).Append("default") ;
    yield return sb.ToString() ;
    sb.Length = n ;
  }
} 
```

应该做你。

# x86 - x86 示例代码。“从头开始编程”

> ID：16047086
> 
> 赞同：3
> 
> 时间：2013-04-16T21:06:25.430
> 
> 标签：x86

我正在尝试了解有关汇编编程的更多信息。我正在关注“从头开始编程”一书。我在使用第二个示例程序时遇到了问题。我一直在对其进行故障排除，并且还在线检查了任何已发布的勘误表。

该程序旨在输出所列数字中的最高值。此列表在 data_items 下标记。在终端中运行后，程序应该什么都不做。但是，在您输入 echo $? 后，它应该返回 222（列表中的最高数字）。目前它返回 3 或第一个数字。

我认为以下不是问题

- inc 语句必须工作，否则它将陷入无限循环，因为它永远不会到达 0 以退出循环

- 我认为这可能是 64 位环境中 mov 语句中的 .long 和 4 的问题，但是我确实尝试用 8 代替 4 并且没有运气。

- 除了上述声明之外，我认为这不是一般的 64 位与 32 位问题，因为我在这里查看过，并且共识似乎是 32 位程序在 64 位上运行良好，我已经尝试过我认为可能出现的具体问题。

我认为问题可能出在 ebx 和 eax 寄存器之间的第二个 cmp 语句上。

提前谢谢你，如果我上面的任何或所有假设是错误的，我很抱歉我只是想让你们知道我已经尝试过，研究过什么，以及我的思考过程在哪里。

代码如下。

```
#PURPOSE:       This program finds the maximum number of a
#           set of data items.
#

#VARIABLES:     The registers have the following uses:
#
# %edi - Holds the index of the data item being examined
# %ebx - Largest data item found
# %eax - Current data item
#
# The following memory locations are used:
#
# data_items - contains the item data. A 0 is used 
#          to terminate the data
#

.section .data

data_items:     #These are the data items
 .long 3,67,34,222,45,75,54,34,44,33,22,11,66,0

 .section .text

 .globl _start
_start:
 movl $0, %edi              # move 0 into the index register
 movl data_items(,%edi,4), %eax     # load the first byte of data
 movl %eax, %ebx                # since this is the first item, 
                    # %eax is the biggest

start_loop:                 # start loop
 cmpl $0, %eax                  # check to see if we've hit theend
 je loop_exit               # if so uncondition jmp to exit
 incl %edi                  # load next value
 movl data_items(,%edi,4), %eax
 cmpl %ebx, %eax                    # compare values
 jle start_loop             # jump to loop beginning

 loop_exit:
  # %ebx is the return value, and it has the highest number availible
    movl $1, %eax           #1 is the exit() syscall
    int $0x80 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T21:30:15.747

这是整个程序中唯一写入的语句`%ebx`：

```
movl %eax, %ebx        # since this is the first item, 
                       # %eax is the biggest 
```

循环运行直到`%ebx`小于`%eax`，然后立即退出，`%ebx`等于数组中的第一个值，即 3。

如果我在之后立即添加两行`jle start_loop`，即

```
movl %eax, %ebx  # copy new largest value to %ebx
jmp start_loop   # and continue 
```

然后程序按预期执行（使用 编译时`gcc -nostdlib -nostartfiles -m32 test.s`）。

*最*好像这样编写这个程序：

```
 .section .rodata
data_items:
    .long 3,67,34,222,45,75,54,34,44,33,22,11,66,0
    .section .text
    .globl main
main:
    xorl  %ecx, %ecx
    movl  data_items(,%ecx,4), %edx
    movl  %edx, %eax
loop:
    # data_items assumed to have at least two elements
    cmpl  %eax, %edx
    cmovg %edx, %eax
    incl  %ecx
    movl  data_items(,%ecx,4), %edx
    testl %edx, %edx
    jne loop
    # return the largest value, which is in %eax
    ret 
```

除了一些小的微优化之外，我还使程序符合 ABI，将其入口点从 更改为`_start`，`main`以便 C 库有机会初始化，并且我从`main`（导致调用`exit`）返回而不是开放编码系统`_exit`调用。

在这种情况下，ABI 合规性是使用正确寄存器的问题。我从 返回`main`，所以我必须满足*调用* `main`的代码的期望，特别是当`main`返回时，`%ebx`、`%esi`、`%edi`和`%ebp`仍然具有与函数调用之前相同的值。如果您使用这些寄存器中的任何一个，您有责任在进入时将它们的旧值推入堆栈，并在退出时再次弹出它们。由于此代码只需要三个寄存器并且本身不进行任何函数调用，因此最好只使用`%eax`、`%ecx`和`%edx`，它们*不需要*在函数调用后保留其旧值。你的书可能在某个时候解释了这一点。

（64位ABI的寄存器使用规则比较复杂，因为它在寄存器中传递参数，我没有记住。）

尽管有许多指南和教程告诉您相反的情况，*但您永远不应该打开代码系统调用*。调用 C 库中的包装器，或者在本例中，从`main`. C 库可以将您与您不想处理的低级 ABI glorp 隔离开来——例如，它总是使用最有效的陷阱序列，它知道*正确*的系统调用号（我回想几年前的一个问题，其答案归结为“`_exit`不是 64 位 ABI 中的系统调用 #1”），它知道如何设置`errno`.

# ios - HTML表格解析xcode

> ID：16047090
> 
> 赞同：1
> 
> 时间：2013-04-16T21:06:35.760
> 
> 标签：ios, objective-c, html-parsing

我正在尝试解析：[www.neiu.edu/~neiutemp/PhoneBook/alpha.htm] 使用 TFHPPLE 解析器，我正在从表中的每个 TR（行）中查找第一个 TD（第一列）。这里 TD 的所有属性都是相同的。我无法区分 TD。
我能够获取所有 HTML 代码，但无法从每个 TR 中获取第一个 TD。之后`// 3`（在代码中）tutorialsNodes 为空。的输出

```
NSLog(@"Nodes are : %@",[tutorialsNodes description]); 
```

是

```
练习1[62351:c07] 节点是：()。

```

我看不出有什么问题。任何帮助，将不胜感激。我解析此 URL 的代码：

```
NSURL *tutorialsUrl = [NSURL URLWithString:@"http://www.neiu.edu/~neiutemp/PhoneBook/alpha.htm"];
NSData *tutorialsHtmlData = [NSData dataWithContentsOfURL:tutorialsUrl];

// 2
TFHpple *tutorialsParser = [TFHpple hppleWithHTMLData:tutorialsHtmlData];

// 3
NSString *tutorialsXpathQueryString = @"//TR/TD";
NSArray *tutorialsNodes = [tutorialsParser searchWithXPathQuery:tutorialsXpathQueryString];
NSLog(@"Nodes are : %@",[tutorialsNodes description]);
// 4
NSMutableArray *newTutorials = [[NSMutableArray alloc] initWithCapacity:0];
for (TFHppleElement *element in tutorialsNodes) {
    // 5
    Tutorial *tutorial = [[Tutorial alloc] init];
    [newTutorials addObject:tutorial];

    // 6
    tutorial.title = [[element firstChild] content];

    // 7
    tutorial.url = [element objectForKey:@"href"];

    NSLog(@"title is: %@",[tutorial.title description]);
}

// 8
_objects = newTutorials;
[self.tableView reloadData]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-06T22:32:38.300

如果您使用`@"//tr/td"`而不是`@"//TR/TD"`.

但是，查看您的 HTML，由于其作者显然不知道如何拼写 CSS，因此您在整个源代码中都隐藏了字体标签。因此，您的下一行代码显然取自[Ray Wenderlich 网站上的 Matt Galloway 的优秀 Hpple 教程](http://www.raywenderlich.com/14172/how-to-parse-html-on-ios)，它说：

```
tutorial.title = [[element firstChild] content]; 
```

但这在这里行不通，因为对于您的大多数条目， the`firstChild`不是`text`，而是一个`font`标签。所以你可以检查它是否是这样的字体标签：

```
TFHppleElement *subelement = [element firstChild];
if ([[subelement tagName] isEqualToString:@"font"])
    subelement = [subelement firstChild];
tutorial.title = [subelement content]; 
```

或者，您也可以只搜索`@"//tr/td/font"`而不是`@"//tr/td"`. 这里有很多方法。诀窍（就像所有的 HTML 解析一样）将使其相当健壮，这样您就不会受到页面的细微修饰调整的影响。

显然，您的 HTML 没有 URL，因此该代码不适用于此处。

无论如何，我希望这足以让你继续前进。

* * *

你报告有问题，所以我想我只是提供一个更完整的代码示例：

```
NSURL *tutorialsUrl = [NSURL URLWithString:@"http://www.neiu.edu/~neiutemp/PhoneBook/alpha.htm"];
NSData *tutorialsHtmlData = [NSData dataWithContentsOfURL:tutorialsUrl];

TFHpple *tutorialsParser = [TFHpple hppleWithHTMLData:tutorialsHtmlData];

NSString *tutorialsXpathQueryString = @"//tr/td";
NSArray *tutorialsNodes = [tutorialsParser searchWithXPathQuery:tutorialsXpathQueryString];

if ([tutorialsNodes count] == 0)
    NSLog(@"nothing there");
else
    NSLog(@"There are %d nodes", [tutorialsNodes count]);

NSMutableArray *newTutorials = [[NSMutableArray alloc] initWithCapacity:0];
for (TFHppleElement *element in tutorialsNodes) {

    Tutorial *tutorial = [[Tutorial alloc] init];
    [newTutorials addObject:tutorial];

    TFHppleElement *subelement = [element firstChild];
    if ([[subelement tagName] isEqualToString:@"font"])
        subelement = [subelement firstChild];
    tutorial.title = [subelement content];

    NSLog(@"title is: %@", [tutorial.title description]);
} 
```

这会产生以下输出：

```
2013-05-10 19:39:42.027 hpple-test[33881:c07] 有 10773 个节点
2013-05-10 19:39:42.028 hpple-test[33881:c07] 标题是：A
2013-05-10 19:39:46.027 hpple-test[33881:c07] 标题是：（空）
2013-05-10 19:39:46.698 hpple-test[33881:c07] 标题是：（空）
2013-05-10 19:39:47.333 hpple-test[33881:c07] 标题是：（空）
2013-05-10 19:39:47.827 hpple-test[33881:c07] 标题是：（空）
2013-05-10 19:39:48.358 hpple-test[33881:c07] 标题是：（空）
2013-05-10 19:39:49.133 hpple-test[33881:c07] 标题是：（空）
2013-05-10 19:39:49.775 hpple-test[33881:c07] 标题是：Abay，Hiwet B
2013-05-10 19:39:50.326 hpple-test[33881:c07] 标题是：H-Abay
2013-05-10 19:39:50.992 hpple-test[33881:c07] 标题是：773-442-5140
2013-05-10 19:39:51.597 hpple-test[33881:c07] 标题是：（空）
2013-05-10 19:39:52.092 hpple-test[33881:c07] 标题是：控制器
2013-05-10 19:39:52.598 hpple-test[33881:c07] 标题是：E
2013-05-10 19:39:53.149 hpple-test[33881:c07] 标题是：223
2013-05-10 19:39:55.040 hpple-test[33881:c07] 标题是：Abbruscato，Terence
2013-05-10 19:39:55.806 hpple-test[33881:c07] 标题是：T-Abbruscato
2013-05-10 19:39:56.525 hpple-test[33881:c07] 标题是：773-442-5339
...

```

# javascript - 测试在 JQueryUI 小部件的 QUnit 测试中是否可见

> ID：16047091
> 
> 赞同：5
> 
> 时间：2013-04-16T21:06:38.027
> 
> 标签：javascript, jquery, jquery-ui, qunit

*这对其他人来说可能很明显，但我没有通过搜索找到它，因此在此处发布问题和一个可能的答案。*

背景：

1.  [使用小部件工厂](http://jqueryui.com/widget/)自定义 JQuery UI 小部件
2.  在小部件中，某些元素会根据其他数据/选项隐藏或显示。
3.  创建单元测试以验证它们是否正确显示/隐藏。
4.  我认为我的单元测试都可以在内存中创建自己的元素，类似于[这个旧答案](https://stackoverflow.com/a/7621037/151212)。

从这个例子中去掉了实际的小部件部分：

```
test( 'show/hide', 1, function() {
    var somecondition = true;

    var div = $( '<div/>' ).hide();
    if (somecondition) div.show();

    equal( somecondition, div.is( ":visible" ) );
}); 
```

测试失败，因为 jQuery 总是报告`div.is( ":visible" )`为假。我认为使用`div.css('display') == 'none'`将是一种解决方法。不幸的是，这在 Chrome 中有效，但在 Firefox 中无效。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-16T21:06:38.027

The problem was that jQuery is smart enough to know that even if a particular element has **said** it's visible, it might not **actually** be visible if (for example):

1.  It was never added to the DOM
2.  The DOM element (or parent/grandparent/etc) it was appended to is not actually visible

So in order for the unit tests to work, I need to have a real div in the test harness html, attach the widget to it, and then call a destroy at the end.

```
test( 'show/hide', 1, function() {
    var somecondition = true;

    var div = $( '#someid' ).hide();
    if (somecondition) div.show();

    equal( somecondition, div.is( ":visible" ) );
}); 
```

I was hoping for a different approach (and maybe someone will come along and provide another answer), but I'm not very hopeful, seeing as this is the approach that JQueryUI uses in [their own QUnit tests](https://github.com/jquery/jquery-ui/blob/master/tests/unit/autocomplete/autocomplete_methods.js):

```
test( "search, close", function() {
    //SNIP
    // Note the use of a real element here:
    element = $( "#autocomplete" ).autocomplete({
        source: data,
        minLength: 0
    }),
    menu = element.autocomplete( "widget" );
    //SNIP
    ok( menu.is( ":visible" ), "menu is visible after search" );
    //SNIP
}); 
```

# android - 使用 GoogleHttpClient 发送 multipart/form-data

> ID：16047095
> 
> 赞同：0
> 
> 时间：2013-04-16T21:06:43.997
> 
> 标签：android, google-http-client

我正在使用 google-http-client for java 来处理 Android 上的 http 连接。

到目前为止，一切都是 HunkyDori，**直到**尝试发送`multipart/form-data`内容。

我有点卡住了，我正在考虑调整[`MultipartContent`](https://code.google.com/p/google-http-java-client/source/browse/google-http-client/src/main/java/com/google/api/client/http/MultipartContent.java?name=1.14.1-beta)课程以创建我自己的`MultipartFormContent`.

我需要一个[`MultipartEntity`](http://hc.apache.org/httpcomponents-client-ga/httpmime/apidocs/org/apache/http/entity/mime/MultipartEntity.html#addPart%28java.lang.String,%20org.apache.http.entity.mime.content.ContentBody%29)可以有效工作的版本：

```
HttpClient httpclient = new DefaultHttpClient();
HttpPost httppost = new HttpPost(url);

FileBody bin = new FileBody(new File(fileName));
StringBody comment = new StringBody("Filename: " + fileName);

MultipartEntity reqEntity = new MultipartEntity();
reqEntity.addPart("bin", bin);
reqEntity.addPart("comment", comment);
httppost.setEntity(reqEntity);

HttpResponse response = httpclient.execute(httppost);
HttpEntity resEntity = response.getEntity(); 
```

`multipart/relative`从周围阅读，唯一的区别`multipart/form`是打印出来时添加名称吗？

[`MultipartContent`](https://code.google.com/p/google-http-java-client/source/browse/google-http-client/src/main/java/com/google/api/client/http/MultipartContent.java?name=1.14.1-beta)任何人都对调整类以支持“名称”字段有任何想法。

问候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T10:55:53.437

好的，我基于 MultipartContent 类创建了以下类：

```
/**
 * Serializes MIME multipart content to the form-data standard. Adapated from {@link MultipartContent}
 * <p/>
 * <p>
 * By default the media type is {@code "multipart/form-data; boundary=__END_OF_PART__"}, but this may
 * be customized by calling {@link #setMediaType(HttpMediaType)}, {@link #getMediaType()}, or
 * {@link #setBoundary(String)}.
 * </p>
 * <p/>
 * <p>
 * Implementation is not thread-safe.
 * </p>
 *
 * @author Christopher Jenkins
 * @since 1.15
 */
public class MultipartFormContent extends AbstractHttpContent
{

    static final String NEWLINE = "\r\n";
    private static final String TWO_DASHES = "--";
    /**
     * Parts of the HTTP multipart request.
     */
    private ArrayList<Part> parts = new ArrayList<Part>();

    public MultipartFormContent()
    {
        super(new HttpMediaType("multipart/form-data").setParameter("boundary", "__END_OF_PART__"));
    }

    public void writeTo(OutputStream out) throws IOException
    {
        Writer writer = new OutputStreamWriter(out, getCharset());
        String boundary = getBoundary();

        //TODO use http headers again like MultipartContent
        HttpHeaders headers;
        String contentDisposition = null;
        HttpContent content = null;
        StreamingContent streamingContent = null;
        for (Part part : parts)
        {
            // analyze the headers
            headers = new HttpHeaders().setAcceptEncoding(null);
            if (part.headers != null)
                headers.fromHttpHeaders(part.headers);
            headers.setContentEncoding(null)
                    .setUserAgent(null)
                    .setContentType(null)
                    .setContentLength(null)
                    .set("Content-Transfer-Encoding", null);

            // Write disposition
            if (part.getName() != null)
            {
                contentDisposition = String.format("form-data; name=\"%s\"", part.name);
                // Do we have a filename?
                // Then add to the content dispos
                if (part.filename != null)
                    contentDisposition += String.format("; filename=\"%s\"", part.filename);
                headers.set("Content-Disposition", contentDisposition);
            }

            // analyze the content
            content = part.content;
            streamingContent = null;
            if (content != null)
            {
                headers.setContentType(content.getType());
                headers.set("Content-Transfer-Encoding", Arrays.asList("binary"));
                final HttpEncoding encoding = part.encoding;
                if (encoding == null)
                    streamingContent = content;
                else
                {
                    headers.setContentEncoding(encoding.getName());
                    streamingContent = new HttpEncodingStreamingContent(content, encoding);
                }
            }

            // write separator
            writer.write(TWO_DASHES);
            writer.write(boundary);
            writer.write(NEWLINE);
            // Write Headers
            HttpHeaders.serializeHeadersForMultipartRequests(headers, null, null, writer);
            // write content
            if (streamingContent != null)
            {
                writer.write(NEWLINE);
                writer.flush();
                streamingContent.writeTo(out);
                writer.write(NEWLINE);
            }
        }
        // write end separator
        writer.write(TWO_DASHES);
        writer.write(boundary);
        writer.write(TWO_DASHES);
        writer.write(NEWLINE);
        writer.flush();
    }

    @Override
    public boolean retrySupported()
    {
        for (Part part : parts)
        {
            if (!part.content.retrySupported())
            {
                return false;
            }
        }
        return true;
    }

    @Override
    public MultipartFormContent setMediaType(HttpMediaType mediaType)
    {
        super.setMediaType(mediaType);
        return this;
    }

    /**
     * Returns an unmodifiable view of the parts of the HTTP multipart request.
     */
    public final Collection<Part> getParts()
    {
        return Collections.unmodifiableCollection(parts);
    }

    /**
     * Sets the parts of the HTTP multipart request.
     * <p/>
     * <p>
     * Overriding is only supported for the purpose of calling the super implementation and changing
     * the return type, but nothing else.
     * </p>
     */
    public MultipartFormContent setParts(Collection<Part> parts)
    {
        this.parts = new ArrayList<Part>(parts);
        return this;
    }

    /**
     * Adds an HTTP multipart part.
     * <p/>
     * <p>
     * Overriding is only supported for the purpose of calling the super implementation and changing
     * the return type, but nothing else.
     * </p>
     */
    public MultipartFormContent addPart(Part part)
    {
        parts.add(Preconditions.checkNotNull(part));
        return this;
    }

    /**
     * Returns the boundary string to use.
     */
    public final String getBoundary()
    {
        return getMediaType().getParameter("boundary");
    }

    /**
     * Sets the boundary string to use.
     * <p/>
     * <p>
     * Defaults to {@code "__END_OF_PART__"}.
     * </p>
     * <p/>
     * <p>
     * Overriding is only supported for the purpose of calling the super implementation and changing
     * the return type, but nothing else.
     * </p>
     */
    public MultipartFormContent setBoundary(String boundary)
    {
        getMediaType().setParameter("boundary", Preconditions.checkNotNull(boundary));
        return this;
    }

    /**
     * Single part of a multi-part request.
     * <p/>
     * <p>
     * Implementation is not thread-safe.
     * </p>
     */
    public static final class Part
    {

        /**
         * Name of this FormPart
         */
        private String name;
        /**
         * FileName of the File being uploaded or {@code null} for none.
         */
        private String filename;
        /**
         * HTTP header or {@code null} for none.
         */
        private HttpHeaders headers;
        /**
         * HTTP content or {@code null} for none.
         */
        private HttpContent content;
        /**
         * HTTP encoding or {@code null} for none.
         */
        private HttpEncoding encoding;

        public Part()
        {
            this(null, null);
        }

        /**
         * @param headers HTTP headers or {@code null} for none
         * @param content HTTP content or {@code null} for none
         */
        public Part(String name, HttpContent content)
        {
            setName(name);
            setContent(content);
        }

        /**
         * Returns the HTTP content or {@code null} for none.
         */
        public HttpContent getContent()
        {
            return content;
        }

        /**
         * Sets the HTTP content or {@code null} for none.
         */
        public Part setContent(HttpContent content)
        {
            this.content = content;
            if (content instanceof FileContent)
            {
                final File file = ((FileContent) content).getFile();
                if (file != null && file.exists())
                {
                    setFilename(file.getName());
                }
            }
            return this;
        }

        public String getName()
        {
            return name;
        }

        public Part setName(final String name)
        {
            this.name = name;
            return this;
        }

        public String getFilename()
        {
            return filename;
        }

        /**
         * Set the HTTP form-part filename or null for none.
         *
         * @param filename
         */
        public Part setFilename(final String filename)
        {
            this.filename = filename;
            return this;
        }

        /**
         * Returns the HTTP headers or {@code null} for none.
         */
        public HttpHeaders getHeaders()
        {
            return headers;
        }

        /**
         * Sets the HTTP headers or {@code null} for none.
         */
        public Part setHeaders(final HttpHeaders headers)
        {
            this.headers = headers;
            return this;
        }

        /**
         * Returns the HTTP encoding or {@code null} for none.
         */
        public HttpEncoding getEncoding()
        {
            return encoding;
        }

        /**
         * Sets the HTTP encoding or {@code null} for none.
         */
        public Part setEncoding(HttpEncoding encoding)
        {
            this.encoding = encoding;
            return this;
        }
    }
} 
```

这对我有用，我正在使用 Cloudinary。

# mysql - Calculate difference between dates

> ID：16047096
> 
> 赞同：0
> 
> 时间：2013-04-16T21:06:45.183
> 
> 标签：mysql, sql, date

The title might be a bit misleading, but what I want is:

```
SELECT * FROM table ORDER BY pid ASC 
```

And in one of the columns I have a DATE(). I want to compare the current date (not time) and return how many days are left till that date. Let's say the date is `2013-04-20` and today's date is `2013-04-16` I don't want to get any data if it's `< current date`. If it is I want it returned in days.

I've been looking around here and I've found no way to do it, and I can't for the love of me figure it out.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T21:11:01.640

If you're using MySQL you can use [`DATEDIFF()`](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_datediff)

```
SELECT 
    DATEDIFF(NOW(), date_column) AS days_diff
FROM
    tablename 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T22:02:33.937

If you're looking for the difference between two date you can use the GETDATE function in MS SQL

```
SELECT DATEDIFF(DD, DateOne, DateTwo) FROM TABLE 
```

This will return the difference in number of days between the two dates.

If you only want rows where the date field is less than or equal to today's date you can use:

```
SELECT DATEDIFF(DD, DateField, GETDATE())
FROM TableName
WHERE DateField <= GETDATE() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T21:10:25.643

Get the difference between two dates (ANSI SQL)

```
select the_date_column - current_date as days_left
from the_table
where the_date_column - current_date <= 4; 
```

SQLFiddle: [http://sqlfiddle.com/#!12/3148d/1](http://sqlfiddle.com/#!12/3148d/1)

# javascript - 一个像 BreezeJS 这样的库，可以与 Django 和 sweetpie 一起使用

> ID：16047097
> 
> 赞同：4
> 
> 时间：2013-04-16T21:06:45.950
> 
> 标签：javascript, django, odata, breeze, single-page-application

我希望将 Django 模型集成到 SPA 中，并希望使用[BreezeJS](http://www.breezejs.com/)或[JayData 之](http://jaydata.org/)类的库来管理客户端的离线/在线数据。这两个都需要 OData。OData 对 Python 的支持不多，除了真正只支持 GAE的[o-data py 。](http://code.google.com/p/odata-py/)

所以，我的问题是......是否有一些 Javascript 框架/库通常与 BreezeJS 一样好用于管理离线数据，但与 Django/Python 一起工作得很好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T06:40:00.077

Jaydata 使用 REST 端点，我今天尝试用 python 为您整理一个示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-10T20:27:12.763

Breeze 应该可以与任何通过 HTTP 通信的东西一起工作。[Breeze 背后的人之一沃德·贝尔（Ward Bell）在这段视频](http://www.youtube.com/watch?v=P2ErSQj3SN8)中至少是这么说的。但是，您可能必须编写自己的适配器。

# oracle - 只需插入带有日期的列

> ID：16047102
> 
> 赞同：-2
> 
> 时间：2013-04-16T21:06:53.963
> 
> 标签：oracle

尝试插入带有日期的列

```
INSERT 
INTO o_employees (date)
VALUES (DATE (to_date('20030203', 'yyyymmdd')) 
```

给我缺少选择关键字吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T21:14:58.307

在您的帖子中，您缺少右括号。这是一个例子，请阅读以下几点：

```
INSERT INTO o_employees ("date")
  VALUES (DATE '2003-02-03') 
```

1.  这个词`DATE`（包括小写`date`）是保留的。如果您的列被命名`DATE`，它必须用双引号引起来。但是，最好的解决方案是将列命名为其他名称。我*强烈*建议你这样做。

2.  对文字日期使用 ANSI 文字：`DATE '2003-02-03'`. 你`to_date('20030203', 'yyyymmdd')`一个人（没有`DATE`前缀）会工作，但总是试图支持 ANSI 方式。

# php - 深入到多维对象数组的底部

> ID：16047106
> 
> 赞同：2
> 
> 时间：2013-04-16T21:06:58.413
> 
> 标签：php

我有一个 SQL 连接，它输出一个对象数组，它是这样排序的

```
(
    [0] => listItem Object
        (
            [name] => TV
            [parentId] => 0
            [id] => 1
            [childs] => Array
                (
                    [0] => listItem Object
                        (
                            [name] => mini tv
                            [parentId] => 1
                            [id] => 29
                            [childs] => Array
                                (
                                    [0] => listItem Object
                                        (
                                            [name] => tiny TV
                                            [parentId] => 29
                                            [id] => 548
                                        )

                                )

                        )

                )

        )

    [1] => listItem Object
        (
            [name] => RADIO
            [parentId] => 0
            [id] => 2
            [childs] => Array
                (
                    [0] => listItem Object
                        (
                            [name] => mini radio
                            [parentId] => 2
                            [id] => 30
                        )

                    [1] => listItem Object
                        (
                            [name] => Tiny LCD
                            [parentId] => 2
                            [id] => 551
                        )

                )

        )

    [2] => listItem Object
        (
            [name] => Stereo
            [parentId] => 0
            [id] => 550
        )

    [3] => listItem Object
        (
            [name] => Joe the Plumber
            [parentId] => 0
            [id] => 568
            [childs] => Array
                (
                    [0] => listItem Object
                        (
                            [name] => Joe the Plumber
                            [parentId] => 568
                            [id] => 569
                            [childs] => Array
                                (
                                    [0] => listItem Object
                                        (
                                            [name] => Joe the Plumber
                                            [parentId] => 569
                                            [id] => 570
                                            [childs] => Array
                                                (
                                                    [0] => listItem Object
                                                        (
                                                            [name] => Joe the Plumber
                                                            [parentId] => 570
                                                            [id] => 571
                                                        )

                                                )

                                        )

                                )

                        )

                )

        )

) 
```

我以这种方式对其进行排序，因为我想将其输出为具有适当层次结构的 a 。

我有这个功能

```
function buildHTML($tree){
  echo 'building tree';
  foreach($tree as $item){
      $topItem = makeHtmlListItem($item);
       $pos = strpos($topItem, '</li>');
       $newItem = substr($topItem,0 , $pos);
       echo $newItem;
        foreach($item->childs as $subItem){
         echo '<ul>' . makeHtmlListItem($subItem) . '</ul>' ;
        }
echo '</li>';
 }
} 
```

但它只达到了第二个层次。如何以任意深度到达底部？我设法通过递归来做到这一点，但现在我想在没有递归的情况下做到这一点，我快疯了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T22:38:27.420

你总是可以使用堆栈方法，这几乎是在递归成为可能之前你会使用的方法——这就是递归调用函数实际上所做的一切，它只是堆叠参数。

下面只使用一个堆叠数组（FILO）来存储当前正在处理的数组，并使用另一个堆叠数组来跟踪该级别的当前数组索引。为简单起见，我使用了两个数组，但您可以构建一个结构，将数组和当前索引存储在同一个对象中。以下显然仅适用于非关联数组：

**你的基类：**

```
class listItem {
  public $name = '';
  public $parentId = 0;
  public $id = 0;
  public $childs = NULL;
  public function __construct($name, $parentId, $id, $childs = NULL){
    $this->name = $name;
    $this->parentId = $parentId;
    $this->id = $id;
    $this->childs = $childs;
  }
} 
```

**您的基础数据：**

```
$data = array(
  new listItem('TV', 0, 1,
    array(
      new listItem('mini tv', 1, 29,
        array(
          new listItem('tiny tv', 29, 548),
        )
      ),
    )
  ),
  new listItem('RADIO', 0, 2,
    array(
      new listItem('mini radio', 2, 30),
      new listItem('Tiny LCD', 2, 551),
    )
  ),
  new listItem('Stereo', 0, 550),
  new listItem('Joe the Plumber', 0, 568,
    array(
      new listItem('Joe the Plumber', 568, 569,
        array(
          new listItem('Joe the Plumber', 569, 570,
            array(
              new listItem('Joe the Plumber', 570, 571)
            )
          )
        )
      )
    )
  ),
); 
```

**遍历方法：**

```
function traverse( $data ){
  $stack = array( $data );
  $place = array( 0 );
  $build = '<ul>';
  while ( $stack ) {
    $a = end($stack);
    $i = end($place);
    $k = key($place);
    $place[$k]++;
    if ( isset($a[$i]) ) {
      $item = $a[$i];
      $build .='<li><span>' . $item->name . '</span>';
      if ( $item->childs ) {
        $build .= '<ul>';
        $stack[] = $item->childs;
        $place[] = 0;
      }
    }
    else {
      array_pop($stack);
      array_pop($place);
      $build .= '</ul>' . ( $stack ? '</li>' : '' );
    }
  }
  return $build;
} 
```

**用法：**

```
echo traverse( $data ); 
```

**有评论：**

```
function traverse( $data ){
  /// prep the stack
  $stack = array( $data );
  $place = array( 0 );
  /// I've tailored the build to be for list items
  $build = '<ul>';
  /// loop until we have no more stack
  while ( $stack ) {
    /// you could improve optimisation at the cost of readability
    /// by storing the end offsets rather than using `end()`.
    $a = end($stack); /// current array
    $i = end($place); /// current offset in that array
    $k = key($place); /// key used to update current offset
    /// update the current levels array index
    $place[$k]++;
    /// if we have an item, investigate
    if ( isset($a[$i]) ) {
      $item = $a[$i];
      /// output our list item
      $build .='<li><span>' . $item->name . '</span>';
      /// if we have children, level up the stack
      if ( $item->childs ) {
        $build .= '<ul>';
        $stack[] = $item->childs; /// adding child array for next iteration
        $place[] = 0; /// start scanning childs from 0 offset
      }
    }
    /// if no more items at this level, level down the stack
    else {
      array_pop($stack);
      array_pop($place);
      /// always output a ul at this point, but not an li at the end
      $build .= '</ul>' . ( $stack ? '</li>' : '' );
    }
  }
  /// the final html returned
  return $build;
} 
```

**输出：**

```
<ul>
  <li>
    <span>TV</span>
    <ul>
      <li>
        <span>mini tv</span>
        <ul>
          <li><span>tiny tv</span></li>
        </ul>
      </li>
    </ul>
  </li>
  <li>
    <span>RADIO</span>
    <ul>
      <li>
        <span>mini radio</span>
      </li>
      <li>
        <span>Tiny LCD</span>
      </li>
    </ul>
  </li>
  <li>
    <span>Stereo</span>
  </li>
  <li>
    <span>Joe the Plumber</span>
    <ul>
      <li>
        <span>Joe the Plumber</span>
        <ul>
          <li>
            <span>Joe the Plumber</span>
            <ul>
              <li>
                <span>Joe the Plumber</span>
              </li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T21:43:51.170

如果你想避免递归，你需要每个元素都知道它的父元素、第一个子元素和下一个兄弟元素是什么。根本没有其他方法可以做到这一点，除了在每次迭代中进行搜索，这非常昂贵。

从理论上讲，您可以以这样的方式重写您的树，使其适合像这样遍历：

```
 function traverseTree($tree)
{
    $cnode = $tree[0];
    $process = true;
    while($cnode !== NULL) {
       if ($process)
         makeHtmlListItem($cnode);

       if ($cnode->child !== NULL && $process) {
         $process = true;
         $cnode = $cnode->child;
       } elseif ($pnode->next !== NULL) {
         $process = true;
         $cnode = $cnode->next;
       } else {
         // This is where we satisfy the exit condition, after we bubble up
         // upon processing the last top level branch
         $cnode = $cnode->parent;
         $process = false;
       }
    }
} 
```

当然，这意味着您必须事先以编程方式准备树，因为使用静态定义您不能同时设置子属性和父属性。

后期编辑：其实是有办法的，但是丑到我都不想去想。您必须存储一个包含每个级别的索引的数组，并依次递增每个级别，直到您完成遍历整个事物。噩梦的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T21:35:22.523

```
$counter = array(-1);
$depth = 0;
echo "<ul>";

while ($depth > -1) {
    $tmptree = new stdClass;
    $tmptree->childs = $tree; // little hack to not have to do in the for loop: if (!$i) $tmptree = $tmptree[...]; else $tmptree = $tmptree->childs[...];
    for ($i = 0; $i <= $depth; $i++) {
        if ($i == $depth && !isset($tmptree->childs[++$counter[$i]])) {
            echo "</ul>",$i?"</li>":"";
            $depth--;
            continue 2;
        }
        $tmptree = $tmptree->childs[$counter[$i]];
    }

    $topItem = makeHtmlListItem($tmptree);
    $pos = strpos($topItem, '</li>');
    $newItem = substr($topItem,0 , $pos);
    echo $newItem;

    if (isset($tmptree->childs)) {
        echo "<ul>";
        $counter[++$depth] = -1;
    }
} 
```

这个小片段存储了您在某个数组中的位置以及您的深度（`$counter`和`$depth`）。然后它越来越深，直到它找到一个结束，然后返回。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-16T22:15:48.320

我编写的程序使用类似于您的数据结构。您应该能够轻松地调整下面的代码以满足您的需求。

```
<?php    

$arr = array(
    array(
        "name" => "lvl1",
        "childs" => array(
            array(
                "name" => "lvl2.1",
                "childs" => array(
                    array(
                        "name" => "lvl3.1",
                        "childs" => array()
                    ),
                    array(
                        "name" => "lvl3.2",
                        "childs" => array()
                    )
                )
            ),
            array(
                "name" => "lvl2.2",
                "childs" => array(
                    array(
                        "name" => "lvl3.3",
                        "childs" => array()
                    )
                )
            )
        )
    )
);

// current index at each level
$i = array(0);

// current array at each level
$cur = array($arr);

$lvl = 0;
while(TRUE) {
    // iterate over childless nodes at current level
    while(!$cur[$lvl][$i[$lvl]]["childs"]) {    
        echo $cur[$lvl][$i[$lvl]]["name"]."\n";
        ++$i[$lvl];
        // if ran out of nodes at current level
        while($i[$lvl] >= count($cur[$lvl])) {
            // and not at level 0
            if($lvl == 0) break 3;
            // move to next node one level above the current one
            ++$i[--$lvl];
        }
    }
    // descend until you hit the childless node
    while($cur[$lvl + 1] = $cur[$lvl][$i[$lvl]]["childs"]) {
        echo $cur[$lvl][$i[$lvl]]["name"]."\n";
        $lvl++;
        // start with first node at each level you descend to
        $i[$lvl] = 0;
    };
}; 
```

# android - 类扩展应用程序抛出 ClassNotFoundException

> ID：16047107
> 
> 赞同：9
> 
> 时间：2013-04-16T21:07:00.043
> 
> 标签：android, classcastexception

我有一个扩展应用程序类的类，有时在我的开发者控制台中我看到一条错误消息`ClassNotFoundException`

```
java.lang.RuntimeException: Unable to instantiate application ecm2.android.ActiveStore: java.lang.ClassNotFoundException: ecm2.android.ActiveStore
at android.app.LoadedApk.makeApplication(LoadedApk.java:501)
at android.app.ActivityThread.handleBindApplication(ActivityThread.java:4221)
at android.app.ActivityThread.access$1400(ActivityThread.java:139)
at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1284)
at android.os.Handler.dispatchMessage(Handler.java:99)
at android.os.Looper.loop(Looper.java:137)
at android.app.ActivityThread.main(ActivityThread.java:4918)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:511)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1004)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:771)
at dalvik.system.NativeStart.main(Native Method)
Caused by: java.lang.ClassNotFoundException: ecm2.android.ActiveStore
at dalvik.system.BaseDexClassLoader.findClass(BaseDexClassLoader.java:61)
at java.lang.ClassLoader.loadClass(ClassLoader.java:501)
at java.lang.ClassLoader.loadClass(ClassLoader.java:461)
at android.app.Instrumentation.newApplication(Instrumentation.java:982)
at android.app.LoadedApk.makeApplication(LoadedApk.java:496)
... 11 more 
```

这就是我在清单中声明它的方式

```
<application
    android:name=".ActiveStore"
    android:icon="@drawable/icon"
    android:label="@string/app_name"
    android:theme="@android:style/Theme.NoTitleBar" > 
```

`ActiveStore`只是一个包含应用程序上下文以启动和取消警报的类，那么为什么我会收到此错误？

**更新：**

`.`即使在类名前面放置了一个，我仍然不时在我的开发人员页面中看到这个错误。它似乎只发生在更新或新安装时

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T21:10:58.503

Probably because you're missing the dot in front of the class name (which helps to tell Dalvik that your class belongs to the package of your app)

```
.ActiveStore 
```

But if in doubt, post both the whole Manifest file and your .java

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-09T20:07:41.540

在您的清单中，您应该具有以下内容：

```
package="path.to.project.root"
...
<application 
    android:name=".MyApplication" 
```

或如前所述

```
<application
    android:name="path.to.project.root.MyApplication" 
```

还要确保 MyApplication 类的构造函数是公开的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-06T00:43:48.040

我也经常看到这个问题，但没有任何解释。我见过有人说它可能发生在崩溃之后。假设，在崩溃之后，ClassLoader 可能处于“坏”状态并且无法加载类。基本上，这意味着先前的错误是这个问题的真正根源。抱歉含糊不清，如果您找到更准确的解释，请更新。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-08T14:17:09.567

我之前在扩展或实现特定 api 级别中不可用的类/接口之一时经历过这种情况。它没有以适当的方式说明这一点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-10T03:37:13.340

当有问题的类所依赖的不同类存在验证错误时，我已经看到了这一点。向后滚动，查看完整的 logcat 输出中是否有任何验证错误。

如果 ecm2.android.ActiveStore 依赖于验证失败的类，那么您将得到一个找不到 ecm2.android.ActiveStore 的类，而不是 ecm2.android.ActiveStore 依赖的类。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-07-06T01:59:16.440

如果您有需要在启动时运行的代码（例如 a `BroadcastReceiver`on`BOOT_COMPLETED`或 an `AppWidget`），如果用户已将您的应用程序安装在外部 SD 卡上，您可以得到它。此时可能尚未安装 SD 卡，因此无法加载您的 Application 类。您可以通过将安装模式设置为`internalOnly`或在`BroadcastReceiver`等待广播的情况下解决此问题`ACTION_MEDIA_MOUNTED`。请参阅[android intent 以了解 SD 卡已准备就绪](https://stackoverflow.com/questions/3417161/android-intent-for-sdcard-ready)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-07-06T02:05:16.170

您是否尝试过使用完全限定的包名在清单中引用您的类？

```
.ActiveStore 
```

会成为

```
 com.myapp.package.ActiveStore 
```

您是否有任何机会使用 ProGuard 或任何类似的东西来混淆您的代码？

# c# - 通过 WCF 发送数据

> ID：16047109
> 
> 赞同：0
> 
> 时间：2013-04-16T21:07:07.433
> 
> 标签：c#, wcf

我想知道如何将数据从客户端发送到主机。目前我有 2 个项目和一个 WCF 库。其中一个项目是作为客户端的泵，我希望它能够向主机发送数据？虽然我可能对 WCF 的工作方式有误解。我想知道是否有人能指出我正确的方向。这个问题需要我使用 WCF。我希望能够将字符串列表传递给主机。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T21:15:08.190

WCF 可以通过许多不同的传输协议（如 MSMQ 和 http）发送数据。它还支持消息安全、分布式事务和分布式系统的其他更复杂的功能。

您需要创建一个 WCF 服务，该服务可作为 Visual Studio 中的模板使用。服务器应作为独立程序 os 作为 IIS 中的 Web 应用程序托管。

之后，您需要创建一个可以与服务器通信的客户端。

然而，WCF 是一个庞大而复杂的框架，您不应该期望能够仅仅触及表面并构建一个系统。您需要一些谷歌搜索，并且可能从[MS 自己的教程开始。](http://msdn.microsoft.com/en-us/library/ms734712.aspx)

如果您需要真正有用的答案，您应该更具体地了解您的程序、客户端和服务器操作以及部署方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-01-11T11:47:33.037

正如[faester](https://stackoverflow.com/users/540968/faester)已经说过的，WCF 是一个大型框架，您无法通过将代码复制粘贴到您的项目中来制作一个好的应用程序。您应该真正阅读此事，然后创建您的编程杰作。

[faester](https://stackoverflow.com/users/540968/faester)给了你一个链接，但它用于基本的 WCF 客户端-服务器通信。

以下是一些关于通过 WCF 发送和接收数据的好链接：

1.  [数据传输和架构概述](https://msdn.microsoft.com/en-us/magazine/aa347789(v=vs.110).aspx)
2.  [使用消息类](https://msdn.microsoft.com/en-us/magazine/ms734675(vs.110).aspx)

有关如何发送和接收数据的更简单、面向任务的视图，请参阅： [在服务合同中指定数据传输](https://msdn.microsoft.com/en-us/magazine/ms732038(v=vs.110).aspx)

我希望这将帮助您和尚未解决此问题的人们。

# string - 如何将表示有符号十六进制整数的字符串转换为 80x86 中的有符号整数双字数？

> ID：16047113
> 
> 赞同：0
> 
> 时间：2013-04-16T21:07:19.793
> 
> 标签：string, assembly, x86, hex, ascii

所以我正在上一门汇编语言课程，我被书中的这个问题困住了：使用 windows 32 控制台（所以我可以`io.h`使用），我应该采用用户输入的有效十六进制值，然后显示寄存器中的实际十六进制值`EAX`。所以如果用户输入“AB CD E2 18”，那么程序之后`EAX`会保存这个值：`ABCDE218`。我坚持的部分是`A`-`F`值。例如，如果我使用`A`，我可以获得要读取的位`00000010`，但我不知道如何将其更改为十六进制值`A`。这是我到目前为止所拥有的：

```
.586
.MODEL FLAT
.CODE

hexToInt    PROC
        push   ebp                 ; save base pointer
        mov    ebp, esp            ; establish stack frame
        sub    esp, 4              ; local space for sign
        push   ebx                 ; Save registers
        push   edx
        push   esi
        pushfd                     ; save flags

        mov    esi,[ebp+8]         ; get parameter (source addr)

WhileBlankD:
        cmp    BYTE PTR [esi],' '  ; space?
        jne    EndWhileBlankD      ; exit if not
        inc    esi                 ; increment character pointer
        jmp    WhileBlankD         ; and try again
EndWhileBlankD:

        mov    eax,1               ; default sign multiplier
IfPlusD:cmp    BYTE PTR [esi],'+'  ; leading + ?
        je     SkipSignD           ; if so, skip over
IfMinusD:
        cmp    BYTE PTR [esi],'-'  ; leading - ?
        jne    EndIfSignD          ; if not, save default +
        mov    eax,-1              ; -1 for minus sign
SkipSignD:
        inc    esi                 ; move past sign
EndIfSignD:

        mov    [ebp-4],eax         ; save sign multiplier
        mov    eax,0               ; number being accumulated

WhileDigitD:
        cmp    BYTE PTR [esi],'0'  ; compare next character to '0'
        jb     EndWhileDigitD      ; not a digit if smaller than '0'
        cmp    BYTE PTR [esi],'9'  ; compare to '9'
        ja     TestForHexD      
        mov    bl,[esi]            ; ASCII character to BL
        and    ebx,0000000Fh       ; convert to single-digit integer
        and    eax, ebx
        shl    eax, 4
        inc    esi
        jmp    WhileDigitD
TestForHexD:
        cmp    BYTE PTR [esi], 'F'
        ja     EndWhileDigitD
        mov    bl, [esi]
        sub    bl, 31h
        and    ebx, 000000FFh
        or     al, bl
        shl    eax, 4
        inc    esi                 ; increment character pointer
        jmp    WhileDigitD         ; go try next character
EndWhileDigitD:

; if value is < 80000000h, multiply by sign
        cmp    eax,80000000h       ; 80000000h?
        jnb    endIfMaxD           ; skip if not
        imul   DWORD PTR [ebp-4]   ; make signed number
endIfMaxD:

        popfd                      ; restore flags
        pop    esi                 ; restore registers
        pop    edx
        pop    ebx
        mov    esp, ebp            ; delete local variable space
        pop    ebp 
        ret                        ; exit
hexToInt    ENDP

        END 
```

`TestForHex`标签是我试图将 ASCII 字符串转换为十六进制的地方。我环顾四周，读到我可以通过移位和屏蔽来实现我的目标，但我无法弄清楚，也找不到任何例子。在这一点上，我确信它确实很小，我只是在看，但我被卡住了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T22:09:13.273

您的代码中有一些错误。

首先，在**0 ... 9**字符串到整数的转换代码中，您没有像应该做的那样做 ASCII 到二进制的转换，而是做`and ebx,0Fh`，这是不正确的。您需要从每个 ASCII 字符中减去`'0'`( )，如下所示：`30h`

```
mov bl,[esi]
子 bl,'0' ; 亚 bl,30h

```

然后，也在**0 ... 9**字符串到整数的转换代码：

```
和 eax, ebx

```

如果数字仅由 0...9 位组成，`and eax, ebx`将始终生成 0。它应该是：

```
或 al,bl

```

然后，`shl eax,4`即使您不知道是否会有更多数字，您也会这样做。这意味着这个数字将是应有的 16 倍。

然后，您使用空格给出示例输入，但您的代码没有正确处理空格 ( )，它会结束读取低于( )`20h`的任何值的输入，它似乎只接受前导空格（如果您不想接受，请跳过此之间的空格）。`'0'``30h`

所以，上面的整个代码块应该是：

```
而数字D：
        cmp 字节 ptr [esi], ' ' ; 如果您不希望中间有空格，请删除它。
        je next_char ; 如果您不希望中间有空格，请删除它。
        cmp BYTE PTR [esi],'0' ; 将下一个字符与“0”进行比较
        jb EndWhileDigitD ; 如果小于 '0' 则不是数字
        cmp BYTE PTR [esi],'9' ; 与“9”相比
        ja TestForHexD      
        mov bl,[esi] ; ASCII 字符转 BL

        子 bl,'0' ; sub bl,30h -> 将 ASCII 转换为二进制。

shift_eax_by_4_and_add_bl：
        shl eax,4 ; 将当前值左移 4 位。
        或 al,bl ; 添加当前数字的值。

下一个字符：
        公司
        jmp WhileDigitD

```

我还添加了标签`next_char`和`shift_eax_by_4_and_add_bl`. 原因`next_char`应该很明显，`shift_eax_by_4_and_add_bl`是为了尽量减少 0...9 和 A...F 代码块的重复代码，见下文。

您不会检查十六进制 A...F 数字是否在**A ... F**范围内，只是它**低于或等于 F**。否则它与`shl eax,4`. 并且通常应该避免重复代码，我添加了`shift_eax_by_4_and_add_bl`标签以尽量减少重复代码。

所以我认为应该是：

**编辑：**更正`sub bl,31h`-> `sub bl,('A'-0Ah)`。

```
TestForHexD:
        cmp BYTE PTR [esi], 'A'
        jb EndWhileDigitD
        cmp BYTE PTR [esi], 'F'
        ja EndWhileDigitD
        mov bl,[esi]
        sub bl,('A'-0Ah) ; sub bl,55 -> 将 ASCII 转换为二进制。
        jmp shift_eax_by_4_and_add_bl

```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T22:08:48.607

如果您需要将代表十六进制数字的字符（为简单起见，例如大写）转换为该数字的值，则需要执行以下操作：

```
IF char >= 'A'
  value = char - 'A' + 10
ELSE
  value = char - '0'
ENDIF 
```

如果你需要做相反的事情，你做相反的事情：

```
IF value >= 10
  char = value - 10 + 'A'
ELSE
  char = value + '0'
ENDIF 
```

`0`在这里，您利用了 ASCII 字符通过`9`具有连续 ASCII 码的事实， ASCII 字符`A`通过`F`.

# javascript - 将 HTML 页面加载到 div 中

> ID：16047116
> 
> 赞同：0
> 
> 时间：2013-04-16T21:07:27.577
> 
> 标签：javascript, jquery, html, jqui

我的网站上的以下代码有问题：

```
$(document).ready(function(){   
       $("#gallery").load("html/gallery/gallery.html");
} 
```

当它在 Chrome 中运行时，效果很好，但是当我在 Firefox 中运行我的网站时，它不会加载`gallery.html`页面。

有解决方案吗？

# zend-framework - Zend Navigation 查找页面和渲染菜单及其子页面

> ID：16047118
> 
> 赞同：0
> 
> 时间：2013-04-16T21:07:28.483
> 
> 标签：zend-framework, navigation, acl, findby

我正在为具有 4 个不同访问级别的站点组合 Zend Navigation：Guest、Member1、Member2 和 Admin。

我的导航 XML 看起来像这样：

```
<?xml version="1.0" encoding="UTF-8"?>
<config>
    <nav>
        <default>
            <label>Home</label>
            <controller>index</controller>
            <action>index</action>
            <resource>index</resource>
            <privilege>index</privilege>

            <pages>
                <home>
                    ...
                </home>
                <signin>
                    ...
                </signin>
                <signup>
                    ...
                </signup>
            </pages>
        </default>

        <member1>
            <label>Member1 Main</label>
            <controller>member1</controller>
            <action>index</action>
            <resource>member1</resource>
            <privilege>index</privilege>

            <pages>
                <dashboard>
                    ...
                </dashboard>
                <settings>
                    <label>Settings</label>
                    <controller>auth</controller>
                    <action>editpassword</action>
                    <resource>auth</resource>
                    <privilege>editpassword</privilege>
                    <class>settings</class>
                    <title>User settings</title>

                    <pages>
                        <account>
                            ...
                        </account>
                        <logout>
                            ...
                        </logout>
                    </pages>
                </settings>
            </pages>
        </member1>

        <member2>
            <label>Member2 Main</label>
            <controller>member2</controller>
            <action>index</action>
            <resource>member2</resource>
            <privilege>index</privilege>

            <pages>
                <dashboard>
                    ...
                </dashboard>
                <profile>
                    ...
                </profile>
                <settings>
                    <label>Settings</label>
                    <controller>auth</controller>
                    <action>editpassword</action>
                    <resource>auth</resource>
                    <privilege>editpassword</privilege>
                    <class>settings</class>

                    <pages>
                        <account>
                            ...
                        </account>
                        <logout>
                            ...
                        </logout>
                    </pages>
                </settings>
            </pages>
        </member2>

        <admin>
            <label>Dashboard</label>
            <controller>admin</controller>
            <action>index</action>
            <resource>admin</resource>
            <privilege>index</privilege>

            <pages>
                <dashboard>
                    ...
                </dashboard>
                <logout>
                    ...
                </logout>
            </pages>
        </admin>

    </nav>
</config> 
```

由于我正在使用子菜单并希望顶部菜单保持一致，因此我想使用 Zend 的**findBy**功能来定位当前用户的状态并显示该菜单。这样做是这样的：

```
if ( $this->user ) {
    $submenu = $this->navigation()->findOneByLabel('Member1 Main');
    $options = array(
        'ulClass'               => 'navigation',
        'renderParents'         => true,
        'minDepth'              => null,
        'maxDepth'              => null
    );
    echo $this->navigation()->menu()->renderMenu($submenu, $options);
} else {
    echo $this->navigation()->menu()->setUlClass('navigation')->setOnlyActiveBranch(true)->setMinDepth(1)->setMaxDepth(1);
} 
```

我的 Nav 引导位非常通用，如下所示：

```
function _initNavigation()
{
    $this->bootstrap('layout');
    $layout = $this->getResource('layout');
    $view = $layout->getView();

    $navConfig = new Zend_Config_Xml(APPLICATION_PATH . '/configs/navigation.xml', 'nav');
    $navigation = new Zend_Navigation($navConfig);

    $front     = Zend_Controller_Front::getInstance();
    $myPlagin  = $front->getPlugin('My_Controller_Plugin_Acl');

    $view->navigation($navigation)->setAcl($myPlagin->getMyAcl())
                                 ->setRole($myPlagin->getMyUserRole());
} 
```

现在，我可以让“Member1 Main”页面出现，但它只显示一个页面，但我需要呈现的是该页面的整个子菜单。似乎**findOneByLabel**仅查找该特定页面而不查找其后代。有没有办法拉整个子菜单？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T19:17:39.757

原来我不得不使用**findAllByLabel**来获得预期的结果。谢谢@RockyFord

# javascript - Meteor.js 有什么好的文本编辑器？

> ID：16047120
> 
> 赞同：3
> 
> 时间：2013-04-16T21:07:31.937
> 
> 标签：javascript, meteor

我主要使用 Javascript、HTML 和 CSS 进行编码。

我安装了 Sublime JsFormat 包。它做了很多不必要的突出显示。它并不能真正帮助我找到意外丢失的花括号或丢失的分号。

是否有任何 Javascript 忍者发现他们有良好的工作流程？

# php - 法语的 PHP 和 Mysql 编码错误

> ID：16047125
> 
> 赞同：0
> 
> 时间：2013-04-16T21:07:55.467
> 
> 标签：php, mysql, encoding, utf-8

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T22:28:24.403

在你的`dbconnector.php`，做：

```
$conn->set_charset("utf8"); 
```

连接并选择数据库后。这会将*传输*编码设置为 UTF-8。（table/column/db 字符集只是*存储*编码）。

# node.js - 事件：“关闭”在 Node.js 中如何工作？

> ID：16047126
> 
> 赞同：1
> 
> 时间：2013-04-16T21:08:06.730
> 
> 标签：node.js

我正在尝试使用`close event`Node.js。我对 Node.js 很陌生，所以我不确定这是一个体面的问题还是一个可悲的问题。

文档`close event`： [http ://nodejs.org/api/http.html#http_event_close_2](http://nodejs.org/api/http.html#http_event_close_2)

如果浏览器在到达之前关闭，我想向控制台输出一条消息`end event`。

在服务器运行到 15 秒之前，我尝试关闭浏览器并通过 Chrome 工具终止该进程。没有消息输出到控制台，如果我通过使用其他窗口访问 localhost:8080 打开其他连接，我很快就会得到一个“你好”，表明我的节点服务器认为至少有两个连接。

我要么不了解如何在 Chrome 中终止进程，要么不了解事件关闭的工作方式。

或者如果`End`和`Close`相同 - [node.js https 没有响应“结束”事件，而是“关闭”？](https://stackoverflow.com/questions/6537510/node-js-https-no-response-end-event-close-instead)- 为什么不是我的“他们不耐烦了！” 消息仍然在控制台中输出？

如果进程在事件结束之前结束，你如何输出到控制台？

```
var http = require('http'),
    userRequests = 0;

http.createServer(function(request,response){
userRequests++;

response.writeHead(200, {'Content-Type' : 'text/plain'});

if ( userRequests == 1 ){

    response.write('1st \n');
    setTimeout ( function() {
        response.write('2nd Thanks for waiting. \n');
        response.on('close', function() {

            console.log("They got impatient!");

        });
        response.end();
    }, 15000);
    response.write('3rd \n');
}
else {
    // Quick response for all connections after first user
    response.write('Hello');
    response.end();
}
}).listen(8080, function() {
console.log('Server start');
}); 
```

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T21:25:49.423

首先 - 将关闭消息的事件处理程序移到超时函数之外 - 在超时到期之前，您不会连接关闭处理程序，并且可能会错过事件。

其次，您永远不会在任何地方减少 userRequests；`userRequests--;`某处不应该有一条线吗？这会打破你的逻辑，因为它总是看起来有不止一个请求。

# html - 最后 2 个元素的悬停背景颜色不变

> ID：16047127
> 
> 赞同：0
> 
> 时间：2013-04-16T21:08:11.697
> 
> 标签：html, css

我正在尝试更改处于悬停状态的锚元素的背景颜色，问题是我无法使用下面的样式来实现这一点。

**jsfiddle**

[http://jsfiddle.net/fwP6g/](http://jsfiddle.net/fwP6g/)

**css**

```
 .dropdown ul{
        margin:0; padding:0; float:left; width:100%; 
    }

    .dropdown ul li{
        list-style:none; float:left; width:100%;
    }

    .dropdown ul li a{
        float:left; width: 265px;  height:20px; padding:5px; 
        padding-top:10px; color:#000;  font-size:12px;  
        border-bottom:1px dotted #666;  background-color:#FFF;
    }

    .dropdown ul li a:hover{
        background-color:#F80101;  !important
    }

    .dropdown ul li:last-child a{
        border-bottom:none;
    }

    .dropdown ul li a#pink{
        background-color:#FFE8E8;
    } 
```

**html**

```
<div class="dropdown"> 
     <ul>
            <li><a href="/orders">Orders</a></li>
            <li><a href="/favourites">Favourites</a></li>
            <li><a href="/account" style="background-color:#FFE8E8;">Account</a></li>
            <li><a href="/settings" style="background-color:#FFE8E8;">Settings</a></li>
     </ul>
</div> 
```

我很困惑，我不知道为什么这不起作用，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T21:09:35.427

需要在`!important`收盘前去`;`。

```
.dropdown ul li a:hover {
    background-color:#F80101 !important; 
} 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/fwP6g/1/)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T21:35:19.250

具有相同 id 的两个元素在语义上是不正确的。此外，为您的选择器使用 ids 为规则提供了非常高的优先级，这就是您需要使用`!important`.

我建议给最后 2 个列表项链接一个粉红色的**类**而不是一个 id。

然后你只需要在`.pink`规则之前声明`:hover`规则。由于两个规则具有相同的优先级，并且`:hover`规则在后，它将覆盖该`.pink`规则。

[http://jsfiddle.net/fwP6g/2/](http://jsfiddle.net/fwP6g/2/)

### HTML

```
...
<li><a href="/account" class='pink'>Account</a></li>
<li><a href="/settings" class="pink">Settings</a></li>
... 
```

### CSS

```
.dropdown ul li a.pink{
    background-color:#FFE8E8;
}
.dropdown ul li a:hover{
    background-color:#F80101;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T21:12:16.290

Change your id="pink" to class="pink", than in your css add this to your hover .dropdown ul li a.pink:hover

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-16T21:19:10.440

添加这个：

错误的：

```
.dropdown ul li a:hover{
        background-color:#F80101;  !important
    } 
```

真的：

```
.dropdown ul li a:hover{
        background-color:#F80101 !important;  
    } 
```

# android - 无法控制复合视图中的焦点流

> ID：16047133
> 
> 赞同：3
> 
> 时间：2013-04-16T21:08:41.283
> 
> 标签：android, focus

晚上好（来自瑞典）！我正在构建一个基于几个复合视图（包含一个或多个视图的扩展布局）的 GUI，我似乎无法按顺序获得焦点流。我主要想让键盘上的“下一步”按钮正常工作。目前按下它除了播放点击声音之外什么都不做。我努力了：

```
android:nextFocusRight="@+id/ipDecimal"
android:nextFocusDown="@+id/ipDecimal" 
```

和设置（这里和那里）

```
android:focusable="true" 
```

我究竟做错了什么？我目前的目标是让焦点从第一个 IntegerPicker 流向第二个 IntegerPicker。

这是我目前正在尝试使用的 2 个组件的布局（它们都包含扩展的 FrameLayout）：

```
<?xml version="1.0" encoding="utf-8"?>
<merge xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:custom="http://schemas.android.com/apk/res-auto"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:layout_gravity="center"
android:focusable="true" >

<com.SverkerSbrg.Spendo.Graphics.InsertTransaction.IntegerPicker
    android:id="@+id/ipInteger"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="bottom|center_horizontal"
    custom:NumberSize="40"
    custom:TextAlignRight="true"
    android:focusable="true"
    custom:maxNrOfDigits="3"
    android:nextFocusRight="@+id/ipDecimal"
    android:nextFocusDown="@+id/ipDecimal">
    <requestFocus />
</com.SverkerSbrg.Spendo.Graphics.InsertTransaction.IntegerPicker>

<TextView
    android:id="@+id/tvDot"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="bottom|center_horizontal"
    android:text="."
    android:textAppearance="?android:attr/textAppearanceLarge"
    android:textSize="30sp"
    tools:ignore="HardcodedText" />

<com.SverkerSbrg.Spendo.Graphics.InsertTransaction.IntegerPicker
    android:id="@+id/ipDecimal"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="bottom|center_horizontal"
    android:focusable="true"
    custom:NumberSize="20"
    custom:TextAlignRight="false"
    custom:maxNrOfDigits="2" >
</com.SverkerSbrg.Spendo.Graphics.InsertTransaction.IntegerPicker>

<TextView
    android:id="@+id/tvSpace"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="bottom|center_horizontal"/>

<com.SverkerSbrg.Spendo.Graphics.InsertTransaction.CurrencyPicker
    android:id="@+id/icCurrency"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    custom:textSize="20"
    android:layout_gravity="bottom|center_horizontal">
</com.SverkerSbrg.Spendo.Graphics.InsertTransaction.CurrencyPicker>

</merge> 
```

.

```
<?xml version="1.0" encoding="utf-8"?>
<merge xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:focusable="true"
 >

<EditText
    android:id="@+id/etInteger"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="center"
    android:inputType="number"
    android:background="#00000000"
    android:selectAllOnFocus="true"
    android:focusable="true"
    android:hint="00">
</EditText>
</merge> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T21:24:03.407

经过数小时尝试不同的修复令人沮丧，例如将焦点传递到正确视图的不可见 EditTexts。

如果发现我可以得到想要的结果，请从键盘上的下一个按钮购买捕捉事件。

这是通过 OnEditorActionListener 完成的。

# javascript - ko.observableArray 和 JSON 数据按摩

> ID：16047142
> 
> 赞同：0
> 
> 时间：2013-04-16T21:09:34.653
> 
> 标签：javascript, asp.net, knockout.js

我正在使用 Web 服务将数据加载到客户端。出于绑定目的，我需要扩展我获得的数据。即我不想按摩服务器端的所有数据。

例如，对象`Trip { Id: "123", Status: "P" }`

在 HTML 中，我绑定`table`到 observableArray 并希望显示“Pending”而不是“P”。我来自 Silverlight/MVVM，通常您会使用转换器或只是将新的 R/O 属性添加到对象。

不确定在 knockout.js 中应该如何处理这种情况

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T21:31:04.730

你可以在这里找到你需要的一切：

[http://net.tutsplus.com/sessions/knockout-简洁/](http://net.tutsplus.com/sessions/knockout-succinctly/)

好好读书。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T21:35:40.367

如果你只是在寻找一个转换器，那么`computed`observables 是一个不错的选择。

```
var Tip = function(data) {
    var self = this;
    self.id = data.id;
    self.status = ko.observable(data.status);

    //You may prefer fullStatus, or statusName
    self.statusConverter = ko.computed(function() { 
        return self.statusMap[self.status()];
    });
};

Tip.prototype.statusMap = {
    P: "Pending",
    O: "Open",
    C: "Closed"
}; 
```

你可以像这样绑定：

```
<td data-bind="text: statusConverter"></td> 
```

你可以在[这个小提琴中看到它](http://jsfiddle.net/tyrsius/eHrEB/3/)

# visual-studio - 对 csproj 文件中的内容项使用 $(PlatformTarget)

> ID：16047143
> 
> 赞同：0
> 
> 时间：2013-04-16T21:09:35.287
> 
> 标签：visual-studio, msbuild

我想对我的 .csproj 文件中的某些内容项使用选定的平台目标 - $(PlatformTarget)。

例如：

```
<Content Include="Plugins\$(PlatformTarget)\Plugins.dll">
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
</Content> 
```

在 VS 中打开此项目时，似乎尚未解析平台目标属性（该文件似乎不存在）。

有什么办法可以克服这个吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T22:08:30.413

你的意思是`$(Platform)`？

```
<Content Include="Plugins\$(Platform)\Plugins.dll">
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
</Content> 
```

# vim - 在 MacVim 中禁用铃声

> ID：16047146
> 
> 赞同：17
> 
> 时间：2013-04-16T21:09:39.737
> 
> 标签：vim, notifications, macvim

我知道这个话题已经被问过很多次了。但我似乎无法禁用 MacVim 中的响铃。我的 .vimrc 中有什么：

```
set noerrorbells 
set novisualbell
set t_vb= 
```

我错过了什么吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-04-16T21:13:53.247

这应该是缺失的部分：

```
autocmd! GUIEnter * set vb t_vb= 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-09-24T13:12:16.580

对于由于某种原因无法完成这项工作的任何人。

`set vb t_vb= " no visual bell & flash`

为我完成了这项工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-05-29T09:00:18.320

即使 `set belloff=all`在你的 .vimrc

# mysql - 这个带有 HAVING MAX 的查询实际上是如何正常工作的？

> ID：16047148
> 
> 赞同：0
> 
> 时间：2013-04-16T21:09:45.750
> 
> 标签：mysql, sql, select, join, having

我有 2 个简单的表：`students(sno,sname,age)`和`take(sno,cno)`. `Take`是`N-N`学生和课程之间的关系表。
我想找到没有参加特定课程的学生。

以下查询可以完成这项工作，但我不清楚它是如何工作的：

```
SELECT s.sno,s.sname,s.age  
FROM students s LEFT JOIN take t  
ON (s.sno = t.sno)  
GROUP BY s.sno,s.sname,s.age  
HAVING MAX(CASE WHEN t.cno = 'CS112' THEN 1 ELSE 0 END) = 0; 
```

它与`MAX`AND`HAVING`的处理顺序有关吗？

一个简单的方法是使用子查询：

```
SELECT * FROM students  
WHERE sno NOT IN  
(SELECT sno FROM take WHERE cno = 'CS112'); 
```

但我有兴趣了解使用的版本`JOIN`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T21:14:02.410

如果有课程，则`CASE`内部`MAX`产生 1，如果没有课程，则产生 0。`MAX`对每一行取`CASE`1，如果学生有任何行的值为 1（意味着他们有班级），则为 1，否则为 0。通过说他们必须`HAVING`，`MAX` `> 1`你是说他们必须上课。以最复杂的方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T21:43:01.037

`max()`如果您将 替换为，这可能更容易理解`sum()`。

考虑这个`select`陈述：

```
SELECT s.sno, s.sname,s.age, SUM(CASE WHEN t.cno = 'CS112' THEN 1 ELSE 0 END) as NumCS112 
```

新列 NumCS112 包含学生参加课程的次数。接下来，将其放入`having`子句中：

```
HAVING NumCS112 = 0 
```

嗯，这意味着学生参加课程的次数为 0 —— 所以学生没有参加课程。

你可以用 做同样的事情`max()`，你得到一个标志而不是计数。所以：

```
SELECT s.sno, s.sname,s.age, MAX(CASE WHEN t.cno = 'CS112' THEN 1 ELSE 0 END) as HasTaken_CS112
. . .
HAVING HasTaken_CS112 = 0 
```

但是，您在`select`子句中没有表达式，因此您不能使用`HasTaken_CS112`. 相反，您必须使用完整的表达式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T21:12:23.783

The MAX ensures that if only one of the classes the student is taking is CS112, then it fails the HAVING statement and won't return that student.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-16T21:20:02.943

您可以在 JOIN 条件中添加 cno 过滤器而不是 where，并在连接的 RIGHT 部分中查找 NULL 值（表示不匹配）。

```
SELECT s.sno, s.sname, s.age
FROM students s LEFT JOIN take t
ON s.sno = t.sno AND t.cno = 'CS112'
WHERE t.cno IS NULL 
```

由于 cno 上的过滤器处于 JOIN 条件中，因此它实际上不会过滤掉学生（与 WHERE 子句中的过滤器相反）。在不匹配的情况下，连接的 Take 部分将包含 NULL，然后我们对其进行过滤（过滤掉学生确实参加过课程的情况）。

# java - Eclipse 未将库的私有成员名称与附加源链接

> ID：16047149
> 
> 赞同：5
> 
> 时间：2013-04-16T21:09:46.990
> 
> 标签：java, eclipse

使用 Eclipse 3.7.2 处理 Java 项目。

1.  我在构建路径中添加了一个包含第三方库二进制文件的 jar。
2.  我`Source attachment`将此库的设置为包含源的 jar。

当我从这个库转到其中一个类时，源代码正确显示。但是，**私有成员没有在大纲视图中命名，也没有在** `Ctrl`+`o` **对话框中命名，如果不使用对话框，我无法导航到它们`Find/Replace`。** 它们由字母表中的字母（`a`、`b`、`c`等）按照它们在类中声明的顺序进行引用，但是在大纲选项卡中单击这些字母不会让我看到它们在源代码中的声明。这适用于私有字段和私有方法。

有什么配置可以解决这个问题吗？

**例子：**

![在此处输入图像描述](https://i.stack.imgur.com/UaeCs.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-01T20:40:17.200

这个库中的私有方法已经被混淆了，你无法看到这个。如果该库是开源的，您可以自己重新编译它而不会混淆，但这些方法很可能被有意地隐藏起来。考虑到私有方法/变量/字段无论如何都不能从库外部访问，这并不是一件可怕的事情。您自己无法访问这些方法或字段中的任何一个，因此从长远来看它不应该有所作为。

# c++ - 在c ++中将矩阵/二维数组复制到另一个数组

> ID：16047152
> 
> 赞同：2
> 
> 时间：2013-04-16T21:10:01.970
> 
> 标签：c++, multidimensional-array

我正在尝试将二维数组复制到另一个二维数组中，我创建了这两个数组：

```
#define mapXcor 50
#define mapYcor 50

char secondStage    [mapXcor][mapYcor];
char currentStage   [mapXcor][mapYcor];
//mapXcor and mapYcor are constant integers 
```

现在我的`secondStage[][]`数组上填充了值，但`currentStage[][]`不是，我想分配 to 的`secondStage`值`currentStage`。所以我创建了下面的函数：

```
void populateArray(char (&arrayA)[mapXcor][mapYcor], char arrayB[mapXcor][mapYcor]) {
    for(int a = 0; a < mapXcor + 1; ++a) {
        for(int b = 0; b < mapYcor + 1; ++b) {
            arrayA[mapXcor][mapYcor] = arrayB[mapXcor][mapYcor];
        }
    }
}

populateArray(currentStage[mapXcor][mapYcor],secondStage[mapXcor][mapYcor]); 
```

但是当我使用该功能时，它给了我一个错误：

> 1 IntelliSense：“char (&)[20][50]”类型的引用（非 const 限定）不能用“char”类型的值初始化
> 
> 2 IntelliSense：“char”类型的参数与“char (*)[50]”类型的参数不兼容

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T21:14:23.750

更改 for 循环中的赋值语句：

```
arrayA[mapXcor][mapYcor] = arrayB[mapXcor][mapYcor]; 
```

经过

```
arrayA[a][b] = arrayB[a][b]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T21:50:55.987

您可能正在尝试访问的代码。不要给老师看 :-) - 实际编程的内容太多了。只需查看然后编写您自己的解决方案：

```
#include <string.h>
#include <stdio.h>

#define mapXcor 5
#define mapYcor 5

static char secondStage    [mapXcor][mapYcor];
static char currentStage   [mapXcor][mapYcor];

void populateArray(char (&arrayA)[mapXcor][mapYcor], const char (&arrayB)[mapXcor][mapYcor]) {
/*
    for(int a = 0; a < mapXcor; ++a) {
        for(int b = 0; b < mapYcor; ++b) {
            arrayA[a][b] = arrayB[a][b];
        }
    }
*/
    memcpy(arrayA, arrayB, sizeof(arrayB));
}

int main()
{
    for(int a = 0; a < mapXcor; ++a) {
        for(int b = 0; b < mapYcor; ++b){
            currentStage[a][b] = a*b + 10*a;
        }
    }

    populateArray(secondStage, currentStage);

    for(int a = 0; a < mapXcor; ++a) {
        for(int b = 0; b < mapYcor; ++b){
            printf("%2i ", secondStage[a][b]);
        }
        printf("\n");
    }

    return 0;
} 
```

注释：

*   您在循环中有错误的数组索引限制。在评论下寻找更正的功能。
*   您在循环分配中有错误的索引。再次，注释掉代码。
*   如果您通过引用（目标）传递一个数组，为什么不对源使用常量引用？
*   实际上，由于您的区域具有相同的类型（您甚至可以将它们定义为具有相同的类型），因此没有人按元素复制它们。我使用过 memcpy() 但这只有在内存区域不重叠时才有用（在这种情况下 - 是的）。检查`man 3 memcpy`。
*   **努力学习:-)**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-03-20T14:31:14.010

```
#define ROWS 2
#define COLS 2

void copyArray(char (&arrayA)[ROWS][COLS], const char (&arrayB)[ROWS][COLS] ) {

    memcpy(arrayA, arrayB, sizeof(arrayB));
}

int main(void){

    char arr1  [ROWS][COLS];
    char arr2  [ROWS][COLS];

    // init arr1
    copyArray(arr2, arr1);

    return 0;
} 
```

# ios - IBOutlet 引用了两个故事板

> ID：16047155
> 
> 赞同：3
> 
> 时间：2013-04-16T21:10:08.210
> 
> 标签：ios, objective-c, xcode, ios6, uistoryboard

我在同一个目录中有两个使用非常相似的名称的 XCode 项目。我注意到在一个项目中创建一个与第二个项目中的另一个 IBOutlet 同名的 IBOutlet 时，IBOutlet 链接并引用了两个故事板。现在这让我很困扰，我想知道如何解决这个问题，以便它只引用它当前的项目故事板。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T21:14:45.117

> 我在同一个目录中有两个 XCode 项目

在同一个目录中？这可能会带来麻烦，因为项目使用相对引用来引用其文件。*请*每个项目文件夹一个项目！

编辑：那个答案原来是完全虚假的。实际上，这只是 Xcode 临时现象之一。清除派生数据文件夹修复了它，如下所述：

[如何清空缓存并清理所有目标 Xcode 4](https://stackoverflow.com/questions/5714372/how-to-empty-caches-and-clean-all-targets-xcode-4/6247073#6247073)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-28T19:50:06.263

我看到了完全相同的问题。自从我开始使用 Xcode 4 以来它就一直存在，并且仍然存在于 Xcode 6 中。

当我将控制器文件复制到新项目并且我同时打开两个项目时会出现这种情况。一个插座似乎连接到两个故事板。

清除 Derived Data 文件夹和 /var/folders 的内容并不能解决这个问题。重新启动 Xcode 也不会。我还尝试在其中一个项目中重命名情节提要，但无济于事。

我找到的唯一解决方案是确保控制器的名称是唯一的。这可以通过使用唯一的项目前缀轻松完成。我想唯一命名的网点也可以解决这个问题，但这要跟踪起来要困难得多。

# flask - 普通 Flask-Restless 应用程序上的 HTTP 404 错误

> ID：16047160
> 
> 赞同：1
> 
> 时间：2013-04-16T21:10:40.733
> 
> 标签：flask, flask-restless

我已经安装了[Flask-Restless](http://flask-restless.readthedocs.org/en/latest/)并正在尝试运行[快速启动应用程序](http://flask-restless.readthedocs.org/en/latest/quickstart.html)。所有请求都返回 404 错误（在 python 日志和 curl 响应中）。我的整个设置是：

```
$ virtualenv venv --distribute
$ source venv/bin/activate
$ pip install flask-restless
$ pip install flask-sqlalchemy # it doesn't appear to do this automatically
... Copy code from quickstart to "run.py" ...
$ python ./run.py

(another window)
$ curl -i http://127.0.0.1:5000/ 
```

run.py 的控制台输出是：

```
 * Running on http://127.0.0.1:5000/
 * Restarting with reloader
127.0.0.1 - - [16/Apr/2013 17:08:05] "GET / HTTP/1.1" 404 - 
```

确实被`test.db`创建了，并且使用调试器我可以看到它`app.run()`确实执行了。

[有趣的是，我得到与Eve](http://python-eve.org/)完全相同的行为。但是，我能够运行简单的 Flask 应用程序。

如果重要的话，这是 OS X 10.8 和 Python 2.7.3。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T21:21:41.897

从 Flask-Restless[文档](http://flask-restless.readthedocs.org/en/latest/basicusage.html)中...

> 默认情况下，在上述代码示例中，Person 的 API 可以在 访问`http://<host>:<port>/api/person`，其中 URL 的 person 部分是 的值`Person.__tablename__`：

我的猜测是，默认情况下，这些框架不会在路径上设置端点`/`。它们只为与 API 中的实际对象相关的路径定义了端点。尝试以下...

```
curl -i http://127.0.0.1:5000/api/person
curl -i http://127.0.0.1:5000/person 
```

这些 URL 可能实际上会命中您定义的端点。

# android - 我有一个包含多个 ListViews 的 ViewPager，我在哪里监听被点击的项目？

> ID：16047163
> 
> 赞同：2
> 
> 时间：2013-04-16T21:11:00.760
> 
> 标签：android, listview, click, android-viewpager, onitemclick

我有一个活动，其中包含我的列表适配器和视图寻呼机适配器的类以及您的标准活动功能。

结果是能够在多个列表中滑动。

我不确定在哪里听项目点击。在主要活动中？在列表适配器中？查看寻呼机适配器？如何？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T21:15:16.637

对于每个`ListView`你必须`OnItemClickListener`在你的`ViewPagerAdapter`. 您可以为每个创建一个单独的侦听器`ListView`，或者给每个`ListView`标签一个标签并使用一个侦听器来检查标签并做出相应的响应。

# javascript - 在分组元素上使用 D3 拖动

> ID：16047167
> 
> 赞同：0
> 
> 时间：2013-04-16T21:11:09.443
> 
> 标签：javascript, json, d3.js

我正在尝试使用 d3.behavior.drag 函数将文本/形状拖到不同的位置。最终，当新位置从原来的位置移动到由 Ruby on rails 运行的 SQL DB 时，我希望保存新位置的变量。

但是，在我尝试当前代码的那一刻，文本/形状并没有移动，而是似乎在同一位置复制：

```
 var drag = d3.behavior.drag()
                      .origin(Object)
                      .on("drag", function(d) {
                        d.x = d3.event.x;
                        d.y = d3.event.y;
                       draw();
                    }); 
```

然后我的文本/形状和位置有一个“绘图”功能

```
 function draw() { 

               // code is within here - check fiddle

                 }

                  draw() 
```

我开始相信它不起作用，因为我在我的对象中使用 translate 而不是 x & Y：

```
 var node= [ {name:'amy', country: 'USA', 'translate:"translate(190,83)"}] 
```

我见过的一些例子有这个：

```
 var node= [ {name:'amy', country: 'USA', x: 100, y:0}] 
```

我也尝试过这种方式，但是当我拖动形状时，它会留下重复形状的痕迹。

如果有人能解释为什么会发生这种情况，我将不胜感激/

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T22:05:54.083

将所有节点的平移更改为 x 和 y 并更改

```
node= node.enter().append("g")
                .call(drag) 
```

至

```
 node.enter().append("g")
            .call(drag)
           .attr('class', 'node'); 
```

工作小提琴：http: [//jsfiddle.net/Zc4z9/5/](http://jsfiddle.net/Zc4z9/5/)

您可能需要查看此 bl.ocks.org/mbostock/3808218 以确保您了解 .enter() [以及 .transition() 和 .exit()]

# kml - 拆分一个巨大的 kml 文件

> ID：16047168
> 
> 赞同：3
> 
> 时间：2013-04-16T21:11:15.763
> 
> 标签：kml

我有一个具有以下结构的巨大 kml 文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://www.opengis.net/kml/2.2">
  <Document>
    <Style id="transBluePoly">
      <LineStyle>
        <width>1.5</width>
      </LineStyle>
      <PolyStyle>
        <color>30ffa911</color>
      </PolyStyle>
    </Style>
    <Style id="labelStyle">
       <IconStyle>
          <color>ffffa911</color>
          <scale>0.35</scale>
       </IconStyle>
       <LabelStyle>
         <color>ffffffff</color>
         <scale>0.35</scale>
      </LabelStyle>
    </Style>
    <Placemark>
      <name>9840229084|2013-03-06 13:41:34.0|rent|0.0|2|0|0|1|T|5990F529FB98F28A1F17D182152201A4|0|null|null|null|null|null|null|null|null|null|null|F|F|0|NO_POSTCODE</name>
      <styleUrl>#transBluePoly</styleUrl>
      <Polygon>
        <outerBoundaryIs>
          <LinearRing>
            <coordinates>
            -1.5191200,53.4086600
            -1.5214300,53.4011900
            -1.5303600,53.4028800
            -1.5435800,53.4033900
            -1.5404900,53.4083600
            -1.5191200,53.4086600
            </coordinates>
          </LinearRing>
        </outerBoundaryIs>
      </Polygon>
    </Placemark>
    <Placemark>
      <name>9840031669|2013-03-06 13:14:22.0|rent|0.0|0|0|0|1|F|E5BAC836984F53F91D7F60F247920F0C|0|null|null|null|null|null|null|null|null|null|null|F|F|3641161|DE4 3JT</name>
      <styleUrl>#transBluePoly</styleUrl>
      <Polygon>
        <outerBoundaryIs>
          <LinearRing>
            <coordinates>
            -1.2370933,53.1227587
            -1.2304837,53.1690463
            -1.1783129,53.2226956
            -1.2016444,53.2833233
            -1.3213687,53.3248921
            -1.4809916,53.3039582
            -1.6167192,53.2438689
            -1.5593782,53.1336370
            -1.4296123,53.0962399
            -1.3205129,53.1024090
            -1.2370933,53.1227587
            </coordinates>
          </LinearRing>
        </outerBoundaryIs>
      </Polygon>
    </Placemark> 
```

我需要从中提取 100 万个多边形以使其易于管理（知道 geo DB 是最终解决方案 - 寻找快速修复）。

将它加载到轻量级文本编辑器中并删除一些行将是我的第一个停靠点，但怀疑这将需要永远和一天的时间（它是 10 Gb，我有 16 Gb RAM）。只是想知道是否有来自 linux 终端的更智能的解决方案，可以避免将其全部读入 RAM。我已经看到 perl 和 bash 命令执行此操作，但看不到它们如何用于获取随机（或第一百万）样本：[http ://www.unix.com/shell-programming-scripting/159470-filter -kml-file-xml-remove-unwanted-entries.html](http://www.unix.com/shell-programming-scripting/159470-filter-kml-file-xml-remove-unwanted-entries.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-06-29T16:44:25.060

您可以使用 KML 解析库和几行代码来解析大型 KML 或 KMZ 文件中所需的内容。

**爪哇**

例如，[GIScore Java 库](https://github.com/OpenSextant/giscore)使用 STaX 一次解析 KML 源文件一个特征，因此它不需要将整个文件加载到内存中。该库运行速度非常快，因此 10GB 不会花费很长时间。

这是一个简单的 Java 程序，它从 KML 文件中的多边形中提取点，无论 KML 文件有多大，也不管 Placemark 是否深深嵌套在文件夹中。

```
import org.opensextant.geodesy.Geodetic2DPoint;
import org.opensextant.giscore.events.*;
import org.opensextant.giscore.geometry.*;
import org.opensextant.giscore.input.kml.KmlInputStream;

import java.io.FileInputStream;
import java.io.IOException;
import java.text.DecimalFormat;

public class Test {

  public static void main(String[] args) throws IOException {
    KmlInputStream kis = new KmlInputStream(new FileInputStream("test.kml"));
    IGISObject obj;
    DecimalFormat df = new DecimalFormat("0.0#####");
    while((obj = kis.read()) != null) {
      if (obj instanceof Feature) {
        Feature f = (Feature)obj;
        Geometry g = f.getGeometry();
        if (g instanceof Polygon) {
          System.out.println("Points");
          for(Point p : ((Polygon)g).getOuterRing().getPoints()) {
            // do something with the points (e.g. insert in database, etc.)
            Geodetic2DPoint pt = p.asGeodetic2DPoint();
            System.out.printf("%s,%s%n",
                    df.format(pt.getLatitudeAsDegrees()),
                    df.format(pt.getLongitudeAsDegrees()));
          }
        }
      }
    }
    kis.close();
  }
} 
```

要运行，在目录 src/main/java 中创建源文件 Test.java 并将上面的代码复制到文件中。

如果 Geometry 是[MultiGeometry](https://developers.google.com/kml/documentation/kmlreference#multigeometry)，那么您需要为此添加检查并迭代子几何。

使用 Gradle，这里有一个示例*build.gradle*脚本，使用以下命令运行上述测试程序：*gradle run*

```
apply plugin: 'java'

repositories {
    mavenCentral()
}

task run (dependsOn: 'compileJava', type: JavaExec) {
    main = 'Test'
    classpath = sourceSets.main.runtimeClasspath
}

dependencies {
    compile 'org.opensextant:geodesy:2.0.1'
    compile 'org.opensextant:giscore:2.0.1'
} 
```

这确实需要您同时安装[Gradle](http://www.gradle.org/)和[Java 开发工具包](http://www.oracle.com/technetwork/java/javase/downloads/index.html)(JDK)。

**Python**

或者，您可以使用 Python 和[pykml](https://pythonhosted.org/pykml/)库来解析 KML。可以使用一些逻辑创建多个较小的 KML 文件以分割多边形或将多边形几何特征插入 PostgreSQL 数据库等。stackoverflow 中使用[pykml](/questions/tagged/pykml "显示标记为“pykml”的问题")标签支持 pykml。

```
from pykml import parser
import re

with open('data.kml', 'r') as fp:
  doc = parser.parse(fp)

for pm in doc.getroot().Document.Placemark:
  print(pm.name)
  # Get the coordinates from either polygon or polygon inside multigeometry
  if hasattr(pm, 'MultiGeometry'):
    pm = pm.MultiGeometry
  if hasattr(pm, 'Polygon'):
    pcoords = pm.Polygon.outerBoundaryIs.LinearRing.coordinates.text
    # extract coords into a list of lon,lat coord pairs
    coords = re.split(r'\s+', pcoords.strip())
    for coord in coords:
        lonlat = coord.split(',')
        if len(lonlat) > 1:
            print(lonlat[0], lonlat[1])
            # add logic here - insert points into DB, etc. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-06T23:19:37.363

这可能为时已晚，但对您有一些想法。

传统上，我使用通配符搜索在 Microsoft Word 中修改了此类代码块。虽然您的文件对于 Word 来说可能太大，但这些概念可以与其他类似工具一起使用。

我取了你文件的一个块并执行了三个搜索和替换 (1) 以获取名称并将其插入 " 标记中，(2) 删除中间字符块并将它们替换为 = char 和 (3) 到删除最后的代码块。

它是这样工作的：

（我实际上做了一些整理以首先删除空格 - 这些可能是本网站的人工制品，而不是代码本身）

```
Replace  [<]Placemark[>][<]name[>](**)[<]/name[>]   by   “\1”

Replace  [<]styleUrl(**)[<]coordinates[>]             by   =

Replace  [<]/coordinates(**)[<]Placemark[>]         by   nothing 
```

使用一些字符作为转义符需要方括号来停止单词（我可能经常使用它们？）

(**) 序列捕获这些组之间的所有内容，并为它们提供用于替换字段的标签 \1。

从理论上讲，您应该能够将这三个一起使用，但这会给 Word 带来过于复杂的表单错误，直到您回到基础并减少代码。所以：

```
Replace [<]Place**name[>](**)[<]/name**nates[>](**)[<]/coord**mark[>] by "\1"=\3 
```

实际上会起作用。

当然，您可以轻松地将结果的格式更改为您想要的格式（即不在输出中使用 " 或 = ），并使用进一步的搜索和替换，您可以操纵输出，为您想要的任何包做好准备。

通配符搜索和替换很有趣！

鲍勃·J。

PS 我使用这个概念在 Word vba 中编写了一个编译器，从 Excel 中获取一系列文本字符串，这些字符串包含基本的映射数据并将它们转换为完全可操作的 kml 文件。当前输入文件超过 2500 行超过 200k 个字符，并生成一个 700k kml 文件，分布在近 19,000 行上。“编译”大约需要 30 秒。这与你的情况相反。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2017-05-06T15:44:03.927

我有点晚了，但这个答案可能会对某人有所帮助。您可以使用 FME DESKTOP 这个巨大的软件完美地分割 kml 文件！使用 ModuloCount 转换器。检查[拆分 kml 文件 ModuloCount](https://knowledge.safe.com/questions/32257/split-single-kml-into-multiple-kml-files-with-equa.html)

# mysql - MYSQL UPDATE 日期字段不起作用

> ID：16047169
> 
> 赞同：0
> 
> 时间：2013-04-16T21:11:19.697
> 
> 标签：mysql, date, sql-update

为什么这不起作用：

```
USE presentations_db; UPDATE presentations_tbl SET `date` = '2012-12-13' WHERE `date` = '2013-12-12' 
```

我已经尝试了所有我能找到的答案。

date 是根据需要使用的字段名称`back ticks`。date 是 DATE 数据类型。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T08:54:06.763

我设法让它通过命令行运行。我点击“命令行客户端”，它要求输入密码。然后我运行 sql 语句并得到以下结果：

```
mysql> UPDATE `presentations_db`.`presentations_tbl`SET date_ = '2012-12-13' WHERE date_ = '2013-12-12';
Query OK, 16 rows affected (0.06 sec) Rows matched: 16 Changed: 16 Warnings: 0 
```

当我尝试通过简单地通过 shell 运行 mysql 来运行相同的查询时，它出现了一个错误，即 db 无法由 localhost 编辑，这比“查询中断”更具解释性。这似乎是以前在[http://bugs.mysql.com/bug.php?id=67766](http://bugs.mysql.com/bug.php?id=67766)中介绍的一个抱怨。如果有人能告诉我我在工作台 gui 中做错了什么，那就太好了。尝试运行查询时，我通常会执行以下操作。我单击“编辑表数据”并选择数据库和表。似乎我可以查看和运行选择查询，但不能更新查询。

# ios - How to convert a stream of flash content into HTML 5?

> ID：16047170
> 
> 赞同：0
> 
> 时间：2013-04-16T21:11:22.687
> 
> 标签：ios, html, flash, google-swiffy

I am familar with google's [swiffy tool](http://googlecode.blogspot.co.il/2011/06/swiffy-convert-swf-files-to-html5.html) and [macvide](http://www.macvide.com/Macvide_FlashVideo_Converter/). My question is How can I use one of them or any other tool to convert stream in flash into HTML5 video `on the fly`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-21T22:06:00.403

我想你手头有一个基于 Flash 的视频播放器。这是一个加载和播放视频流的 swf。您不应该尝试将该 swf 转换为 Swiffy，而只需使用像 VideoJS 这样的 HTML5 视频播放器来播放视频。

# javascript - 未捕获的 TypeError 实现 Fuelux 向导

> ID：16047174
> 
> 赞同：6
> 
> 时间：2013-04-16T21:11:32.623
> 
> 标签：javascript, jquery, twitter-bootstrap, fuelux

我正在尝试实现 Fuelux 的向导功能并且遇到了障碍。我只是想获得[现场示例](http://exacttarget.github.io/fuelux/#wizard)的工作副本，但在我的控制台中不断收到错误：

```
Uncaught TypeError: Object [object Object] has no method 'wizard' 
```

我发现很多文档有点压倒性，并且希望用简单的[或更简单的]英语对这个主题有一些清晰的了解。

我的标记是：

```
<!DOCTYPE html>
<html class="no-js fuelux">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>E-Learning</title>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/fuelux.min.css">
    <link rel="stylesheet" href="css/main.css">
</head>
<body>
    <div class="container">
        <div id="my-wizard" class="wizard">
            <ul class="steps">
                <li data-target="#step1" class="active"><span class="badge badge-info">1</span>Step 1<span class="chevron"></span></li>
                <li data-target="#step2"><span class="badge">2</span>Step 2<span class="chevron"></span></li>
                <li data-target="#step3"><span class="badge">3</span>Step 3<span class="chevron"></span></li>
                <li data-target="#step4"><span class="badge">4</span>Step 4<span class="chevron"></span></li>
                <li data-target="#step5"><span class="badge">5</span>Step 5<span class="chevron"></span></li>
            </ul>
            <div class="actions">
                <button class="btn btn-mini btn-prev"> <i class="icon-arrow-left"></i>Prev</button>
                <button class="btn btn-mini btn-next" data-last="Finish">Next<i class="icon-arrow-right"></i></button>
            </div>
        </div>
        <div class="step-content">
            <div class="step-pane active" id="step1">
                ...
            </div>
            <div class="step-pane" id="step2">
                ...
            </div>
            <div class="step-pane" id="step3">
                ...
            </div>
        </div>
    </div>
    <script src="js/vendor/jquery-1.9.1.min.js"></script>
    <script src="js/bootstrap.js"></script>
    <script src="js/require.js"></script>
    <script src="js/wizard.js"></script>
    <script>
        $(document).ready(function(){

            $('#my-wizard').on('change', function(e, data) {
                console.log('change');
                if(data.step===3 && data.direction==='next') {
                    // return e.preventDefault();
                }
            });

            $('#my-wizard').on('changed', function(e, data) {
                console.log('changed');
            });

            $('#my-wizard').on('finished', function(e, data) {
                console.log('finished');
            });

            $('.btn-prev').on('click', function() {
                console.log('prev');
                $('#my-wizard').wizard('previous');
            });

            $('.btn-next').on('click', function() {
                console.log('next');
                $('#my-wizard').wizard('next','foo');
            });
        });
    </script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-18T11:43:58.457

很近！对于 CSS 和 JS，因为 Fuel UX 包含 Bootstrap，您只需包含 Fuel UX 来代替 Boostrap，您就可以获得所有 Bootstrap 和 Fuel UX：

```
<link rel="stylesheet" href="https://fuelcdn.com/fuelux/2.3/css/fuelux.min.css">
<script src="https://fuelcdn.com/fuelux/2.3/loader.min.js"></script> 
```

您的模板看起来很棒，并且仅进行了上述修改，加上删除了导致双重处理的几行，这可以按预期工作。在此处查看完整示例：

要点：[https ://gist.github.com/adamalex/5412079](https://gist.github.com/adamalex/5412079)

现场示例：[http ://bl.ocks.org/adamalex/5412079](http://bl.ocks.org/adamalex/5412079)

# google-maps - 如何在 Google 地图上覆盖英国地区边界

> ID：16047175
> 
> 赞同：1
> 
> 时间：2013-04-16T21:11:32.773
> 
> 标签：google-maps, google-maps-api-3

我想要做的一个例子是[http://yourtaximeter.com/main/home#/main/home](http://yourtaximeter.com/main/home#/main/home)。如果您搜索曼彻斯特到利兹，您会看到它以粉红色突出显示曼彻斯特所覆盖的地区。

当您选择 Salford 作为发件人地址时，它将突出显示 Salford 区。我不太确定从哪里开始。

这是我的意思的屏幕截图：

![在此处输入图像描述](https://i.stack.imgur.com/A2IiQ.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T22:42:28.243

您需要一个资源，您可以在其中获取该区域的边界并基于它创建一个多边形。

在这种特殊情况下，这些数据是通过 AJAX 向[http://yourtaxmeter.com/api/](http://yourtaximeter.com/api/)的请求返回的，当您检查响应时，您会看到`district.enc`返回对象的 -property 包含定义轮廓的编码折线对于突出显示的区域。

# java - 在带有 Java/JDBC 的 Oracle PL/SQL 中使用游标并获取结果

> ID：16047179
> 
> 赞同：6
> 
> 时间：2013-04-16T21:11:40.950
> 
> 标签：java, sql, oracle, jdbc, plsql

我有一个这样构造的 PL/SQL 查询：

```
DECLARE
a NUMBER;
B NUMBER;
CURSOR cursor
IS
 ( SOME SELECT QUERY);
BEGIN
  OPEN cursor;
    LOOP
    SOME STUFF;
    END LOOP;
  CLOSE cursor;
END 
```

如何使用 jdbc 从 java 代码运行此查询并获取结果集？我尝试在不使用游标的情况下运行查询，并且它运行正常。我想不出在java代码中做到这一点的方法。如果我直接在 oracle 客户端上运行查询，它可以正常工作。所以查询没有问题。

PS 由于某些限制，我不想将代码存储为存储过程并调用它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-12-18T05:48:28.700

@拉贾特，

你可以试试下面的方法：

要检索游标，您应该在包规范中将其声明为 REF CURSOR。

```
 --Creating the REF CURSOR type
  type g_cursor is ref cursor; 
```

在规范和正文中，您需要在过程签名中声明一个 out REF CURSOR 变量，如上所述。

```
 procedure PRO_RETURN_CARS(
    i_id     in     tbl_car.car_id%type,
    o_cursor in out g_cursor); 
```

游标必须在过程的主体中打开才能返回，这样：

```
open o_cursor for
          select car_id, company, model, color, hp, price
          from tbl_car
          where car_id = i_id; 
```

完整的包：

```
create or replace package PAC_CURSOR is
  --Creating REF CURSOR type
  type g_cursor is ref cursor;

  --Procedure that return the cursor
  procedure PRO_RETURN_CARS(
    i_id     in     tbl_car.car_id%type,
    o_cursor in out g_cursor); -- Our cursor

end PAC_CURSOR;
/

create or replace package body PAC_CURSOR is
  procedure PRO_RETURN_CARS(
    i_id     in     tbl_car.car_id%type,
    o_cursor in out g_cursor) is

       begin
        --Opening the cursor to return matched rows
        open o_cursor for
          select car_id, company, model, color, hp, price
          from tbl_car
          where car_id = i_id;

  end PRO_RETURN_CARS;

end PAC_CURSOR; 
```

我们已经准备好 Oracle 端，现在我们需要创建 Java 调用

过程如何返回游标，我们将使用一个`java.sql.CallableStatement`实例：

```
CallableStatement cs = conn.prepareCall("{call PAC_CURSOR.PRO_RETURN_CARS(?,?)}"); 
```

将`registerOutParameter`获取`oracle.jdbc.OracleTypes.CURSOR`类型并返回一个`java.sql.ResultSet`实例。我们可以`ResultSet`像一个 common 一样迭代`Iterator`。

SELECT 返回的每一行列将使用对应的 getter 表示如何映射。例如，当列的值为 varchar 时调用 getString() 方法，当为日期时调用 getDate() 等。

完整的代码将是这样的：

```
//Calling Oracle procedure
CallableStatement cs = conn.prepareCall("{call PAC_CURSOR.PRO_RETURN_CARS(?,?)}");

//Defining type of return
cs.registerOutParameter("o_cursor", OracleTypes.CURSOR);
cs.setLong("i_id", id);

cs.execute();//Running the call

//Retrieving the cursor as ResultSet
ResultSet rs = (ResultSet)cs.getObject("o_cursor");

//Iterating the returned rows
while(rs.next()){
    //Getting column values
    System.out.println("ID: " + rs.getLong("car_id"));
    System.out.println("Manufacturer: " + rs.getString("company"));
    System.out.println("Model: " + rs.getString("model"));
    System.out.println("Color: " + rs.getString("color"));
    System.out.println("HP: " + rs.getString("hp"));
    System.out.println("Price: " + rs.getFloat("price"));
} 
```

最后，您将获得 SELECT 子句中返回的任何值。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-16T21:18:26.573

这是不可能的。您不能从匿名 PL/SQL 块返回结果集（因此无法从 JDBC 获取它）。

您将需要直接从 JDBC 运行选择。

唯一，真正丑陋的解决方法是使用`dbms_output.put_line()`并在之后阅读。但这是一个非常丑陋的 hack，直接在 JDBC 中处理 SELECT 查询的结果要好得多。

* * *

## 编辑 1

下面是一个使用 dbms_output 的小例子：

```
Connection con = ....;

// turn on support for dbms_output
CallableStatement cstmt = con.prepareCall("{call dbms_output.enable(32000) }");
cstmt.execute();

// run your PL/SQL block
Statement stmt = con.createStatement();
String sql =
    "declare  \n" +
    " a number;  \n" +
    " cursor c1 is select id from foo;  \n" +
    "begin  \n" +
    "  open c1; \n" +
    "  loop \n" +
    "    fetch c1 into a;  \n" +
    "    exit when c1%notfound;  \n" +
    "    dbms_output.put_line('ID: '||to_char(a)); \n" +
    "  end loop; \n" +
    "end;";
stmt.execute(sql);

// retrieve the messages written with dbms_output
cstmt = con.prepareCall("{call dbms_output.get_line(?,?)}");
cstmt.registerOutParameter(1,java.sql.Types.VARCHAR);
cstmt.registerOutParameter(2,java.sql.Types.NUMERIC);

int status = 0;
while (status == 0)
{
    cstmt.execute();
    String line = cstmt.getString(1);
    status = cstmt.getInt(2);
    if (line != null && status == 0)
    {
        System.out.println(line);
    }
} 
```

* * *

## 编辑 2（这对于评论来说太长了）

嵌套循环来检索数据几乎总是一个坏主意。如果你发现自己在做这样的事情：

```
begin
  for data_1 in (select id from foo_1) loop
    dbms_output.put_line(to_char(data_1.id));

    for data_2 in (select f2.col1, f2.col2 from foo_2 f2 where f2.id = data_1.id) loop
        ... do something else
    end loop;

  end loop;
end;
/ 
```

这样做会更有效率：

```
begin
  for data_1 in (select f2.col1, f2.col2 from foo_2 f2
                 where f2.id in (select f1.id from foo_1 f1)) loop

     ... do something

  end loop;
end;
/ 
```

这可以在 JDBC 中使用这样的东西在没有过多内存的情况下进行处理：

```
String sql = "select f2.col1, f2.col2 from foo_2 f2 where f2.id in (select f1.id from foo_1 f1)";
Statement stmt = connection.createStatement();
ResultSet rs = stmt.executeQuery(sql);
while (rs.next())
{
   String col1_value = rs.getString(1);
   int    col2_value = rs.getInt(2);
   ... do something
} 
```

即使您处理数十亿行，上面的代码也只会在内存中保存一行。准确地说：JDBC 驱动程序实际上会预取多行。默认值为 10，可以更改。但即便如此，您也没有过多的内存使用。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-12-19T15:22:34.943

这里的其他答案似乎超级复杂。

### 使用`SYS_REFCURSOR`

从此以后，您可以`SYS_REFCURSOR`非常轻松地从 JDBC 检索类型：

```
DECLARE
  cur SYS_REFCURSOR;
BEGIN
  OPEN cur FOR SELECT ...;
  ? := cur;
END; 
```

现在像这样从Java运行上面的代码：

```
try (CallableStatement c = con.prepareCall(sql)) {
    c.registerOutParameter(1, OracleTypes.CURSOR); // -10
    c.execute();

    try (ResultSet rs = (ResultSet) c.getObject(1)) {
        ...
    }
} 
```

当然，您也可以按照[pmr's answer 的](https://stackoverflow.com/a/20650560/521799)建议在包中声明自己的游标，但是如果您从 JDBC 运行匿名块，为什么要这样做呢？

### 使用 Oracle 12c 隐式结果集

Oracle 12c 为这些情况添加了一个方便的新特性，类似于 SQL Server/Sybase 和 MySQL 考虑返回结果的过程/批处理的方式。您现在可以[`DBMS_SQL.RETURN_RESULT`](https://docs.oracle.com/database/121/ARPLS/d_sql.htm#ARPLS73893)在任何游标上使用该过程，它会“神奇地”返回它：

```
DECLARE
  cur SYS_REFCURSOR;
BEGIN
  OPEN cur FOR SELECT ...;
  DBMS_SQL.RETURN_RESULT(cur);
END; 
```

[由于 Oracle JDBC 驱动程序中的一个错误（或“功能”），](https://stackoverflow.com/q/42091653/521799)从 JDBC 正确获取该游标有点棘手，[但它当然可以按照我在本文中所展示的方式完成](https://blog.jooq.org/2017/02/08/how-to-fetch-oracle-12c-implicit-cursors-with-jdbc-and-jooq/)。这就是您可以从任何匿名 PL/SQL 块和/或过程、触发器等中发现任意数量的隐式游标的方法...：

```
try (PreparedStatement s = cn.prepareStatement(sql)) {
    // Use good old three-valued boolean logic
    Boolean result = s.execute();

    fetchLoop:
    for (int i = 0;; i++) {

        // Check for more results if not already done in this iteration
        if (i > 0 && result == null)
            result = s.getMoreResults();
        System.out.println(result);

        if (result) {
            result = null;

            try (ResultSet rs = s.getResultSet()) {
                System.out.println("Fetching result " + i);
            }
            catch (SQLException e) {
                // Ignore ORA-17283: No resultset available
                if (e.getErrorCode() == 17283)
                    continue fetchLoop;
                else
                    throw e;
            }
        }
        else if (s.getUpdateCount() == -1)
            // Ignore -1 value if there is one more result!
            if (result = s.getMoreResults())
                continue fetchLoop;
            else
                break fetchLoop;
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-01-05T16:14:28.623

因为 java.sql.PreparedStatement.execute() 的签名是“boolean execute()”而不是“Boolean execute()”，所以“result”变量永远不能为空，因为装箱了 s.execute( )，因此测试“i>0 && result==null”可能是“result==null”

# angularjs - 我无法使用 setTimeout 函数在数组中添加项目

> ID：16047181
> 
> 赞同：0
> 
> 时间：2013-04-16T21:11:47.170
> 
> 标签：angularjs

我试图通过将新条目推送到数组中来更新 ui，但由于某种原因，直到对数组进行下一次操作，ui 才会更新。

```
function TestCtrl($scope){
  $scope.projects = [{name: "project1"}];

  $scope.test = function(){ return "batman"; };

  $scope.addNew = function(){
    $scope.projects.push({name: "project2"});
    setTimeout(function(){
      $scope.projects.push({name: "project3"});
    }, 1000);
  };
} 
```

这是一个例子[http://jsbin.com/itasis/4/edit](http://jsbin.com/itasis/4/edit)

我还没有测试，但我预计 ajax 请求的行为会出现同样的问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T22:05:20.313

使用[$timeout](http://docs.angularjs.org/api/ng.%24timeout)而不是`setTimeout`. `$timeout`自动调用`$apply()`我们，触发一个[Angular 摘要循环](http://docs.angularjs.org/guide/concepts#runtime)，它将更新任何需要刷新的视图。

关于 AJAX，我鼓励您使用 Angular 的[$http](http://docs.angularjs.org/api/ng.%24http)服务，这也需要`$apply()`我们。否则，在您的 AJAX 回调中，在更新您的 Angular 模型/范围后，手动调用`scope.$apply()`.

# android - 新标签和新活动有可能吗？

> ID：16047185
> 
> 赞同：0
> 
> 时间：2013-04-16T21:12:11.683
> 
> 标签：android, android-activity, tabs

我有三个选项卡（选项卡 1、选项卡 2、选项卡 3）。我想在所有选项卡中启动其他活动。我在 Tab 2 中尝试了新的意图。

我的代码这个

```
 public class MainActivity extends Activity {

        @Override
        public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.activity_main);
            TabHost tabHost=(TabHost)findViewById(R.id.tabHost);
            tabHost.setup();

                    TabSpec spec1=tabHost.newTabSpec("Tab 1");
            spec1.setContent(R.id.tab1);
            spec1.setIndicator("Tab 1");

            TabSpec spec2=tabHost.newTabSpec("Tab 2");
            spec2.setIndicator("Tab 2", getResources().getDrawable(R.drawable.ic_launcher));        
            spec2.setContent(new Intent(this,teszt.class));

            TabSpec spec3=tabHost.newTabSpec("Tab 3");
            spec3.setIndicator("Tab 3");
            spec3.setContent(R.id.tab3);

            tabHost.addTab(spec1);
            tabHost.addTab(spec2);
            tabHost.addTab(spec3);
            }

    } 
```

清单.xml

```
 <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name="hu.anzy.fulek.example.fulek.MainActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity android:name=".teszt"
            ></activity>
    </application> 
```

测试.java

公共类 testzt 扩展 Activity {

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.teszt_layout);

}

public void onClick(View v){
    if (v.getId()== R.id.btnBackTo1){
        Toast.makeText(this, "Click BackTo1", Toast.LENGTH_LONG).show();
    } else
    {
        if (v.getId()== R.id.btnStart3) {
            Toast.makeText(this, "Click Start3", Toast.LENGTH_LONG).show();

        }
    }

} 
```

}

主.xml

```
<?xml version="1.0" encoding="utf-8"?>

    <TabHost android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:id="@+id/tabHost"
    xmlns:android="http://schemas.android.com/apk/res/android"
    >
    <TabWidget
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:id="@android:id/tabs"
    />
     <FrameLayout
     android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:id="@android:id/tabcontent"
     >
     <LinearLayout
     android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:id="@+id/tab1"
    android:orientation="vertical"
    android:paddingTop="60px"
     >
     <TextView  
    android:layout_width="fill_parent" 
    android:layout_height="100px" 
    android:text="This is tab1"
    android:id="@+id/txt1"
    />    

     </LinearLayout>

     <LinearLayout
     android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:id="@+id/tab2"
    android:orientation="vertical"
    android:paddingTop="60px"
     >

     </LinearLayout>

      <LinearLayout
     android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:id="@+id/tab3"
    android:orientation="vertical"
    android:paddingTop="60px"
     >
     <TextView  
    android:layout_width="fill_parent" 
    android:layout_height="100px" 
    android:text="This is tab 3"
    android:id="@+id/txt3"
    />

     </LinearLayout>
     </FrameLayout>

    </TabHost> 
```

测试布局.xml

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

       <Button
        android:id="@+id/btnBackTo1"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:text="Back to 1st Activity"
        android:onClick="onClick"
     />
     <Button
          android:id="@+id/btnStart3"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:text="Start 3rd Activity"
        android:onClick="onClick"
     />

</LinearLayout> 
```

我的应用程序正在运行，但是当我选择 Tab 2 时，应用程序停止了。

问题是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T19:29:02.907

好的，我找到了解决方案。

```
 public class MainActivity extends TabActivity{

      public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.main);

            TabHost tabHost = getTabHost();

            // Tab1
            TabSpec spec1 = tabHost.newTabSpec("Tab1");

            photospec.setIndicator("Tab1");
            Intent aIntent = new Intent(this, aActivity.class);
            photospec.setContent(aIntent);

            // Tab2
            TabSpec spec2 = tabHost.newTabSpec("Tab2");
            songspec.setIndicator("Tab2");
            Intent bIntent = new Intent(this, bActivity.class);
            songspec.setContent(bIntent);

            // Tab3
            TabSpec spec3 = tabHost.newTabSpec("Tab3");
            spec3.setIndicator("Tab3");
            Intent cIntent = new Intent(this, cActivity.class);
            spec3.setContent(cIntent);

            // Adding all TabSpec to TabHost
            tabHost.addTab(spec1); // Adding tab
            tabHost.addTab(spec2); // Adding tab
            tabHost.addTab(spec3); // Adding tab
        }
    } 
```

这个aActivity类似于bActivity和cActivity

```
import android.app.Activity;
import android.os.Bundle;

public class aActivity extends Activity {
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.a_layout);
    }
} 
```

A_layout.xml 类似 B_layout.xml 和 C_layout.xml

```
 <?xml version="1.0" encoding="utf-8"?>
    <LinearLayout
      xmlns:android="http://schemas.android.com/apk/res/android"
      android:orientation="vertical"
      android:layout_width="match_parent"
      android:layout_height="match_parent">

      <TextView android:text=" Text"
                android:padding="15dip"
                android:textSize="18dip"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"/>
    </LinearLayout> 
```

主要的.xml

```
 <?xml version="1.0" encoding="utf-8"?>
    <TabHost xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@android:id/tabhost"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent">
        <LinearLayout
            android:orientation="vertical"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent">
            <TabWidget
                android:id="@android:id/tabs"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content" />
            <FrameLayout
                android:id="@android:id/tabcontent"
                android:layout_width="fill_parent"
                android:layout_height="fill_parent"/>
        </LinearLayout>
    </TabHost> 
```

显现

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="hu.anzy.example.androidtablayoutactivity"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="16" />

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name="hu.anzy.example.MaintActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

        <activity android:name=".aActivity" />

        <activity android:name=".bActivity" />

        <activity android:name=".cActivity" />
    </application>

</manifest> 
```

# java - Better way to use Hashtables? Java

> ID：16047188
> 
> 赞同：3
> 
> 时间：2013-04-16T21:12:21.853
> 
> 标签：java, hash

I have a class named Stored that will hold my Hashtable, which will hold Objects from the Class "Item". I have never used Hashtables before or really know all that much about them, but from my snooping around it seems as if there is a lot of different ways to use them. So my question is, which is the best? And why?

**CODE UPDATED**

I have in my program this...

```
public class Store implements Serializable{

Hashtable<String, Item> store = new Hashtable<String, Item>();

} 
```

I have also seen this...

```
Hashtable<Object> store = new Hashtable<Object>(); 
```

Is one better than the other?

Also for reference my Item Class Objects will have 2 strings and an int as variables if that matters at all.

I'm also wondering if these Hashtables should need any constructor or maybe a size initialization? I have seen that in some examples and not in others. As far as I know they increase in size automatically so...whats the point?

EDIT:

I have this in my main...

```
Store store = new Store();

    Item item1 = new Item();
    item1.setProductName("Paper Towel Roll");
    item1.setBarCode("111222333444");
    item1.setQuantity(1);

    store.put("111222333444", item1);

    Item item2 = new Item();
    item2.setProductName("Paper Towel Roll");
    item2.setBarCode("111222333444");
    item2.setQuantity(1);

    store.put("111222333444", item2);

    Item item3 = new Item();
    item3.setProductName("Paper Towel Roll");
    item3.setBarCode("111222333444");
    item3.setQuantity(1);

    store.put("111222333444", item3);

    Item item4 = new Item();
    item4.setProductName("Paper Towel Roll");
    item4.setBarCode("111222333444");
    item4.setQuantity(1);

    store.put("111222333444", item4); 
```

My put() calls don't work. Why can't I access my HashTable?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T21:17:22.370

您看到的与 Hashtable 无关。它是一种称为**泛型**的语言的特性。它允许您限制与您定义的对象一起使用的类型，而无需创建新的类。

一个典型的用法是

```
 Hashtable<Integer, Item> store = new Hashtable<Integer, Item>(); 
```

这确保了在使用您定义的类型的操作中，只有在类型匹配时才接受它。

所以，

```
 store.put(1, new Ítem()); 
```

会工作，但是

```
 store.put(2, new String("Hello world")); 
```

会失败，因为`String`它不是`Item`.

如果你不使用泛型，vg old style Java

```
 Hashtable store = new Hashtable(); 
```

它会工作，但编译器不会检测到任何失败

```
 store.put(2, new String("Hello world")); 
```

所以你失去（通常）有用的控制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T21:19:32.123

如果你想使用泛型，你可以这样做：

```
Hashtable<Key,Item> store = new Hashtable<Key, Item>(); 
```

如果您在不使用泛型的情况下围绕 a 进行包装类`Hashtable`，您将不得不自己进行`Object`转换`Item`。我看不出你为什么要这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T21:25:14.047

关于初始化中的大小：
确实，当您向其中添加项目时，集合（以及哈希表）会动态增加。
初始容量是将在内存中分配的项目数。如果你不给出这个数字，初始容量会得到一些默认值（我认为是 11）。随着 Hashtable 的增加，将需要分配更大的存储空间。重新分配需要一些 CPU 工作，并且会减慢程序的执行速度。因此，通过正确使用初始容量数，您可以节省一些不必要的 CPU 周期，但在今天的计算机上，除非您进行一些非常大的插入，否则我认为这并不重要。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-16T21:54:13.407

第二个示例使用泛型，它允许您在编译时检查类型安全并减少强制转换的需要，通常被认为是更好的选择。至于 Hashtable 构造函数，在大多数情况下，您可以使用 no arg 构造函数来创建默认加载因子 0.75 和初始容量 11 的 Hashmap。加载因子指定何时将哈希表的所有元素复制到更大的数组。当元素数量超过负载因子 * 容量（内部数组大小）时会发生这种情况。其他构造函数允许您指定负载因子和初始容量。还有一个构造函数可以从现有 Map 构建哈希表。您应该考虑在非线程应用程序中使用 HashMap 而不是 Hashtable 以获得更好的性能。另外，从这行代码：

```
Hashtable<Object> store = new Hashtable<Object>(); 
```

我认为您打算使用 HashSet，因为您只存储值，而不是键值对。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-04-16T21:15:27.137

你想使用泛型：

```
public class Store implements Serializable{
  Hashtable<Key, Item> store = new Hashtable<Key,Item>();
} 
```

这确保只有`Item`对象（以及正确的子类对象）可以放置在您的`Hashtable`.

`Key`可以是您用来引用您的项目的任何东西；它可能是`Integer`相反的，或者是一个`String`或其他一些对象。

这可以防止以下情况发生：

```
public class Item {
  public String blah;
  ...
  public void printThisString() {
    System.out.println(blah);
  }
  ...
}

...

Hashtable store = new Hashtable();
Item item = new Item();
item.blah = "Hello world!";
store.put("FirstKey",item);
store.put("SecondKey","Hello world!");
...
store.get("FirstKey").printThisString();//Works fine!
store.get("SecondKey").printThisString();//Fails because String does not have a printThisString method. 
```

这迫使插入哈希表的人思考他们在做什么：

```
Hashtable<String, Item> store = new Hashtable<String,Item>();
Item item = new Item();
item.blah = "Hello world!";
store.put("MyKey",item);
store.put("SecondKey","Three tears for all the souls!");//Will not compile because a String isn't an Item
...
store.get("MyKey").printThisString();//We can therefore be sure what is returned is an Item 
```

**代码更新**

要解决您的代码更新：

```
Store<String, Item> store = new Store<String, Item>();

Item item1 = new Item();
item1.setProductName("Paper Towel Roll");
item1.setBarCode("111222333444");
item1.setQuantity(1);

store.put("111222333444", item1);//note that since it's quoted the key is a String 
```

# node.js - What backend can I use to setup breeze properly on a mac?

> ID：16047190
> 
> 赞同：0
> 
> 时间：2013-04-16T21:12:23.010
> 
> 标签：node.js, angularjs, breeze

I would like to develop an AngularJS app with Breeze. I usually use NodeJS with Express but I hear it wont work with Breeze. All the example on breezejs.com use ASP.Net but i am on a mac and you can't run visual studio... What are my options ?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T22:17:41.603

我们今天晚些时候将发布一个示例（在 Breeze v1.3.0 中），该示例显示 Breeze 与可以使用**任何技术在****任何平台**上编写的任意 Web 服务进行通信。

 **显然，我们需要更多这样的示例，同样重要的是，我们需要展示如何编写这些 Web 服务以最好地利用 Breeze 的服务器端实现。但是……这一切都在我们的路线图上，我们正在这个过程中积极寻找合作伙伴。**

# r - Interpret R output Rpart classification tree surrogate splits

> ID：16047192
> 
> 赞同：4
> 
> 时间：2013-04-16T21:12:37.427
> 
> 标签：r, machine-learning, classification, decision-tree, rpart

```
Surrogate splits:
    ##       bmi    < 21.51 to the right, agree=0.858, adj=0.632, (0 split) 
```

I understand that this split send cases to the right child node based on a bmi value of < 21.51 and has a similar split to the primary variable (agree = 0.858) and a decent decrease in node impurity (adj=0.632).

I do not understand the (0 split) piece of the output? Also, if agreement had a value of 1, would this be suspicious?

Thanks!

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-02-07T08:21:44.277

If you have for example 10 missing in your first primary split then rpart will try to classify them using the surrogate splits. If 9 of these are non-missing in your first surrogate variable rpart will use this variable and you will have **(9 split)** in your rpart output next to this surrogate variable since the variable was used for 9 splits.

If your data is also missing for your surrogate variables then you will have **(0 splits)** in your output.

I do not know the exact calculation of **agreement** but if you would have an agreement of **1** then I guess that the surrogate variable results in the same classification as when using the primary variable. This could happen if your surrogate variable is, for example, a monotone transformed version of the primary variable.

# zsh - How to substitute only the highest number in zsh?

> ID：16047200
> 
> 赞同：0
> 
> 时间：2013-04-16T21:12:55.670
> 
> 标签：zsh, zsh-completion

I have a folder with materials for university study, sorted by semesters:

```
$ ls University
semester1 semester2 semester3 semester4 
```

I'm trying to make one of them the named directory, and I want zsh to allways pointed to directory ending with highest number (so I don't have to update my directory shortcut every semester).

So far I found only the zsh expansion <->:

```
$ ls semester<->
semester1 semester2 semester3 semester4 
```

but I cannot find a way to extract only the last dirname from that.

Any idea how I should proceed or what I should change?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T09:24:28.450

```
latestSemester=`ls semester<-> | tail -1`
echo $latestSemester 
```

实际上这也有效

```
latestSemester=`ls semester<->([-1])` 
```

编辑：修复了第二行，其第一个版本缺少括号。

来自 zsh 手册

```
[beg[,end]]
    specifies which of the matched filenames should be included in the returned list. The
    syntax is the same as for array subscripts. beg and the optional end may be mathemat-
    ical expressions. As in parameter subscripting they may  be  negative  to  make  them
    count  from the last match backward. E.g.: ‘*(-OL[1,3])’ gives a list of the names of
    the three largest files. 
```

# json - 三.js JSONLoader 纹理问题

> ID：16047204
> 
> 赞同：1
> 
> 时间：2013-04-16T21:13:04.660
> 
> 标签：json, three.js, textures, blender

我正在尝试学习three.js，所以我的下一个个人挑战是从搅拌机导入模型，一切顺利，但一些纹理出现了一些问题（使用演示链接能够看到它）。

这里有一个演示：[https ://googledrive.com/host/0BynsKHbZoT73elJpaUxqTlprVjQ/demos/3dworld/](https://googledrive.com/host/0BynsKHbZoT73elJpaUxqTlprVjQ/demos/3dworld/)

在js控制台可以查看素材，也可以查看game.models.tree

从搅拌机导出的材料：

```
 materials" : [  {
    "DbgColor" : 15658734,
    "DbgIndex" : 0,
    "DbgName" : "Material",
    "blending" : "NormalBlending",
    "colorAmbient" : [0.699999988079071, 0.699999988079071, 0.699999988079071],
    "colorDiffuse" : [0.699999988079071, 0.699999988079071, 0.699999988079071],
    "colorSpecular" : [0.125, 0.10904927551746368, 0.08209432661533356],
    "depthTest" : true,
    "depthWrite" : true,
    "mapLight" : "Tree_Bark_Tiled.png",
    "mapLightWrap" : ["repeat", "repeat"],
    "mapNormal" : "Tree_Bark_Nor2.png",
    "mapNormalFactor" : -1.0,
    "mapNormalWrap" : ["repeat", "repeat"],
    "shading" : "Phong",
    "specularCoef" : 15,
    "transparency" : 1.0,
    "transparent" : false,
    "vertexColors" : false
},

{
    "DbgColor" : 15597568,
    "DbgIndex" : 1,
    "DbgName" : "Material.001",
    "blending" : "NormalBlending",
    "colorAmbient" : [1.0, 1.0, 1.0],
    "colorDiffuse" : [1.0, 1.0, 1.0],
    "colorSpecular" : [0.0, 0.0, 0.0],
    "depthTest" : true,
    "depthWrite" : true,
    "mapLight" : "Tree_Leaves.png",
    "mapLightWrap" : ["repeat", "repeat"],
    "mapNormal" : "Tree_Leaves_Nor.png",
    "mapNormalFactor" : -1.0,
    "mapNormalWrap" : ["repeat", "repeat"],
    "shading" : "Phong",
    "specularCoef" : 15,
    "transparency" : 1.0,
    "transparent" : true,
    "vertexColors" : false
},

{
    "DbgColor" : 60928,
    "DbgIndex" : 2,
    "DbgName" : "Material.001",
    "blending" : "NormalBlending",
    "colorAmbient" : [1.0, 1.0, 1.0],
    "colorDiffuse" : [1.0, 1.0, 1.0],
    "colorSpecular" : [0.0, 0.0, 0.0],
    "depthTest" : true,
    "depthWrite" : true,
    "mapLight" : "Tree_Leaves.png",
    "mapLightWrap" : ["repeat", "repeat"],
    "mapNormal" : "Tree_Leaves_Nor.png",
    "mapNormalFactor" : -1.0,
    "mapNormalWrap" : ["repeat", "repeat"],
    "shading" : "Phong",
    "specularCoef" : 15,
    "transparency" : 1.0,
    "transparent" : true,
    "vertexColors" : false
},

{
    "DbgColor" : 238,
    "DbgIndex" : 3,
    "DbgName" : "Material",
    "blending" : "NormalBlending",
    "colorAmbient" : [0.699999988079071, 0.699999988079071, 0.699999988079071],
    "colorDiffuse" : [0.699999988079071, 0.699999988079071, 0.699999988079071],
    "colorSpecular" : [0.125, 0.10904927551746368, 0.08209432661533356],
    "depthTest" : true,
    "depthWrite" : true,
    "mapLight" : "Tree_Bark_Tiled.png",
    "mapLightWrap" : ["repeat", "repeat"],
    "mapNormal" : "Tree_Bark_Nor2.png",
    "mapNormalFactor" : -1.0,
    "mapNormalWrap" : ["repeat", "repeat"],
    "shading" : "Phong",
    "specularCoef" : 15,
    "transparency" : 1.0,
    "transparent" : false,
    "vertexColors" : false
}], 
```

这是搅拌机中三个的外观：

![在此处输入图像描述](https://i.stack.imgur.com/tNAiR.png)

如您所见，透明度消失了，并且树皮中的纹理未正确映射。

有人可以解释一下我做错了什么吗？

谢谢 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T06:58:40.010

材质导出很脆弱，因为 Blender 和 Three.js 参数之间并不总是有清晰的映射。因此，出口的材料经常需要手工固定。

在这种情况下，导出器错误地猜测 Tree_Bark_Tiled.png 是光照贴图而不是漫反射贴图。要解决此问题，请将所有材料引用更改为`mapLight`和`mapLightWrap`到`mapDiffuse`和`mapDiffuseWrap`。您可能还想调整其他属性，例如颜色和镜面反射系数。

至于透明度问题，它有点棘手。您可能想要添加一个`alphaTest`属性并为其尝试不同的值，例如 0.5。要尝试的另一件事是禁用`depthWrite`. 此外，默认情况下，如果存在法线贴图，three.js 会使用特殊的法线贴图着色器。您可能首先尝试不使用法线贴图，因为根据我的经验，该着色器维护不善且容易损坏。就我个人而言，我也将常规的 Phong 材质用于法线贴图，因为它也有支持。

# spring-data-neo4j - SDN 2.1.0/neo4j 1.8：java.lang.IllegalArgumentException：无法获取字段“schoolRef”的单个字段值

> ID：16047205
> 
> 赞同：1
> 
> 时间：2013-04-16T21:13:07.470
> 
> 标签：spring-data-neo4j

我可以添加和保存多个 SchoolRef，但是在检索（祖先并急切地获取）教育对象然后尝试添加另一个 SchoolRef 后出现错误。这适用于 SDN 2.0.1，但我还更改了其他内容，包括下面的 Repository/Cypher 查询，因此我无法将其隔离到升级中。

```
@Fetch @RelatedTo(type = "EDUCATION_HAS_SCHOOLREF")
private Set<SchoolRef> schoolRefs = new HashSet<SchoolRef>();

public Education() {
}

public void addSchoolRef(SchoolRef schoolRef) {
    getSchoolRefs().add(schoolRef);
} 
```

存储库：

```
public interface UserRepository extends GraphRepository<User>, CypherDslRepository<User> {

@Query("start id=node:Identifier(identifier={0}) match id<-[:USER_HAS_IDENTIFIER]-user return user")
public User findById(String id); 
```

堆栈跟踪：

```
Caused by: java.lang.IllegalArgumentException: Cannot obtain single field value for field 'schoolRef'
    at org.springframework.data.neo4j.fieldaccess.RelatedToSingleFieldAccessorFactory$RelatedToSingleFieldAccessor.getValue(RelatedToSingleFieldAccessorFactory.java:94)
    at org.springframework.data.neo4j.fieldaccess.DefaultEntityState.getValue(DefaultEntityState.java:97)
    at org.springframework.data.neo4j.support.mapping.SourceStateTransmitter.copyEntityStatePropertyValue(SourceStateTransmitter.java:90)
    at org.springframework.data.neo4j.support.mapping.SourceStateTransmitter.access$000(SourceStateTransmitter.java:40)
    at org.springframework.data.neo4j.support.mapping.SourceStateTransmitter$2.doWithAssociation(SourceStateTransmitter.java:61)
    at org.springframework.data.mapping.model.BasicPersistentEntity.doWithAssociations(BasicPersistentEntity.java:207)
    at org.springframework.data.neo4j.support.mapping.SourceStateTransmitter.copyPropertiesFrom(SourceStateTransmitter.java:57)
    at org.springframework.data.neo4j.support.mapping.Neo4jEntityConverterImpl.loadEntity(Neo4jEntityConverterImpl.java:100)
    at org.springframework.data.neo4j.support.mapping.Neo4jEntityConverterImpl.read(Neo4jEntityConverterImpl.java:92)
    at org.springframework.data.neo4j.support.mapping.Neo4jEntityPersister$CachedConverter.read(Neo4jEntityPersister.java:170)
    at org.springframework.data.neo4j.support.mapping.Neo4jEntityPersister.createEntityFromState(Neo4jEntityPersister.java:189)
    at org.springframework.data.neo4j.support.Neo4jTemplate.createEntityFromState(Neo4jTemplate.java:180)
    at org.springframework.data.neo4j.fieldaccess.RelationshipHelper.createEntitySetFromRelationshipEndNodes(RelationshipHelper.java:130)
    at org.springframework.data.neo4j.fieldaccess.RelatedToFieldAccessor.createEntitySetFromRelationshipEndNodes(RelatedToFieldAccessor.java:86)
    at org.springframework.data.neo4j.fieldaccess.RelatedToSingleFieldAccessorFactory$RelatedToSingleFieldAccessor.getValue(RelatedToSingleFieldAccessorFactory.java:76)
    at org.springframework.data.neo4j.fieldaccess.DefaultEntityState.getValue(DefaultEntityState.java:97)
    at org.springframework.data.neo4j.support.mapping.SourceStateTransmitter.copyEntityStatePropertyValue(SourceStateTransmitter.java:90)
    at org.springframework.data.neo4j.support.mapping.SourceStateTransmitter.access$000(SourceStateTransmitter.java:40)
    at org.springframework.data.neo4j.support.mapping.SourceStateTransmitter$2.doWithAssociation(SourceStateTransmitter.java:61)
    at org.springframework.data.mapping.model.BasicPersistentEntity.doWithAssociations(BasicPersistentEntity.java:207)
    at org.springframework.data.neo4j.support.mapping.SourceStateTransmitter.copyPropertiesFrom(SourceStateTransmitter.java:57)
    at org.springframework.data.neo4j.support.mapping.Neo4jEntityConverterImpl.loadEntity(Neo4jEntityConverterImpl.java:100)
    at org.springframework.data.neo4j.support.mapping.Neo4jEntityConverterImpl.read(Neo4jEntityConverterImpl.java:92)
    at org.springframework.data.neo4j.support.mapping.Neo4jEntityPersister$CachedConverter.read(Neo4jEntityPersister.java:170)
    at org.springframework.data.neo4j.support.mapping.Neo4jEntityPersister.createEntityFromState(Neo4jEntityPersister.java:189)
    at org.springframework.data.neo4j.support.mapping.Neo4jEntityPersister.persist(Neo4jEntityPersister.java:244)
    at org.springframework.data.neo4j.support.mapping.Neo4jEntityPersister.persist(Neo4jEntityPersister.java:231)
    at org.springframework.data.neo4j.support.Neo4jTemplate.save(Neo4jTemplate.java:293)
    at org.springframework.data.neo4j.support.Neo4jTemplate.save(Neo4jTemplate.java:287)
    at org.springframework.data.neo4j.fieldaccess.RelationshipHelper.getOrCreateState(RelationshipHelper.java:119)
    at org.springframework.data.neo4j.fieldaccess.RelationshipHelper.createSetOfTargetNodes(RelationshipHelper.java:111)
    at org.springframework.data.neo4j.fieldaccess.RelatedToFieldAccessor.createSetOfTargetNodes(RelatedToFieldAccessor.java:82)
    at org.springframework.data.neo4j.fieldaccess.RelatedToCollectionFieldAccessorFactory$RelatedToCollectionFieldAccessor.setValue(RelatedToCollectionFieldAccessorFactory.java:66)
    at org.springframework.data.neo4j.fieldaccess.ManagedFieldAccessorSet.updateValue(ManagedFieldAccessorSet.java:94)
    at org.springframework.data.neo4j.fieldaccess.ManagedFieldAccessorSet.update(ManagedFieldAccessorSet.java:82)
    at org.springframework.data.neo4j.fieldaccess.ManagedFieldAccessorSet.add(ManagedFieldAccessorSet.java:108) 
```

---- 编辑：同样的错误，但在不同的情况下..

```
 School school = new School();
    school = neo4j.repositoryFor(School.class).save(school);

    User user1 = new User("Junit", "1");
    SchoolRef schoolRef1 = new SchoolRef();
    schoolRef1.setSchool(school);
    user1.addSchoolRef(schoolRef1);
    user1 = neo4j.repositoryFor(User.class).save(user1);

    User user2 = new User("Junit", "2");
    SchoolRef schoolRef2 = new SchoolRef();
    schoolRef2.setSchool(school);
    user2.addSchoolRef(schoolRef2);
    user2 = neo4j.repositoryFor(User.class).save(user2);  // <- error here 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-30T00:28:56.447

有时我可能对明显的问题视而不见......

在我的例子中，SchoolRef 引用了一所学校，但学校可以有很多 schoolRef。我错误地实现了 School ，只引用了一个返回 SchoolRef。

我能够创建多个引用单个 School 的 SchoolRef，但是当我尝试获取具有多个引用的 School 时出现此错误。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-02-12T17:10:17.023

我们也遇到了这个问题，但这是由于与同一个标签有不同的关系。

# android - Android - 如何在长按时停止 Linkify？

> ID：16047215
> 
> 赞同：5
> 
> 时间：2013-04-16T21:13:57.180
> 
> 标签：android, hyperlink, linkify

我正在处理我的项目，其中有一个 listView，每个项目都是一个 LinaerLayout，它有一个带有 Linkify 超链接的 TextView。所以，当我在列表视图中按下一个项目时，它会打开一个对话框，这很好。当我按下 listView 中的链接文本时，它会打开一个对话框，这很好。问题：当我长按列表视图中的链接文本时，它会同时打开一个对话框和给定链接的一个活动！在这种情况下，我只希望它只打开对话框。换句话说，我想在长按上忽略 Linkify 的超链接。有谁知道我该怎么做？我不知道在哪里应用 LongPress 属性...在此先感谢。

仅供参考，我尝试了以下但不起作用。

```
public class URLSpanNoUnderline extends URLSpan implements OnLongClickListener {
    public URLSpanNoUnderline(String url) {
        super(url);
    }

    @Override
    public void updateDrawState(TextPaint textPaint) {
        super.updateDrawState(textPaint);

        textPaint.setUnderlineText(false);
    }

    @Override
    public void onClick(View v) {}

    @Override
    public boolean onLongClick(View v) {
        Log.d("log", "lonnnnnnnnnnnnnnnng click");
        return false;
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-11-05T03:59:20.293

你需要一个 longClick 标记，在 textview longclicklistener 中设置它，在 touchlistener 中，当 action 等于 MotionEvent.ACTION_UP 并且 longClick 为 true 时，返回 true。</p>

```
textview.setOnLongClickListener(new View.OnLongClickListener() {
    @Override 
    public boolean onLongClick(View v) {
        isLongClick= true;
        return false;
    }
});

textview.setOnTouchListener(new View.OnTouchListener() {
    @Override
    public boolean onTouch(View v, MotionEvent event) {
        if(event.getAction() == MotionEvent.ACTION_UP && isLongClick){
            isLongClick= false;
            return true;
        }
        if(event.getAction() == MotionEvent.ACTION_DOWN){
            isLongClick= false;
        }
        return v.onTouchEvent(event);
    }
}); 
```

这个问题发生在某些手机上。

# c# - 如何使用 CsvHelper 仅将选定的类字段写入 CSV？

> ID：16047217
> 
> 赞同：14
> 
> 时间：2013-04-16T21:14:04.623
> 
> 标签：c#, .net, csv, csvhelper

我用来[`CsvHelper`](https://github.com/JoshClose/CsvHelper)读写 CSV 文件，它很棒，但我不明白如何只编写选定的类型字段。

假设我们有：

```
using CsvHelper.Configuration;

namespace Project
{
    public class DataView
    {
        [CsvField(Name = "N")]
        public string ElementId { get; private set; }

        [CsvField(Name = "Quantity")]
        public double ResultQuantity { get; private set; }

        public DataView(string id, double result)
        {
            ElementId = id;
            ResultQuantity = result;
        }
    }
} 
```

我们想`CsvField`从我们目前通过以下方式生成的结果 CSV 文件中排除“数量”：

```
using (var myStream = saveFileDialog1.OpenFile())
{
    using (var writer = new CsvWriter(new StreamWriter(myStream)))
    {
        writer.Configuration.Delimiter = '\t';
        writer.WriteHeader(typeof(ResultView));
        _researchResults.ForEach(writer.WriteRecord);
    }
} 
```

我可以使用什么来从 CSV 中动态排除类型字段？

如果有必要，我们可以处理生成的文件，但我不知道如何删除整个 CSV 列`CsvHelper`。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2014-06-23T20:01:59.820

我最近需要通过确定在运行时包含哪些字段来获得类似的结果。这是我的方法：

1.  创建一个映射文件，通过将枚举传入类构造函数来映射我在运行时需要哪些字段

    ```
    public sealed class MyClassMap : CsvClassMap<MyClass>
    {
        public MyClassMap(ClassType type)
        {
            switch (type)
            {
                case ClassType.TypeOdd
                    Map(m => m.Field1);
                    Map(m => m.Field3);
                    Map(m => m.Field5);                 
                    break;
                case ClassType.TypeEven:
                    Map(m => m.Field2);
                    Map(m => m.Field4);
                    Map(m => m.Field6);                 
                    break;
                case ClassType.TypeAll:
                    Map(m => m.Field1);
                    Map(m => m.Field2);
                    Map(m => m.Field3);
                    Map(m => m.Field4);
                    Map(m => m.Field5);
                    Map(m => m.Field6);                 
                    break;
            }
        }
    } 
    ```

2.  写出使用映射配置的记录

    ```
    using (var memoryStream = new MemoryStream())
    using (var streamWriter = new StreamWriter(memoryStream))
    using (var csvWriter = new CsvWriter(streamWriter))
    {
        csvWriter.Configuration.RegisterClassMap(new MyClassMap(ClassType.TypeOdd));
        csvWriter.WriteRecords(records);
        streamWriter.Flush();
        return memoryStream.ToArray();
    } 
    ```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-04-16T21:19:02.860

像这样标记字段：

```
[CsvField( Ignore = true )]
public double ResultQuantity { get; private set; } 
```

**更新：**没关系。我看到您想在运行时执行此操作，而不是编译时。对于可能犯同样错误的其他人，我会将其作为危险信号。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-04-16T22:38:26.447

你可以这样做：

```
using (var myStream = saveFileDialog1.OpenFile())
{
    using (var writer = new CsvWriter(new StreamWriter(myStream)))
    {
        writer.Configuration.AttributeMapping(typeof(DataView)); // Creates the CSV property mapping
        writer.Configuration.Properties.RemoveAt(1); // Removes the property at the position 1
        writer.Configuration.Delimiter = "\t";
        writer.WriteHeader(typeof(DataView));
        _researchResults.ForEach(writer.WriteRecord);
    }
} 
```

我们强制创建属性映射，然后对其进行修改，动态删除列。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2019-08-16T09:48:20.113

我的代码也有类似的问题，我通过以下代码修复了它。

你可以这样做：

```
var ignoreQuantity = true;
using (var myStream = saveFileDialog1.OpenFile())
{
    using (var writer = new CsvWriter(new StreamWriter(myStream)))
    {
        var classMap = new DefaultClassMap<DataView>();
        classMap.AutoMap();
        classMap.Map(m => m.ResultQuantity).Ignore(ignoreQuantity)

        writer.Configuration.RegisterClassMap(classMap);

        writer.Configuration.Delimiter = "\t";
        writer.WriteHeader(typeof(DataView));
        _researchResults.ForEach(writer.WriteRecord);
    }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-01-14T01:43:24.413

我还必须解决这个问题：我有几十个记录类型，它们有一个共同的基类和一个必须被所有人忽略的共同字段：

```
// Nothing special here
internal class MyClassMap<T> : ClassMap<T> where T : MyRecordBaseClass
{ 
    public MyClassMap()
    {
        AutoMap();
        Map( m => m.SOME_FIELD ).Ignore();
    }
} 
```

这部分通常有据可查，而不是动态部分。

但是*一个*类需要通过动态忽略不同的字段来特殊调味，虽然我可以创建一个单独的地图类，但这并没有达到我期望的更多这样的规模，所以我终于想出了如何去做适当地：

```
 ...
    // special processing for *one* record type
    csvwriter.Configuration.RegisterClassMap<MyClassMap<ONE_RECORD_TYPE>>();

    if (ShouldIgnore)
    {
        var map = csvwriter.Configuration.Maps.Find<ONE_RECORD_TYPE>();
        map.Map( m => m.SOME_OTHER_FIELD ).Ignore();
    }
    ... 
```

这适用于 CsvHelper 版本 7.1.1 和 12.1.1。

# java - 在 Mockito 中创建一个测试规则，例如“对于每个 arg，该方法将基于此 arg 返回一个答案”

> ID：16047219
> 
> 赞同：1
> 
> 时间：2013-04-16T21:14:10.897
> 
> 标签：java, mockito

有一堂课。

```
class A {

 public String getValue(String key) {
   return key;
 }

} 
```

是否可以编写这样一个测试来测试该方法`getValue()`返回一个键作为值。

有我的尝试：

```
 A aMock = mock(A.class);
  when(aMock.getValue("key")).thenReturn("key"); 
```

这很好，但这仅适用于一个特定的参数值。但是我可能需要某种规则，例如`"for each parameter it would return the parameter itself whatever value this parameter would have"`

* * *

更多上下文，我实际上要测试的内容：

假设我们有一个包含`key=value`条目的文件，例如资源包。如果找不到值，该方法将返回键。例如，如果我们按“user.name”搜索，如果定义了“Bob”，我们将得到它。如果不是 - 它会返回 key (user.name) itsef，因为我不希望这个方法返回 me `null`。

（这实际上是一个模型`org.springframework.context.MessageSource.getMessage`- 它的行为方式相似）

所以..更新

```
public String getValue(String key) {
    // some code ...might be here, but we care about a result
    if (valueWasFound) {
     return theValue;
    } 
    return key;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T21:50:13.020

使用中的`returnsFirstArg`方法`AdditionalAnswers`。

```
when(myMock.getValue(anyString())).then(returnsFirstArg()); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T21:30:05.197

您想要做的在[Answer 的 javadoc 中](http://docs.mockito.googlecode.com/hg/latest/org/mockito/stubbing/Answer.html)有说明：

```
when(mock.someMethod(anyString())).thenAnswer(new Answer() {
    public Object answer(InvocationOnMock invocation) {
        Object[] args = invocation.getArguments();
        Object mock = invocation.getMock();
        return "called with arguments: " + args;
    }
});

// Following prints "called with arguments: foo"
System.out.println(mock.someMethod("foo")); 
```

# css - 定义样式的最佳方法是什么？类名或相对路径？

> ID：16047222
> 
> 赞同：1
> 
> 时间：2013-04-16T21:14:18.477
> 
> 标签：css

本周我加入了一个新项目，我注意到设计师（创建所有 .css 文件）以与我习惯不同的方式使用 css。我习惯主要是由类和类名引用的元素，例如有一个定义

```
.myClass { display:block; } 
```

并在我的元素中使用该`class="myClass"`属性。

这位设计师使用这种参考来构建整个设计：

```
form#myForm div a { display:block; } 
```

或类似的。这将在 id=myForm 的表单中获取 div 内的所有锚点。

哪一个是最好的方法？主要是使用类还是主要使用这种其他方式（不知道怎么称呼）？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T22:12:57.273

奇怪的是，有些东西还没有人包含在他们的答案中，这完全取决于您希望/需要在选择中的具体程度。

# 基础：

如果要在页面上选择多个元素，只需使用类选择器即可：

```
.non-unique-elements{
    // some style
} 
```

如果您想更具体一些，或者想在页面上选择一个*独特的*元素，请使用`ID`选择器：

```
#unique-element{
    // some style
} 
```

# 进一步造型

`ID`现在，正如您的同事所做的那样，您可以通过仅在元素具有其他属性时选择元素来获得更具体的信息；例如，您可能希望选择所有包含某个类名但也是类型的元素`form`

```
form.some-class{
    // style
} 
```

# 最具选择性的 CSS 将覆盖选择性较低的 CSS

因此，请考虑以下示例：

```
.some-class{

} 
```

被以下内容覆盖：

```
#some-id{

} 
```

被覆盖

```
div#some-id{

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T21:23:14.200

这真的取决于目的。类应用于定义一般样式，其中 ID 应用于选择特定项目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T22:07:01.390

这是一个问题，您正在编写的 css 属性是否取决于 html 标记与其父级（和兄弟级）之间的关系：

为了显示，

我想将页面中**某些**文本的颜色设置为红色-> 仅使用类`.redtext`

我想**仅**在特定 div中设置**某些**文本的颜色->**`.mydiv .redtext`**

 ****我只想以特定形式设置****所有**输入的宽度->**`#myform input`**

 **请记住，使用长 css 选择器会使它们非常依赖于页面结构，因此很脆弱。****

# java - Swing：JTabbedPane 组件子类的自定义 LaF

> ID：16047225
> 
> 赞同：0
> 
> 时间：2013-04-16T21:14:23.227
> 
> 标签：java, swing, look-and-feel

如何子类化 JTabbedPane 并为子类的每个实例提供与默认 LaF 不同的外观？我仍然想访问默认的 JTabbedPanel，所以简单地覆盖全局 LaF 不是一种选择。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T21:43:24.780

您可以通过调用 setUI(TabbedPaneUI ui) 方法手动设置 JTabbedPane（和大多数其他 JComponents）的特定 UI 实现。

例如，要设置特定的 JTabbedPane 以使用 Metal Look and Feel，请使用：

```
JTabbedPane fooPane = new JTabbedPane();
fooPane.setUI(MetalTabbedPaneUI.createUI(fooPane)); 
```

在创建 JTabbedPane 的子类（像您一样）时，您需要像这样覆盖方法 updateUI()：

```
public void updateUI() {
    setUI(MetalTabbedPaneUI.createUI(this));
} 
```

# php - 数组和每个循环问题

> ID：16047227
> 
> 赞同：0
> 
> 时间：2013-04-16T21:14:27.287
> 
> 标签：php

代码如下如果我在数组中运行一个值结果是正确的如果我运行多个值结果是价格不正确它就像它在某处弄乱了值一样？帮助表示赞赏

```
    $dido=array('42204131','22204131');
    foreach($dido 作为 $did):

    $query = "select * from dispatch,link where lid=dlid and did=$did";
    $result = mysql_query($query) 或 die(mysql_error());
    而($row = mysql_fetch_array($result)){

    $vanc1=$row['vanc1'];
    $vanc2=$row['vanc2'];
    $vanc3=$row['vanc3'];
    $vanc4=$row['vanc4'];
    $vanc5=$row['vanc5'];

    $anc1=$row['anc1'];
    $anc2=$row['anc2'];
    $anc3=$row['anc3'];
    $anc4=$row['anc4'];
    $anc5=$row['anc5'];

    // 价格 anc1
    $querypanc1 = "从 pid=$anc1 的产品中选择 pprice";
    $resultpanc1 = mysql_query($querypanc1);
    而($row = mysql_fetch_array($resultpanc1))
    {
        $priceanc1=$row[pprice];
        $tpriceanc1=$vanc1*$priceanc1;

    }
    // 价格 anc2
    $querypanc2 = "从 pid=$anc2 的产品中选择 pprice";
    $resultpanc2 = mysql_query($querypanc2);
    而($row = mysql_fetch_array($resultpanc2))
    {
        $priceanc2=$row[pprice];
        $tpriceanc2=$vanc2*$priceanc2;

    }
    // 价格 anc3
    $querypanc3 = "从 pid=$anc3 的产品中选择 pprice";
    $resultpanc3 = mysql_query($querypanc3);
    而($row = mysql_fetch_array($resultpanc3))
    {
        $priceanc3=$row[pprice];
        $tpriceanc3=$vanc3*$priceanc3;

    }
    // 价格 anc4
    $querypanc4 = "从 pid=$anc4 的产品中选择 pprice";
    $resultpanc4 = mysql_query($querypanc4);
    而($row = mysql_fetch_array($resultpanc4))
    {
        $priceanc4=$row[pprice];
        $tpriceanc4=$vanc4*$priceanc4;

    }
    // 价格 anc5
    $querypanc5 = "从 pid=$anc5 的产品中选择 pprice";
    $resultpanc5 = mysql_query($querypanc5);
    而($row = mysql_fetch_array($resultpanc5))
    {
        $priceanc5=$row[pprice];
        $tpriceanc5=$vanc5*$priceanc5;

    }

    $gtprice=$tpriceanc1+$tpriceanc2+$tpriceanc3+$tpriceanc4+$tpriceanc5；

        $qrygt="更新调度 SET gtprice=$gtprice WHERE did=$did";
        $resultgt=@mysql_query($qrygt);

        }
        结束；

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T22:04:50.360

您的第一个也是最大的问题是代码的复制粘贴性质。让我们试着分解你在做什么：

*   设置 id 列表
*   对这些 id 运行查询
*   将结果放入数组
*   对每个结果运行单独的查询

您还使用了一些非常简陋的语法。（即`foreach($foo as $bar):`）。

把这些东西分解成方法。什么是方法？它接受输入并将其转换为输出。

```
//returns an array of price information
public function getPrices($idArray) { //note the good method and parameter names!
  //do stuff
} 
```

现在我们知道我们在做什么，我们可以开始填写实现细节：

```
public function getPrices($idArray) {
  foreach($idArray as $id) {
    //somehow get the gross-scale information
    //then put it in a data object
    //then call a function to get specific information
  }
} 
```

该子方法应该做什么？让我们看看您当前的代码片段：

```
 // price anc1
 $querypanc1 = "select pprice from products where pid=$anc1";//sets up sql query
 $resultpanc1 = mysql_query($querypanc1);                    //runs the query
 while($row = mysql_fetch_array($resultpanc1)) {             //for each result
   $priceanc1=$row[pprice];                                  //gets the price
   $tpriceanc1=$vanc1*$priceanc1;                            //calculates some other price
 } 
```

最后两行确实暗示了一个对象，但对于您的目的而言，这可能太重了。前两行是您不断重复的样板。让我们写一个函数！

```
public function getPrices($name, $pid, $multiplier) {
  $sqlQuery = "SELECT pprice FROM products WHERE pid=$pid";
  $result = mysql_query($sqlQuery);
  $prices = array();
  while ($row = mysql_fetch_array($result) {
    $key = "price".$name;//$key will be something like 'priceanc1'
    $prices[$key] = $row[pprice];
    $tkey = "tprice".$name;
    $prices[$tkey] = $prices[$key] * $multiplier;
  }
} 
```

现在，这个函数有点不干净，因为它试图一次做两件事（查询数据库，然后将数据按摩到一个可用的数组中），但我希望它类似于你正在做的事情。编写完这个函数后，我们可以回到更高级别的函数并调用它：

```
public function getPrices($idArray) {
  foreach($idArray as $id) {
    $sqlQuery = "SELECT * from dispatch, link WHERE lid=dlid and did=$id";
    $prices = array();
    while ($row = mysql_fetch_array($result) {
      for ($idx = 1; $idx <= 5; $idx++) {
        $name = "anc".$idx;
        $pid = $row[$name];
        $multiplier = $row["vanc".$idx];
        $priceArray = getPrices($name, $pid, $multiplier);
        $prices = array_merge($prices, $priceArray);
      }
    }
  }

  //put a var_dump here to check to see if you're getting good results!

  return $prices;//Should be the aggregated prices you've gotten from the db
} 
```

现在，这就是你想要做的，但我承认我不明白你的数据库是如何设置的，或者你的变量的实际含义是什么。紧接着！我们还注意到，不必要的数据按摩会消失。

你可以这样称呼它：

```
$ids = array();
$ids[] = 42204131;
$ids[] = 22204131;
$prices = getPrices($ids);
var_dump($prices);//shows the result of your work 
```

现在您有了价格，您可以将它们传递给另一个函数来运行更新：

```
updatePrices($prices); 
```

我会让你自己写那部分。但要记住; 分解你正在做的事情，让重复的元素由同一个函数处理。这里要学到的真正教训是编程实际上是在交流：你的代码没有交流任何东西，因为有太多重复的噪音。使用好的变量名。将您正在做的事情收紧到具有单个任务的功能。这样，任何阅读您的代码的人（包括您！）都会知道您要做什么以及哪里出错了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T22:08:41.843

1）我可以在您的代码中发现的唯一可能的问题是，当您的某些`select pprice from products where pid ...`查询不返回任何数据时，您会保留`$tpriceancX`上一次迭代的值。

`for`2）另外（题外话）你可以用循环替换你的5个重复代码块。

```
$gtprice = 0;
for ($i = 1; $i <= 5; $i++)
{
    $querypanc = "select pprice from products where pid=".$row["anc$i"];
    $resultpanc = mysql_query($querypanc);
    while($pancrow = mysql_fetch_array($resultpanc))
    {
        $priceanc=$pancrow[pprice];
        $tpriceanc=$row["vanc$i"]*$priceanc;
        $gtprice += $tpriceanc;
    }
} 
```

# java - 跟踪代码执行？

> ID：16047228
> 
> 赞同：2
> 
> 时间：2013-04-16T21:14:41.327
> 
> 标签：java, eclipse, debugging, trace

我的一个程序停在某个位置（也不例外，似乎也没有崩溃），但我不知道那个位置。不是设置断点（这意味着您已经需要知道发生某事的位置），是否可以获得最后执行的代码行的信息（=现在之前）？我正在使用 Eclipse，这在调试视图中是否可能？

想想像逐步执行代码这样的事情，除了我不想一步一步地点击一百万次，而是 Eclipse 或其他一些工具会为我做这件事。

感谢您对此的任何提示！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T21:22:43.980

![在此处输入图像描述](https://i.stack.imgur.com/3w6xS.png)

我遇到了同样的问题。在绿色箭头/三角形的右侧有一个“暂停”按钮（两个垂直的黄色条 - 参见图像的右上角），它将阻止您进入调试器。您可能需要仔细查看调试堆栈，直到您识别出部分代码。

这对我来说非常有用 - 我在正则表达式中处于灾难性的回溯中（可能需要数年才能终止！）我永远不会猜到这一点。

[如果您没有任何断点，则需要从调试器的角度开始才能看到按钮。]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T21:19:06.130

在 Eclipse 中，如果您单击调试 UI 中的“暂停”按钮，您可以暂停一个线程或整个 VM。您可能陷入某种等待，并且可能不得不沿着堆栈跟踪查找代码中调用正在等待的服务的行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T21:26:19.343

正如其他人所说，Eclipse 有 Suspend 按钮。

但是好的老式方法是添加大量`System.out.println("No problem so far at line 'x' " )`语句并手动跟踪错误。

# selenium - Click() 未完成

> ID：16047229
> 
> 赞同：1
> 
> 时间：2013-04-16T21:14:41.563
> 
> 标签：selenium, webdriver, autoit

## 脚步

1.  单击 Firefox 中的“浏览”按钮
2.  打开一个窗口对话框（浏览文件）
3.  选择文件（AutoIt 脚本）

## Java 代码

```
 driver.findElement(By.xpath("")).click();
    String path = "C:\\FileUpload.Av3.exe";
    driver.findElement(By.xpath (")).click(); - Browse Button in Web application

    try {
          Runtime.getRuntime().exec(path); - Execute AutoIT .exe file
    } catch (IOException e) {
          e.printStackTrace();
    } 
```

## 在职的

1.  在 Java 代码的第 2 行放置一个断点，然后
2.  注释第 3 行和
3.  单击浏览按钮，然后
4.  手动点击后继续执行

这适用于 AutoIt。

## 不工作

在第 3 行之后，执行将不会继续，并且控件不会从 Firefox 传递回 Selenium。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T22:24:34.717

Selenium WebDriver 无法处理它。用于`sendKeys`在 File Input 元素中插入文件的本地路径：

```
String path = "C:\FileUpload.Av3.exe";
driver.findElement(By.xpath("/path/to/the/file/input/element")).sendKeys(path); 
```

请参阅[Selenium WebDriver 的 FAQ 文档](https://code.google.com/p/selenium/wiki/FrequentlyAskedQuestions#Q:_Does_WebDriver_support_file_uploads?)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-18T20:23:10.343

Click 调用是一个阻塞调用，在页面加载之前不会返回。由于单击会打开一个对话框，因此在关闭对话框之前单击不会返回。

要解决此问题，请在单独的线程中调用 Click，然后调用 AutoIt 脚本。AutoIt 脚本关闭对话框后，单击将返回，您的其余测试可以继续。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T08:14:36.543

删除 try-catch 块并仅使用以下代码。让我知道它是否有效。

```
driver.findElement(By.xpath("")).click();
driver.findElement(By.xpath (")).click(); - Browse Button in Web application
String path = "C:\\FileUpload.Av3.exe";
Runtime.getRuntime().exec(path); - Execute AutoIT .exe file 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-01-03T08:05:15.107

单击“下载 Excel”链接后，我也遇到了同样的问题。为了解决这个问题，我曾经`JavascriptExecutor`获得执行控制权。

```
js.executeScript("arguments[0].click();", button); 
```

# xcode - 包括子项目（SocketRocket）在错误的地方寻找CFNetwork

> ID：16047230
> 
> 赞同：3
> 
> 时间：2013-04-16T21:14:43.670
> 
> 标签：xcode, macos, linker, shared-libraries

我正在尝试在我的项目中包含[SocketRocket 。](https://github.com/square/SocketRocket)但它没有找到 CFNetwork.framework。

更具体地说，它在错误的地方寻找它。这是错误：

`dyld: Library not loaded: /System/Library/Frameworks/CFNetwork.framework/Versions/A/CFNetwork Referenced from: /Volumes/MacintoshHD/me/Library/Developer/Xcode/DerivedData/KeyServer-chcnhqzvlfxnmzdqlyfdmokatrfw/Build/Products/Debug/SocketRocket.framework/Versions/A/SocketRocket Reason: image not found`

它在这里寻找 CFNetwork：

`/System/Library/Frameworks/CFNetwork.framework/Versions/A/CFNetwork`

它应该在 SocketRocket.framework 中寻找它。例如这里：

`/System/Library/Frameworks/CoreService.framework/Frameworks/CFNetwork.framework/Versions/A/CFNetwork`

有任何想法吗？我一定是少了一面旗帜什么的。我在 OSX 10.7 上。

# c++ - 具有交错法线的 VertexBufferObject

> ID：16047232
> 
> 赞同：0
> 
> 时间：2013-04-16T21:14:50.720
> 
> 标签：c++, opengl, vertex-buffer

我有一个工作顶点缓冲区对象，但我需要添加法线。法线存储在与顶点位置相同的数组中。它们是交错的

```
Vx Vy Vz Nx Ny Nz 
```

到目前为止，这是我的代码：

GLfloat 值[NUM_POINTS*3 + NUM_POINTS*3]；无效初始化场景（）{

```
for(int i = 0; i < (NUM_POINTS) ; i = i+6){
    values[i+0] = bunny[i];
    values[i+1] = bunny[i+1];
    values[i+2] = bunny[i+2];
    values[i+3] = normals[i];
    values[i+4] = normals[i+1];
    values[i+5] = normals[i+2];
}

glGenVertexArrays(1,&bunnyVAO);
glBindVertexArray(bunnyVAO);

glGenBuffers(1, &bunnyVBO);
glBindBuffer(GL_ARRAY_BUFFER, bunnyVBO);
glBufferData(GL_ARRAY_BUFFER, sizeof(bunny), bunny, GL_STATIC_DRAW);

glVertexAttribPointer(0,3, GL_FLOAT, GL_FALSE, 0,0);
glEnableVertexAttribArray(0);

glGenBuffers(1, &bunnyIBO);
glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, bunnyIBO);
glBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(triangles), triangles, GL_STATIC_DRAW);

// unbind active buffers //
  glBindVertexArray(0);
  glBindBuffer(GL_ARRAY_BUFFER, 0);
  glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, 0);
}

void renderScene() {
  if (bunnyVBO != 0) {
    // x: bind VAO //
      glEnableClientState(GL_VERTEX_ARRAY);
      glBindVertexArray(bunnyVAO);
      glDrawElements(GL_TRIANGLES, NUM_TRIANGLES, GL_UNSIGNED_INT, NULL);
      glDisableClientState(GL_VERTEX_ARRAY);
    // unbind active buffers //
    glBindVertexArray(0);
  }
} 
```

我可以在屏幕上看到一些东西，但这是不正确的，因为没有正确使用法线......到目前为止，我如何使用与我的代码正确连接的值数组。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T22:29:15.183

您需要调用 glVertexAttribPointer 两次，一次用于顶点，一次用于法线。这就是你告诉 OpenGL 你的数据是如何在你的顶点缓冲区中布局的。

```
// Vertices consist of 3 floats, occurring every 24 bytes (6 floats), 
// starting at byte 0.
glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 24, 0);

// Normals consist of 3 floats, occurring every 24 bytes starting at byte 12.
glVertexAttribPointer(1, 3, GL_FLOAT, GL_FALSE, 24, 12); 
```

这是假设着色器中的普通属性的索引为 1。

# jquery - 使用 jquery 平移全屏图像，同时保持居中

> ID：16047236
> 
> 赞同：3
> 
> 时间：2013-04-16T21:15:02.760
> 
> 标签：jquery, pan

全屏背景以

```
background: url(image) no-repeat center center; 
```

现在我希望每当用户移动鼠标时背景图像都会轻微移动。我遇到了几种方法/插件来做到这一点，但不是我想要的，所以我选择这样做（我也在某处找到）：

```
$("body").bind('mousemove', function(e){
    var ypos=(e.pageY-100)/12 + 10;
    var xpos=(e.pageX-100)/18 + 10;
    $(this).css({backgroundPosition: xpos * (-1) + 'px ' + ypos * (-1) + 'px' });
}); 
```

不同的值（/12、+10）只是我任意选择的值，因为它们给了我想要的结果——不确定这是否是正确的方法。无论如何，现在的问题是，当页面从头开始加载（不移动鼠标）时，一切看起来都很好（图像居中）。

如果启用了上面发布的脚本并且您移动鼠标，则背景图像“跳跃”某处（根据位置值），因此它从图像的最左上角显示它不应该。

不幸的是我不能自己编码（只是编辑一些基本的东西）而且数学总是很差。这显然是“只是”一个数学问题，但谁能帮我弄清楚我必须改变什么，所以背景图像基本上总是居中，但在各个方向上只移动了 50 像素（或其他什么）？

基本上是这样的[http://manos.malihu.gr/tuts/jquery_image_panning_liquid.html](http://manos.malihu.gr/tuts/jquery_image_panning_liquid.html)，但没有实际的图像，但只有 css / 背景。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T22:12:18.960

在答案部分发布我快速编写的代码以保持可读性。这*可能会*间接解决您的问题。

```
 $(function(){
        var mousex = mousey = null;
        $('body').mousemove(function(ev){
           if(mousex === null || mousey === null){
              //get initial x/y position for mouse cursor
              mousex = ev.pageX;
              mousey = ev.pageY;
           }

           window.clearTimeout(window.mouse_timeout);

           window.mouse_timeout = window.setTimeout(function(){
              console.log('mouse moved', ev.pageX - mousex, ev.pageY - mousey);

              /* now that you've the absolute position of the mouse and delta x/y here, you can move your background accordingly */

              //update the variables to the latest picket position of the mouse
              mousex = ev.pageX;
              mousey = ev.pageY;
           }, 10)
        });
     }); 
```

* * *

## 更新

[jsfiddle](http://jsfiddle.net/s84rJ/)此代码将初始鼠标位置标记为*中心*参考点，并稍后参考该点计算鼠标移动。

## 标记

```
<div id="outer_container">
    <div id="imagePan">
        <div class="container">
            <div id="mov">
                <img src="http://i.imgur.com/92Z5zCM.jpg" class="panning" />
            </div>
        </div>
    </div>
</div> 
```

## CSS

```
html, body{ height: 100%; }
body{ margin: 0; padding: 0; background: #eee; }
#outer_container{ position: relative; margin: auto; padding: 4px; border: 8px solid #dadada; height: 90%; width: 80%; background: #CDD7E0}
#imagePan{ position: relative; overflow: hidden; cursor: crosshair; height: 100%; width: 100%; }
#imagePan .container{ position: relative; left: 0; }
#mov{ margin: -51px -391px 0 } 
```

## Javascript

```
 var originX = originY = xUnit = yUnit = dX = dY = mov = null;
     $(window).load(function () {
        mov = $('#mov');
        initMarginL = parseInt(mov.css('margin-left'));
        initMarginT = parseInt(mov.css('margin-top'));

        $('#outer_container').mousemove(function (ev) {
           if (originX === null || originY === null) {
              originX = ev.pageX;
              originY = ev.pageY;

              xUnit = parseFloat((Math.max(originX, $(window).width()) / $(window).width()).toFixed(2));
              yUnit = parseFloat((Math.max(originY, $(window).height()) / $(window).height()).toFixed(2));
           }

           var dX = originX - ev.pageX;
           var dY = originY - ev.pageY;

           mov.css({
              marginLeft: initMarginL + (dX * xUnit),
              marginTop: initMarginT + (dY * yUnit)
           });
        });
     }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T09:07:23.323

由于“中心中心”显然与“50％50％”相同，我想我刚刚找到了答案！:)

```
$('body').mousemove(function(e){
  var mousePosX = 50 + (e.pageX/$(window).width())*10;
  var mousePosY = 50 + (e.pageY/$(window).height())*5;
  $(this).css('backgroundPosition', mousePosX + '% ' +  mousePosY + '%');
}); 
```

使用较小的分辨率（比 1920 年）仍然移动得太快，但除此之外它仍然有效。

# php - xml 下载 - 被阻止

> ID：16047237
> 
> 赞同：1
> 
> 时间：2013-04-16T21:15:05.137
> 
> 标签：php, xml, file-get-contents

我正在尝试从一个波兰网站下载 xml 文件。第一天它可以工作，但后来我可以将此文件下载到我的服务器（但我可以在我的计算机上打开并下载它）。在我的服务器上应该有 xml 内容的文件中是 html 内容，告诉我我已被阻止。

我试图从我想从中获取 xml 的网站与网站管理员联系，他告诉我我没有被 IP 地址阻止。所以问题是我应该在标题中发送什么或下载这个文件？

我下载 xml 文件的代码如下，这是我要下载的 xml：[http ://www.polskatimes.pl/rss/fakty_kraj.xml](http://www.polskatimes.pl/rss/fakty_kraj.xml)

```
$headers[]  = "User-Agent:Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.13) Gecko/20101203 Firefox/3.6.13";
$headers[]  = "Accept:text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8";
$headers[]  = "Accept-Language:pl-PL,pl;q=0.8";
$headers[]  = "Accept-Encoding:gzip,deflate,sdch";
$headers[]  = "Accept-Charset:ISO-8859-1,utf-8;q=0.7,*;q=0.7";
$headers[]  = "Keep-Alive:115";
$headers[]  = "Connection:keep-alive";
$headers[]  = "Cache-Control:max-age=0";

$xml_data = file_get_contents($xml,false,stream_context_create(
    array("http" => array('header' => $headers)))); // your file is in the string "$xml" now.
file_put_contents($xml_md5, $xml_data); // now your xml file is saved. 
```

以详细模式 (-v) 请求 URL：

```
* About to connect() to www.polskatimes.pl port 80 (#0)
*   Trying 195.8.99.38... connected
* Connectede to www.polskatimes.pl (195.8.99.38) port 80 (#0)
> GET /rss/fakty_kraj.xml HTTP/1.1
> User-Agent: curl/7.21.0 (x86_64-pc-linux-gnu) libcurl/7.21.0 OpenSSL/0.9.8o zlib/1.2.3.4 libidn/1.15 libssh2/1.2.6
> Host: www.polskatimes.pl
> Accept: */*
>
< HTTP/1.1 200 OK
< Server: nginx
< Date: Thu, 18 Apr 2013 10:40:15 GMT
< Content-Type: text/html; charset=utf8
< Transfer-Encoding: chunked
< Connection: close
< Vary: Accept-Encoding
< Expires: Thu, 18 Apr 2013 10:40:15 GMT
< Cache-Control: max-age=0
(html page with message that I am temporary blocked)
* Closing connection #0 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T17:58:50.913

要检查幕后发生的事情（以及您实际需要或不需要哪些标头），您需要进行一些分析。这没什么神奇的，您可以使用名为*curl*的软件在命令行上执行此操作。它适用于许多（甚至所有？）计算机平台。

第一步通常是以详细模式（`-v`）请求 URL：

```
$ curl -v http://www.polskatimes.pl/rss/fakty_kraj.xml
* About to connect() to www.polskatimes.pl port 80 (#0)
*   Trying 195.8.99.38... connected
* Connected to www.polskatimes.pl (195.8.99.38) port 80 (#0)
> GET /rss/fakty_kraj.xml HTTP/1.1
> User-Agent: curl/7.21.1 (i686-pc-mingw32) libcurl/7.21.1 OpenSSL/0.9.8r zlib/1.2.3
> Host: www.polskatimes.pl
> Accept: */*
>
< HTTP/1.1 302 Found
< Date: Wed, 17 Apr 2013 17:39:51 GMT
< Server: Apache
< Set-Cookie: sprawdz_cookie=1; expires=Thu, 17-Apr-2014 17:39:51 GMT
< Location: http://www.polskatimes.pl/rss/fakty_kraj.xml?cookie=1
< Vary: Accept-Encoding
< Content-Length: 0
< Connection: close
< Content-Type: text/html; charset=iso-8859-2
<
* Closing connection #0 
```

这向您显示了请求（以*>*为前缀）和响应（以*<*为前缀）标头和响应正文（在这种情况下为空）。如您所见，状态为*302 Found*，这意味着 3xx 是重定向，并且位置标头告诉您去哪里：

```
Location: http://www.polskatimes.pl/rss/fakty_kraj.xml?cookie=1 
```

正如查询参数所暗示的，这是一个 cookie 检查。cookie 本身也已设置：

```
Set-Cookie: sprawdz_cookie=1; expires=Thu, 17-Apr-2014 17:39:51 GMT 
```

因此，在下一步中，我们将重播最后一个命令，但这次设置 cookie 可以使用`-b`参数完成：

```
$ curl -v -b prawdz_cookie=1 http://www.polskatimes.pl/rss/fakty_kraj.xml
* About to connect() to www.polskatimes.pl port 80 (#0)
*   Trying 195.8.99.38... connected
* Connected to www.polskatimes.pl (195.8.99.38) port 80 (#0)
> GET /rss/fakty_kraj.xml HTTP/1.1
> User-Agent: curl/7.21.1 (i686-pc-mingw32) libcurl/7.21.1 OpenSSL/0.9.8r zlib/1.2.3
> Host: www.polskatimes.pl
> Accept: */*
> Cookie: prawdz_cookie=1
>
< HTTP/1.1 200 OK
< Date: Wed, 17 Apr 2013 17:43:52 GMT
< Server: Apache
< Set-Cookie: sesja_gratka=e38fa0eb93705c8de7ae906198494439; expires=Wed, 24-Apr-2013 17:43:52 GMT; path=/; domain=polskatimes.pl
< Expires: Thu, 19 Nov 1981 08:52:00 GMT
< Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0
< Pragma: no-cache
< Vary: Accept-Encoding
< Connection: close
< Transfer-Encoding: chunked
< Content-Type: text/xml; charset=utf-8
<
<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title><![CDATA[Fakty - Kraj]]></title>
    <link>http://www.polskatimes.pl/fakty/kraj/</link>
    <atom:link href="http://www.polskatimes.pl/rss/fakty_kraj.xml" rel="self" type="application/rss+xml"/>
    <description><![CDATA[Materia┼éy z dzia┼éu Kraj]]></description>
... (cutted) 
```

所以这立即成功。现在真正好的部分：您知道您需要为请求设置 cookie，*并且*curl 已经向您显示了它使用的所有标头：

```
> GET /rss/fakty_kraj.xml HTTP/1.1
> User-Agent: curl/7.21.1 (i686-pc-mingw32) libcurl/7.21.1 OpenSSL/0.9.8r zlib/1.2.3
> Host: www.polskatimes.pl
> Accept: */*
> Cookie: prawdz_cookie=1 
```

他们中的大多数你不需要关心`file_get_contents`第一行以及*Host:*和*Accept:*行。

*User-Agent:*标头看起来并没有真正发挥作用，因为 curl 被接受。

所以剩下的就是*Cookie:*标头。让我们在 PHP 中尝试：

```
$ php -r "echo file_get_contents('http://www.polskatimes.pl/rss/fakty_kraj.xml', null, 
stream_context_create(['http'=>['header'=>['Cookie: prawdz_cookie=1']]]));"
<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title><![CDATA[Fakty - Kraj]]></title>
    <link>http://www.polskatimes.pl/fakty/kraj/</link>
    <atom:link href="http://www.polskatimes.pl/rss/fakty_kraj.xml" rel="self" 
    type="application/rss+xml"/>
...  (cutted) 
```

这是只需要*Set-Cookie: prawdz_cookie=1*标头的直接测试。

# .htaccess - htaccess 子目录重定向

> ID：16047240
> 
> 赞同：0
> 
> 时间：2013-04-16T21:15:11.047
> 
> 标签：.htaccess, dns, subdomain

无论如何我可以将我的子域索引重定向到我的主域吗？

从 Subdomain.Domain.com/index 或 Domain.com/SubDomainFolder/index 到仅 Domain.com

尝试了 StackOverflow 的几种方法，但似乎没有任何效果。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T21:19:58.243

通过启用 mod_rewrite 和 .htaccess `httpd.conf`，然后将此代码放在您`.htaccess`的`DOCUMENT_ROOT`目录下：

```
Options +FollowSymLinks -MultiViews
# Turn mod_rewrite on
RewriteEngine On
RewriteBase /

RewriteCond %{HTTP_HOST} ^(?:subdomain\.)?(domain\.com)$ [NC]
RewriteRule ^(?:SubDomainFolder/|)(index)/?$ http://%1/? [L,R,NC] 
```

# php - SQL查询从两个表中抓取数据

> ID：16047241
> 
> 赞同：1
> 
> 时间：2013-04-16T21:15:14.527
> 
> 标签：php, mysql, sql, join

我现在的代码是这个

```
$extract = mysqli_query($dbc, "SELECT * FROM items");
$numrows = mysqli_num_rows($extract);
while($row = mysqli_fetch_assoc($extract)) {
    $id = $row['i_id'];
    $iname = $row['i_name'];    
    echo "<tr><td><a href='capture.php?item_id=$id'>$iname</a></td><td>Incomplete</td></tr>";
} 
```

我想要做的是检查项目是否已经完成。我有一个包含信息的单独表，例如说第 1 项已经完成，然后我希望能够将我的回显更改为：

```
 echo "<tr><td>$iname</td><td>Complete!</td></tr>"; 
```

**我将如何做到这一点？我需要使用某种形式的连接语句吗？**

我希望能够显示表中的所有项目但不重复它们我最初认为在回显上的 if 语句以查看项目是否完成然后执行此操作否则执行此操作

这是两张表

```
Items                      item_collection
------                     ---------------
i_id                       i_id
i_name                     complete
                           caption
                           image
                           c_id
                           g_id 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T21:29:41.193

您可以使用这样的连接条件（假设 complete 是一个 varchar 字段）

```
SELECT a.i_id, a.i_name,
CASE WHEN i_status = '1' THEN 'Complete!' ELSE 'Incomplete' END AS complete_status
FROM items a 
LEFT OUTER JOIN item_collection b ON a.i_id = b.i_id 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T21:35:15.293

```
select 
case 
  when ic.complete = 1 then 'Complete'   
  else 'Incomplete'
end as item_status
from items i
left join item_collection ic on i.i_id = ic.i_id
where i.i_name = 'your_item_name' 
```

假设项目完成时 ic.complete = 1。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T21:19:31.237

SELECT * FROM table1 WHERE table1.id not in (SELECT Id FROM table2)

# c# - 从 Git 存储库部署到 Azure 时如何处理 DLL

> ID：16047246
> 
> 赞同：1
> 
> 时间：2013-04-16T21:15:30.597
> 
> 标签：c#, git, deployment, azure

我正在尝试使用 git repo 将 C# 应用程序部署到天蓝色，但它没有说：

```
The type or namespace name 'Mvc' does not exist in the namespace 'System.Web' (are you missing an assembly reference?) 
```

目前，所有 DLL 都从存储库中排除。我不想包含所有这些 DLL，因为它会使我的存储库变得巨大。有没有办法必须这样做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T07:35:23.060

您需要做的就是在您的解决方案上打开 NuGet 包还原（右键单击 VS 中的解决方案以找到该选项）。

然后，您可以使用 .gitignore 排除所有二进制文件。有关示例，请参阅[此 repo 。](https://github.com/KuduApps/Mvc4Application)

# javascript - 从以前的搜索中重置隐藏的项目

> ID：16047250
> 
> 赞同：2
> 
> 时间：2013-04-16T21:15:33.960
> 
> 标签：javascript, jquery

我正在尝试在 Javascript 中为我的应用程序实现搜索，但我遇到了一个问题，即我以前隐藏的项目不会再次出现。[JSFiddle](http://jsfiddle.net/for3v3rforgott3n/Y5w5r/9/)

我的代码在这里：

```
$('#search').keyup(function() {
    var val = $.trim($(this).val()).replace(/ +/g, ' ').toLowerCase();

    $searchproject.show().filter(function() {
        var text = $(this).text().replace(/\s+/g, ' ').toLowerCase();
        return !~text.indexOf(val);
    }).parents('div.srcprojects').hide();
}); 
```

问题是我隐藏了过滤选择的父 srcprojects 容器，因此 keyup 不再显示它。

但是，如果我改变

```
$searchproject.show().filter(function() { 
```

至

```
$searchproject.parents('div.srcprojects').show().filter(function() { 
```

它根本不起作用。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T21:45:15.630

通过添加解决

```
$searchproject.parents('div.srcprojects').show(); 
```

完整代码：

```
$('#search').keyup(function() {
    var val = $.trim($(this).val()).replace(/ +/g, ' ').toLowerCase();
    $searchproject.parents('div.srcprojects').show();
    $searchproject.show().filter(function() {
        var text = $(this).text().replace(/\s+/g, ' ').toLowerCase();
        return !~text.indexOf(val);
    }).parents('div.srcprojects').hide();
}); 
```

# javascript - 通过 Chrome Inspector 或 Firebug识别正在运行的 Javascript

> ID：16047252
> 
> 赞同：0
> 
> 时间：2013-04-16T21:15:45.497
> 
> 标签：javascript, html, firebug, inspect

我正在一个网站上工作，该网站`<span></span>`通过 jQuery 将信息动态生成到标签中。跨度有一个“价格”类和一个产品代码的 ID，它是根据 ID 从 JSON 数据表生成的。问题是，这是一个更大框架的一部分，我似乎无法找到完成此任务的 Javascript 的位置，因此我可以对其进行故障排除。

我试图弄清楚如何使用 Google Chrome Inspector 或 Firebug 找出答案。我假设页面在加载时会记录此信息，但我似乎无法找到该信息所在的位置。我知道这可能是非常基本的，但我对 Inspectors 的了解不仅仅是阅读 HTML 和 CSS。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T21:31:24.093

尝试转到浏览器中的 javascript 控制台并使用以下命令：

```
$("#ProductCode").data("events") 
```

然后，如果您展开对象，您将看到事件。

# r - 合并具有不同列名的表

> ID：16047253
> 
> 赞同：9
> 
> 时间：2013-04-16T21:15:53.890
> 
> 标签：r, merge, data.table

如果我理解正确，默认情况下`data.table`通过比较设置为键并具有相同名称的列来合并两个表。如果我有不同列名的表，我应该怎么写？例如：

```
set.seed(123)
DT1<-data.table(col1=sample(letters,5,replace=TRUE),col2=sample(LETTERS[1:5],5,replace=TRUE),col3=sample(1:2,5,replace=TRUE))
DT2<-data.table(col4=sample(1:3,10,replace=TRUE),col5=sample(LETTERS[1:5],10,replace=TRUE),col6=sample(1:100,10,replace=TRUE))
(DT1)
(DT2)

> (DT1)
   col1 col2 col3
1:    h    A    2
2:    u    C    1
3:    k    E    2
4:    w    C    2
5:    y    C    1
> (DT2)
    col4 col5 col6
 1:    3    D   48
 2:    1    C   76
 3:    1    C   22
 4:    1    B   32
 5:    3    A   24
 6:    3    E   15
 7:    3    E   42
 8:    2    D   42
 9:    3    D   37
10:    2    A   16 
```

我应该写什么`DT1[`来合并只选择 col2==col5 & col3==col4 的行？这是预期的输出：

```
 col1 col2 col3 col4 col5 col6
    h    A    2    2    A   16
    u    C    1    1    C   76
    u    C    1    1    C   22
    y    C    1    1    C   76
    y    C    1    1    C   22 
```

提前致谢！

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-04-16T21:31:16.080

使用 data.table 的基于子集的连接以及最近实现的`on=`参数 and `nomatch=0L`，这很简单：

```
DT2[DT1, on=c(col5="col2", col4="col3"), nomatch=0L] 
```

有关更多信息，请参阅[二级索引](https://github.com/Rdatatable/data.table/wiki/Getting-started)小插图。

* * *

或者，如果您已键入 data.tables，则可以跳过该`on=`参数。但是上面的解决方案是惯用的，因为它保留了原始 data.tables 的顺序，并且通过查看代码可以清楚地知道正在查找哪些列。

```
setkey(DT1, col2, col3)
setkey(DT2, col5, col4)
DT2[DT1, nomatch=0L] 
```

查看旧版本的历史记录。

# sql - 从同一个表中选择并按行显示

> ID：16047258
> 
> 赞同：0
> 
> 时间：2013-04-16T21:16:33.237
> 
> 标签：sql, oracle, join

我有一个包含各种列表项的表

```
*LIST_ITEMS*
 ID
 LIST_ID_FK
 DESCRIPTION
 VALUE_ID_FK 
```

我需要选择 LIST_ID_FK 等于 1 的所有说明和 LIST_ID_FK = 2 的所有说明和 LIST_ID_FK = 3 的所有说明

```
 LIST_ID_FK value 1's have no VALUE_ID_FK
 LIST_ID_FK value 2's have the FK of value 1 in the VALUE_ID_FK column
 LIST_ID_FK value 3's have the FK of value 2 in the VALUE_ID_FK column 
```

输出应该是这样的：

```
List1    List2      List3
England  Liverpool  test3
England  London     test1
England  London     test2
England  London     test3 
```

我遇到的问题是试图将所有内容从同一张表中取出并相互链接以组成行。这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T21:31:29.727

您可以将 连接`list_ID_FK`到单词 test

```
SELECT Description, 'test' || list_ID_FK List3
FROM mytable
WHERE list_ID_FK IN (1,2,3) 
```

或者，您可以使用 UNION。第一个选项几乎肯定更快

```
SELECT Description, test1 List3
FROM mytable
WHERE list_ID_FK = 1
UNION
SELECT Description, test2 List3
FROM mytable
WHERE list_ID_FK = 2
UNION
SELECT Description, test3 List3
FROM mytable
WHERE list_ID_FK = 3 
```

# asp.net-web-api - 我必须将 ContinueWith 与 HttpClient 一起使用吗？

> ID：16047259
> 
> 赞同：0
> 
> 时间：2013-04-16T21:16:40.400
> 
> 标签：asp.net-web-api, dotnet-httpclient

当使用 System.Net.Http.HttpClient 调用休息服务时，我有类似的代码

```
var response = client.GetAsync("api/MyController").Result;
if(response.IsSuccessStatusCode)
... 
```

那是正确的还是我应该这样做

```
client.GetAsync("api/MyController").ContinueWith(task => { var response = task.Result; ...} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T22:34:04.123

做第二个更安全。在多种情况下，第一个选项可能会导致死锁。

# html - 如何将页脚放置在页面底部或内容下方

> ID：16047261
> 
> 赞同：0
> 
> 时间：2013-04-16T21:16:52.707
> 
> 标签：html, css, position, footer

我希望我的页脚一直位于页面底部，因为我的页面没有那么长。

但是当页面比屏幕长时，它需要像页脚一样位于内容下方，而不是卡在屏幕底部。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T21:25:55.507

如果您的页脚具有固定高度，最简单且仅使用 CSS 的解决方案是：

**CSS**

```
html {
    position: relative;
    min-height: 100%;
}

body {
    /* height of the footer */
    margin: 0 0 120px 0;
}

footer {
    position: absolute;
    bottom: 0;
    height: 120px;
} 
```

**演示**

*   [用简短的内容试试](http://jsfiddle.net/5QBQ3/)
*   [尝试大量内容](http://jsfiddle.net/yGKKQ/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T21:29:27.200

这可能会有所帮助；

[jQuery 粘滞页脚](http://css-tricks.com/snippets/jquery/jquery-sticky-footer/)

[演示](http://css-tricks.com/examples/jQueryStickyFooter/)

# css - 段落样式的CSS不起作用

> ID：16047265
> 
> 赞同：0
> 
> 时间：2013-04-16T21:16:57.160
> 
> 标签：css

我有以下代码，它是 php 脚本的一部分。这

方括号可以正常工作，即如果我将其更改为 h1 标题，它会显示标题 1，但是当我尝试使用样式类时它不会。我究竟做错了什么？

```
<p class="indexletters">-<a name="'.substr($row['name'],0,1).'">'.substr

($row['name'],0,1).'-</p> 
```

这是CSS

```
p.indexletters { 
color:#00A383;letter-spacing:1px;font-family: PosterBodoni; font-size: 

50px; margin: 0;
    padding: 0;
    border: 0;
    outline: 0;" 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T21:18:09.673

您以`"`CSS 结尾应该如下所示：

```
p.indexletters{ 
    color:#00A383;
    letter-spacing:1px;
    font-family: PosterBodoni;
    font-size: 50px;
    margin: 0;
    padding: 0;
    border: 0;
    outline: 0;
} 
```

# ruby-on-rails - 动态添加额外对象时Railsnested_forms不显示字段

> ID：16047267
> 
> 赞同：1
> 
> 时间：2013-04-16T21:17:00.573
> 
> 标签：ruby-on-rails, nested, nested-forms, nested-attributes

我目前正在使用nested_forms gem，并且我正在尝试能够将多个房东添加到一个属性中。

目前关联比较深：房产->房东->联系方式->地址

在我的属性控制器中，我正在构建关联，并且初始表单正确显示。但是，使用添加字段按钮后，没有字段。我知道这与未构建的对象有关，但我不明白为什么。

这是我的属性模型：

```
belongs_to :address
belongs_to :estate_agent
belongs_to :property_style

has_and_belongs_to_many :landlord
has_and_belongs_to_many :tenancy_agreement

attr_accessible :landlord_attributes, :address_attributes, :estate_agent_attributes, 
:property_style_attributes, :sector, :reference , :occupied, :available_date, :property_style_attributes,...

accepts_nested_attributes_for :landlord, :address, :estate_agent, :property_style, :tenancy_agreement 
```

这是 Property 控制器中的新功能：

```
 def new
    @property = Property.new
    @property.build_address
    @property.landlord.build.build_contact_detail.build_address

    @property.estate_agent_id = current_user.estate_agent_id

    respond_to do |format|
      format.html # new.html.erb
      format.json { render json: @property }
    end
end 
```

我对此进行了很多尝试，但看不出我哪里出错了，是nested_form gem 不支持这么多级别的关联或关联类型的问题吗？

谢谢！

*编辑* 所做的更改：

```
belongs_to :address
belongs_to :estate_agent
belongs_to :property_style

has_and_belongs_to_many :landlords
has_and_belongs_to_many :tenancy_agreements

attr_accessible :landlords_attributes, :address_attributes, :estate_agent_attributes, 
:property_style_attributes, :sector, :reference , :occupied, :available_date,  :property_style_attributes,...

accepts_nested_attributes_for :landlords, :address, :estate_agent, :property_style, :tenancy_agreements 
```

属性控制器：

```
@property.landlords.build.build_contact_detail.build_address 
```

地主模型

```
has_and_belongs_to_many :properties 
```

这是我的看法：

```
<%= nested_form_for(@property) do |f| %>
<% if @property.errors.any? %>
<div id="error_explanation">
  <h2><%= pluralize(@property.errors.count, "error") %> prohibited this property from being saved:</h2>

  <ul>
  <% @property.errors.full_messages.each do |msg| %>
    <li><%= msg %></li>
  <% end %>
  </ul>
</div>
<% end %>

<h2>Landlords</h2>

<%= f.fields_for :landlords %>

<p><%= f.link_to_add "Add a Landlord", :landlords %></p>

 <div class="actions">
<%= f.submit %>
</div>
<% end %> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T03:31:38.377

除非您将“地主”指定为[不规则变形](http://api.rubyonrails.org/classes/ActiveSupport/Inflector/Inflections.html)，否则 Rails 将假定它是单数。多对多关联应以复数形式声明。

尝试将多对多关联更改为：

```
has_and_belongs_to_many :landlords
has_and_belongs_to_many :tenancy_agreements 
```

您还需要将所有对这些的调用更改为复数。此外，您必须更改`accepts_nested_attributes_for`to`landlords`和`attr_accessible`from `landlord_attributes`to `landlords_attributes`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T17:01:45.593

我尝试同时使用 awesome-nested-forms 和 cocoon ，但它仍然无法正常工作。

最后，我通过在部分而不是在控制器中构建对象找到了一种解决方法。像这样：

```
<% f.object.build_contact_detail.build_address %> 
```

我希望这对其他人有帮助！

# php - WP3 手册摘录未显示

> ID：16047269
> 
> 赞同：1
> 
> 时间：2013-04-16T21:17:10.807
> 
> 标签：php, wordpress-theming

我正在努力使用一些 wordpress 主题代码，我的目标是创建一个基于特定类别的帖子列表，这些帖子的内容应该是手动摘录使用摘录字段的帖子。

我的问题是，无论我做什么，我的主题都会继续显示自动摘录并且完全拒绝我的手动版本，比如手动摘录被禁用或其他什么，我已经用谷歌搜索了很长时间，但找不到任何解决方案。

有什么建议么 ？

**数据：** WP 3.5.1 版主题：从头开始

我的 category.php 中有这段代码

```
<?php get_header(); ?>

<div class="listview_page_header">
    <p> <?php echo single_cat_title( '', false ); ?></a>
</div>

<?php
query_posts('cat=3');
while(have_posts()) : the_post();
?>
<ul>
<li><h3><a href="<?php the_permalink() ?>" rel="bookmark"><?php the_title(); ?></a></h3>
<ul><li><?php the_excerpt(); ?></li>
</ul>
</li>
</ul>
<?php endwhile; ?>

<?php //get_footer(); ?> 
```

//M

# python - .. 重组文本中的绘图指令

> ID：16047271
> 
> 赞同：1
> 
> 时间：2013-04-16T21:17:18.207
> 
> 标签：python, python-sphinx, restructuredtext

我在看[这个网站](http://matplotlib.org/basemap/users/geography.html)。具体来说，[来源](http://matplotlib.org/basemap/_sources/users/geography.txt). 似乎创建一个情节（完整的源代码！）非常容易：

```
.. plot: somefile.py 
```

但是，当我尝试时，斯芬克斯对我大喊大叫。 `"ERROR: Unknown directive type "plot".` 所以问题是我如何教狮身人面像的`plot`指令？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T21:24:36.337

您需要激活 sphinx 的绘图扩展（请参阅[此说明](http://matplotlib.org/sampledoc/extensions.html)）。我没有尝试过，但这可能就足够了：

```
extensions = ['matplotlib.sphinxext.plot_directive'] 
```

将此添加到您`conf.py`的激活`.. plot::`.

**注意**：Sphinx 指令以**两个**冒号开头：

```
.. plot::

    ... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T21:24:10.493

`matplotlib`包括用于指令的 Sphinx`plot`指令；请参阅他们[的 Sphinx 示例文档](http://matplotlib.org/sampledoc/extensions.html)和[文档`matplotlib`章节](http://matplotlib.org/devel/documenting_mpl.html)。

# node.js - OData、JayData 和 node.js：找不到 ExpressionVisitor.js

> ID：16047276
> 
> 赞同：0
> 
> 时间：2013-04-16T21:17:43.787
> 
> 标签：node.js, odata, jaydata

我跑了`npm install odata-server`，但调用`require('odata-server')`失败并显示以下内容：

```
Using JayLint for code parsing

module.js:340
    throw err;
          ^
Error: Cannot find module './Types/Expressions/Visitors/ExpressionVisitor.js'
    at Function.Module._resolveFilename (module.js:338:15)
    at Function.Module._load (module.js:280:25)
    at Module.require (module.js:362:17)
    at require (module.js:378:17)
    at Object.<anonymous> (/home/anewman/node_modules/odata-server/lib/jaydata/lib/index.js:28:1)
    at Module._compile (module.js:449:26)
    at Object.Module._extensions..js (module.js:467:10)
    at Module.load (module.js:356:32)
    at Function.Module._load (module.js:312:12)
    at Module.require (module.js:362:17) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T08:29:46.263

尝试重新安装模块并检查丢失的文件是否存在。还请检查您的 NODE_PATH 设置，因为该库在下面找不到 acorn 解析器模块`~/node_modules/odata-server/lib/jaydata/node-modules/acorn`

# redirect - 来自 aweber 重定向的访问被拒绝

> ID：16047279
> 
> 赞同：0
> 
> 时间：2013-04-16T21:17:59.127
> 
> 标签：redirect, access-denied, aweber

我的域中的一个页面设置为来自 aweber 的重定向，因此当我确认来自 aweber 的电子邮件 optin 上的链接时，它会重定向到此页面 MyPage.html 并包含一条带有我注册名称的欢迎消息。

现在授予我不确定这是否与设置重定向的 aweber 有关，尽管它很容易做到（基本上将 URL 粘贴到要重定向到的设置中）并且我已经对其进行了双重/三重检查。我还联系了 aweber 支持人员，他们说可能是嵌入在重定向页面 Head 部分中的用于个性化的 javascript 可能导致此错误。我已删除此代码，并且可以确认它不是导致它的 javascript 或重定向，因此我出现在这里。

我还有使用此重定向和个性化的网站的另一部分，它工作正常。

现在，当我单击来自 aweber 的电子邮件中的链接时，它给了我这个错误：

> 禁止的
> 
> 您无权访问此服务器上的 /mypage.html。
> 
> 此外，在尝试使用 >ErrorDocument 处理请求时遇到 500 Internal Server Error 错误。

并且重定向 URL 在下面，因此我可以看到它正在重定向我的详细信息，但无法让我访问该页面。

> mysite.com/mypage.html?email=myemail%40yahoo.co.uk&from=myemail%40yahoo.co.uk&meta_adtracking=my_web_site&meta_message=1001&name=MyName&unit=MyAweberListName&add_url=http%3A%2F%2Fwww.MySite.com%2FthankyouPage.html&add_notes= xx.xx.xx.xxx

我所有的页面都具有访问权限 644，并且该页面是我的其他页面之一的副本，它工作正常，我没有添加任何内容，没有更改任何内容，只是删除了文本行和图形。

我刚刚也尝试重新制作登录页面，但它再次失败。有趣的是，当我手动将页面输入到 URL 栏中时，它会出现；这以前也适用于原始页面！

这有效：

> mysite.com/mypage.html

此 [redirect] 不会并给出上述错误

> mysite.com/mypage.html?email=myemail%40yahoo.co.uk&from=myemail%40yahoo.co.uk&meta_adtracking=my_web_site&meta_message=1001&name=MyName&unit=MyAweberListName&add_url=http%3A%2F%2Fwww.MySite.com%2FthankyouPage.html&add_notes= xx.xx.xx.xxx

任何关于深入了解这一点的想法将不胜感激。

主机是hostgator

# php - 用于密码字段验证的正则表达式

> ID：16047281
> 
> 赞同：2
> 
> 时间：2013-04-16T21:18:12.713
> 
> 标签：php, html, regex

对不起，如果这段代码很糟糕，因为我只是在不到一个月前开始使用 php 时，我只是在阅读一本书并为我的学校项目修改它。

我试图了解此验证的含义，但似乎无法完全理解它，因为我是 php 新手。

代码：

```
if (preg_match ('/^(\w*(?=\w*\d)(?=\w*[a-z])(?=\w*[A-Z])\w*){6,20}$/', $_POST['pass']) ) {

        //$p = mysqli_real_escape_string ($dbc, $_POST['pass']);
        $p = $_POST['pass'];
        $sticky_password = $p;

        } else {
        $error['pass'] = 'Please enter a valid password!';
        } 
```

任何帮助将非常感激！谢谢！

非常感谢你.. ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T22:59:44.187

我们有以下正则表达式： `/^(\w*(?=\w*\d)(?=\w*[a-z])(?=\w*[A-Z])\w*){6,20}$/`

1.  第一个和最后一个`/`是分隔符。

2.  `^`-> 开始，`$`-> 结束

    这意味着如果 input is`abc`并且您的正则表达式 is `/^bc$/`，它将不会匹配，因为 bc 不在开头。

3.  现在我们有`(\w*(?=\w*\d)(?=\w*[a-z])(?=\w*[A-Z])\w*){6,20}`

    是`{6,20}`量词部分，意思是6到20次。

4.  让我们进一步打破正则表达式：`\w*(?=\w*\d)(?=\w*[a-z])(?=\w*[A-Z])\w*`

    让我们提供一些等价物：

    1.  `\w`=> [a-zA-Z0-9_]
    2.  `\d`=> [0-9]
    3.  `*`=> 零次或多次
    4.  `(?=)`是一个前瞻断言。示例`/a(?=b)/`这将匹配任何“a”后跟“b”

    5.  这些前瞻的目的：

        *   `(?=\w*\d)`=> 检查是否有数字
        *   `(?=\w*[a-z])`=> 检查是否有小写字母
        *   `(?=\w*[A-Z])`=> 检查是否有大写字母
        *   让我们看一下`(?=\w*\d)`：如果`\w*`在数字前有 [a-zA-Z0-9_]* ，那只是作为“解决方法”

最后，这个正则表达式只是确保输入：

1.  长度为 6 到 20 个字符
2.  最少：1 个小写字母、1 个大写字母和 1 个数字
3.  允许的字符是字母（大写和小写 (az,AZ)）、数字和下划线。

三个有趣的网站[www.regexper.com](http://www.regexper.com/)、[www.regular-expressions.info](http://www.regular-expressions.info/)和[www.regex101.com](http://www.regex101.com)。

**注意：**不要限制密码，无论如何你都必须对它们进行哈希处理。看看[这里](https://stackoverflow.com/q/401656)或检查关于 SO 的其他问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T22:31:47.917

实际上，此模式匹配所有至少包含 3 个字符（一个数字、一个大写和一个小写，任何顺序）的密码，没有长度限制（正则表达式引擎除外）。所有字符必须是单词字符（即：来自 class `\w`）。

正如量词和前瞻所暗示的那样，作者的意图可能是匹配 6 到 20 个单词字符之间的所有密码，其中至少有一个数字、一个大写和一个小写。

简而言之，这种模式是错误的，但可能针对的是这种经典密码验证模式的作用：

```
^(?=\w*[A-Z])(?=\w*[a-z])(?=\w*\d)\w{6,20}$ 
```

或者这个没有多余的`\w`：

```
^(?=.*[A-Z])(?=.*[a-z])(?=.*\d)\w{6,20}$ 
```

说明：前瞻是零宽度断言，它们不消耗字符，它们只是测试。结果它们中的每一个都是从字符串的开头执行的，因为它们被锚定到`^`. 如果每个前瞻成功，则`\w{6,20}`始终从字符串的开头进行测试，以了解它是否仅包含 6 到 20 个单词字符。`$`表示字符串的结尾。

正如评论中所说，这种模式来自*Larry Ullman 的《Effortless E-commerce》第一版*一书。

即使作者写道：

> *“而且，诚然，即使我也经常需要查找模式的正确语法，但这需要高水平的正则表达式专业知识。”*

即使我不同意句子的第二部分，我认为这种模式只是一个简单的错字。但是我不知道这个是否在第二版中得到了更正。

# batch-file - 如何从批处理脚本中的一行获取两个变量

> ID：16047283
> 
> 赞同：0
> 
> 时间：2013-04-16T21:18:20.370
> 
> 标签：batch-file

我正在尝试解决如何使批处理文件占用一行并设置两个单独的值来备份文件。

例如备份`C:\programfiles`到`D:\`.

如何从一行用户输入中获取这两个值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T21:22:10.180

批处理文件可以直接处理参数 %0 到 %9。

```
%0 is the program name as it was called,
%1 is the first command line parameter,
%2 is the second command line parameter,
and so on till %9. 
```

所以，如果你执行这样的命令：

```
backup c:\Programs d:\ 
```

在批处理文件中，您可以参考这些值：

*   `%0`=`backup`

*   `%1`=`c:\Programs`

*   `%2`=`d:\`

请记住，如果您在文件名中有空格而没有用引号将整个路径括起来，那么它不会按照您想要的方式工作。

# java - Android，如何使用套接字提高网络区域的性能？

> ID：16047289
> 
> 赞同：0
> 
> 时间：2013-04-16T21:18:50.303
> 
> 标签：java, android, performance, sockets

我正在开发一个实时游戏来学习 Android。我正在使用 Tomcat 和 Webservices 在游戏开始时交换一些数据。我正在使用套接字。两个 Android 设备都可以通过套接字与 Java 进程交换信息——这可能是我的服务器。有时他们必须发送信息，有时他们从服务器获取信息。

我已经检查过使用 WiFi 和 3G。令我惊讶的是3G有多慢！所以，我不知道我是否编程正确。确实，我一直很懒，我重用了一个类来发送可能更小的数据。会不会有很大的不同？它有大约 10 个字符串和 5 个整数。可能是... 5？真的，我不认为物体太重。另一件事是这个对象实现了Serializable，我已经读过我可以实现另一个接口，如果你使用Android会更好，但我也在使用Java，所以我不知道它是否就在您使用 Android 时。我认为它被称为`Parcelable`.

我正在尝试做一些接近实时的事情，从单击按钮到服务器返回数据之间，我等待了大约 4-6 秒。

当我按下按钮时，数据使用套接字发送到服务器。服务器处理信息（非常快），并将更新的数据发送给这个用户和他的对手。在 Android 端，我创建了两个`AsynTask`s. 一个总是监听来自服务器的可能的新数据，另一个在用户做某事时向服务器发送数据。

最后一个问题是不同设备更新之间的时间差异。我的意思是，新数据将在其中一台设备上提前 2 秒出现。可以同步这个吗？我猜是因为网络质量不同，所以我猜这可能很难。但是，我该如何改善这方面呢？

更新：

好吧，我将尝试一些代码，但是，代码太多了！！

好的，我认为这是我的第一个错误是我发送的课程太大了，因为我试图将课程重用于离线模式和在线模式。

该类看起来像：

```
/**
 * 
 */
private static final long serialVersionUID = -2849406755758020431L;
private List<Word> listWords;
private long numberWords;

private int score1; 
private int score2;

//OffLine
private int lifes;
private int numWordsNextLevel;
private int speedTime;
private int level;
private int difficult;

//Online
private String message;
private int numPlayers;
private int numWordsGame;
private String namePlayer1;
private String namePlayer2;

//Flags players
private boolean player1failed;
private boolean player2failed; 
```

我认为我可以将其减少到 4 个整数和 2 个字符串和几个布尔值。会不会有区别？这值得么？

这是我在双方发送的课程。真的，我不需要在双方发送相同的数据。所以，我需要发送到服务器的数据非常小。

关于 UDP 或 TCP，当我丢失数据包时会发生什么？人们通常会做些什么来改善它？UDP 比 TCP 快多少？我知道您不必发送 ACK，但是，我真的不知道这部分协议需要多少时间。

我一直在用 DDMS 检查我发送了多少数据，每次大约 1-1.5Kbytes，我认为不会太多，我将创建一个特定的类来交换数据，但是， ，更多关于它的建议？

# css - 即使没有设置清除属性，Div 也会清除浮动

> ID：16047291
> 
> 赞同：0
> 
> 时间：2013-04-16T21:19:02.020
> 
> 标签：css, css-float

这是一个太基本的问题，但我网站上 div 的行为让我感到困惑。

我以前遇到过同样的问题，所以我确信我做错了，一贯地，或者误解了一些基本的 CSS 规则。

**问题：**为什么站点右下角的红色 div 标签会清除左侧对应的标签？没有适用于它的“明确”规则！

这是html：

```
<div id="home-left">
<?php 
echo "Some php=generated content";
?>
</div> <!-- END HOME-LEFT -->

<div id="home-right-container">
<p>Blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah</p>
</div> <!-- END HOME-RIGHT-CONTAINER --> 
```

这是相应的CSS：

```
#home-left {
width:280px;
margin:0 0 0 20px;
//clear:both; /* STAY CLEAR OF THE SCROLLER-FEATHER-CONTAINER! */
}

#home-left h3 {

    //font-size: 1.128571429rem;
font-size:12px;
    line-height: 1.2;
    font-weight: bold;
text-transform:uppercase;
margin-bottom:10px;
}

#home-left p {
    margin: 0 0 24px;
    margin: 0 0 1.514285714rem;
font-size:11px;
    line-height: 1.5;
}

#home-right-container {
width:100px;
background:red;
float:right;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T21:22:19.600

左边的 div 实际上正在清除右边的对应部分。这是因为如果元素不是`floated`，它将基本上占据整个页面宽度的边距。

**两种解决方案：**

1.  添加`float: left`到`div`红色框的左侧。
2.  添加`display: inline-block`到`div`下部红色框的左侧。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T21:23:10.480

因为它出现在文档流右侧的元素之后。

您可以切换元素顺序，这将为您提供所需的结果。或者将另一个元素也浮动到左边，这也可以给出你想要的结果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-16T21:23:26.497

float 允许一个元素浮动到它下面的元素的一侧，而不是它上面的元素。

如果您向左浮动#home-left，则右侧的 div 将在右侧

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-16T21:27:10.380

只需添加 float: left on style.css Line 235。希望这会有所帮助。

# php - 带有 2 个帖子的 Wordpress Wp_query 对象仅打印一个

> ID：16047297
> 
> 赞同：0
> 
> 时间：2013-04-16T21:19:15.893
> 
> 标签：php, wordpress, loops

我需要使用另一种 HTML 格式显示 3 个类别的最新帖子和最后一个类别的两个帖子。问题是最后一个类别只打印一个帖子并`var_dump()`在我可以看到两个帖子的对象上停止。

检查这里的功能：

```
function destaques( $atts ) {
extract( shortcode_atts( array(
    'id' => 0,
), $atts ) );

$id = array(6,16,10,4);
$posts = array();
$nomesCat = array();

foreach ($id as $key => $value) {
    if ($value == 4){
                    //this is the categorie with two posts
        $posts[] = new WP_Query( array('posts_per_page' => 2, 'category__in' => array($value)));
    } else {
        $posts[] = new WP_Query( array('posts_per_page' => 1, 'category__in' => array($value)));    
    }
    $nomesCat[] = get_category($value);
}
$html = '<ul class="destaques">';

foreach ($posts as $key => $value) {
    if ($value->have_posts()){
        while($value->have_posts()){
            $value->the_post();
            if ($nomesCat[$key]->cat_name == 'Colunistas') {
                                    // check for the categorie name, then call another
                                    // function, passing the wp_query object
                $html .= auxiliarColunistas($value);
                break;
            } else {
                //lots of html formatting code
                $html .= '</li>';
            }
        }
    }

}

$html .= '</ul>';
return $html; 
```

这是辅助函数：

```
function auxiliarColunistas ($posts) {
$html = '<li class="last">';

/*var_dump($posts); this returns two posts!
die;*/

$html .= '<h2>Colunistas</h2>';

if ($posts->have_posts()){

    while ($posts->have_posts()) {
        $posts->the_post();
        //more html formatting code
    }
}
$html .= '</li>';

return $html; } 
```

为什么循环只打印一篇文章并停止？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T14:03:54.907

我可以通过改变这一行来解决它：

```
if ($value == 4){
                //this is the categorie with two posts
    $posts_query = new WP_Query( array('posts_per_page' => 2, 'category__in' => array($value))); 
```

至

```
if ($value == 4){
                //this is the categorie with two posts
    $posts_query = new WP_Query( array('posts_per_page' => 3, 'category__in' => array($value))); 
```

但我仍然不明白为什么while循环没有得到最后一篇文章。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T08:45:21.690

尝试这样做

```
foreach ($id as $key => $value) {
    if ($value == 4){
                    //this is the categorie with two posts
        $posts_query = new WP_Query( array('posts_per_page' => 2, 'category__in' => array($value)));
    } else {
        $posts_query = new WP_Query( array('posts_per_page' => 1, 'category__in' => array($value)));    
    }
    $nomesCat[] = get_category($value);
}
$html = '<ul class="destaques">';

        while($posts_query->have_posts()){
            if ($nomesCat[$key]->cat_name == 'Colunistas') {
                                    // check for the categorie name, then call another
                                    // function, passing the wp_query object
                $html .= auxiliarColunistas($posts_query->the_post());
                break;
            } else {
                //lots of html formatting code
                $html .= '</li>';
            } 
```

# docker - Docker 与虚拟机有何不同？

> ID：16047306
> 
> 赞同：4133
> 
> 时间：2013-04-16T21:19:47.263
> 
> 标签：docker, comparison, virtual-machine

我不断重读[Docker 文档](https://docs.docker.com/)，试图了解 Docker 和完整 VM 之间的区别。它如何在不那么重的情况下提供完整的文件系统、隔离的网络环境等？

为什么将软件部署到 Docker 映像（如果这是正确的术语）比简单地部署到一致的生产环境更容易？

* * *

## 回答 #1

> 赞同：3780
> 
> 时间：2013-04-16T22:35:27.317

Docker 最初使用[Linux Containers](https://linuxcontainers.org/lxc/) (LXC)，但后来改用[runC](https://github.com/opencontainers/runc)（以前称为**libcontainer**），它运行在与其主机相同的操作系统中。这允许它共享大量的主机操作系统资源。此外，它使用分层文件系统 ( [AuFS](http://aufs.sourceforge.net/) ) 并管理网络。

AuFS 是一个分层文件系统，因此您可以将只读部分和写入部分合并在一起。可以将操作系统的公共部分设为只读（并在所有容器之间共享），然后为每个容器提供自己的挂载以供写入。

因此，假设您有一个 1 GB 的容器映像；如果您想使用完整的 VM，则需要 1 GB x 所需的 VM 数。使用 Docker 和 AuFS，您可以在所有容器之间共享 1 GB 的大部分空间，如果您有 1000 个容器，您仍然可能只有 1 GB 多一点的空间用于容器操作系统（假设它们都运行相同的操作系统映像） .

一个完整的虚拟化系统获得分配给它自己的一组资源，并进行最少的共享。你得到更多的隔离，但它更重（需要更多的资源）。使用 Docker，您可以获得更少的隔离，但容器是轻量级的（需要更少的资源）。因此，您可以轻松地在主机上运行数千个容器，而且它甚至不会闪烁。试着用 Xen 来做，除非你有一个非常大的主机，否则我认为这是不可能的。

一个完整的虚拟化系统通常需要几分钟才能启动，而 Docker/LXC/runC 容器需要几秒钟，通常甚至不到一秒钟。

每种类型的虚拟化系统各有利弊。如果您想要完全隔离并保证资源，那么完整的 VM 是您的最佳选择。如果您只是想将进程彼此隔离并希望在合理大小的主机上运行大量进程，那么 Docker/LXC/runC 似乎是要走的路。

有关更多信息，请查看[这组博客文章](http://web.archive.org/web/20150326185901/http://blog.dotcloud.com/under-the-hood-linux-kernels-on-dotcloud-part)，这些文章很好地解释了 LXC 的工作原理。

> 为什么将软件部署到 docker 映像（如果这是正确的术语）比简单地部署到一致的生产环境更容易？

部署一致的生产环境说起来容易做起来难。即使您使用[Chef](https://en.wikipedia.org/wiki/Chef_%28software%29)和[Puppet 之](https://en.wikipedia.org/wiki/Puppet_%28software%29)类的工具，也总会有操作系统更新和其他在主机和环境之间发生变化的事情。

Docker 使您能够将操作系统快照到共享映像中，并使其易于部署在其他 Docker 主机上。在本地，dev、qa、prod 等：都是相同的图像。当然，您可以使用其他工具来做到这一点，但几乎没有那么容易或快速。

这非常适合测试；假设您有数千个测试需要连接到数据库，并且每个测试都需要数据库的原始副本并将更改数据。经典的方法是在每次测试后使用自定义代码或[Flyway](https://flywaydb.org/)等工具重置数据库- 这可能非常耗时，并且意味着必须连续运行测试。但是，使用 Docker，您可以创建数据库的映像并在每个测试中运行一个实例，然后并行运行所有测试，因为您知道它们都将针对同一数据库快照运行。由于测试是在 Docker 容器中并行运行的，因此它们可以同时在同一个盒子上运行，并且应该更快地完成。尝试使用完整的 VM 执行此操作。

从评论...

> 有趣的！我想我仍然对“快照[ting] OS”的概念感到困惑。如果没有制作操作系统的图像，如何做到这一点？

好吧，让我们看看我能不能解释一下。您从一个基础映像开始，然后进行更改，并使用 docker 提交这些更改，然后它会创建一个映像。此图像仅包含与基础的差异。当你想运行你的镜像时，你还需要基础，它使用分层文件系统将你的镜像分层在基础之上：如上所述，Docker 使用 AuFS。AuFS 将不同的层合并在一起，你得到你想要的；你只需要运行它。您可以继续添加越来越多的图像（层），它将继续只保存差异。[由于 Docker 通常构建在来自注册表](https://registry.hub.docker.com/)的现成映像之上，因此您很少需要自己“快照”整个操作系统。

* * *

## 回答 #2

> 赞同：687
> 
> 时间：2016-01-13T01:49:50.753

了解虚拟化和容器如何在低级别工作可能会有所帮助。这将清除很多事情。

注意：我在下面的描述中进行了一些简化。有关更多信息，请参阅参考资料。

**虚拟化如何在低级别工作？**

在这种情况下，VM 管理器接管 CPU 环 0（或较新 CPU 中的“根模式”）并拦截来宾操作系统进行的所有特权调用，以制造来宾操作系统拥有自己的硬件的假象。有趣的事实：在 1998 年之前，人们认为在 x86 架构上实现这一点是不可能的，因为没有办法进行这种拦截。VMware 的[人是第](http://web.archive.org/web/20160324005530/https://www.vmware.com/files/pdf/VMware_paravirtualization.pdf)一个想到重写内存中的可执行字节以实现来宾操作系统的特权调用的人。

最终效果是虚拟化允许您在同一硬件上运行两个完全不同的操作系统。每个客户操作系统都会经历引导、加载内核等所有过程。您可以拥有非常严格的安全性。例如，客户操作系统无法获得对主机操作系统或其他客户的完全访问权限，从而搞砸了。

**容器如何在低级别工作？**

大约在[2006 年](http://blog.differential.com/the-story-behind-meteors-next-big-move/)，包括一些 Google 员工在内的人们实现了一个新的内核级功能，称为*命名空间*（不过这个想法[早](http://rhelblog.redhat.com/2015/08/28/the-history-of-containers/)在[FreeBSD 中就已经存在了）](https://www.linux.com/component/content/article/186-virtualization/300057-containers-vs-hypervisors-choosing-the-best-virtualization-technology-)）。操作系统的一项功能是允许进程之间共享网络和磁盘等全局资源。如果这些全局资源被包装在命名空间中以便它们只对在同一命名空间中运行的那些进程可见怎么办？比如说，您可以获得一块磁盘并将其放在命名空间 X 中，然后在命名空间 Y 中运行的进程无法看到或访问它。同样，命名空间 X 中的进程无法访问分配给命名空间 Y 的内存中的任何内容。当然，X 中的进程无法看到或与命名空间 Y 中的进程通信。这为全局资源提供了一种虚拟化和隔离。这就是 Docker 的工作方式：每个容器在自己的命名空间中运行，但使用*完全相同*内核和所有其他容器一样。发生隔离是因为内核知道分配给进程的命名空间，并且在 API 调用期间，它确保进程只能访问其自己的命名空间中的资源。

容器与虚拟机的局限性现在应该很明显了：您不能像在虚拟机中那样在容器中运行完全不同的操作系统。但是，您*可以*运行不同的 Linux 发行版，因为它们共享相同的内核。隔离级别不如虚拟机强。事实上，在早期的实现中，有一种方法可以让“guest”容器接管主机。您还可以看到，当您加载新容器时，操作系统的全新副本不会像在 VM 中那样启动。所有容器[共享同一个内核](https://stackoverflow.com/questions/25444099/why-docker-has-ability-to-run-different-linux-distribution). 这就是容器重量轻的原因。同样与 VM 不同的是，您不必为容器预先分配大量内存，因为我们没有运行操作系统的新副本。这允许在一个操作系统上运行数千个容器，同时对它们进行沙箱化，如果我们在它们自己的虚拟机中运行操作系统的单独副本，这可能是不可能的。

* * *

## 回答 #3

> 赞同：664
> 
> 时间：2015-10-14T18:02:52.820

很好的答案。只是为了获得容器与 VM 的图像表示，请查看下面的图像。

[![在此处输入图像描述](https://i.stack.imgur.com/exIhw.png)](https://i.stack.imgur.com/exIhw.png)

[资源](https://www.docker.com/what-container#/package_software)

* * *

## 回答 #4

> 赞同：361
> 
> 时间：2014-09-19T16:21:40.260

我喜欢[Ken Cochrane 的回答](https://stackoverflow.com/a/16048358/9997212)。

但我想补充一点额外的观点，这里不详细介绍。在我看来，Docker 在整个过程中也有所不同。与 VM 相比，Docker 不仅（仅）关于硬件的最佳资源共享，而且它提供了一个用于打包应用程序的“系统”（作为一组微服务是可取的，但不是必须的）。

对我来说，它一方面适合面向开发人员的工具（如 rpm、[Debian](http://en.wikipedia.org/wiki/Debian)软件包、[Maven](http://en.wikipedia.org/wiki/Apache_Maven)、npm + Git）与诸如[Puppet](http://en.wikipedia.org/wiki/Puppet_%28software%29)、VMware、Xen 等运维工具之间的差距……

> 为什么将软件部署到 docker 映像（如果这是正确的术语）比简单地部署到一致的生产环境更容易？

您的问题假设一些一致的生产环境。*但是如何保持一致呢？* 考虑一些（>10）服务器和应用程序，管道中的阶段。

为了保持同步，您将开始使用 Puppet、[Chef](https://en.wikipedia.org/wiki/Chef_(software))或您自己的配置脚本、未发布的规则和/或大量文档……理论上服务器可以无限期地运行，并保持完全一致和最新。实践无法完全管理服务器的配置，因此配置漂移和运行服务器的意外更改存在相当大的范围。

所以有一种已知的模式可以避免这种情况，即所谓的**[不可变服务器](http://martinfowler.com/bliki/ImmutableServer.html)**。但是不可变的服务器模式并不受欢迎。主要是因为在 Docker 之前使用的虚拟机的限制。处理几G的大图，把那些大图搬来搬去，只是为了改变应用程序中的一些领域，非常非常费力。可以理解...

使用 Docker 生态系统，您将永远不需要在“小改动”上移动千兆字节（感谢 aufs 和 Registry），并且您无需担心在运行时将应用程序打包到 Docker 容器中会降低性能。您无需担心该图像的版本。

最后，您甚至可以经常在 Linux 笔记本电脑上重现复杂的生产环境（如果在您的情况下不起作用，请不要打电话给我；））

当然，您可以在 VM 中启动 Docker 容器（这是个好主意）。减少 VM 级别的服务器配置。以上都可以由 Docker 管理。

*PS 同时 Docker 使用自己的实现“libcontainer”而不是 LXC。但 LXC 仍然可用。*

* * *

## 回答 #5

> 赞同：302
> 
> 时间：2016-04-02T00:55:59.610

Docker 不是一种虚拟化方法。它依赖于实际实现基于容器的虚拟化或操作系统级虚拟化的其他工具。为此，Docker 最初使用 LXC 驱动程序，然后转移到 libcontainer，现在更名为 runc。Docker 主要专注于在应用程序容器内自动部署应用程序。应用程序容器旨在打包和运行单个服务，而系统容器旨在运行多个进程，如虚拟机。因此，Docker 被认为是容器化系统上的容器管理或应用程序部署工具。

为了了解它与其他虚拟化有何不同，让我们来看看虚拟化及其类型。然后，更容易理解那里有什么区别。

**虚拟化**

在其构想形式中，它被认为是一种逻辑划分大型机以允许多个应用程序同时运行的方法。然而，当公司和开源社区能够提供一种以一种或另一种方式处理特权指令的方法并允许多个操作系统在单个基于 x86 的系统上同时运行时，情况发生了巨大变化。

**管理程序**

管理程序处理创建来宾虚拟机运行的虚拟环境。它监督来宾系统并确保根据需要将资源分配给来宾。管理程序位于物理机和虚拟机之间，为虚拟机提供虚拟化服务。为了实现它，它拦截虚拟机上的客户操作系统操作并模拟主机操作系统上的操作。

虚拟化技术（主要是在云中）的快速发展进一步推动了虚拟化的使用，允许在 Xen、VMware Player、KVM 等管理程序的帮助下在单个物理服务器上创建多个虚拟服务器，以及在商用处理器中加入硬件支持，例如 Intel VT 和 AMD-V。

**虚拟化类型**

虚拟化方法可以根据它如何模仿客户操作系统的硬件和模拟客户操作环境来分类。首先，存在三种类型的虚拟化：

*   仿真
*   半虚拟化
*   基于容器的虚拟化

**仿真**

仿真，也称为完全虚拟化，完全在软件中运行虚拟机操作系统内核。此类型中使用的管理程序称为类型 2 管理程序。它安装在主机操作系统的顶部，负责将客户操作系统内核代码转换为软件指令。翻译完全在软件中完成，不需要硬件参与。仿真使运行任何支持被仿真环境的未修改操作系统成为可能。这种类型的虚拟化的缺点是额外的系统资源开销，与其他类型的虚拟化相比会导致性能下降。

[![仿真](https://i.stack.imgur.com/FS8uzm.png)](https://i.stack.imgur.com/FS8uzm.png)

此类别中的示例包括 VMware Player、VirtualBox、QEMU、Bochs、Parallels 等。

**半虚拟化**

准虚拟化，也称为 Type 1 hypervisor，直接在硬件上运行，或“裸机”，并直接为运行在其上的虚拟机提供虚拟化服务。它帮助操作系统、虚拟化硬件和真实硬件协同工作以实现最佳性能。这些虚拟机管理程序通常占用的空间很小，并且它们本身不需要大量资源。

此类别中的示例包括 Xen、KVM 等。

[![半虚拟化](https://i.stack.imgur.com/oPO6Um.png)](https://i.stack.imgur.com/oPO6Um.png)

**基于容器的虚拟化**

基于容器的虚拟化，也称为操作系统级虚拟化，可以在单个操作系统内核中实现多个独立的执行。它具有最佳的性能和密度，并具有动态资源管理功能。这种虚拟化提供的隔离的虚拟执行环境称为容器，可以看作是一组被跟踪的进程。

[![基于容器的虚拟化](https://i.stack.imgur.com/qTuWpm.png)](https://i.stack.imgur.com/qTuWpm.png)

Linux 内核版本 2.6.24 中添加的命名空间功能使容器的概念成为可能。容器将其 ID 添加到每个进程，并为每个系统调用添加新的访问控制检查。它由允许创建先前全局命名空间的单独实例的*clone()*系统调用访问。

命名空间可以以多种不同的方式使用，但最常见的方法是创建一个隔离的容器，该容器对容器外的对象没有可见性或访问权。在容器内运行的进程似乎在正常的 Linux 系统上运行，尽管它们与位于其他命名空间中的进程共享底层内核，其他类型的对象也是如此。例如，当使用命名空间时，容器内的 root 用户不会被视为容器外的 root，从而增加了额外的安全性。

Linux 控制组 (cgroups) 子系统是支持基于容器的虚拟化的下一个主要组件，用于对进程进行分组并管理它们的总资源消耗。它通常用于限制容器的内存和 CPU 消耗。由于容器化的 Linux 系统只有一个内核，并且内核对容器具有完全的可见性，因此只有一级资源分配和调度。

有多种管理工具可用于 Linux 容器，包括 LXC、LXD、systemd-nspawn、lmctfy、Warden、Linux-VServer、OpenVZ、Docker 等。

**容器与虚拟机**

与虚拟机不同，容器不需要引导操作系统内核，因此可以在不到一秒的时间内创建容器。与其他虚拟化方法相比，此功能使基于容器的虚拟化独特且可取。

由于基于容器的虚拟化向主机增加很少或没有开销，因此基于容器的虚拟化具有接近原生的性能

对于基于容器的虚拟化，与其他虚拟化不同，不需要额外的软件。

主机上的所有容器共享主机的调度程序，从而节省了额外资源的需求。

与虚拟机镜像相比，容器状态（Docker 或 LXC 镜像）体积较小，因此容器镜像易于分发。

容器中的资源管理是通过 cgroups 实现的。Cgroups 不允许容器消耗超过分配给它们的资源。但是，到目前为止，主机的所有资源在虚拟机中都是可见的，但不能使用。这可以通过在容器和主机上同时运行`top`或运行来实现。`htop`所有环境的输出看起来都相似。

更新：

**Docker 如何在非 Linux 系统中运行容器？**

如果容器因为 Linux 内核中可用的特性而成为可能，那么显而易见的问题是非 Linux 系统如何运行容器。Docker for Mac 和 Windows 都使用 Linux VM 来运行容器。Docker Toolbox 用于在 Virtual Box VM 中运行容器。但是，最新的 Docker 在 Windows 中使用 Hyper-V，在 Mac 中使用 Hypervisor.framework。

现在，让我详细描述一下 Docker for Mac 是如何运行容器的。

Docker for Mac 使用[https://github.com/moby/hyperkit](https://github.com/moby/hyperkit)来模拟管理程序功能，Hyperkit 在其核心中使用 hypervisor.framework。Hypervisor.framework 是 Mac 的本机管理程序解决方案。Hyperkit 还分别使用 VPNKit 和 DataKit 来命名网络和文件系统。

Docker 在 Mac 中运行的 Linux VM 是只读的。但是，您可以通过运行：

`screen ~/Library/Containers/com.docker.docker/Data/vms/0/tty`.

现在，我们甚至可以检查这个 VM 的内核版本：

`# uname -a Linux linuxkit-025000000001 4.9.93-linuxkit-aufs #1 SMP Wed Jun 6 16:86_64 Linux`.

所有容器都在此 VM 内运行。

hypervisor.framework 有一些限制。因为 Docker 不会`docker0`在 Mac 中公开网络接口。因此，您无法从主机访问容器。截至目前，`docker0`仅在 VM 内部可用。

Hyper-v 是 Windows 中的本机管理程序。他们还试图利用 Windows 10 的功能在本地运行 Linux 系统。

* * *

## 回答 #6

> 赞同：173
> 
> 时间：2016-04-04T02:35:09.193

这里的大多数答案都是关于虚拟机的。我将给你一个简单的回答这个问题，这个问题在过去几年使用 Docker 对我帮助最大。是这样的：

> Docker 只是一种运行进程的奇特方式，而不是虚拟机。

现在，让我再解释一下这意味着什么。虚拟机是它们自己的野兽。我觉得解释*Docker*是什么比解释虚拟机是什么更能帮助你理解这一点。特别是因为这里有很多很好的答案可以准确地告诉您某人说“虚拟机”时的意思。所以...

Docker 容器只是一个进程（及其子进程），使用主机系统内核中的[cgroups](https://en.wikipedia.org/wiki/Cgroups)将其与其余进程区分开来。您实际上可以通过`ps aux`在主机上运行来查看您的 Docker 容器进程。例如，`apache2`“在容器中”启动只是`apache2`作为主机上的一个特殊进程启动。它只是与机器上的其他进程分开。请务必注意，您的容器不存在于容器化进程的生命周期之外。当您的进程死亡时，您的容器也会死亡。那是因为 Docker 用`pid 1`您的应用程序替换了您的容器内部（`pid 1`通常是 init 系统）。最后一点`pid 1`非常重要。

至于每个容器进程使用的文件系统，Docker 使用[UnionFS](https://en.wikipedia.org/wiki/UnionFS)支持的映像，这是您在执行`docker pull ubuntu`. 每个“图像”只是一系列层和相关的元数据。分层的概念在这里非常重要。每一层都只是它下面的层的变化。例如，当您在构建 Docker 容器时删除 Dockerfile 中的文件时，实际上只是在最后一层之上创建了一个层，上面写着“此文件已被删除”。顺便说一句，这就是为什么您可以从文件系统中删除一个大文件，但该映像仍占用相同数量的磁盘空间。该文件仍然存在，位于当前文件下方的图层中。层本身只是文件的压缩包。你可以用`docker save --output /tmp/ubuntu.tar ubuntu`然后`cd /tmp && tar xvf ubuntu.tar`。然后你可以四处看看。所有那些看起来像长哈希的目录实际上都是单独的层。每一个都包含文件 ( `layer.tar`) 和元数据 (`json`) 以及有关该特定层的信息。这些层只是描述了对文件系统的更改，这些更改被保存为“在”其原始状态之上的一个层。当读取“当前”数据时，文件系统读取数据，就好像它只查看最顶层的更改一样。这就是文件似乎被删除的原因，即使它仍然存在于“先前”层中，因为文件系统只查看最顶层。这允许完全不同的容器共享它们的文件系统层，即使每个容器中最顶层的文件系统可能发生了一些重大变化。当你的容器共享它们的基础镜像层时，这可以为你节省大量的磁盘空间。然而，

Docker 中的网络是通过使用以太网桥（`docker0`在主机上调用）和主机上每个容器的虚拟接口来实现的。它为您的容器创建了一个虚拟子网，`docker0`以便彼此“之间”进行通信。这里有许多网络选项，包括为您的容器创建自定义子网，以及“共享”主机的网络堆栈以供容器直接访问的能力。

Docker 的发展速度非常快。它的[文档](https://docs.docker.com/)是我见过的最好的文档之一。它通常写得很好，简洁而准确。我建议您查看可用的文档以获取更多信息，并信任该文档而不是您在线阅读的任何其他内容，包括 Stack Overflow。如果您有具体问题，我强烈建议您加入`#docker`Freenode IRC 并在那里提问（您甚至可以使用 Freenode 的[网络聊天](https://webchat.freenode.net/)！）。

* * *

## 回答 #7

> 赞同：160
> 
> 时间：2014-08-26T07:46:14.193

通过这篇文章，我们将画出 VM 和 LXC 之间的一些区别。让我们首先定义它们。

**虚拟机**：

虚拟机模拟物理计算环境，但对 CPU、内存、硬盘、网络和其他硬件资源的请求由虚拟化层管理，虚拟化层将这些请求转换为底层物理硬件。

在这种情况下，VM 被称为来宾，而它运行的环境被称为主机。

**LXC**：

Linux 容器 (LXC) 是操作系统级别的功能，可以在一个控制主机（LXC 主机）上运行多个隔离的 Linux 容器。Linux 容器作为 VM 的轻量级替代品，因为它们不需要虚拟机管理程序，即。Virtualbox、KVM、Xen 等

现在，除非你被 Alan（Zach Galifianakis - 来自宿醉系列）下药并且去年一直在维加斯，否则你会非常清楚对 Linux 容器技术的巨大兴趣，如果我将具体介绍一个容器过去几个月在世界范围内引起轰动的项目是——Docker 引发了一些呼应的观点，即云计算环境应该放弃虚拟机（VM）并用容器代替它们，因为它们的开销较低且性能可能更好。

但最大的问题是，它是否可行？是否明智？

一个。LXC 的范围仅限于 Linux 实例。它可能是不同风格的 Linux（例如，CentOS 主机上的 Ubuntu 容器，但它仍然是 Linux。）类似地，如果我们查看 VM，基于 Windows 的容器现在被限定为 Windows 实例，它们具有更广泛的范围并使用管理程序您不限于操作系统 Linux 或 Windows。

湾。与 VM 相比，LXC 的开销较低且性能更好。工具即。建立在 LXC 技术的肩膀上的 Docker 为开发人员提供了一个运行其应用程序的平台，同时为运维人员提供了一种工具，使他们能够在生产服务器或数据中心上部署相同的容器。它试图使运行应用程序、启动和测试应用程序的开发人员与部署该应用程序的运维人员之间的体验无缝，因为这是所有摩擦的所在，而 DevOps 的目的是打破这些孤岛。

因此，最好的方法是云基础设施提供商应该提倡适当使用 VM 和 LXC，因为它们都适合处理特定的工作负载和场景。

到目前为止，放弃 VM 是不切实际的。因此，VM 和 LXC 都有各自的存在和重要性。

* * *

## 回答 #8

> 赞同：111
> 
> 时间：2014-08-27T18:25:24.053

Docker 封装了一个应用程序及其所有依赖项。

虚拟器封装了一个操作系统，该操作系统可以运行通常可以在裸机上运行的任何应用程序。

* * *

## 回答 #9

> 赞同：70
> 
> 时间：2014-11-03T17:44:42.813

他们都非常不同。Docker 是轻量级的，使用 LXC/libcontainer（依赖于内核命名空间和 cgroups），并且没有机器/硬件仿真，例如虚拟机管理程序、KVM。Xen 其中很重。

Docker 和 LXC 更多地用于沙盒、容器化和资源隔离。它使用主机操作系统（目前只有 Linux 内核）的克隆 API，为 IPC、NS（挂载）、网络、PID、UTS 等提供命名空间。

内存、I/O、CPU 等呢？这是使用 cgroups 控制的，您可以在其中创建具有特定资源（CPU、内存等）规范/限制的组并将您的进程放在那里。在 LXC 之上，Docker 提供了一个存储后端（[http://www.projectatomic.io/docs/filesystems/](http://www.projectatomic.io/docs/filesystems/)），例如联合挂载文件系统，您可以在其中添加层并在不同的挂载命名空间之间共享层。

这是一个强大的功能，其中基础镜像通常是只读的，只有当容器修改层中的某些内容时，它才会将某些内容写入读写分区（也就是写时复制）。它还提供了许多其他包装器，例如镜像的注册表和版本控制。

使用普通的 LXC，您需要附带一些 rootfs 或共享 rootfs，并且在共享时，更改会反映在其他容器上。由于这些附加功能很多，Docker 比 LXC 更受欢迎。LXC 在嵌入式环境中很流行，用于围绕暴露给外部实体（如网络和 UI）的流程实施安全性。Docker 在需要一致的生产环境的云多租户环境中很受欢迎。

普通虚拟机（例如，VirtualBox 和 VMware）使用虚拟机管理程序，相关技术要么具有成为第一个操作系统（主机操作系统或客户操作系统 0）的第一层的专用固件，要么具有在主机操作系统上运行的软件为客户操作系统提供硬件仿真，例如 CPU、USB/附件、内存、网络等。虚拟机（截至 2015 年）在高安全性多租户环境中仍然很流行。

Docker/LXC 几乎可以在任何便宜的硬件上运行（只要你有更新的内核，少于 1 GB 的内存也可以），而普通 VM 需要至少 2 GB 的内存等，才能用它做任何有意义的事情. 但是主机操作系统上的 Docker 支持在 Windows 等操作系统中不可用（截至 2014 年 11 月），在 Windows、Linux 和 Mac 上可以运行多种类型的虚拟机。

这是来自 docker/rightscale 的图片：[![这是来自rightscale的图片](https://i.stack.imgur.com/pG94I.png)](https://i.stack.imgur.com/pG94I.png)

* * *

## 回答 #10

> 赞同：48
> 
> 时间：2017-08-10T04:25:41.233

## 1.轻量级

这可能是很多 docker 学习者的第一印象。

首先，docker 镜像通常比 VM 镜像小，便于构建、复制和共享。

其次，Docker 容器可以在几毫秒内启动，而 VM 在几秒钟内启动。

## 2.分层文件系统

这是 Docker 的另一个关键特性。图像有图层，不同的图像可以共享图层，更节省空间，构建速度更快。

如果所有容器都使用 Ubuntu 作为其基础镜像，则并非每个镜像都有自己的文件系统，而是共享相同的下划线 ubuntu 文件，只是各自的应​​用程序数据不同。

## 3\. 共享操作系统内核

**将容器视为进程！**

在主机上运行的所有容器确实是一堆具有不同文件系统的进程。它们共享相同的操作系统内核，仅封装系统库和依赖项。

这在大多数情况下都很好（无需维护额外的操作系统内核），但如果容器之间需要严格隔离，则可能会出现问题。

## 为什么重要？

所有这些似乎都是改进，而不是革命。那么，*量的积累导致质的转变*。

考虑应用程序部署。如果我们想部署一个新的软件（服务）或升级一个，最好改变配置文件和进程，而不是创建一个新的虚拟机。因为创建具有更新服务的 VM、对其进行测试（在 Dev 和 QA 之间共享）、部署到生产需要数小时甚至数天。如果出现任何问题，您必须重新开始，浪费更多时间。因此，使用配置管理工具（puppet、saltstack、chef 等）安装新软件，下载新文件是首选。

对于 docker，不可能使用新创建的 docker 容器来替换旧的。维护要容易得多！构建一个新图像，与 QA 共享，测试它，部署它只需要几分钟（如果一切都是自动化的），最坏的情况是几个小时。这被称为**不可变的基础设施**：不要维护（升级）软件，而是创建一个新的。

它改变了服务的交付方式。我们想要应用程序，但必须维护虚拟机（这很痛苦，与我们的应用程序无关）。Docker 让您专注于应用程序并使一切变得顺畅。

* * *

## 回答 #11

> 赞同：38
> 
> 时间：2017-01-09T13:22:58.523

Docker，基本上是容器，支持**操作系统虚拟化**，即你的应用程序感觉它有一个完整的操作系统实例，而 VM 支持**硬件虚拟化**。您会觉得它是一台物理机器，您可以在其中启动任何操作系统。

在 Docker 中，运行的容器共享主机操作系统内核，而在虚拟机中，它们有自己的操作系统文件。当您将应用程序部署到各种服务环境（例如“测试”或“生产”）时，开发应用程序的环境（操作系统）将是相同的。

例如，如果您开发了一个在端口 4000 上运行的 Web 服务器，当您将其部署到“测试”环境时，该端口已被其他程序使用，因此它停止工作。在容器中有层；您对操作系统所做的所有更改都将保存在一个或多个层中，并且这些层将成为图像的一部分，因此无论图像走到哪里，依赖关系也会出现。

在下面显示的示例中，主机具有三个 VM。为了使虚拟机中的应用程序完全隔离，它们每个都有自己的操作系统文件、库和应用程序代码的副本，以及操作系统的完整内存实例。[![没有容器](https://i.stack.imgur.com/DTPEc.png)](https://i.stack.imgur.com/DTPEc.png) 而下图显示了与容器相同的场景。在这里，容器只是共享主机操作系统，包括内核和库，因此它们不需要启动操作系统、加载库或为这些文件支付私有内存成本。它们占用的唯一增量空间是应用程序在容器中运行所需的任何内存和磁盘空间。虽然应用程序的环境感觉像是一个专用操作系统，但应用程序的部署就像它在专用主机上一样。容器化应用程序可以在几秒钟内启动，并且与 VM 相比，可以在机器上安装更多的应用程序实例。 [![在此处输入图像描述](https://i.stack.imgur.com/fXfMY.png)](https://i.stack.imgur.com/fXfMY.png)

来源：[https ://azure.microsoft.com/en-us/blog/containers-docker-windows-and-trends/](https://azure.microsoft.com/en-us/blog/containers-docker-windows-and-trends/)

* * *

## 回答 #12

> 赞同：31
> 
> 时间：2017-02-12T16:47:06.803

有三种不同的设置提供了一个堆栈来运行应用程序（这将帮助我们识别容器是什么以及是什么使它比其他解决方案如此强大）：

```
1) Traditional Servers(bare metal)
2) Virtual machines (VMs)
3) Containers 
```

1)**传统的服务器**堆栈由运行操作系统和您的应用程序的物理服务器组成。

**优点：**

*   原始资源的利用

*   隔离

**缺点：**

*   部署时间非常慢
*   昂贵的
*   资源浪费
*   难以扩展
*   难以迁移
*   复杂的配置

2) **VM 堆栈**由运行操作系统的物理服务器和管理虚拟机、共享资源和网络接口的管理程序组成。每个虚拟机都运行一个客户操作系统、一个应用程序或一组应用程序。

**优点：**

*   善用资源
*   易于扩展
*   易于备份和迁移
*   成本效益
*   灵活性

**缺点：**

*   资源分配有问题
*   供应商锁定
*   复杂的配置

3)**容器设置**，与其他堆栈的主要区别是基于容器的虚拟化使用主机操作系统的内核来运行多个隔离的来宾实例。这些来宾实例称为容器。主机可以是物理服务器或虚拟机。

**优点：**

*   隔离
*   轻的
*   资源有效
*   易于迁移
*   安全
*   低开销
*   镜像制作开发环境

**缺点：**

*   相同的架构
*   资源繁重的应用程序
*   网络和安全问题。

通过将容器设置与其前身进行比较，我们可以得出结论，容器化是迄今为止我们所知道的最快、最具资源效率和最安全的设置。容器是运行您的应用程序的隔离实例。**Docker 以某种方式启动容器，层使用默认存储驱动程序（覆盖驱动程序）获得运行时内存，这些驱动程序在几秒钟内运行，一旦我们提交到容器中，就会在其之上创建写时复制层，从而为执行提供动力容器。**如果是虚拟机，将需要大约一分钟的时间将所有内容加载到虚拟化环境中。这些轻量级实例可以轻松替换、重建和移动。这使我们能够镜像生产和开发环境，并且对 CI/CD 流程有巨大帮助。容器可以提供的优势是如此引人注目，以至于它们肯定会继续存在。

* * *

## 回答 #13

> 赞同：27
> 
> 时间：2016-10-15T11:25:12.500

和---关联：-

> “为什么将软件部署到 docker 映像比简单地部署到一致的生产环境更容易？”

大多数软件都部署到许多环境中，通常至少是以下三个环境：

1.  个人开发者 PC
2.  共享开发者环境
3.  个人测试仪 PC
4.  共享测试环境
5.  质量保证环境
6.  UAT环境
7.  负载/性能测试
8.  现场演出
9.  生产
10.  档案

还有以下几个因素需要考虑：

*   根据工作的性质，开发人员，实际上是测试人员，都将拥有微妙或大不相同的 PC 配置
*   开发人员通常可以在不受公司或业务标准化规则控制的 PC 上进行开发（例如，在自己的机器上开发（通常是远程）的自由职业者或开源项目的贡献者，他们没有“受雇”或“签约”来配置他们的 PC方法）
*   某些环境将由负载平衡配置中固定数量的多台机器组成
*   许多生产环境将根据流量级别动态（或“弹性”）创建和销毁基于云的服务器

正如您所看到的，一个组织的服务器总数推断很少是个位数，通常是三位数，而且很容易显着更高。

这一切都意味着，仅仅因为数量庞大（即使在绿地场景中），首先创建一致的环境已经足够困难了，但是**考虑**到大量服务器、添加新服务器（动态或手动）、来自操作系统供应商、防病毒供应商、浏览器供应商等的自动更新、由开发人员或服务器技术人员执行的手动软件安装或配置更改等。让我重复一遍——这实际上（没有双关语）是不可能的保持环境一致（好吧，对于纯粹主义者来说，这是可以做到的，但它需要大量的时间、精力和纪律，这正是最初设计 VM 和容器（例如 Docker）的原因）。

所以把你的问题想得更像这样*“鉴于保持所有环境一致的极端困难，即使考虑到学习曲线，将软件部署到 docker 映像是否更容易？”* . 我想你会发现答案总是“是”——但只有一种方法可以找到答案，在 Stack Overflow 上发布这个新问题。

* * *

## 回答 #14

> 赞同：23
> 
> 时间：2017-04-11T03:20:53.087

有很多答案可以更详细地解释差异，但这是我非常简短的解释。

一个重要的区别是**VM 使用单独的内核来运行操作系统**。这就是它很重并且需要时间来启动，消耗更多系统资源的原因。

**在 Docker 中，容器**与主机共享内核；因此它重量轻，可以快速启动和停止。

在虚拟化中，资源是在设置开始时分配的，因此当虚拟机在很多时候处于空闲状态时，资源并没有得到充分利用。在 Docker 中，容器没有分配固定数量的硬件资源，可以根据需要自由使用资源，因此具有高度可扩展性。

Docker 使用**UNION 文件系统**.. Docker 使用写时复制技术来减少容器消耗的内存空间。[在这里阅读更多](https://medium.com/@nagarwal/docker-containers-filesystem-demystified-b6ed8112a04a)

* * *

## 回答 #15

> 赞同：23
> 
> 时间：2018-05-21T08:22:52.720

使用**虚拟机**，我们有一个服务器，我们在该服务器上有一个主机操作系统，然后我们有一个管理程序。然后在该虚拟机管理程序之上运行，我们拥有任意数量的客户操作系统，其中包含一个应用程序及其依赖的二进制文件，以及该服务器上的库。它带来了一个完整的客户操作系统。可以说是相当的重量级了。此外，您实际上可以在每台物理机器上放置多少也是有限制的。

[![在此处输入图像描述](https://i.stack.imgur.com/8e3fb.png)](https://i.stack.imgur.com/8e3fb.png)

**另一方面，**Docker 容器略有不同。**我们有服务器。我们有主机操作系统。但在这种情况下，我们有**Docker 引擎，****而不是 hypervisor 。**在这种情况下，我们不会带来整个客户操作系统。**我们带来了一个非常薄的操作系统层，**容器可以向下与主机操作系统对话，以便获得那里的内核功能。这使我们能够拥有一个非常轻量级的容器。**

 ******它所拥有的只是应用程序代码以及它需要的任何二进制文件和库。如果您希望它们也可以，这些二进制文件和库实际上可以在不同的容器之间共享。这使我们能够做的事情有很多。他们有**更快的启动时间**。你不能像那样在几秒钟内建立一个虚拟机。同样，尽快将它们降下来......所以我们可以非常快速地扩大和缩小规模，我们稍后会看到。

[![在此处输入图像描述](https://i.stack.imgur.com/chKYW.png)](https://i.stack.imgur.com/chKYW.png)

每个容器都认为它在自己的操作系统副本上运行。它有自己的文件系统、自己的注册表等，这是一种谎言。它实际上正在被虚拟化。

* * *

## 回答 #16

> 赞同：17
> 
> 时间：2018-07-16T02:56:46.950

![Difference between how apps in VM use cpu vs containers](https://i.stack.imgur.com/oIHl8.jpg)

Source: Kubernetes in Action.

* * *

## 回答 #17

> 赞同：16
> 
> 时间：2017-05-22T15:45:43.347

我在生产环境中使用过 Docker，并且非常多地使用过 Docker。当您习惯它时，您会发现它对于构建多容器和隔离环境非常强大。

Docker 是基于 LXC（Linux Container）开发的，并且可以在许多 Linux 发行版中完美运行，尤其是 Ubuntu。

Docker 容器是隔离的环境。`top`当您在从 Docker 映像创建的 Docker 容器中发出命令时，您可以看到它。

除此之外，由于 dockerFile 配置，它们非常轻巧且灵活。

例如，您可以创建一个 Docker 映像并配置一个 DockerFile 并告诉它，例如它何时运行然后 wget 'this'、apt-get 'that'、运行'some shell script'、设置环境变量等等。

在微服务项目和架构中，Docker 是一种非常可行的资产。您可以使用 Docker、Docker swarm、Kubernetes 和 Docker Compose 实现可扩展性、弹性和弹性。

关于 Docker 的另一个重要问题是 Docker Hub 及其社区。例如，我使用 Prometheus、Grafana、Prometheus-JMX-Exporter 和 Docker 实现了一个监控 kafka 的生态系统。

为此，我为 zookeeper、kafka、Prometheus、Grafana 和 jmx-collector 下载了已配置的 Docker 容器，然后使用 YAML 文件为其中一些安装了我自己的配置，或者对于其他一些，我更改了 Docker 容器中的一些文件和配置，然后我在单台机器上使用多容器 Docker 构建一个用于监控 kafka 的完整系统，具有隔离性、可扩展性和弹性，该架构可以轻松移动到多个服务器中。

除了 Docker Hub 站点之外，还有另一个名为 quay.io 的站点，您可以使用该站点在其中拥有自己的 Docker 映像仪表板，并从中拉/推。你甚至可以将 Docker 镜像从 Docker Hub 导入到 quay，然后在你自己的机器上从 quay 运行它们。

注意：一开始学习 Docker 看起来既复杂又困难，但是当你习惯了它之后，你就离不开它了。

我记得在使用 Docker 的第一天，我发出了错误的命令或错误地删除了我的容器以及所有数据和配置。

* * *

## 回答 #18

> 赞同：8
> 
> 时间：2018-05-23T13:32:40.513

**Docker**是这样介绍自己的：

> Docker 是推动容器运动的公司，也是唯一一家解决混合云中所有应用程序的容器平台提供商。当今的企业面临着数字化转型的压力，但受到现有应用程序和基础设施的限制，同时还要合理化日益多样化的云、数据中心和应用程序架构组合。Docker 实现了应用程序和基础设施以及开发人员和 IT 运营之间的真正独立性，以释放他们的潜力，并为更好的协作和创新创建模型。

所以**Docker**是基于容器的，这意味着你有可以在当前机器上运行的镜像和容器。**它不包括像VM**这样的操作系统，而是像一组不同的工作包，如 Java、Tomcat 等。

如果您了解容器，您就会了解 Docker 是什么以及它与**VM**的不同之处...

## 那么，什么是容器？

> 容器镜像是一个轻量级的、独立的、可执行的软件包，其中包括运行它所需的一切：代码、运行时、系统工具、系统库、设置。可用于基于 Linux 和 Windows 的应用程序，容器化软件将始终以相同的方式运行，无论环境如何。容器将软件与其周围环境隔离开来，例如开发和暂存环境之间的差异，并有助于减少在同一基础架构上运行不同软件的团队之间的冲突。

[![码头工人](https://i.stack.imgur.com/vIBgw.png)](https://i.stack.imgur.com/vIBgw.png)

因此，如下图所示，每个容器都有一个单独的包，并在一台机器上运行，共享该机器的操作系统......它们安全且易于运输......

* * *

## 回答 #19

> 赞同：7
> 
> 时间：2018-05-25T11:58:58.937

这里有很多很好的技术答案，清楚地讨论了 VM 和容器之间的差异以及 Docker 的起源。

对我而言，VM 和 Docker 之间的根本区别在于您如何管理应用程序的推广。

借助 VM，您可以将应用程序及其依赖项从一个 VM 提升到下一个 DEV，再到 UAT 再到 PRD。

1.  通常这些虚拟机会有不同的补丁和库。
2.  多个应用程序共享一个 VM 并不少见。这需要管理所有应用程序的配置和依赖关系。
3.  退出需要撤消 VM 中的更改。或者如果可能的话恢复它。

使用 Docker 的想法是，您将应用程序及其所需的库捆绑在自己的容器中，然后将**整个**容器作为一个单元进行推广。

1.  除了内核，补丁和库是相同的。
2.  作为一般规则，每个容器只有一个应用程序，这简化了配置。
3.  退出包括停止和删除容器。

因此，在最基本的层面上，使用 VM 可以将应用程序及其依赖项作为离散组件进行推广，而使用 Docker 则可以一键推广所有内容。

是的，容器存在问题，包括管理它们，尽管 Kubernetes 或 Docker Swarm 等工具大大简化了任务。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2022-02-27T09:57:12.117

| `Feature` | `virtualization` | `(Docker) Containers` |
| --- | --- | --- |
| **操作系统** | 每个 VM 包含一个`Guest OS` | 每个 Docker 容器**不**包含`Guest OS` |
| **硬件** | 每个 VM 都包含操作系统运行所需的硬件的虚拟副本。 | 没有容器**的硬件虚拟化** |
| **重量** | 虚拟机很重——原因在上面—— | 容器重量轻，因此速度快 |
| **所需软件** | 虚拟化使用称为[管理程序的软件实现](https://www.ibm.com/cloud/blog/containers-vs-vms) | Containerzation 使用称为 Docker 的软件实现 |
| **核** | 虚拟机提供虚拟硬件（或可以安装操作系统和其他程序的硬件） | Docker 容器不使用任何硬件虚拟化。**有助于使用容器 |
| **抽象** | 虚拟机提供*硬件抽象*，因此您可以运行多个操作系统。 | 容器提供*操作系统抽象*，因此您可以运行多个容器。 |
| **开机时间** | 创建并需要大量资源开销需要很长时间（通常是几分钟），因为除了您要使用的软件之外，它们还运行整个操作系统。 | 因为在 Docker 容器中运行的程序直接与主机的 Linux 内核接口，所以花费的时间更少。 |

* * *

## 回答 #21

> 赞同：-2
> 
> 时间：2020-11-16T00:50:54.863

在我看来，这要看你的应用程序的需求，为什么决定部署到Docker，因为Docker根据其功能将应用程序分成小部分，这变得有效，因为当一个应用程序/功能出现错误时对其他应用没有影响，与使用完整的vm相比，它在配置上会更慢更复杂，但在某些方面比docker更安全

* * *

## 回答 #22

> 赞同：-4
> 
> 时间：2020-11-26T15:53:35.600

docker 文档（和不言自明）区分了“虚拟机”和“容器”。他们倾向于以不常见的方式解释和使用事物。他们可以这样做，因为这取决于他们，他们在文档中写了什么，并且因为虚拟化的术语还不是很准确。

事实上，Docker 文档对“容器”的理解是现实中的[半虚拟化](https://en.wikipedia.org/wiki/Paravirtualization)（有时是“OS 级虚拟化”），相反，[硬件虚拟化](https://en.wikipedia.org/wiki/Hardware_virtualization)不是 docker。

Docker 是一种低质量的半虚拟化解决方案。容器与 VM 的区别是由 docker 开发人员发明的，以解释其产品的严重缺点。

它之所以如此受欢迎，是因为他们“[给普通人火了](https://en.wikipedia.org/wiki/Prometheus)”，即它使典型的服务器（= Linux）环境/软件产品在Win10工作站上的简单使用成为可能。这也是我们容忍他们一点点“细微差别”的一个理由。但这并不意味着我们也应该相信它。

由于 Windows 主机上的 docker 在 HyperV 中使用嵌入式 Linux，并且它的容器已经在其中运行，因此情况变得更加模糊。因此，Windows 上的 docker 使用组合的硬件和半虚拟化解决方案。

简而言之，Docker 容器是低质量的（准）虚拟机，具有巨大的优势和许多劣势。******

# function - FreePascal 接口：将返回“任何内容”的函数

> ID：16047314
> 
> 赞同：0
> 
> 时间：2013-04-16T21:20:16.850
> 
> 标签：function, interface, pascal

我有一个名为`ILoader`. 这是一种加载资源文件的对象。

```
ILoader = interface
    function Load: TObject;
    function FormatName: String;
  end; 
```

非常简单。现在，我想要多种类型`Loader`的 TSurfaceLoader、TSoundLoader、TMusicLoader 等。

问题是，我如何指定`interface`从函数返回的内容？将`SurfaceLoader`加载 Surfaces，但 a`Surface`不是 a `TObject`，因此它不起作用。

我该怎么办？把界面全部扔掉？（我可能会扩展它，它不会总是这么小。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T07:32:15.607

接口是一个精确的契约，可以期待什么，所以你不能让它可变。

一个解决方案是简单地进行类型转换：

```
something_of_tsurfaceloader:=TSurfaceLoader(myILoaderIntf.GetObject); 
```

设计出界面可能更好与否，这取决于。这些日常选择让程序员的生活变得有趣:)

# ember.js - 当控制器由 Ember.js 创建时，如何将控制器绑定到视图

> ID：16047315
> 
> 赞同：0
> 
> 时间：2013-04-16T21:20:17.957
> 
> 标签：ember.js

这个问题与[如何显示 ObjectController 的“内容”略有关系？](https://stackoverflow.com/questions/12816915/how-to-display-the-content-of-an-objectcontroller/12816978#12816978) 但是，在提供的解决方案和所有其他示例中，我发现控制器始终是显式创建的。Ember.js 的好处在于 Route 几乎可以处理所有事情。所以我不想创建控制器，但想将它绑定到视图：

```
{{view App.myview controllerBinding="App.applicationController"}} 
```

[你可以在这个小提琴](http://jsfiddle.net/ncaZz/1/)中看到完整的例子。这个例子不是很好，因为 Ember 通常将子视图的控制器设置为其父视图。

最后我需要知道，如何从视图访问由 Ember 创建的控制器。

谢谢你的帮助！

**更新：** 我提供了错误的小提琴或者它没有保存我的更改。这是正确版本的链接：http: [//jsfiddle.net/ncaZz/1/](http://jsfiddle.net/ncaZz/1/)

我应该在模板的第 9 行提供什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T23:20:00.920

你真的不需要绑定到它。您可以通过像这样调用它来从视图访问控制器。

```
this.get('controller'); 
```

更新答案：

你真的不应该在你的视图中有你的点击事件。您的操作应该在您的控制器或路由器中。

你的模板应该变成

```
<span style="background-color: green" {{action doStuff}}>
    Click
</span> 
```

你应该有一个控制器应该有这个

```
App.MyController = Em.Controller.extend({
    needs: ['application'],
    doStuff: function(){
       this.get('controllers.application').foo();
    }
}); 
```

另外，MyView 和 MyController 应该大写，因为从 ember 扩展这些不是实例的项目时，需要大写。视图应该只在 didInsertElement 中有处理特殊事情的东西，比如任何类型的 jquery 动画或初始化日期选择器。但是，“余烬方式”是在路由器或控制器中执行操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T09:46:39.963

从视图中，您可以使用

```
this.controller 
```

如果您需要视图控制器以外的其他控制器，则可以使用视图控制器中的需求：

```
App.DatasetEditController = Ember.ObjectController.extend({
  needs: ['mappingIndex']
}); 
```

然后使用：

```
this.controller.mappingIndex 
```

# gradle - TaskExecutionListeners 的通知顺序是否与 Gradle 中注册的顺序一致？

> ID：16047316
> 
> 赞同：0
> 
> 时间：2013-04-16T21:20:18.170
> 
> 标签：gradle

如果我运行，以下内容是否总是`one, two, three`按顺序打印`gradle three`？

```
task one {
    gradle.taskGraph.whenReady { graph ->
        if (graph.hasTask(it)) {
            println "one"
        }
    }
}

task two {
    dependsOn one
    gradle.taskGraph.whenReady { graph ->
        if (graph.hasTask(it)) {
            println "two"
        }
    }
}

task three {
    dependsOn two
    gradle.taskGraph.whenReady { graph ->
        if (graph.hasTask(it)) {
            println "three"
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T21:36:47.070

是的，当闭包被放入 a时，最终它会在您调用时`LinkedHashMap`进入[BroadcastDispatch](https://github.com/gradle/gradle/blob/379def16e573f7a73a9b5ace9e5c2c69dbb2d0f2/subprojects/core/src/main/groovy/org/gradle/listener/BroadcastDispatch.java)`whenReady`

公共 api 中没有任何内容说明这一点

# c# - 随机通用抽样：为交叉和突变选择对

> ID：16047318
> 
> 赞同：0
> 
> 时间：2013-04-16T21:20:25.333
> 
> 标签：c#, genetic-algorithm

我对使用**Stochastic Universal Sampling选择染色体****对**有点困惑。我了解如何使用这种方法从给定种群中选择后代。我感到困惑的是，您如何从这些后代中选择对用于交叉/突变。

 ****例如：**

*   使用普通的*轮盘选择*，您可以掷两次众所周知的骰子以获取 2 条染色体进行交叉/突变，将它们添加到新种群中，然后继续直到新种群被填满。

*   使用*Rank Selection*，您可以通过适应度升序对当前种群进行排序，分配一个排名，并使用 rank/totalRank 作为轮盘赌选择的概率，使用上述方法。

*   这如何与*随机通用采样*一起工作？您可以选择 N 条染色体进行交叉/突变。然后，您可以从选定的染色体中选择对用于交叉，但是如何？随机？轮盘选择？如果您使用轮盘赌选择，这是否会带来与轮盘赌选择相同的问题？

我错过了一步吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T11:07:03.787

与其一次只选择两个父母，不如一次性选择全部。旋转假想的轮盘赌轮以获得起点，然后以固定大小的步长绕轮盘走动，根据需要多次选择后续父母。

一旦你拥有了所有需要的父母，你应该在使用它们之前将它们洗牌，以避免偏向轮子上相邻的对。**

# jquery - jQuery - 使用 slideToggle 功能渲染多个 div 元素

> ID：16047323
> 
> 赞同：1
> 
> 时间：2013-04-16T21:20:39.910
> 
> 标签：jquery, asp.net-mvc, asp.net-mvc-3, jquery-ui, slidetoggle

在我的 ASP MVC 3 视图的索引页面中，我有一个集合对象，它可能有多达 50 个左右的元素。`.slideToggle`为了让用户的索引保持干净，当集合包含超过 5 个项目时，我尝试使用 jQuery功能。

但是，我目前正在这样做，`$(document).ready`并且由于我给`<div>`元素赋予了相同的名称，因此当您单击一个时，它们都会展开或折叠。

我是 jQuery 的新手，所以我想知道实现这个目标的最佳方法是什么，如果这个方法是一个很好的方法，如何只允许我点击折叠/展开的项目。

这是jQuery代码

```
 $(document).ready(function () {
        $(".hidden").hide();
        $(".expand").click(function () {
            $(".hidden").slideToggle("slow");

            if ($(".expand").html() == "[+] Expand") {
                $(".expand").html("[-] Collapse");
            } else {
                $(".expand").html("[+] Expand");
            }
        });
    }); 
```

这里是`<div>`'s。由于这是索引页，因此它们处于`foreach`循环中，因此对每条记录都重复（因此每条记录都被赋予相同的名称）。

```
 @if (item.BankListAgentId.Count > 5)
        {
            <div class="expand">[+] Expand</div>
            <div class="hidden">
                @foreach (var thing in item.BankListAgentId)
                {
                    string value = thing.FixedOrVariable.Trim();
                    if (value.Equals("F"))
                    {
                        var agentId = thing.AgentId.Trim();
                        var link = ViewBag.Periscope + agentId;
                        <a href="@link" target="_blank">@thing.StateCode: @agentId</a>
                        <br />                     
                    }
                }                
            </div>
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T21:24:32.743

我建议将您的 jQuery 更改为：

```
$(document).ready(function () {
    $(".hidden").hide();
    $(".expand").click(function () {
        $(this).next(".hidden").slideToggle("slow");

        if ($(this).html() == "[+] Expand") {
            $(this).html("[-] Collapse");
        } else {
            $(this).html("[+] Expand");
        }
    });
}); 
```

这样，您将仅定位单击的`.hidden`元素旁边的元素`.expand`，也可以使用`this`而不是`.expand`仅定位单击的元素...

# ruby-on-rails - 延迟作业出错。无法解析 YAML

> ID：16047324
> 
> 赞同：1
> 
> 时间：2013-04-16T21:20:43.767
> 
> 标签：ruby-on-rails, csv, yaml, delayed-job

我通过以下代码将 csv 文件传递​​给延迟作业。

```
csv_text = IO.read(params[:emails_import].tempfile.to_path, :encoding => 'UTF-8').gsub(" ", "")
csv_text = csv_text.gsub("\n\n", "\n")
Delayed::Job.enqueue ImportContact.new(@list.id, csv_text), :queue => "import-list-#{@list.id}" 
```

我通过工头收到以下错误消息。知道什么可能导致这个问题吗？我认为错误可能在 csv 文件中，但我不确定是哪里/是什么导致了问题。

```
[Worker(host:ubuntu pid:22678)] Starting job worker
16:50:22 worker.1 |   SQL (129.4ms)  UPDATE `delayed_jobs` SET locked_at = '2013-04-16 20:50:22', locked_by = 'host:ubuntu pid:22678' WHERE (id = 121 and (locked_at is null or locked_at < '2013-04-16 16:50:22') and (run_at <= '2013-04-16 20:50:22'))
16:50:22 worker.1 |   SQL (96.4ms)  UPDATE `delayed_jobs` SET locked_by = null, locked_at = null WHERE (locked_by = 'host:ubuntu pid:22678')
16:50:22 worker.1 | rake aborted!
16:50:22 worker.1 | couldn't parse YAML at line 6709 column 4
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/gems/delayed_job-3.0.3/lib/delayed/backend/base.rb:84:in `payload_object'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/gems/delayed_job-3.0.3/lib/delayed/backend/base.rb:71:in `name'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/gems/delayed_job-3.0.3/lib/delayed/worker.rb:230:in `handle_failed_job'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/gems/delayed_job-3.0.3/lib/delayed/worker.rb:191:in `block in run'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/gems/delayed_job-3.0.3/lib/delayed/lifecycle.rb:60:in `call'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/gems/delayed_job-3.0.3/lib/delayed/lifecycle.rb:60:in `block in initialize'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/gems/delayed_job-3.0.3/lib/delayed/lifecycle.rb:65:in `call'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/gems/delayed_job-3.0.3/lib/delayed/lifecycle.rb:65:in `execute'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/gems/delayed_job-3.0.3/lib/delayed/lifecycle.rb:38:in `run_callbacks'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/gems/delayed_job-3.0.3/lib/delayed/worker.rb:191:in `rescue in run'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/gems/delayed_job-3.0.3/lib/delayed/worker.rb:181:in `run'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/gems/delayed_job-3.0.3/lib/delayed/worker.rb:238:in `block in reserve_and_run_one_job'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/gems/delayed_job-3.0.3/lib/delayed/lifecycle.rb:60:in `call'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/gems/delayed_job-3.0.3/lib/delayed/lifecycle.rb:60:in `block in initialize'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/gems/delayed_job-3.0.3/lib/delayed/lifecycle.rb:65:in `call'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/gems/delayed_job-3.0.3/lib/delayed/lifecycle.rb:65:in `execute'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/gems/delayed_job-3.0.3/lib/delayed/lifecycle.rb:38:in `run_callbacks'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/gems/delayed_job-3.0.3/lib/delayed/worker.rb:238:in `reserve_and_run_one_job'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/gems/delayed_job-3.0.3/lib/delayed/worker.rb:166:in `block in work_off'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/gems/delayed_job-3.0.3/lib/delayed/worker.rb:165:in `times'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/gems/delayed_job-3.0.3/lib/delayed/worker.rb:165:in `work_off'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/gems/delayed_job-3.0.3/lib/delayed/worker.rb:133:in `block (4 levels) in start'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/gems/delayed_job-3.0.3/lib/delayed/worker.rb:132:in `block (3 levels) in start'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/gems/delayed_job-3.0.3/lib/delayed/lifecycle.rb:60:in `call'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/gems/delayed_job-3.0.3/lib/delayed/lifecycle.rb:60:in `block in initialize'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/gems/delayed_job-3.0.3/lib/delayed/lifecycle.rb:65:in `call'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/gems/delayed_job-3.0.3/lib/delayed/lifecycle.rb:65:in `execute'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/gems/delayed_job-3.0.3/lib/delayed/lifecycle.rb:38:in `run_callbacks'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/gems/delayed_job-3.0.3/lib/delayed/worker.rb:129:in `block (2 levels) in start'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/gems/delayed_job-3.0.3/lib/delayed/worker.rb:128:in `loop'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/gems/delayed_job-3.0.3/lib/delayed/worker.rb:128:in `block in start'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/gems/delayed_job-3.0.3/lib/delayed/plugins/clear_locks.rb:7:in `call'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/gems/delayed_job-3.0.3/lib/delayed/plugins/clear_locks.rb:7:in `block (2 levels) in <class:ClearLocks>'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/gems/delayed_job-3.0.3/lib/delayed/lifecycle.rb:78:in `call'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/gems/delayed_job-3.0.3/lib/delayed/lifecycle.rb:78:in `block (2 levels) in add'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/gems/delayed_job-3.0.3/lib/delayed/lifecycle.rb:60:in `call'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/gems/delayed_job-3.0.3/lib/delayed/lifecycle.rb:60:in `block in initialize'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/gems/delayed_job-3.0.3/lib/delayed/lifecycle.rb:78:in `call'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/gems/delayed_job-3.0.3/lib/delayed/lifecycle.rb:78:in `block in add'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/gems/delayed_job-3.0.3/lib/delayed/lifecycle.rb:65:in `call'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/gems/delayed_job-3.0.3/lib/delayed/lifecycle.rb:65:in `execute'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/gems/delayed_job-3.0.3/lib/delayed/lifecycle.rb:38:in `run_callbacks'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/gems/delayed_job-3.0.3/lib/delayed/worker.rb:127:in `start'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/gems/delayed_job-3.0.3/lib/delayed/tasks.rb:9:in `block (2 levels) in <top (required)>'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/bin/ruby_noexec_wrapper:14:in `eval'
16:50:22 worker.1 | /home/cory/.rvm/gems/ruby-1.9.2-p320@postpourri/bin/ruby_noexec_wrapper:14:in `<main>'
16:50:22 worker.1 | Tasks: TOP => jobs:work
16:50:22 worker.1 | (See full trace by running task with --trace)
16:50:22 worker.1 | exited with code 1
16:50:22 system   | sending SIGTERM to all processes
SIGTERM received 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T21:49:34.923

我刚刚在安装了 Delayed::Job 的全新 Rails 应用程序中运行了这段代码（根据您提供的内容进行了修改）：

```
class List
  attr_accessor :id
end
@list = List.new
@list.id = 123

class ImportContact
  def initialize(list_id, csv_text)
    @list_id = list_id
    @csv_text = csv_text
  end

  def perform
    puts @list_id
    puts @csv_text.length
  end
end

csv_text = IO.read('test_2000_import_contacts.csv', :encoding => 'UTF-8').gsub(" ", "")
csv_text = csv_text.gsub("\n\n", "\n")
Delayed::Job.enqueue ImportContact.new(@list.id, csv_text), :queue => "import-list-#{@list.id}" 
```

当我运行时`bundle exec rake jobs:work`，一切正常，这让我相信 YAML 对您正在导入的文件进行编码或解码的方式存在问题。

特别是，我会跑

```
yaml = Delayed::Job.find(121).handler
File.open('job-121.yml', 'w') { |f| f.write(yaml) } 
```

并检查周围的文件`line 6709 column 4`。

但是，这可能是建议您将文件存储在 S3 之类的东西中并将 URL 传递给`ImportContact`工作人员而不是整个 CSV 文本的时候了。这将缓解您当前遇到的问题，并帮助您避免使用大量文本列使数据库膨胀。

# java - Android ListView 不显示来自多个 ArrayList 的信息

> ID：16047330
> 
> 赞同：0
> 
> 时间：2013-04-16T21:21:22.760
> 
> 标签：java, android, listview, arraylist, android-arrayadapter

我最近一直在研究 Android ListViews，但遇到了一些问题。我看了一些教程，让最基本的 ListViews 工作得很好。但现在我想做一个显示一系列对象的 ListView。我以为我做的一切都是正确的。我的代码没有产生任何错误，但我希望创建的列表根本不显示。显然，我不确定为什么。

此应用程序的目的是编译气象站和机场列表并显示信息（例如名称、ID#、坐标等） - 所有这些都从 XML 文档解析并包含在 Arraylist 中（由单独的具有适当构造函数/getter/setter 的类）。基本上我得到一个站列表 - 然后从该列表中 - 一个设置为适配器的站名称列表。我的 ListView 应该只显示每个站的名称，但无济于事。

我已经测试了我的解析器和我的数组。一切正常，只是没有显示。根据所有教程，我的逻辑应该正确到我的适配器。有没有人有什么建议？我觉得我正在用尽所有解决方案。我的代码发布在下面：

```
public class MainActivity extends Activity {

    //local variables
    String station_id;
    String state;
    String station_name;
    double latitude;
    double longitude;
    String html_url;

    //List of Station Objects
    public ArrayList<Station> StationList = new ArrayList<Station>();

Method for DOM Parser
  public void readXML(){

    try {

        //new xml file and Read
        File file1 = new File("src/fl_wx_index3.xml");
        DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
        DocumentBuilder db = dbf.newDocumentBuilder();
        Document doc = db.parse(file1);
        doc.getDocumentElement().normalize();

        NodeList nodeList = doc.getElementsByTagName("station");

        for (int i = 0; i < nodeList.getLength(); i++) {

            Node node = nodeList.item(i);

            if(node.getNodeType() == Node.ELEMENT_NODE){

                final Element first = (Element) node;

                station_id = first.getElementsByTagName("station_id").item(0).getTextContent();
                state = first.getElementsByTagName("state").item(0).getTextContent();
                station_name = first.getElementsByTagName("station_name").item(0).getTextContent();
                latitude = Double.parseDouble(first.getElementsByTagName("latitude").item(0).getTextContent());
                longitude = Double.parseDouble(first.getElementsByTagName("longitude").item(0).getTextContent());
                html_url = first.getElementsByTagName("html_url").item(0).getTextContent();

                //iterate thru list, returning names of each airport
                StationList.add(new Station(station_id, state, station_name, latitude, longitude, html_url));

            }

        }
        } catch (Exception e) {
        System.out.println("XML Pasing Excpetion = " + e);
        }

}

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    //object for method call to read XML document
    MainActivity activity1 = new MainActivity();
    activity1.readXML();

     final ListView listview = (ListView) findViewById(R.id.listView1);

     //List to contain Weather station Names
     final ArrayList<String> nameList = new ArrayList<String>();

     for (int i = 0; i < StationList.size(); ++i) {
          nameList.add(StationList.get(i).getStationName());
        }

     //Array adapter
     final StableArrayAdapter adapter = new StableArrayAdapter(this,android.R.layout.simple_list_item_1, nameList);
     listview.setAdapter(adapter);  

}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.main, menu);
    return true;
}

}
//Class creating Adapter
class StableArrayAdapter extends ArrayAdapter<String> {

HashMap<String, Integer> mIdMap = new HashMap<String, Integer>();

public StableArrayAdapter(Context context, int textViewResourceId,
    List<String> objects) {
  super(context, textViewResourceId, objects);
  for (int i = 0; i < objects.size(); ++i) {
    mIdMap.put(objects.get(i), i);
  }
}

public long getItemId(int position) {
  String item = getItem(position);
  return mIdMap.get(item);
}

public boolean hasStableIds() {
  return true;
}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T22:05:13.443

我认为你有 HashMap 倒退。您希望它将列表视图位置（整数）映射到字符串。所以你想要 HashMap<Integer, String>;

# jquery - jquery 基于来自rails的调用追加或替换？

> ID：16047331
> 
> 赞同：0
> 
> 时间：2013-04-16T21:21:26.093
> 
> 标签：jquery, ruby-on-rails, append, railscasts, livesearch

我一直在关注几个 railscasts，目前有一个使用 will_paginate 的带有无尽页面的产品列表。我想实现 railscast #240 以在结果中添加实时搜索，但似乎存在一些逻辑冲突，我不确定如何纠正。

简单来说，index.js.erb 里面的无尽页面需要使用 append 在当前产品列表下方添加更多产品：

*$('#products')。**append** ('<%= j 渲染(@products) %>');*

然而，实时搜索实现需要用搜索结果中的新产品替换当前的产品列表：

*$('#products')。**html** ('<%= j 渲染(@products) %>');*

这是完整的块：

```
 $('#products').html('<%= j render(@products) %>');  // live search
    $('#products').append('<%= j render(@products) %>'); // endless page
    <% if @products.next_page %>
        $('.pagination').replaceWith('<%= j will_paginate(@products) %>');
    <% else %>
        $('.pagination').remove();
    <% end %> 
```

html() 和 append() 都非常适合它们各自的用途，如果我注释掉其他作品，但如果我不注释掉其中一个，它就会变得非常不稳定。

我该如何设置它，如果用户在搜索框中输入它会触发 html()，如果用户滚动它会触发 append()？有什么方法可以确定哪个事件触发了 index.js.erb 调用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T15:42:24.027

想出来以防万一它出现在其他人身上。对于大多数有经验的 Rails 人来说可能很明显，但作为一个新手，这对我来说是一个全新的概念。

我将搜索结果重构到另一个控制器和视图中，这让我可以使用单独的 js.erb 文件来替换 #products 的内容，同时产品控制器处理滚动的无限页面。

所以现在我有意见>产品>index.js.erb 使用 $('#products').append 和意见>结果>index.js.erb for $('#products').html 等

我还必须为我的路由文件创建一个 results_controller.rb 索引操作以及一个结果资源。

之后两者同时工作。

# ruby-on-rails - 运行 rake db:migrate [MAC] 时出现分段错误

> ID：16047336
> 
> 赞同：0
> 
> 时间：2013-04-16T21:21:45.073
> 
> 标签：ruby-on-rails, ruby

我正在尝试在 Rails 中运行 rake db:migrate，每次尝试时都会遇到相同的错误：

```
[BUG] Segmentation fault
ruby 1.9.3p194 (2012-04-20 revision 35410) [x86_64-darwin12.3.0] 
```

我已经安装了： gcc v4.2.1 ruby​​ 1.9.3p194 rails 3.2.13 XCode 的最新版本（昨晚更新） homebrew 0.9.1 mysql 5.0.96

我整个下午都在搜索 SO 和其他网站，但我只找到了关于 Linux/Debian 的问题的答案。

其他需要注意的事项： mysql gem（和 mysql2）没有安装到我的机器上。尝试安装时，我收到一条消息：

```
ERROR:  Error installing mysql:
ERROR: Failed to build gem native extension.

/Users/USERNAME/.rvm/rubies/ruby-1.9.3-p194/bin/ruby extconf.rb
checking for mysql_query() in -lmysqlclient... no
checking for main() in -lm... yes
checking for mysql_query() in -lmysqlclient... no
checking for main() in -lz... yes
checking for mysql_query() in -lmysqlclient... no
checking for main() in -lsocket... no
checking for mysql_query() in -lmysqlclient... no
checking for main() in -lnsl... no
checking for mysql_query() in -lmysqlclient... no
checking for main() in -lmygcc... no
checking for mysql_query() in -lmysqlclient... no
*** extconf.rb failed ***
Could not create Makefile due to some reason, probably lack of
necessary libraries and/or headers.  Check the mkmf.log file for more
details.  You may need configuration options. 
```

有人有想法么！我对 Rails 很陌生，对 ruby​​ 也很陌生，但是这个错误完全阻碍了我的进步。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T22:49:08.233

您在那里看到的错误意味着 ruby​​gems 找不到 mysql 开发库。确保它们已安装（使用 homebrew、macports 或 fink，无论您通常使用什么。）如果它们已安装但您仍然无法安装 mysql gem，请查看 mkmf.log 了解详细信息；您可能需要做一些特别的事情来告诉它在哪里可以找到这些库。

在您能够安装 Gemfile 中列出的所有 gem 之前，您将无法运行任何 rake 命令或 rails 控制台。

# angularjs - 将 Angularjs $save 方法与 .Net Web Api 一起使用

> ID：16047338
> 
> 赞同：0
> 
> 时间：2013-04-16T21:21:49.240
> 
> 标签：angularjs, asp.net-web-api, response

我正在使用 Angularjs $Resource $save CRUD 方法将数据提交到 RESTFull .Net Web API webservice：

```
phone.$save({}, function (data) {
        alert('success');
    }, function (data) {
        alert('failed');
    }); 
```

其中 phone 是一个 $resource 对象。调用成功地将电话对象传递给 Web API：

```
public async Task<Phone> Post([FromBody]Phone phone)
    {
        try
        {
            if (ModelState.IsValid)
            {
                phone.CreatedDate = DateTime.Now;
                this.Uow.Phones.Add(phone);
                this.Uow.Commit();

                return phone;
            }     
        }
        catch (Exception ex)
        {               
            throw new HttpResponseException(new HttpResponseMessage(HttpStatusCode.InternalServerError));

        }
        return null;
    } 
```

但是在返回响应时，会触发失败的回调并出现以下错误：

> “'ObjectContent`1' 类型无法序列化内容类型 'application/json; charset=utf-8' 的响应正文。”

在 $save 函数的 Angularjs 文档中，我们有：

```
card.$save();
// POST: /user/123/card/456 {id:456, number:'1234', name:'J. Smith'}
// server returns: {id:456, number:'1234', name: 'J. Smith'}; 
```

这意味着响应应该返回相同的对象，但具有更新的字段。

如何从 Web Api 返回有效响应？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T20:06:13.923

原来这是一个循环引用错误，我按照[这里的说明解决了这个错误](http://code.msdn.microsoft.com/Loop-Reference-handling-in-caaffaf7)

# list - Prolog将整数转换为数字列表

> ID：16047339
> 
> 赞同：4
> 
> 时间：2013-04-16T21:22:01.420
> 
> 标签：list, prolog, digit, clpfd

我想写一个谓词，一个整数和一个数字列表，如果 Digits 以正确的顺序包含整数的数字，则成功，即：

```
?-digit_lists( Num, [1,2,3,4] ).
[Num == 1234]. 
```

这是我到目前为止所拥有的：

```
my_digits( 0, [] ).
my_digits(N,[A|As]) :- N1 is floor(N/10), A is N mod 10, my_digits(N1, As). 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T18:20:10.163

如前所述，考虑使用有限域约束：

```
:- use_module(library(clpfd)).

number_digits(Number, 0, [Number]) :- Number in 0..9.
number_digits(Number, N, [Digit|Digits]) :-
        Digit in 0..9,
        N #= N1 + 1,
        Number #= Digit*10^N + Number1,
        Number1 #>= 0,
        N #> 0,
        number_digits(Number1, N1, Digits). 
```

这个谓词可以在所有方向上使用。实例化任一参数的示例：

```
?- number_digits(215, _, Ds).
Ds = [2, 1, 5] ;
false.

?- number_digits(N, _, [4,3,2,1]).
N = 4321 ;
false. 
```

还有两个更一般的查询：

```
?- number_digits(N, _, [A,B]).
N in 10..99,
_G2018+B#=N,
_G2018 in 10..90,
A*10#=_G2018,
A in 0..9,
B in 0..9 ;
false.

?- number_digits(N, _, Ds).
Ds = [N],
N in 0..9 ;
Ds = [_G843, _G846],
N in 0..99,
_G870+_G846#=N,
_G870 in 0..90,
_G843*10#=_G870,
_G843 in 0..9,
_G846 in 0..9 ;
etc. 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-07-23T21:31:17.250

我认为这更容易：

```
numToList(NUM,[LIST|[]]):-
   NUM < 10,
   LIST is NUM,
   !.
numToList(NUM,LIST):-
   P is NUM // 10,
   numToList(P,LIST1),
   END is (NUM mod 10), 
   append(LIST1,[END] ,LIST). 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-06-14T00:56:26.367

这是另一个基于[clpfd](/questions/tagged/clpfd "显示标记为“clpfd”的问题")的变体......基于`(#=)/3`并且我们定义： [`if_//3`](https://stackoverflow.com/a/29367581/4609915)

```
n_base_digits(N, R, Ds) :-
   N #> 0, % 仅正整数
   R #> 1, % 最小基数 = 2
   Ds = [D|_], % 前导数不能为 0
   D#>0,
   短语（n_base_digits_aux（N，R，Ds），Ds）。

n_base_digits_aux(N, Base, [_|Rs]) -->
   { D #= N mod Base,
     M #= N // 基数 },
 if_ (M #= 0,
       { Rs = [] },
       n_base_digits_aux(M, Base, Rs)),
   [D]。

```

使用 SICStus Prolog 4.3.3 查询：

```
| ?- n_base_digits(1234, 10, Ds).
Ds = [1,2,3,4] ? ;
no 
```

反过来也可以！

```
| ?- n_base_digits(I,10,[1,2,3]).
I = 123 ? ;
no 
```

请注意，上述内容比[@mat 在他的回答](https://stackoverflow.com/a/16067299/4609915)`number_digits/3`中提出的要快。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-17T17:09:28.823

您还可以避免递归并使用内置谓词进行类型转换：

```
my_digits(Number, List) :-
    atomic_list_concat(List, Atom),
    atom_number(Atom, Number). 
```

第一行将列表转换为原子，第二行将此原子转换为数字，如果该数字与传入的数字相同，则返回 true。

我不知道是否有更直接的方法将列表转换为数字（不要这么认为..），在这种情况下可以在一行中实现。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-18T17:21:00.427

为了课堂作业？教授可能正在寻找如下内容。一般规则，您对问题陈述的分析应首先确定特殊情况（在这种情况下，为零和负值），然后是一般情况。

```
: -- int_2_digits/2 ------------------------------------------------------------
: 
: The public api.
:
: we've got 2 special cases here:
: 
: * zero, and
: * negative numbers
:
: and, of course, the general case: a positive value.
:
: ------------------------------------------------------------------------------
int_2_digits( 0 , [0] ) .       : zero is a special case
int_2 digits( X , ['-'|Ds] ) :- : negative numbers are a special case
  X < 0 ,                       :   which we handle (YMMV) by prepending the
  X1 is - X ,                   :   sign and than processing the absolute value
  int_2_digits(X1,Ds) .         :
int_2_digits( X , Ds       ) :- : the general case is a positive value
  X > 0 ,                       : just invoke the worker predicate.
  int_2_digits(X,[],Ds) .       :

: -- int_2_digits/3 ------------------------------------------------------------
: 
: The guts of the operation.
: 
: We're using an accumulator here because we compute the result right-to-left,
: from least significant digit to most significant digit. Using the accumulator
: builds the list in the correst sequence, so we don't have to reverse it at
: the end.
: ------------------------------------------------------------------------------
int_2_digits( 0 , Ds , Ds ) .      : if we hit zero, we're done. Unify the accumulator with the result
int_2_digits( X , Ts  , Ds ) :-    : otherwise...
  D is mod(X,10) ,                 : - get the current digit (X modulo 10)
  T is div(X,10) ,                 : - get the next value via integer division
  int_2_digits( X1 , [T|Ts] , Ds ) : - recurse down
  .                                : Easy! 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-17T15:57:02.080

我不同意@ssBarBee。毕竟，如果您提供您的清单并且他们的指控是正确的，您应该得到 4321；但是你得到了这个：

```
?- my_digits(Num, [1,2,3,4]).
ERROR: is/2: Arguments are not sufficiently instantiated 
```

我们可以尝试`clpfd`：

```
my_digits( 0, [] ).
my_digits(N,[A|As]) :- N1 #= N/10, A #= N mod 10, my_digits(N1, As). 
```

我们得到这个：

```
?- my_digits(Num, [1,2,3,4]), label([Num]).
Num = -6789 ;
Num = 4321. 
```

我觉得这一切都很好奇，但是使用 clpfd 进行跟踪并不愉快。

如果你只是想解析一个数字列表，我倾向于让它像这样进行尾递归：

```
my_digits(Num, List) :- my_digits(0, List, Num).

my_digits(Num, [], Num).
my_digits(N, [A|As], Num) :- N1 is N * 10 + A, my_digits(N1, As, Num). 
```

这给了我们：

```
?- my_digits(Num, [1,2,3,4]).
Num = 1234 ;
false. 
```

但它不会生成：

```
?- my_digits(1234, X).
ERROR: is/2: Arguments are not sufficiently instantiated 
```

如果我在没有 clpfd 的情况下解决这个问题，我会倾向于只检查我的论点并有单独的谓词。格罗斯，我知道，但这就是我要做的。

```
my_digits(Num, List) :- 
    nonvar(List), 
    my_digits_p(0, List, Num).
my_digits(Num, List) :- 
    var(List), 
    my_digits_g(Num, ListRev), 
    reverse(ListRev, List).

my_digits_p(Num, [], Num).
my_digits_p(N, [A|As], Num) :- N1 is N * 10 + A, my_digits(N1, As, Num).

my_digits_g(0, []) :- !.
my_digits_g(N, [A|As]) :- A is N mod 10, N1 is floor(N / 10), my_digits_g(N1, As). 
```

如果数字是非变量，这可以解析或检查或生成：

```
?- my_digits(1234, X).
X = [1, 2, 3, 4].

?- my_digits(X, [1,2,3,4]).
X = 1234 ;
false.

?- my_digits(1234, [1,2,3,4]).
true;
false. 
```

如果您尝试使用两个参数作为变量生成，您将得到一个非常无用的结果：

```
?- my_digits(X, Y).
X = 0,
Y = []. 
```

所以我们可以尝试通过向 my_digits 添加另一个特殊情况来生成：

```
my_digits(Num, List) :- 
    var(Num), var(List), 
    my_digits_g_from(0, Num, ListRev), 
    reverse(ListRev, List).
my_digits(Num, List) :- 
    nonvar(List), 
    my_digits_p(0, List, Num).
my_digits(Num, List) :- 
    var(List), 
    my_digits_g(Num, ListRev),
    reverse(ListRev, List).

my_digits_g_from(N, N, List)   :- my_digits_g(N, List).
my_digits_g_from(N, Num, List) :- succ(N, N1), my_digits_g_from(N1, Num, List). 
```

这是很多代码，并且很好地展示了不使用`clp(fd)`. 不幸的事实是，在 Prolog 中进行算术运算时，必须解决`is`不统一的事实，但 的复杂性`clp(fd)`很好地证明了为什么会这样。

我希望其他人有更优雅的解决方案！

# java - 找不到明确的活动类

> ID：16047340
> 
> 赞同：1
> 
> 时间：2013-04-16T21:22:04.240
> 
> 标签：java, android, activitynotfoundexception

我刚开始 android 开发，我被困在这个问题上。当应用程序运行时，我会看到以下内容：

[http://imgur.com/yIFxvd4](http://imgur.com/yIFxvd4)

（如果链接断开或看不到图像，它只是一个带有三个按钮的横向模式菜单。）

这是我想看到的。但是，当我单击“开始播放”应该会导致 android 模拟器进入空白屏幕时，模拟器会退出我们的应用程序并说：“不幸的是，MainMenu 已停止。”

这是我在 LogCat 中遇到的错误：

```
04-15 21:49:08.779: W/dalvikvm(985): threadid=1: thread exiting with uncaught exception 
(group=0x409961f8)

04-15 17:56:24.539: E/AndroidRuntime(739): FATAL EXCEPTION: main
04-15 17:56:24.539: E/AndroidRuntime(739):
android.content.ActivityNotFoundException: Unable to find explicit activity class
{com.example.quote.board/android.inputmethodservice.Keyboard}; have you declared this
activity in your AndroidManifest.xml?
04-15 17:56:24.539: E/AndroidRuntime(739):  at 
android.app.Instrumentation.checkStartActivityResult(Instrumentation.java:1508)
04-15 17:56:24.539: E/AndroidRuntime(739):  at 
android.app.Instrumentation.execStartActivity(Instrumentation.java:1384)
04-15 17:56:24.539: E/AndroidRuntime(739):  at 
android.app.Activity.startActivityForResult(Activity.java:3190)
04-15 17:56:24.539: E/AndroidRuntime(739):  at 
android.app.Activity.startActivity(Activity.java:3297)
04-15 17:56:24.539: E/AndroidRuntime(739):  at 
com.example.quote.board.MainMenu$1.onClick(MainMenu.java:30)
04-15 17:56:24.539: E/AndroidRuntime(739):  at 
android.view.View.performClick(View.java:3480)
04-15 17:56:24.539: E/AndroidRuntime(739):  at 
android.view.View$PerformClick.run(View.java:13983)
04-15 17:56:24.539: E/AndroidRuntime(739):  at 
android.os.Handler.handleCallback(Handler.java:605)
04-15 17:56:24.539: E/AndroidRuntime(739):  at 
android.os.Handler.dispatchMessage(Handler.java:92)
04-15 17:56:24.539: E/AndroidRuntime(739):  at android.os.Looper.loop(Looper.java:137)
04-15 17:56:24.539: E/AndroidRuntime(739):  at 
android.app.ActivityThread.main(ActivityThread.java:4340)
04-15 17:56:24.539: E/AndroidRuntime(739):  at 
java.lang.reflect.Method.invokeNative(Native Method)
04-15 17:56:24.539: E/AndroidRuntime(739):  at 
java.lang.reflect.Method.invoke(Method.java:511)
04-15 17:56:24.539: E/AndroidRuntime(739):  at 
com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
04-15 17:56:24.539: E/AndroidRuntime(739):  at 
com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
04-15 17:56:24.539: E/AndroidRuntime(739):  at 
dalvik.system.NativeStart.main(NativeMethod) 
```

我目前有两个班。这是我的第一堂课，叫做 MainMenu：

```
package com.example.quote.board;

import android.inputmethodservice.Keyboard;
import android.os.Bundle;
import android.annotation.SuppressLint;
import android.app.ActionBar;
import android.app.Activity;
import android.content.Intent;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;

public class MainMenu extends Activity {

    @SuppressLint({ "NewApi", "NewApi", "NewApi" })
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main_menu);
    ActionBar action= getActionBar();
    action.hide();

    Button startPlaying = (Button) findViewById(R.id.startPlaying);
    Button specialKeyboard = (Button) findViewById(R.id.specialKeyboards);
    Button info = (Button) findViewById(R.id.info);

    startPlaying.setOnClickListener(new OnClickListener(){
        public void onClick(View v){
            Intent intent = new Intent(getApplicationContext(), Keyboard.class);
            startActivity(intent);
        }
    });

}
} 
```

我的另一门课叫做键盘：

```
package com.example.quote.board;

import android.app.ActionBar;
import android.app.Activity;
import android.os.Bundle;

public class Keyboard extends Activity{

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.keyboard);
    ActionBar action = getActionBar();
    action.hide();
}

} 
```

这是我的 AndroidManifest.xml 文件：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.quote.board"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="11"
        android:targetSdkVersion="15" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme"
         >
        <activity
            android:name=".MainMenu"
            android:screenOrientation="landscape"
            android:label="@string/title_activity_main_menu" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

        <activity
            android:name="com.example.quote.board.Keyboard"
            android:screenOrientation="landscape"
            android:label="@string/app_name" >
       </activity>

    </application>

</manifest> 
```

顺便说一句，我一直在和我的朋友一起做这个，他在 Windows 电脑上工作。我们使用 git 将文件传输给我。此外，这个应用程序的工作方式也完全符合他的要求。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T22:25:50.480

解决方案“你在你的 AndroidManifest.xml 中声明了这个活动吗？”写在 manifest.xml

```
<activity android:name=".nameOfYourActivity"> </activity> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T22:02:06.607

修复导入：您在 MainMenu 源中的导入不正确。你写道：导入 android.inputmethodservice.Keyboard; 但你需要：com.example.quote.board.Keyboard

# mqtt - Web 浏览器可以使用 MQTT 吗？

> ID：16047344
> 
> 赞同：37
> 
> 时间：2013-04-16T21:22:11.310
> 
> 标签：mqtt

我们正在考虑在我们正在构建的新设备上使用 MQTT 作为消息传递协议。我们还想要该设备的 Web 界面。有谁知道您是否可以实现与 MQTT 对话的浏览器客户端应用程序（无需额外插件）？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-16T23:01:39.640

是的，正如 Steve-o 的评论中提到的，通过 websockets MQTT 是非常可能的。

目前有2个选项

1.  IBM 的 MQ 7.5 带有 websockets 支持，您可以在[此处](http://www-01.ibm.com/software/websphere/subscriptionandsupport/compare-mq-versions.html)找到详细信息。
2.  Mosquitto 代理有一个 javascript 客户端，其中运行了一个[示例](http://test.mosquitto.org/ws.html)。

要回答您的第二个问题，lighttpd 有一个 websockets 模块，可用于向现有代理进行转发，详情请[点击此处](https://github.com/nori0428/mod_websocket)。

我找不到任何不需要您编写自己的库来进行转发的 Apache。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-08-23T21:12:47.970

要扩展 hardillbs 答案：

现在有第三种选择：

[HiveMQ](http://www.hivemq.com)支持本机 websocket，无需任何外部 web 服务器。它与[Eclipse Paho](http://www.eclipse.org/paho/)的 Javascript 客户端完美配合。

如果您想尝试一下，公共[MQTTDashboard](http://www.mqttdashboard.com)（在后台使用 HiveMQ）支持端口 8000 上的 websocket。

披露：我是 HiveMQ 的开发人员之一

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-10-19T02:58:38.753

IBM 发布了一个基于 WebSockets 的 JavaScript 客户端。它在 Eclipse Paho 上是开源的。

Git 存储库： http: [//git.eclipse.org/c/paho/org.eclipse.paho.mqtt.javascript.git/](http://git.eclipse.org/c/paho/org.eclipse.paho.mqtt.javascript.git/)

教程在这里。 [https://www.ibm.com/developerworks/community/blogs/c565c720-fe84-4f63-873f-607d87787327/entry/how_to_prog_javascript?lang=en](https://www.ibm.com/developerworks/community/blogs/c565c720-fe84-4f63-873f-607d87787327/entry/how_to_prog_javascript?lang=en)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-11-14T11:17:26.783

我们有很好的使用[WSS](https://github.com/stylpen/WSS)的经验，*WebSocket to TCP Gateway (for MQTT)*。这意味着运行一个单独的进程，但这确实避免了更改 Apache 的配置。WSS 还支持 TLS。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-11-10T22:23:26.377

不是 Apache，但您可以按照本指南使用 mod_websocket 安装 lighttpd，

[http://oriolrius.cat/blog/2013/09/25/server-send-push-notifications-to-client-browser-without-polling/](http://oriolrius.cat/blog/2013/09/25/server-send-push-notifications-to-client-browser-without-polling/)

但为了易于使用，我强烈推荐 HiveMQ，正如@Dominik 推荐的那样。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-05-06T14:06:00.730

jpmens的[博客](http://jpmens.net/2014/07/03/the-mosquitto-mqtt-broker-gets-websockets-support/)是使用 websocket 功能设置 mosquitto 的一个很好的起点。他[基于 Paho 的客户端 javascript 代码在 github 上](https://github.com/jpmens/simple-mqtt-websocket-example)。

这篇[博客“如何在同一个 por 上运行您的 Web 服务器和 MQTT WebSockets 代理”](https://blog.benjamin-cabe.com/2015/10/01/how-to-run-your-web-server-and-mqtt-websockets-broker-on-the-same-port)解释了服务器端的两种方式：

*   带有 http 配置的 mosquitto
*   apache+mod_websocket_mosquitto

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-05-25T16:09:10.227

为什么不`nodejs`+ `socket.io`？它们附带了所有的小工具（webscokets、pub/sub、webserver、mqtt broker...）。 [SocketCluster](http://socketcluster.io/)是另一个很好的起点。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-12-10T02:04:28.673

此链接（[下载代码](http://github.com/willem4ever/mod_websocket_mosquitto)）很有用。下载并修改此文件 mosq-mqttws31.html。而不是嵌入式java脚本库使用这个cdn

[https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.1/mqttws31.js](https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.1/mqttws31.js)

并且客户端实例化应该是 client = new Paho.MQTT.Client("test.mosquitto.org", 8080,"myclien256tiddd_" + parseInt(Math.random() * 100, 10));

# jquery - 使用 jquery 设置活动类

> ID：16047346
> 
> 赞同：0
> 
> 时间：2013-04-16T21:22:18.870
> 
> 标签：jquery, asp.net

我尝试使用以下 javascript 来设置活动类

```
var url = window.location.pathname,
                    urlRegExp = new RegExp(url == '/' ? window.location.origin + '/?$' : url.replace(/\/$/, '')); // create regexp to match current url pathname and remove trailing slash if present as it could collide with the link in navigation in case trailing slash wasn't present there
                // now grab every link from the navigation
                $('.page-sidebar a').each(function () {
                    // and test its normalized href against the url pathname regexp
                    if (urlRegExp.test(this.href.replace(/\/$/, ''))) {
                        $(this).addClass('active');
                    }
                }); 
```

问题是我需要在父`<li>`元素上设置它，而不是`<a>`

我的 HTML 菜单示例

```
<div class="page-sidebar nav-collapse collapse">
   <ul>
      <li>
          <div class="sidebar-toggler hidden-phone"></div>
      </li>
      <li class="start"> // HERE I NEED TO ADD CLASS ACTIVE
          <a href="/default.aspx">
          <i class="icon-home"></i>
          <span class="title">Dashboard</span>
          </a>
      </li>
<ul> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T21:25:21.050

使用`.closest(`) 查找与所需选择器匹配的最近的祖先/父级。这比仅使用直接父级更灵活、更安全，因为即使对 HTML 标记进行了某些类型的更改（例如在目标和父级之间插入了额外的标记层），它也会继续工作。

```
$(this).closest("li").addClass("active"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T21:24:18.930

更改`$(this).addClass('active');`为`$(this).parent().addClass('active');`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-16T21:24:29.773

要将其设置在父级上：

```
$(this).parent().addClass('active'); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-16T21:25:03.527

使用最近（）：

```
$(this).closest('li').addClass('active'); 
```

# c# - 绘制文本 - 需要帮助了解如何根据图像 ppi 缩放字体大小

> ID：16047350
> 
> 赞同：2
> 
> 时间：2013-04-16T21:22:43.077
> 
> 标签：c#

**问题**
我正在处理一个以不同垂直和水平分辨率扫描图像的系统。分辨率范围从 96dpi 到 300dpi。

我的用户需要能够在这些图像上绘制文本。使用 GDI+ 可以很容易地在图像上绘制文本。

**问题**
我难以理解的是，用户如何在图像上绘制文本并且绘制的文本看起来相同大小，而不管图像的垂直和水平分辨率如何。

我现在看到的是，如果我使用 28pt arial 字体在 96ppi 图像上绘制文本，那么如果我使用 28pt arial 字体在 300ppi 图像上绘制文本，那么文本会更小。

在将文本绘制到图像上时，如何考虑图像分辨率以缩放字体大小？

我正在使用 TextRenderer 类进行绘图。

```
TextRenderer.DrawText(graphics, this.txtComments.Text, font, startPoint, Color.Black); 
```

**更新#1**

这是我用来初始化字体的代码

```
System.Drawing.Font font = new System.Drawing.Font("Comic Sans MS", 28, FontStyle.Bold,  GraphicsUnit.Point) 
```

我尝试过使用 GraphicsUnit.Pixel 和 GraphicsUnit.Point，两者都对我没有任何影响。

**更新#2**

我尝试使用 Graphics.DrawString 方法，得到了相同的结果。

谢谢，

# python - 将 CSV 文件数据合并为一个 CSV 文件

> ID：16047353
> 
> 赞同：0
> 
> 时间：2013-04-16T21:23:09.743
> 
> 标签：python, csv, os.walk

我的 csv 文件分布在多个目录中，每个 csv 文件只有一列包含数据。我想要做的是读取所有这些文件并将每个文件的列放入 csv 文件中。最终的 csv 文件将以文件名作为其标题的列，并将其原始文件中的相应数据作为其列数据。

这是我里面的目录结构`~/csv_files/ ls`

```
ab   arc  bat-smg   bn       cdo  crh      diq  es   fo   gd   haw  ia   iu   ki   ksh  lez  lv   mo   na      no   os   pih  rmy   sah  simple  ss   tet  tr   ur   war  zea
ace  arz  bcl       bo       ce   cs       dsb  et   fr   gl   he   id   ja   kk   ku   lg   map-bms  mr   nah     nov  pa   pl   rn    sc   sk      st   tg   ts   uz   wo   zh
af   as 
```

每个目录都有两个 csv 文件，我想使用 os.walk() 函数，但我认为我对 os.walk 的理解是不正确的，这就是为什么目前我所拥有的没有产生任何东西。

```
import sys, os
import csv

root_path = os.path.expanduser(
    '~/data/missing_files')

def combine_csv_files(path):
    for root, dirs, files in os.walk(path):
        for dir in dirs:
            for name in files:
                if name.endswith(".csv"):
                    csv_path = os.path.expanduser(root_path + name)
                    if os.path.exists(csv_path):
                        try:
                            with open(csv_path, 'rb') as f:
                                t = f.read().splitlines()
                                print t
                        except IOError, e:
                            print e

def main():
    combine_csv_files(root_path)

if __name__=="__main__":
    main() 
```

我的问题是：

1.  我在这里做错了什么？
2.  我可以从另一个文件中读取一个 csv 列并将该数据作为列添加到另一个文件，因为 csv 文件更依赖于行，并且行之间没有依赖关系。

最后我试图得到这样的csv文件，（这里是潜在的标题）

```
ab_csv_data_file1, ab_csv_data_file2, arc_csv_data_file1, arc_csv_data_file2 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T21:30:54.733

您错误地使用 os.walk()

```
def combine_csv_files(path):
    for root, dirs, files in os.walk(path):
        for name in files:
            if name.endswith(".csv"):
                csv_path = os.path.join(root, name)
                try:
                    with open(csv_path, 'rb') as f:
                        t = f.read().splitlines()
                        print t
                except IOError, e:
                    print e 
```

os.walk() 函数产生一个 3 元组（目录路径、目录名、文件名）。其中“dirpath”是当前行走目录的路径，“dirnames”是“dirpath”中的目录列表，“filenames”是“dirpath”中的文件列表。“dirpath”可能是此处的“路径”，以及“路径”的任何子文件夹。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T21:40:25.680

我不知道我是否明白你的意思。让你有多个文件夹，如“ab”、“arc”等。对于每个文件夹，它包含两个 CSV 文件。

如果我是对的，那么你没有做正确的事。

```
def combine_csv_files(path):
    for root, dirs, files in os.walk(path):
        for dir in dirs:
            for dirpath, sub_dirs, sub_files in os.walk('/'.join([path,dir])
                for name in sub_files:
                    if name.endswith(".csv"):
                        csv_path = os.path.expanduser(dirpath + name)
                        if os.path.exists(csv_path):
                            try:
                                with open(csv_path, 'rb') as f:
                                    t = f.read().splitlines()
                                    print t
                            except IOError, e:
                                print e 
```

如果我是对的，上面的代码应该可以工作

# linux - Linux Shell 脚本：将文件和字符串一起写入另一个文件

> ID：16047356
> 
> 赞同：0
> 
> 时间：2013-04-16T21:23:13.297
> 
> 标签：linux, string, bash, file, echo

这是我的代码是 bash 脚本：

```
for string in $LIST
do
echo "$string" >> file
grep -v "#" file1 >> file
done 
```

“file1”仅包含一个值，并且该值会迭代更改。

我在“文件”中得到的结果是：

```
a
1
b
2
c
3 
```

但是，我想要这个：

```
a 1
b 2
c 3 
```

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T21:26:29.223

```
for string in $LIST
do
  echo "$string" $(grep -v "#" file1)
done > file 
```

# ruby - 使用 Heroku 存储和处理大型 XML 文件？

> ID：16047358
> 
> 赞同：2
> 
> 时间：2013-04-16T21:23:20.720
> 
> 标签：ruby, xml, heroku, xml-parsing, storage

我正在开发一个需要存储 2GB+ XML 文件进行处理的应用程序，我面临两个问题：

1.  如何处理文件？一次将整个文件加载到 Nokogiri 是行不通的。它很快就会耗尽内存，据我所知，这个过程会从轨道上被摧毁。是否有与 Heroku 兼容的方法可以快速/轻松地以较小的块读取位于非 Heroku 服务器上的大型 XML 文件？
2.  如何存储文件？该站点设置为使用 S3，但数据提供者需要 FTP 访问权限才能每晚上传 XML 文件。通过 FTP 的 S3 显然是不可行的，并且将文件存储在 Heroku 上也不起作用，因为它只会被拥有它的 dyno 看到并且容易被随机清除。以前有没有人遇到过这种类型的限制，如果有，你是如何解决的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T04:19:37.177

大多数时候，我们更喜欢解析已拉入内存的整个文件，因为它更容易来回跳转，根据我们的代码需要提取这个和那个。因为它在内存中，如果我们愿意，我们可以轻松地进行随机访问。

根据您的需要，您需要从文件顶部开始，阅读每一行，寻找感兴趣的标签，直到到达文件末尾。为此，您想使用[Nokogiri::XML::SAX](http://nokogiri.org/Nokogiri/XML/SAX.html)和[Nokogiri::XML::SAX::Parser](http://nokogiri.org/Nokogiri/XML/SAX/Parser.html)以及[Nokogiri::XML::SAX::Document](http://nokogiri.org/Nokogiri/XML/SAX/Document.html)中的事件。以下是 Nokogiri 网站上的功能摘要：

> SAX 样式解析器的基本工作方式是创建一个解析器，告诉解析器我们感兴趣的事件，然后给解析器一些 XML 来处理。解析器会在遇到您说您想知道的事件时通知您。

SAX 是与处理 DOM 不同的野兽，但它可以非常快，并且在内存上更容易。

如果您想以较小的块加载文件，您可以在`OpenURI.open`or`Net::HTTP`块中处理 XML，因此您将在 TCP 数据包大小的块中获取它。那么问题是您的行可能会被拆分，因为 TCP 不保证按行读取，而是按块读取，这就是您将在读取循环中看到的内容。您的代码必须在缓冲区末尾剥离部分行，然后将它们添加到读取缓冲区，以便下一个块读取完成该行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T21:32:11.110

1.  你需要一个流解析器。看看[https://github.com/craigambrose/sax_stream](https://github.com/craigambrose/sax_stream)

2.  您可以在 EC2 上运行自己的 FTP 服务器吗？或使用托管提供商，例如[https://hostedftp.com/](https://hostedftp.com/)

# backbone.js - 在骨干路由器上导航返回索引

> ID：16047369
> 
> 赞同：0
> 
> 时间：2013-04-16T21:24:17.447
> 
> 标签：backbone.js, routing

试图弄清楚如何在 Backbone 中触发索引路由。

```
routes:     
    '': 'home'    
    profile': 'init_profile' 
```

然后在 Chrome 控制台中..

```
app_router.navigate('', { trigger: true, replace: true }); 
```

不更改 URL 或触发任何回调。

但是，配置文件路由工作正常：

```
app_router.navigate('profile', { trigger: true, replace: true }); 
```

如何触发索引路由？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T13:25:41.920

`Backbone.history.navigate('', true)`

似乎工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T22:17:21.327

你应该只使用：

```
app_router.navigate('profile', true); 
```

它应该这样工作。

# python - Emacs 缩进不识别 Python 模式下的变量

> ID：16047375
> 
> 赞同：3
> 
> 时间：2013-04-16T21:24:31.563
> 
> 标签：python, r, emacs, indentation

所以我真的很喜欢 Emacs 如何在 Python 中自动为变量着色。但是，当有缩进时（例如在`for`循环中），它不再为语法着色。有没有简单的解决方案（R 也一样）？

编辑（因为评论）：您可以看到 var1 如何获得颜色，但在函数中变量赋值没有。

![在此处输入图像描述](https://i.stack.imgur.com/qHCic.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T18:30:20.930

它[适用](http://i.imgur.com/jiYTlo8.png)于 Emacs 24.3.1 附带的 Python 模式。升级您的 Emacs，问题就会消失。

（函数和变量的颜色相同是由于使用了“solarized”主题。）

# excel - excel vba：为什么这个函数无限循环？

> ID：16047377
> 
> 赞同：0
> 
> 时间：2013-04-16T21:24:34.703
> 
> 标签：excel, vba

我编写了以下函数来搜索工作表中最后一个可用的空白行。

```
 Function findlastLog_Row() As Integer
    Dim i As Integer

    i = 1 'start at row 1

    Do Until Sheets("Log").Cells(i, 1) = ""
        i = i + 1
    Loop

    findlastLog_Row = i
End Function 
```

任何想法为什么它一遍又一遍地循环。它似乎从倒数第二行重新开始`findlastLog_Row = i`。最后一行是返回 的值`i`。我是否过于简单化了这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T21:28:21.780

这是你正在尝试的吗？

```
Sub Sample()
    Debug.Print findlastLog_Row
End Sub

Function findlastLog_Row() As Long
    Dim ws As Worksheet

    Set ws = ThisWorkbook.Sheets("Log")

    With ws
        findlastLog_Row = .Range("A" & .Rows.Count).End(xlUp).Row
    End With
End Function 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T21:29:05.067

尝试将其更改为 Sheets("Log").Cells(i, 1).Value （因此最后的 .Value ）。.Cells() 将返回一个 Range 对象。我不完全确定范围的默认属性是什么，但它可能不是 .Value 属性。

# c# - 如何在 C# 中针对 MySQL 使用 openssl passwd -1

> ID：16047381
> 
> 赞同：1
> 
> 时间：2013-04-16T21:24:46.727
> 
> 标签：c#, mysql, openssl, md5

我正在为 iRedMail 服务器制作一个扩展，我想使用 C# 代码添加新用户。IrerdMail 将用户保存在 MySQL 数据库中，用户的密码使用 openssl (MD5) 加密。当我查看用于创建用户的 iRedMail api 时，bash 脚本中有一行代码：

```
openssl passwd -1 passwordToBeEncrpted 
```

终端内的该命令返回我的 MD5 字符串，如果我将该字符串复制到我的应用程序并针对托管在邮件服务器上创建的用户上的 MySQL 表执行插入命令，则可以正常工作。
从用户密码生成 MD5 以便我可以将其插入 MySQL 数据库的正确方法是什么？
我的应用程序在 iRedMAil 旁边的其他服务器上运行，是否必须在同一台机器上创建 MD5？我正在考虑从 C# 代码调用 SSH 命令，是否有免费的 .NET 库可以重用来自 SSH 的输出字符串作为变量？
这可以使用像 MSSQL 服务器中的 UDF 之类的东西来完成吗？我知道我如何从 MSSQL 云调用命令应用程序在 MySQL - CentoOS 组合中执行类似的操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T21:57:21.430

只是一个想法：与其尝试调用 openssl （用户必须安装，或者您必须在安装过程中包含）所有相关的麻烦，不如只移植[原始 C 源代码为 crypt](http://www.freebsd.org/cgi/cvsweb.cgi/~checkout~/src/lib/libcrypt/crypt.c?rev=1.2)。

这将花费您一些时间来正确安装，但 IMO 您的程序将更简单、更健壮且安装更紧凑。

编辑：在 SO 上查看这个问题：[Problem porting PHP crypt() function to C#](https://stackoverflow.com/questions/855103/problem-porting-php-crypt-function-to-c-sharp) - 他写的代码是为了与 BSD crypt 兼容，所以它可能正是你所需要的。我刚刚在Visual Studio 2010 并在此处与 Linux 机器上的 openssl 输出进行比较，并且输出匹配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-29T14:15:40.707

我的开源库[CryptSharp](http://www.zer7.com/software/cryptsharp)（自 2.0 起）支持 MD5 crypt。语法是：

```
string cryptedPassword = Crypter.MD5.Crypt("password"); 
```

应该做你需要的。

詹姆士

# javascript - 带有 pusher/faye 的 Rails 应用程序

> ID：16047386
> 
> 赞同：0
> 
> 时间：2013-04-16T21:25:08.617
> 
> 标签：javascript, ruby-on-rails, ruby, ruby-on-rails-3, faye

我被要求制作一个像这样的应用程序：http: [//www.dealcent.com/](http://www.dealcent.com/)

我无法弄清楚如何更新投标，我认为我可以使用 pusher 或 faye（[http://pusher.com/](http://pusher.com/)或[http://faye.jcoglan.com/](http://faye.jcoglan.com/)）之类的东西并订阅每个事件。但我想知道是否有更优雅/更有效的解决方案。

如果它可以托管在heroku上，或者它会更好的私人VPN。

它必须在rails 3上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T23:30:04.907

我使用 pusher 取得了很大的成功，因为我从未使用过它，所以不确定 faye。当这些作业完成时，我们使用推送器将来自异步后台作业的响应推送给用户。

它非常漂亮，只需很少的设置。

# php - PHP在后台执行脚本

> ID：16047387
> 
> 赞同：0
> 
> 时间：2013-04-16T21:25:08.807
> 
> 标签：php, background, exec

我必须在后台执行一个 php 脚本（a.php）。我试过这个，但它不工作：

```
<?
$cmd = "php /home/megad404/www/prove/a.php &> /dev/null &";
exec('/bin/bash -c "'.$cmd.'"',$output,$return);
if($return===0)
{
    echo 'Successful';
} 
else
{
    echo 'Unsuccessful';
}
?> 
```

它返回“成功”但它不执行 a.php

一个.php：

```
<?
file_put_contents(date("s"),"");
sleep(5);
file_put_contents(date("s"),"");
sleep(5);
file_put_contents(date("s"),"");
?> 
```

a.php 每 5 秒写入一个文件，它工作正常，除非我尝试使用第一个脚本在后台执行它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-29T16:20:56.970

您可以尝试改编 mi 脚本。查看命令 shell_exec() 而不是 exec()。首先返回 all ，第二个最后一行。

```
function run_in_background($Command, $Priority = 0) {
         if($Priority)
             $PID = shell_exec("nohup nice -n $Priority $Command > /dev/null & echo $!");
         else
             $PID = shell_exec("nohup $Command > /dev/null & echo $!");
         return($PID);
 }
     //Verifies if a process is running in linux
function is_process_running($PID) {
         exec("ps $PID", $ProcessState);
         return(count($ProcessState) >= 2);
} 
```

和例子

```
$PIDPHP=run_in_background("php -S 127.0.0.1:18086 ".__DIR__."/index.php"); // or any other process.

if (is_process_running($PIDPHP)){
    exec("kill $PIDPHP");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T12:54:59.467

您还可以考虑使用真正的 Posix/PCNTL 功能将脚本实际分离到背景，例如。使用 pcntl_exec 和 pcntl_fork()。在我看来，这是处理运行较长时间的后台脚本的正确方法，因为您可以与子/进程进行通信以获取更新、状态等，甚至让他们了解真正的信号处理。

PCNTL - [http://www.php.net/manual/en/book.pcntl.php](http://www.php.net/manual/en/book.pcntl.php)

POSIX - [http://www.php.net/manual/en/book.posix.php](http://www.php.net/manual/en/book.posix.php)

干杯

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T21:38:40.163

这对我有用：

```
<?php

$cmd = "/usr/bin/php /home/auser/a.php &> /dev/null &";
exec($cmd,$output,$return);
sleep(30);
if($return===0)
{
    echo 'Successful';
} 
else
{
    echo 'Unsuccessful';
}
?> 
```

我将它保存为 runa.php 并从命令窗口将其作为 php runa.php 运行。它产生了3个文件。

运行 a.php 也适用于 cron 作业：

```
]$ crontab -l
18 * * * * /usr/bin/php /home/auser/a.php 
```

我把脚本放在一个web目录下，发现我有一些写作问题。您可以在服务器日志中看到什么？

```
sudo tail -f /var/log/httpd/error_log 
```

如果您从网络浏览器中点击 a.php 会怎样？因为你提到的脚本是755，但是目录呢。也许它需要 775 或 777 进行测试，以便脚本可以写入文件？

为了测试，我创建了一个子目录“输出”并更改了 a.php

```
<?php
ini_set('date.timezone','America/New_York'); //without this it makes extra messages

error_log("a.php putting contents", 0);
file_put_contents("output/".date("s"),"");
sleep(5);
file_put_contents("output/".date("s"),"");
sleep(5);
file_put_contents("output/".date("s"),"");
error_log("a.php done", 0);
?> 
```

在我向输出文件夹授予写入权限之前，它无法写入文件

```
sudo chmod 777 /var/www/html/output 
```

然后我发现apache用户正在写文件：

```
~]$ sudo ls -l /var/www/html/output/
total 0
-rw-r--r--. 1 apache apache 0 Apr 18 11:38 00
-rw-r--r--. 1 apache apache 0 Apr 18 11:38 05
-rw-r--r--. 1 apache apache 0 Apr 18 11:37 55 
```

所以我改变了输出的所有者，以再次降低权限。

```
~]$ sudo ls -lu /var/www/html/ | grep output
drwxr-xr-x. 2 apache root 4096 Apr 18 12:21 output 
```

这现在也有效：

```
 ~]$ sudo ls -l /var/www/html/output
total 0
-rw-r--r--. 1 apache apache 0 Apr 18 12:21 44
-rw-r--r--. 1 apache apache 0 Apr 18 12:21 49
-rw-r--r--. 1 apache apache 0 Apr 18 11:37 55 
```

# c# - Response.Redirect() 将 HTML 正文附加到 URL

> ID：16047390
> 
> 赞同：0
> 
> 时间：2013-04-16T21:25:15.020
> 
> 标签：c#, asp.net

我`Response.Redirect`在 ASP .NET C# 应用程序中使用，根据成功或失败重定向到不同的网页。但是 Response.Redirect 不起作用。相反或重定向到新链接，目标网页的正文或内容被附加到现有 URL。我尝试了一个简单的 HelloWorld 页面，但仍然无法正常工作。例如：

如果我在主页中：`http://www.example.com/test/default.aspx` 并且如果我想重定向到`HelloWord`html 页面，那么最终 URL 将是 `Response.Redirect("~/../hello.html");`但我得到`http://www.example.com/<p>Hello%20World!!</p>`

由于 URL 不正确，我收到“拒绝访问错误”。

我在这里先向您的帮助表示感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T21:53:06.033

你应该使用：

```
Response.Redirect("~/hello.html"); 
```

如果您的 hello.html 在应用程序根目录中。

或者，如果您想要当前页面的相对父目录：

```
Response.Redirect("../hello.html"); 
```

~ 引用应用程序根目录，因此使用“~/..”您试图访问根目录的父目录，这是不允许的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T21:56:39.957

我认为您应该改用 Server.Transfer() 。它会将您重定向到新页面。例如：

> Server.Transfer("Home.html")

如果页面在同一目录中，否则只使用相对链接

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T10:56:06.537

您不能重定向到 IIS 站点之外的文件，因为“应用程序根目录的上一级”可能是这样。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-04-17T00:06:15.663

将以下代码添加到**Page_Load**事件中：

```
Response.Redirect("http://www.microsoft.com"); 
```

# sql - 用于 SQL 内部联接的 MS Access 中的括号问题

> ID：16047394
> 
> 赞同：1
> 
> 时间：2013-04-16T21:25:27.670
> 
> 标签：sql, ms-access, inner-join

已在 MS Access 中尝试过以下 SQL，但似乎无法使其正常工作，有人有更好的主意吗？

```
SELECT top 4 Student.STUDENT_DEGREE, Student.STUDENT_SEX,STUDENT_GROUP_ID,STUDENT_GROUP_ID2,RESULT_MARK
FROM (((Student)
INNER JOIN Result ON Student.STUDENT_ID=Result.RESULT_STUDENT_ID)
INNER JOIN Group ON RESULT_GROUP_ID = GROUP_ID)
where STUDENT_GROUP_ID <> ''
order by Result.RESULT_MARK desc; 
```

每当我运行它时，我都会收到错误消息：

FROM 子句中的语法错误

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T21:36:34.953

`Group`是一个[保留字](http://allenbrowne.com/AppIssueBadWord.html#G)。将该名称括在方括号中以避免混淆数据库引擎。您还可以为表名指定别名。

```
FROM
    (Student
    INNER JOIN Result
    ON Student.STUDENT_ID=Result.RESULT_STUDENT_ID)
    INNER JOIN [Group] AS g
    ON Result.RESULT_GROUP_ID = g.GROUP_ID 
```

我不得不猜测哪些表包含最后一个`ON`子句中的这些字段。如果您在 Access 查询设计器的设计视图中设置连接，它将帮助您获得正确的名称。它还将添加 db 引擎对包含多个连接的任何查询所需的括号。

还要限定`SELECT`列表中和查询中其他地方的字段名称的表源。同样，查询设计器可以为您提供正确的名称。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T21:28:11.163

删除 周围的额外括号`Student`：

```
SELECT top 4 Student.STUDENT_DEGREE,Student.STUDENT_SEX,STUDENT_GROUP_ID,STUDENT_GROUP_ID2,RESULT_MARK
FROM ((Student
INNER JOIN Result ON Student.STUDENT_ID=Result.RESULT_STUDENT_ID)
INNER JOIN Group ON RESULT_GROUP_ID = GROUP_ID)
where STUDENT_GROUP_ID <> ''
order by Result.RESULT_MARK desc; 
```

# c# - 从 C1FlexGrid 添加新行数据到 Access 97 .mdb 数据库 C#

> ID：16047395
> 
> 赞同：1
> 
> 时间：2013-04-16T21:25:30.550
> 
> 标签：c#, oledb, ms-access-97

作为一个快速背景，我是数据库编程的初学者，所以如果我在这里发布的任何内容没有意义或完全愚蠢，请原谅我。

我正在尝试制作一个 WinForm 应用程序，它允许用户连接到他们选择的 .mdb Access 97 数据库，允许用户进行更改（例如，在 WinForm 上添加新数据行，然后将其应用于原始 .mdb数据库），并在需要时在不同的 .mdb Access 97 数据库之间同步这些更改。

让您了解我到目前为止的情况。我已经使用 C# 成功连接到一个 .mdb Access 97 数据库，并将数据库表内容输出到一个`DataSet`对象中，然后我将其转储到一个对象中`C1FlexGrid`（代码稍后会跟随）。现在在任何人提及之前，我无法将数据库文件升级到更新版本，因此它必须保留为 Access 97 版本文件。

这是我用来连接的代码：

```
dbConnection  = new OleDbConnection(@"Provider=Microsoft.JET.OLEDB.4.0;Data Source=" + path);
dbCommand     = new OleDbCommand("SELECT * from MAIN", dbConnection);
dbDataAdapter = new OleDbDataAdapter(dbCommand);

dbDataSet = new DataSet("MasterLanguageDB");
dbConnection.Open();
dbConnectionIsOpen = true;

// connection is successful, unlock connected mode features
EnterDatabaseConnectedMode();

dbDataAdapter.Fill(dbDataSet);
flexGrid.DataSource = dbDataSet.Tables[0]; 
```

我的问题是：我现在用 .mdb 数据库文件内容填充的 C1FlexGrid 是否“绑定”到 .mdb 文件？因为 1，我没有按照 Microsoft 建议的方式通过 Visual Studio 2008 中的添加数据源向导来绑定数据源（因为用户可以连接到他们选择的任何 .mdb 数据库——不仅仅是一个）和 2，我希望对 C1FlexGrid 所做的任何更改都应用于原始数据库。

如果答案是否定的，我如何创建该“绑定”或将行添加到数据库中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T21:52:08.170

Dataset 或 DataTable 等 ADO.NET 类是断开连接的对象。
这意味着他们不能直接更新数据库。

OleDbDataAdapter 有一个名为[Update](http://msdn.microsoft.com/en-us/library/at8a576f.aspx)的方法，负责将所有修改后的数据发送到数据库。因此，假设您在某处有一个按钮来保存更改，那么您需要调用 click 事件

```
 dbDataAdapter.Update(dbDataSet); 
```

但是，这要求您将对象实例保持在类全局级别。
另外一点是需要准备`dbDataAdapter.InsertCommand, dbDataAdapter.UpdateCommand and dbDataAdapter.DeleteCommand`.

在您设置 SelectCommand 之后，可以使用[OleDbCommandBuilder](http://msdn.microsoft.com/en-us/library/system.data.oledb.oledbcommandbuilder.aspx)的实例简单地创建这些命令

```
 dbDataAdapter = new OleDbDataAdapter(dbCommand);
  OleDbCommandBuilder cb = new OleDbCommandBuilder(dbDataAdapter); 
```

# java - 在 Android 中比较图像

> ID：16047398
> 
> 赞同：0
> 
> 时间：2013-04-16T21:25:38.737
> 
> 标签：java, android

我正在创建井字游戏。这是单击事件-单击按钮时设置`background image ==num1`

```
public void onClick(View event) {
     // TODO Auto-generated method stub
     if(btn1 ==event){
        btn1.setBackgroundResource(num1);
     }
     if(btn2 ==event){
        btn2.setBackgroundResource(num1);
      } 
      if(btn3 ==event){
        btn3.setBackgroundResource(num1);
      } 
```

并且三个按钮显示相同的图像，图像是这样设置的

```
if(!(turn % 2 ==0)){
    num1=(R.drawable.nought);
}
else
    num1=(R.drawable.cross); 
```

所以问题是现在我需要比较这些图像以检查它们是否都相同。我怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T21:58:00.080

可能有一种方法可以检查背景是什么，但是为什么不将值保存在 2D 数组中呢？-1 表示未标记，0 表示 O，1 表示 X 或其他。在性能方面也可能更好（并不是说我期望井字游戏一开始就超级密集）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T21:55:20.930

这里我认为有一个类似的问题。

[我将背景图像资源 TextView 与 R.drawable.bg_image 进行比较以进行切换](https://stackoverflow.com/questions/6309730/who-i-compare-an-background-image-resource-textview-with-a-r-drawable-bg-image-f)

您可以存储每个按钮的 id。

有没有类似 button.getBackgroundResource() 的东西？

您可以覆盖 ImageButton 类并添加 backgroundResource 的 id。

# ruby-on-rails - 使用状态机进行级别提升？

> ID：16047407
> 
> 赞同：-1
> 
> 时间：2013-04-16T21:25:55.530
> 
> 标签：ruby-on-rails, ruby, associations, state-machine

逐级问答游戏：

我希望保存用户进度并在单击时返回适当的级别和步骤。用户升级时使用状态机有意义吗？多步骤形式？只是JavaScript？

我对是否应该只研究 state_machine gem 还是应该走一条不同的道路感到有些困惑。我真的很感激任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T23:09:41.877

查看状态机上的 Railscast：

[http://railscasts.com/episodes/392-a-tour-of-state-machines](http://railscasts.com/episodes/392-a-tour-of-state-machines)

# php - 搜索引擎只能单返回？

> ID：16047408
> 
> 赞同：0
> 
> 时间：2013-04-16T21:26:04.413
> 
> 标签：php, mysql, sql, search

大家好，我做了一个简单的搜索引擎，但是它有一个问题，当我搜索一个字符串时，我的结果只有一行我做错了什么我找不到多个结果。

搜索.php：

```
<?php
if (isset($_POST['search']) && !empty($_POST['xs']) && isset($_POST['s']))
    echo $functions->Search($_POST['xs'], $_POST['s']);
?> 
```

函数.php：

```
 function Search( $post, $type )
    {
    global $database;
        if ($database->getSearchData($type, $post) && preg_replace("/[^0-9A-Za-z]/", "", $post))
        return $database->getSearchData($type, $post);
         else
         return 
         '
<div class="title_box"><div class="title_inner">
Results </div></div>
<div class="title2_box"><div class="title2_inner">
<p>
<table width="50%">
<tr>
<td>Player</td>
<td>Level</td>
<td>Total honour</td>
</tr>
<tr><td class="f" colspan="2">No results</td></tr></table>  </p>
</div></div>
        ';
    } 
```

数据库.php：

```
 function getSearchData($type, $keyword)
        {
        $find = strtoupper( $find );
        $find = strip_tags( $find );
        $find = trim ( $find );

            switch($type)
            {
                case '1':
                    $q = "SELECT * FROM users WHERE upper(username) LIKE '%$keyword%'";
                break;
                case '2':
                    //$q = "SELECT * FROM guilds WHERE upper(username) LIKE '%$keyword%' LIMIT 25";
                    return false;
                break;
                case '3':
                    //$q = "SELECT * FROM guilds WHERE upper(username) LIKE '%$keyword%' LIMIT 25";
                    return false;
                break;
                default:
                    return false;
                break;
            }

            $result = mysql_query($q, $this->connection);

            if(mysql_num_rows($result) <= 0)
                return false;

             while($row = mysql_fetch_array( $result )) 
             { 
    return
    '
<div class="title_box"><div class="title_inner">
Results </div></div>
<div class="title2_box"><div class="title2_inner">
<p>
<table width="50%">
<tr>
<td>Player</td>
<td>Level</td>
<td>Total honour</td>
</tr>
<tr>
<td>
<a href="index.php?mod=player&p='.$row['id'].'" " target="_self">'.$row['username'].'</a>
</td>
<td style="text-align:center">'.$row['level'].'</td>
<td style="text-align:center">'.$row['honour'].'</td>
</tr>
</table>    </p>
</div></div>
    ';
             } 
        } 
```

问题只有一个结果需要多个。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T21:28:57.687

`return`你在你的`while`循环中调用了。当`return`被调用时，函数退出并将指定的数据发送回调用者。每次函数调用只能发生一次。

要纠正此问题，您可能需要创建一个临时变量来存储您的结果集，并在每次迭代结果集时将其连接到该变量上。然后您可以在循环结束后调用`return`一次以返回整个集合。

# java - 具有扫描仪输入的二次公式

> ID：16047417
> 
> 赞同：0
> 
> 时间：2013-04-16T21:26:45.983
> 
> 标签：java, input, java.util.scanner, output, quadratic

好的，所以我是一个完整的 Java 菜鸟，我正在尝试为使用扫描仪输入运行二次方程的类创建一个程序。到目前为止，我得到的是：

```
import java.util.*;

public class QuadraticFormulaSCN {

public static void main(String[]args) {
  System.out.println("insert value for a:");
  Scanner scan1 = new Scanner(System.in);
   double a = scan1.nextDouble();
    System.out.println("insert value for b:");
  Scanner scan2 = new Scanner(System.in);
    double b = scan2.nextDouble();
    System.out.println("insert value for C:");
  Scanner scan3 = new Scanner(System.in);
   double c = scan3.nextDouble();

    double answer =((Math.sqrt(Math.pow(b,2)-(4*a*c))-b)/2);
      double final2 =(-b + Math.sqrt(Math.pow(b,2)-(4*a*c)))/2;
  System.out.println("The x values are:" + answer + final2);
}
} 
```

但我得到一个奇怪的输出，特别是`NaNaN`......我该怎么做才能解决这个问题？我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T21:29:07.073

`NaN`是计算无效时得到的东西。比如除以0或者取-1的平方根。

当我用 测试您的代码时，`a = 1`答案是`b = 0``c = -4``2.02.0`

格式不正确，计算`final2`不取反。

否则代码是正确的。

为了改进，您可以检查判别式是否为负。

```
double d = b*b -4 * a * c;
if (d < 0){
   System.out.println("Discriminant < 0, no real solutions" );
   return;
}
double x1 = (-b  -sqrt(d))/(2*a);
double x2 = (-b +sqrt(d))/(2*a);
System.out.format("The roots of your quadratic formula are %5.3f and %5.3f\n",x1,x2); 
```

或者，如果您更喜欢支持复杂领域的解决方案：

```
if (d < 0) {
    System.out.println("Discriminant < 0, only imaginary solutions");
    double r = -b / (2 * a);
    double i1 = -sqrt(-d) / (2 / a);
    double i2 = sqrt(-d) / (2 / a);
    System.out.format("The roots of your quadratic formula are (%5.3f + %5.3fi) and (%5.3f + %5.3fi)\n",r, i1, r, i2);
    return;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T21:39:07.637

我回答有点晚了，但我纠正了你的问题（在其他答案中描述），修复了你的一个计算，并清理了你的代码。

```
import java.util.*;

public class Test {

    public static void main(String[] args)
    {
        Scanner s = new Scanner(System.in);
        System.out.println("Insert value for a: ");
        double a = Double.parseDouble(s.nextLine());
        System.out.println("Insert value for b: ");
        double b = Double.parseDouble(s.nextLine());
        System.out.println("Insert value for c: ");
        double c = Double.parseDouble(s.nextLine());
        s.close();

        double answer1 = (-b + Math.sqrt(Math.pow(b, 2) - (4 * a * c))) / (2 * a);
        double answer2 = (-b - Math.sqrt(Math.pow(b, 2) - (4 * a * c))) / (2 * a);

        if (Double.isNaN(answer1) || Double.isNaN(answer2))
        {
            System.out.println("Answer contains imaginary numbers");
        } else System.out.println("The values are: " + answer1 + ", " + answer2);
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-16T21:29:17.660

你得到`NaN`是因为你试图取负数的平方根。在数学中这是不允许的，除非您允许复数，例如`1 +/- 2i`.

当判别式（平方根中的事物）为负时，这可能发生在二次公式中，例如`x^2 + 6*x + 100`：`b^2 - 4ac`= 36 - 400 = -364。在 Java中取负数的平方根[导致`NaN`](http://docs.oracle.com/javase/7/docs/api/java/lang/Math.html#sqrt%28double%29). （不是数字）

适当地测试`NaN`、使用[`Double.isNaN`](http://docs.oracle.com/javase/7/docs/api/java/lang/Double.html#isNaN%28double%29)和处理`NaN`。

此外，即使`NaN`没有遇到，您的计算也不正确：

```
$ java QuadraticFormulaSCN
insert value for a:
1
insert value for b:
5
insert value for C:
6
The x values are:-2.0-2.0 
```

这应该输出 2.0 和 3.0

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-16T21:38:27.790

您只应在判别式等于或大于零时进行计算

```
if(((Math.pow(b,2)-(4*a*c))>= 0){ /* Calculation here */ } 
else {/*error message or complex number calculus*/}; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-11-29T04:02:34.500

我总是尝试做的一件事是将我所有的数学都放在适当的括号中，以避免太容易出现操作顺序错误。NaN 表示“不是数字”。如果用户输入的数字无法产生结果，您也会收到该消息，例如尝试获取负数的平方根。另外，就像一个注释一样，您可以通过仅在扫描仪上使用 a、b 和 c 来节省一些时间。

```
public class QuadraticFormula{

   public static void main(String[] args){
      java.util.Scanner input = new java.util.Scanner(System.in);
      double a = input.nextDouble();
      double b = input.nextDouble();
      double c = input.nextDouble();

      double quadPos = (-b + Math.sqrt(Math.pow(b,2)-(4*a*c)))/(2*a);
      double quadNeg = (-b - Math.sqrt(Math.pow(b,2)-(4*a*c)))/(2*a);

      System.out.println("-b - = " + quadNeg + "\n-b + = " + quadPos);

      }
   } 
```

# jquery - 滚动时打开和关闭元素

> ID：16047419
> 
> 赞同：2
> 
> 时间：2013-04-16T21:26:53.783
> 
> 标签：jquery

我一直在尝试使用 jQuery 在用户滚动过去时向 div 添加一个类，然后在他们滚动回 div 的原始位置时再次将其删除。它被用于论坛，因此当用户滚动浏览面包屑时，他们会停留在页面顶部。这是我目前正在使用的代码：

```
$.noConflict();
jQuery(document).ready(function($){
     $(window).scroll( function() {
        if ($(window).scrollTop() > $('#secondary_navigation').offset().top)
            $('#secondary_navigation').addClass('floating');
        else
            $('#secondary_navigation').removeClass('floating');
    } );
}); 
```

它工作......几乎; 但是，当 div 卡在页面顶部时，它会闪烁。在查看实时代码时，会不断添加和删除类，从而导致可怕的滚动体验。

有人知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T21:34:45.543

div 的偏移量在浮动时会发生什么？:)
我认为更好的方法是将该 div 的初始偏移量存储在一个变量中并使用它。就像是 ：

```
$.noConflict();
jinogreQuery(document).ready(function($){
     var scrollTarget = $('#secondary_navigation').offset().top;
     $(window).scroll( function() {
        if ($(window).scrollTop() > scrollTarget)
            $('#secondary_navigation').addClass('floating');
        else
            $('#secondary_navigation').removeClass('floating');
    } );
}); 
```

# linq-to-entities - LINQ to EF 使用查找表

> ID：16047420
> 
> 赞同：1
> 
> 时间：2013-04-16T21:26:54.423
> 
> 标签：linq-to-entities, entity-framework-5

我有一个主 VendorProfile 表和一个包含状态代码和日期戳的 1-many VendorHistory 表。下面的查询仅用于检索每个供应商的最新状态（状态代码和日期）。但是，我还想做的是将状态代码转换为状态名称，该名称位于 StatusCodes 查找表中。

[模型图](https://skydrive.live.com/redir?resid=CD5A047338E8C232!1145&authkey=!ABZipFbNNDI14RQ)

```
public IEnumerable<BrowseStatusModel> BrowseByStatus()
{
    IQueryable<BrowseStatusModel> viewModel = _db.VendorProfiles
    .Include("VendorStatusHistory")
    .Include("StatusCodes")
    .Select(s => new BrowseStatusModel
    {
        ProfileID = s.ProfileID,
        Name = s.Name,
        CompanyName = s.CompanyName,
        DateCreated = s.DateCreated,
        Status = s.VendorStatusHistories.OrderByDescending(o => o.DateCreated).FirstOrDefault().Status, 
        StatusDate = s.VendorStatusHistories.OrderByDescending(o => o.DateCreated).FirstOrDefault().DateCreated,
        StatusName = ???
    })
    .OrderBy(x => x.ProfileID);
    return viewModel;
} 
```

作为额外的跟进，我想知道如何修改上述查询以仅返回 VendorHistory 表中有匹配行的供应商 - 以排除没有历史记录的记录。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T19:06:55.197

您可以先选择最后`VendorStatusHistory`一个，然后再选择其属性：

```
_db.VendorProfiles
.Select(s => new { 
                   Profile = s, 
                   LastHist = s.VendorStatusHistories
                               .OrderByDescending(o => o.DateCreated)
                               .FirstOrDefault()
                 })
    .Select(x => new BrowseStatusModel
    {
        ProfileID = x.Profile.ProfileID,
        Name = x.Profile.Name,
        CompanyName = x.Profile.CompanyName,
        DateCreated = x.Profile.DateCreated,
        Status = x.LastHist.Status, 
        StatusDate = x.LastHist.DateCreated,
        StatusName = x.LastHist.StatusCOde.StatusName
    })
    .OrderBy(x => x.ProfileID); 
```

# wpf - 是否可以使用 EnvDTE.ClassInfo 对象测试接口实现

> ID：16047421
> 
> 赞同：2
> 
> 时间：2013-04-16T21:26:54.587
> 
> 标签：wpf, silverlight, t4, envdte, boilerplate

全部，

我有一个 T4 模板，它生成样板代码来处理我的属性更改通知，并根据我分配给类的属性自动为我注册依赖属性。我使用 EnvDTE 在项目中上下移动并检索 ClassInfo 对象的 IEnumerable 来完成此操作。然后，我枚举 ClassInfo.Attributes 以检索具有我创建的某些自定义属性（即 INotifyPropertyChangedAttributeAttribute:System.Attribute）的 ClassInfo 对象，其中包含我需要让模板为我编写样板代码的所有相关信息。

现在，我的问题是，是否可以（使用 EnvDTE）检查可能从基类继承的接口实现（例如 INotifyPropertyChanged），这样我的类中就不会出现两个 PropertyChanged 事件（一个在继承的类和代码生成的部分类中的一个）？

例如：

```
public class vmBase : INotifyPropertyChanged
{
    public event PropertyChangedEventHandler PropertyChanged

    protected override void OnPropertyChanged(PropertyChangedEventArgs e)
    {
        if (PropertyChanged != null) PropertyChanged(this, e);
    }
}

[INotifyPropertyChangedAttribute(Test1, typeof(string))] //NOTE: By including this attribute, T4 template will automatically generate properties.  What I need to know, though, is if the EnvDTE.ClassInfo can show Internface implementations as well so that I don't recreate the INotifyPropertyChanged Event
public partial class vm: vmBase //Implements INotifyPropertyChanged
{
    //....
}

[INotifyPropertyChangedAttribute(Test2, typeof(string))]
public partial class SomeClassThatDoesNotImplementInotifyPropertyChangedAlready
{
    //....
} 
```

希望这有点道理。

有关使用 envDTE 和 T4 处理依赖属性注册的示例，请参见[http://www.scottlogic.co.uk/blog/colin/2009/08/declarative-dependency-property-definition-with-t4-dte/ 。](http://www.scottlogic.co.uk/blog/colin/2009/08/declarative-dependency-property-definition-with-t4-dte/)我的项目中的概念是相同的，只是我正在对其进行调整以处理 INotifyPropertyChanged 样板代码。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-10-12T23:22:03.450

另一种方法（可能更健壮）是利用[CodeClass](https://msdn.microsoft.com/en-us/library/EnvDTE.CodeClass.aspx)接口的[IsDerivedFrom](https://msdn.microsoft.com/en-us/library/envdte.codeclass.isderivedfrom.aspx)属性。例如，您的模板可能如下所示：

```
<#@ template  debug="true" hostSpecific="true" #>
<#@ output extension=".cs" #>
<#@ Assembly Name="System.Core" #>
<#@ assembly name="EnvDte" #>
<#@ import namespace="System" #>
<#@ import namespace="System.IO" #>
<#@ import namespace="System.Diagnostics" #>
<#@ import namespace="System.Linq" #>
<#@ import namespace="System.Collections" #>
<#@ import namespace="System.Collections.Generic" #> 
<#    
  foreach(var ns in GetNamespaceElements())
  {
    foreach(var cc in ns.Members.OfType<EnvDTE.CodeClass>())
    {
      if (cc.IsDerivedFrom["System.ComponentModel.INotifyPropertyChanged"]) {
#>YOUR_CODE_HERE<#  
      }
    }
  }
#>

<#+
  public IEnumerable<EnvDTE.CodeNamespace> GetNamespaceElements()
  {
    var visualStudio = (this.Host as IServiceProvider).GetService(typeof(EnvDTE.DTE))
                        as EnvDTE.DTE;
    var project = visualStudio.Solution.FindProjectItem(this.Host.TemplateFile)
                  .ContainingProject as EnvDTE.Project;

    var projItems = new List<EnvDTE.ProjectItem>();
    FillProjectItems(project.ProjectItems, projItems);
    var names = new HashSet<string>(projItems
      .Where(i => i.FileCodeModel != null)
      .SelectMany(i => i.FileCodeModel.CodeElements.OfType<EnvDTE.CodeElement>())
      .Where(e => e.Kind == EnvDTE.vsCMElement.vsCMElementNamespace)
      .Select(e => e.FullName));

    var codeNs = new List<EnvDTE.CodeNamespace>();
    FillCodeNamespaces(project.CodeModel.CodeElements.OfType<EnvDTE.CodeNamespace>(), codeNs);

    return codeNs.Where(ns => names.Contains(ns.FullName));
  }

  public void FillCodeNamespaces(IEnumerable<EnvDTE.CodeNamespace> parents, List<EnvDTE.CodeNamespace> all)
  {
    foreach (var parent in parents)
    {
      all.Add(parent);
      FillCodeNamespaces(parent.Members.OfType<EnvDTE.CodeNamespace>(), all);
    }
  }

  public void FillProjectItems(EnvDTE.ProjectItems items, List<EnvDTE.ProjectItem> ret)
  {
    if (items == null) return;
    foreach(EnvDTE.ProjectItem item in items)
    {
      ret.Add(item);
      FillProjectItems(item.ProjectItems, ret);
    }
  }
#> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T22:47:02.113

我花了一点时间，但是是的——有一种方法可以通过 EnvDTE 找出给定的类是否以某种方式继承了给定的接口。

此代码片段仅检测直接从另一个实现 INotifyPropertyChanged 的​​类继承的类。所以在使用它之前，可以在这里添加一些递归逻辑......

```
<#
// get a reference to the project of this t4 template
var project = VisualStudioHelper.CurrentProject;
// get all class items from the code model
var allClasses = VisualStudioHelper.GetAllCodeElementsOfType(project.CodeModel.CodeElements, EnvDTE.vsCMElement.vsCMElementClass, false);

// iterate all classes
foreach(EnvDTE.CodeClass codeClass in allClasses)
{
    // get all interfaces implemented by this class

    var allInterfaces = VisualStudioHelper.GetAllCodeElementsOfType(codeClass.ImplementedInterfaces, EnvDTE.vsCMElement.vsCMElementInterface, true);
    if (allInterfaces.OfType<EnvDTE.CodeInterface>()
                     .Any(i => i.Name == "INotifyPropertyChanged"))
    {
        #>Implements Interface Directly: <#= codeClass.FullName #>
        <#

        // find classes that derive from this code class
        foreach(EnvDTE.CodeClass potentialDerivingClass in allClasses)
        {
            IEnumerable<string> theBases = VisualStudioHelper.GetAllCodeElementsOfType(potentialDerivingClass.Bases, EnvDTE.vsCMElement.vsCMElementClass, true).OfType<EnvDTE.CodeClass>().Select(cc => cc.FullName);
            if (theBases.Any(b => b == codeClass.FullName))
            {
                #>Derives from implementing class: <#= potentialDerivingClass.FullName #>
                <#
            }
        }
    }
}
#> 
```

因此，假设一个实现 INotifyProperty 的类 A 发生了变化，一个从 A 派生的 B 类和另一个从 B 派生的类 C，此代码将提出实现 INotifyPropertyChanged 的​​类 A 和 B。

注意：因为使用 EnvDTE 类不是很好，所以我使用了有形 T4 编辑器的免费模板库中的一个可重用模板，名为“tangible Visual Studio Automation Helper”——这使它更易于使用！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T22:16:05.863

可能有更好的方法，但我决定做的是创建一个新属性

```
[AttributeUsage(AttributeTargets.Class, AllowMultiple = false)]
public class INotifyPropertyChangedInheretedAttributeAttribute : Attribute
{
    public INotifyPropertyChangedInheretedAttributeAttribute():base()
    {
    }
} 
```

这样，我可以在不从根本上改变我的 T4 模板的情况下测试该属性是否存在。但是，如果有更好的方法，我会很乐意将其标记为答案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-01-27T09:23:09.403

作为所有解决方案的补充（我回答是因为我还不能添加评论:(）。我用过

```
 foreach (CodeInterface iface in cc.ImplementedInterfaces)
 {
     if(iface.Name == "INotifyPropertyChanged")
     {
           MessageBox.Show(cc.Name);
     }
  } 
```

此代码用于查找已实现的类。

# gwt - GWT user.agent 属性的最终列表以及它们对应的浏览器

> ID：16047427
> 
> 赞同：14
> 
> 时间：2013-04-16T21:27:31.990
> 
> 标签：gwt, browser, agent

有谁知道 GWT 的 user.agent 属性和目标浏览器的最终列表？如果我能在网络上的任何地方找到这样的东西，我会被诅咒的！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-04-16T22:01:41.760

最新的 gwt "user.agent" 属性值可以在[UserAgent.gwt.xml](https://gwt.googlesource.com/gwt/+/master/user/src/com/google/gwt/useragent/UserAgent.gwt.xml)文件中找到：

```
<define-property name="user.agent" values="ie6" /> <!-- ie6 also matches ie7-->
  <extend-property name="user.agent" values="ie8" />
  <extend-property name="user.agent" values="gecko1_8" /> <!-- Firefox 3.0+ -->
  <extend-property name="user.agent" values="safari" /> <!-- Webkit based browsers, usually Safari&Chrome-->
  <extend-property name="user.agent" values="opera" />
  <extend-property name="user.agent" values="ie9" fallback-value="ie8" /> 
```

解析属性值的代码可以在[com.google.gwt.useragent.rebind.UserAgentPropertyGenerator类中找到](https://gwt.googlesource.com/gwt/+/master/user/src/com/google/gwt/useragent/rebind/UserAgentPropertyGenerator.java)

但是这个值因版本而异，有时也可以覆盖默认值和属性提供者。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-06-25T12:39:52.237

好吧，我没有足够的声誉来评论现有答案，所以这里有另一个答案！这只是要注意代码库已移动，并且包含此信息的 GWT 源文件现在已移动。新位置是：[https ://gwt.googlesource.com/gwt/+/master/user/src/com/google/gwt/useragent/UserAgent.gwt.xml](https://gwt.googlesource.com/gwt/+/master/user/src/com/google/gwt/useragent/UserAgent.gwt.xml)

在撰写本文时，名单是：

```
<define-property name="user.agent" values="ie8" />
<extend-property name="user.agent" values="gecko1_8" />
<extend-property name="user.agent" values="safari" />
<extend-property name="user.agent" values="ie9" fallback-value="ie8" />
<extend-property name="user.agent" values="ie10" /> 
```

# jquery - Drupal 7 暴露过滤器 jquery 拖放表单

> ID：16047428
> 
> 赞同：0
> 
> 时间：2013-04-16T21:27:37.310
> 
> 标签：jquery, drupal, drupal-views, drupal-exposed-filter

我需要创建基于 jquery 的拖放暴露过滤器。我有一个过滤器，可以按 id 对我的recipies 进行排序，我需要做的是创建一个拖放界面，用户可以在其中拖放一个 ingridient 图像并启动过滤器。

这如何在视图中实现？正在考虑创建两个不同的视图，一个带有一个 ingridients 列表（可拖动），另一个带有暴露的过滤器（可放置），然后卡住了。

请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T20:04:00.403

尝试隐藏视图提供的公开表单，并使用带有可拖动元素的视图来映射公开的表单可用性值。在我看来，与 jQuery UI 相关的东西比 drupal 更重要。

# javascript - 将 xquery 结果值存储在 jscript 变量中

> ID：16047431
> 
> 赞同：0
> 
> 时间：2013-04-16T21:27:57.343
> 
> 标签：javascript, xml, xquery

您好，这是我的问题：我有一个包含在如下变量中的 xml：

```
<channel>
<available>yes</available>
<label>CNN</label>
</channel>
<channel>
<available>yes</available>
<label>BBC</label>
</channel>
.... 
```

我想使用 xquery 使用以下条件获取值：

```
For Channels.Channel

where Channel/availability = yes

And Channels.Channel/Label = «CNN»

Return  EXIST(Channels.Channel/Id) 
```

我的问题是：如何执行 xquery 以返回此 ID 值并将结果存储在我以后可以使用并传递给其他系统的 javascript 变量中。如果不可能，请让我知道您将如何在此 xml 中获取变量

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T21:38:23.660

我对您的示例有些困惑，但从表面上看，我认为这将返回所有 ID 值。

```
for $channel in $channels/channel
where ($channel/available = 'yes' and $channels/channel/label = 'CNN')
return $channel/id 
```

要与其他系统通信，您可以创建一个 JSON Web 服务并将其返回给您的 JavaScript。

# ember.js - 一页上有多个网点

> ID：16047434
> 
> 赞同：2
> 
> 时间：2013-04-16T21:28:12.600
> 
> 标签：ember.js

我正在尝试使用 Ember.js 组合一个应用程序

在这里找到 jsfiddle：http: [//jsfiddle.net/wprk14/ARbMa/](http://jsfiddle.net/wprk14/ARbMa/)

我想我的路由/页面/模板可以正常工作，但我的导航无法显示。我想我需要添加另一个导航出口，但文档并没有真正帮助我理解我需要做什么。

相关 HTML

```
<div id="wrapper">
    <div id="main-content">
        <script type="text/x-handlebars">
            {{outlet}}
        </script>
    </div>
</div>
<footer>
    {{outlet nav}}
</footer>

<script type="text/x-handlebars" data-template-name="nav">
    <ul id="tab-bar">
        <li>{{#linkTo "messages.inbound"}}Inbox{{/linkTo}}</li>
        <li>{{#linkTo "messages.outbound"}}Sentbox{{/linkTo}}</li>
        <li>{{#linkTo "parking"}}Parking{{/linkTo}}</li>
        <li>{{#linkTo "fuel"}}Fuel Tracker{{/linkTo}}</li>
    </ul>
</script> 
```

相关JS

```
App.Router.map(function() {
this.route("login");
this.resource('messages', function() {
    this.route('inbound');
    this.route('outbound');
});
this.route("parking");
this.route("fuel", { path: '/fuel-tracker' });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T23:13:43.690

您应该添加 {{render nav}} 而不是 {{outlet nav}} 以在所有页面上呈现导航栏，无论当前插座内有什么。

# javascript - MIPS：将寄存器值打印到控制台

> ID：16047452
> 
> 赞同：1
> 
> 时间：2013-04-16T21:29:23.757
> 
> 标签：javascript, debugging, mips

我试图在 MIPS 中模拟最基本的 javascript 调试形式。与此等效的是什么（`$t0`在此示例中等于 javascript 变量）：

```
console.log($t0); 
```

换句话说，我如何在 MIPS 中将某个变量的内容打印到控制台？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T01:13:42.783

`syscall`是要走的路。此外，如果您需要一个良好的界面来使用 MIPS，那么我建议您使用此工具。它带有一些易于使用且功能强大的调试工具，听起来可能会有所帮助：

[http://pages.cs.wisc.edu/~larus/spim.html](http://pages.cs.wisc.edu/~larus/spim.html)

# time - 为什么进程超时终止？

> ID：16047454
> 
> 赞同：0
> 
> 时间：2013-04-16T21:29:27.833
> 
> 标签：time, operating-system

我正在阅读 William Stallings 的操作系统。**我在阅读进程终止原因**时遇到了下面的行，

**超时：**

```
The process has waited longer than a specified maximum for a certain event
to occur. 
```

例如，一个程序想要从用户那里获取输入，因此它处于阻塞状态。现在，如果用户在特定时间段内没有提供任何输入，则根据此语句，程序应该进入退出状态。这是不切实际的。似乎没有一个程序这样做。请指导。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T21:34:40.300

书上给出的原因可能是`starvation`。当一个进程需要执行某项任务而无法执行时，这种情况称为饥饿。因此，如果进程到达最后期限，则终止进程。

# python - 在 python 中查找替换列表的 itertools 或 functools

> ID：16047455
> 
> 赞同：4
> 
> 时间：2013-04-16T21:29:29.083
> 
> 标签：python, functional-programming, itertools, functools

我有一组有时无效的字符串，我想用更好的字符串替换它们。我一直在玩 functools 和 itertools 并想尝试将它们应用于问题，但我有点卡住了。这是我所拥有的：

```
s1 = 'how to sing songs'
s2 = 'This is junk'
s3 = "This is gold"
s4 = 'HTML'
s5 = 'html'
s6 = 'i'
mylist = [s1,s2,s3,s4,s5,s6]

replacements = [('html','HTML'),('how to sing songs','singing'),('This is junk', ''),('i','')] 
```

我想要一个函数算法，对于 mylist 中的每个字符串，对于替换中的每个替换，string.replace(replacement[0],replacement[1])。

想到了什么，比如……

```
map(lambda x,y: x.replace(y[0],y[1]),mylist,replacements)
map(partial(lambda x,y: x.replace(y[0],y[1]),mylist),replacements) 
```

但是第一个需要额外的参数，第二个说列表对象没有属性替换。有没有一种巧妙的实用方法来解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T21:34:30.447

```
>>> [reduce(lambda x, y: x.replace(y[0], y[1]), replacements, s) for s in mylist]
['singing', '', 'This is gold', 'HTML', 'HTML'] 
```

等效代码，`map()`而不是列表理解：

```
map(partial(reduce, lambda x, y: x.replace(y[0], y[1]), replacements), mylist) 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-16T22:24:14.200

听起来你想要一些非常快的东西。在这种情况下，您真的应该使用字典，因为查找速度非常快。

一个工作示例：

```
mylist = ['how to sing songs', 'This is junk', "This is gold", 'HTML', 'html', 'i']
replacements = {'html':'HTML', 'how to sing songs':'singing', 'This is junk':'', 'i':''}

print [replacements.get(word, word) for word in mylist]  
# ['singing', '', 'This is gold', 'HTML', 'HTML', ''] 
```

# magento - 某些产品没有出现在 magento 的前端

> ID：16047462
> 
> 赞同：0
> 
> 时间：2013-04-16T21:29:52.383
> 
> 标签：magento, csv, upload, product

我正在使用 magmi 通过 csv 在我的网站上上传产品。一切都很顺利。

但是有一次我通过上传产品时犯了一个错误`CSV`。

产品已上传，但尚未分配到相应的类别。我再次上​​传了文件。产品已分配给类别，当我单击类别时，我可以看到它们

但我在目录下和前端看不到它们

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T21:37:43.097

确保产品已启用，并且没有“缺货”。通常进口产品（至少以我的经验）是在禁用状态下进口的，可用数量为 0。

此外，根据您的缓存选项，您可能必须重建类别的索引以显示产品。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T08:30:08.060

请检查以下可能性：-

(1)。检查产品“状态”是否设置为“已启用”。

(2)。检查产品是否未设置为可见“单独不可见”

(3)。还要检查产品在库存中是否设置为“有货”。

所以这些是可能影响前端产品展示的可能性。

# android - 如何在 Mac 上的 Eclipse“Juno”中创建一个新的 PhoneGap Android 项目？

> ID：16047463
> 
> 赞同：1
> 
> 时间：2013-04-16T21:29:53.107
> 
> 标签：android, eclipse, cordova

我最近重新安装了我的操作系统，并且曾经有一个 PhoneGap / Android 项目。现在我想再次使用它，所以我重新安装了 Eclipse 和 ADT 插件。到目前为止一切顺利。现在说明说：

“选择新建 > Android 项目”

但是，Android Project 不像以前那样出现在新项目下。

[http://www.adobe.com/devnet/html5/articles/getting-started-with-phonegap-in-eclipse-for-android.html](http://www.adobe.com/devnet/html5/articles/getting-started-with-phonegap-in-eclipse-for-android.html)

我下载了 phonegap-2.6.0，但可能它没有连接到 Eclipse……在这个阶段我该怎么做才能让 Android Project 出现？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T21:51:44.650

如果菜单下没有“Android 项目”，这与 PhoneGap 无关，可能与 ADT 有关，您确定您安装正确吗？
而且，您也可以使用“命令行”使用PhoneGap创建Android项目，然后您只需转到相同的菜单：“新建>项目”然后选择具有现有源的Android项目选择您之前通过命令行创建的路径，就是这样.

**编辑1：确保找到“android-sdk-mac_x86”的真实目录**

**edit2：这是您使用终端创建 Android 项目的方式**

```
/path/to/cordova-android/bin/create /path/to/my_new_cordova_project com.example.cordova_project_name CordovaProjectName 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-02T17:52:09.393

我有一个类似的问题。**对我来说，当我从phonegap**项目导入源时单击**完成**时，Eclipse 不会响应。

 **后来我发现我提到了一个不正确的 android-sdk 路径。

检查这是否是您的问题。

如果是，请按以下方式更改：

1.  在 Eclipse IDE 中，单击**Window**菜单，然后单击**Preferences**。
2.  将打开一个弹出窗口。
3.  在左侧窗格中，单击**Android**（单击*它*，而不是它旁边的**+号）。**
4.  在**SDK Location**字段中，单击**Browse**并指向您的 android-sdk 的位置。
5.  你完成了！

希望有帮助。

**编辑：**

我正在使用 Eclipse Juno，但希望其他版本的选项也几乎相同。如果这不正确，请发表评论。**

# ios - iOS：碰撞对象和 PanGestureRecognizer

> ID：16047474
> 
> 赞同：1
> 
> 时间：2013-04-16T21:30:46.313
> 
> 标签：ios, objective-c, uiview, collision-detection, uipangesturerecognizer

我已经实现了在我的 iPhone 屏幕上`PanGetsureRecognizer`拖动我`buttons`的`images`和其他组件，但现在我有一个关于对象碰撞的新冲突。

我已经以这种方式实现了我的需求：

```
if(CGRectIntersectsRect(menu1Drag.frame, menu2Drag.frame)){
    // blablabla
} 
```

不幸的是，它不起作用。我想知道是否有针对碰撞对象的特定语句`PanGesture`。我查看了许多网站，但它们使用的语句与上面相同。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T10:24:15.420

1.  检查 menu1Drag 和 menu2Drag 是否在同一级别的视图层次结构中。
2.  在 if(CGRectIntersectsRect(menu1Drag.frame, menu2Drag.frame)) 之前尝试记录他们的框架的细节。

# autoit - 简单的自动点击器无焦点

> ID：16047482
> 
> 赞同：1
> 
> 时间：2013-04-16T21:31:28.750
> 
> 标签：autoit, sendkeys, minimized

我正在尝试找到一种方法来制作一个简单的机器人，该机器人可以在最小化窗口中单击 4 个位置，而不必专注于它。这是我到目前为止得到的：

```
#include <Misc.au3>

Local $hDLL = DllOpen("user32.dll")

While 1
ControlClick ( "Eclipse Flyff", "", "" ,"left" , 1 , 724 , 1067 )
ControlClick ( "Eclipse Flyff", "", "" ,"left" , 1 , 757 , 1067 )
ControlClick ( "Eclipse Flyff", "", "" ,"left" , 1 , 791 , 1067 )
ControlClick ( "Eclipse Flyff", "", "" ,"left" , 1 , 1516 , 1010 )
    If _IsPressed("10", $hDLL) Then
        ConsoleWrite("_IsPressed - Shift Key was pressed." & @CRLF)
        ; Wait until key is released.
        While _IsPressed("10", $hDLL)
             Sleep(250)
        WEnd
         ConsoleWrite("_IsPressed - Shift Key was released." & @CRLF)
    ElseIf _IsPressed("1B", $hDLL) Then
        MsgBox(0, "_IsPressed", "The Esc Key was pressed, therefore we will close the application.")
        ExitLoop
    EndIf
    Sleep(250)
WEnd

DllClose($hDLL) 
```

我的问题是它没有做任何事情，我认为它可能会被游戏阻止，但我不确定这在 AutoIt 中是否仍然可行，或者我要求太多，因为这是我第一次使用它。

人们告诉我使用 C#，但我不知道它如何与 post message 一起使用，所以我真的有一个小困境，因为我不想放弃我开始的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T08:55:22.297

这是一个如何将击键发送到最小化控件的工作示例。您需要先找出 ControlID，然后即使在最小化时也要在发送一些键之前设置其焦点。

```
Run("notepad")
$np = WinWaitActive("[CLASS:Notepad]")
ControlSend($np, Default, "", "Active" & @CR)
$control = ControlGetFocus($np)
WinSetState($np, Default, @SW_MINIMIZE)

ControlFocus($np, Default, $control)
ControlSend($np, Default, $control, "Minimized" & @CR) 
```

# html - CSS - 如何让页脚留在页面底部？

> ID：16047487
> 
> 赞同：3
> 
> 时间：2013-04-16T21:31:45.697
> 
> 标签：html, css

这里的布局是我的网站[http://jsfiddle.net/QvFV8/12/](http://jsfiddle.net/QvFV8/12/)的模板，您可以看到内容溢出页脚。

它适用于只有少量内容的情况，这是我想要的。我在第一个页脚部分都尝试过 clear ，但这没有效果

无论内容量如何，如何拉伸页面以使页脚保持在底部（某些页面的内容会比其他页面更多或更少）

```
<body> 
<div class="container">
    <div class="header">
        <div class="headerleft">
            <div class="headerleftcon">leftcon</div>
            </div>
        <div class="headerright">
            <div class="headerrightcon">rightcon</div>
            </div>
        <div class="header-content">Header
        </div>
    </div> 
    <div class="body">
        <div class="left-sidebar">
            <div class="left-content">left sidebar</div>
        </div>
        <div class="right-sidebar">
            <div class="right-content">right sidebar</div>
        </div>
        <div class="content">Content 1
        <div class="centerbox">
            <div class="centerboxcontent">Center box <br>  </div>
        </div>Content 2 <br> Content 2 <br>Content 2 <br>Content 2 <br>Content 2  
        bla bla bla
        </div>
    </div> 
    <div class="footer">
        <div class="footerleft">
            <div class="footerleftcon">botleftcon</div>
            </div>
        <div class="footerright">
            <div class="footerrightcon">botrightcon</div>
            </div>
        <div class="footer-content">Footer</div>
    </div>
</div> 
</body> 
```

CSS如下

```
html, body {
height: 100%;
width: 100%;
padding: 0px;
margin: 0px;}
.header, .footer{
height: 80px;
background-color: #EFEFEF;
position: relative;}
.header-content{
padding: 20px;
text-align: center;}
.headerleft{
height: 100%;
background-color: red;
width: 50px;
float: left;}
.headerleftcon{
padding: 0px 0px 0px 0px;}
.headerright{
height: 100%;
background-color: red;
width: 50px;
float: right;}
.headerrightcon{
padding: 0px 0px 0px 0px;}
.footer-content{
padding: 20px;
text-align: center;}
.container{
height: 100%;}
.body{
height: 100%;
margin-top: -80px;
margin-bottom: -80px;
background-color: #C7DFFA;} 
.content{
padding: 80px 0px 0px 0px;}
.left-sidebar{
height: 100%;
background-color: gray;
width: 50px;
margin-top: -80px;
margin-bottom: -80px;
float: left;
clear: both;} 
.right-sidebar{
height: 100%;
background-color: gray;
width: 50px;
margin-top: -80px;
margin-bottom: -80px;
float: right;}
.centerbox{
height:100px;
background-color: blue;}
.centerboxcontent{
padding:  0px 0px 0px 0px;} 
.right-content{
padding:  80px 0px 0px 0px;
text-align: right;}
.left-content{
padding:  80px 0px 0px 0px;} 
.footer{
   clear:both;}
.footerleft{
height: 100%;
background-color: red;
width: 50px;
float: left;}
.footerleftcon{
padding: 0px 0px 0px 0px;}
.footerright{
height: 100%;
background-color: red;
width: 50px;
float: right;}
.footerrightcon{
padding: 0px 0px 0px 0px;} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T21:48:56.047

我知道获得一个网站的页脚比其他任何事情都难，但我不知道我还有多少关于这个的问题，它只是一个学习 CSS 的呼吁，现在这里有两个我做了之前对于同一个问题

所以，你要做的是确保你的页脚绝对在你容器的底部，所以你需要让你的容器位置：相对；和 100% 的内容高度容器还必须有一个填充底部，即 footer 的高度。真的是这样

[http://jsfiddle.net/eTwJh/2/](http://jsfiddle.net/eTwJh/2/)这是一个没有内容的 - [http://jsfiddle.net/eTwJh/3/](http://jsfiddle.net/eTwJh/3/)

重复的问题在这里

[如何确保我的页脚一直显示在页面末尾而不是中间？](https://stackoverflow.com/questions/15179998/how-do-i-make-sure-that-my-footer-shows-all-the-way-at-end-of-the-page-rather-th/15180121#15180121)

这是一些示例代码

```
 <!DOCTYPE html>
<html>
<head>
    <title>My Amazing Footer</title>
    <style>
    html, body {
       margin:0;
       padding:0;
       height:100%;
    }
    .wrapper {
       min-height:100%;
       position:relative;
    }
    footer{
        background:#F1F1F1;
        position: absolute;
        bottom: 0px;
        left: 0px;
        width: 100%;
        height:300px;
    }

    footer p{
        text-align: center;
        padding-top:100px;
    }
    </style>
</head>
<body>
    <div class="wrapper">
        <div class="Content">
            <p>HTML Ipsum Presents</p>
        </div>
        <footer>
            <p>&copy; My Website 2013\. All Rights Reserved!</p>
        </footer>

    </div>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T23:12:47.880

```
* {
    margin: 0px;
    padding: 0px;
}
html, body {
    height: 100%;
}
.header, .footer {
    height: 80px;
    background-color: #EFEFEF;
}
.header-content {
    padding: 20px;
    text-align: center;
}
.headerleft {
    height: 100%;
    background-color: red;
    width: 50px;
    float: left;
}
.headerleftcon {
    padding: 0px 0px 0px 0px;
}
.headerright {
    height: 100%;
    background-color: red;
    width: 50px;
    float: right;
}
.headerrightcon {
    padding: 0px 0px 0px 0px;
}
.footer-content {
    padding: 20px;
    text-align: center;
}
.container {
    width: 100%;
    min-height: 100%;
    position: relative;
    overflow: hidden;
}
.body {
    background-color: #C7DFFA;
    overflow: hidden;
    margin-bottom: -30000px;
    padding-bottom: 30000px;
}
.content {
    margin-right: 50px;
    margin-left: 50px;
    padding-right: 0px;
    padding-bottom: 0px;
    padding-left: 0px;
    margin-bottom: 80px;
}
.left-sidebar {
    background-color: gray;
    width: 50px;
    float: left;
}
.right-sidebar {
    background-color: gray;
    width: 50px;
    float: right;
}
.left-sidebar, .right-sidebar {
    margin-bottom: -30000px;
    padding-bottom: 30000px;
}
.centerbox {
    background-color: blue;
}
.centerboxcontent {
    padding:  0px 0px 0px 0px;
}
.right-content {
    text-align: right;
}
.left-content {
}
.footer {
    clear:both;
    position: absolute;
    width: 100%;
    left: 0px;
    right: 0px;
    bottom: 0px;
}
.footerleft {
    height: 100%;
    background-color: red;
    width: 50px;
    float: left;
}
.footerleftcon {
    padding: 0px 0px 0px 0px;
}
.footerright {
    height: 100%;
    background-color: red;
    width: 50px;
    float: right;
}
.footerrightcon {
    padding: 0px 0px 0px 0px;
} 
```

# javascript - 有什么方法可以使用 Raphael js 库绘制表格

> ID：16047488
> 
> 赞同：0
> 
> 时间：2013-04-16T21:31:49.610
> 
> 标签：javascript, raphael

我正在使用 Raphael JS 创建类似 ERD 的工具，但不知道如何使用 Raphael 创建类似表的实例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-09T11:12:46.853

```
paper = new Raphael(0,0,500,500);

var x = 100;
var y = 50;
var height = 50
var width = 100;

WriteTableRow(x,y,width*2,height,paper,"TOP Title");
y= y+height;
WriteTableRow(x,y,width,height,paper,"Score,Player");
y= y+height;
for (i=1;i<=4;i++)
{
var k;
k = Math.floor(Math.random() * (10 + 1 - 5) + 5);
WriteTableRow(x,y,width,height,paper,i+","+ k + "");
y= y+height;
}

function WriteTableRow(x,y,width,height,paper,TDdata)
{
    var TD = TDdata.split(",");
    for (j=0;j<TD.length;j++)
    {
        var rect = paper.rect(x,y,width,height).attr({"fill":"white","stroke":"red"});
        paper.text(x+width/2, y+height/2, TD[j]) 
        x = x + width;
    }
} 
```

// [http://jsfiddle.net/LG5zn/116/](http://jsfiddle.net/LG5zn/116/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T11:53:23.000

Raphael 可以绘制任何东西，但是如果您要手动创建表格等等，那么您可能会与框架作斗争。我最喜欢这个库的一个方面是它可以与传统的 HTML、CSS 和 Javascript 无缝协作。我强烈建议您从 HCJ 那里获得您想要的东西，并将 Raphael 用于任何不容易做到的事情。

# c# - 设置像素数据的最佳方法？

> ID：16047489
> 
> 赞同：2
> 
> 时间：2013-04-16T21:31:52.737
> 
> 标签：c#, performance, xna, xna-4.0, texture2d

我正在开发一种“落沙”风格的游戏。

我尝试了许多将沙子绘制到屏幕上的方法，但是，每种方法似乎都会以一种或另一种形式产生一些问题。

我经历过的事情清单：

1.  从像素大小的纹理一次一个地绘制每个像素。问题：每次更新大约有 100,000 个像素发生变化后速度变慢。

2.  将每个像素绘制到一个大的texture2d，绘制texture2d，然后清除数据。问题：使用 texture.SetPixel() 非常慢，即使处理旧纹理，也会导致少量内存泄漏（大约每秒 30kb，加起来很快），即使在对象上调用 dispose 也是如此。我根本不知道如何阻止它。然而，总的来说，这是最好的方法（到目前为止）。如果有办法阻止泄漏，我想听听。

3.  使用位图中的 Lockbits。从位图的角度来看，这非常有效，但不幸的是，我仍然必须将位图转换回 texture2d，这会导致帧速率下降到小于 1。所以，如果我能找到一种在 xna 中绘制位图而不转换它（或其他东西）的方法，它就有可能很好地工作。

4.  通过用透明像素替换像素的“旧”位置，然后用正确的颜色设置新位置，将每个像素设置为带有设置像素的纹理 2d。这使完成工作所需的像素组数量增加了一倍，并且比使用数字 2 慢得多。

所以，我的问题是，有更好的主意吗？或者关于如何修复样式 2 或 3 的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T08:38:48.597

我的直接想法是你正在拖延 GPU 管道。GPU 可以有一个管道，它比您发出的命令滞后几帧。

因此，如果您发出命令在纹理上设置数据，而 GPU 当前正在使用该纹理来渲染旧帧，则它必须完成所有渲染才能接受新的纹理数据。所以它会等待，扼杀你的表现。

解决方法可能是在双（甚至三重或四重）缓冲区排列中使用多个纹理。不要尝试写入刚刚用于渲染的纹理。

此外 - 您可以从渲染线程以外的线程写入纹理。这可能会派上用场，特别是对于清除纹理。

正如您似乎已经发现的那样，`SetData`大块调用实际上更快，而不是发出许多小`SetData`调用。确定“块”的理想大小在 GPU 之间有所不同 - 但它比单个像素大一点。

此外，在原始性能方面，创建纹理比重用纹理要慢得多（如果您忽略我刚刚描述的管道效果）；所以重用那个纹理。

值得一提的是，“像素精灵”需要向 GPU 发送的每像素数据量可能是纹理的 30 倍。

另请参阅[this answer](https://gamedev.stackexchange.com/a/37794/288)，如果您想更深入，它有更多细节和一些深入的链接。

# css - 调整大小 自动基于文本？

> ID：16047491
> 
> 赞同：14
> 
> 时间：2013-04-16T21:32:06.780
> 
> 标签：css, html, width, autosize

我有以下 JS Fiddle 来演示我要完成的工作：http: [//jsfiddle.net/sVKU8/2/](http://jsfiddle.net/sVKU8/2/)

1）我假设这第一部分很容易 - 有没有办法更新父`label`类以`width`根据两个孩子的总宽度自动设置它，`<div>`所以边框只环绕绿色和红色`<div>`s？我认为设置`width: auto`应该这样做，但我的 CSS 技能显然缺乏。

2）我接下来想要完成的是`width`从我的`label-text`类中删除属性并设置宽度（或自动增长，如果可能的话），只要我`<div>`通过 JavaScript 将文本应用于该属性而不进行文本换行（即保持原始高度类`label`）。

我不确定是否需要尝试根据实际文本计算宽度，或者是否有办法仅应用具有允许其增长的宽度设置的文本。

任何意见或建议将不胜感激！

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-04-16T21:35:52.937

将此属性添加到您的 css ：

```
 .based-on-text{
   display: inline-block;
 } 
```

这样， div 将像一个块一样，但将具有它需要的宽度，而不是占用整个父级宽度！

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-04-16T22:17:46.457

[单击此处](http://jsfiddle.net/sVKU8/14/)`floating elements`使用传统方法的 CSS 替代方案，无需额外的 JS

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-16T21:47:31.307

这个小提琴[（点击这里）](http://jsfiddle.net/sVKU8/3/)显示了使用`inline-block`div`text-label`和一个小 JS 来设置带边框的外框的宽度。

这是javascript。很难看。可能有更好的方法：

```
$(".label").css("width", 
    parseFloat( $(".label-image").css("width")) 
    + parseFloat( $(".label-text").css("width"))
); 
```

# php - jQuery插件不起作用

> ID：16047504
> 
> 赞同：1
> 
> 时间：2013-04-16T21:32:37.860
> 
> 标签：php, jquery

我对 jQuery 很陌生。我正在尝试使用一个名为 Searchable Dropdown 的插件，我从这里获得：http: [//jsearchdropdown.sourceforge.net/](http://jsearchdropdown.sourceforge.net/) 。但我不知道如何使它工作..我做错了什么？

```
<head>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js" ></script>
<script src="scripts/jquery.searchabledropdown-1.0.8.min.js" type="text/javascript"></script>
<script>

    $(document).ready(function() {
        $("select").searchable();
    });
</script>

</head>

<?php
echo "<form method='post' action='' id='employeesselection'>
  <select    name='select_employee' id='select_employee'>";
       while($row=mysql_fetch_array($employees)){
            $selected = ($row['Id'] == $_POST['select_employee'])?'selected="selected"':'';
    echo '<option '.$selected.' value="'.$row['Id'].'">'.$row['Etunimi'].' - '. $row['Sukunimi'].'</option>';

}
   echo "</select></form>"; 
```

选择工作正常，但在选择中搜索 jQuery 应该启用，不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T12:34:56.977

也试着给你的代码一些语义：

```
<?php 

// DATABASE CONNECTION
// DATABASE QUERY

 ?>
<html lang="en">
<head>

<!-- CSS -->

</head>

<body>
    <form action="" method="post" id="employeesselection">
        <select name="select_employee" id="select_employee">
            <?php while ( $row = mysql_fetch_array( $employees ) ) {
                $selected = ( $row['id'] == $_POST['select_employee'] ) ? ' selected ' : '';
            ?>      
                <option <?php echo $selected ?> value="<?php echo $row['id'] ?>">
                    <?php echo $row['etunimi'] ?> - <?php echo $row['sukunimi'] ?>
                </option>
            <?php } ?>
        </select>
    </form>

<!-- All Javascript down here -->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js" ></script>
<script src="scripts/jquery.searchabledropdown-1.0.8.min.js" type="text/javascript"></script>

<script>
    $(document).ready(function() {
            $("select").searchable();
    });
</script>
</body>
</html> 
```

也许错误不在您的javascript中，而是在php中...

祝调试顺利！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-30T13:50:34.673

我相信它与 Jquery 1.9.1 有关。

代替

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js" ></script> 
```

和

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script> 
```

# amazon-web-services - AWS 请求身份验证：编码标头

> ID：16047506
> 
> 赞同：5
> 
> 时间：2013-04-16T21:32:44.690
> 
> 标签：amazon-web-services, go, amazon-route53

我在 Google Go 语言中实现 AWS 请求身份验证

```
package main

import "fmt"
import "crypto/hmac"
import "crypto/sha256"
import "time"
import "encoding/base64"

func main() {
  AWSAccessKeyId := "MHAPUBLICKEY"
  AWSSecretKeyId := "MHAPRIVATEKEY"
  sha256         := sha256.New
  time           := time.Now().UTC().Format(time.ANSIC)
  hash           := hmac.New(sha256, []byte(AWSSecretKeyId))
  hash.Write([]byte(time))
  sha            := base64.URLEncoding.EncodeToString(hash.Sum(nil))

  fmt.Println("Date", time)
  fmt.Println("Content-Type","text/xml; charset=UTF-8")
  fmt.Println("AWS3-HTTPS AWSAccessKeyId=" + AWSAccessKeyId + ",Algorithm=HmacSHA256,Signature=" + sha)
} 
```

我从 Amazon 获得有效输出，但仅当“sha”哈希不包含任何 _ 或 -

在职的

> 'WFKzWNQlZEyTC9JFGFyqdf8AYj54aBj5btxPIaGTDbM='

不工作 HTTP/1.1 403 Forbidden SignatureDoesNotMatch

> 'h-FIs7of_CJ7LusAoQPzSWVt9hlXF_5gCQgedn_85lk='

如何对 AWS3-HTTPS 标头进行编码，使其在任何一种情况下都能正常工作？以防万一它是相关的，我目前正在将输出复制并粘贴到 cURL 中。一旦我让它可靠地工作，我计划在 Google Go 中实施该请求。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-22T21:40:10.933

I turned out I needed to change from URLEncoding to StdEncoding

```
sha = base64.URLEncoding.EncodeToString(hash.Sum(nil)) 
```

to

```
sha = base64.StdEncoding.EncodeToString(hash.Sum(nil)) 
```

# python - startswith() 在我的字符串前面找不到'//'

> ID：16047508
> 
> 赞同：0
> 
> 时间：2013-04-16T21:33:01.267
> 
> 标签：python, python-2.7

我有一个非常简单的 python 脚本，它读入一个文件，并逐行解析它。

它似乎无法识别我行首的“//”。如果我将其更改为在行首查找“#”，它也找不到这些行。我只是误解了这一点吗？

```
line = fIn.readline()

while line:
    print "line is", line
    line = line.strip()
    if line.startswith('//'):
        print "winner"
    line = fIn.readline() 
```

我正在阅读的文件如下所示：

```
// Feedback
"Feedback" = "Feedback";

// New strings
"File URL not reachable." = "File URL not reachable."; 
```

打印出来的调试行看起来很合适：

```
line is // Feedback

line is "Feedback" = "Feedback";

line is 

line is // New strings

line is "File URL not reachable." = "File URL not reachable.";

line is 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T21:40:47.610

更好的版本：

```
with open("abc") as f:
    for line in f:
        line=line.strip()
        if line and line.startswith("//"):
            print "line is",line
            print "winner"
            print next(f)
   ....: 
```

**输出：**

```
line is // Feedback
winner
"Feedback" = "Feedback";

line is // New strings
winner
"File URL not reachable." = "File URL not reachable."; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T21:38:13.067

您只阅读文本文件的一行。除了你在最后一行有错误的缩进之外，它似乎有效。在确保`line = fIn.readline()`每次迭代都执行之后尝试运行您的程序（将其向左移动一个块）。

这是修复那条线后得到的结果，这是所需的输出吗？

```
line is // Feedback

winner
line is "Feedback" = "Feedback";

line is  

line is // New strings

winner
line is "File URL not reachable." = "File URL not reachable."; 
```

编辑：这对你有用吗？

```
for line in open("yourfile.txt").readlines():
    print "line is", line
    line = line.strip()
    if line.startswith('//'):
        print "winner" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T21:41:44.380

尝试这个

```
for line in fIn:
    print "line is", line
    line = line.strip()
    if line[0:2]=='//':
        print "winner"
        line = fIn.readline() 
```

# mysql - MySQL查询返回null

> ID：16047510
> 
> 赞同：0
> 
> 时间：2013-04-16T21:33:15.103
> 
> 标签：mysql

```
select sum(c.cost)
from (select x.num as x, y.num as y, max(priority) as maxpriority
      from numbers x cross join
           numbers y join
           costs c
           on x.num between c.x and c.x + c.deltax and y.num between c.y and c.y + c.deltay
      where x.num between PIXELX and PIXELX and DELTAX and
            y.num between PIXELY and PIXELY and DELTAY
      group by x.num, y.num
    ) xyp join
    costs c
    on xyp.x between c.x and c.x + c.deltax and xyp.y between c.y + c.deltay and
        xyp.maxpriority = c.priority 
```

我正在尝试获取 2d 中选定区域的“成本”，该区域由不同的区域大小填充，不同的成本按优先级相互重叠。（如果一个区域低于另一个区域，则忽略它）

这是数字：

```
Collation   Attributes  Null    Default Extra   Action
     1  num int(11)         No  None          Change      Drop    Browse distinct values     More 
```

这是费用：

```
#   Name    Type    Collation   Attributes  Null    Default Extra   Action
 1  x   int(11)         No  None          Change      Drop    Browse distinct values     More
 2  y   int(11)         No  None          Change      Drop    Browse distinct values     More
 3  deltax  int(11)         No  None          Change      Drop    Browse distinct values     More
 4  deltay  int(11)         No  None          Change      Drop    Browse distinct values     More
 5  priority    int(11)         No  None          Change      Drop    Browse distinct values     More 
```

我错过了什么？代码可能充满了错误。

# jquery - 将子模板附加到当前模板中的特定 div ：Backbone

> ID：16047515
> 
> 赞同：4
> 
> 时间：2013-04-16T21:33:36.220
> 
> 标签：jquery, backbone.js, underscore.js

我有一个主干视图和一个子视图，每个视图都有自己的模板。我想附加子视图，但在当前视图内的特定 div 中。

这些是我的视图和子视图模板：

```
<script type="text/template" id="containerTmpl">
  <div id="container">
      <div id="inner-container">
      </div>  
  </div>
</script>

<script type="text/template" id="photoTmpl">
    <img src="<?- url ?>" alt="" />
</script> 
```

我想要做的是当我将 photoTmpl 附加到 containertmpl 时，我想将它附加到内部容器中。当我说时，目前处于主干视图

```
this.$el.append(view.render().el); 
```

它清空容器 div 内容并将其替换为 photoTmpl div。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T21:40:29.530

从元素中获取内部容器，并在其中渲染子视图：

```
this.$('#inner-container').append(view.render().el); 
```

# php - CodeIgniter 路由的特殊情况

> ID：16047517
> 
> 赞同：0
> 
> 时间：2013-04-16T21:33:43.517
> 
> 标签：php, codeigniter

所以我有一个主要是静态的网站。我的默认控制器在其操作中处理大多数视图`index`，只需将其`$this->uri->segment(1)`传递给我的模板。

```
$route['default_controller'] = 'master';
$route['(:any)'] = 'master';
$route['404_override'] = ''; 
```

但是现在我正在实现一个新的控制器，我希望它具有默认行为。而且我不想为每一个动作都用多余的路线玷污我的路线配置。那么我怎么说呢，将任何东西路由到默认`master`控制器，除了`NewController`，你应该正常处理。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T22:55:08.637

使用`404_override`路由位置来处理您的通配符页面。这样您就不需要定义您创建的每个现有控制器/方法。

只需确保`404_override`控制器/方法正确输出 HTTP 404 标头以及浏览器的任何适当输出即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T21:43:15.853

不完全确定您的意思，但如果我理解正确，如果您添加该行

```
$route['NewController'] = 'NewController'; 
```

在 (:any) 路由之前，它应该首先加载它。

```
$route['default_controller'] = 'master';
$route['NewController'] = 'NewController';
$route['(:any)'] = 'master';
$route['404_override'] = ''; 
```

# java - 如何创建组合框 actionListener？

> ID：16047518
> 
> 赞同：0
> 
> 时间：2013-04-16T21:33:46.397
> 
> 标签：java, jcombobox

如何创建组合框动作侦听器？到目前为止，我有以下内容：

```
myCombo = new JComboBox();
myCombo.addActionListener(); 
```

我不确定如何继续，它似乎与用于按钮的不同。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T21:46:52.930

我不确定你的问题出在哪里。但是我有这个伪代码，它可以帮助你理解 Jcombobox 上的 actionlistner

```
import javax.swing.*;
import java.awt.event.*;
import java.awt.*;

public class ChangeJlableByJComboBox extends JFrame {

    private static final long serialVersionUID = 1L;

    public ChangeJlableByJComboBox() {
        super("TooltipInSwing");
        setSize(400, 300);
        getContentPane().setLayout(new FlowLayout());
        final JLabel b1;
        final JComboBox jb1 = new JComboBox(new String[] { " ", "one", "two",
                "three" });

        b1 = new JLabel("Default Lable");
        getContentPane().add(b1);
        getContentPane().add(jb1);

        jb1.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {
                // setting custom text to JLabel
                if (jb1.getSelectedItem().toString().equals("one"))
                    b1.setText("Lable one ---");
                else if (jb1.getSelectedItem().toString().equals("two"))
                    b1.setText("Lable two ---");
                else if (jb1.getSelectedItem().toString().equals("three"))
                    b1.setText("Lable three ---");
                else
                    b1.setText("----");

                // or Compact version for setting JcomboBox selected item 
                // to JLabel text

                // b1.setText(jb1.getSelectedItem().toString());
                System.out.println(jb1.getSelectedItem().toString());
                // you can also make use of following method
                System.out.println(jb1.getSelectedIndex());
            }
        });

        setDefaultCloseOperation(DISPOSE_ON_CLOSE);
        setVisible(true);
    }

    public static void main(String args[]) {
        new ChangeJlableByJComboBox();
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T21:40:02.443

它应该是相同的，只需使用 getSelectedValue 获取框中的值

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-16T21:42:36.740

尝试这个：

```
 myCombo.addActionListener(new actionListener() {
   public void actionPerformed(ActionEvent eventSource) {
   JComboBox combo = (JComboBox) myCombo.getSource();
   Object selected = combo.getSelectedItem();
   if("whatever...") {

}
}
}
); 
```

# r - 有没有一种快速的方法来获取数据框中列的各种“箱”的平均值？

> ID：16047520
> 
> 赞同：0
> 
> 时间：2013-04-16T21:33:52.677
> 
> 标签：r

如果这已得到回答，我深表歉意 - 我只是找不到它！为简化起见，我有一个包含 2 个相关列的汽车数据框：里程和价格。我想计算 0-20,000 英里、20,000-40,000 英里等的平均价格和汽车数量（以 20,000 英里“箱子”为单位）。我一直在为各种里程范围制作数据子集，然后查看该子集的平均值和数量或车辆。我想知道是否有更有效的方法来做到这一点，而不是制作所有这些子集——我用各种“箱”和数据做了很多次。我很想学习一种更巧妙的方法。

谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T21:45:37.063

你可能想要沿着这些思路：

```
library(data.table)
d = data.table(mileage = runif(1000, 0, 100000), price = runif(1000, 15000, 35000))

d[, list(price = mean(price), number = .N),
    by = cut(mileage, c(0, 20000, 25000, 30000, 100000))][order(cut)]
#                cut    price number
# 1:       (0,2e+04] 25252.70    215
# 2: (2e+04,2.5e+04] 25497.66     46
# 3: (2.5e+04,3e+04] 25349.79     45
# 4:   (3e+04,1e+05] 25037.93    694 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T21:57:55.003

这显示了如何使用聚合在一次运行中按类别返回多个统计信息。

```
 # Using Quentin's data
 d[['mileage.cat']] <- cut(d$mileage, breaks=seq(0, 200000, by= 20000))
 aggregate(d$price, d['mileage.cat'] , 
                 FUN=function(price) c(counts=length(price),
                                         mean.price=mean(price) ) )

    mileage.cat x.counts x.mean.price
1     (0,2e+04]   212.00     24859.01
2 (2e+04,4e+04]   194.00     24343.16
3 (4e+04,6e+04]   196.00     24357.73
4 (6e+04,8e+04]   191.00     25006.71
5 (8e+04,1e+05]   207.00     25250.23 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T21:53:52.517

要制作垃圾箱，请“切”。例子：

```
x=1:10
bkpt=c(0,2.5,7.5,10)
x.cut=cut(x,breaks=bkpt) 
```

就这样结束了。y 是以后的一些数据：

```
y=21:30
data.frame(x,x.cut,y) 
```

要为每个组计算一些东西，请使用 tapply。按照我的例子：

```
tapply(y,x.cut,length)
tapply(y,x.cut,mean) 
```

它计算 (a) y 的数量和 (b) x.cut 定义的每个组中 y 的平均值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-16T21:54:15.550

另一种使用聚合的方法：

```
df <- data.frame(mil = sample(1e5,20),price = sample(1000,20) )
#mil2 is our "mile bin" ( 0 -> [0:20000[; 1 -> [20000:40000[ ...)
df$mil2 = trunc(df$mil /20000)

# then to get the mean by "mile bin":
aggregate(price ~ mil2,df,mean)
# or the number:
aggregate(price ~ mil2,df,length)
# or simply:
table(df$mil2) 
```

# c - 使 vim 缩进 C 预处理器指令与其他语句相同

> ID：16047521
> 
> 赞同：21
> 
> 时间：2013-04-16T21:33:53.447
> 
> 标签：c, vim, indentation, preprocessor-directive

# 基本信息

（注意：请通读本文，因为我花了一些时间整理它，确保我解决了我遇到的每一个问题以及为什么一个建议的解决方案对我不起作用。）

我在 vim 中使用 cindent 自动进行缩进。它大部分时间都很好用。然而，cindent 做了三*件坏事*（在我看来）涉及 C 预处理器指令（以哈希 ('#') 开头的语句）。

如果它是相关的，我使用制表符进行缩进，我的 .vimrc 包含`filetype indent on`.

### 坏事 1

一旦我输入一个预处理器指令，vim 就会把它放在第 1 列（它完全取消缩进）。例如，当我键入**代码时，vim 会对我的代码执行以下操作：**

```
int main(void)
{
    while(1) {
        /* normal things */
#ifdef DEBUG
        printDebugInfo();
#endif
        /* normal things */
    }
} 
```

但是，**我希望它看起来像这样**：

```
int main(void)
{
    while(1) {
        /* normal things */
        #ifdef DEBUG
        printDebugInfo();
        #endif
        /* normal things */
    }
} 
```

换句话说，我更喜欢 vim 像对待任何其他 C/C++ 语句一样对待预处理器指令。

### 坏事 2

当我在带有预处理器指令的行`==`上（或跨行）使用时， **vim 将其放回第 1 列**。（这与坏事 1 一致，但仍然是一个问题。）`[movement]=`

 **### 坏事 3

如果（由于 Bad Thing 1 或 2 或使用`<<`）预处理器指令最终出现在第 1 列中，**它就会“卡在”那里**并且不受`>>`. 增加缩进的唯一方法是`I<Tab>`或`i<Ctrl-t>`。然后它变得“不卡住”，我可以用`<<`or移动它`>>`。

# 失败的解决方案

[一种解决方案](http://vim.wikia.com/wiki/Restoring_indent_after_typing_hash#Adjusting_cinkeys_or_indentkeys)建议放入`set cinkeys-=0#`我的`.vimrc`. 这**修复**了Bad Things 1 - 3，**但添加了一个新的**：

### 坏事 4（仅限`cinkeys-=0#`）

*第 1 列*中的预处理器指令不受`==`or影响`[movement]=`，这意味着我仍然无法自动修复它们的缩进，直到我使用`>>`或插入制表符手动缩进它们。

# 问题

**有没有办法在不引入坏事 4 的情况下解决坏事 1-3？**我可以强制 vim 像普通 C 语句一样处理以 '#' 开头的行吗？

（或者我只是`#ifdef`以有害的方式使用 s，这是 vim 告诉我停止的方式？）

我不想修补 vim 和/或重新编译，但如果我必须这样做的话。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-17T01:25:50.830

来自[Vim 文档](http://vimdoc.sourceforge.net/htmldoc/indent.html)，在 cinoptions 下：

> 如果出现以下情况，Vim 会在第 1 列放置一行：
> 
> *   如果“cinkeys”包含“#”，则它以“#”（预处理器指令）开头。
> *   它以标签开头（关键字后跟“：”，“case”和“default”除外）并且“cinoptions”不包含具有正值的“L”条目。
> *   缩进的任何组合都会导致行的缩进小于 0。

因此，删除`0#`from`cinkeys`应该覆盖该默认行为。（这个想法出现在[互联网上](https://www.google.ca/#output=search&q=%270%23%27+should+not+be+in+%27cinkeys%27&oq=%270%23%27+should+not+be+in+%27cinkeys%27&fp=1)足够多的地方。）

```
set cinkeys=0{,0},0),:,!^F,o,O,e 
```

随着对 cinkeys 的更改，这就是我得到的，正是您正在寻找的：

```
int main(void)
{
    while(1) {
        /* normal things */
        #ifdef DEBUG
        printDebugInfo();
        #endif
        /* normal things */
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-08-22T14:34:03.060

### 坏事的解决方案 4

```
set cinoptions+=#1s 
```

如果使用`==`or ，这将缩进 1 shiftwidth `[movement]=`。将它与选项结合起来`cinkeys-=0#`对我有用。**

# ruby-on-rails - 在 form_for、rails 中传递 collection_selection 和 text_field 值

> ID：16047524
> 
> 赞同：0
> 
> 时间：2013-04-16T21:34:01.413
> 
> 标签：ruby-on-rails, forms, collections, form-for

Attraction 模型属于 Destination。

我正在尝试创建一个新的景点（text_field :name），但也将它链接到一个已经创建的目的地。这些目的地在带有此 collection_select 标记的下拉菜单中呈现。通过单击提交，我希望使用 Destinations 外键创建吸引力并将其保存在 activerecord 数据库中。

f.collection_select(:attraction, :destination_id, Destination.all, :id, :name) %>

整个区块现在看起来像这样：

```
<h1>New attraction</h1> 
```

## 选择城市

```
<%= f.collection_select(:attraction, :destination_id, Destination.all, :id, :name) %>   

<div class ="field">
  <%= f.label :name %>
  <%= f.text_field :name %>
</div>

<div class="actions">
  <%= f.submit %>
</div> 
```

如何使用适当的目的地将景点保存到数据库中？提前致谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T02:23:36.427

我没有使用`f.collection_select()`，所以不确定它在参数中被称为什么，但让我们假设下面的代码它是`params[:attraction][:destination_id]`. 您可以将创建操作更改为：

```
def create
  @destination = Destination.find(params[:attraction][:destination_id])
  @attraction = @destination.attractions.build(params[:attraction])
  if @attraction.save
    ...
  else
    ...
  end
end 
```

假设您已经创建了一个`has_many`and`belongs_to`关联。

如果遇到批量分配错误，请将第一行更改为：

```
@destination = Destination.find(params[:attraction].delete(:destination_id))
# this will return the deleted value, and in the next line of code
# you'll have the rest of the params still available 
```

# python - 优化搜索以在列表中查找下一个匹配值

> ID：16047526
> 
> 赞同：1
> 
> 时间：2013-04-16T21:34:25.273
> 
> 标签：python, bigdata

我有一个程序遍历一个列表，并为每个对象找到下一个具有匹配值的实例。当它打印出每个对象的位置时。该程序运行得非常好，但我遇到的问题是，当我使用大量数据（列表中约 6,000,000 个对象）运行它时，它会花费很长时间。如果有人可以提供有关我如何使流程更高效的见解，我将不胜感激。

```
def search(list):
    original = list
    matchedvalues = []
    count = 0
    for x in original:
        targetValue = x.getValue()
        count = count + 1
        copy = original[count:]
        for y in copy:
             if (targetValue == y.getValue):
                 print (str(x.getLocation) + (,) + str(y.getLocation))
                 break 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T21:46:34.323

也许您可以制作一个字典，其中包含与每个项目对应的索引列表，如下所示：

```
values = [1,2,3,1,2,3,4]

from collections import defaultdict

def get_matches(x):
    my_dict = defaultdict(list)
    for ind, ele in enumerate(x):
        my_dict[ele].append(ind)
    return my_dict 
```

结果：

```
>>> get_matches(values)
defaultdict(<type 'list'>, {1: [0, 3], 2: [1, 4], 3: [2, 5], 4: [6]}) 
```

编辑：

我添加了这部分，以防它有帮助：

```
values = [1,1,1,1,2,2,3,4,5,3]

def get_next_item_ind(x, ind):
    my_dict = get_matches(x)
    indexes = my_dict[x[ind]]
    temp_ind = indexes.index(ind)
    if len(indexes) > temp_ind + 1:
        return(indexes)[temp_ind + 1]
    return None 
```

结果：

```
>>> get_next_item_ind(values, 0)
1
>>> get_next_item_ind(values, 1)
2
>>> get_next_item_ind(values, 2)
3
>>> get_next_item_ind(values, 3)
>>> get_next_item_ind(values, 4)
5
>>> get_next_item_ind(values, 5)
>>> get_next_item_ind(values, 6)
9
>>> get_next_item_ind(values, 7)
>>> get_next_item_ind(values, 8) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T22:33:02.803

有几种方法可以通过最小化额外的内存使用来提高搜索的效率（特别是当您的数据很大时）。

*   可以直接对传入的列表进行操作，不需要复制，这样就不需要: `original = list`, 或者`copy = original[count:]`
*   您可以使用原始列表的切片进行测试，并`enumerate(p)`遍历这些切片。您不需要额外的变量`count`，并且`enumerate(p)`在 Python 中很高效

重新实现，这将变为：

```
def search(p):
    # iterate over p
    for i, value in enumerate(p):

        # if value occurs more than once, print locations
        # do not re-test values that have already been tested (if value not in p[:i])
        if value not in p[:i] and value in p[(i + 1):]:
            print(e, ':', i, p[(i + 1):].index(e))

v = [1,2,3,1,2,3,4]

search(v)

1 : 0 2
2 : 1 2
3 : 2 2 
```

以这种方式实现它只会打印出重复值的值/位置（我认为这是您在原始实现中的意图）。

其他注意事项：

*   *超过 2 次出现的值：* 如果值在列表中重复多次，那么您可能希望实现一个函数以递归方式遍历列表。事实上，这个问题并没有解决这个问题 - 在你的情况下它可能不需要。

*   *使用字典：*我完全同意上面的 Akavall，字典是在 Python 中查找值的好方法 - 特别是如果您需要稍后在程序中再次查找值。如果您在最初创建列表时构建字典而不是列表，这将最有效。但是，如果您只这样做一次，那么构建字典和查询字典将花费您更多的时间，而不是像上面描述的那样简单地遍历列表。

希望这可以帮助！

# hibernate - GORM 组合 - 具有多对一关系的嵌入式域抛出 org.hibernate.MappingException

> ID：16047527
> 
> 赞同：6
> 
> 时间：2013-04-16T21:34:28.293
> 
> 标签：hibernate, grails, grails-orm

我正在尝试在 Grails 2.2.1 中使用具有多对一关系的嵌入式域。这是我正在尝试做的简化版本。

我正在映射到现有的数据库表：

```
create table incident (id bigint generated by default as identity, state_id bigint not null, primary key (id));
create table state (id bigint generated by default as identity, name varchar(255) not null, primary key (id));
alter table incident add constraint FK52F44D27499E79E foreign key (state_id) references state; 
```

映射到“事件”表的域：

```
class Incident {
    Vehicle vehicle
    static embedded = ['vehicle']
}

class Vehicle{
    State state
    static mapping = {
        state column: 'state_id'
    }   
} 
```

映射到“状态”表的域：

```
class State {
    String name 
} 
```

当我尝试运行我的应用程序时，我收到以下错误：

> 消息：创建名为“transactionManagerPostProcessor”的 bean 时出错：bean 初始化失败；嵌套异常是 org.springframework.beans.factory.BeanCreationException：创建名为“transactionManager”的 bean 时出错：设置 bean 属性“sessionFactory”时无法解析对 bean“sessionFactory”的引用；嵌套异常是 org.springframework.beans.factory.BeanCreationException：创建名为“sessionFactory”的 bean 时出错：调用 init 方法失败；嵌套异常是**org.hibernate.MappingException：无法确定类型：test.State，在表：事件，列：[org.hibernate.mapping.Column(vehicle_state)]**

是否可以在嵌入式域中建立多对一关联？

--**更新**--

我最终使用了一种解决方法来获取状态。

```
class Vehicle{

    static transients = [ "state" ]

    Long stateId

    static mapping = {
        stateId column: 'state_id'  
    }

    State getState(){
        State.get(this.stateId)
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T15:01:46.407

从 Grails 2.2.1 开始，嵌入式域类存在一些可用性问题，使其难以使用，尤其是在遗留数据库中。

1.  关系不起作用
2.  自定义列映射不起作用

您最好直接在所属类中映射列，然后创建一个辅助方法来处理嵌入的实体。

例如：

```
// grails-app/domain/yourpkg/Incident.groovy
class Incident {
    State state

    public Vehicle getVehicleData() {
        return new Vehicle(state: state)
    }

    public void updateWithVehicle(Vehicle vehicle) {
        state = vehicle.state
    }

    static mapping = {
        state column: 'state_id'
    }
}

// src/groovy/yourpkg/Vehicle.groovy
class Vehicle {
    State state
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T22:28:32.750

在这种情况下，域必须是`serialized`（包括嵌入`Vehicle`的，如果移动到，则不会成为持久性的一部分`src/groovy`）并`equals()` `hashCode()`为类生成。老派，但效果很好，应用程序运行正常。

**Incedent.groovy**

```
import groovy.transform.EqualsAndHashCode

@EqualsAndHashCode
class Incedent implements Serializable{
    Vehicle vehicle
    static embedded = ['vehicle']

    class Vehicle{
        State state
    }
} 
```

**状态.groovy**

```
import groovy.transform.EqualsAndHashCode

@EqualsAndHashCode
class State implements Serializable {
    String name
} 
```

按照上述内容，您将获得`Incedent`一个数据类型为 VARBINARY 的嵌入列（在内存 H2 db 中进行测试时）。我更喜欢将其`stateName`作为字符串`Vehicle`

![在此处输入图像描述](https://i.stack.imgur.com/Qxn9V.png)

# google-app-engine - 在 Google App Engine 上的轨道上上传 Jruby - 找不到 gem appengine-rack

> ID：16047542
> 
> 赞同：1
> 
> 时间：2013-04-16T21:35:41.353
> 
> 标签：google-app-engine, gem, jrubyonrails

只是试图在 Google App Engine 上部署一个简单的 Jruby on rails 应用程序，但一开始遇到了障碍。我一直在遵循[https://code.google.com/p/appengine-jruby/](https://code.google.com/p/appengine-jruby/)和其他一些网站上的说明。我已按照说明安装了 gem 'google-appengine'，命令提示符告诉我它已安装。

当我开始在 config.ru 中输入*require 'appengine-rack'*时，我可以看到我的 IDE 告诉我它无法识别此文件。无论如何，我还是启动了本地服务器作为测试，它告诉我“LoadError：没有要加载的文件--appengine-rack”。

我可以清楚地看到 C:\jruby-1.7.3\lib\ruby\gems\shared\gems\appengine-rack-0.0.13\lib\ 。所以我有点难过。当我运行 >gem list 时，我还可以看到这个 gem 在那里。

我是第一次这样做。

我使用的是 Windows 7。Jruby 版本 1.7.3。导轨 3.2.1。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T23:52:45.803

看起来您尝试使用的[项目](https://code.google.com/p/appengine-jruby/)相当旧，（最后提交日期是日期：2011 年 3 月 30 日）。那里写着他们只计划支持 3.x 版本。

无论如何，这是您问题的答案（也很旧） [无法让 google-appengine 让 Jruby 工作](https://stackoverflow.com/questions/8228735/unable-to-get-google-appengine-for-jruby-to-work)

这个搜索可能会有所帮助[https://stackoverflow.com/questions/tagged/google-app-engine+ruby](https://stackoverflow.com/questions/tagged/google-app-engine+ruby)

从理性的角度来看，将这些宝石用于生产并不是一个好主意。如果您需要为您的 ruby​​ procejct 提供云托管，[heroku](http://www.heroku.com/)将是一个解决方案。如果您需要 appengine - 您最好使用官方支持的 Java、Python 或 Go。

# ios - 使用 Storyboards Segues

> ID：16047543
> 
> 赞同：-1
> 
> 时间：2013-04-16T21:35:46.327
> 
> 标签：ios, memory-management, uistoryboard

我有一个关于如何在 Xcode 中将 segues 与 Storyboard 一起使用的问题。我有一个具有 3 个视图的应用程序，我将使用动画模式“交叉溶解”加载它们。

每次我加载一个新视图而不关闭当前视图时，它仍然占用内存吗？我意识到在更改多个视图后，我的应用程序变慢了。

如果是，如何按顺序更改视图的正确方法？

![在此处输入图像描述](https://i.stack.imgur.com/skdi8.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T22:53:09.670

当你从 3 回到 1 时，你应该使用 unwind segue。这将导致 3 和 2 被释放（如果您没有保留指向它们的强指针），并且您实际上将返回到 1 的同一个实例（而不是创建一个新实例）。一般来说，你不应该使用 unwind segue 以外的 segue 倒退。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T22:11:31.720

与其在情节提要中指定“回到 1”segue，不如使用 方法在代码中实例化它`-initWithIdentifier:source:destination:`。这将允许您将目标指定为您的第一个视图控制器，而不是创建要转换到的新视图控制器。

事实上，如果您不想在每次切换时都实例化新副本，您可能应该以编程方式指定这些视图控制器之间的所有转场。

# java - 为什么原始类型没有番石榴 Objects.equal(Object, Object) ？

> ID：16047547
> 
> 赞同：5
> 
> 时间：2013-04-16T21:35:54.817
> 
> 标签：java, performance, guava

为什么每个原始类型都没有[`Objects.equal`](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/base/Objects.html#equal%28java.lang.Object,%20java.lang.Object%29)接收作为参数？

我知道您可以通过将值装箱`#valueOf`或让每个原语自动装箱，但是这样做不会失去性能吗？这是我一直想知道的事情。

想象一下我有类似的东西

```
public class Foo {
    private final int integerValue;
    private final boolean booleanValue;
    private final Bar bar;

    public Foo(int integerValue, boolean booleanValue, Bar bar) {
        this.integerValue = integerValue;
        this.booleanValue = booleanValue;
        this.bar = bar;
    }

    @SuppressWarnings("boxing")
    @Override
    public boolean equals(Object object) {
        if (object instanceof Foo) {
            Foo that = (Foo) object;

            return Objects.equal(this.integerValue, that.integerValue)
                     && Objects.equal(this.booleanValue, that.booleanValue)
                     && Objects.equal(this.bar, that.bar);
        }
        return false;
    }

    // hashCode implementation using guava also.
} 
```

这是最好的实施方式`equals`吗？原始值将被自动装箱，遭受（即使是一点点）性能下降。我可以只`==`为它们使用，但对我来说，它会打破阅读 equals 方法的“流程”，使它有点难看。所以我想知道为什么 guava lib 没有`Objects.equal`每个原始类型。有人知道答案吗？

**编辑**

每个原语（但字节）都有[MoreObjects.toStringHelper](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/base/Objects.ToStringHelper.html)重载，这就是我想知道没有 for 的原因之一`Objects#equal`。此外，使用[JB Nizet](https://stackoverflow.com/users/571407/jb-nizet)参数，它会使`equals`方法更安全，因为您可以更改`int`for`Integer`而不必担心相等的正确性。

[番石榴文档](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/base/Objects.html#equal%28java.lang.Object,%20java.lang.Object%29)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-16T21:46:06.053

> 我可以只`==`为它们使用，但对我来说，它会打破阅读 equals 方法的“流程”，使它有点难看。

这不是为每个原始类型添​​加该方法的重载到 Guava API 的一个足够令人信服的理由——API 公开的每个方法都必须记录、测试和维护。当唯一的优势是美学时，这没有任何意义。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T02:36:23.713

> 我知道您可以通过#valueOf 将值装箱或让每个原语自动装箱，但这样做不会失去性能吗？

没错，但是对于性能敏感的代码，您肯定希望`==`无论如何都想使用来获取简单的`if_icmpeq`操作码，而不是调用方法。因此，如果您正在使用`Objects.equal`，您可能不会编写性能敏感的代码，并且可能不会注意到自动装箱的成本。

我并不是说原始版本的`Objects.equal`收益为零，但可能不值得向库中添加几种方法。

# ios5 - 将串行字符作为命令读取并执行某些操作的 Arduino 草图

> ID：16047552
> 
> 赞同：0
> 
> 时间：2013-04-16T21:36:20.583
> 
> 标签：ios5, arduino, xcode4.5

目前我正在尝试制作一个草图，其中 Arduino 将读取一系列字符作为命令，并根据从 iDevice 发送的一系列字符做一些事情。我正在使用越狱的 iPhone 3GS 向 Arduino 发送字符。发送串行字符的方法如下所示，

```
- (IBAction)blinkFlow_A_LED:(id)sender {

    // method to blink the Flow_A LED on the kegboard-mini Arduino sheild.

    NSLog(@"blink Flow_A btn pressed");

    // open serial port / interface

    [serial open:B2400];
    NSLog(@"%c", [serial isOpened]);

    // send serial data (tx)

    char buffer [7];

    buffer[0] = '{';
    buffer[1] = 'b';
    buffer[2] = 'l';
    buffer[3] = 'i';
    buffer[4] = 'n';
    buffer[5] = 'k';
    buffer[6] = '}';

    [serial write:buffer length:7];
} 
```

我创建了一个简单的草图，它使我正在使用的防护罩上的 LED 闪烁，但我希望 LED 在 iOS 应用程序中单击按钮时有条件地闪烁。闪烁 LED 的草图如下所示，

```
/*
  Blink
  Turns on an LED on for one second, then off for one second, repeatedly.
  This sketch is specific to making the kegboard-mini shield.

  http://arduino.cc/forum/index.php?topic=157625.new;topicseen#new

  This example code is in the public domain.
*/

// pin D4 - should be connected to the flow_A LED

// give it a name

int led = 4;

// the setup routine runs once when you press reset:

void setup() {
  //initialize the digital pin as an output.
  pinMode(led, OUTPUT);
}

// the loop routine run over and over again forever:

void loop() {
  digitalWrite(led, HIGH); // turn the LED on (HIGH is the voltage level)
  delay(1000);              // wait for one second
  digitalWrite(led, LOW);   // turn the LED off by making the voltage LOW
  delay(1000);              // wait for a second
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T04:03:14.407

这是一个简单的草图！

您可能想先查看 Arduino 参考页面： [http ://arduino.cc/en/Reference/Serial](http://arduino.cc/en/Reference/Serial)

在设置中，您至少需要 Serial.begin(2400);

现在，我建议读取和解码字符串 "{blink}" 似乎有点矫枉过正。让我建议你发送一个字符（例如'b'），并检测一个字符，至少开始。查看串行参考页 .available() 和 .read()。有了这些，您可以确定一个字符是否已到达 Arduino 并读取单个字符。

然后，如果您想一次构建一个字符串并将其与 String("{blink}") 进行比较，则可以使用这些。这有点复杂，特别是如果您考虑到异常（如丢失或损坏的字符）。

我很好奇——iPhone 是如何将数据输入到 Arduino 的串口中的？您可以使用串行监视器工具轻松测试您的程序——只是建议您必须点击“发送”才能使字符消失。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T16:24:21.113

我写了[一篇](http://digital-salvage.net/?p=180#more-180)关于从 Serial 中获取输入并让 arduino 做某事的博客文章。就我而言，它是打开/关闭 LED 或使其闪烁。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T20:02:52.023

如果你想用 Arduino 闪烁 LED，你肯定想看看我的 blinkenlight 博客。我[至少有一个实验，通过串行监视器控制闪烁](http://blog.blinkenlight.net/experiments/basic-effects/vu-meter/)。实际上，我对那里闪烁 LED 的主题有很多变化。

如果您需要一个更复杂的示例，我也有[一个基于有限状态机作为解析器的](http://blog.blinkenlight.net/experiments/measurements/flexible-sweep/)示例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-13T22:53:03.430

我结束了这样一个简单的草图，它允许我将一个串行字节数组存储到一个字符串中，这要归功于这个例子，[http://arduino.cc/en/Tutorial/SerialEvent](http://arduino.cc/en/Tutorial/SerialEvent)

我目前正在使用的草图如下所示，

```
/*
 * kegboard-serial-simple-blink07
 * This code is public domain
 *
 * This sketch sends a receives a multibyte String from the iPhone
 * and performs functions on it.
 *
 * Examples:
 * http://arduino.cc/en/Tutorial/SerialEvent
 * http://arduino.cc/en/Serial/read
 */

 // global variables should be identified with _

 // flow_A LED
 int led = 4;

 // relay_A
 const int RELAY_A = A0;

 // variables from sketch example
 String inputString = ""; // a string to hold incoming data
 boolean stringComplete = false; // whether the string is complete

 void setup() {

   Serial.begin(2400); // open serial port, sets data rate to 2400bps
   Serial.println("Power on test");
   inputString.reserve(200);

   pinMode(RELAY_A, OUTPUT);
}

void open_valve() {

  digitalWrite(RELAY_A, HIGH); // turn RELAY_A on

}

void close_valve() {

  digitalWrite(RELAY_A, LOW); // turn RELAY_A off
}

void flow_A_blink() {

  digitalWrite(led, HIGH); // turn the LED on (HIGH is the voltage level)
  delay(1000);              // wait for one second
  digitalWrite(led, LOW);   // turn the LED off by making the voltage LOW
  delay(1000);              // wait for a second
}

void flow_A_blink_stop() {

  digitalWrite(led, LOW);
}

void loop() {
  // print the string when newline arrives:
  if (stringComplete) {
    Serial.println(inputString);
    // clear the string:
    inputString = "";
    stringComplete = false;
  }

  if (inputString == "{blink_Flow_A}") {
    flow_A_blink();
  }
}

//SerialEvent occurs whenever a new data comes in the
//hardware serial RX.  This routine is run between each
//time loop() runs, so using delay inside loop can delay
//response.  Multiple bytes of data may be available.

void serialEvent() {
  while(Serial.available()) {
    // get the new byte:
    char inChar = (char)Serial.read();
    // add it to the inputString:
    inputString += inChar;
    // if the incoming character is a newline, set a flag
    // so the main loop can do something about it:
    if (inChar == '\n') {
      stringComplete = true;
    }
  }
} 
```

# android - Linux内存不足进程杀死了我的Android应用程序

> ID：16047554
> 
> 赞同：0
> 
> 时间：2013-04-16T21:36:22.773
> 
> 标签：android, out-of-memory

这发生在使用 Android 4.0.2 平台的自定义构建的嵌入式系统上。我看到我们的一个 android 活动应用程序增长到大约 400MB（调用“ps”时的 rss 大小）并被 Linux OOM 杀手杀死。android 平台配置为最大堆大小设置为 62M。我不知道 Dalvik VM 如何让活动增长到 400MB。

当堆达到大约 60MB 时，应用程序不应该让 Java 出现内存不足异常吗？我们在 logcat 日志或 anr 跟踪中看不到这些 Java 异常。

我们实现了一个示例活动，它按顺序分配字节数组并将每个字节设置为一个虚拟值。当活动分配大约 60MB 时，我们确实看到内存不足异常。

android中是否有不计入堆预算的分配路径？该活动呈现从网站下载的位图 png。

以下是我们平台上的“getprop”结果。

$ adb shell getprop | grep -i 堆

我很感激任何指示。

谢谢

编辑：注意：下面是 ps 输出。Pss 和 Uss 大约是 316M，远远高于。

```
                             PID Vss Rss Pss Uss cmdline
logcat: hd[0]: pexecd(65): 982 351512K 351316K 326300K 316632K mytest.home^M
logcat: hd[0]: pexecd(65): 660 679916K 61044K 57200K 56952K ./videngine^M

RAM：总共 741764K，20320K 空闲，2148K 缓冲区，80104K 缓存，24964K shmem，10368K 平板

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T21:39:38.903

本机代码中的直接分配不计入 Java 堆总数。可能还有其他可能性（可能是从文件映射和填充的页面？）。

如果你有一个自定义的 android 版本，你可以设置 OOM 杀手值来保留你自己的应用程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T22:11:30.247

> 我看到我们的一个 android 活动应用程序增长到大约 400MB（调用“ps”时的 rss 大小）

引用 Dianne Hackborn，关于`ps`Android 上的输出：“Vss 和 Rss 列基本上是噪音（这些是直接的地址空间和进程的 RAM 使用量，如果你将跨进程的 RAM 使用量相加，你会得到一个数量多得离谱）”

我衷心鼓励您阅读[她关于测量应用程序内存占用的史诗般的 SO 答案](https://stackoverflow.com/questions/2298208/how-to-discover-memory-usage-of-my-application-in-android/2299813#2299813)。值得注意的是，除了我上面引用的引用之外，Rss 在她的分析中没有任何作用。因此，我建议不要担心 Rss 并关注其他指标。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T00:08:32.350

您可以通过以下方式了解您的应用程序正在使用什么内存。

转到 DDMS，并通过单击如下所示的图标创建堆转储： ![HPROF](https://i.stack.imgur.com/nPm5m.png)

接下来使用 androir-sdk/tools 文件夹中的 hprof-conv 工具将 android 格式的 HPROF 转换为常规 HPROF 格式。

[接下来，使用Eclipse Memory Analyzer](http://www.eclipse.org/mat/) (MAT)打开堆转储，并查看支配树，在那里您将看到您的应用程序强制 Dalvik 垃圾收集器 (GC) 保留的变量列表。右键单击它们并转到“Path the GC root”和“Exclude Weak References”，将显示使这些对象保持活动状态的引用。查看是否有任何过期的引用被保留为内存泄漏。

您可以观看[此视频](https://www.youtube.com/watch?v=_CruQY55HOk)，了解在 Android 应用程序中查找内存泄漏的详细方法。

# c++ - 在 C++ 中创建动态类型

> ID：16047560
> 
> 赞同：17
> 
> 时间：2013-04-16T21:36:37.290
> 
> 标签：c++, templates, design-patterns, inheritance

我正在编写一个通用软件，它将加载到相同基本硬件的许多不同变体上。它们都具有相同的处理器，但具有不同的外围设备和它们自己需要执行的功能。软件将通过读取硬件开关值来知道它应该运行哪个变体。

简而言之，这是我当前的实现：

```
class MyBase
{
public:
    MyBase() { }
    virtual run() = 0;
}

class VariantA : public MyBase
{
public:
    VariantA () { }
    virtual run()
    {
        // Run code specific to hardware Variant-A
    }
}

class VariantB : public MyBase
{
public:
    VariantB () { }
    virtual run()
    {
        // Run code specific to hardware Variant-B
    }
}

void main()
{
    MyBase* variant;
    uint_8 switchValue = readSwitchValue();

    switch(switchValue)
    {
    case 0:
        variant = new VariantA();
        break;

    case 1:
        variant = new VariantB();
        break;
    }

    variant->run();
} 
```

现在这工作得很好。我读取了硬件值并使用 switch 语句来创建新的相应类。

问题是我必须处理很多变体。目前大约有 15 个，有可能在不久的将来再增加 20-30 个。我真的开始鄙视运行数百行的 switch 语句，所以我真的在寻找更好的方法来做到这一点，可能是通过模板。

我希望能够使用我的硬件值来查找类型并使用该类型来创建我的新对象。理想情况下，当我添加一个新变体时，我会创建新类，将该类类型添加到我的查找表中，并使用它匹配的硬件值，这样就很好了。

这可能吗？这里有什么好的解决方案？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-04-16T21:52:54.587

如前所述，您创建了一个工厂，但不一定使用幼稚的 switch 语句。您可以做的是创建一个模板类来创建相关对象并将它们动态添加到您的工厂。

```
class VariantinatorBase {
  public:
    VariantinatorBase() {}
    virtual ~VariantinatorBase() {}
    virtual std::unique_ptr<Variant> Create() = 0;
};

template< class T >
class Variantinator : public VariantinatorBase {
  public:
    Variantinator() {}
    virtual ~Variantinator() {}
    virtual std::unique_ptr<Variant> Create() { return std::make_unique<T>(); }
}; 
```

现在你有一个允许你注册这些的类工厂。

```
class VariantFactory
{
  public:
    VariantFactory()
    {
         // If you want, you can do all your Register() calls in here, and even
         // make the Register() function private.
    }

    template< uint8_t type, typename T >
    void Register()
    {
        Register( type, std::make_unique<Variantinator<T>>() );
    }

    std::unique_ptr<Variant> Create( uint8_t type )
    {
        TSwitchToVariant::iterator it = m_switchToVariant.find( type );
        if( it == m_switchToVariant.end() ) return nullptr;
        return it->second->Create();
    }

  private:
    void Register( uint8_t type, std::unique_ptr<VariantinatorBase>&& creator )
    {
        m_switchToVariant[type] = std::move(creator);
    }

    typedef std::map<uint8_t, std::unique_ptr<VariantinatorBase> > TSwitchToVariant;
    TSwitchToVariant m_switchToVariant;
}; 
```

在程序开始时，创建工厂并注册您的类型：

```
VariantFactory factory;
factory.Register<0, VariantA>();
factory.Register<1, VariantB>();
factory.Register<2, VariantC>(); 
```

稍后，您想调用它：

```
std::unique_ptr<Variant> thing = factory.Create( switchValue ); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-16T21:38:51.337

您正在寻找工厂

[http://www.oodesign.com/factory-pattern.html](http://www.oodesign.com/factory-pattern.html)

工厂是一个软件模块（一种方法、一个类），其唯一目的是为工作创建正确的对象。使用工厂类的示例：

```
class VariantFactory
{
    MyBase* CreateObject(uint_8 value);
} 
```

并且可以填写 CreateObject 方法，为您提供所需的对象类型。

在结构简单的对象非常少的情况下，一个简单的 switch 语句可能就足够了。一旦你得到很多对象或需要更详细构造的对象，工厂就非常有用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-16T21:44:20.780

我对此发表了评论；让我们把它变成一个答案：

就个人而言，我认为创建适当类的“switch/case”块可能是最佳解决方案。只需将您的 case 语句放在返回对特定类的引用的静态“工厂”方法中。恕我直言...

这是一个很好的例子：[工厂方法设计模式](https://stackoverflow.com/questions/7468104/factory-method-design-pattern)

```
Class Book : public Product
{
};

class Computer : public Product
{
};

class ProductFactory
{
public:
  virtual Product* Make(int type)
  {
    switch (type)
    {
      case 0:
        return new Book();
      case 1:
        return new Computer();
        [...]
    }
  }
}

Call it like this:

ProductFactory factory = ....;
Product* p1 = factory.Make(0); // p1 is a Book*
Product* p2 = factory.Make(1); // p2 is a Computer*
// remember to delete p1 and p2 
```

请注意，在他最出色的回应中，smink 还提出了其他一些设计替代方案。

底线：switch/case 块本身并没有什么“错误”。即使对于具有许多案例选项的开关。

恕我直言...

PS：这真的不是在创建“动态类型”。相反，它是“动态创建静态类型”。如果您也使用模板或枚举解决方案，这同样适用。但同样 - 我非常喜欢“开关/外壳”。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-16T21:46:32.527

**更新：**我将我的原始解决方案留给后代，但考虑到稻田提供的解决方案更优越且不易出错。我认为只有一些细微的改进，它实际上已经达到了你所能得到的最好水平。

* * *

考虑这个设计：

```
class VariantA : public MyBase
{
    static MyBase *CreateMachineInstance() { return new VariantA; }
};

class VariantB : public MyBase
{
    static MyBase *CreateMachineInstance() { return new VariantB; }
}; 
```

现在，您只需要`std::map`使用 a`uint_8`作为键并将其映射到函数指针（返回`MyBase`）。在地图中插入标识符（将每个标识符指向适当的机器创建函数），然后阅读代码并使用地图查找您正在使用的机器。

这大致基于称为“工厂”的概念/模式，但如果您的机器构造函数需要不同的参数或者您需要执行额外的每台机器初始化/操作，则可能会稍微中断 - 从您提到的内容来看，您可能会这样做。

如果是这种情况，您仍然可以使用此模式，但您必须进行一些调整并重新架构一些东西，但您最终会得到一些*更*清洁、更容易扩充和维护的东西。

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2016-04-22T18:31:45.327

```
#include <stdio.h>
#include <string.h>
#include <iostream>
using namespace std;

template<class T,class T1>
class HeroHonda
{
private:
    T millage;
    T1 *options;

public:
    HeroHonda() {
        puts("constructed");
        options=new T1[20];

        strcpy(options,"Good millage,Powerstart");
        millage=110;
    }

    virtual T features() {
        cout<<options<<"millage is"<<millage<<endl;
        return 1;
    }

    // virtual T Extrafeatures() = 0;

    ~HeroHonda() {
      cout<<"destructor"<<endl;
      delete [] options;    
    }
};

int main()
{
    HeroHonda <int,char> *Ptr=new HeroHonda <int,char>;
    Ptr->features();
    delete Ptr;
} 
```

# django - 如何在没有沙箱的 dotcloud 上测试 django 项目

> ID：16047566
> 
> 赞同：1
> 
> 时间：2013-04-16T21:36:53.927
> 
> 标签：django, dotcloud

我正在开发一个 django 项目，我打算将它部署在 dotcloud 上。但我只是注意到他们只是关闭了沙箱，因为他们将开源它。那么如何在没有沙箱的情况下在 dotcloud 上测试我的 django 项目呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T02:19:20.463

dotCloud 按小时计费，因此您可以启动实时服务并进行测试，然后销毁应用程序，只需为您运行应用程序的时间付费。

如果您有想要在测试中保留的数据，您可以备份并恢复它，或者您可以有选择地销毁您的非数据库服务（节省 RAM 和 $$$）：

```
dotcloud destroy myservice 
```

其中*myservice*是您不需要持久化的非数据库服务的名称。当您再次推送时，将重新创建被破坏的服务（假设它们仍在您的`dotcloud.yml`）

# node.js - Passport.js - 在会话中存储信息

> ID：16047570
> 
> 赞同：1
> 
> 时间：2013-04-16T21:37:02.693
> 
> 标签：node.js, session, express, passport.js

我目前有一个可以成功登录和注销的 mongoose/express/passportjs 应用程序。但是，只有用户 ID 存储在会话中。我想存储整个用户对象。

这是我使用的代码：

```
passport.serializeUser(function(user, done) {
  done(null, user._id);
});

passport.deserializeUser(function(_id, done) {
  done(null, { _id: _id });
}); 
```

效果很好，这就是我尝试序列化整个用户的原因：

```
passport.serializeUser(function(user, done) {
  done(null, user._id);
});

passport.deserializeUser(function(user, done) {
  done(null, user);
}); 
```

但是，它不存储任何会话。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-08-14T00:00:06.293

在`serializeUser`您需要将整个用户传递给`done`：

```
passport.serializeUser(function(user, done) {
  done(null, user);
});

passport.deserializeUser(function(user, done) {
  done(null, user);
}); 
```

# grails - 在 Grails 中自动使用外部配置文件

> ID：16047574
> 
> 赞同：1
> 
> 时间：2013-04-16T21:37:40.473
> 
> 标签：grails, config

我正在做的似乎是在 Grails 中使用外部配置文件的最佳实践。

```
grails.config.locations = ["classpath:${appName}-config.groovy",
                           "file:./${appName}-config.groovy"]
if (System.properties["${appName}.config.location"]) {
   grails.config.locations << "file:" + System.properties["${appName}.config.location"]
} 
```

我在测试期间将配置文件放在根文件夹中，它可以工作。我在生产过程中手动将配置文件放入我们的 Tomcat 服务器的 lib 文件夹（在类路径中）并且它工作。但我不想每次都复制/创建我们的外部配置文件。在构建战争并部署应用程序后，是否可以将我的配置文件移动到正确的位置，这样我就不必在部署任何应用程序期间手动移动它？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T06:49:04.650

在 out 项目中，我们需要为每个环境（本地、开发、测试、生产）提供不同的配置设置。虽然我们希望避免在不同服务器本身上更新配置文件的麻烦，但我们确实需要允许在特定环境中快速覆盖配置值。

为了满足这些要求，我们对“级联”配置文件进行了以下设置：

*   common.properties 捆绑在 .war 文件中并且总是被加载
*   xxx.properties 文件捆绑在 .war 文件中，并根据环境变量 (appEnv) 的值加载这些配置文件中的一个或不加载（例如，如果环境变量为 yyy，则加载 yyy.properties）
*   使用 appEnv 和 appLibRoot 环境变量可以找到本地文件系统上的配置文件。如果找到 appEnv.properties 对应的配置文件，则最后加载。

只需在 Config.groovy 中提供配置文件位置列表，即可在 Grail 应用程序的 startp 上加载配置文件。AppEnv 类使用 appEnv 和 appLibRoot 环境变量创建配置文件列表，并检查类路径和文件系统中实际存在哪些文件。

```
Config.groovy    
grails.config.locations = AppEnv.instance.configLocations 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T21:49:48.763

注意：我会编辑问题的标题以反映您关于自动化的实际问题。

这取决于您现有流程的**手动方式...**

让我们想象一下：

*   您有一个持续集成引擎，例如 Jenkins/Hudson 正在运行
*   成功构建后scp */rsync*外部配置文件
*   在成功构建后将应用程序部署到服务器（假设在*projectName/scripts* -> *Tomcat、JBoss、Websphere 等*下有一个 gant 部署脚本）

# css - 仅 Firefox 中的边距折叠

> ID：16047581
> 
> 赞同：2
> 
> 时间：2013-04-16T21:37:59.127
> 
> 标签：css, margin

我在html5文档上使用这个css，#pane在firefox中渲染，顶部有大约30px的边距，而在ie和chrome上它在顶部是齐平的。我在这里想念什么？

```
html, body, div, span, object, iframe,
h1, h2, h3, h4, h5, h6, p, blockquote, pre,
abbr, address, cite, code,
del, dfn, em, img, ins, kbd, q, samp,
small, strong, sub, sup, var,
b, i,
dl, dt, dd, ol, ul, li,
fieldset, form, label, legend,
table, caption, tbody, tfoot, thead, tr, th, td,
article, aside, canvas, details, figcaption, figure, 
footer, header, hgroup, menu, nav, section, summary,
time, mark, audio, video {
    margin:0;
    padding:0;
    border:0;
    outline:0;
    font-size:100%;
    vertical-align:baseline;
    background:transparent;
}
/* END CSS Clear */

body {

    font-size: 13px;
    background: #f3f3f3;

}

/* Body and Window Definitions */
#pane { 
    width: 980px;
    padding: 10px 9px;
    margin: 0px auto;
    border-left: 1px solid #cdcdcd; 
    border-right: 1px solid #cdcdcd; 
    background: #fff;
    min-height: 1080px;
} 
```

# javascript - Angularjs将jquery插件转换为指令

> ID：16047582
> 
> 赞同：0
> 
> 时间：2013-04-16T21:38:00.553
> 
> 标签：javascript, angularjs

我正在尝试在 angularjs 中使用它并将其放入指令中[。](http://ios-checkboxes.awardwinningfjords.com/)我遇到的问题是，当复选框默认被选中时，我必须“双击”。在指令之外本机使用时不会发生这种情况，所以我假设我对指令做错了。

这是我拥有的代码，是否有任何看起来不合适或缺少指令的东西？

```
angular.module('directives', []).directive('ccCheckbox', function () {
    'use strict';

    return {
        require: '?ngModel',
        restrict:'A',
        link: function ($scope, elm, attrs, controller) {

            elm.iphoneStyle({
                checkedLabel : attrs.ccCheckboxChecked,
                uncheckedLabel : attrs.ccCheckboxUnChecked,
                onChange: function(elem, value) {
                    controller.$setViewValue(value);
                    $scope.$apply();
                }
            });
        }
    };
}); 
```

谢谢！

编辑：

这是我正在使用的标记：

```
<input type="checkbox" value="1" ng-model="users.online" cc-checkbox cc-checkbox-checked="Online" cc-checkbox-unchecked="Offline" checked="checked"> 
```

# node.js - 请求事件 - http.createServer(requestListener) 中的 requestListener 是否需要是具有两个参数（请求、响应）的函数？

> ID：16047595
> 
> 赞同：2
> 
> 时间：2013-04-16T21:39:03.993
> 
> 标签：node.js

据我了解`createServer`是一个接受单个参数的函数：每次有请求时都会执行的函数。

这个函数是否需要是一个只有两个参数（请求、响应）的函数，还是一个包含对带有参数（请求、响应）的函数的函数调用的函数`requestListener`？`http.createServer(requestListener)`

是否还`response.end()`需要调用代码才能正确完成请求？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-16T21:49:12.933

1.  你可以传递任何你想要的函数。
    但是，如果您想做任何有用的事情，则需要同时使用这两个参数。

2.  是的; 每一个回应都必须结束。

# autohotkey - 如果我的鼠标指针在那里，如何使输入框在第二个显示器中弹出？

> ID：16047600
> 
> 赞同：0
> 
> 时间：2013-04-16T21:39:26.983
> 
> 标签：autohotkey

你如何检测我的鼠标指针在哪个显示器上？

我正在使用多台显示器，我试图在我的鼠标所在的显示器中央弹出一个输入框

现在我有以下代码：

```
CoordMode, Mouse, Screen
MouseGetPos, X_m, Y_m
InputBox, UserInput, Title, Prompt,, 300,150,X_m, Y_m 
```

这会在鼠标指针所在的位置弹出输入框，但我希望它位于监视器的中心（鼠标所在的位置）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T17:24:17.470

您应该检查[SysGet](http://www.autohotkey.com/docs/commands/SysGet.htm)。

使用子命令`Monitor [, N] of SysGet`，`MouseGetPos`您可以推断出鼠标所在的监视器并相应地设置 msgbox

# ios - 从 iOS 应用程序运行 Haxe – hxRunLibrary() 错误

> ID：16047620
> 
> 赞同：38
> 
> 时间：2013-04-16T21:41:26.590
> 
> 标签：ios, haxe, nme, hxcpp

对于一个客户，我开发了一个用于用户界面的`iOS + Android`应用程序。`Cordova (PhoneGap)`现在，作为这个应用程序的更新，我正在尝试添加一个用 Haxe 编写的游戏。`Flash target`最初游戏是`C++`为`Android and iOS`.

在 Android 上，使用活动很容易将其与`Cordova`应用程序集成（Haxe 部分作为单独的活动运行），但我在 iOS 上实现类似结果时遇到了一些麻烦。

到目前为止，我已尝试将所有`hxcpp`生成的代码包含在我的项目中（与 NME 在您执行“nme build ios”时设置 XCode 项目的方式相同），并且`hxRunLibrary()`当我希望游戏运行时从我的代码中调用.

问题是它`hxRunLibrary()`似乎想要创建自己的`UIApplication`实例，但由于我的主应用程序已经在运行一个实例而失败并出现以下错误：

```
*** Assertion failure in void UIApplicationInstantiateSingleton(Class)(), /SourceCache/UIKit_Sim/UIKit-2380.17/UIApplication.m:2037
*** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'There can only be one UIApplication instance.' 
```

我认为这可能与 Haxe 用于图形的 SDL 有关。据我了解，SDL 需要从应用程序的主函数运行，这与 Cocoa 发生冲突，也需要从主函数运行。

有什么简单的方法可以解决这个问题吗？我查看了 hxcpp 源代码，但找不到`UIApplication`相关代码或 SDL 的任何入口代码。

也许有人可以指出我正确的方向。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-04-25T08:40:36.067

好吧，我用谷歌搜索了一些关于 Haxe 的信息。我的理解是，Haxe 将为您提供完整的应用程序。这意味着它包括主要功能。这就是发生错误的原因。

您可以通过两次调用 UIApplicationMain 函数来模拟问题。

在我看来，您必须从 Haxe 生成的源代码文件中删除有关 UIApplicationMain 的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-08T21:56:51.923

科尔多瓦有能力集成为更大的应用程序的一部分

遇到了同样的问题。

[http://devgirl.org/2012/11/15/embed-cordovaphonegap-in-your-native-ios-app/](http://devgirl.org/2012/11/15/embed-cordovaphonegap-in-your-native-ios-app/) 这篇文章会有所帮助

您实际上并没有创建一个新项目，而是通过 ios webview 将其嵌入到 webview 中，cordova 充当子视图。

# ajax - AJAX：Django 的模板灵活性消失了？更新 CSS 和 JS？

> ID：16047624
> 
> 赞同：1
> 
> 时间：2013-04-16T21:41:58.500
> 
> 标签：ajax, django

保持页面的所有页眉/页脚/导航部分不变，
仅使用 AJAX 刷新页面内容，

不能使用基本模板扩展的阻塞机制来设置内容对应的样式、脚本、页面标题？

想知道如何使用 AJAX 获取更新内容的 .css 和 .js 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T22:16:06.237

通常，您希望在标题模板中提供所有 CSS 和 JS，以便在加载动态内容时它们可用。开销很小，您将遵循“Django 方式”。

另一种选择是在动态内容中包含内联 CSS/JS，但不建议使用这种方法。它会导致代码混乱，并且难以排除故障。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T21:57:09.400

不能使用完整的句子？

无论如何，我不知道你为什么认为你需要为部分页面获取 CSS 和 JS。通过 Ajax 动态插入的一组 HTML 元素将简单地使用与页面关联的现有 CSS。

# haskell - 很难让 Parsec 解析器正确跳过空格

> ID：16047626
> 
> 赞同：7
> 
> 时间：2013-04-16T21:42:00.143
> 
> 标签：haskell, parsec

我是 Parsec 的新手（以及一般的解析器），我在写这个解析器时遇到了一些问题：

```
list = char '(' *> many (spaces *> some letter) <* spaces <* char ')' 
```

这个想法是以这种格式解析列表（我正在处理 s-expressions）：

```
(firstElement secondElement thirdElement and so on) 
```

我写了这段代码来测试它：

```
import Control.Applicative
import Text.ParserCombinators.Parsec hiding (many)

list = char '(' *> many (spaces *> some letter) <* spaces <* char ')'

test s = do
  putStrLn $ "Testing " ++ show s ++ ":"
  parseTest list s
  putStrLn ""

main = do
  test "()"
  test "(hello)"
  test "(hello world)"
  test "( hello world)"
  test "(hello world )"
  test "( )" 
```

这是我得到的输出：

```
Testing "()":
[]

Testing "(hello)":
["hello"]

Testing "(hello world)":
["hello","world"]

Testing "( hello world)":
["hello","world"]

Testing "(hello world )":
parse error at (line 1, column 14):
unexpected ")"
expecting space or letter

Testing "( )":
parse error at (line 1, column 3):
unexpected ")"
expecting space or letter 
```

如您所见，当列表的最后一个元素和结束的`)`. `spaces`我不明白为什么我之前放入的空白没有消耗`<* char ')'`。我犯了什么愚蠢的错误？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-16T21:48:03.540

问题是最后的空格被`spaces`的参数消耗`many`，

```
list = char '(' *> many (spaces *> some letter) <* spaces <* char ')'
                     --  ^^^^^^ that one 
```

然后解析器期望`some letter`但找到一个右括号并因此失败。

为了解决这个问题，只*在*令牌之后使用空格，

```
list = char '(' *> spaces *> many (some letter <* spaces) <* char ')' 
```

根据需要工作：

```
$ runghc lisplists.hs 
Testing "()":
[]

Testing "(hello)":
["hello"]

Testing "(hello world)":
["hello","world"]

Testing "( hello world)":
["hello","world"]

Testing "(hello world )":
["hello","world"]

Testing "( )":
[] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-16T21:51:59.163

问题在于，一旦解析器`many (spaces *> some letter)`看到一个空格，它就会承诺解析另一个项目，因为 Parsec 默认情况下只向前看一个字符并且不会回溯。

大锤解决方案`try`用于启用回溯，但最好通过简单地在每个标记*之后解析可选空格来避免此类问题，如*[Daniel's answer](https://stackoverflow.com/a/16047708/98117)中所见。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-16T21:51:09.257

这有点棘手。默认情况下，解析器是贪婪的。在你的情况下是什么意思？当您尝试`(hello world )`从 parsing 开始解析`(`时，您正在尝试匹配一些空格和标识符。所以我们这样做。没有空格，但有标识符。我们完了。我们再试一次世界。现在我们有`_)`剩余。你试试 parser `(spaces *> some letter)`。它使它变得贪婪：所以你匹配空间，现在你期待一些字母，但你却得到`)`了。此时解析器失败了，但它已经消耗了空间，所以你注定要失败。您可以使用`try`组合器使此解析器进行回溯：`try (many (spaces *> some letter))`

# c++ - 没有递归的排列？

> ID：16047628
> 
> 赞同：0
> 
> 时间：2013-04-16T21:42:16.647
> 
> 标签：c++, permutation, non-recursive

我试图使用 for 循环来替换我通常使用的递归，但我发现它比我想象的要难。谁能告诉我该怎么做？谢谢！

例如，给定一个 2、1、3 的向量。应该有六个排列：

```
1 2 3
1 3 2
2 1 3
2 3 1
3 1 2
3 2 1 
```

向量如下...

```
vector<int> simple;
simple.push_back(2);
simple.push_back(1);
simple.push_back(3); 
```

编辑：将顺序从 1 2 3 更改为随机顺序 2 1 3

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T21:45:11.243

我猜你正在寻找[`std::next_permutation()`](http://en.cppreference.com/w/cpp/algorithm/next_permutation)：

```
#include <iostream>
#include <algorithm>
#include <vector>

int main()
{
    std::vector<int> simple{1, 2, 3};

    do
    {
        for (auto e : simple) { std::cout << e << " "; }
        std::cout << std::endl;
    }
    while (next_permutation(simple.begin(), simple.end()));
} 
```

这是一个[活生生的例子](http://liveworkspace.org/code/3kW04t%24454)。

如果不想从排序向量开始，可以使用`std::next_permutation()`以下方式：

```
#include <iostream>
#include <algorithm>
#include <vector>

constexpr int factorial(int i)
{
    return i == 0 ? 1 : i * factorial(i-1);
}

int main()
{
    std::vector<int> simple{3, 1, 2};

    for (int i = 0; i < factorial(simple.size()); i++)
    {
        std::next_permutation(simple.begin(), simple.end());
        for (auto e : simple) { std::cout << e << " "; }
        std::cout << std::endl;
    }
} 
```

这是一个[活生生的例子](http://liveworkspace.org/code/3kW04t%24463)。

请注意，如果向量的大小在编译时是已知的，就像您的示例中的情况一样，您可以使用[`std::array`](http://en.cppreference.com/w/cpp/container/array)而不是`std::vector`，[如此实时示例](http://liveworkspace.org/code/3kW04t%24464)中所示。

# asp.net - Global.asax 中的 URL 重写 - IIS7

> ID：16047631
> 
> 赞同：2
> 
> 时间：2013-04-16T21:42:27.617
> 
> 标签：asp.net, iis-7, url-rewriting

我有一个相当详细的问题，希望有人能提供帮助。基本上，我有一个托管在 IIS7 上的 .NET 4.0 网站，其中有一些需要重写 URL 的页面。为了实现这些功能，我在 global.asax 中添加了一个方法，该方法将无扩展名的 URL 映射到其正确的 ASPX 页面，然后执行 context.RewritePath 以显示正确的页面。

最初，我从 application_BeginRequest 调用此方法。但是，我们在调用 Session_Start 时会发生一些业务必要的日志记录，而且自从在 application_BeginRequest 中实现 URL 重写以来，这种日志记录似乎并不总是发生 - 基本上，每个会话都会记录在数据库中，并且在初始部署之后URL 重写后，我们的会话日志减少了大约 20%，应用程序日志中没有相应的错误。同时，我们的 IIS 日志似乎显示了相对不变的流量，所以在我看来，会话似乎没有正确实例化。

作为此问题的解决方法，我将 URL 重写从 application_BeginRequest 移至 application_AcquireRequestState，以便在我（大部分）确定会话已启动之前，此代码不会触发。这适用于我的本地开发环境和我们的登台服务器（Windows Server 2008 - IIS 7 - 安装了 .NET 4.5 框架）。在生产环境（Windows Server 2008 - IIS 7 - .NET 4.5 Framework）中，尝试浏览要重写的无扩展名 URL 时出现 404 错误。

我完全被难住了 - 我已经验证我正在使用集成应用程序池，我的 web.config 具有“runAllManagedModulesForAllRequests=true”属性，我的 IIS 功能包括 HTTP 重定向和静态文件压缩，但似乎没有任何工作. 我发现了一个使用 Classic 应用程序池的 hack，并创建额外的脚本映射处理程序来处理没有扩展名的通配符 URL，但我犹豫是否将其投入生产。

您能提供的任何帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T03:38:55.633

我将专注于为什么会话日志下降了 20%。你确定没有流量下降吗？您是否为使用旧 .aspx 网址访问您网站的人使用重定向？也许您收到了更多不会触发 Session_Start 的 404 流量？谷歌分析是否确认 UrlRewite 实施后流量保持正常水平？您还可以使用[IIS Log Parser](http://www.iis.net/downloads/community/2010/04/log-parser-22)过滤掉静态文件并从日志文件中查询 200 与 404 以更好地了解实际流量。

# java - 如何从数组中打印出一个随机字符串

> ID：16047633
> 
> 赞同：0
> 
> 时间：2013-04-16T21:42:32.820
> 
> 标签：java, arrays, printing, system

嗨，我想知道如何打印出数组的一个随机值而不是其中的两个。这是我的代码：

```
public static void main(String args[])
{

    String[] currentRoom;
    String[][] rooms = new String [2] [2];
    rooms [0] [0] = "Start";
    rooms [0] [1] = "Treasure Room 1";
    rooms [1] [0] = "Goblin Hive 1";
    rooms [1] [1] = "Spider Nest";

    Random rand = new Random();
    {

        currentRoom = rooms[rand.nextInt(rooms.length)];

        System.out.println(Arrays.toString(currentRoom));

    }
} 
```

当我打印出来时，它会从我的数组中说出两个值，例如：[“Start”，“Treasure Room1”]，我需要它打印出一个值，例如：[“Start”]或只是 [“Spider Nest1 "]。我想知道如何解决这个问题。

任何帮助表示赞赏:)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-16T21:44:30.200

您需要在第二维生成随机索引，如下所示：

```
String[] currentRoomRow = rooms[rand.nextInt(rooms.length)];
String currentRoom = currentRoomRow[rand.nextInt(currentRoom.length)];
System.out.println(currentRoom); 
```

当所有行的大小相同时，这是可以的；如果他们不这样做，上面的代码将“偏爱”来自“较短”行的项目。解决这个缺陷需要更多的准备工作：您需要“展平”您的数组，生成一个不超过项目数量的随机数，然后从展平的数组中选择一个项目。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T21:48:51.097

这是一个二维数组。通过仅使用一个索引，您将获得一个数组（可能具有多个值）。`using rooms [0]`你会回来`["Start", "Treasure Room1"]`的。

因此，您必须通过 2 个索引。

Dasblinkenlight 的解决方案似乎是最好的。

# linux - 在 Linux 中使用核心转储检查点/重启

> ID：16047636
> 
> 赞同：9
> 
> 时间：2013-04-16T21:42:47.320
> 
> 标签：linux, coredump, checkpoint

可以使用进程的核心转储来实现检查点/重启吗？核心文件包含进程的完整内存转储，因此理论上应该可以将进程恢复到转储核心时的相同状态。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-16T22:55:38.687

是的，这是可能的。GNU Emacs 这样做是为了优化它的启动时间。它加载一堆 Lisp 文件以生成图像，然后转储一个可以重新启动的核心。

几年前，我为 GNU Make 3.80 创建了一个补丁来做同样的事情（使用从 GNU Emacs 借来的代码）。

有了这个补丁，你在 make: 中有一个新选项`make --dump`。该实用程序现在读取您的`Makefile`，然后不执行规则，而是生成一个核心转储，可以重新启动该核心转储以进行实际构建（评估已解析的规则树）。

这是一个节省，因为项目太大了，加载源代码树中的所有 make 规则需要 30 秒！通过这种优化，增量构建几乎可以立即启动，而没有半分钟的启动损失。

这不需要内核支持。需要的是有关核心文件结构的知识。

除了这种方法，多年前还有一个针对 Linux 的进程检查点项目（想知道发生了什么）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-17T05:43:46.510

正如我评论的那样，您可以查找[应用程序检查点](http://en.wikipedia.org/wiki/Checkpointing)并使用一些库，例如[Berkley Lab Checkpoint & Restart](https://ftg.lbl.gov/projects/CheckpointRestart/)。但是，这些库并不完全使用[core(5)](http://man7.org/linux/man-pages/man5/core.5.html)转储文件，并且对于检查点程序可以做什么以及检查点映像中的持久性有几个限制和约定。（打开的文件描述符和网络套接字通常不能持久化）。

一些 Unix（可能还有一些修补过的 Linux 内核）在内核本身中具有有限的检查点设施（在 1980 年代 Cray Unix 有一些）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-04-16T21:56:47.973

不，如果没有内核的特殊支持，这通常是不可能的。内核维护了很多每个进程的状态，例如文件描述符表、IPC 对象等。

如果你愿意做很多简化的假设，比如没有打开的文件、没有打开的套接字、没有活动的 IPC 对象、没有共享内存区域等等，那么*理论上*这是可能的，但实际上我不相信即使有这些让步，Linux 也是可能的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-09-10T17:22:30.453

Debian 有许多你可能想看的软件包：

1.  blcr-util - 检查点和重启 Linux 进程的用户空间工具

这与 BLCR（伯克利实验室检查点/重启）有关，请参阅[https://upc-bugs.lbl.gov/blcr/doc/html/FAQ.html#whatisblcr](https://upc-bugs.lbl.gov/blcr/doc/html/FAQ.html#whatisblcr)

2.  criu - 用户空间中的检查点和恢复[https://criu.org/Main_Page](https://criu.org/Main_Page)

    2.1 docker - 最新版本支持检查点，见 [https://criu.org/Docker](https://criu.org/Docker)

    2.1。containerd - 控制 runC 的守护进程

这包含一个有趣的检查点设施。

另请参阅支持实时迁移的 openvz： [https ://openvz.org/Checkpointing_and_live_migration](https://openvz.org/Checkpointing_and_live_migration)

# coronasdk - 在不定义 xy 坐标的情况下在 corona sdk 中将对象添加到屏幕？电晕sdk

> ID：16047638
> 
> 赞同：0
> 
> 时间：2013-04-16T21:43:10.213
> 
> 标签：coronasdk

一个非常简单的初学者问题......我认为这一定是可能的......

如何将对象添加到 Corona 中的屏幕（采用简单的标准小部件项目，如按钮），以使它们只出现在彼此下方，从而避免必须为每个项目提供相对于顶部的“顶部”值屏幕？当然有一种方法可以自动执行此操作或引用前一个对象来放置下一个对象的位置？

我认为分组项目可能会对此有所帮助，但到目前为止我的实验还没有。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-13T23:03:38.890

您可以使用有关其他对象的变量和信息来定义按钮的位置。假设您有一个对象 button1。您希望另一个对象 button2 位于其上方 20 像素处。

```
button1.y = 45
print(button1.y)--You'll get 45.
button2.y = button1.y - 20--Remember that the origin (0,0) is at the top left. Subtracting 20 makes the object closer to the top.
print(button2.y)--You'll get 25. 
```

X、Y 坐标可以通过变量与数学运算的组合来定义。您可以通过定义相对于一个中心对象的许多对象来大大加快您的代码速度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T00:09:37.823

button2.x=button1.x button2.y=button1.y+20 .... button3.x=button2.x+20 button3.y=button2.y+20

你可以这样设计，这样你就可以设置按钮的相对位置。我希望它会帮助你。

# jquery - Jquery Ajax Post 请求问题

> ID：16047639
> 
> 赞同：1
> 
> 时间：2013-04-16T21:43:10.650
> 
> 标签：jquery, ajax

`testArr`例如，在下面的代码中，当我传递静态值时`[2, 3]`，我知道`testArr[0] => 2 and testArr[1] => 3`哪个是正确的。但是，如果我将动态值传递`testArr`给例如`test`；我明白了`testArr[0] => 2,3`。我无法弄清楚问题所在。请帮忙。

```
 var test = '1' + ',' + '2';
            $.ajax({
                url : url,
                type : "post",
                data : {
                    'testArr[]' : [test]

                },
                success : function(response) {
                    alert(response);
                }
            }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T21:46:42.477

现在你`test`作为一个字符串传递。你想像下面这样传递它：

```
var test = new Array(1,2); 
```

然后`test`不带括号就通过。

# jquery - Jquery 调用 Rails 控制器

> ID：16047644
> 
> 赞同：0
> 
> 时间：2013-04-16T21:43:38.167
> 
> 标签：jquery, ruby-on-rails

我有一个巨大的检查清单，里面会有一排排的复选框。每行是一个事件。当复选框被“选中”时，它会替换为用户的姓名首字母和当前日期。我希望用户能够单击包含用户信息的 TD，然后让 jquery 弹出一个对话框，询问您是否要取消选中此字段。

我的问题是我不知道在接受对话框后如何从控制器调用方法。我需要将传递给对话框的 ID 和类别也发送给方法。

导轨查看代码：

```
<td style='text-align:center;' class='completed_box' id='<%= check_list.id %>' category='videos_edited'>
                            <div id='videos_edited_<%= check_list.id %>' style='display:none;'>
                                Are you sure you would like to uncheck videos edited recieved?
                            </div>
                            <label>
                                <%= check_list.videos_edited_user_id.initials %> <br />
                                <%= check_list.videos_edited_date.strftime("%-m/%d")  %>
                            </label>
                        </td> 
```

jQuery代码：

```
$(document).ready(function(){

    $(".completed_box").click(function(e){
        id = this.id
        category = $(this).attr('category');
        $("#" + category + "_" + id).dialog({
          resizable: false,
          height:140,
          modal: true,
          buttons: {
            Yes: function(){
                uncheck(id,category); // This is the function I'm not sure how is going to work 
                $(this).dialog('close');
            },
            Cancel: function(){
                $(this).dialog('close');
                }
            }
        });
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T22:36:24.783

使用 gon gem 将“取消选中”url 传递给您的 javascript，以便您的 javascript 知道在哪里发布消息。

如果您使用 JSON 数据发布到“取消选中”操作，并取消选择记录的 id，那么您的控制器可以进行更改（或者更好的是，调用模型或 lib 对象进行更改），如果成功则以就像是：

```
head :ok 
```

如果不成功，您可能希望呈现一个简单的 JSON 散列并显示错误消息，并可能带有不同的状态代码，例如 422 - Unprocessable entity。在您的 jQuery Ajax 中，包含一个错误事件处理程序以在失败时显示错误消息，或者重新选中该框，或者您想要发生的任何事情。

# c++ - 连接两个字符串

> ID：16047645
> 
> 赞同：0
> 
> 时间：2013-04-16T21:43:42.747
> 
> 标签：c++, string

我已经阅读了很多关于为什么不能在 C++ 中添加两个字符串文字等的帖子，并且 operator+ 支持将字符串文字添加到整数。

但是，我试图理解以下代码中的编译器错误：

```
string str1, str2, str3;
int i = 10;

str1 = "Hello " + i;
str2 = i + "Mars";
str3 = "Hello " + i + "Mars"; 
```

的初始化`str1`和`str2`工作正常，但构造`str3`给出以下错误：

> example.cpp：在函数中`int main()`： example.cpp:20:27：错误：类型和二进制
> 的无效操作数`const char*``const char [5]``operator+`

Q1：在错误信息中，我理解`const char [5]`是指`"Mars"`. 转换为 a 后`const char*`的整数指的是什么？`i``char *`

Q2：`operator+`具有从左到右的关联性，我猜测的构造`str3`可以写成：

```
str3 = ("Hello " + i) + "Mars"; 
```

评估`("Hello " + i)`为?`char *`

Q3：在以下代码中：

```
str5 = string("foo ") + "bar ";
str6 = string("foo ") + "bar " + i; 
```

编译的设置`str5`很好，但`str6`会生成错误消息的负载（页面和一半）。结果是什么`string("foo ") + "bar "`，是一个`"string"`？

提前感谢您的任何见解。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-16T21:50:15.983

`str1`获取字符串文字（实际上是一个常量字符数组），将其衰减为指向第一个字符的指针，并向该指针添加 10，导致 a`const char *`超出字符串文字，这是未定义的行为，因为它超出了过去结束。

`str2`与 做同样的事情`str1`，但越界越远。

`str3``"Hello"`用and做同样的事情`i`，然后尝试将结果添加`const char *`到您的其他字符串文字（同样，一个常量字符数组，由于传递给函数而衰减）。不会有任何过载and ，因此你`operator+`会得到错误。`const char *``const char *`

请注意，这些都不会像您希望的那样工作。编译的是未定义的行为。`std::string`已重载`operator+`以适合其用途，因此将字符串文字添加到 a `std::string`just 将其连接起来。但是，添加一个整数有点模棱两可（因此不支持`operator+`），因此您必须先将其转换为字符串来明确您的意图：

```
str6 = string("foo ") + "bar " + std::to_string(i); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-16T21:48:52.337

> Q1：在错误信息中，我理解 const char [5]' 指的是“Mars”。const char*' 指的是什么，转换为“char *”后的整数 i？

它指的是 的结果`"Hello" + i`。

> Q2：operator+有从左到右的结合性，我猜str3的构造可以写成：str3 = ("Hello" + i) + "Mars";
> 
> ("Hello" + i) 计算结果是否为 char *？

是的。但是，它的计算结果为`const char*`。

> Q3：string("foo") + "bar"的结果是什么，是"string"吗？

是的，它是一个`std:string`. 你得到一个错误，`str6 = string("foo ") + "bar " + i;`因为你不能添加一个字符串和一个整数。

附注 - 以下三个语句都不是初始化：

```
str1 = "Hello " + i;
str2 = i + "Mars";
str3 = "Hello " + i + "Mars"; 
```

他们都调用赋值运算符。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-16T21:48:40.277

问题是，“Hello”文字被视为 char*。您可以通过向其添加一个 int 来对 char* 进行指针算术 - 您说的是“超出 char* 指向的 10 个字符”。换句话说，垃圾。

简而言之，您需要使用 boost::lexical_cast 或 istringstream 来处理这种事情。

# python - Python 3 - optparse - 发生错误时如何更改返回值

> ID：16047647
> 
> 赞同：0
> 
> 时间：2013-04-16T21:43:48.683
> 
> 标签：python, error-handling, python-3.x

我对 optparse 的返回值有问题。当脚本找到未知参数时，它会以错误消息退出并返回值 2（回显 $？）。

我需要返回 1 并且我想设置自己的错误消息，我该怎么做？

这是代码的一部分：

```
import sys
import re
import ast 
from optparse import OptionParser

parser = OptionParser(usage="usage: %prog [OPTIONS] ", version="%prog 1.0")

parser.add_option("", "--input",
              action="store", 
              dest="inputfile",
              default="stdin",
              help="Allow to set an input file. Default input is STDIN.")

(options, args) = parser.parse_args()
options_dictionary = vars(options) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T11:44:58.387

好的，一天后我找到了这个解决方案。我仍然不确定它是否是最好的，但它对我有用。

```
try:
    (options, args) = parser.parse_args()
except SystemExit:
    print("Error: špatné vstupní parametry, začněte prosím s -h.",file=sys.stderr)
sys.exit(1) 
```

# php - JavaScript 用于更新表单内的价格

> ID：16047651
> 
> 赞同：0
> 
> 时间：2013-04-16T21:43:55.527
> 
> 标签：php, javascript, forms

我有一个 php 文件，它在表单中显示价格和数量。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T22:05:21.433

`id`在生成的 HTML 中，您不能有多个相同的元素。一种出路是这样的：

```
$counter = 0;
while($queryresult = mysql_fetch_assoc($query)){    
    echo '<form method ="post" action="price.php">';
    echo '<input type="text" name ="quant" id="quant'.$counter.'" onblur="functionprice('.$counter.')" />';
    echo '<input type="text" name ="price" id="price'.$counter.'" onblur="functionprice('.$counter.')" />';
    echo '<input type="text" name="unitprice" id="unitprice'.$counter.'" readonly="true" />';
    echo "</form>";
    $counter++;
}//while 
```

然后使用您要更改的行号调用此更新的 JavaScript 函数，例如`functionprice(2);`

```
<script type="text/javascript">
function functionprice(counter)
{
    var price = parseFloat(document.getElementById("quant"+counter).value);
    var quantity = parseFloat(document.getElementById("price"+counter).value);

    if (!(price == Number.NaN && quantity == Number.NaN))
        document.getElementById("unitprice"+counter).value = Number(price/quantity).toFixed(2);
}
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T22:06:17.720

首先，在多个元素上拥有相同的 ID 是不好的，这不是 W3C 的投诉。可能这就是其他表单元素没有更新的原因。您可以在`id`like上附加数字`"quantity_1"`，`"quantity_2"`以便您可以更好地控制您的 javascript 代码

而且，如果您想将其视为数据库中的单行，请按照上面的评论使用，即 name = 'price[]'

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T22:13:20.193

首先，设置`<form>`在while循环之外。跳过 id=""，而是使用 class=""，因为元素的 id 必须是唯一的。

```
<?php
echo '<form method ="post" action="price.php">';

while($queryresult = mysql_fetch_assoc($query)){    
    $id = $queryresult['id']; //assumption is that id is an autoincremental integer
    echo '<input type="text" name ="quant[' . $id . ']" class="quant" onblur="functionprice(' . $id . ')" />'; //Make quant-array (dynamically)
    echo '<input type="text" name ="price[' . $id . ']" class="price" onblur="functionprice(' . $id . ')" />'; //Make price-array (dynamically)
    echo '<input type="text" name="unitprice[' . $id . ']" id="unitprice" readonly="true" />';
}//while

echo "</form>"

?>//close php tag
?> 
```

然后做这样的事情（我希望你明白这个概念）

```
<script type="text/javascript">
function functionprice(id)
{
    var price = parseFloat(document.getElementById ("quant[" + id + "]").value); //Get value of element in quant-array
    var quantity = parseFloat(document.getElementById ("price[" + id + "]").value); //Get value of element in price-array

    if (!(price == Number.NaN && quantity == Number.NaN))
        document.getElementById ("unitprice[" + id + "]").value = Number(price/quantity).toFixed(2);
}
</script> 
```

在编写这样的代码（上图）时，您可以在服务器端检索值时使用构建的数组（非常容易）。唯一的缺点 - 正如我所看到的 - 是如果你有很大的结果集（比如> 100.000行） - 数组可能会“吃掉”服务器上的内存。

**示例：** 如果您在 while 循环之后和内部放置一个提交按钮，`<form>`如下所示：';

```
while($queryresult = mysql_fetch_assoc($query)){    
    $id = $queryresult['id']; //assumption is that id is an autoincremental integer
    echo '<input type="text" name ="quant[' . $id . ']" class="quant" onblur="functionprice(' . $id . ')" />'; //Make quant-array (dynamically)
    echo '<input type="text" name ="price[' . $id . ']" class="price" onblur="functionprice(' . $id . ')" />'; //Make price-array (dynamically)
    echo '<input type="text" name="unitprice[' . $id . ']" id="unitprice" readonly="true" />';
}//while

echo "<input type=\"submit\" value=\"Skicka\" />";
echo "</form>"

?>//close php tag
?> 
```

然后在 price.php 中（提交后），您可以通过执行以下操作来获取值：（当然也应该进行验证，以便获得所需的预期值/数组）

```
<?php
$quantArr = $_POST['quant'];
$priceArr = $_POST['price'];

//echo out a certain row from db (where id = 27)
echo 'quantity: ' . $quantArr[27];
echo 'price: ' . $pricearr[27];
?> 
```

# qt - 即使根本没有代码，QT 应用程序也会崩溃

> ID：16047652
> 
> 赞同：1
> 
> 时间：2013-04-16T21:43:56.447
> 
> 标签：qt, crash, windbg

我正在使用 QT 框架在 C++ 中开发应用程序。过了一会儿，我需要使用调试器，故事从这里开始。

我尝试在 QT Creator 中设置 CDB，但我不知道我在执行此操作时是否更改了代码中的任何内容（可能没有），并且我的应用程序在运行后立即开始崩溃。

我把 "qDebug() << "TEST";" 在 main 函数的第一行，它崩溃而没有任何输出。

我只是放了一个“return 1;” 进入主体，删除了其他所有内容，仍然崩溃。

顺便说一句，Creator 中的调试器没有帮助。它也崩溃了。

我将我的代码移到 Visual Studio 2010 中，调试器卡在 qvector.h 文件的“detach()”函数中。之后，它会抛出一条消息，告诉您：

“Windows 已在 app.exe 中触发断点。这可能是由于堆损坏，这表明 app.exe 或其已加载的任何 DLL 中存在错误-。这也可能是由于用户在应用程序时按 F12 .exe 有焦点。输出窗口可能有更多诊断信息。[BREAK] [CONTINUE] [IGNORE]"

但有一个有趣的点。如果我在 VS2010 中单击“不调试就开始”，它运行没有问题。

寻找出路。提前致谢..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-11-18T22:05:04.507

这不是与 QT 相关的问题，而是在 Visual Studio 中调试时的“功能”，其中 F12 按钮被映射以触发断点。

> F12 键一直保留供调试器使用，因此不应将其注册为热键。即使您不调试应用程序，F12 也会保留，以防内核模式调试器或即时调试器驻留。 [来源 MSDN](https://msdn.microsoft.com/en-us/library/ms646309%28VS.85%29.aspx?ranMID=24542&ranEAID=TnL5HPStwNw&ranSiteID=TnL5HPStwNw-VCAbO9fUY9I8hvee9c20XQ&tduid=%285a047c50c6d6b0971371f1676f8f9981%29%28256380%29%282459594%29%28TnL5HPStwNw-VCAbO9fUY9I8hvee9c20XQ%29%28%29&f=255&MSPPError=-2147217396)

不幸的是，我还没有找到禁用 F12 快捷方式的方法。

# dependency-injection - 使用 Ninject 并绑定默认实现，同时避免可怕的 Service Locator 反模式

> ID：16047654
> 
> 赞同：7
> 
> 时间：2013-04-16T21:44:00.107
> 
> 标签：dependency-injection, ninject, ioc-container, anti-patterns, service-locator

是否有可能和/或一个好主意使用[Ninject](http://www.ninject.org)（或任何其他 IoC 容器，就此而言）为不存在适当实现的情况创建**默认绑定**`ActivationException`，并使用此默认绑定而不是必须处理当存在多个绑定或特定请求不存在绑定时？

我一直在使用 Ninject 的[Factory](https://github.com/ninject/ninject.extensions.factory/wiki)和[Conventions](https://github.com/ninject/ninject.extensions.conventions/wiki)扩展项目，但我想知道它们是否掩盖了我在更基本的层面上犯的错误，所以我创建了一个测试来说明我想要做什么，如尽我所能：

鉴于以下情况：

```
public interface IWidget { }
public class DefaultWidget : IWidget { }
public class BlueWidget : IWidget { } 
```

以及以下使用[FluentAssertions的](http://nuget.org/packages/FluentAssertions/)[xUnit](http://nuget.org/packages/xunit/1.9.1)测试：

```
[Fact]
public void Unknown_Type_Names_Resolve_To_A_Default_Type()
{
    StandardKernel kernel = new StandardKernel();

    // intention: resolve a `DefaultWidget` implementation whenever the 
    // 'name' parameter does not match the name of any other bound implementation
    kernel.Bind<IWidget>().To<DefaultWidget>();
    kernel.Bind<IWidget>().To<BlueWidget>().Named(typeof(BlueWidget).Name);
    kernel.Get<IWidget>("RedWidget").Should().BeOfType<DefaultWidget>();

    //      ACTIVATION EXCEPTION (**NO matching bindings available** for `IWidget`)
} 
```

我不确定沿着这条路走下去，如果可能的话，会导致我对 Service Locator 模式的一个令人讨厌的实现，除了这似乎是那些回答过类似问题的人给出的警告。

那么，**这是滥用/误用**IoC 容器来做我要求它做的事情吗？

对于我拥有的所有显式类型，我似乎应该想用 IoC 绑定/解析类型，所以这部分对我来说似乎没有错。在现实生活中，会有更多明确的绑定，例如`BlueWidget`，以及传入的“RedWidget”字符串值的未知数量的变体。

*一般来说，某些接口的默认实现*的概念似乎并不常见，那么如果不在 IoC 容器的范围内，这种解决请求的机制会在哪里呢？

我还计划使用工厂模式来创建`IWidget`实现。到目前为止，我一直在使用由 Ninject.Extensions.Factory 自动创建的工厂以及自定义实例提供程序和自定义绑定生成器，但我无法解决这个问题。

对工厂实现有更多的控制（换句话说，使用我自己的工厂，而不是来自 Ninject.Extensions.Factory 的自动工厂）有帮助吗？过去，我使用 Assembly 反射来查找候选类型，并使用 Activation.CreateInstance() 来创建我需要的特定实现或默认实现，但是一旦这些实现具有自己的构造函数注入依赖项，这将变得非常麻烦因为依赖注入原则应用于这些实现。因此，我转向 IoC 容器寻求解决方案——但这并没有像我希望的那样奏效。

**更新 1 -- 使用我自己的工厂实现成功**

我对此不太满意，因为每次`IWidget`必须编写新的实现时，我都必须打开这个工厂并更新它。在我的示例中，我还必须在绑定中添加另一行 - 但这就是基于约定的绑定的用武之地，我计划使用它来避免必须不断更新绑定定义。

使用这个工厂实现，

```
public interface IWidgetFactory { IWidget Create(string name); }
public class WidgetFactory : IWidgetFactory 
{
    private readonly IKernel kernel;
    public WidgetFactory(IKernel kernel) { this.kernel = kernel; }

    public IWidget Create(string name)
    {
        switch (name)
        {
            case "Blue":
                return this.kernel.Get<IWidget>(typeof (BlueWidget).Name);
            default:
                return this.kernel.Get<IWidget>(typeof (DefaultWidget).Name);
        }
    }
} 
```

我可以让这个测试通过：

```
[Fact]
public void WidgetBuilders_And_Customizers_And_Bindings_Oh_My()
{
    StandardKernel kernel = new StandardKernel();
    kernel.Bind<IWidget>().To<DefaultWidget>().Named(typeof(DefaultWidget).Name);
    kernel.Bind<IWidget>().To<BlueWidget>().Named(typeof (BlueWidget).Name);
    kernel.Bind<IWidgetFactory>().To<WidgetFactory>().InSingletonScope();

    kernel.Get<IWidgetFactory>().Create("Blue")
        .Should().BeOfType<BlueWidget>();
    kernel.Get<IWidgetFactory>().Create("Red")
        .Should().BeOfType<DefaultWidget>();
} 
```

它有效，但感觉不对，原因如下：

1.  我必须`IKernel`注入`IWidgetFactory`
2.  对于 的每个新实现`IWidget`，`IWidgetFactory`必须更新
3.  似乎应该已经为此场景创建了一个 Ninject 扩展

**更新结束 1**

**在这种情况下你会怎么做**，考虑到`IWidget`实现的数量很高，“小部件名称”参数的预期范围基本上是无限的，并且所有无法解析的小部件名称都应该使用`DefaultWidget`?

您无需进一步阅读，但如果您有兴趣，以下是我在解决此问题时尝试的各种测试：

这是我经历的测试的完整演变：

```
[Fact]
public void Unknown_Type_Names_Resolve_To_A_Default_Type()
{
    StandardKernel kernel = new StandardKernel();

    // evolution #1: simple as possible
    //      PASSES (as you would expect)
    //kernel.Bind<IWidget>().To<BlueWidget>();
    //kernel.Get<IWidget>().Should().BeOfType<BlueWidget>();

    // evolution #2: make the only binding to a different IWidget
    //      FAILS (as you would expect)
    //kernel.Bind<IWidget>().To<DefaultWidget>();
    //kernel.Get<IWidget>().Should().BeOfType<BlueWidget>();

    // evolution #3: add the binding to `BlueWidget` back
    //      ACTIVATION EXCEPTION (more than one binding for `IWidget`)
    //kernel.Bind<IWidget>().To<DefaultWidget>();
    //kernel.Bind<IWidget>().To<BlueWidget>();
    //kernel.Get<IWidget>().Should().BeOfType<BlueWidget>();

    // evolution #4: make `BlueWidget` binding a *named binding*
    //      ACTIVATION EXCEPTION (more than one binding for `IWidget`)
    //kernel.Bind<IWidget>().To<DefaultWidget>();
    //kernel.Bind<IWidget>().To<BlueWidget>().Named(typeof (BlueWidget).Name);
    //kernel.Get<IWidget>().Should().BeOfType<BlueWidget>();

    // evolution #5: change `Get<>` request to specifiy widget name
    //      PASSES (yee-haw!)
    //kernel.Bind<IWidget>().To<DefaultWidget>();
    //kernel.Bind<IWidget>().To<BlueWidget>().Named(typeof(BlueWidget).Name);
    //kernel.Get<IWidget>("BlueWidget").Should().BeOfType<BlueWidget>();

    // evolution #6: make `BlueWidget` binding *non-named*
    //      ACTIVATION EXCEPTION (**NO matching bindings available** for `IWidget`)
    //kernel.Bind<IWidget>().To<DefaultWidget>();
    //kernel.Bind<IWidget>().To<BlueWidget>();
    //kernel.Get<IWidget>("BlueWidget").Should().BeOfType<BlueWidget>();

    // evolution #7: ask for non-existance `RedWidget`, hope for `DefaultWidget`
    //      ACTIVATION EXCEPTION (**NO matching bindings available** for `IWidget`)
    //kernel.Bind<IWidget>().To<DefaultWidget>();
    //kernel.Bind<IWidget>().To<BlueWidget>();
    //kernel.Get<IWidget>("RedWidget").Should().BeOfType<DefaultWidget>();

    // evolution #8: make `BlueWidget` binding a *named binding* again
    //      ACTIVATION EXCEPTION (**NO matching bindings available** for `IWidget`)
    //kernel.Bind<IWidget>().To<DefaultWidget>();
    //kernel.Bind<IWidget>().To<BlueWidget>().Named(typeof(BlueWidget).Name);
    //kernel.Get<IWidget>("RedWidget").Should().BeOfType<DefaultWidget>();

    // evolution #9: remove `RedWidget` specification in Get<> request
    //      ACTIVATION EXCEPTION (back to **more than one** binding for `IWidget`)
    //kernel.Bind<IWidget>().To<DefaultWidget>();
    //kernel.Bind<IWidget>().To<BlueWidget>().Named(typeof(BlueWidget).Name);
    //kernel.Get<IWidget>().Should().BeOfType<DefaultWidget>();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-10T16:16:57.347

不知道这在哪里堆积，但它有效。但是，您不能传递命名参数，它仅适用于空参数。换句话说，你不能这样做：

```
var stuff1 = kernel.Get<IWidget>("OrangeWidget"); 
```

除非 OrangeWidget 存在。为了获得默认值，您需要执行以下操作：

```
var stuff2 = kernel.Get<IWidget>(); 
```

这是一个例子：

```
IDictionary dic = new Dictionary<string, string>();

dic.Add("BlueWidget", "BlueWidget");
dic.Add("RedWidget", "RedWidget");

kernel.Bind<IWidget>().To<DefaultWidget>()
    .When(x => x.Service.Name != (string)dic[x.Service.Name]); 
kernel.Bind<IWidget>().To<BlueWidget>().Named("BlueWidget");

var stuff1 = kernel.Get<IWidget>("BlueWidget");
var stuff2 = kernel.Get<IWidget>(); 
```

[这](http://lukewickstead.wordpress.com/2013/01/18/ninject-cheat-sheet/)是一个很酷的 Ninject 帖子，您可能会感兴趣……

我想添加一些关于命名参数的内容。这是基于[此](https://github.com/ninject/ninject/wiki/Contextual-Binding)文档。Named 参数允许您在 Get<> 时按名称调用绑定，但它不会“默认”任何内容。因此，您实际上必须传递名称 DefaultWidget 才能获得该绑定。这有效：

```
kernel.Bind<IWidget>().To<BlueWidget>().Named("BlueWidget");
kernel.Bind<IWidget>().To<DefaultWidget>().Named("DefaultWidget");

var blueOne = kernel.Get<IWidget>("BlueWidget");
var defaultOne = kernel.Get<IWidget>("DefaultWidget"); 
```

如果有人能弄清楚如何实现默认值，我很想知道如何实现，尽管我从来不需要它。我是 Ninject 的学生，非常喜欢它。

**更新：**

我知道了。[在这里](https://stackoverflow.com/questions/5997483/ninject-default-contextual-binding)找到了一个很酷的解决方案。

我创建了一个类来扩展 Ninject：

```
public static class NinjectExtensions
{
    public static T GetDefault<T>(this IKernel kernel)
    {
        return kernel.Get<T>(m => m.Name == null);
    }

    public static T GetNamedOrDefault<T>(this IKernel kernel, string name)
    {
        T result = kernel.TryGet<T>(name);

        if (result != null)
            return result;

        return kernel.GetDefault<T>();
    }
} 
```

这是您的 Unknown_Type 方法...

```
public static void Unknown_Type_Names_Resolve_To_A_Default_Type()
{
    StandardKernel kernel = new StandardKernel();

    IDictionary dic = new Dictionary<string, string>();

    dic.Add("BlueWidget", "BlueWidget");
    dic.Add("RedWidget", "RedWidget");

    kernel.Bind<IWidget>().To<DefaultWidget>().When(x => x.Service.Name != (string)dic[x.Service.Name]);
    kernel.Bind<IWidget>().To<BlueWidget>().Named("BlueWidget");

    // this works!
    var sup = kernel.GetNamedOrDefault<IWidget>("Not here");

    var stuff1 = kernel.Get<IWidget>("BlueWidget");
    var stuff2 = kernel.Get<IWidget>();
} 
```

# python - OAuth 签名问题

> ID：16047659
> 
> 赞同：0
> 
> 时间：2013-04-16T21:44:22.577
> 
> 标签：python, python-2.7, oauth, intuit-partner-platform, rauth

我正在尝试将 python 与 rauth 库一起使用来连接到 intuit 合作伙伴平台上的 QBO api，而且我大部分时间都让它正常工作。但是，我在发送请求时经常遇到错误：

```
Exception authenticating OAuth; errorCode=003200; statusCode=401 
```

此消息在失败时也位于响应标头中：

```
WWW-Authenticate: OAuth oauth_problem="signature_invalid" 
```

错误代码表明请求没有被正确签名，但我使用标准 oauth 库来自动签署数据，并且它在大约一半的时间内工作。我的连接代码如下：

```
if method is 'post':
    headers = {}
        if action in ['create', 'update', 'delete']:
            headers['Content-Type'] = 'application/xml'
        r = self.session.post(url, data=data, headers=headers, params=params, header_auth=True)
else:
    r = self.session.get(url, params=params, header_auth=True) 
```

其中 self.session 是一个 rauth.OAuth1Session。

生成请求的示例是：

```
GET /resource/customer/v2/682571780/1 HTTP/1.1
Host: qbo.sbfinance.intuit.com
Accept: */*
Content-Length: 0
Accept-Encoding: gzip, deflate, compress
authorization: OAuth realm="",oauth_nonce="d577f23920c96f8ee79eff6588c83c9ebf65cf20",oauth_timestamp="1366147949",oauth_consumer_key="qyprdCFOHBypPTK8XX0g8N4bZ8ceVA",oauth_signature_method="HMAC-SHA1",oauth_version="1.0",oauth_token="qyprdp9p7diRBIt11In225OOGRzcgl9o4DsQRJduHJFP09gY",oauth_signature="w5V3u2ATnj/rDc9vFD7inr8MO6I%3D"
User-Agent: python-requests/1.1.0 CPython/2.7.3 Linux/3.5.0-17-generic 
```

这是 rauth 库的问题吗？我是否遗漏了一个可以使其更稳定的参数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T22:37:49.733

劳斯作者在这里：

“错误代码表明请求未正确签名......”

实际上，这不一定是真的：它确实表明提供者无法验证请求并且表明签名不正确。但这也可能意味着签名完全丢失（顺便说一句，这在技术上是不正确的）。我会尝试设置`header_auth`为`False`. 这是一个常见问题，提供者不准备处理基于标头的身份验证，然后令人困惑地返回 signature_invalid 错误。

此外，您提到您正在使用库来自动签署请求，除了 rauth 之外，还有一个库吗？如果是这样，我强烈建议不要这样做：rauth 是独立的，并且会为您签名。您应该避免将其与其他 OAuth 库结合使用。

最后，如果您仍然遇到问题，请随时直接与我联系或在[GitHub 存储库](https://github.com/litl/rauth)上打开问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T14:25:54.107

好的，事实证明我的问题的完整解决方案需要两个更改：

1.  在某些情况下，我传递的`params`对象在请求之间被保留，但在设置请求时显然被破坏性修改。这意味着 oauth 参数包含在下一个请求中，这以某种方式干扰了 rauth 的设置。

    我注意到的唯一区别是参数的顺序不同，但有可能 oauth 参数被视为签名内容的一部分，然后在生成签名后被覆盖，使其无效。不管是什么原因，这个改变解决了我遇到的 90% 的故障。

2.  按照maxcountryman的建议`header_auth`重新设置`False`。尽管[qbo 请求](http://docs.developer.intuit.com/0025_Intuit_Anywhere/0050_Data_Services/v2/0400_QuickBooks_Online/0100_Calling_Data_Services/0005_Request_Header)的规范说将身份验证放在标头中，但显然这并不总是有效。我使用此设置得到的错误率只有 10% 左右，但没有它我不再收到任何签名错误。

# javascript - 是否有用于输入国际电话号码的 jquery 小部件？

> ID：16047663
> 
> 赞同：0
> 
> 时间：2013-04-16T21:44:44.453
> 
> 标签：javascript, jquery, widget, phone-number

我需要在我的 HTML 表单上接受国际电话号码。

是否有任何用于输入国际电话号码的开源 javascript / jquery 小部件？我正在寻找类似于 Skype 的东西：

![Skype 小部件](https://i.stack.imgur.com/hFJ2Z.png)

所需功能：

*   良好的可用性。我意识到这很模糊；这就是为什么我想使用经过良好测试的东西，而不是自己编写。
*   用户可以直接输入号码 (+373 22 717171)。
*   用户可以选择一个国家（摩尔多瓦），小部件会自动填写国家代码（+373），并让用户输入其余的数字。
*   开发人员可以通过编程方式获取/设置国家代码。

（这不是关于验证电话号码的问题。我已经知道如何使用 javascript 版本的 [libphonenumber](http://code.google.com/p/libphonenumber/)来做到这一点。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-08-11T03:52:28.793

这就是你想要的，去掉了一些区域，可以在源代码中找到。 [https://github.com/Bluefieldscom/intl-tel-input](https://github.com/Bluefieldscom/intl-tel-input)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-30T12:42:38.663

我在 JS 和 HTML 中创建了一个简单的小部件，它接受国际电话号码。

*   易于插入您的代码*   适用于 iphone、ipad 和 android 手机*   重量很轻*   用于渲染国家标志的 CSS 精灵——因此对页面加载性能没有负面影响

您可以根据自己的喜好更改 UI。
获取源码：[国际电话小部件-github](https://github.com/deep7686/telephone-widget)
签出demo- [Demo](http://icslabs.in/demos/telephone-widget/)

# javascript - 添加小数点 - Javascript

> ID：16047664
> 
> 赞同：1
> 
> 时间：2013-04-16T21:44:44.437
> 
> 标签：javascript, forms

我开发了一个代码，其中添加值，最后根据您在表单中选择的项目减去最小值。大部分代码都很好用，但是当它显示总数时我遇到了问题。当我的值为 7.25 时，它可以正常工作，但如果它是一个整数，它只会显示 5。我希望它显示 5.00。有什么建议吗？

```
<script language="JavaScript"> 

// All selected prices are stored on a array
var prices = [];

// A function to remove a item from an array
function remove(array, item) {
    for (var i = 0, len = array.length; i < len; i++) {
        if (array[i] == item) {
            array.splice(i, 1);
            return true;
        }
    }
    return false;
}

function calculateSectedDues(checkbox, amount) {
    // We add or remove the price as necesary

    if (checkbox.checked) {
        prices.push(amount);
    } else {
        remove(prices, amount);
    }

    // We sum all the prices
    var total = 0;
    for (var i = 0, len = prices.length; i < len; i++)
        total += prices[i];

    // We get the lower one
    var min = Math.min.apply(Math, prices);

    if(min == Infinity) { min = 0; }

    // And substract it
    total -= min;

    // Please, don't access the DOM elements this way, use document.getElementById instead
    document.grad_enroll_form.total.value = total;

}

</script> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T21:46:43.540

可以使用 JS 的`toFixed()`方法：

```
var min = 2;
min.toFixed(2); // returns 2.00 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T22:05:51.337

```
if(parseInt(total) == total){
    total += ".00";
} 
```

或简短的 if 表示法：

```
total = parseInt(total) == total ? total + ".00" : total 
```

# java - GCM 字符串而不是布尔值

> ID：16047669
> 
> 赞同：2
> 
> 时间：2013-04-16T21:44:59.237
> 
> 标签：java, android, json, boolean, google-cloud-messaging

我收到了来自 GCM 的消息，但我得到的是字符串而不是布尔值。我的 JSON 数组似乎有问题。我收到警告信息：

```
04-17 00:41:04.058: W/Bundle(6702): Key alarm expected Boolean but value was a java.lang.String.  The default value false was returned.
04-17 00:41:04.058: W/Bundle(6702): Attempt to cast generated internal exception:
04-17 00:41:04.058: W/Bundle(6702): java.lang.ClassCastException: java.lang.String
04-17 00:41:04.058: W/Bundle(6702):     at android.os.Bundle.getBoolean(Bundle.java:786)
04-17 00:41:04.058: W/Bundle(6702):     at android.content.Intent.getBooleanExtra(Intent.java:3282)
04-17 00:41:04.058: W/Bundle(6702):     at com.rolandas.lookup.GCMIntentService.onMessage(GCMIntentService.java:71)
04-17 00:41:04.058: W/Bundle(6702):     at com.google.android.gcm.GCMBaseIntentService.onHandleIntent(GCMBaseIntentService.java:223)
04-17 00:41:04.058: W/Bundle(6702):     at android.app.IntentService$ServiceHandler.handleMessage(IntentService.java:59)
04-17 00:41:04.058: W/Bundle(6702):     at android.os.Handler.dispatchMessage(Handler.java:99)
04-17 00:41:04.058: W/Bundle(6702):     at android.os.Looper.loop(Looper.java:130)
04-17 00:41:04.058: W/Bundle(6702):     at android.os.HandlerThread.run(HandlerThread.java:60) 
```

PHP 发送脚本。

```
 $devices = array();
   $data = array();
   array_push($devices, getRegId($user_id, $mysqli));
   $data = array("alarm" => true);

   SendGCM(true, $devices, $data); 
```

JSON消息：

```
{"registration_ids":["APA91bFjtwqq2q5Ji88JjLjuivAzNVGxLDYXaIahCeRUOmaD6vb0T5C22uQSlygztpq_KsVGCZ-0TKQTqUsmp0PU4FXjKYfdsfsdfaxRM1gQ7oh5xHf576-JwQ9FuItsBvhQeQmiKoX3UIi0s3onBh9vO7wI3_Pvw"],"data":{"alarm":true}} 
```

最后是我的 OnMessage 方法：

```
@Override
    protected void onMessage(Context context, Intent intent) {

        boolean alarm = false;

        alarm = intent.getBooleanExtra("alarm", false);

    } 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-17T11:26:34.800

到您收到消息时，它是一个字符串，引用了[Google 在线文档](http://developer.android.com/google/gcm/gcm.html)在“**发送消息”下的请求格式**“数据”部分：

> 这些值可以是任何 JSON 对象，但我们建议使用字符串，因为无论如何这些值都会在 GCM 服务器中转换为字符串。如果要包含对象或其他非字符串数据类型（如整数或布尔值），则必须自己转换为字符串。

# asp.net-mvc - 用于restful api的MVC .net

> ID：16047676
> 
> 赞同：2
> 
> 时间：2013-04-16T21:45:29.453
> 
> 标签：asp.net-mvc

我更熟悉 Java 技术，并且我正在运行一个项目，我需要在后端使用 .Net 框架。该项目的目标是公开一个处理任何请求类型 PUT、POST、GET、DELETE 的公共 api。有效负载将仅采用 JSON 格式。后端将与同样用 .Net 编写的数据库和第三方库进行交互。

.Net 中最适合此的技术是什么。是带有 C# 的 Asp.Net。人们是否会推荐其他框架（例如 Spring.Net。此外，.Net 3 和 4 似乎有不同的版本。所有版本对于此类项目是否同样有效。

最后，人们在 .Net 环境中用于开发、测试单元和进行集成测试的工具是什么。

谢谢你肯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T21:53:26.317

查看用于构建 RESTful 服务的[WebAPI](http://www.asp.net/web-api)，以及 ASP.NET MVC 4 和 C#。如果您能够使用它们，我会推荐 Visual Studio 2012 和 .NET Framework 4.5。

.NET 空间中有多种测试框架（包括 MSTest、NUnit 和 xUnit）和 Moq 等隔离框架。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-16T21:54:02.080

ASP.NET Web API 允许您创建 RESTful 服务并使用 JSON 数据。普通的 ASP.NET MVC 还允许您在客户端和服务器之间发送 JSON，但未来是 Web API。您可以使用普通的 ASP.NET（Web 表单）或 ASP.NET MVC，MVC 可以让您更好地组织表示逻辑，而且非常棒。当您将 Web API 与 ASP.NET MVC 一起使用时，Web API 将负责处理您的数据，而您的 asp.net MVC 将负责提供您的视图。有大量关于 ASP.NET MVC 和 Web API 的材料，所以我不会在这里发布任何内容。最后，如果您希望您的应用程序更具交互性并专注于良好的用户体验，那么您可以将尽可能多的 AJAX 集成到您的应用程序中，甚至更好地利用 javascript 框架（例如 knockout）来创建高度响应的 UI。这是一篇关于使用的好文章[带有 Knockout.js 的 Web API](http://blogs.msdn.com/b/amar/archive/2012/12/12/hello-world-with-knockout-js-and-asp-net-mvc-4.aspx)。对于有抱负的 asp.net MVC 开发人员来说，这也是[一本必读的书](http://www.amazon.co.uk/Pro-NET-Edition-Professional-Apress/dp/1430242361)。本书简要介绍了使用 Visual Studio 和 Moq 进行单元测试以及使用 Ninject 进行依赖注入，但是很好，您可以使用[Qunit](http://qunitjs.com/)对 javascript 进行单元测试，尽管它与 .NET 没有任何关系。

# r - RStudio 项目功能

> ID：16047679
> 
> 赞同：11
> 
> 时间：2013-04-16T21:45:49.910
> 
> 标签：r, rstudio

我开始使用 RStudio，并找到了创建项目的选项，根据[rstudio.com](http://www.rstudio.com) ，它使您能够“将工作划分为多个上下文，每个上下文都有自己的工作目录、工作区、历史记录和源文档” 。

项目是否仅用于包开发？如果没有，您能否向我展示任何其他典型情况，其中上面编写的功能可以让您在正常工作空间中完成不可能（或更难）的事情（除了版本控制）？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-16T22:32:14.177

项目在几个方面都很方便。

1.  您提到了版本控制。即使你一个人工作，它也很有用，它也可以用于文本文件，例如，如果你使用 markdown/knitr/Sweave 组合（请参阅 Reproducible Research）。我使用 Git 和 Dropbox 来跟踪我的代码和报告进度。

2.  每个项目都有自己的工作目录。您可以在裸 R 中实现这一点，但 R Studio 会自动管理它。

3.  您的工作区也是如此，每个项目都有一个单独的项目。

4.  您在重新加载的项目中打开的源文件将自动打开。

基本上，如果您必须处理多个项目，那么项目很有用。您可以在它们之间快速切换，并获得相同的工作区、工作目录，这意味着加载的对象和历史记录。就好像你从来没有换过一样。没有项目也不是不可能做到这一点，但它不那么方便，这是你的问题。

# python - 如何优雅地从列表中剪掉不同长度的尾巴？

> ID：16047683
> 
> 赞同：5
> 
> 时间：2013-04-16T21:45:57.583
> 
> 标签：python

我对 Python 很陌生，这是一个相当基本的问题。

我有一个列表`lst`，并在某个时候计算了一个整数`n`，`0<=n<=len(lst)`它告诉我（出于手头的目的）我应该丢弃`n`列表的最终元素。想到实现这一点的语句是`del lst[-n:]`或者可能`lst[-n:]=[]`（我发现在任何一种情况下`0`，在冒号之后添加都不是一个好主意，因为零不被认为大`-n`于此设置）。然而，两个变体在 时都失败了`n==0`，因为列表被完全清空了。我真的应该在这里插入一个明确的零测试，还是弯下腰来写

```
del lst[len(lst)-n:] 
```

还是可以在这里做一些更优雅（和可靠）的事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T12:16:49.510

在考虑了建议的其他可能性后，我得出结论

```
del lst[len(lst)-n:]  # do not remove the len(lst) since n==0 is possible ! 
```

尽可能干净。的计算`len(lst)`可能不是很漂亮，但它所代表的成本可以忽略不计。

*很久以后补充：*这里的问题源于这样一个事实，即索引表达式的解释为“从右数”的边界，是由表达式的运行时值（即它是负数）动态确定的，以及事实值 0 已被用作指示最左边的边界，不能也表示最右边的边界。如果特征是从*句法*特征中确定的，那么完全有可能在没有明确算术的情况下指定`i`从右边开始的边界，其中`i`很可能是 0。不可能编写一个表达式，其中某些绑定有时从左侧解释，有时从右侧解释，具体取决于运行时状态，但无论如何，这是一个几乎不想做的事情。

# .net - 安装 VS2012 后 Web 项目未加载

> ID：16047684
> 
> 赞同：0
> 
> 时间：2013-04-16T21:45:59.387
> 
> 标签：.net

我已经安装了 Visual Studio 2012 终极版，我正在尝试打开我的一位同事使用 2012 构建的现有解决方案。加载除 Web 项目之外的所有其他项目。我得到的错误是

D:\Projects\WebUI.vbproj：错误：Web 应用程序项目 WebUI 配置为使用 IIS。无法访问 IIS 元数据库。您没有足够的权限访问您机器上的 IIS 网站。

我没有明确安装任何版本的框架。如果有人遇到此问题，请告诉我解决方案。

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T22:31:35.303

通过以管理员身份运行我的 VS2012 来解决它。谢谢。

# matlab - 在单个变量上集成多变量函数而不定义新函数

> ID：16047694
> 
> 赞同：0
> 
> 时间：2013-04-16T21:46:43.180
> 
> 标签：matlab, integration

我有一个函数 f = @(x,y,z) ...我想用给定的 y 和 z 数值对 x 执行有限数值积分。

目前，我这样做如下 -

```
f2 = @(x) f(x,5,10)
integral(f2,-1,1) 
```

（5 和 10 实际上只是一些在程序过程中假定某些值的 y 和 z）。

我的问题如下 -

因为我必须对 (y,z) 的许多值进行积分（通常在循环中）。每次，我都必须重新定义一个函数。这大概使我的程序非常慢。有没有更优化的方法来做这个操作，我不必不断地重新定义我的功能。我需要程序运行得更快。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T01:12:13.443

匿名函数很慢。重写`f`和`f2`嵌套函数怎么样？例如：

```
function result = iterate_trough(A, B)

        result = 0;
        for a = 1:2:A, for b = 5:5:B
                result = result + quad(@f2,-1,1);
        end; end;

        function r  = f(x,y,z),  r  = x+y+z;     end
        function r2 = f2(x),     r2 = f(x,a,b);  end
end 
```

这会降低代码的灵活性吗？

**稍后编辑：**甚至更好，消除调用的开销`f`：

```
function result = iterate_trough(A, B)

        result = 0;
        for a = 1:2:A, for b = 5:5:B
                result = result + quad(@f2,-1,1);
        end; end;

        function r2 = f2(x),  r2 = x+a+b;  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T04:37:48.107

I was able to speed up some looping code (an MCMC) with many integrals using the composite Simpson's method detailed in "Writing Fast Matlab Code" available at the File Exchange:

[http://www.mathworks.com/matlabcentral/fileexchange/5685](http://www.mathworks.com/matlabcentral/fileexchange/5685)

From the document, here is a one dimensional integration as an example:

```
h = (b − a)/(N−1);
x = (a:h:b).';
w = ones(1,N); w(2:2:N−1) = 4; w(3:2:N−2) = 2; w = w*h/3; 
I = w * f(x); 
```

The document shows 2 and 3d examples as well.

As a downside, the code forgoes some of the adaptive step size in some of the built-in quadrature methods. However, this method is so blazingly fast, I was able to just brute-force integrate to such a high precision that this isn't an issue. (My integrals are all relatively tame, though.)

Hope this helps.

# ruby-on-rails-3 - 在 Controller#create 中找不到没有 ID ActiveRecord::RecordNotFound 的列表

> ID：16047696
> 
> 赞同：0
> 
> 时间：2013-04-16T21:46:45.163
> 
> 标签：ruby-on-rails-3, activerecord

我有一个名为 Listings 的资源和一个名为 email 的资源

列表 has_many :emails email belongs_to :listing

我正在尝试将列表 ID 传递给 email.listing_id 但我不断收到此错误：

```
Couldn't find Listing without an ID ActiveRecord::RecordNotFound in EmailsController#create 
```

这是我的代码：

```
class EmailsController < InheritedResources::Base
    def new
        @listing = Listing.find(params[:listing_id])
        @email = Email.new

    end

    def create
        @listing = Listing.find(params[:listing_id])
        @email = Email.new(params[:email])

    end 
```

从我的列表显示页面我传递了listing.id

```
<%=link_to "Email Listing", new_email_path(:listing_id => @listing.id) 
```

电子邮件_form

```
 <%= f.input :email %>
  <%= f.input :message %>
  <%= f.hidden_field :listing_id, :value => @listing.id %>
  %= f.button :submit, :value=> "Send Email" %> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T20:07:06.703

请查看此帖子以获得答案：

[找不到没有 ID 的列表](https://stackoverflow.com/questions/16068311/couldnt-find-listing-without-an-id)

问题是我的参数是这样的：

```
"email"=>{"email"=>"xyz@z.com",
 "message"=>"hello",
 "listing_id"=>"3"},
 "commit"=>"Send Email"} 
```

只是改变

```
@listing = Listing.find(params[:listing_id]) 
```

至

```
@listing = Listing.find(params[:email][:listing_id]) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T00:58:39.140

我不明白你的`@listing = Listing.find(params[@email.listing_id])`，因为你已经有了你想要的`@email`变量ID，你可以避免再次使用参数，尝试类似： `@listing = Listing.find(@email.listing_id)`

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-16T23:33:37.047

我很确定这是因为您为“新”操作创建了视图，并且在尝试进入页面时您没有任何参数，所以基本上您正在执行*'Listing.find(nil)'*。

如果没有，请尝试打印 params 的值，并检查 listing_id 丢失的位置。

# symfony - 如何使用 Symfony 标准安装 CRUD 包。使用 NetBeans 的供应商 2.2 和 Windows

> ID：16047699
> 
> 赞同：-1
> 
> 时间：2013-04-16T21:47:07.150
> 
> 标签：symfony, netbeans, installation, bundle, symfony-2.2

我想安装捆绑包：http:
[//knpbundles.com/sacho/CrudGen](http://knpbundles.com/sachoo/CrudGen)

我使用：
NetBeans 7.3 成功配置 Symfony 标准供应商 2.2
Windows 8
Wamp Server 2.2

任何人都可以指导我如何逐步安装该捆绑包我是该主题的完整初学者，不理解网络上提供的示例，也许其中很多是针对 Symfony 的 2.1 或 2.0 版本，与最新版本 2.2 不同。

我试图在 NetBeans>Symfony>Run 命令中找到与该主题相关的任何命令，但没有找到任何可以执行此操作的命令。
我要手动修改一些 Symfony 文件吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T11:04:08.543

对于所有像我一样不熟悉该主题的人来说，这里是一个很棒的分步安装过程教程：

[在 Windows 上安装 Symfony 2 开发环境](http://0hlsson.se/2012/10/20/install-symfony-2-development-environment-on-windows-part-1-installing-git/)按照它，然后

不要删除放置在根目录中的 composer.json 文件的内容您的项目 - 需要为您将来可以更新的所有已安装组件定义捆绑包和依赖项的版本。
只需在 require 列表中添加：

“sacho/crudgen-bundle”：“dev-master”

注意该列表中的所有项目行都以逗号“，”结尾，但不是最后一个。composer.json 的示例需要有效的部分：

```
"require": {
    "php": ">=5.3.3",
    "symfony/symfony": "2.2.*",
    "doctrine/orm": "~2.2,>=2.2.3",
    "doctrine/doctrine-bundle": "1.2.*",
    "twig/extensions": "1.0.*",
    "symfony/assetic-bundle": "2.1.*",
    "symfony/swiftmailer-bundle": "2.2.*",
    "symfony/monolog-bundle": "2.2.*",
    "sensio/distribution-bundle": "2.2.*",
    "sensio/framework-extra-bundle": "2.2.*",
    "sensio/generator-bundle": "2.2.*",
    "jms/security-extra-bundle": "1.4.*",
    "jms/di-extra-bundle": "1.3.*",
    "sachoo/crudgen-bundle": "dev-master"
}, 
```

在 cmd.exe 窗口中运行命令：

```
composer update sachoo/crudgen-bundle 
```

用于安装 sahoo/crudgen-bundle 或

```
composer update 
```

用于更新所有捆绑包并在这种情况下安装缺少的捆绑包“sahoo/crudgen-bundle”

# css - SASS 使用变量列表在 mixin 中填充参数

> ID：16047702
> 
> 赞同：1
> 
> 时间：2013-04-16T21:47:24.880
> 
> 标签：css, sass

我正在本地为项目特定的线性渐变构建一个 mixin。这个想法是我有 6 种不同的渐变方案正在进行中。我正在尝试从变量传递参数的所有值。不确定我是否超出了 SASS 现在支持的范围。此外，所有 3 个文件都位于单独的文件中，这些文件被导入到主站点 scss 文件中。

任何指导将不胜感激。

```
$gradientBlue: #68bafa, #279bf2, #2891e2;

@mixin verticalGradient($color-1, $color-2, $color-3: "", $color-4: "", $color-5: "" ) {
  background: $color-1;
  @include pie;
  @include filter-gradient($color-1, $color-2);  
  @include background-image(linear-gradient(top, $color-1 0%, $color-2 100%));
  @if #{$color-3} != none {
    text-shadow: 1px 1px 1px #{$color-3};
  }
  @if #{$color-4} != none {   
    &:hover {
      @include pie;
      background: $color-4;
      text-shadow: 1px 1px 1px $color-5;
    } 
  }
}

@include verticalGradient($gradientBlue); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T23:54:11.597

当然。尝试这样的事情：

```
$gradientBlue: #68bafa, #279bf2, #2891e2;

@mixin vertical-gradient($colors) {    
  @include background(linear-gradient(nth($colors, 1), nth($colors, 2)));
  @if length($colors) >= 3 {
    text-shadow: 1px 1px 1px nth($colors, 3);
  }
  @if length($colors) >= 4 {
    background: nth($colors, 4);
  }
}

body {
  @include vertical-gradient($gradientBlue);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-31T13:28:24.117

我有一个类似的问题，我写了一个 mixin，它应该将一个参数列表分配给一个 compass mixin。这是我的解决方案（使用指南针 0.12.2）：

```
@mixin single-box-shadow-fallback( $color, $arg... ) {
  @include single-box-shadow( $color, $arg... );
    .lt-ie9 & {
      border: 1px solid $color;
    }
  }
} 
```

称呼

```
@include single-box-shadow-fallback( #CCC, 0, 0, 2px, 0, true ); 
```

* * *

这些示例输出错误的 css；

```
@mixin single-box-shadow-fallback( $color, $arg ) {
  @include single-box-shadow( $color, $arg );
} 
```

输出：

```
 box-shadow: 0, 0, 2px, 0, true 0px 5px #cccccc; 
```

# ios - 运行此脚本后 NSUserDefaults 将不起作用

> ID：16047705
> 
> 赞同：0
> 
> 时间：2013-04-16T21:47:33.230
> 
> 标签：ios

我试图使用以下脚本重置 NSUserDefaults standardUserDefaults，现在无论我做什么，我都无法让 NSUserDefaults 在我的 iPhone 上工作。

```
NSString *appDomain = [[NSBundle mainBundle] bundleIdentifier];
[[NSUserDefaults standardUserDefaults] removePersistentDomainForName:appDomain]; 
```

该脚本是在使用我的 iPhone 测试应用程序时运行的。尽管如此，NSUserDefaults 在使用模拟器运行时正在工作。这是因为我在使用模拟器运行之前删除了脚本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T21:51:50.070

停止在 Xcode 中运行。然后从 iPhone 中删除该应用程序。都修好了！

# ruby-on-rails - 如何使用 rspec 测试范围

> ID：16047706
> 
> 赞同：1
> 
> 时间：2013-04-16T21:47:34.997
> 
> 标签：ruby-on-rails, rspec, scope

这些是我的 Cashout 模型的一些代码。我可以使用 rspec 测试所有模型，但我不知道如何测试这些范围。

**提现.rb**

```
class Cashout < ActiveRecord::Base

belongs_to :partner

scope :add_virtual_columns, select(
    "cashouts.*,
    ( SELECT SUM(c.amount) FROM cashouts c WHERE c.partner_id = cashouts.partner_id) as total_paid_amount,
    (
      (
      CASE
        WHEN (SELECT partner_type FROM partners WHERE cashouts.partner_id = partners.id) = 'administrator'
        THEN
          (
            CASE 
                WHEN ( SELECT SUM(cr.partner_profit) FROM contact_records cr WHERE cr.partner_id in (SELECT id FROM partners WHERE company_id in (SELECT company_id FROM partners WHERE id = cashouts.partner_id))) IS NULL
                THEN 0 
                ELSE ( SELECT SUM(cr.partner_profit + cr.company_profit) FROM contact_records cr WHERE cr.partner_id in (SELECT id FROM partners WHERE company_id in (SELECT company_id FROM partners WHERE id = cashouts.partner_id)))
            END
            )
        ELSE
          (
          CASE 
            WHEN ( SELECT SUM(cr.partner_profit) FROM contact_records cr WHERE cr.partner_id = cashouts.partner_id) IS NULL
            THEN 0 
            ELSE ( SELECT SUM(cr.partner_profit) FROM contact_records cr WHERE cr.partner_id = cashouts.partner_id)
          END
          )
      END
      )
      -
      ( SELECT SUM(c.amount) FROM cashouts c WHERE c.partner_id = cashouts.partner_id)
    ) as unpaid_amount"
  ).group('cashouts.id')
  scope :sort_by_total_paid_amount_asc, order("total_paid_amount ASC")
  scope :sort_by_total_paid_amount_desc, order("total_paid_amount DESC")
  scope :sort_by_unpaid_amount_asc, order("unpaid_amount ASC")
  scope :sort_by_unpaid_amount_desc, order("unpaid_amount DESC")
end 
```

您知道如何使用 rspec 和 factorygirl 测试这些示波器吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2020-02-15T21:56:21.053

大致猜测您的模式，您首先必须为所有部分及其关联设置工厂。这是一个粗略的轮廓。您必须使用有效值填写它们的其他属性。

[Faker](https://github.com/faker-ruby/faker)对于填写有效数据非常有用。

```
factory :company do
end

factory :partner do
  company
end

factory :contact_record do
  partner
end

factory :cashout do
  partner
  total_paid_amount { Faker::Number.digit }
end 
```

测试排序范围很容易。制作一系列不同金额的提款，按照您的预期对它们进行排序，然后看看您是否可以取回。

我们的工厂已经设置好给我们随机的total_paid_amounts 兑现。我们只需要创建它们的列表。

```
context 'with cashouts' do
  let(:cashouts) {
    create_list(:cashout, 3)
  }

  describe '.sort_by_total_paid_amount_asc' do
    it 'sorts by total_paid_amount in ascending order' do
      expect(
        Cashout.sort_by_total_paid_amount_asc.to_a
      ).to eq cashouts.sort_by(&:total_amount_paid)
    end
  end

  describe '.sort_by_total_paid_amount_desc' do
    it 'sorts by total_paid_amount in descending order' do
      expect(
        Cashout.sort_by_total_paid_amount_desc.to_a
      ).to eq cashouts.sort_by(&:total_amount_paid).reverse
    end
  end
end 
```

我避免按顺序生成提款。这将使它们按顺序排列在表中，并且它们的默认排序可能符合我们的预期。

尽管我质疑这种字面意思和微不足道的作用域的价值。它们很容易编写`Cashout.order(total_paid_amount: :asc)`，不需要测试。

* * *

测试`add_virtual_columns`......`add_virtual_columns`是一个糟糕的名字。似乎它正在添加一个列，`unpaid_amount`. 我会调用它`with_unpaid_amount`。

`with_unpaid_amount`更复杂，因为它非常复杂并且需要更多的测试数据。幸运的是，我们在工厂里建立了我们的关系。

首先，我们设置我们的对象，使它们共享同一个伙伴。有几种方法可以做到这一点，但我选择生成伙伴并传递它。这使得修改每个对象以测试不同的场景变得更加容易。

```
describe '.with_unpaid_amount' do
  let(:partner) {
    create(:partner)
  }
  let(:company) {
    create(:company, partner: partner)
  }
  let(:cashout) {
    create(:cashout, partner: partner)
  }
  let(:contact_record) {
    create(:contact_record, partner: partner)
  } 
```

有了这个，您现在可以更改对象以测试不同的场景。例如，如果合作伙伴是管理员怎么办？

```
 context 'when the partner is an administrator' do
    before {
      partner.update!(partner_type: 'administrator')
    }

    it '...'    
  end 
```

依此类推。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T22:45:52.350

我倾向于创建一些测试数据并将范围结果与您期望的结果进行比较。FactoryGirl 可以帮助您创建基础`Cashout`模型，您可以在其上覆盖`amount`and `partner_id`，然后生成相应的`Partner`and`ContactRecord`模型。

对于后一个范围，您可以执行类似的操作

```
Cashout.sort_by_total_paid_amount_asc.to_sql.should == \ 
Cashout.order('total_paid_amount ASC').to_sql 
```

# php - 在 .htaccess 文件中隐藏文件扩展名 (.php)

> ID：16047707
> 
> 赞同：0
> 
> 时间：2013-04-16T21:47:54.843
> 
> 标签：php

我知道有很多话题。我尝试了很多次，但它不起作用。

### 我想要什么？

而不是`example.com/en/file.php`，用户只看到`example.com/en/file`。

### 我的[.htaccess 文件](https://en.wikipedia.org/wiki/.htaccess)：

```
DirectoryIndex index.php index.html

RewriteEngine on
*RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.php -f
RewriteRule ^(.*)$ /$1.php*

ErrorDocument 404 /index.php

RewriteCond %{HTTP_HOST} ^example\.com$ [OR]
RewriteCond %{HTTP_HOST} ^www\.example\.com$
RewriteRule ^ru\/index\.php$ "http\:\/\/example\.com\/ru\/" [R=301,L]

RewriteCond %{HTTP_HOST} ^example\.com$ [OR]
RewriteCond %{HTTP_HOST} ^www\.example\.com$
RewriteRule ^en\/index\.php$ "http\:\/\/example\.com\/en\/" [R=301,L] 
```

*等每种语言*

1.  我必须添加什么来隐藏扩展程序？

2.  在它工作之后，我应该使用页面之间的链接作为“file.php”还是只使用“file”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T21:53:09.487

也许是这样的。根据您的需要进行修改以进行更具体的模式匹配。

```
RewriteRule ^(?:(.*)/)?(.*)$ $2.php?lang=$1 
```

重写：

/en/fun => /fun.php?lang=en

/ru/fun => /fun.php?lang=ru

/fun => /fun.php?lang=

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T21:56:31.150

```
DirectoryIndex index.php index.html    

RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.+)$      $1.php     [L,QSA] 
```

在您的链接中，不要使用扩展名。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T07:02:39.197

通过添加一行来修复：

```
RewriteEngine on
**Options -Multiviews**
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.+)$      $1.php     [L,QSA] 
```

# php - 如何知道用户提交表单的确切时间

> ID：16047712
> 
> 赞同：0
> 
> 时间：2013-04-16T21:48:13.230
> 
> 标签：php, javascript, security, latency

我们正在构建一个带有单独计时问题的在线测试。问题是用户必须在预定秒数内完成的一系列表格。尽管用户会在每个问题上看到一个 javascript 时钟，但时间限制的实际*执行*必须发生在服务器端（否则用户很容易禁用/修改时间限制）。但是，我们担心网络延迟会不公平地惩罚在接近时间限制结束时提交答案的用户，延迟时间足够接近以使他们在时间限制内做出响应。

当我们在服务器收到答案时检查持续时间时，草率的解决方案似乎只允许几秒钟的“宽限期”，但这有点蹩脚。**是否有一种安全的方法可以准确地确定用户何时单击“提交”。**

如果重要的话，Web 应用程序是用 PHP 编写的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T21:53:15.953

我之前实际上不得不处理这个问题。我们最终做的是标记页面请求的时间，并使用来自浏览器的 javascript ajax 请求（加载时）来确定往返时间。平均起来，它最终代表了他们的网络延迟/计算机速度，非常好。

显然，如果它超过 15-20 秒，你就会遇到更大的问题，但我们看到的最多的是 3-4 秒。

然后，您可以将其用于“公平”评估实际花费了多少时间。

# c - 如何知道在 OS/X 中启动可执行文件的目录？

> ID：16047713
> 
> 赞同：1
> 
> 时间：2013-04-16T21:48:21.263
> 
> 标签：c, macos, directory, main, finder

当`int main(int argc, char* argv[])`从 Finder 启动以传统风格编写的 C 程序时，它会在启动它的用户的主目录中启动。（例如*/Users/Fork*）。

有没有什么花哨的钩子可以让这样一个基于终端的程序知道它是在哪个目录中启动的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T21:53:06.923

您可以通过 获取程序二进制图像的完整路径[`_NSGetExecutablePath`](https://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man3/dyld.3.html)。使用 eg 规范化，[`realpath`](https://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man3/realpath.3.html)然后使用 eg 去掉文件名[`dirname`](https://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man3/dirname.3.html)，你就有了程序启动的目录。

# java - 从所有线程中捕获异常？

> ID：16047714
> 
> 赞同：0
> 
> 时间：2013-04-16T21:48:25.433
> 
> 标签：java, eclipse, debugging

最近我在我的[`Task`](http://docs.oracle.com/javafx/2/api/javafx/concurrent/Task.html)一个程序中使用了一个。基本上可以说包含在其中的代码`Task`是在另一个线程中执行的。该线程中引发了异常，但是我从未注意到这一点，因为 Eclipse 没有显示它（至少在控制台中没有）。

那么，如何确保我了解所有线程的异常？

感谢您对此的任何提示！

**更新：**我想知道是否有一种不涉及代码修改/改编的方法——因为人们很容易忘记这一点。Eclipse中的任何设置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-10T23:51:32.100

如果说

> 我想知道是否有一种不涉及代码修改/改编的方法——因为人们很容易忘记这一点。

你的意思是，你可能忘记为每个线程编码/设置它，那么情况并非如此。

```
Thread.setDefaultUncaughtExceptionHandler 
```

是一个静态方法，因此您只需为整个 java 应用程序设置一次。任何线程上的任何未捕获的异常都将在该方法中结束。

[http://docs.oracle.com/javase/7/docs/api/java/lang/Thread.UncaughtExceptionHandler.html](http://docs.oracle.com/javase/7/docs/api/java/lang/Thread.UncaughtExceptionHandler.html)

# python - 杀死一个带有套接字的线程（python）

> ID：16047717
> 
> 赞同：1
> 
> 时间：2013-04-16T21:48:32.783
> 
> 标签：python, multithreading, sockets

我对此很陌生。我正在尝试构建一个服务器（聊天服务器）抱歉提供了这样一个混乱的代码。关于这段代码，我要改变很多事情。但到目前为止，我只需要一件事的帮助：

当我开始让我们对此多说一个……然后关闭客户端时，我收到以下消息：

线程中未处理的异常由

正如您在这段代码的许多地方看到的那样，我试图杀死线程。但我不知道我做错了什么..我是新手。关于我应该做什么的任何建议？

```
#encoding: utf-8

import socket, random, time, thread, errno, traceback

print socket.gethostname()
print "current machines IP address: "+socket.gethostbyname(socket.gethostname())

host ="10.0.0.1"# raw_input("IP: ")
# = socket.gethostbyname(socket.gethostname())
port = 12345

print host

conn_list =[None]*10
sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
sock.bind((host, port))
sock.listen(10)

print "connected..\n\n\n\n"

def recv(conn):
    while True:
        try:
            message = conn.recv(1024)
            if "MESG" == message[1:5]:
                message = message[6:].split(':')
                name = str(conn)
                conn_number = conn_list.index(conn)
                conn_name = str(conn_number)
                message = message[2]
                reciever = message[0:1]
                reciever = int(reciever)
                for conn in conn_list:
                    if reciever == conn_list.index(conn):
                        conn.send(message)
                        print "Connection   "+conn_name+"  ----->  "+str(reciever)+"   :"+message+"\n"
                        #conn = findTheRightConnection(conn_list, conn_number)
                        break
                    else:
                        pass

        except ValueError:
            print "ValueError by %s" % (str(conn))
            print conn.send("\nOpps you are not typing the correct connection number infront  your message!")

        except IOError:
            bye(conn,conn_list)
            print"Going to try to kill the thread here "
            thread.quit()
            thread.isAlive()
            print "Still alive..."

        except socket.error, v:
            errorcode=v[0]
            bye(conn,conn_list)
            print"Going to try to kill the thread or here"
            thread.quit()
            thread.isAlive()
            print "Still alive..."

        except Exception, e:
            traceback.print_exc()

        finally:
            thread.isAlive()
            print"\nChanging the conn back to what it was... "
            conn = findTheRightConnection(conn_list, conn_number)

def handle_connection(conn):
    try:
        recv(conn)

    except socket.error, v:
        errorcode=v[104]
        bye(conn)

def bye(conn,conn_list):
    i= 0
    print "bye"
    connectionName = str(conn_list.index(conn))
    conn.close
    conn_list = conn_list
    print conn_list
    for element in conn_list:
        if element == conn:
            conn_list[i] = None
            break
        i += i
        print "Connection number "+connectionName+" is terminated"
        print conn_list

        return "Connection Terminated"

def welcome(conn,conn_list):
    i = 0
    for element in conn_list:
        if element == None:
            conn_list[i] = conn
            print "Connection added in the conn_list on the slot %d" % (i)
            print conn_list
            return conn_list

        else:
            i = i+1
            pass
    print "The server if full! No more space left"
    return conn_list

def findTheRightConnection(conn_list, number):
    for conn in conn_list:
        if number == conn_list.index(conn):
            return conn
        else:
            pass

        print "\nSomthing went wrong while trying to find the right connection in the method findTheRightConnection()"
        return

while True:
    conn, addr = sock.accept()
    conn_list = welcome(conn,conn_list)
    print "Got connection from : "+str(addr[0])+" by connection number: "+str(conn_list.index(conn))+"\n\n\n\n"     
    msg = "Welcome to the server!"
    conn.send(":INFO:"+str(int(time.time()))+":"+str(len(msg))+":"+msg)
    thread.start_new_thread(handle_connection, (conn,)) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-05T15:42:01.677

如果您仍然无法在 Python 中创建即时消息程序，您可能会对另一个问题的[答案感兴趣。](https://stackoverflow.com/a/13783740/216356)

*   **Simple_Server.py**是一个最小的服务器实现。可以根据要求提供具有多种功能的更复杂的服务器。复杂的服务器支持身份验证、朋友、私人消息传递、频道、过滤器、数学评估和管理控制。
*   **MultichatClient.py**是网络课老师编写的 Java 程序的移植版。该程序必须从命令行运行，并且必须将其作为参数提供给服务器。您可以使用网络上的服务器名称或其 IP 地址。
*   **Simple_Client.pyw**是一个更复杂的客户端，不需要从命令行启动。当它启动时，它会询问服务器的名称并尝试连接它，同时显示一个进度对话框。该程序将自动尝试将任何错误记录到文件中。
*   ****要运行threadbox.py ，** **affinity.py**是必需的。（无论来源如何，在特定线程上运行代码）**
***   **运行safetkinter.py**需要**threadbox.py**。（元类克隆类以使用亲和力运行）*   **Simple_Client.pyw**需要**safetkinter.py**才能运行。（使 tkinter 可以安全地与线程一起使用）**

# assembly - ARM Current Program Status Register (SPSR) read-modify-write策略实践

> ID：16047719
> 
> 赞同：2
> 
> 时间：2013-04-16T21:48:35.827
> 
> 标签：assembly, coding-style, arm, cpu-registers

> 图 2-10 标识为不修改 (DNM)、读为零 (RAZ) 的位不得由软件修改。这些位是：
> 
> • 可读，以使处理器状态得以保留，例如，在进程上下文切换期间
> 
> • 可写，使处理器状态能够被恢复。为了保持与未来 ARM 处理器的兼容性，并且**作为一种良好做法，强烈建议您在更改 CPSR 时使用 read-modify-write 策略**。

但是通过按位运算，您已经可以清楚地定义要更改的位，而无需修改任何意外值，并且可以避免浪费额外的周期。这个推荐的原因是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T22:23:27.683

手册警告您的是不要向 DNM 位写入零（或其他任何内容），假设它们不会被修改 - 这可能是当前处理器实现的情况，但即使今天是这种情况，也可能不是在未来的实施中。

同样，他们似乎保留在未来更改 RAZ 位的权利，因此它们可能并不总是为零，或者向它们写入 1 可能会导致状态发生一些变化，即使重新读取该位仍然读取为零。

另外，请记住，大多数“明确定义要更改的位”的按位操作通常会导致读/写/修改序列。例如，`val |= 0x08;`执行读/修改/写。

# file - PhoneGap在不同文件夹之间复制文件

> ID：16047721
> 
> 赞同：1
> 
> 时间：2013-04-16T21:48:48.687
> 
> 标签：file, cordova, copy, phonegap-build

我正在尝试将一个 jpg 文件从一个文件夹复制到 PhoneGap 中的另一个文件夹中。我使用的方法是fs.download。但是我得到源网址不受支持的错误。这是源文件和目标文件。

```
source = "/var/mobile/Applications/9483756B-8D2A-42C5-8CF7-8D76AAA8FF2C/Shift.app/iqedata/5977e2e9239649d5a7e3b8a54719679f/06e2b8896e51472789fcc27575631f94.jpg";
target = "/var/mobile/Applications/9483756B-8D2A-42C5-8CF7-8D76AAA8FF2C/Documents/memoir/5977e2e9239649d5a7e3b8a54719679f.jpg"; 
```

任何人都可以帮我实现我认为应该是解决这个问题的正确方法吗？我只有源和目标的完整路径。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T08:45:18.463

您想使用 FileEntry 对象的 copyTo 方法：http: [//docs.phonegap.com/en/2.6.0/cordova_file_file.md.html#FileEntry](http://docs.phonegap.com/en/2.6.0/cordova_file_file.md.html#FileEntry)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-03-07T10:25:32.060

使用 copyTo 方法并不总是对我有用，但 moveTo 方法有效。以下代码将文件从 www 文件夹复制到 /Library/LocalDatabase 文件夹：

```
function copyToLocation(dbName){
   console.log("Copying :"+dbName);
   window.resolveLocalFileSystemURL(cordova.file.applicationDirectory+ "www/"+dbName,function (fileEntry)
      {
           window.resolveLocalFileSystemURL(cordova.file.applicationStorageDirectory + "Library/LocalDatabase/",function (directory)

              { 
                 fileEntry.moveTo(directory, 'new_dbname.db',function(){
                    console.log('DB Loaded!');

                    },
                  function()
                  {
                      console.log('Unable to load DB');
                  });
              //},null);
         },null);
    }, null);
} 
```

# c# - .ApplyCurrentValues 抛出异常，说明实体键不匹配

> ID：16047725
> 
> 赞同：0
> 
> 时间：2013-04-16T21:48:56.487
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-2, entity-framework-4, objectstatemanager

这是我得到的例外：

“在 ObjectStateManager 中找不到键与所提供对象的键匹配的对象。验证所提供对象的键值是否与必须应用更改的对象的键值匹配。”

它由下一行表示：

```
public void UpdateTransaction(Transaction transaction)
{
   db.Transactions.ApplyCurrentValues(transaction);
} 
```

我在此页面上读到该错误可能是因为它没有附加，但是当我尝试附加它时，我得到另一个异常：

“一个实体对象不能被多个 IEntityChangeTracker 实例引用。”

通过阅读，这意味着记录已经附加到模型上。

当我尝试分离它时，我得到下一个：

“无法分离对象，因为它未附加到 ObjectStateManager。”

这是我的控制器，我在其中更新表“InputValue”，现在取决于值我还想对表“Transaction”进行更新，这是由 updatedTransactions 函数完成的。

```
 [HttpPost]
    public ActionResult Edit(int id, FormCollection collection)
    {
        var inputValue = inputValueRespository.GetInputValue(id);

        if (inputValue == null)
            return RedirectToAction("Index");

        try
        {
            UpdateModel(inputValue, collection.ToValueProvider());
            inputValue.InputValues_EditUser = WindowsIdentity.GetCurrent().Name;
            inputValue.InputValues_EditDate = DateTime.Today.Date;
            inputValueRespository.UpdateInputValue(inputValue);
            List<Transaction> updatedTransactions = inputValueRespository.HasTransactions(inputValue.Input_ID, inputValue.InputValues_Date, inputValue.InputValues_Week, inputValue.InputValues_Quarter);
            for (int i = 0; i < updatedTransactions.Count; i++)
            {

                transactionRepository.UpdateTransaction(updatedTransactions[i]);
            }
            inputValueRespository.save();
            return RedirectToAction("Create");
        }
        catch (Exception)
        {
            return View("Create");
        } 
```

这是功能：

```
public List<Transaction> HasTransactions(int id, DateTime date, string week, string quarter)
    {
       // random code that decides if transaction should be update
         Transaction transaction = new Transaction();
            transaction = (from a in db.Transactions where a.KPI_ID == kpiId && a.Transaction_Period == period select a).SingleOrDefault(); 
```

// 生成新结果的随机代码

```
 // fill the list of transaction that will be returned         
                transaction.Transaction_Value = result;
                trasactions.Add(transaction);
            }
        }
        return trasactions;
    } 
```

我对此一无所知，任何帮助将不胜感激。

PS：我使用 ApplyCurrentValue 的任何其他代码都可以完美运行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T20:36:11.937

我终于让它工作了（通过反复试验）

最后我需要分离对象，附加它，修改，应用然后保存。

```
db.Transactions.Detach(transaction);
db.Transactions.Attach(transaction);
transaction.Transaction_Value = result;
db.Transactions.ApplyCurrentValues(transaction);
db.SaveChanges(); 
```

没有多大意义，但我想这就是它的工作方式:)

# android - 为下一个活动准备 android web view

> ID：16047727
> 
> 赞同：0
> 
> 时间：2013-04-16T21:48:58.873
> 
> 标签：android, multithreading, android-activity, android-webview

我是一名新的 android 开发人员，我正在尝试弄清楚如何初始化一些活动，以便稍后我希望从任何其他活动（多个活动）中显示它时，它已经被初始化了。让我们假设初始化需要一些时间，这就是为什么我首先要预先初始化活动……活动包含 web 视图中的 web 内容。

问题是初始化应该异步发生，我不想在执行初始化时阻塞 UI，而且一旦活动及其 webview 准备好，我希望能够从主线程调用它们。

实现这一点的正确流程是什么？

谢谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T21:55:16.780

据我所知，您无法准备活动。您应该在 Activity`onCreate()`方法中执行 init 部分。

如果您不想阻止 UI，请在另一个线程中执行异步工作。用于[`AsyncTask`](http://developer.android.com/reference/android/os/AsyncTask.html)此。

# vbscript - VBS 中的 IF 未验证

> ID：16047735
> 
> 赞同：1
> 
> 时间：2013-04-16T21:49:53.027
> 
> 标签：vbscript

我是 VBScript 文件的初学者如果我尝试验证操作系统的版本是 Microsoft Windows XP Professional 还是 Microsoft Windows 7 Professional 我需要帮助如何修复以下代码：

```
set service = GetObject ("winmgmts:")
Dim os_7, os_xp
os_7="Microsoft Windows 7 Professional"
os_xp="Microsoft Windows XP Professional"
for each Process in Service.InstancesOf ("Win32_Process")
    If Process.Name = "notes2.exe"  then
        WScript.Echo "Please Close the Lotus Notes Application and try again"
        WScript.quit
    End If
exit for

next
Set SystemSet = GetObject("winmgmts:").InstancesOf ("Win32_OperatingSystem") 

for each System in SystemSet 

 WScript.Echo System.Caption 
    If System.Caption = os_7 Then

        WScript.Echo "in  7"
    Else If System.Caption = os_xp Then

            WScript.Echo "in XP"
            WScript.quit
        Else 
            WScript.Echo "Is not supported "
        End If
    End If
Exit for
next
} 
```

非常感谢您的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T22:57:22.253

如果您删除代码片段最后一行中的“}”会发生什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-10T18:44:22.120

我用以下内容替换了您的选择案例部分并让它工作。

```
set service = GetObject ("winmgmts:")

for each Process in Service.InstancesOf ("Win32_Process")
    If Process.Name = "notes2.exe"  then
        WScript.Echo "Please Close the Lotus Notes Application and try again"
        WScript.quit
    End If
exit for

next
Set SystemSet = GetObject("winmgmts:").InstancesOf ("Win32_OperatingSystem") 

for each System in SystemSet 
    WScript.Echo System.caption
    If (instr(System.Caption, "Windows 7")) Then
        wscript.echo "Windows 7 found"
    ElseIF (instr(System.Caption, "Windows XP")) Then
        Wscript.echo "Windows xp found."
    Else
        Wscript.echo "Unsuported Operating system."
    End If
Exit for
next 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-21T13:44:10.663

```
strVer = wshShell.RegRead("HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\CurrentVersion")   
arrVer = Split(strVer, ".")

if arrVer(0) = 5 then "XP"
      if arrVer(0) = 6 AND arrVer(1) = 0  then "Vista"
      if arrVer(0) = 6 AND arrVer(1) = 1 then "Win7"
      if arrVer(0) = 6 AND arrVer(1) = 2 then "Win8"
      if arrVer(0) = 6 AND arrVer(1) = 3 then "Win Blue" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-07T01:30:46.493

你可以试试这个

```
 '----------------------------------------------------
  ' CODE BY: zhangbo2012
  ' Email  : zhangbo2012@outlook.com
  ' FROM   : China
  '----------------------------------------------------
  ' WMI:Win32_OperatingSystem
  '----------------------------------------------------
   On error resume next
   Set WMI_Obj = GetObject("winmgmts:\\.\root\cimv2").ExecQuery("Select * from Win32_OperatingSystem", , 48)
   For each obj in WMI_Obj
        wscript.echo " Caption = " & obj.Caption
   Next 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-29T10:12:39.557

此代码经典适用于古老的 SELECT CASE

```
set service = GetObject ("winmgmts:")
Dim os_7, os_xp
os_7="Microsoft Windows 7 Professional"
os_xp="Microsoft Windows XP Professional"
for each Process in Service.InstancesOf ("Win32_Process")
    If Process.Name = "notes2.exe"  then
        WScript.Echo "Please Close the Lotus Notes Application and try again"
        WScript.quit
    End If
exit for

next
Set SystemSet = GetObject("winmgmts:").InstancesOf ("Win32_OperatingSystem") 

for each System in SystemSet 

 WScript.Echo System.Caption
Select Case System.Caption
Case os_7

        WScript.Echo "in  7"
Case os_xp

            WScript.Echo "in XP"
            WScript.quit
Case Else 
            WScript.Echo "Is not supported "
End Select
Exit for
next 
```

# java - Google App Engine Java 和 Android 入门

> ID：16047737
> 
> 赞同：5
> 
> 时间：2013-04-16T21:50:00.473
> 
> 标签：java, android, google-app-engine, google-cloud-messaging

我一直在努力让示例从下面运行：

[https://developers.google.com/eclipse/docs/getting_started](https://developers.google.com/eclipse/docs/getting_started)

我遇到的第一个问题是没有在 Android SDK 中安装“Google Cloud Messaging for Android Library”（显然我知道）。

但现在我对 Android 项目中两个文件中的自动生成代码有疑问：GCMIntentService.java 和 RegisterActivity.java

错误是：

*   未为 Deviceinfoendpoint GCMIntentService.java 类型定义方法 getDeviceInfo(String)
*   未定义 MessageEndpoint RegisterActivity.java 类型的方法 listMessages()
*   未定义类型 Deviceinfoendpoint GCMIntentService.java 的方法 insertDeviceInfo(DeviceInfo)
*   未为 Deviceinfoendpoint GCMIntentService.java 类型定义方法 removeDeviceInfo(String)

我在 Ubuntu 上使用 Java SDK v1.7.0_15，但我也尝试在 Windows 7 上使用 Java SDK v1.6 并遇到同样的问题。最新的 Android 平台 4.2.2 和 Google App Engine 1.7.7。Eclipse 是 Juno Service Release 2。

问题看起来像是他们做错了一些转换，因为在 Deviceinfoendpoint 中有一个方法 getDeviceInfo 用于内部类 DeviceInfoEndpoint （不同的capatilisations）。

我可以尝试修复它，但只是想知道我的设置是否有问题导致这种情况发生？

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T15:40:24.150

在您的 GCMIntentService.java 类中，在出现错误的行中的端点对象之后添加 .deviceInfoEndpoint()，如下所示：

```
DeviceInfo existingInfo = endpoint.getDeviceInfo(registration)
DeviceInfo existingInfo = endpoint.deviceInfoEndpoint().getDeviceInfo(registration) 
```

在 RegisterActivity.java 中更改行

```
messageEndpoint.listMessages().setLimit(5).execute(); 
```

至

```
messageEndpoint.messageEndpoint().listMessages().setLimit(5).execute(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T23:11:21.907

我会确保您使用与 JAR 相同版本的 GCM API。已经进行了相当多的修订。

我将以下代码与 gcm-server.jar 一起使用，以 19718 字节列出。

我成功用于向设备发送 GCM 消息的代码是：

```
public void sendMessage() {
    String notificationToken = mobileDevice.getPushNotificationCode();
    String deviceType = mobileDevice.getDeviceType();

    Sender sender = new Sender(BROWSER_API_KEY);
    Message message = new Message.Builder().addData("message", "blah blah").build();
    String device = "<the key for the device you are sending to goes here>";

    try {
        System.out.println("Sending message...");
        Result result = sender.send(message, device, 5);
        System.out.println("Done sending message");
        if (result.getMessageId() != null) {
            System.out.println("Got message ID: " + result.getMessageId());
            System.out.println("Got error code name: " + result.getErrorCodeName());
            System.out.println("result: " + result);
            String canonicalRegId = result.getCanonicalRegistrationId();
            if (canonicalRegId != null) {
                // Database has more than one record for this device.
                // Replace all of this device's records with this new id
                System.out.println("Got new canonical reg id: " + canonicalRegId);
            }
        } else {
            String error = result.getErrorCodeName();
            if (error.equals(com.google.android.gcm.server.Constants.ERROR_NOT_REGISTERED)) {
                // application has been removed from device - unregister from database
                System.out.println("Got error: " + error);
            }
        }
    } catch (Exception e) {
        e.printStackTrace();
    }
} 
```

# c++ - C++ Hunter/Prey“C2027 未定义类型”编译错误

> ID：16047742
> 
> 赞同：0
> 
> 时间：2013-04-16T21:50:19.257
> 
> 标签：c++, inheritance, undefined

在一个简单的猎人/猎物模拟中，我到处都遇到了奇怪的编译错误（主要是因为教授没有很好地解释继承类和虚函数的语法），我完全陷入了一个问题。`Move()`在这个程序中，“Creatures”（一个带有“Hunter”和“Prey”孩子的抽象类）在一个, `Breed()`,中的一个“Grid”类中走动`Die()`循环

我收到以下错误：“C2027：使用未定义类型'Creature'”和“C2227：'->face'左侧必须指向类/结构/联合/通用类型”在下面指定的行（所有我的代码在标题中，因为有几个学生在另一个项目中得到了未解决的外部问题，教授告诉我们把它全部放在标题中）。如果我需要发布更多代码，请告诉我。

我遇到了其他几个在此之前无法解释的错误，这些错误似乎是通过添加/删除包含的标头和预声明类的看似随机组合来解决的，但是非常感谢对发生了什么问题的实际解释所以在它起作用之前，我不只是在黑暗中挣扎。我了解我们正在尝试做的事情的概念，甚至在很大程度上了解如何去做，但正如我所提到的，我们没有花任何时间在如何正确设置多个文件的语法上，以便每个人工作顺利，因此将不胜感激任何有关如何完成此操作的详细说明。

## 网格.h

```
#ifndef GRID_H
#define GRID_H

#include <iostream>
#include <cstdlib>
#include <cmath>
#include <ctime>
#include "Constants.h"
#include "creature.h"
using namespace std;

class Creature;

class Grid
{
public:
    Creature* grid[MAX_X][MAX_Y];

    Grid() //Initalizes the grid and spawns random creatures
    {
        for(int i = 0; i < MAX_X; i++)
            for(int j = 0; j < MAX_Y; j++)
                grid[i][j] = NULL;

    }

    void Move() //Tells each creature on the grid to move
    {
        //Call creature.Move() on each cell (if not NULL)
    }

    void Breed() //Tells each creature to breed (if it can)
    {
        //Call creature.Breed() on each cell (if not NULL)
    }

    void Kill()  //Tells each creature to die (if it's old)
    {
        //Call creature.Die() on each cell (if not NULL)
    }

    char** Snapshot()  //Creates a char array "snapshot" of the board
    {
        //Produces a 2D char array of the grid for display
    }

    Creature* Get(Coords here)  //Returns a pointer to the object at the specified position
    {
        return grid[here.x][here.y];
    }

    char Occupant(Coords here) //Returns the character of the specified position
    {
        if(!Get(here))
            return FACE_EMPTY;
        Creature* temp = Get(here);
        return temp->face;  //*** ERRORS APPEAR HERE ***
    }

    void Clear(Coords here)  //Deletes the object at the specified position
    {
        if(Get(here))
            delete Get(here);
        grid[here.x][here.y] = NULL;
    }
};

#endif // GRID_H 
```

## 生物.h

```
#ifndef CREATURE_H
#define CREATURE_H

#include <iostream>
#include <cstdlib>
#include <cmath>
#include <ctime>
#include "Constants.h"
#include "coords.h"
#include "grid.h"
using namespace std;

class Grid;

class Creature
{
public:
    Grid* theGrid;
    Coords position;
    int stepBreed;
    int stepHunger;
    char face;

    Creature(Grid* _grid, Coords _position, char _face)  //Constructor
    {
        theGrid = _grid;
        position = _position;
        face = _face;
        stepBreed = stepHunger = 0;
    }

    virtual Coords Move() = 0;  //Allows the child to define it's own movement
    virtual Coords Breed() = 0;  //Allows the child to define it's own breeding
    virtual bool Starve() = 0;  //Allows the child to starve of its own accord
};

#endif // CREATURE_H 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T21:54:51.807

您`class Creature`在文件顶部的使用似乎表明您无权访问`Creature`此文件中的完整定义。这使得编译器无法对其进行`->`操作——它不知道该类的成员是什么！`Creature`您需要在与此代码相同的翻译单元中具有完整的定义。也就是说，`Creature`如果你想以这种方式使用它，需要是一个完整的类型。

编辑：感谢发帖`creature.h`。您的问题（如下面的评论中所述）是您有循环依赖问题。 `creature.h`包括`grid.h`，反之亦然。您需要断开其中一个链接才能正常工作。在这种情况下，删除`#include "grid.h"`from`creature.h`应该可以解决问题 - 没有代码`creature.h`依赖于`Grid`完整的类型。

# google-drive-api - 使用 Google Drive API 下载文件

> ID：16047743
> 
> 赞同：0
> 
> 时间：2013-04-16T21:50:20.527
> 
> 标签：google-drive-api

我正在尝试使用 Python API 从 Google Drive 下载文件。我正在查看文档，我看到一个包含两个 args 的 def，即服务实例和 Drive File 实例。我在*任何地方都*看不到如何创建驱动器文件实例以传递给 def。这应该怎么做？也许我只是在这里不理解一些简单的东西，这也是一个很好的可能性......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T11:03:50.317

我不知道您提到的文档页面，但是为了下载文件，请获取其元数据并向其 downloadUrl 发出经过身份验证的请求。

```
f = service.files().get(fileId=file_id).execute()
resp, content = service._http.request(f.get('downloadUrl')) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-02-15T11:49:39.773

我同意 Burcu 的回答：Google Drive“get”方法只会返回文件的元数据。如果您希望检索文件的内容，则应使用其 downloadUrl 属性下载它，如 Burcu 所示。所以：1\. 获取元数据，2\. 提取 downloadUrl 属性，3\. 使用 http 请求下载。

至于您的问题，“传递给 def 的驱动器文件实例”实际上是根据凭据构建的，例如：

```
 /**
 * Returns the credentials of the user in the session. If user is not in the
 * session, returns null.
 * @param req   Request object.
 * @param resp  Response object.
 * @return      Credential object of the user in session or null.
 */
protected Credential getCredential(HttpServletRequest req,
    HttpServletResponse resp) {
  String userId = (String) req.getSession().getAttribute(KEY_SESSION_USERID);
  if (userId != null) {
    return credentialManager.get(userId);
  }
  return null;
};

/**
 * Build and return a Drive service object based on given request parameters.
 * @param credential User credentials.
 * @return Drive service object that is ready to make requests, or null if
 *         there was a problem.
 */
protected Drive getDriveService(Credential credential) {
  return new Drive.Builder(TRANSPORT, JSON_FACTORY, credential).build();
} 
```

有关完整说明，您可以参考：[https ://developers.google.com/drive/web/examples/java#putting_together_the_pieces_getting_a_complete_set_of_credentials_for_every_request](https://developers.google.com/drive/web/examples/java#putting_together_the_pieces_getting_a_complete_set_of_credentials_for_every_request)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-16T23:20:44.910

您可以考虑尝试 Temboo Python SDK，它包含使用 Google Drive 的简化方法（以及 100 多个其他 API）。看看[https://www.temboo.com/library/Library/Google/Drive/Files/Get/](https://www.temboo.com/library/Library/Google/Drive/Files/Get/)

（全面披露：我在 Temboo 工作。）

# java - 如何点击 JList 中的 JLayeredPane 中的按钮

> ID：16047744
> 
> 赞同：1
> 
> 时间：2013-04-16T21:50:21.977
> 
> 标签：java, swing

我在 JList 的 JLayeredPane 中有一个按钮，因此我可以在鼠标悬停时在每一行上覆盖图标按钮。但是，这些按钮不接受鼠标点击。代码如下。单击任何内容时都不会输出任何内容。如果我向 JList 添加一个鼠标侦听器，它将被调用。

```
import java.awt.Color;
import java.awt.Component;
import java.awt.Dimension;
import java.awt.FontMetrics;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;

import javax.swing.DefaultListCellRenderer;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JLayeredPane;
import javax.swing.JList;
import javax.swing.SwingConstants;
import javax.swing.border.LineBorder;

public class TestListLayered
{
    public static class LayeredListCellRenderer extends DefaultListCellRenderer
    {
        @Override
        public Component getListCellRendererComponent(final JList list, final Object value, final int index,
                final boolean isSelected, final boolean cellHasFocus)
        {
            final JLayeredPane pane = new JLayeredPane();
            final JLabel label = (JLabel) super.getListCellRendererComponent(list, value.toString(), index, isSelected,
                    cellHasFocus);
            label.setHorizontalAlignment(SwingConstants.RIGHT);
            label.setBounds(0, 0, 100, 20);
            pane.add(label, JLayeredPane.DEFAULT_LAYER);

            final JButton edit = new JButton("e");
            final FontMetrics fontMetrics = edit.getFontMetrics(edit.getFont());
            final int height2 = (int) (1.5 * fontMetrics.getHeight());
            edit.setBounds(0, 0, (int) (1.5 * fontMetrics.stringWidth("e")), height2);
            edit.addActionListener(new ActionListener()
            {
                @Override
                public void actionPerformed(final ActionEvent e)
                {
                    System.out.println("button");
                }
            });
            pane.addMouseListener(new MouseAdapter()
            {
                @Override
                public void mouseClicked(final MouseEvent e)
                {
                    System.out.println("layeredpane");
                }
            });
            pane.add(edit, JLayeredPane.PALETTE_LAYER);

            pane.setPreferredSize(new Dimension(-1, height2));
            pane.setBorder(new LineBorder(Color.blue));
            return pane;
        }
    }

    public static void main(final String[] args)
    {
        final JFrame f = new JFrame();
        f.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);

        final JList<String> l = new JList<String>(new String[] { "item 1", "item 2" });
        l.setCellRenderer(new LayeredListCellRenderer());
        f.add(l);

        f.pack();
        f.setVisible(true);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T00:25:43.520

首先，我只想说，这很奇怪……

基本上，您应该`MouseListener`在`JList`. 单击它时，您需要找到所选行的单元格边界，将鼠标点转换为单元格渲染器的本地上下文，然后测试鼠标是否在按钮的边界内单击...

之后你做什么取决于你。

```
import java.awt.Color;
import java.awt.Component;
import java.awt.Dimension;
import java.awt.EventQueue;
import java.awt.FontMetrics;
import java.awt.Point;
import java.awt.Rectangle;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import javax.swing.DefaultListCellRenderer;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JLayeredPane;
import javax.swing.JList;
import javax.swing.JScrollPane;
import javax.swing.SwingConstants;
import javax.swing.UIManager;
import javax.swing.UnsupportedLookAndFeelException;
import javax.swing.border.LineBorder;

public class TestListLayered {

    public static class LayeredListCellRenderer extends DefaultListCellRenderer {

        private JButton edit = new JButton("e");

        @Override
        public Component getListCellRendererComponent(final JList list, final Object value, final int index,
                final boolean isSelected, final boolean cellHasFocus) {
            final JLayeredPane pane = new JLayeredPane();
            final JLabel label = (JLabel) super.getListCellRendererComponent(list, value.toString(), index, isSelected,
                    cellHasFocus);
            label.setHorizontalAlignment(SwingConstants.RIGHT);
            label.setBounds(0, 0, 100, 20);
            pane.add(label, JLayeredPane.DEFAULT_LAYER);

            final FontMetrics fontMetrics = edit.getFontMetrics(edit.getFont());
            final int height2 = (int) (1.5 * fontMetrics.getHeight());
            edit.setBounds(0, 0, (int) (1.5 * fontMetrics.stringWidth("e")), height2);
            pane.add(edit, JLayeredPane.PALETTE_LAYER);

            pane.setPreferredSize(new Dimension(-1, height2));
            pane.setBorder(new LineBorder(Color.blue));
            return pane;
        }

        protected void buttonClicked(Point p) {
            System.out.println(edit.contains(p));
        }
    }

    public static void main(final String[] args) {
        new TestListLayered();
    }

    public TestListLayered() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | UnsupportedLookAndFeelException ex) {
                }

                final JFrame f = new JFrame();
                f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

                final JList<String> l = new JList<String>(new String[]{"item 1", "item 2"});
                l.setCellRenderer(new LayeredListCellRenderer());
                f.add(new JScrollPane(l));

                l.addMouseListener(new MouseAdapter() {
                    @Override
                    public void mouseClicked(MouseEvent e) {
                        int index = l.locationToIndex(e.getPoint());
                        if (index > -1) {

                            Rectangle bounds = l.getCellBounds(index, index);
                            LayeredListCellRenderer cellRenderer = (LayeredListCellRenderer) l.getCellRenderer();
                            Component renderComp = cellRenderer.getListCellRendererComponent(l, l.getModel().getElementAt(index), index, false, false);
                            renderComp.setBounds(bounds);

                            Point local = new Point(e.getPoint());
                            local.x -= bounds.x;
                            local.y -= bounds.y;

                            cellRenderer.buttonClicked(local);

                        }
                    }
                });

                f.pack();
                f.setVisible(true);
            }
        });
    }
} 
```

我只想说，我同意camickr，最好使用2列`JTable`......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T21:57:19.617

渲染器不是真正的组件。它只是一个组件的绘画。所以按钮不会响应点击。

不确定我是否理解您要执行的操作，但也许您可以使用两列 JTable。因为表格支持编辑器，所以它会响应鼠标点击。 [表格按钮列](http://tips4java.wordpress.com/2009/07/12/table-button-column/)可以在这里为您提供帮助。

# javascript - Javascript 在原型中设置具有值类型的对象属性？

> ID：16047747
> 
> 赞同：10
> 
> 时间：2013-04-16T21:50:38.480
> 
> 标签：javascript, variables, object, prototype

我总是在对象的原型中设置具有值类型的属性，因为这样可以避免每次创建对象时都必须初始化它们。

从那时起，我进行了一些调试，发现如果该原型属性的值将发生变化，则将一个新属性分配给该对象，而原型则保持不变。

```
var o = function () {

};

o.prototype.x = 0;

o.prototype.setX = function(x) {
    this.x = x;
};

var obj = new o();
obj.setX(1);
console.log(obj);

// o {x: 1, x: 0, setX: function} 
```

所以我的问题是，如果您知道原型属性的值可能会发生变化，那么在原型中设置它并受益于它不必在对象创建时进行初始化是否有任何真正的好处？

我的意思是，当它更改为另一个值时，无论如何都必须将新值分配给现有对象，从而失去最初在原型中设置它的初始好处！此外，它现在意味着您对同一事物有 2 个属性，一个在对象中，一个在原型中。

它在谷歌开发人员上说这是这样做的方法，但我不太确定。

什么时候应该在原型中设置值类型属性，当您知道值无论如何都会改变时，是否有任何真正的性能提升？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-16T22:06:00.400

我实际上已经对这类事情进行了基准测试，如果有记忆，原型模型通常比直接将值分配给对象要慢。例外情况是实例在很大程度上相同并且实例化发生的频率远高于属性访问。

所以，如果你这样定义你的对象：

```
var Class = function() {};
Class.prototype.p1 = 1;
Class.prototype.p2 = 1;
Class.prototype.p3 = 1; 
```

您可以在实例化时避免性能下降，将属性复制到每个对象。**但是**，当这些属性被访问或修改时，这种性能就会显现出来。而且，如果您碰巧在不修改它们的情况下访问了这些属性，那么*每次*访问它们时都会对原型链进行遍历（因为它们从未被复制到本地实例）。但是，如果您有*许多*属性并且每个实例只能访问其中的一小部分，那么这可能是理想的。

```
for (var i = 0; i < 100000; i++) {
  var x = new Class();
  console.log(x.p1);
  // ignore p2-p99\. we don't need them right now.
} 
```

另一方面，如果您需要在少数几个实例中多次迭代属性，则最好避免遍历原型链。

```
var Class = function() {
  this.p1 = 1;
  this.p2 = 1;
  this.p3 = 1;
} 
```

每个实例在创建时都有自己的 p1、p2 和 p3 副本。并且当我们访问其中任何一个时，都不需要参考原型链。

```
var instances = [
  new Class(), new Class(), new Class()
];

for (var i = 0; i < 1000000; i++) {
  console.log(instances[i % instances.length].p1);
  console.log(instances[i % instances.length].p2);
  console.log(instances[i % instances.length].p3);
} 
```

如果以后有时间，我稍后会对此进行基准测试以进行验证。在那之前，我能给你的只是理论！

**附录**

使用原型有两个与性能无关的好处。

**一**，对于相对静态的属性（如函数），它可以节省内存。大多数应用程序不会遇到任何限制。但是，在关闭更改时，这对您来说是个问题，请使用原型。

**第二**，原型允许您将函数和属性分配给类的所有现有实例。要使用实例级属性完成相同的壮举，您需要*查找*和迭代。

**基准**

根据[我仅在最新版本的 FF 和 Chrome for OS X 上运行的最新基准测试](https://docs.google.com/spreadsheet/ccc?key=0AkP3JM22IdYZdG1TQ2JaRi1uMy1Ed25IU1ozQmZLWkE&usp=sharing)，我对单层（非继承）类定义使用了以下语法：

**原型。***

```
function Class() {}
Class.prototype.a = 1;
Class.prototype.b = 2;
Class.prototype.c = 3; 
```

**这个。***

```
function Class() {
  this.a = 1;
  this.b = 2;
  this.c = 3;
} 
```

在上述两种语法之间，该`this.*`语法的整体运行速度提高了约 10.5%。

添加一个继承级别，我使用了以下内容：

**原型。***

```
function Base() {}
Base.prototype.a = 1;
Base.prototype.b = 2;
Base.prototype.c = 3;

function Class() {}
Class.prototype = new Base(); 
```

**这个。***

```
function Base() {
  this.a = 1;
  this.b = 2;
  this.c = 3;
}

function Class() {
  Base.apply(this);
} 
```

在这种情况下，我发现`prototype.*`语法比整体快 38.5%。用于成员访问的浏览器之间的`this.*`语法仍然*稍微*快一些；但是，优势并不像实例化优势那么明显。

我还对一种混合继承方法进行了基准测试：

```
function Base() {
  this.a = 1;
  this.b = 2;
  this.c = 3;
}

function Class() {
}
Class.prototype = new Base(); 
```

总体而言，它的运行速度比`prototype.*`语法快 0.5% 左右（可能微不足道）。然而，有趣的是，它在实例化期间慢了约 1%，但在成员访问期间比`prototype.*`语法快了约 2%。同样，不是非常重要，但我不禁想知道这些收益是否会随着继承深度的增加而扩大。

当然，请注意，这些基准测试并不是在控制良好的环境中完成的。我倾向于认为性能上明显的巨大差距是显着的。但是，较低的百分比很可能是由于我的机器上的 CPU 负载波动所致。

**尽管如此，**我可能会建议`this.*`在没有发生继承**或**成员访问比类实例化更常见的情况下使用。当然，如果您不想从 Web 应用程序中榨取每一盎司的性能，请使用对您和您的团队来说更直观的语法。大多数网络应用程序将比对象构建风格的差异带来**更显**着的性能影响。

例如，改变背景颜色，

```
document.body.style.backgroundColor = 'blue'; 
```

...比实例化我基准测试的性能最差的构造函数大约**慢 70% 。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T22:18:26.363

`prototype`如果该属性的值将始终（或大多数时间）在对象的实例化时更改，则将属性值存储在其中没有任何好处。只有在多个实例之间共享一个值时，您才会有优势，在这种情况下会导致**更少的内存使用**，但不一定会提供更好的性能。遍历原型链 **应该比**直接在`object`.

# regex - 正则表达式：将字符串与内部变量匹配以进行查找/替换 - Notepad++

> ID：16047749
> 
> 赞同：1
> 
> 时间：2013-04-16T21:50:45.177
> 
> 标签：regex, notepad++

因此，我正在尝试使用正则表达式在 notepad++ 中进行查找和替换，因为我有一个“查找”字符串，它可以在两个引号之间包含任意数量的字符。这是我的数据示例。

```
<myVar Variable="MY-VAR" Type="string"/>
<myOtherVar Variable="MYOTHERVAR" Type="int"/>
<finalVar Variable="FVAR" Type="string"/> 
```

所以，我想匹配' `Variable="[everything inside the quotes]" T`'并将其替换为' `field="" t`'。

我不想保存引号中的内容。最终目标是让线条看起来像这样：

```
<myVar field="" type="string"/>
<myOtherVar field="" type="int"/>
<finalVar field="" type="string"/> 
```

我认为这是迄今为止我在“查找”框中的最佳尝试，但如果不是，您可以告诉我。XD

```
/' variable="(\w+)" t'/ 
```

谢谢大家！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T21:54:05.780

不知道 notepad++ 正则表达式语法，但以下想法应该有效：

尝试更换

```
Variable="[^"]*"\s+T 
```

和

```
field="" t 
```

**编辑**

我没有windows机器，只是在一个虚拟盒子里装了notepad++，做了个小测试：）

结果如下所示：

![在此处输入图像描述](https://i.stack.imgur.com/LYOWx.gif)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T21:58:20.090

使用 Notepad++，您的 RegEx 将是：

```
Variable=".*" 
```

不要忘记最后一个空格，这很重要。将其替换为

```
field="" 
```

还包含一个空格作为最后一个字符。

问候

# r - 使用 R 更改数据框中列的顺序

> ID：16047750
> 
> 赞同：0
> 
> 时间：2013-04-16T21:50:53.147
> 
> 标签：r

我有一个数据如下：

```
nnn <- structure(list(JulDay = c(260.0208435, 260.0416565, 260.0625, 
260.0833435, 260.1041565, 260.125), i46j8k1 = c(17.99964905, 
18.5903511, 22.93223381, 25.75687981, 25.78559113, 25.8169651
), i47j8k1 = c(18.36571884, 21.15985107, 24.80698013, 25.75730324, 
25.78366089, 25.65381622), i48j8k1 = c(18.45543289, 22.02331543, 
24.99463654, 25.5712738, 25.64232635, 25.66119385), i46j8k2 = c(17.99798965, 
18.60897827, 22.95389748, 25.75719261, 25.78653336, 25.81692505
), i47j8k2 = c(18.36762619, 21.17233467, 24.82248497, 25.75767899, 
25.7840023, 25.64115906), i48j8k2 = c(18.45938683, 22.04619026, 
24.9859066, 25.56440544, 25.63998032, 25.66089439), i46j8k3 = c(17.99430084, 
17.92090797, 19.67384911, 21.70389938, 23.67287827, 24.04380417
), i47j8k3 = c(18.36631203, 19.82550049, 21.42166328, 23.76496887, 
24.87460899, 25.41026688), i48j8k3 = c(18.44684792, 20.60981369, 
22.68632317, 24.1877079, 25.12503052, 24.99880028), i46j8k4 = c(17.98368073, 
17.92047691, 18.11532974, 18.67082596, 20.23210907, 21.7181263
), i47j8k4 = c(18.33089066, 18.41581535, 18.53464127, 19.18972206, 
20.14752388, 20.11002922), i48j8k4 = c(18.21522522, 18.52231598, 
19.21397209, 19.58755302, 20.11982536, 21.28104591)), .Names = c("JulDay", 
"i46j8k1", "i47j8k1", "i48j8k1", "i46j8k2", "i47j8k2", "i48j8k2", 
"i46j8k3", "i47j8k3", "i48j8k3", "i46j8k4", "i47j8k4", "i48j8k4"
), row.names = c(NA, 6L), class = "data.frame")

> nnn
    JulDay  i46j8k1  i47j8k1  i48j8k1  i46j8k2  i47j8k2  i48j8k2  i46j8k3  i47j8k3  i48j8k3  i46j8k4  i47j8k4  i48j8k4
1 260.0208 17.99965 18.36572 18.45543 17.99799 18.36763 18.45939 17.99430 18.36631 18.44685 17.98368 18.33089 18.21523
2 260.0417 18.59035 21.15985 22.02332 18.60898 21.17233 22.04619 17.92091 19.82550 20.60981 17.92048 18.41582 18.52232
3 260.0625 22.93223 24.80698 24.99464 22.95390 24.82248 24.98591 19.67385 21.42166 22.68632 18.11533 18.53464 19.21397
4 260.0833 25.75688 25.75730 25.57127 25.75719 25.75768 25.56441 21.70390 23.76497 24.18771 18.67083 19.18972 19.58755
5 260.1042 25.78559 25.78366 25.64233 25.78653 25.78400 25.63998 23.67288 24.87461 25.12503 20.23211 20.14752 20.11983
6 260.1250 25.81697 25.65382 25.66119 25.81693 25.64116 25.66089 24.04380 25.41027 24.99880 21.71813 20.11003 21.28105 
```

我想改变数据框的顺序如下：

```
JulDay i46j8k1 i46j8k2 i46j8k3 i46j8k4 i47j8k1 i47j8k2 i47j8k3 i47j8k4 i48j8k1 i48j8k2 i48j8k3 i48j8k4 
```

谁能建议我该怎么做？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T23:06:59.200

数据帧的顺序可以更改如下：

```
new<- nnn[,c("JulDay","i46j8k1","i46j8k2","i46j8k3","i46j8k4","i47j8k1","i47j8k2","i47j8k3","i47j8k4",
                   "i48j8k1","i48j8k2","i48j8k3","i48j8k4")] 
```

感谢 Arun 的建议。

# php - PHP验证函数返回值？

> ID：16047756
> 
> 赞同：0
> 
> 时间：2013-04-16T21:51:04.577
> 
> 标签：php, forms, function, validation

我正在尝试创建小函数来验证我的每个表单元素。但我遇到了一些困难。一般来说，我对 PHP 函数相当陌生。

目前我正在尝试为表单中的“姓氏”条目创建一个验证函数。这就是我所拥有的：

```
//Call surname validation function
If (validSurname($surname) === false) {
    $mistakes[] = 'Your surname is either empty or Enter only ALPHABET characters.';
} 
function validSurname($surname) {
    $surname = trim($surname);
    if (empty($surname) || (!ctype_alpha(str_replace(' ', '', $surname)))) {
        $isValid = false;
    } else {
        //accept surname entry and sanitize it
        $surname = mysql_real_escape_string(stripslashes($surname));
    }
    return $isValid;
} 
```

所以目前我使用类似的东西来验证电子邮件，它工作正常。但现在我想通过某些阶段实际传递姓氏，例如：

```
$surname = trim($surname); 
```

对于要在函数外部访问然后输入数据库的新值，我是否需要在函数末尾返回它？例如返回 $surname 之类的东西；在函数的末尾？

简而言之 - 我如何在函数之外使用 $surname 的这个新值（而不是在表单中输入的初始值）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T21:58:22.480

您应该考虑您的功能正在尝试做什么。在我看来，您可能需要两个函数`isValidSurname`，它们将返回一个布尔值 true 或 false，并`formatSurname`采用有效的姓氏并将其返回正确的格式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T22:00:38.490

您可以更明确地使用函数名称并返回新值。

例如：

```
function isSurnameValid($surname) {
    return (empty($surname) || (!ctype_alpha(str_replace(' ', '', $surname)))) ? false : true;
}

function cleanSurname($surname) {
    $surname = mysql_real_escape_string(stripslashes(trim($surname)));
    return $surname;
} 
```

这样你就有了清晰的、描述性的函数名称，并且每个函数都有一个单一的职责。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T21:57:23.470

您应该在函数内将其设置为全局。不过，我不会使用与您用作函数参数的变量名称相同的变量名称。如果您想弄乱 $surnameVar，请执行以下操作：

```
function validSurname($surname) {
    global $surnameVar;
    $surnameVar = trim($surname);
    if (empty($surname) || (!ctype_alpha(str_replace(' ', '', $surname)))) {
        $isValid = false;
    } else {
        //accept surname entry and sanitize it
        $surname = mysql_real_escape_string(stripslashes($surname));
    }
    return $isValid;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-16T21:58:57.507

您要么必须使用全局变量，要么[通过引用传递 $surname](http://php.net/manual/en/language.references.pass.php)如果您想按照您第一次编写它的方式进行操作。

或者，您可以传回修改后的字符串，或者如果失败则根本不传回字符串。

```
$surname = validSurname($surname);
if (strlen($surname) == 0) {
    $mistakes[] = 'Your surname is either empty or Enter only ALPHABET characters.';
}

function validSurname($surname) {
    $surname = trim($surname);
    if (empty($surname) || (!ctype_alpha(str_replace(' ', '', $surname)))) {
        $surname = '';
    } else {
        //accept surname entry and sanitize it
        $surname = mysql_real_escape_string(stripslashes($surname));
    }
    return $surname;
} 
```

# c# - 当值为 NULL 时无法删除表单视图中的记录

> ID：16047758
> 
> 赞同：0
> 
> 时间：2013-04-16T21:51:22.207
> 
> 标签：c#, asp.net, linq, formview, linqdatasource

我在删除连接到 LinqDataSource 的 FormView 中的记录时遇到问题。LinqDataSource 使用的表允许几乎所有字段的 NULL 值。如果我在 FormView 中创建一条新记录并填写所有值，然后尝试删除它，它工作正常。但是，如果我将任何字段留空然后保存并尝试删除，则会引发以下异常：

> 未能在类型 PRIDE.Info___Employee_Health_History 上设置一个或多个属性。不是 Int16 的有效值。

表中的`real`列也是如此。如果我将其中一个留空，然后保存并尝试删除，我会得到不同类型的相同异常。

我最大的问题是，为什么它在删除时尝试设置 ANY 值？

这是我的桌子：

![桌子](https://i.stack.imgur.com/MbzWD.png)

我的表单视图代码：

```
<asp:FormView ID="fvHealthHistory" runat="server" CssClass="full" 
    AllowPaging="True" DataSourceID="ldsHealthHistory" DataKeyNames="ID" 
    oniteminserting="fvHealthHistory_ItemInserting">
    <EmptyDataTemplate>
        <p>No records found.</p>
        <p>
            <asp:Button ID="btnNew" runat="server" Text="New Record" CommandName="New" />
        </p>
    </EmptyDataTemplate>
    <InsertItemTemplate>
        <table class="pad5">
            <tr>
                <td class="field-name">Date:</td>
                <td>
                    <asp:TextBox ID="txtDate" runat="server" Text='<%#Bind("Date", "{0:dd MMM yyyy}") %>' />
                    <asp:CalendarExtender ID="CalendarExtender1" runat="server" TargetControlID="txtDate" Format="dd MMM yyyy" />
                </td>
            </tr>
            <tr>
                <td class="field-name">Weight:</td>
                <td><asp:TextBox ID="txtWeight" runat="server" Text='<%#Bind("Weight") %>' /></td>
            </tr>
            <tr>
                <td class="field-name">Height:</td>
                <td><asp:TextBox ID="txtHeight" runat="server" Text='<%#Bind("Height") %>' /></td>
            </tr>
            <tr>
                <td class="field-name">Pulse:</td>
                <td><asp:TextBox ID="txtPulse" runat="server" Text='<%#Bind("Pulse") %>' /></td>
            </tr>
            <tr>
                <td class="field-name">Systolic:</td>
                <td><asp:TextBox ID="txtSystolic" runat="server" Text='<%#Bind("Systolic") %>' /></td>
            </tr>
            <tr>
                <td class="field-name">Diastolic:</td>
                <td><asp:TextBox ID="txtDiastolic" runat="server" Text='<%#Bind("Diastolic") %>' /></td>
            </tr>
        </table>

        <p>
            <asp:Button ID="btnInsert" runat="server" Text="Insert" CommandName="Insert" />
            <asp:Button ID="btnCancel" runat="server" Text="Cancel" CommandName="Cancel" />
        </p>
    </InsertItemTemplate>
    <EditItemTemplate>
        <table class="pad5">
            <tr>
                <td class="field-name">Date:</td>
                <td>
                    <asp:TextBox ID="txtDate" runat="server" Text='<%#Bind("Date", "{0:dd MMM yyyy}") %>' />
                    <asp:CalendarExtender ID="CalendarExtender1" runat="server" TargetControlID="txtDate" Format="dd MMM yyyy" />
                </td>
            </tr>
            <tr>
                <td class="field-name">Weight:</td>
                <td><asp:TextBox ID="txtWeight" runat="server" Text='<%#Bind("Weight") %>' /></td>
            </tr>
            <tr>
                <td class="field-name">Height:</td>
                <td><asp:TextBox ID="txtHeight" runat="server" Text='<%#Bind("Height") %>' /></td>
            </tr>
            <tr>
                <td class="field-name">Pulse:</td>
                <td><asp:TextBox ID="txtPulse" runat="server" Text='<%#Bind("Pulse") %>' /></td>
            </tr>
            <tr>
                <td class="field-name">Systolic:</td>
                <td><asp:TextBox ID="txtSystolic" runat="server" Text='<%#Bind("Systolic") %>' /></td>
            </tr>
            <tr>
                <td class="field-name">Diastolic:</td>
                <td><asp:TextBox ID="txtDiastolic" runat="server" Text='<%#Bind("Diastolic") %>' /></td>
            </tr>
        </table>

        <p>
            <asp:Button ID="btnUpdate" runat="server" Text="Update" CommandName="Update" />
            <asp:Button ID="btnCancel" runat="server" Text="Cancel" CommandName="Cancel" />
        </p>
    </EditItemTemplate>
    <ItemTemplate>
        <table class="pad5">
            <tr>
                <td class="field-name">Date:</td>
                <td>
                    <asp:Label ID="txtDate" runat="server" Text='<%#Bind("Date", "{0:dd MMM yyyy}") %>' />
                </td>
            </tr>
            <tr>
                <td class="field-name">Weight:</td>
                <td><asp:Label ID="txtWeight" runat="server" Text='<%#Bind("Weight") %>' /></td>
            </tr>
            <tr>
                <td class="field-name">Height:</td>
                <td><asp:Label ID="txtHeight" runat="server" Text='<%#Bind("Height") %>' /></td>
            </tr>
            <tr>
                <td class="field-name">Pulse:</td>
                <td><asp:Label ID="txtPulse" runat="server" Text='<%#Bind("Pulse") %>' /></td>
            </tr>
            <tr>
                <td class="field-name">Systolic:</td>
                <td><asp:Label ID="txtSystolic" runat="server" Text='<%#Bind("Systolic") %>' /></td>
            </tr>
            <tr>
                <td class="field-name">Diastolic:</td>
                <td><asp:Label ID="txtDiastolic" runat="server" Text='<%#Bind("Diastolic") %>' /></td>
            </tr>
        </table>

        <p>
            <asp:Button ID="btnNew" runat="server" Text="New" CommandName="New" />
            <asp:Button ID="btnEdit" runat="server" Text="Edit" CommandName="Edit" />
            <asp:Button ID="btnDelete" runat="server" Text="Delete" CommandName="Delete" OnClientClick="return confirm('Are you sure you want to delete this record?')" />
        </p>
    </ItemTemplate>
    <PagerSettings Mode="NextPreviousFirstLast" 
        FirstPageText="&amp;lt;&amp;lt; First" LastPageText="Last &amp;gt;&amp;gt;" 
        NextPageText="Next &amp;gt;" PreviousPageText="&amp;lt; Previous" />
    <PagerStyle CssClass="pager" />
</asp:FormView> 
```

LinqDataSoure 的 ItemInserting 事件：

```
protected void fvHealthHistory_ItemInserting(object sender, FormViewInsertEventArgs e)
{
    e.Values["Worker_ID"] = Convert.ToInt32(Request.QueryString["id"]);
} 
```

最后是我的 LinqDataSource：

```
<asp:LinqDataSource ID="ldsHealthHistory" runat="server" 
    ContextTypeName="PRIDE.PRIDEDataContext" EnableDelete="True" 
    EnableInsert="True" EnableUpdate="True" EntityTypeName="" OrderBy="Date desc" 
    TableName="Info___Employee_Health_Histories" Where="Worker_ID == @Worker_ID">
    <WhereParameters>
        <asp:QueryStringParameter DefaultValue="0" Name="Worker_ID" 
            QueryStringField="id" Type="Int32" />
    </WhereParameters>
    <InsertParameters>
        <asp:Parameter Name="Date" ConvertEmptyStringToNull="true" />
        <asp:Parameter Name="Weight" ConvertEmptyStringToNull="true" />
        <asp:Parameter Name="Height" ConvertEmptyStringToNull="true" />
        <asp:Parameter Name="Pulse" ConvertEmptyStringToNull="true" />
        <asp:Parameter Name="Systolic" ConvertEmptyStringToNull="true" />
        <asp:Parameter Name="Diastolic" ConvertEmptyStringToNull="true" />
    </InsertParameters>
    <UpdateParameters>
        <asp:Parameter Name="Date" ConvertEmptyStringToNull="true" />
        <asp:Parameter Name="Weight" ConvertEmptyStringToNull="true" />
        <asp:Parameter Name="Height" ConvertEmptyStringToNull="true" />
        <asp:Parameter Name="Pulse" ConvertEmptyStringToNull="true" />
        <asp:Parameter Name="Systolic" ConvertEmptyStringToNull="true" />
        <asp:Parameter Name="Diastolic" ConvertEmptyStringToNull="true" />
    </UpdateParameters>
</asp:LinqDataSource> 
```

有谁知道为什么它只会让我删除所有可空字段都填写的记录？

# javascript - node.js restler 调用上的多个响应

> ID：16047761
> 
> 赞同：9
> 
> 时间：2013-04-16T21:51:44.837
> 
> 标签：javascript, node.js, restler

我创建了一个用于发送 REST 请求的库：

```
var rest = require('restler');
module.exports = {
  beginSession: function()
  {
    var options = {
        method: "GET",
        query: {begin_session: '1'}};
    rest.get('http://countly/i', options).
        on('complete', function(data, response){
            console.log('Status: ' + response.statusCode);
        });
  }
}; 
```

问题是每次我使用库并响应调用时，都会多次调用“完成时”：第一次使用方法只会调用一次“完成时”，第二次使用方法将调用“完成时”两次等等....

我究竟做错了什么？

谢谢何塞

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-05-23T11:10:27.600

我也在努力解决这个问题。但在互联网上没有找到答案。不过我终于弄明白了。这是由*每次*调用 rest.get() 时注册的“完成”事件引起的。

我的解决方案是使用 .once() 而不是 .on()。例如：

```
var rest = require('restler');
rest.get('url_to_fetch').once('complete', function(rtn, rsp){
     ....blah blah....
});
// refer here http://nodejs.org/api/events.html#events_emitter_once_event_listener 
```

希望这会有所帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-10-02T08:30:49.713

TL；DR：restler 中的错误，在 npm 更新之前快速修复：将 git master 添加到`package.json`

这里真正的问题是节点 0.10 中事件 API 的一些更改会导致 restler 重新触发旧的事件侦听器，如[https://github.com/danwrong/restler/issues/112](https://github.com/danwrong/restler/issues/112)中所述。

8 月底，这已在[https://github.com/danwrong/restler/pull/113](https://github.com/danwrong/restler/pull/113)中修复。当我们等待适当的 npm 发布时，它通过使用当前的 git head 对我有用。

```
"restler": "git://github.com/danwrong/restler.git#9d455ff14c57ddbe263dbbcd0289d76413bfe07d" 
```

免责声明：我不知道这个版本有什么问题或者为什么还没有发布。自上次发布以来，我没有仔细研究问题或差异来找出答案。

2014 年 8 月更新：从那时起有一个 npm 版本，它似乎包含修复。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-16T22:01:57.807

这是因为您为每个呼叫附加了一个新事件。尝试先解除绑定事件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-11-19T12:10:39.607

请查看 v3.2.2。升级你的 package.json：

```
npm install restler --save 
```

它为我解决了这个问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-25T05:27:20.917

JSON 请求的回调处理程序中发生的异常也可能导致此行为。

请参阅此处的拉取请求以获取解决方案： [https ://github.com/danwrong/restler/pull/94](https://github.com/danwrong/restler/pull/94)

# java - 为什么 getResourceAsStream() 可以在 IDE 中工作，但不能在 JAR 中工作？

> ID：16047762
> 
> 赞同：8
> 
> 时间：2013-04-16T21:51:45.030
> 
> 标签：java, eclipse, file-io, jar, inputstream

我只想将文件读入我的程序。该文件位于“../f.fsh”工作目录上方的一个目录。因此，当我在 IDE 中运行以下代码时，它可以正确运行

```
String name="../f.fsh";
InputStream is = getClass().getResourceAsStream(name);
InputStreamReader isreader=new InputStreamReader(is);//CRASHES HERE WITH NULL POINTER EXCEPTION
BufferedReader br = new BufferedReader(isreader); 
```

但是当我创建一个压缩了 f.fsh 的 JAR 文件并运行它时，它会在创建 InputStreamReader 时崩溃，因为 InputStream 为空。

我已经阅读了一堆关于输入流和 JAR 文件的问题的答案，我从中得到的是我应该使用相对路径，但我已经在这样做了。据我了解 getResourceAsStream() 可以找到相对于项目根目录的文件，这就是我想要的。为什么它在 JAR 中不起作用？出了什么问题，我该如何解决？

它与类路径有关吗？我认为这仅用于包含正在运行的 jar 外部的文件。

我也尝试过，但仍然失败，在输入斜线时：

```
InputStream is = getClass().getResourceAsStream("\\"+name); 
```

我查看了：[How to get a path to a resource in a Java JAR file](https://stackoverflow.com/questions/941754/how-to-get-a-path-to-a-resource-in-a-java-jar-file)并发现 JAR 的内容可能不一定可以作为文件访问。所以我尝试复制相对于 jar 的文件（从 jar 开始的一个目录），但仍然失败。在任何情况下，我都想把我的文件留在罐子里并能够在那里阅读它们。我不知道出了什么问题。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-16T22:07:07.560

你不能使用`..`with `Class.getResourceAsStream()`。

要将资源加载`f.fsh`到与类相同的包中，请使用`SomeClass.class.getResourceAsStream("f.fsh")`

`f.fsh`要在类包的子包 foo.bar 中加载资源，请使用`SomeClass.class.getResourceAsStream("foo/bar/f.fsh")`

`f.fsh`要在任何包 com.company.foo.bar 中加载资源，请使用`SomeClass.class.getResourceAsStream("/com/company/foo/bar/f.fsh")`

这在该`getResource()`方法的 javadoc 中进行了描述，尽管它缺少示例。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-16T22:47:09.263

如果`..`在`Class.getResourceAsStream()`从 Eclipse 运行时工作，这是 Eclipse 中的一个错误。Eclipse 和其他 IDE 实现自定义类加载器以在运行时从项目中获取资源。看起来 Eclipse 中的类加载器实现没有对`getResourceAsStream()`方法的输入执行所有必要的验证。在这种情况下，该错误对您有利，但您仍需要重新考虑如何构建资源以使代码在所有情况下都能正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-02-15T17:23:09.857

1.  文件名必须区分大小写
2.  如果文件被移动或复制到 Exclipse 之外，则必须刷新 (F5) 项目资源管理器

# jquery - ASP.NET MVC 4 编辑器模板和 jQuery Datepicker

> ID：16047765
> 
> 赞同：0
> 
> 时间：2013-04-16T21:51:57.773
> 
> 标签：jquery, asp.net, datepicker

我在我的 ASP.NET MVC4 Web 应用程序中使用 jquery datepicker。我还在为我的日期时间数据类型使用编辑器模板。

我的编辑器模板如下所示：

```
<input type="text" name="@ViewData.ModelMetadata.PropertyName" class="date" value='@(((DateTime)Model).ToShortDateString())' /> 
```

我的 jquery 日期选择器代码：

```
$(document).ready(function() {
    $(".date").datepicker();
}) 
```

我遇到的问题是，当我从数据库加载日期时，日期选择器会突出显示今天的日期而不是文本框中的日期。如何让日期选择器突出显示我加载到文本框中的日期？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T22:04:03.787

```
$(".date").datepicker({defaultDate: "@(((DateTime)Model).ToShortDateString()"}); 
```

当然，如果你在编辑器模板的顶部设置了@model DateTime，你可以简单地去：

```
$(".date").datepicker({defaultDate: "@Model.ToShortDateString()"}); 
```

或者实际上，甚至可能像这样动态地 - 注意 id 属性：

```
<input type="text" id="@ViewData.ModelMetadata.PropertyName" name="@ViewData.ModelMetadata.PropertyName" class="date" value='@(((DateTime)Model).ToShortDateString())' />

$(".date").datepicker({defaultDate: $("#@ViewData.ModelMetadata.PropertyName").val()}); 
```

玩一玩。

# java - 是否可以将对象序列化为纯文本字符串并将其作为字符串发送然后将其转换回来？

> ID：16047769
> 
> 赞同：0
> 
> 时间：2013-04-16T21:52:15.010
> 
> 标签：java

正如标题所说。我正在将消息从我的服务器发送到我无法控制的代理中，然后将其发送到我的应用程序中。我所能做的就是发送和接收字符串。是否可以像通常那样在没有输入/输出流的情况下序列化为纯字符串并以这种方式发送？

TIA

更多信息：

```
public class myClass implements java.io.Serializable {
int h = "ccc";
int i = "bbbb";
String myString = "aaaa";
} 
```

例如，我有这门课。现在我想序列化它并将其作为我的 HTTPpost 中的字符串发送并发送到代理，对此阶段无能为力：

```
 HttpPost post = new HttpPost("http://www.myURL.com/send.php?msg="+msg); 
```

然后在另一端接收 msg 作为字符串并将其转换回来。

没有许多其他图书馆，这很容易做到吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T21:55:03.507

是的。

这是每天使用 JSON 和 XML 完成的，仅举几例易于格式化和解析的字符串格式。（阅读有关 JAXRS 以了解使用 JSON 格式的字符串来执行此操作并进行传输的方法。或者，阅读有关 JAXB 的内容，它将格式化为 XML，但不会中断字符串的通信。）

您可以以 CSV 格式执行此操作。

您可以在固定的字符字段中执行此操作。

摩尔斯电码不是一个不同的概念，只是它以字符串开头并转换为短促和长促的哔哔声。

它的工作方式是这样的：

1.  有一些代码可以传递一个对象，它会返回一个已知格式的字符串。
2.  您以某种方式将字符串发送到另一台服务器。一些发送字符串的方法对长度有限制。
3.  另一台服务器接收该字符串。
4.  使用它的格式知识，其他服务器解析出字符串内容并使用它。

一些注意事项：

*   如果两台服务器都使用 Java（或 C#、Python 或 PHP 或其他），那么格式化和解析就会变得对称。您从某种类型的 Java 对象开始，并以相同类型的另一个 JVM 中的 Java 对象结束。*但这不是给定的。您可以将值存储在一个服务器中的自定义 POJO 和另一个服务器中的 Map 中。*

*   如果你编写代码来格式化和解析，只要内容简单并且不违反传输规则，这似乎真的很容易。例如，如果您在 HTTP get 的查询部分中发送，则字符串中不能有任何 & 字符。

*   如果您使用现有的库，您可以利用其他人获得的关于如何做到这一点而不会出错的知识。

*   如果您对字符串使用标准格式，则很容易向其他人解释发生了什么。如果您的项目有效，则第三台服务器可能希望处于通信循环中，并且如果它由其他人控制......

*   格式化比解析更容易。其他人已经解决了许多陷阱。如果您这样做是为了学习不做事的方法并提高自己的知识库，请务必自己动手。如果您想要坚如磐石的性能，请使用现有的标准库和格式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T22:04:16.863

看看**XStream**。它序列化为 XML，使用起来非常简单。

看看那里的[**两分钟教程**](http://xstream.codehaus.org/tutorial.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T21:57:08.953

对的，这是可能的。您可以使用 ajax 将字符串序列化为 json 对象，并使用 ajax.post 事件（javascript 事件）将其返回到服务器。

# c# - 带有开放泛型的 Ninject 上下文绑定

> ID：16047770
> 
> 赞同：5
> 
> 时间：2013-04-16T21:52:16.063
> 
> 标签：c#, generics, repository, dynamics-crm-2011, ninject

我有一个通用接口和`IRepository<T>`两个实现`xrmRepository<T>``efRepository<T>`

我想更改基于 的绑定`T`，更具体地说，使用`xrmRepository`when`T`派生自`Entity`。我怎样才能做到这一点？

我目前有：

```
kernel.Bind(typeof(IRepository<>)).To(typeof(efRepository<>)).InRequestScope();
kernel.Bind(typeof(IRepository<>)).To(typeof(xrmRepository<>)).When(request => request.Service.GetGenericArguments()[0].GetType().IsSubclassOf(typeof(Entity))).InRequestScope(); 
```

但是当我尝试解决`IRepository<Contact>`它时，它会转到 efRepository，即使 Contact 继承了 Entity。

我不想使用命名绑定，否则我将不得不在任何地方添加名称。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T22:01:21.550

使用`When`方法声明绑定条件。下面给出示例

```
kernel.Bind(typeof(IRepository<>))
      .To(typeof(efRepository<>))
      .When(request => request.Service.GetGenericArguments()[0] == typeof(Entity))
      .InRequestScope();

kernel.Bind(typeof(IRepository<>))
      .To(typeof(xrmRepository<>))
      .InRequestScope();

kernel.Get<IRepository<Entity>>(); //will return efRepository<Entity>

kernel.Get<IRepository<int>>(); //will return xrmRepository<int> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T17:01:35.573

您也可以像这样定义绑定。我不知道运行时性能，但我认为这种方式更具可读性。如果我没有遗漏任何东西，它应该会导致相同的行为。

```
kernel.Bind(typeof(IRepository<>))
      .To(typeof(efRepository<>))
      .InRequestScope();

kernel.Bind<IRepository<Entity>>()
      .To<xrmRepository<Entity>>()
      .InRequestScope(); 
```

**编辑**

如果目标是为从 Entity 继承的每个类使用 xrmRepository ，那么这应该可以解决问题

```
kernel.Bind(typeof(IRepository<>))
                    .To(typeof(XrmRepository<>))
                    .When(request => typeof(Entity).IsAssignableFrom(request.Service.GetGenericArguments()[0])); 
```

# javascript - 谷歌地图覆盖不会定位在正确的标记上

> ID：16047773
> 
> 赞同：1
> 
> 时间：2013-04-16T21:52:35.790
> 
> 标签：javascript, google-maps, google-maps-api-3

我正在尝试制作一个标记列表以固定在地图上，每个标记都有自己的叠加层。它大部分都在工作，但是叠加层都被放置在彼此的顶部而不是其相应的标记上。

代码如下：

```
var myCenter = getMyLocation();

function initialize()
{
  var mapProp = {
    center: myCenter,
    zoom:9,
    mapTypeId:google.maps.MapTypeId.ROADMAP
  };

  var map = new google.maps.Map(document.getElementById("googleMap"),mapProp);

  var locations = [
    {lat: -27.646670, lng: 152.86918630, text: 'Address #1'},
    {lat: -27.6446550, lng: 152.7822390, text: 'Address #2'},
    {lat: -27.6062480, lng: 152.7889550, text: 'Address #3'}
  ];

  // Loop through our list and plot them on the map
  locations.forEach(function (l) {

    marker =  new google.maps.Marker({
      position: new google.maps.LatLng(l.lat, l.lng),
    });

    marker.setMap(map);

    // Create our infoWindow panel for our marker
    var infoWindow = new google.maps.InfoWindow({
      content: l.text
    });

    // Bind click event for our marker
    google.maps.event.addListener(marker, 'click', function () {
      infoWindow.open(map, marker);
    });
  });

}

google.maps.event.addDomListener(window, 'load', initialize); 
```

我觉得这个问题与点击`addListener`事件有关

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T22:08:45.310

您只是缺少一个`var`：

```
marker =  new google.maps.Marker(... 
```

应该：

```
var marker =  new google.maps.Marker( 
```

因此，您只有一个全局`marker`变量，而不是每个标记的唯一变量。

由于您使用`.forEach`的是回调函数，因此该回调函数为循环的每次迭代提供了一个闭包。`marker`所以你所需要的就是通过在回调中创建一个局部变量来利用这个闭包。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T21:57:50.290

也许关闭会帮助你？标记是一个对象，因为它在每个循环链接上都会发生变化。关闭将阻止它。

```
google.maps.event.addListener(marker, 'click', (function(marker){ return function () {
      infoWindow.open(map, marker);
};})(marker)); 
```

# scala - 带有 Scala-IDE 的空白编辑器窗口

> ID：16047774
> 
> 赞同：0
> 
> 时间：2013-04-16T21:52:40.760
> 
> 标签：scala, scala-ide

在 Scala-IDE eclipse 插件中打开 Scala 文件时，“打开文件”只是空白并`java.lang.nullPointerException`给出一个弹出窗口。是否有任何解决方法或修复可以完成？

Eclipse 版本：4.3.0 Scala-IDE 版本：3.0.0.v_2-10 和/也是当前每晚

![一个打开的 .scala 文件](https://i.stack.imgur.com/q1YZH.png)

# ruby-on-rails - 如何通过关联创建一个新记录

> ID：16047775
> 
> 赞同：0
> 
> 时间：2013-04-16T21:52:42.690
> 
> 标签：ruby-on-rails, associations

我有一个复选框列表，人们可以在其中为一个项目选择一个或多个组织。这是一个有很多通过关联。

但我还想添加一个文本字段，`Add Other`以便用户还可以创建一个新组织***并将其自动分配给项目***。

**项目.rb**

```
has_many :organizationables
has_many :organizations, through: :organizationables
attr_accessible :organization_ids 
```

**组织.rb**

```
attr_accessible :name, :website
has_many :organizationables
has_many :projects, through: :organizationable 
```

**可组织的.rb**

```
attr_accessible :organization_id, :project_id
belongs_to :organization
belongs_to :project 
```

我知道对于“可组织”协会来说，这是一个奇怪的名字，但是哦，好吧。我尝试了不同的方法来设置表单，但我无法让它工作。

**新项目表单应该有复选框，可以将组织分配给项目，但也会有一个`Other Organization`文本字段（这将创建一个新组织并将其分配给项目）。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T22:29:48.213

假设您想在一个操作中创建新组织并关联到现有项目，这是最简单的方法：

```
new_organization.save!
project.organizations << new_organization 
```

这将创建并保存将项目与新组织链接的可组织记录。

更新：

首先保存新项目。然后设置他们检查的一系列组织。如果他们创建了一个组织，请将其保存并将其添加到阵列中。然后一举将组织列表与项目联系起来：

```
project.organizations = my_list_of_checked_organizations 
```

有关类似示例，请参见[http://guides.rubyonrails.org/association_basics.html#the-has_many-through-association 。](http://guides.rubyonrails.org/association_basics.html#the-has_many-through-association)

# php - PHP 中的初学者正则表达式。一些讨厌的角色

> ID：16047776
> 
> 赞同：0
> 
> 时间：2013-04-16T21:52:46.873
> 
> 标签：php, regex

我需要将 VB.NET 中的一些代码重写为 PHP：

```
Dim price as String = Regex.Match(html, "id=""price"">&pound;\d+.\d+</span>").Value.Replace("id=""Acashprice"">&pound;", "").Replace("</span>", "") 
```

所以我试图从正则表达式中获取匹配开始：

```
id="price">&pound;\d+.\d+</span> 
```

然而，无论我如何格式化它，我总是被告知它是无效的——（即不允许使用反斜杠，或者什么是 p？）。我想我可能必须将 preg_quote 与 preg_match 结合使用，但我也无法使其正常工作。任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T22:00:11.667

这应该做的工作：

```
preg_match('/(?<=id="price">)&pound;\d+.\d+/', '<span id="price">&pound;55.55</span>', $m);
print_r($m); 
```

**输出：**

```
Array
(
    [0] => &pound;55.55
) 
```

更可靠的正则表达式如下：

```
$str = '<span id="price">&pound;11.11</span>
<span id="price">&pound;22</span>
<span id="price"> &pound; 33 </span>
<span      id  =  "price"   >      &pound; 44     </span>
<span      id=\'price\'   >      &pound; 55     </span>
<span class="component" id="price"> &pound; 67.89 </span>
<span class="component" id="price" style="float:left"> &pound; 77.5 </span>
<span class="component" id="price" style="float:left:color:#000"> £77.5 </span>
';
preg_match_all('/<span.+?id\s*=\s*(?:"price"|\'price\').*?>\s*((?:&pound;|£)\s?\d+(?:.\d+)?)\s*<\/span>/is', $str, $m);

print_r($m[1]); 
```

**输出：**

```
Array
(
    [0] => &pound;11.11
    [1] => &pound;22
    [2] => &pound; 33
    [3] => &pound; 44
    [4] => &pound; 55
    [5] => &pound; 67.89
    [6] => &pound; 77.5
    [7] => £77.5
) 
```

# c++ - 未读 C++ 中的文件

> ID：16047777
> 
> 赞同：5
> 
> 时间：2013-04-16T21:52:47.373
> 
> 标签：c++, c, io, fstream, libc

我正在尝试读取同时写入磁盘的文件。我需要读取特定大小的块。如果读取的大小小于特定大小，我想取消读取文件（类似于 ungetc 所做的，而不是 char[]）并重试。附加到已经读取的字节对我来说不是一个选择。

这怎么可能？

我尝试通过以下方式保存当前位置：

```
FILE *fd = fopen("test.txt","r+");
fpos_t position;
fgetpos (fd, &position); 
```

然后读取文件并将指针放回其读取前的位置。

```
numberOfBytes = fread(buff, sizeof(unsigned char), desiredSize, fd) 
if (numberByBytes < desiredSize) {
    fsetpos (fd, &position);
} 
```

但这似乎不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T21:55:26.753

用我刚刚检查过的代码（Ubuntu 12.04 LTS，32 位）替换我之前的建议。GCC 是 4.7，但我很确定这是 100% 的标准解决方案。

```
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

#define desiredSize 10
#define desiredLimit 100

int main()
{
    FILE *fd = fopen("test.txt","r+");
    if (fd == NULL)
    {
        perror("open");
        exit(1);
    }

    int total = 0;
    unsigned char buff[desiredSize];

    while (total < desiredLimit)
    {
        fpos_t  position;
        fgetpos (fd, &position);

        int numberOfBytes = fread(buff, sizeof(unsigned char), desiredSize, fd);
        printf("Read try: %d\n", numberOfBytes);
        if (numberOfBytes < desiredSize)
        {
            fsetpos(fd, &position);
            printf("Return\n");
            sleep(10);
            continue;
        }
        total += numberOfBytes;
        printf("Total: %d\n", total);
    }
    return 0;
} 
```

我正在从另一个控制台将文本添加到文件中，是的，根据我添加的内容，读取正在进行 5 个字符块。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-23T22:23:22.420

`fseek`似乎很适合这个：

```
FILE *fptr = fopen("test.txt","r+");
numberOfBytes = fread(buff, 1, desiredSize, fptr)
if (numberOfBytes < desiredSize) {
    fseek(fptr, -numberOfBytes, SEEK_CUR);
} 
```

另请注意，文件描述符是`open`返回的，而不是`fopen`.

# android - 如何在RelativeLayout中找到导致循环依赖的原因

> ID：16047781
> 
> 赞同：4
> 
> 时间：2013-04-16T21:52:59.933
> 
> 标签：android, android-layout, android-relativelayout

我收到了 FC 的堆栈跟踪，但我无法重现 FC。我错过了什么？

在 java 代码中，一些视图被设置为`View.GONE`或`View.VISIBLE`取决于应用程序的状态。在`LayoutParams`我只改变大小和边距。

嵌套的 2`RelativeLayouts`是因为活动具有半透明主题，第二个是用户可以应用的 alphafilter。

任何帮助都会很棒！

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/FNContainer"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:background="@color/clr_background"
android:paddingTop="8dp" >

<RelativeLayout
    android:id="@+id/AlphaContainer"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <xx.xxxxxx.guielements.Footer
        android:id="@+id/footerInclude"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true" />

    <xx.xxxxxx.guielements.RoseImageView
        android:id="@+id/RoseView"
        android:layout_width="fill_parent"
        android:layout_height="200dp"
        android:layout_above="@id/footerInclude"
        android:layout_centerHorizontal="true"
        android:layout_margin="5dp" />

    <TextView
        android:id="@+id/tvBeschrijving"
        android:layout_width="fill_parent"
        android:layout_height="250dp"
        android:layout_alignParentTop="true"
        android:layout_alignParentLeft="true"
        android:layout_marginLeft="8dp" />

    <xx.xxxxxx.guielements.HmpImageView
        android:id="@+id/HmpView"
        android:layout_width="200dp"
        android:layout_height="200dp"
        android:layout_alignParentLeft="true"
        android:layout_below="@id/tvBeschrijving"
        android:layout_marginLeft="8dp" />

    <TextView
        android:id="@+id/tvDistToEnd"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@id/HmpView"
        android:text="TC Eind: 1253m"
        android:textSize="20sp"
        android:textStyle="bold" />

    <TextView
        android:id="@+id/tvSnelheid"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentTop="true"
        android:layout_alignParentRight="true"
        android:gravity="top|right"
        android:text="120"
        android:textSize="70sp"
        android:textStyle="bold" />

    <TextView
        android:id="@+id/tvSnelheidAanduiding"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_below="@id/tvSnelheid"
        android:gravity="top|right"
        android:text="km/u"
        android:textSize="20sp" />

    <TextView
        android:id="@+id/tvVavg"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_below="@id/tvSnelheidAanduiding"
        android:text="120"
        android:textSize="70sp"
        android:textStyle="bold" />
    <TextView
        android:id="@+id/tvVavgAanduiding"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_below="@id/tvVavg"
        android:gravity="top|right"
        android:text="Ø km/u"
        android:textSize="20sp" />

    <TextView
        android:id="@+id/tvVmaxOnderbord"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_above="@id/footerInclude"
        android:layout_alignParentRight="true"
        android:background="@drawable/onderbord"
        android:gravity="center"
        android:text="6-18h"
        android:textSize="20sp"
        android:textStyle="bold"
        android:visibility="gone" />

    <TextView
        android:id="@+id/tvVmax"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_above="@id/tvVmaxOnderbord"
        android:layout_alignParentRight="true"
        android:background="@drawable/bg_vmax"
        android:gravity="center"
        android:text="120"
        android:textSize="20sp"
        android:textStyle="bold"
        android:visibility="gone" />

</RelativeLayout> 
```

```
java.lang.IllegalStateException: Circular dependencies cannot exist in RelativeLayout
at android.widget.RelativeLayout$DependencyGraph.getSortedViews(RelativeLayout.java:1321)
at android.widget.RelativeLayout.sortChildren(RelativeLayout.java:316)
at android.widget.RelativeLayout.onMeasure(RelativeLayout.java:337)
at android.view.View.measure(View.java:15562)
at android.widget.RelativeLayout.measureChildHorizontal(RelativeLayout.java:617)
at android.widget.RelativeLayout.onMeasure(RelativeLayout.java:399)
at android.view.View.measure(View.java:15562)
at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:5109)
at android.widget.FrameLayout.onMeasure(FrameLayout.java:310)
at android.view.View.measure(View.java:15562)
at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:5109)
at android.widget.LinearLayout.measureChildBeforeLayout(LinearLayout.java:1396)
at android.widget.LinearLayout.measureVertical(LinearLayout.java:681)
at android.widget.LinearLayout.onMeasure(LinearLayout.java:574)
at android.view.View.measure(View.java:15562)
at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:5109)
at android.widget.FrameLayout.onMeasure(FrameLayout.java:310)
at com.android.internal.policy.impl.PhoneWindow$DecorView.onMeasure(PhoneWindow.java:2397)
at android.view.View.measure(View.java:15562)
at android.view.ViewRootImpl.performMeasure(ViewRootImpl.java:1987)
at android.view.ViewRootImpl.measureHierarchy(ViewRootImpl.java:1228)
at android.view.ViewRootImpl.performTraversals(ViewRootImpl.java:1401)
at android.view.ViewRootImpl.doTraversal(ViewRootImpl.java:1121)
at android.view.ViewRootImpl$TraversalRunnable.run(ViewRootImpl.java:4598)
at android.view.Choreographer$CallbackRecord.run(Choreographer.java:725)
at android.view.Choreographer.doCallbacks(Choreographer.java:555)
at android.view.Choreographer.doFrame(Choreographer.java:525)
at android.view.Choreographer$FrameDisplayEventReceiver.run(Choreographer.java:711)
at android.os.Handler.handleCallback(Handler.java:615)
at android.os.Handler.dispatchMessage(Handler.java:92)
at android.os.Looper.loop(Looper.java:137)
at android.app.ActivityThread.main(ActivityThread.java:4921)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:511)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1038)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:805)
at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T22:26:27.773

我看起来认为你的 xml 并且看起来你没有任何循环引用，如果你说你将一些视图设置为消失我会看看你可以[在这里](http://android-developers.blogspot.com/2009/02/android-layout-tricks-1.html "Here")`android:layout_alignWithParentIfMissing="true"`找到一个例子

我也尝试不将您的任何观点设置为消失，看看您是否仍然有问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T22:23:42.760

通常，当您将视图 A 设置为与另一个视图 B 对齐并且视图 B 与 A 对齐时，就会发生这种情况，这样就会产生循环依赖。

当您设置另一个视图的 id 时，它会发生在上面、下面和对齐等属性上。

# asp.net - 在中继器中找到 div，并更改它的样式元素

> ID：16047793
> 
> 赞同：0
> 
> 时间：2013-04-16T21:53:43.927
> 
> 标签：asp.net, vb.net, html, asprepeater

我有一个如下所示的转发器对象

```
<asp:Repeater id="rptSpecialNotes" runat="server">
                    <headerTemplate><ol type="A"></HeaderTemplate>
                    <itemtemplate>
                                <li>
                                </li>
                        <asp:UpdatePanel ID="udpSpecialNotesRepeater" runat="server" UpdateMode="Always">
                            <ContentTemplate>

                                    <div id="specialNotes" name='<%# Eval("itemId") %>' runat="server">
                                        <asp:imagebutton runat="server"  width="20" class="floatLeft" id="specialNotesItem" imageurl='<%# Eval("ImageUrl") %>'  commandname="specialNotesImageChange" commandargument='<%# Eval("itemId") %>'></asp:imagebutton>
                                        <span class="subject"><p><%# eval("Subject") %></p></span>
                                        <br /><br />
                                        <p><%# Eval("AgendaNote")%></p>
                                        <br />
                                    </div>

                            </ContentTemplate>
                            <Triggers>
                                <asp:AsyncPostBackTrigger ControlID ="followAlongControl" EventName ="Tick" />
                            </Triggers>
                        </asp:UpdatePanel>
                        <asp:Repeater id="specialNotesAttachmentsRepeater" OnItemCommand="specialNotesAttachmentRepeater_ItemCommand" runat="server" datasource='<%# Container.DataItem.Row.GetChildRows("attachmentRelation") %>' >
                            <itemtemplate>
                                <br />
                                <a href='<%# Container.DataItem("attachmentPath") %>'><%# Container.DataItem("attachmentName") %></a>&nbsp;&nbsp;
                                </itemtemplate>
                        </asp:Repeater>
                    </itemtemplate>
                    <footerTemplate></ol></FooterTemplate>
                </asp:Repeater> 
```

我想根据图像按钮的 imageurl 更改 div 'specialNotes' 的背景颜色。因此，如果选中，则 div 将为灰色，如果没有，则将其留空。

有没有办法在 VB 的代码隐藏中做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T22:04:14.943

将 a 添加`runat="server"`到您的 div 标签。然后您的代码在后面，您可以使用以下命令访问该 div：

`udpSpecialNotesRepeater.FindControl("div")`

在您的 DataBound 事件上。

不过，在 jQuery 中执行此操作要容易得多。您可以只获取 div 的 id`$("#specialNotes")`并使用该`.attr`函数来更改其背景。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T22:11:06.017

您不必在页面加载后“查找”div，您可以在它被绑定时执行此操作。我想当你说“如果它被选中”时，你指的是 imagebutton 作为一个复选框，并且你想根据图像的位置（路径）来改变颜色。所以我会在 div 中这样做：

```
<div style='<%# doColor(Eval("ImageUrl")) %>'>
    Content in the div
</div> 
```

然后在后面的代码中：

```
Public Function doColor(img As Object) As String
    If img.ToString() = "MyPath" Then
        Return "background-color:red"
    Else
        Return "background-color:green"
    End If
End Function 
```

这样，如果 ImageUrl 等于“MyPath”，则 div 的背景将为红色，否则为绿色。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-24T07:23:18.987

可以使用：

```
Control divControl=e.Item.FindControl("divControl"); 
```

# css - 禁用 JQuery UI 对话框的 JS 定位

> ID：16047795
> 
> 赞同：2
> 
> 时间：2013-04-16T21:53:46.253
> 
> 标签：css, jquery-ui, position, jquery-ui-dialog

我正在尝试禁用 JQuery UI dialog() 小部件的 JS 自动定位，以便我可以使用 CSS 进行定位（这对定位元素响应更快）。

我知道我可以像这样进行位置重置：

```
top: auto !important; /* for normal browsers */
left: auto !important;
top: initial !important; /* for chrome */
left: initial !important; 
```

......但它很丑，而且看起来有点矫枉过正。JQuery UI 的 API 给了我零。

**是否可以阻止 JQuery UI 将`top`和`left`css 属性分配给 UI Dialog 小部件？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T01:45:32.947

“位置”选项对我来说似乎非常全面，而且我不知道使用纯非 hacky、非！重要的 CSS 来定位对话框的记录方法。

话虽如此，这里有一个 hacky、无证、将来会失败的方法来做你要求的事情。它涉及覆盖内部`_position`方法。

JSFiddle：http: [//jsfiddle.net/antishok/2puF8/1/](http://jsfiddle.net/antishok/2puF8/1/)

HTML：`<div id="d">hey hey</div>`

CSS：

```
.dialog {
    position: absolute;
    left:20px;
    top:20px;
} 
```

JS：

```
var d = $('#d');

d.dialog({
    autoOpen: false,
    dialogClass: 'dialog'
});

d.data('uiDialog')._position = $.noop;

d.dialog('open');

// if you want it for all dialogs:
// $.ui.dialog.prototype._position = $.noop; 
```

# c# - 保存新创建的对象 ASP.NET MVC

> ID：16047804
> 
> 赞同：0
> 
> 时间：2013-04-16T21:54:23.817
> 
> 标签：c#, asp.net-mvc, entity-framework, repository

我使用的是 EF Code First，这是我的类，它引用了一个教授对象。

```
public class Mark
    {
        public int MarkId { get; set; }
        [Required(ErrorMessage = "Please provide Grade")]
        [Display(Name = "Grade Value")]
        public int MarkValue { get; set; }

        [Required(ErrorMessage = "Please provide grade type")]
        [Display(Name = "Grade Type")]
        public string Type { get; set; }

        [Required(ErrorMessage = "Please provide Subject")]
        [Display(Name = "Subject")]
        public virtual Subject Subject { get; set; }
        public virtual User User { get; set; }
        public virtual Professor Professor { get; set; }

    } 
```

在我看来，我有一个下拉菜单来选择一个打分的教授。我是这样实现的：

```
//controller
 public MarksController() : this(new MarkRepository())
        {
            IProfessorRepository professorsRepo = new ProfessorRepository();
            List<Professor> professors = professorsRepo.All.ToList<Professor>();

            List<SelectListItem> items = new List<SelectListItem>();
            foreach (Professor p in professors)
            {
                items.Add(new SelectListItem 
                { 
                    Text = String.Concat(p.FirstName, " ", p.LastName), Value = p.ProfessorId.ToString() 
                });
            }

            items.Add(new SelectListItem
            {
                Text = "Please select Professor", Value = "0", Selected = true
            });

            ViewBag.Professors = items;
        }
//view create or edit
<div class="editor-label">
    @Html.LabelFor(model => model.MarkValue)
</div>
<div class="editor-field">
    @Html.EditorFor(model => model.MarkValue)
    @Html.ValidationMessageFor(model => model.MarkValue)
</div>

<div class="editor-label">
    @Html.LabelFor(model => model.Type)
</div>
<div class="editor-field">
    @Html.EditorFor(model => model.Type)
    @Html.ValidationMessageFor(model => model.Type)
</div>

<div class="editor-label">
    @Html.LabelFor(model => model.Professor)
</div>

<div class="editor-field">
    @Html.DropDownList("Professors");
</div> 
```

是的，我知道 Controller 中有一个名为 Create 的方法，它调用存储库方法 InsertOrUpdate。

```
[HttpPost]
        public ActionResult Create(Mark mark)
        {
            if (ModelState.IsValid) {
                markRepository.InsertOrUpdate(mark);
                markRepository.Save();
                return RedirectToAction("Index");
            } else {
                return View();
            }
        }

 public void InsertOrUpdate(Mark mark)
        {
            if (mark.MarkId == default(int)) {
                // New entity
                context.Marks.Add(mark);
            } else {
                // Existing entity
                context.Entry(mark).State = EntityState.Modified;
            }
        } 
```

一切似乎都合乎逻辑，但是如何在选择教授的情况下保存新创建的 Mark 对象？ASP.NET 如何安排传递给Controller 上Create 方法的对象？我应该如何将选定的教授与我正在创建的标记相匹配？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T23:27:12.343

看看这个，模型中需要一个ProfessorId。 [模型绑定下拉选择值](https://stackoverflow.com/questions/5141714/model-binding-dropdown-selected-value)

```
public class Mark
{

    // this will hold the selected value

    public string ProfessorID { get; set; }

    public IEnumerable<SelectListItem> Professors
    { 
        get
        {
            return Proffessors                
                .Select(x => new SelectListItem {
                    Value = x.ProfessorId.ToString(),
                    Text = String.Concat(p.FirstName, " ", p.LastName)
                });
        } 
    }

 public IEnumerable<Professor> Proffessors     
  {
     get
     {
         IProfessorRepository professorsRepo = new ProfessorRepository();
          return professorsRepo.All;
     }
 }

  //the rest of your code
} 
```

在视图中做

```
@Html.DropDownListFor(
    x => x.ProfessorId, 
    new SelectList(Model.Professors, "Value", "Text")
) 
```

# sql - SQL - 仅当所有记录都匹配时才更新字段

> ID：16047805
> 
> 赞同：0
> 
> 时间：2013-04-16T21:54:25.447
> 
> 标签：sql, sql-server-2008

我对 SQL 相当陌生，并且对 UPDATE 查询有疑问。我正在使用 SQL Server 2008 R2。我编写了以下 SELECT 查询：

```
SELECT res.labresultcat_id, res.patient_id, lab.test_performed,
lab.result_status, lab.result_value, lab.abnormal_flag, res.recorded_on, 
res.cat_test_name, res.results_to, usr.last_name, res.result_viewed
FROM dbo.med_labresultcat res
INNER JOIN dbo.med_labresult lab
ON res.labresultcat_id = lab.labresultcat_id
LEFT JOIN dbo.res_user usr
ON res.results_to = usr.resource_id
WHERE lab.result_status = 'F' AND usr.last_name = 'Smith'
AND res.result_viewed is NULL 
```

结果如下所示：

```
patient_id    result_id   test_performed     abnormal_flag    recorded_on    results_to    
0001          0045        ABC                N                4/1/2013       14            
0001          0045        CBS                A                4/1/2013       14           
0002          0061        NBC                N                4/3/2013       13            
0002          0061        MST                N                4/3/2013       13
0003          0090        ABC                H                4/20/2013      10
0003          0090        MST                N                4/20/2013      10 
```

因此，我编写了以下 UPDATE 查询：

```
;WITH lab AS  (SELECT res.labresultcat_id, res.patient_id, lab.test_performed,
lab.result_status, lab.result_value, lab.abnormal_flag, res.recorded_on, 
res.cat_test_name, res.results_to, usr.last_name, res.result_viewed
FROM dbo.med_labresultcat res
INNER JOIN dbo.med_labresult lab
ON res.labresultcat_id = lab.labresultcat_id
LEFT JOIN dbo.res_user usr
ON res.results_to = usr.resource_id
WHERE lab.result_status = 'F' AND usr.last_name = 'Smith'
AND res.result_viewed is NULL AND (abnormal_flag = 'N' OR abnormal_flag is NULL))
UPDATE lab SET results_to = '184' 
```

上述查询确实更新了分配给实验室结果的人员。但是，如果具有相同 result_id 的所有结果都是“N”或 NULL，我只需要更新 results_to 字段。

如果非常感谢任何帮助。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T22:00:32.893

只需将 where 子句附加到您的更新语句并在该 where 语句中执行匹配子句。

# eclipse - 任务无法继续，因为没有安装 ECJ——在 Eclipse ant 中

> ID：16047806
> 
> 赞同：6
> 
> 时间：2013-04-16T21:54:35.463
> 
> 标签：eclipse, ant, installation

我有一些蚂蚁任务，在第一次运行时说

```
Task cannot continue because ECJ is not installed.

ECJ was automatically installed. Please rerun your task. 
```

使用独立运行时`Ant`，它第二次运行正常。我不知道是什么`ECJ`，但显然它是独立安装的`Ant`。

相反，当运行`Eclipse` `An`此消息持续存在时，即`ECJ`未安装到`Eclipse'` `Ant`.

如何解决这种情况？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-05-16T11:38:45.117

[这个页面](http://www.liferaysolution.com/2012/09/solve-ecj-error-in-liferay-ide.html#.UZS8CrV9Lhg)帮助了我：

1.  在 Eclipse 中，转到 Window->Preferences->Ant->Runtime
2.  选择“蚂蚁首页条目（默认）”
3.  添加外部 JAR `ecj.jar`.... [在Liferay Plugins SDK](http://www.liferay.com/downloads/liferay-portal/available-releases)`lib`的文件夹中可用。
4.  Ant 现在应该可以从你的`build.xml`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-28T11:15:35.250

**我在 Windows**中遇到了类似的问题。我做了以下事情。

${ant.home}/lib 文件夹中有一个 jar 文件（ecj.jar）。该文件不可访问。将环境变量 ANT_HOME_PATH 设置为 apache ant.解决了我的问题。

注意：将该变量指向 ant home 而不是 bin 目录。

# raphael - 如何获取使用 raphael 创建的 DOM 对象的 raphael 元素？

> ID：16047807
> 
> 赞同：3
> 
> 时间：2013-04-16T21:54:40.343
> 
> 标签：raphael

使用 Raphael，我可以使用以下代码获取对元素的 DOM 对象的引用：

```
 element.node 
```

如何获取链接到 DOM 对象的元素？换句话说，与上面的函数相反（例如 DOMobject.element）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T22:31:29.330

使用 RaphaelJS 创建的节点具有`raphaelid`属性或非常接近的属性，您可以登录 Chrome DevTools 或类似工具。

因为你知道这个特定的 ID，并且你有一个 Raphael`Paper`实例的引用作为`paper`变量，你得到的元素是：

```
paper.getById(node.raphaelid) 
```

实际上，这是非常无证的。RaphaelJS 文档中仅记录了该`getById`方法[（Paper.getById 部分）](http://raphaeljs.com/reference.html#Paper.getById)

**更新关于无法在 DOM 元素上获取 raphaelid 的评论**

请看一下这个[关于获取 raphaelid](http://jsfiddle.net/7xCFL/)的 jsfiddle 。

HTML

```
<div id="c"></div>
<div><code>rect.node.raphaelid</code> : <span id="i"></span></div>
<div><code>rect2.node.raphaelid</code> : <span id="i2"></span></div> 
```

JS

```
var paper = Raphael(c,400,400);

var rect = paper.rect(100,100,200,200);
var rect2 = paper.rect(150,150,200,200);

i.textContent = rect.node.raphaelid;
i2.textContent = rect2.node.raphaelid; 
```

文本结果

> rect.node.raphaelid：0
> 
> rect2.node.raphaelid：1

所有这一切都与 RaphaelJS 2.1.0 版本有关

# jquery - worklight 5.0.6 JsonRestStore，Promises 的使用

> ID：16047808
> 
> 赞同：0
> 
> 时间：2013-04-16T21:54:45.487
> 
> 标签：jquery, ibm-mobilefirst, deferred, jsonstore

这最初是关于 Worklight 文档的问题，它表明我真正的问题是关于 JQuery 的 Deferred/Promise API 和 promise.then() 函数。

语境：

[5.0.6 JsonRestStore API](http://pic.dhe.ibm.com/infocenter/wrklight/v5r0m6/index.jsp?topic=/com.ibm.worklight.help.doc/apiref/r_wl_jsonstore_initcollection.html)的文档提供了使用新 Promise 功能的示例，提供了两种可能的公式。

```
someFunction.then( 
             successCallback,
             errorCallback,
             optionalProgressCallback); 
```

和

```
 someFunction().then(successCallback).fail(errorCallback) 
```

正如评论和答案所述，这两种方法似乎实际上是相同的。

我的困惑是[JQuery 文档](http://api.jquery.com/deferred.then/)指出 then() 返回一个“新承诺”。

因此在第二种情况下，我们正在编码：

```
 var p1 = someFunction();
  var p2 = p1.then(successCallback);
  p2.fail(errorCallback); 
```

我还看到人们设置了这样的“链”动作：

```
 someFunction().then(action2).then(action3).then(action4); 
```

设置异步操作链。所以我的问题变成了上面示例中的承诺 p1 和 p2 之间的关系是什么。这与连锁理念有什么关系？

---编辑以参考答案---

感谢 cnandreu：关键点是“错误会沿着承诺链传播，直到找到错误处理程序。” 答案[在这里得到了很好的解释](http://blog.parse.com/2013/01/29/whats-so-great-about-javascript-promises/)。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T23:08:55.567

```
var p1 = someFunction();
var p2 = p1.then(successCallback);
p2.fail(errorCallback); 
```

> 所以我的问题变成了上面示例中的承诺 p1 和 p2 之间的关系是什么。这与连锁理念有什么关系？

Promise 是一种处理异步代码的方式，这里有一个[简短的视频](https://tutsplus.com/lesson/deferreds/)和[文章](http://net.tutsplus.com/tutorials/javascript-ajax/wrangle-async-tasks-with-jquery-promises/)来解释它们。`someFunction()`将执行一个异步任务，当它完成时（即被[解决](http://api.jquery.com/deferred.resolve/)）它执行`successCallback`，如果失败（即被[拒绝](http://api.jquery.com/deferred.resolve/)）它执行`errorCallback`. 这种关系是`p2`一个承诺，只有在`p1`被[拒绝](http://api.jquery.com/deferred.reject/)时才会执行。把`p1.then(win, fail)`和想象`p1.then(win).fail(fail)`成写同一件事的两种方式。

最初的问题可能是指以下内容：

> 在调用 JSONStore 异步操作（查找、添加、删除等）后返回一个 Promise 对象。[...] [JSONStore.add, JSONStore.find, etc.] 失败回调，作为 .then 的第二个参数或 .fail 的第一个参数传递，返回一个错误对象，[...]

来自[JSONStore 文档](http://pic.dhe.ibm.com/infocenter/wrklight/v5r0m6/index.jsp?topic=%2Fcom.ibm.worklight.help.doc%2Fapiref%2Fr_class_wl_jsonstore.html)。该文档是特定于 JSONStore API 的，我们建议读者参考 jQuery 文档以了解 Promise 的一般工作方式（*有关更多详细信息，请参阅 jQuery 的 API 文档。*）。

这是一个例子：

```
var collections = {
        people : {
            searchFields : {name: 'THIS_SHOULD_PRODUCE_AN_ERROR'}
        }
    };

WL.JSONStore.init(collections)

.then(function(res){
    //the code here should not be called because we expect to fail
    console.log(typeof res === 'object' ? JSON.stringify(res) : res);
})

.fail(function(err){
    console.log(err.toString());
}); 
```

输出是：

```
{"src":"initCollection","err":-12,"msg":"INVALID_SEARCH_FIELD_TYPES","col":"people","usr":"jsonstore","doc":{},"res":{}} 
```

如果我们切换到`.then(success, failure)`：

```
var collections = {
        people : {
            searchFields : {name: 'THIS_SHOULD_PRODUCE_AN_ERROR'}
        }
    };

var success = function(res){
    //the code here should not be called because we expect to fail
    console.log(typeof res === 'object' ? JSON.stringify(res) : res);
};

var failure = function(err){
    console.log(err.toString());
};

WL.JSONStore.init(collections).then(success, failure); 
```

我们得到相同的输出：

```
{"src":"initCollection","err":-12,"msg":"INVALID_SEARCH_FIELD_TYPES","col":"people","usr":"jsonstore","doc":{},"res":{}} 
```

混合它们，选择一个或使用已弃用的回调。文档中的所有 JSONStore 示例都应按预期工作。请使用文档中的真实引用和一个表明文档错误的真实示例来更新您的问题，我将更新我的答案。如果事实证明*有*问题，我会尽一切可能修复它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T17:52:01.783

它们在功能上是相同的，这基本上就是链接的工作原理吗？您有 2 个选择，要么获取一个调用的输出，并将其链接到下一个调用，要么您可以将结果保存在命名变量中，然后对该命名变量调用下一个操作。

```
var str = "   fooo ";
str.trim().indexOf('f'); 
```

相对

```
var str = "   fooo ";
var strTrimmed = str.trim()
strTrimmed.indexOf('f'); 
```

# r - 根据 R 中的一些组索引对矩阵进行排序

> ID：16047814
> 
> 赞同：1
> 
> 时间：2013-04-16T21:55:04.997
> 
> 标签：r, plyr

我有一个如下生成的矩阵：

```
set.seed(999)
mat.a = matrix(round(rnorm(24,4,9)),3,8)
mat.a 
```

`mat.a`看起来像这样：

```
 [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]
[1,]    1    6  -13   -6   12   -8   12   10
[2,]   -8    2   -7   16    6    5  -15    1
[3,]   11   -1   -5    5   13    5   -7    7 
```

现在，假设我想**根据一些组索引**`mat.a`对每一行从最小到最大进行排序。如您所见，有 8 列，对应于

 **```
grp.ids = as.factor(c(1,1,1,2,2,2,3,3)) 
```

即，前 3 列用于第 1 组，接下来的 3 列用于第 2 组，最后两列用于第 3 组。所需的是**在每个组内**进行排序，以便结果是一个矩阵（调用它`mat.b`）像这样：

```
 [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]
[1,]  -13    1    6   -8   -6   12   10   12
[2,]   -8   -7    2    5    6   16  -15    1
[3,]   -5   -1   11    5    5   13   -7    7 
```

`mat.a`有没有办法通过传递和`grp.ids`获取排序矩阵来有效地编写函数`mat.b`？在 ? 中应用一些功能`plyr`？非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T22:08:01.440

您可以编写一个函数，然后将其应用于每一行：

```
sort.vec <- function(x, grp.ids) ave(x, grp.ids, FUN = sort)
t(apply(mat.a, 1, sort.vec, grp.ids)) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T23:30:09.750

```
 t( apply(mat.a, 1, function(row) row[order(c(1,1,1,2,2,2,3,3), row)] ) )
     [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]
[1,]  -13    1    6   -8   -6   12   10   12
[2,]   -8   -7    2    5    6   16  -15    1
[3,]   -5   -1   11    5    5   13   -7    7 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-16T22:20:33.707

```
matrix(unlist(lapply(split(mat.a, 1:nrow(mat.a)),
                     function(row) tapply(row, grp.ids, sort))),
       nrow = nrow(mat.a), byrow = TRUE) 
```**

# sql - 从java调用带有表值参数的存储过程

> ID：16047818
> 
> 赞同：13
> 
> 时间：2013-04-16T21:55:19.633
> 
> 标签：sql, sql-server, stored-procedures, jdbc, parameters

在我的应用程序中，我想执行**SELECT * FROM tbl WHERE col IN (@list)**之类的查询，其中@list 可以有可变的值。我正在使用 MS SQL 服务器数据库。当我用谷歌搜索这个问题时，我发现了这个链接

[http://www.sommarskog.se/arrays-in-sql-2008.html](http://www.sommarskog.se/arrays-in-sql-2008.html)

该链接说使用表值参数。所以我使用 Microsoft SQL Server Management Studio 创建了用户定义的数据类型。

**CREATE TYPE integer_list_tbltype AS TABLE (n int NOT NULL PRIMARY KEY)**

然后我写了存储过程

```
CREATE PROCEDURE get_product_names @prodids integer_list_tbltype READONLY AS
   SELECT p.ProductID, p.ProductName
   FROM   Northwind.dbo.Products p
   WHERE  p.ProductID IN (SELECT n FROM @prodids) 
```

然后只使用管理工作室我执行了这个过程

```
DECLARE @mylist integer_list_tbltype
INSERT @mylist(n) VALUES(9),(12),(27),(37)
EXEC get_product_names @mylist 
```

它给了我正确的输出。但我想知道如何从 java 源代码调用这个存储过程。我知道如何用常数个参数调用简单的存储过程

```
CallableStatement proc_stmt = null;
proc_stmt = con.prepareCall("{call test(?)}");
proc_stmt.setString(1,someValue); 
```

但是如何在表值参数情况下调用存储过程？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2017-02-01T10:45:03.440

这在[JDBC 驱动程序手册](https://msdn.microsoft.com/en-us/library/mt651781(v=sql.110).aspx)中进行了记录。在你的情况下，你必须这样做：

```
try (SQLServerCallableStatement stmt =
    (SQLServerCallableStatement) con.prepareCall("{call test(?)}")) {

    SQLServerDataTable table = new SQLServerDataTable();   
    sourceDataTable.addColumnMetadata("n", java.sql.Types.INTEGER);   

    sourceDataTable.addRow(9);
    sourceDataTable.addRow(12);
    sourceDataTable.addRow(27);
    sourceDataTable.addRow(37);

    stmt.setStructured(1, "dbo.integer_list_tbltype", table);  
} 
```

[我最近也在一篇文章中记录了这一点](https://blog.jooq.org/2017/01/10/jooq-3-10-will-support-sql-servers-table-valued-parameters/)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-16T22:09:28.863

看起来这是对 JDBC 的计划添加，但尚未实现：

[http://blogs.msdn.com/b/jdbcteam/archive/2012/04/03/how-would-you-use-table-valued-parameters-tvp.aspx](http://blogs.msdn.com/b/jdbcteam/archive/2012/04/03/how-would-you-use-table-valued-parameters-tvp.aspx)

将参数作为分隔字符串 ("9,12,27,37") 传递，然后在 SQL Server 中创建一个名为 "fnSplit" 的表值函数或任何将在表中返回整数值的函数（只需搜索 "sql服务器拆分功能，”有数百万个）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-07-09T21:50:10.203

典型的答案（逗号分隔或 XML）都存在 SQL 注入问题。我需要一个允许我使用 PreparedStatement 的答案。所以我想出了这个：

```
StringBuilder query = new StringBuilder();
query.append(
  "DECLARE @mylist integer_list_tbltype;" +
  "INSERT @mylist(n) VALUES(?)");
for (int i = 0; i < values.size() - 1; ++i) {
  query.append(",(?) ");
}
query.append("; EXEC get_product_names @mylist ");
PreparedStatement preparedStmt = conn.prepareStatement(query.toString());
for (int i = 0; i < values.size(); ++i) {
    preparedStmt.setObject(i + 1, itemLookupValues.get(i));
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-06-12T00:35:04.343

现在它已被添加到 JDBC Driver 6.0。它CTP2呢。

“这个新的驱动程序现在支持表值参数和 Azure Active Directory。除了这些新功能之外，我们还为 Always Encrypted 添加了额外的功能。该驱动程序还支持国际化域名和参数化。”

[https://blogs.msdn.microsoft.com/jdbcteam/2016/04/04/get-the-new-microsoft-jdbc-driver-6-0-preview/](https://blogs.msdn.microsoft.com/jdbcteam/2016/04/04/get-the-new-microsoft-jdbc-driver-6-0-preview/)

下载链接：[https ://www.microsoft.com/en-us/download/details.aspx?displaylang=en&id=11774](https://www.microsoft.com/en-us/download/details.aspx?displaylang=en&id=11774)

这是如何使用它的文档 [https://msdn.microsoft.com/en-us/library/mt651781(v=sql.110).aspx](https://msdn.microsoft.com/en-us/library/mt651781(v=sql.110).aspx)

* * *

## 回答 #5

> 赞同：-7
> 
> 时间：2013-04-18T14:21:52.427

在搜索了一段时间后，我找到了这个问题的答案。特别是当您使用 IN 子句并且没有操作数是可变的时，您可以使用逗号分隔的值作为 IN 子句中的输入。

下面是一个示例，该存储过程将在提供的邮政编码中检索给定律师类型的所有律师，该过程将如何使用动态 SQL。

```
CREATE PROCEDURE [dbo].[GetLawyers] ( @ZIP CHAR(5), @LawyerTypeIDs VARCHAR(100) )
AS

DECLARE @SQL     VARCHAR(2000)

SET @SQL = 'SELECT * FROM [dbo].[Lawyers]
            WHERE [ZIP] = ' + @ZIP + ' AND
                  [LawyerTypeID] IN (' + @LawyerTypeIDs + ')'
EXECUTE (@SQL)

GO 
```

要执行传递用户输入的邮政编码和所选律师的存储过程，请输入逗号分隔值：

```
EXECUTE [dbo].[GetLawyers] '12345', '1,4' 
```

所以结论是你不需要使用TVP。无论您使用哪种语言 [Java、PHP]，只需将参数作为逗号分隔的字符串传递给存储过程，它就会完美运行。

所以在JAVA中你可以调用上面的存储过程：-

```
proc_stmt = con.prepareCall("{call GetLawyers(?,?)}");
proc_stmt.setString(1,"12345");
proc_stmt.setString(2,"'1,4'"); 
```

# python - Python下一个子字符串搜索

> ID：16047823
> 
> 赞同：0
> 
> 时间：2013-04-16T21:55:31.897
> 
> 标签：python, string, search, substring

我正在多次发送带有前置/后置码的消息。我希望能够在两个有效的前置/后置码之间提取消息。我当前的代码是

```
print(msgfile[msgfile.find(preamble) + len(preamble):msgfile.find(postamble, msgfile.find(preamble))]) 
```

问题是如果后同步码损坏，它将打印第一个有效前同步码和下一个有效后同步码之间的所有数据。接收到的文本文件示例为：

```
garbagePREAMBLEmessagePOSTcMBLEgarbage
garbagePRdAMBLEmessagePOSTAMBLEgarbage
garbagePREAMBLEmessagePOSTAMBLEgarbage 
```

它会打印

```
messagePOSTcMBLEgarbage
garbagePRdEAMBLEmessage 
```

但我真正希望它打印的是来自第三行的消息，因为它具有有效的前置/后置码。所以我想我想要的是能够从子字符串的下一个实例中查找和索引。是否有捷径可寻？

编辑：我不希望我的数据是很好的离散行。我只是这样格式化它，这样更容易看到

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T22:15:36.797

```
import re

lines = ["garbagePREAMBLEmessagePOSTcMBLEgarbage",
        "garbagePRdAMBLEmessagePOSTAMBLEgarbage",
        "garbagePREAMBLEmessagePOSTAMBLEgarbage"]

# you can use regex
my_regex = re.compile("garbagePREAMBLE(.*?)POSTAMBLEgarbage")

# get the match found between the preambles and print it
for line in lines:
    found = re.match(my_regex,line)
    # if there is a match print it
    if found:
        print(found.group(1))

# you can use string slicing
def validate(pre, post, message):
    for line in lines:
        # method would break on a string smaller than both preambles
        if len(line) < len(pre) + len(post):
            print("error line is too small")

        # see if the message fits the pattern
        if line[:len(pre)] == pre and line[-len(post):] == post:
            # print message
            print(line[len(pre):-len(post)])

validate("garbagePREAMBLE","POSTAMBLEgarbage", lines) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T22:16:15.813

所有消息都在单行上吗？然后，您可以使用正则表达式来识别具有有效前导和后导的行：

```
input_file = open(yourfilename)
import re
pat = re.compile('PREAMBLE(.+)POSTAMBLE')
messages = [pat.search(line).group(1) for line in input_file 
            if pat.search(line)]

print messages 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T22:12:18.817

逐行处理：

```
>>> test = "garbagePREAMBLEmessagePOSTcMBLEgarbage\n"
>>> test += "garbagePRdAMBLEmessagePOSTAMBLEgarbage\n"
>>> test += "garbagePREAMBLEmessagePOSTAMBLEgarbage\n"
>>> for line in test.splitlines():
        if line.find(preamble) != -1 and line.find(postamble) != -1:
            print(line[line.find(preamble) + len(preamble):line.find(postamble)]) 
```

# r - 未找到搜索词时在 R 中使用 -which() 的意外行为

> ID：16047825
> 
> 赞同：3
> 
> 时间：2013-04-16T21:55:44.337
> 
> 标签：r

我一直在使用 R`which`函数从数据框中删除行。我最近发现如果搜索词不在 data.frame 中，结果是一个空字符。

```
# 1: returns A-Q, S-Z (as expected)
LETTERS[-which(LETTERS == "R")]
# 2: returns "character(0)" (not what I would expect)
LETTERS[-which(LETTERS == "1")]
# 3: returns A-Z (expected)
LETTERS[which(LETTERS != "1")]
# 4: returns A-Q, S-Z (expected)
LETTERS[which(LETTERS != "R")] 
```

第二个示例`-which()`是未找到搜索词时的预期行为吗？我已经将我的代码切换为使用示例 4 中的语法，这似乎更安全，但我只是好奇。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-16T22:03:41.937

这是一个众所周知的陷阱。当没有与逻辑测试匹配时，which-function 返回 numeric(0)，然后 "[" 不返回任何内容，而不是返回预期的所有内容。您可以使用：

```
 LETTERS[ ! LETTERS == "1" ]
 LETTERS[ ! LETTERS %in% "1" ] 
```

还有另一个需要注意的问题，也是让我选择使用 which() 的问题。当使用逻辑索引时，“[”中使用的 NA 值将返回一行。我通常不希望这样，所以我使用`DFRM[ which(logical) ]`虽然这似乎打扰了一些说不需要的人。我只是认为他们正在处理小型数据集，并且很少遇到在他们的控制台上看到数以万计的 NA 引起的无用输出行的烦恼。我*从不*使用否定的哪个版本。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-16T22:02:28.493

因为这：

```
which(LETTERS == '-1')
## integer(0) 
```

和这个：

```
(1:2)[integer(0)]
integer(0) 
```

而不是＃4，使用这个：

```
LETTERS[LETTERS != "R"] 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-16T22:02:49.733

在示例 2 中，`which`返回`integer(0)`（长度为零的整数向量），因为没有值是`TRUE`. 负零长度向量 ( `-integer(0)`) 仍然是零长度向量。所以你本质上是在要求不存在的`NULL`元素。`LETTERS`

# spring - 代理无法转换为 CLASS

> ID：16047829
> 
> 赞同：26
> 
> 时间：2013-04-16T21:56:10.420
> 
> 标签：spring, hibernate, casting

我正在使用 Spring 专门为使用 Hibernate 的 DAO 类连接依赖项，但我遇到了一个让我感到困惑的异常：

**$Proxy58 无法转换为 UserDao**

我的DAO配置如下：

```
<bean id="userDao" class="com.domain.app.dao.UserDao">
    <property name="sessionFactory" ref="sessionFactory" />
</bean> 
```

我有一个接口、抽象基类和一个最终实现，如下所示。

界面：

```
public interface Dao {
    public void save(Object object);
    public Object load(long id);
    public void delete(Object object);
    public void setSessionFactory(SessionFactory sessionFactory);
} 
```

抽象基类：

```
public abstract class BaseDao implements Dao {

    private SessionFactory sessionFactory;

    @Transactional
    @Override
    public void save(Object object) {
        PersistentEntity obj = (PersistentEntity) object;
        currentSession().saveOrUpdate(obj);
    }

    @Transactional
    @Override
    public abstract Object load(long id);

    @Transactional
    @Override
    public void delete(Object object) {
        // TODO: this method!
    }

    public void setSessionFactory(SessionFactory sessionFactory) {
        this.sessionFactory = sessionFactory;
    }

    public Session currentSession() {
        return sessionFactory.getCurrentSession();
    }

} 
```

执行：

```
public class UserDao extends BaseDao implements Dao {

    @Transactional(readOnly=true)
    @Override
    public Object load(long id) {
        Object user = currentSession().get(User.class, id);
        return user;
    }

} 
```

以下抛出上述异常：

*UserDao dao = (UserDao) context.getBean("userDao");*

但是，这不会引发异常：

*Dao dao = (Dao) context.getBean("userDao");*

如果有人可以就为什么会发生这种异常提供任何帮助或指导，我将不胜感激。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2013-04-16T22:06:03.440

Spring 默认使用[JDK 动态代理](http://docs.oracle.com/javase/7/docs/api/java/lang/reflect/Proxy.html)（`$Proxy58`是其中之一），只能代理接口。这意味着动态创建的类型`$Proxy58`将实现一个或多个由包装/目标类 ( `UserDao`) 实现的接口，但它不会是它的实际子类。这就是为什么您可以将`userDao`bean 强制转换为`Dao` *interface*而不是`UserDao` *class*的原因。

您可以使用`<tx:annotation-driven proxy-target-class="true"/>`来指示 Spring 使用作为代理类的实际子类的 CGLIB 代理，但我认为针对接口进行编程是更好的做法。如果您需要访问代理类中未在其中一个接口中声明的某些方法，您应该首先问自己，为什么会这样？
（另外，在上面的代码中，没有引入新方法`UserDao`，因此无论如何将 bean 转换为这种具体的实现类型是没有意义的。）

[在官方Spring 参考](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/aop.html#aop-proxying)中查看更多关于不同代理机制的信息。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2016-06-02T23:26:56.013

我正在编写单元测试，并且需要能够为某些调用删除 DAO。根据这个家伙的帖子： [http](http://www.techper.net/2009/06/05/how-to-acess-target-object-behind-a-spring-proxy/) ://www.techper.net/2009/06/05/how-to-acess-target-object-behind-a-spring-proxy/ 我使用了他提供的方法：

```
@SuppressWarnings({"unchecked"})
protected <T> T getTargetObject(Object proxy, Class<T> targetClass) throws Exception {
  if (AopUtils.isJdkDynamicProxy(proxy)) {
    return (T) ((Advised)proxy).getTargetSource().getTarget();
  } else {
    return (T) proxy; // expected to be cglib proxy then, which is simply a specialized class
  }
} 
```

然后你可以很容易地用代理调用它，得到代理后面的对象，并根据需要直接操作其中的对象。

# git - 当有多个分叉时，Git 清理提交日志

> ID：16047834
> 
> 赞同：0
> 
> 时间：2013-04-16T21:56:31.997
> 
> 标签：git, git-commit, git-fork

我学会了[这个技巧](https://stackoverflow.com/questions/495345/git-removing-selected-commit-log-entries-for-a-repository)来清理提交日志。我想这样做，但我有点担心。

我的 repo 目前由几个人分叉，我想知道清理我自己的提交日志是否明智。例如，我不知道这是否会影响未来的拉取请求？请告诉我它是否安全，否则我应该期待什么样的问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T22:02:01.997

这可能不是最好的主意。重写历史记录对你自己的分支来说很好，但重写你已经推送的分支的历史记录是不明智的——这将导致任何已经从你的仓库中提取的人重复提交。

Git 手册对此有[更多信息](https://www.kernel.org/pub/software/scm/git/docs/git-rebase.html#_recovering_from_upstream_rebase)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T22:03:28.767

不要变基已共享的提交。如果其他人已经分叉了您的代码，那么他们的历史记录中就有这些提交。如果您尝试与这些分叉合并，您删除的提交将会回来。

一旦出版，历史就应该保持不变。

# vbulletin - vBulletin 中论坛词后的空格

> ID：16047839
> 
> 赞同：0
> 
> 时间：2013-04-16T21:56:59.560
> 
> 标签：vbulletin

实际上，我在制作我的风格时遇到了问题，我完成了这一切，但我遇到了一个问题， [这张照片](http://im37.gulfup.com/kSnto.png)显示了这个问题。如何在类别开头的论坛词之后删除这个巨大的空间？它是否也与某些标签有关？或者这是我为错误的类更改或添加值的错误？？有一个浮动容器标签，我认为这是有错误的标签。这部分的代码是：

```
 <div id="breadcrumb" class="breadcrumb">
<ul class="floatcontainer">
<li class="navbithome">
<li class="navbit lastnavbit">
<span>forum</span>
</li>
</ul>
<hr/>
</div> 
```

# sql - PL SQL - 从 user_triggers 中选择 column_name 总是返回一个空字符串

> ID：16047840
> 
> 赞同：1
> 
> 时间：2013-04-16T21:57:01.543
> 
> 标签：sql, database, plsql, oracle11g

我在 pl/sql 中做一个脚本，我使用“user_triggers”视图中的数据创建触发器创建脚本。我需要获取触发器引用的列的名称。它的值应该在“user_triggers”视图的“column_name”中。但是当我选择 column_name 值时，总是返回空字符串，即使我有这样的脚本：

```
 CREATE OR REPLACE TRIGGER trg_update_price
 BEFORE UPDATE OF PRET ON produse 
```

你知道为什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T00:42:13.973

USER_TRIGGERS.COLUMN_NAME 仅为嵌套表触发器填写，您未创建该触发器。您可能希望查看 TRIGGERING_EVENT 列以获取您要查找的信息。分享和享受。

# java - 如何使用 ChromeDriver 安全地结束程序

> ID：16047844
> 
> 赞同：4
> 
> 时间：2013-04-16T21:57:10.353
> 
> 标签：java, selenium

目前我有以下问题：

```
my code is 
WebDriver driver = new ChromeDriver();
driver.close(); 
```

但是有时会出错。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T21:58:43.013

尝试使用 driver.quit(); 不要使用 close(); 实际上，这是个问题，尤其是在您使用 Chrome 时。尝试也唱 Firefox。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-16T22:00:18.047

添加`driver.quit()`到 @AfterClass 方法

Close 将关闭当前活动窗口，如果它是最后一个窗口，则将执行 quit()，但它确实需要一个有效的活动会话才能执行此操作。

如果您的测试失败，则该会话可能已死，因此当您调用 close 时，它​​不知道将命令发送到何处并且不执行任何操作。

如果没有活动会话，退出将关闭所有客户端，因此如果您发送退出并且没有活动会话，它只会清理

# java - StAX Parsing - 在哪里保留元素模式？

> ID：16047848
> 
> 赞同：0
> 
> 时间：2013-04-16T21:57:21.500
> 
> 标签：java, xml, parsing, configuration, stax

我需要编写一个解析器来以以下格式保存 XML 中的数据：

```
<!-- Sample XML>
<Results>
    <TableA>
        <ID>7</ID>
        <Name>Joe</Name>
    </TableA>
    <TableA>
        <ID>8</ID>
        <Name>John</Name>
    </TableA>
</Results> 
```

进入一个`Map<String, Object>[]`. 每个 TableA 元素将是一个名称/值对的映射。

我将有大量不同的表需要处理，每个表都有自己的模式，具有不同的名称/值对，但布局相同。我不打算混合来自不同表的结果——我只想要一种加载模式和解析类似文档的通用方法。

**那么，在 Java 中存储/使用模式的最佳方式是什么？** 我对它还是比较陌生，还不太了解这些约定。我显然不想对它们进行硬编码。Spring 是最佳选择还是有其他选择？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-03T23:51:25.330

17 天后没有答案，所以写下我的解决方案最终是：

我们将模式存储在 spring 中作为映射，并直接加载 bean 以在解析器中使用。它似乎工作得相当好并且相当灵活。

# d3.js - 如何使用 nvd3.js multiBarChart 正确显示堆叠数据

> ID：16047850
> 
> 赞同：5
> 
> 时间：2013-04-16T21:57:24.487
> 
> 标签：d3.js, nvd3.js

我正在使用 nvd3.js 生成多条形图。这是我的代码：

```
$(function() {

    $.get('/charts/objects_created/')
        .done(function(resp) {
            init_graphs(resp);
        });

    function init_graphs(data) {
        nv.addGraph(function() {
            var chart = nv.models.multiBarChart();
            chart.xAxis.tickFormat(function(d) {
                return d3.time.format('%x')(new Date(d));
            });

            chart.yAxis.tickFormat(d3.format(',d'));

            d3.select('.chart#recent_activity svg')
                .datum(data)
                .transition().duration(500).call(chart);

            nv.utils.windowResize(chart.update);

            return chart;
        });
    }
}); 
```

这是我的数据：

```
[
   {
      "values":[
         {
            "y":3,
            "x":"04/05/2013"
         },
         {
            "y":1,
            "x":"04/11/2013"
         },
         {
            "y":3,
            "x":"04/12/2013"
         }
      ],
      "key":"Apples"
   },
   {
      "values":[
         {
            "y":3,
            "x":"04/05/2013"
         },
         {
            "y":1,
            "x":"04/12/2013"
         },
         {
            "y":0,
            "x":"04/11/2013"
         }
      ],
      "key":"Oranges"
   }
] 
```

分组看起来很棒： ![多条形图分组](https://i.stack.imgur.com/3iTET.png)

但堆叠失败： ![堆叠的多条形图](https://i.stack.imgur.com/LoNdy.png)

如您所见，最后一个堆栈不正确；橙子被放在苹果区的中间。此外，虽然很难看到，但第二列中的 0 个橙子有一个 1 像素条，位于 y 轴上的 3 处。

任何人都可以看到我做错了什么，或者 nvd3 有错误吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T08:53:02.570

如果您仔细查看数据，您会发现两个类别中日期更改的顺序，这会导致图表堆叠时的第三层。分组时效果很好。

请注意数据的顺序。

这是更新的数据。

```
[{
    "values" : [{
        "y" : 3,
        "x" : "04/05/2013"
    }, {
        "y" : 1,
        "x" : "04/11/2013"
    }, {
        "y" : 3,
        "x" : "04/12/2013"
    }],
    "key" : "Apples"
}, {
    "values" : [{
        "y" : 3,
        "x" : "04/05/2013"
    }, {
        "y" : 0,
        "x" : "04/11/2013"
    }, {
        "y" : 1,
        "x" : "04/12/2013"
    }],
    "key" : "Oranges"
}] 
```

# unicode - 如何在 Python 中处理 UTF-8 和 ISO-8859-1 字符的混合？

> ID：16047851
> 
> 赞同：2
> 
> 时间：2013-04-16T21:57:30.547
> 
> 标签：unicode, python-2.7, character-encoding, python-unicode

我有一组似乎包含以 UTF-8 和 ISO-8859-1 编码的字符的文档。我希望它们只是 UTF-8 编码。

当我使用文档将其解码为 UTF-8时，`doc.decode('utf-8')`我最终会得到一些 unicode 转义序列，例如`\u2022`，但我也有很多`\xa0`我认为是 ISO-8859-1 的字符。我想将它们转换为它们的 unicode 等价物，以便一切都幸福地生活在一起。这可能吗？我正在使用 Python 2.74。

我做过的一件事是：

```
decoded_doc = doc.decode('utf-8')
new_doc = decoded_doc.replace(u'\xa0',u' ') 
```

但还有其他奇怪的角色，比如`\xb7`——我想一口气把它们全部搞定。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T22:09:33.857

字符不是编码的专有属性，您不能说`a`是“UTF-8 字符”，而`b`在某种意义上和上下文中是“ASCII 字符”，这意味着没有其他编码能够表示这些字符。

如果您的文件无错误地解码为 UTF-8，则它是有效的 UTF-8。它不可能是“UTF-8 和 ISO-8859-1 的混合”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-28T05:43:39.487

作为对另一个问题的回答，您隐含地问：

如果您希望将与空格在视觉上无法区分的字符 U+00A0 以及许多其他此类转换一起转换为空格，这称为 NFKC 规范化。您可以通过以下方式完成它`unicodedata.normalize`：

```
import unicodedata
new_doc = unicodedata.normalize('NFKC', decoded_doc) 
```

# sql - 在 SQL 中使用窗口函数对空记录进行分组

> ID：16047853
> 
> 赞同：2
> 
> 时间：2013-04-16T21:57:44.320
> 
> 标签：sql, view, group-by

给定以下数据：

```
declare @temp table(id int identity primary key, val nvarchar)

insert into @temp values (NULL)
insert into @temp values (NULL)
insert into @temp values ('A')
insert into @temp values (NULL)
insert into @temp values (NULL)
insert into @temp values ('B')
insert into @temp values ('C')
insert into @temp values (NULL)
insert into @temp values (NULL)
insert into @temp values ('A')
insert into @temp values (NULL)
insert into @temp values (NULL) 
```

我试图得到下面的输出。需要对记录进行分组，以便每个新值组编号增加一。值本身无关紧要 - 如果存在除 NULL 之外的任何值，则会添加新的组 ID。记录必须按 ID 排序。

```
Id Val  Group
-- ---  -----
1  NULL 1
2  NULL 1
3  A    2
4  NULL 2
5  NULL 2
6  B    3
7  C    4
8  NULL 4
9  NULL 4
10 A    5
11 NULL 5 
```

我希望使用 PARTITION BY 是解决方案，但我似乎无法让这个工作（如果确实有可能/正确的方法。我有一个使用 LOOP 的解决方案，但我宁愿使用查询。我m 使用 SQL Server 2008。感谢您的任何建议。

```
select id, val, row_number() over (partition by X order by id) from @temp 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T22:10:19.383

这可以满足您的要求：

```
select t.id, t.val, DENSE_RANK() over (order by prevval) as grouping
from (select *,
             (select top 1 id from @temp t2 where t2.val is not null and t2.id <= t.id order by id desc
             ) as prevval
      from @temp t
     ) t 
```

这使用相关子查询来获取小于或等于给定值的最大 id，其中 id 不`val`为空（如果有）。然后它通过 id 对它们进行密集排序，以获得顺序分组。

如果您使用的是 SQL Server 2012，那么有一个相关的方法，没有子查询：

```
select t.id, t.val, DENSE_RANK() over (order by prevval) as grouping
from (select *,
             max(case when val is not null then id end) over (order by id) as prevval
      from @temp t
     ) t 
```

# php - 几秒/分钟后的 Cakephp 电子邮件

> ID：16047857
> 
> 赞同：1
> 
> 时间：2013-04-16T21:58:04.613
> 
> 标签：php, email, cakephp, cakephp-2.0

cakephp 中是否有在指定时间内发送电子邮件的方法？

我有一个使用 cakephp 构建的文件上传网站，上传完成后它会发送一封电子邮件以获取下载链接，然后它会调用一个 php CLI 来压缩文件。在压缩过程中，站点已经关闭，所以我不知道压缩过程什么时候结束。我想知道是否可以在 cakephp 电子邮件中指定，例如在刷新页面之前 1 分钟后发送电子邮件。

这是一些代码来显示发生了什么

```
var xhr_zip;
xhr_zip = new XMLHttpRequest();
fd_zip = new FormData();
fd_zip.append("total_files", total_files);
xhr_zip.open("POST", "datas/zip/", true);
xhr_zip.send(fd_zip);

xhr_update_usage = new XMLHttpRequest();
fd_update_usage = new FormData();
xhr_update_usage.open("POST", "datas/update_usage/", true);
xhr_update_usage.send(fd_update_usage);

xhr_email = new XMLHttpRequest();

fd_email = new FormData();

xhr_email.open("POST", "datas/send_link/" + recipient + '/' + subject, true);
xhr_email.send(fd_email);

    xhr_email.onload = function(e) {
        setTimeout(function() {
            $("body").removeClass("loading");
            window.onbeforeunload = null;
            alert("Total Files : " + total_files + " Sent \n Total Upload Size : " + (total_upload_size/1048576).toFixed(2) + " MB");                   
            document.location.reload(true);
        }, 2000);
    }; 
```

因此，在 zip 触发后，即使它没有完成压缩，脚本也会继续发送电子邮件并刷新浏览器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T14:48:55.947

听起来您已经在处理 zip 进度并且可以确定该过程何时完成，因此我将执行以下操作：

我建议您创建一个名为 EmailQueue 之类的新表和模型。然后我会创建一个外壳，例如 /app/Console/Command/EmailShell.php

```
/**
 * Shell to run background emails
 *
 * @property $EmailQueue
 */
class EmailShell extends AppShell {
    public $uses = array(
        'EmailQueue',
        'Model' // Name of model you are creating the zip for
    );

    public function main() {
        $this->out('You have hit the Email Shell.');
    }

    public function run_email_queue() {
        $emailQueueItem = $this->EmailQueue->find('first', array(
            'conditions' => array(
                'EmailQueue.status' => 0
            ),
            'order' => array(
                'EmailQueue.created ASC'
            )
        ));

        if(empty($emailQueueItem)) {
            $this->out('Email queue is empty.');
            return;
        }

        // Assuming you have a field for file status which is updated on zip completed
        // Alternatively, you could use a separate shell or cli to check
        switch($emailQueueItem['EmailQueue']['file_status']) {
            case "complete":
            case 1:
                $status = $this->send_email($emailQueueItem);
                break;

            default:
                $status = false;
                break;
        }

        if($status !== false) {
            // Update the status so that the email isn't sent later on
            $this->EmailQueue->id = $emailQueueItem['EmailQueue']['id'];
            $this->EmailQueue->save(array(
                'status' => 1
            ));
            $this->out(' ### Sending Email Successful');
        }
    }

    public function send_email($emailQueueItem = array()) {
        // Your model which does the zipping should have the email logic
        // I would have it return true or false.
        return $this->Model->originalEmailFunction($emailQueueItem['EmailQueue']['model_id']);
    }

} 
```

上面是一个非常简化的外壳示例，只需在您的模型中放置某种已完成标志或在外壳完成压缩后更新“EmailQueue”表，然后当您的 cron 命中此外壳时，它将发送电子邮件，提供所述标志是present - 如果您无法在控制器操作中处理它，您可能需要第二个 shell 来更新 zip 文件的标志。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T09:13:51.207

出于灵活的响应时间的原因，我会使用现成的排队解决方案，例如：

```
https://github.com/MSeven/cakephp_queue#readme 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T09:11:09.913

您希望用户在文件上传时停留在原始页面上吗？如果是这样，您能否使用回调进行初始 Ajax 调用，并在该回调中执行您的电子邮件发送代码？

或者，不是直接发送电子邮件，您是否可以有效地将其排队（可能只是通过在数据库的“电子邮件”表中创建一条记录）并通过查看是否上传的文件是否已完成压缩？

# ssh - AWS EC2 通过 ssh 登录

> ID：16047863
> 
> 赞同：-2
> 
> 时间：2013-04-16T21:58:37.257
> 
> 标签：ssh, amazon-web-services, amazon-ec2

我在使用 ssh 和 EC2 时遇到了很多问题。我有 2 个实例、1 个弹性 IP（与其中一个实例关联）和一个密钥对文件 (pem)。这两个实例都是库存的 Amazon OS（Linux 风格）。

我可以像这样登录到我的一个实例（没有与之关联的弹性 IP 的那个）：

```
ssh -i ~/.ssh/ec2_MyKey.pem ec2-user@ec2-54-224-199-18.compute-1.amazonaws.com 
```

然后我尝试进入另一个：

```
ssh -i ~/.ssh/ec2_MyKey.pem ec2-user@ec2-54-225-98-213.compute-1.amazonaws.com 
```

我得到一个权限被拒绝的错误。

任何想法为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T22:42:15.337

看起来这不是一个糟糕的例子，或者更有可能是我搞砸了。

我创建了一个新实例，并且可以正常登录。

# math - 笛卡尔坐标系的原点方向是否重要？

> ID：16047872
> 
> 赞同：0
> 
> 时间：2013-04-16T21:59:33.683
> 
> 标签：math

在 Flash 中，0、0 原点在左上角，增加 X 表示向右，增加 y 表示向下。在学校的数学中，他们教我们左下角的原点，x 向右增加，y 向上增加。我认为大多数图表都是基于这个。

如果我使用坐标，我应该在考虑我的 0、0 的位置时强制我的思考/计算/公式吗？

他们说我有一天需要数学，我嘲笑他们...... :))

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T23:09:08.457

正如您所描述的，不同的系统使用不同类型的坐标系，例如轴可以朝不同的方向移动。不同坐标系的另一个示例是纬度和经度，它们用于地图和地理系统，因为在使用纬度和经度时需要注意一些限制。重要的是要了解所有差异，并保持灵活性:-)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T23:21:28.143

[![](https://i.stack.imgur.com/Yi1Gu.jpg)](https://i.stack.imgur.com/Yi1Gu.jpg)
[（来源：[easywms.com](http://www.easywms.com/easywms/files/Image/blog/programming/php/03fig01.jpg)）]

一般来说，计算机上的坐标系从`origin (0, 0)`左上角开始，但这一切都取决于。

![](https://i.imgur.com/jB36agf.png)

Android的`AndEngine`图形库`origin (0, 0)`位于屏幕的左下方。

[![](https://i.stack.imgur.com/qUJE7.png)](https://i.stack.imgur.com/qUJE7.png)
[（来源：[wittman at www.math.ucla.edu](http://www.math.ucla.edu/~wittman/10a.1.10w/ccc/ch09/ch09/images/twodim-array.png)）]

而`GridWorld`学校用来教授学生编程的 API 使用基于数组的协调系统（如果我可以使用该术语）。这意味着 是`origin`在左上角，而不是沿着第一个移动，而是沿着或然后`x-axis`上下移动。它只是如何创建数组。`row``y-axis``x`

现在谈到数学，从坐标系转换到另一个坐标系并不难。也是的，你应该考虑你的原产地在哪里。它有很大的不同。

例如，我的对象的旋转点是中心，它将围绕中心干净而漂亮地旋转。

[http://imageshack.us/a/img20/8369/wishb.png](http://imageshack.us/a/img20/8369/wishb.png)

现在假设我的旋转点已移至左中。它会以不同的方式旋转。

![](https://i.stack.imgur.com/PRQ2m.png)

# php - 如何解析 SOAP 响应

> ID：16047873
> 
> 赞同：0
> 
> 时间：2013-04-16T21:59:35.377
> 
> 标签：php, api, soap

我使用 SOAP API，在我的一生中，我无法弄清楚如何解析它并将其放入数组中。我得到的回应是：

```
<?xml version="1.0" encoding="UTF-8"?>
<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" soap:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
  <soap:Body>
    <get_machinesResponse xmlns="http://127.0.0.1/Integrics/Enswitch/API">
      <s-gensym3>
        <quorum_pris xsi:type="xsd:string">1</quorum_pris>
        <description xsi:type="xsd:string" />
        <sip_port xsi:type="xsd:string">5060</sip_port>
        <domain xsi:type="xsd:string">mypbxmanager.net</domain>
        <asterisk_alive xsi:type="xsd:string">1</asterisk_alive>
        <id xsi:type="xsd:string">11</id>
        <server xsi:type="xsd:string">cleveland</server>
        <asterisk xsi:type="xsd:string">1</asterisk>
        <ipaddr xsi:type="xsd:string">10.10.10.32</ipaddr>
      </s-gensym3>
      <s-gensym5>
        <quorum_pris xsi:type="xsd:string">1</quorum_pris>
        <description xsi:type="xsd:string" />
        <sip_port xsi:type="xsd:string">5060</sip_port>
        <domain xsi:type="xsd:string">mypbxmanager.net</domain>
        <asterisk_alive xsi:type="xsd:string">1</asterisk_alive>
        <id xsi:type="xsd:string">13</id>
        <server xsi:type="xsd:string">ernie</server>
        <asterisk xsi:type="xsd:string">1</asterisk>
        <ipaddr xsi:type="xsd:string">10.10.10.34</ipaddr>
      </s-gensym5>
      <s-gensym7>
        <quorum_pris xsi:type="xsd:string">1</quorum_pris>
        <description xsi:type="xsd:string" />
        <sip_port xsi:type="xsd:string">5060</sip_port>
        <domain xsi:type="xsd:string">mypbxmanager.net</domain>
        <asterisk_alive xsi:type="xsd:string">-1</asterisk_alive>
        <id xsi:type="xsd:string">5</id>
        <server xsi:type="xsd:string">lois</server>
        <asterisk xsi:type="xsd:string">0</asterisk>
        <ipaddr xsi:type="xsd:string">10.10.10.12</ipaddr>
      </s-gensym7>
      <s-gensym9>
        <quorum_pris xsi:type="xsd:string">1</quorum_pris>
        <description xsi:type="xsd:string" />
        <sip_port xsi:type="xsd:string">5060</sip_port>
        <domain xsi:type="xsd:string">mypbxmanager.net</domain>
        <asterisk_alive xsi:type="xsd:string">-1</asterisk_alive>
        <id xsi:type="xsd:string">15</id>
        <server xsi:type="xsd:string">mort</server>
        <asterisk xsi:type="xsd:string">0</asterisk>
        <ipaddr xsi:type="xsd:string">10.10.10.24</ipaddr>
      </s-gensym9>
      <s-gensym11>
        <quorum_pris xsi:type="xsd:string">1</quorum_pris>
        <description xsi:type="xsd:string" />
        <sip_port xsi:type="xsd:string">5060</sip_port>
        <domain xsi:type="xsd:string">mypbxmanager.net</domain>
        <asterisk_alive xsi:type="xsd:string">-1</asterisk_alive>
        <id xsi:type="xsd:string">14</id>
        <server xsi:type="xsd:string">muriel</server>
        <asterisk xsi:type="xsd:string">0</asterisk>
        <ipaddr xsi:type="xsd:string">10.10.10.25</ipaddr>
      </s-gensym11>
      <s-gensym13>
        <quorum_pris xsi:type="xsd:string">1</quorum_pris>
        <description xsi:type="xsd:string" />
        <sip_port xsi:type="xsd:string">5060</sip_port>
        <domain xsi:type="xsd:string">mypbxmanager.net</domain>
        <asterisk_alive xsi:type="xsd:string">-1</asterisk_alive>
        <id xsi:type="xsd:string">9</id>
        <server xsi:type="xsd:string">nyc-02</server>
        <asterisk xsi:type="xsd:string">0</asterisk>
        <ipaddr xsi:type="xsd:string">10.10.10.10</ipaddr>
      </s-gensym13>
      <s-gensym15>
        <quorum_pris xsi:type="xsd:string">1</quorum_pris>
        <description xsi:type="xsd:string" />
        <sip_port xsi:type="xsd:string">5060</sip_port>
        <domain xsi:type="xsd:string">mypbxmanager.net</domain>
        <asterisk_alive xsi:type="xsd:string">1</asterisk_alive>
        <id xsi:type="xsd:string">12</id>
        <server xsi:type="xsd:string">ollie</server>
        <asterisk xsi:type="xsd:string">1</asterisk>
        <ipaddr xsi:type="xsd:string">10.10.10.33</ipaddr>
      </s-gensym15>
      <s-gensym17>
        <quorum_pris xsi:type="xsd:string">1</quorum_pris>
        <description xsi:type="xsd:string" />
        <sip_port xsi:type="xsd:string">5060</sip_port>
        <domain xsi:type="xsd:string">mypbxmanager.net</domain>
        <asterisk_alive xsi:type="xsd:string">-1</asterisk_alive>
        <id xsi:type="xsd:string">4</id>
        <server xsi:type="xsd:string">peter</server>
        <asterisk xsi:type="xsd:string">0</asterisk>
        <ipaddr xsi:type="xsd:string">10.10.10.11</ipaddr>
      </s-gensym17>
      <s-gensym19>
        <quorum_pris xsi:type="xsd:string">1</quorum_pris>
        <description xsi:type="xsd:string" />
        <sip_port xsi:type="xsd:string">5060</sip_port>
        <domain xsi:type="xsd:string">mypbxmanager.net</domain>
        <asterisk_alive xsi:type="xsd:string">-1</asterisk_alive>
        <id xsi:type="xsd:string">8</id>
        <server xsi:type="xsd:string">stewie</server>
        <asterisk xsi:type="xsd:string">0</asterisk>
        <ipaddr xsi:type="xsd:string">10.10.10.13</ipaddr>
      </s-gensym19>
    </get_machinesResponse>
  </soap:Body>
</soap:Envelope> 
```

我通过这样做得到这个结果：

```
$foo = new SoapClient("my_3.6.wsdl", array('proxy_host'     => "mydomain.net",
                                            'proxy_port'     => 80,
                                                'trace' => 1));

$result = $foo->get_machines('username', 'password');

$xml = $foo->__getLastResponse();

print_r($xml); 
```

我知道这不是正确的方法，但这是我能够得到回应的唯一方法。我已经为此工作了好几天。任何意见，将不胜感激。

这是我在这里的第一篇文章，如果我没有正确发布，请多多包涵。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T22:10:27.960

当我前段时间遇到类似问题时，我发现[这篇文章对我有帮助。](https://stackoverflow.com/questions/4194489/how-to-parse-soap-xml)

# if-statement - Crystal Reports 多个 IIF LEFT 函数

> ID：16047874
> 
> 赞同：0
> 
> 时间：2013-04-16T21:59:38.490
> 
> 标签：if-statement, syntax, crystal-reports

我正在尝试替换列中的两个值，我正在阅读 Crystal 语法文档并看到我应该能够使用；分离功能但运行两个，但是当我使用它时，就像这样：

```
IIF(LEFT({v_FrameDepartment.cftliner}, 4) = "FT-T", "Tulip", 
    {v_FrameDepartment.cftliner});
IIF(LEFT({v_FrameDepartment.cftliner}, 4) = "FT-V", "Veneer", 
    {v_FrameDepartment.cftliner}) 
```

它只运行第二个结果。有没有办法在列上运行这两个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T01:25:20.873

它只返回第二个的结果，因为单个公式可能只有一个返回值。在您的情况下，您有两个单独的语句，因此第一个值在某种意义上“丢失”，因为它从未分配给变量。相反，请尝试以下操作：

```
//You can separate the two statements with a ';' since we're assigning to a variable
local stringvar cftVar := left({v_FrameDepartment.cftliner}, 4);
select cftVar
case "FT-T" : "Tulip"
case "FT-V" : "Veneer"
default : {v_FrameDepartment.cftliner} 
```

# ios - 在 UIImage 周围绘制边框

> ID：16047875
> 
> 赞同：1
> 
> 时间：2013-04-16T21:59:47.197
> 
> 标签：ios, xcode, uiimageview, uiimage

我需要 UIImage 周围的边框。UIImage 被添加到 PDF 文件中。这是当前绘制图像的代码。

```
- (void) drawImage2
{
    UIImage * demoImage = self.imageCopy;
    NSData *jpegData = UIImageJPEGRepresentation(demoImage, 0.80);
    CGDataProviderRef dp = CGDataProviderCreateWithCFData(( CFDataRef)jpegData);
    CGImageRef cgImage = CGImageCreateWithJPEGDataProvider(dp, NULL, true, kCGRenderingIntentDefault);
    [[UIImage imageWithCGImage:cgImage] drawInRect:CGRectMake(513, 314, 135, 135)];  
} 
```

关于如何做到这一点的任何建议？我知道如何使用带有 UIImageView 的 CALayers 来做到这一点，但在这里不确定，因为我没有视图。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T09:02:06.377

```
- (UIImage*)imageWithBorderFromImage:(UIImage*)source;
{
  CGSize size = [source size];
  UIGraphicsBeginImageContext(size);
  CGRect rect = CGRectMake(0, 0, size.width, size.height);
  [source drawInRect:rect blendMode:kCGBlendModeNormal alpha:1.0];

  CGContextRef context = UIGraphicsGetCurrentContext();
  CGContextSetRGBStrokeColor(context, 1.0, 0.5, 1.0, 1.0); 
  CGContextStrokeRect(context, rect);
  UIImage *testImg =  UIGraphicsGetImageFromCurrentImageContext();
  UIGraphicsEndImageContext();
  return testImg;
} 
```

# permutation - 在n个地方放置红黑球

> ID：16047876
> 
> 赞同：0
> 
> 时间：2013-04-16T21:59:50.677
> 
> 标签：permutation, combinations

有`n`地方，**有无限数量的黑球和红球，黑球编号从 1 到 c1，红球编号从 1 到 c2**。问题是找到将这些球放置在 n 个位置的总数，使得如果放置了红球，则必须在其后放置一个黑球。**这意味着红球旁边的位置必须由黑球填充。**

`c1+c2>n`. 一个地方只能放一个球。

**我的方法**：首先计算将这些球放在n个地方的方式总数，这等于`(c1+c2)^n`。然后从中减去将两个红球放在一起的总数，这等于`2! x (c1+c2)^(n-2)`。我不太确定我的方法是否正确。请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T15:56:03.073

排列的总数是 (c [1] +c [2] )!。无效选项是具有 2 个相邻红球的选项。

让我们选择 2 个相邻的地方： ![在此处输入图像描述](https://i.stack.imgur.com/aN73R.gif) 并选择 2 个红球来填充：![在此处输入图像描述](https://i.stack.imgur.com/QgIAw.gif)

从总可能性范围中减去无效选项：![在此处输入图像描述](https://i.stack.imgur.com/q8TPf.gif)

经过一些简化我们得到![在此处输入图像描述](https://i.stack.imgur.com/E6BWM.gif)

# java - Android：如何使用 ContextMenu 制作可点击的 ListView？

> ID：16047883
> 
> 赞同：0
> 
> 时间：2013-04-16T22:00:16.003
> 
> 标签：java, android, listview, contextmenu

我有一个可点击`ListView`并尝试为项目制作一个上下文菜单，但如果我第一次长按它会激活`onListItemClick`方法。下次它工作。如果我用它激活上下文菜单`openContextMenu`会抛出一个`StackOverflowError`.

我解决了我的问题！见文末。

我的活动：

```
@Override
public void onCreate(Bundle icicle) {

    super.onCreate(icicle);
    setContentView(R.layout.search);

    getWords(getIntent());      
}

@Override
protected void onListItemClick(ListView l, View v, int position, long id) {
        super.onListItemClick(l, v, position, id); 
        String lemma = (item.get(position));

        Intent intent = new Intent(this, EntryActivity.class)
            .putExtra(CL.DOC, doc)
            .putExtra(CL.ENTRY, lemma);
    startActivity(intent);
}

public void onCreateContextMenu(ContextMenu menu, View v, ContextMenuInfo menuInfo) {
    super.onCreateContextMenu(menu, v, menuInfo);
    menu.setHeaderTitle("Eintrag");
    getMenuInflater().inflate(R.menu.context, menu);
}

public boolean onContextItemSelected(MenuItem item) {
    //TODO: switch
    return super.onContextItemSelected(item);
}

private void getWords(Intent intent) {
    doc = (CLDocument)intent.getSerializableExtra(CL.DOC);
    item = doc.getEntries();

    ArrayAdapter<String> fileList = 
        new ArrayAdapter<String>(this, R.layout.row, item);
    setListAdapter(fileList);   

    getListView().setOnItemLongClickListener(new OnItemLongClickListener() {    
        @Override
        public boolean onItemLongClick(AdapterView<?> parent, View view, int position, long id) {
            registerForContextMenu(view);
            //openContextMenu(view);        
            return false;
        }
    });
} 
```

我的布局（search.xml）：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <EditText
        android:id="@+id/edit_search"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:imeOptions="actionSearch"
        android:inputType="text"
        android:singleLine="true" />

    <ListView
        android:id="@android:id/list"
        android:layout_width="fill_parent" 
        android:layout_height="wrap_content" 
        />

    <TextView
        android:id="@android:id/empty"
        android:layout_width="fill_parent" 
        android:layout_height="wrap_content" 
        android:text="@string/nowords"
        />

</LinearLayout> 
```

编辑：如果我激活，这是 logcat `openContextMenu`：

```
04-17 11:31:06.103: D/dalvikvm(279): GC_FOR_MALLOC freed 5691 objects / 348744 bytes in 65ms
04-17 11:31:08.553: I/dalvikvm(279): threadid=1: stack overflow on call to Landroid/widget/AbsListView;.showContextMenuForChild:ZL
04-17 11:31:08.553: I/dalvikvm(279):   method requires 36+20+24=80 bytes, fp is 0x42089340 (64 left)
04-17 11:31:08.564: I/dalvikvm(279):   expanding stack end (0x42089300 to 0x42089000)
04-17 11:31:08.564: I/dalvikvm(279): Shrank stack (to 0x42089300, curFrame is 0x4208beb8)
04-17 11:31:08.573: D/AndroidRuntime(279): Shutting down VM
04-17 11:31:08.573: W/dalvikvm(279): threadid=1: thread exiting with uncaught exception (group=0x4001d800)
04-17 11:31:08.703: D/dalvikvm(279): GC_FOR_MALLOC freed 7370 objects / 493888 bytes in 50ms
04-17 11:31:08.733: E/AndroidRuntime(279): FATAL EXCEPTION: main
04-17 11:31:08.733: E/AndroidRuntime(279): java.lang.StackOverflowError
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.view.View.showContextMenu(View.java:2444)
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.app.Activity.openContextMenu(Activity.java:2390)
04-17 11:31:08.733: E/AndroidRuntime(279):  at de.solich.cldic.SearchActivity$1.onItemLongClick(SearchActivity.java:99)
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.widget.AbsListView.showContextMenuForChild(AbsListView.java:1779)
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.view.View.showContextMenu(View.java:2444)
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.app.Activity.openContextMenu(Activity.java:2390)
04-17 11:31:08.733: E/AndroidRuntime(279):  at de.solich.cldic.SearchActivity$1.onItemLongClick(SearchActivity.java:99)
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.widget.AbsListView.showContextMenuForChild(AbsListView.java:1779)
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.view.View.showContextMenu(View.java:2444)
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.app.Activity.openContextMenu(Activity.java:2390)
04-17 11:31:08.733: E/AndroidRuntime(279):  at de.solich.cldic.SearchActivity$1.onItemLongClick(SearchActivity.java:99)
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.widget.AbsListView.showContextMenuForChild(AbsListView.java:1779)
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.view.View.showContextMenu(View.java:2444)
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.app.Activity.openContextMenu(Activity.java:2390)
04-17 11:31:08.733: E/AndroidRuntime(279):  at de.solich.cldic.SearchActivity$1.onItemLongClick(SearchActivity.java:99)
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.widget.AbsListView.showContextMenuForChild(AbsListView.java:1779)
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.view.View.showContextMenu(View.java:2444)
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.app.Activity.openContextMenu(Activity.java:2390)
04-17 11:31:08.733: E/AndroidRuntime(279):  at de.solich.cldic.SearchActivity$1.onItemLongClick(SearchActivity.java:99)
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.widget.AbsListView.showContextMenuForChild(AbsListView.java:1779)
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.view.View.showContextMenu(View.java:2444)
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.app.Activity.openContextMenu(Activity.java:2390)
04-17 11:31:08.733: E/AndroidRuntime(279):  at de.solich.cldic.SearchActivity$1.onItemLongClick(SearchActivity.java:99)
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.widget.AbsListView.showContextMenuForChild(AbsListView.java:1779)
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.view.View.showContextMenu(View.java:2444)
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.app.Activity.openContextMenu(Activity.java:2390)
04-17 11:31:08.733: E/AndroidRuntime(279):  at de.solich.cldic.SearchActivity$1.onItemLongClick(SearchActivity.java:99)
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.widget.AbsListView.showContextMenuForChild(AbsListView.java:1779)
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.view.View.showContextMenu(View.java:2444)
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.app.Activity.openContextMenu(Activity.java:2390)
04-17 11:31:08.733: E/AndroidRuntime(279):  at de.solich.cldic.SearchActivity$1.onItemLongClick(SearchActivity.java:99)
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.widget.AbsListView.showContextMenuForChild(AbsListView.java:1779)
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.view.View.showContextMenu(View.java:2444)
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.app.Activity.openContextMenu(Activity.java:2390)
04-17 11:31:08.733: E/AndroidRuntime(279):  at de.solich.cldic.SearchActivity$1.onItemLongClick(SearchActivity.java:99)
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.widget.AbsListView.showContextMenuForChild(AbsListView.java:1779)
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.view.View.showContextMenu(View.java:2444)
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.app.Activity.openContextMenu(Activity.java:2390)
04-17 11:31:08.733: E/AndroidRuntime(279):  at de.solich.cldic.SearchActivity$1.onItemLongClick(SearchActivity.java:99)
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.widget.AbsListView.showContextMenuForChild(AbsListView.java:1779)
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.view.View.showContextMenu(View.java:2444)
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.app.Activity.openContextMenu(Activity.java:2390)
04-17 11:31:08.733: E/AndroidRuntime(279):  at de.solich.cldic.SearchActivity$1.onItemLongClick(SearchActivity.java:99)
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.widget.AbsListView.showContextMenuForChild(AbsListView.java:1779)
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.view.View.showContextMenu(View.java:2444)
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.app.Activity.openContextMenu(Activity.java:2390)
04-17 11:31:08.733: E/AndroidRuntime(279):  at de.solich.cldic.SearchActivity$1.onItemLongClick(SearchActivity.java:99)
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.widget.AbsListView.showContextMenuForChild(AbsListView.java:1779)
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.view.View.showContextMenu(View.java:2444)
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.app.Activity.openContextMenu(Activity.java:2390)
04-17 11:31:08.733: E/AndroidRuntime(279):  at de.solich.cldic.SearchActivity$1.onItemLongClick(SearchActivity.java:99)
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.widget.AbsListView.showContextMenuForChild(AbsListView.java:1779)
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.view.View.showContextMenu(View.java:2444)
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.app.Activity.openContextMenu(Activity.java:2390)
04-17 11:31:08.733: E/AndroidRuntime(279):  at de.solich.cldic.SearchActivity$1.onItemLongClick(SearchActivity.java:99)
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.widget.AbsListView.showContextMenuForChild(AbsListView.java:1779)
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.view.View.showContextMenu(View.java:2444)
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.app.Activity.openContextMenu(Activity.java:2390)
04-17 11:31:08.733: E/AndroidRuntime(279):  at de.solich.cldic.SearchActivity$1.onItemLongClick(SearchActivity.java:99)
04-17 11:31:08.733: E/AndroidRuntime(279):  at android.widget.AbsListView.showC
04-17 11:31:08.823: D/dalvikvm(279): GC_FOR_MALLOC freed 3648 objects / 486736 bytes in 50ms 
```

我改变了方法`getWords`，`onCreateContextMenu`现在它可以工作了：

```
private void getWords(Intent intent) {
    doc = (CLDocument)intent.getSerializableExtra(CL.DOC);
    item = doc.getEntries();

    ArrayAdapter<String> fileList = 
            new ArrayAdapter<String>(this, R.layout.row, item);
    setListAdapter(fileList);   

    registerForContextMenu(getListView());

//      getListView().setOnItemLongClickListener(new OnItemLongClickListener() {    
//          @Override
//          public boolean onItemLongClick(AdapterView<?> parent, View view, int position, long id) {
//              registerForContextMenu(view);
//                      
//              return false;
//          }
//      });

}

public void onCreateContextMenu(ContextMenu menu, View v, ContextMenuInfo menuInfo) {
    super.onCreateContextMenu(menu, v, menuInfo);
    AdapterView.AdapterContextMenuInfo info = 
            (AdapterView.AdapterContextMenuInfo)menuInfo;
    menu.setHeaderTitle(item.get(info.position));
    getMenuInflater().inflate(R.menu.context, menu);

} 
```

所以感谢所有试图帮助我的人！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T22:19:43.557

您必须在活动的回调中将`registerForContextMenu`您的`ListView`作为参数调用。`onCreate()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T22:25:51.987

这里：`getListView().setOnItemLongClickListener(...)`长按后注册上下文菜单（`registerForContextMenu(view)`），所以下次才可以使用。但是，如果您希望上下文菜单从头开始工作，您应该更早地调用它，例如在该`registerForContextMenu(getListView())`方法之前调用它。

# vba - 如何从用户表单打开文件并在用户表单打开的情况下对其进行修改

> ID：16047886
> 
> 赞同：1
> 
> 时间：2013-04-16T22:00:21.543
> 
> 标签：vba, excel

我有一个用户表单，上面有复选框、文本字段和正常的常规内容，包括一个我想用来打开 Excel 电子表格的按钮。这很容易做到：

```
Private Sub CMB2_Click()
    Workbooks.Open Filename:="G:\Formular.xlsm"
End Sub 
```

但是，执行此操作时，无法处理该文件；换句话说，它不活跃。发件人处于活动状态，并且在关闭或取消表单之前，文件被锁定。由于缺乏更好的描述，我称之为锁定。

如果我使表单无模式，表单中的所有字段都会失去其功能，除了按钮，但至少我可以在打开的电子表格中工作。

```
UserForm1.Show vbModeless 
```

我怎样才能得到两者？我想在打开的电子表格中工作，并在完成后继续处理表单。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T22:06:49.207

您必须在新的 excel 实例中打开其他文件。以下代码将为您执行此操作

```
Dim xlApp as Excel.Application
set xlApp = CreateObject("Excel.Application")
xlApp.Visible = True
xlApp.Workbooks.Open FileName:="G:\Formular.xlsm" 
```

# java - Spring MVC 向用户返回一个空白视图

> ID：16047888
> 
> 赞同：0
> 
> 时间：2013-04-16T22:00:32.427
> 
> 标签：java, html, spring-mvc

当用户将记录插入数据库时​​，我有一个表单，他们可能希望同时创建一条新记录，他们可以单击一个新按钮。我定义了一个控制器来接受此命令，并仅在填充列表框的情况下向用户返回一个空白视图，但是该视图不会返回空白，它具有来自先前插入数据库的数据。

**代码：**

用户选择以下按钮

```
<button class="btn" value="new" onclick="submitPage('${pageContext.request.contextPath}/crime_registration_new.htm');" type="button" >New</button> 
```

**控制器方法：**

我想摆脱旧的犯罪对象

```
 @RequestMapping(value="crime_registration_new.htm", method = RequestMethod.POST)
    public ModelAndView loadNew(HttpServletRequest request, 
        HttpServletResponse response,
        @ModelAttribute Crime crime,
        Model model) throws Exception {

    try{

        logger.debug("In Crime Registration Controller");

        myCriminalList.put("dbcriminalList", this.citizenManager.getListOfCriminals());
        myVictimList.put("dbvictimList", this.citizenManager.getListOfVictims());
        myStatusList.put("statusList", this.statusManager.getStatusList());
        myCrimeCategoryList.put("crimeCategoryList", this.crimeCategoryManager.getCrimeCategoryList());
        myCrimeLevelList.put("crimeLevelList", this.crimeLevelManager.getCrimeLevelList());
        myOfficerList.put("investigatingOfficerList", this.officerManager.getOfficersList());

        model.addAttribute("dbcriminals", myCriminalList);
        model.addAttribute("dbvictims",   myVictimList);
        model.addAttribute("status", myStatusList);
        model.addAttribute("crimeCategory", myCrimeCategoryList);
        model.addAttribute("crimeLevel",myCrimeLevelList);
        model.addAttribute("officers",myOfficerList);
        model.addAttribute("crimeRecordNoStatus", "true");
        model.addAttribute("crimeRecordNoStatus", "true");
        model.addAttribute("save", "enabled");

        return  new ModelAndView("crime_registration");          
    }catch(Exception e){                
        logger.debug("Exception In CrimeRegistration Controller : " + e.getMessage());
        return new ModelAndView("crime_registration");               
    }    
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T22:26:44.433

我将控制器方法设置为返回字符串，并使用以下内容将用户发送回视图：

```
return "redirect: crime_registration.htm"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T22:27:48.530

`myCriminalList`,`myVictimList`等似乎不是，`local variables`但是`instance variables`它们可以被后续的方法调用共享和访问。确保将这些字段声明为本地字段，以便它们绑定到该单个请求并且在该请求范围之外无法看到。

```
@RequestMapping(value="crime_registration_new.htm", method=RequestMethod.POST)
public ModelAndView loadNew( (...) ) throws Exception {
        // local variable - only accessible by current request
        List<Criminal> myCriminalList = new ArrayList<Criminal>();

        myCriminalList.put("dbcriminalList",
                this.citizenManager.getListOfCriminals());
        model.addAttribute("dbcriminals", myCriminalList);
        return new ModelAndView("crime_registration");
        // (...)
} 
```

* * *

作为旁注，为什么不进一步简化它：

```
@RequestMapping(value = "crime_registration_new.htm", method = RequestMethod.POST)
public ModelAndView loadNew( (...) ) throws Exception {
        // no need for intermediary List
        model.addAttribute("dbcriminals", this.citizenManager.getListOfCriminals());
        // (...)
        return new ModelAndView("crime_registration");
} 
```

# node.js - [1] 迭代器对下划线 sortBy 函数的评估是什么？

> ID：16047893
> 
> 赞同：3
> 
> 时间：2013-04-16T22:00:48.070
> 
> 标签：node.js, underscore.js

我有以下代码行：

```
dataArray = _.sortBy(dataArray, [1]).reverse(); 
```

什么将被评估为答案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T22:09:17.367

这意味着您`dataArray`用于根据原始数组的每个元素的“1”属性的比较来给出排序数组。

例如，如果它是一个字符串数组，则第二个字符用作比较器。如果是数组数组，则使用每个数组的第二个元素。

它是定义迭代器函数的快捷方式，该函数提取每个项目的给定属性。

然后 reverse 做它一直做的事情，反转数组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T22:11:00.917

额外的括号 ( `[]`) 实际上不是必需的，但`_.sortBy(dataArray, 1)`它是[*查找迭代器*](https://github.com/documentcloud/underscore/blob/1.4.4/underscore.js#L299-L306)[的简写](https://github.com/documentcloud/underscore/blob/1.4.4/underscore.js#L299-L306)*：*

 *```
_.sortBy(dataArray, function (data) { return data[1]; }); 
```

这可用于按每个 inner- 中的第二项`Array`对s 进行排序：`Array``Array`

```
var origin = [ [0, 5], [1, 4], [2, 3] ];

// sort by `5`, `4`, and `3`
var sorted = _.sortBy(origin, 1);

console.log(sorted); // [ [2, 3], [1, 4], [0, 5] ]; 
```*

# ios - 我怎样才能用带有 UILabel 的 NSAttributedString 进行描边和填充

> ID：16047901
> 
> 赞同：37
> 
> 时间：2013-04-16T22:01:22.860
> 
> 标签：ios, cocoa, uilabel, nsattributedstring

是否可以同时应用**笔画**和**填充**an`NSAttributedString`和 a `UILabel`？

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2013-04-16T22:01:22.860

是的，关键是将**负值**应用于`NSStrokeWidthAttributeName` 如果此值为正，您将只看到描边而不是填充。

目标-C：

```
self.label.attributedText=[[NSAttributedString alloc] 
initWithString:@"string to both stroke and fill" 
attributes:@{
             NSStrokeWidthAttributeName: @-3.0,
             NSStrokeColorAttributeName:[UIColor yellowColor],
             NSForegroundColorAttributeName:[UIColor redColor]
             }
]; 
```

感谢下面的@cacau：另请参阅[技术问答 QA1531](https://developer.apple.com/library/mac/qa/qa1531/_index.html)

**斯威夫特 4**版本：

```
let attributes: [NSAttributedStringKey : Any] = [.strokeWidth: -3.0,
                                                 .strokeColor: UIColor.yellow,
                                                 .foregroundColor: UIColor.red]

label.attributedText = NSAttributedString(string: text, attributes: attributes) 
```

**斯威夫特 5.1**版本：

```
let attributes: [NSAttributedString.Key : Any] = [.strokeWidth: -3.0,
                                                  .strokeColor: UIColor.yellow,
                                                  .foregroundColor: UIColor.red]

label.attributedText = NSAttributedString(string: text, attributes: attributes) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2016-04-26T16:10:49.880

斯威夫特版本：

```
let attributes = [NSStrokeWidthAttributeName: -3.0,
                      NSStrokeColorAttributeName: UIColor.yellowColor(),
                      NSForegroundColorAttributeName: UIColor.redColor()];

label.attributedText = NSAttributedString(string: "string to both stroke and fill", attributes: attributes) 
```

**斯威夫特 3**版本：

```
 let attributes = [NSStrokeWidthAttributeName: -3.0,
                      NSStrokeColorAttributeName: UIColor.yellow,
                      NSForegroundColorAttributeName: UIColor.red] as [String : Any]

    label.attributedText = NSAttributedString(string: "string to both stroke and fill", attributes: attributes) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-11-09T12:05:06.730

现在最新的 swift 苹果删除属性键值声明的 [String: Any] 用作 [NSAttributedStringKey : Any]

```
 let strokeTextAttributes = [
        NSAttributedStringKey.strokeColor : UIColor.green,
        NSAttributedStringKey.foregroundColor : UIColor.lightGray,
        NSAttributedStringKey.strokeWidth : -4.0,
        NSAttributedStringKey.font : UIFont.boldSystemFont(ofSize: 52)
        ] as [NSAttributedStringKey : Any]

    hello_cell_lb.attributedText = NSAttributedString(string: "\(hello_array[indexPath.row])", attributes: strokeTextAttributes) 
```

谢谢你

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-06-11T00:17:36.067

**斯威夫特 4**版本：

```
let attributes: [NSAttributedStringKey : Any] = [.strokeWidth: -3.0,
                                                 .strokeColor: UIColor.yellow,
                                                 .foregroundColor: UIColor.red]

label.attributedText = NSAttributedString(string: text, attributes: attributes) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-12-22T12:32:36.147

这是 UITextView 中的 Stroke 和 Oblique/tilt/slant 文本的示例

```
 public func setAttributedText(fontStyle: INSTextFontPickerStyle, strokeColor: UIColor = UIColor.white, foregroundColor: UIColor = UIColor.black, isObliqueness: Bool = false, isStrokes: Bool = false) {
        self.fontStyle = fontStyle

        let paragraphStyle = NSMutableParagraphStyle()
        paragraphStyle.alignment = innterTextView.textAlignment

        // Tilting the text
        let obliquenessValue = isObliqueness ? NSNumber(value: 0.2) : NSNumber(value: 0) // The angle of tilting in clockwise

        // Stroke a line in text edges
        var strokeWidth = NSNumber(value: 0.0)
        var _strokeColor = UIColor.clear
        if isStrokes || fontStyle == .strokeEdges {
            strokeWidth = NSNumber(value: -2.0) // The width of stroke
            _strokeColor = strokeColor
        }

        textView.attributedText = NSAttributedString(string: textView.text, attributes: [
            NSAttributedString.Key.foregroundColor : foregroundColor,
            NSAttributedString.Key.font : UIFont.systemFont(ofSize: (actualFontSize > 0 ? actualFontSize : fontSize)),
            NSAttributedString.Key.paragraphStyle : paragraphStyle,
            NSAttributedString.Key.strokeColor : _strokeColor,
            NSAttributedString.Key.strokeWidth : strokeWidth,
            NSAttributedString.Key.obliqueness: obliquenessValue
        ])
    } 
```

# android - 在标准电子邮件对话框中为电子邮件文本设置自定义提示

> ID：16047903
> 
> 赞同：0
> 
> 时间：2013-04-16T22:01:25.320
> 
> 标签：android, email

我想调出带有电子邮件文本自定义提示的 Android 标准电子邮件对话框（将实际文本留空）。可能吗 ？

它不能通过 Intent 完成，可以检索电子邮件对话框的模板，用必要的东西填充它，然后使用电子邮件 API 发送电子邮件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T22:07:50.227

> 我想调出带有电子邮件文本自定义提示的 Android 标准电子邮件对话框（将实际文本留空）。可能吗 ？

没有记录和支持的方法可以做到这一点。

# node.js - How do I connect to SQL Azure from NodeJS/Tedious?

> ID：16047905
> 
> 赞同：3
> 
> 时间：2013-04-16T22:01:28.993
> 
> 标签：node.js, azure-sql-database, tedious

I have a SQL Azure database that I'm trying to connect to from a NodeJS application running in an Azure Linux VM. Everything works fine when I'm on a local SQL Database/and local machine for NodeJS. However, when I run from my vm, I get the following output (My trace output plus the Tedious debug event):

```
connected to XXXXXXX.database.windows.net:1433
State change: Connecting -> SentPrelogin
State change: SentPrelogin -> SentLogin7WithStandardLogin
connection to XXXXXXX.database.windows.net:1433 closed
State change: SentLogin7WithStandardLogin -> Final
Writing CSV files....
connection to XXXXXXX.database.windows.net:1433 closed
State change: Final -> Final
All Done! 
```

The problem is that no error is ever raised, but the connection seems to be automatically closed.

Any thoughts on what might be happening here or how I can get to an actual error?

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-16T22:27:14.020

Ok - solved it thanks to [this thread](https://github.com/pekim/tedious/issues/49)

There were 2 issues:

1.  SQL Azure requires encrypted connections, so you need encrypt:true in the connection options
2.  the userName configuration option requires the database-qualified name (e.g. user@XXXXXX.database.windows.net)

Just in case anyone else runs into this :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-10T20:09:56.507

I encountered a 3rd issue that I thought was worth sharing. Due to some firewall/isp/port/etc issues, I had to set up a local SQL instance to debug with.

The local instance of SQL Server 2014 worked when I used a 'database' parameter under the main tree. However, the Azure instance would only take the 'database' parameter if it is under 'options'.

```
"sqlserverConfig": {
    "userName": "SomeUser@someazureserver.database.windows.net",
    "password": "SomePW",
    "server": "someazureserver.database.windows.net",
    "options": {
        "encrypt": true,
        "database": "SomeDatabase"
    }
  } 
```

For me, the symptom that I observed was that I was connecting to the master db by default - So my stored procedures weren't found, etc. Very frustrating. Hope this helps someone.

# c# - 为字典中的每个键添加值

> ID：16047913
> 
> 赞同：4
> 
> 时间：2013-04-16T22:01:58.980
> 
> 标签：c#, dictionary

我创建了一个字典，其中有一个米号作为键和一个值列表。例如： Meter1 的索引 0 值为 45，索引 1 的值为 65。我想知道为每个仪表编号添加索引 0 的最有效方法是什么？我正在尝试在给定索引处获得最大附加值。列表的长度相同。我附上了我必须创建字典的代码。

```
Dictionary<string, List<string>> dictionary = new Dictionary<string, List<string>>();

foreach (string ertNumber in ertNumberList)
{
    if (!dictionary.ContainsKey(ertNumber))
    {
        List<string> meterReadings = new List<string>();
        meterReadings = getValuesFromOID(ertNumber);
        dictionary.Add(ertNumber, meterReadings);
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T22:13:23.553

> 我正在尝试在给定索引处获得最大附加值。

要获得每个索引的最大值，请尝试以下操作：

```
Dictionary<string, List<double>> dictionary = ... // NOTE: use some numeric type
Dictionary<string, double> maxima = dictionary.ToDictionary(p => p.Key, p => p.Value.Max()); 
```

这将生成一个新字典，该字典存储源字典中每个索引处每个值的最大值。

* * *

**更新**

所以你有这个结构

```
"Meter1", [ 15, 5, 10 ]
"Meter2", [ 10, 50, 20 ] 
```

并且您想计算任何索引处仪表读数总和的最大值。假设每个`List<double>`长度相同，那么如果我理解正确，那就是：

```
Dictionary<string, List<double>> dictionary = ...
var length = dictionary.First().Value.Length;
var maximum = Enumerable.Range(0, length)
                        .Select(i => dictionary.Values.Select(d => d[i]).Sum())
                        .Max(); // 55 
```

如果您还想获得最大值的*索引*，您可以使用它：

```
var result =
    (from i in Enumerable.Range(0, length)
     let s = dictionary.Values.Select(d => d[i]).Sum()
     orderby s descending
     select new { Index = i, Sum = s })
    .First(); // { Index = 1, Sum = 55 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T22:13:00.040

假设仪表读数已更改为 int，您可以使用 LINQ：

```
var maxMeterValue = dictionary[myertNumber].Max(v => v); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T23:56:00.063

这个怎么样，它处理不等长的列表：

```
var maxLength = dictionary.Values.Max(readings => readings.Count);

var sums = Enumerable.Range(0, maxLength)
    .Select(i => readings.Where(rs => i < rs.Count).Sum(rs => int.Parse(rs[i]));

var maxSum = sums.Max(); 
```

当然有一种更有效的方法可以做到这一点，但我很确定它需要更多的输入。

# bash - 在给定行号之后查找第一个匹配的行号

> ID：16047915
> 
> 赞同：0
> 
> 时间：2013-04-16T22:02:03.073
> 
> 标签：bash

我正在尝试编写一个 bash 脚本来删除 ini 文件中的多行。我有一个按以下方式配置的ini文件。

```
# There could be any text before the following text

[machine1.conn]
ipAddress=192.168.1.1
portNumber=11001

[machine2.conn]
ipAddress=192.168.1.2
portNumber=11002

[machine3.conn]
ipAddress=192.168.1.3
portNumber=11003

# There could be any text after the previous text 
```

我想从 ini 文件中删除所有这些条目（包括属性）。

ini 文件中可能有任意数量的“机器”条目，但对于这个示例，我只显示 3 个。括号中的标签在 ini 文件中是完全唯一的，但每个属性后面的属性显然不是。我已经有了一种确定第一个`[machine#.conn]`和最后一个行号的方法；假设这些分别分配给变量`$firstMachineLineNum`和`$lastMachineLineNum`。我要做的是使用 sed 删除从`$firstMachineLineNum`到最后一台机器的`portNumber`行号的一系列行。我正朝着这样的方向前进，`sed -i '$firstMachineLineNum,$lastMachinesPortNumLineNum$d' file.ini`. 为此，我需要一种方法来确定AFTER 最后`$lastMachinesPortNumLineNum`一个匹配的第一个匹配的行号（在我的示例中是）。理想情况下，我不必仅仅依靠将 2 添加到`portNumber``[machine#.conn]``[machine3.conn]``$lastMachineLineNum`.

我怎样才能最好地使用 sed 和/或 grep 提取此行号？总的来说，我是不是把它弄得太复杂了，还有一种更简单的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T22:13:10.293

试试这个单行：

```
awk -v RS="" -v ORS="\n\n" '!/machine[0-9]+\.conn/' file 
```

小测试：

```
kent$  cat file
[foo_keep]
foo=foo

[machine1.conn]
ipAddress=192.168.1.1
portNumber=11001

[machine2.conn]
ipAddress=192.168.1.2
portNumber=11002

[machine3.conn]
ipAddress=192.168.1.3
portNumber=11003

[bar_keep]
bar=bar

[machine4.conn]
ipAddress=whatever
portNumber=11001

[machine5.conn]
ipAddress=whatever
portNumber=11002

[baz_keep]
hhh=hhh 
```

输出

```
kent$   awk -v RS="" -v ORS="\n\n" '!/machine[0-9]+\.conn/' file
[foo_keep]
foo=foo

[bar_keep]
bar=bar

[baz_keep]
hhh=hhh 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T22:22:38.260

如果文件如图所示（在要删除的块中没有空行），Sed 会很容易地做到这一点：

```
sed '/^\[machine[0-9]\{1,\}\.conn\]/,/^\s*$/d' file 
```

修改为接受任何以 .conn 结尾的名称：

```
sed '/^\[.*\.conn\]/,/^\s*$/d' file 
```

针对可变目标行修改：

```
machine='machine1'
sed '/^\['"$machine"'\.conn\]/,/^\s*$/d' file 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T22:15:27.233

如果你只想排除这个特定的块，你可以使用这个：

```
awk 'NR < $firstline || NR > $lastline {print $0}' file.txt 
```

# xml - XSLT 定义一个变量并在之后检查它是否存在

> ID：16047919
> 
> 赞同：3
> 
> 时间：2013-04-16T22:02:24.030
> 
> 标签：xml, xslt, xslt-1.0

我正在尝试转换 XML 文档。首先，我定义了一个全局变量：

```
 <xsl:variable name="foo"><xsl:value-of select="bar"/></xsl:variable> 
```

现在我正在转换的 XML 有可能已经`<bar>some data</bar>`定义了。也有可能没有定义。

一旦我在下面声明了全局变量，如果它被定义，我将尝试输出以下内容：

```
<foo>DEFINED</foo> 
```

如果没有定义：

```
<foo>NOT DEFINED</foo> 
```

我在用`<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">`

解决这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-16T23:53:11.950

由于您使用的是 XSLT 1.0，因此您可以使用它`string()`来进行测试。

这是一个示例样式表：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output indent="yes"/>
    <xsl:strip-space elements="*"/>

    <xsl:template match="/*">
        <xsl:variable name="foo" select="bar"/>
        <results>
            <xsl:choose>
                <xsl:when test="string($foo)">
                    <foo>DEFINED</foo>
                </xsl:when>
                <xsl:otherwise>
                    <foo>NOT DEFINED</foo>
                </xsl:otherwise>
            </xsl:choose>           
        </results>
    </xsl:template>

</xsl:stylesheet> 
```

请注意，空白已折叠，因此`<bar> </bar>`将返回 false。此外，`string()`在直接测试元素而不是变量时也可以使用。

以下是一些输入/输出示例：

* * *

**输入**

```
<test>
    <bar/>
</test> 
```

或者

```
<test>
    <bar></bar>
</test> 
```

或者

```
<test>
    <bar>    </bar>
</test> 
```

**输出**

```
<foo>NOT DEFINED</foo> 
```

* * *

**输入**

```
<test>
    <bar>x</bar>
</test> 
```

**输出**

```
<foo>DEFINED</foo> 
```

* * *

如果您可以使用 XSLT 2.0，您可以将变量声明为 an`xs:string`并在 test ( `test="$foo"`) 中使用变量名。

例子：

```
<xsl:stylesheet version="2.0" xmlns:xs="http://www.w3.org/2001/XMLSchema" 
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform" exclude-result-prefixes="xs">
    <xsl:output indent="yes"/>
    <xsl:strip-space elements="*"/>

    <xsl:template match="/*">
        <xsl:variable name="foo" select="bar" as="xs:string"/>
        <results>
            <xsl:choose>
                <xsl:when test="$foo">
                    <foo>DEFINED</foo>
                </xsl:when>
                <xsl:otherwise>
                    <foo>NOT DEFINED</foo>
                </xsl:otherwise>
            </xsl:choose>           
        </results>
    </xsl:template>

</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T22:29:09.530

我不确定这是否有效，但......

添加`xmlns:fn="http://www.w3.org/2005/xpath-functions"`到您的样式表。

```
<xsl:choose>
  <xsl:when test="fn:boolean(foo)">
    <foo>DEFINED</foo>
  </xsl:when>
  <xsl:otherwise>
    <foo>NOT DEFINED</foo>
  </xsl:otherwise>
</xsl:choose> 
```

编辑：@JimGarrison 如果有效，这将按`<bar/>`定义处理`<bar></bar>`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T09:00:39.340

变量 foo 将包含您的 xml 包含 bar 的 xml 节点 bar（不仅是 bar 的内容的文本）。因此，“@indeterminately sequenced”的答案是正确的，您可以测试 foo 是否包含带有`test="boolean($foo)"`. 但我更喜欢 'test="name($foo)"`. Or test="name($foo) = 'bar'` 这会导致：

```
<xsl:variable name ="foo" select="*/bar" />

<xsl:template match="/">
    <results>
        <xsl:choose>
            <xsl:when test="name($foo)">
                <foo>DEFINED</foo>
            </xsl:when>
            <xsl:otherwise>
                <foo>NOT DEFINED</foo>
            </xsl:otherwise>
        </xsl:choose>
    </results>
</xsl:template> 
```

# javascript - 在同一类的另一个方法中调用方法

> ID：16047920
> 
> 赞同：1
> 
> 时间：2013-04-16T22:02:24.547
> 
> 标签：javascript, jquery, function, methods

诚然，我对 javascript、jquery 或 oop 知之甚少，但我知道的足够多，可以把东西拼凑起来，有时还能让它们工作。然而，这超出了我的想象，尽管我用谷歌搜索，但我无法对正在发生的事情做出正面或反面。这是我的代码的要点：

```
jQuery(document).ready(function($) {

    var methods = {
        init : function( options ) { 
            if (somthing) {
                this.latlng(input);//  <--- ERROR: Object has no method
            }
        },
        auto : function( ) {
            if (something) {
                this.latlng(input);
            } else {
                this.location(input);
            }
        },
        location : function ( input ) {
            // draw map
        },
        latlng : function ( input, l ) {
            // draw map
        }
    }

    $.fn.codeAddress = function( method ) {
        // Method calling logic
        if ( methods[method] ) {
            return methods[ method ].apply( this, Array.prototype.slice.call( arguments, 1 ));
        } else if ( typeof method === 'object' || ! method ) {
            return methods.init.apply( this, arguments );
        } else {
            $.error( 'Method ' +  method + ' does not exist on jQuery.tooltip' );
        }  
    };

    var geo = new $(document).codeAddress(); // Initialize the object   
}); 
```

我依赖 jQuery Docs [Plugin/Authoring](http://docs.jquery.com/Plugins/Authoring)作为我的模板，并从那里开始零敲碎打。理想情况下，它会在文档准备好时自行加载 init()，但不会，所以我添加了倒数第二行来初始化对象。

地图最初是在 init() 中使用方法 latlng() 来绘制的。这就是我在第 6 行得到错误的地方，this.latlng(input) Uncaught TypeError: Object [object Object] has no method 'latlng'。此后，onclick 事件处理程序调用 auto() 以根据其接收到的输入重绘地图。

如果我的解释和/或代码是垃圾节目，我深表歉意。我正在努力学习。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T22:04:51.583

你需要这样说：

```
methods['latlng'].apply(this); 
```

原因是因为 的值`this`不是你的插件。您实际上应该将 的值记录`this`到控制台以获得更多洞察力，但实际上，您已经在插件中声明了一个名为方法的对象。latlng 在该对象的上下文中。为了调用它，您可以通过它的键 (latlng) 引用它并调用 .apply() 方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T22:06:24.453

```
return methods.init.apply( methods, arguments ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T22:09:52.407

在 jQuery 插件的代码中，`this`是对包装当时被迭代的 DOM 元素的 jQuery 对象的引用。

在您的情况下，您已手动将插件附加到`document`.
（您应该在您网站的代码中执行此操作，而不是在插件文件中）

在任何情况下，`this.latlng()`您都可以使用 引用您的插件，而不是调用`this.codeAddress( 'latlng' );`。

这是 jQuery 插件的预期功能，如果您以这种方式访问​​它们，它会保持干净。

# iphone - Windows Azure 参数

> ID：16047922
> 
> 赞同：1
> 
> 时间：2013-04-16T22:02:29.003
> 
> 标签：iphone, ios, objective-c, azure

各位，晚安！你能在这种情况下阻止我吗？我搜索了两天，但我找不到这样做的方法......

如何将参数传递给 Windows Azure 移动服务中的读取函数？

在下面的代码中，我调用了 read 函数，但我想通过 Parm1 在 Windos Azure 中进行操作。

```
[itemTable readWhere:predicate completion:^(NSArray *items, NSInteger totalCount, NSError *error) { 
```

我想在 Windows Azure 中做这样的事情......

```
function read(query, user, request) {
var parm1 = query.parameters.Parm1;

request.execute();
} 
```

谢谢帮助我。

保罗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T17:10:47.557

如果你正在读取，这可以通过调用 MSTable 的 readWithQueryString 方法来完成。例如：

```
NSString *queryString = [NSString stringWithFormat:@"param1=%@", @"myparam"];

[self.myTable readWithQueryString:queryString completion:^... 
```

然后在您的服务器端脚本中，您将使用 request.parameters.param1 访问。

克里斯

# c# - ListBox.SelectedItems 作为 HashSet

> ID：16047925
> 
> 赞同：1
> 
> 时间：2013-04-16T22:02:34.553
> 
> 标签：c#, wpf, list

取消选择大量项目时，我在 ListBox 中遇到性能问题。我的 ListBox 目前包含 90,000 多个项目。

我认为性能问题是因为 SelectedItems 由 List 而不是 HashSet 表示。

什么是重新创建 ListBox 功能、支持多选以及将选定项实现为哈希集的最简单方法。

我不需要支持 selectedindex，我认为这就是为什么 selecteditems 是一个列表的原因。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T22:43:56.223

您应该找到一种虚拟化的方法，`ListBox`以便并非所有元素都将立即加载到内存中并添加到列表中，而是控件的占用空间将仅包含当前可见的元素并仅在滚动时加载其他元素，某种网络- 像按需加载...

这个答案详细描述了这个问题：[https ://stackoverflow.com/a/2784220/559144](https://stackoverflow.com/a/2784220/559144)

这个链接非常有帮助：[优化性能：控件](http://msdn.microsoft.com/en-us/library/cc716879.aspx)

它告诉您`WPF ListBox`实际上确实默认支持虚拟化，并且您还可以启用：

*   容器回收
*   延迟滚动

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T22:15:24.527

我所做的是创建一个管理选择的类，将选择存储为 HashMap。然后我处理 ListBoxItem 上的 MouseDown 并模仿 shift 和 ctrl 选择。

我将选择更改为单一，基本上忽略了默认选择反射。

这是我的 XAML。

```
<ListBox Margin="2" 
 Grid.Column="0" 
 Name="WordList" 
 ItemsSource="{Binding Source={StaticResource CVS}}"
 SelectionMode="Single">
   <ListBox.ItemContainerStyle>
      <Style TargetType="{x:Type ListBoxItem}">
         <EventSetter Event="PreviewMouseDown" Handler="Clicked"/>
         <EventSetter Event="PreviewMouseMove" Handler="MouseMoved"/>
         <Setter Property="Template">
            <Setter.Value>
               <ControlTemplate TargetType="{x:Type ListBoxItem}">
                  <TextBlock Name="Text" Text="{Binding Word}"/>
                  <ControlTemplate.Triggers>
                     <DataTrigger Binding="{Binding IsSelected}" Value="True">
                        <Setter TargetName="Text" Property="Background" Value="LightBlue"/>
                     </DataTrigger>
                  </ControlTemplate.Triggers>
               </ControlTemplate>
            </Setter.Value>
         </Setter>
      </Style>
   </ListBox.ItemContainerStyle> 
```

# javascript - -webkit-transform 使用 js 变量旋转角度值

> ID：16047926
> 
> 赞同：0
> 
> 时间：2013-04-16T22:02:34.717
> 
> 标签：javascript, css

我正在尝试使用变量 MyDiv1 代替下面的“25”，但似乎找不到正确的语法。其他一切都很好，我只是坚持如何将 MyDiv1 与“（25deg）”部分中的 deg 结合起来。

```
var degrees = (ata * (180/Math.PI));

$("#demo").html(degrees);

var MyDiv1 = document.getElementById('demo').innerHTML;

var element = document.getElementById('flim');

element.style.webkitTransform = "rotate(25deg)"; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T22:05:27.667

```
element.style.webkitTransform = "rotate(" + MyDiv1 + "deg)"; 
```

# highcharts - 具有堆叠系列的列范围

> ID：16047929
> 
> 赞同：1
> 
> 时间：2013-04-16T22:03:00.723
> 
> 标签：highcharts

是否有可能有一个堆叠系列的柱状图？

我试过这个[jsfiddle](http://jsfiddle.net/BnnCt/) - 但如果我打开堆叠选项，图表不会显示。

```
columnrange : {
    stacking: 'normal'
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T08:25:24.303

您应该禁用 stackign 并将分组设置为 false。 [http://api.highcharts.com/highcharts#plotOptions.columnrange.grouping](http://api.highcharts.com/highcharts#plotOptions.columnrange.grouping)

示例：http: [//jsfiddle.net/BnnCt/1/](http://jsfiddle.net/BnnCt/1/)

```
 plotOptions: {
        columnrange: {
            grouping:false
        }
    }, 
```

# c++ - 使用 Dijkstra 和 min heap c++ 查找节点之间的最短路径

> ID：16047934
> 
> 赞同：0
> 
> 时间：2013-04-16T22:03:32.470
> 
> 标签：c++, heap, dijkstra

这是一个更普遍的问题。我有一张将城市名称映射到其节点的地图（包含国家、纬度、经度等基本信息）。每个城市节点都有一个指向目标节点的边数组。边缘具有时间和成本成员。我想找到在两个节点之间旅行的最短时间，但我已经开始对解决这个问题的最佳方式感到困惑。

我创建了自己的基于城市节点向量的最小堆类。我能够创建地图，将地图中的城市节点添加到最小堆。我已经编写了 dijkstra 的算法来找到最短路径，它适用于某些路径，但不是全部。我*相信*这是因为当我为 dijkstra 算法更新城市节点的权重时，堆没有正确排序。

一旦我更新了节点的权重，我应该如何重新堆化堆以使最低权重位于顶部？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T22:13:31.283

如果您想对整个堆进行排序，请快速查看 [http://en.wikipedia.org/wiki/Heapsort](http://en.wikipedia.org/wiki/Heapsort)

那里有一些伪代码可以提供帮助，您可能需要重新排列它以使顶部最低，但这应该适合您。否则，您可以查看向上堆冒泡并在每个阶段应用它，而不是完全重组堆。

[http://en.wikipedia.org/wiki/Binary_heap](http://en.wikipedia.org/wiki/Binary_heap)

在这里描述它们有点复杂，但是向上/向下堆冒泡将确保您的堆组织正确。还值得注意的是，对于最坏的情况，堆排序将以 O(n log n) 运行，而对于大多数操作而言，冒泡是 O(log n)。

# linux - 如何将文本从源文件复制并粘贴到新文件（仅数字）？

> ID：16047935
> 
> 赞同：0
> 
> 时间：2013-04-16T22:03:38.507
> 
> 标签：linux, shell, awk, terminal

我需要你的帮助，我只想将数字复制`source file`到`new file`（终端代码）。`source file`看起来像这样：

```
<name> <family> <ID>
john mark 323243434
kelly johnson 434343466
..
..
.. 
```

& 我只想将 ID 号复制到 new.txt 文件中。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T22:06:25.933

```
awk '$0=$3' file > newfile 
```

用你的例子：

```
kent$  echo "<name> <family> <ID>
john mark 323243434
kelly johnson 434343466"|awk '$0=$3'
<ID>
323243434
434343466 
```

**编辑**_`cut`

无论如何，你想要鱼，这里是：

```
kent$   echo "<name> <family> <ID>
john mark 323243434
kelly johnson 434343466"|cut -d' ' -f3
<ID>
323243434
434343466 
```

# android - 在 App Engine 连接的 Android 客户端上使用 Proguard

> ID：16047937
> 
> 赞同：0
> 
> 时间：2013-04-16T22:03:51.223
> 
> 标签：android, google-app-engine, proguard, requestfactory

我即将将我的应用程序放到 Google Play 商店中，并且我正在尝试使用 Proguard 进行混淆。它使用 GAE 和 RequestFactory，我得到“RequestFactory Validation Tool must be run for...”异常。看过一些关于此的帖子，以及一些答案，但没有确定的答案，也没有对我有用的东西。我了解反射/符号问题，并已将 RequestFactory 接口排除在混淆之外，但无济于事。有人可以提供一个简化的工作示例，说明应该进入 proguard 配置文件以成功完成此操作。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-12-08T07:41:05.450

一年后可能会迟到。这对使用 proguard for app engine 的人有帮助， **将其添加到您的 proguard.cfg 文件中**

```
# Needed to keep generic types and @Key annotations accessed via reflection

-keepattributes Signature,RuntimeVisibleAnnotations,AnnotationDefault

-keepclassmembers class * {
  @com.google.api.client.util.Key <fields>;
}

# Needed by google-http-client-android when linking against an older platform version

-dontwarn com.google.api.client.extensions.android.**

# Needed by google-api-client-android when linking against an older platform version

-dontwarn com.google.api.client.googleapis.extensions.android.** 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T00:24:38.457

我找不到 RequestFactory 验证工具在内部做什么的描述，但很可能它已经添加了注释。ProGuard 的混淆步骤默认会删除这些，但您可以保留它们：

```
-keepattributes *Annotation* 
```

# python - 如何检查文件中的行数是否等于每行中的字符数？

> ID：16047941
> 
> 赞同：0
> 
> 时间：2013-04-16T22:04:00.890
> 
> 标签：python

该文件必须包含 3 到 10 行文本。也就是说，3 是可接受的最小行数，10 是最大行数。

所有行必须包含完全相同数量的字符。

每行必须包含 3 到 10 个字符。也就是说，3 是可接受的最小字符数，而 10 是最大字符数。每行的字符数不必等于文件中的行数。

唯一可接受的字符是“x”、“X”、“y”、“Y”和“_”。

```
correct_string = False
while correct_string is False:

    string = input("Enter a string? ")
    if len(string) != len(string):
        print("Error: string must have the same number of characters.")
    else:
        incorrect_char = False
        for i in string:
            if i != "X" and i != "x" and i != 'Y' and i != 'y' and i != "_":
                incorrect_char = True
        if incorrect_char is False:
            correct_string = True
        else:
            print("Invalid Character. Contains characters other than 'X', 'x', 'Y' 'y',and '_'") 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T23:29:20.257

```
def check_file(f):
    for i, line in enumerate(f):
        if i > 10: return False
        for j, c in enumerate(line.rstrip('\n')):
            if j > 10: return False
            if c not in 'xXyY_':
                return False
        if j < 3: return False
    if i < 3: return False

    return True 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T22:11:41.183

```
with open("my_file.txt") as f:
     lines = f.readlines()
     assert all(len(line) == len(lines[0]) for line in lines[1:]) 
     assert len(lines) == len(lines[0]) 
```

也许......不太清楚你的要求

# javascript - 在 joomla、模块或条件语句中使用什么来检查页面更好

> ID：16047943
> 
> 赞同：2
> 
> 时间：2013-04-16T22:04:10.763
> 
> 标签：javascript, html, joomla, module

我想知道在不同页面上显示模板不同部分的最佳方式是什么，

1.  例如使用模块

`<jdoc:include type="modules" name="position-1" style="xhtml" />`

或者

1.  用于检查页面的条件语句，例如

`if ($menu->getActive() == $menu->getDefault()):`

当我说最好的时候，我的意思是，你用什么方法可以获得最好的性能，在浏览器（和版本）中得到最好的支持，并且使用起来最安全。现在在我的站点中，我正在使用一个名为 custom html advanced 的模块在某些地方引入 javascript。而且我正在使用条件语句在不同的地方显示不同的代码，但最好尽可能保持一致，所以我想知道哪种方法最好。

**编辑：**

我可能会补充一点，我的代码已经包含条件语句以允许不同的页面结构，所以它看起来像这样

```
if page-1

HTML stuff for page 1...

elseif page-2

HTML stuff for page 2...

elseif page-3

HTML stuff for page 3... 
```

所以也许最好将我的 javascript/html 代码直接粘贴到条件语句中，因为它会更快？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T01:23:49.637

最好的方法是使用模块并在模板中创建所需的位置。

**原因：**

1.  它使网站易于维护和定制。例如，如果您想删除某些内容，那么禁用该模块比深入您的模板代码要容易得多。

2.  如果您有很多“选项”，那将是一堆 if/else 语句。

3.  条件语句对菜鸟不友好。

对浏览器的支持或两种方法的安全性取决于您在代码/模块中放入的内容。

# easymock - 用于 JMX ManagementFactory 的 PowerMock / EasyMock

> ID：16047944
> 
> 赞同：0
> 
> 时间：2013-04-16T22:04:12.270
> 
> 标签：easymock, powermock

我需要模拟以下代码：

```
final MBeanServer mbs = ManagementFactory.getPlatformMBeanServer();
mbs.registerMBean(testMBean, new ObjectName("testObjectName"); 
```

我使用 PowerMock 来模拟 ManagementFactory 并使用以下代码片段：

1.  在课堂上，我配置了：

    @RunWith(PowerMockRunner.class) @PrepareForTest({ ManagementFactory.class })

2.  创建 Mock MBeanServer 类：

    MBeanServer mockMBeanServer = createMock(MBeanServer.class);

3.  使用 EasyMock 创建 Expetation：

    EasyMock.expect(ManagementFactory.getPlatformMBeanServer()).andReturn(mockMBeanServer);

在上面的代码中，我收到以下错误：

> java.lang.IllegalStateException：在 org.easymock.internal.MocksControl.andReturn(MocksControl.java:218) 的返回值类型不兼容

最后，在尝试了很多之后，我需要忽略这个类：

```
@PowerMockIgnore( { 
    "org.apache.commons.logging.*", 
    "javax.management.*", 
}) 
```

我的测试用例正在工作，除了模拟和测试 MBean 类。有更好的选择吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T17:00:52.080

看起来您遗漏了对 的调用`mockStatic()`。您的测试方法将变为：

```
@Test
public void testMyBean() throws Exception {
  MBeanServer mockMBeanServer = createMock(MBeanServer.class);

  PowerMock.mockStatic(ManagementFactory.class);

  EasyMock.expect( ManagementFactory.getPlatformMBeanServer() )
    .andReturn(mockMBeanServer);
  //...
} 
```

PowerMock 有一些很棒的文档涵盖了这个[主题](https://code.google.com/p/powermock/wiki/MockStatic)。

# ios - 如何在带有光泽效果的聊天气泡上显示 UIImage

> ID：16047947
> 
> 赞同：1
> 
> 时间：2013-04-16T22:04:18.547
> 
> 标签：ios, uiimageview, chat, message, gradient

我正在开发一个聊天应用程序，其聊天气泡的外观和感觉与默认的 iOS 应用程序相同。我已经实现了文本显示和图像播种，但它不是按照默认的 iOS 消息应用程序。我希望图像与气泡的光泽效果混合，如下面的附加图像。

![在此处输入图像描述](https://i.stack.imgur.com/hE8KR.png)

制作带有光泽的透明气泡图像会起作用吗？请帮忙！！

# python - 使用 matplotlib 在循环中进行交互式绘图

> ID：16047948
> 
> 赞同：2
> 
> 时间：2013-04-16T22:04:18.677
> 
> 标签：python, matplotlib, ipython

当我的数据进入时，我*只是*想通过 ipython 使用 matplotlib 进行绘图。我正在使用 -pylab 选项打开 ipython。在下面的代码中，time.sleep(1) 只是作为我的实验收集数据所需时间的占位符。该代码成功清除了之前绘制的数据，并使用新数据集更新了图形。但是，当我尝试在屏幕上移动图形时，图形会冻结，并且不会随着代码的运行而更新（在图形的标题中显示“无响应”标题）。我想要图形移动性，因为最终会有多个图跟踪实验的进度。我希望可以在它们之间切换而不会冻结所有内容。有什么建议么？在 Windows 7 机器上使用 python 2.6 运行。

```
import numpy as np
import matplotlib.pyplot as plt
import time
plt.ion()
fig = plt.figure(1)
ax = fig.add_subplot(111)
for k in range(100):
    plt.cla()
    time.sleep(1)
    ax = fig.add_subplot(111)
    ax.semilogy(np.random.rand(100))
    fig.canvas.draw()
    plt.draw() 
```

# c# - ProgressBar.Tap 事件没有触发？

> ID：16047959
> 
> 赞同：0
> 
> 时间：2013-04-16T22:05:14.493
> 
> 标签：c#, silverlight, windows-phone-7, progress-bar, windows-phone

我的 xaml 页面中有一个大的 ProgressBar：

```
<ProgressBar x:Name="prog" Height="28" VerticalAlignment="Bottom" Tap="prog_Tap"/> 
```

当我点击它时，它应该抛出一个异常：

```
private void prog_Tap(object sender, System.Windows.Input.GestureEventArgs e)
{
    throw new Exception();
} 
```

但是，当我点击 ProgressBar 时，什么也没有发生。我的代码有问题，还是 Silverlight 错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T00:03:15.370

我认为 ProgressBar 默认不支持 hittest 。尝试设置`IsHitTestVisible="True"`，应该可以。

# docker - 我可以暂停然后恢复 Docker 容器吗？

> ID：16047960
> 
> 赞同：47
> 
> 时间：2013-04-16T22:05:17.493
> 
> 标签：docker

我想暂停一个 Docker 容器并稍后恢复。如何才能做到这一点？通过暂停，我的意思是它应该保存正在进行的进程的状态（例如视频编码），然后随时恢复它。

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2014-06-14T09:16:57.520

从[0.12.0 版本](https://github.com/dotcloud/docker/blob/master/CHANGELOG.md#0120-2014-06-05)开始，Docker 支持使用 cgroup freezer 暂停`PAUSE`和`UNPAUSE`恢复容器的命令。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-30T13:54:30.423

AFAIK 现在不能用纯 docker 完成，但 lxc 支持。我已经与 docker 玩了一点，并确认这可以通过 `lxc-freeze -n <containtr.id>` 并恢复操作 来完成`lxc-unfreeze -n <container.id>` 但在 v0.2.0 中，即使使用 -notrunc 和 lxc-ls 输出在我的系统上为空，docker ps 也只会缩短容器 ID（奇怪，需要阅读更多关于它的信息，因为 docker 使用普通的 lxc-start 和参数，所以 lxc-ps 应该打印这个）。我找到了完整的容器 id `lxc-ps`。添加 docker freeze 命令会很好。也许是时候让我学习一些围棋了:)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2019-07-01T09:10:54.740

命令：

```
$ docker pause <containerName>
$ docker unpause <containerName> 
```

这是它们的实际演示：

[![在此处输入图像描述](https://i.stack.imgur.com/ZVsCI.gif)](https://i.stack.imgur.com/ZVsCI.gif)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-09-25T19:34:49.713

这是最近[在用户空间 (CRIU) + Docker 中进行检查点/恢复的实验性集成的](https://speakerdeck.com/saied/experimental-docker-checkpoint-and-restore-with-criu)最新平台。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-07-19T23:56:35.307

Docker has just released an (as yet) undocumented volumes and data storage feature set. tl;dr if you use the `-v` commandline option you can specify a path to map outside of the container to a special docker path (`/var/lib/docker/volumes/{FULL_ID}`) where FULL_ID can be found by `docker inspect container_id`. An example is `docker run -d -v /data danielvf/myapp:1.0 runapp` which would externalize the `/data` directory into a docker volume.

[https://github.com/dotcloud/docker/issues/111](https://github.com/dotcloud/docker/issues/111)

Roadmap for this feature: (doesn't yet document it's existence): [https://github.com/dotcloud/docker/wiki/Volumes-&-persistent-data-storage](https://github.com/dotcloud/docker/wiki/Volumes-&-persistent-data-storage)

# java - 如何将 JTextField 转换为 int 并再次返回？

> ID：16047966
> 
> 赞同：0
> 
> 时间：2013-04-16T22:05:32.683
> 
> 标签：java, swing, jtextfield

嗨，我正在为我的 java 类开发一个程序，但遇到了一些问题。任务是编辑教授的现有代码，以便当在 GUI 中单击按钮时，它会获取当前 JTextField 的值并将其添加到下一个字段的值中，然后将该值放入该字段中。我已经设法将他编辑到具有正确 GUI 布局的地步，并试图让计算方面发挥作用，但我失去了想法。我需要了解如何在启动时立即显示 JTextFields 中的值，以及如何添加内容。任何帮助是极大的赞赏！

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;
import java.awt.Graphics2D;

public class U27
{
    public static void main(String[] args)
    {
        MiscFocusFrame myframe = new MiscFocusFrame();
        myframe.setVisible(true);
    }
}

class MiscFocusFrame extends JFrame
{
    private JTextField myField;
    private MiscFocusPanel myPanel;
    private final int FRAMEW = 900;
    private final int FRAMEH = 200;

    public MiscFocusFrame()
    {
        setTitle("U27");
        setSize(FRAMEW, FRAMEH);
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        myPanel = new MiscFocusPanel();
        Container contentPane = getContentPane();
        contentPane.add(myPanel, "Center");
    }
}

class MiscFocusPanel extends JPanel
{
    private MiscFocusRegister register1;
    private MiscFocusRegister register2;
    private MiscFocusRegister register3;
    private MiscFocusRegister register4;

    public MiscFocusPanel()
    {
        register1 = new MiscFocusRegister(4);
        register2 = new MiscFocusRegister(4);
        register3 = new MiscFocusRegister(4);
        register4 = new MiscFocusRegister(4);

        register1.setRegisterToPassFocusTo(register2);
        register2.setRegisterToPassFocusTo(register3);
        register3.setRegisterToPassFocusTo(register4);
        register4.setRegisterToPassFocusTo(register1);

        setLayout(new GridLayout(2, 6));

        JLabel labelA = new JLabel("Cup 1", JLabel.LEFT);
        JPanel labelPanelA = new JPanel();
        labelPanelA.add(labelA);
        add(labelPanelA);

        JPanel regPanelA = new JPanel();
        regPanelA.add(register1.getMyField());
        add(regPanelA);

        JButton myButton1 = new JButton("Add To Next Cup");
        MiscButtonListener myButtonListener1 = new MiscButtonListener();
        myButton1.addActionListener(myButtonListener1);
        JPanel buttonPanel1 = new JPanel();
        buttonPanel1.add(myButton1);
        add(buttonPanel1);

        JLabel labelB = new JLabel("Cup 2", JLabel.LEFT);
        JPanel labelPanelB = new JPanel();
        labelPanelB.add(labelB);
        add(labelPanelB);

        JPanel regPanelB = new JPanel();
        regPanelB.add(register2.getMyField());
        add(regPanelB);

        JButton myButton2 = new JButton("Add To Next Cup");
        MiscButtonListener myButtonListener2 = new MiscButtonListener();
        myButton2.addActionListener(myButtonListener2);
        JPanel buttonPanel2 = new JPanel();
        buttonPanel2.add(myButton2);
        add(buttonPanel2);

        JLabel labelC = new JLabel("Cup 3", JLabel.LEFT);
        JPanel labelPanelC = new JPanel();
        labelPanelC.add(labelC);
        add(labelPanelC);

        JPanel regPanelC = new JPanel();
        regPanelC.add(register3.getMyField());
        add(regPanelC);

        JButton myButton3 = new JButton("Add To Next Cup");
        MiscButtonListener myButtonListener3 = new MiscButtonListener();
        myButton3.addActionListener(myButtonListener3);
        JPanel buttonPanel3 = new JPanel();
        buttonPanel3.add(myButton3);
        add(buttonPanel3);

        JLabel labelD = new JLabel("Cup 4", JLabel.LEFT);
        JPanel labelPanelD = new JPanel();
        labelPanelD.add(labelD);
        add(labelPanelD);

        JPanel regPanelD = new JPanel();
        regPanelD.add(register4.getMyField());
        add(regPanelD);

        JButton myButton4 = new JButton("Add To Next Cup");
        MiscButtonListener myButtonListener4 = new MiscButtonListener();
        myButton4.addActionListener(myButtonListener4);
        JPanel buttonPanel4 = new JPanel();
        buttonPanel4.add(myButton4);
        add(buttonPanel4);

    }

    public void paintComponent(Graphics g)
    {
        Graphics2D g2 = (Graphics2D) g;
        super.paintComponent(g2);
    }

    private class MiscButtonListener implements ActionListener
    {
        public void actionPerformed(ActionEvent event)
        {
            register1.swapRegisterContents(register2);
        }
    }
}

/*
This class contains a new method, setRegisterToPassFocusTo(), and in
the listener focus is passed to that register after the new value for
the text field is taken in.
*/

class MiscFocusRegister
{
    private MiscFocusByte registerValue;
    private JTextField myField;
    private MiscFocusRegister registerToPassFocusTo;

    public MiscFocusRegister()
    {
    }

    public MiscFocusRegister(int stringIn)
    {
        registerValue = new MiscFocusByte(stringIn);
        myField = new JTextField(stringIn);
        TextFieldListener myListener = new TextFieldListener();
        myField.addActionListener(myListener);
    }

    public void setRegisterValue(MiscFocusByte byteIn)
    {
        registerValue = byteIn;
    }

    public MiscFocusByte getRegisterValue()
    {
        return registerValue;
    }

    public void setMyField(JTextField fieldIn)
    {
        myField = fieldIn;
    }

    public JTextField getMyField()
    {
        return myField;
    }

    public void setRegisterToPassFocusTo(MiscFocusRegister registerIn)
    {
        registerToPassFocusTo = registerIn;
    }

    public void swapRegisterContents(MiscFocusRegister source)
    {
        MiscFocusByte tempValue;

        tempValue = source.getRegisterValue();
        source.setRegisterValue(this.getRegisterValue());
        source.myField.setText(source.getRegisterValue().getStringFromByte());
        this.setRegisterValue(tempValue);
        this.myField.setText(this.getRegisterValue().getStringFromByte());
    }

    private class TextFieldListener implements ActionListener
    {
        public void actionPerformed(ActionEvent event)
        {
            String inputString = myField.getText();
            registerValue.setByteToThisString(inputString);
            registerToPassFocusTo.getMyField().requestFocusInWindow();
        }
    }
}

class MiscFocusByte
{
    public static int bitsinbyte = 8;
    private static final String junk = "00000000";
    private char bytearray[] = new char[bitsinbyte];
    public String astring;

    public MiscFocusByte()
    {
        junk.getChars(0, bitsinbyte, bytearray, 0);
    }

    public MiscFocusByte(int stringIn)
    {
        //junk.getChars(0, bitsinbyte, bytearray, 0);
        //int stringlength = stringIn.length();
        //if(stringlength > bitsinbyte)
        //  stringlength = bitsinbyte;
        //stringIn.getChars(0, stringlength, bytearray, 0);
        stringIn = stringIn + 4;
    }

    public void setByteToThisString(String astring)
    {
        //junk.getChars(0, bitsinbyte, bytearray, 0);
        //int stringlength = astring.length();
        //if(stringlength > bitsinbyte)
        //  stringlength = bitsinbyte;
        //astring.getChars(0, stringlength, bytearray, 0);
        astring = astring + 4;
    }

    public String getStringFromByte()
    {
        //return String.copyValueOf(bytearray);
        return String.valueOf(astring);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T22:12:27.977

试试这样的..

```
String text=jTextField1.getText();
text+="1";
jTextField1.setText(text);
jTextField1.requestFocus(); 
```

# objective-c - 为什么在使用 setter 将自定义对象分配给实例变量时使用 autorelease？

> ID：16047968
> 
> 赞同：0
> 
> 时间：2013-04-16T22:05:43.130
> 
> 标签：objective-c, macos, memory-management

我想将自定义对象分配给实例变量。

这是代码：
- MyController.h/.m

```
#import "CustomData.h"  
@interface MyViewController : NSViewController  
@property (retain) CustomData* theData;  

- (void)aRandomMethod; 

@end

@implementation MyViewController  
@synthetize theData;  

- (void)aRandomMethod {  

   NSData* rawData = [someOtherObject someOtherMethod];

   // option 1
   self.theData = [[CustomData alloc] initWithData:rawData];

   // option 2
   CustomData* _theData = [[Custom alloc] initWithData:rawData];

   // option 3
   self.theData = [[[CustomData alloc] initWithData:rawData] autorelease];

   // option 4
   theData = [[CustomData alloc] initWithData:rawData];

   // ... later code calls some methods on theData or _theData, not useful here.
 }
@end 
```

在 Xcode 中运行分析功能时，它告诉我选项 1 和 2 有一个“泄漏的对象未在以后引用...”，但选项 3 和 4 没有。看来我`autorelease`在使用时需要自定义对象二传手。我知道`autorelease`在方法中返回我们拥有的对象时需要使用它。

你能解释一下每个选项为什么是错还是对？谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T22:17:35.750

选项 1 是错误的，因为您`alloc`在该方法中 d 了对象，因此该方法现在拥有该对象，因此需要`release`它。当您将它分配给一个属性时，`retain`它就是它，并且在它完成时期望`release`它。

出于同样的原因，选项 2 是错误的。您取出了它的属性部分，但是因为您使用创建了对象`alloc`，所以您有责任`release`在该方法中调用它。

选项 3 是正确的，因为您在`autorelease`将其提供给属性之前已将其 d，因此该方法不再拥有它。请注意，如果您`release`在此处使用它会损坏，因为它会`release`在属性获得机会之前损坏`retain`。

选项 4 可能是正确的；我假设它将它分配给一个ivar。仅当您稍后在 dealloc 方法中手动释放 ivar 时才正确。不过，通常最好通过属性。否则，您将面临分配另一个值并忘记`release`现有值的风险。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T22:21:51.840

选项 1 和 2 最需要注意的是有一个 alloc，因此需要一个对应的版本。

选项 1 本质上是“隐藏的”，因为编译器会自动为您生成 setter 和 getter。您没有看到的是，当使用点表示法时，您正在通过 setter，它隐含地包含一个保留调用。因此，您正在分配对象并保留，使其保留计数为 2。

因此，为了确保以后能够正常释放，您必须指定将其添加到自动释放池中，以供系统稍后清理。这将使保留计数变为 1，然后在您的 dealloc 方法中，您可以安全地释放该属性。

# eclipse - 带有 Web 工具平台的 Eclipse Juno - 本地主机上的 HTTP 预览抛出 NoClassDefFoundError

> ID：16047969
> 
> 赞同：4
> 
> 时间：2013-04-16T22:05:44.973
> 
> 标签：eclipse, jetty, eclipse-juno, eclipse-wtp, web-development-server

`NoClassDefFoundError: org/eclipse/jetty/webapp/WebAppContext`在尝试使用 Web 工具平台在 Eclipse Juno 中启动 HTTP 预览时，我不断收到消息。

重现步骤：

1.  下载、解压并启动 Eclipse Juno
2.  通过[http://download.eclipse.org/releases/juno的“安装新软件...”安装“Eclipse Web Developer Tools”](http://download.eclipse.org/releases/juno)
3.  创建新的“静态 Web 项目”
4.  在新项目中创建 HTML 文件
5.  右键单击项目 -> 运行方式 -> 在服务器上运行 -> 在本地主机上的 HTTP 预览 -> 完成

在这一点上，无论我做什么，我都会不断收到 NoClassDefFoundError 。

我已经尝试过的：

*   尝试使用 32/64 位 Eclipse
*   尝试使用 Windows XP、Windows 7
*   尝试从“Web、XML、Java EE 和 OSGi 企业开发”安装所有工具
*   尝试从 Eclipse Marketplace 安装“Eclipse Jetty”和“Run-Jetty-Run”
*   尝试了不同的 Eclipse 包：“Eclipse IDE for Java Developers”、“Eclipse Classic”

我发现了类似的问题：

*   [NoClassDefFoundError - Eclipse - Apache HTTPClient](https://stackoverflow.com/questions/14875231/noclassdeffounderror-eclipse-apache-httpclient)
*   [Ubuntu 12.04 中没有用于 Eclipse Juno 的 HTTP 预览服务器](https://stackoverflow.com/questions/11462099/no-http-preview-server-for-eclipse-juno-in-ubuntu-12-04)

我的主要环境是：

*   视窗 8 64 位
*   Eclipse Juno (4.2.2) 64 位
*   网络工具平台 3.4.2
*   JRE 7

* * *

`Exception in thread "main" java.lang.NoClassDefFoundError: org/eclipse/jetty/webapp/WebAppContext at java.lang.Class.getDeclaredMethods0(Native Method) at java.lang.Class.privateGetDeclaredMethods(Unknown Source) at java.lang.Class.getMethod0(Unknown Source) at java.lang.Class.getMethod(Unknown Source) at sun.launcher.LauncherHelper.getMainMethod(Unknown Source) at sun.launcher.LauncherHelper.checkAndLoadMain(Unknown Source) Caused by: java.lang.ClassNotFoundException: org.eclipse.jetty.webapp.WebAppContext at java.net.URLClassLoader$1.run(Unknown Source) at java.net.URLClassLoader$1.run(Unknown Source) at java.security.AccessController.doPrivileged(Native Method) at java.net.URLClassLoader.findClass(Unknown Source) at java.lang.ClassLoader.loadClass(Unknown Source) at sun.misc.Launcher$AppClassLoader.loadClass(Unknown Source) at java.lang.ClassLoader.loadClass(Unknown Source) ... 6 more`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-23T14:42:55.847

您可以在以下四个阶段创建补丁并使其为您工作：

`**Phase 1**: Create a plug-in project for the plug-in you need to patch.`

1.  创建一个新工作区（推荐）或打开一个现有工作区。
2.  选择`File`->`Import`
3.  展开`Plug-in Development`，选择`Plug-ins and Fragments`，然后单击`Next`
4.  在该`Import As`部分中，选择`Projects with source folders` 并单击`Next`。
5.  在顶部的字段中`org.eclipse.wst.server.preview.adapter`输入（或复制和粘贴，不带引号） ，然后单击。这应该将这个插件移动到右窗格。`ID``Add All`
6.  单击`Finish`以将“org.eclipse.wst.server.preview.adapter”插件源导入项目。
7.  展开项目的根目录并确保它包含一个名为“src”的文件夹。如果您安装了“WST 服务器适配器插件开发人员资源”，您将只获得“src”文件夹。

`**Phase 2**: Apply the changes needed to update the plug-in. Since there is a bug with a patch attached that can be used to apply the changes, the following steps will take advantage of that`.

1.  在浏览器中打开[错误 402848](https://bugs.eclipse.org/bugs/attachment.cgi?id=229828)。
2.  点击`Patch v1.0 for 3.4.2p`附件链接打开补丁。
3.  从第二次出现以 开头的行开始`---`，从文本末尾选择此行并将其复制到剪贴板。这包含对 PreviewLaunchConfigurationDelegate.java 文件的更改，这是需要修复的地方。你不想要补丁的上部，因为这会改变插件的版本，这会使事情复杂化。
4.  回到 Eclipse，右键单击“org.eclipse.wst.server.preview.adapter”项目。选择`Team`并单击`Apply Patch`。
5.  选择剪贴板并单击`Next`。
6.  确保选择了“org.eclipse.wst.server.preview.adapter”项目，然后单击`Next`。
7.  将 设置`Ignore leading path name segments`为 3。“补丁内容”窗口应变为蓝色的左箭头，而不是红色的 x 指示符。
8.  单击`Finish`以应用更改。

`**Phase 3:** Create the replacement jar. Due to the approach in Phase 1, the name of this jar will be identical to your current jar, which simplifies updating the Eclipse installation.`

1.  `org.eclipse.wst.server.preview.adapter`在 Project Explorer 或其他导航器视图中右键单击项目并选择`Export`
2.  展开`Plug-in Development`，选择`Deployable plug-ins and fragments`，然后单击`Next`
3.  单击`Browse`目标选项卡中目录选项旁边的按钮，然后单击确定。这会将输出目录设置为与您的工作区相同。
4.  单击`Finish`以构建替换插件 jar。它将出现在工作区根目录下的“插件”文件夹中。

`**Phase 4:** Replace the installed plug-in jar with the fixed version.`

1.  如果 Eclipse 正在运行，请退出它。
2.  在 Eclipse 安装的“plugins”文件夹下，移动或重命名**org.eclipse.wst.server.preview.adapter_1.1.101.v20121107_1651.jar**，如果您不想用补丁版本覆盖它（在步骤 3 中提到以下）。如果您有不同的版本，这意味着您没有使用 Juno SR2，并且希望您安装了与您的版本匹配的“WST 服务器适配器插件开发人员资源”。
3.  从工作区下的“plugins”文件夹中复制**org.eclipse.wst.server.preview.adapter_1.1.101.v20121107_1651.jar并将其粘贴到 Eclipse 安装的“plugins”文件夹中。**

您现在应该能够使用固定插件运行 Eclipse。因为修补的 jar 具有相同的版本号，所以不需要额外的更改。

希望能帮助到你 ！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T04:08:30.230

可能会在 6 月即将发布的 Kepler 版本中修复。

[http://bugs.eclipse.org/402848](http://bugs.eclipse.org/402848)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-15T19:15:23.127

谢谢尼丁，

只需下载补丁；

[http://download.eclipse.org/webtools/patches/drops/R3.4.2/P-3.4.2-20130506185528/patches32x-P-3.4.2-20130506185528.zip](http://download.eclipse.org/webtools/patches/drops/R3.4.2/P-3.4.2-20130506185528/patches32x-P-3.4.2-20130506185528.zip)

然后;

复制文件到eclipse目录

# stackexchange-api - 在网站中显示 Stackoverflow 评级/声誉/徽章

> ID：16047978
> 
> 赞同：6
> 
> 时间：2013-04-16T22:06:09.697
> 
> 标签：stackexchange-api

在 Stackoverfow 中赢得声誉是一项艰巨的工作，如果我能在我的网站上获得声誉，我会感到很高兴。是否可以？

stackoverflow 是否公开了与用户相关的任何 API？

[更新]

> 当我简单地输入
> 
> [http://api.stackoverflow.com/1.1/users/](http://api.stackoverflow.com/1.1/users/) {user-id}/
> 
> 它给了我一个 JSON 数据，这对我来说似乎很好。像这样使用它可以吗？
> 
> 从[stackapps.com](https://stackapps.com/questions/2704/stack-overflow-reputation-api)得到它`Nathan Osman`

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-18T18:47:55.673

Stackoverflow 提供了一个选项来在您的网站中显示您的声誉。我们可以通过两种方式来做到这一点（据我所知）：-

*艰难的道路（自己做所有事情）*

*   点击 URL [http://api.stackoverflow.com/1.1/users/](http://api.stackoverflow.com/1.1/users/) {User-Id}/
*   以上返回 JSON 数据，可以通过 Ajax 消费，我们可以提取 Reputations、Badges 等。
*   创建您的用户界面并根据需要绑定值。

*简单的方式（使用天赋）*

*   转到用户个人资料并查找超链接，如下所示：- ![用户配置文件中的 Flair 选项](https://i.stack.imgur.com/5Qydk.png)

*   单击它，您将被重定向到 Flair Page。如下图所示： ![天赋主题](https://i.stack.imgur.com/teWjY.png)

*   它提供了 HTML 片段，只需将其复制并粘贴到您需要的地方。

谢谢。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T22:15:45.493

确实有 Stackoverflow API！V1.1 现在已经过时了，所以最好使用 V2.1，否则你的代码可能会因为东西被弃用而停止工作。

StackApps 这里有一个 V2 示例：

[你好世界示例](https://stackapps.com/questions/2/api-hello-world-code)

# c++ - 如何使用 C++ libpqxx API 将二进制数据插入 PostgreSQL BYTEA 列？

> ID：16047986
> 
> 赞同：12
> 
> 时间：2013-04-16T22:06:40.597
> 
> 标签：c++, postgresql, libpqxx

我想在 BYTEA 列中插入一些二进制数据，但我发现 Doxygen 输出缺乏详细信息，并且[http://pqxx.org/](http://pqxx.org/)过去几天一直处于关闭状态。

我将如何将 somefile.bin 的内容插入到具有 BYTEA 列的表中？

我所拥有的是这些方面：

```
pqxx::work work( conn );
work.exec( "CREATE TABLE test ( name varchar(20), data BYTEA )" );
work.exec( "INSERT INTO test( name, data ) VALUES ( 'foo', <insert filename.bin here> )" );
work.commit(); 
```

如果有什么不同，我想使用`hex`PostgreSQL 9.1 中可用的 BYTEA 新格式。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-21T00:04:30.953

弄清楚了。这是一个示例，展示了如何将一堆二进制对象插入到表中：

```
pqxx::connection conn( ... );
conn.prepare( "test", "INSERT INTO mytable( name, binfile ) VALUES ($1, $2)" );
pqxx::work work( conn );
for ( ... )
{
    std::string name = "foo";
    void * bin_data = ...; // obviously do what you need to get the binary data...
    size_t bin_size = 123; // ...and the size of the binary data

    pqxx::binarystring blob( bin_data, bin_size );
    pqxx::result r = work.prepared( "test" )( name )( blob ).exec();
}
work.commit(); 
```

以下是如何从数据库中取回二进制数据：

```
pqxx::result result = work.exec( "SELECT * FROM mytable" );
for ( const auto &row : result )
{
    pqxx::binarystring blob( row["binfile"] );
    void * ptr = blob.data();
    size_t len = blob.size();
    ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-20T05:27:15.900

插入中没有 pqxx::bynarystring。我使用以下解决方案来做到这一点：

=== 在数据库中存储 wxImage ====

```
//Getting image string data
wxImage foto = (...);
wxMemoryOutputStream stream;
foto.SaveFile(stream,wxBITMAP_TYPE_PNG);
wxStreamBuffer* streamBuffer = stream.GetOutputStreamBuffer();
size_t tamanho = streamBuffer->GetBufferSize();
char* fotoData = reinterpret_cast<char*>(streamBuffer->GetBufferStart());
string dados(fotoData, tamanho);

//Performing the query
conn->prepare("InsertBinaryData", "INSERT INTO table1(bytea_field) VALUES (decode(encode($1,'HEX'),'HEX'))") ("bytea",pqxx::prepare::treat_binary);

pqxx::work w = (...);
w.prepared(dados).exec(); 
```

=== 从数据库中检索 wxImage ====

```
pqxx::result r = w.exec("SELECT bytea_field FROM table1 WHERE (...)");
w.commit();

const result::tuple row = r[0];
const result::field tfoto = row[0];

pqxx::binarystring bs(tfoto);
const char* dadosImg = bs.get();
size_t size = bs.length();

wxMemoryInputStream stream(dadosImg,size);
wxImage imagem;

imagem.LoadFile(stream); 
```

我希望它会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-08-03T16:25:54.743

如果您愿意，您可以简单地使用函数`conn.prepare`重载之一来转义二进制数据，而不是像在 Stéphane 的回答中那样使用准备好的 SQL 语句。[这](http://pqxx.org/devprojects/libpqxx/doc/4.0/html/Reference/a00203.html)是文档。`pqxx::escape_binary`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-02-13T07:01:14.287

由于此问题是通过 libpqxx 插入 BYTEA 的热门搜索结果，因此这里有另一种使用参数化查询的方法，如果执行单次插入更合适。

```
// Assuming pre-existing pqxx::connection c, void * bin_data, size_t bin_size...
pqxx::work txn(c);
pqxx::result res = txn.parameterized("INSERT INTO mytable(name, binfile) VALUES ($1, $2)")
                                    (name)
                                    (pqxx::binarystring(bin_data, bin_size))
                                    .exec();
txn.commit(); 
```

请注意，不应使用 or 方法对*参数*`quote`进行`esc`转义。

另请注意，使用的接受答案`pqxx::connection::prepare`会导致准备好的查询在连接的整个生命周期内都存在。如果连接将是持久的并且不再需要准备好的查询，则可能应该通过调用将其删除`pqxx::connection::unprepare`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-08-30T22:52:47.450

我想出了一个使用内部二进制数据的灵活解决方案`std::string`。

我提出了这个新的解决方案，因为当前的答案是旧的（2013 年），我正在寻找一个使用 pqxx 5.0.1 的多插入查询。

使用下面的解决方案，您可以灵活地使用 a`for loop`在单个插入查询中附加多个二进制数据。

```
CustomStruct data = .... ; // have some binary data

// initialise connection and declare worker
pqxx::connection conn = new pqxx::connection(...);    
pqxx::work w(conn); 

// prepare query
string query += "INSERT INTO table (bytea_field) VALUES ("
// convert your data in a binary string. 
pqxx::binarystring blob((void *)&(data), data.size());
// avoid null character to bug your query string. 
query += "'"+w.esc_raw(blob.str())+"');";

//execute query
pqxx::result rows = w.exec(query); 
```

当我们要从数据库中检索数据时，您应该具有数据类型的范围（`CustomStruct`例如），并且您应该能够将其转换为您选择的二进制格式。

```
// assuming worker and connection are declared and initialized.
string query = "SELECT bytea_field FROM table;";
pqxx::result rows = w.exec(query);
for(pqxx::result::iterator col = rows.begin(); col != rows.end(); ++col)
{
    pqxx::binarystring blob(col[0]);
    CustomStruct *data = (CustomStruct*) blob.data();
    ...
} 
```

这是用`pqxx 5.0.1`,`c++11`和`postgresSQL 9.5.8`

# android - Maps V2 myLocation 蓝点回调

> ID：16047988
> 
> 赞同：1
> 
> 时间：2013-04-16T22:06:47.630
> 
> 标签：android, google-maps, map, android-maps-v2, mylocationoverlay

我希望能够单击地图上显示的蓝点（我的位置）。无论如何可以从该点击中获得回调？

谢谢，马丁

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T14:13:28.503

一种可能的解决方法是`Marker`在“我的位置”点顶部绘制一个（带有类似图标），以便您可以接收相应的`onMarkerClick()`回调。这还需要在每次发生位置更新事件时删除标记并将其添加到新位置，您可以通过实现`OnMyLocationChangeListener`.

**编辑**：该`OnMyLocationChangeListener`接口现在已弃用，应该使用新[`LocationClient`](https://developer.android.com/reference/com/google/android/gms/location/LocationClient.html)的和关联的[`LocationListener`](https://developer.android.com/reference/com/google/android/gms/location/LocationListener.html).

所以相关代码可能看起来像这样（我实际上没有测试过）：

```
public class DemoMapFragment extends SupportMapFragment implements OnMyLocationChangeListener, OnMarkerClickListener { 

    // Note that 'mMap' may be null if the Google Play services APK is not available. 
    private GoogleMap mMap; 
    private Marker myLocationMarker;
    private static BitmapDescriptor markerIconBitmapDescriptor;
    /* ... */

    @Override 
    public void onResume() { 
        super.onResume(); 
        setUpMapIfNeeded(); // Get a reference to the map      
        mMap.setMyLocationEnabled(true); // Enable the my-location layer 
        mMap.setOnMyLocationChangeListener(this); 
        mMap.setOnMarkerClickListener(this);
    }

    private void setUpMapIfNeeded() { 
        // Do a null check to confirm that we have not already instantiated the map. 
        if (mMap == null) { 
            mMap = getMap(); 
            // Check if we were successful in obtaining the map. 
            if (mMap != null) { 
                // The Map is verified. It is now safe to manipulate the map:

                // Load custom marker icon
                markerIconBitmapDescriptor = BitmapDescriptorFactory.fromResource(R.drawable.my_location_dot_icon); 

                // When the map is first loaded we need to add our marker on top of My Location dot
                myLocationMarker = mMap.addMarker(new MarkerOptions() 
                        .position(new LatLng(mMap.getMyLocation().getLatitude(),mMap.getMyLocation().getLongitude())) 
                        .icon(markerIconBitmapDescriptor)); 

                // Set default zoom 
                mMap.moveCamera(CameraUpdateFactory.zoomTo(15f)); 
            } 
        } 
    }   

    @Override
    public void onMyLocationChange(Location location) {
        // Remove the old marker object
        myLocationMarker.remove(); 

        // Add a new marker object at the new (My Location dot) location
        myLocationMarker = mMap.addMarker(new MarkerOptions() 
                .position(new LatLng(location().getLatitude(),location().getLongitude())) 
                .icon(markerIconBitmapDescriptor)); 
    }

    @Override
    public boolean onMarkerClick(Marker marker) {
        if (marker.equals(myLocationMarker)) {
            /* My Location dot callback ... */
        }
    }
} 
```

# javascript - jquery下拉不工作

> ID：16047992
> 
> 赞同：0
> 
> 时间：2013-04-16T22:07:03.800
> 
> 标签：javascript, jquery

尝试使用[http://labs.abeautifulsite.net/jquery-dropdown/](http://labs.abeautifulsite.net/jquery-dropdown/)作为一个简单的下拉菜单，但由于某种原因，我无法让它工作。

```
<a href="#" data-dropdown="#dropdown-1">dropdown</a>

<div id="dropdown-1" class="dropdown dropdown-tip">
    <ul class="dropdown-menu">
        <li><a href="#1">Item 1</a></li>
        <li><a href="#2">Item 2</a></li>
        <li><a href="#3">Item 3</a></li>
        <li class="dropdown-divider"></li>
        <li><a href="#4">Item 4</a></li>
        <li><a href="#5">Item 5</a></li>
        <li><a href="#5">Item 6</a></li>
    </ul>
</div> 
```

[http://jsfiddle.net/ywWjE/](http://jsfiddle.net/ywWjE/)

我究竟做错了什么？这可能是非常简单的事情，但我只是没有看到它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T22:17:58.640

您来自 github 的文件没有正确包含在小提琴中。我在小提琴中复制粘贴了 JS 和 CSS，它工作正常。[这](http://jsfiddle.net/ywWjE/6/)是工作小提琴。

```
enter code here 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T22:19:02.743

检查这个`Fork`：- [http://jsfiddle.net/KHteX/](http://jsfiddle.net/KHteX/)

只需在小提琴的样式框中包含样式，您就会看到它的出现。